# StackOverflow 问答 13211000-13211999

# ruby-on-rails - 带有lazy_chart ruby gem的Highcharts面积图

> ID：13211002
> 
> 赞同：1
> 
> 时间：2012-11-03T16:15:49.233
> 
> 标签：ruby-on-rails, highcharts, lazy-high-charts

我正在尝试使用[https://github.com/michelson/lazy_high_charts](https://github.com/michelson/lazy_high_charts)来呈现一个简单的面积图，其中 x 轴上的日期和 y 轴上的分数。我使用了以下来自lazy_high_charts 的片段。图形已呈现，但 x 轴不是日期。

```
@h = LazyHighCharts::HighChart.new('graph', style: '') do |f|
  f.options[:chart][:defaultSeriesType] = "area"
  f.options[:plotOptions] = {areaspline: {pointInterval: 1.day, pointStart: 10.days.ago}}
  f.series(:name=>'John', :data=>[3, 20, 3, 5, 4, 10, 12 ,3, 5,6,7,7,80,9,9])
  f.series(:name=>'Jane', :data=> [1, 3, 4, 3, 3, 5, 4,-46,7,8,8,9,9,0,0,9])
  f.xAxis(type: :datetime)
end 
```

我想有一个天间隔的时间序列，像这样[http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/plotoptions /系列点开始日期时间/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/plotoptions/series-pointstart-datetime/)。

上面的代码生成以下 html ( [http://jsfiddle.net/nUxvA/](http://jsfiddle.net/nUxvA/) )

我试图比较两者并且情节选项不同。如何在 x 轴上设置日间隔刻度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T02:34:13.503

上面的代码有3个问题。

1.  pointInterval 必须以毫秒为单位，因此 1.day 应该是 1.day * 1000
2.  pointStart 必须以 UTC 毫秒为单位，因此 10.days.ago 应该是 10.days.ago.getutc.to_i * 1000
3.  areaspline 应该是系列

在 x 轴上绘制日期。

# alassetslibrary - 如何在 ALAssetsLibrary 中使用异步枚举器存储资产？

> ID：13211003
> 
> 赞同：3
> 
> 时间：2012-11-03T16:15:56.457
> 
> 标签：alassetslibrary

我正在尝试从照片库中提取所有图像。问题是该方法`[ALAssetsGroup enumerateAssetsUsingBlock:]`是异步的，所以当我尝试使用资产时，枚举器还没有开始填充我的资产数组。这是我的代码：

```
 NSMutableArray* photos = [[NSMutableArray alloc] init];

        void (^assetEnumerator)(ALAsset *, NSUInteger, BOOL *) = ^(ALAsset *result, NSUInteger index, BOOL *stop) {
            if(result != nil) {
                if(![assetURLDictionaries containsObject:[result valueForProperty:ALAssetPropertyURLs]]) {
                    if(![[result valueForProperty:ALAssetPropertyType] isEqualToString:ALAssetTypeVideo]) {
                        UIImage* img = [UIImage imageWithCGImage:[[result defaultRepresentation] fullScreenImage]];

                        MyPhoto *photo;
                        photo = [MyPhoto photoWithImage:img];
                        [photos addObject:photo];
                    }
                }
            }
        };

        [[assetGroups objectAtIndex:1] enumerateAssetsUsingBlock:assetEnumerator];

        self.photos = photos;
        NSLog(@"Self.Photos %@", self.photos); 
```

此块运行后`self.photos`为空。我猜这是因为枚举器块在另一个线程中执行并且`photos`在分配中为空`self.photos = photos`？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T18:09:27.553

如您所说，它是异步的，因此您需要异步进行最终分配。当枚举器耗尽资产时，它将返回 nil 作为结果。这只会发生一次，并且总是作为枚举的最后一个动作。所以推荐的模式是：

```
void (^assetEnumerator)(ALAsset *, NSUInteger, BOOL *) = ^(ALAsset *result, NSUInteger index, BOOL *stop) {
    if(result != nil) {
        // ... process result ...
        [photos addObject:photo];
    }
    else {
        // terminating
        self.photos = photos
        NSLog(@"Self.Photos %@", self.photos);

        // you can now call another method or do whatever other post-assign action here
    }
}; 
```

# audio - 如何制作自定义音频格式和自定义播放器

> ID：13211011
> 
> 赞同：3
> 
> 时间：2012-11-03T16:16:25.643
> 
> 标签：audio, core-audio, avaudioplayer

像 .mp3、.wav 一样，我可以创建自己的自定义格式吗？只能由我创建的自定义播放器播放。但与 .mp3 具有相同的质量 我不希望我的歌曲被其他人复制。有我的播放器的人可以玩。有没有可用的开源软件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T16:23:20.060

可以，但会非常困难。您将需要提出一种专有的音频编码/压缩格式，即使是那些做了几十年的人也仍然没有完善它。

你应该做的是这个。使用您喜欢的加密算法和只有您知道的密码来加密 MP3 等音频文件。然后在您的“自定义播放器”中，只需在播放之前解密文件即可。通过这种方式，您可以将 MySong.mp3 加密为 MySong.whatever 加密且无法播放的内容，除非您知道播放器中嵌入的密码。

# c# - 获取实现接口的“默认”具体类

> ID：13211012
> 
> 赞同：3
> 
> 时间：2012-11-03T16:16:41.240
> 
> 标签：c#, .net, json.net, deserialization

我正在实现一个自定义（和通用）Json.net 序列化程序，并在路上遇到了一个障碍，我可以使用一些帮助。

当反序列化器映射到作为接口的属性时，我如何才能最好地确定要构造哪种对象以反序列化以放入接口属性中。

我有以下内容：

```
[JsonConverter(typeof(MyCustomSerializer<foo>))]
class foo 
{
    int Int1 { get; set; }
    IList<string> StringList {get; set; }
} 
```

我的序列化程序正确地序列化了这个对象，但是当它回来时，我尝试将 json 部分映射到对象，我有一个 JArray 和一个接口。

我目前正在实例化任何可枚举的东西，比如 List

```
 theList = Activator.CreateInstance(property.PropertyType); 
```

这可以在反序列化过程中使用，但是当属性是 IList 时，我会收到关于无法实例化接口的运行时抱怨（显然）。

那么我怎么知道在这种情况下要创建什么类型的具体类呢？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T16:48:57.597

您可以创建一个字典，将接口映射到您认为应该是默认的任何类型（“接口的默认类型”不是语言中定义的概念）：

```
var defaultTypeFor = new Dictionary<Type, Type>();
defaultTypeFor[typeof(IList<>)] = typeof(List<>);
...
var type = property.PropertyType;
if (type.IsInterface) {
    // TODO: Throw an exception if the type doesn't exist in the dictionary
    if (type.IsGenericType) {
        type = defaultTypeFor[property.PropertyType.GetGenericTypeDefinition()];
        type = type.MakeGenericType(property.PropertyType.GetGenericArguments());
    }
    else {
        type = defaultTypeFor[property.PropertyType];
    }
}
theList = Activator.CreateInstance(type); 
```

（我没有尝试过这段代码；如果您遇到问题，请告诉我。）

# java - 包含时间 (1H4M10S) 的字符串转换为秒

> ID：13211015
> 
> 赞同：2
> 
> 时间：2012-11-03T16:16:51.040
> 
> 标签：java, time

我想将一个看起来像“5W3D10H5M10S”的字符串转换为秒，当将前一个字符串作为参数时，该函数将返回“3319510”。

*   W = 周
*   D = 天数
*   H = 小时
*   M = 分钟
*   S = 秒

我一直在想办法做到这一点，但没有一个是有效的，如果有人能指出我正确的方向，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T16:39:26.910

您可以在正则表达式的帮助下将其解析回来，请参见下面的 Java 7 实现：

```
 String str = "5W3D10H5M10S";
    String pat = "((?<week>\\d+)W)?((?<day>\\d+)D)?((?<hour>\\d+)H)?((?<min>\\d+)M)?((?<sec>\\d+)S)?";

    Matcher m = Pattern.compile (pat).matcher(str);

    if(m.matches()) {
        int week = Integer.parseInt( m.group("week") );
        int day  = Integer.parseInt( m.group("day") );
                    //And so on ..
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T16:36:18.037

你可以用一个正则表达式和一个简单的循环来做到这一点：

```
private static final int[] timeMul = new int[] {7, 24, 60, 60, 1};
private static final Pattern rx = Pattern.compile(
    "(?:(\\d+)W)?(?:(\\d+)D)?(?:(\\d+)H)?(?:(\\d+)M)?(?:(\\d+)S)?"
);
public static int getSeconds(String str) {
    Matcher m = rx.matcher(str);
    if (!m.find()) {
        return -1;
    }
    int res = 0;
    for (int i = 0 ; i != m.groupCount() ; i++) {
        String g = m.group(i+1);
        res += g == null ? 0 : Integer.parseInt(g);
        res *= timeMul[i];
    }
    return res;
} 
```

[链接到ideone。](http://ideone.com/yEw91S)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T16:45:48.467

如何将您的字符串转换为表达式并`ScriptEngineManager`进行计算？

```
public void testIt() throws Exception {
        final String in = "5W3D10H5M10S";
        final String after = in.replaceAll("W", "*7D").
                replaceAll("D", "*24H").
                replaceAll("H", "*60M").
                replaceAll("M", "*60+").
                replaceAll("S", "");
        final ScriptEngineManager manager = new ScriptEngineManager();
        final ScriptEngine engine = manager.getEngineByName("js");
        final Object result = engine.eval(after);
        System.out.println("Result:" + String.valueOf(result));
    } 
```

输出：

```
Result:3319510.0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T16:38:14.153

最简单的方法是简单地遍历文本，直到它到达一个非数字字符，然后获取前一个字符位置的子字符串并获取该文本部分，将其解析为 int 并将其乘以根据字符所需的数量。

例子：

```
public long getSeconds(String funnyFormat) 
{
    long seconds = 0;
    int lastIndex = 0;
    for(int i = 0;i<funnyFormat.length;i++) {
        char cur = funnyFormat.charAt(i);
        if(cur < '0' && cur > '9') {
            //If it's not a Number
            int seg = Integer.parseInt(funnyFormat.substring(lastIndex,i));
            lastIndex = i+1;
            switch(cur){
            case 'H':
                long += seg*3600;
                break;
            case 'M':
                long += seg*60;
                break;
            case 'S':
                long += seg;
                break;
            //And so on and so forth
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-03T16:41:29.880

您必须对此进行调整以处理一些边界条件和意外输入...

```
long wdh(String fmt) {

    long tot = 0;
    int current = 0;
    for (char c : fmt.toCharArray()) {

        if (Character.isDigit(c)) {
            current *= 10;
            current += c - '0';
            continue;
        }

        switch (c) {

            case 'W': tot += WEEK_SECONDS * current; current = 0; continue;
            case 'D': tot += DAY_SECONDS * current; current = 0; continue;
            case 'H': tot += HOUR_SECONDS * current; current = 0; continue;
            case 'M': tot += MINUTE_SECONDS * current; current = 0; continue;
            case 'S': tot += current; break;
        }
    }

    return tot;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-03T17:22:13.327

**编辑：一点简化（更少的字符串操作）**

```
 DateFormat dateFormat = new SimpleDateFormat("d'D'HH'H'mm'M'ss'S'");
    dateFormat.setTimeZone(TimeZone.getTimeZone("GMT"));
    String dateString = "5W3D10H5M10S";
    String[] dateAndWeek = dateString.split("W");
    Calendar cal = Calendar.getInstance(TimeZone.getTimeZone("GMT"));
    cal.setTime(dateFormat.parse(dateAndWeek[1]));
    cal.add(Calendar.DATE, 1);
    cal.add(Calendar.WEEK_OF_YEAR, Integer.parseInt(dateAndWeek[0]));
    long dateSeconds = cal.getTimeInMillis()/1000;//<--3319510 
```

# php - Symfony2 和 Doctrine - 在插入时生成代码

> ID：13211018
> 
> 赞同：2
> 
> 时间：2012-11-03T16:17:19.437
> 
> 标签：php, database, symfony, callback, doctrine

使用 Symfon2.0 和 Doctrine，我正在尝试执行以下操作：

1.  在数据库中插入新行
2.  在插入的那一刻，自动生成一个代码并插入它。
3.  该代码与表的 ID 有关。就像是`<something>/row_id`

我怎样才能轻松做到这一点？

我一直在尝试 Doctrine Livecycle 回调。但：

*   PrePersist 仍然没有 ID。
*   PostPersist 有 ID，但不知何故，插入已经完成，虽然我可以从实体设置任何属性，但我不知道如何使其“再次”持久保存到数据库中。

那边有什么线索吗？

还有其他正确的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T23:47:09.693

在您的创建控制器中：

> ```
> if ($form->isValid()) {
>         $em = $this->getDoctrine()->getManager();
>         $em->persist($entity);
>         $em->flush();
> 
>         $entity->setCode($code);
>         $em->persist($entity);
>         $em->flush();
> 
>         return $this->redirect($this->generateUrl('entity_show'
>            ,array('id' => $entity->getId())));
>     } 
> ```

第二个块 ($entity->setCode...) 是您需要添加的内容，需要根据您的目的进行定制

或者，您可以使用侦听器：

> ```
> <?php
> 
> namespace ormed\ormedBundle\Listener;
> 
> use Doctrine\ORM\Event\OnFlushEventArgs; use
> Symfony\Component\DependencyInjection\Container;
> 
> class LastModifiedListener {
> 
>   private $container;
> 
>   public function __construct(Container $container){$this->container = $container;}
> 
>   public function onFlush(OnFlushEventArgs $eventArgs)
>   {
>       $entityManager = $eventArgs->getEntityManager();
>       $unitOfWork = $entityManager->getUnitOfWork();
> 
>       foreach ($unitOfWork->getScheduledEntityInsertions() AS $entity) {
>           $entity->setCode( $code );
> 
>           $entityManager->persist($entity);
>           $classMetadata = $entityManager->getClassMetadata(get_class($entity));
>           $unitOfWork->recomputeSingleEntityChangeSet($classMetadata, $entity);
> } } } 
> ```

# soap - Zimbra SOAP SearchRequest 返回未知文档错误

> ID：13211020
> 
> 赞同：0
> 
> 时间：2012-11-03T16:18:41.573
> 
> 标签：soap, zimbra

我正在尝试发送`SearchRequest`以在邮箱中找到我需要的东西。但是，我不断收到`unknown Document`错误消息。

```
POST /service/soap HTTP/1.1
SOAPAction: ""
Content-Type: text/xml;charset="utf-8"
Accept: text/xml
Host: 192.168.138.133
Content-Length: 514
Expect: 100-continue

<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  <soap:Header>
    <authToken>%token acquired from AuthRequest%</authToken>
    <context xmlns="urn:zimbra" />
  </soap:Header>
  <soap:Body>
    <SearchRequest xlmns="urn:zimbraMail">
      <query>is:unread</query>
    </SearchRequest>
  </soap:Body>
</soap:Envelope> 
```

在我看来，我`xmlns`指定的错误，但[zimbra soap api 参考](http://zimbra.svn.sourceforge.net/viewvc/zimbra/trunk/ZimbraServer/docs/soap.txt?revision=843&view=markup)说命名空间应该是`zimbraMail`. 我仍然不断收到错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:30:11.697

标题中的某处不应该有一个会话吗？（在上下文中）

[http://dropcanvas.com/521xc/91](http://dropcanvas.com/521xc/91)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-20T15:55:38.563

尝试

```
<soap:Header>
    <context xmlns="urn:zimbra" >
          <authToken>%token acquired from AuthRequest%</authToken>
    </context>
  </soap:Header> 
```

# spring - Spring Security，修改密码后绕过登录页面

> ID：13211021
> 
> 赞同：3
> 
> 时间：2012-11-03T16:18:49.010
> 
> 标签：spring, model-view-controller, spring-security

我对 Java/Spring/MVC 比较陌生。我希望有人能对此有所启发，因为这个问题将在没有得到解决的情况下毁掉另一个周末。

目前我正在做一个项目，实施几个 RFC。每个 RFC 都有自己的“挑战”，从更改休眠查询和存储过程到微小的文本更改以及向表单添加额外字段。

我现在面临的问题（我认为）与 Spring 安全性有关。

目前的情况：
要登录到应用程序，用户由登录页面（/user/login.jsp）呈现。输入用户名和密码后，用户被发送到欢迎页面（/welcome/hello.jsp）。

如果用户忘记了他们的密码，他们会使用一个链接发送一封电子邮件，其中提供一个链接到可以输入新密码的页面 (/welcome/newPassword?code=xxx)。输入提交按钮将进行一些验证，将密码保存在数据库中并在页面上显示“密码已更改”消息。要进入应用程序，用户现在必须使用新密码登录。

客户想要什么：提交新密码后，用户应该会自动使用新密码登录并重定向到/welcome/hello.jsp

我在网上搜索，但找不到我正在寻找的场景（或者可能没有认出它！）。

我认为可以解决问题的方法：

我在 WelcomeController 中有这个方法，它目前处理新密码：

```
@RequestMapping(method = RequestMethod.POST)
public void newPassword(Model model, HttpSession httpSession, ModelAttribute(PASSWORD) Passwords password, BindingResult result) {
    logger.debug("Posting password for new password");
    ScreenMessage message = null;

    //
    try {
        // errors from initBinder - back to page
        if (result.hasErrors()) {
            return;
        }

        // Validate input: on error go back to form
        passwordValidator.validate(password, result);
        if (result.hasErrors()) {
            return;
        }

        // Save password
        passwordService.createNewOwnPassword(result, password);
        if (result.hasErrors()) {
            return;
        }

        // No errors
        message = new ScreenMessage();
        message.setText(CHANGED);
        message.setArg(THIS_PASSWORD, 0);
        model.addAttribute(MESSAGE, message);
        httpSession.setAttribute(ACTION_READ, Boolean.TRUE);

        // Errors are fatal.
    } catch (Exception e) {
        logger.error("ERROR-CHANGE-password for user: " + password.getUser().getLoginName(), e);
        result.reject(  ERROR_FATAL, new Object[] { password}, ERROR_FATAL);
    } finally {
        model.addAttribute(PASSWORD, password);
    }
} 
```

我想我可以简单地改变这个方法让它返回一个 ModelAndView 并使用重定向：

```
ModelAndView mav = new ModelAndView("redirect:/welcome/hello", (ModelMap) model);
        return mav; 
```

但是：它一直将我发送到 /user/login，正是我不想去的页面......

可能很方便的额外信息：

据我所知，该应用程序使用的是 Spring 2.5。

（我希望相关）我的 security-applicationContext.xml 的一部分：

```
 <!--  always-use-default-target="true" -->
    <security:form-login login-page="/dyn/user/login" 
        login-processing-url="/dyn/user/j_spring_security_check"
        default-target-url="/dyn/welcome/hello" 
        always-use-default-target="true"
        authentication-failure-handler-ref="exceptionTranslationRouting" />

    <security:access-denied-handler error-page="/dyn/welcome/hello" />

    <security:logout logout-success-url="/dyn/user/logout" invalidate-session="true" /> 
```

我重定向到 /welcome/hello 的想法是不是太简单了，还是我只是错过了一些小东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T21:52:27.157

Firstly, you'd better move your logic from web controller (I don't like password validation) to component dedicated to password change. This will allow you to logically separate parts of your application. Filter maybe? (more later) Or special service?

Secondly, take a look at the source code of Spring Security. From my experience, I can tell you that any customization in Spring Security is only possible if you understand its architecture (especially filter chain). I would recommend taking look at class `AbstractAuthenticationProcessingFilter`. It's responsible for authenticating users when they provide username and password in your application. Take a look at the method `AbstractAuthenticationProcessingFilter.successfulAuthentication`.

This line of that method sets security context which makes the user logged in:

```
 SecurityContextHolder.getContext().setAuthentication(authResult); 
```

Reference authResult is of type `Authentication`. It is an interface implemented by for instance `UsernamePasswordAuthenticationToken`. Take a look at `UsernamePasswordAuthenticationFilter.attemptAuthentication` method for example of how to construct such an object.

Going back to filter solution: I personally would think about implementing my own filter that would extend `AbstractAuthenticationProcessingFilter`. It would be responsible for password change. That way you don't have to think about things like session change on successful authentication. You just need to inject it in you XML.

To sum up,

classes that are recommended to look at:

*   `AbstractAuthenticationProcessingFilter`
*   `UsernamePasswordAuthenticationToken`
*   `UsernamePasswordAuthenticationFilter`

You should read Spring Security Documentation, especially parts about architecture, filter chain and its role in authenticating users.

[http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#overall-architecture](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#overall-architecture)

# qt - 带负数的 QScriptEngine，pe：5*-2

> ID：13211026
> 
> 赞同：2
> 
> 时间：2012-11-03T16:19:29.603
> 
> 标签：qt, qregexp

我正在尝试运行一个脚本，该脚本仅评估具有 add、subs、mults 和 div 的表达式，但可以使用负数。这个负数取自如下指令：

```
set 1, 5 * D[5] 
```

这意味着您必须存储`5 * [whatever it's in a variable]`. 如果这个变量包含一个负数，比如说`-2`，表达式将为`5*-2`，并且这个表达式由 QScriptEngine 计算，结果为 0（错误）。我需要将这样的表达式解析为`5*(-2)`. 在 PERL 中，执行此操作的 RegExp 将是：

```
$expresion =~ s/\[\\*\\+\\-\\/](\\-\d+)/($1)/g; 
```

我怎样才能在 Qt 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T08:51:18.810

```
QString s = "...";
s.replace(QRegExp("[\\*\\+\\-\\/](\\-\\d+)"), "\\1"); 
```

见[http://doc.qt.io/qt-4.8/qstring.html#replace-16](http://doc.qt.io/qt-4.8/qstring.html#replace-16)

# text-processing - Java 文本预处理和清理

> ID：13211027
> 
> 赞同：4
> 
> 时间：2012-11-03T16:19:47.750
> 
> 标签：text-processing, java

您能否向我推荐用于文本预处理和清理的 java 库？该库应执行以下任务：

*   将所有动词转换为不定式
*   将所有名词转换为单数形式
*   删除无用的（对于文本的意义）词

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T00:57:12.897

将单词转换为规范形式（例如，动词转换为不定式，名词转换为单数）称为*[词形还原](http://en.wikipedia.org/wiki/Lemmatisation)*。[Standford CoreNLP](http://nlp.stanford.edu/software/corenlp.shtml)是一种基于 Java 的词形还原器。

对于“无用词”，您可能需要“停用词” - 没有标准列表，但互联网上流传着很多或多或少相同的功能，唯一的区别是它们包含多少词（通常在 100 到 100 之间） 1000)。我以前知道有人使用[这个列表](http://www.lextek.com/manuals/onix/stopwords1.html)。删除停用词时，请记住在查找匹配项时忽略大小写。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-03T16:25:32.130

不确定这是否能满足您的所有需求，但请查看 mrsqg。

[http://code.google.com/p/mrsqg/](http://code.google.com/p/mrsqg/)

# python - 如何从当前请求处理程序将数据发送到不同的请求？（带有 ThreadingMixIn 的 Python SocketServer）

> ID：13211045
> 
> 赞同：3
> 
> 时间：2012-11-03T16:22:13.533
> 
> 标签：python, socketserver

我正在用 Python 编写一个多人游戏服务器和客户端，使用内置的 SocketServer 的 TCPServer 和 ThreadingMixIn，因为它似乎比手动管理套接字和线程模块更容易。（为此，我想坚持使用内置模块。）它使用类似于 HTTP 通信 (GTP) 的协议。

仅涉及一个客户端的请求已经生效。如果客户端发送请求“ ”，服务器只需向该客户端`GET /index.html GTP/0.2`响应“ ”。`GTP/0.2 200 OK`但是如果客户端 A 和 B 之间正在进行游戏（如服务器状态中记录的那样）并且客户端 A 发送请求“ `TURN <my turn info> GTP/0.2`”，那么在轮到玩家 A 之后，服务器如何通知玩家 A*和*B 更改？

到目前为止，这是我的代码的要点：

```
import SocketServer
import socket, threading # not yet used

class ThreadingGameServer(SocketServer.ThreadingMixIn, SocketServer.TCPServer):
    def __init__(self, server_address, RequestHandlerClass):
        SocketServer.TCPServer.__init__(self, server_address, RequestHandlerClass)
        self.players = []
        self.games = []

class GameRequestHandler(SocketServer.BaseRequestHandler):
    def setup(self):
        self.request_data = None
        self.response_data = None

    def handle(self):
        while True:
            self.request_data = self.request.recv(4096)
            if not self.request_data:
                break # Client disconnected
            # delegate handling to do_GET, do_POST, etc
            do_method = 'do_' + self.request_data.split()[0]
            if not hasattr(self, do_method):
                self.request.sendall("GTP/0.2 501 Not Implemented\r\n\r\n")
                continue
            try:
                do = getattr(self, do_method)
                do()
            except Exception as e:
                break

    def do_GET(self):
        body = '<contents of {}>'.format(self.my_request.param)
        data = "GTP/0.2 200 OK\r\nContent-Length: {}\r\n\r\n{}".format(len(body), body)
        self.request.sendall(data)

    def do_LOGIN(self):
        """
        Create a player with the requested username and this handler.
        Add the player to self.server.players.
        Respond with 200 OK, body "Welcome!, <username>".
        """

    def do_PLAY(self):
        """
        If the requested opponent is not logged in and ready to play, respond with 403 Forbidden.
        Create a game with this player and the requested opponent.
        Remove the two players from self.server.players.
        Add the game to self.server.games.
        Respond with 200 OK, body "Begin game with <opponent>".
        How do I send "Begin game with <this player>" to the opponent as well?
        """

    def do_TURN(self):
        """
        If it is not this player's turn, respond with 403 Forbidden.
        Modify the game's state in self.server.games, including making it be the opponent's turn.
        Respond with 200 OK, body "<new game state>".
        How do I send the response to the opponent as well?
        """

    def do_EXIT(self):
        """
        If this player is logged in, log them out.
        If they are in a game, respond to their opponent with 200 OK, body "Game over" (how?).
        End their request handler.
        """

class GameClient(object):
    def __init__(self, server_address):
        self.socket = socket.create_connection(server_address)

    def run(self):
        """
        Read user input, e.g. "> login foobar".
        Send request to server, e.g. self.socket.sendall("LOGIN foobar GTP/0.2\r\n\r\n")
        Get server's reply via self.socket.recv(4096)
        Print the reply body, e.g. "Welcome, foobar!"
        """

# On the server machine
server = ThreadingGameServer((socket.gethostname(), 4242), GameRequestHandler)
server.serve_forever()

# On each client machine
client = GameClient(('server.mygame.com', 4242))
client.run() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:19:18.037

可能有更好的方法来做到这一点，但是我很久以前为自己设计的方法（回到我刚接触 Python 的时候！）是为每个客户提供一种收件箱。然后，每个客户端会定期向服务器询问其收件箱中的内容，并相应地解析这些命令。

我会密切关注这个问题，我很想看到比我更好的方法。我还建议在尝试之前等待答案。

# drupal - 在 Open Atruim 日历中更改事件类型

> ID：13211046
> 
> 赞同：0
> 
> 时间：2012-11-03T16:22:22.743
> 
> 标签：drupal, open-atrium

我正在尝试更改 Open Atrium 日历中的事件类型。我已经完成了 UI 中的所有设置，但在任何地方都找不到选项。有谁知道如何通过代码更改这些？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T13:11:55.683

管理 --> 内容 --> 分类

# linux - 如何使用 Perl 调试器的 *supported* 编辑器？

> ID：13211060
> 
> 赞同：5
> 
> 时间：2012-11-03T16:24:06.570
> 
> 标签：linux, perl, debugging

Perl 调试器总是说：“编辑器支持可用”。我相信每个人都可以看到这个，*但是*我该如何使用它呢？

```
my-computer$ perl -de2

Loading DB routines from perl5db.pl version 1.33
Editor support available.

Enter h or `h h' for help, or `man perldebug' for more help.

main::(-e:1):   2
  DB<1> 
```

顺便说一句，我在 Linux/ [Ubuntu 11.04](https://en.wikipedia.org/wiki/Ubuntu_version_history#Ubuntu_11.04_.28Natty_Narwhal.29) (Natty Narwhal) 机器上得到了上述提示。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T16:52:09.453

消息有点混乱。它告诉你它可以支持*在编辑器中运行*，而不是说有一个特殊的 Perl 调试器编辑器。

Perl 调试器可以检测它是在与终端对话还是在编辑器中运行。这控制了许多事情，最大的是调试器是否打印任何内容或将其留给编辑器来处理显示。如果您真的很好奇，[请](https://github.com/mirrors/perl/blob/blead/lib/perl5db.pl)查看`$slave_editor`.

为什么它觉得有必要告知用户这一点？我做了一点挖掘，调试器[过去只支持 Emacs 调试](https://github.com/mirrors/perl/commit/055fd3a9)。通知用户“Emacs 支持可用”比*某处的**某个*编辑器可以与调试器一起使用更有用。Emacs 消息[与调试器的第一个版本一起出现，完全由 Ilya 的头部形成](https://github.com/mirrors/perl/commit/d338d6fe1dfdfdbc07c2d6d7a2a4ae7db5887d93)。

 *Perl 调试器实际上也是三个实体。perl5db.pl 脚本、[DB API](https://metacpan.org/module/DB)和这两个使用的语言本身的调试挂钩。编辑器可以使用 perl5db.pl，也可以直接使用 DB 进行对话。

有一些编辑器可以挂接到 Perl 调试器中。一种是 Emacs，您可以通过在 Emacs 中打开 Perl 程序并使用`M-x perldb`. [Komodo](http://www.activestate.com/komodo-ide)和[Padre](http://padre.perlide.org/trac/wiki/Features/Perl5Debugger)也有调试器支持。*

# javascript - 如何从另一个 js 文件中使用 setActiveTab

> ID：13211064
> 
> 赞同：1
> 
> 时间：2012-11-03T16:24:30.947
> 
> 标签：javascript, android, url, titanium

我正在尝试使用 TabGroup，然后我想使用另一个 js 文件中的函数 setActiveTab 但出现错误。

当我单击第三个选项卡中的 button3 时，它显示未定义 tabGroup。

这是在 app.js 中

```
var tabGroup = Titanium.UI.createTabGroup()

var window1 = Titanium.UI.createWindow({
    backgroundColor: 'cyan'
})
var window2 = Titanium.UI.createWindow({
    backgroundColor: 'magenta'
})
var window3 = Titanium.UI.createWindow({
    backgroundColor: 'yellow',
    url: 'thirdTab.js'
})

var tab1 = Titanium.UI.createTab({
    //icon
    title: 'First tab',
    window: window1
})
var tab2 = Titanium.UI.createTab({
    title: 'Second tab',
    window: window2
})
var tab3 = Titanium.UI.createTab({
    title: 'Third tab',
    window: window3
})

tabGroup.addTab(tab1)
tabGroup.addTab(tab2)
tabGroup.addTab(tab3)
tabGroup.open()

var button1 = Titanium.UI.createButton({
    title: 'go to second',
    widgh: Titanium.UI.SIZE,
    height: Titanium.UI.SIZE
})
button1.addEventListener('click', function(e){
    tabGroup.setActiveTab(1);
})

var button2 = Titanium.UI.createButton({
    title: 'go to third',
    widgh: Titanium.UI.SIZE,
    height: Titanium.UI.SIZE
})
button2.addEventListener('click', function(e){
    tabGroup.setActiveTab(2);
})

window1.add(button1)
window2.add(button2) 
```

这是在thirdTab.js

```
var window3 = Titanium.UI.currentWindow

var button3 = Titanium.UI.createButton({
    title: 'go to first',
    widgh: Titanium.UI.SIZE,
    height: Titanium.UI.SIZE
})
window3.add(button3)

button3.addEventListener('click', function(e){
    tabGroup.setActiveTab(0);
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T20:57:32.580

通过使用 url: 'thirdTab.js' 加载第三个窗口，您正在创建一个单独的 JavaScript 上下文。您可以像创建 window1 和 window2 一样创建 window3，并且可以访问相同的 JavaScript 变量。

为了更好地在 Titanium 中构建您的代码，您应该阅读[Titanium 中的 CommonJS 模块](https://wiki.appcelerator.org/display/guides/CommonJS+Modules+in+Titanium)。我喜欢的方法，因为它非常像钛，可能会是这样的：

## 应用程序.js

```
....
var window3 = require('window3').createView(tabGroup);
.... 
```

## window3.js

```
exports.createView = function(tabGroup) {
    var win = Ti.UI.createWindow({
        backgroundColor: 'yellow'
    });
    var button = Ti.UI.createButton({
        title: 'go to first',
        width: Ti.UI.SIZE, height: Ti.UI.SIZE
    });
    button.addEventListener('click', function(e){
        tabGroup.setActiveTab(0);
    });
    win.add(button);
    return win;
}; 
```

通过这种方式，您可以准确地知道传递了哪些变量，以及它们在哪里被使用。

希望这可以帮助！

# google-maps - 从移动设备打开时 gmap3 太小

> ID：13211070
> 
> 赞同：0
> 
> 时间：2012-11-03T16:25:10.053
> 
> 标签：google-maps, jquery-gmap3

我用 html5、jquery 和谷歌地图开发了一个移动应用程序。

当我使用法线地图（没有 gmap3）时，街道名称和叠加层的大小足以从移动设备上看到。

但是当我使用 gmap3 时，街道名称和叠加层的大小非常小。我可以从 gmap3 更改任何设置以使其也适用于移动设备吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T22:53:22.767

我找到了方法。在工作正常的示例中，head 标签中有这一行：

<meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>

使用移动设备打开比 PC 浏览器更大的地图，就是这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T07:29:11.270

这仍然很奇怪，你能在 gmap3 论坛上发布你的 2 个代码（有和没有）吗？

*通知：gmap3 5.0 版本已于上周发布*

# java - 有图层问题的 PrimeFaces 菜单

> ID：13211071
> 
> 赞同：0
> 
> 时间：2012-11-03T16:25:13.470
> 
> 标签：java, css, jsf-2, primefaces

我有`<p:menubar>`一个 xhtml 模板。围绕它的 div 具有以下 CSS 属性：

```
position: fixed;
top: 44px;
width: 100%; 
```

所以我可以在用户向下滚动页面时修复菜单标题。

现在的问题是某些 Prime Faces 组件的图标和标题溢出了菜单。

![打印屏幕](../Images/f6f04f5f95c8cb1dc96fa2f182d6a06c.png)

我尝试使用 z-index 但没有成功。我想在 PrimeFaces 中还有另一种解决方案，而不是 z-index。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T00:57:43.207

根据 PrimeFaces 默认样式表`primefaces.css`，`<p:message(s)>`图标是相对定位的。

```
.ui-messages-info-icon, .ui-messages-warn-icon, .ui-messages-error-icon, .ui-messages-fatal-icon, .ui-message-info-icon, .ui-message-warn-icon, .ui-message-error-icon, .ui-message-fatal-icon {
    background: url("/omnifaces/javax.faces.resource/messages/messages.png.xhtml?ln=primefaces") no-repeat;
    display: block;
    float: left;
    margin: 0;
    padding: 0;
    position: relative;
} 
```

我首先不确定为什么它是相对定位的，因为它似乎不需要被抵消，也没有任何绝对定位的孩子。也许它已被用作一些（很可能是特定于 IE）的解决方法/hack 用于其他东西（如果这是“具有布局”相关的，开发人员最好使用它`overflow: hidden`来代替）。因此，只需将其设为默认值即可`position: static`修复它。

将以下内容添加到您的覆盖样式表以实现此目的：

```
.ui-messages-info-icon, .ui-messages-warn-icon, .ui-messages-error-icon, .ui-messages-fatal-icon, .ui-message-info-icon, .ui-message-warn-icon, .ui-message-error-icon, .ui-message-fatal-icon {
    position: static;
} 
```

或者，您当然也可以设置`z-index`具有疯狂高价值的菜单，正如您自己发现的那样。不过，我不认为这是一个可靠的解决方案，这是一种解决方法/破解方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T17:48:33.837

`z-index: 9999999`通过将 设置为`<p:outputPanel>`周围的菜单而不是在菜单中设置样式属性来解决它。

# javascript - 任何页面上的 ExecJS::RuntimeError，包括 coffeescript

> ID：13211073
> 
> 赞同：1
> 
> 时间：2012-11-03T16:25:17.003
> 
> 标签：javascript, ruby-on-rails, node.js, coffeescript, execjs

```
ExecJS::RuntimeError in Users#index 
```

我在我的应用程序的每个页面上都收到这样的错误。过去一切正常......由于某种原因，当我重新启动我的应用程序时，它现在无法正常工作。

我在 Windows 上

我已经安装了节点，尝试将以下内容添加到我的 boot.rb 以确保它正在使用节点

```
ENV['EXECJS_RUNTIME'] = 'Node' 
```

我有

```
gem 'execjs' 
```

但不是 ruby​​racer，因为根据我的研究，

1.  节点应该也可以工作
2.  rubyracer 无法在 Windows 上安装（当我尝试安装 libv8 时，会在 Windows 上出现错误）

我确定这很愚蠢，我的意思是它只是在工作。我正在使用瘦服务器并从`thin start`

我的日志中的错误是

```
ActionView::Template::Error (["ok","<Some OK looking javascript code>"])
(in <path>/global.js.coffee) 
```

我的 application.js

```
//= require jquery
//= require jquery_ujs
//= require bootstrap
//= require global
//= require_tree . 
```

# c++ - 返回时指针的值是垃圾

> ID：13211074
> 
> 赞同：1
> 
> 时间：2012-11-03T16:25:31.380
> 
> 标签：c++, pointers, for-loop

> **可能重复：**
> [可以在其范围之外访问局部变量的内存吗？](https://stackoverflow.com/questions/6441218/can-a-local-variables-memory-be-accessed-outside-its-scope)

```
#include <iostream>
#include <string>

using namespace std;

char* reverse(char* input) 
{
    char b[11];

    for (int i=0; i<11; i++)    {b[10-i]=input[i];}
    for (int u=0; u<11; u++)    {cout<<b[u];}
    cout<<endl;
    return &b[0];
}

int main ()
{
     char ali[]="ali is good";
     char *a=&ali[0];
     char *b=reverse(a);

     for (int i=0; i<11; b++, i++)  
        {
            cout<<*b+i<<endl;
        }
     cout<<endl;
     system("pause");
     return 0;
} 
```

这是一个反转字符串的简单程序，当您在函数中打印结果时效果很好，但是当将字符串的指针传递给 Main 然后打印它时，它会打印类似垃圾的东西。

为什么奇怪？因为如果我打印 *b+2 或 *b+5 或任何我喜欢的 const ，它工作得很好，但如果我在 *b+i 这样的循环中用 int 替换 const 则它不起作用！

PS这不是硬件！！我“是”一个长期的程序员，忘记了这一切让我感到羞耻。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T16:28:31.737

函数内声明的变量是**自动**存储持续时间对象，并在函数末尾超出范围（因此不再有效）。要分配比函数寿命更长的存储，您需要**动态**存储持续时间对象（这些是通过 new 分配的）：

```
char *b = new char[11]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T16:29:54.550

您永远不应该返回指向局部变量的指针，这就是您看到错误的原因。

局部变量在堆栈上分配。当变量超出范围时，内存被释放。

现在您正在尝试访问已被取消分配的变量，因为它已超出范围（并因此从堆栈中删除）

还

```
 for (int i=0; i<11; b++, i++)  
                        {
                            cout<<*(b+i)<<endl;
                        } 
```

为什么要同时增加 b 和 i？

你应该只增加 i 而不是基指针地址（b）

总之，这是您应该使用的程序

```
#include<iostream>
   using namespace std;

             void reverse(char* input,char * output) 
             {

                for (int i=0; i<11; i++)    {output[10-i]=input[i];}
                for (int u=0; u<11; u++)    {cout<<output[u];}
                cout<<endl;

            }

             int main ()
             {
                 char ali[]="ali is good";
                 char *a=&ali[0];
                 char *b=(char *)malloc(sizeof(ali));
                 reverse(a,b);

                 for (int i=0; i<11;  i++)  
                    {
                        cout<<*(b+i)<<endl;
                    }
                 cout<<endl;
                 system("pause");
                 return 0;
             } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T16:33:26.310

最后但并非最不重要的一点是，表示由（即）引发`*b+i`的对象的值，而不是您希望的值。`b``i``(*b)+i``*(b+i)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T16:49:13.587

试试这个

```
char* reverse(char* input) 
{
  int len = strlen(input);
  for (int i=0; i<len/2; ++i) 
  {
    char tmp = input[i];
    input[i] = input[len-i-1];
    input[len-i-1] = tmp;
  }
  return input;
} 
```

那么您不会返回局部变量，而是返回带有反转字符串的原始数组。

# regex - 在 Javascript 中匹配 IE7 和 IE8 中不可破坏的空格

> ID：13211077
> 
> 赞同：5
> 
> 时间：2012-11-03T16:26:34.550
> 
> 标签：regex, internet-explorer-8, internet-explorer-7, whitespace, match

我想在任何相对现代的浏览器中替换空格（因此对于 IE，版本 >= 7）。

`"Hello world!"`因此，给定我们会做的字符串：

```
<script type="text/javascript">
document.write("Result: '" + "Hello world!".replace(/\s/g, '') + "'");
</script> 
```

我们期望输出：`Result: 'Helloworld!'`

但在 IE7 和 IE8 中，尽管使用不可破坏的空间（如以下之一）失败：`&#160;`== `&nbsp;`==`\u00A0`

例如：

```
<script type="text/javascript">
document.write("Result: '" + String.fromCharCode(160).replace(/\s/g, '') + "'");
</script> 
```

将`Result: 'Helloworld!'`在 FF 和 IE >= 9 以及`Result : ' '`IE7 和 IE8 中输出。我勒个去？

这让我想知道这是否是唯一的例外？我根本找不到太多关于这个的信息。是否有一个正则表达式可以删除所有空格，*包括*不可破坏的空格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T16:32:01.130

使用这个：

 ~~~~```
replace(/(?:\s|\xA0|&nbsp;|&#160;)+/g, '') 
```~~  ~~```
replace(/[\s\xA0]+/g, '') 
```~~~~

# php - 按发布时间对 PHP 回显输出进行排序

> ID：13211079
> 
> 赞同：0
> 
> 时间：2012-11-03T16:26:42.350
> 
> 标签：php, sql, css, html

好的，所以。我今天在 stackOverflow 上问了 5 个问题，你们都很有帮助。

现在，我是一名设计师，正在学习编码，所以请耐心等待。

我有一个 mySQL 表，里面有一个小的 CMS/博客。我已经按照我现在想要的方式设计了它。这是页面的代码。

```
$result = mysql_query("SELECT * FROM Blog");
while($row = mysql_fetch_array($result))
{
    echo "<h1>" . $row['Title'] . "</h1>";
    echo "<br>";
    echo "<h2>" . "Posted on:   " . $row['Date'] . "</h2>";
    echo "<br>";
    echo "<img src='".$row['Image']."'/>";
    echo "<br>";
    echo $row['Message'];
    echo "<br>";
    echo "<br>";
} 
```

我仍在努力，所以一切都很好。

我想知道的是，这段代码正在将我的 sql 数据输出到一个页面中。例如，有什么方法可以告诉页面以什么顺序回显数据。在我的 SQL 表中，我有：

```
2012-11-03 16:16:06     This is my First Blog Post  This is the first message of the first blog post. ...   http://blog.gettyimages.com/wp-content/uploads/201. 
```

接下来是

```
2012-11-03 16:17:29     This is my Second Blog Post     This is the second message of the Second Post, You...   http://www.aviation-images.com/user/zooms/118/451n... 
```

我如何告诉页面始终在顶部显示最新的帖子，在下方显示较旧的帖子。？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T16:28:24.110

`order by`在您的查询中使用：

```
$result = mysql_query("SELECT * FROM Blog ORDER BY Date DESC"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T16:29:18.963

如果您的 MySQL 数据库模式[`DATETIME`](http://dev.mysql.com/doc/refman/5.1/de/datetime.html)用于该`Date`列，您可以简单地使用以下命令对 MySQL 查询进行排序[`ORDER BY`](http://dev.mysql.com/doc/refman/5.1/de/select.html)：

```
$result = mysql_query("SELECT * FROM Blog ORDER BY Date DESC"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T16:35:54.233

如果你有一个自动增量列`post_id`，那么你也可以使用`ORDER BY post_id DESC`。:)

# asp.net-mvc - Orchard CMS 最近的博客文章小部件备用视图

> ID：13211083
> 
> 赞同：2
> 
> 时间：2012-11-03T16:27:11.503
> 
> 标签：asp.net-mvc, asp.net-mvc-3, orchardcms

我是 Orchard CMS 和 MVC 的新手，所以请原谅我的无知。我已经进行了搜索，但没有发现任何明显相关的内容......

在我的 Orchard 网站的 Footer Quad 区域之一中，我想按标题显示最近的 5 篇博客文章。目前它以未格式化的状态显示标题、帖子、标签等（我还没有为博客设置样式）。

使用跟踪工具，我创建了一个名为的备用视图；

```
Parts.Blogs.RecentBlogPosts 
```

但是，此视图中的唯一内容是；

```
@Display(Model.ContentItems) 
```

与其他已安装的小部件不同，我编辑了备用视图 - 并没有给我任何东西来创建我需要创建的布局。

我是否选择了错误的形状/视图，或者我需要陷入一些编码？

正如我所说，我是 MVC 和 Orchard 的新手，但非常热衷于学习。一如既往，对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-18T15:15:44.750

在尝试将最近的博客文章布局与博客摘要文章区分开来时，我遇到了完全相同的问题。我遵循了这个概念

[http://weblogs.asp.net/bleroy/archive/2011/07/31/so-you-don-t-want-to-use-placement-info.aspx](http://weblogs.asp.net/bleroy/archive/2011/07/31/so-you-don-t-want-to-use-placement-info.aspx)

并创建了 Parts.Blogs.RecentBlogPosts 备用。然后，在使用形状跟踪工具浏览模型时，我找到了我正在寻找的所有元素并将它们放入我的新形状中。我知道我的方法可能不是最合适的方法，但它确实有效。对于需要做类似事情的人来说，这可能是一个起点：

```
<div class="last-news">
<ul>
@foreach (var item in Model.ContentItems.ContentItems.Items)
{
    var max = (item.ContentItem.BodyPart.Text.Length > 100) ? 100 : item.ContentItem.BodyPart.Text.Length;

    <li><header>@Display(item.ContentItem.CommonPart.PublishedUtc.ToShortDateString())</header></li>
    <li><h1><a href="/@item.ContentItem.Parts[5].Path">@Display(item.ContentItem.TitlePart.Title)</a></h1></li>
    <li>@Display(Html.Raw(item.ContentItem.BodyPart.Text.Substring(0, max)))</li>
}
</ul>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T22:40:27.377

它确实值得解释。这里的 Model.ContentItems 确实是一个 List 形状。当您使用它调用 Display 时，它将为列表形状找到最合适的模板（并且可以是替代模板）并呈现它。默认列表呈现仅呈现 UL/LI，并且在每个 LI 中，对列表元素的单个内容形状调用 Display，但使用摘要显示类型。当它依次被渲染时，系统会定位最相关的内容模板，该模板通常会渲染一堆区域，在这些区域内，部件会根据放置被推送。所以在很多嵌套级别中发生了很多事情。尽管如此，仍然可以在任何级别上覆盖整个事情。困难在于知道该放什么。最简单的方法是在形状跟踪中探索模型，看看你可以使用什么。 [http://weblogs.asp.net/bleroy/archive/2011/03/27/taking-over-list-rendering-in-orchard.aspx](http://weblogs.asp.net/bleroy/archive/2011/03/27/taking-over-list-rendering-in-orchard.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T20:25:16.127

该`Parts.Blogs.RecentBlogPosts`视图显示`Parts_Blogs_BlogPost_List`形状 ( `Parts.Blogs.BlogPost.List.cshtml`)，其中显示了 BlogPost 内容项。（您可以在 RecentBlogPostsPartDriver.cs 中看到它）。BlogPost 内容类型由 TitlePart 和 BodyPart 部分组成，它们有自己的形状和视图（或 Orchard 术语中的模板）。`Parts_Blogs_BlogPost_List`因此，要对这些模板进行一些更正，您可以尝试交替使用`Parts_Common_Body_Summary`和其他形状。

请特别参阅[Orchard 文档页面](http://docs.orchardproject.net/)上的以下说明：

1.  替补
2.  访问和渲染形状

# ruby-on-rails - 资产预编译因 twitter-bootstrap-rails gem 而失败

> ID：13211090
> 
> 赞同：3
> 
> 时间：2012-11-03T16:28:04.410
> 
> 标签：ruby-on-rails, twitter-bootstrap, asset-pipeline

我有一个带有 twitter-boostrap-rails gem 的 Rails 3.2 应用程序。运行 rake assets:precompile 失败：

```
alex@BlackBeast:~/myapp$ rake assets:precompile
/home/alex/.rvm/rubies/ruby-1.9.3-head/bin/ruby /home/alex/.rvm/gems/ruby-1.9.3-head@global/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets
rake aborted!
Invalid CSS after "...4882640c.png"")": expected "{", was ";background-pos..."
  (in /home/alex/myapp/app/assets/stylesheets/application.css)

Tasks: TOP => assets:precompile:primary
(See full trace by running task with --trace)
rake aborted!
Command failed with status (1): [/home/alex/.rvm/rubies/ruby-1.9.3-head/bin...] 
```

有什么办法可以调试这个问题吗？不知道该怎么做。

**更新：**将 twitter-bootstrap-rails gem 更新到 2.1.6 版本后，预编译现在失败并出现不同的错误：

```
rake aborted!
Invalid CSS after "}​": expected "{", was ""
  (in /home/alex/myapp/app/assets/stylesheets/application.css)
(sass):1673 
```

错误中提到的 application.css 是标准的，带有

```
*= require_self
 *= require_tree . 
```

..这使得确定哪个部分导致问题有点困难。

我可以以某种方式只编译 bootstrap_and_overrides.less 并查看哪里出了问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T01:16:45.477

它似乎已在最新版本 (2.1.6) 中修复。把它放在你的 gemfile 中应该可以解决问题。

```
gem 'twitter-bootstrap-rails' , '>= 2.1.6' 
```

# c# - 时间转换为客户端时间c#

> ID：13211091
> 
> 赞同：4
> 
> 时间：2012-11-03T16:28:07.290
> 
> 标签：c#, datetime, timezone

我有一个应用程序需要服务器来处理客户端请求。

在这个应用程序中，时间非常重要。

每当客户请求任何东西时，我都想节省请求的时间。

问题是，我的服务器在美国，客户端在澳大利亚。

如何将服务器时间更改为客户端时间并将其保存在数据库中。

即使在夏令时，这也应该是准确的。

我怎样才能做到这一点

好的，我已将数据库中的时间保存为 UTC。

在客户端我有这个代码，

```
 DateTime dt = booking.CreateDateTime.Value;
 var localTime = TimeZone.CurrentTimeZone.ToLocalTime(dt); 
```

当我打印本地时间时，它比本地时间快 7 小时。

我怎样才能把那个时间改成当地时间？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T16:33:04.423

我知道的指导方针指出，时间应始终保存为数据库中的 UTC，而不是本地时间。这样可以避免许多本地时差陷阱（包括夏令时）。

当您需要本地时间时，从数据库中将其检索为 UTC 并进行转换。您可以使用 DateTime 结构来帮助您解决这个问题：

```
var utcNow = DateTime.UtcNow;
SaveToDB(utcNow);
var utcFromDb = RetrieveTimeFromDb();
var localTime = DateTime.ToLocalTime(utcFromDb); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T16:33:24.670

通常最好的做法是在 UTC 中存储日期，然后在必要时转换为区域设置。

```
var date = DateTime.UtcNow();
var tzi = TimeZoneInfo.FindSystemTimeZoneById("US Eastern Standard Time");
var offset = tzi.GetUtcOffset(date); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T16:33:37.743

也许看看[`TimeZoneInfo`类](http://msdn.microsoft.com/en-us/library/System.TimeZoneInfo.aspx)？

如果这不能满足您的需求，那就是[Noda Time](http://noda-time.blogspot.dk/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T17:07:40.947

同意时间应以 UTC 格式存储。转换为客户端的本地时间（而不是服务器的）时会出现问题。要转换为客户端的本地时间，您需要知道客户端的时区信息并将其与 UTC 时间一起存储在数据库中。

然后使用这两条信息，您应该能够使用上述方法转换为客户端的本地时间。

# php - 将数组数据准备到另一个结构以使用一些规则呈现定义的 HTML 输出的算法

> ID：13211101
> 
> 赞同：4
> 
> 时间：2012-11-03T16:29:06.680
> 
> 标签：php, html

拜托，很长一段时间我都没有成功找到这个（对我来说非常困难）问题的解决方案，我非常感谢任何帮助：

1）我有这样的简单数组中的数据，没有问题：

```
$data = array(
    array('id => 1', 'name' => 'Some name 1'),
    array('id => 2', 'name' => 'Some name 2'),
    array('id => 3', 'name' => 'Some name 3'),
    ...
); 
```

2）但我必须将上面显示的数据渲染成理论上非常类似于树结构的 HTML 结构，其中每个父节点最多有 4 个叶子，每个节点可以成为接下来 4 个子节点的父节点（对树深度没有任何限制）。

a）因此，如果我只有 4 个数组项，则在网站上呈现以下内容：

```
<div class="group">
    <div class="group"><a href="#">Item 1</a></div>
    <div class="group"><a href="#">Item 2</a></div>
    <div class="group"><a href="#">Item 3</a></div>
    <div class="group"><a href="#">Item 4</a></div>
</div> 
```

b) 如果有 5 个项目，它应该呈现如下：

```
<div class="group">
    <div class="group"><a href="#">Item 1</a></div>
    <div class="group"><a href="#">Item 2</a></div>
    <div class="group"><a href="#">Item 3</a></div>
    <div class="group">
        <div class="group"><a href="#">Item 4</a></div>
        <div class="group"><a href="#">Item 5</a></div>
    </div>
</div> 
```

c) 如果有 6 个项目，它应该呈现如下：

```
<div class="group">
    <div class="group"><a href="#">Item 1</a></div>
    <div class="group"><a href="#">Item 2</a></div>
    <div class="group">
        <div class="group"><a href="#">Item 3</a></div>
        <div class="group"><a href="#">Item 4</a></div>
    </div>
    <div class="group">
        <div class="group"><a href="#">Item 5</a></div>
        <div class="group"><a href="#">Item 6</a></div>
    </div>
</div> 
```

d) 如果是 16 个项目，它应该呈现如下：

```
<div class="group">
    <div class="group">
        <div class="group"><a href="#">Item 1</a></div>
        <div class="group"><a href="#">Item 2</a></div>
        <div class="group"><a href="#">Item 3</a></div>
        <div class="group"><a href="#">Item 4</a></div>
    </div>
    <div class="group">
        <div class="group"><a href="#">Item 5</a></div>
        <div class="group"><a href="#">Item 6</a></div>
        <div class="group"><a href="#">Item 7</a></div>
        <div class="group"><a href="#">Item 8</a></div>
    </div>
    <div class="group">
        <div class="group"><a href="#">Item 9</a></div>
        <div class="group"><a href="#">Item 10</a></div>
        <div class="group"><a href="#">Item 11</a></div>
        <div class="group"><a href="#">Item 12</a></div>
    </div>
    <div class="group">
        <div class="group"><a href="#">Item 13</a></div>
        <div class="group"><a href="#">Item 14</a></div>
        <div class="group"><a href="#">Item 15</a></div>
        <div class="group"><a href="#">Item 16</a></div>
    </div>
</div> 
```

e) 如果是 21 个项目，它应该呈现如下：

```
<div class="group">
    <div class="group">
        <div class="group"><a href="#">Item 1</a></div>
        <div class="group"><a href="#">Item 2</a></div>
        <div class="group"><a href="#">Item 3</a></div>
        <div class="group">
            <div class="group"><a href="#">Item 4</a></div>
            <div class="group"><a href="#">Item 5</a></div>
        </div>
    </div>
    <div class="group">
        <div class="group"><a href="#">Item 6</a></div>
        <div class="group"><a href="#">Item 7</a></div>
        <div class="group"><a href="#">Item 8</a></div>
        <div class="group">
            <div class="group"><a href="#">Item 9</a></div>
            <div class="group"><a href="#">Item 10</a></div>
        </div>
    </div>
    <div class="group">
        <div class="group"><a href="#">Item 11</a></div>
        <div class="group"><a href="#">Item 12</a></div>
        <div class="group"><a href="#">Item 13</a></div>
        <div class="group">
            <div class="group"><a href="#">Item 14</a></div>
            <div class="group"><a href="#">Item 15</a></div>
        </div>
    </div>
    <div class="group">
        <div class="group"><a href="#">Item 16</a></div>
        <div class="group"><a href="#">Item 17</a></div>
        <div class="group"><a href="#">Item 18</a></div>
        <div class="group">
            <div class="group"><a href="#">Item 19</a></div>
            <div class="group"><a href="#">Item 20</a></div>
            <div class="group"><a href="#">Item 21</a></div>
        </div>
    </div>
</div> 
```

上面显示的示例是为全背景屏幕设计的，分为 4 个主要相等的区域，这 4 个区域内部最多也可以包含 4 个区域，每个区域还可以包含接下来的 4 个区域，依此类推。

如果项目的模 4 的总摘要计数为 0，则网站上的宽度和高度区域将相同，但否则有些区域更大，有些区域分成更多的子项，为此目的，上述 HTML 代码可以正常工作（在静态页面上它经过了很好的测试）。

所以我有很大的问题要找到如何将简单的数组数据转换为某种结构，以便任何递归函数或其他东西处理以呈现所需的结果。

但正如我所写的，我没有成功，主要是因为每个新的子容器都应该从结构的最后一个开始创建，并为主要的 4 个象限中的每一个统一创建。

我是来帮助回答你的问题的，如果你愿意帮助我的话：）

我知道把它描述得足够清楚有点复杂......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T18:58:17.240

这比我预期的要复杂一些，因为您想要分发物品的方式。但这应该可以解决问题。

该函数`arrangeGroups()`将像您描述的那样创建一个嵌套数组。创建一个将此数据呈现为嵌套 div 的函数应该没有问题。

我添加了一些设置代码来动态生成任意数量的数组条目。使测试更容易。

```
define('GROUP_SIZE', 4);

$things = array();

for($idx=1; $idx<=21; $idx++)
    $things[] = array( 'id'=>$idx, 'name'=>"Some name $idx" );

$groups = arrangeGroups($things);
print_r($groups);

function arrangeGroups($items) {
    $tempGroups = array();
    $itemCount = count($items); // we use this a lot.

    // The hardest part here is figuring out how many items go into each group.
    // Build an array of how big each subgroup should be.
    // Put all the remainder items at the end of the array.
    // Six items divided into four groups will yield the array
    // (1, 1, 2, 2)
    $groupings = array_fill(0, GROUP_SIZE, intval($itemCount/GROUP_SIZE));
    $remainder = $itemCount % GROUP_SIZE ;
    for ($idx=$remainder; $idx>0; $idx--)
        $groupings[GROUP_SIZE-$idx]++;

    // now we just create slices of the array we were given, using $groupings as our guide
    $offset = $idx = 0;
    do {
        $sliceSize = $groupings[$idx];

        if ( $sliceSize == 1 )
            $tempGroups[] = $items[$offset];
        else if ( $sliceSize > 1 )
            $tempGroups[] = arrangeGroups( array_slice($items, $offset, $sliceSize) );

        $offset += $sliceSize;
        $idx++;
    } while ($idx < GROUP_SIZE);

    return $tempGroups;
} 
```

# javascript - 通过点击将 Google Maps API v3 的纬度/经度返回到原始页面

> ID：13211106
> 
> 赞同：1
> 
> 时间：2012-11-03T16:29:38.070
> 
> 标签：javascript, google-maps, latitude-longitude

我正在从事的这个项目有一个纬度和经度字段。我正在尝试整合对外部信息源的需求，并尝试将 Google Maps API 合并到这个项目中。我对 JavaScript 和 Google Maps API 非常熟悉。我的目标是让您单击一个链接，该链接会打开一个新窗口并显示谷歌地图。然后，您可以滚动、缩放等以找到您想要的内容，然后单击，窗口关闭，纬度/经度神奇地填充在原始页面上。我还想让地图显示已从数据库中单击的现有标记。我一直在关注这个[https://developers.google.com/maps/articles/phpsqlajax_v3](https://developers.google.com/maps/articles/phpsqlajax_v3)，现在在底部添加了 Lat/Long 字段。建议我使用

```
google.maps.event.addListener(marker, 'click', function (event) {
document.getElementById("latbox").value = this.getPosition().lat();
document.getElementById("lngbox").value = this.getPosition().lng();
}); 
```

但是，因为我是 n00b，所以我不知道在教程中的代码块中将该代码放在哪里工作：

```
function load() {
      var map = new google.maps.Map(document.getElementById("map"), {
        center: new google.maps.LatLng(47.6145, -122.3418),
        zoom: 13,
        mapTypeId: 'roadmap'
      });

      var infoWindow = new google.maps.InfoWindow;

      // Change this depending on the name of your PHP file
      downloadUrl("getdata.php", function(data) {
        var xml = data.responseXML;
        var markers = xml.documentElement.getElementsByTagName("marker");
        for (var i = 0; i < markers.length; i++) {
          var name = markers[i].getAttribute("name");
          var address = markers[i].getAttribute("address");
          var type = markers[i].getAttribute("type");
          var point = new google.maps.LatLng(
              parseFloat(markers[i].getAttribute("lat")),
              parseFloat(markers[i].getAttribute("lng")));
          var html = "<b>" + name + "</b> <br/>" + address;
          var icon = customIcons[type] || {};
          var marker = new google.maps.Marker({
            map: map,
            position: point,
            icon: icon.icon,
            shadow: icon.shadow
          });
          bindInfoWindow(marker, map, infoWindow, html);
        }
      });
    }

    google.maps.event.addListener(marker, 'click', function (event) {
        document.getElementById("latbox").value = this.getPosition().lat();
        document.getElementById("lngbox").value = this.getPosition().lng();
    });

    function bindInfoWindow(marker, map, infoWindow, html) {
      google.maps.event.addListener(marker, 'click', function() {
        infoWindow.setContent(html);
        infoWindow.open(map, marker);
      });
    }

    function downloadUrl(url, callback) {
      var request = window.ActiveXObject ?
          new ActiveXObject('Microsoft.XMLHTTP') :
          new XMLHttpRequest;

      request.onreadystatechange = function() {
        if (request.readyState == 4) {
          request.onreadystatechange = doNothing;
          callback(request, request.status);
        }
      };

      request.open('GET', url, true);
      request.send(null);
    }
    function doNothing() {}
  </script>
  </head>
  <body onload="load()">
    <div id="map" style="width: 1024px; height: 800px"></div>
    <input type="text" name="latFld" id="latFld" /><br />
    <input type="text" name="lngFld" id="lngFld" /><br />

  </body>
</html> 
```

# tinymce - 防止 mouseover 和 mousout 过滤掉

> ID：13211110
> 
> 赞同：2
> 
> 时间：2012-11-03T16:29:50.697
> 
> 标签：tinymce, plone

如何防止属性（事件处理程序）mouseover 和 mouseout 被 TinyMCE 过滤掉？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T06:12:51.933

您需要将这些属性声明为有效。为此使用[valid_elements](http://www.tinymce.com/wiki.php/Configuration%3avalid_elements)设置。

# javascript - Google Geocoder - 向字段添加坐标

> ID：13211112
> 
> 赞同：0
> 
> 时间：2012-11-03T16:30:10.383
> 
> 标签：javascript, google-maps, google-maps-api-3, geocode

我正在尝试找到一些极简主义的谷歌地理编码脚本。我发现的很大很复杂，但是这个很简单。它唯一没有做的实际上是将坐标放在两个输入框中，就像其他输入框一样。

这是代码工作：http: [//jsfiddle.net/Rr5PL/89/](http://jsfiddle.net/Rr5PL/89/)

如何将坐标放在长/纬度输入字段中？它必须将它们存储起来，因为它使用它们在地图上显示。

```
 var geocoder;
  var map;
  function initialize() {
    geocoder = new google.maps.Geocoder();
    var latlng = new google.maps.LatLng(-34.397, 150.644);
    var mapOptions = {
      zoom: 8,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);
  }

  function codeAddress() {
    var address = document.getElementById('address').value;
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
        });
      } else {
        alert('Geocode was not successful for the following reason: ' + status);
      }
    });
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T16:41:43.497

为了在文本字段中输入纬度和经度，您需要先创建 2 个文本框并输入纬度和经度。

```
var latitude= results[0].geometry.location.lat();
var longitude=results[0].geometry.location.lng(); 
```

这个 jsfiddle 展示了一个例子。 [http://jsfiddle.net/harendra/njDvn/6/](http://jsfiddle.net/harendra/njDvn/6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T16:42:26.163

很简单，试试这个

```
var loc=results[0].geometry.location;
document.getElementById('latLng').value=loc.lat()+', '+loc.lng(); 
```

[**演示**](http://jsfiddle.net/heera/Rr5PL/94/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T16:46:59.787

您可以简单地从 Javascript 变量中获取它们。您不需要输入字段。

```
var lat = results[0].geometry.location.lat();
var lon = results[0].geometry.location.lng();
var url = 'www.url.com/search?lon='+lon+'&lat='+lat; 
```

# android - 如何在不覆盖操作系统方法的情况下通过按下后退按钮获得通知？

> ID：13211115
> 
> 赞同：-1
> 
> 时间：2012-11-03T16:31:12.173
> 
> 标签：android

我在问如何通知我的活动已按下后退按钮。我知道我可以根据[这篇](http://android-developers.blogspot.com/2009/12/back-and-other-hard-keys-three-stories.html)博文覆盖 onBackPressed 或 onKeyEvenet

但我认为这不是优化的方法，因为我必须自己重新启动以前的活动，而操作系统已经为我这样做了。我只需要通知我按下后退按钮来设置一个标志为真，我以后可以使用这个标志来知道硬件后退按钮是否被按下

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T16:34:30.303

> 但我认为这不是优化的方式，因为我必须自己重新启动以前的活动

这是我知道的覆盖后退按钮的最佳方法，但是该博客没有明确说明您可以调用超级方法...您尝试过吗？

```
@Override
public void onBackPressed() {
    // Set your flag here

    super.onBackPressed();
} 
```

# f# - 带有可移植库的 F# 类型提供程序

> ID：13211117
> 
> 赞同：4
> 
> 时间：2012-11-03T16:31:22.743
> 
> 标签：f#, windows-runtime, type-providers

我正在构建一个 Windows 8 应用程序，并且发现自己想要包含一个[ISO-4217](https://en.wikipedia.org/wiki/ISO_4217)代码列表，我在 XML 中拥有最新的形式。

当然，所有国家/地区都有一些这样的代码。我认为 Type Provider 非常适合。但是，由于它们发出代码，我不能将它们与便携式库一起使用。

如何编译类型提供程序以使其不使用发射，以便使用[我拥有的 XML](http://www.currency-iso.org/dl_iso_table_a1.xml)？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T12:59:42.870

我没有创建可从 Portable Libraries 使用的类型提供程序的经验，但您似乎假设类型提供程序*在运行时*发出代码。这实际上不是真的，因此在便携式设置中使用它们可能会更容易。

运行 F# 编译器时会执行类型提供程序。此时，它*可能会*生成一些类型，尽管实际上只有一种类型提供程序会这样做（有两种不同的类型 - 请参阅这个[SO answer](https://stackoverflow.com/questions/12118866/how-do-i-create-an-f-type-provider-that-can-be-used-from-c)）。但是，当您编译使用 F# 类型提供程序的代码时，生成的程序集不会在运行时发出任何代码。

我认为[Freebase 类型提供程序](https://github.com/fsharp/fsharpx/tree/master/src)（在 FSharpX 中可用）是在便携式模式下工作的提供程序的一个示例。我怀疑技巧的一部分是将提供程序拆分为两个程序集——一个包含*运行时需要的*代码，另一个包含*设计时*组件（构建类型信息，尽管它们也不需要发出）。请参阅[FreebaseRuntime.fs](https://github.com/fsharp/fsharpx/blob/master/src/FSharpx.TypeProviders.Freebase/FreebaseRuntime.fs)`TypeProviderAssembly`中的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-13T00:22:25.570

[FSharp.Data 中的 XmlProvider](http://fsharp.github.io/FSharp.Data/library/XmlProvider.html)可与可移植库一起使用

# javascript - 如何跟踪出站链接的点击次数

> ID：13211120
> 
> 赞同：0
> 
> 时间：2012-11-03T16:31:51.130
> 
> 标签：javascript, google-analytics

```
[cross-posted on Google Products Forum http://productforums.google.com/d/topic/analytics/ZrB14a-6gqI/discussion ] 
```

我在[http://www.cs.bris.ac.uk/Research/Algorithms/使用以下代码](http://www.cs.bris.ac.uk/Research/Algorithms/)

```
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-XXXXXXXX-X']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type="text/javascript">
function recordOutboundLink(link, category, action) {
try {
var myTracker=_gat._getTrackerByName();
_gaq.push(['myTracker._trackEvent', category , action ]);
setTimeout('document.location = "' + link.href + '"', 100)
}catch(err){}
}
</script> 
```

[我刚刚从http://support.google.com/analytics/bin/answer.py?hl=en&answer=1136920](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1136920)直接复制。

但是，例如，它实际上似乎并没有报告对我添加的链接的任何点击`onClick="recordOutboundLink(this, 'Outbound Links', 'Postdoc advert');return false;"`。我在网上看到了很多关于此的投诉，但我还没有找到有效的解决方案。

我究竟做错了什么？

PS 最接近的相关在线投诉似乎是[http://productforums.google.com/forum/#!topic/analytics/4oPBJEoZ8s4](http://productforums.google.com/forum/#!topic/analytics/4oPBJEoZ8s4)，它只是声称代码已损坏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T16:37:40.493

这是我正在使用的，它一直在为我工作。我正在使用 jQuery 将 onclick 处理程序添加到具有“引用”类的任何链接中，但我希望将其直接添加到 HTML 中也可以正常工作。

```
 $(function() {
    $('.referral').click(function() {
      _gaq.push(['_trackEvent', 'Referral', 'Click', this.href]);
      setTimeout('document.location = "' + this.href + '"', 100);
      return false;
    });
  }); 
```

* * *

编辑：我相信您按名称调用跟踪器的语法是错误的。由于您在页面加载时设置跟踪时没有使用命名跟踪器，因此以后也不应尝试命名它。请[参阅`_gaq.push`](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApi_gaq#_gaq.push).

更确切地说：

1.  该`var myTracker`声明未使用，因此您可以删除该行。范围内声明的变量`recordOutboundLink`在其他函数（例如`_gaq.push`）运行时不可见，因此它不相关。
2.  您应该简单地使用`'_trackEvent'`而不是`'myTracker._trackEvent'`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T04:02:24.563

你也可以试试这个自动[外部链接脚本](http://www.tatvic.com/blog/outbound-link-tracking-google-analytics/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T16:36:10.700

可能设置更长的超时 2 秒，因为实际推送到服务器需要一定的时间`_gaq.push`，而 100 毫秒不足以发送（一旦 document.location 更改，推送就会被取消）。除非`_gaq.push`使用阻塞调用（在推送完成之前不执行下一行），但我不认为这是我认为大多数使用异步请求的情况。

# ios - 如何在后台注册操作

> ID：13211134
> 
> 赞同：1
> 
> 时间：2012-11-03T16:33:37.637
> 
> 标签：ios, xcode, background, task, facetime

例如，我看到 Garage Band 应用程序和 FaceTime 应用程序正在运行/录制，同时使用其他应用程序（见图）并且想知道如何注册我当前的项目以为状态栏着色（因此在后台运行）

提前致谢！![在此处输入图像描述](../Images/dcecd4ff4104e17ca5d1c5397e1d1898.png)

# java - 返回 void 的方法的 JUnit 测试用例

> ID：13211136
> 
> 赞同：1
> 
> 时间：2012-11-03T16:33:44.980
> 
> 标签：java, junit

我有一个方法，其签名是：

```
void method1(int i,int j); 
```

现在我想为这个方法创建一个 JUnit 测试用例，但我不确定我应该怎么做。我是Java新手，请见谅。

我知道我需要使用`assertEquals()`，但我不确定我应该如何使用它。

有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T16:36:29.547

方法返回 void 的事实通常不是问题。您需要考虑此方法如何更改对象的状态以及如何检索此状态更改。

也许你的班级有一些 getter 方法，你可以在这个方法上调用你的断言。有时它甚至可以是`toString()`你需要断言的类。

如果您发布一些代码，我可以使我的答案更具体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T16:39:51.420

一种方法`void`将指示有关对象状态的某些内容已更改。您可以定制您的单元测试来验证您期望更改的内容。

必要时包含 getter 也是有益的，这样可以更轻松地检索有关对象的状态信息。

# math - 在没有数学日志python的情况下获取对数

> ID：13211137
> 
> 赞同：5
> 
> 时间：2012-11-03T16:33:52.940
> 
> 标签：math

我正在学习 Python，我必须编写一个生成日志结果的脚本。

我知道日志基数 x = 结果

然后我做了我的代码。

```
def log(x, base):
log_b = 2
while x != int(round(base ** log_b)):
    log_b += 0.01
    print log_b
return int(round(log_b)) 
```

但它的工作非常缓慢。我可以使用其他方法吗？谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-03T16:42:38.520

您可能要考虑的另一件事是使用自然对数的*泰勒级数：*

![在此处输入图像描述](../Images/8e63b8f778a6a5e0c970e70c288a2573.png) ![在此处输入图像描述](../Images/1b8500833b35a618947f93e2262801fa.png)

一旦您使用本系列中的一些术语来近似自然对数，就很容易更改基数：

![在此处输入图像描述](../Images/1610de030c6ed0488d54adaa1059273f.png)

* * *

***编辑***：这是另一个有用的身份：

![在此处输入图像描述](../Images/3c755e6ee6cc4c1ac770534acc4b5ed7.png)

使用它，我们可以写一些类似的东西

```
def ln(x):
    n = 1000.0
    return n * ((x ** (1/n)) - 1) 
```

测试一下，我们有：

```
print ln(math.e), math.log(math.e)
print ln(0.5), math.log(0.5)
print ln(100.0), math.log(100.0) 
```

输出：

```
1.00050016671 1.0
-0.692907009547 -0.69314718056
4.6157902784 4.60517018599 
```

这显示了我们的值与`math.log`值（由空格分隔）的比较，并且如您所见，我们非常准确。当你变得非常大时，你可能会开始失去一些准确性（例如`ln(10000)`，会比它应该的更大），但如果你需要，`0.4`你总是可以增加。`n`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-06T07:54:40.210

我使用递归：

```
def myLog(x, b):
    if x < b:
        return 0  
    return 1 + myLog(x/b, b) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-03T16:36:24.117

您可以为此使用二进制搜索。您可以获取有关二分搜索的更多信息[http://en.wikipedia.org/wiki/Binary_search_algorithm](http://en.wikipedia.org/wiki/Binary_search_algorithm)；

基本上你从 0 和 x 开始并应用算法。我会在一分钟内为你写一些代码。

```
def log(x, base, mn, mx):
    if (mn <= mx):
        med = (mn + mx) / 2.0
        if x == int(round(base ** med)):
            return int(round(log_b))
        if x > int(round(base ** med)):
            return log(x, base, med, mx)
        if x < int(round(base ** med)):
            return log(x, base, mn, med)
    return 0 
```

类似的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-04-09T18:59:50.480

```
import math
try :
    number_and_base = input() ##input the values for number and base

    ##assigning those values for the variables
    number = int(number_and_base.split()[0])
    base = int(number_and_base.split()[1])
##exception handling
except ValueError :
    print ("Invalid input...!")

##program

else:
    n1 = 1 ##taking an initial value to iterate
    while(number >= int(round(base**(n1),0))) : ##finding the most similer value to the number given, varying the vlaue of the power
        n1 += 0.000001 ##increasing the initial value bit by bit

    n2 = n1-0.0001
    if abs(number-base**(n2)) < abs(base**(n1)-number) :
        n = n2
    else :
        n = n1

    print(math.floor(n)) ##output value 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-03T16:39:53.587

比较：-

这就是您的日志的工作方式：-

```
def your_log(x, base):
    log_b = 2
    while x != int(round(base ** log_b)):
        log_b += 0.01
        #print log_b
    return int(round(log_b))

print your_log(16, 2)

# %timeit %run your_log.py
# 1000 loops, best of 3: 579 us per loop 
```

这是我提出的改进：-

```
def my_log(x, base):
    count = -1

    while x > 0:
        x /= base
        count += 1
        if x == 0:
            return count

print my_log(16, 2)

# %timeit %run my_log.py
# 1000 loops, best of 3: 321 us per loop 
```

这更快，使用`%timeit`iPython 中的魔术函数来计算执行时间以进行比较。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-02-18T07:07:46.493

这将是一个漫长的过程，因为它会进入一个循环。所以，

```
def log(x,base):
    result = ln(x)/ln(base)
    return result

def ln(x):
    val = x
    return 99999999*(x**(1/99999999)-1)

log(8,3) 
```

值几乎相等但不精确。

# c# - 仅在 HttpPost ActionHandler 之后渲染部分视图

> ID：13211138
> 
> 赞同：0
> 
> 时间：2012-11-03T16:34:06.667
> 
> 标签：c#, asp.net, asp.net-mvc

我正在使用 HttpPost ActionHandler 中的 MyViewRequest 视图字段进行 WCF 服务调用。目标是使用局部视图显示响应，`MyViewResponse`

简而言之，我需要实现这两个项目-

1.  在第一次加载时禁用部分视图的加载。
2.  服务呼叫后显示响应（连同请求）。

**MyViewRequest.cshtml**

```
@using (Html.BeginForm())
{
    @Html.ValidationSummary(false)
    //html code
}
</div>
<div id="dvResponse">
  @Html.Partial("MyViewResponse");
</div> 
```

**部分视图：MyViewResponse.cshtml**

```
@model MvcApplication3.Models.MyModel
@{
    ViewBag.Title = "MyViewResponse";
}

<h2>MyView</h2>

@Html.Label(Model.MyName, "My Name") 
```

这在 Asp.Net 中使用 userControl 非常简单，但是在这里卡住了，我们如何在 MVC3 中实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T16:59:56.767

我认为最好的方法是使用 ViewModels 传输数据。假设您想要一个类似于 stackoverflow 的应用程序，您有一个问题并且用户可以发布一个答案，它将与问题一起显示在帖子之后。

```
public class PostViewModel
{
  public int ID { set;get;}
  public string Text { set;get;}
  public List<PostViewModel> Answers { set;get;}
  public string NewAnswer { set;get;}
} 
```

在你的`GET`行动中，你提出了问题。从 url 获取 id 并从您的服务/存储库获取问题详细信息。

```
public ActionResult Show(int id)
{
  var post=new PostViewModel();
  post=yourService.GetQuestionFromID(id);
  post.Answers=yourService.GetAnswersFromQuestionID(id);
  return View(post);  
} 
```

假设`yourService.GetQuestionFromID`方法返回一个填充了属性值的 PostViewModel 对象。可以从您的数据库或通过 WCF 服务调用获取数据。它是由你决定。该方法还`yourService.GetAnswersFromQuestionID`返回一个 PostViewModel 列表来表示该问题的答案。您可以将这两者放入一个名为`GetQuestionWithAnswers`. 我写了2个方法让它更清楚。

现在在您的显示视图中

```
@model PostViewModel
@Html.LabelFor(x=>x.Text);
@using(Html.Beginform())
{      
  @Html.HiddenFor(x=>x.ID);     
  @Html.TextBoxFor(x=>x.NewAnswer)
  <input type="submit" />
}
<h3>Answers</h3>
@if(Model.Answers!=null)
{
  @Html.Partial("Responses",Model.Answers)
} 
```

并且您的 Partial 视图将被强类型化为一个集合`PostViewModel`

```
@model List<PostViewModel>
@foreach(var item in Model)
{
  <div> @item.Text </div>
} 
```

处理回发很简单（HttpPost）

```
[HttpPost]
public ActionResult Show(PostViewModel model)
{
  if(ModelState.IsValid)
  {
    //get your data from model.NewAnswer property and save to your data base 
    //or call WCF method to save it.
    //After saving, Let's redirect to the GET action (PRG pattern)
    return RedirectToAction("Show",new { @id=model.ID});
  } 
} 
```

# android - 是否可以在原生 TabWidget 上使用 ActionBarSherlock 样式？

> ID：13211139
> 
> 赞同：6
> 
> 时间：2012-11-03T16:34:11.723
> 
> 标签：android, styles, actionbarsherlock, tabwidget

我想知道是否可以在原生 TabWidget 上应用 ActionBarSherlock (v4.2.0) TabWidget 主题？所以它看起来像前 ICS 机器人上的 Holo。如果你知道如何 - 请分享。

我发现的只是：[https](https://gist.github.com/1126843) ://gist.github.com/1126843但它似乎不再起作用了。

标准xml布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TabHost
        android:id="@android:id/tabhost"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:orientation="vertical" >

            <TabWidget
                android:id="@android:id/tabs"
                android:layout_width="match_parent"
                android:layout_height="wrap_content" >
            </TabWidget>

            <FrameLayout
                android:id="@android:id/tabcontent"
                android:layout_width="match_parent"
                android:layout_height="match_parent" >
            </FrameLayout>
        </LinearLayout>
    </TabHost>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T14:31:00.593

我自己找到了一些解决方案。它不是纯粹的 ABS 资源，而是使用最少的额外东西：

与 ABS 选择器几乎相同，除了

```
<item android:state_focused="false" android:state_selected="false" android:state_pressed="false" android:drawable="@drawable/abs__ab_transparent_light_holo" /> 
```

tab_indicator_compat_holo.xml

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<!-- Non focused states -->
<item android:state_focused="false" android:state_selected="false" android:state_pressed="false" android:drawable="@drawable/abs__ab_transparent_light_holo" />
<item android:state_focused="false" android:state_selected="true"  android:state_pressed="false" android:drawable="@drawable/abs__tab_selected_holo" />

<!-- Focused states -->
<item android:state_focused="true" android:state_selected="false" android:state_pressed="false" android:drawable="@drawable/abs__list_focused_holo" />
<item android:state_focused="true" android:state_selected="true"  android:state_pressed="false" android:drawable="@drawable/abs__tab_selected_focused_holo" />

<!-- Pressed -->
<!--    Non focused states -->
<item android:state_focused="false" android:state_selected="false" android:state_pressed="true" android:drawable="@drawable/abs__list_pressed_holo_dark" />
<item android:state_focused="false" android:state_selected="true"  android:state_pressed="true" android:drawable="@drawable/abs__tab_selected_pressed_holo" />

<!--    Focused states -->
<item android:state_focused="true" android:state_selected="false" android:state_pressed="true" android:drawable="@drawable/abs__tab_unselected_pressed_holo" />
<item android:state_focused="true" android:state_selected="true"  android:state_pressed="true" android:drawable="@drawable/abs__tab_selected_pressed_holo" /> 
```

活动

```
private void initTabs(){
    TabHost tabHost = (TabHost)getView().findViewById(android.R.id.tabhost);
    tabHost.setup();

    TabSpec podcasts_all = tabHost.newTabSpec("tab1");
    TabSpec podcasts_downloaded = tabHost.newTabSpec("tab2");
    TabSpec podcasts_favorite = tabHost.newTabSpec("tab3");

    if(Build.VERSION.SDK_INT < Build.VERSION_CODES.HONEYCOMB){
        //set divider drawable

        tabHost.getTabWidget().setDividerDrawable(com.actionbarsherlock.R.drawable.abs__list_divider_holo_light);

        //set tab titles with custom view
        podcasts_all.setIndicator(customTabTextView(getSherlockActivity().getString(R.string.PodcastManager_All_Title)));
        podcasts_downloaded.setIndicator(customTabTextView(getSherlockActivity().getString(
                R.string.PodcastManager_Downloaded_Title)));
        podcasts_favorite.setIndicator(customTabTextView(getSherlockActivity().getString(
                R.string.PodcastManager_Favorite_Title)));
    }else{
        //set tab titles
        podcasts_all.setIndicator(getSherlockActivity().getString(R.string.PodcastManager_All_Title));
        podcasts_downloaded.setIndicator(getSherlockActivity().getString(
                R.string.PodcastManager_Downloaded_Title));
        podcasts_favorite.setIndicator(getSherlockActivity().getString(R.string.PodcastManager_Favorite_Title));
    }

    tabHost.addTab(podcasts_all);
    tabHost.addTab(podcasts_downloaded); 
    tabHost.addTab(podcasts_favorite); 

    //fill background with selector drawable
    if(Build.VERSION.SDK_INT < Build.VERSION_CODES.HONEYCOMB){
        setTabsBackground(tabHost);
    }

}

private View customTabTextView(String text){
    TextView txtTab = new TextView(getActivity());
    txtTab.setText(text.toUpperCase());
    txtTab.setPadding(0, 5, 0, 0);
    txtTab.setTextSize(TypedValue.COMPLEX_UNIT_SP, 12);
    txtTab.setTextColor(Color.DKGRAY);
    txtTab.setGravity(Gravity.CENTER);
    txtTab.setTypeface(Typeface.MONOSPACE, Typeface.BOLD);
    txtTab.setHeight(34);

    return txtTab;
}

private void setTabsBackground(TabHost tabHost) {
    View v;
    int count = tabHost.getTabWidget().getTabCount();
    for (int i = 0; i < count; i++) {
        v = tabHost.getTabWidget().getChildTabViewAt(i);
        v.setBackgroundResource(R.drawable.tab_indicator_compat_holo);

        ViewGroup.MarginLayoutParams params = (ViewGroup.MarginLayoutParams) v.getLayoutParams();
        //Fix margins in 2.x, by default there is -2  
        params.setMargins(0, 0, 0, 0);
    }
} 
```

# java - 如何使用 maven 将 Java 项目的 python 文件包含到 .war 中？

> ID：13211140
> 
> 赞同：4
> 
> 时间：2012-11-03T16:34:28.490
> 
> 标签：java, maven, jython

我有用 maven 制作的 Java 项目。所以我有典型的 Maven 项目布局。我使用 Jython。所以我得到了几个python文件。我通过 Java 类中的 PythonInterpreter 使用它。
我将我的 python 文件放在 src/main/py 文件夹中。我使用这个路径通过解释器导入模块。它在我的笔记本电脑上运行良好。

问题是：
当我做 mvn install 时，这个文件夹不会进入战争。
我阅读了有关 Maven 资源插件的信息，并将此文件夹添加为资源。像这样：

```
<resources>
    <resource>
        <directory>src/main/py</directory>
    </resource>
    <resource>
        <directory>src/main/resources</directory>
    </resource>
</resources> 
```

在这种情况下，它将文件夹内容的所有内容直接添加到 web-inf/，但不在 src/main/py 中。因此该路径对战争档案中的应用无效。

问题是：
我应该如何放置这个 python 资源以及我应该在 pom.xml 中写什么，以便能够在笔记本电脑和服务器上使用相同的路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-15T19:31:57.420

您可以尝试在资源元素中包含 targetPath，如下所示：

```
<resource>
            <targetPath>../</targetPath>
            <directory>src/main/py</directory>
            <includes>
                <include>**/*.py</include>
            </includes>

</resource> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:12:19.490

我建议使用 src/main/scripts 文件夹并检查它们是否打包到了战争中，如果这不起作用检查[maven-war-plugin的文档](http://maven.apache.org/plugins/maven-war-plugin/)[并按照文档中的描述](http://maven.apache.org/plugins/maven-war-plugin/examples/adding-filtering-webresources.html)使用 war 插件定义它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-23T08:19:24.720

```
<resources>
    <resource>
        <directory>src/main/py</directory>
    </resource>
    <resource>
        <directory>src/main/resources</directory>
    </resource>
</resources> 
```

实际上足以包含到 jar/war 文件中。

跑步见

[在 Maven 中编译 Python 源代码](https://stackoverflow.com/questions/52771221/compile-python-sources-in-maven/68495639#68495639)

不建议`src/main/py`在您的 python 脚本中使用，将其`src/main/py`视为 python 的工作/当前文件夹

# c++ - c++时间函数的问题。

> ID：13211147
> 
> 赞同：0
> 
> 时间：2012-11-03T16:35:16.913
> 
> 标签：c++, time, datetime-format

所以我使用函数来获取时间，偏移量为 555550，其值应为 10:19:09。但是当我使用 gmtime 和 asctime 时，我得到的值是 10 秒而不是 9 秒，而且我不明白为什么我会延迟一秒。谁能解释一下？

这是我正在测试的代码：

```
#include <stdio.h>
#include <time.h>

int main (void) 
{
    time_t now = 555550;
    printf ("The time is %s", asctime (localtime (&now)));
    printf ("UTC time is %s", asctime (gmtime (&now)));
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T16:38:40.253

你的计算是错误的：见[http://www.epochconverter.com/](http://www.epochconverter.com/)。10秒是正确的。一个能被 10 整除的数字在被 60 修改后怎么会变成 9？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T16:43:58.740

根据[http://www.epochconverter.com/](http://www.epochconverter.com/) 555550 的值是格林威治标准时间 1970 年 1 月 7 日星期三 10:19:10，因此您关于 555550 为 10:19:09 的假设是错误的。

# javascript - 在 JavaScript 中动态替换函数内容

> ID：13211151
> 
> 赞同：1
> 
> 时间：2012-11-03T16:35:43.063
> 
> 标签：javascript

如何完全替换 JavaScript 中的函数？

我得到了这个代码，但它不起作用。不过，DOM 会更新。那是怎么回事？

```
<html>
<head>
    <script id="myScript" type="text/javascript">
        function someFunction() {
            alert("Same old.");
        }
    </script>
</head>
<body>

<input type="button" onclick="someFunction();" value="A button." />
<script>
    function replace() {
        var oldFunctionString = someFunction.toString();
        var oldContents = oldFunctionString.substring(oldFunctionString.indexOf("{") + 1, oldFunctionString.lastIndexOf("}") );
        var newCode = "alert(New code!);";        
        var newFunctionString = "function someFunction(){"+newCode+"}";
        var scriptTag = document.getElementById('myScript');

        scriptTag.innerHTML = scriptTag.innerHTML.replace(oldFunctionString,newFunctionString);
    }

    replace();
</script>

</body>
</html> 
```

JSfiddle[在这里](http://jsfiddle.net/6yAaw/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T16:38:08.040

设置`.innerHTML`不会重新执行脚本。如果您真的想这样做，您必须创建一个新`script`元素并将其附加到 DOM，然后覆盖之前的脚本所做的（当然，并非在所有情况下都可能）。

如果要替换该功能，只需使用

```
somefunction = function() {
    alert(New code!); // syntax error, btw
}; 
```

当然，要仅替换部分代码（不知道全部），您可以尝试 regex 和 co。仍然只是将新函数重新分配给变量：

```
somefunction = eval("("
  + somefunction.toString().replace(/(alert\().*?(\);)/, "$1New code!$2")
  + ")"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T16:38:12.033

您似乎正在尝试使用字符串，而不是函数本身。只需这样做：

```
someFunction = function () { /* your function code here */ } 
```

# json - 我需要导入一些东西才能在 AS3 中使用 JSON？

> ID：13211155
> 
> 赞同：2
> 
> 时间：2012-11-03T16:36:03.500
> 
> 标签：json, actionscript

使用以下代码行时：

```
var myjson:Object = JSON.parse("path_to_my.json"); 
```

我收到以下错误：

```
1120: Access of undefined property JSON. 
```

我必须导入任何包才能使用 JSON.parse？

谢谢！

[与：Flash CS5 (11.0.0.485)、AS3]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T19:18:29.810

[JSON](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/JSON.html)内置于从 Flash Player 11 开始的 ActionScript 默认包中，其[性能明显高于](https://stackoverflow.com/questions/7816784/load-json-faster-in-flex-4/7817042#7817042)3rd 方序列化程序。

使用 Flash CS5，您需要从发布设置更新目标 Flash Player。默认情况下，它将针对 Flash Player 10.2。

Adobe 有一篇关于[将 Flash Player 11 支持添加到 Flash Pro CS5 和 CS5.5](http://blogs.adobe.com/rgalvan/2011/11/adding-fp11-support-to-flash-pro-cs5-and-cs5-5.html)的博客。

在该页面上，您将找到扩展 (MXP) 安装以及将 Flash Player 更新到 11 的手动说明。

使用 Adob​​e Extension Manager加载[CS5](http://blogs.adobe.com/rgalvan/files/2011/11/FP11Publish_cs5.mxp_.zip)或[CS.5](http://blogs.adobe.com/rgalvan/files/2011/11/FP11Publish_cs55.mxp_.zip) MXP，您将能够从发布设置中定位 Flash Player 11.0：

![发布设置](../Images/2dc76fd5da05e3b91f653e600b7dec4a.png)

请注意，JSON 解析需要一个对象，而不是文件的路径。您的代码应该给出错误 #1132：无效的 JSON 解析输入。

# node.js - 在 nodejs 应用程序中扩展 express app.get 方法

> ID：13211156
> 
> 赞同：6
> 
> 时间：2012-11-03T16:36:07.317
> 
> 标签：node.js, express

我正在尝试扩展**app.get**行为，但似乎在这样做之后，该应用程序丢失了我在扩展它之前所做的一些配置。

在以下代码段中，**/sample**和**/es/sample**输出为**空**，预期输出应为**“value”**

难道我做错了什么？

```
var app = require('express')();

app.set('myprop', 'value');

var _get = app['get'];

app['get'] = function (route, middleware, callback) {
    _get.call(app, route, middleware, callback);

    // For instance: I generate a new route for 'es' language.
    _get.call(app, '/es' + route, middleware, callback);
};

app.get('/sample', function(req, res){
    res.send(app.get('myprop'));
});

app.use(app.router);
app.listen(3000); 
```

**更新**

对不起，我会回答自己...

我错过了扩展方法中的以下第一行:)

```
if (middleware === undefined && callback === undefined) return _get.call(app, route); 
```

现在它就像一个魅力！

```
app['get'] = function (route, middleware, callback) {
    if (middleware === undefined && callback === undefined) return _get.call(app, route);
    _get.call(app, route, middleware, callback);

    // For instance: I generate a new route for 'es' language.
    _get.call(app, '/es' + route, middleware, callback);
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T16:50:52.743

在您的代码中，您`app.get`使用一个参数破坏了行为。试试这个：

```
var app = require('express')();

app.set('myprop', 'value');

var _get = app['get'];

app['get'] = function (route, middleware, callback) {
    if (arguments.length > 1) {
        _get.call(app, route, middleware, callback);

        // For instance: I generate a new route for 'es' language.
        _get.call(app, '/es' + route, middleware, callback);
    } else {
        return _get.apply(app, arguments);
    }
};

app.get('/sample', function(req, res){
    res.send(app.get('myprop'));
});

app.use(app.router);
app.listen(3000); 
```

# css - .css 中的背景延伸

> ID：13211160
> 
> 赞同：3
> 
> 时间：2012-11-03T16:36:22.767
> 
> 标签：css

我的背景图像应该保持在它的固定尺寸中，当我在dreamweaver 中工作或通过各种浏览器（mozilla，即chrome）从我的桌面打开它时，它确实如此。但是一旦上传，背景图像就会伸展。有人知道这个问题的解决方案吗？

[网站](http://www.malamute-dog-supplies.de)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T16:38:28.680

尝试在您的 CSS 中设置它...

```
body {
  background:url(YOUR_IMAGE);
  background-size:80px 60px;
  background-repeat:no-repeat;
} 
```

其中像素大小与原始图像尺寸相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:41:15.913

```
body {
  background:url(YOUR_IMAGE);
  background-repeat:no-repeat;
} 
```

尝试这个

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T16:41:14.723

这可能只是一个缓存问题。如果您已上传所有内容。重新加载页面。当其满载时按 ctrl + r &/或 ctrl + F5。我倾向于交替击打两者。这应该从缓存中清除图像和 css。

如果这不起作用，那么他们会发生一些奇怪的事情。

同样值得注意的是，像 Dreamweaver 这样的东西会像浏览器一样加载内容。因此，某些东西在 Dreamweaver 中看起来很棒，但在浏览器中却没有按预期响应。同样（使用 Visual Studio），您的软件中的东西通常看起来非常糟糕，但在浏览器中却很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T16:44:43.140

您还应该考虑使用 FireFox 进行开发并安装 Firebug 插件。这是一个非常宝贵的工具，可让您即时检查和/或编辑 css 等。

在您的网站上使用它会显示您的背景图像设置为 100% 和 770 像素。这两条规则相互冲突。第一个是说将图像设置为屏幕宽度的 100%，而另一个是说将背景设置为 770 像素。

您需要在这里更好地考虑您的选择。

# mysql - 在 Mac os 上设置 Django 和 Mysql

> ID：13211164
> 
> 赞同：0
> 
> 时间：2012-11-03T16:37:24.217
> 
> 标签：mysql, django, macos

我知道有很多这样的问题，但遗憾的是他们都没有解决我的问题，而且我是 django 的新手，我不知道出了什么问题。所以我成功安装了django和mysql，然后是django-mysql包。当尝试导入`MySQLdb`python（在终端中运行）时，它可以工作。但我的问题是：如何启动mysql并创建数据库？以及如何将其“链接”到 django？我试过跑步`mysql`，但它不起作用。所以我尝试`/usr/local/mysql/bin/mysql`了抛出错误`ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2)`。

我需要做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:37:22.273

检查您的系统偏好 - 底部应该有一个 MySQL 图标。在那里你可以启动它。

![系统偏好](../Images/f7a095b6605019ee4a27eb944e9339c6.png) ![mysql状态](../Images/c16d5a337f31f4a6e1844987151067bb.png)

我还建议安装[MySQLWorkbench](http://dev.mysql.com/downloads/workbench/)来管理您的数据库

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T19:04:51.470

我认为@init3 已经回答了有关如何启动 mysql 的问题。您如何将数据库“链接”到 django 项目？好吧，在您的 settings.py 文件中，您会发现如下内容：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',        # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': 'my_database_name',                      # Or path to database file if using sqlite3.
        'USER': 'my_mysql_user',                      # Not used with sqlite3.
        'PASSWORD': 'my_mysql_password',                  # Not used with sqlite3.
        'HOST': '',                      # Set to empty string for localhost. Not used with sqlite3.
        'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
    }
} 
```

所以 change `NAME`，`USER`因此`PASSWORD`Django 将使用该数据库来创建表和填充字段。

# java - 如何在java中的循环中读取带有空格的字符串？

> ID：13211167
> 
> 赞同：0
> 
> 时间：2012-11-03T16:37:31.187
> 
> 标签：java, string, loops, whitespace

我们都知道在运行程序时使用方法 input.nextLine() 将允许字符串有空格，但是.. 当我在循环中使用此方法时，运行会跳过该语句。谁能解释一下为什么？

我正在尝试使用菜单：

代码：

```
do {
    System.out.print("Enter your choice: ");
    choice = input.nextInt();

    switch (choice) {

    case 4:
        System.out.println("Please give the full information of the project ");
        System.out.print("Project code: "); int code = input.nextInt();
        System.out.print("Project Title: "); String title = input.nextLine();
        System.out.print("Project Bonus in Percent: "); double bip = input.nextDouble();
        Project proj4 = new Project(code4,title4,bip4);
        System.out.print("Employee ID you're adding project to: "); String id4=input.next();
        ers.addProjectToEmployee(id4,proj4);
        break;

    /* more cases  */
    }
} while (choice !=13); 
```

在案例 4 中检查语句 3。

以下是运行程序时发生的情况：

```
Enter your choice: 4
Please give the full information about the project 
Project code: 66677
Project Title: Project Bonus in Percent: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T16:40:45.427

`input.nextInt()`不读取行尾，所以这就是为什么`.nextLine()`要转义的效果，而实际上`.nextLine()`是读取输入流中未读取的行尾`.nextInt()`。你需要一个额外的`.nextLine()`after `.nextInt()`。

* * *

**更新：**

请执行下列操作：

```
System.out.print("Project code: "); int code = input.nextInt();
input.nextLine(); // this is what you need to add
System.out.print("Project Title: "); String title = input.nextLine(); 
```

# github - 是否存在类似 github 工具带的东西？

> ID：13211169
> 
> 赞同：-2
> 
> 时间：2012-11-03T16:37:54.590
> 
> 标签：github

基本上，我想收集一个指向 github repos 的链接列表，并且能够在自述文件中浏览一个列表。有人知道这样做的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:03:37.097

您可以使用[GitHub 的 Web API](http://developer.github.com/)。

我将使用[Spoon-Knife](https://github.com/octocat/Spoon-Knife) repo 进行演示：

首先，您请求获取自述文件（当然，替换`octocat/Spoon-Knife`为您需要的用户名和存储库名称）：

```
$ curl "https://api.github.com/repos/octocat/Spoon-Knife/readme"
{
  "type": "file",
  "html_url": "https://github.com/octocat/Spoon-Knife/blob/master/README",
  "_links": {
    "html": "https://github.com/octocat/Spoon-Knife/blob/master/README",
    "git": "https://api.github.com/repos/octocat/Spoon-Knife/git/blobs/c8f68c2fd5a340b5ec89ada61984254e31c6785d",
    "self": "https://api.github.com/repos/octocat/Spoon-Knife/contents/README"
  },
  "url": "https://api.github.com/repos/octocat/Spoon-Knife/contents/README",
  "path": "README",
  "git_url": "https://api.github.com/repos/octocat/Spoon-Knife/git/blobs/c8f68c2fd5a340b5ec89ada61984254e31c6785d",
  "content": "QWxsIHRoYXQncyBtaXNzaW5nIGlzIHRoZSBmb3JrLiBIZWgu\n",
  "sha": "c8f68c2fd5a340b5ec89ada61984254e31c6785d",
  "encoding": "base64",
  "size": 36,
  "name": "README"
} 
```

请注意该`html_url`字段 - 这是 GitHub Web-GUI 显示中文件的 HTML 链接。但是由于您只想要文件的内容，因此您需要更改`blob`为`raw`：

```
$ curl "https://raw.github.com/octocat/Spoon-Knife/master/README"
All that's missing is the fork. Heh. 
```

当然，您可能希望使用您正在使用的任何编程语言的 HTTP 工具，而不是`curl`查询 GitHub 服务器。

**编辑**

`content`您可以使用 base64 解码器对该字段进行解码，而不是发出额外的 GET 请求：

```
$ echo QWxsIHRoYXQncyBtaXNzaW5nIGlzIHRoZSBmb3JrLiBIZWgu | base64 --decode
All that's missing is the fork. Heh. 
```

# sql-server - MS SQL Server 2012 Standard 的休眠配置

> ID：13211170
> 
> 赞同：2
> 
> 时间：2012-11-03T16:37:56.807
> 
> 标签：sql-server, hibernate, sql-server-2012

我是休眠新手，需要为 MS SQL-server 2012 标准配置它。我发现这篇已弃用的文章[如何为 sql server 配置休眠配置文件，](https://stackoverflow.com/questions/3585544/how-to-configure-hibernate-config-file-for-sql-server)但我需要一个新的。我可以在哪里找到新数据库的驱动程序（如果有的话）！感谢您的回答

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-16T12:40:35.027

我能够让它与 Microsoft JDBC Driver 4.0 for SQL Server 一起使用，如此[处所示](https://stackoverflow.com/questions/26404283/java-hibernate-with-sql-server-2012-not-working)。

尽管 jTDS 以前在 SQL Server 2008 R2 上使用相同的设置，但它不起作用。

MS JDBC 4.0 需要的几个配置行。

```
jdbc.driverClassName=com.microsoft.sqlserver.jdbc.SQLServerDriver
jdbc.url=jdbc:sqlserver://localhost:1433; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-04T08:06:53.990

无需在单独的属性标签中给出用户、密码和数据库名称，您可以将它们全部保存在名为属性标签的 url 中。在 Hibernate 配置文件中，您可以这样编写：-

```
<property name="connection.url">jdbc:sqlserver://myhost;user=user1;password=pass1;database=Student1</property> 
```

其中`user1`、`pass1`和是我的凭据`myhost`，`Student1`您可以用您的凭据替换它们。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-12-18T14:54:52.667

结束这个问题：我现在正在使用 oracle。不是因为 ms 不工作......上面的配置可以工作......

# javascript - 从哪里开始我的 Firefox 书签扩展

> ID：13211171
> 
> 赞同：0
> 
> 时间：2012-11-03T16:37:59.297
> 
> 标签：javascript, firefox, firefox-addon, firefox-addon-sdk

我想为 Firefox 做一个新的扩展，我的想法是使用 JavaScript，我已经为 chrome 做了这个。

我试图谷歌一些关于如何开始我的扩展的教程，但我没有找到任何结构化/可理解的东西。

1.  我需要有关如何构建界面的教程，如果有可能使用 html 和 JavaScript 来完成该任务，就像 Google chrome 一样。

2.  我需要一个教程来解释我如何访问和修改 Firefox 上的书签

基本上，我需要从哪里开始的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T16:47:33.540

这是你要找的东西吗（通过谷歌搜索）

[http://blog.nparashuram.com/2011/10/writing-browser-extensions-comparing.html](http://blog.nparashuram.com/2011/10/writing-browser-extensions-comparing.html)

[http://dalelane.co.uk/blog/?p=511](http://dalelane.co.uk/blog/?p=511)

# php - 用于 Javascript 的 Magento 自定义块

> ID：13211183
> 
> 赞同：0
> 
> 时间：2012-11-03T16:39:21.887
> 
> 标签：php, javascript, mysql, magento

使用 Magento，我需要在自定义模块中将值从数据库传递到 json 中的 javascript。由于 CSP，我正在避免使用内联 javascript。我关注[了 http://www.pierrefay.com/magento-create-block-44](http://www.pierrefay.com/magento-create-block-44)

我在布局文件中的块的类型属性方面遇到问题。当我使用 page/html 时，我的 javascript 模板文件会显示，但会发送一个 text/html 标头而不是我认为存在 xss 风险的 text/javascript。

当我尝试自定义类型（如拍卖/历史）时，javascript 布局不会加载。相反，它显示一个带有标准商店设计的空白页面。以下是我的文件

app/code/local/Mymodule/Auction/etc/config.xml

在这里，除了我尝试用于 javascript 的新块之外，我在块中还有一个自定义产品视图页面。

```
<config>
...
  <frontend>
     <routers>
        <routeurfrontend>
            <use>standard</use>
            <args>
                <module>Mymodule_Auction</module>
                <frontName>auction</frontName>
            </args>
        </routeurfrontend>
     </routers>
     <layout>
       <updates>
            <auction>
                 <file>history.xml</file>
             </auction>
        </updates>
     </layout>
  </frontend> 

  <global>
    <blocks>
        <Mymodule_Auction>
            <class>Mymodule_Auction_Block_Catalog_Product_View</class>
        </Mymodule_Auction>
        <catalog>
            <rewrite>
                <product_view>Mymodule_Auction_Block_Catalog_Product_View</product_view>
            </rewrite>
        </catalog>
        <auction>
                <class>Mymodule_Auction_Block</class>
        </auction>
    </blocks>

     ... (code for models and helpers) ...

  </global>
</config> 
```

app/design/frontend/Mymodule/default/layout/history.xml 如果我将 type="auction/history" 更改为 "page/html" 它会显示但带有 text/html 标题而不是 text/javascript

```
<layout version="0.1.0">
     <default>
          <reference name="content"></reference>
      </default>
    <auction_index_history>  
        <reference name="content">
            <block type="auction/history" template="auction/history.phtml" />
        </reference>
    </auction_index_history>  
</layout> 
```

app/code/local/Mymodule/Auction/Block/History.php

```
<?php
class Mymodule_Auction_Block_History extends Mage_Core_Block_Template
{
     public function methodblock()
     {
         return ‘informations about my block !!’ ;
     }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:40:26.487

我认为您误解了 Block 和控制器。

块只是您页面的一部分。控制器告诉您的页面应如何在浏览器中呈现。

关于您对 Block 的问题：当您需要创建一个没有任何相关 Block 方法的新模板时，您应该使用`core/template`. 此块是最上面的块（`html/page`继承核心/模板，但添加了您可能不想要的逻辑）

如果您需要一些自定义逻辑（Block 方法），请创建一个继承的 php Block 类`Mage_Core_Block_Template`

关于你的标题问题：如果你只输出 JSON，你应该使用控制器和方法强制输出 JSON：

```
$this->getResponse()->setHeader('Content-type', 'application/x-json'); 
```

# iphone - UITableView 动画在部分之间滚动，同时临时删除过多的单元格以简化动画

> ID：13211186
> 
> 赞同：1
> 
> 时间：2012-11-03T16:39:33.547
> 
> 标签：iphone, ios, uitableview, uiscrollview

在我们的应用程序中，用户可以使用表格视图之外的一些控件以直观的方式滚动到表格视图中的下一部分。某些部分包含许多单元格，并且滚动动画看起来不流畅，因为要滚动的单元格太多。为了一个简单易懂的动画，我们想暂时删除动画过多的单元格。

假设用户开启

```
section.0 row.5 out of 100 rows 
```

他想滚动到

```
section.1 row.0 out of 100 rows 
```

然后我们想在滚动动画时跳过所有多余的单元格。所以我们暂时要删除之间的所有单元格

```
e.g. section.0 row.10 untill section.0 row.98 
```

任何想法我怎么能得到这个？我相信这对其他人也可能有用。我想尽可能干净地做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:19:08.363

This is an early attempt. I feel this is a bit messy..

Self is subclass of UITableView

```
- (void)scrollAndSkipCellsAnimatedToTopOfSection:(NSUInteger)section
{
    CGRect sectionRect = [self rectForHeaderInSection:section];
    CGPoint targetPoint = sectionRect.origin;
    CGFloat yOffsetDiff = targetPoint.y - self.contentOffset.y;
    BOOL willScrollUpwards = yOffsetDiff > 0;

    if(willScrollUpwards)
    {
        [self scrollAndSkipCellsAnimatedUpwardsWithDistance:fabs(yOffsetDiff)];
    }
    else
    {
        [self scrollAndSkipCellsAnimatedDownwardsWithDistance:fabs(yOffsetDiff)];
    }
}

- (void)scrollAndSkipCellsAnimatedUpwardsWithDistance:(CGFloat)distance
{
    // when going upwards contentOffset should decrease

    CGRect rectToRemove = CGRectMake(0,
                             self.contentOffset.y + (self.bounds.size.height * 1.5) - distance,
                             self.bounds.size.width,
                             distance - (self.bounds.size.height * 2.5));

    BOOL shouldRemoveAnyCells = rectToRemove.size.height > 0;

    if(shouldRemoveAnyCells)
    {
        // property on my subclass of uitableview
        // these indexes may span over several sections
        self.tempRemoveIndexPaths = [self indexPathsForRowsInRect:rectToRemove];
    }

    [UIView setAnimationsEnabled:NO];
    [self beginUpdates];
    [self deleteRowsAtIndexPaths:self.tempRemoveIndexPaths withRowAnimation:UITableViewRowAnimationNone];
    [self endUpdates];
    [UIView setAnimationsEnabled:YES];

    [self setContentOffset:CGPointMake(0, self.contentOffset.y - distance) animated:YES];
}

// And then I would probably have to put some logic into
// - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section;

- (void)scrollAndSkipCellsAnimatedDownwardsWithDistance:(CGFloat)distance
{

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:01:23.200

我有一些关于如何处理这个问题的想法。首先是重新加载感兴趣的单元格，并返回一个轻量级单元格。您可以使用`CGBitmapContext`将图像数据复制到“外观”单元而不是真实单元中。其次是重新加载数据，`UITableView`然后不返回感兴趣行的数据。第三是实际删除行。另一个想法可能是在制作动画时禁用交互。

**重新加载行：**

```
[self.tableView beginUpdates];
[self.tableView reloadRowsAtIndexPaths:[NSArray arrayWithObjects:indexPathOfYourCell, nil] withRowAnimation:UITableViewRowAnimationNone];
[self.tableView endUpdates]; 
```

**插入/删除行：**

```
[tableView beginUpdate];
[tableView insertRowsAtIndexPaths:*arrayOfIndexPaths* withRowAnimation:*rowAnimation*];
[tableView endUpdate];

[tableView beginUpdate];
[tableView deleteRowsAtIndexPaths:*arrayOfIndexPaths* withRowAnimation:*rowAnimation*];
[tableView endUpdate]; 
```

**禁用交互：**

```
[UIApplication sharedApplication] beginIgnoringInteractionEvents]; 
```

# php - 计算哪些产品一起提供所需的功率

> ID：13211189
> 
> 赞同：15
> 
> 时间：2012-11-03T16:39:47.353
> 
> 标签：php, algorithm, optimization

假设我有三种产品：

**产品 A** 将提供 5 个功率。费用 50。

**产品 B**将提供 9 个功率。费用80。

**产品 C**将提供 15 个功率。费用 140。

我想知道当我需要 7 电源时我可以购买哪些产品组合。我可以买两个**A**但一个**B**更便宜。

当我需要 65 电源时。我需要 4 次**C**和 1 次**A**（成本 680）。但我也可以购买七种**B**产品和一种**A**（成本 610）。

我正在寻找一种方法来计算我需要的给定功率的产品可能组合。

我尝试这样做的方式并没有给我想要的东西：

```
// $products are sorted DESC on their $power
$power = 65
 while( $power > 0 ) {
    foreach( $products as $productPower ) {
        if( ( $productPower > $power && $power - $productPower > 0 ) || $productPower == end( $products ) ) {
            // Add product to list
            $power -= $productPower;
            break;
        }
    }
 } 
```

此示例代码只会给我 4 次**C**和 1 次**A**。我应该怎么做？

**编辑**产品的数量是可变的。此外，具体成本和功率是可变的。因此，可能有 10 种产品的价格标签更便宜、更昂贵。

**编辑 2**正如我上面所说，我想计算可能的**组合**（复数）。有些人似乎在我的描述中忽略了这一点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-10T01:50:21.510

## 介绍

这本来是一个[背包问题](http://en.wikipedia.org/wiki/Knapsack_problem)，但是因为您不仅要寻找最佳解决方案，还希望找到所有可能的组合

然后你可以解决这个[子集和问题](http://en.wikipedia.org/wiki/Subset_sum_problem)+[硬币变化](http://www.algorithmist.com/index.php/Coin_Change)得到：

*   列出所有可能的组合，而不仅仅是总组合
*   获得最佳组合

    **例如**，对于 N = 4,S = {1,2,3}，有四种解：{1,1,1,1},{1,1,2},{2,2},{1, 3}。

## 示例 1

```
echo "<pre>";
$start = microtime(true);

// Start Finder
$finder = new CombinationFinder(65);

// Add Produts
$finder->addProduct(new Product("A", 5, 50));
$finder->addProduct(new Product("B", 9, 80));
$finder->addProduct(new Product("C", 15, 140));

// Output All Found Combinations
foreach ( $finder as $key => $sales ) {
    echo $sales->getName(), "\t\t\t", $sales->getCombinationCost(), PHP_EOL;
}

// Get Best Combination
echo "Combination: ", $finder->getBestCombination()->getName(), PHP_EOL;
echo "Cost: ", number_format($finder->getBestCombination()->getCombinationCost(), 2), PHP_EOL;

// Total Time
echo PHP_EOL, microtime(true) - $start; 
```

## 输出

**顶级组合**

```
["A",1],["C",4]                 610
["A",1],["B",5],["C",1]         590
["A",4],["C",3]                 620
["A",4],["B",5]                 600
["A",7],["C",2]                 630
["A",10],["C",1]                640
["A",13]                        650 
```

**最佳组合**

```
Combination: ["A",1],["B",5],["C",1]
Cost: 590.00 
```

**总时间**

```
0.2533269405365 
```

## 最佳组合

你可以看到最好的组合是 `A*1 ,B*5 ,C*1`..分解

```
 A          B           C
Power : 5   *  1 +  9  *  5 +  15  *  1    =   65
Cost  : 50  *  1 +  80 *  5 +  140 *  1    =   590   <---- Better than 610.00 
```

## 示例 2

该类可用于 2、3、4 或更多产品组合，但速度非常快

```
echo "<pre>";
$start = microtime(true);

// Start Finder
$finder = new CombinationFinder(65);

// Add Produts
$finder->addProduct(new Product("A", 5, 50));
$finder->addProduct(new Product("B", 9, 80));
$finder->addProduct(new Product("C", 15, 140));
$finder->addProduct(new Product("D", 20, 120)); // more product class

$finder->run(); // just run

// Get Best Combination
echo "Combination: ", $finder->getBestCombination()->getName(), PHP_EOL;
echo "Cost: ", number_format($finder->getBestCombination()->getCombinationCost(), 2), PHP_EOL;

// Total Time
echo PHP_EOL, microtime(true) - $start; 
```

**输出**

```
Combination: ["A",1],["D",3]    //<---------------------- Best Combination
Cost: 410.00 
```

**花的时间**

```
1.1627659797668  // less than 2 sec 
```

## 使用的类

```
class Product {
    public $name;
    public $power;
    public $cost;
    public $unit;

    function __construct($name, $power, $cost) {
        $this->name = $name;
        $this->power = $power;
        $this->cost = $cost;
        $this->unit = floor($cost / $power);
    }
}

class Sales {
    /**
     *
     * @var Product
     */
    public $product;
    public $count;
    public $salePower;
    public $saleCost;

    function __construct(Product $product, $count) {
        $this->product = $product;
        $this->count = $count;
        $this->salePower = $product->power * $count;
        $this->saleCost = $product->cost * $count;
    }
}

class SalesCombination {
    private $combinationPower;
    private $combinationCost;
    private $combinationName;
    private $combinationItems;
    private $args;

    function __construct(array $args) {
        list($this->combinationPower, $this->combinationCost, $this->combinationItems) = array_reduce($args, function ($a, $b) {
            $a[0] += $b->salePower;
            $a[1] += $b->saleCost;
            $a[2] = array_merge($a[2], array_fill(0, $b->count, $b->product->name));
            return $a;
        }, array(0,0,array()));
        $this->args = $args;
    }

    function getName() {
        $values = array_count_values($this->combinationItems);
        $final = array();
        foreach ( $values as $name => $amount ) {
            $final[] = array($name,$amount);
        }
        return substr(json_encode($final), 1, -1);
    }

    function getCombinationPower() {
        return $this->combinationPower;
    }

    function getCombinationCost() {
        return $this->combinationCost;
    }
}

class CombinationFinder implements IteratorAggregate, Countable {
    private $sales;
    private $products = array();
    private $power;
    private $found = array();
    private $bestCombination = null;
    private $run = false;

    function __construct($power) {
        $this->power = $power;
    }

    function addProduct(Product $product) {
        $this->products[] = $product;
    }

    function getBestCombination() {
        return $this->bestCombination;
    }

    function getFound() {
        return $this->found ?  : array();
    }

    public function getIterator() {
        if ($this->run === false) {
            $this->run();
        }
        return new ArrayIterator($this->found);
    }

    public function count() {
        return count($this->found);
    }

    function run() {
        $this->run = true;
        $this->buildSales();
        $u = new UniqueCombination($this->sales);
        $u->setCallback(array($this,"find"));
        $u->expand();
    }

    function find() {
        $salesCombination = new SalesCombination(func_get_args());
        if ($salesCombination->getCombinationPower() == $this->power) {
            isset($this->bestCombination) or $this->bestCombination = $salesCombination;
            $salesCombination->getCombinationCost() < $this->bestCombination->getCombinationCost() and $this->bestCombination = $salesCombination;
            $this->found[sha1($salesCombination->getName())] = $salesCombination;
        }
    }

    function buildSales() {
        $total = count($this->products);
        foreach ( $this->products as $product ) {
            $max = floor($this->power / $product->power);
            for($i = 1; $i <= $max; $i ++) {
                $this->sales[$product->name][] = new Sales($product, $i);
            }
        }
    }
}

class UniqueCombination {
    private $items;
    private $result = array();
    private $callback = null;

    function __construct($items) {
        $this->items = array_values($items);
    }

    function getResult() {
        return $this->result;
    }

    function setCallback($callback) {
        $this->callback = $callback;
    }

    function expand($set = array(), $index = 0) {
        if ($index == count($this->items)) {
            if (! empty($set)) {
                $this->result[] = $set;
                if (is_callable($this->callback)) {
                    call_user_func_array($this->callback, $set);
                }
            }
            return;
        }
        $this->expand($set, $index + 1);
        foreach ( $this->items[$index] as $item ) {
            $this->expand(array_merge($set, array($item)), $index + 1);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-03T19:34:55.230

**更新的答案**

我支持我最初的答案，但后来得出了一个明确的解决方案。不幸的是，我不精通 PHP，所以我将介绍的实现是在（写得不好）F# 中。

使您的问题变得有趣的一点是，您不是在寻找最佳解决方案，而是在寻找所有可行的解决方案。正如我在原始答案中指出的那样，这很棘手，因为可行解决方案的集合是无限的。举例来说，如果你想生产 65 个单位，你可以使用 13xA，它产生 5x13 = 65 的幂。但是，显然，任何包含超过 13 个单位的 A 的解决方案也是一个解决方案。

您不能从函数返回无限集。您在这里需要的是所有“边界”案例的集合：

*   如果一个解决方案包含与所有产品的边界情况一样多的单位，则它是有效的
*   如果可以从边界情况中删除一个单元并且它仍然可行，则它不再可行。

例如，解 S = { A = 13; B = 0; C = 0 } 是边界情况。从任何产品中删除一个单元，这是不可行的 - 如果组合是这样的，对于每个产品，它包含比 S 更多的单元，它是一个有效的解决方案，但由 S“支配”。

换句话说，我们不能返回所有可能的解决方案，但我们可以返回区分可行和不可行解决方案的“极限”。

另请注意，产品的成本在这里是无关紧要的——一旦你有了一组边界情况，计算解决方案的成本就变得微不足道了。

鉴于您指定产品的数量可以是任意的，这听起来像是一个明确的递归案例。

如果您没有产品，那么解决方案就是空洞的——没有解决方案。如果您有 1 个产品，则解决方案是上限（目标 / product.Power）如果您有 2 个产品，例如 A：5 和 B：2，目标为 10，您可以

*   使用 0 个 A -> 剩余目标为 10，使用 5 个 B（或更多）
*   使用 1 个 A -> 剩余目标是 10 - 5，使用 3 个 B（或更多）
*   使用 2 of A -> 剩余目标是 10 - 10，使用 0 B（或更多）

A被最大化，所以我们完成了。

请注意，我通过降低 Power 对 A 和 B 进行了排序。未排序的列表也可以，但您会产生“无用”的边界点。例如，我们会得到 [1 B; 2A]和[2B；2 A]。

这个想法可以扩展到完全递归，沿着

```
Given a list of Products and a remaining Target power to achieve,
If the Product is the last one in the list, use ceiling of Target/product Power,
Else take every possible combination of the head product from 0 to max, and
Search deeper, decreasing Target Power by the units supplied by the Product selected. 
```

下面是一个简单的 F# 实现，可以很容易地对其进行改进，并有望传达这个想法。units 函数返回具有提供目标 Power 所需的 Power 值的产品的最小单位数，递归函数 solve 将组合构建为解决方案列表、具有产品 ID 的元组和要使用的单位数：

```
type Product = { Id: string; Power: int }
let A = { Id = "A"; Power = 5 }
let B = { Id = "B"; Power = 9 }
let C = { Id = "C"; Power = 15 }

let products = [ A; B; C ] |> List.sortBy(fun e -> - e.Power)

let units (target: int) (value: int) =
    if target < 0
    then 0
    else
        (float)target / (float)value |> ceil |> (int)

let rec solve (products: Product list) 
              (current: (string * int) list) 
              (solutions: (string * int) list list) 
              (target: int) =
    match products with
    | [ ] -> [ ]
    | [ one ] -> ((one.Id, (units target one.Power)) :: current) :: solutions
    | hd :: tl ->
        let max = units target hd.Power
        [ 0 .. max ]
        |> List.fold (fun s u ->
            solve tl ((hd.Id, u) :: current) s (target - u * hd.Power)) solutions 
```

我会这样运行它：

```
> solve [B;A] [] [] 65;;
Real: 00:00:00.001, CPU: 00:00:00.000, GC gen0: 0, gen1: 0, gen2: 0
val it : (string * int) list list =
  [[("A", 0); ("B", 8)]; [("A", 1); ("B", 7)]; [("A", 3); ("B", 6)];
   [("A", 4); ("B", 5)]; [("A", 6); ("B", 4)]; [("A", 8); ("B", 3)];
   [("A", 10); ("B", 2)]; [("A", 12); ("B", 1)]; [("A", 13); ("B", 0)]] 
```

请注意，解决方案的数量会很快增加。我运行了您的示例，它产生了 28 个解决方案。随着产品数量和目标功率的增加，边界解决方案的数量将扩大很多。

我根本无法用 PHP 编码，但我认为它支持递归 - 也许有人会在 PHP 中展示递归解决方案？无论如何，我希望这会有所帮助。

一个有趣的附带问题是，如果可以以非整数数量购买产品，那么问题会有多不同。在那种情况下，边界实际上是一个表面（我相信是一个多面体）；如何充分描述它将是一个有趣的问题！

**原始答案**

除非我误解了您的问题，否则您所描述的是优化中称为[整数线性规划](http://en.wikipedia.org/wiki/Linear_programming#Integer_unknowns)问题的问题，并使用完善的算法来解决这些问题。您的问题听起来像是饮食问题的变体（给定成分，找到最便宜的方法来获得足够的卡路里来生存），这是线性规划的原型之一，具有整数变量约束。

首先，您的问题的解决方案有无数种解决方案；假设 5 x A 是您的问题的解决方案，那么任何超过 5 个单位的 A 组合也将满足您的要求。

编辑：我意识到我可能误解了您的问题 - 我假设您可以购买任意数量的每种产品。如果每个只能购买 1 件，这是一个更简单的问题：它仍然是一个整数规划问题，但更简单的是背包问题。

另请注意，如果您可以使用非整数数量的产品（对您而言似乎并非如此），那么您的问题将更容易解决。

重述问题的最明显方法，使其成为可以相当容易解决的标准优化问题：

找到具有最小总成本的 n 个产品的组合，受限于提供的总能量高于所需阈值。（我假设总成本和交付的总能量都是购买的 A、B、C 数量的线性函数）。

我认为这实际上是您真正想要的 - 解决您问题的最佳方法。如果您真的对枚举所有解决方案感兴趣，那么一种方法是确定定义可行集的边界（即几何边界，这样如果您站在一边，您就知道这不是解决方案，否则就是）。如果您使用的数字不必是整数，这会容易得多。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-03T16:57:46.330

对这个特定问题的简单观察可能会帮助人们解决这个问题。此处分配功率和成本的方式。使用产品 B，您可以获得最大的性价比。事实上，您唯一会使用产品 C 的时间是您需要 15 倍或 28-30 倍的功率。

因此，对于 30 以上所需的任何功率，只需使用整数除法即可通过以下方式获得所需的产品 B 的数量：

```
int num_productB = power_needed/9; 
```

然后通过以下方式了解您需要多少电量：

```
int leftover = power_needed % 9; 
```

如果剩余大于 5，就多加 1 个 Product B，否则使用 1 个 Product A：

```
if(leftover > 5)
     num_productB++;
else
     productA = 1; 
```

完整的功能看起来像这样：

```
function computeBestCombination($power_needed){
$power_results = array();
//index 0 = Product A
//index 1 = Product B
//index 2 = Product C
if($power_needed == 15){
    $power_results[0] = 0;
    $power_results[1] = 0;
    $power_results[2] = 1;
}
else if($power_needed >= 28 && $power_needed <= 30)
    $power_results[0] = 0;
    $power_results[1] = 0;
    $power_results[2] = 2;
else{
    $power_results[1] = $power_needed / 9;
    $left_over = $power_needed % 9;
    if($left_over > 5){
        $power_results[1]++;
    }
    else{
        $power_results[0] = 1;
    }
    $power_results[2] = 0;
}
return $power_results;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-03T17:33:08.597

检查此代码：

```
<?php
$products = array(5 => 50, 9 => 80, 15 => 140);

$power = 65;
$output = array();

function calculate_best_relation($products, $power, &$output) {
  $aux = array_keys($products);
  sort($aux);

  $min = $aux[0];
  if ($power <= $min) {
    $output[] = $min;
    return $output;
  }
  else {
    //Calculate best relation
    $relations = array();
    foreach ($products as $p => $c) {
      $relations[$p] = $c / $p;
    }
    asort($relations);

    foreach($relations as $p => $c) {
      if ($power > $c) {
        $output[] = $p;
        $power -= $c;
        calculate_best_relation($products, $power, $output);
        break;
      }
    }
  }
}

calculate_best_relation($products, $power, $output);

print_r($output);
?> 
```

这将打印：

数组 ( [0] => 9 [1] => 9 [2] => 9 [3] => 9 [4] => 9 [5] => 9 [6] => 9 [7] => 5 )

这是正确的解决方案。

PD：当然你可以优化这个功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-08T11:01:39.830

像纸浆这样的整数编程包将使这变得容易。

这是一个很好的[例子](http://packages.python.org/PuLP/CaseStudies/a_blending_problem.html)，它将指导您完成整个过程。

安装 python 然后easy_install 纸浆，这将工作。

代码也应该易于阅读和遵循。

```
__author__ = 'Robert'
import pulp

def get_lp_problem(products, required_power):
    prob = pulp.LpProblem("MyProblem", pulp.LpMinimize)
    total_cost = []
    total_power = []
    for product in products:
        var = pulp.LpVariable(product.name,
            lowBound=0,
            upBound=None,
            cat=pulp.LpInteger)
        total_cost.append(var * product.cost)
        total_power.append(var * product.power)

    prob += sum(total_power) >= required_power #ensure we have required power
    prob += sum(total_cost) #minimize total cost!
    return prob

def solve(products, required_power):
    lp_prob = get_lp_problem(products, required_power)
    lp_prob.solve()
    print lp_prob.solutionTime #0.01 seconds
    for var in lp_prob.variables():
        print var.name, var.varValue

from collections import namedtuple
Product = namedtuple("Product", "name, power, cost")
products = [
    Product('A', 5, 50),
    Product('B', 9, 80),
    Product('C', 15, 140)
]
solve(products, 7)
"""
A 0.0
B 1.0
C 0.0

cost = 0*50 + 1*80 + 0*140 = 80
power = 0*5 + 1*9 + 0*15 = 9
"""

solve(products, 65)
"""
A 1.0
B 5.0
C 1.0

cost = 1*50 + 5*80 + 1*140 = 590
power = 1*5 + 5*9 + 1*15 = 65
""" 
```

更多产品：

```
products = [Product(i, i, i-i/100) for i in range(1000)]
solve(products, 12345)
"""
solution time: 0.0922736688601
1 45.0
100 123.0
power = 123*100 + 45*1 =12345  
""" 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-12T01:27:23.180

[使用动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)可以很好地解决这个问题。诀窍在于找到越来越大的值与以前的较小值之间的数学关系。

因此，设`C(p)`为*p*功率的成本。然后我们从您的基本案例中知道以下内容：

> 假设我有三种产品：
> 
> 产品 A 将提供 5 个功率。费用 50。
> 
> 产品 B 将提供 9 个功率。费用80。
> 
> 产品 C 将提供 15 个功率。费用 140。

```
C(5) = 50
C(9) = 80
C(15) = 140 
```

您可以根据需要定义基本情况。大概`C(0) = 0`，但没有给出。

然后诀窍是找到解决这个问题的递归。使用给定的值，我们得到

```
C(p) = Min(C(p-5) + 50, C(p-9) + 80, C(p-15) + 140) 
```

更一般地说，您必须遍历每个基本案例并查看哪种方式更便宜。

所以现在你有两种方法来构建你的解决方案：递归或使用动态编程。考虑到递归函数，前者更容易，但显然效率很低。那么，另一种方法是从底部开始并迭代构建您的解决方案。

假设您想找到 p 功率的成本。然后以下伪代码将起作用：

```
// Create an array big enough to hold elements 0 through p inclusive.
var solution = new Array(p+1);

// Initialize the array with the base cases.
for each base case b:
  solution[power(b)] = cost(b);

// Now we build the array moving forward
for i from 0 to p:
  // Start with a really big number
  solution[i] = +Infinity;

  // Iterate over base case to see what the cheapest way to get i power is.
  for each base case b:
    solution[i] = min(solution[i], solution[i - power(b)] + cost(b);

// The final answer is the last element in the array, but you get everything
// else for free. You can even work backwards and figure out the cheapest
// combination!
return solution[p] 
```

分析留给读者作为练习:-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-03T16:45:55.430

您要优化以下功能

```
$cost = $amountOfProductA * $costOfProductA + $amountOfProductB * $costOfProductB + $amountOfProductC * $costOfProductC 
```

有以下限制

```
$powerDeliveredByA * $amountOfProductA + $powerDeliveredByB * $amountOfProductB + $powerDeliveredByC * $amountOfProductC = 65 
```

因此，这些行找到产生 65（或接近 65，使用您必须设置的可接受阈值）的解决方案，然后按成本对解决方案数组进行排序，并获取解决方案数组的第一个元素：

```
$requiredPower = 65;
$productA = array('amount' => 0, 'cost' => 50, 'powerDelivered' => 5);
$productB = array('amount' => 0, 'cost' => 80, 'powerDelivered' => 9);
$productC = array('amount' => 0, 'cost' => 140, 'powerDelivered' => 15);
$increment = 0.01;
$threshold = 0.01;
$solutions = array();
while($productA['amount'] * $productA['powerDelivered'] < $requiredPower)
{
    $productC['amount'] = 0;
    while($productB['amount'] * $productB['powerDelivered'] < $requiredPower)
    {
        $productC['amount'] = 0;
        while($productC['amount'] * $productC['powerDelivered'] < $requiredPower)
        {
            if($productA['amount'] * $productA['powerDelivered'] + $productB['amount'] * $productB['powerDelivered'] + $productC['amount'] * $productC['powerDelivered'] > $requiredPower + $threshold)
            {
                break;
            }
            if(isWithinThreshold($productA['powerDelivered'] * $productA['amount'] + $productB['powerDelivered'] * $productB['amount'] + $productC['powerDelivered'] * $productC['amount'], $requiredPower, $threshold))
            {
                //var_dump($productA['powerDelivered'] * $productA['amount'] + $productB['powerDelivered'] * $productB['amount'] + $productC['powerDelivered'] * $productC['amount']);
                $cost = $productA['amount'] * $productA['cost'] + $productB['amount'] * $productB['cost'] + $productC['amount'] * $productC['cost'];
                $solutions[number_format($cost,10,'.','')] = array('cost' => $cost, 'qA' => $productA['amount'], 'qB' => $productB['amount'], 'qC' => $productC['amount']);
            }
            $productC['amount'] = $productC['amount'] + $increment;
        }
        $productB['amount'] = $productB['amount'] + $increment;
    }
    $productA['amount'] = $productA['amount'] + $increment;
}
ksort($solutions, SORT_NUMERIC);
$minimumCost = array_shift($solutions);
var_dump($minimumCost);

//checks if $value1 is within $value2 +- $threshold
function isWithinThreshold($value1, $value2, $threshold)
{
    if($value1 >= $value2 - $threshold && $value1 <= $value2 + $threshold)
    {
        return true;
    }
} 
```

这里描述了优化函数的方法：[函数优化](http://en.wikipedia.org/wiki/Knapsack_problem)

# android - 使用图库在特定目录中打开图像不适用于 JB

> ID：13211200
> 
> 赞同：0
> 
> 时间：2012-11-03T16:40:45.130
> 
> 标签：android, image, gallery, directory

我正在尝试使用默认的 Android 图库在特定文件夹中显示图像。我发现只有[一个示例代码可以做到这一点](https://stackoverflow.com/questions/10749351/how-to-open-one-particular-folder-from-gallery-in-android)。我已经简化了该代码，现在很清楚了：

```
public class ScanActivity extends Activity implements MediaScannerConnectionClient {

    private static final String SCAN_DIR = Environment.getExternalStorageDirectory() + File.separator + "MyFolder" + File.separator;
    private static final String FILE_TYPE="image/*";

    private String scanPath;
    private MediaScannerConnection conn;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.main);

        scanPath = SCAN_DIR + new File(SCAN_DIR).list()[0];

        conn = new MediaScannerConnection(getApplicationContext(), this);
        conn.connect();
    }

    @Override
    public void onMediaScannerConnected()
    {
        conn.scanFile(scanPath, FILE_TYPE);
    }

    @Override
    public void onScanCompleted(String path, Uri uri)
    {
        try
        {
            if (uri != null) 
            {
                //uri = content://media/external/images/media/11271
                Intent intent = new Intent(Intent.ACTION_VIEW);
                intent.setDataAndType(uri, FILE_TYPE);
                startActivity(intent);
            }
        }
        finally
        {
            conn.disconnect();
            conn = null;
        }
    }

} 
```

在*Android Froyo (2.2)*上它工作正常 - 画廊打开`MyFolder`目录中的所有图像，但在*Jelly Bean (4.1)*上我只看到黑屏（见下面的屏幕截图）。当然，扫描的文件夹包含两台设备上的照片。

![截图 4.1](../Images/c63eeb20ee5e9a684bbb6d553a252bd1.png)

日志输出：

```
11-03 18:31:31.872: W/DataManager(12540): exception in creating media object: /local/image/item/11271
11-03 18:31:31.872: W/DataManager(12540): java.lang.RuntimeException: cannot find data for: /local/image/item/11271
11-03 18:31:31.872: W/DataManager(12540):   at com.android.gallery3d.data.LocalImage.<init>(LocalImage.java:104)
11-03 18:31:31.872: W/DataManager(12540):   at com.android.gallery3d.data.LocalSource.createMediaObject(LocalSource.java:106)
11-03 18:31:31.872: W/DataManager(12540):   at com.android.gallery3d.data.DataManager.getMediaObject(DataManager.java:165)
11-03 18:31:31.872: W/DataManager(12540):   at com.android.gallery3d.data.LocalSource.getDefaultSetOf(LocalSource.java:183)
11-03 18:31:31.872: W/DataManager(12540):   at com.android.gallery3d.data.DataManager.getDefaultSetOf(DataManager.java:261)
11-03 18:31:31.872: W/DataManager(12540):   at com.android.gallery3d.app.Gallery.startViewAction(Gallery.java:198)
11-03 18:31:31.872: W/DataManager(12540):   at com.android.gallery3d.app.Gallery.initializeByIntent(Gallery.java:91)
11-03 18:31:31.872: W/DataManager(12540):   at com.android.gallery3d.app.Gallery.onCreate(Gallery.java:68)
11-03 18:31:31.872: W/DataManager(12540):   at android.app.Activity.performCreate(Activity.java:5008)
11-03 18:31:31.872: W/DataManager(12540):   at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
11-03 18:31:31.872: W/DataManager(12540):   at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2140)
11-03 18:31:31.872: W/DataManager(12540):   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2211)
11-03 18:31:31.872: W/DataManager(12540):   at android.app.ActivityThread.access$600(ActivityThread.java:143)
11-03 18:31:31.872: W/DataManager(12540):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1209)
11-03 18:31:31.872: W/DataManager(12540):   at android.os.Handler.dispatchMessage(Handler.java:99)
11-03 18:31:31.872: W/DataManager(12540):   at android.os.Looper.loop(Looper.java:137)
11-03 18:31:31.872: W/DataManager(12540):   at android.app.ActivityThread.main(ActivityThread.java:4965)
11-03 18:31:31.872: W/DataManager(12540):   at java.lang.reflect.Method.invokeNative(Native Method)
11-03 18:31:31.872: W/DataManager(12540):   at java.lang.reflect.Method.invoke(Method.java:511)
11-03 18:31:31.872: W/DataManager(12540):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
11-03 18:31:31.872: W/DataManager(12540):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
11-03 18:31:31.872: W/DataManager(12540):   at dalvik.system.NativeStart.main(Native Method)
11-03 18:31:31.872: V/StateManager(12540): startState class com.android.gallery3d.app.PhotoPage
11-03 18:31:31.911: V/NFC(12540): this device does not have NFC support
11-03 18:31:32.044: W/DecodeService(12540): java.lang.NullPointerException
11-03 18:31:32.044: W/DecodeService(12540):     at java.io.File.fixSlashes(File.java:185)
11-03 18:31:32.044: W/DecodeService(12540):     at java.io.File.<init>(File.java:134)
11-03 18:31:32.044: W/DecodeService(12540):     at java.io.FileInputStream.<init>(FileInputStream.java:105)
11-03 18:31:32.044: W/DecodeService(12540):     at com.android.gallery3d.data.DecodeUtils.decodeThumbnail(DecodeUtils.java:92)
11-03 18:31:32.044: W/DecodeService(12540):     at com.android.gallery3d.data.LocalImage$LocalImageRequest.onDecodeOriginal(LocalImage.java:188)
11-03 18:31:32.044: W/DecodeService(12540):     at com.android.gallery3d.data.ImageCacheRequest.run(ImageCacheRequest.java:74)
11-03 18:31:32.044: W/DecodeService(12540):     at com.android.gallery3d.data.LocalImage$LocalImageRequest.run(LocalImage.java:154)
11-03 18:31:32.044: W/DecodeService(12540):     at com.android.gallery3d.data.ImageCacheRequest.run(ImageCacheRequest.java:28)
11-03 18:31:32.044: W/DecodeService(12540):     at com.android.gallery3d.util.ThreadPool$Worker.run(ThreadPool.java:124)
11-03 18:31:32.044: W/DecodeService(12540):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
11-03 18:31:32.044: W/DecodeService(12540):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
11-03 18:31:32.044: W/DecodeService(12540):     at java.lang.Thread.run(Thread.java:856)
11-03 18:31:32.044: W/DecodeService(12540):     at com.android.gallery3d.util.PriorityThreadFactory$1.run(PriorityThreadFactory.java:43)
11-03 18:31:32.044: W/ImageCacheRequest(12540): decode orig failed /local/image/item/11271,THUMB 
```

我用谷歌搜索并没有发现有关此异常的信息。

我真的很困惑这个问题，不知道如何解决它。有谁知道如何解决它？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T20:39:22.733

看来我发现了问题。换线

```
conn.scanFile(scanPath, FILE_TYPE);

//what is ectualy equals to:
//conn.scanFile(scanPath, "image/*"); 
```

到这一行：

```
conn.scanFile(scanPath, null); 
```

修复了一个问题。我不确定，但这似乎是一个 Android 错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T22:26:18.833

我在果冻豆上遇到了同样的问题。FILE_TYPE = "image/jpeg" 为我解决了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-06T02:49:31.510

更改以下代码以扫描此文件夹中的所有文件。它适用于我的 JB。

```
 public void onMediaScannerConnected()
    {
        for(File f : allFiles)
        {
            conn.scanFile(f.getAbsolutePath(), "image/*");
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T16:54:36.393

我遇到了类似的问题，这是我用来修复它的代码：

```
 public class CostumeLog extends Activity{
Integer[] imageIDs = {R.drawable.login_button, R.drawable.logout_button};
File root = new File(Environment.getExternalStorageDirectory().getAbsolutePath() + "/TrickorTreater/Photos");
File[] files;
Bitmap[] bitmapArray;

@Override
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.costume_log_layout);

    root.mkdirs();

    Gallery gallery = (Gallery)findViewById(R.id.gallery1);

    if ((root.isDirectory()) && (root.exists())){
        files = root.listFiles();
        if (!files.equals(null) || !(files.length <= 0)){
            bitmapArray = new Bitmap[(files.length)];
            for (int index = 0; (index <= files.length - 1); index++){
                if (files[index] != null){
                    bitmapArray[index] = decodeSampledBitmapFromFile(files[index].toString(), 300, 240);
                }//third if
            }//for loop

            gallery.setAdapter(new ImageAdapter(this));
            gallery.setOnItemClickListener( new OnItemClickListener() {

                public void onItemClick(AdapterView parent, View v, int position, long id){
                    Intent viewImage = new Intent(CostumeLog.this, ViewLargeImage.class);
                    viewImage.putExtra("INDEX", position);
                    startActivity(viewImage);
                }
            });

        }//second if
    }//first if
}

      public class ImageAdapter extends BaseAdapter{
    Context context;
    int itemBackground;

    public ImageAdapter(Context c){
        context = c;
        TypedArray a = obtainStyledAttributes(R.styleable.Gallery1);
        itemBackground = a.getResourceId(R.styleable.Gallery1_android_galleryItemBackground, 0);
        a.recycle();
    }

    public int getCount() {

        return bitmapArray.length;
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View converView, ViewGroup parent) {
        ImageView imageView;
        if (converView == null) {
            imageView = new ImageView(context);
            imageView.setImageBitmap(bitmapArray[position]);
            //imageView.setImageResource(imageIDs[position]);
            imageView.setScaleType(ImageView.ScaleType.FIT_XY);
            imageView.setLayoutParams(new Gallery.LayoutParams(300, 240));
        } else {
            imageView = (ImageView) converView;
        }
        imageView.setBackgroundResource(itemBackground);
        return imageView;
    }

} 
```

我希望这有帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-04T11:43:21.317

我来这里是为了寻找同样的东西，但现在我最终设计了自己的自定义画廊，也许它可以帮助那里的人：

```
public class ImageViewFlipper extends Activity {

private static final int EXIT = 0;
private static final int SWIPE_MIN_DISTANCE = 120;
private static final int SWIPE_MAX_OFF_PATH = 250;
private static final int SWIPE_THRESHOLD_VELOCITY = 200;
private static final String DIRECTORY = "/sdcard/edu";
private static final String DATA_DIRECTORY = "/sdcard/edu";
private static final String DATA_FILE = "/sdcard/imagelist.dat";
private GestureDetector gestureDetector;
View.OnTouchListener gestureListener;
private Animation slideLeftIn;
private Animation slideLeftOut;
private Animation slideRightIn;
private Animation slideRightOut;
private ViewFlipper viewFlipper;
private int currentView = 0;
List<String> ImageList;
private int currentIndex = 0;
private int maxIndex = 0;

FileOutputStream output = null;
OutputStreamWriter writer = null;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
            WindowManager.LayoutParams.FLAG_FULLSCREEN);

    setContentView(R.layout.main);
    ImageView iv = (ImageView) findViewById(R.id.zero);

    File data_directory = new File(DATA_DIRECTORY);
    if (!data_directory.exists()) {
        if (data_directory.mkdir()) {
            FileUtils savedata = new FileUtils();
            Toast toast = Toast.makeText(ImageViewFlipper.this,
                    "Please wait while we search your SD Card for images...", Toast.LENGTH_SHORT);
            toast.show();
            SystemClock.sleep(100);
            ImageList = FindFiles();
            savedata.saveArray(DATA_FILE, ImageList);

        } else {
            ImageList = FindFiles();
        }

    }
    else {
        File data_file= new File(DATA_FILE);
        if (!data_file.exists()) {
            FileUtils savedata = new FileUtils();

            SystemClock.sleep(100);
            ImageList = FindFiles();
            savedata.saveArray(DATA_FILE, ImageList);
        } else {
            FileUtils readdata = new FileUtils();
            ImageList = readdata.loadArray(DATA_FILE);
        }
    }

    if (ImageList == null) {
        quit();
    }

    SharedPreferences indexPrefs = getSharedPreferences("currentIndex",
            MODE_PRIVATE);
    if (indexPrefs.contains("currentIndex")) {
        currentIndex = indexPrefs.getInt("currentIndex", 0);
    }

    maxIndex = ImageList.size() - 1;

    Log.v("currentIndex", "Index: "+currentIndex);

    viewFlipper = (ViewFlipper) findViewById(R.id.flipper);

    slideLeftIn = AnimationUtils.loadAnimation(this, R.anim.slide_left_in);
    slideLeftOut = AnimationUtils
            .loadAnimation(this, R.anim.slide_left_out);
    slideRightIn = AnimationUtils
            .loadAnimation(this, R.anim.slide_right_in);
    slideRightOut = AnimationUtils.loadAnimation(this,
            R.anim.slide_right_out);

    viewFlipper.setInAnimation(AnimationUtils.loadAnimation(this,
            android.R.anim.fade_in));
    viewFlipper.setOutAnimation(AnimationUtils.loadAnimation(this,
            android.R.anim.fade_out));

    iv.setImageDrawable(Drawable.createFromPath(ImageList
            .get(currentIndex)));
    System.gc();

    gestureDetector = new GestureDetector(new MyGestureDetector());
    gestureListener = new View.OnTouchListener() {
        public boolean onTouch(View v, MotionEvent event) {
            if (gestureDetector.onTouchEvent(event)) {
                return true;
            }
            return false;
        }
    };

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    super.onCreateOptionsMenu(menu);

    int NONE = Menu.NONE;
    menu.add(NONE, EXIT, NONE, "Exit");
    return true;
}

public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case EXIT:
        quit();
        break;
    }

    return super.onOptionsItemSelected(item);
}

protected void onPause() {
    super.onPause();

    SharedPreferences indexPrefs = getSharedPreferences("currentIndex",
            MODE_PRIVATE);

    SharedPreferences.Editor indexEditor = indexPrefs.edit();
    indexEditor.putInt("currentIndex", currentIndex);
    indexEditor.commit();
}

protected void onResume() {
    super.onResume();
    SharedPreferences indexPrefs = getSharedPreferences("currentIndex",
            MODE_PRIVATE);
    if (indexPrefs.contains("currentIndex")) {
        currentIndex = indexPrefs.getInt("currentIndex", 0);
    }   
}

private List<String> FindFiles() {
    final List<String> tFileList = new ArrayList<String>();
    Resources resources = getResources();
    // array of valid image file extensions
    String[] imageTypes = resources.getStringArray(R.array.image);
    FilenameFilter[] filter = new FilenameFilter[imageTypes.length];

    int i = 0;
    for (final String type : imageTypes) {
        filter[i] = new FilenameFilter() {
            public boolean accept(File dir, String name) {
                return name.endsWith("." + type);
            }
        };
        i++;
    }

    FileUtils fileUtils = new FileUtils();
    File[] allMatchingFiles = fileUtils.listFilesAsArray(
            new File(DIRECTORY), filter, -1);
    for (File f : allMatchingFiles) {
        tFileList.add(f.getAbsolutePath());
    }
    return tFileList;
}

public class FileUtils {

    public void saveArray(String filename, List<String> output_field) {
         try {
            FileOutputStream fos = new FileOutputStream(filename);
            GZIPOutputStream gzos = new GZIPOutputStream(fos);
            ObjectOutputStream out = new ObjectOutputStream(gzos);
            out.writeObject(output_field);
            out.flush();
            out.close();
         }
         catch (IOException e) {
             e.getStackTrace(); 
         }
      }

      @SuppressWarnings("unchecked")
    public List<String> loadArray(String filename) {
          try {
            FileInputStream fis = new FileInputStream(filename);
            GZIPInputStream gzis = new GZIPInputStream(fis);
            ObjectInputStream in = new ObjectInputStream(gzis);
            List<String> read_field = (List<String>)in.readObject();
            in.close();
            return read_field;
          }
          catch (Exception e) {
              e.getStackTrace();
          }
          return null;
      }

    public File[] listFilesAsArray(File directory, FilenameFilter[] filter,
            int recurse) {
        Collection<File> files = listFiles(directory, filter, recurse);

        File[] arr = new File[files.size()];
        return files.toArray(arr);
    }

    public Collection<File> listFiles(File directory,
            FilenameFilter[] filter, int recurse) {

        Vector<File> files = new Vector<File>();

        File[] entries = directory.listFiles();

        if (entries != null) {
            for (File entry : entries) {
                for (FilenameFilter filefilter : filter) {
                    if (filter == null
                            || filefilter
                                    .accept(directory, entry.getName())) {
                        files.add(entry);
                        Log.v("ImageViewFlipper", "Added: "
                                + entry.getName());
                    }
                }
                if ((recurse <= -1) || (recurse > 0 && entry.isDirectory())) {
                    recurse--;
                    files.addAll(listFiles(entry, filter, recurse));
                    recurse++;
                }
            }
        }
        return files;
    }
}

class MyGestureDetector extends SimpleOnGestureListener {
    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
            float velocityY) {
        try {
            if (Math.abs(e1.getY() - e2.getY()) > SWIPE_MAX_OFF_PATH)
                return false;
            // right to left swipe
            if (e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE
                    && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                viewFlipper.setInAnimation(slideLeftIn);
                viewFlipper.setOutAnimation(slideLeftOut);

                if (currentIndex == maxIndex) {
                    currentIndex = 0;
                } else {
                    currentIndex = currentIndex + 1;
                }
                if (currentView == 0) {
                    currentView = 1;
                    ImageView iv = (ImageView) findViewById(R.id.one);
                    iv.setImageDrawable(Drawable.createFromPath(ImageList
                            .get(currentIndex)));
                    System.gc();
                } else if (currentView == 1) {
                    currentView = 2;
                    ImageView iv = (ImageView) findViewById(R.id.two);
                    iv.setImageDrawable(Drawable.createFromPath(ImageList
                            .get(currentIndex)));
                    System.gc();
                } else {
                    currentView = 0;
                    ImageView iv = (ImageView) findViewById(R.id.zero);
                    iv.setImageDrawable(Drawable.createFromPath(ImageList
                            .get(currentIndex)));
                    System.gc();
                }
                Log.v("ImageViewFlipper", "Current View: " + currentView);
                viewFlipper.showNext();
            } else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE
                    && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                viewFlipper.setInAnimation(slideRightIn);
                viewFlipper.setOutAnimation(slideRightOut);
                if (currentIndex == 0) {
                    currentIndex = maxIndex;
                } else {
                    currentIndex = currentIndex - 1;
                }
                if (currentView == 0) {
                    currentView = 2;
                    ImageView iv = (ImageView) findViewById(R.id.two);
                    iv.setImageDrawable(Drawable.createFromPath(ImageList
                            .get(currentIndex)));
                } else if (currentView == 2) {
                    currentView = 1;
                    ImageView iv = (ImageView) findViewById(R.id.one);
                    iv.setImageDrawable(Drawable.createFromPath(ImageList
                            .get(currentIndex)));
                } else {
                    currentView = 0;
                    ImageView iv = (ImageView) findViewById(R.id.zero);
                    iv.setImageDrawable(Drawable.createFromPath(ImageList
                            .get(currentIndex)));
                }
                Log.v("ImageViewFlipper", "Current View: " + currentView);
                viewFlipper.showPrevious();
            }
        } catch (Exception e) {
            // nothing
        }
        return false;
    }
}

@Override
public boolean onTouchEvent(MotionEvent event) {
    if (gestureDetector.onTouchEvent(event))
        return true;
    else
        return false;
}

public void quit() {
    SharedPreferences indexPrefs = getSharedPreferences("currentIndex",
            MODE_PRIVATE);

    SharedPreferences.Editor indexEditor = indexPrefs.edit();
    indexEditor.putInt("currentIndex", 0);
    indexEditor.commit(); 
    File settings = new File(DATA_FILE);
    settings.delete();
    finish();
    int pid = android.os.Process.myPid();
    android.os.Process.killProcess(pid);
    System.exit(0);
} 
```

}

```
 Dont forget: (Manifest)  
      android:configChanges="orientation" 
```

# html - HTML5 ` `

> ID：13211206
> 
> 赞同：72
> 
> 时间：2012-11-03T16:41:32.183
> 
> 标签：html, favicon, rel

HTML5的[WHATWG 文档](http://www.whatwg.org/specs/web-apps/current-work/multipage/links.html#attr-hyperlink-rel)说该`rel`属性必须包含以空格分隔的值，然后给出一个允许值的表。

> 该属性的值必须是一组以空格分隔的标记。允许的[关键字及其含义](http://www.whatwg.org/specs/web-apps/current-work/multipage/links.html#linkTypes)...

元素的允许关键字列表`link`不包括`shortcut`，但确实包括`icon`。所以我正在查看众所周知的标签

```
<link rel="shortcut icon" href="/favicon.ico" /> 
```

并想知道它是否符合 HTML5 标准。`shortcut`我应该从整个网站的这个标签中删除关键字吗？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-11-03T17:09:51.347

来自同一个 WHATWG 文档：

> 由于历史原因，图标关键字前面可能有关键字“快捷方式”。如果存在“shortcut”关键字，则它必须紧接在 icon 关键字之前，并且两个关键字必须仅由一个 U+0020 空格字符分隔。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2017-05-23T00:41:31.123

更新：根据此页面[https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types](https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types)

> *快捷*链接类型经常出现在图标之前，但这种链接类型不符合要求，被忽略，网络作者不得再使用它。

此外，我在 W3Schools 文档中没有看到任何*快捷方式*的引用，所以我认为最好将其省略。[https://www.w3schools.com/tags/att_link_rel.asp](https://www.w3schools.com/tags/att_link_rel.asp)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-03T22:02:19.077

虽然它仍处于实验阶段（因为 HTML5 开发正在进行中），但 [w3.org HTML5 Markup Validator](http://validator.w3.org/#validate_by_uri+with_options) 是一个很好的在线工具，您可以查看。大约 6 个月前，我广泛使用了它，它总是返回准确的 HTML5 语法报告。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-09-25T18:23:18.540

我已经在 Google Chrome、Mozilla Firefox、Internet Explorer 和 Microsoft Edge 上测试了这段代码，唯一不工作的浏览器是 Edge。从硬盘前 c:\temp\test.html 上制作的页面添加收藏夹时

```
<html>
<head>
<meta http-equiv="expires" content="0"><!-- Never caches the page -->
<link id="favicon" rel="shortcut icon" href="icon_32.ico">
</head>
<body>
...
</body>
</html> 
```

# java - Google-Eclipse 插件：向项目添加入口点

> ID：13211207
> 
> 赞同：2
> 
> 时间：2012-11-03T16:41:42.650
> 
> 标签：java, eclipse, gwt, web-applications, google-eclipse-plugin

使用 Google-Eclipse 插件，我已经成功地创建、构建和部署（本地）一个非常基本的 GWT Web 应用程序。

问题是：我不是默认设置的项目结构 GWT（或 Google-Eclipse 插件）的忠实粉丝。所以我试图以一种对我来说合乎逻辑的方式进行设置，但仍然能够在`DevMode`本地运行和部署。

所以我创建了第二个项目，但**没有**将其设置为 Web 应用程序；相反，我使用了普通的 Java 应用程序。我创建了我的源目录、我的`EntryPoint`实现 ( `TestModule implements EntryPoint`)、我的`TestModule.gwt.xml`、我的主机页面 HTML 等。我在第一个（成功的）项目中所做的所有工件。

但现在我正在`Run Configurations`尝试手动设置运行配置，类似于 Web 应用程序向导使用我构建的第一个应用程序为我创建的运行配置。

在`Run Configurations >> GWT`选项卡中，它给了我一个窗口，我可以在其中添加*Available Modules*。当我单击“添加”按钮时，无论我输入什么，它都不会为我提供可供选择的选项列表。

所以我退出了`Run Configurations`对话框，假设我需要以不同的方式设置我的项目属性。所以我右键单击我的项目，转到`Properties >> Goodle >> Web Toolkit`，果然，看到一个类似的面板，允许我添加可用模块。我*相信*，如果我正确配置了此部分，那么在对话框中我将可以使用可用模块列表`Run Configurations`，并且我应该能够继续。

这是我所看到的：

![在此处输入图像描述](../Images/11dfc19ead60c2f92b340703c452aa40.png)

关于如何正确配置我的项目以便此`Available Modules`对话框实际为我提供选项的任何想法？提前致谢！

**请注意：**我预计许多答案都类似于“*只需使用 Web 应用程序向导，它就容易多了*”等。我理解这一点，并且我（暂时）接受了尝试配置我自己的 GWT 应用程序的警告，而无需插件的 Web 应用程序向导的帮助。如果我发现在这里“自己动手”真的非常非常困难，那么我会屈服并回到巫师那里。但我想在这样做之前尽力而为！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T19:06:21.243

随意不要使用 Google Plugin for Eclipse（以下简称 GPE）！没有必要——它全部是 Java，或者至少是自包含的，足以像 Eclipse 所说的 Java 一样。如果您不想要向导、JSNI 自动完成、UiBinder 自动完成，您甚至可以不使用插件。

要在开发模式下运行 GWT 项目，您只需要 SDK 的基本移动部分： * `gwt-dev.jar`- 开发模式（代码服务器和简单的 HTTP 服务器）、编译器和各种其他工具 * `gwt-user.jar`- GWT 语言运行时（JavaScriptObject、GWT、等）和标准事件、小部件和其他位 * 可选：`gwt-servlet.jar`- 一些基本 GWT servlet 在 servlet 容器中运行的类 * 可选：`requestfactory-*.jar`- 如果您不使用 RequestFactory，请不要担心

您可能还需要 a`json.jar`和 the`valdation-api.jar`以及它的来源。

这足以让您使用纯 Java 编译任何项目。`gwt-user.jar`and不属于您的`gwt-dev.jar`服务器类路径 - 不要将它们放在`WEB-INF/lib/`目录中，只需将它们放在手边即可将您的代码编译为 JavaScript。

开发模式和编译器本身都只是带有`main`方法的类，因此可以启动标准的 Eclipse 运行/调试配置。每个人都有自己的选择，例如“我在哪里可以找到你的资源”、“你正在启动什么模块”，以及在开发模式的情况下，“`war/`我要服务的目录在哪里”。

## 完全避免 GPE：

### 开发模式：

创建一个新的 Java 运行配置，并验证上述类是否在类路径以及您的源目录中。将主类设置为`com.google.gwt.dev.DevMode`，添加一些参数：

```
-war path/to/war/dir/ my.package.to.ModuleToRun 
```

其他一切都只是改变它的额外标志，并提示从哪里开始。查看[https://developers.google.com/web-toolkit/doc/latest/DevGuideCompilingAndDebugging#What_options_can_be_passed_to_development_mode](https://developers.google.com/web-toolkit/doc/latest/DevGuideCompilingAndDebugging#What_options_can_be_passed_to_development_mode)了解您可以使用的其他选项

要对此进行调试，请将其作为调试配置运行 - Eclipse 会抱怨它无法热交换类，但忽略这些并点击继续。当您在 .java 文件中进行更改时，保存并刷新浏览器 - GWT 的专用开发模式类加载器将获取更改。

### 编译：

如上所述，使用类路径上的重要类和 jar 进行运行配置。这一次，使用`com.google.gwt.dev.Compiler`主类，并在程序参数下指定要构建的模块。同样，您可以使用许多选项来更改它的编译方式以及它提供的附加输出，请参阅[https://developers.google.com/web-toolkit/doc/latest/DevGuideCompilingAndDebugging#DevGuideCompilerOptions](https://developers.google.com/web-toolkit/doc/latest/DevGuideCompilingAndDebugging#DevGuideCompilerOptions)了解更多选项

## 在没有向导的情况下使用 GPE：

这里要记住的重要一点是，GPE 只是掩盖了一些细节——您不需要使用向导，但在某种程度上，它都是向导，直到您只使用原始 Java 工作。类路径、导入等 - 这些都是或多或少适用于 GWT 开发的 Java 概念，尽管它添加了模块来帮助设置延迟绑定规则等。

模块选择对话框不是必需的，尽管另外两个是必需的。首先，正如您所做的那样，在 Google > Web Toolkit 下打开“使用 Google Web Toolkit”，并确保选择了有效的 SDK。这做了两件事——它将必要的 jars 添加到类路径（在“GWT SDK”下），并在整个项目中启用了一些其他选项——JSNI 自动完成、开发模式、各种向导（我们将忽略）。另一个必要的部分是转到 Google > Web 应用程序，指出“此项目有一个 WAR 目录”，并为其提供该目录的路径，以便开发模式知道从哪里启动 Jetty。

完成此操作后，插件应该能够让您从指向具有入口点的模块的 html 文件开始。我将忽略这些细节，因为这是基本的项目设置 - 向导擅长的事情，示例充满，并且您可能已经阅读了这些说明（否则您不会跳过向导......） . 从先前选择的 WAR 文件夹中，选择这样一个 html 文件，右键单击它并选择 Run As... > Web Application。GPE 可能会再次询问 WAR 文件夹 - 帮帮它，然后您就可以上路了。开发模式将向 eclipse 添加一个视图而不是一个独立的窗口，您将能够从那里监视进度。

然后，只需转到工具栏中的 G 图标并选择“GWT Compile Project...”即可进行编译。将出现一个对话框，询问要使用的项目、开始的入口点以及一些其他选项。请注意，如果您编译到 war 文件夹然后启动开发模式，您可能会发现开发模式会覆盖部分编译输出以便于 Java 调试，因此需要额外的编译。

# php - 为什么这个 jQuery 不起作用？

> ID：13211216
> 
> 赞同：0
> 
> 时间：2012-11-03T16:42:39.207
> 
> 标签：php, jquery

我有这个 jQuery 脚本，它在有人投票时添加了一个计时器，他需要等待 3 分钟

脚本一直在工作，直到我用 php 获得剩余时间

```
$(document).ready(function(){
alert("1");
 function Timer(dur, par, can, cnt) {
var parent = $(par),
    canvas = can ? $(can, parent)[0] : $('.timer', parent)[0],
    seconds = cnt ? $(cnt, parent)[0] : $('.counter', parent)[0],
    sec = dur,
    countdown = sec;    

if (!canvas)
    canvas = $("<canvas>").addClass('timer')
        .attr('width', 100).attr('height', 100).appendTo(parent)[0];

if (!seconds)
    seconds = $("<span>").addClass('counter').appendTo(parent)[0];

var ctx = canvas.getContext('2d');
ctx.lineWidth = 8;
ctx.strokeStyle = "#528f20";

var startAngle = 0,
    time = 0,
    intv = setInterval(function() {
        var endAngle = (Math.PI * time * 2 / sec);
        ctx.arc(65, 35, 30, startAngle, endAngle, false);
        ctx.clearRect(0, 0, 200, 200);

        startAngle = endAngle;
        ctx.stroke();

        countdown--;
        if (countdown > 60) {
            seconds.innerHTML = Math.floor(countdown / 60);
            var ss = countdown % 60;
            if (ss < 10) 
                ss = "0" + ss;
            seconds.innerHTML += ":" + ss;
        }
        else {
            seconds.innerHTML = countdown;
        }

        if (++time > sec, countdown == 0) {
            clearInterval(intv);
            $(canvas).remove();
            $(seconds).remove();
            /*$(par).prepend('<img id="theImg" src="http://ivojonkers.com/votify/upvote.png" />');*/
        }
    }, 1000);}

$(".upvote").click(function(){
    alert("2");
    var par = $("<div>").addClass("time").appendTo("#timers");
    Timer(Math.round(180), par);
});
if (<?php echo $wait; ?> > 0) {
var par = $("<div>").addClass("time").appendTo("#timers");
Timer(Math.round(<?php echo $wait; ?>, par); } }); 
```

所以在这一部分中，我有时间等待下一次用 php 投票，这似乎不起作用出了什么问题？

```
if (<?php echo $wait; ?> > 0) {
var par = $("<div>").addClass("time").appendTo("#timers");
Timer(Math.round(<?php echo $wait; ?>, par); } }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T16:49:10.210

您应该只使用 a`setTimeout(function(){},(3 * 60 * 1000))`来阻止投票功能。

```
//Block the vote here
setTimeout(function(){/*unblock here*/},(3 * 60 * 1000)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T16:51:52.910

替换这个：

```
Timer(Math.round(<?php echo $wait; ?>, par); } }); 
```

和：

```
Timer(Math.round(<?php echo $wait; ?>, par)); } }); 
```

;)

# jquery - Jquery Ajax DataType 'html 未定义'

> ID：13211217
> 
> 赞同：0
> 
> 时间：2012-11-03T16:42:49.253
> 
> 标签：jquery, html, ajax, post

我正在尝试让我的 jquery ajax 正常工作，但`ReferenceError`在使用 Firebug 开发时面临：

```
jQuery(document).ready(function() {
    jQuery('.my-div').click(function(e){
    e.preventDefault();
    var href = jQuery(this).attr('href');
    jQuery.ajax({
      type: "POST",
      url:href,
      dataType:html,
      success: function(data, status, xhr){ $('#div_to_load_html').html(data); },
      error: function(){ alert("Error"); },
    });
    });
}) 
```

html:

```
<div class='my-div'><a href='/place/to/go/'>GO!</a></div> 
```

当我单击“my-div”时，Firebug 返回： ReferenceError: html is not defined @ [http://www.mydomain.com/:38](http://www.mydomain.com/:38)，它引用了我的 jquery 中的行`dataType:html`。

谢谢你的想法！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T16:45:01.170

您可以删除选项“ `dataType:html`，”来`$.ajax`推断数据类型。

但是，要回答这个问题，正确的语法 id`dataType:'html'`和引号，因为它不是一个变量

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T16:45:59.677

您需要传递一个字符串：`dataType:'html',`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T16:55:10.960

这

> 数据类型：html，

行应更正为

> 数据类型：'html'，

您必须在某些浏览器（如 Firefox）中使用此行。除非在将结果附加到页面时出现错误。

# cron - Cronjobs 和环境变量

> ID：13211218
> 
> 赞同：1
> 
> 时间：2012-11-03T16:43:07.443
> 
> 标签：cron, crontab

我有一个网站的 2 个版本：生产和开发。文件系统是：

```
/public_html
      production files.php
      more_production_files.php
      /dev
          dev_file.php
          etc... 
```

我正在设置 cron 作业，并且我在 crontab 中有环境变量，以保持某些正在发生的 PHP require() 函数的路径正确。

我的问题是，如果我想在 contab 中设置单独的 Dev 和 Production 变量，我可以这样做吗？：

```
CRONTAB

# Dev Variables
ENVIRONMENT=/dev/
FULL_PATH=/home/username/public_html/dev/

# Dev Cron Jobs
0 0 1 1 1 php /home/username/public_html/dev/cronjob.php
0 0 1 2 2 php /home/username/public_html/dev/cronjob_2.php

# Production Variables
ENVIRONMENT=/
FULL_PATH=/home/username/public_html/

# Production Cron Jobs
0 0 1 1 1 php /home/username/public_html/cronjob.php
0 0 1 2 2 php /home/username/public_html/cronjob_2.php 
```

执行生产 cron 作业时，上面的“生产变量”会替换开发者吗？同样，在执行 Dev cron 作业时，是否会使用“开发变量”而不是生产变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T21:30:44.237

正如您似乎正在运行 Linux，是的，这适用于大多数（至少是最近的）Linux 发行版。例如，来自 Ubuntu crontab(5) 手册；

> crontab 中的活动行将是环境设置或 cron 命令。crontab 文件是从上到下解析的，因此任何环境设置都只会影响文件中它们下面的 cron 命令。

# c# - 使用 C# 中的 spl 字符在 MS Access 中搜索数据

> ID：13211219
> 
> 赞同：1
> 
> 时间：2012-11-03T16:43:07.890
> 
> 标签：c#

我想从具有特殊字符的 ms 访问表中搜索数据（以下是示例）：

CCTM-2PM/PA/14-4-1-F-SC、CCTM-2PM/PA/18-4-5-F-SC、CCTM-2PM/PA/33-20-4-F-SC、CCTM- 2PM/PA/36-20-6-F-SC、CCTM-2PM/PS/22-10-1-F-SC、CCTM-2PM/PS/22-4-3-F-SC、CCTM-2PM/ PS/33-20-4-F-SC(L)、CCTM-2PM/PS/33-7-9-F-SC、CCTM-2PM/R-22-4-3-M-SC

键入时，最接近的匹配结果应显示在 datagrid/combobox 中。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:27:47.717

这可能不是最干净的解决方案，但您可以使用该字段的所有可能值填充 IEnumerable 对象类型（我们称之为`values`），然后使用 LINQ 查询该对象：

```
var matchesBefore = (from v in values 
    where v < txtSerach.Text 
    order by v descending
    select v).Take(5); 
var matchesAfter = (from v in values 
    where v > txtSerach.Text 
    order by v ascending 
    select v).Take(5); 
```

这将收集 10 个值（在 txtSearch 文本框中键入的文本之前有 5 个，之后有 5 个）。然后可以用这些值填充数据网格。

# android - 给定一个城市在 Android / iOS 上显示本地地图 - 使用 URL

> ID：13211222
> 
> 赞同：0
> 
> 时间：2012-11-03T16:43:23.293
> 
> 标签：android, iphone, apache-flex, map, flex-mobile

对于 Flex 移动版，有几种方法可以使用来自 Google（已弃用）、[ArcGIS](http://www.adobe.com/devnet/flash-builder/articles/mobile-mapping-app-arcgis.html)、[MapQuest](http://devgirl.org/2011/12/06/flex-mobile-development-adding-maps-with-mapquest-flash-api-w-sample-app/)等的 .swc 文件显示地图...

那么可能嵌入式浏览器（[StageWebView](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/StageWebView.html)组件）可以与谷歌地图 JS API 一起使用......

最后可以使用谷歌的静态地图图像 - 我目前在我的桌面上使用它来移动快速端口，但它看起来很难看并且无法平移：

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
        xmlns:s="library://ns.adobe.com/flex/spark" 
        title="{data.city}">

    <fx:Declarations>
        <s:MultiDPIBitmapSource id="BACK"
            source160dpi="@Embed('assets/icons/low-res/back.png')"
            source240dpi="@Embed('assets/icons/mid-res/back.png')"
            source320dpi="@Embed('assets/icons/high-res/back.png')"/>
    </fx:Declarations>

    <fx:Script>
        <![CDATA[   
            private static const MAP:String = 
                'http://maps.google.com/maps/api/staticmap?sensor=false&language=ru&maptype=roadmap&size=400x400&markers=';
        ]]>
    </fx:Script>

    <s:states>
        <s:State name="portrait"/>
        <s:State name="landscape"/>
    </s:states> 

    <s:navigationContent>
        <s:Button icon="{BACK}" label.landscape="Назад" click="navigator.popView()"/>
    </s:navigationContent>

    <s:BitmapImage source="{MAP + '' + encodeURI(data.city)}" width="100%" height="100%" scaleMode="zoom" />

</s:View> 
```

![在此处输入图像描述](../Images/6a8b7255b489660b0c0de0313e887333.png)

但**我的问题**是：有没有办法通过创建一些**特殊的 URL**（？）并在其上调用[navigateToUrl](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/package.html)来使用Android 设备和 iPhone/iPad 提供的**本机地图**？**`map:///`**

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:07:16.293

在 Android 上，欢迎您使用[`geo:`URL 值](http://developer.android.com/guide/appendix/g-app-intents.html)。它们是否会在 Flex 中工作，以及 iOS 是否也支持该方案，我不能说。**

# c++ - 使用 Linux C 代码和头文件编译 Windows DLL

> ID：13211224
> 
> 赞同：1
> 
> 时间：2012-11-03T16:43:27.240
> 
> 标签：c++, c, linux, dll, mono

我想知道通常是否可以使用 Visual C++ 2010 从 C 代码和我在 Linux 发行版中找到的头文件创建一个 C++ DLL。

从理论上讲，如果我从 Linux 中取出一段 C 代码（包含不同的头文件），在 Linux 文件系统中找到链接项目所需的所有头文件，我是否能够在 Windows 中成功编译项目使用 Visual C++ 2010？

是否有一些示例或教程可以做到这一点？

编译 DLL 后，我想在 C# 应用程序中使用它，我将在带有 Mono 的 Linux 下运行该应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T16:47:13.400

不，纯粹使用头文件可能是不可能的。
问题是某些函数（通常是大多数）是在目标文件和共享库中定义的，而不是在头文件中定义的，因此如果没有目标文件和共享库，您将无法编译它们。
对象文件和共享库不是跨平台的，因此您无法复制它们。
唯一的解决方案是使用像[Cygwin](http://www.cygwin.com/)这样的系统，它具有为 Windows 编译的 linux 头文件和目标文件/dll。

# objective-c - NSUserDefaults 写入字符串并在之后清理它

> ID：13211227
> 
> 赞同：-1
> 
> 时间：2012-11-03T16:43:32.193
> 
> 标签：objective-c, ios, uiwebview, plist, nsuserdefaults

我在 NSUserDefaults 中写了一个字符串

```
[[NSUserDefaults standardUserDefaults] setObject: myString forKey: @ "String"]; 
```

然后我从 NSUserDefaults 中取出这个字符串并返回

```
- (NSString *) retrieveString
{
     NSString * recoveredString = [[NSUserDefaults standardUserDefaults] objectForKey: @ "String"];
     return recoveredString;
} 
```

然后在 viewDidLoad 中将返回的字符串写入另一个字符串

```
NSString * filePath = [self retrieveString]; 
```

在我返回给她后，我需要删除一串 NSUserDefaults - (NSString *) retrievestring

我这样做

```
 - (NSString *) retrieveString
        {
             NSString * recoveredString = [[NSUserDefaults standardUserDefaults] objectForKey: @ "String"];
             [[NSUserDefaults standardUserDefaults] removeObjectForKey: @ "String"];
             return recoveredString;

        } 
```

但这不起作用，该行没有被删除。如何修复它

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T16:47:24.723

`NSUserDefaults`仅定期更新其数据，而不是每次调用 setter 或 getter 时。如果您想立即更新，请致电

```
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:12:57.437

您需要添加`synchronize`调用并移动您的返回调用（因此它是方法中的最后一行）。所以，你的代码应该是这样的：

```
- (NSString *) retrieveString
{
    NSString * recoveredString = [NSString stringWithString:[[NSUserDefaults standardUserDefaults] objectForKey: @ "String"]];
    [[NSUserDefaults standardUserDefaults] removeObjectForKey: @ "String"];
    [[NSUserDefaults standardUserDefaults] synchronize];
    return recoveredString;
} 
```

# java - Android：PopupWindow 内的 SurfaceView

> ID：13211228
> 
> 赞同：2
> 
> 时间：2012-11-03T16:43:36.997
> 
> 标签：java, android, surfaceview, popupwindow

是否可以显示 a `SurfaceView`inside a `PopoupWindow`？

使用此 XML 用于`PopupWindow`：

```
<?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:padding="10dip"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#444444"
    >
    <SurfaceView
        android:layout_width="100px"
        android:layout_height="100px"
    />
</LinearLayout> 
```

弹出窗口不起作用，并生成以下日志消息：

```
W/WindowManager(   60): Attempted to add window with token that is a sub-window: android.os.BinderProxy@4058e3c8\.  Aborting. 
```

使用`View`代替`SurfaceView`工作正常。

* * *

**编辑：** 似乎使用平台 2.3.3 存在问题，但使用平台 4.1 一切正常。我没有用其他平台版本测试过。

# bash - bash setid 和读取冻结

> ID：13211229
> 
> 赞同：1
> 
> 时间：2012-11-03T16:43:38.893
> 
> 标签：bash, ssh

我有用于 ssh 登录的脚本，而不是期望：

```
function do_auth_connect(){
    if [ -n "$SSH_ASKPASS_TMPFILE" ]; then
        cat "$SSH_ASKPASS_TMPFILE"
        exit 0
    elif [ $# -lt 1 ]; then
        echo "Usage: echo password | $0 <ssh command line options>" >&2
        exit 1
    fi

    sighandler() {
        rm "$TMP_PWD"
    }

    TMP_PWD=$(mktemp)
    chmod 600 "$TMP_PWD"
    trap 'sighandler' SIGHUP SIGINT SIGQUIT SIGABRT SIGKILL SIGALRM SIGTERM

    export SSH_ASKPASS=$0
    export SSH_ASKPASS_TMPFILE=$TMP_PWD

    [ "$DISPLAY" ] || export DISPLAY=dummydisplay:0
    read password
    echo $password >> "$TMP_PWD"

    # use setsid to detach from tty
    #exec setsid "$@"
    setsid "$@"

    rm "$TMP_PWD"
} 
```

如果我使用如下命令：

```
echo "my_password" | do_auth_connect ssh use@domain "uname -a" 
```

一切正常。但如果我使用：

```
read password
echo "$password" | do_auth_connect ssh use@domain "uname -a" 
```

脚本冻结。

“set -x”表示脚本进入循环，并等待另一个“读取”参数。

我该如何解决这个问题？谢谢

**---UPD---**（对于@Barmar）

正常时设置 -x 输出（以 scp 为例）：

```
+ echo 'user_password'
+ do_auth_connect scp -P 444 user@domain:/home/user/dbg.log /home/user/dbg.log
+ '[' -n '' ']'
+ '[' 5 -lt 1 ']'
++ mktemp
+ TMP_PWD=/tmp/tmp.X8TKTIchq6
+ chmod 600 /tmp/tmp.X8TKTIchq6
+ trap sighandler SIGHUP SIGINT SIGQUIT SIGABRT SIGKILL SIGALRM SIGTERM
+ export SSH_ASKPASS=./1.sh
+ SSH_ASKPASS=./1.sh
+ export SSH_ASKPASS_TMPFILE=/tmp/tmp.X8TKTIchq6
+ SSH_ASKPASS_TMPFILE=/tmp/tmp.X8TKTIchq6
+ '[' :0.0 ']'
+ read password
+ echo 'user_password'
+ setsid scp -P 444 user@domain:/home/user/dbg.log /home/user/dbg.log
+ echo 'user_password'
+ do_auth_connect scp -P 444 user@domain:/home/user/dbg.log /home/user/dbg.log
+ '[' -n /tmp/tmp.X8TKTIchq6 ']'
+ cat /tmp/tmp.X8TKTIchq6
+ exit 0
+ rm /tmp/tmp.X8TKTIchq6
+ exit 
```

失败时：

```
+ read pass
> user_password
+ echo 'user_password'
+ do_auth_connect scp -P 444 user@domain:/home/user/dbg.log /home/user/dbg.log
+ '[' -n '' ']'
+ '[' 5 -lt 1 ']'
++ mktemp
+ TMP_PWD=/tmp/tmp.7usdmtHgqt
+ chmod 600 /tmp/tmp.7usdmtHgqt
+ trap sighandler SIGHUP SIGINT SIGQUIT SIGABRT SIGKILL SIGALRM SIGTERM
+ export SSH_ASKPASS=./1.sh
+ SSH_ASKPASS=./1.sh
+ export SSH_ASKPASS_TMPFILE=/tmp/tmp.7usdmtHgqt
+ SSH_ASKPASS_TMPFILE=/tmp/tmp.7usdmtHgqt
+ '[' :0.0 ']'
+ read password
+ echo 'user_password'
+ setsid scp -P 444 user@domain:/home/user/dbg.log /home/user/dbg.log
+ read -p '> ' pass 
```

这就是全部，^C 不起作用:)

**---UPD2---**

我发现任何“读取”都会破坏脚本例如：

```
read null
echo "user_password" | do_auth_connect scp -P 444 user@domain:/home/user/dbg.log ~/dbg.log 
```

有一些冻结问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-20T05:24:29.633

来到这里寻找类似的情况：ssh 调用包含调用的远程脚本`setsid`，并且观察 ssh 永远不会终止。

```
ssh remotehost start-daemon.sh 
```

在哪里启动-daemon.sh

```
#!/bin/bash
...
setsid $daemon $args &
exit 0 
```

ssh 将挂起，必须给予 ^C 才能停止。修复（如[https://serverfault.com/questions/364689](https://serverfault.com/questions/364689)评论中所暗示的）是重定向 setid 的标准输出：

```
setsid $daemon $args > /dev/null & 
```

然后 ssh 按预期停止。在我的测试中，stderr 不需要相同的处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T15:51:34.287

> ```
> SSH_ASKPASS           If ssh needs a passphrase, it will read the passphrase from
>                        the current terminal if it was run from a terminal.  If ssh
>                        does not have a terminal associated with it but DISPLAY and
>                        SSH_ASKPASS are set, it will execute the program specified by
>                        SSH_ASKPASS and open an X11 window to read the passphrase.
>                        This is particularly useful when calling ssh from a .xsession
>                        or related script.  (Note that on some machines it may be
>                        necessary to redirect the input from /dev/null to make this
>                        work.) 
> ```

相关：

*（请注意，在某些机器上，可能需要从 /dev/null 重定向输入以使其工作。）*

这是非常模糊的，尝试按照在发出 ssh 命令之前的建议将输入重定向到 /dev/null

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-11-19T13:45:58.173

*[由于将评论标记为答案的](https://meta.stackexchange.com/questions/82099/answering-comment-answered-questions)功能请求仍然被拒绝，因此我在此处复制上述解决方案。*

当您执行 SSH_ASKPASS=$0 时，这意味着“为了获取密码，请再次运行此脚本”。如果脚本在开始时确实读取了 pass，它将再次执行。您需要以密码是否已保存在临时文件中为条件。– 巴尔马尔

# oop - 我的程序没有进入我的第二个 for 循环

> ID：13211231
> 
> 赞同：0
> 
> 时间：2012-11-03T16:43:54.923
> 
> 标签：oop, loops, for-loop

在为我的大学实验室做一些工作时，我正在创建这个函数，其中另一个函数中有一个 for 循环。

知道该方法用于什么并不重要。我只是不明白为什么程序没有进入第二个 for 循环。这是代码：

```
public void worseFit(int[] array){
  int tempPosition = -1;
  int tempWeight = 101 ;
  for (int x = 0; x < (array.length - 1); x++){
    if (allCrates.getSize() < 1){
      Crate crate = new Crate();
      crate.addWeight(array[0]);
      allCrates.add(crate);
    } else{
      for( int i = 1; i < (allCrates.getSize() - 1); i++ ){
        Crate element = allCrates.getElement(i);
        int weight = element.getTotalWeight();
        if (weight < tempWeight){
          tempWeight = weight;
          tempPosition = i;
          Crate crate = new Crate();    
          if (weight + tempWeight <= 100){ 
            crate.addWeight(weight + tempWeight);
            allCrates.setElement(i, crate);
          } else {
            crate.addWeight(weight);
            allCrates.setElement(allCrates.getSize(), crate);
          } // if
        } // if 
      } // for
    } // if
  } // for
} // worseFit 
```

一旦程序进入代码的 else 部分，它就会立即回到第一个 for 循环的开头。

有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T16:47:52.727

的预期值似乎存在一些差异`allCrates.getSize()`。

如果`allCrates.getSize()`返回 2，将进入第二个 for 循环，但不运行它，这样`i < allCrates.getSize() - 1`会导致 false

您可能想使用`<=`而不是`<`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T16:49:55.600

`i`将第二个循环中的变量初始化为`0`而不是`1`. 因为如果您`getSize()`返回 1，它将不会进入该`if`部分，并且在进入该`else`部分后，`for`循环条件将评估为 false，因此您的`for`循环将不会被执行。

# python - 如何更改 pinax(0.9a2) 模板？

> ID：13211233
> 
> 赞同：1
> 
> 时间：2012-11-03T16:44:18.670
> 
> 标签：python, django, windows, pinax

我已经用 pinax-bootstrap 主题安装了 pinax(0.9a2)！

现在我想自定义它并重新设计主题，但我没有在我的模板文件夹中找到任何 *.css 文件。那么如何自定义bootstrap主题的css呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T17:12:24.087

所以这就是我如何让我的基本 pinax 项目启动并运行：-

```
mkvirtualenv -p python2.7 --distribute mysite
cd ~/work
pinax-admin setup_project -b basic mysite
cd mysite
pip install -r requirements/base.txt
python manage.py collectstatic
python manage.py syncdb
python manage.py runserver 8001 
```

这给了我这个： -

![在此处输入图像描述](../Images/6af200eabd34f29f96add75f5395d39b.png)

现在我的 pinax 在默认情况下与 bootstrap 主题完美运行，我可以继续使用 CSS 覆盖来自定义我的主题。

由于我的 pinax settings.py 指向

```
# Additional directories which hold static files
STATICFILES_DIRS = [
    os.path.join(PROJECT_ROOT, "static"),
] 
```

我们将把我们所有的css文件放在我们项目根目录“mysite”下的这个静态目录中。

CSS 覆盖通过在我们的模板中加载引导程序的 css 后加载我们自己的自定义 css 文件来工作。

我们指定的 CSS 类及其新定义将覆盖 bootstrap 提供的默认值。这就是我们自定义引导主题的方式，同时保留 bootstrap.css，这就是为什么我们的`static`目录在开始时为空的原因。

例如，我们在`bootstrap.min.css`默认情况下定义了我们的 topbar 类。

```
.topbar-inner, .topbar .fill {
background-color: #222;
...
} 
```

我们可以在目录中指定我们自己的 css 文件，在我们的文件中`static`加载这个 css 文件，`templates/site_base.html`并在我们自己的 css 文件中为顶部栏指定一种新颜色，如下所示：-

```
.topbar-inner, .topbar .fill {
    background-color: red;
    background-image: -webkit-linear-gradient(top, #333, #FF4242);
    background-image: -o-linear-gradient(top, #333, #FF4242);
    background-image: linear-gradient(top, #333, #FF4242);
} 
```

这将导致我们主页上的黑色顶栏呈现为黑红色。这是使用覆盖来自定义我们的 css 类的基本前提，其默认值已经在 bootstrap.min.css 中定义。

示例修改`mysite/templates/homepage.html`

```
{% extends "banner_base.html" %}

{% load i18n %}

{% block extra_head %}
<link rel="stylesheet" href="{{ STATIC_URL }}css/my_custom_stuff.css">
{% endblock %}

{% block head_title %}{% trans "Welcome" %}{% endblock %}

{% block body_class %}home{% endblock %}

{% block banner %}
    <h1>{% trans "Welcome to Pinax" %}</h1>
    <p>
        {% blocktrans %}
        <b>Pinax</b> is a <a href="http://djangoproject.com/">Django</a>
        project intended to provide a starting point for websites. By
        integrating numerous reusable Django apps to take care of the
        things that many sites have in common, it lets you focus on what
        makes your site different.
        {% endblocktrans %}
    </p>

    <h2>About Zero Project</h2>
    <p>
        {% blocktrans %}
        This project lays the foundation for all other Pinax starter projects. It
        provides the project directory layout and some key infrastructure apps on
        which the other starter projects are based.
        {% endblocktrans %}
    </p>

    <p><a href="http://pinaxproject.com/" class="btn primary large">{% trans "Learn more &raquo;" %}</a></p>
{% endblock %} 
```

添加的具体块是

```
{% block extra_head %}
<link rel="stylesheet" href="{{ STATIC_URL }}css/my_custom_stuff.css">
{% endblock %} 
```

请注意，我们也可以将其添加到`mysite/templates/site_base.html`. 这完全取决于您要在我们的`my_custom_stuff.css`文件中加载哪个模板。

`my_custom_stuff.css`需要驻留在`mysite/static/css`目录中。

# gwt - Flex 表中的对齐方式

> ID：13211241
> 
> 赞同：1
> 
> 时间：2012-11-03T16:45:08.550
> 
> 标签：gwt, google-apps-script

如何让 flex 表 (flex3) 在[此 Ui](https://script.google.com/macros/s/AKfycbxGQS_xrPZMcxQ6uzTErFzdzd_hO2JNwetOnKNkrbIOt0PYB1Q/exec)的顶部对齐？

```
function doGet(e) {
  var app = UiApp.createApplication();
  var flex1 = app.createFlexTable().setBorderWidth(1);
  var flex2 = app.createFlexTable().setBorderWidth(1).setWidget(0, 0, app.createLabel('flex2'))
      .setWidget(1, 0, app.createTextArea().setHeight(400).setText('Text area in flex2'));
  var flex3 = app.createFlexTable().setBorderWidth(1).setWidget(0, 0, app.createLabel('flex3'));

  flex1.setWidget(0, 0, flex2).setWidget(0, 1, flex3);  
  app.add(flex1);
  return app;
} 
```

本来期待...

`var flex1 = app.createFlexTable().setBorderWidth(1).setStyleAttribute('vertical-align', 'top');`

或者

```
var flex1 = app.createFlexTable().setBorderWidth(1).setColumnStyleAttribute(1, 'vertical-align', 'top'); 
```

去工作。

此外，对根使用流面板而不是 flex 也没有按预期工作。这将 2 flex 垂直堆叠，而不是从左到右堆叠。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:07:46.843

将这条线添加到底部对我来说是诀窍 -

```
flex1.setStyleAttribute(0, 1, 'vertical-align', 'top'); 
```

不知道为什么全局设置样式或设置列样式不起作用。但是，将其设置在特定的行/列上似乎可行。让我知道。

这可能必须在[问题跟踪器](http://code.google.com/p/google-apps-script-issues/issues/list)上结束，请在那里检查并记录问题。

# forms - sf 1.4 以根形式访问和自定义 embededObject()

> ID：13211248
> 
> 赞同：2
> 
> 时间：2012-11-03T16:45:53.983
> 
> 标签：forms, symfony-1.4

我在根表单中保存嵌入表单的自定义值时遇到问题。

我实际上可以编辑“表现形式”，并且可以添加任意数量的“commande_wifi”。一切都很好保存。

我需要为每个“commande_wifi”定制流程（有一个 'puht' 值取决于 object() 的其他值）。我已经为此浪费了几个小时。

> 1.  save() 仅在根表单上调用
> 
> 这是正确的！只有根表单调用了 save()。因此，如果您要运行其他逻辑，您将需要覆盖 saveEmbeddedForm 方法并在之前调用该代码。前面的过度简化：当你保存一个带有嵌入表单的表单时，它调用 $this->getObject()->save()，然后它调用 saveEmbeddedForms，对于每个嵌入表单，它调用 $form->saveEmbeddedForms() 然后调用$form->getObject()->save()。了解这一点至关重要，因为它会在以后为您省去很多麻烦。 [http://jmather.com/2011/01/29/6-things-to-know-about-embedded-forms-in-symfony/](http://jmather.com/2011/01/29/6-things-to-know-about-embedded-forms-in-symfony/)

我试图覆盖 saveembededForms() 但此时失败。

```
class manifestationForm extends BasemanifestationForm
{
  public function configure()
  {
    $this->embedRelation('commande_wifi');

  }

  public function addNewFields($number){
    $new_commandes = new BaseForm();

    for($i=0; $i <= $number; $i+=1){
      $commande = new Commande_wifi();
      $commande->setManifestation($this->getObject());
      $commande_form = new commande_wifiForm($commande);

      $new_commandes->embedForm($i,$commande_form);
    }

    $this->embedForm('new', $new_commandes);
  }

  public function bind(array $taintedValues = null, array $taintedFiles = null){

    $new_commandes = new BaseForm();
    foreach($taintedValues['new'] as $key => $new_commande){
      $commande = new Commande_wifi();
      $commande->setManifestation($this->getObject()); 
      $commande_form = new commande_wifiForm($commande);

      $new_commandes->embedForm($key,$commande_form);
    }

    $this->embedForm('new',$new_commandes);          

    parent::bind($taintedValues, $taintedFiles);
  }

  public function saveEmbeddedForm($con = null, $forms = null)
  {
      if ($con === NULL)
      {
        $con = $this->getConnection();
      }

      if ($forms === NULL)
      {
        $forms = $this->getEmbeddedForms();
      }

      foreach ($forms as $form)
      {
        if ($form instanceof sfFormObject)
        {
          $form->saveEmbeddedForms($con);
          $form->getObject()->setPuht(99);
          $form->getObject()->save($con);
        }
        else
        {
          $this->saveEmbeddedForms($con, $form->getEmbeddedForms());
        }
        //$form->getObject()->setPuht(99)->save();

      }    
  }
} 
```

它尽快赢得我可以访问 embedForm Object()。

有什么建议吗？

# c# - 仅从图像位置旋转 C# 桌面应用程序中的图像

> ID：13211254
> 
> 赞同：2
> 
> 时间：2012-11-03T16:46:42.030
> 
> 标签：c#, sql, image, desktop

我正在编写一个 C# 桌面应用程序，该应用程序涉及从数码相机导入图像，并将它们保存在 SQL Compact Edition 数据库中。我不是在数据库中保存实际图像，而是图像文件路径（以节省数据库空间）。然后，我从数据库中提取该图像文件路径并将图片框的 Image Location 属性设置为该路径，以进行显示。

我的问题是……我想添加一个按钮，允许用户在导入后旋转图像。有没有办法在不创建新图像的情况下做到这一点？我知道 RotateFlip 方法，但它只适用于 Image 类型。基本上，我想旋转链接文件路径的图像，而不是从该路径创建图像，然后旋转它。我会喜欢一些想法。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:06:42.743

除非您先加载图像，否则您无法旋转图像给定的路径。

顺便说一句，没有必要包含有关您正在使用的数据库的信息，这些信息与您的问题无关。

# web-applications - Yii 关系定义中条件的正确语法

> ID：13211257
> 
> 赞同：0
> 
> 时间：2012-11-03T16:46:53.993
> 
> 标签：web-applications, yii, relation

我正在努力为我要设置的关系条件获取正确的语法。主关系用外键 question_id 设置，但子表中还包含 user_id 列。

我希望只返回与登录用户相关的记录。这是我到目前为止所得到的-

```
 class SurveyQuestion extends CActiveRecord {
 .......

   public function relations()
    {
        return array(           
            'answered_questions' => array(self::HAS_MANY, 'AnsweredQuestion', 'question_id',
                'condition'=>"answered_questions.user_id = Yii::app()->user->id'"),
        );
   } 
```

请有人可以纠正我到目前为止不起作用的语法吗？我与 Yii 合作的时间不长，所以如果我的“条件”条款全错了，我不会感到惊讶。

非常感谢，

缺口

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:00:53.723

`answered_questions.user_id = Yii::app()->user->id'`将检查 answers_questions.user_id 是否等于字符串 'Yii:: .....' 而不是实际的用户 ID。您需要结束引号并将其附加为 PHP 命令：

`'condition'=>"answered_questions.user_id = ".Yii::app()->user->id),`

除非这只是您的问题中的错字？

# c# - 使用属性调用方法

> ID：13211261
> 
> 赞同：14
> 
> 时间：2012-11-03T16:47:27.503
> 
> 标签：c#, reflection, architecture, attributes, aop

我有各种单独的方法，它们都需要在继续自己的实现之前执行相同的功能。现在我可以在每个方法中实现这些功能，但我想知道是否有一种方法可以利用`attributes`来做到这一点？作为一个非常简单的示例，所有网络调用都必须检查网络连接。

```
public void GetPage(string url)
{
   if(IsNetworkConnected())
      ...
   else
      ...           
} 
```

这会起作用，但我必须`IsNetworkConnected`为每个使用网络的方法调用该方法并单独处理它。相反，我想这样做

```
[NetworkCall]
public void GetPage(string url)
{
   ...
} 
```

如果网络不可用，则会调用错误方法并被`GetPage`忽略，否则`GetPage`调用。

这听起来很像面向方面的编程，但我不想为几个调用实现一个完整的框架。这更像是一种学习练习而不是实施练习，所以我很好奇如何最好地实施这样的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T00:40:08.103

你可以使用[PostSharp](http://www.sharpcrafters.com/)，它是面向方面的 .NET 框架，看起来[很容易使用](http://www.sharpcrafters.com/postsharp/documentation)：

```
static void Main(string[] args)
{
    Foo();
}

[IgnoreMethod(IsIgnored=true)]
public static void Foo()
{
    Console.WriteLine("Executing Foo()...");
}

[Serializable]
public class IgnoreMethodAttribute : PostSharp.Aspects.MethodInterceptionAspect
{
    public bool IsIgnored { get; set; }

    public override void OnInvoke(PostSharp.Aspects.MethodInterceptionArgs args)
    {
        if (IsIgnored)
        {
            return;
        }

        base.OnInvoke(args);
    }
} 
```

****免费**版中提供了**方法级别方面**功能：http: [//www.sharpcrafters.com/purchase/compare](http://www.sharpcrafters.com/purchase/compare)**

 **运行时性能：

> 由于 PostSharp 是一种编译器技术，大部分昂贵的工作都是在构建时完成的，因此应用程序可以快速启动并快速执行。在生成代码时，PostSharp 假设调用虚拟方法或获取静态字段是一项昂贵的操作。与传闻相反，PostSharp 在运行时不使用 System.Reflection。 [http://www.sharpcrafters.com/postsharp/performance](http://www.sharpcrafters.com/postsharp/performance)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T00:17:08.830

我认为您不能`attributes`仅使用它们来执行此操作，因为如果您不主动对它们进行某些操作，则它们不会由运行时执行。一种轻量级的方法是[带有 Interceptions 扩展的 Ninject](http://codepyre.com/2010/03/using-ninject-extensions-interception-part-1-the-basics/)，它是一个框架，但非常薄，而且您可能已经在 DI 中使用它。

另一种选择，但涉及更多一点，可以基于[MEF](http://msdn.microsoft.com/en-us/library/dd460648.aspx)，然后您可以在激活期间使用属性并使用它们做一些事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T00:31:01.057

你是对的，这听起来很像 AOP。
你所追求的听起来像是编译时编织？即，编译器将属性转换为附加代码。
你可以看看如何实现这个...
[通过自定义属性生成附加代码](https://stackoverflow.com/questions/6066218/generating-additional-code-through-a-custom-attribute)
[http://www.cs.columbia.edu/~eaddy/wicca/](http://www.cs.columbia.edu/~eaddy/wicca/) &
[http://www.sharpcrafters.com/aop.net/ compiletime-weaving](http://www.sharpcrafters.com/aop.net/compiletime-weaving)
都是指执行此操作的工具和技术。

或者您可以使用 AOP 框架。恕我直言，你应该看看 AOP 框架。**

# facebook - 钛 - 获取 facebook 用户名？

> ID：13211262
> 
> 赞同：1
> 
> 时间：2012-11-03T16:47:32.510
> 
> 标签：facebook, titanium

使用钛，是否有人有一些简单的说明来获取用户的 Facebook 名称，一旦登录到 Facebook？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:42:37.793

您无需执行任何此操作，登录完成后数据响应中会提供用户名。

[查看 appcelerator 文档](http://docs.appcelerator.com/titanium/latest/#!/api/Titanium.Facebook-event-login)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T18:54:43.960

我还没有测试过代码，但你可以试试这个：

```
var fbuid = Titanium.Facebook.uid; //this would be the logged user's facebook uid

function fQuery() //this function exec the fql query
{
    var myQuery = "SELECT name FROM user WHERE uid = "+fbuid;

    var data = [];

    Titanium.Facebook.request('fql.query', {query: myQuery},  function(x)
    {   
        var results = JSON.parse(x.result);
        var username = results[0].name; //user's fb name
    });
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T17:20:45.300

啊，这是你的做法：

```
function getFacebookInfo(){
    Titanium.Facebook.requestWithGraphPath('me', {}, 'GET', function(e){
        if (e.success){
            var jsonObject  = JSON.parse(e.result);
            //do something here with these values. They cannot be passed out of this
            //function call... this is an asynchronous call
            //that is, do this:
            saveToDb(jsonObject.first_name);
        } else {
            //some sort of error message here i guess
        }
    });

}; 
```

最后，连同`name`and一起`username`查看 facebook 页面，了解您可以获得的其他变量 -

[http://developers.facebook.com/docs/reference/api/](http://developers.facebook.com/docs/reference/api/)

最后：请注意，这是一个**回调**，并且钛实际上不会等待此调用完成。也就是说，任何声明保存在 requestWithGraphPAth 之后返回的结果的变量都将*立即*返回，因此几乎总是为空。

我想你可以做一个漂亮的循环，只是......循环直到某个变量设置为假。你会在回调中将变量设置为 false ......但这似乎很狡猾。

只需让您的回电执行*其他所有*操作，即保存到数据库等

如果你*确实*走调用 Ti.Facebook.authorise() 来登录用户的路线，记得定义

```
Ti.Facebook.addEventListener('login',function(e){
    if (e.success){ 
...
...
    } else if (e.error){  } else if (e.cancel) { }
} 
```

通话前。然后，在成功位中，您可以进行 requestWithGraphPath 调用等等。我只是将所有详细信息保存到数据库中，然后每次都检索它们，对我来说很好！

# chat - 如何构建gmail聊天机器人？

> ID：13211264
> 
> 赞同：3
> 
> 时间：2012-11-03T16:47:37.347
> 
> 标签：chat, bots, google-talk, chatbot

我想构建一个简单的 gmail 聊天机器人。机器人读取收件人的聊天消息并做出响应。

我已经开发了响应消息的逻辑，但现在我坚持使用机器人配置。

如何设置一个可以从聊天窗口接收消息并将消息发送给我的 gmail bot。并将我的消息回复给聊天中的人？

注意：这个问题可能看起来重复，但我已经尝试了上一个问题的所有解决方案，我无法在任何地方从头开始找到完整的解决方案。

希望任何时候都可以在这里帮助我。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-03T16:51:45.553

您需要使用 Google Talk API。更多信息可以在[这里](https://developers.google.com/talk/)找到。我以前从未使用过它，但根据我的阅读，您需要用兼容的语言编写逻辑才能与 API 交互并从那里构建。链接中非常标准的 Google API 文档、帮助等。

如果你知道 Python 有一个为此目的而构建的[库，bot 允许开发人员快速轻松地部署机器人。](http://code.google.com/p/pygtalkrobot/)我强烈建议您使用它。如果您不了解 Python，这里有另一个指南[，](http://www.labnol.org/internet/tutorial-create-bot-for-gtalk-yahoo-messenger/4354/)它解释了如何使用非常少的 PHP/Perl 代码来完成它。如果您不了解 PHP 或 Perl，这里有另一个资源[解释](http://njsbot.simonholywell.com/)了如何在 Node.js 中进行操作。如果你不懂 Javascript，[这里](http://blog.appenginefan.com/2009/09/my-first-attempt-at-xmpp-in-java-app.html)是如何用 Java 做的。

我不喜欢发布指南的链接，但 API 文档应该已经足够了。这些都是通过谷歌搜索词“制作谷歌谈话机器人”找到的。

# sql - 返回 cte 中的总记录

> ID：13211268
> 
> 赞同：1
> 
> 时间：2012-11-03T16:48:09.063
> 
> 标签：sql, sql-server, sql-server-2008, tsql

在[本文的](http://pratchev.blogspot.com/2008/11/paging-with-ranking-functions.html?m=1)帮助和 SO 专家最近的回答下，我得到了以下内容，这将帮助我有效地翻阅一组记录。

我想我的最后几个问题是

1.  看看我如何`Total Number of Records`在名为“Total”的 SQL CTE 末尾包含有效负载。你会这样做吗？
2.  还有其他建议吗？更简洁或改进的潜在领域？`Return Total Number of Pages`

* * *

```
DECLARE @page_size INT = 5;
DECLARE @page_nbr INT = 4;
DECLARE @search NVARCHAR(MAX) = '';
DECLARE @sort_order INT = 2;

WITH AllProducts
AS
(
SELECT *, 
CASE @sort_order
    WHEN 1 THEN ROW_NUMBER() OVER ( ORDER BY ProductID )
    WHEN 2 THEN ROW_NUMBER() OVER ( ORDER BY ProductName )
END AS 'Seq'    
FROM Products
),
Filtered
AS
(
SELECT * FROM AllProducts
WHERE ProductName like '%'+@search+'%'
OR
@search is null
)
SELECT (select COUNT(*) from Filtered) as 'Total', * FROM Filtered
WHERE seq > (@page_nbr - 1) * @page_size
  AND seq <= @page_nbr * @page_size 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:18:00.580

我认为您的查询有问题：它对记录进行编号（用于分页），然后应用过滤器。

例如，您可能请求记录的第 2 页，但同时`seq`可能会过滤掉所有具有相应值的记录。因此，在这种情况下，查询不会产生任何结果，尽管表中可能有大量记录。

为了解决这个问题，您可以在同一个 CTE 中进行过滤和记录编号，如下所示：

```
DECLARE @page_size INT = 5;
DECLARE @page_nbr INT = 4;
DECLARE @search NVARCHAR(MAX) = '';
DECLARE @sort_order INT = 2;

WITH Filtered AS (
    SELECT *, 
        CASE @sort_order
            WHEN 1 THEN ROW_NUMBER() OVER ( ORDER BY ProductID )
            WHEN 2 THEN ROW_NUMBER() OVER ( ORDER BY ProductName )
        END AS 'Seq'
    FROM AllProducts
    WHERE ProductName like '%'+@search+'%' OR @search is null
)
SELECT (select COUNT(*) from Filtered) as 'Total', * FROM Filtered
WHERE seq > (@page_nbr - 1) * @page_size
  AND seq <= @page_nbr * @page_size 
```

# java - 如何使用 Ext.data.writer.Json 创建应用了 nameProperty 的模型对象

> ID：13211273
> 
> 赞同：0
> 
> 时间：2012-11-03T16:48:45.803
> 
> 标签：java, javascript, extjs, extjs4, extjs4.1

我在我的商店的代理中设置了 nameProperty，如下所示：代码：

```
writer : {
        type : 'json',
        nameProperty : 'mapping',
        root : 'PerVO'
    } 
```

在我的模型中，映射如下：

```
 {
            name : 'modules',
            mapping : 'modules.collection',
            defaultValue: []
        }, 
```

当我在商店中调用 CRUD 操作时，这很好用。现在我想将格式的数据发送到服务器以进行其他操作。问题是当我从 store 获取记录时，映射丢失了。那么我如何使用Ext.data.writer.Json 或其他一些api来生成数据，就像它在发送到应用了映射的服务器时生成的一样：

这是商店发送保存的内容（我需要这样的数据。注意：区别是“收藏：”）

```
 "modules": {
        "collection": {
            "isActive": 1,
            "metadata": {
                "actionCodes": "",
                "memos": ""
            },
            "moduleCode": "OM",
            "moduleId": 250,
            "moduleName": "Org Management",
            "success": false,
            "viewId": 0
        }
    }, 
```

这是我在查找记录时从商店得到的：

```
 "modules": {
                    "isActive": 1,
                    "metadata": {
                        "actionCodes": "",
                        "memos": ""
                    },
                    "moduleCode": "OM",
                    "moduleId": 250,
                    "moduleName": "Org Management",
                    "success": false,
                    "viewId": 0
                }, 
```

我需要获取商店发送到服务器的数据。谢谢 Nohsib

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:36:18.353

只需将映射中的名称更改为以下

```
{
   name : 'collection',
   mapping : 'modules.collection',
   defaultValue: []
} 
```

`name`config 是在`model`. 如果查看对象的`data`属性，映射中使用的 用于将值存储在. 这与我们在从对象中检索数据时使用的名称相同。前任。`model``name``model``name``model``model.get(name);`

从[api](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Field-cfg-name)。

> 在模型中引用字段的名称

# mysql - MONTH() 的 SUM 未正确计算

> ID：13211274
> 
> 赞同：0
> 
> 时间：2012-11-03T16:48:49.980
> 
> 标签：mysql, date, sum

在我的代码中，我得到了以下时间存在的行数：

今天 昨天 2 天前 3 天前 4 天前 5 天前 6 天前 7 天前 本周 本月 本月上个月 本年

现在每一次都很好，除了“这个月”。似乎计算不正确。这是我的 SQL：

```
$sql = mysql_query("select `website`, 
                    sum(case when DATE(FROM_UNIXTIME(`date_assigned`)) = DATE(CURDATE()) then 1 else 0 end) AS c_day, 
                    sum(case when DATE(FROM_UNIXTIME(`date_assigned`)) = DATE(CURDATE() - INTERVAL 1 DAY) then 1 else 0 end) AS c_yesterday, 
                    sum(case when DATE(FROM_UNIXTIME(`date_assigned`)) = DATE(CURDATE() - INTERVAL 2 DAY) then 1 else 0 end) AS c_2_days, 
                    sum(case when DATE(FROM_UNIXTIME(`date_assigned`)) = DATE(CURDATE() - INTERVAL 3 DAY) then 1 else 0 end) AS c_3_days, 
                    sum(case when DATE(FROM_UNIXTIME(`date_assigned`)) = DATE(CURDATE() - INTERVAL 4 DAY) then 1 else 0 end) AS c_4_days, 
                    sum(case when DATE(FROM_UNIXTIME(`date_assigned`)) = DATE(CURDATE() - INTERVAL 5 DAY) then 1 else 0 end) AS c_5_days, 
                    sum(case when DATE(FROM_UNIXTIME(`date_assigned`)) = DATE(CURDATE() - INTERVAL 6 DAY) then 1 else 0 end) AS c_6_days,
                    sum(case when DATE(FROM_UNIXTIME(`date_assigned`)) = DATE(CURDATE() - INTERVAL 7 DAY) then 1 else 0 end) AS c_7_days,
                    sum(case when WEEK(FROM_UNIXTIME(`date_assigned`)) = WEEK(CURDATE()) then 1 else 0 end) AS c_week, 
                    sum(case when MONTH(FROM_UNIXTIME(`date_assigned`)) = MONTH(CURDATE()) then 1 else 0 end) AS c_month,
                    sum(case when MONTH(FROM_UNIXTIME(`date_assigned`)) = MONTH(CURDATE() - INTERVAL 1 MONTH) then 1 else 0 end) AS c_last_month,
                    sum(case when YEAR(FROM_UNIXTIME(`date_assigned`)) = YEAR(CURDATE()) then 1 else 0 end) AS c_year
                    from `assignments`
                    where `id_dealership`!='65' and `id_dealership`!='77' and `id_dealership`!='89'
                    group by `website`
                    order by `website` asc
                    ") or die(mysql_error()); 
```

如您所见，`c_month`是什么导致了我的问题。考虑到 c_last_month 工作完美，我不知道为什么会发生这种情况。

再次编辑：

下面是表结构和一些示例数据：

```
CREATE TABLE IF NOT EXISTS `assignments` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `id_dealership` int(11) NOT NULL,
  `id_lead` int(11) NOT NULL,
  `date_assigned` int(11) NOT NULL,
  `website` varchar(255) NOT NULL DEFAULT '',
  `make` varchar(255) NOT NULL DEFAULT '',
  `model` varchar(255) NOT NULL DEFAULT '',
  `ip_address` varchar(255) NOT NULL DEFAULT '',
  PRIMARY KEY (`id`),
  KEY `id_dealership` (`id_dealership`),
  KEY `id_lead` (`id_lead`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=9848 ;

(1165, 40, 1373, 1325540129, 'website.com', 'Ford', 'Edge', ''),
(1164, 34, 1372, 1325539601, 'website.com', 'Ford', 'F-350', ''),
(1163, 34, 1371, 1325537245, 'website.com', 'Ford', 'Focus', ''),
(1162, 34, 1370, 1325529221, 'website.com', 'Ford', 'Flex', ''), 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T08:27:35.290

MySQLs[`MONTH()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_month)从日期返回当前月份。这意味着您在脚本中的条件仅匹配：

*   在`2012-10-01`- 1 天
*   开`2012-10-05`- 5 天
*   在`2012-10-30`- 30 天（**正确**）

因此，您的脚本每月最后一天正常运行一次 :) 并且您正在显示“*自本月初以来的查看次数*”。

所以你基本上只需要更换条件

```
sum(case when MONTH(FROM_UNIXTIME(`date_assigned`)) =
    MONTH(CURDATE()) then 1 else 0 end) AS c_month 
```

有了这个（它将计算过去 31 天的项目）：

```
SUM(CASE (`date_assigned` > (CURDATE() - INTERVAL 1 MONTH))
   THEN 1 ELSE 0 END) AS c_month 
```

* * *

还有一件事，我会担心你的表现。我会在单独的表中计算摘要信息（或将列添加到现有表中）并使用预先计算的数据并用脚本刷新它们（通过 cron 左右执行）。

如果您要求数据准确，请在`date_assigned`（或更确切地说是`id_dealership, date_added`）上添加索引并扩展条件：

```
AND `date_added` >= (CURDATE() - INTERVAL 1 YEAR)) 
```

只处理一年前的记录（不再处理）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T09:24:51.113

你的情况

```
sum(case when MONTH(FROM_UNIXTIME(`date_assigned`)) = MONTH(CURDATE())
     then 1 else 0 end) AS c_month, 
```

不应使用，因为一旦您的数据库包含更多信息，它将不会返回正确的信息。

```
MONTH('2011-11-14') = MONTH('2012-11-04') = MONTH('2013-11-24') 
```

如果要显示本月的统计数据，则应同时检查 MONTH() 和 YEAR()。这个月不仅仅是 11 月，而是 2012 年 11 月。

上个月也是如此。

# objective-c - 自动滚动视图

> ID：13211275
> 
> 赞同：0
> 
> 时间：2012-11-03T16:48:57.063
> 
> 标签：objective-c, xcode

是否有制作自动滚动视图的解决方案？我有多个图像。例如：第一个图像是 320 x 10000 ，第二个是 320 8000。

我有这个代码。

这是数据管理器：

```
<code>
#import "DataManager.h"

@interface DataManager ()

@property (nonatomic, strong) NSArray * myArr;
@property (nonatomic, strong) NSArray * myArrTitoli;

@end

@implementation DataManager

static DataManager *sharedClassInstance = nil;

+ (DataManager *)sharedClass {
    @synchronized(self) {
        if (!sharedClassInstance)
            sharedClassInstance = [[DataManager alloc] init];
        return sharedClassInstance;
    }
}

- (void)setupDM {
    UIImage * img1 = [UIImage imageNamed:@"Storia1.png"];
    UIImage * img2 = [UIImage imageNamed:@"Storia1.png"];

self.myArr = @[img1, img2];

    UIImage * button1 = [UIImage imageNamed:@"storia_1_button.png"];
    UIImage * button2 = [UIImage imageNamed:@"storia_2_button.png"];
    UIImage * button3 = [UIImage imageNamed:@"storia_3_button.png"];

    self.myArrTitoli = @[button1, button2, button3];

}

- (int)productsCount {
    return self.myArrTitoli.count;
}

- (UIImage*)imageForRow:(int)row {
    return self.myArr[row];
}

- (UIImage*)buttonForRow:(int)row {
    return self.myArrTitoli[row];
}

@end

</code> 
```

我有一个底部选择的表格视图。这是 Story 的 UiViewController。

```
#import "StoryViewController.h"

@interface StoryViewController ()
@property (strong, nonatomic) IBOutlet UIImageView *storyImage;

@end

@implementation StoryViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.storyImage.image = self.ponteImage;

    [scroller setScrollsToTop:NO];
    [scroller setContentSize:CGSizeMake(320, 10000)];

}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end 
```

但是这种方法行不通。

你能帮助我吗？如果有 10000 像素或 8000 或 6000 像素的图像，我想要一个自动滚动视图。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:18:03.777

1.  Check if you have connect your IBOutlet

2.  To scroll to define position use:

    [self.scrollView setContentOffset:CGPointMake(positionX, 0)];

# c# - 性能差异......如此戏剧性？

> ID：13211277
> 
> 赞同：60
> 
> 时间：2012-11-03T16:48:59.230
> 
> 标签：c#, .net, data-structures, collections

刚才我读了一些关于[vs的](https://stackoverflow.com/questions/169973/when-should-i-use-a-list-vs-a-linkedlist)[帖子`List<T>``LinkedList<T>`](https://stackoverflow.com/questions/169973/when-should-i-use-a-list-vs-a-linkedlist)，所以我决定自己对一些结构进行基准测试。我通过在前端/后端添加数据和删除数据来对、 和`Stack<T>`进行`Queue<T>`基准测试。这是基准测试结果：`List<T>``LinkedList<T>`

```
 Pushing to Stack...  Time used:      7067 ticks
              Poping from Stack...  Time used:      2508 ticks

               Enqueue to Queue...  Time used:      7509 ticks
             Dequeue from Queue...  Time used:      2973 ticks

    Insert to List at the front...  Time used:   5211897 ticks
RemoveAt from List at the front...  Time used:   5198380 ticks

         Add to List at the end...  Time used:      5691 ticks
  RemoveAt from List at the end...  Time used:      3484 ticks

         AddFirst to LinkedList...  Time used:     14057 ticks
    RemoveFirst from LinkedList...  Time used:      5132 ticks

          AddLast to LinkedList...  Time used:      9294 ticks
     RemoveLast from LinkedList...  Time used:      4414 ticks 
```

代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Diagnostics;

namespace Benchmarking
{
    static class Collections
    {
        public static void run()
        {
            Random rand = new Random();
            Stopwatch sw = new Stopwatch();
            Stack<int> stack = new Stack<int>();
            Queue<int> queue = new Queue<int>();
            List<int> list1 = new List<int>();
            List<int> list2 = new List<int>();
            LinkedList<int> linkedlist1 = new LinkedList<int>();
            LinkedList<int> linkedlist2 = new LinkedList<int>();
            int dummy;

            sw.Reset();
            Console.Write("{0,40}", "Pushing to Stack...");
            sw.Start();
            for (int i = 0; i < 100000; i++)
            {
                stack.Push(rand.Next());
            }
            sw.Stop();
            Console.WriteLine("  Time used: {0,9} ticks", sw.ElapsedTicks);
            sw.Reset();
            Console.Write("{0,40}", "Poping from Stack...");
            sw.Start();
            for (int i = 0; i < 100000; i++)
            {
                dummy = stack.Pop();
                dummy++;
            }
            sw.Stop();
            Console.WriteLine("  Time used: {0,9} ticks\n", sw.ElapsedTicks);

            sw.Reset();
            Console.Write("{0,40}", "Enqueue to Queue...");
            sw.Start();
            for (int i = 0; i < 100000; i++)
            {
                queue.Enqueue(rand.Next());
            }
            sw.Stop();
            Console.WriteLine("  Time used: {0,9} ticks", sw.ElapsedTicks);
            sw.Reset();
            Console.Write("{0,40}", "Dequeue from Queue...");
            sw.Start();
            for (int i = 0; i < 100000; i++)
            {
                dummy = queue.Dequeue();
                dummy++;
            }
            sw.Stop();
            Console.WriteLine("  Time used: {0,9} ticks\n", sw.ElapsedTicks);

            sw.Reset();
            Console.Write("{0,40}", "Insert to List at the front...");
            sw.Start();
            for (int i = 0; i < 100000; i++)
            {
                list1.Insert(0, rand.Next());
            }
            sw.Stop();
            Console.WriteLine("  Time used: {0,9} ticks", sw.ElapsedTicks);
            sw.Reset();
            Console.Write("{0,40}", "RemoveAt from List at the front...");
            sw.Start();
            for (int i = 0; i < 100000; i++)
            {
                dummy = list1[0];
                list1.RemoveAt(0);
                dummy++;
            }
            sw.Stop();
            Console.WriteLine("  Time used: {0,9} ticks\n", sw.ElapsedTicks);

            sw.Reset();
            Console.Write("{0,40}", "Add to List at the end...");
            sw.Start();
            for (int i = 0; i < 100000; i++)
            {
                list2.Add(rand.Next());
            }
            sw.Stop();
            Console.WriteLine("  Time used: {0,9} ticks", sw.ElapsedTicks);
            sw.Reset();
            Console.Write("{0,40}", "RemoveAt from List at the end...");
            sw.Start();
            for (int i = 0; i < 100000; i++)
            {
                dummy = list2[list2.Count - 1];
                list2.RemoveAt(list2.Count - 1);
                dummy++;
            }
            sw.Stop();
            Console.WriteLine("  Time used: {0,9} ticks\n", sw.ElapsedTicks);

            sw.Reset();
            Console.Write("{0,40}", "AddFirst to LinkedList...");
            sw.Start();
            for (int i = 0; i < 100000; i++)
            {
                linkedlist1.AddFirst(rand.Next());
            }
            sw.Stop();
            Console.WriteLine("  Time used: {0,9} ticks", sw.ElapsedTicks);
            sw.Reset();
            Console.Write("{0,40}", "RemoveFirst from LinkedList...");
            sw.Start();
            for (int i = 0; i < 100000; i++)
            {
                dummy = linkedlist1.First.Value;
                linkedlist1.RemoveFirst();
                dummy++;
            }
            sw.Stop();
            Console.WriteLine("  Time used: {0,9} ticks\n", sw.ElapsedTicks);

            sw.Reset();
            Console.Write("{0,40}", "AddLast to LinkedList...");
            sw.Start();
            for (int i = 0; i < 100000; i++)
            {
                linkedlist2.AddLast(rand.Next());
            }
            sw.Stop();
            Console.WriteLine("  Time used: {0,9} ticks", sw.ElapsedTicks);
            sw.Reset();
            Console.Write("{0,40}", "RemoveLast from LinkedList...");
            sw.Start();
            for (int i = 0; i < 100000; i++)
            {
                dummy = linkedlist2.Last.Value;
                linkedlist2.RemoveLast();
                dummy++;
            }
            sw.Stop();
            Console.WriteLine("  Time used: {0,9} ticks\n", sw.ElapsedTicks);
        }
    }
} 
```

差异**如此**戏剧性！

如您所见，`Stack<T>`and的性能`Queue<T>`快速且具有可比性，这是意料之中的。

因为`List<T>`，使用前端和后端有很大的不同！令我惊讶的是，从末尾添加/删除的性能实际上与`Stack<T>`.

因为`LinkedList<T>`, 用前面的操作很快（-er 比`List<T>`）~~，但到最后，用结尾的操作也非常慢~~。

* * *

所以......任何专家都可以解释：

1.  使用`Stack<T>`和结束的性能相似`List<T>`，
2.  使用前面和结尾的区别`List<T>`，以及
~~*   ~~使用 end 如此缓慢的原因`LinkedList<T>`（不适用*，*~~因为使用 Linq 导致的编码错误`Last()`，**感谢 CodesInChaos**）？~~

 ~~我想我知道为什么`List<T>`不能很好地处理前面......因为`List<T>`这样做时需要来回移动整个列表。如果我错了，请纠正我。

PS My`System.Diagnostics.Stopwatch.Frequency`是`2435947`，该程序针对 .NET 4 Client Profile 并在 Windows 7 Visual Studio 2010 上使用 C# 4.0 编译。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-11-03T17:11:16.577

**关于1：**

`Stack<T>`'s 和`List<T>`'s 的表现相似并不奇怪。我希望他们俩都使用具有加倍策略的数组。这导致摊销的恒定时间增加。

您可以在任何可以使用的`List<T>`地方使用`Stack<T>`，但这[会导致代码表现力较差](https://stackoverflow.com/questions/12466989/why-would-one-use-stackt-instead-of-listt)。

**关于2：**

> 我想我知道为什么`List<T>`不能很好地处理前面......因为`List<T>`这样做时需要来回移动整个列表。

这是正确的。在开头插入/删除元素是昂贵的，因为它会移动所有元素。另一方面，在开始时获取或替换元素很便宜。

**关于3：**

你的慢`LinkedList<T>.RemoveLast`值是你的基准代码中的一个错误。

删除或获取双向链表的最后一项很便宜。在这种情况下，`LinkedList<T>`这意味着`RemoveLast`并且`Last`很便宜。

但是您没有使用该`Last`属性，而是使用 LINQ 的扩展方法`Last()`。在没有实现`IList<T>`它的集合上，它迭代整个列表，给它`O(n)`运行时间。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-03T17:06:20.757

`List<T>`是一个[动态的过度分配数组](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx#remarksToggle)（在许多其他语言的标准库中也可以看到这种数据结构）。这意味着它在内部使用了一个“静态”数组（一个无法调整大小的数组，在 .NET 中称为“数组”），它可能并且通常大于列表的大小。然后追加简单地增加一个计数器并使用内部数组的下一个以前未使用的插槽。如果内部数组变得很小以容纳所有项目，则仅重新分配数组（这需要复制所有元素）。发生这种情况时，数组的大小会增加一个因子（不是常数），通常是 2。

这确保了即使在最坏的情况下，用于追加的*分摊*时间复杂度（基本上，每个操作在长操作序列中的平均时间）也是 O(1)。对于在前面添加，没有这样的优化是可行的（至少在同时保持随机访问和 O(1) 附加在末尾时不可行）。它总是必须复制所有元素以将它们移动到新的插槽中（为第一个插槽中添加的元素腾出空间）。`Stack<T>` [做同样的事情](http://msdn.microsoft.com/en-us/library/3278tedw.aspx#remarksToggle)，你只是没有注意到添加到前面的差异，因为你只在一端操作（快速的一端）。

~~获取链表的结尾在很大程度上取决于列表的内部结构。*可以*维护对最后一个元素的引用，但这会使列表上的所有操作更加复杂，并且可能（我手头没有示例）会使某些操作变得更加昂贵。缺少这样的引用，追加到末尾需要遍历链表的*所有元素以找到最后一个节点，这对于非平凡大小的列表来说当然非常慢。*~~

正如@CodesInChaos 所指出的，您的链表操作存在缺陷。如上所述，您现在看到的结尾的快速检索很可能是由`LinkedList<T>`显式维护对最后一个节点的引用引起的。请注意，获取不在任一端的元素仍然很慢。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-03T17:03:47.857

速度主要来自插入、删除或搜索项目所需的操作数量。您已经注意到，该列表需要内存传输。

堆栈是一个列表，只能在顶部元素访问——计算机总是知道它在哪里。

链表是另一回事：列表的开头是已知的，因此从开头添加或删除非常快——但找到最后一个元素需要时间。缓存最后一个元素OTOH的位置只值得添加。对于删除，需要遍历完整列表减去一个元素以找到“钩子”或指向最后一个元素的指针。

只看数字，就可以对每种数据结构的内部进行一些有根据的猜测：

*   正如预期的那样，从堆栈中弹出很快
*   推入堆栈速度较慢。它比添加到列表末尾要慢。为什么？
    *   显然，堆栈的分配单元大小更小——它可能只会将堆栈大小增加 100，而列表的增长可以以 1000 为单位完成。
*   列表似乎是一个静态数组。访问前面的列表需要内存传输，这需要与列表长度成比例的时间。
*   基本的链表操作不应该花那么多时间，通常只需要
    *   new_item.next = list_start; list_start = new_item; // 加上
    *   list_start = list_start.next；// 去除
    *   但是，由于 addLast 非常快，这意味着在添加或删除链表时，也必须更新指向最后一个元素的指针。所以有额外的簿记。
*   双向链表 OTOH 使得在列表两端插入和删除的速度相对较快（我被告知更好的代码使用 DLL），但是，
    *   上一个和下一个项目的链接也使簿记工作加倍

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-03T17:03:31.157

我有 Java 背景，我想您的问题更多地与一般数据结构有关，而不是与特定语言有关。另外，如果我的陈述不正确，我深表歉意。

**1\. 使用 Stack 和 List 结尾在性能上的相似性**

**2\. List 前后使用的区别，以及**

至少在 Java 中，堆栈是使用**数组**实现的（如果 C# 不是这种情况，请致歉。您可以参考实现的源代码）列表也是如此。典型的数组，末尾的所有插入都比开头花费的时间更少，因为数组中预先存在的值需要向下移动以适应开头的插入。

[链接到 Stack.java 源代码](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/Stack.java)及其超类[Vector](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/Vector.java#Vector)

**3\. 使用LinkedList的末尾这么慢的原因是什么？**

LinkedList**不允许随机访问**，并且必须在到达插入点之前遍历节点。如果您发现最后一个节点的性能较慢，那么我认为 LinkedList 实现应该是一个**单链表**。我猜你会想在最后访问元素时考虑一个双向链表以获得最佳性能。

[http://en.wikipedia.org/wiki/Linked_list](http://en.wikipedia.org/wiki/Linked_list)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-03T17:24:53.243

> 使用 Stack 和 List 结尾在性能上的相似性，

正如 delnan 所解释的，它们都在内部使用了一个简单的数组，因此它们在最后工作时的行为非常相似。您可以看到一个堆栈是一个仅访问最后一个对象的列表。

> List 前后使用的区别

你已经猜对了。操作列表的开头意味着需要更改底层数组。添加项目通常意味着您需要将所有其他元素移动一个，与删除相同。如果您知道您将操作列表的两端，则最好使用链表。

> 使用 LinkedList 的末尾这么慢的原因是什么？

通常，链表在任意位置的元素插入和删除都可以在恒定时间内完成，因为您最多只需要更改两个指针。问题只是到了这个位置。一个普通的链表只有一个指向它的第一个元素的指针。因此，如果要到达最后一个元素，则需要遍历所有元素。用链表实现的队列通常通过有一个指向最后一个元素的附加指针来解决这个问题，因此也可以在恒定时间内添加元素。更复杂的数据结构将是一个双链表，它具有指向第一个*和最后一个*元素的指针，并且每个元素还包含指向下一个*和前一个*元素的指针。

您应该了解的是，有许多不同的数据结构是为单一目的而设计的，它们可以非常有效地处理这些数据结构。选择正确的结构很大程度上取决于您想要做什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-06T07:37:42.263

只是改进了之前代码的一些不足，特别是Random和dummy计算的影响。Array 仍然居于首位，但 List 的性能令人印象深刻，而且 LinkedList 非常适合随机插入。

排序后的结果是：

```
12      array[i]
40      list2[i]
62      FillArray
68      list2.RemoveAt
78      stack.Pop
126     list2.Add
127     queue.Dequeue
159     stack.Push
161     foreach_linkedlist1
191     queue.Enqueue
218     linkedlist1.RemoveFirst
219     linkedlist2.RemoveLast
2470        linkedlist2.AddLast
2940        linkedlist1.AddFirst 
```

代码是：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
//
namespace Benchmarking {
    //
    static class Collections {
        //
        public static void Main() {
            const int limit = 9000000;
            Stopwatch sw = new Stopwatch();
            Stack<int> stack = new Stack<int>();
            Queue<int> queue = new Queue<int>();
            List<int> list1 = new List<int>();
            List<int> list2 = new List<int>();
            LinkedList<int> linkedlist1 = new LinkedList<int>();
            LinkedList<int> linkedlist2 = new LinkedList<int>();
            int dummy;

            sw.Reset();
            Console.Write( "{0,40}  ", "stack.Push");
            sw.Start();
            for ( int i = 0; i < limit; i++ ) {
                stack.Push( i );
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );
            sw.Reset();
            Console.Write( "{0,40}  ", "stack.Pop" );
            sw.Start();
            for ( int i = 0; i < limit; i++ ) {
                stack.Pop();
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );

            sw.Reset();
            Console.Write( "{0,40}  ", "queue.Enqueue" );
            sw.Start();
            for ( int i = 0; i < limit; i++ ) {
                queue.Enqueue( i );
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );
            sw.Reset();
            Console.Write( "{0,40}  ", "queue.Dequeue" );
            sw.Start();
            for ( int i = 0; i < limit; i++ ) {
                queue.Dequeue();
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );

            //sw.Reset();
            //Console.Write( "{0,40}  ", "Insert to List at the front..." );
            //sw.Start();
            //for ( int i = 0; i < limit; i++ ) {
            //  list1.Insert( 0, i );
            //}
            //sw.Stop();
            //Console.WriteLine( sw.ElapsedMilliseconds.ToString() );
            //
            //sw.Reset();
            //Console.Write( "{0,40}  ", "RemoveAt from List at the front..." );
            //sw.Start();
            //for ( int i = 0; i < limit; i++ ) {
            //  dummy = list1[ 0 ];
            //  list1.RemoveAt( 0 );
            //  dummy++;
            //}
            //sw.Stop();
            //Console.WriteLine( sw.ElapsedMilliseconds.ToString() );

            sw.Reset();
            Console.Write( "{0,40}  ", "list2.Add" );
            sw.Start();
            for ( int i = 0; i < limit; i++ ) {
                list2.Add( i );
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );
            sw.Reset();
            Console.Write( "{0,40}  ", "list2.RemoveAt" );
            sw.Start();
            for ( int i = 0; i < limit; i++ ) {
                list2.RemoveAt( list2.Count - 1 );
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );

            sw.Reset();
            Console.Write( "{0,40}  ", "linkedlist1.AddFirst" );
            sw.Start();
            for ( int i = 0; i < limit; i++ ) {
                linkedlist1.AddFirst( i );
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );
            sw.Reset();
            Console.Write( "{0,40}  ", "linkedlist1.RemoveFirst" );
            sw.Start();
            for ( int i = 0; i < limit; i++ ) {
                linkedlist1.RemoveFirst();
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );

            sw.Reset();
            Console.Write( "{0,40}  ", "linkedlist2.AddLast" );
            sw.Start();
            for ( int i = 0; i < limit; i++ ) {
                linkedlist2.AddLast( i );
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );
            sw.Reset();
            Console.Write( "{0,40}  ", "linkedlist2.RemoveLast" );
            sw.Start();
            for ( int i = 0; i < limit; i++ ) {
                linkedlist2.RemoveLast();
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );

            // Fill again
            for ( int i = 0; i < limit; i++ ) {
                list2.Add( i );
            }
            sw.Reset();
            Console.Write( "{0,40}  ", "list2[i]" );
            sw.Start();
            for ( int i = 0; i < limit; i++ ) {
                dummy = list2[ i ];
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );

            // Fill array
            sw.Reset();
            Console.Write( "{0,40}  ", "FillArray" );
            sw.Start();
            var array = new int[ limit ];
            for ( int i = 0; i < limit; i++ ) {
                array[ i ] = i;
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );

            sw.Reset();
            Console.Write( "{0,40}  ", "array[i]" );
            sw.Start();
            for ( int i = 0; i < limit; i++ ) {
                dummy = array[ i ];
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );

            // Fill again
            for ( int i = 0; i < limit; i++ ) {
                linkedlist1.AddFirst( i );
            }
            sw.Reset();
            Console.Write( "{0,40}  ", "foreach_linkedlist1" );
            sw.Start();
            foreach ( var item in linkedlist1 ) {
                dummy = item;
            }
            sw.Stop();
            Console.WriteLine( sw.ElapsedMilliseconds.ToString() );

            //
            Console.WriteLine( "Press Enter to end." );
            Console.ReadLine();
        }
    }
} 
```~~

# php - 使用 PHP 和 MySQL - 需要良好且安全的 OO 设计

> ID：13211281
> 
> 赞同：0
> 
> 时间：2012-11-03T16:49:19.090
> 
> 标签：php, mysql, optimization

我是 PHP 新手-> 第一次开发人员。我正在开发我的 Web 应用程序，它几乎完成了；尽管如此，我的大部分 sql 都是通过使用直接 mysql 请求的代码直接完成的。这是我接近它的方式：

在**classes_db.php 中**，我声明了数据库设置并创建了用于打开和关闭数据库连接的方法。我在常规页面上声明了这些对象：

```
class classes_db {

    public $dbserver = 'server;
    public $dbusername = 'user';
    public $dbpassword = 'pass';
    public $dbname = 'db';

    function openDb() {
        $dbhandle = mysql_connect($this->dbserver, $this->dbusername, $this->dbpassword);
        if (!$dbhandle) {
            die('Could not connect: ' . mysql_error());
        }
        $selected = mysql_select_db($this->dbname, $dbhandle)
                or die("Could not select the database");

        return $dbhandle;
    }

    function closeDb($con) {
        mysql_close($con);
    }
} 
```

在我的常规页面上，我这样做：

```
<?php
require 'classes_db.php';
session_start();

//create instance of the DB class
$db = new classes_db();

//get dbhandle
$dbhandle = $db->openDb();

//process query
$result = mysql_query("update user set username = '" . $usernameFromForm . "' where iduser= " . $_SESSION['user']->iduser);

//close the connection
if (isset($dbhandle)) {
    $db->closeDb($dbhandle);
}

?> 
```

我的问题是：如何正确地做到这一点并使其 OO 和安全？我知道我需要合并准备好的查询->如何以最好的方式做到这一点？请提供一些代码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:00:13.973

停止使用 mysql_* ，改用 mysqli和**PDO**

[PHP PDO 与普通 mysql_connect](https://stackoverflow.com/questions/1402017/php-pdo-vs-normal-mysql-connect)

> mysql_* 函数正在变旧。很长一段时间以来，mysql_* 一直与其他常见的 SQL 数据库编程接口不一致。它不支持现代 SQL 数据库概念，例如准备好的语句、存储的过程、事务等。它使用 mysql_real_escape_string 转义参数并连接到 SQL 字符串的方法容易出错且过时。mysql_* 的另一个问题是它最近缺乏开发人员的关注，它没有得到维护......这可能意味着安全漏洞等问题没有得到修复，或者它可能完全停止与新版本的 MySQL 一起工作. 最近 PHP 社区也认为适合开始软弃用 mysql_* 这意味着您将开始看到最终从语言中完全删除 mysql_* 函数的缓慢过程（Don'
> 
> PDO 有一个更好的界面，你最终会变得更有效率，并编写更安全、更干净的代码。PDO 还为不同的 SQL 数据库供应商提供不同的驱动程序，这将允许您轻松使用其他供应商，而无需重新学习不同的界面。（尽管您可能必须学习稍微不同的 SQL）。不是将转义字符串连接到 SQL 中，而是在 PDO 中绑定参数，这是一种更简单、更简洁的保护查询的方法。当使用稍微不同的参数多次调用相同的 SQL 查询时，绑定参数还可以提高性能。PDO 也有多种错误处理方法。我在 mysql_* 代码中看到的最大问题是它缺乏一致的处理，或者根本没有处理！当 PDO 处于异常模式时，
> 
> 现在在 PHP 安装中默认启用 PDO，但是您需要两个扩展才能使用 PDO：PDO 和您要使用的数据库的驱动程序，如 pdo_mysql。安装 MySQL 驱动程序就像在大多数发行版中安装 php-mysql 包一样简单。

[http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T16:57:38.447

我强烈推荐 RedBeanPHP。它是一个非常可靠的 MySQL 数据库库，它抽象出数据库交互的所有连接、查询、清理、准备、使用 PDO 等（考虑到您是 PHP 开发的新手，这对您来说非常有用）。

在这里查看：[http ://redbeanphp.com/](http://redbeanphp.com/)

建立连接是多么容易的一个例子：

```
require('rb.php');
R::setup('mysql:host=localhost; dbname=mydatabase','user','password'); 
```

设置 RedBeanPHP：[http: //redbeanphp.com/manual/setup](http://redbeanphp.com/manual/setup)

当创建一个类来处理你的数据库对象时，你会想要使用一个接口和/或一个抽象类来设置某些对象行为规则（想想 CRUD ......）。

您需要做的就是将该数据库连接包含在一个通用文件中，将其包含在您的所有 PHP 脚本中，然后一切就绪。

# jquery - CSS3渐变jQuery滑块

> ID：13211295
> 
> 赞同：0
> 
> 时间：2012-11-03T16:51:06.380
> 
> 标签：jquery, html, css, slider

![滑块](../Images/306c977cffe8251ee145b96f443ad36d.png)

使它成为 jQuery 滑块的最聪明的方法是什么？我不确切知道如何在左侧和右侧进行渐变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:07:11.817

这个[LINK](http://gradients.glrzad.com/)可以帮助你处理渐变。容器应该具有渐变样式，而不是元素。因此，您可以轻松地在该容器中制作滑块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:34:32.033

您可以这样做，使用一个`div`带有两个 child`div`的容器：一个用于图像，一个用于渐变。对于滑动，您可以使用 jQuery为 image`div`的属性设置动画。`left`

[http://jsfiddle.net/SSNmT/2/](http://jsfiddle.net/SSNmT/2/)

未在 Opera 上测试，但适用于 Chrome 和 Firefox。

# facebook - 通过 fql 获得 1500 个状态

> ID：13211297
> 
> 赞同：1
> 
> 时间：2012-11-03T16:51:15.287
> 
> 标签：facebook, facebook-fql

我正在尝试在获得某些 facebook 用户许可的情况下获取他们的所有状态更新。我使用的代码是

```
//gets statusid, message and uid of the user
function get_status_message($access_token){
    // Run fql query
  $fql_query_url = 'https://graph.facebook.com/'
    . '/fql?q=SELECT+message+,+status_id+,+uid+FROM+status+WHERE+uid=me()AND+time+>=946684800'
    . '&access_token=' . $access_token;
  $fql_query_result = file_get_contents($fql_query_url);
  $fql_query_obj = json_decode($fql_query_result, true);

  //display results of fql query
  echo '<pre>';
  print_r("query results:");
  print_r($fql_query_obj);
  echo '</pre>';
  return $fql_query_obj;
} 
```

我已设置时间来查看 2000 年 1 月 1 日之后的所有状态，但我只收到 100 条状态消息。我试图将时间限制更改为 01/01/2009 和 01/01/2010 之间。同样，只有当它们落在最后 100 条消息中时，我才会收到这些消息。是否有任何解决方法。我阅读了多篇关于增加限制的帖子，我已经尝试过了，但它不起作用

# django - django-tables2 链接列外部网址

> ID：13211301
> 
> 赞同：4
> 
> 时间：2012-11-03T16:51:44.710
> 
> 标签：django, django-tables2

我有 2 个模型属性 - model.name 和 model.url 我需要创建一个 linkColumn 列名 = model.name 并链接到 model.url 中指定的 url

有可能实现这样的事情吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-14T07:02:25.730

您可以使用 TemplateColumn 来实现它。您的 tables.py 应该看起来像这样

```
# yourapp/tables.py
import django_tables2 as tables
from yourapp.models import yourmodel
class YourTable(tables.Table):
    name = tables.TemplateColumn('<a href="{{record.url}}">{{record.name}}</a>')
    class Meta:
        model = yourmodel
        fields = ('name') # fields to display 
```

您可以参考[DOC](http://django-tables2.readthedocs.org/en/latest/#django_tables2.columns.TemplateColumn)以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:21:28.563

I achieved it by creating a custom column that queries the database and renders the link from the given attributes

# objective-c - 如何使用 GKSession 从服务器向客户端发送请求？

> ID：13211312
> 
> 赞同：0
> 
> 时间：2012-11-03T16:52:38.853
> 
> 标签：objective-c, ios, gksession

我想知道如何使用 GKSession 从服务器向客户端发送请求？GKSession 的参考类说明如下：

```
- (void)connectToPeer:(NSString *)peerID withTimeout:(NSTimeInterval)timeout Parameters peerID The string that 
```

> 标识要连接的对等方。
> 
> timeout 在取消连接尝试之前等待的时间。
> 
> 讨论
> 
> 当您的应用程序充当客户端时，它会调用此方法来连接到它发现的可用对等点。当您的应用程序调用此方法时，会向远程对等方发送一个请求，由后者选择是接受还是拒绝连接请求。

如果我是服务器，我应该使用什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-27T09:54:40.850

作为服务器，您可以让自己与客户端连接

```
peer2peerSession.available = YES; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T07:09:48.343

以下是创建 GKSession 实例作为服务器的示例：

```
[[GKSession alloc] initWithSessionID:sessionID displayName:@"Chris" sessionMode : GKSessionModeServer]; 
```

以下是如何创建 GKSession 作为客户端的示例：

```
[[GKSession alloc] initWithSessionID:sessionID displayName:@"Angel" sessionMode : GKSessionModeClient]; 
```

GKSessionModePeer 将创建一个 GKSession 实例，该实例将自己宣传为服务器，同时寻找广告服务器（换句话说，充当客户端搜索服务器）。

然后，您需要为您的 GKSession 对象设置一个委托，之后委托需要实现以下委托方法：

```
- (void)session:(GKSession *)session peer:(NSString *)peerID didChangeState : (GKPeerConnectionState)state 
```

在上述方法中，您将从会话中收到有关设备已可用、不可用、已连接等的消息。

要发送请求：

```
[_session connectToPeer:peerID withTimeout:_session.disconnectTimeout]; 
```

接受请求：

```
[_session acceptConnectionFromPeer:peerID error:&error]; 
```

涉及大量代码，让您了解一切的最佳教程位于此处：[Simple Card Playing game using GKSession](http://www.raywenderlich.com/12735/how-to-make-a-simple-playing-card-game-with-multiplayer-and-bluetooth-part-1)

# asp.net-mvc - 使用 asp.net mvc 在视图中显示图像

> ID：13211314
> 
> 赞同：0
> 
> 时间：2012-11-03T16:53:06.237
> 
> 标签：asp.net-mvc, image, html-helper

我想使用 asp.net mvc 在视图中显示图像？我火腿从数据库中检索图像。

这是我的视图代码：

```
 <td>
        <%: Html.DisplayFor(modelItem => item.Product_img) %>
    </td> 
```

但是索引页面是这样的：

![在此处输入图像描述](../Images/77fc517cbf9eb4cb038138149f49d444.png)

如何显示图像？

# java - Swing 翻译库

> ID：13211318
> 
> 赞同：3
> 
> 时间：2012-11-03T16:53:55.113
> 
> 标签：java, swing, localization

我已经查看并找不到可以处理摆动组件数据的许可问题的库。

因此，我决定创建自己的并将其公开...

唯一的问题是我真的不知道语言字符串包含在哪里......

如果有人愿意告诉我在 src 文件夹中的位置，我会非常乐意创建一个可以像这样工作的库：

```
libraryClassName.JFileChooser.setJFileChooserStringValue(string); 
```

`Swing`在文件夹中提到`com/sun/java`，它也在`javax`文件夹中。有许多类包括每个组件的摆动组件的名称（`JFileChooser.java`、`FileChooserUI.java`、`BasicFileChooserUI.java`、`MetalFileChooserUI.java`、`MultiFileChooserUI.java`、`FileChooserPainter.java`等），还有许多更通用的类，它们可能包含也可能不包含本地化所需的字符串值。

我想，当找到一个组件的字符串值时，所有其他组件都应该在相应的位置。

所以，如果你能帮我解决这个问题，我会创建一个库来减轻这么多试图翻译他们的程序的程序员的痛苦......

**重要编辑：** JFileChooser 是唯一具有预定义字符串的 Swing 组件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:43:52.700

好的，我会尽量不偷懒，帮助你解决这个问题：

文件 /src/javax/swing/plaf/basic/BasicFileChooserUI.java 有一个名为 installStrings 的好方法（第 282 行），其中包含您所追求的内容：

```
protected void installStrings(JFileChooser fc) {

        Locale l = fc.getLocale();
        newFolderErrorText = UIManager.getString("FileChooser.newFolderErrorText",l);
        newFolderErrorSeparator = UIManager.getString("FileChooser.newFolderErrorSeparator",l);

        newFolderParentDoesntExistTitleText = UIManager.getString("FileChooser.newFolderParentDoesntExistTitleText", l);
        newFolderParentDoesntExistText = UIManager.getString("FileChooser.newFolderParentDoesntExistText", l);
// ...
} 
```

看来您实际需要找到的是对 的调用`UIManager.getString(String, Locale)`，它似乎包含您要查找的密钥。实际的方法定义可能会揭示更多的秘密，但我懒得去检查它；）

# google-apps-script - 多个用户使用电子表格而不覆盖内容

> ID：13211319
> 
> 赞同：2
> 
> 时间：2012-11-03T16:53:57.300
> 
> 标签：google-apps-script, google-sheets

我是新手，感谢对我的问题的帮助！

我的电子表格充当销售工具，在各个单元格中输入信息以运行敏感性分析。一旦销售人员选择了所需的选项，他们就会“提交”。然后将提交的数据存储在电子表格的单独工作表中（称为“数据库”）。

我希望数据库表存储所有用户提交的内容。问题是当多个用户同时使用销售工具工作表时，他们输入的信息会在提交之前被其他用户的输入覆盖。

我希望多个用户能够同时使用“销售工具”表而不会相互覆盖，但仍然能够将数据提交到“数据库”表。

欣赏想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T13:00:28.600

Can't you use a form? This way people could insert data without actually modify the spreadsheet...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T19:38:20.580

除了[Lock Service](https://developers.google.com/apps-script/service_lock)（Srik 已经提到）之外，还有[Sheet.appendRow](https://developers.google.com/apps-script/class_sheet#appendRow)函数，它更易于使用且速度更快。但仅当您将新数据插入工作表而不是真正写入相同的单元格时才有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T17:54:12.293

您可以使用[锁定服务](https://developers.google.com/apps-script/service_lock)对电子表格进行锁定，然后在写入后将其释放。

# java - 比较变量时前缀和后缀递增

> ID：13211320
> 
> 赞同：0
> 
> 时间：2012-11-03T16:53:59.640
> 
> 标签：java, if-statement, prefix, postfix-notation

有人可以解释为什么这个代码输出是

```
not equals
not equals 2 
```

在第一个 if 语句中，a = 0 b/c 似乎是一个后缀增量；因此 a 直到下一行才会增加；但是，两个a不相等，为什么？第二个如果我运行调试器时a的值为2，但测试为假，为什么？

```
public static void main (String[] args)
   {
       int a = 0;
       if (a++ == a++) {
           System.out.println("equals");
       } else {
           System.out.println("not equals");
       }

       if (++a == 2) {
           System.out.println("equals 2");
       } else {
           System.out.println("not equals 2");
       }

   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:03:14.703

并不是说它要等到下一行。这`==`是一个“逻辑”运算符，因此首先计算每一侧的表达式，每个表达式都有增加“a”值的副作用。LHS 使用第 1 个增量的结果，RHS 使用第 2 个增量的结果。

在这些情况下，运算符是“前缀”还是“后缀”并不重要

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T16:57:28.027

编辑：刚刚意识到您还要求第一个*不等于*，这只是回答了第二个。

因为

*   `a`已经`2`（已经增加了两次）
*   `++a`是`3`这样的
*   `3 == 2`是`false`因为在评估之前应用了前缀。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T16:57:43.850

a++(post increment) 将先增加 a 然后将其分配给变量。在你的第一种情况下

(a++==a++) 在第一个 post 增量中，一个值将首先增加 1 但尚未分配，但是当它到达第二个 a++ 时，现在分配了 a 值并且您正在再次增加它。

例如

```
if say a=0;

(a++==a++) would be (0==1) 
```

所以现在在评估`if`.

对于你的第二个案例

```
(++a==2) here a would be incremented to 3 , (3==2) which is false thus the else if executed 
```

# ios - 检查 Wi-Fi 是否可用但 iOS 上没有互联网

> ID：13211322
> 
> 赞同：1
> 
> 时间：2012-11-03T16:54:41.647
> 
> 标签：ios, nsurlconnection, reachability

我现在有一个非常奇怪的案例，我正在开发一个应用程序。我正在测试它的 Wi-Fi 网络没有启用互联网，但它仍然显示我在使用`Reachability`. 如何检查这种情况，以便告诉用户没有可用的连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:22:08.773

You need to use `reachabilityWithHostName` (I presume you are using `reachabilityForInternetConnection` or `reachabilityForLocalWiFi`) to check if you can reach a particular external hostname.

For example, this code will return YES if there is no internet connection:

```
Reachability *reachability = [Reachability reachabilityWithHostName:@"www.apple.com"];
if ([reachability currentReachabilityStatus] == NotReachable)
     return YES; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-11T01:50:05.403

定义“连接”，有几层连接是通过 Wi-Fi 获得正常互联网服务的关键：

*   第 1 层（物理链路）是否在范围内？
*   第 2 层 (MAC) 大部分见上文，但 MAC 地址冲突可能会导致问题
*   第 3 层 (IP) 我们是否从 DHCP/BOOTP 或静态配置中获得了 IP 地址？
*   第 3 层 (GW) 我们可以到达网关吗？
*   第 3 层 (ROUTE) 我们可以到达下一跳路由器吗？
*   第 7 层 (DNS) 我们可以访问 DNS 服务器吗？我们是被欺骗还是被迷住了？

一旦所有这些工作正常，你应该有“工作 Wi-Fi”

# java - 关于 ItemizedOverlay

> ID：13211326
> 
> 赞同：0
> 
> 时间：2012-11-03T16:54:48.750
> 
> 标签：java, android, google-maps, itemizedoverlay

MainActivity onCreate：

```
 List<Overlay> listOfOverlays = mapView.getOverlays();
    listOfOverlays.add(myItemizedOverlay); //List<OverlayItem> of myItemizedOverlay is empty 
```

稍后我在 myItemizedOverlay 中添加和删除项目。

当 myItemizedOverlay 列表为空并且我单击地图时，我会收到错误消息。

如何正确组织这个过程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:03:30.617

我曾经遇到过类似的问题，或者我认为。我允许用户保存他们的位置，我将位置保存到一个文件中。然后当他们查看地图时，我会加载文件的内容（位置）并使用叠加层在地图上显示项目。但是，如果没有项目并且按下地图，我会收到错误消息。

如果这也是您面临的问题，我通过放置一个简单的 if 语句解决了这个问题。

当我从文件中获取位置时，我会将每个位置放入一个数组列表中，因此，我使用了这个 if 语句：

```
if (!fileList.isEmpty()){} 
```

我放置了所有代码以在此 if 语句中添加叠加层。我希望这有帮助！

# javascript - 最小的谷歌地理编码器不返回任何结果

> ID：13211327
> 
> 赞同：0
> 
> 时间：2012-11-03T16:54:54.023
> 
> 标签：javascript, google-maps, google-maps-api-3, geocode

**前言：** *我已经联系了谷歌并阅读了文档。完成后，它会在下一页显示地图并在第一页自动提示 - 我不会以这种方式违反条款和条件，所以请不要开始火焰战*

我已着手尝试创建自己的最小地理编码器，该地理编码器无需在当前页面上显示地图即可进行地理编码。我发现网上没有这样做的示例代码！我是 jquery 的新手，但这是我能想到的最好的。但是，低并且看它不起作用。

我确信我做了一些愚蠢的事情，所以如果有人能告诉我他们是否发现任何明显的原因导致这不起作用，我将不胜感激。我以前从未制作过javascript。

JSFiddle 链接：http: [//jsfiddle.net/njDvn/9/](http://jsfiddle.net/njDvn/9/)

```
<html>
<head>
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
<script>
function getLatLng() {
    var geocoder = new google.maps.Geocoder();
    var address = document.getElementById('address').value;
    geocoder.geocode({
        'address': address
    }, function (results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            var latLng = results[0].geometry.location;
            $('#lat').val(results[0].geometry.location.lat());
            $('#lng').val(results[0].geometry.location.lng());
        } else {
            alert("Geocode was not successful for the following reason: " + status);
        }
    });
}
</script>
</head>
    <body onload="initialize()">
        <div>
            <input id="address" type="textbox" value="Sydney, NSW">
            <input type="button" value="Geocode" onclick="codeAddress()">
            <input id="lat" type="textbox" value="lat">
            <input id="lng" type="textbox" value="lng">
           </div>
      </body>
</html> 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:01:12.720

好吧，我可以看到的前两件事是`onclick`该按钮正在调用`codeAddress()`，但是您尚未声明该功能-您可以将其更改为，`getLatLng()`然后它应该可以工作。加上也没有声明的`<body onload`正在调用。`initialize()`虽然这不应阻止地理编码器触发，但您可能应该修复它。

# google-chrome - 在 Chrome 扩展的标签页上找不到 id

> ID：13211331
> 
> 赞同：0
> 
> 时间：2012-11-03T16:55:29.553
> 
> 标签：google-chrome, google-chrome-extension

我正在创建我的第一个 chrome 扩展。我的目标很简单，在某个网页上，我想隐藏一个 id 为 someid 的元素。我已经创建了一个背景页面，它现在选择 id 为 someid 的元素并在屏幕上提醒它。问题是，ele 的值为空。试过 $("#someid").hide(); 同样，没有运气。

与选项卡中的 DOM 交互需要做一些特别的事情吗？我提醒 tab.url 并显示正确的 url。

```
<html>
 <head>
   <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
   <script src="http://code.jquery.com/mobile/1.0a4/jquery.mobile-1.0a4.min.js"></script>
   <script>
     $(document).ready(function(){
        chrome.tabs.onUpdated.addListener(function(tabId, changeInfo, tab){
        if(changeInfo.status == "complete")
          {
           if(tab.url.indexOf("somedomain.com") > -1)
            {
              chrome.tabs.getSelected(null, function(tab){
              var tabUrl = tab.url;
              chrome.tabs.executeScript(tab.id, {file: "background.js"},function({       
                       var ele = document.getElementById("someid");
                       alert(ele);
                                 });
              });

            }
          }
        });
      });
      </script>
    </head>
    <body></body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T00:00:45.457

正如斯坦所指出的，问题在于不恰当的上下文。我使用了内容脚本并解决了问题。谢谢！

# sas - SAS Proc Gchart 堆积面积图

> ID：13211333
> 
> 赞同：3
> 
> 时间：2012-11-03T16:56:25.200
> 
> 标签：sas, proc, stacked-area-chart

嗨，我在 SAS 中创建图表时遇到问题。我的数据如下：日期，comp_1，comp_2，comp_3，total_value。我的数据按日期排序。变量 comp_ 代表公司在特定数据下的价值。这是我目前的代码：

```
proc gplot data=dev2.Actionfinal2;
    plot (comp_1 comp_2 comp_3)*date 
         / overlay areas=3 vaxis=0 to 100000 by 20000;
    symbol1 i=join v= cv= ci=red;
    symbol2 i=join v= cv= ci=blue;
    symbol3 i=join v= cv= ci=green;
run; 
quit; 
```

这张图显示了 3 家公司的价值叠加，但我希望它们堆叠起来，这样我就可以看到每个日期公司的总价值。我需要重新格式化我的数据，我可以使用什么选项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T17:14:43.683

您将需要使用三个“comp”变量的聚合值创建一个新变量。请参阅[此 SAS 使用说明](http://support.sas.com/kb/42/556.html)，其中包含一个很好的示例。这应该让您开始并欢迎使用 StackOverflow！

**更新：**我想我更好地理解了这个问题：您需要对数据进行非规范化（将列转换为观察值）。所以试试这个：

```
data test(keep=company value date);
  set dev2.Actionfinal2;
  company = 1; value = comp_1; output;
  company = 2; value = comp_2; output;
  company = 3; value = comp_3; output;
run;

proc sort data=test;
   by date company;
run;

data test2;
   set test;
      by date;
   if first.date then new_y=0;
   new_y + value;
run;

symbol1 i=join v= cv= ci=red;
symbol2 i=join v= cv= ci=blue;
symbol3 i=join v= cv= ci=green;

proc gplot data=test2;
    plot new_y*date=company 
         / areas=3 vaxis=0 to 100000 by 20000;
run; 
quit; 
```

# c# - 如何在 C# 中等到 Task 完成？

> ID：13211334
> 
> 赞同：49
> 
> 时间：2012-11-03T16:56:30.503
> 
> 标签：c#, .net, task, task-parallel-library, wait

我想向服务器发送请求并处理返回值：

```
private static string Send(int id)
{
    Task<HttpResponseMessage> responseTask = client.GetAsync("aaaaa");
    string result = string.Empty;
    responseTask.ContinueWith(x => result = Print(x));
    responseTask.Wait(); // it doesn't wait for the completion of the response task
    return result;
}

private static string Print(Task<HttpResponseMessage> httpTask)
{
    Task<string> task = httpTask.Result.Content.ReadAsStringAsync();
    string result = string.Empty;
    task.ContinueWith(t =>
    {
        Console.WriteLine("Result: " + t.Result);
        result = t.Result;
    });
    task.Wait();  // it does wait
    return result;
} 
```

我使用`Task`正确吗？我不这么认为，因为该`Send()`方法`string.Empty`每次都返回，而`Print`返回正确的值。

我究竟做错了什么？如何从服务器获得正确的结果？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-11-03T17:21:14.853

您的 Print 方法可能需要等待继续完成（ContinueWith 返回一个您可以等待的任务）。否则，第二个 ReadAsStringAsync 完成，该方法返回（在继续分配结果之前）。您的发送方法中也存在同样的问题。两者都需要等待继续才能始终如一地获得您想要的结果。类似于下面

```
private static string Send(int id)
{
    Task<HttpResponseMessage> responseTask = client.GetAsync("aaaaa");
    string result = string.Empty;
    Task continuation = responseTask.ContinueWith(x => result = Print(x));
    continuation.Wait();
    return result;
}

private static string Print(Task<HttpResponseMessage> httpTask)
{
    Task<string> task = httpTask.Result.Content.ReadAsStringAsync();
    string result = string.Empty;
    Task continuation = task.ContinueWith(t =>
    {
        Console.WriteLine("Result: " + t.Result);
        result = t.Result;
    });
    continuation.Wait();  
    return result;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-03T17:05:53.803

它等待`client.GetAsync("aaaaa");`，但不等待`result = Print(x)`

尝试`responseTask.ContinueWith(x => result = Print(x)).Wait()`

- 编辑 -

```
Task responseTask = Task.Run(() => { 
    Thread.Sleep(1000); 
    Console.WriteLine("In task"); 
});
responseTask.ContinueWith(t=>Console.WriteLine("In ContinueWith"));
responseTask.Wait();
Console.WriteLine("End"); 
```

上面的代码不保证输出：

```
In task
In ContinueWith
End 
```

但这确实（参见`newTask`）

```
Task responseTask = Task.Run(() => { 
    Thread.Sleep(1000); 
    Console.WriteLine("In task"); 
});
Task newTask = responseTask.ContinueWith(t=>Console.WriteLine("In ContinueWith"));
newTask.Wait();
Console.WriteLine("End"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-10-06T07:44:31.960

一个回答标题的干净示例

```
string output = "Error";
Task task = Task.Factory.StartNew(() =>
{
    System.Threading.Thread.Sleep(2000);
    output = "Complete";
});

task.Wait();
Console.WriteLine(output); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T17:24:14.050

我是一个异步新手，所以我不能明确地告诉你这里发生了什么。我怀疑方法执行期望不匹配，即使您在方法内部使用任务。如果您将 Print 更改为返回 Task<string>，我认为您会得到预期的结果：

```
private static string Send(int id)
{
    Task<HttpResponseMessage> responseTask = client.GetAsync("aaaaa");
    Task<string> result;
    responseTask.ContinueWith(x => result = Print(x));
    result.Wait();
    responseTask.Wait(); // There's likely a better way to wait for both tasks without doing it in this awkward, consecutive way.
    return result.Result;
}

private static Task<string> Print(Task<HttpResponseMessage> httpTask)
{
    Task<string> task = httpTask.Result.Content.ReadAsStringAsync();
    string result = string.Empty;
    task.ContinueWith(t =>
    {
        Console.WriteLine("Result: " + t.Result);
        result = t.Result;
    });
    return task;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-05T01:53:07.500

在处理延续时，我发现将我编写 .ContinueWith 的地方视为执行立即继续到其后的语句的地方很有用，而不是它“内部”的语句。在这种情况下，很明显您将在 Send 中返回一个空字符串。如果您对响应的唯一处理是将其写入控制台，则在 Ito 的解决方案中不需要任何等待 - 控制台打印输出无需等待即可发生，但在这种情况下，发送和打印都应返回 void。在控制台应用程序中运行它，您将获得页面的打印输出。

IMO，等待和 Task.Result 调用（哪个块）有时是必要的，具体取决于您所需的控制流，但更多时候它们表明您没有真正正确使用异步功能。

```
namespace TaskTest
{
    class Program
    {
        static void Main(string[] args)
        {
            Send();
            Console.WriteLine("Press Enter to exit");
            Console.ReadLine();
        }

        private static void Send()
        {
            HttpClient client = new HttpClient();
            Task<HttpResponseMessage> responseTask = client.GetAsync("http://google.com");
            responseTask.ContinueWith(x => Print(x));
        }

        private static void Print(Task<HttpResponseMessage> httpTask)
        {
            Task<string> task = httpTask.Result.Content.ReadAsStringAsync();
            Task continuation = task.ContinueWith(t =>
            {
                Console.WriteLine("Result: " + t.Result);
            });
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-24T16:53:02.803

```
async Task<int> AccessTheWebAsync()  
{   
    // You need to add a reference to System.Net.Http to declare client.  
    HttpClient client = new HttpClient();  

    // GetStringAsync returns a Task<string>. That means that when you await the  
    // task you'll get a string (urlContents).  
    Task<string> getStringTask = 

    client.GetStringAsync("http://msdn.microsoft.com");  

    // You can do work here that doesn't rely on the string from GetStringAsync.  
    DoIndependentWork();  

    // The await operator suspends AccessTheWebAsync.  
    //  - AccessTheWebAsync can't continue until getStringTask is complete.  
    //  - Meanwhile, control returns to the caller of AccessTheWebAsync.  
    //  - Control resumes here when getStringTask is complete.   
    //  - The await operator then retrieves the string result from 
    getStringTask.  
    string urlContents = await getStringTask;  

    // The return statement specifies an integer result.  
    // Any methods that are awaiting AccessTheWebenter code hereAsync retrieve the length 
    value.  
    return urlContents.Length;  
} 
```

# html - META 刷新重定向 (CGI-C) 上的额外 GET 请求

> ID：13211347
> 
> 赞同：1
> 
> 时间：2012-11-03T16:58:04.447
> 
> 标签：html, redirect, post, get, cgi

我有一个表单（在页面上`form.html`）使用**`POST`**方法提交到 CGI-C 页面 - 让我们称之为`form.cgi`-它的作用是在 5 秒后使用附加查询字符串将`form.cgi`用户重定向到上一页（到）。`form.html``HTTP-EQUIV Refresh META`

但是，如果我监视 Web 服务器，`access.log`虽然我看到了适当的**POST**请求，但在将用户重定向到之前的 5 秒后，再次`form.cgi`有一个额外的**GET**请求`form.cgi``form.html`

有没有人遇到过这样的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T07:41:14.403

似乎答案是在页面[POST 请求位置发送 Refresh 标头使 Firefox 创建 GET 请求但仍保留 POST 数据](https://stackoverflow.com/questions/7294717/post-requesting-a-location-sending-refresh-header-makes-firefox-create-get-reque)- 并且`<meta>`Refresh 已被弃用，根本不应该使用。

# c# - InsertOnSubmit - NullReferenceException

> ID：13211348
> 
> 赞同：0
> 
> 时间：2012-11-03T16:58:19.477
> 
> 标签：c#, asp.net, .net, linq

我有2个模型。

账户实体

```
[Table(Name = "Account")]
    public class AccountEntity
    {
        [Column(IsPrimaryKey = true, IsDbGenerated = true, AutoSync = AutoSync.OnInsert)]
        public int id { get; set; }
        [Column(CanBeNull = false, Name = "email")]
        public string email { get; set; }
        [Column(CanBeNull = false, Name = "pwd")]
        public string pwd { get; set; }
        [Column(CanBeNull = false, Name = "row_guid")]
        public Guid guid { get; set; }

        private EntitySet<DetailsEntity> details_id { get; set; }
        [Association(Storage = "details_id", OtherKey = "id", ThisKey = "id")]
        public ICollection<DetailsEntity> detailsCollection { get; set; }
    } 
```

详细信息实体

```
[Table(Name = "Details")]

    public class DetailsEntity
    {
    public DetailsEntity(AccountEntity a) {
        this.Account = a;
    }

    [Column(IsPrimaryKey = true, IsDbGenerated = true, DbType = "int")]
    public int id { get; set; }

    private EntityRef<AccountEntity> _account = new EntityRef<AccountEntity>();
    [Association(IsForeignKey = true, Storage = "_account", ThisKey = "id")]
    public AccountEntity Account { get; set; }
} 
```

主要的

```
 using (Database db = new Database())
 {
     AccountEntity a = new AccountEntity();
     a.email = "hahaha";
     a.pwd = "13212312";
     a.guid = Guid.NewGuid();
     db.Account.InsertOnSubmit(a);
     db.SubmitChanges();
 } 
```

有关系的`AccountEntity <- DetailsEntity (1-n)`

当我尝试插入记录时，抛出异常（`NullReferenceException`）

原因：由`EntitySet`空

请帮我插入它。

* * *

我在

```
private EntitySet<DetailsEntity> details_id { get; set; } // this is properties 
```

如果没有引用，这必须是新实例

```
private EntitySet<DetailsEntity> details_id = new EntitySet<DetailsEntity>(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T05:14:55.857

尝试使用以下内容更新详细信息表

```
[Column(IsPrimaryKey = true, IsDbGenerated = true, AutoSync = AutoSync.OnInsert)] 
```

因为您需要在数据惰性化时生成主键。

希望这会有所帮助。

# ruby - 通过 API v1.5 访问整个 netflix 目录

> ID：13211351
> 
> 赞同：2
> 
> 时间：2012-11-03T16:59:05.073
> 
> 标签：ruby, api, http, netflix

Netflix 最近更新了获取完整 Netflix 目录的 API 方法。我很好奇是否有人成功地访问了这些新的 xml 文档并通过 API v1.5 (9/2012) 下载了它们。以前，您可以通过一个 API 调用下载整个 Netflix 目录（我已经完美地工作了）。现在，应该有两个调用：一个用于 dvd，一个用于流媒体电影。

除了空数组之外，我无法让这些调用返回任何内容。除非您通过这些新 API 亲自下载了整个目录，否则请不要提供答案。

如果您能告诉我如何在 Ruby 中执行此操作，则可以加分。

[http://developer.netflix.com/blog/read/Update_Changes_for_the_Public_API](http://developer.netflix.com/blog/read/Update_Changes_for_the_Public_API)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T03:11:10.220

这为我做了（下载 netflix 即时猫）......它在 php 中，但很容易用 ruby​​ 重写......这是使用[JR Collings OAuthsimple](https://github.com/jrconlin/oauthsimple/)

```
args = Array(
    max_results=> 20,
    start_index=>0

);
//args don't matter, netflix doesn't listen here
// this is the URL path (note the lack of arguments.)
$rpath = "http://api-public.netflix.com/catalog/titles/streaming";

// Create the Signature object.
$roauth = new OAuthSimple();
$rsigned = $roauth->sign(Array(path=>$rpath,
                parameters=>$args,
                signatures=> Array('consumer_key'=>YOURKEY,
                                    'shared_secret'=>YOURSECRET,

                                    )));

$getxml = file_get_contents($rsigned['signed_url']);
file_put_contents("streaming.xml", $getxml); 
```

# c++ - C++ Sentinel/Count Controlled Loop 开始编程

> ID：13211352
> 
> 赞同：0
> 
> 时间：2012-11-03T16:59:14.513
> 
> 标签：c++

大家好，这是我的第一篇文章。我正在使用以下参数进行家庭作业。

> 计件工人按计件支付。通常，生产更多产出的工人得到更高的报酬。
> 
> ```
> 1 - 199 pieces completed  $0.50 each
> 200 - 399 $0.55 each (for all pieces)
> 400 - 599 $0.60 each
> 600 or more   $0.65 each 
> ```
> 
> 输入：对于每个工人，输入名称和完成的件数。
> 
> ```
> Name          Pieces
> 
> Johnny Begood     265
> Sally Great       650
> Sam Klutz     177
> Pete Precise      400
> Fannie Fantastic  399
> Morrie Mellow     200 
> ```
> 
> 输出：打印适当的标题和列标题。每个工人应该有一个明细行，显示姓名、件数和收入。计算并打印件数和赚取的美元金额的总和。
> 
> 处理：对于每个人，通过将件数乘以适当的价格来计算所赚取的工资。累计件数和支付的总金额。
> 
> 示例程序输出：
> 
> ```
> Piecework Weekly Report
> 
> Name          Pieces  Pay
> 
> Johnny Begood     265 145.75
> Sally Great       650 422.50
> Sam Klutz     177 88.5
> Pete Precise      400 240.00
> Fannie Fantastic  399 219.45
> Morrie Mellow     200 110.00
> 
> Totals            2091    1226.20 
> ```
> 
> 您需要编码、编译、链接和运行一个哨兵控制的循环程序，该程序将输入转换为输出规范，如上面的附件所示。输入项应输入到名为piecework1.dat 的文本文件中，输出文件存储在piecework1.out 中。程序文件名为piecework1.cpp。这三个文件的副本应以原始形式通过电子邮件发送给我。
> 
> 使用单个变量读取名称，而不是使用两个不同的变量。要做到这一点，您必须使用课堂上讨论的 getline(stream, variable) 函数，但您将用您的文本文件流变量名称替换 cin。不要忘记在程序顶部编写编译器指令 #include <string> 以确认字符串变量 name 的使用。您的嵌套 if-else 语句、累加器、计数控制循环应经过适当设计以正确处理数据。

下面的代码将运行，但不会产生任何输出。我认为它需要第 57 行附近的东西来停止循环。

类似的东西（这只是一个例子......这就是为什么它不在代码中。）

```
count = 1;
while (count <=4) 
```

有人可以查看代码并告诉我需要引入什么样的计数，以及是否需要进行任何其他更改。

谢谢。

```
//COS 502-90
//November 2, 2012
//This program uses a sentinel-controlled loop that transforms input to output.

#include <iostream>
#include <fstream>
#include <iomanip>  //output formatting
#include <string>   //string variables
using namespace std;

int main()
{

double pieces;          //number of pieces made
double rate;            //amout paid per amount produced
double pay;             //amount earned 
string name;            //name of worker
ifstream inFile;
ofstream outFile;

//***********input statements****************************
inFile.open("Piecework1.txt");  //opens the input text file
outFile.open("piecework1.out");  //opens the output text file
outFile << setprecision(2) << showpoint;
outFile << name << setw(6) << "Pieces" << setw(12) << "Pay" << endl;
outFile << "_____" << setw(6) << "_____" << setw(12) << "_____" << endl;
getline(inFile, name, '*');         //priming read
inFile >> pieces >> pay >> rate;    // ,,
while (name != "End of File")           //while condition test
{                                   //begining of loop
    pay = pieces * rate;
    getline(inFile, name, '*');     //get next name
    inFile >> pieces;               //get next pieces
}                                   //end of loop
inFile.close();
outFile.close();
return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:39:04.390

> 有人可以查看代码并告诉我需要引入什么样的计数，以及是否需要进行任何其他更改。

您需要将输出定向到输出文件的语句，就像作业所说的那样。编译器不能读懂你的心思，也不能读懂你的作业。它只能读取您的代码。

您的输入语句也有问题。工资率不在输入文件中。输入文件中的所有内容都是工人的姓名和他们生产的件数。

# joomla - joomla 获取帖子数据

> ID：13211357
> 
> 赞同：0
> 
> 时间：2012-11-03T16:59:43.723
> 
> 标签：joomla, joomla2.5, joomla-extensions

我正在创建 joomla 组件，但从帖子中访问数据时遇到问题

在一个视图中，我有 6 个收件箱，其中 3 个由 JTable 类处理，这很好，但其他 3 个我想处理，我的字段：

```
<input id="jform[team1_goals_players]" class="" type="hidden" name="jform[team1_goals_players]" value="2,2," aria-invalid="false">
<input id="jform_team1_goals" class="required" type="text" value="4" name="jform[team1_goals]" aria-required="true" required="required" aria-invalid="false"> 
```

第一个是我要处理的字段，第二个是由 JTable 类通过使用

```
$sth = JRequest::get('team1_goals_players'); 
```

$sth 为空

我应该在哪里使用 JRequest 来获取该值和其他 2

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-03T21:48:38.603

JRequest 在 2.5 中已弃用。

```
$jinput = JFactory::getApplication()->input;
$post = $jinput->get('jform', array(), 'array');
$sth = $post['team1_goals_players']; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T17:16:46.930

`$sth`是空的，因为没有像表单中那样的变量 `team1_goals_players`。你必须像这样尝试 - 首先获取`jform`然后 `team1_goals_players`从 jform 中读取。

```
$post = JRequest::get('jform');
$sth = $post['team1_goals_players']; 
```

更多关于[JRequest](http://docs.joomla.org/Retrieving_data_from_GET_and_POST_requests)。

# paypal - 选择最佳 PayPal API

> ID：13211360
> 
> 赞同：0
> 
> 时间：2012-11-03T17:00:00.073
> 
> 标签：paypal

我被赋予了将 PayPal API 集成到现有网站的任务，其中应从现有用户数据库中获取买家详细信息，并且所有前端设计都应作为整个系统设计的一部分进行定制。

我基本上需要选择 PayPal API，它允许我根据用户详细信息和信用卡信息简单地授权和调用信用卡费用来选择缓存数量。

哪个 PayPal API 是为此设计的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T00:18:21.423

为此，您需要使用[Payments Pro](https://www.x.com/developers/paypal/development-and-integration-guides#wpp)。

# wordpress - 我如何从 RSS 链接发布到 Facebook 应用程序用户的墙

> ID：13211363
> 
> 赞同：0
> 
> 时间：2012-11-03T17:00:33.503
> 
> 标签：wordpress, rss, facebook-opengraph

我想让我的 facebook 应用程序发布给用户，当在 rss 提要/wordpress 中添加新帖子时，给它流发布权限

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-09T06:55:19.537

只能在 facebook 页面上完成（rss feed 到 facebook），就像 rss graffiti 正在做的那样

发布到用户墙上的应用程序更像是垃圾邮件，如果是，Facebook 不会允许这样做 - 它会在 facebook 开发文档中，对吗？

# android - Android/SQLite - WHERE 子句上的位操作

> ID：13211365
> 
> 赞同：5
> 
> 时间：2012-11-03T17:00:41.133
> 
> 标签：android, sql, sqlite, bit-manipulation, where

我想知道是否可以在 Android 中执行以下操作：

```
public Cursor getFlowsByCategory(int type, int categoryID, int limit) {

    SQLiteDatabase db = dbHelper.getReadableDatabase();

    final String[] columns = {ID, FLAGS, SUBJECT, AMOUNT, AMOUNT_NO, CATEGORY};
    final String selection = "((" + FLAGS + " & ?) >> 1 = ?) AND (" + CATEGORY + " = ?)";
    final String[] selectionArgs = {Integer.toString(Flow.FLOW_TYPE), Integer.toString(type), Integer.toString(categoryID)};

    return db.query(TABLE, columns, selection, selectionArgs, null, null, ID + " DESC", Integer.toString(limit));

} 
```

FLAGS 是一个 1 字节的位掩码，我只想选择具有掩码的第二位（位置 1）的行。掩码 (Flow.FLOW_TYPE) 是 0b00000010，类型参数可以是 0 或 1。它应该可以工作，但不能：我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T19:00:52.603

该`query`函数仅接受字符串作为参数，但在 SQLite 中，数字和字符串永远不会比较相等（除非您具有[类型 affinity](http://www.sqlite.org/datatype3.html#affinity)，但这仅适用于列值，不适用于表达式）。

您必须将参数显式转换回数字：

```
((...) >> 1 = CAST(? AS INTEGER)) AND ... 
```

# android - 防止反射 - android

> ID：13211369
> 
> 赞同：6
> 
> 时间：2012-11-03T17:01:00.867
> 
> 标签：android, reflection

甚至我的类的私有成员/函数也可以通过使用`setAccessible(true)`. 有没有办法防止这种来自外部代码的访问？

我在 stack-overflow 上读到了一些东西，我可以用它`SecurityManager`来防止小程序中的反射（虽然不确定它是如何工作的），但是 Android 也有类似的机制吗？也许是注释或聪明的编程？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-03T19:14:54.760

退后一步，您观察到的是安全理念上的差异，在 Sun 最初体现在 JVM 中的 Java 执行模型和 Android 的执行模型之间。

最初的 Java VM 设计是为一个系统设计的，其中多个相互可疑的应用程序（或 Java 术语中的“小程序”）将同时驻留在单个地址空间中，在单个 VM 中运行。因为设计者不希望一个应用程序能够与另一个应用程序发生冲突，所以他们煞费苦心地定义了一个虚拟机内安全模型，该模型将禁止诸如一个对象接触不同类的另一个对象的私有字段之类的事情。

也就是说，Java 库最终从安全模型中获得了各种“逃生口”。`setAccessible()`正如您所注意到的，其中之一是在反射对象上。

Android 的模型不同：Android 使用进程作为安全边界和应用程序隔离的单元，而不是像传统 JVM 那样试图将其影射*到*进程中。这使得整个 Java 安全模型没有实际意义，*除了*它帮助应用程序“将其从自身中拯救出来”。也就是说，不让一个对象插入另一个对象的私有部分是一种很好的设计，而默认的 Java 安全模型正是提供了这一点。

撇开人们修改您的代码的问题不谈，对于 Android，作为应用程序作者，您可以控制最终在您的应用程序进程中运行的所有代码。如果您选择包含调用的代码`setAccessible()`那是您的事。您可能会在自己的脚下开枪，但您肯定不会在任何其他应用程序的脚下开枪，因为 Android 安全模型在进程层上运行，本质上不会让这种情况发生。同样，使用本机代码将完全让您脱离 Java 对象模型，这允许事情在此过程中完全混乱，但也允许您以比在 Java 中更高效的方式表达一些事情。这是一种权衡，但它是每个应用程序开发人员的权衡，而不是特别影响手机/设备上发生的任何其他事情。

我知道这并不能直接回答您的问题，但我希望它提供了一些有用的上下文。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:17:19.690

> Is there a way to prevent this kind of access from outside code?

Not really.

> is there a similar mechanism for Android as well?

Even if there is (and I am not aware that such a thing exists), anyone can remove it, by decompiling your code (assuming they do not have your source already), getting rid of the protection, and recompiling the code.

Bear in mind that ProGuard, when used properly, will obfuscate your private classes and methods for your production APK builds. That, plus a lack of documentation, will make it tedious for anyone to gain access to those private classes and methods.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T18:57:36.703

我不相信您可以真正 100% 地防止用户使用对您的项目进行恶意的反射。您可以通过对代码进行混淆等操作使用户更难做到这一点，但仍然可以对混淆后的代码进行反思。

我不相信 SecurityManager 可以用于您建议的目的，尽管我可能是错的。

# javascript - 音频使用js使用图片播放暂停btn

> ID：13211372
> 
> 赞同：0
> 
> 时间：2012-11-03T17:01:29.043
> 
> 标签：javascript, html

我是js新手，请原谅我。我正在使用带有一些 js 的 html5 音频标签，仅将播放和暂停显示为按钮。我想更改播放文本并暂停图像。比如 playbtn.png 和 pausebtn.png。这是我卡住的地方。

html:::

```
 <!-- hidden audio player -->
<audio id="audio" controls autoplay hidden="">
    <source src="music/eatForTwo.wav" type="audio/wav">
    <source src="music/eatForTwo.mp3" type="audio/mpeg">
    <p>Your Browser Doesn't Support The HTML5 audio Element</p>
</audio>

<button id="playpause" title="play" onclick="togglePlayPause()" ><img id="imgbtn" src="music/pausebtn.png"/></button>
<!-- javascript for audio control
-->
<script src="code/html5audio.js" type="text/javascript">

</script> 
```

js:::

```
 // Grab a handle to the video
    var audio = document.getElementById("audio");
   // Turn off the default controls
   audio.controls = false;

function togglePlayPause() {
var playpause = document.getElementById("playpause");
if (audio.paused || audio.ended) {
  playpause.title = "pause";
  playpause.style.backgroundImage = "url(music\pausebtn.png)";
  audio.play();
}
else {
  playpause.title = "play";
  playpause.style.backgroundImage = "url(music\playbtn.png)";
  audio.pause();
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T19:19:09.413

编辑您的 js 如下，但您必须更改`url(c:\folder\img.jpg)`为`url(yourPath)`.... 现在 yourPath 并不意味着 yourPath 它意味着图像在硬盘上的位置

```
 // Grab a handle to the video
    var audio = document.getElementById("audio");
   // Turn off the default controls
   audio.controls = false;

function togglePlayPause() {
var playpause = document.getElementById("playpause");
if (audio.paused || audio.ended) {
  //playpause.title = "pause";
  playpause.style.backgroundImage = "url(c:\folder\img.jpg)";
  audio.play();
}
else {
  //playpause.title = "play";
  playpause.style.backgroundImage = "url(c:\img1.jpg)";
  audio.pause();
} 
```

# c++ - 如何在 C++ 中制作 bmp 标头？

> ID：13211373
> 
> 赞同：0
> 
> 时间：2012-11-03T17:01:45.480
> 
> 标签：c++, header, bitmap, bmp

> **可能重复：**
> [在没有其他库的情况下用纯 c/c++ 编写 BMP 图像](https://stackoverflow.com/questions/2654480/writing-bmp-image-in-pure-c-c-without-other-libraries)
> [C++：将整数文本文件转换为 BMP 格式的位图图像文件](https://stackoverflow.com/questions/12200201/c-convert-text-file-of-integers-into-a-bitmap-image-file-in-bmp-format)

[http://www.fastgraph.com/help/bmp_header_format.html](http://www.fastgraph.com/help/bmp_header_format.html) 但是如何将这些写入文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:09:26.543

[这](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145119%28v=vs.85%29.aspx)是一篇 Microsoft 文章，解释了如何将位图数据存储在文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:06:03.507

看看这个链接： http: [//msdn.microsoft.com/en-us/library/windows/desktop/dd183374 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd183374(v=vs.85).aspx)

```
typedef struct tagBITMAPFILEHEADER {
  WORD  bfType;
  DWORD bfSize;
  WORD  bfReserved1;
  WORD  bfReserved2;
  DWORD bfOffBits;
} BITMAPFILEHEADER, *PBITMAPFILEHEADER;

BITMAPFILEHEADER header;
// Fill your header;
std::ofstream of(/*your file name...*/);
of.write(&header, sizeof(header)); 
```

您可以使用任何其他文件实现来代替 std::ofstream。

# asp.net - 在 ASP.net auth cookie 中添加附加信息？

> ID：13211376
> 
> 赞同：2
> 
> 时间：2012-11-03T17:02:07.957
> 
> 标签：asp.net, asp.net-mvc

有没有办法将附加信息添加到 ASP.NET 身份验证 cookie 中？我想将我自己的内部用户密钥保存在 cookie 中，并让它与每个问题的 auth cookie 同时过期： [MVC save a token in session](https://stackoverflow.com/questions/13170618/mvc-save-a-token-in-session)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-14T07:18:11.137

```
[Serializable]
        public class CookieDto
        {
            public string Username { get; set; }
            public string UserId { get; set; }
            public string AuthenticationKey { get; set; }
            public bool Persist { get; set; }
            public string RememberMeToken { get; set; }
        } 
```

坚持方法，

```
public void Persist(CookieDto cookieDto, bool persistent)
{
    var serializer = new XmlSerializer();
    var serializedCookie = serializer.Serialize(cookieDto);
    var ticket = new FormsAuthenticationTicket(1, cookieDto.Username, DateTime.Now, DateTime.Now.AddDays(90),
        persistent, serializedCookie);
    var encryptedTicket = FormsAuthentication.Encrypt(ticket);

    var cookie = new HttpCookie(FormsAuthentication.FormsCookieName, encryptedTicket) { Expires = DateTime.Now.AddDays(90) };
    HttpContext.Current.Response.Cookies.Add(cookie);
} 
```

获取方法，

```
 public CookieDto GetCookie()
        {
            var cookie = HttpContext.Current.Request.Cookies[FormsAuthentication.FormsCookieName];
            if (cookie != null && !string.IsNullOrEmpty(cookie.Value))
            {
                var ticket = FormsAuthentication.Decrypt(cookie.Value);
                var serializer = new XmlSerializer();

                return serializer.Deserialize<CookieDto>(ticket.UserData);
            }

            return null;
        } 
```

删除方法，

```
public void RemoveCookie()
{
    FormsAuthentication.SignOut();
} 
```

祝你好运！

# actionscript-3 - 影片剪辑/精灵上的像素捕捉

> ID：13211377
> 
> 赞同：0
> 
> 时间：2012-11-03T17:02:11.160
> 
> 标签：actionscript-3

有没有办法在影片剪辑/精灵上应用 PixelSnapping 而不仅仅是位图？将它们缓存为位图无济于事。有什么诀窍吗？

![两个低质量影片剪辑之间的差距](../Images/0e2df2faf31cb9b2b330ec811cb72ffd.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:07:24.797

如果它在运动期间，您可以尝试使用[TweenLite](https://www.greensock.com/tweenlite/)之类的补间引擎，该引擎具有在运动期间舍入您的项目的修改属性的属性。

如果您只是想获得类似的圆形位置，您可以在修改它们时尝试手动对属性进行四舍五入：

```
myClip.x = Math.round(myClip.x); 
```

要不就

```
myClip.x = int(myClip.x) 
```

# c# - C# SQL 登录 - 添加信息失败

> ID：13211379
> 
> 赞同：0
> 
> 时间：2012-11-03T17:02:17.690
> 
> 标签：c#, sql, winforms, string

好的，所以我有一个字符串问题。我不确定它是不是很简单，我只是盯着它看了很长时间而一无所获，或者这是我无法避免的事情？

所以我正在尝试使用 C# 登录到 SQL 服务器。一旦登录框出现，我将用户名和密码传递给连接类，登录成功。

```
 public void login(object sender, EventArgs e)
    {
        sqlconnect sql = new sqlconnect();

        sql.us = textBox1.Text;
        sql.pas = textBox2.Text;
            try
            {
                sql.GetSqlConnection();
                sql.myConnection.Open();
                label3.Text = "Connected";
                this.Hide();
                fronthyb.Show();
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
        } 
```

**所以下面是我的连接类：**

```
 public class sqlconnect
{
    public SqlConnection myConnection { get; set; }
    public String us;
    public String pas;
    Settings1 set = new Settings1();

    public SqlConnection GetSqlConnection()
    {
        if (myConnection == null)
            myConnection = new SqlConnection("user id="+(us)+"; password="+(pas)+";server="+(set.SelectServer)+";Trusted_Connection="+(set.SelectContype)+";database="+(set.SelectDataBase)+"; connection timeout="+(set.Condrop)+"");

        return myConnection;
    }

} 
```

**当我尝试向数据库添加信息时，现在出现了问题：**

```
 private void button1_Click(object sender, EventArgs e)
    {

            sql.GetSqlConnection();

            SqlCommand cm = new SqlCommand("insert into dbo.Employee(FirstName, LastName, DoB, UserName, Email, Role, JobTitle, MemberOf) values (@FirstName, @LastName, @DoB, @UserName, @Email, @Role, @JobTitle, @MemberOf)", sql.myConnection);
            cm.Parameters.AddWithValue("@FirstName", textBox2.Text);
            cm.Parameters.AddWithValue("@LastName", textBox3.Text);
            cm.Parameters.AddWithValue("@DoB", textBox5.Text);
            sql.myConnection.Open();
            cm.ExecuteNonQuery();
            sql.myConnection.Close();
            this.Close(); 
```

我还没有发现任何问题，因为它仍在开发中，但程序崩溃并且基本上说不允许用户。我测试了连接类中的字符串，当我在登录后调用它们时，它什么也不返回。所以它似乎在某个时候被“null”取代了？我不确定。有人看到任何明显的东西吗？对不起，很长的问题。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:10:22.477

`sql`您在方法中使用的变量是该`login`方法的本地变量。

这意味着您在那里创建的对象在方法之外是不可访问的，并且您在方法中使用的任何命名变量都`sql`与方法中的不同，并且没有在那里设置的用户名和密码。`button1_Click``login`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:11:14.867

似乎是一个范围界定问题。在您的登录处理程序中，您定义一个 SqlConnect 类型的局部变量。如果您有一个名为“sql”的全局变量，因为它在 button1_Click 处理程序中被引用，则它不会设置用户名/密码属性，因为它是一个不同的实例。

# java - 番石榴：为什么方法 create() 而不是构造函数？

> ID：13211381
> 
> 赞同：10
> 
> 时间：2012-11-03T17:02:22.863
> 
> 标签：java, constructor, guava, static-methods

拜托，你能解释一下为什么番石榴的创造者更喜欢将构造函数定义为私有的，并定义静态方法`create()`来创建对象吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-03T17:17:08.263

有效的 Java 项目 1：考虑静态工厂方法而不是构造函数。

静态工厂方法的一些优点包括：

*   它们会自动推断 Java 7 之前的类型参数。
*   它们允许我们控制继承模式：我们可以在 Guava 中对集合类型进行子类化，而无需让外部代码对它们进行子类化。
*   它们让我们返回所需类型的任意子类，让我们更好地隐藏实现细节。

# php - 如何在每行中显示答案和文本输入

> ID：13211382
> 
> 赞同：1
> 
> 时间：2012-11-03T17:02:43.793
> 
> 标签：php, html, mysql

我对如何在我的 php 代码中显示正确的表格布局有疑问：

我想在表格中显示答案及其文本输入。现在它显示如下：

```
 Question             Answer        Marks Per Answer     
 What is 2+2          B             (text input)         
 Name the 3 hobbits?  BCE           (text input) 
```

我想更改表格的显示，使其如下所示：

```
 Question             Answer        Marks Per Answer 
 What is 2+2?         B             (text input)
 Name the 3 Hobbits?  B             (text input)                   
                      C             (text input)
                      E             (text input) 
```

1.  正如您从新显示器中看到的那样。我希望每个问题的每个答案都显示在他们自己的行中，而不是在一行中显示每个问题的所有答案，这就是它目前正在做的事情。
2.  我希望文本输入也显示在自己的行中，例如答案：

我的问题是，如何实现第 1 点和第 2 点才能匹配新布局？

以下是当前显示的代码：

```
$assessment = $_SESSION['id'] . $sessionConcat;

include('connect.php');

   $query = "SELECT q.QuestionId, q.QuestionContent, GROUP_CONCAT(DISTINCT Answer ORDER BY Answer SEPARATOR '') AS Answer, 
   FROM Question q
   INNER JOIN Answer an ON q.QuestionId = an.QuestionId
   WHERE s.SessionName = ?
   ";

        // prepare query
        $stmt=$mysqli->prepare($query);
        // You only need to call bind_param once
        $stmt->bind_param("s", $assessment);
        // execute query
        $stmt->execute(); 

        // This will hold the search results
        $searchQuestionId = array();
        $searchQuestionContent = array();
        $searchAnswer = array();

        // Fetch the results into an array

        // get result and assign variables (prefix with db)
        $stmt->bind_result($dbQuestionId, $dbQuestionContent, $dbAnswer);
        while ($stmt->fetch()) {
        $searchQuestionContent[] = $dbQuestionId;
        $searchQuestionContent[] = $dbQuestionContent;
        $searchAnswer[] = $dbAnswer;
        }   

        ?>      

        </head>

        <body>

        <form id="QandA" action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">

        <?php 

        echo "<table border='1' id='markstbl'>
        <tr>
        <th class='questionth'>Question</th>
        <th class='answerth'>Answer</th>
        <th class='answermarksth'>Marks per Answer</th>
        </tr>\n";

        foreach ($searchQuestionContent as $key=>$question) {
        echo '<td>'.htmlspecialchars($question).'</td>' . PHP_EOL;
        echo '<td class="answertd">'.htmlspecialchars($searchAnswer).'</td>' . PHP_EOL; 
        echo '<td class="answermarkstd"><input class="individualMarks" name="answerMarks[]" id="individualtext" type="text" "/></td>' . PHP_EOL;
        }
        echo "</table>" . PHP_EOL;

        ?>

        </form>

        </body> 
```

下面是问题表的样子：

问题表：

```
QuestionId (auto)  QuestionContent
1                  What is 2+2?
2                  Name the 3 hobbits? 
```

答案表：

```
AnswerId (auto)  QuestionId   Answer
1                 1           B   
2                 2           B
3                 2           C
4                 2           E 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T19:11:01.227

看起来你可以摆脱分组子句。您可能希望按问题 ID 排序，因此同一问题的所有答案都会一起给出。

```
SELECT q.QuestionId, q.QuestionContent, an.Answer
FROM Question q
INNER JOIN Answer an ON q.QuestionId = an.QuestionId
WHERE s.SessionName = ?
ORDER BY q.QuestionId, an.Answer 
```

# php - 更改 now() 标签的所需输出方法

> ID：13211383
> 
> 赞同：-1
> 
> 时间：2012-11-03T17:02:46.967
> 
> 标签：php, mysql, date-formatting

> **可能重复：**
> [显示来自数据库 PHP 的日期](https://stackoverflow.com/questions/4066166/displaying-date-from-database-php)

我在我正在制作的小型 CMS/博客的表单中的 insert.php 函数中使用此方法。我只想知道如何更改`now()`格式。

```
mysql_query("INSERT INTO Blog
(Date, Title, Message, Image) 
VALUES(now(), '$_POST[Title]' , '$_POST[Message]' , '$_POST[Image]' ) ")
or die(mysql_error()); 
```

我有一个使用回声的页面

```
 echo "<h2>" . "Posted on:   " . $row['Date'] . "</h2>"; 
```

这工作正常，但它以我不想要的格式输出。目前显示为：

```
Posted on: 2012-11-03 16:17:29 
```

我更喜欢它是

```
Posted on: 3rd November 2012 at 16:15 
```

这很容易做到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T17:04:40.227

[`DATE_FORMAT()`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-format)当您从数据库中选择日期时，请使用 MySQL 函数。

例子：

```
SELECT DATE_FORMAT( Date, 'Posted on: %D %M %Y at %H:%i') AS FormattedDate FROM `Blog` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:07:15.810

```
SELECT DATE_FORMAT(DATE, '%D %M %Y at %H:%i') FROM  Blog 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T17:07:25.353

是的，这很容易：

```
 echo strftime('%e, %B, %Y', $row ['date']);

   Take a look at : http://php.net/manual/en/function.strftime.php 
```

# php - 大括号之间的Netbeans格式

> ID：13211384
> 
> 赞同：0
> 
> 时间：2012-11-03T17:02:47.497
> 
> 标签：php, netbeans, formatting, code-formatting

我正在使用 netbeans，这让我有点发疯。

这是我的代码：

```
 if($pos !== false)
    {
    // Explode() 
    $the_type = explode("(", $type);
    } 
```

我希望它像这样缩进大括号之间的东西：

```
 if($pos !== false)
    {
        // Explode() it to get to just the type
        $the_type = explode("(", $type);
    } 
```

有人可以告诉我在哪里更改此设置以及使用什么值？

我一直在工具->选项->编辑器中，但不知道究竟要更改什么以及使用什么值。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T19:36:53.233

我刚刚尝试配置 Netbeans 来做你想做的事，但我还没有管理它。在浏览了 Netbeans 配置以使其正常工作后，我怀疑答案是，遗憾的是，您想要做的事情在 Netbeans 中是不可能的。

对于那个很抱歉。

可能值得将其作为未来版本的功能请求发布。

代码缩进风格是个人的事情，对代码本身的质量没有影响，所以请阅读这个答案的其余部分，不要觉得我试图让你远离你喜欢的风格。

如果您的代码将被保密并且不使用任何第三方库，那么您的编码风格完全是您的，并且真的没有任何理由被任何其他意见所左右。但是，如果您打算让您的代码开源，或者您需要使用第三方库，那么值得看看其他人在做什么。

首先，可能值得阅读[有关代码缩进样式的 Wikipedia 文章](http://en.wikipedia.org/wiki/Indent_style)。

从您的角度来看，这篇文章的有趣之处在于根本没有提及您要使用的样式。几乎所有其他大括号位置和缩进的组合都会被命名和讨论，但不是你的。我也从未在其他任何地方看到过你的风格。我读到的是你的风格很不寻常。

另一件值得一提的是最近发布[的 PHP PSR 编码标准](http://www.php-fig.org/)。显然，没有强制使用这些标准，但是它们已经被大量的开源 PHP 项目标准化，包括所有主要的框架。

PSR 标准定义了一种与您的编码风格非常不同的编码风格。大多数流行的开源 PHP 项目都在转向它。甚至还有一个[代码整理实用程序可以格式化代码以满足 PSR 标准](https://github.com/fabpot/PHP-CS-Fixer)。（我将建议它作为您问题的直接解决方案，因为我认为它可能能够将代码修复为您想要的方式，但它似乎只符合 PSR 标准）

所以有一些值得深思的地方。不过，正如我所说，我不想影响您的个人喜好。不幸的是，如果你想坚持使用 Netbeans，这似乎比我能说的更能强迫你。

# android - 调试、测试和部署 Android 库项目

> ID：13211385
> 
> 赞同：0
> 
> 时间：2012-11-03T17:02:53.737
> 
> 标签：android

一般来说，我如何测试和调试我没有编写的程序的插件？我的意思是，我正在编写库插件，但我没有编写将引用它的应用程序。我正在构建一个库插件项目（专门用于程序“Locale”），但我不知道如何将它推送到我的手机进行测试。一旦程序运行起来，部署它与部署“常规”android 应用程序有什么不同？通常我可以在 bin 文件夹中获取 apk，但库只是编译成 jars。

顺便说一句，我是在构建共享库还是静态库？我如何分辨它们之间的区别？当我在寻找这个问题的答案时，我不断地看到对这些不同库类型的引用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T19:00:13.200

我认为您正在混合两个不同的概念：库和插件。库是您可以在其他应用程序中实现和使用的可重用代码，您可以在使用库编译、测试和调试应用程序时测试和调试库。

然而，插件只是与另一个扩展其功能的应用程序的“挂钩”。插件可以是完整工作应用程序的一部分，也可以是没有图形界面的独立应用程序，在任何情况下，它都是具有可安装 apk 的独立应用程序，并且它与 eclipse 或您选择的代码编辑器中的任何其他应用程序一样工作。插件可以通过权限实现，除了它们与任何其他应用程序没有什么不同。

# mysql - symfony2：尝试创建数据库时出现 MySQL 服务器错误

> ID：13211386
> 
> 赞同：1
> 
> 时间：2012-11-03T17:02:57.100
> 
> 标签：mysql, apache, symfony, doctrine-orm, phpmyadmin

我刚刚在 symfony 上创建了一个实体

我现在正在尝试使用控制台命令创建数据库：

```
 php app/console doctrine:database:create 
```

这会产生此错误：

```
 Could not create database for connection named `symfony`

    SQLSTATE[HY000] [2002] Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) 
```

/var/run/mysqld/ 文件夹实际上不存在于我的计算机中！？

我的 app/config/parameters.yml ：

```
 parameters:
database_driver:   pdo_mysql
database_host:     localhost
database_port:     ~
database_name:     symfony
database_user:     root
database_password: ~

mailer_transport:  smtp
mailer_host:       localhost
mailer_user:       ~
mailer_password:   ~

locale:            en
secret:            ThisTokenIsNotSoSecretChangeIt 
```

怎么了 ？我错过了什么？如何在 symfony 项目上访问 phpmyadmin？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-24T19:49:08.467

尝试使用**localhost**而不是 127.0.0.1 来连接您的 parameters.yml。在ubuntu pc上为我工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-25T10:20:41.283

我已经通过重新安装 mysql 服务器来解决它

```
 sudo aptitude update sudo aptitude upgrade sudo aptitude install mysql-server 
```

# java - Java GUI：按钮控件不可见

> ID：13211388
> 
> 赞同：1
> 
> 时间：2012-11-03T17:03:16.390
> 
> 标签：java, user-interface, jframe, jpanel, jbutton

我在屏幕上显示我的主菜单时遇到问题。我看不出问题出在哪里。它所显示的只是一个空白的 JFrame 窗口。它没有显示带有按钮的面板。

主类：

```
public class Main {

public static void main(String[] args) {
    GUIView gui = new GUIView();

}
} 
```

GUIView 类：

```
import javax.swing.*;
import java.awt.*;

public class GUIView {
protected JFrame frame;
    public GUIView() {

    frame = new JFrame("Test");
        frame.setVisible(true);
        frame.setSize(500,500);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

} 
```

}

主菜单类：

```
import javax.swing.*;
import java.awt.*;

public class MainMenu extends GUIView {
    private JButton b1, b2, b3;
    private JPanel panel;
    public MainMenu() {
        GridBagLayout gridbag = new GridBagLayout();
        b1 = new JButton();
        b2 = new JButton();
        b3 = new JButton();

    //Button Settings;
    b1.setText("Administrator");
    b2.setText("Program Leader");
    b3.setText("Lecturer");

    //Panel Settings
    panel = new JPanel();
    panel.setLayout(gridbag);
    panel.add(b1);
    panel.add(b2);
    panel.add(b3);
    panel.setVisible(true);
    super.frame.add(panel);
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:11:11.837

试试这个方法………​​…

```
public class Test1 extends JFrame {

    int count;

     public Test1(){

         this.setSize(400,400);
         MyCompo m = new MyCompo();
         this.add(BorderLayout.CENTER,m);
         this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
     }

     class MyCompo extends JPanel{

         public MyCompo() {
             this.setSize(300,300);
            setComponents();
             //setHandlers();

         }

        public void paintComponent(Graphics g) {

             //setComponents();

         }
         public void setComponents() {

             this.setLayout(new GridLayout(5,4));
             this.add(new Button("1"));
             this.add(new Button("2"));
             this.add(new Button("3"));
             this.add(new Button("4"));
             this.add(new Button("5"));
             this.add(new Button("6"));
             this.add(new Button("7"));
             this.add(new Button("8"));
         }

     }

     public static void main(String[] args){

         EventQueue.invokeLater(new Runnable() {

             public void run() {
                 Test1 t = new Test1();

                 t.setVisible(true);

             }

         });

     }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:16:08.967

您永远不会创建`MainMenu`. 要修复，您可以执行以下操作：

```
public static void main(String[] args) {
   GUIView gui = new MainMenu();
} 
```

# jquery-templates - jQuery Tmpl 在没有被 TABLE 标签包裹时删除 TR 标签内容

> ID：13211393
> 
> 赞同：3
> 
> 时间：2012-11-03T17:03:37.440
> 
> 标签：jquery-templates

在大量使用 jQuery Tmpl 迁移我的旧 Web 界面后，我的一些模板已经停止工作。进一步的调查表明，模板不起作用是那些以 TR 标记开头和结尾的模板（即，将表行附加到现有表中）。源文本刚刚被 jQuery Tmpl 脚本删除！如果我在更广泛的上下文中使用 TR 标签，比如包装在表格中等，一切都会正常工作，但是一旦它们在隔离模板中使用，它们就会被消灭。

工作示例：

```
<script id="workingTemplate" type="text/x-jQuery-tmpl" >
    <table>
        <tr><td>this works</td></tr>
    </table>
</script> 
```

不工作的例子：

```
<script id="notWorkingTemplate" type="text/x-jQuery-tmpl" >
    <tr><td>this does not work</td></tr>
</script> 
```

第一个示例在使用 Firebug 检查时呈现完整的 HTML 代码，后者呈现一个空的 SCRIPT 标记。

可能与模板相关的新旧 Web 界面之间的差异是从 jQuery 1.5.2 到 1.8.2 的变化。我没有尝试运行低于 1.7.2 的任何东西，因为这是添加 .on() 函数的地方，并且新框架广泛使用了这种方法。

除了最明显的（=将模板框架更改为仍然维护的东西）之外，这个问题是否有任何解决方法？

编辑：从字符串加载模板时，内容保持不变，

```
 $.template( "tableRowTemplate",'<tr><td>this works</td></tr>');
 $.tmpl("tableRowTemplate", data).appendTo('TABLE#mytable TBODY'); 
```

但不幸的是对我没有好处，因为我的模板比示例（服务器端动态等）复杂一点。不过，它确实给出了一些提示。显然，是 jQuery Tmpl 的初始化，如果它不符合我不知道的内容，它会删除内容。也许是 jQuery.fn.domManip？

# entity-framework-5 - EF5 的启用迁移失败

> ID：13211394
> 
> 赞同：0
> 
> 时间：2012-11-03T17:03:42.260
> 
> 标签：entity-framework-5

我正在使用 .NET 4.0 和 Visual Studio 2010（我最终会升级，但还没有升级）。我通过 NuGet 从 EF 4.1 降级到 EF 5 并运行 Enable-Migrations（通过包管理器控制台）但收到此错误

```
No context type was found in the assembly 'UI'. 
```

我用谷歌搜索并找到[了这个](https://stackoverflow.com/questions/12021656/enable-migrations-fails-after-upgrading-to-net-4-5-and-ef-5)SO 帖子。

海报描述的场景略有不同，因为他使用的是 VS 2012 和 .NET 4.5。无论哪种方式，我都不确定这是否能解决我的问题。我是否需要使用 VS 2012 和 .NET 4.5 才能使用迁移？如何解决我的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T16:57:49.563

为了 NuGet 命令正常工作，您应该指定默认项目：

![在此处输入图像描述](../Images/6ab256c6be99f3cb4e5a0476601b7e6a.png)

因此，您应该将下拉值从*UI*更改为*Model*（我想）。操作不应依赖于 VS 版本。

# android - 如何在edittxt android中获取值并将其放入URL

> ID：13211395
> 
> 赞同：0
> 
> 时间：2012-11-03T17:03:42.513
> 
> 标签：android

```
private Button btnLogin;
private EditText txtPub;
private EditText txtPriv;
final Context context = this;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.loginfirst);

    btnLogin = (Button)findViewById(R.id.btnEnter);
    btnLogin.setOnClickListener(this);
    txtPub = (EditText)findViewById(R.id.textPublic);
    txtPriv = (EditText)findViewById(R.id.textPrivate);
}

@Override
public void onClick(View arg0) {
    Intent intent = new Intent(context, WebViewActivity.class);
    startActivity(intent);

} 
```

在 WebViewActivity.class

```
private WebView webView;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.webview);

    webView = (WebView) findViewById(R.id.web_view);
    webView.getSettings().setJavaScriptEnabled(true);
    webView.loadUrl("http://url.com/txtpub+txtprive");

} 
```

如何获取 edittxt txtpub 和 txtpriv 的值并将 webviewactivity 类放在上面的 url 中？我想将 txtpub 和 txtpriv 的值放在 url 中。请帮帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:17:36.850

in your onClick, you can add the values into the intent.

```
 public void onClick(View arg0) {
     Intent intent = new Intent(context, WebViewActivity.class);
     startActivity(intent);
     intent.putExtra("txtPub", txtPub.getText().toString();
     intent.putExtra("txtPriv", txtPriv.getText().toString();
 } 
```

Then, in your webviewActivity you can use

```
 Bundle b = getIntent.getExtras();
 String txtPub = b.getString("txtPub");
 String txtPriv = b.getString("txtPriv") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:11:25.247

使用附加值将值传递给其他活动

```
@Override
public void onClick(View arg0) {
Intent intent = new Intent(context, WebViewActivity.class);
 intent.putExtras("txtpub",txtpub.getText().toString());
 intent.putExtras("txtpriv",txtpriv.getText().toString());
startActivity(intent);

} 
```

并在其他活动中使用从 webviewactivity 类中的附加项中获取值

```
String txtpub = getIntent().getStringExtra("txtpub");
 String txtpriv= getIntent().getStringExtra("txtpriv"); 
```

并将其传递给像

```
webView.loadUrl("http://url.com/"+txtpub+txtprive); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T17:12:08.220

您可以在某些按钮单击或其他任何操作中从编辑文本中获取值，只需执行以下操作：

```
txtPub.getText().toString(); 
```

这将从您的编辑文本中返回值。正如我所见，您的 webview 在另一个活动中，因此您可以通过这种方式将此值发送到您的 webview 活动：

```
intent.putExtra("my_url", txtPub.getText().toString()); 
```

在您的 webview 活动中，您可以获得该值：

```
String my_url = getIntent().getStringExtra("my_url", null); 
```

并在您的 webview 中加载该值。就这样 ： ）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T17:12:36.290

```
private Button btnLogin;
private EditText txtPub;
private EditText txtPriv;
final Context context = this;
String a;
String b;

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.loginfirst);

btnLogin = (Button)findViewById(R.id.btnEnter);
btnLogin.setOnClickListener(this);
txtPub = (EditText)findViewById(R.id.textPublic);
txtPriv = (EditText)findViewById(R.id.textPrivate);

a=txtPub.getText();
b=txtPriv.getText();
}

@Override
public void onClick(View arg0) {
Intent intent = new Intent(context, WebViewActivity.class);
Bundle bundleObj = new Bundle();

        bundleObj.putString("first", a);
        bundleObj.putString("sec", b);

        intent.putExtras(bundleObj);
startActivity(intent);

} 
```

在 WebViewActivity.class

```
private WebView webView;

public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.webview);
Bundle extras = getIntent().getExtras();
String a=extras.getString("first");
String b=extras.getString("sec");

webView = (WebView) findViewById(R.id.web_view);
webView.getSettings().setJavaScriptEnabled(true);
webView.loadUrl("http://url.com/" + a + b);

} 
```

# perl - 使用 Perl 将数据转换为数组

> ID：13211397
> 
> 赞同：0
> 
> 时间：2012-11-03T17:03:52.887
> 
> 标签：perl

如何使用 Perl 将我的数据转换为数组？

这是我的数据：

```
my $data =
  "203.174.38.128203.174.38.129203.174.38.1" .
  "30203.174.38.131203.174.38.132203.174.38" .
  ".133203.174.38.134173.174.38.135203.174." .
  "38.136203.174.38.137203.174.38.142"; 
```

我想把它变成这样的数组

```
my @array= (
  "203.174.38.128",
  "203.174.38.129",
  "203.174.38.130",
  "203.174.38.131",
  "203.174.38.132",
  "203.174.38.133",
  "203.174.38.134",
  "173.174.38.135",
  "203.174.38.136",
  "203.174.38.137",
  "203.174.38.142"
); 
```

有人知道如何用 Perl 做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:06:42.217

如果 IP 记录的第一部分始终是`203`，这很容易：

```
my @arr = split /(?<=\d)(?=203\.)/, $data; 
```

在给出的示例中不是，但第一部分始终为 3 位，第二部分始终为`174`，所以就足够了......

```
my @arr = split /(?<=\d)(?=\d{3}\.174\.)/, $data; 
```

...以获得正确的结果。

但请理解，在这里给出更通用（和防弹）的解决方案几乎是不可能的 - 当这些“标记”部分......过于动态时。例如，拿这个字符串...

```
11.11.11.22222.11.11.11 
```

问题是，在哪里拆分它？应该是`11.11.11.22; 222.11.11.11`吗？或者`11.11.11.222; 22.11.11.11`？如果你问我，这两个都是非常有效的 IP。如果尝试拆分“2222”部分（可以是“2；222”、“22；22”甚至“222；2”），情况可能会变得更糟。

例如，您可以制定一条规则：“拆分每个 > 3 位数字后跟一个点号的序列，以便此拆分的*第二*部分始终从 3 位数字开始”：

```
my @arr = split /(?<=\d)(?=\d{3}\.)/, $data; 
```

...但是，如果您的数据字符串中有两位数甚至一位数的第一个八位字节的 IP，那么在前面提到的模棱两可的情况下，这显然无法正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T23:37:31.647

如果您编写的正则表达式将匹配四重奏中的一个数字的任何有效值，那么您只需搜索它们并以四个为一组重新组合它们。这个

```
/2[0-5][0-5]|1\d\d|[1-9]\d|\d/ 
```

匹配 200-255 或 100-199 或 10-99 或 0-9，使用它的程序如下所示。

如果拆分字符串的方法不止一种，则无法知道采用哪个选项，并且此解决方案将最长的值分配给两个 ip 地址中的第一个。例如，`1.1.1.1234.1.1.1`将拆分为`1.1.1.123`和`4.1.1.1`

```
use strict;
use warnings;

use feature 'say';

my $data =
  "203.174.38.128203.174.38.129203.174.38.1" .
  "30203.174.38.131203.174.38.132203.174.38" .
  ".133203.174.38.134173.174.38.135203.174." .
  "38.136203.174.38.137203.174.38.142";

my $byte = qr/2[0-5][0-5]|1\d\d|\d\d|\d/;

my @bytes = $data =~ /($byte)/g;
my @addresses;
push @addresses, join('.', splice(@bytes, 0, 4)) while @bytes;

say for @addresses; 
```

**输出**

```
203.174.38.128
203.174.38.129
203.174.38.130
203.174.38.131
203.174.38.132
203.174.38.133
203.174.38.134
173.174.38.135
203.174.38.136
203.174.38.137
203.174.38.142 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T18:29:38.063

使用您的示例，看起来您的第一个和最后一个节点有 3 位数字。这将提示使用此模式：

```
/(\d{3}\.\d{1,3}\.\d{1,3}\.\d{3})/ 
```

加上一个`/g`开关，它会拉动每一个。

但是，如果您的数据集比您为样本显示的数据集更大且不同，则应该有人在将 ips转储到此字符串*之前将它们分开。*如果它们是单独的数据点，它们应该有一些*分离*。

# twitter-bootstrap - Twitter Bootstrap v2.1.1 的照片库/网格

> ID：13211399
> 
> 赞同：5
> 
> 时间：2012-11-03T17:03:53.587
> 
> 标签：twitter-bootstrap, image-gallery, photo-gallery

到目前为止，我真的很喜欢 Twitter Bootstrap，并且发现它很容易实现。下一步是为某些页面和未来的博客文章实现某种类型的照片库。理想情况下，我希望（a）单击或（b）悬停时具有漂亮的小边框和弹出放大图像的一排照片（可能是 4/行）。我做了一些研究，但找不到任何教程或方法。

非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-05T10:03:44.110

查看[https://github.com/blueimp/Bootstrap-Image-Gallery](https://github.com/blueimp/Bootstrap-Image-Gallery) 它演示了一个用于引导程序的简单图像库，还有[https://github.com/jbutz/bootstrap-lightbox](https://github.com/jbutz/bootstrap-lightbox)用于灯箱效果。

# node.js - 如何在 NodeJS/Express 中的页面刷新之间保留 node-dbox 令牌

> ID：13211401
> 
> 赞同：6
> 
> 时间：2012-11-03T17:04:07.987
> 
> 标签：node.js, express, dropbox

我正在尝试使用和组合一个小应用`NodeJS`程序。请求授权时 -[这是一个 3 步过程](https://github.com/sintaxi/node-dbox#how-to-use)，首先需要获取，然后用户授权他们访问保管箱页面，然后才请求，基于用户已授权请求的事实。`node-dbox``Express``DropBox``request_token``access_token``request_token`

但是，当我为第 1 步和第 2 步提供页面时（获取`request_token`并为用户提供 url） -`request_token`实例已经消失了！所以在第 3 步中我无法请求`access_token`，因为它需要`request_token`通过

我正在尝试保存`request_token`在 cookie 中，但鉴于其中包含敏感数据，将其发送给客户端可能不是一个好主意。有任何想法吗？

简化代码如下：

```
(function() {
    var dbox = require('dbox'),
        config = require('easy-config'),
        express = require('express'),
        dboxApp = dbox.app(config.dropbox_credentials),
        app = express();

    app.use(express.cookieParser());

    app.get('/', function(req, res) {
        dboxApp.requesttoken(function(status, request_token) {
            res.cookie('request_token', JSON.stringify(request_token));
            res.send("<a href='" + request_token.authorize_url + "' targe='_new'>authorize via dropbox</a><br/>" + "<a href='/next'>next</a>");
        });
    });

    app.get('/next', function(req, res) {
        var request_token = JSON.parse(req.cookies.request_token);
        if(request_token) {
            dboxApp.accesstoken(request_token, function(status, access_token) {
                var client = dboxApp.client(access_token);
                client.account(function(status, reply){
                  res.send(reply);
                });
            });
        } else {
            res.send('sorry :(');
        }
    });

    app.listen(3000);

})(); 
```

额外的问题：`client`是用创建的`access_token`，所以无论是客户端实例还是`access_token`需要在页面刷新之间进行维护，最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T22:52:03.863

我设法通过执行以下操作使其工作：

根据 Dropbox Developer 参考，您可以通过指定回调 url 以及此处所述的请求来提供回调 url：

[https://www.dropbox.com/developers/blog/20](https://www.dropbox.com/developers/blog/20)

```
https://www.dropbox.com/1/oauth/authorize?oauth_token=<request-token>&oauth_callback=<callback-url> 
```

通过将请求令牌存储在会话中并重定向到回调 url，您就可以访问请求令牌并继续前进。几个 Express 路由处理程序，将成员 ID 作为参数传递，请求然后处理响应可能如下所示：

```
 linkAccount : function(req, res){
      var  memberId = req.params.memberId,
        appKey = 'MYAPPKEY',
        appSecret = 'MYAPPSECRET',
        dbox = require('dbox'),
        dboxApp = dbox.app({ "app_key": appKey, "app_secret": appSecret });

      req.session.dboxStore = {};
      req.session.dboxStore.dboxApp = dboxApp;

      dboxApp.requesttoken(function(status, request_token){
        req.session.dboxStore.request_token = request_token;
        console.log("request_token = ", request_token);

        res.redirect('https://www.dropbox.com/1/oauth/authorize?oauth_token='+request_token.oauth_token+
          '&oauth_callback=http://myhost.local/linksuccess/dropbox/'+memberId);
        res.end;
      });
    },

    linkSuccess : function(req, res){
      var memberId = req.params.memberId;
      var appKey = 'MYAPPKEY';
      var appSecret = 'MYAPPSECRET';
      var dbox = require('dbox');
      var dboxApp = dbox.app({ "app_key": appKey, "app_secret": appSecret });
      var request_token = req.session.dboxStore.request_token;

      dboxApp.accesstoken(request_token, function(status, access_token){
        console.log('access_token = ', access_token);

        Member.setAuthToken(memberId, 'dropbox', access_token, function(err, member){
          res.render('index', { title:'SUCCESSFUL DROPBOX AUTH' });
          res.end;
        });
      });
    } 
```

# c# - 错误，缺少 TClient 参数

> ID：13211406
> 
> 赞同：1
> 
> 时间：2012-11-03T17:04:30.150
> 
> 标签：c#, .net, api, dll, google-drive-api

我正在关注 google QuickStart google Drive .NET api 视频，此时出现错误。我按照他们所说的一切，添加了所有必需的 dll。我正在使用 Visual Studio 2012 在虚拟机上运行 Windows 7，这可能是问题吗？

复制粘贴他们的代码后，我无法构建它。我收到此错误：

`OAuth2.OAuth2Authenticator<TClient>' requires 1 type arguments`

我在谷歌上找不到有关此错误的任何信息，也找不到有关 TClient 的信息

我缺少什么 TClient 参数？

**编码**

```
using System;
using System.Diagnostics;
using DotNetOpenAuth.OAuth2;
using Google.Apis.Authentication.OAuth2;
using Google.Apis.Authentication.OAuth2.DotNetOpenAuth;
using Google.Apis.Drive.v2;
using Google.Apis.Drive.v2.Data;
using Google.Apis.Util;

namespace GoogleDriveSamples
{
    class DriveCommandLineSample
    {
        static void Main(string[] args)
        {
            String CLIENT_ID = "YOUR_CLIENT_ID";
            String CLIENT_SECRET = "YOUR_CLIENT_SECRET";

            // Register the authenticator and create the service
            var provider = new NativeApplicationClient(GoogleAuthenticationServer.Description, CLIENT_ID, CLIENT_SECRET);
            var auth = new OAuth2Authenticator(provider, GetAuthorization);
            var service = new DriveService(auth);

            File body = new File();
            body.Title = "My document";
            body.Description = "A test document";
            body.MimeType = "text/plain";

            byte[] byteArray = System.IO.File.ReadAllBytes("document.txt");
            System.IO.MemoryStream stream = new System.IO.MemoryStream(byteArray);

            FilesResource.InsertMediaUpload request = service.Files.Insert(body, stream, "text/plain");
            request.Upload();

            File file = request.ResponseBody;
            Console.WriteLine("File id: " + file.Id);
            Console.WriteLine("Press Enter to end this process.");
            Console.ReadLine();
        }

        private static IAuthorizationState GetAuthorization(NativeApplicationClient arg)
        {
            // Get the auth URL:
            IAuthorizationState state = new AuthorizationState(new[] { DriveService.Scopes.Drive.GetStringValue() });
            state.Callback = new Uri(NativeApplicationClient.OutOfBandCallbackUrl);
            Uri authUri = arg.RequestUserAuthorization(state);

            // Request authorization from the user (by opening a browser window):
            Process.Start(authUri.ToString());
            Console.Write("  Authorization Code: ");
            string authCode = Console.ReadLine();
            Console.WriteLine();

            // Retrieve the access token by using the authorization code:
            return arg.ProcessUserAuthorization(authCode, state);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T19:16:19.443

它看起来像是您的解决方案中的设置或配置问题。尝试按照包含 .NET Drive 快速入门的 Google Developers Live 会话的视频录制中的分步说明进行操作：

[http://www.youtube.com/watch?v=uwrJSWqglTc](http://www.youtube.com/watch?v=uwrJSWqglTc)

# xcode - 将XIB中定义的UIView加载到UIView中

> ID：13211407
> 
> 赞同：1
> 
> 时间：2012-11-03T17:04:33.517
> 
> 标签：xcode, uiview, uiviewcontroller, xib

[在此处](https://stackoverflow.com/questions/2120984/loading-xibs-into-a-uiview)显示的帖子之后，我尝试将 XIB 文件中定义的视图加载到当前正在显示的视图中。基本上，我想要做的是在用户单击按钮时用不同的视图替换中间视图（见下面的截图）。

![我的 ViewController 的布局](../Images/77624dec7507226e8dec745d8615f742.png)

这是我要加载到中间视图的简单视图：

![在此处输入图像描述](../Images/49eec4b14bb8bb40b702bd346452ffff.png)

这是 ViewController 的源代码：

视图控制器.h #import

```
@interface ViewController : UIViewController
@property (strong, nonatomic) IBOutlet UIButton *loadxibButton;
@property (strong, nonatomic) IBOutlet UIView *middleView;
- (IBAction)buttonClicked:(id)sender;

@end 
```

ViewController.m #import "ViewController.h"

```
@interface ViewController ()
@end

@implementation ViewController

- (void)viewDidLoad
{
[super viewDidLoad];
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
}

- (IBAction)buttonClicked:(id)sender {
NSLog(@"click...");
NSArray *nibObjects = [[NSBundle mainBundle] loadNibNamed:@"NewMiddleContent" owner:self options:nil];
UIView *nibView = [nibObjects objectAtIndex:0];
self.middleView= nibView;
}
@end 
```

当我单击按钮时，什么也没有发生，即不会显示新视图。有人可以帮忙吗？

非常感谢基督徒

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T18:09:09.183

菲利普，非常感谢！

代替

```
- (IBAction)buttonClicked:(id)sender {
NSArray *nibObjects = [[NSBundle mainBundle] loadNibNamed:@"NewMiddleContent" owner:self options:nil];
UIView *nibView = [nibObjects objectAtIndex:0];
self.middleView= nibView;
} 
```

我现在使用这段代码：

```
- (IBAction)buttonClicked:(id)sender {
NSArray *nibObjects = [[NSBundle mainBundle] loadNibNamed:@"NewMiddleContent" owner:self options:nil];
UIView *nibView = [nibObjects objectAtIndex:0];

nibView.frame = CGRectMake(261, 0, 532, 748);
[[[self view] viewWithTag:2] removeFromSuperview];
[[self view] addSubview:nibView];
} 
```

这是你的意思，即这就像“最佳实践”吗？

再见克里斯蒂安

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:11:51.850

您的视图控制器有一个`view`属性，大概有三个子视图（左、中和右）。而不是仅仅在控制器中设置一个`middleView`属性，您的策略应该是更新主视图的子视图数组（删除要替换的数组并插入新的数组）。

# ruby-on-rails-3 - 能够在会话中存储姓名/电子邮件

> ID：13211413
> 
> 赞同：0
> 
> 时间：2012-11-03T17:06:03.347
> 
> 标签：ruby-on-rails-3, session

我有一个表单，我希望用户输入他们的姓名和电子邮件，它们存储在会话中。然后他们可以在聊天框中发布文本。

在我看来，要创建初始会话：

```
<%= simple_form_for(@comments, :url => guest_login_order_path(@order)) do |f| %>
        <input name="comment[new_user_comment_name]" />
        <input name="comment[new_user_comment_email]" />
        <%= f.button :submit, :value => 'Guest Signin', :class => '' %>
    <% end %> 
```

这转到我的控制器：

```
def guest_login
    @order = Order.where(:public_hash => params[:public_hash]).first
    session[:new_user_account] = params[:new_user]

    respond_to do |format|
      if session[:new_user_account]
        format.html { redirect_to @order, notice: 'Your account has been created.' }
        format.json { render json: @order, status: :created, location: @order }
      else
        format.html { render action: "invoice" }
        format.json { render json: @order.errors, status: :unprocessable_entity }
      end
    end
  end 
```

参数正确传递，但我不太确定是否正在创建 cookie。有没有办法指定一个名称，以便我可以查看它是否已创建？同样在视图中，我是否有条件查看是否存在会话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:31:52.917

Rails 会为您创建一个会话，因此您无需检查它是否存在。如果您想轻松地从会话中检索用户，您可以在应用程序控制器中创建一个辅助方法：

```
class ApplicationController < ActionController::Base
    def current_user
        @current_user ||= session[:new_user_account]
    end

    helper_method :current_user
end 
```

此方法将可用于您应用中的其他控制器和视图。

# git - 您可以将 .gitignore 文件拆分为多个文件吗？

> ID：13211416
> 
> 赞同：5
> 
> 时间：2012-11-03T17:06:05.857
> 
> 标签：git

例如，一个`.gitignore.d`片段目录而不是一个大`.gitignore`文件。

*注意：我不是在谈论`.gitignore`子目录中的文件。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T14:27:16.110

这对我也很有用。我已经考虑过（懒惰的）方法来达到类似的效果。

（似乎有一个错误的假设，即 .d/ 结构仅在特定*物理大小*下才有用 - 但当多个外部系统想要管理单个资源而没有痛苦的开销时，它纯粹是为了降低复杂性。考虑[/etc/apt /sources.list](http://manpages.debian.net/cgi-bin/man.cgi?sektion=5&query=sources.list&apropos=0&manpath=sid&locale=en) - 大多数人的 sources.list 文件少于 5 行，但每个人都明白使用合作伙伴 sources.list.d/ 结构的好处。）

回到**.gitignore** —— [etckeeper在](http://joeyh.name/code/etckeeper/)**/etc/.gitignore**中使用古老的经典解决了这个问题：

```
 # begin section managed by etckeeper (do not edit this section by hand)
  ...
 # end section managed by etckeeper 
```

这部分可以更改任何 etckeeper 软件包升级，natch。

因此，一个明显的选择是使用与此类似的子系统，并适当地识别它。在代码方面有点混乱，可能比 git-merge-line-sets，但*可以说是*一种更好的文档/更传统/更好的工作流程方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:12:31.220

不，你可能不能。但是你可以生成它，也许在你的 Makefile 中。

# matlab - 根据行数据从矩阵中查找值 (MATLAB)

> ID：13211417
> 
> 赞同：1
> 
> 时间：2012-11-03T17:06:09.237
> 
> 标签：matlab, matrix, row, lookup

我有以下内容：

```
X = [1 5; 2 5; 3 7; 4 7; 5 2; 6 7];

X =

 1     5
 2     5
 3     7
 4     7
 5     2
 6     7

b = [1;4;6];

b =

 1
 4
 6 
```

有没有办法查找值（来自 X），输入为 b，输出以下内容：

```
b1 =

 1     5
 4     7
 6     7 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:08:36.600

退房[`INTERSECT`](http://www.mathworks.com/help/matlab/ref/intersect.html)。

### 对于反对者和/或没有得到它的人：

```
[~,index] = intersect(X(:,1),b)
b1 = [b X(index,2)]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:15:15.410

如果您确定 的值`b`在 的范围内`X`：

```
c = X(b,:); 
```

或者如果第一列`X`不是`1:N`：

```
[~,idx]=ismember(b,X(:,1));
idx(idx==0)=[];
c = X(idx,:); 
```

# php - 我有 1000 行 php 会话文件，必须一一显示给用户，我想避免数据传输

> ID：13211423
> 
> 赞同：-1
> 
> 时间：2012-11-03T17:06:46.113
> 
> 标签：php, session

我有 1000 行 php 会话文件，必须一一显示给用户，我想避免或减少数据轮换。哪个是最好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:26:28.170

我不会使用会话变量来存储产品数据和避免数据。如果你想减轻重量，你可以在你的 html 文件中使用 css，你可以使用更短的函数和变量名。通常，产品数据存储在（mysql）数据库中。当您想避免使用特殊数据库时，还有适用于普通文件的 sqlite。您也可以在浏览器中压缩您的产品数据并解压缩，但现代服务器和浏览器已经支持压缩，因此只有在产品数据没有得到很好的压缩或者您使用共享的虚拟主机和/或您的管理员没有的情况下，这才有意义不想启用压缩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T19:37:19.060

通常，您只在会话数据中保留特定于用户的信息。例如，用户放入购物车的商品可以去那里。

如果您想在检索目录时减少数据库服务器的负载，那么您需要进行某种缓存。有很多选择，但最常见的是：

*   内存缓存。这在您的 Web 服务器（或者可能在附近的服务器）上作为另一个进程运行。
*   装甲运兵车。这是我个人最喜欢的简单部署。它是 PHP 的一个附加组件，但是一旦安装它，您就不必管理或观察任何额外的服务器进程。
*   文件系统。这很容易实现，并且不需要任何新软件或附加组件或流程。您所需要的只是一个可由 Web 服务器写入的目录。

基本思想是：获取目录数据的函数将：

```
Retrieve the catalog from the cache.
If the catalog is not in cache
    Get the data from the database
    Create the catalog object/array
    Save the catalog to the cache
Return the catalog 
```

使用 memcached 和 APC，数据会自动为您序列化，您可以声明希望数据缓存多长时间。一旦时间用完，数据将从缓存中消失。这样，您可以确保以合理的时间间隔从数据库中刷新您的目录。

如果您使用的是文件系统，则必须为自己做更多的工作。您必须检查缓存文件的年龄（以查看是否该刷新数据），并且您必须调用`serialize()`并将`unserialize()`数据对象转换为可保存的字节流并再次返回。

当您呈现 HTML 页面时，您只需将信息放入用户将看到的信息中。通常不需要一次性将整个目录发送给用户。

如果目录很大，那么您可能会考虑将目录中的各个项目缓存在单独的缓存条目中，而不是将整个内容放入缓存中。你真的必须判断“太大”有多大。通常，网络 I/O 是 Web 服务器和数据库的大延迟问题，因此您可以从磁盘读取数量惊人的数据而不会出现任何性能下降（在您注意到任何东西之前超过一百 KB）。

# html - 具有交替行颜色的内边框和外边框

> ID：13211425
> 
> 赞同：1
> 
> 时间：2012-11-03T17:07:00.507
> 
> 标签：html, css

鉴于下面的当前 css 编码，我如何能够执行以下操作：

1.  修复表格，使表格标题中只有 1px 实心 FFF 的内部边框。
2.  修复表格标题，使缺少的右边框完成。
3.  在表格标题之后放置一个 1px 实心 #6B6B6B 的上边框（因为它似乎丢失了，我不知道如何修复它，我也在使用 IE 9）
4.  从第一行（不是表头）开始交替行颜色（白色），然后在第二行（灰色）。

我只是 CSS 新手，不熟悉高级编程。

这是一个小提琴：http: [//jsfiddle.net/3CzbV/](http://jsfiddle.net/3CzbV/)

```
<!DOCTYPE html>
<html>

<head>

<style type="text/css">
table {
    border-collapse: collapse;
    border: 1px solid #6B6B6B;
}
table th {
    color: red;
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=#cccccc, endColorstr=#ffffff);
}
table td {
    color: blue;
}
table td, table th {
    border: 1px solid #6B6B6B;
}
table tr:first-child th {
    border-top: 0;
}
table tr:last-child td {
    border-bottom: 0;
}
table tr td:first-child,
table tr th:first-child {
    border-left: 0;
}
table tr td:last-child,
table tr th:last-child {
    border-right: 0;
}
</style>

</head>

<body>

<table>
    <tr>
        <th>Heading 1</th>
        <th>Heading 2</th>
        <th>Heading 3</th>
        <th>Heading 4</th>
    </tr>
    <tr>
        <td>Cell (1,1)</td>
        <td>Cell (2,1)</td>
        <td>Cell (3,1)</td>
        <td>Cell (4,1)</td>
    </tr>
    <tr>
        <td>Cell (2,1)</td>
        <td>Cell (2,2)</td>
        <td>Cell (3,2)</td>
        <td>Cell (4,2)</td>
    </tr>
    <tr>
        <td>Cell (3,1)</td>
        <td>Cell (2,3)</td>
        <td>Cell (3,3)</td>
        <td>Cell (4,3)</td>
    </tr>
</table>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:42:20.977

所以首先，这是小提琴[http://jsfiddle.net/EVjJU/2/](http://jsfiddle.net/EVjJU/2/)

```
/*color different tbody rows*/
tbody tr:nth-child(odd) {
    background-color: #ffffff;
}
tbody tr:nth-child(even) {
    background-color: #cccccc;
}
/*first tbody row with a top border*/
tbody tr:first-child td {
    border-top: 5px #ffffff solid;    
}
/*there is no right border missing to my knowledge?*/
/*thead inner border or 1px white*/
thead th {
    border-right: 1px #ffffff solid;
} 
```

我不太明白标题部分缺少右边框，你能详细说明一下吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:42:34.480

首先，您应该添加`<thead>`and`<tbody>`元素/标签，甚至可能添加`<tfoot>`

**HTML 标记**

```
<div>
<table>
    <thead>
    <tr>
        <th>Heading 1</th>
        <th>Heading 2</th>
        <th>Heading 3</th>
        <th>Heading 4</th>
    </tr>
</thead>
    <tbody>
    <tr>
        <td>Cell (1,1)</td>
        <td>Cell (2,1)</td>
        <td>Cell (3,1)</td>
        <td>Cell (4,1)</td>
    </tr>
    <tr>
        <td>Cell (2,1)</td>
        <td>Cell (2,2)</td>
        <td>Cell (3,2)</td>
        <td>Cell (4,2)</td>
    </tr>
    <tr>
        <td>Cell (3,1)</td>
        <td>Cell (2,3)</td>
        <td>Cell (3,3)</td>
        <td>Cell (4,3)</td>
    </tr>
</tbody>
</table>
</div> 
```

**风格**

```
div{
    background-color: grey;
    margin: 20px;
    padding: 10px;
}

table {
    border-collapse: collapse;
    border: 1px solid #6B6B6B;
    margin: 20px;
}

/* 1.Fix the table such that there is an INNER border only of 1px solid FFF in the table headers*/
/* 2.Fix the table header such that the missing right border is completed */

table thead tr th {
    border: 1px solid #FFF;

/* 3.Put a top border of 1px solid #6B6B6B after the table headers */
    border-bottom: 1px solid #6B6B6B; 
}

table tbody tr:nth-child(odd) {
background-color: white;
} 
```

[小提琴](http://jsfiddle.net/3CzbV/28/)

# php - 如果有前导数字，则删除括号内的数字

> ID：13211427
> 
> 赞同：0
> 
> 时间：2012-11-03T17:07:02.013
> 
> 标签：php, regex

我有多种类型的字符串。如果`number text (text)`我想删除括号内的内容。否则不行。

这将删除始终在括号内的所有内容。

```
/\((.*?)\)/ 
```

如何检查前导号码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:14:08.817

`\d`匹配任何数字。还有一个比使用不贪婪的重复更好的方法：

```
/\d\s*\(([^)]*)\)/ 
```

如果空格是强制性的，请使用：

```
/\d\s+\(([^)]*)\)/ 
```

如果您**不想**在 的情况下匹配`a1 (text)`，请使用：

```
/\b\d+\s*\(([^)]*)\)/ 
```

但是，对于删除，匹配括号周围的内容可能更容易（我以第一个正则表达式为例，但这可以应用于所有三种情况）：

```
$str = preg_replace('/(\d\s*)\([^)]*\)/', '$1()', $str); 
```

对于第一种情况（如果`text`in`a1 (text)`也应该删除），并且如果您将空格数量限制为一个，您还可以使用稍微更有效的变体，使用后向：

```
$str = preg_replace('/(?<=\d\s)\([^)]*\)/', '()', $str); 
```

后视不包括在匹配中，因此不需要捕获。不幸的是，对于 PCRE，后视必须是固定长度的，这就是为什么您不能将其与`\d+`或一起使用的原因`\s*`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:16:17.257

Use this regex

```
(\d[^\(\)]*?\().*?(\))
    ^           ^   ^
    |           |   |->2nd group matches )
    |           |->matches content within ()
    |->1st group would match a digit followed by 0 to many characters(except ())followed by ( 
```

and replace it with

```
$1$2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T17:44:48.350

一起去

```
$s = preg_replace('/(?<=\d)\s*\([^)]*\)/', '', $s); 
```

# python - Python评论板postreview - KeyError：review_request

> ID：13211428
> 
> 赞同：1
> 
> 时间：2012-11-03T17:07:06.643
> 
> 标签：python, dictionary

我有一个 ReviewBoard **v1.6.13**网站设置，以便我可以使用它通过 Perforce 使用 post-review 来托管审查请求。
我已使用以下命令将 [RBTools v0.4.2] 中的**postreview.py** python 脚本编译为**postreview.exe**：

*   Python v2.7.3
*   Python Win32 扩展 pywin32-218.win32-py2.7.exe
*   PyInstaller v2.0
*   （还下载了 DiffUtils v2.8.7-1 来测试 postreview 工具）

但是，当我运行 postreview.exe（甚至直接运行 .py 脚本）时，我不断得到相同的 python 调用堆栈：

```
Traceback (most recent call last):
    File "F:\RBTools-0.4.2\rbtools\postreview.py", line 1314, in <module>
        main()
    File "F:\RBTools-0.4.2\rbtools\postreview.py", line 1296, in main
        submit_as=options.submit_as)
    File "F:\RBTools-0.4.2\rbtools\postreview.py", line 862, in tempt_fate
        review_request = server.new_review_request(changenum, submit_as)
    File "F:\RBTools-0.4.2\rbtools\postreview.py", line 441, in new_review_request
        return rsp['review_request']
    KeyError: 'review_request' 
```

我用于测试的论点（由于明显的原因略有改变）：

`--server=http://myreviewboardsite --disable-proxy --submit-as=jdoe --publish --target-groups=Test --branch=//mydepot/test/ 191205 --debug --username=guest --password=helloworld`

`--debug`这是使用参数 后的完整输出。

```
>>> RBTools 0.4.2
>>> Python 2.7.3 (default, Apr 10 2012, 23:31:26) [MSC v.1500 32 bit (Intel)]
>>> Running on Windows-7-6.1.7600
>>> Home = C:\Users\misterwilson\AppData\Roaming
>>> Current Directory = F:\pyinstaller-2.0\postreview\dist
>>> Checking the repository type. Errors shown below are mostly harmless.
DEBUG:root:Checking for a CVS repository...
DEBUG:root:Checking for a ClearCase repository...
DEBUG:root:Checking for a Git repository...
DEBUG:root:Checking for a Mercurial repository...
DEBUG:root:Checking for a Perforce repository...
DEBUG:root:Running: p4 info
DEBUG:root:Running: diff --version
DEBUG:root:repository info: Path: p4-devserver:1666, Base path: None, Supports changesets: True
>>> Finished checking the repository type.
>>> Disabling HTTP(s) proxy support
>>> HTTP GETting api/
>>> HTTP GETting http://myreviewboardsite/api/info/
>>> Using the new web API
INFO:root:Generating diff for changenum 191205
DEBUG:root:Running: p4 describe -s 191205
DEBUG:root:Processing edit of //mydepot/test/HelloWorld.xml
DEBUG:root:Writing "//mydepot/test/HelloWorld.xml#12" to "c:\users\misterwilson\appdata\local\temp\tmp_knbys"
DEBUG:root:Running: p4 print -o c:\users\misterwilson\appdata\local\temp\tmp_knbys -q //mydepot/test/HelloWorld.xml#12
DEBUG:root:Running: diff -urNp c:\users\misterwilson\appdata\local\temp\tmp_knbys F:\P4\1666\mydepot\test\HelloWorld.xml
DEBUG:root:Command exited with rc 1: ['diff', '-urNp', 'c:\\users\\misterwilson\\appdata\\local\\temp\\tmp_knbys', 'F:\\P4\\1666\\mydepot\\test\\HelloWorld\\LauncherVirtuos.xml']
--- c:\users\misterwilson\appdata\local\temp\tmp_knbys       2012-11-03 11:27:03.854484100 -0400
+++ F:\P4\1666\mydepot\test\HelloWorld.xml  2012-10-25 18:47:36.736320400 -0400
@@ -295,7 +295,7 @@ ´╗┐<?xml version="1.0" encoding="utf-8"
           goto REMOVEOUTPUT
         </if>
   </operation>
-      <operation name="VerifyPerforceClient" visible="0">
+      <operation name="VerifyPerforceClient" visible="0">
                 p4 clients -u [PerforceUsername] -e "[PerforceClientSpec]" | find "[PerforceClientSpec]" > nul
                 if not errorlevel 1 (
                 goto ChkHost
@@ -344,18 +344,18 @@ ´╗┐<?xml version="1.0" encoding="utf-8"

         :VERIFY_END
       </operation>

... More Perforce Diff output

---
>>> Attempting to create review request on p4-devserver:1666 for 191205
>>> Submitting the review request as jdoe
>>> HTTP POSTing to http://myreviewboardsite/api/review-requests/: {'changenum': '191205', 'submit_as': 'jdoe', 'repository': 'p4-devserver:1666'}
>>> Review request created
Traceback (most recent call last):
  File "F:\RBTools-0.4.2\rbtools\postreview.py", line 1314, in <module>
    main()
  File "F:\RBTools-0.4.2\rbtools\postreview.py", line 1296, in main
    submit_as=options.submit_as)
  File "F:\RBTools-0.4.2\rbtools\postreview.py", line 862, in tempt_fate
    review_request = server.new_review_request(changenum, submit_as)
  File "F:\RBTools-0.4.2\rbtools\postreview.py", line 441, in new_review_request

    return rsp['review_request']
KeyError: 'review_request' 
```

谁能帮我解决问题可能是什么？

谢谢，

W先生

# php - 通过将值添加到数据库中来创建“anti-botting”系统

> ID：13211432
> 
> 赞同：0
> 
> 时间：2012-11-03T17:07:16.777
> 
> 标签：php, database

我不知道如何使它工作，所以我目前只是在寻找想法，让我解释一下我想做什么；假设我有一个名为“click”的按钮。每次我按下此按钮时，它都会向数据库添加 1，因此当我按下 10 次时，它会在名为“clicks”的数据库列中保存值“10”。不过这已经做好了。我只需要一些可以检查我按下按钮 10 次的速度来制作防僵尸系统。所以我认为在数据库中创建一个名为“时间”的列，这个“时间”列每 10 秒重置一次，并在每次按下“单击”按钮时向该列添加 1。然后我可以像这样在我的 PHP 脚本中做一些事情：如果时间 > 200 删除用户等。

因此，如果某人应该能够在重置之前获得 200 上的“时间”列，那么它一定是机器人按下，因为它不像人类那样在 10 秒内按下那么多次。

我已经阅读了一些关于 TIMESTAMP 和 INTERVAL 的内容，但我无法按照我的想法理解它。我只需要一个列，它会在一段时间后删除其中的所有数据。

欢迎任何建议！提前致谢。

我已经用代码走了这么远：

```
if (isset($_POST['djahff'])) { // The button
require_once('connectvars.php'); // The DB connection
    $dbc = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
    $idsession = $_SESSION['id'];
    $result = mysqli_query($dbc, "INSERT INTO pbclickslogin SET cps=1, id='$idsession' ON DUPLICATE KEY UPDATE cps=cps+1"); // Adding 1 to the column "cps" where username=$username

    $data = mysql_query("SELECT TIMESTAMPDIFF(SECOND, NOW(), mark) > 10 FROM pbclickslogin WHERE username='$username'") // Checking if the difference from mark and now is 10 seconds I assume?
    or die(mysql_error());
while($info = mysql_fetch_array( $data )) {
$result = mysqli_query($dbc, "UPDATE pbclickslogin SET cps='0', mark=NOW() WHERE username='$username'"); // Updating cps and mark because the difference from mark and now was 10 seconds.
 }
} 
```

每次按下按钮时网站都会更新，这是一个输入类型为“提交”的按钮。

嗯，我并没有完全理解你的算法，但我认为这是因为我的代码发布错误。对不起，我还是这个论坛的新手。无论如何，我想我在这里有更新声明等？是否仍然存在您之前提到的相同问题？

附言。感谢您注意到我关于论坛格式的信息

我现在添加了更多代码：

```
if ($info[0] == 1) {
    $result = mysqli_query($dbc, "UPDATE pbclickslogin SET cps='0', mark=NOW() WHERE username='$username'"); // Updating cps and mark because the difference from mark and now was 10 seconds.
} 
```

但是，代码现在永远不会更新。我也尝试过 ($info['0'] == 1) 但不幸的是没有运气。除此之外我现在还不太明白，$info[0] 是什么？它是否在数据库中找到了 0 或其他东西？我通常只在调用列时使用 $info。再次感谢人:)

添加了另外一些更改，我们现在得到的代码如下：

```
if (isset($_POST['djahff'])) { // The button

require_once('connectvars.php'); // The DB connection
    $dbc = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
    $idsession = $_SESSION['id'];
    $result = mysqli_query($dbc, "INSERT INTO pbclickslogin SET cps=1, id='$idsession' ON DUPLICATE KEY UPDATE cps=cps+1"); // Adding 1 to the column "cps" where username=$username

    $data = mysql_query("SELECT TIMESTAMPDIFF(SECOND, mark, NOW() ) > 10 FROM pbclickslogin WHERE id='$idsession';") // Checking if the difference from mark and now is 10 seconds I assume?
    or die(mysql_error());
while($info = mysql_fetch_array( $data )) {
if ($info[0] == 1) {
    $result = mysqli_query($dbc, "UPDATE pbclickslogin SET cps='0', mark=NOW() WHERE id='$idsession'"); // Updating cps and mark because the difference from mark and now was 10 seconds.
}
 }
} 
```

到 Algomorph：顺便说一下，你为什么将 NOW() ) > 10 更改为 NOW() ) > 1000？另外：我现在遇到的问题是，当我按下按钮“djahff”时，它会更新时间戳“mark”而不是整数“cps”。

谢谢:-) - 我们越来越近了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T15:54:48.747

if (isset($_POST['djahff'])) { // 按钮

```
require_once('connectvars.php'); // The DB connection
    $dbc = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
    $idsession = $_SESSION['id'];
    $result = mysqli_query($dbc, "INSERT INTO pbclickslogin SET cps=1,       id='$idsession' ON DUPLICATE KEY UPDATE cps=cps+1"); // Adding 1 to the column "cps" where username=$username

    $data = mysql_query("SELECT TIMESTAMPDIFF(SECOND, NOW(), mark) > 10 FROM pbclickslogin WHERE username='$username'") // Checking if the difference from mark and now is 10 seconds I assume?
    or die(mysql_error()); 
```

while($info = mysql_fetch_array( $data )) { $result = mysqli_query($dbc, "UPDATE pbclickslogin SET cps='1', mark=NOW() WHERE username='$username'"); // 更新 cps 和 mark 因为与 mark 和 now 相差 10 秒。} }

这是我从 Algomorph 告诉我的内容中理解的代码。问题只是用户在这 10 秒后多次单击“djahff”按钮。每次按下按钮时，“标记”列都会更新回现在的时间。

除此之外每次都可以正常工作:)有什么建议吗？
@Algomorph

*   彼得

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:32:22.807

我不确定您使用的是哪个 DBMS，但您可以完全按照以下方式进行描述。制作两列：

*   整数 [点击次数]
*   时间戳[标记]

当用户单击时，选中 [mark] 并将其与当前日期和时间进行比较。如果相差超过 10 秒，将 [clicks] 设置为 1 并标记为当前日期和时间（mysql 中的 NOW() 函数，PostgreSQL 中的 current_timestamp() 函数）。

否则，请检查 [clicks]。如果超过 200，则将用户踢出。否则，将其加一。

# ruby - 如何在 ruby 的类中使对象可访问？

> ID：13211438
> 
> 赞同：-1
> 
> 时间：2012-11-03T17:07:28.760
> 
> 标签：ruby

我尝试了以下方法：

```
require "socket"

class IRC
def initialize(server, port=6667, user='ruby-bot')
    @server = server
    @port = port
    @user = user
end

def connect!
    @s = TCPSocket.open(@server, @port) #connect
    raise "Couldn't connect to #{@server}:#{@port}" unless @s #error handling
    @s.puts "USER #{@user} +B :IRC Ruby Bot" #set modes etc
end 

def nick(nick=nil)
    @s.puts "NICK #{@nick}"
end

def join(channel)
    @s.puts "JOIN #{channel}"
end
end 
```

接着：

```
#!/usr/bin/ruby
require './irc.rb'

print 'Server: '
server = gets
print 'Port (6667): '
port = gets

if port.match(/^\n/)
port = '6667'
end

bot = IRC.new(server, port)
bot.nick 'fbot1830'
bot.join '#myowntestchannel' 
```

我收到以下错误：

```
./irc.rb:17:in `nick': private method `puts' called for nil:NilClass (NoMethodError) from ./bot.rb:14 
```

这是我第一次尝试用 ruby​​ 编写自定义类，请耐心等待，我希望我的错误不会太微不足道；）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T17:14:25.413

`@s`在方法中初始化`connect!`，但从不调用该方法，因此在方法中`@s`计算为。`nil``nick`

# php - SQL 将数据从一列复制到另一表指定列

> ID：13211439
> 
> 赞同：4
> 
> 时间：2012-11-03T17:07:32.420
> 
> 标签：php, mysql, sql, database

我有两个名为**`order`**and的表名**`order_product`**，两个表都有一个同名的列`model`，`order_product` `model`列有很多数据，但`order` `model`字段为空。

`model`我想将数据从一个表复制`order_product`到`model`另一个表`order`，我该怎么做。？

我尝试了一些 SQL 查询，但结果并不像我想要的那样，它看起来所有字段都是重复的......

```
INSERT INTO `order` (model) SELECT (model) FROM `order_product` 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T17:16:39.573

Try to use `DISTINCT` to eliminate duplicate rows in the `SELECT` clause like so:

```
INSERT INTO `order` (model) 
SELECT DISTINCT model FROM `order_product`; 
```

## [SQL Fiddle Demo](http://sqlfiddle.com/#!2/49d61/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T17:20:01.687

```
INSERT INTO order (model)
SELECT model FROM order_product
WHERE 'some field' = (some condition) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T17:12:41.847

```
INSERT INTO table1 ( column1 )
SELECT  col1
FROM    table2 
```

这应该适用于你的问题？请让我知道你想要的输出是什么，除非我会更新答案

通过看到你的评论

```
INSERT INTO table1 ( column1 )
SELECT distinct(col1)
FROM    table2 
```

# php - 如何在url中插入多个复选框值

> ID：13211442
> 
> 赞同：0
> 
> 时间：2012-11-03T17:08:15.477
> 
> 标签：php, javascript, ajax

我有一个包含多个复选框的表单，我想像这样将复选框的值插入到 url

```
var a=encodeURIComponent(document.getElementById("idofcheckbox").value)
xmlhttp.open("GET","InsertPHPData.php?q="+a+,true); xmlhttp.send(); 
```

choix1
choix2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:28:50.167

尝试这个：

```
var x = document.getElementsByTagName("input");

var params = [];
for (var i = 0; i < x.length; i++) {
    if (x[i].type === "checkbox") //&& x[i].checked === true 
        params.push(x[i].name + "+" + x[i].value);
}

var url = "InsertPHPData.php";
url += "?" + encodeURI(params.join(","));

alert(url)​ 
```

工作[小提琴](http://jsfiddle.net/2xRbn/3/)。请相应修改:)

# wpf - Microsoft.Practices.ServiceLocation.ServiceLocator 有什么作用？

> ID：13211443
> 
> 赞同：1
> 
> 时间：2012-11-03T17:08:23.527
> 
> 标签：wpf, prism, unity-container

我知道这听起来很蹩脚，但 MSDN 上似乎有一堆空洞的信息。喜欢这个链接[ServiceLocator](http://msdn.microsoft.com/en-us/library/microsoft.practices.servicelocation.servicelocator%28v=pandp.51%29.aspx)。我刚刚使用 Unity 和 Prism 进行了一个项目。我在一些像这样传入 WPF UserControl 的代码中找到了它

```
var alert = ServiceLocator.Current.GetInstance<AlertControl>(); 
```

这像 Unity 的决心吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:17:38.453

[http://commonservicelocator.codeplex.com/](http://commonservicelocator.codeplex.com/)

从项目描述：

> Common Service Locator 库包含一个用于服务定位的共享接口，应用程序和框架开发人员可以引用该接口。该库提供了对 IoC 容器和服务定位器的抽象。使用该库允许应用程序在不依赖硬引用的情况下间接访问这些功能。希望使用这个库，第三方应用程序和框架可以开始利用 IoC/服务位置，而无需将自己束缚于特定的实现。

这种抽象是由几个 IoC 框架实现的，Unity 就是其中之一。然而，Unity 不是该项目的所有者。

例如，通过这种方式，StructureMap 提供了这些类的实现，因此其他框架（例如来自模式和实践的 Prism）可以轻松地与其他 IoC 框架一起使用，而不必绑定到 Unity 本身。

# matlab - MATLAB：在频谱图上绘制一条线并显示一个新的 yscale

> ID：13211444
> 
> 赞同：1
> 
> 时间：2012-11-03T17:08:31.773
> 
> 标签：matlab, matlab-figure, spectrogram

我想在频谱图上叠加一条线（使用 imagesc 绘制）。我无法使用“hold on”命令执行此操作。我还想显示我在频谱图上绘制的线的比例。（注意：频谱图已经在图的左侧显示了频率值的 yscale，我希望新行的 yscale 显示在右侧）

MATLAB 的在线文档显示了一种在具有两个 y 轴的单个图中绘制函数的方法......但这似乎不适用于 imagesc [http://www.mathworks.com/help/matlab/ref/plotyy.html](http://www.mathworks.com/help/matlab/ref/plotyy.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T02:47:24.830

只需使用`hold on`... 这是一个示例：

```
% generate some figure;
imagesc(); 
hold on
x=1:0.1:70; % just some vector that fits the size of imagesc
plot(x,35+10*sin(x),'k'); 
```

![在此处输入图像描述](../Images/0141b1e09cd6fda3b1eb180d464b9f9a.png)

# javascript - javascript变量总是未定义

> ID：13211445
> 
> 赞同：0
> 
> 时间：2012-11-03T17:08:32.107
> 
> 标签：javascript, variables, redirect

当我想重定向时，变量**where**总是 udefined。但是，例如，我想将该变量放入`alert();`其中显示正确的数字。

代码

```
var where = msg.txt;
window.location = "/page.php?id=".where; //this redirects to /page.php?id=undefined
alert(where); //it show correct number 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T17:10:28.777

它应该是：

```
window.location = "/page.php?id=" + where; 
```

你有：

```
"/page.php?id=".where; 
```

它试图检索`where`字符串的属性，但尚未定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:10:55.840

在 JavaScript 中，`.`用于属性访问，而不是像 PHP 中那样用于字符串连接。

改用`+`：

```
window.location = "/page.php?id=" + where; 
```

# android - Android - Windows Live API，用户每次都必须登录？

> ID：13211448
> 
> 赞同：2
> 
> 时间：2012-11-03T17:08:49.460
> 
> 标签：android, oauth-2.0, live, windows-live, windows-live-id

我正在尝试将我的应用程序的状态提交到 Window 的 live，用户启动应用程序，被要求授予我的应用程序执行此操作的权限，一旦被授予我有一个实时会话对象，我可以更新他们的状态。这完美地工作。但是，如果用户关闭应用程序然后再次打开它，他们会再次被要求批准我的应用程序执行此操作。每次。

现在实时文档说您可以获得一个刷新令牌（我这样做）来防止这种情况，问题是访问令牌和刷新令牌都在 LiveConnectSession 中烘焙，所以当我的应用程序关闭时，这个对象被破坏并且用户是要求再次授予应用程序权限。

所以我想知道的是，是否有人知道在应用程序启动时重新创建该对象的方法（如果我存储了令牌和刷新令牌）或保存对象 onDestroy()..

```
Iterable<String> scopes = Arrays.asList("wl.signin", "wl.share", "wl.offline_access" );
this.auth.login(this, scopes, this);

public void onAuthComplete(LiveStatus status, LiveConnectSession session, Object userState) {
    if(status == LiveStatus.CONNECTED) {
        Log.d("", "Signed in.");
        client = new LiveConnectClient(session); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T18:46:35.367

使用 Windows Phone 时遇到了同样的问题。我尝试序列化会话，但由于会话类没有默认构造函数，这不起作用。

编辑：在整整两天寻找我所犯的错误之后，我终于发现我做错了什么：我必须使用 wl.offline_access 范围来完成这项工作！

现在一切又变得有趣了。不敢相信这是问题所在。测试和工作。好的！

正如我所看到的，您正在使用离线范围，所以这对您来说不是问题。

但是我发现了更多：有两种方法可以连接到 Live（在 C# 中，我不知道这些方法在 Java 中是如何调用的）：

*   使用 LiveConnectClient.LoginAsync（GUI 自带）
*   使用 LiveConnectClient.InitializeAsync （这是 UI 少，在后台连接）

因此，如果您的应用程序已经连接，请使用第二个来访问新的会话对象。AFAIK，此对象有效期为一年，之后，用户必须重新登录。但不要引用我的话。

请让我知道这是否适合您。

# sass - Sass 多态导航栏问题

> ID：13211451
> 
> 赞同：0
> 
> 时间：2012-11-03T17:09:08.080
> 
> 标签：sass, compass-sass

我有一个导航栏，其中的按钮具有悬停状态，但也需要在各自的页面上处于“活动状态”。由于此导航栏是包含的一部分，因此我决定通过 body 标记上的类来执行活动状态，如`.dashboard .dashboard-button`. 所以我有悬停和这个。

我试图找出使用 Sass/Compass 的最简化的方法。我创建了几个mixin：

```
@mixin nav-button-on($icon) {
    background-color: #2f3684; // Old browsers
    @include filter-gradient($offwhite, #E5E5E5, vertical); // IE6-9
    @include background-image(url('../images/'+$icon+'-on.png'),linear-gradient(top, $offwhite 0%, #E5E5E5 100%));
    border-bottom: $borderbottom solid #F31A35;
    a { color: $red;}
}
@mixin nav-button($icon){
    background-color: #fff; // Old browsers
    @include filter-gradient(#fff, #fff, vertical); // IE6-9
    @include background-image(url('../images/'+$icon+'.png'),linear-gradient(top, #fff 0%, #fff 100%));
} 
```

然后在定义按钮的LI中，我有

```
 li {
 &.dashboard { 
            @include nav-button('dashboard'); 
        }
        .dashboard &.dashboard { 
            @include nav-button-on('dashboard'); 
            &:hover {
                 @include nav-button-on('dashboard'); 
            }
        }
} 
```

HTML：

```
<body class="dashboard">
<div id="nav">
    <ul>
    <li class="first dashboard"><a href="/index.php">Dashboard</a></li>
    <li class="challenges"><a href="/challenges.php">Challenges &amp; Teams</a></li>
    <li class="goals"><a href="/goals.php">Goals</a></li>
    <li class="activity"><a href="/my-activity.php">My Activity</a></li>
    <li class="destinations"><a href="/destinations.php">Destinations</a></li>
    <li class="fitness last"><a href="/fitness-resources.php">Fitness Resources</a></li>
</ul>
</div> 
```

这似乎有点令人费解，我想知道是否有人有任何建议来简化这一点。

注意：我必须添加白到白渐变，因为当悬停在具有渐变悬停状态的纯色背景上时会导致闪烁。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:53:21.903

这里有很多需要改进的地方：

1.  你真的在处理`dashboard`类的层次结构吗？例如，您当前正在编译为：

    ```
    li.dashboard {
        ...
    }
    li .dashboard li.dashboard {
        ...
    } 
    ```

    这似乎是错误的，或者至少结构不佳。也许你可以在这里简化事情。

2.  假设您的每个导航`<li>`元素都需要它，请使用迭代的 mixin 将其干燥：

    ```
    li {
        @each $item in dashboard, challenges, goals, activity, destinations, fitness {
            &.#{$item} { 
                @include nav-button($item); 
            }
            .#{$item} &.#{$item} { 
                @include nav-button-on($item); 
                &:hover {
                    @include nav-button-on($item); 
                }
            }
        }
    } 
    ```

3.  但是＃2实际上并不是最好的方法。对这类东西使用占位符而不是 mixins，或者将两者结合起来。我会做这样的事情：

    ```
     %nav-button {
            background-color: #fff; // Old browsers
            @include filter-gradient(#fff, #fff, vertical); // IE6-9
        }

        %nav-button-on {
            background-color: #2f3684; // Old browsers
            @include filter-gradient($offwhite, #E5E5E5, vertical); // IE6-9
            border-bottom: $borderbottom solid #F31A35;
            a { color: $red;}
        }

        @mixin li-image($icon) {
            @include background-image(url('../images/'+$icon+'.png'),linear-gradient(top, #fff 0%, #fff 100%));
        }

        @mixin li-image-on($icon) {
            @include background-image(url('../images/'+$icon+'-on.png'),linear-gradient(top, $offwhite 0%, #E5E5E5 100%));
        }

        @each $item in dashboard, challenges, goals, activity, destinations, fitness {
            body.#{$item} li, li.#{$item}:hover {
                @extend %nav-button-on;
                @include li-image-on($item);
            }
            li.#{$item} {
                @extend %nav-button;
                @include li-image($item);
            }
        } 
    ```

比较这些的输出和可维护性，我想你会发现这更加精简！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-03T17:26:42.800

你有错`}`之后`@include nav-button('dashboard');`

试试看：

```
li {  
    &.dashboard {   
        @include nav-button('dashboard');  
        .dashboard &.dashboard {   
            @include nav-button-on('dashboard');     
            &:hover {  
                @include nav-button-on('dashboard');   
            }  
        }  
    }  
} 
```

# c++ - 告诉 LLDB 忽略文件

> ID：13211452
> 
> 赞同：5
> 
> 时间：2012-11-03T17:09:10.293
> 
> 标签：c++, lldb

有没有办法告诉 LLDB 忽略文件，即在调试时跳过该文件中的代码？

（这可以用作[1](https://stackoverflow.com/questions/12439318/debug-issues-with-libc-in-xcode-4-4 "1")、[2](https://stackoverflow.com/questions/12651441/debugger-steps-deeper-when-trying-to-step-out-of-c11-std-lib)、[3](https://stackoverflow.com/questions/13099916/stepping-through-the-code-is-stopping-on-stl-code-when-debugging-c-with-xcode?lq=1)的解决方法）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T20:45:39.293

有一个设置可以避免进入名称与正则表达式匹配的函数，

```
(lldb) set list target.process.thread.step-avoid-regexp
step-avoid-regexp -- A regular expression defining functions step-in won't stop in. 
```

例如把它放在你的`~/.lldbinit`文件中

```
settings set target.process.thread.step-avoid-regexp ^[^ ]+ std::|^std:: 
```

但在 Xcode 4.5.x 中这是可以做到的最好的。我在您的链接的#2 中提到，内联步进支持已添加到[http://lldb.llvm.org/](http://lldb.llvm.org/)的 LLDB 源中，但直到下一个版本才会出现在 Xcode 中。

# css - CSS：怎么说 .class:last-of-type [类，不是元素！]

> ID：13211453
> 
> 赞同：91
> 
> 时间：2012-11-03T17:09:10.810
> 
> 标签：css, css-selectors

> **可能重复：**
> [如何在 CSS 中选择具有特定类名的“最后一个孩子”？](https://stackoverflow.com/questions/6401268/how-do-i-select-the-last-child-with-a-specific-class-name-in-css)

正如标题所说，我想将 css 规则处理到具有特定类的特定类型的最后一个元素。以下代码完美运行：

```
div:last-of-type { margin-right:0; } 
```

但我想要类似的东西

```
div.class:last-of-type { margin-right:0; } 
```

这个怎么做 ？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-11-03T17:28:57.453

不幸的是，找到最后一个`.class`是不可能的`last-of-type`。

**编辑**：要真正为这个答案添加一些建设性的东西，你可以回退到 JavaScript 来定位这个选择器，或者修改你的标记/CSS。虽然我发现自己处于`last-of-type`类选择器会很有用的情况，但只要多考虑一下，就没有什么可以解决的了。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-11-03T17:43:02.890

将 nomargin 设为 css 类，您可以轻松更改它：

```
var items = document.getElementsByClassName('nomargin');
items[items.length-1].style.color = 'black';
items[items.length-1].style.background = 'white'; 
```

或者如果[没有足够的 jQuery](http://i.stack.imgur.com/ssRUr.gif)，你可以使用：

```
jQuery('div.nomargin:last').css({
    color:'black',
    background:'white'}) 
```

# c - 我的 linux 下 c prog 有什么问题：“ls -al | tr az AZ > file.txt”？

> ID：13211455
> 
> 赞同：4
> 
> 时间：2012-11-03T17:09:19.990
> 
> 标签：c, linux

我对linux很陌生，所以。我无法让我的脚本工作。我只是在猜测，程序在执行 tr 函数时会暂停。

```
#include <fcntl.h>
#include <stdio.h>
#include <unistd.h>

int main()
{

int pdesc[2];
pipe(pdesc);

int a = fork();

if (a == 0) // child
    {

    dup2(pdesc[1],1); // chaning std_out to pipes_out
    execlp("ls", "ls", "-l", "-a", NULL);

    }
else       //parent
    {
    wait();
    int file1 = open("file.txt", O_WRONLY|O_CREAT|O_TRUNC,0777);
    dup2(pdesc[0], 0); // chaning std_in to pipes_in
    dup2(file1, 1); // chaning std_out to file's stream
    execlp("tr", "tr", "a-z", "A-Z", NULL);
    }

return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T17:28:11.307

经典错误，所以，好问题。

您需要关闭父级和子级中未使用的管道文件描述符。

从管道读取的进程（本身）有一个打开的管道写入端，因此管道永远不会完全关闭，因此它永远不会传递 EOF。

此外，`wait(2)`导致死锁，程序不包含`<sys/wait.h>`，并且调用`wait(2)`缺少必需的参数。因为 shell 会等待父进程而不是子进程完成，所以实际上，`wait(2)`在这里某个地方打个电话会很好。但是在当前的双进程设计中你没有地方放它，因为你在父级的`execlp(2)`. 解决这个问题的一种方法是让父 fork() 再次，并让原始 PID 除了 wait(2) 在循环中执行任何操作，直到所有子进程完成。

这是一个工作版本，还要注意对输出文件模式的更改。

```
#include <fcntl.h>
#include <stdio.h>
#include <unistd.h>

int main()
{
int pdesc[2];

    pipe(pdesc);

    int a = fork();

    if (a == 0) { // child
        dup2(pdesc[1],1); // chaining std_out to pipes_out
        close(pdesc[1]);
        close(pdesc[0]);
        execlp("ls", "ls", "-l", "-a", NULL);
    } else {      //parent
        int file1 = open("file.txt", O_WRONLY|O_CREAT|O_TRUNC, 0644);
        dup2(pdesc[0], 0); // chaning std_in to pipes_in
        dup2(file1, 1); // chaning std_out to file's stream
        close(pdesc[0]);
        close(pdesc[1]);
        close(file1);
        execlp("tr", "tr", "a-z", "A-Z", NULL);
    }
    return 0;
} 
```

# security - Symfony2：安全/路由问题

> ID：13211458
> 
> 赞同：0
> 
> 时间：2012-11-03T17:09:31.653
> 
> 标签：security, symfony

我在 Symfony 2.1.3 上使用 FOSFacebookBundle 和 FOSUserBundle。我的安全设置有一些问题：

```
imports:    
  - { resource: facebookParameters.ini }

security:
  providers:
    my_fos_facebook_provider:
        id: my.facebook.user            
  firewalls:
    main:
        pattern: ^/
        fos_facebook:
            app_url: %facebookAppUrl%
            server_url: %facebookServerUrl%
            login_path: /login
            check_path: /login_fb_check
            default_target_path: /
            provider: my_fos_facebook_provider
        logout:
            handlers: ["fos_facebook.logout_handler"]
        anonymous:    true
  access_control:
    - { path: ^/game, roles: ROLE_FACEBOOK }
    - { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY }
    - { path: ^/gameinfos, roles: IS_AUTHENTICATED_ANONYMOUSLY } 
```

路径游戏应该通过 facebook 登录来保护，路径登录和游戏信息应该对所有访问者免费。好的登录很好，它可以从任何地方访问，但游戏信息不是。当我调用路径/路线时，它总是将我引导到 facebook。问题可能出在哪里？

# javascript - 与“开关”相关的功能不起作用

> ID：13211461
> 
> 赞同：0
> 
> 时间：2012-11-03T17:09:57.827
> 
> 标签：javascript, switch-statement, bots

我不知道为什么这不起作用。一切都以正确的方式声明，语法看起来很完美。谁能告诉我怎么了？困难是从电台选择中收到的，但我已经在这里声明了。功能机器人不会收到警报。

```
 var difficulty = "easy";
    var botchance = 0;
    var botroll = 0;
    var botscore = 0;

function bot(){
    botchance =  Math.floor(Math.random() * (10 - 1 + 1)) + 1;

    switch(difficulty){
    case "easy":
        if (botchance <= 6){
            botroll = Math.floor(Math.random() * (10 - 3 + 1)) + 3;
        }
        else botroll=10;
        break;
    case "medium":
        if (botchance <= 7){
            botroll = Math.floor(Math.random() * (9 - 2 + 1)) + 2;
        }
        else botroll=10;
        break;
    case "hard":
        if (botchance <= 8){
            botroll = Math.floor(Math.random() * (8 - 1 + 1)) + 1;
        }
        else botroll=10;
        break;
    default:
        if (botchance <= 9){
            botroll = Math.floor(Math.random() * (7 - 1 + 1)) + 1;
        }
        else botroll=10;
    }

alert(botscore);
alert(botroll);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:13:28.277

如果您查看开发人员控制台，您会看到：

`ReferenceError: botscore is not defined`

这会停止执行，您将看不到警报。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:16:03.773

删除`alert(botscore);`或声明它；

# flash - 如何将文本分配给自定义 HSlider 值？

> ID：13211469
> 
> 赞同：2
> 
> 时间：2012-11-03T17:10:52.450
> 
> 标签：flash, builder

我希望标签显示滑块的自定义值，例如

滑块值为 0，则标签文本为 250 滑块值为 1，则标签文本为 333 滑块值为 2，则标签文本为 543 滑块值为 3，则标签文本为 9342

我是新手，非常感谢任何帮助。我的示例代码是：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600">
<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>
<s:Panel x="199" y="141" width="250" height="200">
    <s:HSlider id="ValueSlider" x="74" y="68" maximum="3" minimum="0" stepSize="1"/>
    <s:Label id="ValueLabel" x="109" y="38" text="Label"/>
</s:Panel> 
```

感谢@Whiteagle，这是我现在的状态，但现在我收到“无法解决组件实现”错误

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600">
<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>

<mx:Script>
    <![CDATA[
        import mx.events.SliderEvent;
        protected function ValueSlider_changeHandler(event:SliderEvent):void
    {
        ValueLabel.text = ValueSlider.value;
            if(ValueSlider.value == "0")
            ValueLabel.text = "150";
            if(ValueSlider.value == "1")
            ValueLabel.text = "333";
            if(ValueSlider.value == "2")
            ValueLabel.text = "543";
            if(ValueSlider.value == "3")
            ValueLabel.text = "9342";
    }
    ]]>
</mx:Script>
<s:Panel x="199" y="141" width="250" height="200">
    <s:HSlider id="ValueSlider" x="74" y="68" maximum="5" minimum="0" stepSize="1"/>
    <s:Label id="ValueLabel" x="109" y="38" text="Label"/>
</s:Panel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:37:06.317

您只需要添加一个更改事件并更改标签的文本属性：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600">
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>

    <mx:Script>
    <![CDATA[

        import mx.events.SliderEvent;

        protected function ValueSlider_changeHandler(event:SliderEvent):void
        {
            ValueLabel.text = ValueSlider.value; // You could also use event.currentTarget or similar to obtain the element that dispatched the event, I prefered to refer to it directly for this example.
            // Add your logic here. For instance:
            if(ValueSlider.value == "0") // I'm using an if just for demonstration purposes, if you want to do one check per value you may want to consider using a switch.
                ValueLabel.text = "300";
                ...
        }

    ]]>
    </mx:Script>
    <s:Panel x="199" y="141" width="250" height="200">
        <s:HSlider id="ValueSlider" x="74" y="68" maximum="3" minimum="0" stepSize="1" change="ValueSlider_changeHandler(event)" />
        <s:Label id="ValueLabel" x="109" y="38" text="Label"/>
    </s:Panel>
</s:Application> 
```

# java - 带有 GUI 的 Java 文件输入获取方法

> ID：13211476
> 
> 赞同：2
> 
> 时间：2012-11-03T17:11:25.253
> 
> 标签：java, reflection

如果用户从 GUI 中选择文件，我不知道如何使用 getDeclaredMethods() （反射）。

inFile 是文件类型，当用户从 GUI 中选择文件时我得到它。

```
public static void read_file_methods () {  

   Class in_class= inFile.getClass();     
   Method[] methods = in_class.getDeclaredMethods();

....
} 
```

我无法获取输入文件的类，只有对象的类，但是如何从输入中获取对象？我不能使用 MyProgram m = new MyProgram(); ...并且不知道如何使用 .newInstance() 来工作。

“我想从输入文件中获取声明的方法，然后在我的 GUI 中列出它们。用户可以选择 txt 或 java 文件，当他/她这样做时，程序将从这里获取方法（如果有“

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T19:24:50.060

这是你要问的吗？

```
 URLClassLoader loader = URLClassLoader.newInstance(new URL[]{fileName.toURI().toURL()}); //This code creates a new URLClassLoader based on the file that you define

    Class<?> clazz = loader.loadClass("ClassName");  //This loads the class with the given name

    for(Method m: clazz.getDeclaredMethods()) {  //This code will print the names of every method in the class

    System.out.println(m.getName());
    } 
```

从这里您可以将所有方法名称添加到 JList 或您用于显示方法的任何 UI 元素中。

# java - 从文本文件中读取每一行不同的数据类型

> ID：13211477
> 
> 赞同：2
> 
> 时间：2012-11-03T17:11:37.977
> 
> 标签：java

我有一个文本文件，提供 22 个高尔夫球场的信息，包括球场名称、名称、位置、设计师、果岭费、标准杆、建造年份和总码数。正如我所读到的，每一行都需要存储到适当的变量中，然后用于创建一些对象。文件的第一行是文本文件中高尔夫球场的数量。

```
 FileInputStream fstream = new FileInputStream(System.getProperty("user.dir")
            + "\\GolfCourses.txt");
    //use file
    DataInputStream in = new DataInputStream(fstream);
    //read input
    BufferedReader br = new BufferedReader(new InputStreamReader(in));
    Tree newTree = new Tree();

    try{
         String line = br.readLine();
          if(line==null)
             throw new IOException();

        int clubs = Integer.parseInt(line);
        for(int i = 0; i < clubs; i++){
            String name = br.readLine();
            String location = br.readLine();
            double fee = Double.parseDouble(br.readLine());
            int par = Integer.parseInt(br.readLine());
            String designer = br.readLine();
            int built = Integer.parseInt(br.readLine());
            int yards = Integer.parseInt(br.readLine());
            newTree.insert(new TreeNode(new GolfCourse(name, location, designer, fee, par, built, yards))); 
        }

        in.close();
    }catch(IOException e){
        System.out.println(e);
    } 
```

读入似乎超前，所以程序试图解析字符串而不是数字。我以前从来没有遇到过这个问题，所以我不知道如何解决它。

编辑：代码现在按预期工作。问题来自 for 循环的“i <= clubs”部分。感谢您抽出宝贵时间提供帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:17:51.530

这是因为您的 first`br.readLine()`会从文件中获取您的第一行，即俱乐部数量。在`if`失败的语句之后，您正在调用`br.readLine()`. 此调用将获取下一行，因为第一行已在`br.realLine()`语句的最后一次调用中检索到`if`。

试试这个：

```
String line = br.readLine();
if(line == null) {
    throw new IOException();
}
int clubs = Integer.parseInt(line); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:22:53.373

**像这样读取文件：**

```
File f = new File("Path");
FileReader fr = new FileReader(f);
BufferedReader br = new BufferedReader(fr); 
```

**检索字段：**

**如果高尔夫球场、名称、位置等字段位于一行，每个条目用“单个空格”分隔：**

**-**使用`split(" ");`

**如果高尔夫球场、名称、位置等字段每行一个：**

**-**使用`split("\n");` `Not "\\" but "\"`

**-**使用`for-loop`with `count of 8`，得到 8 个字段。

**对象的创建：**

**-**创建一个`Java bean`包含 8 个字段的字段，以保存这些值。

# android - 主题未在我的适配器内应用

> ID：13211493
> 
> 赞同：1
> 
> 时间：2012-11-03T17:13:03.810
> 
> 标签：android, listview, themes

我正在尝试使用 ListView 创建一个简单的活动（下面的代码）

Activity 使用的是 Theme.Light，但似乎 simple_list_item_2 是用于深色主题的。

结果是不可读的文本。

有没有办法在我的 ListView 上使用 Light Theme？

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
                android.R.layout.simple_list_item_2, array) {
            @Override
            public View getView(int position, View convertView, ViewGroup parent) {

                TwoLineListItem row;
                if(convertView == null){
                    LayoutInflater inflater = (LayoutInflater)getApplicationContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                    row = (TwoLineListItem)inflater.inflate(android.R.layout.simple_list_item_2, null);
                }else{
                    row = (TwoLineListItem)convertView;
                }
                String[] data = this.getItem(position).split(";");
                //No check on data.length for the example.
                row.getText1().setText(data[0]);
                row.getText2().setText(data[1]);

                return row;

            }
        };
        setListAdapter(adapter); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:32:07.920

问题解决了：

我用了：

```
LayoutInflater inflater = getLayoutInflater(); 
```

代替

```
LayoutInflater inflater = (LayoutInflater)getApplicationContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE); 
```

# scala - 从 List[(String,String)] 生成 Map[String, List[String]]

> ID：13211496
> 
> 赞同：4
> 
> 时间：2012-11-03T17:13:10.877
> 
> 标签：scala, map

我得到了以下配对列表：

```
 List(("US","New York"),("England","London"),("US","Los Angeles"),("England","Manchester"),("US","Washington")) 
```

我需要生成一个`Map[Country, List[Cities]]`：

```
Map("US" -> List("New York", "Los Angeles", "Washington"), "England" -> List("London", "Manchester")) 
```

如果我`toMap()`直接使用具有相同键的值的问题将被删除。

到目前为止的故事：

```
list.groupBy(el => el).map(el => el._1 -> ?) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T17:18:01.317

使用 groupBy：

```
list.groupBy(_._1).mapValues(_.map(_._2)) 
```

使用折叠：

```
list.foldLeft(Map.empty[String, List[String]]) { case (m, (k, v)) =>
  m.updated(k, v :: m.getOrElse(k, List()))
} 
```

# c++ - 使用指向对象的指针进行破坏

> ID：13211498
> 
> 赞同：3
> 
> 时间：2012-11-03T17:13:22.173
> 
> 标签：c++, pointers, object, destructor, delete-operator

如果一个对象是这样存在的：

```
MyClass obj; 
```

调用成员函数：

```
obj.myMemberFunction(); 
```

然后在实现其目的后调用该对象的析构函数：

```
delete obj; 
```

但是，假设我有一个指向对象的指针：

```
MyClass* obj; 
```

调用成员函数：

```
obj->myMemberFunction(); 
```

现在......我如何调用这个对象的析构函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T17:16:43.637

You've got it backwards; do `delete` in the second case and *not* the first:

```
MyClass obj;
obj.myMemberFunction();
//delete obj;
//^^^^^^^^^^^
// NO! `obj` has automatic storage and will
// be destroyed automatically when it goes out
// of scope. 
```

`delete` expects a pointer to a *dynamically*-allocated object:

```
MyClass* obj = new MyClass;
obj->myMemberFunction();
delete obj; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T17:17:22.543

If you create it with

```
MyClass obj; 
```

you do nothing to delete it. If you create it with

```
MyClass* obj = new MyClass(); 
```

you use

```
delete obj; 
```

to delete it.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-03T17:26:14.960

[运算符 delete](http://www.cplusplus.com/reference/std/new/operator%20delete/)旨在与存储在堆上分配的区域的地址的指针一起使用，这要归功于相应的运算[符 new](http://www.cplusplus.com/reference/std/new/operator%20new/)。

```
void function () 
{
  int * pt;

  pt = new int;

  *pt = 42;

  delete pt; // memory released
} 
```

在堆栈上分配的内存在相应范围结束时自动释放：

```
void function () 
{
  int i;

  i = 42;

} // memory released 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T17:18:33.823

When you write `MyClass obj;`, the object is allocated on the stack, as opposed to on the heap. In this case, the object is destroyed automatically then it goes out of scope. The compiler generates code to ensure the destructor is called. So you don't delete the object explicitly.

`delete` is used when an object is allocated on the heap. For example:

```
MyClass* pobj = new MyClass;
// Do something with pobj...
delete pobj; 
```

# qooxdoo - QooxDoo：如何强制 generate.py 包含一个零件？

> ID：13211499
> 
> 赞同：1
> 
> 时间：2012-11-03T17:13:22.107
> 
> 标签：qooxdoo

现在我正在使用 QooXDoo 构建 RIA 内联应用程序。我在这个内联应用中有 2 个部分。

现在我在构建零件时遇到了问题。

如何强制 generate.py 包含在 Application.js 中未明确使用的部分

来自 generate.py 源的日志

```
>>> Collecting classes   
- Warning: Hint: Unknown global symbol referenced: desktop (tappv3.Application:80)
- Warning: Hint: Unknown global symbol referenced: navSlideIn (tappv3.Application:88)
- Warning: Hint: Unknown global symbol referenced: setDeskTop (tappv3.Application:90)
- Warning: Hint: Unknown global symbol referenced: __MainWindow (tappv3.Application:105)
- Warning: Hint: Unknown global symbol referenced: addWindow (tappv3.MainWindow:30)
- Sorting 262 classes  
>>> Assembling parts
- **part part_agent    - Part #part_agent is ignored in current configuration**
- part boot  
>>> Collapsing parts  
>>> Verifying parts  
>>> Generate application
- Processing 2 locales  
- Generate packages  
- Generate loader script
>>> Done (0m01.51) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T09:21:40.800

如果您指的是“part_agent”部分，如果该部分不包含任何类，则会忽略此部分。如果它涵盖了有效的类，您将需要在 config.json 中检查此部件的部件定义。您可能想查看有关[手册](http://manual.qooxdoo.org/2.0.x/pages/development/parts_using.html#in-depth-configuring-the-include-key-of-your-parts)中每个部分的“包含”键的提示。

您还应该检查“未知全局符号”警告。

# python - 基本功能不起作用 -> 'name 'happyBirthdayEmily' 未定义'

> ID：13211500
> 
> 赞同：0
> 
> 时间：2012-11-03T17:13:22.723
> 
> 标签：python, function

我正在遵循[本指南](http://anh.cs.luc.edu/python/hands-on/3.1/handsonHtml/functions.html)，但无法使用基本功能。

`birthday2.py`

```
def happyBirthdayEmily(): #program does nothing as written
    print("Happy Birthday to you!")
    print("Happy Birthday to you!")
    print("Happy Birthday, dear Emily.")
    print("Happy Birthday to you!") 
```

因此，按照指南，我输入以下内容：

```
>>>import birthday2
>>>happyBirthdayEmily 
```

这是我得到的错误：

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'happyBirthdayEmily' is not defined 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T17:14:57.970

你应该做：

```
>>>import birthday2
>>>birthday2.happyBirthdayEmily() 
```

或者：

```
>>>from birthday2 import happyBirthdayEmily
>>>happyBirthdayEmily() 
```

或者：

```
>>>from birthday2 import *
>>>happyBirthdayEmily() 
```

[在此处](http://docs.python.org/2/tutorial/modules.html)阅读有关模块的更多信息

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T17:14:24.183

您在后面缺少括号`happyBirthdayEmily`和模块引用。像这样做：

```
>>>birthday2.happyBirthdayEmily() 
```

括号将其标识为函数调用，`birthday2.`开头只是说“使用模块中的函数” `happyBirthdayEmily()`。`birthday2`它的结构是这样的，因为如果你有另一个`birthday2`也被调用`happyBirthdayEmily()`的函数（不是 in ），python 解释器基本上不知道要使用哪个函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-03T17:15:09.973

您需要使用全名：

```
birthday2.happyBirthdayEmily() 
```

并包含`()`括号以调用该函数。

或者，您可以稍微不同地导入它：

```
from birthday2 import happyBirthdayEmily 
```

将函数导入本地命名空间。

# android - Android 解析 XML 属性

> ID：13211501
> 
> 赞同：0
> 
> 时间：2012-11-03T17:13:27.540
> 
> 标签：android, xml, parsing, xml-parsing

我正在解析两个 xml 文件 - 我使用 XmlParser 成功解析了第一个文件：-

```
public final String getElementValue(Node elem) {
    Node child;
    if (elem != null) {
        if (elem.hasChildNodes()) {
            for (child = elem.getFirstChild(); child != null; child = child
                    .getNextSibling()) {
                if (child.getNodeType() == Node.TEXT_NODE) {
                    System.out.println("±VALUE: "
                            + child.getNodeValue().toString()
                            + " node type: " + child.getNodeType());
                    return child.getNodeValue();
                } 
```

然而，下一个 xml 文件具有我需要的属性。我可以使用相同的解析器吗？如果可以，我该如何更改它以读取属性？我要阅读的文件是[http://cloud.tfl.gov.uk/TrackerNet/LineStatus](http://cloud.tfl.gov.uk/TrackerNet/LineStatus) - 我需要线路名称和状态描述。

我正在使用另一个带有 KEY 的类 - 我如何明确说明我需要哪个属性？即以下： -

```
static final String KEY_TRANSPORT = "LineStatus"; // parent node
static final String KEY_LINENAME = "???";
static final String KEY_LINEDESC = "???"; 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:33:45.803

关于 XML 的事情是您需要读取/解析整个文件才能检索任何信息，您不能只读取您需要的位。您应该阅读该文件一次并将您可能需要的所有信息存储在另一个类中，以便以后检索它。

下面是我学习如何从我的档案中解析 XML，但是，我使用了 SAXParser。您需要在 startElement 和 endElement 上将布尔值设置为 true 或 false 以跟踪您在 XML 文档中读取标签的位置，然后覆盖字符并在那里恢复字符串，将其存储在持有者类中，具体取决于哪些布尔值是 true，记住该布尔值告诉您您在文档中的位置。

如果您有一个复杂的文档和大量要检索的信息，则 Handler 可能有很多子级别，您需要仔细检查，因为它容易混淆并出错。

SAX解析器：

[http://www.anddev.org/parsing_xml_from_the_net_-_using_the_saxparser-t353.html](http://www.anddev.org/parsing_xml_from_the_net_-_using_the_saxparser-t353.html) [http://www.androidpeople.com/android-xml-parsing-tutorial-using-saxparser](http://www.androidpeople.com/android-xml-parsing-tutorial-using-saxparser)

* * *

或者，使用 XMLPullParser，您可以使用循环进入标签内部，然后在您要查找的标签内存储信息。但是，我从未使用过这种方法，因此无法将效率与第一种方法进行比较。在任何情况下，您都需要浏览标签，直到找到您要查找的标签。这里是：

```
XmlPullParser tutorials;
tutorials = XmlPullParserFactory.newInstance().newPullParser();
tutorials.setInput(downloadPath.openStream(), null);

while (eventType != XmlPullParser.END_DOCUMENT) {
    if (eventType == XmlPullParser.START_TAG) {
        String tagName = tutorials.getName();
        if (tagName.equals("item")) {
            // inner loop looking for link and title
            while (eventType != XmlPullParser.END_DOCUMENT) {
                if (eventType == XmlPullParser.START_TAG) {
                    if (tutorials.getName().equals("link")) {
                    } else if (tutorials.getName().equals(
                            "title")) {
                    }
                } else if (eventType == XmlPullParser.END_TAG) {
                    if (tutorials.getName().equals("item")) {
                        // save the data, and then continue with
                        // the outer loop
                        break;
                    }
                }
                eventType = tutorials.next();
            }
        }
    }
    eventType = tutorials.next();
} 
```

# drupal - 根据drupal 7中的当前用户数据显示用户

> ID：13211503
> 
> 赞同：2
> 
> 时间：2012-11-03T17:13:30.367
> 
> 标签：drupal, drupal-7, drupal-views

我在用户字段中创建了一个额外的出生日期字段。现在我如何显示所有具有相同出生日期的用户具有登录用户的出生日期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:57:32.267

您需要为生日字段创建一个带有上下文过滤器的用户视图。设置过滤器以在 php 代码中提供默认值。然后在过滤器的 PHP 框中，使用全局 $user 对象来获取并返回当前用户的生日。然后要从结果中排除当前用户，为 user:current 添加一个过滤器，然后单击“否”选项。

# django - Django assertEqual 不显示实际值与预期值

> ID：13211504
> 
> 赞同：2
> 
> 时间：2012-11-03T17:13:37.647
> 
> 标签：django, tdd, assertions

所以我正在学习如何在 Django 中练习 TDD，但遇到了一些小麻烦。我创建了一个自定义用户对象，它以一对一的关系链接到经过身份验证的系统用户。我有以下测试，它练习了我的自定义用户类的一部分：

```
def test_creating_a_user_with_attributes(self):
    myuser = Myuser.objects.create_user('Gary', email='me@email.com')
    current_time = now()
    myuser.birthday = current_time
    myuser.save()
    first_user = Myuser.objects.all()[0]
    self.assertEqual(first_user.birthday, current_time, 'first_user.birthday should be equal to the current_time') 
```

问题是我的测试失败了，我无法立即明白原因。断言失败报告了我提供的消息，我很困惑，因为我确定生日设置为现在的值。我最终不得不重构我的断言以明确失败的值。

```
 self.assertEqual(first_user.birthday, current_time,
        'first_user.birthday ' + str(first_user.birthday) + ' should equal ' + str(current_time)) 
```

这表明生日是日期字段而不是日期时间字段。我的问题是是否存在某种替代形式的断言将预期值和实际值作为失败消息的一部分转储，或者我是否以某种方式滥用或误解了 API？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T17:37:12.917

Django 没有实现 assertEqual，它只是使用 Python 的 unittest 模块来实现。

您需要为您的测试用例类设置`longMessage`属性，如下所示：`True`

```
class VerboseTestCase(TestCase):
    longMessage = True

    def test_creating_a_user_with_attributes(self):
        myuser = Myuser.objects.create_user('Gary', email='me@email.com')
        current_time = now()
        myuser.birthday = current_time
        myuser.save()
        first_user = Myuser.objects.all()[0]
        self.assertEqual(first_user.birthday, current_time, 'first_user.birthday should be equal to the current_time') 
```

如果测试失败，它将输出如下内容：

```
AssertionError: <datetime 1> != <datetime 2> : first_user.birthday should be equal to the current_time 
```

这在[Python 的 unittest docs](http://docs.python.org/2.7/library/unittest.html#unittest.TestCase.longMessage)中有解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T17:40:52.160

默认错误消息*会*显示失败的值。但是您通过提供第三个参数来覆盖它`assertEqual`。如果您忽略它，它将打印这些值。

`longMessage`正如 Gonzalo 所展示的，您实际上可以通过使用属性获得两全其美的效果。

# java - 为什么这不是有效的 Java？

> ID：13211506
> 
> 赞同：0
> 
> 时间：2012-11-03T17:13:52.047
> 
> 标签：java, optimization, coding-style, code-snippets

当然这应该是有效的Java？我的语法有一点错误吗？

```
return (url != null) ? url : (throw new NotFoundException("No url")); 
```

如果不是，我想我必须这样做：

```
if(url == null)
    throw new NotFoundException("No url");
return url; 
```

有人有更简洁的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T17:15:12.140

因为你没有履行回报：

```
return <comparison> ? <value1> :(else) <value2> 
```

在您的情况下，您正在实现`value1`但不是`value2`，而是抛出一个新的异常。

您实际的第一个代码将被翻译成

```
if (url != null) {
    return url;
} else {
    return throw new NotFoundException("No url"); //makes sense?
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-03T17:21:23.470

三元运算符采用（从其名称中可以清楚地看出）三个参数。第一个是比较（其值被转换为布尔值）。后两个必须共享一个类型（或可转换为相同类型），即作为整个语句类型的类型。

您的代码中的问题是这`throw new NotFoundException("No url");`是一个语句。语句没有值，因此，不与其他任何东西共享类型。这就是为什么不允许在三元运算符的第二个或第三个参数中使用语句的原因。这无关紧要，因为作为语句的部分恰好是 throw 语句，但这是巧合。为了使三元运算符通常有意义，两个值需要具有相同的值，因此不能是语句。

`ConditionalExpression`（请注意，在 Java 中，所有对象都从 java.lang.Object 继承，如果 a 中的两个值之一（如语言定义中所称）是原语，则java 具有特殊（和复杂）的转换规则，所以如果这两个论点都不是陈述，它会起作用。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-03T17:25:35.173

它是无效的，因为它不符合 BNF：

```
Expression:
    Expression1 [ AssignmentOperator Expression1 ]

 Expression1:
    Expression2 [ Expression1Rest ]

Expression1Rest:
    ? Expression : Expression1 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-03T17:26:53.317

如果你真的非常喜欢简洁（我喜欢！），有办法解决这个问题**。**声明一个方法

```
public static <T> T trhow(RuntimeException e) {
  throw e;
} 
```

然后只写`trhow(new MyException());`而不是`throw new MyException();`. 我不确定这将如何在三元运算符中间推断您的类型，但也许您可以使用具体类型而不是泛型类型。

此外，如果您希望这适用于已检查的异常，那将更加麻烦。有一个习惯用法允许您在不声明的情况下抛出任何已检查的异常，但这会破坏首先检查它的意义。

# wcf - WCF 在 iis 上设置

> ID：13211507
> 
> 赞同：0
> 
> 时间：2012-11-03T17:13:53.723
> 
> 标签：wcf, iis-7

当我尝试浏览在 IIS 7 上添加的 Web 服务时出现以下错误。当我进入内容视图时，我可以浏览端点。”HTTP 错误 403.14 - 禁止 Web 服务器配置为不列出该目录的内容”。

如果它与向 III 用户授予用户权限有关，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:19:14.463

This just means you have tried to browse the WCF service without the service file.

You need to browse to MyService.svc, for example, not just to the directory that contains it.

# postgresql - Postgres.app 配置（端口和其他选项）

> ID：13211508
> 
> 赞同：7
> 
> 时间：2012-11-03T17:13:53.910
> 
> 标签：postgresql, postgres.app

我刚刚在我的 Mac 上安装了 Postgres.app，我需要对服务器进行一些特定的配置。例如我想使用不同的端口，而不是 5432。

我发现它有`postgresql.conf`at `~/Library/Application\ Support/Postgres/var/postgresql.conf`，但即使我将值更改为`port =`其他值，它也会在服务器重新启动后在 5432 上侦听。

似乎`postgresql.conf`Postgress.app 没有使用它。它在哪里存储服务器配置文件？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-16T02:21:44.093

`~/Library/Application\ Support/Postgres/var/` ***Postgres.app 使用位于***的 postgresql.conf 文件。唯一的问题：如果您更改该文件中的端口，该更改将不会**反映****在 menu-bar**中。所以那边的大象仍然会说“在端口 5432 上运行”，尽管 postgres 可能在例如端口 5433 上运行。（Mac OS X 10.8.2、Server.app 2.2、Postgres.app 9.2.2.0）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-22T22:21:05.383

我可以看到`ps aux |grep post` /Applications/Postgres.app/Contents/MacOS/bin/postgres -D /Users/chenc26/Library/Application Support/Postgres/var -p5432 的输出所以我认为这个应用程序中必须有一些配置来指定忽略配置文件中的值的 CLI 参数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-29T06:30:42.013

我正在运行 Mavericks 10.9.3 并通过打开 Postgres 应用程序 v9.3 配置`nano ~/Library/Application\ Support/Postgres/var-9.3/postgresql.conf`并取消注释该`port = 5432`行，然后将其更改为 5433 对我有用。（如配置文件所述，需要重新启动应用程序）。之后应用程序正确显示它正在端口 5433 上运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T18:54:43.810

如果正确更改了 postgresql.conf 的内容，然后重新启动 PostgreSQL 服务器并不会更改它正在侦听的端口，那么您几乎可以肯定编辑了错误的 postgresql.conf。

在其他平台上，PostgreSQL 将其默认版本的 postgresql.conf的*副本放在数据目录中。*因此，您可能会在计算机的某个位置找到至少两份所有配置文件的副本——通常一份在下载或解压缩分发或源代码的目录中，另一份在数据目录中。在您的 Mac 上，如果您使用的是 9.1 版，则数据目录*可能*是

```
/Library/PostgreSQL/9.1/data/ 
```

检查那里的 postgresql.conf。如果您找到了，请考虑制作一份副本以替换您编辑的那个。（因此您编辑的版本将再次成为未经编辑的版本。）

# c - 这个校验和计算有什么问题吗？

> ID：13211516
> 
> 赞同：3
> 
> 时间：2012-11-03T17:14:54.813
> 
> 标签：c, tcp, network-programming, ip, freebsd

从这个网站：[http ://www.enderunix.org/docs/en/rawipspoof/](http://www.enderunix.org/docs/en/rawipspoof/)

我拉了以下功能

```
unsigned short in_cksum(unsigned short *addr, int len)
{
    int nleft = len;
    int sum = 0;
    unsigned short *w = addr;
    unsigned short answer = 0;

    while (nleft > 1) {
        sum += *w++;
        nleft -= 2;
    }

    if (nleft == 1) {
        *(unsigned char *) (&answer) = *(unsigned char *) w;
        sum += answer;
    }

    sum = (sum >> 16) + (sum & 0xFFFF);
    sum += (sum >> 16);
    answer = ~sum;
    return (answer);
}

unsigned short in_cksum_tcp(int src, int dst, unsigned short *addr, int len)
{
    struct psd_tcp buf;
    u_short ans;

    memset(&buf, 0, sizeof(buf));
    buf.src.s_addr = src;
    buf.dst.s_addr = dst;
    buf.pad = 0;
    buf.proto = IPPROTO_TCP;
    buf.tcp_len = htons(len);
    memcpy(&(buf.tcp), addr, len);
    ans = in_cksum((unsigned short *)&buf, 12 + len);
    return (ans);
} 
```

但是，当我对我看到的传入 TCP 数据包运行它时，我没有得到与当前相同的校验和结果（我保存传入的 TCP 校验和并将数据包上的校验和设置为零，然后再尝试运行校验和功能)

现在，当我对 IP 标头运行“in_cksum”时，我得到了正确的答案。

这是该站点的 TCP 伪标头：

```
struct psd_tcp {
    struct in_addr src;
    struct in_addr dst;
    unsigned char pad;
    unsigned char proto;
    unsigned short tcp_len;
    struct tcphdr tcp;
}; 
```

它是否缺少使这项工作有效的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:08:32.647

好吧，您的主要错误是忘记在校验和计算中包含 TCP 有效负载，仅包含标头 (oops)。参见 RFC 793 的第 3.1 节 (http://www.ietf.org/rfc/rfc793.txt) 以获取对此的描述：

> 校验和字段是标题和文本中所有 16 位字的反码和的 16 位反码。

当然，这是我假设“len”参数是 TCP 标头的长度；如果它包含有效负载，那么您会遇到不同的问题（memcpy 到比源更小的缓冲区......）。

请注意，当您对有效负载进行校验和时，RFC 中还有一个很容易遗漏的小东西：

> 如果一个段包含奇数个要校验和的标题和文本八位字节，则最后一个八位字节在右侧用零填充以形成一个用于校验和目的的 16 位字。

只需记住在计算校验和之前根据需要用零填充有效负载。

# python - 在网格管理器中使用带有 Tkinter 的条目框？

> ID：13211524
> 
> 赞同：2
> 
> 时间：2012-11-03T17:15:18.020
> 
> 标签：python, tkinter, grid, pack, tkinter-entry

我正在尝试使用 Tkinter 制作一个基本的 GUI，并使用 Grid 管理器在我的标签旁边有一个输入框，但是如果我将 .grid() 与我的 Entry 对象一起使用，则当我运行我的程序时，窗口不会显示。

当我使用 .pack() 时它确实有效，这很奇怪，因为当我在同一个小部件中使用 .grid() 有其他东西时，我听说不使用 .pack()。但我确实想使用 .grid() ，因为我希望能够按照自己的方式组织它。

代码如下，我在使用 Entry 对象 showName 时遇到问题。注释掉的 .pack() 语句是有效的， .grid() 语句是无效的。

有人知道这有什么问题吗？

```
from Tkinter import *

class RenamerGUI():
    def __init__(self, master):
        frame = Frame(master)
        frame.pack() #Make frame visible

        self.exit = Button(frame, text = "Exit", fg = "red", command = frame.quit)

        self.csv2tsv = Button(frame, text = "csv2tsv", fg = "green", bg = "black", command=self.csv2tsv)
        self.epguidestsvFormatter = Button(frame, text = "epguidestsvFormatter", fg = "green", bg = "black", command = self.epguidestsvFormatter)
        self.epNamesList = Button(frame, text = "epNamesList", fg = "green", bg = "black", command = self.epNamesList)
        self.SeasonSplitter = Button(frame, text = "SeasonSplitter", fg = "green", bg = "black", command = self.SeasonSplitter)
        self.Renamer = Button(frame, text = "Renamer", fg = "green", bg = "black", command = self.Renamer)

        self.showLabel = Label(frame, text = "Show: ")

        self.showName = Entry(master)

        self.get = Button(frame, text = "Get", command = self.textgetter)

        self.exit.grid(row=3, column=4)
        self.csv2tsv.grid(row=1, column = 0)
        self.epguidestsvFormatter.grid(row=1, column=1)
        self.epNamesList.grid(row=1, column=2)
        self.SeasonSplitter.grid(row=1, column=3)
        self.Renamer.grid(row=1, column=4)
        self.showLabel.grid(row=2)
        self.showName.grid(row=2, column=1)
        #self.showName.pack(side=BOTTOM) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:57:05.607

该条目的父级错误：

```
self.showName = Entry(master) 
```

应该

```
self.showName = Entry(frame) 
```

# javascript - 显示/隐藏/添加元素时包装器的 CSS 过渡

> ID：13211529
> 
> 赞同：0
> 
> 时间：2012-11-03T17:16:01.760
> 
> 标签：javascript, css, css-transitions, jquery-effects

我有一个 div，其中包含一些隐藏的元素和一些可见的元素。

现在，当我显示隐藏元素之一（或隐藏可见元素）时，包装 div 的高度会发生变化。我还可以向 div 添加新元素。

例子：

```
<div class="wrapper">
    <div id="inner1">Hallo1</div>
    <div id="inner2">Hallo2</div>
    <div id="inner3">Hallo3</div>
</div> 
```

现在我想动画包装div的高度变化。

我玩了 jquery 效果和 css3 转换，但我可以让它工作..

编辑：这里有一个小提琴作为我所拥有的示例：

[http://jsfiddle.net/6rhqX/2/](http://jsfiddle.net/6rhqX/2/)

现在我想在新元素出现时“平滑”包装器。

编辑：也许我过于简单化了我的问题而忘记提及一些事情..

我不想为内部 div 设置动画，我想在包装器中的某些内容被删除/添加/隐藏/显示时“自动”设置动画。

例如，我希望能够将 div 的全部内容与其他内容“交换”，并希望对新高度的更改进行动画处理...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:53:02.870

我在[这里](http://jsfiddle.net/wM7zn/2/)用一个简单的演示制作了一个 jsFiddle。它利用了jQuery 的slideUp() 和slideDown() 函数。按下链接将显示/隐藏 div 并适当地移动滑动包装 div，或者您可以添加附加和向下滑动的元素以及包装 div。

我在演示中使用的 HTML 标记：

```
<ul class="buttons">
   <li><a href="#first_box">First box</a></li>
   <li><a href="#second_box">Second box</a></li>
   <li><a href="#third_box">Third box</a></li>
</ul>
<a href="#" id="add_element">Add Element</a>
<div id="wrapper">
   <div id="first_box">
      Got some cool content here.
   </div>
   <div id="second_box">
      Also some cool content.
   </div>
   <div id="third_box">
      And a third box.
   </div>
</div> 
```

CSS：

```
#wrapper {background-color: black;}

#first_box {width: 400px; height: 300px; background-color: green;}

#second_box {width: 400px; height: 300px; background-color: red; display: none;}

#third_box {width: 400px; height: 300px; background-color: blue; display: none;} 
```

.new_element {宽度：400px; 高度：200px；背景颜色：橙色；显示：无；}

查询：

```
$(document).ready(function() {

  $('.buttons a').click(function(e) {
    e.preventDefault();
    var target_box = $(this).attr('href'); // get the target box id
    //check if box is currently visible or hidden
    if($(target_box).is(':hidden')) {
       //if div is hidden slide it down (show it) and wrapper slides down with it
       $(target_box).slideDown(1000);     
    } else {
       //if div is visible hide it by sliding it up, wrapper slides up with it
        $(target_box).slideUp(1000);
    }
  });    

  $('#add_element').click(function(e) {
    var new_div = $('<div class="new_element">New element</div>');
    $('#wrapper').append(new_div);

  });

}); 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T19:01:33.883

关于您编辑的问题。您想在哪里插入内容或完全更改内容，我做了一个新的[小提琴](http://jsfiddle.net/Astraldiva/LGWcC/)。

在这个演示中，您有一个按钮，当您单击它时，它会向包装器 div 添加另外两个 Lorem Ipsum 段落。它的方式是首先将 div 动画到适当的高度，然后添加内容。您可以多次单击该按钮，每次它都会添加一个新的演示内容块。

HTML 标记：（您应该注意的是，我使用了一个临时容器来存放可见性设置为隐藏的内容。）

```
<a href="#" id="change_content">Add content</a>
<div id="wrapper">
    <div class="content_box">
        <p>"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do ei 
        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
        proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</p>
    </div>
</div>
<div id="temp_content"></div><!-- Container for temporary content --> 
```

CSS（只是在这里使用 bg 颜色使动画可见，并且 visibility: hidden 用于临时容器。请注意，您不能使用 display: none 因为在测量高度时会得到 0）

```
#wrapper {background-color: orange;}

.content_box {width: 400px; background-color: green;}

#temp_content {width: 400px; visibility: hidden;} 
```

jQuery（我在这里注释了代码）

```
$(document).ready(function() {

$('#change_content').click(function(e) {
    /*Some demo content here. Two new paragraphs wrapped in the div with content_box
      class. If it wasn't wrapped in the content_box class. In order to get correct
      height you should have temporary container width same as desired target
      container width so the content fills up properly.*/
    var new_content = '<div class="content_box"><p>Lorem ipsum dolor sit amet, 
    consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore
    magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris 
    nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in
    voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint 
    occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id
    est laborum.Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do 
    eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim 
    veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo  
    consequat.
    Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
    fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in 
    culpa qui officia deserunt mollit anim id est laborum.</p></div>';

    //insert the new content inside the temporary container.
    $('#temp_content').html(new_content);
    //calculate the temporary container height
    var new_content_height = $('#temp_content').height();
    //calculate current content height
    var existing_content_height = $('#wrapper').height();  
    //add two heights together
    var target_height = new_content_height + existing_content_height + 'px';        
     $('#wrapper').animate({
        height: target_height
      }, 1000, function() {
        //after the animation is over insert the content to the wrapper
        $('#wrapper').append(new_content);
        //its not obligatory but lets empty the temporary container
        $('#temp_content').empty();
      });    
});
}); 
```

希望能帮助到你。

编辑：有错误的小提琴链接。现在它指向正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T17:52:44.630

jQuery 有一个方便的函数，叫做[`slideDown`](http://api.jquery.com/slideDown/)你想要的动画。

这会找到第一个隐藏的`div`并将其动画化：http: [//jsfiddle.net/6rhqX/4/](http://jsfiddle.net/6rhqX/4/)

# python - 计数字母并显示在列表中

> ID：13211533
> 
> 赞同：0
> 
> 时间：2012-11-03T17:16:12.653
> 
> 标签：python, string, list

我需要从用户那里接收一个字符串，将其显示在列表中，以便列表中的每个器官都包含[字母，它连续重复的数字]。

我认为我的代码很好，但它不起作用。我使用了[http://pythontutor.com](http://pythontutor.com)，我看到一个问题是我的 var.next 和 current 始终保持相同的值。

有人有想法吗？

这是我的代码：

```
 string = raw_input("Enter a string:")
    i=0
    my_list=[]
    current=string[i]
    next=string[i+1]
    counter=1
    j=0
    while i<range(len(string)) and next<=range(len(string)):

        if i==len(string)-1:
            break
        j+=1
        i+=1
        if current==next:
            counter+=1

        else:
            print my_list.append([string[i],counter])
            counter=1 
```

输出：

```
Enter a string: baaaaab
As list: [['b', 1], ['a', 5], ['b', 1]] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T17:18:53.630

在这里使用[`itertools.groupby()`](http://docs.python.org/2/library/itertools.html#itertools.groupby)：

```
>>> from itertools import groupby
>>> [[k, len(list(g))] for k, g in groupby("baaaaab")]
[['b', 1], ['a', 5], ['b', 1]] 
```

或者不使用库：

```
strs = raw_input("Enter a string:")
lis = []
for x in strs:
   if len(lis) != 0:
      if lis[-1][0] == x:
         lis[-1][1] += 1
      else:
         lis.append([x, 1])
   else:
       lis.append([x, 1])         
print lis 
```

**输出：**

```
Enter a string:aaabbbcccdef
[['a', 3], ['b', 3], ['c', 3], ['d', 1], ['e', 1], ['f', 1]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:35:26.797

Aswini 代码的更简单变体：

```
string = raw_input("Enter a string:")
lis = []
for c in string:
    if len(lis) != 0 and lis[-1][0] == c:
        lis[-1][1] += 1
    else:
        lis.append([c, 1]) 

print lis 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T17:38:40.340

你可以使用 defaultdict 很容易地做到这一点：

```
import collections

defaultdict=collections.defaultdict
count=defaultdict(int)
string="hello world"
for x in string:
    count[x]+=1 
```

要将其显示在列表中，您可以执行以下操作：

```
count.items() 
```

在这种情况下会返回：

```
[(' ', 1), ('e', 1), ('d', 1), ('h', 1), ('l', 3), ('o', 2), ('r', 1), ('w', 1)] 
```

# python - 正确使用静态方法

> ID：13211535
> 
> 赞同：5
> 
> 时间：2012-11-03T17:16:17.173
> 
> 标签：python, static-methods

我有以下命名`Password.py`的简化类`folder1`：

```
import random                                                                    

CHARS = "ABC"

class PasswordHelper(object):                                                  
    @staticmethod                                                                          
    def generateChars(length):                                                    
       return ''.join(random.choice(CHARS) for x in range(length)) 
```

现在我有另一`TestClass.py`堂课`folder2`：

```
sys.path.append('../folder1/')                              
import Password                                         

class Tester:                                           
    def whatever(self):                                   
        print Password.generateChars(3)

def main():
     x = Tester()
     x.whatever()

# call main method
main() 
```

调用时`python TestClass.py`出现以下错误：AttributeError：“模块”对象没有属性“generateChars”。两个文件夹位于同一级别。我导入类文件的方式或静态方法声明本身是否有问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-03T17:20:32.963

Python 不是 Java。

首先，Tester 或 Password 类绝对没有意义。如果您不存储状态，则不要定义类。使两者都`whatever`成为`generateChars`正常的独立功能。

但是，假设您这样做只是为了了解 Python 类，那么您还没有理解 Python 中的类不等于模块。由于您已经导入了`Password`模块，您仍然需要引用`PasswordHelper`该类：

```
Password.PasswordHelper.generateChars(3) 
```

或者，您可以导入 PasswordHelper 类：

```
from Password import PasswordHelper
...
PasswordHelper.generateChars(3) 
```

最后，请按照 PEP8 为您的模块、类和函数名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T17:18:18.427

您在一个类中定义了该函数，因此您也需要使用类名来引用它：

```
print Password.PasswordHelper.generateChars(3) 
```

或者，将函数*移出*类定义，此时您根本不需要使用`@staticmethod`：

```
import random                                                                    

CHARS = "ABC"

def generateChars(length):                                                    
    return ''.join(random.choice(CHARS) for x in range(length)) 
```

在 Python 中，函数不必*是*类定义的一部分。

# android - Android：TextView 忽略重力和边距

> ID：13211546
> 
> 赞同：1
> 
> 时间：2012-11-03T17:17:42.040
> 
> 标签：android, textview, margin, gravity

这是我的代码：

```
 //define tablerows. each table row has max 3 buttons
 LinearLayout llRow1 = (LinearLayout)findViewById(R.id.llRow1); llRow1.removeAllViews();

   float scale = getResources().getDisplayMetrics().density;
   int padding_5dp = (int) (5 * scale + 0.5f);

//Define FrameLayout
       FrameLayout flTmp = new FrameLayout(this);
       LinearLayout.LayoutParams lp = new LinearLayout.LayoutParams(FrameLayout.LayoutParams.FILL_PARENT, FrameLayout.LayoutParams.FILL_PARENT, 1f);
       lp.setMargins(0, 0, padding_5dp, padding_5dp);
       flTmp.setLayoutParams(lp);

//Add dynamically TextView
TextView tvTmp = new TextView(this);
tvTmp.setText("Test");
LinearLayout.LayoutParams tvPara=new LinearLayout.LayoutParams(
                            LinearLayout.LayoutParams.WRAP_CONTENT, LinearLayout.LayoutParams.WRAP_CONTENT );
tvPara.gravity = Gravity.BOTTOM | Gravity.LEFT;
tvPara.setMargins(padding_5dp, 0, 0, 0);
tvTmp.setLayoutParams(tvPara);

//Add dynamically Buttons for juice
    ImageButton btnTmp = new ImageButton(this);

[...]

//Add Button and TextView to FrameLayout
    flTmp.addView(btnTmp);
    flTmp.addView(tvTmp);

llRow1.addView(flTmp); 
```

我尝试做的是使用 textview 描述动态创建一个 imagebutton，如下面的 xml 代码：

```
<FrameLayout>
<ImageButton android:background="@null" android:id="@+id/button_x" android:layout_width="fill_parent" android:layout_height="fill_parent" android:scaleType="fitXY" android:src="@drawable/button_graphic"></ImageButton>    
<TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_gravity="center" android:clickable="false" android:text="TEST TEST"></TextView>
</FrameLayout> 
```

我的代码可以正常工作，但 textview 忽略边距和重力参数。它位于左上角，没有边距。

有什么提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T17:28:06.447

您使用的`LayoutParams`必须是包含子级的父级类型。您`FrameLayout`包含`TextView`，但您正在分配`LinearLayout.LayoutParams`对它的引用。将其设为 a`FrameLayout.LayoutParams`或更改为`LinearLayout`. 如果我不得不猜测，它会默默地捕捉到这个错误并忽略它。

# c - 在 C 中，如果我使用 () 来初始化一个二维数组而不是 {}，会发生什么？

> ID：13211548
> 
> 赞同：2
> 
> 时间：2012-11-03T17:17:57.900
> 
> 标签：c

当我初始化一个数组时`a[][]`：

```
int a[2][5]={(8,9,7,67,11),(7,8,9,199,89)}; 
```

然后显示数组元素。

为什么我会得到：

```
11 89 0 0 0 
0 0 0 0 0 
```

如果在这里使用大括号而不是第一个括号会发生什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-03T17:19:41.203

```
(8,9,7,67,11) 
```

是使用*逗号运算符*的表达式，其计算结果为 11。其他初始化程序也是如此。因此，您只需显式初始化前两个元素，然后将所有其他元素初始化为 0。您的编译器应该警告初始化程序中缺少大括号级别。

如果您使用花括号，您`a`可能会按照预期初始化 的两个组件数组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T17:19:14.403

```
 int a[2][5]={(8,9,7,67,11),(7,8,9,199,89)}; 
```

相当于（在块范围内）：

```
 int a[2][5]={11, 89}; 
```

`,`是 C*逗号运算符*。它从左到右评估其操作数并产生右操作数的值。

在文件范围内，数组初始值设定项必须是常量，并且由于`,`表达式永远不是常量表达式，因此您的数组声明无效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-03T17:19:50.507

因为你没有使用大括号，而是括号。你要：

```
int a[2][5] = { { 8,9,7,67,11 }, { 7,8,9,199,89 } };
//              ^^^          ^^^^^^            ^^^ 
```

在您的原始代码中，您刚刚认识了[逗号运算符](http://en.wikipedia.org/wiki/Comma_operator)，并且您实际上已经编写了`int a[2][5] = { 11, 89 };`. 这是合法的，但它将所有缺失的元素初始化为零。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-03T17:20:19.677

这是 你必须使用的概念`comma operator`来初始化数组`comma separator``{}`

```
int a[2][5]={(8,9,7,67,11),(7,8,9,199,89)}; 
```

here`(8,9,7,67,11)`等价于`11`because of`comma operator` 并且`(7,8,9,199,89)`等价于`89`for the same 因为逗号运算符被计算为`left to right`并且最右边的值是返回的值

因此它相当于`a[2][5]={11,89}`

但是`(8,9,7,67,11),(7,8,9,199,89)`用逗号`() , ()`是`comma separator`

# c# - 解析 json 响应为空

> ID：13211554
> 
> 赞同：2
> 
> 时间：2012-11-03T17:18:32.887
> 
> 标签：c#, json, parsing

我在解析 json 时遇到问题。

json数据在这里：[http](http://beta.fmeserver.com/fmerest/engines/.json?token=0ccfa0400b2d760fa3519baf18a557edb118356e) ://beta.fmeserver.com/fmerest/engines/.json?token=0ccfa0400b2d760fa3519baf18a557edb118356e 。

我用[json2csharp](http://json2csharp.com/)创建了一些类，但搜索为空：

```
var url = "http://beta.fmeserver.com/fmerest/engines/.json?token=0ccfa0400b2d760fa3519baf18a557edb118356e";

WebClient client = new WebClient();
var json = client.DownloadString(url);
var search = JsonConvert.DeserializeObject<ServiceResponse>(json);

public class Engine
    {
        public int FMEBuildNumber { get; set; }
        public string FMEHostName { get; set; }
        public string FMEInstanceName { get; set; }
        public int currentJobID { get; set; }
        public int maxTransactionResultFailure { get; set; }
        public int maxTransactionResultSuccess { get; set; }
        public int resultFailureCount { get; set; }
        public int resultSuccessCount { get; set; }
        public int transactionPort { get; set; }
    }

    public class Engines
    {
        public List<Engine> engine { get; set; }
    }

    public class ServiceResponse
    {
        public string requestURI { get; set; }
        public string token { get; set; }
        public Engines engines { get; set; }
    }

    [JsonObject(MemberSerialization.OptIn)]
    public class RootObject
    {
        [JsonProperty("serviceResponse")]
        public ServiceResponse ServiceResponse { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:29:44.387

[使用Json.Net采用](http://json.codeplex.com/)*动态*方式怎么样？（不使用[http://json2csharp.com/](http://json2csharp.com/)生成的任何类）

```
var url = "http://beta.fmeserver.com/fmerest/engines/.json?token=0ccfa0400b2d760fa3519baf18a557edb118356e";
using (WebClient wc = new WebClient())
{
    string json = wc.DownloadString(url);

    dynamic dynobj = JsonConvert.DeserializeObject(json);

    foreach (var engine in dynobj.serviceResponse.engines.engine)
    {
        Console.WriteLine("{0} {1}", engine.FMEInstanceName, engine.transactionPort);
    }
} 
```

# powershell - 如何退出 PowerShell 中的 try-catch 块？

> ID：13211557
> 
> 赞同：2
> 
> 时间：2012-11-03T17:18:38.193
> 
> 标签：powershell, try-catch

我想从一个`try`块内退出：

```
function myfunc
{
   try {
      # Some things
      if(condition) { 'I want to go to the end of the function' }
      # Some other things
   }
   catch {
      'Whoop!'
   }

   # Other statements here
   return $whatever
} 
```

我用 a 测试过`break`，但这不起作用。如果任何调用代码在循环内，它会中断上层循环。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-03T17:34:49.270

一个额外的脚本块`try/catch`和`return`它可能会这样做：

```
function myfunc($condition)
{
    # Extra script block, use `return` to exit from it
    .{
        try {
            'some things'
            if($condition) { return }
            'some other things'
        }
        catch {
            'Whoop!'
        }
    }
    'End of try/catch'
}

# It gets 'some other things' done
myfunc

# It skips 'some other things'
myfunc $true 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T13:31:47.943

做你想做的事的规范方法是否定条件并将“其他事情”放入“then”块中。

```
function myfunc {
  try {
    # some things
    if (-not condition) {
      # some other things
    }
  } catch {
    'Whoop!'
  }

  # other statements here
  return $whatever
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-22T13:54:21.803

你可以这样做：

```
function myfunc
{
   try {
      # Some things
      if(condition)
      {
          goto(catch)
      }
      # Some other things
   }
   catch {
      'Whoop!'
   }

   # Other statements here
   return $whatever
} 
```

# jquery - history.js jquery is there something as a removestate

> ID：13211558
> 
> 赞同：1
> 
> 时间：2012-11-03T17:18:39.580
> 
> 标签：jquery, ajax, history.js

As the documentation for history.js is hard to find, seemingly non existent except for the demo's on github. Well I need to remove the last added stat. eg:

I have an Url which is called site/Random which calls a php for getting an random entry. Of course if I push the button for calling the url a pushstate will be added with this url...

So in the document itself I do another pushstate for the real url of the entry eg. /site/nobody. So I need to remove the last added pushstate.

Any Ideas?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T22:59:24.910

For all People running into a similar Problem as me, it's actually a bit tricky but you can do it with a little workaround.

The Problem is that if you bind it to the window statechange the content won't change if you click on the same link twice, and that happens quite often.

And if you just bind it on click your page of course won't know that there was the back event triggered as you didn't change the actual state.

So what to do:

1st you have to declare both a click and a bind.

2nd you have to get into the click function and have it trigger the binded function if the reloaded urls do match.

```
 if (old == path)
        {
            $(window).trigger('statechange');   
        } 
```

It's a quite easy solution but first of course you have to know the root of evil, hope this helps somebody.

# html - 使用没有 html 的 css sprite

> ID：13211560
> 
> 赞同：2
> 
> 时间：2012-11-03T17:18:52.933
> 
> 标签：html, css, css-sprites

我为多个图像创建了一个 css sprite 图像。精灵的 css 是：

```
.sprites {background-image:url("/images/max.png");background-color:transparent;background-repeat:no-repeat;}#image_5306605314403955_gif {height:10px;width:10px;background-position:0 0;}#image_2814089791124994_gif {height:8px;width:8px;background-position:-10px 0;}#image_05699283026450497_gif {height:36px;width:50px;background-position:-18px 0;}#image_23591702358881883_gif {height:9px;width:11px;background-position:-68px 0;}#image_9167572062810537_gif {height:10px;width:10px;background-position:-79px 0;}#image_21043553959746242_gif {height:16px;width:16px;background-position:-89px 0;} 
```

现在我想把这个精灵的第一张图片分配给一个 li 元素。目前，第一张图片是使用这个 li 的 background:url 属性分配的：

```
li{margin-top:0;padding:3px 0 3px 25px;background:url(../images/arrow.gif) 
```

如何从 sprite 中获取第一张图像并分配给 li 元素。我看过一个建议使用的例子：

```
<div class="sprites" id="image_5306605314403955_gif"></div> 
```

但我想看看是否可以避免添加 HTML 并仅将 CSS 用于此目的。我页面上的 li 元素如下所示：

```
<li><a href="http://www.xyz.com">ABC</a></li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T11:26:24.993

我不确定这是否是您正在寻找的东西，但下面的代码应该可以做到：

HTML：

```
<li class="sprites"><a id="image_5306605314403955_gif" href="http://www.xyz.com">ABC</a></li>
<li class="sprites"><a id="#image_9167572062810537_gif" href="http://www.xyz.com">ABC</a></li> 
```

CSS：

```
.sprites {background-image:url("/images/max.png");background-color:transparent;background-repeat:no-repeat;}
#image_5306605314403955_gif {height:10px;width:10px;background-position:0 0;}
#image_2814089791124994_gif {height:8px;width:8px;background-position:-10px 0;}
#image_05699283026450497_gif {height:36px;width:50px;background-position:-18px 0;}
#image_23591702358881883_gif {height:9px;width:11px;background-position:-68px 0;}
#image_9167572062810537_gif {height:10px;width:10px;background-position:-79px 0;}
#image_21043553959746242_gif {height:16px;width:16px;background-position:-89px 0;} 
```

如果您要查找的不是使用`class`or `id`，那么我认为这是不可能的，因为您的 CSS 需要一个标识符来区分您的项目（从同一类继承`<li>`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-25T00:02:38.097

```
body {
    overflow-y: scroll
}

.mini_iframe,
.serverfbml_iframe {
    overflow-y: visible
}

.auto_resize_iframe {
    height: auto;
    overflow: hidden
}

.pipe {
    color: gray;
    padding: 0 3px
}

#content {
    margin: 0;
    outline: none;
    padding: 0;
    width: auto
}

.profile #content,
.home #content,
.search #content {
    min-height: 600px
}

.UIStandardFrame_Container {
    margin: 0 auto;
    padding-top: 20px;
    width: 960px
}

.UIStandardFrame_Content {
    float: left;
    margin: 0;
    padding: 0;
    width: 760px
}

.UIStandardFrame_SidebarAds {
    float: right;
    margin: 0;
    padding: 0;
    width: 200px;
    word-wrap: break-word
}

.UIFullPage_Container {
    margin: 0 auto;
    padding: 20px 12px 0;
    width: 940px
}

.empty_message {
    background: #f5f6f7;
    font-size: 13px;
    line-height: 17px;
    padding: 20px 20px 50px;
    text-align: center
}

.see_all {
    text-align: right
}

.standard_status_element {
    visibility: hidden
}

.standard_status_element.async_saving {
    visibility: visible
}

img.tracking_pixel {
    height: 1px;
    position: absolute;
    visibility: hidden;
    width: 1px
} 
```

# html - Homepage loads differently than every other page

> ID：13211562
> 
> 赞同：-1
> 
> 时间：2012-11-03T17:18:57.067
> 
> 标签：html, css

Why does my homepage have a width of 1024 px. And every page after that has a width of 1280 px? Even as full screen this is how it loads up. How why?

Specs: Browser : Chrome Pages located on local machine. html very simple here is the css...

```
root { 
    display: block;
}
#leftcol a{text-decoration: none;}
#leftcol{   
    left: 10%;
    width: 200px;
    height: 100%;
    margin-top: 0px;
    position: absolute;
    opacity:0.6;
    color: white;
    font-size: 2em;
}
#left-placeholder{
    height: 100%;
    width: 10%;
    float: left;
}
#left-pusher{
    height: 100%;
    width: 200px;
    float: left;
}
.left-column-item{
    background: url('images/bgnav.jpg');
    height: 33.334%;
    background-size: 100%;
    opacity:0.6;
    color: white;
}
.left-column-item:hover{
    background: url('images/bgnav.jpg');
    height: 33.334%;
    background-size: 100%;
    opacity: 1;
}
#content{
    text-align: center;
    color: white;
    font-size: 5em;
    height: 100%;
    width: 70%;
    float:left;
}

body{
    background: url('images/background.jpg');
    background-size: 100%;
    margin: 0;
    min-height: 100%;
    width: 100%}
html, body
{
    height: 100%;
} 
```

//html for homepage:

```
<html>
    <head>
        <title></title>
        <LINK href="styles.css" rel="stylesheet" type="text/css">
        <script type ="text/javascript">

        </script>
    </head>
    <body>
            <div id ="leftcol">
                <a href="content/practice.html"><div class ="left-column-item">Practice!</div></a>
                <a href="content/AboutUs.html"><div class ="left-column-item">About Us!</div></a>
                <a href="content/contactUs.html"><div class ="left-column-item">Contact Us!</div></a>
            </div>
        <div id="left-placeholder"></div>
        <div id ="left-pusher"></div>
        <div id ="content">Math Practice Site<br>Welcome</div>
    </body>
</html> 
```

// the practice page that is not loading correctly

```
<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <LINK href="../styles.css" rel="stylesheet" type="text/css">
        <script type ="text/javascript">

        </script>
    </head>
    <body>
            <div id ="leftcol">
                <a href="practice.html"><div class ="left-column-item">Practice!</div></a>
                <a href="aboutUs.html"><div class ="left-column-item">About Us!</div></a>
                <a href="contactUs.html"><div class ="left-column-item">Contact Us!</div></a>
            </div>
        <div id="left-placeholder"></div>
        <div id ="left-pusher"></div>
        <div id ="content">Math Practice Site <br> hello</div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T18:51:13.500

如果您可以发布指向您网站的链接，那就太好了……看来您引用样式表的方式有所不同。尝试在其他页面中使用 index 调用：

```
 <LINK href="styles.css" rel="stylesheet" type="text/css"> 
```

代替

```
<LINK href="../styles.css" rel="stylesheet" type="text/css"> 
```

您可能正在调用一个完全不同的样式表。

您也可以尝试限制身体的宽度而不是使用 %

```
body{
background: url('images/background.jpg');
background-size: 100%;
margin: 0;
min-height: 100%;
width: 1024 px;} 
```

# raphael - 如何让 paper.print() 工作？

> ID：13211570
> 
> 赞同：0
> 
> 时间：2012-11-03T17:19:35.467
> 
> 标签：raphael

我一直试图让下面的拉斐尔代码只是在屏幕上写一些东西，但没有运气！

```
paper.print(30, 15, "TEXT", paper.getFont("Arial"), 20).attr({fill: "black"}); 
```

你还需要做些什么来获得论文中的文字吗？！？！！？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T21:59:37.900

您需要对字体进行[cufonize 化](http://cufon.shoqolate.com/generate/)，确保指明 cufonized 字体应向 Raphael 注册自身，并包含生成的 .js 文件，然后才能使用 getFont 检索它（默认情况下没有可用的字体）。如果您检查，我有理由确定您会发现`paper.getFont("Arial")`返回未定义。

Cufon 基本上将提供的字体中的每个字形转换为其等效的矢量——Raphael 只是简单地转换和排序这些路径以产生输出。

# javascript - Counting object pairs in JSON array

> ID：13211574
> 
> 赞同：4
> 
> 时间：2012-11-03T17:19:56.277
> 
> 标签：javascript, json

ive got a problem getting parameters from a json chain, the json I got looks something like this

```
[{"aa":"bb","ccc":"ddd","eeee":"ffff","ggggg":"hhhhh","iiiiii":"jjjjjj","kkkkkkk":"lllllll"}] 
```

Im trying to count how many pairs there are inside the '{}' but i dont know how. I tried `json.length` and `json[0].length`, the first one gave me back the value '1' and the second one `undefined`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:32:26.390

您的 json 对象是一个包含一个对象的数组。所以长度为1。数组中的对象有多个属性（键/值对）。

因此，在大多数现代浏览器（IE 除外）中，这对您有用：

```
Object.keys(json[0]).length 
```

在此处查看用于在 JavaScript 中迭代/计算对象属性的各种技术的答案：

*   [如何有效地计算 JavaScript 中对象的键/属性数？](https://stackoverflow.com/questions/126100/how-to-efficiently-count-the-number-of-keys-properties-of-an-object-in-javascrip)

# xml - Spring REST MVC: validation of incoming XML (without using form)

> ID：13211577
> 
> 赞同：1
> 
> 时间：2012-11-03T17:20:03.320
> 
> 标签：xml, spring, rest, validation

I have a controller that receives as @RequestBody a string containing a request XML.

```
@RequestMapping(method = RequestMethod.POST, value="/app-authorization")
public Response getAppAuthorization(
        HttpServletResponse response, BindingResult results,
        @RequestBody String body){
    log.info("Requested app-authorization through xml: \n" + body);

    Source source = new StreamSource(new StringReader(body));
    RefreshTokenRequest req = (RefreshTokenRequest) jaxb2Mashaller.unmarshal(source);

    validator.validate(req, results);
    if(results.hasErrors()){
        log.info("DOESN'T WORK!");
        response.setStatus(500);
        return null;
    }
    InternalMessage<Integer, Response> auth = authService.getRefreshToken(req);
    response.setStatus(auth.getHttpStatus());
    return auth.getReponse();
} 
```

The AuthorizationValidator is the following:

```
@Component("authenticationValidator")
public class AuthenticationValidator implements Validator{

    public boolean supports(Class<?> clazz) {
        return AuthorizationRequest.class.isAssignableFrom(clazz);
    }

    public void validate(Object target, Errors errors) {
        errors.rejectValue("test", "there are some errors");

    }
} 
```

I'd like to know if there's a way to inject an object Validator into my controller in such a way that:

1.  @Autowired \n Validator validator; makes me obtain automatically a reference to my AuthenticationValidator
2.  every controller is linked to one or more validators withouth indicating their class explicitly.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T20:52:45.663

你手动做的很多事情都可以完全由 Spring MVC 处理，你应该能够让你的方法得到这个结构：

```
@RequestMapping(method = RequestMethod.POST, value="/app-authorization")
public Response getAppAuthorization(@Valid @RequestBody RefreshTokenRequest req, BindingResult results){

    if(results.hasErrors()){
        log.info("DOESN'T WORK!");
        response.setStatus(500);
        return null;
    }
    InternalMessage<Integer, Response> auth = authService.getRefreshToken(req);
    response.setStatus(auth.getHttpStatus());
    return auth.getReponse();
} 
```

Spring MVC 负责调用 JAXB 解组器，并`@Valid`在类型上进行注释以负责验证。

现在要为您的类型注册一个自定义验证器，您可以这样做：

```
@InitBinder
protected void initBinder(WebDataBinder binder) {
    binder.setValidator(this.authenticationValidator );
} 
```

如果您想全局设置它而不是针对特定控制器，您可以创建自定义全局验证器，在内部委托给其他验证器，例如：

```
public class CustomGlobalValidator implements Validator {

    @Resource private List<Validator> validators;

    @Override
    public boolean supports(Class<?> clazz) {
        for (Validator validator: validators){
            if (validator.supports(clazz)){
                return true;
            }
        }
        return false;
    }

    @Override
    public void validate(Object obj, Errors e) {
        //find validator supporting class of obj, and delegate to it

    }
} 
```

并注册这个全局验证器：

```
<mvc:annotation-driven validator="globalValidator"/> 
```

# php - MySQL db 未使用 php 处理从表单更新

> ID：13211578
> 
> 赞同：1
> 
> 时间：2012-11-03T17:20:07.287
> 
> 标签：php, mysql, forms, sql-insert

使用代码

```
# the data we want to insert
$data = array($first_name, $last_name, $email_from, $telephone, $dateofbirth, $addresslone, $addressltwo, $townnm, $countynm, $typeapp, $issubscribed);
$STH = $dbh->prepare("INSERT INTO members (fname, sname, email, phone, dob, addressl1, addressl2, town, county, type, subscribed) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)");
$STH->execute($data);

?>
<!--<!DOCTYPE html>
<head><title></title></head><body> commented out during testing -->

Thank you for contacting us  We will be in touch with you very soon.

<!-- </body></html> --> 
```

向用户显示成功消息：

> 感谢您与我们联系，我们会尽快与您联系。

没有记录 php 错误。

这是插入到这个数据库中![MQL 列](../Images/c968594a6a3ed0c6ffdcc618f43d383c.png)

错误报告采用 PDO try catch 的形式：

```
catch(PDOException $e)
    {
    echo $e->getMessage();
    } 
```

然而，尽管它看起来好像运行良好，但数据库似乎无法接收更新。：/

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T17:24:17.150

As per your database structure screenshot, `table name is member` and `you used members` into `your insert query`

# asp.net - Managing images in asp.net repeater (add class to each picture)

> ID：13211586
> 
> 赞同：0
> 
> 时间：2012-11-03T17:21:01.513
> 
> 标签：asp.net, webforms

This is my code:

Codebehind:

```
public class data
....
...

public List<dataImages> Images { get; set; }
...

var data= GarageBLL.LoadData(Convert.ToInt32(DataId), Convert.ToInt32(MemberId));
rptImages.DataSource = data.Images.Take(3);
rptImages.DataBind(); 
```

aspx:

```
 <asp:Repeater runat="server" ID="rptImages">
        <ItemTemplate>
            <asp:Image runat="server" CssClass="img1" ImageUrl='<%# String.Format("/images/{0}/{1}.{2}", DataId, Eval("ImageId"), Eval("Extension")) %>' />
        </ItemTemplate>
    </asp:Repeater> 
```

So, this works at the moment, but **i would like to add different classes to each image**. Anyone got any idea how i can do that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:26:23.213

您可以使用中继器的[`ItemDataBound`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.itemdatabound.aspx)事件来设置`CssClass`：

```
protected void rptImages_ItemDataBound(Object Sender, RepeaterItemEventArgs e) {
      // This event is raised for the header, the footer, separators, and items.
      // Execute the following logic for Items and Alternating Items.
      if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem) {
         dataImages img = (dataImages) e.Item.DataItem;
         Image img1 = (Image) e.Item.FindControl("img1");
         // add your correct logic here according to the dataImages properties
         img.CssClass = "YourCssClass";
         // assuming you just want different classes for your three images, use ItemIndex with remainder:
         string class = "img" + (e.Item.ItemIndex % 3 + 1).ToString() + "class";
         img.CssClass = class;
      }
   } 
```

# javascript - Javascript replace() and regex

> ID：13211588
> 
> 赞同：0
> 
> 时间：2012-11-03T17:21:07.957
> 
> 标签：javascript, regex

Im trying to use javascript and regex to replace a substring in a url.

```
myurl.com/?page_id=2&paged=2 
```

shall become

```
myurl.com/?page_id=2&paged=3 
```

this is my code that doesnt seem to work:

```
nextLink = 'myurl.com/?page_id=2&paged=2'
nextLink = nextLink.replace(/\/paged\=\/[0-9]?/, 'paged='+ pageNum); 
```

What am i doing wrong here? Im new to regex.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:25:01.027

你告诉它 match `/paged`，但`/paged`你的字符串中没有。此外，`[0-9]?`可能不是您想要的数字。尝试这个：

```
nextLink.replace(/\&paged=[0-9]+/, 'paged=' + pageNum); 
```

这告诉它用给定的字符串替换`&pageid=...`（其中`...`是一系列一个或多个数字）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:23:38.703

You don't need to escape the `=`, and you have some additional slashes to match that don't exist in your sample url. Without them, it should work:

```
nextLink = nextLink.replace(/[?&]paged=[0-9]?/, 'paged='+ pageNum); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T17:24:43.773

Yours:

```
nextLink = nextLink.replace(/\/paged\=\/[0-9]?/, 'paged='+ pageNum); 
```

Mine:

```
nextLink = nextLink.replace(/&paged=[0-9]?/, 'paged='+ pageNum); 
```

i.e. you wrote `\/` when you meant `&`. You also wrote it before the digits for some reason. And you don't need to escape `=`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-03T17:33:41.680

[既然可以使用优秀的`URI.js`库](http://medialize.github.com/URI.js/)，为什么还要使用正则表达式？

```
URI("myurl.com/?page_id=2&paged=2")
    .removeQuery("paged")  // remove so we don't have a duplicate
    .addQuery("paged", pageNum)
    .toString(); 
```

你不用担心逃跑，`URI.js`一切都为你做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-03T17:36:38.840

使用回调函数：

```
var r = new RegExp("paged=(\\d+)");
s = s.replace(r, function($1, $2){ return "paged=" + (parseInt($2, 10) + 1); }); 
```

请参阅**[此演示](http://jsfiddle.net/QUxsj/)**。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-03T17:22:53.253

Too many slashes. `\/` will try to match a literal slash which is not there:

```
nextLink = nextLink.replace(/paged=[0-9]?/, 'paged='+ pageNum); 
```

However, I think there should be better methods to parse and re-assemble URLs in Javascript.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-03T17:28:48.483

这是一个不使用正则表达式的解决方案。

```
var url ="myurl.com/?page_id=2&paged=2" , pageNum=3;
url = url.split("paged=")[0]+"paged="+pageNum; 
```

[演示](http://jsfiddle.net/s4tmR/)

# java - JFrame in netbeans not implementing

> ID：13211592
> 
> 赞同：-1
> 
> 时间：2012-11-03T17:21:31.683
> 
> 标签：java, swing, jframe

I'm trying to implement a new Jframe in net beans with

```
JFrame frame = new JFrame("shooter"); 
```

however when it is run nothing is happening. I have run the same code in another IDE and it works fine however I am not seeing a JFrame on the screen. I ran a test to see weather everything was compiling and that there was no syntactical or lexical error so nothing seems to be wrong per say. Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:51:22.197

根据您提供的信息很难提供答案，但我会尽力而为。通过实例化一个新的 JFrame 对象，您不会让它出现在屏幕上。

创建和显示新框架的示例如下所示

```
 JFrame frame = new JFrame("Title");
    frame.setSize(500, 500);  //This method will set the size of the frame to 500 by 500.
    frame.setVisible(true);  //This method makes the frame visible 
```

我希望我能有所帮助。

# math - How can I convert coordinates on a circle to coordinates on a square?

> ID：13211595
> 
> 赞同：9
> 
> 时间：2012-11-03T17:21:43.693
> 
> 标签：math, coordinate-systems

I'm currently working on a game in LBP2 that has modify the way a controller gives input. This question: [How can I convert coordinates on a square to coordinates on a circle?](https://stackoverflow.com/questions/1621831/how-can-i-convert-coordinates-on-a-square-to-coordinates-on-a-circle) Has helped me quite a lot with what I am doing, but I do have one problem. I need the inverse function of the one they give. They go from square -> circle, and I've tried searching all over for how to map a circle to a square.

The function given in the previous question is:

> xCircle = xSquare * sqrt(1 - 0.5*ySquare^2)
> 
> yCircle = ySquare * sqrt(1 - 0.5*xSquare^2)
> 
> From [Mapping a Square to a Circle](http://mathproofs.blogspot.com/2005/07/mapping-square-to-circle.html)

My question is given xCircle and yCircle... how do I find xSquare and ySquare?

I've tried all of the algebra I know, filled up two pages of notes, tried to get wolfram alpha to get the inverse functions, but this problem is beyond my abilities.

Thank you for taking a look.

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2015-09-04T06:49:35.693

> x = ½ √( 2 + u² - v² + 2u√2 ) - ½ √( 2 + u² - v² - 2u√2 )
> y = ½ √( 2 - u² + v² + 2v√2 ) - ½ √( 2 - u² + v² - 2v√2)

注意符号：我使用 x = xSquare ， y = ySquare， u = xCircle 和 v = yCircle;

即**(u,v)**是圆盘坐标，**(x,y)**是方坐标。

[![网格映射](../Images/9f201c72b23297dedfb6b9d2a9801266.png)](https://i.stack.imgur.com/VSFoo.png)

有关方程的 C++ 实现，请访问
[http://squircular.blogspot.com/2015/09/mapping-circle-to-square.html](http://squircular.blogspot.com/2015/09/mapping-circle-to-square.html)

有关更多示例图像，请参见[http://squircular.blogspot.com](http://squircular.blogspot.com) 。
此外，有关证明/推导，请参见[http://arxiv.org/abs/1509.06344](http://arxiv.org/abs/1509.06344)

这个映射是

> u = x √( 1 - ½ y² )
> v = y √( 1 - ½ x² )

* * *

PS映射不是唯一的。还有其他映射。下图说明了映射的非唯一性。

[![波士顿凯尔特人队](../Images/0563f51fd2be6bc87a2b0222d0f1f535.png)](https://i.stack.imgur.com/rDL3l.jpg)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T18:11:48.670

如果你有 xCircle 和 yCircle 这意味着你在一个有 radius 的圆上`R = sqrt(xCircle^2 + yCircle^2)`。现在您需要将该圆扩展为一个半边 = R 的正方形，

```
if (xCircle < yCircle)
     ySquare = R, xSquare = xCircle * R/yCircle
else
     xSquare = R, ySquare = yCircle * R/xCircle 
```

这是第一象限，对于其他象限，您需要对标志进行一些微不足道的调整

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-11T02:40:36.947

我正在实施上述解决方案，但结果并不令人满意。方坐标不准确。

下面是一个简单的反例：

*   考虑正方形上的点 (x,y)=(0.75, 1)。
*   我们将它映射到圆上 (u,v)=(0.53, 0.85) 的圆。
*   应用上面的表达式，我们得到新的正方形坐标

    (x',y')=(u/v,r)=(0.625543242, 1) 其中 r=(u^2+v^2)^(1/2)。

这一点很接近，但不是预期的精确解决方案。

我解决了一个求根问题，以便像上面一样获得从正方形到圆形的映射的逆表达式。您需要求解上述系统方程：

```
I) u = x*(1-y^2/2)^(1/2)
II) v = y*(1-x^2/2)^(1/2) 
```

一个最终以 8 个根点作为解决方案。我在下面介绍的 Excel-VBA 中实现的根之一，它工作得很好。

```
' given the circle coordinates (u,v) caluclates the x coordinate on the square
Function circ2sqrX(u As Double, v As Double) As Double
    Dim r As Double, signX As Double, u2 As Double, v2 As Double, uuvv As Double, temp1 As Double
    u2 = u * u
    v2 = v * v
    r = Sqr(u2 + v2)
    signX = 1
    If v = 0 Or u = 0 Then
       circ2sqrX = u
       Exit Function
    End If
    If u < 0 Then
    signX = -1
    End If
    If Abs(u) = Abs(v) And r = 1 Then
       circ2sqrX = signX
       Exit Function
    End If
    uuvv = (u2 - v2) * (u2 - v2) / 4
    temp1 = 2 * Sqr(uuvv - u2 - v2 + 1)
    circ2sqrX = -((temp1 - u2 + v2 - 2) * Sqr(temp1 + u2 - v2 + 2)) / (4 * u)
End Function

' given the circle coordinates (u,v) caluclates the y coordinate on the square
' make use of symetrie property
Function circ2sqrY(u As Double, v As Double) As Double
    circ2sqrY=circ2sqrX(v,u)
End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-13T12:52:20.593

有很多方法可以做到这一点；这是一种简单的方法。

想象一个以原点为中心的半径为*R*的圆，以原点为中心的边为*2R*的正方形，我们想要将圆内和圆的边界上的所有点（坐标为*(x,y)*）映射到圆内的点并且在广场的边界上。请注意，我们还可以使用[极坐标](http://en.wikipedia.org/wiki/Polar_coordinate_system) *(r, ø)*来描述圆内的点（应该是 phi），其中

> x = r cos ø,
> y = r sin ø

（即*r^2 = x^2 + y^2*和*r <= 1*）。然后想象其他坐标*x' = a(ø) x = a(ø) r cos ø*和*y' = a(ø) y*（即，我们决定*a*不依赖于*r*）。

为了将圆的边界 ( *r = 1* ) 映射到正方形的边界 ( *x' = R* )，我们必须有，对于*ø < 45deg*，*x' = a(ø) R cos ø = R*，所以我们必须有*a(ø) = 1/cos ø*。类似地，对于*45 < ø < 90*，我们必须将圆映射到*y' = R*的边界，在该区域中给出*a(ø) = 1/sin ø*。继续绕圆，我们看到*a(ø)*必须始终为正，所以从圆到正方形的最终映射是

> x' = a(ø) x,
> y' = a(ø) y

在哪里

> *ø* = |反正切*y/x* | = 反正切 | *y/x* |

和

> *a(ø) = 1/cos ø*，当*ø* <= 45 度时（即，当*x < y*时），并且
> *a(ø) = 1/sin ø*，当*ø* > 45 度时。

这会立即为您提供另一个方向的映射。如果您在正方形上有坐标*(x', y') （其中**x' <= R*和*y' <= R*），那么

> *x = x'/a(ø)*
> *y = y'/a(ø)*

与*a(ø)*同上。

* * *

然而，一个更简单的映射是计算圆上所需位置的*(r, ø)*，并将其映射到*x' = r*和*y' = ø*。这也将圆中的每个点映射到一个矩形中，反之亦然，并且可能具有更好的属性，*具体取决于您想要做什么*。

所以这才是真正的问题：你在这里的真正目标是什么？

# ruby-on-rails - Rails Puzzle: Check if a nested value exists, if it does don't save it but save the child values

> ID：13211597
> 
> 赞同：1
> 
> 时间：2012-11-03T17:21:46.833
> 
> 标签：ruby-on-rails, forms, model, nested-forms, nested-attributes

I have a challenge that I have been struggling to tackle for the last few hours.

I have a form with nested attributes. Each Post has and belongs to many Locations. I need each Location to be unique but I also need to be able to add the same location to many posts. Ideally this validation would be done within the model.

*   So, in my posts form what currently happens is a user 'adds a location', they then search the foursquare API for a location.
*   Upon submit this is saved into the Locations table with the location name and the longitude and latitude, there is a Locations_Posts table which ties these together.
*   What needs to happen is the posts model should check if a location exists, if it does, don't add anything to Locations, just add the relevant data to the Locations_Posts table.

After some research I have worked out that I need something like this:

```
*Posts.rb*

# =================
# = Location validations = 
# = If location exists then just add to locations_posts, else create new location =

def locations_attributes
location && location.name
end

def locations_attributes=(value)
self.location = Location.find_by_name(value)
self.location ||= Location.new(:name => value)
end 
```

(Stolen from [rails: create Parent, if doesn't exist, whilte creating child record](https://stackoverflow.com/questions/3588811/rails-create-parent-if-doesnt-exist-whilte-creating-child-record))

However, I'm getting errors such as:

```
Unknown key: 0 
```

I think I must be close with this snippet but need some help to get over the last hurdle!

Thanks in advance,

James

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T15:52:17.123

尝试使用：

```
def locations_attributes=(value)
  self.location = Location.find_or_create_by_name(value)
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-13T15:03:30.283

在rails 4中，这非常有效。谢谢大家。

```
def locations_attributes=(value)
  self.location = Location.find_or_create_by(value)
end 
```

这将检查为位置传递的所有属性的唯一性。

# java - Java - java.lang.NullPointerException (put data into List<>)

> ID：13211605
> 
> 赞同：0
> 
> 时间：2012-11-03T17:22:54.657
> 
> 标签：java

I would like to know why I have got this error. Have you got idea and do you know how to fix it?

Error(I get this error in put()):

```
Exception in thread "main" java.lang.NullPointerException
at nacs.put(nacs.put:36)
at Program.main(Program.java:69) 
```

Program: (Main)

```
Nac nacs = new Nac();
nacs.put(new Intsult(1));
nacs.put(new Intsult(2)); 
```

Class:

```
public class Nac implement IPoraw
{
public List<IAbstrsUlt> abs;
public void put(IAbstrsUlt value)
{
abs.add(value);
}
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-03T17:23:50.037

Initialize list.

```
private List<IAbstrsUlt> abs = new ArrayList<IAbstrsUlt>(); 
```

*Note: You should always try to declare your members more restrictive. Default value for Object is null. Refer [Oracle tutorial](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html) to know default values.*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T17:25:06.580

变量 abs 永远不会初始化。

尝试这个

```
public List<IAbstrsUlt> abs = new ArrayList<>(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T17:29:01.657

```
public List<IAbstrsUlt> abs; 
```

**-**在上面的语句中，您只是简单地**声明**了一个`List Reference Variable`名为`abs`type的名称`IAbstrsUlt`，并且由于`Object Reference Variable`它的**默认值为**，`null`所以在这种情况下也是如此。

**-**你必须**初始化**它。

`public List<IAbstrsUlt> abs = new List<IAbstrsUlt>();`

# javascript - get html input into a rails function

> ID：13211608
> 
> 赞同：0
> 
> 时间：2012-11-03T17:23:41.153
> 
> 标签：javascript, ruby-on-rails-3

I have a piece of html like this:

```
 <div class="row well">
      <form method="POST">
        <ol id="velArea">
          <li>  Layer velocity: (m/s) <input type="text" name="source[]"> </li>
        </ol>
        <input type="button" value="Add another layer" name="velocity" onClick="addVel('velArea');">
      </form>
    </div> 
```

and a javascript function that adds html to the area

```
 function addVel(area)
    {
      var field_area = document.getElementById(area);
      field_area.innerHTML += "<li>  Layer velocity: (m/s) <input type='text' name='velocity'> <a style='cursor:pointer;color:grey;' onclick='this.parentNode.parentNode.removeChild(this.parentNode);''>delete</a> </li>";
    } 
```

I need to read the value of each input field in a rails function. And have no idea about how to do that. I've lost days going through active model in rails, thinking that was the way until I finally figured out that is better to keep the browser-related and server related things separated. So I learned a little javascript and made a few functions. Yes, I'm new to web development. I'm using rails 3.2.

The function that I want to uses the fields info is called by a button:

```
 <%= button_to "Run single inversion", {:action => "my_func", }, {:remote => true, :form => { "data-type" => "json" }, :class => "btn btn-primary"} %> 
```

and the function on the controller is:

```
 def my_func
      render :nothing => true
      vel = params[:velocity]
      puts vel.class
      puts 'Hi'
    end 
```

the output I get is

```
 NilClass
    Hi 
```

so I'm clearly not passing the arguments right. I'm guessing I need to pass the velocity array in the post method when I use the button_to, but have no idea about how to do that.

Also, I'm need the value of the input, not anything database oriented so I cannot look it up using activeRecord properties.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:40:47.103

在您的 Rails 控制器中，您应该能够`params[:model_name]`在 javascript 将表单提交给您需要它使用的任何方法时访问。您还可以访问一个`params[:id]`或`params[:firstname]`

我也有点困惑你在做什么 `<input type='text'> </input>`

没有名称属性，模型需要该属性来识别它并将其值与列相关联。它也不是正确的输入方式。

`<input type="text" name="column_name"/>`

更接近你想要的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T23:38:52.290

我不确定你的代码为什么这么复杂。但基本上有一些东西不是 RailsWay。首先，您应该看看[Rails Form Helpers](http://guides.rubyonrails.org/form_helpers.html)。如果您使用约定，您将收到如下的 params 哈希：

```
params[:velocities][:velocity]
params[:velocities][:source] 
```

表单标签看起来像这样：

```
<input type="text" name="velocities[velocity]" id="velocities_velocity" value="">
<input type="text" name="velocities[source]" id="velocities_source" value=""> 
```

在上面的代码中，您期望 vel 的值。产生的 NilClass 是因为 params[:velocity] 中有 nil，所以 vel 是 nil。您应该检查以下内容：

```
puts params.inspect 
```

或者在运行 Rails 应用程序时查看日志。

请重新检查按钮和输入字段的名称属性。它们的名称属性都是“速度”。如果按钮是提交的后者，那么 params[:velocity] 的值肯定是空的......

# delphi - DataSnap 是否针对同时响应超过 1000 个用户进行了优化？

> ID：13211613
> 
> 赞同：8
> 
> 时间：2012-11-03T17:24:18.880
> 
> 标签：delphi, firebird, datasnap, multi-tier, delphi-xe3

我们想启动一个大型的多层应用程序。服务器端应用程序必须同时响应 1000 多个用户。我们想通过 64 位编译器和 32 位客户端创建服务器应用程序。在这种情况下，我们不知道 DataSnap 是否可以毫无问题地响应所有客户端？在这种情况下，服务器计算机非常强大（多处理器和超过 16GB 的 RAM），数据库管理系统是 FireBird 2.5。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-03T20:01:49.587

您需要一种方法来执行实际的负载测试。

对于 Firebird 数据库，您可以使用免费的 Apache JMeter 工具模拟并发用户。它可以运行 SQL 语句并记录它们的执行时间统计信息（平均值、最小值/最大值等）。因此，例如，您可以创建一个包含 20 个不同 SQL 查询的线程组，然后运行 ​​20 个线程，每个线程将按顺序执行这些查询。

JMeter 允许定义 SQL 查询的时间限制，如果查询超过此限制，JMeter 将其视为错误。然后，您可以尝试找出总错误率仍低于（例如）5% 的最大客户端数。

但是您还需要知道预期的数据库负载会有多高，并且您还需要有一个实际大小的测试数据库，而不仅仅是几条记录。此外，一些数据库查询（如报告）可能会导致更高的负载 - 这些也应该包含在模拟中，因为它们会影响整体性能。在 JMeter 中，您可以创建第二个线程组，与第一个线程组并行运行，用于具有不同设置（较少模拟客户端）的这些长时间运行的语句。

测试数据库将显示该区域是否已经存在瓶颈。例如，测试结果可能是数据库可以为 20 个客户端提供服务，总平均事务率为 20 TPS（每秒事务数），这意味着一个客户端每秒执行一个事务。但是这个 TPS 值会随着用户数量的增加而降低。

相关问题：[Firebird 在大型项目](https://stackoverflow.com/questions/8242965/firebird-usage-in-big-projects)中的使用，也有指向[http://www.firebirdsql.org/en/case-studies-catalog/的链接](http://www.firebirdsql.org/en/case-studies-catalog/)

关于 DataSnap 客户端负载模拟：这可以通过脚本客户端完成，该客户端通过连接运行一组预定义的语句/命令。要同时运行大量负载测试客户端，您可以使用 Amazon Elastic Compute Cloud ( [EC2](http://en.wikipedia.org/wiki/Amazon_Elastic_Compute_Cloud) ) 之类的服务来启动测试机器映像的克隆，从而节省硬件成本。但当然我会从一台小型客户端机器开始，它只运行十个或二十个脚本客户端。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-04T11:37:39.047

据我所知，DataSnap 是基于 Indy 的。而且 Indy 的连接处理模型不是很可扩展——每个连接一个线程，这非常消耗资源。我认为即使使用 Indy 的线程池也不是一种选择……例如，在 Windows（32 位）中，您可以创建的最大线程数有一个限制（2000 IIRC）。无论如何 - 使用多线程并不好，并且会影响服务器的性能（供参考 - Windows Internals book、Windows Performance Team blog 等）

可扩展、强大且专业的应用服务器将使用 IO 完成端口 (IOCP) 进行数据处理。但我不知道 DataSnap 是否可以利用它。

**更新：** 在 CodeRage7 上，我问了类似的可扩展性问题。以下是答案：

**问：**最近 StackOverflow 上有一个关于 DataSnap 的可扩展性/性能的问题。那么 DS 能否在网络和应用程序级别处理 2000 个或更多并发用户请求？

**答：**可伸缩性基于 TCP/HTTP/HTTPs 的可伸缩性和服务器操作系统中允许的连接数。还基于您使用的内存和硬件。DataSnap 没有具体限制。

**我的评论：**虽然这是真的，但 Indy 的连接处理模型，即每个连接一个线程，会引入瓶颈，尤其是在 32 位 Windows（最大 2000 个线程）中。在 Win64 中，这应该不是什么大问题，但同样 - 这种处理数据流会导致性能下降。

**问：** DataSnap 是否支持某种负载平衡？

**答：**不直接。您可以在 DataSnap 服务器的代码中执行此操作。

**我的评论：**我在 Andreano Lanusse 的博客中找到了关于[在 DataSnap 中实现故障转移/负载平衡的非常好的论文](http://www.andreanolanusse.com/en/implementing-failover-and-load-balancing-in-datasnap-2010)

**问：** DataSnap 是否支持 IO 完成端口以获得更好的可扩展性？

我的这个问题没有得到回答。

希望这可以帮助！

**更新2：**

我在 DS 性能上发现了非常有趣的帖子：[基于速度和稳定性测试的 DataSnap 分析](https://robertocschneiders.wordpress.com/2012/11/22/datasnap-analysis-based-on-speed-stability-tests/)

**更新3：**

*   [DataSnap、部署、性能等 (Marco Cantu)](http://blog.marcocantu.com/blog/datasnap_deployment_performance.html)
*   [在 DataSnap XE2 中监控和控制连接 - 翻译成英文](http://translate.google.com/translate?sl=pt&tl=en&js=n&prev=_t&hl=bg&ie=UTF-8&layout=2&eotf=1&u=http://www.andreanolanusse.com/pt/monitoramento-e-controle-de-conexoes-em-datasnap-xe2&act=url)
*   [监视和控制 DataSnap XE2 中的连接 - 原始](http://www.andreanolanusse.com/pt/monitoramento-e-controle-de-conexoes-em-datasnap-xe2)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-04T02:05:14.417

在制定系统规范时，当涉及多个用户时，您需要非常精确。

例如：您创建了一个网站，而客户期望有 15.000 个唯一用户。然后客户端通常会提出系统需要支持15.000个同时用户的要求，这是非常幼稚的。

您将需要比这更详细的规范。

通常更明智的说法是：在 99% 的请求中，99% 的用户可以在平均 5 秒内得到响应。

在正常使用中，您永远不会看到所有用户在同一秒内发送请求。如果在某个时刻它们都在同一分钟内到达（也不太可能），那么并发用户会少很多。

即使对于拥有数以万计用户的网站，其中大多数人每天都连接，网络服务器大部分时间都是空闲的，有时它会跳到 5%，在极端情况下会跳到 20%。如果我们真的必须同时为所有这些用户提供服务，那我们就完蛋了，但这永远不会发生，而且为这样的负载准备服务器是不现实的。

# python - Is there equivalent functionality for 'echo -en ...' in python?

> ID：13211614
> 
> 赞同：0
> 
> 时间：2012-11-03T17:24:20.123
> 
> 标签：python, bash, shell, echo

> **Possible Duplicate:**
> [Replace console output in python](https://stackoverflow.com/questions/6169217/replace-console-output-in-python)

I am trying to write a program that outputs information including updates to the command line. What I mean by updates is, for example, if files are being processed by the program, perhaps it will keep an updated count of the files processed so far. So `1 file` is replaced with `2 files` and then with `3 files` and so forth.

The following is a sample piece of code that counts out some files and then displays a [loading bar](https://stackoverflow.com/questions/238073/how-to-add-a-progress-bar-to-a-shell-script):

```
#!/bin/bash

for a in {1..10}
do
    echo -ne " $a files processed.\r"
    sleep 1
done
echo ""
echo -ne '#####                     (33%)\r'
sleep 1
echo -ne '#############             (66%)\r'
sleep 1
echo -ne '#######################   (100%)\r'
echo -ne '\n' 
```

Basically, the command line output gets periodically overwritten giving the effect of a primitive text-based animation in the terminal.

There are two problems here:

1.  From what I know from doctors, the `echo` command is not portable at all.
2.  I want to do this in a python program, not with a bash file.

Is there a way to achieve functionality similar to this using python?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:35:35.140

Python 中的等效实现是这样的：

```
import sys, time

for a in range(1,11):
    sys.stdout.write('\r {0} files processed.'.format(a))
    time.sleep(1)

print('')
sys.stdout.write('\r#####                     (33%)')
time.sleep(1)
sys.stdout.write('\r#############             (66%)')
time.sleep(1)
sys.stdout.write('\r#######################   (100%)')
print('') 
```

您需要使用`sys.stdout.write`as`print`默认添加一个换行符。如果您正在使用打印功能（Python 3，或通过在 Python 2 中显式导入它），您也可以使用`print('text', end='')`. 或者，在 Python 2 中，您可以使用 print-statement 的功能来抑制行终止，如下所示：`print 'text',`

# spring-security - How to store spring security session information in redis?

> ID：13211615
> 
> 赞同：5
> 
> 时间：2012-11-03T17:24:20.380
> 
> 标签：spring-security, redis, session-management

I am using Spring security for Authentication and Authorization in my application. I am using Neo4j database as backend and implemented userDetailsService for authentication.

However, whenever my application restarts, user is forced to login once again. To overcome this, i am thinking to store session information in redis database and load the data to Spring security Context whenever application gets started.

Kindly pass on if there are any articles and pointers to implement the same.

I am thinking of following implementation for it, 1) For every successful authentication, store user details and session details in redis. This must be implemented in loadUserByUsername() method of UserDetailsService implementation 2) Remove the data from redis, whenver user logs out, Where can i do this information? Is there any spring security function where i can call this 3) Load all the data from redis to spring security whenever application restarts, again where do i need to write this logic?

Please let me know if i have missed any information.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-14T14:31:05.217

您需要做的就是实施一个

*   SecurityContextRepository 处理安全上下文存储到红色
*   最终一个自定义过滤器检索/存储会话信息（GenericFilterBean）

我认为可以只给标准过滤器一个不同的存储库，但我不确定，无论如何我需要自己的实现......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-26T10:37:48.360

在 redis 中存储会话现在是开箱即用的功能

[http://docs.spring.io/spring-session/docs/current/reference/html5/guides/httpsession.html](http://docs.spring.io/spring-session/docs/current/reference/html5/guides/httpsession.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T09:13:21.567

您需要配置 Spring Security 的记住我功能。

> 记住我或持久登录身份验证是指网站能够记住会话之间主体的身份。这通常是通过向浏览器发送 cookie 来完成的，该 cookie 在未来的会话中被检测到并导致自动登录发生。Spring Security 为这些操作的发生提供了必要的钩子，并且有两个具体的 remember-me 实现。一种使用散列来保护基于 cookie 的令牌的安全性，**另一种使用数据库或其他持久性存储机制来存储生成的令牌**。

Spring Security 文档中提供了更多信息：http: [//static.springsource.org/spring-security/site/docs/3.1.x/reference/remember-me.html](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/remember-me.html)

您可以使用开箱即用的实现或注入您自己的（上述 redis）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-27T16:01:58.260

正如 Luke Taylor 所说，Tomcat 的默认操作是在容器重启时序列化/反序列化会话。 [这里](http://tomcat.apache.org/tomcat-7.0-doc/config/manager.html)

标准管理器的 pathname 属性是序列化文件的名称。如果您不指定路径名 attirbute，则默认为 SESSIONS.SER 如果您不想在重新启动时恢复会话，则需要将其指定为空字符串值。

# c - 收到警告“赋值使指针从没有强制转换的整数”

> ID：13211618
> 
> 赞同：1
> 
> 时间：2012-11-03T17:24:34.657
> 
> 标签：c, compiler-warnings

我在第 59 行收到此警告：

> 赋值从没有强制转换的指针生成整数。

我该如何解决？这是整个文件（从[http://pastebin.com/BrmjBAS0](http://pastebin.com/BrmjBAS0)复制）：

```
/* bkerndev - Bran's Kernel Development Tutorial
*  By:   Brandon F. (friesenb@gmail.com)
*  Desc: Global Descriptor Table management
*
*  Notes: No warranty expressed or implied. Use at own risk. */

/* Defines a GDT entry */
struct gdt_entry
{
    unsigned short limit_low;
    unsigned short base_low;
    unsigned char base_middle;
    unsigned char access;
    unsigned char granularity;
    unsigned char base_high;
} __attribute__((packed));

struct gdt_ptr
{
    unsigned short limit;
    unsigned int base;
} __attribute__((packed));

/* Our GDT, with 3 entries, and finally our special GDT pointer */
struct gdt_entry gdt[3];
struct gdt_ptr gp;

/* This is in start.asm. We use this to properly reload
*  the new segment registers */
extern void _gdt_flush();

/* Setup a descriptor in the Global Descriptor Table */
void gdt_set_gate(int num, unsigned long base, unsigned long limit, unsigned char access, unsigned char gran)
{
    /* Setup the descriptor base address */
    gdt[num].base_low = (base & 0xFFFF);
    gdt[num].base_middle = (base >> 16) & 0xFF;
    gdt[num].base_high = (base >> 24) & 0xFF;

    /* Setup the descriptor limits */
    gdt[num].limit_low = (limit & 0xFFFF);
    gdt[num].granularity = ((limit >> 16) & 0x0F);

    /* Finally, set up the granularity and access flags */
    gdt[num].granularity |= (gran & 0xF0);
    gdt[num].access = access;
}

/* Should be called by main. This will setup the special GDT
*  pointer, set up the first 3 entries in our GDT, and then
*  finally call gdt_flush() in our assembler file in order
*  to tell the processor where the new GDT is and update the
*  new segment registers */
void gdt_install()
{
    /* Setup the GDT pointer and limit */
    gp.limit = (sizeof(struct gdt_entry) * 3) - 1;
    gp.base = &gdt;

    /* Our NULL descriptor */
    gdt_set_gate(0, 0, 0, 0, 0);

    /* The second entry is our Code Segment. The base address
    *  is 0, the limit is 4GBytes, it uses 4KByte granularity,
    *  uses 32-bit opcodes, and is a Code Segment descriptor.
    *  Please check the table above in the tutorial in order
    *  to see exactly what each value means */
    gdt_set_gate(1, 0, 0xFFFFFFFF, 0x9A, 0xCF);

    /* The third entry is our Data Segment. It's EXACTLY the
    *  same as our code segment, but the descriptor type in
    *  this entry's access byte says it's a Data Segment */
    gdt_set_gate(2, 0, 0xFFFFFFFF, 0x92, 0xCF);

    /* Flush out the old GDT and install the new changes! */
    _gdt_flush();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T19:36:01.417

好吧，让我把这个放在上下文中......

```
struct gdt_ptr
{
    unsigned short limit;
    unsigned int base;
} __attribute__((packed));

struct gdt_entry gdt[3];
struct gdt_ptr gp;

gp.base = &gdt; 
```

您**正在**将指针 ( `&gdt`) 分配给整数 ( `gp.base`) - 因此出现错误:-)

我怀疑您实际上想要（或类似的东西）：

```
struct gdt_ptr
{
    unsigned short limit;
    struct gdt_entry *base;
} __attribute__((packed)); 
```

或者，由于您稍后将地址作为其组件字段进行评估，因此保持定义不变，然后进行赋值

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-04T11:18:02.000

我听说地址应该保留`size_t`，但我真的想保留地址，`int`也许只是投射它？`gp.base = (int) &gdt;`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-11-04T01:08:09.693

我之前遇到过这个问题，类型转换工作：

```
gp.base = (unsigned int)&gdt 
```

# c# - 将文本解析为 MVC 中缺少数据的对象

> ID：13211620
> 
> 赞同：1
> 
> 时间：2012-11-03T17:24:43.240
> 
> 标签：c#, asp.net-mvc, parsing, model-binding

我正在从 HTML 表单中获取一些帖子数据。出现的数据用于构建`TextualReport`对象。我想解析出现的各种表单数据并填充模型的这些部分。

我不使用模型绑定器的原因是这是一个相当复杂的对象，我的列表索引可能会丢失（从 2 开始，跳过 3 等）。我从一个现有对象开始，只替换帖子中出现的属性。

我有以下名为`TextualReport`.

```
public class TextualReport {

    public IList<Section> Sections { get; set; }
    public IList<string> MiscInputs { get; set; }

    public TextualReport(){
        Sections = new List<Section>();
        MiscInputs = new List<string>();
    }
}

public class Section{
    public Section(){
        Id = Guid.NewGuid();
        Blocks = new List<Block>();
    }

    public Guid Id { get; set; }
    public string Heading { get; set; }
    public IList<Block> Blocks { get; set; }
}

public class Block{
    public Block(){
        PreGraphText = new List<string>();
        PreGraphInput = new List<string>();
        Graphs = new List<Graph>();
        PostGraphText = new List<string>();
    }
    public Guid Id { get; set; }
    public string Heading { get; set; }
    public IList<string> PreGraphText { get; set; }
    public IList<Graph> Graphs { get; set; }
    public IList<string> PostGraphText { get; set; }
    public IList<string> PreGraphInput { get; set; }
}

public class Graph{
    public string Url { get; set; }
    public string Caption { get; set; }
} 
```

从我的 HTML/Razor 表单中，我得到如下文本字符串序列：

```
TextualReport.Sections[1].Blocks[0].Graphs[0].Caption=
TextualReport.Sections[1].Blocks[0].Graphs[1].Caption=
TextualReport.Sections[1].Blocks[0].Graphs[2].Caption=
TextualReport.Sections[1].Blocks[0].PreGraphInput[0]=
TextualReport.Sections[1].Blocks[0].PreGraphInput[1]=
TextualReport.Sections[1].Blocks[1].Graphs[0].Caption=
TextualReport.Sections[1].Blocks[1].PreGraphInput[0]=
TextualReport.Sections[1].Blocks[1].PreGraphInput[1]=
TextualReport.Sections[1].Blocks[2].Graphs[0].Caption=
TextualReport.Sections[1].Blocks[2].Graphs[1].Caption=
TextualReport.Sections[1].Blocks[2].PreGraphInput[0]=
TextualReport.Sections[1].Blocks[2].PreGraphInput[1]=
TextualReport.Sections[1].Blocks[3].Graphs[0].Caption=
TextualReport.Sections[1].Blocks[3].PreGraphInput[0]=
TextualReport.Sections[1].Blocks[3].PreGraphInput[1]=
TextualReport.Sections[1].Blocks[4].Graphs[0].Caption=
TextualReport.Sections[1].Blocks[4].PreGraphInput[0]=
TextualReport.Sections[1].Blocks[4].PreGraphInput[1]= 
```

用表单帖子中出现的各种部分填充我现有数据的最佳方法是什么？我从数据库中获取模型，然后根据新数据进行更新。

# javascript - 复制和粘贴在 Mobile Safari 和 CodeMirror 上不起作用

> ID：13211625
> 
> 赞同：0
> 
> 时间：2012-11-03T17:24:54.087
> 
> 标签：javascript, clipboard, codemirror

我写了以下代码：

```
function copy() {
  if(window.clipboardData) {
    window.clipboardData.clearData();
    window.clipboardData.setData("Text", document.getElementById('txtacpy').value);
  } 
}

function paste() {
  if(window.clipboardData) {   
    document.getElementById('txtapaste').value = window.clipboardData.getData("Text");
  } 
} 
```

当 CodeMirror 编辑器聚焦时，我调用：

```
paste(); 
```

但是什么也没有发生！浏览器是 Mobile Safari。如何解决问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:27:17.867

大多数浏览器不支持此功能，因为安全问题不允许网页访问您的剪贴板。这不仅是 Mobile Safari。大多数浏览器（如 Chrome 或 Firefox）都不支持它。

有些人使用称为[zClip/ZeroClipboard](https://code.google.com/p/zeroclipboard/)的 Flash 解决方法，它允许复制到剪贴板，但只能从用户直接单击 Flash 对象。这显然不是移动 safari 中的一个选项。

如果您只是想在页面内移动数据，那么您不必使用系统剪贴板来执行此操作 - 您可以为数据创建自己的保存区域（javascript 变量）并将数据放在那里复制并在粘贴时从那里检索它。然后，您使用普通的 DOM 函数（不是复制/粘贴函数）从字段中获取数据或将数据放入字段中。

# linux - 如何在 Linux 内核模块中获取可用 CPU 集？

> ID：13211626
> 
> 赞同：3
> 
> 时间：2012-11-03T17:24:53.830
> 
> 标签：linux, linux-kernel, cpu

我想用 kthread_create()/kthread_bind() 为每个 CPU 启动一个内核线程。但是，我一生都无法弄清楚如何查询可用 CPU 的数量。我确实找到了 CPU_SET 手册页，但这也无济于事。

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-04-04T12:10:40.060

您可以使用 num_online_cpus() 来获取可用 cpus 的数量。如果系统是使用与系统中的 cpu 数量不同的 maxcpus 设置引导的，则这可能与 nr_cpu_ids 之类的不同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T18:32:45.360

请参阅以下链接，[cpuinfo.c](http://lxr.free-electrons.com/source/fs/proc/cpuinfo.c)，[proc.c](http://lxr.free-electrons.com/source/arch/x86/kernel/cpu/proc.c)，可能会对您有所帮助。并且在第 143 行，可以使用两个函数来遍历 cpus，cpumask_first，cpumask_next。我认为，通过尝试和错误，您可以找到解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T17:49:04.120

您可以使用 x86info。它不是默认安装的（sudo apt-get install x86info (ubuntu)）

```
x86info | grep Found
Found 2 CPUs 
```

另一种方法是：

```
grep processor /proc/cpuinfo | wc -l
2 
```

是你要找的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T18:01:00.740

如果您使用的系统是 Fedora Linux / RHEL / CentOS v6+ / Debian Linux v6+，您可以使用[`lscpu`](http://www.cyberciti.biz/faq/linux-display-cpu-information-number-of-cpus-and-their-speed/)：

```
michael@test:~$ lscpu
Architecture:          i686
CPU op-mode(s):        32-bit, 64-bit
Byte Order:            Little Endian
CPU(s):                4
On-line CPU(s) list:   0-3
Thread(s) per core:    2
Core(s) per socket:    2
Socket(s):             1
Vendor ID:             GenuineIntel
CPU family:            6
Model:                 37
Stepping:              5
CPU MHz:               1199.000
BogoMIPS:              5319.88
Virtualization:        VT-x
L1d cache:             32K
L1i cache:             32K
L2 cache:              256K
L3 cache:              3072K 
```

特别是您可能对`-p`提供可解析输出的选项感兴趣：

```
michael@test:~$ lscpu -p
# The following is the parsable format, which can be fed to other
# programs. Each different item in every column has an unique ID
# starting from zero.
# CPU,Core,Socket,Node,,L1d,L1i,L2,L3
0,0,0,,,0,0,0,0
1,0,0,,,0,0,0,0
2,1,0,,,1,1,1,0
3,1,0,,,1,1,1,0 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-03T18:08:58.843

```
$ nproc --all
4 
```

--all 打印已安装处理器的数量

# android - 使用 .NET 发现移动设备（Android 和 IOS）

> ID：13211632
> 
> 赞同：2
> 
> 时间：2012-11-03T17:25:09.347
> 
> 标签：android, .net, ios, networking, discovery

我正在开发一个 ASP.NET (VB.NET) 应用程序，它将发现网络上连接的设备。有没有一种方法可以让我发现连接到我的网络的 IOS 设备（iphone、ipad、ipod）和 android 设备（手机、平板电脑）？

请协助。

谢谢。

乌梅尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:45:17.717

大多数 iOS 设备都支持 bonjour 服务发现（与 Avahi 或 ZeroConf 相同）。您可以在本地网络中发现将响应您的请求的节点（默认情况下大多数 iDevices）。

我猜维基百科是一个很好的起点[http://en.wikipedia.org/wiki/Zero_configuration_networking#Service_discovery](http://en.wikipedia.org/wiki/Zero_configuration_networking#Service_discovery)。

我不确定如何在 .NET 中完成，但您可以尝试[http://www.mono-project.com/Mono.Zeroconf](http://www.mono-project.com/Mono.Zeroconf)。

# forms - 提交错误数据后浏览器中的URL变成了表单动作值，如何处理？

> ID：13211633
> 
> 赞同：0
> 
> 时间：2012-11-03T17:25:13.037
> 
> 标签：forms, http, grails, web-applications, language-agnostic

*这个问题通常与语言/框架无关，但如果这很重要，我会与 Grails 合作，并且最感兴趣的是 grails 特定的解决方案（如果存在）。*

有一个映射到 URL: 的表单`/foo/create`。当用户在他的浏览器中输入这个 URL 时，表单就会显示出来。

表单动作属性指向`/foo/save`具有方法`POST`。如果保存成功，则应用标准的 post-redirect-get 模式，并将用户重定向到`/foo/show`.

但是，如果用户指定了不正确的数据，他们应该会再次看到相同的表单，其中包含错误消息并保留所有数据。为了实现这种行为，我`forward`对产生表单的控制器进行了处理（同样映射到`/foo/create`）。

在该用户看到带有数据和错误消息的表单后，但浏览器中的 URL 字段更改为`/foo/save`. 如果用户将焦点更改为 URL 字段并按 Enter - 将显示 404（因为没有任何内容映射到`/foo/save`+`method=GET`对）。

**长话短说**：URL`/foo/save`显示在浏览器中（因为提交表单后没有重定向），但如果通过 HTTP GET 方法访问，它会指向无处。

如何处理这种情况？当然，我可以映射一些东西，`/foo/save`但我想知道是否有办法在提交错误数据的表单后不更改浏览器中显示的 URL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T19:04:28.323

两种方法：

1.  表单提交给自己，即`/foo/create`提交给`/foo/create`，只有当页面成功重定向到 时`/foo/show`。这*也应该*使用 post-redirect-get 循环并将提交的数据存储在会话中，但*可以*是没有重定向的简单 POST。
2.  `/foo/save` *`/foo/create`如果数据无效或数据有效，*总是会*再次重定向`/foo/show`。这将始终使用保存在会话中的数据的后重定向获取循环。*

# mysql - 'GROUP BY' 和子查询优化

> ID：13211635
> 
> 赞同：0
> 
> 时间：2012-11-03T17:25:24.090
> 
> 标签：mysql, count, group-by, having

我有两个表：每个原始表中`data`都有0、1 或 n 个图像。我希望能够从. 无法使用 JOIN，因为我无法编辑 sql 查询的第一部分：. 以下是我的解决方案：`img``data``img``data``img``SELECT some_defualt_columns FROM data WHERE`

**解决方案 1**需要一段时间才能执行但有效

```
SELECT some_defualt_columns  FROM data WHERE `id` IN
    (SELECT data_id FROM 
        (SELECT data_id, count(*) as occ FROM 
            img GROUP BY data_id 
            HAVING occ >1)
    AS tmp) 
```

**解决方案 2**这应该比以前更快（[MySQL: View with Subquery in the FROM Clause Limitation](https://stackoverflow.com/questions/206062/mysql-view-with-subquery-in-the-from-clause-limitation)）但这实际上会**杀死**我的 MySQL 服务器

```
SELECT *  FROM data WHERE id IN 
    (SELECT data_id FROM img 
         GROUP BY `data_id` 
         HAVING count(`data_id`) > 1) 
```

**解决方案 3**也许禁食但需要创建视图：

```
CREATE VIEW my_data_with_more_than_one_img AS 
    SELECT all_columns_of_data_table FROM 
        data JOIN img 
        GROUP BY img.data_id 
        HAVING (COUNT(img.data_id) > 1 
```

比执行一个简单`SELECT`的：

```
SELECT * FROM my_data_with_more_than_one_img WHERE 1 
```

最后一个解决方案相当快，但我想知道是否有更快（或更智能）的方法来完成这项工作

# android - Google Play 商店开发者控制台是什么意思？

> ID：13211636
> 
> 赞同：1
> 
> 时间：2012-11-03T17:25:26.603
> 
> 标签：android, google-play

我想在 Play 商店中发布我的新应用，但在应用面板中看到此消息：

> ```
> This application is only available to devices with these features,
> as defined in your application manifest.
> 
> Screen layouts: SMALL NORMAL LARGE XLARGE
> 
> Required device features
> android.hardware.location
> android.hardware.location.gps
> android.hardware.location.network
> android.hardware.screen.portrait
> android.hardware.sensor.accelerometer
> android.hardware.touchscreen
> 
> This application is available to over 0 devices. 
> ```

为什么它说我的应用程序可用于超过**0**台设备？我已经在我的手机上进行了测试，它可以工作。至少一台设备:)

我的清单.xml：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="..."
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="7"
        android:targetSdkVersion="15" />

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.READ_PHONE_STATE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />

    <uses-feature android:name="android.hardware.sensor.accelerometer" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.Black.NoTitleBar" >
        <activity
            android:name="MainActivity"
            android:configChanges="orientation"
            android:label="@string/app_name"
            android:screenOrientation="portrait">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity
            android:name="ListActivity"
            android:screenOrientation="portrait">
        </activity>

        <activity
            android:name="SettingsActivity"
            android:screenOrientation="portrait">
        </activity>

        <activity
            android:name="HelpActivity"
            android:screenOrientation="portrait">
        </activity>

        <activity
            android:name="AboutActivity"
            android:screenOrientation="portrait">
        </activity>

    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T03:47:10.560

这显示使用 IE。去看看 Firefox，你会拥有大量的设备。

# objective-c - 如何检查objectForKey返回的NSString是否为“”目标c

> ID：13211637
> 
> 赞同：1
> 
> 时间：2012-11-03T17:25:30.637
> 
> 标签：objective-c, ios

我不确定如何检查 NSString 是否为空白，我有这个代码......

```
 NSString *imageName = [myItem objectForKey:@"iconName"];

        if(imageName == @"")
        {
        } 
```

当我在 myItem 对象上进行打印时，它会显示为..

```
iconName = ""; 
```

在 NSString *imageName 行，我在控制台的 xcode 中注意到它说

> “变量不是 NSString”

我没有得到，因为 iconName 作为 NSString 保存并存储在 parse.com 数据库中。

当我运行该代码时，虽然它似乎没有意识到 imageName = "";

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T17:31:04.560

比较字符串时应使用此代码块：

```
if ([imageName isEqualToString:@""]){
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T17:31:30.187

你需要用来`isEqualToString`比较两个字符串。如果您只使用 == 那么您正在比较两个指针。

您还可以通过以下方式检查您收到的对象是否为 NSString：

```
if ([imageName isKindOfClass:[NSString class]]) 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-03T17:47:36.893

尽管您已经有了一些答案，但这是我的看法。

首先，您的警告（不是错误）可以像这样修复：

```
 NSString *imageName = (NSString *)[myItem objectForKey:@"iconName"]; 
```

然后，我会检查以确保字符串不是`nil` **并且**它不是空白的。在 Objective-C 中最简单的方法是检查字符串的长度，因为如果它为 nil，它将返回 0，如果它为空，它将返回 0：

```
if([imageName length] == 0)
{
   // This is an empty string.
} 
```

正如@jlehr 指出的那样，如果 imageName 实际上可能没有存储为字符串，那么为了防止崩溃，您需要先检查。（这可能需要也可能不需要，具体取决于您的应用程序的逻辑）：

```
if ([imageName isKindOfClass:[NSString class]] 
{
    if([imageName length] == 0)
    {
        // This is an empty string.
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T17:31:57.327

这`"variable is not NSString"`可能是因为`objectForKey:`返回一个`id`.

应该使用`[imageName isEqualToString:@""]`.

# c# - 将UTC时间更改为当地时间

> ID：13211639
> 
> 赞同：1
> 
> 时间：2012-11-03T17:25:43.573
> 
> 标签：c#, datetime

如何将 UTC 时间更改为当地时间。

我有这个代码，

```
DateTime dt = booking.CreateDateTime.Value; 
```

其中 CreationDateTime 采用 UTC 格式。

当我在客户端将时间更改为本地时间时，它比本地时间快 7 小时。

任何机构对此都有想法。

这就是我将其更改为当地时间的方式。

```
var localTime = TimeZone.CurrentTimeZone.ToLocalTime(dt); 
```

预订时，日期时间的服务器端代码是

```
booking.CreateDateTime = DateTime.UtcNow; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:33:11.783

实际上只有两件事可能是错误的：

1.  UTC 日期并不是真正的 UTC。

2.  运行它的机器未设置正确的时区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:56:46.950

看起来 .net 假设日期是当地时间。在以下代码中，dt1 和 dt3 都与 dt 相同。一种解决方案是使用 TimeZone.CurrentTimeZone.GetUtcOffset 并自己进行计算。

```
dt = Now
dt1 = TimeZone.CurrentTimeZone.ToLocalTime(dt)
dt2 = TimeZone.CurrentTimeZone.ToUniversalTime(dt)
dt3 = dt.ToLocalTime
dt4 = dt.ToUniversalTime 
```

# nhibernate - NHibernate 保存对象

> ID：13211641
> 
> 赞同：1
> 
> 时间：2012-11-03T17:25:59.213
> 
> 标签：nhibernate, c#-4.0, fluent-nhibernate

我有一个链接到详细信息对象（1 到 1）的配置文件对象。因此，在我的个人资料对象上，我将详细信息对象作为属性，并且我正在尝试使用 HasOne 映射来映射详细信息对象。保存配置文件时，它正在数据库中创建一个配置文件条目和一个详细信息条目；但是，详细信息对象上的 profileId 是 Guid.Empty。它不使用其在配置文件上生成的 ID 来保存详细信息：

有任何想法吗？？提前致谢

以下是我的地图：

```
public ProfileMap() : base(ESchema.Usr, ETable.Profile)
        {
            Id(x => x.Id).GeneratedBy.GuidComb();
            Map(x => x.MembershipId);
            Map(x => x.FirstName);
            Map(x => x.LastName);
            Map(x => x.Gender).CustomType<EGender>();
            Map(x => x.BirthDate);
            Map(x => x.IsActive);

            HasOne(x => x.Details).PropertyRef(x => x.ProfileId).Cascade.All();
            //References(x => x.ProfileImage).Column("ProfileId");
        }

public DetailMap() : base(ESchema.Usr, ETable.Detail)
        {
            Id(x => x.Id).GeneratedBy.GuidComb();
            Map(x => x.ProfileId);
            Map(x => x.Height);
            Map(x => x.Weight);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:40:13.080

[NHibernate 参考（ http://nhibernate.info/doc/nh/en/index.html#mapping-declaration-onetoone](http://nhibernate.info/doc/nh/en/index.html#mapping-declaration-onetoone) ）中关于一对一的部分似乎建议（接近尾声） Detail.ProfileId 应该真的是例如OwningProfile（键入为Profile）并使用References（）映射（在流利的NH中）。

# jquery - jQuery插件使用

> ID：13211646
> 
> 赞同：0
> 
> 时间：2012-11-03T17:26:25.983
> 
> 标签：jquery, jquery-plugins

我想我在这里真的很愚蠢。我正在尝试使用我已经针对 div 元素实例化的插件来调用方法。

该插件使用此处定义的样板

[http://jqueryboilerplate.com/](http://jqueryboilerplate.com/)

该插件有效，我使用以下方法对其进行实例化

```
calendar = $('#calendar').Calendar({'weekStart': 1,'startDate':startDate,'endDate':endDate}); 
```

稍后当一个事件被调用时，我想调用该插件中的一个方法，但我的生活我无法弄清楚。

我已经尝试了所有不同方法的庄园，我最近不成功的一个是

```
var thing = $('#calendar');
thing.Calendar.redraw({'startDate':startDate,'endDate':endDate}); 
```

任何帮助将不胜感激。

谢谢

艾伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T21:35:40.107

找到它，感谢 Bouillou 为我指明了正确的方向。

```
$('#calendar').data('plugin_Calendar').redraw({'startDate':startDate,'endDate':endDate}); 
```

# css - 不同分辨率的居中菜单

> ID：13211649
> 
> 赞同：0
> 
> 时间：2012-11-03T17:26:54.173
> 
> 标签：css, margin, centering

[http://www.mammacoil.com/](http://www.mammacoil.com/)

我正在努力使这个菜单居中，我尝试了边距自动 css，但它似乎没有工作。有人可以帮忙吗。

我将其设置为 100% 然后自动保证金会更容易吗？

```
#access {
clear: both;
margin-top: -20%;;
margin-left: 15%;
width: 100%;
font-family: SansitaOne;
font-weight: 100;
text-shadow: 2px 2px #000000;
height: 43px;
text-align: center;

}
#access ul {
font-size: 18px;
list-style: none;
}
#access li {
position: relative;
float: left;
} 
```

先感谢您。

柯斯蒂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:29:29.320

你可以做到这一点，`margin:0 auto;`它适用于每个分辨率

并设置宽度

```
#access {
    clear: both;
    font-family: SansitaOne;
    font-weight: 100;
    height: 43px;
    margin: 0 auto;
    text-shadow: 2px 2px #000000;
    width: 960px;              <-----set this
} 
```

# c++ - Cocos2d-x 粒子系统性能从 1.x 版本下降到 2.x 版本

> ID：13211653
> 
> 赞同：2
> 
> 时间：2012-11-03T17:27:30.653
> 
> 标签：c++, linux, qt, cocos2d-x, meego

我们想将我们的基础系统从 Cocos2d-x 1.0（Qt 端口 0.6）更改为 Cocos2d-x 2.0（Qt 端口 1.0），但是在更改系统之前需要测试几个任务。其中一项任务是粒子系统的性能。请记住，从 1.0 更改为 2.0 时性能会提高，我们发现相反的情况。**1.0 版的性能似乎比 2.0 版好得多**。现在我们想知道这是否正确，希望有人能给我们一些我们可能错过的提示（Cocos2d-x 的错误设置，错误的设置，...）。

为了测试性能，我们创建了一个简单的测试场景：使用一个粒子系统，可以在按下场景时多次添加。这个粒子系统使用不同大小的纹理（4x4px 和 32x32px）和四粒子系统。

测试的基础是 Cocos2d-x 的 HelloWorld 示例。此外，我们启用了触摸接收器，创建了批处理（如果需要），将标签转换为计数器并添加了粒子系统插入例程。源代码和资源作为 zip 存档的链接附在下面。

我们比较了 Linux 版本的 Cocos2d-x 和 Qt (MeeGo Harmattan) 版本的 Cocos2d-x。测试结果可以在 excel 表[http://www.fantasyhaze.com/sof/Particle_Performance_Tests.ods](http://www.fantasyhaze.com/sof/Particle_Performance_Tests.ods)中找到。在每个测试用例中，1.0 版本的性能都优于 2.0。在每个测试用例中，批处理粒子系统与 Cocos2d-x 2.0 中的未批处理粒子系统具有相同的性能。性能是在 FPS/粒子系统中测量的。

***结果：***

批处理和非批处理系统之间没有性能差异，因为每个效果都使用了小纹理。所以没有太多的OpenGL状态变化。当使用具有大量透明度或更多粒子的巨大纹理（由于性能下降而无法实现）或使用使用不同纹理的不同粒子来预测 OpenGL 状态变化时，可能会看到更强的效果。

因此，总体性能下降可能不仅仅是图形方面，而更多的是 CPU 的高利用率（为数千个粒子计算每帧中粒子的位置，即：47 个粒子系统和 350 个粒子产生有效载荷47*350 = 16450 个粒子，每帧都需要重新计算）。当使用批处理粒子时，这也是可以使用的最大粒子数量，因为 GL 绘制函数使用 16450 个粒子达到的无符号短值。16450 * 4（顶点）= 65800（ushort = 65535）。当在台式机上使用批处理粒子与未批处理粒子时，可以看到（在屏幕截图上）。在批处理中插入 47 个粒子后，它将停止显示新效果。当添加更多效果时，性能仍然会继续下降，这说明性能损失主要基于 CPU 端而不是 GPU。当使用 4x4px 纹理而不是 32x32px 时，也可以注意到这一点，只能放置大约 10 个效果（在桌面上）。

***相关话题：***

*   [http://www.cocos2d-iphone.org/wiki/doku.php/perf_test:2_0_0](http://www.cocos2d-iphone.org/wiki/doku.php/perf_test:2_0_0)

*   [http://www.cocos2d-iphone.org/wiki/doku.php/perf_test:1_0_0](http://www.cocos2d-iphone.org/wiki/doku.php/perf_test:1_0_0)

*   [http://www.cocos2d-x.org/projects/cocos2d-x/wiki/Performance](http://www.cocos2d-x.org/projects/cocos2d-x/wiki/Performance)

excelsheet、截图和源代码可以在存档中找到 - [http://www.fantasyhaze.com/sof/Particle_Perfromance_Tests.zip](http://www.fantasyhaze.com/sof/Particle_Perfromance_Tests.zip) http://www.fantasyhaze.com/sof/Particle_Perfromance_Tests.ods

# google-maps - 谷歌地图 v3 信息框 zIndex 不起作用

> ID：13211655
> 
> 赞同：0
> 
> 时间：2012-11-03T17:27:41.480
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers

我有一张地图和一个标记。当我单击标记时，会弹出一个具有此属性（窗格：“floatPane”和 zIndex：1）并且我的标记具有 zIndex 2 的弹出窗口（infobox.js）。即使它的 zIndex 更小。我知道，如果我将窗格设置为 mapPane，它将位于下方，但我需要将其设置为 floatPane 以显示地图上的其他标记。为什么 zIndex 不起作用？我已经在 zIndex 中添加了一些警报，以确保它们和我想的一样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T06:02:56.170

zIndex 属性仅在同一窗格上的对象之间有用。floatPane，首先是覆盖，如[**文档**](https://developers.google.com/maps/documentation/javascript/reference#MapPanes)中所述：

> **floatPane** (Node) 此窗格包含信息窗口。它首先是地图叠加层。（窗格 6）。

标记是重叠的，它们被保持在：

> **overlayImage** (Node) 此窗格包含标记前景图像。（窗格 3）。

# php - PHP/MongoDB - 按时间排序

> ID：13211663
> 
> 赞同：0
> 
> 时间：2012-11-03T17:28:40.340
> 
> 标签：php, mongodb

我有以下 MongoDB 对象：

```
{
   "_id": ObjectId("50954f0d13f88da4a590e5ff"),
   "uname": "Eamorr",
   "1": {
     "table": "1",
     "color": "red",
     "time": NumberInt(1351963491),
     "niceTime": "2012-11-03T17: 24: 51+00: 00"
  },
   "3": {
     "table": "3",
     "color": "green",
     "time": NumberInt(1351963567),
     "niceTime": "2012-11-03T17: 26: 07+00: 00"
  },
   "4": {
     "table": "4",
     "color": "orange",
     "time": NumberInt(1351963506),
     "niceTime": "2012-11-03T17: 25: 06+00: 00"
  }
} 
```

如何按“时间”对该对象进行排序？

我想`table 3`成为第一名、`table 4`第二名和`table 1`最后一名。

我真的被困住了......请帮忙！

* * *

更新：我应该补充一点，我的服务器返回以下 JSON 对象：

```
[{
    "table": "4",
    "color": "orange",
    "time": 1351965770,
    "niceTime": "2012-11-03T18:02:50+00:00"
}, {
    "table": "3",
    "color": "red",
    "time": 1351964379,
    "niceTime": "2012-11-03T17:39:39+00:00"
}, {
    "table": "1",
    "color": "red",
    "time": 1351964997,
    "niceTime": "2012-11-03T17:49:57+00:00"
}] 
```

排序更容易吗？

非常感谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:39:12.100

```
$coll->find($range, $co)->sort(array('time' => -1) ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T18:06:54.067

知道了...

使用第二个 JSON（上图），我做了：

```
function my_sort($a, $b){
    if ($a['time'] > $b['time']) {
        return -1;
    } else if ($a['time'] < $b['time']) {
        return 1;
    } else {
        return 0;
    }
}

usort($obj,'my_sort');
echo json_encode($obj); 
```

# jquery - jQuery 插件 -> Zepto；$.fn.extend 未定义

> ID：13211667
> 
> 赞同：5
> 
> 时间：2012-11-03T17:28:58.150
> 
> 标签：jquery, jquery-plugins, zepto

我是 zepto 的新手，并且正在使用它作为网站移动部分的 jQuery 替代品。

所以 zepto 没有 $.fn.extend。很好，这对我来说很酷，但是无论 jquery 还是 zepto，我都需要我的插件才能工作。

zepto 对 fn.extend 的替代是什么？您将如何进行跨库扩展？我还没有找到这方面的任何文件。

```
 $.fn.extend({
     lineRedNAddClass : function(option){
         $(this).css('border','red 1px solid').addClass(option);   
     }
 }); 
```

这可以从同一个脚本中使用吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-07-25T01:19:29.780

换句话说，为了让一些 jquery 插件与 zepto 一起工作，我在 zepto.js 的末尾添加了这两行：

```
jQuery = Zepto;
$.fn.extend = function(obj) {
    $.extend($.fn, obj);
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-03T18:03:47.890

Zepto 的扩展功能可以通过 来访问`$.extend()`，jQuery API 中也提供了该功能，因此我们可以简单地`$.fn`使用它进行扩展。

**例子：**

```
$.extend($.fn, {
    myFunc: function() {
        $(this).css({
            color: 'red'
        });
    }
}); 
```

这是一个演示。我已将两个库都加载到资产中，因此只需使用前两行切换 $ 的值。有一个`consle.log`包含来证明加载了正确的库。

[http://jsfiddle.net/WNTXY/](http://jsfiddle.net/WNTXY/)

# javascript - 将自动完成添加到 Google 地理编码器

> ID：13211671
> 
> 赞同：0
> 
> 时间：2012-11-03T17:29:29.670
> 
> 标签：javascript, google-maps, google-maps-api-3, geocode

在我最近的成功之后（在此处的帮助下），我想完成我的脚本。谷歌同意将地理编码的地图结果放在第二页上是可以的，所以我想从第一页的地理编码脚本中去掉地图显示。

我在这里工作：http: [//jsfiddle.net/njDvn/15/](http://jsfiddle.net/njDvn/15/)

但！它唯一没有的是自动建议（谷歌的，不是 jqueryUI 的）。这是一些确实演示了谷歌自动建议的代码：http: [//jsfiddle.net/Rr5PL/63/](http://jsfiddle.net/Rr5PL/63/)

现在，似乎启用自动建议的代码是这样的：

```
var autocomplete = new google.maps.places.Autocomplete(address,options);
var autocompleteOptions = {types: ['geocode']}; 
```

我将此添加到我的原始代码中，不幸的是它不起作用！这段代码可以在这里看到：http: [//jsfiddle.net/njDvn/16/](http://jsfiddle.net/njDvn/16/)

所以我的问题是，根据我在[FIRST LINK](http://jsfiddle.net/njDvn/15/)中的原始代码，如何启用谷歌自动完成建议？

您可以提供的任何帮助或意见将不胜感激！谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T18:31:47.740

这是一个[**自动完成示例**](http://maps.forum.nu/v3/ac.html)（仅限美国），包括街景。

创建它的关键线是：

```
var input = document.getElementById('searchTextField');
var options = {
    types: [],
    componentRestrictions: {country: 'us'}
};

var autocomplete = new google.maps.places.Autocomplete(input, options); 
```

您还需要加载 Places 库：

```
<script src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places"></script> 
```

和 HTML：

```
<input id="searchTextField" type="text" size="50" value=""> 
```

顺便说一句，您不会“将自动完成添加到地理编码器”。 Places Autocomplete 类包括地理编码功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:58:41.787

JavaScript 自动完成功能是 Google Places API 的一部分，默认情况下不会随 Google Maps API 一起加载。在包含 Maps API 时，您需要通过添加参数显式[加载 Places 库](https://developers.google.com/maps/documentation/javascript/places#loading_the_library)**`libraries=places`**：

`<script src="http://maps.googleapis.com/maps/api/js?libraries=places&sensor=false"></script>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T22:48:03.187

看看这个准备好的演示，它完全符合 Marcelo 和 ssorallen [http://devfestmtm.appspot.com/demos/places/autocomplete_addressform.html提到的内容](http://devfestmtm.appspot.com/demos/places/autocomplete_addressform.html)

# iphone - iOS 上的 Facebook 登录对话框错误

> ID：13211677
> 
> 赞同：0
> 
> 时间：2012-11-03T17:31:05.517
> 
> 标签：iphone, facebook-graph-api, ios5.1

您好，我正在使用旧的 facebook sdk，我认为它是 3.0，现在我将更新应用程序，但在测试期间无法登录 facebook，请让我知道如何修复它。在我的应用程序中升级到 3.1 太复杂了。

![在此处输入图像描述](../Images/08edb3e2ce2fdfa1ccf3367b035b918f.png)

```
//Facebook Login  
        appDelegate.flag = 1;
        appDelegate.facebook.accessToken = nil;
        appDelegate.facebook.expirationDate = nil;

        NSHTTPCookieStorage* cookies = [NSHTTPCookieStorage sharedHTTPCookieStorage];
        NSArray* facebookCookies = [cookies cookies];
        for (NSHTTPCookie* cookie in facebookCookies) {
            [cookies deleteCookie:cookie];
        }

        NSArray *permissions = [NSArray arrayWithObjects: @"status_update", @"publish_stream", @"offline_access", @"publish_actions", @"read_stream", @"user_photos", @"photo_upload", @"photo_tag", nil];

        [appDelegate.facebook authorize:permissions]; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T09:00:56.527

最后一个问题解决了，这完全是因为参数有一个参数导致这个问题我认为 facebook 弃用它或其他东西但问题解决了:)

参数是@"photo_tag"

# c# - C# 到 C 代码 P/INvoke 多个 std:string 声明导致堆栈损坏

> ID：13211679
> 
> 赞同：4
> 
> 时间：2012-11-03T17:31:21.560
> 
> 标签：c#, c++, opencv, pinvoke

我构建了一个带有外部导出的 c++ dll，以便从我的 C# 程序中调用它。对于大多数函数，调用都工作得很好，但是当我需要将一些字符串从 C# 传递到 C++ 时，就会出现问题。

我将它们作为普通字符串传递，并将它们作为 const char * 接收。它们都很好，所有数据都在那里，但是我继续从这些 char 数组中定义几个字符串。代码继续运行，直到我退出函数。然后它抛出一个异常，说最后定义的 std::string 周围的堆栈已损坏，我真的不确定为什么会这样。我尝试了很多定义字符串的方法：复制它们，从 P/Invoke 定义中更改编码。

一些额外的信息我从定时器线程调用这个函数；我在提到这一点时发现，线程上的 std::string 可能会出现一些问题。这是在 VS 2012 for x86 中编译的多 CPU 机器上完成的。还附上下面的相关代码

```
#define OPENCV2P4

#include "openfabmap.hpp"
#include <fstream>
#ifdef OPENCV2P4
#include <opencv2/nonfree/nonfree.hpp>
#endif

#include <stdio.h>

extern "C"
{

__declspec(dllexport) int   generateBOWImageDescs( const char* _dataPath,  const char* _bowImageDescPath,const char* _vocabPath ,int minWords)
{

 std::string dataPath(_dataPath);

  std::string bowImageDescPath( _bowImageDescPath);
  std::string vocabPath(_vocabPath);

cv::FileStorage fs; 

//ensure not overwriting training data
std::ifstream checker;
checker.open(bowImageDescPath.c_str());
if(checker.is_open()) { 

    checker.close();

    return -1;
}
 } 
```

以及来自 C# 的调用

```
 [DllImport(@"FabMap\FabMapCPP.dll", CallingConvention = CallingConvention.Cdecl)]
         public static extern int generateBOWImageDescs( string _dataPath, string    _bowImageDescPath, string _vocabPath, int minWords); 
```

任何帮助将不胜感激。这里也是第一个问题，因此对问题的错误表述的任何评论将不胜感激。

编辑：好吧，有趣的是问题出在 $cv::FileStorage fs; 我基本上删除了它并开始工作，可能是由于分配不当或其他原因。

所以这意味着opencv文件存储导致问题，仍然不知道为什么。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-05T21:50:38.223

看看这2个链接：

[http://support.microsoft.com/kb/311259](http://support.microsoft.com/kb/311259)

[http://msdn.microsoft.com/en-us/library/7b620dhe.aspx](http://msdn.microsoft.com/en-us/library/7b620dhe.aspx)

基本上 char* 是 C# 中的 IntPtr 而不是字符串。

# xcode - UIWebview 正在关闭加载 url

> ID：13211680
> 
> 赞同：0
> 
> 时间：2012-11-03T17:31:25.257
> 
> 标签：xcode, uitableview, uiwebview, nsstring

所以我有一种奇怪的方法来在我正在制作的浏览器应用程序的 UIWebView 中加载书签。对于书签 UITableView 中的 didSelectRowAtIndexPath，我有以下代码：

```
NSUserDefaults *lString = [NSUserDefaults standardUserDefaults];
[lString setValue:[bookmarks objectAtIndex:indexPath.row] forKey:@"loString"]; 
```

然后我有一个将 UITableView 中选定对象的模式连接到另一个视图控制器，该控制器基于此代码加载 UIWebView。所以问题是我第一次点击表格视图对象时，UIWebview 是空白的，然后第二次显示我第一次点击的 URL。请帮忙！谢谢，迈克尔

```
- (void)viewDidLoad
{
[super viewDidLoad];
NSUserDefaults *lString = [NSUserDefaults standardUserDefaults];
loadString = [lString valueForKey:@"loString"];
NSURL *url = [[NSURL alloc] initWithString:loadString];
NSURLRequest *togo = [[NSURLRequest alloc] initWithURL:url];
[webView loadRequest: togo];

// Do any additional setup after loading the view.
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T18:37:08.913

-loadRequest 方法是异步的，这意味着它在您的主线程继续执行时在另一个线程中开始加载。

所以第一次调用它时，它显示一个空白屏幕（因为第一个请求仍在另一个线程中运行）。第二次，因为第一个请求现在已经完成，它表明（而第二个请求在另一个线程中运行）。等等。

要在加载后立即使用 URL 内容刷新屏幕，您需要实现 UIWebViewDelegate 的 -webViewDidFinishLoad 方法。在该方法中，您知道 URL 已完成加载，因此如果您在那里刷新 Web 视图，它应该会显示内容。

# ios - 如何在 iOS 上使用 Google Drive API 处理电子表格

> ID：13211682
> 
> 赞同：12
> 
> 时间：2012-11-03T17:31:29.553
> 
> 标签：ios, google-drive-api, gdata-api, google-spreadsheet-api

我正在尝试编写一个将其数据库存储在 Google 电子表格中的 iPhone 应用程序。[我在这里](https://developers.google.com/drive/examples/objectivec)遵循 DrEdit 示例，它使用 Drive API 将纯文本文件读/写到 Google Drive。我正在尝试修改示例应用程序以使用电子表格。我能够上传一个 csv 文件并要求 Google 转换它。但是，我真正想要的是直接使用 mimeType：“application/vnd.google-apps.spreadsheet”。我对此很陌生，如果有人能给我举个例子，那将非常有帮助。对于初学者，我想实现以下目标

```
- (void)uploadSpreadSheetWithThreeCells {
GTLUploadParameters *uploadParameters = nil;

NSString *data = @"cell1,cell2,cell3";

NSData *spreadSheetContent = nil;

/* 
  How to initialize spreadSheetContent with data? 
*/

[GTLUploadParameters uploadParametersWithData:spreadSheetContent
      MIMEType:@"application/vnd.google-apps.spreadsheet"];

GTLQueryDrive *query = [GTLQueryDrive queryForFilesInsertWithObject:self.driveFile
                                        uploadParameters:uploadParameters];

[self.driveService executeQuery:query completionHandler:nil];
} 
```

此外，Google Drive API 是否适合使用？最终，我希望能够更新电子表格的选定单元格，而不是上传整个文档。我发现了一些其他选项，例如 gdata api 和电子表格 api，但似乎 Drive API 是最新的，它应该包含其他两个的功能？

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-03T19:08:01.683

您应该使用 Google 电子表格 API 直接操作电子表格的单元格：

[https://developers.google.com/google-apps/spreadsheets/](https://developers.google.com/google-apps/spreadsheets/)

电子表格 API 由 Google Data APIs Objective-C 客户端库支持，其中还包括一些示例，您可以将其用作参考：

[http://code.google.com/p/gdata-objectivec-client/](http://code.google.com/p/gdata-objectivec-client/)

# entity-framework - 代码优先 DbContext 用法

> ID：13211683
> 
> 赞同：0
> 
> 时间：2012-11-03T17:31:37.707
> 
> 标签：entity-framework, ef-code-first, dbcontext

我一直在尝试使用 Entity Framework 的 Code First。我写了下面的代码行

```
DbContext _context = new  DbContext(ConfigurationManager.ConnectionStrings["con"].ConnectionString); 
```

但是在执行时，连接保持关闭。这段代码有问题吗？？

我使用如下所示的 DBContext 创建了一个通用存储库类

```
public class GenericRepository<T> where T:class
  {   

public DbContext _context = new DbContext(ConfigurationManager.ConnectionStrings["con"].ConnectionString);

private DbSet<T> _dbset;

public DbSet<T> Dbset
{

    set { _dbset = _context.Set<T>(); }
    get { return _dbset; }

}

public IQueryable<T> GetAll()
{

    return Dbset;
}  
} 
```

然后我在页面加载事件上调用这个类，其中教师是一个实体类，它映射到数据库中的一个表

```
protected void Page_Load(object sender, EventArgs e)
{
    GenericRepository<Teacher> studentrepository = new GenericRepository<Teacher>();
    rptSchoolData.DataSource = studentrepository.GetAll().ToList();
    rptSchoolData.DataBind();
} 
```

但连接仍然关闭，并且上下文对象的 ServerVersion 中也存在 InvalidOperation 异常。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T00:13:11.773

这个性质

```
public DbSet<T> Dbset
{
    set { _dbset = _context.Set<T>(); }
    get { return _dbset; }
} 
```

有很重的气味。一个什么都不做的二传手`value`是一个反模式大时代。您是否希望`DbSet`在创建后设置`GenericRepository`？

我不明白你的代码甚至可以工作，因为你从不初始化`_dbset`，它应该抛出一个空对象引用异常。

并且`_dbset`一`DbSet`开始就不应该在那里。`GetAll`应该返回`_context.Set<T>()`。EF 应该自行打开和关闭连接。也许您没有初始化 DbSet 的事实会导致连接永远无法打开，从而导致此处未显示的其他代码段出现问题。

# ruby-on-rails-3 - recaptcha_tags 在 erb 中渲染转义的 HTML

> ID：13211686
> 
> 赞同：2
> 
> 时间：2012-11-03T17:31:56.473
> 
> 标签：ruby-on-rails-3, recaptcha

我正在将我的应用程序从 2.3.5 迁移到 Rails 3.2.8。一种形式使用 reCAPTCHA（在 erb 文件中）。现在，recaptcha_tags 输出的所有 HTML 标签都是转义的 HTML。（即 <...> 而不是 <...>）。所以我在 HTML 页面中看到了标签本身，而不是 reCAPTCHA 框。

这是我的erb的样子。我已经验证了我将recaptcha标签放在erb中的哪个位置（在form_for内部或外部）并不重要：

注册.html.erb

```
...
<%= recaptcha_tags :public_key => RECAPTCHA_PUBLIC_KEY %>
... 
```

其他的东西，比如 form_for 没有这个问题。他们输出直接的 HTML。

宝石文件

```
gem "recaptcha", :require => 'recaptcha/rails' 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T20:48:04.370

Rails 2.3.5 和 3.X 之间的主要变化之一是与跨站点脚本有关的一些变化。您可能希望通过升级到 2.3.14 并添加 rails_xss gem 来开始升级。rails_xss gem (https://github.com/rails/rails_xss) 会将 HTML 安全默认值切换为转义，因此它会导致您在 recaptcha_tags 中看到的问题。这将允许您查看应用程序中的哪些字符串需要标记为 html_safe。

或者，如果recaptcha_tags 是唯一的问题，您可以通过告诉rails 不要逃避recaptcha_tags 来解决它。

就像是：

```
<%= raw recaptcha_tags :public_key => "_________" %> 
```

*   感谢您进行研究。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T03:42:30.077

原来我需要在 recaptcha_tags 调用前加上“raw”：

注册.html.erb

```
...
<%= raw recaptcha_tags :public_key => RECAPTCHA_PUBLIC_KEY %>
... 
```

# objective-c - uiimageview的随机CGPointMake

> ID：13211688
> 
> 赞同：0
> 
> 时间：2012-11-03T17:31:57.300
> 
> 标签：objective-c, ios, xcode

如何在我的代码中更改此数字“63”？

```
-(void)up
{

    [UIView animateWithDuration:[self randomFloatBetween:1.0 and:0.3] animations:^{
        m1.center = CGPointMake(63, 210);
    }];

   [self performSelector:@selector(down) withObject:nil afterDelay:[self randomFloatBetween:1.0 and:0.5]];
 } 
```

我的 CGPointMake 中的 63 号应该是随机的。所以对于数字 63，我需要随机选择这些数字：160 和 257。

我的“m1”图像出现在 CGPointMake(63, 210)，但我想让点 63 随机，从 63 更改为 160 或 257。随机。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:37:41.170

将所需的数字添加到 NSArray，然后使用`[yourArray objectAtIndex:(arc4random()%yourArray.count)];`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:55:03.553

```
-(void)up
{
    NSArray *myArray = [NSArray arrayWithObjects:[NSNumber numberWithFloat:63],[NSNumber numberWithFloat:160],[NSNumber numberWithFloat:257], nil];
    [UIView animateWithDuration:[self randomFloatBetween:1.0 and:0.3] animations:^{
        m1.center = CGPointMake([[myArray objectAtIndex:arc4random() % [myArray count]] floatValue], 210);
    }];
    [self performSelector:@selector(down) withObject:nil afterDelay:[self randomFloatBetween:1.0 and:0.5]];
} 
```

也许这会有所帮助。

# c++ - 在 C++ 或 Matlab 中用于图像的 CRF 实现代码

> ID：13211690
> 
> 赞同：0
> 
> 时间：2012-11-03T17:32:14.830
> 
> 标签：c++, matlab, image-segmentation

我需要一些在 C++ 或 Matlab 中实现 CRF 的代码，用于分割问题的图像。哪个代码库更合适？如果它支持更高阶的能量项，那就太好了

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:37:12.387

我在 Justin Domke 的[JGMT](http://phd.gccis.rit.edu/justindomke/JGMT/)上取得了巨大的成功。它是用 C++ 编写的，可以从 Matlab 中使用。我建议你先看看这个库。

还有很多其他选择：[CRFSuite](http://www.chokkan.org/software/crfsuite/)，它是用 C++ 编写的，但很容易从 Python 和其他东西中访问。

还有[CRF++](http://crfpp.googlecode.com/svn/trunk/doc/index.html)，它是用 C++ 编写的，并且有 Python 和 Ruby 的绑定。

# iphone - iphone：如何制作一个包含多种字体和图像的可滚动字段？

> ID：13211698
> 
> 赞同：0
> 
> 时间：2012-11-03T17:33:11.820
> 
> 标签：iphone

我需要创建一个包含多种字体和图像的可滚动字段。那可能吗？我正在考虑将 UITextView 用于该字段，但我怀疑它能否完成我需要它做的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:19:10.327

如果此字段不在 UITableView 中，那么最简单的解决方案是将您的内容组织在 html 文档中，然后将其呈现在适用于 iOS5 和 iOS6 的 UIWebView 中。字体可以通过 webfonts 处理并通过样式设置。css。否则，您将有一些工作要做。

您可以在此处了解网络字体：

[https://developers.google.com/webfonts/docs/getting_started](https://developers.google.com/webfonts/docs/getting_started)

对于 UITextField 中的富文本...

嗯，有好消息也有坏消息。好消息是在 iOS6 上很容易做到。这只是创建一个 NSAttributedString 并将字符串传递给 UITextView 的问题。文本应该按照您在 NSAttrbutedString 中描述的格式进行格式化。

如果你还没有使用过 NSAttributedString，你可以从这里开始学习它们：

[你如何使用 NSAttributedString？](https://stackoverflow.com/questions/3482346/how-do-you-use-nsattributedstring)

如果您有 Apple 开发者帐户，请查看 WWDC 2012 视频：iOS 属性字符串简介

[https://developer.apple.com/videos/wwdc/2012/](https://developer.apple.com/videos/wwdc/2012/)

现在坏消息...这不包含在iOS5中。所以你必须a）使用CoreText之类的东西来构建你自己的自定义视图来呈现文本，b）平底船并使用UIWebView（表格视图中的一个可怕的想法），或者c）你可以查看一些其他的本土解决方案比如这些：

[https://github.com/AliSoftware/OHAttributedLabel](https://github.com/AliSoftware/OHAttributedLabel)

[https://github.com/enormego/EGOTextView#readme](https://github.com/enormego/EGOTextView#readme)

还有更多，但你必须在谷歌上找到它们。

至于图像，只需将图像视图与文本视图一起组织即可。确保将所有内容都放在 UIScrollView 中，然后您就可以开始使用了。

祝你好运！

# c - 为什么我得到未定义的睡眠错误引用？

> ID：13211700
> 
> 赞同：2
> 
> 时间：2012-11-03T17:33:16.140
> 
> 标签：c, include, sleep

代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

struct subscriber {
    char phonenumber[20];
    char name[50];
    float amount;
} s;

void addrecords();
void listrecords();
void modifyrecords();
void deleterecords();
void searchrecords();
void payment();

char get;

int main()
{
    int password;
    int phonenumber;
    char choice;

    system("cls");

    printf
    ("\n\n\n\n\n\n\n\n\n**********************************************************************");
    printf("\n\t\t---WELCOME TO THE TELECOM BILLING MANAGEMENT SYSTEM---");
    printf("\n\t\t****************************************************************");

    Sleep(2000);

    getch();

    system("cls");

    while (1) {
        system("cls");
        printf("\n enter\n A : for adding new records.\n L : for list of records");
        printf("\n M : for modifying records.\n P : for payment");
        printf("\n S : for searching records.");
        printf("\n D : for deleting records.\n E : for exit\n");

        choice = getche();
        choice = toupper(choice);

        switch (choice) {
        case 'P':
            payment();
        break;

        case 'A':
            addrecords();
            break;

        case 'L':
            listrecords();
            break;

        case 'M':
            modifyrecords();
            break;

        case 'S':
            searchrecords();
            break;

        case 'D':
            deleterecords();
            break;

        case 'E':
            system("cls");
            printf("\n\n\t\t\t\tTHANK YOU");
            printf("\n\n\n\n\n:\n\tFOR USING OUR SERVICE");
            Sleep(2000);
            exit(0);
            break;

        default:
            system("cls");
            printf("Incorrect Input");
            printf("\nAny key to continue");
            getch();

        }

    }

} 
```

错误：

```
proj.c:(.text+0x53): undefined reference to `Sleep'
proj.c:(.text+0x5d): undefined reference to `getch'
proj.c:(.text+0xbb): undefined reference to `getche'
proj.c:(.text+0x17f): undefined reference to `Sleep'
proj.c:(.text+0x1c1): undefined reference to `getch'
/tmp/cc4UYi0H.o: In function `addrecords':
proj.c:(.text+0x244): undefined reference to `getch'
proj.c:(.text+0x340): undefined reference to `getche'
/tmp/cc4UYi0H.o: In function `listrecords':
proj.c:(.text+0x44c): undefined reference to `getch'
/tmp/cc4UYi0H.o: In function `deleterecords':
proj.c:(.text+0x5b2): undefined reference to `getch'
proj.c:(.text+0x632): undefined reference to `getch'
/tmp/cc4UYi0H.o: In function `searchrecords':
proj.c:(.text+0x791): undefined reference to `getch'
/tmp/cc4UYi0H.o: In function `payment':
proj.c:(.text+0xb1f): undefined reference to `getch'
collect2: ld returned 1 exit status 
```

我尝试了此处给出的解决方案（[未定义对“睡眠”的引用，但我确实包含了 <unistd.h>](https://stackoverflow.com/questions/8764295/undefined-reference-to-sleep-but-i-did-include-unistd-h)），但它仍然无法正常工作。我在 Ubuntu 12.04 上使用 gcc。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T17:34:07.300

您的代码似乎来自 Windows 操作系统。在 Linux 上，该函数`Sleep`不存在（`Sleep` 是来自 Windows API 的函数！）。尝试`sleep`(from `<unistd.h>`) 代替。正如*alk*所说，请记住 和 的论点`Sleep`是`sleep`不同的：

*   `Sleep`以毫秒为单位的时间；
*   `sleep`需要以秒为单位的时间。

同样，该`getch`函数和`cls` shell 命令不适用于 GNU/Linux。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:37:51.357

getch() 不是标准库的一部分，它是库中的一个函数，你忘了声明它使用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T17:41:48.297

根据标准删除，您的代码是不可移植的，`getch`并且`cls`

用于睡眠`sleep(n); //n is number of seconds`

有关终端上的更多信息类型：`man 3 sleep`

还有一个建议，当您将代码从 windows 移植到 linux 时

尝试使用`gcc -Wall -Werror`选项编译

# haskell - 我需要在字符列表中转换这个字符串

> ID：13211701
> 
> 赞同：2
> 
> 时间：2012-11-03T17:33:21.567
> 
> 标签：haskell

我正在学习haskell。我正在从文本文件中读取一个字符串，并且需要使这个字符串成为一个 char 列表。

输入文件是这样的：

```
Individuo A; TACGATCAAAGCT 
Individuo B; AATCGCAT 
Individuo C; TAAATCCGATCAAAGAGAGGACTTA 
```

我需要转换这个字符串

```
S1 = "AAACCGGTTAAACCCGGGG"  in  S1 = 
["A","A","A","C","C","G","G","T","T","A","A","A","C","C","C","G","G","G","G"] 
or S1 = 
['A','A','A','C','C','G','G','T','T','A','A','A','C','C','C','G','G','G','G'] 
```

但它们用“;”分隔

我应该怎么办？

我能做些什么？

获得两个列表后，我将它们发送到此代码：

```
lcsList :: Eq a => [a] -> [a] -> [a]
lcsList [] _ = []
lcsList _ [] = []
lcsList (x:xs) (y:ys) = if x == y
                          then x : lcsList xs ys
                          else
                            let lcs1 = lcsList (x:xs) ys
                                lcs2 = lcsList xs (y:ys)
                            in if (length lcs1) > (length lcs2)
                                  then lcs1
                                  else lcs2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T17:59:47.130

拆分每个字符串的粗略且现成的方法是使用类似这样的方法-您可以在 ghci 中尝试

```
let a = "Individuo A; TACGATCAAAGCT"
tail $ dropWhile (/= ' ') $ dropWhile (/= ';') a 
```

这给了你：

```
"TACGATCAAAGCT" 
```

由于 String 只是 Char 的列表，因此与以下内容相同：

```
['T', 'A', 'C', 'G', ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T17:48:14.100

If your file consists of several lines, it is quite simple: you just need to skip everything until you find “;”. If your file consists of just one line, you’ll have to look for sequences’ beginnings and endings separately (hint: sequence ends with space). Write a recursive function to do the task, and use functions `takeWhile`, `dropWhile`.

A `String` is already a list of `Char` (it is even defined like this: `type String = [Char]`), so you don’t have to do anything else. If you need a list of `String`s, where every `String` consists of just one char, then use `map` to wrap every char (once again, every `String` is a list, so you are allowed to use `map` on these). To wrap a char, there are three alternatives:

1.  Use lambda function: `map (\c -> [c]) s`
2.  Use operator section: `map (:[]) s`
3.  Define a new function: `wrap x = [x]`

Good luck!

# c# - 如何检查 FtpWebRequest 超时

> ID：13211703
> 
> 赞同：0
> 
> 时间：2012-11-03T17:34:01.740
> 
> 标签：c#, vb.net

如何检查 FtpWebRequest 超时

```
 Try

        Dim request As FtpWebRequest = CType(WebRequest.Create("ftp://"), FtpWebRequest)
        request.Method = WebRequestMethods.Ftp.ListDirectoryDetails
        request.Timeout = 4000

        ' If 'TimeOut' = False Then

        request.Credentials = New NetworkCredential("u", "p")
        Using response As FtpWebResponse = CType(request.GetResponse(), FtpWebResponse)

            Using responseStream As Stream = response.GetResponseStream()
                Using reader As New StreamReader(responseStream)

                    'do this

                End Using

            End Using

        End Using

        'End If

    Catch ex As Exception

    End Try 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:45:42.353

您通常可以设置超时值，如果在上述时间内没有响应，则会抛出[WebException ，](http://msdn.microsoft.com/en-us/library/ztey1y5b.aspx)[状态](http://msdn.microsoft.com/en-us/library/system.net.webexception.status.aspx)属性为 Timeout。您可以捕获它并适当地处理它。

```
 Try
    //your code for request/response
  Catch ex As WebException
    MsgBox("Exception reason "&ex.State)
  End Try 
```

# javascript - 如何使用从同一文件中获得的文字访问 JSON 文件中的对象属性

> ID：13211705
> 
> 赞同：0
> 
> 时间：2012-11-03T17:34:20.867
> 
> 标签：javascript, json, d3.js, underscore.js

我正在尝试从 JSON 文件中的数据创建一个带有 d3 的堆积条形图。每个酒吧都会有特定月份的平局、输球和赢球。

JSON文件：

```
{
    "name": "FHS",
    "points": 3000,
    "ties": 3,
    "losses": 19,
    "wins": 50,
    "games": {
        "2010-09": { "ties": 1, "losses": 2, "wins": 16 },
        "2010-10": { "ties": 2, "losses": 5, "wins": 13 },
        "2010-11": { "ties": 0, "losses": 12, "wins": 21 }
    }
} 
```

我已经使用 d3.json 功能很好地使用了一些数据。例如：

```
d3.json("data.json",function(error,data)
    {
        alert(data.name);
        alert(data.points);
        // etc.
    }); 
```

但这就是有趣的地方（仅供参考，我正在使用下划线库来获取“游戏”的每个属性......也许这是我出错的地方？）。如果我尝试以下操作：

```
_.keys(data.games).forEach(function(d)
    {
        alert(d);
    }); 
```

我在三个不同的警报框中得到了 2010-09、2010-10、2010-11……完美！但是，如果我尝试以下操作：

```
_.keys(data.games).forEach(function(d)
    {
        alert(d.ties);
    }); 
```

我得到未定义：/事实上，我看到的另一个问题是

```
alert(data.games.2010-09.ties); 
```

应该可以工作（如果属性名称不是以整数开头或没有连字符......），但不会因为文字的格式（“2010-09”）......所以，我的主要问题是如何以使生成图表变得简单的方式动态访问嵌套对象属性。我已尝试包含足够的上下文，但如果您需要更多信息，请告诉我。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:58:39.867

您可以将键附在`[""]`其中以访问该值，即`alert(data.games["2010-09"].ties);`可以使用。您可能还对使用键值结构的 d3 函数感兴趣；请参阅[文档](https://github.com/mbostock/d3/wiki/Arrays#wiki-d3_keys)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T03:10:12.383

您在警报框中得到未定义，因为`d`在此函数内部，是一个字符串——“2010-09”、“2010-10”、“2010-11”等——因为您正在遍历由`_.keys(data.games)`.

所以，`alert(d.ties)`就像 call `alert("2010-09".ties)`，这是预期未定义的。

但是，在拉斯解释的基础上，

```
_.keys(data.games).forEach(function(d)
{
    alert(data.games[d].ties);
}); 
```

是您获取数据的方式。

PS`console.log(data.games[d].ties)`是调试 javascript 的更健壮的方式（因此通常是首选方式）。

# windows - node.js, windows 7, spawn chrome, 无法设置用户数据目录

> ID：13211706
> 
> 赞同：2
> 
> 时间：2012-11-03T17:34:21.347
> 
> 标签：windows, node.js, spawn

我正在尝试在 Windows 7 上使用 node.js 打开 Google Chrome `spawn`。它似乎适用于所有参数，除了设置`user-data-dir`. 但是，`--user-data-dir`直接从命令行工作，如果我从节点调用 .cmd 文件并通过它传递参数，也可以工作。

Chrome 在后台打开（显示在任务管理器中），但浏览器窗口没有打开，我必须手动终止任务管理器中的进程才能结束它。

我没有收到任何错误或任何关于问题所在的指示。

这是我的节点代码：

```
var spawn  = require('child_process').spawn;
var exe = 'C:\\Program Files\\Google\\Chrome\\application\\chrome.exe';

//this does not work and gives no errors just starts chrome in the background but fails to open browser window
// var args = [
//      '--user-data-dir=C:\\Windows\\Temp\\testingdir',
//      'http://www.google.com'
//  ];

//actual output from running this through a .cmd file and echoing out the arguments
// --user-data-dir=C:\Windows\Temp\testingdir http://www.google.com
//running the above arguments through a .cmd file from nodejs or manually running them in the cli works

//this works from nodejs, other arguments work too, just not the --user-data-dir argument
// var args = ['http://www.google.com'];

chrome = spawn(exe, args);

chrome.stdout.on('data', function (data) {
  console.log('stdout: ' + data);
});

chrome.stderr.on('data', function (data) {
  console.log('stderr: ' + data);
});

chrome.on('exit', function (code) {
  console.log('child process exited with code ' + code);
  // chrome.kill();
}); 
```

正如您在注释掉的代码中看到的那样，只要我不尝试更改用户数据目录，它就可以工作。我尝试了不同的临时目录，并在临时目录上设置了对“每个人”的完全访问权限，以防出现权限问题。

**更新：**我刚刚从 v0.8.1 更新到最新的 v0.8.14，现在当它失败时`on('exit', function())`实际返回一个代码。

```
child process exited with code 20 
```

如何查找此代码以了解其含义？

**更新 2**我认为退出代码 20 只是一次侥幸，因为我无法再重现它了。尝试测试不同的东西有点麻烦，因为我必须记住每次都在任务管理器中杀死 chrome 进程以确保我得到相同的结果。所以它回到了和以前一样的结果，没有错误但没有 chrome 窗口，并且一些运行的 chrome 进程必须手动终止。

**更新 3** 我刚刚将此脚本移至 Ubuntu 并更改了 exe 和 args 以反映不同的文件结构，它适用于 Ubuntu。

```
exe = "/opt/google/chrome/google-chrome" 
```

和

```
args = [
    "http://www.google.com",
    "--user-data-dir=/home/lotus/testdir"
    ]; 
```

所以我可以确认这与 Windows 上的 Chrome 相关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:50:21.387

[http://www.hiteksoftware.com/mize/Knowledge/articles/049.htm](http://www.hiteksoftware.com/mize/Knowledge/articles/049.htm)

`20 The system cannot find the device specified.`

虽然没有多大意义

# javascript - JavaScript 按多个（数字）字段对数组进行排序

> ID：13211709
> 
> 赞同：47
> 
> 时间：2012-11-03T17:34:47.153
> 
> 标签：javascript, json, sorting

我怎样才能实现

```
 ORDER BY sort1 DESC, sort2 DESC 
```

JSON数组中的逻辑如下：

```
 var items = '[
          {
            "sort1": 1,
            "sort2": 3,
            "name" : "a",
          },
          {
            "sort1": 1,
            "sort2": 2,
            "name" : "b",
          },
          {
            "sort1": 2,
            "sort2": 1,
            "name" : "c",
          }
    ]'; 
```

导致新订单：

```
b,a,c 
```

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2012-11-03T17:37:40.127

您应该相应地设计排序功能：

```
items.sort(function(a, b) {
  return a.sort1 - b.sort1  ||  a.sort2 - b.sort2;
}); 
```

（因为`||`运算符的优先级低于`-`1，所以此处不必使用括号）。

逻辑很简单：如果`a.sort1 - b.sort1`表达式的计算结果为 0（因此这些属性相等），它将继续计算`||`表达式 - 并返回`a.sort2 - b.sort2`.

作为旁注，您`items`实际上是一个字符串文字，您必须`JSON.parse`获取一个数组：

```
const itemsStr = `[{
    "sort1": 1,
    "sort2": 3,
    "name": "a"
  },
  {
    "sort1": 1,
    "sort2": 2,
    "name": "b"
  },
  {
    "sort1": 2,
    "sort2": 1,
    "name": "c"
  }
]`;
const items = JSON.parse(itemsStr);
items.sort((a, b) => a.sort1 - b.sort1 || a.sort2 - b.sort2);
console.log(items);
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-11-22T00:24:38.277

您可以通过创建通用函数来避免硬编码

```
function sortByMultipleKey(keys) {
    return function(a, b) {
        if (keys.length == 0) return 0; // force to equal if keys run out
        key = keys[0]; // take out the first key
        if (a[key] < b[key]) return -1; // will be 1 if DESC
        else if (a[key] > b[key]) return 1; // will be -1 if DESC
        else return sortByMultipleKey(keys.slice(1))(a, b);
    }
} 
```

跑步

```
items.sort(sortByMultipleKey(['sort1', 'sort2'])); 
```

会有你

```
[ { sort1: 1, sort2: 2, name: 'b' },
  { sort1: 1, sort2: 3, name: 'a' },
  { sort1: 2, sort2: 1, name: 'c' } ] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-22T02:36:09.507

```
const itemsStr = `[{
    "sort1": 1,
    "sort2": 3,
    "name": "a"
  },
  {
    "sort1": 1,
    "sort2": 2,
    "name": "b"
  },
  {
    "sort1": 2,
    "sort2": 1,
    "name": "c"
  }
]`;
const items = JSON.parse(itemsStr);
items.sort((a, b) => a.sort1 - b.sort1 || a.sort2 - b.sort2);
console.log(items);
```

# java - 精灵部分的 AndEngine 图像

> ID：13211712
> 
> 赞同：0
> 
> 时间：2012-11-03T17:34:58.783
> 
> 标签：java, android, andengine

我正在开发一款集成 Facebook 的游戏。在某个场景下，用户可以从已安装游戏的Facebook好友列表中选择一个对手。

我想创建这个朋友菜单，我知道如何创建列表，我知道如何获取安装了应用程序的朋友，以及如何获取他们的信息。我不知道的是如何创建一个精灵，例如，左边是用户的个人资料图像，右边是他的名字和分数，并让整个东西充当精灵（或`SpriteButton`)

谁能指出我正确的方向？由于我从 Facebook 获得信息，显然我无法预先制作 Sprite。

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:48:34.340

您不应该为此使用 AndEngine 实体，因为没有任何东西可以满足您的需求（您必须自己制作）。

相反，使用常规的 android 对话框。您可以使用自己的布局，其中包含个人资料图片和您想要的任何其他文本。

# c# - CSharpCodeProvider 将控制台应用程序输出为 Windows 窗体应用程序

> ID：13211714
> 
> 赞同：0
> 
> 时间：2012-11-03T17:35:25.170
> 
> 标签：c#, .net

我有一些代码可以使用 CSharpCodeProvider 即时从 c# 源创建 exe，这里是：

```
public static void BuildAssembly(string code)
{
    Microsoft.CSharp.CSharpCodeProvider provider =
    new CSharpCodeProvider();
    ICodeCompiler compiler = provider.CreateCompiler();
    CompilerParameters compilerparams = new CompilerParameters();

    compilerparams.ReferencedAssemblies.Add("System.dll");
    compilerparams.GenerateExecutable = true;
    compilerparams.GenerateInMemory = false;
    compilerparams.OutputAssembly = @"C:\Users\me\AppData\Roaming\test.exe";
    CompilerResults results =
       compiler.CompileAssemblyFromSource(compilerparams, code);
    if (results.Errors.HasErrors)
    {
        StringBuilder errors = new StringBuilder("Compiler Errors :\r\n");
        foreach (CompilerError error in results.Errors)
        {
            errors.AppendFormat("Line {0},{1}\t: {2}\n",
                   error.Line, error.Column, error.ErrorText);
        }
        throw new Exception(errors.ToString());
    }
    else
    {

    }
} 
```

一切正常，它编译我的控制台应用程序 c# 代码。但是当我编写控制台应用程序并且我要求控制台不可见时，我只需转到应用程序属性并将输出类型从控制台更改为 Windows 应用程序。那么我将如何通过我上面粘贴的功能来做到这一点？我已经浏览了所有选项，但.. 不知道 :(

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T18:41:43.070

尝试这个：

```
compilerparams.CompilerOptions = "/target:winexe"; 
```

# java - 为什么运行时不启动另一个进程？

> ID：13211719
> 
> 赞同：-2
> 
> 时间：2012-11-03T17:36:27.003
> 
> 标签：java

我认为它应该多次打印消息，但只打印一次？有什么问题？谢谢。

```
import java.io.IOException;

public class RestartApplication {

    public static void main(String[] args) {       
        System.out.println("Test restarting the application!");       
        restart();
    }

    private static void restart() {
        try{
            Runtime.getRuntime().exec("java RestartApplication");
        }catch(IOException ie){
                   ie.printStackTrace();
        }
    }   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:51:12.270

The reason it only prints once is that you need to print the output from the process, otherwise it will run silently:

```
Process process = Runtime.getRuntime().exec("java RestartApplication no-run");
BufferedReader input = new BufferedReader(new InputStreamReader(process.getInputStream()));
String line = null;
while ((line = input.readLine()) != null) {
   System.out.println(line);
} 
```

When the output is displayed you will see a chain of processes each starting a new copy of `RestartApplication` which will consume a lot resources so you may wish to consider to pass in a command-line argument **not** to start another process.

Even a simple argument check will save your system by restricting the # of processes to 2:

```
if (args.length == 0) {
   restart();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:46:08.793

我怀疑在命令行上运行它不起作用，所以当你从 Java 运行它时它也不起作用。

```
System.out.println("Test restarting the application!");
Process exec = Runtime.getRuntime().exec(new String[]{"java", "-cp", System.getProperty("java.class.path"), "RestartApplication"});
BufferedReader br = new BufferedReader(new InputStreamReader(exec.getInputStream()));
for (String line; (line = br.readLine()) != null; )
    System.out.println(line); 
```

印刷

```
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application!
Test restarting the application! 
```

# java - 如何用 Jframe 或 JPanel 贴住 JScrollPane 的边框？

> ID：13211721
> 
> 赞同：2
> 
> 时间：2012-11-03T17:36:42.650
> 
> 标签：java, swing

我的意思是当我将框架调整到左侧或右侧时，表格会自动调整大小，但是当我从表格的上下两侧调整它的大小时，我想要相同的未来。向下和向上滚动，但我希望默认大小更小。

事实上`aJScrollPane.setSize()`也不起作用`aJPanel.setSize()`。你能帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T19:05:41.767

如果您试图限制表格默认显示的行数，您可以使用[JTable.setPreferredScrollableViewportSize()](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTable.html#setPreferredScrollableViewportSize%28java.awt.Dimension%29)。例如，对于 10 行，您可以执行以下操作：

```
table.setPreferredScrollableViewportSize(
        new Dimension(table.getPreferredScrollableViewportSize().width, 
                10 * table.getRowHeight())); 
```

但是请注意，表格行可以具有可变高度。另请注意，硬编码大小通常会产生副作用。

# java - 如何在 Java 中为票据打印机提供格式和打印数据

> ID：13211730
> 
> 赞同：1
> 
> 时间：2012-11-03T17:37:47.440
> 
> 标签：java, printing

我开始做这样的事情，所以我需要一点帮助。

我想打印一些数据并给它一个格式来打印它作为建立票，那么最好的方法是什么？

*   使用 java api 并自己创建服务？ [http://docs.oracle.com/javase/tutorial/2d/printing/index.html](http://docs.oracle.com/javase/tutorial/2d/printing/index.html)

*   或者它是否存在任何用于此目的的免费库？

*   也许在打印之前用数据创建一个 PDF 更好？我一直在搞乱 PDFbox API，但我不太喜欢它。

*   我不知道将使用什么打印机，票打印机是使用标准尺寸还是存在不同的票尺寸？

*   我还需要在打印之前显示预览（我使用的是 Swing）。

*   无需存储格式化数据。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:33:54.093

来自一个真实的例子：我们正在运行一个项目，该项目打印发货标签以发送带有包裹服务的包裹。标签包含条形码和其他文本信息以及徽标。

通常票据打印机可以理解一种特殊的打印机控制语言，即如果它是 Zebra 打印机，它可以理解 EPL 或 ZPL 代码。要生成一张票，我们只需通过一个简单的套接字连接将整个控制代码发送到打印机。控制代码本身是通过模板引擎（在我们的例子中为 Velocity）创建的。

当然，有不同的打印机可以满足不同的要求——这可能取决于实际应该打印的内容。因此，根据打印机的不同，您可能需要创建一组不同的模板来制作标签：

[https://en.wikipedia.org/wiki/Printer_control_language](https://en.wikipedia.org/wiki/Printer_control_language)

顺便说一句：通常打印机附带软件，让您设计纸标签的布局（这让生活变得非常轻松）。我们使用这个软件来创建初始布局。控制代码本身包含用于配置打印机的所有命令（标签尺寸等 - 毫无疑问，有很多不同的格式和尺寸，如前所述：它确实取决于用例）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T18:18:12.797

如果您决定生成 pdf 文件然后打印，我建议使用[Apache FOP](http://xmlgraphics.apache.org/fop/)。我总是使用这个库来生成 PDF。这个库并不容易，但提供了许多选项。

第二种选择 - 您可以生成 HTML 页面然后打印它。

# entity-framework - 工作单元，已禁用 LazyLoading，通用存储库，IncludeMultiple , Http 500 错误

> ID：13211731
> 
> 赞同：4
> 
> 时间：2012-11-03T17:37:48.510
> 
> 标签：entity-framework, api, repository-pattern, unit-of-work

1.  我有一个与模型关联的车辆，模型与制造有关联。

2.  这是我的通用存储库，与我的项目中的 LazyLoadingEnabled = false 关联有关：

    ```
    public IQueryable<T> IncludeMultiple<T1>(params Expression<Func<T, object>>[] associations) where T1 : class
    {
        var source = (IQueryable<T>)DbContext.Set<T>();
        if (associations != null)
        {
            foreach (Expression<Func<T, object>> path in associations)
                source = DbExtensions.Include<T, object>(source, path);
        }
        return source;
    } 
    ```

3.  在我的 api 控制器中，我使用的是工作单元模式。这是我的 GetAll 方法：

    ```
    public IEnumerable<Vehicle> GetAll()
    {
      var vehicles = Uow.VehicleRepository.IncludeMultiple<Vehicle>(c => c.VehicleModel).ToList();
      return vehicles;
    } 
    ```

一切正常，Json 检索 Vehicle 类数据以及相关的 VehicleModel 类数据。

但是，Vehicle 与 VehicleMake 没有直接关联，只有 VehicleModel 有。现在，如果我的 GetAll 方法有这个：

```
 public IEnumerable<Vehicle> GetAll()
    {
      var vehicles = Uow.VehicleRepository.IncludeMultiple<Vehicle>(c => c.VehicleModel, c => c.VehicleModel.VehicleMake).ToList();
      return vehicles;
    } 
```

虽然我在调试中看到车辆确实具有车辆及其相关的 VehicleModel 和 VehicleMake 数据，但它在 Fiddler 中返回一个 Http 500 错误。

* * *

更新：

* * *

在 Vehicle 中添加了另一个名为“Test”的关联，GetAll 方法为：

(c => c.VehicleModel, c => c.Test)

没有错误，所有数据都是通过提琴手返回的。因此，似乎“非直接关联”（即 Vehicle -> VehicleMake）是导致错误的原因。

* * *

问题：

* * *

检索相关车辆数据及其相关类的数据并将其返回给 Json 而不会出现 Http 500 错误的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T21:46:41.823

* * *

**已解决**

* * *

这有效：

```
 public HttpResponseMessage GetAll()
  {
      var vehicles = from data in  Uow.VehicleRepository.IncludeMultiple<Vehicle>(c => c.VehicleModel,c => c.VehicleModel.VehicleMake)
                         select new 
                             {
                                VehDesc = data.Description,
                                VehVIN = data.VIN,
                                VehTransmissionType = data.TransmissionType,
                                VehFuelType = data.FuelType,
                                VehYear = data.Year,
                                VehMileage = data.Mileage,
                                VehCylinderSize = data.CylinderSize,
                                VehEngineSize = data.EngineSize,
                                VehVehicleModel = data.VehicleModel.Name,
                                VehMakeName = data.VehicleModel.VehicleMake.Name
                             };
      return Request.CreateResponse(HttpStatusCode.OK, vehicles);
  } 
```

基本上，

```
 1\. I used an HttpResponseMessage as my return type;

 2\. I used projection to create an anonymous type; 
```

为什么我必须这样做？

据我所知，问题集中在 JSON 接收 VehicleModel 和 VehicleMake 的“循环”返回。也就是说，VehicleModel 有一个与 VehicleMake 的关联，而 VehicleMake 有一个 VehicleModel 的集合。当我查看调试代码时，我可以看到 VehicleModel 到 VehicleMake 到 VehicleModel 等的级联，等等，等等，所以对我来说这意味着它是循环的。

If anyone knows a better way w/o using anonymous type nor removing the virtual keyword from my navigation properties, I would certainly like to know it. But this does truly work.

FinalNote: Be sure NOT to use the model's property names in anonymous type, ie replace property "TransmissionType" with something like "VehTransmissionType".

# python - 检测人脸然后自动裁剪图片

> ID：13211745
> 
> 赞同：63
> 
> 时间：2012-11-01T18:13:43.703
> 
> 标签：python, linux, opencv, crop, face-detection

我正在尝试找到一个可以检测图片中的人脸的应用程序，使检测到的人脸居中并裁剪图片的 720 x 720 像素。编辑我打算这样做的数百张图片相当耗时且细致。

我曾尝试使用[此处提到的 python opencv](http://creatingwithcode.com/howto/face-detection-in-static-images-with-python/)执行此操作，但我认为它已经过时了。我也尝试过[使用它](http://www.givp.org/blog/2011/06/13/image-cropping-and-face-detection/)，但它也在我的系统中给我一个错误。还尝试使用 GIMP 的人脸检测插件，但它是为 GIMP 2.6 设计的，但我经常使用 2.8。我也尝试过在超高博客上发布的内容，但它已经过时了（因为我使用的是 Ubuntu 的 Precise 衍生产品，而博文是在它仍然是 Hardy 的时候发布的）。也尝试使用 Phatch，但没有人脸检测，所以一些裁剪的图片的脸被剪掉了。

我已经尝试了以上所有方法，并浪费了半天时间试图使上述任何一种方法完成我需要做的事情。

你们有什么建议可以实现我拥有的大约 800 张照片的目标。

我的操作系统是 Linux Mint 13 MATE。

注意：我打算再添加 2 个链接，但由于我还没有太多声誉，stackexchange 阻止我再发布两个链接。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2012-11-06T03:01:53.653

我已经设法从各种来源获取一些代码并将它们拼接在一起。它仍在进行中。另外，您有任何示例图像吗？

```
'''
Sources:
http://pythonpath.wordpress.com/2012/05/08/pil-to-opencv-image/
http://www.lucaamore.com/?p=638
'''

#Python 2.7.2
#Opencv 2.4.2
#PIL 1.1.7

import cv
import Image

def DetectFace(image, faceCascade):
    #modified from: http://www.lucaamore.com/?p=638

    min_size = (20,20)
    image_scale = 1
    haar_scale = 1.1
    min_neighbors = 3
    haar_flags = 0

    # Allocate the temporary images
    smallImage = cv.CreateImage(
            (
                cv.Round(image.width / image_scale),
                cv.Round(image.height / image_scale)
            ), 8 ,1)

    # Scale input image for faster processing
    cv.Resize(image, smallImage, cv.CV_INTER_LINEAR)

    # Equalize the histogram
    cv.EqualizeHist(smallImage, smallImage)

    # Detect the faces
    faces = cv.HaarDetectObjects(
            smallImage, faceCascade, cv.CreateMemStorage(0),
            haar_scale, min_neighbors, haar_flags, min_size
        )

    # If faces are found
    if faces:
        for ((x, y, w, h), n) in faces:
            # the input to cv.HaarDetectObjects was resized, so scale the
            # bounding box of each face and convert it to two CvPoints
            pt1 = (int(x * image_scale), int(y * image_scale))
            pt2 = (int((x + w) * image_scale), int((y + h) * image_scale))
            cv.Rectangle(image, pt1, pt2, cv.RGB(255, 0, 0), 5, 8, 0)

    return image

def pil2cvGrey(pil_im):
    #from: http://pythonpath.wordpress.com/2012/05/08/pil-to-opencv-image/
    pil_im = pil_im.convert('L')
    cv_im = cv.CreateImageHeader(pil_im.size, cv.IPL_DEPTH_8U, 1)
    cv.SetData(cv_im, pil_im.tostring(), pil_im.size[0]  )
    return cv_im

def cv2pil(cv_im):
    return Image.fromstring("L", cv.GetSize(cv_im), cv_im.tostring())

pil_im=Image.open('testPics/faces.jpg')
cv_im=pil2cv(pil_im)
#the haarcascade files tells opencv what to look for.
faceCascade = cv.Load('C:/Python27/Lib/site-packages/opencv/haarcascade_frontalface_default.xml')
face=DetectFace(cv_im,faceCascade)
img=cv2pil(face)
img.show() 
```

在 Google 的第一页上进行测试（用 Google 搜索的“面孔”）： ![在此处输入图像描述](../Images/4b471bc8cd306bf00e0f28c03bf683d6.png)

* * *

## **更新**

这段代码应该完全符合您的要求。如果您有任何问题，请告诉我。我试图在代码中包含很多注释：

```
'''
Sources:
http://opencv.willowgarage.com/documentation/python/cookbook.html
http://www.lucaamore.com/?p=638
'''

#Python 2.7.2
#Opencv 2.4.2
#PIL 1.1.7

import cv #Opencv
import Image #Image from PIL
import glob
import os

def DetectFace(image, faceCascade, returnImage=False):
    # This function takes a grey scale cv image and finds
    # the patterns defined in the haarcascade function
    # modified from: http://www.lucaamore.com/?p=638

    #variables    
    min_size = (20,20)
    haar_scale = 1.1
    min_neighbors = 3
    haar_flags = 0

    # Equalize the histogram
    cv.EqualizeHist(image, image)

    # Detect the faces
    faces = cv.HaarDetectObjects(
            image, faceCascade, cv.CreateMemStorage(0),
            haar_scale, min_neighbors, haar_flags, min_size
        )

    # If faces are found
    if faces and returnImage:
        for ((x, y, w, h), n) in faces:
            # Convert bounding box to two CvPoints
            pt1 = (int(x), int(y))
            pt2 = (int(x + w), int(y + h))
            cv.Rectangle(image, pt1, pt2, cv.RGB(255, 0, 0), 5, 8, 0)

    if returnImage:
        return image
    else:
        return faces

def pil2cvGrey(pil_im):
    # Convert a PIL image to a greyscale cv image
    # from: http://pythonpath.wordpress.com/2012/05/08/pil-to-opencv-image/
    pil_im = pil_im.convert('L')
    cv_im = cv.CreateImageHeader(pil_im.size, cv.IPL_DEPTH_8U, 1)
    cv.SetData(cv_im, pil_im.tostring(), pil_im.size[0]  )
    return cv_im

def cv2pil(cv_im):
    # Convert the cv image to a PIL image
    return Image.fromstring("L", cv.GetSize(cv_im), cv_im.tostring())

def imgCrop(image, cropBox, boxScale=1):
    # Crop a PIL image with the provided box [x(left), y(upper), w(width), h(height)]

    # Calculate scale factors
    xDelta=max(cropBox[2]*(boxScale-1),0)
    yDelta=max(cropBox[3]*(boxScale-1),0)

    # Convert cv box to PIL box [left, upper, right, lower]
    PIL_box=[cropBox[0]-xDelta, cropBox[1]-yDelta, cropBox[0]+cropBox[2]+xDelta, cropBox[1]+cropBox[3]+yDelta]

    return image.crop(PIL_box)

def faceCrop(imagePattern,boxScale=1):
    # Select one of the haarcascade files:
    #   haarcascade_frontalface_alt.xml  <-- Best one?
    #   haarcascade_frontalface_alt2.xml
    #   haarcascade_frontalface_alt_tree.xml
    #   haarcascade_frontalface_default.xml
    #   haarcascade_profileface.xml
    faceCascade = cv.Load('haarcascade_frontalface_alt.xml')

    imgList=glob.glob(imagePattern)
    if len(imgList)<=0:
        print 'No Images Found'
        return

    for img in imgList:
        pil_im=Image.open(img)
        cv_im=pil2cvGrey(pil_im)
        faces=DetectFace(cv_im,faceCascade)
        if faces:
            n=1
            for face in faces:
                croppedImage=imgCrop(pil_im, face[0],boxScale=boxScale)
                fname,ext=os.path.splitext(img)
                croppedImage.save(fname+'_crop'+str(n)+ext)
                n+=1
        else:
            print 'No faces found:', img

def test(imageFilePath):
    pil_im=Image.open(imageFilePath)
    cv_im=pil2cvGrey(pil_im)
    # Select one of the haarcascade files:
    #   haarcascade_frontalface_alt.xml  <-- Best one?
    #   haarcascade_frontalface_alt2.xml
    #   haarcascade_frontalface_alt_tree.xml
    #   haarcascade_frontalface_default.xml
    #   haarcascade_profileface.xml
    faceCascade = cv.Load('haarcascade_frontalface_alt.xml')
    face_im=DetectFace(cv_im,faceCascade, returnImage=True)
    img=cv2pil(face_im)
    img.show()
    img.save('test.png')

# Test the algorithm on an image
#test('testPics/faces.jpg')

# Crop all jpegs in a folder. Note: the code uses glob which follows unix shell rules.
# Use the boxScale to scale the cropping area. 1=opencv box, 2=2x the width and height
faceCrop('testPics/*.jpg',boxScale=1) 
```

使用上图，这段代码从 59 个人脸中提取 52 个人脸，生成裁剪文件，例如： ![在此处输入图像描述](../Images/e4a8122514c3c26f771e33c2865c1411.png)![在此处输入图像描述](../Images/6dc13d546d37dc27081e1613f598e026.png)![在此处输入图像描述](../Images/9a7d8afa82114255740d8caf5daf4b12.png)![在此处输入图像描述](../Images/97fc6f59b508d37812398fe984094ef9.png)![在此处输入图像描述](../Images/d0d2fbfc2dcde5d157c77096174e671a.png)![在此处输入图像描述](../Images/fe1603591cf324c31f34fdec6dda9557.png)![在此处输入图像描述](../Images/b8497c1b40ecd6385ba0756c243c90f1.png)![在此处输入图像描述](../Images/102eafba99f5235760f432ba490d433b.png)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2017-02-23T06:26:27.393

另一个可用选项是[dlib](http://dlib.net/python/)，它基于机器学习方法。

```
import dlib
from PIL import Image
from skimage import io
import matplotlib.pyplot as plt

def detect_faces(image):

    # Create a face detector
    face_detector = dlib.get_frontal_face_detector()

    # Run detector and get bounding boxes of the faces on image.
    detected_faces = face_detector(image, 1)
    face_frames = [(x.left(), x.top(),
                    x.right(), x.bottom()) for x in detected_faces]

    return face_frames

# Load image
img_path = 'test.jpg'
image = io.imread(img_path)

# Detect faces
detected_faces = detect_faces(image)

# Crop faces and plot
for n, face_rect in enumerate(detected_faces):
    face = Image.fromarray(image).crop(face_rect)
    plt.subplot(1, len(detected_faces), n+1)
    plt.axis('off')
    plt.imshow(face) 
```

[![在此处输入图像描述](../Images/bd420e33b7baa7ab597d6f4d215b8048.png)](https://i.stack.imgur.com/V6562.jpg) [![在此处输入图像描述](../Images/c0ef9f82fe4481f42e82a9f5c71542f2.png)](https://i.stack.imgur.com/xHZtu.png)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-05-28T16:22:05.257

**`facedetect`用 Python 编写的 OpenCV CLI 包装器**

[https://github.com/wavexx/facedetect](https://github.com/wavexx/facedetect)是一个不错的 Python OpenCV CLI 包装器，我在他们的 README 中[添加](https://github.com/wavexx/facedetect/pull/7#event-675223551)了以下示例。

安装：

```
sudo apt install python3-opencv opencv-data imagemagick
git clone https://gitlab.com/wavexx/facedetect
git -C facedetect checkout 5f9b9121001bce20f7d87537ff506fcc90df48ca 
```

获取我的测试图像：

```
mkdir -p pictures
wget -O pictures/test.jpg https://raw.githubusercontent.com/cirosantilli/media/master/Ciro_Santilli_with_a_stone_carved_Budai_in_the_Feilai_Feng_caves_near_the_Lingyin_Temple_in_Hangzhou_in_2012.jpg 
```

用法：

```
mkdir -p faces
for file in pictures/*.jpg; do
  name=$(basename "$file")
  i=0
  facedetect/facedetect --data-dir /usr/share/opencv4 "$file" |
    while read x y w h; do
      convert "$file" -crop ${w}x${h}+${x}+${y} "faces/${name%.*}_${i}.${name##*.}"
    i=$(($i+1))
    done
done 
```

如果您不通过`--data-dir`此系统，它将失败并显示：

```
facedetect: error: cannot load HAAR_FRONTALFACE_ALT2 from /usr/share/opencv/haarcascades/haarcascade_frontalface_alt2.xml 
```

并且它正在寻找的文件可能位于：`/usr/share/opencv4/haarcascades`系统上。

运行后，文件：

```
faces/test_0.jpg 
```

包含：

[![在此处输入图像描述](../Images/91a0671433d55e34d0386b9bb605f3d1.png)](https://i.stack.imgur.com/KCl2M.jpg)

从原始图像中提取`pictures/test.jpg`：

[![在此处输入图像描述](../Images/a26a331a248fcfd4bae951e617de5ff2.png)](https://i.stack.imgur.com/CpIZ2.jpg)

Budai 未被识别 :-( 如果有，它会出现在 下`faces/test_1.jpg`，但该文件不存在。

让我们尝试另一种面部部分转向的人[https://raw.githubusercontent.com/cirosantilli/media/master/Ciro_Santilli_with_his_mother_in_law_during_his_wedding_in_2017.jpg](https://raw.githubusercontent.com/cirosantilli/media/master/Ciro_Santilli_with_his_mother_in_law_during_his_wedding_in_2017.jpg)

[![在此处输入图像描述](../Images/0f59c8e432262e9cdd8ec96f62c147a9.png)](https://i.stack.imgur.com/JDGVg.jpg)

嗯，没有命中，软件的面孔不够清晰。

在 Ubuntu 20.10、OpenCV 4.2.0 上测试。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-02T02:10:40.073

对于更多（计算机）技术集中的交易所之一来说，这听起来可能是一个更好的问题。

也就是说，你有没有研究[过类似这个](http://www.codediesel.com/javascript/face-detection-using-jquery/)jquery 人脸检测脚本的东西？我不知道您有多精明，但它是一种独立于操作系统的选项。

[这个解决方案](http://sourceforge.net/projects/snfacecrop/)看起来也很有希望，但需要 Windows。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-06-17T20:11:28.393

[自动裁剪](https://github.com/leblancfg/autocrop)对我来说效果很好。它就像`autocrop -i pics -o crop -w 400 -H 400`. 您可以在他们的自述文件中获得用法。

```
usage: autocrop [-h] [-i INPUT] [-o OUTPUT] [-r REJECT] [-w WIDTH] [-H HEIGHT]
                [-v] [--no-confirm] [--facePercent FACEPERCENT] [-e EXTENSION]

Automatically crops faces from batches of pictures

optional arguments:
  -h, --help            show this help message and exit
  -i INPUT, --input INPUT
                        Folder where images to crop are located. Default:
                        current working directory
  -o OUTPUT, --output OUTPUT, -p OUTPUT, --path OUTPUT
                        Folder where cropped images will be moved to. Default:
                        current working directory, meaning images are cropped
                        in place.
  -r REJECT, --reject REJECT
                        Folder where images that could not be cropped will be
                        moved to. Default: current working directory, meaning
                        images that are not cropped will be left in place.
  -w WIDTH, --width WIDTH
                        Width of cropped files in px. Default=500
  -H HEIGHT, --height HEIGHT
                        Height of cropped files in px. Default=500
  -v, --version         show program's version number and exit
  --no-confirm          Bypass any confirmation prompts
  --facePercent FACEPERCENT
                        Percentage of face to image height
  -e EXTENSION, --extension EXTENSION
                        Enter the image extension which to save at output 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-10-07T06:50:52.467

上面的代码有效，但这是最近使用 OpenCV 的实现

```
import cv2
import os

def facecrop(image):
    facedata = "haarcascade_frontalface_alt.xml"
    cascade = cv2.CascadeClassifier(facedata)

    img = cv2.imread(image)

    minisize = (img.shape[1],img.shape[0])
    miniframe = cv2.resize(img, minisize)

    faces = cascade.detectMultiScale(miniframe)

   for f in faces:
        x, y, w, h = [ v for v in f ]
        cv2.rectangle(img, (x,y), (x+w,y+h), (255,255,255))

        sub_face = img[y:y+h, x:x+w]
        fname, ext = os.path.splitext(image)
        cv2.imwrite(fname+"_cropped_"+ext, sub_face)

    return

facecrop("1.jpg") 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-11-13T00:53:22.473

只是添加到@Israel Abebe 的版本。如果您在图像扩展之前添加一个计数器，该算法将给出检测到的所有面部。附上代码，与 Israel Abebe 的相同。只需添加一个计数器并接受级联文件作为参数。该算法运行良好！感谢@Israel Abebe ！

```
import cv2
import os
import sys

def facecrop(image):
facedata = sys.argv[1]
cascade = cv2.CascadeClassifier(facedata)

img = cv2.imread(image)

minisize = (img.shape[1],img.shape[0])
miniframe = cv2.resize(img, minisize)

faces = cascade.detectMultiScale(miniframe)
counter = 0
for f in faces:
    x, y, w, h = [ v for v in f ]
    cv2.rectangle(img, (x,y), (x+w,y+h), (255,255,255))

    sub_face = img[y:y+h, x:x+w]
    fname, ext = os.path.splitext(image)
    cv2.imwrite(fname+"_cropped_"+str(counter)+ext, sub_face)
    counter += 1
return

facecrop("Face_detect_1.jpg") 
```

PS：添加为答案。由于积分问题，无法添加评论。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-05-11T03:41:11.380

检测人脸，然后裁剪并将裁剪后的图像保存到文件夹..

```
import numpy as np
import cv2 as cv
face_cascade = cv.CascadeClassifier('./haarcascade_frontalface_default.xml')
#eye_cascade = cv.CascadeClassifier('haarcascade_eye.xml')
img = cv.imread('./face/nancy-Copy1.jpg')
gray = cv.cvtColor(img, cv.COLOR_BGR2GRAY)
faces = face_cascade.detectMultiScale(gray, 1.3, 5)
for (x,y,w,h) in faces:
    cv.rectangle(img,(x,y),(x+w,y+h),(255,0,0),2)
    roi_gray = gray[y:y+h, x:x+w]
    roi_color = img[y:y+h, x:x+w]
    #eyes = eye_cascade.detectMultiScale(roi_gray)
    #for (ex,ey,ew,eh) in eyes:
     #   cv.rectangle(roi_color,(ex,ey),(ex+ew,ey+eh),(0,255,0),2)
    sub_face = img[y:y+h, x:x+w]
    face_file_name = "face/" + str(y) + ".jpg"
    plt.imsave(face_file_name, sub_face)
plt.imshow(sub_face)
```

* * *

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-06-29T07:12:38.040

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-02-07T17:31:55.790

我使用了这个 shell 命令：

`for f in *.jpg;do PYTHONPATH=/usr/local/lib/python2.7/site-packages python -c 'import cv2;import sys;rects=cv2.CascadeClassifier("/usr/local/opt/opencv/share/OpenCV/haarcascades/haarcascade_frontalface_default.xml").detectMultiScale(cv2.cvtColor(cv2.imread(sys.argv[1]),cv2.COLOR_BGR2GRAY),1.3,5);print("\n".join([" ".join([str(item) for item in row])for row in rects]))' $f|while read x y w h;do convert $f -gravity NorthWest -crop ${w}x$h+$x+$y ${f%jpg}-$x-$y.png;done;done`

您可以`opencv`使用.`imagemagick``brew install opencv imagemagick`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-06-29T20:09:10.147

我认为最好的选择是 Google Vision API。它已经更新，它使用机器学习，并且随着时间的推移而改进。

您可以查看文档以获取示例： [https ://cloud.google.com/vision/docs/other-features](https://cloud.google.com/vision/docs/other-features)

# google-app-engine - 在 Google AppEngine 上构建可靠的系统

> ID：13211747
> 
> 赞同：0
> 
> 时间：2012-11-03T17:39:29.567
> 
> 标签：google-app-engine

使用 Google AppEngine 的 Stack Overflow 社区，

鉴于 Google AppEngine 的可靠性问题，您如何处理故障转移以防止中断？您是在另一个平台上做备份镜像吗？

有没有办法让您的实例“热插拔”以避免出现问题？有人想出优雅的解决方案来避免服务问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T05:37:26.400

如果您使用 AppEngine，您的域将解析为 AppEngine 的 IP 地址。如果发生中断，您将不得不更改 DNS 记录，并且它需要几个小时才能通过 DNS 服务器传播。到那时，AppEngine 很可能已经恢复，现在您必须再次更改 DNS 记录 - 并为您的用户增加几个小时的混乱/停机时间。这意味着数据备份对于终止 Google 或法律突发事件很有用，但它们对于短暂的中断不是很有用。此外，通过数据备份，您总是会丢失一些数据，除非您实时连续地进行备份，这要么是不可能的，要么对您的系统造成很大负担，更不用说它可能会因较长的响应时间而降低用户体验。

除非您的应用程序已经每天赚取数百万美元的收入，否则构建一个可以非常快速（几分钟）切换到完全不同的平台而不会丢失任何数据的解决方案的成本高得令人望而却步。提示：在 AppEngine 中断期间，许多雇佣了许多才华横溢的工程师的知名服务出现了故障。

# api - 无法获得正确回复 Shopify API 身份验证

> ID：13211748
> 
> 赞同：2
> 
> 时间：2012-11-03T17:39:34.267
> 
> 标签：api, oauth, shopify

我想将 shopify 集成到我的软件中。它是一个桌面应用程序。我已经浏览了 shopify 的 API Docs。这些 API 将使用 API 密钥和密码正确地从我的沙盒帐户中调出数据。

然后我在 shopify 中遇到了“API 身份验证”。在阅读了这些文档后，我很困惑。step1(http://api.shopify.com/authentication.html) 之后的回复不正确。

我的问题是我真的需要身份验证才能获得 API 响应吗？如果不是，那么“API 身份验证”的目的是什么。

请帮帮我。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T16:48:44.540

从它的声音来看，您已经生成了一个私有应用程序来获取您的 api 密钥和密码，并通过基本身份验证（即在 url 中）传递这些凭据。这可以。

您找到的身份验证主题适用于安装到许多商店中的公共应用程序。他们处理生成身份验证令牌，该令牌与您已有的密码执行相同的工作。

总结一下：是的，您需要对 API 进行身份验证才能使用它，但您已经通过使用私有应用程序的密码来做到这一点。除非您正在构建将安装到许多商店中的公共应用程序，否则不要担心 OAuth。

# windows - 简单的任务，windows提示批处理文件

> ID：13211750
> 
> 赞同：1
> 
> 时间：2012-11-03T17:39:36.967
> 
> 标签：windows, batch-file, batch-processing, eps

我是一名 Windows 7 用户，想要将多个 *.eps 文件转换为 pdf 文件。因此我安装了一个名为 EPSPDF.rb 的程序。我将它集成到我的系统路径中，这使我可以在命令提示符下使用它，如下所示：

```
C:\TEMP>epspdf somefile.eps 
```

该程序将 somefile.eps 转换为 somefile.pdf。我现在想要实现的是编写一个 Windows 批处理文件，它将在目录 C:\TEMP 中查找所有 *.eps 文件并将它们全部转换。

由于我对编程语言非常陌生，因此我仍在努力。我想对于熟悉 Windows 中的批处理文件的人来说，写几行将是一个简单的问题。我将非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:44:06.650

```
for %%f in (*.eps) do epspfd %%f 
```

这用于批处理文件。您可以直接在命令提示符下运行它，只需要使用`%f`而不是`%%f`. 只是因为。;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:44:06.407

```
for %F in (*.eps) do epspdf %F 
```

# cocoa - 使用 MagicalRecord 在后台保存的设计策略

> ID：13211753
> 
> 赞同：0
> 
> 时间：2012-11-03T17:40:16.340
> 
> 标签：cocoa, core-data, concurrency, magicalrecord

最近我开始了一个只需要一个商店的新应用程序（没有基于文档的应用程序）。有一段时间我很高兴我终于可以摆脱 NSManagedObjectContext 的困扰......直到我想在后台保存:-(

现在我对自己的代码感到困惑。例如：

```
- (void)awakeFromInsert
{
    [super awakeFromInsert];
    [self resetCard];
    self.creationDate = TODAY;
    self.dictionary = [Dictionary activeDictionary];
    NSNotificationCenter *center = [NSNotificationCenter defaultCenter];
    [center postNotificationName:NOTE_NEWCARD object:self];    
} 
```

[Dictionary activeDictionary] 是一个 NSManagedObject 静态函数，返回指向在主线程中创建的 NSManagedObject 的指针。这将在后台保存期间导致交叉/上下文错误。因为我的程序总是从同一个存储读取，我想我可以避免这样写：

```
[Dictionary activeDictionaryWithContext:...] 
```

我想使用 MagicalRecord，只要我始终使用相同的后端工作，就可以避免传递上下文指针。我应该使用哪个函数来获取该上下文？

```
[NSManagedObjectContext MR_defaultContext]
[NSManagedObjectContext MR_context]
[NSManagedObjectContext MR_contextForCurrentThread] 
```

在示例中，对象在通知中发送自己，这几乎是为了引起更多冲突。

*   在通知的情况下，我是否应该始终只发送 objectID？

在我看来，我的对象只有在主上下文中运行时才应该发出副作用操作/通知。但是，其中一些辅助操作会更改我的对象图，从而创建其他实体的新实例。

*   如果我使用 [MagicalRecord MR_saveAll] 保存，我可以安全地省略我提到的两个有问题的函数调用吗？

*   我是否应该假设新的后台保存上下文的对象将是我的主线程中的对象的精确副本，而不调用那些额外的函数？

现在我遇到了问题，因为我从没想过 awakeFromInsert 会为同一个商店的同一个对象运行多次。我在想这样的事情：

```
- (void)awakeFromInsert
{
    [super awakeFromInsert];
    if ([self managedObjectContext] == [NSManagedObjectContext MR_defaultContext]) {
        [self resetCard];
        self.creationDate = TODAY;
        self.dictionary = [Dictionary activeDictionary];
        NSNotificationCenter *center = [NSNotificationCenter defaultCenter];
        [center postNotificationName:NOTE_NEWCARD object:self];    
    }
} 
```

这应该使我的 awakeFromInsert 代码只运行一次，而不是在后台保存上下文中。我担心这样做会丢失信息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:57:17.850

虽然您当然可以通过这种方式发送您的对象，但我建议您**不**要这样做。请记住，即使在 CoreData 中使用新的父子上下文，NSManagedObjects 也不是**线程**安全的。如果您创建或导入对象，则需要先保存它们，然后才能在另一个上下文中使用它们。

MagicalRecord 提供了一个相对简单的后台保存 API：

```
[MagicalRecord saveInBackgroundWithBlock:^(NSManagedObjectContext *localContext){
    MyEntity *newEntity = [MyEntity MR_createInContext:localContext];

    //perform other entity operations here
}]; 
```

此块为您完成所有工作，而无需担心正确设置 NSManagedObjectContext。

您不应该通过通知传递 NSManagedObjects 的另一个原因是您不知道将在哪个线程上接收通知。这可能会导致崩溃，因为同样，NSManagedObjects**不是**线程安全的。

您提供的通知方法的另一种替代方法是将观察者添加到**NSManagedObjectContextDidSaveNotification**，并合并您对该通知的更改。这只会在您的对象被保存后触发，并且通过父子关系或持久存储（旧方式）跨上下文是安全的。

# android - 将 45° 角设置为加速度计的 0° 角

> ID：13211755
> 
> 赞同：0
> 
> 时间：2012-11-03T17:40:22.920
> 
> 标签：android, accelerometer, sensors

大家好，我正在开发一个使用加速度计在 Y 轴上移动精灵的游戏。一切正常，但问题是精灵不移动的角度是0°，但这意味着当我想向上移动精灵时，我必须以一种不寻常的方式转动我的手......所以我想我可以将底角设置为 45°，这样所有的动作都更容易了。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:33:12.840

我不确定是否设置基本角度，但您可以从程序中加速度计的测量值中减去 45°，这将产生相同的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T19:30:59.667

只需定义基向量，并计算它与从加速度计接收的数据之间的差异。我会在启动时定义基本向量，或者在一段时间内平均以减少噪音（是的，移动设备中使用的加速度计质量非常低）

# macos - 如果显示“--INSERT--”，如何在 max os x 终端中继续编写命令？

> ID：13211756
> 
> 赞同：0
> 
> 时间：2012-11-03T17:40:24.140
> 
> 标签：macos, insert, command

如果显示“--INSERT--”，如何在 max os x 终端中继续编写命令？

截屏：

[![截屏](../Images/c33fcdc4064afab6cc1829efad2784bb.png)](https://i.stack.imgur.com/4n0bc.png)
[（来源：[shrani.si](http://shrani.si/f/1c/11h/1gtT8BMv/screen-shot-2012-11-03-a.png)）]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:42:01.267

你不在终端里——你在[Vim](http://www.vim.org/)里——一个文本编辑器。如果您不想继续编辑，请键入 ZZ 退出。或者查看链接以获取有关如何使用它的基本参考。

# c# - 访问传递给视图的对象

> ID：13211758
> 
> 赞同：0
> 
> 时间：2012-11-03T17:40:34.687
> 
> 标签：c#, asp.net-mvc, view

我将一个对象（一个列表）传递到一个像这样的视图中：

```
private readonly CarsContext _db = new CarsContext();

public ActionResult Index()
{
    ViewBag.Message = "Foobar";

    var result = from cars in _db.CarProfiles
                 where cars.CarOfTheWeek
                 select cars;

    return View(result.ToList());
} 
```

如何从我的索引视图中访问此对象？我在想我需要将它添加到我的动态视图包中，并以这种方式访问​​它而不是将其作为参数传递，这是正确的还是如果我保持控制器代码保持原样，我可以从视图中访问这个对象吗?

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:59:02.323

在您的 Index.cshtml 视图中，您的第一行将是：

```
@model YOUR_OBJECT_TYPE 
```

例如，如果您在行中传递一个字符串：

```
return View("hello world"); 
```

那么您在 Index.cshtml 中的第一行将是：

```
@model String 
```

在您的情况下，您在 Index.cshtml 中的第一行将是：

```
@model List<CarProfile> 
```

这样，如果您在 Index.cshtml 视图中键入 @Model，您就可以访问 CarProfile 列表的所有属性。@Model[0] 将返回您列表中的第一个 CarProfile。

只是一个提示，大多数时候不应该使用 ViewBag。相反，您应该创建一个 ViewModel 并将其返回到您的视图中。如果你想了解 ViewModels，这里有一个链接：http: [//msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvc3fundamentals_topic7.aspx](http://msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvc3fundamentals_topic7.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T18:13:02.177

从您的操作方法中，将您的视图强类型化为您要返回的类/类型。

在您的情况下，您将返回一个`CarProfile`类对象列表。因此，在您的视图（index.cshtml）中，将其作为第一行删除。

```
@model List<CarProfile> 
```

`CarProfile`现在您可以使用关键字访问列表。`Model`例如，您想显示列表中的所有项目，在一个循环中，您可以这样做

```
@model List<CarProfile>
@foreach(var item in CarProfile)
{
  <h2>@item.Name</h2>
} 
```

假设`Name`是`CarProfile`类的属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T18:13:37.167

您可以通过在 ViewBag 中传递对象来访问视图中的对象（您编写控制器的方式）。但我认为，通常最好有一个 ViewModel 并通过该 ViewModel 将数据传递给视图。将业务对象直接传递给模型（您所做的方式），使模型依赖于业务对象，在大多数情况下它不是最优的。同样拥有 ViewModel 而不是使用 ViewBag 具有使用 StrongTypes 的优势。

```
 private readonly CarsContext _db = new CarsContext();

    public ActionResult Index()
    {
        var result = from cars in _db.CarProfiles
                     where cars.CarOfTheWeek
                     select cars;

        MyViewModel myViewModel = new MyViewModel( );
        myViewModel.Message = "Foobar";
        myViewModel.ResultList = result.ToList();

        return View( myViewModel );
    } 
```

# java - 我尝试将厘米编程为英寸/英尺 - 英寸为厘米，米

> ID：13211762
> 
> 赞同：-2
> 
> 时间：2012-11-03T17:40:52.753
> 
> 标签：java

当我尝试编译它时，我得到一个错误“;” 排队

```
double cm1 (inch_to_cm*2.54); 
```

它必须在相同的窗口中：厘米到英寸/英尺英寸到厘米/米。

```
import java.util.Scanner;  

public class Centimer_Inch
{

public static void main (String[] args)
{
        // 2.54cm is 1 inch
       Scanner cm = new Scanner(System.in); //Get INPUT from pc-Keyboard
       System.out.println("Enter The Centimeters:"); // Write input
       double centimeters = cm.nextDouble(); // STAM מקבל את הסנטימטר
       double inches = Math.round( (centimeters / 2.54) * 100 ) / 100.0; // STAM לוקח את הסנטימטר ומחלק ב2.54
       System.out.println(inches +"Inches");

       double foot=Math.round( (inches/12) *100) / 100.0;
       System.out.print(foot +"Foots");

       // inch to cm
       Scanner inch1 = new Scanner(System.in);
       System.out.println("Enter The Inch");
       double inch_to_cm = inch1.nextDouble();

       double cm1 (inch_to_cm*2.54); //From INCH TO CM
       System.out.println(inch_to_cm);

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:42:11.957

你错过了等号：

```
double cm1 = (inch_to_cm * 2.54); //From INCH TO CM 
```

当您需要有关编译器错误消息的帮助时，请说明错误消息是什么（并在发布问题之前尝试理解它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:42:17.273

```
double cm1 (inch_to_cm*2.54); //From INCH TO CM 
```

应该：

```
double cm1 = (inch_to_cm*2.54); //From INCH TO CM 
```

您需要将计算结果分配给 cm1。`=`是java中的赋值运算符（我希望你知道这一点，因为你在其他地方也做过同样的事情）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T17:42:28.883

您没有将值分配给您的双变量。你错过了一个`=`标志，因此编译器错误

```
double cm1 (inch_to_cm*2.54); 
```

应该

```
double cm1 =(inch_to_cm*2.54); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-20T19:37:32.297

也在最后说

```
System.out.println(inch_to_cm); 
```

它应该是

```
System.out.println(cm1); 
```

转换回厘米。

# arrays - 在 MIPS 中查找数组的中点 - 合并排序

> ID：13211764
> 
> 赞同：2
> 
> 时间：2012-11-03T17:41:15.357
> 
> 标签：arrays, assembly, mips, mergesort

我正在尝试在 MIPS 中创建一个合并排序算法，并且在我的代码中发现了一个错误。在我的程序中，我保留了对数组起点和终点的引用（分别为`$a0`和`$a1`）。我也在跟踪它的长度`$a1 - $a0 + 4`。问题是我不知道如何正确计算数组的中点。我需要为 C 中的这些等效函数调用这样做：

```
mergesort(a, start, mid);
mergesort(a, mid + 1, end); 
```

我是 MIPS 的新手，所以我不确定你如何使用 4 位地址进行算术运算。我无法添加它们，`($a0 + $a1)/2`因为添加两个地址会导致溢出。

我的数组在顶部声明为：

```
array: .word 0:15 
```

我可以假设输入的数字不超过 15 个。`$s0`（指向数组开头的指针）、`$s1`（指向最后一个元素之后的空间的指针）、`$a0`（起点参数）和`$a1`（终点参数）都存储如下：

```
la $s0, array
move $s1, $s0 // $s1 increments by 4 each time an element is added
...
move $a0, $s0
addi $a1, $s1, -4 // subtract four because we want to refer to the last element 
```

给定 $a0 和 $a1 作为参考，我如何计算该数组的中间索引？任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T02:20:36.373

`($a0 + $a1) / 2 = $a0 + ($a1 - $a0) / 2`你不会有任何溢出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T15:26:00.390

您无需担心中间溢出。只需使用无符号加法（无溢出），然后右移一位以除以二：

```
 addu $a2, $a0, $a1  # $a0 and $a1 hold start and end addresses
  srl $a2, $a2, 1     # $a2 holds mid address 
```

# flash - 在 Flash Builder 中将数组分配给alternatingItemColors

> ID：13211769
> 
> 赞同：2
> 
> 时间：2012-11-03T17:41:48.837
> 
> 标签：flash, apache-flex, flash-builder

我有一个关于列表中的 alterItemColors 的问题。我想将一个数组分配给alternatingItemColors，但因为我的数组存在于组件上方的脚本中。flex 编译器说不能访问属性颜色代码如下：

```
<fx:Script>
        <![CDATA[
    [Bindable]
         public var colors:ArrayCollection=new ArrayCollection();
colors=[#FFFF00,#fd8301];
    ]]>
    </fx:Script>
<s:List id="workList" width="100%" height="40%"  alternatingItemColors="colors"/> 
```

有人可以建议出什么问题以及如何将数组分配给alternatingItemColors

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:11:59.430

使用数组（不是 ArrayCollection）

```
public var colors:Array = [#FFFF00,#fd8301]; 
```

您的绑定标签也缺少颜色

```
<s:List id="workList" width="100%" height="40%"  alternatingItemColors="{colors}"/> 
```

# java - DataInputStream 上的字节顺序

> ID：13211770
> 
> 赞同：5
> 
> 时间：2012-11-03T17:41:58.197
> 
> 标签：java, io, endianness

我有一个要加载的文件格式，其中包含 OpenGL 对象的原始数据。

一切都会好起来的，但是数据是小端编码的。

是否有一个 java 类可以完成 DataInputStream 的确切工作但使用小端序，还是我必须逐字节加载它并自己执行转换？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-03T17:43:23.490

DataInputStream 只是大端。

如果你使用 ByteBuffer 你可以改变字节顺序

```
buffer.order(ByteOrder.LITTLE_ENDIAN); 
```

# visual-studio-2010 - 我可以在同一台机器上安装 VS 2010 和 VS 2010 Express

> ID：13211773
> 
> 赞同：0
> 
> 时间：2012-11-03T17:42:12.087
> 
> 标签：visual-studio-2010

是否可以在同一台机器上安装和使用 VS2010 和 VS 2010 Express。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:08:19.010

是的，我的系统上安装了 VS2010 Professional 和 VS2010 Exp。并且两者都正常运行。

# c# - 我想在组合框中显示包含我搜索的文本的项目

> ID：13211776
> 
> 赞同：2
> 
> 时间：2012-11-03T17:42:22.320
> 
> 标签：c#, wpf, data-binding, combobox

我得到了包含名称的组合框。我的目标是使用文本框搜索字符串，然后以该字符串开头的名称将显示在组合框中。

**例如：**

我的组合框包含下一项：

> “马克”、“阿里克”、“迈克尔”

当用户`Mi`在文本框中写“”时，组合框将只显示“ `Michael`”。

PS没有按钮。只有文本框和组合框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:52:17.233

好吧，如果您使用绑定来填充组合框，您应该只创建文本属性并将其绑定到文本框（双向模式绑定）。

在此属性的设置器中，您只需更改早期设置过滤视图的过滤条件。

[http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewsource.getdefaultview.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewsource.getdefaultview.aspx)

在某些情况下，您可能希望过滤集合而不是其视图。但决定权的是你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T18:23:20.263

我准备了你的例子。

在我的示例中，我使用了两个附加程序集：

1.  Microsoft.Practices.Prism
2.  System.Windows.Interactivity

XAML 文件：

```
<Window x:Class="ComboBoxFilter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525"
        xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
        >
    <Grid>
        <StackPanel>
            <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="TextChanged">
                        <i:InvokeCommandAction Command="{Binding SearchItems}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </TextBox>
            <ComboBox ItemsSource="{Binding MySourceData}" />
        </StackPanel>
    </Grid>
</Window> 
```

视图模型类：

```
class MainViewModel : NotificationObject
    {
        public MainViewModel()
        {
            _myItems.Add("aaa");
            _myItems.Add("abb");
            _myItems.Add("aab");
            _myItems.Add("bbb");
            _myItems.Add("bcc");
            _myItems.Add("bbc");

            SearchItems = new DelegateCommand(this.OnSearchItems);
        }

        private string _searchText;
        public string SearchText
        {
            get { return _searchText; }
            set { _searchText = value; RaisePropertyChanged(() => SearchText); }
        }

        private ICollectionView _mySourceData;
        public ICollectionView MySourceData
        {
            get { return CollectionViewSource.GetDefaultView(_myItems); }           
        }

        private List<string> _myItems = new List<string>();

        public ICommand SearchItems { get; private set; }
        private void OnSearchItems()
        {            
            MySourceData.Filter = (o) => { return string.IsNullOrEmpty(SearchText) ? true : (o as string).StartsWith(SearchText); };          
        }
    } 
```

不要忘记在 ctor 中设置窗口 DataContext：

```
 public MainWindow()
    {
        InitializeComponent();
        this.DataContext = new MainViewModel();
    } 
```

[这](http://sdrv.ms/PvYoLh)是带有附加程序集的所有解决方案（ComboBoxFilter.zip）。

# asp.net - 有时我在 js 中遇到未指定的错误

> ID：13211777
> 
> 赞同：0
> 
> 时间：2012-11-03T17:42:22.813
> 
> 标签：asp.net, vb.net, ajaxcontroltoolkit

在框架 2.0 中使用 MaskedEdit.application 构建时，有时我们会在 IE 中收到“未指定错误”（javascript 错误）

如果我启用 debuggin javascript 设置，那么我会发现此错误，否则页面的特定部分不会显示。

如果我们调试，我们可以看到它发生在下面的行

```
//only for ie , for firefox see keydown
            if (document.activeElement)
            {
                if (e.id == document.activeElement.id)
                {
                    hasInitialFocus = true;
                }
            } 
```

当我试图搜索这段代码的编写位置时，我在 ajaxcontroltool.dll 文件中找到了这段代码。

而且这个 dll 是第三方的，我无法更改这个 dll，所以我应该怎么做才能解决这个问题。

我在 IE8 中尝试过，但在 IE8 中没有收到错误，这意味着代码在 IE8 中运行顺利/无错误。

我在 IE9 中收到此错误，因为出现率是 6 次打开页面。

如果有人知道，请帮我解决这个问题，这让我很头疼。

它看起来像浏览器问题或 dll 问题。

有没有其他人注意到这一点？

谢谢并恭祝安康

肖伊布

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T22:03:10.677

> 这个 dll 是第三方的，我无法在这个 dll 中更改，所以我应该怎么做才能解决这个问题

实际上你可以，因为 AjaxControlToolkit 是一个开源项目。您可以从 CodePlex 下载项目源代码：http: [//ajaxcontroltoolkit.codeplex.com/](http://ajaxcontroltoolkit.codeplex.com/)并根据您的需要对其进行自定义

# wordpress - Social PopUp Wordpress 插件仅适用于 IE

> ID：13211780
> 
> 赞同：0
> 
> 时间：2012-11-03T17:42:37.750
> 
> 标签：wordpress, popup, facebook-social-plugins, social

我在我的 Wordpress 网站上安装了社交弹出插件，但它只在 IE 中显示。我不明白有什么问题。你能帮助我吗？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:00:17.363

它在 Mac 上的 Chrome、Safari 和 Firefox 上对我来说很好。

# javascript - Node.js 初学者 - 没有查询字符串的请求

> ID：13211783
> 
> 赞同：1
> 
> 时间：2012-11-03T17:43:00.973
> 
> 标签：javascript, mysql, node.js, query-string

我是 node.js 的新手。我正在处理的一个项目需要将一个大数组（625 个项目）作为字符串存储在 MySQL 数据库中，我正在使用[Node MySQL](http://github.com/felixge/node-mysql)来完成此操作。

现在我有它，以便在向“/（列名）？（值）”发出请求时更新该行。不幸的是，很快就知道将 625 个项目作为字符串传递给节点并不是最有效的做事方式。

除了查询字符串之外，您对将大数组作为字符串传递的替代方法有什么建议吗？

```
var http = require('http'),
   mysql = require("mysql"),
   url = require("url"),
   express = require("express");

var connection = mysql.createConnection({
   user: "root",
   database: "ballot"

});  

var app = express();
app.use(express.bodyParser());

app.options('/', function (request, response)
{
    response.header("Access-Control-Allow-Origin", "*");
    response.end();
});

app.get('/', function (request, response)
{
    connection.query("SELECT * FROM pathfind;", function (error, rows, fields) {
        for(i=0;i<rows.length;i++)
        {
            response.send('<div id="layers">'+rows[i].layers+'</div> \
                            <div         id="speed">'+rows[i].speed+'</div> \
                            <div     id="direction">'+rows[i].direction+'</div>');
        }
        response.end();
    });
});

app.post('/', function (request, response)
{   
    console.log(request.param('data', null));
    var urlData = url.parse(request.url, true);
    if(urlData.pathname = '/layers')
    {
        col = "layers";
    }
    else if(urlData.pathname = '/speed')
    {
        col = "speed";
    }
else if(urlData.pathname = '/direction')
    {
        col = "direction";
    }
    req.addListener("data", function(data) {
        connection.query("UPDATE pathfind SET "+col+"="+data+" WHERE num=0",     function (error, rows, fields) {
            if (error)
            {
                app.close();
            }
        }); 
    });
});

app.listen(8080);** 
```

编辑：所以现在我知道我需要使用帖子。我已经使用 express.js 重写了上面的代码。我在网上看到的大多数示例都使用带有 HTML 表单的帖子，这很好，但我的项目需要通过 AJAX 请求发布数据。有人可以告诉我如何在 node.js 中解析这些数据吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T03:44:57.827

您可以像这样提取帖子数据。

```
if (req.method == 'POST') {
    var body = '';
    req.on('data', function (chunk) {
        body += chunk;
    });
    req.on('end', function () {
        var postData = body.toString();
        console.log(postData);
    });
} 
```

# java - 如何排除模式匹配中的字符？

> ID：13211785
> 
> 赞同：0
> 
> 时间：2012-11-03T17:43:07.537
> 
> 标签：java, regex

在示例 string`"a f e $s $a"`中，我想匹配所有没有前置“$”字符的字符。

我尝试使用负面的前瞻性：

```
"(?!\\$)[a-z]" 
```

但它也匹配`$s`and `$a`。我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:44:51.440

使用否定的lookbehind，即`(?<!\\$)`

```
"(?<!\\$)[a-z]" 
```

您使用的是负前瞻，即`(?!\\$)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:45:08.287

这是一个*前瞻*断言，这意味着它将匹配任何不是美元符号的字母，也就是说，所有这些:)

你需要回顾一下：

```
"(?<!\\$)[a-z]" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T17:50:01.843

负后瞻的正确语法是`(?<!...)`, not `(?!...)`，因为那是负前瞻。

使用模式

```
(?<!\\$)[a-z] 
```

# qt - QThread 中的 Qt 信号和槽

> ID：13211786
> 
> 赞同：2
> 
> 时间：2012-11-03T17:43:18.623
> 
> 标签：qt, post, upload, qthread

我目前在 Qt 线程上遇到问题。

我必须在 QThread 中上传文件列表，但显然一个上传不起作用和/或我的插槽从未被调用。如果我把这些方法放在线程之外，它就可以完美地工作。

这是 run() 方法：

```
void UploadThread::run()
{
    for (int i = 0; i < Window::_listUpload.size(); i++) {
        qDebug() << Window::_listUpload[i].getPath();
        this->sendFile(Window::_listUpload[i].getPath());
    }
} 
```

这是 sendFile() 方法：

```
void UploadThread::sendFile(const QString & path)
{
    QFreeDesktopMime mime;
    QNetworkAccessManager *manager = new QNetworkAccessManager;
    QFileInfo fInfo(path);
    QNetworkRequest request(QUrl("http://my-url/"));
    QNetworkReply *reply;

    QString bound = "---------------------------723690991551375881941828858";
    QByteArray data(QString("--"+bound+"\r\n").toAscii());
    data += "Content-Disposition: form-data; name=\"action\"\r\n\r\n";
    data += "\r\n";
    data += QString("--" + bound + "\r\n").toAscii();
    data += "Content-Disposition: form-data; name=\"file\"; filename=\""+fInfo.fileName()+"\"\r\n";
    data += "Content-Type: "+mime.fromFile(path)+"\r\n\r\n";

    QFile file(fInfo.absoluteFilePath());
    file.open(QIODevice::ReadOnly);
    data += file.readAll();
    data += "\r\n";
    data += QString("--" + bound + "\r\n").toAscii();
    data += QString("--" + bound + "\r\n").toAscii();
    data += "Content-Disposition: form-data; name=\"desc\"\r\n\r\n";
    data += "Description for my image here :)\r\n";
    data += "\r\n";
    request.setRawHeader(QString("Accept-Encoding").toAscii(), QString("gzip,deflate").toAscii());
    request.setRawHeader(QString("Content-Type").toAscii(),QString("multipart/form-data; boundary=" + bound).toAscii());
    request.setRawHeader(QString("Content-Length").toAscii(), QString::number(data.length()).toAscii());

    reply = manager->post(request, data);

    QObject::connect(reply, SIGNAL(uploadProgress(qint64,qint64)), currentThread(), SLOT(receiveUploadProgress(qint64, qint64)));
    QObject::connect(manager, SIGNAL(finished(QNetworkReply*)), currentThread(), SLOT(uploadFinished(QNetworkReply*)));
} 
```

这是我的插槽：

```
void UploadThread::uploadFinished(QNetworkReply *reply)
{
    _isFinished = true;
}

void UploadThread::receiveUploadProgress(qint64 bytesSent, qint64 bytesTotal)
{
    qDebug() << bytesSent << " " << bytesTotal;
} 
```

您在我的代码中看到问题了吗？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T01:19:41.470

好的我明白了。

对于每次上传，我需要使用 exec() 启动 QEventLoop，并且在上传结束时我必须使用 exit() 来完成 QEventLoop。它现在就像一个魅力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T19:07:25.977

你似乎在调用[`QObject::connect()`](http://doc.qt.nokia.com/4.7/qobject.html#connect)你的`sendFile()`方法。

`QObject::connect()`用槽方法连接信号。可以使用类似的东西触发信号`emit signalName()`。

在您的示例中，您的 UploadThread 标头应如下所示：

```
class UploadThread: public QThread {
    ...
signals:
    void uploadProgress(int sent, int total);
    void uploadFinished(QNetworkReply *reply);
} 
```

不要实现信号，它们是由 Qt 自动实现的。

在 sendFile() 中，只需调用它们：

```
...
emit uploadProgress(sent, total);
... 
```

在您的主线程（=gui 线程）中，您应该有一个类，该类具有处理信号的插槽（您当前的 uploadFinished() 和 recieveUploadProgress() 方法）。如果您想更新 GUI，重要的是它们在 GUI 线程中执行。

最后，您必须连接它们（连接并不意味着调用它们）并开始上传。

```
UploadThread *uploadThread = new UploadThread();
connect(uploadThread, SIGNAL(uploadProgress(...)), objectInGuiThread, SLOT(actualUploadProgressSlot(...)));

uploadThread.start() 
```

查看 Qt 的[Signal & Slot](http://doc.qt.nokia.com/qt/signalsandslots.html)文档，了解有关如何使用它们的更多信息。

# vhdl - 如果 vhdl 出乎意料

> ID：13211789
> 
> 赞同：2
> 
> 时间：2012-11-03T17:43:25.957
> 
> 标签：vhdl

这个错误困扰了我很久，我不知道该怎么办。我在其他代码中也遇到了同样的错误，但这个错误很简单，所以也许更容易找出问题所在。

这是一个频率选择器，如果开关（clau）打开，频率就会改变。

```
library IEEE;
use IEEE.numeric_bit.ALL; 

-- Uncomment the following library declaration if using
-- arithmetic functions with Signed or Unsigned values
--use IEEE.NUMERIC_STD.ALL;

-- Uncomment the following library declaration if instantiating
-- any Xilinx primitives in this code.
--library UNISIM;
--use UNISIM.VComponents.all;

entity selector_frequencia is
Port ( unHz : in bit ;
       centHz : in bit ;
       Clock : out bit;
          clau: in bit);
end selector_frequencia;

architecture Behavioral of selector_frequencia is

begin
if (clau = "0") then Clock <= unHz;
else Clock <= centHz;
end if;

end Behavioral; 
```

我得到的错误是这个：

ERROR:HDLParsers:164 - "C:/Documents and Settings/Administrador/Escritorio/practica_digital/practica_digital/selector_frequencia.vhdl" 第 23 行。解析错误，意外 IF

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T17:53:28.690

我并不是真正的 VHDL 专家，但我相信您应该`if`在进程中使用以下语句：

```
architecture Behavioral of selector_frequencia is

begin

fqsel:PROCESS(unHz , centHz , Clock , clau)
BEGIN

  if (clau = '0') then
      Clock <= unHz;
  else
      Clock <= centHz;
  end if;

END PROCESS fqsel;

end Behavioral; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T19:24:02.483

正如亚历克斯指出的那样，您的 if 语句需要在进程块内。此外，VHDL 不是 C ......你不应该把 parens () 放在条件周围，或者它看起来像一个过程/函数调用或一个信号范围，即：my_bus(7 downto 0) 但这是一个语法错误，因为如果是保留字。尝试：

```
process (clau, unHz, centHz)
begin
  if clau = '0' then 
    Clock <= unHz;
  else 
    Clock <= centHz;
  end if;
end process; 
```

最后，在流程之外，您可以只使用条件信号分配，这是实现等效流程和 if 语句的简写方式：

```
Clock <= unHz when clau='0' else centHz; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T18:50:42.437

您在 IF 子句中使用了赋值语句：

```
// This is assignment, you are assigning 'clau' to 0 and then checking it in 'if'
if (clau = "0") then Clock <= unHz;

// Try this, note the double '='
if (clau == "0") then Clock <= unHz; 
```

赋值语句应该在一个 PROCESS 块中。

希望这可以帮助。

# php - .box-collat oral 下的子 html 的依赖项是什么 - Magento

> ID：13211795
> 
> 赞同：0
> 
> 时间：2012-11-03T17:43:59.907
> 
> 标签：php, xml, magento

我试图了解目录/product.view.phtml 的依赖关系。很多似乎取决于以下代码：

```
 <?php foreach ($this->getChildGroup('detailed_info', 'getChildHtml') as $alias =>$html):?>
<div class="box-collateral < ?php echo "box-{$alias}"?>
<?php echo $html;?>
</div>
<?php endforeach;?> 
```

使用此代码，我可以使用以下代码拉入产品选项、可用性和立即购买按钮：

```
 <?php if ($_product->isSaleable() && $this->hasOptions()):?>
 <?php echo $this->getChildChildHtml('container2', '', true, true) ?>
    <?php endif;?>
 <?php echo $_helper->productAttribute($_product, $_product->getDescription(), 'description') ?> 
```

困难在于我希望它们出现在 .box-collat​​eral 中包含的描述之后

这似乎带来了一个问题，因为当我将后一个片段移到第一个片段上方时，“立即购买”按钮仍然出现，但选项不会 - （当我简单地删除第一个片段时会发生同样的事情） - 引导我认为这些取决于由此拉取的一些数据？

我可以使用在底部添加描述

```
 <?php echo $_helper->productAttribute($_product, $_product->getDescription(), 'description') ?> 
```

但是除了 hacky css，我仍然找不到阻止上面出现的描述的方法。

任何指针，方向或简洁的解释表示赞赏。

（我发现[了这个类似的问题](https://stackoverflow.com/questions/10026711/whats-those-line-meaning-in-magento)，但答案指向的文件只会导致更多 child_html 我不知道其来源）

谢谢

# animation - 3D引擎碰撞检测模型导入

> ID：13211804
> 
> 赞同：1
> 
> 时间：2012-11-03T17:45:03.797
> 
> 标签：animation, 3d, collision-detection

我即将找到一个能够导入 3d 模型、检测它们的碰撞和支持关节的 3d 引擎。它是交互式动画所必需的，并且没有指定平台。我更喜欢编写 Javascript 或 AS3 代码，但我认为也可以使用 Java 来处理这个问题。

Away3d 支持这个吗？他们是我可以另外使用的普通 3D 碰撞检测框架吗？哪个是最简单的 Java 框架，哪个创造了最好的质量？

顺便说一句：专有框架也可能是一种可能性，但我只是没有。

问候菲利普

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T08:13:28.243

Away3D 有 Awayphysics 库，它是 C++ 引擎的炼金术端口，表现出非常好的性能。Away3D 有干净可读的源代码和文档 + 很好的示例项目集。它有 3ds​​ max 插件，可以导出场景并生成代码来渲染它。支持流行的格式，如 3ds、obj... 并且您可以为自己的格式编写导入器插件。所以开发人员都是很酷的人，他们在论坛上回答问题:)

对于 JavaScript 来说，最流行的引擎是 three.js[看看](http://mrdoob.github.com/three.js/)它能做什么。

总体思路：此时 WebGL 支持并不好（有时它不仅取决于用户浏览器，还取决于驱动程序），您将需要处理跨浏览器的头痛问题。IOS 不支持 Flash，并且越来越多地被设备浏览器踢出。但是有用于独立应用程序的跨平台 adobe air。在我看来，Javascript 不适合编写此类项目，并且它的调试可能会导致永久性脑损伤。WebGL 着色器语言是 GLSL，它有很好的类似 C 的语法。普通 Flash 着色器是用汇编程序编写的，但您可以尝试[pixelbender3d](http://labs.adobe.com/technologies/pixelbender3d/). 目前 Flash 着色器比 WebGL 更受限制（例如，您无法在顶点着色器中获取纹理），但这样做是为了使 Flash 更兼容，并且在大多数情况下这不是问题。WebGL 与页面紧密集成。如果您想要 java WebGL 并且喜欢痛苦，请尝试 GWT 3D 引擎或 gwt-elemental，并且早期 有[tree-js端口。](https://github.com/vatula/gwt.threejs)[x3dom](http://www.x3dom.org/)是声明性的 WebGL 3D 引擎，它回退到 Flash，它是 ez，但非常有限且不稳定。

# java - Java CRTP 和通配符：代码在 Eclipse 中编译，但不是 `javac`

> ID：13211806
> 
> 赞同：5
> 
> 时间：2012-11-03T17:45:05.653
> 
> 标签：java, eclipse, generics, javac

抱歉标题含糊。我有这段代码可以在 Eclipse Juno (4.2) 上编译，但不能在 javac (1.7.0_09) 上编译：

```
package test;

public final class Test {
    public static class N<T extends N<T>> {}

    public static class R<T extends N<T>> {
        public T o;
    }

    public <T extends N<T>> void p(final T n) {}

    public void v(final R<?> r) {
        p(r.o);       // <-- javac fails on this line
    }
} 
```

错误是：

```
Test.java:13：错误：Test 类中的方法 p 不能应用于给定类型；
        p(ro)；
        ^
  要求：T
  找到：N<CAP#1>
  原因：推断类型不符合声明的边界
    推断：N<CAP#1>
    界限：N<N<CAP#1>>
  其中 T 是一个类型变量：
    T 扩展了在方法 <T>p(T) 中声明的 N<T>
  其中 CAP#1 是一个新的类型变量：
    CAP#1 扩展了 N<CAP#1> 从捕获的 ?
1 个错误

```

所以问题是：

1.  这是一个`javac`错误还是 Eclipse 错误？

2.  有什么方法可以在`javac`不更改`v`方法签名的情况下进行编译（即保留通配符）？

    我知道将其更改为`<T extends N<T>> void v(final R<T> r)`确实可以编译，但我想知道是否有办法首先避免这种情况。此外，该方法`p`无法更改为，`<T extends N<?>> void p(final T n)`因为内容具有需要精确约束的类型`T extends N<T>`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T23:42:45.923

通配符的局限性在于它们会破坏`T extends X<T>`类型参数所允许的递归表达式。基于以下几点，我们知道您尝试做的事情是安全的：

1.  `r.o`是类型`T`（由 声明`R`），即是或扩展`N<T>`。
2.  该方法`p`接受一个类型的参数`T`（由 声明`p`），它也是或 extends `N<T>`。
3.  因此，即使`r`键入为`R<?>`，理论上调用`p(r.o)`也应该是合法的。

[这可能是 eclipse 编译器的原因（已知可以正确考虑javac 没有](https://stackoverflow.com/a/2858800/697449)的泛型的某些细微差别）。

假设你想用 javac 编译并且不能`v`像你提到的那样改变签名，你能做的最好的就是使用原始类型，它“选择退出”泛型类型检查：

```
public void v(final R<?> r) {
    //necessary to placate javac - this is okay because [insert above reasoning]
    @SuppressWarnings("rawtypes")
    N nRaw = r.o;
    p(nRaw);
} 
```

# python - Python 按字母出现拆分

> ID：13211808
> 
> 赞同：-3
> 
> 时间：2012-11-03T17:45:30.863
> 
> 标签：python, string, split

> **可能重复：**
> [计数字母并显示在列表中](https://stackoverflow.com/questions/13211533/count-letter-and-show-in-list)

我是 python 新手。我想通过将字符串拆分为字符串中字母的唯一出现次数来创建一个列表。举个例子：google会被拆分成g oo g l e

什么是最好的方法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:48:21.963

How about this:

```
>>> from itertools import groupby
>>> strs="google"
>>> " ".join("".join(g) for k,g in groupby(strs))
'g oo g l e' 
```

# ruby-on-rails - 测试字符串是否可以小写？

> ID：13211809
> 
> 赞同：0
> 
> 时间：2012-11-03T17:45:34.387
> 
> 标签：ruby-on-rails, activerecord

我有一个功能模型，我在其中添加了一个 before_save：

```
before_save {|feature|
    downcase_value(feature)
}

def downcase_value(record)
    record.value.downcase!
end 
```

这很好用，除非我在列中保存了一个日期，在这种情况下我得到一个错误：

```
undefined method `downcase!' for Tue, 06 Feb 1996:Date 
```

所以我的问题是 - 我如何测试该值是否可以最有效地缩小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:53:34.697

您可以将 downcase_value 方法体替换为：

```
record.value.downcase! if record.value.respond_to? :downcase! 
```

但是如果你想保存任何值，只需这样修改你的代码：

```
record.value.to_s.downcase! 
```

# ruby-on-rails-3 - 关于布尔值的 Rails 3 和 SQLite 通信

> ID：13211811
> 
> 赞同：1
> 
> 时间：2012-11-03T17:45:44.513
> 
> 标签：ruby-on-rails-3, sqlite, boolean, windows-7-x64

我正在使用 Rails 3.2.8 和 SQLite 1.3.6

我在更改数据库中的布尔变量时遇到了麻烦

SQLite 将“t”和“f”翻译为真假

此函数不会更新`:approved`属性（默认为 false）

```
def activate
  @user = User.find(params[:id])

  if @user.update_attribute(:approved, 't')

    redirect_to "/" #this is the return i get so the update returns true

  else
   render "/users?approved=false"
  end 
end 
```

但是更改字符串之类`@user.update_attribute(:email,'root@email.org')`的会更新电子邮件

我该如何解决这个问题我需要某种 sqlite 适配器吗？

我已经安装了`activerecord-jdbcsqlite3-adapter`，它弄乱了我的应用程序，因为我太仓促了，没有注意到它已被弃用：P

我发现了这个线程：[Rails 3 SQLite3 Boolean false](https://stackoverflow.com/questions/6013121/rails-3-sqlite3-boolean-false) ，但我不明白我需要做什么才能使 Rails 和 SQLite 正确通信，因为我是 Rails 中的新手 :)

我还认为值得一提的是，我在 Windows 7 x64 上运行它

**更新**

显然 Rails 确实知道如何与 Sqlite 通信，但我不知道为什么我的代码对布尔值无效，哈哈

在我看来，我有：

```
<% @users.each do |user| %> 
<tr> 
  <td><%= user.id %></td> 
  <td><%= user.email %></td>
  <td><%= user.approved? %></td>
  <td>
<% if !user.approved? %>
  <%= link_to 'Approve', active_user_path(user), :method => :put %> 
    <% end %> </td> 
</tr> 
<% end %> 
```

这列出了所有未经批准的用户和激活它们的链接（将 bool 设置为 true）

在我的控制器中我有

```
 def activate
      @user = User.find(params[:id])

    if @user.update_attribute(:approved, true)

      redirect_to "/" #this is the return i get so the update returns true

    else
      render "/users?approved=false" #this is not rendered
    end 
  end 
```

和我的路线

```
match "users/:id/activate" => "users#activate", :as => "active_user" 
```

这适用于其他字符串，如用户名、地址等，但不适用于布尔值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T20:41:59.130

如果`approved`@user 上的列是布尔值，您应该只传递 true/false 并让数据库适配器弄清楚。

```
@user.update_attribute(:approved, true) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T12:14:14.550

我通过使用整数迁移到我的用户表解决了这个问题，我不知道为什么`@user.update_attribute(:approved, true)`不保存到数据库，它一定与我的设置有关

我进行了迁移`add_column :users, :is_approved, :integer, :default => 0`，当我想激活用户时，我只需将整数值翻转为 1

# c# - 在 ADO.NET 中，在 SQL 查询中可以使用 SQL 参数是否有限制？

> ID：13211812
> 
> 赞同：2
> 
> 时间：2012-11-03T17:46:04.040
> 
> 标签：c#, sql, ado.net, oledb, sql-injection

这个问题仅用于教育目的，因为我目前没有构建任何使用用户输入构建 SQL 查询的应用程序。

也就是说，我知道在 ADO.NET 中，您可以通过执行以下操作来防止 SQL 注入：

```
OleDbCommand command = new OleDbCommand("SELECT * FROM Table WHERE Account = @2", connection);
command.Parameters.AddWithValue("@2", "ABC"); 
```

但是假设你的应用程序的设计方式是用户可以实际输入表的名称，你能做到以下几点吗？（我不在乎允许用户提供表的名称是否是一个坏主意，我只想知道以下是否可能......）

```
OleDbCommand command = new OleDbCommand("SELECT * FROM @1 WHERE Account = @2", connection);
command.Parameters.AddWithValue("@1", "Table");
command.Parameters.AddWithValue("@2", "ABC"); 
```

当我运行第二个代码时，我不断收到异常，说 SQL 查询不完整，我想知道问题是我试图做的事情根本无法完成，或者我是否忽略了某些东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T17:52:45.493

不，查询参数可以替换 SQL 语句中的**一个标量值**。
例如，单个字符串文字、日期文字或数字文字。

它不必在 WHERE 子句中。在 SQL 中任何可以有表达式的地方，都可以包含一个标量值，因此也可以包含一个参数。例如，在连接条件中，或在选择列表中，或在 ORDER BY 或 GROUP BY 子句中。

您*不能*将查询参数用于：

*   表标识符
*   列标识符
*   SQL 关键字
*   SQL 表达式
*   值列表（例如在 IN() 谓词中）

如果您需要使查询的任何这些部分可由用户定义，则需要通过将应用程序变量插入或连接到字符串中来构建 SQL 查询字符串。这使得防御 SQL 注入变得困难。

在这种情况下，最好的防御措施是将可以安全插入 SQL 字符串的特定值*列入白名单，例如您在代码中定义的一组表名。*让用户从这些预先批准的值中选择一个表，但不要在您随后执行的 SQL 代码中逐字使用他们的输入。

**用户输入可以提供值，但绝不应该提供代码。**

您可能会发现我的演示文稿[SQL 注入神话和谬误](http://www.slideshare.net/billkarwin/sql-injection-myths-and-fallacies)很有帮助。我在该演示文稿中介绍了白名单（我的示例使用 PHP，但这个想法适用于任何编程语言）。

# c++ - 将矩阵作为函数指针传递

> ID：13211815
> 
> 赞同：1
> 
> 时间：2012-11-03T17:46:51.370
> 
> 标签：c++, function, pointers, matrix

在我的项目中，我有这些文件：

```
functions.h
functions.cc
main.cc 
```

我试图以这种方式将 Matrix 作为指针传递给函数：

**主文件**

```
// Size -> const short Size = 10;
int mtr1[Size][Size];
matrix_insert((int *)mtr1); 
```

**函数.h**

```
void matrix_insert(int *mtr); 
```

**函数.cc**

```
void matrix_insert(int *mtr) {
  short i, j;

  for (i = 0; i < Size; i++) {
    for (j = 0; j < Size; j++) {
      std::cin >> *(mtr + i * Size + j);
    }
  }
} 
```

这实际上有效，但我不喜欢这种方式......
有更好的方法吗？

谢谢！

编辑：可以用向量模拟矩阵吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:54:37.847

如果你真的想使用 C 数组，那么你可以这样做：

**主文件**

```
int mtr1[Size][Size];
matrix_insert(mtr1); 
```

**函数.h**

```
const short Size = 10;
void matrix_insert(int mtr[Size][Size]); 
```

**函数.cc**

```
void matrix_insert(int mtr[Size][Size]) {
  short i, j;

  for (i = 0; i < Size; i++) {
    for (j = 0; j < Size; j++) {
      std::cin >> mtr[i][j];
    }
  }
} 
```

工作版本：http: [//ideone.com/1ik7T9](http://ideone.com/1ik7T9)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:59:05.753

创建一个像这样的矩阵类：

[http://www.parashift.com/c++-faq/matrix-subscript-op.html](http://www.parashift.com/c++-faq/matrix-subscript-op.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T18:02:16.890

您可以使用模板执行此操作：

```
template<int Size>
void matrix_insert(int (&mtr)[Size][Size])
{
    short i, j;

    for (i = 0; i < Size; i++)
    {
        for (j = 0; j < Size; j++)
        {
            std::cin >> mtr[i][j];
        }
    }
} 
```

# javascript - 使用 javascript 根据选择列表中的选项显示 div

> ID：13211816
> 
> 赞同：-1
> 
> 时间：2012-11-03T17:46:55.450
> 
> 标签：javascript, html

我有选择列表，我想在下拉列表中显示缩写选项，但在下面显示全文。我正在尝试修改我以前用来在选择“其他”作为选项时显示文本输入的 javascript。select、div 和 javascript 是在 php 中动态生成的。我已将 php 生成的代码剪切并粘贴到一个普通的 html 文件中，以确保问题确实是这段代码。

我有以下脚本：

```
 <script type="text/javascript">  
                function showreason() { if (document.getElementById('showreason').value == 'BLANK') { 
document.getElementById('showreasonBLANK').style.display = 'block' ;
} else {
        document.getElementById('showreasonBLANK').style.display = 'none';
    } if (document.getElementById('showreason').value == 'RECAP') { 
document.getElementById('showreasonRECAP').style.display = 'block' ;
} else {
        document.getElementById('showreasonRECAP').style.display = 'none';
    } if (document.getElementById('showreason').value == 'RETIRE') { 
document.getElementById('showreasonRETIRE').style.display = 'block' ;
} else {
        document.getElementById('showreasonRETIRE').style.display = 'none';
    } if (document.getElementById('showreason').value == 'ALTERN') { 
document.getElementById('showreasonALTERN').style.display = 'block' ;
} else {
        document.getElementById('showreasonALTERN').style.display = 'none';
    } if (document.getElementById('showreason').value == 'EXPAND') { 
document.getElementById('showreasonEXPAND').style.display = 'block' ;
} else {
        document.getElementById('showreasonEXPAND').style.display = 'none';
    }} 
function selection(select) {
    document.getElementById("section_" + select.value).style.display = "block";
}
            </script> 
```

这是在体内：

```
 <SELECT NAME="showreason"  id="reason_select"  onchange="showreason()" >
<OPTION  VALUE="BLANK"> Omit Reason </OPTION>
<OPTION  VALUE="RECAP"> Recapitalization </OPTION>
<OPTION  VALUE="RETIRE"> Retirement </OPTION>
<OPTION  VALUE="ALTERN"> So owners can pursue other alternatives </OPTION>
<OPTION  VALUE="EXPAND"> To allow the business to grow </OPTION></select>
</p>
<div id="showreasonBLANK" style="display: none;"></div>
<div id="showreasonRECAP" style="display: none;">A recapitalization will allow current ownership to diversify holdings without compromising the company's flexibility to finance growth.</div>
<div id="showreasonRETIRE" style="display: none;">The business is being sold for retirement.</div>
<div id="showreasonALTERN" style="display: none;">While this business is attractive the current ownership is looking to concentrate on other business opportunities.</div>
<div id="showreasonEXPAND" style="display: none;">Current ownership believes that a new owner will be able to grow the business faster and take it to a new level.</div> 
```

我是 javascript 的新手，所以我尝试了一些似乎没有什么区别的东西。我使用了 onclick 而不是 onshow，并在 showreason() 周围使用了单引号而不是双引号。

无论我从列表中选择哪个选项，都不会显示任何 div 的文本，我不明白为什么。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:55:41.870

代替

```
document.getElementById('showreason') 
```

在您的条件下，您应该使用

```
document.getElementById('reason_select') 
```

因为 SELECT 元素的 id 是“reason_select”而不是“showreason”

# java - Java swing 组合框 actionListner

> ID：13211817
> 
> 赞同：-1
> 
> 时间：2012-11-03T17:47:01.350
> 
> 标签：java, swing, user-interface, combobox

我正在编写一个使用基本摆动组件和动作监听器的程序。我已经让它大部分工作了，但我似乎无法让我的组合框动作监听器工作，我做错了什么？

据我了解，字符串应该被传递给 actionlistner 方法，但它在运行时不起作用！

```
public class LightControl extends JFrame implements ActionListener
{

private JButton on, off, twentyWatt, fortyWatt, sixtyWatt;
private JComboBox lightTimer;
private String [] comboSelection = new String[]{"Morning","Evening","All day"};
private JTextField statusText;
private LightBulb lightbulb;
private JPanel frameContainer;
private JPanel wattFrame;
private JPanel toggleFrame;
private JPanel comboFrame;

public LightControl()
{
    super("Lightbulb");
    lightbulb=new LightBulb();

    Container container = getContentPane();
    //FlowLayout layout=new FlowLayout();

    //instantiate
    statusText=new JTextField("Select an option");
    statusText.setSize(100, 50);
    statusText.setEditable(false);
    lightTimer = new JComboBox(comboSelection);
    on = new JButton("On");
    off = new JButton("Off");
    twentyWatt=new JButton("20W");
    fortyWatt=new JButton("40W");
    sixtyWatt=new JButton("60W");

    //right hand side frames
    comboFrame=new JPanel();
    comboFrame.add(lightTimer);

    toggleFrame=new JPanel();
    toggleFrame.setLayout(new GridLayout(1, 2));
    toggleFrame.add(on);
    toggleFrame.add(off);

    wattFrame=new JPanel();
    wattFrame.setLayout(new GridLayout(1, 3));
    wattFrame.add(twentyWatt);
    wattFrame.add(fortyWatt);
    wattFrame.add(sixtyWatt);

    frameContainer=new JPanel();
    frameContainer.setLayout(new GridLayout(3,3));
    frameContainer.add(toggleFrame);
    frameContainer.add(wattFrame);
    frameContainer.add(comboFrame);

    container.add(frameContainer, BorderLayout.EAST);
    container.add(statusText);

    //actions
    on.addActionListener(this);
    off.addActionListener(this);
    twentyWatt.addActionListener(this);
    fortyWatt.addActionListener(this);
    sixtyWatt.addActionListener(this);
    lightTimer.addActionListener(this);

    setSize(600, 400);
    setVisible(true);
}

public void actionPerformed(ActionEvent e) 
{
    String Action = e.getActionCommand();

    if (Action.equals ("On"))
    {
        lightbulb.setState(true);

        twentyWatt.setEnabled(true);
        fortyWatt.setEnabled(true);
        sixtyWatt.setEnabled(true);
        lightTimer.setEnabled(true);
        statusText.setText("\t"+lightbulb.toString());
        this.repaint();
    }

    else if (Action.equals ("Off")) 
    {
        lightbulb.setState(false);
        twentyWatt.setEnabled(false);
        fortyWatt.setEnabled(false);
        sixtyWatt.setEnabled(false);
        lightTimer.setEnabled(false);
        statusText.setText("\t"+lightbulb.toString());
        this.repaint();
    }

    else if (Action.equals ("20W")) 
    {
        lightbulb.setWattage(20);
        statusText.setText("\t"+lightbulb.toString());
        this.repaint();
    }

    else if (Action.equals ("40W")) 
    {
        lightbulb.setWattage(40);
        statusText.setText("\t"+lightbulb.toString());
        this.repaint();
    }

    else if (Action.equals ("60W")) 
    {
        lightbulb.setWattage(60);
        statusText.setText("\t"+lightbulb.toString());
        this.repaint();
    }

    else if (Action.equals ("Morning")) 
    {
        lightbulb.setTime("Morning");
        statusText.setText("\t"+lightbulb.toString());
        this.repaint();
    }

    else if (Action.equals ("Evening")) 
    {
        lightbulb.setTime("Evening");
        statusText.setText("\t"+lightbulb.toString());
        this.repaint();
    }

    else if (Action.equals ("All day")) 
    {
        lightbulb.setTime("All day");
        statusText.setText("\t"+lightbulb.toString());
        this.repaint();
    }

}   

 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:54:23.017

这不是 JComboBox 的工作方式。

*   对单独的组件使用单独的侦听器。
*   在这种情况下，给 JComboBox 自己的 ActionListener。匿名内部类会很好地工作。
*   在它的侦听器中，获取选定的项目，调用`toString()`它，您将拥有组合框的选定字符串。

例如，

```
// lightTimer.addActionListener(this);
lightTimer.addActionListener(new ActionListener() {

     @Override
     public void actionPerformed(ActionEvent e) {
        String selection = lightTimer.getSelectedItem().toString();
        // use the String here
     }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:55:49.073

由于您没有提供可执行示例，因此很难说出实际问题是什么，但是查看您的代码，我猜问题是您没有为控件指定操作命令。您获取的操作命令不是组件的文本，而是使用`component.setActionCommand(...)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T17:57:57.197

当`actionPerformed`组合框上的事件被触发时，`e.getActionCommand()`值为`comboBoxChanged`。我将您`actionPerformed`方法中的代码更改为下面的代码，它确实运行了您期望它运行的代码：

```
public void actionPerformed(ActionEvent e) {
    String Action = e.getActionCommand();

    if (Action.equals("On")) {
        lightbulb.setState(true);
        twentyWatt.setEnabled(true);
        fortyWatt.setEnabled(true);
        sixtyWatt.setEnabled(true);
        lightTimer.setEnabled(true);
        statusText.setText("\t"+lightbulb.toString());
        this.repaint();
    } else if (Action.equals("Off")) {
        lightbulb.setState(false);
        twentyWatt.setEnabled(false);
        fortyWatt.setEnabled(false);
        sixtyWatt.setEnabled(false);
        lightTimer.setEnabled(false);
        statusText.setText("\t"+lightbulb.toString());
        this.repaint();
    } else if (Action.equals("20W")) {
        lightbulb.setWattage(20);
        statusText.setText("\t"+lightbulb.toString());
        this.repaint();
    } else if (Action.equals("40W")) {
        lightbulb.setWattage(40);
        statusText.setText("\t"+lightbulb.toString());
        this.repaint();
    } else if (Action.equals("60W")) {
        lightbulb.setWattage(60);
        statusText.setText("\t"+lightbulb.toString());
        this.repaint();
    } else if (Action.equals("comboBoxChanged")) {
        String item = (String) lightTimer.getSelectedItem();
        if (item.equals("Morning")) {
            lightbulb.setTime("Morning");
            statusText.setText("\t"+lightbulb.toString());
            this.repaint();
        } else if (item.equals("Evening")) {
            lightbulb.setTime("Evening");
            statusText.setText("\t"+lightbulb.toString());
            this.repaint();
        } else if (item.equals("All day")) {
            lightbulb.setTime("All day");
            statusText.setText("\t"+lightbulb.toString());
            this.repaint();
        }
    }
} 
```

# java - Android下如何获取桌面版网页？

> ID：13211818
> 
> 赞同：1
> 
> 时间：2012-11-03T17:47:00.550
> 
> 标签：java, android

我尝试使用 获取网页`HttpURLConnection`，并获得移动版页面的结果。

现在我想得到一个桌面版页面，并尝试使用：`System.setProperty("http.agent", "Mozilla/5.0 (Windows NT 6.1; rv:7.0.1) Gecko/20100101 Firefox/7.0");`或`setRequestProperty("User-Agent", "Mozilla/5.0 (Windows NT 6.1; rv:7.0.1) Gecko/20100101 Firefox/7.0");`但我仍然得到移动版页面的结果。

有谁知道如何获取网页的桌面版源代码而不是移动版？

PS：我的安卓是2.3.7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:57:42.317

您必须设置连接的用户代理以假装它是桌面客户端。

当您使用 HttpUrlConnection 时，您可以执行以下操作：

```
URL url = new URL( "http://www.google.co.in/" );
HttpUrlConnection connection = (HttpUrlConnection) url.openConnection();
connection.setRequestProperty( "User-agent", "Mozilla/5.0 (Windows NT 6.1; WOW64) 
```

# c - C 参数转换

> ID：13211819
> 
> 赞同：0
> 
> 时间：2012-11-03T17:47:03.107
> 
> 标签：c, arguments

首先，我不得不说我是 C 编程新手。我要做的是编写一个程序，该程序接受参数输入并将其转换为整数，然后返回其值。我的代码如下所示：

```
#include <stdio.h>
#include <stdlib.h>

int main (int argc, char *argv[])
{
   int fromArgv = NULL;  /* holds value from argv[1] */
   fromArgv = atoi (argv[1]);    /* convert argv[1] to int */

   /* if incorrect no. of arguments entered */
   if (argc != 2) {
   fprintf (stderr, "error: wrong number of arguments\n");
   exit (EXIT_FAILURE);
   } 

   return fromArgv;
} 
```

尝试编译时出现以下错误：

```
ex1.c: In function ‘main’:
ex1.c:6:18: error: initialization makes integer from pointer without a cast [-Werror]
cc1: all warnings being treated as errors 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T17:49:31.813

你的问题是线路

```
int fromArgv = NULL; 
```

我相信`NULL`通常定义为`(void *) 0`，它是一个指针。您将此指针分配给一个`int`变量，这会给您带来错误。

`fromArgv`但是，在这种情况下不需要初始化。你可以这样做：

```
int fromArgv;  /* holds value from argv[1] */
fromArgv = atoi (argv[1]);    /* convert argv[1] to int */ 
```

甚至只是

```
int fromArgv = atoi (argv[1]);    /* convert argv[1] to int */ 
```

但是，您必须做的是确保`argv[1]`在访问它之前存在，这样如果用户没有输入任何命令行参数，您就不会收到段错误。您应该`if (argc != 2)`在分配`fromArgv`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T17:49:18.370

`NULL`是一个空*指针*常量，并且您尝试将其分配给一个*整*数值 ( `fromArgv`)，因此您的编译器会报告一个警告。

以下初始化工作正常：

```
fromArgv = 0; 
```

虽然，它没有用，因为您正在下一行修改变量的值：

```
int fromArgv = atoi(argv[1]); 
```

顺便说一句，从（它通常保留给错误代码）返回这种值是一个坏主意`main`，而且你太晚了参数的数量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T18:12:10.553

正如其他人所提到的，您正在使用“空指针”（从类型的角度来看是指针）初始化一个整数，这是错误的。你想把它初始化为零，

```
 int fromArgv = 0; 
```

然后，您应该选择参数并将其转换为 int**之后**而不是在检查参数数量之前。因此，您应该在零件之后移动“atoi”行`if (argc != 2)`。

还要考虑使用`strtol`而不是`atoi`. 前者允许您检查转换是否成功。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T17:54:30.217

您无法将 fromArgv 初始化为 NULL，因为 NULL 是一个指针，并且您将其分配给 int 只需将行更改为 int fromArgv ；

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-03T18:00:23.893

为什么你必须初始化 fromArgv ？

只是

```
int fromArgv = atoi(arg[1]); 
```

应该可以正常工作

# php - Add Multiple Term Search to my current query

> ID：13211820
> 
> 赞同：1
> 
> 时间：2012-11-03T17:47:06.057
> 
> 标签：php

I have a basic search engine. In one script, it populates a MYSQL table with words scanned in the html web page. Based on one word search, it ranks the results when the words appeared the most in the web page.

But I need to work on multiple term querying. Is there a way to search multiple terms from my query below?

```
 $keyword = addslashes( $_POST['keyword'] );
     $results = addslashes( $_POST['results'] );

      /* Execute the query that performs the actual search in the DB: */

         $result = mysql_query(" SELECT p.page_url AS url,
                       COUNT(*) AS occurrences 
                       FROM page p, word w, occurrence o
                       WHERE p.page_id = o.page_id AND
                       w.word_id = o.word_id AND
                       w.word_word = \"$keyword\"
                       GROUP BY p.page_id
                       ORDER BY occurrences DESC
                       LIMIT $results" ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:11:49.160

可能的解决方案我没有测试过。将帖子关键字作为数组提交或将它们单独收集到数组中。

然后要么首先使用 implode 将 $keyword 数组转换为字符串

```
$keywords = implode(',', $_POST['keyword']); 
```

并使用

```
w.word_word IN ($keywords) 
```

或者将内爆放入您的声明中。

```
w.word_word IN (".implode(',', $keywords').") 
```

无论哪种方式，您最终都会阅读 mysql

```
w.word_word IN (keyword1, keyword2, keyword3 ...) 
```

参考： [从 mysql 表中选择 WHERE 字段='$array'？](https://stackoverflow.com/questions/2382831/select-from-mysql-table-where-field-array)

[http://data.agaric.com/mysql-where-1-4-5-syntax](http://data.agaric.com/mysql-where-1-4-5-syntax)

# html - CSS display block on hover

> ID：13211822
> 
> 赞同：6
> 
> 时间：2012-11-03T17:47:37.190
> 
> 标签：html, css

I've following HTML, the div `.info` has `display:none` by default, I want to change that to `display:block` on hover. I'm trying following CSS but the `:hover` does not work.

**HTML:**

```
<div id="items">
    <div class="item">
        <a href="#">
            <div clas="info">

            </div>
        </a>
    </div>
</div> 
```

**CSS**

```
#items .item a .info{
    display: none;
}

#items .item a .info:hover{
    display: block;
} 
```

**JSFiddle:** [http://jsfiddle.net/qcDtF/](http://jsfiddle.net/qcDtF/)

Thanks.

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-03T17:52:54.133

You cannot hover over something that is not displayed. You could use [opacity](https://developer.mozilla.org/en-US/docs/CSS/opacity) or [visibility](https://developer.mozilla.org/en-US/docs/CSS/visibility) instead. [jsFiddle](http://jsfiddle.net/qcDtF/2/).

```
.info {
   opacity: 0;
}

.info:hover {
    opacity: 1;
} 
```

Alternatively, if you really want to use `display:none`, then give `#items`, `.item`, or your outer `a` a set width and height, and place the `:hover` on that element. [jsFiddle](http://jsfiddle.net/uLCu5/1/). For example:

```
#items{
    width: 20px;
    height: 20px;
}

.info{
    display: none;
}

#items:hover .info {
     display: block;  
} 
```

If you want the correct `width` and `height`, you can use javascript/jQuery to get the width/height of a visible `.info`, hide `.info`, and then set the height/width of `#items` to those values gotten from `.info`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T17:48:50.110

you have not display the content in info its not possible to hover the hidden

you can do something like [this](http://jsfiddle.net/swamimayank/uLCu5/)

```
<div id="items">
    <div class="item">
        <a href="#">sd
            <div class="info">
                asdf
            </div>
        </a>
    </div>
</div> 
```

css

```
#items .item a .info{
    display: none;
}

#items .item a:hover  .info{
    display: block;
} 
```

you can not do this by hover but you can change the opacity on hover so it feels like it will hide and show as the user @jeff gortmaker says

aslo

**if you have jquery as option then you can do this like**

```
$('.info').hover(function() {
    $(this).fadeTo(1,1);
},function() {
    $(this).fadeTo(1,0);
}); 
```

[jsFiddle](http://jsfiddle.net/swamimayank/P8Ems/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T17:55:49.827

使用`visibility`代替`display`：

```
#items .item .info {
    visibility: hidden;
}

#items .item:hover .info {
    visibility: visible;
}​ 
```

[http://jsfiddle.net/qcDtF/1/](http://jsfiddle.net/qcDtF/1/)

# android - The method write(byte[]) in the type FileOutputStream is not applicable for the arguments (Drawable)

> ID：13211823
> 
> 赞同：2
> 
> 时间：2012-11-03T17:47:41.777
> 
> 标签：android, image, save

Im attempting to save the actual image from my applications resources to a file on the SD card so it is accessible by the messaging application but I'm getting the error of - The method write(byte[]) in the type FileOutputStream is not applicable for the arguments (Drawable) - where its supposed to save it. I believe that I'm not using the appropriate method to save the actual image itself and I'm having difficulty finding a solution.

```
 // Selected image id
                int position = data.getExtras().getInt("id");
                ImageAdapter imageAdapter = new ImageAdapter(this);
                ChosenImageView.setImageResource(imageAdapter.mThumbIds[position]);
                Resources res = getResources();
                Drawable drawable = res.getDrawable(imageAdapter.mThumbIds[position]); //(imageAdapter.mThumbIds[position]) is the resource ID
                try {
                    File file = new File(dataFile, FILENAME);
                    file.mkdirs();
                    FileOutputStream fos = new FileOutputStream(file);
                    fos.write(drawable); // supposed to save the image here, getting the error at fos.write
                    fos.close();
                }catch (FileNotFoundException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                }
              }
            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:53:09.067

您的错误确实说明了一切，fileOuputStream 不能采用 Drawable，它需要一个字节数组。

所以你需要从你的 Drawable 中获取字节。

尝试：

```
Drawable drawable = res.getDrawable(imageAdapter.mThumbIds[position]);
Bitmap bitmap = ((BitmapDrawable)drawable).getBitmap();
ByteArrayOutputStream stream = new ByteArrayOutputStream();
bitmap.compress(Bitmap.CompressFormat.JPEG, 100, stream);
byte[] bitmapdata = stream.toByteArray(); 
```

……

```
fos.write(bitmapdata); 
```

当你在做的时候，把`fos.close()`最后的块

# symfony - symfony2 : failed to write cache directory

> ID：13211829
> 
> 赞同：63
> 
> 时间：2012-11-03T17:48:32.963
> 
> 标签：symfony

I have had to use the

```
app/console cache:clear  command 
```

to solve a problem when generating an entity.

I am now unable to load my homepage on :

```
 http://localhost/projet_etienne/web/app_dev.php 
```

it says :

> RuntimeException: Failed to write cache file "/var/www/projet_etienne/app/cache/dev/classes.php".

I don't understand much about this cache business!

In my `app/cache` folder, I got a `dev`, a `dev_new`, a `dev_old` folder. Is that normal?

the

```
app/console cache:clear 
```

generates by the way a :

> [ErrorException] Warning: rename(/var/www/projet_etienne/app/cache/dev,/var/www/projet_etien
> ne/app/cache/dev_old): Directory not empty in /var/www/projet_etienne/vendo
> r/symfony/symfony/src/Symfony/Bundle/FrameworkBundle/Command/CacheClearComm
> and.php line 77

please help!

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2013-02-25T15:17:36.797

有关良好且明确的解决方案，请参阅第 1`Setting up Permissions`节中的 `Installing and Configuring Symfony`部分：

> 设置权限
> 
> 安装 Symfony 时的一个常见问题是 app/cache 和 app/logs 目录必须对 Web 服务器和命令行用户都可写。在 UNIX 系统上，如果您的 Web 服务器用户与命令行用户不同，您可以尝试以下解决方案之一。
> 
> 1.  对 CLI 和 Web 服务器使用相同的用户
> 
> 在开发环境中，为 CLI 和 Web 服务器使用相同的 UNIX 用户是一种常见的做法，因为这样可以在设置新项目时避免任何这些权限问题。这可以通过编辑您的 Web 服务器配置（例如，通常用于 Apache 的 httpd.conf 或 apache2.conf）并将其用户设置为与您的 CLI 用户相同（例如，对于 Apache，更新用户和组值）来完成。
> 
> 2.  在支持 chmod +a 的系统上使用 ACL
> 
> 许多系统允许您使用 chmod +a 命令。先试试这个，如果你得到一个错误 - 试试下一个方法。这使用一个命令来尝试确定您的 Web 服务器用户并将其设置为 HTTPDUSER：
> 
> ```
> $ rm -rf app/cache/*
> $ rm -rf app/logs/*
> 
> $ HTTPDUSER=`ps aux | grep -E '[a]pache|[h]ttpd|[_]www|[w]ww-data|[n]ginx' | grep -v root | head -1 | cut -d\  -f1`
> $ sudo chmod +a "$HTTPDUSER allow delete,write,append,file_inherit,directory_inherit" app/cache app/logs
> $ sudo chmod +a "`whoami` allow delete,write,append,file_inherit,directory_inherit" app/cache app/logs 
> ```
> 
> 3.  在不支持 chmod +a 的系统上使用 ACL
> 
> 有些系统不支持 chmod +a，但支持另一个名为 setfacl 的实用程序。您可能需要在分区上启用 ACL 支持并在使用之前安装 setfacl（与 Ubuntu 一样）。这使用一个命令来尝试确定您的 Web 服务器用户并将其设置为 HTTPDUSER：
> 
> ```
> $ HTTPDUSER=`ps aux | grep -E '[a]pache|[h]ttpd|[_]www|[w]ww-data|[n]ginx' | grep -v root | head -1 | cut -d\  -f1`
> $ sudo setfacl -R -m u:"$HTTPDUSER":rwX -m u:`whoami`:rwX app/cache app/logs
> $ sudo setfacl -dR -m u:"$HTTPDUSER":rwX -m u:`whoami`:rwX app/cache app/logs 
> ```
> 
> 对于 Symfony 3，它将是：
> 
> ```
> $ HTTPDUSER=`ps aux | grep -E '[a]pache|[h]ttpd|[_]www|[w]ww-data|[n]ginx' | grep -v root | head -1 | cut -d\  -f1`
> $ sudo setfacl -R -m u:"$HTTPDUSER":rwX -m u:`whoami`:rwX var/cache var/logs
> $ sudo setfacl -dR -m u:"$HTTPDUSER":rwX -m u:`whoami`:rwX var/cache var/logs 
> ```
> 
> 如果这不起作用，请尝试添加 -n 选项。
> 
> 4.  不使用 ACL
> 
> 如果前面的方法都不适合您，请更改 umask，以便缓存和日志目录是组可写或全局可写的（取决于 Web 服务器用户和命令行用户是否在同一个组中）。为此，请将以下行放在 app/console、web/app.php 和 web/app_dev.php 文件的开头：
> 
> ```
> umask(0002); // This will let the permissions be 0775
> 
> // or
> 
> umask(0000); // This will let the permissions be 0777 
> ```
> 
> 请注意，当您可以在服务器上访问 ACL 时，建议您使用 ACL，因为更改 umask 不是线程安全的。

[http://symfony.com/doc/current/book/installation.html#checking-symfony-application-configuration-and-setup](http://symfony.com/doc/current/book/installation.html#checking-symfony-application-configuration-and-setup)

来源： [清除缓存时无法写入缓存文件“/var/www/myapp/app/cache/dev/classes.php”](https://stackoverflow.com/questions/8449345/symfony-2-cacheclear-bug)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2014-06-17T19:20:34.373

很可能这意味着目录和/或**子目录**不可写。许多人忘记了子目录。

**Symfony 2**

```
chmod -R 777 app/cache app/logs 
```

**Symfony 3 目录结构**

```
chmod -R 777 var/cache var/logs 
```

## 其他资源

[Symfony 的权限解决方案](http://symfony.com/doc/current/book/installation.html#configuration-and-setup)（前面提到过）。

[KPN 大学的权限解决方案](https://knpuniversity.com/screencast/symfony2-ep1/installation#ep1-install-permissions)- 还包括安装屏幕。

注意：如果你使用 Symfony 3 目录结构，用`app/cache`and`app/logs`替换`var/cache`and `var/logs`。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-11-03T20:59:42.647

如果文件夹已经是可写的，那不是问题。

您也可以导航到`/www/projet_etienne/app/cache/`并手动删除其中的文件夹（dev、dev_new、dev_old）。

**如果这不能解决问题，请确保在某处保存这些文件夹的副本以放回**

我知道这不是应该的方式，但它现在对我有用了几次。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-11-14T10:29:12.477

您可能在中途中止了一个 clearcache，现在您已经有了一个 app/cache/dev_old。

试试这个（在项目的根目录中，假设您在 OS X 或 Linux 等 Unixy 环境中）：

`rm -rf app/cache/dev*`

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-08-03T07:32:29.477

可能你忘了改app/cache app/log的权限

我正在使用 Ubuntu 所以

```
sudo chmod -R 777 app/cache
sudo chmod -R 777 app/logs
sudo setfacl -dR -m u::rwX app/cache app/logs 
```

希望能帮助到你..

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-02-10T19:53:14.863

我将整个目录从我的 Windows 安装移动到一个 unix 生产服务器，我得到了同样的错误。为了修复它，我只是在 unix 中运行了这两行，一切都开始运行良好

```
rm -rf app/cache/*
rm -rf app/logs/* 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-01-25T17:20:35.743

我执行：

```
ps aux | grep apache 
```

并得到了类似的东西：

```
root     28147  0.0  5.4 326336 27024 ?        Ss   20:06   0:00 /usr/sbin/apache2 -k start
www-data 28150  0.0  1.3 326368  6852 ?        S    20:06   0:00 /usr/sbin/apache2 -k start
www-data 28151  0.0  4.4 329016 22124 ?        S    20:06   0:00 /usr/sbin/apache2 -k start
www-data 28152  0.1  6.0 331252 30092 ?        S    20:06   0:00 /usr/sbin/apache2 -k start
www-data 28153  0.0  1.3 326368  6852 ?        S    20:06   0:00 /usr/sbin/apache2 -k start
www-data 28154  0.0  1.3 326368  6852 ?        S    20:06   0:00 /usr/sbin/apache2 -k start
www-data 28157  0.0  1.3 326368  6852 ?        S    20:06   0:00 /usr/sbin/apache2 -k start
user     28297  0.0  0.1  15736   924 pts/4    S+   20:12   0:00 grep --color=auto apache 
```

所以我没有访问权限的用户原来是`www-data`因此我执行了命令：

```
sudo chown -R www-data app/cache
sudo chown -R www-data app/logs 
```

它解决了访问错误。

> 永远不要使用不安全的 777 来解决特定的访问问题：

```
sudo chmod -R 777 app/cache
sudo chmod -R 777 app/logs 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-06-05T14:15:30.867

如果 symfony 版本低于 2.8

```
sudo chmod -R 777 app/cache/*
```

如果 symfony 版本大于或等于 3.0

```
sudo chmod -R 777 var/cache/*
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-10-19T15:22:26.183

如果您在使用 docker（我的 Symfony 版本 5.1）启动 Symfony 项目时遇到此错误。或者像这样的错误：

> 未捕获的异常：读取上游时无法写入文件“/var/www/html/mysite.com.local/var/cache/dev/App_KernelDevDebugContainer.xml”

> 未捕获的警告：file_put_contents（/var/www/html/mysite.com.local/var/cache/dev/App_KernelDevDebugContainerDeprecations.log）：无法打开流：权限被拒绝”同时读取上游

下面的修复帮助了我。

在 Dockerfile for nginx 容器中添加行：

```
RUN usermod -u 1000 www-data 
```

在 Dockerfile for php-fpm 容器中添加行：

```
RUN usermod -u 1000 www-data 
```

然后删除目录“/var/cache”、“/var/log”中的所有内容并重建 docker 的容器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-08-08T10:52:23.350

只需使用此 acl cmd，下次创建 var 中的文件时，它将具有 www-data 用户的 r/w/x 权限。

```
cd var 
rm -rf *
cd ..
setfacl -d -m u:www-data:rwx var 
```

命令解释：

```
setfacl -> Set acl command    
-d -> default behavior    
-m -> modify 
u:www-data: -> for user 
rwx -> adding permissions  
var -> on the folder 
```

# javascript - Update ExtJS Panel with HTML that will render iframe

> ID：13211831
> 
> 赞同：1
> 
> 时间：2012-11-03T17:48:40.207
> 
> 标签：javascript, extjs

I have an app with several tabs written in ExtJs 4.

One of the tabs is just an iframe. I create it like this and it works fine.

```
xtype: 'tabpanel',
title: 'My Embedded Web Pages',
items : [
                {
                    title: 'Google',
                    html : '<iframe width ="100%" height="100%" src="http://www.google.com"><p>Your browser does not support iframes.</p></iframe>'
                },
] 
```

I would like create the page Dynamically using more of an OOP design patter though by extending an Ext.panel.Panel. If I can do this I can add some more functionality ( like a basic toolbar with a back button ).

```
Ext.define('NS.view.web_browser.WebBrowser' ,{

extend: 'Ext.panel.Panel',

alias: 'widget.web_browser',

title: 'Web Browser',

refresh: function() {
    console.log('refresh');
},

initComponent: function( arguments ) {
    console.log('initComponent');

    this.callParent(arguments);
},
listeners : {
    viewready : function( view, options )
    {
        console.log('viewready');
        someText = '<iframe width ="100%" height="100%" src="http://www.google.com/"><p>Your browser does not support iframes.</p></iframe>';

        //I'm assuming 'this' is the panel
        this.update( Ext.util.JSON.encode( someText ) );
    }
}
}); 
```

However, this is not working. I expect its how I am trying to cram the html into the panel but am not sure. Any help appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T08:36:53.773

你试过 ux:`miframe.js`吗？文档可[在此处](http://code.google.com/p/managediframe/)获得。很长一段时间以来，我一直在使用 ExtJS 3.x 在面板中嵌入 iframe。我不知道它是否已经移植到 ExtJS4。

# c - why scheduler is returning priority value 0 in linux

> ID：13211839
> 
> 赞同：2
> 
> 时间：2012-11-03T17:49:47.797
> 
> 标签：c, linux

I am trying to assign the max priority allowed for SCHED_RR policy on kernel 3.2.23-rt37.56.el6rt.x86_64\. The code is as shown below. The max_prio_for_policy on line 7 and 8 is zero. What is wrong in the code?

```
 pthread_t thId = pthread_self();
    pthread_attr_t theAttr;
    int policy = SCHED_RR;
    int max_prio_for_policy = 0;

    pthread_attr_init(&theAttr);
    pthread_attr_getschedpolicy(&theAttr, &policy);
    max_prio_for_policy = sched_get_priority_max(policy);

    printf("setting thread priority to: %d\n", max_prio_for_policy); 
```

UPDATE: I ran this code on both kernel 3.2.23-rt37.56.el6rt.x86_64 and 2.6.32-279.el6.x86_64, and found the result to be the same.

SOLVED: i was doing #include "linux/sched.h" as opposed to "sched.h"

# php - SQL 自动增量 ID

> ID：13211841
> 
> 赞同：0
> 
> 时间：2012-11-03T17:49:50.643
> 
> 标签：php, sql, tags

我有一个带有自动增量字段的 SQL 表。我知道人们问过如何在插入发生后检索“最后一个条目”的 ID，我知道该怎么做。我想要做的是将自动生成的字段复制到同一张表的第二列中 - 我如何修改我的插入代码来做到这一点：

```
mysql_query("INSERT INTO `tags` (`tid`,`tagid`,`tagname`) VALUES('','INSERTED.ID','{$tagname}')"); 
```

我想这样做的原因是因为我希望能够使两行彼此相等。IE 如果两个不同的标签（具有不同的唯一 ID）具有相同的 tagid，那么我可以在其他地方使用“tagid”引用作为唯一标识符并循环浏览它们。我还可以保留关于哪个标签是父标签的知识——因为它将具有与“tagid”相同的“tid”。

我有一个标记事件的系统；但有时我拼错了一个标签……所以我不想纠正所有的错误，而是想通过允许拼写错误的标签被连接起来并以与正确标签相同的方式对待来使我的系统防错。

感谢您的帮助-即使这意味着以完全不同的方式进行操作。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:54:31.530

您必须更改表以将字段设置为自动增量。然后我相信当你插入任何东西时它会增加。还有这个声明称为重复... http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:55:10.013

您可以存储以前的 id，然后在查询字符串中使用它。

```
$previous_id = mysql_insert_id();

mysql_query("INSERT INTO `tags` (`tid`,`tagid`,`tagname`) VALUES('','$previous_id','{$tagname}')"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T18:06:53.500

2个选项：

1）你可以使用[`LAST_INSERT_ID()`](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_last-insert-id)mysql函数，但是在第二次查询中，不一样。

```
SELECT LAST_INSERT_ID(); 
```

2）在表中定义一个插入[触发器](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)，然后当您插入时，触发器“触发”并在触发器中执行操作。

```
 CREATE TRIGGER tag_tid BEFORE INSERT ON tags
 FOR EACH ROW NEW.tid = NEW.id; 
```

注意：短创建者，请参阅链接中的更多内容。

# python - 启动“安全”eval()

> ID：13211846
> 
> 赞同：1
> 
> 时间：2012-11-03T17:50:56.257
> 
> 标签：python, eval, bots, irc

我正在制作一个 irc 机器人[https://github.com/mouuff/MouBot](https://github.com/mouuff/MouBot) 我希望机器人`eval()`在消息以 !math 开头时回复它，但如果用户输入类似 !math exit() 之类的东西，它会创建失败那

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T17:56:27.613

不。

看起来您正在尝试创建一个数学解析器。然后使用数学解析器，而不是成熟的 I-will-run-any-code-parser。如果你使用 *nix，你可以使用一个程序`bc`来做你想做的事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:56:50.077

使用[语言服务](http://docs.python.org/library/language.html)将其编译成 AST，遍历 AST 确保它仅包含列入白名单的节点集，然后执行它。

[示例实现由 unutbu 提供](https://stackoverflow.com/a/4236328/20862)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T17:57:52.643

问题`eval()`在于，当它执行时，它是有效的python代码，并且`exit()`是python代码的有效部分，通常退出程序（尽管这个特定的功能应该在IDLE中使用，并且`sys.exit()`在非空闲使用时优先使用）。

出于这个原因，`eval()`应该只与受信任的输入一起使用，或者您应该为传递给`eval()`函数的命令实现解析器，以消除不需要的输入（如果您希望实现自己的功能，可以查看`shlex`模块的功能，`split()`我已经将它用于许多解析器）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T18:32:57.933

如果你想要简单的数学评估，为什么你想把 Python 的全部力量放在后面，这可能而且将会被滥用。

使用[PyParsing 之](http://pyparsing.wikispaces.com)类的东西来编写一个简单的计算器，例如参见[SimpleCalc.py](http://pyparsing.wikispaces.com/file/view/SimpleCalc.py)或[fournfn.py](http://pyparsing.wikispaces.com/file/view/fourFn.py)，我认为这些足以让您入门。你也可以试试[SimpleParse](http://simpleparse.sourceforge.net/)

如果您确实想提供类似 eval 的强大且可滥用的功能，您应该启动一个 VM，其中启动将回复 eval 查询的服务器进程，并使用[cgroups](http://en.wikipedia.org/wiki/Cgroups)限制每个进程，当 VM 关闭时启动另一个进程或保留一个VM 和评估进程池。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-03T19:03:01.087

我不确定它可以帮助你，但看看这个 - > [http://doc.pypy.org/en/latest/sandbox.html](http://doc.pypy.org/en/latest/sandbox.html)

或者这个-> [Python 沙盒是否有替代 rexec 的方法？](https://stackoverflow.com/questions/525056/is-there-an-alternative-to-rexec-for-python-sandboxing)

# android - 带有 4 个按钮 android 的 Tablelayout 上的 ImageView

> ID：13211848
> 
> 赞同：0
> 
> 时间：2012-11-03T17:51:00.463
> 
> 标签：android, android-layout

我目前正在制作一个应用程序，我希望在屏幕顶部有一个图像视图（与顶部的屏幕间隙为 10%），并在图像视图下有一个带有 4 个按钮的表格。

我现在拥有的是：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/testhback"
android:gravity="bottom" >

<ImageView
    android:id="@+id/imageView1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_marginBottom="@dimen/f1"
    android:adjustViewBounds="true"
    android:src="@drawable/img1" />

<TableLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="@dimen/top2"
    android:stretchColumns="*" >

    <TableRow
        android:id="@+id/tableRow1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <Button
            android:id="@+id/button5"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_below="@+id/button4"
            android:onClick="changepic2"
            android:text="Breaking Dawn" />

        <Button
            android:id="@+id/button4"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignBaseline="@+id/button1"
            android:layout_alignBottom="@+id/button1"
            android:layout_alignLeft="@+id/button5"
            android:layout_alignParentRight="true"
            android:onClick="changepic3"
            android:text="New Moon (2)" />
    </TableRow>

    <TableRow
        android:id="@+id/tableRow3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <Button
            android:id="@+id/button1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_above="@+id/button3"
            android:layout_alignParentLeft="true"
            android:onClick="changepic"
            android:text="Twilight (1)" />

        <Button
            android:id="@+id/button3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:onClick="changepic1"
            android:text="Eclipse (3)" />
    </TableRow>
</TableLayout> 
```

问题是我试图从表格顶部设置边距。但是在每个屏幕上它看起来都不一样，我不知道如何让它自动获取，比如说，10% 用于顶行，70% 用于图像视图，20% 用于带有 4 个按钮的表格它在底部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:01:58.527

您可以使用具有垂直方向的 LinearLayout 并配置 layout_weight 属性以进行这种排列。

有关更多信息，请在此处查看[http://blog.stylingandroid.com/archives/297](http://blog.stylingandroid.com/archives/297)，如果问题仍然存在，请返回。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T18:02:41.010

你必须使用 android:layout_width = 0dp, android:weightSum 和 android:layout_weight

该[线程](https://stackoverflow.com/questions/2698817/linear-layout-and-weight-in-android)应该可以帮助您

# git - 在 Git 中追溯移动文件夹

> ID：13211852
> 
> 赞同：0
> 
> 时间：2012-11-03T17:51:24.233
> 
> 标签：git, github, directory-structure

我分叉了一个具有奇怪目录结构的存储库，我将其修复如下：

前：

> /core/src/com/example/core/Core.java
> 
> /simulation/src/com/example/simulation/Main.java

后：

> /src/com/example/core/Core.java
> 
> /src/com/example/simulation/Main.java

当我移动这些目录时，我对 Git 完全陌生，只是简单地`git rm`对旧目录做了 a 对新目录做了 a `git add`。

从那以后，我对文件进行了许多更改，我想向原始存储库发送拉取请求以获取新的结构和内容。

**我如何告诉 Git 追溯移动（mv）文件，以便清楚文件的来源？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:57:06.253

A与后面`git mv filex`的 完全相同。`git rm filex``git add new\location\filex`

您没有理由需要追溯更改它。

[这](https://git.wiki.kernel.org/index.php/GitFaq#Why_does_git_not_.22track.22_renames.3F)是有关它的更多信息

# jquery - 第 n 个选择器 jquery 显示第 n 个值

> ID：13211854
> 
> 赞同：-3
> 
> 时间：2012-11-03T17:51:32.293
> 
> 标签：jquery

我希望能够从跨度列表中选择第 n 个孩子，并在单击按钮时显示它们的第 n 个值（或位置）。

所以如果我有：

```
item a
item b
item c
item d
item e 
```

在按钮按下我希望它显示：

```
1 item a
2 item b
3 item c
4 item d
5 item e 
```

这可能吗？如果可以，怎么办？

HTML（来自下面的答案）

```
<div class="items">item a</div>
<div class="items">item b</div>
<div class="items">item c</div>
<div class="items">item d</div>
<div class="items">item e</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:57:17.377

这是可以做的：

如果 HTML 是

```
<div class="items">item a</div>
<div class="items">item b</div>
<div class="items">item c</div>
<div class="items">item d</div>
<div class="items">item e</div> 
```

JS 应该是：

```
$(function(){
    $('.items').each(function(index){
        $(this).html((index+1)+" "+$(this).html());
    });
}); 
```

​ 演示在这里：http: [//jsfiddle.net/veZg5/](http://jsfiddle.net/veZg5/)

# actionscript-3 - Actionscript: Problems with implicit coercion

> ID：13211855
> 
> 赞同：2
> 
> 时间：2012-11-03T17:51:54.670
> 
> 标签：actionscript-3, flash, web-applications, actionscript, web

I'm following hemanth sharma's excellent tutorial series on the starling framework. I more or less copied his code and made a few changes towards the game I have in mind. The code is 80% the same he used in his project. Nevertheless I'm encountering a strange error: "error 1067" it complains about the "implicit coercion" of supposedly unrelated types.

I browsed previous questions and discovered this one:

[1067: Implicit coercion of a value of type Class to an unrelated type flash.display:DisplayObject](https://stackoverflow.com/questions/10032683/1067-implicit-coercion-of-a-value-of-type-class-to-an-unrelated-type-flash-disp)

The error message I'm receiving is basically the same but unfortunately the solution does not apply to my problem. Moreover I'm getting this error in many interesting different flavours.

1.  I've got a custom event class called NavigationEvent that expands starling.events.Event. When the used tries to switch between the game screens this event is dispatched. Here's some code:

    ```
    import starling.events.Event;

    public class NavigationEvent extends Event 
    ```

    it is dispatched like this:

    ```
    this.dispatchEvent(new NavigationEvent(NavigationEvent.CHANGE_SCREEN,{id:"play"},true)); 
    ```

    the error message says:

    > Error 1067: Implicit coercion of a value of type events:NavigationEvent to an unrelated type starling.events:Event

    The code worked fine when I first wrote it but now, after I've changed another part of the program it is broken. I can't explain it. I extended NavigationEvent from starling.events.Event so the types are definitely not unrelated. I even ran the program like this. Admittedly the routine to switch between screens was no yet implemented but the event was fired without problems.

2.  In order to let the user trigger this event I added a button to the screen. It is starlings standard `starling.display.Button;`. The button is a member variable of my screen class

    ```
    private var playBtn:Button; 
    ```

    However this line results in an error:

    ```
    playBtn=new Button(Assets.getAtlas().getTexture("play")); 
    ```

    This time the error is even more outrageous:

    > Error 1067: Implicit coercion of a value of type starling.textures:Texture to an unrelated type starling.textures:Texture

What can I do about this ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T21:28:17.347

有时，当您在 Flash Builder 中打开两个 Flash Pro 项目，并且两个项目在代码路径中具有相同的目录时，您可能会遇到您遇到的错误。当您在其中一个项目中打开文件时会发生这种情况，但您正在编译和运行这两个项目（特别是如果您正在调试并设置了断点）。

我认为正在发生的事情是 FB 在同一个文件中编译，*就好像*它是一个不同的文件一样，因为它从文件打开的文件“延伸”并将其编译到它刚刚引用但未打开的文件中. 打开的文件扩展了*其*项目中的基类，而不是项目中包含 fla/xfl 的基类。虽然*我们*知道它实际上是一个文件，但 FB 显然无法弄清楚。我认为你真的很轻松，因为我过去不得不采取真正英勇的措施来解决这个问题。

您可以通过将共享代码移出库项目来解决此问题，我认为这是工程师可能认为每个人都会这样做的场景。我认为他们无法（或至少没有）预见到历史 Flash 开发实践的交集以及将 FB 和 FP 一起使用的怪癖会导致此特定错误出现。

# entity-framework - Mapping entities with fluent api on entity framework 5

> ID：13211859
> 
> 赞同：0
> 
> 时间：2012-11-03T17:52:12.967
> 
> 标签：entity-framework, c#-4.0, orm, code-first, lambda

I have a question.

I have these two tables: ![Tables](../Images/90c758d87872f558e07c6f6217c3174d.png)

The principal table is User with Customer dependence.

The reverse engineer code first generated classes as follows:

```
public class User
{
    public User()
    {
        this.Customers = new List<Customer>();          
    }

    ...

    public virtual ICollection<Customer> Customers { get; set; }

}

public class Customer
{
    public Customer()
    {
    }

    ...

    public int UserID { get; set; }
    public virtual User User { get; set; }

} 
```

I made the following modification in the user class:

```
public class User
{
    public User()
    {          

    }
    public int CustomerID { get; set; }
    public virtual Customer Customer { get; set; }

} 
```

Because the relationship is One-to–Zero-or-One.

The original mapping is this:

```
// Relationships
        this.HasRequired(t => t.User)
            .WithMany(t => t.Customers)
            .HasForeignKey(d => d.UserID); 
```

And the modified mapping is this :

```
this.HasRequired(t => t.User)
            .WithOptional(t => t.Customer)
            .Map(m => m.MapKey("UserID")); 
```

Is That correct? If not, how would this mapping?

Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T19:27:15.010

不，这是不正确的。

你能做的最好的事情——假设你可以改变数据库模式——是`UserID`从表中删除外键`Customer`，然后在数据库中创建两个主键之间的关系，这`Customer.CustomerID`就是关联中的外键。

然后逆向工程应该自动创建预期的一对一关系，如下所示：

```
public class Customer
{
    public int CustomerID { get; set; }
    public virtual User User { get; set; }
    //...
}

public class User
{
    public int UserID { get; set; }
    public virtual Customer Customer { get; set; }
    //...
}

//...

this.HasRequired(t => t.User)
    .WithOptional(t => t.Customer); 
```

如果您无法更改数据库模式，最好的办法是仅从类中删除集合`ICollection<Customer> Customers`并将`User`关系保持为一对多。

这一切的原因是EF只支持共享主键一对一关联，不支持外键一对一关联。（后一个你只能通过删除集合来“伪造”，但从 EF 的角度来看，它仍然是一对多的。）

您可以在此处阅读有关与 EF 的一对一关联及其限制的更多信息：

*   [一对一共享主键关联](http://weblogs.asp.net/manavi/archive/2011/04/14/associations-in-ef-4-1-code-first-part-3-shared-primary-key-associations.aspx)
*   [一对一的外键关联](http://weblogs.asp.net/manavi/archive/2011/05/01/associations-in-ef-4-1-code-first-part-5-one-to-one-foreign-key-associations.aspx)

# php - Select and show data in tabs

> ID：13211863
> 
> 赞同：0
> 
> 时间：2012-11-03T17:52:18.233
> 
> 标签：php, javascript, jquery, select, tabs

I have a website that displays the titles of TV shows, ordered by season. I'd like to implement a UI where the user is able to switch between seasons of a show by switching tabs For example, the "Season 1" tab would show the titles of all the shows from the first season, the "Season 2" tab would show the titles of all the shows from the second season, etc. The DB is structured as an episodes table with title, show_id (id of the TV show), and sezon(season number).

```
<div class="demo" id="tabs">
<ul>

<?$season=mysql_query("select * from seasons where showid='$ids' ORDER BY sezon ASC");

while($szn=mysql_fetch_array($season)){?>

<li><a href="#tabs-<?=$szn['sezon'];?>">Season <?=$szn['sezon'];?></a></li>

<?}?>

</ul>

<div id="tabs-<?=$szn['sezon'];?>">episodetitle</div>
</div> 
```

How can I implement the tab switching correctly?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:58:54.540

我认为最简单的方法是 jQuery。在 jQuery UI 中有一个特定的东西。

[http://jqueryui.com/tabs/](http://jqueryui.com/tabs/)

阅读示例下方的文档。（有一段代码可以让理解更容易。）

当我阅读您的代码时，它非常适合 jQuery UI 中的选项卡。

# geometry - Calculating the distance between each pair of a set of points

> ID：13211870
> 
> 赞同：1
> 
> 时间：2012-11-03T17:53:08.060
> 
> 标签：geometry, distance

So I'm working on simulating a large number of n-dimensional particles, and I need to know the distance between every pair of points. Allowing for some error, and given the distance isn't relevant at all if exceeds some threshold, are there any good ways to accomplish this? I'm pretty sure if I want `dist(A,C)` and already know `dist(A,B)` and `dist(B,C)` I can bound it by `[dist(A,B)-dist(B,C) , dist(A,B)+dist(B,C)]`, and then store the results in a sorted array, but I'd like to not reinvent the wheel if there's something better.

I don't think the number of dimensions should greatly affect the logic, but maybe for some solutions it will. Thanks in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T18:14:06.907

如果问题只是关于计算所有对之间的距离，那么这将是一个`O(n^2)`没有任何机会找到更好解决方案的问题。但是，您是说如果距离大于某个阈值`D`，那么您对它不感兴趣。这为更好的算法打开了机会。

例如，在二维情况下，您可以使用扫描线技术。按字典顺序对您的点进行排序，首先`y`按`x`. 然后用一条宽度为 的*条纹*从下到上扫过飞机`D`。当条带在平面上移动时，新点将通过其顶部边缘进入条带并通过其底部边缘退出。活动点（即当前在条带内的点）应保存在一些按其`x`坐标排序的可增量修改的线性数据结构中。

现在，每次新点进入条带时，您都必须检查左侧和右侧不超过`D`（沿`x`轴测量）的当前活动点。就这样。

该算法的目的（因为它通常是扫描线方法的情况）是将实际复杂度推离`O(n^2)`和推向`O(m)`，这里`m`是我们实际感兴趣的交互次数。当然，最坏情况下的性能将是`O(n^2)`.

以上适用于二维情况。对于 n 维情况，我会说使用不同的技术会更好。某种空间分区在这里应该可以很好地工作，即利用这样一个事实，即如果已知分区之间的距离大于`D`，那么没有理由考虑这些分区中的特定点相互对抗。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T17:59:28.817

如果超出某个阈值的距离不相关，并且该阈值不太大，则有一些常用技术可以提高效率：使用空间分区数据结构限制对相邻点的搜索。可能的选项是：

*   装箱。
*   树：四叉树（2d），kd-trees。
*   使用空间散列进行分箱。

此外，由于从 A 点到 B 点的距离与从 B 点到 A 点的距离相同，因此该距离应该只计算一次。因此，您应该使用以下循环：

```
for point i from 0 to n-1:
     for point j from i+1 to n:
        distance(point i, point j) 
```

结合这两种技术对于 n 体模拟非常常见，例如，如果粒子足够接近，粒子就会相互影响。以下是 2d 中的一些有趣示例：http: [//forum.openframeworks.cc/index.php?topic =2860.0](http://forum.openframeworks.cc/index.php?topic=2860.0)

这是对分箱（和散列）的解释： [http ://www.cs.cornell.edu/~bindel/class/cs5220-f11/notes/spatial.pdf](http://www.cs.cornell.edu/~bindel/class/cs5220-f11/notes/spatial.pdf)

# c# - XNA 2D Bulletcollision（带有列表的列表）

> ID：13211873
> 
> 赞同：0
> 
> 时间：2012-11-03T17:53:33.530
> 
> 标签：c#, xna, collision-detection

在这里继续我的游戏（玩家是一艘船并且你击落流星的游戏）。我目前正在船上射击子弹，我正试图在流星被子弹击中时移除它们。这就是我所做的。我快到了，但我在编码中发现了一个错误。在我的游戏中，在地图右侧之外会产生流星，它们会向左移动，关键是要将它们击落，如果你以正确的顺序射击流星，这是可行的，否则就不行。让我用一张图片来解释一下。 ![例子](../Images/bc3cdddac2bdc30231c4c482d8343df9.png)

如果我要击落第二颗流星，标有数字 1 的流星会先被摧毁

```
//spawns the enemies.
public void LoadEnemies()
    {
        int randY = random.Next(100, 500);
        if (spawn > 1)
        {
            spawn = 0;
            if (enemies.Count() < 4)
                enemies.Add(new Enemies(Content.Load<Texture2D>("meteor"), new Vector2(1110, randY)));
        }
        //Here's where the error lies because of the bulletcolliding (I think)
        for (int i = 0; i < enemies.Count; i++)
        {
            if (!enemies[i].isVisible || bulletColliding)
            {
                bulletColliding = false;
                enemies.RemoveAt(i);
                i--;
            }
        }
    } 
```

碰撞法。

```
 public void bulletCollision(GameTime gameTime)
    {
        foreach (var x in bullets)
        {
            foreach (var y in enemies)
            {
                enemy_rect = new Rectangle((int)y.position.X, (int)y.position.Y, 10, 10);
                bullet_rect = new Rectangle((int)x.position.X, (int)x.position.Y, 10, 10);
                if (bullet_rect.Intersects(enemy_rect))
                {
                    bulletColliding = true;
                }
            }
        }
    } 
```

基本上，我对如何移除被击中的特定流星一无所知，我需要你的帮助。我感谢我得到的所有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T18:16:00.063

不要只使用`bool bulletColliding`. 也使用整数来显示应该被摧毁的敌人的数量，并在每个敌人类别中保留他的数量信息。

第二个选项可以保留一个`bool ifDestroy`初始为假的敌人类，如果敌人应该被摧毁，则将其更改为真。你可以检查它`loadEnemies()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T18:42:13.893

基本上这是对 Sabrina Le 答案的进一步解释。

您希望敌人对象本身有一个 bool 调用`bulletColliding`，并且在您的碰撞代码中它看起来更像......

```
public void bulletCollision(GameTime gameTime)
{
    foreach (var x in bullets)
    {
        foreach (var y in enemies)
        {
            enemy_rect = new Rectangle((int)y.position.X, (int)y.position.Y, 10, 10);
            bullet_rect = new Rectangle((int)x.position.X, (int)x.position.Y, 10, 10);
            if (bullet_rect.Intersects(enemy_rect))
            {
                y.bulletColliding = true;
            }
        }
    }
} 
```

然后你的敌人加载代码看起来更像......

```
//spawns the enemies.
public void LoadEnemies()
{
    int randY = random.Next(100, 500);
    if (spawn > 1)
    {
        spawn = 0;
        if (enemies.Count() < 4)
            enemies.Add(new Enemies(Content.Load<Texture2D>("meteor"), new Vector2(1110, randY)));
    }
    //Here's where the error lies because of the bulletcolliding (I think)
    for (int i = 0; i < enemies.Count; i++)
    {
        if (!enemies[i].isVisible || enemies[i].bulletColliding)
        {
            enemies[i].bulletColliding = false;
            enemies.RemoveAt(i);
            i--;
        }
    }
} 
```

通过严格地拥有一个`bulletColliding`变量，发生的事情是当任何流星被击中时，它被设置为 true。因此，当您的方法按顺序检查流星时，即使它检查第一个对象，它也会看到 bulletColliding 设置为 true，并且 if 中的代码运行。使用特定于敌人的布尔值会让你知道哪个敌人被击中，并相应地被移除。

# erlang - Yaws 示例文件

> ID：13211875
> 
> 赞同：2
> 
> 时间：2012-11-03T17:53:39.487
> 
> 标签：erlang, yaws

我目前正在尝试了解和查找使用 YAWS 的网页案例研究。除了源附带的默认页面外，任何人都知道我能找到的任何示例页面吗？

谢谢，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-11-10T16:01:55.043

[使用 Erlang 构建 Web 应用程序](http://shop.oreilly.com/product/0636920021452.do)可能是一本值得阅读的好书，但它假定读者已经对设置环境和基本的 yaws 想法有很多了解。

因此，您可以从[http://yaws.hyber.org/simple.yaws](http://yaws.hyber.org/simple.yaws)开始。

我总结了一些偏航的基本原理如下。我在 Ubuntu 上运行 yaws。

# 设置

## 安装

`sudo apt-get install yaws`并将`sudo apt-get install erlang`安装 erlang 和 yawk。

## 配置

`/etc/yaws/yaws.conf`是主要的配置文件。它会加载`conf.d/localhost.conf`，因此您可以像 Apache 或 Nginx 一样添加自己的配置。这是一个使用 8083 端口的示例。

```
<server localhost>
    port = 8083
    listen = 0.0.0.0
    docroot = /home/ubuntu/webapp/yaws/simple
</server> 
```

### 需要考虑的事项

在 Ubuntu 中，这些目录只能由 root 访问，因此您应该运行`sudo ..`或运行`sudo chmod g+rw ...`. 在后者中，您应该将您的帐户设置为 root 和 ssl-cert 组，并使用`sudo usermod -a -G ssl-cert ubuntu`.

## 使用 Nginx 网络服务器

您可以将 Nginx 用作后端，将 nginx 用作反向代理服务器。这是 /etc/nginx/site-enabled（链接到相应的 /etc/ngix/site-available）目录中的示例配置。

```
upstream yaws {
        server 127.0.0.1:8083;
        keepalive 8;
}

# the nginx server instance
server {
        listen 0.0.0.0:80;
        server_name yaws.example.com;
        access_log /var/log/yaws/access_yaws.log;
        error_log /var/log/yaws/error_yaws.log;

        location / {
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header Host $http_host;
            proxy_set_header X-NginX-Proxy true;

            proxy_pass http://yaws/;
            proxy_redirect off;
        }

        location /excluded {
            return 403;
        } 
} 
```

# 服务器测试

您可以使用 启动 yaws 服务器`sudo server yaws start`，并使用 来检查 yaws 是否正在运行`ps aux | grep yaws`。您可以使 yaws 服务器在启动时使用`sudo update-rc.d -f yaws enable`.

您还可以使用`yaws -i`命令交互地运行和测试 yaws 服务器。在这种情况下，如果您看到错误消息：

```
=ERROR REPORT==== 10-Nov-2015::09:44:33 ===
Yaws: Failed to listen 0.0.0.0:8443  : {error,eaddrinuse}

=ERROR REPORT==== 10-Nov-2015::09:44:33 ===
Can't listen to socket: {error,eaddrinuse} 
=INFO REPORT==== 10-Nov-2015::09:44:33 ===
    application: yaws
    exited: {{shutdown,
                 {failed_to_start_child,yaws_server,
                     {badbind,
                         [{yaws_server,start_group,2,
                              [{file,"yaws_server.erl"},{line,264}]},
                          {lists,filtermap,2,[{file,"lists.erl"},{line,1302}]},
                          {yaws_server,init2,5, 
```

yaws 服务器正在运行，因此您应该使用 停止 yaws 服务器`sudo service yaws stop`，然后`yaws -i`再次运行。然后你会看到提示，如果你按下回车键。

```
=INFO REPORT==== 10-Nov-2015::09:45:42 ===
Yaws: Listening to 0.0.0.0:8443 for <1> virtual servers:
 - https://localhost:8443 under /usr/share/yaws

=INFO REPORT==== 10-Nov-2015::09:45:42 ===
Yaws: Listening to 0.0.0.0:8083 for <1> virtual servers:
 - http://localhost:8083 under /home/ubuntu/webapp/yaws/simple

1> 
```

您可以运行许多命令，例如，您可以检查 yaws 找到 erlang 梁代码的路径`code:get_path().`

```
1> code:get_path().
["/usr/lib/yaws/ebin",".",
 "/usr/lib/erlang/lib/kernel-2.16.4/ebin",
 "/usr/lib/erlang/lib/stdlib-1.19.4/ebin",
 "/usr/lib/erlang/lib/xmerl-1.3.5/ebin", 
```

# 例子

## 静态文件

在配置中，您已经`/home/ubuntu/webapp/yaws/simple`使用 8083 端口访问 docroot，因此您可以访问静态文件：即 `http://...:8083/hello.html`.

## .yaws 文件

如果文件具有 .yaws 扩展名，yaws 会将其动态编译为 erlang 代码，并将源代码存储在`/var/cache/yaws/.yaws/yaws/debian_yaws/`.

### 静态 yaws 文件

您可以将 html 代码放在 yaws 文件中。

```
<html>

<h1>Hello world </h1>

</html> 
```

### erlang代码

你也可以放erlang代码。检查这`out(Arg) ->`是呈现为 HTML 的函数。

```
<html>
<h1> Yesssssss </h1>

<erl>
out(Arg) -> {html, "<h2> Hello again </h2>"}.
</erl>

</html> 
```

## 应用模式

您可以教 yaws 调用 erlang 代码。使用此配置：

```
<server localhost>
    port = 8083
    listen = 0.0.0.0
    docroot = /home/ubuntu/webapp/yaws/simple
    appmods = <pathelem, myappmod>
</server> 
```

当 Yaws 在 URL 中看到 pathelem 时，它会调用 myappmod 方法。对于应用模式，您应该制作 myappmod 模块。

```
-module(myappmod).
-author('klacke@bluetail.com').

-include("/usr/lib/yaws/include/yaws_api.hrl").
-compile(export_all).

box(Str) ->
    {'div',[{class,"box"}],
     {pre,[],Str}}.

out(A) ->
    {ehtml,
     [{p,[],
       box(io_lib:format("A#arg.appmoddata = ~p~n"
                         "A#arg.appmod_prepath = ~p~n"
                         "A#arg.querydata = ~p~n",
                         [A#arg.appmoddata,
                          A#arg.appmod_prepath,
                          A#arg.querydata]))}]}. 
```

然后，将其编译为光束二进制文件。

```
erlc myappmod.erl 
```

在交互模式下，作为“.” 已经在路径中，但在服务器模式或守护程序模式下，bean 应该在搜索路径之一中。在`/etc/yaws/yaws.conf`中，您可以更新 ebin 目录。

```
ebin_dir = /usr/lib/yaws/custom/ebin 
```

有了这个appmode，有了这个URL。

```
http://yaws.example.com:8083/zap/pathelem/foo/bar/x.pdf?a=b 
```

结果将是：

```
A#arg.appmoddata = "foo/bar/x.pdf"
A#arg.appmod_prepath = "/zap/"
A#arg.querydata = "a=b" 
```

我认为这是足够的信息，人们可以开始阅读其他文档。

# ruby-on-rails - RoR 未在 before_save 上创建嵌套记录

> ID：13211881
> 
> 赞同：1
> 
> 时间：2012-11-03T17:54:14.070
> 
> 标签：ruby-on-rails, ruby-1.9.2

我有一个模型站点，其中包含许多照片。

在站点模型中，我有

```
before_save :defaults
def defaults
    if self.photos.length ==0 && !SiteDefault.default_photo.nil?
      photo = Photo.new 
      photo.image = SiteDefault.default_photo.image
      self.photos.push photo  
    end 
end 
```

创建站点时，它不存储默认照片。为什么？

我在控制台中没有看到任何错误。图像正在正确上传到 Amazon S3。

# jquery - Toggle with first item open

> ID：13211882
> 
> 赞同：0
> 
> 时间：2012-11-03T17:54:23.087
> 
> 标签：jquery, toggle

I’m using the jQuery toggle function for my navigation. My problem is that by default all toggles are visible but I’d like only to have the first one open and the others closed.

[http://jsfiddle.net/TeDFs/1/](http://jsfiddle.net/TeDFs/1/)

HTML

```
<div id="authors" class="widget">
<h2 class="widget-title">Authors</h2>
<div class="toggle">
    <div class="submenu">
        <ul>
            <li>Name 1</li>
            <li>Name 2</li>
            <li>Name 3</li>
            <li>Name 3</li>
        </ul>
    </div>
</div> 
```

```
<div id="archives" class="widget">
<h2 class="widget-title">Archiv</h2>
<div class="toggle">
    <div class="submenu">       
        <ul>
                <li>November 2012</li>
            <li>Oktober 2012</li>
        </ul>
    </div>
</div>
</div>​ 
```

jQuery

```
function toggleWidgets() {
    jQuery('.widget-title').addClass('plus'); 

    jQuery('.widget-title').click(function() {
        $(this).toggleClass('plus').toggleClass('minus').next().toggle(180);
    });
} 

jQuery(document).ready(function() {
    toggleWidgets();
} )​ 
```

CSS

```
body {
    font-size: 0.875em; 
    line-height: 1.5em; 
}

h2 {
    font-size: 1.25em;
}

.plus {
    background: url(http://moargh.de/daten/sidebar_arrows.png) 0 -10px no-repeat;
    padding: 0 0 0 12px;
}
.minus {
    background: url(http://moargh.de/daten/sidebar_arrows.png) 0 5px no-repeat;
    padding: 0 0 0 12px;
} 
```

​</p>

* * *

Here’s the updated code: first toggle opened, second closed.

[http://jsfiddle.net/TeDFs/4/](http://jsfiddle.net/TeDFs/4/)

HTML (Changed class `widget-title` of the first item to `widget-title-visible` to inverse the arrows; added class `hidden` to second item to close it)

```
<div id="authors" class="widget">
<h2 class="widget-title">Authors</h2>
<div class="toggle">
    <div class="submenu">
        <ul>
            <li>Name 1</li>
            <li>Name 2</li>
            <li>Name 3</li>
            <li>Name 3</li>
        </ul>
    </div>
</div> 
```

```
<div id="archives" class="widget">
<h2 class="widget-title">Archiv</h2>
<div class="toggle hidden">
    <div class="submenu">       
        <ul>
            <li>November 2012</li>
            <li>Oktober 2012</li>
        </ul>
    </div>
</div>
</div>​ 
```

jQuery (Added inverse events for the class `widget-title-visible`)

```
function toggleWidgets() {
    jQuery('.widget-title').addClass('plus'); 

    jQuery('.widget-title-visible').addClass('minus'); 

    jQuery('.widget-title-visible').click(function() {
        $(this).toggleClass('minus').toggleClass('plus').next().toggle(180);
    });

    jQuery('.widget-title').click(function() {
        $(this).toggleClass('plus').toggleClass('minus').next().toggle(180);
    });
} 

jQuery(document).ready(function() {
    toggleWidgets();
} )​ 
```

CSS (Added class `hidden`, inverse background in classed `plus` and `minus`)

```
.hidden{
    display: none;
}

.plus {
    background: url(http://moargh.de/daten/sidebar_arrows.png) 0 5px no-repeat;
    padding: 0 0 0 12px;
}
.minus {
    background: url(http://moargh.de/daten/sidebar_arrows.png) 0 -10px no-repeat;
    padding: 0 0 0 12px;
} 
```

​</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T19:42:54.057

Create a style name `.hidden` like that :

```
.hidden{
    display:none;
} 
```

And apply to your toggle div like this : `<div class="toggle hidden">` Finally, inverse your arrows behaviour (plus and minus)

Updated fiddle : [http://jsfiddle.net/TeDFs/3/](http://jsfiddle.net/TeDFs/3/)

# iphone - iphone/ipad 应用程序未出现在 iPad 应用程序商店中

> ID：13211884
> 
> 赞同：3
> 
> 时间：2012-11-03T17:54:28.440
> 
> 标签：iphone, xcode, ipad, universal

我们正在使用 xcode 4.5.2 开发我们的第一个 iPhone 和 iPad 应用程序。它是一款通用应用程序，目标设备系列 = iPhone/iPad。在 iPhone 和 iPad 的模拟器上运行良好，但当分发给 Apple 时，它​​只显示在 iPhone 的应用商店中。在 iPad 应用商店上。. . 没有什么。

当您在线搜索时，您可以在浏览器中找到 iTunes 页面（https://itunes.apple.com/us/app/episurveyor/id499388914?mt=8），但请注意“要求：兼容 iPhone 3G、iPhone 3GS、iPhone 4、iPhone 4S 和 iPhone 5。” 没有列出 iPad。如果您在 iPad 上进行搜索，您可以在 Safari 中找到相同的页面，但随后会启动应用商店并显示“您请求的项目目前在美国商店中不可用。”

我们缺少什么设置？我知道这一定很简单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:04:45.660

问题解决了！Apple 告诉我这是因为我们已将 SMS 指定为必需功能——但 iPad 没有任何 SMS 功能，因此它认为它无法在 iPad 上运行。删除了 SMS 要求并重新提交。

# asp.net - 循环表格行后无法为每个控件获取唯一 ID

> ID：13211887
> 
> 赞同：1
> 
> 时间：2012-11-03T17:54:36.583
> 
> 标签：asp.net, html, vb.net, visual-studio-2010

我正在循环整个表格以及控件。对于每一行，用户可以输入一个数字来执行计算并显示在同一行的标签中，但它会继续影响所有其余的行，因为它们处于循环中，因此每个控件没有唯一的 id。

[代码]

```
<%@ Page Title="" Language="VB" MasterPageFile="~/public.master" AutoEventWireup="false" CodeFile="ccalc.aspx.vb" Inherits="ccalc" %>

<%@ Import Namespace="System.Data" %>

<%@ Import Namespace="System.Data.OleDb" %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder2" Runat="Server">

    <div>
  <h1>Estimated Monthly Electricity Consumption Calculator</h1>
</div>
<div>
    <%

    Dim id As Integer
    Dim catname As String

    Dim db As New databaseconnection
    Dim cmd As New OleDbCommand
    cmd.Connection = db.connection
    cmd.CommandText = "select * from ecg_projectDB2.dbo.DeviceCategory"
    cmd.CommandType = CommandType.Text
    Dim dr As OleDbDataReader
    dr = cmd.ExecuteReader
    Dim found As Boolean = False
    While dr.Read
        found = True
        id = dr("CategoryID")
            catname = dr("CategoryName")

        %>    

<table width="100%" cellpadding="5" cellspacing="1" bgcolor="#FFFFFF" class="ten">
                      <tbody>
                        <tr>
                          <td colspan="5"><h2><% Response.Write(catname)%></h2></td>
                        </tr>
                        <tr align="center">
                          <th class="style1" bgcolor="#FFCC66">Electrically Powered Items</th>
                          <th class="ten" bgcolor="#FFCC66"><div align="center">Quantity</div></th>
                          <th class="ten" bgcolor="#FFCC66"><div align="center">Average
                            monthly KWh</div></th>
                          <th class="ten" bgcolor="#FFCC66"><div align="center">KWh/month</div></th>
                          <th class="ten" bgcolor="#FFCC66"><div align="center">GHc /month</div></th>
                        </tr>

                       <%
                           Dim appid As Integer
                           Dim appname As String
                           Dim wpm As Single

                           Dim brb As New OleDbCommand
                           brb.Connection = db.connection
                           brb.CommandText = "select * from ecg_projectDB2.dbo.Appliances where CategoryID = '" & id & "'"
                           brb.CommandType = CommandType.Text
                           Dim br As OleDbDataReader
                           br = brb.ExecuteReader
                           Dim ins As Boolean = False
                           Dim counter As Integer = 0
                           While br.Read
                               ins = True
                               appid = br("ApplianceID")
                               'quantity.ID = appid

                               kwh.ID = appid
                               ghc.ID = appid

                               appname = br("ApplianceName")
                               wpm = br("Wattpermin")

                               counter = counter + 1

                               Dim qid = quantity.id
                               Dim kwhid = kwh.ID

                               Dim totusage As Single
                               'Label1.Text = quantity.ID

                               If IsPostBack Then

                                   Dim aaa = quantity.ID

                                   If counter  Then
                                       'Dim MainContent As ContentPlaceHolder = CType(Page.Master.FindControl("MainContent")

                                       kwh.Text = quantity.UniqueID

                                       'kwh.Text =  Results.text

                                   End If

                                   End If

                           %>

                        <tr>
                          <td class="style1"><strong><% Response.Write(appname)%></strong></td>
                          <td class="highlight"><div align="center">

                              <asp:TextBox ID="quantity" runat="server" AutoPostBack="True" CssClass="input" 
                                  Width="79px" ></asp:TextBox>
&nbsp;&nbsp;</div></td>
                          <td><div align="center">
                            <input name="refrigeratorMonthKWh" value="182" type="hidden" />
                              <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>
                          </div></td>
                          <td><div align="center">
                              &nbsp;<asp:TextBox ID="kwh" runat="server" CssClass="input4" Width="59px"></asp:TextBox>
                          </div></td>
                          <td><div align="center">
                              &nbsp;<asp:TextBox ID="ghc" runat="server" CssClass="input4" Width="59px"></asp:TextBox>
                          </div></td>
                        </tr>

                        <%

                        End While
                        brb.Dispose()
                        br.Close()

                            %>

                      </tbody>
                    </table>

                    <%

                End While
                cmd.Dispose()
                dr.Close()

                       %>

</div>
    <% 

     %>
<div>

<table width="100%" border="0" cellpadding="5" bgcolor="#FFF7E5" class="ten">
                      <tbody>
                        <tr>
                          <td><font color="#9f7f40">Estimated</font> monthly <u><font color="#FF0000">household </font></u>*
                            usage:
                              <asp:TextBox ID="totalusage" runat="server" CssClass="input4" Width="59px"></asp:TextBox>
&nbsp;kWh; <br /></td>
                        </tr>
                        <tr>
                          <td class="highlight"><font color="#9f7f40">Estimated</font> monthly <u><font color="#FF0000">household</font></u>*
                            bill: &cent;
                                                    <asp:TextBox ID="totalbill" runat="server" 
                                  CssClass="input4" Width="59px"></asp:TextBox>
                            </td>
                        </tr>
                        <tr>
                          <td class="highlight"><h3><strong><em>*Heating usage
                            not included in household totals</em></strong></h3></td>
                        </tr>
                      </tbody>
                    </table>

</div>

</asp:Content>
<asp:Content ID="Content3" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">
</asp:Content> 
```

[/代码]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T20:10:23.050

you should really consider using **Asp.net Repeater Control**. The way you doing things is NOT optimal, this is Classic Asp Approach, and you should stay away from it.

in your approach you have to use client side html controls (same as classic asp) and access them using Request Object.

# ef-code-first - EF Code First + 删除标记为已修改的孤儿（IsDeleted = 1）

> ID：13211889
> 
> 赞同：2
> 
> 时间：2012-11-03T17:54:39.090
> 
> 标签：ef-code-first, repository-pattern

我有下一个问题。我的代码上下文+模型：

```
public class MediaPlanContext : DbContext
{
    public MediaPlanContext() : base(lazyLoading:false) {}

    public DbSet<MediaPlan> MediaPlan { get; set; }
    public DbSet<MovieType> MovieType { get; set; }
    public DbSet<MediaPlanItem> MediaPlanItems { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);

        modelBuilder
            .Entity<MediaPlanItem>()
            .HasKey(mpi => new {mpi.Id, mpi.MediaPlanId});
        modelBuilder
            .Entity<MediaPlanItem>()
            .Property(mpi => mpi.Id)
            .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);
        modelBuilder
            .Entity<MediaPlan>()
            .HasMany(mp => mp.MediaPlanItems)
            .WithRequired()
            .HasForeignKey(mpi => mpi.MediaPlanId)
            .WillCascadeOnDelete();
    }        
}

public class MediaPlan : IBaseObject
{
    public virtual ICollection<MediaPlanItem> MediaPlanItems { get; set; }
}

public class MediaPlanItem : IBaseObject
{
    public int MediaPlanId {get;set;}
    public MediaPlan MediaPlan {get;set;} 
}

public interface IBaseObject
{
    public int Id {get;}
    public DateTime DateCreated {get;}
    public DateTime DateModified {get;set;}
} 
```

我还使用存储库来处理我的对象 ( `IBaseObject-s`) 与根对象 MediaPlan。当我的数据库中的对象将被删除时，我将实体（记录）标记为`IsDeleted = 1`，并且我的存储库类中有一些逻辑可以将常规删除处理为更新，更改`EntityState`为`Modified`而不是`Deleted`.

下一个代码的问题：

```
var rep = new MediaPlanRepository(new MediaPlanContext());
var withItems = rep.GetWithMediaPlanItems();
var m1 = withItems.First();
var mpi1 = m1.MediaPlanItems.First();
m1.MediaPlanItems.Remove(mpi1); // 6 items before remove
// 5 items after remove
rep.SaveChanges();
// 6 items after save changes :( 
```

问题：我可以处理 saveChanges 发生后的那一刻并分离我的`IsDeleted = 1`实体吗？是解决我的问题吗？

备注：相关实体作为[投影](http://thedatafarm.com/blog/data-access/use-projections-and-a-repository-to-fake-a-filtered-eager-load/)加载到根对象，正如 Julie 在“可能无法按预期工作的场景”段落中所说的那样，可能会对已经被上下文跟踪的实体产生问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T08:42:38.423

代码：

```
public override int SaveChanges()
{
    var result = base.SaveChanges();
    // AfterSave code
    var isDeletedEntities = EfContext.ChangeTracker
        .Entries()  
        .Select(dbE => new {  
             DBEntity = dbE,  
             BaseObject = (dbE.Entity as IBaseObject)})  
        .Where(dbe => dbe.BaseObject.IsDeleted);  

    foreach (var isDeletedEntity in isDeletedEntities)  
    {  
        isDeletedEntity.DBEntity.State = EntityState.Detached;  
    }
} 
```

# assembly - 如何解析 If-Else 括号

> ID：13211892
> 
> 赞同：0
> 
> 时间：2012-11-03T17:55:02.220
> 
> 标签：assembly, compiler-construction, if-statement

在我的 C 类编程语言中，我希望编译器解析 If-Else 括号。我有一些代码，例如：

```
if( varA == varB ) {
  if ( varB == varC ) {
   varA = 1;
  } else {
   varB = 1;
  }
}; 
```

并希望它解析为此（虚构的汇编程序）：

```
compare varA with varB
jump if equal to condition_2
jump to else_condition2  ; gets only executed if statement above does not get executed -> else

label condition_2:
compare varB with varC
jump if equal to if_bracket_1
jump to else_bracket_1

label if_bracket_1:
varA = 1;
jump to back_label

label else_bracket_1:
varB = 1;
jump to back_label 

label else_condition2: 
; nothing, because there is no else

label back_label:
nop ; continue main program here 
```

我知道如何将条件解析为 jump-if-equal 等等，我知道解析方法将是递归的..但我不知道如何实现这个解析方法..我不需要代码，只需一个想法，如何管理这个。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T07:07:02.520

目前还不清楚你在问什么。据我了解，您在解析源代码或生成代码时遇到了一些问题。

对于解析部分，如果您想手动编写，可以轻松使用[递归下降技术。](http://en.wikipedia.org/wiki/Recursive_descent_parser)基本上，您编写函数来解析每个语法类——例如表达式、块、语句，如 if、while 和 for。你让他们递归地互相调用。通常解析器函数返回 AST 节点，调用者将它们组合在一个更大的节点中。

在您的示例中，您将拥有一个用于解析逻辑表达式、if 语句、表达式/语句块和 if 语句的函数。当您`if`在令牌流中看到 时，您就知道后面跟着一个 if 语句，因此您可以调用适当的解析函数，比如`parse_if`. 由于语法`parse_if`知道并且`if`语句应该看起来像`if (<logical expression>) <block> [else <block>]`--方括号表示可选块，有角度的块是强制性的。因此，您首先递归调用用于解析逻辑表达式的函数，例如`parse_logical_exp`. 这将返回 if 语句的逻辑表达式的 AST 节点，您可以稍后将其插入最终的 AST。then 块也是如此。如果，在你完成 then 块之后，你遇到一个`else`在令牌流中，您再次调用块解析函数。如果没有一个子函数发出错误信号，那么你很好，所以你最终可以为 if 语句构建你的 AST 并将其返回给你的调用者。在（Python）伪代码中：

```
def parse_if(tokens):
    # Skip over the if token or signal an error if the current token is not an "if"
    tokens.expect("if")
    logical_condition = parse_logical_exp(tokens)
    if logical_condition is Error:
        raise ParseError(logical_condition.message)
    then_block = parse_block(tokens)
    if then_block is Error:
        raise ParseError(then_block.message)
    else_block = None
    if tokens.current() == "else":
        # Skip over the else token or signal an error
        tokens.expect("else")
        else_block = parse_block(tokens)
        if else_block is Error:
            raise ParseError(else_block.message)
    return IfNode(logical_condition, then_block, else_block) 
```

请注意，这只是一些伪代码，您可能希望以不同的方式进行错误检查/报告。

您可能提到的问题称为[“悬空其他问题”](http://en.wikipedia.org/wiki/Dangling_else)。基本上你不能告诉如果一个 else 属于哪个。引用维基百科文章：

> 处理悬空 else 时的约定是将 else 附加到附近的 if 语句，特别是允许明确的上下文无关语法。像 Pascal 和 C 这样的编程语言遵循这个约定，所以语言的语义没有歧义

对于代码生成部分，您可能对以下问题的回答感兴趣：[在字节码编译器中计算跳转地址的智能解决方案？](https://stackoverflow.com/questions/13094001/intelligent-solution-to-computing-jump-addresses-in-a-bytecode-compiler).

# c# - NoSuitableGraphicsDeviceException 添加线时出现 graphics.ApplyChanges();

> ID：13211896
> 
> 赞同：0
> 
> 时间：2012-11-03T17:55:28.023
> 
> 标签：c#, xna

我刚开始在xna中学习c#，我正在制作一个简单的塔防游戏。添加行时收到错误消息。

```
graphic.ApplyChanges(); 
```

[这](http://imageshack.us/photo/my-images/59/errorziw.png/)是错误消息屏幕截图的链接。当我开始游戏时，它会运行几秒钟，然后关闭并显示此消息。在此之前我已经制作了一些其他游戏，我之前从未遇到过这个问题。我是编程的初学者，所以如果您需要了解其他信息来帮助我，请告诉我。

更新：我试图在一个新项目中重现该错误，但没有成功。我将在这里发布我的代码，以便比我有更多知识的人可以阅读它，并可能找到导致错误的原因。

Game1 类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.GamerServices;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Media;

namespace AdventureGame
{
/// <summary>
/// This is the main type for your game
/// </summary>
public class Game1 : Microsoft.Xna.Framework.Game
{

    GraphicsDeviceManager graphics;
    SpriteBatch spriteBatch;
    Texture2D tilegraphic;
    MouseState oldmouse;
    MouseState currentmouse;
    Point mouseposition;
    Color defaultcolor;
    Color selectedcolor;
    Color pathcolor;

    public Game1()
    {
        graphics = new GraphicsDeviceManager(this);
        Content.RootDirectory = "Content";
        graphics.PreferredBackBufferWidth = 800;
        graphics.PreferredBackBufferHeight = 600;

    }

    /// <summary>
    /// Allows the game to perform any initialization it needs to before starting to run.
    /// This is where it can query for any required services and load any non-graphic
    /// related content.  Calling base.Initialize will enumerate through any components
    /// and initialize them as well.
    /// </summary>
    protected override void Initialize()
    {

        IsMouseVisible = true;
        // TODO: Add your initialization logic here
        base.Initialize();
        oldmouse = new MouseState();
        currentmouse = new MouseState();
        defaultcolor = new Color();
        selectedcolor = new Color();
        defaultcolor = Color.LawnGreen;
        selectedcolor = Color.DarkGreen;
        pathcolor = Color.SaddleBrown;

    }

    /// <summary>
    /// LoadContent will be called once per game and is the place to load
    /// all of your content.
    /// </summary>
    protected override void LoadContent()
    {

        // Create a new SpriteBatch, which can be used to draw textures.
        spriteBatch = new SpriteBatch(GraphicsDevice);
        tilegraphic = Content.Load<Texture2D>("tilegraphic") as Texture2D;

        // TODO: use this.Content to load your game content here
    }

    /// <summary>
    /// UnloadContent will be called once per game and is the place to unload
    /// all content.
    /// </summary>
    protected override void UnloadContent()
    {
        // TODO: Unload any non ContentManager content here
    }

    /// <summary>
    /// Allows the game to run logic such as updating the world,
    /// checking for collisions, gathering input, and playing audio.
    /// </summary>
    /// <param name="gameTime">Provides a snapshot of timing values.</param>
    protected override void Update(GameTime gameTime)
    {

        oldmouse = currentmouse;
        currentmouse = Mouse.GetState();
        mouseposition = new Point(currentmouse.X, currentmouse.Y);

        // Allows the game to exit
        if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
            this.Exit();

        // TODO: Add your update logic here

        base.Update(gameTime);
    }

    /// <summary>
    /// This is called when the game should draw itself.
    /// </summary>
    /// <param name="gameTime">Provides a snapshot of timing values.</param>
    protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.White);

        spriteBatch.Begin();

        DrawMap();

        spriteBatch.End();
        // TODO: Add your drawing code here

        base.Draw(gameTime);
    }

    public bool MouseJustPressed()
    {
        if (oldmouse.LeftButton == ButtonState.Released && currentmouse.LeftButton == ButtonState.Pressed)
        {
            return true;
        }
        else
        {
            return false;
        }
    }

    public void DrawMap()
    {
        Map1 map = new Map1();
        map.Layout();
        map.CreateRectangles();
        for (int x = 0; x < map.mapwidth; x++)
        {
            for (int y = 0; y < map.mapheight; y++)
            {
                switch (map.tiles[x, y])
                {
                    case 0:
                        if (map.tilerectangles[x, y].Contains(mouseposition))
                        {
                            spriteBatch.Draw(tilegraphic, map.tilerectangles[x, y], selectedcolor);
                        }
                        else
                        {
                            spriteBatch.Draw(tilegraphic, map.tilerectangles[x, y], defaultcolor);
                        }
                        break;
                    case 1:
                        spriteBatch.Draw(tilegraphic, map.tilerectangles[x, y], pathcolor);
                        break;
                }

            }   

        }
    }
}
} 
```

Map1 类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.GamerServices;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Media;

namespace AdventureGame
{
class Map1
{
    public int[,] tiles = new int[7, 7];
    public Rectangle[,] tilerectangles = new Rectangle[8, 8];
    Game1 game = new Game1();
    public int mapwidth = 8;
    public int mapheight = 8;
    public void Layout()
    {
        tiles = new int[,] {
        {0,1,0,0,0,0,0,0},
        {0,1,0,1,1,1,1,1},
        {0,1,0,1,0,0,0,0},
        {0,1,0,1,1,1,1,0},
        {0,1,0,0,0,0,1,0},
        {0,1,0,0,0,0,1,0},
        {0,1,1,1,1,1,1,0},
        {0,0,0,0,0,0,0,0},};
    }

    public void CreateRectangles()
    {
        for (int x = 0; x < mapwidth; x++)
        {
            for (int y = 0; y < mapheight; y++)
            {
                tilerectangles[x, y] = new Rectangle(x * 70, y * 70, 70, 70);
            }

        }

    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T19:22:01.720

将行放在 Initialize() 方法中的行`Graphics.ApplyChanges()`之后`base.Initialize()`或方法的开头`LoadContent()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T15:15:52.037

我发现代码中有什么问题。当我`Game1 game = new Game1();`在我的方法中添加该行以`DrawMap()`进行快速测试以查看它到目前为止是否有效时，程序显然不喜欢这样并给了我一个错误。因此，当我用我的其余变量声明它并将该行`map = new Map1();`放在初始化方法中时，它工作得很好。谢谢你在这里得到的帮助。

# c++ - 在函数中使用结构对象

> ID：13211899
> 
> 赞同：0
> 
> 时间：2012-11-03T17:55:31.480
> 
> 标签：c++, function, windows-7, struct

我已经为队列编写了一段代码。

```
#include <iostream>
using namespace std;

struct q
        {
            int items[10];
            int front,rear;
        } queue;

void Addqueue(struct q *queue, int item)
{
    if (queue->rear==9)
        cout << "Queue is Full.";
    else
        queue->items[++queue->rear]=item;
}

int main()
{
    queue.front=queue.rear=-1;
    Addqueue(q *queue,5);
    return 0;
} 
```

正如你所看到的，我已经使用了 struct object。在 Addqueue Function 中，第一个元素是 (struct q *queue)，我想知道我应该写什么来代替它，同时我在 main 函数中调用这个函数，例如我测试了 Addqueue(q *queue,5) 和Addqueue(queue,5) 和 Addqueue(*queue,5) 和 Addqueue(struct q *queue,5)，但它们都不起作用，我将收到此行的错误。所以我该怎么做？怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:00:33.160

正确的语法是`Addqueue(&queue, 5)`. `Addqueue`接受指向 a 的指针`struct q`，因此您需要获取`queue`带有地址的地址`operator&`才能传入。

也就是说，您绝对应该使用[`std::queue<int>`](http://www.cplusplus.com/reference/stl/queue/)而不是您自己的本地队列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T18:03:33.843

```
#include <iostream>
using namespace std;

struct q
{
    int items[10];
    int front,rear;
} queue;

void Addqueue(q *queue, int item)
{
    if (queue->rear==9)
        cout << "Queue is Full.";
    else
        queue->items[++queue->rear]=item;
}

int main()
{
    queue.front=queue.rear=-1;
    Addqueue(&queue, 5);
    return 0;
} 
```

这是正确的方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T18:06:30.630

您创建了指向 struct的指针`q`，但它没有分配内存。并且指针的本地名称`q *queue`会覆盖您的对象`queue`。

# javascript - 如何添加时间加并重新计算日期时间

> ID：13211901
> 
> 赞同：1
> 
> 时间：2012-11-03T17:55:32.960
> 
> 标签：javascript, jquery, datetime, increment

我有这个日期时间格式：

```
Oct 31, 2012 08:59:52 
```

我想重新计算增加的​​日期时间（例如）2 小时或 50 分钟加上我该怎么做？

我需要返回上面显示的相同日期时间格式，而不是时间戳！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:59:54.613

```
var date = new Date("Oct 31, 2012 08:59:52");
var timeInMillis = date.getTime(); 
```

现在您有以毫秒为单位的时间，您可以添加您想要的以毫秒为单位的时间。

例如：2 小时？所以，2*60*60*1000 + timeInMillis

```
var newDate = new Date(2*60*60*1000 + timeInMillis); 
```

如果您想将 newDate 转换为原始格式，这是一个漫长的过程，您可以从这里获得一些指导：

[在哪里可以找到有关在 JavaScript 中格式化日期的文档？](https://stackoverflow.com/questions/1056728/formatting-a-date-in-javascript)

我选择的答案是：

使用[MomentJS](http://momentjs.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T18:00:13.637

您可以先将其解析为日期：

```
var d=new Date("October 31, 2012 08:59:25").getTime(); 
```

然后添加偏移量：

```
d+= (seconds)*1000 + (minutes)*60000 + (hours)*3600000;
var result = new Date(d); 
```

我只是不确定它是否接受“十月”而不是“十月”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T18:00:08.157

```
time_start = new Date(year, month, day, hours, minutes, seconds, milliseconds);
time_finish = new Date() - time_start; 
```

使用上面列出的格式设置日期。要计算两个时间点之间的间隔，只需从过去日期中减去当前日期即可。

# java - 将 txt 文件中的信息排序到两个不同的数组中

> ID：13211907
> 
> 赞同：1
> 
> 时间：2012-11-03T17:56:02.120
> 
> 标签：java, arrays, import

对于 uni 分配，我必须从文本文件中获取输入并将其分类为两个单独的数组。文本文件是一个足球联赛表，排列如下：
巴塞罗那 34
皇家马德里 32

我写了一段这样的代码：

```
holdingString = fileInput.readLine ();                
StringTokenizer sort = new StringTokenizer (holdingString + " "); 
countOfTokens = sort.countTokens();
System.out.println (countOfTokens + " tokens: " + holdingString); 
```

这将打印出令牌的数量以及每行的令牌是什么，因此它给出了
两个令牌的输出：Barcelona 34
三个令牌：Real Madrid 32

然后我写了这段代码：

```
for (int i = 0; i < countOfTokens; i++)
 {
  String temp = sort.nextToken ();          
  System.out.println(temp);
 } 
```

这只会读取下一个令牌并将其打印出来。
但是，我不想打印下一个标记，而是检查它是一个单词还是一个数字，并相应地将它分成不同的数组，所以它会是这样的：
ArrayTeam Zero Element Barcelona
ArrayTeam First Element Real Madrid
ArrayPoints Zero元素 34
ArrayPoints 第一个元素 32

最简单的方法是什么？我尝试过使用 try/catch，但没有做对。我也尝试过使用带有 \d 的 if 语句，但这也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:58:10.673

您可以使用[`split`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#split%28java.lang.String%29)

```
String strs[] = holdingString.split("\\s"); 
```

例如

```
"Barcelona 34".split("\\s"); will return you Array of Strings where 
 array[0]=Barcelona  array[1]=34 
```

来自 Javadoc[`StringTokenizer`](http://docs.oracle.com/javase/6/docs/api/java/util/StringTokenizer.html)

> StringTokenizer 是一个遗留类，出于兼容性原因保留，但不鼓励在新代码中使用它。建议任何寻求此功能的人改用 String 的 split 方法或 java.util.regex 包。

**更新** 正如@madhairsilence 指出的那样，您需要另一个分隔符。您可以使用`=`类似的属性文件

```
"Real Madrid =34".split("=");//will return you Array of Strings where 
 array[0]=Real Madrid, array[1]=34 
```

您可以在读取文件时使用[扫描仪。](http://docs.oracle.com/javase/6/docs/api/java/util/Scanner.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T18:01:30.200

您可以使用 java.util.Scanner 类从文件中读取数据。它具有诸如 nextInt()、nextDouble 之类的方法……这在您的情况下可能很有用。

```
Scanner scan = new Scanner(file);
int number;
if(scan.hasNextInt()){
    number = scan.nextInt();
 } 
```

检查[扫描仪 API](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T18:02:43.627

像 AmitD 一样，我同意 using`split`在这种情况下更合适，但如果您仍然喜欢使用 a `StringTokenizer`，您可以执行以下操作：

```
StringBuilder teamName=new StringBuilder();
for (int i = 0; i < countOfTokens-1; i++)
{
  if (i>0) teamName.append(' ');
  teamName.append(sort.nextToken());          
}
teamNames[k]=teamName.toString(); //add the new team to your teamNames array
points[k]=Integer.parseInt(sort.nextToken()); //if your points array is of int type 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T18:10:47.853

```
String readLine = "Real Madrib 40";

        String[] team = readLine.split( "\\d" );        
        System.out.println(team[0]);

        String score = readLine.replace( team[0],"" );      
        System.out.println(score); 
```

**输出 ：**

team[0] : 皇家马德里

分数：40

# azure - Azure 通配符子域

> ID：13211908
> 
> 赞同：1
> 
> 时间：2012-11-03T17:56:20.587
> 
> 标签：azure, subdomain

我有一个保留的天蓝色网站，我一直在关注这篇文章 - [http://www.stratospher.es/blog/post/wildcard-subdomains-in-windows-azure](http://www.stratospher.es/blog/post/wildcard-subdomains-in-windows-azure)

我添加了一个指向 mysite.azurewebsites.net 的通配符 cname 记录

通过 azure 管理门户 --> 管理域。我在域名列表中添加了一个条目：

test1.mysite.com

如果我浏览到这个 url，它会完美运行。但是，如果然后尝试 test2.mysite.com，我会得到 404。如果我要将 test2.mysite.com 添加到 azure 的域名列表中，那么 test2.mysite.com 就可以了。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T10:17:06.373

我收到了上述文章作者的回复。基本上，当他写道 Azure 网站不存在时，他使用的是 azure 云应用程序。

在云应用程序中，如果您想使用自己的域，只需将其指向whatever.cloudapp.net。您不需要像在 azure 网站中那样验证“自定义”域。

# javascript - 非属性分配变量是可删除的

> ID：13211913
> 
> 赞同：3
> 
> 时间：2012-11-03T17:56:36.827
> 
> 标签：javascript, properties, attributes

我正在阅读有关 Javascript方法的[这篇文章](http://perfectionkills.com/understanding-delete/)`delete`，并尝试了以下代码：

```
function f(){
    var x = "abcd";
    console.log(delete x); //returns false, because x has DontDelete attribute
    y = "abcd";
    console.log(delete y); //returns true, but I didn't explicitly assign y as a property
} 
```

这很奇怪，因为我没有使用属性赋值`y`（如：） `window.y="abcd";`，文章[声称](http://perfectionkills.com/understanding-delete/#property_attributes)这是你如何使属性`delete`能够。

为什么没有`y`属性`DontDelete`？

**更新：**

在下面的答案中，声称 y 是可删除的，仅仅是因为它是`window`对象的属性。那不是真的。考虑以下代码段：

```
function f() {
    var functionx = "abcd";
    console.log(delete functionx); //returns false, because x has DontDelete attribute
    functiony = "abcd";
    console.log(delete functiony); //returns true, but I didn't explicitly assign functiony as a property to the window
}

//take 1
var globalx = "abcd";
console.log(this.globalx);//to prove x is a property of the global
console.log(delete globalx);//fails, even though x is a property of the window

//take 2
this.globaly = "abcd";
console.log(this.globaly);//to prove y is a property of the global
console.log(delete globaly);//succeeds, because I used property assignment

f(); 
```

在 take 1 中，`globalx`是窗口的一个属性，但它仍然不可删除。是否`delete`成功的标准不是变量是否是某物的属性（始终为真），而是该属性是否具有`DontDelete`属性集。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T17:58:22.890

`delete x`无效，因为它不解析为任何对象属性。

`y`解析为`window`对象的属性。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/delete](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/delete)：

> 删除*表达式*
> 
> 其中*表达式*应计算为属性引用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:58:38.267

JavaScript[中的变量是使用`var`关键字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var)声明的。当您省略`var`时，解释器开始寻找定义给定变量的最近范围。如果未找到给定变量，[它将作为全局对象上的新属性创建](http://perfectionkills.com/understanding-delete/#undeclared_assignments)。

这正是这里发生的事情：

*   变量`y`被引用并分配了一个新值 ( `abcd`)
*   Var`y`没有在任何地方定义 → 新的全局属性`y`被创建并赋值（有效地`window.y = "abcd"`）。
*   结果，`y`成为全局对象的属性，可以删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T18:13:48.513

这是第二个示例的扩展版本：

```
window.y = "abcd";
console.log(delete window.y); 
```

现在很明显发生了什么。

如果您不使用`var`关键字，则解释器假定该变量是全局对象的属性（通常是`window`），[如此 JSFiddle](http://jsfiddle.net/kendfrey/Y4yj8/)所示。注意在全局范围内，`this`是和`window`对象一样的。

回复：更新：

在函数之外，使用声明的变量`var`被定义为全局对象的**不可配置**属性。这在[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var)中有详细说明，其中说：

> 在函数外部使用`var`是可选的；为未声明的变量赋值隐含地将其声明为全局变量（也是全局对象的属性）。不同之处在于声明的变量是全局对象的不可配置属性，而未声明的变量是可配置的。

在函数内声明变量并不会将其分配给全局属性，而是分配给局部变量。

这解释了您在全局范围内定义变量时看到的行为。

# activerecord - Rails ActiveRecord 按日期查找/搜索

> ID：13211916
> 
> 赞同：8
> 
> 时间：2012-11-03T17:57:03.233
> 
> 标签：activerecord, ruby-on-rails-3.2

我正在尝试按“created_at”日期查找记录-数据库列类型是“日期时间”，我正在使用来自 jQuery 的 UI DatePicker

我的网址如下所示：“localhost:3000/users_supported?selected_date=2012-10-31”

到目前为止我做得很好:) 我在控制器中的查询如下所示：

```
@support_histories = current_agent.support_histories.where(:created_at => Date.parse(params[:selected_date])) 
```

如何仅从“日期时间”数据库列中按“日期”正确提取记录

我尝试在 Rails 控制台中执行此操作，但没有运气：

```
sh = SupportHistory.where(:created_at => DateTime.parse('2012-10-31'))
sh = SupportHistory.where(:created_at => Date.parse('2012-10-31'))
sh = SupportHistory.where(:created_at => DateTime.strptime('2012-10-31', '%Y-%m-%d')) 
```

如果我确实像下面提到的那样，我会得到记录，但这对我没有用，因为我试图按“日期”而不是“日期时间”查找记录

```
sh = SupportHistory.where(:created_at => '2012-10-31 19:49:57') 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-04T03:33:00.827

```
selected_date = Date.parse(params[:selected_date])
# This will look for records on the given date between 00:00:00 and 23:59:59
sh = SupportHistory.where(
       :created_at => selected_date.beginning_of_day..selected_date.end_of_day) 
```

时区可能是您需要考虑的问题，但如果您的所有时间都在同一个时区，这应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-31T13:16:58.547

我有时使用的一个简单解决方案是将日期（时间）字段转换为数据库上的文本，而不是在应用程序端将字符串解析为日期。对于您的情况，这将是：

```
where('CAST(created_at AS text) LIKE ?', params[:selected_date]) 
```

在数据库上可能不是最有效的（取决于您使用它的上下文），但在应用程序端节省了大量的皮塔。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-26T16:29:08.723

我通过在下面的模型中创建一个方法解决了这个问题，比如说，我的模型是 ticket.rb

```
 def created_date
   self.created_at.to_date
 end 
```

然后我这样查询，

```
 selected_date = Date.parse(params[:date])

 Ticket.all.map{|t| t if t.created_date == selected_date}.compact 
```

这为我提供了与用户选择的日期相匹配的准确结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-23T14:55:27.880

您当前的查询不起作用，因为您正在查询**日期**时间列上的**日期**。这是两种不同的数据类型。

对于日期时间列，您需要一个日期时间过滤器。您可以通过将`DateTime`对象传递给 where 子句来做到这一点。但是，在您的情况下，您需要一整天的记录，因此您将指定介于`00:00:00`和之间的范围`23:59:59`。

**在 Rails 5.1 之前：**

```
SupportHistory.where(created_at: date.beginning_of_day..date.end_of_day) 
```

**Rails 5.1 及更高版本：（这将使用**[#all_day](https://www.bigbinary.com/blog/rails-5-1-has-introduced-date-all_day-helper)生成完全相同的范围）

```
SupportHistory.where(created_at: date.all_day) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-23T11:23:08.067

如果要解析特定的日期时间

```
SupportHistory.where("created_at>=?", DateTime.parse('10 Dec 2021 11:54:00 PST -08:00')) 
```

# javascript - 在服务器上提供本地货币格式 i18n，进程在客户端

> ID：13211917
> 
> 赞同：1
> 
> 时间：2012-11-03T17:57:03.960
> 
> 标签：javascript, rest, localization, internationalization, locale

我们需要根据用户的语言环境以不同的格式显示金额/数字。该信息通过 REST API 提供。

```
fr = 1 234 567,89
en-us = 1,234,567.89
de = 1.234.567,89 
```

一种方法是在服务器端完全处理它。另一种方法是使用诸如 dojo/i18n 之类的库在客户端完全处理它。

但是我想知道是否可以通过 API 以某种方式提供数字格式（仅格式不是数字本身），然后在客户端格式化数字（使用 javascript）。知道怎么做吗？我的意思是“格式”应该是什么样子以及如何渲染/处理它，以便它可以用作在客户端格式化数字的模式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:14:26.700

可以办到。许多 javascript 框架都有本地化的日期和数字格式化程序。通常格式是静态的，因此您可以在 config.js 中对它们进行硬编码。如果这还不够，您可以在服务器上的 config.js 中渲染它们。您甚至可以本地化该资源服务器端以减少通过网络发送的代码量。

您还可以提供一个 API，您可以在其中获取客户端语言环境的格式，但这对我来说似乎有点过分了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T18:14:36.350

看看[全球化](https://github.com/jquery/globalize)。可以做到，您所要做的就是定义（或覆盖）文化。看看[法国文化文件](https://github.com/jquery/globalize/blob/master/lib/cultures/globalize.culture.fr.js)，看看它是如何做到的：

```
Globalize.addCultureInfo( "fr", "default", {
// (...)
    numberFormat: {
        ",": " ",
        ".": ",",
        "NaN": "Non Numérique",
        negativeInfinity: "-Infini",
        positiveInfinity: "+Infini",
        percent: {
            ",": " ",
            ".": ","
        },
        currency: {
        pattern: ["-n $","n $"],
            ",": " ",
            ".": ",",
        symbol: "€"
    }
// (...) 
```

根据格式的来源，您可能需要将数据转换为 Globalize 可以理解的内容，但是可以。

# java - Swing 中的预定义 JDialog

> ID：13211920
> 
> 赞同：1
> 
> 时间：2012-11-03T17:57:08.097
> 
> 标签：java, swing, jdialog

我正在开发一个可以翻译所有硬编码字符串的库。

在一些帮助下，我设法找到了与之相关的所有字符串，所以这是一个开始。但是，我注意到在尝试将文件重命名`JFileChooser`为已使用的名称时，我收到一个错误对话框，说我不能这样做。

这是 Java，还是 Windows（运行程序的操作系统）？

如果是 Java，我想知道更多关于如何自定义这样的`JDialog`.，如果是 Windows，我无能为力，特别是因为程序应该是跨平台的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:42:16.057

您可以在安装它的目录中找到 JDK 的源代码。

在 openJDK-7 实现中，您要查找的字符串在 `package com.sun.swing.internal.plaf.basic.resources`和文件中定义`basic.java`。此目录中的其他文件对应不同的翻译： `basic_de.java`, `basic_es.java`, ... 等。

Swing 类使用了所有 String 常量。

其中：

```
{ "FileChooser.renameErrorFileExists.textAndMnemonic", 
  "Cannot rename {0}: A file with the name you specified already exists. Specify a different file name." }, 
```

因此，您必须找到一种方法来覆盖 Attribute`FileChooser.renameErrorFileExists.textAndMnemonic`以更改此对话框。

如果您想翻译这些字符串，请参阅[此答案](https://stackoverflow.com/a/6932717/1453080)。

不同的 Java 安装可能有不同的字符串，因为这些文件不是官方 Java API 的一部分。

据我所知，这些文件不包含在`src.zip`Oracle 分发的文件中。

# oracle - 做 HASH JOIN 时什么是 HASH TABLE？

> ID：13211921
> 
> 赞同：2
> 
> 时间：2012-11-03T17:57:10.350
> 
> 标签：oracle, query-optimization, oracle9i

在 oracle 的 HASH JOIN 方法中，HASH TABLE 将建立在其中一张表上，其他表将根据哈希表中的值进行连接。

你能告诉我什么是哈希表吗？哈希表的结构是什么？它将如何创建？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T19:46:23.923

哈希表是一个表，您可以在其中通过使用键来存储内容。它就像一个数组，但存储的东西不同

```
a('CanBeVarchar') := 1; -- A hash table 
```

在 oracle 中，它们被称为[关联数组或表索引。](http://docs.oracle.com/cd/B10500_01/appdev.920/a96624/05_colls.htm)你做一个这样的：

```
TYPE aHashTable IS TABLE OF [number|varchar2|user-defined-types] INDEX BY VARCHAR2(30);
myTable aHashTable; 
```

那么，它是什么？它只是一堆键值对。数据存储为带有头节点的链表，这些头节点通过使用称为 HashCode 的东西对数据进行分组，以更快地查找内容。像这样的东西：

```
a    ->     b     ->    c
Any         Bitter      Class
Array       Bold        Count 
```

假设您正在存储随机单词及其含义（字典）；当您存储以 a 开头的单词时，它存储在“a”组中。所以，假设你想要这个`myTable('Albatroz') := 'It's a bird'`，哈希码将被计算并放在它所属的 A 头节点中：就在'Any'之上。`a`, 有一个指向 Any 的链接，它有一个指向 Array 的链接等等。

现在，它的酷之处在于您可以快速检索数据，说您想要 的含义`Count`，您这样做`definition := myTable('Count');`它会忽略对 Any、Array、Bitter、Bold 的搜索。将直接在C头节点中搜索，经过Class，最后是Count；那是快！

这里有一个维基百科链接：[http ://en.wikipedia.org/wiki/Hash_table](http://en.wikipedia.org/wiki/Hash_table)

请注意，我的示例过于简单，在链接中提供了一些更详细的信息。

阅读更多详细信息，例如负载因子：如果我在 a 组中获得很多元素而在 b 和 c 中获得很少的元素会发生什么；现在搜索以 a 开头的单词不是很理想，是吗？哈希表使用负载因子来重新组织和分配每个节点的负载，例如可以将表转换为子组：

由此

```
a          b     ->    c
Any        Bitter      Class
Anode      Bold        Count
Anti       
Array
Arrays
Arrow 
```

对此

```
an    ->   ar      b     ->    c
Any        Array   Bitter      Class
Anode      Arrays  Bold        Count
Anti       Arrow 
```

现在寻找类似的单词`Arrow`会更快。

# javascript - 按下输入内的输入按钮

> ID：13211923
> 
> 赞同：0
> 
> 时间：2012-11-03T17:57:13.717
> 
> 标签：javascript, jquery, input

我有以下代码：

```
var analogSearch = $('#dataTableAnalog_filter :input').val();
var digitalSearch = $('#dataTableDigital_filter :input').val(); 
```

为了从输入中获取值

之后，我使用：

```
 var analogSearchInput = $('#dataTableAnalog_filter :input');
    var digitalSearchInput = $('#dataTableDigital_filter :input');
    analogSearchInput.val(analogSearch);
    digitalSearchInput.val(digitalSearch); 
```

将数据重新输入到输入端。我想在每个输入中单击 Enter 以过滤 DataTable。那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T19:42:36.663

```
$('#inputId').on('keydown', function(event) {

    if ( event.which == 13 ) {
     //Do Something Here...Submit Maybe?
    }   

}); 
```

# html - 位置：固定不适用于 ICS（本机浏览器）中的背景图像

> ID：13211934
> 
> 赞同：0
> 
> 时间：2012-11-03T17:57:55.777
> 
> 标签：html, css, jquery-mobile

我有一个基于 jQM 的移动 Web 应用程序。我有一个应用了以下样式的背景图像：

```
body.ui-mobile-viewport .ui-page
{
    background: url('images/bg-texture.jpg') no-repeat fixed left bottom;
    -webkit-background-size: 100% 100%;
    -moz-background-size: 100% 100%;
    -o-background-size: 100% 100%;
     background-size: cover;
} 
```

问题是，这在 iOS、Android 版 Chrome 上运行良好，但在 ICS 原生浏览器和 Dolphin 浏览器上，滚动开始后，背景会像这样粘在页面顶部：

![在滚动页面](../Images/0f4068d8f458fe62b3d5db0bd71b1daf.png)

经过一些操作后，（比如点击一个元素，背景会像这样重新聚焦：

![O 点击一个元素](../Images/8f066fa655250711f122c17dcf44d664.png)

我在互联网上查了一下，做了广泛的研究，但显然我错过了一些东西。这些是我尝试过的解决方案的链接：

*   [所以链接1](https://stackoverflow.com/questions/9880661/jquery-mobile-android-fixed-full-screen-background-image)
*   [所以链接2](https://stackoverflow.com/questions/8923656/how-can-i-set-fixed-position-background-image-in-jquery-mobile-for-iphone-app-us)

您在顶部看到的（我的意思是 CSS）是应用的默认未编辑样式。

**注意：** 我也尝试过[超大插件](http://www.buildinternet.com/project/supersized/)，它适用于 GingerBread 设备以及页面中的内容是静态的。在 ICS 设备上，如果将其应用于具有动态内容的页面，我将无法滚动到视口之外。当我尝试`img`在页面正文中创建一个标签并将其`src`设置为图像所在的路径时，也会发生同样的问题。

这些问题只发生在 ICS 原生浏览器上。

如果我做错了什么，请告诉我。有没有一个纯 CSS 解决方案？（显然有些事情是非常错误的）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T09:58:55.177

试试这个：

```
body.ui-mobile-viewport .ui-page
{
 background: url('images/bg-texture.jpg') no-repeat fixed left bottom; 
 background-size: cover;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-08T09:32:35.273

以下用于“html”的 CSS 解决了我在 Android 设备上使用整页背景图像的问题：

```
html{
    height:100%;
    width:100%
}

body{
    background-image:url(img/background.jpg);
    background-repeat:no-repeat;
    background-attachment:fixed;
    webkit-background-size:cover;
    -moz-background-size:cover;
    -o-background-size:cover;
    background-size:cover;
    } 
```

希望有帮助。

# c# - Global.asax 文件中的会话对象

> ID：13211936
> 
> 赞同：0
> 
> 时间：2012-11-03T17:58:00.497
> 
> 标签：c#, asp.net, session

我正在开发一个 Web 应用程序，我希望在用户登录时将 UserID 存储在 Session 中。我知道如何创建会话。

```
Session["UserID"] = myvalue; 
```

但我希望在每一页上都使用它。所以我不想在每个页面上编写代码或检查会话可用性。Global.asax 文件对我有帮助吗？

如果我写会话，`Session_Start()`那么所有页面都可以访问吗？如果过期则返回登录页面。

只需要适当的指导。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:00:32.037

我强烈建议创建一个除登录之外的每个页面都继承的基本页面。这样，您只需在一个页面上创建会话变量代码，但任何继承它的页面都可以访问该代码。

用小例子编辑：

当您的用户通过身份验证时，您需要设置会话变量

目前您的页面可能看起来像这样：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace WebApplication1
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }
    }
} 
```

您需要做的是创建一个单独的类文件，例如 basepage.cs，如下所示：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace WebApplication1
{
    public class basepage : System.Web.UI.Page
    {
        protected int GetItem()
        {
            return Convert.ToInt32(Session["myvalue"]);
        }
    }
} 
```

然后你的原始页面看起来更像这样：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace WebApplication1
{
    public partial class _Default : basepage
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            int whatINeed = GetItem();
        }
    }
} 
```

如您所见，不是您的页面继承了`System.Web.UI.Page`它，而是继承了基页（而后者又继承了`System.Web.UI.Page`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T18:08:52.920

我曾经编写一个单独的类来处理会话并将其作为属性返回。我可以写下课堂上的所有条件。

# java - getBeanFactory 中的阻塞线程

> ID：13211937
> 
> 赞同：3
> 
> 时间：2012-11-03T17:58:10.383
> 
> 标签：java, multithreading, spring, amazon-ec2

我有一个高吞吐量服务器，在 Amazon EC2（弗吉尼亚）上运行 spring IOC（2.5.6）。在过去的几天里，我没有对代码进行任何更改（仅更改了一些配置），但突然我开始看到 spring 的疯狂锁定问题。应用程序似乎花费了 60%-80% 的时间来尝试获取 bean（不同的 bean，来自代码的不同区域），并且线程转储显示大多数线程都以以下方式卡住：

```
Thread 15148: (state = BLOCKED)
 - org.springframework.context.support.AbstractRefreshableApplicationContext.getBeanFactory() @bci=6, line=151 (Compiled frame)
 - org.springframework.context.support.AbstractApplicationContext.getBean(java.lang.String) @bci=1, line=880 (Compiled frame) 
```

我们的应用程序是 IO 密集型的，所以我希望看到大部分时间都花在数据库连接和 HTTP 客户端访问上。我不确定我可以在此处提供哪些附加信息。

有人见过这种东西吗？

# c# - 无法手动验证用户

> ID：13211953
> 
> 赞同：0
> 
> 时间：2012-11-03T17:59:55.130
> 
> 标签：c#, asp.net

我的登录页面上有以下代码：

```
 if (authentication method returns true)
    {
        FormsAuthenticationTicket ticket;

        if (cbRemember.Checked)
        {
            ticket = new FormsAuthenticationTicket(1, tbUsername.Text, DateTime.Now, DateTime.Now.AddYears(1), true, null, FormsAuthentication.FormsCookiePath);
        }
        else
        {
            ticket = new FormsAuthenticationTicket(1, tbUsername.Text, DateTime.Now, DateTime.Now.AddHours(1), true, null, FormsAuthentication.FormsCookiePath);
        }

        string encryptedTicket = FormsAuthentication.Encrypt(ticket);

        HttpCookie cookie = new HttpCookie(FormsAuthentication.FormsCookieName, encryptedTicket);
        cookie.HttpOnly = true;

        Response.Cookies.Add(cookie);

    }
    else
    {
        errorBox.Visible = true;
    } 
```

但是，此后用户仍未通过身份验证。我做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:57:35.320

问题是我正在传递`null`票证的参数之一。你必须通过 string.empty。

# java - 确定树中的节点是否已满

> ID：13211954
> 
> 赞同：0
> 
> 时间：2012-11-03T18:00:01.947
> 
> 标签：java, recursion, tree, nodes

我正在尝试确定 m-ary 树中的所有节点是否已满。我想我有大致的想法，但我不确定。这是我到目前为止所做的。

在我的 TreeNode 类中，我有以下方法。

```
 public class TreeNode
    {
       private String label;
       private String message;
       private TreeNode[] nodes;
       private int numChildren;
       private TreeNode parent;
       private String prompt;

           ***other methods and constructors***

      public boolean isFull()
    {
      for(int i = 0; i < numChildren; ++i)
      {
        if(nodes[i] == null)
            return false;
      }
      return true;
    } 
```

其中 numChildren 是数组 nodes[]（或只是 nodes.length）中可能的子节点总数，nodes[] 是当前节点的所有子节点的数组。此外，知道我的 TreeNode 是双向链接的可能会有所帮助，因此如果需要，我可以检索当前节点的父节点。

然后，在我的 Tree 类中，我有以下递归方法。

```
 public boolean allNodesFull(TreeNode n)
    {
      boolean allFull = false;
      if(!n.isFull())
      {
        return allFull;
      }
      for (int i = 0; i < n.getNumChildren(); ++i)
      {
        allFull = allNodesFull(n.getChild(i));
      }
      return allFull;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:17:00.650

还没有测试过，希望你已经准备好测试用例并告诉我们它是否有效；）

```
public boolean allNodesFull(TreeNode n) {
  if(!n.isFull()) {
    return false;
  }
  for (int i = 0; i < n.getNumChildren(); ++i) {
    if (!allNodesFull(n.getChild(i))) {
      return false;
    }
  }
  return true;
} 
```

# c - 连续两次调用递归函数

> ID：13211969
> 
> 赞同：0
> 
> 时间：2012-11-03T18:01:18.130
> 
> 标签：c

```
#include <stdio.h>

#define LENGTH 16

void makeBranches(int, int);
void display(int, int);

int main(){

  makeBranches(0, LENGTH-1);
}

void makeBranches(int left, int right){

  if(left >= right){
    return;
  } else{
    display(left, right);
    makeBranches(left, (right+left)/2);
    makeBranches((right+left/2)+1, right);
  }
}

void display(int left, int right){
  printf("%d, %d", left, right);
  int mid = (left+right)/2;
  int i;

  for(i = left; i <= right; i++){
    if(i == mid)
      printf("X");
    else
      printf("-");
  }

  if(right == LENGTH-1)
    printf("\n");

} 
```

我遇到的问题是 makeBranches 的第二次调用仅使用导致第一次调用 makeBranches 返回的值而不是第一次调用使用的原始值执行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T20:02:45.680

我同意。你的括号在第一次调用`makeBranches(left, (right+left)/2);`是正确的之间是不同的 - 第二次调用`makeBranches((right+left/2)+1, right);`包括`/2`括号里面，这搞砸了操作的顺序。

按照建议将第二行更改`makeBranches((right+left)/2+1, right);`为，然后查看值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T18:08:16.963

你没有道理。C 通过值传递 parms，因此第二次调用看到的 parms 不能被第一次调用修改。

但是对于递归函数，很容易混淆你在调用深度中的位置。尝试传递并显示第三个深度参数：

```
void makeBranches(int left, int right, int depth){

  if(left >= right){
    return;
  } else{
    display(left, right, depth);
    makeBranches(left, (right+left)/2, depth+1);
    makeBranches((right+left/2)+1, right, depth+1);
  }
} 
```

因此，您可以跟踪您在调用堆栈中的深度。您还可以传递一个参数，指示它是“左”调用还是“右”调用。

# windows - 如何在内核模式挂钩中获取调用者 SID？（视窗）

> ID：13211970
> 
> 赞同：6
> 
> 时间：2012-11-03T18:01:18.217
> 
> 标签：windows, kernel, hook, driver

我正在开发一个在 Windows 中挂钩某些功能的驱动程序（会阻止某些操作的强化驱动程序）。问题是，我想记录谁是试图运行这些操作的用户。

例如，我在 ZwSetValueKey 上添加了一个钩子，以过滤注册表写入。

钩子完美运行，但我不知道如何获取调用者 SID。我发现我可以使用 ExGetPreviousMode 确定调用者的模式（即用户模式或内核模式）。但是如果调用者处于用户模式，我不确定如何确定 SID。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:45:49.477

如果这是用户模式，您将从`GetCurrentProcess`or开始`GetCurrentThread`，然后调用`GetProcessToken`or `GetThreadToken`。这将为您提供一个访问令牌，[可以从中直接提取 SID](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379554%28v=vs.85%29.aspx)。在内核模型中，线程有`PsGetCurrentProcess`and`ZwOpenProcessTokenEx`等。

这是用户空间的等效问题：[How to get Calling-Process Windows User Access Token](https://stackoverflow.com/questions/7418861/how-to-get-calling-process-windows-user-access-token)。

我还没有测试过这个，但我希望它能让你开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-27T13:05:46.080

VOID SeCaptureSubjectContext( *Out* PSECURITY_SUBJECT_CONTEXT) 可能是您正在寻找的内核模式 API，至少如果您有 ntifs.h 可用。

# java - 解析设计不良的 csv 文件（动态结构）

> ID：13211973
> 
> 赞同：0
> 
> 时间：2012-11-03T18:01:32.530
> 
> 标签：java, parsing, csv

我需要一些帮助来解析设计不良的 csv（逗号分隔值）文件。该文件包含当前的气象数据，每 2.5 秒更新一次。这是文件的结构：

```
1.00 - Csv File Version ID (XX.XX) Floating Point
2012 - Year (yyyy format) Integer
10 - Month Integer
31 - Day Integer
10 - Hour (24-hour format) Integer
58 - Minute Integer
45 - Second Integer
2 - Wind speed 10min average (mph) Floating Point
3 - Wind speed (mph) Floating Point
103 - Wind Direction(degrees) Floating Point
48 - Inside Humidity (%) Floating Point
91 - Outside Humidity (%) Floating Point
67,5 - Inside Temperature (°F) Floating Point
36,5 - Outside Temperature (°F) Floating Point
29,867 - Barometer (in) Floating Point
35,969 - Total Rain (in) Floating Point
0,00 - Daily Rain (in) Floating Point 
```

以下是实际录制的示例：

```
1.00,2012,11,3,18,36,16,3,4,281,49,74,73,1,55,5,29,890,37,055,0,00 
```

现在我已经用 Java 编写了解析器。我正在使用另外两个库：

*   乔达时间 2.1
*   开放CSV 2.3

    ```
    // First we read file.
    CSVReader reader = new CSVReader(new FileReader("/VPLive/data.csv"));`

    List<String[]> data = reader.readAll();
    reader.close();

    // Actual data is in first element, which contains string array.
    String[] records = data.get(0);

    // First we parse date and time.
    DateTime dateTime= new DateTime(Integer.parseInt(records[1]), Integer.parseInt(records[2]), Integer.parseInt(records[3]), Integer.parseInt(records[4]), Integer.parseInt(records[5]), Integer.parseInt(records[6]));

    // Then we parse air temperature.
    double airTemperatureFahrenheit = Double.parseDouble(records[14] + "." + records[15]); 
    ```

现在这种方法的问题是，文件用逗号分隔固定值和十进制值。现在这是可以解决的，因为我在代码示例中显示了气温。**但是得到这个**：

例如，当空气温度为 55°F 时，它只打印 55。固定值后没有十进制零。风速也是如此。可以有小数点值的值为：

*   风速 10min 平均
*   风速 (mph)
*   内部温度 (°F)
*   室外温度 (°F)

所以有 4^2 = 16 种不同文件结构的组合。我目前陷入困境，因为我不知道如何解决这个问题。我正在考虑设置参考点，例如我知道气压计必须在给定的间隔内。

**编辑：** 我忘了提。data.csv 中的单行每 2.5 秒不断被覆盖。所以我看不到以前的值。但我确实每 1 分钟就有一次存档值。但是我需要在更新时读取该文件，因为我正在实现实时功能。

# mysql - 将关联数组数据插入mysql

> ID：13211974
> 
> 赞同：-1
> 
> 时间：2012-11-03T18:01:34.813
> 
> 标签：mysql

**我在 php 中以关联数组格式输出了以下 twitter 数据，如何将这些数据插入到 mysql 数据库表中。请提出任何方法来做到这一点。**

```
Array (
 [created_at] => Fri, 02 Nov 2012 18:15:57 +0000 
[from_user] => VolksblattNews 
[from_user_id] => 828753642 
[from_user_id_str] => 828753642 
[from_user_name] => Volksblatt News 
[geo] => [id] => 2.6443066310356E+17 
[id_str] => 264430663103557632 
[iso_language_code] => de 
[metadata] => Array ( [result_type] => recent ) 
[profile_image_url] => http://a0.twimg.com/profile_images/2619216207/VB_48x48_reasonably_small_normal.gif 
[profile_image_url_https] => https://si0.twimg.com/profile_images/2619216207/VB_48x48_reasonably_small_normal.gif 
[source] => <a Google</a> => Bundesrat Burkhalter verstÃ¤rkt Schweizer Beziehungen zu Burma: RANGUN - Didier Burkhalter hatâ€¦ http://t.co/BF3aX2bY 
[to_user] => 
[to_user_id] => 0 
[to_user_id_str] => 0 [
to_user_name] => ) 
```

**我从以下程序中得到了这个输出：**

```
 <?php

//a json string

$jsonstring='{

"created_at": "Fri, 02 Nov 2012 18:15:57 +0000", 
   "from_user": "VolksblattNews", 
   "from_user_id": 828753642, 
   "from_user_id_str": "828753642", 
   "from_user_name": "Volksblatt News", 
   "geo": null, 
   "id": 264430663103557632, 
   "id_str": "264430663103557632", 
   "iso_language_code": "de", 
   "metadata": {
    "result_type": "recent"
   }, 
   "profile_image_url": "http://a0.twimg.com/profile_images/2619216207/VB_48x48_reasonably_small_normal.gif", 
   "profile_image_url_https": "https://si0.twimg.com/profile_images/2619216207/VB_48x48_reasonably_small_normal.gif", 
   "source": "&lt;a href=&quot;http://www.google.com/&quot;&gt;Google&lt;/a&gt;", 
   "text": "Bundesrat Burkhalter verst\u00e4rkt Schweizer Beziehungen zu Burma: RANGUN - Didier Burkhalter hat\u2026 http://t.co/BF3aX2bY", 
   "to_user": null, 
   "to_user_id": 0, 
   "to_user_id_str": "0", 
   "to_user_name": null

}';

$arrayvariable=json_decode($jsonstring,true);

print_r ($arrayvariable);

?> 
```

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:14:52.623

好吧，根据用途，您可以将其存储为 json 字符串（以防您想将其直接发送到浏览器并在那里使用它）或创建一个表，其中所有数组值作为列。然后做一个插入。

为了确保插入或更新安全，您在这里有一个很好的例子，使用准备好的语句和 PDO。

[http://www.phpeveryday.com/articles/PDO-Insert-and-Update-Statement-Use-Prepared-Statement-P552.html](http://www.phpeveryday.com/articles/PDO-Insert-and-Update-Statement-Use-Prepared-Statement-P552.html)

# c# - Gridview 中的嵌套类

> ID：13211976
> 
> 赞同：0
> 
> 时间：2012-11-03T18:01:52.617
> 
> 标签：c#, gridview

我有一个来自 DHCP 服务器的配置数据，我将其放入如下类中：

```
public class DHCP
{
    public DHCP()
    {
        this.Scopes = new List<Scope>();
    }

    public List<Scope> Scopes;

    public class Scope
    {
        public Scope(string ScopeAddress, string SubnetMask, string State, string ScopeName, string Comment)
        {
            this.ScopeAddress = ScopeAddress;
            this.SubnetMask = SubnetMask;
            this.State = State;
            this.ScopeName = ScopeName;
            this.Comment = Comment;
        }

        public Scope(string ScopeAddress, string SubnetMask, string State, string ScopeName, string Comment, bool initClients)
        {
            this.ScopeAddress = ScopeAddress;
            this.SubnetMask = SubnetMask;
            this.State = State;
            this.ScopeName = ScopeName;
            this.Comment = Comment;

            if (initClients)
                this.Clients = new List<Client>();
        }

        public void InitClients()
        {
            this.Clients = new List<Client>();
        }

        public void InitReservations()
        {
            this.Reservations = new List<Reservation>();
        }

        public string ScopeAddress { get; set; }
        public string SubnetMask { get; set; }
        public string State { get; set; }
        public string ScopeName { get; set; }
        public string Comment { get; set; }

        public List<Client> Clients;
        public List<Reservation> Reservations;
    }

    public class Client
    {
        public Client(string IPAddress, string SubnetMask, string UniqueID, string LeaseExpires, string ClientType)
        {
            this.IPAddress = IPAddress;
            this.SubnetMask = SubnetMask;
            this.UniqueID = UniqueID;
            this.LeaseExpires = LeaseExpires;
            this.ClientType = ClientType;
        }

        public string IPAddress { get; set; }
        public string SubnetMask { get; set; }
        public string UniqueID { get; set; }
        public string LeaseExpires { get; set; }
        public string ClientType { get; set; }
        public Reservation ClientReservation { get; set; }
    }

    public class Reservation
    {
        public Reservation(string IPAddress, string UniqueID, bool ReservationActive)
        {
            this.IPAddress = IPAddress;
            this.UniqueID = UniqueID;
            this.ReservationActive = ReservationActive;
        }

        public string IPAddress { get; set; }
        public string UniqueID { get; set; }
        public string Name { get; set; }
        public string Description { get; set; }
        public string Type { get; set; }
        public bool ReservationActive { get; set; }
    }
} 
```

然后我有一个`List<DHCP.Client>`我`DataSource`在gridview上使用的。当我将其中一个数据字段设置为时，`ClientReservation.ReservationActive`出现未找到错误。

我已经用 List<> 尝试过这个，这根本不是 NULL 数据。所以我不得不提问：

这完全可以做到吗？如果我有一个对象，`Client.ClientReservation == null`我怎样才能在`DataBind()`没有错误的情况下处理它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:19:53.177

问题是，正如您所看到的，您在构造函数中为所有属性分配了一个值，除了`ReservationActive`. 事实上它仍然为空，这就是您收到错误的原因。所以你应该这样做：

```
public class Client
{
    public Client(string IPAddress, string SubnetMask, string UniqueID, string LeaseExpires, string ClientType, Reservation ClientReservation)
    {
        this.IPAddress = IPAddress;
        this.SubnetMask = SubnetMask;
        this.UniqueID = UniqueID;
        this.LeaseExpires = LeaseExpires;
        this.ClientType = ClientType;
        this.ClientReservation = ClientReservation;
    }

    public string IPAddress { get; set; }
    public string SubnetMask { get; set; }
    public string UniqueID { get; set; }
    public string LeaseExpires { get; set; }
    public string ClientType { get; set; }
    public Reservation ClientReservation { get; set; }
} 
```

和一个传递**非空值**。否则，您可以以这种方式初始化它，而无需通过构造函数传递它：

```
Client client = new Client();
client.ClientReservation = new Reservation("127.0.0.1", "ID", true); //example 
```

然后您可以使用`myClient.ClientReservation`而不会出现任何错误。

**编辑：**

另一个建议。因为你需要添加一些`Client`s。您可以通过这种方式实现这种可能性：

```
public Scope
{
    //...
    public void AddClient(string IPAddress, string SubnetMask, string UniqueID, string LeaseExpires, string ClientType, Reservation ClientReservation){
        Clients.Add(new Client(IPAddress, SubnetMask, UniqueID, LeaseExpires, ClientType, ClientReservation));
    }
} 
```

然后：

```
Scopes = new List<Scope>();
Scope scope = new Scope(/*...*/);
scope.AddClient(new Client(/*...*/)); 
Scopes.Add(scope); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T09:21:39.370

我找到了解决这两个问题的方法。通过使用这样的模板字段：

```
<asp:TemplateField>
  <ItemTemplate>
    <%#DataBinder.Eval(Container.DataItem, "ClientReservation.ReservationActive")%>
  </ItemTemplate>
 </asp:TemplateField> 
```

它获取嵌套类（子属性）的值，如果 ClientReservation 为 NULL，则忽略它而不会出错。

# objective-c - 如何接收通过 CPDistributedNotificationCenter 发布的通知

> ID：13211979
> 
> 赞同：4
> 
> 时间：2012-11-03T18:02:26.277
> 
> 标签：objective-c, ios, cocoa, ipc

iOS 上的私有`AppSupport`框架有一个名为的类`CPDistributedNotificationCenter`，它似乎支持`NSDistributedNotificationCenter`OS X 上提供的功能的子集。

我正在尝试使用此类从后台守护程序发布通知，以便其他进程中的多个客户端可以接收这些通知并对其采取行动。我意识到还有其他选项，包括`CPDistributedMessagingCenter`or `CFMessagePort`、低级 mach 端口甚至 darwin 的`notify_post`. 但是，如果守护程序不了解客户端，我会更喜欢它，并且我希望能够与通知一起传递数据，并且`notify_post`不允许这样做。

目前，这是我在守护进程中所做的：

```
CPDistributedNotificationCenter* center;
center = [CPDistributedNotificationCenter centerNamed:@"com.yfrancis.notiftest"];
[center runServer];
[center postNotificationName:@"hello"]; 
```

在客户端：

```
CPDistributedNotificationCenter* center;
center = [CPDistributedNotificationCenter centerNamed:@"com.yfrancis.notiftest"];
[center startDeliveringNotificationsToMainThread];

NSNotificationCenter* nc = [NSNotificationCenter defaultCenter];
[nc addObserver:[Listener new] 
       selector:@selector(gotNotification:)
           name:@"hello"
         object:nil]; 
```

where`Listener`是一个实现单个方法的简单类`gotNotification:`

不幸的是，客户端从未收到“你好”通知。如果我将调用`name`中的参数替换为我可以看到发送到客户端通知中心的每个通知，但“你好”不是其中之一。`addObserver``nil`

我通过查看`SpringBoard`and的反汇编获得了我的代码的灵感`CPDistributedNotificationCenter`。通知似乎是通过`CPDistributedNotificationCenter`'s传递的`deliverNotification:userInfo:`，它充当 's 的`NSNotificationCenter`shim `postNotificationName:object:userInfo:`。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T23:30:12.613

弄清楚了。在发送通知之前，您的守护进程必须等待指示客户端已开始侦听的通知。没有积压，即使守护程序服务器在客户端之前运行，也存在注册延迟。您不能简单地启动服务器并立即向侦听器发布通知。以下对我有用：

在服务器初始化中：

```
self.center = [CPDistributedNotificationCenter centerNamed:@"com.yfrancis.notiftest"];
[self.center runServer];

// requires a runloop
NSNotificationCenter* nc = [NSNotificationCenter defaultCenter];
[nc addObserver:self
       selector:@selector(clientEvent:)
           name:@"CPDistributedNotificationCenterClientDidStartListeningNotification"
         object:self.center]; 
```

并确保在服务器中实现以下方法：

```
- (void)clientEvent:(NSNotification*)notification
{
    // you can now send notifications to the client that caused this event
    // and any other clients that were registered previously
    [self.center postNotificationName:@"hello!"];
{ 
```

我已经在[iPhoneDevWiki上记录了这个 API](http://iphonedevwiki.net/index.php/CPDistributedNotificationCenter)

# php - PDO 和类得到“PDOException”错误

> ID：13211983
> 
> 赞同：0
> 
> 时间：2012-11-03T18:03:09.773
> 
> 标签：php, mysql, pdo

我收到一个错误：`Fatal error: Uncaught exception 'PDOException' with message 'SQLSTATE[HY000] [2002] Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2)' in /home/content/........`

虽然如果我在一个文件中执行它，它工作正常！

我的 php 文件：

```
<?php
require 'includes/dbc.php';

$dbc = new dbc();
$db = $dbc->openDb();
$stmt = $dbc->getAllUsers($db);

while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {
    echo $row['iduser'];
}
?> 
```

我的数据库类：

```
<?php

class dbc {

    public $dbserver = '';
    public $dbusername = '';
    public $dbpassword = '';
    public $dbname = '';

    function openDb() {

        $db = new PDO('mysql:host=' . $dbserver . ';dbname=' . $dbname . ';charset=utf8', '' . $dbusername . '', '' . $dbpassword . '');
        return $db;
    }

    function getAllUsers($db) {
        $stmt = $db->query("SELECT * FROM user");
        return $stmt;
    }
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:05:40.350

在您提供的示例代码中，您没有为数据库连接字符串指定数据库、用户、密码或主机：

```
function openDb() {
    $db = new PDO('mysql:host=' . $dbserver . ';dbname=' . $dbname . ';charset=utf8', '' . $dbusername . '', '' . $dbpassword . '');
    return $db;
} 
```

如果数据无效，您的代码将无法连接，因此您会收到连接错误。

由于它们对`dbc`类是全局的，因此您需要`$this`在访问它们时使用它们（例如`$this->dbserver`）。尝试将您的代码更新为：

```
function openDb() {
    $db = new PDO('mysql:host=' . $this->dbserver . ';dbname=' . $this->dbname . ';charset=utf8', '' . $this->dbusername . '', '' . $this->dbpassword . '');
    return $db;
} 
```

* 此外，尽管您可能已将其删除以发布问题，但您也没有将任何这些变量设置为实际值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T18:08:20.160

你忘了定义数据库设置？我总是使用以下内容来使用 PDO 类进行连接。

```
/** Define database propperties **/
define('DB_HOST', 'localhost', true);
define('DB_USER', 'user_db', true);
define('DB_PASS', 'yoursuperpass', true);
define('DB_DATA', 'data_www', true); 

$dbInstance = new PDO('mysql:dbname='.DB_DATA.';host='.DB_HOST, DB_USER, DB_PASS);
$dbInstance->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$dbInstance->setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE, PDO::FETCH_ASSOC); 
```

# haskell - 用堪萨斯熔岩中的信号索引矩阵矩阵

> ID：13211984
> 
> 赞同：6
> 
> 时间：2012-11-03T18:03:13.890
> 
> 标签：haskell, vhdl, fpga, lava

我正在尝试实现时间多路复用以驱动具有 4 位数字的 7 段显示器：该设备有 7 个数据腿和 4 个阳极，因此如果要显示四个不同的数字，则必须将阳极设置为`0001`第一个，然后将数据腿到你的部分; 然后过了一会儿，将阳极设置为`0010`并更新数据腿；等等。

我正在尝试在堪萨斯熔岩中实现这一点。但是，Xilinx 编译器以类型错误拒绝生成的 VHDL（并且查看生成的代码，我认为它是正确的）。

首先，我的 Lava 代码：它基本上实现了序列的信号`[0, 1, 2, 3, 0, ...]`，然后使用`.!.`运算符 from`Language.KansasLava.Signal`来索引 matrix-of-matrices 参数。`0001`阳极值是通过在每个时间步向左旋转来生成的。

```
{-# LANGUAGE TypeFamilies #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE DataKinds #-}
import Language.KansasLava
import Hardware.KansasLava.Boards.Papilio.LogicStart -- from http://github.com/gergoerdi/kansas-lava-papilio
import Data.Sized.Matrix
import Data.Sized.Unsigned as Unsigned
import Data.Bits

driveSS :: forall clk sig n. (Clock clk, sig ~ Signal clk, Size n, Rep n, Num n, Integral n) => Matrix n (Matrix X7 (sig Bool)) -> SevenSeg clk ActiveLow n
driveSS segss = SevenSeg (fmap bitNot anodes) segs high
  where
    clkAnode :: sig Bool
    clkAnode = divideClk (Witness :: Witness X8)

    selector :: sig n
    selector = counter clkAnode

    segss' :: sig (Matrix n (Matrix X7 Bool))
    segss' = pack . fmap pack $ segss

    segs :: Matrix X7 (sig Bool)
    segs = unpack $ segss' .!. selector

    anodes :: Matrix n (sig Bool)
    anodes = rotatorL clkAnode

test_sseg :: Fabric ()
test_sseg = do
    sw <- switches
    let sw' = cropAt sw 1
    sseg $ driveSS $ matrix [sw', zero, zero, zero]
  where
    zero = matrix $ replicate 7 low

divideClk :: forall c sig ix. (Clock c, sig ~ Signal c, Size ix) => Witness ix -> sig Bool
divideClk _ = counter high .==. (0 :: sig (Unsigned ix))

counter :: (Rep a, Num a, Clock c, sig ~ Signal c) => sig Bool -> sig a
counter inc = loop
  where
    reg = register 0 loop
    loop = mux inc (reg, reg + 1)

rotatorL :: (Clock c, sig ~ Signal c, Size ix, Integral ix) => sig Bool -> Matrix ix (sig Bool)
rotatorL step = fromUnsigned loop
  where
    reg = register 1 loop
    loop = mux step (reg, rotateL reg 1)

fromUnsigned :: (sig ~ Signal c, Size ix) => sig (Unsigned ix) -> Matrix ix (sig Bool)
fromUnsigned = unpack . coerce Unsigned.toMatrix

main :: IO ()
main = do
    writeVhdlPrelude "lava-prelude.vhdl"
    kleg <- reifyFabric $ do
        board_init
        test_sseg
    writeVhdlCircuit "hello" "hello.vhdl" kleg
    writeUCF "hello.ucf" kleg 
```

因此，当我尝试编译生成的 VHDL 时，我收到以下错误消息：

```
ERROR:HDLParsers:800 - "/home/cactus/prog/lava/hello/src/hello.vhdl" Line 85\. Type of sig_24_o0 is incompatible with type of sig_28_o0. 
```

相关行来自`hello.vhdl`：

```
type sig_24_o0_type is array (7 downto 0) of std_logic_vector(0 downto 0);
signal sig_24_o0 : sig_24_o0_type;

signal sig_25_o0 : std_logic_vector(1 downto 0);

type sig_28_o0_type is array (3 downto 0) of std_logic_vector(6 downto 0);
signal sig_28_o0 : sig_28_o0_type;

sig_24_o0 <= sig_28_o0(to_integer(unsigned(sig_25_o0))); 
```

的类型`sig_24_o0`似乎不对；我认为应该是`array (6 downto 0) of std_logic_vector(0 downto 0)`or `std_logic_vector(6 downto 0)`，但我不知道 Lava 使用那些`std_logic_vector(0 downto 0)`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T14:27:44.550

我最终通过多路复用每条线路而不是多路复用整个总线来解决这个问题：

```
segss' :: Matrix X7 (Matrix n (sig Bool))
segss' = columns . joinRows $ segss

segs :: Matrix X7 (sig Bool)
segs = fmap (nary selector) segss' 
```

使用辅助函数

```
nary :: forall a clk sig n. (Clock clk, sig ~ Signal clk, Rep a, Size n, Rep n) => sig n -> Matrix n (sig a) -> sig a
nary sel inps = pack inps .!. sel 
```

由此生成的 VHDL 编译得很好；虽然我不知道它是否会使结果电路变得更复杂（或者甚至更简单）。

# git - 可解析的 git 日志输出

> ID：13211988
> 
> 赞同：2
> 
> 时间：2012-11-03T18:04:14.790
> 
> 标签：git

您可以自定义`git log`using的输出，`--pretty`并且可以使用 显示添加和删除的行数`--numstat`。它看起来像这样：

```
$ git log --pretty=format:"%h - %ar : %s" --numstat config*.ini

f665c63 - 6 months ago : fixes session end post
1       1       config.ini

4541de2 - 7 months ago : fixes missing strings
6       1       config.ini
3       1       config_office.ini 
```

但我想要的是提交信息和文件更改的输出，分别显示在一行中。像这样的东西：

```
1       1       config.ini            f665c63 - 6 months ago : fixes session end post
6       1       config.ini            4541de2 - 7 months ago : fixes missing strings
3       1       config_office.ini     4541de2 - 7 months ago : fixes missing strings 
```

`grep`这样，使用,等解析这个输出就很简单了。git`sort`是否已经提供了这个功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:25:38.830

据我所知，`git log`不能在本地做到这一点。但是，此 sed 命令会执行此操作：

```
sed '/^[0-9]\+\t[0-9]\+\t[^\t]\+$/ b file; h; d; : file; G; s/\n/\t/' 
```

它寻找`--numstat`线条。任何非 numstat 行都被复制到保持缓冲区中并且不打印。带有 numstat 输出的行获取附加的保持缓冲区的当前内容，在中间留下一个换行符，然后用一个制表符替换。

# segmentation-fault - 派生数据类型的 MPI 发送错误 (Fortran)

> ID：13211990
> 
> 赞同：2
> 
> 时间：2012-11-03T18:04:52.237
> 
> 标签：segmentation-fault, fortran, mpi

当我尝试使用“大”数组（每个 100 000 个浮点数的 2 个数组）发送 MPI 派生数据类型时，我的程序出现段错误。不过，它可以正常运行较小的阵列。

下面是一个可重现的小例子。这个小程序使用以下 MPI 实现出现段错误：  *IntelMPI*、*BullXMPI*。它与*OpenMPI*和*PlatformMPI*一起正常工作。这是一个带有示例回溯的日志：http: [//pastebin.com/FMBpCuj2](http://pastebin.com/FMBpCuj2)

更改`mpi_send`为`mpi_ssend`无济于事。但是，`mpi_send`使用一个更大的 2*100 000 浮点数组可以正常工作。在我看来，这表明派生数据类型存在问题。

```
program struct 
include 'mpif.h' 

type Data
  integer :: id
  real, allocatable :: ratio(:)
  real, allocatable :: winds(:)
end type 

type (Data) :: test
integer :: datatype, oldtypes(3), blockcounts(3) 
integer :: offsets(3)
integer :: numtasks, rank, i,  ierr 
integer :: n, status(mpi_status_size)

call mpi_init(ierr) 
call mpi_comm_rank(mpi_comm_world, rank, ierr) 
call mpi_comm_size(mpi_comm_world, numtasks, ierr) 

if (numtasks /= 2) then
  write (*,*) "Needs 2 procs"
  call exit(1)
endif

n = 100000
allocate(test%ratio(n))
allocate(test%winds(n))
if (rank == 0) then
  test%ratio = 6
  test%winds = 7
  test%id = 2
else
  test%id = 0
  test%ratio = 0
  test%winds = 0
endif

call mpi_get_address(test%id, offsets(1), ierr)
call mpi_get_address(test%ratio, offsets(2), ierr)
call mpi_get_address(test%winds, offsets(3), ierr)

do i = 2, size(offsets)
  offsets(i) = offsets(i) - offsets(1)
end do
offsets(1) = 0

oldtypes = (/mpi_integer, mpi_real, mpi_real/)
blockcounts = (/1, n, n/)

call mpi_type_struct(3, blockcounts, offsets, oldtypes, datatype, ierr) 
call mpi_type_commit(datatype, ierr) 

if (rank == 0) then 
  !call mpi_ssend(test, 1, datatype, 1, 0,  mpi_comm_world, ierr) 
  call mpi_send(test, 1, datatype, 1, 0,  mpi_comm_world, ierr) 
else
  call mpi_recv(test, 1, datatype, 0, 0,  mpi_comm_world, status, ierr) 
end if

print *, 'rank= ',rank
print *, 'data= ',test%ratio(1:5),test%winds(1:5)

deallocate (test%ratio)
deallocate (test%winds)
call mpi_finalize(ierr) 

end 
```

**注意：**不同 MPI 实现之间的比较并不客观，因为测试并非都在同一台机器上（其中一些是超级计算机）。不过，我认为它不应该有所作为。

**编辑：**代码适用于静态数组。这是 Fortran 90。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T23:09:10.760

我可以建议您使用调试器吗？我刚刚在[Allinea DDT](http://www.allinea.com/products/ddt)中尝试了您的示例，并在两分钟内看到了问题。你需要使用调试器——你的代码“看起来不错”，所以是时候观察它在实践中的表现了。

我单击以打开内存调试（一种强制显示一些隐藏错误的方法），然后您的示例每次都与 OpenMPI 一起崩溃。崩溃发生在发件人身上。

所以，我开始逐步使用 DDT - 打开 DDT 的内存调试。

首先，调用 MPI_Get_address - 填充偏移量数组。看看那些偏移量！整数的地址是正数，而可分配数组的偏移量是负数：这是一个不好的迹象。地址已溢出。

已分配数据的地址将位于与静态分配的整数非常不同的内存区域中。如果您使用 32 位算术来操作 64 位指针（MPI_Get_address 对此发出警告），则所有赌注都将失败。使用静态数组它不会崩溃，因为它们的地址将足够接近整数的地址而不会溢出。

您将此不正确的偏移量数组发送到 MPI_Send，它会从不应该读取的位置读取数据（再次查看偏移量缓冲区以说服自己）并因此产生段错误。

这里真正的解决办法是——

1.  使用 MPI_Get_address - 使用 INTEGER(KIND=MPI_ADDRESS_KIND) 声明偏移量 - 确保 64 位代码获得 64 位整数。

2.  MPI_type_struct 应该替换为 MPI_type_create_struct - 前者已被弃用，并且不采用 MPI_ADDRESS_KIND 整数形式的偏移量，只有 4 字节整数 - 因此存在缺陷。

通过这些更改，您的代码将运行。

祝你好运！

# php - 去除特殊字符编码

> ID：13211992
> 
> 赞同：0
> 
> 时间：2012-11-03T18:05:13.037
> 
> 标签：php, regex, utf-8, htmlspecialchars

我有一个来自似乎已用`htmlspecialchars()`两次编码的 XML 文件的字符串：

```
$data = "string&amp;#44;s example"; 
```

我尝试`&amp;`只用一个符号替换，然后调用`htmlspecialchars_decode()`，然后用单词“and”替换简单的符号，但输出结果像`stringand#44; example`. 我想知道是否有一种方法可以正确转换这些字符编码，或者可能是一个正则表达式来完全去除它们（因为我可以简单地去除它们并将其用作稍后检查的值）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T18:09:14.823

这个特定的字符串[需要被处理两次](http://ideone.com/9ApgaY)以[`html_entity_decode`](http://www.php.net/manual/en/function.html-entity-decode.php)获得它的“真实”值（这些调用中的第一个也可以是`htmlspecialchars_decode`）。第一遍将转换`&amp;`为`&`，第二遍将实体转换`&#44;`为相应的字符。

您应该小心地将所有相关参数传递给解码函数调用（默认值在所有情况下都没有意义），当然要确保所有传入数据都以这种方式编码，这样您就不会得到错误地破坏了输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T18:15:07.323

使用[html_entity_decode](http://php.net/manual/en/function.html-entity-decode.php)如下：

```
$data = html_entity_decode ( html_entity_decode ( $data ) ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-22T19:50:40.997

尽管它几乎可以肯定地在原生 PHP 中按预期工作，但当应用于从 Laravel 控制器馈送到其视图的字符串时，公认的解决方案似乎什么都不做。例如，要转储一个变量，我发现这样做的唯一有效方法是`print_r ( $_ENV , true )`通过一个`with`方法提供 eg 返回的值，并将封闭`pre`标签放入视图中。

**控制器：**

```
$sDebugMessages = '$_ENV = '.  print_r ( $_ENV , true ) ;
return view ( 'Info' )->with ( 'sPageTitle' , 'What is My Praesidium Central Hub?' )->with ( 'sDebugMessages' , $sDebugMessages ) ; 
```

**看法：**

```
pre>{{ $sDebugMessages }}</pre> 
```

**结果（已编辑，原因应该很明显：**

```
$_ENV = Array
(
    [APP_ENV] => local
    [APP_KEY] => xxxxxxxxxxxxxxx
    [APP_DEBUG] => true
    [APP_LOG_LEVEL] => debug
    [APP_URL] => https://localhost
    [DB_CONNECTION] => mysql
    [DB_HOST] => localhost:3306
    [DB_DATABASE] => xxxxxxxxxxxxxxx
    [DB_USERNAME] => xxxxxxxxxxxxxxx
    [DB_PASSWORD] => xxxxxxxxxxxxxxx
    [BROADCAST_DRIVER] => log
    [CACHE_DRIVER] => file
    [SESSION_DRIVER] => database
    [QUEUE_DRIVER] => sync
    [MAIL_DRIVER] => smtp
    [MAIL_HOST] => xxxxxxxxxxxxxxx
    [MAIL_PORT] => 587
    [MAIL_ENCRYPTION] => tls
    [MAIL_USERNAME] => xxxxxxxxxxxxxxx
    [MAIL_PASSWORD] => xxxxxxxxxxxxxxx
    [MAIL_FROM_ADDRESS] => xxxxxxxxxxxxxxx
    [MAIL_FROM_NAME] => xxxxxxxxxxxxxxx
    [MAIL_MODE] => xxxxxxxxxxxxxxx
    [MAIL_MODE_EMAIL] => xxxxxxxxxxxxxxx
) 
```

# matlab - 在Matlab中估计样本协方差矩阵的特征值的方差

> ID：13211993
> 
> 赞同：4
> 
> 时间：2012-11-03T18:05:33.753
> 
> 标签：matlab, statistics, covariance, variance, eigenvalue

我正在尝试使用 Matlab 研究样本协方差矩阵的特征值的统计方差。为了澄清，每个**样本**协方差矩阵由**有限**数量的矢量快照（受随机高斯白噪声影响）构成。然后，经过**大量**试验，生成大量此类矩阵并进行特征分解，以估计特征值的**理论**统计量。

根据几个来源（例如，参见 [1, Eq.3] 和 [2, Eq.11]），每个**样本**特征值的方差应该等于**理论**特征值的平方除以使用的矢量快照数对于每个协方差矩阵。但是，我从 Matlab 得到的结果甚至还不够接近。

这是我的代码的问题吗？用matlab？（我在处理类似问题时从来没有遇到过这样的麻烦）。

这是一个非常简单的例子：

```
% Data vector length
Lvec = 5;
% Number of snapshots per sample covariance matrix
N = 200;
% Number of simulation trials
Ntrials = 10000;
% Noise variance
sigma2 = 10;

% Theoretical covariance matrix
Rnn_th = sigma2*eye(Lvec);
% Theoretical eigenvalues (should all be sigma2)
lambda_th = sort(eig(Rnn_th),'descend');

lambda = zeros(Lvec,Ntrials);
for trial = 1:Ntrials
    % Generate new (complex) white Gaussian noise data
    n = sqrt(sigma2/2)*(randn(Lvec,N) + 1j*randn(Lvec,N));
    % Sample covariance matrix
    Rnn = n*n'/N;
    % Save sample eigenvalues
    lambda(:,trial) = sort(eig(Rnn),'descend');   
end

% Estimated eigenvalue covariance matrix
b = lambda - lambda_th(:,ones(1,Ntrials));
Rbb = b*b'/Ntrials
% Predicted (approximate) theoretical result
Rbb_th_approx = diag(lambda_th.^2/N) 
```

参考：

[1] 弗里德兰德，B.；韦斯，AJ；，“[关于样本协方差矩阵的特征向量的二阶统计](http://www.scribd.com/doc/112067632)，”信号处理，IEEE Transactions on，第 46 卷，第 11 期，第 3136-3139 页，1998 年 11 月 [2] Kaveh，M.；巴拉贝尔，A。, “ [MUSIC 的统计性能和解决噪声中平面波的最小范数算法](http://www.scribd.com/doc/112046406/Kaveh-86)”，声学、语音和信号处理，IEEE Transactions on，第 34 卷，第 2 期，第 331-341 页，1986 年 4 月

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T20:56:28.893

根据您第一次参考的摘要：

“特征向量的二阶统计公式已经在统计文献中推导出来并被广泛使用。我们指出，由于特征向量定义的非唯一性，在数值模拟中观察到的统计数据与理论公式之间存在差异。我们提出了两种解决这种差异的方法。第一种涉及修改理论公式以匹配计算结果。第二种涉及对计算进行简单修改以使其与现有公式匹配。”

听起来存在差异，而且这两个“解决方案”听起来也是黑客，但如果没有实际的论文，这很难提供帮助。

# erlang - 使用 Erlang 沙盒化用户代码

> ID：13211999
> 
> 赞同：5
> 
> 时间：2012-11-03T18:06:30.400
> 
> 标签：erlang, sandbox, unsafe

据我所知，Erlang 为错误处理和进程隔离提供了高级功能。

我正在构建一个系统，允许用户提交他们的代码以在共享服务器环境中执行并且需要使其安全。

要求是：

*   分别限制每个用户进程的 CPU 和内存使用量。
*   禁止用户进程与其他进程通信（一些专门为此目的设计的进程除外）。
*   禁止访问所有系统资源（shell、文件系统……）。
*   在错误或高资源消耗的情况下终止用户进程。

是否有可能使用 Erlang 完成所有这些并保持其性能高效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T21:00:25.793

一般来说，Erlang 不提供用户可以注入的沙箱代码的方法。您可以尝试编写自己的保护代码，但这相当困难。

更好的选择可能是像“safe haskell”这样的语言：

[http://www.haskell.org/ghc/docs/7.4.2/html/users_guide/safe-haskell.html](http://www.haskell.org/ghc/docs/7.4.2/html/users_guide/safe-haskell.html)

这是专门为做这种事情而设计的。

Erlang 提供的隔离并不是为了防止恶意模块被注入。事实上，分布式情况下也没有这样的保护。两台机器连接后，您可以对另一台机器执行的操作没有限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T07:30:57.783

过去已经在 Safe Erlang 上进行了一些工作，您可以找到几篇关于它的论文。ErlHive 项目以一种有趣的方式解决了这个问题。