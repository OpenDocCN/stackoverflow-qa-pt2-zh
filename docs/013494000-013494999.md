# StackOverflow 问答 13494000-13494999

# c# - 在设计时单击“CollectionEditor”窗口的“确定”按钮后将子控件添加到自定义控件

> ID：13494003
> 
> 赞同：6
> 
> 时间：2012-11-21T13:09:22.273
> 
> 标签：c#, winforms, runtime, custom-controls, design-time

我已经创建了我的自定义控件。它有一个名为“Tab”的属性。此属性将从“DockContainerItem”类继承的“FloorsInformation”控件的集合添加到我的自定义控件中。

![我的自定义控件属性](../Images/29c8e1b78082cbe1fe062be86894fd64.png)

现在，我想在单击选项卡“CollectionEditor”窗口的“确定”按钮后将“FloorsInformation”控件添加到我的自定义控件中。

![](../Images/5e721018340bea78e16985baa7ffb1a9.png)

我有这样做的“AddTabs”方法。但是，我不能在正确的地方调用它。我必须在“Tab”属性的“set accessor”中调用“AddTabs”方法，但它永远不会发生。

我也可以从“Tab”属性的“get accessor”中调用这个方法，但是在“Tab”属性的“get accessor”中调用这个方法会报错，因为程序访问“get accessor”的“Tab”属性连续。

```
[Designer("System.Windows.Forms.Design.ParentControlDesigner, System.Design", typeof(IDesigner))]
[ToolboxItem(true), ToolboxBitmap(typeof(ToolboxIconResourceFinder), "FloorsGrouping.bmp")]
[DisplayName("Floors Group")]
[Editor("WindowsFormsControlLibrary2.FloorsGrouping, WindowsFormsControlLibrary2, Version=1.0.0.0, Culture=neutral, PublicKeyToken=197889249da45bfc", typeof(UITypeEditor))]
[Description("Floorssssssss")]
[Category("Saino")]
[DefaultProperty("Text")]
[DesignerCategory("Component")] //Form //Designer //Empty String ("")
public partial class FloorsGrouping : Bar
{
    private Tabs tabs = new Tabs();

    public FloorsGrouping()
    {
        InitializeComponent();
        this.AutoHide = true;
    }

    [Category("Data")]
    [DisplayName("Tabs")]
    [Description("Tabsssssssssssss")]
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
    [Editor(typeof(ItemsCollectionEditor), typeof(UITypeEditor))]
    public Tabs Tab
    {
        get
        {
            //AddTabs();
            return tabs;
        }
        //set
        //{
            //AddTabs();
        //}
    }

    public void AddTabs()
    {
        foreach (DockContainerItem dciItem in Tab)
        {
            if (!Parent.Controls.ContainsKey(dciItem.Name))
            {
                Items.Add(dciItem);
            }
        }
    }
}

[DisplayName("Floors Information")]
[Description("Floors Informationnnnnnnnnnnnnnnn")]
[DefaultProperty("Text")]
[DesignerCategory("Component")]
[ToolboxItem(false)]
public class FloorsInformation : DockContainerItem
{
    /// <summary>
    /// Required designer variable.
    /// </summary>
    private System.ComponentModel.IContainer components = null;

    private SimilarFloorsInformation similarFloorsInformation = new SimilarFloorsInformation();
    private AllFloorsInformation allFloorsInformation = new AllFloorsInformation();
    private string text = "Floors Information";

    public FloorsInformation()
    {

    }

    [Category("Data")]
    [DisplayName("Similar Floors Panel")]
    [Description("Similar Floors Panellllllllllllllllllll")]
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
    public SimilarFloorsInformation SimilarFloorsInfo
    {
        get
        {
            return similarFloorsInformation;
        }
        set
        {
            similarFloorsInformation = value;
        }
    }

    [Category("Data")]
    [DisplayName("All Floors Group")]
    [Description("All Floors Groupppppppppppppp")]
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
    public AllFloorsInformation AllFloorsInfo
    {
        get
        {
            return allFloorsInformation;
        }
        set
        {
            allFloorsInformation = value;
        }
    }

    protected override void Dispose(bool disposing)
    {
        if (disposing && (components != null))
        {
            components.Dispose();
        }
        base.Dispose(disposing);
    }
}

public class Tabs : CollectionBase
{
    public FloorsInformation this[int intIndex]
    {
        get
        {
            return (FloorsInformation)InnerList[intIndex];
        }
        set
        {
            InnerList[intIndex] = value;
        }
    }

    public int Add(FloorsInformation finfItemType)
    {
        return InnerList.Add(finfItemType);
    }

    public bool Contains(FloorsInformation finfItemType)
    {
        return InnerList.Contains(finfItemType);
    }

    public void Remove(FloorsInformation finfItemType)
    {
        InnerList.Remove(finfItemType);
    }

    public void Insert(int intIndex, FloorsInformation finfItemType)
    {
        InnerList.Insert(intIndex, finfItemType);
    }

    public FloorsInformation[] GetValues()
    {
        FloorsInformation[] finfItemType = new FloorsInformation[InnerList.Count];
        InnerList.CopyTo(0, finfItemType, 0, InnerList.Count);
        return finfItemType;
    }
} 
```

顺便说一句，我可以在继承自“CollectionEditor”类的“ItemsCollectionEditor”类的“SetItems”覆盖方法中调用此方法；尽管如此，如果不创建自定义控件类的新实例，我将无法访问“AddTabs”方法。如果我创建自定义控件的新实例，“AddTabs”方法会将更改应用于自定义控件的新控件，而不是 WinForm 中当前添加的自定义控件。

```
public class ItemsCollectionEditor : CollectionEditor
{
    private Type[] typItems;

    public ItemsCollectionEditor(Type typItem)
        : base(typItem)
    {
        typItems = new Type[] { typeof(FloorsInformation) };
    }

    protected override Type[] CreateNewItemTypes()
    {
        return typItems;
    }

    protected override CollectionForm CreateCollectionForm()
    {
        CollectionForm collectionForm = base.CreateCollectionForm();
        collectionForm.Text = "Tabs Collection Editor";
        return collectionForm;
        //return base.CreateCollectionForm();
    }

    protected override object SetItems(object editValue, object[] value)
    {
        return base.SetItems(editValue, value);
    }
} 
```

我必须做什么才能实现我的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T02:51:54.407

你有几个选择。

**选项1：**

如果您只是想`FloorsGrouping.Items`在设计时公开该属性，您可以将`Tab`属性的类型更改为`SubItemsCollection`并返回该`Items`属性。在这种情况下，您不必担心拦截任何集合更改事件，它会自动为您发生。

```
[Category("Data")]
[DisplayName("Tabs")]
[Description("Tabsssssssssssss")]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
[Editor(typeof(ItemsCollectionEditor), typeof(UITypeEditor))]
public SubItemsCollection Tab {
    get {
        return Items;
    }
} 
```

**选项 2：**

如果您需要拦截集合更改事件，请将`Tabs`类修改为继承自`ObservableCollection<FloorsInformation>`，实现`INotifyCollectionChanged`.

```
public class Tabs : System.Collections.ObjectModel.ObservableCollection<FloorsInformation> {
} 
```

在您的`FloorsGrouping`构造函数中，订阅该`CollectionChanged`事件。

```
public FloorsGrouping() {
    ...
    tabs.CollectionChanged += new System.Collections.Specialized.NotifyCollectionChangedEventHandler(tabs_CollectionChanged);
} 
```

最后，在您的事件处理程序中，处理集合更改。

```
private void tabs_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e) {
    switch (e.Action) {
        case System.Collections.Specialized.NotifyCollectionChangedAction.Add:
            foreach (DockContainerItem dciItem in e.NewItems) {
                if (!Parent.Controls.ContainsKey(dciItem.Name))
                    Items.Add(dciItem);
            }
            break;
        case System.Collections.Specialized.NotifyCollectionChangedAction.Reset:
            Items.Clear();
            break;
    }
} 
```

对于选项 2，您会注意到`CollectionChanged`事件是在集合编辑器中进行编辑时实时触发的，而不是在单击 OK 按钮时。但是，当用户最终在集合编辑器中单击“确定”或“取消”按钮时，集合的状态是准确的。

# java - 在 java web start 应用程序中禁用字节码验证

> ID：13494004
> 
> 赞同：1
> 
> 时间：2012-11-21T13:09:25.437
> 
> 标签：java, classloader, jnlp, java-web-start

我有一个 java web start 应用程序，我需要从 jnlp 文件中禁用字节码验证。

这可以通过设置 JAVAWS_VM_ARGS=" *-noverify* " 或设置*-Xverify:none*轻松完成，但此处的[文档](http://docs.oracle.com/javase/6/docs/technotes/guides/javaws/developersguide/syntax.html#resources)说 web start 不支持**在 jnlp 文件中**添加这些参数。

我试过这个：

`<j2se version="1.6+" java-vm-args="-noverify -showversion -verbose" >`

在资源标签下，但它跳过*-noverify*并采用另外两个。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T13:28:00.647

> ...但是这里的文档说 web start 不支持在 jnlp 文件中添加这些参数。

没错，IMO。如果您可以禁用字节码验证，则可以破坏 JVM 类型安全，并击败 JNLP 安全沙箱。

* * *

如果您必须禁用字节码验证才能让您的应用程序运行，那么它就存在严重问题。我的建议是解决导致字节码验证失败的问题，而不是关闭它。

# javascript - Jquery 插件在选择/单击时返回

> ID：13494007
> 
> 赞同：0
> 
> 时间：2012-11-21T13:09:42.447
> 
> 标签：javascript, jquery, jquery-plugins

在我[之前的问题](https://stackoverflow.com/questions/13305494/deciding-on-jquery-plugin-structure)没有得到答案的情况下，我决定继续使用这个插件结构。

```
(function ( $ ) {

$.fn.myPlugin = function (options) {
options = $.extend( {}, $.fn.myPlugin.defaults, options );
    return this.each(function (i, el) {
     ("someiD").live("click",function() {
            UpdateCounter();
        });

    });
};

$.fn.myPlugin.defaults = {
///options here for overiding
};
}(jQuery)); 
```

我制作了一个插件，我必须在其中选择一个按钮来增加一个计数器，然后我不知道如何获取计数器的更新值，即按钮的 OnSelect/OnClick.... 谁能给我任何在不改变我的插件结构的情况下我应该如何处理这个问题的见解？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:13:37.180

基本上是这样的：

```
(function ( $ ) {
  $.fn.myPlugin = function (options) {
    options = $.extend( {}, $.fn.myPlugin.defaults, options );

    // $(this) is your selected element, #someSelect in this case
    $(this).on('select', function(e) {
      console.log('selected!')
    })

};

// execute your plugin on the selected element
$('#someSelect').myPlugin(); 
```

# delphi - 关于创建类结构的想法

> ID：13494009
> 
> 赞同：1
> 
> 时间：2012-11-21T13:09:46.473
> 
> 标签：delphi, frameworks

我有一个使用多个类和组件开发的框架。我想创建一个可以访问整个框架的主对象，以便所有开发人员都可以从一个位置访问这些方法。

例子：

```
MyApp.Framework.DataBase
MyApp.Framework.DateUtils
MyApp.Framework.Users
MyApp.Framework.System 
```

该对象`MyApp`映射整个框架，所有开发人员随时都可以完全访问。

主要问题是创建一个健壮且易于扩展的结构。过一会儿我会介绍我们公司产品的功能结构和方法。

**例子：**

```
MyApp.Blog.    (functions about Blog product)
MyApp.WebDocs. (functions WebDocs product) 
```

关于类的更多示例：

```
TMyAppBase = Class
Private
  Function GetDatabase: TDataBaseClass;
  Function GetUsers: TSystemUsersClass;
  Function GetForms: TFormManager;
Public
  Constructor Create; Virtual;
  Destructor Destroy; Override;
  Property Database: TDataBaseClass Read GetDatabase;
  Property Users: TSystemUsersClass Read GetUsuarios;
  Property Forms: TFormManager Read GetForms;
End; 
```

使用这个类：

```
var
  LMyApp: TMyAppBase 

begin
  ShowMessage(LMyApp.Users.ActiveUserName);
end; 
```

那会是朋友吗，如果可能的话，我想从你那里得到想法。我的意图是创建一个单一且广泛的结构。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:43:30.283

您不必为此创建一个类。

只需创建一个命名的单元`MyApp.Framework.DataBase`等等。Delphi 支持单位中的点，这使得创建“命名空间”成为可能。

`Myapp.`当您开始输入使用列表时，Delphi 甚至会自动完成。

此外，您可以创建一个`TDataBase`具有静态方法的类，您可以调用该类`TDataBase.Method`来在公共范围内组织简单的函数/过程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T20:09:12.640

正如我已经在评论中写的那样，我认为在这种情况下，使用一个主要**服务**（主类，单例）是一个好主意，它可以让您访问其他服务。您的所有模块都有唯一的 ID ( `TGUID`)。在程序执行开始时，他们应该在主服务中注册自己。
例如。主要服务单位：

```
unit AppServices;

interface
uses generics.collections, rtti;
type
    // Unique ID Attribute for services
    ServiceIDAttribute = class(TCustomAttribute)
      strict private
        FId : TGUID;
      public
        constructor Create(ServiceID: string);
        property ID : TGUID read FId;
    end;

    //Services Base class
    TCustomAppService = class(TObject)
      strict protected
      public
    end;

    // Main Service Object
    TAppServices = class(TObject)
      strict private
       class var
        FServices : TObjectDictionary<TGUID, TCustomAppService>;
       var
      public
        class constructor Create();
        class destructor Destroy();
        class procedure RegisterService(aService : TCustomAppService);
        class function QueryService(ServiceID : TGUID):TCustomAppService;
    end; 
```

这里`class constructor`&`destructor`简单地创建和释放 `FServices`字典。`QueryService`方法通过其唯一 ID 返回 Service：

```
class function TAppServices.QueryService(ServiceID: TGUID): TCustomAppService;
begin
    result := nil;
    if FServices.ContainsKey(ServiceID) then
        result := FServices[ServiceID];
end; 
```

方法从参数的类名`RegisterService`中提取`RTTI`Attribute ( `ServciceIDAttribute`) 并将这一对 (id-service) 添加到字典中：

```
class procedure TAppServices.RegisterService(aService: TCustomAppService);
var ctx : TRttiContext;
    st : TRttiType;
    a : TCustomAttribute;
    id : TGUID;
begin
    ctx := TRttiContext.Create();
    try
        st := ctx.GetType(aService.ClassType);
        for a in st.GetAttributes() do begin
            if not (a is ServiceIDAttribute) then
                continue;
            id := ServiceIDAttribute(a).ID;

            FServices.AddOrSetValue(id, aService);
            break;
        end;
    finally
        ctx.Free();
    end;
end; 
```

现在，关于终端服务。例如 UserManager 单元：

```
unit UserManager;

interface
uses AppServices;

const
    SID_UserManager : TGUID = '{D94C9E3A-E645-4749-AB15-02631F21EC4E}';
type
    [ServiceID('{D94C9E3A-E645-4749-AB15-02631F21EC4E}')]
    TUserManager = class(TCustomAppService)
      strict private
        FActiveUserName: string;
      public
        property ActiveUserName: string read FActiveUserName;
    end;

implementation

initialization
    TAppServices.RegisterService(TUserManager.Create());
end. 
```

现在我们可以测试我们的代码：

```
procedure TestApp();
var uMgr :TUserManager;
    dbMgr : TDBmanager;
begin
    dbMgr := TAppServices.QueryService(SID_DBManager) as TDBManager;
    if dbMgr.Connected then
         writeln('connected!')
    else writeln('not connected');

    uMgr := TAppServices.QueryService(SID_UserManager) as TUserManager;
    writeln('Active user: ', uMgr.ActiveUserName);
end; 
```

**摘要：**
`TAppServices`是主要对象，提供对 App 中任何服务的访问。它对终端服务一无所知，因此它没有依赖关系。您可以根据需要更改其实现。您可以根据需要拥有尽可能多的 TCustomAppService 类后代。向应用程序添加新服务时，不应更改`TAppServices`类接口或实现。

# oracle11g - oracle字典视图中数字和整数数据类型之间的区别

> ID：13494010
> 
> 赞同：46
> 
> 时间：2012-11-21T13:09:53.897
> 
> 标签：oracle11g

我使用 oracle 字典视图来找出两个模式之间的列差异（如果有的话）。在同步数据类型差异时，我发现 NUMBER 和 INTEGER 数据类型都存储在 all_tab_columns/user_tab_columns/dba_tab_columns 中，因此很难同步一个模式/列具有数字数据类型而另一个模式/列具有整数数据类型的数据类型差异.

在比较模式时，它显示数据类型不匹配。请建议是否有任何其他替代形式使用字典视图，或者是否可以使用字典视图中的任何特定属性来识别数据类型是否为整数。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2014-05-28T15:51:19.760

我发现的最好的解释是：

INTEGER 和 NUMBER 有什么区别？我们什么时候应该使用 NUMBER，什么时候应该使用 INTEGER？我只是想在这里更新我的评论......

NUMBER 总是在我们输入时存储。比例为 -84 到 127。但 INTEGER 会四舍五入为整数。INTEGER 的小数位数为 0。INTEGER 等价于 NUMBER(38,0)。这意味着，INTEGER 是受约束的数字。小数位将被四舍五入。但 NUMBER 不受限制。

*   整数（12.2）=> 12
*   整数（12.5）=> 13
*   整数（12.9）=> 13
*   整数(12.4) => 12
*   数字（12.2）=> 12.2
*   数字（12.5）=> 12.5
*   数字（12.9）=> 12.9
*   数字（12.4）=> 12.4

INTEGER 总是比 NUMBER 慢。由于整数是一个带有附加约束的数字。强制执行约束需要额外的 CPU 周期。我从来没有看到任何差异，但是当我们在 INTEGER 列上加载数百万条记录时可能会有差异。如果我们需要确保输入是整数，那么 INTEGER 是最好的选择。否则，我们可以坚持使用 NUMBER 数据类型。

这是[链接](http://myorastuff.blogspot.com.ar/2009/04/integer-versus-number-data-type.html)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-09-06T00:11:34.917

整数仅适用于 sql 标准，即被 Oracle 弃用。

您应该改用数字。

无论如何，Oracle 在幕后将整数存储为 Number。

最常见的是，当为 ID 存储整数时，它们是在没有参数的情况下定义的——所以理论上你可以查看元数据视图的比例和精度列，看看是否可以存储十进制值——但是 99% 的时间是这样的不会有帮助的。

正如上面评论的那样，您可以查找 number(38,0) 列或类似的列（即不允许小数点的列），但这只会告诉您哪些列不能带小数，而不是定义了哪些列以便可以存储 INTS .

建议：对数字列进行数据分析。像这样的东西：

```
 select max( case when trunc(column_name,0)=column_name then 0 else 1 end ) as has_dec_vals
 from table_name 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-11-13T10:37:46.640

这是我从[oracle 文档](http://docs.oracle.com/cd/B19306_01/olap.102/b14346/dml_datatypes002.htm)中得到的，但它适用于 oracle 10g 第 2 版：

当您定义一个 NUMBER 变量时，您可以指定它的精度 (p) 和比例 (s)，以便它足够大，但不是不必要的大。精度是有效位数。规模可以是正的或负的。正刻度标识小数点右边的位数；负数表示小数点左侧可以向上或向下舍入的位数。

Oracle 数据库标准库支持**NUMBER**数据类型，其运行方式与 SQL 中的相同。**当文本或INTEGER**数据类型不合适时，它用于维度和代理项。它通常分配给不用于计算的变量（如预测和聚合），并且用于必须匹配数据库的舍入行为或需要高精度的变量。在决定是否将 NUMBER 数据类型分配给变量时，请记住以下事实以**最大限度地提高性能**：

*   NUMBER 变量的分析工作区计算比其他数值数据类型慢，因为 NUMBER 值是在软件中计算的（为了准确性）而不是在硬件中（为了速度）。
*   将数据从分析工作区提取到具有 NUMBER 数据类型的关系列时，如果数据在分析工作区中已经具有 NUMBER 数据类型，则性能最佳，因为不需要转换步骤。

# websphere - wsadmin + jython 重启 WAS 应用服务器

> ID：13494012
> 
> 赞同：6
> 
> 时间：2012-11-21T13:09:58.260
> 
> 标签：websphere, jython, websphere-7, wsadmin, server-administration

是否可以使用 wsadmin (jacl/jython) 停止/启动 WAS appserver。我想删除配置文件上的所有缓存，然后重新启动 WAS 应用服务器。我将 wsadmin 用作独立设备。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-22T13:16:12.263

您可以从 wsadmin 发出命令（使用 Jython）：

```
AdminControl.invoke(AdminControl.queryNames('WebSphere:*,type=Server,node=%s,process=%s' % ('YourNodeName', 'YourServerName')), 'restart') 
```

与 WAS Base & ND 一起使用。使用 ND，您还有另一种选择：

```
AdminControl.invoke(AdminControl.queryNames('WebSphere:*,type=Server,node=%s,process=%s' % ('YourNodeName', 'YourServerName')), 'stop')
# now your server is stopped, you can do any cleanup
# and then start the server with NodeAgent
AdminControl.invoke(AdminControl.queryNames('WebSphere:*,type=NodeAgent,node=%s' % 'YourNodeName'), 'launchProcess', ['YourServerName'], ['java.lang.String']) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T15:37:20.570

查看[wsadminlib 脚本](http://www.ibm.com/developerworks/websphere/library/samples/SampleScripts.html)。它为您编写了 500 多种方法来执行特定的 wsadmin 任务。还可以查看相关[的 wsadminlib 博客](http://wsadminlib.blogspot.com/)——您肯定想查看此站点上的 powerpoint 以了解使用情况。

您没有指定要清除的缓存。如果要清除 dynacache，wsadminlib 提供了 clearDynaCache、clearAllProxyCaches 等以及服务器重启方法。

示例用法：

```
import sys
execfile('/opt/software/portalsoftware/wsadminlib/wsadminlib.py')
clearAllProxyCaches()
for (nodename,servername) in listAllAppServers():    
    clearDynaCache( nodename, servername, dynacachename )
    save()
    maxwaitseconds=300
    restartServer( nodename, servername, maxwaitseconds) 
```

# windows - Windows Azure Toolkit for Java 插件无法在 Mac 上运行

> ID：13494013
> 
> 赞同：2
> 
> 时间：2012-11-21T13:09:59.820
> 
> 标签：windows, service, azure, cloud

我正在尝试创建 Windows Azure 云服务。因此，我在我的 Mac 上使用了 Eclipse (Indigo)。

首先，我需要安装*（Eclipse > 帮助 > 安装新软件 > [http://dl.msopentech.com/eclipse](http://dl.msopentech.com/eclipse)）*基于[本教程](http://msdn.microsoft.com/en-us/library/windowsazure/hh690946.aspx)的***Windows Azure Toolkit for Java***插件，但这在我的 Mac 上是不可能的。在 Windows 机器上没有问题！

安装插件时抛出以下错误：

```
Cannot complete the install because some dependencies are not satisfiable
com.microsoftopentechnologies.wacommon.feature.feature.group [1.8.0.201211010928] cannot be installed in this environment because its filter is not applicable. 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-14T11:16:34.433

刚刚在 Linux 上遇到了同样的问题，这是由于应用于插件的操作系统过滤器限制了它在 Windows 上的使用。有关在 Linux 上运行 Eclipse 的用户的类似问题，请参阅此[SO 答案](https://stackoverflow.com/questions/15190279/unable-to-install-windows-azure-plugin-for-eclipse-with-java-by-microsoft-openhttp://)。Eclipse 的 Windows Azure 插件依赖于 .NET SDK，并且可以使用模拟器（如 Visual Studio）调试程序，因此不能在 Linux/Unix 环境中使用。

在官方网站上查看插件的[完整描述](http://msdn.microsoft.com/en-us/library/windowsazure/hh694271.aspx)。

但正如答案中所述，您仍然可以使用 Windows Azure SDK for Java 在 Linux 或 MacOS 上开发程序。

# list - 从一个列表到另一个列表的元素

> ID：13494014
> 
> 赞同：-2
> 
> 时间：2012-11-21T13:10:05.037
> 
> 标签：list, f#

我有这个问题：

我有一个带有 let say`[2;1;2;1;4;1]`和一个 int 的列表，如果它在第一个列表中，我想将整数添加到一个新列表中，这意味着结果应该是一个新列表，`[1;1;1]`如果整数为 1，我相信我可以使用尾递归，我使用谷歌并在stackoverflow上寻找类似的东西，但我找不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:17:47.367

我建议你看看内置的高阶函数：

```
[2; 1; 2; 1; 4; 1] |> List.filter (fun e -> e <= 1) 
```

这对你来说已经是尾递归了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:28:18.897

```
let findOccurences e = List.filter ((=) e) 
```

# c++ - 如何在opengl中获得聚光灯？

> ID：13494019
> 
> 赞同：2
> 
> 时间：2012-11-21T13:10:07.807
> 
> 标签：c++, opengl

参考 [http://www.chai3d.org/doc/classc_light.html](http://www.chai3d.org/doc/classc_light.html)

代码

```
 light2->setPos(cVector3d( 0, 0,0.0));  // position the light source
    light2->m_ambient.set(0.8, 0.8, 0.8);
    light2->m_diffuse.set(0.8, 0.8, 0.8);
    light2->m_specular.set(0.8, 0.8, 0.8);
    light2->setDirectionalLight(false);//make a positional light 
```

使用opengl的渲染代码是

```
void cLight::renderLightSource()
{
    // check if light source enabled
    if (m_enabled == false)
    {
        // disable OpenGL light source
        glDisable(m_glLightNumber);
        return;
    }

    computeGlobalCurrentObjectOnly();

    // enable this light in OpenGL
    glEnable(m_glLightNumber);

    // set lighting components
    glLightfv(m_glLightNumber, GL_AMBIENT,  m_ambient.pColor());
    glLightfv(m_glLightNumber, GL_DIFFUSE,  m_diffuse.pColor() );
    glLightfv(m_glLightNumber, GL_SPECULAR, m_specular.pColor());

    // position the light source in (global) space (because we're not
    // _rendered_ as part of the scene graph)
    float position[4];

    position[0] = (float)m_globalPos.x;
    position[1] = (float)m_globalPos.y;
    position[2] = (float)m_globalPos.z;
    //position[0] = (float)m_localPos.x;
    //position[1] = (float)m_localPos.y;
    //position[2] = (float)m_localPos.z;

    // Directional light source...
    if (m_directionalLight) position[3] = 0.0f;

    // Positional light source...
    else position[3] = 1.0f;

    glLightfv(m_glLightNumber, GL_POSITION, (const float *)&position);

    // set cutoff angle
    glLightf(m_glLightNumber, GL_SPOT_CUTOFF, m_cutOffAngle);

    // set the direction of my light beam, if I'm a _positional_ spotlight
    if (m_directionalLight == false)
    {
        cVector3d dir = m_globalRot.getCol0();
        float direction[4];
        direction[0] = (float)dir.x;
        direction[1] = (float)dir.y;
        direction[2] = (float)dir.z;
        direction[3] = 0.0f;
        glLightfv(m_glLightNumber, GL_SPOT_DIRECTION, (const float *)&direction);
    }

    // set attenuation factors
    glLightf(m_glLightNumber, GL_CONSTANT_ATTENUATION, m_attConstant);
    glLightf(m_glLightNumber, GL_LINEAR_ATTENUATION, m_attLinear);
    glLightf(m_glLightNumber, GL_QUADRATIC_ATTENUATION, m_attQuadratic);

    // set exponent factor
    glLightf(m_glLightNumber, GL_SPOT_EXPONENT, m_spotExponent);    
} 
```

为什么我要让整个环境均匀照明？如何在原点 0,0,0 周围获得集中光，在 1 或 2 个单位距离后消失？我的原点是网格中的中间立方体。![在此处输入图像描述](../Images/f758b72454fda0758deb01eb07982c26.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:45:24.753

警告购买者：这是我过去常常摸索OpenGL时的“从头顶上”。

我认为“定向光”的 OpenGL 概念有点像无限远的点光源，这意味着光矢量在整个场景中是不变的。

为了实现聚光灯效果，您需要形成光方向和光矢量（从顶点到光的矢量）的点积，并随着角度的增加以指数方式衰减光。

我记得曾经看过一个关于这个的教程，会搜索...

对，[这里](http://www.glprogramming.com/red/chapter05.html) 有描述 向下滚动到“聚光灯”的描述。

在您列出的代码中，我相信您需要确保`m_spotExponent`大于零才能获得“锥形”效果。较高的值会产生从锥体的“亮”到“暗”部分的“更清晰”的过渡（我认为）。

希望有帮助

# c++ - c++ 发送什么参数的问题

> ID：13494024
> 
> 赞同：4
> 
> 时间：2012-11-21T13:10:16.750
> 
> 标签：c++, pointers, parameters

我目前正在编写一个项目，我有一个看起来像这样的函数：

```
Room::addItem(Item*&); //not written by me 
```

我在理解作为参数发送什么时遇到了一些麻烦。“*&”对我来说搞砸了。

我尝试了以下方法：

```
foo.addItem(loadItem());         //Returns an Item-object
/*and*/
foo.addItem(loadItem());         //Returns an Item-pointer 
```

编辑：如果您解释一下“*&”的含义，那就太好了。下次我遇到它时，我想了解它；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:13:58.443

该`addItem`函数接受类型参数，`Item*`指针通过引用传递。这意味着该函数`addItem`可以在内部修改指针。这也可能意味着该对象正在此函数内被重新分配或修改。

例子：

```
void pointerByValue(int* ptr)
{
   ptr = new int[10];
}

void pointerByReference(int*& ptr)
{
  ptr = new int[10];
}

void main()
{
   int* p = NULL; //A NULL pointer

   pointerByValue(p); //p is still NULL

   pointerByReference(p); //memory has now been allocated to p
} 
```

引用指针仅在 C++ 中有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T13:14:57.520

在我看来，您的函数需要对指针的引用。例如，MSDN 有一些语法类似的[示例代码](http://msdn.microsoft.com/en-us/library/1sf8shae%28v=vs.80%29.aspx)。

```
// Add2: Add a node to the binary tree.
//       Uses reference to pointer
int Add2( BTree*& Root, char *szToAdd ) {
   if ( Root == 0 ) {
... 
```

您可能想要这样做的原因有多种，但您最喜欢的搜索引擎应该能够帮助您。一个为您指明正确方向的博客条目在[这里](http://markgodwin.blogspot.com/2009/08/c-reference-to-pointer.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T13:15:28.890

参数类型是对指向 an 的指针的引用`Item`，而您需要传递给它的是指向 an `Item`(ie `Item*`) 的指针，此外，它必须是左值（因为可能 `Room::addItem`会修改指针）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T13:17:31.290

您需要将指针传递给函数

```
Item item = loadItem()
foo.addItem(&item); 
```

& 表示该函数将使用引用并能够更改它的值

# highcharts - Highcharts 图例值将以降序显示

> ID：13494027
> 
> 赞同：0
> 
> 时间：2012-11-21T13:10:21.660
> 
> 标签：highcharts

如何按降序对图例值（*40, 80, 10, 5*）进行排序？

第一个值应该以**绿色**显示，然后其他 3 个将是任何颜色。

我尝试使用此代码以**绿色**显示我的第一个图例项。对图例项目进行排序的任何想法？

```
{name: '{/literal}{$value.0.opt1}:{$a}{literal}',y: {/literal}{$a}{literal}, color: '#6B8E23'}, //green
{name: '{/literal}{$value.0.opt2}:{$b}{literal}',y: {/literal}{$sort.0}{literal}, color: '#A9A9A9'},
{name: '{/literal}{$value.0.opt3}:{$c}{literal}',y: {/literal}{$sort.1}{literal}, color: '#696969'},
{name: '{/literal}{$value.0.opt4}:{$d}{literal}',y: {/literal}{$sort.2}{literal}, color: '#FFFFFF'}] 
```

*PS我不熟悉jQuery。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:49:59.220

快速排序图例值的唯一方法是按照您希望图例所在的顺序添加您的系列。请参阅[此](https://stackoverflow.com/questions/11725570/highcharts-specifying-order-of-stacked-time-series/11740025#11740025)答案。您也可以尝试创建一个 javascript 自定义图例来做您想做的事情 - 我没有快速回答如何做到这一点。如果您的意思是您想按降序对系列中的**点**进行排序，您首先需要提供一个实际数据的示例：它是基于时间的吗？类别？线性？

要将系列中的第一个值设为绿色，您可以像[这样](http://api.highcharts.com/highcharts#series.data.color)使用点颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T07:46:50.173

我找到了解决办法。您应该在传递数据中的值之前对图例值进行排序。然后在数组中设置颜色。

# swfobject - SWFobject flashvars 嵌入问题

> ID：13494031
> 
> 赞同：1
> 
> 时间：2012-11-21T13:10:35.097
> 
> 标签：swfobject, flashvars

在我的 WordPress 博客上实施[EasyCaptions](http://pipwerks.com/laboratory/easycaptions/)，但我碰了壁。任何帮助，将不胜感激。我正在使用 SWFobject 嵌入视频。我已将此代码：[http](http://pastebin.com/0ZMSr0Bz) ://pastebin.com/0ZMSr0Bz 粘贴到我的 header.php 中，并将此代码嵌入到我的帖子中：

```
<video id="video-html5" width="480" height="320" controls="controls"
        source src="[url to video]" />
</video> 
```

问题是该实现仅适用于此处定义的视频：

```
var flashvars = { file:'[video url]', ... 
```

所有其他视频嵌入都不起作用。我试过使用播放列表，但这并没有解决问题。我该如何解决这个问题？我需要额外的 JS 或 PHP 代码来添加到文件参数吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T19:07:17.373

[编辑帖子]

我刚刚重新阅读了您的问题并查看了 pastebin。您使用的视频 URL 是一个 HTML 文件：http: [//vidbull.com/embed-iqkhawkkx1rn-640x318.html](http://vidbull.com/embed-iqkhawkkx1rn-640x318.html)。您不能将 HTML 文件加载为视频。

使用正确的视频 URL（MP4、F4V、OGG 等）再试一次。

-- 根据 OP 的评论更新 --

问题是您在 WordPress 标头中对视频 URL 进行了硬编码。您需要做的是改用变量。我建议使用 WordPress 的[“短代码”API](http://codex.wordpress.org/Shortcode_API)，这将使您能够通过自定义短代码传递变量。

在 WordPress 中定义您的简码，例如：

```
//[easycaptions]
function embed_easycaptions( $atts ){
  //your custom PHP code here, using the passed $atts
}

add_shortcode( 'easycaptions', 'embed_easycaptions' ); 
```

然后在创作 WordPress 博客文章时，在需要的地方添加自定义短代码，例如

```
[easycaptions url='http://localhost/wordpress1/wp-content/uploads/2012/10/Sheldon-in-a-Dress.mp4'] 
```

查看[Shortcode API](http://codex.wordpress.org/Shortcode_API)页面以获取说明和示例。这是一个非常强大的系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T18:36:25.430

解决方案在于不在 header.php 中硬编码视频 url。这是解决这个问题的方法。我首先在wordpress中创建了一个自定义字段，命名为thinema，然后将自定义字段的值设置为帖子中嵌入的视频url。然后将此代码编辑到我的 header.php 中

```
flashvars = { file: '<?php echo get_post_meta(get_the_ID(), thinema, true); ?>'... 
```

我已经更新了 pastebin 中的代码。希望这对某人有用！您可以在[此处](http://www.whooshtranscription.com/sheldon-amy-marriage-and-a-gravy-boat/)查看实现。

# zeromq - ZeroMQ 与 Crossroads I/O

> ID：13494033
> 
> 赞同：48
> 
> 时间：2012-11-21T13:10:48.183
> 
> 标签：zeromq, crossroads-io

我正在研究使用 ZeroMQ 作为相当大的分布式系统的消息传递/传输层，主要针对监视和数据收集（许多生产者，一些消费者）。

据我所知，同一个概念目前有两种不同的实现；ZeroMQ 和 Crossroads I/O，后者是 ZeroMQ 的一个分支（2012 年？）。

我试图找出使用哪一个并想知道它们之间的差异，但到目前为止还没有找到太多关于此的信息。

**例如：**

*   它们在电线上兼容吗？
*   它们是否与 API 兼容，即某种通用的基础 API，可能带有不同的附加组件？
*   它们是否都实现了对 ZMTP（ZeroMQ 消息传输协议）的支持？
*   他们是否对未来的发展有某种共同的理解，还是会继续朝着两个不同的、可能不同的方向发展？
*   相对于其他的优点/缺点是什么？

**基本上，一个人如何选择一个而不是另一个？**

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-11-22T04:25:23.113

Crossroads.io 已经死了，因为 Martin Sustrik 已经开始使用 C 语言的新堆栈，称为 nano：[https ://github.com/250bpm/nanomsg](https://github.com/250bpm/nanomsg)

Crossroads.io 没有，afaik，实现 ZMTP/1.0 或 ZMTP/2.0，但它自己的协议版本。

Nano 具有可插拔传输，我们可能会为此制作 ZMTP 传输。Nano 真的很不错，是对原始 libzmq 库的重新思考，如果它成功，将制作一个很好的新内核。

理想情况下，Nano 将在 API 和协议级别进行互操作，因此成为 libzmq 的可插拔替代品。不过，它确实还有很长的路要走。

请注意，现在出现了几个对 libzmq 的重写，包括 JeroMQ (Java) 和 NetMQ (C#)。这两个确实正确地实现了 ZMTP/1.0 和 ZMTP/2.0。还有其他库，例如 Axon (https://github.com/visionmedia/axon)，它们深受 0MQ 的启发，但不兼容。

根据经验，用户最看重互操作性比其他任何东西都重要，因此不同的类似 0MQ 的堆栈很可能最终会使用相同的协议。

# c# - WCF REST 消息记录，POST 请求问题

> ID：13494036
> 
> 赞同：2
> 
> 时间：2012-11-21T13:10:50.743
> 
> 标签：c#, wcf, rest, post, logging

我得到了 WCF REST 服务，我希望记录从该服务接收\发送的每条消息。在我的 app.config 中，我得到了这个配置：

```
 <system.serviceModel>
  <diagnostics>
      <messageLogging logEntireMessage="true" logMalformedMessages="true"
        logMessagesAtServiceLevel="true" logMessagesAtTransportLevel="true" />
    </diagnostics>
  </system.serviceModel>    
<system.diagnostics>
    <sources>
    <source name="System.ServiceModel.MessageLogging" switchValue="Warning,ActivityTracing">
            <listeners>
                <add type="System.Diagnostics.DefaultTraceListener" name="Default">
                    <filter type="" />
                </add>
                <add name="ServiceModelMessageLoggingListener">
                    <filter type="" />
                </add>
            </listeners>
        </source>     
    </sources>
    <sharedListeners>
      <add initializeData="logs\\messages.svclog"
              type="System.Diagnostics.XmlWriterTraceListener, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
              name="ServiceModelMessageLoggingListener" traceOutputOptions="Timestamp">
              <filter type="" />
          </add>
    </sharedListeners>
    <trace autoflush="true" />
  </system.diagnostics> 
```

我正在为我的服务使用这个绑定

```
 WebHttpBinding basicWebBinding = new WebHttpBinding
        {
            MaxReceivedMessageSize = int.MaxValue,
            MaxBufferSize = int.MaxValue,
            MaxBufferPoolSize = int.MaxValue,
            CloseTimeout = new TimeSpan(0, 3, 0),
            OpenTimeout = new TimeSpan(0, 3, 0),
            ReceiveTimeout = new TimeSpan(0, 3, 0),
            TransferMode = TransferMode.Buffered,
            SendTimeout = new TimeSpan(0, 3, 0),
            WriteEncoding = Encoding.UTF8,
            ReaderQuotas = new XmlDictionaryReaderQuotas()
            {
                MaxStringContentLength = int.MaxValue,     
            }
        }; 
```

和这个操作合同（是的，它模拟 aspx 页面）

```
 [OperationContract(Name = "process.aspx")]
        [WebInvoke(Method = "POST",ResponseFormat = WebMessageFormat.Xml)]
          Stream ProcessRequest(Stream data); 
```

一切似乎都很好，但我看不到任何请求的 POST 数据，例如

```
<MessageLogTraceRecord>
<HttpRequest xmlns="http://schemas.microsoft.com/2004/06/ServiceModel/Management/MessageTrace">
<Method>POST</Method>
<QueryString></QueryString>
<WebHeaders>
<Connection>keep-alive</Connection>
<Content-Length>123</Content-Length>
<Content-Type>application/x-www-form-urlencoded</Content-Type>
<Accept>text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</Accept>
<Accept-Encoding>gzip, deflate</Accept-Encoding>
<Accept-Language>ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3</Accept-Language>
<Host>localhost</Host>
<Referer>http://localhost/...</Referer>
<User-Agent>Mozilla/5.0 (Windows NT 6.1; WOW64; rv:16.0) Gecko/20100101 Firefox/16.0</User-Agent>
</WebHeaders>
</HttpRequest>
<Binary xmlns=""></Binary>
</MessageLogTraceRecord> 
```

和回应

```
<MessageLogTraceRecord>
<HttpRequest xmlns="http://schemas.microsoft.com/2004/06/ServiceModel/Management/MessageTrace">
<Method>POST</Method>
<QueryString></QueryString>
<WebHeaders>
<Connection>keep-alive</Connection>
<Content-Length>159</Content-Length>
<Content-Type>application/x-www-form-urlencoded</Content-Type>
<Accept>*/*</Accept>
<Accept-Encoding>gzip, deflate</Accept-Encoding>
<Accept-Language>ru</Accept-Language>
<Host>localhost...</Host>
<User-Agent>agent</User-Agent>
</WebHeaders>
</HttpRequest>... stream ...</MessageLogTraceRecord> 
```

对此的任何帮助都会很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:31:30.607

我的猜测是 POST 数据超过了默认的消息记录长度。

您是否尝试将 maxSizeOfMessageToLog="200000" 添加到 messageLogging 元素？（显然可以根据需要设置大小）

这是我成功使用的设置。

```
<messageLogging 
logEntireMessage="true" 
logMalformedMessages="false"
logMessagesAtServiceLevel="true" 
logMessagesAtTransportLevel="false"
maxMessagesToLog="3000"
maxSizeOfMessageToLog="200000"/> 
```

干杯克里斯

# mysql - 部署使用 MySQL 的 Qt 应用程序

> ID：13494038
> 
> 赞同：0
> 
> 时间：2012-11-21T13:10:55.860
> 
> 标签：mysql, qt

我正在考虑开发一个应用程序来存储电影数据库，允许用户存储有关它拥有哪些电影、想看哪些电影等的信息。我正在考虑使用 Qt 框架开发这个应用程序并使用 MySQL 来数据库部分。

但是，我有几个问题。在其他机器上部署我的应用程序时，我不需要在那里安装 MySQL 吗？还是 .dll 就足够了？我可以在没有安装 MySQL 的机器上连接到不存在的数据库吗？

# c# - 在 C# 中对分组结果进行排序

> ID：13494046
> 
> 赞同：1
> 
> 时间：2012-11-21T13:11:16.453
> 
> 标签：c#, .net, linq

我有以下 LINQ 查询，用于对所有员工进行分组。

```
var groups =
  from employee in employees
  group employee by employee.ReportsTo; 
```

该链接返回一个 IGrouping 对象。

我现在想使用 ReportsTo 订购此结果，其中 ReportsTo 是每个员工的经理的姓名。如何使用 C# 实现这一点？这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T13:12:51.800

```
var groups = from employee in employees
             group employee by employee.ReportsTo into g
             orderby g.Key
             select g; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T13:16:38.150

我宁愿这样写，因为它更“可读”

```
var groups = employees.GroupBy(employee => employee.ReportsTo).OrderBy(group => group.Key) 
```

# json - 在 perl 中将 MongoDB 控制器项目转换为 JSON？

> ID：13494057
> 
> 赞同：1
> 
> 时间：2012-11-21T13:11:51.723
> 
> 标签：json, perl, mongodb, mojolicious

```
 using MongoDB;

 my $content = $db->items->find('something');
 my $json;
 while($content->next){
           push the data into a $json
 } 
```

哪里有办法

```
 my @variables = $content->all;
 foreach (@variables){
    push the data into $json
 } 
```

有什么办法可以直接将数据转换成json字符串；

并将数据推送到 Mojolicious

```
$self->render(json => $json); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:59:35.627

为它写了一个小的 Mojo 测试脚本。采用

```
$collection->find->all 
```

获取所有页面的列表，而不是迭代器。这是测试：

```
#!/usr/bin/env perl

use Mojolicious::Lite;
use MongoDB;

# --- MongoDB preparation ---

my $conn    = MongoDB::Connection->new; # create a MongoDB connection
my $test_db = $conn->test;              # a MongoDB database
my $tests   = $test_db->tests;          # a test collection

# insert test objects
$tests->remove();
$tests->insert({name => 'foo', age => 42});
$tests->insert({name => 'bar', age => 17});

# --- Mojolicious::Lite web app ---

# access the tests collection in a mojoy way
helper mongo_tests => sub {$tests};

# list all tests as JSON
get '/' => sub {
    my $self = shift;
    $self->render(json => [$self->mongo_tests->find->all]);
};

# --- web app test ---

use Test::More tests => 6;
use Test::Mojo;

my $tester = Test::Mojo->new;

$tester->get_ok('/')->status_is(200);
my $json = $tester->tx->res->json;
is $json->[0]{name},    'foo',  'right name';
is $json->[0]{age},     42,     'right age';
is $json->[1]{name},    'bar',  'right name';
is $json->[1]{age},     17,     'right age'; 
```

输出：

```
1..6
ok 1 - get /
ok 2 - 200 OK
ok 3 - right name
ok 4 - right age
ok 5 - right name
ok 6 - right age 
```

注意：我不能`is_deeply`用来测试`$json`数据结构，因为 MongoDB 添加了 OID。当你转储时你会看到它们`$json`。

# xslt - 嵌套的 for-each xslt 中的 position() 和 last()

> ID：13494061
> 
> 赞同：0
> 
> 时间：2012-11-21T13:12:11.037
> 
> 标签：xslt, foreach, nested

我有一个与 perl 模块一起使用的样式表，该模块仅适用于 XSLT 1.0。我想在 JSON 字典中创建一个 JSON 数组，所以我需要对元素进行适当的逗号分隔。我正在解析一个 XHTML 表，其中第二个单元格中有 1 个或多个跨度。所以 for-each select="./tr" 然后 for-each select="./td[1]/span" 或类似的东西。

***稍作更改后，它的行为与 Ian 所说的一样。***

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="text" version="1.0" doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd" doctype-public="-//W3C//DTD HTML 4.01//EN"  encoding="UTF-8" />
    <xsl:template match="text()">
    </xsl:template>
    <xsl:template match="table/tbody">
        <xsl:text>[</xsl:text>
        <xsl:for-each select="./tr[not(@class='no-results')]">
            <xsl:text>{"</xsl:text>
            <xsl:value-of select="normalize-space(.//strong)" />
            <xsl:text>":{"ingredients":{</xsl:text>
            <xsl:for-each select=".//div[@class='reagent-list']//a[@class='item-link reagent']">
                <xsl:value-of select="substring(./@href, 14)" />:<xsl:value-of select="normalize-space(./span[1])" />
                <xsl:if test="position() != last()">
                    <xsl:text>,</xsl:text>
                </xsl:if>
            </xsl:for-each>
            <xsl:text>}</xsl:text>
            <xsl:if test="position() != last()">
                <xsl:text>,</xsl:text>
            </xsl:if>
            <xsl:text>&#10;</xsl:text>
        </xsl:for-each>
        <xsl:text>]</xsl:text>
    </xsl:template>
</xsl:stylesheet> 
```

我意识到样式表与下面的 xml 不匹配。实际文件很大。不过，我希望你明白我的意思。我刚刚编了这个：

```
<table>
  <thead>
    <tr>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>foo</td>
      <td><span>an element</span></td>
      <td>bar</td>
    </tr>
    <tr>
      <td>foo</td>
      <td><span>an element</span><span>an element</span></td>
      <td>bar</td>
    </tr>
    <tr>
      <td>foo</td>
      <td><span>an element</span><span>an element</span><span>an element</span><span>an element</span></td>
      <td>bar</td>
    </tr>
  </tbody>
</table> 
```

=>

```
{
  "Row one":["an element"],
  "Row two":["an element", "an element"],
  "Row three":["an element", "an element", "an element", "an element"]
} 
```

相反，我得到了这个：

```
{
  "Row one":["an element",],
  "Row two":["an element", "an element",],
  "Row three":["an element" "an element" "an element" "an element"]
} 
```

我一直在使用`position()`and`last()`在测试标签中打印逗号，它似乎在外部循环中正常工作，但是如何告诉我的测试标签在打印分隔数组的逗号时使用内部 for-each 范围？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:37:55.273

正如@IanRoberts 所提到的，如果不查看现有 XSLT 的外观，就很难提供有针对性的帮助。

**也就是说，这是一个面向推送（即 no `<xsl:for-each>`）并且不需要`last()`.**

**当这个 XSLT：**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:my="my"
  exclude-result-prefixes="my"
  version="1.0">
  <xsl:output omit-xml-declaration="no" indent="yes" method="text" />
  <xsl:strip-space elements="*" />

  <my:ones>
    <num>one</num>
    <num>two</num>
    <num>three</num>
    <num>four</num>
    <num>five</num>
    <num>six</num>
    <num>seven</num>
    <num>eight</num>
    <num>nine</num>
  </my:ones>

  <xsl:template match="/*">
    <xsl:text>{&#10;</xsl:text>
    <xsl:apply-templates select="tbody/tr" />
    <xsl:text>&#10;}</xsl:text>
  </xsl:template>

  <xsl:template match="tr">
    <xsl:variable name="vPos" select="position()" />
    <xsl:if test="$vPos &gt; 1">,&#10;</xsl:if>
    <xsl:text>&#09;"Row </xsl:text>
    <xsl:value-of select="document('')/*/my:ones/*[$vPos]" />
    <xsl:text>":[</xsl:text>
    <xsl:apply-templates select="td[2]/span" />
    <xsl:text>]</xsl:text>
  </xsl:template>

  <xsl:template match="span">
    <xsl:if test="position() &gt; 1">, </xsl:if>
    <xsl:value-of select="concat('&quot;', ., '&quot;')" />
  </xsl:template>

</xsl:stylesheet> 
```

**...针对提供的 XML 运行：**

```
<table>
  <thead>
    <tr>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>foo</td>
      <td>
        <span>an element</span></td>
      <td>bar</td>
    </tr>
    <tr>
      <td>foo</td>
      <td>
        <span>an element</span><span>an element</span></td>
      <td>bar</td>
    </tr>
    <tr>
      <td>foo</td>
      <td>
        <span>an element</span><span>an element</span><span>an element</span><span>an element</span></td>
      <td>bar</td>
    </tr>
  </tbody>
</table> 
```

**...产生了想要的结果：**

```
{
  "Row one":["an element"],
  "Row two":["an element", "an element"],
  "Row three":["an element", "an element", "an element", "an element"]
} 
```

**解释：**

*   第一个模板匹配根元素。其目的是将模板应用于该元素的`<tr>`孙子元素，并将这些结果夹在`{`and之间`}`（根据需要添加换行符）。

*   第二个模板匹配`<tr>`元素。它输出行信息并被指示将模板应用于`<span>`第二个元素的所有子`<td>`元素（同样，根据需要将结果夹在大括号和其他文本之间）。

    *   **注意：**如果 this在当前上下文中的位置大于 1 `last()`，您将看到第一个元素输出逗号而不是使用，然后是换行符。这与正确应用逗号具有相同的效果；`<tr>`这只是看待同一问题的不同方式（并且是我使用的方式，因为它对我来说似乎更有效；））。

    *   **注意：**为了使这个解决方案更具可扩展性，您会看到我没有在每一行中静态输出单词`"one"`,`"two"`等。相反，在 XSLT 的顶部，我定义了一个`<my:ones>`元素来保存每个“ones”数字的文本值。在处理 each`<tr>`时，我使用它`<tr>`在当前上下文中的位置来检索正确`<num>`元素的值。**我把它作为练习留给了读者，但确实可以定义`<my:tens>`,`<my:hundreds>`等来将此解决方案扩展到潜在的大量行。**

*   最终模板匹配`<span>`元素。再次，它使用一个`<xsl:if>`元素来测试 this`<span>`在当前上下文中的位置是否大于 1；如果是这样，则输出一个逗号（后跟一个空格）。之后，我们只需将两个`"`符号连接起来，并将跨度值夹在中间。

# asp.net - 从 Azure Web 角色发生 503 时如何以编程方式重新启动应用程序池

> ID：13494070
> 
> 赞同：1
> 
> 时间：2012-11-21T13:12:47.627
> 
> 标签：asp.net, iis, azure, azure-web-roles

如果 Azure 站点的应用程序池由于快速故障保护而关闭，是否可以自动重新启动它？

这个问题提出了几乎相同的问题，但与 azure [ASP.NET 应用程序池关闭问题无关](https://stackoverflow.com/questions/4742122/asp-net-application-pool-shutdown-problem)

可能使用 WebRole 来监视和修改此页面上的代码[是否可以在 Azure Web 角色上重新启动 IIS 而无需重新启动进程？](https://stackoverflow.com/questions/9734994/is-it-possible-to-restart-iis-on-a-azure-web-role-without-restarting-the-process)

```
var mgr = new ServerManager();
var azurePools = mgr.ApplicationPools.Where(p => Guid.TryParse(p.Name));
azurePools.ToList().ForEach(p => p.Recycle()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:26:29.603

您可以从启动任务运行[以下脚本](http://blogs.iis.net/thomad/archive/2007/01/16/tricking-rapid-fail-protection.aspx)（确保创建提升的后台任务）：

```
Timeout= 30000
set events = GetObject("winmgmts:{impersonationLevel=impersonate}").ExecNotificationQuery("select * from __instancecreationevent where targetinstance isa 'Win32_NTLogEvent' and TargetInstance.LogFile='System' and TargetInstance.EventCode=5002") 
Do
    WScript.Echo "==========================================================================="
    WScript.Echo "Listening for IIS Rapid Fail Protection Events"
    Set objLatestEvent = events.NextEvent
    Wscript.Echo objLatestEvent.TargetInstance.Message
    ' get the AppPool name from the Eventlog message
    appPool = objLatestEvent.TargetInstance.InsertionStrings(0)
    WScript.Echo "Restarting Application Pool '" & appPool & "' in " & Timeout & " milliseconds"
    WScript.Sleep(Timeout)
    'construct ADSI path to failed AppPool and start by setting AppPoolCommand to 1
    set pool = GetObject("IIS://localhost/w3svc/AppPools/" & appPool)
    pool.AppPoolCommand = 1
    pool.SetInfo
    WScript.Echo "AppPool " & appPool & " restarted"
    WScript.Echo "==========================================================================="
    WScript.Echo
Loop 
```

使用 WMI 它将侦听 IIS RFP 事件。这是通过与 结合来完成`ExecNotificationQuery`的`NextEvent`。调用`NextEvent`将阻塞，直到新事件到达。发生这种情况时，脚本会等待 30 秒并重新启动应用程序池。

无论如何，如果 RFP 启动，可能更适合了解您的流程为何一次又一次地崩溃。

# javascript - 隐藏/显示 Divs - 初始状态

> ID：13494073
> 
> 赞同：0
> 
> 时间：2012-11-21T13:13:04.023
> 
> 标签：javascript

只是显示/隐藏 div 有点困难-

基本上我想要实现的是拥有 3 个不同的链接，每个链接对应于三个不同的 div，任何时候只有一个显示。我已经参考了本教程-http: [//www.randomsnippets.com/2008/02/12/how-to-hide-and-show-your-div/](http://www.randomsnippets.com/2008/02/12/how-to-hide-and-show-your-div/)（标题为“这是一个新的演示”以响应一次只显示一个 div 的请求')

一切正常，因为当我单击任何链接时，都会显示正确的 div。我遇到的唯一问题是初始状态 - 我只希望最初显示第一个 div，但目前它们都同时显示，直到我单击其中一个链接。

我在网站上复制了java -

```
<script> function showonlyone(thechosenone) {
  var newboxes = document.getElementsByTagName("div");
        for(var x=0; x<newboxes.length; x++) {
              name = newboxes[x].getAttribute("class");
              if (name == 'newboxes') {
                    if (newboxes[x].id == thechosenone) {
                    newboxes[x].style.display = 'block';
              }
              else {
                    newboxes[x].style.display = 'none';
              }
        }
  }
} </script> 
```

我的 div 然后有：

```
<div id="newboxes1" class="newboxes" style="width: 1124px;">
<div id="newboxes2" class="newboxes">
<div id="newboxes3" class="newboxes"> 
```

这 3 个 div 都包含许多其他 div，它们都没有类中的“newbox” - 但这可能会干扰？

链接位于这 3 个 div 之外：

```
<a href="javascript:showonlyone('newboxes1');">Learn HTML</a><a href="javascript:showonlyone('newboxes2');">Box2</a><a href="javascript:showonlyone('newboxes3');">Box3</a> 
```

据我所见，我已经完全复制了教程中显示的方法，但是我的初始状态无法正常工作，而教程页面上却可以。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:25:38.670

```
function showonlyone(element){
    for (var i=0; i<document.getElementsByClassName("newboxes").length; i++){
        var div = document.getElementById('newboxes'+i);
        if(i == element){
            div.style.display = 'block';
        }else{
            div.style.display = 'none';
        }
    }
} 
```

使用：

```
showonlyone(1);
//This will show the div with ID="newboxes1" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-02T16:37:54.320

在你的标题中试试这个

```
<script>
    function showonlyone(thechosenone) {
        var newboxes = document.getElementsByTagName("div");
        for (var x = 0; x < newboxes.length; x++) {
            name = newboxes[x].getAttribute("class");
            if (name == 'newboxes') {
                if (newboxes[x].id == thechosenone) {
                    newboxes[x].style.display = 'block';
                } else {
                    newboxes[x].style.display = 'none';
                }
            }
        }
    }
</script> 
```

其次是 div 框和链接

```
<a id="myHeader1" href="javascript:showonlyone('newboxes1');">Wall Tiles</a>
- <a id="myHeader2" href="javascript:showonlyone('newboxes2');">Floor Tiles</a>
- <a id="myHeader3" href="javascript:showonlyone('newboxes3');">Extras</a>

<div class="newboxes" id="newboxes1">
    <iframe src="wall.php" width="600" height="620" frameborder="0"></iframe>
</div>
<div class="newboxes" id="newboxes2">
    <iframe src="floor.php" width="600" height="620" frameborder="0"></iframe>
</div>
 <div class="newboxes" id="newboxes3">
    <iframe src="extras.php" width="600" height="620" frameborder="0"></iframe>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:16:41.573

是不是很简单

```
<div id="newboxes1" class="newboxes" style="width: 1124px;">
<div id="newboxes2" class="newboxes" style="display:none;">
<div id="newboxes3" class="newboxes" style="display:none;"> 
```

# html - 如何在我的 css 画廊中正确定位图像？

> ID：13494076
> 
> 赞同：1
> 
> 时间：2012-11-21T13:13:13.280
> 
> 标签：html, css, position, gallery

嘿，这是我的第一个问题，所以如果我有任何问题，我很抱歉。

我正在尝试**仅**使用HTML 和 CSS 创建一个画廊，到目前为止，我已经将它全部对齐并且几乎已排序。问题在于悬停时的图像放大器，当您将鼠标悬停在放大的图像上时，它会显示在其各自图像的顶部，但是当您向下滚动并将鼠标悬停在图像上时，放大的图像会保持不动并且不会跟随图片。

我尝试过使用图像和悬停图像的*位置*属性，但我无法正确处理。不过，我仍然希望图像从 div 中“弹出”。

我在下面的链接上粘贴了代码：http:
[//pastebin.com/fZxbKZEJ](http://pastebin.com/fZxbKZEJ)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:20:04.640

将 更改`position: absolute;`为`position:fixed;`。这将使图像弹出相对于视图。玩弄`margin`正确的对齐方式。

例如：

```
margin: 100px auto 0; 
```

所以，

```
.bigImage{         
     display:none;
     position:fixed;
     height:310px;
     width:250px;
     margin:100px auto 0;
     border:2px solid #39F;
 } 
```

如果您只想让弹出窗口跟随原始图像，请执行此操作

```
.bigImage{         
     display:none;
     position:relative;
     height:310px;
     width:250px;
     margin:-260px 0 0 -45px;
     border:2px solid #39F;
 } 
```

# java - 如何在 Thymeleaf 中执行 if-else？

> ID：13494078
> 
> 赞同：148
> 
> 时间：2012-11-21T13:13:18.687
> 
> 标签：java, jsp, if-statement, jstl, thymeleaf

在 Thymeleaf中做一个简单的最好方法是什么`if`？`else`

我想在 Thymeleaf 中实现与

```
<c:choose>
  <c:when test="${potentially_complex_expression}">
     <h2>Hello!</h2>
  </c:when>
  <c:otherwise>
     <span class="xxx">Something else</span>
  </c:otherwise>
</c:choose> 
```

在 JSTL 中。

到目前为止我的想法：

```
<div th:with="condition=${potentially_complex_expression}" th:remove="tag">
    <h2 th:if="${condition}">Hello!</h2>
    <span th:unless="${condition}" class="xxx">Something else</span>
</div> 
```

我不想评价`potentially_complex_expression`两次。这就是我引入局部变量的原因`condition`。我仍然不喜欢同时使用`th:if="${condition}`和`th:unless="${condition}"`。

重要的是我使用了两个不同的 HTML 标签：比如说`h2`和`span`.

你能提出一个更好的方法来实现它吗？

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2012-11-28T09:24:14.333

Thymeleaf 等效于`<c:choose>`and `<c:when>`：Thymeleaf 2.0 中引入的`th:switch`and属性。`th:case`

它们按照您的预期工作，`*`用于默认情况：

```
<div th:switch="${user.role}"> 
  <p th:case="'admin'">User is an administrator</p>
  <p th:case="#{roles.manager}">User is a manager</p>
  <p th:case="*">User is some other thing</p> 
</div> 
```

有关语法的快速说明（或 Thymeleaf 教程），请参阅[此内容。](http://www.thymeleaf.org/whatsnew20.html#swit)

*免责声明*：根据 StackOverflow 规则的要求，我是 Thymeleaf 的作者。

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2013-01-02T11:51:14.303

我尝试使用此代码来确定客户是登录还是匿名。我确实使用了`th:if`和`th:unless`条件表达式。很简单的方法来做到这一点。

```
<!-- IF CUSTOMER IS ANONYMOUS -->
<div th:if="${customer.anonymous}">
   <div>Welcome, Guest</div>
</div>
<!-- ELSE -->
<div th:unless="${customer.anonymous}">
   <div th:text=" 'Hi,' + ${customer.name}">Hi, User</div>
</div> 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-01-14T11:10:13.080

除了 Daniel Fernández，我还想分享我与安全相关的示例。

```
<div th:switch="${#authentication}? ${#authorization.expression('isAuthenticated()')} : ${false}">
    <span th:case="${false}">User is not logged in</span>
    <span th:case="${true}">Logged in user</span>
    <span th:case="*">Should never happen, but who knows...</span>
</div> 
```

这是混合“身份验证”和“授权”实用程序对象的复杂表达式，它为 thymeleaf 模板代码产生“真/假”结果。

'authentication' 和 'authorization' 实用程序对象来自[thymeleaf extras springsecurity3 library](https://github.com/thymeleaf/thymeleaf-extras-springsecurity3)。当 'authentication' 对象不可用或 authorization.expression('isAuthenticated()') 评估为 'false' 时，表达式返回 ${false}，否则返回 ${true}。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2014-04-25T17:05:05.783

您可以使用

```
If-then-else:  (if) ? (then) : (else) 
```

例子：

```
'User is of type ' + (${user.isAdmin()} ? 'Administrator' : (${user.type} ?: 'Unknown')) 
```

对于提出相同问题的新人来说，这可能很有用。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2015-10-06T09:37:49.140

另一种解决方案 - 您可以使用局部变量：

```
<div th:with="expr_result = ${potentially_complex_expression}">
    <div th:if="${expr_result}">
        <h2>Hello!</h2>
    </div>
    <div th:unless="${expr_result}">
        <span class="xxx">Something else</span>
    </div>
</div> 
```

更多关于局部变量：
[http ://www.thymeleaf.org/doc/tutorials/2.1/usingthymeleaf.html#local-variables](http://www.thymeleaf.org/doc/tutorials/2.1/usingthymeleaf.html#local-variables)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2017-04-01T19:47:00.680

在更简单的情况下（当 html 标签相同时）：

```
<h2 th:text="${potentially_complex_expression} ? 'Hello' : 'Something else'">/h2> 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-03-22T15:29:52.143

另一种解决方案只是`not`用来获得相反的否定：

```
<h2 th:if="${potentially_complex_expression}">Hello!</h2>
<span class="xxx" th:if="${not potentially_complex_expression}">Something else</span> 
```

如[文档](http://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#simple-conditionals-if-and-unless)中所述，它与使用`th:unless`. 正如其他答案所解释的：

> 此外，`th:if`还有一个逆属性 ，`th:unless`我们可以在前面的示例**中使用它，而不是在 OGNL 表达式中使用 not**

使用`not`也可以，但恕我直言，使用它`th:unless`而不是用`not`.

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-05-13T00:28:16.963

## `th:switch`用作_`if-else`

```
<span th:switch="${isThisTrue}">
  <i th:case="true" class="fas fa-check green-text"></i>
  <i th:case="false" class="fas fa-times red-text"></i>
</span> 
```

## `th:switch`用作_`switch`

```
<span th:switch="${fruit}">
  <i th:case="Apple" class="fas fa-check red-text"></i>
  <i th:case="Orange" class="fas fa-times orange-text"></i>
  <i th:case="*" class="fas fa-times yellow-text"></i>
</span> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-05-08T06:10:35.787

```
<div th:switch="${user.role}"> 
<p th:case="'admin'">User is an administrator</p>
<p th:case="#{roles.manager}">User is a manager</p>
<p th:case="*">User is some other thing</p> 
</div>

<div th:with="condition=${potentially_complex_expression}" th:remove="tag">
<h2 th:if="${condition}">Hello!</h2>
<span th:unless="${condition}" class="xxx">Something else</span>
</div> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-01-03T04:11:44.713

```
<div style="width:100%">
<span th:each="i : ${#numbers.sequence(1, 3)}">
<span th:if="${i == curpage}">
<a href="/listEmployee/${i}" class="btn btn-success custom-width" th:text="${i}"></a
</span>
<span th:unless="${i == curpage}">
<a href="/listEmployee/${i}" class="btn btn-danger custom-width" th:text="${i}"></a> 
</span>
</span>
</div> 
```

[在此处输入图像描述](https://i.stack.imgur.com/rlGOB.png)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-01-19T21:40:04.173

当我想根据用户的性别显示照片时，这对我有用：

`<img th:src="${generou}=='Femenino' ? @{/images/user_mujer.jpg}: @{/images/user.jpg}" alt="AdminLTE Logo" class="brand-image img-circle elevation-3">`

# ruby-on-rails - 为什么不显示包含的模块？

> ID：13494080
> 
> 赞同：0
> 
> 时间：2012-11-21T13:13:24.187
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

在我的 config/initializers/ [refinery](https://github.com/refinery/refinerycms)文件夹中，有一些配置文件结构为

```
initializers
 ├── backtrace_silencers.rb
 ├── inflections.rb
 ├── mime_types.rb 
 ├── refinery
 │   ├── authentication.rb
 │   ├── core.rb
 │   ├── i18n.rb
 │   ├── images.rb
 │   ├── page_images.rb
 │   ├── pages.rb
 │   └── resources.rb
 ├── secret_token.rb
 ├── session_store.rb
 └── wrap_parameters.rb 
```

与`refinery/`，`rails console --sandbox`我得到

```
 Refinery.included_modules
  #=> [] 
```

为什么？当我按下`Tab`after`Refinery::P`时，它会显示以下模块。

```
Refinery::Page                 Refinery::PagePart             Refinery::PaginationHelper     
Refinery::PageImages           Refinery::Pages                Refinery::Plugin               
Refinery::PageImagesGenerator  Refinery::PagesGenerator       Refinery::Plugins 
```

如果它有`::`，它必须在某个地方并且必须包含它。那为什么`include_modules`工作？如果我错了，请纠正我，并向我展示显示模块内的模块或类的正确方法。我提到[了 http://www.ruby-doc.org/core-1.9.3/Module.html](http://www.ruby-doc.org/core-1.9.3/Module.html)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:38:09.070

这些模块没有“包含”在 中`Refinery`，这就是为什么它们没有在`included_modules`.

“包含”在 Ruby 中具有特定的含义——基本上，它是当一个类或模块“混合”另一个模块时——而类似于`Refinery::Page`命名*空间*的东西。查看[Pragmatic Programmer's Guide](http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_modules.html)，它解释得很好。

尝试`Refinery.constants`得到你所追求的。

# ruby-on-rails - 从 Rails 方法返回 html 字符串

> ID：13494081
> 
> 赞同：2
> 
> 时间：2012-11-21T13:13:25.090
> 
> 标签：ruby-on-rails

**我正在尝试使用位于application_helper.rb**中的 rails helper 方法构建格式化的 html 字符串。

```
def comment_posted_tag(actor_id,date)
  ... irrelevant code removed
  str =  "<b>" + actor_name + "</b>" + " on " + date.strftime("%d %b %Y at %H:%M")
  return str.html_safe
end 
```

我在视图中这样称呼它：

```
<%= comment_posted_tag(dialog_comment.actor_id,dialog_comment.updated_at) %> 
```

由于某种原因**标签没有通过。理想情况下，我想将一个 CSS 类附加到**actor_name**字符串。我在有和没有 html_safe 的情况下都试过了，但都不管用。**

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:26:28.137

总是`content_tag`用于这种工作：

```
def comment_posted_tag(actor_name, date)
  content_tag(:span, :class => 'yours') do
    content_tag(:b, actor_name) + ' on ' + date.strftime("%d %b %Y at %H:%M")
  end
end 
```**

# android - 在对话框中的按钮上设置单击侦听器时应用程序崩溃...

> ID：13494084
> 
> 赞同：0
> 
> 时间：2012-11-21T13:13:43.577
> 
> 标签：android, listener

建立一个对话框我想添加一个监听器，但是应用程序崩溃了。出了什么问题？

```
private void Info(){

        textview = (TextView) findViewById(R.id.textView1);

        LayoutInflater li = LayoutInflater.from(this);
        View view = li.inflate(R.layout.info, null);

        final AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setView(view).create().show();

        buttonInfo = (Button)findViewById(R.id.buttonInfo);

        buttonInfo.setOnClickListener(new View.OnClickListener() {
              public void onClick(View view) { 

              }
            }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:17:48.183

代替

```
 buttonInfo = (Button) view.findViewById(R.id.buttonInfo); 
```

经过

```
buttonInfo = (Button) findViewById(R.id.buttonInfo); 
```

最终代码

```
private void Info(){

        textview = (TextView) findViewById(R.id.textView1);

        LayoutInflater li = LayoutInflater.from(this);
        View view = li.inflate(R.layout.info, null);

        final AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setView(view).create().show();

        buttonInfo = (Button) view.findViewById(R.id.buttonInfo);

        buttonInfo.setOnClickListener(new View.OnClickListener() {
              public void onClick(View view) { 

              }
            }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:16:39.647

我猜该按钮在您的对话框布局内。

如果是这种情况，请尝试更换

```
buttonInfo = (Button)findViewById(R.id.buttonInfo); 
```

经过

```
buttonInfo = (Button) view.findViewById(R.id.buttonInfo); 
```

如果你想在之后关闭它，你需要存储创建的 AlertDialog （而不是 Builder）：

```
 final AlertDialog dialog = new AlertDialog.Builder(this).setView(view).show();

    buttonInfo = (Button) findViewById(R.id.buttonInfo);

    buttonInfo.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {
            dialog.dismiss();
        }
    }); 
```

# vba - 使用 VBA 查找和替换文本

> ID：13494093
> 
> 赞同：0
> 
> 时间：2012-11-21T13:14:22.467
> 
> 标签：vba, replace

我使用 Excel VBA 和以下方法在 html 文件中搜索字符串，并在添加粗体标记后将其替换为相同的字符串。

```
FindAndReplace ("C:\xxx.htm", "hello world", "<b>hello world</b>")

Private Sub FindAndReplace(filePath As String, findWhat As String, replaceWith As String)

Dim nextFileNum As Long
Dim oldFileContents As String
Dim newFileContents As String
Dim textFileTypes() As String
Dim fileExtension As String

Dim sFileName As String
Dim iFileNum As Integer
Dim sBuf As String
Dim strFound As Integer

  If Len(Dir(filePath)) = 0 Then
    Exit Sub
  End If

  nextFileNum = FreeFile

  Open filePath For Input As #nextFileNum
  oldFileContents = Input$(LOF(nextFileNum), #nextFileNum)
  Close #nextFileNum

  newFileContents = Replace(oldFileContents, findWhat, replaceWith)

  nextFileNum = FreeFile

  Open filePath For Output As #nextFileNum
  Print #nextFileNum, newFileContents
  Close #nextFileNum
End Sub 
```

我面临的问题是该函数不会；如果由于 html 源代码换行符而将其拆分，则找不到该字符串。

例如，如果代码是，则找到该字符串：

```
<p>hi hola hello world</p> 
```

但如果代码为：

```
<p>hi hola hello 
world</p> 
```

是否有任何其他 VBA 方法可用于搜索和替换文本，或者可以将某些功能添加到上面的代码中，以便它忽略中间的换行符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:23:38.110

尝试使用以下变体：

```
Function RemoveCarriageReturns(SourceString As String) As String

    Dim s As String

    'strip out CR and LF characters together
    s = Replace(SourceString, vbCrLf, "")

    'just in case, remove them one at a time
    s = Replace(s, Chr(13), "")
    s = Replace(s, Chr(10), "")

    RemoveCarriageReturns = s

End Function 
```

ASCII 字符 13 和 10 是回车符和换行符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:11:30.260

如果拆分仅包含换行符/回车符 ( `Chr(10)`, `Chr(13)`) 和/或空格`Chr(32)`，那么您可以先搜索“hello”。

找到时查找这些*字符*（10、13 和 32）并跳过它们，直到遇到其他内容（使用`DO WHILE ... OR ... OR ... OR`循环）。

现在检查其他东西是否是“世界”，并且至少遇到了这些*字符中的 1 个。*

在这种情况下，您将更`"hello"`改为`"<b>hello"``"world"``"world</b>"`

# java - webstart 启动运行 jre，有解决方法吗？

> ID：13494095
> 
> 赞同：0
> 
> 时间：2012-11-21T13:14:38.253
> 
> 标签：java, java-web-start

我的应用程序是由 webstart 启动的，它必须使用 jre6 运行。但是我客户的 PC 出于某种原因同时安装了 jre6 和 jre7。要指定 jre6，我使用以下命令调用我的应用程序：

```
C:\Program Files\Java\jre6\bin\javaws https://kong/QoSAC/qosac/lsm.jnlp 
```

如您所见，我使用 jre6 的 webstart。但似乎 webstart 仍然调用 jre7 的 javaw：

![在此处输入图像描述](../Images/26e0ac22e41477835b5989de66207203.png)

在我的 jnlp 文件中，我设置了：

```
<j2se version="1.6"> 
```

为什么webstart还是选择jre7？

但是，如果我将所有内容都放在本地，并使用以下命令：

```
C:\Program Files\Java\jre6\bin\javaws c:\appdir\lsm.jnlp 
```

这样它工作正常，jre6 由 webstart 选择。

这是webstart的错误吗？有什么办法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:16:44.763

如果你展示你的 jnlp 会有所帮助。特别是，在 jnlp 中添加所需的 Java 版本应该可以解决您的问题：

```
<j2se version="1.6"> 
```

您可以[在此处阅读有关 webstart 版本控制](http://pscode.org/jws/version.html)的更多信息。

# image-processing - 从源文件计算图像的高度和宽度

> ID：13494096
> 
> 赞同：2
> 
> 时间：2012-11-21T13:14:42.710
> 
> 标签：image-processing, erlang

我需要从实际的图像文件中计算图像的宽度和高度，所以我正在用打开的文件读取图像。所以我有一堆字符和数字以及所有看起来毫无意义的东西，它们可能正在呈现 rgb 信息。我只想用我用 Erlang 语言编程的原始文件信息来计算图像的大小，但是只要我们不使用内置库，任何语言的代码都会有所帮助，因为我们正在使用原始文件。

提前谢谢大家的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T18:34:15.483

我通过查看每种格式的详细信息找到了答案，所以它的工作原理是这样的

JPG：您可以在字节“255,192,0,17,8”之后找到宽度和高度，然后是大小信息

PNG：您可以在“IHDR”之后找到它

GIF：你可以在“GIF89a”之后找到它

有更多信息，但这是互联网上最常见的图像类型

谢谢大家的时间

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:20:13.070

我假设当您说“原始”时，您的意思是您只有像素值。
在这种情况下，并不总是有办法知道宽度和高度。

假设您读取 400 像素。在这种情况下，有效的图像边可以是 400 的任何整数分解，例如 1x400、2x200、4x100、8x50、20x20 等，并且也可以转置。

更不用说许多图像格式包括一些像素行的填充，这些填充不是 4、8 或 16 的倍数......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T17:15:49.113

它在图像文件中的编码方式取决于图像类型，希望也可以在图像文件中编码。您可以查看[从二进制文件中获取 JPEG 的图像大小](https://stackoverflow.com/questions/2517854/getting-image-size-of-jpeg-from-its-binary)的问题，以获取JPEG 编码的示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T17:55:14.917

如果您的数据未知，请使用 Octave 并加载图像。然后看看这个页面：

[http://www.gnu.org/software/octave/doc/interpreter/Displaying-Images.html](http://www.gnu.org/software/octave/doc/interpreter/Displaying-Images.html)

用于显示图像的命令。希望通过一些操作它会起作用。这适用于原始图像，尽管有特定的解码器。一旦你了解了图像是怎样的，你就可以编写等效的 C 代码。

# ruby - Ruby attr_accessor vs. getter/setter 基准测试：为什么访问器更快？

> ID：13494098
> 
> 赞同：11
> 
> 时间：2012-11-21T13:14:47.520
> 
> 标签：ruby, benchmarking, getter-setter, attr-accessor

我刚刚针对等效的 getter/setter 方法测试了 attr_accessor：

```
class A
  # we define two R/W attributes with accessors
  attr_accessor :acc, :bcc

  # we define two attributes with getter/setter-functions
  def dirA=(d); @dirA=d; end
  def dirA; @dirA; end
  def dirB=(d); @dirB=d; end
  def dirB; @dirB; end
end

varA   = A.new
startT = 0
dirT   = 0
accT   = 0

# now we do 100 times the same benchmarking
# where we do the same assignment operation
# 50000 times
100.times do
  startT = Time.now.to_f
  50000.times do |i|
    varA.dirA = i
    varA.dirB = varA.dirA
  end
  dirT += (Time.now.to_f - startT)

  startT = Time.now.to_f
  50000.times do |i|
    varA.acc = i
    varA.bcc = varA.acc
  end
  accT += (Time.now.to_f - startT)
end

puts "direct:   %10.4fs" % (dirT/100)
puts "accessor: %10.4fs" % (accT/100) 
```

程序输出为：

```
direct:       0.2640s
accessor:     0.1927s 
```

所以`attr_accessor`速度明显更快。有人可以分享一些智慧，为什么会这样？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-21T13:38:35.430

在不深入理解差异的情况下，我至少可以说[`attr_accessor`](http://www.ruby-doc.org/core-1.9.3/Module.html#method-i-attr_accessor)(and `attr_reader`and `attr_writer`) 是用 C 实现的，正如您通过切换该页面上的源代码所看到的那样。您的方法将在 Ruby 中实现，并且 Ruby 方法比原生 C 函数具有更多的调用开销。

这里有一篇文章解释[了为什么 Ruby 方法分派往往很慢](http://www.hokstad.com/the-problem-with-compiling-ruby.html)。

# javascript - 启动 touchend 事件 - jQuery Mobile

> ID：13494100
> 
> 赞同：1
> 
> 时间：2012-11-21T13:14:54.477
> 
> 标签：javascript, jquery, jquery-mobile

我正在为我的应用程序使用 jQuery mobile。

是否可以使用 jQuery Mobile 释放手势？如果用户放置手指并拖动屏幕 - 我可以使用 JavaScript 释放此手势，即使他将手指留在屏幕上？

例如 - 是否可以在 1000 毫秒后释放触摸移动，以便事件结束，例如`$(this).touchend();`（就像我可以做的那样`$(this).click();`）？

**编辑：** 另一方面，也许有人对如何限制`touch`/`touchmove`时间有任何其他想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T13:38:20.063

`$(this).trigger(eventName)` 您可以通过调用See the [jQuery docs](http://api.jquery.com/trigger/) on this method触发任何事件。

你的情况是：`$(this).trigger('touchend');`

如果您想要一个在触摸 1000 毫秒后触发的事件，也许可以考虑 jQM 的[taphold](http://jquerymobile.com/test/docs/api/events.html)事件？您可以通过设置来指定延迟`$.event.special.tap.tapholdThreshold`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:57:13.457

这样的事情有用吗？

*   [http://jsfiddle.net/LG9BM/](http://jsfiddle.net/LG9BM/)

JS

```
function bindEventTouch(element) {
    element.bind('tap taphold swipe swiperight swipeleft', function(event, ui) {
        console.log('Event: '+event.type); 

        if(event.type == 'taphold') {
            console.log('Was Event taphold?: '+event.type); 
            element.trigger('touchend');
        }
    });

    element.bind('touchend', function(event, ui) {
        console.log('Triggered touchend Event: '+event.type); 
    });
}

$('.displayEvent').each(function(){
    bindEventTouch($(this));
});​ 
```

HTML

```
<div data-role="page" id="home"> 
    <div data-role="content">
        <div id="display-event-1" class="add-border displayEvent">
            <p>Tap, TapHold (for 1 second), Swipe, SwipeRight or SwipeLeft</p>
        </div>
        <br />
        <div id="display-event-2" class="add-border displayEvent">
            <p>Tap, TapHold (for 1 second), Swipe, SwipeRight or SwipeLeft</p>
        </div>
        <br />
        <div id="display-event-3" class="add-border displayEvent">
            <p>Tap, TapHold (for 1 second), Swipe, SwipeRight or SwipeLeft</p>
        </div>
    </div>
</div>​ 
```

CSS

```
.add-border {
    border-style:solid;
    border-width:1px;
    width:100%;   
    text-align:center;
}​ 
```

# php - IE中的javascript参数减少

> ID：13494103
> 
> 赞同：1
> 
> 时间：2012-11-21T13:15:10.420
> 
> 标签：php, jquery

您好，我已经在我的 jquery 函数中传递了 div lang 属性的值。这在除 IE 之外的所有浏览器中都能正常工作。

```
 While inspects in FIREFOX div look like below code.

<div lang="1760@239.0000@349.0000@449.0000@plain make it@Plain make@Plain@Georgia Gray@8x16@10x20@12x24@No@45@10x20@check2@myCheckbox2@000000@70@90" id="myCheckbox2" style="left: -3000px; top: 883px; margin: 1px;" class="checkboxArea1"><input type="checkbox" class="outtaHere" value="2" id="check2" name="f[]"></div>

While inspects in IE div look like below code.

<div style="margin: 1px; left: -3000px; top: 883px;" id="myCheckbox2" lang="1760@239.0000@349.0000@449.0000@plain make it@Plain make@Plain@Georgia Gray@8x16@10x20@12x24@No@45@10x20@check2@myCheckbo" class="checkboxArea1"><input id="check2" class="outtaHere" name="f[]" value="2" type="checkbox"></div> 
```

您可以看到 div lang 属性值的差异。在 Firefox 中，它采用 lang 的所有值，但在 IE 中，最后 3 个值也不会显示，最后的第四个值被削减，所以我在 IE 中得到了未定义的值。

请建议我如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:19:45.707

使用数据而不是 lang 属性....

```
<div data-lang="1760@239.0000@349.0000@449.0000@plain make it@Plain make@Plain@Georgia Gray@8x16@10x20@12x24@No@45@10x20@check2@myCheckbox2@000000@70@90" id="myCheckbox2" style="left: -3000px; top: 883px; margin: 1px;" class="checkboxArea1"><input type="checkbox" class="outtaHere" value="2" id="check2" name="f[]"></div> 
```

然后你可以像这样在javascript（使用jQuery）中访问它......

```
$("#myCheckbox2").data("lang"); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-21T13:47:11.937

请上传以下js文件解决ie问题

```
<script src="css-backgroundposition-shorthand.js" type="text/javascript"></script>
<script src="css-boxshadow.js" type="text/javascript"></script>
<script src="css-transitions.js" type="text/javascript"></script>
<script src="grunt.js" type="text/javascript"></script>
<script src="html5shiv-printshiv.js" type="text/javascript" ></script>
<script src="html5shiv.js" type="text/javascript"></script>
<script src="ie8compat.js" type="text/javascript"></script>
<script src="img-apng.js" type="text/javascript"></script>
<script src="websockets.js" type="text/javascript" ></script>   
<script type="text/javascript" src="modernizr.js"></script> 
```

# .net - 防止应用程序在缺少 dll 时在不提供信息的情况下崩溃

> ID：13494107
> 
> 赞同：0
> 
> 时间：2012-11-21T13:15:30.030
> 
> 标签：.net, windows, vb.net, assembly-resolution

如果我的 VB.NET 程序所需的某些 dll 丢失，当我运行它时，它会崩溃并显示典型的 Windows 错误消息，并且不提供有关该错误的任何信息。

所以，我想在做任何事情之前验证所有依赖项都得到满足。但这并不是微不足道的，因为我有非托管和运行时依赖项。那么，在深入研究之前，是否有一些 CLR 设置，或者这个问题的一些更简单的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:13:52.940

这真的很容易（也就是说，避免了 Windows 的样板消息）。您只需让您的应用程序处理[UnhandledException](http://msdn.microsoft.com/en-us/library/vstudio/microsoft.visualbasic.applicationservices.windowsformsapplicationbase.unhandledexception%28v=vs.100%29.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)事件。

对于像我这样的 VB.NET 应用程序窗体，这意味着转到项目属性、`Application`选项卡并单击`View Application events`按钮。

这打开了（默认隐藏）ApplicationEvents.vb 文件。我添加了一些代码：

```
Namespace My

    ' The following events are available for MyApplication:
    ' 
    ' Startup: Raised when the application starts, before the startup form is created.
    ' Shutdown: Raised after all application forms are closed.  This event is not raised if the application terminates abnormally.
    ' UnhandledException: Raised if the application encounters an unhandled exception.
    ' StartupNextInstance: Raised when launching a single-instance application and the application is already active. 
    ' NetworkAvailabilityChanged: Raised when the network connection is connected or disconnected.
    Partial Friend Class MyApplication

        Private Sub MyApplication_UnhandledException(ByVal sender As Object, _
                                                     ByVal e As Microsoft.VisualBasic.ApplicationServices.UnhandledExceptionEventArgs _
                                                     ) Handles Me.UnhandledException
            MessageBox.Show("Application crashed due to the following unhandled exception. " + e.Exception.ToString())
        End Sub

    End Class    

End Namespace 
```

现在，如果我缺少一些 dll，我会在异常消息中获得它的名称（如果它是托管的或混合的）。如果缺少的 dll 是非托管的，我只会得到需要它的混合程序集的名称。但这对我来说没关系；将混合程序集扔到 Depends.exe 上会很快发现有问题的非托管程序集。

# php - FILTER_VALIDATE_EMAIL 的一致性如何？

> ID：13494114
> 
> 赞同：9
> 
> 时间：2012-11-21T13:15:42.480
> 
> 标签：php, email, filtering

示例有效的电子邮件地址：

> “这是一个有效的地址”@example.com

PHP代码：

```
<?php
header('Content-Type: text/plain');

$email = '"this is a valid address"@example.com';
$checked = filter_var($email, FILTER_VALIDATE_EMAIL);
var_dump($email, $checked); 
```

一台服务器上的输出：（PHP 5.2.6 版）：

> string(37) ""这是一个有效地址"@example.com"
> string(37) ""这是一个有效地址"@example.com"

`phpinfo()`：

```
Input Validation and Filtering      enabled
Revision                            $Revision: 1.52.2.42 $

Directive             Local Value   Master Value
filter.default        unsafe_raw    unsafe_raw
filter.default_flags  no value      no value 
```

另一台服务器上的输出（PHP 5.3.3 版）：

> string(37) ""这是一个有效的地址"@example.com"
> bool(false)

`phpinfo()`：

```
Input Validation and Filtering      enabled
Revision                            $Revision: 298196 $

Directive             Local Value   Master Value
filter.default        unsafe_raw    unsafe_raw
filter.default_flags  no value      no value 
```

[我在文档](http://php.net/manual/en/filter.filters.validate.php)中看不到任何表明这已更改的内容，因此可能是其他一些配置设置。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T13:20:40.923

正如您在[http://3v4l.org/vKONS](http://3v4l.org/vKONS)上看到的，过滤器的使用`FILTER_VALIDATE_EMAIL`并不一致！

[http://3v4l.org/vKONS](http://3v4l.org/vKONS)输出 PHP 5.2.0、5.2.14 - 5.2.17、5.3.3 - 5.3.18、5.4.0 - 5.4.8

```
string(37) ""this is a valid address"@example.com" 
bool(false) 
```

对于 5.2.1 - 5.2.13、5.3.0 - 5.3.2

```
string(37) ""this is a valid address"@example.com" 
string(37) ""this is a valid address"@example.com" 
```

**值得注意的是，它适用于 5.2.0 但不适用于 5.2.1-5.2.13，然后又适用于 5.2.14 ！！！**

*顺便说一句， [3v4l.org](http://3v4l.org/)是一个很好的资源，可以检查所有可用 PHP 版本中的此类行为变化。*

有[几个错误打开](https://bugs.php.net/search.php?cmd=display&search_for=FILTER_VALIDATE_EMAIL&x=9&y=5)，包括术语 FILTER_VALIDATE_EMAIL，但似乎没有一个与您的错误类型相匹配。您可以将其添加到[PHP bugtracker](https://bugs.php.net/report.php) ...

# javascript - 运行中的jquery函数

> ID：13494120
> 
> 赞同：3
> 
> 时间：2012-11-21T13:15:54.253
> 
> 标签：javascript, jquery

有没有更快的方法来做到这一点：

```
function star1() {  myFunction();jQuery('.star-position1').animate({"opacity":opacity},timeIn,function() { star1(); }); }
function star2() {  myFunction();jQuery('.star-position2').animate({"opacity":opacity},timeIn,function() { star2(); }); } 
```

等等..

然后我用

```
star1();
star2(); 
```

ETC..

如果我可以传递我拥有的星星数量并生成函数，那就太好了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:18:17.397

```
function star(num){
  myFunction();
  jQuery('.star-position' + num).animate({"opacity":opacity},timeIn,function() { 
    star(num); 
  });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:18:10.487

您可以通过将数字作为参数传递给单个函数来重构函数：

```
function star(n) {
    myFunction();
    $('.star-position' + n).animate({
        opacity: opacity
    }, timeIn, function() {
        star(n);
    });
}

star(1);
star(2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T13:18:11.157

当然，你可以这样做：

```
function star(id) { 
    myFunction();
    jQuery('.star-position'+id).animate(
        {"opacity":opacity},
        timeIn,
        function() { 
            star(id); 
        });
} 
```

然后调用：

```
star(1);
star(2); 
```

您可以`id`作为整数传入并将其连接起来，`'.star-position'`因为 JavaScript 不关心变量类型（大多数情况下）。

# java - 仅从android中的字符串中获取数字

> ID：13494121
> 
> 赞同：0
> 
> 时间：2012-11-21T13:15:59.437
> 
> 标签：java, android

我在微调器上有这个字符串`getSelectedItem()`，我只想要手机号码，但它显示名称。

```
Spinner spinnerthree = (Spinner) findViewById(R.id.spinner3);
String num=(String) spinnerthree.getSelectedItem(); 
```

返回结果为：

> 返回数=01111111111(abc)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:33:04.707

使用正则表达式，就像@keaukraine 建议的那样，这里是如何实现的：

```
Spinner spinnerthree = (Spinner) findViewById(R.id.spinner3);
String num =(String) spinnerthree.getSelectedItem();  

Pattern intsOnly = Pattern.compile("\\d+");
Matcher makeMatch = intsOnly.matcher(num);
makeMatch.find();
String result = makeMatch.group();
Log.i("Pattern", result); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:22:34.077

使用正则表达式。很多例子可以在这里找到：http: [//gskinner.com/RegExr/](http://gskinner.com/RegExr/)

选择选项卡“社区”，类别“地址和电话”。

# php - 正则表达式 preg_match 单词

> ID：13494123
> 
> 赞同：1
> 
> 时间：2012-11-21T13:16:02.487
> 
> 标签：php, regex, preg-match

我正在尝试获取以 example 开头的字符串的一部分`Name:`。如果整个字符串看起来像`Name: Carl`，我只想要`Carl`部分而不是`Name:`前缀。

我怎样才能做到这一点？我尝试过：

```
$data = file_get_contents('page.html');
$regex = '/Name:.*/';
preg_match($regex,$data,$match);
var_dump($match); 
```

但我得到了输出：

> 数组（1）{[0]=>字符串（28）“姓名：卡尔”

我不明白的另一件事是为什么`array(1) { [0]=> string(28)`显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:20:47.187

您必须将要检索的内容放入 () 中：

```
'/Name:(.*)/i' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:20:40.987

对于匹配线，请改为执行以下操作：

```
$regex = '/Name:(.*)/'; 
```

匹配的部分（在 (.*) 内）将在 $match 中。

# c++ - 总结浮点数会因类型转换而失去精度

> ID：13494127
> 
> 赞同：2
> 
> 时间：2012-11-21T13:16:13.350
> 
> 标签：c++

我试图添加两个不同权重的数字。这是我的代码：

```
void onTimeStepOp::updatePointsType1_2(boost::tuples::tuple<float,int,int,int> &_prev,
                                     boost::tuples::tuple<float,int,int,int> &_result,
                                       boost::tuples::tuple<float,float> weights)
{
    _result.get<0>() = _result.get<0>() * weights.get<0>() + _prev.get<0>() * weights.get<1>();
    std::cout<<"deb:"<<(float)_result.get<2>() * weights.get<0>()<<" "<<(float)_prev.get<2>() * weights.get<1>()<<std::endl;
    _result.get<2>() = (int)((float)(_result.get<2>()) * weights.get<0>() + (float)(_prev.get<2>()) * weights.get<1>());
    std::cout<<"deb2:"<<(float)_result.get<3>() * weights.get<0>() <<" "<< (float)_prev.get<3>() * weights.get<1>()<<std::endl;
    _result.get<3>() = (int)((float)(_result.get<3>()) * weights.get<0>() + (float)(_prev.get<3>()) * weights.get<1>());
} 
```

weights.get<0> = 0.3，weights.get<1> = 0.7。

我得到的输出如下所示：

```
resultBefore=36.8055 4 69 91 previousPPos=41.192 4 69 91
deb:20.7 48.3
deb2:27.3 63.7
resultAfter=39.8761 4 **68** 91 
```

第三个数字应该是 69(69 * 0.3 + 69 * 0.7)。但是，它是 68。类型转换表达式有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:19:43.697

转换为`int`截断，因此最轻微的舍入错误可能会导致您一败涂地。`int`您可能希望使用该函数，而不是直接转换为`round`。

我可能会补充一点，这`weights.get<0>`肯定*不是*0.3，`weights.get<1>`当然也不是 0.7，因为 0.3 和 0.7 都不能用机器浮点表示（至少在你可能使用的任何机器上都不能表示）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T13:28:17.567

转换为`int`将导致点前的数字，所以`68.1..68.9`将全部`68`如前所述。另一种解决方案可能不是那么好，那就是在铸造之前增加`0.5`你的价值。将如此`float`，这将是静止的，但将是哪个将是。`68.1``68.6``68``68.5``69``69`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:22:38.333

你应该`round()`而不是仅仅投射到`int`. 铸造会修剪小数点后的所有内容，由于舍入错误导致的数字可能类似于`68.99999999991`（只是一个例子，但给出了想法）。

# android - 如何查找浏览器/webView android 使用的默认 Accept-Charset/Accept-Encoding

> ID：13494128
> 
> 赞同：1
> 
> 时间：2012-11-21T13:16:11.567
> 
> 标签：android

我想通过添加浏览器使用的标头来发送 http 请求

接受编码，如 gzip，放气

接受字符集，如 utf-8

如何使用 android sdk 检索 Accept-Encoding + Accept-Charset

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T19:44:15.377

我不知道如何从 android sdk 中检索 Accept-Encoding 和 Accept-Charset。但是您可以在运行模拟器的主机上使用数据包嗅探器（如wireshark）来找出Android webview 发送的标头。

这是我从 Android ICS 中发现的：

连接：保持活动用户代理：Mozilla/5.0 (Linux; U; Android 4.0.4; en-us; google_sdk Build/MR1) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Accept-Encoding : gzip,deflate Accept-Language: en-US Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7

希望有帮助。

# ios - iOS6 Youtube iFrame 隐藏并再次显示时中断

> ID：13494130
> 
> 赞同：2
> 
> 时间：2012-11-21T13:16:15.397
> 
> 标签：ios, youtube

这在任何浏览器中都可以正常工作，但在 iOS6 上不行（没有在 iOS5 上尝试过）

我有一个带有 YouTube 视频的 iFrame，位于叠加层中。播放视频并切换叠加层后，视频再次中断。视频将在后台播放（您会听到声音），但不再可见。

这是一个最小的例子：http:
[//jsfiddle.net/s9M6J/2/](http://jsfiddle.net/s9M6J/2/)

```
<script>
/* jQuery */
$(document).ready(function() {
    $('a').click(function() {
        $('.videowrapper').toggleClass('hidden');
    });
});​
</script>

<style>
.hidden{
    display: none;
}​
</style>

<body>
    <a href="#" style="display: block;">toggleVideo</a>
    <div style="background: green; width: 500px; height: 500px;">
        <div class="videowrapper">
            <div id="video1">
                <iframe width="500" height="315" src="http://www.youtube.com/embed/HMrlFLZFdnQ" frameborder="0" allowfullscreen></iframe>
            </div>
        </div>
    </div>
</body> 
```

有谁知道解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T00:02:17.427

在通过 javascript 显示/隐藏的 jQuery Mobile 页面上嵌入 Brightcove 视频时遇到了类似的问题。适用于所有桌面浏览器和 android，但不适用于 iOS 6 上的 Safari。

根据[http://forum.brightcove.com/t5/General-Development/Video-in-show-hide-div-does-not-play-on-iOS/mp/17558#M2352](http://forum.brightcove.com/t5/General-Development/Video-in-show-hide-div-does-not-play-on-iOS/m-p/17558#M2352)一种解决方法是隐藏你的 videowraper通过使用一些 CSS 将其移出屏幕，`position:absolute;top:-9999px`然后在您想要显示它时恢复正常定位。

对于 jQuery Mobile 用户，这意味着在单个页面结构上嵌入多个视频 iframe`<div data-role="page">`将不起作用，需要将它们放在单独的 html 页面上。

# android - 如何在带有 API 7 的 Android 应用中使用 NumberPicker？

> ID：13494132
> 
> 赞同：7
> 
> 时间：2012-11-21T13:16:28.437
> 
> 标签：android, android-support-library, android-dialogfragment, numberpicker

我的应用程序的最小 sdk 是 7，但我可以使用来自 sdk 版本 11 的 DialogFragment，因为它位于我的 lib 目录中的支持库中。

我想做这样的例子：http: [//developer.android.com/guide/topics/ui/controls/pickers.html](http://developer.android.com/guide/topics/ui/controls/pickers.html)

但我想使用[NumberPicker](http://developer.android.com/reference/android/widget/NumberPicker.html)小部件，它也来自 sdk 版本 11，但我的应用程序不允许这样做。我必须添加其他支持库吗？

我怎样才能使用这个组件？

谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-21T13:20:42.393

> 我必须添加其他支持库吗？

Android 支持库不提供`NumberPicker`. 其他人已经创建了他们自己`NumberPicker`可以使用的反向移植，例如[SimonVT 的](https://github.com/SimonVT/android-numberpicker).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-04T15:55:27.657

对于那些想要支持数字选择器的人，至少可以回到 Froyo，无需使用第三方库或编写自己的实现，您可以使用 AOSP 消息应用程序中使用的 Romain Guy 编写的 NumberPicker 的源代码在 Github 上。[查看我在这篇文章](https://stackoverflow.com/a/38772045/3591491)上的答案以获取代码的链接。

# svn - 缺少某些修订的 SVN 日志消息

> ID：13494135
> 
> 赞同：1
> 
> 时间：2012-11-21T13:16:39.723
> 
> 标签：svn, logging

我们使用 SVN 服务器 1.6.9 作为我们的开发存储库。但是从本周开始，我们发现一些修订的日志丢失了：

```
$ svn log http://svn.mywork.com/svn/my_system/branches/A01 -l 3
------------------------------------------------------------------------
r675 | yin.su | 2012-11-14 10:21:03 +0800 (Wed, 14 Nov 2012) | 1 line

instant msg model impl 
------------------------------------------------------------------------
r602 | svnsync | 2012-10-26 19:47:29 +0800 (Fri, 26 Oct 2012) | 1 line

------------------------------------------------------------------------ 
```

所以r602的日志信息不见了。此外，我们尝试使用“svn propget”来检索日志消息：

```
$ svn propget svn:log --revprop -r 602 http://svn.mywork.com/svn/my_system/branches/A01 
```

然后什么都没有返回。

如果我们将 PEG 修订添加到 url，则返回 msg：

```
$ svn propget svn:log --revprop -r 602 http://svn.mywork.com/svn/my_system/branches/A01@HEAD
This is my SVN log message 
```

但是在“svn log”命令中将 PEG 修订添加到 url 仍然不起作用。

在 r602 中，我们实际上使用“svn merge”命令将分支 B01 合并到 A01。所以我们很困惑为什么向 propget cmd 添加 PEG 修订版有效，为什么“svn log”cmd 中缺少 r602 log msg？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:55:10.787

完全可以提交没有日志消息或包含几个空格的日志消息的 Subversion 修订，只是为了让 Subversion 不询问您是否要在没有日志消息的情况下提交：

```
$ svn commit -m" " 
```

您确定应该有日志消息吗？

此外，它也可以`svn pset`用来完全删除日志消息。你的用户有能力使用`svn pset --revprops`吗？

尝试以`--xml`格式获取输出。这样，您可以查看日志消息是否真的丢失或者只是几个空格。

```
$ svn log --xml -v -r602 $REPO | less 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-09T05:08:16.930

下面的 FAQ 中的条目值得一读，因为它不是我期望的 svn log 的行为。 [http://svn.apache.org/repos/asf/subversion/branches/server-l10n/www/faq.html#hidden-log](http://svn.apache.org/repos/asf/subversion/branches/server-l10n/www/faq.html#hidden-log)

**我看不到我刚刚提交的文件的日志条目。为什么？**

假设您在存储库上运行“svn checkout”并收到修订版 7（又名 r7）的工作副本，其中包含一个名为 foo.c 的文件。您修改文件并成功提交。发生两件事：

```
The repository moves to r8 on the server.
In your working copy, only the file foo.c moves to r8\. The rest of your working copy remains at r7. 
```

您现在拥有所谓的混合修订工作副本。一个文件位于 r8，但所有其他文件都保留在 r7，直到它们也被提交，或者直到运行 'svn update'。

```
 $ svn -v status
   7        7 nesscg       .
   8        8 nesscg       foo.c
   $ 
```

如果您运行不带任何参数的“svn log”命令，它会打印当前目录的日志信息（在上面的清单中名为“.”）。由于目录本身仍位于 r7，因此您看不到 r8 的日志信息。

要查看最新日志，请执行以下操作之一：

```
Run 'svn log -rHEAD'.
Run 'svn log URL', where URL is the repository URL.
Ask for just that file's log information, by running 'svn log foo.c'.
Update your working copy so it's all at r8, then run 'svn log'. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T06:35:38.893

抱歉回来晚了！问题终于解决了。根本原因是Apache身份验证配置错误！

现象是只丢失了merging log msg，于是我试着看了一下Apache的访问日志，发现是这样的：

```
10.14.21.75 - - [22/Nov/2012:13:22:05 +0800] "OPTIONS /svn/opencore/branches/ali00304473_Other_20120426_opencore HTTP/1.1" 200 192
10.14.21.75 - - [22/Nov/2012:13:22:05 +0800] "PROPFIND /svn/opencore/branches/ali00304473_Other_20120426_opencore HTTP/1.1" 207 772
10.14.21.75 - - [22/Nov/2012:13:22:05 +0800] "PROPFIND /svn/opencore/!svn/vcc/default HTTP/1.1" 207 1040 
```

请求中未识别用户名！然后我发现分支的 SVN 访问权限设置为允许每个人阅读：

```
[opencore:/branches/ali00304473_Other_20120426_opencore]
* = r 
```

此外，在 中`httpd.conf`，它的配置如下：

```
<Location /svn/>
        DAV svn
        SVNParentPath /home/admin/svnroot
        AuthBasicProvider file ldap
        AuthType Basic
        .....
        AuthUserFile /home/admin/svnfiles/svn-auth-file
        Satisfy Any
        Require valid-user
        AuthzSVNAccessFile /home/admin/svnfiles/svn-access-file
</Location> 
```

因此，无论是更改`* = r" to "* =`SVN 访问文件中的“”，还是将“满足任何”更新为“满足所有”都可以解决问题。

结论：在我们之前的配置（bad config）中，当一个 SVN HTTP 请求（没有 auth 信息）到达服务器时，它首先由 Apache httpd 处理。因为httpd被配置为“满足任意”，所以“Require valid-user”不是必须的选项，所以请求被转发到MOD_SVN。由于分支对每个人都开放（* = r），因此 MOD_SVN 没有将身份验证请求发送回 SVN 客户端，然后尝试从存储库中获取日志。但是获取 SVN 日志需要身份验证/授权令牌，因此 MOD_SVN 只是在模块内部默默失败，httpd 只是向客户端返回空日志消息。

# wcf - 在路由表中的 wcf 无效方法中显示自定义错误消息

> ID：13494137
> 
> 赞同：1
> 
> 时间：2012-11-21T13:16:42.913
> 
> 标签：wcf, rest, exception

我使用 wcf 实现了一个 RESTful API，并使用 System.Web.Routing.RouteTable.Routes.Add(...) 将方法映射到 URL。如果用户键入了无效的 url（即没有映射到方法的 url），说 myapiurl/geeet/ 而不是 myapiurl/get/，则当前会显示标准错误消息，例如“不允许使用方法”。

如何自定义此错误消息？

我在 Global.asax 中尝试过 Application_Error，但它没有捕获异常。我还实现了一个 IErrorHandler，IServiceBehavior，但它也没有捕捉到这个错误。我已经实现的 WebHttpBehavior 也没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:19:36.397

“方法不允许”（HTTP 状态代码 405）消息表示服务器正在使用服务器 (IIS) 不允许的 HTTP 方法（GET、POST、PUT 等）接收来自客户端的请求。例如，客户端正在提交 PUT 请求，而 IIS 未配置为接受 PUT。我认为默认情况下，IIS 只支持 GET 和 POST。

正如您在问题中描述的那样，错误的 URI 通常会导致 HTTP 状态代码为 404 资源未找到。听起来您的 IIS 配置可能会导致您的问题，因为您无法在 ASP.NET 或 WCF 层捕获异常。

# watir - watir webdriver 获取嵌入文件的 src

> ID：13494140
> 
> 赞同：2
> 
> 时间：2012-11-21T13:17:01.410
> 
> 标签：watir, watir-webdriver

hier是嵌入swf文件的html，src总是未知的（不一样）

```
<html>
<body>
<iframe id='main'><!-- first iframe -->
   <iframe ><!--second iframe -->
      <html>
      <body>
         <embed src="some.swf?refdfg" >
      </body>
      </html>
   </iframe>
</iframe>
</body>
</html> 
```

所以我想采用 src 属性所具有的一切。

```
this is xpath
ifrmae#main/iframe#never same/html/body/div/embed 
```

hier 是 watir 代码

```
require 'rubygems'
require 'watir-webdriver'
require 'open-uri'
require 'find'
b = Watir::Browser.new
b.goto 'somesite.com'
b.wait
sleep(5)
if b.frame(:id => 'main').frame(:index => 0).exists? #hier I check if second iframe exist
            #hier I want to get src of that embeded swf
    line 39 puts b.frame.(:id => 'main').frame(:index => 0).embed.src
            puts b.frame.(:id => 'main').frame(:index => 0).embed.attribute_value('src')
    end 
```

它没有嵌入它。

他是错误的

```
/usr/local/lib/ruby/gems/1.9.1/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/element.rb:428:in `method_missing': undefined method `call' for #<Watir::Frame:0x..fa17d220e located=false selector={}> (NoMethodError)
from watir.rb:39:in `<main>' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:41:24.423

尝试这个：

```
browser.embed.src 
```

或者

```
browser.embed.attribute_value('src') 
```

# sql-server - 实体框架，如何增加限制？

> ID：13494144
> 
> 赞同：2
> 
> 时间：2012-11-21T13:17:06.993
> 
> 标签：sql-server, sql-server-2008, entity-framework, database-connection, connection-pooling

我们正在构建一个应用程序，它每周都会同时对数据库发出大量请求。

我们有大约 15-20 个线程同时查询数据库。

我们实际上遇到了很多问题：

在数据库方面（内存不足）：正在解决。

但在客户端也是如此。尝试获取连接或执行命令时出现异常。这些命令是通过实体框架制作的。

该应用程序有两部分：一个网站和一个控制台应用程序。

那么谁能告诉我如何增加以下值？

*   连接超时
*   命令超时
*   连接池大小

我认为有几件事必须在服务器端（SQL Server 或 IIS）完成，但我找不到在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:58:18.743

[命令超时](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.commandtimeout.aspx)可以在`ObjectContext`实例上设置。连接超时和连接池大小[在连接字符串中配置，](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.connectionstring.aspx)但如果您只有 15-20 个线程，您的问题很可能出在其他地方，因为默认连接池大小为 100。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T12:18:28.027

将您的 objectContext 包含在 using 块中，以便在您完成工作后释放上下文。

您可以创建一个方法来传递线程，该线程使用您的实体上下文来完成您想要的工作，然后在工作完成后处理连接，您可以使用 stateinfo 对象变量传递不同的参数以在您的生命周期中使用方法。

```
void DoContextWork(object stateInfo)
    {

    // wrap your context in a using clause
    using(var objectContext = new YourEntity()
       {
           // Do work here
       }

    } 
```

您可以让多个线程调用此方法，并且每次调用连接时，您都可以在数据库上进行工作，而不会遇到上述问题。

# c - 将数组结构写入文件

> ID：13494146
> 
> 赞同：1
> 
> 时间：2012-11-21T13:17:15.963
> 
> 标签：c, arrays, struct

我正在尝试为一些示例部件设置结构数组，然后需要输出到文件。它似乎工作正常，但只会打印前 3 个部分，然后崩溃。

```
 #include "stdio.h"

main()
{
struct stock{
    char name[20];
    int partNum;
    int quantity;
};

struct stock someStock[3];

strcpy(someStock[0].name, "License plate");
someStock[0].partNum = 1234;
someStock[0].quantity= 4;

strcpy(someStock[1].name, "Head lamp");
someStock[1].partNum = 1111;
someStock[1].quantity= 2;

strcpy(someStock[2].name, "Rear wiper");
someStock[2].partNum = 2222;
someStock[2].quantity= 6;

strcpy(someStock[3].name, "Tyres");
someStock[3].partNum = 3333;
someStock[3].quantity= 10;

struct stock *ptr = &someStock[0];
int i;
FILE *file_ptr;
file_ptr = fopen("stock.dat", "w");

for(i=0;i<4;i++)
{
    fprintf(file_ptr, "%s %d %d\n",(*ptr).name,(*ptr).partNum, (*ptr).quantity);
    ptr++;
}

fclose(file_ptr);
return 0;

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T13:22:59.040

```
struct stock someStock[3]; 
```

声明了一个 3 的数组`struct stock`，但您使用的是四个。括号中的数字是元素的数量，而不是最高有效索引。宣布

```
struct stock someStock[4]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:29:16.160

正如其他人所说：

```
struct stock someStock[4]; 
```

其他一些提示：

```
struct stock *ptr = &someStock[0]; 
```

相当于：

```
struct stock *ptr = someStock; 
```

正如 Daniel 指出的那样，这是因为数组名称在该上下文中计算为指向其第一个元素的指针。

和：

```
fprintf(file_ptr, "%s %d %d\n",(*ptr).name,(*ptr).partNum, (*ptr).quantity); 
```

相当于：

```
fprintf(file_ptr, "%s %d %d\n", ptr->name, ptr->partNum, ptr->quantity); 
```

`->`被称为*结构指针运算符*，它取消引用指针并访问一个成员，`.`这与*结构成员运算符*相反，因此当您有指针时也需要*间接运算符。* `*`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:24:26.797

结构股票 someStock[3]; 意味着您在数组中有三个元素，因此数组索引可以从 0 到 2 所以 strcpy(someStock[3].name, "Tyres"); 正在使您的程序崩溃，因为 3 超出范围数组索引

# c# - c#BufferedSize 不能正常工作？

> ID：13494147
> 
> 赞同：1
> 
> 时间：2012-11-21T13:17:22.850
> 
> 标签：c#

```
FileStream stream = new FileStream("test",FileMode.Create);
BufferedStream buff = new BufferedStream(stream, 8);
BinaryWriter writer = new BinaryWriter(buff);
writer.Write(1);
writer.Write(2);
writer.Write(3);
Console.WriteLine(buff.Length); 
```

据我了解，内容在此代码中达到 8 字节的缓冲区大小时会被刷新。那么为什么`buff.Length`返回 12 以及为什么只有当我显式调用时数据才会出现在文件中`Dispose/Close`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:22:48.440

工作正常 -它`BufferedStream`不会刷新：直到它关闭`stream.Length`；`8`IE

```
// note these should really use "using" statements of similar
FileStream stream = new FileStream("test", FileMode.Create);
BufferedStream buff = new BufferedStream(stream, 8);
BinaryWriter writer = new BinaryWriter(buff);
writer.Write(1);
writer.Write(2);
writer.Write(3);
Console.WriteLine(stream.Length); // 8
Console.WriteLine(buff.Length); // 12 
```

原因`buff.Length`是`12`因为*那是底层流的长度*。基本上，`BufferedStream`只需重新暴露下面的流，并确保它不会错过缓冲数据，`Flush()`如果有缓冲数据，它会添加：

```
public override long Length
{
    get
    {
        this.EnsureNotClosed();
        if (this._writePos > 0)
        {
            this.FlushWrite();
        }
        return this._stream.Length;
    }
} 
```

因此：

```
Console.WriteLine(stream.Length); // 8
Console.WriteLine(buff.Length); // 12
Console.WriteLine(stream.Length); // 12 
```

请注意，`FileStream`也可以有自己的缓冲

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T13:18:51.070

会将其缓冲区的`BufferedStream`内容写入内部`FileStream`后`8`字节。

但是，它`FileStream`本身有自己的缓冲，并且会不那么频繁地写入内容。

# java - org.apache.http.client.ClientProtocolException

> ID：13494148
> 
> 赞同：12
> 
> 时间：2012-11-21T13:17:24.340
> 
> 标签：java, android, httpclient, x509certificate, authentication

我制作了一个 Android 应用程序，它使用 X509 证书（位于文件夹 res/raw/mykeystore.bks 中）签署到响应 9006 端口的远程服务器。

服务器要求我登录（用户名、密码）。

**当我做一个 HTTPGet 我有以下异常： org.apache.http.client.ClientProtocolException**

这是我的实现：

主要活动：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    Button b= (Button) findViewById(R.id.button1);
    b.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {               
             CredentialsProvider credProvider = new BasicCredentialsProvider();
                credProvider.setCredentials(new AuthScope(AuthScope.ANY_HOST, AuthScope.ANY_PORT),
                    new UsernamePasswordCredentials("rat#1", "rat"));
            HttpClient client = new MyHttpClient(getApplicationContext());
               ((AbstractHttpClient) client).setCredentialsProvider(credProvider);

               //final String url = "https://211.92.106.38:9006/KPIRest/testKpi/6";
               final String url = "https://211.92.106.38/KPIRest/testKpi/6";
               HttpGet httpGet = new HttpGet(url);

               try {
                HttpResponse response = client.execute(httpGet);
            } catch (ClientProtocolException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }
    }); 
```

自定义客户端类：

```
public class MyHttpClient extends DefaultHttpClient {

final Context context;

public MyHttpClient(Context context) {
    this.context = context;
}

@Override
protected ClientConnectionManager createClientConnectionManager() {

        KeyStore trustStore = null;
            trustStore = KeyStore.getInstance("BKS");

        InputStream in = context.getResources().openRawResource(R.raw.mykeystore);
        try {
            // Initialize the keystore with the provided trusted certificates
            // Also provide the password of the keystore
            trustStore.load(in, "root01".toCharArray());
        } 
        } finally {

                in.close();

        }

        SSLSocketFactory sf=null;

            sf = new MySSLSocketFactory(trustStore);

        sf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);

        HttpParams params = new BasicHttpParams();
        HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);
        HttpProtocolParams.setContentCharset(params, HTTP.UTF_8);

        SchemeRegistry registry = new SchemeRegistry();
        registry.register(new Scheme("http", PlainSocketFactory.getSocketFactory(), 80));
        registry.register(new Scheme("https", sf, 9006));
    return new SingleClientConnManager(params, registry);
}
} 
```

我的 Customc SSLSoketFactory 类：

```
public class MySSLSocketFactory extends SSLSocketFactory {
SSLContext sslContext = SSLContext.getInstance("TLS");

public MySSLSocketFactory(KeyStore truststore) throws NoSuchAlgorithmException, KeyManagementException, KeyStoreException, UnrecoverableKeyException {
    super(truststore);

    TrustManager tm = new X509TrustManager() {
        public void checkClientTrusted(X509Certificate[] chain, String authType) throws CertificateException {
        }

        public void checkServerTrusted(X509Certificate[] chain, String authType) throws CertificateException {
        }

        public X509Certificate[] getAcceptedIssuers() {
            return null;
        }
    };

    sslContext.init(null, new TrustManager[] { tm }, null);
}

@Override
public Socket createSocket(Socket socket, String host, int port, boolean autoClose) throws IOException, UnknownHostException {
    return sslContext.getSocketFactory().createSocket(socket, host, port, autoClose);
}

@Override
public Socket createSocket() throws IOException {
    return sslContext.getSocketFactory().createSocket();
}
} 
```

我的申请有什么问题？是什么导致该异常？

谢谢你们！

编辑：

我看起来更好的例外：

原因= org.apache.http.auth.MalformedChallengeException：身份验证质询为空。

编辑2：

我尝试使用[这个](http://blog.antoine.li/2010/10/22/android-trusting-ssl-certificates/)实现没有区别，我有同样的例外！

编辑3：我已经更换

```
 CredentialsProvider credProvider = new BasicCredentialsProvider();
                credProvider.setCredentials(new AuthScope(AuthScope.ANY_HOST, AuthScope.ANY_PORT),
                    new UsernamePasswordCredentials("rat#1", "rat")); 
```

客户端).setCredentialsProvider(credProvider);

使用基本的 httpclient autentication，将标头 Authorization 添加到 httpGet：

```
 httpGet.addHeader("Authorization", "Basic "+Base64.encodeToString("rat#1:rat".getBytes(),Base64.DEFAULT)); 
```

现在服务器向我发送此消息：

```
HTTP/1.1 400 Bad Request 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-23T14:05:59.157

问题是授权标头。

我们必须使用：

```
httpGet.addHeader("Authorization", "Basic "+Base64.encodeToString("rat#1:rat".getBytes(),Base64.NO_WRAP)); 
```

代替：

```
httpGet.addHeader("Authorization", "Basic "+Base64.encodeToString("rat#1:rat".getBytes(),Base64.DEFAULT)); 
```

因为 DEFAULT 参数在字符串末尾添加了“CR”行终止符，如果您使用该标题，则它是不正确的。

# objective-c - 无法与超出框架的视图交互

> ID：13494151
> 
> 赞同：0
> 
> 时间：2012-11-21T13:17:33.817
> 
> 标签：objective-c, uiview, xcode4.2

我有一些`UIVIew`超出当前主视图的内容，我使用以下代码来显示它：

```
 [UIView animateWithDuration:0.4 
                      delay:0.0 
                    options: UIViewAnimationOptionTransitionNone 
                 animations:^{
                            // menuView.center = CGPointMake(menuView.center.x+213,   menuView.center.y);
                            self.view.center = CGPointMake(self.view.center.x+215,   self.view.center.y);
                            } 
                 completion:^(BOOL finished){

                 }]; 
```

问题是我无法与此视图交互。我上面有几个按钮，它们不可点击......有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:27:45.403

核心动画获取视图的“快照”并使用单个图像进行操作，从而允许图形卡加速。如果您想在视图移动时与视图交互，您可能需要使用计时器制作自己的动画并缓慢移动视图。这将是 CPU 密集型的，因为所有计算都将由 CPU 而不是 GPU 完成。

# asp.net-mvc - 在回发时将 MvcContrib 网格内容绑定到视图模型

> ID：13494156
> 
> 赞同：1
> 
> 时间：2012-11-21T13:17:50.010
> 
> 标签：asp.net-mvc, asp.net-mvc-4, mvccontrib, mvccontrib-grid

我的 MVC4 应用程序中的一个表单显示了订单信息。视图的模型是 OrderViewModel。它有一个属性 Orderlines，它是订单行的集合。

我正在使用[MvcContrib Grid](http://mvccontrib.codeplex.com/wikipage?title=Grid&referringTitle=Documentation)来显示订单行。提交表单时，将执行以下控制器方法：

```
[HttpPost]
public ActionResult PlaceOrder(OrderViewModel model)
{
   ...
} 
```

我的问题是 Orderlines 属性在传入模型参数中始终为空。客户姓名等其他字段从视图绑定到视图模型，但订单线集合没有。有没有办法将网格中的数据绑定到在回发时发送回控制器的视图模型？

问候，尼尔斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:30:42.127

您始终可以创建自定义模型绑定器并填充数据。这在处理内部集合属性和复杂对象时特别有用。实现这一点非常简单，一旦你弄清楚了。您需要实现两个类`CustomModelBinderAttribute`和`IModelBinder`.

您的最终代码将如下所示：

```
[HttpPost]
public ActionResult PlaceOrder([OrderCustomModelBinder] OrderViewModel model)
{
   ...
}

public class OrderCustomModelBinderAttribute : CustomModelBinderAttribute
{
    public override IModelBinder GetBinder()
    {
        return new OrderBinder();
    }
}

public class OrderBinder : IModelBinder
{
    public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        // your posted form data is in bindingContext.ValueProvider.GetValue("myField")
        // the object you return should be of type OrderViewModel 

        OrderViewModel result = new OrderViewModel();
        // populate Orderlines property

        return result;
    }
} 
```

# python - 一种在 Python 中连接字符串中字符列表的优雅方法

> ID：13494162
> 
> 赞同：2
> 
> 时间：2012-11-21T13:17:59.667
> 
> 标签：python, string, list, char, concatenation

> **可能重复：**
> [如何以最佳方式将字符列表连接到字符串？](https://stackoverflow.com/questions/4166641/how-can-i-optimally-concat-a-list-of-chars-to-a-string)

我有一个字符列表：

```
['h', 'e', 'l', 'l', 'o'] 
```

有没有一种方法可以将此类列表的元素连接到不需要类似 c 的“for”循环的字符串“hello”中？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-21T13:19:35.500

这是在 Python 中连接字符串的常用方法：

```
''.join(list_of_chars) 
```

事实上，这是[*推荐*](http://www.skymind.com/~ocrow/python_string/)的方式——出于可读性和效率的原因。例如：

```
''.join(['h', 'e', 'l', 'l', 'o'])
=> 'hello' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T13:19:55.280

[str.join](http://docs.python.org/2/library/stdtypes.html#str.join)

```
>>> list('hello')
['h', 'e', 'l', 'l', 'o']
>>> ''.join(_)
'hello' 
```

它是有效的：

```
from operator import add
reduce(add, ['h', 'e', 'l', 'l', 'o']) 
```

但是针对字符串进行了优化，它也**只允许 strings**，否则它会引发`TypeError`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-21T13:20:35.317

是的。使用[str.join](http://docs.python.org/2/library/stdtypes.html#str.join)

```
>>> chars = ['h', 'e', 'l', 'l', 'o']
>>> ''.join(chars)
'hello' 
```

# sql - How to select table parameters in PL/SQL?

> ID：13494168
> 
> 赞同：0
> 
> 时间：2012-11-21T13:18:13.503
> 
> 标签：sql, oracle, select, plsql

I have table EMPLOYEES, I need to export ALL table parameters (pctfree, pctused etc.) at a time How can I do this without using many expressions like

`SELECT PCT_FREE FROM EMPLOYEES;`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:21:41.703

select dbms_metadata.get_ddl('TABLE','EMPLOYEES') from dual;

# javascript - Jquery AutoSuggestion 不会更新新的选择

> ID：13494169
> 
> 赞同：0
> 
> 时间：2012-11-21T13:18:14.370
> 
> 标签：javascript, jquery, autocomplete, fadein, fadeout

我想知道是否有人可以提供帮助。我正在使用一个从数据库自动完成的脚本，除了一个我想知道是否有人可以帮助我的问题之外，它工作正常。

单击自动建议时，它会很好地用选择填充文本框，但是如果您尝试进行另一个选择（通过再次开始输入），它不会用新选择填充文本框，它只会保留旧选择。

下面是我的代码...

**rtsearch.php**（删除 php 以节省空间）获取数据以填充 html 表单和 div：

```
<div class="display_box2" align="left">
<span class="name"><b><?php echo $country; ?></b>, <span class="bodyotxt"><?php echo $row['town']; ?></span></span>
</div>
<?php } } ?> 
```

实际的 HTML 表单自动完成：

```
<div><form action="<? $_SERVER['php self'];?>" method="post" enctype="multipart/form-data" name="form1" class="form" id="form1" autocomplete="off">
 <input name="rt" type="text" class="search2" id="inputSearch2" value="" onclick="this.value='';" /></form>
      <div id="divResult2"></div>
 </div> 
```

**查询：**

```
$(document).ready(function(){
$(".search2").keyup(function() 
{ 
var inputSearch2 = $(this).val();
var dataString = 'searchword='+ inputSearch2;
if(inputSearch2!='')
{
$.ajax({
type: "POST",
url: "autocomplete/rtsearch.php",
data: dataString,
cache: false,
success: function(html)
{
$("#divResult2").html(html).show();
}
});
}return false;    
});

$("#divResult2, #divResult2 span").on("click",function(e){ 
//var $clicked = $(e.target);
if($(this).parent().attr("id")=="divResult2"){ var $clicked = $(this).parent(); }else{ var $clicked = $(e.currentTarget); }
var $name = $clicked.find('.name').html();
var decoded = $("<div/>").html($name).text();
$('#inputSearch2').val(decoded);
});

$(document).on("click", function(e) { 
var $clicked = $(e.target);
if (! $clicked.hasClass("search2")){
$("#divResult2").fadeOut(); 
}
});
$('#inputSearch2').click(function(){
$("#divResult2").fadeIn();
});
}); 
```

我已经通过它，似乎无法找到问题。

提前感谢任何可以对此有所了解的人

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:42:10.317

您是否尝试过使用`e.currentTarget`而不是`e.target`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:20:19.277

可能很简单：

```
jQuery("#divResult2, #divResult2 span").on("click",... 
```

# arrays - VB 脚本写入 MultiString reg 键

> ID：13494171
> 
> 赞同：3
> 
> 时间：2012-11-21T13:18:17.653
> 
> 标签：arrays, vbscript

我正在编写一个查看当前 IE 主页的脚本。如果它不是我们的 Intranet，我会获取该值并将其合并到辅助页面 reg 键中。

现在我已经弄清楚如何将它合并到一个数组中（假设有一些辅助页面......如果没有什么大不了的）。我遇到的是当我最终合并它时似乎有一条额外的线。它快把我逼疯了。有什么想法吗？这是功能。他的脚本还有更多，但这是令人痛苦的部分。谢谢

```
Function AppendSecondary(StrComputer)

objReg.GetstringValue HKEY_CURRENT_USER, strKeyPath, ValueName, strValueMain
objReg.SetStringValue HKEY_CURRENT_USER, strKeyPath, ValueName, strValueMyMTD

set ws = WScript.CreateObject("Wscript.Shell")
strKeyPath=WS.RegRead(strKeyPathPath & ValueNameSecondary)
if vartype(strKeyPath)= vbArray + vbVariant then
  arStrings = strKeyPath
else
  arStrings = split(strKeyPath,chr(0))

  redim preserve arStrings(ubound(arStrings)-3)
end If

redim preserve arStrings(ubound(arStrings)+1)

arstrings(ubound(arStrings))= strvaluemain

arstrings1 = join(arStrings,VBCRLF)

arstringsnew = Array(arstrings1)

objReg.SetMultiStringValue HKEY_CURRENT_USER, strKeyPath, ValueNameSecondary, arstringsnew

End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T02:22:38.207

检查每个数组的最后一个元素，确保它不是空字符串 ("") 或非打印字符，如 Chr(10) 或 Chr(13) 或 vbCR、vbLF 或 vbCRLF。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-24T19:14:21.570

有趣的问题。

只是出于好奇，为什么要合并一个数组，然后再将其重建为一个数组？

```
arstrings1 = join(arStrings,VBCRLF) 'merge
arstringsnew = Array(arstrings1) 'reassemble 
```

无论如何，我认为您对“chr(0)”的拆分造成了这个问题，并且一个简单的修订版加入命令就足够了。

```
arstrings1 = trim(join(arstrings,vbcrlf)) 
```

如果不是这种情况，快速循环'd'loop

```
dim nArray() : Redim nArray(0)
for each str in arstrings
    if len(str)>0 then
        nArray(ubound(nArray)) = str
        redim preserve nArray(ubound(nArray)+1)
    end if
next

arrstringsnew = nArray 
```

# c - 如何有效地结合 SSE 中的比较？

> ID：13494173
> 
> 赞同：10
> 
> 时间：2012-11-21T13:18:22.787
> 
> 标签：c, optimization, assembly, sse, avx

我正在尝试将以下代码转换为 SSE/AVX：

```
float x1, x2, x3;
float a1[], a2[], a3[], b1[], b2[], b3[];
for (i=0; i < N; i++)
{
    if (x1 > a1[i] && x2 > a2[i] && x3 > a3[i] && x1 < b1[i] && x2 < b2[i] && x3 < b3[i])
    {
        // do something with i
    }
} 
```

这里 N 是一个很小的常数，比如说 8。 if(...) 语句在大多数情况下的计算结果为 false。

第一次尝试：

```
__m128 x; // x1, x2, x3, 0
__m128 a[N]; // packed a1[i], a2[i], a3[i], 0 
__m128 b[N]; // packed b1[i], b2[i], b3[i], 0

for (int i = 0; i < N; i++)
{
    __m128 gt_mask = _mm_cmpgt_ps(x, a[i]);
    __m128 lt_mask = _mm_cmplt_ps(x, b[i]);
    __m128 mask = _mm_and_ps(gt_mask, lt_mask);
    if (_mm_movemask_epi8 (_mm_castps_si128(mask)) == 0xfff0)
    {
        // do something with i
    }
} 
```

这有效，并且相当快。问题是，有没有更有效的方法来做到这一点？特别是，如果有一个寄存器包含 SSE 或 AVX 比较浮点数（放置`0xffff`或`0x0000`放入该插槽）的结果，那么所有比较的结果如何（例如）与 -ed 或 or-ed 在一起，一般来说? `PMOVMSKB`（或相应的内在）是`_mm_movemask`执行此操作的标准方法吗？

另外，如何在上面的代码中使用 AVX 256 位寄存器而不是 SSE？

**编辑：**

使用 VPTEST（来自 _mm_test* 内在）对版本进行测试和基准测试，如下所示。

```
__m128 x; // x1, x2, x3, 0
__m128 a[N]; // packed a1[i], a2[i], a3[i], 0
__m128 b[N]; // packed b1[i], b2[i], b3[i], 0
__m128i ref_mask = _mm_set_epi32(0xffff, 0xffff, 0xffff, 0x0000);

for (int i = 0; i < N; i++)
{
    __m128 gt_mask = _mm_cmpgt_ps(x, a[i]);
    __m128 lt_mask = _mm_cmplt_ps(x, b[i]);
    __m128 mask = _mm_and_ps(gt_mask, lt_mask);
    if (_mm_testc_si128(_mm_castps_si128(mask), ref_mask))
    {
        // do stuff with i
    }
} 
```

这也有效，而且速度很快。对此（Intel i7-2630QM、Windows 7、cygwin 1.7、cygwin gcc 4.5.3 或 mingw x86_64 gcc 4.5.3、N=8）进行基准测试表明，这与 64 位上的上述代码速度相同（小于 0.1%） . 内部循环的任一版本平均运行大约 6.8 个时钟，这些数据都在缓存中，并且比较总是返回 false。

有趣的是，在 32 位上，_mm_test 版本的运行速度慢了大约 10%。事实证明，编译器在循环展开后会溢出掩码，并且必须重新读取它们；这可能是不必要的，并且可以在手动编码组装中避免。

选择哪种方法？似乎没有令人信服的理由更`VPTEST`喜欢`VMOVMSKPS`. 实际上，有一个更喜欢的理由`VMOVMSKPS`，即它释放了一个 xmm 寄存器，否则该寄存器会被掩码占用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-21T13:23:58.983

如果您正在使用浮点数，您通常希望使用`MOVMSKPS`（和相应的 AVX 指令`VMOVMSKPS`）而不是`PMOVMSKB`.

除此之外，是的，这是执行此操作的一种标准方式；您还可以使用`PTEST`( `VPTEST`) 根据 SSE 或 AVX AND 或 ANDNOT 的结果直接更新条件标志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-09T02:27:18.833

要解决您的编辑版本：

如果您要直接对 的结果进行分支`PTEST`，则使用它比使用`MOVMSKPS`GP reg 更快，然后对其执行 a`TEST`以设置分支指令的标志。在 AMD CPU 上，在向量域和整数域之间移动数据非常慢（5 到 10 个周期延迟，具体取决于 CPU 型号）。

至于需要额外的注册`PTEST`，您通常不需要。您可以使用与两个 args 相同的值，就像使用常规的非向量`TEST`指令一样。（测试`foo & foo`与测试相同`foo`）。

在您的情况下，您确实需要检查是否设置了所有矢量元素。如果您反转比较，然后将结果组合在一起（因此您正在测试`!(x1 < a1[i]) || !(x2 < a2[i]) || ...`），您将拥有需要测试全零而不是全零的向量。但是处理低元素还是有问题的。如果您需要保存一个寄存器以避免需要`PTEST`/的向量掩码，您可以在执行 a并将其分支为全零`VTESTPS`之前将向量右移 4 个字节。`PTEST`

AVX 引入`VTESTPS`，我猜这避免了可能的 float -> int 绕过延迟。但是，如果您使用任何 int-domain 指令来生成测试输入，那么您不妨使用`(V)PTEST`. （我知道您使用的是内在函数，但与助记符相比，它们很难输入和查看。）

# google-maps - 根据 KML 文件中的值动态更改标记

> ID：13494175
> 
> 赞同：1
> 
> 时间：2012-11-21T13:18:39.137
> 
> 标签：google-maps, google-maps-api-3

我正在使用 KML 文件将我的数据覆盖在谷歌地图上。实际上，我想根据 KML 文件中的某个值更改标记颜色。

我怎样才能做到这一点 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:21:19.347

首先：KML 支持图标样式，但Maps-API`<color>`不支持 -element `<iconStyle>`，因此您无法更改图标的颜色（请参阅[https://developers.google.com/kml/documentation/ kmleelementsinmaps](https://developers.google.com/kml/documentation/kmlelementsinmaps)了解更多详细信息）。

您可以做的是使用具有所需颜色的不同图标图像。

但是 afaik 没有“动态”方式来改变`<href>`.`<icon>`

但是，您可以创建一个服务器端脚本来解析原始 KML 并将修改后的 KML 传递给 google。

# php - PHP通过部分变量进行搜索

> ID：13494176
> 
> 赞同：0
> 
> 时间：2012-11-21T13:18:45.120
> 
> 标签：php

我有一个包含变量`$searhing = Iphone 5GB`，其他变量包含`$search_in = 5GB come in Iphone`我想要做的是变量`$searching`在 Iphone 和 5Gb 部分中中断，然后在第二个变量中搜索，如果变量的所有部分都与第二个变量匹配，那么它会回显第二个变量。请让我知道我们如何在 PHP 中进行这种搜索。谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:23:55.147

使用[爆炸](http://php.net/manual/en/function.explode.php)

```
$searching = "iphssone 4gb";
$search_in = "4gb comes in iphone";

$toFind = explode(" ",$searching);
$myString = explode(" ",$search_in);
foreach($toFind as $word)
{
    if(!in_array($word,$myString))
        return false;

}
echo $search_in; 
```

# java - ContiPerf html 报告

> ID：13494178
> 
> 赞同：0
> 
> 时间：2012-11-21T13:18:49.603
> 
> 标签：java, load-testing, contiperf

我正在运行 contiperf，`mvn test`并在文件夹“contiperf -report”中得到一份报告，但我在报告或文件夹中都看不到任何图像/图片。

有没有人有同样的问题并且知道如何解决它？计算机是否需要在线才能完成这项工作？执行 contiperf 测试时我不在线。

干杯马格纳斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-28T05:40:51.453

是的，您**必须**在线，因为图表是使用[Google 图表 API](https://github.com/lucaspouzac/contiperf/blob/19c7c64f1abba748e7bf1550699d6590e929ee79/src/main/java/org/databene/contiperf/report/GoogleLatencyRenderer.java#L61)生成的。这里有一个图表示例：

```
<img src='http://chart.apis.google.com/chart?cht=lxy&chs=320x240&chd=t:47,48,49,50,51,52,53,54|0,80,75,1,0,0,0,0&chxt=x&chxr=0,0,54&chds=0,54,0,100&chf=c,lg,0,FFFFFF,0,FFFF88,1&chm=B,FFE69B,0,0,0|Aavg,666666,0,1,15|Amed,666666,0,1,15|A90%,666666,0,2,15' width='320', height='240'/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T22:07:35.100

它会生成漂亮的报告。你用的是什么版本？我发现的唯一问题是有时我会收到 pergen 空间错误，但与 contiperf 无关。

我认为你不需要在线。就像 junit 测试报告和运行你的 Maven 测试

# java - 在 glassfish 中启动彗星时命令集失败。错误

> ID：13494185
> 
> 赞同：1
> 
> 时间：2012-11-21T13:19:27.113
> 
> 标签：java, glassfish, comet

在启动彗星时，我收到此错误如何解决。C:\glassfish3\glassfish\bin>asadmin set server-config.network-config.protocols.protocol.http1.http.comet-support-enabled="true remote failure: No configuration found for server-config.network-config. protocols.protocol.http-1.http 命令集失败。

# jquery - 一种方法： $this.text('^');

> ID：13494195
> 
> 赞同：0
> 
> 时间：2012-11-21T13:19:47.907
> 
> 标签：jquery

我想将按钮的符号从 ^ 符号更改为指向相反方向的符号（不知道它叫什么）。

我想在 jQuery 提供的整个 .text() 函数中执行此操作。样本：

```
$this.text('&#94;'); 
```

有没有人建议如何做到这一点？

提前致谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:21:33.300

尝试[`html()`](http://api.jquery.com/html/)方法：

```
$this.html('&#94;'); 
```

**演示：http:** [//jsfiddle.net/HZcwS/](http://jsfiddle.net/HZcwS/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:27:48.650

您想要的字符称为[Unicode MODIFIER LETTER DOWN ARROWHEAD (U+02C5)](http://www.fileformat.info/info/unicode/char/02c5/index.htm)。您可以使用 HTML 实体或文字 Unicode 字符来实现此目的：

```
$("#html").html("&#709;")
$("#unicode").text("\u02c5")​ 
```

[JSFiddle在这里。](http://jsfiddle.net/bclennox/bsVW9/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:21:15.947

这是一个 HTML 实体，而不是文本。
如果要直接设置文本，则应将实际字符传递给它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T13:27:12.280

对字符使用转义码而不是 HTML 实体。

这是向下箭头的代码：

```
$('div').text('\u02C5'); 
```

演示：http: [//jsfiddle.net/Guffa/Vdd2c/](http://jsfiddle.net/Guffa/Vdd2c/)

# c# - 如何以编程方式从 Microsoft LifeCam 捕获 8MP 静止图像？

> ID：13494202
> 
> 赞同：0
> 
> 时间：2012-11-21T13:20:06.950
> 
> 标签：c#, webcam, directshow, jpeg

我有一个能够捕获 8MP (3840 x 2160) 静止 jpg 图像的 Microsoft LifeCam。

当您切换到此模式时，使用 LifeCam 随附的软件会禁用视频捕获。它仅适用于静态照片。视频捕获最高可达 1280 x 720。

我看不到如何使用提供的软件以外的任何方法访问该功能。在 GraphEdit 中检查捕获设备时，只有 1 个引脚（称为“捕获”），它只提供视频。

如何访问此功能（最好使用 C#）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:35:41.637

DirectShow 旨在用于视频捕获（流式视频），而不是静止图像。对于静止图像，您需要使用不同的 API：[Windows Image Acquisition (WIA)](http://msdn.microsoft.com/en-us/library/windows/desktop/ms630368%28v=vs.85%29.aspx)。

我的理解是最高分辨率是通过超分辨率和插值等后处理来实现的，而这种模式通过流视频驱动程序是不可用的。

规范说它只有5MP。WIA（和 TWAIN）驱动程序的可用性可能取决于操作系统版本。由于 USB 带宽限制，最大分辨率（即使是非插值）也可以限制为压缩视频格式。这篇文章 - [Can't make IAMStreamConfig.SetFormat() to work with LifeCam Studio](https://stackoverflow.com/questions/7383372/cant-make-iamstreamconfig-setformat-to-work-with-lifecam-studio) - 列举了模式并表明该模型支持最高全高清 (1920x1080) 分辨率。

# groovy - 如何在groovy中对列表进行排序

> ID：13494203
> 
> 赞同：3
> 
> 时间：2012-11-21T13:20:08.063
> 
> 标签：groovy

我正在尝试对数组列表进行排序

例如。

```
def list = [1, 1, 4, 4, 3, 4, 1] 
```

希望排序：

```
[1, 1, 1, 4, 4, 4, 3] 
```

非常感谢你。

* * *

我习惯了我的代码

例如。

```
def plnProcessGoalInstance = ......someting    
def order = plnProcessGoalInstance.plnGoal.plnTargetPlan.id.unique() //[1, 4, 3,] ,plnProcessGoalInstance.plnGoal.plnTargetPlan.id = [1, 1, 4, 4, 3, 4, 1]
def plnProcessGoalInstance = plnProcessGoalInstance.sort{ a, b -> 
           order.indexOf(a.plnGoal.plnTargetPlan.id ) <=> order.indexOf(b.plnGoal.plnTargetPlan.id )} 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:31:17.560

怎么样：

```
def order = [ 1, 4, 3 ]
def list = [ 1, 1, 4, 4, 3, 4, 1 ]

list.sort { a, b -> order.indexOf( a ) <=> order.indexOf( b ) }

assert list == [1, 1, 1, 4, 4, 4, 3] 
```

或者，假设 Deruijter 的评论是正确的，并且您希望按频率降序排序，然后按数字对具有相同频率的那些进行排序：

```
def list = [ 1, 1, 4, 4, 3, 4, 1 ]
def order = list.countBy { it }
                .sort { a, b -> 
                  b.value <=> a.value ?: a.key <=> b.key
                }.keySet().toList()
list.sort { a, b -> order.indexOf( a ) <=> order.indexOf( b ) } 
```

`countBy`需要 Groovy 1.8

# c++ - boost 程序选项：自定义验证器是否需要重载运算符>>？

> ID：13494204
> 
> 赞同：7
> 
> 时间：2012-11-21T13:20:10.043
> 
> 标签：c++, command-line, boost-program-options

在[示例](http://www.boost.org/doc/libs/1_52_0/doc/html/program_options/howto.html#id2609428)(regex.cpp) 中，库的作者创建了一个自定义结构 (magic_number) 和该结构的验证函数，以展示如何将自定义结构集成到程序选项中。我按照他的示例为自定义类（MyClass）创建了一个验证函数。编译器抱怨 lexical_cast 不适用于 MyClass。然后我实现`std::istream& operator>>(std::istream& in, MyClass& d)`，删除`void validate(.., MyClass*, ..)`，代码编译。谁能解释为什么这个例子不需要`operator>>`，而我的不需要`validate`？

编辑：

```
#include <MyLib/MyClass.h>

std::istream& operator>>(std::istream& in, MyClass& obj) {
    // some code to populate obj
    return in;
}

po::variables_map parseCommandLine(int argc, char* argv[]) {

    po::options_description options("Options");
    options.add_options()
        ("help", "produce help message")
        ("obj", po::value<MyClass>(), "")
        ;
    po::variables_map vm;
    store(po::command_line_parser(argc, argv)
        .options(options).run(), vm);
    notify(vm);

    return vm;
}

int main(int argc, char* argv[]) {

    try {
        po::variables_map vm = parseCommandLine(argc, argv);

        MyClass obj = vm["my"].as<MyClass>();

        cout << obj << endl;
    } catch(std::exception& e) {
        cout << e.what() << "\n";
        return 1;
    }   
    return 0;
} 
```

*   代码无需验证即可编译。

我还尝试对 regex.cpp 进行最小更改：

1.  删除magic_number
2.  添加`#include <MyLib/MyClass.h>`
3.  用 MyClass 替换所有出现的 magic_number。
4.  注释掉验证中的所有代码。
5.  这不编译。

编辑：添加`validate`. 他们都没有解决编译器错误。

```
void validate(boost::any& v, 
              const std::vector<std::string>& values,
              std::vector<MyClass>*, int)
{
}

void validate(boost::any& v, 
              const std::vector<std::string>& values,
              MyClass*, long)
{
}

void validate(boost::any& v, 
              const std::vector<std::string>& values,
              MyClass*, int)
{      
} 
```

编辑：它可能与命名空间有关。

在我用 包围 validate 函数后`namespace boost { namespace program_options { }}`，编译的代码没有重载 op>>。如果将 validate 放入与 MyClass 相同的命名空间中，它也可以工作。谁能解释一下？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T14:58:21.787

您面临的基本问题是 C++ 不提供将字符串转换为任意用户对象的任何工具（我的意思是无需编写任何代码）。

为了解决这个问题，program_options 提供了两种可能性：

*   你实现`operator>>`，这是标准的 C++ 方法，但它可能会影响其他一些领域（即你可能希望以特定方式解析你的对象，除了在命令行上）。在内部，用于实现转换，如果找不到`boost::lexical_cast`将抛出错误。`op>>`
*   您实现该`validate`功能，该功能特定于 program_options 但对选项管理外部没有影响。

我猜它使用模板元编程来找出您是否提供了`validate`或默认为`lexical_cast`.

`validate`由于您没有提供代码，我无法帮助您为什么尝试失败。

不过，这是一个工作示例：

```
#include <boost/program_options.hpp>
#include <vector>
#include <string>

namespace po = boost::program_options;

namespace lib {
   class MyClass
    {
    public:
        int a;
    };

    void validate(boost::any& v,
                  const std::vector<std::string>& values,
                  MyClass*, int)
    {
        po::validators::check_first_occurrence(v);
        const string& s = po::validators::get_single_string(values);
        v = boost::any(MyClass { boost::lexical_cast<int>(s) } );
    }
}

po::variables_map parseCommandLine(int argc, char* argv[])
{
    po::options_description options("Options");
    options.add_options()
        ("help", "produce help message")
        ("obj", po::value<lib::MyClass>(), "")
        ;
    po::variables_map vm;
    store(po::command_line_parser(argc, argv)
        .options(options).run(), vm);
    notify(vm);

    return vm;
}

int main(int argc, char* argv[])
{
    try {
        po::variables_map vm = parseCommandLine(argc, argv);
        lib::MyClass obj = vm["obj"].as<lib::MyClass>();
        cout << obj.a << endl;
    } catch(std::exception& e) {
        cout << e.what() << "\n";
        return 1;
    }
    return 0;
} 
```

*   更新

对于命名空间，类和验证都必须属于同一个命名空间。

# javascript - 预期标识符改为看到新的（保留字）

> ID：13494207
> 
> 赞同：1
> 
> 时间：2012-11-21T13:20:24.257
> 
> 标签：javascript, jshint

我想知道如何禁用 JSHint 对此类声明的检查，所以我可以这样做：

```
obj.new = function(){
    //...
}; 
```

代替

```
obj['new'] = function(){
    //...
}; 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T13:23:23.807

您可以使用该`es5`选项，因为保留字作为属性名称仅在 ES5 中有效。将此指令放在相关文件的顶部：

```
/*jshint es5: true */ 
```

但是，值得记住的是，如果旧浏览器遇到这样的语法，它们会抛出错误。如果您的代码需要在较旧的浏览器（尤其是 IE8）中运行，那么您最好坚持使用替代语法，或者使用非保留字作为属性标识符。

**编辑：我**[在 jslinterrors.com 上的页面中](http://jslinterrors.com/expected-an-identifier-and-instead-saw-a-a-reserved-word/)添加了有关此错误的更多详细信息。

# c# - TestContext.TestName 属性永远不会改变

> ID：13494209
> 
> 赞同：11
> 
> 时间：2012-11-21T13:20:29.200
> 
> 标签：c#, .net, visual-studio, unit-testing, mstest

**目标：**

我想使用 TestContext.TestName 属性来提取正在运行的测试的名称，以便我的 [TestCleanup] 函数可以在每次测试完成时自动将结果记录到我们的定制结果存储库中。

**问题：**

即使在我的包含 5 个类似于以下结构的测试的基本“健全性检查”测试项目中：

```
[TestMethod]
public void TestMethodX()
{
    Console.WriteLine(String.Format("In Test '{0}'",_ctx.TestName));
    Assert.IsTrue(true);
} 
```

使用像下面这样为我设置 _ctx 的类“初始化程序”：

```
[ClassInitialize]
public static void ClassInit(TestContext Context)
{
    _ctx = Context;
    Console.WriteLine("In ClassInit()");
} 
```

[[[注意：Console.WriteLines 纯粹是为了让我将鼠标悬停在上面并检查值/属性等]]]

从不改变测试运行中第一个测试的`_ctx.TestName`名称，即如果我要运行所有五个测试（'TestMethod1'、'TestMethod2'、'TestMethod3'等），它们都将'TestMethod1'记录为他们的测试名称在我的结果存储库中。单独运行测试它工作正常，但这对我来说没有用，因为我需要能够对我的应用程序运行 10's/100's/1000's 测试并让 testContext 处理 testname 或我。

我已经尝试了几次并且搜索了互联网负载并且没有其他人遇到这个问题，所以我要么：这个问题独一无二，'Google-Fu'技能很差，或者正在做一些真正愚蠢的事情。希望这是有道理的，有人有答案。

提前致谢，

安迪

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-21T14:42:28.177

发生这种情况是因为`[ClassInitialize]`整个测试运行只执行一次，并且您`_ctx`在那里初始化。使用`[TestInitialize]`相反，它在每个测试方法之前执行并覆盖[TestContext 类](http://msdn.microsoft.com/en-us/library/ms404699%28v=vs.80%29.aspx)：

```
[TestClass]
public class TestClass
{
    public TestContext TestContext { get; set; }

    [TestInitialize]
    public void Initialize()
    {
        // Runs once before each test method and logs the method's name
        Console.WriteLine(TestContext.TestName);
    }

    [TestMethod]
    public void TestMethod1()
    {
        // Logs the method name inside the method
        Console.WriteLine(String.Format("In Test '{0}'", TestContext.TestName));
    }

    // ... Your rest test methods here
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T13:28:46.290

MSTest.exe 输出可以配置为输出一个 .trx (xml) 文件，其中包含您的完整测试结果、名称、通过或失败以及任何这些测试的输出，还有一个工具可以将 TRX 文件转换为 HTML [http ://trxtohtml.codeplex.com/](http://trxtohtml.codeplex.com/)

希望这可以帮助

# java - 为每次更新移动 JLabel 的位置

> ID：13494210
> 
> 赞同：2
> 
> 时间：2012-11-21T13:20:31.517
> 
> 标签：java, swing, user-interface, jlabel, repaint

我正在学习 Swing，我有以下代码：

```
public class SimView {

private JFrame frame;
private JLabel background;
private JPanel car_panel;

public SimView() {

    frame = new JFrame("GUI");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(400, 500);
    frame.getContentPane().setLayout(null);

    background = new JLabel("");
    background.setIcon(new ImageIcon(
            "C:\\Users\\D__\\Desktop\\background.png"));
    background.setBounds(0, 0, 384, 462);
    frame.getContentPane().add(background);
    frame.setVisible(true);

    car_panel = new JPanel();
    car_panel.setBounds(175, 430, 16, 21);
    car_panel.setVisible(true);
    car_panel.setBackground(Color.BLACK);
    background.add(car_panel);

    MoveCarRunnable carMover = new MoveCarRunnable(car_panel);

}

private static class MoveCarRunnable implements Runnable {

    private JPanel car;

    MoveCarRunnable(final JPanel car) {

        this.car = car;

    }

    @Override
    public void run() {
        // Should I call rePaint() on the car_panel here then ? 

    }

} 
```

我想要做的是为每次更新移动名为“car”的 JLabel 坐标，以获得它自行移动的效果，即没有用户交互。我不太确定如何做到这一点，我想我需要某种 repaint() 方法来为每次更新重绘 JLabel 的位置。但是我如何让这个类知道它需要更新位置？

任何指针（链接/代码）将不胜感激。我想了解 Swing 及其组件在这种情况下如何工作的概念，而不是仅仅采用解决方案，但我当然对解决方案感兴趣，因此我可以更仔细地研究它。谢谢

**编辑：** 请看我上面的编辑代码

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T13:24:37.083

You will have to create a separate `Thread` that would modify the location of your label and then call `validate()` and `repaint()` on the container (`frame.getContentPane()`). Don't forget to put some `sleep()` value inside the thread.

However, there would be a better approach to create a separate `JPanel`. Inside it you would override the `paintComponent` method or the `paint` method and there you would draw an image instead of moving `JLabel`s around.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:24:21.370

You should better add a `JPanel` instead of the label to your layout. Choose the dimensions of the `JPanel` so that it can contain your car in every phase.

Then overwrite the `paint` method of that panel to position the image on it.

# android - 在 Android 中为包含的布局设置样式

> ID：13494211
> 
> 赞同：0
> 
> 时间：2012-11-21T13:20:34.833
> 
> 标签：android, layout, background, include

我有两个包含功能相同面板的布局。一个需要圆底角的背景；一个需要所有方角的背景。在所有其他方面，面板应完全相同。

是否可以更改包含布局的背景而不将其包围在`<FrameLayout>`包装器或其他包装器中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:22:51.217

您可以仅为背景创建包装器布局，并将[包含](http://developer.android.com/training/improving-layouts/reusing-layouts.html)用于所有常见小部件

first_layout.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width=”match_parent”
    android:layout_height=”match_parent”
    android:background="<FIRST_BACKGROUND>">

    <include layout="@layout/main_layout"/>

</LinearLayout> 
```

second_layout.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width=”match_parent”
    android:layout_height=”match_parent”
    android:background="<SECOND_BACKGROUND>">

    <include layout="@layout/main_layout"/>

</LinearLayout> 
```

其中 main_layout 包含您要重用的所有组件

# c++ - Google Mock 未报告低于预期的通话次数

> ID：13494214
> 
> 赞同：0
> 
> 时间：2012-11-21T13:20:39.683
> 
> 标签：c++, googletest, googlemock

我写了一个谷歌测试（使用谷歌模拟）。以下是相关代码：

```
MockObj * obj = new MockObj ();
MockDI * mock_di = new DI();
MockDIPtr mock_di_ptr(mock_di); // boost shared ptr
Data data; // sort of on array
data.append(1); data.append(2); // Add two entries
EXPECT_CALL(*obj, get_di_ptr()).WillOnce(Return(mock_di_ptr));
EXPECT_CALL(*mock_di_ptr, get_data(_,_)).WillOnce(SetArgReferee<1>(data));
EXPECT_CALL(*obj , enqueue(_)).Times(2); 
```

实际的实现是：

```
di_ptr->get_data(int, data); // data is updated via reference
for (int i = 0; i < data.size(); ++i)
{
    enqueue(data[i]);
} 
```

基本上，`enqueue()`应该为数据中的每个条目调用一次。此外，模拟是正常的模拟（不是严格等）

正如预期的那样，当我检查`Times(2)`.

正如预期的那样，当我检查`Times(0)`or时，这个测试失败了`Times(1)`。

但是，当我检查时，这个测试通过了`Times(3)`！

为什么？我应该怎么做才能检测到这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T14:33:42.497

`MockDI * mock_di = new DI();` should probably read `MockDI * mock_di = new MockDI();` to make the line `EXPECT_CALL(*mock_di_ptr, get_data(_,_)).WillOnce(SetArgReferee<1>(data));` work.

[aleguna](https://stackoverflow.com/users/1773602/aleguna) made a good point. The following simplified experiment yields the error `Actual function call count doesn't match EXPECT_CALL(mock, mockMe(_))...`. I suggest to debug the method under test and check `data.size()` after `di_ptr->get_data()`. Then set a breakpoint in `Data::append()` and see who adds more elements.

```
#include "gtest\gtest.h"
#include "gmock\gmock.h"

using ::testing::_;

class Dependency
{
public:
    virtual ~Dependency() {}

    virtual void mockMe(int i);
};

void Dependency::mockMe(int i)
{
}

class MockDependency : public Dependency
{
public:
    MOCK_METHOD1(mockMe, void (int i));
};

class Cut
{
public:
    void testMe(Dependency& dependency);
};

void Cut::testMe(Dependency& dependency)
{
    for (int i=0; i<2; ++i)
    {
        dependency.mockMe(i);
    }
}

TEST(Experiment, VerifyExactCallCount)
{
    MockDependency mock = MockDependency();
    Cut cut;

    EXPECT_CALL(mock, mockMe(_)).Times(3);

    cut.testMe(mock);
} 
```

# git - Git：构建具有多个分支的项目

> ID：13494217
> 
> 赞同：3
> 
> 时间：2012-11-21T13:20:41.737
> 
> 标签：git

我在 Git 下有一个（大）Fortran 项目。有不同的活动分支，对应于正在开发的功能。我想找到一种方便的方法来维护每个分支的代码的编译版本。

该代码当前使用 Make 编译，所有目标文件与二进制文件一起保存在一个单独的文件夹（如 build_branch1）中。目录结构是这样的：

> 生成文件
> ./src
> ./build_branch1/objects
> ./build_branch1/bin
> ./build_branch2/objects
> ./build_branch2/bin
> ...

因此，原则上，我可以像这样编译所有分支：

> git checkout branch1
> make --prefix=build_branch1
> git checkout branch2
> make --prefix=build_branch2
> 等等...

Make 将源文件的时间戳（由 Git 新签出）与 build_branchN 文件夹中的目标文件进行比较，并重新编译已更改的文件。问题是 Git 更改了分支 1 和分支 2 之间不同的所有源文件的时间戳，因此许多文件在不需要时被重新编译。由于代码需要很长时间才能编译（最多 30 分钟），这可能会带来很大的不便。

我想知道在这种情况下什么应该是最好的策略。我正在考虑在每次结帐后更新时间戳，就像在这篇文章中一样：[git 的 use-commit-times 是什么？](https://stackoverflow.com/q/1964470/1005470) 你会推荐什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:33:48.870

您可以使用在这些答案（包括[我](https://stackoverflow.com/a/1964508/6309)的）时不存在的机制，而不是[修改每个 checkout 的时间戳](https://stackoverflow.com/a/2038768/6309)：。[`git notes`](http://git-scm.com/docs/git-notes)

你可以：

*   每次构建后，记下使用构建时间戳构建的提交
*   在每次构建之前，查找最后一个构建时间戳的注释（在以分支命名的命名空间中）并使用该时间戳修改任何文件（根据 git status，当前没有被修改）。

这个想法是记录您需要的信息：

*   在 Git 存储库中（所以它可以持续存在）
*   以不改变当前历史的方式（不修改提交的 SHA1）

# .net - 协议缓冲区 .NET 继承

> ID：13494219
> 
> 赞同：2
> 
> 时间：2012-11-21T13:20:44.880
> 
> 标签：.net, protocol-buffers, protobuf-net

我有协议缓冲区格式的数据，可以描述如下

```
message Sections {
    repeated Section sections = 1;
}

message Section {
    required uint32 type = 1;
    required bytes payload = 2;
}

message SectionType1 {
    required int32 fieldType1 = 1;
    // ...
}

message SectionType2 {
    required int32 fieldType2 = 1;
    // ...
}

message SectionType3 {
    required int32 fieldType3 = 1;
    // ...
} 
```

我正在使用 protobuf-net 库（+ protogen + 预编译）。如何将此类数据反序列化为类似于

```
public class Sections
{
    public List<Section> Sections { get; }
}

public abstract class Section
{
}

public class SectionType1 : Section
{
    public int FieldType1 { get; }
}

public class SectionType2 : Section
{
    public int FieldType2 { get; }
}

public class SectionType3 : Section
{
    public int FieldType3 { get; }
} 
```

是否可以使用 .NET 中的此类数据（因为我使用的是轻型框架，所以使用预编译）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:33:20.823

为此，您必须手动进行 - 即有

```
[ProtoContract]
public abstract class Section
{
    [ProtoMember(1)] public int Type {get;set;}
    [ProtoMember(2)] public byte[] Payload {get;set;}
} 
```

并手动处理其余部分。protobuf-net 继承映射在*以下*.proto 模式之上：

```
message Section {
    optional SectionType1 Type1 = 1;
    optional SectionType2 Type2 = 2;
    optional SectionType3 Type3 = 3;
} 
```

我们在哪里，说：

```
[ProtoInclude(1, typeof(SectionType1)]
[ProtoInclude(2, typeof(SectionType2)]
[ProtoInclude(3, typeof(SectionType3)]
public abstract class Section
{
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-13T02:39:04.377

只是想补充一下我的发现，我创建了 .proto 文件，它有一个基类和 20 个派生类。我通过 protobuf-net r668\ProtoGen 生成了代码。我按照上面列出的步骤进行操作，但仍然出现错误，找不到子类型。

只是通过尝试，我看到生成的代码对所有生成的类都有 global::ProtoBuf.IExtensible，我从所有生成的类中删除了这个加上下面 3 行 private global::ProtoBuf.IExtension extensionObject; global::ProtoBuf.IExtension global::ProtoBuf.IExtensible.GetExtensionObject(bool createIfMissing) { return global::ProtoBuf.Extensible.GetExtensionObject(ref extensionObject, createIfMissing); }

在此之后，错误没有出现。我不知道为什么它有帮助，但它有效。

# antlr3 - ANTLR：现场访问和评估

> ID：13494222
> 
> 赞同：1
> 
> 时间：2012-11-21T13:20:48.320
> 
> 标签：antlr3, context-free-grammar

我正在尝试编写一段语法来表达层次结构的字段访问，例​​如*abc*其中*c*是*ab*的字段，*b*是 a 的*字段*。

要评估**abcde**的值，我们需要评估**abcd**的值，然后得到**e**的值。要评估**abcd**的值，我们需要评估**abc**的值，然后得到**d**的值，依此类推......

如果您有这样的树（箭头表示“lhs 是 rhs 的父级”）：

```
Node(e) -> Node(d) -> Node(c) -> Node(b) -> Node(a) 
```

评价很简单。使用递归，我们只需要解析孩子的值，然后访问正确的字段。

问题是：我的 ANTLR 语法文件中有这 3 条规则：

```
tokens {
    LBRACE  = '{' ;
    RBRACE  = '}' ;
    LBRACK  = '[' ;
    RBRACK  = ']' ;
    DOT     = '.' ;
    ....
}

reference
    : DOLLAR LBRACE selector RBRACE -> ^(NODE_VAR_REFERENCE selector)
;

selector
    : IDENT access -> ^(IDENT access)
;

access
    : DOT IDENT access? -> ^(IDENT<node=com.at.cson.ast.FieldAccessTree> access?)
    | LBRACK IDENT RBRACK access? -> ^(IDENT<node=com.at.cson.ast.FieldAccessTree> access?)
    | LBRACK INTEGER RBRACK access? -> ^(INTEGER<node=com.at.cson.ast.ArrayAccessTree> access?)
; 
```

正如所料，我的树有这种形式：

```
ReferenceTree
  IdentTree[a]
    FieldAccessTree[b]
      FieldAccessTree[c]
        FieldAccessTree[d]
          FieldAccessTree[e] 
```

评估并不像其他情况那么容易，因为我需要获取当前节点的值，然后将其提供给子节点等等......

有没有办法使用 ANTLR 来反转树的顺序，或者我需要手动完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T18:55:05.870

您只能通过使用内联树运算符¹，`^`而不是重写规则来执行此操作。

一个演示：

```
grammar T;

options {
  output=AST;
}

tokens {
  ROOT;
  LBRACK = '[' ;
  RBRACK = ']' ;
  DOT    = '.' ;
}

parse
 : selector+ EOF -> ^(ROOT selector+)
 ;

selector
 : IDENT (access^)*
 ;

access
 : DOT IDENT             -> IDENT
 | LBRACK IDENT RBRACK   -> IDENT
 | LBRACK INTEGER RBRACK -> INTEGER
 ;

IDENT   : 'a'..'z'+;
INTEGER : '0'..'9'+;
SPACE   : ' ' {skip();}; 
```

解析输入：

```
a.b.c    a[1][2][3] 
```

将产生以下 AST：

![在此处输入图像描述](../Images/d8abd8806670770abe2bf9094cdbcc78.png)

* * *

¹有关内联树运算符和重写规则的更多信息，请参阅：[如何输出使用 ANTLR 构建的 AST？](https://stackoverflow.com/questions/4931346/how-to-output-the-ast-built-using-antlr)

# jquery - 通过单击另一个来更改 div 中的图像 - jQuery

> ID：13494225
> 
> 赞同：0
> 
> 时间：2012-11-21T13:20:50.853
> 
> 标签：jquery, css

我将为产品创建一个颜色选择器。我有 12 种颜色选项，因此要显示 12 张照片。

我希望它看起来像这个 Flash 页面：

[http://www.renault.co.uk/cars/model/newmeganehatch/colourselector.aspx](http://www.renault.co.uk/cars/model/newmeganehatch/colourselector.aspx)

不过，我更喜欢使用 jQuery。

我正在考虑使用 div 行来包含颜色，并在单击颜色时调用主图片容器 div 中的图像更改。

堆叠图像并使用 display:none 会更好，还是使用 jQuery 循环之类的插件会更好？

提前致谢。

编辑以显示迄今为止的代码：

```
<!--The color picker div-->
<div class="picker p1" data-bkgnd="images/1.jpg"></div>
<div class="picker p2" data-bkgnd="images/2.jpg"></div>
<div class="picker p3" data-bkgnd="images/3.jpg"></div>

<!--The container for the product image-->
<div class="productdisplay"></div>

    <script type="text/javascript">
     $(document).ready(function(){
       $(".picker").click(function(){

           //Load background string from data of clicked element
           var bVal = $(this).data('bkgnd');

           //Set display's background to retrieved background string
           $(".productdisplay").hide('fade').css({'background-image': "url('" + bVal + "')"}).show('fade');
       });
     });
    </script> 
```

和 CSS

```
.productdisplay {
height:327px;
width:590px;
float:left;
background-image:url('images/1.jpg');
}
.picker {
height:50px;
width:50px;
float:left;
}
.p1 {
background:#FFF;
}
.p2 {
background:#C4C9C5;
}
.p3 {
background:#988879;
} 
```

目前在将 bVal 数据加载到 div 时将“未定义”作为 URL，不知道为什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:02:18.517

这样的事情可以让你开始：

```
//The color picker div    
<div class="picker" data-bkgnd="/content/images/someimg.jpg"></div>

//The container for your product image
<div class="productDisplay"></div>

<script type="text/javascript">

 $(document).ready(function(){
   $(".picker").click(function(){       
       //Load background string from data of clicked element
       var bVal = $(this).attr('data-bkgnd');
       //Set display's background to retrieved background string
       $(".productDisplay").hide().css({'background-image': "url(" + bVal + ")"}).show();
   });
 });

</script> 
```

[点击这里查看小提琴](http://jsfiddle.net/TNCodeMonkey/M9ysa/3/)

# c++ - 声明数组导致错误

> ID：13494228
> 
> 赞同：8
> 
> 时间：2012-11-21T13:21:15.923
> 
> 标签：c++, c, arrays

我无法在代码块 ide中**执行以下代码，但如果我全局声明数组，那么我可以****执行**它。
全局声明和本地声明时数组大小有哪些限制？**在 spoj、codechef 等竞争性编程竞赛中声明数组大小的经验法则是什么？**
此外，如果错误是由于代码块 ide 引起的。那我该如何纠正呢？

```
#include<iostream>

using namespace std;

int main()
{
    int arr[999999];

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T13:25:21.693

不允许这样做的原因是因为它将总共 999999*sizeof(int) 字节（在典型的 64 位环境中为 7.6MiB）添加到 main() 的堆栈帧，这对于一个非常大的内存量单栈帧。

堆栈帧的最大大小取决于您的实现和环境设置。

如果您确实需要此内存，您应该静态地（使用静态变量）或动态地定位它，这取决于您是否需要在程序中多次调用 main()。如果您满足于动态内存，请考虑改用向量并使用`std::vector<int> arr(999999);`以声明初始大小设置为 999999 的向量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T13:26:06.967

如果没有确切的错误（你能提供这个吗？），很难准确地说出发生了什么，但你很可能会遇到堆栈溢出。堆栈的具体大小是由实现定义的，大多数平台都提供了一种扩大它的方法。

解决这个问题最简单、最正确的方法是使用托管标准容器来保存数组，如 a `std::vector`，这将分配到 freestore 并为您管理内存并提供一致的接口。

```
#include <vector>
int main() {
     std::vector<int> arr (999999);
     return 0;
} 
```

作为一般规则，与原始数组相比，更喜欢容器，这几乎没有开销。

## 参考

[http://en.cppreference.com/w/cpp/container/vector](http://en.cppreference.com/w/cpp/container/vector)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-21T13:29:56.040

一般来说，在全局范围内声明的变量在 ELF 可执行文件的 .data 或 .bss 部分中“分配”。在方法/函数内部声明的变量（包括向量）在方法/函数执行时从堆栈中动态分配。堆栈的大小取决于操作系统。

所以，总而言之，这个错误很可能是由于堆栈溢出=D

在编程竞赛（spoj、topcoder、icpc、codejam 等）中动态声明向量是一个好主意。无论是使用vector，malloc还是new。这保证您只使用所需的内存量。

# c# - 使用后台工作人员动态更新 DataGrid

> ID：13494229
> 
> 赞同：0
> 
> 时间：2012-11-21T13:21:17.927
> 
> 标签：c#, multithreading, backgroundworker

我有一个`ObservableCollection`自定义类，它包含一个字符串和一个 int：

```
public class SearchFile
{
    public string path { set; get; }
    public int occurrences { set; get; }
} 
```

我想在`dataGrid`. 该集合具有在更新时通知的方法，到目前为止，只需将其链接到`DataGrid.ItemsSource`（正确的？）。这是网格 XAML（`dataGrid1.ItemsSource = files;`在 C# 代码隐藏中）：

```
 <DataGrid AutoGenerateColumns="False" Height="260" Name="dataGrid1" VerticalAlignment="Stretch" IsReadOnly="True" ItemsSource="{Binding}" >
            <DataGrid.Columns>
                <DataGridTextColumn Header="path" Binding="{Binding path}" />
                <DataGridTextColumn Header="#" Binding="{Binding occurrences}" />
            </DataGrid.Columns>
        </DataGrid> 
```

现在事情变得更复杂了。我首先要显示`path`默认值`occurrence`为零的 s。然后，我想遍历每一个`SearchFile`并用计算值更新它`occurrence`。这是辅助函数：

```
 public static void AddOccurrences(this ObservableCollection<SearchFile> collection, string path, int occurrences)
    {
        for(int i = 0; i < collection.Count; i++)
        {
            if(collection[i].path == path)
            {
                collection[i].occurrences = occurrences;
                break;
            }
        }
    } 
```

这是占位符工作函数：

```
 public static bool searchFile(string path, out int occurences)
    {
        Thread.Sleep(1000);
        occurences = 1;
        return true; //for other things; ignore here     
    } 
```

我正在使用 a`BackgroundWorker`作为后台线程。就是这样：

```
 private void worker_DoWork(object sender, DoWorkEventArgs e)
    {           
        List<string> allFiles = new List<string>();
        //allFiles = some basic directory searching

        this.Dispatcher.Invoke(new Action(delegate
        {
            searchProgressBar.Maximum = allFiles.Count;
            files.Clear(); // remove the previous file list to build new one from scratch
        }));

        /* Create a new list of files with the default occurrences value. */
        foreach(var file in allFiles)
        {
            SearchFile sf = new SearchFile() { path=file, occurrences=0 };
            this.Dispatcher.Invoke(new Action(delegate
            {
                files.Add(sf);
            }));
        }

        /* Add the occurrences. */
        foreach(var file in allFiles)
        {
            ++progress; // advance the progress bar
            this.Dispatcher.Invoke(new Action(delegate
            {
                searchProgressBar.Value = progress;
            }));

            int occurences;
            bool result = FileSearcher.searchFile(file, out occurences);

            files.AddOccurrences(file, occurences);
        }
    } 
```

现在当我运行它时，有两个问题。首先，更新进度条的值会引发`The calling thread cannot access this object because a different thread owns it.`异常。为什么？它在调度程序中，所以它应该可以正常工作。其次，`foreach`循环`bool result =...`在行上中断。我将其注释掉并尝试设置`int occurences = 1`，然后循环继续进行，但发生了一些奇怪的事情：每当我调用该方法时，它要么全为零，全为一，要么处于中间状态，onez 在看似随机的数字之后开始零）。

为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:56:20.667

Dispatcher 并不像听起来那么简单。使用调度程序意味着代码将在创建包含对象的同一线程上执行，但这不一定是 UI 线程。确保在屏幕上显示的实际 UI 元素中定义了 worker_DoWork 方法（这只是消除后台线程创建的元素的简单方法）。

真的，看看你的代码，我不确定你为什么要使用后台工作人员。这看起来实际上会更慢，因为不断地分派给 UI 线程。相反，我认为您更好的选择是将长时间运行的部分放入任务中，并在单个回调中更新 UI。例如，在您的代码中，对于 UI 线程而言实际上太慢的唯一事情可能是 FileSearcher 调用。这很容易放入一个返回找到的结果数量的后台任务。

至于 FileSearcher 上的问题，您的方法定义不匹配。您发布的方法只需要一个路径和 out int，但是当您调用它时，您会传递 4 个参数。如果没有看到您实际上调用的超载，很难猜测出了什么问题。

编辑：让我再备份一点。您的根本问题是 WPF 不支持绑定到从后台线程修改的集合。这就是那里所有调度和其他复杂代码的原因。我最初的建议（长期工作的一项任务）是解决问题的一种方法。[但是使用ObservableList 类](http://blog.quantumbitdesigns.com/2008/07/22/wpf-cross-thread-collection-binding-part-4-the-grand-solution/)可能会做得更好。这使您可以从后台线程更新集合，并自动通知 UI 而无需使用调度程序。这可能会使大多数复杂的线程问题消失。我也建议阅读那里的前三篇文章以供参考，那里有很多很好的信息。

# google-apps-script - 将图像 blob 插入谷歌电子表格

> ID：13494230
> 
> 赞同：2
> 
> 时间：2012-11-21T13:21:22.953
> 
> 标签：google-apps-script, google-sheets, blob

是否可以将图像 blob 插入谷歌电子表格？

仅在 SpreadSheet api 中找到 insertImage(url, column, row) 。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:02:12.477

目前，这在应用程序脚本中是不可能的。您只能使用公共 url 插入图像。[您可以在问题跟踪器](https://code.google.com/p/google-apps-script-issues/issues/entry)中提交功能请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-07T13:42:10.447

[这是问题的链接](https://code.google.com/p/google-apps-script-issues/issues/detail?id=3303)

继续点击星星

# python - Python Alt 挂钩

> ID：13494234
> 
> 赞同：2
> 
> 时间：2012-11-21T13:21:38.237
> 
> 标签：python, hook, alt, pyhook

当我遇到问题时，我正在编写这个类型记录程序 -`Alt`密钥没有 Ascii 编号，因此我无法以常规方式挂钩它。这是我没有钩子尝试的源代码`Alt`，问题是 - 我如何钩子`Alt`？我知道有一个名为“Alt”的类变量和一个名为“IsAlt”的内置函数，但我不知道如何使用它们。

```
import pythoncom,pyHook

log = ""
logpath = "log.txt"

openfile = open(logpath,"w")
openfile.write("")

def OnKeyboardEvent(event):
    try:
        global log
        if event.Ascii == 8:
            log = "[BS]"
        elif event.Ascii == 9:
            log = "[TAB]"
        elif event.Ascii == 13:
            log = "[NL]"
        elif event.Ascii == 27:
            log = "[ESC]"
        elif event.Ascii == 15:
            openfile.close()
            exit()
        else:
            log = chr(event.Ascii)
        openfile.write(log)
    except:
        pass

hm = pyHook.HookManager()
hm.KeyDown = OnKeyboardEvent
hm.HookKeyboard()
pythoncom.PumpMessages() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-01T20:44:01.327

映射键时不要使用**event.Ascii** ，而是使用**event.KeyID**。

请注意，像**AltGr**这样的键有 2 个映射 ID：一个用于按下键，另一个用于释放键。

# mysql - 优化 SQL 查询以减少执行时间

> ID：13494236
> 
> 赞同：1
> 
> 时间：2012-11-21T13:21:48.193
> 
> 标签：mysql

应用了所有过滤器的我的 SQL 查询返回 100 万（一百万）条记录。要获得所有记录需要 76.28 秒 .. 这是不可接受的。如何优化我的 SQL 查询，这应该花费更少的时间。我正在使用的查询是：

```
 SELECT cDistName , cTlkName, cGpName, cVlgName , 
           cMmbName , dSrvyOn 
      FROM sspk.villages 
 LEFT JOIN gps  ON nVlgGpID = nGpID
 LEFT JOIN TALUKS ON nGpTlkID = nTlkID   
 left JOIN dists ON nTlkDistID = nDistID
 LEFT JOIN HHINFO ON nHLstGpID = nGpID
 LEFT JOIN MEMBERS ON nHLstID = nMmbHhiID
 LEFT JOIN BNFTSTTS  ON nMmbID = nBStsMmbID
 LEFT JOIN STATUS ON nBStsSttsID = nSttsID
 LEFT JOIN  SCHEMES ON  nBStsSchID = nSchID
     WHERE (
               (nMmbGndrID = 1 and nMmbAge between 18 and 60) 
           or  (nMmbGndrID = 2 and nMmbAge between 18 and 55)
           )
      AND cSttsDesc like 'No, Eligible' 
      AND DATE_FORMAT(dSrvyOn , '%m-%Y') < DATE_FORMAT('2012-08-01' , '%m-%Y' )
 GROUP BY cDistName , cTlkName, cGpName, cVlgName , 
        DATE_FORMAT(dSrvyOn , '%m-%Y') 
```

我在论坛和外部搜索并使用了一些给出的提示，但几乎没有任何区别。我在上面的查询中使用的连接是左连接全部在 Primary Key 和 Foreign key 上。任何人都可以建议我如何修改此 sql 以减少执行时间....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:48:32.600

先生，您是一个对 MySQL 要求很高的用户！以您提到的速度从大规模连接的结果集中检索一百万条记录是每条记录 76 微秒。许多人会认为这是可以接受的性能。请记住，您的客户端软件可能是具有该大小结果集的限制因素：它必须消耗巨大的结果集并对其进行处理。

话虽如此，我看到了几个问题。

首先，重写您的查询，使每个列名都由表名限定。您将为自己和下一个维护它的人执行此操作。您可以一目了然地看到您的`WHERE`标准需要做什么。

其次，考虑这个搜索标准。它需要两次搜索，因为`OR`.

```
 WHERE (
           (MEMBERS.nMmbGndrID = 1 and MEMBERS.nMmbAge between 18 and 60) 
       or  (MEMBERS.nMmbGndrID = 2 and MEMBERS.nMmbAge between 18 and 55)
       ) 
```

我猜这些标准符合您的大多数人口——18-60 岁的女性和 18-55 岁的男性（猜测）。您可以将 MEMBERS 表放在 LEFT JOIN 列表的首位吗？或者你可以在你的表中放置一个派生列（MEMBERS.working_age = 1 或类似的）吗？

还可以在 MEMBERS 上尝试 (nMmbGndrID,nMmbAge) 上的复合索引以加快速度。它可能会也可能不会起作用。

第三，考虑这个标准。

```
 AND DATE_FORMAT(dSrvyOn , '%m-%Y') < DATE_FORMAT('2012-08-01' , '%m-%Y' ) 
```

您已将函数应用于 dSrvyOn 列。这使该搜索无法使用索引。相反，试试这个。

```
 AND dSrvyOn >= '2102-08-01'
  AND dSrvyOn <  '2012-08-01' + INTERVAL 1 MONTH 
```

如果您在 dSrvyOn 上有索引，这将在该索引上进行范围搜索。我的评论也适用于您的 ORDER BY 子句中的函数。

最后，正如其他人提到的，不要使用`LIKE`搜索 where `=`will do。`column LIKE '%something%'`如果您想要可接受的性能，切勿使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:34:11.793

您声称自己是基于良好且唯一的索引的连接。所以几乎没有什么可以优化的。也许有一些提示：

*   尝试优化您的表格布局，也许您可​​以减少所需的连接数。这可能带来比其他任何东西更多的性能优化。

*   检查您的硬件（可用内存和其他东西）和服务器配置。

*   使用 mysqls`explain`功能查找瓶颈。

*   也许您可以专门为此查询创建一个辅助表，该表由后台进程填充。这样查询本身运行得更快，因为工作是在后台查询之前完成的。如果查询检索的数据不一定与数据库中的每一次更改同步，这通常会起作用。

*   检查 RDBMS 是否真的是正确的数据库类型。出于许多目的，图数据库效率更高并提供更好的性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:40:20.847

您的`like`操作员可能会阻止您——全文搜索`like`并不是 MySQL 的强项。

考虑设置全文索引`cSttsDesc`（首先确保它是一个`TEXT`字段）。

```
ALTER TABLE articles ADD FULLTEXT(cSttsDesc);

SELECT
    *
FROM
    table_name
 WHERE MATCH(cSttsDesc) AGAINST('No, Eligible') 
```

或者，您可以设置一个布尔标志而不是`cSttsDesc like 'No, Eligible'`.

来源：[http ://devzone.zend.com/26/using-mysql-full-text-searching/](http://devzone.zend.com/26/using-mysql-full-text-searching/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T13:31:55.640

您可以创建视图以避免长时间的查询和时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T13:31:10.813

这个 SQL 有很多多余的东西，可能不会出现在`explain`.

如果您需要一个字段，则它不应该位于左联接中的表中 - 左联接适用于数据可能位于联接表中的情况，而不是必须存在的情况。

如果所有必填字段都在同一个表中，则它应该在您的第一个 FROM 中。

如果您的文本搜索是可预测的（不是来自用户输入）并且与单个已知 ID 相关，请使用 ID 而不是文本搜索（Patricia 用于发现 LIKE 瓶颈的道具）。

由于缺少表提示，您的查询很难阅读，但您的字段名称似乎确实存在模式。

您需要`nMmbGndrID`并`nMmbAge`有一个值，但这些可能在 MEMBERS 中，即 5 个左连接。那是冗余。

请记住，您可以像这样进行简单的连接：

`FROM sspk.villages, gps, TALUKS, dists, HHINFO, MEMBERS [...] WHERE [...] nVlgGpID = nGpID AND nGpTlkID = nTlkID AND nTlkDistID = nDistID AND nHLstGpID = nGpID AND nHLstID = nMmbHhiID`

看起来`cSttsDesc`来自`STATUS`. 但是，如果文本与其中的`'No, Eligible'`一个 nBStsSttsID 完全匹配，`BNFTSTTS`则找出该值并使用它！如果是 7，取出`LEFT JOIN STATUS ON nBStsSttsID = nSttsID`并替换`AND cSttsDesc like 'No, Eligible'` 为`AND nBStsSttsID = '7'`。这将大大提高速度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-21T13:31:25.547

如果连接中使用的表最少用于更新查询，那么您可以将引擎类型从 INNODB 更改为 MyISAM。

MyISAM 中的 Select 查询运行速度比 INNODB 快 2 倍，但 MyISAM 中的更新和插入查询要慢得多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-21T13:26:29.417

尝试向 nMmbGndrID、nMmbAge 和 cSttsDesc 添加索引，看看这是否有助于您的查询。

此外，您可以在您的 select 语句之前使用“解释”命令，为您提供一些关于您可以做得更好的提示。有关说明的更多详细信息，请参阅[MySQL 参考](http://dev.mysql.com/doc/refman/5.5/en/explain.html)。

# neo4j - 1.9.M01 上的 Neo4j HA 复制问题

> ID：13494239
> 
> 赞同：1
> 
> 时间：2012-11-21T13:21:52.890
> 
> 标签：neo4j

我在 Spring MVC 应用程序中使用 Neo4j 1.9.M01，该应用程序公开了一些特定于域的 REST 服务（读取、更新）。Web 应用程序在同一个 Web 容器（Tomcat 6）中部署了三次，每个“节点”都有自己的嵌入式 Neo4j HA 实例部分，属于同一个集群。

**三个 Neo4j 配置：**

```
#node 1
ha.server_id=1
ha.server=localhost:6361
ha.cluster_server=localhost:5001
ha.initial_hosts=localhost:5001,localhost:5002,localhost:5003

#node 2
ha.server_id=2
ha.server=localhost:6362
ha.cluster_server=localhost:5002
ha.initial_hosts=localhost:5001,localhost:5002,localhost:5003

#node 3
ha.server_id=3
ha.server=localhost:6363
ha.cluster_server=localhost:5003
ha.initial_hosts=localhost:5001,localhost:5002,localhost:5003 
```

**问题：**在其中一个节点上执行更新时，更改仅复制到另一个节点，第三个节点保持旧状态，破坏了集群的一致性。

我正在使用里程碑，因为它不允许在 web 容器之外运行任何东西，所以我不能依赖 1.9 之前版本中基于旧 ZooKeeper 的协调。我是否在这里遗漏了一些配置，或者这可能是 1.9 中引入的新协调机制的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T09:32:17.497

此行为（仅复制到一个其他实例）与 1.8 中的默认值相同。这是由以下控制的：

```
ha.tx_push_factor=1

```

这是默认设置。

从站通过几种方式从主站获取更新：

*   通过配置更高的推送因子，例如：

```
   ha.tx_push_factor=2

```

（而是在每个实例上，因为正在使用的实例是当前主实例上的实例）。

*   通过配置从属服务器的拉取间隔以从其主服务器获取更新，例如：

```
   ha.pull_interval=1s

```

*   通过使用 Java API 手动拉取更新

*   通过从从站发出写事务

请参阅[http://docs.neo4j.org/chunked/milestone/ha-configuration.html](http://docs.neo4j.org/chunked/milestone/ha-configuration.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T20:30:28.840

第一个猜测是设置

```
ha.discovery.enabled = false 
```

有关说明，请参见[http://docs.neo4j.org/chunked/milestone/ha-configuration.html#_different_methods_for_participating_in_a_cluster](http://docs.neo4j.org/chunked/milestone/ha-configuration.html#_different_methods_for_participating_in_a_cluster)。

请您提供`data/graph.db/messages.log`所有三个集群成员的完整分析。

旁注：也应该可以使用 1.8 来满足您的要求。您也可以直接从 tomcat 生成 zookeeper，只需模仿它的作用：在 Web 应用程序启动时在单独的线程中`bin/neo4j-coordinator`运行类。[`org.apache.zookeeper.server.quorum.QuorumPeerMain`](http://zookeeper.apache.org/doc/r3.4.5/api/org/apache/zookeeper/server/quorum/QuorumPeerMain.html)

# java - 将 c:out 标签与 bean:message 结合起来

> ID：13494242
> 
> 赞同：2
> 
> 时间：2012-11-21T13:21:58.410
> 
> 标签：java, jsp, jstl, el

假设我有一个包含动态标签的变量，我该如何实现这样的事情（导航是请求范围属性）：

```
<fmt:message  var='<c:out value="${navigation}"/>'/> 
```

或者

```
<bean:message  var='<c:out value="${navigation}"/>'/> 
```

实际上直到现在都是这样处理的：

```
<%
    String navigation = (String)request.getAttribute("navigation");
%>

<bean:message  var='navigation'/> 
```

但是这种做事方式在十年前还是不错的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:36:47.290

就像是：

```
<c:set var="temp"><c:out value="${navigation}"/></c:set>
<fmt:message var='${temp}'/> 
```

您确定要使用`var=`而不是`key=`使用该`var=`属性将消息的值放在名为该值的变量中，并且不会将其输出到响应中。

```
<c:set var="temp">something-complex-<c:out value="${navigation}"/></c:set>
<fmt:message key='${temp}'/> 
```

注意这也可以写成：

```
<fmt:message key='something-complex-${navigation}'/> 
```

# .net - 如何避免评估所有“iif”表达式？

> ID：13494245
> 
> 赞同：2
> 
> 时间：2012-11-21T13:22:06.200
> 
> 标签：.net, vb.net, casting, lazy-evaluation, iif

是 VB.NET 2005，有没有办法在不`invalid cast exception`尝试将空字符串转换为整数的情况下执行以下操作？

```
Dim strInput As String = String.Empty
Dim intResult As Integer = IIf(IsNumeric(strInput), CInt(strInput), 100) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T13:26:16.983

VB.NET 现在有了真正的三元运算符（2008 年后）

```
Dim intResult = If(IsNumeric(strInput), CInt(strInput), 100) 
```

这与 IIF 不同，因为它使用短路评估。
如果测试表达式的计算结果为真，则 FalsePart 将被忽略，反之亦然

正如 Marek Kembrowsky 先生在其评论中所说，IIF 是一个函数，其参数在传入之前都经过评估，而 IF（作为三元运算符）是 VB 编译器的附加功能。

但是，当我在 VB.NET 中编程时，我不喜欢使用 Microsoft.VisualBasic 兼容命名空间提供的快捷方式。该框架提供了更好的解决方案，例如 TryParse 方法集。如果输入字符串超过 Integer.MaxValue，您的示例将失败。

更好的方法可能是

```
Dim d As decimal
if Not Decimal.TryParse(strInput, d)  then d = 100 
```

或者，如果你有一个浮点数`string`（？好吧好吧，你明白我的意思）

```
Dim d As Double
if Not Double.TryParse(strInput, d)  then d = 100 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:39:27.103

*If*解决方案将起作用......但 IsNumeric() 不是正确的检查。如果 strInput 是一个数字但超过 integer.maxvalue 怎么办？改用 TryParse 更好。

```
Dim i As Integer
If Not Integer.TryParse("1234567890", i) Then i = 100 
```

或者

```
Dim j As Integer = If(Integer.TryParse("123456789", Nothing), Integer.Parse("123456789"), 100) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:44:56.847

解决这个问题的一种方法是：

```
Dim strInput As String = String.Empty
Dim intResult As Integer = IIf(IsNumeric(strInput), strInput, 100) 
```

这样，强制转换是隐式完成的，不会出现任何无效的强制转换异常。

# apache - 如何在.htaccess 中重定向？=> /whatever 到 /fr/whatever

> ID：13494246
> 
> 赞同：1
> 
> 时间：2012-11-21T13:22:09.207
> 
> 标签：apache, .htaccess, mod-rewrite, redirect

我有我的网站 www.site.com

首先，我想始终拥有 /fr/

我写了这个：

```
RewriteRule ^fr$ index.php?lang=fr [L] 
```

现在我希望每个链接都需要 /fr/ 例如 www.site.com/fr/articleid 有效，但我希望将 www.site.com/articleid 重定向到 www.site.com/fr/articleid。

总而言之，我想做：

```
www.site.com => www.site.com/fr/

www.site.com/mypage => www.site.com/fr/mypage

www.site.com/whatever => www.site.com/fr/whatever 

www.site.com/fr/whatever => Nothing, it's good :) 
```

示例：如果您访问[http://www.deezer.com/blablabla](http://www.deezer.com/blablabla)，您将自动重定向到[http://www.deezer.com/fr/blablabla](http://www.deezer.com/fr/blablabla)（然后是 404 表示 blablabla）谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-21T13:26:45.330

例如

`RewriteRule ^en/ - [L]`

这将节省递归重写

`RewriteRule ^(.*)$ /en/$1?%{QUERY_STRING} [L]`

此示例将重写所有 url

# sql - 如何获得第二好的价值

> ID：13494261
> 
> 赞同：3
> 
> 时间：2012-11-21T13:23:02.060
> 
> 标签：sql, ms-access

假设我们有两个表：

```
Players(player_id int)
GameScores(player_id int, session_id int, score int) 
```

我们如何查询每个玩家得分第二高的会话？

例如，如果

```
Players
1
2

GameScores
(player_id, session_id, score)
1 1 10
1 2 20 
1 3 40
2 4 10
2 5 20

Then result would be
(player_id, session_id)
1, 2
2, 4 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T13:36:07.947

你能试试这个

```
 SELECT GameScores.player_id, GameScores.session_id 
     FROM (
        SELECT player_id,MAX(score) as SecondScore
        FROM GameScores g
        WHERE score < (SELECT Max(Score) FROM gameScore where gameScore.player_id = g.player_id)
        GROUP BY player_id 
        ) x
        INNER JOIN GameScores ON x.player_id = gamescore.player_id 
          AND x.SecondScore = gamescore.score 
```

* * *

这是为每个玩家选择第二个高分的查询

```
SELECT player_id,MAX(score) as SecondScore
            FROM GameScores g
            WHERE score < (SELECT Max(Score) FROM gameScore where gameScore.player_id = g.player_id)
            GROUP BY player_id 
```

您不能在此查询中按会话分组。所以这就是为什么你需要把它放在一个子查询中并加入它`gamescore`以获得`session_id`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T13:43:08.740

这是 Oracle sql 的代码片段

```
select tbl.player_id,tbl.session_id from
(select p.player_id,g.session_id,g.score,rank()  over (partition by p.player_id order by score desc) rnk   from players p,
gamescores g 
where p.player_id = g.player_id) tbl
where tbl.rnk = 2; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:53:01.593

```
select player_id, first(session_id) as session_id
from 
   GameScores inner join (
   select player_id, max(score) as secondscore
   from 
      GameScores left join (
      select player_id, max(score) as firstscore
      from GameScores
      group by player_id
   ) as NotThisOnes on GameScores.player_id = NotThisOnes.player_id
                   and GameScores.score = NotThisOnes.firstscore
   where NotThisOnes.player_id is null
   group by player_id
) as thisare on GameScores.player_id = thisare.player_id
            and GameScores.score     = thisare.secondscore
group by player_id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T15:09:49.557

我采取了不同的方法......我不确定这是否比其他答案更好，但我想以这种方式解决它：

```
SELECT
  GameScores.player_id,
  GameScores.session_id,
  GameScores.score
FROM
  GameScores
WHERE
  GameScores.score=
    (select max(score) from GameScores GameScores_2
     where GameScores.player_id = GameScores_2.Player_ID
     and GameScores_2.Score<
       (select max(score) from GameScores GameScores_1
        where GameScores_1.player_id = GameScores.player_id)); 
```

# silverlight - CRM 上下文是否允许以非嵌套方式构建代码？

> ID：13494262
> 
> 赞同：1
> 
> 时间：2012-11-21T13:23:04.150
> 
> 标签：silverlight, asynchronous, dynamics-crm-2011

我正在构建一个旨在集成到表单中的 Silverlight Web 资源，它需要了解以下所有信息：

*   当前用户的id
*   当前用户所属团队的id
*   当前用户的安全角色 id

我正在以一种早期绑定的方式工作，向 OData 端点 ( `http://server/org/XRMservices/2011/OrganizationData.svc`) 添加了一个服务引用，这反过来为我提供了上下文（让我们命名它`cmtestcontext`，这是它在代码中的实际名称）。

我通过这个类访问数据（我没有创建它，我前段时间只是从网上搜索到它：这是一个精简的、保持简短的版本）

```
public class QueryInterface
{    
    //NOTE: ServiceReference1 is the name of the OData service reference
    //Add Service Reference -> point to CRM OData url
    public ServiceReference1.cmtextcontext CrmContext;
    public QueryInterface()
    {
        var crmServerUrl = (string)GetContext().Invoke("getServerUrl");
        if (crmServerUrl.EndsWith("/")) crmServerUrl = crmServerUrl.Substring(0, crmServerUrl.Length - 1);
        Uri ODataUri = new Uri(crmServerUrl + "/xrmservices/2011/organizationdata.svc/", UriKind.Absolute);
        CrmContext = new cmtestContext(ODataUri) { IgnoreMissingProperties = true };
    }   
} 
```

该类允许我在一行中进行排序，如下所示（实际代码片段包含在一个虚拟方法中以使其可复制粘贴）：

```
void RetrieveAllInformationFromCRM()
{
    QueryInterface qi = new QueryInterface();
    List<Guid> allData = new List<Guid>();

    //NOTE: STEP 1 - USER ID
    //NOTE: Since this is a web resource, I can cheat and use Xrm.Page.context.getUserId()
    //NOTE: Remove the extra '{}' from the result for it to be parsed!
    allData.Add(new Guid(qi.GetContext().Invoke("getUserId").ToString().Substring(1,36)));

    //NOTE: STEP 2a - TEAM MEMBERSHIP FOR USER
    //NOTE: TeamMembership entity links users to teams in a N:N relationship
    qi.crmContext.TeamMembershipSet.BeginExecute(new AsyncCallback((result) =>
    {
        var teamMemberships = qi.crmContext.TeamMembershipSet.EndExecute(result)
                              .Where(tm => tm.TeamId.HasValue && (tm.SystemUserId ?? Guid.Empty) == userId)
                              .Select(tm => tm.TeamId.Value);

        //NOTE: STEP 2b - TEAMS RELATED TO TEAMMEMBERSHIPS
        qi.crmContext.TeamSet.BeginExecute(new AsyncCallback((result2) =>
        {
            var teamDetails = qi.crmContext.TeamSet.EndExecute(result2)
                              .Where(t => teamMemberships.Contains(t.TeamId));

            foreach (var team in teamDetails) 
                allData.Add(team.TeamId);

            //NOTE: FINAL STEP - allData is filled and ready to be used.

        }), null);
    }), null);
} 
```

在上面的代码中，my`FINAL STEP`拾取`allData`并处理它，然后流程继续进行。我担心的是，如果/当我需要修改这个“阅读器”方法时，我将不得不剪切并粘贴“最终”代码，以确保它被放置在所有阅读之后。如果我可以让阅读彼此跟随，我会更喜欢它，所以我可以这样做：

```
void MyReaderMethod()
{
     ReadEverything();
     ProcessData();
} 
```

基本上，您可以等待请求完成吗？挂起 UI 不是问题，我只需将代码`BackgroundWorker`与“请稍候”飞溅一起包装。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T15:47:26.723

最好的（IMO）是将异步方法调用（Silverlight 的要求）转换为基于任务的调用。通过任务，您可以轻松地将查询与结果操作分开。

然后使用 Async BCL（[通过 nuget](https://www.nuget.org/packages/Microsoft.Bcl.Async)），您可以使用 async/await（如果您不使用 VS2012，那么 Tasks 仍然可以更好地使用，您只需要使用延续）

此示例用于后期绑定，但您可以根据需要对其进行修改

```
 public Task<OrganizationResponse> ExecuteAsync(OrganizationRequest request)
        {
            return Task.Factory.FromAsync<OrganizationResponse>(
                (callback, state) => Begin(() => service.BeginExecute(request, callback, state)),
                   service.EndExecute,
                    null);
        } 
```

然后你可以像这样使用它

```
 async void MyReaderMethod()
    {
         //TODO:wrap in try/catch
         var result = await ExecuteAsync( ... );
         ProcessData(result);
    } 
```

或者对于 VS 2010

```
 void MyReaderMethod()
        {
            ExecuteAsync( ... ).ContinueWith(task =>{

               //TODO: Error handling
               ProcessData(task.Result);

               });

        } 
```

# android - 使用 android root 应用程序更改系统设置

> ID：13494263
> 
> 赞同：1
> 
> 时间：2012-11-21T13:23:05.677
> 
> 标签：android, settings, root

在根应用程序中更改亮度、gps、数据等受保护系统设置的最佳（最安全）方法是什么？

我读到了两种方法：

1）将 settings.db 复制到您的应用程序文件夹中，使用 sql api 对其进行操作，然后将其复制回来 - 对我来说似乎不仅仅是有点冒险。 [看这里](https://stackoverflow.com/questions/7392067/android-changing-the-system-settings-of-a-rooted-device-from-inside-the-app)

2) 使用 root 将您的应用程序复制到系统文件夹并持有 WIRTE_SECURE_SETTINGS 权限 - 似乎可行，但这是否会破坏市场链接，因此用户将不再收到更新？[看这里](https://stackoverflow.com/questions/11908599/write-secure-settings-root)

还是有不同的方法？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T20:44:47.883

`/system/app`您可以使用 root 身份执行“修改”命令，而不是将您的应用程序移至，可以在[此处](http://su.chainfire.eu/#how)`su`
找到 如何使用`Runtime.exec()`（以及一种实现）执行此操作的说明。

# nhibernate - NHibernate，获取实体和急切加载子集合的一部分

> ID：13494270
> 
> 赞同：0
> 
> 时间：2012-11-21T13:23:37.477
> 
> 标签：nhibernate, eager-loading

我不知道如何做到这一点：

我有一个国家实体。一个国家有零个或多个事实。一个事实具有名为 Year 的属性。

如何按名称加载 Country 实体并急切地获取给定年份（例如 2011 年）的所有事实（但不加载所有其他事实）？这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T15:32:20.020

我认为使用过滤可以做到这一点，但这不是一个好主意，因为它违反了关注点分离：您的域模型不应该用于呈现数据的特殊视图。

两个可能更好的选择：

1.  使用扩展方法获取所有事实并按年份过滤它们`IEnumerable<Fact>`。除非我有可衡量的性能问题，否则我会选择此选项。
2.  创建一个封装结果集的视图类。您可以构建两个查询来检索一年的 Country 和 Facts `Future`，这样它只需要访问数据库一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:37:19.160

我相信这可以通过在 nHibernate 中使用过滤器来实现。从阅读之前的 StackOverflow 问题开始：

[NHibernate - 检索仅适用于儿童的标准的父母/儿童](https://stackoverflow.com/questions/4016767/nhibernate-retrieve-parent-children-with-criteria-applied-only-to-children)

并查看 nHibernate 文档以获取更多参考：

[http://nhibernate.info/doc/nh/en/index.html#filters](http://nhibernate.info/doc/nh/en/index.html#filters)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T15:30:08.043

**更新：** 我还*没有*解决这个问题。以下 HQL 仅在存在事实时才有效。如果给定年份没有事实，则结果为空。根据我的上下文，我认为正确的解决方案是将 Fact 视为聚合根并使用 Future() 发出两个查询。

**原帖**

我已经使用 HQL 解决了这个问题：

```
var country = Session.CreateQuery("from Country country left join fetch country.Facts as Facts where Facts.Year in (:years) and country.Name = :name ");
country.SetParameter("name", name);
country.SetParameterList("years", new List<int>() {2012, 2011}); 
```

感谢其他建议。我会对这个问题的非 HQL 解决方案感兴趣，但这很好地解决了它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T13:58:24.873

**编辑：**

```
 var query = session.QueryOver<Country>()
        .Fetch(c => c.Facts)
        .Eager()
        .TransformUsing(NHibernate.Transform.Transformers.DistinctRootEntity)
        .Future();
    session.QueryOver<Facts>()
        .Where(f => f.Year == 2011)
        .Future();
    var country = query.List().FirstOrDefault(); 
```

# ruby-on-rails - Rails 调试 - 过早退出控制器

> ID：13494273
> 
> 赞同：0
> 
> 时间：2012-11-21T13:23:44.310
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我想知道如何在 Rails 中退出控制器并获得该点的输出。

在 PHP 中，我经常在调试时使用“退出”来仅获取处理到该点的数据。我还没有在rails中找到解决方案。

如果您在代码中进一步出现错误，则视图将被锁定，无法显示 <%= debug %> 信息。

有些人会建议安慰或救援，我知道这些。但是没有更简单的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:49:58.823

在开发模式下，我经常只是使用`puts`或`awesome_print`在我运行的屏幕上打印一些东西`rails server`。这对于简单的情况非常有效。

对于比这更复杂的事情，我使用 ruby​​-debug 或 pry 在它到达正确位置时下拉到交互式控制台。

我有一些编辑器快捷方式来打印这两个片段之一：

```
require 'pry'; binding.pry
require 'ruby-debug'; debugger 
```

将这些放在您的代码中，您可以使用 IRB 来检查（和操作）程序的状态。

我强烈建议你试一试。在这里查看：

[http://pryrepl.org/](http://pryrepl.org/)

[http://railscasts.com/episodes/280-pry-with-rails](http://railscasts.com/episodes/280-pry-with-rails)

还有较旧的 ruby​​-debug：

[http://railscasts.com/episodes/54-debugging-with-ruby-debug](http://railscasts.com/episodes/54-debugging-with-ruby-debug)

# javascript - 条件表单验证

> ID：13494274
> 
> 赞同：0
> 
> 时间：2012-11-21T13:23:54.570
> 
> 标签：javascript, html, validation

我有一个包含 3 组问题的 HTML 表单，用户可以回答是或否，如下所示：

A1 A2 A3 A4 A5

或者

B1 B2 B3

或者

C1 C2 C3 C4 C5 C6

用户可以选择回答所有“A”问题、所有“B”问题或所有“C”问题，但他们不能回答多个组。同样对于他们选择回答的任何组，他们必须回答同一组中的所有问题（即所有“A”或所有“B”或所有“C”问题 - 他们不能留下未回答的问题）。

这是表单的 HTML：

```
 <form method="post" action="process.php" id='editRecord'>

              <table border="1" class="record">
              <tr>
              <td width="88%" valign="top" class="field_name_left">A1</td>
              <td width="12%" valign="top" class="field_data">         
                            <input type="radio" name="CriteriaA1" value="Yes">Yes<input type="radio" name="CriteriaA1" value="No">No</td>
              </tr>
              <tr>
              <td width="88%" valign="top" class="field_name_left">A2</td>
              <td valign="top" class="field_data">
                            <input type="radio" name="CriteriaA2" value="Yes">Yes<input type="radio" name="CriteriaA2" value="No">No</td>
              </tr>
              <tr>
              <td width="88%" valign="top" class="field_name_left">A3</td>
              <td valign="top" class="field_data">                       <input type="radio" name="CriteriaA3" value="Yes">Yes<input type="radio" name="CriteriaA3" value="No">No</td>
              </tr>
              <tr>
              <td width="88%" valign="top" class="field_name_left">A4</td>
              <td valign="top" class="field_data">
                           <input type="radio" name="CriteriaA4" value="Yes">Yes<input type="radio" name="CriteriaA4" value="No">No</td>
              </tr>
              <tr>
              <td width="88%" valign="top" class="field_name_left">A5</td>
              <td valign="top" class="field_data">
                           <input type="radio" name="CriteriaA5" value="Yes">Yes<input type="radio" name="CriteriaA5" value="No">No</td>
              </tr>
              <tr>
                <td valign="top" class="field_name_left" colspan="2">&nbsp;</td>
              </tr>
              <tr>
                <td valign="top" class="field_name_left" colspan="2"><strong>OR</strong></td>
              </tr>
              <tr>
                <td valign="top" class="field_name_left" colspan="2">&nbsp;</td>
              </tr>
              <tr>
                <td valign="top" class="field_name_left">B1</td>
                <td valign="top" class="field_data">
                             <input type="radio" name="CriteriaB1" value="Yes">Yes<input type="radio" name="CriteriaB1" value="No">No</td>
              </tr>
              <tr>
                <td valign="top" class="field_name_left">B2</td>
                <td valign="top" class="field_data">
                             <input type="radio" name="CriteriaB2" value="Yes">Yes<input type="radio" name="CriteriaB2" value="No">No</td>
              </tr>
              <tr>
                <td valign="top" class="field_name_left">B3</td>
                <td valign="top" class="field_data">
                             <input type="radio" name="CriteriaB3" value="Yes">Yes<input type="radio" name="CriteriaB3" value="No">No</td>
            </tr>
            <tr>
                <td valign="top" class="field_name_left" colspan="2">&nbsp;</td>
              </tr>
              <tr>
                <td valign="top" class="field_name_left" colspan="2"><strong>OR</strong></td>
              </tr>
              <tr>
                <td valign="top" class="field_name_left" colspan="2">&nbsp;</td>
              </tr>
              <tr>
              <td width="88%" valign="top" class="field_name_left">C1</td>
              <td width="12%" valign="top" class="field_data">         
                            <input type="radio" name="CriteriaC1" value="Yes">Yes<input type="radio" name="CriteriaC1" value="No">No</td>
              </tr>
              <tr>
              <td width="88%" valign="top" class="field_name_left">C2</td>
              <td valign="top" class="field_data">
                            <input type="radio" name="CriteriaC2" value="Yes">Yes<input type="radio" name="CriteriaC2" value="No">No</td>
              </tr>
              <tr>
              <td width="88%" valign="top" class="field_name_left">C3</td>
              <td valign="top" class="field_data">
                           <input type="radio" name="CriteriaC3" value="Yes">Yes<input type="radio" name="CriteriaC3" value="No">No</td>
              </tr>
              <tr>
              <td width="88%" valign="top" class="field_name_left">C4</td>
              <td valign="top" class="field_data">
                           <input type="radio" name="CriteriaC4" value="Yes">Yes<input type="radio" name="CriteriaC4" value="No">No</td>
              </tr>
              <tr>
              <td width="88%" valign="top" class="field_name_left">C5</td>
              <td valign="top" class="field_data">
                           <input type="radio" name="CriteriaC5" value="Yes">Yes<input type="radio" name="CriteriaC5" value="No">No</td>
              </tr>
              <tr>
              <td width="88%" valign="top" class="field_name_left">C6</td>
              <td valign="top" class="field_data">
                           <input type="radio" name="CriteriaC6" value="Yes">Yes<input type="radio" name="CriteriaC6" value="No">No</td>
              </tr>

              <tr class="submit_btn">
                <td colspan="3">&nbsp;</td>
                </tr>
              <tr class="submit_btn">
                <td colspan="3">
                    <div id="buttons" >
                        <input type="submit" name="-edit" value="Continue">
                        <input type="reset" name="reset" value="Reset">  
                    </div>              
                    <div id="error"></div>            </td>
             </tr>
        </table>
    </form>​ 
```

我还在以下位置设置了一个 jsFiddle：

[http://jsfiddle.net/fmdataweb/pEETU/2/](http://jsfiddle.net/fmdataweb/pEETU/2/)

我想添加一些客户端验证，以检查用户何时单击“继续”按钮，他们确实回答了一组中的所有问题并且没有回答另一组的任何问题。

我之前在表单只有 A 或 B 选项时进行了此验证 - 表单现在有 C 选项，我需要更新 Javascript，但到目前为止我尝试的一切都失败了。

这是适用于原始 A 和 B 选项的 Javascript：

```
 $(function() {

        $("#editRecord").submit(function(){

        // is anything checked?
        if(!checkEmpty()){
            $("#error").html("Please check something before submitting");
            //alert("nothing Checked");
            return false;
        }
        // Only A _OR_ B
        if(isAorB()){
            $("#error").html("Please complete A or B, not both");
            //alert("please complete A or B, not both");
            return false;
        };
        // all A's or all B's
        if(allAorBChecked()){
            $("#error").html("It appears you have not completed all questions");
            //alert("missing data");
            return false;
        };
        if(haveNo()){
            // we're going on, but sending "type = C"
        }
        //alert("all OK");
            return true;
        });
    });

function checkEmpty(){
    var OK = false;
    $(":radio").each(function(){
        if (this.checked){
            OK = true;
        }
    });
    return OK;
}
 function isAorB(){
    var OK = false;
    var Achecked = false;
    var Bchecked = false;
    $(":radio").each(function(){
        var theChar=this.name.charAt(8);
        // if we have an A checked remember it
         if(theChar == "A" && this.checked && !Achecked){
            Achecked = true;    
        }
        if(Achecked && theChar == "B" && !Bchecked){
            if(this.checked){
                Bchecked = true;
            }
        }
        if (Achecked && Bchecked){
            OK = true;
        }
    });
    return OK;
} 
function allAorBChecked(){
    var notOK = false;
    var Achecked = false;
    $(":radio").each(function(){
        // skip through to see if we're doing A's or B's
    var theChar=this.name.charAt(8);
        // check the A's
     if(theChar == "A" && this.checked && !Achecked){
            Achecked = true;    
        }

    });
    if(Achecked){
        // set the input to A
        $("#type").val("A");
        // check _all_ a's are checked
        var thisName;
        var thisChecked = false;

        $(":radio").each(function(){
            var theChar=this.name.charAt(8);
            var checked = this.checked;
            if (theChar == "A"){
            if (this.name == thisName && !thisChecked){
                // Yes wasn't checked - is No?
                if(!checked){
                    notOK = true;
                }
            }
            thisChecked = checked;
            thisName = this.name;
        }
    });
    }else{
        // set the input to B
        $("#type").val("B");            
        // check _all_ b's are checked
            var thisName;
            var thisChecked = false;
            $(":radio").each(function(){
                var theChar=this.name.charAt(8);
                var checked = this.checked;
                if (theChar == "B"){
                if (this.name == thisName && !thisChecked){
                    // A wasn't checked - is B?
                    if(!checked){
                        notOK = true;
                    }
                }
                thisChecked = checked;
                thisName = this.name;
            }
        });
    }
    return notOK;
}    
function haveNo(){
    var thisName;
    var notOK = false;
        $(":radio").each(function(){
            var checked = this.checked;
            if (this.name == thisName){
                //Is this checked 
                if(checked){
                    notOK = true;
                    $("#type").val("C");            
                }

        }
        thisName = this.name;
    });

    return notOK;
} 
```

​</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:14:49.693

使用最优秀的 jQuery 验证插件[http://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)，您可以使用“depends”使字段仅在满足其他条件时才需要。

为了确保只填写一组字段，您可以在单击后使其他字段不可见（并以编程方式清空任何值）。我看到的问题是当有人开始单击单选按钮然后决定他们要填写 b 数据时......他们将如何删除 A 中的所有单选按钮？

# java - 如何远程访问apache sling？

> ID：13494284
> 
> 赞同：0
> 
> 时间：2012-11-21T13:24:21.387
> 
> 标签：java, jackrabbit, jcr, sling

我正在开发一个 Sling WCMS。我需要在服务器计算机上设置 Sling repo 并远程访问。

如何远程访问 sling repo？有特殊配置吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T08:49:09.503

Sling 使用 Apache Jackrabbit 作为其 JCR 内容存储库，您可以配置 Jackrabbit 存储库以进行远程 davex 或 RMI 访问。

为此，我认为您必须根据 Jackrabbit 的文档提供自定义的 repository.xml 文件。

但是，推荐的方法是通过 Sling 的 RESTful 接口访问内容，请参阅[http://sling.apache.org/site/discover-sling-in-15-minutes.html](http://sling.apache.org/site/discover-sling-in-15-minutes.html)以快速了解其工作原理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T16:19:13.603

正如前面的答案所指出的，Sling 通过 REST 接口公开存储库中的所有内容。这可能是访问数据的最简单方法。

但是，如果您正在寻找更多的直接集成，您可以通过 RMI 或 DAV 连接到 Sling 存储库。在您的客户端应用程序中，您可以使用它`org.apache.jackrabbit.commons.JcrUtils.getRepository()`来获取 JCR 存储库对象。这提供了与外部应用程序可以获得的 Sling 最紧密的集成，但速度不是很快。根据您与服务器的网络连接，它可能无法使用。

这是一个简单的示例，您必须根据需要调整 URL 并将必要的依赖项添加到类路径中：

```
Repository repository = JcrUtils.getRepository("http://localhost:4502/crx/server");
Session session = repository.login(new SimpleCredentials("user", "password"))
// Use session... 
```

也看看[http://wiki.apache.org/jackrabbit/RemoteAccess](http://wiki.apache.org/jackrabbit/RemoteAccess)

# sql - 来自常量字符串列表的带有 INNER JOIN 的 SQL INSERT

> ID：13494289
> 
> 赞同：3
> 
> 时间：2012-11-21T13:24:32.073
> 
> 标签：sql, sql-server

我想创建一个 SQL Server 2012 查询，它将权限名称的常量列表（例如“ViewUsersPermission”、“ModifyUsersPermission”）插入到表 RolePermissions 中。

该表有两列：“RoleID”是 Roles 表的外键，以及 varchar 列“PermissionTypeName”。

```
INSERT INTO [dbo].[RolePermissions] ([PermissionTypeName], [RoleID])

   SELECT 'ViewUsersPermission' AS [PermissionTypeName]
   UNION ALL
   SELECT 'ModifyUsersPermission' AS [PermissionTypeName]
   UNION ALL
   SELECT 'ViewRolesPermission' AS [PermissionTypeName]

   INNER JOIN   (SELECT [RoleID] FROM [dbo].[Roles]
                WHERE [Name] = 'Administrator') 
```

我正在寻找更好的解决方案。我想指定权限类型列表，例如：

```
SELECT FROM 'ViewUsersPermission', 'ModifyUsersPermission', 'ViewRolesPermission' 
```

而不是使用`UNION ALL`构造。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T13:26:30.560

假设您至少在 2008 年

```
SELECT RoleName
FROM   (VALUES('ViewUsersPermission'),
              ('ModifyUsersPermission'),
              ('ViewRolesPermission')) V(RoleName) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T13:37:01.127

根据 Martin 的帮助，完整的 SQL INSERT 语句如下所示：

```
INSERT INTO [dbo].[RolePermissions] ([PermissionTypeName], [RoleID])
    SELECT [PermissionTypeName], [RoleID] FROM (VALUES('ViewUsersPermission'),             
        ('ModifyUsersPermission'), ('ViewRolesPermission')) V([PermissionTypeName])
    INNER JOIN [dbo].[Roles] AS [Role]
        ON [Role].[Name] = 'Administrator' 
```

# ms-access-2007 - 在具有 2 个子表单的表单中进行 Dlookup（对 dlookup 的要求在第二个子表单中）

> ID：13494290
> 
> 赞同：1
> 
> 时间：2012-11-21T13:24:35.207
> 
> 标签：ms-access-2007

访问 2007

```
Form Name is: MineLocationQuery1
1st Subform name is:MineExtractionSubform
2nd Subform name is: ExtractionLineSubform2 
```

我正在尝试使用 dlookup 来检查表中的值，然后将其乘以另一个值。它适用于：NO Subform 和 1 Subform。但是当我添加 2 个子表单时，我无法让它工作。

这是我到目前为止尝试过的

有效的简单表单查找：

```
=DLookUp("[Price]","[Resource]","[AtomicRef]='" & [Forms]![ExtractionLine]![AtomicRef] & "'")*[Tonnage] 
```

这是使用 1 个子表单创建的表单的工作示例：

```
=DLookUp("[Price]","[Resource]","[AtomicRef]='" & [Forms]![MineExtraction1]![ExtractionLineSubform]![AtomicRef] & "'")*[Tonnage] 
```

这是我对 2 个子表单进行的许多尝试中的 1 个，但它不起作用。

```
=DLookUp("[Price]","[Resource]","[AtomicRef]='" & Forms![MineLocationQuery1]!MineExtractionSubform.Form!ExtractionLineSubform2.Form.AtomicRef & "'")*[Tonnage] 
```

除了在将许多尝试复制并粘贴到价值文本框控件源中并反复出现#Name错误之外，我做错了什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:52:38.147

如果我想在主表单的文本框中引用嵌套子表单，我可能会说：

```
=[SubformControl1].[Form].[SubformControl2].[Form].[AControlName] 
```

Note that this uses the name of the subform control and Form as a reference to the object contained by the control.

So this (split for ease of reading) looks right:

```
=DLookUp("[Price]","[Resource]","[AtomicRef]='" & Forms![MineLocationQuery1]!
MineExtractionSubform.Form!ExtractionLineSubform2.
Form.AtomicRef & "'")*[Tonnage] 
```

However, it is very easy to get names wrong. For example, you may be referring to the form contained, rather than the subform control name. You can use the Expression Builder to troubleshoot, or you can refer to the form bit by bit in the immediate window (Ctrl+G) to ensure you have the names right. For example:

```
?Forms![MineLocationQuery1].Name
?Forms![MineLocationQuery1]!MineExtractionSubform.Name 
```

More information: [http://access.mvps.org/access/forms/frm0031.htm](http://access.mvps.org/access/forms/frm0031.htm)

EDIT re comments

If you work in subform 2, as I believe you should in this case, you can simply refer to [atomicref]:

```
=DLookUp("[Price]","[Resource]","[AtomicRef]='" & [atomicref] & "'") 
```

# c# - 如果我有鼠标悬停，我如何获得 div 不透明度效果

> ID：13494294
> 
> 赞同：0
> 
> 时间：2012-11-21T13:24:50.713
> 
> 标签：c#, asp.net, css, html, mouseover

我有一个 ASP.NET 应用程序，我想要一个带有 div 的效果。如果我将鼠标悬停在 div 上，则希望此不透明度为 0.9，如果我将鼠标悬停，则希望不透明度为 0.6。我使用两个 div。一个 div 在另一个 div 中，在此我使用控件。

如果我的鼠标不在 div 中：

![在此处输入图像描述](../Images/fa4955a48e03eb80e7fe64f1a720ad12.png)

如果我的鼠标在 div 中：

![在此处输入图像描述](../Images/c11d9e4407332df7354f445360982683.png)

我的代码：

```
<asp:Content ID="Content2" ContentPlaceHolderID="lw_content" runat="server">
    <div class="createuser">

        <div class="create_box">
            <div class="newUser">

        Benutzer Anlegen <br/>
        <br/>
        <table>
            ...
        </table>

        <br/>
        <asp:Button ID="btnAnlegen" runat="server" Text="Benutzer anlegen" 
                    onclick="btnAnlegen_Click" />

             </div>
        </div>

    </div>

</asp:Content> 
```

我的 CSS：

```
div.createuser {

    background-image: url(../images/bg_createuser.jpg);

    filter:alpha(opacity=50);
    width: 1000px;
    height: 450px;
    z-index: n;
}

div.create_box {

      width:400px;
  height:350px;
  margin:30px 100px;
  background-color:#ffffff;
  border:1px solid black;
  opacity:0.6;
  filter:alpha(opacity=60); /* For IE8 and earlier */
  }

div.newUser {

    margin:30px 40px;
    font-weight:bold;
    color:#000000;
    font-size: small;opacity:1.0;
  filter:alpha(opacity=100); /* For IE8 and earlier */
} 
```

我在我的 div.createuser 中有一个图像作为背景，不透明度为 0.7

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:35:44.267

试试这个，希望对你有帮助

```
div.newUser {
   filter:alpha(opacity=50);
   opacity: 0.5;
}

div.newUser:hover {
   filter:alpha(opacity=90);
   opacity: 0.5;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:44:07.570

您可以通过使用背景 rgba 颜色的不透明度来做到这一点。它适用于所有浏览器：我使用黑色背景来注意您示例中的不透明度。也使用这个元标记，所以它可以在 IE 上工作

```
<meta http-equiv="X-UA-Compatible" content="IE=9" />

div.newUser{
background:rgba(0,0,0,0.5);    
}

 div.newUser:hover{
background:rgba(0,0,0,0.9);    
} 
```

或者你可以像这样使用不透明度来做到这一点：

```
div.newUser{
opacity: 0.5;    
}
div.newUser:hover{
opacity:0.9;    
} 
```

# php - Ajax 不适用于此 .htaccess

> ID：13494295
> 
> 赞同：1
> 
> 时间：2012-11-21T13:24:51.717
> 
> 标签：php, .htaccess, jquery, url-rewriting, permalinks

我正在用 PHP 和 MVC 开发一个 CMS。我有以下 htaccess：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

所以我有一个调度员去不同的意见取决于网址上的永久链接。

我的问题是，我试图使用 ajax 进行登录，而更多的事情并不能使它工作。

.htaccess 中是否有任何异常来完成这项工作，或者我只能在调度程序上放置更多异常以在 ajax 中加载 .php？

任何人都可以帮助我吗？

提前致谢。

编辑：

```
$.post
(
    "../ajax/login.php",
    {
    u:Base64.encode(user),
    p:Base64.encode(password),
},
    function(data)
    {

    },
    "json"
); 
```

我试过：

“../ajax/login.php”

PATH+VIEW+THEME+"/ajax/login.php"

我的文件夹结构是：

```
view
    themes
        standar
            ajax
                login.php
            js
                ajaxInteractions.js
            index.phtml 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:50:34.313

如评论中所述，您需要检查您的路径或只使用您的绝对路径，如下所示：

```
$.post
(
    "/view/themes/standar/ajax/login.php",
    {
    u:Base64.encode(user),
    p:Base64.encode(password),
},
    function(data)
    {

    },
    "json"
); 
```

还有一件事情; 像这样展开代码并不总是最佳实践（这对 PHP 和纯 JS 调用很有用）。对于这些类型的调用，尽量保持集中：

```
$.post( "/view/themes/standar/ajax/login.php", {
    u:Base64.encode(user),
    p:Base64.encode(password),
}, function(data) {
    /** do your stuff **/
}, "json" ); 
```

# serialization - CodeDom 将对象序列化为源代码

> ID：13494296
> 
> 赞同：0
> 
> 时间：2012-11-21T13:24:55.117
> 
> 标签：serialization, reflection, reporting-services, codedom

我正在制作从 SSRS 到 Telerik Reporting 的转换器，然后使用反射写出 .Designer.cs 文件的源代码。

我正在使用反射读取 CodeDom 属性来控制输出，但是有没有办法调用 CodeDom 来从内存中的给定对象进行序列化？

如何调用 CodeDom 序列化？

我是否需要为 WebForms 创建 DesignerHost？我是否需要创建 DesignerSerializationManager 以及如何创建？如果我可以序列化报告，如果可见性是 CONTENT，它会跨越 CodeDom 还是我必须手动执行此操作？

简而言之，我想以编程方式从内存中的对象重新生成 Designer.cs。 [http://labs.kaliko.com/2010/10/regenerate-aspxdesignercs-file.html](http://labs.kaliko.com/2010/10/regenerate-aspxdesignercs-file.html)

谢谢

# jquery - 如何退出 jQuery .each 循环之外

> ID：13494298
> 
> 赞同：3
> 
> 时间：2012-11-21T13:25:01.850
> 
> 标签：jquery

> **可能重复：**
> [如何中断/退出 JQuery 中的 each() 函数？](https://stackoverflow.com/questions/1799284/how-to-break-exit-from-a-each-function-in-jquery)

我想`.each`在某些情况下退出 jQuery 循环，我该怎么做。代码会`exit;`起作用吗？

```
var r = true; 
$('.hour').each(function() {
   var $hours =  $(this).val();
   if ($hours == "") {
     alert(" Active Time is required"); 
     r = false; 
     //exit;         
   }    
}); 
return r; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T13:28:25.090

你应该使用[`return false`](http://api.jquery.com/each/)：

```
$(".hour").each(function() {
    if (want_to_break) {
        return false;
    }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T13:26:02.540

用于`break;`打破常规循环，而`each`我建议您使用这个 jQuery 函数`return;`或`return false;`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T13:31:03.120

```
.each(function() {
    if (iWantToBreak)
        return false;
}); 
```

转发以下内容：

[如何从 JQuery 中的 each() 函数中中断/退出？](https://stackoverflow.com/questions/1799284/how-to-break-exit-from-a-each-function-in-jquery)

# bash - 导出 USER 环境变量以在 cron 中使用

> ID：13494302
> 
> 赞同：4
> 
> 时间：2012-11-21T13:25:18.493
> 
> 标签：bash, ubuntu, cron

我有一个需要设置环境变量 USER 的脚本。由于脚本被多个用户使用，我不能只`export USER=xxx`在脚本的开头做。我可以在 中定义`crontab`，但我只是想知道是否有一种很好的方法可以将其引入。

我尝试了 sourcing`.bashrc`和`.profile`，但都没有定义 USER，而且在 Ubuntu 上`.bashrc`只是在非交互式 shell 上返回。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T14:25:49.817

您可以通过在脚本顶部编写（Bashism）来解决它：

```
USER=$(whoami) 
```

或旧式：

```
USER=`whoami` 
```

...假设您`whoami`在 中`PATH`，也可以`crontab`像几个（大多数？）其他变量一样设置它。即，您也可以`crontab`自行设置变量（至少在 Vixies 中`cron`） -例如，请参见[此处。](http://www.pantz.org/software/cron/croninfo.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T14:59:48.090

使用[`env`](http://man.cx/env)命令。您的 crontab 条目可能如下所示：

```
* * * * * env USER=foouser /path/to/script.sh 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:40:25.440

您可以在命令之前指定环境变量。这样，它不会影响 crontab 中的任何其他内容。

用户.sh：

```
#!/bin/sh
echo $USER 
```

客户端：

```
USER=foo ./user.sh ## outputs "foo" 
```

# c++ - C++ 错误 - 'char' 和 'int' 之前的预期主表达式

> ID：13494304
> 
> 赞同：3
> 
> 时间：2012-11-21T13:25:21.087
> 
> 标签：c++, inheritance, constructor

```
#include<iostream>
#include<cstring>
using namespace std;
class Employee
{
    char name[5];
    int id;
    int age;
    public:
    Employee(char* a, int b, int c)
    {
        strcpy(name, a);
        id=b;
        age=c;
    }
};
class Officer: public Employee
{
    char officer_cadre[3];
    public:
    Officer(char* a, int b, int c, char* d):Employee(char* a, int b, int c)
    {
        strcpy(officer_cadre, d);
    }
};
int main()
{
   Officer o1("Nakul", 1, 2, "ABC");
   return 0;
} 
```

上面的代码很简单，但我无法弄清楚为什么编译器会抛出错误，例如“预期的 char 之前的主表达式”和“预期的 int 之前的主表达式”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T13:27:32.970

更改此行：

```
Officer(char* a, int b, int c, char* d):Employee(char* a, int b, int c) 
```

对此：

```
Officer(char* a, int b, int c, char* d):Employee(a,b,c) 
```

我也很担心你申报的官员干部。它是一个字符指针数组，但没有内存分配。你说的是那个声明吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T13:28:30.067

在这条线上

```
 Officer(char* a, int b, int c, char* d):Employee(char* a, int b, int c) 
```

你应该只通过 a、b 和 c。相反，您使用语法来声明 a、b 和 c。仅提及它们时，您不需要类型。IE 你应该这样做：

```
 Officer(char* a, int b, int c, char* d):Employee(a, b, c) 
```

您可能只是不小心将声明复制粘贴到了子类的构造函数中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:33:47.820

改变

```
char* officer_cadre[3]; 
```

到

```
char officer_cadre[3]; 
```

# mobile - 在移动应用程序上推送通知

> ID：13494305
> 
> 赞同：1
> 
> 时间：2012-11-21T13:25:24.297
> 
> 标签：mobile, push-notification

好的，推送通知如何工作？

我找到了一个不错的教程： http: [//lessons.runrev.com/m/4069/l/59312](http://lessons.runrev.com/m/4069/l/59312)

我得到了设备需要向服务器注册的概念，但该应用程序本质上是否与服务器保持 AJAX 连接，或者服务器是否以某种方式插入手机网络......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:38:21.733

要回答您的问题，我知道：推送通知服务（Apple 和 Microsoft）都使用持久 IP 连接来实现其推送通知功能。

我认为 Android 的工作方式相同（至少在 Android Cloud to Device Messaging (C2DM) 方面）。“它使用 Google 服务的现有连接”。[http://en.wikipedia.org/wiki/Android_Cloud_to_Device_Messaging_Service](http://en.wikipedia.org/wiki/Android_Cloud_to_Device_Messaging_Service)

但答案更接近 AJAX，除了我假设它是从 Android 到 Google 消息服务的简单“http”连接，并且操作系统会收到新消息的警报并将其转发回在其上注册的程序以获取通知.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:36:01.367

在谈论推送通知时，有三个基本组成部分：

1.  你的服务器
2.  提供者服务器
3.  您的移动设备

您的服务器是发件人。它将推送通知发送到供应商服务器，供应商服务器又将其发送到设备。因此，您的设备就是接收器。（结论是您不必“插入手机网络”，这一切都由您的提供商完成 - 在这种情况下是谷歌）
在您的移动应用程序中，您只需注册一个事件处理程序，当您收到推送通知时会触发该事件处理程序。

[Google 将此称为 C2DM（Cloud to Device Messaging），现在称为 GCM（Google Cloud Messaging）——您可以在 android.com](http://developer.android.com/guide/google/gcm/index.html)上获得包括架构概述和演示在内的介绍。

# ios - 获取本地音频文件的 AVURLAsset

> ID：13494312
> 
> 赞同：5
> 
> 时间：2012-11-21T13:25:46.390
> 
> 标签：ios, avaudioplayer, avurlasset

我目前正在编写一个适用于音频文件的 iOS 应用程序，该应用程序的一部分是创建音频文件的波形。因此我需要一个 AVURLAsset 对象，以便 AVAssetReader 可以获取音频文件的数据。

iPhone/iPad 上 iPod 库中的歌曲没有问题，但是当我尝试在应用程序的文档文件夹中获取音频文件的 AVURLAsset 对象时，出现了问题。

我有本地歌曲的 NSURL，并且可以使用 AVAudioPlayer 播放，但是当尝试使用 AVAssetReader 读取 AVURLAsset 时，应用程序崩溃。

有谁知道为什么会发生这个错误？

谢谢！

克里斯

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-21T15:06:50.697

知道了，经过一点研究。使用 fileURLWithPath 而不是 URLWithString 非常重要。

# android - 将 Windows 队列/堆栈移植到 android

> ID：13494315
> 
> 赞同：-5
> 
> 时间：2012-11-21T13:25:52.953
> 
> 标签：android, windows, android-ndk, porting

我正在考虑将 Windows 中使用的队列和堆栈移植到 Android。可以这样做吗？可以在Android NDK的帮助下完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:43:09.380

为什么？`std::queue`并且`std::stack`已经在 Android 上可用。

# python - pyexpat ImportError: DLL load failed: 找不到指定的程序

> ID：13494317
> 
> 赞同：3
> 
> 时间：2012-11-21T13:26:02.663
> 
> 标签：python, xml, dll, module, pythonxy

当我尝试在 python 中使用标准 XML 解析器时，我在 windows XP 上使用 Python 2.7.3（32 位）：

```
from pyexpat import * 
```

我得到错误：

```
 from pyexpat import *
ImportError: DLL load failed: The specified procedure could not be found. 
```

问题在我安装[python(x,y)](http://code.google.com/p/pythonxy/)后开始。当我尝试使用 python [windows 安装](http://www.python.org/getit/)程序“修复”python 安装时，它仍然给出相同的错误。

**问题是什么？**

# plot - 用循环绘制 1000 个模拟，错误消息

> ID：13494318
> 
> 赞同：0
> 
> 时间：2012-11-21T13:26:05.300
> 
> 标签：plot, graphic

我想创建 1000 个 png 文件，而每个文件应该包含一个模拟的股票路径，但还应该包含其他的。

所以我从第一个路径开始，在图中添加第二个，添加第三个等等，所以最后我有一个包含 1000 个模拟的图，这是我的代码：

```
for(i in 1:1000){
#jpeg(paste("1000s",i,".png",sep=""))
plot(c(1:23),matrix[,1],type="l",ylim=c(17,24))
lines(c(1:23),matrix[,i],type="l",col=i)
#dev.off()
} 
```

这是问题所在，当循环到达下一个值时，每个附加部分都会消失，所以我尝试了：

```
plot(0,0 , xlim=c(1,23),ylim=c(17,24),xlab="",ylab="")
for(i in 1:1000){
jpeg(paste("1000s",i,".png",sep=""))
lines(c(1:23),matrix[,i],type="l",col=i)
dev.off()
} 
```

我知道这不是一个工作示例，但我的问题只是循环的逻辑问题，当我最后一个代码时收到以下错误消息： plot.new 尚未被调用

该矩阵有 1000 列和 23 行条目，这应该是 22 个交易日的 1000 次股票路径模拟。

我必须改变什么？谢谢！

# java - 这是将 .properties 文件排除在 WAR 文件之外的最佳方法吗？

> ID：13494320
> 
> 赞同：0
> 
> 时间：2012-11-21T13:26:11.553
> 
> 标签：java, jakarta-ee, properties-file

要外部化 .properties 文件，目前我将其保存在文件系统中，例如 C:\test\UI\properties，并且我创建了一个指向上述文件位置的环境变量 $PROP_LOCATION。因此，每当我需要更改属性时，只需转到该位置编辑属性并刷新应用程序即可。它就像一个魅力。

那么这是最好的方法吗？或者您的专业人士是否有其他方法建议我将属性文件保留在战争文件之外？

注意：上面的东西在unix和windows环境中都可以正常工作，因为我有一个“if”条件，如果没有找到一个环境变量，我将检查另一个环境变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:41:04.363

我通常通过将目录添加到类路径来引用外部属性文件。

例如，如果exam​​ple.properties在路径C:\test\UI\properties目录下，我调用JVM如下：

```
java -classpath C:\test\UI\properties MyJavaProgram 
```

在 Java 代码中，您可以通过以下机制加载属性：

```
Properties p = new Properties();
p.load(getClass().getClassLoader().getResourceAsStream("/example.properties")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:43:48.883

我同意将属性文件与您的应用程序一起打包是最有意义的。如果您有正当理由不这样做，那么您的解决方案似乎没问题，只要在部署中将文件放置在您的应用程序可以访问且不暴露于 Internet 的位置。

我正在做一些类似于你的事情。在我正在运行的应用程序中，有一个我希望用户看到的公告和其他消息页面，但是为了让我和其他人更容易编辑这些消息，它们是从服务器上的另一个位置加载的，甚至没有在 Tomcat 文件夹中。然后我可以轻松地编辑消息，甚至无需重新部署。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:30:36.437

我建议使用spring的ReloadableResourceBundleMessageSource

看看：[http ://static.springsource.org/spring/docs/1.2.9/api/org/springframework/context/support/ReloadableResourceBundleMessageSource.html](http://static.springsource.org/spring/docs/1.2.9/api/org/springframework/context/support/ReloadableResourceBundleMessageSource.html)

至于放置属性文件，我不认为将它们放在应用程序之外是个好主意。无论如何，您都应该将它们打包在 war 中，因为它们在逻辑上是您的应用程序的一部分。

而且由于您正在重新加载应用程序，因此每次属性更改时，您都可以使用 maven 任务在服务器上构建、部署和重新加载应用程序。

# java - UDP数据包分离

> ID：13494323
> 
> 赞同：2
> 
> 时间：2012-11-21T13:26:25.907
> 
> 标签：java, android, udp

我正在andorid 上创建一个UDP 服务。为清楚起见，此处复制的部分代码：

```
 byte[] message = new byte[1500];
    DatagramPacket packet = new DatagramPacket(message, message.length);                    
    socket = new DatagramSocket(Constants.LISTENING_PORT_NUMBER);
    socket.receive(packet); 
```

问题是我不断地接收 UDP 数据包。例如数据包#1（250 字节长）、数据包#2（182 字节长）、数据包#3（403 字节长）等...

我需要获取并处理具有可变长度的单独 UDP 数据包。根据 UDP 协议规范，UDP 数据包定义了消息边界。但是我在 Java 中没有找到可以分离 UDP 数据包的解决方案。

在我当前的解决方案中，我必须定义我必须读取的数据包长度，但在收到它之前我不知道数据包长度。

我错过了一点吗？

* * *

**编辑：** 感谢 Tobias 和 shazin 都是正确的答案。可悲的是，我不能将两个答案标记为正确。

将`socket.receive(packet);`接收到 UDP 数据包边界，随后的数据包可以与另一个`socket.receive(packet);`.
我的问题应该是在第一条消息的过程中，由于同步处理，到达的进一步消息没有被处理，现在我将消息处理传递给异步任务，希望能够及时捕获所有到达的数据包。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:39:46.253

您无法事先知道数据包长度。您可以根据可能收到的数据定义最大边界字节数组。建议使用 2048 字节数组。

```
byte[] message = new byte[2048]; 
```

即使您在传入的消息包中具有可变长度，您也可以使用以下代码来接收

```
byte[] message = new byte[2048];
DatagramPacket packet = new DatagramPacket(message, message.length);                    
socket = new DatagramSocket(Constants.LISTENING_PORT_NUMBER);
socket.receive(packet);
String data = new String(packet.getData(), 0, packet.getLength()); 
```

getData 和 getLength 方法可用于确定接收数据包的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:30:02.960

也许我在这里遗漏了一些东西，但 a`DatagramPacket`是发送的*一个*数据包。它具有获取数据所需的`getLength()`和方法。`getOffset()`我相信还有一个`getData()`返回发送的数据。

在这里，您有一个可以进一步帮助您的[链接。](http://docs.oracle.com/javase/tutorial/networking/datagrams/clientServer.html)

# elf - 为什么精灵段没有页面对齐？

> ID：13494331
> 
> 赞同：6
> 
> 时间：2012-11-21T13:26:36.203
> 
> 标签：elf

`readelf -l /bin/ls`：

```
 LOAD           0x000000 0x08048000 0x08048000 0x18ff8 0x18ff8 R E 0x1000
  LOAD           0x019eec 0x08061eec 0x08061eec 0x003f4 0x01014 RW  0x1000 
```

那么这两个段之间的边界页既是只读的又是可读写的，这怎么可能呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T17:42:33.217

假设页面大小为 4096 (0x1000) 字节并将地址舍入为页面粒度：

*   第一个可加载段将使用地址范围 [0x8048000--0x8060FFF]，包括两端。
*   第二个可加载段将使用地址范围 [0x8061000--0x8062FFF]，其中从地址 0x8061EEC 开始的 0x3F4 字节将来自可执行文件，其余的在加载时填充为零。

没有重叠。

# .net - ASP.NET 优化未将 LESS 转换为 CSS

> ID：13494335
> 
> 赞同：4
> 
> 时间：2012-11-21T13:26:45.063
> 
> 标签：.net, less, asp.net-optimization, bundling-and-minification

我很难使用 .NET 的新优化框架（用于缩小和捆绑）将 LESS 文件转换为 CSS。

我有一个只包含 LESS 文件的目录。

我使用以下代码将它们捆绑在一起并将它们转换为 CSS：

```
var lessBundle = new Bundle("~/st-style-common-2")
    .IncludeDirectory("~/Admin/Resources/styles/", "*.less");
lessBundle.Transforms.Add(new LessTransform());
lessBundle.Transforms.Add(new CssMinify());
bundles.Add(lessBundle); 
```

我还使用了[这里](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)详述的 LessTransform 类。

当 debug="false" 时，文件会按预期转换为标准 CSS 并编译为一个。

但是，当 debug="true" 文件未转换时，会在 HTML 中留下一堆 .less URL，浏览器无法理解这些 URL，并且 IIS 似乎没有处理程序。

我意识到我*可以*构建一些可以为这些 .less 文件提供服务的处理程序，但我认为我不需要这样做。即使在调试时，优化框架也不会将 LESS 转换为 CSS 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T09:50:10.313

*我本身*没有找到解决方案，但我设法通过使用[Web Essentials 插件](http://visualstudiogallery.msdn.microsoft.com/07d54d12-7133-4e15-becb-6f451ea3bea6?SRC=Home)解决了这个问题，该插件自动将我的 LESS 文件转换为 CSS（以及缩小的 CSS 版本）。

这允许我使用 LESS，保存文件并自动编译样式的 CSS 版本，然后我只需引用 CSS 版本而不是 LESS 版本：

```
bundles.Add(new StyleBundle("~/styles").Include(
            "~/Admin/Resources/styles/*.css")); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:45:44.963

[您提到](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)的从哪里获得 LessTransform 类的教程中的第 2 步说您应该安装无点 NuGet 包。当您通过 Visual Studio 包管理器执行此操作时，一个 .less 处理程序会自动在您的 Web.config 中注册。以下内容也在 Web.config 中很重要：

```
<modules runAllManagedModulesForAllRequests="true"> 
```

这样，一切都会自动运行，即使您的开发团队没有安装 Web Essentials，他们也可以使用该项目。我不喜欢依赖某些扩展来处理项目（即使我喜欢 Web Essentials！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T19:39:48.407

问题是，当 debug=true 时，默认情况下不会运行优化，对于较少的文件，您总是希望运行优化，因此您可以通过在 BundleConfig.cs 中设置来明确设置：

```
BundleTable.Bundles.EnableOptimizations = true 
```

# twitter-bootstrap - Twitter Bootstrap 中的视差滑块

> ID：13494337
> 
> 赞同：2
> 
> 时间：2012-11-21T13:26:57.790
> 
> 标签：twitter-bootstrap, parallax

我正在 Twitter 引导程序中开发一个网站，但没有选择使用另一个滑块而不是内置轮播滑块。

请告诉我是否有任何解决方案可以在 twitter bootstrap 中添加视差内容滑块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:32:39.530

Bootstrap 中没有视差功能，但你可以使用任何你想要的视差滑块插件，它不应该与 Bootstrap 冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T09:17:33.763

您可以使用当前的 jQuery UI Bootstrap ：

[http://addyosmani.github.com/jquery-ui-bootstrap/](http://addyosmani.github.com/jquery-ui-bootstrap/)

# iphone - 如何删除 iCarousel 中的重复项

> ID：13494339
> 
> 赞同：2
> 
> 时间：2012-11-21T13:27:07.293
> 
> 标签：iphone, objective-c, ios, tableview, icarousel

[https://github.com/nicklockwood/iCarousel/issues/278](https://github.com/nicklockwood/iCarousel/issues/278)

我将使用 iCarousel 线性显示图像。这些图像将被动态获取。假设有 2 个图像。但是当我更新 iCarousel 时，背景中也有 2 个图像，如下图。

![](../Images/a66ddb24de81d3b5b9e4b7ba9a929055.png)

在调试代码时，我发现 viewForItemAtIndex 函数在我调用*reloadData*函数后被调用了 2 次。

*- (UIView *)carousel:(iCarousel *)carousel viewForItemAtIndex:(NSUInteger)index reusingView:(UIView *)view*

![](../Images/1d99ebe7977f51be1fb5c4fa8d3dad9b.png)

![](../Images/b410069eee8e5d9995b72e7b82446ca0.png)

所以 iCarousel 中有 4 张图像。

如何防止被调用2次？

请帮我尽快解决这个问题。

* * *

```
- (UIView *)carousel:(iCarousel *)carousel viewForItemAtIndex:(NSUInteger)index reusingView:(UIView *)view
{
    UIImageView *puzzlePhoto = nil;
    UIImageView *puzzleBG = nil;
    UILabel *label = nil;

    if (view == nil)
    {
        view = [[UIImageView alloc] init];
        view.frame = CGRectMake(0, 0, 128, 112);
        view.backgroundColor = [UIColor clearColor];
        view.layer.doubleSided = NO;
        puzzlePhoto = [[UIImageView alloc] initWithFrame:CGRectMake(46, 48, 40, 40)];

        //! get friend's photo
        FForesight *foresightCurrent = (carousel == self.icGameOnwhoAREus) ? [controller.gameManager.m_arrayStartedForesights objectAtIndex:index] : [controller.gameManager.m_arrayEndedForesights objectAtIndex:index];
        UIImage *imgPuzzle = [foresightCurrent getPuzzleImage];

        if (imgPuzzle)
            puzzlePhoto.image = imgPuzzle;
        else
            puzzlePhoto.image = [UIImage imageNamed:@"puzzle background_small.png"];

        puzzleBG = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 128, 112)];
        if (((foresightCurrent.m_intStage & FForesightStage_First) && !foresightCurrent.m_FCreatedByFriend) ||
            ((foresightCurrent.m_intStage & FForesightStage_Second) && foresightCurrent.m_FCreatedByFriend))
            puzzleBG.image = [UIImage imageNamed:@"multi_game_one_item_bg_me.png"];
        else
            puzzleBG.image = [UIImage imageNamed:@"multi_game_one_item_bg.png"];

        //! get friend name
        FUser *userFriend = foresightCurrent.m_userFriend;
        label = [[UILabel alloc] initWithFrame:CGRectMake(32, 32, 68, 16)];
        label.text = userFriend.m_strName;
        label.textAlignment = NSTextAlignmentCenter;
        label.font = [UIFont boldSystemFontOfSize:10];
        label.backgroundColor = [UIColor clearColor];
        label.textColor = [UIColor colorWithRed:205.0f/256 green:55.0f/256 blue:2.0f/255 alpha:1];

        [view addSubview:puzzlePhoto];
        [view addSubview:puzzleBG];
        [view addSubview:label];
    }

    return view;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T09:30:57.690

这个问题几乎可以肯定是由于视图被错误地回收。视图与不同的索引一起使用，您永远不应该在视图创建代码中设置特定于索引的属性。这是设置项目视图的正确方法：

```
- (UIView *)carousel:(iCarousel *)carousel viewForItemAtIndex:(NSUInteger)index reusingView:(UIView *)view
{
    UIImageView *puzzlePhoto = nil;
    UIImageView *puzzleBG = nil;
    UILabel *label = nil;

    const NSInteger puzzlePhotoTag = 1;
    const NSInteger puzzleBGTag = 2;
    const NSInteger labelTag = 3;

    if (view == nil)
    {
        //*************************************************
        //do setup that is the same for every item view here
        //*************************************************

        view = [[UIImageView alloc] init];
        view.frame = CGRectMake(0, 0, 128, 112);
        view.backgroundColor = [UIColor clearColor];
        view.layer.doubleSided = NO;

        puzzlePhoto = [[UIImageView alloc] initWithFrame:CGRectMake(46, 48, 40, 40)];
        puzzlePhoto.tag = puzzlePhotoTag;
        [view addSubview:puzzlePhoto];

        puzzleBG = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 128, 112)];
        puzzleBG.tag = puzzleBGTag;
        [view addSubview:puzzleBG];

        label = [[UILabel alloc] initWithFrame:CGRectMake(32, 32, 68, 16)];
        label.textAlignment = NSTextAlignmentCenter;
        label.font = [UIFont boldSystemFontOfSize:10];
        label.backgroundColor = [UIColor clearColor];
        label.textColor = [UIColor colorWithRed:205.0f/256 green:55.0f/256 blue:2.0f/255 alpha:1];
        label.tag = labelTag;
        [view addSubview:label];
    }
    else
    {
        //get references to subviews
        puzzlePhoto = (UIImageView *)[view viewWithTag:puzzlePhotoTag];
        puzzleBG = (UIImageView *)[view viewWithTag:puzzleBGTag];
        label = (UILabel *)[view viewWithTag:labelTag];
    }

    //*************************************************
    //do setup that is different depending on index here
    //*************************************************

    //! get friend's photo
    FForesight *foresightCurrent = (carousel == self.icGameOnwhoAREus) ? [controller.gameManager.m_arrayStartedForesights objectAtIndex:index] : [controller.gameManager.m_arrayEndedForesights objectAtIndex:index];
    UIImage *imgPuzzle = [foresightCurrent getPuzzleImage];

    if (imgPuzzle)
        puzzlePhoto.image = imgPuzzle;
    else
        puzzlePhoto.image = [UIImage imageNamed:@"puzzle background_small.png"];

    if (((foresightCurrent.m_intStage & FForesightStage_First) && !foresightCurrent.m_FCreatedByFriend) || ((foresightCurrent.m_intStage & FForesightStage_Second) && foresightCurrent.m_FCreatedByFriend))
        puzzleBG.image = [UIImage imageNamed:@"multi_game_one_item_bg_me.png"];
    else
        puzzleBG.image = [UIImage imageNamed:@"multi_game_one_item_bg.png"];

    //! get friend name
    FUser *userFriend = foresightCurrent.m_userFriend;
    label.text = userFriend.m_strName;

    return view;
} 
```

至于滚动惯性问题，如果您在应用此修复后仍然看到该问题，请在 github 页面上提交单独的错误报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-02T13:52:50.937

我通过在 mainThread 上执行 reloadData 解决了这个问题

```
[carousel performSelectorOnMainThread:@selector(reloadData) withObject:nil waitUntilDone:YES]; 
```

# c - 如何为多行宏调用获取宏名称 __LINE__？

> ID：13494343
> 
> 赞同：3
> 
> 时间：2012-11-21T13:27:25.420
> 
> 标签：c, gcc, macros

我创建了一个用于错误跟踪的宏。这是一个简化版本：

```
#include <stdio.h>

#define ERR(...)                                 \
    printf("error @ %d\n", __LINE__)

int main()
{
    return ERR(1,               /* line 7 */
               2,               /* line 8 */
               3);              /* line 10 */
} 
```

执行时，它会打印：

```
error @ 10 
```

但是，要将打印的行号与`grep`输出 ( `grep -n ERR test.c`) 匹配，我需要`ERR`字符串 ( `line 7`) 的行号。

这样的事情甚至可能吗？有任何想法吗？

附加说明：宏应该看起来像一个函数调用（所以我可以这样做`return ERR(...);`）。编译器是 GCC 版本 4.4.5。可以使用 C99 + GNU 扩展。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:39:14.467

基于@cwyang 命题，在定义和逗号运算符中使用括号不匹配的宏。

```
#define ERR (LINEINFO, HANDLEARGS
#define HANDLEARGS(...) __LINE__)
#define LINEINFO printf("error @ %d: ", __LINE_)

return ERR(x,
           y,
           z); 
```

将扩大到

```
return (printf("error @ %d: ", 5), 7); 
```

与 gcc。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T14:02:34.753

以下情况如何：

```
#define VOID_MACRO(...) (void) 0
#define ERR printf("err @ %d\n", __LINE__); VOID_MACRO 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T15:42:36.257

Perhaps this is an option?

```
#define ERR(line,...)             \
    printf("error @ %d\n", line)

ERR(__LINE__
    blah,
    blah,
    blah); 
```

# objective-c - iOS应用程序中的FFMpeg音频/视频不同步

> ID：13494346
> 
> 赞同：14
> 
> 时间：2012-11-21T13:27:27.760
> 
> 标签：objective-c, ios, c, ffmpeg, avfoundation

该应用程序将相机输出保存到 mov 中。文件，然后将其转换为由 AVPacket 发送到 rtmp 服务器的 flv 格式。它每次在两个文件之间切换，一个由相机输出写入，另一个被发送。我的问题是一段时间后音频/视频不同步。

发送的第一个缓冲区始终是 100% 同步的，但一段时间后它会变得混乱。我相信它是一个 DTS-PTS 问题..

```
 if(isVideo)
{
    packet->stream_index = VIDEO_STREAM;
   packet->dts = packet->pts = videoPosition;
    videoPosition += packet->duration = FLV_TIMEBASE * packet->duration * videoCodec->ticks_per_frame * videoCodec->time_base.num / videoCodec->time_base.den;

}
else
{
    packet->stream_index = AUDIO_STREAM;
    packet->dts = packet->pts = audioPosition;
    audioPosition += packet->duration = FLV_TIMEBASE * packet->duration / audioRate;

   //NSLog(@"audio position = %lld", audioPosition);
}

packet->pos = -1;
packet->convergence_duration = AV_NOPTS_VALUE;

// This sometimes fails without being a critical error, so no exception is raised
if((code = av_interleaved_write_frame(file, packet)))
{
    NSLog(@"Streamer::Couldn't write frame");
}
av_free_packet(packet); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:55:03.527

您可以研究此示例：[http ://unick-soft.ru/art/files/ffmpegEncoder-vs2008.zip](http://unick-soft.ru/art/files/ffmpegEncoder-vs2008.zip)

但此示例适用于 Windows。

在此示例中，我仅将 pts 用于音频流：

```
 if (pVideoCodec->coded_frame->pts != AV_NOPTS_VALUE)
  {
    pkt.pts = av_rescale_q(pVideoCodec->coded_frame->pts, 
      pVideoCodec->time_base, pVideoStream->time_base);
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-28T19:58:54.887

我在切换 AVAssetWriters 时遇到了类似的问题，并注意到如果我在获得视频样本时才开始使用新的 AVAssetWriter

[https://medium.com/@brandon.kobel/ios-seamless-video-chunks-4383a5a3a874](https://medium.com/@brandon.kobel/ios-seamless-video-chunks-4383a5a3a874)

# java - 当我在选择 0 索引时删除和添加时，Swing JList 冻结

> ID：13494352
> 
> 赞同：2
> 
> 时间：2012-11-21T13:27:52.737
> 
> 标签：java, swing, user-interface, jlist

这是一个示例，您按下一个按钮，jList1 将重新填充从 a1 到 a1000 的项目。：

```
//variable
private List<String> list = new ArrayList<>();

...

//main method
jList1.setModel(new DefaultListModel());
for(int i = 0; i < 1000; i++) {
    list.add("a"+i);
}

...

//button action - jList1 refill
DefaultListModel dtm = (DefaultListModel)jList1.getModel();
dtm.removeAllElements();
for(String s : list) {
    dtm.addElement(s);
} 
```

如果我填充`jList1`，然后选择（用鼠标）0 索引（jList 中的第一个元素），然后在重新填充列表时按下程序冻结的按钮。如果我选择任何其他元素或根本不选择列表中的任何项目，那么它就可以很好地填充。

PS 这个例子是在没有任何 swing 或 EWT 线程的情况下完成的，因为使用它们找到了主要原因。

SSCCE：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package lt;

import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import java.util.List;
import javax.swing.DefaultListModel;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JList;
import javax.swing.JPanel;

/**
 *
 * @author Minutis
 */
public class Window {

    public static void main(String[] args) {
        final List<String> list = new ArrayList<>();

        JFrame frame = new JFrame("BorderLayout Frame");
        JPanel panel = new JPanel();
        final JList jList1 = new JList();
        JButton refill = new JButton("Refill");

        jList1.setModel(new DefaultListModel());
        for(int i = 0; i < 1000; i++) {
            list.add("a"+i);
        }

        refill.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                DefaultListModel dtm = (DefaultListModel)jList1.getModel();
                dtm.removeAllElements();
                for(String s : list) {
                    dtm.addElement(s);
                }
            }

        });

        frame.add(panel);
        panel.setLayout(new BorderLayout());
        panel.add(jList1, BorderLayout.CENTER);
        panel.add(refill, BorderLayout.SOUTH);
        frame.setSize(300, 300);
        frame.setVisible(true);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T14:40:07.343

问题是在选择第一个元素时删除模型中的所有元素引起的。The way it is implemented, when an index is selected and is removed, for some reason it generates a selectionChanged event. 如果在删除另一个索引时选择了另一个索引（即使这意味着元素移动），它也不会生成 selectionChanged 事件。

删除的实现方式是定期删除第一个元素，而选择索引保持不变。因此对于选择索引 0 的情况，它会生成 1000 个 selectionChanged 事件，这些事件必须由 EDT 和侦听器处理。如果选择其他索引，则仅生成 1 个事件。这显着减少了开销。

在选择索引 0 时重新填充之前，尝试手动将选择设置为索引 1：

```
if(jList1.getSelectedIndex() == 0){
     jList1.setSelectedIndex(1);
} 
```

我认为如果列表中只有一个元素，则无需担心 - 它不应该做任何事情来设置索引大于元素计数。但这可能是特定于实现的。

出于某种原因，`clearSelection()`将导致生成 selectionChanged 事件以重新填充空列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T14:10:55.880

*   逻辑和更好的可以（只是为了避免拼写错误）直接在`add`//中，`remove``modify` `Items``XxxListModel`

例如

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class Testing extends JFrame {

    private static final long serialVersionUID = 1L;
    private DefaultListModel listModel = new DefaultListModel();
    private JList list = new JList(listModel);
    private int currentSelectedRow = 0;
    private int xX = 0;

    public Testing() {
        setLocation(400, 300);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        for (int x = 0; x < 51; x++) {
            listModel.addElement("" + x);
            xX++;
        }
        JScrollPane sp = new JScrollPane(list);
        final JViewport vp = sp.getViewport();
        add(sp, BorderLayout.CENTER);
        /*JButton btn = new JButton("Get Row:");
        add(btn, BorderLayout.SOUTH);
        btn.addActionListener(new ActionListener() {

        public void actionPerformed(ActionEvent ae) {
        try {
        int goToRow = Integer.parseInt(JOptionPane.showInputDialog(getContentPane(), "Go To Row:"));
        Rectangle r = list.getCellBounds(goToRow, goToRow);
        if (goToRow > currentSelectedRow) {
        r = list.getCellBounds(goToRow - 1, goToRow - 1);
        int vph = vp.getExtentSize().height;
        r.y += vph;
        }
        list.scrollRectToVisible(r);
        list.setSelectedIndex(goToRow);
        currentSelectedRow = goToRow;
        } catch (Exception e) {

        }
        }
        });*/
        JButton btn1 = new JButton("Reset Model CastingModel");
        add(btn1, BorderLayout.NORTH);
        btn1.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent ae) {
                DefaultListModel model = (DefaultListModel) list.getModel();
                model.removeAllElements();
                for (int x = 0; x < 51; x++) {
                    model.addElement("" + (x + xX));
                    xX++;
                }
                //list.setModel(model);
            }
        });

        JButton btn2 = new JButton("Reset Model directly from Model");
        add(btn2, BorderLayout.SOUTH);
        btn2.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent ae) {
                listModel.removeAllElements();
                for (int x = 0; x < 51; x++) {
                    listModel.addElement("" + (x + xX));
                    xX++;
                }
            }
        });

        pack();
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new Testing().setVisible(true);
            }
        });
    }
} 
```

编辑`list.clearSelection()`；没有任何问题，所有超过 1k 行的内容都是由 OP 所描述的问题引起的

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class Testing extends JFrame {

    private static final long serialVersionUID = 1L;
    private DefaultListModel listModel = new DefaultListModel();
    private JList list = new JList(listModel);
    private int currentSelectedRow = 0;
    private int xX = 0;

    public Testing() {
        setLocation(400, 300);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        for (int x = 0; x < 999; x++) {
            listModel.addElement("" + x);
            xX++;
        }
        JScrollPane sp = new JScrollPane(list);
        final JViewport vp = sp.getViewport();
        add(sp, BorderLayout.CENTER);

        JButton btn1 = new JButton("Reset Model CastingModel");
        add(btn1, BorderLayout.NORTH);
        btn1.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent ae) {
                list.clearSelection();
                DefaultListModel model = (DefaultListModel) list.getModel();
                model.removeAllElements();
                for (int x = 0; x < 999; x++) {
                    model.addElement("" + (x + xX));
                    xX++;
                }
                //list.setModel(model);
            }
        });

        JButton btn2 = new JButton("Reset Model directly from Model");
        add(btn2, BorderLayout.SOUTH);
        btn2.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent ae) {
                list.clearSelection();
                listModel.removeAllElements();
                for (int x = 0; x < 999; x++) {
                    listModel.addElement("" + (x + xX));
                    xX++;
                }
            }
        });

        pack();
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new Testing().setVisible(true);
            }
        });
    }
} 
```

# java - 为什么我不能在jsp中显示从数据库中获取的数据？

> ID：13494360
> 
> 赞同：1
> 
> 时间：2012-11-21T13:28:13.323
> 
> 标签：java, jsp, hsqldb

我想显示从我的数据库中获取的所有订单。我的 OrderDate 类型设置为日期，另一个设置为字符串。但我收到错误“未知属性 OrderDate”。下面是我用来显示数据的 JSP 代码。

```
<%@page import="java.text.SimpleDateFormat"%>
<%@page import="booking.Bean.Order"%>
<%@page import="java.util.Vector"%>
<%@page import="booking.Wrapper.Wrapper"%>
<%@page import="booking.DB.OrderDB"%>
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<%@ taglib uri="http://displaytag.sf.net" prefix="display"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="stylesheet" type="text/css" href="css/style.css" />
<link href="css/displaytag.css" rel="stylesheet" type="text/css">
<link href="css/alternative.css" rel="stylesheet" type="text/css">
<title>All Order Details</title>
</head>
<body>
        <div id="container">
        <div id="header">
            <jsp:include page="header.jsp" />
        </div>

        <div id="menu">
        <ul>

                <li class="menuitem"><a href="aboutC.jsp">About</a>
                </li>
                <li class="menuitem"><a href="clientsC.jsp">Menu</a>
                </li>
                <li class="menuitem"><a href="contactC.jsp">Contact Us</a>
                </li>
                <li class="menuitem"><a href="login.jsp">Logout</a>
                </li>
            </ul>

        </div>

        <div id="leftmenu">

            <div id="leftmenu_top"></div>

            <div id="leftmenu_main">

                <jsp:include page="orderMenu.jsp" />
            </div>

            <div id="leftmenu_bottom"></div>
        </div>

        <div id="content">
            <div id="content_top"></div>
            <div id="content_main">
            <h2>All Order Details</h2>
                <%

                OrderDB orderDB = new OrderDB();
                Wrapper myWrapper = new Wrapper();
                Vector<Order> viewAllOrders = myWrapper.viewAllOrders();

                //SimpleDateFormat date = new SimpleDateFormat("yyyy-MM-dd");

                if (viewAllOrders.size() !=0)
                {
                    request.setAttribute("disOrder", viewAllOrders);
                    %>          
                <display:table name="disOrder" export="true" pagesize="10" class="Mars"  >
                    <display:column sortable="true" property="orderId" title="Order ID" />
                    <display:column sortable="true" property="custId" title="Customer ID" />
                    <display:column sortable="true" property="OrderDate" format="{0,date,yyyy-MM-dd}" title="Order Date" />
                    <display:column sortable="true" property="OrderTime" title="Order Time" />
                    <display:column sortable="true" property="OrderSeat" title="Order Seat" />
                    <display:column sortable="true" property="BStatus" title="Order Status" />
                    <display:column sortable="true" property="OCustName" title="Customer Name" />       
                    <display:column sortable="true" property="cOEmail" title="Email" />
                    <display:column sortable="true" property="cOPhoneNo" title="Contact No"/>
                    <display:column sortable="true" property="defaulter" title="Defaulter" />
                </display:table>
                <%
                }
                else
                {
                    out.print("<h4>No data found!</h4>");
                }
                %>

            </div>
            <div id="content_bottom"></div>

            <jsp:include page="footer.jsp"/>
        </div>
    </div>
</body>
</html> 
```

下面是系统得到的异常。

```
Nov 21, 2012 9:22:57 PM org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet [jsp] in context with path [/Table_Booking] threw exception [javax.servlet.ServletException: javax.servlet.jsp.JspException: Exception: [.LookupUtil] Error looking up property "OrderDate" in object type "booking.Bean.Order". Cause: Unknown property 'OrderDate'] with root cause
java.lang.NoSuchMethodException: Unknown property 'OrderDate'
    at org.apache.commons.beanutils.PropertyUtilsBean.getSimpleProperty(PropertyUtilsBean.java:1122)
    at org.apache.commons.beanutils.PropertyUtils.getSimpleProperty(PropertyUtils.java:408)
    at org.displaytag.util.LookupUtil.getProperty(LookupUtil.java:271)
    at org.displaytag.util.LookupUtil.getBeanProperty(LookupUtil.java:129)
    at org.displaytag.model.Column.getValue(Column.java:124)
    at org.displaytag.model.Column.createChoppedAndLinkedValue(Column.java:201)
    at org.displaytag.model.Column.initialize(Column.java:178)
    at org.displaytag.render.TableWriterTemplate.writeTableBody(TableWriterTemplate.java:313)
    at org.displaytag.render.TableWriterTemplate.writeTable(TableWriterTemplate.java:138)
    at org.displaytag.render.HtmlTableWriter.writeTable(HtmlTableWriter.java:734)
    at org.displaytag.tags.TableTag.writeHTMLData(TableTag.java:1647)
    at org.displaytag.tags.TableTag.doEndTag(TableTag.java:1300)
    at org.apache.jsp.displayOrder_jsp._jspx_meth_display_005ftable_005f0(displayOrder_jsp.java:262)
    at org.apache.jsp.displayOrder_jsp._jspService(displayOrder_jsp.java:151)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)

Nov 21, 2012 9:22:57 PM org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet [jsp] in context with path [/Table_Booking] threw exception [javax.servlet.ServletException: javax.servlet.jsp.JspException: Exception: [.LookupUtil] Error looking up property "OrderDate" in object type "booking.Bean.Order". Cause: Unknown property 'OrderDate'] with root cause
java.lang.NoSuchMethodException: Unknown property 'OrderDate'
    at org.apache.commons.beanutils.PropertyUtilsBean.getSimpleProperty(PropertyUtilsBean.java:1122)
    at org.apache.commons.beanutils.PropertyUtils.getSimpleProperty(PropertyUtils.java:408)
    at org.displaytag.util.LookupUtil.getProperty(LookupUtil.java:271)
    at org.displaytag.util.LookupUtil.getBeanProperty(LookupUtil.java:129)
    at org.displaytag.model.Column.getValue(Column.java:124)
    at org.displaytag.model.Column.createChoppedAndLinkedValue(Column.java:201)
    at org.displaytag.model.Column.initialize(Column.java:178)
    at org.displaytag.render.TableWriterTemplate.writeTableBody(TableWriterTemplate.java:313)
    at org.displaytag.render.TableWriterTemplate.writeTable(TableWriterTemplate.java:138)
    at org.displaytag.render.HtmlTableWriter.writeTable(HtmlTableWriter.java:734)
    at org.displaytag.tags.TableTag.writeHTMLData(TableTag.java:1647)
    at org.displaytag.tags.TableTag.doEndTag(TableTag.java:1300)
    at org.apache.jsp.displayOrder_jsp._jspx_meth_display_005ftable_005f0(displayOrder_jsp.java:262)
    at org.apache.jsp.displayOrder_jsp._jspService(displayOrder_jsp.java:151)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source) 
```

谁能帮我解决这个问题？？？感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:30:42.320

将大写改为小写：**O** rderDate -> **o** rderDate，与其他一些字段相同

# php - PHP：无法上传 ZIP 文件

> ID：13494366
> 
> 赞同：3
> 
> 时间：2012-11-21T13:28:27.417
> 
> 标签：php, file-upload, zip

每当我尝试通过 PHP 上传 ZIP 文件时，文件大小为 0。

其他一切正常：7z、rar、png、xml

例如（我输出文件大小和位置进行测试）：

```
File Location: /tmp/phpKNortG/feba81fed1ff5d2c04aa0c42975eb94f.7z
Filesize: 1284

File Location: /tmp/phpEWrmLT/feba81fed1ff5d2c04aa0c42975eb94f.zip
Filesize: 0 
```

我的表格有`enctype="multipart/form-data"`，而且文件绝对不会太大而不能上传。（我还将内存限制设置为 128 MB 以确保不是那样）

```
ini_set('memory_limit', '128M');
set_time_limit(0);

$session_id = "3423840093480344";

mkdir('uploaded_files/' . $session_id);

for($i = 0; $i < count($_FILES['backup_file']['name']); $i++) {
    $file_name = $_FILES['backup_file']['name'][$i];
    $file_type = $_FILES['backup_file']['type'][$i];
    $file_error = $_FILES['backup_file']['error'][$i];
    $file_size = $_FILES['backup_file']['size'][$i];
    $file_tmp = $_FILES['backup_file']['tmp_name'][$i];

    print($file_name . "<br />");
    print($file_type . "<br />");
    print($file_error . "<br />");
    print($file_size . "<br />");
    print($file_tmp . "<br />");

    if($file_error != 0) {
        echo "Error-Code: ".$file_error;
        continue;
    }

    move_uploaded_file($file_tmp, 'uploaded_files/' . $session_id);
} 
```

以下代码输出：

```
feba81fed1ff5d2c04aa0c42975eb94f.zip
application/zip
0
0
/tmp/phpEWrmLT 
```

它甚至可以识别 MIME 类型，但文件大小始终为零字节。（甚至在使用 move_uploaded_file 移动它之前）

是否有任何服务器设置可以阻止上传 .zip 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:43:34.660

memory_limit 设置与文件上传无关。

您的 post_max_size 和 upload_max_filesize 的值是多少？ .zip 文件大小与这些值相比如何？

# c# - HttpClient 无法发布 XML 服务器返回语法错误的请求

> ID：13494367
> 
> 赞同：2
> 
> 时间：2012-11-21T13:28:27.510
> 
> 标签：c#, asp.net-mvc-3, httpclient

有没有使用将 XML/json 发布到 REST 服务的工作示例`HttpClient`？我尝试过，但服务器返回的错误请求在语法上不正确。

```
 // my functions 
public T Post<T>(string method, string data)
{
    using (var httpClient = new HttpClient())
    {
        var requestMessage = GetHttpRequestMessage<string>(data);

        var result = httpClient.PostAsync(_endpoint + method, requestMessage.Content).Result;

        return result.Content.ReadAsync<T>().Result;
    }
}

protected HttpRequestMessage GetHttpRequestMessage<T>(T data, bool isJsonContent = false)
{
    var msg = new HttpRequestMessage
                  {
                      Content =
                          isJsonContent
                              ? new ObjectContent<T>(data, new JsonMediaTypeFormatter() { })
                              : new ObjectContent<T>(data, new XmlMediaTypeFormatter() { })
                  };
    return msg;
} 
```

有没有更好的使用方法`HttpClient`？

# vimeo - 有没有办法控制 Vimeo 上显示的初始屏幕截图？

> ID：13494371
> 
> 赞同：0
> 
> 时间：2012-11-21T13:28:37.820
> 
> 标签：vimeo

我已将视频上传到 Vimeo。当有人进入视频页面时，它会显示视频中间的一些截图。有没有办法控制页面加载时和视频播放之前显示的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:34:04.817

一个小小的谷歌搜索回来了这个[答案：](http://vimeo.com/forums/feature_requests/topic:307) “转到视频页面，然后是右上角的设置齿轮图标，然后是缩略图。”

# qt - 如何在 QGraphicsView 中实现菜单栏？

> ID：13494377
> 
> 赞同：0
> 
> 时间：2012-11-21T13:28:58.540
> 
> 标签：qt, qt4, qgraphicsview, qmenubar

我有一个动态显示图像的 QGraphicsView。我还使用 fitInView 功能来调整窗口大小。现在我需要在 QGraphicsView 的顶部添加菜单栏。如何实施？请帮忙。我是 Qt 新手

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T14:23:15.733

作为初学者，将**QGraphicsView**放入**QVBoxLayout**并创建**QMenuBar**并将其插入图形视图上方可能是最简单的。

```
QMenuBar *bar = new QMenuBar();
ui->yourVerticalLayout->insertWidget( 0, bar );

QMenu* yourMenu = bar->addMenu("Your Menu title");
QAction* yourFirstAction = yourMenu->addAction("Your First Action"); 
```

# vba - 检测和触发事件 - Excel

> ID：13494380
> 
> 赞同：0
> 
> 时间：2012-11-21T13:29:06.667
> 
> 标签：vba, excel

我有一个条形码扫描仪。因此，当使用枪扫描条形码时，通常会将值输入到放置在屏幕上的文本字段中。

所以我做了一个excel宏。并且当扫描条形码时，文本会出现在以字符结尾的单元格上`new line`（文本+“\r\n”由扫描仪本身提供）。所以一个事件被触发并完成其余的工作。

问题是该事件仅由换行符触发。如果条码扫描器`\r\n`在每次条码输出后都没有提供怎么办。我该如何处理这种情况？如何检测它并触发事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:14:01.607

如果您创建一个用户表单来接受输入，您可以使用`keydown`or`keypress`事件来检测按下的键。您必须知道条形码的结束条件是什么，因此您知道何时将值发送到要处理的单元格。

Keydown 将为您提供转换状态，并捕获 pageup/pagedown/其他特殊键

```
Private Sub UserForm_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, _
    ByVal Shift As Integer) 
```

Keypress 仅适用于产生可键入字符的键

```
Private Sub UserForm_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger) 
```

如果没有用户表单，您将不得不依靠输入/换行来触发`Change`工作表中的事件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:00:16.750

在工作表模块中添加如下 Worksheet_Change 事件：

```
Private Sub Worksheet_Change(ByVal Target As Range)

    ' Add code here to check for
    ' new line and add if not present

End Sub 
```

或者，如果您在 Userform 文本框中有数据，则使用以下内容：

```
Private Sub TextBox1_Change()

    ' Add code here to check for
    ' new line and add if not present

End Sub 
```

# google-chrome - 选中具有特定类的页面上的复选框

> ID：13494381
> 
> 赞同：0
> 
> 时间：2012-11-21T13:29:10.203
> 
> 标签：google-chrome, google-chrome-extension

所以我已经受够了这一页，如果我想发送私人消息，我总是必须选中一个复选框，当我发送消息时，我希望它始终是私人的。所以我决定尝试制作一个关于它的谷歌浏览器扩展。所以我创建了默认文件 ,`manifest.json`和`popup.html`，但我无法让它工作。

我究竟做错了什么？

`Manifest.json`：

```
{
  "name": "xxx",
  "version": "1.0",
  "manifest_version": 2,
  "description": "Automaattinen yksityiskommentointi.",
  "browser_action": {
    "default_icon": "icon.png",
    "default_popup": "popup.html"
  }
} 
```

`popup.html`：

```
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>XXX</title>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="script.js"></script>
</head>

<body>
Moi
</body>
</html> 
```

和`script.js`：

```
$(document).ready(function(){
    $('.private-checkbox').prop('checked', true);   
}); 
```

这太容易了，对吧？我敢打赌，这只会选中弹出窗口上的复选框，但我想在打开的选项卡中选中复选框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:40:18.403

在 popup.html 中进行以下更改后，它对我有用

下载 jquery.min.js 并将其添加到您的包中，如图所示

**利用**

```
<script src="jquery.min.js"></script> 
```

*代替*

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
```

> 仅加载本地脚本和对象资源

脚本和对象资源只能从扩展包中加载，不能从整个网络加载。这可确保您的扩展程序仅执行您特别批准的代码，从而防止活跃的网络攻击者恶意重定向您对资源的请求。

**更新 Manifest.json**

```
{
  "name": "xxx",
  "version": "1.0",
  "manifest_version": 2,
  "description": "Automaattinen yksityiskommentointi.",
  "browser_action": {
    "default_icon": "icon.png",
    "default_popup": "popup.html"
  },
"content_scripts": [
    {
      "matches": ["http://www.facebook.com/*"],
      "js": ["jquery.min.js","myscript.js"]
    }
  ]
    } 
```

**myscript.js**

```
$(document).ready(function(){
    $('.private-checkbox').prop('checked', true);   
}); 
```

# java - Java - 如何从 Java 类中引用资源文件

> ID：13494382
> 
> 赞同：1
> 
> 时间：2012-11-21T13:29:10.117
> 
> 标签：java, spring, classpath

我想在 Java 测试类中引用一个资源文件，它是一个密钥库文件。此属性通常从指向本地或远程运行的 JDK 的属性文件加载。

当 Maven 在我的部署过程中执行构建时，它首先构建在构建服务器上。我希望能够将密钥库文件放在类路径上，这样我就不必对构建服务器施加硬依赖（这样我会将密钥库放在构建服务器上）

当我在本地连接单元测试时，它可以很好地使用此配置，但是当我在构建服务器上执行构建时，此路径会失败。任何人都可以解释为什么这会失败吗？我能做些什么来解决？我想我知道原因，但澄清会很棒。

当前配置

```
<bean id="httpClient"
    class="myapp.HTTPClient">
    <property name="trustStoreLocation" value="..\\mywebapp\\target\\test-classes\\truststore" />
    <property name="trustStorePass" value="mypass" />
</bean> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:57:34.647

对于资源文件，我更喜欢遵循 ​​Maven 的标准目录结构。请阅读（http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html）以获取更多参考。在 src/test/resources 和 src/main/resources 中放置像（.cfg 或 .jks 或 .properties）这样的文件会在构建时自动在类路径中使用。此外，它使您能够隔离测试和主要资源文件。

例如，我的 pom.xml 如下所示：

```
<build>
    <finalName>${project.artifactId}</finalName>
    <resources>
        <resource>
            <directory>src/main/resources</directory>
        </resource>
        <resource>
            <directory>src/main/config</directory>
        </resource>
         <resource>
            <directory>src/main/resources</directory>
        </resource>
    </resources>
    <testResources>
        <testResource>
            <directory>src/main/config</directory>
        </testResource>
         <testResource>
            <directory>src/main/resources</directory>
        </testResource>
    </testResources>

    <!-- Other pom.xml stuff -->

</build> 
```

现在，验证您的文件是否已正确复制的一种简单方法是将 jar 制成表格并检查您想要的文件。

```
mvn build 
```

然后做：

```
jar -tf target/<your project jar>.jar | grep "<file name you want to verify>" 
```

# android - 列表视图未在 ICS 上列出

> ID：13494383
> 
> 赞同：3
> 
> 时间：2012-11-21T13:29:14.263
> 
> 标签：android, listview, android-4.0-ice-cream-sandwich

我正在尝试在列表视图中列出 json 数据。我的应用程序适用于 froyo 和 blue stacks 模拟器。但它没有在我的手机和我朋友的手机上列出任何东西`ListView`（它们都是 ICS）

```
ListView list = (ListView) findViewById(R.id.lstEcz);
SimpleAdapter mSchedule = new SimpleAdapter(
        this, nobList, R.layout.nob_eczane, 
        new String[] { "istasyon", "adres", "tel", "ilce" }, 
        new int[] { R.id.tvEczAd, R.id.tvEczAdres, R.id.tvEczTel, R.id.tvEczIlce }
);

list.setAdapter(mSchedule); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:19:33.370

```
public class getInternet extends AsyncTask<String, Void, Void> 
    {

           @Override
            protected void onPreExecute() 
           {
               super.onPreExecute();
               Utils.ShowProgressDialog();

           }

           @Override
           protected Void doInBackground(String... arg0)
           {

            try 
            {

                      //your json parsing code...
            } 
            catch (Exception e) 
            {
             e.printStackTrace();
            }

            return null;
           }

           @Override
           protected void onPostExecute(Void result)
           {
               super.onPostExecute(result);

            try
            {
                Utils.hideProgressDialog();
                list.setAdapter(mSchedule);
            }
            catch (Exception e)
            {
             Log.v("log", e.toString());
            }
           }

  } 
```

# php - Amazon S3 API 没有存储桶错误

> ID：13494389
> 
> 赞同：0
> 
> 时间：2012-11-21T13:30:05.773
> 
> 标签：php, api, amazon-s3

以下是来自 Amazon S3 API 文档的示例代码。

```
$s3 = new AmazonS3();
$bucket = 'my-bucket' . strtolower($s3->key);

$response = $s3->create_object($bucket, 'prefix with spaces with spaces.txt', array(
    'body' => 'This is my body text.'
));

// Success?
var_dump($response->isOK()); 
```

这在实时站点上有效，但在本地主机上，后者给出了一个错误，提示找不到存储桶

```
$s3 = new AmazonS3();
   $bucket = 'my-bucket';

  $response = $s3->create_object($bucket, 'prefix with spaces with spaces.txt', array(
    'body' => 'This is my body text.'
)); 
```

  // 成功？

但删除 `. strtolower($s3->key);` 作品

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T05:30:32.277

Amazon S3 区分大小写。因此，对于 Bucket 和 Object，如果您将名称更改为大写或小写，它会给您不同的结果。

表示如果 Bucket Name 有一些大写字母，并且您的代码将它的名称更改为小写，那么它将返回您 Bucket Does No Exist 之类的消息。

因此，请确保 Amazon S3 中存在实际存储桶和对象名称。

# php - 删除空格/新行/注释。正则表达式？

> ID：13494391
> 
> 赞同：-1
> 
> 时间：2012-11-21T13:30:14.980
> 
> 标签：php, regex, preg-replace, preg-match

我目前正在制作一种 CSS 缩小器，我认为我想要实现的示例是最简单的解释方式。

我正在尝试改变它：

```
/* CSS Content */

.class{
    text-align:center;
    border-bottom:1px solid #ccc;
}

.anotherclass, .another, .another{
    text-align:center;
    border-bottom:1px solid #ccc;
} 
```

进入：

```
.class{text-align:center;border-bottom:1px solid #ccc;}.anotherclass,.another,.another{text-align:center;border-bottom:1px solid #ccc;} 
```

因此：删除`comments`、 不必要`whitespace`的 和`new lines`。

到目前为止，我必须删除注释和新行（使用一个表达式和一个函数在 上爆炸字符串`\n`，然后附加部分）。`whitespaces`有点困难，因为应该删除`whitespaces`里面的而不是和之间的。`{}``colon``semicolon`

由于我对正则表达式的使用非常缺乏经验，因此手头没有好的参考书，而且谷歌似乎也没有答案：我想知道这里是否有人可以帮助我创建一个好的正则表达式来实现这一点。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:45:59.767

我想你可以尝试这样的事情：

```
(?<=[{};])\s+|\/\*.+?\*\/ 
```

[http://rubular.com/r/djDtEPzEV0](http://rubular.com/r/djDtEPzEV0)

清除括号、分号和所有注释前面的空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:54:17.747

如果您必须这样做，那么这将缩小您给出的示例：

```
(/\*[^/]+\*/|^\t*|^\s*|\n|\s+(?=[\{.])|(?<=[\{;])\s+) 
```

它假设您使用的正则表达式的风格允许积极的后视

# javascript - 如何在不提交表单的情况下获取 javascript 中输入字段的值？

> ID：13494394
> 
> 赞同：3
> 
> 时间：2012-11-21T13:30:32.757
> 
> 标签：javascript, jquery, ajax, input-field

我对javascript相当陌生，并且有一个关于如何在不提交表单的情况下获取输入字段的值的问题。我有以下一小段代码，我将其与实时验证脚本结合使用来验证字段。

```
<form name="FormName" method="post" />
    <input type="text" id="nameValidation" value="HelloWorld" />
    <script type="text/javascript">
       var NameValue = document.forms["FormName"]["nameValidation"].value;
    </script>
</form> 
```

我希望 var NameValue 成为您在输入字段中键入的值，以便我可以在验证后出现的消息中使用它。当我在不提交表单的情况下更改输入字段的值时，var NameValue 仍设置为“HelloWorld”。在做了一些研究之后，我发现我可以使用 jQuery 和它的函数 serialize() 来解决它。有没有办法在没有 jQuery 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T13:31:40.773

没有 jQuery ：

```
var value = document.getElementById('nameValidation').value; 
```

您拥有的语法可用于通过其名称而不是其 ID 获取输入。

如果您想要在更改时使用此值，您可以这样做：

```
var nameValidationInput = document.getElementById('nameValidation');
function useValue() {
    var NameValue = nameValidationInput.value;
    // use it
    alert(NameValue); // just to show the new value
}
nameValidationInput.onchange = useValue;  
nameValidationInput.onblur = useValue; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:46:21.280

您的代码有效。它将输入字段的值分配给 var `NameValue`。您解释的内容和[JQuery`serialize`](http://api.jquery.com/serialize/)的作用是两件不同的事情。

您需要做的就是将您的代码分配给正确的事件：

```
<form name="FormName" method="post" />
    <input type="text" id="nameValidation" value="HelloWorld" onchange="myFunction()"/>

</form>
<script type="text/javascript">
function myFunction(){
    var NameValue = document.forms["FormName"]["nameValidation"].value;
    alert(NameValue);
}
</script> 
```

​<a href="http://jsfiddle.net/QtLaX/1/" rel="nofollow">查看 JSFiddle。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:32:16.923

使用 onchange 或 onblur 事件调用此代码：

var NameValue = document.forms["FormName"]["nameValidation"].value;

这样当光标离开文本框时它就会被激活

```
<input type="text" id="nameValidation" value="HelloWorld" onblur="changeVal();" />

<script type="text/javascript">

    function changeVal() {
        var NameValue = document.forms["FormName"]["nameValidation"].value;
alert(NameValue);
    }
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T13:34:42.147

您可以让客户端代码响应文本框值的更改，如下所示：

```
$(document).ready(function(){
    $("#nameValidation").on('change', function() {
        var value = $("#nameValidation").value;
        //do your work here
    }
}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T13:36:36.510

在您的示例中，该变量仅获取当时分配给它的值。文本框更新时它不会更新。您需要触发一个函数 [onchange 或 onblur 或 keypress] 并将变量重置为新值。

```
<form name="FormName" method="post" />
    <input type="text" id="nameValidation" value="HelloWorld" />
    <script type="text/javascript">
         var myTextbox = document.getElementById("nameValidation");
         var nameValue = myTextbox.value;
         myTextbox.onchange = function() {
             nameValue = myTextbox.value;
         };
    </script>
</form> 
```

# c++ - 通知 GUI 对象有关屏幕大小的信息 - 设计

> ID：13494398
> 
> 赞同：1
> 
> 时间：2012-11-21T13:30:49.440
> 
> 标签：c++, oop, design-patterns, game-engine

我在为我创建的游戏设计类时遇到问题。

在我的应用程序中，有：

*   包含有关游戏本身的所有信息的类`CGame`，例如屏幕宽度、屏幕高度等。在`main()`函数中，我创建了一个指向`CGame`实例的指针。
*   `CGUIObject`包含指定其位置和方法的字段的 类`draw()`，它应该知道如何根据屏幕大小绘制对象。
*   类`CGUIManager`，它是一个单例，它包含一个 `CGUIObject`'s 列表。对于列表中的每个对象，它只调用`draw()` 方法。

为了清楚起见，我将放一些简单的代码：

```
class CGame
{  
   int screenWidth;
   int screenHeight;
};

class CGUIObject
{
   CPoint position;
   void draw();     // this one needs to know what is a screen's width and height
};

class CGUIManager   // it's a singleton
{
   vector<CGUIObject*> guiObjects;
   void drawObjects();
}; 
```

和 main.cpp：

```
CGame* g;

int main()
{
   g = new CGame();

   while(1)
   {
      CGUIManager::Instance().drawObjects();
   }

   return 0;
} 
```

现在的问题是，每个人都`CGUIObject`需要知道由 持有的屏幕大小，但我发现在每个对象`CGame`中包含指向实例的指针非常愚蠢。`CGame`

请任何人告诉我实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:49:54.580

您是否有理由需要您的屏幕分辨率`CGUIObject`？

它们已经有了一个位置，所以如果你让它们在本地空间中绘制自己，你可以在你的空间中对它们应用一个变换`CGUIManager`来布置它们。您可以通过这种方式从 GUI 对象本身中抽象出您的布局，并且对象不需要知道它们所在的容器（屏幕、窗口、选项卡等）。

# ruby-on-rails-3 - 无法更新rails中的整数字段

> ID：13494399
> 
> 赞同：0
> 
> 时间：2012-11-21T13:30:51.420
> 
> 标签：ruby-on-rails-3, sqlite

好吧，我只是不明白这里有什么问题

我有这个应用程序，用户由管理员批准，直到几天前它工作正常

在我看来，我有一个调用我的用户控制器的链接

```
<%= link_to 'Approve', active_user_path(user), :method => :put %> 
```

这是我对该链接的自定义路线

```
match "users/:id/activate" => "users#activate", :as => "active_user" 
```

现在在我的用户控制器中我有这个激活方法

```
def activate
  @user = User.find(params[:id])

  puts @user.name #the correct name is displayed
  puts @user.is_approved.inspect.to_i #:is_approved is 0

  if @user.update_attribute(:is_approved, 1) 

  puts @user.is_approved.inspect # :is_approved is 1

  @user.activate_user

  puts @user.is_approved.inspect # :is_approved is 1

  @user.save!

  redirect_to "/users?is_approved=0"

  else
   render "/" # dosn't matter
  end 
end 
```

我尝试在这里保存 3 次（更新、激活用户、保存！）但仍然不会保存值，用户`is_approved`字段仍然是 0，这怎么可能？

这是我的模型方法

```
def activate_user
  self.is_approved = 1
  self.save
end 
```

顺便说一句，我可以用这种方法更新字符串，但不能更新整数（true 和 false dosnt 都可以）

在我的模型中，我`is_approved`同时拥有 attr_accessible 和 attr_accessor

**解决方案**

好吧，这很尴尬，但是碰巧在我的用户模型`attr_accessor :approved` 中，这导致该模型从未进入数据库来更新`:approved`列，而是更新了局部变量`:approved`，因此下次当我查看该列时，当然`:approved`价值没有改变

tldr？如果您的模型中有 attr_accessor 与您尝试更新的列同名 => 删除它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:32:29.637

永远不要`attr_accessor`在由数据库列支持的属性上使用 - 生成的访问器`attr_accessor`将屏蔽存储在数据库中的值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:31:05.043

[update_attribute](http://apidock.com/rails/ActiveRecord/Persistence/update_attribute "更新属性")实际上不仅仅是更新单个列：

*   验证被跳过。

*   调用回调。

*   如果该列可用，则更新 updated_at/updated_on 列。

*   更新此对象中所有脏的属性。

您的用户模型中是否有任何回调？确保该列没有在回调中的某处更新。

# sdk - 无法使用 Safari 下载 Adob e AIR SDK

> ID：13494403
> 
> 赞同：0
> 
> 时间：2012-11-21T13:31:03.243
> 
> 标签：sdk, air

在我的 Mac Book Pro 上，您无法使用 Safari 从 Adob​​e 站点下载 Adob​​e AIR SDK。

几个月来我发现这是真的。

[http://www.adobe.com/devnet/air/air-sdk-download.html](http://www.adobe.com/devnet/air/air-sdk-download.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:31:03.243

请改用 Firefox 下载 Adob​​e AIR SDK。有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T17:13:04.540

这是 Adob​​e 服务器的问题，今天（2013 年 4 月 18 日）仍在发生。它不会向浏览器发送适当的二进制内容类型，因此 Safari 会尝试在浏览器中显示 200 MB 的大 tbz2 文件，就好像它是纯文本文件一样。这会导致 Safari 停止并显示“旋转的死亡沙滩球”，在某些情况下甚至会使操作系统无响应，让您别无选择，只能按住电源按钮几秒钟来关闭计算机。这是 Safari 部分的糟糕编码。大文本文件（即使在这种情况下它们不是真正的文本文件）不应该让浏览器和操作系统崩溃。

尽管这是 Adob​​e 没有发送适当的内容类型的错，但 Safari 可以像 Firefox 一样即时解决这个问题（即使内容类型不正确，它也会检测二进制文件）。但事实并非如此，因此会出现这个问题。

请在此错误库报告中投票，以便 Adob​​e 修复此问题： [https ://bugbase.adobe.com/index.cfm?event=bug&id=3544775](https://bugbase.adobe.com/index.cfm?event=bug&id=3544775)

# wicket - Wicket 测试错误：组件“BookmarkablePageLink”不是类型

> ID：13494411
> 
> 赞同：0
> 
> 时间：2012-11-21T13:31:27.550
> 
> 标签：wicket

我创建了一个链接页面 FooPage，这样当有人点击这个链接时，一些文本`"test test"`会显示给用户，到目前为止还不错。

我创建了以下基本页面：

FooPage.java

```
public class FooPage extends WebPage {
public FooPage() {
    add(new Label("label", "test test"));
        }   } 
```

FooPage.html

```
<div wicket:id="label"></div> 
```

在 MyPnel.java 我添加创建的页面如下：

我的面板.java

```
 public class MyPanel extends Panel{
add(new  BookmarkablePageLink<Void>("foobar", FooPage.class));
} 
```

MyPanel.html：

```
<a wicket:id="foobar" href="FooPage"></a> 
```

现在，当我使用 junit 测试创建的组件时，如下所示：

```
 @Test
 public void startPage() {
  wicketTester.assertComponent("foobar", FooPage.class);
} 
```

我收到以下错误：

> junit.framework.AssertionFailedError：组件“BookmarkablePageLink”不是类型：FooPage

知道什么是问题或解决这个问题的热点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:33:50.650

正如 Ian 已经说过的，`assertComponent`检查组件的类型是否是类的子类型。对于您的用例，您应该使用

```
wicketTester.assertBookmarkablePageLink("foobar", FooPage.class, new PageParameters()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T15:21:55.470

你不应该尝试吗

```
wicketTester.assertComponent("foobar", BookmarkablePageLink.class); 
```

而是（因为 ID“foobar”的组件是类型`BookmarkablePageLink`）？

# python - 在python中将十六进制转换为字节

> ID：13494413
> 
> 赞同：0
> 
> 时间：2012-11-21T13:31:31.147
> 
> 标签：python

我想显示号码

```
0x40000000 
```

作为

```
01000000 00000000 00000000 00000000 
```

前导 0 和上面的格式

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:36:04.280

也许不是最灵活的方式，但是：

```
>>> num = 0x40000000
>>> bits = bin(num)[2:].zfill(32)
# '01000000000000000000000000000000'
>>> ' '.join(bits[i:i+8] for i in xrange(0, 32, 8))
'01000000 00000000 00000000 00000000' 
```

嗯，因为我的宽带断了，不能早点发帖，但稍微灵活一点的版本......

```
def fmt_bin(num):
    bits = bin(num)[2:]
    blocks, rem = divmod(len(bits), 8)
    if rem:
        blocks +=1
    filled = bits.zfill(blocks * 8)
    return ' '.join(''.join(el) for el in zip(*[iter(filled)]*8)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:45:56.377

这将处理任意大的正数：

```
def long2str(n):
    if n == 0:
        return '00000000'
    s = []
    while n > 0:
        s.append('{:08b}'.format(n & 255))
        n = n >> 8
    return ' '.join(s[::-1])

num = 0x40000000
bignum = 0x4000000040000000
print long2str(num)
print long2str(bignum) 
```

输出：

```
01000000 00000000 00000000 00000000
01000000 00000000 00000000 00000000 01000000 00000000 00000000 00000000 
```

# php - 无法捕获 BadMethodCallException

> ID：13494415
> 
> 赞同：4
> 
> 时间：2012-11-21T13:31:40.733
> 
> 标签：php, exception, try-catch, fatal-error

这是我的代码的一部分：

```
// ... code ...
$action = self::defineAction( $request->getPath() );
try {
    $response = Controller::$action( $request );
} catch( \BadMethodCallException $exception ) {
    Logger::logError( $exception );
    $response = new NotFoundResponse();
}
// ... code ... 
```

如果由于某种意外没有实现具有已定义名称的控制器的操作或名称定义错误，我会尝试捕获异常。

但是我没有捕获异常，而是在 Apache 的错误日志中得到了致命错误：

```
PHP Fatal error:  Call to undefined method app\\Controller::testingAction() ... 
```

如果我尝试在控制器的现有（已定义和可调用）操作中调用未定义的方法，我也无法捕获上述异常 - 而是发生致命错误：

```
PHP Fatal error:  Call to undefined method app\\SomeClass::someUndefinedMethod() in /********/Controller.php on line *** ... 
```

用“\Exception”替换“\BadMethodCallException”没有任何效果：我一直在获取致命错误。

将“try-catch”块放在控制器的每个动作中对我来说不是可接受的解决方案。

为什么不能以这种方式捕获异常？我怎么解决这个问题？

我正在运行 PHP 5.3.8。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:43:30.540

Catch 块只能捕获*抛出*的异常，不能捕获错误。`Call to undefined method`是一个错误，您需要对此进行测试并自己抛出异常。[请参阅此处](https://stackoverflow.com/questions/841500/php-exceptions-vs-errors)了解异常和错误之间的区别。

您可以通过执行以下操作来测试方法是否存在：

```
if( !method_exists('app\Controller', 'testingAction') ) {
    throw new \BadMethodCallException();
} 
```

# c - 对使用 fopen 打开的文件进行 ftruncate

> ID：13494417
> 
> 赞同：3
> 
> 时间：2012-11-21T13:31:51.793
> 
> 标签：c, linux

平台是 ARM 上的 Ubuntu Linux。我想将字符串写入文件，但我希望每次都截断文件然后写入字符串，即不追加。

我有这个代码：

```
f=fopen("/home/user1/refresh.txt","w");
fputs( "{"some string",f);
fflush(f);
ftruncate(fileno(f),(off_t)0);
flcose(f); 
```

如果我运行它然后检查文件，它的长度为零，打开时，里面什么都没有。如果我删除`fflush`呼叫，它将不是 0（将是 11），当我打开它时，其中会有“一些字符串”。这是正常行为吗？我调用没有问题`fflush`，但我想在循环中执行此操作，调用`fflush`可能会大大增加执行时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T13:38:33.340

您不应该像那样真正混合文件句柄和文件描述符调用。

如果没有 fflush，几乎可以肯定的是，它`some string`正在文件句柄缓冲区中等待传递给文件描述符。然后截断文件描述符并关闭文件句柄，刷新字符串，因此它显示在文件中。

*使用*fflush，`some string`将其发送到文件描述符，*然后*将其截断。在没有进一步刷新的情况下，文件将保持截断状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T14:43:44.977

POSIX 要求您在使用 FILE 流和文件描述符来访问同一个打开的文件之间切换时采取特定的操作（确保缓冲的丑陋副作用不会使您的程序失控）。这在[XSH 2.5.1 Interaction of File Descriptors and Standard I/O Streams 中有描述](http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_05_01)。

在你的情况下，我相信就像你正在做的那样，在`fflush`之前打电话就足够了。`ftruncate`根据 2.5.1 的规则，省略此步骤会导致未定义的行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T13:36:02.103

如果您想从字面上“截断文件然后写入”，则足以：

```
f=fopen("/home/user1/refresh.txt","w");
fputs("some string",f);
fclose(f); 
```

以模式打开文件`w`将截断它（与`a`用于追加到末尾的模式相反）。

同时调用`fclose`将刷新输出缓冲区，因此不会丢失数据。

# android - 从 IntentService 构造函数打开数据库连接

> ID：13494419
> 
> 赞同：2
> 
> 时间：2012-11-21T13:32:02.230
> 
> 标签：android, sqlite, service

当试图通过正常机制打开数据库连接时，`nullpointerexecption`会抛出a `dbhelper.getWritableDatabase`。

问题似乎源于`IntentService`我传入的上下文。

```
 public AnalysisService() {
    super("AnalysisService");
    Log.d("ANALYSIS_SERVICE", "Service started");
    try{
    db = new DBAdapter(this)
    db.openDB();
    }catch(Exception e){
        Log.d("ANALYSIS_SERVICE", Arrays.toString(e.getStackTrace()));
        Log.e("ANALYSIS_SERVICE", e.toString());
    }
} 
```

该`db.open`方法在这里执行：

```
public class DBAdapter implements Database {

protected Context context;
protected SQLiteDatabase db;
private DatabaseHelper dbHelper;

public DBAdapter(Context context) {
    this.context = context;
    Log.e("DB_ADAPTER", "CREATED");
}

/**
 * Opens a database connection.
 * @return
 * @throws SQLException
 */
@Override
public DBAdapter openDB() throws SQLException {
    dbHelper = new DatabaseHelper(context);
    db = dbHelper.getWritableDatabase(); //NULLP EXCEPTION THROWN HERE
    return this;
} 
```

如果它对`dbHelper`is 的构造函数有帮助：

```
 public DatabaseHelper(Context context) {
    super(context, DATABASE_NAME, null, DATABASE_VERSION);
    Log.e("DB_HELPER", "created");
} 
```

这让我在最后一天感到困惑，所以我不明白为什么上下文是无效的。此外，我还记录了所有构造函数，并且所有对象都被正确创建，因此 DBHelper 并非为空。

除了像这样使用上下文之外，我还尝试使用`getBaseContext()`and `getApplicationContext()`，两者都导致相同的错误。

从调试打印堆栈跟踪，我得到：

```
 11-21 13:23:45.419: D/ANALYSIS_SERVICE(3930): 
[android.content.ContextWrapper.openOrCreateDatabase(ContextWrapper.java:221), 
android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:166), 
com.emotifi.database.DBAdapter.openDB(DBAdapter.java:42), 
com.emotifi.analysis.AnalysisService.<init>(AnalysisService.java:45),
 java.lang.Class.newInstanceImpl(Native Method), 
java.lang.Class.newInstance(Class.java:1319), 
android.app.ActivityThread.handleCreateService(ActivityThread.java:2234), 
android.app.ActivityThread.access$1600(ActivityThread.java:123), 
android.app.ActivityThread$H.handleMessage(ActivityThread.java:1201), 
android.os.Handler.dispatchMessage(Handler.java:99), 
android.os.Looper.loop(Looper.java:137), 
android.app.ActivityThread.main(ActivityThread.java:4424), 
java.lang.reflect.Method.invokeNative(Native Method), 
java.lang.reflect.Method.invoke(Method.java:511), 
com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:817), 
com.android.internal.os.ZygoteInit.main(ZygoteInit.java:584), 
dalvik.system.NativeStart.main(Native Method)] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T13:49:55.517

您在生命周期中过早地设置上下文`IntentService`。

覆盖`onCreate`并将其设置在那里：

```
@Override
public void onCreate() {
    super.onCreate();
    Log.d("ANALYSIS_SERVICE", "Service started");
    db = DatabaseFactory.getDefault(this);
} 
```

然后打开数据库连接`onHandleIntent`：

```
@Override
protected void onHandleIntent(Intent intent) {
    // Logging
    Log.d("ANALYSIS_SERVICE", "Intent handled");

    try {
        db.openDB();
    } catch (Exception e) {
        Log.d("ANALYSIS_SERVICE", "Unable to open database");
        e.printStackTrace();
    }
} 
```

# java - 在地图视图叠加层中为路径段使用不同的颜色

> ID：13494424
> 
> 赞同：0
> 
> 时间：2012-11-21T13:32:21.697
> 
> 标签：java, android

我的应用程序可以使用 JSON 提供路径/方向。如何在 JSON 给出的路径中更改不同的颜色？

例如，从 A 点到 B 点为红色，B 到 C 为黄色，C 到 D 为绿色，以此类推。

代码是：

在 JSON 中获取积分。

```
 private void parsing(GeoPoint start, GeoPoint end) throws ClientProtocolException, IOException, JSONException, URISyntaxException{
    HttpClient httpclient = new DefaultHttpClient();
    StringBuilder urlstring = new StringBuilder();
    urlstring.append("https://maps.googleapis.com/maps/api/directions/json?origin=")
    .append(Double.toString((double)start.getLatitudeE6()/1E6)).append(",").append(Double.toString((double)start.getLongitudeE6()/1E6)).append("&destination=")
    .append(Double.toString((double)end.getLatitudeE6()/1E6)).append(",").append(Double.toString((double)end.getLongitudeE6()/1E6))
    .append("&sensor=false");
    //urlstring.append("http://maps.googleapis.com/maps/api/directions/json?origin=Toronto&destination=Montreal&sensor=true");
    url = new URI(urlstring.toString());

    HttpPost httppost = new HttpPost(url);

    HttpResponse response = httpclient.execute(httppost);
    HttpEntity entity = response.getEntity();
    InputStream is = null;
    is = entity.getContent();
    BufferedReader reader = new BufferedReader(new InputStreamReader(is, "iso-8859-1"), 8);
    StringBuilder sb = new StringBuilder();
    sb.append(reader.readLine() + "\n");
    String line = "0";
    while ((line = reader.readLine()) != null) {
        sb.append(line + "\n");
    }
    is.close();
    reader.close();
    String result = sb.toString();
    JSONObject jsonObject = new JSONObject(result);
    JSONArray routeArray = jsonObject.getJSONArray("routes");
    JSONObject routes = routeArray.getJSONObject(0);
    JSONObject overviewPolylines = routes.getJSONObject("overview_polyline");
    String encodedString = overviewPolylines.getString("points");
    List<GeoPoint> pointToDraw = decodePoly(encodedString);

    //Added line:
    mv_mapview.getOverlays().add(new RoutePathOverlay(pointToDraw));
} 
```

JSON 给出的地理点列表。

```
 private List<GeoPoint> decodePoly(String encoded) {

    List<GeoPoint> poly = new ArrayList<GeoPoint>();
    int index = 0, len = encoded.length();
    int lat = 0, lng = 0;

    while (index < len) {
        int b, shift = 0, result = 0;
        do {
            b = encoded.charAt(index++) - 63;
            result |= (b & 0x1f) << shift;
            shift += 5;
        } while (b >= 0x20);
        int dlat = ((result & 1) != 0 ? ~(result >> 1) : (result >> 1));
        lat += dlat;

        shift = 0;
        result = 0;
        do {
            b = encoded.charAt(index++) - 63;
            result |= (b & 0x1f) << shift;
            shift += 5;
        } while (b >= 0x20);
        int dlng = ((result & 1) != 0 ? ~(result >> 1) : (result >> 1));
        lng += dlng;

        GeoPoint p = new GeoPoint((int) (((double) lat / 1E5) * 1E6), (int) (((double) lng / 1E5) * 1E6));

        //n = new Node(p,);

        poly.add(p);

    }

    return poly;
} 
```

和覆盖类

```
 public class RoutePathOverlay extends Overlay {

private int _pathColor;
private final List<GeoPoint> _points;
private boolean _drawStartEnd;

public RoutePathOverlay(List<GeoPoint> points) {

    this(points, Color.GREEN, true);
}

public RoutePathOverlay(List<GeoPoint> points, int pathColor, boolean drawStartEnd) {
        _points = points;
        _pathColor = pathColor;
        _drawStartEnd = drawStartEnd;
}

private void drawOval(Canvas canvas, Paint paint, Point point) {
        Paint ovalPaint = new Paint(paint);
        ovalPaint.setStyle(Paint.Style.FILL_AND_STROKE);
        ovalPaint.setStrokeWidth(2);
        int _radius = 6;
        RectF oval = new RectF(point.x - _radius, point.y - _radius, point.x + _radius, point.y + _radius);
        canvas.drawOval(oval, ovalPaint);               
}

public boolean draw(Canvas canvas, MapView mapView, boolean shadow, long when) {
        Projection projection = mapView.getProjection();
        if (shadow == false && _points != null) {
                Point startPoint = null, endPoint = null;
                Path path = new Path();
                //We are creating the path
                for (int i = 0; i < _points.size(); i++) {
                        GeoPoint gPointA = _points.get(i);
                        Point pointA = new Point();
                        projection.toPixels(gPointA, pointA);
                       //if() 
                        if (i == 0) { //This is the start point
                                startPoint = pointA;
                                path.moveTo(pointA.x, pointA.y);
                        } else {
                                if (i == _points.size() - 1)//This is the end point
                                        endPoint = pointA;
                                path.lineTo(pointA.x, pointA.y);
                        }
                }

                Paint paint = new Paint();
                paint.setAntiAlias(true);
               // if(){
                paint.setColor(_pathColor);
               //}
                paint.setStyle(Paint.Style.STROKE);
                paint.setStrokeWidth(5);
                paint.setAlpha(90);
                if (getDrawStartEnd()) {
                        if (startPoint != null) {
                                drawOval(canvas, paint, startPoint);
                        }
                        if (endPoint != null) {
                                drawOval(canvas, paint, endPoint);
                        }
                }
                if (!path.isEmpty())
                        canvas.drawPath(path, paint);
        }
        return super.draw(canvas, mapView, shadow, when);
}

public boolean getDrawStartEnd() {
        return _drawStartEnd;
}

public void setDrawStartEnd(boolean markStartEnd) {
        _drawStartEnd = markStartEnd;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T08:47:55.477

你只是在解码`overview_polyline`。

行程的每一部分（`steps`响应 JSON 中的数组）定义为

```
{
    distance: {
        text: "89 m",
        value: 89
    },
    duration: {
        text: "1 min",
        value: 8
    },
    end_location: {
        lat: 45.51101000000001,
        lng: -73.5545
    },
    html_instructions: "Enter <b>Rue Saint Antoine E</b>",
    polyline: {
        points: "cvwtG~d}_MaBs@s@W"
    },
    start_location: {
        lat: 45.51026,
        lng: -73.55488000000001
    },
    travel_mode: "DRIVING"
}, 
```

如您所见，每个步骤都有一条折线。您是否尝试过解码单个步骤，将它们存储在一个数组中，然后可视化每个部分（为旅行的每个部分使用不同的颜色）？这将为您提供旅行“部门”的解决方案，但这可能是一个很好的起点。

或者您可以尝试为每个部分生成一个数组`overview_polyline`（因为它由点定义，您可以创建单线：如果您的折线通过 A、B、C 和 D 槽，您可以定义 3 段 AB BC CD）。

我不知道这（生成并可视化包含很多片段的叠加层）会影响性能，因为我从未以这种方式使用过 Maps API（我用它来获取 ETA 进行一些旅行）所以我只是猜测：D

# django - Web服务器和应用服务器可以分开开发吗？

> ID：13494425
> 
> 赞同：0
> 
> 时间：2012-11-21T13:32:22.533
> 
> 标签：django, web

我的朋友用C++开发了一个推荐系统，现在我们想根据他的工作做一个网络信息系统。由于我们都没有网络技术知识，所以我有一些问题：

1.  如果我们想开发一个基于这个推荐系统的网站，我们应该在应用服务器中实现推荐系统，并制作一个可以返回页面的Web服务器，对吗？
2.  那么我们应该使用什么Web服务器或者使用什么技术开发一个Web服务器来调用推荐系统中的功能呢？Web 服务器如何与应用程序服务器通信？
3.  一些 Web 框架，例如 Django，它是作为 Web 服务器还是应用程序服务器，还是两者兼而有之？

由于我们有很多基本问题，您有什么书籍或网站可以推荐吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-16T20:24:51.117

您可以将 C++ 应用程序视为 Django 应用程序可以执行以向用户返回值的服务。您可以轻松地在与 Django 相同的服务器上执行任何应用程序并捕获响应，或者您可以创建一个精简的 HTTP API 并将您的 C++ 应用程序放在它自己的服务器上，然后从您的 Django 应用程序通过 HTTP 调用它来为您的用户发出请求。

[https://www.djangoproject.com/](https://www.djangoproject.com/)是一个很好的起点。

# object - “初始范围”和“要求”有什么区别？

> ID：13494429
> 
> 赞同：1
> 
> 时间：2012-11-21T13:32:33.570
> 
> 标签：object, architecture, scope, orientation, requirements

感谢您抽出宝贵时间提前阅读本文。

我正在为我正在重新设计的项目编写中间提交报告，我的导师想要一个页面摘要、需求列表（带有理由）、初始范围和建议的架构。

主要报告将包括分析、设计和实施。

除了初始范围之外，我已经写了所有内容。我真的很担心我会重复自己，我不确定我的要求和初始范围之间应该有什么区别？

下面是一个需求示例：

> 主菜单上的第一个选项将是“新游戏”</p>
> 
> 当前系统：用户会自动进入新游戏，但仅限完成此游戏，然后才能开始新游戏。
> 
> 新系统：如果用户不想完成当前游戏，开始新游戏的选项将为他们提供更大的灵活性。游戏的默认级别从“低”开始，除非用户更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T18:00:36.243

**初始范围**定义了项目的边界，概括地说，将包括什么以及从项目或阶段中排除什么。 **需求**定义了这些广泛笔划的详细需求。通常，在确定边缘之前，项目无法捕获其需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T22:50:48.713

要求是从正在进行的游戏开始新游戏。

项目遇到麻烦的地方在于限制范围。

例如，此要求是否包括：

*   能够回到原来的游戏并从你离开的地方开始吗？
*   当你在第二场比赛时能够开始第三场比赛
*   当在第三场比赛中能够进入第一场而不经过第二场
*   ......

范围说明了系统的哪些部分将受到影响以及如何解决。

初始范围将是您将在第一个版本中提供的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T10:58:51.093

这几乎是一样的：

**根据通用定义，要求**代表系统为满足业务需求或合同义务而必须做的事情。
**初始范围**是将/希望在第一个版本中交付或当前计划的功能/产品。

# jquery - jQuery .slideToggle()

> ID：13494430
> 
> 赞同：1
> 
> 时间：2012-11-21T13:32:34.547
> 
> 标签：jquery, html, slidetoggle

我在 JQuery 中使用 slideToggle() 来显示一个 div。但这不起作用。

我做了不同的测试，但没有任何效果......

我有这个 ：

```
<div class="domaine">
<a>1\. Compétences Scientifiques Transversales</a>
<br>
<div class="ssdomaine" style="display: none;">
    <a>1.1\. Sciences et techniques</a>
    <br>
    <div class="competence" style="display: none;">
        <a href="#">1.1.1\. Génie thermique et thermodynamique</a>
        <br>
    </div>
</div> 
```

这里只是一个包含单个“ssdomaine”的“domaine”，其中包含一个“competence”

但是我在一个数据库中提出了一个请求，该请求可以向我发送多个包含多个“ssdomaine”的“domaine”，其中包含多个“ssdomaine”。

我想制作一个 .slideToggle() 而不指定任何 id。

我的 JQuery 代码是：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<script>
$(document).ready(function() {
   $('.ssdomaine').hide();
    $('.competence').hide();
   $('.domaine a').click(function() {
      $(this).next('.ssdomaine').slideToggle(1000);
      return false;
   });
   $('.ssdomaine a').click(function() {
          $(this).next('.competence').slideToggle(1000);
          return false;
    });
 });
</script> 
```

我在这个链接中尝试了同样的方法：http: [//jsfiddle.net/6GRJr/168/](http://jsfiddle.net/6GRJr/168/)

它正在工作，但它只发生在 domaine、ssdomaine 和能力的一次出现上。

任何想法 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:37:55.907

它与`height`，看看这个小提琴[http://jsfiddle.net/6GRJr/169/](http://jsfiddle.net/6GRJr/169/)

**更新**

它不显示的原因`competence`是因为它在您加载表单时是隐藏的，而当您`slideToggle`在`ssdomaine`它上面进行操作时，它`ssdomaine`只会显示而不是权限

**更新**

这应该做到[http://jsfiddle.net/6GRJr/172/](http://jsfiddle.net/6GRJr/172/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-17T15:40:00.393

jQuery 的 slideToggle() 充其量是错误的。幸运的是，HTML5 中有一个新功能可以在没有 JavaScript 的情况下提供此功能！

查看新的 HTML5 标记：

[http://www.w3schools.com/tags/tag_details.asp](http://www.w3schools.com/tags/tag_details.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:18:09.953

`.next`仅查看直接兄弟，添加选择器仅检查该元素是否与选择器匹配，这`.nextAll('.selector')` 是可行的方法，但将返回元素集合，因此您可能希望使用限制集合`.first()`

```
$(document).ready(function() {
   $('.ssdomaine').hide();
    $('.competence').hide();
   $('.domaine a').click(function() {
      // next only looks at the immediate sibling, which in you code is a <br />
      //$(this).next('.ssdomaine').slideToggle(1000);

      // this would open all elements
      $(this).nextAll('.ssdomaine').slideToggle(1000); 
```

或者

```
 // this would open this first instance of .ssdomaine
      $(this).nextAll('.ssdomaine').first().slideToggle(1000);

      return false;
   });
   $('.ssdomaine a').click(function() {
          $(this).next('.competence').slideToggle(1000);
          return false;
    });
 }); 
```

# jakarta-ee - Apache Mina SSHD 服务器：无可用会话

> ID：13494433
> 
> 赞同：1
> 
> 时间：2012-11-21T13:32:40.550
> 
> 标签：jakarta-ee, apache-mina

我正在使用 Apache Mina SSHD 编写 SSH 服务器。服务器启动正常，但是当我尝试连接到服务器时，出现“无可用会话”异常。这是服务器的代码：

```
SshServer sshd = SshServer.setUpDefaultServer();
sshd.setPort(port);

PasswordAuthenticator auth = new PasswordAuthenticator() {
     public boolean authenticate(String string, String string1, ServerSession ss) {
         return true;
     }   
};
sshd.setPasswordAuthenticator(auth);
sshd.setKeyPairProvider(new SimpleGeneratorHostKeyProvider("hostkey.ser"));
sshd.start(); 
```

这是我尝试连接到服务器时得到的结果：

```
134 [com.ssh.Startup.main()] INFO org.apache.sshd.common.util.SecurityUtils - Trying to register BouncyCastle as a JCE provider
454 [com.ssh.Startup.main()] INFO org.apache.sshd.common.util.SecurityUtils - Registration succeeded
3845 [NioProcessor-2] INFO org.apache.sshd.server.session.ServerSession - Session created from /127.0.0.1:50426
3879 [NioProcessor-2] WARN org.apache.mina.core.filterchain.DefaultIoFilterChain - Unexpected exception from exceptionCaught handler.
java.lang.IllegalStateException: No session available
    at org.apache.sshd.common.AbstractSessionIoHandler.exceptionCaught(AbstractSessionIoHandler.java:52)
    at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.exceptionCaught(DefaultIoFilterChain.java:697)
    at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextExceptionCaught(DefaultIoFilterChain.java:483)
    at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$1100(DefaultIoFilterChain.java:46)
    at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.exceptionCaught(DefaultIoFilterChain.java:791)
    at org.apache.mina.core.filterchain.IoFilterAdapter.exceptionCaught(IoFilterAdapter.java:111)
    at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextExceptionCaught(DefaultIoFilterChain.java:483)
    at org.apache.mina.core.filterchain.DefaultIoFilterChain.fireExceptionCaught(DefaultIoFilterChain.java:471)
    at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionCreated(DefaultIoFilterChain.java:359)
    at org.apache.mina.core.filterchain.DefaultIoFilterChain.access$700(DefaultIoFilterChain.java:46)
    at org.apache.mina.core.filterchain.DefaultIoFilterChain$EntryImpl$1.sessionCreated(DefaultIoFilterChain.java:771)
    at org.apache.mina.core.filterchain.IoFilterAdapter.sessionCreated(IoFilterAdapter.java:79)
    at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionCreated(DefaultIoFilterChain.java:357)
    at org.apache.mina.core.filterchain.DefaultIoFilterChain.fireSessionCreated(DefaultIoFilterChain.java:350)
    at org.apache.mina.core.service.IoServiceListenerSupport.fireSessionCreated(IoServiceListenerSupport.java:211)
    at org.apache.mina.core.polling.AbstractPollingIoProcessor.addNow(AbstractPollingIoProcessor.java:521)
    at org.apache.mina.core.polling.AbstractPollingIoProcessor.handleNewSessions(AbstractPollingIoProcessor.java:488)
    at org.apache.mina.core.polling.AbstractPollingIoProcessor.access$400(AbstractPollingIoProcessor.java:67)
    at org.apache.mina.core.polling.AbstractPollingIoProcessor$Processor.run(AbstractPollingIoProcessor.java:1103)
    at org.apache.mina.util.NamePreservingRunnable.run(NamePreservingRunnable.java:64)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.NoSuchMethodError: org.slf4j.Logger.isTraceEnabled()Z
    at org.apache.sshd.common.session.AbstractSession.encode(AbstractSession.java:436)
    at org.apache.sshd.common.session.AbstractSession.writePacket(AbstractSession.java:349)
    at org.apache.sshd.common.session.AbstractSession.sendKexInit(AbstractSession.java:693)
    at org.apache.sshd.server.session.ServerSession.sendKexInit(ServerSession.java:336)
    at org.apache.sshd.server.session.ServerSession.<init>(ServerSession.java:92)
    at org.apache.sshd.server.session.SessionFactory.doCreateSession(SessionFactory.java:43)
    at org.apache.sshd.common.session.AbstractSessionFactory.createSession(AbstractSessionFactory.java:38)
    at org.apache.sshd.common.AbstractSessionIoHandler.sessionCreated(AbstractSessionIoHandler.java:37)
    at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.sessionCreated(DefaultIoFilterChain.java:643)
    at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionCreated(DefaultIoFilterChain.java:357)
    ... 14 more 
```

知道服务器可能出了什么问题吗？感谢所有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:39:17.707

看起来你的类路径中有一个不兼容的 SLF4J 版本：

```
Caused by: java.lang.NoSuchMethodError: org.slf4j.Logger.isTraceEnabled()Z 
```

# spring - 使用 AspectJ 的 Spring 事务

> ID：13494436
> 
> 赞同：0
> 
> 时间：2012-11-21T13:32:49.287
> 
> 标签：spring, aop, aspectj, transactional

我在 Spring 中遇到了 @Transaction 的问题。基本上，不会使用以下消息创建事务：

由于没有正在进行的交易而延迟身份插入

我在 Spring AOP 论坛中对问题进行了完整描述

[http://forum.springsource.org/showthread.php?132612-Transaction-management](http://forum.springsource.org/showthread.php?132612-Transaction-management)

任何建议将不胜感激！

斯特凡诺

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T17:11:02.553

找到了解决方案。

问题出在配置中。我添加了两个元素`context:spring-configured`，`context:load-time-weaver`这意味着两个不同的东西。第一个激活 AspectJ**编译时**编织（我不明白），第二个激活 AspectJ**加载时间编织**。我认为这两个元素不能很好地协同工作。

我决定使用编译时编织器，并且（经过一番挣扎......）我发现（显然）外部 jar 没有用这种配置编织，仅仅是因为它们尚未构建。

最简单的解决方法是修改节点`aspectj-maven-plugin`下（在POM.xml中）添加的配置`configuration`：

```
`<weaveDependencies>`
`<weaveDependency>`
`<groupId>GROUP-ID</groupId>`
`<artifactId>ARTIFACT-ID</artifactId>`
`</weaveDependency>`
`</weaveDependencies>` 
```

对于您需要编织的每个工件。

现在交易工作正常！

@Ralph：非常感谢您抽出宝贵时间！

问候，

斯特凡诺

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:44:43.220

在您的代码中，您已经定义了这样的服务：

```
@Service
@Configurable
public class ServiceImpl<T> implements Service<T> {
@Override
@Transactional
public T save(T entity) {
          ....
    }
} 
```

我不知道你为什么使用`@Configurable`注释。如果您不需要它们（*也就是说，如果您不通过 new 创建此服务的实例*），我会删除它们。

*原因是我记得spring文档说`@Configurable`启用注入，但它没有说任何关于启用的加载时间编织支持`@Configurable`*

# signalr - 在信号器中使用连接的最佳设计是什么

> ID：13494437
> 
> 赞同：0
> 
> 时间：2012-11-21T13:32:53.333
> 
> 标签：signalr

我对使用信号器的软件设计有一些疑问，

通常我从这段代码开始：

```
 var connection = $.hubConnection();
   var notifier = connection.createHubProxy('notifier');
      connection.start()
          .done(function () {
              //alert('connection was succesful');
              // your event handlers
              }); 
```

***更新的问题*** 如果您有一个仅使用 signalR 广播消息的通用单击事件处理程序，并且此事件处理程序位于单独的 javascript 文件中（在当前连接的上下文之外）：

我应该在外部脚本中打开连接吗？还是应该将代理的引用（已连接）发送到外部脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:01:55.293

当您的页面不需要连接时，您不应该打开一个。

# powershell - 如何在 ps1 脚本中清除 $msg.to 的值？

> ID：13494438
> 
> 赞同：0
> 
> 时间：2012-11-21T13:32:55.583
> 
> 标签：powershell

我有一个用于自动通知用户 AD 密码过期的脚本。VPN用户需要它。但我找不到解决 $msg.to 字段问题的方法。例如，它不能接受 "$msg.to = ''" 并且只能通过 $msg.to.add 方法工作。这使得情况不太好，当首先收到通知的用户将收到所有下一封电子邮件，因为它们将被添加到字符串的末尾，但不会替换 $msg.to 中的所有数据

有一个代码：

```
Import-Module ActiveDirectory

#SMTP server name
$smtpServer = "mail.domain.local"

#Creating a Mail object
$msg = new-object Net.Mail.MailMessage
$msgr = new-object Net.Mail.MailMessage

#Creating SMTP server object
$smtp = new-object Net.Mail.SmtpClient($smtpServer)

#E-mail structure
Function EmailStructure($to,$expiryDate,$upn)
{
    $msg.IsBodyHtml = $true
    $msg.From = "notification@domain.com"
    $msg.To.Add($to)
    $msg.Subject = "Password expiration notice"
    $msg.Body = "<html><body><font face='Arial'>This is an automatically generated message from Exchange service.<br><br><b>Please note that the password for your account <i><u>Domain\$upn</u></i> will expire on $expiryDate.</b><br><br>Please change your password immediately or at least before this date as you will be unable to access the service without contacting your administrator.</font></body></html>"
}

Function EmailStructureReport($to)
{
    $msgr.IsBodyHtml = $true
    $msgr.From = "notification@domain.com"
    $msgr.To.Add($to)
    $msgr.Subject = "Script running report"
    $msgr.Body = "<html><body><font face='Arial'><pre><b>This is a daily report.<br><br>Script has successfully completed its work.<br>$NotificationCounter users have recieved notifications:<br><br>$ListOfAccounts<br><br></b></pre></font></body></html>"
}

#Set the target OU that will be searched for user accounts
$OU = "OU=Organisation,DC=domain,DC=local"

$ADAccounts = Get-ADUser -LDAPFilter "(objectClass=user)" -searchbase $OU -properties PasswordExpired, extensionAttribute15, PasswordNeverExpires, PasswordLastSet, Mail, Enabled | Where-object {$_.Enabled -eq $true -and $_.PasswordNeverExpires -eq $false}
$NotificationCounter = 0
$ListOfAccounts = ""

Foreach ($ADAccount in $ADAccounts)
{
 $accountFGPP = Get-ADUserResultantPasswordPolicy $ADAccount

                if ($accountFGPP -ne $null)
        {
                 $maxPasswordAgeTimeSpan = $accountFGPP.MaxPasswordAge
        }
        else
        {
                 $maxPasswordAgeTimeSpan = (Get-ADDefaultDomainPasswordPolicy).MaxPasswordAge
                }

#Fill in the user variables
    $samAccountName = $ADAccount.samAccountName
    $userEmailAddress = $ADAccount.ExtensionAttribute15
    $userPrincipalName = $ADAccount.UserPrincipalName

    if ($ADAccount.PasswordExpired)
    {
     Write-host "The password for account $samAccountName has expired!"
    }
    else
    {
     $ExpiryDate = $ADAccount.PasswordLastSet + $maxPasswordAgeTimeSpan
     $TodaysDate = Get-Date
     $DaysToExpire = $ExpiryDate - $TodaysDate
     $DaysToExpireDD = $DaysToExpire.ToString() -Split ("\S{17}$")
     Write-host "The password for account $samAccountName expires on: $ExpiryDate. Days left: $DaysToExpireDD"
        if (($DaysToExpire.Days -eq 15) -or ($DaysToExpire.Days -eq 7) -or ($DaysToExpire.Days -le 3))
        {
         $expiryDate = $expiryDate.ToString("d",$ci)
#Generate e-mail structure and send message
            if ($userEmailAddress)
            {
             EmailStructure $userEmailAddress $expiryDate $samAccountName
             $smtp.Send($msg)
             Write-Host "NOTIFICATION - $samAccountName :: e-mail was sent to $userEmailAddress"
             $NotificationCounter = $NotificationCounter + 1
             $ListOfAccounts = $ListOfAccounts + $samAccountName + "&#9; - $DaysToExpireDD days left.<br>"
            }
        }

    }
}
Write-Host "SENDING REPORT TO IT DEPARTMENT"
EmailStructureReport("itdepartment@domain.com")
$smtp.Send($msgr) 
```

每次发送电子邮件后，如何在 $msg.to 中删除字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:57:42.160

如果您想重复使用相同的邮件但更改地址并多次发送到不同的地址，请使用MailAddressCollection 上的[clear方法。](http://msdn.microsoft.com/en-us/library/system.net.mail.mailaddresscollection.aspx)

所以你的代码看起来像这样：

```
$msg.To.Clear()
$msg.To.Add($to) 
```

# c - 在 C 中使用通过引用传递的矩阵加法

> ID：13494445
> 
> 赞同：-2
> 
> 时间：2012-11-21T13:33:26.673
> 
> 标签：c

我目前的作业有问题，要求我们创建一个使用传递引用解决矩阵问题的程序，我只是不明白它是如何完成的。有人可以向我展示一个使用传递引用解决矩阵加法的简单代码。谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:40:38.030

假设我们定义了 mat4_t 类型和 mat4_add 函数。

```
typedef ... mat4_t; 
```

使用“复制”方法将如下所示：

```
mat4_t mat4_add(mat4_t m1, mat4_t m2);
mat4_t m1, m2, m3;
m3 = mat4_add(m1, m2); 
```

函数 mat4_add 接受 2 个参数并返回新矩阵（通过副本）。

使用“通过引用”它将是：

```
void mat4_add(mat4_t *sum, const mat4_t *m1, const mat4_t *m2);
mat4_t m1, m2, m3;
mat4_add(&m3, &m1, &m2); 
```

函数接收指向源矩阵 (m1, m2) 的指针和指向应该存储矩阵总和的内存的指针。

* * *

第一种方法： m1 和 m2 都被复制到函数堆栈，因此堆栈增长 2*sizeof(mat4_t) 并且矩阵数据被复制。之后，函数栈又增长了一个 sizeof(mat4_t) 来存储计算结果。当从函数返回值分配值时，该结果将使用 return 语句再次复制。

另一方面，对于“通过引用”的指针，无需应对。这种方法更快（不需要副本）并且内存效率更高。

此外，在 C 中没有像引用复制这样的东西。一切都是按值传递的。 [在 C 中通过引用传递时会发生什么？](https://stackoverflow.com/questions/12953496/what-happens-during-pass-by-reference-in-c/12953708#12953708)

# doctype - 浮动图表文档类型问题

> ID：13494447
> 
> 赞同：1
> 
> 时间：2012-11-21T13:33:34.410
> 
> 标签：doctype, flot

我有一个 Flot 图表问题。当我使用推荐的 DOCTYPE 时，图表不显示。但是，如果我删除 DOCTYPE，它就会完美显示。

我正在使用 excanvas.js。这是我的 DOCTYPE：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
```

我尝试了许多其他 DOCTYPES，但无济于事。

我没有正确使用 excanvas.js 吗？我将其与其他所有内容一起调用：

```
<script src="../flot/jquery.flot.js"></script>
<script src="../flot/jquery.flot.resize.js"></script>
<script src="../flot/excanvas.min.js"></script>
<link href="../flot/layout.css" rel="stylesheet" type="text/css"> 
```

谢谢大家！

# javascript - 使用支持多个号码的正则表达式验证电话号码

> ID：13494455
> 
> 赞同：1
> 
> 时间：2012-11-21T13:34:07.367
> 
> 标签：javascript, regex, validation

我对正则表达式不是很有经验，我需要使用 javascript 验证电话号码。我有一个文本框，需要允许接受多个带有分隔符的电话号码，`';'`并且电话号码可以使用的字符是

1.  数字
2.  '+'
3.  '-'

有人可以帮助我如何使用 javascript 和正则表达式/正则表达式来实现这一点吗？

例子：

> +91-9743574891；+1-570-456-2233；+66-12324576

我尝试了以下方法：

```
^[0-9-+;]+$ 
```

我不确定这是否正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:38:39.530

你放`-`错了地方，所以你`regex`不工作。

试试这个（你的正则表达式，但稍作修改）：

```
^[0-9+;-]+$ 
```

或者

```
^[-0-9+;]+$ 
```

要在字符类中包含连字符，您必须执行以下操作之一：

1.  ***转义连字符并使用`\-`,***
2.  ***将连字符放在字符类的开头或结尾。***

因为连字符用于指定字符范围。因此，正则表达式引擎理解`[0-9-+;]+`匹配`0`to `9`、`9`to之间的任何字符`+`（所有字符都具有十进制代码点`57`[char `9`] 到`43`[char `+`] 并且它失败）和`;`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T13:39:51.533

这个怎么样`^([0-9\-\+]{5,15};?)+$`

**解释：**

```
^          #Match the start of the line
[0-9\-\+]  #Allow any digit or a +/- (escaped)
{5,15}     #Length restriction of between 5 and 15 (change as needed)
;?         #An optional semicolon
+          #Pattern can be repeat once or more
$          #Until the end of the line 
```

*只有指定的限制才能更严格，请参阅[此处](http://rubular.com/r/we7t4wsxbb)的工作。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:40:46.600

为了更具限制性，您可以使用以下正则表达式：

```
/^\+[0-9]+(-[0-9]+)+(;\+[0-9]+(-[0-9]+)+)*$/ 
```

它将匹配什么：

```
+91-9743574891
+1-570-456-2233;+66-12324576 
```

不匹配的内容：

```
91-9743574891
+15704562233
6612324576 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T13:41:51.847

您的正则表达式将与您允许的匹配，但我会更具限制性：

```
^\+?[0-9-]+(?:;\+?[0-9-]+)*$ 
```

[在 Regexr 上](http://regexr.com?32sql)查看

That means match an optional "+" followed by a series of digits and dashes. Then there can be any amount of additional numbers starting with a semicolon, then the same pattern than for the first number.

# php - MYSQL 全文搜索按相关性排序

> ID：13494460
> 
> 赞同：9
> 
> 时间：2012-11-21T13:34:32.427
> 
> 标签：php, mysql, sql-order-by, relevance

我试图让我的全文搜索按相关性排序。如果删除 ORDER BY 但不按相关性排序，这是我的代码。我已经尝试过了，它实际上做到了，所以它根本找不到任何结果......有什么想法吗？

```
$query_for_result=mysql_query("
     SELECT * FROM Assets WHERE MATCH 
    (`Badge`,`First Name`,`Last Name`,`Service Tag`,`Asset Tag`)
     AGAINST ('".$query."*' IN BOOLEAN MODE) and
   `deleted` = '0'  ORDER BY relevance DESC"); 
```

编辑*

```
<input type="text" name="query" />
<input type="hidden" value="Search" name="submit" />
<input type="submit" name="submit" value="Search" />

</form>
<h4>Search by: Badge, First or Last Name, Service Tag, Asset Tag, Printer Queue or Printer IP.</h4>
<br>
</center>

<?php

if(isset($_GET['submit'])){

$db_tb_name=Assets;
$db_tb_atr_name=`First Name`;

$query=mysql_real_escape_string($_GET['query']);

$query_for_result=mysql_query("
 SELECT * FROM Assets WHERE MATCH 
(`Badge`,`First Name`,`Last Name`,`Service Tag`,`Asset Tag`)
 AGAINST ('".$query."*' IN BOOLEAN MODE) and
`deleted` = '0'  ORDER BY relevance DESC"); 
```

然后在代码中

```
while($data_fetch=mysql_fetch_array($query_for_result))
{

print '<h3>';   
print "<a href=\"modify.php?id=" . $data_fetch['id'] . "\">" . $data_fetch['First Name']  . ' ' . $data_fetch['Last Name'] . "</a>";
print '<br/><b>Badge:</b> '. $data_fetch['Badge'];
print '<br/> <b>Service Tag:</b> '. $data_fetch['Service Tag'];
print ' <b>Asset Tag:</b> '. $data_fetch['Asset Tag'];
print '<br/> <b>Status:</b> '. $data_fetch['Status'];
print '<br/><b>Employee Status: </b>';
    if( $data_fetch['Employee Status'] == 'Active' ){
print '<font color="#32CD32">' . $data_fetch['Employee Status'] . '</font>';
    }
elseif( $data_fetch['Employee Status'] == 'Terminated' ){
print '<font color="red">' . $data_fetch['Employee Status'] . '</font>';}
print '<br/> <b>Last Modified:</b> '. $data_fetch['Last Modified'];
print "<span> </span>";
print '</h3>';
print '<br/><p>' ; 

} 
```

*更新* 这对我有用，我终于通过使用它来工作了

```
$query_for_result=mysql_query("SELECT  *, MATCH 
(`Badge`,`First Name`,`Last     Name`,`Service Tag`,`Asset Tag`) 
AGAINST ('".$query."'IN BOOLEAN MODE) AS Relevance FROM Assets WHERE 1 AND MATCH 
(`Badge`,`First Name`,`Last Name`,`Service Tag`,`Asset Tag`)
AGAINST ('".$query."' IN BOOLEAN MODE) and
 `deleted` = '0' ORDER BY Relevance DESC "); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T13:41:30.523

来自[MySQL 布尔全文搜索文档](http://dev.mysql.com/doc/refman/5.0/en/fulltext-boolean.html)：

> 它们不会自动按照相关性递减的顺序对行进行排序。从前面的查询结果可以看出：相关性最高的行是两次包含“MySQL”的行，但它是最后列出的，而不是第一个。

这就解释了为什么没有`ORDER BY`. 现在为了能够通过 订购`relevance`，您需要定义它：

```
SELECT *, MATCH (`Badge`,`First Name`,`Last Name`,`Service Tag`,`Asset Tag`) as relevance
WHERE MATCH AGAINST ('".$query."*' IN BOOLEAN MODE) and `deleted` = '0'
ORDER BY relevance DESC 
```

# java - 使用 Apache Commons VFS 通过 FTP URI 导航到根目录

> ID：13494466
> 
> 赞同：2
> 
> 时间：2012-11-21T13:34:48.260
> 
> 标签：java, apache-commons, jsch, apache-commons-vfs

我不知道如何从根目录引用文件。目前，URI 中的任何路径都是用户目录的子目录。我正在尝试通过以下方式访问 /var/www ：

```
sftp://user:password@host/var/www 
```

但它是无效的。

```
org.apache.commons.vfs2.FileNotFolderException: Could not list the contents of "sftp://user:***@host/var/www" because it is not a folder. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T11:25:20.250

我找到了解决方案。

```
SftpFileSystemConfigBuilder builder = SftpFileSystemConfigBuilder.getInstance();
FileSystemOptions options = new FileSystemOptions();
builder.getKnownHosts(options);
builder.setUserDirIsRoot(options, false);
builder.setTimeout(options, 5000);

FileObject directory = manager.resolveFile("sftp://user:password@host/var/www", options); 
```

# actionscript-3 - AS3 Flash CS6如何在不同场景中使用同一个变量？

> ID：13494473
> 
> 赞同：0
> 
> 时间：2012-11-21T13:35:22.580
> 
> 标签：actionscript-3, flash, variables, scene

我`var num:Number;`在场景 1 中有这个。我想在场景 2 中使用它，但我不知道该怎么做。

抱歉，我是新手，我不知道如何正确查看文档。

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:08:23.090

一种可能的解决方案是声明一个包含静态变量的类。

```
public class StaticVars {
    public static var num:Number=0;
    public function StaticVars() {}
} 
```

然后，您可以使用`StaticVars.num`. 您可以根据需要在单个类中容纳尽可能多的变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-01T23:41:27.887

您可以使用共享对象。

在场景 1 中；

```
var soScene1= SharedObject.getLocal("nums");
soScene1.data.num = num; 
```

在场景 2 中；

```
var soScene2= SharedObject.getLocal("nums");
var num2 = soScene2.data.num; 
```

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/SharedObject.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/SharedObject.html)

# asp.net-mvc-4 - Visual Studio 2012 没有为 ASP.NET MVC4 项目选择最新编译的 TypeScript

> ID：13494477
> 
> 赞同：2
> 
> 时间：2012-11-21T13:35:40.240
> 
> 标签：asp.net-mvc-4, visual-studio-2012, typescript

如何强制 Visual Studio 2012 始终使用由 TypeScript 创建的生成的 JavaScript 文件的最新版本？

我在我的项目文件中使用以下定义：

```
<Target Name="BeforeBuild">
    <Exec Command="&quot;$(PROGRAMFILES)\Microsoft SDKs\TypeScript\0.8.0.0\tsc&quot; -out scripts\app.js scripts\app.ts  -target ES5 @(TypeScriptCompile ->'&quot;%(fullpath)&quot;', ' ')" IgnoreExitCode="true" />
  </Target> 
```

当我清理和重建项目时，app.js 会相应更新。

但是，出于某种奇怪的原因，当我尝试使用 Internet Explorer 调试解决方案时，Visual Studio 使用的是过时版本的 app.js，这会使我的断点无效。

这里发生了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T17:16:01.590

这里最可能的问题不是真正的 TypeScript 或 JavaScript - Internet Explorer 只是缓存 JavaScript 文件并使用过时的版本。

如果您正在引用单个脚本，您可以通过更改 URI 的任意部分来缓存它：

```
<script src="myscript.js?1"></script> 
```

如果每次要替换缓存版本时增加 1，则会导致加载新脚本。您可以通过转储时间戳代替 1 来自动执行此操作。

如果您使用的是我在 MVC4 中推荐的捆绑，则捆绑器将附加脚本的哈希值，其作用相同。

# ios - ARC NSMutableArray 池

> ID：13494481
> 
> 赞同：0
> 
> 时间：2012-11-21T13:35:48.960
> 
> 标签：ios, automatic-ref-counting

我有一个对象池，我保存在 NSMutableArray 中，所以如果任何其他对象想要引用它们而不是创建新对象，我只需给它一个对我已经创建的对象的引用。

过去，我会监视对这些对象的保留/释放调用，当它们的保留计数达到 1（仅限我的数组）时，我会将它们从数组中删除。但是我正在努力使用 ARC 来做到这一点，因为它不允许我监控保留/释放，我将如何去做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:57:11.627

创建一种基于释放/保留调用来管理对象的方法，这是很危险的。如果苹果碰巧改变了它的工作方式，那你就完蛋了。显然，当您开始使用 ARC 时，情况就是如此。有两件事：

`NSMutableArray`1）如果它们是否被其他对象使用，您希望将对象独立保留在内部。在这种情况下，只需创建`__weak`对该对象的引用，这样您的对象（位于 内部`NSMutableArray`）就会保持活动状态。

2）一旦没有对该对象的引用，只需将其从`NSMutableArray`. 添加到`NSMutableArray`a`__weak`对象。一旦`strong`一个被释放，阵列内的一个也会被释放，虽然我不太喜欢这种方法，因为我觉得它很危险。如果您选择此选项，请使用它来存储对象：

```
NSValue *weakObject = [NSValue valueWithNonretainedObject:anObject];
[array addObject:weakObject]; 
```

最后，您可以简单地从该特定文件中删除 ARC，并且可以继续监控。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:37:53.360

首先，您应该编写简单的代码，供人类使用。

在您（通过仪器或其他措施）证明这是一个关键瓶颈之前，不要担心此类性能问题。

也就是说，创建某些对象可能非常昂贵，因此为某些对象保留缓存本身并不是一个坏主意。但是，您永远不应该依赖引用计数，即使在非 ARC 代码中也是如此。苹果文档对此非常清楚。

正如 Jacky 指出的那样，替代方案是一个弱参考。不幸的是，您不能将`weak`引用放入标准集合中（尽管具有讽刺意味的是，您可以将它们放入 C++ 集合中并且它们将被正确管理）。

但是，您可以创建一个简单的包装类来保存弱引用。

```
@interface WeakWrapper : NSObject
@property (readonly) id object;
- (id)initWithObject:(id)object;
@end

@implementation WeakWrapper {
    __weak id _object;
}
- (id)object {
    return _object;
}
- (id)initWithObject:(id)object {
    if (self = [super init]) {
        _object = object;
    }
    return self;
}
@end 
```

然后，您可以将这些对象放在集合中，然后...

```
WeakWrapper *wrapper = // get the object from the collection
id object = wrapper.object;
if (nil == object) {
    // You know the object that was being referenced no longer exists
    // so this wrapper can be removed from the collection and destroyed.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:46:11.980

我不会为如此复杂的系统而烦恼。只使用强属性和弱属性，不要试图猜测性能。您正在尝试自己构建一个内存管理系统，这对 ARC 来说意义不大。创建和删除对象通常只占任何 Objective-c 应用程序性能的一小部分；经过多年使用 Instruments 监控性能后，我不再担心这部分了。

# android - 活动销毁时再次调用 onStart 时的服务

> ID：13494487
> 
> 赞同：2
> 
> 时间：2012-11-21T13:36:07.120
> 
> 标签：android, android-intent, android-service

我有一个 android 服务，在 onStart 方法中，我从 Intent 活动中获取了许多字符串，然后执行 AsynTask 以从 Internet 下载文件。

当活动运行时，这可以正常工作，但是当我停止活动时，这会重新启动 onStart 方法，但显然意图是 null 导致我出现 nullPointerException。

我可以做什么服务不要在 onStart 上输入，并继续第一个 asyntask 以下载所有文件？

这是我的代码

```
 @Override
    public void onStart(Intent intent, int startId) {
        desde = intent.getIntExtra("desde", 0);
        hasta = intent.getIntExtra("hasta", 1);
        email = intent.getStringExtra("email");
        password = intent.getStringExtra("password");

        new DescargaFotos().execute();

    }

@Override
    public IBinder onBind(Intent intent) {

        return null;
    } 
```

在 Inicio.java 中（UI 活动）

```
Intent iService = new Intent(contexto,

    ServiceDownloader.class);
                            iService.putExtra("desde", 0);
                            iService.putExtra("hasta", 5);
                            iService.putExtra("email", email);
                            iService.putExtra("password", password);
                            startService(iService); 
```

**编辑：**

新问题：

我正在使用 IntentService 并像这样绑定服务：

```
Intent iService = new Intent(contexto,
                                ServiceDownloader.class);

                        ServiceConnection serviceConector = new ServiceConnection() {

                            @Override
                            public void onServiceDisconnected(ComponentName name) {
                                Log.i("INFO", "Service bound ");
                            }

                            @Override
                            public void onServiceConnected(ComponentName name,
                                    IBinder service) {
                                Log.i("INFO", "Service Unbound ");
                            }
                        };

                        iService.putExtra("desde", 0);
                        iService.putExtra("hasta", 50);
                        iService.putExtra("email", email);
                        iService.putExtra("password", password);
                        startService(iService);
                        bindService(iService, serviceConector,
                                Context.BIND_AUTO_CREATE); 
```

现在我的问题是，在我的银河系关系中，如果我进入应用程序运行时列表并销毁我的应用程序，服务停止，停止下载，停止发送通知等？我必须如何绑定服务来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:41:51.903

使用 IntentService。IntentService 是专门为做你想做的事而设计的。您不必实现 onStart、onStartCommand 等。工作在后台线程上运行。一旦工作完成，线程就会被销毁。

无论 Activity 的状态如何，IntentService 都会继续运行。

您可能遇到的一个问题是您将 Intent 发送到 Activity 的错误位置，或者您没有检查操作是否完成。在发送 Intent 之前，检查 SharedPreferences 中的标志（如果标志不存在，则表示您是第一次开始）。当您发送 Intent 时，在 SharedPreferences 中存储一个标志以指示您发送了它。当您的 IntentService 收到 Intent 时，让它更新标志以表示它已收到它。在 IntentService 完成之前，让它再次更新标志。等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:10:56.187

我没有评论你的问题的声誉，所以我会写一个答案:)

首先，在我看来，如果您的服务只是这样做，从 Internet 获取一些字符串并下载文件，您就不需要该服务。AsyncTaks 足以解决您的问题，而且实现起来更简单。这样做，你可以避免你的意图问题。

[来自 Android API：](http://developer.android.com/reference/android/os/AsyncTask.html)

> AsyncTask 允许正确和轻松地使用 UI 线程。此类允许在 UI 线程上执行后台操作并发布结果，而无需操作线程和/或处理程序。

但是，如果您决定继续使用服务，我会确切知道您的活动中何时调用 startService。

如果您对何时使用 AsyncTask、Service、IntentService 和 Thread 有疑问，此**[链接](http://madhusudhanrc.blogspot.com.br/2012/05/difference-between-android.html)**可以帮助您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T18:27:31.053

这将是我的建议...

在服务中使用线程而不是 AsyncTask，因为 AsynTask 应该只用于小任务。[检查AsyncTask javadoc](http://developer.android.com/reference/android/os/AsyncTask.html)中的以下语句：

> AsyncTask 被设计为围绕[Thread](http://developer.android.com/reference/java/lang/Thread.html)和[Handler](http://developer.android.com/reference/android/os/Handler.html)的辅助类 ，并不构成通用线程框架。AsyncTasks 最好用于短时间的操作（最多几秒钟）。如果您需要保持线程长时间运行，强烈建议您使用 java.util.concurrent 包提供的各种 API，例如[Executor](http://developer.android.com/reference/java/util/concurrent/Executor.html)、[ThreadPoolExecutor](http://developer.android.com/reference/java/util/concurrent/ThreadPoolExecutor.html)和 [FutureTask](http://developer.android.com/reference/java/util/concurrent/FutureTask.html)。

所以从你开始检查你的线程的状态，如果它正在运行，那么不要做任何事情，如果它没有运行，那么启动将下载你的图像的线程......

# android - 用于 Multipart POST 请求的 Google-api-client

> ID：13494489
> 
> 赞同：1
> 
> 时间：2012-11-21T13:36:10.817
> 
> 标签：android, google-api, google-api-java-client, google-api-client

我将 google-api-client 用于 android。我尝试使用文本数据和图像文件进行多部分 POST 请求。创建请求的代码片段如下：

```
InputStream stream = new FileInputStream(fileToSend);
InputStreamContent photoContent = new InputStreamContent("image/jpeg", stream);
MultipartRelatedContent multiContent =
    new MultipartRelatedContent(content, photoContent); 
HttpRequest request = getRequestFactory().buildPostRequest(googleUrl, multiContent); 
```

content 是键值文本内容。结果我得到错误500。

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T17:01:17.970

这里有一个关于如何使用 google-api-java-client 进行媒体上传的指南：

[https://code.google.com/p/google-api-java-client/wiki/MediaUpload](https://code.google.com/p/google-api-java-client/wiki/MediaUpload)

也就是说，我的代码也不一定有任何问题。可能是 googleUrl 不正确，或者内容格式不正确。您可能想尝试添加 URL 查询参数 uploadType=multipart 以指定您使用 multipart 作为协议。

# javascript - 将 json 数据从 api 传递到 javascript 变量

> ID：13494490
> 
> 赞同：4
> 
> 时间：2012-11-21T13:36:23.267
> 
> 标签：javascript, json, api

我是 json/javascript 的新手，所以请多多包涵。我正在从加载某事的 api url 获取 json 数据

```
 {
"employees": [
{ "firstName":"John" , "lastName":"Doe" }, 
{ "firstName":"Anna" , "lastName":"Smith" }, 
{ "firstName":"Peter" , "lastName":"Jones" }
] 
```

我需要它作为脚本文件上的 javascript 变量

```
var employess={
"employees": [
{ "firstName":"John" , "lastName":"Doe" }, 
{ "firstName":"Anna" , "lastName":"Smith" }, 
{ "firstName":"Peter" , "lastName":"Jones" }
]
} 
```

试过了

```
$.getJSON(myUrl",function(data){ $("#selector").data("JSONP",data); alert(data); }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:45:44.627

将您的 JSON 字符串作为变量`var jsonString`

然后...

```
var myJsonObject = JSON.parse(jsonString); 
```

# .net - 为什么通过命令行还原包时 Nuget 随机崩溃？

> ID：13494491
> 
> 赞同：3
> 
> 时间：2012-11-21T13:36:28.180
> 
> 标签：.net, powershell, clr, nuget

我们不会将该`packages`文件夹提交到我们的存储库。此外，我们不是在构建时恢复包（因为它会增加构建时间），而是在克隆/签出新存储库时使用以下 PowerShell 模块恢复包：

```
$rootDir = resolve-path "$PSScriptRoot\.."
$nugetRoot = "$rootDir\.nuget"

$env:path += ";$nugetRoot"

function Restore-Packages() {

    $packageSources = @(
        "$nugetRoot",
        "$rootDir/db",
        "$rootDir/src",
        "$rootDir/test"
    )

    $packageSources | dir -r -include "packages.config" | % {
        $configPath = $_.FullName

        $configName = $configPath.Replace($rootDir.ToString() + "\", "")

        write-host "Installing packages for " -n
        write-host "$configName" -f "white"

        nuget install "$configPath" -solutionDir "$rootDir"
    }
}

Export-ModuleMember Restore-Packages 
```

这很好用......但不能随机*工作*！有时，所有包都正确加载，有时**随机** `package.config`文件会使 Nuget 崩溃！

没有错误消息打印到控制台（即使`-verbosity detailed`打开了 nuget.exe）。但是，我确实发现 EventLog 收到一条错误消息：

```
Log Name:      Application
Source:        Application Error
Date:          11/21/2012 9:21:42 AM
Event ID:      1000
Task Category: (100)
Level:         Error
Keywords:      Classic
User:          N/A
Description:
Faulting application name: NuGet.exe, version: 2.1.31022.9038, time stamp: 0x50856393
Faulting module name: clr.dll, version: 4.0.30319.239, time stamp: 0x4e181a6d
Exception code: 0xc0000005
Fault offset: 0x0035612d
Faulting process id: 0x408
Faulting application start time: 0x01cdc7eb24bed690
Faulting application path: D:\path\to\app\.nuget\NuGet.exe
Faulting module path: C:\Windows\Microsoft.NET\Framework\v4.0.30319\clr.dll
Report Id: 63343f50-33de-11e2-b0e1-005056c00008
Event Xml:
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Application Error" />
    <EventID Qualifiers="0">1000</EventID>
    <Level>2</Level>
    <Task>100</Task>
    <Keywords>0x80000000000000</Keywords>
    <TimeCreated SystemTime="2012-11-21T13:21:42.000000000Z" />
    <EventRecordID>77009</EventRecordID>
    <Channel>Application</Channel>
    <Security />
  </System>
  <EventData>
    <Data>NuGet.exe</Data>
    <Data>2.1.31022.9038</Data>
    <Data>50856393</Data>
    <Data>clr.dll</Data>
    <Data>4.0.30319.239</Data>
    <Data>4e181a6d</Data>
    <Data>c0000005</Data>
    <Data>0035612d</Data>
    <Data>408</Data>
    <Data>01cdc7eb24bed690</Data>
    <Data>D:\path\to\app\.nuget\NuGet.exe</Data>
    <Data>C:\Windows\Microsoft.NET\Framework\v4.0.30319\clr.dll</Data>
    <Data>63343f50-33de-11e2-b0e1-005056c00008</Data>
  </EventData>
</Event> 
```

因为这会默默地失败，所以其他`package.config`s 可能会在一个崩溃后运行，也可能不会运行（它也可能崩溃！）。

我已经多次重新启动计算机并清除了 Nuget 缓存，但无济于事。这是我机器的问题吗？是努格吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T09:23:49.960

我尝试运行你的脚本，它对我来说很好。我可能会尝试的一件事是将 nuget.exe 替换为从[http://nuget.org/nuget.exe重新下载](http://nuget.org/nuget.exe)

我会尝试的另一件事是，如果直接从命令行运行 nuget.exe 会崩溃吗？

希望能帮助到你。

# networking - Kademlia routing table and distance metric

> ID：13494498
> 
> 赞同：7
> 
> 时间：2012-11-21T13:37:06.493
> 
> 标签：networking, routing, p2p, dht, kademlia

Its been the first time I read about Kademlia today, and some points I don't think I got them right.

The distance between nodes and keys is the xor of their values.

So, if I have key x and node y, the distance between them is x xor y.

But why what is the point to bucket the nodes I know about and order them by the prefix length ? That doesn't seem to be connected directly with the xor of node IDs to find closests nodes to me ?

When I get a request for a value I search in the nodes in the closests buckets to me, that is the nodes which have the largest shared prefix with me, ie the first few buckets of the 160 buckets ?

or instead I check all nodes I know about in all the buckets and I calculate the xor between the key I am looking for, and those nodes IDs, and then send my request to the top k matches based on the xoring results with the key ID ?

Sorry I am a bit new to DHTs, and found the explanations online a bit not clear.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T14:53:14.733

I think I got it. The common prefix same bucket thing is indeed directly related to the xor values, so its indeed sorting them. I found those slides pretty helpful: [http://heim.ifi.uio.no/michawe/teaching/p2p-ws08/p2p-5-6.pdf](http://heim.ifi.uio.no/michawe/teaching/p2p-ws08/p2p-5-6.pdf)

# c++ - 为什么 qDebug 在发布版本中工作？

> ID：13494499
> 
> 赞同：24
> 
> 时间：2012-11-21T13:37:06.640
> 
> 标签：c++, qt, qdebug

来自 MFC，我`qDebug()`非常喜欢`TRACE()`，假设它是由预处理器从 Release 构建中删除的（在 MFC 中它是使用 完成的`#define TRACE 1 ? (void*) 0 : AfxTrace`）。

然而，令我惊讶的是，`qDebug()`它也在发布版本中执行。我该如何改变？而且，为什么会这样，Qt 开发者做出这个决定的原因是什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-21T13:47:31.700

`qDebug`也是预处理器控制的，但它有自己的特殊宏，`QT_NO_DEBUG_OUTPUT`. 如果您将其添加到您的发布版本定义中，它将被删除。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-11-21T13:51:54.263

QDebug 是“调试信息的输出流”。它的默认行为是根据消息类型打印到 stdout/stderr。您可以通过安装自己的消息处理程序轻松自定义 qDebug() 行为。例如，如果要打印调试，可以在运行时（而不是编译时）进行测试。看看这个代码示例：

```
#include <QDebug>

void noMessageOutput(QtMsgType type, const char *msg)
{
     Q_UNUSED(type);
     Q_UNUSED(msg);
}

int main(int argc, char * argv[])
{
    QApplication app(argc, argv);

    if ( ! app.arguments().contains(QLatin1String("--with-debug") ) {
        qInstallMsgHandler(noMessageOutput);
    }
} 
```

如果在运行时没有指定参数，它将隐藏整个 qDebug 输出。您可以获得更多的控制权，而不仅仅是“显示调试/不显示调试”

`QT_NO_DEBUG_OUTPUT`如果您担心代码中存在 qDebug 会导致性能下降，您也可以使用 define 完全禁用 QDebug 。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-02-10T12:12:34.033

Use this to suppress messages in release mode but allow them in debug mode:

```
CONFIG(release, debug|release):DEFINES += QT_NO_DEBUG_OUTPUT 
```

If you use only `DEFINES += QT_NO_DEBUG_OUTPUT` without the `CONFIG(...)` part you will disable them in both modes, which is usually not desirable.

# android - Dalvik 字节码跟踪器

> ID：13494504
> 
> 赞同：2
> 
> 时间：2012-11-21T13:37:28.460
> 
> 标签：android, runtime, bytecode, dalvik

如何在设备运行应用程序时获取正在执行的 dalvik 字节码的跟踪（就像 logcat 一样）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T19:00:37.467

没有现有的工具可以做你想做的事，但无需太多工作就可以实现这样的工具。

总体思路是你想连接dalvik的vm作为调试器，使用jdwp协议，单步虚拟机，检查每一步之间的状态，打印出指令。您应该能够获得...指令索引。或者可能是指令偏移量，通过 JDWP。

此外，您需要阅读 dex 文件，并根据从 JDWP 获得的指令索引/偏移量查找正在执行的确切指令。

你应该可以使用[AndBug](https://github.com/swdunlop/AndBug)来实现上述解决方案的第一部分，然后使用[dexlib](https://code.google.com/p/smali/source/browse/#git/dexlib)访问dex文件，以获取指令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:16:13.833

你可能想看看[`traceview`](http://developer.android.com/tools/debugging/debugging-tracing.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-11T04:17:22.473

不讲字节码追查方法实在是太慢了，当你想知道app在做什么的时候，最好的方法是先追查方法，然后追查其中的字节码。

# ios6 - 代码执行后禁用控件 XCode 4.5 iOS 6

> ID：13494506
> 
> 赞同：2
> 
> 时间：2012-11-21T13:37:32.810
> 
> 标签：ios6, xcode4.5

我创建了一个使用以下内容的应用程序：

SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook SLComposeViewController isAvailableForServiceType:SLServiceTypeTwitter

代码似乎可以正常工作，并将帖子发布到 Facebook 和 Twitter，但是一旦帖子完成，我返回应用程序视图，没有任何控件处于活动状态，我必须关闭应用程序并重新启动它们才能再次工作.

我想我在 IF 语句（下面发布）中嵌套了错误的代码，所以想知道是否有人可以提供任何建议。

我对 Xcode 等非常陌生，所以请耐心等待我 :-)

提前致谢

皮特

```
- (IBAction)postButton:(id)sender 
```

{ if ([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook])

```
{
    SLComposeViewController *facebook = [[SLComposeViewController alloc] init];

    ([SLComposeViewController isAvailableForServiceType:SLServiceTypeTwitter]);

    {
        SLComposeViewController *twitter = [[SLComposeViewController alloc] init];

        facebook = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook];
        [facebook setInitialText:[[self statusMessage]text]];

        twitter = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeTwitter];
        [twitter setInitialText:[[self statusMessage]text]];

        [self presentViewController:facebook animated:YES completion:nil];

        [facebook setCompletionHandler:^(SLComposeViewControllerResult result)

        {
            NSString *output;
            switch (result)
            {
                case SLComposeViewControllerResultCancelled:
                    output = @"Action Cancelled";
                    break;
                case SLComposeViewControllerResultDone:
                    output = @"Post Sucessfull";
                default:
                    break;
            }

            UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Facebook" message:output delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];
            [alert show];

            [self presentViewController:twitter animated:YES completion:nil];

            [twitter setCompletionHandler:^(SLComposeViewControllerResult result)

            {
                NSString *output;
                switch (result)

                {
                    case SLComposeViewControllerResultCancelled:
                        output = @"Action Cancelled";
                        break;
                    case SLComposeViewControllerResultDone:
                        output = @"Tweet Sucessfull";
                    default:
                        break;
                }

                UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Twitter" message:output delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];
                [alert show];

            }];
        }

         ];}
} 
```

}

# d3.js - D3 为什么我的数据没有更新？

> ID：13494509
> 
> 赞同：1
> 
> 时间：2012-11-21T13:37:36.937
> 
> 标签：d3.js

在这段代码中，[http ://enjalot.com/inlet/4124664/](http://enjalot.com/inlet/4124664/)

其中主要部分是：

```
 function render(data) {

        var nodz = svg.selectAll(".node")
            .data(data);

        nodz.enter().append("g")
            .attr("class", "node")
            .attr("id", function(d) { return "id"+d[0]+d[1]; })
            .attr("x",0)
            .attr("y", 0)
            .attr("transform", function(d) {
                return "translate(" + x(d[0]) + "," + y(d[1]) + ")";
            })
            .append("text")
            .attr("x", 0)
            .attr("y", 0)
            .attr("stroke", "black")
            .text(function(d) {return d[2]; });

        // update
        nodz.selectAll("text")
            .text(function(d) {
                return d[2]; });

        // another go
        d3.selectAll("text")
            .text(function(d) {
                return d[2]; });

     }

    // data in form [x pos, y pos, value to display]

    var nodes = [[0,0,0],[1,1,0],[1, -1,0],[2,0,0], [2,2,0]];
    render(nodes);

    nodes2 = [[0,0,1],[1,1,1],[1, -1,1],[2,0,1], [2,2,1], [2, -2,1]];
    render(nodes2); 
```

我调用代码两次绘制一些节点。

我希望它在第一遍中绘制五个值为零的节点，

然后我将另一个项目添加到列表中并将所有值更新为 1，因此希望看到所有值都更改为 1 并出现一个新节点。相反，我只看到最后一个设置为 1。我尝试添加一个唯一 id 以将节点绑定到数据，但这不起作用。还尝试重新选择以查看数据现在是否已绑定。在我经历过的所有教程中，只需调用 selectAll().data() 部分即可更新数据，我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:12:48.303

第二个可选参数`.data()`是一个告诉 d3 如何匹配元素的函数。那是您需要比较您的 ID 的地方，请参阅[文档](https://github.com/mbostock/d3/wiki/Selections#wiki-data)。也就是说，在您的情况下，它应该在没有 ID 的情况下工作，因为它默认按索引匹配。

更新文本的问题在于，在调用之后`.selectAll()`您需要`.data()`再次调用以让 d3 知道您想要与该选择匹配的内容（即新数据应该绑定到旧数据）。

# css - -ms-touch-action：没有损坏？

> ID：13494510
> 
> 赞同：0
> 
> 时间：2012-11-21T13:37:41.460
> 
> 标签：css, touch, internet-explorer-10

```
<meta name="viewport" content="user-scalable=no,"/>
<style type="text/css">
    html, *, body, div, table {
        -ms-touch-action:none !important;
    }
</style> 
```

以上是我试图让 IE 10 在每次客户快速按下页面上的相同位置时停止缩放的标记。我在 Windows 8 上使用 IE 10。这是我关心的唯一组合。我有几个问题：

1.  有没有办法禁用双击缩放？
2.  我必须使用 JavaScript 吗？
3.  我需要参考资料吗？
4.  这是一个IE错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T15:52:14.623

这似乎禁用了双击缩放：

-ms-内容缩放：无；

# java - JDBC - 将日期插入数据库会产生错误

> ID：13494514
> 
> 赞同：1
> 
> 时间：2012-11-21T13:37:55.320
> 
> 标签：java, jdbc, insert

尝试从 microsoft access 向我的数据库中插入日期时出现此错误

```
java.sql.SQLException: [Microsoft][ODBC Microsoft Access Driver] Undefined function 'to_date' in expression.
at sun.jdbc.odbc.JdbcOdbc.createSQLException(JdbcOdbc.java:6956)
at sun.jdbc.odbc.JdbcOdbc.standardError(JdbcOdbc.java:7113)
at sun.jdbc.odbc.JdbcOdbc.SQLExecute(JdbcOdbc.java:3148)
..... 
```

这是我使用的准备好的声明

```
addUserSt = con.prepareStatement("insert into Accounts(Username, First_name, last_name, gender, birthday, email, civil_status, password) "
                 + "values(?,?,?,?,to_date('17-January-97', 'DD-Month-RR'),?,?,?)"); 
```

这是我执行语句的方式.. dc 是一个对象。uname、fname、lname 等变量都是字符串。

```
 dc.addUserSt.setString(1, uname);
                dc.addUserSt.setString(2, fname);
                dc.addUserSt.setString(3, lname);
                dc.addUserSt.setString(4, gender);
                dc.addUserSt.setString(5, email);
                dc.addUserSt.setString(6, civil);
                dc.addUserSt.setString(7, pass);

                dc.addUserSt.executeUpdate(); 
```

我不知道为什么它说 to_date 函数是未定义的。谁能帮我解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:41:17.137

您需要使用该`CDate()`功能。这是 to_date() 的 Microsoft Access 版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T13:44:15.523

to_date 是一个 Oracle 函数。而是使用 CDate，即 Access 等效项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:27:02.787

该功能`to_date`是特定于 Oracle 的。由于您不是连接到 Oracle 而是连接到 Access，因此该功能不可用。不要使用特定于数据库的函数，而是考虑对日期和时间文字使用 JDBC 转义语法（如 JDBC 4.1 规范的 13.4.2 中所指定；每个 JDBC 驱动程序都应该支持这些）。对于以下日期：

```
{d 'yyyy-mm-dd'} 
```

因此，在您的具体示例中，您可以使用：

```
values(?,?,?,?,{d '1997-01-17'},?,?,?) 
```

使用转义是一种抽象数据库之间差异的方法。

# jquery - 让它发生在特定的 DIV 中

> ID：13494517
> 
> 赞同：0
> 
> 时间：2012-11-21T13:37:58.940
> 
> 标签：jquery

我有一个包含多个`DIV`元素的页面，每个元素都`DIV`包含两个表格。其中一个已经`display:none`设置，另一个（我们称之为第一个表）有一个下拉列表（`DDL`）。我想`fadeIn()`在指定的`DIV`地方隐藏表（在第一个表之上）我更改了 DDL 的值，然后再次显示第一个表：

```
function ChangeValueInDropDownList(ddl) {
    var id = $(ddl).closest(".divClass").prop("id"); //from this I get the ID which DIV
    $("#" + id).toggle(function () {
        $(".hiddentable").fadeIn(500, function () {
            $(".hiddentable").hide(1000);
        });
    });
} 
```

我尝试了几种解决方案，但均未成功。这是`DIV`完全隐藏指定的最后一个解决方案。我不知道是否有可能做这样的事情。也许我在错误的方向上走得太远了？

我真正想要的是，如果我`DDL`在指定的 中更改`DIV`，`DIV`则会用文本覆盖 2 秒，向用户显示*“的值`DDL`已更改”*。

我创建了一个链接，使其更明显：http: [//jsfiddle.net/XHuDc/171/](http://jsfiddle.net/XHuDc/171/)

# hadoop - 使用 s3distcp 和 Amazon EMR 复制单个文件

> ID：13494522
> 
> 赞同：6
> 
> 时间：2012-11-21T13:38:13.370
> 
> 标签：hadoop, amazon-s3, mapreduce, elastic-map-reduce, emr

我想使用 s3distcp 将单个文件复制到 HDFS。我曾尝试使用 srcPattern 参数，但它没有帮助，它继续抛出 java.lang.Runtime 异常。我使用的正则表达式可能是罪魁祸首，请帮忙。

我的代码如下：

```
elastic-mapreduce -j $jobflow --jar s3://us-east-1.elasticmapreduce/libs/s3distcp/1.latest/s3distcp.jar --args '--src,s3://<mybucket>/<path>' --args '--dest,hdfs:///output' --arg --srcPattern --arg '(filename)' 
```

抛出异常：

```
Exception in thread "main" java.lang.RuntimeException: Error running job at com.amazon.external.elasticmapreduce.s3distcp.S3DistCp.run(S3DistCp.java:586) at com.amazon.external.elasticmapreduce.s3distcp.S3DistCp.run(S3DistCp.java:216) at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65) at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:79) at com.amazon.external.elasticmapreduce.s3distcp.Main.main(Main.java:12) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at org.apache.hadoop.util.RunJar.main(RunJar.java:156) Caused by: org.apache.hadoop.mapred.InvalidInputException: Input path does not exist: hdfs:/tmp/a088f00d-a67e-4239-bb0d-32b3a6ef0105/files at org.apache.hadoop.mapred.FileInputFormat.listStatus(FileInputFormat.java:197) at org.apache.hadoop.mapred.SequenceFileInputFormat.listStatus(SequenceFileInputFormat.java:40) at org.apache.hadoop.mapred.FileInputFormat.getSplits(FileInputFormat.java:208) at org.apache.hadoop.mapred.JobClient.writeOldSplits(JobClient.java:1036) at org.apache.hadoop.mapred.JobClient.writeSplits(JobClient.java:1028) at org.apache.hadoop.mapred.JobClient.access$700(JobClient.java:172) at org.apache.hadoop.mapred.JobClient$2.run(JobClient.java:944) at org.apache.hadoop.mapred.JobClient$2.run(JobClient.java:897) at java.security.AccessController.doPrivileged(Native Method) at javax.security.auth.Subject.doAs(Subject.java:396) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1059) at org.apache.hadoop.mapred.JobClient.submitJobInternal(JobClient.java:897) at org.apache.hadoop.mapred.JobClient.submitJob(JobClient.java:871) at org.apache.hadoop.mapred.JobClient.runJob(JobClient.java:1308) at com.amazon.external.elasticmapreduce.s3distcp.S3DistCp.run(S3DistCp.java:568) ... 9 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-10T03:32:23.933

DistCp 旨在使用多台机器复制许多文件。如果您只想复制一个文件，则 DistCp 不是正确的工具。

在 hadoop 主节点上，您可以使用复制单个文件

`hadoop fs -cp s3://<mybucket>/<path> hdfs:///output`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-18T18:12:21.223

我使用的正则表达式确实是罪魁祸首。假设文件名有日期，例如文件是 like `abcd-2013-06-12.gz`，那么为了只复制这个文件，下面的 emr 命令应该做：

> elastic-mapreduce -j $jobflow --jar s3://us-east-1.elasticmapreduce/libs/s3distcp/1.latest/s3distcp.jar --args '--src,s3:///' --args '--dest,hdfs:///output' --arg --srcPattern --arg '.*2013-06-12.gz'

如果我没记错的话，我的正则表达式最初是`*2013-06-12.gz`而不是`.*2013-06-12.gz`. 所以需要开头的点。

# javascript - Javascript XML 相同的元素名称

> ID：13494532
> 
> 赞同：1
> 
> 时间：2012-11-21T13:38:50.000
> 
> 标签：javascript, xml, ajax, dom

我有一个多次包含相同元素名称的 XML 文件，如下所示。我只能检索第一个。想知道如何使用 JavaScript 检索所有 4 个“评论”。谢谢！

```
<FRIENDSSTATUS>
  <STATUSFRIENDS id="2">
    <STATUS>Life begins at the end of your comfort zone</STATUS>
    <DATETIME>2012-10-30 10:32:28</DATETIME>
    <FIRSTNAME>Malcolm</FIRSTNAME>
    <LASTNAME>Landgraab</LASTNAME>
    <COMMENTS datetime="2012-11-18 22:13:28" firstname="Ian" lastname="Tellerman">rr</COMMENTS>
    <COMMENTS datetime="2012-11-18 22:13:39" firstname="Ian" lastname="Tellerman">hello</COMMENTS>
    <COMMENTS datetime="2012-11-19 14:36:24" firstname="Ian" lastname="Tellerman">test</COMMENTS>
    <COMMENTS datetime="2012-11-19 14:45:52" firstname="Ian" lastname="Tellerman">test4</COMMENTS>
   </STATUSFRIENDS>
  <STATUSFRIENDS id="3">
    <STATUS>Prometheus. Fantastic film!!!!</STATUS>
    <DATETIME>2012-10-30 10:32:28</DATETIME>
    <FIRSTNAME>Mansa</FIRSTNAME>
    <LASTNAME>Bendett</LASTNAME>
    <COMMENTS datetime="2012-11-18 22:14:46" firstname="Ian" lastname="Tellerman">wrong</COMMENTS>
  </STATUSFRIENDS>
</FRIENDSSTATUS> 
```

javascript代码：

```
 xmlDoc = xmlhttp.responseXML;
$table = "<table border='1'>";

var element = xmlDoc.getElementsByTagName("FRIENDSSTATUS");
var elements = xmlDoc.getElementsByTagName("STATUSFRIENDS");
var comments = xmlDoc.getElementsByTagName("COMMENTS");

    if(xmlDoc.documentElement !== null)
    {

    var root;
    if (navigator.userAgent.indexOf("Firefox") > 0 )
    var root = element[0].childElementCount;

    if (navigator.userAgent.indexOf("MSIE") > 0 )
    var root = xmlDoc.documentElement.childNodes.length;

    for(i=0; i<root; i++){
$strStats =  "";
$strComments = "";
$strDateTime = "";
$strFirstname = "";
$strLastname = "";

$strCommentDateTime =  "";
$strCommentFirstName = "";
$strCommentLastName = "";
$strStatusID = "";

if(navigator.userAgent.indexOf("Firefox") > 0 ){
for(y=0;y < elements[i].childElementCount;y++)
{
 $strStatusID = elements[i].getAttribute("id");
  if(strStatus = elements[i].getElementsByTagName("STATUS"))
    {
        $strStats = strStatus[0].firstChild.nodeValue; 

    }

  if(strStatus = elements[i].getElementsByTagName("DATETIME"))
    {
        $strDateTime = strStatus[0].firstChild.nodeValue; 

    }

  if(strStatus = elements[i].getElementsByTagName("FIRSTNAME"))
    {
        $strFirstname = strStatus[0].firstChild.nodeValue; 

    }

  if(strStatus = elements[i].getElementsByTagName("LASTNAME"))
    {
        $strLastname = strStatus[0].firstChild.nodeValue; 

    }
  if(strComm = elements[i].getElementsByTagName("COMMENTS"))
    { 
        $strComments = strComm[0].firstChild.nodeValue;
        $strCommentDateTime = comments[i].getAttribute("datetime");
        $strCommentFirstName = comments[i].getAttribute("firstname");
        $strCommentLastName = comments[i].getAttribute("lastname");

        $strComments += "<br>" + $strCommentFirstName + " " + $strCommentLastName + " " + $strCommentDateTime + "</br></br>";
   }
  $strStats = $strStats + " " + $strLastname + " " + $strFirstname + " " + $strDateTime;
  $strFullName = $strFirstname + " " + $strLastname;
  $strDateTime = "";
  $strFirstname = "";
  $strLastname = "";
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:17:49.470

我没有时间发布完整的代码示例，但 JS 支持 XPath，您可以使用此 Qpath 查询获得评论：

/FRIENDSSTATUS/STATUSFRIENDS[@id="3"]/COMMENTS

这是我测试 Xpath 语法的地方： http: [//chris.photobooks.com/xml/default.htm](http://chris.photobooks.com/xml/default.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T13:57:02.273

像这样的东西：

```
var str = 'your XML as a string',
    parser, xml;

if (window.DOMParser) {
    parser = new DOMParser();
    xml = parser.parseFromString(str, "text/xml");
}
else { // IE
    xml = new ActiveXObject("Microsoft.XMLDOM");
    xml.async = "false";
    xml.loadXML(str);
}

var nodes = xml.childNodes[0].getElementsByTagName('COMMENTS');

var i, l = nodes.length, comments = [];
for (i = 0; i < l; i++) {
    comments.push({
        firstname: nodes[i].getAttribute('firstname'),
        lastname: nodes[i].getAttribute('lastname'),
        datetime: nodes[i].getAttribute('datetime'),
        content: nodes[i].childNodes[0].nodeValue
    });
}

console.log(comments); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:46:42.060

将您的 XML 分配给一个变量（`myXmlString`在本例中），并按如下方式读取它：

```
var parser=new DOMParser();
doc=parser.parseFromString(myXmlString,'text/xml');
var comments = doc.getElementsByTagName("COMMENTS") // Returns a array of those "comments". 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T13:53:47.927

如何访问第一个评论的示例`STATUSFRIENDS`。[**jsFiddle 演示在这里**](http://jsfiddle.net/bvhxr/)。

```
var parseXml;

if (typeof window.DOMParser != "undefined") {
    parseXml = function(xmlStr) {
        return ( new window.DOMParser() ).parseFromString(xmlStr, "text/xml");
    };
} else if (typeof window.ActiveXObject != "undefined" &&
       new window.ActiveXObject("Microsoft.XMLDOM")) {
    parseXml = function(xmlStr) {
        var xmlDoc = new window.ActiveXObject("Microsoft.XMLDOM");
        xmlDoc.async = "false";
        xmlDoc.loadXML(xmlStr);
        return xmlDoc;
    };
} else {
    throw new Error("No XML parser found");
}

var xml = parseXml(xmlStr); // assuming xmlStr contains your XML
var commentsList = xml.documentElement.childNodes[0].getElementsByTagName("COMMENTS");
var output = "";

for(var i=0; i<commentsList.length; i++)
{
   output += commentsList[i].firstChild.nodeValue + "<br />";   
}

document.getElementById("comments").innerHTML = output; 
```

# ios - 在 CoreData 中删除或移除 ManagedObject

> ID：13494535
> 
> 赞同：6
> 
> 时间：2012-11-21T13:38:58.703
> 
> 标签：ios, core-data

在文档和广泛的文献中，在 CoreData for IOS 中删除/删除子类托管对象的生成工厂方法是

```
(void)removeXXXObject:(NSManagedObject *)value 
```

其中XXX是对应关系或者我们可以简单地使用removeObject。

在我的代码中，我使用了这个：

```
Data *lastData = [[self sortedPersonDatas] objectAtIndex:0];
[selectedPerson removePersonDatasObject:lastData]; 
```

其中 PersonDatas 是与数据托管对象的一对多关系，来自我获取最后一个数据（lastData 来自所有数据的排序数组）但是使用前两个删除方法并检查后面的 SQL 数据库，我们可以发现实际数据存在只是反向关系为空。要完全删除数据（所有属性和对象），我必须使用：

```
[selectedPerson.managedObjectContext deleteObject:lastData]; 
```

问题：哪种方法更好，CoreData 保持数据完整是否正确？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T14:10:23.180

`removeXXXObject`仅从一对多关系中删除一个对象，但不会从存储中删除该对象。为此，您必须确实使用`deleteObject`- 这是所需的行为。默认情况下，调用`deleteObject`还会将对应关系设置为 nil（参见[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdRelationships.html#//apple_ref/doc/uid/ TP40001857-SW1](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdRelationships.html#//apple_ref/doc/uid/TP40001857-SW1)）。

# c# - C#登录Mysql OBDC类和类型混淆/错误

> ID：13494545
> 
> 赞同：0
> 
> 时间：2012-11-21T13:39:41.603
> 
> 标签：c#, mysql, class, login

我正在使用 MySql 和 OBDC 在 c# 中注册登录页面。我没有 C# 经验，所以我真的很挣扎（这是为了上课）。我对类、类型和对象有些困惑。

这是即将出现的错误，然后是代码（非常感谢任何帮助）：

c:\Users\Lau\Documents\SQL Class\Project_homework3\registration.aspx.cs(23,25): 错误 CS0118: 'System.Web.UI.Page.User' 是一个 'property' 但用作' type' c:\Users\Lau\Documents\SQL Class\Project_homework3\registration.aspx.cs(23,44): error CS0118: 'System.Web.UI.Page.User' 是一个 'property' 但使用方式类似一种'

```
 User NewUser = new User();
                    NewUser.first_name = first_name.Text;
                    NewUser.last_name = last_name.Text;
                    NewUser.email = email.Text;
                    NewUser.password = password.Text;

                    NewUser.create(); 
```

我在自己的代码文件中创建了一个名为 User 的类。也许这个代码页没有访问那个类，即使它是公开的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T09:40:44.433

可能您有一个名为 User 的类，它与 System.Web.UI.Page 类中的 User 属性冲突。如果您在 Page_Load 或派生的 System.Web.UI.Page 页面的其他方法中，则您的代码会触发问题。
将名称更改为您的 User 类应该可以解决问题。

请记住，如果您已经命名了您的主页类`User`并且现在您需要更改此名称，您应该在 Designer.cs 文件中应用您的新名称，**保持正确的继承**。

```
public partial class NewUser : System.Web.UI.Page 
```

# freebase - 使用 Freebase 搜索 api mql_output 参数获取链接数据

> ID：13494549
> 
> 赞同：0
> 
> 时间：2012-11-21T13:39:49.577
> 
> 标签：freebase, mql

我正在尝试使用 freebase 搜索 API 来获取特定政治家的政党以及一般传记数据（使用 php）。我知道搜索 api 将找到的每个搜索结果的 id 传递给 mql_output 参数指定的 MQL 查询。

这是我目前用于 mql_ouput 参数的 MQL 查询

{ "name":null, "/people/person/date_of_birth":null, "/people/person/gender":null, "/wikipedia/topic/en_id":null, "id":null, "/government/政治家/政党”：[{政党：空}]}

这是生成的查询网址

[https://www.googleapis.com/freebase/v1/search?Barrack%20Obama&filter=%28all%20type%3Apolitician%29&mql_output=%7B%22name%22%3Anull%2C%22%5C%2Fpeople%5C%2Fperson% 5C%2Fdate_of_birth%22%3Anull%2C%22%5C%2Fpeople%5C%2Fperson%5C%2Fgender%22%3Anull%2C%22%5C%2Fwikipedia%5C%2Ftopic%5C%2Fen_id%22%3Anull%2C% 22id%22%3Anull%2C%22%5C%2Fgovernment%5C%2Fpolitician%5C%2Fparty%22%3A%5B%7B%7D%5D%7D&key=AIzaSyDdJ_9L6mcWXinx5Lehku2TULmJhOMESew&indent=true](https://www.googleapis.com/freebase/v1/search?Barrack%20Obama&filter=%28all%20type%3Apolitician%29&mql_output=%7B%22name%22%3Anull%2C%22%5C%2Fpeople%5C%2Fperson%5C%2Fdate_of_birth%22%3Anull%2C%22%5C%2Fpeople%5C%2Fperson%5C%2Fgender%22%3Anull%2C%22%5C%2Fwikipedia%5C%2Ftopic%5C%2Fen_id%22%3Anull%2C%22id%22%3Anull%2C%22%5C%2Fgovernment%5C%2Fpolitician%5C%2Fparty%22%3A%5B%7B%7D%5D%7D&key=AIzaSyDdJ_9L6mcWXinx5Lehku2TULmJhOMESew&indent=true)

感谢您的帮助，对不起，这是一个非常基本的问题，

标记

* * *

**回答**

由于没有足够的论坛代表，无法自行回答。

在浏览了更多示例后，我才意识到我需要做什么。要让数据库检索我需要使用以下查询的聚会信息。

{ "name":null, "/people/person/date_of_birth":null, "/people/person/gender":null, "/wikipedia/topic/en_id":null, "id":null, "/government/政治家/党”：{“党”：空}}

标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T09:47:08.273

在浏览了更多示例后，我才意识到我需要做什么。要让数据库检索我需要使用以下查询的聚会信息。

{ "name":null, "/people/person/date_of_birth":null, "/people/person/gender":null, "/wikipedia/topic/en_id":null, "id":null, "/government/政治家/党”：{“党”：空}}

标记

# php - 如何分离php生成的按钮

> ID：13494551
> 
> 赞同：0
> 
> 时间：2012-11-21T13:39:58.080
> 
> 标签：php, javascript, jquery, html, css

我正在用 php 生成按钮表

```
echo ' <td">
<form action="test.php" method="POST">
<input type="hidden" id="node" name="node" value="'.$fnode->{'name'}.'">
<input type="hidden" id="service" name="service" value="'.$flavor.'">
<input type="hidden" id="running" name="running" value="false">
<input type="submit" value="OFF" class="button">
</form>
</td>'; 
```

我想发送值而不通过 jquery ajax 重新加载，我正在使用此代码：

$(".button").click(function() { $('.error').hide();

```
 var dataString = 'node='+ document.getElementById('node').value + '&service=' + document.getElementById('service').value + '&running=' + document.getElementById('running').value;

    $.ajax({
        type: "POST",
        url: "test.php",
        data: dataString,
        success: function() {
            alert ("Success");
        }
    });
    return false;
}); 
```

代码工作至今——它总是从第一个表单发送数据。区分所有按钮的最佳方法是什么。我可以在表单中使用计数器，但我将如何准确地编写 js“ifs”。有没有更优雅的方法来做到这一点。表格的数量是动态的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:43:04.827

您可以很容易地抓住单击按钮的父表单，但您可能还希望在表单上拥有一个唯一的 ID 用于其他事情。此外，您需要删除输入上的 id 或使其唯一。

```
echo ' <td">
<form action="test.php" method="POST" id="form_node_' . $fnode->{'name'} . '>
<input type="hidden" name="node" value="'.$fnode->{'name'}.'">
<input type="hidden" name="service" value="'.$flavor.'">
<input type="hidden" name="running" value="false">
<input type="submit" value="OFF" class="button">
</form>
</td>';

$(".button").click(function(e) {
    e.preventDefault(); 
    $('.error').hide();
    var $form = $(this).closest('form'), // the closest parent form
        dataString = $form.closest('form').serialize(); // serialize the values instead of manually encoding
    $.ajax({
        type: "POST",
        url: "test.php",
        data: dataString,
        success: function() {
            alert ("Success submitting form ID " + $form.attr('id'));
            // you can now modify the form you submitted
        }
    });
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T13:41:33.800

最好的方法是对表单元素使用唯一 ID。另一种方法是将类设置为具有相同名称的多个元素。

但是，以下方法更可取：

```
$("form").on("submit", function() {
    $.ajax({
        type: "POST",
        url: "test.php",
        data: $(this).serialize(),
        success: function() {
            alert ("Success");
        }
    });
    return false;
}); 
```

（但无论如何不要忘记`id`从表单元素中删除重复的属性。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:43:16.713

你可以给每个提交按钮一个 id：

```
<input id="button-1" type="submit" value="OFF" class="button"> 
```

然后在单击特定按钮时触发事件：

```
$("#button-1").click(function() { ... }); 
```

# templates - 从“从已安装”列表中删除模板

> ID：13494554
> 
> 赞同：2
> 
> 时间：2012-11-21T13:40:04.090
> 
> 标签：templates, sharepoint-2010

我正在尝试清理该`Create from Installed`区域提供的自定义站点模板。

我已经搜索了解决方案库，但在那里找不到我想要删除的项目 - 可能之前在库级别已删除。同样，我打开了回收物品，它是空的。

想法？

# android - 屏幕锁定时如何访问应用程序小部件

> ID：13494557
> 
> 赞同：0
> 
> 时间：2012-11-21T13:40:05.410
> 
> 标签：android, widget, locking, screen

我已经设计了应用程序小部件音乐播放器并成功运行，但即使 android 屏幕被锁定，我也想访问我的应用程序。是否可能。如果是，你能帮我解决这个问题。

提前致谢-Sasi

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:42:16.190

您需要将代码放入服务中。即使屏幕被锁定，服务也允许您的代码运行，而不是活动，不幸的是，活动将被放入无法再执行代码的生命周期事件中。

发布一些代码，我们将帮助您进行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:05:43.067

要从应用程序（从锁定屏幕）访问您的小部件，您可以使用这些服务。

像这样：**BigBalanceAppWidgetProvider.java**

```
public class BigBalanceAppWidgetProvider extends BaseAppWidgetProvider {
    public static final String TAG = "BigBalanceAppWidgetProvider";
    ...
    public static void updateAppWidget(Context context,
            AppWidgetManager appWidgetManager, int appWidgetId,
            User appWidgetUser, Boolean error) {
        RemoteViews views;
        ... 
    }
    ...
} 
```

从服务中调用它：**WidgetUpdateBalanceService.java**

```
public class WidgetUpdateBalanceService extends IntentService {
    ...
    private void doSingleUpdate() {
        BigBalanceAppWidgetProvider.updateAppWidget(mContext, appWidgetManager, appWidgetId, user);
    }
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T15:44:26.220

锁定屏幕上的小部件仅适用于 Android 4.2+ 设备。可以在[此处](http://developer.android.com/about/versions/android-4.2.html#Lockscreen)和[此处找到有关如何实现此目的的信息](http://developer.android.com/guide/topics/appwidgets/index.html#lockscreen)

# javascript - 如何将 javascript textBox 值作为参数传递给 URL

> ID：13494558
> 
> 赞同：1
> 
> 时间：2012-11-21T13:40:12.453
> 
> 标签：javascript, url, parameters, textbox

我想将日期和时间选择器中的值作为参数传递给 URL。这就是我所拥有的：

```
<div style="text-align:left; margin:8px 5px auto;">
        <label for="dt_id">Please enter a date and time </label>
        <input type="Text" id="dt_id" maxlength="25" size="25"/>
        <img src="../../js/datetimepicker/images2/cal.gif" onclick="javascript:NewCssCal('dt_id','yyyyMMdd','arrow','true','24')" style="cursor:pointer"/>
        <input type='button' onclick='setURL()' value='SUBMIT'> 
</div>

<script>
var dt_value = document.getElementById("dt_id").value;
var sjdurl =  "/path/script?datetime="+dt_value;
</script> 
```

但是，该 URL 不包含日期值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T13:45:39.617

我试图重现这个场景，它完全适合我：-

```
<html>
<head>
<script>
    function setURL(){
    var dt_value = document.getElementById("dt_id").value;
    //just test here ..what is coming..
    alert(dt_value );
    var sjdurl =  "www.google.com?datetime="+dt_value;

popup = window.open(sjdurl,"popup"," menubar =0,toolbar =0,location=0, height=900, width=1000"); 
popup.window.moveTo(950,150); 

    }
</script>
</head>
<body>
<div style="text-align:left; margin:8px 5px auto;">
        <label for="dt_id">Please enter a date and time </label>
        <input type="Text" id="dt_id" maxlength="25" size="25"/>
        <input type='button' onclick='setURL()' value='SUBMIT'> 
</div>

</body>
</html> 
```

# java - 带有 eclipse 和 tomcat 7 的 JSF 2.0 项目

> ID：13494559
> 
> 赞同：0
> 
> 时间：2012-11-21T13:40:15.020
> 
> 标签：java, jsf-2, classnotfoundexception

我正在创建一个新的 JSF 2.0 项目并获得：

> java.lang.ClassNotFoundException: javax.servlet.jsp.jstl.core.Config

例外。如果我复制粘贴 jstl-api 1.2 和 jstl-impl-1.2 jar WebContent\WEB-INF\lib 其他一些异常

> 在 com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139) 在 javax.faces.webapp.FacesServlet.service(FacesServlet.java:594) 在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain .java:305) 在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) 在 org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:749) 在 org.apache.catalina。 core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:487) at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:412) at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:339)在 com.sun.faces 的 com.sun.faces.context.ExternalContextImpl.dispatch(ExternalContextImpl.java:546)。application.view.JspViewHandlingStrategy.executePageToBuildView(JspViewHandlingStrategy.java:364) 在 com.sun.faces.application.view.JspViewHandlingStrategy.buildView(JspViewHandlingStrategy.java:154) 在 com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.爪哇：100）

正在无限生成。出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:48:43.527

我认为您应该删除`jstl api 1.2`and`jstl impl 1.2`并使用`jstl 1.2`. 顺便问一下，你用过`jsp api`罐子吗？如果你的回答是肯定的，那么第一个异常的可能原因是它与`jsp api`tomcat lib中的jar冲突。**应该在启动 JSF 2.0 时访问[Mkyoung 的页面。](http://www.mkyong.com/jsf2/jsf-2-0-hello-world-example/)**这会对你有很大帮助！

快乐编码！

# .net - 使用单个条件检查 Class 是否为 Nothing，或 Structure 是否为默认值

> ID：13494560
> 
> 赞同：1
> 
> 时间：2012-11-21T13:40:16.633
> 
> 标签：.net, vb.net, reference, null, default-value

我已经编写了自己的方法来以编程方式选择 ComboBox 中的项目：

```
Function SelectItem(ByVal item As Object, ByVal comboBox As ComboBox) As Boolean
  If Not comboBox.Items.Contains(item) Then
    comboBox.Items.Add(item)
  End If

  comboBox.SelectedItem = item

  Return True
End Function 
```

"item" 参数可以是任意`Class`的，例如字符串，但也可以是 (custom) `Structure`。

当参数为`Nothing`（或默认结构值）时，此方法应返回`False`. 我如何达到这个条件？

```
' This will not work, because "=" can't be used with classes
If item = Nothing Then Return False

' Won't work either, because "Is" is always False with structures
If item Is Nothing Then Return False

' Obviously this would never work
If item.Equals(Nothing) Then Return False

' Tried this too, but no luck :(
If Nothing.Equals(item) Then Return False 
```

我应该如何处理这种情况？我可以使用`Try ... Catch`，但我知道必须有更好的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:38:13.337

这个函数可以解决问题：

```
Public Function IsNullOrDefaultValue(item As Object) As Boolean
    Return item Is Nothing OrElse (item.GetType.IsValueType Andalso item = Nothing)
End Function 
```

通过传递变量测试结果：

```
Dim emptyValue As Integer = 0          ==> True
Dim emptyDate As DateTime = Nothing    ==> True
Dim emptyClass As String = Nothing     ==> True
Dim emptyStringValue As String = ""    ==> False
Dim stringValue As String = "aa"       ==> False
Dim intValue As Integer = 1            ==> False 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:45:25.507

我不太确定您希望在哪些条件下返回 True/False，但此代码显示了如何检查类型并将其与特定值进行比较。这样，如果类型错误，您就不会尝试将其与值进行比较。

```
If (TypeOf myVar is MyClass andalso myVar isnot nothing) _
    OrElse TypeOf myVar is MyStructure AndAlso myVar = MyStructure.DefaultValue) Then
    ...
End If 
```

# android - Android中HttpURLConnection中的getInputStream()方法总是失败

> ID：13494561
> 
> 赞同：2
> 
> 时间：2012-11-21T13:40:19.700
> 
> 标签：android

```
HttpURLConnection urlConn = (HttpURLConnection) new URL(
                "http://www.google.com").openConnection();

        InputStream is = urlConn.getInputStream();

        BufferedReader br = new BufferedReader(new InputStreamReader(is));
        String inputLine = "";
        while ((inputLine = br.readLine()) != null) {
            result += inputLine;
        } 
```

当涉及到 urlConn.getInputStream() 时，它失败了。但是相同的代码适用于普通的 java 项目而不是 Android 项目。

而且我发现在Android中，当它运行第一条语句时， urlConn 是：“libcore.net.http.HttpURLConnectionImpl:http://www.google.com”

但在普通的java项目中，它是“sun.net.www.protocol.http.HttpURLConnection:http://www.google.com”

谢谢！！

异常堆栈：

```
11-21 21:14:01.750: I/System.out(20784): debugger has settled (1392)
11-21 21:14:56.380: W/dalvikvm(20784): threadid=1: thread exiting with uncaught exception (group=0x410e49d8)
11-21 21:14:56.420: E/AndroidRuntime(20784): FATAL EXCEPTION: main
11-21 21:14:56.420: E/AndroidRuntime(20784): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.network/com.example.network.MainActivity}: android.os.NetworkOnMainThreadException
11-21 21:14:56.420: E/AndroidRuntime(20784):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1969)
11-21 21:14:56.420: E/AndroidRuntime(20784):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1994)
11-21 21:14:56.420: E/AndroidRuntime(20784):    at android.app.ActivityThread.access$600(ActivityThread.java:126) 
```

我已经添加了 INTERNET 权限。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:51:34.447

啊那个有名的`android.os.NetworkOnMainThreadException`:)

从*HoneyComb*开始，网络操作 - 默认情况下 - 不允许在主（UI）线程上执行。因此，使用`AsyncTask`或`Thread`在单独的线程上执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T13:52:43.590

不要在 UT 线程上进行联网 (NetworkOnMainThreadException)。使用 AsyncTask 避免此异常

有关更多详细信息，请参阅本文：[http ://www.androiddesignpatterns.com/2012/06/app-force-close-honeycomb-ics.html](http://www.androiddesignpatterns.com/2012/06/app-force-close-honeycomb-ics.html)

# c - gnu正则表达式中的非贪婪重复

> ID：13494565
> 
> 赞同：0
> 
> 时间：2012-11-21T13:40:33.163
> 
> 标签：c, regex, linux, kernel

我正在linux中编写一个与网络相关的程序。程序在内核空间而不是用户空间。

我在这个程序中只需要一个支持所有 gnu 正则表达式库功能以及非贪婪重复的正则表达式库。

是否有任何这样的库具有这些功能，并且我可以在内核空间中编译和使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:48:54.340

我会推荐[TRE](http://laurikari.net/tre/)。请注意，它在其 POSIX BRE 支持中存在许多错误（只是将某些字符的含义误解/误解为 BRE），但 POSIX ERE 支持非常好，并且它具有大多数（全部？）GNU 扩展以及非贪婪匹配支持。我要警告您的唯一另一件事是，如果您要处理来自不受信任来源的正则表达式，则解析器中至少存在一个危险的错误。如果您只使用自己的正则表达式，这无关紧要。

# html - HTML5 实时音频流“Windows 媒体播放器”

> ID：13494573
> 
> 赞同：0
> 
> 时间：2012-11-21T13:40:52.897
> 
> 标签：html, media-player, audio-streaming, html5-audio

有人知道是否可以使用 HTML5 为 Windows Media Player 创建音频播放器？我想播放这样的 url 直播电台流媒体：[http ://streaming.crwarpaths1.info:8000/globo](http://streaming.crwarpaths1.info:8000/globo)

最好的，弗拉维奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:57:56.187

看起来您链接的流正在使用 icecast。查看他们的网站以了解如何运行流。[冰播网](http://icecast.org/)

# plsql - 重复的 INSERT 记录过程

> ID：13494577
> 
> 赞同：0
> 
> 时间：2012-11-21T13:41:07.577
> 
> 标签：plsql, insert, duplicates, procedure

我对在表中插入重复的最后一条记录的 mu 过程有问题

例如，当我输入 INSERT .....'AAA' 我得到了表 'AAA' 和 'AAA' 中的行

当我将 DBMS()... 放入代码中时，我得到了两条记录，我在 HistoriaDismissDate 中使用触发器和序列作为列 ID，但它们状况良好。我检查我是否删除了触发器和序列以及它的相同情况

我也使用 viewDate 但这个视图得到 mi ONE 记录不是两个

我的代码

```
CREATE OR REPLACE PROCEDURE ChangeDismissDate
IS

          v_id VARCHAR2(11);
          v_dateBhd DATE := TO_DATE('20491231','yyyymmdd');
          v_dateDismiss DATE := TO_DATE('20491231','yyyymmdd');
          v_login VARCHAR2(50);
          last_id NUMBER :=0;

        CURSOR cur IS
                select EMP_NO, LOGIN, ODEJSCIE_BHD, ODEJSCIE_OLD FROM viewDate;

        BEGIN
                       OPEN cur;
                           LOOP
                                FETCH cur INTO v_id,v_login,v_dateBhd,v_dateDismiss;
                                  DBMS_OUTPUT.put_line(v_id || ' ' || v_login || ' ' || v_dateBhd || ' ' || v_dateDismiss);
                                 UPDATE employee_tab SET DISMISS_DATE = v_dateBhd WHERE EMP_NO = v_id;
                                 COMMIT;

                                 INSERT INTO HistoriaDismissDate(CUSTOMER_ID,LOGIN, DATE_CHANGE, DATE_BHD, DATE_DISMISS)
                                 VALUES(v_id,v_login, sysdate, v_dateBhd, v_dateDismiss);
                                 COMMIT;

                           EXIT WHEN cur%NOTFOUND;
                           END LOOP;
                           CLOSE cur;

    EXCEPTION
    WHEN NO_DATA_FOUND
    THEN
        DBMS_OUTPUT.put_line (DBMS_UTILITY.format_error_stack);
    WHEN OTHERS
    THEN
        DBMS_OUTPUT.put_line (DBMS_UTILITY.format_error_stack);
    END;
/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T18:44:34.063

原始代码的 2 个提示：

1) 游标是一种**非常**古老的 PL/SQL 编程技术。更喜欢使用 FOR ... LOOP 构造。它更干净，更不容易出错！看看它怎么运作：

```
CREATE OR REPLACE PROCEDURE ChangeDismissDate IS
BEGIN
  for cur in (select EMP_NO, LOGIN, ODEJSCIE_BHD, ODEJSCIE_OLD FROM viewDate) loop

     DBMS_OUTPUT.put_line(cur.EMP_NO || ' ' || cur.login || ' ' || cur.ODEJSCIE_BHD || ' ' || cur.ODEJSCIE_OLD);
     UPDATE employee_tab 
        SET DISMISS_DATE = cur.ODEJSCIE_BHD
      WHERE EMP_NO = cur.EMP_NO;

     INSERT INTO HistoriaDismissDate
       ( CUSTOMER_ID,LOGIN, DATE_CHANGE, DATE_BHD, DATE_DISMISS )
     VALUES
       ( cur.EMP_NO, cur.LOGIN, sysdate, cur.ODEJSCIE_BHD, cur.ODEJSCIE_OLD, );
  end loop;
end;
/ 
```

2）**从不**，我的意思是永远不要在你的程序中提交。提交应该在调用者块或您的客户端应用程序上完成。当你在你的过程中放置​​一个提交时，你错过了在运行它之后回滚的机会，并且如果其他过程想要控制事务流，它们就无法调用它。

# php - 使用 ajax json 提交和加载

> ID：13494581
> 
> 赞同：1
> 
> 时间：2012-11-21T13:41:21.810
> 
> 标签：php, jquery, ajax, google-visualization

**索引.html：**

```
Function drawChart() {
            var jsonData = $.ajax({
                url: "server.php",
                dataType: "json",
                async: false
            }).responseText;

            var obj = jQuery.parseJSON(jsonData);

            var data = google.visualization.arrayToDataTable(obj);

            var options = {
                title: 'Number of visitors / <?php echo $unit; ?>'
            };

            var chart = new google.visualization.BarChart(
                        document.getElementById('chart_div'));
            chart.draw(data, options);
    }       
       } 
```

**服务器.php：**

```
$SQLString = "SELECT (...)'".$_POST['value']."' (...)
$result = mysql_query($SQLString);  
(...)
$data[$i] = array(...)
echo json_encode($data); 
```

* * *

那么，index.html 从 server.php 获取数据对吗？我可以向 server.php 发送一些值，这些值对于在 index.html 执行 jsonData...等之前执行查询很重要吗？如何？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:48:53.507

查询参数示例：

```
var jsonData = $.ajax({
                url: "server.php?someQuery=" + query,
                dataType: "json",
                async: false
            }).responseText; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T13:48:55.020

您可以通过 ajax 使用 post 方法发送。这是一个 JQuery 示例：

```
 $.ajax({
             type: "POST",
             url: "some.php",
             data: { name: "John", location: "Boston" }
          }).done(function( msg ) {
                    alert( "Data Saved: " + msg );
                  }); 
```

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T09:37:25.723

您可以使用 phery [http://phery-php-ajax.net](http://phery-php-ajax.net)为您自动执行此操作的库，在您的情况下，它将是：

该事件`phery:json`将处理从服务器发送的 JSON

```
var remote = phery.remote('data', {'argument': 'you want to send'}, {'target':'server.php'}, false);
remote.bind('phery:json', function(event, obj){
  var data = google.visualization.arrayToDataTable(obj);

  var options = {
    title: 'Number of visitors / <?php echo $unit; ?>'
  };

  var chart = new google.visualization.BarChart(
    document.getElementById('chart_div'));

  chart.draw(data, options);
});

remote.phery('remote'); // call the remote AJAX function 
```

在你的`server.php`

```
function data($data){
  $r = new PheryResponse;
  // $data['argument'] will have 'you want to send'
  $SQLString = "SELECT (...)'".$_POST['value']."' (...)"
  $result = mysql_query($SQLString);  
  (...);
  $data[$i] = array(...);
  return $r->json($data); 
}

Phery::instance()->set(array(
  'data' => 'data'
))->process(); 
```

# php - 企业邮件收不到php mail()

> ID：13494590
> 
> 赞同：-1
> 
> 时间：2012-11-21T13:41:33.533
> 
> 标签：php, email

这是我第一次在这个网站上提问。（是的，我知道，我的英语很差）

我正在制作一张在线圣诞贺卡，通过邮件发送卡片的链接。我的问题是，当我尝试将其发送到我的企业邮件 (@businessname.com) 时，它在 Outlook 中根本没有收到邮件，但是当我将其发送到我的 gmail 或我的 hotmail 时它工作正常。

看了一圈，可能是公司邮件系统的垃圾邮件过滤器有问题

```
$to = $case4;
$subject = 'Christmas card from ' . $case1;
$url = "http://mysite.com/folder/index.php?action=see&id=" . $id;
$message = 'Hi ' . $case3 . ',<br />Your friend ' . $case1 . ' sent you this card!<br /><a href="' . $url . '" target="_blank">Click here to see it</a>';

$headers = "MIME-Version: 1.0" . "\r\n";
$headers .= "Content-Type: text/html; charset=ISO-8859-1" . "\r\n";

mail($to, $subject, $message, $headers); 
```

任何人都知道我可以如何解决我的问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:48:50.077

该`mail`命令将调用本地`sendmail`程序来发送邮件。这导致网络主机发送邮件。垃圾邮件过滤器不仅会查看邮件的内容，而且肯定还会查看邮件来源和邮件头。尝试使用知名邮件发送服务的 SMTP 解决方案（如果您有 Gmail，则可以使用他们的 SMTP 服务器），例如使用 PEAR 的[`Mail`软件包](http://pear.php.net/package/Mail/redirected)。

此外，用于[`Mail_Mime`](http://pear.php.net/package/Mail_Mime/redirected)正确创建 MIME 编码消息。

# php - PHP imagepng() 正在创建损坏的图像

> ID：13494595
> 
> 赞同：3
> 
> 时间：2012-11-21T13:41:51.913
> 
> 标签：php, image, png

我到处寻找可能的解决方案来解决我的问题。不幸的是，我似乎无法弄清楚。我有一个基于其他图像创建图像的 .php 文件。我让脚本完全按照以前的方式工作，没有任何缺陷。但是在摆弄其他一些文件之后，它突然停止工作，并且现在在 Firefox、Chrome 和 IE 上生成损坏的 .png 图像。

**图像.php**

```
<?php
ini_set("display_errors", 1);
ini_set("error_reporting", 2047);
ini_set("display_errors", 1);
ini_set("display_startup_errors", 1);
error_reporting("E_ALL");

include("GameEngine/Database.php");
if(isset($_GET['uid'])){
    $uid =  $_GET['uid'];
} else {
    $uid = "1";
}
if(isset($_GET['size'])){
    if($_GET['size']=='profile'){
        $size =  '31x40';
    }elseif($_GET['size']=='inventory'){
        $size =  '64x82';
    }elseif($_GET['size']=='sideinfo'){
        $size =  '119x136';
    }
} else {
    $size = "119x136";
}
$herodetail = $database->HeroFace($uid);
if($herodetail['color']==0){
    $color = "black";
}
if($herodetail['color']==1){
    $color = "brown";
}
if($herodetail['color']==2){
    $color = "darkbrown";
}
if($herodetail['color']==3){
    $color = "yellow";
}
if($herodetail['color']==4){
    $color = "red";
}
$geteye = $herodetail['eye'];
$geteyebrow = $herodetail['eyebrow'];
$getnose = $herodetail['nose'];
$getear = $herodetail['ear'];
$getmouth = $herodetail['mouth'];
$getbeard = $herodetail['beard'];
$gethair = $herodetail['hair'];
$getface = $herodetail['face'];

// USAGE EXAMPLE: 
$body = imagecreatefrompng('img/hero/head/'.$size.'/face0.png');
if($getbeard!=5){
    $beard = imagecreatefrompng('img/hero/head/'.$size.'/beard/beard'.$getbeard.'-'.$color.'.png');
}
$ear = imagecreatefrompng('img/hero/head/'.$size.'/ear/ear'.$getear.'.png');
$eye = imagecreatefrompng('img/hero/head/'.$size.'/eye/eye'.$geteye.'.png');
$eyebrow = imagecreatefrompng('img/hero/head/'.$size.'/eyebrow/eyebrow'.$geteyebrow.'-'.$color.'.png');
if($gethair!=5){
    $hair = imagecreatefrompng('img/hero/head/'.$size.'/hair/hair'.$gethair.'-'.$color.'.png');
}
$mouth = imagecreatefrompng('img/hero/head/'.$size.'/mouth/mouth'.$getmouth.'.png');
$nose = imagecreatefrompng('img/hero/head/'.$size.'/nose/nose'.$getnose.'.png');
$face = imagecreatefrompng('img/hero/head/'.$size.'/face/face'.$getface.'.png');

// SAME COMMANDS: 
$database->imagecopymerge_alpha($body, $face, 0, 0, 0, 0, imagesx($face), imagesy($face),100); 
$database->imagecopymerge_alpha($body, $ear, 0, 0, 0, 0, imagesx($ear), imagesy($ear),100);
$database->imagecopymerge_alpha($body, $eye, 0, 0, 0, 0, imagesx($eye), imagesy($eye),100);
$database->imagecopymerge_alpha($body, $eyebrow, 0, 0, 0, 0, imagesx($eyebrow), imagesy($eyebrow),100);
if($gethair!=5){
$database->imagecopymerge_alpha($body, $hair, 0, 0, 0, 0, imagesx($hair), imagesy($hair),100);
}
$database->imagecopymerge_alpha($body, $mouth, 0, 0, 0, 0, imagesx($mouth), imagesy($mouth),100);
$database->imagecopymerge_alpha($body, $nose, 0, 0, 0, 0, imagesx($nose), imagesy($nose),100);
if($getbeard!=5){
$database->imagecopymerge_alpha($body, $beard, 0, 0, 0, 0, imagesx($beard), imagesy($beard),100);
}

// OUTPUT IMAGE: 
header("Content-Type: image/png"); 
imagesavealpha($body, true); 
imagepng($body, NULL);
?> 
```

我尝试注释掉 header() 以便在图像渲染之前检查任何 PHP 中是否存在错误。不是这种情况。我已经尝试了标签中的所有 $variables 来检查这些是否正确呈现。他们做到了。我不知道问题可能是什么。

我现在唯一的猜测是有一个空格或回车以某种方式添加到最终渲染中导致它损坏。但是，我已经寻找这个可能的空白很久了，但似乎找不到它。

非常感谢任何提示和/或建议！

**已解决此脚本包含的文件之一已保存为带有 BOM 的 UTF-8。这给了图像一个额外的字节，使其损坏。将所有文件保存为没有 BOM 的 UTF-8 解决了我的问题。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:45:05.073

我看不到问题所在（除非出现一些错误报告？），但如果您将图像从浏览器保存到文件，然后在文本编辑器中打开，问题可能很明显。

编辑：原来是 utf-8 文件中的字节顺序标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:03:07.170

只是碰巧搜索，发现：[https](https://github.com/yi12345/TravianT4/blob/master/hero_image.php) ://github.com/yi12345/TravianT4/blob/master/hero_image.php这是100％相同...确定你没有搞砸Database.php中的东西？

# sql - 优化 Oracle Between Date 语句

> ID：13494596
> 
> 赞同：5
> 
> 时间：2012-11-21T13:41:57.980
> 
> 标签：sql, oracle, indexing, between

我有一个 oracle SQL 查询，它选择当天的条目，如下所示：

```
SELECT   [fields] 
FROM     MY_TABLE T 
WHERE    T.EVT_END BETWEEN TRUNC(SYSDATE) 
                       AND TRUNC(SYSDATE) + 86399/86400
  AND    T.TYPE = 123 
```

而该`EVT_END`字段是类型`DATE`并且`T.TYPE`是`NUMBER(15,0)`.

我确信随着表数据大小（和持续时间）的增加，日期约束将比类型约束减少结果集更大的因素。（因为种类非常有限）

所以出现的基本问题是，选择什么索引可以使当前日期的选择更快。`TRUNC(T.EVT_END)`我特别想知道功能索引对普通索引的优缺点是什么`T.EVT_END`。使用功能索引时，查询看起来像这样：

```
SELECT   [fields] 
FROM     MY_TABLE T 
WHERE    TRUNC(T.EVT_END) = TRUNC(SYSDATE) 
  AND    T.TYPE = 123 
```

因为其他查询使用提到的日期约束而没有额外的类型选择（或者可能使用其他一些字段），所以多列索引对我没有多大帮助。

谢谢，我会很感激你的提示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T13:54:05.007

您的索引应该是 TYPE，EVT_END。

```
CREATE INDEX PIndex
ON MY_TABLE (TYPE, EVT_END) 
```

优化器计划将首先通过该索引找到 TYPE=123 部分。然后在 TYPE=123 下，它会对 EVT_END 时间戳进行排序，因此它可以在 b-tree 中搜索范围内的第一个日期，并按顺序遍历这些日期，直到数据超出范围。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T17:43:53.150

根据上面的查询，功能索引将不提供任何值。对于要使用的功能索引，查询中的谓词需要编写如下：

```
SELECT [fields] 
FROM MY_TABLE T 
WHERE TRUNC(T.EVT_END) BETWEEN TRUNC(SYSDATE) AND TRUNC(SYSDATE) + 86399/86400
  AND T.TYPE = 123 
```

列 EVT_END 上的功能索引被忽略。最好在 EVT_END 日期有一个正常的索引。对于要使用的功能索引，条件的左侧必须与功能索引的声明相匹配。我可能会将查询写为：

```
SELECT [fields] 
FROM MY_TABLE T 
WHERE T.EVT_END BETWEEN TRUNC(SYSDATE) AND TRUNC(SYSDATE+1)
  AND T.TYPE = 123 
```

我会创建以下索引：

```
CREATE INDEX bla on MY_TABLE( EVT_END ) 
```

这是假设您正在尝试查找在一天内结束的事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T11:00:41.740

@S1lence：
我相信您提出的这个问题背后会有相当长的思考时间。而且，我花了很多时间在这里发布我的答案，因为我不喜欢发布任何猜测答案。
我想分享我在针对 FBI 的日期列上选择正常索引的网络搜索经验。
根据我对下面*链接*的理解，如果您**确定**要使用 TRUNC 功能，那么您可以取消普通索引的选项，因为这个咨询网站空间说：
*即使列可能有索引，trunc内置函数将使索引无效，导致不必要的 I/O 的次优执行。*
我想这一切都清楚了。如果你要使用，你必须和 FBI 一起去`TRUNC`当然。请让我知道我的回复是否有意义。

[使用基于函数的索引进行 Oracle SQL 调优](http://www.dba-oracle.com/oracle_tips_index_scan_fbi_sql.htm)

干杯，
Lakshmanan C.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-02T12:19:43.003

关于是否使用基于函数的索引的决定应该由您计划如何编写查询来决定。如果您对日期列的所有查询都将在表单`TRUNC(EVT_END)`中，那么您应该使用 FBI。`EVT_END`但是，一般而言，仅出于以下原因创建索引会更好：

*   它将更加可重复使用。如果您曾经有查询检查一天中的特定时间，那么您不能使用 TRUNC。
*   仅使用日期的索引中将有更多不同的键。如果您在一天中插入了 1,000 个不同的时间，`EVT_END`则将有 1,000 个不同的键，而`TRUNC(EVT_END)`只有 1 个（这假设您正在存储时间组件，而不仅仅是所有日期的午夜 - 在第二种情况下，两者都将有 1一天的不同密钥）。这很重要，因为索引具有的不同值越多，索引的选择性就越高，优化器使用它的可能性就越大（参见[this](http://www.akadia.com/services/ora_index_selectivity.html)）
*   聚类因子可能会有所不同，但在使用 trunc 的情况下，它更有可能上升，而不是像其他评论中所说的那样下降。这是因为聚类因子表示索引中值的顺序与数据物理存储的匹配程度。如果您的所有数据都按日期顺序插入，则普通索引将与物理数据具有相同的顺序。但是，与`TRUNC`一天中的所有时间都将映射到相同的值，因此索引中的行顺序可能与物理数据完全不同。同样，这意味着 trunc 索引不太可能被使用。然而，这将完全取决于您的数据库的插入/删除模式。
*   开发人员更有可能针对未将 trunc 应用于列的位置编写查询（根据我的经验）。这是否适用于您将取决于您的开发人员和您对已部署 SQL 的质量控制。

就个人而言，我会首先接受马林的回答`TYPE, EVT_END`。但是，您需要在您的环境中对此进行测试，并查看这如何影响此查询以及使用 TYPE 和 EVT_END 列的所有其他查询。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-02T23:18:05.520

**结果**

如果您的索引被缓存，则基于函数的索引表现最佳。如果您的索引未缓存，则基于压缩函数的索引表现最佳。

以下是我的测试代码生成的相对时间。越低越好。您无法比较缓存和非缓存之间的数字，它们是完全不同的测试。

```
 In cache      Not in cache
Regular          120           139
FBI              100           138
Compressed FBI   126           100 
```

我不确定为什么 FBI 的表现比常规索引好。（虽然它可能与您所说的相等谓词与范围有关。您可以看到常规索引在其解释计划中有一个额外的“过滤”步骤。）压缩的 FBI 有一些额外的开销来解压缩块。当一切都已经在内存中时，这少量的额外 CPU 时间是相关的，并且 CPU 等待是最重要的。但是当什么都没有缓存，而 IO 更重要时，压缩后的 FBI 减少的空间有很大帮助。

**假设**

这个问题似乎有很多困惑。按照我的阅读方式，您只关心这个特定的查询，并且您想知道基于函数的索引还是常规索引会更快。

我假设您不关心可能从该索引中受益的其他查询，维护索引所花费的额外时间，开发人员是否记得使用它，或者优化器是否选择索引。（如果优化器没有选择索引，我认为这不太可能，您可以添加提示。）如果这些假设中有任何错误，请告诉我。

**代码**

```
--Create tables. 1 = regular, 2 = FBI, 3 = Compressed FBI
create table my_table1(evt_end date, type number) nologging;
create table my_table2(evt_end date, type number) nologging;
create table my_table3(evt_end date, type number) nologging;

--Create 1K days, each with 100K values
begin
    for i in 1 .. 1000 loop
        insert /*+ append */ into my_table1
        select sysdate + i - 500 + (level * interval '1' second), 1
        from dual connect by level <= 100000;

        commit;
    end loop;
end;
/
insert /*+ append */ into my_table2 select * from my_table1;
insert /*+ append */ into my_table3 select * from my_table1;

--Create indexes
create index my_table1_idx on my_table1(evt_end);
create index my_table2_idx on my_table2(trunc(evt_end));
create index my_table3_idx on my_table3(trunc(evt_end)) compress;

--Gather statistics
begin
    dbms_stats.gather_table_stats(user, 'MY_TABLE1');
    dbms_stats.gather_table_stats(user, 'MY_TABLE2');
    dbms_stats.gather_table_stats(user, 'MY_TABLE3');
end;
/

--Get the segment size.
--This shows the main advantage of a compressed FBI, the lower space.
select segment_name, bytes/1024/1024/1024 GB
from dba_segments
where segment_name like 'MY_TABLE__IDX'
order by segment_name;

SEGMENT_NAME     GB
MY_TABLE1_IDX    2.0595703125
MY_TABLE2_IDX    2.0478515625
MY_TABLE3_IDX    1.1923828125

--Test block.
--Uncomment different lines to generate 6 different test cases.
--Regular, Function-based, and Function-based compressed.  Both cached and not-cached.
declare
    v_count number;
    v_start_time number;
    v_total_time number := 0;
begin
    --Uncomment two lines to test the server when it's "cold", and nothing is cached.
    for i in 1 .. 10 loop
        execute immediate 'alter system flush buffer_cache';
    --Uncomment one line to test the server when it's "hot", and everything is cached.
    --for i in 1 .. 1000 loop

        v_start_time := dbms_utility.get_time;

        SELECT COUNT(*)
        INTO   V_COUNT
        --#1: Regular
        FROM   MY_TABLE1 T 
        WHERE  T.EVT_END BETWEEN TRUNC(SYSDATE) AND TRUNC(SYSDATE) + 86399/86400;
        --#2: Function-based
        --FROM   MY_TABLE2 T 
        --WHERE  TRUNC(T.EVT_END) = TRUNC(SYSDATE);
        --#3: Compressed function-based
        --FROM   MY_TABLE3 T 
        --WHERE  TRUNC(T.EVT_END) = TRUNC(SYSDATE);

        v_total_time := v_total_time + (dbms_utility.get_time - v_start_time);
    end loop;

    dbms_output.put_line('Seconds: '||v_total_time/100);
end;
/ 
```

**测试方法**

我每个块至少运行 5 次，在运行类型之间交替（以防我的机器上仅部分时间运行某些东西），扔掉高运行时间和低运行时间，然后平均它们。上面的代码不包括所有这些逻辑，因为它会占用这个答案的 90%。

**其他需要考虑的事情**

还有很多其他的事情需要考虑。我的代码假设数据以非常索引友好的顺序插入。如果这不是真的，事情将完全不同，因为压缩可能根本没有帮助。

这个问题的最佳解决方案可能是通过分区完全避免它。对于读取相同数量的数据，全表扫描比索引读取快得多，因为它使用多块 IO。但是分区也有一些缺点，比如购买选件需要大量资金，以及额外的维护任务。例如，提前创建分区，或使用间隔分区（这有一些其他奇怪的问题），收集统计信息，延迟段创建等。

最终，您需要自己进行测试。但请记住，即使是这样一个简单的选择，测试也很困难。您需要真实的数据、真实的测试和真实的环境。真实的数据比听起来要难得多。使用索引，您不能简单地复制数据并立即构建索引。 `create table my_table1 as select * from`并且`create index ...`将创建与创建表并以特定顺序执行一堆插入和删除不同的索引。

# yii - 如何向 CGridView 添加按钮？

> ID：13494600
> 
> 赞同：3
> 
> 时间：2012-11-21T13:42:09.337
> 
> 标签：yii, cgridview, cbuttoncolumn

听起来很简单，对吧？我已经搜索了高低，我无法找到如何做到这一点。我有一个 CGridView：

```
$dataProvider = new CArrayDataProvider ($auctions);
$this->widget('zii.widgets.grid.CGridView', array(
  'dataProvider'=>$dataProvider,
  'columns'=>array(
    'id::ID',
    'product.title::Title',
    'state::Status',
  ),
)); 
```

我想添加第四列，它只包含一个简单的按钮，按下时将执行 javascript。我试过了：

```
array(
  'class' => 'CButtonColumn',
), 
```

这只是给了我一个错误：

```
Undefined property: stdClass::$primaryKey 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T13:50:03.847

试试这个：

```
$dataProvider = new CArrayDataProvider ($auctions);
$this->widget('zii.widgets.grid.CGridView', array(
  'dataProvider'=>$dataProvider,
  'columns'=>array(
    'id::ID',
    'product.title::Title',
    'state::Status',
     array(
         'type' => 'raw',
         'value' => '<button onclick=\'alert("It works!")\' value="clickme"/>'
     )
  ),
)); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-21T15:47:28.000

最好的方法是使用 CButtonColumn::template 和 CButtonColumn::buttons。

```
array(
    'class' => 'CButtonColumn',
    'template' => '{view} {update} {delete} {copy}',
    'buttons'=>array(
        'copy' => array(
            'label'=>'Copy', // text label of the button
            'url'=>"CHtml::normalizeUrl(array('copy', 'id'=>\$data->id))",
            'imageUrl'=>'/path/to/copy.gif',  // image URL of the button. If not set or false, a text link is used
            'options' => array('class'=>'copy'), // HTML options for the button
        ),
    ),
), 
```

在此示例中，有三个默认按钮和一个自定义按钮，即“复制”按钮。如果您不想要某些默认按钮（即查看、更新和删除），您可以删除它们。然后，定义您添加的按钮的属性。我定义了 label、url、image 和 html 选项。

# c# - DataTable 未正确填充

> ID：13494601
> 
> 赞同：0
> 
> 时间：2012-11-21T13:42:10.747
> 
> 标签：c#, ado.net

我有一个 C# 应用程序。这是我的一段代码：

```
private const string SqlLatestFiles = "SELECT Name, [FileId],[Filename],Age,[ModifiedDT],RcvDT,[Records],[InvalidRecords],[V2Stage],[V1Stage],[FileType] FROM MyDB.[dbo].[LatestFiles] order by [ModifiedDT] DESC;";
...
             using (var da = new SqlDataAdapter(SqlLatestFiles, myConnectionString))
         using (var dt = new DataTable())
         {
             da.Fill(dt);

...
         } 
```

当我在 SQL Server Management Studio 中运行 SqlLatestFiles 时，选择的数据是正确的。但是当填充 DataTable dt 时，V1Stage 为 0。它在今天早上之前没有发生，我怀疑我可以改变什么。有谁知道为什么会发生这种事情？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:04:26.467

我想起了我昨天更改的一件事：我创建了一个数据库副本，该副本在其他数据库中的 LatestFiles 视图中使用。它是 V1Stage 应该来自的数据库。是的！我删除了数据库的副本，现在它可以工作了！我猜 DataAdapter 以某种方式混淆了昨天是彼此精确副本的两个数据库。

# android - ImageView 的自定义形状

> ID：13494603
> 
> 赞同：3
> 
> 时间：2012-11-21T13:42:14.877
> 
> 标签：android

假设我有一个完全矩形的图像：
![在此处输入图像描述](../Images/f119ad9ed9df6467ad3d1670b80b4b2c.png)

现在，当我在 中显示它时`ImageView`，我希望切掉一个角，如下所示： ![在此处输入图像描述](../Images/7277beb3f715c7d8838a4e8160780d39.png)

我怎样才能在运行时实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T10:25:30.580

我已经使用以下代码解决了它：

```
 public static Bitmap maskImage(Context context, Bitmap original) {
            if (original == null)
                    return null;

            Bitmap result = Bitmap.createBitmap(original.getWidth(), original.getHeight(), Config.ARGB_8888);
            Canvas c = new Canvas(result);
            Paint paint = new Paint(Paint.ANTI_ALIAS_FLAG);
            paint.setColor(android.graphics.Color.WHITE);
            paint.setStyle(Paint.Style.FILL);
            paint.setAntiAlias(true);

            Path path = new Path();
            path.moveTo(result.getWidth(), result.getHeight());
            path.lineTo(result.getWidth() - dpToPx(context, CORNERWIDTHDP), result.getHeight());
            path.lineTo(result.getWidth(), result.getHeight() - dpToPx(context, CORNERHEIGHTDP));

            path.close();

            paint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.DST_OUT));

            c.drawBitmap(original, 0, 0, null);
            c.drawPath(path, paint);

            paint.setXfermode(null);
            return result;
    } 
```

# ios - 子类化并将 UIActivityItemProvider 与 UIActivityViewController 一起使用

> ID：13494611
> 
> 赞同：8
> 
> 时间：2012-11-21T13:42:46.450
> 
> 标签：ios, objective-c, xcode, sharing

我终于找到了和我面临同样问题的人。

[UIActivityViewController 根据选定的活动自定义文本](https://stackoverflow.com/questions/12639982/uiactivityviewcontroller-customize-text-based-on-selected-activity)

我想用 UIActivityViewController 的活动自定义内容共享。好的答案如下：

> “不要将文本字符串传递给 initWithActivityItems 调用，而是传递您自己的 UIActivityItemProvider 类的子类，当您实现 itemForActivityType 方法时，它将作为 'activityType' 参数提供共享服务。
> 
> 然后，您可以从此方法返回自定义内容。”

我了解技巧，但我没有办法做到这一点......

我将其作为子类进行：

```
@interface SharingItems : UIActivityItemProvider

@implementation SharingItems

-(id)activityViewController:(UIActivityViewController *)activityViewController itemForActivityType:(NSString *)activityType
{
    // Here depending on the activityType i want to share NSString or UIImage
}

@end 
```

但我不知道现在在我原来的 viewController 中该做什么：

```
-(void)actionSheet
{    
    if ([[UIActivityViewController class] respondsToSelector:@selector(alloc)])
    {
        __block NSString *imgName = [[NSString alloc] initWithFormat:@"%@", _sharingUrl];
        NSArray *activityItems = [NSArray arrayWithObjects:imgName, nil];

        UIActivityViewController *activityController = [[UIActivityViewController alloc] initWithActivityItems:activityItems applicationActivities:nil];
        [self presentViewController:activityController animated:YES completion:nil];

        __block NSString *chan      = [[NSString alloc] initWithFormat:@"%@", _channel];
        [activityController setCompletionHandler:^(NSString* activityType, BOOL completed)
        {
            if (completed)
            {
            }
        }];
    }
    else
        [self displayActionSheet];
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-02T03:03:41.430

这是一个示例 UIActivityItemProvider （未经测试，但改编自工作代码）：

```
@implementation StringProvider

- (id)initWithPlaceholderString:(NSString*)placeholder facebookString:(NSString*)facebookString
{
    self = [super initWithPlaceholderItem:placeholder];
    if (self) {
        _facebookString = facebookString;
    }
    return self;
}

- (id)item
{
    if ([self.activityType isEqualToString:UIActivityTypePostToFacebook]) {
        return _facebookString;
    } else {
        return self.placeholderItem;
    }
}

@end 
```

然后当您设置活动视图控制器时：

```
StringProvider *stringProvider = [[StringProvider alloc] initWithPlaceholderString:@"Default string" facebookString:@"Hello, Facebook."];
UIActivityViewController *shareController = [[UIActivityViewController alloc] initWithActivityItems:@[stringProvider] applicationActivities:nil]; 
```

基本上，您创建 UIActivityItemProviders 以在调用 -(id)item 方法时提供正确的数据，并在创建活动视图控制器时传入这些活动项提供程序。您需要使用占位符项目进行初始化，以便操作系统知道最终项目将是什么类（很可能是 NSString、NSURL、UIImage）。希望有帮助！

# unit-testing - 在 CakePHP 控制器测试中访问模型

> ID：13494612
> 
> 赞同：2
> 
> 时间：2012-11-21T13:42:49.053
> 
> 标签：unit-testing, cakephp, cakephp-2.0

我是 CakePHP 的新手，我刚刚开始编写我的第一个测试。通常在使用 Ruby on Rails 时，我测试 Controller::create 动作的方法是调用 create 动作，然后比较调用前后的模型数量，确保它增加了 1。

有人会以其他方式测试吗？

是否有一种简单的（内置）方法可以从 CakePHP 中的 ControllerTest 访问模型？我在源代码中找不到任何东西，并且通过 Controller 访问它似乎是错误的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-12T01:21:41.967

请注意，我是 CakePHP 的新手，但带着这个问题来到这里。这就是我最终做的事情。

我从@amiuhle 得到了我的想法，但我只是在 中手动完成`setUp`，就像他们在[http://book.cakephp.org/2.0/en/development/testing.html](http://book.cakephp.org/2.0/en/development/testing.html)的模型测试中提到的那样。

```
public function setUp() {
    $this->Signup = ClassRegistry::init('Signup');
}

public function testMyTestXYZ() {
    $data = array('first_name' => 'name');
    $countBefore = $this->Signup->find('count');
    $result = $this->testAction('/signups/add',
        array(
            'data' => array(
            'Signup' => $data)
        )
    );
    $countAfter = $this->Signup->find('count');
    $this->assertEquals($countAfter, $countBefore + 1);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-09T11:46:06.927

我最终做了这样的事情：

```
class AbstractControllerTestCase extends ControllerTestCase {
  /**
   * Load models, to be used like $this->DummyModel->[...]
   * @param array
   */
  public function loadModels() {
    $models = func_get_args();
    foreach ($models as $modelClass) {
      $name = $modelClass . 'Model';
      if(!isset($this->{$name})) {
        $this->{$name} = ClassRegistry::init(array(
          'class' => $modelClass, 'alias' => $modelClass
        ));
      }
    }
  }
} 
```

然后我的测试继承自`AbstractControllerTestCase`，调用并可以`$this->loadModels('User');`在`setUp`测试中做这样的事情：

```
$countBefore = $this->UserModel->find('count');
// call the action with POST params
$countAfter = $this->UserModel->find('count');
$this->assertEquals($countAfter, $countBefore + 1); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-06T16:43:40.587

我不确定为什么有必要测试从控制器操作调用或实例化模型的次数。

因此，如果我正在测试 Controller::create... 我的 ControllerTest 将包含以下内容：

```
testCreate(){
    $result = $this->testAction('/controller/create');
    if(!strpos($result,'form')){
        $this->assertFalse(true);
    }

    $data = array(
        'Article' => array(
            'user_id' => 1,
            'published' => 1,
            'slug' => 'new-article',
            'title' => 'New Article',
            'body' => 'New Body'
        )
    );
    $result = $this->testAction(
        '/controller/create',
        array('data' => $data, 'method' => 'post')
    );
    if(!strpos($result,'Record has been successfully created')){
        $this->assertFalse(true);
    } 
```

}

您要测试的主要内容是您是否获得了正确的输入输出。您可以使用 xDebug 分析器轻松找出在特定操作中实例化了哪些类，甚至实例化了多少次。无需手动测试！

# iphone - 标签边框内的间距

> ID：13494613
> 
> 赞同：0
> 
> 时间：2012-11-21T13:42:50.440
> 
> 标签：iphone, objective-c, ios, xcode, uilabel

朋友们，我创建了一个带边框的 UILabel（如下图所示）。

我想在剩下一/两行之后开始我的标签，然后在完成最后一行标签之后再次在下面一/两行。

有没有办法在标签的边框内获得间距？

![这是带有边框的 UILabel](../Images/702e993338266210dc47fccc7d11d3b2.png)

```
 UILabel *cmntBoxlbl = [[UILabel alloc]initWithFrame:CGRectMake(58, 23, 250, 60)];
     cmntBoxlbl.font=[UIFont fontWithName:@"Arial" size:12];
     cmntBoxlbl.layer.borderColor = [UIColor darkGrayColor].CGColor;
     cmntBoxlbl.layer.borderWidth = 1.0;
      NSString *text = [NSString stringWithFormat:@"%@%@%@",@"  ",[[self.DtlArray  objectAtIndex:indexPath.row] objectForKey:@"comment"],@" "];
      cmntBoxlbl.text = text;

      cmntBoxlbl.textAlignment = UITextAlignmentCenter;
      cmntBoxlbl.lineBreakMode = UILineBreakModeWordWrap;
      [cmntBoxlbl setTextColor:[UIColor darkGrayColor]];

      CGSize expectedLabelSize = [text sizeWithFont:cmntBoxlbl.font
                            constrainedToSize:cmntBoxlbl.frame.size
                                lineBreakMode:UILineBreakModeWordWrap];

      CGRect newFrame = cmntBoxlbl.frame;
      newFrame.size.height = expectedLabelSize.height;
      cmntBoxlbl.frame = newFrame;
      cmntBoxlbl.numberOfLines = 0;
      [cmntBoxlbl sizeToFit];
      [cell addSubview:cmntBoxlbl]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:36:47.517

使当前标签（commentLabel）颜色为白色。创建另一个具有相同内容和较小尺寸的标签，将其放置在边框内。根据需要进行填充

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T13:55:57.813

```
Have you tried this-

      NSString *text = [NSString stringWithFormat:@"\n\n%@%@%@\n\n",@"  ",[[self.DtlArray  objectAtIndex:indexPath.row] objectForKey:@"comment"],@" "]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T17:01:35.017

您可以创建自定义视图并

```
- (void)drawRect:(CGRect)rect {
      ......;
      [string drawInRect:rect withFont:font lineBreakMode:mode alignment:ali];
      ......;
} 
```

希望有帮助

# testing - 如果测试不测量渲染时间，为什么 Visual Studio 负载测试包括浏览器混合？

> ID：13494614
> 
> 赞同：0
> 
> 时间：2012-11-21T13:42:59.317
> 
> 标签：testing, load

根据标题，如果测试不测量浏览器呈现时间，为什么 Visual Studio 负载测试包括浏览器混合？如果 Web 测试仅用于协议级别（HTTP/HTTPS），即从服务器发出请求并接收响应，为什么还要包含浏览器信息，因为这将是客户端交互......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-01T22:15:38.153

将不同的浏览器添加到混合中会发送不同的 User-Agent http 标头。如果您的 Web 应用程序检测到并为不同的客户端返回不同的响应，这允许您测试备用执行路径并捕获它们的结果。

# java - 确认内容类型后如何将 URL 保存到文件中？

> ID：13494615
> 
> 赞同：1
> 
> 时间：2012-11-21T13:43:01.910
> 
> 标签：java, url

如果文件是特定内容类型，我正在尝试从 URL 下载文件。该 URL 可以提供 html 或 pdf 页面，我只想保存 pdf 文件。我这样做的尝试如下：

```
HttpURLConnection connection = (HttpURLConnection) url.openConnection();
connection.setRequestMethod("HEAD");
connection.connect();
String contentType = connection.getContentType();

if (contentType.equals("application/pdf")) {
      org.apache.commons.io.FileUtils.copyURLToFile(url, file);
} 
```

contentType 被正确获取，但调用`copyURLToFile(url,file);`导致以下异常：

```
java.net.SocketException: Connection reset
at java.net.SocketInputStream.read(Unknown Source)
at com.sun.net.ssl.internal.ssl.InputRecord.readFully(Unknown Source)
at com.sun.net.ssl.internal.ssl.InputRecord.read(Unknown Source)
at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(Unknown Source)
at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readDataRecord(Unknown Source)
at com.sun.net.ssl.internal.ssl.AppInputStream.read(Unknown Source)
at java.io.BufferedInputStream.fill(Unknown Source)
at java.io.BufferedInputStream.read1(Unknown Source)
at java.io.BufferedInputStream.read(Unknown Source)
at java.io.FilterInputStream.read(Unknown Source)
at sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.read(Unknown Source)
at sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.read(Unknown Source)
at org.apache.commons.io.IOUtils.copyLarge(IOUtils.java:1025)
at org.apache.commons.io.IOUtils.copy(IOUtils.java:999)
at org.apache.commons.io.FileUtils.copyURLToFile(FileUtils.java:848) 
```

如果我删除用于获取 contentType 的代码行，并且只调用`copyURLToFile(url,file)`，则文件已成功下载并保存。我是否`HttpURLConnection`以某种方式处理不当导致我的连接被重置？

我还注意到，如果我在该`if(contentType.equals("application/pdf")`行上设置断点并等待几秒钟，则调用`copyURLToFile`成功而连接不会被重置。我是否引入了某种总是失败的竞争条件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:48:06.690

为什么不尝试在阅读 HEAD 后关闭连接？

```
 HttpURLConnection connection = (HttpURLConnection) url.openConnection();
   connection.setRequestMethod("HEAD");
   connection.connect();
   String contentType = connection.getContentType();
   connection.close(); 
```

然后 FileUtils 应该打开一个新连接，您的问题可能会得到解决。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T13:53:12.960

您应该使用打开的连接来读取数据：

```
org.apache.commons.io.IOUtils.copy(connection.getInputStream(), new FileOutputStream(file)); 
```

不需要打开另一个连接，可能是服务器重置了连接？

编辑：没有请求方法设置，但是使用 GET 这对我有用：

```
public static void main(String args[]) throws IOException{
    URL url = new URL("http://www.google.com");
    HttpURLConnection connection = (HttpURLConnection) url.openConnection();
    connection.setRequestMethod("GET");
    String contentType = connection.getContentType();
    System.out.println("content-type: " + contentType);
    IOUtils.copy(connection.getInputStream(), new FileOutputStream("/temp/test.html"));
} 
```

编辑：或者那样，如果您想先检查带有 HEAD 请求的标头：

```
URL url = new URL("http://www.google.com");
HttpURLConnection connection = (HttpURLConnection) url.openConnection();
connection.setRequestMethod("HEAD");
String contentType = connection.getContentType();
System.out.println("content-type: " + contentType);
connection.disconnect();
connection = (HttpURLConnection) url.openConnection();
connection.setRequestMethod("GET");
IOUtils.copy(connection.getInputStream(), new FileOutputStream("/temp/test.html"));
connection.disconnect(); 
```

# magento - 跨多个网站的 Magento 客户帐户共享

> ID：13494622
> 
> 赞同：4
> 
> 时间：2012-11-21T13:43:18.697
> 
> 标签：magento

我有一个单一的 magento 安装**（1.6 版）**并为美国、英国和欧洲创建了 3 个网站，每个网站都有自己的商店和商店视图我想实现多货币并在所有这三个网站之间共享一个购物车。一切都很好，但是当我选择

> 系统>配置>默认>客户配置>共享客户帐户到**全球**

，成功登录后尝试重定向客户后出现以下错误

**致命错误：无法在第 293 行的 /home/wwwabc/public_html/lib/Varien/Object.php 中取消设置字符串偏移量**

有时登录成功重定向到我的帐户页面，当客户点击“注销”时显示此错误我认为存在一些会话/cookie 问题但无法解决。

任何人都可以快速帮助...？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:56:27.263

你是在网站级别还是商店级别共享购物车。商店视图级别的默认magento共享购物车？

# iphone - NSUserDefaults - 我应该如何修复此代码？

> ID：13494623
> 
> 赞同：0
> 
> 时间：2012-11-21T13:43:20.537
> 
> 标签：iphone, objective-c, xcode, ios6

我正在尝试制作某种可以记住特定视图的设置向导，但是由于我使用的是 ARC，因此我的 AppDelegate.m 代码存在一些问题。有谁知道如何解决这个问题，因为如果我在启动屏幕上编译应用程序崩溃..

我的 AppDelegate.m：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

    NSString *controllerName = [[NSUserDefaults standardUserDefaults] objectForKey:@"WIZARD_VIEW"];
    if ([controllerName length]) {
        Class controllerClass = NSClassFromString(controllerName);
        UIViewController *controller = [[controllerClass alloc] init];

    // Override point for customization after application launch.
    return YES;
    } 
```

更清楚地说，在 viewcontroller 文件中，我添加了以下代码作为建议：

```
- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    [[NSUserDefaults standardUserDefaults] setObject:[[self class] description] forKey:@"WIZARD_VIEW"];
     NSLog(@"ViewWillAppear Done.");
    [[NSUserDefaults standardUserDefaults] synchronize];
}

- (void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];
    [[NSUserDefaults standardUserDefaults] removeObjectForKey:@"WIZARD_VIEW"];
     NSLog(@"viewWillDisappear");
    [[NSUserDefaults standardUserDefaults] synchronize];
} 
```

编译时的崩溃日志：

```
/Users/Tim/Documents/XCODE_DEV/App/AppDelegate.m:17:33: No visible @interface for 'NSUserDefaults' declares the selector 'forKey:'

/Users/Tim/Documents/XCODE_DEV/App/AppDelegate.m:20:27: Unused variable 'controller' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:55:39.840

查看编译器警告，我猜你在 AppDelegate.m 的第 17 行调用`forKey:`了`NSUserDefaults`.

`NSUserDefaults`没有`forKey:`方法，所以会抛出异常。

它可能只是错误位置的方括号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:23:37.987

第一次必须注册默认值。要注册默认值不足以调用 setObject:forKey 方法，您必须使用 registerDefaults 方法：

```
- (void)registerDefaults:(NSDictionary *)dictionary; 
```

文档：
[NSUserDefaults](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)

所以在你的情况下：

```
NSUserDefaults* standard=[NSUserDefaults standardUserDefaults];
[standard registerDefaults: @{ @"WIZARD_VIEW" : [[self class]description]} ]; 
```

您最好将这些行放在初始化方法中，该方法在任何非静态方法之前被调用。如果默认值已经注册，没有问题，如果是应用程序启动的第二次以上，这不会覆盖您拥有的默认值。

# java - Netbeans：安装了Java模块但无法创建Java项目，为什么？

> ID：13494624
> 
> 赞同：1
> 
> 时间：2012-11-21T13:43:21.260
> 
> 标签：java, netbeans, project

所以我遇到这个问题已经有一段时间了。我可以使用我在 PC 上创建的现有 Java 项目，但在我的笔记本电脑上我无法创建新的 Java 项目。我重新安装了程序并重新安装了几次模块。

因此，当我单击新项目时，每个 java 类型的项目都在列表中，除了名为“java”的常规项目......有趣的是，Java 是我目前唯一需要的项目类型，但它根本不是出现..

我在互联网上寻找答案，但我能找到的只是一个没有答案的话题。

帮助将不胜感激，很多。

编辑：操作系统：Windows 7 64 位。我认为使用 Netbeans 7.2，肯定是最新的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T00:07:35.063

我只是通过简单地删除`.netbeans`文件夹 in`User\<User>\`和`.superId`in解决了这个问题`\AppData\Roaming\NetBeans\`

无需重新安装。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T13:55:27.467

不幸的是，您遗漏了您正在使用的操作系统，并且您没有提及您尝试过的 netbeans 版本！

您应该完全卸载 netbeans。在 UNIX 操作系统上，您会`.netbeans`在您的 homedir 中找到文件夹，netbeans 保存了大量信息。也删除这个文件夹（我不知道这个文件夹在 Windows 操作系统上的存储位置）。

删除 netbeans 和此文件夹后，请尝试重新安装。现在事情应该看起来好多了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-24T09:21:14.810

就我而言，我安装了多个 JDK（JDK 版本 8 和 9），因此 Netbeans 8.2 可能无法按预期工作，然后我无法创建项目。

然后我删除了 JDK9 并从 Windows 中的 \Users\admin\AppData 清除了缓存。

然后我就可以创建 Java 项目了。

# jquery - 使用 jquery 验证输入类型文件

> ID：13494627
> 
> 赞同：1
> 
> 时间：2012-11-21T13:43:38.133
> 
> 标签：jquery, jquery-validate

我有一个包含文件类型输入的表单，但在设计中我不想显示默认浏览按钮，所以从 css 将其转换为文本。这是我的代码。

**html**

```
 FORM #1:<br/>
<form action="#" id="one">
<span id="browse_fb">Upload photo...</span>
<input type="file" name="input1" class="required" />
</form>
FORM #2:<br/>
<form action="#" id="storyform">
<input type="text" name="story" class="required" /><br />
<input type="text" name="place" class="required" /><br />
<input type="submit" />
</form> 
```

**CSS**

```
input[type="file"] {
display: block;
visibility: hidden;
width: 0;
height: 0;
} 
```

**JAVASCRIPT**

```
$(document).ready(function() {
$('#browse_fb').click(function() {
$('input[type=file]').click();
});
$("form#one").validate({ // initialize form validation on form 1
    // rules & other options
});

$("#storyform").validate({ // initialize form validation on form 2
    rules: {
        story: {
            required: true,
            maxlength: 250
        },
        place: "required"
    },
    messages: {
        story: {
            required: "Please write your story",
            maxlength: $.format("At Max {0} characters !")
        },
        place: "Please write your place"
    },
    errorElement: "span",
    wrapper: "span",
    errorPlacement: function(error, element) {
        $("form#one").valid();
        error.insertAfter(element); // default error placement
    },
    submitHandler: function(form) {
        if ($("form#one").valid()) { // test to see if form 1 is valid
            alert('both are valid');
        }
        return false;
    }
});

 }); 
```

这是演示链接..
[http://jsfiddle.net/rashvish18/eLsDs/9/](http://jsfiddle.net/rashvish18/eLsDs/9/)

但是当我通过 jquery 验证器验证它时，它没有得到验证。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T10:01:08.637

```
input[type="file"] {
display: block;
visibility: hidden;
width: 1px;
height: 1px;
} 
```

甚至更好：

```
input[type="file"] {visibility: hidden;}
label.error[for=input1] {display: block;} 
```

# git - 在 git 中为每个部署构建创建一个标签是一个好习惯吗？

> ID：13494637
> 
> 赞同：9
> 
> 时间：2012-11-21T13:44:21.190
> 
> 标签：git, svn, web-applications, deployment, build

我刚从 Subversion 切换到 Git。Subversion 的集中式架构为它提供了一个有意义的修订号，我用它来构建我们基于 Web 的应用程序的更改日志，以便轻松登录并查看在任何给定服务器上运行的版本。Git 没有友好的内部版本号。相反，我看到它建议您从`git status`or的输出中解析某些内容`git tags`。

我不相信我们会始终为我们的分支机构使用客户友好的名称（有时我们为不希望他们使用我们系统的事实的个人客户命名）。所以我想我可以让构建生成一个 datestamp/timestamp 标记`2012-11-21_08-40-23`，就像我过去使用 Subversion 修订号的方式一样。当我们构建一个用于部署的war文件时，构建只会生成这个标签并将其添加到Git中，因此任何部署到任何服务器都会生成一个标签。

目前，我们每隔几天部署一次测试，一个月集成几次（突发），每隔几个月进行一次生产。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T14:03:23.707

您可能想查看[git-version-gen](https://git.kernel.org/pub/scm/git/git.git/tree/GIT-VERSION-GEN?id=HEAD)脚本以生成漂亮的版本号。

它假定您有“vX.Y”形式的标签，并会为您提供“vX.Yz-aaaaaaaa”之类的版本号，其中 z 是提交数，因为标签 vX.Y 和 aaaaaaaaa 是当前 HEAD 的缩短 SHA。

至于标记策略，以这种方式标记发布版本绝对值得。在集成和测试版本上使用它取决于开发的速度。

它也适用于私人开发人员构建，因为标签是从源服务器中提取的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T15:00:15.873

> 相反，我看到它建议您从 git status 或 git 标签的输出中解析某些内容。

这是丑陋的建议。真是又丑又蹩脚。[git describe](https://stackoverflow.com/questions/tagged/git-describe)规则在这里或多或少，阅读[man git describe](http://www.kernel.org/pub/software/scm/git/docs/git-describe.html)会比`status`or `tag`or or `log`or 3-rd-party ready-to-use 脚本有用得多

嗯。像这样对任何修订进行良好命名的技巧（并且您只能标记**一些**变更集，而不是*每个已发布*的）

`git describe --tags --long --match 'SUBSTRING-OF-CLIENT_TAGFAMILY*'`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-26T15:02:43.073

SVN 中修订号的意义在于能够将已发布的代码与源代码控制中的特定修订相关联。我现在认为标记是不必要的，我的问题的答案实际上是只使用由以下生成的提交哈希：

```
git log -1 --format=%H 
```

我以前从未回答过我自己的问题。谢谢大家的回答。我给了你们每个人一个 +1 的尝试。如果我的问题措辞不当（回想起来 - 确实如此），我深表歉意。如果有人想向我解释为什么这是错误的以及如何解决它（或做得更好），我很乐意接受他们的答案作为正确答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-22T03:46:51.907

当你从 subversion 切换到 git 时，你会发现有几个概念具有相同的名称，但含义却截然不同。

分支机构是最大的。我知道的大多数使用 git 的商店都在使用*分支*。事实上，对于每个功能、错误修复、杂务等，都有一个分支。该分支基本上是在代码正在开发、审查、本地测试时临时构建的。然后分支被合并到 master 并被推送到 QA 区域，最后 master 被推送到生产环境。

不过，分支命名是其中一种风格。我有一位同事使用 inits_pt575757_whatever 以便他可以引用跟踪系统 ID，另一位同事使用 pete_1 因为他认为这只是他自己的临时事物，很快就会被合并然后删除。

我倾向于看到标签更多地用于主要版本，但 ymmv

有关整个过程的更多信息，请访问[https://stackoverflow.com/a/9204499/631619](https://stackoverflow.com/a/9204499/631619)

# sql - 在另一个表中不存在记录的连接上选择 null

> ID：13494640
> 
> 赞同：6
> 
> 时间：2012-11-21T13:44:45.810
> 
> 标签：sql, sql-server, join

我遇到了一个问题，经过多次失败的尝试后我似乎无法弄清楚。

我有三个表需要加入一些报告，而在第二个表中可能不存在记录。如果记录不存在，我需要为来自第三个表的数据报告一个空值。

在最基本的形式中，这是表格结构（用于调查）

```
表 A（调查）
----------------------
调查编号 | 调查 ID
016243023708 1152010

表 B（响应）
----------------------------------
调查 ID | 问题 ID | 响应 ID
1152010 1279235 486

表 C（响应值）
--------------------
响应 ID | 价值
486 是的

```

要解释为什么表 B 中可能不存在记录，仅仅是因为这些值是在调查完成时插入的。如果用户没有完成就离开调查（他们可以稍后回来），表 B 中的记录将不存在。为此，表 C 中的值应报告为空。

如果它更容易，我需要专门为 questionid 1279235 进行报告。

这是我到目前为止提出的查询（它向我展示了除了问题 1279235 表 b 中缺少记录的调查之外的所有内容）。

```
SELECT      A.SurveyNumber, A.SurveyId, B.QuestionID, C.Value
FROM        tblA A
LEFT JOIN   tblB B
        ON  A.SurveyId = B.SurveyId
LEFT JOIN   tblC C
        ON  B.ResponseId = C.ResponseId 
WHERE       B.QuestionId = 1279235 
```

如果需要，我可以提供更多说明。

提前致谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-21T13:48:16.003

不要将条件放在 where 子句中，而是放在连接部分，因为`tablec`可能不存在记录。

```
SELECT      A.SurveyNumber, A.SurveyId, B.QuestionID, C.Value
FROM        tblA A
            LEFT JOIN   tblB B
                  ON  A.SurveyNumber = B.SurveyNumber AND 
                      B.QuestionId = 1279235
            LEFT JOIN   tblC C
                  ON  B.ResponseId = C.ResponseId 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T13:48:31.137

试试这个：

```
SELECT
    A.SurveyNumber, A.SurveyId, B.QuestionID, C.Value
    FROM tblA        A
    LEFT JOIN tblB   B ON  A.SurveyId=B.SurveyId AND B.QuestionId=1279235
    LEFT JOIN tblC   C ON  B.ResponseId=C.ResponseId 
```

**编辑**工作示例：

```
DECLARE @tblA  table (SurveyNumber varchar(12),SurveyId int)
INSERT INTO @tblA VALUES ('016243023708',   1152010)
INSERT INTO @tblA VALUES ('016243023708',   1152011)

DECLARE @tblB table (SurveyId int, QuestionId int, ResponseId int)
INSERT INTO @tblB values (1152010,    1279235,      486)
INSERT INTO @tblB values (1152011,    1279235,      487)

DECLARE @tblC  table (ResponseId int, ValueOf varchar(10))
INSERT INTO @tblC values (486,          'Yes')

SELECT
    A.SurveyNumber, A.SurveyId, B.QuestionID, C.ValueOf
    FROM @tblA        A
    LEFT JOIN @tblB   B ON  A.SurveyId=B.SurveyId AND B.QuestionId=1279235
    LEFT JOIN @tblC   C ON  B.ResponseId=C.ResponseId 
```

输出：

```
SurveyNumber SurveyId    QuestionID  ValueOf
------------ ----------- ----------- ----------
016243023708 1152010     1279235     Yes
016243023708 1152011     1279235     NULL

(2 row(s) affected) 
```

# c# - 仅使用类项从网页获取特定数据

> ID：13494642
> 
> 赞同：2
> 
> 时间：2012-11-21T13:44:54.353
> 
> 标签：c#, class, browser

我在想要提取的网页上有一个源代码（我已将其范围缩小到与此处相关的内容：

```
 <div class="sideInfoPlayer">
<a class="signLink" href="spieler.php?uid=12345" title="Profile">
    <span class="wrap">Wagamama</span>
</a> 
```

现在这里的技巧是我想将 Wagamama 这个词放入一个消息框中，但是该站点的每个页面上的这个词都会发生变化，所以我需要获取那个元素，但是这个页面上没有 ID。因此，我想先搜索名为“sideInfoPlayer”的类，然后在前一个类块中找到“包装”类。

我写了下面的内容来获得第一个，但不知道如何处理第二个然后获得所需的值。

```
 HtmlElementCollection col = webBrowser1.Document.GetElementsByTagName("div");
        foreach (HtmlElement element in col)
        {
            string cls = element.GetAttribute("className");
            if (String.IsNullOrEmpty(cls) || !cls.Equals("sideInfoPlayer"))
                continue;
        } 
```

我希望你能帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:48:26.053

你有更好的选择。看看[http://htmlagilitypack.codeplex.com/](http://htmlagilitypack.codeplex.com/)

在这里：[我如何解析 html 字符串](https://stackoverflow.com/questions/13194614/how-can-i-parse-html-string/13194640#13194640)

首先，您需要通过手动下载或使用 NuGet 包管理器来添加对 HtmlAgilityPack 库的引用。

```
// loading html into HtmlDocument
var doc = new HtmlWeb().Load("http://website.com/mypage");
// walking through all nodes of interest
foreach (var node in doc.DocumentNode.SelectNodes("//div[@class='sideInfoPlayer']/span[@class='wrap']"))
{
  // here is your text: node.InnerText
} 
```

`//div[@class='sideInfoPlayer']/span[@class='wrap']`被称为[Xpath 表达式](http://www.w3schools.com/xpath/xpath_syntax.asp)，这个表达式的字面意思是“给我所有带有 class=wrap 的 span 元素，它们是带有 class=sideInfoPlayer 的 div 元素的子元素。

我没有测试它，但它应该可以工作。

# c# - Windows.ApplicationModel.Package 在 .NET 4.5（Windows 8 应用程序）的 NUnit-Test 中不可用

> ID：13494643
> 
> 赞同：2
> 
> 时间：2012-11-21T13:44:54.857
> 
> 标签：c#, .net, visual-studio-2012, nunit, .net-4.5

我想在 Windows 8 应用程序（在 .NET 4.5 下）中创建 NUnit 测试，在该应用程序中读取 XML 文件的内容以在此 XML 结构上运行一些代码。

在 NUnit 测试中，我想做这样的事情：

```
 var file = Windows.ApplicationModel.Package.Current.InstalledLocation.GetFileAsync(@"testxml.xml");

        // settings
        var _Path = @"InternetZeitung\Tests\testxml.xml";
        var _Folder = Windows.ApplicationModel.Package.Current.InstalledLocation;

        // acquire file
        var _File = _Folder.GetFileAsync(_Path).GetResults();
        Assert.IsNotNull(_File, "Acquire file");

        // read content
        var _ReadThis = Windows.Storage.FileIO.ReadTextAsync(_File); 
```

我会用这个做点什么。问题在于`Windows.ApplicationModel.Package`以任何方式调用都会引发异常，因为经过单元测试的代码不是包。现在，我如何才能使用 .NET 4.5 API 从项目中读取文件，而不使用这种（据我所知）唯一的方法来找出文件的路径？

# algorithm - 比较 Canny 算法的轮廓结果和相似度

> ID：13494647
> 
> 赞同：0
> 
> 时间：2012-11-21T13:45:16.133
> 
> 标签：algorithm, comparison, computer-vision, similarity, contour

如何比较从 Canny 算法检索的轮廓并获得相似性响应？有没有基于轮廓的比较算法，或者我必须从头开始做一个？有没有像opencv或类似的“平台”（在python或java中更好）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T04:47:28.347

最有效的轮廓匹配方法之一称为[Shape Context](http://en.wikipedia.org/wiki/Shape_context)。它没有在 OpenCV 中实现，但[这里](http://www.umiacs.umd.edu/~zhengyf/PointMatching.htm)有一个 C++ 实现。

# javascript - 在传单中旋转标记

> ID：13494649
> 
> 赞同：17
> 
> 时间：2012-11-21T13:45:30.187
> 
> 标签：javascript, rotation, icons, marker, leaflet

如何在传单中旋转标记？我会有很多标记，所有标记都有旋转角度。

我已经在 GitHub 上的[Leaflet 上尝试了](https://github.com/CloudMade/Leaflet/issues/386)*runanet/coomsie*的这个解决方案，但我的标记没有任何反应：

```
L.Marker.RotatedMarker= L.Marker.extend({    
    _reset: function() {
        var pos = this._map.latLngToLayerPoint(this._latlng).round();

        L.DomUtil.setPosition(this._icon, pos);
        if (this._shadow) {
            L.DomUtil.setPosition(this._shadow, pos);
        }

        if (this.options.iconAngle) {
            this._icon.style.WebkitTransform = this._icon.style.WebkitTransform + ' rotate(' + this.options.iconAngle + 'deg)';
            this._icon.style.MozTransform = 'rotate(' + this.options.iconAngle + 'deg)';
            this._icon.style.MsTransform = 'rotate(' + this.options.iconAngle + 'deg)';
            this._icon.style.OTransform = 'rotate(' + this.options.iconAngle + 'deg)';
        }

        this._icon.style.zIndex = pos.y;
    },

    setIconAngle: function (iconAngle) {

        if (this._map) {
            this._removeIcon();
        }

        this.options.iconAngle = iconAngle;

        if (this._map) {
            this._initIcon();
            this._reset();
        }
    }

});

var rotated = new L.Marker.RotatedMarker([63.42, 10.39]);
rotated.setIconAngle(90);
rotated.addTo(map); 
```

还有其他想法或解决方案吗？（在 Windows 上使用 Firefox 16 进行测试。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T15:04:26.863

按原样运行代码，当您尝试在 Firefox 中旋转它时，该图标将消失（尝试在鼠标单击而不是加载时旋转，您将看到该图标在您尝试旋转它之前出现），但我愿意打赌它会（第一次）在 webkit 浏览器中工作。原因是变换线：

```
this._icon.style.WebkitTransform = this._icon.style.WebkitTransform + ' rotate(' + this.options.iconAngle + 'deg)';
this._icon.style.MozTransform = 'rotate(' + this.options.iconAngle + 'deg)'; 
```

Firefox 还使用 CSS 变换来定位图标，因此在旋转之前，Moztransform 将具有例如“translate(956px, 111px)”的值。现在的代码方式，它将用简单的“rotate(90deg)”替换它，Firefox 将不知道在哪里放置图标。

您希望 Moztransform 具有“translate(956px, 111px) rotate(90deg)”的值，因此如果您使用此代码，它将在第一次工作，就像在 webkit 中一样。

```
this._icon.style.MozTransform = this._icon.style.MozTransform  + ' rotate(' + this.options.iconAngle + 'deg)'; 
```

但是，它会在下一次旋转时中断，因此您确实需要一次性设置平移和旋转，如下所示：

```
this._icon.style.MozTransform = L.DomUtil.getTranslateString(pos) + ' rotate(' + this.options.iconAngle + 'deg)'; 
```

然后你可以摆脱 L.DomUtil.setPosition(this._icon, pos); 在开始时。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-01-27T08:34:24.773

这个解决方案是迄今为止最简单的：[https ://github.com/bbecquet/Leaflet.RotatedMarker](https://github.com/bbecquet/Leaflet.RotatedMarker)

注意：它只修改现有的标记，允许另外两个选项（rotationAngle 和 rotationOrigin）。

该解决方案效果很好。根据 GitHub 页面，一个使用示例：

```
L.marker([48.8631169, 2.3708919], {
    rotationAngle: 45
}).addTo(map); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-30T13:09:09.410

对我来说非常有效的是为每个标记添加一个 data-rotate="[angle]" 属性。这允许您在必要时在每次刷新时调用以下 JQuery 语句：

```
 $('.your-marker-class').each(function () {            
        var deg = $(this).data('rotate') || 0;
        var rotate = 'rotate(' + $(this).data('rotate') + 'deg) scale(0.5,0.5)';
        $(this).css({
            '-webkit-transform': rotate,
            '-moz-transform': rotate,
            '-o-transform': rotate,
            '-ms-transform': rotate,
            'transform': rotate
        });
    }); 
```

工作速度非常快，并且有数百/数千个标记。在互联网上的某个其他帖子中找到了这种方法，但似乎也可以在这里分享。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-07T16:05:17.110

如果您使用 react-leaflet，我基于这个想法 ( [https://github.com/bbecquet/Leaflet.RotatedMarker](https://github.com/bbecquet/Leaflet.RotatedMarker) ) 创建了一个 React 组件，该组件扩展了 Marker 并接受 rotation 和 rotationOrigin 作为道具。

```
// Libs
import L from 'leaflet'

// Components
import { ExtendableMarker } from 'react-leaflet-extendable'

// HOCS
import { withLeaflet } from 'react-leaflet'

const proto_setPos = L.Marker.prototype._setPos

const LeafletMarker = L.Marker.extend({
  _setPos(pos: [number, number]) {
    proto_setPos.call(this, pos)
    this._setRotation(this.options.rotation)
  },
  _setRotation(rotation: number | null | undefined) {
    if (typeof rotation === 'number') {
      this._icon.style[L.DomUtil.TRANSFORM + 'Origin'] = this.options.rotationOrigin || 'center'
      const transform = this._icon.style[L.DomUtil.TRANSFORM] + ` rotate(${rotation}deg)`
      this._icon.style[L.DomUtil.TRANSFORM] = transform
    }
  },
})

const createRotatedMarker = (pos: [number, number], options: any) => {
  return new LeafletMarker(pos, options)
}

class RotatedMarker extends ExtendableMarker {
  public createLeafletElement() {
    return createRotatedMarker(this.props.position, { ...this.props })
  }
}

export default withLeaflet(RotatedMarker)
```

# entity-framework - EF Code First - 模型，什么时候应该在构造函数中实例化属性？

> ID：13494652
> 
> 赞同：1
> 
> 时间：2012-11-21T13:45:31.653
> 
> 标签：entity-framework, ef-code-first

我想知道何时需要在模型类构造函数中实例化属性以及何时不需要实例化是否有很好的解释？

MS EF 网站上的文档很好，涵盖了很多相关主题

关系和导航属性 - [http://msdn.microsoft.com/en-us/data/jj713564](http://msdn.microsoft.com/en-us/data/jj713564)
使用 API 配置关系[http://msdn.microsoft.com/en-us/data/jj591620%20%22Configuring%20relationships% 20with%20API](http://msdn.microsoft.com/en-us/data/jj591620%20%22Configuring%20relationships%20with%20API)

实体框架类库 [http://msdn.microsoft.com/en-us/library/hh289362%28v=vs.103%29.aspx](http://msdn.microsoft.com/en-us/library/hh289362%28v=vs.103%29.aspx)

并且我也通过阅读书籍编程实体框架 - Julia Lerman 编写的 Code First

我想更好地了解何时需要在模型构造函数中实例化属性。
我在 MS 文档和书中看到了示例，在模型构造函数中有和没有新属性的情况下。某些解决方案使用带有新的 Up 对象的构造函数而其他解决方案不使用，这很可能是有充分理由的。
似乎`Virtual ICollection`has`new List<>`和 complex 类型 has `new RefObj`。但是简单`virtual navigation property`的 ModelObject 类型没有新的就可以了。

**我可以在不了解每个约定类的内部结构的情况下坚持一个模式吗？还是我应该阅读另一个主题？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:56:00.203

您永远*不需要*在模型构造函数中实例化属性以使 EF 工作，但它使它更方便。

例如，如果您有一个 Order 类，并且它有 Order Detail 的子类，并且您想将一个新 Order 添加到您的数据库中。

不初始化 OrderDetails

```
var order = new Order();
order.OrderDetails.Add(new OrderDetail()); // this would error because OrderDetails is null 
```

一种选择是调用 order.OrderDetails = new List(); 在你使用 Add() 之前，但是你需要在你想使用 Add() 的任何地方重复该代码。相反，您可以将该代码放在构造函数中，然后 OrderDetails 将准备好与所有新创建的订单一起使用。

# entity-framework - 使用 EF 连接没有数据库关系的两个表的最佳方法是什么？

> ID：13494656
> 
> 赞同：1
> 
> 时间：2012-11-21T13:45:41.373
> 
> 标签：entity-framework

好的，假设您有两个表：Order 和 OrderLine，由于某种原因，它们在数据库中没有外键关系（这是一个示例，请使用它）。现在，您想使用 Entity Framework 连接这两个表，并编写如下内容：

```
 using (var model = new Model())
        {
            var orders =  from order in model.Order
                          join orderline in model.OrderLine on order.Id equals orderline.OrderId into orderlines
                          from ol in orderlines.DefaultIfEmpty()
                          select new {order = order, orderlines = orderlines};

        } 
```

现在，上面将产生订单和订单线，左连接和所有，但它有很多问题：

1.  简直丑陋
2.  它返回一个匿名类型
3.  它返回同一订单的多个实例，我必须在客户端执行 Distinct() 因为 orders.Distinct() 失败。

我正在寻找的是一个解决方案，它是：

1.  漂亮的
2.  返回静态众所周知的类型而不是匿名类型（我试图投影查询结果，但我遇到了 OrderLines 的问题）
3.  在服务器端运行 Distinct

**任何人？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T15:40:03.890

即使数据库表没有外键关系设置，您也可以像配置实体框架一样配置它们。

将 OrderDetails 导航属性添加到您的 Order 类，然后只查询 Orders。

# c# - 开发虚拟机 VM 上的 TransactionScope 超时连接

> ID：13494659
> 
> 赞同：0
> 
> 时间：2012-11-21T13:45:44.823
> 
> 标签：c#, asp.net, virtualbox, transactionscope

我有一些代码：

```
private static void Delete(int PaxID)
    {
        using (SqlConnection conn = DataHelper.GetDBConnection())
        {
            using (SqlCommand cmd = DataHelper.GetSPCommand("spDeletePax",conn))
            {
                cmd.Parameters.AddWithValue("@PaxID", PaxID);
                cmd.ExecuteNonQuery();
            }
        }
    }

    public static void DeletePaxes(List<int> ids, string bookingRef, string user)
    {
        using (TransactionScope ts = new DataHelper.CreateTransactionScope())
        {
            foreach (var i in ids)
            {
                Delete(i);
            }
            ts.Complete();
        }
    }

    public static SqlConnection GetDBConnection()
    {
        SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["DB"].ConnectionString);
        conn.Open();
        return conn;
    }

    public static TransactionScope CreateTransactionScope()
    {
        var transactionOptions = new TransactionOptions();
        transactionOptions.IsolationLevel = System.Transactions.IsolationLevel.ReadCommitted;
        transactionOptions.Timeout = TransactionManager.MaximumTimeout;
        return new TransactionScope(TransactionScopeOption.Required, transactionOptions);
    } 
```

直到最近工作正常我没有更改任何代码，只是将我的源代码控制从 VSS 更改为 SVN，现在在 VS2012（而不是 2008）中打开了该项目。

如果我调用**DeletePaxes(..)**第一次删除有效，但第二次在连接到数据库时超时

我只是做错了还是 2012/.NET4/4.5 以不同的方式处理事务？我做了一些谷歌搜索并没有发现任何东西（因此在这里发布）

谁能告诉我可能发生了什么？我只是做错了吗？

DTC issetup 所以不要认为它 - 就像我说在我更改源代码控制之前工作正常。如果我将事务更改为默认值 - 不使用静态方法，它也会失败.. 删除事务工作正常我正在使用事务，因为我需要所有或没有删除工作..

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:35:14.393

好的，不要打败我，但事实证明这是虚拟机设置的问题。网络适​​配器设置为 NAT，而不是桥接适配器 - 现在一切都很好。猜测事务无法找到返回 VM 的方式，因此只是坐在那里

可能只是我愚蠢到忘记了这一点，但无论如何感谢所有回复 - 我将阅读表值参数

# wpf - 是否有一些事件表明新的 ContentTemplate 已完全应用？

> ID：13494660
> 
> 赞同：8
> 
> 时间：2012-11-21T13:45:45.167
> 
> 标签：wpf, events, contentcontrol

我有一个 ContentControl，我想在某些情况下更改它的 ContentTemplate。当 ContentTemplate 中的控件加载时，我想添加一些值（文本到 TextBox）。但是，我发现在更改属性 ContentTemplate 后不直接应用新的 ContentTemplate（就加载新模板的所有控件而言）。

```
myContentControl.ContentTemplate = newContentTemplate;
// at this line controls of new template are not loaded! 
```

我通过在该行之后添加此代码进行了测试：

```
var cp = GetVisualChild<ContentPresenter>(myContentControl);
var txt = myContentControl.ContentTemplate.FindName("Path_Cover", cp) as TextBox;
txt.Text = "test"; 
```

获取VisualChild

```
private T GetVisualChild<T>(DependencyObject parent) where T : Visual
    {
        T child = default(T);
        int numVisuals = VisualTreeHelper.GetChildrenCount(parent);
        for (int i = 0; i < numVisuals; i++)
        {
            Visual v = (Visual)VisualTreeHelper.GetChild(parent, i);
            child = v as T;
            if (child == null)
            {
                child = GetVisualChild<T>(v);
            }
            if (child != null)
            {
                break;
            }
        }
        return child;
    } 
```

我有一个错误：

> 此操作仅对应用了此模板的元素有效。

是否有一些事件表明新的 ContentTemplate 已完全应用？

**编辑 1**

@eran 我试过 onApplyTemplate

```
public override void OnApplyTemplate()
{
   var cp = GetVisualChild<ContentPresenter>(Content_Option);
   var txt = Content_Option.ContentTemplate.FindName("Path_Cover", cp) as TextBox;
   txt.Text = "test";
} 
```

但出现错误：

> 你调用的对象是空的。

**编辑 2**

这种“肮脏”的方法效果很好：

```
myContentControl.ContentTemplate = newContentTemplate;

System.Windows.Threading.DispatcherTimer timer = new System.Windows.Threading.DispatcherTimer();
timer.Interval = TimeSpan.FromMilliseconds(0.000001);
timer.Tick += new EventHandler(delegate(object s, EventArgs a)
{
   timer.Stop();
   var cp = GetVisualChild<ContentPresenter>(Content_Option);
   var txt = Content_Option.ContentTemplate.FindName("Path_Cover", cp) as TextBox;
   txt.Text = "teSt";
});
timer.Start(); 
```

有人可以帮助我以更“干净”（专业）的方式实现相同的结果:)

**编辑 3**

我的场景是，我有一个 TreeView（左侧）作为菜单和一个 Grid（右侧）作为 ContentControl 的显示。TreeView 有一些节点。每个节点都有自己的 DataTemplate。每次单击 TreeView 节点时，都会将 DataTemplate 设置为 ContentControl，并从数据库中设置一个值（例如 Path_Cover.Text）。布局或多或少类似于 Windows 资源管理器。

好吧，这是所有必要的代码：

**XAML**

```
 <UserControl.Resources>

      <DataTemplate x:Key="General">
        <StackPanel>
           <DockPanel>
               <TextBlock Text="Cover"/>
               <TextBox Name="Path_Cover"/>
           </DockPanel>
           <DockPanel>
               <TextBlock Text="Slide"/>
               <TextBox Name="Path_Slide"/>
           </DockPanel>
        </StackPanel>
      </DataTemplate>

      <DataTemplate x:Key="Appearance">
        <StackPanel>
           <DockPanel>
               <TextBlock Text="Cover"/>
               <TextBox Name="Path_Cover"/>
           </DockPanel>
           <DockPanel>
               <Button Content="Get Theme"/>
               <TextBox Name="Txt_Theme"/>
           </DockPanel>
        </StackPanel>
      </DataTemplate>

    <UserControl.REsources>

<Grid>
    <ContentControl Name="myContentControl"/>
</Grid> 
```

**代码背后**

```
private void TreeMenu_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
   myContentControl.ContentTemplate =(DataTemplate)this.Resources[Tree_Menu.SelectedItem.ToString()];

   System.Windows.Threading.DispatcherTimer timer = new System.Windows.Threading.DispatcherTimer();
   timer.Interval = TimeSpan.FromMilliseconds(0.000001);
   timer.Tick += new EventHandler(delegate(object s, EventArgs a)
   {
      timer.Stop();
      switch (Tree_Menu.SelectedItem.ToString())
      {
         case "General": 
               var cp = GetVisualChild<ContentPresenter>(Content_Option);
               var txt = Content_Option.ContentTemplate.FindName("Path_Cover", cp) as TextBox;
               txt.Text = "test";

               txt = Content_Option.ContentTemplate.FindName("Path_Slide", cp) as TextBox;
               txt.Text = "test";
               break;

        case "Appearance": 
               var cp = GetVisualChild<ContentPresenter>(Content_Option);
               var txt = Content_Option.ContentTemplate.FindName("Txt_Theme", cp) as TextBox;
               txt.Text = "test";
               break;
      }
   });
   timer.Start();
} 
```

我只需要将 timer.tick 事件处理程序中的代码“移动”到一些在 DataTemplate/ContentTemplate 完全应用后触发的新事件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-18T20:13:40.577

我知道这是一个相当古老的问题，但我一直在寻找这个问题的答案并发明了一个，认为这将是一个分享它的好地方。

我只是创建了我自己的从标准 ContentPresenter 扩展的 ContentPresenter 类：

```
public class ContentPresenter : System.Windows.Controls.ContentPresenter {

    #region RE: ContentChanged
    public static RoutedEvent ContentChangedEvent = EventManager.RegisterRoutedEvent("ContentChanged", RoutingStrategy.Bubble, typeof(RoutedEventHandler), typeof(ContentPresenter));
    public event RoutedEventHandler ContentChanged {
        add { AddHandler(ContentChangedEvent, value); }
        remove { RemoveHandler(ContentChangedEvent, value); }
    }
    public static void AddContentChangedHandler(UIElement el, RoutedEventHandler handler) {
        el.AddHandler(ContentChangedEvent, handler);
    }
    public static void RemoveContentChangedHandler(UIElement el, RoutedEventHandler handler) {
        el.RemoveHandler(ContentChangedEvent, handler);
    }
    #endregion

    protected override void OnVisualChildrenChanged(System.Windows.DependencyObject visualAdded, System.Windows.DependencyObject visualRemoved) {
        base.OnVisualChildrenChanged(visualAdded, visualRemoved);
        RaiseEvent(new RoutedEventArgs(ContentChangedEvent, this));
    }
} 
```

我希望这可以帮助那些正在寻找一个简单的解决方案来解决 ContentPresenter 设计中这种明显疏忽的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T07:58:34.757

一般来说，我不知道有任何此类事件。但是您的场景的典型 WPF 方式是：

```
<ContentControl Name=myContentControl>
<ContentControl.ContentTemplate>
    <DataTemplate>
        <StackPanel>
            ...other controls here
            <TextBox Text={Binding Mode=TwoWay}/>
            ... more controls here
        </StackPanel>
    </DataTemplate>
</ContentControl.ContentTemplate> 
```

后面的代码：

```
myContentControl.Content = "Test"; 
```

或者您可以将 Content 绑定到 ViewModel 的（属性）并将代码放在那里。

如果要访问内容模板中的控件，只需为其命名并从应用内容模板的控件执行 FindName。没有必要用 VisualChild 的东西来搜索 contentpresenter。

我有一种感觉，您正在混淆 controltemplates 和 datatemplates（contenttemplate、itemtemplate）。

1.  OnApplyTemplate 是指应用 ControlTemplate 的那一刻，而不是 ContentTemplate 或任何其他数据模板。
2.  ContentPresenters 是 ControlTemplates 而不是 ContentTemplates 的典型成分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-18T12:42:18.553

我认为 WPF 框架中没有这样的事件。但是，您可以确保在应用新分配的内容模板后运行您的代码。

实现这一点的方法（以及“肮脏”解决方案的“正确”版本）是利用[`Dispatcher`](https://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher(v=vs.110).aspx)与您的`ContentControl`. 此代码将完成您想要实现的目标：

```
myContentControl.ContentTemplate = newContentTemplate;
myContentControl.Dispatcher.BeginInvoke(DispatcherPriority.Loaded, new Action(() =>
{
    var cp = GetVisualChild<ContentPresenter>(myContentControl);
    var txt = myContentControl.ContentTemplate.FindName("Path_Cover", cp) as TextBox;
    txt.Text = "test";
})); 
```

请注意，执行此代码的优先级设置为`DispatcherPriority.Loaded`，因此它将以与您放入`FrameworkElement.Loaded`事件处理程序中的代码相同的优先级执行。

# c# - 如何在 C# 中实现自定义 XML 序列化

> ID：13494661
> 
> 赞同：0
> 
> 时间：2012-11-21T13:45:53.160
> 
> 标签：c#, xml-serialization, datacontractserializer

下面是我的 XML 文件。

```
<Employee>
    <FirstName>#{FirstName}#</FirstName>
    <LastName>#{LastName}#</LastName>
    <DOB>#{DOB}#</DOB>
    <Address>#{Address}#</Address>
    <Transcation>
        <Month>#{Month}#</Month>
        <Amount>#{Amount}#</Amount>
    </Transcation>
    <Transcation>
        <Month>#{Month}#</Month>
        <Amount>#{Amount}#</Amount>
    </Transcation>
    <Transcation>
        <Month>#{Month}#</Month>
        <Amount>#{Amount}#</Amount>
    </Transcation>
    <Transcation>
        <Month>#{Month}#</Month>
        <Amount>#{Amount}#</Amount>
    </Transcation> 
```

我的可序列化类是

```
[XmlRoot("Employee"), Serializable]    
 public class Employee    
 {    
     [XmlAnyElement]
      public List<XmlElement> EmployeeDetails    { get; set; }
 } 
```

但我想得到这样的东西

在我的 EmployeeDetails 中，我应该只序列化 FirstName、LastName、DOB、Address ......并且我应该在一个单独的类中获取 Transcation 列表，其中包含 Month 和 Amount 作为可序列化的元素。

像这样的东西

```
[XmlRoot("Employee"), Serializable]    
public class Employee    
{    
 [XmlAnyElement]
 public List<XmlElement> EmployeeDetails    { get; set; }

 [XmlElement("Transcation")]
 public List<Transcation> Transcations { get; set; }

}

public class Transcation
{
  [XmlElement("Month")]
    public string Month{ get; set; }
  [XmlElement("Amount")]
    public string Amount{ get; set; }

} 
```

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:54:29.470

假设您无法修改 XML，您的类应如下所示。可以使用 XmlAnyElement，但是您可能需要将其设置为对象数组。所以你的代码应该是这样的：

```
[XmlRoot("Employee"), Serializable]
public class Employee
{
    [XmlAnyElement]
    public XmlElement [] EmployeeDetails { get; set; }

    [XmlElement("Transcation")]
    public List<Transaction> Transcations { get; set; }
} 
```

要反序列化，请执行以下操作：

```
 private void DeserializeObject(string filename)
    {
        XmlAnyElementAttribute myAnyElement = new XmlAnyElementAttribute();
        XmlAttributeOverrides xOverride = new XmlAttributeOverrides();
        XmlAttributes xAtts = new XmlAttributes();
        xAtts.XmlAnyElements.Add(myAnyElement);
        xOverride.Add(typeof(Employee), "EmployeeDetails", xAtts);

        XmlSerializer ser = new XmlSerializer(typeof(Employee), xOverride);

        FileStream fs = new FileStream(filename, FileMode.Open);
        var g = (Employee)ser.Deserialize(fs);
        fs.Close();

        Console.WriteLine(g.EmployeeDetails.Length);
        foreach (XmlElement xelement in g.EmployeeDetails)
        {
            Console.WriteLine(xelement.Name + ": " + xelement.InnerXml);
        }
    } 
```

我建议改为指定属性，这样可以更轻松地查找特定值。但这取决于您事先对 xml 模式的了解。

```
[XmlRoot(ElementName="Employee")]    
public class Employee    
{    
  [XmlElement(ElementName="FirstName")]    
  public string FirstName {get;set;}

  [XmlElement(ElementName="LastName")]
  public string LastName {get;set;}

  [XmlElement(ElementName="DOB")]
  public DateTime DOB {get;set;}

  [XmlElement(ElementName="Address")]
  public string Address {get;set;}

  [XmlElement(ElementName="Transaction")]
  public List<Transaction> Transaction {get;set;}
}

[XmlRoot(ElementName="Transaction")]
public class Transaction
{

  [XmlElement(ElementName="Month")]
  public int Month {get;set;}

  [XmlElement(ElementName="Amount")]
  public int Amount {get;set;}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T13:54:21.997

如果您想完全控制 XML 的外观，您可以创建自己的 XMLDocument 并手动添加节点/元素。更多的工作，但您可以精确调整 XML 的外观。

# call - 致命错误：调用未定义的函数 text_view

> ID：13494668
> 
> 赞同：0
> 
> 时间：2012-11-21T13:46:26.723
> 
> 标签：call, php

我在这里有一个基本代码：

```
<?        
include("inc_dblib.php");
include("inc_ecs.php");
$db = dbconnect();
$id = 10;
?>
<?php echo text_view($db,$id,"<h3><br />^lead^</h1>   <br />^text^");?>
    <br /> 
```

在inc_ecs.php里面我有：

```
function text_view($dblink,$id,$code) {

if( !$rset = dbquery($dblink,"article_view",$id) )
return FALSE;
$item = mysql_fetch_assoc($rset);
$text=$item["text"];
$title=$item["title"];
$lead=$item["lead"];
$capelo=$item["capelo"];
$author=$item["author"];

$vowels = array("^text^","^title^","^capelo^","^lead^", "^author^");                                                        
$yummy = array($text, $title, $capelo, $lead,$author);      
$code = str_replace($vowels,$yummy,$code);
return $code;
} 
```

但是每次我运行我的脚本时它都会告诉我

> 致命错误：调用未定义的函数 text_view

. 有任何想法吗？谢谢。

好的，所以我发现了另一个问题。我试图插入回声“Hello World！”；在 inc_ecs.php 的代码中。当我浏览该页面时，我意识到代码的主要部分显示为文本。我转回远程版本，在浏览器中调用时它显示一个空白页面。inc_ecs.php 页面开始显示来自“return $outputVar;”的代码 并显示页面剩余的洞码：

```
function graphical_counter ($db, $id){
    $str = counter($db, $id);
    $visitors_split = chunk_split ($str,1,'');
    $visitors = strlen($str);        
    for ($i ; $i< $visitors ; $i++){
        $outputVar .= "<img src='./images/counter/".$visitors_split[$i].".gif' width='15' height='20' border='0' align='absmiddle'>";
    }
    return $outputVar;
}
/*
End Counter Functions 
```

这段代码有错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:48:33.037

你的包含（）；应该在标签内：

```
<?php
include("inc_ecs.php");
echo text_view($db,$id,"<h3><br />^lead^</h1>   <br />^text^");
?> 
```

# typescript - 打字稿编译器，包括编译中的外部引用

> ID：13494672
> 
> 赞同：1
> 
> 时间：2012-11-21T13:46:35.437
> 
> 标签：typescript

> **可能重复：**
> [引用 TypeScript 文件在输出中包含整个文件](https://stackoverflow.com/questions/13461758/referencing-typescript-file-includes-whole-file-in-output)

我有一个 .ts 文件，它调用另一个 .ts 文件中的函数。我在文件顶部有一个参考路径设置，以便智能感知与编译器一样工作。

但是，编译器会在生成的 .js 文件中包含外部文件的编译版本。

它不会对 jquery 等的定义执行此操作，而是对我编写的所有 .ts 文件执行此操作。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T18:18:12.330

正如史蒂夫芬顿所说，这绝对是重复的。但是，如果您暂时想要解决方法，请在 Web Essentials 中关闭保存时编译。我发现仅在构建时编译不会重现该问题。

# java - 在 JNLP 中指定“包”属性有什么好处？

> ID：13494674
> 
> 赞同：3
> 
> 时间：2012-11-21T13:46:38.543
> 
> 标签：java, jnlp, java-web-start

我注意到您可以`<package />`在 JNLP 中指定属性，如下所述：http: [//lopica.sourceforge.net/ref.html#package](http://lopica.sourceforge.net/ref.html#package)

与让applet 类加载器完成这项工作相比，明确定义它们有什么优势？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T16:23:02.477

JSR-56 规范解释了原因：

[http://jcp.org/aboutJava/communityprocess/mrel/jsr056/index5.html](http://jcp.org/aboutJava/communityprocess/mrel/jsr056/index5.html)

> **4.5 封装元素**
> 
> ...
> 
> package 元素仅适用于延迟下载的资源，因为所有其他资源都已可供 JVM 使用。因此，它已经知道在这些 JAR 文件中实现了哪些包。但是，它可以指示 JNLP 客户端下载正确的惰性 JAR 资源，而不必一次下载每个单独的资源进行检查。

# dynamics-crm-2011 - 无法将选项列表添加到表单

> ID：13494677
> 
> 赞同：0
> 
> 时间：2012-11-21T13:46:45.423
> 
> 标签：dynamics-crm-2011, dynamics-crm-2013

我创建了一个很*挑剔*的字段，但是当我尝试实际输入我的实体形式时，我做不到。我将它拉出并悬停在一个放置它的地方，**但**没有显示标记下车点的红线。

我清楚地记得它在我的上一个项目中做了。事实上，我回到前一个客户的 GUI 并尝试了相同的操作，它在那里工作。我怀疑这可能与不同的版本有关。客户在本地运行（4.0 或 2011），新项目上线（2011），我想知道下一个版本（2013）会如何。

1.  可能是什么原因造成的？
2.  我能做些什么呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:51:41.433

1.  IE 10 不兼容。
2.  (a) 运行 IE9/IE8（**总是**有效）。
    (b) 尝试在向后兼容模式下运行 IE10（经常工作）。
    (c) 等待 CRM/IE10 的更新（运行缓慢且很少）。

作为旁注，我可以说，当我遇到这个问题时，我注意到通过在我们的开发环境中使用远程桌面（或者至少是一个虚拟机，例如 VirtualBox，您将无法访问外部环境） ，可以忽略整个问题，而不必降级到早期版本的 IE。

# android - 如何在 Android 的 achartengine 中显示最新数据？

> ID：13494678
> 
> 赞同：2
> 
> 时间：2012-11-21T13:46:46.610
> 
> 标签：android, achartengine

我使用 achartengine 在我的 Android 应用程序上绘制一些统计条形图。例如，一个屏幕内将有 7 个条形图。但总酒吧应该相当多。而且我想知道如何显示最新的 7 条而不是默认显示前 7 条。有人可以帮忙吗？谢谢！

补充：例如我有 100 个数据/条（***它们与日期/时间一一生成，1 是第一个，100 是最后一个***）如下，但由于手机屏幕尺寸的限制，只有 7 个数据/条恰当地展示。默认情况下，它每次显示前 7 个数据/条。但我想让它显示最后 7 个数据/条，以便我可以直接看到***最新结果***。

默认：

```
1 2 3 4 5 6 7 8 9 10 11 ...95 96 97 98 99 100
------------- 
```

如果拖动图形：

```
1 2 3 ... 33 34 35 36 37 38 39 .... 97 98 99 100
          -------------------- 
```

我希望它是这样的：

```
1 2 3 4 5 6 7 8 9 10 11 ...95 96 97 98 99 100
                           ------------------ 
```

这里------------ 表示手机屏幕。

**我找到了答案：**

```
// show the last 7 data/bars
        if(count < 7){
            renderer.setXAxisMin(0.5);
            renderer.setXAxisMax(7.5);
        }
        else
        {           
            renderer.setXAxisMin(count-7+0.5);
            renderer.setXAxisMax(count-7+7.5);  
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:13:19.220

所以您的系列中有超过 7 个值，并且只显示 7 个条形图？听起来你只是设置了 7 个 xLabels。据我所知，AChartEngine 仅显示设置 xLabels 的数量。因此，您只需添加更多 xLabels。（您想在图表中看到的条形数量）

# javascript - 有没有办法阻止对象成员在我的 JSON 对象中将 .NET 空值序列化为“空值”？

> ID：13494679
> 
> 赞同：0
> 
> 时间：2012-11-21T13:46:50.850
> 
> 标签：javascript, jquery, asp.net, json, serialization

我正在使用 WebMethods 返回自定义类的数组。从 Jquery .ajax 调用返回数组时，它被序列化为 JSON 对象，以便在我的 ASP.NET 应用程序中与 Javascript 一起使用。我遇到的是，如果 Sale 类的任何成员为 null（Nothing），它会在 JSON 对象中序列化为“null”字符串。我真的希望它只显示一个空字符串。我知道我可以编写一个清理方法来将空值转换为空字符串，但我真的很想知道一种为此设置默认行为的方法，以便将空值转换为空字符串。

这是我所有代码的外观：

```
<WebMethod()> _
Public Function GetData(ByVal SaleType As String) As Sale()

    Return DataLayer.GetSalesByType(SaleType)

End Function

Class Sale

    Public Property Type as String

    Public Property InvoiceNumber as Staing

End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:52:41.713

肯定是一个

```
If x Is Nothing Then # String.IsNullOrEmpty(x) Then
    Return ""
End If
Return x 
```

解决这个？

# python - django：通过模型方法订购查询集而不转换为列表

> ID：13494681
> 
> 赞同：1
> 
> 时间：2012-11-21T13:46:58.160
> 
> 标签：python, django, list, django-queryset

我有一个`Complaint`带有`get_latest_response`方法的模型

```
class Complaint(models.Model):
    message         = models.TextField(blank=True)
    email           = models.CharField(max_length=255)

    def get_latest_response(self):
        return ResponseLetter.objects.filter(complaint=self)[:1][0] 
```

方法`get_latest_response`返回对此投诉的最新回复

和`ResponseLetter`模型

```
class ResponseLetter(models.Model): 
    date_response       = models.DateField(db_index=True)
    response_content    = models.TextField()
    response_from       = models.CharField(max_length=255)

    complaint           = models.ForeignKey(Complaint)

    class Meta:
        ordering = ["-date_response"] 
```

然后在`view`我收到投诉（`queryset`）

```
complaints = Complaint.objects.all() 
```

我必须订购`complaints`这些 `get_latest_response().date_response`

但！我无法将其转换`queryset`为`list`喜欢

```
complaints = list(complaints)
complaints.sort(key=lambda x: x.get_latest_response().date_response) 
```

因为在那之后我把它呈现`queryset`在`object_list`：

```
return object_list(request, template_name = 'complaint/complaints.html',
        queryset = complaints, paginate_by = COMPLAINTS_PAGE_SIZE,
        extra_context=extra_context
    ) 
```

还有方法：

```
sorted(complaints, key=lambda a: a.get_latest_response().date_response) 
```

也不行

你能给我什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:54:47.597

您想列出由 ResponseLetter.date_response 排序的投诉。但是 order_by 和 distinct 不能[很好地结合在一起](https://docs.djangoproject.com/en/dev/ref/models/querysets/#distinct)。这是一个解决方法：

```
from django.db.models import Max

Complaint.objects.annotate(max=Max('responseletter__date_response')).order_by('-max') 
```

[测试/工作](https://github.com/jpic/django_test/tree/so_13494681)。

# ruby - 使用 Rake 任务通过 SCP 将文件复制到远程盒子的简单方法？

> ID：13494682
> 
> 赞同：0
> 
> 时间：2012-11-21T13:47:05.973
> 
> 标签：ruby, rake

我过去习惯使用 Python Fabric，我正在尝试用 Ruby 做类似的事情。

基本上，我创建了一个 Rake 脚本，该脚本将作为具有 SSH 密钥设置的特定用户运行，以便对相关框进行无密码访问。

我已经设法使用[https://github.com/seattlerb/rake-remote_task](https://github.com/seattlerb/rake-remote_task)来远程运行命令，并期望“put”方法“正常工作”。然而，它似乎是一个没有利用无密钥身份验证的 Rsync 包装器。

它似乎还期望文件由不是我想要的模板生成，我想 SCP 一个实际的 .tgz 二进制文件。

我是否错过了 Ruby/Rake 生态系统中的某些内容。我希望这很容易，但我觉得我需要回去寻找宝石？

# plot - 如何在 gnuplot 中移动热图的颜色条？

> ID：13494684
> 
> 赞同：5
> 
> 时间：2012-11-21T13:47:13.147
> 
> 标签：plot, gnuplot, heatmap, colorbar

我正在 gnuplot 中绘制一些热图。它有图表和图表右侧的颜色条。但我想改变它在情节中的位置。有人知道改变颜色条在图中位置的命令吗？

谢谢，

蒂亚戈

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T14:20:05.283

您可以使用以下命令`set colorbox`：

```
set colorbox vertical user origin .02, .1 size .04,.8 
```

如果你想要它除了默认位置之外的任何地方，你必须手动设置坐标。有关更多信息，您可以键入

```
help set 
```

在 gnuplot 和所有以 和 开头的选项中`cb`，`colorbox`指的是颜色框的细点。

# iphone - 从文件中读取数据时出现“NSRangeException”

> ID：13494685
> 
> 赞同：1
> 
> 时间：2012-11-21T13:47:18.663
> 
> 标签：iphone, xcode, cocoa, nsrangeexception

当按下主页按钮时，我正在尝试保存数据。这是我的相关代码。

```
 - (NSString *) saveFilePath
{
    NSArray *path =
    NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    return [[path objectAtIndex:0] stringByAppendingPathComponent:@"savefile.plist"];

}
- (void)applicationDidEnterBackground:(UIApplication *)application {
     NSArray *values = [[NSArray alloc] initWithObjects:
                   [NSNumber numberWithInt:askedQuestions],  //for questionLabel
                   [NSNumber numberWithInt:timeMin],         //timeMin
                   [NSNumber numberWithInt:timeSec],         //timeSec
                   [NSNumber numberWithInt:skipCount],       //skipped question
                   [NSNumber numberWithInt:correctAnswers],   //corectAnswers
                   nil];
[values writeToFile:[self saveFilePath] atomically:YES];
 } 
```

saveFilePath 方法提供文件路径。

而在 viewDidLoad

```
NSString *myPath = [self saveFilePath];
BOOL fileExists = [[NSFileManager defaultManager] fileExistsAtPath:myPath]; 
if (fileExists)
{
    NSArray *values = [[NSArray alloc] initWithContentsOfFile:myPath];
    _readerLabel.text = [[values objectAtIndex:0] stringValue];
    askedQuestions=[[values objectAtIndex:0] intValue];
    timeMin=[[values objectAtIndex:1]intValue];
    timeSec=[[values objectAtIndex:2]intValue];
    skipCount=[[values objectAtIndex:3]intValue];
    correctAnswers=[[values objectAtIndex:4]intValue];

}

UIApplication *myApp = [UIApplication sharedApplication];
[[NSNotificationCenter defaultCenter] addObserver:self
selector:@selector(applicationDidEnterBackground:)
 name:UIApplicationDidEnterBackgroundNotification
 object:myApp]; 
```

我得到了这个：

```
Terminating app due to uncaught exception 'NSRangeException', reason: '-[__NSCFArray objectAtIndex:]:        index (0) beyond bounds (0)'
*** First throw call stack:
(0x16a1012 0x13aee7e 0x16a0deb 0x16957e0 0x6891 0x312d 0x305817 0x305882 0x254a25 0x254dbf 0x254f55     0x25df67 0x221fcc 0x222fab 0x234315 0x23524b 0x226cf8 0x2703df9 0x2703ad0 0x1616bf5 0x1616962 0x1647bb6   0x1646f44 0x1646e1b 0x2227da 0x22465c 0x26cd 0x25f5)
libc++abi.dylib: terminate called throwing an exception 
```

代码中的问题在哪里。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:51:38.087

您不是在检查是否有任何效果！

如果发生什么

```
NSArray *values = [[NSArray alloc] initWithContentsOfFile:myPath]; 
```

要么失败（文件可能不存在），要么返回一个包含 0 个项目的数组？

您需要添加以下内容：

```
NSArray *values = [[NSArray alloc] initWithContentsOfFile:myPath];
if (values.count > 0) {
  ...
} 
```

您还应该设置断点`applicationDidEnterBackground:`并逐步执行以确保您的保存方法按预期工作。

* * *

另外，我怀疑这两行之一是错误的：

```
_readerLabel.text = [[values objectAtIndex:0] stringValue];
askedQuestions=[[values objectAtIndex:0] intValue]; 
```

他们都在要求索引 0 处的项目

# php - 在域末尾添加域用户名 - Drupal

> ID：13494686
> 
> 赞同：-1
> 
> 时间：2012-11-21T13:47:25.150
> 
> 标签：php, .htaccess, drupal, cpanel, whm

用户创建了一个帐户，我已授予他对 cpanel 的访问权限。他给了我域名，现在一切正常。但是，当他尝试访问该网站并打开链接时，它会自动添加他的用户名，例如

www.domain.com/~username/contact-us

现在，当他删除 ~username 时，页面仍然显示并且一切正常。

这是他的 htaccess 文件： http: [//pastebin.com/M8xmg8er](http://pastebin.com/M8xmg8er)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:14:25.950

修复 Drupal 中的基本目录`settings.php`/这`.htaccess`不是问题

# c# - 如何使用 binarywriter 编写换行符

> ID：13494687
> 
> 赞同：1
> 
> 时间：2012-11-21T13:47:28.227
> 
> 标签：c#

我正在使用 bianryreader 读取二进制文件的内容并将二进制数据转换为双精度数组。

二进制文件的内容

```
Header
Axis values
Points values 
```

轴值写入后，点值将写入新行。我只是在写一个示例我如何创建一个新行

```
BinaryWriter aBinaryWriter = new BinaryWriter(new FileStream("c:\\newline.txt",FileMode.OpenOrCreate));
aBinaryWriter.Write("\r\n");
aBinaryWriter.Close(); 
```

写作部分工作正常。

## 阅读部分：

我想读取点值，所以我将文件指针移动 2 个位置原因以跳过换行符。但我看到的是 3 个字符的 ascii 值“2,13,10”。

1.  有 3 个 ascii 值的原因是什么？
2.  如何在二进制文件中引入换行符（“\r\n”）。

代码：

```
BinaryReader abinRead = new BinaryReader(new FileStream("c:\\newline.txt",FileMode.OpenOrCreate));
while (abinRead.PeekChar() != -1)
{
    char aChar = abinRead.ReadChar();
    Console.WriteLine(aChar);
 }
 abinRead.Close(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:50:59.523

`BinaryWriter.Write()`写入一个以*长度为前缀的*字符串。
第一个字节是字符串的长度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T13:59:49.770

这里的错误是使用`BinaryWriter`. 如果您正在编写文本文件，请使用`TextWriter`，例如`StreamWriter`：

```
using (var writer = new StreamWriter("foo.txt"))
{
    writer.Write(someString);
    writer.Write(someDouble);
    writer.WriteLine();
} 
```

A`BinaryWriter`仅适用于`BinaryReader`, 用于遵循一组非常具体的二进制规则。在大多数情况下，即使使用二进制文件，原始文件`Stream`也更加通用。但是通过编写文本文件`BinaryWriter`是......好吧，*并非不可能*（你可以`Encoding`自己做等） - 但这不是它的设计目的。

# android - 错误膨胀类片段错误

> ID：13494689
> 
> 赞同：4
> 
> 时间：2012-11-21T13:47:30.857
> 
> 标签：android, android-fragments

我有一个包含两个主要细节片段的主要活动。我正在尝试实现[“多个片段，多个活动”](http://developer.android.com/guide/practices/tablets-and-handsets.html#Fragments)方法。

**布局**文件夹 **activity_main.xml**

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MoneyActivity"
    android:id="@+id/fragment_container" >
 <fragment class="com.mysite.money.AFragment"
              android:id="@+id/AFragment"
              android:layout_width="match_parent"
              android:layout_height="match_parent"/>
 </FrameLayout> 
```

**布局大**文件夹**activity_main.xml**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MoneyActivity"
    android:id="@+id/fragment_container"
    android:orientation="horizontal" >

   <fragment class="com.mysite.money.AFragment"
              android:id="@+id/AFragment"
              android:layout_width="@dimen/action_bar_title_text_size"
              android:layout_height="match_parent"/>

   <fragment class="com.mysite.money.BFragment"
              android:id="@+id/BFragment"
              android:layout_width="match_parent"
              android:layout_height="match_parent"/>

 </LinearLayout> 
```

**我收到如下错误（在 tablet-layout-large 上运行时）：**

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.mysite.money/com.mysite.money.MoneyActivity}: android.view.InflateException: Binary XML file line #15: Error inflating class fragment 
```

我正确检查了片段的类名。

**我想我收到错误 BFragment**

**BFragment：** 公共类 BFragment 扩展 SherlockFragment {

```
 String selectedItem="";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        int size = getArguments().size();
        if(size>0)
        {
            selectedItem = getArguments().getString("position").toString();
        }
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {
        TextView textView=new TextView(inflater.getContext());
        textView.setText("Selected Item->"+selectedItem);
        return textView;
    } 
```

}

**我的 mainActivity 中的 OnItemSelected（与片段 A 关联）**

```
**@Override
    public void onItemSelected(String id) {
          BFragment displayFrag = (BFragment) getSupportFragmentManager().findFragmentById(new BFragment().getId());
        if (displayFrag == null) {
            // DisplayFragment (Fragment B) is not in the layout (handset layout),
            // so start DisplayActivity (Activity B)
            // and pass it the info about the selected item
            Intent intent = new Intent(this, BActivity.class);
            intent.putExtra("position", id);
            Log.i("innodea", "position->"+id);
            startActivity(intent);

        } else {
            // DisplayFragment (Fragment B) is in the layout (tablet layout),
            // so tell the fragment to update
            //displayFrag.updateContent(id);
        }
    }** 
```

**片段：**

```
public class AFragment extends SherlockListFragment {

    private View inflate;
    private Callbacks mCallbacks = sDummyCallbacks;
    private int mActivatedPosition= ListView.INVALID_POSITION;
    private static final String STATE_ACTIVATED_POSITION = "activated_position";

    public interface Callbacks {
        public void onItemSelected(String id);
    }

    /**
     * A dummy implementation of the {@link Callbacks} interface that does
     * nothing. Used only when this fragment is not attached to an activity.
     */
    private static Callbacks sDummyCallbacks = new Callbacks() {
        public void onItemSelected(String id) {
        }
    };

    @Override
    public void onAttach(Activity activity) {
        super.onAttach(activity);
        // Activities containing this fragment must implement its callbacks.
        if (!(activity instanceof Callbacks)) {
            throw new IllegalStateException(
                    "Activity must implement fragment's callbacks.");
        }

        mCallbacks = (Callbacks) activity;
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setListAdapter(new ArrayAdapter<DummyContent.DummyItem>(getActivity(),android.R.layout.simple_list_item_activated_1,android.R.id.text1, DummyContent.ITEMS));
    }

    @Override
    public void onViewCreated(View view, Bundle savedInstanceState) {
        super.onViewCreated(view, savedInstanceState);

        // Restore the previously serialized activated item position.
        if (savedInstanceState != null
                && savedInstanceState.containsKey(STATE_ACTIVATED_POSITION)) {
            setActivatedPosition(savedInstanceState
                    .getInt(STATE_ACTIVATED_POSITION));
        }
    }

    @Override
    public void onDetach() {
        super.onDetach();

        // Reset the active callbacks interface to the dummy implementation.
        mCallbacks = sDummyCallbacks;
    }

    @Override
    public void onListItemClick(ListView listView, View view, int position,long id) {
        super.onListItemClick(listView, view, position, id);

        // Notify the active callbacks interface (the activity, if the
        // fragment is attached to one) that an item has been selected.
        mCallbacks.onItemSelected(DummyContent.ITEMS.get(position).id);
    }

    @Override
    public void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        if (mActivatedPosition != ListView.INVALID_POSITION) {
            // Serialize and persist the activated item position.
            outState.putInt(STATE_ACTIVATED_POSITION, mActivatedPosition);
        }
    }

    /**
     * Turns on activate-on-click mode. When this mode is on, list items will be
     * given the 'activated' state when touched.
     */
    public void setActivateOnItemClick(boolean activateOnItemClick) {
        // When setting CHOICE_MODE_SINGLE, ListView will automatically
        // give items the 'activated' state when touched.
        getListView().setChoiceMode(
                activateOnItemClick ? ListView.CHOICE_MODE_SINGLE
                        : ListView.CHOICE_MODE_NONE);
    }

    private void setActivatedPosition(int position) {
        if (position == ListView.INVALID_POSITION) {
            getListView().setItemChecked(mActivatedPosition, false);
        } else {
            getListView().setItemChecked(position, true);
        }

        mActivatedPosition = position;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:36:33.800

如果您在被调用之前在片段内部进行`android.view.InflateException: Binary XML file line: #... Error inflating class fragment`操作，则可能会发生异常。在这种情况下，您会收到错误的活动参考并且不能依赖它。`getActivity()``onActivityCreated()`

例如下一个模式是错误的：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, 
        Bundle savedInstanceState) 
{
    final View view = inflater.inflate(R.layout..., container, false);

    Button button = getActivity().findViewById(R.id...);
    button.setOnClickListener(...); - another problem: button is null

    return view;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-24T18:59:41.107

需要为静态片段添加唯一 ID。我在仔细查看日志中的错误后找到了它。点击以下链接查看错误详情：

[日志中的错误检查](https://i.stack.imgur.com/NN6Tk.png)

不需要许多帖子中建议的 FragmentActivity。AppCompatActivity 很好。所以，像下面这样的代码工作得很好。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginBottom="10dp"
        android:text="Customize your Android: " />

    <fragment xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:name="com.example.android.android_me.ui.MasterListFragment"
        android:id="@+id/StaticFragment"/>

</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T13:50:45.280

您的片段代码很可能已损坏，并且在创建时会崩溃，最终导致通货膨胀失败。在片段创建期间调用的每个片段和相关方法上设置断点，`onCreateView()`或者尝试手动实例化片段（`new AFragment()`）并将其附加到布局以查看失败的确切位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-05T12:17:17.213

您需要从而不是导入`Fragment`类。`android.support.v4.app.Fragment``android.app.Fragment`

```
import android.support.v4.app.Fragment; 
```

在您打算使用此片段的活动的 XML 文件中，您需要使用：

```
 <fragment
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:id="@+id/map_fragment"
        name="yourpackagname.yourfragmentclass"/>
        //package name here, is the name of folder which is in java directory. 
```

# asp.net - 如何在同一页面登录 WIF 联盟？

> ID：13494691
> 
> 赞同：2
> 
> 时间：2012-11-21T13:47:32.873
> 
> 标签：asp.net, security, login, wif, federation

我有这种情况。

1.  RP 与被动联合为 2。
2.  用于用户/密码身份验证的自定义 STS

    一切正常。至此，用户点击登录链接，进入禁区，触发联邦安全，出现登录界面。它会提示他编写凭据，然后处理请求等。

    现在我需要在同一页面（默认页面）上创建登录（用户/密码）文本框。如何在不重定向到登录页面的情况下实现联合登录操作？我应该（或可以）使用 FederatedPassiveSignIn 控件吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T19:09:35.623

如果 IsAutheticated 为 false，您可以在未受保护的登录页面上显示登录框，然后将消息发送到自定义 STS 登录页面，并使用加密的凭据或其他任何内容，然后在后台登录并重定向回您的应用程序。以正常方式使用令牌。

但是，如果用户未通过身份验证并将登录页面后面的页面添加为书签，他们将被重定向到 STS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T17:27:42.193

对于任何感兴趣的人（我怀疑确实有人），我已经通过 - 基本上 - 模拟登录页面的作用来解决它。

```
// makes credentials validation, and creates IClaimsPrincipal with the acquired claims
IClaimsPrincipal principal = LoginHelper.SignIn(editEmail.Value, editPassword.Value);

// retrieves the instance of the STS (in this case my custom STS)
TrustedSecurityTokenService service = (TrustedSecurityTokenService) TrustedSecurityTokenServiceConfiguration.Current.CreateSecurityTokenService();

// creates the request manually to point to my original page (or whatever page you desire)
SignInRequestMessage request = FederatedAuthentication.WSFederationAuthenticationModule.CreateSignInRequest(Guid.NewGuid().ToString(), "http://page/i/want/to/go/after/the/validation.aspx", true);

// processes first the request...
SignInResponseMessage response = FederatedPassiveSecurityTokenServiceOperations.ProcessSignInRequest(request, principal, service);

// ...then the response is processed, and redirected to URL above
FederatedPassiveSecurityTokenServiceOperations.ProcessSignInResponse(response, Response); 
```

这创建了 cookie，并且主体不是 IsAuthenticated。好像它是由登录页面处理的（至少它似乎按预期工作）。

# matlab - 限制在 Matlab 中绘图的轴

> ID：13494693
> 
> 赞同：-1
> 
> 时间：2012-11-21T13:47:41.523
> 
> 标签：matlab, text, scatter

> **可能重复：**
> [是否可以在散点图中选择特定区域](https://stackoverflow.com/questions/13487407/is-it-possible-to-select-a-particular-region-in-a-scatterplot)

是否可以减少输入文本文件中的数据点，以便那些不会出现在我的计算中。我正在使用以下来读取数据

```
fid = fopen('cr.txt');
A =  textscan(fid, '%f %f %f %f %f %*f %*f %*f %*f %*f %*s %*s %*s') ;
%read the file
a = A{1};
e = A{2};
c = A{3};
x = A{4};
y = A{5}; 
```

这里 x,y 是距离，如果我应用 xlim 和 ylim，我也想限制文件中相应的 a,e,c。该文件有大约百万个数据点。

我将进一步绘制 x、y 和 z（从 a、e、c 计算）作为散点图和颜色条，我用于整个数据点的绘图代码是

```
lg=log10(g2);
scatter(x(1:end-1), y(1:end-1),5, lg);
colorbar('eastoutside');
caxis([14 max(lg)]);
xlabel(' X-axis (microns)');
ylabel('Y-axis (microns)'); 
```

lg 由前面所示的 a,e,c 确定。所以我想做的就是在 x,y 的选定部分和相应的 lg 之间做一个绘图。

请帮忙！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:55:14.983

是的，您可以直接在`axes`using`set`或通过调用`xlim`、`ylim`和`zlim` [函数指定限制](http://www.mathworks.com/help/matlab/ref/xlim.html)

```
plot(rand(1,100));
set(gca,'XLim', [10 20] ); % set the xlims to 10,20 
```

或者

```
plot(rand(1,100));
xlim([10 20]); % set the xlims to 10,20 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:32:05.117

好吧，这可能太明显了，无法解决您的问题，但是在这一行中：

```
scatter(x(1:end-1), y(1:end-1),5, lg); 
```

如果`lg`大小与`x`and相同`y`，那么显然这是错误的，您需要这样做：

```
scatter(x(1:end-1), y(1:end-1),5, lg(1:end-1)); 
```

如果这不能解决您的问题，那么正如我在评论中所说，您必须提供我们可以运行以重现问题的完整代码，包括 、 和向量的`x`示例`y`数据`lg`。

# assembly - 如何在程序集 8086 中使用带有符号整数的 ADD 指令？

> ID：13494694
> 
> 赞同：2
> 
> 时间：2012-11-21T13:47:43.183
> 
> 标签：assembly, add, x86-16

所以如果我想添加两个无符号整数，我会简单地写

```
dat1 db ff
dat2 db ff
res dw ? 
```

并在代码段中：

```
mov ax, dat1
add ax, dat2
mov dl,0
adc dl,0 ;initialize the contents of dl and use it to store the carry flag
mov byte ptr res, ax
mov byte ptr res+1, dl 
```

但是，如果我想添加两个有符号整数，代码会是什么样子？我可以以某种方式访问​​标志标志吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:41:16.550

首先是错误：

*   它从仅分配 8 位的变量中读取 16 位。
*   写入地址 res+1 也没有意义（但写入 res+2）。
*   也尝试写`mov byte ptr addr, ax`应该失败
    *   应该`mov word ptr res, ax`

第一个问题的答案是：没什么特别的。
`add ax, bx`不在乎他们是否签名。检查状态寄存器时，有趣的部分就来了。那里有*进位标志*、*符号标志*和*溢出标志*。（以及 25 个以上不相关的标志）。附带说明：如果 carry_flag != sign_flag*用于相同符号的加数，*则设置了溢出标志。这意味着两个负数的加/减可以解释为正数，或者两个正数相加可以*解释*为负数。对于不同符号 (3) + (-2) 的加数，不会发生溢出。

可以通过比较和分支访问标志标志：

```
add ax,bx  
jns process_unsigned   // or
js process_signed 
```

或者，如果您担心将寄存器的符号位转移到其他地方，您可以
- `mov cl, 16; sar ax, cl;` // 将符号位移到单词 ax 上 ***或***
- `add ax, ax`(*或* `shl ax,1`) // 将符号位移出 AX 的“左侧”到*进位*

此外，还可以将`pushf` [状态标志](http://en.wikipedia.org/wiki/FLAGS_register)、`pop ax`它发送到通用寄存器，并检查任何单个位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T15:11:53.860

忽略示例代码中的错误（请参阅 Aki 的答案）...

如果您尝试添加一对 24 位数字；那么第一个 24 位数字是正数，因为该数字的符号位在您移入 DL 的 0 的第 7 位（在`mov dl,0`指令中）。第二个 24 位数也是正数，因为它的符号位在您添加到 DL 的 0 的第 7 位（在`adc dl,0`指令中）。

在这种情况下，加法的结果将为正（加 2 个正数将给出正结果），并且 CPU 的符号标志将正确显示将 24 位数字相加的结果为正。CPU 的进位标志和溢出标志也将正确（并且都将被清除）；因此您可以使用`js`,`jg`和之类的指令正常测试它们`jo`（即使您知道它们都很清楚并且条件分支可以被删除或转换为`jmp`）。CPU 的奇偶校验标志和零标志可能是错误的（例如，零标志只会说明最高 8 位是否全为零，而不会告诉您整个 24 位是否全为零）。

但是，如果您认为您正在添加带符号的 16 位数字（并试图获得 24 位结果），那么您做错了并且会得到错误的结果。要添加带符号的 16 位数字并获得 24 位结果，您必须对 16 位数字进行“符号扩展”以使其成为 24 位，而不是“零扩展”这些数字。例如，16 位（负）数 0xCDEF 应变为 24 位（负）数 0xFFCDEF，而不是 24 位（正）数 0x00CDEF。

另一种选择是像往常一样添加 16 位数字，然后将结果符号扩展为 24 位。这仅在 16 位加法没有溢出时才有效，并且如果加法不能溢出，那么您不需要 24 位结果开始。

# php - 读取excel数据并以以下格式插入

> ID：13494698
> 
> 赞同：0
> 
> 时间：2012-11-21T13:48:03.023
> 
> 标签：php, mysql, excel, csv

我在 excel 表中有数据，如下所示。

![在此处输入图像描述](../Images/1040994426c89fefc7311a177cb4910d.png)

我必须阅读数据（我会尝试 csv 格式，请另外提出建议）。使用 PHP 读取数据...

创建两个表，希望如下所示。

1.

![在此处输入图像描述](../Images/0b09d992c8101d210ca34c9cc40bce99.png)

2.

![在此处输入图像描述](../Images/5d26e8bbbbd291bf11c7f1c8c16615e4.png)

3.  我期待这样的 ExtJs 树。

![在此处输入图像描述](../Images/fe834084a9a0f6cbda0bbd874d764f67.png)

我在步骤 1 中遇到了问题。我应该如何阅读我的 excel 表、csv 文件，以便数据库像表格一样更新`1`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:30:25.133

这是一个解决方案，尽管我没有像您那样维护相同的 Data_Id（您似乎按深度和节点增加了 id，但我只是使用了行号）。

```
<?php
$data = <<<EOT
Eatables,,
,Fruits,
,,Apple
,,Mango
,Vegetables,
,,Tomatoes
,,Potatoes
EOT;

$mysqli = new mysqli("localhost", "username", "password", "test");

$dataInsertStatement = $mysqli->prepare("INSERT INTO Data (Data_Id, Data_Value) VALUES (?, ?)");
$treeInsertStatement = $mysqli->prepare("INSERT INTO Tree (parent_id, child_id) VALUES (?, ?)");

$lines = explode("\n", $data);

$path = array();

foreach ($lines as $rowNum => $line) {
    // convert line of csv to array
    $row = str_getcsv($line);
    // loop through the row's fields and find the one that's not empty
    foreach ($row as $column => $value) {
        if (!empty($value)) {
            // use row number + 1 as $Data_Id
            $Data_Id = $rowNum + 1;

            // track our depth in the tree
            $path[$column] = $Data_Id;

            // insert the data
            $dataInsertStatement->bind_param('is', $Data_Id, $value);
            $dataInsertStatement->execute();

            // check if this node has a parent
            if (isset($path[$column - 1])) {
                // connect this node to its parent in the tree
                $treeInsertStatement->bind_param('ii', $path[$column - 1], $Data_Id);
                $treeInsertStatement->execute();
            }

            continue;
        }
    }
}

$mysqli->close(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:31:29.363

就像是

```
lastvalues=array(); // To hold the last value on each level
data=array();
foreach($lines as $i=>$line){
  elems=explode(',',$line);
  foreach($elems as $n=>$e){
     if($e>''){
        $data[$i]=$e;
        lastvalues[$n]=$i;
        if($n){ // makes no sense for 0th level
           $tree[]=array('parent'=>$lastvalues[$n-1],child=>$i);
        }
     }
  }
} 
```

应该给你数据结构。您可以使用 SQL 插入而不是 $data 和 $tree 数组。

# ruby-on-rails - Rails 关系

> ID：13494704
> 
> 赞同：1
> 
> 时间：2012-11-21T13:48:24.703
> 
> 标签：ruby-on-rails

我将如何定义员工有经理和可能有一些下属（所有这些都是员工模型的例子）的关系？到目前为止，我的尝试导致任何给定的人最多只有一个下属。

```
has_one :manager, :class_name => Employee, :foreign_key => "manager"
has_many :subordinates, :class_name => Employee, :foreign_key => "manager" 
```

我觉得这很明显，但是我的头撞在墙上使它变得困难。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T13:58:12.900

试试这个：

```
class Employee

  belongs_to :manager,      :class_name => 'Employee', :inverse_of => :subordinates
  has_many   :subordinates, :class_name => 'Employee', :inverse_of => :manager

end 
```

# asp.net - 如何使用 @Ajax.ActionLink 更新 Html 文档标题

> ID：13494707
> 
> 赞同：0
> 
> 时间：2012-11-21T13:48:25.827
> 
> 标签：asp.net, asp.net-mvc, razor, asp.net-mvc-4

单击 Ajax.ActionLink 时，我希望页面标题根据 ViewBag.Title 自动更改。我可以这样做，但我无法从 ActionExecutedFilter 访问在“razor.cshtml”文件中分配的 ViewBag.Title。我可以从 ActionExecutedFilter 访问仅在 Action Method 中分配的 ViewBag.Title。

ActionExecutedFilter 可能是这样的：

```
string scriptText = "<script type='text/javascript'>document.title = '" 
                    + ViewBag.Title + "';</script>";
filterContext.HttpContext.Response.Write(scriptText); 
```

如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:23:40.660

我认为这可以解决您的问题。但是它没有使用 ViewBag，但标题的值也将与您的部分视图文件相关联，如果我理解得很好，这是您的意图。

**你的部分观点**

```
<span id="mySpan" style="display:none">Page header</span>
@Ajax.ActionLink("MyLink", "Random", 
                 new AjaxOptions() { HttpMethod = "GET", 
                                     UpdateTargetId = "random", 
                                     OnSuccess = "document.title = document.getElementById('mySpan').innerHTML" 
                  });

<div id="random">
    Random goes here.
</div> 
```

您想要从局部视图设置到文档标题的值隐藏在跨度内（它也可能是某些标题`<h1/>`或子标题的值`<h2/>`......取决于您的需要）。

# java - Capture picture from webview loading local html

> ID：13494716
> 
> 赞同：2
> 
> 时间：2012-11-21T13:48:48.217
> 
> 标签：java, android, webview, image, capture

I'm trying to capture a image from the webiview, it works when I try to loadUrl from the web, but when I try to load a local html file in assets or html in a String it crashs with the following error:

```
java.lang.IllegalArgumentException: width and height must be > 0
    at android.graphics.Bitmap.createBitmap(Bitmap.java:638)
    at android.graphics.Bitmap.createBitmap(Bitmap.java:620) 
```

My Code is:

```
//Create the webview

WebView w = new WebView(this);

w.setWebViewClient(new WebViewClient() {
    public void onPageFinished(WebView view, String url) {
        //get the picture from webview
        Picture picture = view.capturePicture();

        Bitmap b = Bitmap.createBitmap(picture.getWidth(),
                       picture.getHeight(), Bitmap.Config.ARGB_8888);

        Canvas c = new Canvas(b);

        picture.draw(c);

        FileOutputStream fos = null;

        try {

        String path = Environment.getExternalStorageDirectory().toString();
        File dir = new File(path, "/Movel/media/img/");
        if (!dir.isDirectory()) {
            dir.mkdirs();
        }
        String arquivo = "darf_"+ System.currentTimeMillis() + ".jpg";
        File file = new File(dir, arquivo);

        fos = new FileOutputStream(file);
        String imagePath =  file.getAbsolutePath();
        //scan the image so show up in album
        MediaScannerConnection.scanFile(MainActivity.this,  new String[] { imagePath }, 
                        null, new MediaScannerConnection.OnScanCompletedListener() {
                            public void onScanCompleted(String path, Uri uri) {

                            }
                            });

        if (fos != null) {
            b.compress(Bitmap.CompressFormat.JPEG, 90, fos);

            fos.close();
        }

        } catch (Exception e) {
        e.printStackTrace();
        }
    }
    });

setContentView(w);

String html = "<html><head><meta http-equiv='Content-Type' content='text/html; charset=ISO-8859-1'> " +
    "<title>Demo Html</title> </head> <body>  <H1>Testing One Two Three</H1> </body></html>";

//load from assets
//w.loadDataWithBaseURL("file:///android_asset/", Strings.converterParaElementosHTMLEspeciais(html), "text/html", "iso-8859-1", null);
//w.loadUrl("file:///android_asset/darf.html");
//w.loadUrl("https://www.google.com.br");
w.loadData(html, "text/html", "iso-8859-1"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:58:39.423

this error because your `WebView` width and height is `0`, so you must `Layout` your `WebView` first, then try this code:

```
myWebView.setWebChromeClient(new WebChromeClient() {
        @Override
        public void onProgressChanged(WebView view, int newProgress) {
            super.onProgressChanged(view, newProgress);
            if (newProgress == 100) {
                view.post(new Runnable() {

                    @Override
                    public void run() {
                        // take the snapshot here

                    }
                });

            }
        }

    }); 
```

# php - 无需迭代即可将数组转换为键值数组

> ID：13494721
> 
> 赞同：0
> 
> 时间：2012-11-21T13:48:56.707
> 
> 标签：php

将对象数组映射到对象的键值数组的最简单方法是什么，其中键是对象的某些属性？

例如：

```
class Cartoon
{
  public $title;
  public function __construct($title)
  {
    $this->title = $title;
  }
}

$cartoons = array(new Cartoon('Tom and Jerry'), new Cartoon('Cheburashka'));

$mappedCartoons = array();

foreach ($cartoons as $cartoon)
{
  $mappedCartoons[$cartoon->title] = $cartoon;
}

print_r ($mappedCartoons); 
```

PS。我想知道是否可以处理迭代和额外的变量`$mappedCartoons`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:25:34.270

你可以`array_reduce`用来实现你的目标。

```
<?php

$cartoons = array_reduce($cartoons, function($result, $cartoon) {
  $result[$cartoon->title] = $cartoon;
  return $result;
}, array());

?> 
```

这个想法不是我的，在这里找到：[http ://www.danielauener.com/howto-use-array_map-functionality-on-an-associative-array-changing-keys-and-values/](http://www.danielauener.com/howto-use-array_map-functionality-on-an-associative-array-changing-keys-and-values/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:11:08.523

如果您必须使用基本数组，您可以在创建它们时简单地键入键：

```
$cartoons = array(
    'Tom and Jerry' => new Cartoon('Tom and Jerry'), 
    'Cheburashka' => new Cartoon('Cheburashka'),
); 
```

或者，您可以创建实现各种数组/迭代相关接口并可以用作常规数组的容器对象：

```
class CartoonArray extends ArrayObject {

    public function __construct($input, $flags = 0, $iterator_class = "ArrayIterator") {
        parent::__construct(array(), $flags, $iterator_class);
        // since the original ArrayObject implemented in C and they don't it won't pick up our overriden ossetSet we have to type it out here explicitly
        foreach ($input as $value) {
            $this->offsetSet(null, $value);
        }
    }

    public function offsetSet($index, $value) {
        parent::offsetSet($value->title, $value);
    }
}

$cartoons = new CartoonArray(array(new Cartoon('Tom and Jerry'), new Cartoon('Cheburashka')));
$cartoons[] = new Cartoon('Sesame street');

print $cartoons['Tom and Jerry']->title;
unset($cartoons['Tom and Jerry']);

foreach ($cartoons as $k => $v) {
    print $k."\n";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:12:38.433

我想不出不涉及迭代的方法。我*可以*想到一种不需要额外变量的方法：

```
$cartoons = array(new Cartoon('Tom and Jerry'), new Cartoon('Cheburashka'));
foreach( $cartoons as $key => $cartoon )
{
    $cartoons[ $cartoon->title ] = $cartoon;
    unset( $cartoons[ $key ] );
}

var_dump( $cartoons ); 
```

但是，注释[的文档`foreach`](http://php.net/manual/en/control-structures.foreach.php)：

> 由于 foreach 依赖于内部数组指针，因此在循环内更改它可能会导致意外行为。

我不完全确定这也适用于我的示例。也许其他人可以在这里插话。

为了安全起见，也许这种替代方案更合适，因为它在迭代之前`$len`以 的初始长度开始`$cartoons`：

```
$cartoons = array(new Cartoon('Tom and Jerry'), new Cartoon('Cheburashka'));
for( $i = 0, $len = count( $cartoons ); $i < $len; $i++ )
{
    $cartoon = $cartoons[ $i ];
    $cartoons[ $cartoon->title ] = $cartoon;
    unset( $cartoons[ $i ] );
}

var_dump( $cartoons ); 
```

此示例假定初始`$cartoons`具有“正确”的顺序编号键`0`，但从 开始。

# firefox - firefox add-on sdk：使面板保持可见

> ID：13494722
> 
> 赞同：1
> 
> 时间：2012-11-21T13:48:57.500
> 
> 标签：firefox, firefox-addon, firefox-addon-sdk

我正在尝试基于他们的 SDK 构建一个 Firefox 插件，我想为此使用[面板。](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/packages/addon-kit/panel.html)面板连接到一个[小部件](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/packages/addon-kit/widget.html)，所以每次我点击小部件图标时，面板都会显示。我的问题是我希望面板保持可见，即使我单击面板外部的区域并且只能根据特定情况关闭。这可以实现，还是面板API不支持这个？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T03:22:02.260

无法通过 SDK API 实现。但是，您实际上可以“破解”面板以保持持久性，问题是您将面临其他问题 - 基本上不会消失，以及其他小问题。

如果您有兴趣，可以获取有关 Bugzilla 的更多详细信息：[为面板添加“isPersistent”属性](https://bugzilla.mozilla.org/show_bug.cgi?id=595040)。请注意，该错误是 WONTFIX，但它会让您了解您可能面临的问题。此外，未来还会出现一些新的小部件，它们可以减轻面板“持久化”的需求（在上面的错误中提到并链接了它们）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-02T21:55:24.150

这是执行此操作的官方 sdk 方法：

```
let myPanel = Panel({.....})

let { getActiveView }=require("sdk/view/core");
getActiveView(myPanel).setAttribute("noautohide", true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T19:01:00.103

SDK 不支持浮动面板

# https - 需要一些关于 Https 的见解

> ID：13494723
> 
> 赞同：0
> 
> 时间：2012-11-21T13:49:06.983
> 
> 标签：https, certificate, classloader, signature, fraud-prevention

如果这个问题真的很幼稚，请原谅，但我尽可能多地搜索却无法找到相关答案。

我花了最后三天试图了解 https 的工作原理。这些天之前我所知道的只是对称和非对称密码学是如何工作的。我是时候了解这两者是如何应用在 ssl-https 上并实现所谓的数据加密和服务器身份验证的了。

关于数据加密和防止中间人攻击，一切都很清楚

似乎我并不完全了解服务器身份验证的工作原理，因此我们将非常感谢您的帮助。

到目前为止，我的理解如下：

当客户端通过 https 连接到服务器时，服务器会发送一个由 CA 签名的证书。此服务器证书是一个文本文件，其中包含有关服务器的信息（名称、所有者电子邮件、公钥等）以及数字签名。

此签名是服务器信息内容的散列，由 CA 私钥加密。

客户端通过再次自己生成服务器信息的哈希并使用 CA 的公钥解密签名来检查签名的有效性。如果解密后的签名值与产生的哈希值相同，则签名和证书随后都是有效的。

请注意，公私加密方案具有双重性质。消息可以用公钥加密，用私钥解密。相同的消息可以用私钥加密，也可以用公钥解密。

我们需要记住的是，证书是一个静态且不可更改的文件。对文件的任何更改都将导致签名不匹配。

我现在将描述一种欺骗 https 的方法：

假设有一个 URL = [https://wwww.TheBank.com/ebanking](https://wwww.TheBank.com/ebanking)（公共 IP = 195.134.0.1）的电子银行网站，我连接到这个 URL，我的浏览器获取服务器证书。(theBank.cer)

同时，我是一家网吧的老板。我的网吧有自己的路由器、DNS 和 DCHP 服务器，我可以控制这些服务器。它也有一个网络服务器。

我将 Web 服务器配置为拥有 ip 195.134.0.1，与银行的相同我创建了一条到路由器的路由，该路由将 195.134.0.1 的连接请求发送到我的 Web 服务器我配置我的 DNS 以将上述银行 URL 指向 195.134.0.1（我的网络服务器）我在我的网络服务器上放置了一个欺诈性银行网站。对于此站点上的任何连接，我指示 Web 服务器将我之前下载的证书发送给客户端。( theBank.cer)

一个用户来到我的咖啡馆，连接到我的网络并尝试连接到这家银行。我的服务器将银行证书发送给他。他的浏览器将确认证书的有效性，因为它确实是有效的，并允许连接到我的假网站，因为它的 URL、IP 和主机名与真实网站相同。

所以我的欺诈成功了。

当然，这个安全漏洞太明显了，不可能是真的。意思是我在这个服务器身份验证过程中没有理解一些东西。有人可以向我解释我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:54:50.780

> 一个用户来到我的咖啡馆，连接到我的网络并尝试连接到这家银行。我的服务器将银行证书发送给他。他的浏览器将确认证书的有效性，因为它确实是有效的，并允许连接到我的假网站，因为它的 URL、IP 和主机名与真实网站相同。

一旦他的浏览器确认了有效性，它就会知道银行的真实公钥，因为它在证书中。由于您的服务器无法使用与该公钥对应的私钥签署任何内容，也无法解密使用该公钥加密的任何内容，因此您根本无法冒充银行。您所能做的就是让用户相信银行的真实身份，这是您无法冒充的。

我认为您缺少的关键是证书的主要目的是让受信任的机构将真实世界的身份绑定到公钥，这样只有该真实世界身份的所有者才知道相应的私钥。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T13:52:37.150

`theBank.cer`是**公钥**。
你不能用它来解密或签署任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:30:36.447

> 此签名是服务器信息内容的散列，由 CA 私钥加密。
> 
> 客户端通过再次自己生成服务器信息的哈希并使用 CA 的公钥解密签名来检查签名的有效性。如果解密后的签名值与产生的哈希值相同，则签名和证书随后都是有效的。

这或多或少是 RSA 发生的情况，但不是 DSA，它只是签名（无加密）。

一般来说，你不应该谈论用私钥“加密”。这没有任何意义，因为任何人都可以使用公钥解密（因为它是公开的）。加密是关于隐藏信息。

您可以使用私钥执行的操作是签名和解密/解密。您可以使用公钥来加密和验证签名。

如果您在需要加密和需要签名时混淆（尽管算法与 RSA 非常相似），您最终可能会设计出不提供任何安全性的系统。

更一般地说，公钥证书（X.509 证书，甚至 PGP 证书）的目的是将身份（例如服务器主机名）绑定到公钥。（请参阅[Security.SE 上的这个问题](https://security.stackexchange.com/a/16106/2435)。）

> 我的网络服务器将收到的数据将由银行的公钥加密

请注意，SSL/TLS 流量不是使用证书的私钥加密的，而是在 SSL/TLS 握手期间协商的共享密钥。

在 SSL/TLS 握手期间，该公钥用于加密预主密钥或签署其他参数（取决于密码套件），最终向客户端证明它正在与具有私钥的服务器通信此公钥的密钥。

由于证书还将服务器名称绑定到公钥，因此客户端知道它正在与正确的服务器通信。

这就是为什么验证 (a) 证书是受信任的并且 (b) 它被颁发给客户端想要连接的服务器名称很重要的原因。

# javascript - 在 GetJson 更改 url 历史记录

> ID：13494727
> 
> 赞同：1
> 
> 时间：2012-11-21T13:49:21.823
> 
> 标签：javascript, jquery, json

如果我的地址是“http://localhost:8000/index”，我运行这个 jquery：

```
 $.getJSON("1",function(data)
        {       
            .....code
        }); 
```

我得到“http://localhost:8000/index/1”。那太棒了。但是，如果我希望它是：“http://localhost:8000/1”，我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:51:32.037

使 url 与 root 相关：

```
$.getJSON("/1", function(data)
{
     .... code
}); 
```

具体来说，请注意`/`网址开头的 。这就是将它指向当前站点的根目录的原因，在这种情况下：`http://localhost:8000/`

# perl - 启动停止守护程序

> ID：13494736
> 
> 赞同：0
> 
> 时间：2012-11-21T13:50:00.707
> 
> 标签：perl, unix

我一直[`Proc::Daemon`](http://search.cpan.org/~deti/Proc-Daemon-0.14/lib/Proc/Daemon.pod)在尝试制作启动/停止守护程序脚本，有些事情可以让我做：

```
X start
X stop
X status 
```

等等。但是，在源代码中，它看起来[`Proc::Daemon`](http://search.cpan.org/~deti/Proc-Daemon-0.14/lib/Proc/Daemon.pod)使用“pid”文件或搜索进程表。我关心这两种方法，首先是“pid”被重用，这可能会给人一种服务在实际关闭时启动的印象，其次是进程表条目很容易伪造，并且检查看起来并不特别健壮。

有没有像我描述的那样制作启动/停止守护程序脚本/程序的可靠方法，或者有人已经制作了？请注意，我没有 root 访问权限，如果这很重要，我也在 Solaris 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:55:02.680

尽管 pid 被重用，但我相信它们会通过（大）固定大小的集合进行循环。例如，在 Solaris 上，这曾经是 30,000（现在可能不同）。因此，在您的 pid 被重用之前，必须启动/完成 30,000 个进程。

Proc::Daemon 使用的方法看起来并不合理，并且是解决此问题的一种相当常见的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T15:06:51.110

我使用的一种方法是让守护进程获得一个文件的独占（写）锁。

您可以通过尝试自己获取锁来测试是否有人持有锁，并且有多种方法可以获取持有文件锁的进程的 PID - 即 fcntl 和可能在 /proc 中的某些内容。

一些忠告：

1.  使用本地文件（即不是 NFS）进行锁定。
2.  确保在守护程序启动之前存在锁定文件。
3.  永远不要删除锁定文件。

内核将锁与文件的 inode 号相关联，因此您始终希望锁文件始终具有相同的 inode 号。删除并重新创建锁文件将更改与锁关联的 inode。

一个简单的保持活动机制可以实现为 cron 作业 - cron 作业只是尝试每 N 分钟生成一次守护进程，然后在无法获得排他锁时让守护进程安静地退出。

# pdf - iText 嵌入的 ttf 字体在 Adob e Reader 中不可见

> ID：13494738
> 
> 赞同：5
> 
> 时间：2012-11-21T13:50:11.133
> 
> 标签：pdf, itext, acrobat, truetype, adobe-reader

我正在使用 iText 库为现有的 PDF 文件添加额外的信息。额外信息是应该以自定义 TTF 字体呈现的文本。

问题是文本仅在 Adob​​e Reader 中不可见。其他 PDF 查看器，例如 Ubuntu 中的默认 eVince 阅读器和 Google 在线 PDF 阅读器，可以很好地呈现自定义嵌入字体中的标记文本。

我尝试了多种编码，例如 Cp1251、BaseFont.Identity_H、...

魔术发生的代码：

```
PdfReader pdfReader = new PdfReader(new FileInputStream(inputPdf));
PdfStamper pdfStamper = new PdfStamper(pdfReader, new FileOutputStream("stamped.pdf"));
PdfContentByte canvas = pdfStamper.getOverContent(1);
String text = "The stamp";
BaseFont bf = BaseFont.createFont("assign.ttf", "Cp1251",BaseFont.EMBEDDED);
canvas.beginText();
canvas.setColorFill(BaseColor.BLUE);
canvas.setFontAndSize(bf, 13);
canvas.moveText(310, 600);
canvas.showText(text);
pdfStamper.close(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T13:58:56.120

你有语法问题。PDF 中的文本状态用`BT`和标记`ET`。这些运算符是使用`beginText()`and`endText()`方法添加的。你有一个`BT`，但没有`ET`。Adobe Reader 比其他查看器更严格（这就是为什么我更喜欢 Adob​​e Reader 而不是所有其他查看器：人们在编写代码时应该尊重语法）。

在前面添加以下行`pdfStamper.close();`

```
canvas.endText(); 
```

更好的是，阅读我的[书](http://itextpdf.com/book)，你会发现你可以通过使用`ColumnText.showTextAligned()`.

# sql - 如何在插入语句中调用函数/过程

> ID：13494743
> 
> 赞同：1
> 
> 时间：2012-11-21T13:50:30.587
> 
> 标签：sql, sql-server

如何在没有命令参数的插入语句中调用函数/过程。例如

```
Insert into myTable (....) values (1,2,mySP_or_mySDF, 3,4) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T13:53:51.000

你也可以使用`INSERT INTO... SELECT`

```
INSERT INTO myTable (col1, col2, col3....)
SELECT 1, 2, mySP_or_mySDF(), 3, 4 
```

如果`INSERT`要从存储过程中获取数据，则需要先创建一个临时表并将结果插入到临时表中，然后才能使用结果插入到最终表中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T13:51:17.090

尝试

```
Insert into myTable (....) values (1,2,dbo.mySP_or_mySDF(), 3,4) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T14:15:47.937

不能在 SELECT/UPDATE/INSERT 语句中调用存储过程，语句 SQL 除外：

```
insert into <whatever>
    exec <some sql statement here>; 
```

（和相关的结构）。

存储过程并不真正返回值。好吧，它们确实返回一个整数。所以，你可以这样做：

```
declare @retval int;
exec @retval = mysp;
insert into myTable(col1, col2, col3, col4)
    select 1, 2, @retval, 3, 4 
```

通过在 sp 正文中包含以下语句，您可以让存储过程“返回”所有 4 个值：

```
select 1, 2, <whatever>, 3, 4 
```

然后插入 myTable(col1, col2, col3, col4) exec mysp;

# image - 画布跨域像素错误

> ID：13494746
> 
> 赞同：2
> 
> 时间：2012-11-21T13:50:40.430
> 
> 标签：image, canvas, cross-domain, mouseevent, easeljs

我在 html5 画布上遇到了这个问题。我正在使用 EaselJS 加载图像。

> [http://www.createjs.com/Docs/EaselJS/Bitmap.html](http://www.createjs.com/Docs/EaselJS/Bitmap.html)

但是，当我在图像的父容器上添加任何类型的鼠标事件（onClick、onMouseOver、onMouseOut）时，从我移动鼠标的那一刻起，EaselJS 就会发送此错误：

> 未捕获的异常：发生了错误。这很可能是由于使用本地或跨域图像读取画布像素数据的安全限制。

它在 IIS 服务器上运行，我得到的图像来自其他域。我可以使用 --disable-web-security 让它在 Chrome 中工作。但我宁愿避免这种情况。

我已经阅读了一些关于代理脚本的内容可能有助于解决这个问题，但我不知道如何在这里实现它。

有什么修复建议吗？

编辑：解决！我通过使用一个简单的 asp.net 代理脚本解决了这个问题

> [http://www.sharepointjohn.com/aspnet-proxy-page-cross-domain-requests-from-ajax-and-javascript/](http://www.sharepointjohn.com/aspnet-proxy-page-cross-domain-requests-from-ajax-and-javascript/)

我从这个开始，在同事的帮助下，它来到了这个 .ashx 文件：

```
<%@ WebHandler Language="C#" Class="getSharepointImage" %>

using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Net;
using System.IO;
using System.Drawing;

public class getSharepointImage : IHttpHandler {

    public void ProcessRequest (HttpContext context) {
        context.Response.ContentType = "text/plain";

        string proxyURL = string.Empty;
        try
        {
            proxyURL = HttpUtility.UrlDecode(context.Request.QueryString["u"].ToString());
        }
        catch { }

        if (proxyURL != string.Empty)
        {
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(proxyURL);
            //request.Credentials = new NetworkCredential("username", "password"); //needed if you wish to access something like sharepoint
            request.Method = "GET";

            HttpWebResponse response = (HttpWebResponse)request.GetResponse();

            if (response.StatusCode.ToString().ToLower() == "ok")
            {
                string contentType = "img/png";
                Stream content = response.GetResponseStream();
                StreamReader contentReader = new StreamReader(content);
                context.Response.ContentType = contentType;

                var outStream = context.Response.OutputStream;
                Bitmap myImage = new Bitmap(System.Drawing.Image.FromStream(response.GetResponseStream()));

                MemoryStream writeStream = new MemoryStream();
                myImage.Save(outStream, System.Drawing.Imaging.ImageFormat.Png);
                writeStream.WriteTo(outStream);
                myImage.Dispose();

            }
        }
    }

    public bool IsReusable {
        get {
            return false;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-16T08:01:34.247

尝试以下操作：

```
var hitArea = new createjs.Shape;   
hitArea.graphics.beginFill("#000").drawRect(0,0,100,100);       
yourobj.hitArea  = hitArea; 
```

# javascript - 通过jQuery获取没有文本的HTML片段

> ID：13494766
> 
> 赞同：5
> 
> 时间：2012-11-21T13:52:08.580
> 
> 标签：javascript, jquery, html

我有一个带有`div`容器的 HTML 代码以及其中的另一个 HTML 元素和文本

```
<div id="container"><i class="myico"></i> text</div> 
```

我只需要从容器中**获取没有文本的****HTML**元素。

 **所以我只需要得到

```
<i class="myico"></i> 
```

如何使用 jQuery 获取它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:53:10.813

只需使用以下方法之一获取元素：

```
var element = $("#container > i");
var element = $("#container i");
var element = $("#container .myico");
var element = $("#container").find("i.myico"); 
```

要从标记中取出元素，请使用[`detach()`](http://api.jquery.com/detach/)：

```
var element = $("#container > i").detach(); 
```

然后要获取 HTML 代码，您可以使用`outerHTML`属性：

```
var html = element.get(0).outerHTML; 
```

**演示：http:** [//jsfiddle.net/tLvdZ/](http://jsfiddle.net/tLvdZ/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T13:54:18.283

`$('i') / $('.myico') / $('div i')`... [http://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:16:16.157

```
var htmltag = $("#container").html();
htmltag = htmltag.replace($("#container").text(),""); 
```

作为参考，您可以使用：-[参考这个](http://jsfiddle.net/jigneshparmar/Jk6YK/)**

# c# - Ninject Interception 3.0 接口代理方法属性

> ID：13494767
> 
> 赞同：0
> 
> 时间：2012-11-21T13:52:20.403
> 
> 标签：c#, ninject, ninject-extensions, ninject-interception

我刚刚将一个相对较大的代码库从 Ninject 2.2 升级到了 Ninject 3.0。一切似乎都按计划进行，除了我必须对我们使用的拦截内容进行一些更改。

```
interface IFoo
{
    Bar GetBar();
}

class Foo : IFoo
{
    [LogMethod(Level = LogLevel.Error)]
    public virtual Bar GetBar()
    {
        return new Bar();
    }
}

[AttributeUsage(AttributeTargets.Class | AttributeTargets.Interface | AttributeTargets.Method, AllowMultiple = false, Inherited = true)]
class LogMethodAttribute : InterceptAttribute
{
    public override IInterceptor CreateInterceptor(IProxyRequest request)
    {
        return request.Kernel.Get<ILogMethodInterceptor>();
    }

    public LogLevel Level { get; set; }
}

interface ILogMethodInterceptor : IInterceptor { }

class LogMethodInterceptor : ILogMethodInterceptor 
{
    public void Intercept(IInvocation invocation)
    {
        LogMethodAttribute attr = (LogMethodAttribute)invocation.Request.Method.GetCustomAttributes(typeof(LogMethodAttribute), true).FirstOrDefault();

        // Log something - using attribute properties
    }
}

NinjectSettings settings = new NinjectSettings { LoadExtensions = false };
IKernel kernel = new StandardKernel(settings, new DynamicProxy2Module());
kernel.Bind<ILogMethodInterceptor>().To<LogMethodInterceptor>();
kernel.Bind<IFoo>().To<Foo>(); 
```

这个精简版是我们过去在 Ninject 2.3 中发挥出色效果的版本。因为不允许使用接口代理，所以我们将所有方法都标记为虚拟，这使得 Castle 动态代理能够覆盖它们。

现在我想将 [LogMethod] 移动到接口级别以使用接口代理：

但是，当我移动它时，Ninject 不再检测到我要拦截这个类。此外，如果我保持原样，则会出现一个更微妙的问题：

这`invocation.Request.Method`是来自接口的 MethodInfo `IFoo`- 不是实现`Foo`，这意味着我无法再检索我的属性。所以我暂时陷入了这两个问题之间——如果我把属性放在接口中，Ninject 不会创建代理，如果我把属性放在实现中，我不能轻易地检索我的属性来访问它的属性。目前我唯一的解决方案是：

```
interface IFoo
{
    [LogMethod(Level = LogLevel.Error)]
    Bar GetBar();
}

class Foo : IFoo
{
    [LogMethod(Level = LogLevel.Error)]
    public virtual Bar GetBar()
    {
        return new Bar();
    }
} 
```

或者使用 InterfaceMapping 将我的 IFoo 转换`MethodInfo`为`invocation.Request.Target.GetType()`（返回实现类型 - `Foo`）`MethodInfo`。

有什么建议吗？

# javascript - CKEditor : IE 的 getSelection().selectElement()

> ID：13494773
> 
> 赞同：0
> 
> 时间：2012-11-21T13:52:42.453
> 
> 标签：javascript, asp.net, ckeditor

在**CKEditor**中：根据我的要求，我只想通过其 Id 选择元素并滚动到该位置。

我已经编写了在 FF 中运行良好的代码，但我没有得到 IE 的解决方案。

下面是 FF 的代码：

```
Ele = EditorInstance.document.getById(Id);
EditorInstance.getSelection().selectElement(Ele);
Ele.scrollIntoView(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T12:53:43.300

我已经尝试了下面的代码及其工作......

```
 Ele = EditorInstance.document.getById(Id);            

        EditorInstance.focus(); 
        var element = EditorInstance.document.getBody().getLast();
        var selection = EditorInstance.getSelection();
        selection.selectElement(Ele); 
        selection.scrollIntoView(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-03T23:09:54.910

基于[http://dev.ckeditor.com/ticket/7561](http://dev.ckeditor.com/ticket/7561) & [http://dev.ckeditor.com/attachment/ticket/7561/7561.patch](http://dev.ckeditor.com/attachment/ticket/7561/7561.patch)

像这样的补丁也可以..

```
Index: _source/plugins/selection/plugin.js
===================================================================
--- a/public/ckeditor-3.6.4/_source/plugins/selection/plugin.js
+++ b/public/ckeditor-3.6.4/_source/plugins/selection/plugin.js
@@ -710,7 +710,7 @@ For licensing, see LICENSE.html or http://ckeditor.com/license
                        }
                        catch ( e )
                        {
-                               this.isInvalid = true;
+                               document.getWindow().focus();
                        }
                } 
```

# android - 动画上的RelativeLayout大小问题

> ID：13494778
> 
> 赞同：2
> 
> 时间：2012-11-21T13:52:51.737
> 
> 标签：android, android-layout

我试图找到类似的问题，但不能。

我使用支持库构建基于片段的应用程序。以现代“Google/Facebook”风格设计的 UI（全屏内容页面 + 滑动菜单）。这是主要的布局文件：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<FrameLayout
    android:id="@+id/mainmenu_fragment"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:background="@color/mainmenu_bg" >
</FrameLayout>

<LinearLayout
    android:id="@+id/contentwrapper"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_toRightOf="@id/mainmenu_fragment"
    android:background="@android:color/white"
    android:orientation="vertical" >

    <fragment
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        class="com.pleazzme.Topline"
        android:tag="Topline" />

    <FrameLayout
        android:id="@+id/main_categoryline_wrap"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </FrameLayout>

    <FrameLayout
        android:id="@+id/main_selectorline_wrap"
        android:layout_width="match_parent"
        android:layout_height="50dp" >
    </FrameLayout>
</LinearLayout>

<ImageButton
    android:id="@+id/main_btn_wallet"
    android:contentDescription="@string/text_btn_wallet"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:adjustViewBounds="true"
    android:background="@android:color/transparent"
    android:src="@drawable/wallet"
    android:layout_alignParentRight="true"
    android:layout_alignParentBottom="true"
    android:onClick="showWallet" />

</RelativeLayout> 
```

这是片段布局之一：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/topline_wrapper"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:background="@drawable/topline_tilebg" >

<ImageView
    android:id="@+id/topline_title"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:adjustViewBounds="true"
    android:layout_centerHorizontal="true"
    android:contentDescription="@string/text_topline_title"
    android:paddingBottom="10dp"
    android:paddingLeft="5dp"
    android:paddingRight="5dp"
    android:paddingTop="10dp"
    android:src="@drawable/pleazzme_title" />

<Button
    android:id="@+id/counter_button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerVertical="true"
    android:layout_toRightOf="@id/topline_title"
    android:background="@drawable/topline_newscounter"
    android:focusable="false"
    android:focusableInTouchMode="false"
    android:textColor="@android:color/white"
    android:visibility="gone" />

<Button
    android:id="@+id/topline_back_button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerVertical="true"
    android:background="@drawable/back_but"
    android:contentDescription="@string/text_back_button"
    android:focusable="false"
    android:focusableInTouchMode="false"
    android:onClick="onBackTrigger"
    android:text="@string/btn_back"
    android:textColor="@color/android:white"
    android:visibility="gone" />

<ImageButton
    android:id="@+id/topline_mainmenu_button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerVertical="true"
    android:layout_margin="5dip"
    android:layout_toRightOf="@id/topline_back_button"
    android:background="@drawable/sq_but_bg"
    android:contentDescription="@string/text_mainmenu_button"
    android:focusable="false"
    android:focusableInTouchMode="false"
    android:onClick="onMainmenuTrigger"
    android:src="@drawable/ico_list" />

<ImageButton
    android:id="@+id/topline_map_button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_centerVertical="true"
    android:layout_margin="5dip"
    android:background="@drawable/sq_but_bg"
    android:contentDescription="@string/text_map_button"
    android:focusable="false"
    android:focusableInTouchMode="false"
    android:onClick="onMapTrigger"
    android:src="@drawable/ico_mark" />

</RelativeLayout> 
```

活动 onMapTrigger 方法：

```
public void onMainmenuTrigger(View v) {
     FragmentTransaction ft = fm.beginTransaction();
     ft.setCustomAnimations(R.anim.left_to_right, R.anim.right_to_left);

    if (mml.isHidden()) {
        mml.clearSearch();
         ft.show(mml);
    } else {
         ft.hide(mml);
    }
     ft.commit();
} 
```

显示动画：

```
<set xmlns:android="http://schemas.android.com/apk/res/android" >

<translate
    android:duration="500"
    android:fromXDelta="-100%p"
    android:toXDelta="0" />

</set> 
```

显示菜单时，可见的顶线按钮会重叠。有人可以告诉我，在这种情况下有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T11:33:56.183

我发现解决这个问题的唯一方法是使用[NineOldAndroids](http://nineoldandroids.com/)库重构我的动画。他们对 sdk < 11 有一些问题，但它的工作。

# jquery - 使用 ASP MVC 和 jquery 不显眼验证处理 textarea 元素中的换行符

> ID：13494779
> 
> 赞同：2
> 
> 时间：2012-11-21T13:52:59.847
> 
> 标签：jquery, asp.net, asp.net-mvc, asp.net-mvc-3, jquery-validate

视图模型：

```
public class ViewModel
{
    [Display(Name = "Message")]
    [StringLength(500, ErrorMessage = "Your message must be {1} characters or fewer.")]
    public string Message { get; set; }
} 
```

查看（摘录）：

```
<div class="form-field-group">
    @Html.LabelFor(m => m.Message , "Your message:")
    @Html.TextAreaFor(m => m.Message )
    @Html.ValidationMessageFor(m => m.Message )
</div> 
```

我还在 web.config 中使用了不显眼的验证：

```
<appSettings>
    <add key="ClientValidationEnabled" value="true"/>
    <add key="UnobtrusiveJavaScriptEnabled" value="true"/>
</appSettings> 
```

绝对是教科书的东西，而且看起来效果很好。

**问题！**

所以我对[表单数据中换行符的 HTML 规范的](http://www.w3.org/MarkUp/html-spec/html-spec_8.html#SEC8.2.1)理解是它被编码为 CR LF。当我调试处理这个视图模型的帖子的控制器操作时，这肯定是我看到的。

但是，当通过 javascript 读取输入值时，换行符会因浏览器而异（IE6-8 似乎提供 CRLF，而 Windows 上的 Chrome 和 Firefox 最近构建只提供 LF）。

这意味着如果您输入带有换行符的文本，jquery 验证器将允许他们看到的内容，例如 498 个字符，但是当它到达模型绑定时，它已被转换为 504 并且 ModelState.IsValid 是（正确）错误的。

有人对纠正这个问题的最佳/最简单方法有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:18:46.940

MVC 非侵入式验证 (jquery.validate.unobtrusive.js) 使用 jquery.validate.js。

因此，解决此问题的最简单方法是更改​​ maxlength 在 jquery.validate.js 中的行为（这是 jquery.validate.unobtrusive.js 通过其适配器附加的内容）。

下面的代码将更改 maxlength 并解决问题：

```
(function ($) {

    if ($.validator && $.validator.methods && $.validator.methods.maxlength) {

        $.validator.methods.maxlength = function (value, element, param) {
            if (typeof value === 'string') {
                value = value.replace(/\r?\n/g, "\r\n");
            }

            var length = $.isArray(value) ? value.length : $.validator.prototype.getLength($.trim(value), element);
            return $.validator.prototype.optional(element) || length <= param;
        };
    }

})(jQuery); 
```

需要注意的是，这不会在非 Windows 平台上引起问题（或引起不同的问题）[http://en.wikipedia.org/wiki/Newline](http://en.wikipedia.org/wiki/Newline)。

您还可以通过创建自己的验证属性并实施 IClientValidatable 添加您自己的客户端验证来解决此问题[http://www.falconwebtech.com/post/2012/04/21/MVC3-Custom-Client-Side-Validation-with-不显眼的 Ajax.aspx](http://www.falconwebtech.com/post/2012/04/21/MVC3-Custom-Client-Side-Validation-with-Unobtrusive-Ajax.aspx)。这样做的缺点是记住使用您的属性而不是标准的 StringLength 之一。你必须决定什么最适合你的情况。

# php - foreach，元素的意外结果，键为 0

> ID：13494782
> 
> 赞同：2
> 
> 时间：2012-11-21T13:53:05.177
> 
> 标签：php, arrays, foreach

我有这个代码

```
$arr = array(
    "0"=>"http://site.com/somepage/param1/param2/0",
    "1"=>"http://site.com/somepage/param1/param2/1",
    "thispage" => "http://site.com/somepage/param1/param2/2",
    "3"=> "http://site.com/somepage/param1/param2/3"
);

foreach ($arr as $k=>$v) {
    if ($k == "thispage") {
        echo $k." ";
    }
    else {
        echo '<a href="'.$v.'">'.$k.'</a> ';
    }
} 
```

令人惊讶的是，对于`"0"=>"http://site.com/somepage/param1/param2/0",`未创建链接的第一个元素，（对于其他元素工作正常）

如果在其他东西上替换第一个元素键`0`，例如`4`，现在创建链接。怎么了 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T13:57:21.753

发生这种情况是因为`0 == "thispage"`第一个键是`0`. 要了解更多信息，请查看关于[Type Juggling](http://php.net/manual/en/language.types.type-juggling.php)的 PHP 手册页。

使用`===`("is same to") 代替`==`("is equal to")，因为`0`is *equal* to `"thispage"`，但不*完全相同*。

这就是发生的情况`==`：

*   `$key`取值`integer`为`0`
*   PHP 尝试比较`0 == "thispage"`
*   为了进行比较，它需要转换`"thispage"`为`integer`
*   结果比较`0 == 0`是`true`

如果您使用`===`：

*   `$key`取值`integer`为`0`
*   PHP 尝试比较`0 === "thispage"`
*   因为( ) 与( )`0`的类型不同，所以结果是`integer``"thispage"``string``false`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T13:58:02.690

执行以下操作：

```
if ($k === "thispage") 
```

您必须使用**相同的比较运算符** `===`，因为**相等的比较运算符**在这里没有帮助，因为

> 如果将数字与字符串进行比较或比较涉及数字字符串，则每个字符串都将转换为数字并以数字方式执行比较。

`thispage`转换为数字将返回`0`，因此如果您使用相等比较运算符，您的 if 语句将匹配`==`。当您进行相同比较`===`时，如果类型不匹配，则返回 false。

[您可以在此处](http://php.net/manual/en/language.operators.comparison.php)阅读有关比较运算符的信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T13:59:28.710

这是你做错了什么。

```
if ($k === "thispage") {
    echo .$k." ";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T13:58:34.640

试试这个：

```
if ($k === "thispage") {
        echo $k." ";
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T14:00:40.133

[http://us.php.net/manual/en/language.types.array.php](http://us.php.net/manual/en/language.types.array.php)：

> 键可以是整数或字符串。**如果键是整数的标准表示，它将被解释为这样**（即“8”将被解释为 8，而“08”将被解释为“08”）。

因此，在您的情况下，Stings`"1", "2" and "3"`被视为整数。

要解决此问题，请使用`===`检查类型和值的运算符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-21T14:01:58.640

您看到结果的原因是您使用的比较运算符。== 有时过于不精确，可能会导致类似这样的奇怪事情。使用 === 将比较值的准确性，并防止您遇到的问题。

所以：

```
foreach ($arr as $k=>$v) {
    // this is the important thing
    if ($k === "thispage") {
        echo $k." ";
    }
    else {
        echo '<a href="'.$v.'">'.$k.'</a> ';
    }
} 
```

# mysql - MySQL Connector/Net 6.6.4 无法使用 LightSwitch 连接到远程数据库

> ID：13494785
> 
> 赞同：2
> 
> 时间：2012-11-21T13:53:13.070
> 
> 标签：mysql

首先感谢所有优秀的人，使这个成为有史以来最好的编程资源！

关于这个问题有很多线程，但我找不到对我有帮助的线程。

我可以连接到我的本地 MySQL 数据库，但不能连接到远程数据库。我的 IP 是允许的（我可以在同一台计算机上使用 HeidiSQL 以完全相同的参数进行连接，没有任何问题）。我试过有和没有防火墙。

我尝试通过在解决方案资源管理器中添加新数据源来设置它（尽管在服务器资源管理器中添加数据连接时我遇到了同样的问题）

我觉得我错过了一些东西——也许是身份验证方法或类似的东西？

[此时没有可显示的代码。只是 LightSwitch 实体和屏幕。我从 www.mysql.com 安装了 Connector/Net 6.6.4，并简单地设置了一个本地数据源进行开发。工作得很好。现在我需要连接到实时 Web 服务器，并且无法在解决方案资源管理器中添加远程数据源。当我测试连接时，我收到“算术运算导致溢出”错误消息！]

我想我已经解决了我自己的问题。[http://bugs.mysql.com/bug.php?id=66647](http://bugs.mysql.com/bug.php?id=66647) MySQL 连接器“错误”

# python - python中的自我语法

> ID：13494786
> 
> 赞同：4
> 
> 时间：2012-11-21T13:53:19.783
> 
> 标签：python, class, oop

每当我定义一个有许多参数的类时，我经常发现自己在做这样的事情

```
class myClass(object):
    def __init__(self,param1,param2,param3, ...):
         self.param1 = param1
         self.param2 = param2
         self.param3 = param3
 ... 
```

我的问题是：有没有更聪明、更 Python 的方式来做到这一点？

谢谢，亚历克斯。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T13:58:45.553

您可以接受可变数量的命名参数并自动设置它们，如下所示：

```
class MyClass(object):
    def __init__(self, **kwargs): # variable named arguments
        for k, v in kwargs.items():
           setattr(self, k, v) # set the value of self.k to v, same as self.k = v

test = MyClass(param1="param1", param2="param2")
print test.param1 # "param1" 
```

[setattr 文档](http://docs.python.org/2/library/functions.html#setattr)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T13:54:46.950

您可以将参数作为`keyword arguments`： -

```
def __init__(self, **kwargs):
     self.args = kwargs 
```

然后你将像这样实例化你的类： -

```
myClassObj = MyClass(a=12, b="abc") 
```

然后您的`args`dict 将包含这些参数作为键值对：-

```
{'a':12, 'b':'abc'} 
```

访问属性： -

```
myClassObj.args['a']
myClassObj.args['b'] 
```

您还可以传递各种参数的组合。您可以在任何函数中使用 4 种参数：-

*   位置论据
*   默认参数
*   非关键字参数
*   关键字参数。

仅按此顺序。所以函数声明的典型语法是：-

```
def func(positional_arg, default_arg, *nkwargs, **kwargs) 
```

有关定义函数的更多信息，请参阅[文档](http://docs.python.org/2/tutorial/controlflow.html#more-on-defining-functions)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:08:32.607

您可以执行以下操作：

```
def __init__(self,*args):
   _init_args = ('param1','param2','param3')
   if len(_init_args) != len(args):
      raise TypeError('__init__ takes {nargs} args'.format(nargs=len(_init_args)))
   for k,v in zip(_init_args,*args):
      setattr(self,k,v) 
```

但我真的不认为这比你原来的解决方案或`sean`. 这个 over`sean`的答案的优点是用户不需要知道你的类中属性的名称是什么。它的行为有点像声明的函数：

```
def __init__(self,arg1,arg2,arg3):
    ... 
```

虽然还是有区别的。

# c - 用 execve 调用 ls

> ID：13494787
> 
> 赞同：3
> 
> 时间：2012-11-21T13:53:21.063
> 
> 标签：c, linux, unix

下面的代码应该调用一个命令，`excve`由于某种原因我不打印当前目录的内容，但程序仍然返回`"ok"`

```
 1 #include <stdio.h>
  2 #include <unistd.h>
  3 int main ()
  4 { char *argv[]={"ls",NULL};·
  5   char *env[]={"PATH=/usr/local/sbin/:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games",NULL};
  6   if(execve("ls",argv,env))
  7   { printf("ok\n");
  8   }
  9   else
 10   { printf("not ok\n");
 11   }
 12   return 0;
 13 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:00:46.157

由于`execve`不返回成功，很明显调用以某种方式失败。它在错误时返回 -1，这将被视为真（非零）。这就是为什么它说好的。

最可能的原因是您没有指定可执行文件的完整路径，这是`execve`. 或者，如果您希望搜索路径，请`execvpe`改用。有关血腥细节，请参见[http://linux.die.net/man/3/exec](http://linux.die.net/man/3/exec)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T13:58:48.203

对 exec 的调用在成功时不会返回。您基本上将调用程序替换为您正在执行的程序。

因此，如果您曾经通过 exec 运行任何代码，则意味着 exec 失败。我相信 exec 返回 -1，这就是你最终打印正常的原因。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T14:03:51.543

这真的没有多大意义

```
if(execve("ls",argv,env) >0) {
    printf("ok\n");
} else {
    printf("not ok\n");
} 
```

如果成功，所有`exec`函数都不会返回，因此如果返回则表示失败，您无需检查是否返回`-1`，第二个问题是第一个参数`execve()`是文件路径而不是命令名，来自 man：

> **execve() 执行filename**指向的程序。

所以你只需要：

```
execve("/bin/ls", argv, env);
/* execve() only returns on error */
perror("execve");   
exit(EXIT_FAILURE); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T13:56:40.227

execve 在错误时返回 -1，当在需要布尔值的上下文中使用时，它的计算结果为 true。但是，检查返回值是没有意义的，因为如果 execve 成功，那么它将不会返回。

可能在这种情况下，它失败了，因为您没有提供“ls”的完整路径。

# ruby-on-rails - 将内联 HTML 放入变量中

> ID：13494788
> 
> 赞同：0
> 
> 时间：2012-11-21T13:53:37.067
> 
> 标签：ruby-on-rails, contentplaceholder

有没有办法将视图中的内联 HTML 放入变量中？像这样的东西：

```
<% t = content_to_var do %>
   <h1>The title</h1>
<% end %>

<% my_var = content_to_var do %>
   <p>Watch this fine results:</p>
   <table>
   <tr><td>Value 1.1</td><td>Value 1.2</td></tr>
   <tr><td>Value 2.1</td><td>Value 2.2</td></tr>
   <tr><td>Value 3.1</td><td>Value 3.2</td></tr>
   </table>
<% end %>

<%= render 'partial', { title: t, contents: my_var } 
```

请注意，我知道缺少名为“content_to_var”的函数。仅作为示例提及。

我知道 content_for 和 yield，但想通过当地人做同样的事情。

我不喜欢一个想法

```
my_var = '<table><tr><td>Value 1.1</td><td>Value 1.2</td></tr></table>'.html_safe 
```

它看起来很丑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:02:29.740

为什么不只渲染局部？这就是他们的目的。

您可以执行以下操作：

```
<% t = render :partial => 'title', :title => 'The title' %>
<% my_var = render :partial => 'values', :values => @values %>

<% render :partial => {title: t, contents: my_var } %> 
```

为了完整起见，你`_title.html.erb`看起来像

```
<h1><%= title %></h1> 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:01:02.297

在旧版本的 Rails 中，您可以这样做

```
<% t = capture do %>
  <h1>The title</h1>
<% end %> 
```

不知道新版本

# c# - 流式处理 WCF 大量对象

> ID：13494791
> 
> 赞同：4
> 
> 时间：2012-11-21T13:53:46.833
> 
> 标签：c#, wcf, streaming, deferred-execution, large-data

我面临着编写一个在 IIS 上运行的 WCF 服务器，以供不同计算机上的其他平台使用。我需要将大量对象（序列化）返回给客户端。我需要它进行流式传输，因为从我的数据库中获取所有数据并根据 cilent 的要求对其进行安排是一个非常漫长的过程，因此我需要客户端能够在结果流出时对其进行处理。

在对该主题进行了一些阅读之后，似乎如果我将 WCF 与 transferMode StreamedResponse 一起使用，我可以返回延迟执行的对象，这可能会满足我的需求。

我阅读了以下文章： [http ://weblogs.asp.net/cibrax/archive/2008/06/10/streaming-large-content-with-wcf-and-deferred-execution.aspx](http://weblogs.asp.net/cibrax/archive/2008/06/10/streaming-large-content-with-wcf-and-deferred-execution.aspx)

并实现了与他们描述的类似的 WCF。但是我改变了他们的代码：

```
for(long i = 0; i < 1000; i++) //All the customers should be read from the database
{
   yield return new Customer { FirstName = "Foo", LastName = "Bar", Address = "FooBar 123" };
} 
```

至：

```
for(long i = 0; i < 1000000; i++) //All the customers should be read from the database
{
   yield return new Customer { FirstName = "Foo", LastName = "Bar", Address = "FooBar 123" };
} 
```

所以它会模拟大量的数据。我注意到，当我这样做时，客户端的功能会在返回对象之前停顿几秒钟。
为什么会这样？数据不应该立即开始在流上流动吗？这不是延迟执行的流式 WCF 的重点吗？你对我的问题有更好的建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T20:33:41.450

我查看了链接中的代码。

看起来 CreateMessage 在服务器上运行，将整个结果放在变量消息中，然后服务器开始返回任何数据。

```
 Message message = Message.CreateMessage(MessageVersion.Soap11, "GetAllCustomers", new CustomBodyWriter(GetAllCustomersImpl()));
   return message; 
```

# c# - 无法将选中的项目checklistbox form1添加到列表框form2

> ID：13494793
> 
> 赞同：1
> 
> 时间：2012-11-21T13:53:53.783
> 
> 标签：c#, winforms

我有 2 个表格 form1 和 form2。当我单击button2时，我想将checkedlistbox1（form1）中的选中项目添加到列表框（form2）。我怎样才能做到这一点

表格1

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        Form2 form2 = new Form2();
        form2.Show();
    }
} 
```

表格2

```
public partial class Form2 : Form
{
    public Form2()
    {
        InitializeComponent();
    }

    private void button2_Click(object sender, EventArgs e)
    {
        Form1 form1 = new Form1();
        foreach(string item in form1.checkedListBox1.CheckedItems)
        {
            listBox1.Items.Add(item);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:00:12.843

**像这样更改Form1**

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        Form2 form2 = new Form2(checkedListBox1);
        form2.Show();
    }
} 
```

**表格 2**

```
public partial class Form2 : Form
{
    public Form2(CheckedListBox checkedListBox1)
    {
        InitializeComponent();
        foreach(string item in checkedListBox1.CheckedItems)
        {
            listBox1.Items.Add(item);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:03:46.833

有一些问题。

首先，每次按下按钮，都会创建一个新表单。我想你想创建它的一个实例？

第二个问题是，你不能`form1.checkedListBox1`像这样从 form2 访问。

而且我不认为 checkedListBox1.CheckedItems 是一个字符串列表。也许您想添加项目的文本或值...

最好尝试这样的事情：

表格1

```
public partial class Form1 : Form
{
    Form2 form2;
    public Form1()
    {
        InitializeComponent();
        form2 = new Form2(this);
    }

    private void button1_Click(object sender, EventArgs e)
    {
        form2.Show();
    }

    public List<string> GetCheckedItems()
    {
        return this.checkedListBox1.CheckedItems;
    }
} 
```

表格2

```
public partial class Form2 : Form
{
    Form1 form1;
    public Form2()
    {
        InitializeComponent();
    }

    public Form2(Form1 parentForm)
    {
        InitializeComponent();
        this.form1 = parentForm;
    }

    private void button2_Click(object sender, EventArgs e)
    {
        foreach(string item in form1.GetCheckedItems())
        {
            listBox1.Items.Add(item);
        }
    }
} 
```

我没有检查代码，但它应该是这样的......

# magento - 为子域 magento 构建访问计数器

> ID：13494797
> 
> 赞同：0
> 
> 时间：2012-11-21T13:54:04.480
> 
> 标签：magento

我知道这听起来很愚蠢，但我有一些具有不同子域的 magento 商店视图。它的内容 100% 相同，因为它适用于多层次营销公司。知道我需要跟踪每个子域的点击和访问。我不知道是否可以使用谷歌分析来做到这一点。顺便说一句，这不是我最喜欢的，因为我想让统计数据看起来像自制的。

我正在考虑编辑 magento 的 index.php 以确定加载了哪个存储代码，而不是将其保存在具有 IP 地址和时间的数据库中。毕竟我会在一段时间后使用 cronjob 来清理数据库。

你能给我一些关于我应该注意的事情的建议吗？因为我从来没有做过访客柜台之类的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:53:43.783

看看这些数据库表

```
log_visitor
log_visitor_*
log_url
log_url_*
log_* 
```

# f# - 排序二叉树 F#

> ID：13494799
> 
> 赞同：1
> 
> 时间：2012-11-21T13:54:10.670
> 
> 标签：f#, tree

嗨，我一直在寻找一些关于如何在 F# 中制作排序二叉树数据类型的好信息，但我找不到任何可以理解的内容。我已经检查了 msdn-page 上的示例，但我不明白。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:10:24.040

如果您正在寻找现有的实现，那么[FSharpX 库](https://github.com/fsharp/fsharpx/tree/master/src/FSharpx.Core/DataStructures)有相当多的数据结构（包括一些树）可用。虽然我不认为它有一个排序二叉树的简单实现。您还可以从 F# 访问所有 .NET 集合，但我认为 .NET 也没有二叉树。它有[sorted list](http://msdn.microsoft.com/en-us/library/ms132319.aspx)，这对你来说可能很好，这取决于你想要做什么。

如果你想实现你自己的，那么你需要首先定义一个数据类型来表示树：

```
type SortedTree<'T when 'T : comparison> =
  | Node of SortedTree<'T> * 'T * SortedTree<'T>
  | Leaf of 'T 
```

该`Node`元素意味着左侧的所有值都小于节点中存储的值，并且所有大于（或等于）的值都在右侧。我添加了一个约束`'T : comparison`，这意味着您只能创建可比较元素的树（这在实现中需要对树进行排序）。

实现所有常见的树操作将是相当多的工作，但是插入的简单尝试（不会以任何方式保持树平衡）看起来像这样：

```
let rec insert element tree = 
  match tree with
  | Leaf v when element < v -> Node(Leaf element, v, Leaf v)
  | Leaf v -> Node(Leaf v, element, Leaf element)
  | Node(left, key, right) when element < key -> Node(insert element left, key, right)
  | Node(left, key, right) -> Node(left, key, insert element right) 
```

模式匹配处理 4 个有趣的情况： 当树为`Leaf`时，您需要在左侧或右侧使用新元素构建一个新节点。当树为 时`Node`，则要根据键的值向左或向右插入。

# asp.net - asp下拉列表没有得到正确的值

> ID：13494800
> 
> 赞同：0
> 
> 时间：2012-11-21T13:54:16.600
> 
> 标签：asp.net

我在页面加载时以这种方式填充我的下拉列表。（字符串生成器只是为了证明检索到了正确的列表项）

下拉选择事件总是检索索引 0，无论我从列表中选择什么项目，这让我相信我填充 dropdwonlist 的方式有问题，并且所选值始终是与该项目关联的值当下拉菜单出现在页面加载时，无论从下拉菜单中选择什么项目，它都是列表中的第一个。

```
 Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
    'Dim sb As New StringBuilder()
    Using ctx As New dbentities()
        Try
            Dim query = (From c In ctx.my_aspnet_users Select c.name, c.id).ToList()

            ddlSiteUsers.DataSource = query
            ddlSiteUsers.DataTextField = "name"
            ddlSiteUsers.DataValueField = "id"
            ddlSiteUsers.DataBind()
            'For Each item As ListItem In ddlSiteUsers.Items
            '    sb.Append(item)
            '    sb.Append(",")
            '    sb.Append(item.Value)
            '    sb.Append(";" & vbCrLf)
            'Next
            'MsgBox(sb.ToString())
        Catch ex As Exception
            MsgBox(ex.StackTrace.ToString())
        End Try
    End Using
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:06:32.263

该`Page_Load()`事件在页面最初加载时触发，并且在您回发页面时触发。

这意味着，在您的 click/indexchanged 事件触发之前，它会在`Page_Load()`您提交表单时重新运行您的代码。

要阻止这种情况，您需要`if`在代码周围添加一条语句，以便它仅在页面最初加载时（即不回发时）填充下拉列表

例如

```
Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
  If Not Page.IsPostBack Then 
    'Dim sb As New StringBuilder()
    Using ctx As New dbentities()
      Try
        Dim query = (From c In ctx.my_aspnet_users Select c.name, c.id).ToList()

        ddlSiteUsers.DataSource = query
        ddlSiteUsers.DataTextField = "name"
        ddlSiteUsers.DataValueField = "id"
        ddlSiteUsers.DataBind()
        'For Each item As ListItem In ddlSiteUsers.Items
        '    sb.Append(item)
        '    sb.Append(",")
        '    sb.Append(item.Value)
        '    sb.Append(";" & vbCrLf)
        'Next
        'MsgBox(sb.ToString())
      Catch ex As Exception
        MsgBox(ex.StackTrace.ToString())
      End Try
    End Using
  End If
End Sub 
```

# c# - 在 ASP.NET 中用 C# 写文件作为响应

> ID：13494803
> 
> 赞同：2
> 
> 时间：2012-11-21T13:54:17.817
> 
> 标签：c#, asp.net

我有一个用 C# 编写的 ASP.NET Web 窗体应用程序。在其中一个屏幕上，用户可以单击一个按钮。单击该按钮时，我需要生成一些 XML 并在自定义应用程序中打开它。我试图了解如何获取我生成的 XML，并自动打开可以理解它的应用程序。

使用此 XML 的应用程序是自定义应用程序。此应用程序使用专有文件格式。该文件实际上只是 XML。但是，我注意到文件扩展名是 .ctm。

当有人按下我的 ASP.NET Web 表单中的按钮时，我有没有办法在自定义应用程序中打开这个 XML？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:00:16.057

您无法控制在客户端计算机中打开文件的应用程序，但关于问题的标题，如果您的客户端操作系统正确配置，您只需编写 xml 文件并将内容类型更改为 text/xml将使用指定的应用程序打开您的 xml。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:00:26.337

如果不涉及 active-x 或浏览器插件，您将无法做到这一点，否则您将遇到兼容性问题（需要为每个浏览器设置不同的插件等等）。

# attributes - 如何使用 d3 访问第 i 个形状的属性

> ID：13494806
> 
> 赞同：2
> 
> 时间：2012-11-21T13:54:23.057
> 
> 标签：attributes, d3.js, geometry, shapes

我正在使用 d3 构建一个简单的几何应用程序。基本思想是你点击三下，应用程序会在你刚刚点击的三个点上画一个圆圈。

d3 文档提到 d3 元素存储为数组，但没有明确说明您如何访问这些元素。如何访问选择中特定索引处的元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:03:24.383

*从原始问题复制作为自我回答。*

此代码片段说明了如何获取第三个圆的 x 位置。

```
 var allCir= d3.selectAll("circle") ;
    var x =  d3.select(allCir[0][2]).attr("cx"); // get third circle's x position
    alert(x);
    d3.select(allCir[0][2]).attr("cx",10); // force it to an arbitrary value 
```

虽然答案很简单，但到达那里并不是那么简单。希望这可以帮助。

# php - 严格标准：静态函数 model::tableStruct() 不应该是抽象的

> ID：13494807
> 
> 赞同：6
> 
> 时间：2012-11-21T13:54:28.283
> 
> 标签：php, class, static

由于某些奇怪的原因，此消息在 php 5.4 中显示。

我的课看起来像这样：

```
abstract class model{

  private static
    $tableStruct = array();

  abstract protected static function tableStruct();

  public static function foo(){
    if(!isset(self::$tableStruct[get_called_class()]))
      self::$tableStruct[get_called_class()] = static::tableStruct();

    // I'm using it here!!
  }

} 
```

并且应该像这样使用：

```
class page extends model{

  protected static function tableStruct(){
    return array(
      'id' => ...
      'title' => ...
    );
  }

  ...

} 
```

为什么创建子类所需的静态方法被认为是违反标准的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T14:13:30.453

抽象静态方法是一个奇怪的概念。静态方法基本上将方法“硬编码”到类中，确保只有一个实例（~singleton）。但是使其抽象意味着您要强制其他一些类来实现它。

我知道您要做什么，但是在处理抽象类时，我会避免基类中的静态方法。您可以做的是使用后期静态绑定 (static::) 来调用“子”类中的 tableStruct 方法。这不会像 abstract 那样强制实现方法，但您可以测试实现并在不存在时抛出异常。

```
public static function foo(){
    // call the method in the child class 
    $x = static::tableStruct();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-21T07:44:05.080

物有所值...

滥用接口：

```
interface Imodel {

    static function tableStruct();        
}

abstract class model implements Imodel {

    private static $tableStruct = array();

    public static function foo() {
        if (!isset(self::$tableStruct[get_called_class()]))
            self::$tableStruct[get_called_class()] = static::tableStruct();

        // I'm using it here!!
    }
} 
```

# c# - 如何用 linq 做到这一点？

> ID：13494809
> 
> 赞同：0
> 
> 时间：2012-11-21T13:54:28.400
> 
> 标签：c#, linq, c#-4.0

在这个场景中，`ExistID(2,10)`

`2`to`10`是`{2,3,4,5,6,7,8,9,10}`必须存在于 myTable 中的控件。如果 ID 列中存在某人，则返回 false。如何使用 linq？我是linq的新手。

我的表：

```
 ID    
    1
    2
    3
    4 
```

-

```
 myDBDataContext db;

    public bool ExistID(int startId, int endId)
    {
     //return db.MyTables...
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:59:12.580

```
public bool ExistID(int startId, int endId)
{
     return db.MyTables.Any(x => x.ID >= startId && x.ID <= endId);
} 
```

`true`如果某个值 from `startId`to`endId`存在于表中，则此方法返回。

# php - 需要显示帖子而不是投资组合项目

> ID：13494813
> 
> 赞同：-1
> 
> 时间：2012-11-21T13:54:36.583
> 
> 标签：php, mysql, wordpress

我只有一个支持在全宽投资组合主页上显示投资组合项目的主题，这些投资组合项目不支持视频，但我可以在普通帖子中嵌入视频我需要做的是改变主页以显示例如分类帖子，这里是代码

```
<?php 

                    $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
                    $showposts = $data['home_recent_number']; 

                    $args = array(
                                    'showposts' => $showposts ,
                                    'post_type' => 'portfolioentry'
                                  );

                    $my_query = new WP_Query($args);
                    $wp_query = $my_query;

                    //query_posts("showposts=$showposts&post_type=portfolioentry&paged=$paged");
                    query_posts("showposts=$showposts&post_type=portfolioentry&paged=$paged");

                    $limit_text = 100;
                    $currentindex = '';
                    $counter = 0;
                    $count = 0;
                    $temp = '';
                    while ( have_posts() ) : the_post();
                        $do_not_duplicate = $post->ID; 
                        $full_image = wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), 'full', false);
                        $entrycategory = get_the_term_list( $post->ID, 'portfoliocategory', '', '_', '' );
                        $catstring = $entrycategory;
                        $catstring = strip_tags($catstring);
                        $catstring = str_replace('_', ', ', $catstring);
                        $categoryname = $catstring;                         
                        $entrycategory = strip_tags($entrycategory);
                        $entrycategory = str_replace(' ', '-', $entrycategory);
                        $entrycategory = str_replace('_', ' ', $entrycategory);

                        $catidlist = explode(" ", $entrycategory);
                        for($i = 0; $i < sizeof($catidlist); ++$i){
                            $catidlist[$i].=$currentindex;
                        }
                        $catlist = implode(" ", $catidlist);

                        $category = get_the_term_list( $post->ID, 'portfoliocategory', '', ', ', '' );  

                        if(isset($full_image[0]))
                            $img = get_template_directory_uri() .'/js/timthumb.php?src='.$full_image[0] .'&';
                        else
                            $img = get_template_directory_uri() .'/js/timthumb.php?src='.get_template_directory_uri() .'/images/placeholder-port.png&';

                        ?>
                            <div class="item4">

                        <a href="<?php the_permalink(); ?>">
                            <div class="overdefult">

                                <div class="viewIcon"><?php echo getPostViews(get_the_ID()); ?></div>
                                <div class="likeIcon"><?php echo GetWtiLikeCount($post->ID) ?></div>

                            </div>
                        </a>
                        <div class = "detailsoverdefault">
                            <h3><a href="<?php //the_permalink(); ?>"><?php $title = substr(the_title('','',FALSE),0,30); echo $title  ?></a></h3>
                            <a href="<?php //the_permalink(); ?>"><div class = "moreButton">+</div></a>
                        </div>
                        <div class="image">

                            <img class="newimage <?php echo $newheight ?>" src="<?php echo  $img ?>" alt="<?php the_title(); ?>">
                        </div>  

                        </div>  
                    <?php 

                    endwhile; 
                    ?>

    </div>

</div> 
```

非常感谢。主题演示在[http://key-film.com/beta/](http://key-film.com/beta/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:58:58.407

尝试这个

post_type=post

```
query_posts("showposts=$showposts&post_type=post&paged=$paged"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:12:49.457

代替

```
$args = array(
    'showposts' => $showposts ,
    'post_type' => 'post', //select posts
    'paged' => $paged,
); 
```

删除`query_posts` （对加载时间不利）

并将 while 循环的行替换为：

```
while ( $my_query->have_posts() ) : $my_query->the_post(); 
```

# android - 在 Windows 上构建 asmack

> ID：13494814
> 
> 赞同：1
> 
> 时间：2012-11-21T13:54:38.190
> 
> 标签：android, windows, eclipse, xmpp, asmack

我正在开发一个用于多帐户即时通讯的 Android 应用程序，我需要使用 XMPP 库来完成这项工作；我目前正在 Windows 7 操作系统下使用 Eclipse 进行开发；
我已经仔细阅读了一些关于 Android 上 XMPP 库的主题，例如：

*   [阿斯马克替代品](https://stackoverflow.com/questions/7778170/asmack-alternative)
*   [Android 和 XMPP：当前可用的解决方案](https://stackoverflow.com/questions/4769020/android-and-xmpp-currently-available-solutions/5487854#5487854)
*   [XMPP 服务器的 Android asmack 聊天客户端](https://stackoverflow.com/questions/10975001/android-asmack-chat-client-for-xmpp-server)

[我决定使用https://github.com/Flowdalic/asmack](https://github.com/Flowdalic/asmack)上由 Flowdalic 修补和开发的 aSmack 库，因为在我看来这是最好的解决方案。

我的问题是**我无法在我的环境中为 Windows 下的 eclipse 构建库**。我不知道如何成功构建库以包含在我的 android 项目中。

这个库的构建环境似乎是为 unix 系统准备的：如果是这样，**我该怎么做才能在 windows 下构建这个库，或者我可以做些什么来在我的项目中包含这个库的功能版本**？ **或者如果可以在 windows 下构建，我可以使用另一个库（例如 Beem）**吗？
**或者也许有人可以向我提供已经构建的库的 .jar 文件**？

提前感谢大家的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T08:24:19.770

我建议在像 VirtualBox 这样的 VM 中安装 debian/ubuntu 系统，以便在 Windows 上构建 aSmack。确保安装了所有构建依赖项，通常是

> sudo apt-get install build-essentials

会成功的。

# silverlight - Silverlight - 仅通过 XAML 访问 ListBox 项属性

> ID：13494815
> 
> 赞同：0
> 
> 时间：2012-11-21T13:54:41.200
> 
> 标签：silverlight, xaml, properties, listbox

有谁知道如何访问存储在 a 中的项目`ListBox`及其各自的属性，以便在其他地方使用？

这是我到目前为止所拥有的：

首先，从网格中的可用列创建复选框列表的代码。这可以正常工作：

```
 <ListBox x:Name="testBoxes" ItemsSource="{Binding Columns, ElementName=radGridView}" Grid.Column="1" >
        <ListBox.ItemTemplate>
            <DataTemplate>
                <CheckBox x:Name="checkBox"  Content="{Binding Header}" IsChecked="{Binding IsVisible, Mode=TwoWay}"/>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

问题是，我想创建一个新的项目列表，并且我希望它由上面上一个列表中的项目填充，但前提是选中相应项目的复选框，所以：

```
 <ListBox ItemsSource="{Binding Items, ElementName=testBoxes}" Grid.Column="4" >
        <ListBox.ItemTemplate>
            <DataTemplate>
                <CheckBox Content="{Binding checkBox.Name}" IsChecked="{Binding checkBox.IsChecked, Mode=TwoWay}"/>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

这将生成正确数量的复选框，但它们不会有表格并且不会响应它们的对应对象是否被选中。

显然，诸如`checkBox.Name`和之类的代码`checkBox.IsChecked`是错误的，但是我没有运气弄清楚正确的代码是什么。

任何帮助将不胜感激，这感觉像是一个非常简单的问题，但过去半小时左右一直困扰着我。

# objective-c - 如何使用 PhoneGap V1.x 显示 iPhone5-Splashscreen

> ID：13494823
> 
> 赞同：0
> 
> 时间：2012-11-21T13:55:18.947
> 
> 标签：objective-c, xcode, cordova, iphone-5

有没有办法破解 PhoneGap 1.0 使其在 iPhone5 上显示正确的闪屏以避免 webview 的白色闪烁？

我可以控制启动画面

```
if(navigator.splashscreen) navigator.splashscreen.hide(); 
```

但在 iPhone5 上显示错误的图像。我需要显示 Default-568h@2x.png 图像。我知道在 PG2 中这是固定的，但我想避免更新整个项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T01:30:19.253

I have just figured out how to fix this issue in older Phonegap, and it's a pretty easy fix. In PhoneGapDelegate.m, find this:

```
UIImage* image = [[UIImage alloc] initWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"Default" ofType:@"png"]];
imageView = [[UIImageView alloc] initWithImage:image];
[image release]; 
```

and replace with this:

```
UIImage* image;

if ([[UIScreen mainScreen] bounds].size.height == 568.0f)
{
    image = [[UIImage alloc] initWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"Default-568h@2x" ofType:@"png"]];
}
else
{
    image = [[UIImage alloc] initWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"Default" ofType:@"png"]];
}
imageView = [[UIImageView alloc] initWithImage:image];
[image release]; 
```

For some reason, you need to specify full image name for iPhone 5 image just like in the code above. If you specify it with just @"Default-568h", image won't be loaded at all.

# java - 从 java 中的 postgresql 获取布尔值

> ID：13494824
> 
> 赞同：0
> 
> 时间：2012-11-21T13:55:22.303
> 
> 标签：java, sql, linux, postgresql, netbeans

我无法从 java 中的 postgresql 表中打印布尔值。

桌子：

```
java=# select * from Materias;
 codigo | nombre | contenido | troncal 
--------+--------+-----------+---------
      1 |        |           | f
      2 |        |           | f
      3 |        |           | f
      4 |        |           | t
      5 |        |           | t
      6 |        |           | t 
```

现在使用 getString 的输出

```
 linea = String.format("%-15d %-20s %-10s", resultado.getInt(1), resultado.getString(2), resultado.getString(3));
    Codigo          Nombre               Troncal   
    1                                    null      
    2                                    null      
    3                                    null      
    4                                    null      
    5                                    null      
    6                                    null 
```

使用 getBoolean 的输出

```
linea = String.format("%-15d %-20s %-10s", resultado.getInt(1), resultado.getString(2), resultado.getBoolean(3));

    Codigo          Nombre               Troncal   
    1                                    false     
    2                                    false     
    3                                    false     
    4                                    false     
    5                                    false     
    6                                    false 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:57:35.453

您有 4 列，但您只查看前 3 列！rs.getX(int) 方法从 1 开始索引（令人困惑）

顺便说一句，我会重写您的选择，以明确说明您要求返回它们的列和顺序。

# delphi - 将值分配给我的组件位图属性时访问冲突

> ID：13494829
> 
> 赞同：0
> 
> 时间：2012-11-21T13:55:43.960
> 
> 标签：delphi, properties, bitmap, components

我正在尝试创建一个必须使用位图的组件，当我去选择属性上的图像时遇到问题。

这是代码的摘录：属性声明

```
Property StarOff: TBitmap read FStarOff write SetStarOff; 
```

功能 SetStarOff

```
procedure TNotas.SetStarOff(const Value: TBitmap);
begin
FStarOff.Assign(Value);
end; 
```

但是，当我为属性赋值时，我得到了错误：

> 模块“TNte.bpl”中地址 1BC324B8 的访问冲突。读取地址 000000000

为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:46:38.007

您的 setter 方法看起来是正确的，但您遇到了访问冲突，因为您的 FStarOff 成员目前为零。

通常是在构建时创建它并在销毁时释放它。

```
constructor TMyComponent.Create(AOwner: TComponent);
begin
  inherited;
  FStarOff := TBitmap.Create;
end;

destructor TMyComponent.Destroy;
begin
  FStarOff.Free;
  inherited;
end; 
```

# regex - 捕获版本号的正则表达式

> ID：13494830
> 
> 赞同：1
> 
> 时间：2012-11-21T13:55:47.640
> 
> 标签：regex, sed, awk, grep

我有这样一条线

```
<zimlet name="com_feeder_sugarbee" version="0.7.1" description="Sugar Bee v0.7.1"> 
```

我只想提取字符串 0.7.1

你会建议什么工具？

我尝试过 sed、awk、grep ......我都不擅长其中任何一个。

**编辑**

像“.+”这样的模式在哪些语言/工具中？和 ”。*？” 应该返回最短的匹配吗？我确定我在某个地方看到过这个，但不记得在哪里。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T14:05:50.633

一种使用方式`sed`：

```
sed -n 's/.*version="\([^"]*\).*/\1/p' file 
```

或者，如果您的版本`grep`支持 Perl-regex：

```
grep -oP '(?<=version=")[^"]*' file 
```

结果：

```
0.7.1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:23:10.280

```
awk -F\" '{print $4}' file 
```

这里有一些无用的文本，因为这个愚蠢的网络界面不会接受少于 30 个字符的答案。

# regex - 为什么 POSIX 正则表达式“^a*$”匹配包含美元符号的字符串？

> ID：13494831
> 
> 赞同：1
> 
> 时间：2012-11-21T13:55:48.780
> 
> 标签：regex, unix, posix

我希望正则表达式`^[a-z]*$`不匹配`random$something`

但是，当我在 shell 上尝试时，这匹配：

```
~# echo "random$something" | grep "^[a-z]*$"
random

~# echo "aaaaa$something" | grep "^a*$"
aaaaa 
```

为什么会这样？

我在 Solaris 和 RedHat Linux 上都看到过这种情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:00:08.180

请注意，如果您只是这样做

```
echo "aaaaa$something" 
```

没有grep，结果是

```
aaaaa 
```

这是因为 shell 试图将 $something 解释为变量。如果将双引号更改为单引号，您将看到预期的行为；那是没有结果的。

# statistics - 使用错误分隔和连接的单词对文本进行规范化

> ID：13494836
> 
> 赞同：1
> 
> 时间：2012-11-21T13:56:15.687
> 
> 标签：statistics, nlp

假设我有一堆类似的带有噪音的字符串，主要是错误连接/断开的单词。喜欢：

```
 "Once more unto the breach, dear friends. Once more!"
 "Once more unto the breach , dearfriends. Once more!"
 "Once more unto the breach, de ar friends. Once more!"
 "Once more unto the breach, dear friends. Once more!" 
```

我怎样才能将每个人规范化为同一组单词？即

```
 ["once" "more" "unto" "the" "breach" "dear" "friends" "once" "more"] 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T19:02:39.303

这里有一些建议。我认为您最终将不得不编写一组例程/函数来修复您遇到的所有各种类型的违规行为。

好消息是您可以逐步添加到您的“修复”集并不断改进解析器。

我必须做类似的事情，我发现[Peter Norvig 的这篇文章](http://norvig.com/spell-correct.html)非常有用。（请注意，它是在 Python 中。）

这个功能，特别是你需要的想法：拆分、删除、转置和插入不规则的单词来“纠正”它们。

```
def edits1(word):
   splits     = [(word[:i], word[i:]) for i in range(len(word) + 1)]
   deletes    = [a + b[1:] for a, b in splits if b]
   transposes = [a + b[1] + b[0] + b[2:] for a, b in splits if len(b)>1]
   replaces   = [a + c + b[1:] for a, b in splits for c in alphabet if b]
   inserts    = [a + c + b     for a, b in splits for c in alphabet]
   return set(deletes + transposes + replaces + inserts) 
```

以上是 Norvig 的[拼写校正器的一个片段](http://norvig.com/spell-correct.html)

即使您不能按原样使用代码，核心思想也适用于您的情况：您取一个标记（“单词”），这是您的情况下的不规则单词，尝试不同的调整以查看它是否属于大已知和接受单词的字典。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T20:41:20.130

有点疯狂的想法，我只是建议它，因为我正在教我本周将要向我的学生提出的算法。

删除句子中的所有空格，例如`de ar friends`变成`dearfriends`. 存在一种二次时间、线性空间动态规划算法，可将无空格字符串拆分为最可能的单词序列。该算法在[此处](https://stackoverflow.com/questions/4355867/dynamic-programming-to-split-a-string-into-a-list-of-separate-words)和[此处](https://stackoverflow.com/questions/3466972/how-to-split-a-string-into-words-ex-stringintowords-string-into-words)进行了讨论--- 第二种解决方案是我想到的。这里的假设是你有一个很好的单词模型，并且查询该模型需要恒定的时间。

# c# - 编辑时Datagridview单元格文本消失

> ID：13494838
> 
> 赞同：1
> 
> 时间：2012-11-21T13:56:23.537
> 
> 标签：c#, winforms, datagridview

我正在用 C# 构建一个 winform 应用程序。我`DataGridView`用来填充数据。但是，当我尝试编辑它时，单元格内容就消失了。只有当我单击另一个单元格时，文本才会重新出现。

任何想法，为什么会发生以及如何解决它。附上 `DataGridView`文字消失时的截图。 ![在此处输入图像描述](../Images/ea09953c78cff0bdf788d5fd65e1f724.png)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-15T13:09:02.630

It is because when the cell is selected the foreground colour is the same as the cell background colour.

解决方法是更改​​选择前景色。因此，在数据网格属性上查找`DefaultCellStyle`，并将`SelectionForeColor`from `HighlightText`（在我的系统上是白色的）更改为白色以外的东西（黑色似乎是一个明显的选择）。您也可以将其设置在列上而不是整个网格上，在这种情况下，右键单击网格并选择`Edit Columns`它`DefaultCellStyle`，您要再次编辑它。

在我的情况下`DefaultCellStyle`，网格上的`SelectBackColor`= `Highlight`（蓝色）和`SelectForeColor`= `HighlightText`（白色）所以在它的表面上，我希望文本仍然可见。（列设置只是使用网格默认值。）但我看到的是白底白字。所以还有更多，但解决方案仍然是修补`SelectionForColor`.

# linux - 您如何向 bash 询问当前选项？

> ID：13494841
> 
> 赞同：6
> 
> 时间：2012-11-21T13:56:34.723
> 
> 标签：linux, bash, shell

我正在使用许多由 bash 脚本和其他工具构建的系统。通常，我认为使用 -e、-u 和 -o pipefail 选项来捕获错误情况并防止意外行为是一种很好的做法。

但是，一些第三方库（我可以更改其源代码）不这样做，并且不满意使用 -u 更改变量测试。

其中的脚本很可能是来源于未执行的。所以我想做的是在其中的一些中，设置一组更宽松的选项，然后恢复更严格的选项。由于有问题的脚本被许多用户使用，其中一些用户也遇到了同样的问题，我想将此更改放入第三方脚本中，即：

```
<preserve original options>
set +e +u +o pipefail
#do stuff like
if [ -n "$_UNSET_VAR" ] ; then
  cp <some stuff> <some other stuff>
fi
<restore original options (whatever they were)> 
```

我正在寻找保存和恢复这些原件的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T14:18:32.087

特殊参数`$-`包含当前设置的选项列表。`-e`您可以对其进行解析以查看是否`-u`已设置。对于`pipefail`，您必须解析`shopt`.

如果您可以在子 shell 中运行代码（您不尝试设置全局变量等），那么这样做可能会更容易，而不必担心重置原始状态。

```
(
    set +e +u +o pipefail
    if [ -n "$_UNSET_VAR" ]; then
       cp <some stuff> <some other stuff>
    fi
) 
```

# c# - 有没有办法在运行时动态加载数据提供者？

> ID：13494845
> 
> 赞同：0
> 
> 时间：2012-11-21T13:56:57.403
> 
> 标签：c#, asp.net, postgresql, dataprovider, npgsql

我不想修改我的 machine.config，但我想使用 Npgsql 库作为数据提供者。我会将我的应用程序部署到多个平台（包括单声道），所以我真的希望它“正常工作”而不是给我错误“无法找到请求的 .Net Framework 数据提供程序”。

有没有办法在运行时将 Npgsql“注册”为数据提供者，这样就不会发生这种情况？

我应该澄清 Npgsql 在大多数情况下没有在我的 machine.config 中的情况下可以正常工作，但是对于某些情况它不能很好地工作（例如 NLog——我目前的挫败感）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T12:24:12.053

我发现了如何做我需要做的事情；它不是“运行时”，但足够接近，我不必修改我的 machine.config。我将此部分添加到我的 web.config 文件中：

```
<system.data>
    <DbProviderFactories>
        <add name="Npgsql Data Provider" invariant="Npgsql" description=".NET Framework Data Provider for PostgreSQL" type="Npgsql.NpgsqlFactory, Npgsql" />
    </DbProviderFactories>
</system.data> 
```

...它开始像冠军一样工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:36:04.747

您将不得不求助于使用反射（代码适用于 Microsoft .NET Framework，因此您必须验证私有字段在 Mono 中是否相同）。

```
using System.Data.Common;

// 1\. Initialize the default configuration
DbProviderFactories.GetFactoryClasses();

// 2\. Retrieve the configuration table.
var config = (DataTable)typeof(DbProviderFactories).GetField("_providerTable", BindingFlags.NonPublic | BindingFlags.Static).GetValue(null);

// 3\. Add a new entry in the configuration (replace the values with ones for your provider).
DataRow dataRow = config.NewRow();
dataRow["Name"] = "SqlClient Data Provider";
dataRow["InvariantName"] = typeof(SqlConnection).Namespace.ToString();
dataRow["Description"] = ".Net Framework Data Provider for SqlServer";
dataRow["AssemblyQualifiedName"] = typeof(SqlConnection).AssemblyQualifiedName;
config.Rows.Add(dataRow); 
```

# c# - 在我的 WIndows 8 数字时钟应用程序中，秒数被跳过

> ID：13494846
> 
> 赞同：0
> 
> 时间：2012-11-21T13:56:58.123
> 
> 标签：c#, xaml, windows-8, windows-runtime

我正在为 Windows 8 应用程序开发一个数字时钟。

奇怪的是，每分钟都会跳过一些随机秒。我不确定为什么会这样。我的一个猜测是，这可能是因为有时要检索该自定义第二张图像需要超过一秒钟，因此下一秒会被跳过。

这是我在 XAML 中的代码

```
<!-- second -->
                <Grid Grid.Row="1" VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="-15,0,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Image Grid.Column="0"

                        Source="{Binding CurrentTime, Converter={StaticResource ThemeTimeConverterSecondDigit1}}" Opacity="0.99" Stretch="None" />
                    <Image Grid.Column="1"

                        Source="{Binding CurrentTime, Converter={StaticResource ThemeTimeConverterSecondDigit2}}" Opacity="0.99" Stretch="None" Margin="-30,0,0,0" />
                </Grid> 
```

绑定变量 Current Time 给了我时间，我使用转换器来获取那个时间的自定义图像。

这是我的转换器的代码

```
public object Convert(object value, Type targetType, object parameter, string language)
    {
        if (!(value is DateTime))
        {
            return value;
        }

        System.DateTime currentDate = DateTime.Now;

        var dt = (DateTime)value;

        var timePeriod = dt.ToString("tt ").StartsWith("A") ? TimePeriod.AM : TimePeriod.PM;

        if (!this.IsTwentyFourHour && dt.Hour > 12)
        {
            dt = dt.Subtract(TimeSpan.FromHours(12));
        }

        switch (this.Component)
        {

            case ThemeComponents.SecondDigit1:
                {
                    var sec = _GetFirstDigit(dt.Second);
                    return this.CurrentTheme.SmallDigits.Where(d => d.Value == sec).First().Image;
                }
            case ThemeComponents.SecondDigit2:
                {
                    var sec = _GetSecondDigit(dt.Second);
                    return this.CurrentTheme.SmallDigits.Where(d => d.Value == sec).First().Image;
                }
}

private int _GetFirstDigit(int number)
    {
        if (number >= 10)
        {
            return System.Convert.ToInt32(number.ToString().Substring(0, 1));
        }

        return 0;
    }

    private int _GetSecondDigit(int number)
    {
        if (number >= 10)
        {
            return System.Convert.ToInt32(number.ToString().Substring(1, 1));
        }

        return System.Convert.ToInt32(number.ToString().Substring(0, 1));
    } 
```

请告诉我您对为什么会发生这种情况的看法，或者您是否有更好的方法来实现它。谢谢

编辑：

我用文本块替换了图像，只给出了简单的数字，它仍然在发生。秒数仍在被跳过

编辑：这是当前时间设置的代码

```
 var timeoutputShown = false;

        _ClockTimer = new DispatcherTimer();
        _ClockTimer.Interval = TimeSpan.FromMilliseconds(1000);
        _ClockTimer.Tick += (s, e) =>
        {
            App.ViewModel.CurrentTime = DateTime.Now;

            if (!timeoutputShown)
            {
                timeoutputShown = true;
                //ShowTimePanelStoryboard.Begin();
            }
        }; 
```

回答：

我将间隔从 1000 毫秒减少到 100 毫秒，然后就做到了。非常感谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T17:46:27.500

如果您以 1 秒的间隔计时，那么您实际上也有 1 秒的误差范围，因此调度程序队列只需要保留一小段时间，以便从显示中减少一秒。你最好以更高的频率运行你的计时器，这样你就有更少的错误窗口，并且做更少的工作，因为你会被如此频繁地调用。

例如，如果您运行计时器以每 0.1 秒或 100 毫秒计时一次，那么您可以每秒最多更新 10 次秒，然后仅在要显示的值实际更改时才绘制屏幕更新。

例如，在一个只显示我们可以做的秒数的时钟中；

公共 void timer_tick(...) { MySeconds = DateTime.Now.Seconds: }

在哪里

Public int MySeconds { set { // 仅当第二个实际发生变化时 if (_mySeconds != value) { _mySeconds = value; NotifyPropertyChanged(...); } } }

诀窍是在每个阶段尽可能少地做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:43:30.267

尝试使用 DispatcherTimer 触发更新时钟时间的事件。

```
public void startTimer()
{
DispatcherTimer timer = new DispatcherTimer();
//Fire the Tick event every second
timer.Interval = new TimeSpan(0, 0, 1);
timer.Tick += timer_Tick();
timer.Start();
}

void timer_Tick(object sender, object e)
{
//Do whatever you want ex, refresh the time and show it in an label
} 
```

也许您最好创建自定义字体、设置标签样式并使用该组合来显示时钟。

有关 DispatcherTimer 的更多信息：http: [//msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.dispatchertimer.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.dispatchertimer.aspx)

# oop - EIEIO 组合（通过自己的插槽暴露包含对象的插槽）

> ID：13494847
> 
> 赞同：0
> 
> 时间：2012-11-21T13:57:00.127
> 
> 标签：oop, emacs, lisp, elisp, composition

我有两个 EIEIO 课程：

```
(defclass i-driver ()
  (;; more slots
   (exit-conditions
    :initarg :exit-conditions
    :initform nil
    :type list
    :documentation
    "Conditions to test in the main (while ...) expression"))
  :documentation "This class describes a single driver of `i-iterate' macro") 
```

和：

```
(defclass i-spec ()
  ((exit-conditions
    :type list
    :reader i--get-exit-conditions
    :documentation
    "Conditions to test in the main (while ...) expression")
   ;; more slots
   (drivers
    :initform nil
    :type list
    :documentation 
    "This slot contains the list of all drivers used in this iteration macro"))
  :documentation "This class contains a specification of the
expansion of the `i-iterate' macro") 
```

我想做的事：

*   通过从对象列表中聚合`exit-conditions`字段来通过类公开字段。我最初的想法是我可以定义一个读者，如下所示：`i-spec``i-driver`

* * *

```
(defmethod i--get-exit-conditions ((spec i-spec))
  (with-slots ((ds drivers)) spec
    (let (result)
      (while ds
        (push (oref ds exit-conditions) result)
        (setq ds (cdr ds)))
      result))) 
```

*   我不想在 中分配插槽`exit-conditions`，`i-spec`因为它只需要存储在`i-driver`.
*   我也希望槽是只读的（只能通过修改相应的驱动来修改，不能通过写入槽本身来修改）。

*PS。在版权声明的情况下，`i`在名称中是为了`iterate`，而不是为了沃兹尼亚克在苹果产品中使用的任何东西:)*

编辑：

这是我现在的做法：

```
(defmethod i-aggregate-property ((spec i-spec) property &optional extractor)
  (with-slots (drivers) spec
    (let ((ds drivers)result)
      (while ds
        (if extractor
            (setq result
                  (funcall extractor (slot-value (car ds) property) result))
          (push (slot-value (car ds) property) result))
        (setq ds (cdr ds))) result))) 
```

这是丑陋的外观：

```
(defmacro i-iterate (&rest specs)
  (let ((spec (i--parse-specs specs)))
    (with-slots (body result) spec
      (let* ((exit-conditions
              (i-aggregate-property spec 'exit-conditions #'append))
             (catch-conditions
              (i-aggregate-property spec 'catch-conditions #'append))
             (variables
              (i-aggregate-property spec 'variables #'append))
             (actions
              (i-aggregate-property spec 'actions #'append))
             (econds
              (cond
               ((cdr exit-conditions)
                (append '(and) (nreverse exit-conditions)))
               (exit-conditions (car exit-conditions))
               (t t)))
             (vars (nreverse variables))
             (body (append actions (nreverse body))))
        (cond
         ((and catch-conditions vars)
          (append catch-conditions
                  (list
                   `(let* (,@vars)
                      (while ,econds ,@body) result))))
         (catch-conditions
          (append catch-conditions
                  (list
                   `(while ,econds ,@body) result)))
         (variables
          `(let* (,@vars)
             (while ,econds ,@body) ,result))
         (t `(progn (while ,econds ,@body) ,result))))))) 
```

我可以添加一个宏来隐藏这个重复的调用并有类似的东西`with-slots`，但如果我不需要的话，我会更开心。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:04:19.987

你为什么不只定义一个`exit-conditions`指定的通用函数`i-spec`而不是一个插槽？

# javascript - 当鼠标位于固定 div 顶部时滚动底层 div 的方法？

> ID：13494850
> 
> 赞同：17
> 
> 时间：2012-11-21T13:57:02.273
> 
> 标签：javascript, jquery, html, css

这个问题太长了，想出一个总结它的标题被证明是棘手的。

所以无论如何。我有一个`div`，`overflow: auto`它经常流过，所以滚动条出现了。然后我有一个`div`，它`position: fixed`位于内容之上`div`。

现在，当我在 html 正文本身上有一个固定位置`div`时，当我将鼠标悬停在`div`. 前面提到的就没有那么幸运了`div`。

有没有办法滚动`div`“通过”固定位置的？

我注意到，即使在固定 div 上捕获滚动事件也不容易；除非固定的 div 本身是可滚动的，否则不会触发该事件。

[我在这里](http://jsfiddle.net/N2zbm/ "这里")做了一个简单的 jsFiddle ，为了方便起见，我把我尝试过的所有 JavaScript 都去掉了。

编辑：我需要使用固定的 div 保留其他鼠标功能，因此在我的情况下关闭指针事件不是解决方案。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-21T14:02:49.270

你正在寻找的是[`pointer-events: none;`](https://developer.mozilla.org/en-US/docs/CSS/pointer-events)

这使得指针本质上不与该 div 交互，所以就这样做

```
#fixed {
  pointer-events: none;
} 
```

[演示](http://jsfiddle.net/N2zbm/1/)

您将获得您想要的结果，而无需 JS。不过，这将停止与 div 的所有其他交互，如果您出于某种原因需要与它交互，恐怕您将不得不研究 JS 解决方案。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-11-21T14:40:53.627

```
var fixedElement = document.getElementById("fixed");

function fixedScrolled(e) {
    var evt = window.event || e;
    var delta = evt.detail ? evt.detail * (-120) : evt.wheelDelta; //delta returns +120 when wheel is scrolled up, -120 when scrolled down
    $("#content").scrollTop($("#content").scrollTop() - delta);
}

var mousewheelevt = (/Gecko\//i.test(navigator.userAgent)) ? "DOMMouseScroll" : "mousewheel";
if (fixedElement.attachEvent)
    fixedElement.attachEvent("on" + mousewheelevt, fixedScrolled);
else if (fixedElement.addEventListener)
    fixedElement.addEventListener(mousewheelevt, fixedScrolled, false); 
```

**[jsFiddle 演示](http://jsfiddle.net/Xg2uG/2/)**- 滚动！

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-11-22T12:59:02.480

我想出了一个更优雅的解决方案，但是由于 Ruirize 的回答让我走上了正确的道路，我给了他接受标签。

```
$('#fixed').on('mousewheel DOMMouseScroll', function(event) {
    $('#content').scrollTop($('#content').scrollTop() - (event.originalEvent.wheelDelta || -event.originalEvent.detail*30));
}); 
```

它也显示在[jsFiddle](http://jsfiddle.net/N2zbm/7/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-12-20T20:59:04.040

虽然接受的答案肯定会为您提供所需的结果，但自然滚动的平滑度和通过设置 scrollTop 触发的滚动存在明显差异。这利用了最好的部分，`pointer-events: none;`而实际上并没有消除与固定元素交互的能力。

```
function enableScroll(e) {
  var self = $(this);
  self.css('pointer-events', 'none');
  clearTimeout(this.timer);
  this.timer = setTimeout(function () {
      self.css('pointer-events', 'all');
  }, 100);
}
$('#fixed').on('mousewheel DOMMouseScroll', enableScroll); 
```

# c# - 助手与 C# 类？什么时候用什么

> ID：13494854
> 
> 赞同：2
> 
> 时间：2012-11-21T13:57:09.760
> 
> 标签：c#, javascript, razor, asp.net-webpages

嗨女士们先生们，

我是来自 Java 的 Razor 新手。我对助手的角色有点困惑。它们与定义做同样事情的 C# 类有何不同？你什么时候会使用帮助器来创建一个类并调用该类的方法？

也许，作为参考，可以使用[这个例子](http://www.microsoft.com/web/post/learning-the-basics-of-using-the-twitter-api-in-aspnet-web-pages-with-razor-syntax)。

也许为了完成，在编写 Web 应用程序时，Helper 和客户端 Javascript 将如何结合在一起？看起来他们会重叠很多？

最好的，

乔治斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T20:10:45.197

所以至少有两种方法可以定义助手。这是一种方法。

```
namespace MvcHelpers.Helpers
{
    public class ButtonHelper
    {
        public static MvcHtmlString SpecialButton(string id)
        {
          return new MvcHtmlString(String.Format("<input id=\"{0}\" type=\"button\" value=\"Special\"/>", id));
        }
    }
} 
```

我认为这就是您在说“C# 类”时所指的内容，但实际上它们只是帮助器，也可以更轻松地输出将在您的视图中呈现的 HTML。

这是另一种设计助手的方法，这可能就是您所说的“助手”。

```
namespace MvcHelpers.Helpers
{
    public static class ButtonHelperExtension
    {
        public static MvcHtmlString SpecialButton(this HtmlHelper helper, string id)
        {
          return new MvcHtmlString(String.Format("<input id=\"{0}\" type=\"button\" value=\"Special\"/>", id));
        }
    }
} 
```

这被称为帮助程序扩展，现在我们可以像所有其他标准 HTML 帮助程序一样引用它。下面是我们如何在 Razor 视图中引用这两种类型的助手。

```
@{
    ViewBag.Title = "Home";
}
@using MvcHelpers.Helpers;

<h2>Home Page</h2>

@ButtonHelper.SpecialButton("button1")
<br />
@Html.SpecialButton("button2") 
```

两种技术都达到了完全相同的结果。引用为 Html.SpecialButton 的是扩展方法。我看到的唯一优点是很明显它是一个 HTML 帮助程序，而不是执行其他一些功能。熟悉使用 HTML 帮助程序的人现在在使用 InteliSense 时会看到您的新函数。但是他们仍然必须输入正确的使用条款才能显示出来。因此，语义略有不同的结果相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:35:16.313

帮助程序可以帮助您创建 html 控件，例如文本框、按钮、链接等，这些控件将使您能够构建响应式 Web 应用程序。在 mvc 中，您有两种主要类型的助手：Html 助手和 Ajax 助手。要在 javascript 中使用帮助程序，您应该使用 Ajax 帮助程序。无论如何，您应该访问此链接并阅读 mvc 助手以及如何创建自定义助手。

[创建 MVC 助手](http://www.asp.net/mvc/tutorials/older-versions/views/creating-custom-html-helpers-cs)

[学习 MVC 助手](http://www.w3schools.com/aspnet/mvc_htmlhelpers.asp)

# php - 使用 PHP 修改 img 标签的内联 CSS

> ID：13494859
> 
> 赞同：0
> 
> 时间：2012-11-21T13:57:27.090
> 
> 标签：php, regex

我想根据以下标准修改img标签的内联CSS：

1.  如果它包含 float:left 或 float:right 则不做任何更改
2.  否则，添加显示：块。
3.  另外，修改边距 CSS 属性。将水平边距更改为自动并保留垂直边距。

例如，如果代码如下：

```
<img src="ex1.jpg" style="margin:5px 5px;float:left;" /> 
```

则无需进行任何更改。但是如果代码如下：

```
<img src="ex2.jpg" style="margin:5px 175px;" /> 
```

那么它应该修改为：

```
<img src="ex2.jpg" style="display:block;margin:5px auto;" /> 
```

或类似的东西：

```
<img src="ex3.jpg" style="margin-top:5px; margin-left:5px;" /> 
```

那么它应该修改为：

```
<img src="ex3.jpg" style="display:block;margin-top:5px margin-left:auto;" /> 
```

**编辑：** 对 img 标签的修改必须在我的 CMS 获得的 HTML 代码中进行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:20:09.057

尝试使用此模式进行匹配`<img/>`，而其中不包含任何`float`内容：

```
<img(?![^<>]+?\bfloat\s*:\s*(?:left|right))[^<>]+> 
```

**解释**

`<img(?![^<>]+?\bfloat\s*:\s*(?:left|right))[^<>]+>`

`<img`从字面上匹配字符`<img`。断言不可能从这个位置开始匹配下面的正则表达式（负前瞻）`(?![^<>]+?\bfloat\s*:\s*(?:left|right))`。匹配列表中不存在的单个字符`<>` `[^<>]+?`。在一次和无限次之间，尽可能少的次数，根据需要扩展（惰性）`+?` 在单词边界处断言位置`\b`。`float`从字面上匹配字符`float`。匹配单个字符 a `whitespace character`(空格、制表符和换行符) `\s*`。在零次和无限次之间，尽可能多次，按需回馈（贪婪）`*`。`:`从字面上匹配字符`:`。匹配单个字符`whitespace character`（空格、制表符和换行符）`\s*`. 在零次和无限次之间，尽可能多次，按需回馈（贪婪）`*`。匹配下面的正则表达式`(?:left|right)`。匹配下面的正则表达式（仅在此表达式失败时尝试下一个替代方法）`left`。`left`从字面上匹配字符`left`。或者匹配下面的正则表达式 2（如果这个匹配失败，则整个组都失败）`right`。`right`从字面上匹配字符`right`。匹配列表中不存在的单个字符`<>` `[^<>]+`。在一次和无限次之间，尽可能多次，按需回馈（贪婪）`+`。`>`从字面上匹配字符`>`。然后准备您的自定义函数以处理其余部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:35:24.703

编辑：

在我考虑了一秒钟之后，使用一大块示例 html 而不是一个漂亮的 img 标签列表来查看一个示例会更有帮助。请参阅下面的更新代码和输出。

规则非常简单，可以在需要时使用 preg_replace 轻松运行，并且可以使用 strpos 进行检查以保存正则表达式引擎调用。如果您有任何问题，请告诉我。

输出：

```
<html>
  <head></head>
  <body>
    <p> LOLOLOLOLOLOLOL </p>
    <img src="ex1.jpg" style="margin:5px 5px;float:left;" />
    <p> LOLOLOLOLOLOLOL </p>
    <img src="ex2.jpg" style="display:block;margin:5px auto;" />
    <p> LOLOLOLOLOLOLOL </p>
    <img src="ex3.jpg" style="display:block;margin-top:5px; margin-left:auto;" />
    <p> LOLOLOLOLOLOLOL </p>
  </body>
<html> 
```

代码：

```
<?php

// sample html blob
$sample_html = '
  <html>
    <head></head>
    <body>
      <p> LOLOLOLOLOLOLOL </p>
      <img src="ex1.jpg" style="margin:5px 5px;float:left;" />
      <p> LOLOLOLOLOLOLOL </p>
      <img src="ex2.jpg" style="margin:5px 175px;" />
      <p> LOLOLOLOLOLOLOL </p>
      <img src="ex3.jpg" style="margin-top:5px; margin-left:5px;" />
      <p> LOLOLOLOLOLOLOL </p>
    </body>
  <html>';

// grab all the matches for img tags and exit if there aren't any
if(!preg_match_all('/<img.*\/>/i', $sample_html, $matches))
  exit("Found no img tags that need fixing\n");

// check out all the image tags we found (stored in index 0)
print_r($matches);

// iterate through the results and run replaces where needed
foreach($matches[0] as $string){
  // keep this for later so that we can replace the original with the fixed one
  $original_string = $string;

  // no need to invoke the regex engine if we can just do a quick search. so here
  // we do nothing if it contains a float.
  if(false !=- strpos($string, 'float:')){
    continue;
  } 

  // inject the display:block if it doesn't already exist
  if(false === strpos($string, 'display:block;')){
    $string = preg_replace('/(<img.*style=")(.* \/>)/i', '$1display:block;$2', $string);
  }

  // preg_replace only replaces stuff when it matches a pattern so it's safe to
  // just run even if it wont do anything.

  // replace margin left if in margin:vert horiz; form
  $string = preg_replace('/(margin:[\s0-9]+px)\s[0-9]+px;/', "$1 auto;", $string);

  // replace margin-left value to auto
  $string = preg_replace('/(margin-left:).*;/', "$1auto;", $string);

  // now replace the original occurence in the html with the fix
  $sample_html = str_replace($original_string, $string, $sample_html);
}

// bam done
echo "{$sample_html}\n";

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:28:37.967

考虑使用`preg_match();`
这里的 php.net 快速链接：http: [//php.net/manual/en/function.preg-match.php](http://php.net/manual/en/function.preg-match.php)。你可以在那里看到例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T14:29:41.630

根据您的定义，快速而肮脏的功能：

```
function modify_img_css($html) {
    if (strpos($html, 'float:left') !== false || strpos($html, 'float:right') !== false) {
        return $html;
    }
    $html = str_replace('style="', 'style="display:block;', $html);
    if (strpos($html, 'margin-left:') !== false) {
        $html = preg_replace('/margin\-left:[^;]+;/', 'margin-left:auto;', $html);
    }
    if (strpos($html, 'margin:') !== false) {
        $html = preg_replace('/(margin:\s*\S+\s+)\S+;/', '\1auto;', $html);
    }
    return $html;
} 
```

# javascript - 如何使用 javascript 获取 HTML 元素的非计算 marginLeft 样式值？

> ID：13494864
> 
> 赞同：0
> 
> 时间：2012-11-21T13:57:35.370
> 
> 标签：javascript, html, css, margin

我已经尝试过`element.style.marginLeft`，但它在某些继承样式的情况下不起作用（只返回一个空字符串）。此外，`getComputedStyle`这不是一个选项，因为我想在这种情况下获得“自动”而不是计算值。对于 IE，`currentStyle`适用于我，但在其他浏览器中不可用。

我必须只使用普通的 js，**没有框架**，而且我需要它是跨浏览器的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T08:56:28.273

使用jQuery！

简单的语法：

```
x = #("#idName").css("cssPropertyName");
x = #(".classdName").css("cssPropertyName");
x = #("elementName").css("cssPropertyName"); 
```

:)

# c# - 使用 Rest Sharp 在休息调用正文中发布 XML

> ID：13494866
> 
> 赞同：0
> 
> 时间：2012-11-21T13:57:41.227
> 
> 标签：c#, xml, restsharp

我在尝试使用 Rest Sharp 进行 POST 时遇到问题。我正在尝试调用不完全符合现代标准的 Web 服务，并且我需要能够在我的帖子正文中发布请求 XML。

如果我只是对 RestRequest 对象执行 request.AddBody(xmlObject) ，则会将一个名为 text/xml 的参数添加到请求中。在这种情况下，我收到来自服务器的错误响应，提示“抛出异常：prolog 中不允许内容”。这告诉我服务器正在尝试处理参数的键 (text/xml=) 以及值。

当我在 RAW 正文字段中使用 chrome 中的 REST 控制台和所需的 xml 请求时，一切都按预期工作。

关于如何使用 Rest Sharp 进行这项工作的任何想法？

编辑：看起来我需要使用 request.AddFile("name", bytes_to_add, "file_name")。但是，当我尝试这样做时，出现异常（“System.InvalidOperationException：在写入开始后无法设置此属性。”），这看起来像是RestSharp 的一个从未解决的[问题。](https://github.com/restsharp/RestSharp/issues/204)我可能只需要使用 HttpWebRequest 库发出请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:05:49.510

你可能想多了。RestSharp.AddBody 将对象作为参数，并使用 JSON 或 XML 序列化程序自动将其序列化为正确的格式，具体取决于 RequestFormat 属性。

直接添加 XML 没有意义。REST 的部分魔力在于它支持多种格式，而不仅仅是 XML。RestSharp 在编写时考虑到了这一点，因此它的所有公共接口都只使用 POCO。

简单的解决方案就是不序列化对象。您不想添加 xmlObject，只需将您的真实 C# 对象传递给 AddBody 方法并让它处理序列化。

# c# - 如何在 .NET 中读取没有管理权限的事件日志？

> ID：13494867
> 
> 赞同：0
> 
> 时间：2012-11-21T13:57:43.263
> 
> 标签：c#, .net, windows, vb.net, event-log

我需要从 windows 中的安全日志中读取，但用户将没有管理权限，并且应用程序会抛出异常，

```
EventLog[] a = EventLog.GetEventLogs();

foreach (var item in a)
{
    if (item.Log == "Security")
    {               
        foreach (EventLogEntry item2 in item.Entries)//The exception thrown here
        {
            //TODO
        }
    }
} 
```

我只想看书，不想写东西。如何在没有这些权限的情况下访问这些条目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:05:39.400

有可能，但它需要合格的管理员执行大量步骤来设置必要的权限。有关详细信息，请参阅[http://blogs.technet.com/b/janelewis/archive/2010/04/30/giving-non-administrators-permission-to-read-event-logs-windows-2003-and-windows -2008.aspx](http://blogs.technet.com/b/janelewis/archive/2010/04/30/giving-non-administrators-permission-to-read-event-logs-windows-2003-and-windows-2008.aspx)。

如果您没有明确获得阅读权限，则不能——这就是 DRM 的全部意义所在。

# qt - 如何在 QGraphicsView 上显示弹出菜单？

> ID：13494870
> 
> 赞同：0
> 
> 时间：2012-11-21T13:57:48.020
> 
> 标签：qt, qt4, contextmenu, qgraphicsview

右键单击 QGraphicsView 时如何在 Qt 中显示弹出菜单？请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:01:35.460

`QGraphicsView`派生自`QWidget`，因此只需重新实现`contextMenuEvent(QContextMenuEvent* event)`以生成`QMenu`. 如果您希望在右键单击时出现`QGraphicsItems` *一个*，那么您将不得不`contextMenuEvent(QGraphicsSceneContextMenuEvent* event)`在项目中重新实现。

# intersystems-cache - 使用 'SqlComputeCode' 关键字将计算的属性投影到 sql 表中

> ID：13494872
> 
> 赞同：2
> 
> 时间：2012-11-21T13:58:02.373
> 
> 标签：intersystems-cache

我有一个有几个计算属性的类。我想将这些属性添加到投影的 sql 表中，以便我可以查询它们。但是，我注意到默认情况下计算的属性不会投影到 sql 表中。要将它们投影到sql表中，必须在指定数据类型后在括号中添加关键字SqlComputeCode

```
Property Age As %String [SqlComputeCode...] 
```

但是，我不确定此处使用的确切语法，也没有发现有关它的文档特别有用（我认为 Intersystems 需要展示更多示例）。因为属性是计算出来的，所以我已经有了一个 get 方法来进行计算。

```
Method AgeGet() As %String
{
   ...
   Quit "Something"
} 
```

我只想在我的 sql 表投影中使用这个 get 方法中的计算。谁能帮我吗？提前致谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T18:43:41.743

您无法从 SQL 计算中访问实例方法。因此，您需要重构您拥有的方法 - 最直接的是类方法。

```
Property Age As %String [SqlComputeCode = {S {Age}=##CLASS(MyClass).GetAge({DateOfBirth})}, SqlComputed]

ClassMethod GetAge(DateOfBirth as %Date)
{
    Q ##CLASS(MyDateRoutineClass).DifferenceInYears(##CLASS(MyDateRoutineClass).Now(),DateOfBirth)
}

Method AgeGet() As %String
{
   ...
   Quit ..GetAge(..DateOfBirth)
} 
```

# shell - Linux shell 脚本删除/恢复/回收站

> ID：13494883
> 
> 赞同：1
> 
> 时间：2012-11-21T13:58:40.577
> 
> 标签：shell

提前 TIA 寻求帮助。这是课程作业，因此我们非常感谢您进一步阅读！

基本上我必须在 bash 中编写 3 个脚本。一个将文件“删除”到我创建的目录（~/rubbish）。如果需要，另一个可以恢复它，另一个可以永久删除它。

我有点卡在我的垃圾脚本上。它似乎并没有真正删除任何东西，因为 ls 显示所有文件仍然存在。我也遇到了我为用户添加的标志（-a）一次性全部丢弃的问题，如果没有，那么它应该要求确认找到的每个文件。

这就是我现在所在的地方...

```
#!/bin/bash
if [ "$1" = "-a" ] 
then
cd ~/rubbish
rm ~/rubbish
mkdir ~/rubbish
echo "All files have been deleted"
else
cd ~/rubbish
ls > rubbish
for line in 'cat rubbish'
do
echo "Do you want to delete?" $line
echo "Y/N"
read ans
case "ans" in
Y|y ) rm $line;;
N|n ) " ";;
esac
done
fi 
```

正如我所说，它没有看到 -a ，它跳过第一个分支并运行第二个似乎很好，但是当我 ls ~/rubbish 时，所有文件仍然存在。

*编辑*感谢您的帮助！Sputnik，erm 除了添加分号之外，真的看不出您在评论中所做的更改？而inductiveLoad，你的答案是王牌，但我找不到正确工作的方法，失去了耐心，变得超级基本。像这样......

```
#!/bin/bash

if [ "$1" = "-a" ] ;
then 
cd ~/rubbish;
rm ~/rubbish/*;
echo "All files have been deleted";
else
  rm -i ~/rubbish/* ;
fi 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:09:41.057

我会用`getopts`它来解析选项，因为它允许更多的灵活性，任意数量的任意排序的参数，带有数据的选项（与标志相反 - 请参见`-d`下面的选项），并且如果您提供错误的选项，也会打印帮助。

```
usage()
{
cat <<EOF
usage: $0 options

This script deletes/restores/trashes files.

OPTIONS:
    -h  Show this message
    -a  Trash it all!
    -d  Rubbish directory
EOF
}

trashAll=false
rubbishDir="~/rubbish"

while getopts "ad:" OPTION; 
do
  case "$OPTION"
  in
        h)  usage
            exit 1;;
        a)  trashAll=true;;
        d)  rubbishDir=${OPTARG};;
        ?)  usage
            exit 1;;
    esac
done

if $trashAll
then
    #trash it all
    echo "Trashing all in ${rubbishDir}!"
fi 
```

# wpf - 将 TextBox.Text 绑定到自定义集合不显示自定义 ToString()

> ID：13494884
> 
> 赞同：1
> 
> 时间：2012-11-21T13:58:39.787
> 
> 标签：wpf, binding, collections, textbox

我有一个自定义集合，它扩展了 ObservableCollection 并覆盖了 ToString()。如果我将此集合绑定到 TextBox 的 Text 属性，如下所示：

```
 <TextBox IsReadOnly="True" Text="{Binding Satellites, Mode=OneTime}"/> 
```

其中 Satellites 将是这个自定义集合的一个实例，文本框会显示`(Collection)`而不是调用我的 ToString() 自定义实现。

这是预期的行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:53:40.380

该属性可能绑定到 a`CollectionView`而不是直接绑定到集合。

尝试向集合类添加一个属性以返回要显示的文本：

```
public string DisplayText
{
   get { return ToString(); }
} 
```

然后绑定到该属性：

```
<TextBox IsReadOnly="True" Text="{Binding Satellites.DisplayText, Mode=OneTime}"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:49:49.507

也许 WPF 查看绑定对象的类型，当它看到 IEnumerable 时，它​​不会调用 ToString()。

但我认为您可以通过使用转换器来获得相同的结果（假设您只想绑定该集合一次）。看看[IValueConverter](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter%28v=vs.100%29.aspx)。

# flash - WebView - ICS4.0 中的 Flash 重叠问题

> ID：13494885
> 
> 赞同：1
> 
> 时间：2012-11-21T13:58:42.860
> 
> 标签：flash, webview, overlap

**平台：**基于ARM7的设备
**android版本：** ICS4.0
**浏览器：** android默认浏览器

我在 android 浏览器上测试 flash 网站并观察到 ​​flash 总是与 webview 重叠。因此，如果任何网站包含任何位于 flash 之上的列表视图/菜单，总是使用 android 浏览器在 flash 后面。

以下是我已经尝试过的建议，但没有用
1\. 在 WebView 中覆盖 surfaceview 添加以将 zorder 更改为 false；(setZOrderOnTop(false))
2\. 将 html 页面设置 wmode 更改为不透明或透明

我已经看到这在 GalaxyS2 和 Google TV 图像（使用 Chrome 浏览器）上运行在同一平台上。在 Chrome 浏览器 (GTV) 中，WebKit 渲染在 SurfaceView 上方完成，对于 Flash Video，它使用 PluginWindow。因此 WebView 始终位于所有其他窗口的顶部。所以没问题。有趣的是，我还没有找到一个单一的网络参考来说明通过 SurfaceView 呈现网页的可能性，并且没有关于 android 中的 PluginWindow 的参考。

1.  对上述问题有什么建议吗？
2.  如何在surfaceview上渲染webview？这样webview就可以放在所有其他窗口之上

例如：[www.coca-cola.com/en/index.html](http://www.coca-cola.com/en/index.html)并点击美国的可口可乐。

# c++ - 使用给定的第一个和最后一个迭代器迭代范围

> ID：13494891
> 
> 赞同：2
> 
> 时间：2012-11-21T13:58:48.237
> 
> 标签：c++, iterator, containers

我有一段这样的代码：

```
template<class Iter>
void printRange(Iter begin, Iter last) {
    for (Iter i = begin; i != last; i++) {
        std::cout << *i << ", ";
    }
     outstd::cout << *last << ", ";
} 
```

我的问题是：我怎样才能优雅地打印出最后一个元素？在循环之后单独计算最后一个元素似乎不是一个好的和正确的解决方案，......有更好的方法吗？请注意，我也不能使用 <= 运算符或 boost 或任何 stl 特定功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:02:01.260

对于 STL 容器类，迭代器值*end*在最后一项*之后。*一旦到达*结束*，它可以退出，因为所有项目都已处理完毕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T14:04:12.447

您可以有条件地输出分隔符：

```
template<class Iter>
void printContainer(Iter first, Iter last) {
    for (Iter i = first, end = ++last; i != end; i++) {
        std::cout << (i == first ? "" : ", ") << *i;
    }
} 
```

对于更标准`[begin, end)`的半开范围：

```
template<class Iter>
void printContainer(Iter begin, Iter end) {
    for (Iter i = begin; i != end; i++) {
        std::cout << (i == begin ? "" : ", ") << *i;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:01:47.520

在 STL 中，有一个不包含值的最后一个迭代器，因此您的循环将在这种情况下工作。

也许您应该考虑在列表末尾添加另一个不包含任何值的迭代器，这样您就可以与 STL 保持一致。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T14:04:09.510

你可以做：

```
template<class Iter>
void printContainer(Iter begin, Iter last) {
    Iter afterEnd = end;
    afterEnd++;
    for (Iter i = begin; i != afterEnd; i++) {
        std::cout << *i << ", ";
    }
     outstd::cout << *last << ", ";
} 
```

但请注意，如果`end`由 STL 库（如`list.end()`）给出，它已经是最后一个元素之后的值，并且`++`会引发异常。

所以我会以你拥有的方式使用你拥有的代码。但是当我调用它时，我将我要打印的最后一个值之后的值传递给它。

# javascript - 找到某些单词并替换它们

> ID：13494894
> 
> 赞同：1
> 
> 时间：2012-11-21T13:58:56.783
> 
> 标签：javascript, replace, innerhtml, getelementbyid, words

我想找到：

“**纽约**”并替换为“**纽约市**”
“**华盛顿**”并替换为“**西雅图**”
“**佛罗里达**”并替换为“**杰克逊维尔**”
“**南卡罗来纳**”并替换为“**哥伦比亚**”
“**西弗吉尼亚**”并替换它与“**查尔斯顿**”

我在下面制作了以下示例代码，但这似乎不起作用：

演示：http: [//jsfiddle.net/N3ZmS/](http://jsfiddle.net/N3ZmS/)

```
<td id="dont-replace-them">
New York<br />
Washington<br />
Florida<br />
South-Carolina<br />
West_Virginia<br />
</td>

<br />

<td id="replace-them">
New York<br />
Washington<br />
Florida<br />
South-Carolina<br />
West_Virginia<br />
</td>

<script type="text/javascript">
function replaceWords() {
    document.getElementById("replace-them").innerHTML.replace("New York", "New York City");
    document.getElementById("replace-them").innerHTML.replace("Washington", "Seattle");
    document.getElementById("replace-them").innerHTML.replace("Florida", "Jacksonville");
    document.getElementById("replace-them").innerHTML.replace("South-Carolina", "Columbia");
    document.getElementById("replace-them").innerHTML.replace("West_Virginia", "Charleston");
};  
</script> 
```

任何人都知道应该修复什么才能使其正常工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T14:03:20.340

`.replace();`返回被替换的字符串，它不会改变 DOM 中的字符串。

```
var str = 'foobar';
str.replace('foobar', 'lorem ipsum');    // Returns 'lorem ipsum', but does no DOM manipulation. 
```

您需要将每个结果保存`.replace()`到一个临时变量中，然后更新 DOM。

```
function replaceWords(el) {
    el.innerHTML = el.innerHTML
                    .replace('New York', 'New York City')
                    .replace('Washington', 'Seattle')
                    .replace('Florida', 'Jacksonville')
                    .replace('South-Carolina', 'Columbia')
                    .replace('West_Virginia', 'Charleston');
}

replaceWords(document.getElementById('replace-them')); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T14:03:15.407

您需要将新的字符串值应用到 DOM 元素

```
document.getElementById("replace-them").innerHTML =
    document.getElementById("replace-them").innerHTML.replace("New York", "New York City");
// etc. 
```

顺便说一句，在定义函数之后，`replaceWords()`您还需要确保您实际调用了它。

您还需要使用一个`div`或类似的元素来正确呈现标记。

在这里工作[小提琴](http://jsfiddle.net/N3ZmS/1/)。

# android - RelativeLayout 中不能存在循环依赖

> ID：13494895
> 
> 赞同：0
> 
> 时间：2012-11-21T13:58:57.103
> 
> 标签：android, listview, android-relativelayout

我需要在 LinearLayout 和相对布局之间显示 ListView。我希望 ListView 的高度根据屏幕尺寸显示。为此，我放置了 layout_height="wrap_content"，并且我使用了 layout_above 和 layout_belowm 但这会返回：“RelativeLayout 中不能存在循环依赖”。这是我的布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/firstLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#FFFFFF"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/roadmap_linearlayout"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:gravity="center"
        android:orientation="horizontal" >
    ........
    </LinearLayout>

    <ListView
        android:id="@+id/listvisit"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/roadmap_linearlayout"
        android:layout_above="@+id/relativelayout_listpostovisit"
        android:layout_marginTop="10dp"
        android:layout_marginLeft="15dp"
        android:layout_marginRight="15dp"
        android:cacheColorHint="@android:color/transparent"
        android:divider="@drawable/listview_divider"
        android:dividerHeight="2dp"
        android:scrollbars="vertical" />

    <RelativeLayout
        android:id="@+id/relativelayout_listpostovisit"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/listvisit"
        android:layout_marginTop="10dp"
        android:layout_marginLeft="10dp"
        android:layout_marginRight="10dp"
        android:background="#FFFFFF"
        android:orientation="vertical"
        android:layout_centerHorizontal="true"
        android:layout_alignParentBottom="true">

       .........

    </RelativeLayout>

</RelativeLayout> 
```

知道如何解决这个问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:03:25.613

> 我希望 ListView 的高度根据屏幕尺寸显示。

我将把它翻译为“我想要`ListView`填充可用的屏幕空间”。

> 为此，我把 layout_height="wrap_content"

您不能可靠地`android:layout_height="wrap_content"`在`ListView`.

> 我使用 layout_above 和 layout_belowm 但这会返回：“RelativeLayout 中不能存在循环依赖”

那是因为您的外部`RelativeLayout`配置`relativelayout_listpostovisit`取决于 的位置，`listvisit`而 的位置`listvisit`取决于 的位置`relativelayout_listpostovisit`。那是行不通的。

任何一个：

*   更改`relativelayout_listpostovisit`、删除`android:layout_below="@id/listvisit"`和添加`android:layout_alignParentBottom="true"`，或

*   将外部容器切换为 a`LinearLayout`而不是 a`RelativeLayout`并切换到 using`android:layout_weight`以将额外空间分配给`ListView`.

# android - 小部件更新的 RemoteViews 超出最大位图内存使用错误

> ID：13494898
> 
> 赞同：10
> 
> 时间：2012-11-21T13:58:59.543
> 
> 标签：android, android-widget, android-service

我有一个小部件，它解析 xml 提要并显示其标题和图像。在这个小部件中，我使用了一个定期更改内容（即标题和图像）的服务。为此，我使用计时器类。当我们运行这个小部件时，某些内容显示没有任何问题，但一段时间后它会强制关闭并显示错误，例如“用于小部件更新的远程视图超出最大位图内存使用量（已使用：2465280 最大值：2304000）总内存不能超过填充设备屏幕所需的内存一次”。请有人帮我解决这个问题...在此先感谢

这是我的 AppwidgetProvider=>

```
 public class myappwidgetprovider extends AppWidgetProvider {
    public static String urls="http://www.abc.com/en/rssfeeds/9/latest/rss.xml";
    // XML node keys
    static final String KEY_HEAD = "item"; // parent node
    //static final String KEY_TITLE = "title";
    static final String KEY_DATE = "pubDate";
    public static String headflag="english";
    public static String[] Title;
        public static String[] Description;
        public static String[] Tit;
        public static String[] Tit2;
        public static String[] Desc;
        public static String[] Desc2;
        public static String[] image;
    public static TextView flashnews;

    public static int i=0;

     public void onUpdate( Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds )
        {

         Log.i("Tag", "onCreateView");
         parse();

           RemoteViews remoteViews;
                        ComponentName thisWidget = new ComponentName(context,myappwidgetprovider .class);

                int[] allWidgetIds = appWidgetManager.getAppWidgetIds(thisWidget);

                Intent intent = new Intent(context.getApplicationContext(),
                        Updatewidget.class);
                    intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS, allWidgetIds);
                            context.startService(intent);

               }

     public static void parse()
     {

            URL url;

            try {

                url = new URL(urls);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();
                if((conn.getResponseCode() == HttpURLConnection.HTTP_OK)){
                      DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
                      DocumentBuilder db = dbf.newDocumentBuilder();
                      Document doc;
                      doc = db.parse(url.openStream());
                      doc.getDocumentElement().normalize();

                      NodeList itemLst = doc.getElementsByTagName("item");
                      Description = new String[itemLst.getLength()];//........
                      Title = new String[itemLst.getLength()];
                      Tit=new String[itemLst.getLength()];
                      Tit2=new String[itemLst.getLength()];
                      Desc=new String[itemLst.getLength()];
                      Desc2=new String[itemLst.getLength()];
                      image= new String[itemLst.getLength()];

                      for(int i=0; i < itemLst.getLength(); i++){

                            Node item = itemLst.item(i);
                            if(item.getNodeType() == Node.ELEMENT_NODE){
                                  Element ielem = (Element)item;
                                  NodeList title = ielem.getElementsByTagName("title");
                                  NodeList date = ielem.getElementsByTagName("pubDate");
                                  NodeList description = ielem.getElementsByTagName("description");
                                  Tit[i]= title.item(0).getChildNodes().item(0).getNodeValue();
                                  Desc[i]= description.item(0).getChildNodes().item(0).getNodeValue();
                                  Tit2[i]=Translate.title(Tit[i]);
                                  Desc2[i]=Translate.description(Desc[i]);
                                  if(headflag=="malayalam")
                                    {
                                      Desc2[i]=Desc2[i].replace("read more","IqSpXÂ");
                                    }
                                  Title[i] =Tit2[i];
                                  if (Desc2[i].contains("<img ")){
                                      String img  = Desc2[i].substring(Desc2[i].indexOf("<img "));
                                      String cleanUp = img.substring(0, img.indexOf(">")+1);
                                      img = img.substring(img.indexOf("src=") + 5);
                                      int indexOf = img.indexOf("'");
                                      if (indexOf==-1){
                                          indexOf = img.indexOf("\"");
                                        }
                                      img = img.substring(0, indexOf);

                                //setImgLink(img);
                                    if(headflag=="malayalam")
                                    {
                                        String img2=img.replace("files","files/imagecache/android_320");
                                        Description[i]=Desc2[i].replace(img,img2);
                                        image[i]=img2;
                                    }

                                else
                                {
                                    String img2=img.replace("files","files/imagecache/android_1_img");
                                    Description[i]=Desc2[i].replace(img,img2);
                                    image[i]=img2;
                                }
                                  }
                                else
                                {
                                    Description[i] =Desc2[i];
                                }

                            }

                          }

                        }
            } catch (MalformedURLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (DOMException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (ParserConfigurationException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (SAXException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
     }

} 
```

这是我的服务=>

```
public class Updatewidget extends Service {
    static String UPDATEMOOD ="UPDATEMOOD";
    public Intent newintent;
    public AppWidgetManager app;
    public RemoteViews newviews;
    public int[] newappid;
    int i=0;
    @Override
    public void onStart(final Intent intent, int startId) {

         Log.i("Tag", "Service Called!!!!!!!!!!!!!");

         newintent=intent;
                 int[] allWidgetIds = intent
                    .getIntArrayExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS);
         newappid=allWidgetIds;

         final AppWidgetManager appWidgetMan = AppWidgetManager.getInstance(this);
         app=appWidgetMan;
         final RemoteViews views = new RemoteViews(this.getPackageName(),R.layout.widget_main);
         newviews=views;
         views.setTextViewText(R.id.title, myappwidgetprovider.Title[0]);
         Bitmap bitmap;
            try {
                bitmap = BitmapFactory.decodeStream((InputStream)new URL(myappwidgetprovider.image[0]).getContent());

                views.setImageViewBitmap(R.id.imageView4, bitmap);
            } catch (MalformedURLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
         appWidgetMan.updateAppWidget(allWidgetIds, views); 

         new ProgressAsyncTask().execute();

    }

     public class ProgressAsyncTask extends 
        AsyncTask<Void, Integer, Void> {

        @Override
        protected Void doInBackground(Void... params) {
            // TODO Auto-generated method stub
             int delay = 5000; // delay for 5 sec.

             int period = 5000; // repeat every sec.

             Timer timer = new Timer();
              timer.scheduleAtFixedRate(new TimerTask() {

                     public void run() {
                         i++;
                         if(i==5)
                         {
                             i=0;
                         }

                         int[] allWidgetIds = newintent
                                    .getIntArrayExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS);
                                 newviews.setTextViewText(R.id.title, myappwidgetprovider .Title[i]);
                         Bitmap bitmap;
                            try {
                                bitmap = BitmapFactory.decodeStream((InputStream)new URL(myappwidgetprovider .image[i]).getContent());

                                newviews.setImageViewBitmap(R.id.imageView4, bitmap);
                            } catch (MalformedURLException e) {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                            } catch (IOException e) {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                            }
                         app.updateAppWidget(allWidgetIds, newviews); 
                                 }

                     }, delay, period);
            return null;
        }
     }

    @Override
    public IBinder onBind(Intent intent) {
        // TODO Auto-generated method stub
        return null;
    }

} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-06T03:21:36.330

我刚刚解决了一个类似的问题。但我没有从网络加载任何内容。我的小部件针对不同的小部件尺寸显示不同的图像。对于某些屏幕，显示 4x4 小部件的错误与您的相同。

这是我在 developer.google.com 上找到的：

> RemoteViews 对象使用的总 Bitmap 内存不能超过填充屏幕 1.5 倍所需的内存，即。（屏幕宽度 x 屏幕高度 x 4 x 1.5）字节。

所以我能够在小部件中限制我的位图大小以适应这个要求。

在您的特定情况下，当从流加载的位图大于可能时，会发生错误。

我认为的用法

> public static Bitmap decodeStream (InputStream is, Rect outPadding, BitmapFactory.Options opts)

有适当的选择应该会有所帮助。（可能您需要使用 inSampleSize 选项）。

希望我的帖子对您​​有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-12-22T14:10:10.563

```
 Glide.with(mContext)
        .load(imageUrl)
        .override(480, 342) 
```

....

the override(...) did the trick for me. No more errors like: RemoteViews for widget update exceeds max bitmap memory usage error

# php - PHP PDO 删除早于“x”（用户定义）天的条目

> ID：13494900
> 
> 赞同：1
> 
> 时间：2012-11-21T13:59:02.790
> 
> 标签：php, mysql, input, pdo

首先，我在 1 个月前开始使用 PHP 和数据库，但到目前为止，我通过谷歌搜索找到了大多数问题的解决方案。

我正在尝试创建一个管理功能，您可以在其中删除早于“X”天的条目。但我很确定我的 PDO 有问题（ :day 部分）。

PHP：

```
$backsite = $_SERVER['PHP_SELF'];
if (isset($_POST['days'])) {
    $days = $_POST['days'];
    $statement = $db->prepare("DELETE FROM $tbl_name WHERE date < DATE_SUB(NOW(), INTERVAL :days DAYS)");
    $statement->execute(array(':days' => $days));
} 
```

HTML：

```
<form method="post" action="' . $backsite .'">
    <input type="number" min="7" max="90" placeholder="7" required="" name="days"/>
    <input type="submit" name="delete" value="Delete" />
</form> 
```

错误信息：

> 致命错误：未捕获异常 'PDOException' 并带有消息 'SQLSTATE[42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 /Applications/XAMPP/xamppfiles/htdocs/skiss/archive.php:10 的第 1 行的“DAYS)”附近使用正确的语法堆栈跟踪：#0 /Applications/ XAMPP/xamppfiles/htdocs/skiss/archive.php(10): PDOStatement->execute(Array) #1 {main} 在第 10 行的 /Applications/XAMPP/xamppfiles/htdocs/skiss/archive.php 中抛出

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:01:42.300

`DAYS`必须是单数。

```
DATE_SUB(NOW(), INTERVAL :days DAY) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:09:52.543

```
$backsite = $_SERVER['PHP_SELF'];
if (isset($_POST['days'])) {
    $days = $_POST['days'];
   $statement = $db->prepare("[DELETE FROM $tbl_name WHERE date < DATE_SUB(NOW(), INTERVAL :days DAY)](dev.mysql.com/doc/en/date-and-time-functions.html)");
   $statement->execute(array(':days' => $days));
} 
```

您的 SQL 语句中有一个额外的“S”。

# variables - 如何使用ffmpeg在视频的每一帧上显示帧号？

> ID：13494902
> 
> 赞同：5
> 
> 时间：2012-11-21T13:59:09.990
> 
> 标签：variables, ffmpeg, frame

我的测试命令如下：

```
ffmpeg -i in.mov -vf "drawtext=fontfile=/usr/share/fonts/ttf-bitstream-vera/Vera.ttf: x=(w-tw)/2: y=h-(2*lh)-n: fontcolor=white: fontsize=40: box=1: boxcolor=0x00000000@1: text=" -an -y out.mov 
```

我想在每一帧上显示帧号。但是，将“text”变量设置为“n”并没有帮助（它显示 n）并且 %n 似乎是换行符。最让我困惑的是这部分

```
y=h-(2*lh)-n 
```

效果很好，这意味着它获取当前帧的正确值并相应地向上移动文本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T18:38:35.097

好的，这个功能在 中没有`ffmpeg`，但现在有了。这就是你的做法：

```
...drawtext=text=%{n}:expansion=normal:fontfile=/usr/share/fonts/ttf-bitstream-vera/Vera.ttf:other_options... 
```

注意，扩展应该设置为正常，现在不是默认的，但将来应该是默认的（根据ffmpeg文档）。

# jquery - 根据内容动态更改 div 的宽度

> ID：13494904
> 
> 赞同：0
> 
> 时间：2012-11-21T13:59:12.690
> 
> 标签：jquery, html

我在一个 div 中有 3 个 div，如下所示：

```
 <div id="header">
          <div id="div1">
               <a class="menuSelector">
                    <span class="menuSeletedText">Contacts very long caption xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxyx</span>
                    <div class="menuSelectorButton"></div>
               </a>
          </div>
          <div id="div2"> at CUSTOMER NAME</div>   
          <div id="div3">
               <div>
                    <div id="filterdropdown" class="filterdropdown">
                         <a class="menuSelector">
                              <span class="menuSeletedText">Very long filter Name 12346666666667889999999999999999999999999999999999999910</span>
                              <div class="menuSelectorButton"></div>
                         </a>
                    </div>
               </div>
          </div>
     </div> 
```

![在此处输入图像描述](../Images/2fa8863ab3c04c011a34066dcbce7a4c.png)

理想情况下，我想说 div1 占总宽度的 30%，div2 占 30%，div3 占 40%。例如，如果div3（右边的div）不占40%，为了论证只占35%，那么剩下的5%平均分为div1和div2。如果 div3 占用超过 40%，则溢出内容会出现省略号。jquery 中的任何解决方案将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:18:17.830

我会按如下方式使用 CSS：

```
#div1,#div2,#div3 {
    display: table-cell;
    border: 1px solid blue;
}
#div1,#div2 {
    min-width: 30%;
}
#div3 {
    max-width: 40%;
    text-overflow: ellipsis;
} 
```

这不会给你你想要的东西，但它可能会足够接近。您在这些 div 中有一些非常不切实际的文本，因此浏览器正在尽其所能进行补偿。

# iphone - HTML 文件创建

> ID：13494905
> 
> 赞同：1
> 
> 时间：2012-11-21T13:59:26.253
> 
> 标签：iphone, html, objective-c, ios, xcode

我尝试以编程方式创建 HTML 文件。但生成的文件显示为空白文件。我不知道这个问题。

这是我的代码：

```
- (IBAction) createFileAction
{
    NSLog(@"************* createFileAction *************");
    NSMutableString *htmlString = [[NSMutableString alloc] init];
    NSLog(@"%@",htmlString);
    [htmlString appendString:@"<html><head><title></title><style type='text/css'>.style1{height: 27px;}#Text1{height: 19px;width: 210px;}.style2{width: 255px;}.style3{height: 27px;width: 255px;}#petValue{width: 206px;}#nameValue{width: 206px;}#dateValue{width: 209px;}"];
    [htmlString appendString:@"#Text2{width: 215px;}#Text3{width: 210px;height: 22px;}#Text4{width: 209px;}.style8{width: 13px;}.style9{ width: 263px;}.style10{height: 27px;width: 263px;}"];
    [htmlString appendString:@".style11{width: 418px;}.style12{width: 199px;}.style13{height: 27px; width: 199px;}.style14{height: 24px;}.style15{width: 410px;}</style> </head>"];
    [htmlString appendString:@"<body>"];

    NSString *originalString = [NSString stringWithContentsOfURL:[NSURL URLWithString:@"http://www.makepartsfast.com/2012/09/4337/more-3d-printing-in-metals-ex-one-introduces-the-m-flex-3d-printing-system/"] encoding:NSUTF8StringEncoding error:nil];
    NSScanner *scanner = [NSScanner scannerWithString:originalString];
    NSString *extractedString = nil;

    [scanner scanUpToString:@"<div class=\"postarea\">" intoString:nil];
    [scanner scanString:@"<div class=\"postarea\">" intoString:nil];

    [scanner scanUpToString:@"<div style=\"clear:both;\">" intoString:&extractedString];

    if (extractedString) 
    {
        // string was extracted
        NSLog(@"%@", extractedString);
    }   
    NSLog(@"BEFORE= %@",htmlString);
    [htmlString appendString:extractedString];
     NSLog(@"AFTER= %@",htmlString);
    [htmlString appendString:@"</body></html>"];
    NSLog(@"FINAL=%@",htmlString);

    // check to see if file already exists in documents directory
    if([self.fileMgr fileExistsAtPath:self.file])
    {
        NSLog(@"File already exists");
    }
    else 
    {
        NSLog(@"file does not exist");
        NSLog(@"Try creating the file");

        // file does not already exist so create it
        [self.fileMgr createFileAtPath:file contents:nil attributes:nil];

        NSLog(@"%@",htmlString);
        [htmlString writeToFile:self.file atomically:NO encoding:NSStringEncodingConversionAllowLossy error:nil];

        //Test again whether this file exists now that we have tried creating it
        if([self.fileMgr fileExistsAtPath:self.file])
        {
            NSLog(@"File exists now");
        }
        else 
        {
            NSLog(@"File still doesn't exist");
        }

    }
} 
```

**在这种方法中，我只从 html 格式的提取**字符串中的 URL 中选择部分并将其附加到 htmlstring。当我尝试附加不同的字符串时，它工作正常。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T18:25:59.437

`NSStringEncodingConversionAllowLossy`这是因为您作为`encoding`参数传递。您应该传递字符串编码参数之一。发生的事情是`NSStringEncodingConversionAllowLossy`等于 1。但是`writeToFile:atomically:encoding:error:`期待一个字符串编码常量。等于 1 的字符串编码常量是`NSASCIIStringEncoding`. 但是您的字符串无法转换为 ASCII，因此您得到一个空文件。将该行更改为使用 UTF8，您将获得预期的非空文件：

```
[htmlString writeToFile:self.file atomically:NO encoding:NSUTF8StringEncoding error:nil]; 
```

至少部分原因是**您没有检查返回类型或错误条件**，因此您遇到了麻烦。方法调用返回，如果出现任何问题`BOOL`，将创建一个。`NSError`如果您在听，这将帮助您找出问题所在。如果你这样做了：

```
NSError *saveError = nil;
if (![htmlString writeToFile:file atomically:NO encoding:NSStringEncodingConversionAllowLossy error:&saveError]) {
    NSLog(@"Error writing file: %@", saveError);
} 
```

您会看到一条错误消息，内容如下：

```
2012-11-21 11:20:47.250 Untitled[5731:707] Error writing file: Error Domain=NSCocoaErrorDomain Code=517 "The file “junk.html” couldn’t be saved using text encoding Western (ASCII)." UserInfo=0x7ffc0860b7c0 {NSFilePath=/tmp/junk.html, NSStringEncoding=1 
```

*起初*这可能并不明显，但它特别提到尝试使用 ASCII 的事实将是问题根源的一个巨大线索。

# php - php代码生成的打印报告

> ID：13494907
> 
> 赞同：-3
> 
> 时间：2012-11-21T13:59:33.700
> 
> 标签：php, printing, report, generated

> **可能重复：**
> [从 php 生成 PDF 报告](https://stackoverflow.com/questions/2417315/generate-pdf-report-from-php)

我正在为 PHP/mySQL 中的客户端构建数据库应用程序。生成了几个动态报告。客户希望他的员工能够打印这些报告。他不希望页眉/页脚打印出来，显然，在打印之前教他的所有员工如何关闭它太痛苦了。他看到另一个网站在需要打印时生成 PDF，他很喜欢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:23:00.223

打印时使用 CSS 隐藏对象 (http://stackoverflow.com/questions/355313/how-do-i-hide-an-element-when-printing-a-web-page) 和 FPDF (http://www .fpdf.org/) 创建 PDF 文档。

# c++ - 使用 ICU 进行分词

> ID：13494910
> 
> 赞同：0
> 
> 时间：2012-11-21T14:00:02.593
> 
> 标签：c++, cjk, icu, transliteration, text-segmentation

我正在使用 ICU4C 音译 CJK。我想知道是否可以在 ICU 中进行分词，将中文文本拆分为根据某些分词标准定义的单词序列。

例如，当我尝试音译时：

```
直接输出html代码而不是作为函数返回值代后处理 
```

使用

```
Transliterator* myTrans = 
                  Transliterator::createInstance("zh-Latin",UTRANS_FORWARD, err);
UnicodeString str;
str.setTo("直接输出html代码而不是作为函数返回值代后处理");
myTrans->transliterate(str);
str.toUTF8String(st);
std::cout << st << std::endl; 
```

我得到以下输出：

```
zhí jiē shū chū html dài mǎ ér bù shì zuò wèi hán shù fǎn huí zhí dài hòu chù lǐ 
```

检查在线拼音工具似乎非常好，但我的问题是ICU的字符一个一个音译。不过，我正在寻找的更像是下面的文字（我不懂任何中文，所以下面的文字可能没有任何意义，但它应该展示我感兴趣的输出类型） ：

```
zhíjiē shūchū html dàimǎér bùshì zuò wèihán shùfǎn huízhídài hòu chùlǐ 
```

[有人告诉我](https://stackoverflow.com/questions/13455282/transliterate-cjk-to-latin-preferably-in-c)ICU 50 能够进行分词，但我在他们的网页上也找不到任何文档。想知道你们中是否有人在 ICU 中使用过分词或知道如何做，或者您是否有任何关于如何做的好链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T16:14:27.657

“基于字典的迭代器”不是不同的 API。只需使用适当的语言环境 ID 创建一个 ICU 分词迭代器。

在 icu/source/samples/break 中有一个 ICU 附带的 C/C++ 示例

以下示例代码还显示了断字：http: [//source.icu-project.org/repos/icu/icuapps/trunk/iucsamples/c/s24_brkw/s24_brkw.cpp](http://source.icu-project.org/repos/icu/icuapps/trunk/iucsamples/c/s24_brkw/s24_brkw.cpp) [http://source.icu-project.org/ repos/icu/icuapps/trunk/iucsamples/c/s23_brki/](http://source.icu-project.org/repos/icu/icuapps/trunk/iucsamples/c/s23_brki/)

可能是这样的：

```
 BreakIterator *wordIterator = BreakIterator::createWordInstance(Locale("zh"), status);
UnicodeString text = "Unicode provides a unique number for every character, no matter what the platform, no matter what the program, no matter what the language.";
  wordIterator->setText(text);
  int32_t breakCount = 0;
    int32_t start = wordIterator->first();
    for(int32_t end = wordIterator->next();
        end != BreakIterator::DONE;
        start = end, end = wordIterator->next())
    {
         breakCount++;
    }
  delete wordIterator; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T07:19:58.217

这是我从 ICU 的邮件列表中得到的回复：

*“还有一个全新的[在线演示](http://demo.icu-project.org/icu-bin/icusegments#1/zh)正在进行中，它会在选择中文时进行分段并将您的文本拆分为以下内容。希望这会有所帮助。”*

```
直接
输出
html
代码
而不是
作为
函数
返回
值
代
后
处理 
```

这将解决我的问题，我需要音译此输出以获取我要查找的内容。

# java - 用于替换除下划线以外的所有特殊字符的 Java 正则表达式

> ID：13494912
> 
> 赞同：2
> 
> 时间：2012-11-21T14:00:11.423
> 
> 标签：java, regex

我想要一个正则表达式来删除除下划线以外的所有特殊字符。我可以替换所有特殊字符，但我不知道如何保留下划线。这是删除所有特殊字符的代码，

```
String myname= "!john_smith@#-".replaceAll("\\p{Punct}+", ""); 
```

任何想法如何修改正则表达式以便我保留下划线？

谢谢，帕特里克

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-21T14:03:13.957

Well`\\p...`与（**不**`[^\\P...]`具有该属性的字符的否定字符类）相同，然后您也可以将下划线放在那里：

 **```
"[^\\P{Punct}_]+" 
```

或者，使用负前瞻

```
"(?:(?!_)\\p{Punct})+" 
```

另外，看看你的例子，也许像这样简单的东西对你来说就足够了：

```
"[^\\w\\s]+" 
```

将删除除字母、数字、下划线和空格之外的所有内容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-21T14:02:26.893

使用集差：

```
System.out.println("#%a#%^$^_#$%b#$".replaceAll("[\\p{Punct}&&[^_]]", "")); 
```

印刷

```
a_b 
```

参考：[字符类](http://docs.oracle.com/javase/tutorial/essential/regex/char_classes.html)**

# wcf - 如何更改 IIS 托管的 WCF 服务的超时？

> ID：13494915
> 
> 赞同：5
> 
> 时间：2012-11-21T14:00:13.920
> 
> 标签：wcf

我们有一个托管在 IIS 中的 WCF 服务。我可以从日志文件中看到，发送需要 3 分钟以上才能执行的请求的客户端收到 HTTP 503（服务不可用）错误。

如何更改超时？为了测试它是否有效，我将超时时间减少到 3 秒，以确保它确实超时了。

我试过了

```
<system.web> 
    <httpRuntime executionTimeout="3"/> 
</system.web> 
```

这似乎什么也没做。

我也尝试过更改绑定无济于事。

```
 <basicHttpBinding>
    <binding name="basicHttp" receiveTimeout="00:00:03" sendTimeout="00:00:03" >
      <security mode="TransportCredentialOnly">
        <transport clientCredentialType="Ntlm" proxyCredentialType="None" realm="" />
        <message clientCredentialType="UserName" algorithmSuite="Default" />
      </security>
    </binding>
  </basicHttpBinding> 
```

请注意，我试图让 WCF 服务在我们控制的持续时间后返回某种故障。我不希望花费比预期更长的时间来终止请求。

在我把头发扯掉之前，任何帮助都是最受赞赏的。

* * *

只是为了澄清...

该服务已经启动并运行了几个月。但是在处理偶尔长时间运行的请求时，客户端会在 3 分钟后收到 HTTP 503 响应。在后台，我们可以看到请求已被正确处理，但花费了 > 5 分钟。显然，此时为时已晚，因为客户端已经收到错误响应。

其他请求正在正常处理。

此时系统上的负载非常低。事实上，这是一个测试环境，事务一次一个，没有重叠。

我也很确定绑定连接到端点。我已经在 WCF 配置编辑器中打开了配置文件，并且所有内容都已正确链接。

甚至可以在 WCF 的这一点上配置超时吗？如果不是，我会理解，但为什么会返回 HTTP 503 错误？

我们真正想做的就是控制返回 503 响应之前的时间长度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T21:08:09.833

通常，当我在对服务端点没有影响的绑定中进行更改时，这是因为绑定未连接到端点。

如果现在一切都得到 503 并且之前工作正常，则可能是作为应用程序池身份的用户帐户的密码已过期。

如果它适用于某些呼叫而不适用于其他呼叫，并且负载增加，则可能是客户端没有关闭连接，并且您达到了最大并发呼叫数的默认限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T08:54:23.680

在 IIS 和测试 WCF 服务中进行了大量实验后，我无法重现该问题 - 即使在同一台服务器上也是如此。这个问题只有公司内的另一个小组看到。

我可以强制 HTTP 503 错误的唯一方法是使应用程序池脱机，但这可以预见地导致在请求进入时立即返回错误。

进一步调查表明，与来自 IIS 的 503 响应相关联的 HTML 与返回给客户端的 HTML 不同。

~~诚然，这尚未得到证实，但我们得出的结论是，该问题是由客户端和服务器之间的某些网络组件引起的。~~

两者之间确实有一个代理正在返回超时。

# unit-testing - Camel Junit中XML消息的比较

> ID：13494920
> 
> 赞同：1
> 
> 时间：2012-11-21T14:00:26.477
> 
> 标签：unit-testing, apache-camel

有没有办法在 Camel Junit 中比较 XML 消息？

我正在使用以下代码：

```
@RunWith(CamelSpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "classpath:camel-context-test.xml" })
@DirtiesContext(classMode = ClassMode.AFTER_EACH_TEST_METHOD)
@MockEndpoints("*")
public class CamelRoutesTest/* extends XMLTestCase */{
    private static final Log LOG = LogFactory.getLog(CamelRoutesTest.class);
    @Autowired
    protected CamelContext camelContext;

    @EndpointInject(uri = "mock:d2")
    protected MockEndpoint direct1;

    @Produce(uri = "direct:d1")
    protected ProducerTemplate d1;

    @Test
    public void test1() throws Exception {
        LOG.info("Starting testTradeSaveToPL test");

            //node1 comes BEFORE node2
    String sendMsg = "<test><node1>1</node1><node2>2</node2></test>"; 

            //node1 comes AFTER node2
    String valMsg1 = "<test><node2>2</node2><node1>1</node1></test>";

        direct1.expectedBodiesReceivedInAnyOrder(valMsg1);

        d1.sendBody(sendMsg);
        direct1.assertIsSatisfied(camelContext);
    }
} 
```

我的问题是，在我发送到路由的 XML 消息中，node1 在 node2 之前，而在回复中 node2 在 node1 之前。

通过查看，我知道两个 XML 都是相等的，但是由于代码进行了字符串比较，所以它失败了。

我知道 XMLJUnit 比较工具，但是如何将它集成到给定的测试用例中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T18:32:22.433

我在我的 Camel 单元测试中集成了 XMLUnit 来比较 XML 消息。

在您的构造函数中，设置 XMLUnit：

```
@Override
public void setUp() throws Exception {
    super.setUp();

    //Tell XML Unit to ignore whitespace between elements and within elements
    XMLUnit.setIgnoreWhitespace(true);
    XMLUnit.setNormalizeWhitespace(true);
} 
```

然后稍后您可以运行断言：

```
 Diff myDiff = new Diff(actualResponse, expectedResponseAsString);
    assertTrue("XML identical " + myDiff.toString(),
                   myDiff.identical()); 
```

您可以使用此依赖项：

```
 <dependency>
        <groupId>xmlunit</groupId>
        <artifactId>xmlunit</artifactId>
        <version>1.3</version>
        <scope>test</scope>
    </dependency> 
```

这是用户指南的链接：

[http://xmlunit.sourceforge.net/userguide/html/index.html](http://xmlunit.sourceforge.net/userguide/html/index.html)

由于元素的顺序实际上是不同的，这个测试框架可能对你没有帮助。但是，您也可以只使用 Java 或 JDOM 中的 XPath API 来运行您的断言。

谢谢，约格什

# linux - Linux 配置 bash 脚本的示例

> ID：13494925
> 
> 赞同：0
> 
> 时间：2012-11-21T14:00:49.097
> 
> 标签：linux, bash, shell, unix

在获得了几周的 Linux 使用经验后，我需要对系统配置有更多的了解和控制，因为手动编辑文件似乎容易出错、耗时且复杂。

因此，我想编写一个脚本来完全检查并在必要时更正整个 Linux 系统的配置。检查文件和文件夹的存在及其权限不是问题，但我如何筛选单个文件的某些条目？提取所有感兴趣文件的内容并将其内容保存在一个文件中也可能很有趣。

无论如何，我不知道我的想法是否好，但我在这里问你们专业人士如何处理这个问题。谢谢你的回答。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:20:57.237

搜索“配置管理”（也许还有“devops”），我想你会发现很多有趣的材料。许多人使用[Puppet](http://puppetlabs.com/)、[Chef](http://www.opscode.com/chef/)等工具为其系统创建自动化、可重新部署的环境。

这是一个有很多解决方案的领域……还有很多先前的工作。虽然编写自己的脚本可能具有教育意义，但从长远来看，通过熟悉版本控制和配置管理并调整这些工具来满足您的需求，您可能会得到更好的服务。

# jquery - jquery datepicker不显示第二次

> ID：13494926
> 
> 赞同：0
> 
> 时间：2012-11-21T14:00:54.907
> 
> 标签：jquery, jquery-ui-datepicker

我使用 J 查询日期选择器来选择文本字段中的日期。一旦我选择日期并再次单击同一输入字段，它就不会显示日期选择器，一旦我单击文本字段之外的某个位置并再次单击文本字段，它就会起作用。

```
$(selector).datepicker({
      minDate: new Date(), 
      dateFormat: 'dd/mm/yy' 
 }); 
```

来人帮帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T14:35:12.577

我认为问题在于`showOn`默认情况下 datepicker 的属性是`focus`. 这意味着日期选择器仅在相关输入字段**获得**焦点时触发。当您使用日期选择器选择日期时，我假设输入字段之后仍然具有焦点，因此在单击它时不会再次“接收”它。您必须在输入字段外部单击然后进入它以触发`focus`事件（再次）。

另一种选择可能是使用按钮（`showOn: button`或`showOn: both`），以便您可以单击该按钮来触发日期选择器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T08:10:11.603

我真的不明白为什么在我选择日期并再次单击以更改它而不单击页面上的其他位置后没有显示日期选择器框。

但我解决了它写作

```
$(selector).datepicker('show'); 
```

# iphone - 将文件的所有者设置为 CustomClass 或 NSObject？

> ID：13494930
> 
> 赞同：1
> 
> 时间：2012-11-21T14:01:10.477
> 
> 标签：iphone, ios, ios5, ios6

我对代理对象非常困惑，尤其是`File's Owner`。到目前为止，我已经阅读[了这篇](http://crazyviraj.blogspot.com/2009/05/cocoa-what-is-files-owner-in-nib.html)文章以便能够理解**File's Owner**的概念。到目前为止，我能够在理论上理解它。

为了更好地理解，我尝试使用 IB创建一个**UITableViewCell**`CustomCell`的子类。然后，我创建了一个**UITableView**来使用我的. 到目前为止，我能够使它工作。****`CustomCell`****

 ****我构建这个项目是为了观察如何`File's Owner`使用以及它如何影响 .XIB 文件。但是，它比以前引起了更多的混乱。`File's owner custom class`因为，如果我设置`CustomCell`或不更改默认类，这没有任何区别。默认情况下，它是**NsObject**。

所以，我的问题是，在哪些情况下，我需要将 my 设置`File's owner custom class`为由我创建的类。或者，它总是应该设置为默认值。为什么我需要改变这个类？

我已经对 Web 和 SO 进行了研究。但是，我没有找到这个问题的任何解决方案。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:09:33.253

当您需要在 IBOutlets 或该类的属性中设置值时，您可以将 File's Owner 设置为自定义类。否则，XIB 无法了解它们。

例如，当您实例化 myViewController 时，它是 XIB 文件的所有者，内部指定的 UIView 被实例化，其指针存储在“view”属性中。如果您在 XIB 中有一个自定义按钮，它将被实例化，其指针存储在 IBOutlet myButton 中。****

# c# - 两个 DataGridView，由一对多关系连接 - 最佳实践

> ID：13494933
> 
> 赞同：1
> 
> 时间：2012-11-21T14:01:16.100
> 
> 标签：c#, datagridview, .net-3.5

我有 2 个数据网格视图。

首先是显示“父表”行（比如说 tOrders）。

第二个显示“子表”行（比如说 tOrdersItems）。

我想使用这些 DataGridViews 来读取和写入数据。

1.  我应该如何处理这两个数据网格？我的意思是如何在第二个 DataGridView 中仅显示与在第一个 datagridview 中选择的行相关的行？我应该使用过滤器还是其他东西？

2.  我可以在某处找到有关处理相关 DataGridViews 的文章或教程吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:03:57.407

1：基本上，你使用DataGridView的DataSource属性

2：http: [//msdn.microsoft.com/en-us/library/y8c0cxey.aspx](http://msdn.microsoft.com/en-us/library/y8c0cxey.aspx)

# stored-procedures - 使用经典 asp 从 oracle 11g 存储过程返回结果集

> ID：13494938
> 
> 赞同：4
> 
> 时间：2012-11-21T14:01:19.460
> 
> 标签：stored-procedures, asp-classic, oracle11g

我们最近从 Oracle 10g 升级到 11g，现在 microsoft provider`MSDAORA.1`将无法工作。我已更改为使用`OraOLEDB.Oracle`提供程序，但现在我的一个返回结果集的存储过程也不起作用。

**旧调用：** strSQL = "{call SYSADM.lss_pkg_catalog_pages.get_catalog_pages(?,{resultset 100, lss_media_cd, lss_page_num})}"

所以我一直在尝试将其更改为返回参数值，但我不断收到以下错误：`Error: -2147217900 - ORA-06550: line 1, column 7: PLS-00306: wrong number or types of arguments in call to 'GET_CATALOG_XXX' ORA-06550: line 1, column 7: PLS-00306: wrong number or types of arguments in call to 'GET_CATALOG_XXX' ORA-06550: line 1, column 7: PL/SQL: Statement ignored`

我猜这是因为我的输出参数的数据类型，但似乎找不到要使用的正确类型。

**这是我正在使用的代码：**

```
dim con, rst1, prm1, prm2, prm3, prm4

set cmCmd = Server.CreateObject("ADODB.Command")
set con = Server.CreateObject("ADODB.Connection")
Set Rst1 = Server.CreateObject("ADODB.Recordset")

Con.Provider = "OraOLEDB.Oracle"
Con.ConnectionString = "Data Source=XXXXXX;Password=XXXXXX;User ID=XXXXX;Persist Security Info=True"
Con.Open

cmCmd.ActiveConnection = Con
cmCmd.CommandType = adCmdText

Set Prm1 = cmCmd.CreateParameter("PRODUCT_ID", adVarChar, adParamInput, 20, strTempProductID)
cmCmd.Parameters.Append Prm1                                

Set Prm2 = cmCmd.CreateParameter("LSS_MEDIA_XX", adVarWChar, adParamOutput, 100) 
cmCmd.Parameters.Append Prm2                

Set Prm3 = cmCmd.CreateParameter("LSS_PAGE_XXX", adVarWChar, adParamOutput, 100) 
cmCmd.Parameters.Append Prm3 

strSql = "{ CALL SYSADM.lss_pkg_catalog_pages.get_catalog_pages(?, ?, ?) }" 

cmCmd.CommandText = strSql
cmCmd.Execute 
```

我有其他直接的 SQL 和其他存储过程调用可以很好地返回数据，只是这个存储过程不能正常工作。

**编辑：** 有人问我关于 Oracle 存储过程中的类型声明：

```
TYPE t_lss_media_XXX is TABLE of ps_lss_cat_XXXX.lss_XXX%TYPE
          INDEX BY BINARY_INTEGER;

TYPE t_lss_page_XXX is TABLE of ps_lss_cat_XXXX.lss_XXXX%TYPE
           INDEX BY BINARY_INTEGER; 
```

如果商店过程中需要更多信息，请告诉我，我可以发布。

任何建议将不胜感激。

谢谢罗伯特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T13:16:23.993

根据@searchAnResQ 在评论中的建议，我让我们的 oracle 团队重做存储过程以返回 Ref Cursor，这似乎可以解决问题。我发现我们正在使用的 ODAC 版本不支持返回表。

# javascript - 删除第一个元素后数组遍历幅度更快

> ID：13494940
> 
> 赞同：5
> 
> 时间：2012-11-21T14:01:29.750
> 
> 标签：javascript, arrays, optimization, traversal

在阅读[了最近关于优化的轰动一时的杂志](http://coding.smashingmagazine.com/2012/11/05/writing-fast-memory-efficient-javascript/)文章后，我进行了一些测试，以了解从我的一个数组中间“删除”一个元素的最有效方法是什么。

在运行我自己的关于从数组中间拼接出一个值与删除它/将其设置为 null 的测试之后，我遇到了一个相当出乎意料的结果，即从数组中拼接出值使数组的遍历速度提高了一个数量级.

更多调查使我想到了[这一点](http://jsperf.com/spliced-vs-non-spliced/2)。

出于某种原因，对数组中的第一条记录进行 .shift() 处理使其遍历速度提高了 300 倍（在 v8 中可以看到最大的性能，但它似乎对我尝试过的所有浏览器都有效）。

我怀疑我会滥用这个，因为我不认为实际的遍历是一个瓶颈，但是有谁知道为什么会发生这种行为？

**编辑：** jsPerf 的不正确使用是这里的根本问题，请参阅下面的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:36:51.407

性能测试充满了无数错误。
最重要的一个是采样长度为 1000。使用今天的处理器，遍历 1000 项数组是立即完成的，并且您测量的第一个数组方法（移位、切片、...）所花费的时间比实际的数组遍历。
因此，您必须
1）使用更长的数组，
2）在循环之前执行切片/移位/...，因为这不是您想要测量的。

然后您将看到**没有魔法**，并且数组遍历对所有数组都花费**相同的时间**。

我从[http://jsperf.com/spliced-vs-non-spliced/4](http://jsperf.com/spliced-vs-non-spliced/4)开始，适用于 normal/sliced(0,0) 和 shift() 情况。性能上的差异不如测量误差。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:03:46.967

所以我尝试从每个函数中删除 for 循环，将核心数组函数与 for 循环本身进行比较。

[http://jsperf.com/spliced-vs-non-spliced/3](http://jsperf.com/spliced-vs-non-spliced/3)

由于每个函数内部工作的这些简单差异，基准是按数量级缩放的。通过简化到最小的部分，我们能够分离出真正的差异。基于此，我怀疑 for 循环实际上是更快或更慢地遍历 - 由于测试中的其他功能，它只是看起来如此。

尽管存在误解，但阐明 Array 函数的工作原理以及 JavaScript 开发人员应如何应用它们仍然非常有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:10:11.053

好的，事实证明这实际上是我对 jsPerf 工作原理的误解。

脚本的设置部分是在每组循环开始时运行的，而不是每次尝试脚本时都运行它。

如此处所示[，](http://jsperf.com/spliced-vs-non-spliced/8)数字实际上如您所料。

# facebook-like - 用facebook喜欢按钮发表评论不起作用

> ID：13494947
> 
> 赞同：8
> 
> 时间：2012-11-21T14:01:41.817
> 
> 标签：facebook-like, facebook-comments, xfbml

我尝试使用 Like Button 的 XFBML 实现，如[facebook 社交插件页面中所述](http://developers.facebook.com/docs/reference/plugins/like/)

类似按钮出现并且工作正常（它要求确认操作，但工作正常）。

当我按下“赞”按钮时，会弹出一个新对话框评论框，让我添加一些评论以显示在我的墙上。但是，当我按下“发布到 facebook”按钮时，没有任何反应，弹出对话框仍然存在。最后，评论没有出现在我的 Facebook 墙上。

有什么帮助吗？？

# c - 是什么让这个程序代码打印出来 4

> ID：13494950
> 
> 赞同：1
> 
> 时间：2012-11-21T14:01:50.840
> 
> 标签：c, memory, pointers, undefined

```
int main(){
  int *p=0;
  printf("%d",++p);
} 
```

在我的机器中，我的输出为 4；我最初认为 *p 指向地址 0 并且它的递增从 0 指向地址 4。

后者我声明 *p = -1; 我认为应该抛出错误，因为 -1 不能是地址，但它会打印“3”:(

请让我知道这里发生了什么。提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-21T14:05:28.323

`int *p=0`在地址 0 处声明一个指针。
`++p`将该指针增加主机特定的`sizeof int`. 这是您系统上的 4 个字节。

`int *p=-1`给你一个带有地址的指针`0xffffffff`（假设是 32 位指针）
`++p`相当于`0xffffffff + 4`which is `0x100000003`. 这会溢出 32 位 int，留下`0x00000003`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T14:04:12.567

未定义的行为。

当你说：

```
int* p = 0; 
```

您正在声明一个指向 null 的指针（或`nullptr`在 C++11 中）。那么当你这样做时：

```
printf("%d", ++p); 
```

您正在打印指针的位置，但您传递的格式字符串不正确，这是未定义的。

它恰好起作用，因为在您的体系结构中，int 与指针的大小相同。它说`4`因为添加`1`到您的指针会移动地址的整数大小，在您的情况下为 4 个字节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:08:29.640

我们可以检查 C 标准来决定 C 实现是否应该允许负指针。但是，-1 可能是有效的地址值（32 位中的 0xffffffff），并且增加它会导致 0xffffffff + 4 = 0x03。

# drupal - Drupal 7 - 有没有办法在列表中显示特定组？

> ID：13494956
> 
> 赞同：0
> 
> 时间：2012-11-21T14:02:05.090
> 
> 标签：drupal, drupal-7, organic-groups

让我解释一下……我想为我的平台创建 4 个主要组，每个用户都可以看到。所以我想要一个这些组的列表，比如 OG 模块附带的默认用户组列表。

我在用户菜单中创建了一个链接，每个用户都可以看到他自己的组（用户组），现在我想在主菜单中创建一个链接，该链接将**仅**显示包含平台 4 个主要组的列表。

对如何进行有什么想法或建议吗？

我的第一个想法是创建一个将创建 4 个组的用户（系统用户，不是真人）。然后我会将他的用户组 url 用于主菜单项。所以我创建了这个用户和组，但我无法获取他的组列表的路径并将其添加到主菜单，因此任何用户都可以看到它们，因为这个视图显示了当前登录用户的组。

期待您的建议！如果有任何问题，请告诉我。

PS：我的设置是 Drupal 7 和 Organic 组。这 4 个组是公开的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:26:43.603

好的，这就是我所做的。

我创建了一个视图并编辑了过滤条件。

具体来说：

内容：已发布（是） 内容：组（= 组） 内容：标题（开始场景） 内容：作者 uid（= myuserid）

所以现在我有一个菜单项，点击它会显示一个包含 4 个主要用户组的表格！

欢迎任何更好的方法或建议！

# ruby-on-rails - 规范化还是非规范化？

> ID：13494960
> 
> 赞同：0
> 
> 时间：2012-11-21T14:02:29.350
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有三个模型：

*   国名：字符串
*   州名：字符串，国家：参考
*   城市名称：字符串，州：参考

我有模型：

*   用户名：字符串，姓：字符串，城市：参考，...

我应该在这个模型中保留对州和国家的引用，还是只保留对城市模型的引用？

什么解决方案更好？现场的流量不是那么高。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:20:53.953

这个答案完全取决于您的用例。如果您需要将邮件发送到相关地址，那么您很可能需要一个非常一致的地址。或者也许它只是其他用户知道的信息。

我住在一个叫“牛顿”的城市，但我的实际邮寄地址叫它“牛顿中心”，但我们大多数人都会写成“牛顿中心”。根据这些数据在我的应用程序中的使用方式，我可能会选择让用户输入他们的城市，也许使用您现有的列表作为帮助自动完成或其他方式的一种方式。如果您的数据库中没有用户可能居住的所有城市，或者如果存在错误，那么用户处理起来会很痛苦。有很多方法可以解决这个问题，但它们都以可用性换取数据的一致性。

如果您已经拥有这三个模型并且它们已被填充，那么也许这就是要走的路，并且拥有正确规范化的数据模型（像这样）始终是我的第一直觉。然而，这是一种特殊情况。特别是对于州（可能还有省）和国家/地区，您可以将已建立的 ISO 标准代码存储在代码中的散列中，并将 ISO 代码存储在数据库中。有许多 gem 提供这些参考。

我几乎总是会说“规范化你的数据库”，但这可能是一种情况，对于城市、州/省、国家（甚至邮政编码），您可能决定不使用数据库支持的模型。我认为这就是大多数“典型”应用程序处理地址的方式。

# performance - 是否可以使用 Imdisk 获得持久性 RAM 磁盘？

> ID：13494963
> 
> 赞同：6
> 
> 时间：2012-11-21T14:02:48.990
> 
> 标签：performance, ramdisk

我已将我的 JDK、工作区和 Tomcat 服务器移动到一个 RAM 磁盘，该 RAM 磁盘是在 Imdisk 工具的帮助下创建的。

这一举措增强了我的 Eclipse IDE 和我的工作效率。

但是每当我启动我的机器时，我都会丢失我的虚拟磁盘。这是一种持久化 RAM 驱动器及其内容的方法吗？

我使用的是 64 位 Windows 7，实际 RAM 为 8GB。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-15T19:58:42.627

IMDisk Toolkit 封装了 IMDisk 并有一个启动选项：[http ://reboot.pro/files/download/284-imdisk-toolkit/](http://reboot.pro/files/download/284-imdisk-toolkit/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T03:12:57.750

自动执行此操作的命令位于`FAQ`for 中`Imdisk`：

[http://reboot.pro/topic/15593-faqs-and-how-tos/](http://reboot.pro/topic/15593-faqs-and-how-tos/)

有一些方法可以让脚本在 Windows 启动（加载磁盘映像）和 Windows 关闭（将 ramdisk 保存到磁盘映像）时运行。

克里斯

# iphone - 如果每个对等点都与其他对等点双向连接，是否有害？

> ID：13494965
> 
> 赞同：1
> 
> 时间：2012-11-21T14:02:49.373
> 
> 标签：iphone, ios, networking, p2p, gksession

我在对等模式下使用 GKSession，其中应用程序的实例既是服务器又是客户端。

我像这样连接到其他同行：

```
- (void)session:(GKSession *)session peer:(NSString *)peerID didChangeState:(GKPeerConnectionState)state {
    self.currentSession = session;

    if (state == GKPeerStateAvailable) {
        [session connectToPeer:peerID withTimeout:0];
    }
}

- (void)session:(GKSession *)session didReceiveConnectionRequestFromPeer:(NSString *)peerID {
    [session acceptConnectionFromPeer:peerID error:nil];
} 
```

如果我有一台设备运行该应用程序，然后启动另一台运行该应用程序的设备，两台设备将看到对方并发送 -connectToPeer:withTimeout:。

我不明白的是，如果需要双向通信，两个希望相互连接的设备中只有一个发送 connectToPeer:withTimeout: 请求是否就足够了。

然后，我担心双向连接请求会造成麻烦。像这样盲目地这样做可以吗，还是我必须使用更复杂的检查，以便在一对对等点之间只建立一个连接？

**编辑**：测试显示一个对等点连接到另一个对等点就足够了。还测试了每个对等点是否会看到另一个对等点变得可用。所以我上面的代码会发出一个多余的连接请求。问题仍然存在，这是否对网络的稳定性和容量有害。

# c# - 检查一个列表是否包含来自另一个列表的任何元素

> ID：13494968
> 
> 赞同：10
> 
> 时间：2012-11-21T14:03:05.567
> 
> 标签：c#, linq

如果一个列表包含 list2 中的任何名称/值，我只是想返回 true：

这将是我的结构：

```
public class TStockFilterAttributes
{
    public String Name { get; set; }
    public String Value { get; set; }
}

List<TStockFilterAttributes> List1 = new List<TStockFilterAttributes>();
List<TStockFilterAttributes> List2 = new List<TStockFilterAttributes>(); 
```

这应该返回 true：

```
List1.Add(new TStockFilterAttributes { Name = "Foo", Value = "Bar" });
List2.Add(new TStockFilterAttributes { Name = "Foo", Value = "Bar" }); 
```

但这会返回 false，因为 Name && Value 不匹配：

```
List1.Add(new TStockFilterAttributes { Name = "Foo", Value = "Bar" });
List2.Add(new TStockFilterAttributes { Name = "Foo", Value = "Foo" }); 
```

每个列表可能包含许多不同的值，我只需要知道 List1 中的任何一个是否与 List2 中的任何一个匹配。

我试过使用：

```
return List1.Intersect(List2).Any(); 
```

但这似乎在所有情况下都返回 false，我假设这是因为我在 List 中持有一个类而不是一个简单的 int / string？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T14:09:38.327

覆盖`Equals`和`GetHashCode`实现您的课程：

```
public class TStockFilterAttributes
{
    public String Name { get; set; }
    public String Value { get; set; }

    public override bool Equals(object obj)
    {
        TStockFilterAttributes other = obj as TStockFilterAttributes;
        if (obj == null)
            return false;

        return Name == obj.Name && Value == obj.Value;
    }

    public override int GetHashCode()
    {
        return Name.GetHashCode() ^ Value.GetHashCode();
    }
} 
```

或者提供一个比较器来`Intersect`运行。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-21T14:07:42.327

假设性能无关紧要：

```
List1.Any(l1 => List2.Any(l2 => l1.Key == l2.Key && l1.Value == l2.Value)); 
```

替代方法是覆盖 Equals 或使其成为 Struct （可能不合适）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T14:14:49.617

```
var query = List1.Where(x => List2.Exists(y => y.Name == x.Name && y.Value == x.Value)); 
```

但是性能可能很差

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T14:08:03.827

这里的问题是您正在比较引用而不是对象。由于您每次都创建一个新对象，因此列表将永远不会包含相同的引用。

尝试：

```
var FooBar = new TStockFilterAttributes { Name = "Foo", Value = "Bar" };
var FooFoo = new TStockFilterAttributes { Name = "Foo", Value = "Foo" };
List1.Add(FooBar);
List2.Add(FooBar);
List2.Add(FooFoo);
return List1.Intersect(List2); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-22T16:13:36.560

迟到了，但有了 intersect 我们可以使用 select 并避免使用相等。

```
list1.Select(Function(p) p.ItemID).Intersect(list2.Select(Function(p)p.ItemID)).Any() 
```

# domain-driven-design - 可以让不同聚合中的实体从一个公共类继承吗？

> ID：13494969
> 
> 赞同：3
> 
> 时间：2012-11-21T14:03:10.903
> 
> 标签：domain-driven-design

我在属于不同聚合的几个实体中有一些共同行为，我想将其纳入抽象类。

**让不同聚合中的实体继承自一个公共抽象类有什么缺点吗？**

* * *

# 用例

一些实体具有名称、描述或其他可以翻译成不同语言的属性。

例如，我将使用 设置名称`setName(language, name)`并使用 检索它`getName(language)`。

每种语言的每个文本都存储在一个对象中，例如：

```
class EntityName
{
    protected Entity entity;
    protected Language language;
    protected String text;
    protected int version;

    public EntityName(Entity entity, Language language)
    {
        this.entity = entity;
        this.language = language;
        this.version = 1;
    }

    // setText(), getText(), ...
} 
```

对于给定的`Entity`类，`EntityName`在`Entity`聚合内。只能通过和`Entity`来创建、读取和写入。`EntityName``setName()``getName()`

但是，诸如`EntityName`, `EntityDescription`,之类的类`OtherEntityName`都将共享几乎相同的代码。唯一比变化的部分是对聚合的引用，因此是对构造函数的引用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:17:32.370

这个话题不多。但是，请查看这篇题为“[如何：领域驱动设计”的文章](http://apparch.codeplex.com/wikipage?title=How%20To%20-%20Domain%20Driven%20Design)

特别是，阅读标题为*步骤 2 - 识别聚合和聚合根*的部分：

> 在高级情况下，类模型中存在的多态性也会影响聚合边界。**当多个聚合根类都共享同一个基类**时会发生这种情况

 **如果您正在存储域模型之外的簿记数据（id、版本、创建时间戳、更新时间戳）（例如，为了支持您的持久层），我不认为这是一个问题。但是，如果您尝试重用真正的业务方法和属性，则可以考虑用组合或 AOP 介绍替换继承。

**更新**

查看更新后的用例后，您似乎真的在尝试实现代码重用，而不是真正的[Liskov is-a](http://en.wikipedia.org/wiki/Liskov_substitution_principle)关系。[一些语言通过mixins](http://groovy.codehaus.org/Category+and+Mixin+transformations) (Groovy) 或[特征](http://www.scala-lang.org/node/126)(Scala)等概念更好地支持这种类型的重用。假设 Java，您可以做的一种方法是创建一个类并使用 Project Lombok 的[@Delegate](http://projectlombok.org/features/Delegate.html)注释转发到您的实现。这有以下好处：

*   提供相同级别的聚合封装
*   为您生成字节码，没有源代码中的所有重复
*   允许您将一个继承选项保存为未来真正的 is-a 关系
*   确保整个域的一致性

我相信这更纯粹，并且可以使您的模型具有灵活性。我在几个项目中使用了 Project Lombok，并取得了巨大的成功。它允许您绕过 Java 中缺少的一些语言功能，并更多地关注您的领域，而不是实现某些惯用语所需的必要样板代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:26:40.560

我认为只要通用定义不影响聚合根设计就可以了。也就是说，您开始对聚合根进行建模并注意到它们有很多共同点，因此您提取了一个公共基类。

不过，我会三思而后行，因为从不同的有界上下文聚合根有这么多共同点的几率是多少？这有点像 IMO 的代码气味。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:50:33.650

正确的继承由`is-a`关系定义。恕我直言，很少有适用于聚合根的情况。

仅仅因为根看起来相似并不意味着它们来自同一个地方。

如果您可以创建一个名称在域中有意义的基类，请继续。如果没有，不要。**

# javascript - 如何更改 html5 视频元素的默认轨道？

> ID：13494971
> 
> 赞同：5
> 
> 时间：2012-11-21T14:03:13.280
> 
> 标签：javascript, jquery, html5-video

我的页面包含这个`<video>`带有几个 subtitle`<track>`的标签。我想通过使用jquery单击相应的国旗来动态启用轨道：

```
 <div id="lang">
    <img src="mini/ita.png" class="it" alt="Italiano" title="Italiano" />
    <img src="mini/eng.png" class="en" alt="English"  title="English"  />        
  </div>

<video controls="controls" >

  <source src="webcast.webm" />
  <source src="webcast.mp4"  />
  <source src="webcast.ogv"  />

  <track kind="subtitles" src="./sub-en.vtt" srclang="en" />
  <track kind="subtitles" src="./sub-it.vtt" srclang="it" />

</video>

<script>
$('#lang img').click(function(){
    language=$(this).attr('class');

    $('video track').removeAttr('default');
    $('video track[srclang='+language+']').attr('default','default');
});
</script> 
```

“默认”属性已正确插入，但没有显示字幕。手动插入默认属性效果很好（在 chrome 和 opera 上）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T08:13:41.713

```
<script>
$('#lang img').click(function(){
    var language=$(this).attr('class');

    $($('video').prop('textTracks')).prop('mode', function(){
        return this.language == language ? 'showing' : 'disabled';
    });
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:10:29.750

```
$('#lang img').click(function(){
    language=your value;
    $('#yourID').attr('srclang', language); 
 }); 
```

这样做..

# c# - XAML 数据绑定到全局变量？

> ID：13494974
> 
> 赞同：9
> 
> 时间：2012-11-21T14:03:19.830
> 
> 标签：c#, silverlight, xaml, data-binding, windows-phone-8

如何在 XAML 中将 TextBoxes Text 绑定到我的类中的全局变量？顺便说一句，这是针对 Windows Phone 的。

这是代码：

```
 namespace Class
    {
    public partial class Login : PhoneApplicationPage
    {
        public static bool is_verifying = false;

        public Login()
        {
            InitializeComponent();        
        }

        private void login_button_Click(object sender, RoutedEventArgs e)
        {
            //navigate to main page
            NavigationService.Navigate(new Uri("/MainPage.xaml", UriKind.RelativeOrAbsolute));
        }

        private void show_help(object sender, EventArgs e)
        {
            is_verifying = true;
        }
      }

    } 
```

我想将文本框文本绑定到“is_verifying”。

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-21T14:09:28.783

首先你只能绑定到属性，所以你需要添加一个getter和setter。

```
public static bool is_verifying { get; set; } 
```

接下来，您可以在`DataContext`此处将表单设置为您的类，并使用简单的绑定：

```
"{Binding is_verifying}" 
```

或者在表单的资源中创建对您的类的引用并像这样引用它：

```
<Window.Resources>
    <local:Login x:Key="LoginForm"/>
</Window.Resources>
...

<TextBox Text="{Binding Source={StaticResource LoginForm}, Path=is_verifying}"/> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T14:09:24.913

您不能绑定到一个字段，您需要将其设置为属性，并且仍然不会通知您更改，除非您实现某种通知机制，这可以通过例如实现[`INotifyPropertyChanged`](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)或通过制作来实现财产 a [`DependencyProperty`](http://msdn.microsoft.com/en-us/library/ms752914.aspx)。

当你有一个属性时，你通常可以使用[`x:Static`](http://msdn.microsoft.com/en-us/library/ms742135.aspx)标记扩展来绑定它。

但是绑定到静态属性需要一些技巧，这可能不适用于您的情况，因为它们需要创建类的虚拟实例或使其成为单例。另外我认为至少在 Windows phone 7`x:Static`中不可用。因此，您可能需要考虑将属性设置为实例属性，可能在单独的 ViewModel 上，然后您可以将其设置为`DataContext`.

# c++ - 无法在 QTreeView 中显示 .mp3 文件

> ID：13494975
> 
> 赞同：0
> 
> 时间：2012-11-21T14:03:20.940
> 
> 标签：c++, qt, qt4, treeview

我的 .ui 中有 2 个树视图。一个树视图是`DriveView`，另一个是`DriveListView`。现在我已经编写了一个代码，它在“DriveView”中显示我系统的驱动器。我已经这样做了：

```
// Gets called when application starts
void DetailView::onCamStartup()
{
   m_SystemModel = new QFileSystemModel(this);
   m_SystemListViewModel = new QFileSystemModel(this);
   m_SystemModel->setRootPath(QDir::currentPath());
   ui->DriveView->setModel(m_SystemModel);
   ui->DriveListView->setModel(m_SystemListViewModel);

   // regard less how many columns you can do this using for:
   for(int nCount = 1; nCount < m_SystemModel->columnCount(); nCount++)
      ui->DriveView->hideColumn(nCount);
} 
```

现在，一旦我单击我的特定驱动器，`DriveView`它就会向我显示其中的子文件夹。我基本上需要做的是迭代/遍历整个驱动器并搜索`.mp3`里面的文件。基本上检查所有文件夹和子文件夹。一旦找到文件，它应该在我的另一个 Treeview 中显示它们，即`DriveListView`. 我为此编写了以下代码：

```
void DetailView::on_DriveView_clicked(const QModelIndex &index)
{
QString sPath = m_SystemModel->fileInfo(index).absoluteFilePath();
ui->DriveListView->setRootIndex(m_SystemListViewModel->setRootPath(sPath));

m_SystemModel->setRootPath(QDir::currentPath());
m_SystemModel->setFilter(QDir::NoDotAndDotDot | QDir::AllDirs );
m_SystemListViewModel->setFilter( QDir::Files | QDir::NoDotAndDotDot );

QStringList m_list;
QDirIterator dirIt(sPath,QDirIterator::Subdirectories);

while (dirIt.hasNext())
{
    dirIt.next();
    if (QFileInfo(dirIt.filePath()).isFile())
    {
        if (QFileInfo(dirIt.filePath()).suffix() == "mp3")
        {
            qDebug()<<dirIt.filePath();
            m_list<<dirIt.filePath();
            m_list.append(dirIt.filePath());
        }
    }

    QStringListModel *model = new QStringListModel();
    model->setStringList(m_list);
    m_SystemListViewModel->setNameFilterDisables(false);
}
} 
```

每当我单击包含 mp3 文件的子文件夹时，它都会在树视图中显示它们。这是我面临的问题。当我单击邮件文件夹时，什么都没有显示。理想情况下，我想显示主文件夹及其子文件夹中存在的所有 mp3 文件。我已经放了`qDebug()<<dirIt.filePath();`，当我运行应用程序并单击驱动器时，这会打印`.mp3`应用程序输出中的所有文件，但它不会在树视图中显示它们，即`DriveListView`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:22:44.177

由于您无论如何都要手动迭代所有子目录，请尝试使用`QStringListModel`for `m_SystemListViewModel`。这样，您可以直接`m_list`在视图中显示。见[http://qt-project.org/doc/qt-4.8/qstringlistmodel.html](http://qt-project.org/doc/qt-4.8/qstringlistmodel.html)

或者，它看起来`QSortFilterProxyModel`可能用于过滤列表视图中显示的结果，但我从未使用过它。见[http://qt-project.org/doc/qt-4.8/qsortfilterproxymodel.html](http://qt-project.org/doc/qt-4.8/qsortfilterproxymodel.html)

# silverlight - 视图如何取消 PRISM 中的导航请求？

> ID：13494981
> 
> 赞同：1
> 
> 时间：2012-11-21T14:03:42.030
> 
> 标签：silverlight, silverlight-4.0, prism

我有一个实现 INavigationAware 接口的视图。该接口具有 OnNavigationFrom 方法，即根据 MSDN [http://msdn.microsoft.com/en-us/library/microsoft.practices.prism.regions.inavigationaware.onnavigatedfrom(v=pandp.40).aspx](http://msdn.microsoft.com/en-us/library/microsoft.practices.prism.regions.inavigationaware.onnavigatedfrom(v=pandp.40).aspx)，

> 当实施者被导航离开时调用。

现在，我想确保用户没有留下任何未保存的更改，如果有未保存的更改，请询问用户是否要保存它们。此时我需要能够以某种方式取消该导航请求，以防用户想要留下并继续编辑。

MSDN 上关于 INavigationAware 接口的文档没有说明应该如何使用该接口。

我可能大错特错了，没有办法取消它，或者这个界面不是为此而设计的。

无论如何，如果有人告诉我如何让用户留下并继续编辑已启动的导航请求，我将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T15:32:06.900

我发现还有另一个接口可以解决问题：“ [IConfirmNavigationRequest](http://msdn.microsoft.com/en-us/library/microsoft.practices.prism.regions.iconfirmnavigationrequest_members%28v=pandp.40%29.aspx) ”，它继承自 INavigationAware。它具有 ConfirmNavigationRequest 方法，该方法接受带有布尔参数的回调。如果我想取消导航请求，我用 false 调用该回调，如果我想留下来，我用 true 调用它：

```
continuationCallback(MessageBox.Show("Discard changes?", MessageBoxButton.OKCancel) == MessageBoxResult.Cancel) 
```

所以问题解决了。感谢您的关注。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T15:24:35.387

Have a look at this link: [http://www.silverlightshow.net/items/Working-with-Prism-4-Part-4-Region-Navigation.aspx](http://www.silverlightshow.net/items/Working-with-Prism-4-Part-4-Region-Navigation.aspx)

As an alternative, if you're using the RegionManager, maybe you can try putting some boolean logic around the RegionManager.RequestNavigate() method. Something like this:

```
if(isDirty)
{
    RegionManager.RequestNavigate(RegionConstants.ShellMainRegion, new Uri(typeof(YourView).Name, UriKind.Relative));
}
else
{
// Don't navigate
} 
```

One final thought. If you're using the EventAggregator, then you can publish a navigation event and respond accordingly.

# jquery - 下拉替换 - 提交不起作用

> ID：13494983
> 
> 赞同：1
> 
> 时间：2012-11-21T14:03:48.390
> 
> 标签：jquery, drop-down-menu, replace

我试图重用在互联网上找到的下拉替换，但遇到了两个问题：

1）我希望替换提交而不是创建href。我试图重写该函数并在 -tag 中添加 onChange 但它不起作用。有人有提示吗？

2）我尝试添加标志并扩展功能，`'<img class="option[selected]" />' +` 并添加了两个带有值名称和图像 URL 的 css 类，但由于我是 Javascript 新手，我找不到可行的解决方案。

这是整个功能：

```
$(document).ready(function() {
    createDropDown();

    $(".dropdown dt a").click(function() {
       $(".dropdown dd ul").toggle();
     });

    $(document).bind('click', function(e) {
       var $clicked = $(e.target);
       if (! $clicked.parents().hasClass("dropdown"))
       $(".dropdown dd ul").hide();
    });

    $(".dropdown dd ul li a").click(function() {
      var text = $(this).html();
      $(".dropdown dt a").html(text);
      $(".dropdown dd ul").hide();

      var langForm_mylang = $("#langForm_mylang");
      langForm_mylang.val($(this).find("span.value").html())
      });
     });

function createDropDown(){
  var langForm_mylang = $("#langForm_mylang");
  var selected = langForm_mylang.find("option[selected]");
  var options = $("option", langForm_mylang);

  $("#langFormReplacement").append('<dl id="target" class="dropdown"></dl>')
  $("#target").append('<dt><a href="#">' + selected.text() + 
      '<img class="$langCode" />' +
      '<span class="value">' + selected.val() + 
      '</span></a></dt>')
  $("#target").append('<dd><ul></ul></dd>')

  options.each(function(){
     $("#target dd ul").append('<li><a href="#">' + 
       $(this).text() + '<span class="value">' + 
       $(this).val() + '</span></a></li>');
  });
} 
```

# batch-file - 批处理：D:\ 的 CHKDSK，重启时没有查询

> ID：13494984
> 
> 赞同：0
> 
> 时间：2012-11-21T14:03:48.877
> 
> 标签：batch-file

我想通过批处理文件检查 C: 和 D: (C: 是主驱动器)。诀窍是在没有查询或请求的情况下完成它，它应该只完成任务并在下次启动时检查。我对 C: 的解决方案是`echo j | chkdsk C: /f /r`，但这不适用于 D: 因为两个请求会完成该任务，但就像我之前提到的那样，脚本应该完全自主工作，毫无疑问，无需查询，只需双击手动重启重新启动时完整的 CHKDS。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:49:42.163

如果我理解得很好，您想要的是在启动时执行辅助驱动器的扫描，但您不能在启动时扫描除“C：\”（系统驱动器）之外的任何其他驱动器。

所以，没有办法解决这个问题，抱歉。

# java - 将 DatePicker 日期从 SimpleDateFormat 解析并格式化为 SimpleDateFormat

> ID：13494987
> 
> 赞同：1
> 
> 时间：2012-11-21T14:04:04.430
> 
> 标签：java, android, simpledateformat

我正在尝试将 DatePicker 日期格式化为 SimpleDateFormat（“yyyy-MM-dd HH:mm:ss Z”）。有人告诉我，我需要使用 SimpleDateFormatter 将其解析为 Date 对象 - SimpleDateFormat("yyyy-MM-dd")，然后将其格式化为我需要的格式，如下所示。但是，我在 try catch 块中收到错误“重复的局部变量 eDate”。任何专家都可以检查我的代码并提供建议吗？

更新

```
@Override
    protected Dialog onCreateDialog(int id) {
        switch (id) {
        case EDATE_DIALOG_ID:
            return new DatePickerDialog(this, 
            sDateSetListener, mYear, mMonth, mDay);        
        }
        return null;
    }

    private DatePickerDialog.OnDateSetListener sDateSetListener =
        new DatePickerDialog.OnDateSetListener() {
            public void onDateSet(DatePicker view, 
            int year, int monthOfYear, int dayOfMonth) {

                mYear = year;
                mMonth = monthOfYear;
                mDay = dayOfMonth;                                
                updateDate();
            }
    };

    private void updateDate() {
        inputEdate.setText(
            new StringBuilder()                
                .append(mMonth + 1).append("-")
                .append(mDay).append("-")
                .append(mYear).append(" "));                
    }

    class CreateNewRequest extends AsyncTask<String, String, String> {

        protected String doInBackground(String... args) {

            Calendar c = Calendar.getInstance();

            SimpleDateFormat firstDateFormat = 
            new SimpleDateFormat("yyyy-MM-dd");

            SimpleDateFormat secondDateFormat = 
            new SimpleDateFormat("yyyy-MM-dd HH:mm:ss Z");

            String eDate = inputEdate.getText().toString();             

            try{

                Date date = firstDateFormat.parse(eDate);
                String eDate = secondDateFormat.format(date);

                }catch(ParseException e) {
                e.printStackTrace();
                }

            String submitDate = secondDateFormat.format(c.getTime());

            List<NameValuePair> params = new ArrayList<NameValuePair>();            

            params.add(new BasicNameValuePair("submitDate", submitDate));
            params.add(new BasicNameValuePair("request_date", eDate));

            } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:07:20.863

您复制了变量的声明`eDate`。如果您想要覆盖该值，只需`String`像这样删除类型声明即可：

```
eDate = df.format(date); 
```

**编辑：**

我想你想要的是这样的：

```
class CreateNewRequest extends AsyncTask<String, String, String> {
    protected String doInBackground(String... args) {
        Calendar c = Calendar.getInstance();
        SimpleDateFormat firstDateFormat = new SimpleDateFormat("yyyy-MM-dd");
        SimpleDateFormat secondDateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss Z");

        String eDate = inputEdate.getText().toString();             

        try {
            Date date = firstDateFormat.parse(eDate);
            eDate = secondDateFormat.format(date);
            submitDate = secondDateFormat.format(c.getTime());
        } catch(ParseException e) {
            e.printStackTrace();
        }
        List<NameValuePair> params = new ArrayList<NameValuePair>();            
        params.add(new BasicNameValuePair("submitDate", submitDate));
        params.add(new BasicNameValuePair("request_date", eDate));
    }
} 
```

# iphone - NSCalendar CurrentCalendar 问题

> ID：13494988
> 
> 赞同：2
> 
> 时间：2012-11-21T14:04:04.937
> 
> 标签：iphone, nsdate, nscalendar

我的应用程序做了很多日历计算，所以我需要为大多数这些功能设置一个 NSCalendar。现在调用`[ NSCalendar currentCalendar ]`似乎非常慢，因为其他人也评论了所以我想我可以简单地缓存 NSCalendar 的副本。然而，这个 NSCalendar 似乎不时会产生垃圾，如果我在需要时创建一个新的 NSCalendar，我就不会得到这些垃圾。我假设它要么被释放，要么以某种方式损坏，这令人惊讶，因为我正在使用“自动引用计数”

有什么建议么。

PS这可能是因为NSCalendar不是线程安全的吗？

PSS

我最终从主线程设置了我的 CurrentCalendar。这似乎解决了这个问题。如果有人对此有任何意见，请告诉我。

R

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:49:42.397

作为调查步骤，我建议您记录对象的类以查看它是否以某种方式更改为另一个对象。例如，如果您有以下代码：

```
NSCalendar *cal = [NSCalendar currentCalendar]; 
```

然后稍后（特别是如果您可以判断数据何时损坏），您将执行以下操作：

```
NSLog(@"Calendar class: %@", [cal class]); 
```

一切顺利后，您应该取回 __NSCFCalendar。

# python - 部署后 Django 断开链接

> ID：13494989
> 
> 赞同：0
> 
> 时间：2012-11-21T14:04:04.807
> 
> 标签：python, django

部署我的网络应用程序后，django 开始向我发送断开链接的邮件。从昨天开始，我一直在努力解决问题，但没有成功。

我收到的邮件是；

```
Referrer: http://tesst.com/listing/
Requested URL: /favicon.ico
User agent: Opera/9.80 (Android; Opera Mini/7.5.31657/28.3030; U; en) Presto/2.8.119         Version/11.10
 IP address: 000.00.0.00 #just used this 0 to represent IP address of the user. 
```

在我的模板中：

```
<!DOCTYPE html>
  <html lang="en">
   <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta charset="utf-8" />
    <meta name="robots" content="index, follow" />
    <meta name="webmaster" content="test@gmail.com" />
    <link href= "{{ MEDIA_URL }}/favicon.ico" rel="icon" type="image/x-icon">
    <link rel="stylesheet" href="{{ MEDIA_URL }}/css/style.css"/>
    <title> {% block title %} {% endblock %} </title> 
   </head> 
```

更新：这是意见

```
 def lispy(request):
          cripys=Wriby.objects.all()
          for crip in cripys:
              print crip.id
              return render_to_response('partners.html',{'cripys':cripys,'crip':crip},context_instance=RequestContext(request))
         else:
            return HttpResponse('Invalid') 
```

我怎样才能摆脱这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:12:17.110

看起来您的网站图标不可用。检查以查看以下在您的页面上呈现的内容：

`{{ MEDIA_URL }}/favicon.ico`

将其插入浏览器。在这种情况下，图标的路径错误，您可能不会得到任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:31:37.773

检查 settings.py 中的 SEND_BROKEN_LINK_EMAILS。文档：[https ://docs.djangoproject.com/en/dev/ref/settings/#send-broken-link-emails](https://docs.djangoproject.com/en/dev/ref/settings/#send-broken-link-emails)

# bash - 限制循环中的步骤执行

> ID：13494990
> 
> 赞同：0
> 
> 时间：2012-11-21T14:04:09.323
> 
> 标签：bash, loops

我有一个这样的 bash 脚本：

```
#!/bin/bash
while true; do
    sudo tcpdump -i eth0 -w dump.pcap -c 1500 &
    chromium-browser --app http://domain.com &
    sleep 60
    killall chromium-browser
    sudo killall tcpdump

    # do some stuff with pcap file
    # it basically converts the pcap to plain text using tshark
    # then a PHP script parses the plain text

    sleep 240
done 
```

它工作正常。但有时，无论出于何种原因，什么都不会被杀死，脚本就会卡在那个循环步骤中。它实际上什么都不做，不占用任何资源。似乎脚本正在等待被杀死的东西。

我试过限制 tcpdump 捕获的数据包，但是没有用。tcpdump 正常完成其工作，无需被杀死，但脚本不会杀死 chromium 并且不会继续执行其余代码。

有没有办法检测一个步骤是否花费太长时间，然后简单地杀死所有东西并进入下一步？

**更新**

**这`it is a long code`**

它使用 tshark 将 pcap 文件转换为纯文本，并且 PHP 脚本解析纯文本。问题不在于这部分，因为 tshark 从未被调用过，也从未被调用过 PHP 脚本。在那之前一切都停止了。

**增加睡眠**

它不会重现问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:17:10.280

如果您不介意进程非正常退出，您可以使用 SIGKILL 而不是 SIGHUP：

```
killall -9 chromium-browser
sudo killall tcpdump 
```

但是，在这种情况下，最好捕获您已启动的进程的 pid 并仅终止这些进程（而不是终止所有 chromium-browers 和 tcpdump 实例）。

您可以使用 $! 访问上次运行进程的 pid。

```
sudo tcpdump -i eth0 -w dump.pcap -c 1500 &
tcpdump_pid=$!
chromium-browser --app http://domain.com &
chromium-browser_pid=$!
sleep 60
kill -9 $tcpdump_pid
sudo kill $chromium-browser_pid 
```

回答您的问题“有没有办法检测一个步骤是否花费太长时间，然后简单地杀死所有内容并进入下一步？” 我建议`timeout`在 coreutils 中使用该实用程序。

```
timeout 5 sudo kill -9 $chromium-browser_pid 
```

尽管最好确定为什么会挂起，而不是解决它，否则您将遇到资源泄漏。面对超时重写循环会更整洁：

```
sudo timeout 60 tcpdump -i eth0 -w dump.pcap -c 1500 &
timeout 60 chromium-browser --app http://domain.com & 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-04T08:45:02.893

```
sudo tcpdump -Z root -w dump.pcap -n -i eth0 -G 300 -W 1
```

```
G - 超时秒数（超时后命令自动被杀死）

Z - 删除 root 并以用户权限运行

W - 要保存的文件数量（作为拆分文件）

```

# sharepoint - 如何将自定义操作按钮列添加到列表中？

> ID：13494995
> 
> 赞同：0
> 
> 时间：2012-11-21T14:04:09.960
> 
> 标签：sharepoint, sharepoint-2010, infopath, sharepoint-designer, infopath2010

我需要保留包含大量链接的列表，并且我希望我的用户能够通过位于每一行的按钮来报告损坏的链接。

到目前为止，我设法使用 InfoPath 创建了一个自定义表单，但该按钮仅出现在 SharePoint 的编辑/添加新项目窗口中。我希望它出现在自己的列中，每行都有一个按钮。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T02:45:03.590

我不知道“它自己的列”，但是如果您将自定义操作位置设置为 editcontrolblock，它会在您单击列表项时出现在上下文菜单中。如果您对此感兴趣，请访问此页面，那里有一个 xml 示例[http://www.dotnetmikael.com/2012/09/sharepoint-2010-renaming-listitems.html](http://www.dotnetmikael.com/2012/09/sharepoint-2010-renaming-listitems.html)

# java - 如果每个线程都插入唯一键，我是否需要并发哈希映射？

> ID：13494997
> 
> 赞同：9
> 
> 时间：2012-11-21T14:04:20.667
> 
> 标签：java, concurrency, hashmap

据我了解，从 Java 5 开始的并发哈希映射为您提供了一个线程安全的哈希映射，它不使用迭代器和更新的阻塞访问（如果并发级别足够的话）。

鉴于以下条件：

1.  插入只发生一次（在应用程序初始化期间）。
2.  每个线程都有一组要插入的键，这些键不被任何其他线程共享。
3.  更新永远不会发生。
4.  选择仅在应用程序初始化结束后发生。

使用简单的哈希映射会更好吗？

我的理解是我可能会过得更好，因为我的钥匙不会发生冲突——我可以保证。但是，Java 实现是否有可能通过将同一个桶分配给两个不同的键来搞砸哈希桶？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-21T14:07:34.247

如果您使用多个线程插入，即使键不同，您也绝对应该使用`ConcurrentHashMap`或同步插入。Plain对于并发写入`HashMap` *根本不安全*。假设两个线程每个都需要同时扩展内部表……即使它们使用不同的键，这也是一个根本性的问题。

现在，如果您确实*有*充分的证据表明`ConcurrentHashMap`在应用程序生命周期的其余时间使用 a 会导致问题（我非常怀疑它确实如此），您也许可以构建一个并发哈希映射开始，将其转换为`HashMap`(甚至是来自[Guava](http://guava-libraries.googlecode.com)的不可变集合）在单个线程中，确保“最终地图已发布”和“线程读取最终地图”之间存在发生前的障碍。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T14:24:43.357

如果你有跨线程的独立键，你可以考虑独立映射。如果这是一个选项，每个线程都可以有自己的 HashMap，只要它只被一个线程使用，它就不需要是线程安全的。