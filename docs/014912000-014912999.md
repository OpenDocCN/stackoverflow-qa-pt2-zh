# StackOverflow 问答 14912000-14912999

# exception - 编译后有无异常的优化——结果会一样吗？

> ID：14912001
> 
> 赞同：1
> 
> 时间：2013-02-16T15:40:14.580
> 
> 标签：exception, optimization, compiler-construction, compilation, programming-languages

1.  给定一个程序，它的功能使用异常：如果我们一次运行该程序进行优化，然后再运行它而不进行优化 - 两次执行的输出是否相同？

2.  给定同一个程序，它的功能不使用异常——如果我们一次运行优化的程序，然后不优化运行它——两次执行的输出是否相同？

这两个问题都来自几天前的一次采访......

我认为第一个问题的答案是否定的——因为当一些代码行抛出异常时，范围是动态的，优化可能会改变程序的执行顺序。因此，两个不同执行的输出（一个有优化和没有优化）可能不同......

这个对吗 ？

那`2nd`问题呢？

非常感激 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T15:51:12.630

优化不应该改变可观察的行为。一般来说，这两个问题的答案都是肯定的。你没有提到语言。对于 C++，在很多情况下行为是未定义的，如果是这种情况，您可能会看到差异。

你写：

> 优化可能会改变程序的执行顺序。

虽然这是真的，但在某种程度上，C++ 具有限制重新排序的检查点的概念。

# javascript - Catch multiple onkeyup events from same text input

> ID：14912005
> 
> 赞同：0
> 
> 时间：2013-02-16T15:40:39.370
> 
> 标签：javascript, jquery, jquery-events, onkeyup

I'm creating some logic for dom scripting and end up finding the problem where I needed to execute multiple methods when pressing a key. It seems the last `onkeyup` defined is the one which executes, here's some code:

**First method:**

```
...var elements=$$('[id^='+table+']&[id$='+tableField+']');

elements.each(function filter(item) {

    //for each item 
    item.onkeyup = function() { ... 
```

**Second method:**

```
...//for each referenced input    
for(var i=0, fields=htmlFieldElems.length;i<fields;i++){

   //set keyup event for involved fiels in the expression
   $(htmlFieldElems[i]).onkeyup = function() {... 
```

It might happen that the input element might be the same in both methods and both need to execute when something changes... so what's the best way to deal with this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T15:48:38.540

This is what I follow using jQuery. Here is an [example](http://jsfiddle.net/HyMPY/)

```
$('#element').bind('customE',function(){
   // do some stuff
});

$('#element').bind('customE',function(){
   // do some other interesting stuff else use one event handler :-)
});

$('#element').bind('customE',function(){
   // still another
});

$('#element').on('keyup',function(){
    $('#element').trigger('customE');   
}); 
```

Hope this helps.. even other answer posted would help.. But this will be easy to maintain :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T15:44:36.737

in pure javascript, you can just call multiple methods from your onkeyup event handler, like this ...

```
item.onkeyup = function() {
    func1();
    func2();
    funcn();
} 
```

if you are using a framework such as jQuery, you can just keep adding events, like this:

```
$('#item').keyup(func1);
$('#item').keyup(func2);
$('#item').keyup(funcn); 
```

Prototype:

```
$('foo').observe('keyup', function(event) {
    func1();
    func2();
    funcn();
}); 
```

# c# - 如何在 XNA 框架的 XML 中包含 Vector2 列表作为属性

> ID：14912006
> 
> 赞同：1
> 
> 时间：2013-02-16T15:40:40.003
> 
> 标签：c#, xml, arrays, xna

我有一个类，我想用它来将数据导入到我用 XNA 创建的游戏中。它的基础是，我环顾四周并尝试了一些东西，但我无法正确编译：

```
<?xml version="1.0" encoding="utf-8" ?>
<XnaContent>
  <Asset Type="MyGameData.LevelXMLData">
  <LevelID>1</LevelID>
  <Path>
    <Item>1379 541</Item>
    <Item>1370 445</Item>
    <Item>1340 348</Item>
    <Item>1294 253</Item>
    <Item>1217 148</Item>
    <Item>1139 106</Item>
    <Item>1077 148</Item>
    <Item>1046 201</Item>
    <Item>1004 479</Item>
    <Item>999 633</Item>
    <Item>961 816</Item>
    <Item>917 918</Item>
    <Item>850 964</Item>
    <Item>824 939</Item>
    <Item>770 837</Item>
    <Item>738 673</Item>
    <Item>725 526</Item>
    <Item>549 520</Item>
  </Path>
  <WaveIDs>
    <Item>Wave1</Item>
    <Item>Wave2</Item>
    <Item>Wave3</Item>
  </WaveIDs>
  <WaveInterval>120000</WaveInterval>
  <TowerBuildSpots>
    <Item>1277 417 50 50</Item>
    <Item>1094 232 50 50</Item>
    <Item>956 207 50 50</Item>
    <Item>931 326 50 50</Item>
    <Item>1069 442 50 50</Item>
    <Item>906 566 50 50</Item>
    <Item>1056 589 50 50</Item>
    <Item>1031 722 50 50</Item>
    <Item>981 867 50 50</Item>
    <Item>824 854 50 50</Item>
    <Item>641 747 50 50</Item>
    <Item>774 639 50 50</Item>
    <Item>641 566 50 50</Item>
    <Item>691 442 50 50</Item>
  </TowerBuildSpots>
  </Asset>
</XnaContent> 
```

“Path”是一个 Vector2s 数组，“TowerBuildSpots”是一个 Rectangles 数组

```
Public Vector2[] Path;
Public Rectangle[] TowerBuildSpots; 
```

我遵循了我在集合中看到的其他人的代码示例，并在我的 Path 标签中使用了标签，但是每当我尝试编译我的代码时，我都会收到以下错误

```
Error   1   There was an error while deserializing intermediate XML. 'Element' is an invalid XmlNodeType. Line 6, position 6. 
```

此行是文件中的第一行。

任何人都可以请添加任何对此问题的见解吗？这会有很大帮助。谢谢！

阿拉斯代尔

编辑：我的反序列化代码在这里：

```
 public static LevelInfo Load(LevelXMLData data, ContentManager content)
    {
        int levelID = data.LevelID;

        string levelLocation = "Levels\\Level" + levelID + "\\";

        Waypoint[] path = new Waypoint[data.Path.Count()];
        WaveOfEnemies[] waves = new WaveOfEnemies[data.WaveIDs.Count()];

        TextureManager[] images = LevelImageInfo.Load(content.Load<LevelImageXMLData[]>(levelLocation + "ImageData"), content);

        // load waypoints
        for (int i = 0; i <= data.Path.Count() - 1; i++)
        {
            path[i] = new Waypoint(data.Path[i]);
        }

        for (int i = 0; i <= data.WaveIDs.Count() - 1; i++)
        {
            waves[i] = LoadWave(content.Load<WaveXMLData>(levelLocation + "Waves\\" + data.WaveIDs[i]));
        }

        return new LevelInfo(levelID, images, path, waves, data.WaveInterval, data.TowerBuildSpots);
    } 
```

我的 LevelXMLData 结构在这里：

```
public struct LevelXMLData
{
    [ContentSerializer]
    public int LevelID;
    [ContentSerializer]
    public Vector2[] Path; 
    [ContentSerializer]
    public string[] WaveIDs;
    [ContentSerializer]
    public int WaveInterval;
    [ContentSerializer]
    public Rectangle[] TowerBuildSpots;
} 
```

# haskell - haskell 中的惰性 IO：如何返回由某些阻塞 IO 生成的惰性列表？

> ID：14912007
> 
> 赞同：3
> 
> 时间：2013-02-16T15:40:42.477
> 
> 标签：haskell, lazy-evaluation

```
getText = do
    c <- getChar
    s <- getText
    return (c : s)

main = do
    s <- getText
    putStr s 
```

我希望看到的是每次按“Enter”后都会回显输入行。但是没有任何回应......（我知道这是一个无限循环）它似乎不会“ `return`”，直到它上面的所有“IO”都被执行。...

但是，以下代码：

```
main = do
    s <- getContents
    putStr s 
```

它在输入后立即显示该行。

给定函数`getChar`，我可以写一个`getText`行为像`getContents`吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-16T15:52:30.543

这是一项工作...... [`unsafeInterleaveIO`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/System-IO-Unsafe.html#v%3aunsafeInterleaveIO)- 使惰性 IO 成为可能的特殊操作。它使您可以将 IO 操作转换为绑定到 thunk 的操作。然后可以将其存储在结构中，并且该操作仅在需要其结果时才进行评估。

```
getText = unsafeInterleaveIO $ do
    c <- getChar
    s <- getText
    return (c : s) 
```

现在，您`getText`只需为每个 getChar 暂停计算即可立即返回。如果您需要结果，则运行它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-16T15:51:56.077

这可以通过`unsafeInterleaveIO`函数 from 来完成`System.IO.Unsafe`。然后你的`getText`功能变成

```
getText = do
    c <- getChar
    s <- unsafeInterleaveIO $ getText
    return (c : s) 
```

稍微抽象一下，我们可以得到一个函数来泛化这种行为

```
lazyDoIO :: IO a -> IO [a]
lazyDoIO act = unsafeInterleaveIO $ do
    now <- act
    rest <- lazyDoIO act
    return (now : rest)

getText = lazyDoIO getChar 
```

然而，大多数 Haskellers 会在这样做时畏缩。如果您想对生成的数据进行增量流处理，使用类似or`IO`的库会更安全。`Pipes``Conduits`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T16:03:13.857

您谈论 Enter 但您没有在代码中检查它。

试试这个：

```
getText = do
    c <- getChar
    if (c == '\n')
       then return [c]
       else do
              s <- getText
              return (c : s)

main = do
    s <- getText
    putStr s 
```

# asp.net-mvc-4 - WepApi 控制器是否应该返回视图模型

> ID：14912011
> 
> 赞同：6
> 
> 时间：2013-02-16T15:41:00.563
> 
> 标签：asp.net-mvc-4, asp.net-web-api

WebApi 非常适合使用带有 KnockoutJS 的 javascript ViewModel 的单页应用程序。

我的 WebApi 是否应该返回 ac# ViewModel，然后将其转换为 Json ViewModel。

或者我的 WebApi 控制器是否应该返回一个业务对象并创建一个 javascript 视图模型？

我从未在任何 WebApi 教程中看到过第一个，我想知道为什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-16T15:41:54.917

> 我的 WebApi 是否应该返回 ac# ViewModel，然后将其转换为 Json ViewModel

是的，一点没错。这样，您就可以完全控制发送给客户端的内容。此外，如果您决定在新版本的 API 中更改底层业务模型，例如，您不会破坏现有客户端。您需要做的就是调整业务模型和视图模型之间的映射。

> 或者我的 WebApi 控制器是否应该返回一个业务对象并创建一个 javascript 视图模型？

不，从未将您的商业模式发送给客户。您应该始终使用视图模型。

> 我从未在任何 WebApi 教程中看到过第一个，我想知道为什么。

我也从未在任何 ASP.NET MVC 教程中看到过第一个，我也想知道为什么。可能是因为这些教程没有涵盖现实世界的应用场景，而是代表了过于简化的示例，这些示例可以让您开始使用某些技术。不幸的是，很多人在学习这些教程时没有意识到在现实世界的应用程序中使用视图模型的重要性。StackOverflow 是一个很好的地方，可以查看有多少人实际上没有意识到视图模型的重要性。

# java - LWJGL/OpenGL：使用 VBO 和 VAO 处理具有动态 LOD 的动态体素地形

> ID：14912012
> 
> 赞同：0
> 
> 时间：2013-02-16T15:41:08.390
> 
> 标签：java, opengl, 3d, buffer, lwjgl

编辑：

我有不断变化的细节水平的块。每当一个块的细节级别发生变化时，我必须重新计算要绘制的顶点。因此，顶点的数量会动态变化。

我的问题是，我不知道如何才能画出这个。我以为我可以删除旧缓冲区，然后重新加载新缓冲区。每隔几秒钟删除和重新加载缓冲区是有效的还是只是一个坏主意？有没有更好的方法来做到这一点？

以下是我的想法：

```
//delete old buffers
    GL20.glDisableVertexAttribArray(0);

    GL15.glBindBuffer(GL15.GL_ARRAY_BUFFER, 0);
    GL15.glDeleteBuffers(vboID);

    GL15.glBindBuffer(GL15.GL_ELEMENT_ARRAY_BUFFER, 0);
    GL15.glDeleteBuffers(vboiID);

    GL30.glBindVertexArray(0);
    GL30.glDeleteVertexArrays(vaoID);

//reload buffers with new vertex data
    vaoID = GL30.glGenVertexArrays();
    GL30.glBindVertexArray(vaoID);

    vboID = GL15.glGenBuffers();
    GL15.glBindBuffer(GL15.GL_ARRAY_BUFFER, vboID);
    GL15.glBufferData(GL15.GL_ARRAY_BUFFER, vertex_buffer, GL15.GL_DYNAMIC_DRAW);
    GL20.glVertexAttribPointer(0, 3, GL_FLOAT, false, 0, 0);
    GL15.glBindBuffer(GL15.GL_ARRAY_BUFFER, 0);

    vboiID = GL15.glGenBuffers();
    GL15.glBindBuffer(GL15.GL_ELEMENT_ARRAY_BUFFER, vboiID);
    GL15.glBufferData(GL15.GL_ELEMENT_ARRAY_BUFFER, index_buffer, GL15.GL_DYNAMIC_DRAW);
    GL15.glBindBuffer(GL15.GL_ELEMENT_ARRAY_BUFFER, 0);

    GL30.glBindVertexArray(0); 
```

不过，必须有比这更好的方法来做到这一点......我可能只是像往常一样错过了一些关键概念，所以请让我知道我是否只是一个试图这样做的彻头彻尾的白痴。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T07:13:46.460

尝试使用 glBufferSubData()，它一定是你需要的。

# javascript - 计算函数执行了多少次

> ID：14912017
> 
> 赞同：1
> 
> 时间：2013-02-16T15:41:49.427
> 
> 标签：javascript, css, animation

我有一个背景上有图片的网站，我愿意让它从右到左移动，我不想使用 jQuery，所以这是我的代码，它可以让它做那个移动

**HTML 代码**

```
<div id="clouds_image"></div> 
```

**Javascript代码**

```
var g = 0;
var speed=80;
var counter = 5;
function rollClouds() 
{
    document.getElementById('clouds_image').style.backgroundPosition=g+'px 0';
    g--;
    if (counter < 1) 
        clearInterval(interval);
}

interval = setInterval( function(){ rollClouds() }, speed) 
```

**这应该**使图像从右向左移动并重复其移动5次并从5倒数到0然后`counter < 1`它将执行`clearInterval(interval)`以停止它。

**但**我不知道为什么它不停地重复！所以代码可能有错误，所以知道如何在重复移动 5 次后让它停止。~ 谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T15:44:07.420

您似乎没有递减计数器，因为您的代码暗示您打算这样做：

```
counter--; 
```

这是完整的功能：

```
function rollClouds() 
{
    // decrement (decrease) the counter otherwise it's never less than 1

    document.getElementById('clouds_image').style.backgroundPosition=g+'px 0';
    g--;
    if (counter < 1) {
        clearInterval(interval);
    }
    counter--;
} 
```

# php - php 日期到 mysql 日期

> ID：14912018
> 
> 赞同：-1
> 
> 时间：2013-02-16T15:41:54.200
> 
> 标签：php, mysql, date

为什么mysql日期字段没有被更新？

```
$st =   $this->db->prepare("update users set ipaddress=? and 
lastlogin=? where     email=?"); 
$mysqldate  =   date('Y-m-d');                          
$st->execute(array($ip_address, $mysqldate, $email)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T15:44:12.507

在更新的情况下尝试不使用不正确的“and”：

```
$st =   $this->db->prepare("update users set ipaddress=?, lastlogin=? where     email=?"); 
```

见这里：[http ://dev.mysql.com/doc/refman/5.1/en/update.html](http://dev.mysql.com/doc/refman/5.1/en/update.html)

除此之外，您可以使用 mysql 时间函数，例如**CURDATE()**来实现您的结果：[https ://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html# function_curdate](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_curdate)

# java - “类型的非法开始”和“预期的类、接口或枚举”

> ID：14912025
> 
> 赞同：-2
> 
> 时间：2013-02-16T15:42:35.550
> 
> 标签：java

当我编译以下java代码时，它会抛出`illegal start of type`&`class, interface or enum expected`错误。

在以下代码的 Percolation 类中，声明了属于另一个类的 WeightedQuickUnionUF 数据类型。WeightedQuickUnionUF 类存储在当前工作目录内名为“algs4.jar”的 jar 文件中。

我已经检查了几次代码，但无法找出缺陷并完全卡住。

代码如下：

```
public class Percolation{
    public static Percolation(int n){
        boolean[][] A=new boolean[n][n];
    }
    int i,j;
    WeightedQuickUnionUF WQUF=new WeightedQuickUnionUF[n*n+2];
    for(i=1;i&lt;=n;i++)
    {
        WQUF.union(0,i);
    }
    for (i=n*n-n+1;i&lt;=n*n;i++)
    {
        WQUF.union(n*n+1,i);
    }
    do {
        i=StdRandom.uniform(n-1)+1;
        j=StdRandom.uniform(n-1)+1;
    } while(A[i][j]!=0)
    open(i,j);
    private static int xyto1D(int x,int y){
        return (n*x+y);
    }
    public static void open(int i,int j){
        A[i][j]=1;
        if(A[i-1][j]==1) {WQUF.union(xyto1D(i-1,j),xyto1D(i,j))};
        if(A[i+1][j]==1) {WQUF.union(xyto1D(i+1,j),xyto1D(i,j))};
        if(A[i][j-1]==1) {WQUF.union(xyto1D(i,j-1),xyto1D(i,j))};
        if(A[i][j+1]==1) {WQUF.union(xyto1D(i,j+1),xyto1D(i,j))};
    }
    public static boolean isOpen(int x,int y){
        return (A[x][y]==1);
    }
    public static boolean isFull(int x,int y){
        return (WQUF.connected(xyto1D(x,y),0));
    }
    public static boolean percolates(){
        for (i=n*n-n+1;i&lt;=n*n;i++)
        {
            if ((isFull(i))&&(isOpen(i))) return TRUE;
        }
        return FALSE;
    }
} 
```

在编译过程中出现以下错误：

```
35 errors found:

File: C:\Users\Administrator\algs4\Percolation.java  
[line: 7]
Error: illegal start of type
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 7]
Error: <identifier> expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 7]
Error: ';' expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 7]
Error: <identifier> expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 7]
Error: <identifier> expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 7]
Error: <identifier> expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 7]
Error: illegal start of type
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 7]
Error: <identifier> expected
File: C:\Users\Administrator\algs4\Percolati
on.java  
[line: 8]
Error: ';' expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 9]
Error: illegal start of type
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 9]
Error: illegal start of type
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 9]
Error: <identifier> expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 11]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 11]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 11]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 14]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 17]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 18]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 20]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 22]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 23]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 25]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 26]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 27]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 28]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 29]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 30]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 32]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 33]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 35]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 36]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 37]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 37]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 40]
Error: class, interface, or enum expected
File: C:\Users\Administrator\algs4\Percolation.java  
[line: 42]
Error: class, interface, or enum expected 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T15:44:23.747

你在第四行关闭了构造函数，每个错误都是这个的结果。

```
 public static Percolation(int n){
        boolean[][] A=new boolean[n][n];
    } // <<--- here 
```

请处理您的缩进。如果我没记错的话，eclipse 和 netbeans 都有某种自动缩进。通过适当的缩进，您很容易自己抓住它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T15:46:27.573

问题也在这里：（除了许多其他语法错误外，您逐行调试，以便您了解您在哪里以及所有违反 Java 语法规则的地方）

```
WeightedQuickUnionUF WQUF=new WeightedQuickUnionUF[n*n+2]; 
```

您应该将其更改为：

```
WeightedQuickUnionUF WQUF=new WeightedQuickUnionUF(n*n+2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T15:47:12.457

```
 do {
i=StdRandom.uniform(n-1)+1;
j=StdRandom.uniform(n-1)+1;
} while(A[i][j]!=0) 
```

您需要将分号放在 while 语句的末尾。

```
do {
i=StdRandom.uniform(n-1)+1;
j=StdRandom.uniform(n-1)+1;
} while(A[i][j]!=0); 
```

代码似乎有很多问题。我建议您使用 Eclipse IDE。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-16T15:47:42.210

在 Java 中，每个可执行代码（初始化除外）都需要放在一个块（静态或函数）中。

但是，在您文件的第 7 行，您`for`在类的主体中有一个循环，这是无效的。请把它放在构造函数或其他函数中。

实际上，您发布的代码还有一个问题。您已经声明了不允许的构造函数静态。构造函数不能是静态的。

```
public static Percolation(int n) {  // illegal
boolean[][] A = new boolean[n][n];
} 
```

假设从第 7 行开始的代码是构造函数的一部分，这里是应该可以工作的代码

```
public class Percolation {
    public Percolation(int n) {
    boolean[][] A = new boolean[n][n];

        int i, j;
        WeightedQuickUnionUF WQUF = new WeightedQuickUnionUF[n * n + 2];

        for(i=1;i<=n;i++){
           WQUF.union(0,i);
        }

        for (i=n*n-n+1;i<=n*n;i++){
            WQUF.union(n*n+1,i);
        }

        do{
            i=StdRandom.uniform(n-1)+1;
            j=StdRandom.uniform(n-1)+1;
        } while(A[i][j]!=0); //add this semicolon as well.

        open(i,j);
    }

    private static int xyto1D(int x, int y) {
    return (n * x + y);
    }

    public static void open(int i,int j){
        A[i][j]=1;
        if(A[i-1][j]==1) {WQUF.union(xyto1D(i-1,j),xyto1D(i,j))};
         if(A[i+1][j]==1) {WQUF.union(xyto1D(i+1,j),xyto1D(i,j))};
          if(A[i][j-1]==1) {WQUF.union(xyto1D(i,j-1),xyto1D(i,j))};
           if(A[i][j+1]==1) {WQUF.union(xyto1D(i,j+1),xyto1D(i,j))};
    }

    public static boolean isOpen(int x, int y) {
    return (A[x][y] == 1);
    }

    public static boolean isFull(int x, int y) {
    return (WQUF.connected(xyto1D(x, y), 0));
    }

    public static boolean percolates() {
    for (i = n * n - n + 1; i <= n * n; i++) {
        if ((isFull(i)) && (isOpen(i)))
        return TRUE;
    }
    return FALSE;
    }
} 
```

# android - 安卓语音识别解锁手机

> ID：14912029
> 
> 赞同：0
> 
> 时间：2013-02-16T15:43:04.903
> 
> 标签：android, eclipse-adt

出于安全目的，我正在做关于 android 语音识别的项目。手机用户应该能够用他/她的声音解锁手机。我需要一些帮助。用户需要先将语音样本保存在设备中，以便下次他/她想解锁，它会提示他们的语音i/p。还有一件事是应用程序应该在用户重启手机后初始化。首先是否可能？到目前为止，我已经使用（TTS（文本到语音））完成了语音识别，它给了你你所说的提示。我的意思是我们可以编辑安卓锁屏吗？需要帮助！！谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-11T23:24:40.870

这个应用程序已经解决了您的问题：https: [//play.google.com/store/apps/details?id=com.mah.voicepassword](https://play.google.com/store/apps/details?id=com.mah.voicepassword)询问它的作者。

# android - 在android中的编辑文本下获取先前输入的字符串列表“就像某些电子邮件/网站的用户名字段”

> ID：14912030
> 
> 赞同：0
> 
> 时间：2013-02-16T15:43:06.423
> 
> 标签：android, android-listview, android-view, textview

我想要一些方向。我对它的了解不是很清楚。所以，请...

1.  这是我的 xml 格式的编辑文本：

    ```
     <EditText 
        android:id="@+id/editTextName"
        android:layout_height="wrap_content" 
        android:layout_width="fill_parent" 
        android:layout_margin="3dp" 
        android:hint="Insert Name"  
        android:onClick="surNameEditTextClick" /> 
    ```

2.  获取编辑文本的输入字符串的代码：

    ```
    EditText nameText = (EditText) findViewById(R.id.editTextName);
    String name = nameText.getText().toString(); 
    ```

3.  将名称字符串保存到字符串的数组列表中：

    ```
    ArrayList<String> nameArrayList = new ArrayList<String> ; //created globally 
    if(!(nameArrayList.contains(name))){

        //Adding input string into the name array-list
        nameArrayList.add(name) ;
    } 
    ```

4.  将此数组列表放入共享首选项中：

    ```
    SharedPreferences saveGlobalVariables = getSharedPreferences(APP_NAME, 0);
    SharedPreferences.Editor editor = saveGlobalVariables.edit();
    editor.putStringSet("name", new HashSet<String>(surNameArrayList));
    editor.commit(); 
    ```

5.  程序加载时（在 onCreate() 中）将所有 Shared-Preferences 数据返回到数组列表：

    ```
    SharedPreferences loadGlobalVariables = getSharedPreferences(APP_NAME, 0);
    nameArrayList = new ArrayList<String>(loadGlobalVariables.getStringSet("name", new HashSet<String>())); 
    ```

现在如何在该编辑文本下以某种视图形式获取这些数据。我见过不同的方法，但没有清楚地理解。如果我使用

```
EditText mNameEditText;
mNameEditText = (EditText)findViewById(R.id.editTextName);
mNameEditText.addTextChangedListener(new TextWatcher() {
public void afterTextChanged(Editable s){

}

public void beforeTextChanged(CharSequence s, int start, int count, int after){

}

public void onTextChanged(CharSequence s, int start, int before, int count){

} 
```

});

那么这里将使用什么代码片段呢？应该使用哪个 textView 或 list-view 以及在哪里使用？？？我无法理解。如果有其他方法可用，请在此处提供。问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T15:51:14.387

你是那里的大部分。我建议使用[AutoCompleteTextView](https://developer.android.com/reference/android/widget/AutoCompleteTextView.html)并将您的列表绑定到 ArrayAdapter。（AutoCompleteTextView 已经具有帮助用户在相似条目之间进行选择的下拉功能，并且不需要 TextWatcher。）

文档中的代码：

```
 public class CountriesActivity extends Activity {
     protected void onCreate(Bundle icicle) {
         super.onCreate(icicle);
         setContentView(R.layout.countries);

         ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
                 android.R.layout.simple_dropdown_item_1line, COUNTRIES);
         AutoCompleteTextView textView = (AutoCompleteTextView)
                 findViewById(R.id.countries_list);
         textView.setAdapter(adapter);
     }

     private static final String[] COUNTRIES = new String[] {
         "Belgium", "France", "Italy", "Germany", "Spain"
     };
 } 
```

（您可以以与上述原始 Array 相同的方式使用 ArrayList。）

# git - 无法克隆 git 存储库

> ID：14912033
> 
> 赞同：1
> 
> 时间：2013-02-16T15:43:43.983
> 
> 标签：git

我的系统是 Windows 7。我下载了 git 和 Tortoise git。我知道如何使用 git 本身，但不知道如何设置它。我通过电子邮件收到了存储库信息，在那里我通过 ssh 协议找到了 git 存储库的 url，并且还有一个包含 rsa 密钥的文本文件。当我尝试将远程存储库克隆到本地文件夹时，它会要求输入密码。但是给我这个信息的人没有给我密码。

我该怎么办？向他们询问密码，或者可能有办法从 txt 文件中的这个密钥生成密码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T15:46:16.670

它要求输入密码，因为它找不到私钥。检查您是否将私钥复制到了设置中的正确位置。一旦 git 找到私钥，它将执行公钥认证（而不是密码认证），并且不会询问密码。

# java - 为我在 WSDL 中的工作生成 web 服务

> ID：14912036
> 
> 赞同：0
> 
> 时间：2013-02-16T15:44:01.417
> 
> 标签：java, web-services, jsp, servlets, wsdl

我要生成的webservice是WSDL。我在 JSP 和 servlet 中创建了 web 服务。因此，当我搜索 Web 服务时，要由 servlet 处理的请求和 servlet 应该搜索 WSDL 以获取我在项目中描述的可用服务。

例如

JSP：展示轿车类别中最好的汽车

SERVLET：获取参数：请求：

在这里，我想为 3 家汽车公司创建 WSDl。在那个公司的 WSDL 文件中，我必须创建规范和方法来给出结果。

像 COMPANY 1 WSDL: SEDAN,SUV,MUV

公司 2 WSDL: SEDAN,SUV,MUV

公司 3 WSDL: SEDAN,SUV,MUV

但是我搜索了很多并获得了很多教程来为 web 服务和客户端创建生成 wsdl 文件创建。而且它只展示了如何测试客户端和 web 服务。现在我的问题是如何生成与我的需要相关的 wsdl。

如何为 3 家汽车公司创建 WSDL 网络服务？

如何使用 servlet 调用这些 web 服务？

我需要一些好主意如何开始。

谢谢

阿米尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:25:38.700

可以通过以下几种方式创建 Web 服务：

1) 自上而下的方法（我们将在其中创建 WSDL 文件，然后生成 java 文件。不适合您，因为您似乎是这方面的初学者）

2) 自底向上方法（您将创建一个简单的动态 Web 应用程序并编写所有 Java 代码。然后使用 New -> Web-service 选项（在 Eclipse IDE 中），您将生成 WSDL。这种方法是首选初学者）

创建 WSDL 后，您可以在项目中使用它。

请指定您尝试创建的 Web 服务的类型以及您用于创建 Web 服务的工具/IDE。WSDL 文件的生成因一种工具/IDE 而异。

问候，

# javascript - Javascript 过渡

> ID：14912040
> 
> 赞同：0
> 
> 时间：2013-02-16T15:44:20.627
> 
> 标签：javascript, html, css

我编写了一个 javascript 代码，将视口从一个链接滑到另一个链接。基本上一切都很好，你可以在那里看到[http://jsfiddle.net/DruwJ/8/](http://jsfiddle.net/DruwJ/8/)

我现在的问题是我想在链接时停止视口幻灯片

```
<input id="bottom" type="button" value="Midlle" onclick="smoothScrollTo(0, 500)"> 
```

位于视口的底部，而不是顶部。

我希望有人知道解决方案！（我是 javascript 的初学者）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:19:59.703

如果没有 jQuery，我能做的最好的事情是：

```
onclick="smoothScrollTo(document.getElementById('bottom').offsetTop + 30 - window.innerHeight)" 
```

我假设您希望按钮的底部与页面底部对齐。而不是按钮的顶部与页面底部对齐。

这里的关键点是减去 window.innerHeight 以使按钮位于底部。我添加 30 作为按钮高度的近似值。不幸的是，我不熟悉如何在没有 jQuery 帮助的情况下获取按钮的高度。我建议在您的项目中使用 jQuery，以使所有 DOM 操作更加稳定和友好。

或者，您可以在按钮正下方添加一些虚拟 div/元素，并让系统滚动到该按钮。

```
onclick="smoothScrollTo(document.getElementById('dummy').offsetTop - window.innerHeight)" 
```

见：http: [//jsfiddle.net/DruwJ/10/](http://jsfiddle.net/DruwJ/10/)

# php - XMPP 和 Strophe

> ID：14912042
> 
> 赞同：2
> 
> 时间：2013-02-16T15:44:29.380
> 
> 标签：php, xmpp, ejabberd, strophe

我想通过 Strophe 连接到 xmmp，我已经配置了任何东西

我在我的系统上使用 WAMP 来运行 localhost php

我在 openfire admin 中启用了脚本语法

我已将 APACHE httpd.conf 配置为

```
# XMPP proxy rule
ProxyRequests Off
ProxyPass /xmpp-httpbind http://127.0.0.1:7070/http-bind/
ProxyPassReverse /xmpp-httpbind http://127.0.0.1:7070/http-bind 
```

我也使用基本的 javascript 文件连接到服务器，所以代码在这里

```
var BOSH_SERVICE = '/xmpp-httpbind'
var connection = null;

function log(msg) 
{
    $('#log').append('<div></div>').append(document.createTextNode(msg));
}

function rawInput(data)
{
    log('RECV: ' + data);
}

function rawOutput(data)
{
    log('SENT: ' + data);
}

function onConnect(status)
{
    if (status == Strophe.Status.CONNECTING) {
    log('Strophe is connecting.');
    } else if (status == Strophe.Status.CONNFAIL) {
    log('Strophe failed to connect.');
    $('#connect').get(0).value = 'connect';
    } else if (status == Strophe.Status.DISCONNECTING) {
    log('Strophe is disconnecting.');
    } else if (status == Strophe.Status.DISCONNECTED) {
    log('Strophe is disconnected.');
    $('#connect').get(0).value = 'connect';
    } else if (status == Strophe.Status.CONNECTED) {
    log('Strophe is connected.');
    connection.disconnect();
    }
}

$(document).ready(function () {
    connection = new Strophe.Connection(BOSH_SERVICE);
    connection.rawInput = rawInput;
    connection.rawOutput = rawOutput;

    $('#connect').bind('click', function () {
    var button = $('#connect').get(0);
    if (button.value == 'connect') {
        button.value = 'disconnect';

        connection.connect($('#jid').get(0).value,
                   $('#pass').get(0).value,
                   onConnect);
    } else {
        button.value = 'connect';
        connection.disconnect();
    }
    });
}); 
```

当我想与 "admin@127.0.0.1" 连接时，我会进行 AUTHFAIL ，即使在使用 "admin" 之后，我也会收到以下响应：

JID: 密码:

```
Strophe is connecting.
SENT: <body rid='1613006691' xmlns='http://jabber.org/protocol/httpbind' to='admin' xml:lang='en' wait='60' hold='1' content='text/xml; charset=utf-8' ver='1.6' xmpp:version='1.0' xmlns:xmpp='urn:xmpp:xbosh'/>
RECV: <body xmlns='http://jabber.org/protocol/httpbind' xmlns:stream='http://etherx.jabber.org/streams' authid='2ff1799d' sid='2ff1799d' secure='true' requests='2' inactivity='30' polling='5' wait='60' hold='1' ack='1613006691' maxpause='300' ver='1.6'><stream:features><mechanisms xmlns='urn:ietf:params:xml:ns:xmpp-sasl'><mechanism>DIGEST-MD5</mechanism><mechanism>PLAIN</mechanism><mechanism>ANONYMOUS</mechanism><mechanism>CRAM-MD5</mechanism></mechanisms><compression xmlns='http://jabber.org/features/compress'><method>zlib</method></compression><bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'/><session xmlns='urn:ietf:params:xml:ns:xmpp-session'/></stream:features></body>
SENT: <body rid='1613006692' xmlns='http://jabber.org/protocol/httpbind' sid='2ff1799d'><auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='ANONYMOUS'/></body>
RECV: <body xmlns='http://jabber.org/protocol/httpbind'><success xmlns='urn:ietf:params:xml:ns:xmpp-sasl'/></body>
SENT: <body rid='1613006693' xmlns='http://jabber.org/protocol/httpbind' sid='2ff1799d' to='admin' xml:lang='en' xmpp:restart='true' xmlns:xmpp='urn:xmpp:xbosh'/>
RECV: <body xmlns='http://jabber.org/protocol/httpbind' xmlns:stream='http://etherx.jabber.org/streams'><stream:features><compression xmlns='http://jabber.org/features/compress'><method>zlib</method></compression><bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'/><session xmlns='urn:ietf:params:xml:ns:xmpp-session'/></stream:features></body>
SENT: <body rid='1613006694' xmlns='http://jabber.org/protocol/httpbind' sid='2ff1799d'><iq type='set' id='_bind_auth_2' xmlns='jabber:client'><bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'/></iq></body>
RECV: <body xmlns='http://jabber.org/protocol/httpbind'><iq xmlns='jabber:client' type='result' id='_bind_auth_2' to='pedram-pc/2ff1799d'><bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'><jid>2ff1799d@pedram-pc/2ff1799d</jid></bind></iq></body>
SENT: <body rid='1613006695' xmlns='http://jabber.org/protocol/httpbind' sid='2ff1799d'><iq type='set' id='_session_auth_2' xmlns='jabber:client'><session xmlns='urn:ietf:params:xml:ns:xmpp-session'/></iq></body>
RECV: <body xmlns='http://jabber.org/protocol/httpbind'><iq xmlns='jabber:client' type='result' id='_session_auth_2' to='2ff1799d@pedram-pc/2ff1799d'/></body>
Strophe is connected.
Strophe is disconnecting.
SENT: <body rid='1613006696' xmlns='http://jabber.org/protocol/httpbind' sid='2ff1799d' type='terminate'><presence xmlns='jabber:client' type='unavailable'/></body>
RECV: <body xmlns='http://jabber.org/protocol/httpbind'/>
Strophe is disconnected. 
```

我的问题在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T17:49:30.260

您的日志显示：

```
Strophe is connected.
Strophe is disconnecting. 
```

你的代码说：

```
} else if (status == Strophe.Status.CONNECTED) {
log('Strophe is connected.');
connection.disconnect();
} 
```

所以......看起来一切都配置得很好，一旦成功连接，您的代码就会立即断开连接......</p>

# algorithm - 评估前缀表达式的算法？

> ID：14912045
> 
> 赞同：0
> 
> 时间：2013-02-16T15:44:41.803
> 
> 标签：algorithm, language-agnostic, prefix, infix-notation, postfix-notation

我有一个前缀表达式，它只有 4 个二元运算符（+、-、*、/）。评估此类表达式的直接方法是将其转换为后缀表达式，然后评估该表达式。但是我正在寻找一种直接执行此操作而不将其转换为任何其他表达式的算法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T17:20:28.687

简单递归：

```
Evaluate(input):
  Read a token from input.
  If the token is a value:
    Return the value of the token
  If the token is a binary operator:
    Let first_argument = Evaluate(input)
    Let second_argument = Evaluate(input)
    Return apply(operator, first_argument, second_argument) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T15:46:35.103

使用堆栈。放置您的变量和运算符并开始弹出每个堆栈，一个用于运算符，另一个用于 varaiablss（弹出的数量取决于 arity）。

# python - 如何创建一个 MxN 的 scipy 矩阵，其中 M 和 N 由用户决定，并且元素一个接一个地输入？

> ID：14912046
> 
> 赞同：1
> 
> 时间：2013-02-16T15:44:44.660
> 
> 标签：python, matrix, numpy, scipy

我想创建一个二维坐标矩阵。我希望用户能够在程序运行时决定行数和列数，以及矩阵的元素。我知道如何使用我在这里完成的数组来做到这一点：

```
F = int(raw_input("Enter expected number of frames: "))
P = int(raw_input("Enter expected points to track object: "))
W = []
for i in xrange (2*F):
 W.append([])
 print "frame number", (i+1)
 for j in xrange (P):
  W[i].append(int(raw_input("Enter the next coordinate: ")))
print W 
```

我的问题是如何使用 scipy（或 numpy）中的矩阵函数来做同样的事情。我想这样做，这样我就可以轻松地执行逆运算并计算 SVD 等。

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:05:16.100

我找到了一种方法。

这是我的做法：

```
import numpy as np

F = int(raw_input("Enter expected number of frames: "))
P = int(raw_input("Enter expected points to track object: "))
W = np.zeros(shape = (2*F, P))

for i in xrange (2*F):
  for j in xrange (P):
    print "Frame: ", (i+1), "Point: ", (j+1)
    W[i][j] = (int(raw_input("Enter the next coordinate: ")))
print W 
```

# jquery - 使用 python 的 Google 应用引擎：提交表单的各种方式

> ID：14912047
> 
> 赞同：0
> 
> 时间：2013-02-16T15:44:48.037
> 
> 标签：jquery, google-app-engine, form-submit

我有一个表格，其中有几种不同的提交方式：

```
<form action="/admin?arg1=memberManage" method="get">
  <input type="text" name="searchString" value="{{searchString}}" />
  <input type="image" name="arg2" value="search" src="search.jpg" />
  ... 
  <a name="arg2" value="orderByName" onClick="form.submit();">Order By Name</a>

  <a name="arg2" value="orderByAccount" onClick="form.submit();">Order By Account</a>

  <a name="arg2" value="orderByLastLogin" onClick="form.submit();">Order By Last Login</a>

 <!-- the followings are search results updated by AJAX -->
 <div id="searchResults">
  ...
  ...
 </div>

</form> 
```

该表单包含一个图像按钮和三个提交链接。以上只是假设。这个想法是提交一个带有不同参数（即arg2）的表单，这样搜索结果的顺序就会不同。搜索字符串也使用模板系统保留。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:45:39.047

听起来您想要三个不同的提交按钮，而不是一个按钮和三个链接。

```
<form action="/admin?arg1=memberManage" method="get">
  <input type="text" name="searchString" value="{{searchString}}" />
  <input type="image" name="order by name" value="search1" src="search1.jpg" />
  <input type="image" name="order by account" value="search2" src="search2.jpg" />
  <input type="image" name="order by last login" value="search3" src="search3.jpg" />
  ...
</form> 
```

然后在服务器上检查提交按钮的名称并提供适当的响应。

# java - 线程“主”com.sun.xml.internal.ws.client.ClientTransportException 中的异常：服务器发送 HTTP 状态代码 502：代理错误

> ID：14912049
> 
> 赞同：0
> 
> 时间：2013-02-16T15:44:52.773
> 
> 标签：java, web-services, wsdl, endpoint

当我对第三方服务器进行 Web 服务调用时，出现以下错误。

线程“主”com.sun.xml.internal.ws.client.ClientTransportException 中的异常：服务器发送 HTTP 状态代码 502：代理错误（连接被拒绝）

我能够通过 SOAP UI 但不能通过代码获得响应。我使用 wsimport 从 WSDL 生成 java 代码。

请帮我解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:39:03.847

“连接被拒绝”意味着客户端试图在一个没有任何监听的地址和端口连接到服务器。想到了几种可能性：

*   您尝试连接的服务未运行。
*   URL 中的主机名错误，因此您连接到错误的主机。
*   URL 中的端口号错误，因此您连接到错误的端口。
*   URL 应该显示“https”时显示“http”，反之亦然。

# php - 如何在中型在线社区中打击垃圾邮件？

> ID：14912054
> 
> 赞同：-1
> 
> 时间：2013-02-16T15:45:11.237
> 
> 标签：php, mysql, security, spam

我经营着一个拥有超过 10,000 名成员的在线社区，并且经常被用户以金钱诈骗的形式向其他成员发送垃圾邮件。它们不是通过机器人发送的，而是由真人发送的，可能坐在国外的网吧里！！

我目前没有采取任何具体措施，并正在尝试制定最佳措施组合来成功应对这一问题，因为我知道我的竞争对手遇到了问题，我需要利用这一点作为差异化点。

目前的想法包括：

*   限制新成员的消息
*   报告会员功能.... 3 报告 = 自动帐户停用（但这不会立即阻止垃圾邮件发送者，他们可以在几分钟内向数百个帐户发送垃圾邮件）
*   某种在垃圾邮件发送者中寻找重复主题的正则表达式

不知道还有什么，任何想法和建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T18:12:38.413

强制性流行文化参考：

[![而那些无法加入社区的人呢，因为他们不善于建立有益和建设性的合作——……哦。](../Images/40eb147d890c2c6421e9105812255ea7.png)](http://xkcd.com/810/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T15:49:37.550

莫勒姆？“Mollom 是一种网络服务，可以分析发布到网站的内容的质量。这包括评论、联系表单消息、博客、论坛帖子等。”

[http://mollom.com/](http://mollom.com/)

他们在[http://mollom.com/download](http://mollom.com/download)上有一个 PHP 库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T18:20:05.240

一些可能有用的简单技巧：

*   限制一个帐户每小时可以发送的消息数量（除非它是对他们收到的 PM 的回复）

*   使用户只能在他们的帐户使用 X 天或发表 X 个论坛帖子后才能 PM

*   让少于 X 天的帐户在发送消息之前使用验证码

*   如果用户被举报，则将任何已发送的消息放入“待处理”队列（将已发送的消息包括在该队列中，以便其他可能收到垃圾邮件的用户不会收到该消息）。如果他们在审核后是垃圾邮件发送者，请杀死该帐户

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-16T18:20:21.590

您可以过滤单词，如果过滤器关闭，则暂时禁止该成员。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-16T18:30:03.103

你应该看看[Akismet](http://akismet.com/)。

最重要的是，您应该让用户能够*标记*垃圾邮件，就像 stackoverflow 所做的那样。如果您有 10k 名成员，他们应该能够很快过滤掉通过 Akismet 的垃圾邮件。

您是否担心垃圾邮件链接？您的用户是否必须能够发布 HTML/链接，还是纯文本就足够了？

# ruby-on-rails - 如何在 Rails 应用程序中包含自定义 .rb 脚本

> ID：14912055
> 
> 赞同：5
> 
> 时间：2013-02-16T15:45:18.373
> 
> 标签：ruby-on-rails, ruby

好的，我有这个应该包含在许多 Rails 应用程序中的 Ruby 脚本。所以我不想把它分解成碎片并将其塞进一个特定的应用程序中，而是宁愿将它保持在一个部分并让 Rails 应用程序加载它。该脚本主要来自模型、邮件程序和很少的控制器。

所以如果我的脚本是`tools.rb`，我应该把它放在我的 Rails 文件树的什么位置，我应该如何/在我的 Rails 应用程序中的什么位置包含它？该脚本还附带 YAML 文件。

这是我学习 Rails 的第二天，所以请多多包涵。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-16T15:53:32.800

您可以将所有额外的东西保存在`/app/modules`或`/lib`中。我更喜欢`lib`。放入`lib`文件夹后，在任何初始化程序中都需要它（或创建一个）

`require "./lib/tools"`在`/config/initializers/tools.rb`

和 tadaa ！您可以在 rails 应用程序的任何地方使用相应的类/模块！

所有的 YAML 文件都应该放在`/config/`.

*** 修复 '/lib/tools' 中的语法

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-16T15:54:22.317

您可以将自己的`.rb`文件包含在`lib folder`. 您可以在自己的 rb 文件下包含模块、类...等。

如果您想自动加载或自动要求您的自定义库代码，您必须打开`config/application.rb`并添加下一行，例如：

```
config.autoload_paths += %W(#{config.root}/extras #{config.root}/lib) 
```

你可以看看：

[http://reefpoints.dockyard.com/ruby/2012/02/14/love-your-lib-directory.html](http://reefpoints.dockyard.com/ruby/2012/02/14/love-your-lib-directory.html)

您`yaml`的文件应该在`/config/`文件夹内。

问候！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-16T15:47:48.853

如果您有任何`module`或`class`在脚本中定义并在应用程序中使用该模块或类，您只需将其放入`lib`. 它将在应用程序的任何地方访问。如果您需要初始化一些需要您的应用程序的东西，请加载该文件。除非需要，否则不要加载东西。如果您认为它必须在应用程序启动之前加载。然后你可以放入`config/initializers`

`yml`文件可以像下面一样在某些`initializers`文件中加载（可能在您的文件中`tools.rb`）：

```
 MY_TOOLS = YAML.load_file("#{RAILS_ROOT}/config/tools.yml") 
```

然后你可以`MY_TOOLS`在应用程序的任何地方使用。

# erlang - 在 erlang 中构建堆栈

> ID：14912056
> 
> 赞同：3
> 
> 时间：2013-02-16T15:45:23.657
> 
> 标签：erlang, stack

我还是 Erlang 的新手，并试图让我的头脑无法改变变量。假设我创建了一个堆栈并想要添加一个新元素。如果我无法为列表分配新值，我将如何更新堆栈？我每次都需要创建一个新列表吗？

例如，我在想 Push 可能看起来像

```
List = [X|List]. 
```

然后是流行音乐

```
[Head|Tail] = List
Head
List = Tail 
```

当然这不起作用，因为我无法更改 List 的值，这是我的问题。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T16:18:37.307

Erlang 在函数内部不能有副作用，这是[函数式编程](http://en.wikipedia.org/wiki/Functional_programming)语言中常见的特性。更改变量状态是一种副作用。Erlang 中的所有状态变化都被进程和消息传递所隐藏，这就是所谓的[参与者模型](http://en.wikipedia.org/wiki/Actor_model)。

“更改”变量的常用方法是让函数使用更改后的变量调用自身，这称为[递归](http://en.wikipedia.org/wiki/Recursion_%28computer_science%29)。例如，要对列表的所有元素求和：

```
sum([]) -> 0;
sum([H|Tail]) -> H + sum(Tail). 
```

更好的是让你的函数[尾递归](http://en.wikipedia.org/wiki/Recursion_(computer_science)#Tail-recursive_functions)，这意味着它们将自己称为函数体中的最后一条指令。这将节省内存，因为并非所有函数调用都需要保留在堆栈中（[尾调用优化](https://stackoverflow.com/questions/310974/what-is-tail-call-optimization)）。相同的示例，但使用尾递归：

```
sum([], Acc) -> Acc;
sum([H|Tail], Acc) -> sum(Tail, Acc + H).

sum(L) -> sum(L, 0). 
```

在这个例子中，我引入了一个累加器变量来传递中间结果。

如何使程序无副作用并不总是显而易见的，尤其是当您尝试以过程术语（如在 C 或 Java 中）来考虑问题时。它需要实践，可能还需要在更理论的层面上理解函数式编程的意愿。

纯粹的函数式编程语言根本不会有任何副作用；函数的返回值必须仅基于函数的输入参数，并且函数的唯一输出必须是返回值。这*不是*Erlang 的情况。`recieve`子句和`!`运算符用于函数内部的输入和输出；副作用。外部状态可以作为可以发送消息和获得回复的进程来保存。

这是一个如何创建一个变量的示例，该变量的值可以通过消息传递来更改（尝试找出是否`var_proc`是尾递归的！）：

```
var_proc(Value) ->
    receive
    {get, Pid} ->
            Pid ! {value, Value},
            var_proc(Value);
        {set, New} -> 
            var_proc(New)
    end.

var_start(Init) ->
    spawn(?MODULE, var_proc, [Init]).

var_set(Pid, Value) ->
    Pid ! {set, Value}.

var_get(Pid) ->
    Pid ! {get, self()},
    receive
    {value, Value} -> Value
    end. 
```

这是一个如何使用它的示例（我将模块称为“sum”）：

```
13> V = sum:var_start(6).
<0.72.0>
14> sum:var_get(V).
6
15> sum:var_set(V, 10).
{set,10}
16> sum:var_get(V).    
10 
```

更多示例和一些动机可以在 Erlang 文档的[并发编程](http://www.erlang.org/doc/getting_started/conc_prog.html)章节中找到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-17T12:22:08.733

对于像 Erlang 这样的函数式编程语言中的堆栈数据结构，您通常不会费心创建一个单独的进程来包含消息并对其进行操作，除非您希望多个进程同时访问它。

您应该每次都分配一个新变量，以包含堆栈的修改版本并从那里使用它**：**

```
new() -> [].

push(Value, OldStack) -> [Value|OldStack].

pop([]) -> empty;
pop([Value|RestStack]) -> {Value, RestStack}. 
```

你像这样使用它：

```
S0 = new(),
S1 = push(a, S0),
S2 = push(b, S1),
S3 = push(c, S2),
...
case pop(SN) of
   empty -> stack_was_empty;
   {Element, SN1} ->
     do_something_with(Element),
     SN2 = push(b, SN1),
     ...
... 
```

# google-apps-script - GAS 查看执行记录/日志窗口未更新/清除？

> ID：14912059
> 
> 赞同：1
> 
> 时间：2013-02-16T15:45:32.403
> 
> 标签：google-apps-script

我昨晚运行了一个脚本并检查了执行脚本窗口，该脚本已经运行。后来我运行了另一个脚本并查看了执行脚本窗口，它显示了之前运行的脚本的脚本。我使用的是 Chrome 版本 19.0.1084.52。我再次尝试使用最新版本的 Firefox 版本 18.0.2 并得到相同的结果。

今天早上我决定清除 Chrome 中的缓存和 cookie，然后再试一次。当我加载 Chrome 时，它​​表明将我的数据（浏览器历史记录、书签等）与我的 Google 帐户同步时出现了“同步”问题。我禁用了同步，清除了缓存和 cookie，然后退出了 Chrome。我重新加载了 Chrome，登录并打开了我的脚本项目。出于好奇，我查看了执行记录窗口，它仍然有我昨晚成功运行的脚本的记录。当一个人运行一个新的脚本或退出时，记录/日志窗口肯定应该被清除吗？

## 说明/场景

我有一个 GAS 脚本项目，其中包含几个脚本文件 Code.gs、Test.gs、RemoveLabels.gs、CreateLabels.gs。我想在名为 CreateLabels.gs 的脚本中放入 try...catch 块。它将在 Gmail 中创建新标签。我创建了一个名为 ErrorTest.gs 的新脚本文件，因此我可以尝试 Mozilla 开发人员网络 Javascript 参考文档中的一个示例以引发错误 - [throw - JavaScript | MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/throw)。

我将页面“抛出对象”下的示例（它测试无效的月份编号）复制到我的新脚本文件中，它按预期工作。

在我的脚本文件 CreateLabels.gs 中，我输入了以下代码：

```
function UserException(message) {
  this.message = message;
  this.name = "UserException";
}; 
```

在我想抛出错误的函数中，我有：

```
function getDayTable() {
  var myTable = new Object();
  var values = g_ss.getSheetByName('Sheet2').getRange(2, 5, 2).getValues();
  throw new UserException('Cannot access the spreadsheet');
  values[0] [0] == "" ? myTable.year = 2005 : myTable.year = values[0] [0];
  values[1] [0] == "" ? myTable.day = 1 : myTable.day = values [1] [0];
  return myTable;
}; 
```

在我调用该函数的代码中，我有：

```
try {
  var dayTable = getDayTable();

  //throws an error if dayTable cannot be retrieved
} catch (e) {
  Logger.log('There has been an error!');
  logMyErrors_(e); //pass exception object to error handler
} 
```

我运行名为 CreateLabels.gs 的脚本，并且执行脚本窗口仍然具有来自名为 ErrorTest.gs 的先前运行文件的脚本。尝试在同一个项目下一个接一个地运行两个脚本文件会导致问题吗？

# javascript - 无尽的页面一遍又一遍地加载相同的记录

> ID：14912060
> 
> 赞同：0
> 
> 时间：2013-02-16T15:45:34.060
> 
> 标签：javascript, jquery, ruby-on-rails

我正在使用 Rails 和 Kaminari，并试图在 Locations 和 Posts 下方的评论上实现无休止的滚动。我一开始是对的，但是当我向下滚动时，它会一遍又一遍地加载相同的评论。如何使它正确加载评论？

这是我的**位置/show.js.erb**

```
 1 $('#comments').append('<%= j render(@comments) %>'); 
```

这是我的**comments.js**

```
 5 jQuery ->
  6   $(window).scroll ->  
  7     if $(window).scrollTop() > $(document).height() - $(window).height() - 200
  8       $.getScript($('.pagination .next_page a').attr('href')) 
```

我的**评论控制器**显示动作

```
 18   def show
 19     @title = @location.name
 20     @comments = @location.comments.order("created_at desc").page(params[:page]).per(35)
 21     @commentable = @location
 22     @comment = @location.comments.build
 23     respond_to do |format|
 24       format.html
 25       format.js
 26     end
 27   end 
```

编辑：这是分页html源

```
<div class="pagination">
    <ul>

          <li class="active">
  <a href="#">1</a>
</li>

          <li class="">
  <a href="/locations/1?page=2" rel="next">2</a>
</li>

          <li class="">
  <a href="/locations/1?page=3">3</a>
</li>

          <li class="">
  <a href="/locations/1?page=4">4</a>
</li>

          <li class="">
  <a href="/locations/1?page=5">5</a>
</li>

      <li>
  <a href="/locations/1?page=5">Last &raquo;</a>
</li>

    </ul>
  </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:01:04.160

.next_page 链接没有改变。链接就是whatever.com/?page=2。当您滚动时，它只是对同一页面发出请求。你要么需要你的 javascript 来更新链接中的页码，要么不像那样引用 DOM。

您可以使用以下命令更新分页器：

```
$('.pagination').html('<%= escape_javascript(paginate(@comments)) %>'); 
```

Kaminari 对此有一个“操作方法”：操作方法[：-Create-Infinite-Scrolling-with-jQuery](https://github.com/amatsuda/kaminari/wiki/How-To%3a-Create-Infinite-Scrolling-with-jQuery)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:53:35.667

在您的回调中，`$.getScript`您可以通过以下方式增加页码`next`：

```
jQuery ->
    $(window).scroll ->  
      if $(window).scrollTop() > $(document).height() - $(window).height() - 200
        var $next=$('.pagination .next_page a')
         $.getScript($next.attr('href'), function(){
              /* script has loaded*/
              $next.attr('href', function(i, currHref){
                 return currHref.replace(/(?!page\=)(\d)/, function(match){
                        return parseInt(match,10)+1;
                   });
              });
         }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T23:41:58.637

好的，我发现了问题所在。感谢帮助过的人，非常感谢。**这是有效的代码。**（对不起，如果这些评论打扰了你，但我决定把它们留在这里，以防有人想纠正我或者他们将来帮助别人）。

**位置.js.coffee**

```
 5 # Infinite scroll
  6 jQuery ->
  7   # it doesn't listen for the scroll unless there is location_comments class
  8   if $('.location_comments').length
  9     $(window).scroll ->
 10       # finds anchor tag in pagination with rel attribute = 'next'
 11       $next = $(".pagination a[rel='next']")
 12       # sets url variable to the href value of that anchor tag
 13       url = $($next).attr('href')
 14       if url && $(window).scrollTop() > $(document).height() - $(window).height() - 200
 15         # since this replaces whole pagination with this text, it prevents loading of too many records.
 16         # This line ise immediatly followed by this getScript() wich triggers another operation on .pagination
 17         $('.pagination').text 'Fetching more comments...'
 18         # triggers /locations/show.js.erb
 19         $.getScript(url)
 20     $(window).scroll 
```

**位置/show.js.erb**

```
 1 $('.location_comments').append('<%= j render @comments %>');
  2 $('.pagination').replaceWith('<%= j paginate @comments %>');
  3 /* Add code for removing pagination if the user is on last page */ 
```

**评论控制器**

```
 9   def create
 10     @comment = @commentable.comments.build(params[:comment])
 11     @comment.user = current_user
 12 
 13     respond_to do |format|
 14       if @comment.save
 15         format.html { redirect_to @commentable, :notice => 'Comment created' }
 16         format.js
 17       else
 18         format.html { redirect_to @commentable, :alert => 'Comment not created' }
 19         format.js
 20       end
 21     end 
```

**位置控制器**

```
 18   def show
 19     @title = @location.name
 20     @comments = @location.comments.order("created_at desc").page(params[:page]).per(35)
 21     @commentable = @location
 22     @comment = @location.comments.build
 23   end 
```

**当用户在最后一页时，我仍然需要找出如何隐藏 .pagination ，**所以如果有人想提供帮助，那就太棒了。

# android-widget - 将 UniversalImageLoader 与小部件的 RemoteViewsFactory 一起使用

> ID：14912068
> 
> 赞同：0
> 
> 时间：2013-02-16T15:46:19.220
> 
> 标签：android-widget, android-listview, universal-image-loader

我正在使用 RemoteViewsFactory 在小部件中填充列表视图。

该小部件包含一个图像。在远程视图上加载位图和 setImageView() 的最佳方法是什么？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T15:39:52.383

同步加载图像的方式（适用于'loadImage（...）'和`displayImage(...)`）：

```
final Object lock = new Object();
boolean loaded = false;
ImageSize targetImageSize = new ImageSize(70, 70);
ImageLoader.getInstance().loadImage(imageUri, targetImageSize, options, new SimpleImageLoadingListener() {
    @Override
    public void onLoadingComplete(String imageUri, View view, Bitmap loadedImage) {
        loaded = true;
        // Do whatever you want with loadedImage

        synchronize(lock) {
            lock.notifyAll();
        }
    }
});
if (!loaded) {
    synchronize(lock) {
        lock.wait();
    }
} 
```

# exchangewebservices - EWS：打开的会话/登录过多 - 如何关闭？

> ID：14912070
> 
> 赞同：1
> 
> 时间：2013-02-16T15:46:27.923
> 
> 标签：exchangewebservices, exchange-server

我正在使用 EWS 为 Exchange 服务器开发索引服务。我还使用非个性化来阅读我所有用户的帐户。最近我正在使用一个名为“OpManager”的工具监控服务器。它抛出了一条错误消息：“活动客户端登录为 5300 次登录，此监视器的阈值为 5000 次登录”。我广泛使用新的 ExchangeService() 构造函数，然后对这些实例进行非个人化，但我不知道 EWS API 中的任何关闭或注销方法。知道如何释放或减少这些登录吗？

顺便说一句：我什至不知道此错误消息是否有任何负面影响，但我的客户希望清除此案。

谢谢你的任何提示

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T11:11:58.183

模拟的关键是拥有一个可以访问不同用户的模拟帐户。我认为保持连接打开并不明智。我也创建了一个监控不同用户的服务。我用计时器。当我请求请求时，我为当前用户设置模拟，当我准备好时，我删除模拟链接（设置为空）。因此，创建一个以模拟用户身份登录的实例，然后根据用户设置模拟。

# android - Android 简单 NFC 阅读器应用程序源代码错误。它不会读取任何 nfc 标签？

> ID：14912072
> 
> 赞同：0
> 
> 时间：2013-02-16T15:46:34.390
> 
> 标签：android, nfc

我有这个源代码，它应该读取一个 NDEF nfc 标签。除了扫描标签时，它不会做任何事情。有任何想法吗 ？

代码编译，没有错误。

看起来函数 protected void onNewIntent(Intent intent) 没有运行。

```
package com.tapwise.nfcreadtag;

import android.app.Activity;
import android.app.AlertDialog;
import android.app.PendingIntent;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.IntentFilter;
import android.nfc.NdefMessage;
import android.nfc.NfcAdapter;
import android.os.Bundle;
import android.os.Parcelable;
import android.os.PatternMatcher;
import android.provider.Settings;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Toast;

    public class MainActivity extends Activity {
    private static final String TAG = "NFCReadTag";
    private NfcAdapter mNfcAdapter;
    private IntentFilter[] mNdefExchangeFilters;
    private PendingIntent mNfcPendingIntent;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

    mNfcAdapter = NfcAdapter.getDefaultAdapter(this);

    mNfcPendingIntent = PendingIntent.getActivity(this, 0, new Intent(this,
                getClass()).addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP
                | Intent.FLAG_ACTIVITY_CLEAR_TOP), 0);

    IntentFilter smartwhere = new IntentFilter (NfcAdapter.ACTION_NDEF_DISCOVERED);
        smartwhere.addDataScheme("http");
        smartwhere.addDataAuthority("www.smartwhere.com", null);
        smartwhere.addDataPath(".*", PatternMatcher.PATTERN_SIMPLE_GLOB);

        mNdefExchangeFilters = new IntentFilter[] { smartwhere };

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    @Override
    protected void onResume() {
        super.onResume();
        if(mNfcAdapter != null) {
            mNfcAdapter.enableForegroundDispatch(this, mNfcPendingIntent,
                mNdefExchangeFilters, null);
            if (!mNfcAdapter.isEnabled()){

                LayoutInflater inflater = getLayoutInflater();
                View dialoglayout = inflater.inflate(R.layout.nfc_settings_layout,(ViewGroup) findViewById(R.id.nfc_settings_layout));
                new AlertDialog.Builder(this).setView(dialoglayout)
                        .setPositiveButton("Update Settings", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface arg0, int arg1) {
                                Intent setnfc = new Intent(Settings.ACTION_WIRELESS_SETTINGS);
                                startActivity(setnfc);
                            }
                        })
                        .setOnCancelListener(new DialogInterface.OnCancelListener() {

                            public void onCancel(DialogInterface dialog) {
                                finish(); // exit application if user cancels
                            }                           
                        }).create().show();

            }
        } else {
            Toast.makeText(getApplicationContext(), "Sorry, No NFC Adapter found.", Toast.LENGTH_SHORT).show();
        }

    }

    @Override
    protected void onPause() {
        super.onPause();
        if(mNfcAdapter != null) mNfcAdapter.disableForegroundDispatch(this);
    }

    @Override
    protected void onNewIntent(Intent intent) {
        super.onNewIntent(intent);      
        if (NfcAdapter.ACTION_NDEF_DISCOVERED.equals(intent.getAction())) {
            NdefMessage[] messages = null;
            Parcelable[] rawMsgs = intent.getParcelableArrayExtra(NfcAdapter.EXTRA_NDEF_MESSAGES);
            if (rawMsgs != null) {
                messages = new NdefMessage[rawMsgs.length];
                for (int i = 0; i < rawMsgs.length; i++) {
                    messages[i] = (NdefMessage) rawMsgs[i];
                }
            }
            if(messages[0] != null) {
                String result="";
                byte[] payload = messages[0].getRecords()[0].getPayload();
                // this assumes that we get back am SOH followed by host/code
                for (int b = 1; b<payload.length; b++) { // skip SOH
                    result += (char) payload[b];
                }
                Toast.makeText(getApplicationContext(), "Tag Contains " + result, Toast.LENGTH_SHORT).show();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-10-14T07:27:38.367

如果您使用的是 Nexus 4，则设备无法读取 MIFARE 经典标签。

# asp.net-mvc - Web Api 端点复杂对象与简单平面对象最佳实践

> ID：14912076
> 
> 赞同：2
> 
> 时间：2013-02-16T15:46:53.160
> 
> 标签：asp.net-mvc, asp.net-web-api

在 ASP.NET Web Api 中提供资源的最佳方式是什么？他们对此有任何参考或指导吗？

比如说我们有一个人。

**选项1：**

```
{
  "Personalia": {
    "CitizenServiceNumber": "23443342",
    "FirstName": "John",
    "LastName": "Web",
    "Gender": "Male",
    "DateOfBirth": "1965-02-16",
  },
  "Spouse": {
    "FirstName": "Emily",
    "LastName": "Web",
    "Gender": "Female",
    "DateOfBirth": "1968-02-16"
  },
  "Address": {
    "HouseNumber": "565",
    "Street": "Somewherestreet"
  }
} 
```

*   **Pro**易于阅读
*   **骗局**我们需要多个类/模型（Person、Personia、Spouse、Address）来获取/发布/放置一个人

**选项 2：**

```
{
    "CitizenServiceNumber": "23443342",
    "FirstName": "John",
    "LastName": "Web",
    "Gender": "Male",
    "DateOfBirth": "1965-02-16",
    "SpouseFirstName": "Emily",
    "SpouseLastName": "Web",
    "SpouseGender": "Female",
    "SpouseDateOfBirth": "1968-02-16",
    "HouseNumber": "565",
    "Street": "Somewherestreet"
} 
```

*   **Pro**我们只需要 1 节课
*   **Con**它的可读性/结构化程度较低，尤其是对于具有更多数据的类

这当然是一个相当简单的示例，但是对于更复杂的类，问题仍然存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T15:51:20.983

我会选择第一个选项。你不应该担心有很多对象。这些被称为视图模型，并且正是用于此目的。除此之外，您可以在 API 的其他部分重用这些对象的某些部分，在这些部分中您可能需要地址、人员、...

如果您更仔细地查看此 JSON 字符串，您实际上并不需要`Person`,`Personalia`和`Spouse`对象来映射此结构。一个 Person 对象就足够了。

例如，您的 API 控制器操作所采用的视图模型可能如下所示：

```
public class MyViewModel
{
    public PersonViewModel Personalia { get; set; }
    public PersonViewModel Spouse { get; set; }
    public AddressViewModel Address { get; set; }
} 
```

# php - PHP：静态属性不接受赋值

> ID：14912077
> 
> 赞同：0
> 
> 时间：2013-02-16T15:47:05.343
> 
> 标签：php, static, variable-assignment

我开始对我遇到的问题感到沮丧。我正在使用 if 语句为名为 error 的静态属性赋值。有趣的是，只有第二个 if 实际分配了一个值，而第一个 if 没有

```
if (mb_strlen($password) > 10 || mb_strlen($email) > 35)
{
    // 1st Error:
    self::$error = "PASS_EMAIL_TOO_LONG";
    die(self::$error);
    return false;
}
if (mb_strlen($password) < 8) 
{
    self::$error = "PASS_TOO_SHORT";
    die(self::$error);
    return false;
} 
```

为什么“PASS_EMAIL_TOO_LONG”永远不会分配给 $error ？

我使用 die 来查看值，但在进入第一个 if 块时它总是死掉，并返回一个空值，另一方面，第二个“if”按预期工作。

# javascript - Google Maps API，将用户自定义地图添加到网站

> ID：14912091
> 
> 赞同：-1
> 
> 时间：2013-02-16T15:47:53.653
> 
> 标签：javascript, html, google-maps

我目前在我的页面上显示了一张带有各种标记和设置的地图。见下文;

```
var options = { 

        zoom: 7,

        center: latlng,

        scrollwheel: true,

        navigationControl: true,

        mapTypeControl: false,

        scaleControl: false,

        draggable: true,

        streetViewControl: false,

        disableDoubleClickZoom: false,

        panControl: false,

        mapTypeId: google.maps.MapTypeId.TERRAIN

      }; 
```

我想知道是否有任何变量/选项可以让我从用户在 Google 地图上制作的自定义地图中读取地图？

**所以用户将进入谷歌地图网站并添加他们自己的标记和位置——这是我想读入我网站的地图。**

这里的主要目的是有一个标记列表（我有），但我缺乏的是一种在单击初始标记时在一个区域中显示更多“较小”位置的方法......

**因此，如果您单击放置在伦敦的标记，则会放大以显示散布在伦敦地区的更多标记。**

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:22:37.623

要在单击标记时缩放地图，您必须在初始化地图和标记时添加事件侦听器：

```
google.maps.event.addListener(marker, 'click', function() {    
   map.setZoom(parseInt(yourZoom));    
   map.setCenter(marker.getPosition());  
}); 
```

因此，当您单击标记时，将设置缩放属性，在这种情况下，将设置为 yourZoom 的值。

有关更多详细信息，您可以[查看文档](https://developers.google.com/maps/documentation/javascript/events)

# android - 如何使用 Android 读取（和写入）Mifare DesFire 卡

> ID：14912095
> 
> 赞同：0
> 
> 时间：2013-02-16T15:48:05.357
> 
> 标签：android, nfc, rfid, mifare

我正在尝试使用 android 应用程序读取和写入 mifare desfire 卡（经典作品已经），但不知道它是如何工作的 :)。我知道它与负责通过原始字节进行通信的 transceive(byte[]) 有关，但它是如何详细工作的？你能给我一些代码片段吗？

非常感谢和最好的问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-05T19:13:04.100

NXP 推出了一个 SDK 来处理与例如 Mifare DESFire EV1 卡的通信：[https ://www.mifare.net/en/products/tools/taplinx/](https://www.mifare.net/en/products/tools/taplinx/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-03-10T11:56:10.510

它比这更复杂，因为所有通信都是加密的，也可能使用 CMAC。我找到了一个比所有工作都更高级的 SDK，所以你不必处理收发等所有问题，如果你有兴趣，请私信我..

# ios - 我在 Trigger.io 的 iOS 配置中缺少什么步骤？

> ID：14912096
> 
> 赞同：1
> 
> 时间：2013-02-16T15:48:09.697
> 
> 标签：ios, provisioning, trigger.io

我已经浏览了此页面上的助手： [https ://developer.apple.com/ios/manage/overview/index.action](https://developer.apple.com/ios/manage/overview/index.action)

然后我设置了在我的触发器工具包中生成的配置文件，但是每当我尝试为我的设备构建时，我都会得到这个： `Failed when running /usr/bin/codesign: ... no identity found`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T02:14:43.737

确保您已下载 Apple 开发者证书并确保它已安装在您的 Keychain Access 中。我们的 CTO 演示如何设置 iOS 构建/打包的截屏视频也可能有所帮助： [https ://vimeo.com/51652733](https://vimeo.com/51652733)

# jquery - jQuery电子邮件验证正则表达式问题

> ID：14912099
> 
> 赞同：1
> 
> 时间：2013-02-16T15:48:51.083
> 
> 标签：jquery, regex, validation, email

我目前正在进行自己的验证，但我有一个小问题。我无法进行电子邮件验证。我尝试了一些不同的表达方式，但无法使其正常工作。也许我的布局有问题？

```
var email = $('.email');    
function valemail(){
    var filter = /^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
    if (filter.test(email)){
        return true;
    } else {
        return false;
    }
}

$('#registerform').submit(function() {
    if (valemail()) {
        return true;
    } else {
        return false;
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T15:51:44.230

尝试这个 ：

```
function IsEmail(email) {
  var regex = /^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
  return regex.test(email);
} 
```

以下调用：

```
 $('#registerform').submit(function(){
      if(IsEmail($(this).val())==false){
          //do something validation not satisfied
        }else{
            //do something
        }
      }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:24:46.643

[当jQuery Validate 插件可用](http://docs.jquery.com/Plugins/Validation)时，我不会编写自己的验证脚本。

但是，您可以简单地查看其中[包含的电子邮件正则表达式](http://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.0/jquery.validate.js)并使用它......

```
function email(value) {
    // contributed by Scott Gonzalez: http://projects.scottsplayground.com/email_address_validation/
    return /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(value);
} 
```

```
$('#registerform').submit(function() {
    var result = email($('#myemailfield').val());
    if (result) {
        alert('passed'); // <-- your code if passed
    } else {
        alert('failed'); // <-- your code if failed
    }
}); 
```

**简单演示：http: [//jsfiddle.net/m8baZ/](http://jsfiddle.net/m8baZ/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:24:36.200

当你这样做时：

```
var email = $('.email');
if (filter.test(email)){ 
```

`email`是一个 jQuery 对象，而不是用户键入的字符串。您需要从输入字段中获取实际字符串并将其与您的正则表达式一起使用，如下所示：

```
if (filter.test(email.val())){ 
```

# jpa - 在 JPA 2 中使用事务和外观

> ID：14912100
> 
> 赞同：1
> 
> 时间：2013-02-16T15:49:10.280
> 
> 标签：jpa, transactions, ejb

我正在创建一个 Java EE Web 应用程序，它将使用 JPA 2 EclipseLink 在数据库上运行。我也在使用应用程序管理的实体管理器，所以我可以手动设置事务，尽管我不确定一些事情。

初始信息（仅出于本文的目的，因为有细节/设计部分）我有 JPA 实体：UserEntity 和 UserDetailsEntity 在创建新用户时，我必须创建两个实体的实例，它们链接在一起。

在使用向导从实体类创建 JSF 页面时，我注意到 NetBeans 创建了一个`AbstractFacade`和一个实现该外观的企业 Java Bean：`UserFacade`和`UserDetailsFacade`. 这些 EJB 是 JPA CRUD 操作的基本包装器。

问题：

1.  Facade 模式真的有用吗，尤其是在我想在特定事务中组合几个 JPA 操作的情况下？这种模式对我的设计是好还是坏？为什么？

2.  如果我有“UserManagement 中的事务进程”，事务机制是否会起作用，但不是直接从事务块中执行 .persist，而是执行包装器方法：

    ```
     utx.begin();
        userFacade.create(userEntity);
        userDetailsFacade.create(userDetailsEntity);
        utx.commit(); 
    ```

3.  我不确定 EntityManager，我应该有多个实例吗？除了用户身份验证（了解当前登录的用户）之外，我看不到保留一个 EntityManager 实例的理由。我想我可以在每次需要时使用 EntityManagerFactory 来获取实例。但我关心的是这里的性能和好的/坏的设计实践。或者我应该保留一个 EntityManager（在配置类的某个地方获得并通过 Singleton 或 CDI 共享？）

4.  具有类似以下结构的 JSF Pages -> ManagementBean 收集信息并将其相应地传递给正确的 EJB Bean -> EJB bean 将执行业务方法并将信息传递给负责 CRUD 的 Facade EJB -> FacadeEJB 将坚持信息。

**AbstractFacade 的代码：（草稿）**

```
public abstract class AbstractFacade<T> {
private Class<T> entityClass;

public AbstractFacade(Class<T> entityClass) {
    this.entityClass = entityClass;
}

protected abstract EntityManager getEntityManager();

public void create(T entity) {
    getEntityManager().persist(entity);
}

public void edit(T entity) {
    getEntityManager().merge(entity);
}

public void remove(T entity) {
    getEntityManager().remove(getEntityManager().merge(entity));
}

public T find(Object id) {
    return getEntityManager().find(entityClass, id);
}

public List<T> findAll() {
    javax.persistence.criteria.CriteriaQuery cq = getEntityManager().getCriteriaBuilder().createQuery();
    cq.select(cq.from(entityClass));
    return getEntityManager().createQuery(cq).getResultList();
}

public List<T> findRange(int[] range) {
    javax.persistence.criteria.CriteriaQuery cq = getEntityManager().getCriteriaBuilder().createQuery();
    cq.select(cq.from(entityClass));
    javax.persistence.Query q = getEntityManager().createQuery(cq);
    q.setMaxResults(range[1] - range[0]);
    q.setFirstResult(range[0]);
    return q.getResultList();
}

public int count() {
    javax.persistence.criteria.CriteriaQuery cq = getEntityManager().getCriteriaBuilder().createQuery();
    javax.persistence.criteria.Root<T> rt = cq.from(entityClass);
    cq.select(getEntityManager().getCriteriaBuilder().count(rt));
    javax.persistence.Query q = getEntityManager().createQuery(cq);
    return ((Long) q.getSingleResult()).intValue();
} 
```

}

**UserFacade 的代码（草稿，因为我将修改这个类以从工厂中检索 EntityManagers 而不是使用 CDI）：**

```
@Stateless
public class UserEntityFacade extends AbstractFacade<UserEntityEntity> {
@PersistenceContext(unitName = "FMSBetaPU")
private EntityManager em;

@Override
protected EntityManager getEntityManager() {
    return em;
}

public TestEntityFacade() {
    super(TestEntity.class);
}

} 
```

**UserManagement EJB 代码（草稿）**

```
@Stateless
public class UserManagement {

@Resource
private UserTransaction utx;
@EJB
private UserEntityFacade userFacade;
@EJB
private UserDetailsEntityFacade userDetailsFacade;

public void createUser(int id, String name)
{
    UserEntity userEntity = new UserEntity(id);
    UserDetailsEntity userDetailsEntity = new UserDetailsEntity(name);
    try {
            utx.begin();
            userFacade.create(userEntity);
            userDetailsFacade.create(userDetailsEntity);
            utx.commit();
        } 
    catch (Exception e) {
            try {
                utx.rollback();
            } catch (IllegalStateException ex) {
                Logger.getLogger(UserManagement.class.getName()).log(Level.SEVERE, null, ex);
            } catch (SecurityException ex) {
                Logger.getLogger(UserManagement.class.getName()).log(Level.SEVERE, null, ex);
            } catch (SystemException ex) {
                Logger.getLogger(UserManagement.class.getName()).log(Level.SEVERE, null, ex);
            }
        } 
}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T15:58:48.513

> EntityManager，我应该有多个实例吗？

entityManager 就像您当前的数据库会话。所以使用单例是非常糟糕的设计。它不是线程安全的。它持有对从数据库中获取的所有对象的引用（感谢它关联的 persistenceContext），因此它应该是一个短时对象。

关于性能：从 entityManagerFactory 创建 entityManager 非常快。（另一方面，创建 entityManagerFactory 的成本很高......所以最好为 entityManagerFactory 设置一个单例）

# python - 如何使用 python 在 Ubuntu 终端中保存来自“sudo dpkg -l”的数据

> ID：14912104
> 
> 赞同：0
> 
> 时间：2013-02-16T15:49:36.693
> 
> 标签：python, subprocess

如何使用python在Ubuntu终端中保存来自“sudo dpkg -l”的数据，我尝试这样做，但它不起作用

```
import os
f = open('/tmp/dpgk.txt','w')
f.write(os.system('sudo dpkg -l')) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-16T15:52:21.507

用于[`subprocess.check_output()`](http://docs.python.org/2/library/subprocess.html#subprocess.check_output)捕获另一个进程的输出：

```
import subprocess

output = subprocess.check_output(['sudo', 'dpkg', '-l']) 
```

`os.system()`只返回另一个进程的退出状态。上面的示例假定`sudo`不会提示输入密码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:01:24.707

要将命令的输出保存到文件中，您可以使用[`subprocess.check_call()`](http://docs.python.org/2/library/subprocess.html#subprocess.check_call)：

```
from subprocess import STDOUT, check_call

with open("/tmp/dpkg.txt", "wb") as file:
    check_call(["sudo", "dpkg", "-l"], stdout=file, stderr=STDOUT) 
```

`stderr=STDOUT`用于将命令的标准错误重定向到标准输出。

# actionscript-3 - 读取没有值的数组元素

> ID：14912106
> 
> 赞同：1
> 
> 时间：2013-02-16T15:49:44.263
> 
> 标签：actionscript-3, flash

我有这个有效的 json：

```
{"config":{"autoUpdate":3500,"categories":["ristoranti","taxi","hotel"]}} 
```

我想阅读类别元素，我正在尝试这个：

```
var myData:Object = JSON.decode(myLoader.data);
    for (var categories:Object in myData.config.categories ) {
        trace(categories);
        } 
```

但这只是打印：

```
0
1
2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T15:57:36.627

*for - in*循环迭代**键**/值对象的键（在数组的情况下为索引）。如果要迭代**值**，则应使用*for **each** - in*循环。

```
for each (var category:String in myData.config.categories ) {
    trace(category);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:01:12.563

您需要为**每个**使用：

```
for each (var categories:Object in myData.config.categories )
{
    ...etc 
```

# objective-c - 如何更改单视图的亮度

> ID：14912107
> 
> 赞同：3
> 
> 时间：2013-02-16T15:49:49.033
> 
> 标签：objective-c, cocoa-touch

我是 iphone 编程的新手。我想问一下如何更改单视图（控制器）的屏幕亮度。我目前正在使用这个。

```
- (void) loadView
{
    [super loadView];

    userBrightness = [[UIScreen mainScreen] brightness];
    [[UIScreen mainScreen] setBrightness: 1.0];
}

- (void) viewDidUnload
{
    [super viewDidUnload];

    [[UIScreen mainScreen] setBrightness: userBrightness];
} 
```

但我不能使用 'viewDidUnload' 方法，因为它已被弃用。当我切换到另一个视图或终止应用程序时，我不知道如何返回背光的先前值。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T15:51:53.610

在视图加载时更改亮度过于持久，即使您的视图不在屏幕上，亮度也不会恢复到正常水平。请记住，更改屏幕亮度的概念是一项全局操作，并且不知道它所更改的上下文（在您的情况下，当单个视图出现在屏幕上时申请）。我建议阅读有关[视图生命周期细节](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/ViewLoadingandUnloading/ViewLoadingandUnloading.html)的文档。

您可以考虑使用`viewWillAppear`and `viewWillDisappear`，它将提供您需要的粒度。

# c# - 语音识别以显示列表框中的图片

> ID：14912108
> 
> 赞同：1
> 
> 时间：2013-02-16T15:49:52.300
> 
> 标签：c#, winforms, listbox, speech-recognition, picturebox

我的语音识别出现错误，我不断收到“在进行识别之前必须加载至少一个语法”当您说出相应的链接名称时，我无法显示图像。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
using SpeechLib;
using System.IO;
using System.Speech.Recognition;
using System.Globalization;

namespace SimpleSpeechRecognition
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private SpeechRecognitionEngine recognizer;

        private void Form1_Load(object sender, EventArgs e)
        {
            speechListBox1.Items.Add("Dog");
            speechListBox1.Items.Add("Elephant");
            speechListBox1.SpeechEnabled = true;

            recognizer = new SpeechRecognitionEngine(new CultureInfo("en-GB"));
            recognizer.SetInputToDefaultAudioDevice();

            Choices choices = new Choices("Dog", "Elephant");
            GrammarBuilder m_GrammarBuilder = new GrammarBuilder(choices);
            Grammar m_Speech = new Grammar(m_GrammarBuilder);
            recognizer.LoadGrammar(m_Speech);

            recognizer.SpeechRecognized += new EventHandler<SpeechRecognizedEventArgs>(recognizer_SpeechRecognized);
            recognizer.RecognizeAsync(RecognizeMode.Multiple);
        }

        void recognizer_SpeechRecognized(object sender, SpeechRecognizedEventArgs e)
        {
            foreach (RecognizedWordUnit word in e.Result.Words)
            {
                switch (word.Text)
                {
                    case "Dog":
                        pictureBox1.Image = Image.FromFile("C:\\" + "dog.jpg");;
                        break;
                    case "Elephant":
                        pictureBox1.Image = Image.FromFile("C:\\" + "elephant.jpg");
                        break;
                }
            }
        }
        private void speechListBox1_SelectedIndexChanged(object sender, EventArgs e)
        {

            //MessageBox.Show(speechListBox1.SelectedItems[0].ToString());
            SayPhrase(speechListBox1.SelectedItems[0].ToString());
            //pictureBox1.Image = Image.FromFile("C:\\" + "dog.jpg");
            //pictureBox1.Image = Image.FromFile(((FileInfo)speechListBox1.SelectedItem).FullName);
            pictureBox1.Refresh();
        }

       private void SayPhrase(string PhraseToSay )
       {

                SpeechVoiceSpeakFlags SpFlags = new SpeechVoiceSpeakFlags();
                SpVoice Voice  = new SpVoice();
                Voice.Speak(PhraseToSay, SpFlags);

       }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:22:58.770

错误不言自明：

语音引擎必须有一组“选择”来听，但是这些需要内置到适当的语法中，以便语音引擎可以听出来。

```
GrammarBuilder m_GrammarBuilder = new GrammarBuilder(choices);
Grammar m_Speech = (m_GrammarBuilder); 
```

然后只需将语法加载到：

```
recognizer.LoadGrammar(m_Speech); 
```

我认为这应该可以解决您的问题。还值得注意的是，您也可以通过 .UnloadGrammar() 函数卸载和加载不同的语法集。

此外，使用适当的文化信息初始化 SpeechRecognitionEngine 也是值得的。对于英语（英国），这是：

```
new SpeechRecognitionEngine(new CultureInfo("en-GB")) 
```

# python - 如何使用 QWebPage 作为 QListView 的代表？

> ID：14912115
> 
> 赞同：0
> 
> 时间：2013-02-16T15:50:34.483
> 
> 标签：python, qt, pyqt

我正在为一个社交网络的客户端工作。它是用 Qt 和 Python 编写的。我需要将时间线放入`QListView`（想想 Twitter 或 Facebook）。

但是，QListView 不能渲染富文本，所以我`QTextDocument`用作委托。

```
class HTMLDelegate(QtGui.QStyledItemDelegate):
    def paint(self, painter, option, index):
        options = QtGui.QStyleOptionViewItemV4(option)
        self.initStyleOption(options, index)
        options.text = options.text.replace(" ", "&nbsp;")

        style = QtGui.QApplication.style() if options.widget is None else options.widget.style()

        doc = QtGui.QTextDocument()
        doc.setHtml(options.text)
        doc.setTextWidth(option.rect.width())

        options.text = ""
        style.drawControl(QtGui.QStyle.CE_ItemViewItem, options, painter)

        ctx = QtGui.QAbstractTextDocumentLayout.PaintContext()

        # Highlighting text if item is selected
        #if (optionV4.state & QStyle::State_Selected)
            #ctx.palette.setColor(QPalette::Text, optionV4.palette.color(QPalette::Active, QPalette::HighlightedText));

        textRect = style.subElementRect(QtGui.QStyle.SE_ItemViewItemText, options)
        painter.save()
        painter.translate(textRect.topLeft())
        painter.setClipRect(textRect.translated(-textRect.topLeft()))
        doc.documentLayout().draw(painter, ctx)

        painter.restore()

    def sizeHint(self, option, index):
        options = QtGui.QStyleOptionViewItemV4(option)
        self.initStyleOption(options, index)

        doc = QtGui.QTextDocument()
        doc.setHtml(options.text)
        doc.setTextWidth(options.rect.width())
        return QtCore.QSize(doc.idealWidth(), (doc.size().height())) 
```

它是有效的，但它不支持所有 HTML 标签。

经过大量搜索，我发现`QWebView`它是一个功能齐全的 HTML 查看器。我想`QWebPage`用作`QListView`.

所以，我尝试了：

```
class HTMLDelegate(QtGui.QStyledItemDelegate):
    def paint(self, painter, option, index):
        options = QtGui.QStyleOptionViewItemV4(option)
        self.initStyleOption(options, index)
        options.text = options.text.replace(" ", "&nbsp;")

        style = QtGui.QApplication.style() if options.widget is None else options.widget.style()

        webPage = QtWebKit.QWebPage(self)
        webFrame = webPage.mainFrame()
        webPage.setViewportSize(webPage.mainFrame().contentsSize())
        webFrame.setHtml(options.text)

        #doc.setTextWidth(option.rect.width())

        options.text = ""
        style.drawControl(QtGui.QStyle.CE_ItemViewItem, options, painter)

        #ctx = QtGui.QAbstractTextDocumentLayout.PaintContext()

        textRect = style.subElementRect(QtGui.QStyle.SE_ItemViewItemText, options)
        painter.save()
        painter.translate(textRect.topLeft())
        painter.setClipRect(textRect.translated(-textRect.topLeft()))
        webFrame.render(painter)

        painter.restore() 
```

但它不起作用。它只显示空白项目。

我做错了什么？

或者，对于这种情况是否有另一种解决方案？我发现`setItemWidget()`可以将许多小部件放入一个项目中`QListView`，但它会破坏模型视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T10:09:33.347

好的，所以我建议您的原始问题是您`webPage.setViewportSize`之前打过电话`webFrame.setHtml`。

这`sizeHint`很棘手。 `QWebView`甚至没有尝试，当然网络浏览器的工作方式是它们根据用户设置的视口大小执行布局。我建议您需要自己提出一个合理的宽度值。然后，您应该能够从`contentsSize`.

# assembly - LC4 组装说明

> ID：14912117
> 
> 赞同：0
> 
> 时间：2013-02-16T15:51:00.037
> 
> 标签：assembly

我正在尝试将此伪代码转换为 LC4 汇编语言

```
B = 0
If (A >= 0) {
   While (B*B <= A) {
   B = B + 1
   }
}
B = B - 1 
```

if 语句使用什么助记符？是 CMP 和 while 语句 CMPI 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:01:39.683

我会说这是相反的，与`if`常数比较，而`while`没有。所以使用`cmpi`to compare `A`against`0`和`cmp`to compare `B*B`against `A`。

# php - 通过具有相同 IP 的 TOR 发出两个线性 cURL 请求

> ID：14912122
> 
> 赞同：3
> 
> 时间：2013-02-16T15:51:18.737
> 
> 标签：php, http, curl, tor, http-pipelining

在回答我的问题之前 - 请注意，这与以下主题无关：

[cURL：两个单独的请求，同一个会话](https://stackoverflow.com/questions/9753224/curl-two-seperate-requests-same-session)

[为 curl 请求选择传出 IP](https://stackoverflow.com/questions/2425651/select-outgoing-ip-for-curl-request)

[PHP 多个 curl 请求](https://stackoverflow.com/questions/3900153/php-multiple-curl-requests)

我在一个反验证系统中工作，另一个验证是相同的 IP 不能每小时执行 5 个请求，因为我使用的是 TOR。但我需要遵循这个顺序/流程：

1.  访问启动 URL ( `Example: http://server/start-session`) - 获取验证码并使用验证令牌设置 cookie
2.  提交验证码字符 ( `Example: http://server/verify-captcha`)，带有令牌、会话 ID，并且我必须保留启动 URL 中的 IP

在每次请求后使用 TOR 我有一个新 IP，并且有一个服务器端验证在会话启动时设置我的 IP，换句话说，如果我的 IP 更改，即使我发送会话 ID 和正确的令牌，会话也被认为是无效的带有有效的验证码字符。

如何将我的 IP 与 TOR 保持 2 个连续请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-21T05:32:29.470

取决于您的 TOR 配置。默认情况下，它仅每 10 分钟切换一次 IP。我建议您在此处参考详细信息：[如何以编程方式更改 Tor 退出节点](https://stackoverflow.com/questions/1969958/how-to-change-tor-exit-node-in-a-program-way)

# image - 根据从 NSUserDefaults 加载的对象，将图像加载到 tableview 单元格中

> ID：14912124
> 
> 赞同：0
> 
> 时间：2013-02-16T15:51:23.037
> 
> 标签：image, uitableview, xcode4.5, nsuserdefaults

我有一个由从 NSUserDefaults 加载的对象填充的表格视图。

具体来说——当用户在一个视图控制器中按下一个按钮时，一个字符串被加载到 NSUserDefaults 中，然后被加载到一个数组中，最终填充一个表视图。

我想知道如何根据从 NSUserDefaults 加载的字符串在每个 tableview 单元格中加载图像？

我不想在 NSUserDefaults 中保存图像，因为我知道这不是一个好主意。

我能做些什么？

感谢您的时间（并帮助新手）！

* * *

2013 年 2 月 19 日更新

我加载到 NSUserDefaults 中的字符串是对象的名称，例如“ARCX”。

目前我已经尝试了各种代码，但我似乎有误解/缺乏知识（或两者兼而有之）。

```
UITableViewCell *XCell = [tableView cellForRowAtIndexPath:IndexPath];
NSString *content = Xcell.textLabel.text;

if ([content isEqualToString:@"ARCX"]) [UIImage *Image = [UIImage imageNamed @"ARCX.png"]]; 
```

显然我从这段代码中得到了错误。

我希望你能帮忙！

* * *

2013 年 2 月 20 日更新

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
     NSString *string = [myOBJArray objectAtIndex:indexPath.row];
     static NSString *CellIdentifier = @"XCell";
     UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
     if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
        UIView *cellbackground = [[UIView alloc] initWithFrame:CGRectZero];
        cellbackground.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"MSP cell bg MK2.png"]];
        cell. backgroundView = cellbackground;

}

cell.textLabel.textColor = [UIColor yellowColor ];
cell.textLabel.font = [UIFont fontWithName:@"Helvetica" size:24.0];
cell.textLabel.text = string;

 UITableViewCell *XCell = [tableView cellForRowAtIndexPath:indexPath];
 NSString *content = XCell.textLabel.text;

 if ([content isEqualToString:@"ARCX"]) [UIImage *Image = [UIImage imageNamed: @"ARCX.png" ]];

cell.imageView.image = Image;

     return cell; 
```

}

我确实有我最初在 CellForRowAtIndexPath 中发布的代码，但我知道我在实现中遗漏了一些东西（显然因为它不起作用！）。

谢谢你的时间！

* * *

2013 年 2 月 19 日更新

I 这是我当前的 CellForRowAtIndexPath。没有错误，但我的单元格中没有图像。我错过了什么？

我必须添加图像视图吗？我目前使用的是“基本”单元，而不是自定义单元。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSString *string = [myObjArray objectAtIndex:indexPath.row];
static NSString *CellIdentifier = @"MSCell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    UIView *cellbackground = [[UIView alloc] initWithFrame:CGRectZero];
    cellbackground.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"MSP cell bg MK2.png"]];
    cell. backgroundView = cellbackground;
}

cell.textLabel.textColor = [UIColor blackColor ];
cell.textLabel.font = [UIFont fontWithName:@"Helvetica" size:24.0];
cell.textLabel.text = string;

if ([string isEqualToString:@"ARCX"])

cell.imageView.image = [UIImage imageNamed: @"ARCX.png"];

else if ([string isEqualToString:@"WPX"])

    cell.imageView.image = [UIImage imageNamed:@"WPX.png"];

 return cell; 
```

}

谢谢你的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T04:06:52.027

```
UITableViewCell *XCell = [tableView cellForRowAtIndexPath:indexPath];
NSString *content = XCell.textLabel.text; 
```

请删除这段代码，因为它会一次又一次地调用 cellForRowAtIndexPath。您已经将图像名称作为字符串

```
NSString *string = [myOBJArray objectAtIndex:indexPath.row]; 
```

所以像下面这样更改代码。

```
if ([string isEqualToString:@"ARCX"]) 
        UIImage *Image = [UIImage imageNamed: @"ARCX.png"];
cell.imageView.image = Image; 
```

# java - 从 HashMap java 中删除数据

> ID：14912137
> 
> 赞同：0
> 
> 时间：2013-02-16T15:52:04.133
> 
> 标签：java, hashmap

我有 HashMap`HashMap<Integer, List<String>> storeR`并且它存储`"22,name1,name2"`..但是有什么方法可以从 HashMap 中`name1`删除`22`？我只想从 22 中删除名称 1。我该怎么做？我希望你能帮助我。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T15:54:38.937

从地图中取出列表并删除要删除的元素：

```
storeR.get(22).remove("name1"); 
```

但是，如果地图中没有键`22`，或者它的值是，`null`这将抛出一个`NullPointerException`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-16T15:56:11.950

鉴于您对此提出的问题，您最好使用第三方库：[Guava](http://guava-libraries.googlecode.com)有一个[`Multimap`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multimap.html)具有各种实现的接口 - 您可能想要[`ArrayListMultimap`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/ArrayListMultimap.html).

然后你可以写：

```
multimap.remove(22, "name1"); 
```

如果您*真的*想继续自己手动完成所有工作，您可以调用`get`map 以返回列表，然后`remove`在列表中删除值。但是你应该考虑如果你已经删除了最后一个值，你是否还想*完全*删除键 - 当然，如果你不知道键是否已经存在于地图中，你只需要*有条件*地调用`remove`...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T15:56:48.290

[Guava 中的ArrayListMultimap](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ArrayListMultimap.html)就是针对这种情况而设计的。

请参阅： [http ://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multimap](http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multimap)

# spring - ZK 和 Spring - 在 Spring Bean 中使用 Executions.getCurrent() 是否安全？

> ID：14912143
> 
> 赞同：1
> 
> 时间：2013-02-16T15:52:38.967
> 
> 标签：spring, zk

我想在我的 ZK Composers 中为常见的 URL 解析创建一个实用程序 Bean。但是，我想确保`Executions.getCurrent()`在 Spring 托管 Bean 中使用类似的东西是安全的。我很确定它`Executions.getCurrent()`一开始就是静态的。

这就是我想做的事情..

```
@Component
public MyUrlBean {

  // TODO I will, of course, program to an interface here =)

  private static final String MY_OBJECT_URL_PARAMETER = "my_obj";

  public MyObject getMyObjectFromURL() {
    Execution ex = Executions.getCurrent();
    String value = ex.getParameter(MY_OBJECT_URL_PARAMETER)
    // ... db fetch and the like
  }

} 
```

..像这样使用..

```
@VariableResolver(DelegatingVariableResolver.class)
public MyComposer extends SelectorComposer<Window> {

  @WireVariable
  public MyUrlBean myUrlBean;

  @Override
  public void doAfterCompose(Window component) {
    MyObject myObject = myUrlBean.getMyObjectFromURL();
    // ...
  }

} 
```

那么，以这种方式做事，应该一切正常，还是应该预料到用户会话冲突等问题？

Spring bean**不是**静态单例，对吗？相反，它们是自动装配的实例类，以节省实际更新对象的计算时间，对吗？如果是这样，那么用户之间肯定不会发生这样的冲突。

无论如何，正如我提到的，`Executions.getCurrent()`是静态的。嗯，这如何与访问 web 应用程序的多个用户一起工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:25:12.540

**是的，它是安全的。**

我没有太多官方资源可以在这里链接，但值得一提的是，我以前的团队几乎在一个应用程序的每个页面（以获取用户上下文）中都使用它，该应用程序在生产中为超过 3000 个用户提供服务，并且没有记录问题两年。

# ruby-on-rails - 在 Ruby on Rails 中通过 json 发布

> ID：14912144
> 
> 赞同：0
> 
> 时间：2013-02-16T15:53:07.293
> 
> 标签：ruby-on-rails, json, post

我正在尝试通过 json 在数据库中创建记录。问题是我不知道如何在 URL 栏中编写 http 请求：

它应该是这样的：

```
http://localhost:3000/addnewpost.json?content=sometexthere 
```

或者这是不正确的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T15:59:08.670

这是不正确的。创建记录应该是 POST 命令，而不是 GET。因此，数据内容应该放在 POST 标头中，而不是 URL 中。

您是直接从 Ruby 发送此 POST 吗？（如果是这样，您将需要查看 Net::HTTP 或其他一些[ruby​​ HTTP 客户端](https://www.ruby-toolbox.com/categories/http_clients)）。向我们展示一些代码，我们将帮助您改进它。

# mysql - VB 2008 如何使用文本框插入和更新数据库表行

> ID：14912146
> 
> 赞同：0
> 
> 时间：2013-02-16T15:53:35.373
> 
> 标签：mysql, vb.net, textbox

我正在做我系统的一部分，它正在更新和/或将数据插入数据库。我有一个带有组合框和 10 个文本框的表单。在这里，如果组合框充满了我数据库中诊断表中的疾病。

诊断表的结构是：f_id、疾病、症状，所以一个疾病可以有很多症状。

如果从组合框中选择了一个项目，则症状将显示在文本框中。我已经开始工作了。我的问题是我应该让它能够插入或更新表中的行。我真的不知道该怎么做。到目前为止，这是我的代码：

```
Call Connect()
        If Duplicate() = False Then

            STRSQL = "insert into diagnose values ('', @ill, @sym0), ('', @ill, @sym1), ('', @ill, @sym2), ('', @ill, @sym3), ('', @ill, @sym4), ('', @ill, @sym5), ('', @ill, @sym6), ('', @ill, @sym7), ('', @ill, @sym8), ('', @ill, @sym9)"
            Using myCmd = New MySqlCommand(STRSQL, myConn)
                myConn.Open()
                myCmd.Parameters.AddWithValue("ill", cmbRecord.Text)
                myCmd.Parameters.AddWithValue("sym0", symp0.Text)
                myCmd.Parameters.AddWithValue("sym1", symp1.Text)
                myCmd.Parameters.AddWithValue("sym2", symp2.Text)
                myCmd.Parameters.AddWithValue("sym3", symp3.Text)
                myCmd.Parameters.AddWithValue("sym4", symp4.Text)
                myCmd.Parameters.AddWithValue("sym5", symp5.Text)
                myCmd.Parameters.AddWithValue("sym6", symp6.Text)
                myCmd.Parameters.AddWithValue("sym7", symp7.Text)
                myCmd.Parameters.AddWithValue("sym8", symp8.Text)
                myCmd.Parameters.AddWithValue("sym9", symp9.Text)
                myCmd.ExecuteNonQuery()
            End Using
            MsgBox("Record Added")
            myConn.Close()
        Else
            STRSQL = "Update diagnose set first_aid = @ill, sname = @symp where first_aid = @ill"
            Using myCmd = New MySqlCommand(STRSQL, myConn)
                myConn.Open()
                myCmd.Parameters.AddWithValue("ill", cmbRecord.Text)
                myCmd.Parameters.AddWithValue("sym", symp0.Text)
                myCmd.Parameters.AddWithValue("sym", symp1.Text)
                myCmd.Parameters.AddWithValue("sym", symp2.Text)
                myCmd.Parameters.AddWithValue("sym", symp3.Text)
                myCmd.Parameters.AddWithValue("sym", symp4.Text)
                myCmd.Parameters.AddWithValue("sym", symp5.Text)
                myCmd.Parameters.AddWithValue("sym", symp6.Text)
                myCmd.Parameters.AddWithValue("sym", symp7.Text)
                myCmd.Parameters.AddWithValue("sym", symp8.Text)
                myCmd.Parameters.AddWithValue("sym", symp9.Text)
                myCmd.ExecuteNonQuery()
            End Using
            MsgBox("Record Updated")
            myConn.Close()
        End If 
```

我已经有一个模块将我的项目连接到 mysql db (myConn)。我不能做的是我不能更新诊断表中的任何行。我也无法添加行。诊断表如下所示（示例）：

```
f_id | illness |  symptom
1   |  fever   |  fever
2   |  fever   |  hot temperature
3   |  fever   |  dizziness
4   |  fever   |  headache 
```

所以在这种情况下，假设我在组合框中选择了发烧，那么它将在 4 个文本框中显示症状。如果用户进行了更改，该`Duplicate()`函数会检查组合框值是否已经有记录。如果为真，那么它将更新。假设用户添加了另一个症状，所以如果单击保存按钮，发烧将添加另一个带有添加症状的行。

如果为 false，则将添加一条新记录，这意味着将在表中添加新行或多行，具体取决于在文本框中输入的症状数量。因此，假设要添加“感冒”作为新记录，并且我输入了 2 个症状，这意味着我使用了表单中 10 个文本框中的 2 个，然后将在表格中添加 2 行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:18:36.753

您试图在同一个查询中插入多行，这是不可能的。您需要对插入的每一行进行单独的查询。循环遍历文本框数组（来自上一个问题）以插入：

```
Dim arrayOfTextboxes() As TextBox = {symp0, ... put all textboxes here..., symp9}
myConn.Open()

If Duplicate() = False Then

    STRSQL = "insert into diagnose values (@ill, @sym)"

    For i = 0 To arrayOfTextboxes.Count - 1

       If String.IsNullOrEmpty(arrayOfTextboxes(i).Text) Then Continue For

       Using myCmd = New MySqlCommand(STRSQL, myConn)
            myCmd.Parameters.AddWithValue("@ill", cmbRecord.Text)
            myCmd.Parameters.AddWithValue("@sym", arrayOfTextboxes(i).Text)              
            myCmd.ExecuteNonQuery()
        End Using

    Next          

        MsgBox("Record Added")

Else

      // I don't get what you want to do in the update part yet.

End If

myConn.Close() 
```

# php - 逐行加载数据本地文件

> ID：14912147
> 
> 赞同：0
> 
> 时间：2013-02-16T15:53:37.200
> 
> 标签：php, mysql, load-data-infile

我正在尝试使用“加载数据本地文件”将数据从文本文件复制到数据库中。文本示例：

```
jack
|
hi   
|-
ron
|
whats new
|-
jack
|
ok
|-
ron
|
bye
|- 
```

我正在尝试的代码：

```
include 'conect.php'; // conect to DB
$query = "LOAD DATA LOCAL INFILE 'messages2.txt'
INTO TABLE `conv`
FIELDS TERMINATED BY '|'
LINES TERMINATED BY '-'
(name, msg)";
mysql_query($query);
mysql_close(); 
```

它只是将名字复制到数据库。这样做的正确方法是什么？多谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:02:00.910

我的看法是：

```
杰克|嗨|-
罗恩|最新消息|-
千斤顶|好的|-
罗恩|再见|-
```

所以我会尝试：

```
FIELDS TERMINATED BY '|'
LINES TERMINATED BY '|-' 
```

但是，由于您有回车，您可能需要`\n`or`\r`或`\r\n`：

```
FIELDS TERMINATED BY '|\n'
LINES TERMINATED BY '|-\n' 
```

# python - pynfs 在 windows server 2008 上运行稳定吗？

> ID：14912150
> 
> 赞同：0
> 
> 时间：2013-02-16T15:54:20.013
> 
> 标签：python, python-2.7, windows-server-2008, ubuntu-12.04, nfs

我需要从安全网络中的 windows server 2008 连接到 ubuntu 机器，并从 python 代码轻松地写入和读取文件。我想避免使用 samba 或 ftp，所以我正在考虑 NFS，我的问题是，如果 pynfs 在 Windows 上工作稳定（如果有的话，还是只在 linux 上工作？）

我在 github 上找到了源代码和一些分支

我也不确定项目的状态，它不在 pypi 中，不能通过 pip 安装，所以我想知道这是否是一个有未来的维护和更新项目。很高兴听到有一些生产经验的人的来信，我正在使用 python 2.7

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:01:19.843

pynfs 是一个测试套件，不能在生产中作为 nfs 服务器运行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T13:55:26.910

我希望 pynfs 周围有一些现代基础设施。

这次我和桑巴一起去了。

# c# - 正则表达式选择整个外部 DIV

> ID：14912157
> 
> 赞同：0
> 
> 时间：2013-02-16T15:55:08.667
> 
> 标签：c#, regex

已经尝试了几个小时来解决这个问题。我想使用正则表达式来选择整个 div，包括嵌套的 div，请参见下面的示例字符串：

```
AA <div> Text1 </div> BB <div style=\"vertical-align : middle;\"> Text2 <div>Text 3</div> </div> CC 
```

想要返回以下值

```
<div> Text1 </div>
<div style=\"vertical-align : middle;\"> Text2 <div>Text 3</div> </div> 
```

我得到的关闭是使用以下代码，但只给了我每个 DIV

```
(?<BeginTag><\s*div.*?>)|(?<EndTag><\s*/\s*div.*?>) 
```

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:21:17.147

*[为了扩展我相当尖刻的评论](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)*，正则表达式不是解析任何类型 HTML 的好工具。只有在最简单的情况下才可行，即使那样，我也不推荐它。

您需要的是一个解析 HTML 的好工具。在 .NET 世界中，一个很好的库是[HTMLAgilityPack](http://htmlagilitypack.codeplex.com/)或者可能是[SGMLReader 项目](https://github.com/MindTouch/SGMLReader)。

您确实需要花一点时间来学习 API，但这是值得的。

对于您展示的小片段，我认为对您来说最简单的 API 将是 SGMLReader。它可以像读取 XML 一样读取 HTML，这意味着您可以将其转换为 XDocument 并使用更好的 API。其代码可能如下所示：

```
string markup = "<html>AA <div> Text1 </div> BB <div style=\"vertical-align : middle;\"> Text2 <div>Text 3</div> </div> CC</html>";
XDocument doc;
using(var reader = Sgml.SgmlReader.Create(new StringReader(markup))) 
    doc = XDocument.Load(reader);

var rootLevelDivs = doc.Root.Elements("div");
foreach(var div in rootLevelDivs)
    Console.WriteLine(div); 
```

# c++ - std::async 和对象复制

> ID：14912159
> 
> 赞同：5
> 
> 时间：2013-02-16T15:55:25.080
> 
> 标签：c++, c++11

我正在试验`std::async`并最终得到一个看起来像这样的代码：

```
class obj {
public:
    int val;

    obj(int a) : val(a) {
        cout << "new obj" << endl;
    }
    ~obj() {
        cout << "delete obj" << endl;
    }
};

void foo(obj a) {

    this_thread::sleep_for(chrono::milliseconds(500));
    cout << a.val << endl;
}

int main(int argc, int **args) {

    obj a(5);
    auto future = async(foo, a);
    future.wait();

    return 0;
} 
```

结果是：

```
new obj
delete obj
delete obj
delete obj
5
delete obj
delete obj
delete obj 
```

然后我尝试`void foo(obj a)`通过以下方式进行更改`void foo(obj &a)`：

```
new obj
delete obj
delete obj
delete obj
5
delete obj
delete obj 
```

为什么要为这个简单的代码制作我的对象的 5 个副本？我不得不承认，我真的很困惑。有人愿意解释一下吗？

**编辑**

我正在使用 VS2012

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-16T17:27:37.430

在您的情况下，`obj`正在复制：

1.  两次调用[`std::async`](http://en.cppreference.com/w/cpp/thread/async)。
2.  两次 by`async`的内部调用[`std::bind`](http://en.cppreference.com/w/cpp/utility/functional/bind)。
3.  一次通过调用，`void foo(obj a)`因为它`a`按值取值。

信不信由你，[自 VC10 以来，副本的数量实际上已经减少](https://connect.microsoft.com/VisualStudio/feedback/details/649268/std-bind-and-std-function-generate-a-crazy-number-of-copy)了。

看到一个库（无论是标准库还是另一个库）触发的副本比您对您的类型所期望的要多一些，这种情况并不少见。通常，您对此无能为力。

人们通常会做两件事来防止复制：

1.  `obj`通过引用（或者在你的情况下， const ref 因为不`foo`修改`obj`）。这将需要使用[`std::ref`](http://en.cppreference.com/w/cpp/utility/functional/ref)异步。
2.  为定义一个[移动构造函数](https://stackoverflow.com/questions/3106110/can-someone-please-explain-move-semantics-to-me)`obj`。这不会阻止构建和销毁临时对象，但它会让您有机会稍微优化流程。

请注意，在您仅保留一个对象的裸例中，`int`实际上复制而不是移动或通过引用传递可能更快。

* * *

**`obj`通过引用传递到的示例`async`：**

```
void foo(const obj& a) {
    this_thread::sleep_for(chrono::milliseconds(500));
    cout << a.val << endl;
}

int main(int argc, int **args) {
    obj a(5);
    auto future = async(foo, std::cref(a));
    future.wait();

    return 0;
} 
```

* * *

**定义移动构造函数的示例：**

```
class obj
{
public:
    /* ... */

    obj(obj&& a) : val(move(a.val)) {
        // It is good practice to 0 out the moved object to catch use-after-move bugs sooner.
        a.val = 0;
    }

    /* ... */
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T16:42:45.310

`a`在绑定阶段被复制。为避免 a 的多个副本，请使用`move constructor`语义：

添加`move ctor`到`obj`：

```
class obj {
public:
    ...
    obj(obj&& other) {
        cout << "move obj" << endl;
        val = std::move(other.val);
    }
}; 
```

主要：

```
 obj a(5);
    auto future = async(foo, std::move(a));
    ... 
```

这样，仍然会创建 5 个 obj 实例，但由于异步支持`movable`对象，相同的副本将从一个实例移动到另一个实例（对于重的对象，这将比复制对象更重要）。所以现在输出应该是：

```
new obj
move obj
move obj
move obj
move obj
delete obj
delete obj
delete obj
5
delete obj
delete obj 
```

# r - 从 RStudio 到 Github 的回购

> ID：14912161
> 
> 赞同：20
> 
> 时间：2013-02-16T15:55:26.803
> 
> 标签：r, github, rstudio

我喜欢 github 和 RStudio 的工作流程。最近，我创建了一个项目模板，制作目录和脚本等，并想在本地创建并推送到 github。

过去，我通过[https://github.com/](https://github.com/)为项目创建了一个 repo，使用 RStudio 中的版本控制来创建本地 repo，然后转储我已经拥有的所有文件。

这似乎很浪费时间。如何使用 .Rproj 文件获取 RStudio 中已经存在的目录/存储库并上传到 github 而无需先在[https://github.com/](https://github.com/)创建 shell 存储库？

我认为这可以节省工作流程中的时间。

我想我可以按照指示[-here-](http://www.rstudio.com/ide/docs/version_control/overview)（在**将版本控制添加到项目**下）添加版本控制，但这不允许我推送到 github（也不应该因为 RStudio 怎么知道你想要哪个 git 站点推到）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-16T18:11:03.513

您可以直接从您的计算机在 github 上创建一个存储库，而不必先使用他们的网站创建它的唯一方法是直接从您系统上的 git 创建一个远程分支。这在某些 git 安装上是可能的，但在 Github 上却不行。

然而，Github 提供了一个 API，允许从命令行创建存储库，`curl`例如通过调用。[您将在此答案](https://stackoverflow.com/a/10325316/249691)（未经测试）中找到有关如何执行此操作的信息：

```
curl -u 'USER:PASS' https://api.github.com/user/repos -d '{"name":"REPO"}'
git remote add origin git@github.com:USER/REPO.git
git push origin master 
```

但我认为您不能直接从 RStudio 执行此操作：您需要将项目置于版本控制之下，然后在 shell 中执行答案中提供的三个命令。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-09T12:40:11.737

你见过[`hub`](http://defunkt.io/hub/)吗？

```
hub create
git push -u origin master 
```

`hub`一旦配置为访问您的 GitHub 帐户，将为您完成这项工作。如果您希望项目的名称与父目录的名称不同，请使用

```
hub create projectname 
```

一般用法是

```
hub create [NAME] [-p] [-d DESCRIPTION] [-h HOMEPAGE] 
```

（`-p`--私有存储库），您可以使用此工具访问更多 GitHub 功能。

# ios - ld：警告：找不到选项的目录-删除派生数据和清理项目不起作用

> ID：14912162
> 
> 赞同：9
> 
> 时间：2013-02-16T15:55:37.950
> 
> 标签：ios, xcode, warnings

我将我在 Xcode 中正在处理的应用程序的整个文件夹从我的计算机上的一个位置移动到另一个位置，并收到警告`ld: warning: directory not found for option`，然后是一条很长的路径。

我遵循了[Apple Mach-O Linker errors 的公认答案，我不知道该怎么做，](https://stackoverflow.com/questions/8706348/apple-mach-o-linker-errors-and-i-dont-know-what-to-do)但仍然收到相同的警告。

**编辑：**这是我收到的消息，以防相关：

```
Ld /Users/joel/Library/Developer/Xcode/DerivedData/GayHaikuTabbed-aszefnihmscxaachdbimtmeozapo/Build/Products/Debug-iphonesimulator/GayHaikuTabbed.app/GayHaikuTabbed normal i386
cd /Users/joel/Development/GayHaiku
setenv IPHONEOS_DEPLOYMENT_TARGET 6.0
setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -arch i386 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator6.1.sdk -L/Users/joel/Library/Developer/Xcode/DerivedData/GayHaikuTabbed-aszefnihmscxaachdbimtmeozapo/Build/Products/Debug-iphonesimulator -L/Users/joel/Development/GayHaiku/GayHaikuTabbed -L/Users/joel/Development/GayHaiku -F/Users/joel/Library/Developer/Xcode/DerivedData/GayHaikuTabbed-aszefnihmscxaachdbimtmeozapo/Build/Products/Debug-iphonesimulator -F. -FGayHaikuTabbed -FGayHaikuTabbedTests -F/Users/joel/Development/GayHaiku -F/Users/joel/Development/GayHaiku/../../../Downloads -F/Users/joel/Development/GayHaiku/../../Downloads -filelist /Users/joel/Library/Developer/Xcode/DerivedData/GayHaikuTabbed-aszefnihmscxaachdbimtmeozapo/Build/Intermediates/GayHaikuTabbed.build/Debug-iphonesimulator/GayHaikuTabbed.build/Objects-normal/i386/GayHaikuTabbed.LinkFileList -Xlinker -objc_abi_version -Xlinker 2 -fobjc-arc -fobjc-link-runtime -Xlinker -no_implicit_dylibs -mios-simulator-version-min=6.0 -framework Parse -framework Accounts -framework AdSupport -framework AudioToolbox -framework CFNetwork -framework CoreGraphics -framework CoreLocation -framework Foundation -framework Twitter -lsqlite3 -lz -lz.1.1.3 -framework MessageUI -framework MobileCoreServices -framework QuartzCore -framework Security -framework Social -framework StoreKit -framework SystemConfiguration -framework UIKit -o /Users/joel/Library/Developer/Xcode/DerivedData/GayHaikuTabbed-aszefnihmscxaachdbimtmeozapo/Build/Products/Debug-iphonesimulator/GayHaikuTabbed.app/GayHaikuTabbed

ld: warning: directory not found for option '-F/Users/joel/Development/GayHaiku/../../../Downloads' 
```

**编辑：** 原来清理项目会删除警告——但只有在我再次构建它之前，警告再次出现。我也尝试过删除派生数据，但什么也没做。:(

**编辑：** 嗯，库搜索路径和标题搜索路径是空的，但是框架搜索路径设置中有几个路径。我想尝试删除它们，但我担心我会破坏其他东西，因为在这一点上，我已经超出了我真正知道任何东西的真正含义的地方；我只是按下按钮并保持手指交叉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T00:03:00.417

好吧，它确实是框架搜索路径之一。我不确定我删除了哪些，也不确定是哪个负责，但如果您遇到此问题并且清除库和标题搜索路径不起作用，请尝试使用框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-24T13:29:55.113

# java - 在java中获取日期差异，使用getDate()

> ID：14912163
> 
> 赞同：1
> 
> 时间：2013-02-16T15:55:39.343
> 
> 标签：java

我正在与一个小组合作，我想问我如何从“2013 年 2 月 23 日星期六 00:00:00 GMT 2013”​​的格式中获取日期差异。pickerfrom 和 to 是一个日历，getDate 返回那个格式。我怎样才能得到天的日期差异？任何想法？

```
 /*   Current format  Sat Feb 23 00:00:00 GMT 2013  */
 Date date_from = pickerFrom.getDate();
 Date date_to = pickerTo.getDate();

 int date_diff = (int)((date_to)-(date_from)); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T15:58:26.360

结帐[获取java中日期之间的差异](https://stackoverflow.com/questions/3796841/getting-the-difference-between-date-in-days-in-java)

我的偏好是使用 Joda time - 它有许多有用的日期功能，在日期和日期操作方面会让你的生活更轻松

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T15:57:27.087

您可以获得每个日期的毫秒差值并减去这些值。

```
long diff = date_to.getTime() - date_from.getTime(); 
```

将返回两个日期之间的毫秒数。

然后，您可以使用类似[这样](https://stackoverflow.com/questions/12125311/how-to-convert-milliseconds-into-hours-and-days/12125375#12125375)的方法从这些毫秒中获取小时数、天数……。

# java - 从测试项目中读取错误的 persistence.xml

> ID：14912165
> 
> 赞同：0
> 
> 时间：2013-02-16T15:56:03.643
> 
> 标签：java, eclipse, jpa, junit, eclipselink

我有一个使用 EclipseLink 的 Java SE 项目。我想创建另一个项目来测试我的项目，现在我遇到了 persistence.xml 的问题。

我使用 Eclipse IDE 并设置项目。两者都有一个 src 文件夹作为 Link Source，并将主项目添加到测试项目的构建路径中。两个 src 文件夹都有一个 META-INF 子文件夹，其中包含 persistence.xml 文件。我想在运行测试时将主项目的 persistence.xml 替换为测试项目的。我尝试了很多选项，但似乎替换不是持久的......有时它有效，有时它不是。（在测试项目的 persistence.xml 中，我将标签更改为测试文件。）

我使用 JUnit4，当我运行一个测试用例时，替换似乎工作正常。但是，如果我尝试测试整个测试类，则以某种方式使用主项目的 persistence.xml 文件，而不是测试项目的文件。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:04:18.317

不确定，但尝试：

确保测试项目 B 的 jar 在类路径上项目 A 的 jar 之前。

# jquery - Jquery循环遍历xml列表并分配变量

> ID：14912167
> 
> 赞同：2
> 
> 时间：2013-02-16T15:56:38.440
> 
> 标签：jquery

我有以下脚本按预期工作，它检索 XML 列表并分配一些变量

```
$.ajax({
    type: "POST",
    url: "pgGeneral_login/validate.php",
    data: { user:user , pass:pass },
    dataType: "xml",
    success:loginval      });  

function loginval(data){
    console.log("Returned" )

    valid = $(data).find('valid').text();   
    name = $(data).find('name').text();     
    pass = $(data).find('pass').text();

    }; 
```

我想要做的不是为每个 xml 结果分配一个变量（valid = $(data).find('valid').text() ）而是遍历列表并将值分配给标签名称无需编写大量代码，如果是 php，我会使用类似

```
 foreach ($row as $k => $v)
            $$k = $v 
```

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:14:39.537

这会直接更新全局变量列表，不推荐。

干得好，

```
function loginval(data){
    console.log("Returned" )

    // valid = $(data).find('valid').text();   
    // name = $(data).find('name').text();     
    // pass = $(data).find('pass').text();

    $(data).children().each(function(){
        // Directly adding to the Global list
        window[this.tagName] = $(this).text();
    });

    console.log(valid);
    console.log(name);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T16:16:58.493

作为 ATOzTOA 代码的附录，这也将允许您将变量动态添加到全局范围（即在您的 AJAX 功能之外使用）。它使用了[大多数 JS 开发中通常避免](https://stackoverflow.com/a/86580/427992)[`eval()`](http://www.w3schools.com/jsref/jsref_eval.ASP)使用的功能：

```
// Array of fields you want to traverse
var array = ['text', 'name', 'pass'];

// This is the data object you get from your AJAX function
var vals = {
    text: 'Hello',
    name: 'John',
    pass: 'Password'
};

// Loop through and assign your vars
for (var i = 0; i < array.length; ++i) {
    var key = array[i];
    eval('var ' + key + ' = "' + vals[key] + '"');
}

console.log(text); 
```

认为这是一个有趣的问题，所以这个答案纯粹是为了提供一个替代（如果假设的）解决方案 - 如果将其用于生产目的，我会谨慎行事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T16:04:08.550

认为它不是您可以使用 php 实现的功能，但我认为它在某种程度上可以满足您的需求：

```
function loginval(data){
    console.log("Returned" )

    $dataList={};

    $(data).children().each(function(){
        $dataList[this.tagName]=$(this).text();
    });

    console.log($dataList )
} 
```

# actionscript-3 - 如何使用 MC 目标命中数组的 TestObject MC 项？

> ID：14912170
> 
> 赞同：0
> 
> 时间：2013-02-16T15:57:03.563
> 
> 标签：actionscript-3, flash, hittest

我有一个数组中的项目，每个都是一个动画剪辑，它以 1 秒的延迟间隔播放，一个由箭头键控制的目标动画剪辑（carTarget），其目的是避免与数组项（obstacleArray [i]）发生冲突。我一直在尝试创建一个 hitTestObject 语句以在发生碰撞时进行通知。但是我收到了诸如参数 hitTestObject 大多数是非空的错误并且无法弄清楚如何解决它。

```
//obstacles
function randomSort(a:*, b:*):Number
{
    if (Math.random() < 0.5) return -1;
    else return 1;
}
var obstacleArray:Array = [obstacleCar,obstacleCar2,obstacleCar3];
obstacleArray.sort(randomSort);

trace(obstacleArray);
trace(obstacleArray.length);

//OBSTACLE START DELAY
var timerPlay:Timer = new Timer(1000,1);
timerPlay.addEventListener(TimerEvent.TIMER, ontimerPlay);
timerPlay.start();

var i:int = 0;
var timerDelay:Timer = new Timer(1000, 3);
function ontimerPlay(evt:TimerEvent):void{

    obstacleArray[i].addEventListener(Event.ENTER_FRAME,checkHitTest);    
    //FOR EACH OBSTACLE
    timerDelay.addEventListener(TimerEvent.TIMER, ontimerDelay);
    timerDelay.start();
}

function checkHitTest(event:Event):void{
        if(carTarget.hitTestObject(obstacleArray[i]))
        {
            trace("HIT!");
        }
}

function ontimerDelay(evt:TimerEvent):void{
    obstacleArray[i].play();
    trace(obstacleArray[i]);
    i++;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:43:41.830

在您尝试使用它时，很可能 hitTestObject 不存在。从您共享的代码中，我看不到您在代码中创建它的位置。因此，假设 carTarget 是舞台上的一个对象，并且在您想要使用它时它具有属性或对象 hitTestObject 已初始化 - 假设这些东西，那么您需要确保当此代码运行时，该对象仍然存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T23:17:16.010

很可能，问题出在这段代码中：

```
function checkHitTest(event:Event):void{
        if(carTarget.hitTestObject(obstacleArray[i]))
        {
            trace("HIT!");
        }
} 
```

在 i 随计时器调用发生变化后， barrierArray[i] 将为 null 或更糟 - 另一个对象不是您需要检查的对象。

您应该将其更改为：

```
function checkHitTest(event:Event):void{
        if(carTarget.hitTestObject(event.target))
        {
            trace("HIT!");
        }
} 
```

event.target 将从 Enterframe 事件中调用 checkHitTest 获取当前障碍物

# c# - 如何使用 DoCmd.DeleteObject 删除 ms 访问查询对象

> ID：14912176
> 
> 赞同：2
> 
> 时间：2013-02-16T15:57:58.593
> 
> 标签：c#, ms-access

我正在尝试使用查询导出表，然后我想从 ms 访问文件中删除该查询对象，但它给了我错误 - 无法更新数据库。文件可能是只读的。

我的代码如下

```
MsAcs.OpenCurrentDatabase(newdb,false,"");
 MsAcs.AutomationSecurity = Microsoft.Office.Core.MsoAutomationSecurity.msoAutomationSecurityForceDisable;
                        MsAcs.DoCmd.TransferText(Microsoft.Office.Interop.Access.AcTextTransferType.acExportDelim, Type.Missing, "tmpExport", csvfile, true, Type.Missing, Type.Missing);

MsAcs.DoCmd.DeleteObject(Microsoft.Office.Interop.Access.AcObjectType, "tmpExport"); 
```

给出错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:42:51.757

[DeleteObject](http://msdn.microsoft.com/en-us/library/office/ff197376.aspx)期望`AcObjectType`枚举中的常量。而不是完整的枚举 ( `AcObjectType)`，`AcObjectType.acQuery`用作 的第一个参数`DeleteObject`，并将查询的名称用作第二个参数。

在 Access 应用程序会话中，我可以使用以下两种方法之一删除名为*tmpExport的查询：*

```
DoCmd.DeleteObject acQuery, "tmpExport"
CurrentDb.QueryDefs.Delete "tmpExport" 
```

但是，要使其中任何一个工作，数据库必须是可更新的，而不是只读的。因此，当这些方法有效时，`Debug.Print CurrentDb.Updatable`回复`True`.

如果我以只读方式打开数据库，则`CurrentDb.Updatable`回复`False`并尝试删除*tmpExport*会引发错误 3027，*“无法更新。数据库或对象是只读的。”*

不幸的是，我不知道如何将这些语句翻译成 c#。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T21:09:35.527

这两个都对我有用：

```
using Access = Microsoft.Office.Interop.Access;
<...>
   MsAcs.DoCmd.DeleteObject(Access.AcObjectType.acQuery, "query1"); 
```

并且删除表，是的，它是一个查询，但是，删除表。

```
 MsAcs.CurrentDb().Execute("DROP TABLE query2");  
   MsAcs.Quit(); 
```

确保任务管理器中没有从之前的测试运行的数据库。

# symfony - 如何在 Symfony 中设置 UTF-8？

> ID：14912177
> 
> 赞同：0
> 
> 时间：2013-02-16T15:58:01.887
> 
> 标签：symfony, utf-8

我不知道还能尝试什么；每次渲染树枝模板时，我都会得到这些符号：

> �</p>

例如，而不是“á”。

每个模板都扩展了一个“基础”模板，其中包含：

`<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />`

但仍然显示该符号。我检查了所呈现页面的源代码，并且该元标记行出现在那里。

我必须设置任何全局配置以避免这种情况吗？

谢谢！

编辑：请注意，我使用的是 TWIG。也许某些 Twig 参数配置错误？

![在此处输入图像描述](../Images/aecc5fd566ffe2bc7306d102a0a8976a.png)

* * *

## 回答 #1

> 赞同：-4
> 
> 时间：2013-02-16T15:59:55.177

您应该使用`&agrave;`，请参阅[html 特殊字符](http://www.utexas.edu/learn/html/spchar.html)

要动态执行此操作：查看 php 函数[htmlspecialchars()](http://php.net/manual/en/function.htmlspecialchars.php)

# xml - 使用 XSLT 样式化 RSS 提要，CDATA 标签的问题

> ID：14912179
> 
> 赞同：0
> 
> 时间：2013-02-16T15:58:16.817
> 
> 标签：xml, xslt, rss

我正在为 RSS 提要设置样式，但以下部分存在问题：

```
<description>
<![CDATA[
<img src="http://l.yimg.com/a/i/us/we/52/34.gif"/><br /> <b>Current Conditions:</b><br /> Fair, 73 F<BR /> <BR /><b>Forecast:</b><BR /> Sat - Clear. High: 78 Low: 62<br /> Sun - Mostly Sunny. High: 80 Low: 66<br /> <br /> <a href="http://us.rd.yahoo.com/dailynews/rss/weather/Dubai__AE/*http://weather.yahoo.com/forecast/AEXX0004_f.html">Full Forecast at Yahoo! Weather</a><BR/><BR/> (provided by <a href="http://www.weather.com" >The Weather Channel</a>)<br/>
]]>
</description> 
```

[你可以在这里](http://mayar.abertay.ac.uk/~0902221/r/grab.php)看到我的尝试

这是我的 XSLT：

```
<?xml version="1.0" encoding="iso-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="/">
<html>
  <head>
    <title></title>
  </head>
  <body>
    <table cellpadding="2" cellspacing="0" border="0" width="75%">
        <xsl:for-each select="rss/channel/item">

              <tr style="color:#0080FF;">
                <td style="text-align:left;font-weight:bold;">
                  <xsl:value-of select ="title"></xsl:value-of>
                </td>
                </tr>

                <tr style="color:#0080FF;">
                <td style="text-align:left;font-weight:bold;">
                  <xsl:value-of select ="location"></xsl:value-of>
                  <xsl:value-of select="pubDate"/>
                </td>
              </tr>

              <tr>
                <td colspan="2" style="text-align:left;padding-top:10px;">
                  <xsl:value-of select="description"/>
                </td>
              </tr>

          <tr>
            <td colspan="2" style="height:20px;">
              <hr></hr>
            </td>
          </tr>
        </xsl:for-each>
    </table>
  </body>
</html>
 </xsl:template>
</xsl:stylesheet> 
```

我正在尝试从描述标签中获取信息，这样我就可以像设置标题和发布日期一样设置它的样式。[这](http://weather.yahooapis.com/forecastrss?w=1940345)是我尝试设置样式的完整 XML RSS 提要。谁能帮我弄清楚为什么 CDATA 标签把事情搞砸了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:17:36.740

尽量不要使用`<xsl:for-each>`。当您依赖`<xsl:template>`和时，代码会变得更加清晰`<xsl:apply-templates>`。

还尝试使用 CSS 类并从输出 HTML 中删除内联样式。

如果您输出经典 HTML（不是 XHTML），那么通过使用`<xsl:output>`并输出一个 doctype 来告诉 XSLT 处理器。

Your output problem will be solved by using `disable-output-escaping="yes"`. Note that not every XSL processor supports that attribute. The ability to disable output escaping is optional as per the XSLT spec.

```
<xsl:stylesheet 
  version="1.0" 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
>
  <xsl:output method="html" indent="yes" 
     doctype-system='http://www.w3.org/TR/html4/strict.dtd'
     doctype-public='-//W3C//DTD HTML 4.01//EN' 
  />

  <xsl:template match="/rss">
    <html>
      <head>
        <title></title>
      </head>
      <body>
        <xsl:apply-templates select="channel" />
      </body>
    </html>
  </xsl:template>

  <xsl:template match="channel">
    <table cellpadding="2" cellspacing="0" border="0" width="75%">
      <xsl:apply-templates select="item" />
    </table>
  </xsl:template>

  <xsl:template match="item">
    <!-- ... -->
    <tr>
      <td colspan="2" style="text-align:left;padding-top:10px;">
        <xsl:value-of select="description" disable-output-escaping="yes" />
      </td>
    </tr>
    <!-- ... -->
  </xsl:template>
</xsl:stylesheet> 
```

# c++ - 由于在主函数之前创建了全局对象，因此从 rand() 获得完全相同的结果

> ID：14912180
> 
> 赞同：0
> 
> 时间：2013-02-16T15:58:17.283
> 
> 标签：c++, opengl, srand

我正在使用 rand 在 Windows、Visual Studio 2010 上获取一些“随机”数字。

在我已经包含并使用的主文件中：
`srand(time(NULL))`

在另一个文件中，在对象的构造函数中
（*对象是全局定义的，由于它在 OpenGL 函数（Init，Render）中的使用，*
我在我的笔记本电脑上调用 rand() % bound，10 次并得到相同的结果和桌面。

这应该是由于在从 main 播种 rand 之前创建的对象。

我怎样才能避免这种情况并保持对象是全局的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T15:59:46.970

在全局对象的构造函数中，`srand(time(NULL))`在使用`rand`. 或者，拥有另一个具有静态存储持续时间的非本地对象`srand(time(NULL))`。确保它在同一个翻译单元中定义，但在使用`rand`. 具有静态存储持续时间的非本地对象按定义顺序初始化。

# java - Java - 多个命令的优化调用

> ID：14912182
> 
> 赞同：2
> 
> 时间：2013-02-16T15:58:33.947
> 
> 标签：java, performance, optimization, command, command-line-arguments

**问题**
从 Java 程序调用多个命令的最有效方法是什么？

**背景**
我和我的团队的任务是创建一个程序，该程序最终在 UNIX 系统上调用一系列（从一百到一万，甚至更多）命令。这些命令不是简单的内置命令，而是已经安装在机器上的软件的一部分。因为这些命令相当耗费工作，而性能是我们软件成功的关键因素，所以我一直在研究从 Java 调用多个命令的最有效方法。不幸的是，我还没有找到一个从性能角度讨论调用多个命令的帖子、问题或论坛。

**知识**
我对Java中的IO非常熟悉，并且之前使用过`Runtime`，，`Process`和`ProcessBuilder`类。

**我在寻找什么我正在寻找关于**
如何最好地优化 Java 程序中多个命令的调用的高级或低级（仅限伪，如果是低级，请提供）解释。我无法在网络上发布我们的代码，但我不认为在这种情况下我们的代码是必要的。为方便起见，请随意假设我们调用的命令是`cmd`，它接受 arguments `-a arg0 -b arg1`。知道命令字符串是在程序的早期生成的，并且不会根据其他调用的结果而更改，这可能会有所帮助。知道所有调用的结果将是要添加到`ArrayList`.

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:25:26.117

我认为这里的主要问题是并行运行尽可能多的命令，这些命令可以有效地并行运行。这通常会比命令管理方式的任何差异在性能上产生更大的差异。

一般来说，我同意使用某种脚本并让 Java 直接运行仅脚本的解释器的想法。

特别是在这种情况下，我有时会使用并行 make。makefile 可以指定要运行的命令，以及它们之间的任何依赖关系。例如，在我需要进行数百次模拟的情况下，我的规则使原始模拟报告每个都依赖于模拟控制文件，而处理后的报告则依赖于原始报告。

Parallel make 可以在失败后轻松高效地恢复工作，而无需重做所有已成功完成的工作。它还可以管理将并行性限制为合理数量的线程。

# c# - 关于默认构造函数的困惑

> ID：14912183
> 
> 赞同：1
> 
> 时间：2013-02-16T15:58:38.543
> 
> 标签：c#, default-constructor

```
using System;
class Test
{
    string name;
    int num1, num2;

    public Test()
    {
        num1=10;
        num2=20;
    }

    public void Show()
    {
        Console.WriteLine(num1+num2);
        Console.WriteLine(name);
    }

}

class TestDemo
{
    static void Main()
    {
        Test ob = new Test();
        ob.Show();
    }
} 
```

混乱：

Complete Reference C# 3.0 说，如果您定义自己的构造函数，则不会调用默认构造函数。我做了那件事，但是没有用我定义的构造函数初始化字符串变量。现在根据上面的概念，字符串变量没有被初始化，并且没有默认的构造函数会运行给它一个默认值，因为我已经定义了我自己的。

那么，为什么它没有显示错误，该字符串没有用任何值或类似的东西初始化。它不是表明它已经从某个地方[编译器的默认构造函数]分配了一个值吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:02:15.220

没有“未初始化”字段（无论是静态的还是实例的）之类的东西。*所有*字段都使用默认值初始化（引用类型为 null，值类型为“自然零”）。

`readonly`如果你在构造函数中包含一个没有赋值的字段，编译器会给你一个警告，因为它*总是*有那个默认值——但它仍然是初始化的。

编译器只能在没有明确分配的情况下使用*局部变量时发现。*这是因为编译器在一个方法中比在一个类中的方法*之间*有更多的关于控制流的信息。如果您有一个方法将值分配给字段，而另一个方法从字段中获取值，则编译器无法知道首先调用哪个方法 - 而明确赋值的规则允许它分析一种方法来发现在没有先赋值的情况下读取变量的*潜在流。*

顺便说一句，这些都与默认构造函数无关。如果您根本不提供任何构造函数，编译器只会*提供*`Test`默认构造函数 - 因此在您的类中，没有*默认*构造函数，因为您提供了自己的无参数构造函数。即使编译器*确实*提供了默认构造函数，它也完全等同于：

```
public Test() {} 
```

...这些字段仍然只有它们的默认值。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-16T16:14:55.880

你的构造函数

```
 public Test()
  {
      num1=10;
      num2=20;
  } 
```

和

```
 public Test()
 {     
 } 
```

如果你想初始化`num1`and `num2`，你可以这样做：

```
private int num1, num2; //public fields are not recommended

public Test(int numberOne, int numberTwo)
{
    num1 = numberOne;
    num2 = numberTwo;
} 
```

您可以按如下方式进行初始化：

```
Test ob = new Test(10,20); 
```

# opengl - 关于 reshape 函数和 glupperspective 函数

> ID：14912187
> 
> 赞同：0
> 
> 时间：2013-02-16T15:58:51.323
> 
> 标签：opengl, glut

我是OpenGL的新手。我读了简单的代码。我有三个问题。

1-) 为什么在 reshape 函数中使用 gluperspective 函数？

2-) reshape 函数的真正作用是什么？当我使用重塑功能运行程序时，没有它，什么都没有真正改变。

3) 何时调用 reshape 函数？如果仅在我们更改窗口大小时调用它，这意味着如果我不更改窗口大小，则不会调用 reshape 函数，因此不会调用 gluperspective。但是不需要至少调用一次 gluperspective 吗？

抱歉英语不好，还有愚蠢的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T18:49:13.833

> 1-) 为什么在 reshape 函数中使用 gluperspective 函数？

因为这样的代码通常是由不懂 OpenGL 的白痴编写的。设置矩阵（全部）属于绘图代码。

> 2-) reshape 函数的真正作用是什么？当我使用重塑功能运行程序时，没有它，什么都没有真正改变。

reshape函数的正确使用是执行一次窗口大小变化时需要做的操作。例如，在后处理 FBO 等中重新初始化用作目标的纹理。如果您只是在屏幕上绘制一个三角形，则不需要重塑处理程序。

> 3) 何时调用 reshape 函数？如果仅在我们更改窗口大小时调用它，(...)

在创建窗口时也会调用它，因为这可以有效地将窗口从无到有调整为某个矩形。

> 这意味着如果我不更改窗口的大小，则不会调用 reshape 函数，因此不会调用 gluperspective。

创建一个新窗口也会（重新）调整它的大小。

> 但是不需要至少调用一次 gluperspective 吗？

如果您的愿望是 gluPerspective 投影，那么可以。从技术上讲，您必须做的是设置一些投影变换，这也可能是一个身份。

但不要在重塑处理程序中设置它。这样做属于绘图代码。

> 和愚蠢的问题

其实这些都是很好的问题。它们表明您实际上在考虑代码。我希望更多的人这样做:) 继续努力。

# file - 在 GAE Go 中上传文件

> ID：14912188
> 
> 赞同：0
> 
> 时间：2013-02-16T15:58:52.103
> 
> 标签：file, google-app-engine, upload, go

我正在尝试在我的 GAE 应用程序中上传文件。如何使用 Go 在 Google App Engine 中上传文件并使用`r.FormValue()`?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T17:22:29.577

您必须通过[Blobstore Go API 概述](https://developers.google.com/appengine/docs/go/blobstore/overview)来获得一个想法，并且有一个[完整的示例](https://developers.google.com/appengine/docs/go/blobstore/overview#Complete_Sample_App)说明如何使用 Go 在 Google App Engine 上存储和提供用户数据。

我建议你在一个完全独立的应用程序中做这个例子，这样你就可以在尝试将它集成到你现有的应用程序之前尝试一段时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-18T13:53:47.113

我设法通过使用中间返回参数“其他”来解决我的问题。下面的这些代码在上传处理程序中

```
blobs, other, err := blobstore.ParseUpload(r) 
```

然后分配对应的formkey

```
file := blobs["file"]
**name := other["name"]** //name is a form field
**description := other["description"]** //descriptionis a form field 
```

并在我的结构值赋值中像这样使用它

```
newData := data{
  Name: **string(name[0])**,
  Description: **string(description[0])**,
  Image: string(file[0].BlobKey),          
}

datastore.Put(c, datastore.NewIncompleteKey(c, "data", nil), &newData ) 
```

不是 100% 确定这是正确的，但这解决了我的问题，它现在正在将图像上传到 blobstore 并将其他数据和 blobkey 保存到数据存储区。

希望这也可以帮助其他人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T12:04:43.567

我已经尝试了这里[https://developers.google.com/appengine/docs/go/blobstore/overview](https://developers.google.com/appengine/docs/go/blobstore/overview)的完整示例，并且在 blobstore 中上传并提供服务时效果很好。

但是插入要保存在数据存储中某处的额外帖子值会擦除“r.FormValue()”的值吗？请参考下面的代码

```
func handleUpload(w http.ResponseWriter, r *http.Request) {
        c := appengine.NewContext(r)

        //tried to put the saving in the datastore here, it saves as expected with correct values but would raised a server error.

        blobs, _, err := blobstore.ParseUpload(r)
        if err != nil {
                serveError(c, w, err)
                return
        }
        file := blobs["file"]
        if len(file) == 0 {
                c.Errorf("no file uploaded")
                http.Redirect(w, r, "/", http.StatusFound)
                return
        }

        // a new row is inserted but no values in column name and description
        newData:= data{
          Name: r.FormValue("name"), //this is always blank
          Description: r.FormValue("description"), //this is always blank
        }

        datastore.Put(c, datastore.NewIncompleteKey(c, "Data", nil), &newData)

        //the image is displayed as expected
        http.Redirect(w, r, "/serve/?blobKey="+string(file[0].BlobKey), http.StatusFound)
} 
```

不能将上传与常规数据结合起来吗？为什么 r.FormValue() 的值除了文件（输入文件类型）之外似乎消失了？即使我必须在将 blobkey 关联到其他数据之前先强制上传，作为上传的结果，这也是不可能的，因为我无法将任何 r.FormValue() 传递给上传处理程序（就像我说的那样变为空，或者在 blob、_、err := blobstore.ParseUpload(r) 语句之前访问时会引发错误）。我希望有人能帮我解决这个问题。谢谢！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-24T21:58:22.527

除了使用 Blobstore API 之外，您可以只使用该`Request.FormFile()`方法来获取文件上传内容。使用[net\http](http://golang.org/pkg/net/http/#Request.FormFile)包文档获取更多帮助。

`blobstore.UploadUrl()`直接使用请求允许您在处理上传 POST 消息之前跳过设置。

一个简单的例子是：

```
func uploadHandler(w http.ResponseWriter, r *http.Request) {
    // Create an App Engine context.
    c := appengine.NewContext(r)

    // use FormFile()
    f, _, err := r.FormFile("file")
    if err != nil {
            c.Errorf("FormFile error: %v", err)
            return
    }
    defer f.Close()

    // do something with the file here
    c.Infof("Hey!!! got a file: %v", f)
} 
```

# javascript - 如何使用 Grunt.js 向输出文件添加消息？

> ID：14912189
> 
> 赞同：1
> 
> 时间：2013-02-16T15:58:55.797
> 
> 标签：javascript, coffeescript, gruntjs

我正在使用 grunt 将咖啡脚本编译为 javascript。我想在输出 js 文件的顶部添加一个简短的注释，说明它们是生成的不应编辑的文件，可能会列出它来自哪个 .coffee 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:48:17.610

如果您将所有代码编译成一个 js 文件 - 您可以使用 coffee 的加入功能，并在输出通知中加入一个文件。

如果您将每个咖啡脚本编译成一个单独的 js 文件，您可以[`concat`](https://github.com/gruntjs/grunt-contrib-concat/)在编译后使用该任务，并在每个生成的文件前面加上一个包含您的通知的文件。

# rest - RESTful 页面需要 GET 和 PUT？

> ID：14912190
> 
> 赞同：0
> 
> 时间：2013-02-16T15:59:05.367
> 
> 标签：rest, get, put

我的网站有一个显示记录网格的设计。对于每条记录，用户可以编辑它（一个 GET 请求）或更改它的状态（这*应该*是一个 PUT）。我有办法在不使用 Javascript 的情况下做到这一点吗？

也就是说，我目前的选择是：

*   在链接处理程序中使用 Javascript 根据需要更改请求类型。
*   将 GET 和 PUT 活动分隔为单独的网页。
*   通过 GET 进行状态更改，并在此处对 REST 规范视而不见。

还有其他选择吗？

谢谢，杰罗姆。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T14:30:03.140

GET 不应该有任何副作用，而 PUT 将替换 URI 给定位置处的整个资源。所以前者应该是一个POST。后者也应该如此，除非它确实发送了整个资源。显然，没有 Javascript 也可以进行 POST。

# qt - 将小部件添加到 Qsqlquerymodel

> ID：14912192
> 
> 赞同：1
> 
> 时间：2013-02-16T15:59:10.963
> 
> 标签：qt, pyqt

我想向 Qsqlquerymodel 添加一列复选框。复选框未链接到数据库。对于我正在尝试做的事情，使用代表似乎很低级。

我想使用的代码将基于 (PyQt) ：

```
model = QtSql.QSqlQueryModel()

model.insertColumn(2) #checkbox column

checkboxes = list() #Used later to check checkboxe state
for i in range(0, model.rowCount()):
    checkboxes.append((i, QtGui.QCheckBox())) #store row and checkbox in list
    model.addWidget(i, 2, checkboxes[-1][1]) #addWidget in row(i), col(2) does not exist :( 
```

*   是否可以不使用委托以使代码更简单？
*   我应该使用布局而不是在模型中包含复选框吗？
*   我错过了一个简单的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T16:54:33.637

我按照[Sibylle Koczian](http://www.mail-archive.com/pyqt@riverbankcomputing.com/msg18504.html)的工作对 QsqlQueryModel 进行了子类化。

```
class CheckboxSqlModel(QtSql.QSqlQueryModel):
    def __init__(self, column):
        super(CheckboxSqlModel, self).__init__()
        self.column = column
        self.checkboxes = list() #List of checkbox states
        self.first = list() #Used to initialize checkboxes

    #Make column editable
    def flags(self, index):
        flags = QtSql.QSqlQueryModel.flags(self, index)
        if index.column() == self.column:
            flags |= QtCore.Qt.ItemIsUserCheckable
        return flags

    def data(self, index, role=QtCore.Qt.DisplayRole):
        row = index.row()
        if index.column() == self.column and role == QtCore.Qt.CheckStateRole:
            #Used to initialize
            if row not in self.first :
                index = self.createIndex(row, self.column)
                self.first.append(row)
                self.checkboxes.append(False)
                return QtCore.Qt.Unchecked
            #if checked
            elif self.checkboxes[row]:
                return QtCore.Qt.Checked
            else:
                return QtCore.Qt.Unchecked
        else:
            return QtSql.QSqlQueryModel.data(self, index, role)

    def setData(self, index, value, role=QtCore.Qt.DisplayRole):
        row = index.row()
        if index.column() == self.column and role == QtCore.Qt.CheckStateRole:
            if value.toBool():
                self.checkboxes[row] = True
            else:
                self.checkboxes[row] = False
            self.dataChanged.emit(index, index)
            return True
        else:
            return False 
```

# spring - 安排春季活动

> ID：14912193
> 
> 赞同：0
> 
> 时间：2013-02-16T15:59:21.100
> 
> 标签：spring

我正在将 Spring MVC+Spring Data 与关系数据库一起用于 Web 应用程序。我需要做的是在午夜触发检查。特别是，我需要检查持久对象列表并检查它们是否在刚开始的那一天过期。

另外，我想在给定的时间间隔安排一些活动（例如每周一次）。

Spring 是否对此提供支持？

编辑：我的解决方案

```
@Service
public class MyWork implements Runnable {
    @Override
    public void run() {
        workToDo();
    }

    private void workToDo()  { /*do it*/}
}

@Service
public class MySchedulerInvoker {
    @Autowired
    private TaskScheduler scheduler;

    @Async
    public void executeTask() {
    scheduler.schedule(new MyWork(), new CronTrigger(
            "* 15 9-17 * * MON-FRI"));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:01:25.327

它确实并且非常易于使用 - 结帐[Sprint Tasks Execution and Scheduling](http://static.springsource.org/spring/docs/3.0.x/reference/scheduling.html)

# apache - 如何合并几个 HTAccess 重写？

> ID：14912194
> 
> 赞同：0
> 
> 时间：2013-02-16T15:59:27.793
> 
> 标签：apache, .htaccess, redirect, rewrite, clean-url

我的网站有以下 .htaccess 文件：

```
Options +FollowSymlinks
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)$ /$1.php [R=301,L,QSA] 
```

这有效，因为 url 'hello' 有效，以及 'hello.php'。但是，我想做的是以下内容：

1.  从“hello.php”中删除 .php 并重定向到“hello”。
2.  删除（并重定向）尾部斜杠（如果有）。

如何才能做到这一点？我想这很简单。

编辑：我只是在做这个，如果你浏览到'hello.p'，如果你浏览到'hello/'，它也有一个重定向循环。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T19:46:59.460

您当前的规则是指示 Apache 301 重定向到带有`.php`扩展名的路由。

为防止这种情况，您需要`R=301`从标志列表中删除 。

# c++ - C++ 中的指针；分段错误错误：

> ID：14912197
> 
> 赞同：0
> 
> 时间：2013-02-16T15:59:33.270
> 
> 标签：c++, pointers, segmentation-fault

我刚刚开始学习 C++，现在我正在使用指针。我不明白为什么会发生以下事情。

所以，假设我有两个类 A 和 B。A 有一个整数字段（int valueA），B 有一个指针字段（指向 A），A *a。下面我展示了这两个类。

```
class A{
   A::A(int value){
    valueA = value;
}

 void A::displayInfo (){
      cout<<A<<endl;
    }
 }

class B{

    B::B(){
    a=0;
  }

  void B::printInfo (){
       a -> displayInfo(); //Segmentation fault
     }

  void B::process(){
     A new_A = A(5);
     a = &new_A;
     new_A.displayInfo(); //correct output
     a -> displayInfo();  //correct output
     }
  } 
```

现在，在我的主类中，我执行以下操作：创建 B 类的实例并调用 process() 和 print() 函数。在输出中我得到：5（正确）、5（正确）和分段错误。谁能帮我理解为什么会这样？根据我目前对指针的理解，我做对了吗？

诠释主要（无效）{

```
B b_object();
b_object.process();
b_object.print(); 
```

}

* * *

为了清楚起见，我有一个 Ah 和 Bh 文件，我在其中声明“int valueA;” 和“A *a;” 分别。而且我知道没有指针可以更轻松地完成此操作，但我正在尝试了解指针如何在这里工作：D

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:11:21.047

```
 A new_A = A(5);
 a = &new_A; 
```

在这里，您创建`new_A`本地`process`并将其地址分配给`a`. 当`process`函数结束时，`new_A`超出范围并被销毁。现在`a`指向一个无效对象。

这里真正的解决方案是不使用这样的指针，但如果你真的必须使用，为了在函数结束之后有一些东西，你需要动态分配它。用`a = new A(5);`. 您需要确保您`delete a;`在程序的某个稍后时间点，否则动态分配的内存将被泄漏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:02:22.863

a 在 process() 中分配给局部变量，因此在 printInfo() 中无效

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:03:37.313

该变量`a`是您的方法的本地变量 - 在类级别声明它

# javascript - 如何在 jQuery 动画中连续旋转孩子？

> ID：14912200
> 
> 赞同：4
> 
> 时间：2013-02-16T15:59:47.420
> 
> 标签：javascript, jquery, jquery-animate

我有一个类 'bannergroup' 的 div，其中包含多个 div 'banneritem'。我希望这些项目相互旋转（淡入然后淡出）。

我可以有几个带有类bannergroup的div，每个div应该单独旋转。

这是HTML：

```
<div class="bannergroup">
  <div class="banneritem">Only visible one at a time</div>
  <div class="banneritem">Only visible one at a time</div>
  <div class="banneritem">Only visible one at a time</div>
  <div class="banneritem">Only visible one at a time</div>
</div>

<div class="bannergroup">
  <div class="banneritem">Only visible one at a time</div>
  <div class="banneritem">Only visible one at a time</div>
  <div class="banneritem">Only visible one at a time</div>
  <div class="banneritem">Only visible one at a time</div>
</div> 
```

我的 Jquery 看起来像：

```
$('.banneritem').css('display', 'none');
$('.bannergroup').children('.banneritem').each(function( i ) {
  $(this).fadeIn().delay(4000).fadeOut();               
}); 
```

问题：每个语句在前一个 div 完成之前继续运行。我希望它等到前一个孩子走了。另外，我需要它持续运行。一次后它停止。我可以将它放入一个函数中，但我不知道如何知道再次调用它。

*编辑*：并不总是有 4 个子项。此外，一组可能具有与其他组不同数量的孩子，但它们都应该同步旋转。如果一个在另一个之前完成然后重新启动就可以了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-16T16:22:06.787

[我之前已经](https://stackoverflow.com/a/11100098/417685)[多次](https://stackoverflow.com/a/14474778/417685) 回答过这个问题。这次我将尝试将它包装在一个 jQuery 插件中。该功能会将您想要的效果应用于匹配元素的子元素，在连续动画中每个子元素的淡入/淡出效果。`.rotate()`

```
$.fn.rotate = function(){
  return this.each(function() {

    /* Cache element's children */
    var $children = $(this).children();

    /* Current element to display */
    var position = -1;

    /* IIFE */
    !function loop() {

        /* Get next element's position.
         * Restarting from first children after the last one.
         */
        position = (position + 1) % $children.length;

        /* Fade element */
        $children.eq(position).fadeIn(1000).delay(1000).fadeOut(1000, loop);
    }();
  });
}; 
```

用法：

```
$(function(){
  $(".banneritem").hide();
  $(".bannergroup").rotate();
}); 
```

[看这里。](http://jsbin.com/usebef/2/edit)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:57:28.193

**[jsFiddle example](http://jsfiddle.net/j08691/ydxfQ/1/)**

```
$('div.bannergroup').each(function () {
    $('div.banneritem', this).not(':first').hide();
    var thisDiv = this;
    setInterval(function () {
        var idx = $('div.banneritem', thisDiv).index($('div.banneritem', thisDiv).filter(':visible'));
        $('div.banneritem:eq(' + idx + ')', thisDiv).fadeOut(function () {
            idx++;
            if (idx == ($('div.banneritem', thisDiv).length)) idx = 0;
            $('div.banneritem', thisDiv).eq(idx).fadeIn();
        });
    }, 2000);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:02:03.350

您可以通过 2 种方式解决此问题。下面是最简单的，使用索引来增加每个项目的延迟。

```
$('.banneritem').css('display', 'none');
$('.bannergroup').children('.banneritem').each(function( i ) {
  $(this).delay(4000 * i)).fadeIn().delay(4000 * (i+1)).fadeOut();               
}); 
```

# php - 使用 $mysqli->insert_id 分配主题以在论坛脚本中发布是否安全？

> ID：14912201
> 
> 赞同：1
> 
> 时间：2013-02-16T15:59:52.087
> 
> 标签：php, mysqli

我有一个论坛脚本，它为每个新主题创建一个“容器”，并将每个链接到该主题的帖子分配给它。

因此，当我打开一个新主题时，我的脚本会`forum_topics`在`forum_posts`.

在`forum_posts`其中放入*主题容器*的`parent`列。`id`

 *要知道谁是我正在创建的帖子的容器，我使用：

```
$mysqli->insert_id 
```

我想知道它是否安全，我认为对于同时打开一个新主题的两个用户......这是一个合理的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T16:09:32.097

是的，它是安全的。
每个 PHP 进程使用单独的连接，并且该变量包含来自该连接的插入 id*

# c# - WebSecurity.CreateUserAndAccount 属性值

> ID：14912208
> 
> 赞同：8
> 
> 时间：2013-02-16T16:00:41.663
> 
> 标签：c#, asp.net-mvc-4, entity-framework-5

我正在写一个 mvc 4 c# .net 4.5 网站

我想创建一个新的公司对象并注册一个链接到该公司的新用户。

我的帐户模型是：

```
 [Table("UserProfile")]
    public class UserProfile
    {
        [Key]
        [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
        public int UserId { get; set; }
        public string UserName { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public string EmailAddress { get; set; }
        public string PhoneNumber { get; set; }
        public bool MarketingEmailOptin { get; set; }
        public bool isDisabled { get; set; }
        public virtual Company CompanyICanEdit { get; set; } 
    } 
```

如果我调用以下内容，它将添加用户罚款但 CompanyICanEdit 字段为空：

```
WebSecurity.CreateUserAndAccount(addCompanyViewModel.User.UserName,
                                 addCompanyViewModel.User.Password,
                                 propertyValues: new
                                 {
                                   FirstName = addCompanyViewModel.User.FirstName,
                                   LastName = addCompanyViewModel.User.LastName,
                                   EmailAddress = addCompanyViewModel.User.EmailAddress,
                                   PhoneNumber = addCompanyViewModel.User.PhoneNumber,
                                   MarketingEmailOptin = addCompanyViewModel.User.MarketingEmailOptin,
                                   isDisabled = false
                                 }); 
```

我期望的，因为我没有分配任何东西。

我尝试添加（mycompany 是公司对象）：

```
 WebSecurity.CreateUserAndAccount(addCompanyViewModel.User.UserName,
                                 addCompanyViewModel.User.Password,
                                 propertyValues: new
                                 {
                                   FirstName = addCompanyViewModel.User.FirstName,
                                   LastName = addCompanyViewModel.User.LastName,
                                   EmailAddress = addCompanyViewModel.User.EmailAddress,
                                   PhoneNumber = addCompanyViewModel.User.PhoneNumber,
                                   MarketingEmailOptin = addCompanyViewModel.User.MarketingEmailOptin,
                                   isDisabled = false,
                                   CompanyICanEdit = mycompany
                                 }); 
```

但我收到一个错误，说它与类型不匹配。

如何注册用户以便 CompanyICanEdit 包含 mycompany 的 CompanyId 值？

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-20T18:45:45.303

从来没有弄清楚如何在 1 中完成它，如果有人遇到同样的问题，最后通过以下方法解决它。

```
//
// POST: /BusinessManager/ManageCompanies/Add
[HttpPost]
public ActionResult Add(AddCompanyViewModel addCompanyViewModel)
{
    if (ModelState.IsValid)
    {
        // Create company and attempt to register the user
        try
        {
            WebSecurity.CreateUserAndAccount(addCompanyViewModel.User.UserName,
                                                addCompanyViewModel.User.Password,
                                                propertyValues: new
                                                {
                                                    FirstName = addCompanyViewModel.User.FirstName,
                                                    LastName = addCompanyViewModel.User.LastName,
                                                    EmailAddress = addCompanyViewModel.User.EmailAddress,
                                                    PhoneNumber = addCompanyViewModel.User.PhoneNumber,
                                                    MarketingEmailOptin = addCompanyViewModel.User.MarketingEmailOptin,
                                                    isDisabled = false
                                                });

            db.Companies.Add(addCompanyViewModel.Company);

            var newuser = db.UserProfiles.FirstOrDefault(u => u.UserName == addCompanyViewModel.User.UserName);
            if (newuser != null)
            {
                newuser.CompanyICanEdit = addCompanyViewModel.Company;
                db.Entry(newuser).State = EntityState.Modified;
                db.SaveChanges();
                return RedirectToAction("Index");
            }
            else
            {
                ModelState.AddModelError("", "New user wasn't added");
            }                     
        }
        catch (MembershipCreateUserException e)
        {
            ModelState.AddModelError("", Mywebsite.Controllers.AccountController.ErrorCodeToString(e.StatusCode));
        }

    }

    return View(addCompanyViewModel);
} 
```

# c# - 在回发时创建对象的问题

> ID：14912209
> 
> 赞同：0
> 
> 时间：2013-02-16T16:00:53.037
> 
> 标签：c#, asp.net

我在 ASP.net 中创建对象时遇到问题

我的页面加载功能是：

```
public partial class hangMen : System.Web.UI.Page
{
abc ltr;
Words word = null;
static Label [] lbl = null;
static Button[] btn = null;
Game game;

protected void Page_Load(object sender, EventArgs e)
{

        if (Page.IsPostBack)
        {
            show_current_word();
            SetBord();

        }
        else
        {
            SetBord();
            SetWords(); 

        }

}
} 
```

我的问题是：我不确定我应该把游戏放在哪里 = new Game();

如果我把它放在其他部分所以我得到空引用异常。而且我也不想在每次回发时都创建这个对象。

这个对象计算玩家得分和点击“提示”并犯错的次数

有任何想法吗？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T16:08:24.220

如果我理解正确，您想`Game`通过回发保留对象的实例......

为此，我建议您使用[Session 对象](http://msdn.microsoft.com/en-us/library/ms178581%28v=vs.100%29.aspx)

保存到会话：

```
Session["GameObj"] = game; 
```

在下一次回发中恢复它：

```
protected void Page_Load(object sender, EventArgs e)
{
   if (Session["GameObj"] != null)
   {
       game = (Game) Session["GameObj"];
   }
    ... 
```

当然还有其他选项，例如将其保存在[ViewState](http://www.codeproject.com/Articles/31344/Beginner-s-Guide-To-View-State)中。您应该阅读它们，看看哪一个更适合您的需求

# python - 设置 Gtk.ComboBoxText 默认项？

> ID：14912210
> 
> 赞同：6
> 
> 时间：2013-02-16T16:00:58.480
> 
> 标签：python, linux, combobox, gtk, glade

我想让我的 ComboBoxText 中的一个项目成为默认值，而不是一个空白组合框，直到用户选择某些东西。显然，这是通过将 Glade 中的 Active 值更改为 [我想要默认的项目] 来设置的。这不起作用。

这是我的代码：

```
#! /usr/bin/env python3

from gi.repository import Gtk

builder = Gtk.Builder()

builder.add_from_file("./personalinfo.ui")

win = builder.get_object("window")
cancel = builder.get_object("cancel")
ok = builder.get_object("ok")

win.set_title("Persona")

win.connect("destroy", Gtk.main_quit)
cancel.connect("clicked", Gtk.main_quit)
ok.connect("clicked", Gtk.main_quit)

win.show_all()

Gtk.main() 
```

这是 Glade 中的组合框：

![组合框文本](../Images/051feb9d5a8b9edc376321ee05236827.png)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-18T09:46:28.050

这实际上是 Glade 中的一个错误。您可以使用以下方法手动设置：

```
combo.set_active(int) # 1st item is 0, 2nd is 1, etc. 
```

# php - 如何通过mysql在php中回显表

> ID：14912213
> 
> 赞同：0
> 
> 时间：2013-02-16T16:01:07.417
> 
> 标签：php, mysql

试图显示表格但不工作，我做错了什么？

```
<?php

$query = "SELECT id menu_id menu_title FROM tbl_menu";
$result = mysql_query($query);

if(mysql_num_rows($result) > 0){
    while ($row = mysql_fetch_array($result)){
        echo $row['menu_title'];echo 'test';
    }
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:04:04.790

```
$query = "SELECT id, menu_id, menu_title FROM tbl_menu"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:02:42.910

```
$result = mysql_query($query) or trigger_error(mysql_error()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:03:09.037

看起来你没有连接到任何东西。您还需要用逗号分隔列名：

```
SELECT id, menu_id, menu_title FROM tbl_menu 
```

[这是文档](http://php.net/manual/en/mysqli-result.fetch-assoc.php)中的一个`mysqli_`示例：

```
<?php
$link = mysqli_connect("localhost", "my_user", "my_password", "world");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$query = "SELECT id, menu_id, menu_title FROM tbl_menu";

if ($result = mysqli_query($link, $query)) {

    /* fetch associative array */
    while ($row = mysqli_fetch_assoc($result)) {
        echo $row[menu_id];
    }

    /* free result set */
    mysqli_free_result($result);
}

/* close connection */
mysqli_close($link);
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-16T16:04:02.007

```
$query = "SELECT id menu_id menu_title FROM tbl_menu"; 
```

一定是

```
$query = "SELECT id, menu_id, menu_title FROM tbl_menu"; 
```

您的 SQL 有错字

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-16T16:05:40.607

```
$query = "SELECT id, menu_id, menu_title FROM tbl_menu";
$result = mysql_query($query);

if($result && mysql_num_rows($result) > 0){
    while ($row = mysql_fetch_assoc($result)){
        echo $row['menu_title'];
    }
} 
```

要注意：

`mysql_fetch_array()`返回一个数字索引数组

`mysql_fetch_assoc()`返回一个字符串索引数组（索引是字段的名称）

请停止使用 mysql，它已被弃用。请改用[mysqli](http://www.php.net/manual/en/mysqli.construct.php)。

# linux - 为什么 tcpdump 使此代码能够工作？

> ID：14912217
> 
> 赞同：0
> 
> 时间：2013-02-16T16:01:19.383
> 
> 标签：linux, multicast, tcpdump

我有一个由 2 台主机（OS X 和 linux）组成的小型网络，它们之间有一个开关。当我运行以下程序对时，接收器 (linux) 看不到任何多播数据包。但是，当我跑步时

> tcpdump -i eth0 -s 512 udp

在 linux 机器上，一切都开始工作了。有人能告诉我为什么运行 tcpdump 可以让它工作吗？

请注意，两台机器都启用了 IPv6（如果重要的话）。代码中的主机地址是本地接口的 IPv4 地址。

在 OS X 机器上，我运行：

```
#include <time.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <arpa/inet.h>
#include <netinet/in.h>

#define BUFLEN  256

int                     s;
int                     count;
struct in_addr          local_address;
struct sockaddr_in      multicast_address;
char                    buffer[BUFLEN];

int
main (int argc, char *argv[]) {
        int             port = 12345;
        int             retval = 0;
        char            *host_ip = "192.168.1.31";
        char            *multicast_ip = "224.0.0.251";

        count = (int)time(NULL);

        s = socket(AF_INET, SOCK_DGRAM, 0);
        printf("s=%d\n", s);

        local_address.s_addr = inet_addr(host_ip);
        retval = setsockopt(s, IPPROTO_IP, IP_MULTICAST_IF, (char *)&local_address, sizeof(local_address));
        printf("setsockopt=%d\n", retval);

        memset((char *)&multicast_address, 0, sizeof(multicast_address));
        multicast_address.sin_family = AF_INET;
        multicast_address.sin_addr.s_addr = inet_addr(multicast_ip);
        multicast_address.sin_port = htons(port);

        while (1) {
                sprintf(buffer, "Message number %d", count);
                count++;

                retval = sendto(s, buffer, BUFLEN, 0, (struct sockaddr*)&multicast_address, sizeof(multicast_address));
                printf("sendto=%d\n", retval);
                sleep(3);
        }

        return 0;
} 
```

在 linux 机器上，我运行：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <arpa/inet.h>
#include <netinet/in.h>

#define BUFLEN          256

int                     s;
struct ip_mreq          multicast_group;
struct sockaddr_in      localSock;
char                    buffer[BUFLEN];

int
main(int argc, char *argv[]) {
        int             reuse = 1;
        int             retval = 0;
        int             port = 12345;
        char            *host_ip = "192.168.1.131";
        char            *multicast_ip = "224.0.0.251";

        s = socket(AF_INET, SOCK_DGRAM, 0);
        printf("s = %d\n", s);

        setsockopt(s, SOL_SOCKET, SO_REUSEADDR, (char *)&reuse, sizeof(reuse));
        printf("REUSEADDR = %d\n", retval);

        memset((char *) &localSock, 0, sizeof(localSock));
        localSock.sin_family = AF_INET;
        localSock.sin_port = htons(port);
        localSock.sin_addr.s_addr = INADDR_ANY;
        retval = bind(s, (struct sockaddr*)&localSock, sizeof(localSock));
        printf("bind = %d\n", retval);

        multicast_group.imr_multiaddr.s_addr = inet_addr(multicast_ip);
        multicast_group.imr_interface.s_addr = inet_addr(host_ip);
        retval = setsockopt(s, IPPROTO_IP, IP_ADD_MEMBERSHIP, (char *)&multicast_group, sizeof(multicast_group));
        printf("ADD_MEMBERSHIP = %d\n", retval);

        while (1) {
                retval = read(s, buffer, BUFLEN);
                printf("%d => [%s]\n", retval, buffer);
        }

        return 0;
} 
```

谢谢。

# multithreading - Qt 应用程序在删除执行的任务时崩溃

> ID：14912219
> 
> 赞同：0
> 
> 时间：2013-02-16T16:01:24.720
> 
> 标签：multithreading, qt, threadpool, qtcpsocket

我有多线程服务器（继承 QTcpServer）。当出现新连接时，我创建新任务（继承 QRunnable），将套接字描述符传递给构造函数并将此任务推送到 QThreadpool（有 3 个工作人员）。

```
QThreadPool::globalInstance()->start(task); 
```

在 run() 中，我动态创建 QTcpSocket，设置套接字描述符并读取第一个接收到的字节。基于这个字节的值，我创建了新的特定任务（也继承了 QRunnable），将它的 ctr 指针传递给早先创建的 QTcpSocket 对象，并将这个任务推送到 QThreadpool。

此特定任务会导致一些例行程序和应用程序崩溃。从日志文件中，我看到调用了这个特定任务的析构函数。

Qt Creator 还会引发下一条错误消息：

**QObject：无法为不同线程中的父级创建子级。（父级是 QNativeSocketEngine(0x18c62290)，父级线程是 QThread(0x18c603e0)，当前线程是 QThread(0x18cc3b60) QSocketNotifier：不能从另一个线程禁用套接字通知 QCoreApplication::sendEvent 中的断言失败：“无法将事件发送到一个拥有的对象不同的线程。当前线程 18cc3b60。接收器“”（类型为“QNativeSocketEngine”）是在线程 18c603e0”中创建的，文件 kernel/qcoreapplication.cpp，第 420 行**

我发现了类似的帖子，但不幸的是我不明白如何解决我的问题。请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T07:25:53.397

您不能`QTcpSocket`从两个不同的线程中使用，因为`QObject`s 不是线程安全的。

您已经`QTcpSocket`在第一个任务中创建了您的任务，因此它“存在”于与该任务关联的线程中。如果你将它的指针传递给另一个`QRunnable`，那么第二个线程将尝试访问它，这会破坏事情。

您需要重新设计您的应用程序，使其`QTcpSocket`在不同线程之间不共享相同内容。一种可能性是在您的原始任务中实现不同的特定功能，并根据收到的第一个字节简单地选择合适的功能

# ios - 与计数器的多对多关系（CoreData）

> ID：14912221
> 
> 赞同：0
> 
> 时间：2013-02-16T16:01:25.607
> 
> 标签：ios, core-data, nsfetchrequest

我有一个包含两个实体的项目 - 成分和菜肴，具有多对多的关系。在每道菜中，我都与食材保持联系。我试图为每道菜的每种成分设置一个正确数量的计数器（例如，菜“Omlet”应该有属性“2”的“鸡蛋”和属性“1”的“牛奶”......）。我正在努力为计数器建模的正确方法以及如何定义它，那里有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:08:31.147

您需要第三个实体对此进行建模。首先，删除你的多对多关系。然后创建一个名为`IngredientQuantity`（或任何你喜欢的）的新实体并添加一个整数类型的属性数量。现在，将两对一关系添加到`IngredientQuantity`. 第一个指向您的 Dish 实体，第二个指向您的 Ingredient 实体。

# ruby-on-rails - 添加 Rails 个别路线

> ID：14912229
> 
> 赞同：2
> 
> 时间：2013-02-16T16:02:05.343
> 
> 标签：ruby-on-rails, ruby, rails-routing

我在我的 routes.rb 文件中定义了一个 CRUD 资源：`resource :user`.

我正在为名为 的用户添加一个新的控制器方法，该方法对用户`search_places`执行以查找具有相同`place`s 的其他用户。我正在添加一条路线。

现在，我有：

`post '/user/search_place'`，这不是很干。我是 Rails 新手，我正在阅读 Rails 路由文档并认为我可以使用

```
resource :user do
  collection do
    post 'search_place'
  end
end 
```

这被认为是好的做法吗？我知道这行得通（它通过了我的 rspec 路由测试），但这是最好的做法吗？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:08:32.813

当你添加第二个不需要第一个。

添加这个：

```
 resources :user do
   collection do
     post 'search_place'
   end
 end 
```

删除这个：

```
 resources :user 
```

这使得`DRY`:)

建议：如果您遵循 Rails 约定，资源名称应以复数形式定义。（IE）`resources :users`

# objective-c - 将 CorePlot 与 OSX 一起用于 OSX 应用程序

> ID：14912233
> 
> 赞同：0
> 
> 时间：2013-02-16T16:02:35.653
> 
> 标签：objective-c, macos, cocoa, core-plot

一些背景：我正在为一些数值分析制作一个 Obj-C 项目，并想添加一个图表。我找到了 core-plot，将框架和 QuartzCore 框架添加到我的项目中没有问题。

我现在的问题是如何实际使用它 - 我有一个项目，它通过 Interface Builder (MainMenu.xib)、一个 AppDelegate 和另一个用于建模数学的类的接口。我已经搜索了互联网，只能找到在 iOS 中使用它的教程，这不是我正在做的 - 我不明白如何将其转换为 OSX。

我曾假设我会向 MainMenu.xib 添加一个自定义视图，并将其链接到一个新属性，使用类似于

```
@property (assign) IBOutlet NSView *graph; 
```

虽然现在我看着它，将 NSView 对象放在 NSObject 接口中似乎很愚蠢。

在此先感谢您的帮助！

更新 1：所以我将代码更改为

```
@property (assign) IBOutlet CPTGraphHostingView *graph; 
```

并将自定义视图的属性更改为相同的，CPTGraphHostingView。这两者现在已经联系起来了，我有一个叫做“graph”的插座可以玩。现在的挑战是将图表放入该空间。

再次感谢！

# php - 我的脚本使用更多内存来运行

> ID：14912235
> 
> 赞同：0
> 
> 时间：2013-02-16T16:02:40.190
> 
> 标签：php, memory-leaks

我使用了一些代码来限制在 while 循环中显示段落中的字符。

这是我的代码：

```
//mysqli_stmt_fetch ($stmt);    
while (mysqli_stmt_fetch($stmt)) {

      $position=70; // Define how many characters you want to display.      
      // Find what is the last character.
      $subject = substr($subjects,$position,1);

      if($subject !=" "){
         while($subject !=" "){
            $i=1;
            $position=$position+$i;
            $subject = substr($subjects,$position,1); 
         }
      }     
      $subject = substr($subjects,0,$position); 

      echo '<h4><span>Subjects / </span>'.$subject.'.....</h4>';   
} 
```

我的问题是运行此脚本时需要很长时间才能运行。如果我降低 $position 的值，则快速执行脚本，如果我增加 $position 的值，则需要很长时间才能执行。

如果它`$position=80`我不能让它工作。实际上它根本没有执行。我的 Windows 任务管理器显示它正在使用 100% 的物理内存。

谁能告诉我这是什么原因？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:44:08.487

如果我理解正确，您希望返回字符串的前 70 个字符，但在第一个空格字符处将其切断。

你可以使用这个：

```
function get_snippet($subject, $count) {

    // if string length is already under the desired char count
    if (strlen($subject) <= $count) return $subject;

    // find first space char after desired position
    $pos = strpos($subject, ' ', $count);

    if ($pos === false) return $subject;   // no space, must be end of the string so return entire text
    else return substr($subject, 0, $pos) . '...'; // return all chars up to first space
} 
```

调用它：

```
$newtext = get_snippet($subjects, 70); 
```

# android - Android 可搜索配置未附加到 SearchView

> ID：14912238
> 
> 赞同：4
> 
> 时间：2013-02-16T16:02:53.250
> 
> 标签：android, search, configuration, android-searchmanager, searchview

我目前正在为我的应用程序添加搜索功能，但我遇到了一些问题。首先，我想澄清一下我不想创建搜索活动，我只想使用操作栏 SearchView 并按下建议来执行搜索。

我创建了一个正确扩展的 SearchView，尽管它似乎无法附加到我的 Searchable Configuration xml 对象。我添加了这行代码：

android:voiceSearchMode="showVoiceSearchButton|launchRecognizer"

然而我的 SearchView 似乎并没有受到它的影响。这行代码也是如此：

android:hint="搜索我的东西"

再次，没有效果。

这是我在 AndroidManifest.xml 中的活动：

```
<activity
    android:name="com.simon.holocountownapp.ItemListActivity"
    android:label="Holo Countdown" >
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />

        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
    <intent-filter>
        <action android:name="android.intent.action.SEARCH" />
    </intent-filter>

     <meta-data
        android:name="android.app.searchable"
        android:resource="@xml/searchable" />
</activity> 
```

这是我在 onCreateOptionsMenu() 中对 SearchView 的设置：

```
searchView = (SearchView) menu.findItem(R.id.abSearch)
            .getActionView();

SearchManager searchManager = (SearchManager) getSystemService(Context.SEARCH_SERVICE);
searchView.setSearchableInfo(searchManager
            .getSearchableInfo(getComponentName()));

searchView.setIconifiedByDefault(false);
searchView.setQueryRefinementEnabled(true); 
```

所以总结一下：用于我的 searchable.xml 的标签似乎没有附加到我的 SearchView，我做错了什么？

感谢您花时间阅读本文，希望您能帮助我：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:23:32.403

您还需要添加`android.intent.action.SEARCH`意图过滤器。[请参阅此处](http://developer.android.com/guide/topics/search/search-dialog.html#DeclaringSearchableActivity)的代码以供参考。

```
 <intent-filter>
        <action android:name="android.intent.action.SEARCH" />
  </intent-filter> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T23:51:29.473

我认为您还需要一个`<meta-data>`元素作为元素的子`<application>`元素

```
<application>
        <meta-data
            android:name="android.app.default_searchable"
            android:value="com.simon.holocountownapp.ItemListActivity" >
        </meta-data>
</application> 
```

我不记得这是否记录在案。我想我在其中一个示例应用程序中找到了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-24T22:20:02.067

我遇到了同样的问题，似乎我在清单中缺少默认的可搜索元数据标签。

在声明将搜索发送到可搜索 Activity 的 Activity 的位置添加此内容：

```
<meta-data android:name="android.app.default_searchable"
            android:value=".SearchableActivity" /> 
```

您的清单应如下所示：

```
<application ... >
<!-- this is the searchable activity; it performs searches -->
<activity android:name=".SearchableActivity" >
    <intent-filter>
        <action android:name="android.intent.action.SEARCH" />
    </intent-filter>
    <meta-data android:name="android.app.searchable"
               android:resource="@xml/searchable"/>
</activity>

<!-- this activity enables the search dialog to initiate searches
     in the SearchableActivity -->
<activity android:name=".OtherActivity" ... >
    <!-- enable the search dialog to send searches to SearchableActivity -->
    <meta-data android:name="android.app.default_searchable"
               android:value=".SearchableActivity" />
</activity>
... 
```

[文档](https://developer.android.com/guide/topics/search/search-dialog#SearchDialog)

# css - COMPASS/SASS 如何将变量插入到@import "sprite/*.png" 路径？

> ID：14912243
> 
> 赞同：9
> 
> 时间：2013-02-16T16:03:28.987
> 
> 标签：css, sass, compass-sass

我在自己的（某种）SASS/COMPASS“框架”上工作。

我设置了一个变量 - $sprite - 这是存储所有图像的文件夹的名称。

我这样做是为了以后我可以使用该名称来替换图像混合和精灵生成。

如果 @import "#{$sprite}/*.png" 正常工作，一切都会很棒。

有任何想法吗？

```
 //sprite images folder name
        $sprite: "sprite";

    //settings
        $sprite-sprite-base-class: ".#{$sprite}" - *works*;
        $sprite-spacing: 20px;
        $sprite-sprite-dimensions: true;

    //generate sprite
        @import "sprite/*.png"; - normal path - *works*
        @import "#{$sprite}/*.png" - path with a variable in it - *doesn't work*

    //mixin        
        @mixin replace-with-image($imageName){
            @include replace-text-with-dimensions("#{$sprite}/#{$imageName}.png");
            @extend %dis-ib;
        } - *works* 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T12:13:45.723

恐怕目前这根本不可能（并且永远不会像[steveax 发布的问题那样](https://github.com/sass/sass/issues/49)）。如果你真的想要这个，你必须编写自己的小预处理器来解析你的变量，然后将它输出到一个 .sass/.scss 文件。或者，提交功能请求...

# html - 奇怪的 wamp bug 表在 IE 上没有边框

> ID：14912244
> 
> 赞同：0
> 
> 时间：2013-02-16T16:03:29.707
> 
> 标签：html, css, django, internet-explorer, wamp

我正在开发一个 django 项目，我最近部署了它。它在一个封闭的公司网络上，所以我不能给你看。

我所拥有的是一个展示数据的表格。我使用 css 进行边框折叠，然后在 tr 上添加了一个实心边框，因此每行之间有一条分隔线。

现在这在我使用开发服务器时工作正常，但是当使用 wamp 部署时，行之间没有边界。这仅在 IE（我们有 IE8）上发生，并且仅在使用 wamp 服务器时发生。在同一台计算机上，相同的 IE 和相同的代码 - 一切都适用于开发服务器

现在我要补充一点，我确实必须在某些时候使用 IE，但它仍然是 wamp 上的标准模式，我检查了。

我在 32 位 windows xp 和 Python2.6 上使用 wamp 5.1.7 和 Django 1.4，mod_wsgi33

任何帮助将不胜感激，因为这个错误让我无毛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T18:12:23.773

对于它认为是“Intranet”的站点，IE 将默认为“兼容模式”。我的猜测是它认为 localhost 是“Intranet”，所以它切换到 IE7 模式。您可以在此处阅读有关此内容的更多信息：[覆盖 Intranet 兼容模式 IE8](https://stackoverflow.com/questions/2518256/override-intranet-compatibility-mode-ie8)

简而言之，可以通过更改兼容模式设置（或从“Intranet”列表中删除您的站点）在每台计算机上修复它，或者可以通过在代码中添加正确的标题来修复它：`<meta http-equiv="X-UA-Compatible" content="IE=8" />`

# asp.net - 如何在 asp.net 中显示有关特定主题的最新推文？

> ID：14912246
> 
> 赞同：1
> 
> 时间：2013-02-16T16:03:37.427
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4, twitter

我想在网页中添加一个部分，其中将包含有关特定主题的最新推文的滚动列表。如何实现？

如果始终是同一个主题，是否会像在带有 URL 的网页中嵌入网页一样简单：

[http://topsy.com/s?q=%23marktwain](http://topsy.com/s?q=%23marktwain)

（用任何主题替换“marktwain”）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:07:23.330

您可以使用[Tweetsharp](https://github.com/danielcrenna/tweetsharp)来利用 twitter api

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T16:10:14.443

您可以创建一个[嵌入式时间线](https://dev.twitter.com/docs/embedded-timelines)，或者您可以尝试[实时推文](https://github.com/sergiomartino/jQuery-LiveTweet)- 一个 jquery 插件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T17:20:31.187

您将面临的问题之一是需要对所有查询使用 OAuth，这是 Twitter API v1.1 所要求的。Twitter 已弃用 API 的 v1.0，并将在下个月将其关闭之前开始进行停电。我也没有在 Twitter 的网页上看到任何网页小部件来执行此操作。

如果您将其嵌入到网页中，您将需要一个 JavaScript OAuth 库，这也意味着您的凭据必须在您的网页中——这是一种不安全的方法。

Silverlight 是一种可能性，但微软对 H​​TML/JavaScript 的关注使其未来处于可疑状态。此外，有人还可以反编译组件并获取您的凭据，这也是不安全的。

这使得服务器端解决方案成为最佳可能性。你可以通过拉或推来处理这个问题。SignalR 将是一个很好的推送方法，但代价是您需要一个持续运行的进程来立即更新。如果您运行自己的服务器，则可以通过 Windows 服务运行一个进程，该进程要么执行定期搜索查询，要么使用过滤器流并使用 SignalR 将结果推送到页面。在拉取方法中，您的页面可以运行一个带有 Ajax 查询的计时器返回服务器，收集新的推文并将它们显示在页面上。这些只是几个想法，但提供给您一个关于如何解决问题的想法。

Twitter 有一个您可以使用的[库列表。](https://dev.twitter.com/docs/twitter-libraries)我写了[LINQ to Twitter](http://linqtotwitter.codeplex.com/)，它也支持 Twitter API v1.1。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-19T23:52:45.310

我最近写了一些东西。希望这可以帮助。[https://devtasks.blogspot.com/2013/06/console-app-that-displays-twitter-feed.html](https://devtasks.blogspot.com/2013/06/console-app-that-displays-twitter-feed.html)

```
using System;
using System.Linq;
using LinqToTwitter;
using System.Threading;

namespace Linq2Twitter
{
    class Program
    {
        /// <summary>
        /// Controls the flow of the program.
        /// </summary>
        /// <param name="args">The args.</param>
        static void Main(string[] args)
        {
            // This is a super simple example that
            // retrieves the latest tweets of a given 
            // twitter user.

            // SECTION A: Initialise local variables
            Console.WriteLine("SECTION A: Initialise local variables");

            // Access token goes here .. (Please generate your own)
            const string accessToken = "Access token goes here .. (Please generate your own)";
            // Access token secret goes here .. (Please generate your own)
            const string accessTokenSecret = "Access token secret goes here .. (Please generate your own)";

            // Api key goes here .. (Please generate your own)
            const string consumerKey = "Api key goes here .. (Please generate your own)";
            // Api secret goes here .. (Please generate your own)
            const string consumerSecret = "Api secret goes here .. (Please generate your own)";

            // The twitter account name goes here
            const string twitterAccountToDisplay = "roeburg"; 

            // SECTION B: Setup Single User Authorisation
            Console.WriteLine("SECTION B: Setup Single User Authorisation");
            var authorizer = new SingleUserAuthorizer
            {
                CredentialStore = new InMemoryCredentialStore
                {
                    ConsumerKey = consumerKey,
                    ConsumerSecret = consumerSecret,
                    OAuthToken = accessToken,
                    OAuthTokenSecret = accessTokenSecret
                }
            };

            // SECTION C: Generate the Twitter Context
            Console.WriteLine("SECTION C: Generate the Twitter Context");
            var twitterContext = new TwitterContext(authorizer);

            // SECTION D: Get Tweets for user
            Console.WriteLine("SECTION D: Get Tweets for user");
            var statusTweets = from tweet in twitterContext.Status
                               where tweet.Type == StatusType.User &&
                                       tweet.ScreenName == twitterAccountToDisplay &&
                                       tweet.IncludeContributorDetails == true &&
                                       tweet.Count == 10 &&
                                       tweet.IncludeEntities == true
                               select tweet;

            // SECTION E: Print Tweets
            Console.WriteLine("SECTION E: Print Tweets");
            PrintTweets(statusTweets);
            Console.ReadLine();
        }

        /// <summary>
        /// Prints the tweets.
        /// </summary>
        /// <param name="statusTweets">The status tweets.</param>
        /// <exception cref="System.NotImplementedException"></exception>
        private static void PrintTweets(IQueryable<Status> statusTweets)
        {
            foreach (var statusTweet in statusTweets)
            {
                Console.WriteLine(string.Format("\n\nTweet From [{0}] at [{1}]: \n-{2}",
                    statusTweet.ScreenName,
                    statusTweet.CreatedAt,
                    statusTweet.Text));

                Thread.Sleep(1000);
            }
        }
    }
} 
```

# yaml - SuperCollider：将字典转换为 YAML

> ID：14912247
> 
> 赞同：0
> 
> 时间：2013-02-16T16:03:58.163
> 
> 标签：yaml, supercollider

SuperCollider 有一个可以创建嵌套字典的 String:parseYAML 方法：

```
"{44: 'woo'}".parseYAML

Dictionary[ (44 -> woo) ] 
```

但是如何走另一条路，输出一个给定（可能嵌套的）字典的 YAML 字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:45:47.887

[答案来自外面的其他人]

文件必须是可读的吗？

我一直在使用`JSON.stringify`Felix 的 API quark 为了与 Max MSP 应用程序共享字典。

这种方法的结果是不可读的，也就是说，它不会生成任何换行符和制表符等。所以它在文本文档中看起来很漂亮，但这不是我可以想象的方法设计的意图。

# html - 如何避免重叠的 HTML 标签突出显示文本

> ID：14912256
> 
> 赞同：1
> 
> 时间：2013-02-16T16:04:45.243
> 
> 标签：html, css

在下面的代码中，我有三个悬停文本和世界“你好”。“你好”的前两个突出部分，我希望第三个突出“你好”的所有部分。将所有前两个跨度包裹在第三个跨度中不起作用，我明白为什么。我知道我不能重叠 HTML 标签，我不知道嵌套是否是解决方案。

你将如何设置它以便第三次悬停工作？

[http://jsfiddle.net/CAWhP/3/](http://jsfiddle.net/CAWhP/3/)

这是HTML：

```
<div id="test1"> highlight hel in hello</div>

<div id="test2"> highlight lo in hello</div>

<div id="test3"> highlight all of hello</div>

<span class="testspan1"> hel</span><span class="testspan2">lo </span> 
```

这是CSS：

```
#test1:hover ~ .testspan1{

   background: red;
}

#test2:hover ~ .testspan2{

   background: red;
}
#test3:hover ~ .testspan3{

   background: red;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:09:03.903

选择相关元素

```
#test3:hover ~ span{
   background: red;
} 
```

[**演示**](http://jsfiddle.net/CAWhP/5/)

否则你也可以使用这个

```
#test3:hover ~ span.testspan1, #test3:hover ~ span.testspan2 {
   background: red;
} 
```

[**演示 2**](http://jsfiddle.net/CAWhP/7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:09:12.237

不知道你为什么要这样做，但为了解决这个问题，我想你可以这样做：

```
#test3:hover ~ .testspan1,
#test3:hover ~ .testspan2 {
   background: red;
} 
```

**完整且较短的版本：**

由于所有规则都应用相同的属性，因此您可以将完整的 CSS 缩短为：

```
#test1:hover ~ .testspan1,
#test2:hover ~ .testspan2,
#test3:hover ~ .testspan1,
#test3:hover ~ .testspan2
{
   background: red;
} 
```

[**工作示例**](http://jsfiddle.net/CAWhP/6/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:09:03.393

这是一种解决方法：[JSFiddle](http://jsfiddle.net/CAWhP/4/)

```
#test3:hover ~ .testspan1 {

background: red;

}

#test3:hover ~ .testspan2 {

background: red;

} 
```

您还可以使用逗号分隔类，例如`#test3:hover ~ .testspan1, #test3:hover ~ .testspan2`. 如果您希望两个跨度具有相同的样式，那将起作用。

# python - 尝试生成发现文档时出现 503 Service Unavailable

> ID：14912267
> 
> 赞同：0
> 
> 时间：2013-02-16T16:06:08.417
> 
> 标签：python, google-app-engine, http-status-code-503, service-discovery, google-cloud-endpoints

我正在使用 Google Cloud Endpoints，并且正在尝试生成一个发现文档来创建一个 iOS 客户端库，以便我可以测试我的端点。如文档中所述，我尝试使用此命令执行此操作：

```
endpointscfg.py gen_discovery_doc -o . -f rpc appfile.ApiClass 
```

与`appfile`并`ApiClass`更改为真实姓名。

当我运行它时，我得到：

```
urllib2.HTTPError: HTTP Error 503: Service Unavailable 
```

为什么要生成访问 Internet 的发现文档？为什么我会收到这个错误？我能做些什么来解决它？

PS 我已经检查了我的代码中的基本错误，例如消息类中的其他类型、错误的主机名等，但似乎没有任何问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T22:51:33.983

**RE：“为什么要生成访问互联网的发现文档？”**

您的 API 类被传递给该`ApiConfigGenerator.pretty_print_config_to_json` [方法](https://code.google.com/p/googleappengine/source/browse/trunk/python/google/appengine/ext/endpoints/api_config.py?r=317#711)以创建定义裸 API 配置的描述符。这个描述符被发送到一个 Web API，该 API 连接到 Google 的 API 基础设施，以从裸 API 配置创建一个发现文档。

**RE：“为什么我会收到这个错误？”**

您的 API 配置可能无效，这通常是由无效的 API 类定义引起的。当您尝试运行或部署应用程序时，是否有任何错误或堆栈跟踪？如果不是，则可能是运行 Web 服务以生成发现文档的代码中存在错误，我很乐意对其进行调查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-08T14:26:44.550

在生成发现文档时遇到类似问题后，

当某些事情与我的情况不一样时，将发生 503 错误，这是一个无效的 API 类定义。

确保 @Api() 定义以小写字符开头，否则将返回 503 错误。

例如

```
//@Api(name = "thisMustBeLowerCase") otherwise client libraries wont compile.

 @Api(name = "sampleEndpoint") 
public class SampleEndpoint {...} 
```

希望能帮助到你

# java - jsoup Socket超时异常

> ID：14912269
> 
> 赞同：3
> 
> 时间：2013-02-16T16:06:23.220
> 
> 标签：java, exception, jsoup

Jsoup 给出超时错误。我怎样才能解决这个问题？

给出错误的代码行是

```
Document doc;
doc = Jsoup.connect("http://google.com").timeout(300000).get(); 
```

我得到的例外是

```
java.net.SocketTimeoutException: Read timed out
    at java.net.SocketInputStream.socketRead0(Native Method)
    at java.net.SocketInputStream.read(SocketInputStream.java:150)
    at java.net.SocketInputStream.read(SocketInputStream.java:121)
    at java.io.BufferedInputStream.fill(BufferedInputStream.java:235)
    at java.io.BufferedInputStream.read1(BufferedInputStream.java:275)
    at java.io.BufferedInputStream.read(BufferedInputStream.java:334)
    at sun.net.www.http.HttpClient.parseHTTPHeader(HttpClient.java:633)
    at sun.net.www.http.HttpClient.parseHTTP(HttpClient.java:579)
    at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1322)
    at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:468)
    at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:412)
    at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:393)
    at org.jsoup.helper.HttpConnection.execute(HttpConnection.java:159)
    at org.jsoup.helper.HttpConnection.get(HttpConnection.java:148) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T18:03:20.293

我认为您在代理背后。如果您知道您的代理详细信息，您可以尝试以下操作：

```
System.setProperty("http.proxyHost", "147.167.10.2");//replace with your proxy host
System.setProperty("http.proxyPort", "8080");//replace with your proxy port
Document doc = Jsoup.connect("http://google.com").get(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-01T19:37:35.637

我对[jsoup 1.7.3](http://jsoup.org/packages/jsoup-1.7.3.jar)也有同样的问题。

Jsoup 似乎有一个错误，正如以下代码所证实的那样（从我的应用程序复制但没有经过单元测试，所以也许这个错误并不总是可重现的）：

```
Document doc;
URLConnection con = new URL("http://google.com").openConnection();
BufferedReader reader = new BufferedReader(new InputStreamReader(con.getInputStream()));
String html;
while ((html = reader.readLine()) != null) {
    System.out.println(url + ": "+ html);
}
doc = Jsoup.connect("http://google.com").timeout(300000).get(); 
```

# preg-match - 允许 az、AZ、0-9、空格和 -。预匹配

> ID：14912270
> 
> 赞同：1
> 
> 时间：2013-02-16T16:06:27.663
> 
> 标签：preg-match

如何使用 preg_match 允许 az、AZ、0-9 和空格。

我目前有以下内容：

`if (!preg_match("/^[_a-zA-Z0-9]+$/", $name))`

还有一个附带问题，你们中的任何人都知道学习 preg_match 的好指南吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-30T06:08:33.847

我认为这对你有用

```
 <?php
    $result = preg_match("/^[a-zA-Z0-9 \s]+$/", $name));
    ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:26:33.917

只需在括号中给出`space`和 示例`"-"``[ ]`

```
<?php
$name = "A- "; 
if(preg_match("/^[_a-zA-Z0-9- ]+$/", $name))
{
echo "hello";
}
?> 
```

和一个很好的学习网站：[链接](http://php.net/manual/en/function.preg-match.php)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2016-07-21T05:53:37.270

使用`/^[a-zA-Z'- ]+$/`显示以下给出的警告

> “preg_match()：编译失败：偏移 10 处的字符类范围乱序”

您可以使用`/^[a-zA-Z' -]+$/`. 这不会显示警告。！

# c++ - “const *int”或只是“int”作为函数参数。有什么区别？

> ID：14912278
> 
> 赞同：-3
> 
> 时间：2013-02-16T16:07:35.693
> 
> 标签：c++, function, reference, argument-passing

```
void test(const int* pInt) 
```

或者

```
void test(int pInt) 
```

我知道第一个示例使 pInt 受到某种保护。但是哪种解决方案可以提供更高的性能？因为两者（const 指针和普通 int）都必须在内存中注册。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:21:47.707

取决于你对函数内的参数做什么。如果您非常频繁地取消引用指针，那么您是间接的，并且将比您刚刚将值作为变量传递更多的工作。

您是否认为这种选择会在您的应用程序中导致性能折衷？你在你的函数实现中做了什么，为什么你认为一个可能比另一个更快？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:12:20.903

从技术上讲，第二个**可以**更快，因为第一个受别名影响 - 无法判断是否`pInt`在函数之外没有修改。仅仅因为在`pInt`方法`const`内部，并不意味着作为参数传递的原始变量必须是`const`- 记住非`const`转换`const`是隐式的。

`_restrict`如果编译器支持，将使用此问题的解决方法。请注意，这是固有的，而不是语言的一部分。

但在大多数情况下，它们是相同的。**简介简介简介**。编写代码以提高可读性，并且仅在您知道它们值得时才进行这些小的优化。

这适用于`int`- 如果您要传递一个大型结构，如果无法将复制省略应用于该特定情况，则按值传递可能会成为瓶颈。所以传递指针会更快，但我仍然会使用引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:38:50.813

> both examples pInt can not be changed inside the function!

Then you forgot a const to the second function. Realize that you can change pInt value as you wish in the second function, however since the whole thing was passed as value any changes there won't affect anything else.

Don't you want to do this?

> void test(const int pInt)

If you do that, you will have a const int to your function (that was passed as argument).

# r - 如何在R中获得矩阵的右特征向量？

> ID：14912279
> 
> 赞同：3
> 
> 时间：2013-02-16T16:07:37.540
> 
> 标签：r, function, eigenvector, eigenvalue

***版：***我的问题是我试图`S`从[方程 8](http://www.quarchome.org/correlationmatrix.pdf)中找到矩阵，但这个方程有错误。

如何直接获得 R 中矩阵的右特征向量？'eigen()' 只给出左特征向量

**真的是上一版**，我在这里搞得一团糟，但这个问题对我来说真的很重要：

`eigen()`提供了一些特征向量**矩阵**，来自函数帮助：

" 如果 'r <- eigen(A)' 和 'V <- r$vectors; lam <- r$values'，那么

```
 A = V Lmbd V^(-1) 
```

（直到数值模糊），其中`Lmbd =diag(lam)`“

也就是说`A V = V Lmbd`，其中 V 是**矩阵**现在我们检查它：

```
set.seed(1)
A<-matrix(rnorm(16),4,4)
Lmbd=diag(eigen(A)$values)
V=eigen(A)$vectors
A%*%V

> A%*%V
                      [,1]                  [,2]          [,3]           [,4]
[1,]  0.0479968+0.5065111i  0.0479968-0.5065111i  0.2000725+0i  0.30290103+0i
[2,] -0.2150354+1.1746298i -0.2150354-1.1746298i -0.4751152+0i -0.76691563+0i
[3,] -0.2536875-0.2877404i -0.2536875+0.2877404i  1.3564475+0i  0.27756026+0i
[4,]  0.9537141-0.0371259i  0.9537141+0.0371259i  0.3245555+0i -0.03050335+0i
> V%*%Lmbd
                      [,1]                  [,2]          [,3]           [,4]
[1,]  0.0479968+0.5065111i  0.0479968-0.5065111i  0.2000725+0i  0.30290103+0i
[2,] -0.2150354+1.1746298i -0.2150354-1.1746298i -0.4751152+0i -0.76691563+0i
[3,] -0.2536875-0.2877404i -0.2536875+0.2877404i  1.3564475+0i  0.27756026+0i
[4,]  0.9537141-0.0371259i  0.9537141+0.0371259i  0.3245555+0i -0.03050335+0i 
```

我想找到右特征向量矩阵`R`，
定义左特征向量矩阵的方程`L`是：

> ```
> L A  = LambdaM L 
> ```

定义右特征向量矩阵的方程`R`是：

> ```
> A R = LambdaM R 
> ```

并且 eigen() 仅提供矩阵`V`：

> ```
> A V = V Lmbd 
> ```

我想获得矩阵`R`和可能是负定`LambdaM`的实矩阵。`A`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-16T16:44:04.773

一个工作的例子。

默认值（=*右*特征向量）：

```
m <- matrix(1:9,nrow=3)
e <- eigen(m)
e1 <- e$vectors
zapsmall((m %*% e1)/e1) ## right e'vec
##          [,1]      [,2] [,3]
## [1,] 16.11684 -1.116844    0
## [2,] 16.11684 -1.116844    0
## [3,] 16.11684 -1.116844    0 
```

左特征向量：

```
eL <- eigen(t(m))    
eL1 <- eL$vectors 
```

（我们必须付出更多的努力，因为我们需要乘以左边的行向量；如果我们只提取一个特征向量，R 对行/列向量区别的无知将使其“做正确的事”（即`(eL1[,1] %*% m)/eL1[,1]` 只是工作）。）

```
zapsmall(t(eL1) %*% m/(t(eL1)))
##          [,1]      [,2]      [,3]
## [1,] 16.116844 16.116844 16.116844
## [2,] -1.116844 -1.116844 -1.116844
## [3,]  0.000000  0.000000  0.000000 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-16T16:40:19.270

这应该工作

给定一个矩阵 A。

```
lefteigen  <-  function(A){
  return(t(eigen(t(A))$vectors))
} 
```

每个左特征向量都是矩阵转置的右特征向量的转置

# javascript - 无需提交即可上传文件的脚本

> ID：14912280
> 
> 赞同：0
> 
> 时间：2013-02-16T16:07:38.207
> 
> 标签：javascript, html, file-upload

我有下面的代码来上传照片。我目前已经设置了流程，因此它会在单击提交按钮时上传。如何在没有提交按钮的情况下更改此代码以自动上传？谢谢

**HTML：**

```
<form data-ajax="false" id="imageform" action="imageup.php" method="POST" enctype="multipart/form-data" name="form">
    <a id="companylink" href="">
        <div id="yourBtn" onclick="getFile()" onchange="readURL(this);">
            <img id="companyprofileimg" src="image/<?php echo $row['photo']?>"/>
        </div>
        <span id="cetext"><?php echo $row['username']?></span>
    </a>
    <div style='height: 0px;width: 0px; overflow:hidden;'>
        <input id="upfile" type="file" value="upload" name="file" onchange="readURL(this);"/>
    </div>
    <a data-theme="g" data-ajax="false" data-role="button" id="imagesub" onclick="$('#imageform').submit();" aria-disabled="false">Upload Image</a>
</form> 
```

**JAVASCRIPT：**

```
 function getFile(){
   document.getElementById("upfile").click();
 }
 function sub(obj){
    var file = obj.value;
    var fileName = file.split("\\");
    document.getElementById("companyprofileimg").innerHTML = fileName[fileName.length-1];
    document.myForm.submit();
    event.preventDefault();
    document.getElementById('imageform').submit();
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:26:58.670

JavaScript：

`document.getElementById('imageForm').submit();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:41:03.983

试试这个

```
function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $('#companyprofileimg')
                .attr('src', e.target.result)
                .width(50)
                .height(50)
        };

        reader.readAsDataURL(input.files[0]);
        $('#imageForm')[0].submit();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T17:17:05.260

我刚刚想通了，我只是在输入中添加了提交 onchange，谢谢大家的帮助

# windows - Windows 服务器上的分析工具

> ID：14912281
> 
> 赞同：2
> 
> 时间：2013-02-16T16:07:49.027
> 
> 标签：windows, windows-server-2008, analytics

有几种工具可以帮助分析您网站上的用户行为。我倾向于将它们分为生活在自己的平台上并且可以通过 API 访问的那些（例如[Google Analytics](http://www.google.de/intl/de/analytics/)）和那些将安装在您自己的服务器上的（例如[Piwik](http://de.piwik.org/)）。

我将很快启动一个新的网络项目，它需要这样一个工具，因此我想知道我应该使用哪个。就我而言，我需要在自己的服务器上收集数据，所以我必须坚持使用第二种工具。在我的测试版服务器上玩了一点之后，我认为 Piwik 非常适合个性化，但直到现在，我在生产服务器上设置 piwik 时遇到了问题，因为它是一个 Windows 服务器，并且 piwik 版本可在windows server的webapp installer平台需要不同的php版本。

在另一个——比如说——分析服务器上安装 Piwik 对我来说不是一个选择，因为我不想创建所有这些`https`流量，只是因为我无法在我的生产服务器上设置它。而且我也不想购买另一个 https 证书；-)。

我浏览了 Windows Webapp 安装程序平台，希望能在 Windows 中开箱即用。类似的问题[也](https://stackoverflow.com/questions/1149064/google-analytics-like-tool)建议使用 Google Analytics 或 Piwik。但这不可能，不是吗？

所以..

1.  是否有所有 Windows Server 人员都使用的工具？
2.  还有其他经常使用的工具吗？
3.  甚至：是否可以在不使用 Windows Web App Installer 的情况下在 Windows Server 上设置 Piwik？我在[这里](https://serverfault.com/questions/477797/piwik-not-in-webapp)发布了一个相关的问题，重点是 piwik 的安装。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:21:26.217

Logparser 是 Microsoft 提供的免费工具，可让您将 SQL 查询直接发送到 Web 服务器上生成的 IIS 日志。您可以使用它来查询基本统计信息，例如：

[1] 我从哪个 IP 地址范围内获得最大查询？（用户的国家概况）

[2] 最常访问哪些特定页面 (aspx/html)？

[3] 在一天中的什么时间，我会收到最多的请求？

我记得在我早期的一个项目中使用过这个工具，但原因是为了追踪一些性能问题。此外，该工具本身是基于控制台的，因此您需要熟悉命令行。但是，GUI前端可以很容易地用C#等高级语言开发，我想应该已经有一些，可以免费下载

# java - JAVA .properties 文件

> ID：14912287
> 
> 赞同：1
> 
> 时间：2013-02-16T16:08:20.810
> 
> 标签：java

有一个 lil 问题，我创建了一个属性文件：

config.properties 位于 ../resource/config.properties

这是当前的文件：

```
destinationPDF=D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/
destination="D:/Documents/NetBeansProjects/printing~subversion/fileupload/Uploaded/
fileList =D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/Directory Files/directoryFiles.txt 
```

我完成属性文件了吗？

我也想访问这个文件并将变量加载到一个类中

我试过了

```
public void loadProp() {
    try {
        prop.load(new FileInputStream("../resources/config.properties"));
        System.out.println(prop.getProperty("destinationPDF"));
        System.out.println(prop.getProperty("destination"));
        System.out.println(prop.getProperty("fileList"));

    } catch (IOException ex) {
        ex.printStackTrace();
    }
} 
```

但是现在该类将无法编译，因为它例如找不到变量目标，那么我如何从文件中加载变量，我还需要清除类中的变量吗？

对不起，如果这些是愚蠢的问题，第一次使用属性！

如果我通常输入变量，我不会收到此错误

```
private String destinationPDF = "D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/"; //USE ON TORNADO//"D:/My Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/";//USE ON PREDATOR 
```

编辑：

现在有

```
private Properties configProp = new Properties();

public void loadProps() {
    InputStream in = this.getClass().getClassLoader().getResourceAsStream("../resources/config.properties");
    try {
        configProp.load(in);
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

编辑2：

```
public void loadProp() {
    InputStream in = this.getClass().getClassLoader().getResourceAsStream("../resources/config.properties");
    try {
        prop.load(in);
        System.out.println(prop.getProperty("destinationPDF"));
        System.out.println(prop.getProperty("destination"));
        System.out.println(prop.getProperty("fileList"));
    } catch (IOException e) {
        e.printStackTrace();
    }
}
Properties prop = new Properties();
private String destinationPDF = prop.getProperty("destinationPDF");
public String destination = prop.getProperty("destination"); 
```

它正在工作，没有错误等，但目的地和目的地PDF正在传递空值

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:26:31.980

您似乎误解了属性文件是什么。它们只是数据。它们不包含 Java 代码，也不用于声明变量。要获取与属性文件中的键关联的值`destinationPDF`，您需要调用

```
String destinationPDF = prop.getProperty("destinationPDF"); 
```

在初始化`prop`变量并使用`prop.load(new FileInputStream(...))`. 然后您将使用键的值初始化一个变量。

旁注：请尊重 Java 命名约定：变量以小写字母开头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:25:28.010

问题在这里：

```
 // destination = "D:/Documents/NetBeansProjects/printing~subversion/fileupload/Uploaded/";  // main location for uploads (CHANGE THIS WHEN USING PREDATOR)
        File theFile = new File(destination + "/" + username);
        theFile.mkdirs();// will create a sub folder for each user (currently does not work, below hopefully is a solution) (DOES NOW WORK)
        System.out.println("Completed Creation of folder");
        NewDestination = destination + username + "/"; 
```

您已经注释了目标变量，并且您在此处使用：

```
NewDestination = destination + username + "/"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:18:55.853

我想知道是什么问题...我测试了您的代码，它工作正常...您遇到编译错误还是运行时错误？

```
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Properties;

public class Test1 {

    /**
     * @param args
     */
    public static void main(String[] args) {
        new Test1().loadProp();
    }

    Properties prop = new Properties();

    public void loadProp() {
        try {
            prop.load(new FileInputStream("c:/Test/Computer.txt"));
            System.out.println(prop.getProperty("destinationPDF"));
            System.out.println(prop.getProperty("destination"));
            System.out.println(prop.getProperty("fileList"));

        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }

} 
```

输出：

D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/ D:/Documents/NetBeansProjects/printing~subversion/fileupload/Uploaded/ D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources /目录文件/directoryFiles.txt

# php - sql查询做特定的需求匹配

> ID：14912289
> 
> 赞同：0
> 
> 时间：2013-02-16T16:08:28.530
> 
> 标签：php, mysql, sql, allocation

所以我在使用 SQL 和 PHP 时遇到了一个小问题。我有一个 sql 数据库，它有 4 个表，即客户、请求、产品和卖家。现在，每个表都包含不言自明的数据。例如customers表列出了客户、id、姓名、地址、电子邮件等，products表有产品id和名称，requests表显示了客户对产品的请求`request id[pk], custID[fk from customer table], productid[fk in products table], quantites_requested, price_requested`。卖家表包含以下数据`sellersid[pk], customerid[fk from customer table], productsid[fk in products table], quantites_advertised, price_advertised`
现在我想做的是，假设客户要求 productid=1(chocolate),customer id=1, 10kg 已要求 10.00 英镑因此，此数据存储在数据库中。现在，可能有各种各样的巧克力卖家，我想做的是以最便宜的方式完成客户的订单，即 10 公斤的巧克力。通过合并卖家或选择一个最便宜的卖家。因此，例如，这是卖方表。注意：sellers 表的结构如下`sellerid[pk],customerid[fk],productid[fk],quantity_advertised, price_advertised`：所以这里有一些示例卖家...

```
1,2,1,4.00,2.00 -- This means customer id 2 is selling chocolates, for 4KG's @£2.00
2,3,1,5.00,2.50
3,4,1,1.00,1.00
4,5,1,10.00,6.00 
```

现在我们有我们的请求状态

```
1,1,1,10.00,5.00 -- i.e. customer1, wants chocolates of 10kg for £5.00... 
```

现在我希望完成客户 10 公斤的订单。所以我需要做的是为客户选择最便宜的价格。这可以通过选择卖家 2,3 和 4 来完成，其公斤数为 5,4 和 1kg=10kg，这将花费 2.00 英镑+2.50 英镑+1.00 英镑=5.50 英镑，然后卖家 5 可以以 6.00 的价格提供 10 公斤. 我相信我可以使用 SQL 查询来做这样的事情，它首先将客户请求的产品 id 与卖家的产品 id 相匹配，`SELECT c.Name, p.Name, s.quantity,s.price WHERE c.id=s.customerid AND p.id=s.productid AND s.quantity WHERE r.productid=s.productid FROM requests r, sellers s` 但是，我如何能够选择最便宜的选项供应商或组合或单个大型供应商以成为最具成本效益的？我相信我需要在查询中的某处使用 MIN ？

有人可以指导我如何按照所述构造查询。即需要以尽可能最便宜的方式满足客户的全部要求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:36:05.013

使用您当前的数据库设计（我仍然建议更改），您的查询将是这样的：

```
select s.name SellerName
, p.name ProductName
, s.price_advertised price

from sellers s join products p on s.productid = p.productid
join request r on r.productid = p.productid
join (
select sellerid sid
, min(price_advertised) LowestPrice
from sellers ss join request rr on ss.productid = rr.productid
group by sellerid
) sq on sid = s.sellerid and s.advertised_price = LowestPrice 
```

这是一个简单的例子。您必须对其进行修改以将请求与多个产品合并。

# linux - Linux untar 命令将文件名显示为问号

> ID：14912298
> 
> 赞同：1
> 
> 时间：2013-02-16T16:09:38.373
> 
> 标签：linux, tar

不久前，我使用 Linux 的“tar -cf”命令压缩了一个应用程序。当时，一些文件名使用不同的语言。

现在，当我使用“tar -xf”解压缩时，它会将另一种语言的文件名显示为问号。

有没有办法在我解压缩时保持原始文件名不变？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:55:37.837

Good question ! It's expected that like any Unix command, tar could pipe its output to another program, if possible including filename data. A quick googling reveals that this is the case: as described in this blog post, GNU tar supports the --to-command parameter to write the output to a pipe, instead of directly operating on the directory.

[http://osmanov-dev-notes.blogspot.com.br/2010/07/how-to-handle-filename-encodings-in.html](http://osmanov-dev-notes.blogspot.com.br/2010/07/how-to-handle-filename-encodings-in.html)

So it's a matter of writing a script to convert the filename to UTF-8, like it's done in the cited post. Another option, also described in the text, that becomes obvious after you read it is to simply extract everything and then write a script to convert every file in the directory. There's a trivial php script in the link that does this.

Finally, you can always write your own custom tar version with the help of scripting languages, and that's easy. Python, for example has the tarfile module built in the standard library:

[http://docs.python.org/2/library/tarfile.html#examples](http://docs.python.org/2/library/tarfile.html#examples)

You could use TarFile.extractfile(), shutils.copyfileobj() and str.decode() in a loop to manually extract the files while changing the file name encoding.

References:

[http://www.gnu.org/software/tar/manual/tar.html#SEC84](http://www.gnu.org/software/tar/manual/tar.html#SEC84)

[http://docs.python.org/2/library/tarfile.html](http://docs.python.org/2/library/tarfile.html)

[http://www.manpagez.com/man/1/iconv/](http://www.manpagez.com/man/1/iconv/)

# python - Python从字符串中的urllib拆分值

> ID：14912299
> 
> 赞同：0
> 
> 时间：2013-02-16T16:09:44.403
> 
> 标签：python, url, split, urllib2

我正在尝试从 ipinfodb.com 获取 IP 位置和其他内容，但我被卡住了。

我想将所有值拆分为新的字符串，以便以后可以按我想要的方式进行格式化。到目前为止我写的是：

```
resp = urllib2.urlopen('http://api.ipinfodb.com/v3/ip-city/?key=mykey&ip=someip').read()
    out = resp.replace(";", " ")
    print out 
```

在我将字符串替换为新字符串之前，输出是：

```
OK;;someip;somecountry;somecountrycode;somecity;somecity;-;42.1975;23.3342;+05:00 
```

所以我让它只显示

```
OK someip somecountry somecountrycode somecity somecity - 42.1975;23.3342 +05:00 
```

但问题是这非常愚蠢，因为我不想在一个字符串中使用它们，而是在更多字符串中使用它们，因为我现在所做的是`print out`它输出这个，我想改变它`print country`，`print city`它输出国家，城市等我尝试检查他们的网站，有一些课程，但它适用于不同的 api 版本，所以我不能使用它（v2，我的是 v3）。有谁知道如何做到这一点？

PS。对不起，如果答案很明显或者我弄错了，我是 Python 新手：s

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:11:18.827

您需要将`resp`文本拆分为`;`：

```
out = resp.split(';') 
```

现在`out`是一个值列表，使用索引来访问各种项目：

```
print 'Country: {}'.format(out[3]) 
```

或者，添加`format=json`到您的查询字符串并从该 API接收[JSON 响应：](http://ipinfodb.com/ip_location_api_json.php)

```
import json

resp = urllib2.urlopen('http://api.ipinfodb.com/v3/ip-city/?format=json&key=mykey&ip=someip')
data = json.load(resp)

print data['countryName'] 
```

# iframe - 当鼠标在 iframe 中时不要中断 addEventListener

> ID：14912306
> 
> 赞同：0
> 
> 时间：2013-02-16T16:10:20.320
> 
> 标签：iframe, addeventlistener

是否可以使用 addEventListener 来检测 iframe 内的鼠标点击？或者 iframe 是否意味着我们处理一个新文档？

```
mouseButton = false;

jQuery(document).ready(function()
{
    document.addEventListener('mousedown', function(){mouseButton = true;}, false);
    document.addEventListener('mouseup', function(){mouseButton = false;}, false);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-01T06:45:33.463

尝试在 document.contentWindow 上使用 addEventLister

# hibernate - Spring Data JPA + Hibernate：如何在线程之间共享 Hibernate 会话？

> ID：14912308
> 
> 赞同：2
> 
> 时间：2013-02-16T16:10:44.257
> 
> 标签：hibernate, jpa-2.0, spring-data

在涉及`@Entity`实例的计算中，一个线程 A 创建一个新线程 B。线程 A 持有对该实体的引用并将该引用传递给线程 B。

^(线程 A 负责处理单个 HTTP 请求、在存储库中查找实体并发送 HTTP 响应。
线程 B 负责一些涉及该实体的长时间运行的计算。
问：为什么我选择了两个线程？A：我不想要一个长时间运行的 HTTP 请求-响应周期；相反，我希望有一个快速的 HTTP 请求-响应周期，可以快速向我的用户响应“计算开始”。)

从线程 A 访问实体完美无缺。
但是从线程 B 访问实体不起作用：当我尝试访问实体关系（应该从 Hibernate 懒惰地获取数据）时，我得到了异常`org.hibernate.LazyInitializationException: could not initialize proxy - no Session`。

JPA/Hibernate 会话是否仅限于单个线程 - 即创建该会话的线程（在我的情况下是线程 A，因为这是查询我的存储库以获取实体的线程）？**如果是这种情况，我怎样才能让多个线程共享一个 Hibernate 会话，以便我可以从多个线程处理同一个实体？**

^(将我的实体的 relashionship 行为更改为“急切加载”不是一个可行的解决方案。我还在寻找一种对我的域类/实体无干扰的解决方案（例如，我不想在我的域类中使用`PersistenceContext`or`EntityManager`来重新附加分离的实体。)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:31:22.500

根据会话的 Javadocs，[会话](http://docs.jboss.org/hibernate/orm/3.5/javadoc/org/hibernate/Session.html)不打算由多个线程使用。在同时处理分离的实体之前，
您需要将对象从线程 A 中的会话中分离出来。`evict`请记住，`org.hibernate.LazyInitializationException`如果您需要尚未从数据库中读取的惰性属性，则会抛出此错误。
完成后，您需要调用`merge`以将实体重新附加到会话，然后保存它或其他。

# asp.net-mvc-4 - 从 Model 到 DTO 再到 ViewModel 似乎太多了

> ID：14912315
> 
> 赞同：0
> 
> 时间：2013-02-16T16:11:27.637
> 
> 标签：asp.net-mvc-4, model, viewmodel, dto

我知道 DTO 不是 ViewModel。误用时用法可以相同，但起源目的不同。

我将域实体从我的存储库返回到服务。在我的服务中，由于表格视图的需要，我必须重塑实体。

现在我有一个冲突。通常我的服务会返回一个带有数据的 DTO，但在这种情况下，由于表示层的需要，数据会被重新整形。有人可能会说 DTO 是一个 ViewModel，但我不想从我的服务中返回一个 viewmodel。

在这种情况下，DTO 是一个 ViewModel，好的行为丢失了，但是如果没有进一步的行为怎么办。

这里不对劲。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T18:27:58.760

感觉可能太多了，但不要忽视，现在可能正好*与*您想要在服务和 UI 级别生成的内容完全匹配。将这两部分分开但几乎相同并没有本质上的错误。

通常，ViewModel 会进一步扩展以支持计算字段、UI 选择选项等。在无需破坏您的服务（以及依赖它的任何人）的情况下，在路上扩展该不同的对象总是会更容易。

另一方面，我真的很喜欢跟随 YAGNI。所以，如果你真的相信这个物体不可能生长，回收一些东西并不总是很糟糕。（更多的上下文肯定有助于打这个电话）。

最后，不要花太多时间在它的学术上。你似乎对你想要完成的事情有一个很好的处理，唯一好的代码是交付的代码。编写测试，分离你能做的，但把代码拿出来。我见过一些项目因为过度设计而失败。

干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T14:04:53.977

我感觉到你的痛苦。我不使用“存储库”模式，但是我的服务层将 DTO 返回到我的控制器，然后在某些时候填充我的 ViewModel 中的大部分或至少一些属性。有时这似乎有些矫枉过正，并且总是提出“这是做事的最佳方式”的问题，从我被告知和研究的结果来看，答案是“是”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T17:47:46.633

我建议您在控制器中有一个 PresentationService ，该对象负责返回您的视图模型。然后，您的演示服务使用域服务、数据服务或您的存储库，或者您需要的任何其他东西来将数据聚合到您的视图模型。

如果来自数据库的形状是您想要的，那么您可以使用 DTO 作为视图模型，但如果不是，并且您有其他类型的数据投影，那么演示服务是一个很好的做法。

# windows - 在 windows x86 系统上执行期间，线程相对于其他进程结构存储在内存中的位置

> ID：14912317
> 
> 赞同：1
> 
> 时间：2013-02-16T16:11:35.083
> 
> 标签：windows, multithreading, memory-management, process, stack

所以一个过程是：

------DOS头/PE头

------可执行代码和静态链接库

------闲置空间？

------一些动态链接的库

------堆的开始

------闲置空间

------栈顶

------栈底

我不确定内核模式堆栈和用户模式堆栈在为进程堆栈分配的虚拟内存中相对于彼此的位置 - 另外，当多线程进程产生新线程时，为其分配的虚拟内存在哪里？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:16:36.930

在 x86 Windows 上，内核模式模块位于从 的（虚拟）内存空间中`0x80000000`，用户模式进程无法访问该内存空间，并且所有用户模式模块都位于之前的内存空间中`0x80000000`。

当一个新的（用户模式）线程被生成时，在用户模式内存空间（用户模式和内核模式都可以访问）和内核模式内存空间（只能访问）中为其堆栈分配一个新的内存页面从内核模式）。请注意，有些系统线程没有用户模式上下文（因此在任何用户模式进程中都没有分配堆栈）。这些线程纯粹在内核中运行，不在用户模式下运行。

# wpf - 在线程下运行外部.exe

> ID：14912320
> 
> 赞同：1
> 
> 时间：2013-02-16T16:12:01.247
> 
> 标签：wpf, c#-4.0, backgroundworker

我需要在我的 WPF 项目下运行一个外部 exe“ **embed.exe ”，**

这是一个片段

```
ProcessStartInfo processInf = new ProcessStartInfo("embed.exe");
processInf.Arguments = string.Format(@"Some arguments");
processInf.WindowStyle = ProcessWindowStyle.Hidden;
Process run = Process.Start(processInf); 
```

我的问题是它阻止了我的用户界面，

有没有办法使用线程或任何不会阻塞 UI 的代码来包含**embed.exe ？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:26:57.233

好的，

尝试将之前的代码片段放入方法中，然后创建一个新线程并将其初始化为该方法。

这是制作方法 //hone 代码

```
private void EmbedMethod()
{
ProcessStartInfo processInf = new ProcessStartInfo("embed.exe");
processInf.Arguments = string.Format(@"Some arguments");
processInf.WindowStyle = ProcessWindowStyle.Hidden;
Process run = Process.Start(processInf);
}

Thread embedThread=new Thread(EmbedMethod);
embedThread.start(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T02:32:38.793

您启动的进程在其自己的线程上运行，而不是您的应用程序用来启动它的线程。

要终止您的 embed.exe 进程，您需要保留对已启动进程的引用。在这种情况下，运行变量。要终止进程调用：run.CloseMainWindow() 或 run.Kill()。Kill 强制终止进程，而 CloseMainWindow 只请求终止。

# entity-framework - 如何将 EF5 导航属性定义为多种类型

> ID：14912321
> 
> 赞同：0
> 
> 时间：2013-02-16T16:12:07.510
> 
> 标签：entity-framework, entity-framework-5

我有一个我想在数据库中表示的共享类型。我需要先知道是否可以使用代码，或者它是否是糟糕的设计。（请指出你的推理来源）。

这是布局：

```
public class A
{
    public Guid Id;
    public Guid ParentId; // Points to either B or C
    public string Foo;
}

public class B
{
    public Guid Id;
    public virtual ICollection<A> ManyA { get; set; }
    // Other fields
}

public class C
{
    public Guid Id;
    public virtual ICollection<A> ManyA { get; set; }
    // Other fields
} 
```

我已经通过使用`[DatabaseGenerated(DatabaseGeneratedOption.Identity)]`注释来管理 GUID PK，我相信这将使这成为可能。

目标是保持`A`-table 简单；我不希望它有`B_Id`和`C_Id`列，因为我认为它们是不必要的，并且`D`将来可能会有一种类型，它*有很多`A`*就像`B`和`C`。此外，此方案用于其他一些关系。

我认为问题的精神很明显，但是特定于 EF 的类成员只是为了说明问题。如果他们需要改变，那就这样吧。

（我很抱歉这个人为的例子，但是暴露这个的真实性质，IMO，并没有澄清问题）。

另外，我试着搜索了几个小时！我不知道找到合适答案的正确命名法。一般来说，我对数据库和 EF 很陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:44:39.553

不用Guid做索引，为什么选择hard-way？:S

像示例一样使用 DataAnnotations：

一类：

```
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using System.Web.Mvc;

namespace app.Models
{
    [Table("A")]
    public class A
    {

        [Key]
        public int AId { get; set; }

        [Required(ErrorMessage = "Campo obrigatório")]
        [DisplayName("Title")]
        [StringLength(100)]
        public string Title { get; set; }
        public virtual ICollection<B> bCollection { get; set; } 
    }
} 
```

B类：

```
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using System.Web.Mvc;

namespace app.Models
{
    [Table("B")]
    public class B
    {
        [ScaffoldColumn(false)]
        [Key]
        public int BId { get; set; }

        [DisplayName("Description")]
        [StringLength(100)]
        public string Description { get; set; }

        public virtual ICollection<A> AList{ get; set; } 
    }
} 
```

您可以在此处查看更多详细信息：[链接](http://msdn.microsoft.com/en-us/data/ee712907)！！！有关 EF5 数据注释的更多详细信息：[链接](http://msdn.microsoft.com/en-us/data/jj591583)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T20:03:33.707

我发现我可以为`B`和类型创建一个通用的基本`C`类型。例如：

```
class Program
{
    static void Main(string[] args)
    {
        using (var context = new Ctx())
        {
            var b = new B();
            var c = new C();
            b.ManyA.Add(new A());
            c.ManyA.Add(new A());

            context.Cs.Add(c);
            context.Bs.Add(b);

            context.SaveChanges();
        }
    }
}

public class Ctx : DbContext
{
    public DbSet<A> As { get; set; }
    public DbSet<B> Bs { get; set; }
    public DbSet<C> Cs { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<BaseClass>()
            .HasMany<A>(b => b.ManyA)
            .WithRequired(a => a.BaseObject)
            .WillCascadeOnDelete(true);
    }
}

public class BaseClass
{
    public BaseClass() { ManyA = new HashSet<A>(); }

    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public Guid Id { get; set; }
    public virtual ICollection<A> ManyA { get; set; }
}

public class A
{
    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public Guid Id { get; set; }
    public BaseClass BaseObject { get; set; }
    public string Foo { get; set; }
}

public class B : BaseClass
{
    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public Guid Id { get; set; }
    public string SomeProperty { get; set; }
}

public class C : BaseClass
{
    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public Guid Id { get; set; }
    public int SomeOtherProperty { get; set; }
} 
```

并且，根据[这篇 Msdn 文章](http://msdn.microsoft.com/en-us/data/hh949853.aspx "Entity Framework 5 的性能注意事项")，将导致 Table Per Hierarchy 数据库布局。TPH 与 TPT 相比表现更好，我认为这可能是一个答案。

我真的希望有更简单的东西，但毕竟性能是底线

# wordpress - 您如何删除或更改自定义 WordPress 帖子上的“发布”按钮的功能？

> ID：14912324
> 
> 赞同：0
> 
> 时间：2013-02-16T16:12:21.987
> 
> 标签：wordpress

我有一个自定义帖子类型，当您单击“发布”按钮时，需要保持帖子状态不会设置为“已发布”。相反，它应该像保存草稿按钮一样工作。所以我要么需要弄清楚如何删除“发布”按钮，以便用户只能单击“保存草稿”，最好更新“发布”按钮功能，这样它就不会将帖子设置为发布。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T19:58:35.103

您可以使用 wordpress 操作挂钩来修改默认行为。 [http://codex.wordpress.org/Function_Reference/add_action](http://codex.wordpress.org/Function_Reference/add_action)

在您的情况下，您想使用 'publish_post' 挂钩。

所以你可以做

```
function dont_publish( $post_ID )  
{
     if(get_post_type($post_ID) == 'your_custom_type'){
         exit;
     }
}
//the dont_publish function will be called after the publish button is clicked
add_action( 'publish_post', 'dont_publish' ); 
```

如上所示，如果单击发布按钮，则不会发生任何事情，但是您可以使用 dont_publish 函数来获得所需的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T22:56:08.553

@PhoenixWing156 很接近，但有一点变化，所以其他帖子类型照常更新。

```
function dont_publish( $data , $postarr ) {  
  if($data['post_type'] == 'custom_post_type') {
    $data['post_status'] = 'draft';   
  }
  return $data;   
}  

add_filter('wp_insert_post_data' , 'dont_publish' , '99', 2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T21:52:28.033

在将有关帖子的信息保存到数据库之前调用 wp_insert_post_data 挂钩。 [http://codex.wordpress.org/Plugin_API/Filter_Reference/wp_insert_post_data](http://codex.wordpress.org/Plugin_API/Filter_Reference/wp_insert_post_data) 你可以试试：

```
function dont_publish( $data , $postarr )  
{  
  if($data['post_type'] == 'custom_post_type'){
      $data['post_status'] = 'draft';  
      return $data;
  }     
}  

add_filter('wp_insert_post_data' , 'dont_publish' , '99', 2); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-11-28T04:43:12.123

*WordPress 正是为此目的提供了 remove_meta_box() 函数。只需添加以下代码：-*

```
add_action( 'admin_menu', function () {
    remove_meta_box( 'submitdiv', 'Your_custom_post_type', 'side' );
} ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-24T12:09:15.027

您还可以禁用默认保存元框并添加您自己的。

这在 wordpress 的开发人员文档中没有很好地记录。

为此，您必须挂钩“add_meta_boxes”-hook，并且在挂钩函数中您必须调用 remove_meta_box('submitdiv','your-cpt','side'); 代码应该是这样的：

```
function your_cpt_metaboxes(){
    remove_meta_box('submitdiv','your-cpt','side');
     ...
}
add_action('add_meta_boxes','function your_cpt_metaboxes'); 
```

your-cpt 当然必须更改为您的 cpt 的名称。

我也在寻找这个方便的片段，并在插件 [Awesome Support](https://wordpress.org/plugins/awesome-support/)中找到了它。

原始保存元框代码可以在 /wp-admin/includes/metaboxes.php 中找到。只需搜索 post_submit_meta_box（在 WP 5.4 第 22 行）。

# c# - 找出图像列是否为空的最佳方法是什么？

> ID：14912327
> 
> 赞同：1
> 
> 时间：2013-02-16T16:13:02.990
> 
> 标签：c#, sql-server, image, ado.net, dbnull

**问题定义：** 我在 SQL Server 数据库中有一个表。该表有一列 image 类型，它允许空值。我将使用`SqlDataReader`并显示可用的图像来阅读此表。

**我第一次尝试的：**为了检查图像列是否为空，我这样做了

```
SqlDataReader reader = command.ExecuteReader();  // command is a SqlCommand

while(reader.Read())
{
    if(reader["Image"] != null)     // Image is a column name of the table
    {
        //Do something
    }
} 
```

**结果：**但它永远不等于 null（我也检查了`Equal`方法）。即使没有插入数据，该列也永远不会为空（在 SQL Server 中我可以看到它实际上是空的）

**我第二次尝试的：**所以我尝试了这段代码及其工作，但我想知道为什么它不返回 null。

```
SqlDataReader reader = command.ExecuteReader();  // command is a SqlCommand

while(reader.Read())
{
    if(reader["Image"].GetType() != typeof(System.DBNull)) 
    {
        //Do something
    }
} 
```

**问题：**有什么想法可以解释这种行为吗？如果有更好的方法来确定 SQL Server 表中 Image 类型的列是否为空，我会很高兴。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T16:18:56.143

你应该只检查`DbNull`这种方式。

```
if(reader["Image"] != DbNull.Value)     // Image is a column name of the table
{
    //Do something
} 
```

# javascript - 悬停时显示隐藏的导航栏但不是全宽

> ID：14912329
> 
> 赞同：0
> 
> 时间：2013-02-16T16:13:17.727
> 
> 标签：javascript, css

所以我找到了一个脚本，它允许我在外部 div 中隐藏一个 div。当外部 div 悬停在内部 div 上时出现。然而，外部和内部 div 在 CSS 中都设置为 100% 宽度，并且在没有脚本的情况下它们可以正常工作，跨越屏幕的整个宽度。使用脚本，它们仅跨越我设置的最小宽度。

这意味着是一个菜单栏，在最顶部跨越网站的整个宽度。

我想知道是否有人知道让`div`屏幕回到全宽的解决方案？希望这是我错过的简单事情。

```
<div id="menu_outer_wrapper" 
         onmouseover="document.getElementById('menu_strip_wrapper')
         .style.visibility = 'visible';" 
         onmouseout="document.getElementById('menu_strip_wrapper')
         .style.visibility = 'hidden';"> 
```

这是我的CSS：

```
#menu_outer_wrapper {
 height: 40px:
 width: 100%;
 float: left;
 position: relative;
 min-width: 800px;
} 

#menu_strip_wrapper {
 height: 40px;
 width: 100%;
 min-width: 800px; 
 background: #f1f1f2;
 border-bottom: 1px solid #ccc;
 position: relative;
 float: left;
 font-size: 1.3em;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:28:55.880

更改`:`为`;`，看看它是否会工作。

```
#menu_outer_wrapper { height: 40px: } 
```

[jsfiddle.net/7maCW/](http://jsfiddle.net/7maCW/)

# android - 将一个首选项条目设置为默认值

> ID：14912331
> 
> 赞同：0
> 
> 时间：2013-02-16T16:13:18.510
> 
> 标签：android, android-3.0-honeycomb, preferenceactivity

我正在寻找一种在 PreferenceActivity 中处理整数和 IP 类型首选项值的简单方法。这个想法是，捕捉 onSharedPreferenceChanged 监听器中的变化。如果该值不符合所需的类型，则应将其重置为默认值或更改前的值。

我的问题： - 如何使用默认值恢复共享首选项的单个值？- 是否有可能以简单的方式获得最后一个值？

提前致谢！

托马斯

# c++ - 使用二元运算进行转换 - G++ 无法编译，但 VS 可以

> ID：14912332
> 
> 赞同：-1
> 
> 时间：2013-02-16T16:13:31.460
> 
> 标签：c++, algorithm, compilation

下面的代码是我做的一个简单测试，看看我是否可以通过转换进行编译。该代码编译并在visualstudio上正确输出此答案：

```
firsta
secondb
thirdc 
```

但是使用 g++ main.cpp -o main 会给我这些错误：

```
main.cpp: In function 'int main()':
main.cpp:19:106: warning: lambda expressions only available with -std=c++0x or -std=gnu++0x [enabled by default]
main.cpp:19:107: error: no matching function for call to 'transform(std::vector<std::basic_string<char> >::iterator, std::vector<std::basic_string<char> >::iterator, std::vector<std::basic_string<char> >::iterator, std::vector<std::basic_string<char> >::iterator, main()::<lambda(const string&, const string&)>)'
main.cpp:19:107: note: candidates are:
/usr/include/c++/4.6/bits/stl_algo.h:4871:5: note: template<class _IIter, class _OIter, class _UnaryOperation> _OIter std::transform(_IIter, _IIter, _OIter, _UnaryOperation)
/usr/include/c++/4.6/bits/stl_algo.h:4907:5: note: template<class _IIter1, class _IIter2, class _OIter, class _BinaryOperation> _OIter std::transform(_IIter1, _IIter1, _IIter2, _OIter, _BinaryOperation)

#include <string>
#include <vector>
#include <algorithm>
#include <numeric>
#include <iterator>
#include <iostream>

using namespace std;

int main()
{
    vector<string> v, v2, v3;

    v.push_back("first"); v.push_back("second"); v.push_back("third");
    v2.push_back("a"); v2.push_back("b"); v2.push_back("c");
    v3.resize(3);

    transform(v.begin(), v.end(), v2.begin(), v3.begin(), [](const string &a, const string &b){return a + b;});
    copy(v3.begin(), v3.end(), ostream_iterator<string>(cout, "\n"));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:19:17.703

再次阅读此警告：

```
main.cpp:19:106: warning: lambda expressions only available with -std=c++0x or -std=gnu++0x [enabled by default] 
```

要在 GCC 中使用 C++11 功能，您需要在`-std=c++0x`使用 GCC 4.6 或更低`-std=c++11`版本以及 4.7 或更高版本时使用该选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:20:11.513

正是编译器消息所说的（**阅读它**）：

> 警告：lambda 表达式仅适用于 -std=c++0x 或 -std=gnu++0x

`-std=c++0x`添加标志后，这对我来说编译得很好。

# iphone - 为 iOS 开发者企业计划中的其他公司构建的 Ad Hoc Test

> ID：14912333
> 
> 赞同：1
> 
> 时间：2013-02-16T16:13:43.793
> 
> 标签：iphone, ios, ipad, ios-provisioning

我的公司注册了 Apple 的企业计划。我们正在为其他公司的员工进行演示/测试构建。[根据 Apple](https://developer.apple.com/support/ios/enterprise.html)的说法，我们不能使用企业程序将应用程序部署给其他公司的员工。但这是否包括**将 Ad Hoc 测试版本发送给其他公司的测试人员**？

[这个问题](https://stackoverflow.com/questions/5007954/using-ios-developer-enterprise-program-for-beta-testing)解决了一个非常相似但不相同的问题。我们不想使用企业计划来绕过任何 100 台设备的限制——我们对此没有任何问题。

这似乎是一个灰色地带。只要测试设备的适当 UDID 在配置文件中，TestFlight 就可以与我们发送的、使用企业计划创建的构建一起使用。但是，如果我们将测试版本发送给另一家公司的员工（即使配置文件中包含 UDID），这在技术上是否仍然“非法”？

~~我目前对这种情况的看法是，我们也应该注册常规开发人员计划，并使用常规计划来签署用于其他公司测试人员的 Ad Hoc 构建。正确的？~~

**更新**

我很确定乔纳森的回答是正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:52:17.810

我的理解是，企业计划既允许内部分发，也允许 100 台设备 Ad-Hoc 进行测试。我认为这里的关键是您不要将签名供内部使用的应用程序分发给外部“测试人员”，因为这将违反协议，而是确保您使用临时方法。

最好的乔恩

# c# - 如何旋转容器中的单个对象？

> ID：14912334
> 
> 赞同：0
> 
> 时间：2013-02-16T16:13:48.070
> 
> 标签：c#, winforms, rotation

你好我创建了一个旋转函数来旋转图形。

但是它会旋转容器对象中的所有内容（我的容器是 PictureBox）。

这是我的旋转功能：

```
public void RotateGraphics(PaintEventArgs e, float angle, PointF loc)
{
    e.Graphics.TranslateTransform(loc.X, loc.Y);
    e.Graphics.RotateTransform(angle);
}
public void SetOrigin(PaintEventArgs e, float objWidth, float objHeight)
{
    e.Graphics.TranslateTransform(-(objWidth / 2.0f), -(objHeight / 2.0f));
} 
```

这就是我绘制对象的方式：

```
e.Graphics.FillRectangle(new SolidBrush(Color.Red), recP2.X, recP2.Y, elWidth, elHeight); 
```

它工作正常，但我的问题是：我怎样才能只旋转一个矩形或容器内的任何东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:23:37.863

在绘制要应用变换的对象之前应用变换，然后重置变换：

```
 e.Graphics.DrawRectangle(Pens.Blue, 10, 10, 20, 20);
    e.Graphics.RotateTransform(20);
    e.Graphics.DrawRectangle(Pens.Red, 10, 30, 20, 20);
    e.Graphics.ResetTransform(); 
```

这样旋转仅适用于第二个绘图命令（红色矩形）。

# jquery - 在 Sortable 中使用自动完成时 jQueryUI 中的 Firefox 错误

> ID：14912339
> 
> 赞同：0
> 
> 时间：2013-02-16T16:14:19.433
> 
> 标签：jquery, jquery-ui, firefox

HTML：

```
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>jQuery UI Sortable - Default functionality</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
<style>
#sortable { list-style-type: none; margin: 0; padding: 0; width: 60%; }
#sortable li { margin: 0 3px 3px 3px; padding: 0.4em; padding-left: 1.5em; font-size: 1.4em; height: 18px; }
#sortable li span { position: absolute; margin-left: -1.3em; }
.ui-autocomplete-loading {
background: white url('images/ui-anim_basic_16x16.gif') right center no-repeat;
}
</style>

</head>
<body>
<ul id="sortable">
<li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 1</li>
<li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 2</li>
<li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 3</li>
<li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 4</li>
<li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 5</li>
<li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 6</li>
<li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 7</li>
<label for="tags">Tags: </label>
<input id="tags" />
</ul>
</body>
</html> 
```

Javascript：

```
$(function() {
$( "#sortable" ).sortable();
$( "#sortable" ).disableSelection();
 var availableTags = [
"ActionScript",
"AppleScript",
"Asp",
"BASIC",
"C",
"C++",
"Clojure",
"COBOL",
"ColdFusion",
"Erlang",
"Fortran",
"Groovy",
"Haskell",
"Java",
"JavaScript",
"Lisp",
"Perl",
"PHP",
"Python",
"Ruby",
"Scala",
"Scheme"
];
$( "#tags" ).autocomplete({
source: availableTags
});
}); 
```

请参考 Firefox 中的[http://jsfiddle.net/85Z92/](http://jsfiddle.net/85Z92/)。

你会发现，在 sortable 里面使用 Autocomplete 时，输入框是不能点击的。但是点击标签很好。如果没有标签，则无法单击输入字段。

在 Chrome/Safari 中，它工作正常。

如何解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:31:13.730

试试这个[http://jsfiddle.net/aiioo7/85Z92/3/](http://jsfiddle.net/adiioo7/85Z92/3/)

刚刚删除

```
$( "#sortable" ).disableSelection(); 
```

它得到了修复。

# php - 无论 If 语句如何，语句都运行

> ID：14912344
> 
> 赞同：0
> 
> 时间：2013-02-16T16:15:04.947
> 
> 标签：php, file-upload, if-statement

即使没有上传图像，也会执行“unlink()”方法，为什么会这样，我该如何解决？

```
If (isset($_FILES["image"]["name"])) {
    move_uploaded_file($_FILES["imageUp"]["tmp_name"],
        "C:/xampp/htdocs/" . $_FILES["image"]["name"]);
    //if (file_exists($delete)) {
        unlink($delete);
    }
    else {
    $img = $data['row']->image_name;
    }
//} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:23:53.667

```
isset($_FILES["image"]["name"] 
```

即使您是否上传文件，也将始终设置。`isset`检查事物是否已设置。所以它永远都是`true`。

所以你需要改变你的代码：

```
if (isset($_FILES["image"]["name"]) && !empty($_FILES["image"]["name"])) {
move_uploaded_file($_FILES["imageUp"]["tmp_name"],
    "C:/xampp/htdocs/" . $_FILES["image"]["name"]);
//if (file_exists($delete)) {
    unlink($delete);
} else {
    $img = $data['row']->image_name;
} 
```

请试试这个。希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:24:02.403

根据[php 文档 move_uploaded_file](http://php.net/manual/es/function.move-uploaded-file.php)返回`TRUE`是否一切正常以及`FALSE`是否有问题。

正如您所说，图像没有移动，因为 move_uploaded_file 正在返回`FALSE`。
您可以证明将代码更改为：

```
var_dump(move_uploaded_file($_FILES["imageUp"]["tmp_name"],
    "C:/xampp/htdocs/" . $_FILES["image"]["name"])); 
```

并看到正在返回的内容。

`move_uploaded_file`在以下情况下将返回 FALSE：

1.  目的地不存在
2.  服务器没有足够的权限将文件移动到目标
3.  该文件没有上传，因为它比 php.ini 变量大`upload_max_filesize`
4.  该文件没有上传，因为它比 php.ini 变量大`post_max_size`

检查并纠正所有这些点，它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:30:46.693

执行的真正原因`unlink()`是您禁用了 if 条件

`if (file_exists($delete))`通过使用`//`.

这是代码，您可能要编写：

```
if (isset($_FILES["image"]["name"]) && is_uploaded_file($_FILES['image']['tmp_name'])) {
    move_uploaded_file($_FILES["image"]["tmp_name"],
        "C:/xampp/htdocs/" . $_FILES["image"]["name"]);
    if (file_exists($delete)) {
        unlink($delete);
    } else {
        $img = $data['row']->image_name;
    }
} 
```

并确保`$delete`保存！想象一下如果`$delete`等于' `C:\users\your-name\some-private-file`'。如果您需要更多帮助，请向我们提供围绕此代码段的更多代码。

# android - 在 GridView 中展开单元格

> ID：14912347
> 
> 赞同：1
> 
> 时间：2013-02-16T16:15:51.313
> 
> 标签：android, gridview

我有几个以矩形网格排列的视图（使用 GridView）。现在我想扩展点击视图，使其占据整行（即视图应该在一个或两个方向上增长取决于列，如下图中的红色箭头所示）。过渡应该是动画的。

有什么更好的方法：修改网格内的视图或在 GridView 顶部显示另一个视图并调整其大小以覆盖选定的行？

![矩形网格](../Images/ae83774053df25bb48e1f1354d70da81.png)

# perl - 使用 Perl 检测操作系统类型

> ID：14912348
> 
> 赞同：6
> 
> 时间：2013-02-16T16:15:57.007
> 
> 标签：perl, operating-system

我想使用 Perl 来检测操作系统类型。

例如：

假设我有一个安装程序，以便知道安装程序需要运行哪些命令。我必须检测安装了什么操作系统，例如 Linux。假设它是Linux。现在是哪种类型的 Linux？

*   软呢帽
*   Ubuntu
*   中央操作系统
*   Debian
*   等等

我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-16T16:25:27.143

第一步是检查`$^O`变量的输出。

如果输出是例如

> linux

您需要更多处理来检测使用了哪个分布。

见`perldoc perlvar`。

到目前为止，您可以运行`lsb_release -a`以查看使用了哪个发行版。

如果此命令不存在，您可以测试以下文件是否存在：

```
/etc/debian_version # debian or debian based
/etc/redhat-release # rpm like distro 
```

其他文件测试示例：*[Detecting Underlying Linux Distro](http://www.novell.com/coolsolutions/feature/11251.html)*

* * *

也考虑使用该模块检查分布的[xaxes 解决方案。](https://stackoverflow.com/questions/14912348/detect-os-type-using-perl/14912448#14912448)`Linux::Distribution`

* * *

如果要检测*包管理器*，可以尝试这种方法：

```
 if ($^O eq "linux") {
     my $pm;

     do{
         if (-x qx(type -p $_ | tr -d "\n")) {
             $pm = $_;
             last;
         }
     } for qw/apt-get aptitude yum emerge pacman urpmi zypper/;

     print $pm;
 } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-16T16:31:12.997

此外，您可以使用 Config（它是一个核心模块）。这是一个例子：

```
use Config;
print "$Config{osname}\n";
print "$Config{archname}\n"; 
```

在我的 Mac OS X 上，它打印：

```
darwin
darwin-2level 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-16T16:32:58.020

根据[perlvar](http://perldoc.perl.org/perlvar.html)，要么 要么`$OSNAME`会给`$^O`你操作系统。这也等同于使用`$Config{'osname'}`（更多信息请参见[配置](http://perldoc.perl.org/Config.html)）。Windows 系统的特别说明：

> 在 Windows 平台中，`$^O`它不是很有帮助：因为它始终是*MSWin32*，它不能区分 95/98/ME/NT/2000/XP/CE/.NET 之间的区别。使用`Win32::GetOSName()`or `Win32::GetOSVersion()`（参见[Win32](http://search.cpan.org/perldoc/Win32)和[perlport](http://perldoc.perl.org/perlport.html)）来区分变体。

为了获得 Linux 机器的确切平台，您需要使用他的回答中提到的 xaxes 之类的模块。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-16T16:25:28.050

要确定您的脚本在哪个操作系统上运行，您可以使用`$^O`：

```
print $^O 
```

和[Linux::Distribution](http://search.cpan.org/~chorny/Linux-Distribution-0.21/lib/Linux/Distribution.pm)检查发行版：

```
use Linux::Distribution qw(distribution_name distribution_version);

my $linux = Linux::Distribution->new;
if (my $distro = $linux->distribution_name()) {
      my $version = $linux->distribution_version();
      print "you are running $distro, version $version\n";
} else {
      print "distribution unknown\n";
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-09-11T22:03:38.260

这在 Redhat 或 CentOS 上运行良好，很容易调整给其他人......

```
# Test for release file
my $release_file="";
if ( -e "/etc/redhat-release" ) {
  $release_file="/etc/redhat-release";
} elsif ( -e "/etc/centos-release" ) {
  $release_file="/etc/centos-release";
} elsif ( -e "/etc/system-release" ) {
  $release_file="/etc/system-release";
} else {
  print "OS Release file missing, can't determine version information";
  exit;
}

my $OS_NAME=`cat $release_file|cut -d " " -f1`;
my $OS_MAJOR_VERSION=`sed -rn 's/^[^0-9]*([0-9]+)\\.[0-9]+.*/\\1/p' $release_file`;
my $OS_MINOR_VERSION=`sed -rn 's/^[^0-9]*[0-9]+.([0-9]+).*/\\1/p' $release_file`;

chomp($OS_NAME);
chomp($OS_MAJOR_VERSION);
chomp($OS_MINOR_VERSION);

print "\nOS Name and Version: ${OS_NAME} ${OS_MAJOR_VERSION}.${OS_MINOR_VERSION}\n\n"; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-21T06:40:51.453

您可以检查文件 - /etc/os-release：

```
#!/usr/bin/perl

use feature(say);
use strict;
use warnings;

my %os=();

unless ( open(OS,"cat /etc/os-release|") ){
        say "ErrorOpenPipe OS_release";
        exit;
}

while (<OS>){
        my @os_param = split /=/, $_;
        $os{$os_param[0]}=$os_param[1];
}

my @FH;

say $os{ID};
say $os{VERSION_ID}; 
```

如果需要，使用其他键：

```
$ cat /etc/os-release 

NAME="Ubuntu"
VERSION="16.04.5 LTS (Xenial Xerus)"
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME="Ubuntu 16.04.5 LTS"
VERSION_ID="16.04"
HOME_URL="http://www.ubuntu.com/"
SUPPORT_URL="http://help.ubuntu.com/"
BUG_REPORT_URL="http://bugs.launchpad.net/ubuntu/"
VERSION_CODENAME=xenial
UBUNTU_CODENAME=xenial

$ cat /etc/os-release 

NAME="CentOS Linux"
VERSION="7 (Core)"
ID="centos"
ID_LIKE="rhel fedora"
VERSION_ID="7"
PRETTY_NAME="CentOS Linux 7 (Core)"
ANSI_COLOR="0;31"
CPE_NAME="cpe:/o:centos:centos:7"
HOME_URL="https://www.centos.org/"
BUG_REPORT_URL="https://bugs.centos.org/"

CENTOS_MANTISBT_PROJECT="CentOS-7"
CENTOS_MANTISBT_PROJECT_VERSION="7"
REDHAT_SUPPORT_PRODUCT="centos"
REDHAT_SUPPORT_PRODUCT_VERSION="7" 
```

# python - for循环中的Python数组索引

> ID：14912350
> 
> 赞同：0
> 
> 时间：2013-02-16T16:16:03.607
> 
> 标签：python, for-loop, indexing

该程序旨在根据以下条件生成电阻值：

![在此处输入图像描述](../Images/d780b95bbf4277867c90e426844162d9.png)

（给定一系列电阻和温度）。

为了获得电阻的当前值，该方程需要来自阵列的初始电阻和初始温度值 (R_0, T_0)。它还需要阵列中的连续温度 (T) 值。

我的尝试：

```
r_model=[]
for r in r_values:
    result = r*(1+2.9*(t_values[r+1]-t_values[r]))
    fit2.append(result)
r_model = array(r_model) 
```

我的错误：

```
index out of bounds 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:27:48.320

如果在处理`for`循环时需要数组索引，可以使用`enumerate`：

```
r_model=[]
for (index, r) in enumerate(r_values):
    result = r*(1+2.9*(t_values[index+1]-t_values[index]))
    fit2.append(result)
r_model = array(r_model) 
```

如果`r_values`是`[1500,2500,0.0001]`，那么`enumerate(r_values)`将遍历这个序列：

```
(0, 1500)
(1,2500)
(2,0.0001) 
```

在每一步，您都可以使用索引（0,1 和 2）从`t_values`列表中获取正确的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:21:26.043

你有：

```
r_values = arange(1500,2500,0.0001)    #R_0 values
for r in r_values:
# . . .
    t_values[r+1] 
```

所以第一次通过循环你会得到：

```
t_values[1501] 
```

但是 t_values 只有 3 个元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:21:33.323

您正在使用 r 的值而不是索引来索引 t。`for ri, r in r_values`我相信，是语法 - 然后用于`ri`索引`t_values`

另请参阅[在 Python 'for' 循环中访问索引](https://stackoverflow.com/questions/522563/accessing-the-index-in-python-for-loops)

您的代码中的另一个问题：您的方程式讨论了与 T0 的差异，但您接受了差异`t_values[r+1]-t_values[r]`。应该是`t_values[ri]-t_values[0]`？

# vb.net - 如何从 VB.Net 2010 中的 MS Access 2010 (.accdb) 调用查询？

> ID：14912351
> 
> 赞同：0
> 
> 时间：2013-02-16T16:16:33.570
> 
> 标签：vb.net, ms-access

我有这段代码使用来自 ms 访问的数据填充 datagridview：

```
Dim con As New OleDbConnection  
Dim ds As New DataSet  
Dim da As OleDb.OleDbDataAdapter  
Dim Sql As String

Sql = "SELECT * FROM myTable WHERE case_no=?"  
Try  
  con.ConnectionString = "PROVIDER=Microsoft.ACE.OLEDB.12.0;Data Source=Sample.accdb;Persist Security Info=True;Jet OLEDB:Database Password=dbadmin2010"  
    con.Open()  
    Dim cmd As OleDbCommand = New OleDbCommand(Sql, con)  
    da.SelectCommand = cmd  
    cmd.Parameters.AddWithValue("case_no", case_no)  

    Dim ds As DataSet = New DataSet  
    da.Fill(ds, "Case Info")  
    DataGridView1.DataSource = ds.Tables("Case Info")  

Catch ex As Exception  
    MsgBox(ex.Message)  
End Try 
```

现在我刚刚从 MS Access 本身的设计视图中创建了一个查询，有没有办法调用该查询并将结果检索到我的 datagridview 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T19:32:18.793

只需使用查询名称并设置命令类型即可，例如，除了您已有的之外，还可以使用以下注释：

```
Try
    con.ConnectionString = enter_connection_string_here 
    con.Open()
    cmd.Connection = con
    cmd.CommandType = CommandType.StoredProcedure
    cmd.CommandText = "NameOfQuery"
    da.SelectCommand = cmd
    cmd.Parameters.AddWithValue("case_no", case_no)

    da.Fill(ds, "Case Info") 
```

# java - MapActivity 上没有显示地图

> ID：14912352
> 
> 赞同：0
> 
> 时间：2013-02-16T16:16:34.853
> 
> 标签：java, android, api, google-maps

我已经下载了谷歌 API，现在我的地图 XML 似乎是一个标准问题，只是在应该显示谷歌地图的地方显示一个灰色手柄，如图所示：

![在此处输入图像描述](../Images/e770f0b68d9a1ac90ce75650d763bd20.png)

我尝试了两个 API 密钥（通过生成一个新密钥）无济于事。我在清单中添加了 Internet 权限和 Google 地图库，如下所示：

显现：

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.map"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="8" />

<uses-permission android:name="android.permission.INTERNET"/>

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >

    <activity
        android:name=".MainMap"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
  <uses-library android:name="com.google.android.maps" />
</application>
</manifest> 
```

API 密钥：

![在此处输入图像描述](../Images/de42ebe355cd51d199d07692b464c747.png)

这是我的地图 XML 布局：

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<com.google.android.maps.MapView 
    android:id="@+id/mapView"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:enabled="true"
    android:clickable="true"
    android:apiKey="AIzaSyBV_Zio-pysGWfjGo7dUpGvYRZ9PB3NQLc"/>

</RelativeLayout> 
```

我将我的项目设置为 Google API 的 SDK 版本，并且与我的 AVD 相同。

当我的应用程序被加载并且我的意图开始时，我在控制台中收到以下错误：

```
02-16 15:55:04.637: E/MapActivity(305): Couldn't get connection factory client 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T19:10:34.427

我觉得你的manifest和layout文件没问题。这个问题一般是因为key问题。通过使用 SHA1 证书指纹，我遇到了同样的问题。所以我选择了 MD5 证书指纹。转到此站点[https://developers.google.com/maps/documentation/android/v1/maps-api-signup](https://developers.google.com/maps/documentation/android/v1/maps-api-signup)并提供您的 MD5 指纹并获取密钥。获取 MD5 指纹

1.  通过在运行中键入 cmd 打开命令提示符。开始⇒运行⇒输入cmd
2.  输入 cd c:\path-to-jdk-dir\bin\ 进入 jdk 的 bin 目录

    就我而言，我输入了 cd C:\Program Files\Java\jdk1.7.0_07\bin\

3.  然后键入 keytool -exportcert -alias androiddebugkey -keystore "C:\Users\user-name\.android\debug.keystore" -list -v

    在我的情况下，我输入了 keytool -exportcert -alias androiddebugkey -keystore "C:\Users\User\.android\debug.keystore" -list -v

4.  然后你会被要求输入密码。默认密码是安卓。

最后，您将获得 MD5 指纹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:28:13.483

我在使用 Android 2.3.3 的模拟器上遇到了同样的问题，在寻找解决方案时，我发现这是使用此操作系统版本的模拟器的一个已知问题。试试另一个不同版本的模拟器，它应该可以工作。希望这可以帮助。

# javascript - 我如何改进这个书签？

> ID：14912358
> 
> 赞同：0
> 
> 时间：2013-02-16T16:16:53.457
> 
> 标签：javascript, bookmarklet

这是代码：

javascript:(function()%7B%20window.open(' [http://www.google.com/](http://www.google.com/) ');%20%7D)();%20javascript:(function()%7B%20window.open(' [http://www.magesy.me/](http://www.magesy.me/) ');%20%7D)();

我怎样才能在第二个标签打开时延迟两三秒？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:22:52.810

利用`setTimeout`

```
(function() 
 {
  window.open('www.google.com');
  setTimeout(function() {
     window.open('www.magesy.com');
 }, 1000); 
})(); 
```

其中 1000 是以毫秒为单位的超时。要获得更长的延迟，请将其调整为 2000（2 秒）

# visual-studio-2010 - 哪些编译器支持 CUDA

> ID：14912365
> 
> 赞同：2
> 
> 时间：2013-02-16T16:18:32.740
> 
> 标签：visual-studio-2010, compiler-construction, cuda, dev-c++

我发现 Visual Studio 有一些问题。我使用`openMP`多线程的项目在 Visual Studio 2010 上比在 Dev-C++ 上慢两倍，现在我编写了另一个使用 CUDA 技术的项目，我认为我的项目由于 Visual Studio 而运行缓慢，所以我需要一些其他编译器支持CUDA，我的问题是：

1.  Dev-C++ 支持 CUDA 吗？

2.  除了 Visual Studio，还有哪些编译器支持 CUDA？

3.  如果有很多支持 CUDA 的编译器，什么会为应用程序提供最佳速度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:53:27.357

CUDA Toolkit [Release Notes](http://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html)列出了支持的平台和编译器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:28:36.993

好吧，我认为情况正好相反。问题是，有一个叫`nvcc`. 它生成设备代码和主机代码并将主机代码发送到编译器。它应该是 C 编译器，并且应该在可执行路径中。（编辑：它应该是 Linux 上的 gcc 和 Windows 上的 cl，我认为我应该像发行说明那样忽略 mac（？））

nvcc 编译器信息如下：

> 在以下情况下，nvcc 需要通用 C 编译器：
> 
> 1.  在非 CUDA 阶段（运行阶段除外），因为这些阶段将由 nvcc 转发到此编译器
>     
>     
> 2.  在 CUDA 阶段，用于几个预处理阶段（另见 0）。在 Linux 平台上，编译器假定为“gcc”或“g++”用于链接。在 Windows 平台上，编译器假定为“cl”。编译器可执行文件应位于当前可执行文件搜索路径中，除非指定了选项 -compiler-bin-dir，在这种情况下，此选项的值必须是这些编译器可执行文件所在目录的名称。

请不要那样谈论编译器。您的代码与 Dev-C++ 配合得更好。生成的是汇编代码。我并不是说它们没有任何区别，但可能是 4% 到 5%，而不是 100%。

绝对不要因为你的程序慢而责备编译器。这肯定是因为内存访问效率低下和不同类型的内存使用不正确。

# bash - “在终端中运行”的奇怪行为，它会杀死进程

> ID：14912371
> 
> 赞同：0
> 
> 时间：2013-02-16T16:18:57.413
> 
> 标签：bash, shell, service, terminal, gnome

我编写了一个运行服务的 shell 脚本。我打开终端，运行运行服务的脚本，脚本结束后，我关闭终端但服务继续运行，这就是我想要的。

无论如何，如果我通过 Gnome 命令“在终端中运行”运行脚本，当终端关闭时，服务也会被终止。

这很奇怪，我不明白为什么，我无法解决这个问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:35:02.890

尝试执行

```
nohup ./shell_script & 
```

`nohup`命令使进程在终端关闭后继续执行，忽略`SIGHUP`信号。

请注意，脚本将在后台执行，并且输出将附加到文件中。

# c - ScaLAPACK，调用 Cblacs_gridinit() 时“信号量超时期限已过”

> ID：14912372
> 
> 赞同：2
> 
> 时间：2013-02-16T16:19:06.130
> 
> 标签：c, mpi, scalapack

我使用来自 Intel MKL 的 ScaLAPACK，并在 Windows 7 计算机网络上安装了 MPICH2。当我在单台机器上运行作业时它工作正常，例如：

```
mpiexec -n 16 Z:/myprogram.exe       # Z:/ is a mapped network drive 
```

此外，当我运行时，它在网络上运行良好`cpi.exe`（测试程序与 MPICH2 一起提供）：

```
mpiexec -hosts 4 host1 4 host2 4 ... Z:/cpi.exe 
```

我的代码（大线性方程组的解）在单台机器上也能正常工作。但是，当我这样做时它失败了：

```
mpiexec -hosts 2 host1 8 host2 8 Z:/myprogram.exe 
```

消息是：

```
Fatal error in PMPI_Comm_create: Other MPI error, error stack:
PMPI_Comm_create(609)................: MPI_Comm_create(MPI_COMM_WORLD, group=0x8
8000001, new_comm=001DF644) failed
PMPI_Comm_create(590)................:
MPIR_Comm_create_intra(250)..........:
MPIR_Get_contextid(521)..............:
MPIR_Get_contextid_sparse(683).......:
MPIR_Allreduce_impl(712).............:
MPIR_Allreduce_intra(197)............:
allreduce_intra_or_coll_fn(106)......:
MPIR_Allreduce_intra(357)............:
MPIC_Sendrecv(192)...................:
MPIC_Wait(540).......................:
MPIDI_CH3I_Progress(402).............:
MPID_nem_mpich2_blocking_recv(905)...:
MPID_nem_newtcp_module_poll(37)......:
MPID_nem_newtcp_module_connpoll(2656):
gen_cnting_fail_handler(1739)........: connect failed - Semaphore timeout period has expired. (errno 121)

job aborted:
rank: node: exit code[: error message]
0: 10.30.10.182: 1: process 0 exited without calling finalize
1: 10.30.10.184: 123
2: 10.30.10.184: 123
3: 10.30.10.184: 123
4: 10.30.10.184: 123
5: 10.30.10.184: 123
6: 10.30.10.184: 123
7: 10.30.10.184: 123
8: 10.30.10.184: 123
9: 10.30.10.184: 123
10: 10.30.10.184: 123
11: 10.30.10.184: 123
12: 10.30.10.184: 123
13: 10.30.10.184: 123
14: 10.30.10.184: 123
15: 10.30.10.184: 123 
```

据我现在所知，问题出现在我的 C 代码的早期：

```
Cblacs_pinfo(&mype, &npe); // OK, gets correct values
Cblacs_get(-1, 0, &icon); // OK, gets correct value
Cblacs_gridinit(&icon, "c", mp, np); // Never returns from this line. 
```

我将不胜感激任何帮助或建议。解决这个问题对我来说非常重要。

编辑：下面的代码确实有效，所以我的 MPI 基础设施似乎还可以..？

```
int main(int argc, char* argv[])
{

 int numprocs, rank, namelen;
 char processor_name[MPI_MAX_PROCESSOR_NAME];
 printf("start\n");

 MPI_Init(&argc, &argv);
 MPI_Comm_size(MPI_COMM_WORLD, &numprocs);
 MPI_Comm_rank(MPI_COMM_WORLD, &rank);
 MPI_Get_processor_name(processor_name, &namelen);

 printf( "Process %d on %s out of %d\n" , rank, processor_name, numprocs);

 MPI_Finalize();
} 
```

# c# - 使用存储在数据库中的图像（图像路径）

> ID：14912373
> 
> 赞同：0
> 
> 时间：2013-02-16T16:19:10.583
> 
> 标签：c#, winforms

我希望此按钮的图像使用存储在数据库中的图像（图像路径）...

```
 private void button15_Click(object sender, EventArgs e)
        {
            string a = button11.Text;
            string connString = "Server=Localhost;Database=test;Uid=*****;password=*****;";
            MySqlConnection conn = new MySqlConnection(connString);
            MySqlCommand command = conn.CreateCommand();
            command.CommandText = ("Select link from testtable where ID=" + a);

            try
            {
                conn.Open();
            }
            catch (Exception ex)
            {
                //button11.Image = ex.ToString();
            }

            MySqlDataReader reader = command.ExecuteReader();
            while (reader.Read())
            {
                button11.Image = reader["path"].ToString();                    
            }
        } 
```

我认为错误在于，`"reader["path"].ToString();"`但我不知道要使用什么语法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:30:55.330

如果您在`path`列中存储了磁盘上图像文件的路径，则应加载该图像：

```
 string path = (string)reader["path"];
    button11.Image = Image.FromFile(path); 
```

旁注：切勿将值直接从用户输入传递到数据库查询。它容易受到 sql 注入攻击。改用参数：

```
command.CommandText = "Select link from testtable where ID=@id";
command.Parameters.AddWithValue("@id", int.Parse(a)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:34:22.077

试试这个：

```
 while (reader.Read())
        {
            string path = reader.GetString(0);
            button11.Image = Image.FromFile(path);                    
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:35:27.790

试试这个：（写权回答框，可能有错别字！）

```
 private void button15_Click(object sender, EventArgs e)
    {
        string a = button11.Text;
        string imagePath;
        string connString = "Server=Localhost;Database=test;Uid=root;password=root;";
        using(MySqlConnection conn = new MySqlConnection(connString))
        using(MySqlCommand command = conn.CreateCommand())
        {
            command.CommandText = "Select link from testtable where ID=@id";
            command.Parameters.AddWithValue("@id", int.Parse(a));

            try
            {
                conn.Open();
                imagePath= (string)command.ExecuteScalar();
            }
            catch (Exception ex)
            {
            //button11.Image = ex.ToString();
            }

            button11.Image = Image.FromFile(imagePath);
        }
    } 
```

# mysql - 事务是否适用于跨多个表的语句？

> ID：14912375
> 
> 赞同：2
> 
> 时间：2013-02-16T16:19:16.270
> 
> 标签：mysql, jdbc

我将 JDBC 与 mysql 一起使用。我在单个事务中进行了一系列非常复杂的插入和更新。这似乎在大多数情况下都有效，但在大约 1% 的情况下，我发现我的一个表中的数据处于不一致状态。

如果发生错误，我将回滚事务，但不确定如何开始调试。我的设置通常如下所示：

```
try {
    conn.setAutoCommit(false);  

    PreparedStatement stmt1 = conn.prepareStatement("insert into table1");
    stmt1.executeUpdate();
    stmt1.close();

    PreparedStatement stmt2 = conn.prepareStatement("update table2");
    stmt2.executeUpdate();
    stmt2.close();

    ... more statements ...

    conn.commit();
} 
catch (Exception ex) {
    conn.rollback();
} 
```

我正在使用 2010 版本的 mysql。我可能会尝试更新它，但我觉得它更多的是我的应用程序代码中导致不一致的东西。

是否有任何我可能会在数据库级别发现有用的调试工具来提供帮助？还有其他指针吗？我正在使用所有默认设置的 JDBC，我想知道在这种情况下是否需要使用更严格的事务级别？

谢谢

----- 注意 ----- 我所有的表都是 InnoDb。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T20:53:11.617

嗯..有趣。是的，它应该工作。我们在多个表中多次使用非常大的事务，甚至从未经历过奇怪的事情......
你确定不是你造成了不一致（不管这意味着什么，你没有指定这个）？通过简单地插入/更新错误的东西？:-)

只是一个想法——我们多次遇到这个问题。解决死锁。用于处理该问题的数据库服务器。如果您有多个并行线程并且事务块正在操作更多表，则发生死锁的机会会更高。在这种情况下，您的一些事务可能会被数据库服务器本身中止（并回滚）。这些交易将导致错误。

您在上面编写的代码仅在异常情况下回滚（中止的事务已经回滚，所以它不会做太多......），但是您是否尝试过打印/记录异常？如果不是，你应该。

当然，事务是彼此分开运行的。但这可以解释为什么你在只有 1-2% 的情况下会遇到这种奇怪的行为......

你也应该检查你的 mysql 服务器的日志。服务器本身也可能由于任何原因而失败。还有一个提示：您可以尝试运行“mysqltop”（或“mtop”，希望我正确记住了这个工具的名称..）。这能够监控并向您展示数据库服务器内部发生的情况。但是它主要用于跟踪我们的 sql 的性能，这也显示了失败。也许运行这个也可以帮助你......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T21:07:21.037

也许您在语句中使用了 DDL（创建表、更改表等）？

我不确定 MySQL，但它可能无法回滚 DDL 语句。

例如：

*   PostgreSQL 可以回滚 DDL，
*   Oracle 在执行 DDL 之前执行提交。

见这里：[http ://dev.mysql.com/doc/refman/5.0/en/cannot-roll-back.html](http://dev.mysql.com/doc/refman/5.0/en/cannot-roll-back.html)

# java - 为什么“adb install -r”会卸载旧版本的应用程序？

> ID：14912378
> 
> 赞同：0
> 
> 时间：2013-02-16T16:19:33.807
> 
> 标签：java, android, adb

我正在测试我的应用程序的完整重建，并希望确保更新顺利进行。当我拥有旧版本并执行“adb install -r”命令时遇到问题。我期望发生的是它只是用更新版本替换旧版本。发生的情况是命令行报告成功，但它所做的只是卸载旧版本并没有安装新版本。我已经在带有 4.2 的 Galaxy Nexus 上对此进行了测试，但我遇到了这个问题，但是当我在带有 4.0 的 S2 上进行测试时，它按预期工作并替换了旧版本。任何想法为什么这会发生在 GS 而不是 S2 上？当我的用户尝试从市场上更新应用程序时，这也会发生在他们身上吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T18:11:55.570

据我所知，三点很重要：

*   包裹名字;
*   签名密钥；
*   版本代码。

如果两个第一个相同，并且最后一个正确递增，则应该没有问题。此外，如果这些内容不正确，Google Play 将拒绝您的更新。

Galaxy Nexus 上是否有 LogCat 错误消息？

# ftp - 您可以通过 FTP 客户端设置重定向吗

> ID：14912383
> 
> 赞同：0
> 
> 时间：2013-02-16T16:19:59.970
> 
> 标签：ftp, web-hosting

一位客户要求我设置从她的站点到另一个站点的重定向，并给了我 FTP 登录用户名和密码。据我了解，FTP 访问只能让您上传和下载文件。我相信您需要访问主机本身来设置重定向。

这是真的吗，还是我可以只使用 FTP 访问来设置重定向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:29:17.087

如果这个 FTP 登录允许您访问某个 apache 服务器的文档根目录，您可以使用 .htaccess 文件来实现重定向。

在 .htaccess 文件中，您使用诸如`RewriteRule`实现您正在寻找的重定向之类的命令，一旦请求访问其中包含 .htaccess 文件的目录，apache 就会读取并执行它。

这是关于如何在 apache 中进行重定向的描述：[http ://httpd.apache.org/docs/2.4/rewrite/remapping.html](http://httpd.apache.org/docs/2.4/rewrite/remapping.html)

这是关于 .htaccess 文件： [http ://httpd.apache.org/docs/2.4/howto/htaccess.html](http://httpd.apache.org/docs/2.4/howto/htaccess.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-07T00:34:24.630

我刚刚访问了主机帐户本身，我建议任何网络开发人员都这样做来设置重定向。

# mysql - mysql查询子选择组

> ID：14912384
> 
> 赞同：0
> 
> 时间：2013-02-16T16:20:03.330
> 
> 标签：mysql

我有一张下面描述的表格

```
mysql> describe payments;
+----------------+--------------+------+-----+---------+----------------+
| Field          | Type         | Null | Key | Default | Extra          |
+----------------+--------------+------+-----+---------+----------------+
| id             | int(11)      | NO   | PRI | NULL    | auto_increment |
| name           | varchar(128) | NO   |     | NULL    |                |
| email          | varchar(128) | NO   |     | NULL    |                |
| txn_id         | varchar(19)  | NO   |     | NULL    |                |
| payment_status | varchar(20)  | NO   |     | NULL    |                |
| auth           | varchar(40)  | NO   |     | NULL    |                |
| expired_at     | datetime     | YES  |     | NULL    |                |
+----------------+--------------+------+-----+---------+----------------+
7 rows in set (0.00 sec) 
```

我可能有 2 个条目，例如：

```
name: chris|expires at: 2012-01-01|email: me@chrismuench.com
name: chris|expires at: 2014-01-01|email: me@chrismuench.com 
```

我想做一个查询，根据下载找到所有过期的用户。但是同一个电子邮件地址可能有多个整数。在上述情况下，此人不应出现在过期列表中。

似乎我想做一个 GROUP BY 电子邮件，但如果它是 > NOW() 则以某种方式过滤掉过期

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:44:11.327

似乎对于每个唯一用户，您都想要最大日期并检查这是否`NOW()`正确？所以：

```
SELECT name, MAX(expired_at) as latest_expired FROM payments WHERE lastest_expired < NOW() GROUP BY name; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:26:46.293

这是你必须做的。我没有使用过 datetime 函数，所以你必须仔细检查它的正确性。我只是假设 NOW() 是一个函数。

找到未过期用户的集合，然后从整个用户集合中减去它。

```
select * from table where email not in (select email from table where expired_at > NOW()); 
```

# iphone - 如何在 Xcode 中管理屏幕方向？

> ID：14912388
> 
> 赞同：3
> 
> 时间：2013-02-16T16:20:13.353
> 
> 标签：iphone, ios, xcode

我的应用程序中有两个视图控制器。
第一个视图控制器是纵向模式，第二个视图控制器是横向模式。

即使我旋转 iPhone，我也不想改变它们的方向。我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T16:25:21.190

在 Xcode 中，突出显示 Project Navigator 中的项目，然后在项目树中选择目标。打开摘要页面，然后转到支持的接口方向部分。取消单击您不希望应用程序支持的方向。

在故事板中，选择您的第一个视图控制器，转到属性检查器，然后在模拟度量部分中将方向设置为“纵向”。现在选择第二个视图控制器，并将其方向设置为“横向”。

在视图控制器代码中，实现

```
- (NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskPortrait;
} 
```

对于第一个视图控制器，以及

```
- (NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskLandscape;
} 
```

对于第二个视图控制器。这应该可以为您解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T16:40:26.180

在您的情况下，您有两个 VC。因此，在以下方法下的两个 VC 中，只需处理您的方向。并对 toInterfaceOrientation 执行检查并返回 YES。

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
     // For your VC1
     if (toInterfaceOrientation == UIInterfaceOrientationPortrait)
           return YES;
     // For your VC2
     /*
     if (toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft || toInterfaceOrientation == UIInterfaceOrientationLandscapeRight)
           return YES;  
     */

} 
```

# spring - 通过 Spring 数据备份数据库

> ID：14912390
> 
> 赞同：7
> 
> 时间：2013-02-16T16:20:19.873
> 
> 标签：spring, spring-data

我需要使用 Spring 为我的 Web 应用程序安排定期数据库备份。Spring Data 是否为备份提供任何特定支持？我打算使用TaskScheduler 和TaskExecutor。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-16T16:29:08.210

不，没有具体的支持。Spring Data 旨在用于事务性使用，而不是批处理操作。当然，有一种`findAll()`方法可以迭代并将结果存储在某处。

Spring Batch 可能是一个更好的选择，因为它专注于长时间运行的繁重批处理过程。但是恕我直言，您的应用程序不是运行备份的好地方。为什么不使用数据库或操作系统支持？它会更快，更可靠。

如果您确实需要从应用程序级别备份数据库，请考虑您的数据库手册，也许有一些简单的命令可以将数据库的内容转储到文件中。例如在[h2](/questions/tagged/h2 "显示标记为“h2”的问题")中，我使用[`SCRIPT`](http://www.h2database.com/html/grammar.html#script)SQL 命令`JdbcTemplate`将数据库转储到任意文件。但我使用这种技术[在每次集成测试后重置数据库](http://nurkiewicz.blogspot.no/2011/11/spring-pitfalls-transactional-tests.html)。我`JdbcTemplate`用来最小化开销。这就是为什么 Spring Data 不是这项工作的最佳工具。

MySQL中是有`mysqldump`进程的，所以从Java中运行会比较麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-01-04T08:29:19.963

请点击此链接并了解您的问题 Spring 支持它

如果您构建 maven 项目，请将以下依赖项添加到 pom.xml

```
<dependency>
    <groupId>com.smattme</groupId>
    <artifactId>mysql-backup4j</artifactId>
    <version>1.0.0</version>
</dependency> 
```

如果 gradle spring 项目

将依赖项添加到 build.gradle

编译组：'com.smattme'，名称：'mysql-backup4j'，版本：'1.0.0'

这篇文章可能有助于理解

[https://dzone.com/articles/how-to-backup-mysql-database-programmatically-usin](https://dzone.com/articles/how-to-backup-mysql-database-programmatically-usin)

# ruby - 如何使用 Ruby 和 Nokogiri 解析 Google 图片 URL？

> ID：14912392
> 
> 赞同：1
> 
> 时间：2013-02-16T16:20:50.517
> 
> 标签：ruby, regex, rubygems, nokogiri

我正在尝试在 Google 图片网页上制作所有图片文件的数组。

我想要一个正则表达式在此 HTML 中看到`"imagurl="`之前和之后的所有内容：`"&amp"`

```
<a href="http://www.google.com/imgres?imgurl=http://www.trendytree.com/old-world-   christmas/images/20031chapel20031-silent-night-chapel.jpg&amp;imgrefurl=http://www.trendytree.com/old-world-christmas/silent-night-chapel-20031-christmas-ornament-old-world-christmas.html&amp;usg=__YJdf3xc4ydSfLQa9tYnAzavKHYQ=&amp;h=400&amp;w=400&amp;sz=58&amp;hl=en&amp;start=19&amp;zoom=1&amp;tbnid=ajDcsGGs0tgE9M:&amp;tbnh=124&amp;tbnw=124&amp;ei=qagfUbXmHKfv0QHI3oG4CQ&amp;itbs=1&amp;sa=X&amp;ved=0CE4QrQMwEg"><img height="124" width="124" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRLy5inpSdHxWuE7z3QSZw35JwN3upbBaLr11LR25noTKbSMn9-qrySSg"></a><br><cite title="trendytree.com">trendytree.com</cite><br>Silent Night Chapel <b>20031</b><br>400 × 400 - 58k - jpg</td> 
```

我觉得我可以用正则表达式来做到这一点，但我找不到使用正则表达式搜索我解析的文档的方法，但我没有找到任何解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:24:50.813

```
str = '<a href="http://www.google.com/imgres?imgurl=http://www.trendytree.com/old-world-     christmas/images/20031chapel20031-silent-night-chapel.jpg&amp;imgrefurl=http://www.trendytree.com/old-world-christmas/silent-night-chapel-20031-christmas-ornament-old-world-christmas.html&amp;usg=__YJdf3xc4ydSfLQa9tYnAzavKHYQ=&amp;h=400&amp;w=400&amp;sz=58&amp;hl=en&amp;start=19&amp;zoom=1&amp;tbnid=ajDcsGGs0tgE9M:&amp;tbnh=124&amp;tbnw=124&amp;ei=qagfUbXmHKfv0QHI3oG4CQ&amp;itbs=1&amp;sa=X&amp;ved=0CE4QrQMwEg"><img height="124" width="124" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRLy5inpSdHxWuE7z3QSZw35JwN3upbBaLr11LR25noTKbSMn9-qrySSg"></a><br><cite title="trendytree.com">trendytree.com</cite><br>Silent Night Chapel <b>20031</b><br>400 × 400 - 58k - jpg</td>'
str.split('imgurl=')[1].split('&amp')[0]
#=> "http://www.trendytree.com/old-world-     christmas/images/20031chapel20031-silent-night-chapel.jpg" 
```

那是你要找的吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T03:50:21.053

使用正则表达式的问题是您对 URL 中的参数顺序有太多了解。如果订单更改或`&amp;`消失，正则表达式将不起作用。

相反，解析 URL，然后将值拆分出来：

```
# encoding: UTF-8

require 'nokogiri'
require 'cgi'
require 'uri'

doc = Nokogiri::HTML.parse('<a href="http://www.google.com/imgres?imgurl=http://www.trendytree.com/old-world-christmas/images/20031chapel20031-silent-night-chapel.jpg&amp;imgrefurl=http://www.trendytree.com/old-world-christmas/silent-night-chapel-20031-christmas-ornament-old-world-christmas.html&amp;usg=__YJdf3xc4ydSfLQa9tYnAzavKHYQ=&amp;h=400&amp;w=400&amp;sz=58&amp;hl=en&amp;start=19&amp;zoom=1&amp;tbnid=ajDcsGGs0tgE9M:&amp;tbnh=124&amp;tbnw=124&amp;ei=qagfUbXmHKfv0QHI3oG4CQ&amp;itbs=1&amp;sa=X&amp;ved=0CE4QrQMwEg"><img height="124" width="124" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRLy5inpSdHxWuE7z3QSZw35JwN3upbBaLr11LR25noTKbSMn9-qrySSg"></a><br><cite title="trendytree.com">trendytree.com</cite><br>Silent Night Chapel <b>20031</b><br>400 × 400 - 58k - jpg</td>')

img_url = doc.search('a').each do |a|
  query_params = CGI::parse(URI(a['href']).query) 
  puts query_params['imgurl']
end 
```

哪个输出：

```
http://www.trendytree.com/old-world-christmas/images/20031chapel20031-silent-night-chapel.jpg 
```

使用 URI 和 CGI​​ 是因为 URI`decode_www_form`在尝试解码查询时引发异常。

我还知道使用以下方法将查询字符串解码为哈希：

```
Hash[URI(a['href']).query.split('&').map{ |p| p.split('=') }] 
```

这将返回：

```
{"imgurl"=>
  “http://www.trendytree.com/old-world-christmas/images/20031chapel20031-silent-night-chapel.jpg”,
 “imgrefurl”=>
  “http://www.trendytree.com/old-world-christmas/silent-night-chapel-20031-christmas-ornament-old-world-christmas.html”,
 "usg"=>"__YJdf3xc4ydSfLQa9tYnAzavKHYQ",
 "h"=>"400",
 "w"=>"400",
 "sz"=>"58",
 "hl"=>"en",
 “开始”=>“19”，
 “缩放”=>“1”，
 "tbnid"=>"ajDcsGGs0tgE9M:",
 "tbnh"=>"124",
 "tbnw"=>"124",
 "ei"=>"qagfUbXmHKfv0QHI3oG4CQ",
 "itbs"=>"1",
 “萨”=>“X”，
 "ved"=>"0CE4QrQMwEg"}

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T16:43:11.610

获取您想要的所有 img 网址

```
# get all links
url = 'some-google-images-url'
links = Nokogiri::HTML( open(url) ).css('a')

# get regex match or nil on desired img
img_urls = links.map {|a| a['href'][/imgurl=(.*?)&/, 1] }

# get rid of nils
img_urls.compact 
```

您想要的正则表达式是因为您想要and`/imgurl=(.*?)&/`之间的非贪婪匹配，否则贪婪会将所有内容带到字符串的最后。`imgurl=``&``.*``&`

# html - 如何在边框半径后去除角落上的白色像素

> ID：14912401
> 
> 赞同：0
> 
> 时间：2013-02-16T16:21:53.513
> 
> 标签：html, css

I've created a simple unordered list with rounded corners, when selecting a list item I want the background to become blue to show the active state. 当我没有边界半径时，一切看起来都很棒。

然而，当我使用 4px 的边框半径来圆所有边缘，并选择底部有圆角的最后一个列表项 (#5) 时，蓝色活动状态现在在角上显示小的白色像素。我似乎无法弄清楚如何防止这种情况发生。谢谢你的帮助。.

[http://jsfiddle.net/8PN8Z/](http://jsfiddle.net/8PN8Z/)

HTML

```
<div class="left-dash">
  <div class="dash-stats-3">
        <ul class="dash-stats-3-ul">
            <li><span id="explore-themes">testing</span></li>
            <li>
                <a href="#" class="tab-link" data-remote="true">
                    <span class="ss-pika ss-icon">1</span><span class="theme"> test-1</span>
                </a>
            </li>
            <li>
                <a href=#"" class="tab-link" data-remote="true">
                    <span class="ss-pika ss-icon">2</span><span class="theme"> test-2</span>
                </a>
            </li>
            <li>
                <a href="" class="tab-link" data-remote="true">
                    <span class="ss-pika ss-icon">3</span><span class="theme"> test-3</span>
                </a>
            </li>
            <li>
                <a href="/theme/inspiring" class="tab-link" data-remote="true">
                    <span class="ss-pika ss-icon">4</span><span class="theme"> test-4</span>
                </a>
            </li>
            <li>
                <a href="#" class="tab-link" data-remote="true">
                    <span class="ss-pika ss-icon">5</span><span class="theme"> test-5</span>
                </a>
            </li>
        </ul>
    </div>
</div> 
```

CSS

```
.left-dash {
    background: #444;
    height: 500px;
}
.left-dash div {
  -webkit-border-radius: 4px 4px 4px 4px;
  border-radius: 4px 4px 4px 4px;
}
.left-dash div ul li:first-child, .left-dash div ul li:first-child a {
  -webkit-border-radius: 4px 4px 0px 0px;
  border-radius: 4px 4px 0px 0px; 
}

.left-dash div ul li:last-child,
.left-dash div ul li:last-child a {
  -webkit-border-radius: 0px 0px 4px 4px;
  border-radius: 0px 0px 4px 4px; 
}

.dash-stats-3 {
    width: 220px;
    margin-bottom: 17px;
    background: #9f9f9f;
    -webkit-background-clip: padding-box; /* for transparent border with solid bg - Safari */
    background-clip: padding-box;/* for IE9+, Firefox 4+, Opera, Chrome */
    border-radius: 0px;
    border: 1px solid rgba( 0, 0, 0, 0.15);
    box-shadow: inset 0px 0px 2px 0px #FFFFFF,0px 1px 3px 0px rgba(0,0,0, 0.15);
    -webkit-box-shadow: inset 0px 0px 2px 0px #FFFFFF,0px 1px 3px 0px rgba(0,0,0, 0.15);
    -moz-box-shadow: inset 0px 0px 2px 0px #FFFFFF,0px 1px 3px 0px rgba(0,0,0, 0.15);
    -o-box-shadow: inset 0px 0px 2px 0px #FFFFFF,0px 1px 3px 0px rgba(0,0,0, 0.15);
    font-family:'Museo Sans W01 700' san-serif;
    font-size: 14px;
    color: #828282;
    text-shadow: 0px 1px 1px #FFFFFF;
    font-weight: normal !important;
}

.dash-stats-3 ul li a, .dash-stats-3 ul li:first-child {
    height: 41px;
    border-bottom: solid rgba( 0, 0, 0, 0.15) 1px;
    border-top: solid rgba(255, 255, 255, .65) 1px;
}
.left-dash div ul li:last-child, .left-dash div ul li:last-child a {
    border-bottom: none;
}

.dash-stats-3 ul li a {
    position:relative;
    line-height:43px;
    display:block;
}

.dash-stats-3 ul li a.active-tab {
    z-index:120;
    border-top: 1px solid #5b82a7;
    background: #4e81be; /* Old browsers */ 
} 
```

JS

```
$(function(){
        $('a.tab-link').click(function(){
          $('a.tab-link').removeClass('active-tab')
          $(this).addClass('active-tab')
        });
      }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:55:59.010

First, give the `active-tab` a radius.

```
.dash-stats-3 ul li a.active-tab {
    z-index:120;
    border-top: 1px solid #5b82a7;
    background: #4e81be; /* Old browsers */ 
        -webkit-border-radius: 0px 0px 2px 2px;
        border-radius: 0px 0px 2px 2px;  
} 
```

Make sure its smaller than the `li`'s radius, (2px).

And remove the radius for the `a` in its default state. Remove this.

```
.left-dash div ul li:last-child a{
  -webkit-border-radius: 0px 0px 4px 4px;
  border-radius: 0px 0px 4px 4px; 
} 
```

Keep this.

```
.left-dash div ul li:last-child{
  -webkit-border-radius: 0px 0px 4px 4px;
  border-radius: 0px 0px 4px 4px; 
} 
```

Check it out : [http://jsfiddle.net/FcXVY/](http://jsfiddle.net/FcXVY/)

The problem is that you're giving a child element the same border radius as the parent element. Even if the parent element won't have a border, there will be some tiny pixels shown, and with a border, its worse. Check this out : [http://jsfiddle.net/UVTJQ/](http://jsfiddle.net/UVTJQ/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T21:14:33.393

好的。我认为这可以简化事情。一探究竟。我希望它有所帮助。

[http://jsfiddle.net/sheriffderek/8WTam/](http://jsfiddle.net/sheriffderek/8WTam/)

```
<ul class="test-list">
    <li><a href="?">Item thing</a></li>
    <li><a href="?">Item thing</a></li>
    <li><a href="?">Item thing</a></li>
    <li><a href="?">Item thing</a></li>
    <li><a href="?">Item thing</a></li>
    <li><a href="?">Item thing</a></li>
</ul> 
```

CSS：

```
/* border box - google it. it rules*/ 
* { 
    -moz-box-sizing: border-box; 
    -webkit-box-sizing: border-box; 
    box-sizing: border-box; 
}

.test-list {
    float: left;
    overflow: hidden;
    list-style: none;

    /* just to show the properly containing ul */  
    margin: 2em;
    background-color: rgba(0,0,0,.05);
    padding: 1em;
}

.test-list li {

}

.test-list a {
    display: block;
    float: left;
    clear: left;
    background-color: #f06;
    padding: 1em 2em;
    min-width: 12em;

    color: white;
    text-decoration: none;
    border: 3px solid rgba(0,0,0,1);
    border-bottom: 0;
}

.test-list a:hover {
    background-color: lightblue;
    color: black;
}

.test-list li:first-of-type a {
    -webkit-border-radius:.4em .4em 0 0;
    border-radius: .4em .4em 0 0;
}

.test-list li:last-of-type a {
    -webkit-border-radius: 0 0 .4em .4em;
    border-radius: 0 0 .4em .4em;
    border-bottom: 3px solid black;
} 
```

# ios - 将 CBCentralManager 设置为 nil 会失去连接吗？

> ID：14912405
> 
> 赞同：0
> 
> 时间：2013-02-16T16:22:15.810
> 
> 标签：ios, core-bluetooth, cbcentralmanager

我想知道是否将我的`CBCentralManager`-instance 设置为`nil`导致与设备的连接丢失，我是否需要一个“实时”的 CBCentralManager 才能保持连接处于活动状态？

我目前有一个管理器，用于扫描和连接到使用 NavigationController`Viewcontroller`推送的默认设备中的新设备。`ViewController`当我完成连接后出现问题，我按下后退按钮，根据顶部状态栏中的蓝牙指示灯我的连接丢失，但如果我检查`CBPeripheral`它仍然有状态`_isConnected==YES`；

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:59:38.110

不，不会的。在这种情况下，您对指针所做的事情与其他人无关。没有`ARC`，这根本没有效果（在任何情况下）。使用`ARC`，它可能会触发发布调用。但即使这与设备无关。

# ssl - 用于密钥分配的公钥密码学与 Diffie-Hellman

> ID：14912406
> 
> 赞同：3
> 
> 时间：2013-02-16T16:22:34.260
> 
> 标签：ssl, cryptography, rsa, public-key-encryption, diffie-hellman

假设我们有一个带有私钥和公钥的服务器，后者可供所有客户端使用，并且我们有一个没有自己的不对称密钥的客户端。我们希望在服务器和客户端之间建立安全的通信，客户端必须确保服务器的真实性。这是很常见的情况。

现在，据我了解，通常在这种情况下使用私钥/公钥对只是为了确保真实性（我们的客户端可以使用服务器的公钥来验证服务器的真实性）。为了确保服务器和客户端之间的双向通信，使用了 Diffie-Hellman 密钥交换，然后基于共享密钥进行通信。

我不禁想知道为什么在这种情况下使用 Diffie-Hellman。据我了解，公钥加密可用于确保真实性并在客户端和服务器之间共享密钥。服务器可以向客户端发送使用其私钥编码的消息，客户端可以使用服务器的公钥对其进行解码以确认其身份。此外，客户端可以使用服务器的公钥向服务器发送一个新的随机密钥。只有服务器知道这个密钥，因为只有服务器知道他的私钥。我知道有些人建议不要使用公钥进行编码和解码，但没有人说为什么。

显然，如果客户端和服务器都有自己的公钥/私钥，他们甚至不需要共享任何密钥，但这不是典型的情况。

所以……总结一下。为什么使用 Diffie-Hellman 代替具有公钥加密的密钥分发？有什么优势吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:49:50.053

> 我不禁想知道为什么在这种情况下使用 Diffie-Hellman。据我了解，公钥加密可用于确保真实性并在客户端和服务器之间共享密钥。

Diffie-Hellman 和 RSA 密钥交换（其中 RSA 用于加密）都可以与 SSL/TLS 一起使用。这取决于密码套件。

> 服务器可以向客户端发送使用其私钥编码的消息，客户端可以使用服务器的公钥对其进行解码以确认其身份。

这确实是 DH 密钥交换与 RSA 或 DSS 身份验证发生的情况：服务器使用其私钥签署其 DH 参数，客户端可以验证签名。

> 此外，客户端可以使用服务器的公钥向服务器发送一个新的随机密钥。只有服务器知道这个密钥，因为只有服务器知道他的私钥。

这或多或少是 RSA 密钥交换发生的情况：客户端加密预主密钥，只有服务器可以解密。

[您可以在 TLS 规范的身份验证和密钥交换部分](https://www.rfc-editor.org/rfc/rfc4346#appendix-F.1.1)阅读所有这些内容（撇开匿名密钥交换不谈）。[密码套件](https://www.rfc-editor.org/rfc/rfc4346#appendix-C)的选择（参见附录 A.5 和 C）取决于客户端和服务器的配置方式，将决定使用的密钥交换机制。

据我所知，固定 DH 交换相当罕见。临时 DH（DHE 密码套件）更为常见。它可以提供“完美的前向保密”：即使攻击者掌握了私钥，他们也无法破译现有流量，因为他们还需要拥有 DH 参数，这些参数对于所有连接都不相同。然而，这在性能方面是有代价的。[您可以在本文](http://vincent.bernat.im/en/blog/2011-ssl-perfect-forward-secrecy.html)中找到有关此主题的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-02-19T11:46:04.977

. 为什么使用 Diffie-Hellman 代替具有公钥加密的密钥分发？有什么优势吗？

Ans：假设黑客一直在跟踪客户端和服务器之间交换的所有消息并保存消息，但他无法解密这些消息，因为他不知道共享对称密钥。如果服务器的私钥被泄露，那么在 diffie-hellman 黑客的情况下仍然无法解密消息，因为 diffie Hellman 算法从不在线发送密钥，而是客户端和服务器在不共享的情况下同意相同的密钥，这是一种密钥协商算法不分享。攻击中间的 diffie Hellman 人应该是活的并且应该知道用于身份验证的服务器私钥。但是在我们的例子中，黑客已经过去了 diffie Hellman 消息，所以他不能在中间攻击中使用人。同时服务器更改它的私钥，因此没有损坏。

# mongodb - MongoDB 有一个未指定的未捕获异常

> ID：14912415
> 
> 赞同：5
> 
> 时间：2013-02-16T16:23:13.427
> 
> 标签：mongodb, meteor

我正在尝试运行一个流星应用程序，但我收到一个 mongo 错误，不知道如何调试它

```
[~/sites/tuts]$ meteor --port 5555
[[[[[ ~/Sites/tuts ]]]]]

Unexpected mongo exit code 100\. Restarting.
Unexpected mongo exit code 100\. Restarting.
Unexpected mongo exit code 100\. Restarting.
Can't start mongod

MongoDB had an unspecified uncaught exception.
Check to make sure that MongoDB is able to write to its database directory. 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-27T22:57:52.360

蒙戈没有清理自己就被杀了。尝试删除 .meteor/local/db/mongod.lock。如果失败，您可以进行流星重置，但这会擦除您的数据库。

# javascript - 获取在正则表达式中匹配的组的索引？

> ID：14912419
> 
> 赞同：2
> 
> 时间：2013-02-16T16:23:25.477
> 
> 标签：javascript, regex, indexing, match, regex-group

我有一个正则表达式：

```
/(alpha)|(beta)|(gamma)/gi 
```

一些要匹配的文本：

```
Betamax. Digamma. Alphabet. Hebetation. 
```

比赛是：

```
beta, gamma, alpha, beta 
```

我正在寻找的价值观是：

```
1,2,0,1 
```

...我可以确定在正则表达式中匹配的组的索引吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T16:35:47.040

要[访问组](https://stackoverflow.com/q/432493/1048572)，您需要[`.exec()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/exec)重复使用：

```
var regex = /(alpha)|(beta)|(gamma)/gi,
    str = "Betamax. Digamma. Alphabet. Hebetation.";
for (var nums = [], match; match = regex.exec(str); )
    nums.push(match.lastIndexOf(match[0])); 
```

如果您希望索引从零开始，您可以使用

```
 nums.push(match.slice(1).indexOf(match[0])); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:29:49.423

从字符串数组构建您的正则表达式，然后使用 indexOf 查找匹配项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T16:34:51.777

如果我们考虑您提供的确切样本，以下将起作用：

```
var r = /(alpha)|(beta)|(gamma)/gi;
var s = "Betamax. Digammas. Alphabet. Habetation.";

var matched_indexes = [];
var cur_match = null;

while (cur_match = r.exec(s))
{
    matched_indexes.push(cur_match[1] ? 0 : cur_match[2] ? 1 : 2 );
}

console.log(matched_indexes); 
```

我把它留给你，让循环的内容更加动态/通用：p

# ember.js - Ember clone model for new record

> ID：14912425
> 
> 赞同：16
> 
> 时间：2013-02-16T16:23:47.877
> 
> 标签：ember.js

I want to make a clone of a model currently being edited.

I've found a couple of ways that almost work. But neither are perfect.

1) `model.get('data.attributes')` gets all the attributes except for relationships in camelCase form, generates a new record fine but the relationships are missing of course.

2) `model.serialize()` generates a JSON object, with all attributes including relationships. But `createRecord` will not handle it well since the object is not camelCased (attributes with underscores like `first_name` will not be handled)

After my clone has been created I want to `transaction.createRecord(App.Document, myNewModelObject)` change/set a couple of attributes and finally `commit()`. Anyone have some insight in how to do this?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-09-11T07:52:23.690

Now we have a add-on to copy models [ember-cli-copyable](https://www.npmjs.com/package/ember-cli-copyable)

With this add on, just add the `Copyable` mix-in to the target model which is to be copied and use the copy method

Example from the add-on site

```
import Copyable from 'ember-cli-copyable';

Account = DS.Model.extend( Copyable, {
  name: DS.attr('string'),
  playlists: DS.hasMany('playList'),
  favoriteSong: DS.belongsTo('song')
});

PlayList = DS.Model.extend( Copyable, {
  name: DS.attr('string'),
  songs: DS.hasMany('song'),
});

//notice how Song does not extend Copyable 
Song = DS.Model.extend({
  name: DS.attr('string'),
  artist: DS.belongsTo('artist'),
});
//now the model can be copied as below
this.get('currentAccount.id') // => 1 
this.get('currentAccount.name') // => 'lazybensch' 
this.get('currentAccount.playlists.length') // => 5 
this.get('currentAccount.playlists.firstObject.id') // => 1 
this.get('currentAccount.favoriteSong.id') // => 1 

this.get('currentAccount').copy().then(function(copy) {

  copy.get('id') // => 2 (differs from currentAccount) 
  copy.get('name') // => 'lazybensch' 
  copy.get('playlists.length') // => 5 
  copy.get('playlists.firstObject.id') // => 6 (differs from currentAccount) 
  copy.get('favoriteSong.id') // => 1 (the same object as in currentAccount.favoriteSong) 

}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-27T14:31:02.637

How about using toJSON() method instead of serialize() like this

`js transaction.createRecord(App.Document, model.toJSON());`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-29T08:50:55.960

You can use [https://github.com/offirgolan/ember-data-copyable](https://github.com/offirgolan/ember-data-copyable). Been using this package for some time now, and it is very much reliable. Some of its features :

*   Shallow & deep copy an Ember Data model

*   Shallow & deep copy model relationships

*   Handles cyclical relationships

*   Handles custom transforms to create true copies

*   Overwrite, ignore attributes, and copy objects by reference

*   Intelligent failure and cleanup

*   Uses ember-concurrency to allow cancelling a copy task

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-08T09:56:30.367

Most simple way I found:

```
function cloneModel(model) {
  const root = model._internalModel.modelName;
  const store = model.get('store');
  let attrs = model.toJSON();

  attrs.id = `clone-${attrs.id}`;
  store.pushPayload({
    [root]: attrs
  });
  return store.peekRecord(root, attrs.id);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-29T03:31:14.637

Here is the simple way to clone your **Ember Model with relationships. working fine.**

Create a Copyable mixin like,

```
import Ember from 'ember';

export default Ember.Mixin.create(Ember.Copyable, {

    copy(deepClone) {
      var model = this, attrs = model.toJSON(), class_type = model.constructor;
      var root = Ember.String.decamelize(class_type.toString().split(':')[1]);

      if(deepClone) {
          this.eachRelationship(function(key, relationship){
              if (relationship.kind == 'belongsTo') {
                  attrs[key] = model.get(key).copy(true);
              } else if(relationship.kind == 'hasMany' && Ember.isArray(attrs[key])) {
                  attrs[key].splice(0);
                  model.get(key).forEach(function(obj) {
                      attrs[key].addObject(obj.copy(true));
                  });
              }
          });
      }
      return this.store.createRecord(root, attrs);
    }
}); 
```

Add the mixin in your model,

**Note: If you want to clone your child model then, you need to include the mixin in child model as well**

USAGE:

1.  With relationship : YOURMODEL.copy(true)
2.  Without relationship : YOURMODEL.copy()

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-28T07:33:19.013

This will also solve my problem

```
Account = DS.Model.extend({
   name: DS.attr('string'),
   playlists: DS.hasMany('playList'),
   favoriteSong: DS.belongsTo('song')
});

Duplicate = Ember.Object.extend({});

TemporaryRoute = Ember.Route.extend({
   model : function(){
      var model = this.store.findAll('account');
      var json = model.toJSON(); 
      var duplicateModel = Duplicate.create(json);
      this.set('duplicateModel', duplicateModel);
      return model;
   }
}); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-02-16T17:44:36.027

Here's an updated answer, it still doesn't handle `hasMany` relationships.

```
cloneBelongsTo: function(fromModel, toModel) {
  var relationships;
  relationships = Em.get(fromModel.constructor, 'relationships');
  return relationships.forEach(function(relationshipType) {
    var _relType;
    _relType = relationships.get(relationshipType);
    return _relType.forEach(function(relationship) {
      var name, relModel;
      relModel = Em.get(fromModel, relationship.name);
      if (relationship.kind === 'belongsTo' && relModel !== null) {
        name = relationship.name;
        return toModel.set(name, fromModel.get(name));
      }
    });
  });
} 
```

And here's how I use it:

```
// create a JSON representation of the old model
var newModel = oldModel.toJSON();
// set the properties you want to alter
newModel.public = false;
// create a new record
newDocument = store.createRecord('document', newModel);
// call the cloneBelongsTo method after the record is created
cloneBelongsTo(model, newDocument);
// finally save the new model
newDocument.save(); 
```

# django - 如何显示作为最终 django 表单向导步骤输入的所有数据的预览？

> ID：14912429
> 
> 赞同：5
> 
> 时间：2013-02-16T16:23:57.553
> 
> 标签：django, django-forms, django-formwizard

我在 django 1.4 中使用表单向导有条件地添加最多七个模型的实例。无论用户完成哪些步骤，我都希望最后一步显示他们输入的所有数据的预览。它不必是表单，因为用户可以使用“第一步”或“上一步”按钮返回并修复他们搞砸的任何数据。我还想向用户发送一封确认电子邮件，其中包含他们的所有数据，我怀疑我在这里提出的任何解决方案也会为此提供数据。

这是我目前拥有的：

```
# views.py
FORMS = [
    ('person_application',  PersonApplicationForm),
    ('family_application',  FamilyApplicationForm),
    ('student_application', StudentApplicationForm),
    ('spouse',              SpouseForm),
    ('child',               ChildFormSet),
    ('roommate',            RoommateFormSet),
    ('preview',             Form), # only doing this because I think FormWizard requires a Form subclass for every step, which makes sense
]

TEMPLATES = {
    ...
    'preview':              'preview.html',
}

condition_dict = {
    ...
    'preview': True,
}

class SignupWizard(SessionWizardView):
    ...

    def get_context_data(self, form, **kwargs):
        context = super(SignupWizard, self).get_context_data(form=form, **kwargs)
        if self.steps.current == 'preview':
            context.update({'all_data': self.get_all_cleaned_data()})
        return context

    # # This is triggering an infinite loop or something because python gets stuck at 100+% cpu and won't stop even when I kill runserver
    # def get_form_initial(self, step):
    #     if step == 'preview':
    #         return self.get_all_cleaned_data()
    #     return {}

    ...

# urls.py
urlpatterns = patterns('app.views',
    ...
    url(r'^start$', SignupWizard.as_view(FORMS, condition_dict=condition_dict, instance_dict=modelform_instances), name='wizard'),
    url(r'^thanks$', 'thanks', name='thanks'),
) 
```

如您所见，在某些时候我想我会尝试实际使用表单进行预览，所以我尝试覆盖 WizardView.get_form_initial。我想使用 WizardView.get_all_cleaned_data() 来提供所有数据作为表单的初始字典。但是，正如我在评论中提到的那样，这导致 python 卡住了，我不得不手动查找并终止该进程以停止它。

所以现在我想我将重写 WizardView.get_context_data() 以向包含用户输入的所有数据的模板发送一个额外的上下文变量（同样，使用 get_all_cleaned_data()）。但是，由于几个原因，这将有点复杂。由于我的任何模型中具有相同名称的任何字段都会相互影响，因此我必须返回并命名所有模型字段名称。这似乎是不必要的，但无论如何。此外，我的两个表单是 ModelFormSets，因此来自它们的数据以字典列表的形式出现。没什么大不了的，但它会使模板中的解析更加困难。这个问题越来越长，但查看数据可能会有所帮助，所以这里有一个 get_all_cleaned_data() 当前返回的示例（当它被发送到模板时）：

```
{'all_data': {'birthdate': datetime.date(1940, 2, 5),
              'building_pref_1': u'NGH4',
              'building_pref_2': u'K2',
              'city': u'Nashville',
              'country': u'',
              'email': u'johnny@cash.com',
              'first_name': u'Johnny',
              u'formset-child': [{'birthdate': datetime.date(2013, 2, 3),
                                  'gender': u'F',
                                  'id': None,
                                  'name': u'Rosanne'},
                                 {'birthdate': datetime.date(2013, 2, 1),
                                  'gender': u'F',
                                  'id': None,
                                  'name': u'Cathy'},
                                 {'birthdate': datetime.date(2013, 2, 5),
                                  'gender': u'F',
                                  'id': None,
                                  'name': u'Cindy'},
                                 {'birthdate': datetime.date(2013, 2, 2),
                                  'gender': u'F',
                                  'id': None,
                                  'name': u'Tara'},
                                 {},
                                 {}],
              'furnishing': u'F',
              'gender': u'F',
              'global_id': u'',
              'last_name': u'Cash',
              'living_situation': u'SC',
              'middle_initial': u'',
              'move_in_date': None,
              'move_out_date': None,
              'name': u'Vivian Liberto',
              'phone': u'9891111111',
              'smoker_status': u'True',
              'state_province': u'TN',
              'street_1': u'street',
              'street_2': u'',
              'student_number': None,
              'term': <Term: Summer 2013>,
              'type': u'F',
              'university_status': u'O',
              'university_status_other': u'Travelling musician',
              'zip_code': u''}, 
```

所以，我的问题是，我是在正确的轨道上还是有更好的方法来做到这一点？例如，我是否可以使用 FormPreview 子类作为“预览”步骤的表单并将 FormPreview.done() 定义为

```
def done(self, request, cleaned_data):
    pass 
```

以便将数据传递给 FormWizard 的最终处理机制（即 WizardView.done()）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T09:38:04.190

我只是重写`get_template_name`以处理要显示的模板（假设您有一个用于“预览”步骤的特殊模板）。

然后我会重载`get_form`，将每个步骤的数据附加到一个实例变量中。

最后，我会重载`get_context_data`始终将该实例变量附加到我的模板上下文中。

重载 get_form 让您在显示预览之前操作数据。

# sql - 如何在某些情况下在两个字段值之间切换？

> ID：14912431
> 
> 赞同：1
> 
> 时间：2013-02-16T16:24:11.627
> 
> 标签：sql, linq, select, informix

像这样的表：

```
id  doc_before  doc_after
0      100
1      167         153
2      132 
```

* * *

我想得到`doc_after`if 存在 else 得到`doc_before`.

这该怎么做 ？

我想要这样的结果：

```
0    100
1    153
2    132 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:36:11.210

```
SELECT id
  , COALESCE(doc_after, doc_before) AS the_doc
FROM the_table
   ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:27:51.930

您可以使用`CASE`语句。这是受支持的 Informix 语法。

```
SELECT ID, CASE WHEN nvl(doc_after,'') <> '' THEN doc_after ELSE doc_before END AS doc
, CASE WHEN nvl(doc_after) <> '' THEN 'doc_after' ELSE 'doc_before' END AS camefrom
FROM yourtable 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T18:20:49.260

CASE 更惯用的用法将避免使用 NVL：

```
SELECT ID,
       CASE WHEN doc_after IS NULL THEN doc_before ELSE doc_after END AS doc_number,
       CASE WHEN doc_after IS NULL THEN 'B'        ELSE 'A'       END AS doc_source
  FROM AnonymousTable; 
```

显然，可以根据您的需要更改“之后”的编码“A”和“之前”的“B”。

# php - 使用 question2answer.org / Uniformserver (WAMP) 设置 LDAP 身份验证

> ID：14912435
> 
> 赞同：1
> 
> 时间：2013-02-16T16:24:40.110
> 
> 标签：php, authentication, configuration, question2answer

我一直在痛苦地尝试为[http://www.question2answer.org/](http://www.question2answer.org/)站点配置/设置 LDAP 插件。

我已经安装并配置了插件，但我仍然无法使用 AD/LDAP 登录。我尝试时出现的唯一错误是“找不到用户”。当我查看 apache 日志时，没有什么可以告诉我问题出在哪里。php 日志中也没有任何内容（除非我没有正确设置）。

有谁能帮忙安装吗？完整文件在这里： [https ://github.com/zakkak/qa-ldap-login/archive/master.zip](https://github.com/zakkak/qa-ldap-login/archive/master.zip)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-10-19T07:08:58.987

很可能，您输入的输入数据错误。首先尝试手动查询您的 ldap 服务器，例如，使用`ldapsearch`命令行工具。

`ldapsearch -x -LLL -h <host ip>:<port> -D "<binding account username>" -w "<binding account password>" -b"<directory to search in(base dn)>"`

上面的命令给了我一长串用户，经过一些试验和错误（他们是谷歌的）。

如果在正确输入您的数据后您收到“此页面未正确重定向”，请从初始管理员帐户更改您的电子邮件，使其与您从 ldap 收到的电子邮件不同。该插件有一个错误，如果一封电子邮件有两个用户（您是管理员，而您是来自 ldap db 的普通用户），它会将您重定向到[无限](https://github.com/zakkak/qa-ldap-login/issues/10)登录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-16T13:52:53.760

我遇到了同样的问题，我已经向项目发送了一些补丁。他们最近被录取了。请尝试再次安装并发布您的发现，我会为您提供帮助。

# javascript - jQuery each() 重写？

> ID：14912439
> 
> 赞同：0
> 
> 时间：2013-02-16T16:24:55.287
> 
> 标签：javascript, jquery, performance, jquery-plugins

我已经为一些`div`s 编写了一个插件。`textbox`是`div`s的类，`deactivateTextBox()`是插件。

我需要`deactivate`页面上的所有文本框。以下两段代码都在这样做吗？第二个效率更高吗？

1.  代码：

    ```
    $(".textbox").each(function(){
        $(this).deactivateTextBox(); 
    }); 
    ```

2.  `$(".textbox").deactivateTextBox();`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T16:26:15.073

1.  是的，他们都做同样的事情。

2.  是的，第二个应该更有效，因为前者获取所有元素，将原始 DOM 元素传递给循环，然后用 jQuery 对象重新包装元素。

# php - Get Error: Fatal error: Call to undefined function: () in /homepages/44/d1895123746/htdocs/cll/index.php 在第 26 行。如何解决？

> ID：14912443
> 
> 赞同：0
> 
> 时间：2013-02-16T16:25:21.687
> 
> 标签：php, mysql, database

我想从我的 MySQL 数据库中接收数据。首先，这里是代码：

```
<!DOCTYPE html> 
<html>
<head>
<meta charset="UTF-8">
<title>Filmliste</title>
<link href="http://code.jquery.com/mobile/1.0a3/jquery.mobile-1.0a3.min.css" rel="stylesheet" type="text/css"/>
<script src="http://code.jquery.com/jquery-1.5.min.js" type="text/javascript"></script>
<script src="http://code.jquery.com/mobile/1.0a3/jquery.mobile-1.0a3.min.js" type="text/javascript"></script>
</head> 
<body> 

<div data-role="page" id="page">
    <div data-role="content">   
        <ul data-role="listview">
            <?php
            $db = mysql_connect('12345.db.1and1.com', 'dbo42545132301', 'password', 'db4255412601') or die('Fail');
            $sql = "SELECT * FROM movielist";
            $ergebnis = mysql_query($sql);
            while($row = mysql_fetch_object($ergebnis))
            {
            ?>
            <li><a href="/detail.php"><?php $row->cover; ?>&nbsp;<?php $row->titel; ?></a></li>
            <?php

}

$mysql_close($db);
?>
        </ul>       
    </div>
</div>

</body>
</html> 
```

如果我在浏览器中加载它，我会得到：致命错误：调用未定义函数：（）在第 26 行的 /homepages/44/d18421343246/htdocs/project/index.php

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T16:27:07.687

您之前使用的是 $`mysql_close()`

```
$mysql_close($db); 
```

应该

```
mysql_close($db); 
```

**注意**：[**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。

所以要么使用要么[`PDO`](https://stackoverflow.com/a/14110189/1723893)（`MySQLi`IMO PDO 是可行的方法）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-16T17:50:50.483

1） `$mysql_close($db); ----> "$"`不应该在那里。

2) 使用 echo before`$row->cover`和`$row->titel` ----> 可能 " `titel`" 拼写错误

3）`mysql_select_db("db4255412601", $db);` 改为使用。

代码示例---

```
 <!DOCTYPE html> 
    <html>
    <head>
    <meta charset="UTF-8">
    <title>Filmliste</title>
    <link href="http://code.jquery.com/mobile/1.0a3/jquery.mobile-1.0a3.min.css" rel="stylesheet" type="text/css"/>
    <script src="http://code.jquery.com/jquery-1.5.min.js" type="text/javascript"></script>
    <script src="http://code.jquery.com/mobile/1.0a3/jquery.mobile-1.0a3.min.js" type="text/javascript"></script>
    </head> 
    <body> 

    <div data-role="page" id="page">
        <div data-role="content">   
            <ul data-role="listview">
                <?php
                $db = mysql_connect('12345.db.1and1.com', 'dbo42545132301', 'password') or die('Fail');

                mysql_select_db("db4255412601", $db);
                $sql = "SELECT * FROM movielist";
                $ergebnis = mysql_query($sql);

                while($row = mysql_fetch_object($ergebnis))
                { 
                ?>
                <li><a href="/detail.php"><?php echo $row->cover; ?>&nbsp;<?php echo $row->titel; ?></a></li>
                <?php

    }

    mysql_close($db);
    ?>
            </ul>       
        </div>
    </div>

    </body>
    </html> 
```

# javascript - Opera 找不到元素

> ID：14912444
> 
> 赞同：0
> 
> 时间：2013-02-16T16:25:25.663
> 
> 标签：javascript, exception, opera

我尝试在几个不同的浏览器中运行我的网站。它可以在所有浏览器中完美运行，例如 firefox、chrome 和 internet explorer。

当我尝试在 Opera 中运行它时，它在`document.getElementById('loader-graphics').appendChild(ldrInstance.canvas);`通话时崩溃了。它说如下：`Unhandled Error: Cannot convert 'document.getElementById('loader-graphics')' to object`。

我尝试了一切，似乎歌剧找不到`div`id `loader-graphics`。有谁知道如何解决这一问题？

我使用了以下 html 代码：

```
<div id="loader">
        <div id="block-bottom"></div>
        <div id="block-top">
            <div id="etine-image"></div>
            <div id="block-mid">
                <div id="loader-graphics"></div>
            </div>
        </div>
    </div> 
```

# cocoa-touch - 如何使用 Novocaine 获得特定频率的分贝

> ID：14912451
> 
> 赞同：2
> 
> 时间：2013-02-16T16:26:00.980
> 
> 标签：cocoa-touch, audio, novocaine

目前我正在使用[AurioTouch](http://developer.apple.com/library/ios/#samplecode/aurioTouch2/Introduction/Intro.html)并从麦克风获取声音。但是我在缓冲一首长歌时遇到了麻烦…… [Novocaine](https://github.com/alexbw/novocaine)似乎可以很好地处理音频播放，并且拥有我需要的一切，除了我无法弄清楚如何在特定频率下检索声音幅度（分贝）。

```
 NSURL *inputFileURL = [[NSBundle mainBundle] URLForResource:@"TLC" withExtension:@"mp3"];        

fileReader = [[AudioFileReader alloc] 
              initWithAudioFileURL:inputFileURL 
              samplingRate:audioManager.samplingRate
              numChannels:audioManager.numOutputChannels];

[fileReader play];

[audioManager setOutputBlock:^(float *data, UInt32 numFrames, UInt32 numChannels)
 {
     [fileReader retrieveFreshAudio:data numFrames:numFrames numChannels:numChannels];
// i believe here should lay the code for detecting the amplitude at 1000 HZ
 }]; 
```

我对声音分析太笨了，欢迎任何帮助！

# django - 使用 Django 自定义管理器

> ID：14912452
> 
> 赞同：0
> 
> 时间：2013-02-16T16:26:07.753
> 
> 标签：django, django-models

谁能帮我创建一个执行以下操作的自定义管理器......

这对我来说只是一个学习练习，它不是一个真正的应用程序，所以我尽可能多地解释。

**1) 需要 2 个对象，它的自身 (Person) 和 Profile**

**2) 将 person.age 与 profile.dog_years 分开**

**3）将此添加到模型**

我的猜测是，首先我在我的 models.py 中创建了一个自定义管理器

```
class PersonManager(models.Manager):
    def make_score(self,profile): 
```

然后我在自定义管理器中计算 self.age / profile.dog_years。

那么有的怎么退货呢？

将其添加到模型中，即 dogAge = PersonManager()

**结果：**

**然后我希望发生的是，当我让视图中的所有人返回 Profile.objects.filter() （此处以某种方式传递配置文件？）时，它有一个名为 dogAge 的新字段，其中列出了所有人员的狗年龄。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T18:23:17.080

这不是您在经理中要做的事情。这是普通模型方法的工作。

管理器方法用于以某种方式修改查询的事物。这不是您想要做的：您想为查询集中的每个对象注释一个属性。由于这不需要任何进一步的数据库计算，因此模型方法是合适的地方。

# django - 未呈现 Django 注册额外字段

> ID：14912453
> 
> 赞同：0
> 
> 时间：2013-02-16T16:26:10.420
> 
> 标签：django, django-registration

我正在尝试在 Django-registration 的注册页面上添加一些额外的字段，例如“城市”。我遵循了这种[方法](http://dmitko.ru/django-registration-form-custom-field/)，但表单没有呈现额外的字段“城市”和“条款和服务”复选标记。此外，当我通过 Django 调试工具栏检查视图是否正确时，它会正确显示附加字段。不知道为什么额外的字段没有呈现在表单上。

**表格.py**

> ```
> from django.contrib.gis import forms
> from django.contrib.auth.models import User
> from django.db.models import Q
> from dirapp.models import UserProfile
> from django import forms
> from registration.forms import RegistrationForm, RegistrationFormTermsOfService
> from django.forms import ModelForm
> from django.utils.translation import ugettext_lazy as _
> from registration.models import RegistrationProfile
> from forms import *
> 
> class UserProfileForm(forms.ModelForm):
> 
>     class Meta:
>         model = UserProfile
>         exclude = ('user')
>         widgets = {
>                  'point': forms.HiddenInput(),
>                  }
> 
> RegistrationForm.base_fields.update(UserProfileForm.base_fields)
> 
> attrs_dict = { 'class': 'required' }
> 
> class UserRegistrationForm(RegistrationFormTermsOfService):
>         city = forms.CharField(max_length=3, label='whatisyourcity', widget=forms.TextInput(attrs=attrs_dict)) 
> ```

**网址.py**

```
from django.conf.urls.defaults import *
from django.views.generic import *
from django.conf import settings
from django.conf.urls.static import static
# Uncomment the next two lines to enable the admin:
from django.contrib import admin
#from companies.models import Lead,Company
from dirapp.views import index, user_profile_crud, user_profile, add_listing, listing_detail, edit_listing, place_query, lead_detail, software_detail, add_vote_soft, software_list, add_classified, classified_detail,classified_list
from dirapp.models import UserProfile, Listing,Software,classified
admin.autodiscover()
from django.contrib.auth.decorators import login_required
from django.views.generic import list_detail
from djangoratings.views import AddRatingFromModel
from dirapp.forms import UserRegistrationForm
from registration.views import register
import registration.backends.default.urls as regUrls

listing_list = {"queryset":Listing.objects.all()}

urlpatterns = patterns('',

    # Uncomment the admin/doc line below to enable admin documentation:
    # url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

    # Uncomment the next line to enable the admin:
    url(r'^admin/', include(admin.site.urls)),
    #url(r'^contact/$', login_required(TemplateView.as_view(template_name="companies/contact.html"))),   
    url(r'^$',index,name='index'),
    url(r'^accounts/vendor-register/$', register, { 'backend': 'registration.backends.default.DefaultBackend','form_class':UserRegistrationForm}, name='registration_register'),    
    url(r'^accounts/', include(regUrls)), 
    url(r'^profile/$', user_profile, name='user-profile-view'),
    url(r'^profile/edit/$', user_profile_crud, name ='user-profile-crud'), 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-07T20:50:02.333

因为您正在扩展 RegistrationFormTermsOfService，而不是

```
RegistrationForm.base_fields.update(UserProfileForm.base_fields) 
```

利用

```
RegistrationFormTermsOfService.base_fields.update(UserProfileForm.base_fields) 
```

# vb.net - 在设计时从另一个表单引用 UserControl 的组成 TextBox vb.net

> ID：14912468
> 
> 赞同：0
> 
> 时间：2013-02-16T16:27:46.680
> 
> 标签：vb.net

就在前面，我正在用 vb 代码编写，而不是 c#。

我已经检查了建议的论坛主题，但没有一个适用，（我可以找到）所以就在这里。我对 vb.net 比较陌生。（来自vb6）

我正在创建一个`control_1`包含文本框和按钮的用户。`Control_1`从另一个用户继承`control_2`（一些文本框和日历表单按钮）。当我按下按钮时，它会启动一个包含`CalendarControl`.

到目前为止工作正常。

现在我需要将`CalendarControl`其日历表单上的值返回给未就座的用户`control_1`。我在这里谈论设计时间，用户`Control_1`还没有坐在表单上。

我不想从它就座的表格中触发日历表格，因为我希望封装这个过程。

我将代码编写为基于表单的应用程序，以确保我的逻辑和应用程序正常工作。现在我正在尝试将代码和组成控件移动到控件库中。

我试过`Usercontrol_1`从我的日历表单中调用，但它没有显示我的任何共享控件或属性。我已经尝试`Me.Parent.Controls`过 For Each 循环。它找到了控件，但说我需要使用 New 关键字。我尝试了新的，它没有工作。也许我误解了智能在说什么。

提前感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:35:45.533

在设计时，您不能单击打开另一个表单的按钮。因此，我真的不确定您在设计时要实现什么。

我不知道您使用的日历控件。因此，我将解释使用`DateTimePicker`. 在日历表单上（我们称之为`fdlgCalender`添加一个属性，允许公开访问日历控件的选定日期：

```
Public Property SelectedDate() As Date
    Get
        Return DateTimePicker1.Value
    End Get
    Set(ByVal value As Date)
        DateTimePicker1.Value = value
    End Set
End Property 
```

在您`UserControl`包含日历按钮上，创建一个类似的属性。这次我们使用一个可以为空的日期来表示没有选择日期的情况

```
Public Property SelectedDate As Date? 
```

现在您可以像这样调用日历表单：

```
Dim fdlg As New fdlgCalender()
If SelectedDate.HasValue Then
    fdlg.SelectedDate = SelectedDate.Value
Else
    fdlg.SelectedDate = Today
End If

' Assuming that the dialog form sets the `DialogResult` correctly
If fdlg.ShowDialog() = DialogResult.OK Then
    SelectedDate = fdlg.SelectedDate
Else
    SelectedDate = Nothing
End If 
```

现在，您可以通过该`SelectedDate`属性从用户控制之外访问日期。

（代码未经测试）

# c++ - 回调函数的格式化输出

> ID：14912472
> 
> 赞同：-1
> 
> 时间：2013-02-16T16:28:09.717
> 
> 标签：c++, sqlite

我有以下回调函数。

```
// This is the callback function to display the select data in the table
static int callback(void *NotUsed, int argc, char **argv, char **szColName)
{
  for(int i = 0; i < argc; i++)
  {
      std::cout << " = " << argv[i] << std::endl;
  }

  std::cout << "\n";

  return 0;
}

// prepare our sql statements
const char *pSQL[6];
pSQL[0] = "SELECT * FROM User";

// execute sql
for(int i = 0; i < 1; i++)
{
    rc = sqlite3_exec(db, pSQL[i], callback, 0, &szErrMsg);
    if(rc != SQLITE_OK)
    {
        std::cout << "SQL Error: " << szErrMsg << std::endl;
        sqlite3_free(szErrMsg);
        break;
    }
} 
```

产生以下输出

```
1
mark
mark@email.com
98989898
mark
mark
ADMN
U
Where are you studying
SIM
0

2
ken
ken@email.com
92222898
ken
ken
ADMN
U
Where are you studying
SIM
0

3
joseph
joseph@email.com
92333718
joseph
joseph
ADMN
U
Where are you studying
SIM
0

4
ricky
ricky@email.com
81822801
ricky
ricky
ADMN
U
Where are you studying
SIM
0

5
ck
ck@email.com
94567828
ck
ck
ADMN
U
Where are you studying
SIM
0 
```

我需要像这样水平格式化而不是垂直格式化：

```
1    mark      mark@email.com      98989898    mark      mark      ADMN    U    Where are you studying    SIM    0
2    ken       ken@email.com       92222898    ken       ken       ADMN    U    Where are you studying    SIM    0
3    joseph    joseph@email.com    92333718    joseph    joseph    ADMN    U    Where are you studying    SIM    0
4    ricky     ricky@email.com     81822801    ricky     ricky     ADMN    U    Where are you studying    SIM    0
5    ck        ck@email.com        94567828    ck        ck        ADMN    U    Where are you studying    SIM    0 
```

我尝试在回调函数中使用它：

```
1) std::cout << argv[i] << "\t";
2) std::cout << argv[i] << setw(15);
3) std::cout << setw(15) << argv[i]; 
```

但它给我的只是格式错误的行。

```
1   mark    test@email.com  98989898    mark    mark    ADMN    U   Where are you studying  SIM 0   
2   ken ken@email.com   92222898    ken ken ADMN    U   Where are you studying  SIM 0   
3   joseph  joseph@email.com    92333718    joseph  joseph  ADMN    U   Where are you studying  SIM 0   
4   ricky   ricky@email.com 81822801    ricky   ricky   ADMN    U   Where are you studying  SIM 0   
5   ck  ck@email.com    94567828    ck  ck  ADMN    U   Where are you studying  SIM 0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:31:43.183

你想要[`std::setw`](http://en.cppreference.com/w/cpp/io/manip/setw)和可能的[`std::left`](http://en.cppreference.com/w/cpp/io/manip/left)操纵器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:55:11.153

不要`std::endl`在`for`循环内使用。该操纵器使`for`循环中的每个项目都打印在新行上。

# database - mru 内部程序出错：ORA-20001 / Timestamp / NULL primary Keys

> ID：14912475
> 
> 赞同：1
> 
> 时间：2013-02-16T16:28:19.703
> 
> 标签：database, oracle, oracle-apex

感谢到目前为止的家伙，

我觉得我在你的帮助下越走越远！

但是，当我使用 oracle 提供的表单向导时，我现在遇到了另一个问题。

我遇到的问题是，在按照向导要求设置主键列时，我一旦设置了主键列，就无法向其中添加 ROWS。

为了了解我的意思是这个例子：

[![表格截图](../Images/08e99f00587e0f4fd3aa0affaa8de0be.png)](https://i.stack.imgur.com/wCMxk.jpg)

无法添加日程编号。

这是该表的 SQL：

```
CREATE TABLE  "MACHINE_SCHEDULE" 
   (    "SCHEDULE_NUMBER" VARCHAR2(40 CHAR), 
    "MACHINE_NO" VARCHAR2(10 CHAR), 
    "MACHINE_USE_DATE" DATE, 
    "START_TIME" TIMESTAMP (3) WITH TIME ZONE, 
    "END_TIME" TIMESTAMP (3) WITH TIME ZONE, 
    "PROCESS" VARCHAR2(164 CHAR), 
    "BATCH_NO" VARCHAR2(10 CHAR), 
    "MATERIAL_BAR_NO" NUMBER(8,0), 
    "TECHNICIAN_STAFF_NO" VARCHAR2(15 CHAR), 
     CONSTRAINT "MACHINE_SCHEDULE_PK" PRIMARY KEY ("SCHEDULE_NUMBER") ENABLE
   )
/
ALTER TABLE  "MACHINE_SCHEDULE" ADD CONSTRAINT "MACHINE_SCHEDULE_CON" FOREIGN KEY ("TECHNICIAN_STAFF_NO")
      REFERENCES  "MODULE_TECHNICIAN" ("TECHNICIAN_STAFF_NO") ENABLE
/
ALTER TABLE  "MACHINE_SCHEDULE" ADD CONSTRAINT "MACHINE_SCHEDULE_FK" FOREIGN KEY ("BATCH_NO")
      REFERENCES  "BATCH" ("BATCH_NO") ENABLE
/
ALTER TABLE  "MACHINE_SCHEDULE" ADD CONSTRAINT "MACHINE_SCHEDULE_FK2" FOREIGN KEY ("MATERIAL_BAR_NO")
      REFERENCES  "MATERIAL_BAR" ("MATERIAL_BAR_NO") ENABLE
/

CREATE OR REPLACE TRIGGER  "BI_MACHINE_SCHEDULE" 
  before insert on "MACHINE_SCHEDULE"               
  for each row  
begin   
  if :NEW."SCHEDULE_INSTANT_NUMBER" is null then 
    select "MACHINE_SCHEDULE_SEQ".nextval into :NEW."SCHEDULE_INSTANT_NUMBER" from dual; 
  end if; 
end; 

/
ALTER TRIGGER  "BI_MACHINE_SCHEDULE" DISABLE
/ 
```

但是，当我尝试将行添加到表中时，出现错误：

```
Error in mru internal routine: ORA-20001: Error in MRU: row= 1, 
ORA-01438: value larger than specified precision allowed for this column, 
insert into "GROUP7_1"."MACHINE_SCHEDULE" ( "SCHEDULE_NUMBER", "MACHINE_NO", "MACHINE_USE_DATE", "START_TIME", "END_TIME", "PROCESS", "BATCH_NO", "MATERIAL_BAR_NO", "TECHNICIAN_STAFF_NO") 
values ( :b1, :b2, :b3, :b4, :b5, :b6, :b7, :b8, :b9) 
```

# css - 设计/定制一个 twitter 小部件？

> ID：14912482
> 
> 赞同：0
> 
> 时间：2013-02-16T16:30:00.377
> 
> 标签：css, twitter, widget

Twitter 似乎已经删除了大部分设置小部件样式的功能。但问题是我不断看到带有自定义小部件的网站。有什么办法仍然可以做到吗？我看到了一个关于将 JS 和 CSS 放在你自己的服务器上的教程。不过，它似乎不再那样工作了。有谁知道如何做到这一点？我需要我的小部件来完美契合我网站的主题。

我说的是删除小部件标题，从提要中隐藏图片等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T23:49:13.173

此 JS 片段将允许您将自定义 CSS 样式添加到 Twitter 嵌入小部件：[https ://github.com/kevinburke/customize-twitter-1.1](https://github.com/kevinburke/customize-twitter-1.1)

# c# - 将此 XML 文档转换为我的对象的最简单方法是什么？

> ID：14912483
> 
> 赞同：6
> 
> 时间：2013-02-16T16:30:09.393
> 
> 标签：c#, xml, converter, xmldocument

我有一个 XMLDocument 需要读取并转换为一组对象。我有以下对象

```
public class Location
{
      public string Name;
      public List<Building> Buildings;
}

public class Building
{
     public string Name;
     public List<Room> Rooms;
} 
```

我有以下 XML 文件：

```
 <?xml version="1.0" encoding="utf-8" ?>
 <info>
 <locations>
  <location name="New York">
  <Building name="Building1">
    <Rooms>
      <Room name="Room1">
        <Capacity>18</Capacity>
      </Room>
      <Room name="Room2">
        <Capacity>6</Capacity>
      </Room>
    </Rooms>
  </Building>

  <Building name="Building2">
    <Rooms>
      <Room name="RoomA">
        <Capacity>18</Capacity>
      </Room>
    </Rooms>
  </Building>
</location>
<location name ="London">
  <Building name="Building45">
    <Rooms>
      <Room name="Room5">
        <Capacity>6</Capacity>
      </Room>
  </Building>
</location>
</locations>
</info> 
```

这样做的最佳方法是什么？我应该自动将 xmldocument 序列化为对象，还是需要解析每个元素并手动转换为我的对象？特别是，我试图弄清楚如何转换集合（位置、建筑物等）。

将此 XML 文件基本上转换为

```
List<Location> 
```

对象？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-16T17:04:29.560

您可以从修复 XML 开始，因为在示例中您已经展示了未闭合的标签。您还可以将`<Building>`标签包装到一个`<Buildings>`集合中，以便能够在此 Location 类中拥有除建筑物之外的其他属性。

```
<?xml version="1.0" encoding="utf-8" ?>
<info>
  <locations>
    <location name="New York">
      <Buildings>
        <Building name="Building1">
          <Rooms>
            <Room name="Room1">
              <Capacity>18</Capacity>
            </Room>
            <Room name="Room2">
              <Capacity>6</Capacity>
            </Room>
          </Rooms>
        </Building>

        <Building name="Building2">
          <Rooms>
            <Room name="RoomA">
              <Capacity>18</Capacity>
            </Room>
          </Rooms>
        </Building>
      </Buildings>
    </location>
    <location name="London">
      <Buildings>
        <Building name="Building45">
          <Rooms>
            <Room name="Room5">
              <Capacity>6</Capacity>
            </Room>
          </Rooms>
        </Building>
      </Buildings>
    </location>
  </locations>
</info> 
```

一旦你修复了你的 XML，你就可以调整你的模型。我建议您在类中使用属​​性而不是字段：

```
public class Location
{
    [XmlAttribute("name")]
    public string Name { get; set; }

    public List<Building> Buildings { get; set; }
}

public class Building
{
    [XmlAttribute("name")]
    public string Name { get; set; }
    public List<Room> Rooms { get; set; }
}

public class Room
{
    [XmlAttribute("name")]
    public string Name { get; set; }
    public int Capacity { get; set; }
}

[XmlRoot("info")]
public class Info
{
    [XmlArray("locations")]
    [XmlArrayItem("location")]
    public List<Location> Locations { get; set; }
} 
```

现在剩下的就是反序列化 XML：

```
var serializer = new XmlSerializer(typeof(Info));
using (var reader = XmlReader.Create("locations.xml"))
{
    Info info = (Info)serializer.Deserialize(reader);
    List<Location> locations = info.Locations;
    // do whatever you wanted to do with those locations
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-16T16:34:23.077

只需使用 XML 序列化属性 - 例如：

```
public class Location
{
      [XmlAttribute("name");
      public string Name;
      public List<Building> Buildings;
}

public class Building
{
     [XmlAttribute("name");
     public string Name;
     public List<Room> Rooms;
} 
```

请记住 - 默认情况下，所有内容都将被序列化为 XML 元素 - 与对象名称相同:)

这样做加载：

```
using(var stream = File.OpenRead("somefile.xml"))
{
   var serializer = new XmlSerializer(typeof(List<Location>));
   var locations = (List<Location>)serializer.Deserialize(stream );
} 
```

# php - 用户 ID 到排行榜中的用户名 MYSQL

> ID：14912484
> 
> 赞同：0
> 
> 时间：2013-02-16T16:30:09.090
> 
> 标签：php, mysql

我想用用户名而不是 ID 创建一个排行榜。

这是我现在的 MYSQL 代码：

```
SELECT * FROM `wp_users_score` ORDER BY `wp_users_score`.`score` DESC LIMIT 0 ,3 
```

这是结果：

```
user_id| score
2      |    10156
9266   |    2110
3282   |    1960 
```

FROM `wp_users`我需要获取与 user_id 匹配的“ID” - 得分如下：

```
ID             |  score
Name1          |    10156
Name2          |    2110
Name3          |    1960 
```

这可能与 mysql 查询吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:31:16.913

```
SELECT wp_users_score.id, 
       wp_users.user_id 
  FROM wp_user_score 
 INNER JOIN wp_users 
         ON wp_user_score.id = wp_users.user_id 
 WHERE wp_users_score.id = $id; 
```

# facebook - Facebook 登录 - 如何在 localhost 和生产环境中进行开发？

> ID：14912485
> 
> 赞同：32
> 
> 时间：2013-02-16T16:30:21.700
> 
> 标签：facebook, security, iis, deployment

我正在开发一个使用 Facebook 登录的网站。现在，我希望能够让它在我的生产环境以及我的开发环境中工作。

在 Facebook 上，我可以提供一个网站网址，Facebook 可以重定向到该网址。这在我的开发阶段效果很好，但现在我希望它既能在生产中工作，又能在开发我的解决方案时工作。

我想一种方法是使用我的域导航在本地 IIS 上运行我的应用程序并更改我的主机文件，但这并不是最简单的解决方案！？

**-让它在两种环境中工作的*最简单方法是什么？***

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2015-05-24T17:43:28.327

*更新*：截至 2018 年，此设置的路径现在是产品 > Facebook 登录 > 设置 > 客户端 OAuth 设置，此答案的其余部分仍然有效。

* * *

有一个更好的办法。您只需将本地主机的有效回调 URL 添加到设置 > 高级 > OAuth 设置。

![在此处输入图像描述](../Images/a161a48ab90d8bd35dda4ced548d7c5c.png)

此方法允许您仍然拥有生产网站 URL，同时允许来自开发、登台、生产等的 oauth。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-07T22:36:14.567

在我使用这个大约 6 个月后，我找到了一个非常有效的解决方案，基于其他两个答案。

在 Facebook 中，我添加了两个应用程序：

*   生产应用程序
*   开发应用

然后，在我的`web.config`应用设置中，我有：

```
<!--Prod-->
<add key="_FacebookApiId" value="id"/>
<add key="_FacebookApiSecretId" value="secret_id"/>
<!--Dev-->
<add key="FacebookApiId" value="dev_id"/>
<add key="FacebookApiSecretId" value="dev_secret_id"/> 
```

这当然是通过助手类阅读的。

然后它在生产和本地主机上无缝运行，我和我的团队都很高兴。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-19T12:24:01.720

我也有同样的问题。

我发现的唯一解决方案是：

*   是的...编辑本地计算机上的主机文件：[如何在本地测试 Facebook 连接](https://stackoverflow.com/questions/2459728/how-to-test-facebook-connect-locally)
*   仅出于开发目的创建另一个 Facebook 应用程序：[本地主机上的 Facebook Oauth 用于在开发期间进行测试](http://candidcode.com/2012/07/26/a-guide-to-using-facebook-oauth-on-localhost-for-testing-during-development/)（该博客是关于 Rails 但根据环境使用不同应用程序的解决方案仍然适用于其他语言）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-04-07T11:30:30.900

当您的应用程序处于开发模式时，Facebook 仅允许 localhost OAuth 重定向。这意味着您无法在生产中运行您的应用程序*并*执行本地开发测试。

相反，您需要创建应用程序的测试变体。前往[https://developers.facebook.com](https://developers.facebook.com)并查看您的生产应用程序的仪表板。单击左上角的下拉菜单，然后选择**Create Test App**。

![](../Images/42165214259138c1e6bc460e2cd6e163.png)

这将使用与您的生产应用程序几乎相同的设置填充测试应用程序。但是，它为您提供了一个新的应用程序 ID 和应用程序密码，因此您需要在开发模式下运行时切换这些设置（正如其他答案所建议的那样）。

以下是有关测试应用程序的更多信息：[https ://developers.facebook.com/docs/apps/test-apps/](https://developers.facebook.com/docs/apps/test-apps/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-08T03:26:37.977

按照[此答案](https://stackoverflow.com/a/15124750/308909)中的建议，如果将移动 URL 设置为您的开发域（即本地主机）并将站点 URL 设置为您的生产域，它将起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-19T13:40:42.957

更新的方式。

> 在应用仪表板中，选择您的应用并转到产品 > Facebook 登录 > 设置。在客户端 OAuth 设置下，在有效 OAuth 重定向 URI 字段中输入您的重定向 URL 以成功授权。

访问[https://developers.facebook.com/docs/facebook-login/web](https://developers.facebook.com/docs/facebook-login/web)了解更多信息。

# ruby - 单引号内的插值

> ID：14912486
> 
> 赞同：14
> 
> 时间：2013-02-16T16:30:29.767
> 
> 标签：ruby, string, string-interpolation

如何在单引号内执行插值？

我尝试过这样的事情，但有两个问题。

```
string = 'text contains "#{search.query}"' 
```

1.  它不起作用
2.  我需要最终字符串将动态内容用双引号括起来，如下所示：

    ```
    'text contains "candy"' 
    ```

可能看起来很奇怪，但我正在使用的[宝石需要这个。](https://github.com/datasift/datasift-ruby)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-16T16:35:15.747

`%{text contains "#{search.query}"}`如果您不想转义双引号，则可以使用`"text contains \"#{search.query}\""`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-16T16:37:39.683

```
'Hi, %{professor}, You have been invited for %{booking_type}. You may accept, reject or keep discussing more about this offer' % {professor: 'Mr. Ashaan', booking_type: 'Dinner'} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-16T16:43:21.483

采用

```
%q(text contains "#{search.query}") 
```

这意味着用单引号开始字符串。或者，如果您想以双引号开头，请使用：

```
%Q(text contains '#{text}') 
```

# java - Java 模运算符和 PreIncrement - SCJA

> ID：14912487
> 
> 赞同：0
> 
> 时间：2013-02-16T16:30:30.220
> 
> 标签：java

我正在修改我的 SCJA 考试，我对这个问题和答案感到困惑。问题是运行和编译代码的结果是什么。

```
 public class Test{ 
       public static void main(String args[]){
         int counter = 0;
         for(int i=0; i< 4; ++i){
            for(int k=0; k< 4; ++k){
               system.out.println("Hello - "+ ++counter);
               if((k % 4) == 0)
               break;
            }
         }
       }
    } 
```

所以他们给出的答案是“Hello-1”，因为 0 % 4 = 0 但我的问题是 k 不应该是 1，因为它是预先递增的？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:32:16.137

for 循环具有以下结构：

```
for (initialization; condition; update) 
```

在每次`update`执行循环**后执行。**

因此，以下两个循环是相同的：

```
for (int i = 0; i < 10; i++) { 
```

和

```
for (int i = 0; i < 10; ++i) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:31:46.140

> 我的问题不应该`k`是 1，因为它已经预先增加了？

`++k`发生在循环迭代结束时，即语句之后*。*`if`

不管是`++k`还是`k++`;都没有区别 在任何一种情况下， 的第一个值`k`都是零。

> 所以他们给出的答案是`"Hello-1"`

这显然是不正确的，因为`counter`它从不增加并且在整个程序中保持为零。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:35:06.793

k 不能为 1。这是因为当 for 循环运行时，它只会在执行完循环内的所有代码后才会更新。由于循环甚至在第一次迭代完成之前就中断了，所以 k 保持为 0。

# loops - GAS 简单脚本不起作用

> ID：14912488
> 
> 赞同：0
> 
> 时间：2013-02-16T16:30:38.417
> 
> 标签：loops, google-apps-script

根据谷歌的说法，我有一个“按书本”的脚本，但它不起作用。

```
function capacityAlert() {
var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("counts");
var currentValue = sheet.getRange("D2:D13").getValues();
Logger.log('currentValue = '+currentValue);
var nRows = currentValue.length;
for(var i=0;i<nRows;i++)
{
    //Logger.log(currentValue[i][0]);
    Logger.log('row '+i+' col[0] = '+currentValue[i][0]);
    if(currentValue[i][0]=="true")
    {
      Browser.msgBox("Capacity Reached");
        //MailApp.sendEmail("dave@davelalande.com","Capacity Reached","Capacity Reached, \nplease check the sheet and remove the date.");
    }  
}
} 
```

这是日志所说的。

```
currentValue = false,false,false,false,false,false,false,false,false,false,false,true
row 0 col[0] = false
row 1 col[0] = false
row 2 col[0] = false
row 3 col[0] = false
row 4 col[0] = false
row 5 col[0] = false
row 6 col[0] = false
row 7 col[0] = false
row 8 col[0] = false
row 9 col[0] = false
row 10 col[0] = false
row 11 col[0] = true 
```

它不是邮寄的，所以我试图创建一个弹出窗口，看看脚本是否有效。我已经关闭并使用正在运行的三行弹出脚本测试了我的弹出窗口，所以我知道弹出窗口正在运行。

调试是空白的？我错过了什么？

感谢您提供的任何帮助。

戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T22:14:11.110

这就是对我有用的。

```
 if(currentValue[i][0]==true) 
```

感谢 ScampMichael、Serge 和 Phil 一直以来的帮助。

# iphone - performSelectorInBackground：导致 CocoaAsyncSocket 崩溃

> ID：14912491
> 
> 赞同：0
> 
> 时间：2013-02-16T16:31:10.457
> 
> 标签：iphone, objective-c

几天前我发现了 performSelectorInBackground:，我立即知道我的应用程序中有一个地方可以完美。

```
- (void)activate {

    waitForStartCode.text = @"Loading...";
    userNotifications.text = @"";
    timeRemaining.text = @"";
    [loadingNTP startAnimating];

    [self performSelectorInBackground:@selector(initializeEverything) withObject:nil];

} 
```

当我的视图可见时调用它。之前，当使用 CocoaAsyncSocket 连接 NTP 时间服务器时，我的应用程序冻结，直到此过程完成。我真的想要一个带有动画 UIActivityIndi​​catorView 的加载视图。

initializeEverything -(void) 中的所有内容都可以正常工作，除了使用 CocoaAsyncSocket 的 NTP 初始化。

```
[NetworkClock sharedNetworkClock]; 
```

我得到一个：

![在此处输入图像描述](../Images/e774ca6319316ebd287aedc44331fc32.png)

![在此处输入图像描述](../Images/5af565b4dfc066299e2a5c608956bb50.png)

![在此处输入图像描述](../Images/3957b4bad3f3caf243496f0a911f951d.png)

即使用我不熟练的眼睛，我也可以看出 CocoaAsyncSocket 并不意味着在后台运行。

有没有办法解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:45:38.137

CocoaAsyncSocket 支持异步网络。所以原则上你自己不需要后台线程来防止你的 UI 冻结：CocoaAsyncSocket 将为你处理后台通信。

我不能说您是否以“阻塞”方式使用框架，或者您正在做任何其他使您的 UI 阻塞的事情。但是，正如我所说，原则上您不需要自己管理后台线程。

# c# - 使用 Quartz.NET 调度 Cron 作业

> ID：14912494
> 
> 赞同：2
> 
> 时间：2013-02-16T16:31:15.150
> 
> 标签：c#, quartz-scheduler, jobs, quartz.net, quartz.net-2.0

我正在尝试使用 Quartz.NET 安排一些工作，但我无法让它工作。我尝试了以下代码，但在达到指定时间时没有任何反应。

```
 public void Test()
    {
        ISchedulerFactory schedulerFactory = new StdSchedulerFactory();
        IScheduler scheduler = schedulerFactory.GetScheduler();

        IJobDetail jobDetail = JobBuilder.Create<SatellitePaymentGenerationJob>()
            .WithIdentity("TestJob")
            .Build();
        ITrigger trigger = TriggerBuilder.Create()
            .ForJob(jobDetail)
            .WithCronSchedule("0 26 18 * * ?")
            .WithIdentity("TestTrigger")
            .StartNow()
            .Build();
        scheduler.ScheduleJob(jobDetail, trigger);
        scheduler.Start();
    } 
```

**更新：**

我还尝试了以下操作，以确保不是 Cron 表达式导致问题。也没有为我工作......

```
IJobDetail jobDetail = JobBuilder.Create<SatellitePaymentGenerationJob>()
                .WithIdentity("TestJob", "TestGroup")
                .Build();
            ITrigger trigger = TriggerBuilder.Create()  
                .ForJob(jobDetail)
                .WithSimpleSchedule(x=> x.RepeatForever().WithIntervalInSeconds(10).WithMisfireHandlingInstructionFireNow())
                .StartAt(new DateTimeOffset(DateTime.UtcNow.AddSeconds(10)))
                .WithIdentity("TestTrigger", "TestGroup")
                .Build();
            scheduler.ScheduleJob(jobDetail, trigger);
            scheduler.Start();
            Console.WriteLine(DateTime.UtcNow.ToLongTimeString());
            Console.WriteLine(trigger.GetNextFireTimeUtc()); 
```

请注意，它`trigger.GetNextFireTimeUtc()`返回一个有效的时间值，但该作业永远不会被触发。

我哪里做错了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-16T17:31:29.157

您的示例代码一切正常，可能是 SatellitePaymentGenerationJob 实现中的 Execute 方法错误，或者作业已执行但未在预期时间执行。以现在的形式，每天18:26开火，是你想要的吗？

与我的代码（工作）比较：

```
class Program
{
    static void Main(string[] args)
    {
        Test();
    }

    public static void Test()
    {
        ISchedulerFactory schedulerFactory = new StdSchedulerFactory();
        IScheduler scheduler = schedulerFactory.GetScheduler();

        IJobDetail jobDetail = JobBuilder.Create<SatellitePaymentGenerationJob>()
            .WithIdentity("TestJob")
            .Build();
        ITrigger trigger = TriggerBuilder.Create()
            .ForJob(jobDetail)
            .WithCronSchedule("0 45 20 * * ?")
            .WithIdentity("TestTrigger")
            .StartNow()
            .Build();
        scheduler.ScheduleJob(jobDetail, trigger);
        scheduler.Start();
    }
}

internal class SatellitePaymentGenerationJob : IJob
{
    public void Execute(IJobExecutionContext context)
    {
        Console.WriteLine("test");
    }
} 
```

# python - .htaccess 与 python 脚本

> ID：14912499
> 
> 赞同：3
> 
> 时间：2013-02-16T16:31:33.440
> 
> 标签：python, apache, .htaccess, web-applications

n00b 问题。我有一个 .htaccess 文件，其中包含以下内容：

```
AddHandler python-program .py
PythonHandler index 
```

我尝试编写另一个名为 script2.py 的程序，但是当我键入它时，它会重定向到 fileserver/index.py。有什么办法可以阻止这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:51:05.060

有不同的方式来配置 mod_python。我想你想要[python.publisher](http://www.modpython.org/live/mod_python-2.7.8/doc-html/tut-pub.html)。文档显示了这个配置：

```
AddHandler python-program .py
PythonHandler mod_python.publisher 
```

然后，对于您的示例， script2.py 将具有以下内容：

```
def index(req):
    # Your handler here 
```

请注意，文档说：

> 此处理程序允许通过 URL 访问模块内的函数和变量。

文档提供了这个示例（我已将其更改为使用 script2.py）：

```
def say(req, what="NOTHING"):
    return "I am saying %s" % what 
```

> URL [http://www.mysite.com/script2.py/say](http://www.mysite.com/script2.py/say)将返回“我没有说什么”。URL [http://www.mysite.com/hello.py/say?what=hello](http://www.mysite.com/hello.py/say?what=hello)将返回“我在打招呼”。

通常你不想暴露每个函数和变量。

> 如果出现以下情况，遍历将停止并且 HTTP_NOTFOUND 将返回给客户端：
> 
> *   任何遍历对象的名称都以下划线（“_”）开头。使用下划线保护不应从 Web 访问的对象。

# javascript - 如何使用正则表达式将字符串按空格拆分并忽略前导和尾随空格到单词数组中？

> ID：14912502
> 
> 赞同：77
> 
> 时间：2013-02-16T16:31:48.523
> 
> 标签：javascript, regex, string, whitespace, removing-whitespace

我通常在 JavaScript 中使用以下代码按空格分割字符串。

```
"The quick brown fox jumps over the lazy dog.".split(/\s+/);
// ["The", "quick", "brown", "fox", "jumps", "over", "the", "lazy", "dog."] 
```

即使单词之间有多个空白字符，这当然也有效。

```
"The  quick brown fox     jumps over the lazy   dog.".split(/\s+/);
// ["The", "quick", "brown", "fox", "jumps", "over", "the", "lazy", "dog."] 
```

问题是当我有一个具有前导或尾随空格的字符串时，在这种情况下，生成的字符串数组将在数组的开头和/或结尾包含一个空字符。

```
"  The quick brown fox jumps over the lazy dog. ".split(/\s+/);
// ["", "The", "quick", "brown", "fox", "jumps", "over", "the", "lazy", "dog.", ""] 
```

消除这些空字符是一项微不足道的任务，但如果可能的话，我宁愿在正则表达式中处理这个问题。有谁知道我可以使用什么正则表达式来实现这个目标？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2013-02-16T16:37:31.410

如果您对不是空格的位更感兴趣，您可以匹配非空格而不是在空格上拆分。

```
"  The quick brown fox jumps over the lazy dog. ".match(/\S+/g); 
```

请注意，以下返回`null`：

```
"   ".match(/\S+/g) 
```

所以最好的学习模式是：

```
str.match(/\S+/g) || [] 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-02-16T16:36:26.377

`" The quick brown fox jumps over the lazy dog. ".trim().split(/\s+/);`

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-02-16T16:37:33.283

您可以匹配任何非空白序列，而不是在空白序列处拆分：

```
"  The quick brown fox jumps over the lazy dog. ".match(/\S+/g) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-26T23:22:20.093

不像其他代码那样优雅，但很容易理解：

```
 countWords(valOf)
    {
        newArr[];
        let str = valOf;
        let arr = str.split(" ");

        for (let index = 0; index < arr.length; index++) 
       {
           const element = arr[index];
           if(element)
           {
              newArr.push(element);
           }
       }
       const NumberOfWords = newArr.length;

       return NumberOfWords;
   } 
```

# ruby-on-rails - SpineJS 处理服务器端 Rails 模型验证

> ID：14912503
> 
> 赞同：1
> 
> 时间：2013-02-16T16:31:54.110
> 
> 标签：ruby-on-rails, ruby-on-rails-3, javascriptmvc, spine.js

我有一个模型，我们称之为`Book`。在 Rails 中，当这本书被保存时，我验证它的 ISBN 号的唯一性。对于我的前端，我有一个简单的 SpineJS 应用程序，可以让我添加一本新书。

在 SpineJS 中：

```
class App.Book extends Spine.Model
  @configure 'Book', 'name', 'isbn'
  @extend Spine.Model.Ajax

  validate: ->
    "Name required" unless @name
    "ISBN required" unless @isbn 
```

在 Rails 中：

```
class Book < ActiveRecord::Base
  attr_accessible :name, :isbn
  validates :name, :presence => true
  validates :isbn. :presence => true, :uniqueness => true
end 
```

我的问题是，在我的 SpineJS 应用程序中，即使 Rails 服务器返回验证错误，它也会愉快地保存一本带有重复 ISBN 号的新书。

有没有办法在保存时处理这个错误客户端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:07:55.533

Spine 的手册声称：

> 如果验证确实在服务器端失败，则这是客户端验证逻辑中的错误，而不是用户输入的错误。

我看不出这如何轻松满足您的独特性要求。如果您可以将所有可能影响验证的数据库数据加载到客户端*，并且*您可以以某种方式避免所有多用户竞争条件，那么它*可能是可行的。*

 *您可以捕获“ajaxError”事件并告诉用户重试，尽管捕获“ajaxError”违背了手册中的建议。IIRC 您可能还需要对对象 ID 进行一些处理，以使 Spine 相信实际上并未创建新记录。

此外，您可以在用户编辑数据时触发先发制人的验证请求，但这只是为了方便用户。从理论上讲，您仍然可以在用户点击保存之前遇到其他人创建冲突记录的竞争条件。

就我个人而言，我转而使用 Backbone，因为我发现 Spine 对错误处理的粗心态度太可怕了。*

# javascript - 在加载 jQuery 之前将脚本附加到 jQuery 就绪方法

> ID：14912505
> 
> 赞同：0
> 
> 时间：2013-02-16T16:32:10.673
> 
> 标签：javascript, jquery, html, twitter-bootstrap, jquery-events

例如，bootstrap 将 jQuery 放在 html 的末尾，例如[http://twitter.github.com/bootstrap/examples/starter-template.html](http://twitter.github.com/bootstrap/examples/starter-template.html)

如果您想在加载 jQuery 脚本本身**之前插入一个代码块，例如**

```
<div id="test1"></div> 
<div id="test2"></div> 

<script>
   $(document).ready(function() {
     $('#test1').html('test1'); // not work, any workaround? the code must be put before..
   });
</script> 

<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script>
   $(document).ready(function() {
     $('#test2').html('test2'); // work
   });
</script> 
```

测试：http: [//jsfiddle.net/e5HKZ/](http://jsfiddle.net/e5HKZ/)

我希望同时显示 test1 和 test2。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:52:39.913

If you really have to put jQuery code before the line that loads jQuery itself, assign the function to `document.ready`.

```
window.document.ready = function() {
    $('#test1').html('test1');
}; 
```

When jQuery has been loaded, it reads the variable and executes the function at DOM ready.

Note that this is most likely undocumented behavior and might not work reliably or in future jQuery versions.

Demo: [http://jsfiddle.net/e5HKZ/1/](http://jsfiddle.net/e5HKZ/1/)

# seo - 如何确保垃圾邮件中的链接不会在搜索引擎结果中受益

> ID：14912511
> 
> 赞同：1
> 
> 时间：2013-02-16T16:33:18.243
> 
> 标签：seo, search-engine, robots.txt

我有一个维基网站。许多垃圾邮件发送者将其用于 seo。他们正在添加带有外部网站链接的垃圾邮件。有没有办法确保他们不会从中受益？我的想法是添加一个像 robots.txt 这样的文本文件来通知搜索引擎“不要考虑搜索结果的外部网站链接”。我不想阻止垃圾邮件发送者为了广告而创建帖子:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:34:19.097

当您在您的网站上输出链接时，将 rel="nofollow" 添加到链接中。

[http://support.google.com/webmasters/bin/answer.py?hl=en&answer=96569](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=96569)

他们仍然会通过链接向您的网站发送垃圾邮件，因此您也需要进行监控。

# parameters - 如何将 PARAMETERS 赋予批处理文件 .BAT 并使用 System.Shell.execute 执行它们

> ID：14912512
> 
> 赞同：0
> 
> 时间：2013-02-16T16:33:27.637
> 
> 标签：parameters, batch-file, shellexecute

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:51:58.760

为每个函数使用一个批处理标签。只需转到第一批参数指定的标签。每个“函数”都可以访问以 开头的附加参数`%2`。

```
@echo off
goto %1

:PARAMETER1
REM execute code here
exit /b

:PARAMETER2
REM execute code here
exit /b 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T18:00:08.887

我会让我的脚本有点不同：

```
@echo off
goto %1
goto :end

:: functions

:PARAMETER1 comment1
REM execute code here
exit /b 0

:PARAMETER2 comment2
REM execute code here
if %ERRORLEVEL%==1 ECHO goto :error
exit /b 0

:error
ECHO Error occurred with arg %1
timeout 10
exit 1

:: end of script
:end
ECHO Finished 
```

# bash - 如何使用 bash 显示具有两个子文件夹的文件夹？

> ID：14912513
> 
> 赞同：4
> 
> 时间：2013-02-16T16:33:36.663
> 
> 标签：bash, shell, awk

我通过 Cygwin 使用 bash。我有一个大文件夹 (a)，有许多子文件夹 (b)。这些子文件夹各有一个或两个子文件夹 (c)。我想找到所有具有两个子文件夹 (c) 的子文件夹 (b) 并输出它们。

结构如下：

```
a
 b1
  c1 
 b2
  c1
  c2
 b3
  c1
  c2 
```

到目前为止，我只知道如何使用`find`和管道输出主文件夹 (a) 中的所有子文件夹。

```
find . -type d > folders.txt 
```

如何仅`b`将具有两个`c`文件夹的所有文件夹输出到每行一个文件夹的文本文件？（在我的示例中，输出应为：

```
b2
b3 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T16:40:02.497

Try doing this using [awk](/questions/tagged/awk "show questions tagged 'awk'") :

```
cd a
find . -type d |
awk -F/ '{arr[$2]++}END{for (a in arr) {if (arr[a] == 3) print a}}' 
```

Or using [bash](/questions/tagged/bash "show questions tagged 'bash'") :

```
cd a
for i in */; do x=( $i/*/ ); (( ${#x[@]} == 2 )) && echo "${i%/}"; done 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-17T04:05:21.957

`..`有一个更简单的解决方案，它利用来自每个子目录的父目录链接将目录的链接计数增加 1的事实。没有子目录的目录的链接计数为 2（`.`和来自其自己父目录的链接其名称）。因此，具有两个子目录的目录的链接计数为 4：

```
find . -type d -links 4 
```

对目录进行其他硬链接是不合法的，因此不应出现误报。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:57:59.303

There is a terrific open-source utility that will do what you want. It's called "tree", and it has a lot of useful options. It's included in most Linux distributions, but you should be able to compile for Cygwin.

You can find "tree" at: [http://mama.indstate.edu/users/ice/tree/](http://mama.indstate.edu/users/ice/tree/)

You could also use Perl to this. It would be more flexible than a Bash shell script. Use the File::Find module in Perl ([http://perldoc.perl.org/File/Find.html](http://perldoc.perl.org/File/Find.html)), which would allow you to easily do what you want. Do you have Perl installed in your Cygwin environment? Do you know Perl? Let me know if you'd like me to post a Perl script to do this.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-16T17:08:43.923

试试这个**bash 脚本**-

```
#!/bin/bash

cd a
for i in `pwd`/* ; do
  if [ -d "$i" ]; then
    DIR=0;
    cd $i;
    for j in * ; do
    if [ -d "$j" ]; then
    let DIR=DIR+1;
    fi
    done
    if [ $DIR -eq 2 ]; then
    echo $i;
    fi
  fi
done 
```

假设脚本的名称是`test.sh`，你可以做

```
$./test.sh > folder.txt 
```

# javascript - 如何检测窗口外的 MouseUp 事件？

> ID：14912515
> 
> 赞同：8
> 
> 时间：2013-02-16T16:34:03.240
> 
> 标签：javascript, jquery

我正在寻找 jQuery 解决方案来检测`mouseup`窗口外。也就是说，在鼠标在窗口内被**按下**后，在仍然向下的同时将鼠标拖到外面，然后在外面释放，这就是事件应该触发的时间。

我试过`document.mouseup = function() {}`了，它没有帮助。我尝试按照[此处](https://stackoverflow.com/questions/1685326/responding-to-the-onmousemove-event-outside-of-the-browser-window-in-ie/1745382#1745382)的示例进行操作，但无法正确理解（我什至留下了评论寻求帮助，但还没有帮助..:()

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-16T16:38:38.103

I have a website that uses this event and it works as you described:

```
$(window).on('mouseup', function(){
   //your code here
}); 
```

~~Note: only tested in jQuery 1.8.3, but it *should* work in 1.9~~

jsFiddle confirms. Works in jQuery 1.9.1 and 2 beta: [http://jsfiddle.net/udRNx/1/](http://jsfiddle.net/udRNx/1/)

In case you didn't know, this piece of code must be placed in either `$(document).ready(fn)` or `$(window).onload(fn)`.

# javascript - 如何访问 jquery ui 组合框的项目源

> ID：14912516
> 
> 赞同：0
> 
> 时间：2013-02-16T16:34:03.603
> 
> 标签：javascript, jquery, user-interface, combobox

我希望能够从 javascript 访问 jquery ui 组合框的项目。有人知道如何从 jquery 中访问原始数据项或过滤列表吗？

我找到了以下建议，但无法让它们发挥作用：

```
$("combobox_selector")
.data("combobox")
.wrapper
.find("input")
.data("autocomplete")
.menu
.element;

or

$("input").autocomplete({
open: function (event, ui) {
    // menu is a jQuery object.
    var menu = $(this).data("autocomplete").menu.element; 
```

# openvpn - 查询重新。OpenVPN 提供商和加密

> ID：14912521
> 
> 赞同：-1
> 
> 时间：2013-02-16T16:34:42.027
> 
> 标签：openvpn

如果 OpenVPN 提供商的登录密码不安全，那么 openvpn 互联网连接的加密是否也可能被破坏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T13:21:56.280

No. The transferred data is encrypted by symmetrical encryption, which doesn't depend on the password. However I'm not sure if server certificate is checked during authentification. If yes, then you are secure and the only bad thing is that anyone with your password can connect to that VPN. If server certificate is not checked when using password auth, then this would mean the possibility of MITM (mad in the middle) attack during VPN creation.

# java - 公共类实例化异常

> ID：14912526
> 
> 赞同：0
> 
> 时间：2013-02-16T16:35:07.497
> 
> 标签：java, android, class, constructor

我创建了一个类，它的构造函数应该有 2 个参数，但是 Eclipse 给了我一个`InstantiationException`，我不知道为什么。我怎样才能解决这个问题？

这是`Sms`课程代码：

```
 public class Sms  {
        String message;
String phonenumber = "";
SharedPreferences  sp;
Context context;

        public Sms(String m, Context context)
        {

            message = m;
            this.context = context;
        } 

     public void sendSms()
        {
            sp  = PreferenceManager.getDefaultSharedPreferences(context);
               phonenumber = sp.getString("PHONE", "");

            SmsManager manager = SmsManager.getDefault();

            PendingIntent piSend = PendingIntent.getBroadcast(context, 0, new Intent("SMS_SENT"), 0);
            PendingIntent piDelivered = PendingIntent.getBroadcast(context, 0, new Intent("SMS_DELIVERED"), 0);

                    int length = message.length();

                    if(length > MAX_SMS_MESSAGE_LENGTH)
                    {
                            ArrayList<String> messagelist = manager.divideMessage(message);

                            manager.sendMultipartTextMessage(phonenumber, null, messagelist, null, null);
                    }
                    else
                    {
                            manager.sendTextMessage(phonenumber, null, message, piSend, piDelivered);
                    }

        }
    }

-------------------------------------------- 
```

* * *

和 LogCat：

```
02-16 17:20:26.579: E/AndroidRuntime(474): FATAL EXCEPTION: main
02-16 17:20:26.579: E/AndroidRuntime(474): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{mioc.programing.safetpin/mioc.programing.safetpin.Sms}: java.lang.InstantiationException: mioc.programing.safetpin.Sms
02-16 17:20:26.579: E/AndroidRuntime(474):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1569)
02-16 17:20:26.579: E/AndroidRuntime(474):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
02-16 17:20:26.579: E/AndroidRuntime(474):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
02-16 17:20:26.579: E/AndroidRuntime(474):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
02-16 17:20:26.579: E/AndroidRuntime(474):  at android.os.Handler.dispatchMessage(Handler.java:99)
02-16 17:20:26.579: E/AndroidRuntime(474):  at android.os.Looper.loop(Looper.java:123)
02-16 17:20:26.579: E/AndroidRuntime(474):  at android.app.ActivityThread.main(ActivityThread.java:3683)
02-16 17:20:26.579: E/AndroidRuntime(474):  at java.lang.reflect.Method.invokeNative(Native Method)
02-16 17:20:26.579: E/AndroidRuntime(474):  at java.lang.reflect.Method.invoke(Method.java:507)
02-16 17:20:26.579: E/AndroidRuntime(474):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
02-16 17:20:26.579: E/AndroidRuntime(474):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
02-16 17:20:26.579: E/AndroidRuntime(474):  at dalvik.system.NativeStart.main(Native Method)
02-16 17:20:26.579: E/AndroidRuntime(474): Caused by: java.lang.InstantiationException: mioc.programing.safetpin.Sms
02-16 17:20:26.579: E/AndroidRuntime(474):  at java.lang.Class.newInstanceImpl(Native Method)
02-16 17:20:26.579: E/AndroidRuntime(474):  at java.lang.Class.newInstance(Class.java:1409)
02-16 17:20:26.579: E/AndroidRuntime(474):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
02-16 17:20:26.579: E/AndroidRuntime(474):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1561)
02-16 17:20:26.579: E/AndroidRuntime(474):  ... 11 more 
```

* * *

这就是我从以下创建对象的方式`Activity`：

```
Intent open_SM = new Intent ("android.intent.action.SMS");
            startActivity(open_SM);
    Sms s = new Sms("trlababalan",this);
            s.sendSms() 
```

;

这是明显的

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="mioc.programing.safetpin"
    android:versionCode="1"
    android:versionName="1.0" >

      <uses-permission 
android:name="android.permission.ACCESS_FINE_LOCATION" /> 
  <uses-permission 
android:name="android.permission.ACCESS_COARSE_LOCATION" /> 
  <uses-permission 
android:name="android.permission.INTERNET" /> 
<uses-permission android:name="android.permission.SEND_SMS" />
<uses-permission android:name="android.permission.RECEIVE_SMS"/>
    <uses-sdk
        android:minSdkVersion="9"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="mioc.programing.safetpin.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

            <service android:name="TestService">
            </service>
             <activity
            android:name="mioc.programing.safetpin.Sms"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.SMS" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:47:47.957

您已在 Manifest 中声明`Sms`为 Activity：

```
<activity
    android:name="mioc.programing.safetpin.Sms"
    android:label="@string/app_name" > 
```

但`Sms`不扩展 Activity... 所以这些行会导致异常：

```
Intent open_SM = new Intent ("android.intent.action.SMS");
startActivity(open_SM); 
```

如果你想`Sms`作为一个 Activity 运行，你需要将整个类变成一个 Android Activity，或者如果你想`Sms`成为一个实用程序，不要使用 Intent`Sms`作为 Activity 启动。

# php - php图像中的会话

> ID：14912536
> 
> 赞同：0
> 
> 时间：2013-02-16T16:35:50.130
> 
> 标签：php, jquery, hidden-field

我正在处理一个在提交之前用 jQuery 验证的表单。其中一个字段是验证码。

这个想法很简单，验证码显示为图像并存储在隐藏字段中。当用户在输入字段中输入验证码时，它应该等于隐藏字段的值。这是我拥有的 jQuery 代码；

```
<script>
$(document).ready(function(){
$("#register").validate({ 
errorElement: 'div', ignore: 'hidden',
rules: {
      password: { 
            required: true
      }, 
      password2: { 
            required: true, equalTo: "#password"
      },
      agree: {
          required: true
      },
      captcha: {
          required: true, equalTo: "#captcha2"
      }
  },
messages: {
password2: "Please repeat the same password",
captcha: "The captcha you entered is wrong",
agree: "You have to be at least 16 years old and agree to the terms of service" 
}
});
});
</script> 
```

表单的 html 代码更简单，但我只展示其中的一部分。

```
<p>
<img src='/includes/captcha.php'  />
</p>
<p>
<label for="Captcha">Captcha</label>
<em> *</em><input type="text" name="captcha" id="captcha" size="25" 
class="require"   minlength="5" />
<input type="hidden" name="captcha2" id="captcha2" 
value="<?php echo    $_SESSION['captcha'];?>" />
<?php echo $_SESSION['captcha']; ?> 
```

这里有一些奇怪的东西。当我回显 session['captcha'] 时，我得到的值与隐藏字段中的值不同。当我回显它时，我得到了以前的验证码。

因此，假设验证码值为 ABC。当我刷新页面时，验证码+隐藏字段变为 DEF。但是当我回显 session['captcha'] 时，我仍然得到 ABC。

为什么会这样？

这是captcha.php文件的代码；

```
<?php  
session_start();
header("Content-type: image/png");

$string = '';  
for ($i = 0; $i < 5; $i++) {  
// this numbers refer to numbers of the ascii table (lower case)  
$string .= chr(rand(97, 122));  
}  
$_SESSION['captcha']    =   $string;
putenv('GDFONTPATH=' . realpath('.'));
$dir = 'musicals';  
$image = imagecreatetruecolor(170, 60);  
$black = imagecolorallocate($image, 0, 0, 0);  
$color = imagecolorallocate($image, 129, 180, 79); // green  
$white = imagecolorallocate($image, 255, 255, 255);  
imagefilledrectangle($image,0,0,399,99,$white);  
imagettftext ($image, 30, 0, 10, 40, $color, $dir, $_SESSION['captcha']);  
imagepng($image);   
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:47:42.123

问题是您的验证码生成在图像中，并且只有在访问表单后才能访问此图像。您的验证码是在您显示表单后生成的，这就是为什么它总是落后一步。

除此之外，将验证码解决方案存储在隐藏字段中是个坏主意。一个人，或者一个机器人，可以简单地解析网站的源代码并提取并使用它作为验证码解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:49:55.617

确保 captcha.php 在 html 代码之前运行。看起来 captcha.php 生成图像，并且可能将其作为 img 插入 HTML。图片是在页面加载（生成 HTML）后获取的，因此不会重新生成会话中的验证码。

我相信您以验证码为例插入了隐藏元素。将验证码显示为表单中的隐藏元素是个坏主意。

# ftps - 无法从 Ubuntu 使用 lftp 和 FTPS 连接到 Yahoo Webhosting

> ID：14912537
> 
> 赞同：3
> 
> 时间：2013-02-16T16:35:56.423
> 
> 标签：ftps, lftp

我正在运行 Ubuntu 12.10，我使用 Yahoo Webhosting，我也有自己的域“example.com”。我曾经使用 FTP 向/从我的虚拟主机帐户传输文件以更新我的网站。但是现在雅虎刚刚结束对 FTP 的支持，现在他们要求用户只能使用 FTPS。我对这一变化感到高兴，因为我知道 FTP 是不安全的，因此必须迁移到 FTPS。所以我找到了 lftp ( [http://lftp.yar.ru/](http://lftp.yar.ru/) )，它似乎是一个 FTPS 客户端，我可以用它来向/从 Yahoo Webhosting 传输文件。我可以使用“sudo apt-get install lftp”安装它，但是当我尝试连接到 Yahoo Webhosting 时，它不起作用。

这是我的系统信息：

user@hostname:~/Desktop >> 更多 /etc/issue.net Ubuntu 12.10

user@hostname:~/Desktop >> uname -a Linux mojave 3.5.0-23-generic #35-Ubuntu SMP Thu Jan 24 13:05:29 UTC 2013 i686 i686 i686 GNU/Linux

用户@主机名：~/桌面 >> lftp -v LFTP | 版本 4.3.8 | 版权所有 (c) 1996-2012 Alexander V. Lukyanov

LFTP 是免费软件：您可以根据自由软件基金会发布的 GNU 通用公共许可证的条款重新分发和/或修改它，无论是许可证的第 3 版，还是（由您选择）任何更高版本。

分发此程序的目的是希望它有用，但不提供任何保证；甚至没有对适销性或特定用途适用性的默示保证。有关详细信息，请参阅 GNU 通用公共许可证。

您应该已经收到了一份 GNU 通用公共许可证的副本以及 LFTP。如果没有，请参阅[http://www.gnu.org/licenses/](http://www.gnu.org/licenses/)。

将错误报告和问题发送到邮件列表。

使用的库：Readline 6.2、GnuTLS 2.12.14、zlib 1.2.7

这是我以前的做法：user@hostname:~/Desktop >> ftp username@ftp.example.com

现在，我尝试下面的命令，但它不起作用： user@hostname:~/Desktop >> lftp username@ftp.example.com Password: lftp username@ftp.example.com:~> ls
WARNING: gnome- keyring:: 无法连接到：/run/user/username/keyring-EvxB3g/pkcs11：没有这样的文件或目录 ls：致命错误：证书验证：不信任 lftp username@ftp.example.com:~> 退出

我究竟做错了什么？如何让 lftp 创建到 Yahoo Webhosting 的 FTPS 会话？

提前感谢您的帮助！！对此，我真的非常感激！！

史蒂夫麦克马洪

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T23:11:56.383

我花了一段时间才弄清楚这一点，但我能够像这样使用 lftp 让它工作：

```
lftp
set ssl:verify-certificate false
set ftp:ssl-force true
connect ftp.example.com
login username@somewhere.com
Password: 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-13T17:43:00.887

上面的方法适用于我使用 ftps 从 Ubuntu 14 连接到 Yahoo 虚拟主机。为了减少打字，上面显示的 lftp 命令被放置在一个文本文件中，并且 -f 用于读取文本文件。下面是两个文件，一个运行 lftp 的 shell 脚本和一个 lftp 脚本。

```
The shell script contains:
  #! /bin/bash
  # script name: ylist.sh
  echo "Get Directory List from Yahoo via FTPS"
  lftp -f ylist-script.txt

The ylist-script.txt file contains:
  set ssl:verify-certificate false
  set ftp:ssl-force true
  connect ftp.example.com
  login username@example.com
  ls 
```

这些从 yahoo webhosting 帐户的根目录检索目录列表。lftp 退出并且脚本完成时。

# c++ - 两个数组指向相同的信息

> ID：14912538
> 
> 赞同：-2
> 
> 时间：2013-02-16T16:36:02.837
> 
> 标签：c++, arrays, pointers

在第二个数组进行一些更改后，我有两个
数组我想让
第一个数组与第二个数组相同，
是否可以不逐个复制整个数组，
但是通过一个命令以某种方式使第一个数组指向
第二个数组的元素。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-16T16:39:35.673

No, an array is an object and on object is some region of storage. Two arrays are two separate regions of storage.

However, given a pointer to the first element of an array, you can use it to index the array just as you would with the array itself:

```
int arr[] = {1, 2, 3, 4, 5};
int* p = arr;
arr[2] == p[2]; 
```

I don't want to fuel the misconception that arrays and pointers are similar in any way, however. The first line defines an array object containing 5 `int`s. The second line defines a pointer that points to the first element in that array.

The reason they can both be used in the same way in the last line is because the name of the array, `arr`, is implicitly converted to a pointer to its first element before doing the indexing. So really those two sub-expressions are the same thing. `arr[2]` just involves an implicit conversion to a pointer before applying the indexing operator.

Alternatively, you can take a reference to an array:

```
int arr[] = {1, 2, 3, 4, 5};
int (&r)[5] = arr;
arr[2] == r[2]; 
```

Now `r` is just an alias for the array. Both `arr` and `r` literally refer to the array object.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-16T16:40:05.687

If you want to copy one element at a time, a simple `for` loop will do. If you want to copy all elements you could use e.g. `memcpy` (if, and only **if** your arrays have POD types).

Then there's of course [`std::copy`](http://en.cppreference.com/w/cpp/algorithm/copy):

```
int array1[5] = { ... };
int array2[5];

// Copy from `array1` to `array2`
std::copy(std::begin(array1), std::end(array1), std::begin(array2)); 
```

# c# - 当我不知道可能安装应用程序的文件夹时，如何将我的应用程序设置为在启动时运行？

> ID：14912541
> 
> 赞同：0
> 
> 时间：2013-02-16T16:36:21.447
> 
> 标签：c#

这是我的问题我最近学会了如何使用注册表，我试图找出一些我希望我的程序设置为在启动时通过单击按钮运行的东西，所以我应该在单击事件中编写一些代码我的创建注册表文件的按钮

```
"HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" 
```

然后将该注册表文件的值设置为我的应用程序所在的位置，只要我知道我的应用程序在哪里，这是一项简单的工作，但我的问题是我想为我的应用程序制作一个安装文件，并且用户将在他/她想要的任何地方安装我的应用程序我该怎么办？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:43:33.813

示例代码：

```
RegistryKey rk = Registry.CurrentUser.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);
rk.SetValue(AppName, Application.ExecutablePath.ToString()); 
```

# asp.net - 对子/孙进行空检查？

> ID：14912544
> 
> 赞同：0
> 
> 时间：2013-02-16T16:36:33.033
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

我有公寓和办公室，每个都有经理。

当经理登录时，我想向他们显示与他们的公寓或办公室相关的信息。

我正在尝试构建如下查询：

```
query = Buildings.Where(i => i.Apartment.Manager.Id == User.Id); 
```

但这只有在经理是公寓经理的情况下才有效。如果不是，我将得到一个 nullReferenceException，因为 i.Apartment 将有一半的建筑物为空。

如何检查此查询中的空值以避免在经理没有公寓或没有建筑物的情况下出现异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:46:02.803

```
query = Buildings.Where(i =>
    i.Apartment != null &&
    i.Apartment.Manager.Id == User.Id); 
```

# java - 未使用 createNewFile java 方法创建文件

> ID：14912545
> 
> 赞同：0
> 
> 时间：2013-02-16T16:36:43.037
> 
> 标签：java, java-io

我有一个读取方法，如果它不存在，它将尝试创建一个新文件，但是当我运行代码时，我得到一个**（系统找不到指定的文件）**错误。有人可以解释为什么它不创建文件吗？我还想知道如何在父目录中创建文件，而不是在当前保存它的目录中？

**代码：**

```
public Set<String> readWindowTitleSet() {
    try {
        File file = new File("windowData.out");

        String absolutePath = file.getAbsolutePath();
        String filePath = absolutePath.
            substring(0,absolutePath.lastIndexOf(File.separator));

        if (!file.exists()) {
            file.createNewFile();
        }

        FileInputStream fis = new FileInputStream(filePath +"\\..\\" + "windowData.out");
        // this is for testing in Eclipse.

        //FileInputStream fis = new FileInputStream(absolutePath);
        // This is for use in Jar file.

        ObjectInputStream ois = new ObjectInputStream(fis);
        anotherList = (HashSet<String>) ois.readObject();
        ois.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (ClassNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return anotherList;

} 
```

**错误**

```
java.io.FileNotFoundException: C:\Users\Joe\workspace\VocabTool\..\windowData.out (The     system cannot find the file specified)
at java.io.FileInputStream.open(Native Method)
at java.io.FileInputStream.<init>(Unknown Source)
at java.io.FileInputStream.<init>(Unknown Source)
at model.WindowTitleDataStore.readWindowTitleSet(WindowTitleDataStore.java:60)
at model.WindowTitleDataStore.<init>(WindowTitleDataStore.java:18)
at controller.InterruptionDecision.<clinit>(InterruptionDecision.java:23)
at view.MainGui.<init>(MainGui.java:29)
at view.MainGui.main(MainGui.java:38)
Exception in thread "main" java.lang.ExceptionInInitializerError
at view.MainGui.<init>(MainGui.java:29)
at view.MainGui.main(MainGui.java:38)
Caused by: java.lang.NullPointerException
at model.WindowTitleDataStore.<init>(WindowTitleDataStore.java:19)
at controller.InterruptionDecision.<clinit>(InterruptionDecision.java:23)
... 2 more 
```

**路径改变后的错误**

```
java.io.EOFException
at java.io.ObjectInputStream$PeekInputStream.readFully(Unknown Source)
at java.io.ObjectInputStream$BlockDataInputStream.readShort(Unknown Source)
at java.io.ObjectInputStream.readStreamHeader(Unknown Source)
at java.io.ObjectInputStream.<init>(Unknown Source)
at model.WindowTitleDataStore.readWindowTitleSet(WindowTitleDataStore.java:63)
at controller.InterruptionDecision.interruptNow(InterruptionDecision.java:165)
at controller.InterruptionDecision.updateWindowTitle(InterruptionDecision.java:74)
at controller.FocusWindowName.getFocusWindowTitle(FocusWindowName.java:27)
at controller.FocusWindowName.run(FocusWindowName.java:42)
at java.lang.Thread.run(Unknown Source)
Exception in thread "Thread-6" java.lang.NullPointerException
at model.WindowTitleDataStore.getWindowDataSize(WindowTitleDataStore.java:105)
at     controller.InterruptionDecision.getWindowDataStoreSize(InterruptionDecision.java:95)
at controller.InterruptionDecision.interruptNow(InterruptionDecision.java:168)
at controller.InterruptionDecision.updateWindowTitle(InterruptionDecision.java:74)
at controller.FocusWindowName.getFocusWindowTitle(FocusWindowName.java:27)
at controller.FocusWindowName.run(FocusWindowName.java:42)
at java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:40:08.757

`..`从你的路径中删除它

它应该是
`FileInputStream fis = new FileInputStream(filePath +"\\windowData.out");`

代替
`FileInputStream fis = new FileInputStream(filePath +"\\..\\" + "windowData.out");`

因为`filePath +"\\..\\" + "windowData.out"`将等于`C:\Users\Joe\workspace\VocabTool\..\windowData.out`which 不是您文件的有效位置。

虽然`filePath +"\\windowData.out"`将等于`C:\Users\Joe\workspace\VocabTool\windowData.out`我猜你的文件的有效位置（猜你在指定目录中有一个文件 windowData.out）

# php - SQL 连接或 PHP 循环？要不然是啥？

> ID：14912547
> 
> 赞同：2
> 
> 时间：2013-02-16T16:36:54.887
> 
> 标签：php, mysql

所以我有两个查询给我我需要的信息，我试图找出从他们那里得到结果的最佳方法。我有一个控股表。使用：

```
SELECT symbol, sum(shares) AS shares, sum(shares * price) AS cost 
FROM Transactions 
WHERE (action <>5) 
    AND date <= '2010-10-30' 
GROUP BY symbol HAVING sum(shares) > 0 
```

这导致

```
AGNC    50.00     1390.0000
RSO     1517.00   9981.8600
T       265.00    6668.7500 
```

然后我有另一个查询

```
SELECT close FROM History WHERE symbol = $symbol AND date = $date 
```

这将返回当天的收盘价。

```
T    24.40 
```

我想基本上为给定的日期计算值，所以每个符号的总和（股数 * 关闭）。但我不知道如何在 php 中循环遍历每一行。我希望有一个连接或我可以在 sql 中执行的操作以使数据以我想要的方式返回

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:44:16.527

我认为您可以执行类似的操作：[选择查询选择选择语句](https://stackoverflow.com/questions/2043845/a-select-query-selecting-a-select-statement) 将您的第二个查询按字面意思放在第一个查询中。不确定确切的语法，但喜欢：

```
SELECT 
    symbol, 
    sum(shares) AS shares, 
    sum(shares * price) AS cost, 
    sum(shares * close) as value 
FROM Transactions 
INNER JOIN History ON (symbol = $symbol AND date = $date)
WHERE (action <>5) 
    AND date <= '2010-10-30' 
GROUP BY symbol HAVING sum(shares) > 0 
```

不过，@popnoodles 对您的命名是正确的。如果您使用日期，我认为您需要[日期]。

# f# - F# 返回 ICollection

> ID：14912548
> 
> 赞同：3
> 
> 时间：2013-02-16T16:37:12.873
> 
> 标签：f#, icollection

我正在使用用 C# 创建的库。我一直致力于将一些代码移植到 F#，但必须使用 C# 库中的许多基础类型。

一段代码需要计算一个值列表并将其分配给类中的公共字段/属性。该字段是一个包含两个 ICollection 的 C# 类。

我的 F# 代码工作正常，需要返回一个 F# Seq/List。

我尝试了以下每个都会产生错误的代码片段。

*   F# 成员的返回类型是一个名为 recoveryList 的类型，类型为 Recoveries list
*   类中的公共字段，该类本身包含两个 ICollection 对象

    ```
    this.field.Collection1 = recoveries 
    ```

这给出了错误 Expected to have type ICollection but has type Recoveries list

```
this.field.Collection1 = new ResizeArray<Recoveries>() 
```

给出错误预期类型 ICollection 但为 ResizeArray

```
this.field.Collection1 = new System.Collections.Generic.List<Recoveries>() 
```

与上述相同的错误 - 预期 ICollection 但类型为 List

有任何想法吗？从 C# 的角度来看，这些操作似乎是有效的，并且 List/ResizeArray 实现了 ICollection 所以......我很困惑如何分配值。

我可以更改底层 C# 库的类型，但这可能有其他含义。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-16T17:13:14.333

F# 不像 C# 那样进行隐式转换。所以即使`System.Collections.Generic.List<'T>`实现了`ICollection`接口，你也不能*直接*将一些`ICollection`-typed 属性设置为`System.Collections.Generic.List<'T>`.

不过，修复很简单——您需要做的就是在分配之前添加一个明确的向上转换`ICollection`：`ResizeArray<'T>``System.Collections.Generic.List<'T>`

```
// Make sure to add an 'open' declaration for System.Collections.Generic
this.field.Collection1 = (recoveries :> ICollection) 
```

或者

```
this.field.Collection1 = (ResizeArray<Recoveries>() :> ICollection) 
```

# c# - Bulk insert in a specific column in SQL Server

> ID：14912549
> 
> 赞同：2
> 
> 时间：2013-02-16T16:37:19.777
> 
> 标签：c#, sql-server, database, bulkinsert

I have a table `dic` that has 2 columns `english` and `bangla`. I want to insert data into only the `bangla` column using bulk insertion from a text file.

I tried which can insert into 2 column

```
BULK INSERT dic
FROM 'C:\Users\Imon-Bayazid\Desktop\wordddd\good one\test.txt'
WITH
(
   FIELDTERMINATOR = '\n',
   ROWTERMINATOR = '\n'
) 
```

But how can I do into one specific column???

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:48:47.263

[您可以使用格式文件](http://msdn.microsoft.com/en-us/library/ms178129.aspx)从源文件中的字段映射到目标表中的字段。

我假设您知道批量插入仅用于插入新行，而不用于更新。

所以你可能有这样的格式文件：

```
<?xml version="1.0"?>
<BCPFORMAT 
     xmlns="http://schemas.microsoft.com/sqlserver/2004/bulkload/format"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
 <RECORD>
  <FIELD ID="1" xsi:type="CharTerm" TERMINATOR="\n"/>
  ... other fields?
 </RECORD>
 <ROW>
  <COLUMN SOURCE="1" NAME="bangla"/>
 </ROW>
</BCPFORMAT> 
```

表 'dic' 中的任何其他列都需要可以为空或具有默认值。

然后将格式文件指定为 BULK INSERT 语句的选项

```
BULK INSERT dic
FROM 'C:\Users\Imon-Bayazid\Desktop\wordddd\good one\test.txt'
WITH
(
   FIELDTERMINATOR = '\n',
   ROWTERMINATOR = '\n',
   FORMATFILE = 'path to my format file.xml'
) 
```

# ruby - $1 variable in a block in an aliased method

> ID：14912550
> 
> 赞同：1
> 
> 时间：2013-02-16T16:37:23.703
> 
> 标签：ruby, monkeypatching

How can I create an aliased method that wraps a method that yields to a block that uses `$1` variables?

More specifically, I want to monkeypatch `String#sub` (yes, I know that it is not a good practice) to modify the regexps passed to it before they are used.

I tried the following code without success.

```
class String
    alias :sub_orig :sub
    def sub(*args, &block)
        # do stuff with args
        sub_orig(*args, &block)
    end
end 
```

The following test shows what the problem is

```
"mark = good".sub(/(good)|(bad)/) { "very " + $1 }
TypeError: can't convert nil into String 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:06:12.947

这不是您问题的直接答案，但传递给 sub 的块接收匹配字符串作为参数，因此：

```
"mark = good".sub(/(good)|(bad)/) { |str| "very #{ str }" }
=> "mark = very good" 
```

你能展示你想要做什么的更复杂的用法吗？

# php - 'Serialization of 'SimpleXMLElement' is not allowed when saving in Wordpress post_meta

> ID：14912551
> 
> 赞同：18
> 
> 时间：2013-02-16T16:37:30.310
> 
> 标签：php, wordpress, amazon-web-services, simplexml

I am working on an amazon affiliate wordpress page. For that I am using the aws_signed_request function to get the price and link from amazon.

Here is the aws_signed_request function returning the xml:

```
 function  aws_signed_request($region, $params, $public_key, $private_key, $associate_tag) {
    $method = "GET";
    $host = "ecs.amazonaws.".$region;
    $uri = "/onca/xml";

    $params["Service"]          = "AWSECommerceService";
    $params["AWSAccessKeyId"]   = $public_key;
    $params["AssociateTag"]     = $associate_tag;
    $params["Timestamp"]        = gmdate("Y-m-d\TH:i:s\Z");
    $params["Version"]          = "2009-03-31";

    ksort($params);

    $canonicalized_query = array();

    foreach ($params as $param=>$value)
    {
        $param = str_replace("%7E", "~", rawurlencode($param));
        $value = str_replace("%7E", "~", rawurlencode($value));
        $canonicalized_query[] = $param."=".$value;
    }

    $canonicalized_query = implode("&", $canonicalized_query);

    $string_to_sign = $method."\n".$host."\n".$uri."\n".
                            $canonicalized_query;

    /* calculate the signature using HMAC, SHA256 and base64-encoding */
    $signature = base64_encode(hash_hmac("sha256", 
                                  $string_to_sign, $private_key, True));

    /* encode the signature for the request */
    $signature = str_replace("%7E", "~", rawurlencode($signature));

    /* create request */
    $request = "http://".$host.$uri."?".$canonicalized_query."&Signature=".$signature;

    /* I prefer using CURL */
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,$request);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_TIMEOUT, 15);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);

    $xml_response = curl_exec($ch);

   if ($xml_response === False)
    {
        return False;
    }
    else
    {
        $parsed_xml = @simplexml_load_string($xml_response);
        return ($parsed_xml === False) ? False : $parsed_xml;
    }
} 
```

After that I get the asin from the post and generate the link and price

```
global $post;  
$asin = get_post_meta($post->ID, 'ASIN', true);

$public_key = 'xxxxxxxxxxx';
$private_key = 'xxxxxxxxxxx';
$associate_tag = 'xxxxxxxxxxx';

$xml = aws_signed_Request('de',
array(
  "MerchantId"=>"Amazon",
  "Operation"=>"ItemLookup",
  "ItemId"=>$asin,
  "ResponseGroup"=>"Medium, Offers"),
$public_key,$private_key,$associate_tag);

$item = $xml->Items->Item;

$link = $item->DetailPageURL;
$price_amount = $item->OfferSummary->LowestNewPrice->Amount;
if ($price_amount > 0) { 
    $price_rund = $price_amount/100;
    $price = number_format($price_rund, 2, ',', '.');
} else {
    $price= "n.v."; 
} 
```

This all works pretty good when I echo the $link and $price. But I want to save the values in the custom fields of the wordpress post so I don't have to run the function every time.

```
update_post_meta($post->ID, 'Price', $price);
update_post_meta($post->ID, 'Link', $link); 
```

This adds the price as the correct value, but when I want to add the link I get this error message:

> Uncaught exception 'Exception' with message 'Serialization of 'SimpleXMLElement' is not allowed' in...

But when I remove the $parsed_xml=... function, it saves an empty value.

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-02-16T21:26:44.283

（几乎）遍历 SimpleXML 对象时返回的所有内容实际上都是另一个 SimpleXML 对象。这就是您可以编写的内容`$item->OfferSummary->LowestNewPrice->Amount`：`->OfferSummary`对`$item`对象进行请求会返回一个表示`OfferSummary`XML 节点的对象，因此您可以`->LowestNewPrice`对该对象进行请求，依此类推。请注意，这也适用于属性 -`$someNode['someAttribute']`将是一个对象，而不是一个字符串！

为了获取元素或属性的字符串内容，您必须使用语法“强制转换”它`(string)$variable`。有时，PHP 会知道您打算这样做，并为您执行此操作 - 例如在使用时`echo`- 但一般来说，**始终手动转换为字符串**是一种很好的做法，这样您以后更改代码时不会有任何意外. 您还可以使用 转换为整数`(int)`，或使用 转换为浮点数`(float)`。

你的问题的第二部分是 SimpleXML 对象存储在内存中，并且不能被“序列化”（即变成一个完全描述对象的字符串）。这意味着如果您尝试将它们保存到数据库或会话中，您将收到您所看到的错误。如果您真的想保存整个 XML 块，您可以使用`$foo->asXML()`.

所以，简而言之：

*   用于`$link = (string)$item->DetailPageURL;`获取字符串而不是对象
*   `update_post_meta($post->ID, 'ItemXML', $item->asXML());`如果您想存储整个项目，请使用

# scala - Why does IDEA give warning when returning a Future of None?

> ID：14912555
> 
> 赞同：4
> 
> 时间：2013-02-16T16:38:20.393
> 
> 标签：scala, intellij-idea

For the following snippet IDEA gives a warning, that `future {None}` would be redundant:

```
queryString match {
  case Some(query) => ... // Do async call
  case None        => future { None }
} 
```

Is there a better possibility to do it?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T17:26:04.917

你可以创建一个已经设定的未来而不产生闭包，使用`Future.successful[T](result: T)`，所以也许`Future.successful(None)`是你想要的。

但是，由于期货已经独立于其类型参数区分成功和失败，因此您也可以通过 表示失败`Future.failed(new Exception("No query string"))`，因为您的异步调用也可以省略包装 in `Some`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T17:20:37.253

我不知道 IDEA 的警告在这种情况下是否有帮助。

您可以通过将匹配推到未来来使其静音：

```
future {
    queryString match {
        case Some(query) => Some(computeResult(query))
        case None => None
    }
} 
```

（或更简单地说`future { queryString.map(computeResult(_)) }`：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T17:25:11.163

我想我自己解决了这个问题：我不需要封装在我的 Future 中的 Option，因为 Future 本身也可能失败，因此失败有点等于 None。

现在我只返回一个 Future 并且：

```
queryString match {

  case Some(query) =>
    //async Call which returns a Future without Option
  case None => throw new Exception("Error")
} 
```

# regex - 使用正则表达式重复替换 Bash 字符串

> ID：14912561
> 
> 赞同：2
> 
> 时间：2013-02-16T16:39:19.197
> 
> 标签：regex, string, bash, replace, repeat

我有一个文件：filename_20130214_suffix.csv 我想替换 bash 中的 yyyymmdd 部分。这是我打算做的：

```
file=`ls -t /path/filename_* | head -1`
file2=${file/20130214/20130215}
#this will not work
#file2=${file/[0-9]{8}/20130215/} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T17:07:51.560

问题是参数扩展不使用正则表达式，而是模式或glob（比较正则表达式“filename_.. *csv”和glob“filename_.csv* ”之间的区别）。Glob 不能匹配固定数量的特定字符串。

但是，您可以在 中启用扩展模式`bash`，它应该与您想要的足够接近。

```
shopt -s extglob    # Turn on extended pattern support
file2=${file/+([0-9])/20130215} 
```

您不能完全匹配 8 个数字，但`+(...)`可以让您匹配括号内的一个或多个模式，这对于您的用例来说应该足够了。

由于在这种情况下您要做的就是替换`_`字符之间的所有内容，因此您也可以简单地使用

```
file2=${file/_*_/_20130215_} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T12:05:09.687

```
[[ $file =~ ^([^_]+_)[0-9]{8}(_.*) ]] && file2="${BASH_REMATCH[1]}20130215${BASH_REMATCH[2]}" 
```

# windows - sfDoctrineGuardPlugin windows 2008 401 unauthorized

> ID：14912562
> 
> 赞同：1
> 
> 时间：2013-02-16T16:39:30.350
> 
> 标签：windows, iis-7, symfony-1.4, sfdoctrineguard

I have a Symfony 1.4 app working on Linux using `sfDoctrineGuardPlugin`. Everything's fine. I am porting this to W2008 MSSQL and am really close BUT cannot get past the 401 Unauthorized error. The app starts up at frontend_dev.php and then because i'm not logged in, redirects to the plugin. I then get this in the symfony log:

```
Feb 16 11:05:34 symfony [info] {sfBasicSecurityFilter} Action "default/login" requires authentication, forwarding to "sfGuardAuth/signin"
Feb 16 11:05:34 symfony [info] {sfFilterChain} Executing filter "sfRenderingFilter"
Feb 16 11:05:34 symfony [info] {sfFilterChain} Executing filter "sfGuardRememberMeFilter"
Feb 16 11:05:34 symfony [info] {sfFilterChain} Executing filter "sfExecutionFilter"
Feb 16 11:05:34 symfony [info] {sfGuardAuthActions} Call "sfGuardAuthActions->executeSignin()"
Feb 16 11:05:34 symfony [info] {sfPHPView} Render "C:/inetpub/wwwroot/appFROMGMCSAPP/plugins/sfDoctrineGuardPlugin/modules/sfGuardAuth/templates/signinSuccess.php"
Feb 16 11:05:34 symfony [info] {sfPartialView} Render "C:/inetpub/wwwroot/appFROMGMCSAPP/plugins/sfDoctrineGuardPlugin/modules/sfGuardAuth/templates/_signin_form.php"
Feb 16 11:05:34 symfony [info] {sfPHPView} Decorate content with "C:\inetpub\wwwroot\appFROMGMCSAPP\apps\frontend\templates/layout.php"
Feb 16 11:05:34 symfony [info] {sfPHPView} Render "C:\inetpub\wwwroot\appFROMGMCSAPP\apps\frontend\templates/layout.php"
Feb 16 11:05:34 symfony [info] {sfWebResponse} Send status "HTTP/1.1 401 Unauthorized" 
```

I guess I can add error_log statements into the `executeSignin`.. maybe my DB is not accessible even though the tables look ok ??

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T08:49:01.207

IIS 上的这个*错误*已于去年修复： http: [//trac.symfony-project.org/ticket/4557](http://trac.symfony-project.org/ticket/4557)

你能检查一下你有最新版本的 symfony 和 sfDoctrineGuardPlugin 吗？另外，检查您是否没有在应用程序中扩展登录操作，401 状态仍然可以。

# ios - 为什么retainCount返回2

> ID：14912569
> 
> 赞同：1
> 
> 时间：2013-02-16T16:40:15.920
> 
> 标签：ios, objective-c, cocoa-touch, memory-management, memory-leaks

我有财产：

```
@property(nonatomic, retain) NSMutableArray *myvar; 
```

第一种情况：

```
 myvar = [[NSMutableArray alloc] init];
    NSLog(@retainCount: %i:", [myvar  retainCount]); 
```

输出：

> 保留计数：1

第二种情况：

```
 self.myvar = [[NSMutableArray alloc] init];
    NSLog(@retainCount: %i:", [self.myvar  retainCount]); 
```

输出：

> 保留计数：2

我的问题是：为什么在第二种情况下保留值是 2 ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-16T16:42:43.843

唯一有效的答案：永远不要检查、使用、信任retainCount。它不用于调试或直接用于内存管理。

有用：[whentouseretaincount.com](https://web.archive.org/web/20130202210240/http://www.whentouseretaincount.com/)

但是在您的情况下：由于您没有使用 ARC（否则编译将不允许您使用`retainCount`），因此您已过度保留。

它保留在这里`@property(nonatomic, retain) NSMutableArray *myvar;`

和这里：`self.myvar = [[NSMutableArray alloc] init];`

做：

```
self.myvar = [[[NSMutableArray alloc] init] autorelease]; //will release once soon 
```

或[我最喜欢的，独立于 ARC/MRC 和短]

```
self.myvar = [NSMutableArray array]; // identical to the first example 
```

或更明确

```
NSMutableArray *var = [[NSMutableArray alloc] init]; 
self.myvar = var; 
[var release]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-16T16:47:54.130

+1，因为您`alloc/init`将它
+1，因为`self.myvar`保留它（如您的财产声明中所述）

如果你`autorelease`在 alloc/init 之后，它会回到 1...然后如果你设置`self.myvar`为 nil，它会达到 0（如果在此期间没有其他东西保留它）

但正如 vikingosegundo 所说，您不想弄乱保留计数。操作系统决定何时将它们击退，因此您不能将它们用作状态的可靠度量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T17:31:04.653

这是我在 ARC 出现之前曾经遵循的规则：

“NARC 规则”：

如果您使用`New`、或`Alloc`，则将计数加一。`Retain``Copy`

在第二种情况下，您的保留计数为 2，因为您在类的实例属性上使用`alloc`和`retain`（通过使用`self`关键字）。在另一种情况下，您没有使用综合设置器来设置变量，因此不使用`retain`. 探索哪些属性实际上可以增加理解。

vikingosegundo 在他的回答中很好地解释了做事的正确方法。

希望有帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-16T16:44:59.070

请参阅此答案：[关于保留计数和初始化成员变量的问题](https://stackoverflow.com/questions/4972430/question-about-retain-counts-initializing-member-variables)

> 首先，你分配初始化一个新的 NSArray 对象。这是 1 的保留计数。其次，您的 setter 在将对象分配给您的实例 var 时会向该对象发送一条保留消息。这会将保留计数增加到 2。

干杯。

# php - how to call anonymous functions stored in a static array?

> ID：14912571
> 
> 赞同：1
> 
> 时间：2013-02-16T16:40:19.770
> 
> 标签：php, arrays, class, anonymous-function

I'm trying to store anonymous functions in a `static array` property of my class. These functions should be invoked later by their index, but calling

```
self::$arr['index']() 
```

just doesn't work, while

```
$a = self::$arr['index'];
$a(); 
```

does!

This doesn't work:

```
class A {
    private static $func = array('a' => '');
    public function __construct() {
        self::$func['a'] = create_function('$str', 'echo "$str";');
    }
    public function go($str) {
        self::$func['a']($str);  // Call the function directly
    }
}
$a = new A();
$a->go("hooray");  // Outputs "Undefined variable: func" 
```

But this does:

```
class A {
    private static $func = array('a' => '');
    public function __construct() {
        self::$func['a'] = create_function('$str', 'echo "$str";');
    }
    public function go($str) {
        $a = self::$func['a'];  // Pass the function name to a variable
        $a($str);               // Call the function via the variable
    }
}
$a = new A();
$a->go("hooray");  // Outputs "hooray" 
```

**Why?**

I'm using PHP Version 5.4.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T17:08:55.903

这是 php 解析器的行为

```
$functionName['a'] = "hello";
self::$functionName['a'](); 
```

来电

```
self::hello(); 
```

...非常可悲的是，在 php 中你不能这样做：

```
(self::$functionName['a'])(); // doesn't work in php :( 
```

例如，您可以在 javascript 中执行此操作

你能做的是......像你说的那样使用一个临时变量

```
$a = self::$func['a'];
$a($parameter); 
```

或者

```
call_user_func(self::$func['a'], $parameter); 
```

希望这可以帮助...

* * *

在最新的 phps 中添加了这些功能

```
$a['sss'] = function(){ echo 'bla'; };
$a['sss']();

class Bla
{
    private $a;
    function test()
    {
        $this->a['sss'] = function(){ echo 'bla2'; };
        $this->a['sss']();
    }
}
$c = new Bla();
$c->test(); 
```

并且**它们工作正常**......所以由于某种原因，这种语法仅在使用范围解析运算符（ ClassName:: self:: 等）时才有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T17:21:46.253

这是 PHP 解析器当前工作方式的结果。由于函数调用`()`是在 static operator 之前评估的`::`，因此您最终会导致解析器尝试引用局部变量`$func`，然后给出有关 $func 未定义的错误（确实如此，因为`$func`方法中没有命名变量）。

正如您所发现的，您可以通过执行两个单独的语句来解决此问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T17:04:42.930

好吧，在 php 中你根本无法做到这一点，它是 php 的一个特性。但是您可以使用`call_user_func`或其亲属：

```
return call_user_func(self::$func['$a'], $str); 
```

# javascript - Get colour of rectangle at specific x,y coordinates

> ID：14912572
> 
> 赞同：-4
> 
> 时间：2013-02-16T16:40:23.917
> 
> 标签：javascript, html, canvas, colors, pixel

I want to be able to get the color of a pixel at specific x,y co-ordinates on a canvas (A rectangles color, but the pixel will sufice).

Is there anyway of doing this with normal javascript without adding any additional libraries?

I'm developing it with the idea of mobile platforms and would prefer not to use external libraries. Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:54:33.410

For the answer let's go straight to the [source](http://www.whatwg.org/specs/web-apps/current-work/#pixel-manipulation).

You want `context.getImageData(x, y, width, height);`

This grabs a rectangle out of the canvas and returns all the pixels there in the form of an "[ImageData](http://www.whatwg.org/specs/web-apps/current-work/#imagedata)" object. This object in turn has a "data" attribute which is, for all intents and purposes, just a normal Array (it's not, but you can pretend it is if you just want to read from it).

The data array looks like

`[r,g,b,a,r,g,b,a,r,g,b,a,...]` where r,g,b, and a are the red, green, blue, and alpha channels of the colour of one pixel. The pixels are ordered as if they were being read in an english book (left to right, then top to bottom).

For you purposes, you can just do `var pixel = context.getImageData(x,y,1,1).data`. Then if you want to know the red part, do `pixel[0]`, green? `pixel[1]`... and so on.

However remark that in my emprical tests, getImageData is an *incredibly* expensive operation (especially in Firefox; Chrome handles it faster, but with less bounds-checking). If you expect to do this query many times per-second, it may be worth getting a larger rectangle to cache some results. Of course this won't work if the pixel data is rapidly changing.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:49:10.633

Canvas 的 getImageData() 返回一个 ImageData 对象，该对象复制画布上指定矩形的像素数据。

```
var color = canvas2d_context.getImageData(pixel_coord_x, pixel_coord_y, 1, 1);

console.log('pixel red value:   ' + color.data[0]);
console.log('pixel green value: ' + color.data[1]);
console.log('pixel blue value:  ' + color.data[1]);
console.log('pixel alpha value: ' + color.data[1]); 
```

...主要来自[http://www.w3schools.com/tags/canvas_getimagedata.asp](http://www.w3schools.com/tags/canvas_getimagedata.asp)

# php - Inserting name with special characters with php in mysql

> ID：14912574
> 
> 赞同：0
> 
> 时间：2013-02-16T16:40:30.190
> 
> 标签：php, mysql, apostrophe

I'm trying to insert some names with special characters, such as an apostrophe, into a mysql database using php. For example:

```
INSERT INTO PLAYERS VALUES('{$players[$n][1]}','$nom_team'); 
```

where `$players` is an array that contains names as `N'Zogbia`, `N'Diaye`, etc. However, this results in an error.

I have tried using the addslashes function:

```
$players[$n][1] = addslashes( $players[$n][1] ); 
```

but this doesn't work correctly. What gets saved in the database is `N\'Zogbia`, or sometimes `N\\\\\\\\\\'Diaye`.

I have run out of ideas to fix the problem. I hope you guys can help me.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:48:44.463

有2种可能的情况

1.  你有魔术引号。[关闭它们。](http://www.php.net/manual/en/security.magicquotes.disabling.php)
2.  某种**Sanitize Them All**功能在您的所有输入数据上运行。摆脱它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-16T16:50:08.480

您可以使用准备好的语句。

```
<?php
$link = mysqli_connect("localhost", "my_user", "my_password", "world");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$city = "N'Zogbia";

/* create a prepared statement */
if ($stmt = mysqli_prepare($link, "SELECT District FROM City WHERE Name=?")) {

    /* bind parameters for markers */
    mysqli_stmt_bind_param($stmt, "s", $city);

    /* execute query */
    mysqli_stmt_execute($stmt);

    /* bind result variables */
    mysqli_stmt_bind_result($stmt, $district);

    /* fetch value */
    mysqli_stmt_fetch($stmt);

    printf("%s is in district %s\n", $city, $district);

    /* close statement */
    mysqli_stmt_close($stmt);
}

/* close connection */
mysqli_close($link);
?> 
```

# asp.net - Is it inefficient to use ASP web forms controls for every HTML tag on a web page?

> ID：14912575
> 
> 赞同：1
> 
> 时间：2013-02-16T16:40:33.003
> 
> 标签：asp.net, webforms, asp.net-controls

Should I be using tags (or literal tags) for every piece of content on my page (h tags, p tags, etc.)? Even if it is not dynamic. Or is this considered to be inefficient having the server process all this content?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T17:39:08.700

不，您不应将服务器标签用于页面上不需要的静态内容。

您添加到 ASP.Net 网页的每个服务器端标记（即每个具有 runat="Server" 属性的标记）都会为您的页面添加额外的处理。对于每个服务器标签，ASP.Net 将信息添加到视图状态，然后必须将其序列化并通过线路为每个请求发送。此外，当页面在服务器上处理和呈现时，ASP.Net 管道必须实例化这些服务器端标签并从视图状态重新水合它们的属性。所有这些都增加了请求处理的开销。

因此，对于不需要服务器端状态持久性或不需要 ASP.Net Web 表单或 HTML 控件的高级功能的基本 HTML 标记，不要使用服务器端标记。只需使用没有 runat="server" 属性的基本 HTML 标记（即 H1、P 等）。

有关 ASP.Net 页面生命周期的更多信息，请参见[此处](http://msdn.microsoft.com/en-us/library/ms178472%28v=vs.100%29.aspx)。

# ruby-on-rails - 未创建关联

> ID：14912578
> 
> 赞同：0
> 
> 时间：2013-02-16T16:40:50.270
> 
> 标签：ruby-on-rails

这个错误困扰了我好几个星期。当我尝试`Item`从指定的`User`and构建 an 时`List`，`Item`会创建 ，但`Wish`不会创建关联。

如果我尝试这样做`@item.lists.first.name`，则会返回错误：

```
undefined method 'name' for nil:NilClass 
```

我对 Rails 很陌生，所以我确定有些东西我错过或误解了。非常感谢任何帮助！

我有四个模型：

```
class User < ActiveRecord::Base
  has_many :lists, dependent: :destroy
  has_many :wishes, through: :lists
  has_many :items, through: :wishes

class List < ActiveRecord::Base
  belongs_to :user
  has_many :wishes, dependent: :destroy
  has_many :items, through: :wishes

class Wish < ActiveRecord::Base
  belongs_to :list
  belongs_to :item

class Item < ActiveRecord::Base
  has_many :wishes
  has_many :lists, through: :wishes 
```

我想`Item`从`lists_controller.rb`显示操作创建一个新的：

```
class ListsController < ApplicationController
  def show
    @user = User.find(params[:user_id])
    @list = @user.lists.find(params[:id])
    @item = @list.items.build if current_user?(@user)
    @items = @list.items
  end

class ItemsController < ApplicationController
    def create
        @list = current_user.lists.find(params[:list_id])
        @item = @list.items.build(params[:item])
    if @item.save
      flash[:success] = "Item created!"
      redirect_to @item
    else
      render 'new'
    end
end 
```

我的路由文件如下所示：

```
Wishlist::Application.routes.draw do
  resources :users do
    resources :lists, only: [:show, :create, :destroy]
  end
  resources :items, only: [:show, :new, :create, :destroy] 
```

表格`lists/show.html.erb`：

```
 <div class="modal-body">
     <%= form_for(@item, html: { multipart: true }) do |f| %>
  <div class="field">
        <%= render 'items/fields', f: f %>
         <%= hidden_field_tag :list_id, @list.id %>
  </div>
   </div> 
```

和`items/fields`：

```
<%= render 'shared/error_messages', object: f.object %>

<%= f.label :image %>
<%= f.file_field :image %>

<%= f.label :remote_image_url, "or image URL" %>
<%= f.text_field :remote_image_url %>

<%= f.label :title %>
<%= f.text_field :title %>

<%= f.label :link %>
<%= f.text_field :link %> 
```

**更新**

从日志：

```
Processing by ItemsController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"pcDVdaDzZz4M17Kwjx8mKw6tTF9MjUvx1woTzaKRWJY=", "item"=>{"image"=>#<ActionDispatch::Http::UploadedFile:0x007fecdd1fd890 @original_filename="profile.jpg", @content_type="image/jpeg", @headers="Content-Disposition: form-data; name=\"item[image]\"; filename=\"profile.jpg\"\r\nContent-Type: image/jpeg\r\n", @tempfile=#<File:/var/folders/6y/j8zfcgmd02x5s439c0np8fjh0000gn/T/RackMultipart20130216-8413-3vzjuj>>, "remote_image_url"=>"", "title"=>"YES", "link"=>"SDFs"}, "list_id"=>"1", "commit"=>"Add"}
  User Load (0.3ms)  SELECT "users".* FROM "users" WHERE "users"."remember_token" = '5AXS8-7-YRyLyGDKYHIZRg' LIMIT 1
  List Load (0.2ms)  SELECT "lists".* FROM "lists" WHERE "lists"."user_id" = 1 AND "lists"."id" = ? LIMIT 1  [["id", "1"]]
   (0.1ms)  begin transaction
  SQL (0.7ms)  INSERT INTO "items" ("created_at", "image", "link", "title", "updated_at") VALUES (?, ?, ?, ?, ?)  [["created_at", Sat, 16 Feb 2013 20:57:10 UTC +00:00], ["image", "profile.jpg"], ["link", "SDFs"], ["title", "YES"], ["updated_at", Sat, 16 Feb 2013 20:57:10 UTC +00:00]]
   (2.7ms)  commit transaction
Redirected to http://localhost:3000/items/1
Completed 302 Found in 830ms (ActiveRecord: 4.0ms) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T22:18:50.027

让我首先尝试总结一下：您有用户，他们有列表，其中包含与一个特定项目相关的愿望。

那么我们先来看下面这行代码：

```
@item.lists.first.name 
```

所以发生的事情是，rails 获取该项目，遍历包含该项目的所有列表的愿望，获取第一个列表并查找列表名称。当项目通过愿望与任何列表无关时，您看到的问题就会发生（例如，因为您的项目的创建方法没有将新项目连接到愿望，因此也缺少与列表的连接）：所以该项目没有关系到一个列表，结果`@item.lists`是一个空列表。好吧，`first`空列表的元素什么都不是（`nil`），当然`nil`也没有名字。

结果是，你所看到的：

```
undefined method 'name' for nil:NilClass 
```

解决此问题的一种方法是`try()`仅在可用时使用 which 执行相关方法：

```
@item.lists.first.try(:name) 
```

您所说的另一个问题是，当您从用户构建项目时，不会产生任何愿望。我认为你必须明确地建立愿望。我不是 100% 确定，但我认为，`:through`在模型中声明 -relations 仅用于查询，而不用于生成/构建。

在您的项目控制器中尝试以下操作（想法是首先明确构建愿望，然后为愿望构建项目）：

```
@wish = @list.wishes.build()
@wish.save
@item = @wish.item.build(params[:item]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T04:21:06.687

`build`在`has_many :through`. _ 您需要将关联更改为`items`on`List`以包含`inverse_of`.

```
class List < ActiveRecord::Base
  belongs_to :user
  has_many :wishes, dependent: :destroy
  has_many :items, through: :wishes, inverse_of: :wishes
end 
```

然后它应该为您正确构建连接`Wish`对象。

有关更多信息，请参阅此相关问题：[https ://github.com/rails/rails/pull/7661#issuecomment-8614206](https://github.com/rails/rails/pull/7661#issuecomment-8614206)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T10:30:00.493

经过大量的谷歌搜索和反复试验，我发现我必须明确地构建 Wish。创建操作最终看起来像这样：

```
def create
    @list = current_user.lists.find(params[:list_id])
    @item = Item.create!(params[:item])
    @item.wishes.build(list_id: @list.id)
    if @item.save
      flash[:success] = "Item created!"
      redirect_to @item
    else
      render 'new'
    end
end 
```

# cocoa-touch - core plot mask limit band with plotArea cornerRadius

> ID：14912579
> 
> 赞同：0
> 
> 时间：2013-02-16T16:40:52.403
> 
> 标签：cocoa-touch, core-plot

I'm currently struggling to mask my limitBand for yAxis.
At the moment it draws over the rounded corners of my plotArea!
I have setup:

```
[y addBackgroundLimitBand:[CPTLimitBand limitBandWithRange:range
                                                      fill:bandFill]]; 
```

and set `graph.plotAreaFrame.plotArea.masksToBorder = YES;` but it dosn't mask at all.
If I set the `masksToBounds = YES;` all my labels get also clipped.
Is there any way to clip/mask the limitband?

Here is how it looks right now:
![enter image description here](../Images/1574c3997c2517b22362c341cd0479cb.png)

Big Thanks to any helpful answer!

# grails - Unable to pass a variable parameter to jasper report

> ID：14912582
> 
> 赞同：0
> 
> 时间：2013-02-16T16:41:05.687
> 
> 标签：grails, groovy, jasper-reports, gsp, jasper-plugin

So, I have created a simple CRUD app using groovy on grails and I want to use jasper reporting plugin to get some simple reports on the database. I have set up a simple G:select to pick from a drop down list, and hitting the PDF icon I am bringing back a blank page. gsp is below

```
<div id="page-body" role="main">
<p>Please select one of the following options</p>
<div>
<g:select optionKey="id" 
optionValue="artist" 
name="artist" 
id="MusicCatalogue" 
value="${artist}" 
from="${multicatalogue.MusicCatalogue.list()}">
</g:select>
</div>
<div> <g:jasperReport jasper="report1" format="PDF" name="Music Catalogue" />
<input type="hidden" name="artist" value="${artist}" />
</div>
</div> 
```

and then the jrxml looks like the below

```
<parameter name="artist" isForPrompting="true" class="java.lang.String">
    <defaultValueExpression><![CDATA["<parameter error>"]]></defaultValueExpression>
    </parameter>
    <queryString language="SQL">
        <![CDATA[SELECT   *
    FROM
    MusicCatalogue where ARTIST = $P{artist}]]>
    </queryString>
    <field name="ID" class="java.lang.Integer"/>
    <field name="ALBUM" class="java.lang.String"/>
    <field name="ARTIST" class="java.lang.String"/>
    <field name="TRACK" class="java.lang.String"/>
    <group name="ARTIST"> 
```

ideas????

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T01:59:48.297

Try replace

```
<g:jasperReport jasper="report1" format="PDF" name="Music Catalogue" />
<input type="hidden" name="artist" value="${artist}" /> 
```

With

```
<g:jasperReport jasper="report1" format="PDF" name="Music Catalogue">
<input type="hidden" name="artist" value="${artist}" />
</g:jasperReport> 
```

Also, make sure that `${artist}` returns a string value, else the report will use the defaultValue of `artist` parameter that might ruin your query.

# php - SQL 选择语句中的语法错误

> ID：14912583
> 
> 赞同：4
> 
> 时间：2013-02-16T16:41:12.847
> 
> 标签：php, sql, syntax-error

我正在开发一个 Android 应用程序。在我的应用程序中，AsyncTask 向 PHP 发送了一个字符串。PHP 返回一个作物名称数组。

我的 php 文件是：

```
 <?php

ini_set('default_charset', 'utf-8');
header('Content-Type: text/html; charset=UTF-8');

mysql_connect("localhost","root","");
mysql_select_db("farm_o_pedia");

mysql_set_charset('utf8');
$result1 = mysql_query("SET NAMES utf8");

$lang=$_POST['LanguageName'];

$query1="select lang_id from lang_selection where lang_name='$lang'";
$lang_id=mysql_query($query1) or die(mysql_error());

$query2="select crop_name from crop_master where lang_id=$lang_id";
$result2=mysql_query($query2) or die(mysql_error());

while($row=mysql_fetch_assoc($result2))
{
    $output[]=$row;
}

print(json_encode($output));

mysql_close();

?> 
```

我在 Logcat 中遇到这种错误：

> 02-16 22:08:04.216: I/HTTP ok(1251): org.apache.http.message.BasicHttpResponse@4052f0b8 02-16 22:08:04.216: I/JsonObj(1251): 你有一个错误SQL 语法；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“id #4”附近使用正确的语法

我不知道我的语法有什么问题。

> 编辑：按照建议使用 PDO 并且工作正常：这是我的新脚本。

```
<?php

$db = new PDO('mysql:host=localhost;dbname=farm_o_pedia;charset=utf8', 'root', '');

$db->query("SET NAMES utf8");

$lang=$_POST['LanguageName'];

$query1="select crop_name from crop_master where lang_id=(select lang_id from lang_selection where lang_name='$lang')";

$result2=$db->query($query1);

while(($row=$result2->fetch(PDO::FETCH_ASSOC))!=false)
{
    $output[]=$row;
}

print(json_encode($output));

$db=null;

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:43:36.363

```
$query2="select crop_name from crop_master where lang_id=$lang_id"; 
```

尝试将其替换为：

```
$query2="select crop_name from crop_master where lang_id='$lang_id'"; 
```

您似乎试图检索`crop_name`lang_id 等于 $lang_id （这将是一个无效的标识符）而不是 $lang_id 本身的值。

**请注意，您可能需要阅读`SQL Injection Attacks`：**

例如，如果用户`1;DROP TABLE USERS`作为`LanguageName`参数传入，则将在 SQL 中执行以下操作：

```
$query1="select lang_id from lang_selection where lang_name=1;DROP TABLE USERS; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:45:42.617

我不确定您查询的语法，但我知道您最好使用一个查询而不是两个。像这样的东西：

```
select crop_name 
from crop_master cm join lang_selection ls on cm.languageid = ls.languageid
where lang_name = '$lang' 
```

如果你不熟悉连接表，我听说过这本书的好东西，10 分钟内自学 SQL

# c - 将单词之间的多个空格变为一个

> ID：14912586
> 
> 赞同：-2
> 
> 时间：2013-02-16T16:41:34.610
> 
> 标签：c

我需要阅读文本并查找单词之间是否有多个空格。

如果有，则将其更改为一个。

例如，如果我有一个文本：

```
My         name     is      Lukas 
```

程序应将其更改为：

```
My name is Lukas 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:07:09.310

```
while (*str) {
  if (*str != ' ' || str[1] != ' ') *newstr++ = *str;
  str++;
}

*newstr = 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:51:09.163

根据您之前的查询，我修改了逻辑以满足您的要求。希望这可以帮助。

```
FILE *in;
char ch,str[100],cw;
int j,i = 0;
int isSpace = 0;

in=fopen("duom.txt","r");

if(in){
    while(!feof(in)){
    ch=getc(in);
    if(isSpace)
        isSpace = (isSpace & (ch == ' '));
    if(!isSpace) {
        str[i] = ch;
        i++;
    }
    if(ch == ' ')
        isSpace = 1;

}

for(j=0;j<i;j++){
    printf("%c",str[j]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:53:12.187

`isspace`from`<ctype.h>`在这里可能有用。这是一个可能的实现：

```
void delete_multiple_spaces(char *dst, const char *src)
{
    int previous = 0;
    int c;

    while ((c = *src++) != '\0')
    {
        if (isspace(c) && !previous)
        {
            previous = 1;
        }
        else
        {
            if (previous)
            {
                *dst++ = ' ';
                previous = 0;
            }

            *dst++ = c;
        }
    }

    *dst = '\0';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-16T16:58:36.537

```
 j = 0;
   for(i=0; myStr[i] != '\0'; i++) {
      if(myStr[i] == ' ' && myStr[i+1] == ' ') 
          continue; 
      newStr[j] = myStr[i];
      j++;
   } 
```

并且不要忘记将`'\0'`（表示字符串的结尾）添加到末尾`newStr`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-16T17:08:15.600

```
char *(strdupcompact) (const char *c)
{
 int i; int p;

 for (i = 0, p = 0; c[i]; i++, p++)
 {
  if (c[i] == ' ') while (c[i+1] == ' ') i++;
 }

 char *newstr = malloc(p + 1);

 for (i = 0, p = 0; c[i]; i++, p++)
 {
  newstr[p] = c[i];
  if (c[i] == ' ') while (c[i+1] == ' ') i++;
 }
 newstr[p] = 0;

 return newstr;
} 
```

制作您的字符串的 malloced 副本。

# javascript - 从 Rails & Backbone 到 ember

> ID：14912596
> 
> 赞同：0
> 
> 时间：2013-02-16T16:42:49.663
> 
> 标签：javascript, ember.js, client-side

我正在个人项目中试用 ember js。我正在努力理解 Ember 的不同组成部分是哪一部分。

我对 Rails 非常熟悉，并且在一定程度上使用了主干（从未使用过与路由相关的所有内容），并了解它们两者的工作原理，以及什么样的对象扮演 MVC 的哪个部分。

使用 Ember，事情就不是那么清楚了，而且似乎不太容易。我已经阅读了指南和一些帖子，但我仍在努力前进。我得到了模型部分，它与它的导轨和骨干对应物非常相似。我也有模板、车把之类的东西。路由器类似于rails路由器。

然后是控制器、路由和视图。据我了解，视图代表 ui 的一部分，并处理用户交互。我不太了解的是控制器/路由角色。

更具体地说：我希望我的应用程序有一个导航栏（带有指向页面部分的链接）和一个“用户连接小部件”，如果他已连接则显示用户数据，如果没有则允许他这样做，通过 facebook 等登录.

导航栏似乎适合视图，但是我需要将状态保留在某处（以突出显示当前页面），这似乎是控制器角色。并且用户小部件似乎适合控制器，但每个路由只有一个控制器，那么如何做到这一点？

非常感谢您的时间，我希望我已经足够清楚了！

:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T19:56:13.950

控制器存储应用程序的状态。路由器管理应用程序的不同状态。你是对的，每条路由只有一个控制器，但你也可以访问其他控制器。

假设这是您的html：

```
<script type="text/x-handlebars" data-template-name="application">
  <div class="main-content">
    {{outlet}}
  </div>
</script>

<script type="text/x-handlebars" data-template-name="index">
  <div class="nav-bar">
    <div class="user">
      {{#if isLoggedIn}}
        <div class="user-name">{{userName}}</div>
        {{else}}
        <button {{action "login" target="App.UserController"}}>
            Login
        </button>
        {{/if}}
    </div>
  </div>
  <div class="content">some other amazing content here</div>
</script> 
```

和JS：

```
var App = Ember.Application.create({
  LOG_TRANSITIONS: true,
  rootElement: '#ember-app'
});

App.Router.map(function () {
  this.route('user');
});

App.IndexRoute = Ember.Route.extend({
  setupController: function(controller, model) {
    this.controller.set('isLoggedIn', this.controllerFor('user').get('isLoggedIn'));
  }
});

App.UserController = Ember.ObjectController.extend({
  isLoggedIn: false,
  userName: 'emberjs',
  login: function () {
     this.set('isLoggedIn', true);
  }
});

App.NavbarView = Ember.View.create({
  loggedInBinding: Ember.Binding.oneWay('App.UserController.isLoggedIn')
}); 
```

如果你需要从你的路由访问另一个控制器，你可以这样做：

```
App.IndexRoute = Ember.Route.extend(function () {
  setupController: function () {
    var userController = this.controllerFor('user');
    console.log('this is a user controller instance', userController);
  }
}); 
```

# python - pygame中的角运动

> ID：14912598
> 
> 赞同：0
> 
> 时间：2013-02-16T16:42:52.303
> 
> 标签：python, pygame, game-physics

我已经定义了一个函数，它允许我沿对角线移动对象：

```
 if(myX > targetX):
        dx = myX - targetX
    else:
        dx = targetX - myX 
    if(myY > targetY):
        dy = myY - targetY
    else:
        dy = targetY - myY

    if(dy == 0):
        dy = 1
    if(dx == 0):
        dx = 1

    #Calc Movement
    if(dx < dy):
        Speedy = dy/dx 
        Speedx = 1
    if(dx > dy):
        Speedy = 1
        Speedx = dx/dy
    elif(dx == dy):
        Speedx = 1
        Speedy = 1

    if(myX < targetX):
        Speedx = Speedx * -1
    if(myY < targetY):
        Speedy = Speedy * -1

    return Speedx,Speedy 
```

该代码有效，但问题是它没有做我想要的。现在，如果我靠近它，物体就会加速，这看起来很奇怪。我很清楚为什么会这样，但是有没有一种简单的方法可以将速度固定为恒定，而不是方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:51:30.443

如果你这样做，dx 和 dy 是从你的人指向目标的向量的标量。然后除以它们的大小，这里表示为 dz。现在 dx 和 dy 代表一个单位向量。将它们乘以速度后，您的对象将以恒定的速度移动，但方向会发生变化。

```
import math

#set speed to how fast you want your guy to move
speed = 1
dx = myX - targetX
dy = myY - targetY

dz = math.sqrt(dx**2 + dy**2)

speedx = dx/dz * speed
speedy = dy/dz * speed 
```

# salesforce - 在 Salesforce Apex 中解析 JSON 对象

> ID：14912599
> 
> 赞同：8
> 
> 时间：2013-02-16T16:43:07.270
> 
> 标签：salesforce, apex-code, visualforce

如何解析 Apex 中给定格式的 jsonObject？

我需要包含 id 属性的 items 数组中的 List<String> 。有什么合适的方法？

为了解析它，我尝试使用代码创建一个类：

```
public class JSON2Apex {

    public class Items {
        public String kind;
        public String etag;
        public String id;
        public String status;
        public String htmlLink;
        public String created;
        public String updated;
        public String summary;
        public String description;
        public String location;
        public Creator creator;
        public Creator organizer;
        public Start start;
        public Start end;
        public String iCalUID;
        public Integer sequence;
        public Reminders reminders;
    }

    public class Reminders {
        public Boolean useDefault;
    }

    public class Start {
        public String dateTime;
    }

    public class Creator {
        public String email;
        public String displayName;
        public Boolean self;
    }

    public String kind;
    public String etag;
    public String summary;
    public String updated;
    public String timeZone;
    public String accessRole;
    public List<DefaultReminders> defaultReminders;
    public List<Items> items;

    public class DefaultReminders {
        public String method;
        public Integer minutes;
    }

} 
```

但是在这个类中，它显示了一些保留关键字是用户，比如 end ， dateTime 等，所以不能进一步使用这种方法。

```
{
    "kind": "calendar#events",
    "etag": "\"ZrhdJMCgpoUK_a5fT7XOC6xn46g/jAScaUzsyk9nbyyvTc1Wa3-tulA\"",
    "summary": "riteshmehandiratta@gmail.com",
    "updated": "2013-02-16T16:23:20.057Z",
    "timeZone": "Asia/Calcutta",
    "accessRole": "owner",
    "defaultReminders": [
        {
            "method": "email",
            "minutes": 10
        },
        {
            "method": "popup",
            "minutes": 10
        }
    ],
    "items": [
        {
            "kind": "calendar#event",
            "etag": "\"ZrhdJMCgpoUK_a5fT7XOC6xn46g/Z2NhbDAwMDAxMzU2MTQ1NTg1NjYxMDAw\"",
            "id": "ngo4lfq6q7c4dm8bej7m47e5lc",
            "status": "confirmed",
            "htmlLink": "https://www.google.com/calendar/event?eid=bmdvNGxmcTZxN2M0ZG04YmVqN200N2U1bGMgcml0ZXNobWVoYW5kaXJhdHRhQG0",
            "created": "2012-12-22T03:04:01.000Z",
            "updated": "2012-12-22T03:06:25.661Z",
            "summary": "hello",
            "description": "hgjgjh",
            "location": "hkhkhk",
            "creator": {
                "email": "riteshmehandiratta@gmail.com",
                "displayName": "RITESH MEHANDIRATTA",
                "self": true
            },
            "organizer": {
                "email": "riteshmehandiratta@gmail.com",
                "displayName": "RITESH MEHANDIRATTA",
                "self": true
            },
            "start": {
                "dateTime": "2013-01-01T10:00:00+05:30"
            },
            "end": {
                "dateTime": "2013-01-15T00:00:00+05:30"
            },
            "iCalUID": "ngo4lfq6q7c4dm8bej7m47e5lc@google.com",
            "sequence": 1,
            "reminders": {
                "useDefault": true
            }
        },
        {
            "kind": "calendar#event",
            "etag": "\"ZrhdJMCgpoUK_a5fT7XOC6xn46g/Z2NhbDAwMDAxMzYxMDMxNTg1OTYzMDAw\"",
            "id": "oap7nr7ukjug6euo24kvhmfbm0",
            "status": "confirmed",
            "htmlLink": "https://www.google.com/calendar/event?eid=b2FwN25yN3VranVnNmV1bzI0a3ZobWZibTAgcml0ZXNobWVoYW5kaXJhdHRhQG0",
            "created": "2013-02-16T16:19:45.000Z",
            "updated": "2013-02-16T16:19:45.963Z",
            "summary": "Hello World",
            "creator": {
                "email": "riteshmehandiratta@gmail.com",
                "displayName": "RITESH MEHANDIRATTA",
                "self": true
            },
            "organizer": {
                "email": "riteshmehandiratta@gmail.com",
                "displayName": "RITESH MEHANDIRATTA",
                "self": true
            },
            "start": {
                "dateTime": "2013-02-11T11:00:00+05:30"
            },
            "end": {
                "dateTime": "2013-02-11T12:00:00+05:30"
            },
            "iCalUID": "oap7nr7ukjug6euo24kvhmfbm0@google.com",
            "sequence": 0,
            "reminders": {
                "useDefault": true
            }
        },
        {
           "kind": "calendar#event",
           "etag": "\"ZrhdJMCgpoUK_a5fT7XOC6xn46g/Z2NhbDAwMDAxMzYxMDMxNjQxMDYzMDAw\"",
           "id": "k2mvqecqdgoudt6fl4e5hhqna0",
           "status": "confirmed",
           "htmlLink": "https://www.google.com/calendar/event?eid=azJtdnFlY3FkZ291ZHQ2Zmw0ZTVoaHFuYTAgcml0ZXNobWVoYW5kaXJhdHRhQG0",
           "created": "2013-02-16T16:20:41.000Z",
           "updated": "2013-02-16T16:20:41.063Z",
           "summary": "Hello Wol",
           "creator": {
               "email": "riteshmehandiratta@gmail.com",
               "displayName": "RITESH MEHANDIRATTA",
               "self": true
           },
           "organizer": {
               "email": "riteshmehandiratta@gmail.com",
               "displayName": "RITESH MEHANDIRATTA",
               "self": true
           },
           "start": {
               "dateTime": "2013-02-11T13:00:00+05:30"
           },
           "end": {
               "dateTime": "2013-02-11T14:00:00+05:30"
           },
           "iCalUID": "k2mvqecqdgoudt6fl4e5hhqna0@google.com",
           "sequence": 0,
           "reminders": {
               "useDefault": true
           }
        },
        {
            "kind": "calendar#event",
            "etag": "\"ZrhdJMCgpoUK_a5fT7XOC6xn46g/Z2NhbDAwMDAxMzYxMDMxNjUyNDE1MDAw\"",
            "id": "0n2if07oo9pvfdnf7f0a6cldns",
            "status": "confirmed",
            "htmlLink": "https://www.google.com/calendar/event?eid=MG4yaWYwN29vOXB2ZmRuZjdmMGE2Y2xkbnMgcml0ZXNobWVoYW5kaXJhdHRhQG0",
            "created": "2013-02-16T16:20:52.000Z",
            "updated": "2013-02-16T16:20:52.415Z",
            "summary": "Hello World1",
            "creator": {
                "email": "riteshmehandiratta@gmail.com",
                "displayName": "RITESH MEHANDIRATTA",
                "self": true
            },
            "organizer": {
                "email": "riteshmehandiratta@gmail.com",
                "displayName": "RITESH MEHANDIRATTA",
                "self": true
            },
            "start": {
                "dateTime": "2013-02-11T15:30:00+05:30"
            },
            "end": {
                "dateTime": "2013-02-11T16:30:00+05:30"
            },
            "iCalUID": "0n2if07oo9pvfdnf7f0a6cldns@google.com",
            "sequence": 0,
            "reminders": {
                "useDefault": true
            }
        },
        {
            "kind": "calendar#event",
            "etag": "\"ZrhdJMCgpoUK_a5fT7XOC6xn46g/Z2NhbDAwMDAxMzYxMDMxNzcwNDMzMDAw\"",
            "id": "r365lrv775bqjiplmaqjro9grc",
            "status": "confirmed",
            "htmlLink": "https://www.google.com/calendar/event?eid=cjM2NWxydjc3NWJxamlwbG1hcWpybzlncmMgcml0ZXNobWVoYW5kaXJhdHRhQG0",
            "created": "2013-02-16T16:22:50.000Z",
            "updated": "2013-02-16T16:22:50.433Z",
            "creator": {
                "email": "riteshmehandiratta@gmail.com",
                "displayName": "RITESH MEHANDIRATTA",
                "self": true
            },
            "organizer": {
                "email": "riteshmehandiratta@gmail.com",
                "displayName": "RITESH MEHANDIRATTA",
                "self": true
            },
            "start": {
                "dateTime": "2013-02-11T14:30:00+05:30"
            },
            "end": {
                "dateTime": "2013-02-11T15:30:00+05:30"
            },
            "iCalUID": "r365lrv775bqjiplmaqjro9grc@google.com",
            "sequence": 0,
            "reminders": {
                "useDefault": true
            }
        }
    ]
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-16T18:11:17.553

您可以使用该`deserializeUntyped`函数来处理普通对象/列表/映射对象中的 JSON。您只需要记住将所有内容都转换为预期的类型（就像在 Java 中一样）。所以要访问每个项目的 id 字段，你会做

```
public void parse() {
    Map<String, Object> root = (Map<String, Object>)JSON.deserializeUntyped(getJsonToParse());
    List<Object> items = (List<Object>)root.get('items');
    for (Object item : items) {
        Map<String, Object> i = (Map<String, Object>)item;
        System.debug(i.get('id'));
    }
} 
```

生成此调试输出：

![调试日志结果](../Images/55fa7e86e51a76a6c45169732df1a17b.png)

# jquery - jquery on 和使用 jquery 复杂选择器

> ID：14912606
> 
> 赞同：0
> 
> 时间：2013-02-16T16:43:34.670
> 
> 标签：jquery, css-selectors, internet-explorer-7

我有这个选择器：

我在页面周围有以这样的斜线开头的锚点

```
<a href="/projects/case-study/">Link to case study</a> 
```

我也有这个来阻止他们工作。

```
$("body").on("click", "a[href^='/']", function(e){
   return false;
}); 
```

这适用于所有现代浏览器和 IE10、9、8 但不是 7。

任何想法为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:47:39.523

你为什么[（Mis？）使用 return false](http://fuelyourcoding.com/jquery-events-stop-misusing-return-false/)。当我们调用时，会执行以下任务`return false`：

1.  event.preventDefault();
2.  event.stopPropagation();
3.  停止回调执行并在调用时立即返回。

取消默认行为所需的唯一操作是`preventDefault()`.

```
 e.preventDefault ? e.preventDefault() : e.returnValue = false; 
```

所以，你最终可能会如下：

```
$("body").on("click", "a[href^='/']", function(e){
   e.preventDefault();
}); 
```

# java - 如何计算给定 BigDecimal 值占用的内存？

> ID：14912617
> 
> 赞同：1
> 
> 时间：2013-02-16T16:44:26.130
> 
> 标签：java, bigdecimal

如何计算给定`BigDecimal`值占用的内存？（例如，`0.4247246522`。）

对于整数 10，二进制等效值为 1010，因此它占用 4 位内存。

如果是`BigDecimal`对象，它是如何完成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:46:05.920

我正在做以下实验：

```
public class ObjectSizeFetcher {

    private static Instrumentation instrumentation;

    public static void premain(String args, Instrumentation inst) {
        instrumentation = inst;
    }

    public static long getObjectSize(Object o) {
        return instrumentation.getObjectSize(o);
    }
} 
```

通过这个测试：

```
public class TestDoubleSize {

    public static void main(String args[]) {

        String num = "0.";
        for (int i = 1; i < 500000; i++) {
            num += (int) (Math.random()*10) ;
            BigDecimal bg = new BigDecimal(num);

            if (i % 1000 == 0) {
                System.out.println(i + "\t" + bg.precision() + "\t" + ObjectSizeFetcher.getObjectSize(bg));
            }
        }
    }
} 
```

到目前为止的结果：

```
Digits   Precision  Bytes 
1000    1000    32
2000    2000    32
3000    3000    32
4000    4000    32
5000    5000    32
6000    6000    32
7000    7000    32
8000    8000    32
9000    9000    32
10000   10000   32
11000   11000   32
12000   12000   32
13000   13000   32
14000   14000   32
15000   15000   32
16000   16000   32
17000   17000   32
18000   18000   32
19000   19000   32
20000   20000   32
21000   21000   32
22000   22000   32
23000   23000   32
24000   24000   32
25000   25000   32
26000   26000   32
27000   27000   32
28000   28000   32
29000   29000   32
30000   30000   32 
```

这很奇怪，因为它停留在 32 处。

这让我相信我的代码中可能有一个错误......

# python - 如何使用 Numpy 动态索引 N 维？

> ID：14912624
> 
> 赞同：4
> 
> 时间：2013-02-16T16:45:15.690
> 
> 标签：python, numpy, indexing

当我输入一个 N 值时，会自动生成一个 N 维矩阵。我想根据 N 的值自动索引 N 维矩阵。

例如，如果矩阵 A 的维数为 3：

```
temp = A[a + 1, a + 2, a + 3] 
```

如果是 4：

```
temp = A[a + 1, a + 2, a + 3, a + 4] 
```

因为我的整个代码通过 N 的值生成了许多不同维度的矩阵，所以我寻找满足我需求的方法。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:48:33.803

只需构建一个包含所需索引的元组，然后使用该元组索引到`temp`.

# macos - 除了路径，Mac OS X 上还有哪些其他类型的持久文件引用？

> ID：14912625
> 
> 赞同：1
> 
> 时间：2013-02-16T16:45:18.547
> 
> 标签：macos, cocoa, file

当我在 TextEdit 中打开一个文本文档，退出它，重命名文件并重新启动 TextEdit 时，重命名的文件将自动打开。如果将文件移动到不同的文件夹，情况也是如此。

我从这个实验中得出的结论是，无论处理哪些文件应该在 Mac OS X 上自动重新打开，都不使用文件路径，或者至少不只使用文件路径。

那么，除了文件路径之外，我可以向文档写入什么样的文件引用，即使在我的应用程序未运行时重命名或移动目标文件也将保持有效？

我对此感兴趣，因为我正在开发一个可能需要在其自己的文档中存储对其他文件的引用的应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:56:03.103

您正在寻找`NSURL`基于解决方案的解决方案。您可以创建一个书签，即使在文件被移动/重命名后，它也会引用该文件。

[Peter Sugihara](https://github.com/ptrsghr/FileWatcher/blob/master/FileWatcherExample/Classes/FileWatcher.m)从 GitHub 上的 FileWatcher 借用：

```
- (NSData *)bookmarkFromURL:(NSURL *)url {
    NSData *bookmark = [url bookmarkDataWithOptions:NSURLBookmarkCreationPreferFileIDResolution
                     includingResourceValuesForKeys:NULL
                                      relativeToURL:NULL
                                              error:NULL];
    return bookmark;
}

- (NSURL *)urlFromBookmark:(NSData *)bookmark {
    NSError *error = noErr;
    NSURL *url = [NSURL URLByResolvingBookmarkData:bookmark
                                           options:NSURLBookmarkResolutionWithoutUI
                                     relativeToURL:NULL
                               bookmarkDataIsStale:NULL
                                             error:&error];
    if (error != noErr)
        NSLog(@"%@", [error description]);
    return url;
} 
```

您可以安全地保存返回的书签数据，并且在您的应用重新启动后它将指向同一个文件。

官方文档中的附加信息：[Locating Files Using Bookmarks](http://developer.apple.com/library/ios/documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/AccessingFilesandDirectories/AccessingFilesandDirectories.html#//apple_ref/doc/uid/TP40010672-CH3-SW10)

**编辑：**根据 Peter Hosey 与上述代码中的错误处理相关的非常有效的建议，请注意：来自 FileWatcher 的上述代码不根据标准处理错误，并附上作为指导。

详细请参考官方文档。

# jquery - 我可以在开发 Django 项目时使用 jquery 吗？

> ID：14912633
> 
> 赞同：1
> 
> 时间：2013-02-16T16:46:03.587
> 
> 标签：jquery, django, localhost

我尝试将 jquery 用于我目前在 localhost 上测试的 Web 项目。在我的`base.html`我尝试通过这个链接使用谷歌服务

`<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js">`

在我呈现的网站中，我得到了有效的标记：

```
<!DOCTYPE html> 
<html>
<head>
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js">
 </script>

 <script>
  $(document).ready(function(){
   $("button").click(function(){
    $("p").toggle();
  });
 </script>
</head> 
```

但是功能不起作用。我必须[在开发时自己托管 jquery](http://pypi.python.org/pypi/django-jquery/1.8.1)吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:51:06.810

您忘记关闭该`ready`功能：

```
$(document).ready(function(){
    $("button").click(function(){
        $("p").toggle();
    });
}); // <-- Close the function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T17:27:43.017

是的，您可以在 django 项目中使用 jquery。此代码的问题是您忘记关闭就绪按钮

```
$(document).ready(function(){
    $("button").click(function(){
        $("p").toggle();
    });
}); 
```

如果您想在您的 django 项目中使用 jquery，那么我建议您在基本模板中包含 jquery 并使用该模板来创建其他页面。此外，建议创建单独的 javascript、css 和 HTML 块，以便您可以选择要包含在特定页面中的文件，这样更容易。

# c++ - 成员函数的 std::async 调用

> ID：14912635
> 
> 赞同：11
> 
> 时间：2013-02-16T16:46:43.480
> 
> 标签：c++, class, asynchronous, c++11, function-pointers

考虑以下类：

```
class Foo
{
   private:
      void bar(const size_t);
   public:
      void foo();
}; 
```

现在`Foo::foo()`应该开始执行线程`bar`，所以这是它的实现方式：

```
void Foo:foo()
{
    auto handle = std::async(std::launch::async, &Foo::bar, this, 0);
    handle.get();
} 
```

这适用于 g++-4.6.3，但不适用于 g++-4.5.2，错误消息是

> include/c++/4.5.2/functional:180:9: 错误：必须使用 »。*« 或 »->* « 以 _Tp = void (Foo::*)(long unsigned int), 类型名 std::add_rvalue_reference<_Tp>::type = void ( Foo:: *&&)(long unsigned int) (...)«，例如 »(... ->* std::declval with _Tp = void (Foo::*)(long unsigned int), typename std::add_rvalue_reference <_Tp>::type = void (Foo::*&&)(long unsigned int)) (...)«

所以显然错误在于旧版本的g ++。可以通过公开方法并引入以下辅助函数来解决此问题：

```
void barHelp(Foo* foo, const size_t n)
{
    foo->bar(n);
}
void Foo:foo()
{
    auto handle = std::async(std::launch::async, barHelp, this, 0);
    handle.get();
} 
```

然而，公开一个方法并不是最好的设计决策。是否有另一种方法可以解决此问题*，而无需*更改编译器并将方法保留为私有？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-16T16:49:59.733

问题似乎是它不能很好地与成员函数配合使用。也许您可以`std::bind`先将成员函数传递给您的对象，然后再将其传递给`std::async`：

```
auto func = std::bind(&Foo::bar, this, std::placeholders::_1);
auto handle = std::async(std::launch::async, func, 0); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-07-10T14:52:21.880

我更喜欢 lambdas 到 std::bind

```
#include <iostream>
#include <future>

class Foo
{
private:
    void bar(const size_t)
    {}
public:
    void foo()
    {
        auto handle = std::async(std::launch::async, [this](){
            this->bar(0);
        });
        handle.get();
    }
};

int main()
{
    Foo foo;
    foo.foo();
    return 0;
} 
```

或者，但对我来说可读性较差，

```
 auto handle = std::async(std::launch::async, [this](const size_t num){
            this->bar(num);
        }, 0); 
```

# css - 伪类最后一个孩子

> ID：14912637
> 
> 赞同：0
> 
> 时间：2013-02-16T16:46:53.197
> 
> 标签：css, menu

我正在尝试在我的菜单上使用border-right 来实现分隔符效果。这是我的CSS代码

```
ul.navigation li a {
text-decoration:none;
float:left;
width:252px;
height:50px;
display:block;
background-color:#ccc;
text-align:center;
line-height:45px;
color:#000;
position:relative;
border-right:1px solid #333;
}

ul.navigation li a:last-child {
border:none;
} 
```

我究竟做错了什么？我也试过`border-left`了`:first-child`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:54:10.417

我在想你的意思是这样做

```
ul.navigation li:first-child a 
```

因为 every`a`是其 parent 的第一个孩子`li`。你的意思是`a`里面的第一个 li 项目。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T18:01:45.443

您的 CSS 片段充满了不良做法。

下面是如何设置样式以及如何在每个列表项之间添加分隔符的示例。

```
.navigation { overflow: hidden; }    /* Explanation 1 */
.navigation li { float: left; }

.navigation li + li {                /* Explanation 2 */
    border-left: 1px solid #333;
}

.navigation li a {
    display: block;
    width: 252px;                    /* Explanation 3 */
    padding: 5px 0;                  /* Explanation 4 */

    background-color:#ccc;
    color:#000;
    text-align:center;            
} 
```

1.  浮动遏制：[阅读这篇文章](http://colinaarts.com/articles/float-containment/)。

2.  在这里，我回答您的问题：使用 adiacent 兄弟选择器将第二个 li 左侧的边框应用于最后一个边框`+`。

3.  您确定要固定宽度吗？

4.  没有固定的高度和行高来垂直对齐文本。顺便说一句，line-height 不需要单位。[阅读这篇文章](http://www.456bereastreet.com/archive/200603/css_lineheight_does_not_need_a_unit/)。

    这是一个活生生的例子：[http ://dabblet.com/gist/4968063](http://dabblet.com/gist/4968063)

# jsp - 使用 Highchart 绘制带有开始和结束日期的图表

> ID：14912638
> 
> 赞同：0
> 
> 时间：2013-02-16T16:46:53.560
> 
> 标签：jsp, highcharts

我正在绘制 2012 年 1 月 1 日至 2012 年 12 月 31 日之间 1 年的回报。我有 200 天，每天有 1 个回报值。我将所有返回值作为系列和所有日期作为类别传递给 x 轴。

该图很好，但由于日期太多，在 x 轴上看不到任何东西。

有没有办法我只能在一个月的 x 轴上有 12 个刻度，并使用 200 个返回值来绘制图表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T09:54:43.953

除了上一篇文章的建议，您可以尝试使用主从图表。

[http://www.highcharts.com/demo/dynamic-master-detail](http://www.highcharts.com/demo/dynamic-master-detail)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T18:17:29.967

为什么不使用[**`highstock`**](http://www.highcharts.com/stock/demo/)图表？

他们为您提供[**`rangeSelector`**](http://api.highcharts.com/highstock#rangeSelector).

看一个[**`Demo`**](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/stock/demo/basic-line/)。

# php - 如何在购物车的外部网页上显示 opencart 总数

> ID：14912641
> 
> 赞同：0
> 
> 时间：2013-02-16T16:47:03.390
> 
> 标签：php, opencart

如何在 opencart 的外部网页上显示 $total。网页和 opencart 在同一台服务器上，但 opencart 安装在子文件夹中。我想显示总计和返回 opencart 的链接。到目前为止，我的链接如下：

```
 <div id="topcart">
    <p>
      <span class="cartamt">$123.00</span>
      <a href="/store/index.php?route=checkout/checkout"><img src="/images/icon-cart.png" alt="Cart" /></a>
    </p>
  </div><!-- end div topcart --> 
```

我只需要将 123.00 替换为 opencart 中的实际总金额。谢谢，罗伯特坎贝尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:30:15.830

最简单的方法是`getTotal()`将购物车类中调用的总数保存到会话变量中，然后在该页面中使用会话变量（假设它们在同一个域中并使用相同的会话）。要设置会话变量，请使用

```
$this->session->data['currentTotal'] = $total; 
```

就在`return $total;`之前`system/library/cart.php`。添加货币格式变得有点棘手。你需要使用

```
global $registry;
$this->session->data['currentTotal'] = $registry->get('currency')->format($total); 
```

之后，在您的非 OC 页面中启动一个会话（如果它尚未启动），然后添加

```
<?php echo empty($_SESSION['currentTotal'] ? '$0.00' : $_SESSION['currentTotal']); ?> 
```

代替您的 $123.00

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-21T17:15:55.763

对于其他试图找到这个答案的人来说，这很简单。像杰伊说的那样编辑`system/library/cart.php`文件，但是在获得总使用量时 `$_SESSION['default']['currentTotal']`。

# sql - 加入选择 SQL 查询？

> ID：14912642
> 
> 赞同：1
> 
> 时间：2013-02-16T16:47:09.370
> 
> 标签：sql, join

我正在尝试对一个表（Wordpress 使用的那个）运行查询，在该表中我想从一个表中选择 ID 和 post_type 列，然后对另一个表进行左连接，两次（获取单独的数据）。

这是我到目前为止所拥有的，但它并没有减少芥末：

```
SELECT derby_posts.id        AS pID, 
       derby_posts.post_type AS tier 
FROM   derby_posts 
       LEFT JOIN (SELECT derby_postmeta.post_id  AS dbID1, 
                         derby_postmeta.meta_key AS dbMeta1) 
              ON pid = dbid1 
                 AND dbmeta1 = 'twitter' 
       LEFT JOIN (SELECT derby_postmeta.post_id  AS dbID2, 
                         derby_postmeta.meta_key AS dbMeta2) 
              ON pid = dbid2 
                 AND dbmeta2 = 'website' 
WHERE  tier IN ('local', 'regional', 'national') 
```

我确定我错过了一些超级简单的东西......

编辑：这是对我有用的解决方案。表别名有帮助，​​将我所有的 SELECT 语句放在一起清理了一切。另外，我意识到我可以从 SELECT 中删除项目，即使我在 Join 中使用它们，这会清理很多结果。

```
SELECT 
    db.ID as id, 
    db.post_type as tier,
    dpm1.meta_value as twitter,
    dpm2.meta_value as website
FROM derby_posts db
LEFT JOIN derby_postmeta dpm1 ON (db.ID = dpm1.post_id AND dpm1.meta_key = 'twitter' )
LEFT JOIN derby_postmeta dpm2 ON (db.ID = dpm2.post_id AND dpm2.meta_key = 'website' )
WHERE db.post_type IN ('local','regional','national') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T16:50:28.703

> 我确定我错过了一些超级简单的东西......

你说的对！

您需要给您`select`的 s 一个别名，并在`ON`子句中使用该别名。您还缺少-从表中读取`FROM <table>`的语句的必需部分：`SELECT`

```
LEFT JOIN (
    SELECT derby_postmeta.post_id  AS dbID1, 
           derby_postmeta.meta_key AS dbMeta1
    FROM someTable
) dpm ON pid = dpm.dbid1 AND dpm.dbmeta1 = 'twitter' 
```

我给了你的结果`SELECT`an alias `dpm`，并用它来“链接”从内部选择的行到你的外部选择的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T16:52:29.430

```
SELECT 
    db.derby_posts.ID as pID, 
    db.derby_posts.post_type as tier,
    dpm1.post_id as dbID1,
    dpm1.meta_key as dbMeta1,
    dpm2.post_id as dbID2,
    dpm2.meta_key as dbMeta2
FROM derby_posts db
LEFT JOIN derby_postmeta dpm1 ON (db.pID = dpm1.post_id AND dpm1.meta_key= 'twitter')
LEFT JOIN derby_postmeta dpm2 ON (db.pID = dbm2.post_id AND dbm2.meta_key = 'website')
WHERE tier IN ('local','regional','national') 
```

# android - 如何从另一个活动的 SharedPreferences 获取值？

> ID：14912643
> 
> 赞同：-1
> 
> 时间：2013-02-16T16:47:17.763
> 
> 标签：android

在 onCreate 方法中有带有以下代码的主 Activity：

```
PreferenceManager.setDefaultValues(this, R.xml.preferences, false);
SharedPreferences prefs=MainActivity.this.getSharedPreferences("com.qerq.helloworldproject.PreferencesActivity", Activity.MODE_PRIVATE);
String editText=prefs.getString("edit_text", "default_edit_text_value");
boolean checkBox=prefs.getBoolean("check_box", true);
String list=prefs.getString("list", "default_list_value");

Log.i("edit_text_value", editText);
Log.i("check_box_value", String.valueOf(checkBox));
Log.i("list_value", list); 
```

PreferencesActivity 有 xml 布局：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">

    <PreferenceCategory
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:key="first_screen_key"
        android:summary="First summary"
        android:title="First title" >
        <CheckBoxPreference
            android:persistent="true"
            android:title="Check Box Title"
            android:key="check_box_key"
            android:defaultValue="false"/>
        <ListPreference 
            android:persistent="true"
            android:title="List Title"
            android:key="list_key"
            android:entries="@array/entries"
            android:defaultValue="second_value"
            android:entryValues="@array/entries_values"/>
        <EditTextPreference 
            android:persistent="true"
            android:title="Edit Text Title"
            android:key="edit_text_key"
            android:defaultValue="Edit Text Value"/>
    </PreferenceCategory>

</PreferenceScreen> 
```

但是我总是从代码中得到默认值！我需要使用 PreferencesActivity 更改值，但我还需要从 MainActivity 的源代码中获取值。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T17:36:15.330

A`PreferenceActivity`会将首选项保存到您不需要按名称访问的*默认值中。* `SharedPreferences`更改以下行...

```
SharedPreferences prefs=MainActivity.this.getSharedPreferences("com.qerq.helloworldproject.PreferencesActivity", Activity.MODE_PRIVATE); 
```

...至...

```
SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this); 
```

# load - 1 分钟 gif 大小和加载速度

> ID：14912653
> 
> 赞同：0
> 
> 时间：2013-02-16T16:47:57.093
> 
> 标签：load, gif, filesize

[测试 http://www.raapwerk.nl/zooi/03-wie-wij-zijn_1.gif](http://www.raapwerk.nl/zooi/03-wie-wij-zijn_1.gif)

^ 这是对我正在开发的网站的 gif 的（加速）测试（仅在您点击链接时播放）。最终它应该是一分钟长的 gif，每秒大约 12 帧。这四张肖像相互影响，所以他们必须在完全相同的时间播放。

现在，问题是 gif 的文件大小很大（大约 8 MB），现在我正试图找出一种使其可加载的方法（最好通过减小文件大小）。有没有办法，或者我应该完全放弃 gif 并使用不同的文件格式/技术？

# facebook-graph-api - 使用 Graph-API 在图片帖子中标记朋友和地点

> ID：14912654
> 
> 赞同：1
> 
> 时间：2013-02-16T16:48:01.393
> 
> 标签：facebook-graph-api, facebook-c#-sdk

我试图弄清楚当诸如图像之类的媒体对象已附加到帖子时如何标记朋友和位置。我知道在将消息发布到您自己的提要 (/me/feed) 时可以使用“标签”和“位置”参数，但发布到 /me/photo 的结果会有所不同，不幸的是根本不起作用。下面的代码片段是我到目前为止所拥有的：

```
 var photoIndex = 0;

            var facebookBatchParameters = new List<FacebookBatchParameter>();

            foreach (var photo in photos)
            {
                IDictionary<string, Object> parameters = new ExpandoObject();

                parameters["message"] = message;
                parameters["tags"] = "###, ###";
                parameters["place"] = "###";
                parameters[string.Format("photo{0}", photoIndex++)] =
                    new FacebookMediaObject {ContentType = "image/jpeg", FileName = photo.FileName}.SetValue(
                        photo.Data);

                facebookBatchParameters.Add(new FacebookBatchParameter
                    {
                        HttpMethod = HttpMethod.Post,
                        Path = "/me/photo",
                        Parameters = parameters
                    });
            }

            await App.FacebookClient.BatchTaskAsync(facebookBatchParameters.ToArray()); 
```

# javascript - Javascript 代码似乎无法在某些手机上运行

> ID：14912664
> 
> 赞同：0
> 
> 时间：2013-02-16T16:48:54.230
> 
> 标签：javascript, mobile

很抱歉，如果已经问过这个问题，但经过一番繁重的搜索后，我什么也没想到。我正在尝试将一些 Javascript 代码放入 Windows 服务器上的 HTML 页面中，以检测用户屏幕的宽度，如果它小于 599 像素，它会将它们重定向到网站的移动版本。我已经在 5 部手机和一台平板电脑上试用过，除了三星 Galaxy s3 之外，其他所有手机都可以使用。它确实启用了 Javascript，并且小于所需的像素数量。我不确定是否有更好的方法可以根据人们是移动用户还是我没有正确使用代码来将他们重定向到移动网站。代码如下

```
<script type="text/javascript">
if (screen.width <= 599) {
    document.location = "http://go.wapple.net/Neal";
}
</script> 
```

感谢您所有的帮助，

乔什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:33:19.650

您可以使用 USER_AGENT 标头。

您可以参考[这个 stackoverflow 问题](https://stackoverflow.com/questions/1005153/auto-detect-mobile-browser-via-user-agent)以获取更多详细信息。

# java - isUserInRole 有时会返回 false

> ID：14912665
> 
> 赞同：1
> 
> 时间：2013-02-16T16:48:57.460
> 
> 标签：java, jaas

我正在开发我的第一个 Jsf、Jaas、JPA、JBoss 应用程序，现在我遇到了这个问题。我在 JBoss 中创建了两个安全域：

```
<security-domain name="Database" cache-type="default">
<authentication>
    <login-module code="org.jboss.security.auth.spi.DatabaseServerLoginModule" flag="required">
        <module-option name="dsJndiName" value="java:jboss/JaasDS"/>
        <module-option name="principalsQuery" value="select password from user where mail=?"/>
        <module-option name="rolesQuery" value="select role, 'Roles'   from user u where u.mail=?"/>
    </login-module>
</authentication>
</security-domain>
<security-domain name="Custom" cache-type="default">
  <authentication>
    <login-module code="demo.SampleLoginModule" flag="required"/>
  </authentication>
</security-domain> 
```

如果我使用“数据库”域，一切正常，而如果我使用“自定义”域，则无法将角色设置为主体。

我的示例登录模块

```
public class SampleLoginModule implements LoginModule {
    private String username;
    private String password;

    private SamplePrincipal userPrincipal;

    public boolean login() throws LoginException {
        //Here i check the credentials 
    }

    public boolean commit() throws LoginException {
        //Here i add principal to subject 

        userPrincipal.setName("username");

        if (!(subject.getPrincipals().contains(userPrincipal))) 
            subject.getPrincipals().add(userPrincipal);
        }
    }
} 
```

我的简单校长

```
public class SamplePrincipal implements Principal {
    private String name;

    public SamplePrincipal() {
        super();
    }

    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }   
} 
```

我会在方法 commit 中为主体添加一个角色，`isUserInRole`否则返回`false`。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T21:10:53.513

添加一个名为 Roles 的 java.security.acl.Group ，其中包含用户的角色名称：

```
Set<Principal> principals = subject.getPrincipals();

Group roleGroup = new JAASGroup("Roles");
for (String role : userRoles)
  roleGroup.addMember(new RolePrincipal(role));

// group principal
principals.add(roleGroup);

// username principal
principals.add(new UserPrincipal("user")); 
```

其中 JAASGroup 是 java.security.acl.Group 的实现，RolePrincipal 和 UserPrincipal 是 java.security.Principal 的实现。

# ios - 如何播放多个声音？

> ID：14912670
> 
> 赞同：0
> 
> 时间：2013-02-16T16:49:21.973
> 
> 标签：ios, objective-c, avfoundation, playback

我需要播放多个声音文件。我有以下代码：

我的`.h`班级：

```
#import <UIKit/UIKit.h>
#import <AVFoundation/AVFoundation.h>
#import <AudioToolbox/AudioToolbox.h>

@interface ViewController : UIViewController {
    AVAudioPlayer *musicPlayer;
}

- (IBAction)music1:(id)sender;
- (IBAction)music2:(id)sender;
- (IBAction)music3:(id)sender;
- (IBAction)music4:(id)sender;
- (IBAction)music5:(id)sender;

@end 
```

我的`.m`档案

```
#import "ViewController.h"
@interface ViewController ()
@end
@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (IBAction)music1:(id)sender {

    if(musicPlayer.isPlaying)
    {
        [musicPlayer pause];
        return;
    }
    if(musicPlayer == nil)
    {
        NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"music1" ofType:@"wav" ]];
        musicPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:nil];
    }
    [musicPlayer play];
}

- (IBAction) music2:(id)sender {

    if(musicPlayer.isPlaying)
    {
        [musicPlayer pause];
        return;
    }
    if(musicPlayer == nil)
    {
        NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"music2" ofType:@"wav" ]];
        musicPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:nil];
    }
    [musicPlayer play];
}

- (IBAction) music3:(id)sender {

    if(musicPlayer.isPlaying)
    {
        [musicPlayer pause];
        return;
    }
    if(musicPlayer == nil)
    {
        NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"music3" ofType:@"wav" ]];
        musicPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:nil];
    }
    [musicPlayer play];
}

- (IBAction) music4:(id)sender {

    if(musicPlayer.isPlaying)
    {
        [musicPlayer pause];
        return;
    }
    if(musicPlayer == nil)
    {
        NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"music4" ofType:@"wav" ]];
        musicPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:nil];
    }
    [musicPlayer play];
}

- (IBAction) music5:(id)sender {

    if(musicPlayer.isPlaying)
    {
        [musicPlayer pause];
        return;
    }
    if(musicPlayer == nil)
    {
        NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"music5" ofType:@"wav" ]];
        musicPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:nil];
    }
    [musicPlayer play];
}
@end 
```

但是这段代码不起作用：只播放一个音乐文件。其他文件没有。

另外，还有一个例子：
Music1 正在播放。

我按下 Music2 按钮 -> Music1 结束，Music2 开始。

我需要如何修改我的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:54:06.260

每个声音都需要 AVAudioPlayer：

。H：

```
 #import <UIKit/UIKit.h>
            #import <AVFoundation/AVFoundation.h>
            #import <AudioToolbox/AudioToolbox.h>

            @interface ViewController : UIViewController {
                AVAudioPlayer *musicPlayer1;
                AVAudioPlayer *musicPlayer2;
                AVAudioPlayer *musicPlayer3;
                AVAudioPlayer *musicPlayer4;
                AVAudioPlayer *musicPlayer5;

NSMutableArray playingMusicArray;

            }

            - (IBAction)music1:(id)sender;
            - (IBAction)music2:(id)sender;
            - (IBAction)music3:(id)sender;
            - (IBAction)music4:(id)sender;
            - (IBAction)music5:(id)sender;

        @end 
```

米：

```
#import "ViewController.h"
@interface ViewController ()
@end
@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    playingMusicArray = [[NSMutableArray alloc] init];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)stopPlayingMusic {
    for(AVAudioPlayer *audioPlayer in playingMusicArray)
    {
        [audioPlayer pause];
        [playingMusicArray removeObject:audioPlayer];

    }
}
- (IBAction)music1:(id)sender {

    [self stopPlayingMusic];
    if(musicPlayer1 == nil)
    {
        NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"music1" ofType:@"wav" ]];
        musicPlayer1 = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:nil];
    }
    [playingMusicArray addObject:musicPlayer1];
    [musicPlayer1 play];
}

- (IBAction) music2:(id)sender {

    [self stopPlayingMusic];
    if(musicPlayer2 == nil)
    {
        NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"music2" ofType:@"wav" ]];
        musicPlayer2 = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:nil];
    }
    [playingMusicArray addObject:musicPlayer2];

    [musicPlayer2 play];
}

- (IBAction) music3:(id)sender {

    [self stopPlayingMusic];

    if(musicPlayer3 == nil)
    {
        NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"music3" ofType:@"wav" ]];
        musicPlayer3 = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:nil];
    }
    [playingMusicArray addObject:musicPlayer3];

    [musicPlayer3 play];
}

- (IBAction) music4:(id)sender {

    [self stopPlayingMusic];

    if(musicPlayer4 == nil)
    {
        NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"music4" ofType:@"wav" ]];
        musicPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:nil];
    }
    [playingMusicArray addObject:musicPlayer4];

    [musicPlayer4 play];
}

- (IBAction) music5:(id)sender {

    [self stopPlayingMusic];

    if(musicPlayer5 == nil)
    {
        NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"music5" ofType:@"wav" ]];
        musicPlayer5 = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:nil];
    }
    [playingMusicArray addObject:musicPlayer5];

    [musicPlayer5 play];
}
@end 
```

# tomcat - netbeans tomcat 清除日志文件

> ID：14912679
> 
> 赞同：7
> 
> 时间：2013-02-16T16:49:58.277
> 
> 标签：tomcat, netbeans, logfiles

我一直在开发一个应用程序，不小心创建了一个无限循环。大量输出进入 tomcat 服务器日志文件，每次我从 NetBeans 启动 tomcat 时，IDE 都会将所有这些日志加载到 GUI 中。它使我的计算机在没有运行内存的情况下窒息。不幸的是，IDE 没有提供任何“清除日志”按钮。

我一直在尝试定位 tomcat 日志文件，但我失败了。我的tomcat安装在subdir`~/apache-tomcat-7.0.27`下最新的日志文件是. 今天是 2013-02-16。而且我在下面没有找到tomcat ;)`logs``catalina.2013-01-12.log``/var/log`

我已经尝试重新启动 NetBeans，但它并没有改变任何东西。IDE 仍在加载大量日志 - 所以文件必须在某个地方。

我很感激有关在哪里搜索这些文件的任何提示。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-16T17:01:07.233

不知何故，我设法找到了正确的目录：`~/.netbeans/7.2.1/apache-tomcat-7.0.27.0_base/logs`. 它拥有 1,7 GB :)

不过，我不知道：

*   为什么没有 /var/log/tomcat （可能是因为 tomcat 安装在 NB 中而不是作为独立包）
*   为什么要放入 ~/.netbeans 目录

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-30T11:59:36.180

对于 Windows 7 上的我来说，日志位于：

```
C:\Users\<user>\AppData\Roaming\NetBeans\7.2.1\apache-tomcat-7.0.27.0_base 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-06-05T19:13:57.890

tomcat 日志文件取决于您的配置，要查看它们的确切位置，请在 NetBeans 中转到“工具”菜单并单击“服务器”。选择您正在使用的 Tomcat 版本，然后在“连接”选项卡中查看“Catalina Base”字段。那就是你需要的文件路径，进入这个文件夹，在我的例子中是“C:\Users\Tiago Peres\AppData\Roaming\NetBeans\7.3\apache-tomcat-7.0.34.0_base”，进入文件夹“logs”，然后删除一切。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-27T23:38:55.470

您总是可以创建一个脚本来在启动时删除日志文件。我想自己做这个，发现了一篇很棒的文章，里面有关于如何做这个的说明：http: [//blog.sixthpoint.com/clearing-tomcat-logs-on-startup/](http://blog.sixthpoint.com/clearing-tomcat-logs-on-startup/)

编辑：本文使用 Linux .sh 文件，但您可以使用此方法轻松创建 Windows .bat 文件。脚本必须稍作修改，替换`del`为`rm`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-19T08:27:50.053

如果您像我一样，厌倦了 Netbeans 以某种方式显示上一个调试会话的剩余部分，以及旧的堆栈跟踪等 - 另一个想法是修改 %CATALINA_HOME%\conf\logging.properties 以使其保持空白最低限度。但是不幸的是，JULI AsyncFileAppender 没有公开控制新会话如何处理现有文件的属性（例如 LOG4J 附加程序的 .append=false 选项）。

所以我最终修改了catalina.bat，风险自负，并且有危险在几周后我会忘记我这样做了，并且会怀疑并责怪我周围的世界为什么我的日志目录在我每次开始时突然被清理干净雄猫。

%CATALINA_HOME%\bin\catalina.bat：

```
...

REM these are the original lines that existed in catalina.bat before
rem Copy CATALINA_BASE from CATALINA_HOME if not defined
if not "%CATALINA_BASE%" == "" goto gotBase
set "CATALINA_BASE=%CATALINA_HOME%"
:gotBase

REM these are the lines that I am adding
rem cleanup logs directory
del /q/s %CATALINA_HOME%\logs\*.*

... 
```

# php - 如何修改 HTML 标签名称的正则表达式？并让标签独立？

> ID：14912686
> 
> 赞同：-1
> 
> 时间：2013-02-16T16:50:31.483
> 
> 标签：php, regex, text, syntax

函数原型：

```
findHTMLElement( $output, $tagName ); 
```

看正则表达式：

```
preg_match_all( "/\<{$tagName}(.*)\>(.*)\<(.*)\/(.*){$tagName}\>/is", $output, $matches ); 
```

如果我在 html 中有这个：

```
<script type="text/javascript" language="javascript" src="miarchivo.css">
</script>

<script type="text/javascript"  src="otroarchivo.js">
</script>

<script type="text/javascript"  src="otroarchivox.js"></script>

<script type="text/javascript"  src="otroarchivox.js">xyzzz</script> 
```

我会得到这个：

```
Array
(
    [0] => Array
        (
            [0] => <script type="text/javascript" language="javascript" src="miarchivo.css">
    </script>

    <script type="text/javascript"  src="otroarchivo.js">
    </script>

    <script type="text/javascript"  src="otroarchivox.js"></script>

    <script type="text/javascript"  src="otroarchivox.js">xyzzz</script>
        ) ) 
```

而且，我想要得到的是：

```
 Array
    (
        [0] => Array
            (
                [0] => <script type="text/javascript" language="javascript" src="miarchivo.css">
        </script>

       [1] => <script type="text/javascript"  src="otroarchivo.js">
        </script>

        [2] => <script type="text/javascript"  src="otroarchivox.js"></script>

[3] =>        <script type="text/javascript"  src="otroarchivox.js">xyzzz</script>
            ) ) ) 
```

如何修改正则表达式以获得类似的东西！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:53:50.420

尝试不贪婪的[修饰符 /U](http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php)。

# javascript - Javascript - 返回值不被视为整数

> ID：14912687
> 
> 赞同：4
> 
> 时间：2013-02-16T16:50:39.680
> 
> 标签：javascript, function, integer, return

我对**测试**函数的返回值有疑问。这是代码：

```
$(document).ready(function () {
    $("p").hide( test );

    function test() {
            return 5000;
    }
}); 
```

经过一番研究，发现了 parseInt() 函数。但它没有用。

1.  尝试使用**parseInt()**：

    ```
        $(文档).ready(函数 () {
            $("p").hide(测试);

            功能测试（） {
                返回 parseInt(5000, 10);
            }
        });

    ```

2.  尝试使用**parseInt()**：

    ```
        $(文档).ready(函数 () {
            $("p").hide(parseInt(test, 10));

            功能测试（） {
                返回 5000；
            }
        });

    ```

我知道我可以输入：

```
$("p").hide(5000);
```

但是解决了这个问题后，该功能将变得更加复杂。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T16:52:09.757

您没有执行该功能：

```
$(document).ready(function () {
    $("p").hide( test() );  // note the additional ()

 function test() {
  return 5000;
 }
}); 
```

# drupal - 如何使用 hook_page_alter 在单个节点上隐藏块模块？

> ID：14912688
> 
> 赞同：0
> 
> 时间：2013-02-16T16:50:40.180
> 
> 标签：drupal, drupal-7

我有一个名为 share_page 的块模块。

我查看了 $page 数组，果然我有区域“内容”，这个模块总是驻留的（但它被设置为不显示在某些页面上）。

这是我在 .module 文件中的功能

```
function mymodule_page_alter(&$page) {
  unset($page['content']['share_page']['#block']);
} 
```

抛出的错误是： Undefined index: share_page in mymodule_page_alter()

但是块模块（share_page）并没有消失。有谁知道我可以如何隐藏这个模块？...而且，也可以将它隐藏在一个特定的页面上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T23:07:29.153

**部分解决方案：**

```
unset($page['content']['share_page_share_page']); 
```

...但这会将其从网站上的所有页面中删除 - 不确定您如何定位单个节点？

# ssis - 如何修复错误“无法创建 appdomain ssisdb.dbo[runtime].x”？

> ID：14912693
> 
> 赞同：5
> 
> 时间：2013-02-16T16:51:08.993
> 
> 标签：ssis, sql-server-2012

我正在尝试将 SSIS 2012 项目部署到新建 SQL Server 机器上的 SSIS 目录。创建文件夹时，它会引发错误并显示以下消息。

```
Failed to create appdomain ssisdb.dbo[runtime].6. 
```

尝试通过 SSMS 创建文件夹也会引发相同的错误，但使用 `ssisdb.dbo[runtime].7`

我在实例上启用了 CLR，现在它抛出了同样的错误`ssisdb.dbo[runtime].9`

我试过运行`create_folder proc`- 相同的错误，SQL Server 不会让我进入 proc。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-16T17:32:20.487

网络上的一些搜索显示 Microsoft Connect 网站上报告了相关问题。Microsoft 建议这可能是由于最近安装了 CLR/.NET 相关补丁，系统重新启动正在等待。尝试重新启动服务器，然后创建*SSISDB*目录。

[*无法创建 AppDomain "master.sys[runtime].X"*](http://connect.microsoft.com/SQLServer/feedback/details/693184/failed-to-create-appdomain-master-sys-runtime-x)

### 引用自 Microsoft Connect 网站：

像这样的错误：

```
Msg 6517, Level 16, State 1, Line 3
AppDomain "MDS.dbo [runtime] .20" Could not create.
Exception has been thrown by the target of an invocation. 
```

直接来自 .NET/CLR 本身。这通常与 CLR/.NET 本身的一些不一致有关。这意味着 CLR 安装已损坏（不太可能），或者更有可能是最近安装了 .NET 补丁并且机器正在等待重新启动。

让我们知道重新启动是否不能解决问题。

关于从升级步骤 677 到 678 的升级失败：此问题已在 Denali RC1 中修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-18T16:59:11.917

我有这个问题一天，更新我的 Windows 和 .NET 框架后问题消失了。问题与 .Net 框架有关，尝试修复它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-29T10:20:34.397

您只需要重新启动 sql server 服务即可。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-27T23:07:11.737

我在一项 SQL SSIS 作业中遇到此错误。许多工作都因同样的错误而失败。当我检查最近的安装时，我看到 DOTNET 已安装，之后服务器没有完全重新启动。我重新启动了服务器，问题得到了解决。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-04T17:15:41.843

我有一个挂起的 .NET 更新等待重新启动，它受到 .NET Web 应用程序以及 SSIS 的干扰。重新启动服务器并完全安装更新解决了我们的问题。

# python - 无法使用 selenium RC 启动 Firefox

> ID：14912696
> 
> 赞同：1
> 
> 时间：2013-02-16T16:51:15.083
> 
> 标签：python, selenium-rc

我启动了 selenium-server-standalone-2.29.0 服务器。我有python 2.7。我还下载了硒包。当我运行这个脚本时，我希望 Firefox 应该启动。但什么也没有发生。我错过了什么吗？

```
import unittest,selenium

class NewTest(unittest.TestCase):

    def setUp(self):

        self.selenium = selenium("localhost", 4444, "*firefox",
                "http://www.google.com/")
        self.selenium.start()

    def test_new(self):

        self.selenium.open("/")
        selenium.type("q","selenium rc")

    def tearDown(self):
        self.selenium.stop() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T18:07:58.423

也许是这样的？

```
import unittest
from selenium import webdriver

class NewTest(unittest.TestCase):

    def setUp(self):
        self.browser = webdriver.Firefox()

    def test_new(self):
        self.browser.get("http://www.google.com")
        elem = self.browser.switch_to_active_element()
        elem.send_keys('some search query')

    def tearDown(self):
        self.browser.quit() 
```

请注意，为了测试这样的东西，我会错误地使用 BDD 测试（可能使用`lettuce`）来代替......

# c++ - 为什么在使用初始化列表时非显式构造函数被显式构造函数隐藏？

> ID：14912698
> 
> 赞同：1
> 
> 时间：2013-02-16T16:51:22.350
> 
> 标签：c++, c++11

考虑遵循二叉树，其中节点有两个儿子或带有标签的叶子。此代码在 g++ 4.7.2 中编译：

```
#include <memory>
using namespace std;

struct Tree {
    unique_ptr<Tree> left, right;
    char label;

    Tree(char label) : label(label) {}

    Tree(Tree && left, Tree && right) :
        left(new Tree(move(left))), 
        right(new Tree(move(right))) {}

    //~ explicit Tree(Tree && left, bool right) {}

} tree {{1, 2}, 3}; 
```

当我取消注释显式构造函数时，它无法编译（如果这个显式构造函数是私有的，它也会失败）。这是 gcc 错误，还是显式构造函数禁止对具有相同数量参数的非显式构造函数使用初始化列表构造？

编辑：s/隐式/非显式/。抱歉，我使用“隐式”一词表示“允许隐式转换”，而“显式”一词则表示“用关键字显式标记”。我将编译器自动生成的构造函数称为“默认”，所以我没有注意到“隐式”这个词会如此模棱两可。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T18:45:41.243

你的问题似乎假设了一些不正确的东西，并揭示了一个基本的误解。

首先，隐式生成的构造函数在“使用初始化列表时”不会隐藏。每当您定义构造函数时，无论您是否将其标记为，它们的生成都会被简单地禁止`explicit`。

但请注意：“隐式”构造函数通常是指当您不提供时由编译器隐式（自动）生成的构造函数，而不是缺少`explicit`修饰符的构造函数。在上一段中，我谈论的是前者，但我被引导相信您正在考虑后者。

假设是这种情况，那么无论您是否使用初始化列表，未标记为*的*构造函数都不会被标记为`explicit`的构造函数隐藏。`explicit`

 *您的程序无法编译的原因是您的`explicit`构造函数恰好比非构造函数更匹配`explicit`，因为它接受 a`bool`作为其第二个参数，它只需要标准转换来匹配参数`2`。另一方面，`explicit`接受 a 的非构造函数`Tree&&`需要用户定义的转换，其中涉及临时`Tree`对象的构造，并且标准转换优于用户定义的转换。

要强制编译器`Tree`从参数构造一个临时变量`2`而不是转换`2`为 a `bool`（因此，调用非`explicit`构造函数），您必须通过将构造函数调用更改为以下内容来指定它：

```
struct Tree
{
    ...
} tree {{1, Tree(2)}, 3}; // Explicitly specify the second argument is to be
                          // used to create a temporary Tree object, rather
                          // than being converted to a bool 
```

另请注意，虽然这同样适用于顶级树的创建（即也`3`被转换为 a`bool`并且您的`explicit`构造函数被再次调用），但在这种情况下这不是问题，因为您正在直接初始化`tree`对象，并且不尝试隐式转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T19:24:11.397

您的问题的解决方案可能是：

```
template<
  typename Bool,
  typename=typename std::enable_if<
    std::is_same<
      typename std::decay<Bool>::type,
      bool
    >
  >::type
>
explicit Tree(Tree && left, Bool&& right) {} 
```

我已经阻止了任何类型的转换，而不是`bool`作为第二个参数传递的变体。

但是，您最好创建一个静态方法来执行此构造函数想要做的事情，而不是在问题上抛出更多重载的构造函数。*

# java - 当我添加不存在的字符串时，过滤后的 ListView 应该为空

> ID：14912699
> 
> 赞同：0
> 
> 时间：2013-02-16T16:51:25.640
> 
> 标签：java, android, listview, filter, baseadapter

我有一个带有列表和 EditText 的 Activity，EditText 用于输入字符串，以便列表包含该字符串。ListView 基于 BaseAdapter，包含 F 类型的元素。

```
public class lstAdaptF extends BaseAdapter implements Filterable {
Context ctx;
LayoutInflater lInflater;
ArrayList<F> objectsF;
ArrayList<F> origobjectsF;
...
private Filter FirmaBBFilter;

lstAdaptF(Context context, ArrayList<F> f) {
    ctx = context;
    objectsF = f;
    origobjectsF = f;
    lInflater = (LayoutInflater) ctx.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
}
...
@Override
public Filter getFilter() {
    if (FFilter == null)
        FFilter = new FFilter();
    return FFilter;
}

...
private class FFilter extends Filter {
    @Override
    protected FilterResults performFiltering(CharSequence constraint) {
        FilterResults results = new FilterResults();
        if (constraint == null || constraint.length() == 0) {
            //get all inital list
            results.values = origobjectsF;
            results.count = origobjectsF.size();
            Log.d("lstAdaptF","empty filter");
        } else {
            // We perform filtering operation
            ArrayList<F> nF = new ArrayList<F>();

            for (F p : origobjectsF) {
                if (p.getName().toUpperCase().contains(constraint.toString().toUpperCase())){
                    nF.add(p);

                }
            }
            results.values = nF;
            results.count = nF.size();
        }
        return results;
    } 
```

一切正常，例如列表包含字符串

```
Awork
Aworth
winter 
```

我输入“w”：Awork、Aworth、winter

我输入“wo”：Awork，Aworth

我输入“woo”：Awork，Aworth - 列表仍然相同，但它应该是空的！我该如何处理这种情况？谢谢你。

升级版：

```
@Override
    protected void publishResults(CharSequence constraint, FilterResults results) {
        // Now we have to inform the adapter about the new list filtered
        if (results.count == 0)
            notifyDataSetInvalidated();
        else {          
            objectsF = (ArrayList<F>) results.values;
            notifyDataSetChanged();

        }
    } 
```

UPD2：

```
@Override
public Object getItem(int position) {
    return objectsF.get(position);
}

 @Override
public int getCount() {
    return objectsF.size();
} 
@Override
public View getView(int position, View convertView, ViewGroup parent) {

    View view = convertView;
    FHolder holder = new FHolder();

    if (view == null) {
        view = lInflater.inflate(R.layout.itemf, parent, false);
        TextView tvAF = (TextView) view.findViewById(R.id.tvA);
...
        holder.tvAF = tvAF;
...
        view.setTag(holder);
    }
    else 
        holder = (FHolder) view.getTag();

    F p = getF(position);
    holder.tvAF.setText(p.a + "");
    ..
    return view;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T18:12:21.670

好像有什么问题`notifyDataSetInvalidated()`。尝试删除这个`if-else`：

```
@Override
protected void publishResults(CharSequence constraint, FilterResults results) {
    // Now we have to inform the adapter about the new list filtered       
    objectsF = (ArrayList<F>) results.values;
    notifyDataSetChanged();
} 
```

# c++ - 如何实现 is_polymorphic_functor？

> ID：14912703
> 
> 赞同：2
> 
> 时间：2013-02-16T16:52:05.487
> 
> 标签：c++, templates, c++11, metaprogramming, decltype

我正在尝试实现`is_polymorphic_functor`元功能以获得以下结果：

```
//non-polymorphic functor
template<typename T> struct X { void operator()(T); };

//polymorphic functor 
struct Y { template<typename T> void operator()(T); };

std::cout << is_polymorphic_functor<X<int>>::value << std::endl; //false
std::cout << is_polymorphic_functor<Y>::value << std::endl; //true 
```

嗯，这只是一个例子。理想情况下，它应该适用于*任意*数量的参数，即`operator()(T...)`. [这里有几个测试用例](http://stacked-crooked.com/view?id=76ba03862a18526fd7082e0dda2f5c8d)，我用来测试@Andrei Tita 的解决方案，但两个测试用例都失败了。

我试过这个：

```
template<typename F>
struct is_polymorphic_functor
{
  private:
     typedef struct { char x[1]; }  yes;
     typedef struct { char x[10]; } no;

     static yes check(...);

     template<typename T >
     static no check(T*, char (*) [sizeof(functor_traits<T>)] = 0 );            
  public:
     static const bool value = sizeof(check(static_cast<F*>(0))) == sizeof(yes);
}; 
```

它试图利用以下实现`functor_traits`：

```
//functor traits
template <typename T>
struct functor_traits : functor_traits<decltype(&T::operator())>{};

template <typename C, typename R, typename... A>
struct functor_traits<R(C::*)(A...) const> : functor_traits<R(C::*)(A...)>{};

template <typename C, typename R, typename... A>
struct functor_traits<R(C::*)(A...)>
{
   static const size_t arity = sizeof...(A) };

   typedef R result_type;

   template <size_t i>
   struct arg
   {
      typedef typename std::tuple_element<i, std::tuple<A...>>::type type;
   };
}; 
```

这为多态函子提供了以下错误：

```
error: decltype cannot resolve address of overloaded function 
```

如何解决此问题并按`is_polymorphic_functor`预期工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T17:07:31.513

这对我有用：

```
template<typename T>
struct is_polymorphic_functor
{
private:
    //test if type U has operator()(V)
    template<typename U, typename V>
    static auto ftest(U *u, V* v) -> decltype((*u)(*v), char(0));
    static std::array<char, 2> ftest(...);

    struct private_type { };

public:
    static const bool value = sizeof(ftest((T*)nullptr, (private_type*)nullptr)) == 1;
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T18:23:45.357

```
template<template<typename>class arbitrary>
struct pathological {
  template<typename T>
  typename std::enable_if< arbitrary<T>::value >::type operator(T) const {}
}; 
```

上述函子是非多态的，当且仅当只有一个 T`arbitrary<T>::value`是真的。

创建一个在和可能`template<T>`上为真的函子并不难，并且仅在if 上为真（任意计算返回 1）。`int``double``double`

所以一个不妥协`is_polymorphic`是超出了这个宇宙的范围。

如果你不喜欢上面的（因为它显然需要的不仅仅是`int`，其他类型根本无法找到重载），我们可以这样做：

```
template<template<typename>class arbitrary>
struct pathological2 {
  void operator()(int) const {}
  template<typename T>
  typename std::enable_if< arbitrary<T>::value >::type operator(T) const {}
}; 
```

测试第二个“重载”的地方，如果没有 T 使得它被采用，那么每个单一类型都会发生第一个重载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-16T17:51:06.113

鉴于非多态函子没有重载`operator()`：

```
template<typename T>
class is_polymorphic_functor {
  template <typename F, typename = decltype(&F::operator())>
  static constexpr bool get(int) { return false; }
  template <typename>
  static constexpr bool get(...) { return true; }

public:
  static constexpr bool value = get<T>(0);
}; 
```

# c# - 存储在数据库中的路径不正确

> ID：14912704
> 
> 赞同：4
> 
> 时间：2013-02-16T16:52:08.497
> 
> 标签：c#, mysql, winforms

```
private void button14_Click(object sender, EventArgs e)
        {
            if (openFileDialog1.ShowDialog() == System.Windows.Forms.DialogResult.OK)
            {
                    string c = openFileDialog1.FileName;

                    string connString = "Server=Localhost;Database=test;Uid=root;password=root;";
                    MySqlConnection conn = new MySqlConnection(connString);
                    MySqlCommand command = conn.CreateCommand();
                    command.CommandText = ("Insert into data (path) values('" + c + "')");
                    conn.Open();
                    command.ExecuteNonQuery();
                    conn.Close();
                    MessageBox.Show("Success");
                }
            } 
```

这段代码对我有用，但不幸的是，存储在数据库中的路径不正确.. 存储的路径是这样的（`C:Users hesisDesktopREDEFENSEResourcesImagesRED1f.png`），它应该是这样的（`C:P/Users/thesis/Desktop..../1f.png`）。

但是当我用这段代码检查“sr”值时.. msgbox 显示得恰到好处..

```
private void button14_Click(object sender, EventArgs e)
{
    if (openFileDialog1.ShowDialog() == System.Windows.Forms.DialogResult.OK)
    {         
        MessageBox.Show(openFileDialog1.FileName);
    }
} 
```

为什么会这样呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-16T16:57:07.933

也许 MySQL 认为“\”字符是一个转义字符，所以这就是它不包含在字符串中的原因。尝试

```
c.Replace(@"\", @"\\") 
```

插入时，转义字符将被转义。

编辑：例如，像这样替换命令文本初始化行。还为单引号添加转义。

```
string escapedPath = c.Replace(@"\", @"\\").Replace("'", @"\'");    
command.CommandText = ("Insert into data (path) values('" + escapedPath + "')"); 
```

编辑：使用参数化查询，请参阅@Matthew's answer以获得更多“最佳实践”解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-16T17:03:04.193

这是由于您编写查询的方式。在 MySQL 中，反斜杠字符`\`（存在于文件路径中）具有特殊含义，即转义下一个字符。您需要对这些进行编码，许多不同的 DBMS 都有执行此操作的模式。

除此之外，您的代码容易受到[SQL 注入](http://en.wikipedia.org/wiki/Sql_injection)的影响。

要解决这两个问题，您可以使用参数化查询。

```
public void InsertPath(string path)
{
    string connString = "Server=Localhost;Database=test;Uid=root;password=root;";

    using (var connection = new MySqlConnection(connString))
    {
        connection.Open();

        using (var command = connection.CreateCommand())
        {
            command.CommandText = "INSERT INTO data(path) VALUES(?path)";

            command.Parameters.AddWithValue("?path", path);

            command.ExecuteNonQuery();
        }
    }
} 
```

这个答案可能不是 100% 准确，因为我的计算机上没有 MySQL，但希望如果它不起作用，它至少应该为您提供一些有关如何解决此问题的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T17:06:23.753

为什么不使用参数化查询？你可以避免转义字符串的大部分麻烦，防止一整类安全风险，如果你这样做的话，还可以从查询缓存中获得一点点性能。

通常，它看起来像这样：

```
cmd.CommandText = "INSERT INTO data (path) values(?path)";

cmd.Prepare();
cmd.Parameters.AddWithValue("?path", c); 
```

自从我编写任何明确的 C# 查询代码（大约 6 个月左右）以来已经足够长了，我不记得这是否完全正确，而且我知道 MySql 提供程序对命名参数使用与 MSSQL 略有不同的参数化约定（它使用@path 而不是 ?path)，但这应该会让你走上正确的道路。有关可能与您相关的更多指导，请参阅[C# MySqlParameter 问题。](https://stackoverflow.com/questions/2322274/c-sharp-mysqlparameter-problem)

# mysql - 在 Django 中优化查询

> ID：14912707
> 
> 赞同：1
> 
> 时间：2013-02-16T16:52:18.900
> 
> 标签：mysql, django-models, mysql-python

我正在使用 django 创建一个站点。为了测试，我创建了一个包含 100 万行的数据库，每行包含关于我网站上图像的信息（上传者、方向、描述和其他一些信息）。每个图像都有多个标签，这些标签存储在标签关系数据库中。表被索引。

标记关系数据库 id

`tag_id`= 标记表的外键

`Tag_relation`= 图像表的外键（100 万行）

现在我提供了一个页面，用户可以在其中使用图像行中的标签和其他参数（如上传器等）搜索图像。

现在这是我为创建搜索列表而运行的查询。

```
SELECT * FROM photos_main_tb,photos_tag_relation 
WHERE photos_main_tb.id=photos_tag_relation.relation_id ORDER BY photos.rating LIMIT 0,10 
```

现在我可以正常工作，给我图像。但是随着限制变得更大，所花费的时间稳步增加并变成几秒钟。

```
SELECT * FROM photos_main_tb,photos_tag_relation 
WHERE photos_main_tb.id=photos_tag_relation.relation_id ORDER BY photos.rating LIMIT 500000,10 
```

我可以做的一项优化是子查询并指定一个限制 Like

```
SELECT * FROM (photos_main_tb LIMIT 200,000,800000) ,photos_tag_relation 
WHERE photos_main_tb.id=photos_tag_relation.relation_id ORDER BY photos.rating LIMIT 
0,10 
```

但这并不能真正解决我的问题。我希望能够像这个网站一样列出：http: [//airteamimages.com/search.php](http://airteamimages.com/search.php)。许多图像不会减慢速度。我是mysql的新手。原谅任何错误。我希望能够以毫秒为单位加载搜索中的每个页面，就像第一个查询一样。

更新：像第一条评论一样，我将停止选择 * 而只选择 id，这确实加快了速度。但是有没有其他技巧。该代码是否值得用于生产站点？

# java - 导入 xmlvm 时出错

> ID：14912708
> 
> 赞同：-2
> 
> 时间：2013-02-16T16:52:27.293
> 
> 标签：java, pdf

我正在使用 eclipse 用 java 语言编写一个程序，我想使用

```
 import org.xmlvm.ios.CGPDFDocument; 
```

但显示错误为`"The import org.xmlvm cannot be resolved"`. 请帮助如何克服这个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T12:14:11.820

[您需要在此处找到的](http://www.xmlvm.org)XMLVM 库

最好使用提供的模板创建一个新项目

```
xmlvm --skeleton=iphone --out=OUTDIR --app-name=APPNAME 
```

您需要正确安装 XMLVM 并将其放在您的路径中。

[您可以在此处找到](https://sites.google.com/a/xmlvm.org/documentation/#TOC-How-to-start-a-new-project-under-XMLVM)有关此命令行的更多信息

# css - 如何在相对宽度为 80% 的容器内的图像顶部放置文本

> ID：14912712
> 
> 赞同：0
> 
> 时间：2013-02-16T16:52:43.200
> 
> 标签：css

我想在容器内的图像顶部放置文本，宽度为 80%
conainer.width 80% - 下面的代码不起作用
conainer.width 100% - 下面的代码
[是我的brouser的工作屏幕截图](http://s3.postimage.org/5tjnodflv/result.png)

```
<style type="text/css">
.conainer {
    margin: auto;
    width: 80%; /* change that to 100% code will work */
    border: thin solid #000;
}
h2 { 
   position: absolute; 
   top: 200px; 
   left: 0; 
   width: 100%; 
}
.image { 
   position: relative; 
   width: 100%; /* for IE 6 */
}

</style>

<div class="conainer">
    <div class="image">
        <img src="img/banners.jpg" width="100%" height="100%" />
        <h2>some text gos here</h2>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T16:57:34.483

您应该只设置 div 的**背景**，而不是尝试将**h2**放在**img**标签的顶部

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:57:36.503

这个对我有用。还有代码吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T17:00:44.993

我认为最节省代码和兼容的方法是使用 CSS 将您的横幅图像定义为 div.image 的背景图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-16T17:03:07.593

将您的`h2`样式替换为

```
h2 { 
   position: fixed;//yours is on top of image but absolutely positioned, so not visible
   top: 200px; 
   left: 0;  //Specify where you want to put your image with top and left properly now.
   width: 100%; 
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-16T17:36:42.397

行！我发现问题更改前 200 => 前 0

```
h2 { 
   position: absolute; 
   top: 0px; 
   left: 0; 
   width: 100%; 
```

# c# - Porting a winform app to monodevelop on mac

> ID：14912714
> 
> 赞同：4
> 
> 时间：2013-02-16T16:53:03.407
> 
> 标签：c#, winforms, visual-studio, monodevelop

I'm tryng to port a winforms app created in Visual Studio to Mac with monodevelop. After resolving compiling errors, when I run the program, the application outputs these exceptions:

```
System.NullReferenceException: Object reference not set to an instance of an object
 at System.Windows.Forms.TextBoxBase.set_Lines (System.String[] value) [0x00000] in <filename unknown>:0

  at (wrapper remoting-invoke-with-check) System.Windows.Forms.TextBoxBase:set_Lines (string[])

  at WindowsFormsApplication1.Main_Form.amp_portante_ValueChanged (System.Object Sender) [0x00025] in /Users/giuseppe/Desktop/CRUZER/Csound Converter/WindowsFormsApplication1/Main_Form.cs:381

  at KnobControl.KnobControl.OnValueChanged (System.Object sender) [0x00000] in <filename unknown>:0

  at KnobControl.KnobControl.set_Value (Int32 value) [0x00000] in <filename unknown>:0 
  at (wrapper remoting-invoke-with-check) KnobControl.KnobControl:set_Value (int)
  at WindowsFormsApplication1.Main_Form.textb2_TextChanged (System.Object sender, System.EventArgs e) [0x00085] in /Users/giuseppe/Desktop/CRUZER/Csound Converter/WindowsFormsApplication1/Main_Form.cs:1023 
  at System.Windows.Forms.Control.OnTextChanged (System.EventArgs e) [0x00000] in <filename unknown>:0 
  at System.Windows.Forms.TextBoxBase.OnTextChanged (System.EventArgs e) [0x00000] in <filename unknown>:0 
  at System.Windows.Forms.TextBoxBase.set_Text (System.String value) [0x00000] in <filename unknown>:0 
  at System.Windows.Forms.TextBox.set_Text (System.String value) [0x00000] in <filename unknown>:0 
  at WindowsFormsApplication1.Main_Form.SimpleFM_Conf () [0x00058] in /Users/giuseppe/Desktop/CRUZER/Csound Converter/WindowsFormsApplication1/Main_Form.cs:45 
  at WindowsFormsApplication1.Main_Form.Main_Form_Load (System.Object sender, System.EventArgs e) [0x00012] in /Users/giuseppe/Desktop/CRUZER/Csound Converter/WindowsFormsApplication1/Main_Form.cs:359 
  at System.Windows.Forms.Form.OnLoad (System.EventArgs e) [0x00000] in <filename unknown>:0 
  at System.Windows.Forms.Form.OnLoadInternal (System.EventArgs e) [0x00000] in <filename unknown>:0 
```

The application works perfectly in Visual Studio and I have no idea what I should do.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-10T07:59:37.290

您可能有一个无法实例化的自定义控件 (KnobControl)。

也许你没有这个控件或者这个控件不能用单声道编译。

查看 Main_Form.cs 中的第 381 行

问候，

# c# - ERROR XNA Framework VertexBuffer IndexBuffer 使用

> ID：14912716
> 
> 赞同：1
> 
> 时间：2013-02-16T16:53:15.380
> 
> 标签：c#, xna, xna-4.0, terrain

在阅读了 XNA 4.0 书籍后，我正在创建一个游戏。它将是 3D 的，但我已经陷入了创建地形的困境......

更新：从这里开始的一切都是更新......地形更新：

```
public void Update(Matrix view, Matrix projection)
    {
        View = view;
        Projection = projection;
        World = Matrix.CreateTranslation(-Width / 2f, 0, Height / 2f);
    } 
```

地形图：

```
public void Draw(GraphicsDevice g)
    {
        effect.CurrentTechnique = effect.Techniques["ColoredNoShading"];
        effect.Parameters["xView"].SetValue(View);
        effect.Parameters["xProjection"].SetValue(Projection);
        effect.Parameters["xWorld"].SetValue(World);
        foreach (EffectPass pass in effect.CurrentTechnique.Passes)
        {

            pass.Apply();
         //g.DrawUserIndexedPrimitives(PrimitiveType.TriangleList, vertices, 0, vertices.Length, indices, 0, indices.Length / 3, VertexPositionColorNormal.VertexDeclaration);
          g.DrawIndexedPrimitives(PrimitiveType.TriangleList, 0, 0, vertices.Length, 0, indices.Length / 3);
        }
    } 
```

注释行有效，在这两种情况下我都能看到地形......以下代码用于初始化顶点和索引缓冲区：

```
private void SetUpVertices(GraphicsDevice g)
    {
        float currentH;
        int currentI;
        vertices = new VertexPositionColorNormal[Width * Height];
        for (int x = 0; x < Width; x++)
        {
            for (int y = 0; y < Height; y++)
            {
                currentH = heightData[x,y];
                currentI = x + y * Width;
                vertices[currentI].Position = new Vector3(x, currentH , -y);
                if (currentH < minH + (maxH - minH) / 3)
                    vertices[currentI].Color = Color.ForestGreen;
                else if (currentH < maxH - (maxH - minH) / 3)
                    vertices[currentI].Color = Color.LawnGreen;
                else
                    vertices[currentI].Color = Color.White;
            }
        }
        SetUpIndices(g);
    }
    private void SetUpIndices(GraphicsDevice g)
    {
        indices = new int[(Width - 1) * (Height - 1) * 6];
        int counter = 0;
        for (int y = 0; y < Height - 1; y++)
        {
            for (int x = 0; x < Width - 1; x++)
            {
                int lowerLeft = x + y * Width;
                int lowerRight = (x + 1) + y * Width;
                int topLeft = x + (y + 1) * Width;
                int topRight = (x + 1) + (y + 1) * Width;

                indices[counter++] = topLeft;
                indices[counter++] = lowerRight;
                indices[counter++] = lowerLeft;
                indices[counter++] = topLeft;
                indices[counter++] = topRight;
                indices[counter++] = lowerRight;
            }
        }
        SetUpNormals(g);
    }
    private void SetUpNormals(GraphicsDevice g)
    {
        for (int i = 0; i < vertices.Length; i++)
        {
            vertices[i].Normal = Vector3.Zero;
        }
        int[] index = new int[3];
        Vector3 s1, s2, n;
        for (int i = 0; i < vertices.Length / 3; i++)
        {
            for (int y = 0; y < 3; y++)
                index[y] = indices[i * 3 + y];
            s1 = vertices[index[0]].Position - vertices[index[2]].Position;
            s2 = vertices[index[0]].Position - vertices[index[1]].Position;
            n = Vector3.Cross(s1, s2);
            for (int y = 0; y < 3; y++)
            {
                vertices[index[y]].Normal += n;
                vertices[index[y]].Normal.Normalize();
            }
        }
        FillBuffers(g);
    }
    private void FillBuffers(GraphicsDevice g)
    {
        VertexBuffer = new VertexBuffer(g, VertexPositionColorNormal.VertexDeclaration, vertices.Length, BufferUsage.WriteOnly);
        VertexBuffer.SetData(vertices);
        IndexBuffer = new IndexBuffer(g, typeof(int), indices.Length, BufferUsage.WriteOnly);
        IndexBuffer.SetData(indices);
        g.Indices = IndexBuffer;
        g.SetVertexBuffer(VertexBuffer);
    } 
```

我不认为有错误，因为它与另一条线一起工作。我正在使用的 .fx 文件可能有错误。如果您这么认为，我将切换到 BasicEffects...（您可能会注意到，代码来自[http://www.riemers.net/eng/Tutorials/XNA/Csharp/series1.php](http://www.riemers.net/eng/Tutorials/XNA/Csharp/series1.php)）

谢谢你的帮助...

你的，弗洛里安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T08:18:58.027

（回答[问题的原始修订](https://stackoverflow.com/revisions/14912716/1)。）

您没有将顶点缓冲区和索引缓冲区设置到图形设备上。这两行代码（未经测试）应该可以满足您的需要：

```
g.GraphicsDevice.Indices = indexBuffer;
g.GraphicsDevice.SetVertexBuffer(vertexBuffer); 
```

将它们放置在您在效果 ( `ef`) 上设置参数之后，在循环之前。

顶点缓冲区提供异常消息要求的顶点声明。

* * *

**问题更新后编辑：**在您的新版本中，您正在设置顶点和索引缓冲区 - 但它位于错误的位置。您需要在每帧将它们设置到图形设备上。只有在您将它们设置为`FillBuffers`. 但我猜这些东西是在你班级的`Draw`方法之外绘制的？

If that something else is a `SpriteBatch`, even *it* works using vertex buffers and index buffers. So it will reset your settings. (It's worth adding that it also sets render states - in which case you might need to see [this article](http://blogs.msdn.com/b/shawnhar/archive/2010/06/18/spritebatch-and-renderstates-in-xna-game-studio-4-0.aspx).)

# image - GUI to view values in image using OpenCV in ubuntu12.04

> ID：14912717
> 
> 赞同：0
> 
> 时间：2013-02-16T16:53:16.313
> 
> 标签：image, user-interface, opencv, pixels

Is it possible to simultaneously display an image and the pixel,coordinate values based on the mouse pointer positions?

I am asking an OpenCV equivalent of imview function in MATLAB.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T05:58:18.883

[尝试使用我不久前编写的旧代码](https://stackoverflow.com/a/8196180/176769)单独使用 OpenCV 时遇到了一些问题。在这一点上，我不确定我是否错过了某些东西，或者它是否是 OpenCV 中的错误。我会进一步调查这个。

但是我在[我的存储库中分享了一个](https://github.com/karlphillip/GraphicsProgramming)[简短的、独立的、正确的（可编译的）示例](http://sscce.org/)，**请检查****[cvImage](https://github.com/karlphillip/GraphicsProgramming/tree/master/cvImage)**。它是用**C++ 和 Qt 和 OpenCV**编写的。这是一个 Qt 应用程序，它**使用 OpenCV 加载图像并将 RGB 值显示为 Qt 窗口的标题**。

 ****![](../Images/17967538e9b02c9ac3295413250195d4.png)

移动鼠标并将光标放在您感兴趣的像素顶部以查看其 RGB 值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T02:59:27.767

可以使用鼠标回调事件来完成。你可以找到一个很好的例子`\opencv\samples\cpp\grabcut.cpp`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T21:13:44.100

你不需要 Qt 来做到这一点。只需使用默认的 OpenCV 函数[`imshow`](http://docs.opencv.org/modules/highgui/doc/user_interface.html#imshow)来显示图像并[`SetMouseCallback`](http://docs.opencv.org/modules/highgui/doc/user_interface.html#setmousecallback)在鼠标单击时设置回调。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-16T17:39:47.183

支持 Qt 的 Opencv 可以做到这一点。****

# c++ - 在没有 new 和 delete 关键字的情况下编写 c++？最好的方法？

> ID：14912723
> 
> 赞同：1
> 
> 时间：2013-02-16T16:53:51.673
> 
> 标签：c++, containers

我正在尝试在不使用关键字`new`and的情况下编写 c++ 代码`delete`。

首先，这是一个好习惯吗？

像这样编码的副作用之一是我不能依赖`nullptr`空值。

例如：

`std::array<std::array<fb::Block *, Panel::Y>, Panel::X> blocks;`

变成

`std::array<std::array<fb::Block, Panel::Y>, Panel::X> blocks;`

描述空 Block 的最佳方式是什么？

我虽然关于使用这个：

```
class Block {
  private:
  protected:
  public:
  ...
  static const Block EMPTY;
  };
}

const Block EMPTY(0, BlockType::TUTORIAL, 0, 0); 
```

你们有什么感想 ？这是一个好方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T17:03:22.367

如果您想编写安全代码并简化内存管理，您确实应该避免使用`delete`. 但是没有必要丢弃`new`. 最好的方法是分配您想要的任何对象`new`并将其存储在智能指针中，例如`std::shared_ptr`or `std::unique_ptr`。您始终可以将这些指针与`nullptr`. 并且所有对象都会被自动删除。

在这种情况下，有些人会建议将 raw 替换`new`为`make_shared`and`make_unique`调用。

相关的问题是何时使用`T&`以及何时使用`T*`将参数传递给函数。经验法则是：`T*`在输入参数可能不存在时使用`T&`，用于确保提供输入参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T17:13:31.063

C++ 是一种为实现最高性能而设计的语言，同时提供了非常高级的特性（完整的 OO、多重继承、泛型编程）。“最大性能”的一部分正是使用显式内存管理（是的，有一些语言，甚至像[Boehm 收集器](http://en.wikipedia.org/wiki/Boehm_garbage_collector)这样的 C++ 包，可以减轻您跟踪分配内存的负担；成本巨大，有时甚至令人望而却步） . C++ 是一个*工具*，它恰好有*非常*锋利的边缘。远离儿童的手。使用时要格外小心。

该语言的功能包括在适当的时间和地点*使用。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:58:43.237

> 像这样编码的副作用之一是我不能依赖 nullptr 来获取空值。

你到底在说什么？`nullptr`制作一个很好的空指针，无论该指针应该指向哪里。`new`它与和没有任何关系`delete`。Not `new`ing 不会阻止您使用指针，无论是否为空。

> 首先，这是一个好习惯吗？

两者`new`都`delete`非常不安全，因此将它们从你的代码库中驱除是非常好的，就像它们是传染性的错误瘟疫一样。绝对不应该使用`delete`. `new`稍微复杂*一些*，因为一些非常薄的包装有更多的理由，比如

```
template<typename T, typename... Args> std::unique_ptr<T> make_unique(Args&&... args) {
    return std::unique_ptr<T>(new T(std::forward<Args>(args)...));
} 
```

但是，*绝对*正确的是，在专门用于分配智能指针的包装器之外，您永远不应该使用 non-placement `new`，也不应该使用`delete`or `delete[]`。使用 RAII 类，如智能指针和容器，可以安全地保证程序的正确性。

# php - 不能将 $_GET 用作数字索引数组

> ID：14912727
> 
> 赞同：0
> 
> 时间：2013-02-16T16:54:07.843
> 
> 标签：php, arrays, get, indexing, numeric

我在原型阶段。我在 page1.php 中有一个链接发送到下面的页面：

```
http://localhost/sayfa.php?rd_dil=turkish&rd_sayfa=yazilar&rd_yazar=ali_uysal&rd_baslik=kalem_ucu" 
```

在此页面中，`echo $_GET['rd_dil']`有效并显示`turkish`，但 echo $_GET[0] 显示`Notice : Undefined offset: 0`

所以我想以数字方式（数字索引）使用 $_GET 吗？我怎样才能实现这个目标？我阅读了 php.net + 堆栈溢出并用谷歌搜索，但我无法解决我的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:57:25.297

$_GET 是一个关联数组，可以循环遍历它：

```
foreach($_GET as $key=>$value) {
   ....
} 
```

如果您只需要数值数组中的值，您可以使用：

```
$myData = array_values($_GET);
// here you have a numeric array containing the $_GET values
echo $myData[0]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T16:56:10.843

由于`$_GET`是关联数组，因此您可以将值分配给新数组：

```
foreach($_GET as $key=>$val) {
   $_GET2[] = $val;
} 
```

或者您可以`array_values`按照 axel.michel 的建议使用：

```
$_GET2 = array_values($_GET);
echo $_GET2[0]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T16:59:25.613

你不能直接这样做。但是有一些解决方法：

```
$indexed = array_values($_GET);
$first = $indexed[0];

$keys = array_keys($_GET);
$first = $_GET[$keys[0]];

$first = current(array_slice(array('foo'), 0, 1))); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-16T16:55:06.910

是的，你不能。这就是它的工作原理。
只是没有这样的索引。

您不需要数字索引，但必须使用关联键。

您不应该将 $_GET 转换为枚举列表的原因有两个：

*   不保证参数顺序。您**必须**使用字段名称而不是职位。
*   这只是对CPU的无用浪费。你想从你的枚举数组中得到的一切，你都可以从原始的 $_GET 中得到。例如，用于`foreach()`迭代它。

如果您仍然不知道如何正确处理 $_GET - 问这个问题，您将得到正确的答案。

# ios - 在 iOS 中从 UIAlertView 访问 UITableViewCell

> ID：14912730
> 
> 赞同：1
> 
> 时间：2013-02-16T16:54:18.140
> 
> 标签：ios, uitableview, uialertview

我在 UITableView 单元格中有一个删除按钮。此按钮的功能是从 Core Data 中删除该特定单元格的内容。此过程无法撤消；所以，我添加了 UIAlertView 让用户在继续删除之前确认他们的决定。

看来我需要在里面编写所有删除逻辑......

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex 
```

但是，这是一个委托方法。表格单元格的索引路径丢失？点击 UIAlertView 按钮后如何访问 UITableViewCell 数据？

我现在想到的一个想法是遍历使用`alertview.superview`直到找到 UITableViewCell，并访问它的 indexPath 属性。但这似乎并不优雅。应该有另一种方法来解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T17:19:21.813

使用关联对象。此处更详细地描述了[相关对象](http://blog.andymatuschak.org/post/173646741/your-new-friends-obj-c-associated-objects)

要设置您使用的对象，请使用：

```
objc_setAssociatedObject(alert, &key, userCode, OBJC_ASSOCIATION_RETAIN); 
```

并获取对象。

```
SOCode *userCode = objc_getAssociatedObject(alertView, &key); 
```

永远不要忘记导入`<objc/runtime.h>`，您还需要添加`static char key`；所以它在这两种方法的范围内。

**参考：** [UIAlertView 能否通过委托传递字符串和 int](https://stackoverflow.com/questions/5439560/can-a-uialertview-pass-a-string-and-an-int-through-a-delegate)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T17:05:59.373

因为是模态的，所以我在保存（全局）变量之前`UIAlertView`的 indexPath 没有看到任何问题（并且可能清除该变量（只是为了安全起见）。至少这是我所做的当我遇到这个问题时。`UITableViewCell``UIAlertView``- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex`

附言。这远非最佳实践，但只要您进行一些基本检查，您应该没问题。

# jakarta-ee - application server works

> ID：14912731
> 
> 赞同：0
> 
> 时间：2013-02-16T16:54:24.873
> 
> 标签：jakarta-ee, ear, application-server

An ear file has many wars and jars in it. How does the application server knows which war file to invoke after deployment of .ear in it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T20:32:58.000

也许您想问：如何触发特定的战争（即 Web 应用程序）？如果是这样，答案是：EAR 应用程序描述符 ( `application.xml`) 为它包含的每个 WAR 定义**上下文根**。上下文根是紧跟在主机和端口之后的 URL 部分，例如：

```
<module>
  <web>
    <web-uri>some.war</web-uri>
    <context-root>/somepath</context-root>
  </web>
</module> 
```

表单的每个 URL`http://host:port/somepath/*`都由 Java EE 应用程序服务器的 HTTP 服务器组件定向到包含在`some.war`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T10:53:21.063

补充 MaDa 的正确答案：如果上下文根未在任何一个`application.xml`或专有部署描述符中明确指定，则战争文件的名称（减去扩展名）将被视为上下文根。

例如，给定一个`some.war`内部 a`myapp.ear`和一个侦听 HTTP 端口 8080 的服务器，您可以通过以下方式访问您的 Web 模块：`http://localhost:8080/some/`

# macos - Mac 上的 Qt：如何获取允许手动写入所需文件路径的文件对话框？

> ID：14912738
> 
> 赞同：1
> 
> 时间：2013-02-16T16:55:28.430
> 
> 标签：macos, qt, qt4, qt5, qfiledialog

在 Mac OS-X 上，通常会显示目录对话框，而无法使用键盘输入路径。这似乎是我在 OS-X 上构建 Qt 应用程序时的默认行为。

如何指定我确实希望手动输入路径？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-24T06:21:37.957

我建议使用 QFileDialog 的静态方法获得的本机对话框。根据 Apple 的新沙盒要求，您必须使用应用程序的标准对话框来访问文件系统。实际上，有趣的是，在沙盒应用程序中为用户提供的实际对话框是一种称为 Powerbox 的东西。[您可以在 NSPanel 文档](https://developer.apple.com/library/mac/documentation/cocoa/reference/applicationkit/classes/NSSavePanel_Class/Reference/Reference.html)中阅读有关它的更多信息。

同样正如 elmigranto 在 Mac 上的所有文件对话框中指出的那样，您可以按 command + shift + g 输入要导航到的路径。

注意：在较新的 Qt 版本中，文档暗示他们更正了这一点，以便使用 QFileDialog 上的静态函数为您提供一个也通过 PowerBox 的本机对话框。虽然我自己没有尝试过，但[这个问题上的错误](https://bugreports.qt.io/browse/QTBUG-48414)仍然对 Qt 5.5.0 和 5.6.0 开放。但是，覆盖 QFileDialog 并不会为您提供本机对话框。如果您需要自定义对话框，则可以使用 NSSavePanel 路线。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T17:19:04.680

如果您使用 的静态功能`QFileDialog`，例如`getExistingDirectory()`，`getOpenFileName()`您将获得本机 OS X 文件对话框。但是，如果您在不使用静态函数的情况下创建自己`QFileDialog`的文件，您应该得到一个 Qt 文件对话框，您可以通过调用指定用户必须在对话框中选择的内容`setFileMode()`。我认为 Qt 文件对话框将让用户手动更改对话框中的路径。

当然，如果您只想让用户手动输入目录路径，您也可以使用简单的`QInputDialog`.

# php - Repeatable custom field display

> ID：14912739
> 
> 赞同：0
> 
> 时间：2013-02-16T16:55:33.300
> 
> 标签：php, wordpress, custom-fields

I've got this far with some PHP to display a repeatable field but the output just displayed Array

Any ideas would be greatly appreaciated:

```
<?php
$repeatable = get_post_meta( get_the_ID(), 'ecpt_eventdaytime', true);
if( !empty($repeatable )) {
    echo '<img src="/wp-content/uploads/2013/02/Time.gif">';
    echo $repeatable ;
    echo "<br><br>";
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T16:59:18.613

试试这样：

```
<?php if (have_posts()) :
      while (have_posts()) : the_post(); 
        $repeatable = get_post_meta( get_the_ID(), "ecpt_eventdaytime", true ); 
        echo $repeatable ;
      endwhile;
      endif;
?> 
```

或者，如果您想在循环外显示自定义字段值，只需使用以下代码。问题是，您只需要 ID。

```
<?php 
    global $wp_query;
    $postid = $wp_query->post->ID;
    echo get_post_meta($postid, 'ecpt_eventdaytime', true);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:57:24.643

because [`get_post_meta`](http://codex.wordpress.org/Function_Reference/get_post_meta) return array you need to use loop

> Quoting from [**wordpress**](http://codex.wordpress.org/Function_Reference/get_post_meta#Return_Value)
> 
> `<?php $meta_values = get_post_meta($post_id, $key, $single); ?>`
> 
> **Return Value**
> 
> *   If only $id is set it will return all meta values in an associative array.
> *   If $single is set to false, or left blank, the function returns an array containing all values of the specified key.
> *   If $single is set to true, the function returns the first value of the specified key (not in an array)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T00:01:05.590

如果`ecpt_eventdaytime`是数组，则：

```
<?php
$repeatable = get_post_meta( get_the_ID(), 'ecpt_eventdaytime', true);
if( !empty($repeatable )) {
    foreach($repeatable as $value) {
        echo '<img src="/wp-content/uploads/2013/02/Time.gif">';
        echo $value;
        echo "<br><br>";
    }
}
?> 
```

# linux - How to get USB device details in kernel programming?

> ID：14912746
> 
> 赞同：2
> 
> 时间：2013-02-16T16:56:06.743
> 
> 标签：linux, linux-kernel, kernel, linux-device-driver, libusb

I am new to kernel programming and I have dev_t value of a USB device.

I want to get the details of the device like vendor ID, product ID, or some other attribute which will vary from device to device. I want to do this in kernel space, and without loading my program as an external module.

I have came across a libusb library, however, as far as I know, it is used in user space. Is it possible to use libusb in kernel space also, like my requirement? If possible, how to import and set-up libusb so that I can compile kernel?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T08:27:03.523

最好为此任务编写一个可加载的内核模块。每次你发现一个错误，你只需要针对你的内核编译你的模块并加载它。内核中有一个为 USB 定义的框架，使用内核提供的 API 来做你正在寻找的事情。除了 libusb 是一个用户空间库，在内核中使用它没有意义。在用户空间中，您也可以使用 procfs/sysfs 访问 USB 相关信息。

# r - 交易策略测试中的累积回报

> ID：14912747
> 
> 赞同：0
> 
> 时间：2013-02-16T16:56:07.243
> 
> 标签：r, algorithmic-trading

我有一个基于订单不平衡的信号，我想针对历史库存数据进行测试。

我还有每个信号的价格，然后我计算价格趋势以查看最近 4 个价格的回报是上涨还是下跌。从我收到的信号

```
nSignal <- pnorm(Signal, mean = mean(Signal), sd = sd(Signal)) 
```

现在我的想法是每次 nSignal 升至 0.70 以上时买入/做空。如果趋势是正面的，那么我会买入，如果趋势是负面的，我会做空。

```
Sell   if( nSignal > = 0.70 && Trend < 0 ) 
Buy    if( nSignal > = 0.70 && Trend > 0 ) 
Ignore if( nSignal > = 0.70 && Trend = 0 ) 
```

然后，当 nSignal 再次开始下降时，我将退出该位置。我不想在任何时候拥有一个以上的空缺职位。因此，如果在我有未平仓头寸时出现买入/卖出信号，我会忽略。

我的问题是关于 Sell 和 Buy 向量的编码以及这些向量的回报的计算。理想情况下，我希望有 1 个向量作为输出。

我可以产生买入/卖出信号，但我坚持告诉 R 忽略进一步的买入/卖出，直到 nSignal 下降并释放头寸。我附上了我想计算的东西。

```
 dd <- textConnection("PriceTao,nSignal,Trend,Sell ,Buy,,Return
79.35,0.799276057198847,0.00632873284203539, ,Buy,79.35,
79.5,0.800495492911607,0.00631674578326402, ,,,
79.55,0.849748126078447,0.00378111963884864, ,,,
79.7,0.781025021425822,0.00440489652262133, ,release,79.7,0.00100623484156181
79.7,0.850907051807651,0.00251453735437934, ,Buy,79.7,
79.85,0.835339437922026,0.00376766425320585, ,release,79.85,0.000429459362427442
80,0.829431322197511,0.00376057994561618, ,,,
79.75,0.721861766918789,0.000635579945616138, ,,,
79.8,0.749198554641736,-0.000619518523171436,Sell, ,79.8,
79.9,0.655121878771812,-0.00124490792027077,release, ,79.9,-0.000285955381947645
79.85,0.638399458172212,0.00125430985194441, , ,,
79.75,0.677237812176031,-0.00062499754849088, , ,,
79.8,0.77229131417357,-0.00125117113292239,Sell, ,79.8,
79.9,0.78060399324371,0.00062774392694287, ,,,
80,0.785209846277682,0.00313165653529857, ,,,
80,0.71354933296563,0.00250469728764968,release,,80,-0.000571553096032407
80,0.723175396790292,0.00125156445556929, ,,,
80.05,0.645047940052525,0.000624999999999876, , ,,
79.95,0.654754824370203,-0.000624219237976287, , ,,
79.95,0.66648952405407,-0.000624219237976287, , ,,
80.05,0.66246174072327,1.56250061034147E-06, , ,,
80.1,0.64268970941157,0.00187539135757464, , ,,
80.05,0.626534449371471,0.00125117163223132, , ,,
80.05,0.659757399947805,3.89893644814343E-07, , ,,
80.15,0.605440623800618,0.000624999512632951, , ,,
80.15,0.555063339554548,0.00124921923797627, , ,,
80.1,0.623048801370024,0.000625388919822667, , ,,
79.95,0.671863289394849,-0.00249648949418346, , ,,
80.05,0.629889151643382,-0.00124570775559696, , ,,
80.15,0.692044829948308,0.000627341800532921, , ,,
80.25,0.781503635407542,0.00374766161286955, ,Buy,80.25,
80.35,0.767181308420401,0.00374298579328602, ,release,80.35,0.000283988254209611
80.2,0.712321509444304,0.000626933947966979, ,,,
")

Data <- read.table(dd, header = TRUE, sep = ",")
close(dd) 
Data 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T17:12:10.507

这是基本移动平均交叉系统的实现。调整它以适应您的需求应该是微不足道的。

```
library(quantmod)
library(tseries) # for maxdrawdown if you want it

x <- getSymbols("SPY", src="yahoo", from="2012-01-01", to="2012-12-31", auto.assign=FALSE)
n1 <- 20 # for short term moving average
n2 <- 50 # for long term moving average

x$ma1 <- SMA(Ad(x), n1) # add a short term MA
x$ma2 <- SMA(Ad(x), n2) # add a long term MA
x$spd <- x$ma1 - x$ma2 # difference between the two
x$spd[1:n2] <- 0 # flat until we have enough data to calculate both MAs
x$cross <- c(0, diff(x$spd > 0, na.pad=FALSE)) # short cross long
x$pos <- NA # Position
x$pos[x$cross == 1] <- 1 # long where it crosses from below
x$pos[x$cross == -1] <- -1 # short where it crosses from above
# fill forward your position until you get the next signal.  Also, you have to 
# lag your signal because today's return will be a result of yesterday's position
x$pos <- c(0, lag(na.locf(x$pos), na.pad=FALSE)) 
x$pos[is.na(x$pos)] <- 0
x$ret <- c(0, ROC(Ad(x), na.pad=FALSE))
x$cumret <- cumsum(x$pos * x$ret)
out <- data.frame(n1=n1, n2=n2, cumret=as.numeric(last(x$cumret)), 
                  mdd=maxdrawdown(x$cumret)$maxdrawdown, ntrades=sum(abs(x$cross)))
out
tail(x) 
```

* * *

### 编辑

好的，然后使用您的数据

```
library(quantmod) # for Lag.  Also loads zoo which is needed for na.locf, and 
                  # TTR which is needed for ROC
x <- Data[, 1:3]
x$pos <- NA
x$pos[with(x, nSignal >= 0.7 & Trend < 0)] <- -1
x$pos[with(x, nSignal >= 0.7 & Trend > 0)] <- 1
x$pos <- na.locf(x$pos)
x$pos[is.na(x$pos)] <- 0 # first few rows are NA; replace with 0 meaning "no position"
x$ret <- ROC(x$PriceTao) * Lag(x$pos) # yesterdays position * return from yesterday to today
x 
```

请注意，您使用的 a`data.frame`比 a 慢`matrix`。此外，您没有任何与您的数据相关的日期或时间。恕我直言`xts`，或者`zoo`如果您实际上有时间序列数据，这将是一个更好的数据结构。

# google-app-engine - 如何从 webapp2_extras.appengine.auth.models.Unique 中删除？

> ID：14912750
> 
> 赞同：4
> 
> 时间：2013-02-16T16:56:29.827
> 
> 标签：google-app-engine, authentication

我在我的项目中使用 webapp2_extras.appengine.auth，它在数据存储区中创建了 3 个表：User、UserToken 和 Unique。一切都很好，并且工作正常......

我的问题是：如何从 Unique 中删除某些内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-17T02:49:03.043

我很难找到要删除的确切内容，因为 Unique 模型不包含对 User 的引用。这是解决方案（参考文档）：

```
from google.appengine.ext import ndb
from webapp2_extras import auth

class SomeUserHandler():
  def forget_user(self):
    auth = auth.get_auth()
    user_dict = auth.get_user_by_session()
    user = auth.store.user_model.get_by_id(user_dict['user_id'])

    # from webapp2_extras.appengine.auth.models.User
    # http://webapp-improved.appspot.com/_modules/webapp2_extras/appengine/auth/models.html#User
    # 
    # def add_auth_id(self, auth_id):
    #   ...
    #   unique = '%s.auth_id:%s' % (self.__class__.__name__, auth_id)
    #   ...
    Unique.delete_multi( map(lambda s: 'User.auth_id:' + s, user.auth_ids) ) 
```

# java - What's wrong with this Java Applet code?

> ID：14912751
> 
> 赞同：-1
> 
> 时间：2013-02-16T16:56:30.533
> 
> 标签：java, applet

I'm trying to run this code in java applet via appletviewer in Fedora 18\. But I get this error

```
java.lang.NullPointerException
    at main.init(main.java:42)
    at sun.applet.AppletPanel.run(AppletPanel.java:436)
    at java.lang.Thread.run(Thread.java:722) 
```

As per my code 42nd line in my code is `bMul.setBounds(100, 280, 50, 50);` but this isn't wrong as-far-as i know. After searching on Google, I found that

> NullPointerException is a runtime Exception thrown by the JVM when your application code, other referenced API(s) or middleware (Weblogic, WAS, JBoss...) encounters the following conditions:
> 
> *   Attempting to invoke an instance method of a null object
> *   Attempting to access or modify a particular field of a null object
> *   Attempting to obtain the length of such null object as an array

I've tried hard but failed in making it work. Please help me. Here I provide main.java file's code.

```
import java.awt.*;
import java.applet.*;
import java.awt.event.*;

public class main extends Applet implements ActionListener {
  Button b0, b1, b2, b3, b4, b5, b6, b7, b8, b9;
  Button bAdd, bSub, bMul, bDiv, bEqu, bCls, bDec, bSqrt, bSin, bCos, bTan;
  TextField tf1;
  int add, sub, mul, div, temp = 0;
  double sqr, s, c, ta;
  String t = "";

  public void init() {
    setLayout(null);
    setFont(new Font("cantarell", Font.BOLD, 12));
    b0 = new Button("0"); b1 = new Button("1");
    b2 = new Button("2"); b3 = new Button("3");
    b4 = new Button("4"); b5 = new Button("5");
    b6 = new Button("6"); b7 = new Button("7");
    b8 = new Button("8"); b9 = new Button("9");
    bAdd = new Button("+"); bSub = new Button("-");
    bSub = new Button("*"); bDiv = new Button("/");
    bEqu = new Button("="); bSqrt = new Button("sqrt");
    bSin = new Button("sin"); bCos = new Button("cos");
    bTan = new Button("tan"); bCls = new Button("cls");
    tf1 = new TextField("0");
    tf1.setEditable(false);
    tf1.setColumns(8);
    tf1.setBounds(100, 100, 250, 50);
    b0.setBounds(100, 130, 50, 50);
    b1.setBounds(150, 130, 50, 50);
    b2.setBounds(200, 130, 50, 50);
    b3.setBounds(250, 130, 50, 50);
    b4.setBounds(100, 180, 50, 50);
    b5.setBounds(150, 180, 50, 50);
    b6.setBounds(200, 180, 50, 50);
    b7.setBounds(250, 180, 50, 50);
    b8.setBounds(100, 230, 50, 50);
    b3.setBounds(150, 230, 50, 50);
    bAdd.setBounds(200, 230, 50, 50);
    bSub.setBounds(250, 230, 50, 50);
    bMul.setBounds(100, 280, 50, 50);
    bDiv.setBounds(150, 280, 50, 50);
    bEqu.setBounds(200, 280, 50, 50);
    bSin.setBounds(300, 130, 50, 50);
    bCos.setBounds(300, 180, 50, 50);
    bTan.setBounds(300, 230, 50, 50);
    bSqrt.setBounds(250, 280, 50, 50);
    bCls.setBounds(300, 280, 50, 50);
    add(b0); add(b1); add(b2);
    add(b3); add(b4); add(b5);
    add(b6); add(b7); add(b8); add(b9);
    add(bAdd); add(bSub); add(bMul); add(bDiv);
    add(bEqu); add(bSin); add(bCos); add(bTan);
    add(bSqrt); add(bCls); add(tf1);
    b0.addActionListener(this);
    b1.addActionListener(this);
    b2.addActionListener(this);
    b3.addActionListener(this);
    b4.addActionListener(this);
    b5.addActionListener(this);
    b6.addActionListener(this);
    b7.addActionListener(this);
    b8.addActionListener(this);
    b9.addActionListener(this);
    bAdd.addActionListener(this);
    bSub.addActionListener(this);
    bMul.addActionListener(this);
    bDiv.addActionListener(this);
    bEqu.addActionListener(this);
    bSqrt.addActionListener(this);
    bSin.addActionListener(this);
    bCos.addActionListener(this);
    bTan.addActionListener(this);
    bCls.addActionListener(this);
  }

  public void actionPerformed(ActionEvent ae) {
    if(ae.getSource() == b0) {
      zero();
      if(tf1.getText().equals("0"))
        tf1.setText(b0.getLabel());
      else
        tf1.setText(tf1.getText()+b0.getLabel());
      temp = 0;
    }
    if(ae.getSource() == b1) {
      zero();
      if(tf1.getText().equals("0"))
        tf1.setText(b1.getLabel());
      else
        tf1.setText(tf1.getText()+b1.getLabel());
      temp = 0;
    }
    if(ae.getSource() == b2) {
      zero();
      if(tf1.getText().equals("0"))
        tf1.setText(b2.getLabel());
      else
        tf1.setText(tf1.getText()+b2.getLabel());
      temp = 0;
    }
    if(ae.getSource() == b3) {
      zero();
      if(tf1.getText().equals("0"))
        tf1.setText(b3.getLabel());
      else
        tf1.setText(tf1.getText()+b3.getLabel());
      temp = 0;
    }
    if(ae.getSource() == b4) {
      zero();
      if(tf1.getText().equals("0"))
        tf1.setText(b4.getLabel());
      else
        tf1.setText(tf1.getText()+b4.getLabel());
      temp = 0;
    }
    if(ae.getSource() == b5) {
      zero();
      if(tf1.getText().equals("0"))
        tf1.setText(b5.getLabel());
      else
        tf1.setText(tf1.getText()+b5.getLabel());
      temp = 0;
    }
    if(ae.getSource() == b6) {
      zero();
      if(tf1.getText().equals("0"))
        tf1.setText(b6.getLabel());
      else
        tf1.setText(tf1.getText()+b6.getLabel());
      temp = 0;
    }
    if(ae.getSource() == b7) {
      zero();
      if(tf1.getText().equals("0"))
        tf1.setText(b7.getLabel());
      else
        tf1.setText(tf1.getText()+b7.getLabel());
      temp = 0;
    }
    if(ae.getSource() == b8) {
      zero();
      if(tf1.getText().equals("0"))
        tf1.setText(b8.getLabel());
      else
        tf1.setText(tf1.getText()+b8.getLabel());
      temp = 0;
    }
    if(ae.getSource() == b9) {
      zero();
      if(tf1.getText().equals("0"))
        tf1.setText(b9.getLabel());
      else
        tf1.setText(tf1.getText()+b9.getLabel());
      temp = 0;
    }
    if(ae.getSource() == bSqrt) {
      sqr = Double.parseDouble(tf1.getText());
      tf1.setText(Double.toString(Math.sqrt(sqr)));
    }
    if(ae.getSource() == bSin) {
      s = Double.parseDouble(tf1.getText());
      tf1.setText(Double.toString(Math.sin(s)));
    }
    if(ae.getSource() == bCos) {
      c = Double.parseDouble(tf1.getText());
      tf1.setText(Double.toString(Math.cos(c)));
    }
    if(ae.getSource() == bTan) {
      ta = Double.parseDouble(tf1.getText());
      tf1.setText(Double.toString(Math.tan(ta)));
    }
    if(ae.getSource() == bAdd) {
      add = Integer.parseInt(tf1.getText());
      tf1.setText("");
      t = "+";
    }
    if(ae.getSource() == bSub) {
      sub = Integer.parseInt(tf1.getText());
      tf1.setText("");
      t = "-";
    }
    if(ae.getSource() == bMul) {
      mul = Integer.parseInt(tf1.getText());
      tf1.setText("");
      t = "*";
    }
    if(ae.getSource() == bDiv) {
      div = Integer.parseInt(tf1.getText());
      tf1.setText("");
      t = "/";
    }
    if(ae.getSource() == bEqu) {
      if(t == "+") {
        int add1 = Integer.parseInt(tf1.getText());
        int add2 = add + add1;
        tf1.setText(String.valueOf(add2));
      }
      else if(t == "-") {
        int sub1 = Integer.parseInt(tf1.getText());
        int sub2 = sub - sub1;
        tf1.setText(String.valueOf(sub2));
      }
      else if(t == "*") {
        int mul1 = Integer.parseInt(tf1.getText());
        int mul2 = mul * mul1;
        tf1.setText(String.valueOf(mul2));
      }
      else if(t == "/") {
        int div1 = Integer.parseInt(tf1.getText());
        int div2 = div / div1;
        tf1.setText(String.valueOf(div2));
      }
      if(temp == 0) temp = 1;
    }
    if(ae.getSource() == bCls)
      tf1.setText("0");
    if(ae.getSource() == bDec) {
      String s = tf1.getText();
      for(int i = 0; i < s.length(); i++) {
        if((s.charAt(i)) == '.') break;
        else tf1.setText(tf1.getText()+bDec.getLabel());
      }
    }
  }

  void zero() {
    if(temp == 1) tf1.setText("0");
  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-16T16:57:48.107

Look at these lines:

```
bAdd = new Button("+"); bSub = new Button("-");
bSub = new Button("*"); bDiv = new Button("/"); 
```

You're assigning a value to `bSub` twice, but not assigning any value to `bMul`, so it's still null.

When you then dereference `bMul` at line 42:

```
bMul.setBounds(100, 280, 50, 50); 
```

... that's throwing a `NullPointerException`. I suspect the start of the second line from above should be:

```
bMul = new Button("*"); 
```

I would *strongly* advise you to stick to one statement per line. I'd also advise you to break your code up into smaller chunks - for example, one method to initialize the digits, another for the operators etc.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T16:59:00.633

您没有创建`bMul`对象。

只需添加这一行`bMul=new Button("*");`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T17:00:04.567

你没有初始化 bMul！！因此，您正在引用一个空对象并抛出异常

# android - Opengl ES 2.0：模型的某些部分在不应该被遮挡的地方被遮挡。z-buffer 是罪魁祸首吗？

> ID：14912753
> 
> 赞同：2
> 
> 时间：2013-02-16T16:56:38.637
> 
> 标签：android, opengl-es-2.0, vbo, glsles

我正在使用 Assimp 使用 OpenGL ES 2.0 渲染 3D 模型。我目前遇到一个奇怪的问题，其中模型的某些部分不可见，即使它们应该可见。在这些图片中很容易看到它：

![纹理模型](../Images/caf0eb8a768fe82cece9be95b9d7634c.png)

在第二张图片中，我将 z-buffer（的线性化版本）渲染到屏幕上，看看它是否可能是 z-buffer 问题。黑色像素靠近相机：

![zbuffer渲染](../Images/8c9f7336afd070717e9c2ec2fb3b4d14.png)

我试图更改 z-near 和 z-far 的值而没有任何效果。现在我在初始化时这样做：

```
glEnable(GL_CULL_FACE);// Cull back facing polygons
glEnable(GL_DEPTH_TEST); 
```

我也在为每一帧都这样做：

```
glClearColor(0.7f, 0.7f, 0.7f, 1.0f);
glClear( GL_DEPTH_BUFFER_BIT | GL_COLOR_BUFFER_BIT); 
```

我认为这可能是面部缠绕问题，所以我尝试禁用 GL_CULL_FACE，但它不起作用。我很确定模型很好，因为 Blender 可以正确渲染它。

我现在正在使用这些着色器：

```
// vertex shader
uniform mat4 u_ModelMatrix; // A constant representing the model matrix.
uniform mat4 u_ViewMatrix; // A constant representing the view matrix.
uniform mat4 u_ProjectionMatrix; // A constant representing the projection matrix.

attribute vec4 a_Position; // Per-vertex position information we will pass in.
attribute vec3 a_Normal; // Per-vertex normal information we will pass in.
attribute vec2 a_TexCoordinate; // Per-vertex texture coordinate information we will pass in.

varying vec3 v_Position; // This will be passed into the fragment shader.
varying vec3 v_Normal; // This will be passed into the fragment shader.
varying vec2 v_TexCoordinate; // This will be passed into the fragment shader.

void main()
{
    // Transform the vertex into eye space.
    mat4 u_ModelViewMatrix = u_ViewMatrix * u_ModelMatrix;
    v_Position = vec3(u_ModelViewMatrix * a_Position);

    // Pass through the texture coordinate.
    v_TexCoordinate = a_TexCoordinate;

    // Transform the normal's orientation into eye space.
    v_Normal = vec3(u_ModelViewMatrix * vec4(a_Normal, 0.0));

    // gl_Position is a special variable used to store the final position.
    // Multiply the vertex by the matrix to get the final point in normalized screen coordinates.
    gl_Position = u_ProjectionMatrix * u_ModelViewMatrix * a_Position;
} 
```

这是片段着色器：

```
// fragment shader
uniform sampler2D u_Texture; // The input texture.
uniform int u_TexCount;

varying vec3 v_Position; // Interpolated position for this fragment.
varying vec3 v_Normal; // Interpolated normal for this fragment.
varying vec2 v_TexCoordinate; // Interpolated texture coordinate per fragment.

// The entry point for our fragment shader.
void main()
{
    vec3 u_LightPos = vec3(1.0);
    // Will be used for attenuation.
    float distance = length(u_LightPos - v_Position);

    // Get a lighting direction vector from the light to the vertex.
    vec3 lightVector = normalize(u_LightPos - v_Position);

    // Calculate the dot product of the light vector and vertex normal. If the normal and light vector are
    // pointing in the same direction then it will get max illumination.
    float diffuse = max(dot(v_Normal, lightVector), 0.0);

    // Add attenuation.
    diffuse = diffuse * (1.0 / distance);

    // Add ambient lighting
    diffuse = diffuse + 0.2;
    diffuse = 1.0;

    //gl_FragColor = (diffuse * texture2D(u_Texture, v_TexCoordinate));// Textured version

    float d = (2.0 * 0.1) / (100.0 + 0.1 - gl_FragCoord.z * (100.0 - 0.1));
    gl_FragColor = vec4(d, d, d, 1.0);// z-buffer render
} 
```

我正在使用带有索引的 VBO 来加载几何图形和东西。

当然，我可以粘贴一些您认为可能相关的其他代码，但现在我很高兴了解可能导致这种奇怪行为的一些想法，或者我可以做的一些可能的测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T21:04:00.883

好的，我解决了这个问题。我发布了解决方案，因为它可能对未来的谷歌人有用。

基本上我没有要求深度缓冲区。我在本机代码中完成所有渲染工作，但所有 Open GL 上下文初始化都是在 Java 端完成的。我使用其中一个 Android 示例 (GL2JNIActivity) 作为起点，但它们没有请求任何深度缓冲区，我也没有注意到这一点。

我在设置 ConfigChooser 时解决了将深度缓冲区大小设置为 24 的问题：

```
setEGLConfigChooser( translucent ?
                         new ConfigChooser(8, 8, 8, 8, 24 /*depth*/, 0) :
                         new ConfigChooser(5, 6, 5, 0, 24 /*depth*/, 0 ); 
```

# mysql - MySQL CREATE TRIGGER and DELIMITER ISSUES

> ID：14912754
> 
> 赞同：1
> 
> 时间：2013-02-16T16:56:41.773
> 
> 标签：mysql, triggers, delimiter

I am trying to make a database that does some inventory checking, and I am working on some triggers to update everything as required. In this case, that I want to do is to take the current availability (disponibilidad) of an ingredient from the ingredients table, add to it how much is taken or added, and then save that value into the table `stock_disponibilidad`, as you can see from the trigger code I am trying to use.

```
DELIMITER $$

CREATE TRIGGER `update_disponibilidad_variacion` BEFORE INSERT ON `stock_disponibilidad`
FOR EACH ROW BEGIN
DECLARE old_disp DOUBLE DEFAULT 0;
SELECT disponibilidad INTO old_disp FROM ingredientes WHERE id = NEW.ingredientes_id;
NEW.disponibilidad = old_disp + NEW.variacion;
END$$

DELIMITER ; 
```

However, whenever I execute the query to create the trigger, I get the following error:

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '.disponibilidad = old_disp + NEW.variacion; END' at line 5 
```

I've done everything I read about this issue, still without result. What am I doing wrong?

# java - Android - 需要活动但不想要活动？

> ID：14912755
> 
> 赞同：0
> 
> 时间：2013-02-16T16:56:45.697
> 
> 标签：java, android, exception, android-activity, text-to-speech

我正在尝试创建一个使用 textToSpeak 的应用程序。显然 textToSpeak 必须在一个活动中使用它才能工作。

但是，我不能在普通的 java 类中使用 textToSpeak，因此我可以在当前运行的活动中实例化它并调用一个方法，使 textToSpeech 说出某些文本。

我已经设法让 TTS 在一个单独的项目中工作，它是正在运行的活动，但是我无法让它在另一个项目中实例化......

Speak 类（包含 TTS，有问题的行是“private TextToSpeech tts = new TextToSpeech(this, this);” - 提供未捕获的异常。

```
import java.util.Locale;

import android.app.Activity;
import android.os.Bundle;
import android.speech.tts.TextToSpeech;
import android.util.Log;

public class Speech extends Activity implements TextToSpeech.OnInitListener {

    private TextToSpeech tts = new TextToSpeech(this, this);
    private String toRead;

    public void speak()
    {
        speakOut();
    }

    public void changeText(String changeTo)
    {
        toRead = changeTo;
    }

    @Override
    public void onDestroy() {
        // Don't forget to shutdown tts!
        if (tts != null) {
            tts.stop();
            tts.shutdown();
        }
        super.onDestroy();
    }

    public void onInit(int status) {

        if (status == TextToSpeech.SUCCESS) {

            int result = tts.setLanguage(Locale.US);

            if (result == TextToSpeech.LANG_MISSING_DATA
                    || result == TextToSpeech.LANG_NOT_SUPPORTED) {
                Log.e("TTS", "This Language is not supported");
            } else {
                speakOut();
            }

        } else {
            Log.e("TTS", "Initilization Failed!");
        }

    }

    private void speakOut() {
        tts.speak(toRead, TextToSpeech.QUEUE_FLUSH, null);
        }
    } 
```

跑步活动（编辑以显示我想如何使用语音课程）

```
public class Text_entry extends Activity implements OnTouchListener{
private Speech speech = new Speech();

public boolean onTouch(View v, MotionEvent event) {
speech.changeText(toRead);
        speech.speak();
}
} 
```

此设置适用于其他对象，但是因为 TTS 需要成为活动的一部分（如果语音不扩展活动，则无法识别）我似乎不起作用。任何人都可以提供解决方案吗？

日志猫

```
02-16 16:52:46.698: D/AndroidRuntime(22541): Shutting down VM
02-16 16:52:46.698: W/dalvikvm(22541): threadid=1: thread exiting with uncaught exception (group=0x415fe300)
02-16 16:52:46.703: E/AndroidRuntime(22541): FATAL EXCEPTION: main
02-16 16:52:46.703: E/AndroidRuntime(22541): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{org.BT/org.BT.Text_entry}: java.lang.NullPointerException
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2024)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2125)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.app.ActivityThread.access$600(ActivityThread.java:140)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1227)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.os.Looper.loop(Looper.java:137)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.app.ActivityThread.main(ActivityThread.java:4898)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at java.lang.reflect.Method.invokeNative(Native Method)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at java.lang.reflect.Method.invoke(Method.java:511)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1006)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:773)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at dalvik.system.NativeStart.main(Native Method)
02-16 16:52:46.703: E/AndroidRuntime(22541): Caused by: java.lang.NullPointerException
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.content.ContextWrapper.getContentResolver(ContextWrapper.java:91)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.speech.tts.TtsEngines.getDefaultEngine(TtsEngines.java:75)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.speech.tts.TextToSpeech.getDefaultEngine(TextToSpeech.java:1235)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.speech.tts.TextToSpeech.initTts(TextToSpeech.java:595)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.speech.tts.TextToSpeech.<init>(TextToSpeech.java:553)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.speech.tts.TextToSpeech.<init>(TextToSpeech.java:527)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.speech.tts.TextToSpeech.<init>(TextToSpeech.java:512)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at org.BT.Speech.<init>(Speech.java:12)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at org.BT.Text_entry.<init>(Text_entry.java:48)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at java.lang.Class.newInstanceImpl(Native Method)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at java.lang.Class.newInstance(Class.java:1319)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.app.Instrumentation.newActivity(Instrumentation.java:1057)
02-16 16:52:46.703: E/AndroidRuntime(22541):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2015)
02-16 16:52:46.703: E/AndroidRuntime(22541):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:13:05.677

不要延长`Activity`。将 a 传递`Context`给构造函数：

```
public class Speech implements TextToSpeech.OnInitListener {
    private Context mContext;
    private TextToSpeech tts;

    public Speech(Context c) {
        mContext = c;
        tts = new TextToSpeech(c, this);
    }

    // Rest of class
} 
```

然后像这样构造它：

```
public class Text_entry extends Activity implements OnTouchListener{
    private Speech speech;

    public void onCreate(Bundled saved) {
        super.onCreate(saved);
        speech = new Speech(this);
    }
    public boolean onTouch(View v, MotionEvent event) {
        speech.changeText(toRead);
        speech.speak();
    }
} 
```

# android - Android，可以将呼叫流转换为文本吗？

> ID：14912759
> 
> 赞同：0
> 
> 时间：2013-02-16T16:57:22.047
> 
> 标签：android, speech-recognition, speech-to-text

我有一个简单的应用程序，无论对方在说什么，它都需要呼叫一个号码和语音到文本（尽可能）。

简单来说，如果对方说“你好”，那么屏幕上就会显示“你好”。

我可以使用以下方式拨打电话`Intent.ACTION_CALL`：

```
Intent callIntent = new Intent(Intent.ACTION_CALL);
callIntent.setData(Uri.parse("tel:91234567"));
startActivity(callIntent); 
```

但是，我如何从那里继续，将接收到的音频信号转换为文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T17:02:24.453

在 Android 中，您无法访问或修改通话音频流。因此，您无法听到正在说的内容，因此无法将其转换为文本。

这个应用程序在 Android 上是不可能的。

# php - 在 Magento 产品网格中显示“免费送货”按钮

> ID：14912765
> 
> 赞同：0
> 
> 时间：2013-02-16T16:57:38.070
> 
> 标签：php, html, magento

我想在产品网格中为启用了免费送货的产品制作一个按钮，例如这种方法：[http ://www.immense.net/magento-free-shipping-certain-products/](http://www.immense.net/magento-free-shipping-certain-products/)

为了清楚起见：我想在产品网格中的“添加到购物车”按钮上方有一个按钮，用于启用免费送货的产品。我已经完成了 URL 中的步骤并尝试将代码放入产品网格中，但这不起作用。

你知道我该怎么做吗？

谢谢！

编辑 2：Fabian 和其他人，

现在很好用，谢谢！但我也想当产品价格高于 65 时，也显示“免费送货”消息。或者产品必须具有免费送货属性为是，或者产品必须是 65 欧元或以上才能显示“免费送货”文字。

我像这样编辑了代码，但只有“免费送货”为“是”的产品才能很好地显示出来。65以上的产品不行。你能看出我做错了什么吗？

谢谢！

```
<?php
 // Determine if product "free shipping" is true
if ($_product->getGratisVerzending())
{
echo '<span class="freeShip">'.$_product->getAttributeText('gratis_verzending').'</span>';
}

 // Determine if product costs more than 65
else if ($_product->getPrice() > 65)
{
echo '<span class="freeShip">'.$_product->getAttributeText('gratis_verzending').'</span>';
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T18:30:07.423

1.  重新索引。

2.  您应该检查 attribute_code 是否为：free_shipping_discount

3.  并且“用于产品列表”属性选项是否为 YES

4.  然后检查您是否拼写正确`getFreeShippingDiscount`，如果这不起作用，请检查信息是否是他们的。

    ```
    <?php Mage::log($_product->getData()); ?> 
    ```

    这是一个数组，将被记录（启用记录！）。检查是否列出了该属性。如果不是，则该属性未与集合一起加载，通常是因为 2。

# javascript - Javascript，-100% 的视口不是像素

> ID：14912769
> 
> 赞同：1
> 
> 时间：2013-02-16T16:58:16.280
> 
> 标签：javascript, html, css

我的问题很简单，但我似乎无法弄清楚！我的 javascript 不应该扣除 100 像素，我想要 100% 的视口！

```
smoothScrollTo(document.getElementById('bottom').offsetTop - 100) 
```

应该看起来像：

```
smoothScrollTo(document.getElementById('bottom').offsetTop - '100%') 
```

但由于某种原因，这不起作用。

答案必须是 Javascript（不能使用 jQuery）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:01:53.817

那这个呢？

```
var viewportHeight = window.innerHeight || document.documentElement.clientHeight;
smoothScrollTo(document.getElementById('bottom').offsetTop - viewportHeight ) 
```

# erlang - 简单的rabbitmq erlang消息直接队列获取器的奇怪问题

> ID：14912770
> 
> 赞同：2
> 
> 时间：2013-02-16T16:58:26.390
> 
> 标签：erlang, rabbitmq

带有用户 guest/guest 的基本 RabbitMQ 安装。

给定以下 RabbitMQ（erlang 客户端）的简单 erlang 测试代码，我收到以下错误。队列 TEST_DIRECT_QUEUE 存在，其中有 7 条消息，并且 RabbitMQ 服务器已启动并运行。

如果我尝试使用 declare API 命令创建一个新的，我**也会**收到类似的错误。 **总体而言，在任何 << channel:call >> 命令期间都会出现错误**

有什么想法吗 ？谢谢。

=错误报告==== 2013 年 2 月 16 日::10:39:42 ===

连接（<0.38.0>）关闭：通道内部错误（<0.50.0>）：关闭

```
** exception exit: {shutdown,{gen_server,call,
                                     [<0.50.0>,
                                      {call,{'queue.declare',0,"TEST_DIRECT_QUEUE",false,false,
                                                             false,false,false,[]},
                                            none,<0.31.0>},
                                      infinity]}}
 in function  gen_server:call/3 (gen_server.erl, line 188)
 in call from test:test_message/0 (test.erl, line 12) 
```

===============================================

```
-module(test).
-export([test_message/0]).
-include_lib("amqp_client/include/amqp_client.hrl").
-record(state, {channel}).

test_message() ->

    {ok, Connection} = amqp_connection:start(#amqp_params_network{}),
    {ok, Channel} = amqp_connection:open_channel(Connection),
    Get = #'basic.get'{queue = "TEST_DIRECT_QUEUE"},
    {#'basic.get_ok'{}, Content} = amqp_channel:call(Channel, Get),   <=== error here
    #'basic.get_empty'{} = amqp_channel:call(Channel, Get),
    amqp_channel:call(Channel, #'channel.close'{}). 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T11:32:46.450

经过几个令人沮丧的时间后，我自己发现了这个问题。总的来说，让我承认对关于 RabbitMQ 的模糊教程和文档感到不安......无论如何，这就是问题所在：

1) 队列名称应该是二进制形式，因此以“<<”开头并由“>>”取代。例如：<<"我的队列名称">>（也包括引号）

2）在我尝试使用**queue.declare**创建队列的不同场景中，队列已经存在的事实不是问题，但是队列是持久的并且**queue.declare**没有指定该组的事实参数导致程序抛出错误并中断执行。这是一种不幸的行为，通常开发人员希望队列匹配仅通过名称完成，然后继续。所以要解决这个问题，我必须指定**持久**值。

这是一个简单的工作代码：

```
-module(test).
-export([test/0]).
-include_lib("amqp_client/include/amqp_client.hrl").

test() ->
{ok, Connection} = amqp_connection:start(#amqp_params_network{}),
{ok, Channel} = amqp_connection:open_channel(Connection),
Declare = #'queue.declare'{queue = <<"TEST_DIRECT_QUEUE">>, durable = true},
#'queue.declare_ok'{} = amqp_channel:call(Channel, Declare),
Get = #'basic.get'{queue = <<"TEST_DIRECT_QUEUE">>, no_ack = true},
{#'basic.get_ok'{}, Content} = amqp_channel:call(Channel, Get),
#amqp_msg{payload = Payload} = Content. 
```

# python - 在命令行参数中解析 \ - python 2.7.3

> ID：14912771
> 
> 赞同：5
> 
> 时间：2013-02-16T16:58:27.333
> 
> 标签：python, bash, parsing, command-line-arguments

我正在`parse_input.py`从 bash调用 python 脚本

`parse_input.py`接受一个包含许多`'\n'`字符的命令行参数。

示例输入：

`$ python parse_input.py "1\n2\n"`

```
import sys
import pdb

if __name__ == "__main__":

    assert(len(sys.argv) == 2)

    data =  sys.argv[1]
    pdb.set_trace()
    print data 
```

我可以在 pdb 上看到，``data = "1\\n2\\n"`而我想要`data="1\n2\n"`

我看到了类似的行为，只是`\` （没有`\n`）被替换为`\\`

如何删除多余的`\`？

我不希望脚本处理额外的内容`\`，因为也可以从文件中接收相同的输入。

**bash 版本**：GNU bash，版本 4.2.24(1)-release (i686-pc-linux-gnu)

**蟒蛇版本**：2.7.3

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-16T16:59:40.603

Bash 不会`\n`像 python 那样解释它，它会将其视为两个字符。

您*可以*通过从以下位置“解码”将文字`\n`（所以两个字符）解释为 python 中的换行符`string_escape`：

```
data = data.decode('string_escape') 
```

示范：

```
>>> literal_backslash_n = '\\n'
>>> len(literal_backslash_n)
2
>>> literal_backslash_n.decode('string_escape')
'\n'
>>> len(literal_backslash_n.decode('string_escape'))
1 
```

请注意，其他[python 字符串转义序列](http://docs.python.org/2/reference/lexical_analysis.html#index-15)*也*将被解释。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-16T17:02:04.753

Bash 不会解释常规单引号和双引号字符串中的转义字符。要让它解释（某些）转义字符，您可以使用`$'...'`：

```
 Words of the form $'string' are treated specially.  The word expands to
   string, with backslash-escaped characters replaced as specified by  the
   ANSI  C  standard.  Backslash escape sequences, if present, are decoded
   as follows:
          \a     alert (bell)
          \b     backspace
          \e     an escape character
          \f     form feed
          \n     new line
          \r     carriage return
          \t     horizontal tab
          \v     vertical tab
          \\     backslash
          \'     single quote
          \nnn   the eight-bit character whose value is  the  octal  value
                 nnn (one to three digits)
          \xHH   the  eight-bit  character  whose value is the hexadecimal
                 value HH (one or two hex digits)
          \cx    a control-x character

   The expanded result is single-quoted, as if the  dollar  sign  had  not
   been present. 
```

IE

```
$ python parse_input.py $'1\n2\n' 
```

# postgresql - 带有连接和限制的 postgresql 查询

> ID：14912773
> 
> 赞同：0
> 
> 时间：2013-02-16T16:58:37.463
> 
> 标签：postgresql

我有一张桌子礼物。Gift's 可以通过表关联拥有许多 gift_images。我正在尝试退回具有特定隐私级别的有限 # 件礼物，这些礼物至少有一个 gift_images 关联。

本质上，我想返回：gift 条目及其 FIRST 关联的 gift_image（gift_image 应按其具有的位置值排序，位置 1 为 FIRST）。没有关联 gift_image 的礼物应该被忽略。

这就是我所拥有的，但它绝对不起作用。

```
SELECT gifts.* FROM gifts LEFT JOIN gift_images ON gifts.id = gift_images.gift_id WHERE gifts.privacy = 2 ORDER BY gift_images.position ASC LIMIT 10 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:12:48.827

如果你想忽略没有图片的礼物，你应该使用 an`INNER JOIN`而不是`LEFT JOIN`. 此外，为了使查询有意义，除了来自gift 的字段之外，您还应该从gift_images 中选择一些字段。

如果所有具有礼物图像的礼物都有一个位置 = 1 的图像，则此查询应执行以下操作：

```
SELECT gifts.*, gift_images.*
FROM gifts
INNER JOIN gift_images
ON gifts.id = gift_images.gift_id
WHERE gifts.privacy = 2
AND gift_images.position = 1
LIMIT 10 
```

否则，您可以尝试

```
SELECT gifts.*, gift_images.*
FROM gifts
INNER JOIN (SELECT gift_id, MIN(position) AS min_position
            FROM gift_images
            GROUP BY gift_id) AS positions
ON positions.gift_id = gifts.id
INNER JOIN gift_images
ON gift_images.gift_id = gifts.id
AND gift_images.position = positions.min_position 
```

# c# - 处理事件。从本地 var 提升

> ID：14912775
> 
> 赞同：1
> 
> 时间：2013-02-16T16:58:49.190
> 
> 标签：c#, .net, events

在关于c#的书中关于事件的章节中有代码示例：

```
class CountDown
{
    private uint _seconds;
    public CountDown(uint seconds)
    {
        _seconds = seconds;
    }
    public void Start()
    {
        new Thread(() =>
        {
            uint n = _seconds;
            while (n > 0u)
            {
                var tick = Tick;              ///??????
                if (tick != null)
                    tick(n);

                Thread.Sleep(1000);
                n--;
            }
            var finished = Finished;          ///??????
            if (finished != null)
                finished();
        }).Start();
    }
}
    public event Action<uint> Tick;
    public event Action Finished; 
```

创建事件的本地副本（勾选和完成）并通过它引发事件的原因是什么？这是常见的做法并且有一定的意义吗？我试过，但无法从书中得到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T17:00:48.680

> 创建事件的本地副本（勾选和完成）并通过它引发事件的原因是什么？

它避免了在无效检查*之后*但*在*调用之前`Tick`变为 null的可能性。如果你有：

 **```
if (Tick != null)
{
    Tick(n);
} 
```

...当你已经进入“if”正文时，最后一个听众被取消订阅，你会得到一个`NullReferenceException`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T17:02:10.713

这是因为，在您对事件进行空检查和调用它之间，可能会取消订阅某些内容，从而使事件发生`null`，这将引发 (可能未处理) `NullReferenceException`，这至少会让用户感到烦恼。**

# html - 使用

> ID：14912778
> 
> 赞同：12
> 
> 时间：2013-02-16T16:59:12.763
> 
> 标签：html, seo

如何在 HTML5 中正确标记网站的标题？通常我用以下方式标记网站的名称：

```
<h1>
    <a href=#>Website Name</a>
</h1> 
```

最近我遇到了 HTML5 文档大纲算法。我还读到在 h1 标签中标记您的网站名称似乎没有意义，因为除了网站名称之外，每个页面可能会有不同的主标题 (h1)。

如果让我们在 Facebook 上说，如果 Facebook 的徽标/标题的标记包含在`<h1>`标签中。然后，如果每个帖子都包含在`<article>`标签中。例如：

```
<article class="post">
    <h5 class="post-header">
         <a href="#">Someone has shared Blah Blah's photo</a>
    </h5>
     <div class="post-body">...</div>
</article> 
```

我认为文件大纲是

1.  Facebook

    1.1 有人分享了 Blah Blah 的照片

    1.2 其他帖子

    1.3 其他帖子

可以吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-17T10:39:12.367

尤其是*因为*轮廓，使用`h1`.

如果您的网页是网站的一部分，则每个页面都应该有一个网站标题`h1`，其中包含网站标题、网站徽标或两者兼有。重要的是，此站点标题*不是*分段元素 ( `section`/ `article`/ `aside`/ `nav`) 的子元素。

因此，页面的顶级标题将始终是站点标题。并且站点导航、页面的主要内容、带有次要内容的侧边栏等都将是该顶级标题的“子项”。

因此，博客文章页面的简单结构可能是：

```
<body>
  <h1><img src="logo.png" alt="John's blog"></h1>

  <nav><!-- the site-wide navigation --></nav> 

  <article>
    <h1>My first blog post</h1>
    <p>…&lt;/p>
    <footer><!-- this footer applies to the article only--></footer>
  </article>

  <footer><!-- this footer applies to the whole page (→ the site)--></footer>

</body> 
```

这将创建一个大纲，如：

```
1 John's blog (→ body>h1)
  1.1 untitled (→ body>nav)
  1.2 My first blog post (→ body>article>h1) 
```

如果您不使用网站标题/徽标 in `h1`，则该页面将有一个无标题的顶级大纲条目：

```
1 untitled (→ body)
  1.1 untitled (→ body>nav)
  1.2 My first blog post (→ body>article>h1) 
```

如果您不使用 a`h1`作为网站标题/徽标*，并且*没有为您的主要内容使用分段元素……</p>

```
<body>
  <img src="logo.png" alt="John's blog"> <!-- omitted h1 -->

  <nav><!-- the site-wide navigation --></nav> 

  <!-- omitted article -->
  <h1>My first blog post</h1>
  <p>…&lt;/p>

</body> 
```

......你会得到一个包含两个顶级条目的大纲：

```
1 untitled (→ body)
  1.1 untitled (→ body>nav)
2 My first blog post (→ body>h1) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-16T17:25:24.097

我会把它放在一个[`header`](http://www.w3.org/html/wg/drafts/html/master/sections.html#the-header-element)元素中：

> 标题元素通常旨在包含节的标题（h1–h6 元素或 hgroup 元素），但这不是必需的。header 元素还可用于包装部分的目录、搜索表单或任何相关徽标。

像这样：

```
<header>
  <a href="/"><img src="..." alt="Foo Company Home"></a>
</header> 
```

# ruby-on-rails - 从异常返回消息中删除“验证失败”消息

> ID：14912785
> 
> 赞同：5
> 
> 时间：2013-02-16T16:59:54.257
> 
> 标签：ruby-on-rails, ruby-on-rails-3, validation, rails-activerecord

我有一个 ActiveRecord 模型帐户：

```
class Account < ActiveRecord::Base

  attr_accessible :msisdn

  validates_uniqueness_of :msisdn, :on => :create, 
    :message => "User Already Registered ."
end 
```

我有一个控制器尝试创建一个帐户：

```
begin
  account = Account.create!(:msisdn => user)   
rescue Exception => e
  $LOG.error "Account #{user} : --> #{e.message}"  
end 
```

现在 e.message 总是返回 : **Validation failed: Msisdn User Already Registered**，我怎么能像**User Already Registered**这样单独获取消息。请注意，我根本没有使用视图，我想从控制器中使用它，并且我使用的是 Rails 3。

提前致谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2017-06-01T23:46:23.347

在“config/locale/en.yml”中添加两件事：

```
en:
  activerecord:
    errors:
      messages:
        record_invalid: "%{errors}"
  errors:
    format: "%{message}" 
```

（或您碰巧支持的任何语言的相应翻译文件）。

*注意：这是在 rails 5 中测试的，但是快速浏览 rails 3 文档让我认为它也可以在那里工作。*

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-16T18:01:44.367

什么时候有效？在任何模型上调用（从 create/save/update_attributes 发生）它会在模型​​上填充错误对象。~~当然，如果您使用 bang 方法（创建！），那么分配将永远不会发生，因此请改用非 bang 方法。~~请参阅第三个代码片段。

```
account = Account.new(:msisdn => user)
unless account.save #
  # account.errors will be populated with errors
  puts account.errors[:msisdn] # => ['User Already Registered']
end 
```

使用 bang 方法的替代方法

```
account = Account.new(:msisdn => user)
begin
  account.save!
rescue Exception
  puts account.errors[:msisdn]
end 
```

编辑：

查看 rails api 文档后的另一种选择是从异常中获取记录，因为它存储了一个副本。这使我原来的陈述是错误的。

[ActiveRecord::RecordInvalid](http://api.rubyonrails.org/classes/ActiveRecord/RecordInvalid.html) ( [github](https://github.com/rails/rails/blob/0034b7822d6132f5945b0514a5391d18e52aa4b6/activerecord/lib/active_record/validations.rb#L12-L19) )

```
begin
  account = Account.create!(:msisdn => user)
rescue ActiveRecord::RecordInvalid => e
  puts e.record.errors[:msisdn] # => ['User Already Registered']
end 
```

# flask - Flask 运行 Web 应用程序中的 Sphinx 文档

> ID：14912787
> 
> 赞同：21
> 
> 时间：2013-02-16T17:00:03.433
> 
> 标签：flask, python-sphinx

我在本地构建了静态 Sphinx 文档（使用`make html`）。

我现在希望将 Sphinx 文件集成到我的使用 Flask 运行的 web 应用程序中。从 Flask 运行的应用程序中，我只是想包含一个指向 Sphinx 文档的超链接，它将作为应用程序的帮助。

[Websupport](http://sphinx-doc.org/web/quickstart.html)似乎是要遵循的方式，但我不清楚我应该如何将 Flask 框架连接到 Sphinx 文件。

谢谢你的帮助，

问候

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2018-08-05T02:26:25.513

其他解决方案很好地省略了`Flask`对象初始化，这导致我把头撞到墙上一段时间。

根本不涉及 Sphinx 项目结构，这是对我有用的解决方案：

```
from flask import Flask

app = Flask(__name__, static_url_path='/', static_folder='_build/html/')

@app.route('/')
@app.route('/<path:path>')
def serve_sphinx_docs(path='index.html'):
    return app.send_static_file(path)

if __name__ == '__main__':
    app.run(debug=True) 
```

下面是项目的文件结构，其中`<doc>`代表了我实际为文档编写的第一个文件，并且`app.py`是包含上述 Flask 应用程序代码的文件。

```
.
├── Makefile
├── _build
│   ├── doctrees
│   │   ├── index.doctree
│   │   ├── <doc>.doctree
│   │   ├── ...
│   │   └── <doc>.doctree
│   └── html
│       ├── _images
│       ├── _modules
│       │   ├── index.html
│       │   └── <package name>
│       │       └── ...
│       ├── _sources
│       │   ├── <doc>.rst.txt
│       │   ├── ...
│       │   └── <doc>.rst.txt
│       ├── _static
│       │   ├── ajax-loader.gif
│       │   ├── alabaster.css
│       │   └── ...
│       ├── genindex.html
│       ├── index.html
│       ├── objects.inv
│       ├── py-modindex.html
│       ├── search.html
│       ├── searchindex.js
│       ├── <doc>.html
│       ├── ...
│       └── <doc>.html
├── _static
│   ├── custom.css
│   └── <myimage>.gif
├── _templates
├── app.py
├── conf.py
├── index.rst
├── make.bat
├── <doc>.rst
├── ...
└── <doc>.rst 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-17T02:18:14.813

你可以用你的网络服务器来处理它，就像你`/static`在 Flask 中处理目录一样。例如，如果您使用 Apache 作为您的生产 Web 服务器，您可以添加

```
Alias /documentation /location/of/sphinx/html
<Directory /location/of/sphinx/html>
    Order deny,allow
    Allow from all
</Directory> 
```

到您的 Apache 站点配置，因此您可以直接链接`http://yoursite.com/documentation`到访问 Sphinx 文件，完全避免使用 Flask。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-27T19:18:41.573

您可以将`_build/html`文档中的`doc`文件夹复制到烧瓶`static`目录中的文件夹中，并使用以下规则为它们提供服务：

```
@app.route('/doc/<dir>/<filename>', defaults={'static': True})
def doc(dir='',filename='index.html'):
    path = join(dir,filename)
    return app.send_static_file(path) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-02-09T01:32:42.487

在某些情况下，您不想向所有用户公开您的文档，因此在 Apache 或 Nginx 级别进行配置不是一种选择。以下对我有用：

```
@app.route('/docs', defaults = {'filename': 'index.html'})
@app.route('/docs/<path:filename>')
@login_required
def web_docs(filename):
    path = os.path.join('docs/html', filename)
    return app.send_static_file(path) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-18T15:15:55.873

`BUILDDIR`在 sphinx Makefile 中设置路径

```
BUILDDIR      = app/static/docs 
```

添加烧瓶路线

```
@app.get('/docs/')
@app.get('/docs/<path:filename>')
def get_docs(filename='index.html'):
    path = os.path.join('docs/html', filename)
    return app.send_static_file(path) 
```

构建 sphinx 文档。

```
$ make html 
```

您可以浏览[http://127.0.0.1:5000/docs](http://127.0.0.1:5000/docs)以获取 sphinx 文档页面。所有 sphinx docs 静态文件都将在此路由下提供。如果需要，您还可以将 Flask 身份验证添加到路由。

测试版本：

*   烧瓶：2.0.2
*   狮身人面像：4.3.1

# jquery - 将输入的数据和会话 ID 插入数据库

> ID：14912789
> 
> 赞同：0
> 
> 时间：2013-02-16T17:00:18.217
> 
> 标签：jquery, mysql, session, php

我似乎在这个问题上遇到了很多麻烦，所以如果有人可以帮助我，我会非常感激。

我现在正在学习编程（请记住早期阶段），我正在自己制作这个迷你应用程序来教我不同的东西。我有一个 HTML 文件，它创建一个表单，以便用户可以在数据库中添加交易名称和交易描述

输入到表单中 2 个文本框的文本将被捕获，并将通过 javascript 函数创建一个 JSON 对象

然后将 Javascript 函数读取到创建的 PHP 文件中，该文件将获取 JSON 对象并将给定值写入数据库，如下所示：

```
<?php

$var1 = $_REQUEST['action']; // We dont need action for this tutorial, but in a complex code you need a way to determine ajax action nature
$jsonObject = json_decode($_REQUEST['outputJSON']); // Decode JSON object into readable PHP object

$name = $jsonObject->{'name'}; // Get name from object
$desc = $jsonObject->{'desc'}; // Get desc from object

mysql_connect("localhost","root","");  // Conect to mysql, first parameter is location, second is mysql username and a third one is a mysql password
@mysql_select_db("findadeal") or die( "Unable to select database"); // Connect to database called test

$query = "INSERT INTO deal (dname, description, restaurantid) VALUES ('$name' ,'$desc' '$username') WHERE $username=(Select restaurantid FROM restaurant where username = '$username')";
$result=mysql_query($query);
$num = mysql_numrows($result);

if($num != 0) {

    echo "true";

} else {

    echo "false"; 

}
?> 
```

这就是我的问题所在。您可以在其中添加交易的这个 HTML 文件是我正在创建的更大项目的一部分。用户已经登录并且已经创建了一个会话 - 我知道这可以作为我插入到我的 HTML 文件顶部的迷你 php 语句回显“它可以工作”，这意味着用户已登录并且详细信息仍然存在在数组中：

```
<?php
if( !isset( $_SESSION ) ){
 session_start();
echo "Whats Happening";
    }

if( isset( $_SESSION['username'] ) ){
  /* User is logged in */
  echo "IT WORKS!";
    } ?> 
```

我不能做并且需要帮助的是：

当交易数据被插入数据库时​​，它们被插入的字段包括：

1.  dealid 是自动实现的，所以我不需要对此做任何事情
2.  dname 是用户将信息插入表单的交易名称
3.  用户再次将信息插入表单的描述
4.  restaurantid 是登录用户的 id

我不知道如何从会话变量中获取 restaurantid 并包含在 MYSQL 语句中。

我知道下面 PHP 文件中的 SQL 语句是错误的，但我只是想自己拼凑起来，看看是否可以为问题创建某种逻辑。

简而言之，我想做的是获取存储在会话变量中的用户名，然后在我去的地方创建一个 sql 语句：

*   将名称、描述和 restaurantid 插入到交易表中，其中 restaurantid 来自餐厅表，可以通过从会话变量中查找哪个用户名与餐厅表中的用户名相同来获得。

从那以后，我就可以将交易提交到插入，因为我会从另一张桌子上获得餐厅 ID！

我希望这是有道理的，我已经做了很多年了，但无济于事！如果向我展示了这一点，我将能够进入许多其他领域，例如修改和删除等，这只是我需要首先弄清楚会话部分。非常感谢您的帮助！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:29:42.490

无需使用真实代码，只需尝试了解您：

```
$db = new PDO("mysql:host=".DBHOST.";dbname=".DBNAME, DBUSER, DBPASS);

$sql = 'Select restaurantid FROM restaurant where username=:username';
$statement = $db->prepare($sql);
$statement->bindParam(':username', $_SESSION['username'], PDO::PARAM_STR);
$statement->execute();
$result = $statement->fetch(PDO::FETCH_ASSOC);
if(!empty($result)) {
    // here is your restaurant id, you can use for the insert statement...
    $rID = $result['restaurantid'];
} 
```

# c# - CV.在emgu上调用

> ID：14912790
> 
> 赞同：1
> 
> 时间：2013-02-16T17:00:28.823
> 
> 标签：c#, opencv, emgucv

当我尝试阅读简单图像时，我不断收到 cv.invoke。我的应用程序没有比这更多的代码（emgu-opencv 明智）。我检查了调用堆栈，它说`Thrown: "Unable to load DLL 'opencv_core249': The specified module could not be found.`

问题是我尝试`(opencv_core249 and opencv_imgproc249)`在解决方案中添加两个 .dll 作为资源（始终在属性中复制）并且仍然得到异常还尝试将它们的属性更改为内容，但仍然没有。

还尝试将它们手动复制到调试文件夹中，但我仍然得到相同的异常。我已经遵循了在[这个问题](https://stackoverflow.com/questions/14426942/the-type-initializer-for-emgu-cv-cvinvoke-threw-an-exception-for-win8-64bit-v/14662701#14662701)上指出的指导方针，但我仍然得到同样的错误

如果有任何帮助，我正在使用 Visual Studio 2012 和 Windows 8

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-10T14:45:16.937

根据您的解决方案的平台设置....

如果您在“x64”xor“x86”上构建解决方案，则必须将这些 dll 复制到调试文件夹中

..但是如果您正在构建“Any Cpu”，则需要在调试文件夹中创建“x86”和“x64”文件夹。在它们里面有你需要的相关库。原因，您的解决方案将要求两者，具体取决于 cpu ...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T15:49:01.433

我认为您的问题的解决方案也可以像这个线程中指出的那样解决：

['Emgu.CV.CvInvoke' 的类型初始化程序引发了 Win8 64 位 VS2012 的异常](https://stackoverflow.com/questions/14426942/the-type-initializer-for-emgu-cv-cvinvoke-threw-an-exception-for-win8-64bit-v/14662701#14662701)

那里有一个指向 emgucv 论坛的链接。

此外，检查您是否为您尝试构建的项目使用了正确的平台目标（例如，x86 和 64 位）是值得的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-31T07:35:22.277

确保您的目标平台（x64 或 x86）已在配置选项下设置，并确保所有 opencv 库与您的执行目录位于同一目录中。

如果这不起作用，请尝试运行任何 emgu 示例，它们有效吗？

# c# - 如何将 Web 内容表单数据传递给 UserControl 中的 PlaceHolder

> ID：14912792
> 
> 赞同：1
> 
> 时间：2013-02-16T17:00:44.627
> 
> 标签：c#, user-controls, master-pages

第一次在 StackOverflow 上，很高兴来到这里，希望能和大家一起度过愉快的时光，并尽我所能提供帮助。

好吧，我要问的问题就是我在标题中提出的问题，问题是我正在使用带有四个用户控件的母版页来填充母版页，女巫工作正常，但是在其中一个用户控件中（Principal. ascx）我已经放置了一个带有女巫的 PlaceHolder 我希望根据正在加载的页面更改其中的数据，例如，如果我希望加载 Register Employee 页面，我会将其发送到占位符并显示它，或者如果我希望加载登录页面，我会将其发送到占位符并显示它。所以我正在处理的代码是：

母版页：

```
<%@ Register Src="~/UserControl/Head.ascx" TagName="Head" TagPrefix="hdr" %>
<%@ Register Src="~/UserControl/Foot.ascx" TagName="Foot" TagPrefix="ftr" %>
<%@ Register Src="~/UserControl/Menu.ascx" TagName="Menu" Tagprefix="mnu" %>
<%@ Register Src="~/UserControl/Principal.ascx" TagName="Principal" Tagprefix="prn" %>

<link rel="Stylesheet" type="text/css" href="~/Css/Styles.css" />
<asp:ContentPlaceHolder ID="head" runat="server"></asp:ContentPlaceHolder>
 </head>
<body>
   <form runat="server" id="MainForm">
      <div class="Container">
        <hdr:Head runat="server" ID="hdrHead" />
        <mnu:Menu runat="server" ID="menMenu" />
        <prn:Principal runat="server" ID="priPincipal" />
        <ftr:Foot runat="server" ID="ftrFoot" />
      </div>
   </form>
</body>
</html> 
```

母版页上还没有代码。

在 Menu UserControl 上是一个使用 JQuery UI 管理的简单菜单，在我能够使登录页面与 UserControl 一起使用后，我将尝试使此菜单动态化，并且仅显示与访问的用户相关的菜单级别页：

```
<link rel="Stylesheet" type="text/css" href="../Css/jquery-ui-1.10.0.css" />
<script src="../Js/jquery-1.9.1.js" type="text/javascript"></script>
<script src="../Js/jquery-ui-1.10.0.js" type="text/javascript"></script>

<script type="text/javascript">
$(function(){
$("#menu").menu();
});            
</script>

<div class="MenuContainer">
   <span style="margin: 20px 10px; padding: 5px;">
       Bienvenido, Usuario.
   </span>
<div class="Menu">
    <ul id="menu">
    <li><a href="#">Inicio</a></li>
    <li><a href="#">Base de Conocimientos</a>
        <ul>
            <li><a href="#">Vista general</a></li>
            <li><a href="#">Agregar</a></li>
        </ul>
    </li>
    <li><a href="#">Documentaci&oacute;n HGI</a>
        <ul>
            <li><a href="#">Documentos</a></li>
            <li><a href="#">Agregar</a></li>
        </ul>
    </li>
    <li><a href="#">Beneficios</a>
        <ul>
            <li><a href="#">Medio d&iacute;a libre</a></li>
            <li><a href="#">Vacaciones</a></li>
        </ul>
    </li>
    <li><a href="#">Mantenimiento</a>
        <ul>
        <li><a href="#">C&oacute;digos</a>
        <ul>
        <li><a href="#">Vista General</a></li>
        <li><a href="#">Agregar</a></li>
        </ul>
        </li>  
        <li><a href="#">Configuraciones</a>
        <ul>
        <li><a href="#">Vista General</a></li>
        <li><a href="#">Agregar</a></li>
        </ul>
        </li>    
        </ul>   
    </li>                            
    <li><a href="#">Salir</a></li>   
    </ul>
    </div>
</div> 
```

我要加载内容的 UserControl 称为 Principal.ascx：

```
<div class="Contenido">
    <asp:PlaceHolder runat="server" ID="PlaceHolder">

    </asp:PlaceHolder>
</div> 
```

我希望在占位符中显示一个测试文本，该文本已从页面 default.aspx 中删除：

```
<span>
    This is the test.
<span/> 
```

UserControls 或 MasterPage 在 .cs 页面上都没有任何类型的代码。

# c# - 如何将列表转换为字符串并返回

> ID：14912795
> 
> 赞同：2
> 
> 时间：2013-02-16T17:00:47.630
> 
> 标签：c#, .net, linq, list

我从数据库中检索了一个用户列表，比如

```
List<User> users = <..list of users from db...> 
```

**Name, LastName, DateOfBirth //多维数组？？**

现在我想将此列表存储为字符串，并且我希望能够重用它，即

```
string strUsers = users.ToArray().ToString(); 
```

如何从 strUsers 重新创建用户列表？

是否可以？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-16T17:03:32.573

使用[string.Join](http://msdn.microsoft.com/en-us/library/57a79xd0.aspx)方法，例如

```
var joined = string.Join(",", users.Select(u => u.Name)); 
```

这将为您提供一个由“，”分隔的用户名字符串。

或者对于多列：

```
var joined = string.Join(",", 
                 users.Select(u => u.FirstName + " " + u.LastName )); 
```

您可以使用[string.Split](http://msdn.microsoft.com/en-us/library/b873y76a.aspx)反转该过程，例如

```
var split = joined.Split( new [] {','} ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-16T17:34:55.573

如果您有很多用户和很多列，最好编写自己的自定义转换器类。

```
public static class UsersConverter
{
    // Separates user properties.
    private const char UserDataSeparator = ',';

    // Separates users in the list.
    private const char UsersSeparator = ';';

    public static string ConvertListToString(IEnumerable<User> usersList)
    {
        var stringBuilder = new StringBuilder();

        // Build the users string.
        foreach (User user in usersList)
        {
            stringBuilder.Append(user.Name);
            stringBuilder.Append(UserDataSeparator);
            stringBuilder.Append(user.Age);
            stringBuilder.Append(UsersSeparator);
        }

        // Remove trailing separator.
        stringBuilder.Remove(stringBuilder.Length - 1, 1);

        return stringBuilder.ToString();
    }

    public static List<User> ParseStringToList(string usersString)
    {
        // Check that passed argument is not null.
        if (usersString == null) throw new ArgumentNullException("usersString");

        var result = new List<User>();

        string[] userDatas = usersString.Split(UsersSeparator);

        foreach (string[] userData in userDatas.Select(x => x.Split(UserDataSeparator)))
        {
            // Check that user data contains enough arguments.
            if (userData.Length < 2) throw new ArgumentException("Users string contains invalid data.");

            string name = userData[0];
            int age;

            // Try parsing age.
            if (!int.TryParse(userData[1], out age))
            {
                throw new ArgumentException("Users string contains invalid data.");
            }

            // Add to result list.
            result.Add(new User { Name = name, Age = age });
        }

        return result;
    }
} 
```

使用 StringBuilder 构建您的用户字符串，您将在性能方面获胜。您还可以轻松扩展转换器以考虑不同的分隔符/附加逻辑等。

如果您需要更通用的解决方案（能够用于任何类），您可以创建一个转换器，该转换器使用反射来迭代所有公共字段，获取/设置属性以查看可以提取为字符串的内容，然后反转将您的字符串转换回列表的过程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T17:51:42.857

我认为您正在寻找的是可以让您将所有用户转储到字符串并从字符串中恢复用户的东西，对吗？

我建议是这样的：添加一个将 XElement 返回到 Users 类型的方法：

```
public XElement GetXElement()
{
    return new XElement("User", new XElement("Name", this.FirstName)) //and so on...
} 
```

然后将字符串解码为用户：

```
static User GetUserFromXElement(string xml)
{
    XElement temp = XElement.Parse(xml);
    User temp = new User();
    foreach (XElement inner in temp.Elements())
    {
        switch inner.Name
        {
            case "Name":
                temp.Name = inner.Value
                break;
            //whatever
        }
    }
} 
```

然后这样做：

```
public string UsersToElements (List<Users> toWrite)
{
    Stringbuilder sb = new StringBuilder();
    StringWriter sw = new StringWriter(sb);
    XElement root = new XElement("root");
    XDocument temp = new XDocument(root);
    foreach (User user in toWrite)
    {
        root.Append(user.GetXElement());
    }
    temp.Save(sw);
    return sw.ToString();
} 
```

还有这个：

```
public List<Users> ElementsToUsers (string xml)
{
    List<Users> usrsList = new List<Users>();
    XDocument temp = XDocument.Load(xml);
    foreach (XElement e in XDocument.Root.Elements())
    {
        usrsList.Append(Users.GetUserFromXElement(e));
    }
    return usrsList;
} 
```

JSON 解决方案（使用 JSON.NET）

```
public JObject GetJObject()
{
return new JObject("user", new JProperty("name", this.FirstName)); //so on
}

static User GetUserFromJObject(string json)
{
JObject obj = JObject.Parse(json);
return new User() { FirstName = (string)obj["user"]["name"] }; //so on
}

public string UsersToElements (List<Users> users)
{    
   JObject root = new JObject(from usr in users select new JAttribute("user", usr.GetJObject());
   return root.ToString();
}

public List<users> ElementsToUsers(string json)
{
List<Users> users = new List<Users>();
JObject temp = JObject.Parse(json);
foreach (JObject o in (JEnumerable<JObject>)temp.Children())
{
users.Add(Users.GetUserFromJObject(o.ToString());
}
return users;
} 
```

我不知道这是否有效：/（我知道的 XML 确实有效，但对 JSON 不太确定）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-16T17:25:59.947

使用此代码

```
string combindedString = string.Join( ",", myList );

var Array = combindedString.Split( new [] {','} ); 
```

# xpages - XPages 托管 Bean ClassNotFoundException

> ID：14912796
> 
> 赞同：0
> 
> 时间：2013-02-16T17:00:47.357
> 
> 标签：xpages, managed-bean

我试图让托管 bean 工作，当我预览测试页面时，我收到一个错误，它无法实例化类并指示 ClassNotFound 异常。

Java 类在那里并且正确 bean 在 faces-config 文件中正确。我正在运行设计器 8.5.3。

为什么找不到类的可能原因是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T11:46:28.867

正如 Per 所说，您需要提供一些代码示例，以便我们查看是否缺少某些内容。

另请查看他的博客文章[http://per.lausten.dk/blog/2012/02/creating-your-first-managed-bean-for-xpages.html](http://per.lausten.dk/blog/2012/02/creating-your-first-managed-bean-for-xpages.html)这是一个很好的起点，涵盖了所有基础知识.

像需要实现'Serializable'这样简单的事情通常会被遗漏！

# c++ - C++11 非静态成员初始化器和删除的复制构造函数

> ID：14912800
> 
> 赞同：3
> 
> 时间：2013-02-16T17:01:33.030
> 
> 标签：c++, c++11

我正在尝试使用 GCC 4.7.2 (MinGW) 编译以下简单代码。这里我使用 C++11 特性——非静态成员初始化器：

```
#include <iostream>
using namespace std;

struct A
{
    int var;

    A()
    {
        cout << "A()\n";
    }

    A(int i)
    {
        cout << "A(int i)\n";
        var = i;
    }

    A(const A&) = delete;
};

struct B
{
    A a = 7;
};

int main()
{
    B b;
    cout << "b.a.var = " << b.a.var;
    return 0;
} 
```

由于删除了此处不需要的复制构造函数，此代码无法编译。以下是错误：

```
main.cpp:27:11: error: use of deleted function 'A::A(const A&)'
main.cpp:13:5: error: declared here
main.cpp: In constructor 'constexpr B::B()':
main.cpp:25:8: error: use of deleted function 'A::A(const A&)'
main.cpp:13:5: error: declared here 
```

如果我像这样实现复制构造函数：

```
A(const A& a)
{
    cout << "A(const A&)\n";
    var = a.var;
} 
```

然后代码编译得很好，程序给了我预期的输出：

```
A(int i)
b.a.var = 7 
```

所以这意味着没有使用复制构造函数，但是为什么我不能删除它呢？

**编辑：**感谢您的回答。如果我使用`=`. 要解决这个问题，我需要实现移动构造函数或使用直接初始化语法`A a{7}`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T17:09:30.093

初始化器为`a`您提供复制初始化：

```
A a = 7; 
```

对于这样的复制初始化，如果需要用户定义的转换，则生成的初始化等效于：

```
A a(A(7)); 
```

也就是说，`A`构造一个临时对象，然后将其传递给`a`对象的复制构造函数。这种复制可能会被省略，但复制构造函数必须仍然可用。换句话说，只有在最初可能复制的情况下，才能省略复制。如果你`delete`是复制构造函数，复制是不可能的。

如果您执行以下操作，您将有更好的时间使用已删除的复制构造函数：

```
A a{7}; 
```

这会直接初始化，不需要复制构造函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-16T17:03:45.067

允许复制初始化以省略复制，但标准要求复制构造函数可以访问。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-16T17:38:45.297

根据 C++11 标准的第 12.2/14 段：

> 表单中发生的初始化
> 
> T x = a;
> 
> 以及在参数传递、函数返回、抛出异常 (15.1)、处理异常 (15.3) 和聚合成员初始化 (8.5.1)**中称为复制初始化**。[*注意：复制初始化可能会调用移动（12.8）。——尾注*]

您的复制初始化无法编译的原因是在复制初始化期间需要创建一个**临时**对象（至少在逻辑上），并且应该从中构造正在初始化的对象。

现在所有以前的答案似乎都只关注复制构造函数，但这里的第一个问题是缺少**move-constructor**。只要您提供一个，那么复制构造函数确实不是必需的。

唉，删除复制构造函数会阻止生成隐式移动构造函数。显式添加一个可以解决问题：

```
struct A
{
    int var;

    A()
    {
        cout << "A()\n";
    }

    A(int i)
    {
        cout << "A(int i)\n";
        var = i;
    }

    A(const A&) = delete;

    // THIS MAKES IT WORK
    A(A&& a)
    {
        cout << "A(A&&)\n`;
        var = a.var;
    }
}; 
```

请注意，当移动构造函数和复制构造函数都存在时，**移动构造函数是首选**，因为为复制初始化对象而创建的临时对象是右值。

当移动构造函数不存在时，编译器可以调用复制构造函数来执行初始化，因为常量左值引用可以绑定到右值引用，并且复制被视为未优化的移动。

但是，即使*允许*编译器省略对移动或复制构造函数的调用，**仍必须检查操作的语义**。根据 C++11 标准的第 12.8/32 段：

> 当满足或将满足复制操作的省略标准时，除了源对象是函数参数的事实，并且要复制的对象由左值指定时，选择复制的构造函数的重载决策是首先执行好像对象是由右值指定的。如果重载决议失败，或者如果所选构造函数的第一个参数的类型不是对对象类型的右值引用（可能是 cv 限定的），则再次执行重载决议，将对象视为左值。[**注意：无论是否会发生复制省略，都必须执行此两阶段重载解析。它确定如果不执行省略则要调用的构造函数，并且即使调用被省略，所选构造函数也必须是可访问的。**——尾注] [...]

因此，如果移动构造函数和复制构造函数都不存在，编译器会发出错误。

但是，如果您愿意，您可以**直接初始化**您的对象，而不是复制初始化它。只需使用直接初始化语法：

```
struct B
{
    A a{7};
}; 
```

这将使移动构造函数和复制构造函数变得不必要，因为直接初始化对象时不会创建临时对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-16T17:03:31.463

> 那么就是说没有使用拷贝构造函数，但是为什么不能删除呢？

在您的情况下，复制构造函数仅用于**标准要求的***语义检查*，它也需要是可*访问*的。稍后，编译器优化代码，省略了对复制构造函数的调用，因此实际上并没有*调用*它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-16T17:07:53.133

> 由于删除了此处不需要的复制构造函数，此代码无法编译

抱歉，但您的复制构造函数*是*必需的。即使副本可以优化出来，它仍然必须在代码中是可能的。这是语言规定的。

# unit-testing - 单元测试和 FOSUserBundle

> ID：14912804
> 
> 赞同：1
> 
> 时间：2013-02-16T17:02:06.180
> 
> 标签：unit-testing, symfony, phpunit, fosuserbundle

我正在为使用 FOSUserBundle 的 Symfony 2 应用程序编写单元测试。与这个类似的问题不同： [FOSUserBundle 单元测试](https://stackoverflow.com/questions/10418855/fosuserbundle-unit-testing)

但是，我不使用 HTTP 身份验证（仅登录表单），并且我需要使用实际的用户实体而不是伪造的内存中的实体。

尽管进行了很多搜索和尝试，但我根本无法让它工作，整个过程是如此不透明，我什至不知道从哪里开始。这是我的代码：

```
protected $em;
protected $client;
protected $testuser;

public function setUp() { 
    $kernel = static::createKernel();
    $kernel->boot();
    $this->em = $kernel->getContainer()->get('doctrine.orm.entity_manager');
    $this->em->beginTransaction();

    $this->client = static::createClient();

    $usermanager = $kernel->getContainer()->get('fos_user.user_manager');
    $this->testuser = $usermanager->createUser();
    $this->testuser->setUsername('test');
    $this->testuser->setEmail('test@lemuria.org');
    $this->testuser->setPlainPassword('test');
    $usermanager->updateUser($this->testuser);
}

public function testLogin() {
    $crawler = $this->client->request('GET', '/en/login');
    $form = $crawler->selectButton('_submit')->form(array(
        '_username'  => 'test',
        '_password'  => 'test',
        ));     
    $this->client->submit($form);

    $this->assertTrue($this->client->getResponse()->isRedirect(), 'should be redirected');
    $this->assertTrue($this->client->getResponse()->isRedirect('http://localhost/en/account'), 'should be redirected to account page');

    $crawler = $this->client->followRedirect(); 
```

它在第二个断言上失败了。据我所知，它重定向回登录页面。

我被困住了，我什至不知道从哪里开始寻找解决方案，因为显然不可能简单地找出登录失败的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T20:57:33.700

您可以尝试添加`echo $this->client->getResponse()->getContent()`以向您显示可以查找错误的实际响应

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-01T07:03:23.710

创建一个`AbstractControllerTest`并创建一个授权客户端，`setUp()`如下所示：

```
abstract class AbstractControllerTest extends WebTestCase
{
    /**
     * @var Client
     */
    protected $client = null;

    public function setUp()
    {
        $this->client = $this->createAuthorizedClient();
    }

    /**
     * @return Client
     */
    protected function createAuthorizedClient()
    {
        $client = static::createClient();
        $container = $client->getContainer();

        $session = $container->get('session');
        /** @var $userManager \FOS\UserBundle\Doctrine\UserManager */
        $userManager = $container->get('fos_user.user_manager');
        /** @var $loginManager \FOS\UserBundle\Security\LoginManager */
        $loginManager = $container->get('fos_user.security.login_manager');
        $firewallName = $container->getParameter('fos_user.firewall_name');

        $user = $userManager->findUserBy(array('username' => 'REPLACE_WITH_YOUR_TEST_USERNAME'));
        $loginManager->loginUser($firewallName, $user);

        // save the login token into the session and put it in a cookie
        $container->get('session')->set('_security_' . $firewallName,
            serialize($container->get('security.context')->getToken()));
        $container->get('session')->save();
        $client->getCookieJar()->set(new Cookie($session->getName(), $session->getId()));

        return $client;
    }
} 
```

**注意：**请用您的测试用户名替换用户名。

然后，扩展`AbstractControllerTest`并使用全局`$client`发出请求，如下所示：

```
class ControllerTest extends AbstractControllerTest
{
    public function testIndexAction()
    {
        $crawler = $this->client->request('GET', '/admin/');

        $this->assertEquals(
            Response::HTTP_OK,
            $this->client->getResponse()->getStatusCode()
        );
    }
} 
```

**该方法经过测试并且工作正常**

# mysql - 将三个表连接在一起以从每个表中获取三个值

> ID：14912809
> 
> 赞同：1
> 
> 时间：2013-02-16T17:02:27.877
> 
> 标签：mysql, sql

我正在尝试将三个表连接在一起，但不断收到以下错误消息：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 2 行的“INNER JOIN ts_building.id=ts_room.building_id INNER JOIN ts_park.id=ts_build”附近使用正确的语法：SELECT ts_room.building_id,ts_building.park,ts_park INNER加入 ts_building.id=ts_room.building_id 内部加入 ts_park.id=ts_building.park_id WHERE ts_room.id="CC.0.21"

我做错了什么？到目前为止，这是我的代码：

```
SELECT ts_room.building_id,ts_building.park,ts_park
    INNER JOIN ts_building.id=ts_room.building_id
    INNER JOIN ts_park.id=ts_building.park_id
WHERE ts_room.id="CC.0.21" 
```

我在这里上传了 SQL 小提琴：[http ://sqlfiddle.com/#!2/ecaa6/2](http://sqlfiddle.com/#!2/ecaa6/2)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T17:05:30.067

语法是

```
select ts_room.building_id,ts_park.park
from ts_room
inner join ts_building on ts_building.id=ts_room.building_id
inner join ts_park on ts_park.id=ts_building.park_id
where ts_room.id="CC.0.21" 
```

您缺少 from 子句和要加入的表

一般语法或多或少：

```
Select <columns>
from <table1>
[inner|outer|left|right] join <table2> on <condition>
[inner|outer|left|right] join <table3> on <condition>
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T17:05:41.337

您缺少一个`FROM`子句，您`INNER JOIN`也需要指定`ON`，查询应如下所示：

```
SELECT ts_room.building_id,ts_building.park,ts_park
FROM ts_room
INNER JOIN ts_building ON ts_building.id = ts_room.building_id
INNER JOIN ts_park ON tsPpark.id = ts_building.park_id
WHERE ts_room.id="CC.0.21" 
```

[http://dev.mysql.com/doc/refman/5.0/en/join.html](http://dev.mysql.com/doc/refman/5.0/en/join.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T17:07:36.967

您需要在`From`and`INNER JOIN`子句之后指定表名

```
SELECT *
FROM ts_room
    INNER JOIN ts_building ON ts_building.id=ts_room.building_id
    INNER JOIN ts_park ON ts_park.id=ts_building.park_id
WHERE ts_room.id="CC.0.21" 
```

注意：表中没有`ts_building.park`,`ts_park`字段（与您的原始查询一样），所以我选择了所有 (*)

# node.js - nodejs mongodb 动态过滤

> ID：14912811
> 
> 赞同：1
> 
> 时间：2013-02-16T17:02:41.993
> 
> 标签：node.js, mongodb, filtering

我想建立一个基于文档文件和值分布的动态过滤引擎（下一个要过滤的字段的决策树）

我使用 mongodb mongoose 和 nodejs。

IE ：

数据库包含描述汽车特性的文档：

```
{color:"blue", engine:"1598", numOfDoors:3, ...} 
```

我想返回最佳字段以按文档过滤。目标是返回最多 5 个与输入的特征最兼容的文档。

例如，如果有 2 辆蓝色汽车和 8 辆红色汽车，以及 2 辆 2 门汽车、2 辆 3 门汽车、2 辆 4 门汽车、2 辆 5 门汽车、2 辆 6 门汽车。

我想返回`numOfDoors`作为下一个过滤字段，因为返回所需文档数量（5）的概率是 100%，而按颜色过滤只有 20%。

如果您能回答以下问题，我将不胜感激：

1.  如何检索更多字段以通过一组匹配的文档进行过滤（由于 mongo 灵活模式，文档结构彼此不同）
2.  是否有内置函数或模型可用于按字段及其值计算文档分布？

谢谢

# c - 循环调度程序

> ID：14912813
> 
> 赞同：1
> 
> 时间：2013-02-16T17:02:47.060
> 
> 标签：c, scheduling, round-robin

我一直在研究循环调度程序。我的输入是：

```
Process     Arrival Time    Burst Time
   1            0               4
   2            2               2
   3            4               3
   4            6               5
   5            7               1 
```

时间片是3个单位！我的输出必须是：

```
Process     AT      BT      WT      TT      FT
   1        0       4       9       13      13
   2        2       2       1       3       5
   3        4       3       1       4       8
   4        6       5       4       9       15
   5        7       1       4       5       12 
```

但我没有得到流程 1、4 和 5 的正确结果（WT 和 FT）。这是我的代码，谁能帮我修复它并获得上述结果？

```
#include<stdio.h>
#include<conio.h>
struct proc
{
    int id;
    int arrival;
    int burst;
    int rem;
    int wait;
    int finish;
    int ti;
    int turnaround;
    float ratio;
}process[10];

int no,k;
int chkprocess(int);

void main()
{
 int i,j,t,time = 0,n;
 struct proc temp;
 int nextprocess(int);
 clrscr();
 printf("\n \n Enter the number of processes: ");
 scanf("%d", &n);
 printf("\n \n Enter the time slice of the CPU: ");
 scanf("%d", &t);

 for(i = 1; i <= n; i++)
 {
  process[i].id = i;
  printf("\n\nEnter the arrival time for process %d: ", i);
  scanf("%d", &(process[i].arrival));
  printf("\nEnter the burst time for process %d: ", i);
  scanf("%d", &(process[i].burst));
  process[i].rem = process[i].burst;
  process[i].ti=0;
  process[i].wait=0;
  process[i].finish=0;
 }

 for(i = 1; i <= n; i++)
 {
  for(j = i + 1; j <= n; j++)
  {
   if(process[i].arrival > process[j].arrival)
   {
    temp = process[i];
    process[i] = process[j];
    process[j] = temp;
   }
  }
 }

 no = 0;
 j = 1;

 while(chkprocess(n) == 1)
 {
  if(process[no + 1].arrival == time)
   no++;
  if((process[j].ti<=t)&&(process[j].rem !=0))
  {
   process[j].rem--;
   process[j].ti++;
   for(i = 1; i <= no; i++)
   {
    if((i!=j) && (process[i].rem != 0))
     process[i].wait++;
   }
  }
  if(process[j].rem==0)
   process[j].finish=time;
  if((process[j].ti >= t)||(process[j].rem==0))
  {
   process[j].ti = 0;
   j=nextprocess(j);
  }
  time++;
 }
 process[n].finish = time;
 printf("\n\n Process  Arrival  Burst   Waiting  Finishing turnaround  Tr/Tb \n");
 printf("%5s %9s %7s %10s %8s %9s\n\n", "id", "time", "time", "time", "time", "time");
 for(i = 1; i <= n; i++)
 {
  process[i].turnaround = process[i].wait + process[i].burst;
  process[i].ratio = (float)process[i].turnaround / (float)process[i].burst;
  printf("%5d %8d %7d  %8d %10d %9d %10.1f ", process[i].id, process[i].arrival,
                          process[i].burst,
                          process[i].wait, process[i].finish,
                          process[i].turnaround, process[i].ratio);

  printf("\n\n");
 }
 getch();
}

int chkprocess(int s)
{
 int i;
 for(i = 1; i <= s; i++)
 {
  if(process[i].rem != 0)
   return 1;
 }
 return 0;
}

int nextprocess(int k)
{
 int i;
 i=k+1;
 while(chkprocess(i) && i!=k)
 {
  if(process[i].rem != 0)
   return i;
  else
   i=(i+1)%no;
 }
} 
```

谢谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T18:56:58.137

我敢肯定有很多错误（从不关心用户是否要输入 11 个或更多进程开始，即使您的进程数组限制为 10 个）。

然而; 我花了 10 分钟试图破译你的代码，但仍然不知道它认为它在做什么 - 根本没有评论，变量名和函数名没有帮助（例如`no`，不是布尔“是/否”变量,`checkprocess()`不检查一个进程，而是检查所有进程以查看所有进程是否已完成等）。大多数情况下，如果我得到报酬来修复此代码，我会简单地将其扔掉并从头开始重写以节省时间。我想过从头开始重写它并发布结果代码；但这对你的家庭作业没有帮助。

我的建议是，从头开始重写而不是修复它。

它应该有一个全局`currently_running_process`变量，一个全局`current_time`变量，一个增加当前时间的函数，以及一个调度程序本身的函数。

增加当前时间的功能将：

*   对于调度器链表上的每个进程，增加等待时间
*   做`current_time++`
*   找到任何应​​该启动的进程 ( `current_time == arrival_time`) 并将任何启动的进程附加到调度程序链表的末尾

调度程序功能应该：

*   从调度程序的链表中删除第一个进程
*   确定该进程应该使用多少时间（时间片长度或进程的剩余时间，以较低者为准）
*   从进程的剩余时间中减去该时间量
*   在循环中调用`increase_time()`函数，直到经过该时间量
*   如果进程的剩余时间不为零；将进程放回链表的末尾
*   如果进程剩余时间为零，则检查调度器的链表是否为空，如果是则退出程序

注意：在调用调度程序函数之前，我会`current_time = -1;`先调用该函数以增加当前时间一次；这样任何进程`arrival_time == 0`都将在调度程序开始工作之前添加到调度程序的链表中（并且这样调度程序函数在启动后就不会看到一个空列表）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-06T18:21:04.400

```
/* The following code doesn't take the arrival time of the processes in account.
                              HAPPY CODING */
#include<stdio.h>
void main()
{
int b[10],br[10],wo[10];
int n,i,bt,q,count;
float awt=0,att=0;
for (i=0;i<10;i++)
     wo[i]=0;
printf("Input the nmbr of processes running....");
scanf("%d",&n);
printf("\n Input their burst tym in order..");
for(i=0;i<n;i++)
    scanf("%d",&b[i]);
printf("\n Input the quantum time for the algorithm..");
scanf("%d",&q);
for(i=0;i<n;i++)
    br[i]=b[i];
bt=0;
for(i=0;i<n;i++)
    bt=bt+b[i];
count=0;
printf("\nThe Gantt Chart is as follows:\n");
printf("\n 0");
do
{
for(i=0;i<n;i++)
{
  if(br[i]==0)
   {}
  else
  {
   if(br[i]>=q)
   {
     br[i]=br[i]-q;
     if(br[i]==0)
        wo[i]=count;
     count=count+q;
     printf("\t(P%d)",i);
     printf("\t%d",count);
   }
   else
   {
     if(br[i]<q)
    {
       count=count+br[i];
       br[i]=0;
       wo[i]=count;
       printf("\t(P%d)",i);
       printf("\t%d",count);
     }
   }
 }
}
}while(count<bt);
for(i=0;i<n;i++)
    awt=awt+(wo[i]-b[i]);
awt=awt/n;
printf("\n The average waiting time is....%f",awt);
for(i=0;i<n;i++)
    att=att+wo[i];
att=att/n;
printf("\n The average turnaround time is....%f",att);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-03T17:46:11.153

您可以使用队列来做同样的事情，我正在粘贴一个用 ANSI CPP 编写的链接。您可以查看此链接以获取更多信息。我遇到了和你一样的问题，但是链接上的代码对我帮助很大，它还包含许多其他调度程序，但我只从中提取了循环。 [单击此处查看循环调度的代码](http://www.codingdevil.com/2014/01/scheduling.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-12T19:36:45.410

## C中的循环调度程序

```
#include<stdio.h>
#include<conio.h>

main(){

    int i, j, k, n, so, tq, sob, sum, swt, stat, tata, temp, count;
    int bt[10], bth[10], wt[10], tat[10];
    float awt=0.0, atat=0.0;
    char new;

    // i = loop controller
    // j = loop controller
    // k = loop controller
    // n = number of process
    // so = (burst time holder divided by time quantum) and added by one
    // tq = time quantum
    // awt =average waiting time
    // new = hold the value of start command
    // sob = gantt chart size from so
    // swt = summation of waiting time              l
    // bt[] = burst time
    // wt[] = waiting time
    // atat = average turn around time
    // gcps = gantt chart process sequence
    // stat = summation of turn around time
    // tata = accumulator of turn around time
    // temp = time quantum holder
    // count = counter
    // bth[] = burst time holder
    // tat[] = turn around time

    printf("\n\n\n\n   To start round robin scheduling press any key: ");

    k = 0;
    new = getche();
    system("cls");

    while(k < 7){

        j = 0; sob = 0; count = 0; sum = 0; swt = 0; stat = 0; tata = 0;

        printf("\n\n\n\t\t\t      ROUND-ROBIN SCHEDULING");
        printf("\n\t\t\t      ======================");
        printf("\n\n\n\n\n   Enter number of processes: ");
        scanf("%d", &n);
        printf("\n");

        for(i = 0; i < n; i++){

            printf("\n   Enter burst time for Process P%d: ", i+1);
            scanf("%d", &bt[i]);
            bth[i] = bt[i];
        }

        printf("\n\n   Enter time quantum: ");
        scanf("%d", &tq);
        system("cls");
        printf("\n\n\n\t\t\t      ROUND-ROBIN SCHEDULING");
        printf("\n\t\t\t      ======================");
        printf("\n\n\n\n\n   Time quantum: %d", tq);

        for(i = 0; i < n; i++){

            if(bth[i] % tq == 0){

                so = bth[i] / tq;
            }
            else{so = (bth[i] / tq) +1;}
            sob = sob + so;
        }

        int gc[sob], gcps[sob];

        while(1){

            for(i = 0,count = 0; i < n; i++){

                temp = tq;
                if(bth[i] == 0){

                    count++;
                    continue;
                }

                if(bth[i] > tq){

                    gc[j] = tq;
                    gcps[j] = i+1; j++;
                    bth[i] = bth[i] - tq;
                }

                else if(bth[i] >= 0){

                    if(bth[i] == tq){gc[j] = tq; gcps[j] = i+1; j++;}
                    else{gc[j] = bth[i]; gcps[j] = i+1; j++;}
                    temp = bth[i];
                    bth[i] = 0;
                }

                tata = tata + temp;
                tat[i ]= tata;
            }

            if(n==count){

                break;
            }
        }

        for(i = 0; i < n; i++){

            wt[i] = tat[i] - bt[i];
            swt = swt + wt[i];
            stat = stat + tat[i];
        }

        awt = (float)swt/n;
        atat = (float)stat/n;

        printf("\n\n   Process   Burst time   Waiting time   Turn around time\n");
        printf("   -------   ----------   ------------   ----------------\n");

        for(i = 0; i < n; i++){

            printf("\n\n      P%d\t %d\t       %d \t        %d", i+1, bt[i], wt[i], tat[i]);
        }

        printf("\n\n\n\n   Gantt Chart:\n");
        printf("   ------------\n\n");
        for(j = 0; j < sob; j++){

            printf("\tP%d", gcps[j]);
        }
        printf("\n   0");
        for(j = 0; j < sob; j++){

            sum = sum + gc[j];
            if(j == 0){printf("        %d", sum);}
            else{printf("\t    %d", sum);}
        }
        printf("\n\n\n\n   Average waiting time: %.2f \n\n   Average turn around time: %.2f",awt,atat);
        printf("\n\n\n\n   To start again press S and to exit press any key: ");

        new = getche();
        system("cls");

        if(new == 'S'|| new == 's'){k++;}
        else{printf("\n\n\n   Program was terminated successfully\n\n   Thank you\n\n\n"); break;}

    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-23T12:55:28.610

此代码将从文件中读取数据，其格式应在一行中包含一个进程信息，*到达时间*、*突发时间*、间隔，并且文件应以 -1 结尾。文件名和时间片必须在命令参数中传递。像：

```
0 3
1 2
2 1
-1 
```

代码是 C 语言，变量名是自描述的。

```
#include<stdio.h>

int main(int argc, char *argv[])
{
int flag = 0;

int timeSlice = atoi(argv[2]);

printf("%d\n\n", timeSlice);

int arrivalTime[10], burstTime[10], responseTime[10], finishTime[10];
int remainingProcesses, processCount = 0;

FILE * file = fopen(argv[1], "r");

if (!(file == NULL))
{
    while (fscanf(file, "%d", &arrivalTime[processCount]))
    {
        if (arrivalTime[processCount] == -1)
            break;

        fscanf(file, "%d", &burstTime[processCount]);

        responseTime[processCount] = burstTime[processCount];

        processCount++;
    }

    remainingProcesses = processCount;

    fclose(file);
}

printf("Process\t|  Arrival time\t|  Finish Time\t|     Burst\t|   Turnaround\t|\n");
printf("-------------------------------------------------------------------------\n");

int i = 0; int time = 0;

while (remainingProcesses != 0)
{
    if (responseTime[i] <= timeSlice && responseTime[i]>0)
    {
        time += responseTime[i];
        responseTime[i] = 0;
        flag = 1;
    }
    else if (responseTime[i] > 0)
    {
        responseTime[i] -= timeSlice;
        time += timeSlice;
    }

    if (responseTime[i] == 0 && flag == 1)
    {
        finishTime[i] = time;
        remainingProcesses--;

        printf("P[%d]\t|\t%d\t|\t%d\t|\t%d\t|\t%d\t|\n", i + 1, arrivalTime[i], finishTime[i], burstTime[i], finishTime[i] - arrivalTime[i]);
        flag = 0;
    }

    if (i == processCount - 1) // If its the last process go back to slicing process 1
    {
        i = 0;
    }

    else if (arrivalTime[i + 1] <= time) // If the next process has kicked in
    {
        i++;
    }

    else // If the process haven't kicked in yet
    {
        time++;
        i = 0;
    }
}

return 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-24T19:42:41.573

特别感谢[kanika](https://stackoverflow.com/users/2852362/kanika)

我只是修改了一些代码。输出： [![在此处输入图像描述](../Images/5e82bf16a155e832f4bfa60b281d9114.png)](https://i.stack.imgur.com/mior6.png)

```
#include<stdio.h>
void main()
{
int bt[10],btTmp[10],tat[10];
int n,i,btAll,quantum,count;
float awt=0,att=0;
for (i=0;i<10;i++)
     tat[i]=0;

printf("Input the number of processes : ");
scanf("%d",&n);
printf("\n Input their burst time in order : ");
for(i=0;i<n;i++){
     scanf("%d",&bt[i]);
     btTmp[i]=bt[i];
}

printf("\n Input the quantum time : ");
scanf("%d",&quantum);

btAll=0;
for(i=0;i<n;i++)
    btAll=btAll+bt[i];

count=0;

while(count<btAll)
{
for(i=0;i<n;i++)
{
  if(btTmp[i]==0)
   {}
  else
  {
   if(btTmp[i]>=quantum)
   {
     btTmp[i]=btTmp[i]-quantum;
     if(btTmp[i]==0)
        tat[i]=count+quantum;
     count=count+quantum;
   }
   else
   {
       count=count+btTmp[i];
       btTmp[i]=0;
       tat[i]=count;

   }
 }
}
}
 printf("\nprocess \t bt time \t wt time \t TAT\n");
for(i=0;i<n;i++){
    printf(" \tP%d \t\t  %d \t\t  %d \t \t %d\n",i, bt[i], tat[i]-bt[i], tat[i]);
    awt=awt+(tat[i]-bt[i]);
    att=att+tat[i];
}

printf("\n The average waiting time is %f :  ",awt/n);
printf("\n The average turnaround time is....%f :  ",att/n);
} 
```

# php - “找不到类”使用 php/silex

> ID：14912818
> 
> 赞同：2
> 
> 时间：2013-02-16T17:03:21.190
> 
> 标签：php, apache, amazon-ec2, autoload, silex

我在 Mac 上使用 XAMPP 设置了一个本地 Silex 项目。一切正常。现在我将文件上传到我的 Amazon ec2 服务器并尝试运行它。我总是收到 php 错误消息：

```
"Fatal error: Class 'Silex\Application' not found in /opt/bitnami/apps/..." 
```

我正在使用 Composer 来处理依赖项。我的文件的第一行如下所示：

```
<?php
require_once __DIR__.'/../vendor/autoload.php';

$app = new Silex\Application();
$app['debug'] = true; 
```

任何人都知道如何解决这个问题？哪里可能有问题？

非常感谢！干杯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-17T14:06:21.677

正如怀疑的那样，您正在使用某种基于 git 的部署过程。

目前没有标记的 silex 稳定版本（编辑：截至目前，有）。因此，composer 将从源代码安装它，从而将 silex github 存储库克隆到`vendor/silex/silex`. 由于该文件夹本身就是一个 git 存储库，因此无法将这些文件添加到您的主存储库中。这意味着在您的服务器上该`vendor/silex/silex`目录根本不存在。

如果你*真的*想要，你可以应用运行标志的修复程序`composer install`，`--prefer-dist`这将强制从 zip 存档安装 silex，从而允许将目录添加到你的 git 存储库中。

但我会说你不应该让你的供应商参与版本控制。作曲家常见问题解答中的此条目也涵盖了这一点：

*   [我应该在我的供应商目录中提交依赖项吗？](http://getcomposer.org/doc/faqs/should-i-commit-the-dependencies-in-my-vendor-directory.md)

我建议添加`vendor`到您并作为 CI 和部署过程的一部分`.gitignore`运行。`composer install`

# java - 从 java 中的 .csv 文件中读取 7 列？

> ID：14912823
> 
> 赞同：-1
> 
> 时间：2013-02-16T17:03:42.133
> 
> 标签：java

我是 Java 新手。有人可以向我建议如何读取包含 7 列的 CSV 文件吗？

这是我的代码：

```
import java.io.BufferedReader;
import java.io.DataInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStreamReader;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class main {

    public static  Map<String,String> map1 = null;
    public static  Map<String,String> map2 = null;

    public static void main(String[] args) {
        try {
            readFileandPopulate();
            for (Map.Entry<String, String> entry : map1.entrySet()) {
                System.out.println("Key : " + entry.getKey() + " Value : "
                    + entry.getValue()+" address :"+map2.get(entry.getKey()));
                //insert into DB
            }
        } catch (Exception e) {//Catch exception if any
            e.printStackTrace();
            System.err.println("Error: " + e.getMessage());
        }
    }

    public static void readFileandPopulate() throws Exception {
        FileInputStream fstream = new FileInputStream("/Users/Desktop/Pattern Recognition/DataSetR/1a19.csv");
        // Use DataInputStream to read binary NOT text.
        BufferedReader br = new BufferedReader(new InputStreamReader(fstream));
        String strLine;
        map1 = new HashMap<String,String>();
        while ((strLine = br.readLine()) != null) {
            System.out.println(strLine);
            String temp[] = strLine.split(",");
            map1.put(temp[0], temp[1]);
        }
        in.close();
        System.out.println("done 1");

    }
} 
```

有没有什么方法可以只读取几列并删除剩余的数据，或者我可以将所有值存储在数组中并使用数组的索引来计算一个使用值的方程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T19:46:00.607

```
import java.io.FileReader;
import java.io.IOException;
import java.util.List;

import au.com.bytecode.opencsv.CSVReader;

public class ReadCSV 
{
    public static void main(String[] args) throws IOException 
    {
        String[] row = null;
        String csvFilename = "C:/Users/Hussain/Desktop/data.csv";
        CSVReader csvReader = new CSVReader(new FileReader(csvFilename));
        List content = csvReader.readAll();
        for (Object object : content) 
        {
            row = (String[]) object;
            System.out.println("value in row 7 ===>>>"+row[6]);
        }
        csvReader.close();
        }
} 
```

[你可以从这里](http://www.java2s.com/Code/Jar/o/Downloadopencsv23jar.htm)添加罐子

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T19:08:51.563

我建议使用 CSV 解析器，例如[http://opencsv.sourceforge.net/](http://opencsv.sourceforge.net/)。然后您可以执行以下操作：

```
CSVReader reader = new CSVReader(new FileReader(filePath), ',');

List<String[]> rows= reader.readAll();

for (String[] row : rows)
{
    for (int i = 0; i < numColumnsToParse; i++)
    {
        //do something with row[i]
    }
} 
```

# c++ - 不能在类中使用结构（带模板）

> ID：14912824
> 
> 赞同：-1
> 
> 时间：2013-02-16T17:03:44.227
> 
> 标签：c++, templates, struct

我用模板制作了一个节点结构：

```
template <typename T>
struct Node{
        T data;
        Node* next;
        Node* prev;
}; 
```

它编译得很好，但是当我尝试在类中使用它时，它给了我错误：在没有参数列表的情况下无效使用模板名称“节点”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T17:06:35.160

在另一个类的上下文中，您需要添加一个模板参数而不是使用 plain `Node*`：

```
struct B
{
  Node<int>* next;
}; 
```

# android - 从 setOnClickListener 中执行时，AsyncTask 无法正常工作

> ID：14912826
> 
> 赞同：0
> 
> 时间：2013-02-16T17:03:48.513
> 
> 标签：android, android-asynctask

我正在尝试登录 Web 服务器，并且代码运行正常，但是当我尝试围绕它构建登录页面时，事情开始出错了。

如果有人想查看任何额外的代码，我正在使用 Eclipse Android 工具中提供的示例登录页面。

如果我从 OnClickHandler 中执行，那么 DefaultHttpClient 似乎就超时了。它不返回任何东西，或者如果它返回，我知道它是错误的“无对等证书”。

```
/**
 * Keep track of the login task to ensure we can cancel it if requested.
 */
private UserLoginTask mAuthTask = null; 
```

...设置东西

```
 mAuthTask = new UserLoginTask();
    findViewById(R.id.sign_in_button).setOnClickListener(
            new View.OnClickListener() {
                @Override
                public void onClick(View view) {
                    if(attemptLogin()){
                        mAuthTask.execute();
                    }
                }
            });
    //mAuthTask = new UserLoginTask(); 
    //mAuthTask.execute();  // Works if called from here. 
```

这是相关的 AsyncTask 代码：

```
public class UserLoginTask extends AsyncTask<String, Void, String> {

    @Override
    protected void onPreExecute() {
        Log.i(TAG,"Thread name (from preexecute) : " +  Thread.currentThread().getName());
    }

    protected String doInBackground(String... urls) {
        DefaultHttpClient client = AppHttpClient.getClient();
        HttpPost httppost = new HttpPost("https://euw.leagueoflegends.com/user/login");
        String result = "";
        try {
            // Add your data
            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(3);
            nameValuePairs.add(new BasicNameValuePair("name", "exampleusername"));
            nameValuePairs.add(new BasicNameValuePair("pass", "blahblah"));
            nameValuePairs.add(new BasicNameValuePair("form_id", "user_login"));
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

            // Execute HTTP Post Request
            Log.i(TAG,"Thread name (passed into doInBackground) : " +  urls[0]);
            Log.i(TAG,"Thread name (from doInBackground) : " +  Thread.currentThread().getName());
            HttpResponse response2 = client.execute(httppost);
            InputStream in = response2.getEntity().getContent();
            //result = readStream(in);
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return result;
    }

    @Override
    protected void onPostExecute(final String success) {
        mAuthTask = null;
        showProgress(false);
    }

    @Override
    protected void onCancelled() {
        mAuthTask = null;
        showProgress(false);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T18:20:36.703

这是来自 Google 工程师的一个有趣的[回答：](https://stackoverflow.com/a/3301565/1489493)

> 在创建任务实例的线程上调用 AsyncTask 的 pre 和 postExecute 方法。在哪里调用 execute() 并不重要。您在其上创建任务的线程必须是 Looper 线程，并且在实践中应该始终是主线程（或 UI 线程）。

**编辑：**

您应该尝试此代码（未经测试）：

```
private mAuthTask = new UserLoginTask();
findViewById(R.id.sign_in_button).setOnClickListener(
        new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                if(attemptLogin()){
                    Activity.this.runOnUiThread( new Runnable() {
                        @Override
                        public void run() {
                            mAuthTask.execute();
                        }
                    });
                }
            }
        }); 
```

# c# - 检查子/孙对象时可能对 IEnumerable 进行多次枚举

> ID：14912830
> 
> 赞同：0
> 
> 时间：2013-02-16T17:04:29.017
> 
> 标签：c#, entity-framework

我有以下查询：

```
baseQuery = Buildings.Where(
     i => i.Apartment != null 
     && i.Apartment.Manager != null 
     && i.Apartment.Manager.Name == Username); 
```

我想我得到了错误，因为我在这里执行三个单独的查询，所以这个操作会非常慢。有什么办法可以优化此检查？

编辑：我从 resharper 得到“IEnumerable 的可能多重枚举”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T17:12:54.347

假设它`ContextProvider.Context.Inspections`是 a`DbSet`或 an `IQueryable`，这不会导致 IEnumerable 的多个枚举。该表达式将被翻译成 SQL 查询并在服务器上执行。您可以通过在您的行之后放置一个断点来检查这一点，然后将鼠标悬停在上面`baseQuery`以查看生成的 SQL。

看起来像是来自 resharper 的误报。

# django - django ModelFormSet 返回错误，想要显示除空表单外的所有表单

> ID：14912831
> 
> 赞同：0
> 
> 时间：2013-02-16T17:04:29.403
> 
> 标签：django, django-forms, formset

使用 django 1.4，我有一个没有初始实例的 ModelFormSet，extra 和 max 设置为 6：

```
# forms.py
ChildFormSet = modelformset_factory(Child, formset=FirstRequiredModelFormSet, exclude=('family_application', 'exported', 'index',), extra=6, max_num=6)
child_queryset = Child.objects.none() 
```

当用户第一次访问该页面时，我使用 jquery 只显示一个空白表单（字段集）。用户可以按一个按钮来显示其余的表格。如果表单返回验证错误，我可以使用 jquery 查找具有类 errorlist 的字段集并显示所有这些字段集。但是，我还想显示任何包含有效数据的字段集。我可以检查每个字段集中的所有元素以查看它们是否具有值，但这似乎很笨拙。Django 知道表单何时发生更改，所以我想我会为这些表单添加一个前缀，以便我可以在 html 中发现它们：

```
class FirstRequiredModelFormSet(BaseModelFormSet):
    def __init__(self, *args, **kwargs):
        super(FirstRequiredModelFormSet, self).__init__(*args, **kwargs)
        self.forms[0].empty_permitted = False

    def clean(self):
        super(FirstRequiredModelFormSet, self).clean()
        for form in self.forms:
            if form.has_changed():
                form.prefix = '-'.join(('modified', form.prefix)) 
```

问题是我覆盖 clean() 的方式以某种方式导致提交的数据在表单返回错误时丢失（它返回时没有初始数据）。如果我通过首先检查验证错误来提前返回，如下所示：

```
def clean(self):
    if any(self.errors):
        return
    super(FirstRequiredModelFormSet, self).clean()
    for form in self.forms:
        if form.has_changed():
            form.prefix = '-'.join(('modified', form.prefix)) 
```

，数据仍然存在，但当然不会添加前缀。我想过使用 is_bound 而不是 has_changed()，但似乎所有的表单从一开始都是绑定的，我猜是因为它们是 ModelForms。

任何想法为什么覆盖 BaseModelFormSet.clean() 添加前缀会导致返回表单的初始数据丢失？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T21:23:16.530

当浏览器将表单发送回服务器时，Django 使用前缀来识别哪个表单属于哪个子对象。我认为您通过添加自己的前缀来弄乱该系统。

我建议使用不同的系统来识别修改后的表格。我认为您应该能够`has_changed()`在模板中使用该方法，因此您可以执行以下操作 -

```
<form class="{% if form.has_changed %}changed{% endif %}"> 
```

（注意在模板中调用方法时缺少括号）。

# java - 如何创建2个排序列表的递归合并导致排序合并列表

> ID：14912835
> 
> 赞同：0
> 
> 时间：2013-02-16T17:04:52.607
> 
> 标签：java, recursion, merge

我正在学习递归我试图通过合并 2 个排序列表来返回一个排序列表并且我迷路了。我知道这已经不正确，但任何指导都会有所帮助。

```
public static ArrayList<Integer> mergeMyList(ArrayList<Integer> list1, 
          ArrayList<Integer> list2)
{
    ArrayList<Integer> tempList = null;  
    int n = list1.size() +list2.size();
    int l = list2.size();

    if ( n == 0  && l == 0)
    {                        
        tempList = list1;
        return tempList;
    }
    if ( n == 0 )
    {                        
        tempList = list2;
        return tempList;
    }
    if ( l == 0)
    {                        
        tempList = list1;   
        return tempList;
    }

    else
    {   
        int x = list1.get(0); 
        int y = list2.get(0);

        if (x < y )
        {
            //  list1.add(x);
            //  list1.add(y); 
            tempList=list1;
            //  list1.remove(0);
            //  list2.remove(0);    

        }
        else
        {
            list1.add(y);                     
            tempList = list1;
            list1.remove(0);
            list2.remove(0);
            tempList = mergeMyList(list1,list2);
        }                   
    }
    tempList = mergeMyList(list1,list2);
    return tempList;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:15:41.160

它可以做得更短或更好，但我认为可以理解。

```
ArrayList<Integer> mergeList(ArrayList<Integer> list1, 
                             ArrayList<Integer> list2)
{
  ArrayList result = new ArrayList<Integer>();

  while (list1.size() > 0 && list2.size() > 0)
  {
    if (list1.get(0) < list2.get(0))   
       result.add(list1.remove(0));
    else
       result.add(list2.remove(0));
  }

  while (list1.size() > 0) result.add(list1.remove(0));
  while (list2.size() > 0) result.add(list2.remove(0));

  return result;
}

ArrayList<Integer> QuickSort(ArrayList<Integer> list)
{
  if (list.size() < 2)
    return list;

  ArrayList<Integer> left = list.subList(0, list.szie() / 2);
  ArrayList<Integer> right = list.subList(list.szie() / 2, 8);

  return mergeList(QuickSort(left), QuickSort(right));
} 
```

这是递归的快速排序的完整示例。它很快（有点），但需要大量空间，如果列表太大，可能会溢出堆栈。

递归合并：

```
ArrayList<Integer> mergeList(ArrayList<Integer> list1, 
                             ArrayList<Integer> list2)
{
  if (list1.size() == 0) return list2;
  if (list2.size() == 0) return list1;

  ArrayList result = new ArrayList<Integer>();

  if (list1.get(0) < list2.get(0))   
    result.add(list1.remove(0));
  else
    result.add(list2.remove(0));

  result.addAll(mergeList(list1, list2));

  return result;  
} 
```

# android - 如何重新设计一个 AlertDialog

> ID：14912837
> 
> 赞同：0
> 
> 时间：2013-02-16T17:04:54.257
> 
> 标签：android, eclipse, android-widget

我想重新设计我的警报对话框（以更改此对话框的窗口）。我试图在网上搜索，我没有找到有用的东西。我还尝试为警报对话框设置布局，但我没有找到执行此操作的系统...我是 Android 的初学者。我的代码：

```
import android.os.Bundle;
import android.view.View;
import android.view.Window;
import android.view.WindowManager;
import android.widget.Button;
import android.app.Activity;
import android.app.AlertDialog;
import android.view.View.OnClickListener;

public class Magie extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.magie);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN);

        final Button magie1 = (Button) findViewById(R.id.bma1);
        magie1.setOnClickListener(new OnClickListener(){

            public void onClick(View v) {
                // TODO Auto-generated method stub
            magie1();
            }

        });

        final Button magie2 = (Button) findViewById(R.id.bma2);
        magie2.setOnClickListener(new OnClickListener(){

            public void onClick(View v) {
                // TODO Auto-generated method stub
            magie2();
            }

        });

        final Button magie3 = (Button) findViewById(R.id.bma3);
        magie3.setOnClickListener(new OnClickListener(){

            public void onClick(View v) {
                // TODO Auto-generated method stub
            magie3();
            }

        });

        final Button magie4 = (Button) findViewById(R.id.bma4);
        magie4.setOnClickListener(new OnClickListener(){

            public void onClick(View v) {
                // TODO Auto-generated method stub
            magie4();
            }

        });
    }

    private void magie1(){
        AlertDialog.Builder ad = new AlertDialog.Builder(this);
        ad.setTitle("title1");
        ad.setMessage("text1");
        ad.show();
    }

    private void magie2(){
        AlertDialog.Builder ad = new AlertDialog.Builder(this);
        ad.setTitle("title2");
        ad.setMessage("text2");
        ad.show();
    }

    private void magie3(){
        AlertDialog.Builder ad = new AlertDialog.Builder(this);
        ad.setTitle("title3");
        ad.setMessage("text3");
        ad.show();
    }

    private void magie4(){
        AlertDialog.Builder ad = new AlertDialog.Builder(this);
        ad.setTitle("title4");
        ad.setMessage("Text4");
        ad.show();
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T19:28:24.543

警报的窗口装饰和主题从 Android 版本到 Android 版本有很大的不同，并且还经常通过给定版本的 OEM 修改进行定制。没有安全的方法来回收 android AlertDialog 系统资源和活动中的主题。一些必需的资源被隐藏了；并且 AlertDialogs 的大部分是用代码而不是布局文件构建的。奇怪但真实。

这使您有两种选择之一。

(1) 使用 AlertDialog.Builder.setView() 将自定义布局插入到警报对话框中。

绝对是首选方法。这种方法存在一些小的主题问题。明智的做法是不要假设背景是白色或黑色，并且不要覆盖任何控件上的默认颜色。（例如，三星 Galaxy Tab 1.0 即使在使用浅色主题时也会在蓝色背景上显示所有警报，而在使用浅色主题时会在蓝色背景上显示不可读的黑色文本）。如果您必须在视图中使用显式颜色（或使用浅色主题），请确保您的视图具有纯色背景（浅色主题为白色，默认主题为黑色）。

如果可以，使用 AlertDialog.Builder 方法添加对话框按钮。如果您想在警报对话框中添加标题栏，请不要忘记调用 AlertDialog.Builder.setIcon 和 AlertDialog.Builder.setTitle。

(2) 为您选择的 Android 版本构建一个模仿警报的活动。

执行此操作时，实际上不可能在运行时使用 Android 系统资源。但是，如果需要，您可以从 Android SDK 窃取资源。所有 android 版本的库存资源文件都可以在 SDK 的“平台”目录中找到。一般的想法是，您将为您的活动设置样式以删除所有装饰，然后在布局文件中模拟窗口装饰。

```
styles.xml:

<style name="Theme.TutorialDialog" parent="android:style/Theme.Black">
    <item name="android:windowNoTitle">true</item>
    <item name="android:windowContentOverlay">@null</item>
    <item name="android:windowIsFloating">true</item>
</style>

AndroidManifest.xml:
     <activity
          android:name="com.twoplay.twoplayer2.TutorialActivity"
          ...
      android:theme="@style/TutorialDialog" 
     /> 
```

这会产生一个透明的 Activity，它漂浮在 Activity 的正下方。然后由您来重新创建标题栏和按钮。在布局中使用填充或边距在内容周围放置透明边框。从 sdk 平台目录中清除您可以使用的资源。不，也没有现成的方法可以重新创建警报对话框使用的按钮样式。这是一条艰难的路，只能作为最后的手段。

一种有时很有用的模式：创建一个包装警报对话框的 Activity。使用上面给出的自定义主题来删除窗口装饰。在 Activity.onCreate 中，您不设置视图；把它留空。然后在 onCreate 中，创建并显示一个警报。警报的按钮处理程序然后在封闭的活动上调用 Activity.finish()。如果您想在多个活动中干净地回收警报对话框，这可能很有用；或者，如果您需要启动警报对话框以响应来自后台的系统活动，或按下通知栏按钮等。

希望有帮助。简短的回答：尽可能使用 AlertDialog.Builder.setView。

# ant - 如何在ant中使用绝对路径删除文件？

> ID：14912839
> 
> 赞同：1
> 
> 时间：2013-02-16T17:05:18.117
> 
> 标签：ant, fileset, installanywhere

我想删除文件夹中特定类型的所有文件。但是，我只有文件夹的绝对路径。我能做些什么？

例如，我可能想删除 C:\example 中的 .txt 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T19:44:45.027

这应该这样做：

```
<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." default="deletetxtfiles" name="Deletefiles">
    <target name="deletetxtfiles">
        <delete>
            <fileset dir="C:/Example" includes="*.txt"/>            
        </delete>
    </target> 
</project> 
```

它只删除 C:\Example 中的 txt 文件。文件夹、其他文件类型或子文件夹中的 txt 文件不会受到影响。

# jquery - 2个按钮之间的增量和减量

> ID：14912841
> 
> 赞同：1
> 
> 时间：2013-02-16T17:05:40.357
> 
> 标签：jquery

我有 2 个按钮，这 2 个按钮会增加总点击次数。（总数单独计算）用户只允许选择其中1个，这意味着如果用户之前点击过buttonA并再次点击buttonB。ButtonA 将 - 1，而 ButtonB 将 + 1。

我有以下代码，但有问题。如果在按钮之前没有点击

```
buttonA (0) - buttonB (0). 
```

如果用户单击 buttonA 假设是，`buttonA (1) - buttonB (0)` 但以下代码显示

```
buttonA (1) - buttonB (-1) 
```

我想要的是，该按钮仅减少用户之前单击它的按钮。以及如何改进我的代码？看起来很乱。

```
$this.addClass('active').siblings().removeClass('active');
if ($this.is('span[name="ans_yes"]')) {
    yes_no = 1;
    currentVal = parseInt($this.find('.badge').html());
    $this.find('.badge').html(currentVal + 1);

    currentVal2 = parseInt($id.find('.ans-no').html());
    $id.find('.ans-no').html(currentVal2 - 1);
} else {
    yes_no = 0;
    currentVal = parseInt($this.find('.badge').html());
    $this.find('.badge').html(currentVal + 1);

    currentVal2 = parseInt($id.find('.ans-yes').html());
    console.log(currentVal2);
    $id.find('.ans-yes').html(currentVal2 - 1);
} 
```

更新 -[演示](http://jsfiddle.net/vzhen/TtkDG/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T18:19:27.957

我试图保持您的 HTML 结构非常相似，但我完全使用了 JS。如有必要，您需要改装您的`active`课程，因为没有任何 CSS，我不确定它们的用途（如果有的话）

```
var answered = {};  

$('.ans-yes-no').on('click', function(e) {
    var questionId = $(this).parent().attr('id');
    var currentAnswer = answered[questionId];
    var count = parseInt($(this).children('.badge').html());

    if ( currentAnswer == $(this).attr('name') ) {
        // Turning off
        $(this).children('.badge').html(count-1);
        delete answered[questionId];
    } else {
        // If we have a different answer, turn that off
        if ( currentAnswer ) {
            var oldCountEl = $("#"+questionId).children("span[name="+currentAnswer+"]").children('.badge');
            var oldCount = parseInt(oldCountEl.html());
            oldCountEl.html( oldCount - 1 );
        }

        // Turning on
        $(this).children('.badge').html(count+1);
        answered[questionId] = $(this).attr('name');
    }
}); 
```

演示在[http://jsfiddle.net/TtkDG/3/](http://jsfiddle.net/TtkDG/3/)工作，具有 buttonA 和 buttonB 的多个实例。

编辑：为了清楚起见，我确实必须将按钮包装在带有问题标识符的包含 div 中。只要确保你不会错过它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T18:10:50.733

我建议使用一`didtheuserclick`开始为假的变量并检查变量是否为真而不是减法，否则忽略减法部分，并在点击功能结束时将变量设置为真，我做了一个演示，[http：/ /jsfiddle.net/TtkDG/1/](http://jsfiddle.net/TtkDG/1/)

你也可以使用一个简单的整数变量，每次点击时都会增加，并检查变量是否等于 1，这是相同的逻辑，但如果只是为此使用它来增加变量是没有意义的，特别是如果你要达到高数字.

希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T19:03:50.110

我创建了一个函数来切换`badge`. 如果增量小于零，则打印零。

另请注意，向元素添加另一个类比使用更简单`name`

```
 $('.ans-yes-no').on('click', function (e) {
      e.preventDefault();

      var $this = $(this),
          $otherBtn = $this.siblings('.ans-yes-no');

      var $btnWrap = $this.closest('.topic-footer');
      /* check if user has already selected, test "active" class length*/
      var alreadyVoted = $btnWrap.find('.active').length;
      if (alreadyVoted) {
          if ($this.is('.active')) {
              /* do nothing if already active?? */
              return;
          } else {
              $this.add($otherBtn).toggleClass('active');
          }
      } else {
          $this.addClass('active');
      }

      toggleValue($this, 'up');
      toggleValue($otherBtn, 'down');
  });

  function toggleValue($element, direction) {
      $element.find('.badge').text(function (i, currVal) {
          var value = parseInt(currVal, 10);
          direction == 'up' ? value++ : value--;
          return value > -1 ? value : 0;
      })
  } 
```

演示：http: [//jsfiddle.net/MZyxW/](http://jsfiddle.net/MZyxW/)

就用户能够继续添加或者`active`如果用户已经单击答案，您是否会更新每个页面加载的 html 类，还不是 100% 清楚您想要什么行为

# ruby - 在 UbuntuVirtual 服务器上安装 Redmine 和 Ruby 时出现问题

> ID：14912843
> 
> 赞同：0
> 
> 时间：2013-02-16T17:05:53.757
> 
> 标签：ruby, apache, redmine

我试图让 Redmine 在 Ubuntu4.18 虚拟服务器上运行。我按照“ [Installation von Redmine und Git unter Ubuntu](http://raphael.kallensee.name/journal/installation-von-redmine-und-git-unter-ubuntu/) ”完成了所有需要的步骤。不幸的是，Redmine，它位于这条路径下：

```
http://lvbs46-163-79-118.dedicated.hosteurope.de/redmine/ 
```

（网址因公开而有所改变），没有做任何事情。对我来说，Ruby 似乎无法正常工作，或者无法连接到 Apache。

我尝试的是：

```
http://lvbs46-163-79-118.dedicated.hosteurope.de/redmine/info.php 
```

( `phpinfo();`) 它告诉我 Redmine 目录是可见的 (CHMOD)，并且 mod_passenger 已按照教程中的说明进行加载。

接下来，我`ruby -v`在终端中检查了 Ruby，它显示：

```
ruby 1.9.2p0 (2010-08-18 revision 29036) [x86_64-linux] 
```

但是，如果我上传一个包含内容的 Ruby 测试文件：

```
print 'Hello World!' 
```

并在我的浏览器中打开它，它只显示`"print 'Hello World!'"`. 这就是为什么我认为 Ruby 不能正常工作而 Redmine 可能也不能正常工作的原因。

我认为 apache2.conf 应该加载 Ruby，因为这些添加的行：

```
AddType application/x-httpd-php .php
AddType application/x-httpd-php-source .phps
AddType text/html .rb .rbx

LoadModule passenger_module /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.19/ext/apache2/mod_passenger.so
PassengerRoot /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.19
PassengerRuby /usr/local/bin/ruby 
```

一个补充，在 plesk 面板中是这个域的一些复选框，它们被选中：

*   X PHP 支持（运行方式）
*   X CGI 支持（cgi-bin 目录位于）
*   X Perl 支持
*   X Python 支持
*   X FastCGI 支持（Ruby on Rails 需要）

也许我的问题与启用的 FastCGI 支持有关？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T09:58:22.423

问题出在虚拟服务器本身。我重新安装了它，并且知道它似乎可以工作。

# vba - HTMLBody 属性在两台计算机上返回不同的结果

> ID：14912846
> 
> 赞同：0
> 
> 时间：2013-02-16T17:06:06.633
> 
> 标签：vba, outlook

我正在尝试通过 VBA 从电子邮件（Outlook 2010）中提取一些文本。我在我的电脑上开发，但在另一台电脑上没有得到相同的结果。事实证明，HTMLBody 属性在每台机器上都返回了不同的东西。这是每个的前几行。

从另一台计算机：

```
<html><head>
<style type="text/css"><!--  PRE  {font-family:Courier New; font-size: 9pt;}--></style></head><body><pre>
Account #xxxxxx              `

To align the following data, change the font size to 9 in Courier New.    

SALT LAKE CITY, UT                                     2013-02-15 10:00:24 EST 
```

从我的电脑：

```
<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" 
```

显然我的使用的是 Word 渲染引擎。另一个只是一个`pre`带有固定宽度文本的大标签。根据我的谷歌搜索，所有 Outlook 2010 都使用 Word 作为 HTML 呈现引擎，没有选项可以将其关闭。所以我不确定为什么我们没有得到相同的结果。

另一个人的计算机正在从外部来源获取电子邮件。我通过我们的 Exchange Server 从他那里得到它作为转发（抱歉，不知道版本）。也许他们发送的方式会有所不同。

我想让它在多台机器上工作。如果我能理解为什么他和我的不同，我想我可以调整代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T19:05:49.037

这是意料之中的 - 请记住，有 3 种消息正文：纯文本、RTF 和 HTML。根据本机主体（例如 RTF），其他两种是动态生成的。
消息格式是什么？您在[OutlookSpy](http://www.dimastr.com/outspy)中看到的 PR_BDOY、PR_HTML 和 PR_RTF_COMPRESSED 是什么（单击 IMessage）？

# java - 将子类转换为超类后调用方法的有趣行为

> ID：14912847
> 
> 赞同：2
> 
> 时间：2013-02-16T17:06:07.383
> 
> 标签：java, casting

```
class A { 
    int i = 1; 
    int f() { return i; } 
} 
class B extends A { 
    int i = 2;
    int @Override f() { return -i; }
} 
public class override_test { 
    public static void main(String args[]) { 
         B b = new B(); 
         A a = (A) b;               // Cast b to an instance of class A. 
         System.out.println(a.i);   // Now refers to A.i; prints 1; 
         System.out.println(a.f()); // Still refers to B.f(); prints -2; 
    } 
} 
```

我想知道为什么 af() 仍然指的是 Bf() 而 ai 指的是 Ai

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T17:11:40.437

在java***中字段不是多态***的，这就是为什么`a.i`指`A.i`

While`a.f()`指的是`B.f()`because`b`是一个对象 ob `B`，尽管您将其强制转换为`A`它意味着您将只能使用在 中声明的那些方法`A`。

但对象仍然是 type `B`。

因此，当您访问字段时，它基于引用类型，而当您访问方法时，它基于对象类型

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T17:09:06.077

简单的规则是当你调用一个方法时，它将是实例类型（多态性），在这种情况下实例是类型的，`B`即使引用是类型的`A`。

当您调用变量时，它将位于引用的类型上。

阅读更多关于[多态性](http://docs.oracle.com/javase/tutorial/java/IandI/polymorphism.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T17:10:36.837

就是那样子。Java 实例方法调用在 C++ 术语中是虚拟的。选择的方法取决于目标对象的实际类，而不是对它的引用的类型。字段引用不是虚拟的，字段的选择取决于引用的类型。

我通常保持字段私有或受保护，并通过方法而不是直接外部访问字段来工作

# python - 如何解析复杂的字符串

> ID：14912850
> 
> 赞同：1
> 
> 时间：2013-02-16T17:06:34.333
> 
> 标签：python, regex, parsing

我正在尝试解析以下字符串（实际上这是一个列表，无论如何......）。

```
+ title 1:
  + Main Feature
  + vts 1, ttn 1, cells 0->47 (3155896 blocks)
  + duration: 02:06:44
  + size: 720x576, pixel aspect: 64/45, display aspect: 1.78, 25.000 fps
  + autocrop: 0/0/2/0
  + chapters:
    + 1: cells 0->0, 107073 blocks, duration 00:04:06
    + 2: cells 1->1, 104931 blocks, duration 00:04:16
    + 3: cells 2->2, 43568 blocks, duration 00:01:39
    + 4: cells 3->3, 56955 blocks, duration 00:02:27
    + 5: cells 4->4, 50952 blocks, duration 00:01:50
    + 6: cells 5->5, 30214 blocks, duration 00:01:10
    + 7: cells 6->6, 35935 blocks, duration 00:01:26
    + 8: cells 7->7, 99999 blocks, duration 00:04:16
    + 9: cells 8->8, 34513 blocks, duration 00:01:23
    + 10: cells 9->9, 51879 blocks, duration 00:02:14
    + 11: cells 10->10, 43780 blocks, duration 00:01:51
    + 12: cells 11->11, 70721 blocks, duration 00:03:06
    + 13: cells 12->12, 28275 blocks, duration 00:01:06
    + 14: cells 13->13, 105788 blocks, duration 00:04:15
    + 15: cells 14->14, 66071 blocks, duration 00:02:29
    + 16: cells 15->15, 45366 blocks, duration 00:01:55
    + 17: cells 16->16, 54022 blocks, duration 00:02:12
    + 18: cells 17->17, 28551 blocks, duration 00:01:10
    + 19: cells 18->18, 72501 blocks, duration 00:02:54
    + 20: cells 19->19, 111458 blocks, duration 00:04:13
    + 21: cells 20->20, 52493 blocks, duration 00:01:58
    + 22: cells 21->21, 76352 blocks, duration 00:03:17
    + 23: cells 22->22, 72562 blocks, duration 00:03:11
    + 24: cells 23->23, 43124 blocks, duration 00:01:48
    + 25: cells 24->24, 134155 blocks, duration 00:05:01
    + 26: cells 25->25, 61777 blocks, duration 00:02:19
    + 27: cells 26->26, 61983 blocks, duration 00:02:26
    + 28: cells 27->27, 112308 blocks, duration 00:04:40
    + 29: cells 28->28, 44673 blocks, duration 00:01:32
    + 30: cells 29->29, 104886 blocks, duration 00:03:55
    + 31: cells 30->30, 53520 blocks, duration 00:02:10
    + 32: cells 31->31, 75386 blocks, duration 00:03:09
    + 33: cells 32->32, 90275 blocks, duration 00:03:36
    + 34: cells 33->33, 64572 blocks, duration 00:02:29
    + 35: cells 34->34, 26363 blocks, duration 00:01:07
    + 36: cells 35->35, 26959 blocks, duration 00:01:06
    + 37: cells 36->36, 45596 blocks, duration 00:01:49
    + 38: cells 37->37, 74188 blocks, duration 00:03:03
    + 39: cells 38->38, 31681 blocks, duration 00:01:20
    + 40: cells 39->39, 136832 blocks, duration 00:05:40
    + 41: cells 40->40, 84664 blocks, duration 00:03:32
    + 42: cells 41->41, 88245 blocks, duration 00:03:33
    + 43: cells 42->42, 79290 blocks, duration 00:03:15
    + 44: cells 43->43, 34200 blocks, duration 00:01:18
    + 45: cells 44->44, 17481 blocks, duration 00:00:43
    + 46: cells 45->45, 96702 blocks, duration 00:03:26
    + 47: cells 46->46, 34126 blocks, duration 00:01:21
    + 48: cells 47->47, 88951 blocks, duration 00:03:56
  + audio tracks:
    + 1, English (AC3) (5.1 ch) (iso639-2: eng), 48000Hz, 384000bps
    + 2, English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps
    + 3, Deutsch (AC3) (5.1 ch) (iso639-2: deu), 48000Hz, 384000bps
    + 4, English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps
  + subtitle tracks:
    + 1, English (iso639-2: eng) (Bitmap)(VOBSUB)
    + 2, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
    + 3, Italiano (iso639-2: ita) (Bitmap)(VOBSUB)
    + 4, Francais (iso639-2: fra) (Bitmap)(VOBSUB)
    + 5, Norsk (iso639-2: nor) (Bitmap)(VOBSUB)
    + 6, Dansk (iso639-2: dan) (Bitmap)(VOBSUB)
    + 7, Svenska (iso639-2: swe) (Bitmap)(VOBSUB)
    + 8, Suomi (iso639-2: fin) (Bitmap)(VOBSUB)
    + 9, Polish (iso639-2: pol) (Bitmap)(VOBSUB)
    + 10, Czech (iso639-2: ces) (Bitmap)(VOBSUB)
    + 11, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
+ title 2:
  + vts 1, ttn 2, cells 0->0 (4259 blocks)
  + duration: 00:00:12
  + size: 720x576, pixel aspect: 64/45, display aspect: 1.78, 25.000 fps
  + autocrop: 8/0/0/2
  + chapters:
    + 1: cells 0->0, 4259 blocks, duration 00:00:12
  + audio tracks:
    + 1, English (AC3) (5.1 ch) (iso639-2: eng), 48000Hz, 384000bps
    + 2, English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps
    + 3, Deutsch (AC3) (5.1 ch) (iso639-2: deu), 48000Hz, 384000bps
    + 4, English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps
  + subtitle tracks:
    + 1, English (iso639-2: eng) (Bitmap)(VOBSUB)
    + 2, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
    + 3, Italiano (iso639-2: ita) (Bitmap)(VOBSUB)
    + 4, Francais (iso639-2: fra) (Bitmap)(VOBSUB)
    + 5, Norsk (iso639-2: nor) (Bitmap)(VOBSUB)
    + 6, Dansk (iso639-2: dan) (Bitmap)(VOBSUB)
    + 7, Svenska (iso639-2: swe) (Bitmap)(VOBSUB)
    + 8, Suomi (iso639-2: fin) (Bitmap)(VOBSUB)
    + 9, Polish (iso639-2: pol) (Bitmap)(VOBSUB)
    + 10, Czech (iso639-2: ces) (Bitmap)(VOBSUB)
    + 11, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
+ title 3:
  + vts 1, ttn 3, cells 0->0 (37474 blocks)
  + duration: 00:01:51
  + size: 720x576, pixel aspect: 64/45, display aspect: 1.78, 25.000 fps
  + autocrop: 0/0/2/2
  + chapters:
    + 1: cells 0->0, 37474 blocks, duration 00:01:51
  + audio tracks:
    + 1, English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps
  + subtitle tracks:
    + 1, English (iso639-2: eng) (Bitmap)(VOBSUB)
    + 2, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
    + 3, Italiano (iso639-2: ita) (Bitmap)(VOBSUB)
    + 4, Francais (iso639-2: fra) (Bitmap)(VOBSUB)
    + 5, Norsk (iso639-2: nor) (Bitmap)(VOBSUB)
    + 6, Dansk (iso639-2: dan) (Bitmap)(VOBSUB)
    + 7, Svenska (iso639-2: swe) (Bitmap)(VOBSUB)
    + 8, Suomi (iso639-2: fin) (Bitmap)(VOBSUB)
    + 9, Polish (iso639-2: pol) (Bitmap)(VOBSUB)
    + 10, Czech (iso639-2: ces) (Bitmap)(VOBSUB)
    + 11, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
+ title 4:
  + vts 2, ttn 1, cells 0->0 (6817 blocks)
  + duration: 00:00:19
  + size: 720x576, pixel aspect: 16/15, display aspect: 1.33, 25.000 fps
  + autocrop: 4/0/12/0
  + chapters:
    + 1: cells 0->0, 6817 blocks, duration 00:00:19
  + audio tracks:
    + 1, English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps
  + subtitle tracks:
    + 1, English (iso639-2: eng) (Bitmap)(VOBSUB)
    + 2, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
    + 3, Italiano (iso639-2: ita) (Bitmap)(VOBSUB)
    + 4, Francais (iso639-2: fra) (Bitmap)(VOBSUB)
    + 5, Norsk (iso639-2: nor) (Bitmap)(VOBSUB)
    + 6, Dansk (iso639-2: dan) (Bitmap)(VOBSUB)
    + 7, Svenska (iso639-2: swe) (Bitmap)(VOBSUB)
    + 8, Suomi (iso639-2: fin) (Bitmap)(VOBSUB)
    + 9, Polish (iso639-2: pol) (Bitmap)(VOBSUB)
    + 10, Czech (iso639-2: ces) (Bitmap)(VOBSUB)
    + 11, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
+ title 5:
  + vts 2, ttn 2, cells 0->0 (12051 blocks)
  + duration: 00:00:34
  + size: 720x576, pixel aspect: 16/15, display aspect: 1.33, 25.000 fps
  + autocrop: 0/0/10/0
  + chapters:
    + 1: cells 0->0, 12051 blocks, duration 00:00:34
  + audio tracks:
    + 1, English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps
  + subtitle tracks:
    + 1, English (iso639-2: eng) (Bitmap)(VOBSUB)
    + 2, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
    + 3, Italiano (iso639-2: ita) (Bitmap)(VOBSUB)
    + 4, Francais (iso639-2: fra) (Bitmap)(VOBSUB)
    + 5, Norsk (iso639-2: nor) (Bitmap)(VOBSUB)
    + 6, Dansk (iso639-2: dan) (Bitmap)(VOBSUB)
    + 7, Svenska (iso639-2: swe) (Bitmap)(VOBSUB)
    + 8, Suomi (iso639-2: fin) (Bitmap)(VOBSUB)
    + 9, Polish (iso639-2: pol) (Bitmap)(VOBSUB)
    + 10, Czech (iso639-2: ces) (Bitmap)(VOBSUB)
    + 11, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
+ title 6:
  + vts 2, ttn 3, cells 0->0 (12246 blocks)
  + duration: 00:00:35
  + size: 720x576, pixel aspect: 16/15, display aspect: 1.33, 25.000 fps
  + autocrop: 78/80/6/4
  + chapters:
    + 1: cells 0->0, 12246 blocks, duration 00:00:35
  + audio tracks:
    + 1, English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps
  + subtitle tracks:
    + 1, English (iso639-2: eng) (Bitmap)(VOBSUB)
    + 2, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
    + 3, Italiano (iso639-2: ita) (Bitmap)(VOBSUB)
    + 4, Francais (iso639-2: fra) (Bitmap)(VOBSUB)
    + 5, Norsk (iso639-2: nor) (Bitmap)(VOBSUB)
    + 6, Dansk (iso639-2: dan) (Bitmap)(VOBSUB)
    + 7, Svenska (iso639-2: swe) (Bitmap)(VOBSUB)
    + 8, Suomi (iso639-2: fin) (Bitmap)(VOBSUB)
    + 9, Polish (iso639-2: pol) (Bitmap)(VOBSUB)
    + 10, Czech (iso639-2: ces) (Bitmap)(VOBSUB)
    + 11, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
+ title 7:
  + vts 2, ttn 4, cells 0->0 (11983 blocks)
  + duration: 00:00:34
  + size: 720x576, pixel aspect: 16/15, display aspect: 1.33, 25.000 fps
  + autocrop: 78/80/8/4
  + chapters:
    + 1: cells 0->0, 11983 blocks, duration 00:00:34
  + audio tracks:
    + 1, English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps
  + subtitle tracks:
    + 1, English (iso639-2: eng) (Bitmap)(VOBSUB)
    + 2, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
    + 3, Italiano (iso639-2: ita) (Bitmap)(VOBSUB)
    + 4, Francais (iso639-2: fra) (Bitmap)(VOBSUB)
    + 5, Norsk (iso639-2: nor) (Bitmap)(VOBSUB)
    + 6, Dansk (iso639-2: dan) (Bitmap)(VOBSUB)
    + 7, Svenska (iso639-2: swe) (Bitmap)(VOBSUB)
    + 8, Suomi (iso639-2: fin) (Bitmap)(VOBSUB)
    + 9, Polish (iso639-2: pol) (Bitmap)(VOBSUB)
    + 10, Czech (iso639-2: ces) (Bitmap)(VOBSUB)
    + 11, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
+ title 8:
  + vts 2, ttn 5, cells 0->0 (34523 blocks)
  + duration: 00:01:37
  + size: 720x576, pixel aspect: 16/15, display aspect: 1.33, 25.000 fps
  + autocrop: 0/0/10/8
  + chapters:
    + 1: cells 0->0, 34523 blocks, duration 00:01:37
  + audio tracks:
    + 1, English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps
  + subtitle tracks:
    + 1, English (iso639-2: eng) (Bitmap)(VOBSUB)
    + 2, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)
    + 3, Italiano (iso639-2: ita) (Bitmap)(VOBSUB)
    + 4, Francais (iso639-2: fra) (Bitmap)(VOBSUB)
    + 5, Norsk (iso639-2: nor) (Bitmap)(VOBSUB)
    + 6, Dansk (iso639-2: dan) (Bitmap)(VOBSUB)
    + 7, Svenska (iso639-2: swe) (Bitmap)(VOBSUB)
    + 8, Suomi (iso639-2: fin) (Bitmap)(VOBSUB)
    + 9, Polish (iso639-2: pol) (Bitmap)(VOBSUB)
    + 10, Czech (iso639-2: ces) (Bitmap)(VOBSUB)
    + 11, Deutsch (iso639-2: deu) (Bitmap)(VOBSUB) 
```

我想在这里使用 re 但也许有一个简单的解决方案？我的大脑今天看到了太多的代码。

如果所有信息都存储在单个 dict() 中，那将是最好的

```
{'title1': 
    {'duration': '02:06:44', 
     'audio_tracks': 
         [{'1': 'English (AC3) (5.1 ch) (iso639-2: eng), 48000Hz, 384000bps' },
         {'2': 'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps' },
         ...]},
     'subtitle_tracks':
         [{'1': 'English (iso639-2: eng) (Bitmap)(VOBSUB)' },
         {'2': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)' },
         ...]},
     }
} 
```

像这样的东西。也许有人有一些提示如何解析：

```
+ something:
    + some: info,
    + something:,
        + 1: indented information 
```

事物？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T17:35:46.677

我有这个用于各种目的的缩进文本解析器。在这里，我将其调整为 ffmpeg 格式：

```
import sys
import re

root = ['root', []]
path = [root]
last_indent = -1
for line in sys.stdin:
    line = line.rstrip()
    if not line:
        break

    # calculate indent
    iline = line
    line = line.lstrip(' ')
    indent = (len(iline) - len(line))/2

    line = line.lstrip('+ ')
    bits = re.split('[:,]', line, 1)
    key = bits[0]
    try:
        content = bits[1].strip()
    except IndexError:
        content = None

    if not content:
        # root node
        content = []

    if indent <= last_indent:
        del path[indent - last_indent - 1:]
    cur = [key, content]
    path[-1][-1].append(cur)
    path.append(cur)
    last_indent = indent

pprint(root) 
```

输出：

```
['root',
 [['title 1',
   [['Main Feature', []],
    ['vts 1', 'ttn 1, cells 0->47 (3155896 blocks)'],
    ['duration', '02:06:44'],
    ['size',
     '720x576, pixel aspect: 64/45, display aspect: 1.78, 25.000 fps'],
    ['autocrop', '0/0/2/0'],
    ['chapters',
     [['1', 'cells 0->0, 107073 blocks, duration 00:04:06'],
      ['2', 'cells 1->1, 104931 blocks, duration 00:04:16'],
      ['3', 'cells 2->2, 43568 blocks, duration 00:01:39'],
      ['4', 'cells 3->3, 56955 blocks, duration 00:02:27'],
      ['5', 'cells 4->4, 50952 blocks, duration 00:01:50'],
      ['6', 'cells 5->5, 30214 blocks, duration 00:01:10'],
      ['7', 'cells 6->6, 35935 blocks, duration 00:01:26'],
      ['8', 'cells 7->7, 99999 blocks, duration 00:04:16'],
      ['9', 'cells 8->8, 34513 blocks, duration 00:01:23'],
      ['10', 'cells 9->9, 51879 blocks, duration 00:02:14'],
      ['11', 'cells 10->10, 43780 blocks, duration 00:01:51'],
      ['12', 'cells 11->11, 70721 blocks, duration 00:03:06'],
      ['13', 'cells 12->12, 28275 blocks, duration 00:01:06'],
      ['14', 'cells 13->13, 105788 blocks, duration 00:04:15'],
      ['15', 'cells 14->14, 66071 blocks, duration 00:02:29'],
      ['16', 'cells 15->15, 45366 blocks, duration 00:01:55'],
      ['17', 'cells 16->16, 54022 blocks, duration 00:02:12'],
      ['18', 'cells 17->17, 28551 blocks, duration 00:01:10'],
      ['19', 'cells 18->18, 72501 blocks, duration 00:02:54'],
      ['20', 'cells 19->19, 111458 blocks, duration 00:04:13'],
      ['21', 'cells 20->20, 52493 blocks, duration 00:01:58'],
      ['22', 'cells 21->21, 76352 blocks, duration 00:03:17'],
      ['23', 'cells 22->22, 72562 blocks, duration 00:03:11'],
      ['24', 'cells 23->23, 43124 blocks, duration 00:01:48'],
      ['25', 'cells 24->24, 134155 blocks, duration 00:05:01'],
      ['26', 'cells 25->25, 61777 blocks, duration 00:02:19'],
      ['27', 'cells 26->26, 61983 blocks, duration 00:02:26'],
      ['28', 'cells 27->27, 112308 blocks, duration 00:04:40'],
      ['29', 'cells 28->28, 44673 blocks, duration 00:01:32'],
      ['30', 'cells 29->29, 104886 blocks, duration 00:03:55'],
      ['31', 'cells 30->30, 53520 blocks, duration 00:02:10'],
      ['32', 'cells 31->31, 75386 blocks, duration 00:03:09'],
      ['33', 'cells 32->32, 90275 blocks, duration 00:03:36'],
      ['34', 'cells 33->33, 64572 blocks, duration 00:02:29'],
      ['35', 'cells 34->34, 26363 blocks, duration 00:01:07'],
      ['36', 'cells 35->35, 26959 blocks, duration 00:01:06'],
      ['37', 'cells 36->36, 45596 blocks, duration 00:01:49'],
      ['38', 'cells 37->37, 74188 blocks, duration 00:03:03'],
      ['39', 'cells 38->38, 31681 blocks, duration 00:01:20'],
      ['40', 'cells 39->39, 136832 blocks, duration 00:05:40'],
      ['41', 'cells 40->40, 84664 blocks, duration 00:03:32'],
      ['42', 'cells 41->41, 88245 blocks, duration 00:03:33'],
      ['43', 'cells 42->42, 79290 blocks, duration 00:03:15'],
      ['44', 'cells 43->43, 34200 blocks, duration 00:01:18'],
      ['45', 'cells 44->44, 17481 blocks, duration 00:00:43'],
      ['46', 'cells 45->45, 96702 blocks, duration 00:03:26'],
      ['47', 'cells 46->46, 34126 blocks, duration 00:01:21'],
      ['48', 'cells 47->47, 88951 blocks, duration 00:03:56']]],
    ['audio tracks',
     [['1', 'English (AC3) (5.1 ch) (iso639-2: eng), 48000Hz, 384000bps'],
      ['2',
       'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps'],
      ['3', 'Deutsch (AC3) (5.1 ch) (iso639-2: deu), 48000Hz, 384000bps'],
      ['4',
       'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps']]],
    ['subtitle tracks',
     [['1', 'English (iso639-2: eng) (Bitmap)(VOBSUB)'],
      ['2', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)'],
      ['3', 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)'],
      ['4', 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)'],
      ['5', 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)'],
      ['6', 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)'],
      ['7', 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)'],
      ['8', 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)'],
      ['9', 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'],
      ['10', 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)'],
      ['11', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)']]]]],
  ['title 2',
   [['vts 1', 'ttn 2, cells 0->0 (4259 blocks)'],
    ['duration', '00:00:12'],
    ['size',
     '720x576, pixel aspect: 64/45, display aspect: 1.78, 25.000 fps'],
    ['autocrop', '8/0/0/2'],
    ['chapters', [['1', 'cells 0->0, 4259 blocks, duration 00:00:12']]],
    ['audio tracks',
     [['1', 'English (AC3) (5.1 ch) (iso639-2: eng), 48000Hz, 384000bps'],
      ['2',
       'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps'],
      ['3', 'Deutsch (AC3) (5.1 ch) (iso639-2: deu), 48000Hz, 384000bps'],
      ['4',
       'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps']]],
    ['subtitle tracks',
     [['1', 'English (iso639-2: eng) (Bitmap)(VOBSUB)'],
      ['2', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)'],
      ['3', 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)'],
      ['4', 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)'],
      ['5', 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)'],
      ['6', 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)'],
      ['7', 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)'],
      ['8', 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)'],
      ['9', 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'],
      ['10', 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)'],
      ['11', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)']]]]],
  ['title 3',
   [['vts 1', 'ttn 3, cells 0->0 (37474 blocks)'],
    ['duration', '00:01:51'],
    ['size',
     '720x576, pixel aspect: 64/45, display aspect: 1.78, 25.000 fps'],
    ['autocrop', '0/0/2/2'],
    ['chapters', [['1', 'cells 0->0, 37474 blocks, duration 00:01:51']]],
    ['audio tracks',
     [['1',
       'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps']]],
    ['subtitle tracks',
     [['1', 'English (iso639-2: eng) (Bitmap)(VOBSUB)'],
      ['2', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)'],
      ['3', 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)'],
      ['4', 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)'],
      ['5', 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)'],
      ['6', 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)'],
      ['7', 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)'],
      ['8', 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)'],
      ['9', 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'],
      ['10', 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)'],
      ['11', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)']]]]],
  ['title 4',
   [['vts 2', 'ttn 1, cells 0->0 (6817 blocks)'],
    ['duration', '00:00:19'],
    ['size',
     '720x576, pixel aspect: 16/15, display aspect: 1.33, 25.000 fps'],
    ['autocrop', '4/0/12/0'],
    ['chapters', [['1', 'cells 0->0, 6817 blocks, duration 00:00:19']]],
    ['audio tracks',
     [['1',
       'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps']]],
    ['subtitle tracks',
     [['1', 'English (iso639-2: eng) (Bitmap)(VOBSUB)'],
      ['2', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)'],
      ['3', 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)'],
      ['4', 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)'],
      ['5', 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)'],
      ['6', 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)'],
      ['7', 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)'],
      ['8', 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)'],
      ['9', 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'],
      ['10', 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)'],
      ['11', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)']]]]],
  ['title 5',
   [['vts 2', 'ttn 2, cells 0->0 (12051 blocks)'],
    ['duration', '00:00:34'],
    ['size',
     '720x576, pixel aspect: 16/15, display aspect: 1.33, 25.000 fps'],
    ['autocrop', '0/0/10/0'],
    ['chapters', [['1', 'cells 0->0, 12051 blocks, duration 00:00:34']]],
    ['audio tracks',
     [['1',
       'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps']]],
    ['subtitle tracks',
     [['1', 'English (iso639-2: eng) (Bitmap)(VOBSUB)'],
      ['2', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)'],
      ['3', 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)'],
      ['4', 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)'],
      ['5', 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)'],
      ['6', 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)'],
      ['7', 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)'],
      ['8', 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)'],
      ['9', 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'],
      ['10', 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)'],
      ['11', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)']]]]],
  ['title 6',
   [['vts 2', 'ttn 3, cells 0->0 (12246 blocks)'],
    ['duration', '00:00:35'],
    ['size',
     '720x576, pixel aspect: 16/15, display aspect: 1.33, 25.000 fps'],
    ['autocrop', '78/80/6/4'],
    ['chapters', [['1', 'cells 0->0, 12246 blocks, duration 00:00:35']]],
    ['audio tracks',
     [['1',
       'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps']]],
    ['subtitle tracks',
     [['1', 'English (iso639-2: eng) (Bitmap)(VOBSUB)'],
      ['2', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)'],
      ['3', 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)'],
      ['4', 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)'],
      ['5', 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)'],
      ['6', 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)'],
      ['7', 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)'],
      ['8', 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)'],
      ['9', 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'],
      ['10', 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)'],
      ['11', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)']]]]],
  ['title 7',
   [['vts 2', 'ttn 4, cells 0->0 (11983 blocks)'],
    ['duration', '00:00:34'],
    ['size',
     '720x576, pixel aspect: 16/15, display aspect: 1.33, 25.000 fps'],
    ['autocrop', '78/80/8/4'],
    ['chapters', [['1', 'cells 0->0, 11983 blocks, duration 00:00:34']]],
    ['audio tracks',
     [['1',
       'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps']]],
    ['subtitle tracks',
     [['1', 'English (iso639-2: eng) (Bitmap)(VOBSUB)'],
      ['2', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)'],
      ['3', 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)'],
      ['4', 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)'],
      ['5', 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)'],
      ['6', 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)'],
      ['7', 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)'],
      ['8', 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)'],
      ['9', 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'],
      ['10', 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)'],
      ['11', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)']]]]],
  ['title 8',
   [['vts 2', 'ttn 5, cells 0->0 (34523 blocks)'],
    ['duration', '00:01:37'],
    ['size',
     '720x576, pixel aspect: 16/15, display aspect: 1.33, 25.000 fps'],
    ['autocrop', '0/0/10/8'],
    ['chapters', [['1', 'cells 0->0, 34523 blocks, duration 00:01:37']]],
    ['audio tracks',
     [['1',
       'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps']]],
    ['subtitle tracks',
     [['1', 'English (iso639-2: eng) (Bitmap)(VOBSUB)'],
      ['2', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)'],
      ['3', 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)'],
      ['4', 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)'],
      ['5', 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)'],
      ['6', 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)'],
      ['7', 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)'],
      ['8', 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)'],
      ['9', 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'],
      ['10', 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)'],
      ['11', 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)']]]]]]] 
```

您必须针对所需的输出对其进行调整，但这应该给您一个开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T09:16:05.623

[http://ffmpeg.org/ffprobe.html](http://ffmpeg.org/ffprobe.html)和[https://reviews.handbrake.fr/r/224/](https://reviews.handbrake.fr/r/224/)都解决了。

所以我想出了自己的解析算法。在这里（**l 必须是一个 list() - 只需将 Handbrake 输出除以 '\n'**）：

# 解析 HandBrakeCLI 输出

```
def getHandBrakeInformation(l):
    currentTitle = None
    titleDict = {}
    returnDict = {}
    for line in l:
        if line.startswith('+ title'):
            titleNum = line.rstrip(':').split(' ')
            currentTitle = "%s_%s" % (titleNum[1], titleNum[2])
            titleDict[currentTitle] = []
            returnDict[currentTitle] = {}
        else:
            titleDict[currentTitle].append(line[2:])

    currentTrack = None
    for title in titleDict:
        for key in titleDict[title]:
            if key.startswith('+ duration:'):
                duration = key.split(' ')
                duration = duration[2]
                returnDict[title]['duration'] = duration
                titleDict[title].remove(key)
            elif key.startswith('+ audio') or key.startswith('+ subtitle'):
                currentTrack = key[2:-1].replace(' ', '_')
                returnDict[title][currentTrack] = {}
            elif currentTrack is not None and not key.startswith('+'):
                currentTrackValueSplit = key[4:].split(',', 1)
                returnDict[title][currentTrack][currentTrackValueSplit[0].strip()] = currentTrackValueSplit[1].strip()
            else:
                currentTrack = None
    return returnDict 
```

这里是输出：

```
{'title_1': {'audio_tracks': {'1': 'English (AC3) (5.1 ch) (iso639-2: eng), 48000Hz, 384000bps',
   '2': 'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps',
   '3': 'Deutsch (AC3) (5.1 ch) (iso639-2: deu), 48000Hz, 384000bps',
   '4': 'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps'},
  'duration': '02:06:44',
  'subtitle_tracks': {'1': 'English (iso639-2: eng) (Bitmap)(VOBSUB)',
   '10': 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)',
   '11': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '2': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '3': 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)',
   '4': 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)',
   '5': 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)',
   '6': 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)',
   '7': 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)',
   '8': 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)',
   '9': 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'}},
 'title_2': {'audio_tracks': {'1': 'English (AC3) (5.1 ch) (iso639-2: eng), 48000Hz, 384000bps',
   '2': 'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps',
   '3': 'Deutsch (AC3) (5.1 ch) (iso639-2: deu), 48000Hz, 384000bps',
   '4': 'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps'},
  'duration': '00:00:12',
  'subtitle_tracks': {'1': 'English (iso639-2: eng) (Bitmap)(VOBSUB)',
   '10': 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)',
   '11': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '2': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '3': 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)',
   '4': 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)',
   '5': 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)',
   '6': 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)',
   '7': 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)',
   '8': 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)',
   '9': 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'}},
 'title_3': {'audio_tracks': {'1': 'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps'},
  'duration': '00:01:51',
  'subtitle_tracks': {'1': 'English (iso639-2: eng) (Bitmap)(VOBSUB)',
   '10': 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)',
   '11': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '2': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '3': 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)',
   '4': 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)',
   '5': 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)',
   '6': 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)',
   '7': 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)',
   '8': 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)',
   '9': 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'}},
 'title_4': {'audio_tracks': {'1': 'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps'},
  'duration': '00:00:19',
  'subtitle_tracks': {'1': 'English (iso639-2: eng) (Bitmap)(VOBSUB)',
   '10': 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)',
   '11': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '2': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '3': 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)',
   '4': 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)',
   '5': 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)',
   '6': 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)',
   '7': 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)',
   '8': 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)',
   '9': 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'}},
 'title_5': {'audio_tracks': {'1': 'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps'},
  'duration': '00:00:34',
  'subtitle_tracks': {'1': 'English (iso639-2: eng) (Bitmap)(VOBSUB)',
   '10': 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)',
   '11': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '2': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '3': 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)',
   '4': 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)',
   '5': 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)',
   '6': 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)',
   '7': 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)',
   '8': 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)',
   '9': 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'}},
 'title_6': {'audio_tracks': {'1': 'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps'},
  'duration': '00:00:35',
  'subtitle_tracks': {'1': 'English (iso639-2: eng) (Bitmap)(VOBSUB)',
   '10': 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)',
   '11': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '2': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '3': 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)',
   '4': 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)',
   '5': 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)',
   '6': 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)',
   '7': 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)',
   '8': 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)',
   '9': 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'}},
 'title_7': {'audio_tracks': {'1': 'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps'},
  'duration': '00:00:34',
  'subtitle_tracks': {'1': 'English (iso639-2: eng) (Bitmap)(VOBSUB)',
   '10': 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)',
   '11': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '2': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '3': 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)',
   '4': 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)',
   '5': 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)',
   '6': 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)',
   '7': 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)',
   '8': 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)',
   '9': 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'}},
 'title_8': {'audio_tracks': {'1': 'English (AC3) (Dolby Surround) (iso639-2: eng), 48000Hz, 192000bps'},
  'duration': '00:01:37',
  'subtitle_tracks': {'1': 'English (iso639-2: eng) (Bitmap)(VOBSUB)',
   '10': 'Czech (iso639-2: ces) (Bitmap)(VOBSUB)',
   '11': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '2': 'Deutsch (iso639-2: deu) (Bitmap)(VOBSUB)',
   '3': 'Italiano (iso639-2: ita) (Bitmap)(VOBSUB)',
   '4': 'Francais (iso639-2: fra) (Bitmap)(VOBSUB)',
   '5': 'Norsk (iso639-2: nor) (Bitmap)(VOBSUB)',
   '6': 'Dansk (iso639-2: dan) (Bitmap)(VOBSUB)',
   '7': 'Svenska (iso639-2: swe) (Bitmap)(VOBSUB)',
   '8': 'Suomi (iso639-2: fin) (Bitmap)(VOBSUB)',
   '9': 'Polish (iso639-2: pol) (Bitmap)(VOBSUB)'}}} 
```

# java - 在 HTML javascript 中检索 JSON

> ID：14912853
> 
> 赞同：0
> 
> 时间：2013-02-16T17:07:18.297
> 
> 标签：java, javascript, servlets, struts, struts-1

我在我的应用程序中使用 Struts 1.2。

**我想要达到的目标：**

1) 使用 javascript 向操作发送 ajax 请求 2) 返回 JSON 对象作为操作的响应 3) 在 javascript 中检索和解析 JSON 响应 4) 使用该值。

我完成了前两个步骤，但对第三个步骤（检索 JSON）感到震惊：

**Javascript代码：**

```
function getTransactionId(transactionId){

        var xhr = new XMLHttpRequest();
         xhr.onreadystatechange = function(){               

         if(xhr.readyState == 4){               

            if(xhr.status == 200){
                alert(xhr.responseText);
                //var p = JSON.parse(xhr.responseText);
                //alert(p);
            }
         }
        }; 
        xhr.open("POST", "returnMedia.do?transactionId=" + transactionId, true);  
        xhr.send(null); 

    } 
```

**操作代码：**

```
String actualReturnDateJSON = new Gson().toJson(actualReturnDateMap);       
System.out.println(actualReturnDateJSON);
response.setContentType("application/json");
response.setCharacterEncoding("UTF-8");
response.getWriter().print(actualReturnDateJSON); 
```

当我在控制台中打印 JSON 值时，我得到了正确的格式，如下所示：`{"02-19-2013":"02-19-2013"}`

但是当我在javascript中尝试这个时：

```
if(xhr.status == 200){
                alert(xhr.responseText);
                //var p = JSON.parse(xhr.responseText);
                //alert(p);
            } 
```

我没有得到之前在控制台中打印的 JSON 值，即`{"02-19-2013":"02-19-2013"}`. 不幸的是，这个警告声明向我展示了整个 HTML 文件

请让我知道出了什么问题:(

谢谢，

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-16T17:39:31.237

更简洁的方法是使用 struts2-json-plugin 并让框架为您完成提升

```
 <package name="default" namespace="/" extends="json-default">
      <action name="getTransactionId" 
           class="your action class">
           <result type="json" />
      </action>
    </package> 
```

而且你不需要在你的动作类中干预响应对象和 GSON，映射会处理它。

[Struts 2 和 JSON 示例](http://www.mkyong.com/struts2/struts-2-and-json-example/)

# javascript - 在页面加载时使用 jquery 在新选项卡中打开一个 url

> ID：14912855
> 
> 赞同：-1
> 
> 时间：2013-02-16T17:07:35.253
> 
> 标签：javascript, jquery

**在页面加载时使用 jquery 在新选项卡中打开一个 url** 我希望打开一个新选项卡在某些页面加载时加载一个 url。

我正在尝试类似的东西

```
<a href="[SOME_URL]" id="new_lnk_opener" target="_blank">New Tab</a>
<script type="text/javascript">
   $(document).ready(function() {
    $('#new_lnk_opener').trigger('click');      
   });
    </script> 
```

但它不起作用。不触发点击事件。我可以使用 Javascript 的“打开”功能来做到这一点。但我不想使用它，因为它被大多数浏览器阻止。

我想要的是自动触发链接上的 jquery 点击事件并打开一个新窗口/标签。

发送一些代码或建议。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:11:39.283

您不能直接控制它，因为它可以由用户配置。您不应该依赖打开的新选项卡。用户可以将他们的浏览器设置设置为在打开弹出窗口时打开新选项卡，或者它可能显示为弹出窗口。这完全取决于浏览器设置。

**编辑：**

[此处](http://www.paulsilver.co.uk/code/html_working_popup.php)提供了具有一些限制的解决方法。

# delphi - 解决项目未取消选择的 TActionMainMenuBar 绘画错误

> ID：14912858
> 
> 赞同：5
> 
> 时间：2013-02-16T17:07:49.153
> 
> 标签：delphi, menu, tactionmanager

TActionMainMenuBar 存在绘制没有子项的根元素的错误。

使用 Delphi XE2 / w7-32bit**

如何重现：
使用 TActionMainMenuBar 构建菜单，向其中添加一些操作：

```
 file  | options | help
 - New
 - Open
 - Save
  -Exit 
```

为所有操作分配一个空方法

```
procedure TfrmMain.ActionExecute(Sender: TObject); 
begin 
// 
end; 
```

现在运行应用程序并尝试单击选项或帮助元素。
现在单击表单，但仍然按下菜单元素！

存在任何解决方法吗？

upd：看截图，菜单元素向下，但鼠标光标不在菜单上，自动检查为假，检查也是假的。
![在此处输入图像描述](../Images/edd1a48805ee539542881ad1a7bea26f.png)
这里表单上没有任何颜色图，管理器样式是平台默认值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T17:53:23.287

这是我的解决方法：
像这样创建自定义类：

```
 type
  TFastThemedButton = class(TThemedMenuButton)
  protected
    procedure DrawBackground(var PaintRect: TRect); override;
end; 
```

...

```
 procedure TFastThemedButton.DrawBackground(var PaintRect: TRect);
const
  MenuStates: array[Boolean {MouseInControl}, Boolean {Selected}] of TThemedMenu =
    ((tmMenuBarItemNormal, tmMenuBarItemPushed), (tmMenuBarItemHot, tmMenuBarItemPushed));
var
  BannerRect: TRect;
  StartCol, EndCol: TColor;
begin
   Canvas.Brush.Color := ActionBar.ColorMap.Color;
   Canvas.Font := ActionBar.Font;
   StyleServices.DrawElement(Canvas.Handle, StyleServices.GetElementDetails(MenuStates[MouseInControl, (State=bsDown)]), PaintRect);
end;
```

现在在你的 TActionMainMenuBar.OnGetControlClass 添加这个简单的代码，并设置为 buggy actionclients tag=-100

```
 procedure TfrmActions.ActionMainMenuBar1GetControlClass(Sender: TCustomActionBar; AnItem: TActionClient; var ControlClass: TCustomActionControlClass);
begin
  if ControlClass.InheritsFrom(TCustomMenuButton) and then
   begin
    if (AnItem.Tag =-100) and (ControlClass = TThemedMenuButton) then
      ControlClass := TFastThemedButton;
   end;
end;
```

好吧，现在所有带有 -100 标签的根项目都可以按我们的意愿工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-21T15:47:41.570

我在所有带有菜单的表单上使用带有 MainMenu.RecreateControls 的事件 MainMenuExitMenuLoop。到目前为止，这从菜单项中删除了卡住的选择。

# java - 如何正确确定锁的范围

> ID：14912860
> 
> 赞同：1
> 
> 时间：2013-02-16T17:07:52.217
> 
> 标签：java, scope, reentrantlock

假设我有一个`ReentrantLock`，

```
ReentrantLock foo = new ReentrantLock(); 
```

以及`bar`使用锁的方法，

```
public void bar()
{
    foo.lock();

    try
    {
        methodOne();
    }
    finally
    {
        foo.unlock();
    }
} 
```

并`methodOne`调用一个`methodTwo`也使用锁的方法，

```
public void methodTwo()
{
    foo.lock();

    try
    {
        // do something
    }
    finally
    {
        foo.unlock();
    }
} 
```

`bar`在我打电话之前释放锁定会更好`methodOne`吗？一般来说，在调用另一个方法之前释放锁是一种好习惯吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T17:47:41.143

不，你不应该那样做。如果你这样做，任何并发线程都可以在`bar()`方法中间获取锁，这正是你想要通过使用锁来避免的。

之所以称为 ReentrantLock 正是因为它允许在同一个线程中多次获取锁。每次调用计数器都会递增，每次`lock()`调用都会递减`unlock()`，因此您只需要确保`unlock()`始终在 finally 块中调用。

请注意，只需使用同步块，代码就不会那么脆弱，因为不可能忘记关闭同步块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T18:31:33.073

当锁“保护”的关键操作完成时释放锁。不早于。

# java - 我可以避免使用堆叠的 if 语句吗

> ID：14912863
> 
> 赞同：1
> 
> 时间：2013-02-16T17:07:59.263
> 
> 标签：java, if-statement

我正在编写一个程序，该程序对访问者数量等设置了上限。如果达到上限，则默认并打印，即您已达到成人容量。

我正在寻找一种方法来缩短我的代码而不是使用堆叠的 if 语句（我现在正在使用它。我对此很陌生，我希望有一种方法可以通过实现以下内容来做到这一点？但我不是相当了解如何让它识别和`System.out.print`细节。

```
if (childCount >= CHILD_LIMIT || adultCount >= ADULT_LIMIT 
  || seniorCount >= SENIOR_LIMIT || totalPeople >= TOT_LIMIT || totalMoney >= GRAND_AMT) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:13:16.650

如果您尝试针对不同的条件打印不同的语句，则应使用单独的`if`语句：

```
boolean error = false;
if(childCount >= CHILD_LIMIT) {
    System.out.println("You have reached child capacity");
    error = true;
}
if(adultCount >= ADULT_LIMIT) {
    System.out.println("You have reached adult capacity");
    error = true;
}
...
if(error) {
    /* error occurred, don't process input normally */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T17:20:43.513

可以维持 3`List`秒。

一是知道你在比较什么，二是持有价值，三是持有上限。

然后您可以使用循环遍历第一个列表，`for`然后在其中放置一个`if`条件，比较其他两个列表中的值。

并在部件中加入a`break`以`else`增加短路的效果。

# python - 按介数排序时igraph python的速度

> ID：14912864
> 
> 赞同：0
> 
> 时间：2013-02-16T17:08:01.403
> 
> 标签：python, performance, igraph

我在给定的图表中多次执行以下计算。我取一个连接的组件，然后按介数对作者进行排序。

ordered_authors = sorted(Author_graph.vs.select(component),k​​ey = lambda x:x.betweenness(), reverse = True)

我的基本问题是：“igraph 是否每次执行此计算时都会计算顶点 x 的介数？或者，假设我已经计算了整个图的整个介数列表。然后 igraph 是否引用该列表以执行这些本地操作计算？

根据答案，这个本地计算将成为我正在运行的更大程序中的瓶颈（或不是）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T17:45:54.113

是的，这将在您每次进行此计算时计算介数。更好的方法是提前计算所有顶点的介数：

```
scores = Author_graph.betweenness()
ordered_authors = sorted(Author_graph.vs.select(component), key = lambda x: scores[x.index], reverse=True) 
```

# encoding - 在 Windows 应用商店应用程序中录制 FLAC 音频

> ID：14912869
> 
> 赞同：1
> 
> 时间：2013-02-16T17:08:27.153
> 
> 标签：encoding, windows-store-apps, audio-recording, flac

我正在编写一个 Windows 应用商店应用程序（Metro 应用程序），我需要能够在其中录制 FLAC 格式的声音。根据我在 MS 的信息（[http://msdn.microsoft.com/en-gb/library/windows/apps/hh452798.aspx](http://msdn.microsoft.com/en-gb/library/windows/apps/hh452798.aspx)）中看到的，有一些预定义的编码配置文件：

*   AAC 音频 (M4A)
*   MP3 音频
*   Windows 媒体音频 (WMA)
*   MP4 视频（H.264 视频加 AAC 音频）
*   Windows 媒体视频 (WMV)

当然不包括FLAC。我对编码类型的东西几乎一无所知，所以我想在这里得到一些指导。

我能以某种方式轻松地在这里获得 FLAC 编码配置文件吗？

或者

我应该只通过实用程序记录和转换吗？（我需要一个快速的周转时间，所以我宁愿不使用这种方法）

*   如果这实际上是最好的方法，那么我可以从商店应用程序环境中运行的好的实用程序是什么？

谢谢你的帮助

# django - 1000 名用户的 Django 管理员下拉菜单

> ID：14912872
> 
> 赞同：17
> 
> 时间：2013-02-16T17:08:52.363
> 
> 标签：django, django-admin

假设：我有一个名为 Car 的模型，它与一个用户相关。我担心的是默认的 Django Admin。我通过下拉菜单将用户分配给汽车（这是默认的 Django 行为，所以有人告诉我）。

**当我在下拉列表中有 1000 多个用户可供选择时会发生什么。管理员是否处理这个问题，如果是这样如何处理？**

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-16T17:20:57.083

默认管理 UI 显示一个下拉列表。使用该`raw_id_fields`选项通过搜索按钮获取弹出窗口。此窗口可让您查找和选择链接对象。请参阅文档：[https ://docs.djangoproject.com/en/1.11/ref/contrib/admin/#django.contrib.admin.ModelAdmin.raw_id_fields](https://docs.djangoproject.com/en/1.11/ref/contrib/admin/#django.contrib.admin.ModelAdmin.raw_id_fields)

> 默认情况下，Django 的管理员使用选择框接口 () 来处理外键字段。有时您不希望产生必须选择所有相关实例以显示在下拉列表中的开销。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-16T17:32:07.057

您可以查看`django-grappelli`，这是一个增强管理界面的应用程序。该[文档](https://django-grappelli.readthedocs.org/en/latest/customization.html#autocomplete-lookups)`ForeignKey`描述了一个或`ManyToMany`关系的自动完成，使用`raw_id_fields`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-09-29T10:47:03.490

您可以使用 django-select2 插件[https://github.com/applegrew/django-select2](https://github.com/applegrew/django-select2)。

您可以执行以下操作：

```
from django_select2 import AutoModelSelect2Field

class CategoryChoices(AutoModelSelect2Field):
    queryset = models.Category.objects
    search_fields = ['name__icontains', 'code__icontains']

class NewsAdminForm(forms.ModelForm):
    category = CategoryChoices()

    class Meta:
        model = models.News
        exclude = ()

# register in admin
class NewsAdmin(admin.ModelAdmin):
    form = NewsAdminForm
admin.site.register(News, NewsAdmin) 
```

# java - Java - 性能问题；变量名和文件名长度

> ID：14912877
> 
> 赞同：4
> 
> 时间：2013-02-16T17:09:28.370
> 
> 标签：java, performance, file, variables

好吧，只是一些关于性能的问题，但我认为其中一些问题是合乎逻辑的： - 如果我使用具有短名称的变量会更好/更快地处理？示例：“String s”，将优于“String superphrase”。- 关于文件名，如果文件名短的话访问速度会更快吗？示例：（几乎相同）filename.txt 或 f.txt。

感谢所有人，我真的很想尽可能地让我的软件变得更好:)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-16T17:14:09.173

> 如果我使用短名称的变量会更好/更快地处理？

**不**，变量名甚至可能不在生成的字节码中。在一天结束时，变量被映射到寄存器/堆栈操作数。变量名无关紧要。它只适用于人类。他们往往更`superPhrase`喜欢`s`.

> 如果文件名很短，访问它会更快

**不。**文件，就像变量一样，是使用特殊标识符（例如 inode）引用的。只有在打开/定位文件时才需要文件名。与实际文件访问相比，它要快几个数量级。这同样适用于 Java 应用程序和其他操作系统进程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-16T17:17:34.383

除了 Tomasz 的出色回答外，您还展示了早期优化的所有迹象。有几个问题：

1）在遇到问题之前，您不知道要优化什么：减少 CPU 使用率是与减少内存或减少磁盘使用率不同的优化

2) 优化会耗费时间，要么是您的个人时间（有价值），要么是您公司的时间（具有更容易平等的价值）。没有必要的优化是浪费金钱。

3）如果要优化的重要事情是“程序员花费时间来计算软件的功能”，那么减少可变长度（即使它确实有所作为）将是无关紧要的。可读的代码很重要——好的变量名是其中的重要部分。

# php - 执行计算最近行总和并将结果插入新列的查询的问题

> ID：14912879
> 
> 赞同：1
> 
> 时间：2013-02-16T17:09:29.587
> 
> 标签：php, mysql, mysqli

我对 PHP 和 MySQL 很陌生，所以提前抱歉。我正在尝试执行一个查询，该查询计算一列的最近 30 行的总和，并将结果插入到表中的不同列中。

这是代码：

```
$link = mysqli_connect(DBHOST, DBUSER, DBPASS, DBNAME);

$sql1 = ("SELECT sum(open) FROM (SELECT date,open FROM AA ORDER BY date DESC LIMIT 30) sumopen30");
$result = mysqli_query($link,$sql1);

$resultarray = mysqli_fetch_assoc($result);
$attempts = $resultarray["open"];

echo $attempts;

$sql2 = "INSERT INTO AA (sum) VALUES ('$attempts')";
mysqli_query($link,$sql2); 
```

我没有得到任何结果、更新或错误。如果我将查询更改为“SELECT open FROM AA WHERE open > 40”，则会回显数据，但我认为查询存在问题。任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:14:54.277

问题是，总和没有存储在 open - 该字段被命名`sum(open)`

您还可以简化查询并给 sum(open) 一个新名称

```
$link = mysqli_connect(DBHOST, DBUSER, DBPASS, DBNAME);

$sql1 = ("SELECT sum(open) as sum_open FROM AA ORDER BY date DESC LIMIT 30");
$result = mysqli_query($link,$sql1);

$resultarray = mysqli_fetch_assoc($result);
$attempts = $resultarray["sum_open"];

echo $attempts;

$sql2 = "INSERT INTO AA (sum) VALUES ('$attempts')";
mysqli_query($link,$sql2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T17:15:38.113

试试这个：

```
$sql1 = ("SELECT sum(open) as open FROM AA ORDER BY date DESC LIMIT 30");
$result = mysqli_query($link,$sql1);

$resultarray = mysqli_fetch_assoc($result);
$attempts = $resultarray["open"];

echo $attempts;

$sql2 = "INSERT INTO AA (sum) VALUES ($attempts)";
mysqli_query($link,$sql2); 
```

我假设你`num`的字段是数字的。

# java - 设计具有可交换处理程序代码的通用处理程序类？

> ID：14912880
> 
> 赞同：0
> 
> 时间：2013-02-16T17:09:38.293
> 
> 标签：java, configuration, indirection, modularization

我想为文件编写一个通用处理类。此类将根据传递给它的文件类型加载特定的处理程序实例。

里面的一种方法会像这样工作（见评论）：

```
public void doSomething( File ) {
// 1) Determine file type.
// 2) Use a lookup to see if an appropriate handler exists.
// 3) If a handler exists, use handler to do something with the file.
} 
```

如何设计主类？

PS：我一直在考虑在构造函数或专用查找方法中读取属性或 XML 文件。还有一个想法是让主类引用一个可以加载处理程序模块的接口。也许这与某种模式相对应？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T17:19:05.467

这看起来像是某种[抽象工厂模式](http://en.wikipedia.org/wiki/Abstract_factory_pattern)。
您首先需要通过某些接口为您的处理程序定义“合同”，例如

```
public interface Handler {
 void handle(final File file);
} 
```

然后您需要定义不同的处理程序；`XMLHandler`, `PropertiesHandler`, 等等。
现在你需要一个工厂来给你一个来自文件扩展名的处理程序实例（比如说），它的界面可能看起来像

```
public interface HandlerFactory {
  Handler newHandler(final String fileName);
} 
```

现在您只需要实现所有这些 - 例如`HandlerFactory`可以从属性文件或类似文件中读取扩展名->类关联。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T17:16:27.887

有许多与此相对应的模式，但这是 OOP 中非常常见的任务。

在 Java 中，首先确定文件的类型。我会把它留给你。

然后使用 ClassLoader 加载和实例化相关的处理程序。

对它进行类型转换，然后继续使用它！

动态实例化是 Java、C# 等的一个很酷的特性。

# css - 我的简单 CSS 库在 Firefox 中运行，但不是 safari 或 chrome

> ID：14912883
> 
> 赞同：1
> 
> 时间：2013-02-16T17:09:44.750
> 
> 标签：css, image, safari, cross-browser, gallery

我有一个（非常）简单的 CSS 图像库，它在 firefox 中工作，但在 chrome 或 safari 上不起作用，我不知道为什么......我希望在单击较小的缩略图时在 bix 预览框中更改图像，我知道这段代码有点乱买我还在学习，我似乎可以弄清楚为什么它可以在 Firefox（我在构建网站时使用）但不能在 safari 或 chrome 中工作，如果图片库可以如果用户在 ipad 上使用，但我不能让它工作......

```
<htmL>
<div class="contentbox">

<div class="gallery" align="center">
<h3></h3><br/>

<div class="thumbnails">
<img  onClick="preview.src=img1.src"  id="img1" src="gallery/img1.jpg" alt="Image Not Loaded"/>
<img  onClick="preview.src=img2.src" id="img2" src="gallery/img2.jpg" alt="Image Not Loaded"/>
<img  onClick="preview.src=img3.src" id="img3" src="gallery/img3.jpg" alt="Image Not Loaded"/>
<img  onClick="preview.src=img4.src" id="img4" src="gallery/img4.jpg" alt="Image Not Loaded"/>
<img  onClick="preview.src=img5.src" id="img5" src="gallery/img5.jpg" alt="Image Not Loaded"/>
<img  onClick="preview.src=img6.src" id="img6" src="gallery/img6.jpg" alt="Image Not Loaded"/>
<img  onClick="preview.src=img7.src" id="img7" src="gallery/img7.jpg" alt="Image Not Loaded"/>
<img  onClick="preview.src=img8.src" id="img8" src="gallery/img8.jpg" alt="Image Not Loaded"/>
</div><br/>                   

<div class="preview" align="center">
 <img id="preview" src="./gallery/img1.jpg" alt="No Image Loaded"/>
</div>

</div> 

 </div>

</html>

----CSS----

.contentbox {
    width: 1200px;
    height: 790px;
    border: none;
    margin: auto;
    padding-top: 0px;
    margin-top: 40px;
    font-family: champagne; sans-serif; 

}

.thumbnails img {
height: 80px;
border: 4px solid #555;
padding: 1px;
margin: 0 10px 10px 0;
}

.thumbnails img:hover {
border: 4px solid #00ccff;
cursor:pointer;
}

.thumbnails img:hover {
    border: 4px solid #00ccff;
cursor:pointer;
}

.preview img {
border: 4px solid #444;
padding: 1px;
height: 500px;
}

------------ 
```

提前感谢您的帮助:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:48:13.520

而不是使用`preview.src=img1.src`，你应该使用`document.getElementById('preview').src=document.getElementById('img1').src`。

更好的是，您应该创建一个通用函数：

```
function setPreviewImage(targetId) {
    document.getElementById('preview').src = document.getElementById(targetId).src 
} 
```

把它放在一个`script`标签里。然后在每个`img`元素中像这样使用它：

```
onclick="setPreviewImage(this.id)" 
```

# ajax - 无法让一个简单的 jquery ajaxoncomplete 工作？

> ID：14912884
> 
> 赞同：1
> 
> 时间：2013-02-16T17:09:54.337
> 
> 标签：ajax, jquery

我哪里错了？

```
 jQuery(document).ready(function($){ 
  //always focus on input field
  //$('#documentID').focus();
  $("#btnSubmit").on("click", function(){
        var docID =  $('#documentID').val();
       alert("test "+docID);
       var lookupData = new Array();
  $.ajax({
            type:"POST",
            url: "lookup.php",
            data: {documentID: docID},
            dataType: 'text',
            success: function(msg){ 
alert(msg);//shows Wrong as expected
            //do stuff after the AJAX calls successfully completes
             $("#note").ajaxComplete(function(){
                        if(msg == "Wrong") 
                        {
                            result = 'Not so OK';   
                            $('#logo_header').hide();//just to test things  
                       }
                        else
                        {
                            result = 'OK lookup';
                            lookuData = msg;//populate all data
                        }
                        $(this).html(result);

                    });//#end ajaxComplete and populate note
            }//#end success

        });//#end AJAX
  })//#end function

}); 
```

并且 lookup.php 返回错误或正常（出于测试目的），但我无法让 div #note 显示消息并且 div logo_header 不会隐藏。

有什么资料吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:16:31.063

我假设它`$("#note")`没有处理 ajax 调用，因此它永远不会命中`if (msg == "wrong")`语句。

尝试删除`$("#note").ajaxComplete`

并且有：

```
success: function(msg){ 
alert(msg);//shows Wrong as expected
        //do stuff after the AJAX calls successfully completes
                    if(msg == "Wrong") 
                    {
                        result = 'Not so OK';   
                        $('#logo_header').hide();//just to test things  
                   }
                    else
                    {
                        result = 'OK lookup';
                        lookuData = msg;//populate all data
                    }
                    $(this).html(result);

        }//#end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T17:26:16.620

Tx，伙计们会考虑你的建议，但我想我发现了问题。我正在使用带有默认 jquery src 的 twitter bootstrap

```
http://code.jquery.com/jquery.js 
```

当我使用这个 jquery 源时

```
<script src="./site/wp-includes/js/jquery/jquery.js?ver=1.8.3"></script> 
```

ajaxComplete 似乎工作正常。

所以我的结论 jQuery 1.9.1 不支持 ajaxComplete vs jQuery 1.8.3 呢？？？？

@Aspiring Aqib，这是一个简单的测试。下一步是从lookup.php (json) 返回一个数组。所以我认为我需要改变返回的味精/数据。

# javascript - 未捕获的 SyntaxError: Unexpected token ) chrome 中的 javascript

> ID：14912892
> 
> 赞同：0
> 
> 时间：2013-02-16T17:10:34.840
> 
> 标签：javascript, jquery, google-chrome

通常（太频繁）我在 chrome 控制台中收到此错误。我真的在我的 javascript 代码中找不到任何语法错误

当我尝试在谷歌浏览器中找到此错误发生的位置时，它总是显示：

![铬 javascript 错误](../Images/b1657ed6d696740d505938196192cc07.png)

它表明错误出现在文件的开头（ DOCTYPE 附近的某处）。这只是chrome没有显示更多信息还是我在某处包含文件时搞砸了？（或者甚至可能是语法？）。无论哪种方式，我都无法在调试控制台的帮助下找到它

* * *

这是 global.js：

```
(function() { 

    $("#btadd").click(function() { 

        $(".newlist").slideUp();
        return false;

    });

})(); 
```

* * *

这是html：

```
<div class="newlist" style="display:none">
<h4>Title: <input type="text"/></h4>
</div>
<br />
   <a href="javascript:void()" id="btadd"><span>Add New</span></a> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-06T13:55:48.387

我有一个类似的问题。错误也可能来自

```
javascript:void(); 
```

实际上应该是

```
javascript:void(0); 
```

您可以在控制台中重现此错误

```
void() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T17:21:20.343

改变这个：

```
(function() { 
    $("#btadd").click(function() { 
        $(".newlist").slideUp();
        return false;
    });
})(); 
```

对此：

```
$(function () {
    $("#btadd").click(function () {
        $(".newlist").slideUp();
        return false;
    });
}); 
```

或者将现有的 JavaScript 移到正文的末尾。您创建了一个自调用匿名函数，该函数在它适用的元素被加载之前执行。一旦 DOM 完全加载，这将正常工作，但由于它位于文档的头部，它运行得太早了。通过使用我向您展示的示例，您正在使用 jQuery 的文档就绪事件来运行代码。

# java - JavaFX 接口上的动态项

> ID：14912894
> 
> 赞同：0
> 
> 时间：2013-02-16T17:10:41.403
> 
> 标签：java, user-interface, interface-builder, javafx-2

我正在寻找构建一个类似于[Blocky](http://code.google.com/p/blockly/)的应用程序。为此，我将使用 JavaFX。我正在研究原型atm。似乎 JavaFX UI 通常是使用 Scene Builders 制作的。我仍然不确定这将为我提供多少灵活性，当我希望在运行时动态更改形状（使它们更大等），检测碰撞以连接形状等时。

使用这项技术更有经验的人能否告诉我这样的应用程序使用 JavaFX 的可行性？用Java做它会更容易/相同吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-17T22:41:53.793

事实证明这是可能的，虽然有点棘手。在某些情况下，在从 fxml 加载形状后，我会在需要时以编程方式更改形状的尺寸。这个过程并不像我希望的那样干净，但确实有效。

# javascript - EmberJS：内容绑定不起作用

> ID：14912895
> 
> 赞同：1
> 
> 时间：2013-02-16T17:10:54.273
> 
> 标签：javascript, coffeescript, ember.js

这里有什么问题？为什么视图中的 contentBinding 不起作用？

视图中的输出
**内容未定义**

路由器.coffee

```
App.Router.map ->
  @route "show"
  @route "intro", 
```

intro_controller.coffee

```
App.IntroController = Ember.ArrayController.extend

  content: []

  createRecords:(files) ->
    @set('content', Ember.A())

    person = Ember.Object.create(username: "hello world")
    @pushObject person
    console.info "content in controller", @get('content')

    @transitionTo 'show' 
```

show_view.coffee

```
App.ShowView = Ember.View.extend

  contentBinding: 'App.IntroController.content',

  didInsertElement: ->
    console.info "content in view", @get('content') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:17:24.103

这是因为`App.IntroController`是 的子类`Ember.Object`，而不是实例。

你需要一个`App.ShowController`指定它*需要*什么的：

```
App.ShowController = Ember.Controller.extend({
    needs: ['intro']
}); 
```

然后在视图中您将可以访问：`controllers.intro.content`.

# coffeescript - 后处理错误 - copyTexImage2D：帧缓冲区格式不兼容

> ID：14912899
> 
> 赞同：0
> 
> 时间：2013-02-16T17:11:28.160
> 
> 标签：coffeescript, three.js, webgl

后处理错误 - copyTexImage2D：帧缓冲区格式不兼容

我正在尝试使用示例中提供的后期效果，但我的控制台中不断出现以下错误，并且没有呈现任何内容。关于可能导致这种情况的任何想法？我认为重要的事情与后处理示例没有什么不同。

WebGL：INVALID_OPERATION：copyTexImage2D：帧缓冲区格式不兼容

```
renderer = new THREE.WebGLRenderer()
renderer.setSize(window.innerWidth, window.innerHeight)
renderer.setClearColorHex(0x000000, 1)
renderer.sortObjects = false;

...

composer = new THREE.EffectComposer( renderer )
composer.addPass( new THREE.RenderPass( scene, camera ) )

effect = new THREE.ShaderPass( THREE.DotScreenShader )
effect.uniforms[ 'scale' ].value = 4
composer.addPass( effect )

effect = new THREE.ShaderPass( THREE.FXAAShader )   
composer.addPass( effect )

render = ->
    requestAnimationFrame(render)
    composer.render()

render() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-22T17:48:03.240

您可以尝试使用以下方法将 alpha 添加到 WebGLRenderer 默认帧缓冲区：

```
renderer = new THREE.WebGLRenderer( { antialias: true, alpha: true } ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T01:07:03.307

我发现了错误，有一个错误，EffectComposer 与 LensFlare 不兼容，提交更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-02T09:21:09.557

根据@Axiverse 的建议，如果您的问题与镜头光晕（或其他任何东西）的使用有关，只需添加您自己的渲染目标即可。

```
//...
var pixelRatio = renderer.getPixelRatio();
var width = Math.floor( renderer.context.canvas.width  / pixelRatio ) || 1;
var height = Math.floor( renderer.context.canvas.height / pixelRatio ) || 1;

var renderTarget = new THREE.WebGLRenderTarget(width, height, {
    minFilter: THREE.LinearFilter,
    magFilter: THREE.LinearFilter,
    format: THREE.RGBAFormat, // <-- The line that fix all for me
    stencilBuffer: false
});

var effectComposer = new THREE.EffectComposer(webGLRenderer, renderTarget); 
```

# c++ - c++ char* 解析

> ID：14912903
> 
> 赞同：0
> 
> 时间：2013-02-16T17:11:52.097
> 
> 标签：c++, arrays, vector, char

所以，我正在尝试编写一个返回 a 的函数`vector<char**>`，如下所示：

```
vector<char**> test(string mystr) {

  char*temp=new char[mystr.size()+1];

  strcpy(temp,mystr.c_str());

  char*subStr=strtok(temp,":");

  while(subStr!=NULL) {

    int i=0;

    char**args=new char*[200];

    char*tempsta=newchar[strlen(subStr)+1];

    strcpy(tempsta, subStr);

    args[i]=strtok(tempsta," ");

    while(args[i]!=NULL) {

      i++;

      args[i]=strtok(NULL," ");

    }

    fullVec.push_back(args);

    //cout<<subStr<<endl;

    subStr=strtok(NULL,":");

  }
return fullVec;
} 
```

所以我想用分隔符`split`把参数串起来`":"`，然后用“”分隔符。在`cout<<subStr`通话中，如果我注释掉从`int i=0`到的所有内容，我会得到预期的结果`fullVec.push_back(args)`。如果我不注释掉所有这些行，我只会得到第一行`substring`（直到遇到第一个“：”），然后最大的 while 循环退出。

我的意思是预期的；让我们假设参数是“我的名字是：bon jovi：xxx ab”，如果所有内容都被注释掉，将打印以下行：

```
my name is
 bon jovi
 xxx ab 
```

如果我保持原样，将会发生的只是

```
my name is 
```

将打印，大循环将退出

任何帮助表示赞赏，谢谢！（是的，我知道这似乎是一个愚蠢的练习，可以更优雅/更轻松地完成......但是我希望在我使用字符串等娱乐之前让这个解决方案起作用。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T17:34:13.210

您的问题是 strtok() 在调用之间保持状态。

如果第一个参数不为 NULL，则它用于重置状态，否则它使用已保存的状态从中断处继续解析。

由于您有两个对 strtok() 的嵌套调用，因此第二个调用弄乱了外部调用的状态。

这个电话：

```
args[i]=strtok(tempsta," "); 
```

正在重置 strtok() 的内部状态。它现在不再知道你的外部调用中的任何状态。因此，当您到达内部循环中的字符串末尾时。

这个电话：

```
subStr=strtok(NULL,":"); 
```

现在正在使用内循环的已保存状态。因此，它基本上只是在您已经到达该标记化流的末尾时终止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T17:56:51.853

[正如Loki](https://stackoverflow.com/users/14065/loki-astari)已经完美指出的那样，您不应该混合使用 C 和 C++。如果您需要 C++ 解决方案来解决您的问题，那么最好坚持使用 STL 类来为您处理丑陋的内存管理（参见[RAII idiom](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)），例如`std::string`, `std::vector`, `std::istringstream`.

这就是您的函数的样子：

```
typedef std::vector<std::string> Line;

std::vector<Line> parse(std::string inputString)
{
    std::vector<Line> lines;
    std::istringstream inputStream(inputString);
    for (std::string line; std::getline(inputStream, line, ':'); )
    {
        if (!line.empty())
        {
            lines.push_back(Line());
            std::istringstream lineStream(line);
            for (std::string word; std::getline(lineStream, word, ' '); )
            {
                if (!word.empty())
                    lines.back().push_back(word);
            }
        }
    }
    return lines;
} 
```

使用示例：

```
std::vector<Line> lines = parse("my name is: bon jovi: xxx ab");

for (int li = 0; li < lines.size(); ++li)
{
    for (int wi = 0; wi < lines[li].size(); ++wi)
        std::cout << lines[li][wi] << "_";
    std::cout << std::endl;
} 
```

输出

```
my_name_is_
bon_jovi_
xxx_ab_ 
```

希望这可以帮助 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T17:41:02.043

正如评论中提到的，您正在混合 C 风格和 C++ 风格的代码，这会导致相当混乱。除非你有“充分的理由”来`char*` 代替`std::string`then ，否则最好使用`stl`or `boost`。

`boost`方式：

```
std::string delims = " :";
boost::split(vector, mystr, boost::is_any_of(delims)); 
```

`stl`方式：

```
 vector<string> result;
  std::string delims = " :";
  std::istringstream ss( mystr );
  while (!ss.eof())
  {
    getline( ss, field, delims);
    if ((empties == split::no_empties) && field.empty()) continue;
    result.push_back( field );
  } 
```

有关更多方法和良好比较，请参阅此[cplusplus 文章](http://www.cplusplus.com/faq/sequences/strings/split/)

# javascript - JavaScript - 用“js”类替换“no-js”类不起作用？

> ID：14912906
> 
> 赞同：6
> 
> 时间：2013-02-16T17:12:12.347
> 
> 标签：javascript, html, class, replace, classname

我在我的`<html>`元素中放置了一个名为“no-js”的类。这表明用户没有使用 javascript，（无论是被禁用还是被阻止）。然后，在我创建的脚本文件中，我想撤销“no-js”并注入“js”，以便我可以确定用户是否通过类使用 javascript。我尝试`replace()`通过查询 html 标签来使用该方法，但它不起作用。这是我所拥有的：

```
var html = document.getElementsByTagName("html")[0];
if(html.className == "no-js") {
    html.className.replace("no-js", "js"); // user has JS enabled
} 
```

Google Chrome 或 Firefox 的 bug 控制台中没有错误，但也没有更改`no-js`为`js`. 我会使用`<noscript>`标签，但我喜欢保持它的标记面干净。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-16T17:15:36.103

`replace` *返回*新字符串，它不会修改原始字符串。

尝试`html.className = 'js'`，因为您已经确定它是您的`if`语句中唯一的类名。

编辑：此外，该`<html>`标签已经可以作为`document.documentElement`.

```
document.documentElement.className = 'js'; 
```

这就是你所需要的，真的。没有`if`声明，没有变量，什么都没有。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-05-14T15:26:29.647

接受的答案确实是正确的，但是这种方式将取代 的所有类`<html>`，而不仅仅是`.no-js`.

这个小脚本会做同样的事情，但只会搜索`no-js`类并重写它。

```
document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js '; 
```

从这里拿脚本，很简单！ [http://snipplr.com/view/63895/remove-nojs-class-from-html-tag-add-js-class/](http://snipplr.com/view/63895/remove-nojs-class-from-html-tag-add-js-class/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T17:15:06.820

您忘记将 分配`html.className`给新值：

```
var html = document.getElementsByTagName("html")[0];
if(html.className == "no-js") {
    html.className = html.className.replace("no-js", "js"); // user has JS enabled
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-19T13:33:07.090

用一点正则表达式

```
(function(html) {
  html.className = html.className.replace(/\bno-js\b/, 'js')
})(document.documentElement);
```

```
<!DOCTYPE html>
<html class="no-js">
<head>

</body>
</html>
```

# php - http 库应该使用什么测试套件？

> ID：14912912
> 
> 赞同：2
> 
> 时间：2013-02-16T17:13:11.200
> 
> 标签：php, curl, network-programming, tdd

我想为 HTTP 获取编写开源 PHP 库，基于 curl 和单元测试。将有诸如代理隧道、多个网络接口（如果可用）使用、并行请求执行等功能。

但是我应该如何测试所有这些东西呢？我的意思是，我是否应该测试成功获取请求，如下所示：

```
$myVeryGoodLIbraryClass->get('http://google.com') 
```

还是`Apache config file`为本地测试站点创建？或者我如何测试代理服务器？我应该将 Squid 配置文件放在`tests`我的库目录中吗？我知道所有这些对于想要参与其中的人来说都很重要，所以我想让其他人（和我自己:)）的开发更加方便。

# html - 编程中http和https有什么区别

> ID：14912915
> 
> 赞同：7
> 
> 时间：2013-02-16T17:13:23.517
> 
> 标签：html, http, https

我只知道“s”代表“安全”，用户不应该在只使用 http 的网站上输入关键信息。但是我真的很想知道这两个协议对我的编程有什么影响，例如：

*   某些网站如何获得“https”而有些却没有（或者他们如何打开和关闭此功能，我不知道）。这是否意味着我必须在某个地方注册它？

*   我心想，http中的通信没有加密，而https中可能会进行一些加密，这是正确的吗？

*   而且由于加密（如果有）过程是由浏览器完成的，因此，我的服务器端代码与“http”或“https”无关，对吗？

*   有没有办法强制用户只使用 https？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-16T17:18:19.253

*   使用 HTTPS 协议的网站使用由受信任的第三方（或“证书颁发机构”）颁发的证书，其中包含一个公钥（请参阅：[公钥基础设施](http://en.wikipedia.org/wiki/Public_key_infrastructure)）。公钥与私钥配对，用私钥加密的信息只能用公钥解密。这用于确认服务器是私钥的持有者（因此是证书颁发机构认证的实体）。要使用 HTTPS 协议，您必须生成或购买证书。由于各种原因，购买证书而不是生成证书更为常见。

*   HTTPS 通信是加密的。与证书关联的密钥不进行加密，而是浏览器和服务器使用诸如 Diffie-Hellman Exchange 之类的方案来生成用于加密通信的密钥。这很重要，因为任何拥有公钥的人都可以解密使用私钥加密的内容。

*   浏览器发送的信息由浏览器加密，由服务器解密。您的网络服务器软件将解密信息；接收到的信息看起来与标准 HTTP 流量没有什么不同。

*   是的，您可以强制使用 HTTPS。您可以通过您的服务器软件（例如`RewriteRule`，在 Apache 中，通过`RewriteCond`检查 HTTPS）或通过 HSTS（这涉及发送特定标头）来执行此操作。如果您在支持 HSTS 的浏览器中发送 HSTS 标头，浏览器将自动从 HTTP 重定向到 HTTPS（请参阅：[HTTP Strict Transport Security](http://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security)）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-16T17:16:54.950

您需要在网络服务器上安装 SSL 证书才能启用 HTTPS。这将允许在客户端浏览器和服务器之间建立加密连接，并且所有 HTTP 流量都将被加密。此证书由受信任的机构颁发。您还可以生成证书用于测试目的，但是当客户端浏览器导航到该网站时，它会发出警告，指出该证书不是由受信任的机构颁发的。

您可以强制使用 HTTPS，方法是将您的网络服务器配置为自动将所有 HTTP 请求重定向到相应的 HTTPS 端点。

你可以查一下[`SSL/TLS`](http://en.wikipedia.org/wiki/Transport_Layer_Security)。

# java - 如何在Java中建立到本地文件的链接？

> ID：14912919
> 
> 赞同：1
> 
> 时间：2013-02-16T17:13:57.953
> 
> 标签：java, file, audio

我想在面板内显示指向音频文件的链接。它应该在用户单击它时播放。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T17:26:52.240

您可以添加一个`clickable label`打开音频文件，这里是一个例子：

```
JLabel lblFileLink = new JLabel("Audio File Title");

// To indicate the the link is clickable
lblFileLink.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));

lblFileLink.addMouseListener(new MouseAdapter() {
        @Override
        public void mouseClicked(MouseEvent e) {
            try {
                Desktop.getDesktop().open(
                        new File("AUDIO FILE PATH"));
            } catch (IOException e1) {

                e1.printStackTrace();
            }
        }
    }); 
```

如果要使链接类似于 HTML 链接，可以执行以下操作：

```
JLabel lblFileLink =
   new JLabel("<HTML><BODY><a href=\"\">somefile.mp3</a></BODY></HTML>"); 
```

# c# - 确定一个可靠的模式以抽象网络层以实现可测试性

> ID：14912924
> 
> 赞同：2
> 
> 时间：2013-02-16T17:14:43.260
> 
> 标签：c#, networking, mocking

我在这里阅读了有关论点的各种问题，例如

[如何对 TCP 服务器进行单元测试？它甚至值得吗？](https://stackoverflow.com/questions/741981/how-do-you-unit-test-a-tcp-server-is-it-even-worth-it)

和其他更具体的问题

[有没有人成功地模拟过 .NET 中的 Socket 类？](https://stackoverflow.com/questions/1263581/has-anyone-successfully-mocked-the-socket-class-in-net)

[rhino mocks：如何建立一个假套接字？](https://stackoverflow.com/questions/8092182/rhino-mocks-how-to-build-a-fake-socket)

但我无论如何都觉得要发布这个问题。

我需要设计一个**抽象的网络层**。将消费者代码从依赖于特定实现中分离出来应该是抽象的，最后但并非最不重要的一点是，可以用假货完全测试。

我最终发现我不需要模拟一个`Socket`类，而是定义一个更高级别的抽象并模拟它。

```
interface INetworkLayer {
  void OnConnect(Stream netwokStream);
  void OnException(Exception e); // doubts on this  
} 
```

有没有人做过类似的事情，可以提供观察、评论或解释如何看待正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T23:35:29.750

我相信您要问的不是“提高可测试性”，而只是“测试”通过网络发送内容的代码。

根据我的经验，对于通过网络发送的内容，只有两件有趣的事情需要测试：

1.  我的应用程序是否发送了正确的消息？
2.  我可以通过网络发送此消息吗？

例如，假设您的应用程序可以向另一台服务器发送一些（应用程序级）消息。您可以定义一个像这样的接口：

```
 public interface MessagePort {
        void Send(Message message, ServerName to);
    } 
```

其中 Message 是您希望应用程序发送的消息，而 ServerName 是一个类，表示应用程序级别的方式来命名消息的目标。为简单起见，ServerName 可以是一个简单的字符串，可以通过配置、DNS 或其他方式映射到服务器的地址。你选。

您可以实现一个 MockMessagePort，将消息存储到一个简单的列表中，以测试您的应用程序确实发送了正确的消息。（问题 1。）

之后，您可以通过使用环回来实现在网络上实际发送消息。您可能想阅读鲍勃叔叔的“工匠”文章以获取相关示例。

[http://www.objectmentor.com/resources/publishedArticles.html](http://www.objectmentor.com/resources/publishedArticles.html)，主题“工匠”。TCP 服务器的测试驱动实现是本系列的一些章节，但您应该从头开始阅读。

一个更有趣的抽象是消息收件人的“通道”。

```
 public interface MessageChannel {
        void Send(Message message);
    } 
```

实现知道收件人的地方。当然，在这种情况下，还有另一个对象提供通道，来自收件人“ServerName”。

如果你真的想要一个网络设施的抽象模型，那么你可以这样做：

1.  尝试找到两个不同的网络库。
2.  使用每个库编写相同的应用程序两次。
3.  考虑应用程序。应用代码应该相同，网络部分应该不同。它们将由一个接口分隔。这是您正在寻找的界面。

但老实说，我不相信它会给你的申请带来太多好处。

# sql - Oracle SQL：标识符无效

> ID：14912926
> 
> 赞同：0
> 
> 时间：2013-02-16T17:14:58.983
> 
> 标签：sql, oracle, oracle10g

谁能向我解释为什么 dLoad 是 GROUP BY 行中的无效标识符？这在 Mysql 上运行良好，但我无法让它与 Oracle 一起使用。

```
CREATE OR REPLACE VIEW DoctorsLoad AS
    SELECT dID, gender, specialty, 'Overloaded' AS dLoad
    FROM Doctor D, Examine E
    WHERE D.dID = E.doctor_id
    GROUP BY dID, gender, specialty, dLoad
    HAVING COUNT(*) > 10
    UNION
    SELECT dID, gender, specialty, 'Underloaded' AS dLoad
    FROM Doctor D, Examine E
    WHERE D.dID = E.doctor_id
    GROUP BY dID, gender, specialty, dLoad
    HAVING COUNT(*) <= 10; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T17:17:10.430

使用 Oracle RDMS，您不能在`GROUP BY`子句中使用别名，但对于像 'Overloaded' 这样的文字，您无论如何都不需要将其包含在组中。

```
CREATE OR REPLACE VIEW DoctorsLoad AS
    SELECT dID, gender, specialty, 'Overloaded' AS dLoad
    FROM Doctor D, Examine E
    WHERE D.dID = E.doctor_id
    GROUP BY dID, gender, specialty
    HAVING COUNT(*) > 10
    UNION ALL
    SELECT dID, gender, specialty, 'Underloaded' AS dLoad
    FROM Doctor D, Examine E
    WHERE D.dID = E.doctor_id
    GROUP BY dID, gender, specialty
    HAVING COUNT(*) <= 10; 
```

我还建议使用`UNION ALL`避免过滤操作来删除重复行的 a 。

# prolog - Prolog 模糊输出

> ID：14912929
> 
> 赞同：2
> 
> 时间：2013-02-16T17:15:28.783
> 
> 标签：prolog, sudoku

我正在 Prolog 中编写一个迷你数独求解器。数独由 4x4 字段组成，例如

```
_ _ 2 3
_ _ _ _
_ _ _ _
3 4 _ _ 
```

如果数独只有一种可能的解决方案（如上面的数独），我的程序按预期工作。但是如果我用一个间隙替换至少一个给定的字段（例如，用 _ 替换 4），Prolog 的输出是这样的：

```
[_#3(1:4),_#23(1:4),2,3..... 
```

我猜“_#3(1:4)”的意思是“取 1 或 4”，但我希望每个解决方案都在一个单独的、明确的列表中。这是我的代码：

```
sudoku(Puzzle,Solution):-
        Puzzle=Solution,
        fd_domain(Solution,1,4),

        Puzzle=[S11,S12,S13,S14,
            S21,S22,S23,S24,
            S31,S32,S33,S34,
            S41,S42,S43,S44],

        fd_all_different([S11,S12,S13,S14]),
        fd_all_different([S21,S22,S23,S24]),
        fd_all_different([S31,S32,S33,S34]),
        fd_all_different([S41,S42,S43,S44]),

        fd_all_different([S11,S21,S31,S41]),
        fd_all_different([S12,S22,S32,S42]),
        fd_all_different([S13,S23,S33,S43]),
        fd_all_different([S14,S24,S34,S44]),

        fd_all_different([S11,S12,S21,S22]),
        fd_all_different([S13,S14,S23,S24]),
        fd_all_different([S31,S32,S41,S42]),
        fd_all_different([S33,S34,S43,S44]). 
```

当我将它加载到 Gnu Prolog 中时，我输入以下查询：

```
sudoku([_,_,2,3,_,_,_,_,_,_,_,_,3,_,_,_],Sol). 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:29:27.817

您的 Prolog 建议您使用多种解决方案，显示存储中的*剩余*约束。您需要*标记*变量，即让引擎枚举有效值。

```
?- sudoku([_,_,2,3,_,_,_,_,_,_,_,_,3,_,_,_],Sol),fd_labeling(Sol).

Sol = [1,4,2,3,2,3,1,4,4,1,3,2,3,2,4,1] ? ;

Sol = [1,4,2,3,2,3,1,4,4,2,3,1,3,1,4,2] ? ;

Sol = [1,4,2,3,2,3,4,1,4,1,3,2,3,2,1,4] ? ;

Sol = [4,1,2,3,2,3,1,4,1,4,3,2,3,2,4,1] ? ;

Sol = [4,1,2,3,2,3,4,1,1,2,3,4,3,4,1,2] ? ;

Sol = [4,1,2,3,2,3,4,1,1,4,3,2,3,2,1,4] 
```

# javascript - 在javascript中计算元音

> ID：14912935
> 
> 赞同：1
> 
> 时间：2013-02-16T17:15:37.817
> 
> 标签：javascript, string

我使用这段代码来搜索和计算字符串中的元音，

```
a = "run forest, run";
a = a.split(" ");
var syl = 0;
for (var i = 0; i < a.length - 1; i++) {
    for (var i2 = 0; i2 < a[i].length - 1; i2++) {
        if ('aouie'.search(a[i][i2]) > -1) {
            syl++;
        }
    }
}

alert(syl + " vowels") 
```

显然它应该提醒 4 个元音，但它返回 3。出了什么问题以及如何简化它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T17:19:00.073

尝试这个：

```
var syl = ("|"+a+"|").split(/[aeiou]/i).length-1; 
```

`|`确保没有边缘情况，例如在字符串的开头或结尾处有元音。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-16T17:25:11.667

关于您的代码，您的 if 条件不需要 i2

```
if('aouie'.search(a[i]) > -1){ 
```

我想知道，为什么所有使用数组和嵌套循环，下面`regex`可以做得更好，

```
var str = "run forest, run";
var matches = str.match(/[aeiou]/gi);
    var count = matches ? matches.length : 0;
    alert(count + " vowel(s)"); 
```

[演示](http://jsfiddle.net/2QPN2/2/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-16T17:18:44.140

尝试：

```
a = "run forest, run";

var syl = 0;

for(var i=0; i<a.length; i++) {
        if('aouie'.search(a[i]) > -1){ 
            syl++;
        }
}

alert(syl+" vowels") 
```

首先，拆分是无用的，因为您已经可以循环遍历每个字符。

第二：您需要使用`i<a.length`，这也将获取字符串中的最后一个字符。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-10T10:40:14.307

最简单的方法是

```
s.match(/[aeiou]/gi).length 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-18T08:50:55.600

您可以使用 .match 将字符串与正则表达式进行比较。g 是全局的，它将贯穿整个字符串。i 使字符串以大写和小写形式可读。

```
function getVowels(str) {
      var m = str.match(/[aeiou]/gi);
      return m === null ? 0 : m.length;
    } 
```

# objective-c - UIColor CMYK 和 Lab 值

> ID：14912938
> 
> 赞同：3
> 
> 时间：2013-02-16T17:16:08.963
> 
> 标签：objective-c, rgb, uicolor, cmyk, lab-color-space

简单的问题，很可能是复杂的答案：

如何从 UIColor 对象中获取 CMYK 和 Lab 值（如果有帮助，我知道 RGB 值）？

我发现这是关于获取 CMYK 值的，但我无法从中获得任何准确的值，尽管它无处不在，但我听说它不是一个很好的片段。

```
CGFloat rgbComponents[4];
    [color getRed:&rgbComponents[0] green:&rgbComponents[1] blue:&rgbComponents[2] alpha:&rgbComponents[3]];

    CGFloat k = MIN(1-rgbComponents[0], MIN(1-rgbComponents[1], 1-rgbComponents[2]));
    CGFloat c = (1-rgbComponents[0]-k)/(1-k);
    CGFloat m = (1-rgbComponents[1]-k)/(1-k);
    CGFloat y = (1-rgbComponents[2]-k)/(1-k); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T23:29:36.823

对于基于 ICC 的颜色转换，您可以使用[Little Color Management System](http://www.littlecms.com)。（我刚刚将下载存档中的所有 .c 和 .h 文件添加到 iOS Xcode 项目中。它编译并运行以下代码没有问题。）

*备注：* RGB 和 CMYK 是设备*相关*色彩空间，Lab 是设备*独立*色彩空间。因此，要将 RGB 转换为 Lab，您必须为转换选择一个独立于设备（或“校准”）的 RGB 颜色空间，例如 sRGB。

Little CMS 带有用于 sRGB 和 Lab 颜色空间的内置配置文件。从 sRGB 到 Lab 的转换如下所示：

创建颜色变换：

```
cmsHPROFILE rgbProfile = cmsCreate_sRGBProfile();
cmsHPROFILE labProfile = cmsCreateLab4Profile(NULL);
cmsHTRANSFORM xform = cmsCreateTransform(rgbProfile, TYPE_RGB_FLT, labProfile,
                                         TYPE_Lab_FLT,
                                         INTENT_PERCEPTUAL, 0);
cmsCloseProfile(labProfile);
cmsCloseProfile(rgbProfile); 
```

转换颜色：

```
float rgbValues[3];
// fill rgbValues array with input values ...
float labValues[3];
cmsDoTransform(xform, rgbValues, labValues, 1);
// labValues array contains output values. 
```

处理颜色转换：

```
cmsDeleteTransform(xform); 
```

当然，转换只会创建一次并用于所有颜色转换。

对于 RGB 到 CMYK 的转换，您也可以使用 Little CMS，但您必须提供一个 ICC 配置文件，例如来自免费的 Adob​​e 下载页面[ICC profile downloads for Mac OS 的](http://www.adobe.com/support/downloads/detail.jsp?ftpID=4074)一个。

RGB 到 CMYK 转换的代码示例：

```
float rgb[3]; // fill with input values (range 0.0 .. 1.0)
float cmyk[4]; // output values (range 0.0 .. 100.0)

cmsHPROFILE rgbProfile = cmsCreate_sRGBProfile();

// The CMYK profile is a resource in the application bundle:
NSString *cmykProfilePath = [[NSBundle mainBundle] pathForResource:@"YourCMYKProfile.icc" ofType:nil];
cmsHPROFILE cmykProfile = cmsOpenProfileFromFile([cmykProfilePath fileSystemRepresentation], "r");

cmsHTRANSFORM xform = cmsCreateTransform(rgbProfile, TYPE_RGB_FLT, cmykProfile,
                                         TYPE_CMYK_FLT,
                                         INTENT_PERCEPTUAL, 0);

cmsCloseProfile(cmykProfile);
cmsCloseProfile(rgbProfile);

cmsDoTransform(xform, rgb, cmyk, 1);

cmsDeleteTransform(xform); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-12T20:14:09.900

要获得 LAB 值，您需要将 RGB 值转换为 XYZ 值，然后您可以将其转换为 RGB 值。

```
- (NSMutableArray *) convertRGBtoLABwithColor: (UIColor *)color

////make variables to get rgb values
CGFloat red3;
CGFloat green3;
CGFloat blue3;
//get rgb of color
[color getRed:&red3 green:&green3 blue:&blue3 alpha:nil];

float red2 = (float)red3*255;
float blue2 = (float)blue3*255;
float green2 = (float)green3*255;

//first convert RGB to XYZ

// same values, from 0 to 1
red2 = red2/255;
green2 = green2/255;
blue2 = blue2/255;

// adjusting values
if(red2 > 0.04045)
{
    red2 = (red2 + 0.055)/1.055;
    red2 = pow(red2,2.4);
} else {
    red2 = red2/12.92;
}

if(green2 > 0.04045)
{
    green2 = (green2 + 0.055)/1.055;
    green2 = pow(green2,2.4);
} else {
    green2 = green2/12.92;
}

if(blue2 > 0.04045)
{
    blue2 = (blue2 + 0.055)/1.055;
    blue2 = pow(blue2,2.4);
} else {
    blue2 = blue2/12.92;
}

red2 *= 100;
green2 *= 100;
blue2 *= 100;

//make x, y and z variables
float x;
float y;
float z;

// applying the matrix to finally have XYZ
x = (red2 * 0.4124) + (green2 * 0.3576) + (blue2 * 0.1805);
y = (red2 * 0.2126) + (green2 * 0.7152) + (blue2 * 0.0722);
z = (red2 * 0.0193) + (green2 * 0.1192) + (blue2 * 0.9505);

//then convert XYZ to LAB

x = x/95.047;
y = y/100;
z = z/108.883;

// adjusting the values
if(x > 0.008856)
{
    x = powf(x,(1.0/3.0));
} else {
    x = ((7.787 * x) + (16/116));
}

if(y > 0.008856)
{
    y = pow(y,(1.0/3.0));
} else {
    y = ((7.787 * y) + (16/116));
}

if(z > 0.008856)
{
    z = pow(z,(1.0/3.0));
} else {
    z = ((7.787 * z) + (16/116));
}

//make L, A and B variables
float l;
float a;
float b;

//finally have your l, a, b variables!!!!
l = ((116 * y) - 16);
a = 500 * (x - y);
b = 200 * (y - z);

NSNumber *lNumber = [NSNumber numberWithFloat:l];
NSNumber *aNumber = [NSNumber numberWithFloat:a];
NSNumber *bNumber = [NSNumber numberWithFloat:b];

//add them to an array to return.
NSMutableArray *labArray = [[NSMutableArray alloc] init];
[labArray addObject:lNumber];
[labArray addObject:aNumber];
[labArray addObject:bNumber];

return labArray;
} 
```

# php - 如何打印当前 URL 路径？

> ID：14912943
> 
> 赞同：33
> 
> 时间：2013-02-16T17:16:27.867
> 
> 标签：php, url

我想打印出当前的 URL 路径，但我的代码不能正常工作。

我在我的 file.php 中使用它

```
echo "http://".$_SERVER['HTTP_HOST'].$_SERVER['SCRIPT_NAME']; 
```

当我打开 url **[http://sub.mydomain.com/file.php](http://sub.mydomain.com/file.php)**它似乎工作正常，它打印`"http://sub.mydomain.com/file.php"`

但是，如果我删除 .php 扩展名，因此 url 将改为**[http://sub.mydomain.com/file](http://sub.mydomain.com/file)**，它会打印`"http://sub.mydomain.com/sub/file.php"`出错误的。

它打印子域两次，我不知道为什么？

在我的 .htaccess 文件中，我进行了重写，可以删除 .php 扩展名。

有谁可以/想帮助我吗？:)

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2013-02-16T17:49:47.937

您需要`$_SERVER['REQUEST_URI']`而不是`$_SERVER['SCRIPT_NAME']`，cos`$_SERVER['SCRIPT_NAME']`将始终为您提供当前正在工作的文件。

从手册：

> SCRIPT_NAME：包含当前脚本的路径。这对于需要指向自身的页面很有用。该`__FILE__`常量包含当前（即包含的）文件的完整路径和文件名。.

我想这可以帮助您完全获取当前 URL。

```
echo 'http://'. $_SERVER['SERVER_NAME'] . $_SERVER['REQUEST_URI']; 
```

注意：不要依赖客户的`HTTP_HOST`，而是使用`SERVER_NAME`！SEE：[PHP 中的 HTTP_HOST 和 SERVER_NAME 有什么区别？](https://stackoverflow.com/questions/2297403/http-host-vs-server-name)

### 安全警告

如果您在任何地方使用它（打印或存储在数据库中），您需要过滤（清理）`$_SERVER['REQUEST_URI']`，因为它不安全。

```
// ie: this could be harmfull
/user?id=123%00%27<script... 
```

因此，请始终在使用用户输入之前对其进行过滤。至少使用`htmlspecialchars`,`htmlentities`等`strip_tags`。

或类似的东西；

```
function get_current_url($strip = true) {
    static $filter, $scheme, $host, $port; 
    if ($filter == null) {
        $filter = function($input) use($strip) {
            $input = trim($input);
            if ($input == '/') {
                return $input;
            }

            // add more chars if needed
            $input = str_ireplace(["\0", '%00', "\x0a", '%0a', "\x1a", '%1a'], '',
                rawurldecode($input));

            // remove markup stuff
            if ($strip) {
                $input = strip_tags($input);
            }

            // or any encoding you use instead of utf-8
            $input = htmlspecialchars($input, ENT_QUOTES, 'utf-8');

            return $input;
        };

        $scheme = isset($_SERVER['REQUEST_SCHEME']) ? $_SERVER['REQUEST_SCHEME']
            : ('http'. (($_SERVER['SERVER_PORT'] == '443') ? 's' : ''));
        $host = $_SERVER['SERVER_NAME'];
        $port = ($_SERVER['SERVER_PORT'] != '80' && $scheme != 'https')
            ? (':'. $_SERVER['SERVER_PORT']) : '';
        }
    }

    return sprintf('%s://%s%s%s', $scheme, $host, $port, $filter($_SERVER['REQUEST_URI']));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-19T18:52:26.987

```
$main_folder = str_replace('\\','/',dirname(__FILE__) );
$document_root = str_replace('\\','/',$_SERVER['DOCUMENT_ROOT'] );
$main_folder = str_replace( $document_root, '', $main_folder);
if( $main_folder ) {
    $current_url = $_SERVER['REQUEST_SCHEME'].'://'.$_SERVER['SERVER_NAME']. '/' . ltrim( $main_folder, '/' ) . '/';
} else {
    $current_url = $_SERVER['REQUEST_SCHEME'].'://'.rtrim( $_SERVER['SERVER_NAME'], '/'). '/';
} 
```

# unit-testing - 使用 Roboelectric 对 android listview 滚动进行单元测试

> ID：14912945
> 
> 赞同：2
> 
> 时间：2013-02-16T17:16:34.940
> 
> 标签：unit-testing, scroll, robolectric

我有一种方法尝试以编程方式滚动到`ListView`. 该方法有一些条件，因此它的实现会根据应用程序运行的 Android SDK 版本而略有不同。

该功能在我测试过的 3 台 android 设备上运行良好。但是，我使用`junit`and编写了一个单元测试，[`Roboelectric`](http://robolectric.org/)它检查滚动是否使目标位置的项目可见。测试失败。当我调试时，我注意到`android.os.Build.VERSION.SDK_INT`在运行时为 0 `Roboelectric`（即在桌面上与设备或模拟器上）。

我尝试忽略版本而只使用`ListView.smoothScrollToPosition()`，但 `getFirstVisilePoition()`and`getLastVisiblePosition()`方法继续返回 0，即使在我调用`smoothScrollToPosition(150)`.

有谁知道是否/如何使用滚动列表视图进行测试`Roboelectric`？

任何帮助将不胜感激 - 我似乎无法找到有关该主题的任何信息。

谢谢，

安娜

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T21:32:35.220

如果您使用的是 robolectric 1.1 或 1.2，这里是 AbsListView 的来源： [https://github.com/pivotal/robolectric/blob/master/src/main/java/com/xtremelabs/robolectric/shadows/ShadowAbsListView。爪哇](https://github.com/pivotal/robolectric/blob/master/src/main/java/com/xtremelabs/robolectric/shadows/ShadowAbsListView.java)

看起来所有滚动功能都是 ShadowAdapterView： [https ://github.com/pivotal/robolectric/blob/master/src/main/java/com/xtremelabs/robolectric/shadows/ShadowAdapterView.java](https://github.com/pivotal/robolectric/blob/master/src/main/java/com/xtremelabs/robolectric/shadows/ShadowAdapterView.java)

它看起来不像`getFirstVisiblePoition()`或`getLastVisiblePosition()`没有实现。

我能够获得平滑的滚动位置。

```
@RunWith(RobolectricTestRunner.class)
public class SmoothScroll {

    @Test
    public void testSmoothScroll() {
        Activity context = new Activity();
        ListView view = new ListView(context);

        view.smoothScrollToPosition(100);
        Assert.assertEquals(100, Robolectric.shadowOf(view).getSmoothScrolledPosition());
    }

} 
```

您可以获得平滑的滚动位置。根据元素的高度，您可以确定哪些是可见的。

# ruby - Ubuntu 10.04 Rails 部署 - 为什么 capistrano 无法部署到服务器？

> ID：14912946
> 
> 赞同：0
> 
> 时间：2013-02-16T17:16:43.270
> 
> 标签：ruby, capistrano

我正在尝试使用 capistrano 进行部署。服务器上安装了 RVM，ruby 版本为 1.93p385。

这是 cap 生产部署的日志：

[http://pastie.org/private/vs336nrgejpwdkuelufnma#](http://pastie.org/private/vs336nrgejpwdkuelufnma#)

为什么 capistrano 无法部署？

这是部署文件：

```
require "rvm/capistrano"
require "bundler/capistrano"
set :rvm_ruby_string, "1.9.3-p385"
set :rvm_type, :user #Should the user by the username?
require "capistrano/ext/multistage"

set :http_server, :apache2
set :rake, "#{rake} --trace"
set :application, "app"
set :user,        "myuser" # The server's user for deploys

set :ruby_version, "1.9.3-p385"

set :scm,         "git"
set :repository,  "my git repo here"

set :deploy_to,   "/var/www/#{application}"
set :deploy_via,  :remote_cache

set :use_sudo,    true

default_run_options[:pty]   = true # Must be set for the password prompt from git to work
ssh_options[:forward_agent] = true

set :nodejs, true

# if you want to clean up old releases on each deploy uncomment this:
after "deploy:restart", "deploy:cleanup" 
```

服务器是 Ubuntu 10.04 LTS

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:20:11.417

```
** [out :: server] No such file or directory - /var/www/app/releases/20130216170229/config/database.yml 
```

服务器上是否存在此路径？您可能需要`/var/www/app/releases`手动创建该部分，然后 capistrano 将部署到该部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T20:31:30.780

这是 capistrano 部署的常见模式`.gitignore` `database.yml`。然后数据库配置驻留在`<:deploy_to>/shared/config/`. 您使用此 cap 任务对发布目录中的 db 配置进行符号链接：

```
namespace :deploy do
  task :start do ; end
  task :stop do ; end

  desc "Symlink shared folders on each deployment"
    task :symlink_shared do
    run "ln -nfs #{shared_path}/config/database.yml #{release_path}/config/database.yml"
  end
end

before "deploy:assets:precompile", "deploy:symlink_shared" 
```

# powershell - 替换 PowerShell 中的子字符串

> ID：14912948
> 
> 赞同：13
> 
> 时间：2013-02-16T17:17:02.470
> 
> 标签：powershell, replace

我在表单中有一个字符串`-content-`，我想用`&content&`. 如何使用 PowerShell 中的替换来做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-16T17:19:41.813

PowerShell 字符串只是 .NET 字符串，因此您可以：

```
PS> $x = '-foo-'
PS> $x.Replace('-', '&')
&foo& 
```

...或者：

```
PS> $x = '-foo-'
PS> $x.Replace('-foo-', '&bar&')
&bar& 
```

显然，如果要保留结果，请将其分配给另一个变量：

```
PS> $y = $x.Replace($search, $replace) 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-02-16T17:51:23.020

内置`-replace`运算符允许您为此使用正则表达式，例如：

```
C:\PS> '-content-' -replace '-([^-]+)-', '&$1&'
&content& 
```

请注意，在替换字符串上使用单引号是必不可少的，因此 PowerShell 不会解释 $1 捕获组。

# django - 如何比较列表并获取匹配项总数

> ID：14912949
> 
> 赞同：1
> 
> 时间：2013-02-16T17:17:03.333
> 
> 标签：django, django-views

**Garage.cars：**对象车库有汽车的**FK**

**Person.carwishlst：**对象 Person 拥有他们想要的汽车的**FK 。**

在 Django 中，我如何实现以下循环？...

获取与车库拥有的匹配的汽车总数**x个人拥有的汽车。**

结果： **即Grange有你想要的4辆车**

假设的，但可以说 Grange 模型有一个 FK cars = models.ManyToManyField(Cars)

Person 还有一个 FK cars_wishlist = models.ManyToManyField(Cars)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T17:25:09.860

假设`cars`and`carwishlst`是列表：

您将执行以下操作

```
def cars_you_want(cars, carwishlst):
    car_set = [val for val in cars if val in carwishlst]
    return len(car_set) 
```

那应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T17:23:37.727

假设`Garage.cars`和`Person.carwishlist`都是列表，并且包含的​​汽车有一个合理的`__eq__`方法：

```
numberOfWishedCarsInGarage = len (set (garageX.cars) & set (personX.carwishlist) ) 
```

# java - 总是在 Java 中设置 file.encoding 系统属性是个好主意吗？

> ID：14912950
> 
> 赞同：0
> 
> 时间：2013-02-16T17:17:04.283
> 
> 标签：java, encoding, character-encoding

我认为始终`file.encoding`在 Java 应用程序中设置系统属性是个好主意。

假设我*不*设置`file.encoding`. 这意味着Java 将使用依赖于平台的默认字符集（例如 in `String.getBytes`），这使得整个应用程序依赖于平台。

例如，如果我们设置`-Dfile.encoding=UTF-8`，我们保证这样的调用`String.getBytes`在任何平台上都是一样的。

是否有意义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T17:21:35.633

不，这不一定有意义。如果您想在任何平台上读取尚未由您自己的应用程序创建的文件，您最好保留默认的文件编码，因为您需要能够读取这些文件。

如果您读取由您自己的应用程序创建的文件，或者由使用众所周知的指定文件编码的应用程序创建的文件，那么您应该在实例化 IO 读取器和写入器时简单地使用这种编码。

对于诸如`String.getBytes()`不要使用它们的方法，`String.getBytes(Charset)`如果您想使用特定编码而不是平台的默认编码，请使用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-02T17:30:52.537

有条件是的。正如 JB 所提到的，在读取由其他本地应用程序（或同一平台上的其他远程应用程序，如果您有同构服务器场）生成的文件时，使用“平台默认值”有时可能会有所帮助。

因此，请谨慎选择，但总的来说我会说这样做。始终创建自己的读者的建议并不总是可行的。我相信一般来说，大多数使用扩展字符生成文件的东西最终都会使用 UTF-8。

最后，因为许多文件都依赖于您无法控制的选择，所以这将归结为测试和自定义，但我觉得建议您从 UTF-8 开始并根据需要降级而不是相反。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-04T12:55:09.033

设置 System-Property 通常不是一个好主意`file.encoding`，因为这不是 Java 中支持的配置选项。

这意味着它可能会或可能不会起作用。*不工作*可能意味着[Exceptions](https://bugs.openjdk.java.net/browse/JDK-7181721)。确切地说，“它适用于 Java 1.6，它适用于 Windows 上的 Java 1.7，但它不再适用于 Linux 上的 Java 1.7”。

其背后的原因在[这里](http://bugs.java.com/view_bug.do?bug_id=4163515)给出：

> J2SE 平台规范不需要“file.encoding”属性；它是 Sun 实现的内部细节，不应由用户代码检查或修改。它也是只读的；技术上不可能支持在命令行上或在程序执行期间的任何其他时间将此属性设置为任意值。
> 
> 更改 VM 和运行时系统使用的默认编码的首选方法是在启动 Java 程序之前更改底层平台的语言环境。

# opengl - DDS 纹理透明度渲染为黑色 Opengl

> ID：14912954
> 
> 赞同：0
> 
> 时间：2013-02-16T17:17:28.620
> 
> 标签：opengl, textures, alpha-transparency

我目前正在尝试在 Opengl 中渲染纹理对象。一切都很好，直到我想渲染一个透明的纹理。它没有显示对象透明，而是呈现为全黑。

加载纹理文件的方法是这样的：

```
//  structures for reading and information variables
char magic[4];
unsigned char header[124];
unsigned int width, height, linearSize, mipMapCount, fourCC;
unsigned char* dataBuffer;
unsigned int bufferSize;

fstream file(path, ios::in|ios::binary);

//  read magic and header
if (!file.read((char*)magic, sizeof(magic))){
    cerr<< "File " << path << " not found!"<<endl;
    return false;
}

if (magic[0]!='D' || magic[1]!='D' || magic[2]!='S' || magic[3]!=' '){
    cerr<< "File does not comply with dds file format!"<<endl;
    return false;
}

if (!file.read((char*)header, sizeof(header))){
    cerr<< "Not able to read file information!"<<endl;
    return false;
}

//  derive information from header
height = *(int*)&(header[8]);
width = *(int*)&(header[12]);
linearSize = *(int*)&(header[16]);
mipMapCount = *(int*)&(header[24]);
fourCC = *(int*)&(header[80]);

//  determine dataBuffer size
bufferSize = mipMapCount > 1 ? linearSize * 2 : linearSize;
dataBuffer = new unsigned char [bufferSize*2];

//  read data and close file
if (file.read((char*)dataBuffer, bufferSize/1.5))
    cout<<"Loading texture "<<path<<" successful"<<endl;
else{
    cerr<<"Data of file "<<path<<" corrupted"<<endl;
    return false;
}

file.close();

//  check pixel format
unsigned int format;

switch(fourCC){
case FOURCC_DXT1:
    format = GL_COMPRESSED_RGBA_S3TC_DXT1_EXT;
    break;
case FOURCC_DXT3:
    format = GL_COMPRESSED_RGBA_S3TC_DXT3_EXT;
    break;
case FOURCC_DXT5:
    format = GL_COMPRESSED_RGBA_S3TC_DXT5_EXT;
    break;
default:
    cerr << "Compression type not supported or corrupted!" << endl;
    return false;
}

glGenTextures(1, &ID);

glBindTexture(GL_TEXTURE_2D, ID);
glPixelStorei(GL_UNPACK_ALIGNMENT,1);

unsigned int blockSize = (format == GL_COMPRESSED_RGBA_S3TC_DXT1_EXT) ? 8 : 16;
unsigned int offset = 0;

/* load the mipmaps */
for (unsigned int level = 0; level < mipMapCount && (width || height); ++level) {
    unsigned int size = ((width+3)/4)*((height+3)/4)*blockSize;
    glCompressedTexImage2D(GL_TEXTURE_2D, level, format, width, height,
                        0, size, dataBuffer + offset);

    offset += size;
    width  /= 2;
    height /= 2;
}

textureType = DDS_TEXTURE;

return true; 
```

在片段着色器中，我只设置了 gl_FragColor = texture2D(myTextureSampler, UVcoords)

我希望有一个简单的解释，例如缺少一些代码。在 openGL 初始化中，我 glEnabled GL_Blend 并设置了一个混合功能。

有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T01:18:22.463

1.  确保混合功能是您想要完成的正确功能。对于你所描述的应该是 glBlendFunc(GL_SRC_ALPHA,GL_ONE_MINUS_SRC_ALPHA);

2.  您可能不应该在您的 openGL 初始化函数中设置混合函数，而应该将其包裹在您的绘图调用中，例如：

    ```
    glEnable(GL_BLEND)
    glBlendFunc(GL_SRC_ALPHA,GL_ONE_MINUS_SRC_ALPHA);

    //gl draw functions (glDrawArrays,glDrawElements,etc..)

    glDisable(GL_BLEND) 
    ```

3.  您是否在交换缓冲区之前清除 2D 纹理绑定？IE ...

    ```
    glBindTexture(GL_TEXTURE_2D, 0); 
    ```

# svg - SVG 图像链接

> ID：14912958
> 
> 赞同：0
> 
> 时间：2013-02-16T17:18:43.663
> 
> 标签：svg, hotlinking

我正在尝试使我的矢量图像可点击。我已经搜索了互联网，找不到答案。在代码中我还需要什么？

```
<div id="logo">  
<a href="http://fpmnky.com" target="_self">
<span>
    <object width="488" height="115" data="http://fpmnky.com/images/fpmlogo2.svg" type="image/svg+xml">
    <img width="488" height="115" src="http://fpmnky.com/images/fpmlogo2.svg" alt="Star"/>
        <span>Your browser doesn't support SVG images</span>
    </object>
</span>
</a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:41:56.607

```
 <div id="logo">
<a href="http://fpmnky.com" target="_self">
    <img src="http://fpmnky.com/images/fpmlogo2.svg" width="488" height="115" alt="fpmlogo" />
</a> 
```

# css - Html li 项目每个显示在一行

> ID：14912960
> 
> 赞同：0
> 
> 时间：2013-02-16T17:18:45.057
> 
> 标签：css

我看不到 CSS 如何或在何处使这些项目显示在两列中。我只希望它们在一行（全宽）上，网络工具不会显示任何奇怪的 CSS，有什么想法\快速修复？

```
 #demoOne li { float:left;display: inline  !important;border: #336699 solid 1px;background: lightblue;}
<ul id="demoOne">
<li>Item</li>
</ul> 
```

![在此处输入图像描述](../Images/2d07aaefdbdc3f47ad5b4ba1240d7687.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:21:46.460

而不是`float:left`和`display:inline`使用`display:block`，它们不会显示在两列中

顺便提一句。一切`float:left`都有`display:block`所以我不知道你想用它来实现什么`display:inline!important`:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T17:23:04.253

尝试

```
display:block 
```

而不是

```
display:inline 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T17:29:39.983

对于单行，我建议使用

显示：框

chrome n safari 使用 display:-webkit-box opera 使用 display:-o-box forefox 使用 display:-moz-box ie 使用 display:-ms-box

# cakephp - CakePHP：提交后保持选中相同的复选框

> ID：14912961
> 
> 赞同：0
> 
> 时间：2013-02-16T17:18:46.027
> 
> 标签：cakephp, submit, checkbox

提交后如何保持相同的复选框处于选中状态？表单上的所有其他输入字段会自动保留这些值。我认为这也适用于复选框，但不。

```
echo $this->Form->input('type_id', array(
    'multiple' => 'checkbox',
    'options' => array(
        '1' => 'Til salgs',
        '2' => 'Ønskes kjøpt',
        '3' => 'Gis bort'
    ),
    'div' => false,
    'label' => false
)); 
```

我相信这可以在控制器中完成，但是如何？

## 编辑：

自从我发布这个问题以来，我已经更改为 CakeDcs Search 插件，因为我之前已经使用它。仍然......这次我无法让它工作。

添加模型和控制器代码：

### 应用控制器

```
 public $components = array('DebugKit.Toolbar',
    'Session',
    'Auth' => array(
        'loginAction' => '/',
        'loginRedirect' => '/login',
        'logoutRedirect' => '/',
        'authError' => 'Du må logge inn for å vise denne siden.',
        'authorize' => array('Controller'),
    ),
    'Search.Prg'
);
public $presetVars = true; //Same as in model filterArgs(). For Search-plugin. 
```

### 广告控制器

```
public function view() {
    $this->set('title_for_layout', 'Localtrade Norway');
    $this->set('show_searchbar', true); //Shows searchbar div in view
    $this->log($this->request->data, 'debug');

    //Setting users home commune as default filter when the form is not submitted.
    $default_filter = array(
        'Ad.commune_id' => $this->Auth->user('User.commune_id')
    );

    $this->Prg->commonProcess(); //Search-plugin
    $this->paginate = array(
        'conditions' => array_merge($default_filter, $this->Ad->parseCriteria($this->passedArgs)), //If Ad.commune_id is empty in second array, then the first will be used.
        'fields' => $this->Ad->setFields(),
        'limit' => 3
    );
    $this->set('res', $this->paginate());
} 
```

### 模型

```
public $actsAs = array('Search.Searchable');
public $filterArgs = array(
    'search_field' => array('type' => 'query', 'method' => 'filterSearchField'),
    'commune_id' => array('type' => 'value'),
    'type_id' => array('type' => 'int')
);

public function filterSearchField($data) {
    if (empty($data['search_field'])) {
        return array();
    }
    $str_filter = '%' . $data['search_field'] . '%';
    return array(
        'OR' => array(
            $this->alias . '.title LIKE' => $str_filter,
            $this->alias . '.description LIKE' => $str_filter,
        )
    );
}

/**
 * Sets the fields which will be returned by the search.
 * 
 * @access public
 * @return array Database table fields
 * @author Morten Flydahl
 * 
 */
public function setFields() {
    return array(
        'Ad.id',
        'Ad.title',
        'Ad.description',
        'Ad.price',
        'Ad.modified',
        'User.id',
        'User.first_name',
        'User.middle_name',
        'User.last_name',
        'User.link',
        'User.picture_url',
        'Commune.name',
        'Type.id',
        'Type.name'
    );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T18:50:50.487

您必须手动设置`selected`输入选项，作为带有“ *keys = values = intval(checkbox id)* ”的数组

我无法解释为什么这种格式，但这是我让它工作的唯一方法。

这是我的代码：

```
echo $this->Form->create('User');

// Read the submitted value
$selected = $this->Form->value('User.Albums');

// Formats the value
if (empty($selected)) {
  $selected = array(); // avoid mess
} else {
  $selected = array_map('intval', $selected);
  $selected = array_combine ($selected, $selected);
}

// Renders the checkboxes
echo $this->Form->input('Albums',array(
  'type' => 'select',
  'multiple' => 'checkbox',
  'options' => $albums, // array ( (int)id => string(label), ... )
  'selected' => $selected, // array ( (int)id => (int)id, ... )
)); 
```

希望这可以帮助。++

# c# - 在 UserControl 中使用属性

> ID：14912965
> 
> 赞同：0
> 
> 时间：2013-02-16T17:19:11.390
> 
> 标签：c#, wpf, xaml, custom-controls, property-binding

我制作了一个用户控件并添加了一个新属性，如下所示：

```
public partial class MyControl : UserControl
{
    public static readonly DependencyProperty SelectedBrushProperty;
    static MyControl() {
        SelectedBrushProperty = DependencyProperty.Register("SelectedBrush",
                                                            typeof(Brush),
                                                            typeof(MyControl),
                                                            new PropertyMetadata(Brushes.AliceBlue));
    }

    public Brush SelectedBrush {
        get {
            return (Brush)GetValue(SelectedBrushProperty);
        }
        set {
            SetValue(SelectedBrushProperty,value);
        }
    }
    public MyControl()
    {
        InitializeComponent();
    }
} 
```

我的问题是：在我的自定义控件的 XAML 中，我该如何使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T18:04:28.503

您可以绑定到控件的 XAML 中的属性：

```
<UserControl x:Class="MyNamespace.MyControl" ...>
    <Grid>
        <Label Background="{Binding SelectedBrush,
            RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=UserControl}}"/>
    </Grid>
</UserControl> 
```

如果`DataContext = this;`在 MyControl 的构造函数中设置，可以省略`RelativeSource`绑定的：

```
<Label Background="{Binding SelectedBrush}"/> 
```

* * *

请注意，不需要静态构造函数。你可以这样写：

```
public static readonly DependencyProperty SelectedBrushProperty =
    DependencyProperty.Register("SelectedBrush", typeof(Brush), typeof(MyControl),
                                new PropertyMetadata(Brushes.AliceBlue)); 
```

# python - matplotlib - 允许条形图超出图表限制？

> ID：14912967
> 
> 赞同：2
> 
> 时间：2013-02-16T17:19:12.167
> 
> 标签：python, matplotlib

是否可以允许条形图或条形图的条形超出图表的范围？

例如，如果我的数据是`np.asarray([1,3,70,924,3])`并且我想将总高度限制为 300，是否可以不修改基础数据？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T17:24:46.187

当然。只需设置绘图的 y 限制：

```
import matplotlib.pyplot as plt
import numpy as np

data = np.array([1,3,70,924,3])

plt.bar(np.arange(data.size), data)
plt.ylim([0, 300])

plt.show() 
```

如果您希望条形图超出绘图顶部，请指定`clip_on=False`：

```
import matplotlib.pyplot as plt
import numpy as np

data = np.array([1,3,70,924,3])

plt.bar(np.arange(data.size), data, clip_on=False)
plt.ylim([0, 300])

plt.show() 
```

![在此处输入图像描述](../Images/d8988d84dd1d3fcd8582b650bbd0fc51.png)

# android - SQLiteOpenHelper close() 从未被显式调用

> ID：14912970
> 
> 赞同：0
> 
> 时间：2013-02-16T17:19:32.907
> 
> 标签：android, sqliteopenhelper

安卓 2.3.3

我的应用程序中有两个访问数据库的活动。每当我改变手机的方向时，我都会在 logcat 中收到以下错误，尽管该程序确实可以工作。我从必须调用`close()`并关闭数据库和游标的错误中了解到。但我到底把它放在哪里。

将活动的数据库和游标关闭`onDestroy()`，解决问题吗？

```
 Database pm;
        Cursor c;

    @Override
        public void onDestroy() {
          pm.close();
          c.close();
          // Any other cursors that are used...

            super.onDestroy();
    } 
```

这是需要的logcat跟踪...

```
02-16 22:37:50.419: E/Database(602): close() was never explicitly called on database 'portfolio' 
02-16 22:37:50.419: E/Database(602): android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here
02-16 22:37:50.419: E/Database(602):    at android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:1849)
02-16 22:37:50.419: E/Database(602):    at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:822)
02-16 22:37:50.419: E/Database(602):    at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:856)
02-16 22:37:50.419: E/Database(602):    at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:849)
02-16 22:37:50.419: E/Database(602):    at android.app.ContextImpl.openOrCreateDatabase(ContextImpl.java:553)
02-16 22:37:50.419: E/Database(602):    at android.content.ContextWrapper.openOrCreateDatabase(ContextWrapper.java:203)
02-16 22:37:50.419: E/Database(602):    at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:118)
02-16 22:37:50.419: E/Database(602):    at com.xx.xxx.Database.<init>(Database.java:21)
02-16 22:37:50.419: E/Database(602):    at com.xx.xxx.Brokerage_Settings.onCreate(Brokerage_Settings.java:118)
02-16 22:37:50.419: E/Database(602):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
02-16 22:37:50.419: E/Database(602):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
02-16 22:37:50.419: E/Database(602):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
02-16 22:37:50.419: E/Database(602):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
02-16 22:37:50.419: E/Database(602):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
02-16 22:37:50.419: E/Database(602):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-16 22:37:50.419: E/Database(602):    at android.os.Looper.loop(Looper.java:130)
02-16 22:37:50.419: E/Database(602):    at android.app.ActivityThread.main(ActivityThread.java:3687)
02-16 22:37:50.419: E/Database(602):    at java.lang.reflect.Method.invokeNative(Native Method)
02-16 22:37:50.419: E/Database(602):    at java.lang.reflect.Method.invoke(Method.java:507)
02-16 22:37:50.419: E/Database(602):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:878)
02-16 22:37:50.419: E/Database(602):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:636)
02-16 22:37:50.419: E/Database(602):    at dalvik.system.NativeStart.main(Native Method) 
```

关闭数据库和游标对象的最佳做法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:37:37.543

在 onPause() 中调用 close。当您更改移动设备的方向时，您的应用程序会更改状态，并且您应该在 android 系统调用 super.onPause() 之前关闭数据库/光标对象。在命令 super.onPause() 之前在 onPause 方法中调用 close。

# javascript - 基于 JavaScript 输入的背景变化？

> ID：14912973
> 
> 赞同：0
> 
> 时间：2013-02-16T17:20:02.930
> 
> 标签：javascript

我的功能以前可以工作，但现在不行了。我正在尝试添加一个 if 语句，当输入为空时，它会返回默认背景颜色。

```
var path = /^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/g;

function col(obj) {
    var val = obj.value;
    if (path.test(val)) {
        document.body.style.backgroundColor = '#' + val;
    }
}

window.onload = function () {
    document.getElementById('bgcol').onkeyup = function () {
        col(this);
    }
    if (getElementById('bgcol'.value = null || ""){
    document.body.style.backgroundColor = '#000000';
}
} 
```

//结束javascript，下面开始html

```
 <input id="bgcol" placeholder="enter hexadecimal color"></input> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T17:21:47.240

[**工作小提琴**](http://jsfiddle.net/hWBLQ/)

```
if (getElementById('bgcol').value == "") { 
```

和

```
document.getElementById('bgcol').onkeyup = function () {
    if (this.value == ""){
       document.body.style.backgroundColor = '#000000';
    }
    else {
       col(this);
    }
} 
```

和

```
<input id="bgcol" placeholder="enter hexadecimal color" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T17:24:53.107

您需要`document.getElementById`并清理您的语法：

```
if ( document.getElementById('bgcol').value == null || document.getElementById('bgcol').value == "") 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-16T17:24:38.187

试试这个简化版本的代码：

```
window.onload = function() {
    document.getElementById('bgcol').onkeyup = function() {
        var col = this.value;
        if( !col.match(/^#?(?:[0-9a-f]{3}){1,2}$/i)) col = "#000000";
        if( col.charAt(0) != "#") col = "#"+col;
        document.body.style.backgroundColor = col;
    };
}; 
```

它使用更简单的正则表达式，还允许`#`接受和可选。

# android - 如何编写 Android 应用程序以从网络服务器下载歌曲并从 sdcard 播放

> ID：14912977
> 
> 赞同：-1
> 
> 时间：2013-02-16T17:20:29.607
> 
> 标签：android, download, android-sdcard

我打算在 Android 中构建一个媒体播放器应用程序。单击此应用程序中的链接时，该应用程序将首先将媒体（mp3 文件）下载到手机的 sd 卡。下载完成后，播放器将开始播放文件。

我想知道这是否可能 - 1\. 下载发生在后台，用户对下载过程一无所知 2\. 下载发生时应用程序仍然保持焦点，因此用户完全不知道该过程，他可以继续使用这个应用程序的其他部分

该文件将来自我托管的网站。这是一个php网站。例如，该站点的服务器中有 mp3，歌曲的链接将采用这种格式 - www.abc.com/ 该应用程序最初会显示 10 个图标，每个图标都是指向其中一首歌曲的链接这个网站。所以 icon1 实际上会指向 www.abc.com/song1.mp3，等等。

所以整个问题都围绕着下载并在下载完 song1.mp3 后从 sdcard 播放的过程展开。

任何有关如何执行此操作的指示都非常感谢。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:23:53.597

> 1.  下载发生在后台，用户不知道下载过程

启动 AsyncTask 或 Thread 以使用标准 Java IO API 进行下载，以读取文件并将其保存到 SD 卡。

下载完文件后，只需使用 SoundPool 或 MediaPlayer 即可播放。

# vb.net - If Else 使用表中的列

> ID：14912981
> 
> 赞同：0
> 
> 时间：2013-02-16T17:20:49.703
> 
> 标签：vb.net, datatable

我有一个名为 的表`studentlogs`，它上面有列状态。当我在学生日志上完成插入记录时，我想使用一个`if .. else`语句。状态列只能有 3 个值`1`：`2`或`3`。

现在，我想在插入记录后执行以下操作：

```
if status="1" then
   CALL SENDSMS()
ENDif
if status="2" then
   msgbox("")
ENDif
if status="3" then
   msgbox("") 
```

当我处理列时我该怎么做？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-16T18:18:30.393

要获取特定列中行的值，可以在行对象后使用括号并指定`ColumnName`or`ColumnIndex`属性来获取值。

此外，当有多个潜在价值时，您可以使用一个`case`语句，而不是很多`ElseIf`语句。

### MVCE 设置

```
'declare local variables
Dim dr As DataRow

'create table
Dim studentLogs As New DataTable("StudentLogs")

'add columns
With studentLogs
    .Columns.Add("Status", GetType(Integer))
    .Columns.Add("OtherCol1", GetType(String))
End With

'add values
With studentLogs
    dr = studentLogs.NewRow()
    dr("Status") = 1
    dr("OtherCol1") = "Joey"
    studentLogs.Rows.Add(dr)
End With 
```

### 检查列值/行状态

```
For Each row As DataRow In studentLogs.Rows
    Select Case row("Status")
        Case 1
            Call SENDSMS()
        Case 2
            MsgBox("2")
            Exit For
        Case 3
            MsgBox("3")
    End Select
Next 
```

# php - 修改类函数内部的类属性

> ID：14912984
> 
> 赞同：0
> 
> 时间：2013-02-16T17:21:20.110
> 
> 标签：php, class, this

我从 php.net 网站获得了代码：

```
<?php
class foo {
    public $foo;
    public $bar;
    public function foo() {
        $this->foo = 'Foo';
        $this->bar = array('Bar1', 'Bar2', 'Bar3');
    }
}

$foo = new foo();
echo <<<EOT
I am printing some $foo->foo.
Now, I am printing some {$foo->bar[1]}.
EOT;
?> 
```

但我很困惑，每个“foo”代表什么？你真的可以在不调用函数的情况下修改方法（函数）中的属性（变量）吗？

我写了一个类似的代码，但什么也没发生

```
<?php
class page {
    public $meta;
    public $buttons;
    public function show_meta() {
        $this->meta = "I'm a website";
        $this->buttons = array(
            "home" => "index.php",
            "about" => "about.php"
            );
    }
}

$index = new page();
echo $index->meta;
echo $index->buttons["home"];
?> 
```

我是一个php学习者，我需要你的帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T17:24:11.937

`function foo`是一个 PHP4 风格的构造函数（注意函数与类同名）。在 PHP5 中，您将`function __construct()`改为编写。

`new foo()`实际上调用构造函数，初始化你的变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T17:24:23.350

首先，是的，因为您的属性是`public`.

在第二种情况下，您可以使用字符串引用来删除警告。

```
 $index->buttons["home"]; 
```

您永远不会调用`show_meta`，因此永远不会填充数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T17:24:47.450

这是构造函数方法的旧 php 语法。构造函数是特殊方法，每当创建类中的新对象时都会调用这些方法。构造函数的新命名约定说，所有构造函数都命名为`__construct`.

要使上面的代码正常工作，您必须在访问这两个变量之前调用 show_meta 或使 show_meta 成为构造函数。

```
$index = new page();
$index->show_meta();
echo $index->meta;
echo $index->buttons["home"]; 
```

顺便说一句.. home 是一个字符串，应该在“”内，或者你至少提出一个警告。

# hibernate - 创建名为“entityManagerFactory”的bean时出错+ NoClassDefFoundError：org/hibernate/MappingException

> ID：14912986
> 
> 赞同：2
> 
> 时间：2013-02-16T17:21:24.340
> 
> 标签：hibernate, jakarta-ee, jpa, spring-mvc, hibernate-mapping

我正在尝试使用 创建一个简单的`spring MVC`项目，但是在尝试使用和`MySQL`连接我的项目与`MySQL`数据库 时遇到一些错误 但得到以下例外：`hibernate``JPA`

```
Error :
 Error creating bean with name 'entityManagerFactory' defined in ServletContext resource [/WEB-INF/spring/db.xml]: Invocation of init method`enter code here` failed; nested exception is java.lang.NoClassDefFoundError: org/hibernate/MappingException 
```

以下是错误的完整堆栈跟踪：

```
 [DEBUG] add dependency to webapploader org.codehaus.jackson:jackson-core-asl:1.9.4:compile
16 Feb, 2013 9:41:41 PM org.apache.catalina.startup.Embedded start
INFO: Starting tomcat server
16 Feb, 2013 9:41:41 PM org.apache.catalina.core.StandardEngine start
INFO: Starting Servlet Engine: Apache Tomcat/6.0.29
16 Feb, 2013 9:41:41 PM org.apache.catalina.core.ApplicationContext log
INFO: Initializing Spring root WebApplicationContext
INFO : org.springframework.web.context.ContextLoader - Root WebApplicationContext: initialization started
INFO : org.springframework.web.context.support.XmlWebApplicationContext - Refreshing Root WebApplicationContext: startup date [Sat Feb 16 21:41:41 IST 2013]; root of context hierarchy
INFO : org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from ServletContext resource [/WEB-INF/spring/root-context.xml]
INFO : org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from ServletContext resource [/WEB-INF/spring/db.xml]
INFO : org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from URL [file:/C:/Users/Sandeep/Documents/workspace-sts-3.1.0.RELEASE/SandeepSpringMVC/target/classes/application-context-root.xml]
INFO : org.springframework.context.annotation.ClassPathBeanDefinitionScanner - JSR-330 'javax.inject.Named' annotation found and supported for component scanning
INFO : org.springframework.context.annotation.ClassPathBeanDefinitionScanner - JSR-330 'javax.inject.Named' annotation found and supported for component scanning
INFO : org.springframework.context.annotation.ClassPathBeanDefinitionScanner - JSR-330 'javax.inject.Named' annotation found and supported for component scanning
INFO : org.springframework.beans.factory.config.PropertyPlaceholderConfigurer - Loading properties file from class path resource [db.properties]
INFO : org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
INFO : org.springframework.web.context.support.XmlWebApplicationContext - Bean 'dataSource' of type [class org.apache.commons.dbcp.BasicDataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
INFO : org.springframework.web.context.support.XmlWebApplicationContext - Bean 'org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter#1261218' of type [class org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
INFO : org.springframework.beans.factory.support.DefaultListableBeanFactory - Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@1271ba: defining beans [placeholderConfig,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,entityManagerFactory,dataSource,transactionManager,sessionFactory,org.springframework.aop.config.internalAutoProxyCreator,org.springframework.transaction.annotation.AnnotationTransactionAttributeSource#0,org.springframework.transaction.interceptor.TransactionInterceptor#0,org.springframework.transaction.config.internalTransactionAdvisor,org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor#0,userAccountRepository,org.springframework.data.repository.core.support.RepositoryInterfaceAwareBeanPostProcessor#0,org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0,userServiceImpl,userDaoImpl,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0]; root of factory hierarchy
ERROR: org.springframework.web.context.ContextLoader - Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0': Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in ServletContext resource [/WEB-INF/spring/db.xml]: Invocation of init method failed; nested exception is java.lang.NoClassDefFoundError: org/hibernate/MappingException
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:527)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
    at org.springframework.context.support.AbstractApplicationContext.registerBeanPostProcessors(AbstractApplicationContext.java:728)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:449)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:384)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at bstractAutowireCapableBeanFactory.java:519)
    ... 40 more
Caused by: java.lang.NoClassDefFoundError: org/hibernate/MappingException
    at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:72)
    at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:225)
    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:308)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
    ... 55 more
Caused by: java.lang.ClassNotFoundException: org.hibernate.MappingException
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1645)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1491)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:320)
    ... 60 more
16 Feb, 2013 9:41:42 PM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0': Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in ServletContext resource [/WEB-INF/spring/db.xml]: Invocation of init method failed; nested exception is java.lang.NoClassDefFoundError: org/hibernate/MappingException
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:527)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
    at org.springframework.context.support.AbstractApplicationContext.registerBeanPostProcessors(AbstractApplicationContext.java:728)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:449)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:384)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4135)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4630)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:785)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:445)
    at org.apache.catalina.startup.Embedded.start(Embedded.java:825)
    at org.codehaus.mojo.tomcat.AbstractRunMojo.startContainer(AbstractRunMojo.java:558)
    at org.codehaus.mojo.tomcat.AbstractRunMojo.execute(AbstractRunMojo.java:255)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in ServletContext resource [/WEB-INF/spring/db.xml]: Invocation of init method failed; nested exception is java.lang.NoClassDefFoundError: org/hibernate/MappingException
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeansOfType(DefaultListableBeanFactory.java:400)
    at org.springframework.beans.factory.BeanFactoryUtils.beansOfTypeIncludingAncestors(BeanFactoryUtils.java:275)
    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.detectPersistenceExceptionTranslators(PersistenceExceptionTranslationInterceptor.java:139)
    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.<init>(PersistenceExceptionTranslationInterceptor.java:79)
    at org.springframework.dao.annotation.PersistenceExceptionTranslationAdvisor.<init>(PersistenceExceptionTranslationAdvisor.java:70)
    at org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor.setBeanFactory(PersistenceExceptionTranslationPostProcessor.java:99)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeAwareMethods(AbstractAutowireCapableBeanFactory.java:1475)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1443)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
    ... 40 more
Caused by: java.lang.NoClassDefFoundError: org/hibernate/MappingException
    at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:72)
    at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:225)
    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:308)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
    ... 55 more
Caused by: java.lang.ClassNotFoundException: org.hibernate.MappingException
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1645)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1491)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:320)
    ... 60 more
16 Feb, 2013 9:41:42 PM org.apache.catalina.core.StandardContext start
SEVERE: Error listenerStart
16 Feb, 2013 9:41:42 PM org.apache.catalina.core.StandardContext start
SEVERE: Context [/Sandeep] startup failed due to previous errors
16 Feb, 2013 9:41:42 PM org.apache.catalina.core.ApplicationContext log
INFO: Closing Spring root WebApplicationContext
16 Feb, 2013 9:41:42 PM org.apache.catalina.loader.WebappClassLoader clearReferencesJdbc
SEVERE: The web application [/Sandeep] registered the JBDC driver [com.mysql.jdbc.Driver] but failed to unregister it when the web application was stopped. To prevent a memory leak, the JDBC Driver has been forcibly unregistered 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:41:12.857

如果您使用的是 maven 和 Hibernate 版本，那么 3.3

```
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-core</artifactId>
    <version>x.y.z.Final</version>
</dependency> 
```

如果您不使用 Maven，请确保它`hibernate-core-x.y.z.jar`在您的类路径中。

# ruby - 如何测试日期对象数组是否正确

> ID：14912995
> 
> 赞同：0
> 
> 时间：2013-02-16T17:22:25.253
> 
> 标签：ruby, rspec

我正在尝试使用这样的数组：

```
 MY_ARRAY = ["Jan 31, 2013", "Feb 28, 2013", "Mar 31, 2013"] 
```

然后把它变成日期：

```
def array_as_date_objects
  MY_ARRAY.map { |month| Date.parse(month)}
end 
```

这产生了这个：

```
 [#<Date: 2013-01-31 (4912645/2,0,2299161)>, #<Date: 2013-02-28 (4912703/2,0,2299161)>, #<Date: 2013-03-31 (4912763/2,0,2299161)>] 
```

伟大的。但我也想测试这个日期对象数组是否符合我的预期。我该怎么做？

我曾希望这样的事情会奏效，但主题标签会注释掉剩余的信息。

```
 MyClass.new.refined_schedule.should == :[#<Date: 2013-01-31 (4912645/2,0,2299161)>, #<Date: 2013-02-28 (4912703/2,0,2299161)>, #<Date: 2013-03-31 (4912763/2,0,2299161)>] 
```

编辑：所以只是为了提供更多关于我的情况的信息，我主要关心的是如何存根这个数组。我不需要相信 Ruby 正确地创建了数组，我只需要正确地存根方法。抱歉不清楚。

```
describe "#final_schedule" do
  it "generates an array of pay dates that do not fall on any weekend day" do
    test_schedule = MyClass.new
    test_schedule.stub(:refined_schedule) { [#<Date: 2013-01-31 (4912645/2,0,2299161)>, #<Date: 2013-02-28 (4912703/2,0,2299161)>, #<Date: 2013-03-31 (4912763/2,0,2299161)> ] } 
    test_schedule.final_schedule.should == [ "Thursday, Jan 31, 2013", "Thursday, Feb 28, 2013","Sunday, Mar 31, 2013"]
  end
 end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T17:50:31.673

当我编写代码测试时，我会查看是否返回了一个数组，并且该数组的所有内容都是某种类型。

这些单独的元素是否通过解析正确地从字符串转换为 DateTime 对象，我并不关心，因为该特定测试发生在编译语言时的测试期间，并且是 DateTime 单元测试的一部分。

当然，我们可以完全偏执或肛门，并测试从我们的方法到原子级别的代码的各个方面，并确信一切正常，或者我们可以相信语言的开发人员正在尽其所能，并建立在那。到目前为止，我还没有理由怀疑他们失败了，所以我可以走更简单的道路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T17:56:49.780

```
#<Date: 2013-01-31 (4912645/2,0,2299161)> 
```

这是对象的可打印表示。您不能只写它并希望 ruby​​ 将其理解为日期。日期对象是用构造函数创建的：

```
Date.new( 2013, 1, 31 ) 
```

因此，如果您想测试解析结果是否正确（有时这是必要的，例如对于这些格式：mm/dd/yy vs dd/mm/yy），您应该执行以下操作：

```
MyClass.new.refined_schedule.should == [Date.new( 2013, 1, 31 ), Date.new( 2013, 2, 28 ),..] 
```

# html - 弹簧和瓷砖 - 包括 .html 文件

> ID：14912997
> 
> 赞同：1
> 
> 时间：2013-02-16T17:22:46.723
> 
> 标签：html, spring, tiles

我有一个使用瓷砖作为 UI 框架的春季项目。我想提供一个处理静态 html 文件的通用控制器（没有动态内容 - 所以没有自定义控制器）。通用控制器是`org.springframework.web.servlet.mvc.UrlFilenameViewController`. 如果我将静态内容放在`.jsp`扩展文件中，那么整个事情都会起作用。只要我尝试将它们放入`.html`- 我会收到 404 错误，我想找出原因。

网页.xml：

```
<display-name>
    lyricsBase
</display-name>
<servlet>
    <servlet-name>lyricsBaseApp</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>lyricsBaseApp</servlet-name>
    <url-pattern>*.html</url-pattern>
</servlet-mapping>
<welcome-file-list>
    <welcome-file>list.html</welcome-file>
</welcome-file-list>
<error-page>
    <error-code>404</error-code>
    <location>/WEB-INF/jsp/404.jsp</location>
</error-page> 
```

歌词BaseApp-servlet.xml：

```
<bean id="tilesConfigurer" class="org.springframework.web.servlet.view.tiles3.TilesConfigurer">
    <property name="definitions">
        <list>
            <value>/WEB-INF/tiles.xml</value>
        </list>
    </property>
</bean>

<bean id="tilesViewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver">
    <property name="viewClass" value="org.springframework.web.servlet.view.tiles3.TilesView" />
</bean>

<bean id="staticViewController" class="org.springframework.web.servlet.mvc.UrlFilenameViewController">
    <property name="prefix" value="t." />
</bean>

<bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
    <property name="mappings">
        <props>
            <prop key="/list.html">jukeboxController</prop>
            <prop key="/display.html">songController</prop>
            <prop key="/static/about.html">staticViewController</prop>
        </props>
    </property>
</bean> 
```

瓷砖.xml：

```
<definition name="t.base" template="/WEB-INF/tiles/base.jsp">
    <put-attribute name="title" value="SomeTitle"/>
</definition>

<definition name="t.static/about" extends="t.base">
    <put-attribute name="body" value="/WEB-INF/static/about.jsp"/>
    <put-attribute name="title" expression="about"/>
</definition> 
```

这是我访问静态页面的 URL：`http://localhost:8084/lyricsBase/static/about.html`

我在正确的目录中都有`about.html`和`about.jsp`文件。如果一个

```
<put-attribute name="body" value="/WEB-INF/static/about.jsp"/> 
```

至

```
<put-attribute name="body" value="/WEB-INF/static/about.html"/> 
```

我开始在tomcat中收到警告：

```
2013-02-16 18:21:45 org.springframework.web.servlet.DispatcherServlet noHandlerFound
WARNING: No mapping found for HTTP request with URI [/lyricsBase/WEB-INF/static/about.html] in DispatcherServlet with name 'lyricsBaseApp' 
```

为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-12T12:21:48.283

我知道这个问题是 2 年前提出的，但我遇到了同样的问题，也许其他人也遇到过。

我认为 Tiles 只支持 JSP、Freemarker 或 Velocity。我可以找到解决方法。像这样定义一个静态处理程序：

```
@Configuration
@EnableWebMvc
@ComponentScan(value = "com.xy"))
public class WebConfig extends WebMvcConfigurerAdapter {
@Override
public void addResourceHandlers(final ResourceHandlerRegistry registry) {
    registry.addResourceHandler("/lyricsBase/static/**")
            .addResourceLocations("/WEB-INF/static/");
    }
} 
```

现在您应该可以通过图块使用您的 html 模板：

```
<put-attribute name="body" value="/lyricsBase/static/about.html"/> 
```