# StackOverflow 问答 13031000-13031999

# delphi - 如何读取 AD 显示名称

> ID：13031002
> 
> 赞同：1
> 
> 时间：2012-10-23T13:01:43.927
> 
> 标签：delphi, active-directory, pascal

我正在使用德尔福帕斯卡版本。4 我有一个用户姓名首字母，需要从姓名首字母中获取活动目录显示名称，所以我不想更改 AD 只是读取 - 一个函数会很好，如下所示：

```
fullname, user :string;
user:='DKTB' 
```

（调用函数）

```
fullname:=getAdDispayName(user); 
```

（通话后全名 = 'Torben Bagge'）

我用谷歌找到它，但只能在 C 中找到它，而不是帕斯卡。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:38:42.593

You can easily do this using the IDirectorySearch Interface. I made an quick example for you (don't forget to add proper error handling):

```
uses
  ActiveX,
  JwaAdsTlb, JwaActiveDS; // From Jedi ApiLib

function GetADDisplayName(const Username: String): String;
var
  hr: HRESULT;
  DirSearch: IDirectorySearch;
  SearchInfo: ADS_SEARCHPREF_INFO;
  hSearch: ADS_SEARCH_HANDLE;
  col: ADS_SEARCH_COLUMN;
  Filter: String;
  Attributes: array of PChar;
begin
  Result := 'Undefined Result';

  // Initialize COM
  CoInitialize(nil);

  try
    // Change line below with your domain name
    hr := ADsGetObject('LDAP://dc=contoso,dc=com',
      IID_IDirectorySearch, Pointer(DirSearch));
    Win32Check(Succeeded(hr));

    SearchInfo.dwSearchPref := ADS_SEARCHPREF_SEARCH_SCOPE;
    SearchInfo.vValue.dwType := ADSTYPE_INTEGER;
    SearchInfo.vValue.Integer := ADS_SCOPE_SUBTREE;

    hr := DirSearch.SetSearchPreference(@SearchInfo, 1);
    Win32Check(Succeeded(hr));

    Filter := Format('(&(objectClass=user)(sAMAccountName=%s))',
      [Username]);

    SetLength(Attributes, 1);
    Attributes[0] := 'displayName';

    // When using Dynamic Array with WinApi ALWAYS use pointer to first element!
    hr := DirSearch.ExecuteSearch(PChar(Filter), @Attributes[0],
      Length(Attributes), hSearch);
    Win32Check(Succeeded(hr));

    try
      hr := DirSearch.GetFirstRow(hSearch);
      Win32Check(Succeeded(hr));

      hr := DirSearch.GetColumn(hSearch, Attributes[0], col);
      if Succeeded(hr) then
      begin
        Result := col.pADsValues^.CaseIgnoreString;
        DirSearch.FreeColumn(@col);
      end;
    finally
      DirSearch.CloseSearchHandle(hSearch);
    end;
  finally
    // UnInitialize COM
    CoUninitialize;
  end;
end; 
```

# cakephp - CakePHP分页顺序不起作用

> ID：13031006
> 
> 赞同：8
> 
> 时间：2012-10-23T13:01:57.440
> 
> 标签：cakephp

我正在使用 cakephp V2.0.2

我遇到了麻烦

```
$this->paginate = array(
                "fields" => array(
                    "Player.join_country"
                ),
                "joins" => array(
                    array(
                        "table" => "banner_key_current_ext",
                        "alias" => "BannerKeyCurrentExt",
                        "type" => "inner",
                        "conditions" => "BannerKeyCurrentExt.banner_key_id = BannerKeyCurrent.banner_key_id"
                    ),
                    array(
                        "table" => "players",
                        "alias" => "Player",
                        "type" => "inner",
                        "conditions" => "BannerKeyCurrentExt.identifier = Player.zban_player_id" . $country_condition
                    ),
                    array(
                        "table" => "users",
                        "alias" => "User",
                        "type" => "inner",
                        "conditions" => "BannerKeyCurrent.user_id = User.user_id"
                    ),
                    array(
                        "table" => "tag_links",
                        "alias" => "TagLinks",
                        "type" => "inner",
                        "conditions" => "TagLinks.id = BannerKeyCurrent.user_id AND TagLinks.tag_id = 710"
                    )
                ),
                "conditions" => array(
                    "BannerKeyCurrent.date BETWEEN ? AND ?" => array(
                        $this->request->query["period_from"],
                        $this->request->query["period_to"]
                    ),
                    "BannerKeyCurrent.plan_id" => $brands_plan_map[$this->request->query["brand"]]["plans"],
                    "BannerKeyCurrent.operation_id" => $operation_ids
                ),
                "group" => array( "Player.join_country" ),
                "order" => array(
                    "Player.join_country" => "DESC"
                ),
                "limit" => 999999,
                "maxLimit" => 999999
            ); 
```

一切都适用于所有领域，加入，组，限制没有问题，但简单的订购不会起作用。输出 sql_dump 元素表明它从未添加到查询中。

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-09-12T07:00:01.890

通过做

```
"order" =>  "Player.join_country DESC" 
```

为我工作。

我希望它也能帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T14:46:40.193

尝试：

```
$this->Paginator->settings = array(
    "fields" => array(
                "Player.join_country"
            ),
            "joins" => array(
                array(
                    "table" => "b...

$pagedResults = $this->paginate('YourModel'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T16:09:53.987

url中的参数是否有任何分页顺序？

分页器将使用 url 中指定的任何内容覆盖查询中的任何 order by（因此排序列标题起作用）。

如果 order 参数引用了一个无效字段，那么在从查询中删除您的 order by 并准备在 url 中添加一个之后，cake 可能会忽略它。

# sql - 如何在 where 子句中使用别名？

> ID：13031013
> 
> 赞同：34
> 
> 时间：2012-10-23T13:02:17.070
> 
> 标签：sql, sql-server, qtsql

> **可能重复：**
> [在 WHERE 子句中引用列别名](https://stackoverflow.com/questions/8370114/referring-to-a-column-alias-in-a-where-clause)

```
 SELECT
Trade.TradeId, 
Isnull(Securities.SecurityType,'Other') SecurityType, 
TableName,
CASE 
WHEN 
SecurityTrade.SecurityId IS NOT NULL  
THEN 
SecurityTrade.SecurityId
ELSE 
Trade.SecurityId
END AS PricingSecurityID,
sum(Trade.Quantity)OVER(Partition by Securities.SecurityType, SecurityTrade.SecurityId,Trade.Price, Buy,Long ) as sumQuantity,
--added porfolio id for Getsumofqantity
Trade.PortfolioId,

Trade.Price,
case
when (Buy = 1 and Long = 1) then 1
when (Buy = 0 and Long = 0) then 1
else 0
end Position
from
Fireball_Reporting..Trade

where porfolioid =5 and Position =1 
```

我想在我的 where 子句中使用 Position =1，这是 case 的别名

```
case
when (Buy = 1 and Long = 1) then 1
when (Buy = 0 and Long = 0) then 1
else 0
end Position 
```

如何在 where 子句中使用它？

我尝试 zo 直接在 where 子句中使用该 CASE 语句，但失败了。

```
WHERE Trade.SecurityId = @SecurityId AND PortfolioId = @GHPortfolioID AND
                (case when (Buy = 1 and Long = 1) then 1 when (Buy = 0 and Long = 0) then 1 else 0 end Position = 1) 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-10-23T13:03:37.427

[SQL-Server 文档](http://msdn.microsoft.com/en-us/library/ms173451.aspx)说：

> column_alias 可用于 ORDER BY 子句，但**不能用于 WHERE、GROUP BY 或 HAVING 子句**。

在[MySQL 文档](http://dev.mysql.com/doc/refman/5.5/en/problems-with-alias.html)中类似，它说：

> 标准 SQL**不允许在 WHERE 子句中引用列别名**。施加此限制是因为在评估 WHERE 子句时，可能尚未确定列值。

在**MySQL**中，您至少可以在[**SELECT**](https://stackoverflow.com/a/18020948/575376)[子句](https://stackoverflow.com/a/18020948/575376)[中重用别名](https://stackoverflow.com/a/18020948/575376)

 *** * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-10-23T13:06:09.643

你不能，不能直接。

但是，如果您将整个查询包装在一个子查询中，它就可以正常工作。

```
SELECT
  *
FROM
(
  SELECT
    Trade.TradeId, 
    Isnull(Securities.SecurityType,'Other') SecurityType, 
    TableName,
    CASE 
      WHEN SecurityTrade.SecurityId IS NOT NULL THEN SecurityTrade.SecurityId
                                                ELSE Trade.SecurityId
    END AS PricingSecurityID,
    sum(Trade.Quantity)OVER(Partition by Securities.SecurityType,
    SecurityTrade.SecurityId,Trade.Price, Buy,Long ) as sumQuantity,
    --added porfolio id for Getsumofqantity
    Trade.PortfolioId,
    Trade.Price,
    case
      when (Buy = 1 and Long = 1) then 1
      when (Buy = 0 and Long = 0) then 1
                                  else 0
    end Position
  from
    Fireball_Reporting..Trade
  where
    porfolioid = 5
)
  AS data
WHERE
  Position = 1 
```

这意味着您不需要重复`CASE`语句 in`WHERE`子句。（可维护和干燥）。

它也是一种结构，它允许优化器表现得*好像*您*只是*`WHERE`在子句中重复了自己一样。

它对于其他 RDBMS 也非常可移植。

在 SQL Server 中，您还有另一种选择...

```
SELECT
  Trade.TradeId, 
  Isnull(Securities.SecurityType,'Other') SecurityType, 
  TableName,
  CASE 
    WHEN SecurityTrade.SecurityId IS NOT NULL THEN SecurityTrade.SecurityId
                                              ELSE Trade.SecurityId
  END AS PricingSecurityID,
  sum(Trade.Quantity)OVER(Partition by Securities.SecurityType,
  SecurityTrade.SecurityId,Trade.Price, Buy,Long ) as sumQuantity,
  --added porfolio id for Getsumofqantity
  Trade.PortfolioId,
  Trade.Price,
  position.val AS Position
from
  Fireball_Reporting..Trade
CROSS APPLY
(
  SELECT
    case
      when (Buy = 1 and Long = 1) then 1
      when (Buy = 0 and Long = 0) then 1
                                  else 0
    end AS val
)
  AS position
where
  porfolioid = 5
  AND position.val = 1 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-23T13:09:53.640

你不能直接这样做......但你可以在它周围加上一个额外的选择并使用 where 子句：

```
 select * from 
   (   SELECT
   Trade.TradeId, 
   Isnull(Securities.SecurityType,'Other') SecurityType, 
   TableName,
   CASE 
   WHEN 
   SecurityTrade.SecurityId IS NOT NULL  
   THEN 
   SecurityTrade.SecurityId
   ELSE 
   Trade.SecurityId
   END AS PricingSecurityID,
   sum(Trade.Quantity)OVER(Partition by Securities.SecurityType,       SecurityTrade.SecurityId,Trade.Price, Buy,Long ) as sumQuantity,
    --added porfolio id for Getsumofqantity
    Trade.PortfolioId,
     Trade.Price,
     case
     when (Buy = 1 and Long = 1) then 1
     when (Buy = 0 and Long = 0) then 1
     else 0
    end Position
    from
    Fireball_Reporting..Trade
    where porfolioid =5 and Position =1 
    )x
    where x.position = 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T13:46:34.887

我可能遗漏了一些东西，但肯定会涵盖它：

`WHERE (Buy = 1 and Long = 1) OR (Buy = 0 and Long = 0)`**

# ruby-on-rails - 在模型中存储键值序列化的额外字段（Rails）

> ID：13031016
> 
> 赞同：3
> 
> 时间：2012-10-23T13:02:23.863
> 
> 标签：ruby-on-rails, forms

如果这个问题已经得到解答，请原谅我，我已经花了一段时间来解决类似的问题，但似乎没有一个能够实现我想要的。

我有一个名为的模型`Contact`，它存储了一个联系人的信息。我想添加添加自定义字段的功能。也就是说，用户可以在模型上存储一个`key`和`value`哪些存储在序列化对象中。因为键是自定义的，所以我不能只使用 attr 编写器来访问值，就好像它们在模型本身上一样。

我尝试将其序列化为哈希，但我的问题是在提交数据时使用表单输入。出于这个原因，我开始使用带有 [{key: 'foo', value: 'bar'}] 的哈希数组，但是在编辑表单时，旧值不会显示出来，我不完全确定最好的方法接近这个。我试图用`fields_for :extra_values`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T08:02:26.663

在模型的序列化字段中存储数据存在一些小问题。`save`首先，ActiveRecord 总是认为序列化的字段是脏的，因此，无论何时调用，数据库中的记录总是会更新。二是序列化字段中保存的数据难以查找。所以我建议添加另一个模型 ExtraValue 来存储这些值，并制作 Contact `has_many :extra_values`。然后，您可以利用嵌套表单来构建您的表单。

# python - Python 媒体播放器播放列表

> ID：13031018
> 
> 赞同：0
> 
> 时间：2012-10-23T13:02:25.983
> 
> 标签：python, wxpython, media-player, playlist, displaylist

我开始制作一个可支持 3 个主要平台（Windows、Linux、Unix）的可定制媒体播放器的项目。实际上，我已经在网上找到了该项目的一些源代码，但我想添加播放列表等功能，但不确定从哪里开始。对于我的项目如何创建播放列表有什么建议吗？

资源： http: [//www.blog.pythonlibrary.org/2010/07/24/wxpython-creating-a-simple-media-player/](http://www.blog.pythonlibrary.org/2010/07/24/wxpython-creating-a-simple-media-player/)

# 下面是媒体播放器的代码：

```
import os
import time
import wx
import MplayerCtrl as mpc
import wx.lib.buttons as buttons

dirName = os.path.dirname(os.path.abspath(__file__))
bitmapDir = os.path.join(dirName, 'bitmaps')

class Frame(wx.Frame):

    #----------------------------------------------------------------------
    def __init__(self, parent, id, title, mplayer):
        wx.Frame.__init__(self, parent, id, title)
        self.panel = wx.Panel(self)

        sp = wx.StandardPaths.Get()
        self.currentFolder = sp.GetDocumentsDir()
        self.currentVolume = 50

        self.create_menu()

        # create sizers
        mainSizer = wx.BoxSizer(wx.VERTICAL)
        controlSizer = self.build_controls()
        sliderSizer = wx.BoxSizer(wx.HORIZONTAL)

        self.mplayer = mpc.MplayerCtrl(self.panel, -1, mplayer)
        self.playbackSlider = wx.Slider(self.panel, size=wx.DefaultSize)
        sliderSizer.Add(self.playbackSlider, 1, wx.ALL|wx.EXPAND, 5)

        # create volume control
        self.volumeCtrl = wx.Slider(self.panel)
        self.volumeCtrl.SetRange(0, 100)
        self.volumeCtrl.SetValue(self.currentVolume)
        self.volumeCtrl.Bind(wx.EVT_SLIDER, self.on_set_volume)
        controlSizer.Add(self.volumeCtrl, 0, wx.ALL, 5)

        # create track counter
        self.trackCounter = wx.StaticText(self.panel, label="00:00")
        sliderSizer.Add(self.trackCounter, 0, wx.ALL|wx.CENTER, 5)

        # set up playback timer
        self.playbackTimer = wx.Timer(self)
        self.Bind(wx.EVT_TIMER, self.on_update_playback)

        mainSizer.Add(self.mplayer, 1, wx.ALL|wx.EXPAND, 5)
        mainSizer.Add(sliderSizer, 0, wx.ALL|wx.EXPAND, 5)
        mainSizer.Add(controlSizer, 0, wx.ALL|wx.CENTER, 5)
        self.panel.SetSizer(mainSizer)

        self.Bind(mpc.EVT_MEDIA_STARTED, self.on_media_started)
        self.Bind(mpc.EVT_MEDIA_FINISHED, self.on_media_finished)
        self.Bind(mpc.EVT_PROCESS_STARTED, self.on_process_started)
        self.Bind(mpc.EVT_PROCESS_STOPPED, self.on_process_stopped)

        self.Show()
        self.panel.Layout()

    #----------------------------------------------------------------------
    def build_btn(self, btnDict, sizer):
        """"""
        bmp = btnDict['bitmap']
        handler = btnDict['handler']

        img = wx.Bitmap(os.path.join(bitmapDir, bmp))
        btn = buttons.GenBitmapButton(self.panel, bitmap=img,
                                      name=btnDict['name'])
        btn.SetInitialSize()
        btn.Bind(wx.EVT_BUTTON, handler)
        sizer.Add(btn, 0, wx.LEFT, 3)

    #----------------------------------------------------------------------
    def build_controls(self):
        """
        Builds the audio bar controls
        """
        controlSizer = wx.BoxSizer(wx.HORIZONTAL)

        btnData = [{'bitmap':'player_pause.png', 
                    'handler':self.on_pause, 'name':'pause'},
                   {'bitmap':'player_stop.png',
                    'handler':self.on_stop, 'name':'stop'}]
        for btn in btnData:
            self.build_btn(btn, controlSizer)

        return controlSizer

    #----------------------------------------------------------------------
    def create_menu(self):
        """
        Creates a menu
        """
        menubar = wx.MenuBar()
        fileMenu = wx.Menu()
        add_file_menu_item = fileMenu.Append(wx.NewId(), "&Add File", "Add Media File")
        menubar.Append(fileMenu, '&File')

        self.SetMenuBar(menubar)
        self.Bind(wx.EVT_MENU, self.on_add_file, add_file_menu_item)

    #----------------------------------------------------------------------
    def on_add_file(self, event):
        """
        Add a Movie and start playing it
        """
        wildcard = "Media Files (*.*)|*.*"
        dlg = wx.FileDialog(
            self, message="Choose a file",
            defaultDir=self.currentFolder, 
            defaultFile="",
            wildcard=wildcard,
            style=wx.OPEN | wx.CHANGE_DIR
            )
        if dlg.ShowModal() == wx.ID_OK:
            path = dlg.GetPath()
            self.currentFolder = os.path.dirname(path[0])
            trackPath = '"%s"' % path.replace("\\", "/")
            self.mplayer.Loadfile(trackPath)
            t_len = self.mplayer.GetTimeLength()
            print t_len
            self.playbackSlider.SetRange(0, t_len)
            self.playbackTimer.Start(100)

    #----------------------------------------------------------------------
    def on_media_started(self, event):
        print 'Media started!'

    #----------------------------------------------------------------------
    def on_media_finished(self, event):
        print 'Media finished!'
        self.playbackTimer.Stop()

    #----------------------------------------------------------------------
    def on_pause(self, event):
        """"""
        if self.playbackTimer.IsRunning():
            print "pausing..."
            self.mplayer.Pause()
            self.playbackTimer.Stop()
        else:
            print "unpausing..."
            self.mplayer.Pause()
            self.playbackTimer.Start()

    #----------------------------------------------------------------------
    def on_process_started(self, event):
        print 'Process started!'

    #----------------------------------------------------------------------
    def on_process_stopped(self, event):
        print 'Process stopped!'

    #----------------------------------------------------------------------
    def on_set_volume(self, event):
        """
        Sets the volume of the music player
        """
        self.currentVolume = self.volumeCtrl.GetValue()
        self.mplayer.SetProperty("volume", self.currentVolume)

    #----------------------------------------------------------------------
    def on_stop(self, event):
        """"""
        print "stopping..."
        self.mplayer.Stop()
        self.playbackTimer.Stop()

    #----------------------------------------------------------------------
    def on_update_playback(self, event):
        """
        Updates playback slider and track counter
        """
        try:
            offset = self.mplayer.GetTimePos()
        except:
            return
        print offset
        mod_off = str(offset)[-1]
        if mod_off == '0':
            print "mod_off"
            offset = int(offset)
            self.playbackSlider.SetValue(offset)
            secsPlayed = time.strftime('%M:%S', time.gmtime(offset))
            self.trackCounter.SetLabel(secsPlayed)        

#----------------------------------------------------------------------
if __name__ == "__main__":
    import os, sys

    paths = [r'C:\MPlayer-rtm-svn-31170\mplayer.exe',
             r'E:\MPlayer-rtm-svn-31170\mplayer.exe']
    mplayerPath = None
    for path in paths:
        if os.path.exists(path):
            mplayerPath = path

    if not mplayerPath:
        print "mplayer not found!"
        sys.exit()

    app = wx.App(redirect=False)
    frame = Frame(None, -1, 'MediaPlayer Using MplayerCtrl', mplayerPath)
    app.MainLoop() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:15:57.080

这实际上是我想自己添加的一个功能。我要做的是使用 ListCtrl（或者更确切地说是 ObjectListView）创建一个新框架或对话框，并使用添加/删除按钮来添加和删除轨道。您可以使用您认为合适的任何扩展名将路径保存到纯文本文件，然后从中加载 ListCtrl。我希望一切都说得通。

# sql - SQL Server for xml 原始动态行名

> ID：13031023
> 
> 赞同：1
> 
> 时间：2012-10-23T13:02:36.600
> 
> 标签：sql, sql-server

select:
`select top 2 name, crdate from sys.sysobjects where xtype = 'u' for xml raw('object')`

产生与此类似的结果

```
<object name="table_name1" crdate="2010-05-03T09:34:08.150" />
<object name="table_name2" crdate="2011-04-17T11:19:18.157" /> 
```

有什么办法可以用变量（如@RowName）代替“对象”这个词？
提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:05:23.730

您可以使用动态 SQL

```
declare @s nvarchar(4000)
select @s ='select top 2 name, crdate from sys.sysobjects where xtype = ''u'' for xml raw('''+@rowname+''')'
exec sp_executesql @s 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-30T22:08:41.060

```
set @xml.modify('declare default element namespace "http://www.someurl.com";
                     insert <root>root> ');

set @xml.modify('insert <child1><test1></test1></child1> as last into (/*:root)[1]');   
set @xml.modify('insert <child2><test2></test2></child2> as last into (/*:Root[1]/*:Child1[1])'); 
```

# session-timeout - Icefaces 3.1 在第一次部分提交时获得会话超时

> ID：13031027
> 
> 赞同：0
> 
> 时间：2012-10-23T13:02:42.620
> 
> 标签：session-timeout, icefaces-3

我在 icefaces 3 中有一个使用 Mojarra 2.1.6 的单页应用程序

该应用程序是这样的，顶部有 3 个单选按钮和一个带有输入字段的数据表。

问题是，当我第一次在浏览器中打开该网站时，该网站会打开......但是当页面的任何部分有部分提交时，会话就会过期。页面重新加载后页面运行流畅

该站点在 1.8.2 中正常运行，但我们正在考虑是否应该升级到 icefaces 3

如果您需要任何其他信息，请告诉我

编辑

我使用解决方法解决了它，但问题仍然存在

解决方法是使用 index.jsp 页面调用该页面，这可以防止上述错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T09:17:53.470

如果您不再使用 ICEfaces 3/JSF2 `partialSubmit`，请改用新`<f:ajax />`标签。

您是否阅读过 ICEfaces Wiki 上有关 1.8.x 兼容性的页面？[http://www.icesoft.org/wiki/display/ICE/ICEfaces+1.x+兼容性](http://www.icesoft.org/wiki/display/ICE/ICEfaces+1.x+Compatibility)

尝试迁移到新的 ACE-Components，或者使用普通的 JSF-Components( `<h:... />`)。ICE 组件不是为 JSF2 构建的，应该避免使用，我在 JSF2 应用程序中遇到过问题。

# javascript - 简单的 javascript 更正（日期/时间）

> ID：13031029
> 
> 赞同：0
> 
> 时间：2012-10-23T13:02:48.237
> 
> 标签：javascript, time

这段代码我哪里出错了？

```
var now = Date.now();
var HoursLater = now.addHours(6);
Date.prototype.addHours= function(h){
    this.setHours(this.getHours()+h);
    return this;
}

document.write(HoursLater); 
```

​</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:05:50.793

无需重新发明轮子！

周围有很好的图书馆可以为您节省大量时间。

查看[date.js](http://www.datejs.com/)。它已经有 addHours() 了！

> ```
> .addHours ( Number hours ) : Date
> 
> Adds the specified number of hours to this instance given the number of hours to add. The number can be positive or negative. 
> ```

```
// Solution to your problem with date.js ;)
Date.today().addHours(6);

// What date is next thursday?
Date.today().next().thursday();

// Add 3 days to Today
Date.today().add(3).days(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T13:14:12.667

您的原型方法`addHours`是在 Date() 对象上定义的，而不是在 Date.now() 上。

只需将您的第一行修改为`var Now = new Date();`

还将原型方法定义`addHours`移到顶部（由于前 2 个语句的执行顺序）。

[http://jsfiddle.net/ATUpF/](http://jsfiddle.net/ATUpF/)

# java - 从“原始”文件夹中的资源 wav 文件获取输入数据

> ID：13031033
> 
> 赞同：2
> 
> 时间：2012-10-23T13:02:56.523
> 
> 标签：java, android, input, io

我一直在尝试`wav`使用`InputStream`.

我想我不明白的是如何给出文件的正确位置。R资源中的`wav`文件是一个int，所以我不能这样做：

```
InputStream is = new FileInputStream(R.raw.music); 
```

因为`int`不承认`FileInputStream`。

基本上我的代码是我发现的东西的修改版本：

```
public void read(short[] musicin) {
    try {
        // Create a DataInputStream to read the audio data back from the saved file.
        InputStream is = new FileInputStream("R.raw.music");

        BufferedInputStream bis = new BufferedInputStream(is);

        DataInputStream dis = new DataInputStream(bis);

        int buffsize=512;

        // Read the file into the music array.
        int i = 0;

        while (i<buffsize&&dis.available() > 0) {
            musicin[i] = dis.readByte(); 
            i++;
        }

        // Close the input streams.
        dis.close();
    } catch (Throwable t) {
        Log.e("AudioTrack","Playback Failed");
    }
} 
```

那么我怎样才能从原始文件夹中读取呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:07:49.720

在你的活动课上

```
Context c;
c=this;
new yourClass(c); 
```

在你的课上

```
 public yourclass(Context context)
 {

InputStream in = context.getResources().openRawResource(R.raw.yourfilename); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T14:09:12.153

好吧，我所做的是：

1-在线程开始之前将其添加到活动中：

```
final Context con;
    con=this; 
```

2-调用线程中的类

```
new Wav_File_Reader(); 
```

. . .

```
Wav_File_Reader.read(musicin,con); 
```

2-将我的类修改为静态：

```
public static void read(short[] musicin, Context ctx ) {
    try {

    //  InputStream is = getBaseContext().getResources().openRawResource(R.raw.music);

    InputStream is = ctx.getResources().openRawResource(R.raw.music);
    BufferedInputStream bis = new BufferedInputStream(is);
    DataInputStream dis = new DataInputStream(bis);

    int buffsize=512;
    // Read the file into the music array.
    int i = 0;

    short in[]=new short[200000];

    //while (dis.available() > 0) {
    //while (i<buffsize&&dis.available() > 0) {
    while (i<200000&&dis.available() > 0) {
        //musicin[i] = dis.readByte(); 
        //in[i]=dis.readByte(); 
        in[i]=dis.readShort();
    i++;
    }

    // Close the input streams.
    dis.close(); 

    } catch (Throwable t) 
    {
    Log.e("AudioTrack","Playback Failed");
    }
    } 
```

我能够直接从 R.raw 文件夹中读取。

谢谢你的快速和有用的帮助！！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:08:15.930

好吧，InputStream 实现从一开始就引人注目，将其更改为：

```
InputStream is = this.getResources().openRawResource(R.raw.music); 
```

# jquery - 在页面加载和窗口调整大小时调整 div 大小

> ID：13031037
> 
> 赞同：0
> 
> 时间：2012-10-23T13:03:07.543
> 
> 标签：jquery

好的，所以我正在尝试从 id 获取高度`sna`并将其添加到三个 DIV，并`.sn_cat`在页面**加载**和窗口**调整大小**时使用该类。该脚本添加了非常奇怪的值，或者根本不起作用。我只想看到使用 jQuery 的建议。此高度将用于 CSS 无法到达的部分（无父子关系）。

```
$(function (){
    /* Resize right Sticky notes Height */
    function resizeColumnHeigh() {  

            var snaHeight = $("#sna").height();

            $(this).find(".sn_cat").height(snaHeight);

    }   
    /* On window resize adjust the height */
    $(window).resize(function(){
         resizeColumnHeigh();
    });

    /* Run function */
    resizeColumnHeigh();        

}); 
```

一个小提琴玩：http: [//jsfiddle.net/v4HJ5/](http://jsfiddle.net/v4HJ5/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:27:58.437

## *[jsFiddle 演示](http://jsfiddle.net/v4HJ5/3/)*

很简单，您需要在获得新高度之前重置类`#sna`高度！看一看：

```
function resizeColumns() {
    $('.sn_cat').css({height:'auto'}).height( $('#sna').height() );
}
resizeColumns();

$(window).resize(function(){
     resizeColumns();
}); 
```

如果你在你的内部使用图像`.sn_cat`，最好也调用你的`resizeColumns()`函数`$(window).load`

# c - fgets 添加一个问号

> ID：13031038
> 
> 赞同：0
> 
> 时间：2012-10-23T13:03:08.603
> 
> 标签：c, fgets

> **可能重复：**
> [fgets 的回车](https://stackoverflow.com/questions/12769289/carriage-return-by-fgets)

我有这个代码：

```
char arch[80];
fgets (arch, sizeof(arch), stdin); 
```

当我访问它的值时，`arch`会显示我输入的值`stdin`后跟一个问号，为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T13:05:27.737

`fgets()`存储尾随换行符：

> fgets() 从流中最多读入一个小于 size 的字符，并将它们存储到 s 指向的缓冲区中。在 EOF 或换行符后停止读取。如果读取了换行符，则将其存储到缓冲区中。'\0' 存储在缓冲区中的最后一个字符之后。

如果您在某种调试器中检查变量，则换行符可能会显示为“？”，或者您所说的“询问标记”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-23T13:05:04.977

我的猜测是它代表了`\n`你用来检查`arch`. SO有*很多*关于线路终止的问题，我相信你可以很容易地找到*很多*方法来处理它。

# entity-framework - Entity Framework(EF5) 是否支持 XML 数据类型？

> ID：13031041
> 
> 赞同：3
> 
> 时间：2012-10-23T13:03:15.653
> 
> 标签：entity-framework, entity-framework-4, entity-framework-5

我正在考虑在 SQL Server 2008 R2 中使用 XML 数据类型，但也将 EF 与 MVC 一起使用。EF5 是否支持 XML 数据类型？如果不是，那么我将不得不选择不同的数据库设计。

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T05:59:50.500

EF 目前不支持原生 Xml 类型

# php - PHP 在循环 JavaScript 函数时

> ID：13031045
> 
> 赞同：0
> 
> 时间：2012-10-23T13:03:23.607
> 
> 标签：php, javascript, while-loop

我不确定这是否可能或者是否有其他方法可以做到这一点，但我一直在尝试用 PHP 循环一个 JavaScript 函数。

**JavaScript/PHP 功能：**

```
<script type="text/javascript">
<?php
while ($songsFunction = mysql_fetch_array($result3)) {
    echo "function ".$songsFunction['songID']."(){";
    echo "document.getElementById('ogg').src='';";
    echo "document.getElementById('mp3').src='';";
    echo "document.getElementById('songName').innerHTML='';";
    echo "audio.load();";
    echo "playPause();";
    }
?>
</script> 
```

我有`songID`出现在播放列表中：

```
<?php while ($haha = mysql_fetch_array($result3)) {
    echo   '<ul>
            <li>
            <a href="#" onClick="'.$songFunction['songID'].'();">'.$songFunction['songName'].'</a>
            <a href="'.$songFunction['mp3Link'].'"><img src="../images/download.png"></a>
            </li>
            </ul>';  
    }
?> 
```

播放列表正确循环，但是当我让功能正常工作时，如果歌曲 ID 匹配，播放列表就会消失。

这是在通过带有变量的数据库提取信息时循环 JavaScript 函数的正确方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:15:28.220

这绝对**不是**这样做的方法。

场景应该是：

1.  用户单击播放列表中的歌曲。
2.  触发点击事件，向 php 脚本发送[ajax](http://api.jquery.com/jQuery.ajax/)请求。
3.  PHP 脚本从 DB 中提取数据并返回格式为[json的响应](http://www.json.org/)
4.  js 代码使用 json 响应并对其进行处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:12:32.197

您没有关闭 JavaScript 函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:14:09.450

我不确定您到底要完成什么，但我看到的唯一操纵 DOM 的 JavaScript 只是删除了内容......

```
echo "document.getElementById('ogg').src='';";
echo "document.getElementById('mp3').src='';";
echo "document.getElementById('songName').innerHTML='';"; 
```

因此，这些项目曾经拥有的任何内容都将被删除。这是你想要的吗？还是问题的根源？

# php - MySQL UPDATE 与 WHERE AND

> ID：13031046
> 
> 赞同：1
> 
> 时间：2012-10-23T13:03:26.333
> 
> 标签：php, mysql, if-statement

```
if ('$o1s' == 1) {
    $ocode = 1;
    $query6 = "UPDATE `offer_det` SET `ocode`='$ocode' WHERE `fname`='$fname' AND `lname`='$lname'";
           $result6 = mysql_query($query6)or die(mysql_error()); 
} 
```

$o1s 是一个单选，本质上 1 = 选中，0 = 未选中。ocode 是数据库中要更新的行。$fname 是登录用户的名字，$lname 是登录用户的姓氏。

我的想法是，如果选择了 o1s，则将 ocode 更新为 1，其中名字和姓氏匹配。不过，我没有看到对结果采取任何行动。这是一个会话发布表单。我什至可以在更新期间使用 AND 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:04:44.883

这条线需要是这样的，

```
if ($o1s == 1) { //checking a variable, not a string with a '$' 
```

另外，检查`$_POST`数组何时被选中和不被选中的相应值`o1s`，你必须`isset`在它没有被选中时进行检查。是的，您可以`AND`使用`update`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:09:11.933

您确实将字符串 '$os1' 与 1 进行了比较。

这将永远失败。

删除 ' 它将起作用。

例如

```
if($os1==1) //this will pass if $os1 equals the number 1

if('$os1'==1) // this will never pass cause
              // you compare the string "$os1" with the integer number 1 
```

# php - 注意：数组到字符串的在线转换

> ID：13031049
> 
> 赞同：0
> 
> 时间：2012-10-23T13:03:32.653
> 
> 标签：php

我在从数据库中回显一些数据时遇到问题：我尝试了几件事，但它不起作用。

这是我的代码：

```
$dbobject = new Company();
$where = "ID=1";
if (isset($_GET['pageno'])) {
    $dbobject->setPageno($_GET['pageno']);
}
$data = $dbobject->getData($where);
echo implode(' ',array_values($data)); 
```

我也尝试了以下方法：

```
foreach ($data as $value){
    echo $value;
} 
```

和

```
echo implode(" ",$data); 
```

我知道数据在那里，因为我可以使用`print_r`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:04:44.197

尝试

```
foreach ($data as $value){
echo implode(" ",$value);
} 
```

# java - Java 应用程序在 IDE 之外无法正常工作

> ID：13031057
> 
> 赞同：0
> 
> 时间：2012-10-23T13:03:54.043
> 
> 标签：java, intellij-idea, shared-libraries

当我使用 IntelliJ Idea 运行它时 - 它完全正确。当我从输出运行 app.jar 文件时 - 一切都很好，但是 supportLib.jar 支持的一项功能。`java.lang.NoClassDefFoundError: sun/plugin/dom/exception/InvalidAccessException`用的时候就知道了 输出结构如下：

```
| D:\myprogram\

  |
  ---> app.jar 
  |
  ---> lib\  
        |
        ---> supportLib.jar
        ---> anotherSupportLib.jar 
```

类路径是：`lib/supportLib.jar lib/anotherSupportLib.jar`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:08:48.873

`sun.plugin.dom.exception.InvalidAccessException`驻留在 中`$JRE_HOME/lib/plugin.jar`，因此您需要添加`$JRE_HOME/lib/plugin.jar`到您的类路径中。我想 IntelliJ 会自动添加它，但 Java 运行时不会自动加载它（与 rt.jar 不同）。

* * *

根据评论的反馈，应用程序应该这样启动：

```
java -classpath "c:/Program Files/Java/jre7/lib/plugin.jar;app.jar;lib/supportLib1.jar;lib/supportLib2.jar;lib/supportLib3.jar" namespace.forms.MainForm 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T13:11:17.853

IDEA 通常会添加绝对路径：

```
 -classpath D:\myprogram\lib\supportLib.jar;D:\myprogram\lib\anotherSupportLib.jar 
```

尝试用这个合成器运行你的 jar。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:08:48.627

在 Windows 机器上，这需要使用分号`lib/supportLib.jar;lib/anotherSupportLib.jar`。

# python - 如何将 django/python 中的模型对象列表序列化为 JSON

> ID：13031058
> 
> 赞同：23
> 
> 时间：2012-10-23T13:03:53.730
> 
> 标签：python, json, django, django-models

我正在尝试序列化定义为的模型对象列表：

```
class AnalysisInput(models.Model):
    input_user = models.CharField(max_length=45)
    input_title = models.CharField(max_length=45)
    input_date = models.DateTimeField()
    input_link = models.CharField(max_length=100) 
```

我为 json.dumps() 编写了一个自定义序列化程序（编码器）：

```
class AnalysisInputEncoder(json.JSONEncoder):
    def default(self, obj):
        if isinstance(obj, AnalysisInput):
            return { "input_id" : obj.id,
                    "input_user" : obj.input_user,
                    "input_title" : obj.input_title,
                    "input_date" : obj.input_date.isoformat(),
                    "input_link" : obj.input_link }
        return json.JSONEncoder.default(self, obj) 
```

当我只序列化一个对象时，我可以做到。当我尝试序列化对象列表时，我得到

```
[ objects..] is not JSON serializable 
```

我搜索了但我没有找到在哪里工作。我正在考虑为模型对象列表编写一个自定义序列化程序。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-10-23T13:11:29.873

自定义编码器不会被递归调用。实际上最好*不要*使用自定义编码器，而是在序列化之前将对象转换为简单的 python 类型。

您可以在模型中添加一个`as_json`或类似名称的方法，并在每次需要 JSON 结果时调用它：

```
class AnalysisInput(models.Model):
    input_user = models.CharField(max_length=45)
    input_title = models.CharField(max_length=45)
    input_date = models.DateTimeField()
    input_link = models.CharField(max_length=100)

    def as_json(self):
        return dict(
            input_id=self.id, input_user=self.input_user,
            input_title=self.input_title, 
            input_date=self.input_date.isoformat(),
            input_link=self.input_link) 
```

那么在你看来：

```
# one result
return HttpResponse(json.dumps(result.as_json()), content_type="application/json")

# a list of results
results = [ob.as_json() for ob in resultset]
return HttpResponse(json.dumps(results), content_type="application/json") 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-05-17T19:19:11.313

我发现序列化 Django 模型的最佳方法是`django.core.serializers`将模型列表序列化为 JSON、XML 或 YAML。无需自定义序列化代码！文档在这里：[https ://docs.djangoproject.com/en/dev/topics/serialization/](https://docs.djangoproject.com/en/dev/topics/serialization/)

这是我的实现：

铅/模型.py：

```
from django.db import models

class Lead(models.Model):
    name = models.CharField(max_length=50)
    email = models.CharField(max_length=256)
    phone = models.CharField(max_length=20)
    twitter_handle = models.CharField(max_length=20)
    github_handle = models.CharField(max_length=20) 
```

铅/views.py：

```
from django.http import HttpResponse
from django.core import serializers
from lead.models import Lead

def index(request):
    leads_as_json = serializers.serialize('json', Lead.objects.all())
    return HttpResponse(leads_as_json, content_type='application/json') 
```

最终结果：

```
[{"pk": 1, "model": "lead.lead", "fields": {"twitter_handle": "johndoe", "name": "John Doe", "phone": "1(234)567-8910", "email": "john@doe.com", "github_handle": "johndoe"}}] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-01T11:08:44.137

最简单的解决方案：

```
def index(request):
    data = serializers.serialize('json', Product.objects.all())
    return HttpResponse(data, content_type='application/json') 
```

# jquery - 在加载动态创建的 div 的内容（如图像）后执行函数，使用 jQuery

> ID：13031064
> 
> 赞同：0
> 
> 时间：2012-10-23T13:04:07.707
> 
> 标签：jquery, delegates, load

我只想在动态创建的 DIV 的内容（包括文本和图像）完全加载后执行一些功能。这里动态创建的DIV是“#element”+data。

以下不起作用。

```
$("#section"+currSect).delegate( "#element"+data, "load", function()
{ remvPanel(); showFormBox(); }
); 
```

这也行不通。

```
 $("#element"+data).load(function() {remvPanel(); showFormBox();}); 
```

请帮忙！:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:11:09.010

这会做吗？

[jQuery .load()](http://api.jquery.com/load-event/)

此方法是 .bind('load', handler) 的快捷方式。

当元素和所有子元素都已完全加载时，加载事件将发送到该元素。此事件可以发送到与 URL 关联的任何元素：图像、脚本、框架、iframe 和窗口对象。

例如，考虑一个带有简单图像的页面：

```
<img src="book.png" alt="Book" id="book" /> 
```

事件处理程序可以绑定到图像：

```
$('#book').load(function() {
  // Handler for .load() called.
}); 
```

一个工作示例：

```
<head>
    <title></title>
    <script src="Scripts/jquery-1.8.2.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            $div = $("#main");

            // get loaded alert
            $img = $("<img src='https://www.google.com/images/srpr/logo3w.png' />");

            // no loaded alert
            // $img = $("<img src='not a valid image' />");

            $img.load(function () {
                alert("loaded");
            });

            $div.append($img);
        });
    </script>
</head>
<body>
    <div id="main">
    </div>
</body> 
```

# svn - 在 TortoiseSVN 中打开 URL 时出错

> ID：13031065
> 
> 赞同：3
> 
> 时间：2012-10-23T13:04:09.070
> 
> 标签：svn, tortoisesvn

在 TortoiseSVN 存储库浏览器中打开 URL 时出现以下错误：

> 存储库暂时移至“/oberr.cgi status 3d500 errmsg 3derrenginedown”；请搬家”。

该 URL 直到昨天才完美打开。似乎也没有权限问题。有没有人遇到过这个错误？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T16:00:08.030

这发生在我身上一次，他们改变了地址，你需要按照消息所说的去做，检查[一下](http://tortoisesvn.net/docs/nightly/TortoiseSVN_en/tsvn-dug-relocate.html)，它解释了如何重新分配你的工作副本。

# php - 搜索多数组并创建包含原始数组元素的新数组

> ID：13031067
> 
> 赞同：-1
> 
> 时间：2012-10-23T13:04:18.453
> 
> 标签：php, arrays, multidimensional-array

数组看起来像这样：

```
$array = array(
  array(
    'Item' => array(47, 48, 46, 42),
    'ID' => 1,
  ),
  array(
    'Item' => array(29, 37, 46, 48),
    'ID' => 2,
  ),
  array(
    'Item' => array(33, 27, 18),
    'ID' => 3,
  ),
); 
```

我要做的是搜索 [Item] 数组，如果有匹配项，则将 [ID] 添加到新数组中。

所以，如果我正在寻找，`46`那么我会从 ID`1`和`2`一个简单的数组中得到结果。

我确信这应该如此简单，但我似乎已经完全陷入了精神障碍，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:09:08.033

尝试：

```
$ids = array();
foreach($yourArray as $v)
    if(in_array(46, $v["Item"]))
        $ids[] = $v["ID"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:11:20.683

试试这个，

```
foreach($array as $v) {
if(in_array(46, $v['Item'])
    $ids[] = $v['ID']; //array $ids will contain 1, 2..and so on.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:13:51.600

您是否尝试过使用 in_array()？

您可以遍历数组并检查您的值是否位于 Item 数组中。就像是：

```
function getId(array $array, $value) {
    $ids = array();
    foreach ($array as $element) {
       if (in_array($value, $element['Item'])) {
           $ids[] = $element['ID'];
       }
    }
    return $ids;
} 
```

# java - Spring Security i18n：错误的错误消息已解决

> ID：13031070
> 
> 赞同：4
> 
> 时间：2012-10-23T13:04:31.357
> 
> 标签：java, spring, spring-mvc, internationalization, spring-security

我正在开发使用 Spring (MVC)、Hibernate、Spring Security 和 ZK 作为前端的 Web 应用程序。我正在使用所有库的最新版本（3.1.2 Spring、3.1.3 Spring Security、4.1.7 Hibernate），但我遇到了国际化问题（i18n）。配置后我会详细介绍（仅相关部分）：

**网页.xml：**

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/spring/root-context.xml /WEB-INF/spring/spring-security.xml</param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<servlet>
    <servlet-name>appServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/spring/appServlet/servlet-context.xml 
        </param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>appServlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>

<servlet>
    <servlet-name>zkLoader</servlet-name>
    <servlet-class>org.zkoss.zk.ui.http.DHtmlLayoutServlet</servlet-class>
    <init-param>
        <param-name>update-uri</param-name>
        <param-value>/zkau</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet>
    <servlet-name>auEngine</servlet-name>
    <servlet-class>org.zkoss.zk.au.http.DHtmlUpdateServlet</servlet-class>
</servlet>

<servlet-mapping>
    <servlet-name>zkLoader</servlet-name>
    <url-pattern>*.zul</url-pattern>
</servlet-mapping>

<servlet-mapping>
    <servlet-name>auEngine</servlet-name>
    <url-pattern>/zkau/*</url-pattern>
</servlet-mapping>

<listener>
    <description>ZK JSP Tags environment initiation </description>
    <display-name>ZK JSP Initiator</display-name>
    <listener-class>org.zkoss.jsp.spec.JspFactoryContextListener</listener-class>
</listener>

<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class> org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

**servlet 上下文：**

```
<beans:bean id="localeResolver" class="org.springframework.web.servlet.i18n.SessionLocaleResolver">
    <beans:property name="defaultLocale" value="hr" />
</beans:bean>

<interceptors>
    <beans:bean id="localeChangeInterceptor" class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
        <beans:property name="paramName" value="lang" />
    </beans:bean>
</interceptors>

<beans:bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
    <beans:property name="basename" value="classpath:message" />
</beans:bean> 
```

**弹簧安全.xml：**

```
<http pattern="/resources/**" security="none" />

<http auto-config="true">
    <intercept-url pattern="/login*" access="IS_AUTHENTICATED_ANONYMOUSLY" />
    <intercept-url pattern="/**" access="ROLE_USER" />
    <form-login login-page="/login" default-target-url="/" authentication-failure-url="/loginfailed" />
</http> 
```

**根上下文.xml：**

与这里的问题无关，只是数据源定义、会话工厂和 bean 声明。

**现在解决问题：**

我有 2 个文件：message_en.properties 和 message_hr.properties，它们都驻留在 src/main/resources 目录中。我使用“Spring 模板项目”创建了这个项目，然后选择了“Spring MVC 项目”（使用 STS 2.9.2）。我已经阅读了有关如何自定义 Spring Security 消息的信息，并且那些需要被覆盖的消息放在 message.properties 文件中，并附加了自定义消息。我用于测试的一个是：

**spring-security-core.jar 中的原始消息** AbstractUserDetailsAuthenticationProvider.badCredentials = Bad credentials

**在 message_en.properties 中被覆盖：**

AbstractUserDetailsAuthenticationProvider.badCredentials = 无效的用户名或密码

**在 message_hr.properties 中重写：**

AbstractUserDetailsAuthenticationProvider.badCredentials = Bla Bla Bla

**场景一：**

如果我在配置文件中保留上述所有内容，更改 url 栏中的 lang 参数或仅通过单击登录页面中的链接，正确读取我的自定义 message_xx.properties 中的所有消息，除了 SS 的消息。因此，我得到的不是“无效的用户名或密码”或“Bla Bla Bla”，而是“错误的凭据”。

**场景二：**

如果我将 messageSource bean 从 servlet-context.xml 移动到 spring-security.xml，它会加载正确的错误消息，但无论设置什么语言环境，它总是读取“Bla Bla Bla”。即使我更改 localeChangeInterceptor bean 的语言参数，也会发生这种情况。

我应该在这里做什么才能使这项工作正常进行？

忘了提：为了获得 Spring Security 消息，我在 jsp 页面中使用它

${sessionScope["SPRING_SECURITY_LAST_EXCEPTION"].message}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T16:12:15.710

Got the same problem. After reading [this from Spring Security i18n](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#localization) I created a Filter which:

1.  retrieve the locale from the cookie (I'm using the CookieLocaleResolver but this can be done with other type of localeResolver like SessionLocaleResolver)
2.  and call the LocaleContextHolder.setLocale(locale, true)
3.  before the chain.doFilter.

This filter must appear before the filter-mapping of springSecurityFilterChain whithin web.xml. That way when spring-security calls LocaleContextHolder.getLocale() it retrieves the right one. In your case you can retrieve the locale from the session since you are using org.springframework.web.servlet.i18n.SessionLocaleResolver.

In spring context xml file (you can still use SessionLocaleResolver instead):

```
 <!-- Saves a locale change using a cookie -->
<bean id="localeResolver" class="org.springframework.web.servlet.i18n.CookieLocaleResolver" /> 
```

Java Filter code (important line is LocaleContextHolder.setLocale because spring-security makes use of LocaleContextHolder.getLocale):

```
package com.xyz;

import java.io.IOException;
import java.util.Locale;

import javax.servlet.Filter;
import javax.servlet.FilterChain;
import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServletRequest;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.i18n.LocaleContextHolder;
import org.springframework.web.servlet.i18n.CookieLocaleResolver;
import org.springframework.web.util.WebUtils;

/**
 * Transfert the value of user Locale into LocaleContextHolder which is used by spring-security
 */
public class FilterI18nCookie implements Filter {
    private static final Logger LOG = LoggerFactory.getLogger(FiltreI18nCookie.class);

    /**
     * @see javax.servlet.Filter#doFilter(javax.servlet.ServletRequest,
     *      javax.servlet.ServletResponse, javax.servlet.FilterChain)
     */
    public void doFilter(ServletRequest pRequest, ServletResponse pResponse, FilterChain pFilterChain) throws IOException, ServletException {
        if (!(pRequest instanceof HttpServletRequest)) {
            pFilterChain.doFilter(pRequest, pResponse);
            return;
        }

        HttpServletRequest request = (HttpServletRequest) pRequest;

        Cookie cookie = WebUtils.getCookie(request, CookieLocaleResolver.LOCALE_REQUEST_ATTRIBUTE_NAME);
        if (cookie != null) {
            Locale locale = org.springframework.util.StringUtils.parseLocaleString(cookie.getValue());
            if (locale != null) {
                LOG.info("Locale cookie: [" + cookie.getValue() + "] == '" + locale + "'");
                request.setAttribute(CookieLocaleResolver.LOCALE_REQUEST_ATTRIBUTE_NAME, locale);
                LocaleContextHolder.setLocale(locale, true);
            }
        }

        pFilterChain.doFilter(pRequest, pResponse);
    }

    /**
     * @see javax.servlet.Filter#init(javax.servlet.FilterConfig)
     */
    public void init(FilterConfig filterConfig) throws ServletException {
    }

    /**
     * @see javax.servlet.Filter#destroy()
     */
    public void destroy() {
    }

} 
```

Inside the web.xml file (the filter-mapping definition of custom filter FilterI18nCookie appreas before the springSecurityFilterChain):

```
<filter>
    <filter-name>FilterI18nCookie</filter-name>
    <filter-class>com.xyz.FilterI18nCookie</filter-class>
</filter>
    <filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<servlet>
    <servlet-name>mvc-dispatcher</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>2</load-on-startup>
</servlet>
<filter-mapping>
    <filter-name>FilterI18nCookie</filter-name>
    <url-pattern>/ *</url-pattern>
</filter-mapping>
<filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/ *</url-pattern>
</filter-mapping>
<servlet-mapping>
    <servlet-name>mvc-dispatcher</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-23T15:32:48.427

Based on A.Masson suggestion, I made a change to support any type of LocalResolver implementation.

```
/**
 * Transfert the value of user Locale into LocaleContextHolder which is used by spring-security
 */
public class FilterI18nSpringSecurity implements Filter {
    private static final Logger LOG = LoggerFactory.getLogger(FilterI18nSpringSecurity.class);

    private WebApplicationContext springContext;

    /**
     * @see javax.servlet.Filter#doFilter(javax.servlet.ServletRequest,
     *      javax.servlet.ServletResponse, javax.servlet.FilterChain)
     */
    public void doFilter(ServletRequest pRequest, ServletResponse pResponse, FilterChain pFilterChain) throws IOException, ServletException {
        if (!(pRequest instanceof HttpServletRequest)) {
            pFilterChain.doFilter(pRequest, pResponse);
            return;
        }

        LocaleResolver bean = springContext.getBean(LocaleResolver.class);
        Locale locale = bean.resolveLocale((HttpServletRequest) pRequest);
        LOG.info("Locale -> " + locale);
        LocaleContextHolder.setLocale(locale, true);

        pFilterChain.doFilter(pRequest, pResponse);
    }

    /**
     * @see javax.servlet.Filter#init(javax.servlet.FilterConfig)
     */
    public void init(FilterConfig filterConfig) throws ServletException {
        springContext = WebApplicationContextUtils.getWebApplicationContext(filterConfig.getServletContext());
    }

    /**
     * @see javax.servlet.Filter#destroy()
     */
    public void destroy() {
    }

} 
```

**EDIT: Previous approach didn't works in some circumstances. I changed to this one, getting better behavior. I used the Spring exception class name as a message key, so then I can map these messages in my current property file. (my template engine is thymeleaf)**

In the page:

```
<th:block th:if="${session.SPRING_SECURITY_LAST_EXCEPTION != null &amp;&amp; param.error != null}">
    <div th:replace="fragments/alert :: alert (type='danger', message=#{${session.SPRING_SECURITY_LAST_EXCEPTION.class.name}})">Alert</div>
</th:block> 
```

messages.properties:

`org.springframework.security.authentication.BadCredentialsException=Usuario o contraseña... org.springframework.security.authentication.LockedException=Usuario bloqueado org.springframework.security.authentication.DisabledException=El usuario está deshabilitado`

# android - 如何一张一张地移动位图

> ID：13031071
> 
> 赞同：1
> 
> 时间：2012-10-23T13:04:33.137
> 
> 标签：android

这是我的完整代码,,,,

任何人都可以帮助我,,,

```
public class MainActivity extends Activity {

@Override
    public void onCreate(Bundle savedInstanceState) 
    {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
     getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, 
             WindowManager.LayoutParams.FLAG_FULLSCREEN); 
    setContentView(new Panel(this));

    }
}

class Panel extends SurfaceView implements SurfaceHolder.Callback {

         private Bitmap[] mBitmap;
        private ViewThread mThread;
        public Panel(Context context) {
            super(context);
             mBitmap = new Bitmap[4];
                mBitmap[0] = BitmapFactory.decodeResource(getResources(), R.drawable.x);
                mBitmap[1] = BitmapFactory.decodeResource(getResources(), R.drawable.x);
                mBitmap[2] = BitmapFactory.decodeResource(getResources(), R.drawable.x);
                mBitmap[3] = BitmapFactory.decodeResource(getResources(), R.drawable.x);

            getHolder().addCallback(this);
            mThread = new ViewThread(this);
        }

        public void doDraw(Canvas canvas) {
            canvas.drawColor(Color.BLACK);

            canvas.drawBitmap(mBitmap[0], 0, 0, null);
            canvas.drawBitmap(mBitmap[1], 45, 0, null);
            canvas.drawBitmap(mBitmap[2], 90, 0, null);
            canvas.drawBitmap(mBitmap[3], 135, 0, null);

        @Override
        public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {
        // TODO Auto-generated method stub
        }

        @Override
        public void surfaceCreated(SurfaceHolder holder) {
            if (!mThread.isAlive()) {
                mThread = new ViewThread(this);
                mThread.setRunning(true);
                mThread.start();
            }
        }

        @Override
        public void surfaceDestroyed(SurfaceHolder holder) {
            if (mThread.isAlive()) {
                mThread.setRunning(false);
            }
        }

        @Override
        public boolean onTouchEvent(MotionEvent event) {

            mX = (int) event.getX() - mBitmap[0].getWidth() / 2;
            mX = (int) event.getX() - mBitmap[1].getWidth() / 2;
            mX = (int) event.getX() - mBitmap[2].getWidth() / 2;
            mX = (int) event.getX() - mBitmap[3].getWidth() / 2;

            return super.onTouchEvent(event);

        }

class ViewThread extends Thread {
    private Panel mPanel;
    private SurfaceHolder mHolder;
    private boolean mRun = false;

    public ViewThread(Panel panel) {
        mPanel = panel;
        mHolder = mPanel.getHolder();
    }

    public void setRunning(boolean run) {
        mRun = run;
    }

    @Override
    public void run() {
        Canvas canvas = null;
            while (mRun) {
                canvas = mHolder.lockCanvas();
                if (canvas != null) {
                    mPanel.doDraw(canvas);
                    mHolder.unlockCanvasAndPost(canvas);
                }
            }
    }

} 
```

如何将位图一张一张地左右移动我的位图

如果位图移动，则位图相邻

我的代码有什么问题？

如何解决这个我的代码？

请帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:22:36.087

要在表面上移动对象，您必须定期更改对象的位置。

要开始 2D 游戏开发，您可以参考以下链接。

[http://www.droidnova.com/2d-tutorial-series-part-i,770.html](http://www.droidnova.com/2d-tutorial-series-part-i,770.html)

在此链接中还有可用的示例代码，因此请下载并在您的 PC 中运行它并检查代码。

# c# - 诠释？maxResults 是什么？在本声明中的意思

> ID：13031080
> 
> 赞同：3
> 
> 时间：2012-10-23T13:04:58.063
> 
> 标签：c#, .net, nullable

> **可能重复：**
> [C# - 基本问题：什么是'？'？](https://stackoverflow.com/questions/2699373/c-sharp-basic-question-what-is)

我在函数参数中找到了这个语句。

```
public static SyndicationFeed GetDataFeed(...... int? maxResults) 
```

那是什么意思？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-23T13:05:40.467

诠释？意味着它是一个可为空的 int，因此不仅允许整数值，还允许空值。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-23T13:06:49.343

它是一个[可空类型](http://msdn.microsoft.com/en-us/library/b3h38hb0.aspx#Y0)，`Nullable<T>`。根据[MSDN](http://msdn.microsoft.com/en-us/library/1t3y8s4s%28v=vs.100%29.aspx)

DataType`int`基本上是一种值类型，不能保存 null 值，但是通过使用 Nullable Type，您实际上可以在其中存储 null。

```
maxResults = null; // no syntax error 
```

您可以`Nullable Types`使用两种语法声明：

```
int? maxResults; 
```

或者

```
Nullable<int> maxResults; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-23T13:05:59.890

`?`表示可以为空。这意味着该类型可以包含一个值或为空。

```
int? num = null; // assign null to the variable num 
```

[http://msdn.microsoft.com/en-us/library/1t3y8s4s(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/1t3y8s4s(v=vs.100).aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-23T13:06:06.097

这是一个快捷方式`Nullable<int>`- 这意味着`maxResults`可以将其分配为空。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-23T13:07:30.827

代表一个`int type that can be assigned null.`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-23T13:10:22.387

通常一个 int 不能有一个*空*值，但是使用 '?' 前缀允许它为[Nullable](http://msdn.microsoft.com/en-us/library/1t3y8s4s%28v=vs.100%29.aspx)：

```
int? myNullableInt = null; //Compiles OK
int myNonNullableInt = null; //Compiler output - Cannot convert null to 'int' because it is a non-nullable value type
int myNonNullableInt = 0; //Compiles OK 
```

在您的问题/代码的上下文中，我只能假设它负责根据**?maxResults的值返回****SyndicationFeed**结果，但是由于它可以为空，因此该值可能为空。

 *** * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-23T13:11:15.397

你不能分配`null`给任何**值类型**，包括`integer`。你会得到一个例外

```
int someValue;
someValue=null;//wrong and will not work 
```

但是当你使它可以为空时，你可以分配空。要使 ValueType 为 Nullable，您必须在 valuetype 关键字后面加上符号 **?**

```
<type>? someVariable;

int? someValue;
someValue=null;//assigns null and no issues. 
```

现在你不会得到异常，你可以分配 null。**

# objective-c - 声明没有实例变量的属性

> ID：13031081
> 
> 赞同：0
> 
> 时间：2012-10-23T13:05:01.423
> 
> 标签：objective-c

由于 Xcode 现在自动添加了一个 @synthesis，我如何声明一个**没有**相应 ivar 的属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:08:16.910

您需要实现 getter 和 setter，然后它不会自动合成并自动创建 ivar。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:17:37.753

```
@interface Obj : NSObject
@property NSString* str;
@end

@implementation

-(NSString*) str {
    //TODO:
    return @"sdfsdf";
}

-(void) setStr:(NSString*) st {
//TODO:
}

@end 
```

命名约定很简单：

getter 与属性同名（比如str），setter 必须有set 前缀，即setPropertyName（属性名首字母大写：setStr:)

您还可以添加 atomic、retain、strong 等属性，但如果您自己实现属性，它们将不起作用，但这对您的类的用户来说是一个很好的提示。

# javascript - 需要在 Blogger 上调用 Javascript 函数

> ID：13031085
> 
> 赞同：0
> 
> 时间：2012-10-23T13:05:17.583
> 
> 标签：javascript, function, blogger

一位 Stackoverflow 成员好心地提供了一个 JavaScript 代码，用于在 Blogger 网站的帖子上出现第一个“/a”后立即调用函数的使用，基本上是在帖子的开头图片正下方插入一个广告框并继续流动文章的左侧。

问题是它只有在我将 JavaScript 代码插入正文末尾和 div 标记之后才有效。

如果我在其他任何地方添加 JavaScript 代码，包括在结束头的正上方，它就不起作用。

就目前而言，它并不总是在所有浏览器上加载广告/框（标有 XXXXXX），而在它加载的浏览器上，它会占用大量时间来加载。

我已经尝试了各种各样的事情，我还没有设法解决它。我会很感激一些帮助。

给我的代码如下：

```
 <div id="payload" class="left">
XXXXXXXX
</div>

<div id="target">
Content within the target.
</div>

<data:post.body/><div style='clear: both;'/> <!-- clear for photos floats -->
</div>
<script type='text/javascript'>
function insertAfter(addition,target) {
var parent = target.parentNode;

if (parent.lastChild == target) {
    parent.appendChild(addition);  
} else {
    parent.insertBefore(addition,target.nextSibling);
}
}

var payload = document.getElementById("payload");
var target = document.getElementById("target");

var anchors = target.getElementsByTagName("a");

if (anchors.length > 0) {
insertAfter(payload,anchors[0]);
}
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T14:10:08.213

如果你被允许使用 jquery，你可以写在 head

```
 $(function() {
     $("#payload").after($("#target").find("a").first());
 }); 
```

# javascript - 鼠标点击图片的位置

> ID：13031098
> 
> 赞同：1
> 
> 时间：2012-10-23T13:05:47.987
> 
> 标签：javascript

对于一个 Js 人来说，我想做的事情应该很容易，但我只是一个 php 人（只是一个初学者。）。我现在正在做的一个项目需要这个。

我想要做的是，获取图像上的点击坐标并将其发布到 php 脚本，以便我可以获取值并完成其余的处理。（我不知道ajax，所以这是我想的唯一方法）。

我找到了一个代码，但这会根据需要多次显示 X 和 Y 点。我希望它只工作一次。

```
 <script type="text/javascript">
<!--

function FindPosition(oElement)
{
if(typeof( oElement.offsetParent ) != "undefined")
{
for(var posX = 0, posY = 0; oElement; oElement = oElement.offsetParent)
{
posX += oElement.offsetLeft;
posY += oElement.offsetTop;
}
return [ posX, posY ];
}
else
{
return [ oElement.x, oElement.y ];
}
}

function GetCoordinates(e)
{
var PosX = 0;
var PosY = 0;
var ImgPos;
ImgPos = FindPosition(myImg);
if (!e) var e = window.event;
if (e.pageX || e.pageY)
{
PosX = e.pageX;
PosY = e.pageY;
}
else if (e.clientX || e.clientY)
{
PosX = e.clientX + document.body.scrollLeft
+ document.documentElement.scrollLeft;
PosY = e.clientY + document.body.scrollTop
+ document.documentElement.scrollTop;
}
PosX = PosX - ImgPos[0];
PosY = PosY - ImgPos[1];
document.getElementById("x").innerHTML = PosX;
document.getElementById("y").innerHTML = PosY;
}

//-->
</script>
<img src="newapp.jpg" alt="" id="myImgId" height="300" width="400"><p>Click on the image to get the coordinates.</p>

<script type="text/javascript">
<!--
var myImg = document.getElementById("myImgId");
myImg.onmousedown = GetCoordinates;
//-->
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:13:09.663

你甚至可以在没有 javascript 的情况下做到这一点（只需使用 html 和 php ；）

```
<?php
  $foo_x=$_POST['foo_x'];
  $foo_y=$_POST['foo_y'];
  echo "X=$foo_x, Y=$foo_y ";
?>
<form action='' method=post>
  <input type="image" alt=' Finding coordinates of an image' src="xy-coordinates.jpg" name="foo" style=cursor:crosshair;/>
</form> 
```

关键是类型属性设置为`type="image"`。

源码和演示：[http ://www.plus2net.com/php_tutorial/php_image_coordinates.php](http://www.plus2net.com/php_tutorial/php_image_coordinates.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:16:45.007

```
 $("image").click(function(e){
      var pageCoords = "( " + e.pageX + ", " + e.pageY + " )";
      var clientCoords = "( " + e.clientX + ", " + e.clientY + " )";
      $("span:first").text("( e.pageX, e.pageY ) : " + pageCoords);
      $("span:last").text("( e.clientX, e.clientY ) : " + clientCoords);
    });​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-14T13:48:00.470

为什么我不能给你这个代码：

```
document.getElementById("x").value     = PosX;
document.getElementById("y").value= PosY; 
```

# macos - 用渐变颜色绘制字符串

> ID：13031099
> 
> 赞同：3
> 
> 时间：2012-10-23T13:05:49.140
> 
> 标签：macos, core-graphics, gradient, nsattributedstring

有没有办法在 NSView 中用渐变颜色绘制一个字符串？渐变不是背景，而是字母本身。也许一些面具，或者这样？

（其实不是文字，而是图标字体）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-03-27T10:55:56.130

```
override func draw(_ rect: CGRect) {

    //Add gradient layer
    let gl = CAGradientLayer()
    gl.frame = rect
    gl.endPoint = CGPoint(x: 0, y: 0)
    gl.colors = [UIColor.red.cgColor, UIColor.blue.cgColor]
    layer.addSublayer(gl)

    //create a text layer mask
    let tl = CATextLayer()
    tl.frame = rect
    tl.string = "My String in Gradient"

    //Add mask to gradient layer
    gl.mask = tl

} 
```

[![图片显示带有渐变的文字](../Images/d89b8fcee00f293d90ac357f1e5cef88.png)](https://i.stack.imgur.com/a9r3o.png)

希望这可以帮助！

# java - 第四个符合 GC 条件的对象在哪里创建？

> ID：13031101
> 
> 赞同：1
> 
> 时间：2012-10-23T13:05:53.617
> 
> 标签：java, garbage-collection

```
01 class Account { Long acctNum, password;}
02 public class Banker {
03  public static void main(String[] args){
04      new Banker().go(); //created object
05      //Here there are 4 objects eligible to GC
06  }
07  void go(){
08      Account a1 = new Account(); //created object
09      a1.acctNum = new Long("1024"); //created object
10      Account a2 = a1;
11      Account a3 = a2;
12      a3.password = a1.acctNum.longValue();
13      a2.password = 4455L;
14  }
15 } 
```

在第 13 行创建了一个 long 并且当 autobox 使包装器 Long 时，可能是创建的第四个对象吗？

以下行是否也在创建对象？

```
long l = 4455L;
long m = 4455;
long n = 4455l; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:09:33.057

```
Long l = 4455L; 
```

自动装箱并创建对象（就像这样`a2.password = 4455L;`做一样）。W

尽管以下没有（因为类型是原始的，所以不需要自动装箱）

```
long l = 4455L; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:11:26.927

是的，你是对的，第 13 行确实通过自动装箱创建了一个新的 Long。其他 3 行 (l,m,n) 不创建对象，因为它们是基元。

所以你的 4 个对象是 Banker、Account 和两个 Longs。

# eclipse - Eclipse CDT - 标准输出、标准输入和标准错误消失了

> ID：13031102
> 
> 赞同：1
> 
> 时间：2012-10-23T13:05:54.413
> 
> 标签：eclipse, eclipse-cdt

几个月来，我一直在使用 Eclipse-CDT Helios 7.0.1。最近我下载了 Juno 并尝试使用他们的便携式网络安装程序安装 MinGW 和 CygWin。

我的互联网连接速度很慢 => 多次尝试下载 MinGW 和 CygWin 软件包。如果我没记错的话，我在 CygWin 中选择了 Dev 包，在 MinGW 中选择了稳定包。

问题： 1\. Juno 根本没有打开，它抛出异常并退出。2\. Helios，虽然它编译文件控制台不工作。

有人能指出我正确的方向吗？

# .net - 将实体框架与 LinqPad 或 EFProviderWrapperToolkit 一起使用时，表值函数的 SQL 参数类型不正确

> ID：13031103
> 
> 赞同：2
> 
> 时间：2012-10-23T13:05:55.323
> 
> 标签：.net, entity-framework, linqpad

我的实体框架应用程序使用几个表值函数在 SQL Server 2008 中进行全文搜索。

我的函数参数总是在商店端`strings`转换`nvarchar(4000)`。一切正常。

但是，每当我从内部调用相同的函数`LinqPad`或使用自定义 EF 提供程序，特别是[EFProviderWrapperToolkit](http://code.msdn.microsoft.com/EFProviderWrappers-c0b88f32/sourcecode?fileId=19054&pathId=791898583)时，都会传入字符串参数，`nvarchar(1)`从而阻止它们工作。

我特别关心 EFProviderWrapperToolkit，因为我不想将它用作我的日志层。

有什么办法可以解决这个问题吗？

我正在使用`EF 4.2 2012 June CTP`，如果您认为升级到`5.0`会有所帮助，我可以试一试。我还没有，因为我认为升级到`5.0`将迫使我升级到`.NET 4.5 and VS 2012`现在会产生巨大的影响，因为我的产品正在生产中。

**编辑**

我刚刚检查并以这种方式自动导入了字符串参数：

```
<Parameter Name="aProcessoSimplesTerm" Type="nvarchar" Mode="In" /> 
```

您会看到没有尺寸规格。我没有改变它，它是它被导入的方式。

# django - Django 反向 URL 在生产中中断

> ID：13031105
> 
> 赞同：2
> 
> 时间：2012-10-23T13:05:57.267
> 
> 标签：django, url, django-templates, django-views, production-environment

我`Reverse for 'home' with arguments '()' and keyword arguments '{}' not found.`遇到这种情况发生在一个不带参数的视图上，并且在模板中命名为带引号和不带引号。它只发生在我的生产服务器上，而不是我的开发环境。两者都运行 Django 1.4。

我在顶层有以下无参数视图条目`urls.py`。

```
url(r'^course_catalog/', include('course_catalog.urls')), 
```

在`course_catalog/urls.py`：

```
urlpatterns = patterns('course_catalog.views',
    url(r'^$', 'index', name="home"),
    ... 
```

我在几个模板中也有以下内容

```
<a href="{% url home %}"> 
```

我也在`manage.py`shell 中试过这个：

```
>>> from django.core.urlresolvers import reverse
>>> reverse('home')
'/course_catalog/' 
```

所以它似乎只发生在提供模板或其他东西时。顺便说一句，如果我导航到 URL，视图本身就可以工作。

我真的不知道在哪里看这一点。

知道什么可能导致这种情况发生吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T14:00:16.827

> 使用参数 '()' 反转 ''home''

似乎您正在`{% url 'home' %}`使用没有`{% load url from future %}`. 这可以解释为什么 django double-single-quote `''home''`。就像你在做`reverse("'home'")`.

# powershell - 如何使用powershell检查节点是否存在而不出现异常？

> ID：13031110
> 
> 赞同：7
> 
> 时间：2012-10-23T13:06:07.427
> 
> 标签：powershell, powershell-2.0

我正在尝试检查特定节点是否存在，如下所示。

在我的配置文件中有一个名为 client 的节点，它可能可用也可能不可用。

如果它不可用，我必须添加它。

```
 $xmldata = [xml](Get-Content $webConfig)    

        $xpath="//configuration/system.serviceModel"    
        $FullSearchStr= Select-XML -XML $xmldata -XPath $xpath

If ( $FullSearchStr -ne $null) {  

        #Add client node
        $client = $xmldata.CreateElement('Client')
        $client.set_InnerXML("$ClientNode")
        $xmldata.configuration."system.serviceModel".AppendChild($client) 
        $xmldata.Save($webConfig) 

    } 
```

我正在检查的条件可能会返回数组。

我想检查客户端节点之前是否可用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-23T13:33:31.610

您可以尝试 SelectSingleNode 方法：

```
$client = $xmldata.SelectSingleNode('//configuration/system.serviceModel/Client')

if(-not $client)
{
    $client = $xmldata.CreateElement('Client')
    ...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-24T06:05:07.083

为什么你不能这样做：

```
$xmldata = [xml](Get-Content $webConfig)    
$FullSearchStr = $xmldata.configuration.'system.serviceModel' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-23T05:48:32.243

您也可以像布尔值一样使用“计数”

```
if ($xmldata.SelectSingleNode('//configuration/system.serviceModel/Client').Count)
{
 The count is 1 or more, so it exists
}
else
{
 The count is 0, so it doesn't exists
} 
```

# c# - 控制台应用程序无法从服务器连接到 sql server 实例，但可以从本地计算机

> ID：13031112
> 
> 赞同：2
> 
> 时间：2012-10-23T13:06:08.563
> 
> 标签：c#, sql-server, sql-server-2008-r2, console-application

我有一些在专用服务器上运行的 asp.net Web 应用程序。对于其中一个网站，我正在执行一项维护任务，将所有用户上传的图像升级为新的命名约定。

我编写了一个小而简单的控制台应用程序来完成这项工作。我将连接字符串放在我的 app.config 中，如下所示：

```
<add key="CS" value="Data Source=1.1.1.1;Initial Catalog=MyDatabase;User ID=usr; Password=pwd" /> 
```

^(当然，这里的细节是虚拟的，它们实际上并不是`MyDatabase`等等......但我确实使用 IP 地址连接到 sql 服务器)

我所有的 Web 应用程序都具有相同的格式，`web.config`文件中的相同细节，除了数据库名称。一切正常。

我可以从本地开发机器上运行控制台应用程序，使用生产数据库，它连接良好，没问题。（成功在测试数据库上运行测试查询）

现在，我需要访问硬盘来重命名文件等......所以我想在服务器上运行这个控制台应用程序......我将应用程序 FTP 到我的服务器并尝试在那里运行它......它错误地说：

```
A network-related or instance-specific error occurred while establishing
a connection to SQL Server. The server was not found or was not accessible. 
Verify that the instance name is correct and that SQL Server is configured 
to allow remote connections. (provider: SQL Network Interfaces,
error : 26 - Error Locating Server/Instance Specified) 
```

就像我之前提到的，相同的连接在我的开发机器上运行良好，只有当我尝试在服务器中运行控制台应用程序时才会发生这种情况。

我试过搜索，但在任何地方都找不到类似的案例……尤其是。因为我所有使用相同值的 Web 应用程序都可以正常工作。我是否需要告诉应用程序使用某些东西？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:16:24.600

Web 服务器和数据库服务器是否在同一台机器上？

无论如何，在 Web 服务器上打开命令提示符并执行以下操作：

```
telnet <ip>, 1433 
```

这假设您在标准端口上运行 SQL Server，如果不是，请进行相应更改。

查看是否可以通过 telnet 连接到数据库服务器，有助于确定是否存在防火墙/基本连接问题。

# logging - Symfony2 日志中由“OPTIONS”http 请求引起的 404 错误

> ID：13031114
> 
> 赞同：2
> 
> 时间：2012-10-23T13:06:09.937
> 
> 标签：logging, symfony, http-status-code-404

我们之前在生产环境中交付了一个 Symfony2 项目。在**`prod.log`**文件中，我们有很多时间出现 404 错误：

```
[2012-10-17 13:10:03] request.ERROR: Symfony\Component\HttpKernel\Exception\NotFoundHttpException: 
No route found for "OPTIONS /bundles/mythemes/css/" 
(uncaught exception)at /data/apps/project/webapp/version/app/cache/prod/... 
```

这是正常的，因为用户无法解析 CSS 目录，一个有效的 URL 例如：

```
/bundles/mythemes/css/ie7.css 
```

我在 Symfony2 跟踪器上发现了一个问题，该问题也与错误的 http "OPTIONS" 查询有关：

[https://github.com/FriendsOfSymfony/FOSRestBundle/issues/142](https://github.com/FriendsOfSymfony/FOSRestBundle/issues/142)

我只是想知道是什么导致了这个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T19:09:03.973

我找到了问题的根源，在这些情况下，引用者是“Microsoft Office 协议发现”。这一切都在这篇文章中进行了解释：

[什么是“Microsoft Office 协议发现”和“OfficeLiveConnector”，它们为何访问无效 URL？](https://stackoverflow.com/questions/8073908/what-are-microsoft-office-protocol-discovery-and-officeliveconnector-and-why)

# wordpress - 几种分类法的 WordPress 查询帖子

> ID：13031125
> 
> 赞同：1
> 
> 时间：2012-10-23T13:06:55.103
> 
> 标签：wordpress, taxonomy

我在这个问题上搜索了很多，但找不到任何结论性的东西。也许有人可以在这里帮助我！

我有自定义帖子类型“地点”和两个自定义分类法“地点区域”和“地点类别”。我正在通过这两个分类法构建一个下拉过滤器。如果过滤器为空并且选择了两个分类法，那么一切都很好。但是，如果其中一种分类法具有价值而另一种分类法为空，我无法弄清楚如何使其工作。

这是我的查询：

```
if(($category == null) && ($area == null)) {

    //Usual query without taxonomy

  } else {
    $args = array(
      'post_type'      => 'place',
      'tax_query' => array(
            array(
                'taxonomy' => 'placecat',
                'field' => 'slug',
                'terms' => $category
            ),
            array(
                'taxonomy' => 'placearea',
                'field' => 'slug',
                'terms' => $area
            )
        )
    );
  }
  $the_query = new WP_Query( $args ); 
```

我认为空值将意味着所有分类术语，但似乎它正在寻找一个不存在的术语并返回空结果。

如果术语值为空，有什么想法可以从查询中排除分类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:18:42.933

如果您单独检查它们，您也可以单独添加它们。

```
$args['post_type'] = 'place';

if ( $category != null ) {  
    $args['tax_query'][] =  array(
        'taxonomy' => 'placecat',
        'field' => 'slug',
        'terms' => $category
     );
}

if ( $area != null ) {  
    $args['tax_query'][] = array(
        'taxonomy' => 'placearea',
        'field' => 'slug',
        'terms' => $area
     );
} 
```

`tax_query`在这种情况下，如果它们不为空，我们只会将它们添加到参数中。

# python - pydev：拥有多个源文件夹的理由是什么？

> ID：13031129
> 
> 赞同：3
> 
> 时间：2012-10-23T13:07:09.813
> 
> 标签：python, eclipse, module, package, pydev

我正在使用 Eclipse + pydev 并且没有现有的源文件夹，但有嵌套模块，例如 http://pydev.org/manual_101_first_module.html 中描述的[root.nested](http://pydev.org/manual_101_first_module.html)。考虑到每个包都创建自己的子文件夹（并且包必须驻留在源文件夹中），拥有几个文件夹是否有意义。换句话说：为什么将包放在不同的源文件夹中有意义？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:31:30.933

从下面的文档中，听起来“源文件夹”只是 PyDev 中的一个特殊名称，它会导致 PyDev 自动将该文件夹添加到项目的 PYTHONPATH 中。我想这更多的是个人喜好，你想如何组织你的项目。

[http://pydev.org/manual_101_project_conf2.html](http://pydev.org/manual_101_project_conf2.html)

# visual-c++ - 在 MFC 应用程序中处理“发送到”

> ID：13031131
> 
> 赞同：0
> 
> 时间：2012-10-23T13:07:14.477
> 
> 标签：visual-c++, mfc

我正在尝试将窗口资源管理器右键单击上下文菜单功能对“发送到”的支持添加到我的 MFC 应用程序中。为此，我解析了命令行参数`m_lpCmdLine`以`InitInstance()`获取文件路径并打开它。这是应用程序未运行时的情况。

但是如果应用程序已经在运行。然后在这种情况下，我不想创建一个新实例。

将这些命令行选项传递给现有实例需要什么。

任何建议都会非常有帮助。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T07:09:01.830

谢谢我得到了解决方案！

我需要找到打开实例的句柄和发送消息以及将在 CMainFrame 类中处理的数据。

```
CWnd*  pCWnd;
if(pCWnd = CWnd::FindWindow(_T("MyApplication"), NULL))
{
    if(m_lpCmdLine != '\0')
    {
        COPYDATASTRUCT cds;
        memset(&cds, 0, sizeof(cds));

        cds.dwData = MY_ACTION;
        cds.cbData = strlen(m_lpCmdLine) + 1;
        cds.lpData = (LPVOID) (LPCTSTR)m_lpCmdLine;

        pCWnd->SendMessage(WM_COPYDATA,(WPARAM)NULL, (LPARAM)&cds);
    }
} 
```

现在在，

```
MainFrame::OnCopyData()
{
} 
```

我们可以得到这个值。

更详细的说明，请阅读“Win32 中的多线程应用”的进程间通信章节。

# image-processing - 使用 uC/DSP 进行图像稳定

> ID：13031134
> 
> 赞同：1
> 
> 时间：2012-10-23T13:07:25.710
> 
> 标签：image-processing, embedded, video-streaming, image-stabilization

我正处于一个项目的研究阶段，该项目涉及稳定将由 RF 发送的视频流中的图像。我希望使用 DSP 进行处理，或者如果可能的话，使用在相机附近（而不是接收端）包含 DSP（如 STM32F4x）的 uC 来完成。

关于哪种算法最适合这种应用程序的任何想法（显然实时约束是最重要的）？此外，任何关于什么是最好的提示：uC 或 DSP？和哪种类型？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:12:48.490

关于目标：

*   当 DSP 专注于重复和短算法时，它的效率会更高，这似乎是你的情况。
*   uC 将更加专注于多种通用功能，例如通信、小型计算、调试......

请记住，大多数 DSP 都非常接近 uC 环境：外围设备、多通信通道、操作系统就绪......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:53:03.770

最好的是高度主观的，但是，您需要确保有足够的内存来缓冲一帧或更多帧（取决于算法），当然一些 DSP 功能会很好。至于算法，请检查这些问题及其答案：

[图像稳定/对齐算法](https://stackoverflow.com/questions/3532133/image-stabilization-alignment-algorithm)

[使用 OpenCV 进行视频稳定](https://stackoverflow.com/questions/3431434/video-stabilization-with-opencv)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-01T05:43:24.853

1.  如果您正在制作玩具，请使用微控制器。
2.  如果您正在构建一个体面的消费产品，请使用 DSP 应用处理器
3.  如果您正在构建超级稳健的产品，如汽车电子/控制，请使用 DSP + FPGA 的组合

选择取决于应用。对于纯粹的 MAC 性能，我选择了 Analog Devices。对于 MAC 和其他花里胡哨，我会从 TI 的视频 DSP 产品组合中选择一些东西。试试他们——比如达芬奇TMS320DM系列。AD Blackfin 曾经拥有令人印象深刻的 MAC 性能 + uC 功能。但其长期路线图尚不清楚。

问题的复杂性和细节会激发您的应用程序对 DSP/数学的密集程度。

1.  图像、视频（或视频中的图像）稳定可以通过单独的输入或借助额外的外部测量来隐式完成。它不仅仅是 DSP，而是统计、LSF 等简单运动估计和跟踪算法等的组合。DSP 只是必要的方法集合之一。

2.  如果您正在构建漫游车/机器人或汽车摄像头，传感器融合（如 9 轴 Accel + Gyro + Mag）将有助于测量您的输入测量值（摄像头输入）有多“颠簸”。这些有助于在 DSP 滤波器上选择正确的系数。

3.  在没有传感器帮助的情况下，还有隐含的“运动估计”。它被称为**光流**。用于光学鼠标或无人机稳定的相同技术。根据二维像素阵列上的扫描/漂移量和方向检测相机的快速或慢速运动。

4.  DSP滤波器、向量处理算法有一个共同点，就是重复乘法和重复加法（累加）。这需要好的MAC单元，所以DSP处理器是首选。

5.  即使在 DSP 滤波器上动态计算正确的系数也是数学密集型的。因此使用 DSP 处理器具有递归的优点！

# java - 将接收到的数据记录到 txt 文件中

> ID：13031137
> 
> 赞同：0
> 
> 时间：2012-10-23T13:07:39.937
> 
> 标签：java, logging, log4j, filewriter

我想将数据记录到一个txt文件，即我将从com端口接收数据，然后将其写入文本文件。这是否符合记录？还是记录指的是错误记录？如果第一种情况是真的，我想我应该使用 log4j，因为我已经读过这是日志记录的标准？但是，如果不是这种情况，那么可以使用 FileWriter 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:18:42.937

使用`java.util.logging.Logger`. 使用以下步骤：

1.  在启动时，创建一个`Logger`with `Logger.getLogger(name)`（您定义要用于系统的任何日志记录名称）。
2.  使用 决定您希望日志的位置`Logger.addHandler`。例如，如果要将日志输出到文件，请使用`java.util.logging.FileHandler`.
3.  在任何你想记录东西的地方，使用`Logger.getLogger(name).log()`.

就是这样！FileHandler 将自动写入您的文本文件。如果您想将日志放在其他地方（例如，数据库），请添加不同的处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:20:27.147

我正在使用 Rxtxcomm 库做类似的事情。使用 log4j 记录从串口传入的数据是没有问题的。

事实上，记录并不一定意味着“错误记录”。例如，如果您试图找出程序中的错误出现在哪个配置中，您可以使用您的程序记录尽可能多的信息。就我而言，我记录了诸如检测到载波检测信号之类的事件的使用。

# java - 条件 eclipselink 加入

> ID：13031138
> 
> 赞同：0
> 
> 时间：2012-10-23T13:07:45.770
> 
> 标签：java, eclipselink, criteria-api

我不明白如何加入 eclipse 链接与标准。这是我的实体：

```
public class A implements Serializable {

  @Id
  @GeneratedValue(strategy = GenerationType.IDENTITY)
  @Basic(optional = false)
  @Column(name = "id")
  private Long id;
  @Column(name = "value")
  private String value;   

  @OneToMany(mappedBy = "aid")
  private Collection<B> bCollection; 
}

public class B implements Serializable {

  @Id      
  @GeneratedValue(strategy = GenerationType.IDENTITY)
  @Basic(optional = false)
  @Column(name = "id")
  private Long id;

  @JoinColumn(name = "a_id", referencedColumnName = "id")
  @ManyToOne
  private A aid;  
} 
```

我这样做：

```
 CriteriaBuilder cb = em.getCriteriaBuilder();
    CriteriaQuery cq = cb.createQuery();
    Root<A> a = cq.from(A.class);
    Join<A, B> j = a.join("aid",JoinType.INNER);
    cq.distinct(true);
    //and now what?        
    cq.where(cb.equal(a.get("id"), "aid"));
    Object r = em.createQuery(cq).getResultList(); 
```

现在，如何将我的 join 子句绑定到 CriteriaQuery？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T15:29:16.750

首先，为了获得包含来自 A 和 B 的所有字段的结果列表，您需要将结果塑造为`Tuple`s 列表或 s 列表，`Object`如[本文所述（](http://www.ibm.com/developerworks/java/library/j-typesafejpa/)**投影结果**章节）。

这需要使用[多选](http://docs.oracle.com/javaee/6/api/javax/persistence/criteria/CriteriaQuery.html#multiselect%28javax.persistence.criteria.Selection...%29)语句或使用如下[构造](http://docs.oracle.com/javaee/6/api/javax/persistence/criteria/CriteriaBuilder.html#construct%28java.lang.Class,%20javax.persistence.criteria.Selection...%29)：

```
cq.multiselect(a, b));
cq.select(cb.construct(a, b)); 
```

其中 b 应该像这样获得：

```
CollectionJoin<A, B> b = a.join(A_.bCollection, JoinType.INNER);  // using Metamodel 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T18:51:27.170

如果您想要的只是“从 A 中选择 a 并加入 a.bCollection”，从而只返回带有 B 的 As，那么您只需要：

```
CriteriaBuilder cb = em.getCriteriaBuilder();
CriteriaQuery cq = cb.createQuery();
Root<A> a = cq.from(A.class);
Join<A, B> j = a.join("bcollection",JoinType.INNER);
cq.distinct(true);
Object r = em.createQuery(cq).getResultList(); 
```

JPA 将使用 B 的辅助属性上定义的关系为您创建 A->B 表连接，因此您不需要。返回的 A 将是完整的，除了由于您在 bCollection 映射上使用默认获取类型，Bs 可能会延迟获取。如果您希望它们在单个查询中急切地引入并关联到 As，请使用 fetch 方法而不是 join：

```
a.fetch("bcollection",JoinType.INNER); 
```

# c# - 使用 Encapsulation 处理 WCF 服务继承问题怎么样？

> ID：13031140
> 
> 赞同：1
> 
> 时间：2012-10-23T13:07:48.890
> 
> 标签：c#, .net, wcf

这个问题是关于*Microsoft WCF*上下文中的编程和最佳实践的理论问题，特别关注*Web 服务*。

## Web服务中的继承

考虑一种情况，当我们需要定义一些功能时。我们希望使用 Web 服务向世界公开这些功能。功能由接口建模（在处理分布式系统等时这是一个非常好的实践）。所以我们有如下内容：

```
///
/// Functionalities for a certain context, calling them A functionalities
///
public interface IFunctionalitiesA {
   FunctionalityA1ResMsg FunctionalityA1(FunctionalityA1ReqMsg msg);
   FunctionalityA2ResMsg FunctionalityA2(FunctionalityA2ReqMsg msg);
   FunctionalityA3ResMsg FunctionalityA3(FunctionalityA3ReqMsg msg);
}

///
/// Functionalities for a certain context, calling them B functionalities
///
public interface IFunctionalitiesB {
   FunctionalityB1ResMsg FunctionalityB1(FunctionalityB1ReqMsg msg);
   FunctionalityB2ResMsg FunctionalityB2(FunctionalityB2ReqMsg msg);
}

///
/// Functionalities for a certain context, calling them C functionalities
///
public interface IFunctionalitiesC {
   FunctionalityC1ResMsg FunctionalityC1(FunctionalityC1ReqMsg msg);
   FunctionalityC2ResMsg FunctionalityC2(FunctionalityC2ReqMsg msg);
   FunctionalityC3ResMsg FunctionalityC3(FunctionalityC3ReqMsg msg);
   FunctionalityC4ResMsg FunctionalityC4(FunctionalityC4ReqMsg msg);
}

///
/// Functionalities for a certain context, calling them D functionalities
///
public interface IFunctionalitiesD {
   FunctionalityD1ResMsg FunctionalityD1(FunctionalityD1ReqMsg msg);
   FunctionalityD2ResMsg FunctionalityD2(FunctionalityD2ReqMsg msg);
} 
```

现在让我们考虑所有这些功能都可以通过一些服务来实现。但是，拥有一个服务来实现它们并不是强制性的。一个服务可以实现其中的一些，而另一个服务可以实现其中的另一个子集。我特别要求考虑以下情况：

```
///
/// This service implements functionalities A and B.
///
public class ServiceS1 : IFunctionalitiesA, IFunctionalitiesB {
   ... /* Implementing interfaces methods */
}

///
/// This service implements functionalities C and D.
///
public class ServiceS2 : IFunctionalitiesC, IFunctionalitiesD {
   ... /* Implementing interfaces methods */
} 
```

请特别注意，这两个服务将在内部创建一些重要的东西。我的意思是他们拥有只有他们才能访问的资源，例如第一个服务可能会保留一个元素数组，第二个也是如此。简而言之，它们不是虚拟服务，它们具有状态和资源，并且受到外部访问的保护（因此它们被声明为`public`or `protected`）。

现在让我们考虑我们想要实现一个服务，可能在不同的站点上运行，它实现了所有的功能。在处理各自实现的方法时，该服务的行为将与上述两个完全相同。不幸的是，我们不能从它们两者中得出。所以我们需要这样做：

```
public class GlobalService : 
   IFunctionalitiesA, IFunctionalitiesB, IFunctionalitiesC, IFunctionalitiesD {
   ...
} 
```

## 封装……可以是答案吗？

问题是：

> 如何重用实现整体功能子集的两个服务中的逻辑？

我最终考虑做这样的事情：

```
public class GlobalService : 
   IFunctionalitiesA, IFunctionalitiesB, IFunctionalitiesC, IFunctionalitiesD {

   ///
   /// Encapsulating ServiceS1
   ///
   protected ServiceS1 srvs1;

   ///
   /// Encapsulating ServiceS2
   ///
   protected ServiceS2 srvs2;

   public GlobalService() {
      this.srvs1 = new ServiceS1();
      this.srvc2 = new ServiceS2();
   }

   ///
   /// Methods are redirected internally to the reused implementation
   /// This is to be done for all methods
   ///
   public FunctionalityA1ResMsg FunctionalityA1(FunctionalityA1ReqMsg msg) {
      return thissrvs1.FunctionalityA1(msg);
   }

   ...

} 
```

通过这样做，我可以重用已实现的逻辑，而无需一次又一次地创建冗余代码。当然，这可能是一种仅限于某些情况的方法，但在这些情况下（毕竟没有那么严格）。

这是解决问题的好方法吗？你有不同的想法吗？

# java - 混合使用 yGuard 和服务提供者接口的 Java 混淆

> ID：13031141
> 
> 赞同：1
> 
> 时间：2012-10-23T13:07:50.903
> 
> 标签：java, obfuscation, yguard

我在使用[yGuard](http://www.yworks.com/en/products_yguard_about.html)混淆 java 库时遇到问题。该库的一部分应该是[服务提供者接口](http://code.google.com/p/spi/wiki/HowToSpi)(SPI) 的实现，因此需要从混淆过程中排除。使用这个库的应用程序的非混淆版本可以正常工作。然而，在混淆过程之后，它不会。

我怀疑这是由于`<shrink>`yGuard 的 ANT 任务的元素设置不正确——它可能会删除一些方法，因为它们被认为是未使用的。我确保在混淆 ( `<rename>`) 的重命名阶段中排除了包和类，因此这不应该是问题的原因。

我曾希望通过指定我正在实现的主接口作为收缩引擎的入口点需要实现的唯一方法来避免 SPI 实现的收缩，但失败了。然后这个方法委托给其他接口实现，所以我希望整个事情都可以走动。看看我在下面有什么：

```
<shrink logfile="obfuscate_shrink_log.xml">
    <property name="error-checking" value="pedantic"/>
    <keep>
        <method name="void main(java.lang.String[])" class="package.path.to.main.Class"/>
        <method name="org.relaxng.datatype.DatatypeLibrary createDatatypeLibrary(java.lang.String)" class="package.path.to.my.implementation.of.DatatypeLibraryFactory"/>
        <class classes="public"/>
    </keep>
</shrink>

<rename mainclass="package.path.to.main.Class" logfile="obfuscate_rename_log.xml" replaceClassNameStrings="true">
    <property name="error-checking" value="pedantic"/>
    <keep>
        <class name="package.path.to.my.implementation.of.DatatypeLibraryFactory"/>
        <class name="package.path.to.my.implementation.of.DatatypeLibrary"/>
        <class name="package.path.to.my.implementation.of.Datatype"/>
    </keep>
</rename> 
```

我正在实现一组[org.relaxng.datatype](http://relaxng.sourceforge.net/datatype/java/apiDocs/org/relaxng/datatype/package-summary.html)接口。它们可以通过带有[Jing](http://www.thaiopensource.com/relaxng/jing.html)的 SPI 调用。

如何使用 yGuard 指定要从混淆过程（重命名和收缩）中排除的整个包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T07:31:50.407

仔细阅读 yGuard 的文档后，我意识到我做错了什么（没错，我错过了什么）。如果您按照我在问题中所做的操作，它将导致收缩引擎保留您指定的方法，但不会保留类的构造函数，这将导致 SPI 无法实例化您的实现。

需要执行以下操作：

```
<shrink logfile="obfuscate_shrink_log.xml">
    <property name="error-checking" value="pedantic"/>
    <keep>
        <method name="void main(java.lang.String[])" class="package.path.to.main.Class"/>
        <class name="package.path.to.my.implementation.of.DatatypeLibraryFactory" methods="public"/>
        <class classes="public"/>
    </keep>
</shrink>

<rename mainclass="package.path.to.main.Class" logfile="obfuscate_rename_log.xml" replaceClassNameStrings="true">
    <property name="error-checking" value="pedantic"/>
    <keep>
        <class name="package.path.to.my.implementation.of.DatatypeLibraryFactory"/>
    </keep>
</rename> 
```

这将使特定类的公共 API 不会被混淆收缩和重命名。您只需要省略使您的服务提供者实现被实例化的部分。

# c# - async 关键字和 TaskScheduler 的选择

> ID：13031144
> 
> 赞同：8
> 
> 时间：2012-10-23T13:08:03.217
> 
> 标签：c#, signalr, async-await

我想知道编译器在使用 async 关键字进行编译时选择 TaskScheduler 的原因。

我的测试方法由 SignalR（ASP.NET 主机、IIS8、websocket 传输）在 OnConnectedAsync 方法上调用。

```
protected override async Task OnConnectedAsync(IRequest request, string connectionId)
{
   SendUpdates();
} 
```

在当前同步上下文上启动任务将导致 System.Web.AspNetSynchronizationContext.OperationStarted() 中的 InvalidOperationException

> 此时无法启动异步操作。异步操作只能在异步处理程序或模块内或在页面生命周期中的某些事件期间启动。如果在执行 Page 时发生此异常，请确保将 Page 标记为`<%@ Page Async="true" %>`。

美好的。使用此 SendUpdates 定义，我得到了上述异常：

```
 private async void SendUpdates()
    {
        Task.Run(async () =>
            {
                while (true)
                {
                    await Task.Delay(1000);
                    await Connection.Broadcast("blabla");
                }
            });

    } 
```

但更有趣的是当我没有得到异常时。以下作品：

```
 private void SendUpdates() 
```

以下也适用

```
 private async Task SendUpdates() 
```

最后一个也可以，但它与上面的示例基本相同。

```
 private Task SendUpdates()
    {
        return Task.Run(async () =>
            {
                while (true)
                {
                    await Task.Delay(1000);
                    await Connection.Broadcast("blabla");
                }
            });

    } 
```

你知道编译器是如何在这里选择使用哪个调度器的吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-24T05:35:52.610

编写代码的主要准则之一`async`是“避免`async void`”——也就是说，除非您正在实现事件处理程序，否则使用`async Task`而不是。`async void``async`

`async void`方法使用`SynchronizationContext`'s`OperationStarted`和`OperationCompleted`; 有关更多详细信息，请参阅我的 MSDN 文章[It's All about the SynchronizationContext](http://msdn.microsoft.com/en-us/magazine/gg598924.aspx)。

ASP.NET 检测到调用`OperationStarted`并（正确地）拒绝它，因为在`async`那里放置事件处理程序是非法的。当您更正要使用的代码时`async Task`，ASP.NET 将不再看到`async`事件处理程序。

您可能会发现我的[介绍`async`/`await`帖子](http://nitoprograms.blogspot.com/2012/02/async-and-await.html)很有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-23T13:40:47.427

你打电话时：

```
private async void SendUpdates() 
```

通过调用[`Task.Run`](http://msdn.microsoft.com/en-us/library/hh195051.aspx)和使用匿名委托上的[`async`关键字](http://msdn.microsoft.com/en-us/library/hh156513.aspx)，您实际上并没有提供延续；您启动[`Task`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx)，并且您正在为该`Run`方法提供一个延续，然后它会对其进行处理。该延续不会以任何对调用的代码有意义的方式返回`Task.Run`。

这就是为什么你得到异常，处理程序不*知道*调用产生[`await`](http://msdn.microsoft.com/en-us/library/hh156528.aspx)的原因。`Task``Task.Run`

那说：

```
private void SendUpdates() 
```

工作是因为创建了任务并且代码没有捕获 a [`SynchronizationContext`](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx)（因为方法上没有`async`关键字，`Task`实例默认情况下不会捕获它）。您正在执行任务，但它是一劳永逸的。

以下也有效：

```
private async Task SendUpdates() 
```

即因为在返回 时`Task`，您返回了一个回调可以使用的等待对象。

要直接回答您的问题，编译器将确保在您调用之前获取`SynchronizationContext`返回值；在可等待返回之后调用的任何延续都将使用 that 调用。[`SynchronizationContext.Current`](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.current.aspx)`await``SynchronizationContext`

# testing - 如何下载完整的网站？

> ID：13031147
> 
> 赞同：12
> 
> 时间：2012-10-23T13:08:11.717
> 
> 标签：testing, automation, wget, qa, web-testing

在修复网站代码以使用 CDN（将所有 url 重写为图像、js 和 css）之后，我需要测试域上的所有页面以确保从 CDN 获取所有资源。

所有网站页面都可以通过链接访问，没有孤立的页面。

目前我正在使用 FireBug 并检查“网络”视图......

是否有一些自动化的方式来提供域名并请求域的所有页面+资源？

**更新：**

好的，我发现我可以`wget`这样使用：

```
wget -p --no-cache -e robots=off -m -H -D cdn.domain.com,www.domain.com -o site1.log www.domain.com 
```

**选项解释：**

*   `-p`- 也可以下载资源（图像、css、js 等）
*   `--no-cache`- 获取真实对象，不返回服务器缓存对象
*   `-e robots=off`- 无视`robots`和`no-follow`指示
*   `-m`- 镜像站点（点击链接）
*   `-H`- 跨主机（也关注其他域）
*   `-D cdn.domain.com,www.domain.com`- 指定要关注的女巫域，否则将关注页面中的每个链接
*   `-o site1.log`- 记录到文件 site1.log
*   `-U "Mozilla/5.0"`- 可选：伪造用户代理 - 如果服务器为不同的浏览器返回不同的数据，则很有用
*   `www.domain.com`- 要下载的网站

享受！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-23T16:15:36.933

文档中有这`wget`一点：

> 实际上，要下载单个页面及其所有必需品（即使它们存在于不同的网站上），并确保该批次在本地正确显示，除了“-p”之外，作者还喜欢使用一些选项：
> 
> ```
>  wget -E -H -k -K -p http://site/document 
> ```

关键是`-H`选项，这意味着`--span-hosts -> go to foreign hosts when recursive`。我不知道这是否也代表普通超链接或仅代表资源，但您应该尝试一下。

您可以考虑另一种策略。您无需下载资源即可测试它们是否从 CDN 引用。您可以只获取您感兴趣的页面的源代码（您可以使用`wget`，就像您所做的那样，或`curl`，或其他东西），或者：

*   使用库解析它 - 哪个取决于您用于编写脚本的语言。检查每个`<img />`,`<link />`和`<script />`CDN 链接。
*   使用正则表达式检查资源 url 是否包含 CDN 域。[看到这个:)](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)，虽然在这种有限的情况下它可能不会过于复杂。

You should also check all CSS files for `url()` links - they should also point to CDN images. Depending on the logic of your apllication, you may need to check that the JavaScript code does not create any images that do not come from the CDN.

# c# - 即使我调用 CloudBlob.SetMetadata 也不会保存 Blob 元数据

> ID：13031149
> 
> 赞同：11
> 
> 时间：2012-10-23T13:08:14.413
> 
> 标签：c#, asp.net, azure, azure-blob-storage, azure-sdk-.net

几个小时以来，我一直在尝试在使用 Azure SDK 创建的 blob 上设置一些元数据。我使用异步上传数据`BeginUploadFromStream()`，一切顺利。上传完成后，我可以使用它的 URI 访问 blob，因此它已成功创建，但是**我设置的任何元数据都不会持久化**。

我在调用**后**`EndUploadFromStream()`设置了元数据。

我尝试通过[文档](http://msdn.microsoft.com/en-us/library/windowsazure/ee773197.aspx)可以找到的三种方式设置元数据：

```
// First attempt
myBlob.Metadata["foo"] = "bar";

// Second attempt
myBlob.Metadata.Add("foo", "bar");

//Third attempt
var metadata = new NameValueCollection();
metadata["foo"] = "bar";
blob.Metadata.Add(metadata); 
```

设置元数据后，我调用`myBlob.SetMetadata()`以将元数据保存到 Azure，如文档所指定，但它不会粘住。该调用**不会引发任何异常**，但是当我获得对我的 blob 的新引用时，它**没有任何元数据**。

我也尝试过使用异步保存元数据`BeginSetMetadata()`，`EndSetMetadata()`但结果相似。

我开始认为我在这里遗漏了一些非常微不足道的东西，但是盯着它看了五个小时后，我仍然不明白我哪里错了？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-23T13:23:06.877

SetMetadata 应该按预期工作。但是仅仅获得对 blob 的引用并不足以读取元数据。

获取 blob 引用后，您需要调用该[CloudBlob](http://msdn.microsoft.com/en-us/library/ee772829.aspx)上的 FetchAttributes 方法。这将加载所有属性和元数据，然后您才能访问您之前设置的元数据：

```
// Get a reference to a blob.
CloudBlob blob = blobClient.GetBlobReference("mycontainer/myblob.txt");

// Populate the blob's attributes.
blob.FetchAttributes();

// Enumerate the blob's metadata.
foreach (var metadataKey in blob.Metadata.Keys)
{
    Console.WriteLine("Metadata name: " + metadataKey.ToString());
    Console.WriteLine("Metadata value: " + blob.Metadata.Get(metadataKey.ToString()));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-14T11:49:23.680

我看到这个问题已经很老了，与此同时，我想，API 已经改变了。

现在，如果要获取元数据，则需要在以下代码段中使用**BlobTraits.Metadata选项：**

```
await foreach (BlobItem item in containerClient.GetBlobsAsync(BlobTraits.Metadata))
{
    var name = item.Name;
    var meta = item.Metadata;
} 
```

# java - 如何重写 ArrayList 的 ToString 方法，以便用其他符号替换逗号分隔符？

> ID：13031153
> 
> 赞同：1
> 
> 时间：2012-10-23T13:08:15.317
> 
> 标签：java, arraylist, overriding, tostring

```
class Person {
  public String firstname;
  public String lastname;
}

Person p1 = new Person("Jim","Green");
Person p2 = new Person("Tony","White");

ArrayList<Person> people = new ArrayList<Person>();

people.add(p1);
people.add(p2);

System.out.println(people.toString()); 
```

我必须重写类 Person 的`ToString`方法，以便 p1.toString() 产生`Green, Jim`。结果，上面代码的输出将`[Green, Jim,White, Tony]`是不可取的。如果输出是，例如，文本处理程序会更容易`[Green, Jim&White, Tony]`。默认分隔符需要替换为其他符号，例如&。如果有的话，最简单的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:11:33.540

为什么需要使用 toString 方法来执行此操作？

我建议您将列表传递给您自己制作的自定义格式化程序类。但是，如果您坚持，我认为另一种选择是您扩展 ArrayList 并仅覆盖 toString 方法。

一种选择可能是让 Person 类本身处理格式化它自己类型的项目集合的复杂性：

```
public class Person {
    private String firstName;
    private String lastName;

    public Person(String firstName, String lastName) {
        this.firstName = firstName;
        this.lastName = lastName;
    }

    @Override
    public String toString() {
        return this.lastName + ", " + this.firstName;
    }

    public static String toString(Collection<Person> persons) {
        Iterator<Person> it = persons.iterator();
        if (!it.hasNext())
            return "[]";

        StringBuilder sb = new StringBuilder();
        sb.append('[');
        for (;;) {
            Person e = it.next();
            sb.append(e);
            if (!it.hasNext())
                return sb.append(']').toString();
            sb.append('&').append(' ');
        }
    }
} 
```

然后你可以简单地做这样的事情：

```
Person p1 = new Person("Obi-wan", "Kenobi");
Person p2 = new Person("Luke", "Skywalker");
List<Person> jedis = new ArrayList<>();
jedis.add(p1);
jedis.add(p2);
System.out.println(Person.toString(jedis)); 
```

输出是：`[Kenobi, Obi-wan& Skywalker, Luke]`

但这只是一个想法。我很确定还有很多其他方法可以做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T13:11:16.863

我想你几个小时前刚问了一个类似的问题。但这里有一点不同。对于这种情况，您只需要从您的`toString()`方法中返回字段的串联。

为什么不在名称之间而不是在 ArrayList 中使用不同的分隔符。那将是更容易的任务：-

```
@Override
public String toString() {
    return this.lastname+ ":" + this.firstname;
} 
```

这给你： -

```
[Green:Jim, White:Tony] 
```

并且上面的表示看起来更清晰，并且清楚地将您`names`与分开`,`，因为它应该在任何列表的情况下。元素应始终与`,`else 分开，否则可能会在以后造成混乱。**对于 EG：-**

```
[Green, Jim&White, Tony] 
```

上面的列表在我看来是一个 3 元素列表，其值为：- *Green*、*Jim&White*和*Tony*。

**PS**： -

你永远不应该`public`为你的`fields`. 您的字段应始终为`private`，除非您确实需要直接在课堂外使用。而是提供公共访问器方法来访问它们。我什至建议使用`getters`和`setters`访问同一类中的字段。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-23T13:16:05.653

为什么不 `[firstname,lastname]`从您的 Person 类返回？

所以如果你有一个清单，你会得到`[[Jim,Green],[Tony,White]]`，在这种情况下，你可以轻松清楚地看到你有什么？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-23T13:23:36.113

正如其他人所说，自定义格式化程序是最佳选择。另一种选择是实现您自己的`ArrayList`覆盖默认值的自定义`toString()`。因此，一旦您的`Person.toString()`工作正常，您就可以创建一个如下所示的 ArrayList 类：

```
import java.util.ArrayList;

public class CustomArrayList<T> extends ArrayList<T> {

    private static final long serialVersionUID = 1L;

    @Override
    public String toString() {

        int size = size();

        StringBuilder output = new StringBuilder();

        String delimiter = "&";

        for (int i = 0; i < size; i++) {

            output.append( get( i ) );
            if ( i < size - 1 ) {

                output.append( delimiter );
            }
        }

        return output.toString();
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-23T13:14:31.977

您可以覆盖 Person 类的 toString() 并使用不同的分隔符将“Green Jim”输出为输出

```
class Person {
    public String firstname;
    public String lastname;

    @Override
    public String toString() { 
        return lastname + " " + firstname;
    }
} 
```

输出将变为

```
[Green Jim,White Tony] 
```

# linux - Bash 脚本：如何在配置文件中添加一个部分？

> ID：13031156
> 
> 赞同：0
> 
> 时间：2012-10-23T13:08:26.380
> 
> 标签：linux, bash

我知道如何在配置文件中查找和替换一个部分，如下所示：

```
sudo sed -i "s/upload_max_filesize = 2M/upload_max_filesize = 3M/" /etc/php5/cgi/php.ini 
```

但是如何在 bash 脚本中的配置文件末尾添加一个全新的部分？

```
server {
    listen      xx.xx.xx.xx:80;                # your server's public IP address
    server_name  myapp.com;                   # your domain name
    root         /usr/share/nginx/www/myapp/;  # absolute path to your WordPress installation    
} 
```

我在终端内试过这个，`echo "server { ... }" >> nginx.conf`但我得到了

```
-bash: nginx.conf: Permission denied 
```

不确定这在 bash 脚本中是否可以，或者我会再次获得权限被拒绝...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:14:29.480

您正在使用正确的语法。

```
echo "....." >> ngix.conf 
```

只需确保您对“ngix.conf”具有正确的写入权限。

> -bash：nginx.conf：权限被拒绝

这表明您没有写权限。

您还可以将该部分写入单个文件中，例如“new_section.txt”，并在后期添加：

```
cat new_section.txt >> ngix.conf 
```

但是我不建议以这种方式向 ngix 添加配置。您可以使用“包含”语句。

```
include you_conf_path/my_new_config.conf; 
```

这样，您可以对配置进行分组，并拥有一些小的配置文件，而不是一个大文件。然后，您还可以以帮助您找到正确文件的方式命名您的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T15:23:11.773

试试这个：

```
config="server {\n    listen      xx.xx.xx.xx:80;\n     server_name  myapp.com;               \n    root         /usr/share/nginx/www/myapp/;  =installation    \n }\n"
 in1="text_before_required_input"
 out1=`echo -e $config`;
              in=$in1 out=$out1 perl -pi.nk -e 's/\Q$ENV{"in"}/$ENV{"out"}/g'  file 
```

如果不在上面，请查看 GNU ed [http://wiki.bash-hackers.org/howto/edit-ed](http://wiki.bash-hackers.org/howto/edit-ed)

# webkit - 使用 -webkit-transform: scale(...) 时不需要的左边距

> ID：13031158
> 
> 赞同：18
> 
> 时间：2012-10-23T13:08:33.210
> 
> 标签：webkit, scale, margin, wkhtmltopdf, webkit-transform

我正在使用 wkhtmltopdf（它使用 Webkit 渲染引擎）将 HTML 文件转换为 PDF 文档。生成的 PDF 为 A4。换句话说，它们具有固定的尺寸，因此具有有限的宽度。

我的 PDF 中的一张表格包含图像，这些图像以类似拼图的方式错综复杂地拼凑在一起，有时会占用很多空间。

为了适应 A4 PDF 的约束中产生的难题，我正在应用 CSS 属性 -webkit-transform: scale(...);

这很好地缩放了拼图，它仍然清晰易读，但由于某种原因，它也将包含拼图的桌子推到了右边。尽管我明确地将其左边距设置为 0，但它似乎在拼图表的左侧增加了一个显着的边距。

有趣的是，我的 webkit 转换中的规模越小，左侧的边距越大。因此，例如，如果我使用 scale(0.75)，则生成的左边距约为 200 像素。如果我使用 scale(0.5) ，则生成的左边距约为 400 像素。

我尝试使用绝对、固定和相对定位将拼图表向左对齐：0。我还尝试将其浮动到左侧，并将其粘贴在文本对齐设置为左侧的容器中。这些技术都不起作用。

这个左边距来自哪里以及如何删除它/解决它的任何想法？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-10-23T13:18:02.370

经过一番试验和错误，将以下 CSS 代码添加到拼图表中就可以了：

```
-webkit-transform-origin-x: 0; 
```

此处提供有关此属性的更多信息：http: [//css-infos.net/property/-webkit-transform-origin-x](http://css-infos.net/property/-webkit-transform-origin-x)

更新：请参阅下面 Richar-dW 的评论以获得跨浏览器支持。

# c# - 将映射表作为实体加载到实体框架中

> ID：13031162
> 
> 赞同：1
> 
> 时间：2012-10-23T13:08:47.300
> 
> 标签：c#, entity-framework, mapping

这是采用代码优先方法的最新实体框架。一位客户可以拥有多个属性：

```
public class Customer
{
    [Key]
    public int Id { get; set; }
    public virtual List<CustomerToPropertyMapping> PropertyIds { get; set; }
}   

[Table("CustomerToProperty")]
public class CustomerToPropertyMapping
{
    [Key, Column(Order = 1)]
    public int PropertyId { get; set; }
} 
```

当我加载数据时，一切正常。当我试图拯救客户时，我得到

> 保存不为其关系公开外键属性的实体时发生错误。EntityEntries 属性将返回 null，因为无法将单个实体标识为异常源。通过在实体类型中公开外键属性，可以更轻松地处理保存时的异常。有关详细信息，请参阅 InnerException。

即使我有同样的事情

```
[Key, Column(Order = 0)]
CustomerId 
```

在 CustomerToPropertyMapping 类中。

检索映射而不是它映射到的对象的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:25:19.850

您应该在客户类中设置主键

```
[Table("CUstomerTable")]
public class Customer
{
    [Key]
    public int Id { get; set; }
    public virtual List<CustomerToPropertyMapping> PropertyIds { get; set; }
}   

[Table("CustomerToProperty")]
public class CustomerToPropertyMapping
{
    [Key]
    public int PropertyId { get; set; }
    [Column("Customer_ID")]
    public long CustomerId{ get; set; }
      [ForeignKey("CustomerId")]
    public Customer Customer{ get; set; } 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T15:04:45.850

保持

```
[Key, Column(Order = 0)]
CustomerId 
```

在`CustomerToPropertyMapping`和改变

```
public virtual List<CustomerToPropertyMapping> PropertyIds { get; set; } 
```

到

```
[ForeignKey("CustomerId")]
public virtual List<CustomerToPropertyMapping> PropertyIds { get; set; } 
```

解决了我的问题。

# android - 旁边有文字的Android自定义按钮

> ID：13031166
> 
> 赞同：3
> 
> 时间：2012-10-23T13:09:05.177
> 
> 标签：android, button

我正在尝试创建一个带有文本的自定义按钮。我将有一个项目列表，旁边有一个 (x)，因此用户可以点击 (x) 删除该项目。像这样...

(x)项目1 (x)项目2 (x)项目3

我有一个扩展按钮的类，但我不确定应该覆盖哪些方法，因为当我使用自定义类创建按钮时，它显示为普通按钮。这是我的代码。

```
public class LabelButton extends Button {
  private final Context context;

  private final String label;

  public LabelButton( Context context, String label ) {
    super( context );
    this.context = context;
    this.label = label;
  }

  public View getView( View convertView, ViewGroup parent ) {
    LayoutInflater inflater = (LayoutInflater) context.getSystemService( Context.LAYOUT_INFLATER_SERVICE );
    View labelView = inflater.inflate( R.layout.label, parent, false );
    TextView textView = (TextView) labelView.findViewById( R.id.label );
    Button button = (Button) labelView.findViewById( R.id.buttonCancel );
    textView.setText( "X" );
    return labelView;
  } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:18:15.053

您可以创建一个扩展 LinearLayout 的自定义视图，然后使用包含 Button 和 TextView 的水平 LinearLayout 填充 xml。[我建议像本教程](http://jeffreysambells.com/2010/10/28/custom-views-and-layouts-in-android-os-sdk)一样创建样式属性以进行自定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:18:49.533

您应该使用 Attrs 参数覆盖 onDraw 方法和构造函数

```
 public LabelButton(Context context, AttributeSet attrs, int defStyle) {
             super(context, attrs, defStyle); 
              if (attrs != null) {
              // set your attrs
         }
        }

 @Override
protected synchronized void onDraw(Canvas canvas) {
     super.onDraw(canvas);
     Paint textPaint = new Paint();
     textPaint.setAntiAlias(true);
     textPaint.setColor(textColor);
     textPaint.setTextSize(textSize);
     Rect bounds = new Rect();       
     textPaint.getTextBounds(totalText, 0, totalText.length(), bounds);
     int x = getWidth() / 2 - bounds.centerX();
     int y = getHeight() / 2 - bounds.centerY();
     canvas.drawText(text, getLeft(), y, textPaint);// draw your text in coords
}

public synchronized void setText(String text) {
     if (text != null) {
         this.text = text;
     } else {
         this.text = "";
     }
     postInvalidate();
} 
```

# android - Android HttpUrlConnection HttpPost 收到 SocketException: no route to host

> ID：13031170
> 
> 赞同：1
> 
> 时间：2012-10-23T13:09:15.977
> 
> 标签：android, http-post, httpurlconnection, socketexception

嘿，我尝试通过 wifi 将 HttpPost 发送到本地网络中的特殊设备。如果我在一个简单的 Java 应用程序上尝试相同的代码，它将起作用，但如果我在 android 上尝试相同的代码，我将无法发送 HttpPost。

```
String uri = "http://192.168.3.201:8080/remote/json-rpc/getPeripherals";
Log.i("uri", uri);
String requestBody = "{\"jsonrpc\":\"2.0\",\"method\":"
    + "\"configclient_homedevices/getPeripherals\",\"id\":"
    + "\"1349942076918\",\"params\":[]}";
Log.i("uri", uri);
String contentType = "application/json";
String userpassword = "foo:foo";
String encode = Base64.encodeToString(userpassword.getBytes(),
    Base64.URL_SAFE | Base64.DEFAULT);
try {
    URL url = null;
    url = new URL(uri);
    connection = (HttpURLConnection) url.openConnection(Proxy.NO_PROXY);
    connection.setDoOutput(true);
    connection.setRequestMethod("POST");
    connection.setRequestProperty("Authorization", "Basic" + encode);
    connection.setRequestProperty("Content-Type", contentType);
    connection.setRequestProperty("Accept", "application/json");
    connection.setRequestProperty("Content-Length",
        "" + Integer.toString(requestBody.getBytes().length));
    connection.setUseCaches(true);
    connection.setDoInput(true);
    DataOutputStream out = null;
    out = new DataOutputStream(connection.getOutputStream());
    out.write(requestBody.getBytes());
    out.flush();
    out.close();
} catch (IOException ioE) {
    connection.disconnect();
    ioE.printStackTrace();
}
// connection.connect();
try {
    if (connection.getResponseCode() == HttpURLConnection.HTTP_OK) {
        Log.i("Status", toString().valueOf(connection.getResponseCode()));
        InputStream is = connection.getInputStream();
        BufferedReader rd = new BufferedReader(new InputStreamReader(is));
        String line;
        StringBuffer response = new StringBuffer();
        while ((line = rd.readLine()) != null) {
            response.append(line);
            response.append('\r');
        }
        rd.close();
        this.response = response.toString();
        Log.i("Response", response.toString());
    } else {
        Log.i("Status", toString().valueOf(connection.getResponseCode()));
        Log.i("Status-message", connection.getResponseMessage());
        connection.disconnect();
    }
} catch (IOException e) {
    e.printStackTrace();
} 
```

此函数位于从 AsyncTask 扩展的子类中。在清单中我启用了 Permission.INTERNET

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

结果是：

```
10-23 14:52:51.590: W/System.err(5983): java.net.SocketException: No route to host
10-23 14:52:51.590: W/System.err(5983):     at org.apache.harmony.luni.platform.OSNetworkSystem.connect(Native Method)
10-23 14:52:51.590: W/System.err(5983):     at dalvik.system.BlockGuard$WrappedNetworkSystem.connect(BlockGuard.java:369)
10-23 14:52:51.590: W/System.err(5983):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:208)
10-23 14:52:51.590: W/System.err(5983):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:431)
10-23 14:52:51.590: W/System.err(5983):     at java.net.Socket.connect(Socket.java:901)
10-23 14:52:51.590: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection.<init>(HttpConnection.java:75)
10-23 14:52:51.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection.<init>(HttpConnection.java:48)
10-23 14:52:51.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection$Address.connect(HttpConnection.java:304)
10-23 14:52:51.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnectionPool.get(HttpConnectionPool.java:89)
10-23 14:52:51.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getHttpConnection(HttpURLConnectionImpl.java:292)
10-23 14:52:51.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.makeConnection(HttpURLConnectionImpl.java:250)
10-23 14:52:51.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:217)
10-23 14:52:51.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getOutputStream(HttpURLConnectionImpl.java:624)
10-23 14:52:51.600: W/System.err(5983):     at com.febro.myfoo.fooLoginActivitiy$MakeConnection.doInBackground(fooLoginActivitiy.java:339)
10-23 14:52:51.610: W/System.err(5983):     at com.febro.myfoo.fooLoginActivitiy$MakeConnection.doInBackground(fooLoginActivitiy.java:1)
10-23 14:52:51.610: W/System.err(5983):     at android.os.AsyncTask$2.call(AsyncTask.java:252)
10-23 14:52:51.610: W/System.err(5983):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
10-23 14:52:51.610: W/System.err(5983):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
10-23 14:52:51.610: W/System.err(5983):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1081)
10-23 14:52:51.610: W/System.err(5983):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:574)
10-23 14:52:51.610: W/System.err(5983):     at java.lang.Thread.run(Thread.java:1020)
10-23 14:52:54.600: W/System.err(5983): java.net.SocketException: No route to host
10-23 14:52:54.600: W/System.err(5983):     at org.apache.harmony.luni.platform.OSNetworkSystem.connect(Native Method)
10-23 14:52:54.600: W/System.err(5983):     at dalvik.system.BlockGuard$WrappedNetworkSystem.connect(BlockGuard.java:369)
10-23 14:52:54.600: W/System.err(5983):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:208)
10-23 14:52:54.600: W/System.err(5983):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:431)
10-23 14:52:54.600: W/System.err(5983):     at java.net.Socket.connect(Socket.java:901)
10-23 14:52:54.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection.<init>(HttpConnection.java:75)
10-23 14:52:54.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection.<init>(HttpConnection.java:48)
10-23 14:52:54.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection$Address.connect(HttpConnection.java:304)
10-23 14:52:54.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnectionPool.get(HttpConnectionPool.java:89)
10-23 14:52:54.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getHttpConnection(HttpURLConnectionImpl.java:292)
10-23 14:52:54.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.makeConnection(HttpURLConnectionImpl.java:274)
10-23 14:52:54.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.retrieveResponse(HttpURLConnectionImpl.java:1038)
10-23 14:52:54.600: W/System.err(5983):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getResponseCode(HttpURLConnectionImpl.java:736)
10-23 14:52:54.600: W/System.err(5983):     at com.febro.myfoo.fooLoginActivitiy$MakeConnection.doInBackground(fooLoginActivitiy.java:351)
10-23 14:52:54.600: W/System.err(5983):     at com.febro.myfoo.fooLoginActivitiy$MakeConnection.doInBackground(fooLoginActivitiy.java:1)
10-23 14:52:54.600: W/System.err(5983):     at android.os.AsyncTask$2.call(AsyncTask.java:252)
10-23 14:52:54.600: W/System.err(5983):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
10-23 14:52:54.610: W/System.err(5983):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
10-23 14:52:54.610: W/System.err(5983):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1081)
10-23 14:52:54.610: W/System.err(5983):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:574)
10-23 14:52:54.610: W/System.err(5983):     at java.lang.Thread.run(Thread.java:1020) 
```

异常被抛出

```
out = new DataOutputStream(connection.getOutputStream()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T14:05:48.317

当您通过与 PC 不同的网络连接手机时，可能会发生这种情况。不同的网络可以有不同的防火墙规则。

PC 通常通过内部网络（通常是以太网）连接。而手机通常通过防火墙规则更强的WIFI连接。

顺便说一句，错误是：`java.net.SocketException: No route to host`这与 GET 与 POST 无关。HTTP GET 或 POST 稍后在客户端能够连接后与服务器通信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T11:39:43.647

我为我的问题找到了解决方案。更改此问题后，问题是 url 中的**固定 IP 地址**，我收到了**Status Code 400 Bad Request**。我在将请求切换到异步任务子类之前遇到了这个问题。我在wireshark协议中找到的Bad Request的解决方案。客户端在一个 http Post 中发送 2 个超文本传输​​协议。这是由**android.Base64.encode()**方法引起的。编码器在对 user:password 字符串进行编码后插入了 /n。在这种情况下，客户端发送了一个只有基本身份验证的 http，第二个是没有基本身份验证的正文。所以服务器无法读取请求。

要更改这一点，您应该编写**android.Base64.encode(NO_WARP)**此标志将对用户名：密码进行正确编码。

# java - 如何验证 MD5

> ID：13031179
> 
> 赞同：1
> 
> 时间：2012-10-23T13:09:51.997
> 
> 标签：java, md5, md5sum

我以这种方式创建 MD5：

```
public void encrypeUsername(String sessionid)
    {
        byte[] defaultBytes = sessionid.getBytes();
        try
        {
            MessageDigest algorithm = MessageDigest.getInstance("MD5");
            algorithm.reset();
            algorithm.update(defaultBytes);
            byte messageDigest[] = algorithm.digest();

            StringBuffer hexString = new StringBuffer();
            for (int i = 0; i < messageDigest.length; i++)
            {
                hexString.append(Integer.toHexString(0xFF & messageDigest[i]));
            }
            System.out.println("sessionid " + sessionid + " md5 version is " + hexString.toString());
        }
        catch (Exception e)
        {
            e.printStackTrace();
        }

    } 
```

对于输入 123456，我们得到 MD5：e1adc3949ba59abbe56e057f2f883e

我想创建另一种方法来验证结果。

例如，如果我输入 e1adc3949ba59abbe56e057f2f883e 和“123456”，那么我得到的结果是：真/假。

知道如何实现这一目标吗？

谢谢，雷。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:14:06.280

```
String pass = "123456";
String secret = "e1adc3949ba59abbe56e057f2f883e";
if encrypeUsername(pass).equals(secret) System.out.printl("ok!") 
```

请记住，md5 是单向的。很难*再次从秘密中取回密码。

(*) 现在对于弱密码来说并不那么难。

# php - PHP返回匹配键名的数组和那里的值

> ID：13031183
> 
> 赞同：2
> 
> 时间：2012-10-23T13:10:01.523
> 
> 标签：php, arrays, multidimensional-array

我很难从数组中提取一些值。这是阵列的精简版。

```
$properties = array( array( PropertyID => 2845, 
                  Address_1 => "1234 Any street",
                  MEDIA_IMAGE_00 => "23428.jpg",
                  MEDIA_IMAGE_TEXT_00 => "Front of House",
                  MEDIA_IMAGE_01 => "29872.jpg",
                  MEDIA_IMAGE_TEXT_01 => "Master Bedroom",
                  MEDIA_IMAGE_02 => "29834.jpg"
                ),
              array( PropertyID => 2845, 
                  Address_1 => "555 This street",
                  MEDIA_IMAGE_00 => "234234.jpg",
                  MEDIA_IMAGE_TEXT_00 => "Front of House",
                  MEDIA_IMAGE_01 => "298724.jpg",
                  MEDIA_IMAGE_TEXT_01 => "Second Bedroom",
                  MEDIA_IMAGE_02 => "298346.jpg"
                ),
              array( PropertyID => 2845, 
                  Address_1 => "333 Main street",
                  MEDIA_IMAGE_00 => "2342845.jpg",
                  MEDIA_IMAGE_TEXT_00 => "Lounge",
                  MEDIA_IMAGE_01 => "2987246.jpg",
                  MEDIA_IMAGE_TEXT_01 => "Front of House",
                  MEDIA_IMAGE_02 => "2983434.jpg"
                ),
         ); 
```

每个子数组中都有**大量**数据，我已经将其剪短了长度......

我将此数据插入 MySQL 数据库，但是，我将图像插入单独的表 [PropertyID, Image, ImageText] 因为某些属性可能比其他属性具有更多图像。

所以现在背景已经不碍事了。

如何**仅将匹配的数组键**和信息拉到另一个数组中？所以我最终会得到一个来自上面的数组，最终会得到类似于：

```
$property_images = array( array( PropertyID => 2845, 
                         IMAGE => "23428.jpg",
                         IMAGE_TEXT => "Front of House"),
                  array( PropertyID => 2845,
                         IMAGE => "29872.jpg",
                         IMAGE_TEXT => "Master Bedroom",
                  array( PropertyID => 2845,
                         MEDIA_IMAGE_02 => "29834.jpg"
                         IMAGE_TEXT => "Living Room" 
```

我试过 sscanf 无济于事，摆弄 array_keys 但还没有设法弄清楚如何定位**键名**而不是键值......

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:20:48.607

**编辑：**

```
foreach( $properties as $v ) {
 foreach( $v as $k => $m ) {     

  if( strpos($k, 'MEDIA_IMAGE_TEXT_') !== FALSE  ) {        
    $new_array[] = array('PropertyID' => $v['PropertyID'], 'IMAGE'=>$prev, 'IMAGE_TEXT'=>$m );
  } 

  if( strpos($k, 'MEDIA_IMAGE_') !== FALSE ) {
    $prev = $m;  //var_dump($prev);
  }

 }
} 
```

# nhibernate - 在数据库中插入记录时流利的 Nhibernate 错误

> ID：13031184
> 
> 赞同：-1
> 
> 时间：2012-10-23T13:10:02.807
> 
> 标签：nhibernate, fluent-nhibernate

我通过阅读 PDF 文件在 mysql DB 中插入记录。有 14000 条记录应该插入到数据库中。但经过一些 700-800 条记录后，我得到一个异常，因为“创建会话工厂时使用了无效或不完整的配置”。我正在使用流利的 Nhibernate 并且我的代码在 asp.net 中。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T08:56:57.277

```
 for (int i = 1; i <= iPages; i++)  // ipages value is 2213
        {
            string strPageText = PdfTextExtractor.GetTextFromPage(pdfRdr, i);
            strPageText = Encoding.UTF8.GetString(ASCIIEncoding.Convert(Encoding.Default, Encoding.UTF8, Encoding.Default.GetBytes(strPageText)));

            string[] strRows = strPageText.Split(new char[] { '\n' }, StringSplitOptions.RemoveEmptyEntries);

            string strName = string.Empty;
            string[] strNames;
            string strStatus = string.Empty;
            string EmailAddress = string.Empty;
            int rowCount = 1;
            int iPtRowCnt = 0;
            bool caseFiveFlag = false;

            Patient objPt = new Patient();
            objPt.PatientContact = new PatientContact();

            foreach (string strRowText in strRows)
            {
               // here I am inserting records by parsing .pdf file 
               // my pdf file is 5mb
            } 
```

# java - java 1.4 是否支持 SOAP 绑定 1.2？

> ID：13031190
> 
> 赞同：0
> 
> 时间：2012-10-23T13:10:29.407
> 
> 标签：java, web-services, soap, java1.4

我有一个要求，我必须开发一个 Web 服务客户端来使用一个 Web 服务。

WSDL 显示 SOAP Binding 是 1.2，但 Development 中的 JDK 版本和 App 服务器中的 JRE 是 1.4。

我尝试通过 JDeveloper 10.1.2 开发 Web 服务代理，但它失败了，说 WSDL 无效。

java 1.4是否支持Soap Binding 1.2？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:30:41.970

SOAP 不是 Java SE 的一部分。

一些 SOAP 支持包含在 Java EE ...通过 中`javax.wsl.soap`，但看起来您最好在[Metro 1.4](http://metro.java.net/1.4/docs/soap12.html)中使用 JAX-WS 支持。

不幸的是，Metro 1.4 需要 Java 1.5 (u2) 或更高版本。

但是，无论如何，您都应该认真考虑平台升级。Java 1.4 很久以前就已经报废了。除非您为 Oracle 支持付费，否则您将无法访问安全补丁……而且最近出现了一些重要的补丁。

# css - CSS多列布局，列间距在窗口调整大小时不会改变

> ID：13031194
> 
> 赞同：4
> 
> 时间：2012-10-23T13:10:42.527
> 
> 标签：css, clipping, multiple-columns, window-resize

我正在尝试制作一个多列布局，其中每一列都填充有图像。列的容器必须有水平滚动，但列间距不能在窗口调整大小时改变，最后一列必须能够显示在一侧被裁剪。

列高度取决于父容器，当窗口高度发生变化时，必须重新排列图像以便用整个图像填充列（不应水平剪切图像）。

```
img {
    height: 70px;
    width: 100px;
}

.container
{ 
    height:400px; 
    overflow-x: scroll; 
    overflow-y: hidden;
    -webkit-column-width: 100px;
    column-width: 200px;
    -webkit-column-gap: 20px;
    column-gap: 20px;
}​ 
```

这是我目前拥有的 jsfiddle：http: [//jsfiddle.net/9dL2F/1/](http://jsfiddle.net/9dL2F/1/)

你有什么想法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T16:16:06.280

这很棘手。容器的整个宽度分为列，因此您不能同时拥有固定的列宽和列间隙。随着容器宽度的变化，浏览器想要填充容器。请参阅[CSS 列之间的固定间隙](https://stackoverflow.com/questions/9105384/fixed-gap-between-css-columns)。

您可以管理`.container`: (参见[jsfiddle](http://jsfiddle.net/MX5J3/) )的宽度

```
@media (min-width: 480px) { .container { width: 480px; } }
@media (max-width: 480px) and (min-width: 360px) { .container { width: 360px; } } 
```

...但是要管理很多查询！

垂直排序的图像重要吗？如果行没问题，您可以放弃 CSS3 列：

```
img { display: inline-block; width: 100px; height: 70px; margin-right: 20px;} 
```

同样，您可以浮动：

```
img { float: left; width: 100px; height: 70px; margin-right: 20px;} 
```

我没用过，也没有 IE 支持，但是你可以试试[CSS3 Flexboxes](http://caniuse.com/#feat=flexbox)。

这些都不是漂亮的，但我不知道一个漂亮的解决方案......也许 CSS4 会拯救我们？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-12T03:00:58.443

安森先生说得对。我应该管理其他列：

固定位置的 2 个左列，固定位置和内容的 1 个右列（或者，容器自动调整大小取决于浏览器窗口，如下所示：

```
.in-content{
position:absolute;
height:auto;
color:#2d2d2d;
float:left;
left:280px;
top:33px;
bottom:auto;
right:14%;
padding:0px 10px 39px 0px;
text-align:justify;
text-decoration:none;
text-transform:none;
z-index:-33;
overflow:auto;
}
@media (min-width:27%) {.in-content{width:40%;}}
@media (max-width:40%) and (min-width:27%) {.in-content{width:27%;}} 
```

就这些了^_^谢谢。

# c - 不应该在 avr-gcc 下编译的奇怪 C 代码

> ID：13031195
> 
> 赞同：-1
> 
> 时间：2012-10-23T13:10:43.320
> 
> 标签：c

嘿，有人可以告诉我这段代码是做什么的，或者这个语法是如何在 avr-gcc 下编译的？它是从 NanoVM 源代码中获取的代码，为 avr atmega128rfa1 编译它。

// 文件本身的缓冲区在 eeprom 中

```
ifdef NVM_USE_FLASH_PROGRAM
static u08_t nvmfile[CODESIZE] PROGMEM =
#include "nvmdefault.h"
#else
static u08_t EEPROM nvmfile[CODESIZE] =
#include "nvmdefault.h"
#endif 
```

注意我没有用 -DNVM_USE_FLASH_PROGRAM 编译它

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T13:13:42.853

如果`nvmdefault.h`包含数组初始值设定项，则此代码应该可以正常编译，如下所示：

```
nvmdefault.h
{0x01, 0x02, 0x03, etc...}; 
```

至于它到底做了什么，你必须查看源代码才能确定，但​​它看起来像是在闪存或 EEPROM 存储器上分配该数组，而且，这样写它可能有充分的理由，例如数组由另一个程序或脚本生成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:19:26.063

`"nvmdefault.h"`就初始化列表的定义开始而言，我在此代码的编译中没有看到任何问题，如

```
{1, 2, 3, 4}; 
```

然后你的源将被预处理成这个（假设`NVM_USE_FLASH_PROGRAM`是定义的）：

```
static u08_t nvmfile[CODESIZE] PROGMEM =
{1, 2, 3, 4}; 
```

这是一个有效的 C 代码。

考虑这个名为`dirtyc.c`：

```
#ifndef C_IS_DIRTY
    #define C_IS_DIRTY
    #include <stdio.h>
    int main (void)
    #include "dirtyc.c"
#else
    { printf("hello dirty world!\n"); return 0; }
#endif 
```

# jquery - Grails JQuery PeriodicUpdater

> ID：13031196
> 
> 赞同：0
> 
> 时间：2012-10-23T13:10:45.163
> 
> 标签：jquery, grails

我想在 jQuery 中使用定期更新程序来定期更新聊天 div。因此，我在布局文件中包含 jQuery 库：

```
<g:javascript library="jquery" plugin="jquery"/> 
```

从页面[http://www.360innovate.co.uk/blog/2009/03/periodicalupdater-for-jquery/](http://www.360innovate.co.uk/blog/2009/03/periodicalupdater-for-jquery/)我下载了 jquery 的 periodicalupdater 插件并将其链接到我的 gsp 页面：

```
<g:javascript src="jquery.periodicalupdater.js"/> 
```

在我的页面上，我使用这个脚本来启动 periodicalUpdater：

```
<script type="text/javascript">
    $(document).ready(function() {
        $.PeriodicalUpdater({
            url : 'URL'
        }, function(data) {
            var myHtml = 'The data returned from the server was: ' + data + '';
        });
    });
</script> 
```

问题是，甚至没有调用 URL。查看浏览器控制台时出现以下错误：

```
'undefined' is not a function (evaluating '$.PeriodicalUpdater') 
```

编辑：我解决了这个问题。periodUpdater 插件刚刚在 jquery 之前加载。但现在我有另一个问题。我在我的代码中写了以下几行：

```
<g:javascript library="jquery" /><script type="text/javascript">
    $(document).ready(function() {
        $.PeriodicalUpdater({url : 'http://localhost:8080/PROJECT/comment/ajax_list/1'},
        function(data){$('#comment').empty().append(data);});
    });
</script> 
```

我想要没有本地主机的 URL，因为我也想在生产模式下加载它......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T15:20:53.757

In my layout file I have the following:

```
<script>
    contextPath = "${request.contextPath}";
</script> 
```

And then updating your code:

```
<script type="text/javascript">
    $(document).ready(function() {
        $.PeriodicalUpdater({url : contextPath + '/comment/ajax_list/1'},
        function(data){$('#comment').empty().append(data);});
    });
</script> 
```

# sql - SSRS 链接参数

> ID：13031201
> 
> 赞同：2
> 
> 时间：2012-10-23T13:11:01.497
> 
> 标签：sql, reporting-services, reportbuilder3.0

我对 SSRS 和 SQL 非常陌生，我正在 Report Builder 3.0 中创建报告。

我在创建新的空白报表、添加数据源和数据集方面没有问题。我的数据集非常基本：

```
SELECT  Employee_NO, Employee_Name
FROM    Employees 
```

我为 Employee_Name 添加了一个参数，以便用户可以选择一名员工。我还为 Employee_NO 创建了一个隐藏参数

我在报告中添加了两个框：一个用于 Employee_Name，一个用于 Employee_No。第一个框填充了来自 Employee_Name 参数的选择，但我不知何故需要用指定的用户 Employee_No 填充另一个框。我如何实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:30:04.640

它通常的工作方式是添加一个数据集，其中包含填充参数所需的查询（在本例中称为 dataset2）：

```
select Employee_NO, Employee_Name from Employees 
```

然后根据 dataset2 创建参数（右键单击报表数据选项卡上的参数项）

![在此处输入图像描述](../Images/23069ecd20d0bef7cbbda00f6a578a0a.png)

你有你的参数。

要在主查询中使用它，请使用 @ 引用它：

```
select * from your_table 
where empid=@empId 
```

只是参考它： ![在此处输入图像描述](../Images/bdfc102b73d30811cd68b304f7e272ce.png)

# jquery - Jquery ajax 调用和每个循环

> ID：13031206
> 
> 赞同：-1
> 
> 时间：2012-10-23T13:11:15.623
> 
> 标签：jquery, ajax, each

我的每个循环都不起作用，它在没有循环的情况下发送数据。这是我的代码：

```
function copyText() {
$("#ppages").each(function() {
        var form_data = {
            idstrony: $(this).attr("class"),
            strona: $(this).val(),
            is_ajax: 1
        };

        $.ajax({
            type: "POST",
            async: false,
            url: "save.php",
            data: form_data
        });
    });
    }; 
```

我做错了什么？我会很感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:23:57.450

发帖前需要对form_data进行序列化，看看[http://api.jquery.com/serialize/](http://api.jquery.com/serialize/)

# facebook-ios-sdk - 在 FBFriendPickerViewController 中获取好友数量

> ID：13031212
> 
> 赞同：1
> 
> 时间：2012-10-23T13:11:21.200
> 
> 标签：facebook-ios-sdk

我`FBFriendPickerViewController`用来显示朋友列表，我试图找到一种简单的方法来获取列表中的朋友数量。我尝试过实施该`friendPickerViewControllerDataDidChange:(FBFriendPickerViewController *)friendPicker`方法，但有时（尤其是在不同设备上进行测试时，例如 3.5 英寸 iPhone 和 4.0 英寸 iPhone）会被触发两次（绝对是一个错误）并弄乱了数字。有什么可靠的方法可以获取喜欢的朋友数量`[friendPicker numberOfFriends]`吗？

谢谢，坎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T16:02:33.990

我不太喜欢使用 tableview 来获取朋友的数量，你可以简单地通过图形调用来做到这一点，但是如果你想使用 view，一个简单的方法是这样做：

```
 int sum = 0;
    for (int x=0; x< [friendPickerController.tableView numberOfSections]; x++) {
        sum+= [friendPickerController.tableView numberOfRowsInSection:x];
    }
    NSLog(@"You have %d friends", sum); 
```

同样，这不是最好的方法，但如果这是您需要的，那就是它。您还需要确保在尝试计算行数之前已经加载了数据，否则总和将为 0

要知道数据何时加载，请创建一个 FBFriendPickerDelegate 并使用以下方法：

```
- (void)friendPickerViewControllerDataDidChange:(FBFriendPickerViewController *)friendPicker; 
```

知道何时加载数据。

[这是 Facebook 的参考资料](https://developers.facebook.com/docs/reference/ios/3.0/protocol/FBFriendPickerDelegate)

干杯！

# jquery - 用对象覆盖 jquery ui 小部件字符串选项

> ID：13031214
> 
> 赞同：1
> 
> 时间：2012-10-23T13:11:25.973
> 
> 标签：jquery, jquery-ui, jquery-widgets

我希望 jquery ui 小部件选项默认为字符串，但我希望它能够被对象覆盖。当我这样做时，我实际上以某种奇怪的方式将字符串转换为一个对象，然后用我传入的任何对象进行扩展。

```
$.widget("ui.test", {

    options: {
        anOption: "a,b,c"
    },

    _create: function() {
        console.log(this.options);
    }

});

$('div').test({
    anOption: {
        a: 'A'
    }
}); 
```

如果我跳过将选项传递给小部件，它将在 _create 方法中作为字符串接收。如果我传入一个对象，就会发生奇怪的行为。在 chromes js 控制台日志中，我得到了这个，这不是我想要的。

```
Object
anOption: Object
0: "a"
1: ","
2: "b"
3: ","
4: "c"
a: "A" 
```

我该如何解决这个问题？

jsfiddle：http: [//jsfiddle.net/MatteS75/s9wK2/](http://jsfiddle.net/MatteS75/s9wK2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:39:57.250

如果您在创建小部件后更改选项，它将用您想要的对象覆盖选项。这可以接受吗？

```
$.widget("ui.test", {

    options: {
        anOption: "a string"
    },

    _create: function() {
        console.log(this.options.anOption);
    }

});

$('div').test({});

$('div').test("option", "anOption", {
    a: "option1",
    b: "option2"
});

var anOption = $('div').test("option", "anOption");

​console.log(anOption);​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T09:12:57.390

这是最近修复的一个错误：

[http://bugs.jqueryui.com/ticket/8713](http://bugs.jqueryui.com/ticket/8713)

[https://github.com/jquery/jquery-ui/commit/9b908878ae3a9c0fbbd9958b579f223a648c5c69](https://github.com/jquery/jquery-ui/commit/9b908878ae3a9c0fbbd9958b579f223a648c5c69)

# selenium - 在 IE 中运行的 Selenium webdriver 脚本在 Firefox 中挂起

> ID：13031218
> 
> 赞同：3
> 
> 时间：2012-10-23T13:11:36.317
> 
> 标签：selenium, webdriver, selenium-webdriver

我过去使用过 selenium RC，但我是 webdriver 的新手。我的应用程序中有三个链接。通知、消息和连接。单击通知时，将显示通知下拉框。单击消息时，会显示消息下拉框，单击连接时，会显示连接下拉框。在脚本中，我单击通知链接，等待通知下拉框，然后断言通知下拉框。消息和连接的顺序相同。通知序列正常工作。在消息中，它单击消息链接，然后挂在等待消息下拉框链接上。我知道这一点，因为我在每一行之后都放了 print 命令。这是我的代码：

```
 driver.findElement(By.xpath("//a[@id='notifications-page-button']")).sendKeys("\n");
wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//div[@id='notifications-dropdown-list']//li//div[@class='message']")));
Assert.assertTrue(isElementPresent(By.xpath("//div[@id='notifications-dropdown-list']//li//div[@class='message']")), "Notifications drop box was not displayed");

wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//a[@id='messages-page-button']")));

driver.findElement(By.xpath("//a[@id='messages-page-button']")).sendKeys("\n");
wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//div[@class='sf_messages_list dropdown']//li//div[@class='message']"))); //This is the line where the script hangs. If I remove this line and the next line and continue with just the click commands, they work. But when I have this line and the next, the remaining click commands are not executed

Assert.assertTrue(isElementPresent(By.xpath("//div[@class='sf_messages_list dropdown']//li//div[@class='message']")), "Messages drop box was not displayed");

wait.until(ExpectedConditions.presenceOfElementLocated(By.id("connections-page-button"))); 
driver.findElement(By.id("connections-page-button")).click() 
```

下面是消息部分的 HTML：

```
<li class="icon mm open">
<a id="messages-page-button" class="mm" href="#">
<span class="icon"></span>
<span class="badge hidden_elem">
<strong>
<em>0</em>
</strong>
</span>
</a>
<div class="dropdown-holder">
<div class="sf_messages_list dropdown" data-eventprefix="mainmenu_messages">
<div class="tb-dropdown-header">Messages</div>
<div class="tb-dropdown-body" data-url="/messages/dropdown">
<div class="document-title" style="display: none; !important"> - Dropdown Messages</div>
<div id="messages_list_view_76345" class="message-threads-listview">
<ul>
<div class="no_items hidden_elem">
</div>
</div>
<div class="tb-dropdown-footer" style="display: block;">
</div>
<span class="shadow-hide"></span>
</div>
</li> 
```

下面是通知部分的 HTML：

```
<li class="icon mm">
<a id="notifications-page-button" class="mm" href="#">
<span class="icon"></span>
<span class="badge hidden_elem">
<strong>
<em>0</em>
</strong>
</span>
</a>
<div class="dropdown-holder">
<div id="notifications-dropdown-list" class="sf_notifications_list dropdown" data-eventprefix="mainmenu_notifications">
<div class="tb-dropdown-header">Notifications</div>
<div class="tb-dropdown-body" data-url="/notifications/dropdown"></div>
<div class="tb-dropdown-footer">
<a class="view_all" href="/notifications/view">View All Notifications</a>
</div>
</div>
<span class="shadow-hide"></span>
</div>
</li> 
```

上面的代码适用于 IE。所以看起来问题不在于它无法找到元素。我正在使用 Selenium 2.25.0。我尝试过各种版本的 FF，包括 3.6、7、11、13、15 和 16。但它们都不起作用。此外，脚本只是挂起。它甚至不会在 Eclipse 中引发错误。我曾经让我的脚本运行了大约 11 个小时，但仍然没有错误。

如果您需要更多信息来帮助我解决此问题，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T14:38:01.483

在以前版本的 Selenium Webdriver 中，我也遇到过类似的情况。我也一无所知，发生在我身上的事情。最终，更新到最新版本的 Selenium 对我很有帮助，但因为 2.25.0 是最新的，我至少会向您展示我使用的解决方法，直到更新解决它

每当我需要单击一个按钮时，什么都没有发生（至于你）。所以解决方法是，当单击按钮时，我也会向`Enter`它发送关键事件。

更加具体：

```
 WebElement buttonWhereClickingDoesNotWork = driver.findElement(By.id("messages-page-button");
buttonWhereClickingDoesNotWork.click();
buttonWhereClickingDoesNotWork.sendKeys(Keys.ENTER); 
```

是的，它的解决方法。是的，它不好看。是的，它确实帮助了我。

而且：不，我不知道这个的根本原因，因为 Selenium 的更新在我的情况下帮助了我......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T14:36:16.537

这似乎与 Facebook 登录有某种联系。您是否在窗口句柄之间正确切换？还有什么是你的隐式超时，默认设置为 30 秒，所以我不确定你的脚本是否可以运行 11 小时而不会出错。

你能试试这些吗

1）我*猜*，`className("message")`不存在，你的脚本实际上是卡在那个步骤而不是之后的步骤。其中涉及点击。

```
driver.findElement(By.id("notifications-page-button")).click();
wait.until(driver.findElement(By.id("messages-page-button")));#<<-- Changed the element to wait for

//The code works untill here. But on the next command that clicks messages link, it hangs
driver.findElement(By.id("messages-page-button")).click();
wait.until(ExpectedConditions.presenceOfElementLocated(By.className(("username")))); 
```

2）删除等待元素

```
driver.findElement(By.id("notifications-page-button")).click();
#removed this wait for element

//The code works untill here. But on the next command that clicks messages link, it hangs
driver.findElement(By.id("messages-page-button")).click();
wait.until(ExpectedConditions.presenceOfElementLocated(By.className(("username")))); 
```

**更新**

* * *

请试试这个...

```
driver.findElement(By.id("notifications-page-button")).click();
wait.until(ExpectedConditions.presenceOfElementLocated(By.className(("message"))));

//The code works untill here. But on the next command that clicks messages link, it hangs
driver.findElement(By.id("messages-page-button")).click();
wait.until(driver.findElement(By.id("connections-page-button"))); # changed it to wait for the element that you will next work with

driver.findElement(By.id("connections-page-button")).click();
wait.until(ExpectedConditions.presenceOfElementLocated(By.className(("connections-listview")))); 
```

此外，如果您提供 Web 元素的 HTML 片段，但您不确定定位器，我们可以帮助您找出答案。

# maven - 如何配置多模块 Maven + Sonar + JaCoCo 以提供合并覆盖率报告？

> ID：13031219
> 
> 赞同：155
> 
> 时间：2012-10-23T13:11:38.390
> 
> 标签：maven, code-coverage, sonarqube, jacoco

我已经在互联网上上下搜索了这个。那里有很多半答案，与 Maven 属性有关，例如,`${sonar.jacoco.reportPath}`或`org.jacoco:jacoco-maven-plugin:prepare-agent`设置`maven-surefire-plugin` `argLine`.`-javaagent`

不知何故，这些答案（无论是单独的还是组合的）都没有产生我所追求的： 覆盖率报告，如果在堆栈更高的测试中使用某个类（例如正在使用的实体），则显示该类已被覆盖由 DAO，即使它自己的模块中的测试没有完全覆盖它。

请问在某处有明确的配置来实现这一点吗？

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2013-03-20T22:24:44.443

我和你的情况一样，网上散落的一半答案很烦人，因为似乎很多人都有同样的问题，但没有人愿意完全解释他们是如何解决的。

[Sonar 文档](http://docs.codehaus.org/display/SONAR/Code+Coverage+by+Unit+Tests+for+Java+Project)引用了 [一个 GitHub 项目，](https://github.com/SonarSource/sonar-scanning-examples/tree/master/sonarqube-scanner-maven)其中包含有用的示例。我为解决这个问题所做的是将集成测试逻辑应用于常规单元测试（尽管正确的单元测试应该是特定于子模块的，但情况并非总是如此）。

在父 pom.xml 中，添加以下属性：

```
<properties>
    <!-- Sonar -->
    <sonar.java.coveragePlugin>jacoco</sonar.java.coveragePlugin>
    <sonar.dynamicAnalysis>reuseReports</sonar.dynamicAnalysis>
    <sonar.jacoco.reportPath>${project.basedir}/../target/jacoco.exec</sonar.jacoco.reportPath>
    <sonar.language>java</sonar.language>
</properties> 
```

这将使 Sonar 在同一位置（父项目中的目标文件夹）中获取所有子模块的单元测试报告。它还告诉 Sonar 重​​用手动运行的报告，而不是自己滚动。我们只需要将 jacoco-maven-plugin 放在 build/plugins 中的父 pom 中，即可为所有子模块运行：

```
<plugin>
    <groupId>org.jacoco</groupId>
    <artifactId>jacoco-maven-plugin</artifactId>
    <version>0.6.0.201210061924</version>
    <configuration>
        <destFile>${sonar.jacoco.reportPath}</destFile>
        <append>true</append>
    </configuration>
    <executions>
        <execution>
            <id>agent</id>
            <goals>
                <goal>prepare-agent</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

`destFile`将报告文件放在 Sonar 将查找它的位置，并`append`使其附加到文件而不是覆盖它。这将在同一文件中合并所有子模块的所有 JaCoCo 报告。

Sonar 将为每个子模块查看该文件，因为这就是我们在上面指出的内容，为我们提供了 Sonar 中多模块文件的组合单元测试结果。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-01-13T15:03:54.657

## 自 0.7.7 版以来的新方式

从 0.7.7 版开始，有一种创建汇总报告的新方法：

您创建一个单独的“报告”项目，该项目收集所有必要的报告（聚合器项目中的任何目标都在其模块**之前**执行，因此无法使用）。

```
aggregator pom
  |- parent pom
  |- module a
  |- module b
  |- report module 
```

根**pom**看起来是这样的（不要忘记在 modules 下添加新的报告模块）：

```
<build>
<plugins>
  <plugin>
    <groupId>org.jacoco</groupId>
    <artifactId>jacoco-maven-plugin</artifactId>
    <version>0.7.8</version>
    <executions>
      <execution>
        <id>prepare-agent</id>
        <goals>
          <goal>prepare-agent</goal>
        </goals>
      </execution>
    </executions>
  </plugin>
</plugins> 
```

每个子模块的 pom 根本不需要更改。**报告模块**中的 pom如下所示：

```
<!-- Add all sub modules as dependencies here -->
<dependencies>
  <dependency>
    <module a>
  </dependency>
  <dependency>
    <module b>
  </dependency>
 ... 
```

```
 <build>
    <plugins>
      <plugin>
        <groupId>org.jacoco</groupId>
        <artifactId>jacoco-maven-plugin</artifactId>
        <version>0.7.8</version>
        <executions>
          <execution>
            <id>report-aggregate</id>
            <phase>verify</phase>
            <goals>
              <goal>report-aggregate</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build> 
```

一个完整的例子可以在[这里](https://github.com/jacoco/jacoco/blob/master/jacoco-maven-plugin.test/it/it-report-aggregate/report/pom.xml)找到。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2014-05-23T13:42:00.023

# 常问问题

自从那次我对 jacoco 发疯以来，我脑海中浮现的问题。

## 我的应用程序服务器（jBoss、Glassfish..）位于伊拉克、叙利亚等等。在其上运行集成测试时是否可以获得多模块覆盖？Jenkins 和 Sonar 也在不同的服务器上。

是的。您必须使用在 mode 下运行的[jacoco 代理](http://www.eclemma.org/jacoco/trunk/doc/agent.html)`output=tcpserver`，jacoco ant lib。基本上是两个`jar`s。这会给你99%的成功。

## jacoco 代理是如何工作的？

你追加一个字符串

```
-javaagent:[your_path]/jacocoagent.jar=destfile=/jacoco.exec,output=tcpserver,address=* 
```

到您的应用程序服务器 JAVA_OPTS 并重新启动它。在此字符串中，只需`[your_path]`将其替换为 jacocoagent.jar 的路径，并将其存储（存储！）在运行应用程序服务器的 VM 上。自从您启动应用服务器后，所有部署的应用程序都将被动态监控，并且它们的活动（即代码使用）将准备好通过 tcl 请求以 jacocos .exec 格式获取。

## 我可以重置 jacoco 代理以仅从我的测试开始时开始收集执行数据吗？

是的，为此，您需要位于 jenkins 工作区中的 jacocoant.jar 和 ant 构建脚本。

## 所以基本上我从 http://www.eclemma.org/jacoco/ 需要的是 jacocoant.jar 位于我的 jenkins 工作区中，而 jacocoagent.jar 位于我的应用服务器 VM 上？

这是正确的。

## 我不想用ant，我听说jacoco maven插件也可以做所有的事情。

不对，jacoco maven 插件可以收集单元测试数据和一些集成测试数据（请参阅[Arquillian Jacoco](http://arquillian.org/modules/jacoco-extension/)），但是如果您有例如放心的测试作为 jenkins 中的单独构建，并且想要显示多模块覆盖率，我可以'看不到 maven 插件如何帮助你。

## jacoco 代理究竟产生了什么？

只有覆盖数据`.exec`格式。然后声纳可以读取它。

## jacoco 是否需要知道我的 java 类所在的位置？

不，声纳可以，但 jacoco 不行。当您`mvn sonar:sonar`进行课程路径时，就会发挥作用。

## 那么蚂蚁脚本呢？

它必须呈现在您的詹金斯工作区中。我的蚂蚁脚本，我称之为`jacoco.xml`：

```
<project name="Jacoco library to collect code coverage remotely" xmlns:jacoco="antlib:org.jacoco.ant">
    <property name="jacoco.port" value="6300"/>
    <property name="jacocoReportFile" location="${workspace}/it-jacoco.exec"/>

    <taskdef uri="antlib:org.jacoco.ant" resource="org/jacoco/ant/antlib.xml">
        <classpath path="${workspace}/tools/jacoco/jacocoant.jar"/>
    </taskdef>

    <target name="jacocoReport">
            <jacoco:dump address="${jacoco.host}" port="${jacoco.port}" dump="true" reset="true" destfile="${jacocoReportFile}" append="false"/>
    </target>

    <target name="jacocoReset">
            <jacoco:dump address="${jacoco.host}" port="${jacoco.port}" reset="true" destfile="${jacocoReportFile}" append="false"/>
        <delete file="${jacocoReportFile}"/>
    </target>
</project> 
```

调用此脚本时应传递的两个强制性参数 `-Dworkspace=$WORKSPACE` 使用它来指向您的詹金斯工作区和`-Djacoco.host=yourappserver.com`主机`http://`

还要注意我把我`jacocoant.jar`放到 ${workspace}/tools/jacoco/jacocoant.jar

## 接下来我该怎么办？

您是否使用 jacocoagent.jar 启动了您的应用服务器？

您是否将 ant 脚本和 jacocoant.jar 放入您的 jenkins 工作区？

如果是，最后一步是配置 jenkins 构建。这是策略：

1.  调用 ant 目标`jacocoReset`以重置所有以前收集的数据。
2.  运行你的测试
3.  调用 ant 目标`jacocoReport`获取报告

如果一切正常，您将`it-jacoco.exec`在构建工作区中看到。

看截图，我也`ant`安装在我的工作区的`$WORKSPACE/tools/ant`dir 中，但你可以使用安装在你的 jenkins 中的一个。

![在此处输入图像描述](../Images/ab4bb93a460ea7b3be79c4254af20393.png)

## 如何在声纳中推送此报告？

Maven`sonar:sonar`将完成这项工作（不要忘记配置它），将其指向 main pom.xml，以便它将运行所有模块。使用`sonar.jacoco.itReportPath=$WORKSPACE/it-jacoco.exec`参数告诉声纳您的集成测试报告所在的位置。每次它分析新的模块类时，都会在`it-jacoco.exec`.

## 我的 `target` 目录中已经有 jacoco.exec，`mvn sonar:sonar` 忽略/删除它

默认情况下`mvn sonar:sonar`会`clean`删除您的目标目录，使用`sonar.dynamicAnalysis=reuseReports`它来避免它。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2020-03-11T15:17:01.123

我为新的 Sonar 版本找到了另一个解决方案，其中 JaCoCo 的二进制报告格式 (*.exec) 已被弃用，首选格式是 XML（SonarJava 5.12 及更高版本）。该解决方案非常简单，类似于以前的解决方案，在此主题的父目录中报告 *.exec 报告：[https](https://stackoverflow.com/a/15535970/4448263) ://stackoverflow.com/a/15535970/4448263 。

假设我们的项目结构是：

```
moduleC - aggregate project's pom
  |- moduleA - some classes without tests
  |- moduleB - some classes depending from moduleA and tests for classes in both modules: moduleA and moduleB 
```

您需要在聚合项目的 pom 中进行以下 maven 构建插件配置：

```
<plugin>
    <groupId>org.jacoco</groupId>
    <artifactId>jacoco-maven-plugin</artifactId>
    <version>0.8.5</version>
    <executions>
        <execution>
            <id>prepare-and-report</id>
            <goals>
                <goal>prepare-agent</goal>
                <goal>report</goal>
            </goals>
        </execution>
        <execution>
            <id>report-aggregate</id>
            <phase>verify</phase>
            <goals>
                <goal>report-aggregate</goal>
            </goals>
            <configuration>
                <outputDirectory>${project.basedir}/../target/site/jacoco-aggregate</outputDirectory>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

然后用maven构建项目：

```
mvn clean verify 
```

对于声纳，您应该在管理 GUI 中设置属性：

```
sonar.coverage.jacoco.xmlReportPaths=target/site/jacoco/jacoco.xml,../target/site/jacoco-aggregate/jacoco.xml 
```

或使用命令行：

```
mvn sonar:sonar -Dsonar.coverage.jacoco.xmlReportPaths=target/site/jacoco/jacoco.xml,../target/site/jacoco-aggregate/jacoco.xml 
```

**描述**

这将为默认目录中的每个模块创建二进制报告：`target/jacoco.exec`. 然后为默认目录中的每个模块创建 XML 报告：`target/site/jacoco/jacoco.xml`. 然后为自定义目录中的每个模块创建一个聚合报告，该目录`${project.basedir}/../target/site/jacoco-aggregate/`相对于每个模块的父目录。对于 moduleA 和 moduleB 这将是 common path `moduleC/target/site/jacoco-aggregate/`。

由于 moduleB 依赖于 moduleA，moduleB 将最后构建，其报告将用作 Sonar 中模块 A 和 B 的聚合覆盖率报告。

除了聚合报告之外，我们还需要一个普通的模块报告，因为 JaCoCo 聚合报告仅包含依赖项的覆盖率数据。

这两种类型的报告共同为 Sonar 提供了全覆盖数据。

有一点限制：您应该能够在项目的父目录中编写报告（应该有权限）。或者，您可以`jacoco.skip=true`在根项目的 pom.xml (moduleC) 和`jacoco.skip=false`带有类和测试的模块（moduleA 和 moduleB）中设置属性。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-06-17T00:04:39.893

I'll post my solution as it it subtly different from others and also took me a solid day to get right, with the assistance of the existing answers.

For a multi-module Maven project:

```
ROOT
|--WAR
|--LIB-1
|--LIB-2
|--TEST 
```

Where the `WAR` project is the main web app, `LIB` 1 and 2 are additional modules the `WAR` depends on and `TEST` is where the integration tests live. `TEST` spins up an embedded Tomcat instance (not via Tomcat plugin) and runs `WAR` project and tests them via a set of JUnit tests. The `WAR` and `LIB` projects both have their own unit tests.

The result of all this is the integration and unit test coverage being separated and able to be distinguished in SonarQube.

`ROOT pom.xml`

```
<!-- Sonar properties-->
<sonar.jacoco.itReportPath>${project.basedir}/../target/jacoco-it.exec</sonar.jacoco.itReportPath>
<sonar.jacoco.reportPath>${project.basedir}/../target/jacoco.exec</sonar.jacoco.reportPath>
<sonar.language>java</sonar.language>
<sonar.java.coveragePlugin>jacoco</sonar.java.coveragePlugin>

<!-- build/plugins (not build/pluginManagement/plugins!) -->
<plugin>
    <groupId>org.jacoco</groupId>
    <artifactId>jacoco-maven-plugin</artifactId>
    <version>0.7.6.201602180812</version>
    <executions>
        <execution>
            <id>agent-for-ut</id>
            <goals>
                <goal>prepare-agent</goal>
            </goals>
            <configuration>
                <append>true</append>
                <destFile>${sonar.jacoco.reportPath}</destFile>
            </configuration>
        </execution>
        <execution>
            <id>agent-for-it</id>
            <goals>
                <goal>prepare-agent-integration</goal>
            </goals>
            <configuration>
                <append>true</append>
                <destFile>${sonar.jacoco.itReportPath}</destFile>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

`WAR`, `LIB` and `TEST` `pom.xml` will inherit the the JaCoCo plugins execution.

`TEST pom.xml`

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-failsafe-plugin</artifactId>
    <version>2.19.1</version>
    <executions>
        <execution>
            <goals>
                <goal>integration-test</goal>
                <goal>verify</goal>
            </goals>
            <configuration>
                <skipTests>${skip.tests}</skipTests>
                <argLine>${argLine} -Duser.timezone=UTC -Xms256m -Xmx256m</argLine>
                <includes>
                    <includes>**/*Test*</includes>
                </includes>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

I also found [Petri Kainulainens blog post 'Creating Code Coverage Reports for Unit and Integration Tests With the JaCoCo Maven Plugin'](http://www.petrikainulainen.net/programming/maven/creating-code-coverage-reports-for-unit-and-integration-tests-with-the-jacoco-maven-plugin/) to be valuable for the JaCoCo setup side of things.

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-02-02T16:33:54.150

有一种方法可以做到这一点。神奇的是创建一个组合的 jacoco.exec 文件。使用 maven 3.3.1 有一个简单的方法来获得它。这是我的个人资料：

```
<profile>
    <id>runSonar</id>
    <activation>
        <property>
            <name>runSonar</name>
            <value>true</value>
        </property>
    </activation>
    <properties>
        <sonar.language>java</sonar.language>
        <sonar.host.url>http://sonar.url</sonar.host.url>
        <sonar.login>tokenX</sonar.login>
        <sonar.jacoco.reportMissing.force.zero>true</sonar.jacoco.reportMissing.force.zero>
        <sonar.jacoco.reportPath>${jacoco.destFile}</sonar.jacoco.reportPath>
        <jacoco.destFile>${maven.multiModuleProjectDirectory}/target/jacoco_analysis/jacoco.exec</jacoco.destFile>
    </properties>
    <build>
        <plugins>
            <plugin>
                <groupId>org.jacoco</groupId>
                <artifactId>jacoco-maven-plugin</artifactId>
                <executions>
                    <execution>
                        <id>default-prepare-agent</id>
                        <goals>
                            <goal>prepare-agent</goal>
                        </goals>
                        <configuration>
                            <append>true</append>
                            <destFile>${jacoco.destFile}</destFile>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.sonarsource.scanner.maven</groupId>
                    <artifactId>sonar-maven-plugin</artifactId>
                    <version>3.2</version>
                </plugin>
                <plugin>
                    <groupId>org.jacoco</groupId>
                    <artifactId>jacoco-maven-plugin</artifactId>
                    <version>0.7.8</version>
                </plugin>
            </plugins>
        </pluginManagement>
    </build>
</profile> 
```

如果您将此配置文件添加到您的父 pom 并打电话给您，`mvn clean install sonar:sonar -DrunSonar`您将获得完整的报道。

这里的魔力是`maven.multiModuleProjectDirectory`。此文件夹始终是您开始构建 maven 的文件夹。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-05-03T06:42:46.250

我在父级 pom 中使用的配置，其中我有单独的单元和集成测试阶段。

我在父 POM 属性中配置以下属性

```
 <maven.surefire.report.plugin>2.19.1</maven.surefire.report.plugin>
    <jacoco.plugin.version>0.7.6.201602180812</jacoco.plugin.version>
    <jacoco.check.lineRatio>0.52</jacoco.check.lineRatio>
    <jacoco.check.branchRatio>0.40</jacoco.check.branchRatio>
    <jacoco.check.complexityMax>15</jacoco.check.complexityMax>
    <jacoco.skip>false</jacoco.skip>
    <jacoco.excludePattern/>
    <jacoco.destfile>${project.basedir}/../target/coverage-reports/jacoco.exec</jacoco.destfile>

    <sonar.language>java</sonar.language>
    <sonar.exclusions>**/generated-sources/**/*</sonar.exclusions>
    <sonar.core.codeCoveragePlugin>jacoco</sonar.core.codeCoveragePlugin>
    <sonar.coverage.exclusions>${jacoco.excludePattern}</sonar.coverage.exclusions>
    <sonar.dynamicAnalysis>reuseReports</sonar.dynamicAnalysis>
    <sonar.jacoco.reportPath>${project.basedir}/../target/coverage-reports</sonar.jacoco.reportPath>

    <skip.surefire.tests>${skipTests}</skip.surefire.tests>
    <skip.failsafe.tests>${skipTests}</skip.failsafe.tests> 
```

我将插件定义放在插件管理下。

请注意，我为surefire (surefireArgLine) 和failsafe (failsafeArgLine) 参数定义了一个属性，以允许jacoco 配置javaagent 以在每个测试中运行。

在插件管理下

```
 <build>
     <pluginManagment>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.1</version>
                <configuration>
                    <fork>true</fork>
                    <meminitial>1024m</meminitial>
                    <maxmem>1024m</maxmem>
                    <compilerArgument>-g</compilerArgument>
                    <source>${maven.compiler.source}</source>
                    <target>${maven.compiler.target}</target>
                    <encoding>${project.build.sourceEncoding}</encoding>
                </configuration>
            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <version>2.19.1</version>
                <configuration>
                    <forkCount>4</forkCount>
                    <reuseForks>false</reuseForks>
                    <argLine>-Xmx2048m ${surefireArgLine}</argLine>
                    <includes>
                        <include>**/*Test.java</include>
                    </includes>
                    <excludes>
                        <exclude>**/*IT.java</exclude>
                    </excludes>
                    <skip>${skip.surefire.tests}</skip>
                </configuration>
            </plugin>
            <plugin>
                <!-- For integration test separation -->
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-failsafe-plugin</artifactId>
                <version>2.19.1</version>
                <dependencies>
                    <dependency>
                        <groupId>org.apache.maven.surefire</groupId>
                        <artifactId>surefire-junit47</artifactId>
                        <version>2.19.1</version>
                    </dependency>
                </dependencies>
                <configuration>
                    <forkCount>4</forkCount>
                    <reuseForks>false</reuseForks>
                    <argLine>${failsafeArgLine}</argLine>
                    <includes>
                        <include>**/*IT.java</include>
                    </includes>
                    <skip>${skip.failsafe.tests}</skip>
                </configuration>
                <executions>
                    <execution>
                        <id>integration-test</id>
                        <goals>
                            <goal>integration-test</goal>
                        </goals>
                    </execution>
                    <execution>
                        <id>verify</id>
                        <goals>
                            <goal>verify</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>

            <plugin>
                <!-- Code Coverage -->
                <groupId>org.jacoco</groupId>
                <artifactId>jacoco-maven-plugin</artifactId>
                <version>${jacoco.plugin.version}</version>
                <configuration>
                    <haltOnFailure>true</haltOnFailure>
                    <excludes>
                        <exclude>**/*.mar</exclude>
                        <exclude>${jacoco.excludePattern}</exclude>
                    </excludes>
                    <rules>
                        <rule>
                            <element>BUNDLE</element>
                            <limits>
                                <limit>
                                    <counter>LINE</counter>
                                    <value>COVEREDRATIO</value>
                                    <minimum>${jacoco.check.lineRatio}</minimum>
                                </limit>
                                <limit>
                                    <counter>BRANCH</counter>
                                    <value>COVEREDRATIO</value>
                                    <minimum>${jacoco.check.branchRatio}</minimum>
                                </limit>
                            </limits>
                        </rule>
                        <rule>
                            <element>METHOD</element>
                            <limits>
                                <limit>
                                    <counter>COMPLEXITY</counter>
                                    <value>TOTALCOUNT</value>
                                    <maximum>${jacoco.check.complexityMax}</maximum>
                                </limit>
                            </limits>
                        </rule>
                    </rules>
                </configuration>
                <executions>
                    <execution>
                        <id>pre-unit-test</id>
                        <goals>
                            <goal>prepare-agent</goal>
                        </goals>
                        <configuration>
                            <destFile>${jacoco.destfile}</destFile>
                            <append>true</append>
                            <propertyName>surefireArgLine</propertyName>
                        </configuration>
                    </execution>
                    <execution>
                        <id>post-unit-test</id>
                        <phase>test</phase>
                        <goals>
                            <goal>report</goal>
                        </goals>
                        <configuration>
                            <dataFile>${jacoco.destfile}</dataFile>
                            <outputDirectory>${sonar.jacoco.reportPath}</outputDirectory>
                            <skip>${skip.surefire.tests}</skip>
                        </configuration>
                    </execution>
                    <execution>
                        <id>pre-integration-test</id>
                        <phase>pre-integration-test</phase>
                        <goals>
                            <goal>prepare-agent-integration</goal>
                        </goals>
                        <configuration>
                            <destFile>${jacoco.destfile}</destFile>
                            <append>true</append>
                            <propertyName>failsafeArgLine</propertyName>
                        </configuration>
                    </execution>
                    <execution>
                        <id>post-integration-test</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>report-integration</goal>
                        </goals>
                        <configuration>
                            <dataFile>${jacoco.destfile}</dataFile>
                            <outputDirectory>${sonar.jacoco.reportPath}</outputDirectory>
                            <skip>${skip.failsafe.tests}</skip>
                        </configuration>
                    </execution>
                    <!-- Disabled until such time as code quality stops this tripping
                    <execution>
                        <id>default-check</id>
                        <goals>
                            <goal>check</goal>
                        </goals>
                        <configuration>
                            <dataFile>${jacoco.destfile}</dataFile>
                        </configuration>
                    </execution>
                    -->
                </executions>
            </plugin>
            ... 
```

在构建部分

```
 <build>
     <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
        </plugin>

        <plugin>
            <!-- for unit test execution -->
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
        </plugin>
        <plugin>
            <!-- For integration test separation -->
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-failsafe-plugin</artifactId>
        </plugin>
        <plugin>
            <!-- For code coverage -->
            <groupId>org.jacoco</groupId>
            <artifactId>jacoco-maven-plugin</artifactId>
        </plugin>
        .... 
```

在报告部分

```
 <reporting>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-report-plugin</artifactId>
            <version>${maven.surefire.report.plugin}</version>
            <configuration>
                <showSuccess>false</showSuccess>
                <alwaysGenerateFailsafeReport>true</alwaysGenerateFailsafeReport>
                <alwaysGenerateSurefireReport>true</alwaysGenerateSurefireReport>
                <aggregate>true</aggregate>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.jacoco</groupId>
            <artifactId>jacoco-maven-plugin</artifactId>
            <version>${jacoco.plugin.version}</version>
            <configuration>
                <excludes>
                    <exclude>**/*.mar</exclude>
                    <exclude>${jacoco.excludePattern}</exclude>
                </excludes>
            </configuration>
        </plugin>
     </plugins>
  </reporting> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-11-28T07:13:35.430

作为 Sonars `sonar.jacoco.reportPath`，`sonar.jacoco.itReportPath`并且`sonar.jacoco.reportPaths`都已被[弃用](https://jira.sonarsource.com/projects/MMF/issues/MMF-1651?filter=allissues)，您现在应该使用`sonar.coverage.jacoco.xmlReportPaths`。如果您想使用 Sonar 和 Jacoco 配置多模块 maven 项目，这也会产生一些影响。

正如@Lonzak[指出的那样](https://stackoverflow.com/a/41637539/2049986)，从Sonar 0.7.7 开始，您可以使用Sonars 报告聚合目标。只需将以下依赖项放入您的父 pom 中：

```
<plugin>
    <groupId>org.jacoco</groupId>
    <artifactId>jacoco-maven-plugin</artifactId>
    <version>0.8.5</version>
    <executions>
        <execution>
            <id>report</id>
            <goals>
                <goal>report-aggregate</goal>
            </goals>
            <phase>verify</phase>
        </execution>
    </executions>
</plugin> 
```

由于当前版本的 jacoco-maven-plugin 与 xml-reports 兼容，这将为它自己的目标文件夹中的*每个*模块创建一个包含文件的 site/jacoco-aggregate 文件夹`jacoco.xml`。

要让 Sonar 组合所有模块，请使用以下命令：

```
mvn -Dsonar.coverage.jacoco.xmlReportPaths=full-path-to-module1/target/site/jacoco-aggregate/jacoco.xml,module2...,module3... clean verify sonar:sonar 
```

* * *

为了使我的回答简短而准确，我没有提到`maven-surefire-plugin`和 `maven-failsafe-plugin`依赖项。您可以在没有任何其他配置的情况下添加它们：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <version>2.22.2</version>
</plugin>
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-failsafe-plugin</artifactId>
    <version>2.22.2</version>
    <executions>
        <execution>
        <id>integration-test</id>
            <goals>
                <goal>integration-test</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-03-28T10:53:55.007

```
 <sonar.language>java</sonar.language>
    <sonar.java.coveragePlugin>jacoco</sonar.java.coveragePlugin>
    <sonar.jacoco.reportPath>${user.dir}/target/jacoco.exec</sonar.jacoco.reportPath>
    <sonar.jacoco.itReportPath>${user.dir}/target/jacoco-it.exec</sonar.jacoco.itReportPath>
    <sonar.exclusions>
        file:**/target/generated-sources/**,
        file:**/target/generated-test-sources/**,
        file:**/target/test-classes/**,
        file:**/model/*.java,
        file:**/*Config.java,
        file:**/*App.java
    </sonar.exclusions> 
```

* * *

```
 <plugin>
                <groupId>org.jacoco</groupId>
                <artifactId>jacoco-maven-plugin</artifactId>
                <version>0.7.9</version>
                <executions>
                    <execution>
                        <id>default-prepare-agent</id>
                        <goals>
                            <goal>prepare-agent</goal>
                        </goals>
                        <configuration>
                            <destFile>${sonar.jacoco.reportPath}</destFile>
                            <append>true</append>
                            <propertyName>surefire.argLine</propertyName>
                        </configuration>
                    </execution>
                    <execution>
                        <id>default-prepare-agent-integration</id>
                        <goals>
                            <goal>prepare-agent-integration</goal>
                        </goals>
                        <configuration>
                            <destFile>${sonar.jacoco.itReportPath}</destFile>
                            <append>true</append>
                            <propertyName>failsafe.argLine</propertyName>
                        </configuration>
                    </execution>
                    <execution>
                        <id>default-report</id>
                        <goals>
                            <goal>report</goal>
                        </goals>
                    </execution>
                    <execution>
                        <id>default-report-integration</id>
                        <goals>
                            <goal>report-integration</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-02-20T12:51:49.850

要进行单元测试和集成测试，您可以使用 maven-surefire-plugin 和 maven-failsafe-plugin 并限制包含/排除。我在与 sonar/jacoco 联系时正在玩 CDI，所以我最终参与了这个项目：

[https://github.com/FibreFoX/cdi-sessionscoped-login/](https://github.com/FibreFoX/cdi-sessionscoped-login/)

也许它对你有一点帮助。在我的 pom.xml 中，我通过在指定测试插件的配置部分中设置 argLine 选项来隐式使用“-javaagent”。在 MAVEN 项目中明确使用 ANT 是我不会尝试的，对我来说它混合了两个世界。

我只有一个单模块 maven 项目，但也许它可以帮助你调整你的工作。

注意：也许不是所有的 maven-plugins 都是最新的，也许一些问题在以后的版本中得到了修复

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-10-23T19:39:45.510

您可以在 maven 上调用一个名为**[merge](http://www.eclemma.org/jacoco/trunk/doc/ant.html)**的 ant 任务，将所有覆盖文件 (*.exec) 放在同一个文件中。

如果您正在运行单元测试，请使用阶段**prepare-package**，如果您运行集成测试，请使用**post-integration-test**。

[这个站点](http://www.lordofthejars.com/2012/07/jacoco-in-maven-multi-module-projects.html)有一个如何在 maven 项目中调用 jacoco ant 任务的示例

您可以在声纳上使用此合并文件。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-10-04T13:02:26.830

这个示例对我来说效果很好：

```
<plugin>
            <groupId>org.jacoco</groupId>
            <artifactId>jacoco-maven-plugin</artifactId>
            <version>0.8.2</version>
            <executions>
                <execution>
                    <id>pre-unit-test</id>
                    <goals>
                        <goal>prepare-agent</goal>
                    </goals>
                    <configuration>
                        <destFile>${project.build.directory}/coverage-reports/jacoco-ut.exec</destFile>
                        <propertyName>surefireArgLine</propertyName>
                    </configuration>
                </execution>
                <execution>
                    <id>pre-integration-test</id>
                    <goals>
                        <goal>prepare-agent-integration</goal>
                    </goals>
                    <configuration>
                        <destFile>${project.build.directory}/coverage-reports/jacoco-it.exec</destFile>
                        <!--<excludes>
                            <exclude>com.asimio.demo.rest</exclude>
                            <exclude>com.asimio.demo.service</exclude>
                        </excludes>-->
                        <propertyName>testArgLine</propertyName>
                    </configuration>
                </execution>
                <execution>
                    <id>post-integration-test</id>
                    <phase>post-integration-test</phase>
                    <goals>
                        <goal>report</goal>
                    </goals>
                    <configuration>
                        <dataFile>${project.build.directory}/coverage-reports/jacoco-it.exec</dataFile>
                        <outputDirectory>${project.reporting.outputDirectory}/jacoco-it</outputDirectory>
                    </configuration>
                </execution>
                <execution>
                    <id>post-unit-test</id>
                    <phase>prepare-package</phase>
                    <goals>
                        <goal>report</goal>
                    </goals>
                    <configuration>
                        <dataFile>${project.build.directory}/coverage-reports/jacoco-ut.exec</dataFile>
                        <outputDirectory>${project.reporting.outputDirectory}/jacoco-ut</outputDirectory>
                    </configuration>
                </execution>
                <execution>
                    <id>merge-results</id>
                    <phase>verify</phase>
                    <goals>
                        <goal>merge</goal>
                    </goals>
                    <configuration>
                        <fileSets>
                            <fileSet>
                                <directory>${project.build.directory}/coverage-reports</directory>
                                <includes>
                                    <include>*.exec</include>
                                </includes>
                            </fileSet>
                        </fileSets>
                        <destFile>${project.build.directory}/coverage-reports/aggregate.exec</destFile>
                    </configuration>
                </execution>
                <execution>
                    <id>post-merge-report</id>
                    <phase>verify</phase>
                    <goals>
                        <goal>report</goal>
                    </goals>
                    <configuration>
                        <dataFile>${project.build.directory}/coverage-reports/aggregate.exec</dataFile>
                        <outputDirectory>${project.reporting.outputDirectory}/jacoco-aggregate</outputDirectory>
                    </configuration>
                </execution>
            </executions>
        </plugin>

        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.18.1</version>
            <configuration>
                <argLine>${surefireArgLine}</argLine>
                <!--<skipTests>${skip.unit.tests}</skipTests>-->
                <includes>
                    <include>**/*Test.java</include>
                    <!--<include>**/*MT.java</include>
                    <include>**/*Test.java</include>-->
                </includes>
            <!--    <skipTests>${skipUTMTs}</skipTests>-->
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-failsafe-plugin</artifactId>
            <version>2.12.4</version>
            <configuration>
                <!--<skipTests>${skipTests}</skipTests>
                <skipITs>${skipITs}</skipITs>-->
                <argLine>${testArgLine}</argLine>
                <includes>
                    <include>**/*IT.java</include>
                </includes>
                <!--<excludes>
                    <exclude>**/*UT*.java</exclude>
                </excludes>-->
            </configuration>
            <executions>
                <execution>
                    <goals>
                        <goal>integration-test</goal>
                        <goal>verify</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-03-25T17:37:07.117

如[Jacoco Wiki](https://github.com/jacoco/jacoco/wiki/MavenMultiModule)中所述，您还可以生成一个新的报告模块：

> 策略：具有依赖关系的模块：聚合器项目的问题可以通过额外的“报告”模块来解决。在多模块 Maven 项目中，定义了一个单独的模块，该模块不提供实际内容，但会创建一个组合的覆盖率报告。它定义了对应该包含在组合报告中的所有模块的依赖关系。“报告”模块将在其依赖项之后构建，并且可以访问它所依赖的项目中的 exec 文件以及类和源文件。这种策略似乎最适合当前的 Maven 架构。从用户的角度来看，有人可能会争辩说这样一个单独的模块会使构建定义膨胀。或者，单独的模块不能有任何可以使用 exec 或 class 文件的子模块。然而，

如果您的模块化比具有一些子模块的父级更复杂，这将特别有用。

您的报告 pom 可能类似于：

```
 <dependencies>
    <dependency>
        <groupId>org.sonarqube</groupId>
        <artifactId>module1</artifactId>
        <version>1.0-SNAPSHOT</version>
    </dependency>
    <dependency>
        <groupId>org.sonarqube</groupId>
        <artifactId>module2</artifactId>
        <version>1.0-SNAPSHOT</version>
    </dependency>
</dependencies>

<build>
    <plugins>
        <plugin>
            <groupId>org.jacoco</groupId>
            <artifactId>jacoco-maven-plugin</artifactId>
            <executions>
                <execution>
                    <id>report</id>
                    <goals>
                        <goal>report-aggregate</goal>
                    </goals>
                    <phase>verify</phase>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build> 
```

# javascript - 画布游戏错误

> ID：13031222
> 
> 赞同：0
> 
> 时间：2012-10-23T13:12:05.847
> 
> 标签：javascript, html5-canvas

我正在尝试创建一个简单的游戏循环并尝试在 JS 中使用 OOP 范例。这是我的代码：

**HTML**

```
<body onload="Game.OnLoad('gameField')" onkeydown="Game.KeyDown(event)">
    <p id="info">1</p>
    <p id="info2">2</p>
    <canvas id="gameField" 
            width="896px" 
            height="717px" 
            class="game-field" 
            style="border: 4px solid aqua"
            onclick="Game.MouseClick(event)"></canvas>
</body> 
```

**JavaScript**

```
// class Timer
// version: 1
// only tick() functionality available
// right now
function Timer() {
    var date = new Date();

    var prevTick = 0;
    var currTick = 0;
    // update timer with tick
    this.tick = function() {
        prevTick = currTick;
        currTick = date.getTime();
    }
    // get time between two ticks
    this.getLastTickInterval = function() {
        return currTick - prevTick;
    }
}

// global object Game
// which handles game loop
// and provide interfaces for     
var Game = new function() {
    // variables:
    this.canvas = 0;
    var gameLoopId = 0;
    this.timer = new Timer();
    // events:
    this.KeyDown = function(e) {}

    // game loop:    
    this.Run = function() {
        this.timer.tick();
        this.Update(this.timer.getLastTickInterval());
        this.Draw();
    }
    this.Update = function(dt) {
        document.getElementById("info").innerHTML = dt;
    }
    this.Draw = function() {}
    this.StopGameLoop = function() {
        clearInterval(gameLoopId);
    }
    this.OnLoad = function(canvasName) {
        this.canvas = document.getElementById(canvasName);
        this.timer.tick();

        // start game loop
        setInterval(this.Run, 1000);
    }
}​ 
```

（[小提琴](http://jsfiddle.net/v8263/4/)）

我正在尝试使 Game 类全球化。其他类必须使用`new`.

类 Game 和 Timer 放置在名为 Game.js 和 Timer.js 的不同文件中。当我在 Chrome 中运行此代码时，我在 DevTools 中遇到错误：行`"Uncaught TypeError: Cannot call method 'tick' of undefined"`中的`Game.Run`函数`this.timer.tick();`

所以我想知道，我的代码有什么问题？谢谢您的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:18:19.403

你的问题在于上下文。当您调用滴答声时`this`，是窗口，而不是游戏。例如，您可以通过设置：

```
var self = this;        
this.Run = function() {
    self.timer.tick();
    self.Update(self.timer.getLastTickInterval());
    self.Draw();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-15T09:13:05.633

您的代码中需要考虑的几件事：

关于您的问题，setInterval 或 setTimeout 之类的方法会使上下文松散。最简单的解决方案是将上下文绑定到回调：

```
setInterval(this.Run.bind(this), 1000); 
```

其次，避免在对象函数中添加私有方法。在这种情况下，每个 Game 实例都会有自己的一组函数（内存泄漏）。更喜欢使用原型：

```
function Game () {
    this.canvas = null;
}
Game.prototype = {
    init: function() {}
    render: function () {}
}; 
```

最后，我看到你每秒钟重画一次，这没关系。但是如果你想要 60fps，你可以使用[requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame)来绘制定向循环。

ps：只是为了非常挑剔，函数的名称应该是camelCase，所以以小写开头。

# java - 在 java 正则表达式中处理美元字符的最佳方法

> ID：13031226
> 
> 赞同：3
> 
> 时间：2012-10-23T13:12:16.310
> 
> 标签：java, regex

我有以下类`PlaceHolderConverter`用于将字符串解析`"my {} are beautiful"`为带有填充变量的字符串。

例如`new PlaceHolderConverter("\\{\\}").format("my {} are beautiful", "flowers")`将返回字符串`"my flowers are beautiful"`。

```
package something;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class PlaceHolderConverter
{
    public Pattern lookForVar;

    public PlaceHolderConverter( String placeHolder )
    {
        this.lookForVar = Pattern.compile( placeHolder );
    }

    public String format( String text, String... args )
    {
        if ( args == null || args.length == 0 )
        {
            return text;
        }
        StringBuffer stringBuffer = new StringBuffer();
        Matcher matcher = lookForVar.matcher( text );
        short varCount = 0;
        while ( matcher.find() )
        {
            matcher.appendReplacement( stringBuffer, args[varCount++] );
        }
        matcher.appendTail( stringBuffer );
        return stringBuffer.toString();
    }
} 
```

正如您在以下测试中看到的，我对特殊字符美元有疑问，因为它是 java 正则表达式的特殊字符。我试图解决这个问题，`Pattern.quote()`但没有结果。

```
package something;

import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;

import java.util.regex.Pattern;

public class PlaceHolderConverterTest
{
    private PlaceHolderConverter placeHolderConverter;

    @Before
    public void before()
    {
        placeHolderConverter = new PlaceHolderConverter( "\\{\\}" );
    }

    @Test // SUCCESS
    public void whenStringArgsThenReplace()
    {
        String result = placeHolderConverter.format( "My {} are beautifull", "flowers" );
        Assert.assertEquals( "My flowers are beautifull", result );
    }

    @Test // FAIL IllegalArgumentException illegal group reference while calling appendReplacement
    public void assertEscapeDollar()
    {
        String result = placeHolderConverter.format( "My {} are beautiful", "flow$ers" );
        Assert.assertEquals( "My flow$ers are beautiful", result );
    }

    @Test // FAIL IllegalArgumentException illegal group reference while calling appendReplacement
    public void assertEscapeDollarWithQuote()
    {
        String result = placeHolderConverter.format( "My {} are beautiful", Pattern.quote("flow$ers") );
        Assert.assertEquals( "My flow$ers are beautiful", result );
    }

} 
```

我还尝试在正则表达式中使用美元之前手动转义美元，`.replaceAll("\\$", "\\\\$")`但似乎`replaceAll`不喜欢将 arg1 包含在 arg2 中。

我该如何解决？

补丁可以在这里提供[https://gist.github.com/3937872](https://gist.github.com/3937872)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T13:42:11.550

替换固定字符串时，无需调用 String 上的正则表达式方法，因为有一个更简单的方法：`input.replace("$", "\\$");`. 使用这种方法，您将不会遇到由美元符号的特殊含义引起的任何麻烦，并且它会（非常稍微）更快作为奖励。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-23T13:42:30.317

`Pattern.quote()`失败原因的解释：

`Pattern.quote()`旨在用于正则表达式（意思是*搜索*表达式）。它通过用`"\\Q"`和包围字符串来工作`"\\E"`，分别表示“逐字部分的开始”和“逐字部分的结束”。

您的错误是由*替换*`$`字符串中的未转义引起的 ，这不是正则表达式，因此无法使用. 因此，正确的解决方案是在替换字符串中手动转义美元符号：*`Pattern.quote()`*

 *```
String resultString = subjectString.replaceAll("\\$", "\\\\\\$"); 
```

或（因为您根本不需要正则表达式来替换单个字符）使用

```
String resultString = subjectString.replace("$", "\\$"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-23T13:31:58.473

这是一个简单的解决方案，它涵盖了您的测试用例：

```
public static String replace( String str, String placeholderRegex, Object... args ) {
    String repl = str.replaceAll( placeholderRegex, "%s" );
    return String.format( repl, args );
} 
```

让我们检查一下：

```
public static void main( String[] args ) {
    System.out.println( 
            replace( "my {} are beautifull {} test", 
                     "\\{\\}", 
                     "flowers", "$dollar" ) );
} 
```

但是，当然，如果您必须处理字符，则必须稍微`%`修改函数（替换前转义，替换后转义）。您也可以使用预编译的正则表达式（如在您的解决方案中）。`replace``%`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-06T19:05:01.967

作为记录，您可以让 Java 以您喜欢的任何替换顺序为您转义 '$' 符号（与其他特殊字符，如 '\' 一样）。这样，如果您愿意，您仍然可以使用 String.replaceAll()。

```
String s = "input".replaceAll("pattern", Matcher.quoteReplacement("replacement")); 
```

[（参见 Java 文档）](https://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html#quoteReplacement(java.lang.String))*

# php - 从 Mysql & PHP 修改 JSON 以兼容 Rickshaw Graph

> ID：13031227
> 
> 赞同：0
> 
> 时间：2012-10-23T13:12:16.893
> 
> 标签：php, mysql, json

我想通过 PHP使用[Rickshaw显示 MySQL 的最后数据](http://code.shutterstock.com/rickshaw/)

它需要看起来像这样：

```
[
    {
        "data": [ { "x": 1350995278, "y": 26.12 }, 
                  { "x": 1350995276, "y": 26.19 }, 
                  { "x": 1350995273, "y": 26.12 }, 
                  { "x": 1350995271, "y": 26.19 }, 
                  { "x": 1350995268, "y": 26.19 } ]
    }
] 
```

但我的 PHP with `json_encode`function 返回它有点不同。我应该如何解决？

PHP代码：

```
 while($row = mysql_fetch_assoc($select)) {
        $r[] = $row;
        $items[] = array('x' => $row['unixtime'], 'y' => $row['sensor']);
    }
    print json_encode($items); 
```

PHP 输出：

```
[{"x":"1350996886","y":"26.06"},
 {"x":"1350996884","y":"26.06"},
 {"x":"1350996881","y":"26.06"},
 {"x":"1350996879","y":"26.06"},
 {"x":"1350996876","y":"26.06"},
 {"x":"1350996874","y":"26.06"},
 {"x":"1350996871","y":"26.06"},
 {"x":"1350996869","y":"26.06"},
 {"x":"1350996866","y":"26.06"},
 {"x":"1350996864","y":"26.06"}] 
```

我不需要`""`之后`x`：和`Y`：我是新手，`PHP`不知道如何弄清楚，请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T16:10:23.457

如果您不希望引用它们，请将值转换为数字：

```
$items[] = array('x' => (float) $row['unixtime'], 'y' => (float) $row['sensor']); 
```

# c# - 如何在多个处理器内核之间平衡 UI 负载？

> ID：13031231
> 
> 赞同：2
> 
> 时间：2012-10-23T13:12:40.677
> 
> 标签：c#

我正在运行一个经常显示大量统计数据和图表的 C# winform 应用程序。这个应用程序由多个表单组成，每个表单都有不同的输出。当我打开任务管理器查看cpu使用情况时，发现我的8个核心中只有一个核心超载，其余的什么都不做！例如，有没有办法将每个表格数量分配给一个核心。我需要提高性能。

我正在寻找的是对我的winforms进行多线程处理，以便每个表单都有一个在不同核心上运行的不同线程。那可能吗 ？

瓶颈发生在将数据加载到控件中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:47:44.223

在单个 WinForms 应用程序中可以有多个 UI 线程。每个 UI 线程必须调用 Application.Run() 并且您需要使用 [STAThread] 标记每个的入口点，就像您在 Main 函数中所做的那样。

我已经成功地做到了这一点，当面对在其 UI 线程上做太多工作的现有代码库时，这是一种合理的方法。但是......我会说这是可以通过其他方式改进的设计的症状。如果您在 UI 线程上做太多工作，请考虑在其他线程上完成该工作的方法。在我的应用程序中，我尝试在非 UI 线程上完成所有重要的工作。它可以做到，但它并不总是交付软件的最快方式。

如果不做任何其他工作，单个 UI 线程就足以绘制 8 个充满数字和图表的屏幕，并且更新它们的频率超出了人类可以跟上的频率。我知道是这样的:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:49:27.077

这在技术上是可行的，在 WPF 中比在 WinForms 中更灵活（根据我的经验），但两者都不推荐。Windows 客户端应用程序倾向于使用负责绘制 UI 的单个线程运行；通常后台线程用于数据访问或业务逻辑的后台处理。此外，您必须在 UI 中做大量工作才能使渲染性能成为真正的问题——这对我来说听起来像是不必要的工作。

但是，WinForms 中的基本样式是这样的：

```
var t = new Thread(() =>
        {
            var f = new Form1();
            Application.Run(f);
        })
t.Start(); 
```

您需要注意的事项：

*   您将始终必须`Invoke`在表单之间调用以确保它们位于正确的线程上。
*   如果您的业务层中有任何东西具有线程亲和性，那么每个使用它的表单都需要一个实例。
*   应用程序关闭通常发生在响应主线程的表单关闭时。您可能需要手动处理关闭，尽管使用上面的代码，您有两个消息循环正在运行，并且当另一个表单关闭时，其中一个将使应用程序保持活动状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:50:35.073

如果您需要/想要，请始终在单独的线程或多个线程上进行数据处理、从 I/O 接收、解析等。

然后，如果您将大量数据加载到 UI 控件，请确保不要过于频繁地与 UI 线程同步，例如，如果您分别从输入流中调用每个项目并且每秒有数千个这样的项目 - WinForms将停止。

在后台线程中排队视觉数据更改，并以最小间隔将它们批处理到 UI 线程，以免过于频繁地执行此操作 - 线程同步很昂贵。AddRange 是您的朋友。

# android - 从扩展文件中读取 mp3

> ID：13031240
> 
> 赞同：6
> 
> 时间：2012-10-23T13:13:18.663
> 
> 标签：android, file, mp3, expansion

从扩展文件中读取 mp3 文件

我有创建和扩展文件的名称

“main.1.com.example.app.obb”

其中包含音频文件名“about_eng.mp3”

现在问题我已经编写了以下代码来读取和播放 mp3 文件

```
 private final static String EXP_PATH = "/Android/obb/";

static String[] getAPKExpansionFiles(Context ctx, int mainVersion, int patchVersion) {
    String packageName = ctx.getPackageName();
    Vector<String> ret = new Vector<String>();
    if (Environment.getExternalStorageState().equals(Environment.MEDIA_MOUNTED)) {
        // Build the full path to the app's expansion files
        File root = Environment.getExternalStorageDirectory();
        File expPath = new File(root.toString() + EXP_PATH + packageName);

        // Check that expansion file path exists
        if (expPath.exists()) {
            if ( mainVersion > 0 ) {
                String strMainPath = expPath + File.separator + "main." +
                        mainVersion + "." + packageName + ".obb";
                File main = new File(strMainPath);
                if ( main.isFile() ) {
                        ret.add(strMainPath);
                }
            }
            if ( patchVersion > 0 ) {
                String strPatchPath = expPath + File.separator + "patch." +
                        mainVersion + "." + packageName + ".obb";
                File main = new File(strPatchPath);
                if ( main.isFile() ) {
                        ret.add(strPatchPath);
                }
            }
        }
    }
    String[] retArray = new String[ret.size()];
    ret.toArray(retArray);
    return retArray;
}
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    // Get a ZipResourceFile representing a merger of both the main and patch files

    try {
        ZipResourceFile expansionFile = APKExpansionSupport.getAPKExpansionZipFile(this,1,1);
        if(expansionFile!=null){

            AssetFileDescriptor fd = expansionFile.getAssetFileDescriptor("about_eng.mp3");
                //or
            MediaPlayer mediaPlayer = new MediaPlayer();
            mediaPlayer.setDataSource( fd.getFileDescriptor(), 
                    fd.getStartOffset(),fd.getLength());
            mediaPlayer.prepare();
            mediaPlayer.start();

            }

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    // Get an input stream for a known file inside the expansion file ZIPs

} 
```

但它总是在这一行抛出异常

```
 mediaPlayer.setDataSource( fd.getFileDescriptor(), 
                    fd.getStartOffset(),fd.getLength());
            mediaPlayer.prepare(); 
```

因为变量 fd 为空。

任何机构都可以帮我解决这个问题

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-09-23T07:30:38.077

我用谷歌搜索，发现我们必须制作 .zip，在[http://developer.android.com/google/play/expansion-files.html](http://developer.android.com/google/play/expansion-files.html)`0% (No compression)`中提到

`Tip: If you're packaging media files into a ZIP, you can use media playback calls on the files with offset and length controls (such as MediaPlayer.setDataSource() and SoundPool.load()) without the need to unpack your ZIP. In order for this to work, you must not perform additional compression on the media files when creating the ZIP packages. For example, when using the zip tool, you should use the -n option to specify the file suffixes that should not be compressed: zip -n .mp4;.ogg main_expansion media_files`

那么**如何使用winrar制作0％压缩zip？** ![在此处输入图像描述](../Images/4255150fff59d676a4cde268577f1e44.png)

这里看压缩方法

所以我们应该把这个 zip 上传到 Play 商店。

所以你不需要使用其他 SO 答案中提到的**ZipHelper.java**

只需简单地使用

```
ZipResourceFile expansionFile=null;

            try {
                expansionFile = APKExpansionSupport.getAPKExpansionZipFile(getApplicationContext(),3,0);

                     AssetFileDescriptor fd = expansionFile.getAssetFileDescriptor("test.mp3");
                     MediaPlayer mPlayer = new MediaPlayer();
                     mPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
                     mPlayer.setDataSource(fd.getFileDescriptor(),fd.getStartOffset(),fd.getLength());
                     mPlayer.prepare();
                     mPlayer.start();

            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-09T13:14:32.113

尝试使用`expansionFile.getAssetFileDescriptor("main_expansion/about_eng.mp3")`.

如果它不起作用，请调用：

`ZipResourceFile.ZipEntryRO [] entries = expansionFile.getAllEntries();`

并查看文件名：

`entries[0].mFileName;`.

这可能是路径应该是什么样子的提示。

我知道这个问题很老，但也许它可以帮助某人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-19T19:02:11.980

要阅读 mp3，使用媒体播放器，您可以通过 3 种方式进行

例如。我的应用程序包名称是

> com.bluewindsolution.android.sampleapp

那么我的扩展文件应该是

> main.1.com.bluewindsolution.android.sampleapp.obb

详细的，你可以关注[这里](http://developer.android.com/google/play/expansion-files.html)

> [main|patch].<扩展版本>.<包名>.obb

* * *

**从扩展中，您可以通过 3 种方式获得它：**

*通过 AssetFileDescriptor*

```
// this one work with image file, media file
// Get a ZipResourceFile representing a specific expansion file
// mainContext, version no. of your main expansion, version no of your patch
ZipResourceFile expansionFile = APKExpansionSupport.getAPKExpansionZipFile(this, 1, 0); 
AssetFileDescriptor afd_img1 = expansionFile.getAssetFileDescriptor("your_path/your_file.jpg");
AssetFileDescriptor afd_mpbg = expansionFile.getAssetFileDescriptor("your_path/your_file.mp3");

// to set image
ImageView imageView1 = (ImageView)findViewById(R.id.iv1); 
imageView1.setImageBitmap(BitmapFactory.decodeFileDescriptor(afd_iv1.getFileDescriptor()));

// to set sound
try {
    mpbg.setDataSource(afd_mpbg.getFileDescriptor(), afd_mpbg.getStartOffset(), afd_mpbg.getDeclaredLength());
    mpbg.prepareAsync();
    mpbg.start();
} catch (IllegalStateException e) {
    Log.w("Error=====", "Failed to prepare media player", e);
} 
```

* * *

通过输入流

```
// this one work with image file, media file
// Get a ZipResourceFile representing a specific expansion file

ZipResourceFile expansionFile = new ZipResourceFile(filePathToMyZip);

// Get an input stream for a known file inside the expansion file ZIPs

InputStream fileStream = expansionFile.getInputStream(pathToFileInsideZip); 
```

* * *

*通过乌里*

```
//this one can use in almost thing such as jpg, mp3, mp4, pdf, etc.

//you need to create new class to override APEZProvider
public class ZipFileContentProvider extends APEZProvider {
    @Override
    public String getAuthority() {
        return "com.bluewindsolution.android.sampleapp";
    }
}

//you need to add <provider> in AndroidManifest.xml
<provider
 android:name="com.bluewindsolution.android.sampleapp.ZipFileContentProvider"
   android:authorities="com.bluewindsolution.android.sampleapp" 
      android:exported="false"
      android:multiprocess="true"
    >
    <meta-data android:name="mainVersion"
              android:value="1"></meta-data>
</provider>

//after that you can use it any time by this code:
String filename2 = "image/i_commu_a_1_1_1_1.jpg"; // suppose you store put your file in directory in .obb
String uriString2 = "content://com.bluewindsolution.android.sampleapp" +  File.separator + filename2;
Uri uri2 = Uri.parse(uriString2);
imageView2.setImageURI(uri2);

// Filename inside my expansion file
String filename = "video/v_do_1_1_1.mp4"; // suppose you store put your file in directory in .obb
String uriString = "content://com.bw.sample_extension_download_main" +  File.separator + filename;
Uri uri = Uri.parse(uriString);

v1 = (VideoView)findViewById(R.id.videoView1);
v1.setVideoURI(uri);
v1.start(); 
```

# c# - 为什么一个类不实现 ISerializable 接口违反 MissingSerializationConstructorRule

> ID：13031241
> 
> 赞同：3
> 
> 时间：2012-10-23T13:13:30.177
> 
> 标签：c#, serializable

我们有声纳报告说我们项目中的许多类违反了[MissingSerializationConstructorRule](https://github.com/spouliot/gendarme/wiki/Gendarme.Rules.Serialization.MissingSerializationConstructorRule%282.10%29)，但是该类及其基类都没有实现任何 Iserializable 接口，有人知道为什么吗？

例如，声纳说：

```
public class CommentPage : RmdsPublicationPage, ICommentPage 
    { 
 *MissingSerializationConstructorRule    
 The required constructor for ISerializable is not present in this type.* 
    public CommentPage() 
    { 
        this["COMMENTTXT"] = null; 
```

对应的类在哪里

```
public class CommentPage : RmdsPublicationPage, ICommentPage
{
    public CommentPage()
    {
        // do something
    }
    public void Update(string comment)
    {
        //something else
    }
} 
```

两个接口也不实现ISerializable，即

```
public class RmdsPublicationPage : Dictionary<string, object>, IRmdsPublicationPage

public interface IRmdsPublicationPage : IDictionary<string, object>, IDisposable 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:17:00.513

[Dictionary(TKey, TValue)](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)实现 ISerializable

```
[SerializableAttribute]
[ComVisibleAttribute(false)]
public class Dictionary<TKey, TValue> : IDictionary<TKey, TValue>, 
    ICollection<KeyValuePair<TKey, TValue>>, IDictionary, ICollection, 
    IReadOnlyDictionary<TKey, TValue>, IReadOnlyCollection<KeyValuePair<TKey, TValue>>, 
    IEnumerable<KeyValuePair<TKey, TValue>>, IEnumerable, ISerializable, 
    IDeserializationCallback 
```

# java - 地图不是无限的

> ID：13031242
> 
> 赞同：0
> 
> 时间：2012-10-23T13:13:32.173
> 
> 标签：java, java-7

我想用瓷砖使地图无限，但是当我进入某些部分时，它只是黑色并且不会正确渲染。这是 Screen.java 和 Game.java 的代码。Screen.java：（我认为问题出在哪里）

```
package com.vipgamming.Frytree.graphics;

import java.util.Random;

public class Screen {

private int width, height;
public int[] pixels;
public final int MAP_SIZE = 128;
public final int MAP_SIZE_MASK = MAP_SIZE -1;
public int[] tiles = new int [MAP_SIZE*MAP_SIZE];

private Random random = new Random();

public Screen(int width, int height) {
    this.width = width;
    this.height = height;
    pixels = new int[width * height];

    for (int i = 0; i < MAP_SIZE + MAP_SIZE; i++) {
        tiles[i] = random.nextInt (0xffffff);
    }
}

public void clear() {
    for (int i = 0; i < pixels.length; i++) {
        pixels[i] = 0;
    }
}

public void render(int xOffset, int yOffset) {
    for (int y = 0; y < height; y++) {
        int yy = y+yOffset;
        //if (yy < 0 || yy >= height ) break;
        for (int x = 0; x < width; x++) {
            int xx = x+xOffset;
            //if (xx < 0 || xx >= width) break;
            int tileIndex = ((xx >> 4) & MAP_SIZE_MASK) + ((yy >> 4) & MAP_SIZE_MASK) * 8;
            pixels[x + y * width] = tiles[tileIndex];
           }
        }
    }

 } 
```

游戏.java

```
package com.vipgamming.Frytree;

import java.awt.Canvas;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.image.BufferStrategy;
import java.awt.image.BufferedImage;
import java.awt.image.DataBufferInt;

import javax.swing.JFrame;

import com.vipgamming.Frytree.graphics.Screen;
import com.vipgamming.Frytree.input.Keyboard;

public class Game extends Canvas implements Runnable {

private static final long serialVersionUID = 1L;
public static int width = 300;
public static int height = width /16 * 10;
public static int scale = 3;
public static String title = "FryTree";

private Thread thread;
private JFrame frame;
private Keyboard key;
private boolean running = false;

private Screen screen;

private BufferedImage image = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);
private int[] pixels = ((DataBufferInt)image.getRaster().getDataBuffer()).getData();

public Game() {
    Dimension size = new Dimension(width * scale, height * scale);
    setPreferredSize(size);

    screen = new Screen(width, height);
    frame = new JFrame();
    key = new Keyboard();

    addKeyListener(key);

}

public synchronized void start() {
    running = true;
    thread = new Thread(this, "Display");
    thread.start();
}

public synchronized void stop() {
    running = false;
    try {
        thread.join();
    }catch (InterruptedException e) {
        e.printStackTrace();
    }
}

public void run() {
    long lastTime = System.nanoTime();
    long timer = System.currentTimeMillis();
    final double ns = 1000000000.0 / 60.0;
    double delta = 0;
    int frames = 0;
    int updates = 0;
    while (running) {
            long now = System.nanoTime();
            delta += (now-lastTime) / ns;
            lastTime = now;
            while (delta >= 1) {
                update();
                updates++;
                delta--;
            }
            render();
            frames++;

            if (System.currentTimeMillis() - timer > 1000) {
                timer += 1000;
                System.out.println(updates + "ups, " + frames +" fps");
                frame.setTitle(title + "  |  " + updates + "ups, " + frames +" fps");
                updates = 0;
                frames = 0;
            }
        }
    stop(); 
}
int x=0, y=0;
public void update() {
    key.update();
    if (key.up) y--;
    if (key.down) y++;
    if (key.left) x--;
    if (key.right) x++;
    }

public void render() {
    BufferStrategy bs = getBufferStrategy();
    if (bs == null) {
        createBufferStrategy(3);
        return;
    }
    screen.clear();
    screen.render(x, y);

    for (int i = 0; i < pixels.length; i++) {
        pixels[i] = screen.pixels[i];
    }

    Graphics g = bs.getDrawGraphics();
    g.drawImage(image, 0, 0, getWidth(), getHeight(), null);
    g.dispose();
    bs.show();
}

    public static void main(String [] args) {
        Game game = new Game();
        game.frame.setResizable(false);
        game.frame.setTitle(game.title);
        game.frame.add(game);
        game.frame.pack();
        game.frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        game.frame.setLocationRelativeTo(null);
        game.frame.setVisible(true);

        game.start();
    }
} 
```

它没有给出任何错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:15:53.213

在`for`构造函数的循环中，我认为您想要乘以`MAP_SIZE`，`MAP_SIZE`而不是相加。

# c# - 在非“csproj”文件中定义编译符号？

> ID：13031244
> 
> 赞同：2
> 
> 时间：2012-10-23T13:13:35.833
> 
> 标签：c#, visual-studio, visual-studio-2012

我正在使用很多“编译符号”来控制不同的东西，例如日志记录。

```
 [Conditional("LOG_AAA")]
    public static void Warning(string s)
    {
        swLog.WriteLine(DateTime.Now.TimeOfDay + " [Warning] " + s);
    } 
```

我可以随时打开/关闭“LOG_AAA”并控制是否需要写入某些日志。我有来自程序不同部分的多种类型的日志，我经常需要打开/关闭其中的一些。

问题是每次我更改任何设置时，我的“csproj”文件都会更新，并且当我将它存储在存储库中时，我必须提交它。

问题是如何解决这个问题？

*   不要将“csproj”文件存储在存储库中？但是这个文件包含很多重要的东西，所以恐怕我必须将它存储在存储库中
*   将“csproj”文件存储在存储库中？那么如何“提取”我经常修改的“编译符号”呢？

可能“log4net”可以解决我的问题，但我不想使用它，因为我喜欢我非常简单的日志记录机制。我不想再添加一个包含很多我不会使用的东西的库，所以请不要建议我切换到“log4net”。我同意这可能会解决我的问题，并且我可能应该切换到它，但让我们在这个问题中假设“log4net”（以及其他库）不是一个选项。此外，这个问题不仅与日志有关，而且与可用于控制任何事物（包括日志）的编译符号有关。

# php - PHP函数删除字符串中某些字符之间的所有字符

> ID：13031250
> 
> 赞同：33
> 
> 时间：2012-10-23T13:14:00.650
> 
> 标签：php, string

我有兴趣在`function delete_all_between($char1, $char2, $string)` 给定的 $string 中搜索 $char1 和 $char2 ，如果找到了，则从这两个字符之间的子字符串中清除 $string，**包括**$char1 和 $char2 本身。

例子：

```
$string = 'Some valid and <script>some invalid</script> text!';
delete_all_between('<script>', '</script>', $string); 
```

现在， $string 应该只包含

```
'Some valid and  text'; //note two spaces between 'and  text' 
```

有人有快速解决方案吗？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-10-23T13:28:52.040

```
<?php

$string = 'Some valid and <script>some invalid</script> text!';
$out = delete_all_between('<script>', '</script>', $string);
print($out);

function delete_all_between($beginning, $end, $string) {
  $beginningPos = strpos($string, $beginning);
  $endPos = strpos($string, $end);
  if ($beginningPos === false || $endPos === false) {
    return $string;
  }

  $textToDelete = substr($string, $beginningPos, ($endPos + strlen($end)) - $beginningPos);

  return delete_all_between($beginning, $end, str_replace($textToDelete, '', $string)); // recursion to ensure all occurrences are replaced
} 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2015-12-10T09:50:40.617

这是一个单线：

`preg_replace('/START[\s\S]+?END/', '', $string);`

替换`START`和`END`:) 学分转到另一个 SO 线程！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-17T15:44:04.320

我觉得`substr()`工作太慢了。最好的方法是：

```
return substr($string, 0, $beginningPos) . 
       substr($string, $endPos + strlen($end)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-07-23T16:13:41.830

在我的情况下，[第一个](https://stackoverflow.com/posts/13031540/revisions)版本有问题，这是我更正的版本（如果 $end 字符串也出现在 $beginning 字符串之前）

```
<?php 
$string = 'Some </script> valid and <script>some invalid</script> text!';
$out = delete_all_between('<script>', '</script>', $string);
print($out);

function delete_all_between($beginning, $end, $string) {
    $beginningPos = strpos($string, $beginning);
    $tmpstring = substr($string, $beginningPos);  
    $endPos = strpos($tmpstring, $end);
    if ($beginningPos === false || $endPos === false) {
        return $string;
    }
    $textToDelete = substr($string, $beginningPos, ($endPos + strlen($end)) );
    return delete_all_between($beginning, $end, str_replace($textToDelete, '', $string)); // recursion to ensure all occurrences are replaced
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-05-23T00:02:53.650

实际上，我一直在寻找一个函数，它为我提供了简单而稳定的解决方案来获取 TWIG 模板的所有变量。由于许多原因，建议的正则表达式效果不佳，所以我决定只删除标签之间的所有内容，而不是计算标签^_^。

```
/**
     * deletes ALL the string contents between all the designated characters
     * @param $start - pattern start 
     * @param $end   - pattern end
     * @param $string - input string, 
     * @return mixed - string
     */
    function auxDeleteAllBetween($start, $end, $string) {
        // it helps to assembte comma dilimited strings
        $string = strtr($start. $string . $end, array($start => ','.$start, $end => chr(2)));
        $startPos  = 0;
        $endPos = strlen($string);
        while( $startPos !== false && $endPos !== false){
            $startPos = strpos($string, $start);
            $endPos = strpos($string, $end);
            if ($startPos === false || $endPos === false) {
                $run = false;
                return $string;
            }
            $textToDelete = substr($string, $startPos, ($endPos + strlen($end)) - $startPos);
            $string = str_replace($textToDelete, '', $string);
        }
        return $string;
    }

    /**
     * This function is intended to replace
     * //preg_match_all('/\{\%\s*([^\%\}]*)\s*\%\}|\{\{\s*([^\}\}]*)\s*\}\}/i', $this->_tplSubj, $matchesSubj);
     * which did not give intended results for some reason.
     *
     * @param $inputTpl
     * @return array
     */
    private function auxGetAllTags($inputTpl){
        $inputTpl = strtr($inputTpl, array('}}' => ','.chr(1), '{{' => chr(2)));
        return explode(',',$this->auxDeleteAllBetween(chr(1),chr(2),$inputTpl));
    }

$template = '<style>
td{border-bottom:1px solid #eee;}</style>
<p>Dear {{jedi}},<br>New {{padawan}} is waiting for your approval: </p>
<table border="0">
<tbody><tr><td><strong>Register as</strong></td><td>{{register_as}}, user-{{level}}</td></tr>
<tr><td><strong>Name</strong></td><td>{{first_name}} {{last_name}}</td></tr>...';

print_r($this->auxGetAllTags($template)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-08T08:17:12.670

我想删除 php 中的标签，因为我想在将 html 解析为 DOMDocument 之前删除未使用的标签。

这是我使用的代码。光标在开始时为 0。它只是用于程序中的递归。

```
function delete_all_betweenV2($cursor, $beginning, $end, $string, $retainSelf) {
    echo '>>>> Start '.'<br>';
    $beginningPos = strpos($string, $beginning, $cursor);
    $endPos = strpos($string, $end, $beginningPos);

    if ($beginningPos === false || $endPos === false) {
      echo '>>>> End '.'<br>';
      return $string;
    }    

    if($endPos >= strlen($string)) {
      echo '>>>> End '.'<br>';
      return $string;
    }

    $lenOfBeginning = strlen($beginning);
    $lenOfEnd = strlen($end);

    $result = $string;
    if($retainSelf) {
      echo 'b4 input String: '.$string.'<br>';
      echo 'b4 cursor = : '.$cursor. '<br>';
      echo 'b4 string: '.$string. '<br>';
      echo 'b4 beginning Pos: '.$beginningPos.'<br>';
      echo 'b4 end Pos: '.$endPos.'<br>';
      echo 'b4 length to be cut is: '.(($endPos - $lenOfEnd) - $beginningPos).'<br>';

      if($cursor > 0) {
        echo 'cursor is greater than 0'.'<br>';
        $textToDelete = substr($string, $beginningPos + $lenOfBeginning, ($endPos - $lenOfEnd) - $beginningPos);
      } else {
        echo 'cursor is NOT greater than 0'.'<br>';
        $textToDelete = substr($string, $beginningPos + $lenOfBeginning, ($endPos - $lenOfEnd) - $beginningPos);
      }

      echo 'TextToDelete:'.$textToDelete.'<br>';

      //$stringStart = substr($string, 0, $beginningPos + $lenOfBeginning);
      //echo $stringStart.'<br>';
      //$stringTail = substr($string, $endPos, strlen($string));
      //echo $stringTail.'<br>';    
      $result = str_replace($textToDelete, '', $string);
      $cursor = $beginningPos + $lenOfBeginning; // just make sure that the cursor search next character/word
      echo 'After cursor = : '.$cursor. '<br>';
      echo 'After result: '.$result. '<br>';
      echo 'After len of result: '.strlen($result). '<br>';
    } else {
        //$stringStart = substr($string, 0, $beginningPos);
        //echo $stringStart.'<br>';
        //$stringTail = substr($string, $endPos + $lenOfEnd, strlen($string));
        //echo $stringTail.'<br>';
        $cursor = 0;

        $textToDelete = substr($string, $beginningPos, ($endPos + $lenOfEnd) - $beginningPos);
        echo 'TextToDelete:'.$textToDelete.'<br>';
        $result = str_replace($textToDelete, '', $string);
    } 
    echo '>>>> End '.'<br>';
    return delete_all_betweenV2($cursor, $beginning, $end, $result, $retainSelf);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-13T13:08:59.983

作为对 AndreaTS 的 delete_all_between() 的修订，但为了处理标签属性（例如`<script type='abc'>`）和不区分大小写，我有这个......

```
 function delete_all_between(string $html, string $tag) {
        $startTag="<$tag ";
        $endTag="</$tag>";
        $html     =str_ireplace("<$tag>", "<$tag >", $html);
        $startPos = stripos($html, $startTag);
        $tmpStr = substr($html, $startPos);
        $endPos = stripos($tmpStr, $endTag);
        if ($startPos === false || $endPos === false) {
            return $html;
        }
        $textToDelete = substr($html, $startPos, ($endPos + strlen($startTag))+1 );
        return delete_all_between(str_replace($textToDelete, '', $html), $tag); // recursion to ensure all occurrences are replaced
    } 
```

请参阅[http://sandbox.onlinephpfunctions.com/code/1b984b61cfd1c9cea4c6eef1d765ff387a4cd9e9](http://sandbox.onlinephpfunctions.com/code/1b984b61cfd1c9cea4c6eef1d765ff387a4cd9e9)了解运行此的 php 沙箱。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2018-01-04T11:41:19.453

您可以使用双 str_replace() `$q = str_replace('<script>', '', $string); $p = str_replace('some invalid', '', $q); echo $p;`

# php - 获取 URL 值 with different domain name

> ID：13031254
> 
> 赞同：0
> 
> 时间：2012-10-23T13:14:08.173
> 
> 标签：php, url, iframe, youtube

I used a form to capture data from clients. In this form is an iframe that loads youtube videos onto youtube. The reason for the different URL is because my original code was written in CakePHP and the youtube api uses the Zend Framework.

Now I need the values returned from youtube that is stored in the URL of the iframe to save in the DB, so that when called later the video will open with the correct listing.

Any advise?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:30:33.937

There is no way to get any information about pages loaded into an iframe if the document loaded into it comes from a different domain. This is due to [the same origin policy](http://en.wikipedia.org/wiki/Same_origin_policy).

YouTube has [an API](https://developers.google.com/youtube/getting_started#data_api) that allows people to perform searches of YouTube from your website. You could use that to allow people to select videos instead of trying to reverse engineer the YouTube URI system.

# excel-2010 - Excel 2010 在工作表上复制/粘贴会在同一位置更改另一个工作表

> ID：13031261
> 
> 赞同：0
> 
> 时间：2012-10-23T13:14:30.513
> 
> 标签：excel-2010

嗨，我在 excel 2010 中有一个奇怪的问题。

我已经设置了一系列页面以在多个工作表上打印。

当我使用复制/粘贴或格式刷格式化其中一个工作表时遇到问题。

这些更改正在同一行/列的其他工作表中复制。

有没有人有类似的经历？

还是我发现了一个未记录的功能？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:19:35.610

哪些更改被复制了 - 数据或格式或两者兼而有之？

格式：

您可能选择了多个工作表。

可能有条件格式。

数据：

您可能选择了多个工作表。

可能有公式，它们引用相同的来源

# ssas - 如何使用 MDX 计算单独行上的日期之间的差异？

> ID：13031262
> 
> 赞同：0
> 
> 时间：2012-10-23T13:14:30.013
> 
> 标签：ssas, mdx, datediff, cubes

我对 MDX 很陌生，我需要编写一个查询来给出两个日期之间的天差。问题是日期存在于我的数据中的两个不同行上。例如：

我的事实表：

```
SEAL | STARTDATE | PROCESS | FK_DATE_KEY  
1    | 2012-10-22|    A    | 20121022
1    | 2012-10-24|    B    | 20121024
2    | 2012-10-22|    A    | 20121022
2    | 2012-10-26|    B    | 20121026 
```

我需要返回的是：

```
SEAL | AGE_IN_DAYS
1    |      2
2    |      4 
```

请帮忙....我有一个与我的 FK_DATE_KEY 相关的日期维度

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:23:11.697

如果您是新手`MDX`，则不应尝试仅使用`MDX`. `SQL`如果您在 Analysis Services 下编写并使用该数据，则此特定问题会容易得多。

因此，解决此问题的最简单和最好的方法是编写一个视图，该视图返回您在问题中提供的相同数据。( `SEAL | AGE_IN_DAYS`) 然后您可以在数据源视图中插入这些数据（如果您选择“新命名查询”，您也可以获取表值函数，而不仅仅是视图和表）

希望能帮助到你！

# c++ - 将源文件复制到 Visual Studio 项目中

> ID：13031268
> 
> 赞同：6
> 
> 时间：2012-10-23T13:14:40.060
> 
> 标签：c++, visual-studio

我创建了一个新的 Visual Studio C++ 项目，我想将一些 C 和头文件的副本导入到项目中。也就是说，这些文件当前位于我桌面上的一个文件夹中，我想导入它们，以便将副本放置在新创建的项目文件夹中。

我该怎么做？我试过使用**File | 新 | 从现有代码进行项目，**但这只是将文件保留在其现有位置。我什至尝试过简单的**Ctrl-C**和**Ctrl-V**并再次导入文件，但它们留在磁盘上的同一位置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T13:18:56.503

将文件复制到 Windows 资源管理器中的新位置，然后启动 Visual Studio 并将它们作为现有项添加到项目中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:18:02.010

我认为更好的解决方案是创建一个新的（空）项目，并在“标题”和“源”的上下文菜单中按“添加->现有项目”添加您的 h 和 cpp 文件

# java - JSR-303 - 我的方法是线程安全的吗？

> ID：13031269
> 
> 赞同：0
> 
> 时间：2012-10-23T13:14:41.447
> 
> 标签：java, bean-validation

文档说 ValidatorFactory 是线程安全的，但我担心使用如下所示的带注释的服务“InvService”作为类属性。

我想知道这种方法是否是线程安全的？我基本上需要根据约束违规进行数据库查找。

```
public class MyValidator {

    @Autowired
    InvService invService;                        //  ??????
    private final ValidatorFactory factory;

    public MyValidator() {
        factory = Validation.buildDefaultValidatorFactory();
    }

    public <T> void validate(final T instance) {
        final Validator validator = factory.getValidator();

        final Set<ConstraintViolation< T>> violations = validator.validate(instance, Default.class);

        if (!violations.isEmpty()) {
            final Set<ConstraintViolation<?>> constraints = new HashSet<ConstraintViolation<?>>(violations.size());

            for (final ConstraintViolation<?> violation : violations) {
                constraints.add(violation);
            }
            getDBRecords(constraints); 
            throw new ConstraintViolationException(constraints);
        }
    }

    private getDBRecords(Set<ConstraintViolation<?>> constraints) {
        invService.get(....);
    }
} 
```

这是服务类的样子：

```
@Service
public class InvServiceImpl implements InvService {

    @Autowired
    private InvDAO InvDAO;
    private final Logger log = LoggerFactory.getLogger(this.getClass());

    @Override
    public <T extends InvContent>  getProduct(String InvKey) {
        return InvDAO.getInvContent(InvKey, TYPEPROD, Product.class);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:18:12.290

这取决于... InvService 线程安全吗？如果是，那么您就可以了。线程安全类可以引用其他线程安全类的实例作为属性，并且本身保持线程安全。但是你必须确保你引用的对象是线程安全的。如果您没有开发该类，我希望看到明确说明它是线程安全的文档。

# node.js - 使用 Node.js 集群，我如何共享连接？

> ID：13031273
> 
> 赞同：0
> 
> 时间：2012-10-23T13:14:50.653
> 
> 标签：node.js, iisnode

我有一个 Azure 托管应用程序 (iisnode)，它接受来自多个客户端服务的直接连接。此应用程序在各种连接之间传输数据。如果在具有多个 node.js 实例的系统上运行，实际的 TCP 连接将连接到不同的实例。

有没有办法以某种方式将内存中的连接从一个实例“移动”或“共享”到另一个实例？

当然，我可以构建一些实例间通信来路由数据，但我认为应用程序不会扩展，因为它的全部目的是快速移动数据。例如，我将有 4 个实例，每个实例有 100 个连接，并且我将花费与在客户端连接之间移动数据所花费的资源一样多的资源在实例之间移动数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T16:51:47.053

当您将 iisnode 配置为创建多个 node.exe 进程（使用 nodeProcessCountPerApplication 设置）时，它将使用循环逻辑在它们之间分派传入的 HTTP 请求；应用程序无法控制该行为。鉴于您的情况，无法确定性地确保来自两个不同客户端的请求（“连接”）将位于同一个 node.exe 进程中。

没有在 node.exe 进程之间“移动”现有 TCP 连接或 HTTP 请求的机制。

通常，解决此类通知场景的更好方法可能是使用基于订阅的消息传递基础架构作为您的后端。Azure 中的 ServiceBus 提供了这样的机制。在此设计中，node.exe 的每个实例在收到来自客户端的连接时都会订阅特定主题，并在匹配的通知到达时由 ServiceBus 通知，可能通过不同的 node.exe 实例。

# entity-framework-5 - 使用实体框架 SqlQuery 填充子实体

> ID：13031281
> 
> 赞同：1
> 
> 时间：2012-10-23T13:15:38.940
> 
> 标签：entity-framework-5

我在 1:n 关系中有两个实体：类别和产品。

```
public class Category 
{
   public int CategoryID { get; set; }
   public string CategoryName { get; set; }

   public virtual ICollection<Product> Products { get; set; }
}

public class Product
{
   public int ProductID { get; set; }
   public string ProductName { get; set; }

  public virtual Product { get; set; }
}

public class context : DbContext
{
    public DbSet<Category> Categories { get; set; }
    public DbSet<Product> Products { get; set; }
} 
```

通过急切加载可以加载每个类别的产品。

```
context.Categories.Include(c=>c.Products).ToList() 
```

如何在以下查询中加载每个类别中的产品，与 Eager 加载相同？

```
var q = @"
   SELECT Categories.*
   JOIN Products
   ON Category.CategoryId = Products.CategoryId";
var c = context.Categories.SqlQuery(q).ToList(); 
```

它只是一个简单的查询。我需要使用 SqlQuery 来执行一些查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T21:05:05.837

根据[这个解释](http://msdn.microsoft.com/en-US/data/jj592907)，你不能：

> 应该编写查询以确保*它只返回真正**属于请求类型的*实体

 *（我的重点）

因此，只有通过延迟加载（如果启用），您才能在运行后加载类别*，*`Products`这将导致 n+1 个查询。*`SqlQuery`*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T21:06:43.580

如果结果包含多个实体类型，我认为不可能物化从 Sql 查询获得的实体。**

# javascript - 显示计时器倒计时

> ID：13031283
> 
> 赞同：0
> 
> 时间：2012-10-23T13:15:48.127
> 
> 标签：javascript, jquery

在我的游戏中，我将计时器设置为 30000 毫秒（30 秒）。当计时器结束时，游戏结束。我想向用户展示计时器，让他们了解他们还剩多长时间。我将如何做到这一点，我试图这样做：

```
setTimeout(function() {
                    $("#message").html('Thank you for playing. </br> You answered </br>' + hit + '/' + attempted + ' correctly. </br> Press "Play" to start again.').fadeIn('slow');
                    $(".character").fadeIn('slow');
                }, 500);
            });
        }, 30000).show('#timer'); //here I am trying to display the time in the "#timer"
    } 
```

我想我正在接近这一切都是错误的，有人可以给我指出正确的方向吗？

小提琴：http: [//jsfiddle.net/cFKHq/8/](http://jsfiddle.net/cFKHq/8/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:33:30.037

看看这个[jsFiddle](http://jsfiddle.net/cFKHq/13/)。您只需要将您的更改`timeout`为 an`interval`并计算秒数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:19:16.300

与其一次运行所有 30000 个计时器，不如以 1000 毫秒的增量运行计时器。每次命中，计数器减一，刷新页面，如果计数器为0，则结束游戏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:24:23.847

这是一个例子：http: [//jsfiddle.net/RPSMJ/4/](http://jsfiddle.net/RPSMJ/4/)

**JavaScript**

```
var counter = 30,
    timerOutput = document.getElementById('timerOutput');
(function timer() {
    timerOutput.innerHTML = counter;
    counter -= 1;
    if (counter >= 0) {
        setTimeout(function () {
            timer();
        }, 1000);
    }
}());​ 
```

**HTML**

```
<div id='timerOutput'></div>​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T13:33:13.480

我更改了您发布的 jsfiddle 以在按下播放按钮后显示计数器。见[http://jsfiddle.net/cFKHq/10/](http://jsfiddle.net/cFKHq/10/)

在您的函数中`startplay()`，我添加了`ttime`一个初始值为 30 的变量，并将该行添加`$("#timer").text(--ttime);`到`setInterval`每秒调用的参数函数中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-23T13:34:00.130

研究使用增量时间。我发现这是处理需要及时测量变化的事情的好方法。

```
prevTime = curTime;
curTime += new Date();
deltaTime = curTime - prevTime; 
```

如果您每 1 秒甚至每 100 毫秒触发一次事件，这也将允许您有一个“剩余 x 秒”计数器。一切都取决于您希望它运行多快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-23T13:35:50.800

如果您设置游戏将持续的秒数，则可以使用全局`window.duration`变量，然后在“一秒”间隔内递减：

查看工作[**演示**](http://jsfiddle.net/gnel/cFKHq/12/embedded/result/)

在脚本开始时：

```
var hit = 0;
var attempted = 0;
var target = $("#target");
window.cont = true;
window.duration = 30; //set your desired game duration in seconds 
```

然后在“一秒间隔”上，我们减少计时器并打印计时器文本：

```
 play = setInterval(function() {
        if (window.cont) {
            window.cont = false;
            scramble();
        }
        window.duration--;
        $('#timer').html(window.duration + ' seconds to go');
    }, 1000); 
```

游戏结束时也会显示“完成”文字，相关部分如下：

```
setTimeout(function() {
                    $("#message").html('Thank you for playing. </br> You answered </br>' + hit + '/' + attempted + ' correctly. </br> Press "Play" to start again.').fadeIn('slow');
                    $(".character").fadeIn('slow');
                    $('#timer').html('Finished');
                }, 500); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-23T13:47:14.427

您需要将计时器逻辑与“游戏结束”逻辑分开，因为计时器应该滴答作响：

```
var secondsLeft = 30;
var timerElement = $('#timer');

(function timer() {
    timerElement.text(secondsLeft);
    secondsLeft--;

    if (secondsLeft !== 0) {
        setTimeout(function () {
            timer();
        }, 1000);
    }
}()); 
```

[http://jsfiddle.net/cFKHq/14/](http://jsfiddle.net/cFKHq/14/)

请注意，在此解决方案中，30 * 1 秒计时器倒计时和 30 秒游戏玩法不相关或相互依赖，如果用户使用慢速机器，这可能会导致一些同步问题。

# php - 如何要求用户喜欢 facebook 粉丝页面以使下载按钮可见？

> ID：13031288
> 
> 赞同：0
> 
> 时间：2012-10-23T13:16:02.930
> 
> 标签：php, facebook

我想创建一个有下载链接的页面。这仅对在 facebook 上喜欢我的粉丝页面的用户可见。否则它会显示为按钮。

我正在使用以下代码，但它

```
 <?php

include_once("php/src/facebook.php");

    // Create our Application instance.
    $facebook = new Facebook(array(
      'appId'  => '354967071210221',
      'secret' => 'APP_Secret',
      'cookie' => true,
    ));

$signed_request = $facebook->getSignedRequest();

// Return you the Page like status
$like_status = $signed_request["page"]["liked"];

if($like_status)
{
    echo 'User Liked the page';
    // Place some content you wanna show to user

}else{
    echo 'User do not liked the page';
    // Place some content that encourage user to like the page
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T14:21:42.030

您可以使用 FQL 查询获取此信息

1) 找出你的 page_id

```
SELECT page_id, pic FROM page WHERE username="grasphub" 
```

（它说你的 page_id 是 354967071210221）

2）使用此查询检查用户是否喜欢您的页面

```
SELECT page_id FROM page_fan WHERE page_id=354967071210221 AND uid = me() 
```

如果用户还不喜欢您的页面，此查询将返回空结果。

因此，您的代码将是：

```
include_once("php/src/facebook.php");

// Create our Application instance.
$facebook = new Facebook(array(
    'appId'  => '354967071210221',
    'secret' => 'APP_Secret',
    'cookie' => true,
));

$user = $facebook->getUser();
if ($user) { // Checks if there is already a logged in user
    try {
        $result = $facebook->api( array(
            'method' => 'fql.query',
            'query' => 'SELECT page_id FROM page_fan WHERE page_id=354967071210221 AND uid = me()',
        ));

        if (!empty($result[0]['page_id'])) {
            echo 'User Liked the page';
        } else {
            echo 'User do not liked the page';
        }
    } catch (FacebookApiException $e) {
        error_log($e);
        $user = null;
    }
} else { //Ask for bare minimum login
    $login_url = $facebook->getLoginUrl();
    header("Location: ".$login_url);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T18:09:23.030

This could be done using graph API .edge.create listens to the click event of like button.

```
FB.Event.subscribe('edge.create',function(response) 
{

     download();
});

FB.api("me/likes/page_id", function(response) 
{
              if ( response.data.length == 1 ) 
             { 

              //Has liked the page
              } else 
              {
               //Havent liked the page  
 }}); 
```

source and download script - [http://www.webtuts.info/webdevelopment/facebook-download-script-2/225/](http://www.webtuts.info/webdevelopment/facebook-download-script-2/225/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:24:04.903

首先尝试

```
$signed_request = $facebook->getSignedRequest();
print_r($signed_request); 
```

如果它是空的或不包含正确的数据，您应该检查您的应用程序设置（画布 url、标签 url 等）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T13:53:41.383

您有两个选项客户端或服务器端：

这是一个链接到一个伟大的客户端脚本教程
[http://www.saschakimmel.com/2010/05/how-to-capture-clicks-on-the-facebook -like-button/](http://www.saschakimmel.com/2010/05/how-to-capture-clicks-on-the-facebook-like-button/)

对于服务器端 - 您需要获得用户的许可才能访问他/她的喜欢 - 我不使用 FB SDK，我编写了自己的代码： - 首先用户必须使用此 URL 登录：

`$loginUrl = "https://www.facebook.com/dialog/oauth?client_id={$appId}&redirect_uri= {$redirectUri}&scope={$scopeEncoded}"`;

*   当用户登录时，FB 会询问是否授予此应用访问 Likes 的权限
*   接受 & 重定向后，使用 $code = $_GET['code'] 获取 url 中的代码
*   最后一步是获取令牌，你需要使用 curl 向这个 URL 发出请求

`$url = "https://graph.facebook.com/oauth/access_token?client_id={$appId}&redirect_uri={$redirectUri}&client_secret={$secretKey}&code={$code}";`

*   现在，您有了可以使用此 URL 向喜欢的用户发出 curl 请求的令牌：`https://graph.facebook.com/me/likes?access_token=$accessToken`

*   遍历喜欢并找出用户是否喜欢您的页面或使用此 URL：

    $url = "https://graph.facebook.com/me/likes/{$yourpageId}/?access_token={$accessToken}";

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-23T13:19:05.303

如果此代码有效

如果你可以在里面设置显示你的文件

```
if($like_status)
{
    echo 'User Liked the page';
    // Place some content you wanna show to user
} 
```

测试它！

喜欢/与您的 FB 页面不同，并检查页面将返回的内容，如果它为您提供不同的价值，那么它的工作和在此内部如果您知道用户喜欢您的页面..

# android - Android Webview - 上传

> ID：13031294
> 
> 赞同：0
> 
> 时间：2012-10-23T13:16:29.640
> 
> 标签：android, webview, webchromeclient

我已经看到了[这里](https://stackoverflow.com/questions/5907369/file-upload-in-webview)提到的解决方案，但我不知道如何使它与我的代码一起工作。这是代码（显示带有文件上传的简单页面）。我的应用应该与 Android 2.3-4.1 兼容

```
package com.myapp.test;

import android.app.Activity;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.view.Window;
import android.view.WindowManager;
import android.webkit.CookieSyncManager;
import android.webkit.ValueCallback;
import android.webkit.WebChromeClient;
import android.webkit.WebView;
import android.webkit.WebViewClient;

public class MainActivity extends Activity {
    @Override
    public void onBackPressed() {
    }   

    private ValueCallback<Uri> mUploadMessage;
    private final static int FILECHOOSER_RESULTCODE = 1;

    @Override
    protected void onActivityResult(int requestCode, int resultCode,
            Intent intent) {
        if (requestCode == FILECHOOSER_RESULTCODE) {
            if (null == mUploadMessage)
                return;
            Uri result = intent == null || resultCode != RESULT_OK ? null
                    : intent.getData();
            mUploadMessage.onReceiveValue(result);
            mUploadMessage = null;

        }
    }

    private WebView webView;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        //getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN);
        setContentView(R.layout.activity_main);
        CookieSyncManager.createInstance(this);
        CookieSyncManager.getInstance().startSync();
        webView = (WebView) findViewById(R.id.webView1);
        webView.getSettings().setJavaScriptEnabled(true);
        //webView.getSettings().setUserAgentString("Mozilla/5.0 (iPad; U; CPU OS 3_2 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) version/4.0.4 Mobile/7B367 Safari/531.21.10");
         webView.setWebChromeClient(new WebChromeClient()
          {
                 //The undocumented magic method override
                 //Eclipse will swear at you if you try to put @Override here
                 public void openFileChooser(ValueCallback<Uri> uploadMsg) {

                  mUploadMessage = uploadMsg;
                  Intent i = new Intent(Intent.ACTION_GET_CONTENT);
                  i.addCategory(Intent.CATEGORY_OPENABLE);
                  i.setType("image/*");
                  MainActivity.this.startActivityForResult(Intent.createChooser(i,"File Chooser"), FILECHOOSER_RESULTCODE);

                 }
          });

        webView.loadUrl("http://encodable.com/uploaddemo/");
        webView.setWebViewClient(new MyWebViewClient());
        }
    private class MyWebViewClient extends WebViewClient {
         @Override
         public boolean shouldOverrideUrlLoading(WebView view, String url) {
            return false;
        }

    }

    class MyWebChromeClient extends WebChromeClient {
        // The undocumented magic method override
        // Eclipse will swear at you if you try to put @Override here
        public void openFileChooser(ValueCallback<Uri> uploadMsg) {

            mUploadMessage = uploadMsg;
            Intent i = new Intent(Intent.ACTION_GET_CONTENT);
            i.addCategory(Intent.CATEGORY_OPENABLE);
            i.setType("image/*");
            MainActivity.this.startActivityForResult(
                    Intent.createChooser(i, "Image Browser"),
                    FILECHOOSER_RESULTCODE);
        }

}

} 
```

我无法打开文件选择器。

有任何想法吗？我有点绝望，我做错了什么......

# python - 如何构造 Python 函数以使其在出错后继续？

> ID：13031296
> 
> 赞同：0
> 
> 时间：2012-10-23T13:16:43.413
> 
> 标签：python, html-parsing, beautifulsoup

我是 Python 新手，在 StackOverflow 的帮助下，我编写了一个程序：

1) 在给定目录中查找，并针对该目录中的每个文件：

2) 运行一个 HTML 清理程序，它：

*   用 BeautifulSoup 打开每个文件
*   删除列入黑名单的标签和内容
*   美化剩余内容
*   运行 Bleach 以删除所有未列入白名单的标签和属性
*   另存为新文件

它工作得很好，除了当它遇到某种文件内容时抛出一堆 BeautifulSoup 错误并中止整个事情。我希望它对此具有强大的抵抗力，因为我无法控制此目录中的内容类型。

所以，我的问题是：**我如何重新构建程序，以便当它在目录中的一个文件上出错时，它报告它无法处理该文件，然后继续运行剩余的文件？**

到目前为止，这是我的代码（删除了无关的细节）：

```
def clean_dir(directory):
    os.chdir(directory)

    for filename in os.listdir(directory):
    clean_file(filename)

def clean_file(filename):

    tag_black_list = ['iframe', 'script']
    tag_white_list = ['p', 'div']
    attr_white_list = {'*': ['title']}

    with open(filename, 'r') as fhandle: 

        text = BeautifulSoup(fhandle)
        text.encode("utf-8")
        print "Opened "+ filename

        # Step one, with BeautifulSoup: Remove tags in tag_black_list, destroy contents.
        [s.decompose() for s in text(tag_black_list)]
        pretty = (text.prettify())
        print "Prettified"

        # Step two, with Bleach: Remove tags and attributes not in whitelists, leave tag contents.
        cleaned = bleach.clean(pretty, strip="TRUE", attributes=attr_white_list, tags=tag_white_list)

        fout = open("../posts-cleaned/"+filename, "w")
        fout.write(cleaned.encode("utf-8"))
        fout.close()

    print "Saved " + filename +" in /posts-cleaned"

print "Done"

clean_dir("../posts/") 
```

我正在寻找有关如何编写它的任何指导，以便它在 clean_file 函数中遇到解析/编码/内容/属性/等错误后继续运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:19:10.997

您可以使用以下方法处理**错误**：**[try-except-finally](http://docs.python.org/tutorial/errors.html)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:55:37.040

您可以在内部`clean_file`或 for 循环中进行错误处理。

```
for filename in os.listdir(directory):
    try:
        clean_file(filename)
    except:
        print "Error processing file %s" % filename 
```

如果您知道引发了什么异常，则可以使用更具体的 catch。

# html - HTML5 调用本机应用程序（ios 和 android）

> ID：13031299
> 
> 赞同：0
> 
> 时间：2012-10-23T13:16:57.643
> 
> 标签：html

我有 2 个移动应用程序。一个使用 HTML5 开发，另一个使用本机代码。是否可以使用移动应用程序（HTML5）来调用另一个移动应用程序（本机代码）？任何人都可以提供一个例子或链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:22:04.177

使用[URI](http://en.wikipedia.org/wiki/Uniform_resource_identifier)方案。例如，这会打开 iBooks 应用程序。

```
<a href="ibooks://">Link</a> 
```

[这是本机应用程序的列表](http://wiki.akosma.com/IPhone_URL_Schemes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-11T12:21:57.130

能够解决遇到的问题。它需要更改 plist 文件和 android manifest.xml 以使其工作。

# wpf - 使 SizeToContent 考虑 Title

> ID：13031307
> 
> 赞同：2
> 
> 时间：2012-10-23T13:17:15.347
> 
> 标签：wpf, xaml, resize, title, sizetocontent

这是一个非常简单的 WPF 窗口的 XAML 代码：

```
<Window x:Class="TitleTester.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Long, verbose, unabridged title" SizeToContent="WidthAndHeight">
    <Grid>
        <Label>Short text</Label>
    </Grid>
</Window> 
```

当我打开这个窗口时，文本`Short text`会完整显示；但是，标题栏只显示`L...`（的第一个字母`Long, verbose, unabridged title`）。我希望打开的窗口足够宽以显示完整标题，而不是更宽。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:47:54.800

该线程应该可以帮助您解决问题：[http ://social.msdn.microsoft.com/Forums/en/wpf/thread/b9ea5bf1-04f2-47c9-bf7c-a2a804e105a4](http://social.msdn.microsoft.com/Forums/en/wpf/thread/b9ea5bf1-04f2-47c9-bf7c-a2a804e105a4)

# c# - .NET 调查应用程序中的自定义问题

> ID：13031310
> 
> 赞同：0
> 
> 时间：2012-10-23T13:17:22.087
> 
> 标签：c#, asp.net, sql-server

我正在尝试找到创建调查应用程序的最佳解决方案，该应用程序允许用户在管理员部分中选择他们的问题。

如果我有一个提出问题的前端网页，当他们回答问题时，我会将答案保存在数据库中。现在，如果我的“FinishedSurvey”表中的列与问题匹配，那就太好了。但是，我想要的是能够允许用户选择他们的问题，这样当他们登录时，他们会看到他们的问题，并且在提交时，这些答案会与这些问题一起保存以供将来检索。

这个问题涉及到任何应用程序，在这些应用程序中，您需要允许人们在您不知情的情况下更改数据库中存储的内容。

过去我做过这样的事情，我说过 20 个 int 列和 20 个 varchar 列具有通用名称，配置文件映射到特定的客户配置。假设 varCharColumn1 映射到“你叫什么名字？”。然而，这很混乱，不是真正可扩展的，而且浪费了存储空间。

这个应用程序将有成千上万的用户，他们都会用不同的输入方法和不同的答案格式提出不同的问题。有些可能需要带有固定答案、日历、10 个字符的自由文本、1000 个字符的自由文本和数字的下拉菜单。

可能有一个简单的答案或方法，甚至是我不熟悉的技术来做到这一点，但是我真的想不出一个简单的方法。

这个特定的应用程序是一个带有 MsSQL 数据库的 ASP.NET 4.0 网站。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:21:42.603

> 列 [...] 匹配问题 [...] 20 个 int 列和 20 个 varchar 列 [...] 但是这很混乱，不能真正扩展，并且浪费存储空间。

你是对的。拿起一本关于数据库规范化的书。如果有人想要一份有一百个问题的调查怎么办？你会说*“我们不能”*，还是会推出一个创建一百列的更新？

我想我会这样做：假设您在顶层有一个问卷表：

```
ID | Description
-------------------------
 1 | 'Test questionnaire' 
```

创建一个由 Questions 组成的表，例如：

```
ID | QuestionnaireID | Question        | ( Other options like 'IsMandatory')
----------------------------------------------------------------------------
 1 |               1 | 'Test question' | 
```

然后创建一个 Answers 表：

```
ID | QuestionID | Answer          | IsUserSpecified
---------------------------------------------------
 1 |          1 | 'Test answer 1' |               0 
 2 |          1 | 'Test answer 2' |               0
 3 |          1 | 'Other...'      |               1 
```

然后创建一个包含已回答问题的响应表：

```
ID | UserID | AnswerID | AnswerValue
----------------------------------------------------------------------------
 1 |      1 |        1 | 
 1 |      2 |        3 | 'I was entered by the user' 
```

你完成了。您可以让用户输入一个 AnswerValue，就像他们可以输入自己的值一样，例如*“Other...”*答案。

不幸的是，这不涉及给定答案的类型。我认为，但我没有时间思考和/或测试它，您可以将类型列添加到 Answers 和 Response 表（如`VarCharValue`、`DateTimeValue`、`IntValue`...）。然后，您必须在 Answers 表中注册可以为答案输入什么类型的值并填写/读取相应的列。不过，那个设计仍然有味道。

# sphinx - 通过 mysql 协议连接到 Sphinx 导致“未选择数据库”错误

> ID：13031313
> 
> 赞同：2
> 
> 时间：2012-10-23T13:17:31.373
> 
> 标签：sphinx, mysql

我尝试连接到一个正在运行的 sphinx 实例，它连接正常：

```
XXX@XXX:~$ mysql -P 9306
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 52
Server version: 5.5.24-0ubuntu0.12.04.1 (Ubuntu)

Copyright (c) 2000, 2011, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> 
```

但是不能执行 SELECT。我收到“未选择数据库”错误。然后我试图杀死 sphinxd 并且在杀死它之后我无法连接到端口 9306，所以我假设我连接正常......为什么我不能从索引中选择数据？我多次确认，索引存在并且可以搜索。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T13:21:59.260

我找到了原因。如果您仔细查看服务器版本，您将看到：

```
 Server version: 5.5.24-0ubuntu0.12.04.1 (Ubuntu) 
```

所以我连接到 Mysql 而不是 sphinx。为什么？因为我没有指定主机，它在'/var/run/mysqld/mysqld.sock'使用了mysql套接字。您需要正确指定主机：

```
XXX@XXX:~$ mysql -P 9306 -h 127.0.0.1
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 1
Server version: 2.0.5-id64-release (r3308)

Copyright (c) 2000, 2011, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> 
```

# jquery - 没有在浏览器中向下滚动就不会触发 jQuery UI 事件

> ID：13031319
> 
> 赞同：0
> 
> 时间：2012-10-23T13:17:54.613
> 
> 标签：jquery, jquery-ui

除非网页从顶部向下滚动少量，否则 jQuery UI 'dblclick' 事件将无法触发。向下滚动允许触发事件，但滚动回页面顶部会重新引入问题。

```
<!DOCTYPE HTML>
<html>
<head>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.0/themes/base/jquery-ui.css" />
    <style>
        #selectableTiles .ui-selected
        {
            background: black;
            color: white;
        }

        #selectableTiles
        {
            list-style-type: none;
            margin: 50 auto;
            padding: 0;
        }

        #selectableTiles li
        {
            margin: 5px;
            padding: 5px;
            float: left;
            width: 150px;
            height: 150px;
            text-align: center;
        }
    </style>
    <script src="http://code.jquery.com/jquery-1.8.2.js"></script>
    <script src="http://code.jquery.com/ui/1.9.0/jquery-ui.js"></script>
</head>
<body>
    <div id="dialog-confirm" title="">
        <p style="text-align:center; margin-left: 10px; margin-right: 10px">
            You must have scrolled down.
        </p>
    </div>
    <ul id="selectableTiles">
        <li class="ui-state-default">1</li>
        <li class="ui-state-default">2</li>
        <li class="ui-state-default">3</li>
        <li class="ui-state-default">4</li>
        <li class="ui-state-default">5</li>
        <li class="ui-state-default">6</li>
        <li class="ui-state-default">7</li>
        <li class="ui-state-default">8</li>
        <li class="ui-state-default">9</li>
        <li class="ui-state-default">10</li>
    </ul>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#selectableTiles").selectable();
        });
        $("#dialog-confirm").dialog({
            autoOpen: false,
            resizable: false
            modal: true,
            buttons: {
                OK: function () {
                    $(this).dialog("close");
                }
            }
        });
        $(".ui-state-default").dblclick(function (event) {
            $("#dialog-confirm").dialog("option", "title", event.target.textContent);
            $("#dialog-confirm").dialog("open");
        });
    </script>
    <p class="clear">
    </p>
</body>
</html> 
```

[http://jsfiddle.net/NbYDH/](http://jsfiddle.net/NbYDH/)

上面的 JSFiddle 页面在 IE 中重新创建了该问题。要重新创建 Firefox 的问题，请右键单击右下角的结果面板。选择'This Frame' -> 'Show Only This Frame'（您可能必须缩小浏览器窗口的大小以引入滚动条）。我不知道其他浏览器。

您会发现，如果滚动条略低于页面顶部，则双击其中一个面板只会启动一个对话框。这是一个描述和重现的奇怪问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T19:04:59.147

在对我进行了一些调查后，`selectable()`我遇到了[这篇 SO 文章](https://stackoverflow.com/a/7907812/474535) ，我将它与[你的小提琴](http://jsfiddle.net/NbYDH/4/)结合起来，它就可以工作了。请注意，我将所有内容都放在一个`document.ready()`.

根据[文档](http://api.jqueryui.com/selectable/#option-cancel)，`cancel`如果您从与选择器匹配的元素开始，则会阻止选择。但是，它需要另一个`click`事件处理程序才能再次取消选择这些东西。

在适合您情况的代码下方

```
$("#selectableTiles").selectable(
    {cancel: '.ui-selected'}
);
$(document).on('click','.ui-selected',function() {
   $(this)
    .removeClass('ui-selected')
    .trigger('selectablestop');
}); 
```

# jquery - 如何获取另一个数组jquery的第一个循环的索引

> ID：13031322
> 
> 赞同：1
> 
> 时间：2012-10-23T13:18:04.027
> 
> 标签：jquery

我正在尝试访问 foreach 循环的索引以访问第二个元素

```
$.each("input:checkbox[name=city[]]:checked", function (index, item) {
    var category = $('select[name="category[]["' + index + '"]"]').val();
    alert(category);
    var split = category = category.split('_');
    var category = split[0];
    if (category == "0") {
        alert('Please select hotel category');
        validate = "false";
        return false;
    }
    else {
        validate = "true";
    }
}); 
```

这是我的html

```
<select name="category[]" 
         id="webmenus_<?php echo $BPackageCityRelatedToCountry[$i]['city_id']; ?>"      
         onchange="showValue(this.value)"
 >
     <option value="0" selected="selected" title="Please select hotel category"></option>
     <option value="5_<?php echo $BPackageCityRelatedToCountry[$i]['city_id']; ?>" title="/public/front_end/images/5star.png"></option>
     <option value="4_<?php echo $BPackageCityRelatedToCountry[$i]['city_id']; ?>" title="/public/front_end/images/4star.png"></option>
     <option value="3_<?php echo $BPackageCityRelatedToCountry[$i]['city_id']; ?>" title="/public/front_end/images/3star.png"></option>
     <option value="2_<?php echo $BPackageCityRelatedToCountry[$i]['city_id']; ?>" title="/public/front_end/images/2star.png"></option>
     <option value="1_<?php echo $BPackageCityRelatedToCountry[$i]['city_id']; ?>" title="/public/front_end/images/1star.png"></option>
</select> 
```

但我越来越不确定。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:22:58.537

我怀疑问题不是未定义的索引，而是选择器中多余的双引号，请尝试删除它们：

```
var category = $('select[name="category[][' + index + ']"]').val(); 
```

使用您的原始语法，选择器看起来像`select[name="category[]["0"]"]`，由于未转义的嵌套双引号，这是无效的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T11:45:19.817

我通过对城市和类别使用 foreach 循环来解决它。

```
 $("input:checkbox[name='city[]']:checked").each(function(j){
                var city=$(this);
                $('select[name="category[]"]').each(function(i){
                    if(i==j){
                        if($(this).val()=="0"){
                            alert("Please select hotel category");
                            city.click();
                            city.attr('checked', true);
                            validate="false";
                            return false;
                        }
                        else
                        {
                            validate="true";
                        }
                    }
                }); 
                if(validate=="false"){
                    return false;
                }
            }); 
```

谢谢大家，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:32:17.227

如果您有许多`city[]`复选框，每个复选框都有一个相应的`category[]`选择，那么您的代码**不会** 给您想要的... `index`in`$.each`指的是元素相对于选择器的索引，而不是相对于页面的索引。（如果我的假设有误，请澄清您的问题，例如也发布您的 html 代码）

选择相关字段的更好方法是找到一个共同的父项，然后在其上搜索特定的类。例如，如果您的标记如下：

```
<ul>
    <li>
        <input type="checkbox" name="city[]" />
        ...
        <select name="category[]">...</select>
    </li>
    <li> ... </li>
    ...
</ul> 
```

您可以`select`使用以下方法查询权限：

```
$.each("input:checkbox[name=city[]]:checked", function (index, item) {
    var category = $(this).closest("li").find('select[name="category[]"]').val();
    ... 
```

# rally - 当有两个以上 AND 子句时，多子句 AND 查询不起作用

> ID：13031325
> 
> 赞同：2
> 
> 时间：2012-10-23T13:18:12.833
> 
> 标签：rally

我为我的公司创建了一个自定义应用程序，只要其中只有两个字段，查询就可以正常工作，一旦添加第三个字段，它就不会返回任何记录：

作为参考，我正在查询故事和缺陷：

```
 var query = [];
var queryCriteria = buildQueryFilter(STORIES);
query[0] = {
    key   : STORIES,
    type  : "HierarchicalRequirement",
    fetch : "FormattedID,Name,Owner,SubProject,CreationDate,Release,Iteration,ScheduleState,State,Build,Parent",
    order : "FormattedID",
    query : queryCriteria
};

var queryCriteria = buildQueryFilter(DEFECTS);
if (!(showUserStoriesOnly)){
    query[1] = {
        key   : DEFECTS,
        type  : "defects",
        fetch : "FormattedID,Name,Owner,SubProject,CreationDate,Release,Iteration,ScheduleState,State,FixedInBuild,Requirement",
        order : "FormattedID",
        query : queryCriteria
    };
}

rallyDataSource.findAll(query, showResults); 
```

**编辑**：这是 buildQueryFilter 的一些“缩写”代码：

```
returnFilter += returnFilter.length === 0 ? '' : ' AND '
returnFilter += '(Iteration.Name = "' + filterIteration + '")';

returnFilter += returnFilter.length === 0 ? '' : ' AND '
returnFilter += '(ScheduleState = "' + filterScheduleState + '")';

returnFilter += returnFilter.length === 0 ? '' : ' AND '
returnFilter += '(Owner = \"__USER_NAME__\")';

returnFilter = '(' + returnFilter + ')'; 
```

当“queryCriteria”为：

**查询（故事）：** ((Iteration.Name = "25 (10/02 - 10/16)") AND (ScheduleState = "Accepted"))

**查询（缺陷）：** ((Iteration.Name = "25 (10/02 - 10/16)") AND (ScheduleState = "Accepted"))

有用。但是，一旦我添加了**第三个**字段 - 无论哪个字段或什么顺序都无关紧要 - 然后它就不再起作用了：

**查询（故事）：** ((Iteration.Name = "25 (10/02 - 10/16)") AND (ScheduleState = "Accepted") AND (Owner = "user@domain.com"))

**查询（缺陷）：** ((Iteration.Name = "25 (10/02 - 10/16)") AND (ScheduleState = "Accepted") AND (Owner = "user@domain.com"))

我一直在查看文档，这应该可以工作。我不确定为什么不是。有人有线索吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:50:59.847

使用[rally.sdk.util.Query](http://developer.rallydev.com/help/query)实用程序应该可以帮助您构建有效的查询（在大型查询中使用所有嵌套的 () 语法会变得非常难以阅读）。

```
var queries = [
    'Iteration.Name = "' + filterIteration + '"',
    'ScheduleState = "' + filterScheduleState + '",
    'Owner = "__USER_NAME__"'
];
var queryFilter = rally.sdk.util.Query.and(queries);
var queryString = queryFilter.toString();

//queryString should be this:
//(((Iteration.Name = "25 (10/02 - 10/16)") AND (ScheduleState = "Accepted")) AND (Owner = "user@domain.com")) 
```

# c# - 更改菜单项上的内容控制模板单击？

> ID：13031326
> 
> 赞同：0
> 
> 时间：2012-10-23T13:18:13.863
> 
> 标签：c#, wpf, menuitem, contentcontrol

您能否告诉我如何在 WPF 中单击不同的菜单项标题时更改内容模板。我已经定义了可以将其作为模板的用户控件。

例如：菜单项是：Home、Players、Team。当我单击主页时，我希望在我的内容控件中弹出该特定模板，当我单击播放器时，我希望在内容控件中弹出另一个模板（播放器列表）作为模板。

如何使用 XAML 中的触发器做到这一点？

非常感谢你 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T15:01:16.310

您可以使用 a`ContentControl`来托管您的任何内容，并`ContentControl.ContentTemplate`根据您想要绘制内容的方式进行设置。

作为一个非常基本的例子，

```
<ContentControl x:Name="MyContentControl">
    <ContentControl.Style>
        <Style TargetType="{x:Type ContentControl}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding }" Value="Home">
                    <Setter Property="ContentTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                <local:MyHomeUsercontrol />
                            </DataTemplate>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
                <DataTrigger Binding="{Binding }" Value="Players">
                    <Setter Property="ContentTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                <local:MyPlayersUsercontrol />
                            </DataTemplate>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
                <DataTrigger Binding="{Binding }" Value="Team">
                    <Setter Property="ContentTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                <local:MyTeamUsercontrol />
                            </DataTemplate>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
        </Style>
    </ContentControl.Style>
</ContentControl> 
```

并且在`MenuItem.Click`

```
MyContentControl.Content = "Home"; // or "Players" or "Team" 
```

在此示例中，我将a`string`用于班级`ContentControl.Content``HomeViewModel``PlayersViewModel`

```
<Window.Resources>
    <DataTemplate DataType="{x:Type HomeViewModel}">
        <local:MyHomeUserControl />
    </DataTemplate>
    <DataTemplate DataType="{x:Type PlayersViewModel}">
        <local:MyPlayersUserControl />
    </DataTemplate>
    <DataTemplate DataType="{x:Type TeamViewmModel}">
        <local:MyTeamUserControl />
    </DataTemplate>
</Window.Resources>

<ContentControl x:Name="MyContentControl" /> 
```

和

```
MyContentControl.Content = new HomeViewModel(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T14:10:17.553

使用选项卡控件并在顶部放置选项卡怎么样？那样会干净得多..

编辑; 例子：

```
 <TabControl>
        <TabItem>
            <TabItem.Header>
                <TextBlock Text="Football header!"/>
            </TabItem.Header>
            <TabItem.Content>
                <Button Content="Push for football!"/>
            </TabItem.Content>
        </TabItem>
    </TabControl> 
```

这也可能有帮助；[http://www.switchonthecode.com/tutorials/the-wpf-tab-control-inside-and-out](http://www.switchonthecode.com/tutorials/the-wpf-tab-control-inside-and-out)

# c++ - 奇怪的重复模板模式：双重继承

> ID：13031327
> 
> 赞同：2
> 
> 时间：2012-10-23T13:18:14.520
> 
> 标签：c++, oop, design-patterns, inheritance, crtp

我有以下内容：

```
class Base
{
protected:
    std::string _name;

public:
    virtual ~Base(){}

    const std::string &name;

    Base()
        : _name ("(no name)")
        , name(_name)
    {}
};

template <typename T>
class BaseH : public Base
{
public:
    virtual ~BaseH() {}
    BaseH() : Base() {}

    T& operator~(){ ; return static_cast<T&>(*this);}
};

class One : public BaseH<One>
{
public:
    One() : BaseH<One>() { _name = "One"; }

};

class Two
    : public One
    , public BaseH<Two>
{
public:
    Two() : BaseH<Two>() { _name = "Two"; }

};

int main(int argc, char *argv[])
{
    std::cout << Two().name << std::endl;

    return 0;
} 
```

我想`Two`从`One`and派生`BaseH<Two>`，因为`Two`它是 , 的特化`One`，并且`operator~`in`BaseH`必须始终返回调用它的对象类型的引用。

编译错误显然是：

```
In constructor ‘Two::Two()’:
  error: reference to ‘_name’ is ambiguous
  error: candidates are: std::string Base::_name
  error:                 std::string Base::_name
In function ‘int main(int, char**)’:
  error: request for member ‘name’ is ambiguous
  error: candidates are: const string& Base::name
  error:                 const string& Base::name 
```

在通过构造函数委托设置引用的同时，如何在 and 中创建和`_name`访问`name`？最干净的方法是什么？`One``Two``const`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:23:35.207

看起来你遇到了[钻石问题](https://en.wikipedia.org/wiki/Multiple_inheritance#The_diamond_problem)。你试过[虚拟继承](https://en.wikipedia.org/wiki/Virtual_inheritance)吗？

例如：

```
template <typename T>
class BaseH : virtual public Base
{
    // ...
};

class One : virtual public BaseH<One>
{
    // ...
}; 
```

编辑：进一步阅读钻石问题：[http ://www.cprogramming.com/tutorial/virtual_inheritance.html](http://www.cprogramming.com/tutorial/virtual_inheritance.html)

# unix - 将信息添加到文本文件

> ID：13031334
> 
> 赞同：0
> 
> 时间：2012-10-23T13:18:37.723
> 
> 标签：unix, text, append

我有一个文本文件，我想在文本中间插入更多文本。我有这个输入文本：

```
[etc....] 
relay_recipient_maps =
                btree:/opt/pmx69/postfix/etc/vdm_valid_users_yoda,
                btree:/opt/pmx69/postfix/etc/vdm_valid_users_luke,
                btree:/opt/pmx69/postfix/etc/vdm_valid_users_rd2d2,
                btree:/opt/pmx69/postfix/etc/vdm_valid_users_c3p0,
                btree:/opt/pmx69/postfix/etc/vdm_valid_users_dark_vador 
[etc...] 
```

在最后一行之后，我想在“dark vador line”之后插入 Anakin，但我不知道如何解决我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:34:04.223

这是使用`GNU sed`. 像这样运行：

```
sed -f script.sed file.txt 
```

内容`script.sed`：

```
/relay_recipient_maps =/,/[^,]$/ {

    /relay_recipient_maps =/ n

    /[^,]$/ {
        s/[ \t]*$/,/
        a\                btree:/opt/pmx69/postfix/etc/vdm_valid_users_anakin
    }
} 
```

或者：

```
/relay_recipient_maps =/,/[^,]$/ {

    /btree.*[^,]$/ {
        s/[ \t]*$/,/
        a\                btree:/opt/pmx69/postfix/etc/vdm_valid_users_anakin
    }
} 
```

结果：

```
[etc....] 
relay_recipient_maps =
                btree:/opt/pmx69/postfix/etc/vdm_valid_users_yoda,
                btree:/opt/pmx69/postfix/etc/vdm_valid_users_luke,
                btree:/opt/pmx69/postfix/etc/vdm_valid_users_rd2d2,
                btree:/opt/pmx69/postfix/etc/vdm_valid_users_c3p0,
                btree:/opt/pmx69/postfix/etc/vdm_valid_users_dark_vador,
                btree:/opt/pmx69/postfix/etc/vdm_valid_users_anakin
[etc...] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:21:00.967

取决于您使用的外壳。您可以在 bash、zsh 和其他一些工具中执行此操作：

```
echo "the dark vador line" >> file_with_content.txt 
```

这会将字符串附加到文件的末尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:33:12.857

您可以使用 sed：

```
sed -e '/dark_vador/ s/$/Anakin/' file.txt 
```

对于包含 pattern`dark_vador`的每一行，字符串`Anakin`将附加到行尾。

如果您只想在第一场比赛中这样做，您可以在附加后退出：

```
sed -e '/dark_vador/ { s/$/Anakin/; q }' file.txt 
```

`s`and`q`命令必须组合在一起，以便它们仅在具有 的行上执行，`dark_vador`否则`q`将在读取第一行后退出（即使它不包含`dark_vador`）。

如果您想在该行之后追加一行**，**`dark_vador`可以使用以下`a`命令：

```
sed -e '/dark_vador/ a\
Anakin' file.txt 
```

这将`Anakin`在每一行之后创建一个新行`dark_vador`。如上，如果您只想在第一个匹配后添加一行，则可以退出：

```
sed -e '/dark_vador/ { a\
Anakin
q }' file.txt 
```

希望这会有所帮助=)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T18:05:05.217

这是一个 GNU sed 替代方案：

`sed '/^relay_recipient_maps/,/[^,]$/{/btree:.*[^,]$/s##&,\n btree:/opt/pmx69/postfix/etc/vdm_valid_users_Anakin#}' file.txt`

这个怎么运作：

对于以“relay_recipient_maps”开头的块，以及直到不以逗号结尾的所有后续行，然后用相同的替换不以逗号结尾的“btree：”行（这将是“relay_recipient_maps”块中的最后一个btree）行加“，”和所需的新行。

这假设“relay_recipient_maps”块总是以 btree 结尾：行不以“，”结尾

# java - com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException：'字段列表中的未知列'sequence_next_hi_value'

> ID：13031351
> 
> 赞同：1
> 
> 时间：2012-10-23T13:19:16.160
> 
> 标签：java, mysql, hibernate, jdbc

任何人都可以说出导致此错误的原因吗？

```
com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: 
Unknown column 'sequence_next_hi_value' in 'field list 
```

我正在`mysql`使用`hibernate`. 我能够连接到数据库并且一切正常，直到我更改`persistence.xml`并添加了`datasource`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-29T20:56:24.777

该问题与您的实体使用的标识符生成类型有关。

确保您提供了以下注释和参数：

```
@GeneratedValue(strategy = GenerationType.TABLE, generator="name_of_the_generator")
@TableGenerator( name = "name_of_the_generator", table = "table_with_keys", pkColumnName = "PK_NAME", valueColumnName = "PK_VALUE") 
```

我的猜测是您将**valueColumnName**与**pkColumnValue**混合在一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-31T08:41:23.323

我有同样的问题，我的解决方案是将 GenerationType 从`@GeneratedValue`主键策略更改为`GenerationType.IDENTITY`休眠 5 和 MySQL 作为 DB

# telerik-mvc - 带有长文本的 Telerik 条形图 x 轴

> ID：13031352
> 
> 赞同：0
> 
> 时间：2012-10-23T13:19:21.373
> 
> 标签：telerik-mvc

我正在我的 mvc 应用程序中尝试 Telerik 条形图。x 轴标签上的文本有时会很长，然后它们会重叠。我该如何解决这个问题？我可以为此使用工具提示吗？以及如何为每个栏设置工具提示文本？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:56:15.890

您可以通过添加`Tooltip(true)`如下方式添加工具提示：

```
 Html.Telerik().Chart()
           .Name("chart")
           .Theme("vista")
           .Series( series => series
                        .Bar( /*data*/)                   
           .CategoryAxis( axis => axis
                    .Categories(  /*data*/)
           .Tooltip(true) 
```

这将在悬停时显示系列（x 轴）的值。

我知道您可以通过执行以下操作来旋转类别轴上的标签：

```
.CategoryAxis( axis =>
{
    axis.Categories( /*data*/ );
    axis.Labels(labels => labels.Rotation(45));//this rotates 45 degrees (you can use whatever value you want)
} 
```

但我认为 Label 方法在 Series 上不可用。您可以考虑翻转系列和轴（如果这对您的数据仍然有意义）。您还可以考虑格式化（缩写）x 轴标签并添加您自己的图例。

# java - OpenCV Mat 处理时间

> ID：13031357
> 
> 赞同：5
> 
> 时间：2012-10-23T13:19:37.513
> 
> 标签：java, android, image-processing, opencv, matrix

我想知道 OpenCV 函数的 src （源）和 dst （目标）的不同变量是否会对处理时间产生影响。我在下面有两个功能可以做同样的事情。

```
public static Mat getY(Mat m){
    Mat mMattemp = new Mat();
    Imgproc.cvtColor(m,mMattemp,Imgproc.COLOR_YUV420sp2RGB);
    Imgproc.cvtColor(mMattemp,mMattemp, Imgproc.COLOR_RGB2HSV);
    Core.inRange(mMattemp, new Scalar(20, 100, 100), new Scalar(30, 255, 255), mMattemp);
    return mMattemp;
} 
```

相对

```
public static Mat getY(Mat m){
    Mat mMattemp_rgb = new Mat();
    Mat mMattemp_hsv = new Mat();
    Mat mMattemp_ir = new Mat();
    Imgproc.cvtColor(m,mMattemp_rgb,Imgproc.COLOR_YUV420sp2RGB);
    Imgproc.cvtColor(mMattemp_rgb,mMattemp_hsv, Imgproc.COLOR_RGB2HSV);
    Core.inRange(mMattemp_hsv, new Scalar(20, 100, 100), new Scalar(30, 255, 255), mMattemp_ir);
    return mMattemp_ir;
} 
```

两者哪个更好？一个比另一个有什么优势？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T00:00:51.270

要确定，只需将您的`getY`方法调用夹在 OpenCV 的内置方法之间`double getTickCount()`，`double getTickFrequency()`就像这样（需要翻译成 java）：

```
//first uniquely name the algorithms to compare (here just getY_TypeA and getY_TypeB)
double durationA = cv::getTickCount();

getY_TypeA(image); // the function to be tested

durationA = cv::getTickCount()-durationA;
durationA /= cv::getTickFrequency(); // the elapsed time in ms

//now call the other method

double durationB = cv::getTickCount();

getY_TypeB(image); // the function to be tested

durationB = cv::getTickCount()-durationB;
durationB /= cv::getTickFrequency(); // the elapsed time in ms

printf("Type A runtime: "+durationA+" Type B runtime: "+durationB); 
```

为了获得最佳结果，请对多次调用执行此操作并平均结果。

# c# - 更快地上传到数据库

> ID：13031362
> 
> 赞同：2
> 
> 时间：2012-10-23T13:19:57.297
> 
> 标签：c#, sql, sqlcommand

我有一些代码在程序生命结束时将 6 个不同列表的全部内容上传到数据库中。问题是，它们是包含大约 14,000 个项目的并行列表，我必须为每个单独的项目运行插入查询。这需要很长时间，有没有更快的方法来做到这一点？以下是相关代码的示例：

```
 public void uploadContent()
    {
        var cs = Properties.Settings.Default.Database;
        SqlConnection dataConnection = new SqlConnection(cs);
        dataConnection.Open();

        for (int i = 0; i < urlList.Count; i++)
        {
            SqlCommand dataCommand = new SqlCommand(Properties.Settings.Default.CommandString, dataConnection);
            try
            {
                dataCommand.Parameters.AddWithValue("@user", userList[i]);
                dataCommand.Parameters.AddWithValue("@computer", computerList[i]);
                dataCommand.Parameters.AddWithValue("@date", timestampList[i]);
                dataCommand.Parameters.AddWithValue("@itemName", domainList[i]);
                dataCommand.Parameters.AddWithValue("@itemDetails", urlList[i]);
                dataCommand.Parameters.AddWithValue("@timesUsed", hitsList[i]);

                dataCommand.ExecuteNonQuery();
            }
            catch (Exception e)
            {
                using (StreamWriter sw = File.AppendText("errorLog.log"))
                {
                    sw.WriteLine(e);
                }
            }

        }
        dataConnection.Close();
    } 
```

这是代码从配置文件中提取的命令字符串：

命令字符串：

```
INSERT dbo.InternetUsage VALUES (@user, @computer, @date, @itemName, @itemDetails, @timesUsed) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:25:43.250

1.  在 for (int i = 0; i < urlList.Count; i++) 之外创建命令和参数
2.  同时在事务中创建插入
3.  如果可能，创建一个存储过程并将参数作为 DataTable 传递。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T13:41:41.570

正如@alerya 的回答中所述，执行以下操作会有所帮助（在此处添加说明）

**1）在for循环之外创建命令和参数** 由于每次都使用相同的命令，每次都重新创建命令没有意义。除了创建一个新对象（这需要时间）之外，还必须在每次为多个事物（表存在等）创建命令时验证该命令。这引入了很多开销。

**2）将插入放入** 事务中将所有插入放入事务中会加快速度，因为默认情况下，不在事务中的命令将被视为自己的事务。因此，每次插入内容时，数据库服务器都必须验证它刚刚插入的内容是否实际保存（通常在硬盘上，受磁盘速度的限制）。但是，当多个 INSERT 在一个事务中时，只需要执行一次检查。

根据您已经展示的代码，这种方法的缺点是一个错误的 INSERT 会破坏一堆。这是否可以接受取决于您的具体要求。

**除了** 您真正应该做的另一件事（尽管这不会在短期内加快速度）是正确使用 IDisposable 接口。这意味着要么在所有 IDisposable 对象（SqlConnection、SqlCommand）上调用 .Dispose()，或者在理想情况下将它们包装在 using() 块中：

```
using( SqlConnection dataConnection = new SqlConnection(cs) 
{
    //Code goes here
} 
```

这将防止这些点的内存泄漏，如果您的循环变得太大，这将很快成为一个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-23T13:39:02.337

一个一个地向数据库发送 INSERT 命令确实会使整个过程变慢，因为要往返于数据库服务器。如果您担心性能，您应该考虑使用批量插入策略。你可以：

1.  以 BULK INSERT 可以理解的格式生成包含所有信息的平面文件。
2.  使用 BULK INSERT 命令将该文件导入数据库 ( [http://msdn.microsoft.com/en-us/library/ms188365(v=sql.90).aspx](http://msdn.microsoft.com/en-us/library/ms188365%28v=sql.90%29.aspx) )。

附言。我猜当您说 SQL 时，您使用的是 MS SQL Server。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-23T13:31:22.720

为什么不从单独的线程 运行您的*uploadContent()方法。*
这样您就不必担心查询需要多少时间来执行。

# c# - 如何在 Visual Studio Express 2012 中将源代码添加到 .dll 文件？

> ID：13031363
> 
> 赞同：0
> 
> 时间：2012-10-23T13:20:03.023
> 
> 标签：c#, visual-studio, debugging, dll

我还有一个第 3 方 .dll 文件及其源代码（用 C# 编写）。我可以创建一个新项目并添加此 .dll 文件的引用以使用其方法。但是当我调试时，我想进入 .dll 文件中定义的方法（就像我们在 java 中有 .jar 文件及其源代码时所做的那样）。

如何在 Visual Studio Express 中执行此操作（我有 VS 2012）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-23T13:23:16.103

如果您有源代码，最简单的方法是将项目添加到您的解决方案中并同时编译两者。然后你可以到处断点！（你敢告诉我断点不是动词）

# wordpress - WordPress“特色图片”功能损坏 IIS7 安装

> ID：13031364
> 
> 赞同：0
> 
> 时间：2012-10-23T13:20:10.590
> 
> 标签：wordpress, iis, iis-7, windows-server-2003

我们在 Windows Server 2003 和 IIS 7 机器上安装了 WordPress 3.4.2。迁移到 x-NIX 环境是不可能的。

我们有一个外部承包商进来并让大部分工作正常进行，但最后一个问题他已经完全放弃了。

任何试图使用“特色图片”功能的东西都会被破坏。这包括使用“特色图片”功能上传标题图片的主题，以及用于帖子摘录的图片缩略图。

图片上传正常，但在编辑帖子、页面或其他任何地方时，您不能选择使用作为特色图片。

我们已经测试了几个当前的主题，它似乎不是特定于主题的。

如果这是在 linux 机器上，我希望它是文件夹权限问题，但我不知道在这个 IIS 环境中从哪里开始进行故障排除。

任何帮助将不胜感激。如果我可以提供任何进一步的信息，请告诉我。

AK

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T13:29:07.630

我遇到了同样的问题。经过令人难以置信的烦人的故障排除后，我发现我的服务器上没有启用图形库扩展。我不得不在我的 php.ini 文件中取消注释以下行：

扩展=php_gd2.dll

完成更改后，我重新启动了 IIS，所有特色图像都开始正常显示。希望这可以帮助！

# php - Yii：默认范围应用两次以加入查询

> ID：13031366
> 
> 赞同：2
> 
> 时间：2012-10-23T13:20:15.853
> 
> 标签：php, sql, orm, yii

我有两个模型：

```
class Tag extends CActiveRecord {
    //// ......

    public function defaultScope(){ 
        return array(
            'condition' => 'class_name = :class_name',
            'params' => array(':class_name' => get_class($this))
       );
    }

    public function relations(){
        return array(
            'videos' => array(self::MANY_MANY, 'Video', 'tags_videos(tag_id, video_id)')
        );
    }

    //// ......
}

class Video extends CActiveRecord {
    //// .......

    public function relations(){
        return array(
            'tags' => array(self::MANY_MANY, 'Tag', 'tags_videos(video_id, tag_id)')
        );
    }

    //// .......
} 
```

当我这样做时`$video_instance->tags`，我收到了这个错误：

```
 exception 'CDbException' with message 'CDbCommand failed to execute the SQL statement: SQLSTATE[HY093]: Invalid parameter number. The SQL statement executed was: SELECT `tags`.`id` AS `t1_c0`, `tags`.`name` AS `t1_c1`, `tags`.`orig_name` AS `t1_c2`, `tags`.`slug` AS `t1_c3`, `tags`.`flags` AS `t1_c4`, `tags`.`class_name` AS `t1_c5`, `tags`.`created_at` AS `t1_c6` FROM `tags` `tags`  INNER JOIN `tags_videos` `tags_tags` ON (`tags_tags`.`video_id`=:ypl0) AND (`tags`.`id`=`tags_tags`.`tag_id`) AND (class_name = :class_name) WHERE (class_name = :class_name)' in /srv/http/yii-1.1.12.b600af/framework/db/CDbCommand.php:528 
```

我的问题是：为什么我的默认范围两次应用于查询（在 WHERE 和 ON 中），我该如何解决这个问题？

Yii 版本：1.1.12.b600af PHP：5.4.8

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T14:44:00.767

定义`'scopes'=>array( 'resetScope' )`关系

```
public function relations(){
        return array(
            'tags' => array(self::MANY_MANY, 'Tag', 'tags_videos(video_id, tag_id)','scopes'=>array( 'resetScope' ))
        );
} 
```

最近有一个错误，我不确定它是否已在您的版本中修复： [https ://github.com/yiisoft/yii/issues/1197](https://github.com/yiisoft/yii/issues/1197)

更多参考： [http ://www.yiiframework.com/forum/index.php/topic/12025-relation-without-default-scope/](http://www.yiiframework.com/forum/index.php/topic/12025-relation-without-default-scope/)

# c# - .Net SerialPort 在字节可用时花费 0.5 秒以上来读取字节

> ID：13031372
> 
> 赞同：7
> 
> 时间：2012-10-23T13:20:30.357
> 
> 标签：c#, serial-port

我在 C# 中使用 .Net SerialPort 类从端口读取字节。收到 DataReceived 事件后，我检查串行端口以查看是否可以读取字节。但是，即使字节可用，端口也可能需要半秒多的时间来读取单个字节。代码大致如下：

```
...
while(Port.BytesToRead > 0) 
{
    StopWatch.Restart();
    Int32 BytesRead = Port.Read(Read, 0, 1);
    StopWatch.Stop();
    if (StopWatch.ElapsedMilliseconds > 100)
    {
    // Record the time. The stopwatch code
    // was only added after performance issues were observed.
    }
} 
```

请注意，我测量的时间不是读取所有字节的时间，而是读取单个字节的时间。我经常会收到一个 DataReceived 事件，并且必须等待 0.5 秒才能读取第一个字节。

我实际上已经尝试将 Port 的 ReadTimeout 属性设置为更小的值，以防止它无限期地坐在那里，但这个属性似乎被忽略了。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T14:09:57.687

事实证明，连接到调试器的运行导致了问题。在调试器外部运行时，记录读取字节的最长时间约为 20 毫秒，而在调试器内部运行时最长为 700 毫秒（无断点、条件或以其他方式启用）。

有点红鲱鱼，因为运行发布版本时通信问题的真正原因可能在其他地方。

# jquery - jquery validate：如果表单有效，则显示提交按钮

> ID：13031376
> 
> 赞同：4
> 
> 时间：2012-10-23T13:20:46.057
> 
> 标签：jquery, jquery-validate

我有一个基本的空表单，只想显示一次提交按钮：

> 1.  数据已输入表格。
> 2.  所有必填/有效字段均正确。

在表单正确后淡入提交按钮之前。

快速 jsfiddle：http: [//jsfiddle.net/36JZL/](http://jsfiddle.net/36JZL/)

```
<form action="#" method="post">
    <label>Name</label>
    <input type="text" name="name" class="required" value="" />

    <label>Email</label>
    <input type="email" name="email" class="required email" value="" />

    <label>Message</label>
    <textarea name="message" class="required"></textarea>

    <input type="submit" name="save" value="Save" class="hide" />
</form>

$('form').validate(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-23T13:35:57.267

继 Alan Buchanan 的回答之后，这可能有效：

```
$('#yourform input,#yourform textarea').bind('oninput', function(){

    if ($('#yourform').valid()) $('#submitButton').fadeIn();

}); 
```

[- 注释和参考。](https://stackoverflow.com/questions/574941/best-way-to-track-onchange-as-you-type-in-input-type-text)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T13:32:37.320

建议您在表单输入的更改事件上触发一些 javascript，并检查每个是否通过您的验证。如果确实如此，则淡入按钮。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-23T13:31:05.317

jQuery 中没有执行此操作的函数。您需要将事件绑定到此表单的提交或每个字段，并验证所需字段的文本长度，如果都大于 0。那么您可以提交表单或淡入提交按钮。

当您在表单中的任何一个字段中点击输入时，将触发 submnit 事件。

看看这个链接。

[http://api.jquery.com/submit/](http://api.jquery.com/submit/)

# c# - 在哪里保存应用程序日志？

> ID：13031377
> 
> 赞同：4
> 
> 时间：2012-10-23T13:20:45.847
> 
> 标签：c#, windows, events, logging, environment

> **可能重复：**
> [在 Windows 上存储应用程序日志文件的位置](https://stackoverflow.com/questions/1572934/where-to-store-an-application-log-file-on-windows)

Windows 似乎有几个不同的应用程序存储其日志的地方。Windows 服务和一些应用程序使用 Windows 事件日志，其他使用 C:\ProgramData，另一个将它们存储到 C:\Users(Local/System/Public/Default)\AppData/(Roaming/Local)。

我在开发 Windows 服务时注意到这一点，默认（AppData/Roaming）环境变量指向 C:\Windows\System32\Users\system\AppData\Roaming 或其他完全荒谬的位置，所以我想知道是否有任何工作表在那里存储日志的位置：用户应用程序/用户服务/系统服务和更一般的：所有这些应用程序文件夹是什么（什么属于哪里？）

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-23T13:44:14.410

对于用户特定的日志：

*   本地应用程序数据 -`%APPDATA%/Local/...`

对于与用户配置文件相关的用户特定日志：

*   应用数据 -`%APPDATA%/Roaming/...`

对于所有其他日志：

*   CommonApplicationData -`%ALLUSERSPROFILE%/...`

有关其他文件夹，请参阅[Environment.SpecialFolder](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T13:22:26.157

日志的标准位置是`AppData directory`
Using %APPDATA% 如果日志很多或很大，漫游配置文件可能会出现问题：它会减慢他们的登录过程，然后你可以使用目录， `%TEMP%`即 windows tempory director

# c++ - C++ MFC 中未初始化枚举的值

> ID：13031386
> 
> 赞同：1
> 
> 时间：2012-10-23T13:21:08.833
> 
> 标签：c++, enums

如果我有一个包含`enum`成员的类并且该成员未使用任何数据初始化。

我想检查是否已经放置了一些值（我正在为类验证所有成员的验证机制已经初始化），我可以将`enum`成员与什么进行比较？`NULL`? 或者它收到 0（0 就像第一个字段，所以这对任何人都没有好处..）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T13:22:01.480

您无法将未初始化的变量与任何内容进行比较，因为读取它是未定义的行为。

因此，您最安全的选择是将`UNSET`状态保留为 的一部分，将其`enum`初始化为该状态，然后与该状态进行比较。

# asp.net - 是否有从 aspx 读取 web.config 键值的选项？

> ID：13031396
> 
> 赞同：-2
> 
> 时间：2012-10-23T13:21:49.857
> 
> 标签：asp.net, web-config, configurationmanager

检查是否有任何选项可以直接从 aspx 页面读取配置值（我知道如何使用代码隐藏读取）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:23:33.727

您可以使用一些服务器标签在您的 aspx 页面中执行相同的操作，例如

```
<% Dim s as string = System.Configuration.ConfigurationManager.AppSettings("mysetting") %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:28:21.253

您可以使用`ConfigurationManager`和`OBJECT`标签。

**网络配置**

```
</configuration>
    <appSettings>
        <add key="Setting" value="Value"/>
    <appSettings>
</configuration> 
```

**ASPX**

```
<object>
    <param name="Setting" value="<%= System.Configuration.ConfigurationManager.AppSettings["Setting"] %>" />
</object> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:41:17.017

得到了解决方案

```
<%$  appsettings:*KeyName* %> 
```

这里 keyname 是 web.config 中的实际名称，还请注意您需要一个 $ 符号

# c#-4.0 - BigQuery JSON 导入内部错误？

> ID：13031397
> 
> 赞同：0
> 
> 时间：2012-10-23T13:21:53.800
> 
> 标签：c#-4.0, google-bigquery

我在将 JSON 导入 BigQuery 时遇到问题。我们已经创建了服务帐户，并且正在使用定制的 .NET 4 库来进行我们的服务器和 BQ 之间的所有对话。查询工作，工作列表工作，基本上所有获取工作，但通过 JSON 格式上传不起作用。

以下是开始的作业返回的内容：

```
{
 "kind": "bigquery#job",
 "etag": "\"WgwoVdnmFVq0E0riaWM5H0QXabs/R_b3J5b4GjwliMH_X8kjPNLVYsI\"",
 "id": "dot-metrics:job_f7eea1449bb24dffb0a0de1637f31abb",
 "selfLink": "https://www.googleapis.com/bigquery/v2/projects/dot-metrics/jobs/job_f7eea1449bb24dffb0a0de1637f31abb",
 "jobReference": {
  "projectId": "dot-metrics",
  "jobId": "job_f7eea1449bb24dffb0a0de1637f31abb"
 },
 "configuration": {
  "load": {
   "schema": {
    "fields": [
     {
      "name": "word",
      "type": "STRING",
      "mode": "REQUIRED"
     },
     {
      "name": "word_count",
      "type": "INTEGER",
      "mode": "REQUIRED"
     },
     {
      "name": "corpus",
      "type": "STRING",
      "mode": "REQUIRED"
     },
     {
      "name": "corpus_date",
      "type": "INTEGER",
      "mode": "REQUIRED"
     }
    ]
   },
   "destinationTable": {
    "projectId": "dot-metrics",
    "datasetId": "DotMetric_TEST",
    "tableId": "TestTable"
   },
   "writeDisposition": "WRITE_APPEND",
   "allowQuotedNewlines": true,
   "sourceFormat": "NEWLINE_DELIMITED_JSON"
  }
 },
 "status": {
  "state": "DONE",
  "errorResult": {
   "reason": "internalError",
   "message": "Backend error. Job aborted."
  }
 },
 "statistics": {
  "startTime": "1350998303355",
  "endTime": "1350998337446",
  "load": {
   "inputFiles": "1",
   "inputFileBytes": "7359"
  }
 }
} 
```

数据是 JSON 换行符分隔的字符串，如下所示：

```
{"Word":"blah_139","WordCount":6615,"Corpus":"Corpus_678","CorpusDate": 6088201915056}
{"Word":"blah_602","WordCount":2978,"Corpus":"Corpus_493","CorpusDate": 6088201915056}
{"Word":"blah_50","WordCount":8315,"Corpus":"Corpus_360","CorpusDate": 6088201915056}
{"Word":"blah_736","WordCount":8971,"Corpus":"Corpus_751","CorpusDate": 6088201915056}
{"Word":"blah_243","WordCount":2362,"Corpus":"Corpus_174","CorpusDate": 6088201915056}
{"Word":"blah_643","WordCount":765,"Corpus":"Corpus_315","CorpusDate": 6088201915056} 
```

作业运行了一段时间（大约 10 秒），然后就死了。请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T15:30:52.373

好的，看起来您复制了莎士比亚样本表并附加到它。莎士比亚示例模式，因为它是使用更旧版本的 bigquery 从谷歌内部的源数据导入的，所以它的模式有一些缺陷。当我们导入到它时，这些缺陷会导致您的问题（具体来说，我们认为 corpus_date 字段应该是 int32 字段而不是 int64，即使 bigquery 仅支持新数据的 int32）。

如果您执行 write_truncate 而不是 append 并传递新模式，或者导入新表，则不应该遇到此问题。

# image - Magento：如何按标签获取图像？

> ID：13031398
> 
> 赞同：3
> 
> 时间：2012-10-23T13:21:54.090
> 
> 标签：image, magento, view, grid, label

我还有一个问题要问你们：P

在产品网格视图中，当您将鼠标悬停在图像上时，我想更改图像。我也想切换它的图像应该有一个标签名'back'。

我几乎拥有它..：P

当我在 media.phtml 中使用此代码时：

```
<?php $imageByLabel = $_product->getMediaGalleryImages()->getItemByColumnValue('label', 'back');?>
<?php echo $this->helper('catalog/image')->init($_product, 'image', $label->getFile())->resize(235, 350);?> 
```

它返回如下内容：[http://www.mywebsite.com/product/images/image1](http://www.mywebsite.com/product/images/image1) 当我在图像的源属性中使用它时，它会显示正确的图像。

但是当我在 catalog/product/list.phtml 中使用此代码时，我收到以下错误：

致命错误：在第 95 行的 C:\Development\FabriqMagento\app\design\frontend\default\fabriq\template\catalog\product\list.phtml 中的非对象上调用成员函数 getItemByColumnValue()

PS：第95行是以下行：

```
<?php $imageByLabel = $_product->getMediaGalleryImages()->getItemByColumnValue('label', 'back');?> 
```

任何帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-01T01:30:26.617

如果您查看您的代码，`$imageByLabel`则没有做任何事情，因此不需要它。

尝试：

```
<?php echo Mage::getModel('catalog/product')->load($_product->getId())->getMediaGalleryImages()->getItemByColumnValue('label','black')->getFile();  ?> 
```

从`list.phtml`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-20T10:05:21.270

对于不是 list.phtml：

```
$_item = $this->getItem();
$_product = $_item->getProduct(); 
```

@Francis Kim - 方法 - 也有 resiz

```
$_image = Mage::getModel('catalog/product')->load( $_product->getId() )->getMediaGalleryImages()->getItemByColumnValue('label','FRONTSHOP');
echo $this->helper('catalog/image')->init($_product, 'thumbnail', $_image->getFile())->resize(75); 
```

我发现的唯一问题是它不适用于排除值

# java - 使包含 JPanel 的 JFrame 透明

> ID：13031402
> 
> 赞同：1
> 
> 时间：2012-10-23T13:22:04.253
> 
> 标签：java, swing, jframe, jpanel

这是关于 Java Swing 应用程序的。我有一个`JFrame`who`contentPane`设置为 a `JLayer`。将`JLayer`其边框设置为`TitledBorder`。这就是生成的 GUI 的样子。

![https://lh5.googleusercontent.com/-wL6CwKUFUmc/UIaZlc4VHNI/AAAAAAAABNo/4ccgAePrg8Y/s344/dgf.png](../Images/54c9703699f34cab790be0d236e0fd94.png)

我希望它`JFrame`是完全透明的，以便生成的 GUI 具有`JLayer`一个圆角矩形作为边框。只有圆角矩形应该是可见的。它周围的浅灰色不应该是可见的。怎么做到呢？

这就是最终 GUI 的样子。

![https://lh3.googleusercontent.com/-Gvce0j_frHI/UIaYKgBOc-I/AAAAAAAABNY/jnbl4qLWa1M/s344/border.png](../Images/81c14196368e4a288288b849340ab3cf.png)

这是一个说明上述问题的简短程序：

```
public class del extends javax.swing.JFrame {

    JPanel loginPanel;

    public del() {
        initComponents();
    }

    public void initComponents() {
        loginPanel = new javax.swing.JPanel();
        loginPanel.setBackground(new java.awt.Color(204, 204, 204));
        loginPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        add(loginPanel);
        setUndecorated(true);
        setMinimumSize(new Dimension(100, 100));
        setLocation(200, 200);
    }

    public static void main(String args[]) throws Exception {
        for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
            if ("Nimbus".equals(info.getName())) {
                javax.swing.UIManager.setLookAndFeel(info.getClassName());
                break;
            }

            java.awt.EventQueue.invokeLater(new Runnable() {
                public void run() {
                    new del().setVisible(true);
                }
            });
        }
    }
} 
```

这是生成的 GUI：

![在此处输入图像描述](../Images/eec9bb031cf6ff9282cbd9c281eff2c4.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:56:07.140

继续我的评论...

这是我做的一个例子，希望对您有所帮助：

基本上覆盖`componentResized(ComponentEvent e)`将`JFrame`其形状更改为`RoundRectangle2D`. 然后 a`JPanel`添加*自定义* `AbstarctBorder`以处理边框的圆形边缘。

![在此处输入图像描述](../Images/2038b0293bfd4d79c7a6f221cfa0ca70.png)

```
import java.awt.*;
import static java.awt.GraphicsDevice.WindowTranslucency.*;
import java.awt.event.ComponentAdapter;
import java.awt.event.ComponentEvent;
import java.awt.geom.RoundRectangle2D;
import javax.swing.*;
import javax.swing.border.AbstractBorder;

public class ShapedWindowAndBorderDemo extends JFrame {

    public ShapedWindowAndBorderDemo() {
        super("Shaped Window and Border Demo");

        final JPanel panel = new JPanel() {
            @Override
            public Dimension getPreferredSize() {
                return new Dimension(200, 200);
            }
        };
        // It is best practice to set the window's shape in
        // the componentResized method.  Then, if the window
        // changes size, the shape will be correctly recalculated.
        addComponentListener(new ComponentAdapter() {
            // Give the window an elliptical shape.
            // If the window is resized, the shape is recalculated here.
            @Override
            public void componentResized(ComponentEvent e) {
                setShape(new RoundRectangle2D.Float(panel.getX(), panel.getY(), panel.getWidth(), panel.getHeight(), 10, 10));
            }
        });

        setUndecorated(true);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        //panel.setBorder(new CurvedBorder());//creates a single lined border
        panel.setBorder(new CurvedBorder(2, true));
        panel.add(new JButton("I am a Button"));
        add(panel);

        pack();
        setLocationRelativeTo(null);
        setVisible(true);
    }

    public static void main(String[] args) {
        // Determine what the GraphicsDevice can support.
        GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
        GraphicsDevice gd = ge.getDefaultScreenDevice();

        //If shaped windows aren't supported, exit.
        if (!gd.isWindowTranslucencySupported(PERPIXEL_TRANSPARENT)) {
            System.err.println("Shaped windows are not supported");
            System.exit(0);
        }

        // Create the GUI on the event-dispatching thread
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new ShapedWindowAndBorderDemo();
            }
        });
    }
}

class CurvedBorder extends AbstractBorder {

    private Color wallColor = Color.gray;
    private int sinkLevel = 1;
    private boolean indent = false;

    public CurvedBorder(Color wall) {
        this.wallColor = wall;
    }

    public CurvedBorder(int sinkLevel, Color wall, boolean indent) {
        this.wallColor = wall;
        this.sinkLevel = sinkLevel;
    }

    public CurvedBorder(int sinkLevel, boolean indent) {
        this.sinkLevel = sinkLevel;
        this.indent = indent;
    }

    public CurvedBorder() {
    }

    @Override
    public void paintBorder(Component c, Graphics g, int x, int y, int w, int h) {
        super.paintBorder(c, g, x, y, w, h);
        g.setColor(getWallColor());

        for (int i = 0; i < sinkLevel; i++) {
            g.drawRoundRect(x, y, w - 1 - i, h - 1 - i, 10 - i, 10 - i);
            if (indent) {
                g.drawRoundRect(x + i, y + i, w - 1, h - 1, 10 - i, 10 - i);
            }
        }
    }

    @Override
    public boolean isBorderOpaque() {
        return true;
    }

    @Override
    public Insets getBorderInsets(Component c) {
        return new Insets(sinkLevel, sinkLevel, sinkLevel, sinkLevel);
    }

    @Override
    public Insets getBorderInsets(Component c, Insets i) {
        i.left = i.right = i.bottom = i.top = sinkLevel;
        return i;
    }

    public boolean isIndented() {
        return indent;
    }

    public int getSinkLevel() {
        return sinkLevel;
    }

    public Color getWallColor() {
        return wallColor;
    }
} 
```

**参考**

*   [绘制圆形矩形边框的自定义边框](http://www.javafaq.nu/java-example-code-800.html)
*   [如何创建半透明和异形窗口](http://docs.oracle.com/javase/tutorial/uiswing/misc/trans_shaped_windows.html)

# mysql - 优化数亿行表的查询

> ID：13031404
> 
> 赞同：9
> 
> 时间：2012-10-23T13:22:09.343
> 
> 标签：mysql, query-optimization

这感觉就像是“为我做作业”之类的问题，但我真的被困在这里，试图让这个查询对一个有很多行的表快速运行。这是一个显示架构（或多或少）[的 SQLFiddle 。](http://sqlfiddle.com/#!2/82d23/2/1)

我玩过索引，试图得到一些能显示所有必需列但没有取得多大成功的东西。这是`create`：

```
CREATE TABLE `AuditEvent` (
    `auditEventId` bigint(20) NOT NULL AUTO_INCREMENT,
    `eventTime` datetime NOT NULL,
    `target1Id` int(11) DEFAULT NULL,
    `target1Name` varchar(100) DEFAULT NULL,
    `target2Id` int(11) DEFAULT NULL,
    `target2Name` varchar(100) DEFAULT NULL,
    `clientId` int(11) NOT NULL DEFAULT '1',
    `type` int(11) not null,
    PRIMARY KEY (`auditEventId`),
    KEY `Transactions` (`clientId`,`eventTime`,`target1Id`,`type`),
    KEY `TransactionsJoin` (`auditEventId`, `clientId`,`eventTime`,`target1Id`,`type`)
) 
```

和（一个版本）`select`：

```
select ae.target1Id, ae.type, count(*)
from AuditEvent ae
where ae.clientId=4
    and (ae.eventTime between '2011-09-01 03:00:00' and '2012-09-30 23:57:00')
group by ae.target1Id, ae.type; 
```

我最终也得到了“使用临时文件”和“使用文件排序”。我尝试删除`count(*)`并使用`select distinct`，这不会导致“使用文件排序”。`join`如果有办法返回计数，这可能没问题。

最初，决定跟踪创建审计记录时存在的目标的 target1Name 和 target2Name。我也需要这些名字（最近的就可以了）。

目前，查询（上面，缺少 target1Name 和 target2Name 列）在大约 5 秒内运行约 2400 万条记录。我们的目标是数亿，我们希望查询继续沿着这些路线执行（希望将其保持在 1-2 分钟内，但我们希望它做得更好），但我担心的是一次我们达到了它不会达到的大量数据（正在模拟额外的行）。

我不确定获得额外字段的最佳策略。如果我将列直接添加到`select`查询中，我会丢失“使用索引”。我试着`join`回到桌子上，它保留了“使用索引”，但大约需要 20 秒。

我确实尝试将 eventTime 列更改为 int 而不是 datetime，但这似乎并没有影响索引的使用或时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T19:22:16.910

正如您可能理解的那样，这里的问题是范围条件`ae.eventTime between '2011-09-01 03:00:00' and '2012-09-30 23:57:00'`（一如既往）破坏了索引的有效使用`Transactions`（即索引实际上仅用于`clientId`方程和范围条件的第一部分，并且索引不用于分组） .

大多数情况下，解决方案是用相等检查替换范围条件（在您的情况下，引入一`period`列，分组`eventTime`到句点并用 a 替换`BETWEEN`子句`period IN (1,2,3,4,5)`）。但这可能会成为您餐桌的开销。

您可能会尝试的另一个解决方案是添加另一个索引（`Transactions`如果不再使用，可能会替换）：，`(clientId, target1Id, type, eventTime)`并使用以下查询：

```
SELECT
  ae.target1Id,
  ae.type,
  COUNT(
    NULLIF(ae.eventTime BETWEEN '2011-09-01 03:00:00' 
                            AND '2012-09-30 23:57:00', 0)
  ) as cnt,
FROM AuditEvent ae
WHERE ae.clientId=4
GROUP BY ae.target1Id, ae.type; 
```

这样，您将 a）将范围条件移动到末尾，b）允许使用索引进行分组，c）使索引成为查询的*覆盖索引*（即查询不需要磁盘 IO 操作）

**UPD1：** 对不起，昨天我没有仔细阅读你的帖子，没有注意到你的问题是检索`target1Name`和`target2Name`。首先，我不确定您是否正确理解`Using index`. 不存在`Using index`并不意味着查询没有使用索引，`Using index`意味着索引本身包含足够的数据来执行子查询（即索引正在覆盖）。由于`target1Name`和`target2Name`不包含在任何索引中，因此获取它们的子查询将没有`Using index`.

如果您的问题只是如何将这两个字段添加到您的查询中（您认为这足够快），那么只需尝试以下操作：

```
SELECT a1.target1Id, a1.type, cnt, target1Name, target2Name
FROM (
  select ae.target1Id, ae.type, count(*) as cnt, MAX(auditEventId) as max_id
  from AuditEvent ae
  where ae.clientId=4
      and (ae.eventTime between '2011-09-01 03:00:00' and '2012-09-30 23:57:00')
  group by ae.target1Id, ae.type) as a1
JOIN AuditEvent a2 ON a1.max_id = a2.auditEventId
; 
```

# php - JQuery UI 自动完成 JSON php 输出格式

> ID：13031405
> 
> 赞同：0
> 
> 时间：2012-10-23T13:22:15.827
> 
> 标签：php, jquery, mysql, json

好的，我在使用 JQuery 自动完成时遇到问题。

在搜索栏中，当我开始输入时，它只显示来自 searchfrnds.php 的名字。我想要的是它应该以某种方式连接 searchfrnds.php 的结果，使其在显示的搜索结果下拉列表中显示名字和姓氏。

searchfrnds.php 的代码：

```
 <?php 
   $term = trim(strip_tags($_GET['term']));

   $query = "SELECT aid,firstname, lastname, profpic,email,abtyou
    FROM artist92 WHERE firstname LIKE '%".$term."%' OR lastname LIKE '%".$term."%'";

    $result = mysqli_query ($link, $query);

    $array = array();

    while($obj = mysqli_fetch_array($result, MYSQLI_ASSOC)){
    $array['value'] = $obj['firstname'];
$array['lvalue'] = $obj['lastname'];
$array['icon'] = $obj['profpic'];
$array['aid']=$obj['aid'];
$array['abt']=$obj['abtyou'];
$array['email']=$obj['email'];

$row_set[]=$array;

       }

        echo json_encode($row_set);

      ?> 
```

jQuery代码：

```
 <script>

$(function() {
    function log( message ) {
        $( "<div>" ).text( message ).prependTo( "#log" );
        $( "#log" ).scrollTop( 0 );
    }

    $( "#frndsrch" ).autocomplete({
        source: "searchfrnds.php",
        minLength: 2,
        select: function( event, ui ) {
             $( "#project-icon" ).attr( "src", "" + ui.item.icon );
            $('a').attr('href',"viewartprofile.php?aid=" + ui.item.aid ); 

                 }
    });

});
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:24:55.640

假设 jQueryUI 自动完成正在显示数组的值部分，只需执行以下操作：

```
$array['value'] = $obj['firstname'].' '.$obj['lastname']; 
```

然后应该根据需要显示两者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:25:45.707

显示jquery ui 自动完成的项目`label`（默认搜索）并`value`在选择选项时插入 - 如果省略一个，则复制和使用其他的值。

# model-view-controller - Web 应用程序中的 DCI 上下文

> ID：13031407
> 
> 赞同：1
> 
> 时间：2012-10-23T13:22:21.983
> 
> 标签：model-view-controller, dci

我正在考虑如何以及何时可以在 Web 应用程序中使用 DCI 上下文。我正在考虑这个高级用例：

1.  用户输入城市、到达、离开、房间类型并点击“搜索”。
2.  系统显示酒店列表
3.  用户单击酒店徽标以阅读其详细信息
4.  系统显示酒店详情
5.  用户点击“立即预订”
6.  系统显示付款表格
7.  用户输入客户详细信息、账单信息并点击“提交”。
8.  系统验证计费信息并显示预订确认。

这是非常高级的，肯定需要分解。第一步（1-2、3-4、5-6）感觉像是可以通过一些搜索和 REST 架构处理的简单资源请求。所以我的第一个问题是，在这些情况下是否需要 DCI 上下文，纯 MVC 还不够吗？当然，“酒店”数据实体可以发挥作用，但您认为它可行吗，尤其是如果它是唯一的参与者？

最后一步是我看到 DCI 可能非常有用的地方，因为现在需要以程序方式进行工作。（创建客户、向酒店添加预订、发送确认邮件……）

您对此有何看法？我在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T17:30:37.317

我想我会说一个上下文从第 2 步开始。你有一个起作用的报价列表。目前这些优惠是酒店优惠，但什么是酒店优惠？它们可能是不同的东西。有些可能来自经纪人，有些可能直接来自酒店，它们是两种不同类型的实体，但它们在这种情况下发挥相同的作用，您可能有更多类型，有些可能是自身的上下文。例如，航班和酒店组合成一个报价，在这种情况下，酒店/经纪人报价和廉价航班报价各自发挥作用，但列出的用例您不必担心这一点，只需使域成为可能独立于用例发展，虽然用例是预订便宜的酒店，但我'

Then when picking a specific offer I'd agree that you start a new context

# c++ - Cin 循环永不终止

> ID：13031414
> 
> 赞同：1
> 
> 时间：2012-10-23T13:22:37.990
> 
> 标签：c++, linux, while-loop, cin, io-redirection

我无法让我的 cin 循环在我的程序中终止。我的程序使用 Linux 重定向从文件 hw07data 中读取输入，数据文件如下所示：

```
100 20 50 100 40 -1 
A34F 90 15 50 99 32 -1
N12O 80 15 34 90 22 -1 
```

第一部分是班级的总分，下一行是学生ID号，后面是他们的分数，都以-1结尾。

我的问题：当我运行命令*./a.out < hw07data*时，我的 while 循环永远不会终止，有人可以查看我的代码并给我一些提示吗？我不想要答案，因为这是作业，我只需要一些指导。谢谢！！

```
#include <iostream>
#include <iomanip>
using namespace std;

const int SENTINEL = -1;           //signal to end part of file
const int LTAB = 8;                //left tab
const int RTAB = 13;               //right tab

int main()
{
    cout << "Grant Mercer Assignment 7 Section 1002\n\n";
    cout << setprecision(2) << fixed << showpoint;
    cout << left << setw(LTAB) << "ID CODE" <<
                right << setw(RTAB) << "POINTS" <<
                setw(RTAB) << "PCT" << setw(RTAB) <<
                 "GRADE" << endl;
    double Percentage,              //holds students percentage
           AvgPercentage;
    int Earnedpoints,               //earned points for specific student
        Totalpoints,                //total points possible for all students
        AvgPoints,                  //average points for all students
        NumClass;                   //counts the number of students
    Totalpoints = Earnedpoints =    //set all vals equal to zero
    AvgPoints = AvgPercentage = Percentage =  NumClass = 0;
                                    //first and last char for studentID
    char Fchar,Lchar, Num1, Num2, Grade;

    int TmpVal = 0;                 //temporary value
    cin >> TmpVal;
    while(TmpVal != -1)             //reading in TOTAL POINTS
    {
        Totalpoints += TmpVal;      //add scores onto each other
        cin >> TmpVal;              //read in next value
    }

    while(cin)                       //WHILE LOOP ISSUE HERE!
    {
                                     //read in student initials
            cin >> Fchar >> Num1 >> Num2 >> Lchar >> TmpVal;
            while(TmpVal != -1)
            {
                Earnedpoints += TmpVal; //read in points earned
                cin >> TmpVal;
            }
                                        //calculate percentage
            Percentage = ((double)Earnedpoints / Totalpoints) * 100;
            AvgPercentage += Percentage;
            NumClass++;
            if(Percentage >= 90)        //determine grade for student
                Grade = 'A';
            else if(Percentage >= 80 && Percentage < 90)
                Grade = 'B';
            else if(Percentage >= 70 && Percentage < 80)
                Grade = 'C';
            else if(Percentage >= 60 && Percentage < 70)
                Grade = 'D';
            else if(Percentage < 60)
                Grade = 'F';
                                        //display information on student

            cout << left << Fchar << Num1 << Num2 << setw(LTAB) << Lchar << right << setw(RTAB-3) << Earnedpoints <<
            setw(RTAB) << Percentage <<  setw(RTAB) << Grade << endl;
            TmpVal = Earnedpoints = 0;
    }
    AvgPercentage /= NumClass;
    cout << endl << left << setw(LTAB+20) << "Class size: " << right << setw(RTAB) << NumClass << endl;
    cout << left << setw(LTAB+20) << "Total points possible: " << right << setw(RTAB) << Totalpoints << endl;
    cout << left << setw(LTAB+20) << "Average point total: " << right << setw(RTAB) << AvgPoints << endl;
    cout << left << setw(LTAB+20) << "Average percentage: " << right << setw(RTAB) << AvgPercentage << endl;
} 
```

输出继续要求新的输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:43:18.040

您应该**始终**检查您的输入是否成功：

```
if (std::cin >> TmpVal) {
    // do simething with the read value
}
else {
    // deal with failed input
} 
```

如果发生故障，您晚上需要检查以`eof()`表明故障是由于已到达输入的末尾。

要处理错误，请查看`std::istream::clear()`和`std::istream::ignore()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:45:16.350

你可以在那里找到答案[How to read until EOF from cin in C++](https://stackoverflow.com/questions/201992/how-to-read-until-eof-from-cin-in-c)

因此，您可以`cin`使用并解析结果行逐行读取`getline`，如下所示：

```
#include <iostream>
#include <sstream>
#include <string>

int main() {
    int a, b;

    std::string line;
    while (std::getline(std::cin, line)) {
        std::stringstream stream(line);

        stream >> a >> b;
        std::cout << "a: " << a << " - b: " << b << std::endl;
    }

    return 0;
} 
```

*编辑：*不要忘记检查解析结果和流状态是否有任何失败！

# javascript - jQuery：通过css-selector注册的事件的优先级？

> ID：13031415
> 
> 赞同：2
> 
> 时间：2012-10-23T13:22:41.653
> 
> 标签：javascript, jquery, events

我尝试为删除之类的链接构建一个小而灵活的点击处理程序。这个处理程序应该通过 css-class-selector 注册。

```
<a href="#" class="confirm-delete">delete</a>

<script>
$(document).on('click', '.confirm-delete', function() {
    return window.confirm('sure?');
});
</script> 
```

到目前为止效果很好。但真正的动作也应该通过选择器注册。

```
<a href="confirm-delete delete">delete</a> 
```

现在我的事件优先级有点问题，因为删除事件将首先处理，然后确认。

有没有办法更好地控制事件的触发顺序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:35:48.230

如果您希望在删除操作之前运行确认，请尝试以下操作：

```
<a href="#" class="confirm-delete">delete</a>

<script >
  $(document).on('click', '.confirm-delete', function (event) {
      event.preventDefault();
      if (window.confirm('sure?')) {
          // do your action here
      }
  });
</script> 
```

# android - 编辑自定义帐户

> ID：13031420
> 
> 赞同：3
> 
> 时间：2012-10-23T13:22:53.617
> 
> 标签：android, accountmanager

我已经创建了自己的自定义帐户，并且可以正常添加帐户并在应用程序中使用它。

我现在希望能够编辑帐户信息，而不是删除和添加帐户。我的帐户上有许多字段，有些可能有点冗长，因此删除和添加相当麻烦。

我已经通过添加我自己的 PreferenceScreen 并通过我的 account-authenticator XML 文件中的 android:accountPreferences 连接它来创建基础知识，如下所示：[AbstractAccountAuthenticator](http://developer.android.com/reference/android/accounts/AbstractAccountAuthenticator.html)。

在我的 PreferenceScreen 中，我定义了打开我的活动的意图，该活动用于输入帐户的用户数据。

```
<PreferenceScreen
    android:key="edit"
    android:title="Edit Account Details"
    android:summary="Change System ID, user name, password etc.">
    <intent
        android:action="my.app.accountmanager.UserCredentialsActivity.ACCOUNT_SETUP"
        android:targetPackage="my.app.accountmanager"
        android:targetClass="my.app.accountmanager.UserCredentialsActivity" />
</PreferenceScreen> 
```

我的问题是，我如何在意图中作为附加信息传递或找到我在设置/帐户和同步中选择的帐户的帐户信息。这种自定义帐户类型可能有多个帐户，因此我不能只搜索该类型的任何帐户。我需要来自所选帐户的数据。

我的想法大致在这些方面：

1.  在 xml 中包含一些内容以添加额外内容。不明白这怎么可能。
2.  意图的目标是我的 AccountAuthenticator 类或身份验证服务，但我如何传递我想要编辑数据？由于 AbstractAccountAuthenticator 有一个 updateCredentials 方法，它返回一个包含我的数据输入活动意图的包，如果我可以传入一个 EDIT 操作或类似的东西，这可能会起作用。
3.  在某处覆盖某些方法以使用帐户数据创建我自己的意图。

我希望这是可能的，因为三星应用程序和 Dropbox 应用程序都可以从 Accounts & Sync 执行此操作，尽管它们都不允许多个帐户...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T06:57:57.223

我认为 AbstractAccountAuthenticator 中的 accountPreferences 属性很快就会过时。如果你查看JB中的账户，如果你添加多个账户，它会像这样显示

1.  account1@gmail.com
2.  account2@gmail.com
3.  偏爱

代替

1.  account1@gmail.com -> 偏好
2.  account2@gmail.com -> 偏好

如果您查看 Gmail 应用程序，Gmail 的首选项（通知铃声）是在 Gmail 应用程序本身内配置的，无法从“帐户和设置”页面进行配置。

因此，您应该只将 accountPreferences 属性用于所有帐户共有的首选项。

# xamarin.android - MonoDroid 和 TimeZoneInfo.ConvertTime

> ID：13031422
> 
> 赞同：0
> 
> 时间：2012-10-23T13:22:59.647
> 
> 标签：xamarin.android

我正在尝试将当前时间转换为中央标准时间。使用 Mono 和 .NET，这些都可以工作。

```
TimeZoneInfo cst = TimeZoneInfo.FindSystemTimeZoneById("Central Standard Time");
TimeZoneInfo.ConvertTime(DateTime.UtcNow, cst);
TimeZoneInfo.ConvertTime(DateTime.Now, cst); 
```

使用 MonoDroid 3.0.4，第一个给出这个错误：

```
Unhandled Exception:
System.ArgumentException: Kind propery of dateTime is Utc but the sourceTimeZone does not equal TimeZoneInfo.Utc
  at System.TimeZoneInfo.ConvertTime (DateTime dateTime, System.TimeZoneInfo sourceTimeZone, System.TimeZoneInfo destinationTimeZone) [0x00000] in <filename unknown>:0 
  at System.TimeZoneInfo.ConvertTime (DateTime dateTime, System.TimeZoneInfo destinationTimeZone) [0x00000] in <filename unknown>:0 
```

第二个给出了这个错误：

```
Unhandled Exception:
System.ArgumentNullException: Argument cannot be null.
Parameter name: destinationTimeZone
  at System.TimeZoneInfo.ConvertTime (DateTime dateTime, System.TimeZoneInfo     sourceTimeZone, System.TimeZoneInfo destinationTimeZone) [0x00000] in <filename unknown>:0 
  at System.TimeZoneInfo.ConvertTime (DateTime dateTime, System.TimeZoneInfo destinationTimeZone) [0x00000] in <filename unknown>:0 
```

TimeZoneInfo.ConvertTimeBySystemTimeZoneId 也有同样的问题。

无论如何要使用 MonoDroid 获取不同时区的当前时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:28:06.963

一种可能的解决方法是自己调用三参数版本：

```
var zoned = TimeZoneInfo.ConvertTime(DateTime.UtcNow, TimeZoneInfo.Utc, cst); 
```

编辑：如果找不到您感兴趣的区域，`FindSystemTimeZoneById` *应该*抛出一个，但我想知道在这种情况下它是否只是返回。`TimeZoneNotFoundException``null`

MonoDroid 上的时区 ID 可能是 TZDB 的，在这种情况下，您可以尝试使用：

```
TimeZoneInfo cst = TimeZoneInfo.FindSystemTimeZoneById("America/Chicago"); 
```

# azure - 在 Windows Azure 上组织 DDoS 保护

> ID：13031423
> 
> 赞同：2
> 
> 时间：2012-10-23T13:23:05.897
> 
> 标签：azure, nginx, reverse-proxy, squid, ddos

如果我们在 Microsoft Azure 上托管一些球形应用程序，我们希望以最小的经济影响和最大的可靠性来抵御 DDoS 攻击，那么：

1.  组织像 squid 或 nginx 这样的反向代理作为针对 DDoS 的保护级别是否有用？

2.  如果为真 - 在 Azure 上部署反向代理或作为专用服务器是否有意义？

3.  如果我们在 Azure 上部署代理，是否应该/可以进行多实例化，如果没有，它会不会成为瓶颈？

4.  如果为 false - 除了通过抛出更多实例以跟上流量激增并依靠 Azure 的负载均衡器进行扩展之外，可以应用哪些措施来有效地实时响应 ddos​​ 攻击？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:46:28.477

托管 Windows Azure 的 Microsoft 数据中心已经对 DDoS 攻击等项目进行了保护。也就是说，您仍然可以监控您的应用程序是否存在意外和潜在无效的流量峰值，并做出相应的反应。这可以扩展您的容量以使用多个服务实例处理负载，或者通过提交支持票证让无效流量被 MSFT 的数据中心保护阻止。

# r - R中的出生时性别比模拟

> ID：13031432
> 
> 赞同：1
> 
> 时间：2012-10-23T13:23:18.453
> 
> 标签：r

**我的问题：**

如果出生时的性别比（男性与女性）为 1.1，但人们采取以下策略：生孩子直到有一个儿子，然后停止，除非您有 12 个女儿（在这种情况下，您也停止）。人口的平均性别比是多少？（通过模拟计算。假设您随机选择10,000个家庭。）

**我的代码**

```
 pm=0.5238095 # Probability of Male
  pw=0.4761905 #                Female
  w=0          # initial number of Female
  n=1          # loop
  p=0          # count of number 
  for(i in 1:n){
  s=rbinom(1,1,0.4761905)
  if(s==1){
  w=w+1
  }
   p=p+1
 while(w<=12){ ####1\. How to count the number of female? ###
 while(s==1){
 s=rbinom(1,1,0.4761905)
 if(s==1){
  w=w+1
 }
  p=p+1
 }
 }
  f[i]=p
 }
 w/p 
```

**我的问题**

1.  如何计算女性的数量？我正在使用循环来计算女性的数量$(if(s==1){ w=w+1 })。$它似乎效率低下。我认为计算真假可能更有效。

2.  如何写代码更简洁？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T14:09:09.187

答案当然是，这个策略根本不会影响性别比例！至少按照您的设置，无论一对夫妇以前的生育史是什么，每次生育男性的概率总是相同的。

这是通过一些计算来确认这一点的一种方法。（代码没有进一步解释，至少现在是这样。）：

```
pm <- 0.5238095
m <- cbind(boys=c(rep(1, 12), 0), girls=0:12)
p <- c(dgeom(0:11, pm), 1-pgeom(11, pm))

## Calculate expected number of boys and girls for an immortal couple pursuing
## this "strategy"
(res <- p %*% m)
#           boys     girls
# [1,] 0.9998641 0.9089674
p[1] / sum(p)
# [1] 0.5238095   ## Look familiar 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-23T13:45:12.743

是的，这是非常低效的。也许我可以只解决几件几乎有意义的事情，它会给你答案。在您的代码中...

```
 for(i in 1:n){
    s=rbinom(1,1,0.4761905)
    if(s==1){
    w=w+1
 } 
```

可以改写为...

```
 s = rbinom(n,1,0.4761905)     
 w = sum(s) 
```

这是同样的结果。请记住，rbinom 会产生 0 和 1。您只需将它们相加即可知道有多少个 1。鉴于您定义了 n，那么 0（女性）的数量是......

```
 n - w 
```

但是，如果你不这样做，它也很容易找到......

```
length(s) - sum(s) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-23T13:50:16.470

它仍然可能效率低下，但至少它对于您正在尝试做的事情是正确的：

```
# set.seed(1)
pw <- 0.4761905 # Initial sex ratio
w <- 0 # number of daughters
n <- 10000 # number of families
p <- 0 # number of kids 
f <- data.frame(Daughters=vector(length=n), Kids=vector(length=n))
for(i in 1:n){
    while(w < 12 & w==p){ #As long as you don't have 12 daughters or 1 son...
    s <- rbinom(1,1,pw)
    if(s==1){w <- w+1}
    p <- p+1
    }
f[i,] <- c(w,p) #Number of daughter and total kids in each families
w <- p <- 0 # Reset number of kids and daughters for the next family
}
colSums(f)[1]/colSums(f)[2] #Final sex ratio
Daughters 
0.4736842 # So as @JoshO'Brien pointed out, very close to the original sex ratio. 
```

并且您可以验证向量`f`以查看永远不会超过 1 个儿子（孩子的数量减去女儿的数量）：

```
range(f[,2]-f[,1])
[1] 1 1 # Range of the number of boys per family
range(f[,1])
[1]  0 11 # Range of the number of daughters per family
nrow(f[f[,1]==0,])
[1] 5275 # Number of families having 1 son and no daughters (to be compared with 1-pw) 
```

# html - 我可以将 ArrayBuffer 转换为字符串吗？

> ID：13031433
> 
> 赞同：1
> 
> 时间：2012-10-23T13:23:20.190
> 
> 标签：html, uploading

我正在研究html5上传脚本。我想要每个文件流块的 md5 哈希。

这是我使用 FileReader 读取流但是当我将读取器结果传递给 base64 类时出现异常。对象不支持属性或方法 'charCodeAt'

```
var reader = new FileReader();
reader.onload = function (f) {
var hash = MD5(Base64.encode(f.target.result));
                };
reader.readAsArrayBuffer(blob) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:30:47.900

这将完成这项工作：

代替

```
reader.readAsArrayBuffer(blob); 
```

和

```
reader.readAsText(blob); 
```

[http://www.w3.org/TR/FileAPI/#dfn-readAsText](http://www.w3.org/TR/FileAPI/#dfn-readAsText)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:42:03.740

你应该尝试这种方式： -

```
function ab2str(buf) {
  return String.fromCharCode.apply(null, new Uint16Array(buf));
}

function str2ab(str) {
  var buf = new ArrayBuffer(str.length*2); // 2 bytes for each char
  var bufView = new Uint16Array(buf);
  for (var i=0, strLen=str.length; i<strLen; i++) {
    bufView[i] = str.charCodeAt(i);
  }
  return buf;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-10T11:07:35.497

在您的情况下，Base64 是不必要的。

```
var reader = new FileReader();
reader.onload = function (evt) {
    var hash = MD5(evt.target.result);
};
reader.readAsText(blob,'iso-8859-1'); 
```

# jquery - jquery ui-dialog确认按钮问题

> ID：13031437
> 
> 赞同：0
> 
> 时间：2012-10-23T13:23:31.777
> 
> 标签：jquery, asp.net, jquery-ui-dialog, jquery-click-event

这是一些由 asp.net 为浏览器生成的 Html + jQuery ui 对话框代码..

在我看来，它看起来不错，但问题是，确认按钮会触发具有指定类的链接的单击事件，尽管该事件没有被触发。

[更新：我更改了“$(".lDel_23").click();” 到 document.location.href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$ListView_Sections$ctrl1$LinkBut​​ton_Delete','')" 并调用了函数..所以问题似乎是点击触发器无法正常工作链接的href设置为javascript方法..虽然尝试手动点击有效，但jQuery点击触发器调用不起作用..这有什么意义？？？？]

```
 <a href="#" id="aDel_23"></a>
    <a id="ctl00_ContentPlaceHolder1_ListView_Sections_ctrl1_LinkButton_Delete" title="Delete" class="lDel_23" href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$ListView_Sections$ctrl1$LinkButton_Delete','')"></a>
     <div id="dialog_23" title="Confirm Delete">
           Delete Section [section name]
     </div>

     <script type="text/javascript">
            $(document).ready(function() {
                $("#dialog_23").dialog({
                    autoOpen: false,
                    modal: true,
                    width: 400
                });
                // Link to open the dialog
                $("#aDel_23").click(function(event) {
                    event.preventDefault();
                    $("#dialog_23").dialog({
                        buttons: {
                            'Confirm': function() {
                                $(this).dialog('close');
                                $(".lDel_23").click();
                            },
                            'Cancel': function() {
                                $(this).dialog('close');
                            }
                        }
                    });

                    $('#dialog_23').dialog("open");
                });
            });
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:34:33.217

Apparently it is a bit more fiddly to trigger a link on an "a" tag. See if this questions helps out: [trigger a click on a anchor link](https://stackoverflow.com/questions/9904170/trigger-a-click-on-a-anchor-link)

Basically change this: `$(".lDel_23").click();` to `$(".lDel_23").get(0).click();`

# cuda - pycuda::complex 数组上的元素智能函数

> ID：13031439
> 
> 赞同：2
> 
> 时间：2012-10-23T13:23:33.070
> 
> 标签：cuda, pycuda

*我想在大型 2D 复杂数组（最终 2* 12x2* *12 数据点）上运行一个函数。但是，pycuda 不能按预期工作。ElementWise 函数不适用于二维数组，因此我使用了具有块大小的 SourceModule 函数。

现在的问题是，GPU 上的 C 代码给出的结果与 CPU 上的 numpy 计算结果不同。产生了非常大和奇怪的数字。

我正在使用以下代码。怎么了？

```
#!/usr/bin/env python
#https://github.com/lebedov/scikits.cuda/blob/master/demos/indexing_2d_demo.py
"""
Demonstrates how to access 2D arrays within a PyCUDA kernel in a
numpy-consistent manner.
"""

from string import Template
import pycuda
import pycuda.autoinit
import pycuda.gpuarray as gpuarray
from pycuda.compiler import SourceModule
import numpy as np
from matplotlib import pyplot as plt

# Set size
A = 2**3
B = 2**3
N = A*B
x_gpu = gpuarray.to_gpu(np.fromfunction(lambda x,y: (1.+x)*np.exp(1.j*y*np.pi/10), (A,B)) )
y_gpu = gpuarray.to_gpu(np.fromfunction(lambda x,y: 1.*x, (A,B)).astype(
                                x_gpu.dtype)) 
d_gpu = gpuarray.to_gpu(np.zeros_like(x_gpu.get()))#.astype(np.float32))

func_mod_template = Template("""
// Macro for converting subscripts to linear index:
#define INDEX(a, b) a*${B}+b
#include <pycuda-complex.hpp>

//__global__ void func(double *d,double *x,double *y, unsigned int N) {
__global__ void func(pycuda::complex<float> *d,pycuda::complex<float> *x,
                     pycuda::complex<float> *y)
{
    // Obtain the linear index corresponding to the current thread:     
    // unsigned int idx =  blockIdx.y*blockDim.y*gridDim.x + 
                        blockIdx.x*blockDim.x*gridDim.y +threadIdx.x+threadIdx.y;
    unsigned int block_num        = blockIdx.x + blockIdx.y * gridDim.x;              
    unsigned int thread_num       = threadIdx.y * blockDim.x + threadIdx.x;           
    unsigned int threads_in_block = blockDim.x * blockDim.y;                          
    unsigned int idx              =  (threads_in_block * block_num + thread_num);

    // Convert the linear index to subscripts:
    unsigned int a = idx/${B};
    unsigned int b = idx%${B};

    // Use the subscripts to access the array:
    // d[INDEX(a,b)] = x[INDEX(a,b)]+y[INDEX(a,b)];
    pycuda::complex<float> j(0,arg(x[idx]));
    pycuda::complex<float> i(abs(x[idx]),0);
    d[idx] = i * exp(j);
}
""")

max_threads_per_block = pycuda.autoinit.device.get_attribute(pycuda._driver.device_attribute.MAX_THREADS_PER_BLOCK)
max_block_dim = (pycuda.autoinit.device.get_attribute(pycuda._driver.device_attribute.MAX_BLOCK_DIM_X),
                 pycuda.autoinit.device.get_attribute(pycuda._driver.device_attribute.MAX_BLOCK_DIM_Y),
                 pycuda.autoinit.device.get_attribute(pycuda._driver.device_attribute.MAX_BLOCK_DIM_Z))
max_grid_dim = (pycuda.autoinit.device.get_attribute(pycuda._driver.device_attribute.MAX_GRID_DIM_X),
                pycuda.autoinit.device.get_attribute(pycuda._driver.device_attribute.MAX_GRID_DIM_Y),
                pycuda.autoinit.device.get_attribute(pycuda._driver.device_attribute.MAX_GRID_DIM_Z))
max_blocks_per_grid = max(max_grid_dim)
block_dim = max_block_dim
block_dim = (max_block_dim[0],1,1)
grid_dim = (int(np.ceil(1.*x_gpu.shape[0]/block_dim[0])),
            int(np.ceil(1.*x_gpu.shape[1]/block_dim[1])))
print block_dim,grid_dim, N

func_mod = \
         SourceModule(func_mod_template.substitute(max_threads_per_block=max_threads_per_block,
                                                   max_blocks_per_grid=max_blocks_per_grid,
                                                   A=A, B=B))
func = func_mod.get_function('func')
func(d_gpu,x_gpu,y_gpu,
     block=block_dim,
    grid=grid_dim)

print d_gpu.get()/x_gpu.get()
#print 'Success status: ', np.allclose(x_np, x_gpu.get())
plt.imshow((d_gpu.get()/x_gpu.get()).real)
plt.colorbar()
plt.show() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T00:02:10.140

作为一个实际的答案：将`x_gpu`线路更改为

```
x_gpu = gpuarray.to_gpu(np.fromfunction(
    lambda x,y: (1.+x)*np.exp(1.j*y*np.pi/10), (A,B)).astype(np.complex64) ) 
```

似乎解决了这个问题。此外，虽然`ElementwiseKernel`不适用于 2d 数组，但无论如何您都在使用 2d->1d 转换，所以没有什么能真正阻止您编写

```
func = ElementwiseKernel(
    "pycuda::complex<float> *d, pycuda::complex<float> *x, pycuda::complex<float> *y",

    Template("""
    // Convert the linear index to subscripts:
    unsigned int a = i/${B};
    unsigned int b = i%${B};

    // Use the subscripts to access the array:
    //d[INDEX(a,b)] = x[INDEX(a,b)]+y[INDEX(a,b)];
    pycuda::complex<float> angle(0,arg(x[i]));
    pycuda::complex<float> module(abs(x[i]),0);
    d[i] = module * exp(angle);
    """).substitute(A=A, B=B),

    preamble=Template("""
    #define INDEX(a, b) a*${B}+b
    """).substitute(A=A, B=B))

func(d_gpu, x_gpu, y_gpu) 
```

这样您就不需要处理块/网格大小，因为`PyCUDA`它会为您处理。

# apache - Wampserver 上的 SSL - Apache 版本

> ID：13031448
> 
> 赞同：0
> 
> 时间：2012-10-23T13:23:58.390
> 
> 标签：apache, openssl, wampserver

好的，如果我的问题的答案已经存在于某个地方，我一点也不感到惊讶。我几乎一无所知，所以我可能一直在搜索错误的术语。这是我的问题：

我正在尝试更新需要安全连接 (https) 的网站。该站点没有开发实例，因此我已将该站点和数据库复制到本地 wampserver。当我尝试在本地浏览该站点时，我收到“无法连接 - Firefox 无法在 localhost 建立与服务器的连接”错误。我做了一些研究，我使用的 apache 版本是 2.2.22。根据 wampserver 网站，这个版本没有 openssl。所以我尝试将 apache 更新到 v2.2.4。更新似乎安装得很好（c:\wamp\bin\apache 中有一个 apache2.2.4 文件夹），但我无法让我的 wampserver 切换。

我该如何继续在我的 wampserver 上创建自签名证书？

# c# - umbraco 内容树节点转 json 格式

> ID：13031459
> 
> 赞同：1
> 
> 时间：2012-10-23T13:24:23.537
> 
> 标签：c#, umbraco

我有一个具有以下内容结构的 umbraco 网站：（括号中的文本是 nodeTypeAlias）

```
[root]
 - [child]
 |  - [module]
 |  |  - [submodule]
 |  |  - [submodule]
 - [child]
 |  - [module]
 |  - [module]
 |  |  - [submodule] 
```

我正在尝试将上述结构（连同节点的属性）导出到以下 json 文件中：

```
{
    "root": {
        "child": [
            {
                "id": "1",
                "name": "Child 1",
                "module": [
                    {
                        "id": "2",
                        "name": "Module 1",
                        "submodule": [
                            {
                                "id": "3",
                                "name": "Sub module 1"
                            },
                            {
                                "id": "4",
                                "name": "Sub module 3"
                            }
                        ]
                    }
                ]
            },
            {
                "id": "5",
                "name": "Child 5",
                "module": [
                    {
                        "id": "8",
                        "name": "Module 8"
                    },
                    {
                        "id": "6",
                        "name": "Module 6",
                        "submodule": [
                            {
                                "id": "7",
                                "name": "Sub module 7"
                            },
                            {
                                "id": "9",
                                "name": "Sub module 9"
                            }
                        ]
                    }
                ]
            }
        ]
    }
} 
```

到目前为止，我已经在 Linqpad 中写下了以下代码，但结果不是我想要的。

```
List<Node> brands = new List<Node>()
{               
    new Node
    {
         id = 1,
        name = "Brand 1",
        type = "brand",
        children = new List<Node>
        {        
            new Node
            {
                id = 2,
                name = "Shelf 1",
                type = "shelf",
                children = new List<Node>
                {
                    new Node
                    {
                        id = 1,
                        name = "Bookcase 1",
                        type = "bookcase"
                    },
                    new Node
                    {
                        id = 2,
                        name = "Bookcase 2",
                        type = "bookcase"
                    },
                    new Node
                    {
                        id = 3,
                        name = "Bookcase 3",
                        type = "bookcase"
                    }
                }
            },
            new Node
            {
                id = 3,
                name = "Shelf 2",
                type = "shelf",
                children = new List<Node>
                {
                    new Node
                    {
                        id=1,
                        type= "module",
                        name = "Module 1"
                    },
                    new Node
                    {
                        id=2,
                        type= "pdf",
                        name = "PDF 1"
                    },
                    new Node
                    {
                        id=3,
                        type= "link",
                        name = "Link 1"
                    },
                    new Node
                    {
                        id=4,
                        type= "link",
                        name = "Link 2"
                    },
                }
            }                   
        }
    },

    new Node
    {
        id = 2,
        name = "Brand 2",
        type = "brand",
        children = new List<Node>
        {
            new Node
            {
                id = 2,
                name = "Shelf 1",
                type = "shelf",
            },
            new Node
            {
                id = 3,
                name = "Shelf 2",
                type = "shelf",
            }
        }
    }
};

Result container = new Result();

Action<List<Node>, Result> add = null;
add = (nodes, coll) =>
{
    List<Result> list = null;
    if(nodes != null && nodes.Count > 0)
    {
        nodes.Dump("nodes");
        foreach(var node in nodes)
        {
            string key = node.type;
            list = null;
            if(coll.Children.ContainsKey(key))
            {
                list = coll.Children[key];
            }
            else
            {
                list = new List<Result>();
            }
            Result r = new Result();
            r.Name = node.name;
            add(node.children, r);
            list.Add(r);
            coll.Children[key] = list;
            coll.Dump("coll");
        }
    }
};

add(brands, container);
container.Dump();
var serializer = new JavaScriptSerializer();
serializer.Serialize(container).Dump();
}

public class Result
{
    public Result()
    {
        this.Children = new Dictionary<string, List<Result>>();
        this.Properties = new Dictionary<string, string>();
    }
    public string Name {get;set;}
    public Dictionary<string, string> Properties {get;set;}
    public Dictionary<string, List<Result>> Children {get;set;}
}

public class Node
{
    public string name{get;set;}
    public string type {get;set;}
    public int id {get;set;}
    public List<Node> children{get;set;} 
```

结果：

```
{
    "Name": null,
    "Properties": {},
    "Children": {
        "brand": [
            {
                "Name": "Brand 1",
                "Properties": {},
                "Children": {
                    "shelf": [
                        {
                            "Name": "Shelf 1",
                            "Properties": {},
                            "Children": {
                                "bookcase": [
                                    {
                                        "Name": "Bookcase 1",
                                        "Properties": {},
                                        "Children": {}
                                    },
                                    {
                                        "Name": "Bookcase 2",
                                        "Properties": {},
                                        "Children": {}
                                    },
                                    {
                                        "Name": "Bookcase 3",
                                        "Properties": {},
                                        "Children": {}
                                    }
                                ]
                            }
                        },
                        {
                            "Name": "Shelf 2",
                            "Properties": {},
                            "Children": {
                                "module": [
                                    {
                                        "Name": "Module 1",
                                        "Properties": {},
                                        "Children": {}
                                    }
                                ],
                                "pdf": [
                                    {
                                        "Name": "PDF 1",
                                        "Properties": {},
                                        "Children": {}
                                    }
                                ],
                                "link": [
                                    {
                                        "Name": "Link 1",
                                        "Properties": {},
                                        "Children": {}
                                    },
                                    {
                                        "Name": "Link 2",
                                        "Properties": {},
                                        "Children": {}
                                    }
                                ]
                            }
                        }
                    ]
                }
            },
            {
                "Name": "Brand 2",
                "Properties": {},
                "Children": {
                    "shelf": [
                        {
                            "Name": "Shelf 1",
                            "Properties": {},
                            "Children": {}
                        },
                        {
                            "Name": "Shelf 2",
                            "Properties": {},
                            "Children": {}
                        }
                    ]
                }
            }
        ]
    }
} 
```

任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:23:06.107

这与生成 XML 的方式非常相似，但 JSON 略有不同。如果您已将 Umbraco 更新到更高版本之一，那么您可以使用 Razor 以这种方式呈现 JSON：

```
    @{
    var builder = new System.Text.StringBuilder();              
    foreach (var car in cars)
    {            
    builder.Append("{");
    builder.Append(Json.Encode("reg") + ":" + Json.Encode(car.Registration) + ",");
    builder.Append(Json.Encode("model") + ":" + car.Model);

    // 在此处插入其他值     

    builder.Append("}");
    if (car.Registration != cars.Last().Registration)
    {
    builder.Append(",");
    }
    计数++；
    }
    }
    @Html.Raw(builder.ToString())

```

另一种更有趣的方式是 JSON.NET - 如果您在应用程序中使用自定义对象，这是一个不错的选择。您填充对象，然后通过 JSON.NET 传递它们。[有关详细信息，请参见此处](http://james.newtonking.com/projects/json-net.aspx)。

```
产品产品 = 新产品（）；
product.Name = "苹果";
product.Expiry = new DateTime(2008, 12, 28);
产品.价格 = 3.99M;
product.Sizes = new string[] { "Small", "Medium", "Large" };

字符串 json = JsonConvert.SerializeObject(product);
//{
// "名称": "苹果",
// "到期": "2008-12-28T00:00:00",
// "价格": 3.99,
//“尺寸”：[
// “小的”，
// “中等的”，
// “大的”
// ]
//}

产品反序列化产品 = JsonConvert.DeserializeObject(json);

```

这个库的美妙之处在于您还可以创建字符串并将它们转换为 JSON。唯一需要注意的是，在尝试读取 JSON 时必须注意 JavaScript。单引号 (') 和双引号 (") 可能会破坏您的代码。

```
字符串 json = @"{
  ""名称"": ""苹果"",
  ""到期"": "2008-12-28T00:00:00",
  ""价格"": 3.99,
  ""尺寸"": [
    ““小的””，
    ““中等的””，
    ““大的””
  ]
}";

JObject o = JObject.Parse(json);

字符串名称 = (string)o["名称"];
// 苹果

JArray 大小 = (JArray)o["Sizes"];

字符串最小 = (string)sizes[0];
// 小的

```

如果您使用 System.Xml 命名空间（XmlDocument、XmlAttributes、XmlNode），您的代码就可以工作。目前尚不清楚您正在使用哪个 Node 对象，但我会假设它是 Umbraco 的 Node（我将使用 new DynamicNode() 而不是 btw），在这种情况下，您不能像使用填充属性那样创建它们。在读取它的值之前，您必须在 Umbraco 数据库中创建一个。

希望这能给你一些东西。*快乐编码*。

# algorithm - dijkstra和A星的区别和优势

> ID：13031462
> 
> 赞同：65
> 
> 时间：2012-10-23T13:24:33.460
> 
> 标签：algorithm, graph, path-finding

我读到这个： [http ://en.wikipedia.org/wiki/A*_search_algorithm](http://en.wikipedia.org/wiki/A*_search_algorithm)

它说 A* 比使用 dijkstra 更快，并使用最佳优先搜索来加快速度。

如果我需要算法在毫秒内运行，A* 什么时候会成为最突出的选择。

据我了解，它不一定会返回最佳结果。

如果我需要快速的结果，预先计算路径会更好吗？存储它们可能需要数兆字节的空间。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-10-23T15:05:08.807

> 它说 A* 比使用 dijkstra 更快，并使用最佳优先搜索来加快速度。

A* 基本上是 Dijkstra 的一个知情变体。
A* 被认为是“最佳优先搜索”，因为它根据`f(v)`[ `f(v) = h(v) + g(v)`] 的值贪婪地选择接下来要探索的顶点 - 其中`h`是启发式方法，`g`是迄今为止的成本。

请注意，如果您使用非信息性启发式函数：`h(v) = 0`对于每个：您会得到 A*仅`v`根据“到目前为止的成本” （算法。`g(v)``h(v) = 0`

> 如果我需要算法在毫秒内运行，A* 什么时候会成为最突出的选择。

不完全是，这取决于很多事情。如果你有一个下降启发式函数——从我个人的经验来看，首先贪婪最好（仅根据启发式函数进行选择）——通常比 A* 快得多（但甚至不是接近最优）。

> 据我了解，它不一定会返回最佳结果。

[如果使用Admissible heuristic function](http://en.wikipedia.org/wiki/Admissible_heuristic)，A* 既是完整的（如果存在则找到路径）和最优的（总是找到最短路径）。如果您的函数不被接受 - 所有赌注都被取消。

> 如果我需要快速的结果，预先计算路径会更好吗？存储它们可能需要数兆字节的空间。

这是对某些问题进行的常见优化，例如[15-puzzle 问题](http://en.wikipedia.org/wiki/Fifteen_puzzle)，但它更高级。从 A 点到 B 点的路径称为宏。有些路径非常有用，应该记住。机器学习组件被添加到算法中，以便通过记住这些宏来加快处理速度。

请注意，此处从 A 点到 B 点的路径通常不在状态图上，而是在问题本身中（例如，如何将正方形从最低线移动到最高线...）

**加快速度：**
如果您有启发式算法并且发现它太慢，并且想要更快的解决方案，即使不是最佳解决方案 - [A* Epsilon](http://en.wikipedia.org/wiki/A*_search_algorithm#Bounded_relaxation)通常比 A* 更快，同时为您提供路径最优性的界限（它与最佳状态的接近程度）。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2017-04-23T05:40:39.267

Dijkstra 是 A* 的一个特例（当启发式为零时）。

A* 搜索：

它有两个成本函数。

```
g(n): same as Dijkstra. The real cost to reach a node n.
h(n): approximate cost from node n to goal node. It is a heuristic function. This heuristic function should never overestimate the cost. That means, the real cost to reach goal node from node n should be greater than or equal h(n). It is called admissible heuristic. 
```

每个节点的总成本由 f(n)=g(n)+h(n) 计算

迪杰斯特拉：

它有一个成本函数，即从源到每个节点的实际成本值： f(n)=g(n) 它只考虑实际成本来找到从源到每个其他节点的最短路径。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-10-23T13:34:29.743

**A***就像**Dijkstra**一样，唯一的区别是 A* 尝试通过使用启发式函数来寻找更好的路径，该函数优先考虑应该比其他节点更好的节点，而 Dijkstra 只是探索所有可能的路径。

它的最优性取决于所使用的启发式函数，所以是的，它可以因此返回非最佳结果，同时更好地为您的特定布局提供启发式，并且结果（可能还有速度）会更好。

它意味着比 Dijkstra 更快，即使它需要更多的内存和每个节点的更多操作，因为它探索的节点要少得多，并且在任何情况下增益都很好。

如果您需要实时结果并且图表非常大，那么预先计算路径可能是唯一的方法，但通常您希望不那么频繁地寻找路径（我假设您想要经常计算它）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-04-20T23:56:51.887

这些算法可用于寻路和图遍历，即在称为节点的多个点之间绘制有效定向路径的过程。

的公式`a* is f =g + h.`，`g`表示实际成本，h 表示启发式成本。Dijktras 的公式是`f = g`. 没有启发式成本。当我们使用时`a*`，如果启发式成本是`0`那么它将等于 Dijktras 算法。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-10-23T15:19:03.787

简短回答：A* 使用启发式算法来优化搜索。也就是说，您可以定义一个函数，在某种程度上可以估计从一个节点到目标的成本。当您在地理表示（地图）上搜索路径时，这特别有用，例如，您可以在其中猜测从给定图形节点到目标的距离。因此，通常 A* 用于游戏等中的路径查找。其中 Djikstra 用于更通用的情况。

不，A* 并不总是给出最佳路径。如果启发式是“地理”距离，则以下示例可能会给出非最佳路径。

```
[airport] - [road] - [start] -> [road] -> [road] -> [road] -> [road] -> [target] - [airport]
        |----------------------------------------------------------------| 
```

# ant - 如何在 Jenkins 工作中启动 Selenium

> ID：13031463
> 
> 赞同：1
> 
> 时间：2012-10-23T13:24:36.127
> 
> 标签：ant, selenium, jenkins, selenium-rc, jenkins-plugins

我正在使用 Jenkins 和 Ant 来执行我的 Selenium 测试。我想做一份可以做以下事情的工作：

*   启动 Selenium 服务器
*   执行测试和
*   在所有测试运行后杀死 Selenium 服务器。

我可以使用以下命令手动启动 Selenium 服务器：

```
java -jar selenium-2.16.1\selenium-server-standalone-2.25.jar 
```

但是我找不到可以为我启动/停止的 Jenkins 插件。我只能找到一些 Selenium 报告插件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T14:28:10.577

不确定是否有插件，但您可以通过 Jenkins 作业运行启动和终止命令。在构建下，如果您添加`Execute shell`构建步骤，您可以从那里运行您的命令。

*注意*- selenium 服务器的路径是相对于当前工作目录的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-01T00:55:13.613

查看您的错误跟踪，看起来您正在 Windows PC 上运行它。您需要将其作为“执行 Windows 批处理命令”运行，然后运行
​​java -jar selenium-2.16.1\selenium-server-standalone-2.25.jar
假设您在工作区中有 jar 文件。或者你需要把它指向正确的路径

# c# - 从 WinRT 中的 ListView 获取选定项信息

> ID：13031465
> 
> 赞同：0
> 
> 时间：2012-10-23T13:25:01.193
> 
> 标签：c#, listview, windows-runtime

我有以下代码使用 Flickr 中的照片填充 ListView

```
 private async void ParseFlickrResponse(HttpResponseMessage response)
    {
        XDocument xml = XDocument.Parse(await response.Content.ReadAsStringAsync());          
        var photos = from results in xml.Descendants("photo")
                     select new FlickrImage
                     {
                         ImageId = results.Attribute("id").Value.ToString(),
                         FarmId = results.Attribute("farm").Value.ToString(),
                         ServerId = results.Attribute("server").Value.ToString(),
                         Secret = results.Attribute("secret").Value.ToString(),
                         Title = results.Attribute("title").Value.ToString()
                     };

        FlickrListView.ItemsSource = photos;
    } 
```

然后，我希望能够从此 ListView 中获取单个项目的源数据以在其他地方使用。但是，我似乎无法使用某些命令到达任何地方。我对 C# 很陌生，我不知道是否应该使用 SelectedItems、Items 或 SelectedIndex 方法来查找我的照片存储在哪个节点中。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:31:04.927

您可以使用这段代码：

**编辑：**与`SelectedItems`

```
Dictionary<string, List<string>> dict =
    FlickrListView.SelectedItems
            .Cast<ListViewItem>()
            .ToDictionary(
                item => item.Text,
                item => item.SubItems
                            .Cast<ListViewItem.ListViewSubItem>()
                            .Select(subItem => subItem.Text)
                            .ToList()); 
```

或者

```
foreach (var item in FlickrListView.SelectedItems)
{
    FlickrImage obj = (FlickrImage) item;
    // ... do something ...
} 
```

# javascript - 修改函数内的全局 javascript 变量

> ID：13031467
> 
> 赞同：0
> 
> 时间：2012-10-23T13:25:14.733
> 
> 标签：javascript, jquery

我正在尝试在函数内部克隆一个 json 对象，以访问函数外部的对象。但是当函数完成时，对象似乎仍然是未定义的。好像不是同一个变量？

```
var jsonUserObj;
$.getJSON("user.json", function(content){
    jsonUserObj = $.parseJSON(JSON.stringify(content));
    console.log(content);
    console.log(jsonUserObj); //looks fine!
});
console.log(jsonUserObj); //undefined 
```

在回调函数内部，它包含所有数据，但不会保留在其外部。如何使其在全球范围内可评估？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:28:22.727

$.getJSON 是异步的，因此代码末尾的 console.log 在 $.getJSON 返回其结果之前运行。

您应该修改回调中的变量（*看起来不错*），然后在该函数中使用该变量，此回调是您可以保证设置变量的唯一地方。

您也可以使用 $.ajax 的同步版本，但这确实不推荐（而且可能没有必要）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:28:08.820

你有一个错字：

```
console.log(jsonUserObject); 
```

它应该是

```
console.log(jsonUserObj); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:27:47.467

您需要`var jsonUserObj`在函数外部声明。

看起来你有一个 typeo，是 jsonUserObj 还是 jsonUserObject？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T13:28:48.493

会不会是时间问题？如果该 getJSON 方法是异步触发的，那么在您触发最后一行时它可能还没有返回它的值。那有意义吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-23T13:33:52.650

`$.getJSON`执行一个异步的ajax调用。它之后的代码将在等待响应时继续评估。当响应返回时，程序流将跳回 ajax 调用的成功/错误/完成处理程序。

tldr：您对来自 ajax 调用的数据所做的任何事情都必须在该 ajax 调用的成功处理程序中。

# hibernate - JPA 单表继承：无法查询基础实体

> ID：13031469
> 
> 赞同：0
> 
> 时间：2012-10-23T13:25:22.097
> 
> 标签：hibernate, jpa, jpa-2.0

我有以下实体：

```
@Entity
@Table(name = "TABLENAME")
@Inheritance(strategy=InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name="discriminator", discriminatorType=DiscriminatorType.STRING)
public class Base { ... }

@Entity
@DiscriminatorValue("value1")
public class SubEntity1 extends Base {}

@Entity
@DiscriminatorValue("value2")
public class SubEntity2 extends Base {} 
```

我需要在不知道结果的实际类型的情况下进行查询。就像是：

```
select b from Base b where b.discriminator=? and ... 
```

我得到这个例外：`Object with id: 31 was not of the specified subclass: packagename.Base`

在这种情况下，查询结果将仅包含同一子实体的实例，但我还有其他查询，结果将是“混合”的。

有没有办法进行这样的查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T21:06:51.857

您正在尝试检索根级别 parent `Entity`。`@DiscriminatorValue(value = "your_base")`如果是这样，您需要添加`Base`实体类。即使没有它的子类，也可以。它已经在[这里](https://stackoverflow.com/questions/4256393/jpa-table-per-class-inheritance-how-to-only-select-superclass-entries)发布。

# javascript - 从选择列表创建自动链接

> ID：13031470
> 
> 赞同：1
> 
> 时间：2012-10-23T13:25:24.003
> 
> 标签：javascript, html, select

我有一个`<select>`通过外部 API 收到的简单列表，无法更改。

我的问题如下：我想将此`<select>`列表转换为一堆常规的 html 链接。我想以不适用的方式使用 CSS 为列表设置样式`<select>`。我用“显示：无”隐藏原始列表

这：

```
<select style="display:none;">
  <option value="E1">Entry 1</option>
  <option value="E2">Entry 2</option>
  <option value="E3">Entry 3</option>
</select> 
```

应转换为：

```
<a href="E1" class="X1">Entry 1</a>
<a href="E2" class="X2">Entry 2</a>
<a href="E3" class="X3">Entry 3</a> 
```

我如何实现这一目标？

我找到了解决方案，但方法不对！[从列表中创建 <select> - 缩进子项？](https://stackoverflow.com/questions/9358148/create-select-from-list-indent-child-items)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T10:29:42.990

这是一个解决方案，可以在[http://jsfiddle.net/C5S32/44/进行测试](http://jsfiddle.net/C5S32/44/)

```
var options = '';
$('select').find('option').each(function () {
    var
    val = $(this).val(),
    text = $(this).text(),
    i = 1;
    options += '<a href="' + val + '">' + text + '</a>';
});
$('<div class="test" />').append(options).appendTo('#selectnav'); 
```

# windows - Windows 7 中的 Sphinxtrain 快照

> ID：13031474
> 
> 赞同：0
> 
> 时间：2012-10-23T13:25:34.700
> 
> 标签：windows, cmusphinx

我已经在 Windows 7 计算机上下载了 sphinxbase.tar.gz 和 sphinxtrain.tar.gz。使用 Visual Studio 2010 构建。我已经安装了 Activeperl，python 3.3。

在教程[http://cmusphinx.sourceforge.net/wiki/tutorialam](http://cmusphinx.sourceforge.net/wiki/tutorialam)它说：

**对于 sphinxtrain 快照**

```
sphinxtrain -t an4 setup 
```

它可能适用于linux系统。如何在 Windows 7（64 位）中运行 sphinxtrain（快照）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T18:32:54.763

Windows 支持仍在测试中。我有一个这样的补丁，但还没有提交。补丁在这里：

[http://pastebin.com/NQyNQEHx](http://pastebin.com/NQyNQEHx)

在 Windows 上运行：

*   首先，打开 Visual Studio 项目 SphinxTrain.sln 并构建它
*   在 bin\Debug 或 bin\Release 中复制以下文件：
    *   pocketsphinx_batch.exe 和 pocketsphinx.dll 来自 pocketsphinx 包
    *   sphinxbase 包中的 sphinx_fe.exe 和 sphinxbase.dll
*   从训练数据库的目录运行：
    *   python SPHINX_DIR\SphinxTrain\scripts\sphinxtrain.in -t db_name 设置
    *   python SPHINX_DIR\SphinxTrain\scripts\sphinxtrain.in 运行
*   请注意，脚本首先考虑 bin/Release，如果不存在，则考虑 bin/Debug

同时，您可以将发布中的脚本与快照中的二进制文件一起使用，结果不会有所不同。

# ruby-on-rails-3 - number_to_currency 删除小数点

> ID：13031475
> 
> 赞同：0
> 
> 时间：2012-10-23T13:25:35.207
> 
> 标签：ruby-on-rails-3, number-to-currency

有没有办法将显示中的值更改为以下内容：

100.25 美元到 10025

需要采用这种格式才能通过支付网关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T18:36:41.257

您可以使用[String.delete](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-delete)方法：

```
"$100.25".delete("$.")
=> 10025 
```

# asp.net-mvc - DCI 上下文中的错误处理？

> ID：13031476
> 
> 赞同：1
> 
> 时间：2012-10-23T13:25:40.537
> 
> 标签：asp.net-mvc, dci

如果我使用 ASP.NET MVC 框架，实例化一个 Context 并且那里出现问题，是否可以抛出异常并让 Controller 处理它？

然后对于嵌套上下文，外部上下文是否可以捕获内部上下文抛出的异常？我在想是因为上下文无法相互了解，但另一方面，错误就是错误……对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T17:34:35.507

嵌套上下文是在另一个上下文中发挥作用的上下文。外部上下文当然知道所述上下文中的角色（上下文是唯一知道角色的对象）内部上下文的异常在这方面与任何其他 RolePlayer 的异常没有什么不同

# php - Wordpress 自定义帖子类型添加标签

> ID：13031483
> 
> 赞同：0
> 
> 时间：2012-10-23T13:26:08.917
> 
> 标签：php, wordpress

我目前正在一个 Wordpress 网站上工作，我已经创建了一些自定义帖子类型，所有这些都可以正常创建帖子等。

但是，我需要的是具有一些自定义帖子类型的自定义分类法，我已经设置了它，并且在向分类法添加不同的标签时它可以工作，但是，在分类法块中为自定义帖子类型创建帖子时，单击添加标签它只是做一个锚链接到#Member news Category-add

没有其他任何反应，这不是一个大错误，但我想修复这个问题，以便在我上线时正确

这是一个已知的错误？还是在创建自定义帖子类型时我可能遗漏了什么？

```
 register_post_type('member_news', array(   'label' => 'Member News','description' => 'News content submitted by members of RRUKA.','public' => true,'show_ui' => true,'show_in_menu' => true,'capability_type' => 'post','hierarchical' => false,'rewrite' => array('slug' => 'member-news'),'query_var' => true,'has_archive' => true,'exclude_from_search' => false,'menu_position' => 5,'supports' => array('title','editor','excerpt','trackbacks','revisions','thumbnail','author','page-attributes',),'labels' => array (
  'name' => 'Member News',
  'singular_name' => 'Member News',
  'menu_name' => 'Member News',
  'add_new' => 'Add Member News',
  'add_new_item' => 'Add New Member News',
  'edit' => 'Edit',
  'edit_item' => 'Edit Member News',
  'new_item' => 'New Member News',
  'view' => 'View Member News',
  'view_item' => 'View Member News',
  'search_items' => 'Search Member News',
  'not_found' => 'No Member News Found',
  'not_found_in_trash' => 'No Member News Found in Trash',
  'parent' => 'Parent Member News',
),) ); 
```

非常欢迎有关这方面的任何信息

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T16:57:16.493

您忘记在数组
'taxonomies' => array('category', 'post_tag') 中添加此参数，

```
register_post_type('member_news', array(   'label' => 'Member News','description' => 'News content submitted by members of RRUKA.','public' => true,'show_ui' => true,'show_in_menu' => true,'capability_type' => 'post','hierarchical' => false,'rewrite' => array('slug' => 'member-news'),'query_var' => true,'has_archive' => true,'exclude_from_search' => false,'menu_position' => 5,'supports' => array('title','editor','excerpt','trackbacks','revisions','thumbnail','author','page-attributes',),
'taxonomies' => array('category', 'post_tag') , 
'labels' => array (
  'name' => 'Member News',
  'singular_name' => 'Member News',
  'menu_name' => 'Member News',
  'add_new' => 'Add Member News',
  'add_new_item' => 'Add New Member News',
  'edit' => 'Edit',
  'edit_item' => 'Edit Member News',
  'new_item' => 'New Member News',
  'view' => 'View Member News',
  'view_item' => 'View Member News',
  'search_items' => 'Search Member News',
  'not_found' => 'No Member News Found',
  'not_found_in_trash' => 'No Member News Found in Trash',
  'parent' => 'Parent Member News',
),) ); 
```

# sql - “无法打开数据库 - 登录失败”。在 Management Studio 中工作，而不是在代码中工作

> ID：13031484
> 
> 赞同：2
> 
> 时间：2012-10-23T13:26:09.443
> 
> 标签：sql, sql-server, sql-server-2008, umbraco, ssms

哦，是的，著名的错误：

> 无法打开登录请求的数据库“MYDBNAME”。登录失败。用户“USERNAME”登录失败。

**先说明一下我的情况：**

我有一个数据库服务器，它有一个 SA 帐户和我的用户帐户。用户对我的数据库 (dbowner) 有正确的映射。

我可以在 SQL 服务器本身（使用 localhost）和我的前端服务器上使用 SQL Management Studio 2008 R2 使用该用户打开数据库。

但是，当我运行我的应用程序时，出现登录失败错误。

奇怪的是我的前端服务器上有一个测试应用程序和一个生产应用程序。测试应用在同一个数据库服务器上有测试数据库，这里不存在登录问题。两者之间的唯一区别是前缀从“TEST”到“PROD”不同。测试应用程序有效，但生产却没有。用户映射似乎应该适用于两者。

有任何想法吗？

**编辑：**

我们的连接字符串：

```
<add key="umbracoDbDSN" value="Server=Websqlsrv01;Database=PROD_Databasename;User ID=umbraco_user;Password=password;Trusted_Connection=False" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:54:51.430

sql server 有二分法登录/用户

它们是 2 个不同的实体：

[http://www.akadia.com/services/sqlsrv_logins_and_users.html](http://www.akadia.com/services/sqlsrv_logins_and_users.html)

也许您的 sql 登录名与数据库 PROD_Databasename 的用户无关，而仅与 TEST_Databasename 的用户相关联

另一个原因可能是用户默认数据库或最终不同的数据库模式

您可以轻松检查其中一个是否是问题，只需为 PROD_Databasename 创建一个新用户并在连接字符串中使用它。

另一种方法是执行

```
exec sp_helpuser 
```

在两个数据库（PROD 和 TEST）中，查看是否列出了用户名“umbraco_user”。

无论如何，对 2 个不同的用户使用相同的登录名并不是一个好习惯：

[https://dba.stackexchange.com/questions/16374/is-there-any-benefit-to-having-one-sql-server-login-for-multiple-users](https://dba.stackexchange.com/questions/16374/is-there-any-benefit-to-having-one-sql-server-login-for-multiple-users)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T15:25:31.093

`servername\instancename`如果您设置的不是*默认*实例，有时您需要在连接字符串中使用。使用[此](http://social.msdn.microsoft.com/Forums/en-US/sqlgetstarted/thread/eb58a7fe-4647-4eea-91e3-6ee369362d64/)链接查找您的实例名称。试试看！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T15:21:02.887

right click on you application and run as admin. This should work!

# apache - 将参数改写为 url（example.com?url=/about-us 改写为 example.com/about-us）

> ID：13031488
> 
> 赞同：1
> 
> 时间：2012-10-23T13:26:25.580
> 
> 标签：apache, .htaccess, url-rewriting, silverstripe

我有一些我希望重写的 CMS（SilverStripe CMS）生成的 URL。出于某种原因，可以通过将 a 附加`?url=`到查询字符串来设置 URL。

所以`example.com?url=/about-us`并`example.com/about-us`给出了相同的页面。
你甚至可以这样做`example.com/some-page/?url=/about-us`，你仍然会得到关于我们的页面。

那么：如何将包含参数“url”的任何 URL 重写为`domain.tld`+ URL 参数的值？（`example.com?url=/about-us`等等`example.com/some-page/?url=/about-us`进入`example.com/about-us`）。

希望有人可以提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T21:43:36.810

尝试将这些规则添加到文档根目录中的 htaccess 文件中：

```
RewriteEngine On
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /[^\?]*\?url=([^&\ ]+)&?([^\ ]*)
RewriteRule ^ /%1?%2 [L,R=301] 
```

这将接受带有`url=<something>`查询字符串参数的任何请求，完全忽略 URI，并将浏览器重定向到`/<something>`并附加任何查询字符串。

# paypal - 美元到欧盟转换/贝宝

> ID：13031489
> 
> 赞同：0
> 
> 时间：2012-10-23T13:26:27.953
> 
> 标签：paypal

我刚刚在这里开发了一个 PHP 购物车：

[http://dooweet.org/fr/store/](http://dooweet.org/fr/store/)

问题是，当我想通过贝宝订购时，贝宝将我的欧元转换为美元……在发送请求期间，我没有在代码中找到我的问题。

我怎样才能强制贝宝收到欧元而不是美元的结帐？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:44:26.610

将您的 Paypal 帐户默认货币设置为 EUR

# c# - 无法在 WPF 中创建 Metro 风格的消息框

> ID：13031493
> 
> 赞同：0
> 
> 时间：2012-10-23T13:26:31.970
> 
> 标签：c#, wpf, caliburn.micro, mahapps.metro

我曾尝试使用这篇文章创建消息框，但无法在没有错误的情况下编译它。文章在这里：[http ://www.sjurvarhaug.com/metro-style-messagebox-in-wpf](http://www.sjurvarhaug.com/metro-style-messagebox-in-wpf)

它给出了许多错误，例如“未找到此类类型”等...我已将项目上传到 skydrive。您可以下载并测试 ti。 [https://skydrive.live.com/redir?resid=89FD450CC0CC74DA!181](https://skydrive.live.com/redir?resid=89FD450CC0CC74DA!181)

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:59:42.470

添加

```
 <BooleanToVisibilityConverter x:Key="bool2vis" /> 
```

在资源部分，然后将您的绑定更新为

```
Converter={StaticResource bool2vis} 
```

那应该解决它:)

遗憾的是教程错过了这一点..

干杯。圣。

# vba - 使用 Excel VBA 浏览主 excel 文件和另存为目录路径

> ID：13031495
> 
> 赞同：0
> 
> 时间：2012-10-23T13:26:38.713
> 
> 标签：vba, excel, excel-2007

我收集了以下 Excel 程序，并将其用于不同工作簿下的几个不同计算。所以我想每次都更改主文件和结果文件的程序，我应该能够选择要在其中进行计算的文件和结果文件的文件路径。

但是我找不到任何可以保存目录的东西，如果您能提供帮助，我将不胜感激

```
Sub AsBuiltForm()

Dim SaveName As String
Dim mainBook As Workbook

a = InputBox("ENTER FIRST NUMBER ")
b = InputBox("ENTER LAST NUMBER ")

Workbooks.Open Filename:="C:\"  'main file can be browsed? 

Set mainBook = Excel.Workbooks("CP.xlsx")

    For i = a - 1 To b - 1

        mainBook.Sheets(1).Range("bi1") = i + 1
        SaveName = Sheets(1).Range("bi1").value & ".xlsx"

        mainBook.SaveCopyAs "C:\" & SaveName 'save directory?
        Workbooks.Open Filename:="C:\" & SaveName 'save directory?

        With Excel.ActiveWorkbook
            .Sheets("1 of 2").Range("A1:CT103").value = Sheets("1 of 2").Range("A1:CT103").value
            .Sheets("2 of 2").Range("A1:CT103").value = Sheets("2 of 2").Range("A1:CT103").value
            Excel.Application.DisplayAlerts = False
            .Sheets("Sheet1").Delete
            .Sheets("il oufall").Delete

            .Sheets("1 of 2").Select
            Columns("Bh:BZ").Select
            Selection.Delete Shift:=xlToLeft

            .Sheets("2 of 2").Select
            Columns("Bn:BZ").Select
            Selection.Delete Shift:=xlToLeft

            .Close True

        End With

    Next

mainBook.Close False
Set mainBook = Nothing

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:38:56.240

您可以使用`Application.GetOpenFileName`来选择要在运行时打开的文件。

您可以使用以下功能浏览您希望保存文件的文件夹。

```
Sub FindFolder()

Dim myFolder as String
myFolder = BrowseFolder("Pick a Folder Where to Save")

End Sub

Function BrowseFolder(Optional Caption As String, Optional InitialFolder As String) As String

' based on Browse For Folder from:
' http://www.cpearson.com/excel/BrowseFolder.aspx
' this functions requires that the following Reference is active:
    'Microsoft Shell Controls and Automation

Const BIF_RETURNONLYFSDIRS As Long = &H1

Dim wsh As Object
Dim SH As Shell32.Shell
Dim F As Shell32.Folder

Set wsh = CreateObject("Wscript.Shell")
Set SH = New Shell32.Shell
Set F = SH.BrowseForFolder(0&, Caption, BIF_RETURNONLYFSDIRS, InitialFolder)
If Not F Is Nothing Then
    If F = "Desktop" Then
        BrowseFolder = wsh.Specialfolders(F)
    Else
        BrowseFolder = F.Items.Item.path
    End If
End If

End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T14:24:34.837

以下内容并不是您问题的真正答案，而是一些改进代码的提示，并且由于太长而无法添加为评论。

`Workbooks.Open`返回一个`Workbook`可以保存引用的对象，因此您不必依赖`ActiveWorkbook`：

```
Dim oWorkbook As Workbook

Set oWorkbook = Workbooks.Open(Filename:="C:\" & SaveName)

'***** Do something with oWorkbook
Debug.Print oWorkbook.FullName

Set oWorkbook = Nothing 
```

其他一些提示：

*   `Option Explicit`在每个模块的顶部使用强制显式声明所有变量，以便更早地发现拼写错误和其他错误。

*   [避免选择单元格](https://stackoverflow.com/q/10714251/1490783)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T05:06:36.000

是的，现在可以浏览文件了；除了所有的来龙去脉，我在命名文件时遇到的问题是由于变量“bi1”并保存了我要求的尽可能多的循环。在打扰您之前，我检查了几次，但我认为我没有足够的信息来解决“fn”作为使用 Application.GetOpenFileName 的文件。

```
Option Explicit

Sub AsBuiltForm()

    Dim fn
    Dim myFolder As String
    Dim SaveName As String, a As Integer, b As Integer, i As Integer      

    myFolder = BrowseFolder("Pick a Folder Where to Save")

    MsgBox "Choose Calculation File "
     fn = Application.GetOpenFilename

Workbooks.Open fn                

    a = InputBox("ENTER FIRST NUMBER ")
    b = InputBox("ENTER LAST NUMBER ")        

For i = a - 1 To b - 1 Step 1

Application.DisplayAlerts = False

Workbooks.Open Filename:=fn

    Range("bi1") = i + 1

    SaveName = ActiveWorkbook.Sheets(1).Range("bi1").value

    Sheets(1).Range("A1:CT103").value = Sheets(1).Range("A1:CT103").value

    Sheets(2).Range("A1:CT103").value = Sheets(2).Range("A1:CT103").value

    Application.ActiveWorkbook.SaveAs myFolder & SaveName

    ActiveWorkbook.Close True

    Next

End Sub  

Function BrowseFolder(Optional Caption As String, Optional InitialFolder As String) As String

' based on Browse For Folder from:
' http://www.cpearson.com/excel/BrowseFolder.aspx
' this functions requires that the following Reference is active:
    'Microsoft Shell Controls and Automation

Const BIF_RETURNONLYFSDIRS As Long = &H1

Dim wsh As Object
Dim SH As Shell32.Shell
Dim F As Shell32.Folder

Set wsh = CreateObject("Wscript.Shell")
Set SH = New Shell32.Shell
Set F = SH.BrowseForFolder(0&, Caption, BIF_RETURNONLYFSDIRS, InitialFolder)
If Not F Is Nothing Then
    If F = "Desktop" Then
        BrowseFolder = wsh.Specialfolders(F)
    Else
        BrowseFolder = F.Items.Item.Path
    End If
End If    
End Function 
```

# python - 带小道运行时，扭曲的反应器没有收到任何回复

> ID：13031502
> 
> 赞同：1
> 
> 时间：2012-10-23T13:26:56.113
> 
> 标签：python, twisted

## 这里是

*   有类*Body*将消息发送到远程 Perspective Broker (PB) *Friend*。

*   测试是检查*Me*实例是否可以 通过调用 *speak_ *to* _friend* 或*tell*方法与*Friend通信。*

***   *speak* _ *to* *_friend*是Soul.speak虚函数的*封装*，被*Body.tell*方法覆盖。 *Soul*类被封装到*Body中*

    *   *tell*方法通过等待*接收到*的回调函数中的*gotAnswer*事件来模拟阻塞调用。

    **   根据打印输出，对于单元测试和独立案例，*Friend*以相同的方式与*我交流。**** 

 **## 问题

...是在试用运行单元测试（ *unittest-me.py ）时，**接收到*的回调永远不会被调用。而不是在客户端打印的愚蠢错误消息：

> 连接被干净地关闭

对我来说，在延迟队列完全处理之前，reactor 似乎已关闭。

如果我正在运行独立测试*test-body.py*，那么一切都会按预期进行：*朋友与我交谈！*

## 问题

1.  为什么在这种情况下 unittest 的行为会有所不同？
2.  如何解决？

* * *

### 单元测试输出

```
Python2.7\Scripts\trial.py ..\Soapbox\Node\unittest-me.py
unittest-me
  Trial_TestCase
    test_conversation ... wake upConnecting to localhost:18800

DBG: speak
DBG: say
                                               [FAIL]
Friend not willing to talk with me because:  [Failure instance: Traceback (failure with no frames): <class 'twisted.internet.error.ConnectionDone
'>: Connection was closed cleanly.
]

===============================================================================
[FAIL]
Traceback (most recent call last):
  File "..\Soapbox\Node\unittest-me.py", line 50, in test_conversation
    self.assertTrue(answer is not None, "Friend gave no answer")
twisted.trial.unittest.FailTest: Friend gave no answer

unittest-me.Trial_TestCase.test_conversation
-------------------------------------------------------------------------------
Ran 1 tests in 3.096s

FAILED (failures=1) 
```

### 测试体输出

```
python test-body.py
connector:  <twisted.internet.tcp.Connector instance at 0x01C87940>
Press any key to continue...Starting reactor

wake upDBG: speak
DBG: say

DBG: received
Friend's reply: <username>
Press any key to continue...

That's all 
```

### 朋友的输出

```
Dr. Livesey: I got your words: whoami
DBG: answer:  <username>

Dr. Livesey: I got your words: whoami
DBG: answer:  <username> 
```

### 单元测试-me.py

```
from twisted.trial import unittest
from twisted.spread import pb
from twisted.internet import reactor
from body import Body

class Trial_TestCase(unittest.TestCase):

    def setUp(self):
        self.ref = None
        self.Me = Body('localhost', 18800)
        self.assertTrue(self.Me is not None, "Creating Me assertion failed")
        self.Me.start()

        self.Me.pbFactory = pb.PBClientFactory(self.Me)

        print "Connecting to " + self.Me.hostName + ":" + str(self.Me.portNo)
        connector = reactor.connectTCP(self.Me.hostName,
                                       self.Me.portNo,
                                       self.Me.pbFactory)
        self.addCleanup(connector.disconnect)

        # =====================================================================
        # unittest related parts
        # =====================================================================
        def gotRoot(ref):
            self.ref = ref

        df = self.Me.pbFactory.getRootObject()
        '''
            Without this dummy call, I can say no word - say not called
        '''
        obj = df.addCallback(gotRoot)
        return obj

    def tearDown(self):
        self.Me.remoteObj.broker.transport.loseConnection()
        self.Me.pbFactory.disconnect()
        pass

    def test_conversation(self):
        # answer = self.Me.speak_to_friend()
        answer = self.Me.tell(None)
        self.assertTrue(answer is not None, "Friend gave no answer")

        return self.Me.dm

if __name__ == "__main__":
    #import sys;sys.argv = ['', 'Test.testName']
    unittest.main() 
```

### 测试body.py

```
if __name__ == '__main__':
    pass

from twisted.spread import pb
from twisted.internet import reactor, threads
import threading
import time
from body import Body

def controlThread(name, body):
    print "Press any key to continue..."
    raw_input()

    body.start()

    result = body.tell(None)

    print "Friend's reply: " + str(result)

    print "Press any key to continue..."
    raw_input()
    reactor.stop()
    pass

body = Body('127.0.0.1', 18800)
f = pb.PBClientFactory(body)
body.pbFactory = f

connector = reactor.connectTCP("127.0.0.1", 18800, f)
print "connector: ", connector

threading.Thread(target=controlThread, args=("Control", body)).start()
print "Starting reactor"
reactor.run()
print "That's all" 
```

### 正文.py

```
import threading
import types

class Soul():
    def speak(self):
        '''
            virtual method must be overwritten by derived class
        '''
        raise NotImplementedError("I cannot speak without a body. "\
                                  "Please give me body first")
        pass

class Body(threading.Thread):
    def __init__(self, hostname, portno):
        self.hostName = hostname
        self.portNo   = portno

        self.df = None
        self.dg = None
        self.dm = None
        self.remoteObj = None
        self.pbFactory = None

        self.answer = None
        self.gotAnswer = threading.Event()

        self.Soul = Soul()
        self.Soul.speak = types.MethodType(self.tell, self.Soul)

        threading.Thread.__init__(self)
        pass

    def run(self):
        print "wake up"
        pass

    def speak_to_friend(self):
        print 'DBG: speak_to_friend'
        return self.Soul.speak()

    def tell(self, soul):
        print 'DBG: speak'
        self.df = self.pbFactory.getRootObject()

        self.answer = None
        self.gotAnswer.clear()
        self.dg = self.df.addCallback(self.say)
        self.gotAnswer.wait(timeout=3)
        return self.answer

    def say(self, remoteObj):
        print 'DBG: say'
        self.remoteObj = remoteObj
        self.dm = remoteObj.callRemote('talk', 'whoami')
        self.dm.addCallback(self.received)
        self.dm.addErrback(self.broken)
        pass

    def received(self, (answer, result)):
        print 'DBG: received'
        self.answer = '\n\t'.join(str.splitlines(answer))
        self.gotAnswer.set()
        pass

    def broken(self,reason):
        print "Friend not willing to talk with me because: ", reason.getErrorMessage()
        pass 
```

### 朋友.py

```
from twisted.spread import pb
from twisted.internet import reactor
from twisted.internet import defer

from subprocess import Popen
import subprocess

from twisted.web import _newclient

class BrokenError(pb.Error):    pass

class Friend(pb.Root):
    def __init__(self,name):
        self.counter = 0
        self.name = str(name)

    def remote_broken(self):
        msg = "I don't hear you"
        print "Talk louder" % msg
        raise BrokenError(msg)

    def broken(self,reason):
        print "Communication is broken: ", reason.getErrorMessage()
        # print "printError > %r" % failure
        if reason.check(_newclient.RequestGenerationFailed):
            print "printError: RequestGenerationFailed"
            for f in reason.value.reasons:
                print "printError > %r" % f
                print f.getTraceback()
        pass

    def remote_talk(self,words):
        print self.name + ": I got your words: " + words

        process = Popen(words,stdout=subprocess.PIPE)
        answer = process.stdout.read()
        process.wait()

        print "DBG: answer: ", answer

        return (answer, process.returncode)

def main():
    reactor.listenTCP(18800, pb.PBServerFactory(Friend("Dr. Livesey")))
    reactor.run()

if __name__ == '__main__':
    main() 
```**

# java - Android：无法实例化接收器

> ID：13031504
> 
> 赞同：0
> 
> 时间：2012-10-23T13:26:58.587
> 
> 标签：java, android, broadcastreceiver, runtimeexception

我正在开发一个接收 SMS 消息并在应用程序中使用此数据的 android 应用程序。因为我希望在关闭应用程序时关闭 SMS 消息的 BroadCastreceiver，所以我将它放在主要活动中：

```
public class App extends Activity {
 public class SmsReceiver extends BroadcastReceiver {
  ...
 }
 ...
} 
```

它被添加到清单中：

```
 <receiver android:name=".App.SmsReceiver" >
        <intent-filter>
            <action android:name="android.provider.Telephony.SMS_RECEIVED" />
        </intent-filter>
    </receiver> 
```

该活动运行良好，直到我收到一条短信。然后我收到以下错误：

```
10-23 15:01:50.019: E/AndroidRuntime(10161): java.lang.RuntimeException: Unable to instantiate receiver be.allys.msgwall.app.App.SmsReceiver: java.lang.ClassNotFoundException: be.allys.msgwall.app.App.SmsReceiver in loader dalvik.system.PathClassLoader[/data/app/be.allys.msgwall.app-1.apk] 
```

这是因为接收器类在另一个类中吗？如果不是因为 StackOverflow 上的另一篇文章建议我这样做的话，这对我来说似乎是一个可能的原因。

如果这不是原因，那是什么？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:34:08.593

当您在清单中注册一个作为 inter 类的接收器时，您应该在清单中声明接收器名称，如**OuterClass$interClass**。

```
<receiver android:name=".App$SmsReceiver" >
    <intent-filter>
        <action android:name="android.provider.Telephony.SMS_RECEIVED" />
    </intent-filter>
</receiver> 
```

**编辑1：**您应该动态注册接收器，因此您需要有两种方法，如下面的代码片段，然后您可以调用Activity的`registerSMSReceiver`onResume*并调用**onPause*`unRegisterSMSReceiver`。这将解决您的问题。

 *```
private void registerSMSReceiver()
{
    IntentFilter filter = new IntentFilter();
    filter.addAction("android.provider.Telephony.SMS_RECEIVED");
    registerReceiver(receiver, filter);
}

private void unRegisterSMSReceiver()
{
    unregisterReceiver(receiver);
} 
```*

# javascript - 当我从 AJAX 调用 WCF Web 服务时出现问题

> ID：13031510
> 
> 赞同：2
> 
> 时间：2012-10-23T13:27:18.917
> 
> 标签：javascript, asp.net, ajax, wcf, web-services

我有一个 Web 应用程序。在这个应用程序中，我添加了一个启用 AJAX 的 WCF 服务。名称是 PricingService，代码如下：

```
namespace PricingService
{
[ServiceContract(Namespace = "PricingService")]
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
public class PricingService
{

    [OperationContract]
    [WebInvoke]
    public double CalculatePrice(string itemId, string shipToPostalCode)
    {
        double price;
        price = 45;
        price = price * 1.06;
        return price;

    }

}
} 
```

我想从 ASP.net 中的网站从 AJAX 调用此服务。在 default.aspx 页面中，我添加了以下代码：

```
 <body>
<form id="form1" runat="server">
<div>

    <asp:ScriptManager ID="ScriptManager1" runat="server">
    <Services>
    <asp:ServiceReference Path="http://localhost:49340/PricingService.svc" />
    </Services>
    </asp:ScriptManager>

    Product: <br />
    <asp:TextBox ID="txtProduct" runat="server"></asp:TextBox>
    <br />
    Ship to (Postal code ):<br />
    <asp:TextBox ID="txtPostCode" runat="server"></asp:TextBox>
    <br />
    <br />
    <input id="ButtonCalculate" type="button" value="Get Price" onclick="buttonCalculate_onClick()"/>
    <br />
    <br />
    <asp:Label ID="LabelPrice" runat="server" Text="Label"></asp:Label>

</div>

<script language="javascript" type="text/javascript">
    function buttonCalculate_onClick() {
        var service = new PricingService.PricingService();
        service.CalculatePrice(document.form[0].txtProduct.value,document.form[0].txtPostCode.value,onSucces,onFail,null);

    }

    function onSuccess(result) {
        LabelPrice.innerText = result;
    }

    function onFail(result) {
        alert(result);
    }

</script>
</form>
</body> 
```

当我单击按钮时，我收到消息：'PricingService' 未定义 有人可以告诉我有什么问题吗？网站和 wcf 服务在同一个名为“WcfServiceApplication”的项目中 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T15:01:54.943

微软那边的人有一些非常好的文档。我不会重复他们所有的东西，而是为你指出正确的方向。
[本文](http://msdn.microsoft.com/en-us/library/bb514961%28v=vs.90%29.aspx)向您展示了如何设置您的服务。下一篇文章将向您展示如何使用它。希望这可以帮助。

# testing - 如何使用测试模拟生产并发问题

> ID：13031511
> 
> 赞同：2
> 
> 时间：2012-10-23T13:27:27.493
> 
> 标签：testing, concurrency

我有一个应用程序，它从队列中接收一个对象，对其进行转换并将其发布到一个主题上。它是一个消息驱动的 bean (spring) 消息侦听器容器，具有相当数量的内部 bean。

最近在 prod 盒上发生了一些奇怪的活动。我们想检查这是否是并发问题。这很棒，但不是我以前做过的事情。

我的方法是在应用程序中抽取大量消息。编写一个软件来听它的发布主题。使用这些并通过类似于 Junit 测试的方式处理它们，该测试将对象属性与预期结果进行比较。

我已经在上面添加了一些关于问题的范围，但基本上市场上是否有任何应用程序可以插入到我的代码或我的 IDE 中，这将使我能够做到这一点。我认为这有点超出了 JUNIT 的能力

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T05:34:11.480

对于这种类型的练习，我会推荐[JavaPathfinder (JPF) 。](http://babelfish.arc.nasa.gov/trac/jpf)

`JPF`本质上是一个 JVM，它以各种可能的方式模拟代码的执行——例如模拟字节码指令的所有可能的交错。JPF 的工作原理是`model checker`探索应用程序可以进入的一组可能状态，并根据预定义的规则（例如 、 等）评估`deadlock free`它们`non-null`。

当应用程序变得过于复杂时，模型检查器通常会失败，但 JPF 能够在不遍历整个状态空间的情况下执行应用程序，并且通常能够很快达到问题状态。试着看看那个。

# c# - 为什么 ToList() 在 linq 中不起作用？

> ID：13031513
> 
> 赞同：3
> 
> 时间：2012-10-23T13:27:32.253
> 
> 标签：c#, linq

我在对包含多个字段的数据进行排序时遇到问题

这是我使用过的示例代码：

```
 var Item = from itm in DB.Items
select new Item
{
};
return Item.ToList().OrderBy(e => e.ExpiryDate).ToList(); 
```

上面的代码没有显示任何错误，但也没有使用到期日期字段排序:(

如果我这样使用

```
return Item.OrderBy(e => e.ExpiryDate).ToList(); 
```

这给出了一个错误，即 sql 不包含 orderby 的翻译

任何帮助

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-23T13:35:01.917

我认为这里发生了几件事。首先，您已将结果变量命名为与您在`select`. 可能没有太大区别，但它令人困惑。让我们改变它：

```
var items = from itm in DB.Items
            select new Item
            {
            }; 
```

接下来，您的`DB.Items`上下文已经由`Item`对象构建。你不需要创建新的。在上面的代码中，你的新`Item`对象无论如何都是空的。

```
var items = from itm in DB.Items
            select itm; 
```

如果您想立即订购它们，您也可以这样做：

```
var items = from itm in DB.Items
            orderby itm.ExpiryDate
            select itm; 
```

如果您需要它作为`List`，您可以在同一行中执行此操作：

```
var items = (from itm in DB.Items
             orderby itm.ExpiryDate
             select itm).ToList(); 
```

现在`items`将是一个具体`List`的`Item`对象 ( `List<Item>`)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-23T13:32:55.783

您的代码创建`Item`使用默认构造函数的实例，而不会将您从数据库中获得的任何内容传递给它。这就是为什么你会得到一个相同的空项目列表；对它们进行排序没有效果。

删除第一个`Select`使其工作：

```
var Item = DB.Items; // No "Select ..."
return Item.ToList().OrderBy(e => e.ExpiryDate).ToList(); 
```

您的第一个`ToList`强制数据进入内存，`OrderBy`可以应用。您也可以将其替换为`AsEnumerable()`调用，以避免第二次在内存中创建列表：

```
return Item.AsEnumerable().OrderBy(e => e.ExpiryDate).ToList(); 
```

# java - HTML 到 ODT – XSLT？

> ID：13031514
> 
> 赞同：0
> 
> 时间：2012-10-23T13:27:33.330
> 
> 标签：java, html, openoffice-writer, odt

我正在尝试将单段 HTML 代码转换为 *.odt 格式（Open Office）正在使用的 XML 格式。例如，`<p>This is some text</p>`应翻译为`<text:p>This is some text</text:p>`. 当然，这也应该适用于列表等。

我不确定最好的方法是使用 XSLT 处理器（如果是的话，哪一个用于 Java？）并自己创建样式表——难道没有一个 Java 库已经可以做到这一点吗？我正在使用 jodconverter 从 ODT->PDF 转换，但即使 OpenOffice Writer 可以处理复制和粘贴内容并以所需的方式显示它，jodconvert 似乎也无法“翻译”单个 HTML（或我错了吗？）。

任何想法和建议都将受到欢迎。我应该补充一点，我对 Java 完全陌生。提前感谢英戈

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:34:22.320

XSLT 是最好的方法。OpenDocument 小组正在开发 HTML 到 ODT xsl 模板。可悲的是，它还没有准备好。

您可以[在他们的网站上](http://opendocumentfellowship.com/projects/odftools)查看以保持联系（并可能获得测试版工作）。

否则，你有一个非官方的项目，也是基于 XSLT：[像这样一个](http://xhtml2odt.org/) 在处理它到 ODT 之前对你的 HTML 应用一点转换来获得一个有效的 XHTML 是很容易的。

或者只是检查[this other example。](http://fisheye.liip.ch/browse/PUB/fluxcms/branches/matrix/inc/bx/editors/ooo/html2odt.xsl?r=9331)

# javascript - 如何使用选择/选项淡入/淡出 d3 强制布局的某些部分？

> ID：13031517
> 
> 赞同：1
> 
> 时间：2012-10-23T13:27:39.817
> 
> 标签：javascript, jquery, d3.js, highlight, force-layout

我的场景是这样的：我有一个带有选项的选择框和一个可爱的 D3 力布局可视化。

我想使用这些选项来淡入/淡出我的可视化的某些部分。我在这种特殊情况下使用 jQuery，例如：

```
$("select.filter.tag").change(function() {
  var cls = "."+$(this).val();
  if(cls != "."){
    d3.selectAll(".node:not("+cls+"), .link:not("+cls+")").transition()
      .duration(500)
      .style("opacity", 0);

    d3.selectAll(".node"+cls+", .link"+cls).transition()
      .duration(500)
      .style("opacity", 1);
  }
  else{
    d3.selectAll(".node, .link").transition()
      .duration(500)
      .style("opacity", 1)
  }
}); 
```

但是，这不会淡入/淡出我的可视化的任何部分。某些部分会在一瞬间消失（这是在最新版本的 Firefox 中，代码实际上适用于 Chrome 和 Safari）

预览：[https ://dl.dropbox.com/u/41566165/question/index.html](https://dl.dropbox.com/u/41566165/question/index.html)

有没有人可以帮忙？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T15:51:42.887

您应该将您的 transition().duration(500).style('opacity', 1) 替换为 jQuery 内置的 fadeIn/fadeOut，并以毫秒为单位的适当动画时间。

查看[jQuery FadeOut 文档](http://api.jquery.com/fadeOut/)

淡出示例：

```
$('.node:not("+cls+"), .link:not("+cls+")').fadeOut(900); 
```

淡入与淡出非常相似：

```
$('.node'+cls+', .link'+cls').fadeIn(900); 
```

# javascript - 在浏览器中运行 TypeScript 项目

> ID：13031518
> 
> 赞同：5
> 
> 时间：2012-10-23T13:27:46.543
> 
> 标签：javascript, visual-studio-2012, typescript

我发现了[TypeScript](http://www.typescriptlang.org/)，并安装了[Visual Studio 2012 Plugin](http://go.microsoft.com/fwlink/?LinkID=266563)，下载了[源代码](http://typescript.codeplex.com/SourceControl/BrowseLatest)并在引用了我的文档中的文件后运行了第一个[示例](http://www.typescriptlang.org/Tutorial/)：`.ts``HTML`

```
function Greeter(person) {
    return "Hello, " + person + ".";
}

var user = "James Kent";

document.body.innerHTML = Greeter(user); 
```

然后继续在命令行编译代码，使用：

`tsc greeter.ts`

但我无法编译它，正如 Visual Studio 所说：

> 命令“tsc”无效。

在浏览了整个 TypeScript 网站后，我找不到任何关于如何让它工作的信息。谷歌搜索也没有产生相关结果。

我怎样才能让 TypeScript 工作？

*更新：*运行随源代码提供的任何示例只会在任何浏览器中显示一个空白页面。但是，示例在 TypeScript 网站上似乎运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T14:02:28.443

您的系统找不到编译器的路径。如果您想自己注册，编译器可执行文件在这里（在我的 x64 Win 8 系统上）。

```
C:\Program Files (x86)\Microsoft SDKs\TypeScript\0.8.0.0\ 
```

使用它将 .ts 文件编译为 .js，并在您的 html 中使用它，而不是尝试直接在浏览器中编译它。那会很慢。

您可以查看 VS 中的“带有 TypeScript 的 HTML 应用程序”项目，它被配置为在项目构建时编译您的 TypeScript。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T13:52:11.720

`tsc`在命令行上工作的一种简单方法是使用`nodejs`和相应的包管理器`npm`。您可以从[nodejs.org](http://nodejs.org/)获取它们。设置完成后`nodejs`，您所要做的就是安装编译器

```
npm install -g typescript 
```

直接在浏览器中执行 Typescript 相当复杂。Typescript 编译为 Javascript，所以你想要的是在你的`html`.

# php - 如何从 wikipedia api 获取国家信息

> ID：13031526
> 
> 赞同：1
> 
> 时间：2012-10-23T13:28:05.637
> 
> 标签：php, html, wikipedia, wikipedia-api

> **可能重复：**
> [dbpedia 国家概况查询](https://stackoverflow.com/questions/13033841/dbpedia-country-profile-query)

我想使用 wikipedia api 获取页面右侧列出的国家信息。文档很混乱，因此不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:34:27.787

这将很困难，因为县信息是在模板中临时插入的。例如，在[http://en.wikipedia.org/wiki/Dresden](http://en.wikipedia.org/wiki/Dresden)，县可能由[“Infobox German location”](http://en.wikipedia.org/wiki/Template:Infobox_German_location)模板插入。如果您需要以编程方式获取有关地点的文章，您可以尝试以下两种方法之一：

*   通过地理位置坐标获取（坐标也可能难以从 wikitext 中解析出来，但在最坏的情况下，您可以从生成的 HTML 中的 geohack 链接获取它）
*   查看给定页面所在的类别，然后向上查找对应于各个国家/地区的类别（但这可能不适用于所有情况，因为类别可能有点混乱）

# php - 使用 php 保存整个页面源

> ID：13031528
> 
> 赞同：0
> 
> 时间：2012-10-23T13:28:08.717
> 
> 标签：php

> **可能重复：**
> [保存整个网页](https://stackoverflow.com/questions/1722433/save-full-webpage)

我需要使用 PHP 保存外部链接的页面源，就像我们保存在 PC 中一样。
ps :saved 文件夹包含图像和 html 内容。

我尝试了下面的代码......它只是将源代码放在 tes.html 中，我也需要保存所有图像。所以我们在离线时访问。

```
<?php
include 'curl.php';
$game = load("https://otherdomain.com/");
echo $game;
?>

<?php 
file_put_contents('tes.html', $game);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:32:57.233

您正在尝试做的是镜像网站。

我会使用该程序`wget`来做到这一点，而不是重新发明轮子。

```
exec( 'wget -mk -w 20 http://www.example.com/' ); 
```

看：

*   [http://en.wikipedia.org/wiki/Wget](http://en.wikipedia.org/wiki/Wget)
*   [http://fosswire.com/post/2008/04/create-a-mirror-of-a-website-with-wget/](http://fosswire.com/post/2008/04/create-a-mirror-of-a-website-with-wget/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:32:49.077

编写自己的解决方案来解析所有 CSS、图像和 JS 链接（并保存它们）或检查类似问题的答案：[https ://stackoverflow.com/a/1722513/143732](https://stackoverflow.com/a/1722513/143732)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:37:09.837

你需要写一个爬虫，从表面上看，你还不够熟练。考虑学习：

1.  **网页抓取**（cURL、PHP 中的 StreamContext、HTTP 理论）
2.  **URL**路径（相对、绝对、解析）
3.  **DOMDocument**和**DOMXPath**（用于解析 HTML 和简单的标签查询）
4.  整体**HTML**结构（IMG、LINK、SCRIPT 和其他加载外部内容的标签）
5.  整体**CSS**结构（如 CSS 中的 url('...') 加载页面所依赖的资源）

*只有这样，您才能正确地镜像站点。*但是，如果它们像 Ajax 一样动态加载内容，那么您就不走运了。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-23T13:32:44.333

[file_get_contents()](http://www.php.net/manual/en/function.file-get-contents.php)也支持 http(s)。例子：

```
$game = file_get_contents('https://otherdomain.com'); 
```

# java - Solr 中的词频

> ID：13031534
> 
> 赞同：5
> 
> 时间：2012-10-23T13:28:42.597
> 
> 标签：java, solr, word-frequency

我正在尝试使用 solr 获取单词的频率。当我给出这个查询时：

```
localSolr/solr/select?q=someQuery&rows=0&facet=true&facet.field=content&wt=xml 
```

solr 给了我这样的频率；

```
<lst name="facet_counts">
<lst name="facet_queries"/>
<lst name="facet_fields">
<lst name="content">
<int name="word1">24</int>
<int name="word2">12</int>
<int name="word3">8</int> 
```

但是当我数单词的时候；我发现 word2 的实际计数是 13。Solr 将字段中的相同单词计数为 1。

例如;

字段文本包括；`word2 word5 word7 word9 word2`. Solr 不返回 word2 的计数 2，而是返回 1。它为下面两个句子的 word2 的计数返回 1；

```
word2 word10 word11 word12
word2 word9 word7 word2 word23 
```

所以频率返回错误。我已经检查了方面字段，但没有找到合适的参数。我该如何解决它，以便它在句子中计算相同的单词？

编辑：schema.xml 的相关部分：

```
<fieldType name="text_tr" class="solr.TextField" positionIncrementGap="100">
    <field name="content" type="text_tr" stored="true" indexed="true" multiValued="true"/>
    <copyField source="content" dest="text"/>
    <field name="text" type="text_tr" stored="false" indexed="true" multiValued="true"/> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:30:47.140

如果您正在分面的字段是多值的，那么分面中的每个单词都会得到正确的计数

我忘了提一件事：[词向量组件](http://wiki.apache.org/solr/TermVectorComponent)会带你到你需要的地方

在查询中，**tv.tf**将为您提供每个术语的术语频率，而**tv.fl**告诉 solr 应在哪些字段上计算频率

**注意**，这会使您的索引时间比现在慢（又名：您必须尝试一下）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T16:20:30.053

使用卢克请求处理程序

`http://localhost:8983/solr/admin/luke?fl=YOUR_TEXT_FIELD&numTerms=500`

更多信息：[http ://wiki.apache.org/solr/LukeRequestHandler](http://wiki.apache.org/solr/LukeRequestHandler)

# gradle - 在 gradle 脚本中跟踪每个任务的执行时间？

> ID：13031538
> 
> 赞同：56
> 
> 时间：2012-10-23T13:28:48.717
> 
> 标签：gradle

跟踪任务在 gradle 构建脚本中花费多长时间的执行时间的最优雅方法是什么？在最佳情况下，将时间直接记录到任务名称的同一行或下一行：

```
:buildSrc:testClasses (0.518 secs)
:fooBar (28.652 secs) 
```

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2013-10-17T22:47:15.043

只是为了详细说明[Peter Niederwieser 的回答](https://stackoverflow.com/a/13032086/2911458)：我们想做同样的事情，以及在构建结束时报告时间，所以缓慢的步骤是显而易见的（当他们放慢速度时，适当的各方会感到一点点但健康的耻辱构建！）。

```
BUILD SUCCESSFUL

Total time: 1 mins 37.973 secs
Task timings:
    579ms  :myproject-foo:clean
  15184ms  :myproject-bar:clean
   2839ms  :myproject-bar:compileJava
  10157ms  :myproject-bar:jar
    456ms  :myproject-foo:compileJava
    391ms  :myproject-foo:libs
    101ms  :myproject-foo:jar
    316ms  :myproject-bar:compileTestJava
    364ms  :myproject-foo:compileTestJava
  53353ms  :myproject-foo:test
   2146ms  :myproject-bar:test
   8348ms  :www/node:npmInstall
    687ms  :www/node:npmTest 
```

可以将类似下面的代码放入顶层`build.gradle`以报告执行期间或完成后的时间。

```
// Log timings per task.
class TimingsListener implements TaskExecutionListener, BuildListener {
    private Clock clock
    private timings = []

    @Override
    void beforeExecute(Task task) {
        clock = new org.gradle.util.Clock()
    }

    @Override
    void afterExecute(Task task, TaskState taskState) {
        def ms = clock.timeInMs
        timings.add([ms, task.path])
        task.project.logger.warn "${task.path} took ${ms}ms"
    }

    @Override
    void buildFinished(BuildResult result) {
        println "Task timings:"
        for (timing in timings) {
            if (timing[0] >= 50) {
                printf "%7sms  %s\n", timing
            }
        }
    }

    @Override
    void buildStarted(Gradle gradle) {}

    @Override
    void projectsEvaluated(Gradle gradle) {}

    @Override
    void projectsLoaded(Gradle gradle) {}

    @Override
    void settingsEvaluated(Settings settings) {}
}

gradle.addListener new TimingsListener() 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2017-03-14T18:02:46.443

这是[jlevy 答案](https://stackoverflow.com/a/19438620/2350083)的变体，它已被修改以删除已弃用的可公开访问的 gradle`Clock`类的使用。

```
BUILD SUCCESSFUL

Total time: 1 mins 37.973 secs
Task timings:
    579ms  :myproject-foo:clean
  15184ms  :myproject-bar:clean
   2839ms  :myproject-bar:compileJava
  10157ms  :myproject-bar:jar
    456ms  :myproject-foo:compileJava
    391ms  :myproject-foo:libs
    101ms  :myproject-foo:jar
    316ms  :myproject-bar:compileTestJava
    364ms  :myproject-foo:compileTestJava
  53353ms  :myproject-foo:test
   2146ms  :myproject-bar:test
   8348ms  :www/node:npmInstall
    687ms  :www/node:npmTest 
```

可以将类似下面的代码放入顶层`build.gradle`以报告执行期间或完成后的时间。

```
import java.util.concurrent.TimeUnit
// Log timings per task.
class TimingsListener implements TaskExecutionListener, BuildListener {
    private long startTime
    private timings = []

    @Override
    void beforeExecute(Task task) {
        startTime = System.nanoTime()
    }

    @Override
    void afterExecute(Task task, TaskState taskState) {
        def ms = TimeUnit.MILLISECONDS.convert(System.nanoTime() - startTime, TimeUnit.NANOSECONDS);
        timings.add([ms, task.path])
        task.project.logger.warn "${task.path} took ${ms}ms"
    }

    @Override
    void buildFinished(BuildResult result) {
        println "Task timings:"
        for (timing in timings) {
            if (timing[0] >= 50) {
                printf "%7sms  %s\n", timing
            }
        }
    }

    @Override
    void projectsEvaluated(Gradle gradle) {}

    @Override
    void projectsLoaded(Gradle gradle) {}

    @Override
    void settingsEvaluated(Settings settings) {}
}

gradle.addListener new TimingsListener() 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-10-23T13:54:04.733

最干净的解决方案是实现一个[TaskExecutionListener](http://www.gradle.org/docs/current/javadoc/org/gradle/api/execution/TaskExecutionListener.html)（我相信你可以处理那部分）并将其注册到`gradle.taskGraph.addTaskExecutionListener`.

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2015-10-06T21:09:00.713

我知道这是一个老问题，但我找到了一个很酷的插件来执行任务计时。这就像[@jlevy 的答案](https://stackoverflow.com/a/19438620/2911458)，但有更多可用选项：[https ://github.com/passy/build-time-tracker-plugin](https://github.com/passy/build-time-tracker-plugin)

Pascal Hartig 的这个插件持续记录你的构建时间并提供 CSV 和条形图摘要。开发人员建议使用它来监控您的构建时间，而不是`--profile`为您提供当前构建的快照。

这就是我目前使用它的方式：

```
buildscript {
    repositories {
        mavenCentral()
    }

    dependencies {
        classpath "net.rdrei.android.buildtimetracker:gradle-plugin:0.7.+"
    }
}

apply plugin: "build-time-tracker"

buildtimetracker {
    reporters {
        summary {
            ordered false
            threshold 50
            barstyle 'unicode'
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-07-23T09:35:35.547

我创建了一个插件，因为[passy/build-time-tracker-plugin](https://github.com/passy/build-time-tracker-plugin)不再被积极维护。我的也打印 ASCII 条形图，并带有自定义选项。

[https://github.com/asarkar/build-time-tracker](https://github.com/asarkar/build-time-tracker)

```
== Build time summary ==
 :commons:extractIncludeProto | 4.000s | 14% | ████
       :commons:compileKotlin | 2.000s |  7% | ██
         :commons:compileJava | 6.000s | 21% | ██████
:service-client:compileKotlin | 1.000s |  4% | █
        :webapp:compileKotlin | 1.000s |  4% | █
     :webapp:dockerBuildImage | 4.000s | 14% | ████
      :webapp:dockerPushImage | 4.000s | 14% | ████ 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-05-29T02:53:13.673

简单的排序将使[@jlevy 的解决方案](https://stackoverflow.com/a/19438620/2911458)更好。
另外，对于典型的生产应用程序，我认为 50ms 的阈值太低了。
我们通常关心耗时超过 X 秒的任务。
**项目/build.gradle**

```
import java.util.concurrent.TimeUnit

// Log timings per task.
class TimingsListener implements TaskExecutionListener, BuildListener {
    private long startTime
    private timings = []

    @Override
    void beforeExecute(Task task) {
        startTime = System.nanoTime()
    }

    @Override
    void afterExecute(Task task, TaskState taskState) {
        def ms = TimeUnit.MILLISECONDS.convert(System.nanoTime() - startTime, TimeUnit.NANOSECONDS)
        timings.add(new Tuple2<Integer, String>(ms, task.path))
        task.project.logger.warn "${task.path} took ${ms}ms"
    }

    @Override
    void buildFinished(BuildResult result) {
        println "Task timings:"
        def tmp = timings.toSorted(new Comparator<Tuple2<Integer, String>>() {
            @Override
            int compare(Tuple2<Integer, String> o, Tuple2<Integer, String> t1) {
                return o.first - t1.first
            }
        })
        for (timing in tmp) {
            if (timing.first >= 1000) {
                printf "%ss  %s\n", timing.first / 1000, timing.second
            }
        }
    }

    @Override
    void buildStarted(Gradle gradle) {}

    @Override
    void projectsEvaluated(Gradle gradle) {}

    @Override
    void projectsLoaded(Gradle gradle) {}

    @Override
    void settingsEvaluated(Settings settings) {}
}

gradle.addListener new TimingsListener() 
```

终端输出：

```
BUILD SUCCESSFUL in 14m 33s
948 actionable tasks: 419 executed, 476 from cache, 53 up-to-date
Task timings:
1.036s  :cbl-config:mergeMyAppDebugResources
1.187s  :express:bundleMyAppDebug
1.199s  :country:testMyAppDebugUnitTest
1.214s  :core-for-test:extractMyAppDebugAnnotations
1.242s  :analytics:testMyAppDebugUnitTest
1.308s  :express:extractMyAppDebugAnnotations
1.33s  :availability:dataBindingExportBuildInfoMyAppDebug
1.357s  :app:transformNativeLibsWithStripDebugSymbolForMyAppDebug
1.405s  :hermes:generateMyAppDebugBuildConfig
1.56s  :availability:testMyAppDebugUnitTest
1.65s  :app:javaPreCompileMyAppDebugUnitTest
1.749s  :chat:compileMyAppDebugJavaWithJavac
1.858s  :cbl-config-for-test:compileMyAppDebugJavaWithJavac
2.027s  :cbl-config:compileMyAppDebugJavaWithJavac
2.056s  :analytics-for-test:compileMyAppDebugJavaWithJavac
2.447s  :crypto:compileMyAppDebugJavaWithJavac
2.45s  :crypto:testMyAppDebugUnitTest
2.47s  :chat:javaPreCompileMyAppDebugUnitTest
2.639s  :crypto-for-test:dataBindingExportBuildInfoMyAppDebug
2.683s  :test-utils:compileMyAppDebugJavaWithJavac
3.056s  :crypto:lintMyAppDebug
3.227s  :app:transformNativeLibsWithMergeJniLibsForMyAppDebug
3.272s  :express:testMyAppDebugUnitTest
3.394s  :crypto:mergeMyAppDebugResources
3.426s  :core:testMyAppDebugUnitTest
4.299s  :multicity:testMyAppDebugUnitTest
4.333s  :app:packageMyAppDebug
4.584s  :availability-for-test:compileMyAppDebugJavaWithJavac
4.672s  :app:transformResourcesWithMergeJavaResForMyAppDebug
4.786s  :map:lintMyAppDebug
5.309s  :country:lintMyAppDebug
5.332s  :job:lintMyAppDebug
5.389s  :map:testMyAppDebugUnitTest
6.04s  :express:lintMyAppDebug
6.584s  :hermes:lintMyAppDebug
6.707s  :app:transformClassesWithMultidexlistForMyAppDebug
7.052s  :multicity:lintMyAppDebug
8.044s  :multicity:compileMyAppDebugJavaWithJavac
8.87s  :app:transformDexArchiveWithDexMergerForMyAppDebug
9.371s  :uikit:testMyAppDebugUnitTest
9.429s  :availability:lintMyAppDebug
13.12s  :app:compileMyAppDebugUnitTestKotlin
16.276s  :hermes:testMyAppDebugUnitTest
16.898s  :chat:testMyAppDebugUnitTest
17.174s  :job:testMyAppDebugUnitTest
36.008s  :aaefawef:testMyAppDebugUnitTest
96.88s  :app:compileMyAppDebugJavaWithJavac
125.693s  :app:lintMyAppDebug
145.538s  :app:transformClassesWithDexBuilderForMyAppDebug
182.752s  :app:testMyAppDebugUnitTest 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-08-09T21:58:55.173

该[`--profile`](https://docs.gradle.org/current/userguide/command_line_interface.html#sec:command_line_performance)标志将生成一个配置文件报告。生成的 HTML 文件包括一个“任务执行”选项卡，其中包含每个任务的计时。

```
$ gradle build --profile

BUILD SUCCESSFUL in 21s
6 actionable tasks: 6 executed

See the profiling report at: file:///path/to/gs-spring-boot/complete/build/reports/profile/profile-2021-08-09-16-22-40.html
A fine-grained performance profile is available: use the --scan option. 
```

这记录在在线[命令行界面文档中](https://docs.gradle.org/current/userguide/command_line_interface.html#sec:command_line_performance)

> `$buildDir/reports/profile`在目录中生成高级性能报告。`--scan`是首选。

## 任务执行输出

> | 任务 | 期间 | 结果 |
> | --- | --- | --- |
> | ： | 20.046s | （全部的） |
> | :编译Java | 9.221s |  |
> | ：测试 | 6.492s |  |
> | :compileTestJava | 3.161s |  |
> | :bootJarMainClassName | 0.813s |  |
> | :bootJar | 0.338s |  |
> | ：罐 | 0.017s |  |
> | :进程资源 | 0.003s | 无源 |
> | ：类 | 0.001s | 没有工作 |
> | ：集合 | 0s | 没有工作 |
> | ：建造 | 0s | 没有工作 |
> | ：查看 | 0s | 没有工作 |
> | :processTestResources | 0s | 无源 |
> | :testClasses | 0s | 没有工作 |

## Gradle 构建扫描

该`--profile`选项及其文档都建议使用该`--scan`选项来生成[构建扫描](https://gradle.com/gradle-enterprise-solution-overview/build-scan-root-cause-analysis-data/)。这会生成一个扫描并将其发布到[scans.gradle.com](https://scans.gradle.com)。除了将您的构建详细信息传输到 Gradle 构建扫描外部服务之外，这还需要接受[Gradle 服务条款](https://gradle.com/terms-of-service)。

```
$ gradle build --scan

BUILD SUCCESSFUL in 0s
7 actionable tasks: 7 executed

Publishing a build scan to scans.gradle.com requires accepting the Gradle Terms of Service defined at https://gradle.com/terms-of-service.
Do you accept these terms? [yes, no] yes

Gradle Terms of Service accepted.

Publishing build scan...
https://gradle.com/s/5u4w3gxeurtd2 
```

### 扫描输出

> **4个项目61个任务7s执行，10个回避任务节省4.231s**
> 
> |  |  |
> | --- | --- |
> | :buildSrc:compileKotlin | 3.584s |
> | :app:test | 0.745s |
> | ：列表：测试 | 0.742s |
> | :list:compileJava | 0.062s |
> | :utilities:compileJava | 0.054s |
> | :app:startScripts | 0.049s |

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-12-15T12:22:30.767

我曾尝试使用[@Jilevys 解决方案](https://stackoverflow.com/a/19438620/3060133)，但在查找类***org.gradle.util.Clock()时出错***

我已将其修改为使用 Java8 类。将以下代码放在 build.gradle 之上

```
 import java.time.LocalDateTime

class TimingsListener implements TaskExecutionListener, BuildListener {
    private LocalDateTime taskStartTime

    @Override
    void beforeExecute(Task task) {
        taskStartTime = LocalDateTime.now();
    }

    @Override
    void afterExecute(Task task, TaskState taskState) {
        LocalDateTime taskEndTime = LocalDateTime.now();
        def seconds = Duration.between(taskStartTime, taskEndTime).toSeconds();
        task.project.logger.warn "${task.path} took ${seconds} seconds."
    }

    @Override
    void buildStarted(Gradle gradle) {
        project.logger.warn "Build started on "+LocalDateTime.now()
    }

    @Override
    void settingsEvaluated(Settings settings) {

    }

    @Override
    void projectsLoaded(Gradle gradle) {

    }

    @Override
    void projectsEvaluated(Gradle gradle) {

    }

    @Override
    void buildFinished(BuildResult result) {
        project.logger.warn "Build finished on "+LocalDateTime.now()

    }
}
gradle.addListener new TimingsListener() 
```

它产生类似于下面给出的输出。

```
<projectname>:<taskName> took 10 seconds. 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2020-08-18T12:36:05.027

在 Android Studio 版本 >= 4.0 中添加了构建分析器，它在 gradle 中跟踪每个任务的执行时间。

成功构建后在这里找到：

1.  [![在此处输入图像描述](../Images/d4219b39443e36404ddbba0d242683b0.png)](https://i.stack.imgur.com/LlrlA.png)

2.  [![在此处输入图像描述](../Images/4c353e7ce69bca60562662a836cf0cc8.png)](https://i.stack.imgur.com/SnLfo.png)

# php - Magento - 将自定义模块添加到 Google 站点地图

> ID：13031539
> 
> 赞同：0
> 
> 时间：2012-10-23T13:28:51.130
> 
> 标签：php, magento, magento-1.7

我的商店中有前端页面的自定义模块（我购买或开发的）。如何将这些页面包含在 Magento 生成的 Google 站点地图中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T16:17:08.147

生成站点地图的函数是：`Mage_Sitemap_Model_Sitemap::generateXml()`

它执行以下操作：

*   打开文件并写入 xml 标头
*   获取类别集合并将其写入站点地图文件
*   获取产品集合并将其写入站点地图文件
*   获取 CMS 集合并将其写入站点地图文件
*   关闭站点地图 xml 文件

在关闭 xml 文件之前不会调度任何事件...在这种情况下，您可以扩展它`Mage_Sitemap_Model_Sitemap`并覆盖`generateXml()`添加您自己的自定义 URL 的函数（如果这些 url 不在上述任何集合中：类别、产品、cms 页面）

解决您的问题的另一种方法是使用多个站点地图文件和一个站点地图索引文件（Google 支持此：http: [//googlewebmastercentral.blogspot.co.uk/2006/10/multiple-sitemaps-in-same-directory.html](http://googlewebmastercentral.blogspot.co.uk/2006/10/multiple-sitemaps-in-same-directory.html)）。在这种情况下，您可以有一个单独的模块来生成第二个 xml 站点地图文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-04T12:25:42.983

Magento 确实在以后的版本中添加了事件*sitemap_products_generating_before*和*sitemap_categories_generating_before*（我不知道什么时候，我的版本是 1.9.2）。因此，如果您像我一样偶然发现这个线程，正在寻找将自定义模块页面添加到 Google 站点地图的最佳方法，这些事件就是这么简单：

就我而言，我有一个创建动态“新闻”页面的自定义模块，因此我在模块的 config.xml 中的 <global> 标记中添加了一个事件侦听器。我选择参加产品站点地图活动*：

```
 <events>
        <sitemap_products_generating_before>
            <observers>
                <{your_unique_event_observer_name}>
                    <class>{Brand}_{Module}_Model_Observer</class>
                    <method>addPagesToSitemap</method>
                </{your_unique_event_observer_name}>
            </observers>
        </sitemap_products_generating_before>
    </events> 
```

然后，在我的模块的 Observer 中，我让*addPagesToSitemap*方法将额外的项目添加到产品集合（或类别集合，如果您使用类别站点地图事件）：

```
class {Brand}_{Module}_Model_Observer
{   
    function addPagesToSitemap(Varien_Event_Observer $observer){

        $sitemapItems = $observer->getEvent()->getCollection()->getItems();

        // Get your module's page collection including their urls
        // Adjust the following lines to your needs
        $collection = Mage::getModel('{brand}_{module}/pages')->getCollection()
            ->addFieldToSelect(array('page_id','url'))
            ->addFieldToFilter('display', 1);
        // My module stores the page path separately,
        // you might don't need this:
        $modulePagePath = Mage::helper('{my-modules-helper}')->getNewsPath();

        foreach($collection as $_item){
            $varienObject = new Varien_Object();
            // We don't want to override 
            // any existing product/category items
            $uniqueId = '{module}'.$_item->getPageId();         
            $varienObject->setId($uniqueId);

            // You might want to adjust this if your item
            // stores the complete url. Don't add the base url tho,
            // Mage_Sitemap_Model_Sitemap::generateXml adds it
            $varienObject->setUrl($modulePagePath . DS . $_item->getUrl());

            $sitemapItems[$uniqueId] = $varienObject;
        }
        $observer->getEvent()->getCollection()->setItems($sitemapItems);

        return $this;
    }
} 
```

就是这样。您可以通过在目录 > Google 站点地图下手动生成站点地图来测试它。

* * *

*由于某些原因，Magento 没有添加事件“sitemap_pages_generating_before”，因此您必须选择产品或类别的事件。对于这两个事件，Magento 会在您的 Magento 配置中为类别和产品页面设置相应的 changefreq- 和 priority-value 集。因此，只需选择值更适合的事件。

# javascript - MongoError：无法更改文档的_id

> ID：13031541
> 
> 赞同：16
> 
> 时间：2012-10-23T13:28:52.673
> 
> 标签：javascript, mongodb, backbone.js, express

我是 MongoDB 和 Backbone 的新手，所以我尝试理解它们，但这很难。我有一个很大的问题：我无法理解如何操作 Backbone.Model 中的属性以仅在视图中使用我需要的。更具体 - 我有一个**模型**：

```
window.User = Backbone.Model.extend({

    urlRoot:"/user",
    idAttribute: "_id",

    defaults: {
        _id: null,
        name: "",
        email: "foo@bar.baz"
    }
});

window.UserCollection = Backbone.Collection.extend({
    model: User,

    url: "user/:id"
}); 
```

我有一个**观点**：

```
beforeSave: function(){
    var self = this;
    var check = this.model.validateAll();
    if (check.isValid === false) {
        utils.displayValidationErrors(check.messages);
        return false;
    }
    this.saveUser();
    return false;
},

saveUser: function(){
    var self = this;
    console.log('before save');
    this.model.save(null, {
        success: function(model){
            self.render();
            app.navigate('user/' + model.id, false);
            utils.showAlert('Success!', 'User saved successfully', 'alert-success');
        },
        error: function(){
            utils.showAlert('Error', 'An error occurred while trying to save this item', 'alert-error');
        }
    });
} 
```

我必须使用来自除“_id”之外的任何字段的数据的“put”方法，所以它必须是这样的：

```
{"name": "Foo", "email": "foo@bar.baz"} 
```

但每次，并不取决于我做什么它发送

```
{**"_id": "5083e4a7f4c0c4e270000001"**, "name": "Foo", "email": "foo@bar.baz"} 
```

来自服务器的这个错误：

> *MongoError：无法更改文档旧的_id：{_id：ObjectId（'5083e4a7f4c0c4e270000001'），名称：“Foo”}新：{_id：“5083e4a7f4c0c4e270000001”，名称：“Bar”，电子邮件：“foo@bar.baz” }*

Github 链接：[https ://github.com/pruntoff/habo](https://github.com/pruntoff/habo)

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-23T21:11:19.910

通过查看您的 mongo 错误，问题不在于 mongo，它只是在做它应该做的事情。它有一个 _id 为 ObjectId 类型的对象：ObjectId('xxx')，现在您尝试将该对象更改为具有 String 类型的 _id (_id: "5083e4a7f4c0c4e270000001")，而 Mongo 显然不喜欢。

所以，问题是：为什么对象首先有一个 ObjectId 类型的 id？第一次是怎么设置的？如果您使用其他方法来初始化它（我猜是服务器端），您应该将 id 类型设置为 String ，以便它与来自脚本库的相同。如果您希望它保留为 ObjectId，则需要将来自脚本的字符串转换为 ObjectId，然后再将其保存到 Mongo。

HTH。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-12-02T16:52:40.660

MongoDB**创建**_id 作为 ObjectID，但不**检索**_id 作为 ObjectID。

无论这种不一致是否是“正确的行为”，对于大多数 MongoDB 用户来说，这无疑是一个令人讨厌的惊喜。

您可以使用以下方法修复它：

```
if ( this._id && ( typeof(this._id) === 'string' ) ) {
  log('Fixing id')
  this._id = mongodb.ObjectID.createFromHexString(this._id)
} 
```

请参阅[MongoDB 无法更新文档，因为 _id 是字符串，而不是 ObjectId](https://stackoverflow.com/questions/14585507/mongodb-cant-update-document-because-id-is-string-not-objectid)

# oracle - 获取 Oracle 应用服务器地址

> ID：13031543
> 
> 赞同：2
> 
> 时间：2012-10-23T13:29:01.667
> 
> 标签：oracle, application-server, oracleforms, oraclereports

在 Oracle Forms and Reports 中，是否存在获取应用服务器地址的任何函数或过程或可能性。

例如：

```
http://hostname:portno/servlet/RWServletserver=repserver+report=ReportName+destype=cache+userid=ConnectString+desformat=htmlcss 
```

我想得到这部分：`http://hostname:portno`

或者也许有可能以其他方式创建应用程序链接，而不是通过知道应用程序服务器的地址？

该链接指向由报表创建的 Excel 文件。顶部的链接只是一个示例，它不是文件的链接。文件的路径是已知的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T13:03:10.897

I have a partial solution for you - the following piece of Forms PL/SQL code will return the IP address of the application server :-

```
declare
  v_ip_address   varchar2(20);
  --
begin
  select SYS_CONTEXT('USERENV','IP_ADDRESS') into v_ip_address from dual;
  --
end; 
```

The caveat to this functionality is that the Form / Report must be connected to a database to use this, as it uses a database function. However, it will always return the IP address of the application server, not the database server; and has been tested where these are on different boxes.

SYS_CONTEXT is an Oracle database function (confirmed available in 9i, 10g and 11g) which returns the value of a parameter associated with the context namespace; it comes with a built-in namespace USERENV. This namespace has a number of interesting and useful parameters; see [http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions165.htm#g1513460](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions165.htm#g1513460) for details.

The specific parameter being used here - IP_ADDRESS - returns the IP address of the **connected client**, which from the database's point of view is the application server, as this is where the Form / Report is actually executing - so you get what you need :) This should work for Reports as well as Forms, although I have not tested this.

I can't see a way of getting the port number, I'm afraid - but hopefully the above should help you.

Cheers,

Keith

# svn - Subversion 存储库中的“/db/txn-current”为空或不存在

> ID：13031544
> 
> 赞同：3
> 
> 时间：2012-10-23T13:29:13.443
> 
> 标签：svn, svnadmin, svn-repository, fsfs, svn-administraton

*我遇到了 Apache Subversion 存储库的问题，我正在寻找**最佳**解决方案：*

我无法提交到 Subversion 存储库，并且收到错误消息：

> svn: E720002: Commit failed (详情如下): svn: E720002: Can't open file 'C:\Repositories\myproject\db\txn-current': 系统找不到指定的文件。

如果我创建一个空`txn-current`文件，如果提交时会出现另一个错误：

> svn：E070014：提交失败（详细信息如下）：svn：E070014：无法读取文件'C：\Repositories\myproject\db\txn-current'：找到文件结尾

**注意：**假设我没有存储库的备份，因此我必须手动修复该问题。

StackOverflow 上已经讨论了相同的行为：[svn commit problem, Cannot read 'd:\UC\db\txn-current': End of file found](https://stackoverflow.com/questions/4568043/svn-commit-problem-cannot-read-d-uc-db-txn-current-end-of-file-found)。但是我怀疑那里的答案真的很有帮助：

*   我不认为`\db\txn-current`手动创建并放一个`0`（或任何其他整数）是一个好的解决方案。我想它可能会在不久的将来导致一些意想不到的行为，

*   `svnadmin recover`和/或`svnadmin verify`不创建和/或填充`txn-current`. 在这种情况下，这些命令是无能为力的。

根据[FSFS 描述](http://svn.apache.org/repos/asf/subversion/trunk/subversion/libsvn_fs_fs/structure) `\db\txn-current`文件包含下一个事务密钥号。如果我将一些整数放入文件中，那么我可以提交并且整数将增加 1。

然而，看起来放一些不相关的整数会破坏我的回购中的某些东西，我不希望这种情况发生。

> “txn-current”文件是一个包含单行文本的文件，其中仅包含一个 base-36 数字。当前值将用于下一个事务名称，以及事务所基于的修订号。这个序列号确保事务名称不会被重用，即使事务被中止并且基于相同修订的新事务开始。FSFS 对该文件执行的唯一操作是“获取和递增”；“txn-current-lock”文件在此操作期间被锁定。

**我应该怎么做才能`\db\txn-current`正确解决问题？我应该在文件中放入什么整数？有没有其他方法可以解决这个问题？**

**编辑：**

*   除了文件，我如何解决相同的问题（不存在或为空）`db/current`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T12:53:08.177

我有类似的问题。为了解决，我编辑了“txn-current”文件，在里面放了一些大数字，比如 xxxxx。除此之外，我还必须在“db\transactions”文件夹中编辑另一个名为“current”的文件。我从这个文件中删除了所有内容，只添加了一个输入并关闭了这个文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-07T11:04:01.180

我有一个类似的问题，在提交期间发生电源故障。我尝试修改“当前”文件，但没有奏效。

我对存储库进行了备份，然后删除了“当前”文件，并在存储库上运行了“svnadmin verify”。此后，我收到以下错误：

> “格式错误的文件 svn：序列化散列缺少终止符”

然后我对存储库进行了转储，删除了旧存储库，重新创建了存储库并导入了转储文件。

此后一切都再次运行良好。完整的存储库和历史记录仍然存在。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-24T10:01:52.830

我收到错误消息“无法读取 'D:\SVNROOT\UC\db\txn-current'.: End of file found” 在进一步探测后，我们意识到 db 文件夹中的“当前”文件在某些​​服务器操作系统之后为空升级活动。我们从 revs 文件夹中找到了最新的修订号，并将该号添加到“当前”文件中

它仍然不起作用然后我们发现这篇[文章](http://svn.apache.org/repos/asf/subversion/trunk/subversion/libsvn_fs_fs/structure)指定您必须输入修订号，然后在其后输入“输入”

这可以解决错误！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-23T18:07:02.773

在 FSFS 中`txn-current`保存下一个事务 ID。提交后存储在修订本身中的事务 ID。所以puttign非常大的数字`txn-current`应该没问题。

另一种解决方案是`svnadmin dump`存储库，然后`svnadmin load`是新的存储库。

**更新：**已调查文件损坏问题，`txn-current`并已在 r1483781 中修复。

*   修复 Windows 上电源/磁盘故障时的存储库损坏 (r1483781)

修复在 Subversion 1.7.10 及更高版本中可用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-14T23:05:01.257

我做了：

```
svnadmin verify /mnt/repos/
svnadmin recover /mnt/repos/ 
```

还是报错...

```
svn: E000002: Übertragen schlug fehl (Details folgen):
svn: E000002: Kann Datei »/mnt/repos/db/txn-current« nicht öffnen: Datei oder Verzeichnis nicht gefunden 
```

然后我创建了空文件：`/mnt/repos/db/txn-current` 然后`svn ci`再次工作

如果您不想等待：

```
svnadmin verify -r 997:HEAD <path> 
```

是比较快的。与修订号交换 997，小于错误修订

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-15T11:39:21.467

就我而言。设置 SVN 的 VirtualMachine，空间已满。所以清理了空间

# java - 我在这里做错了什么：Android Socket Connection？

> ID：13031548
> 
> 赞同：1
> 
> 时间：2012-10-23T13:29:26.207
> 
> 标签：java, android, sockets

我正在将从 theneboston.com 学到的客户端-服务器应用程序转换为 Android 应用程序，它是一个使用套接字（TCP 连接）进行通信的即时消息应用程序，在我的 Android 应用程序中，一个设备是服务器，另一个是客户端. 现在在模拟器上运行服务器端应用程序时出现问题，应用程序冻结大约 40 秒，然后弹出错误消息说：

> Activity ServerIM（在应用程序 Android Server Instant Messaging 中）没有响应

我认为问题在于创建 ServerSocket。我真的需要这个，所以我很感激任何人都可以帮助我。

这是我的`ServeIM`Android 课程：

```
package com.example.android.server.instant.messenger;

import java.io.EOFException;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.net.ServerSocket;
import java.net.Socket;

import android.app.Activity;
import android.os.Bundle;
import android.os.Handler;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ScrollView;
import android.widget.TextView;
import android.view.View.OnClickListener;

public class ServerIM extends Activity {

    private ScrollView scrollView;
    private EditText userText;
    private Button connectButton;
    private Button sendButton;
    private TextView chatLog;

    private ObjectOutputStream output;
    private ObjectInputStream input;
    private ServerSocket server;
    private Socket connection;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_server_im);

        scrollView = (ScrollView) findViewById(R.id.ScrollView);
        userText = (EditText) findViewById(R.id.user_Text);
        connectButton = (Button) findViewById(R.id.button_connect);
        sendButton = (Button) findViewById(R.id.button_send);
        chatLog = (TextView) findViewById(R.id.chat_Log);

        ableToType(false);

        connectButton.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                showMessage("1"); // this message doesn't appends to the
                                    // TextView
                startRunning();
            }
        });

    }

    public void startRunning() {
        try {
            (new Thread(new Runnable() {
                public void run() {
                    try {
                        server = new ServerSocket(5678, 100);
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                }
            })).start();
            while (true) {
                try {
                    waitForConnection();
                    setupStreams();
                    whileChatting();
                } catch (EOFException eofException) {
                    showMessage("\n Server ended the connection!");
                } finally {
                    closeCrap();
                }
            }
        } catch (IOException ioException) {
            ioException.printStackTrace();
        }

    }

    // wait for connection, then display connection information
    private void waitForConnection() throws IOException {
        showMessage("Waiting for someone to connect... \n");
        connection = server.accept();
        showMessage("Now connected to "
                + connection.getInetAddress().getHostName());
    }

    // get stream to send and recieve data
    private void setupStreams() throws IOException {
        output = new ObjectOutputStream(connection.getOutputStream());
        output.flush();
        input = new ObjectInputStream(connection.getInputStream());
        showMessage("\n Streams are now setup! \n");
    }

    // during the chat conversation
    private void whileChatting() throws IOException {
        String message = " You are now connected! ";
        sendMessage(message);
        ableToType(true);
        do {
            // have a conversation
            try {
                message = (String) input.readObject();
                showMessage("\n" + message);
            } catch (ClassNotFoundException classNotFoundException) {
                showMessage("\n idk wtf that user sent! ");
            }
        } while (!message.equals("CLIENT - END"));
    }

    // close streams ans sockets after you are done chatting
    private void closeCrap() {
        showMessage("\n Closing Connections... \n");
        ableToType(false);
        try {
            output.close();
            input.close();
            connection.close();
        } catch (IOException ioException) {
            ioException.printStackTrace();
        }
    }

    // send message to client
    private void sendMessage(String message) {
        try {
            output.writeObject("SERVER - " + message);
            output.flush();
            showMessage("\n Server - " + message);
        } catch (IOException ioException) {
            chatLog.append("\n ERROR: I can't send this message");
        }
    }

    // update chatWindow
    private void showMessage(final String text) {
        final Handler myHandler = new Handler();

        (new Thread(new Runnable() {
            public void run() {
                myHandler.post(new Runnable() {
                    public void run() {
                        chatLog.append(text + "\n");
                    }
                });
            }
        })).start();
    }

    // let the user type stuff into their box
    private void ableToType(final boolean tof) {

        final Handler myHandler = new Handler();

        (new Thread(new Runnable() {
            public void run() {
                myHandler.post(new Runnable() {
                    public void run() {
                        userText.setEnabled(tof);
                    }
                });
            }
        })).start();

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_server_im, menu);
        return true;
    }
} 
```

这是 XML 文件：

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ScrollView
        android:id="@+id/ScrollView"
        android:layout_width="fill_parent"
        android:layout_height="150dp"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true" >

        <TextView
            android:id="@+id/chat_Log"
            android:layout_width="wrap_content"
            android:layout_height="339dp"
            android:text="" />
    </ScrollView>

    <EditText
        android:inputType="text"
        android:id="@+id/user_Text"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/ScrollView"
        android:layout_marginTop="39dp"
        android:ems="10" />

    <Button
        android:id="@+id/button_send"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/user_Text"
        android:layout_toRightOf="@+id/user_Text"
        android:minWidth="100dip"
        android:text="Send" />

    <Button
        android:id="@+id/button_connect"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/button_send"
        android:layout_alignRight="@+id/button_send"
        android:layout_below="@+id/button_send"
        android:text="Connect" />

</RelativeLayout> 
```

和清单：

```
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.android.server.instant.messenger"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-permission android:name="android.permission.INTERNET" />

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".ServerIM"
            android:label="@string/title_activity_server_im" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:35:15.537

该`ServerSocket.accept()`函数在 UI 线程中运行，并且将阻塞直到它获得连接。

你有正确的想法，在`ServerSocket`不同的线程中创建，但你必须`accept()`在后台运行该函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T14:34:50.390

您有`while (true)`事件处理程序 (ServerIM.java:68)，这会使 EDT 挂起。

# php - 发布请求未发送所有变量

> ID：13031549
> 
> 赞同：0
> 
> 时间：2012-10-23T13:29:33.173
> 
> 标签：php, javascript, request, max

我有一个表单，其中包含设置如下的行：

```
<div class="row unit" onmouseover="this.style.background = '#eeeeee';" onmouseout="this.style.background = 'white';" onclick="if(event.srcElement.nodeName != 'INPUT' && event.srcElement.nodeName != 'SELECT' && event.srcElement.nodeName != 'TEXTAREA'){goToByScroll(event.srcElement,-160);}">
            <div class="col">
                <div class="select">
                    <input type="checkbox" id="select<?php echo $i; ?>" name="select<?php echo $i; ?>">
                </div>

            </div>
            <div class="col name">
                <p><input class="searchable" type="text" id="name<?php echo $i; ?>" name="name<?php echo $i; ?>" value="<?php echo $name; ?>"></p>
                <p>Badge ID: <input class="searchable" type="text" id="badge<?php echo $i; ?>" name="badge<?php echo $i; ?>" value="<?php echo $badge; ?>" style="width: 50px;"></p>
            </div>
            <div class="col phone">
                <p>Work: <input class="searchable" type="text" id="phone<?php echo $i; ?>" name="phone<?php echo $i; ?>" value="<?php echo $phone; ?>"></p>
                <p>Cell: <input class="searchable" type="text" id="cell<?php echo $i; ?>" name="cell<?php echo $i; ?>" value="<?php echo $cell; ?>"></p>
                <p>Home: <input class="searchable" type="text" id="home<?php echo $i; ?>" name="home<?php echo $i; ?>" value="<?php echo $home; ?>"></p>
            </div>
            <div class="col email">
                <p>Work: <input class="searchable" type="text" id="email<?php echo $i; ?>" name="email<?php echo $i; ?>" value="<?php echo $email; ?>"></p>
                <p>Personal: <input class="searchable" type="text" id="perEmail<?php echo $i; ?>" name="perEmail<?php echo $i; ?>" value="<?php echo $perEmail; ?>"></p>
            </div>
            <div class="col file">
                <p class="removeFile"><input type="text" id="filename<?php echo $i; ?>" name="filename<?php echo $i; ?>" class="file" value="<?php echo $filename; ?>" readonly>
                Remove: <input type="checkbox" id="removeFile<?php echo $i; ?>" name="removeFile<?php echo $i; ?>"></p>
                <input type="file" id="file<?php echo $i; ?>" name="file<?php echo $i; ?>" onchange="myForm.elements['filename<?php echo $i; ?>'].value=myForm.elements['file<?php echo $i; ?>'].value;">
            </div>
</div> 
```

这些行使用增加名称的 javascript 函数重复：

```
function addTableRow(table){
    for(i=0; i<myForm.elements['entriesNum'].value; i++){
        var $tr = $(table).find(".row:last").clone();
        $tr.find("input,select,textarea").attr("name", function(){
          var parts = this.id.match(/(\D+)(\d+)$/);
          return parts[1] + ++parts[2];
        }).attr("id", function(){
          var parts = this.id.match(/(\D+)(\d+)$/);
          return parts[1] + ++parts[2];
        });
        $(table).find(".row:last").after($tr);

        $tr.find('.fileElements').remove();
        $tr.find('input[type!="radio"], textarea').removeAttr("value");
        $tr.find('input').removeAttr("checked");
        $tr.find('select option:first-child').attr("selected", true);
        $tr.find('input[type!="radio"]').removeAttr("disabled");
        $tr.find('input[type="radio"]').attr("disabled", "disabled");
        $tr.find('.error').hide();
    }
} 
```

在行数高于 111 之前，这非常有效。此时，当我提交时，无论我添加多少行，数组中都不会包含更多数据。我可以通过使用 print_r($_REQUEST); 推断出这一点。我已经编辑了我的 php.ini 并将所有最大值设置为高得离谱，但仍然没有变化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:53:56.857

每当我遇到 javascript 创建的表单元素没有出现在 POST 中的问题时，它总是与我构建 FORM 标签的方式有关。

要寻找的东西...

您的 FORM 标签是否正确关闭？

您的 FORM 在 DOM 中的启动和关闭级别是否相同？例如，你不想这样做......

```
<form method='post'>
<div>
  <!--lots of stuff-->
  </form>
</div> 
```

你会想要这个......

```
<form method='post'>
  <div>
    <!--lots of stuff-->
  </div>
</form> 
```

您是否有另一个 FORM 标签在您实际使用的标签之前已打开但未关闭？像这样...

```
<form method='get'>
   <!--some kind of form about something else-->

<form method='post'>
   <!--the data you're currently focused on-->
</form> 
```

# c# - 100 多个并发用户尝试下载文件（asp.net C# 应用程序）

> ID：13031551
> 
> 赞同：4
> 
> 时间：2012-10-23T13:29:35.153
> 
> 标签：c#, asp.net, download

我正在尝试在 asp.net 应用程序中实现文件下载功能。该应用程序将被大约 200 个用户同时使用来下载各种文件。它将托管在 IIS 7 上。我不希望应用程序服务器因为多个请求同时出现而崩溃。

我假设通过在循环中调用 Context.Response.Flush() ，我将刷新到那时我将读取的所有文件数据，因此应用程序内存使用将保持一致。我可以对当前代码进行哪些其他优化，或者在这样的场景中应该使用哪些其他方法？

请求将针对各种文件，文件大小可以在 100 KB 到 10 MB 之间。

我当前的代码是这样的：

```
FileStream inStr = null;
byte[] buffer = new byte[1024];
String fileName = @"C:\DwnldTest\test.doc";
long byteCount; inStr = File.OpenRead(fileName);

Response.AddHeader("content-disposition", "attachment;filename=test.doc");

while ((byteCount = inStr.Read(buffer, 0, buffer.Length)) > 0)
{
    if (Context.Response.IsClientConnected)
    {
        Context.Response.ContentType = "application/msword";
        //Context.Response.BufferOutput = true;                    
        Context.Response.OutputStream.Write(buffer, 0, buffer.Length);
        Context.Response.Flush();                    
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T14:00:28.990

您可以`Response.TransmitFile`在发送文件时使用它来节省服务器内存。

```
Response.ContentType = "application/pdf";

Response.AddHeader("content-disposition", "attachment; filename=testdoc.pdf");

Response.TransmitFile(@"e:\inet\www\docs\testdoc.pdf");

Response.End(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T14:08:03.543

由于您将现有文件发送到客户端，请考虑使用`HttpResponse.TransmitFile`(http://msdn.microsoft.com/en-us/library/12s31dhy.aspx)。

查看 .NET 代码，这似乎会将文件写入 IIS，而不是在 ASP.NET 进程中读取/写入它。`HttpResponse.WriteFile(string, false)`并且`HttpResponse.Write(string)`似乎做同样的事情。

为了验证文件发送是否中继到 IIS，在`HttpResponse.Output`属性 - 它应该是`HttpWriter`. 数组现在`HttpWriter._buffers`应该包含一个新元素`HttpFileResponseElement`）。

当然，您应该始终调查缓存是否适合您的场景并测试它是否正在使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:43:16.873

在您的代码示例中，您没有关闭/处置 inStr。这可能会影响性能。

另一种更简单的方法是使用内置方法：

[写文件](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.writefile.aspx?ppud=4)

它应该已经过优化，并会为您打开/关闭文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T13:51:57.403

也许您想使用`FileSystemWatcher`类来检查文件是否被修改，并且仅在检测到此类更改时才将其读入内存。其余时间只返回已经存储在内存中的字节数组。我不知道`HttpResponse.WriteFile`方法是否对此类文件修改更改敏感，或者是否总是从给定路径读取文件，但这似乎也是一个不错的选择，因为它由开箱即用的框架提供服务。

# jakarta-ee - 如何使用相对路径计算java中文件的真实路径？

> ID：13031555
> 
> 赞同：1
> 
> 时间：2012-10-23T13:29:42.877
> 
> 标签：jakarta-ee

我创建了动态网络项目。我编写了一个 Java 类，它打开一个属性文件并返回传递给函数的键的值。

但是要打开属性文件，我必须编写一个完整的路径，例如`c:/Apache/webapps/webcontent/resources/system.properties`. 但我想使用相对路径计算这个文件的真实路径。

如何计算真实路径？这不是一个 servlet，它是一个完整的 Java 文件，只有一个类及其方法。如何计算文件的真实路径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:41:14.503

如果您`File`使用相对路径加载 a，则调用`File.getCanonicalPath()`or`File.getAbsolutePath()`将为您提供绝对路径。

使用应用服务器时，您的工作目录将是您的应用服务器的启动位置，因此要`File`使用相对路径获取 a 的绝对路径，您需要执行以下操作：

```
String relativePath = '/mypath/myfile.txt';
String absolutePath = getServletContext().getRealPath(relativePath);
File file = new File(absolutePath); 
```

# php - 是否可以通过 dermertmart 2 中的类方法创建新产品？

> ID：13031557
> 
> 赞同：0
> 
> 时间：2012-10-23T13:29:43.907
> 
> 标签：php, virtuemart

我使用 2.0.10 开发了一个虚拟商店，我需要给定类别中的产品具有不同的购买流程。

有没有办法从现有产品的数据（名称、价格、描述等）中使用位于已知目录中的图像创建具有新 id 和 sku 的新产品？全部在前端完成，作为用户交互，使用 mercurial 2 的 MVC 框架类。

需要以这种方式将产品单独添加到购物车，即使是相同的产品库，每个产品都有其调整大小的图像，并且当您单击它以打开显示自定义图像的产品详细信息时。

如果有人知道怎么做，请帮忙！我查看了负责在 mercurial 中注册产品的类，但不知道如何从前端安全地进行操作。

第一步（将用户重定向到组件并创建自定义图像）已经完成并且正在工作，图像保存在目录中，其 url 记录在会话中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T15:38:35.033

看一下`VirtuemartControllerProduct::CloneProduct`功能。它会将您指向`VirtueMartModelProduct::createClone`工作实际发生故障的功能。

# android - Android : ViewFlipper 或 ViewPager - 哪个是更好的选择？

> ID：13031558
> 
> 赞同：26
> 
> 时间：2012-10-23T13:29:45.903
> 
> 标签：android, android-fragments, android-viewpager, viewflipper

我陷入了一个阶段。我总共有 20 到 25 张应该像动画一样的图像`ViewPager`。现在在我有`onClick()`事件的所有图像上，我不知道我是否应该使用`ViewPager`or `ViewFlipper`。我可以实现这两件事，这里没有问题。

**我想要什么：**我只想要一个建议，根据我的问题，哪个是最好的选择，`ViewFlipper`或者`ViewPager`？

**我搜索过的内容：**我浏览了 StackOverflow 上的不同链接，即[如何提高 ViewFlipper/ViewAnimator](https://stackoverflow.com/questions/7338351/how-to-improve-the-performance-of-viewflipper-viewanimator)和[ViewFlipper vs Fragments](https://stackoverflow.com/questions/9009071/viewflipper-vs-fragments)的性能，但我找不到我想要的东西。

我曾与`ViewPager`一些人合作过，但当时`Fragments`我只需要管理 3 或 4 个。如果我要用它来解决这个问题，我这次必须管理 25 个`Fragments`。所以我想知道是否有更好的解决方案。

我也做了一点研发`ViewFliper`，知道它只有一个`Activity`我必须管理，但它没有动画精度`ViewPager`。

请建议我是否应该去`ViewPager`或`ViewFlipper`？

提前致谢。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-11-07T07:38:47.203

*简介：*起初我认为我会推荐*Gallery*小部件而不是*ViewFlipper*，但它自 JellyBean（API 16）以来已贬值（0.o），可能是因为不可见元素实现的回收不良。

*答案：*你现在真正应该使用的是[**ViewPager**](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)或Horizo [​​ntalScrollView](http://developer.android.com/reference/android/widget/HorizontalScrollView.html)。在您的情况下（尽管没有太多详细信息），我认为[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)更好，因为根据文档：

> .. [Horizo](http://developer.android.com/reference/android/widget/HorizontalScrollView.html) ​​ntalScrollView 是一个 FrameLayout，这意味着您应该在其中放置一个孩子，包含要滚动的全部内容..

另一方面，对于[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)，您应该实现[PagerAdapter](http://developer.android.com/reference/android/support/v4/view/PagerAdapter.html)以生成将在此视图中显示的页面。

我的最终答案是*A*，[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html) ;)

希望你会觉得这很有帮助；）干杯

# python - 如何*更改* struct_time 对象？

> ID：13031559
> 
> 赞同：17
> 
> 时间：2012-10-23T13:29:46.440
> 
> 标签：python, time

在 python 中处理时间和日期时，您会偶然发现 time.struct_time 对象：

```
st = time.strptime("23.10.2012", "%d.%m.%Y")
print st
time.struct_time(tm_year=2012, tm_mon=10, tm_mday=23, tm_hour=0, tm_min=0,
                 tm_sec=0, tm_wday=1, tm_yday=297, tm_isdst=-1) 
```

现在，由于这个结构不支持项目分配（即你不能做类似的事情`st[1]+=1`），否则怎么可能增加月份的数量。

解决方案建议把这个time_struct转换成秒，加上对应的秒数，但是这样看起来不太好看。您还需要知道一个月有多少天，或者这一年是否是闰年。我想要一个简单的方法来获得一个 time_struct 例如

```
time.struct_time(tm_year=2012, tm_mon=11, tm_mday=23, tm_hour=0, tm_min=0,
                 tm_sec=0, tm_wday=1, tm_yday=297, tm_isdst=-1) 
```

只是一个月增加了一个。`time_struct`从头开始创建一个很好 - 但是如何？有哪些方法？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-23T13:34:22.430

请改用该[`datetime`模块](http://docs.python.org/library/datetime.html)，该模块具有更丰富的对象集来处理日期（时间）算术：

```
import datetime
adate = datetime.datetime.strptime("23.10.2012", "%d.%m.%Y").date()
adate + datetime.timedelta(days=30) 
```

您可以使用出色的[`python-dateutil`附加模块](http://labix.org/python-dateutil)来获得更丰富的选项来处理增量：

```
from dateutil.relativedelta import relativedelta
adate + relativedelta(months=1) 
```

`relativedelta`了解闰年、月份长度等，并且在将月份添加到 1 月 30 日时会做正确的事情（您最终会得到 2 月 28 日或 29 日，它不会跨越月份界限）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-06-20T18:06:53.870

所以...底层 time_struct 元组的模式在此处的文档中给出：http: [//docs.python.org/2/library/time.html#time.struct_time](http://docs.python.org/2/library/time.html#time.struct_time)

即使它作为 time_struct 是只读的，您也可以使用强制转换为 list() 直接获取该元组（请记住在增加月份后环绕您的月份，并将结束范围保持在 1-12 而不是 0 -11)。然后该`time.struct_time()`函数会将有效的 9 元组转换回 time_struct：

```
st = time.strptime("23.10.2012", "%d.%m.%Y")
st_writable = list(st)
st_writable[1] = (st_writable[1] + 1)%12 + 1
st = time.struct_time(tuple(st_writable)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-23T13:36:48.700

您可以先将其转换为日期时间，然后为其添加 timedelta 偏移量：

```
from time import mktime
from datetime import datetime

dt = datetime.fromtimestamp(mktime(struct))
timedelta = datetime.timedelta(seconds=10)
dt = dt + timedelta 
```

参考：

1.  [如何将 Python time.struct_time 对象转换为 datetime 对象？](https://stackoverflow.com/questions/1697815/how-do-you-convert-a-python-time-struct-time-object-into-a-datetime-object)
2.  [http://docs.python.org/library/datetime.html](http://docs.python.org/library/datetime.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-12T19:42:54.157

如果您想同时避免使用日期时间并坚持使用时间，您可以转换为 unix 时间戳，然后减去所需的秒数。要获取 24 小时前的时间对象：

```
time.gmtime(time.mktime(time.gmtime()) - 86400) 
```

但是，正如 OP 指出的那样，这不适合几个月的工作，应该保留几秒钟、几小时和几天。

# apache - Apache mod_speling 错误地“纠正”URL？

> ID：13031562
> 
> 赞同：2
> 
> 时间：2012-10-23T13:30:03.080
> 
> 标签：apache, mod-speling

我的任务是将旧的动态网站从 Windows 服务器迁移到 Linux。该网站最初是在不考虑字符大小写的情况下编写的。有些文件名都是大写的，有些是小写的，有些是混合的。当然，这在 Windows 中从来都不是问题，但现在我们正在转向区分大小写的文件系统。

带有快速查找/重命名命令（感谢另一个教程）的文件名全部小写。

但是，代码中的许多 URL 引用仍然指向这些大小写混合的文件名，因此我启用了 mod_speling 来克服这个问题。它似乎在大多数情况下都可以正常工作，除了一页：我有一个文件名`haematobium.html`，每次链接指向 时，它都会像在浏览器中`.../haematobium.html`一样被重写。`.../hæmatobium.html`

我不知道这个奇怪的字符最初是如何进入文件名的，但我已将 HTML 文档中的代码更正为现在链接到`haematobium.html`，然后重命名`haematobium.html`文件本身以匹配。

`.../haematobium.html`在 Chrome 中请求时，它会`.../hæmatobium.html`在地址栏中“更正”为，并显示错误消息“`.../hÃ¦matobium.html`在此服务器上找不到请求的 URL”。

在 IE9 中，提示我登录（这是一个受 .htaccess 保护的页面），我输入它，然后如果将 URL 转发到`.../h%C3%A6matobium.html`，它又不会加载。

在我的挫败感中，我什至都复制`haematobium.html`到了这三个页面`hæmatobium.html`，`hÃ¦matobium.html`但实际上这三个页面都没有加载。

所以我的问题是：我在某处读到 mod_speling 试图“学习”拼写错误的 URL。它是否真的重命名了文件（奇怪的字符可能来自哪里）？它是否保留了所要求的缓存以及转发到的缓存（我可以清除的缓存）？

PS。还有许多对 MySQL 数据库表和字段的混合大小写引用，但这完全是“另一个噩梦”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T22:07:40.743

[还不能评论，所以回答。]

您的问题并未完全清楚 haematobium.html 的两个名称（两个字符 ae [ASCII] 或一个连字字符[æ](http://en.wikipedia.org/wiki/%C3%86) [Unicode]）中的哪一个实际上存在于您的 Apache 文件系统中。

在您的外壳中尝试以下操作：

```
$ echo -n h*matobium.html | hd 
```

输出应该是以下两种选择之一。这是 ASCII，**a**和**e**分别为 61 和 65：

```
00000000  68 61 65 6d 61 74 6f 62  69 75 6d 2e 68 74 6d 6c  |haematobium.html|
00000010 
```

这是 Unicode，使用 c3 a6 表示单个字符**æ**：

```
00000000  68 c3 a6 6d 61 74 6f 62  69 75 6d 2e 68 74 6d 6c  |h..matobium.html|
00000010 
```

我建议使用 ASCII 版本，它使生活变得更加轻松。

现在到你的实际问题。[mod_speling](http://httpd.apache.org/docs/2.2/mod/mod_speling.html)既不“学习”，也不重命名或缓存其数据。缓存要么由您的浏览器完成，要么由您的浏览器和服务器之间的代理完成。

[实际上，使用wget](http://www.gnu.org/software/wget/)或[curl](http://curl.haxx.se/)等命令行工具测试这些案例是最佳实践，这些工具应该已经可用或可以轻松安装在任何 Linux 上。

使用`wget -S`或`curl -i`实际查看您的 Web 服务器发送的响应标头。

# c# - 如何在 ASP.NET Web 应用程序中使用 Powershell 在 AD 中创建用户

> ID：13031564
> 
> 赞同：1
> 
> 时间：2012-10-23T13:30:02.877
> 
> 标签：c#, asp.net, powershell, active-directory, powershell-remoting

我对 ASP.NET 应用程序中的 C# 和 Powershell 有疑问。

我想在我们的 Active Directory 中创建一个用户，并且我想/必须为此使用 powershell。一年前，我构建了一个可以在 Exchange Server 中添加邮件联系人的 Webapllication。为此，我将 System.Management.Automation 命名空间与 Powershell 类一起使用。但我不知道如何为 Active Directory 做到这一点。

我必须使用的 ps 命令：

```
New-ADUser %prefix-%name 
-SamAccountName "%name" 
-UserPrincipalName "%name@test-company.com" 
-GivenName "%text1" 
-SurName "%text2" 
-displayname "%name" 
-enabled $true 
-Path '%OU' 
-AllowReversiblePasswordEncryption $true 
-PasswordNeverExpires $true 
-AccountPassword (ConvertTo-Securestring "%name" -asplaintext -Force) 
```

这是我的cs代码：

```
public void CreateRemoteConnectionToActiveDirectory(string Username, string password//,...comming)
        {
            SecureString securePassword = new SecureString();

            str_password = password;
            str_username = Username;

            foreach (char x in str_password)
            {
                securePassword.AppendChar(x);
            }

            PSCredential cred = new PSCredential(str_username, securePassword); 

          //  connection?
        } 
```

我的交换服务器旧代码：

```
public string CreateRemoteConnectionToExchange(string UserName, string Password, string Mailbox)
        {
                SecureString SecurePassword = new SecureString();

                string str_password = Password;
                string str_username = UserName;

                foreach (char x in str_password)
                {
                    SecurePassword.AppendChar(x);
                }

                PSCredential cred = new PSCredential(str_username, SecurePassword);

                WSManConnectionInfo connectionInfo = new WSManConnectionInfo(new Uri(ExchangeServer), Schema, cred);

                connectionInfo.AuthenticationMechanism = AuthenticationMechanism.Default;

                Runspace runspace = RunspaceFactory.CreateRunspace(connectionInfo);

                PowerShell powershell = PowerShell.Create();
                PSCommand command = new PSCommand();

                command.AddCommand("New-MailContact");
                command.AddParameter("ExternalEmailAddress", "SMTP:" + Mailbox + MailExtension);
                command.AddParameter("Name", Mailbox);
                command.AddParameter("Alias", Mailbox);
                command.AddParameter("FirstName", Mailbox);
                command.AddParameter("Initials", "");
                command.AddParameter("LastName", "");
                command.AddParameter("OrganizationalUnit", OrganizationalUnit);
                command.AddParameter("DomainController", configDC);

                powershell.Commands = command;

                try
                {
                    runspace.Open();

                    powershell.Runspace = runspace;

                    powershell.Invoke();

                    return "Der Kontakt wurde Erfolgreich erstellt";
                }
                catch (Exception ex)
                {
                 ///...
                }
                finally
                {
                    runspace.Dispose();
                    runspace = null;
                    powershell.Dispose();
                    powershell = null;
                }

        } 
```

我怎么能做到这一点。一个示例、教程或提示会对我有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T15:25:41.217

看起来您的连接只需要连接到您的 AD 服务器或其他可以实际执行命令的服务器。

# java - 在 JTable 列中呈现多行文本

> ID：13031565
> 
> 赞同：0
> 
> 时间：2012-10-23T13:30:10.167
> 
> 标签：java, swing, jtable

我有一个 JTable，我想展示一个包含代表新行的“\r\n”的文本字符串。我希望这些新行显示在表格中，而不仅仅是被忽略。下面是我的问题的可视化表示。

今天：

```
|Titel           |
------------------
|texttex ttext xt|
------------------ 
```

目标：

```
 |Titel   |
  ----------
  |texttex |
  |ttext xt|
  ---------- 
```

我已经尝试过 JTextPane，但我的结果是该对象的文本表示，而不是封装在 JTextPane 中的文本..（也许我不理解所有那些明显的互联网指南）。

总结这个问题，我如何在包含多行的 JTable 中呈现一列，而每一行都没有索引。（或如何真正使 JTextPane 在列中工作的基本说明..？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T13:44:04.567

我建议您使用`<br>`而不是`\r\n` 或`TableCellRenderer`在您的`JTable`. 调用时将`TableCellRenderer`返回 a `JTextPane`- 仅创建一个实例`JTextPane`并为每次调用返回它（在设置适当的值之后）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-23T13:42:57.143

请参阅[JTable 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html)，

1.  [如何真正制作 JTextPane 的基本说明](https://stackoverflow.com/a/12867849/714968)

2.  事件是示例`JTextArea`，必须更改`JTextPane`和添加`JTextPane#setContentType(text/html)`，查看 API

3.  问题可能与`SystemLookAndFeel`和`JTextPane as JTables Renderer`

# java - 加速詹金斯构建

> ID：13031569
> 
> 赞同：0
> 
> 时间：2012-10-23T13:30:21.673
> 
> 标签：java, maven, build, jenkins

Jenkins 在每次构建期间所做的最耗时的任务之一是将工件下载到它删除的本地存储库中。

虽然删除我的工件很好。我不明白删除之前下载到其本地 maven 存储库（.m2）中的第 3 方工件的必要性。

有什么方法可以防止 Jenkins 在构建之前删除本地存储库。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T15:55:48.277

您应该安装像 Sonatype Nexus、JFrog Artifactory 或 Apache Archiva 这样的 Maven 存储库管理器 (MRM)，并且下载将在您的网络本地并且非常快速。使用 MRM 几乎被认为是使用 Maven 或任何具有声明性依赖管理的构建工具的必要条件，因为它允许您缓存工件以及上传您自己的库并在您的开发人员和您的 CI 构建之间共享它们。

如果这仍然不够，您可以禁用每个构建的私有存储库删除，甚至每次构建使用一个共享存储库，但这会降低构建的稳定性，因为您现在在构建之间混合并因此引入了相互依赖关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T17:48:01.953

虽然我同意 Manfred 关于使用 Maven 存储库管理的建议，但我还建议您查看如何管理 Maven 本地存储库：

*   [阻止 Jenkins 将工件安装到本地 Maven 存储库](https://stackoverflow.com/questions/7582271/prevent-jenkins-from-installing-artifact-to-local-maven-repository/7587606#7587606)
*   [什么时候可以安全地删除本地 Maven 存储库？](https://stackoverflow.com/questions/10049948/when-is-it-safe-to-delete-the-local-maven-repository/10050239#10050239)
*   [Ivy, Ant, Jenkins - 在 Jenkins 构建上使用 <ivy:cleancache> 是个好主意吗？](https://stackoverflow.com/questions/12076067/ivy-ant-jenkins-is-it-good-idea-to-to-a-ivycleancache-on-jenkins-builds/12080049#12080049)

Maven 通常不会清除本地存储库，我猜您有一个定期任务来执行此操作。

# iphone - 应用程序关闭时下载报亭应用程序

> ID：13031589
> 
> 赞同：3
> 
> 时间：2012-10-23T13:31:08.663
> 
> 标签：iphone, ios, ipad, newsstand-kit

我正在实施一个报亭杂志应用程序，它通过 Urban Airship 推送通知接收新问题。只要应用程序处于前台或后台，这工作正常，但据我所知，当应用程序完全关闭时也应该触发下载。但是如果我的应用程序关闭，在有效负载中发送推送`"content-available":1`不会做任何事情。

我在目标属性中设置了所需的背景模式，并使用它`NKDontThrottleNewsstandContentNotifications`来避免测试问题。

我错过了什么吗？

不应该推动导致我

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

被调用`UIApplicationLaunchOptionsRemoteNotificationKey`？

非常感谢帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T01:23:35.037

根据[这篇文章](http://www.macstories.net/stories/ios-5-newsstand-overview/)，

*正在开发报亭应用程序的开发人员可以提供一个新的“加强版”推送通知，通知他们的应用程序（而不是像推送通知通常那样做的用户），一个新的问题已经准备好下载。当报亭应用程序收到此类通知时，**如果设备在 WiFi 上，它可以在后台下载**。这里的主要限制是每个应用程序每天只能发送 1 个此类推送通知，因此目前开发人员无法开发同时提供早报和晚报的报纸——尽管我怀疑这最终可能会改变。*

所以它只有在设备在 Wifi 上时才能下载。

这些是其他类似的问题，[新站推送和执行代码](https://stackoverflow.com/questions/7980910/new-stand-push-and-execute-code)，[iOS 报刊亭：推送通知不会在后台启动应用程序](https://stackoverflow.com/questions/12218073/ios-newsstand-push-notification-does-not-launch-the-app-in-background)，报刊亭[在 Resuming](https://stackoverflow.com/questions/8034880/newsstand-restarts-the-download-on-resuming?rq=1)和这个[iPhone 报刊亭推送注册失败](https://stackoverflow.com/questions/7832432/iphone-newsstand-push-registration-failure?rq=1)时重新启动下载。检查您是否还遗漏了这些答案中提到的任何内容。

这是有关此的[苹果文档和有关此](https://developer.apple.com/library/ios/#technotes/tn2280/_index.html#//apple_ref/doc/uid/DTS40011215)的另一个[博客](http://docs.xamarin.com/ios/Guides/Platform_Features/Introduction_to_Newsstand)。

# android - How get the context in a class which extends Exception

> ID：13031590
> 
> 赞同：0
> 
> 时间：2012-10-23T13:31:12.197
> 
> 标签：android, exception, android-context

I tried everything, this [Using Application context everywhere?](https://stackoverflow.com/questions/987072/using-application-context-everywhere) and few things more and nothing works.

I need the application context in my DatabaseException class which extends Exception. I need it because I want to check some `sharedpreferences` when the exceptions are launched. The code basically is this:

```
public class DatabaseException extends Exception {

private static final long serialVersionUID = 1L;

DatabaseException(){
    super();
}

DatabaseException(String s){
    super(s);
}

public DatabaseException (String s, Throwable t){
    super (s,t);
    kindOfException(t.getCause(), s);
}

DatabaseException (Throwable t){
    super (t);
    kindOfException(t.getCause(), null);
} 
```

...

```
private void createLog() {
    Log.d("Database Exception","On Create Log");
    String listLogs;
    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(DatabaseException.class.context); 
```

of course this doesn't work. So... please, somebody can help me?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:38:53.717

```
public class DatabaseException extends Exception {

private static final long serialVersionUID = 1L;

public YourContext context;
public DatabaseException(YourContext context){
    this.context = context;
}
} 
```

Now if you catch the exception:

```
try {
    ...
} (catch DatabaseException e) {
    MyContext context = e.context;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:33:57.317

It is Simply.. you can not. But when the `Execption` is raised you can perform

```
private void createLog() {
    this.getContext();
    Log.d("Database Exception","On Create Log");
    String listLogs;
    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(DatabaseException..
} 
```

the operation you need in the `catch` clause.

You could pass it as paramter but, please, avoid it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:40:24.997

Quick answer:
1\. Add application context as parameter of the DatabaseException construtor.
2\. Put your DatabaseException as other class's inner class. (Other class means Activity...), so you can use fields/method of outer class in the inner class.
3\. ...

# unit-testing - 在 IntelliJ 中运行单元测试，但类中有错误

> ID：13031595
> 
> 赞同：14
> 
> 时间：2012-10-23T13:31:23.880
> 
> 标签：unit-testing, compiler-errors, intellij-idea

我是使用 IntelliJ 的新手。我只有一个不满，那就是编译器。我更喜欢 Eclipse 编译器编译项目并跳过有错误的类的方式。

如果我想为某个方法编写单元测试，这尤其是一个问题，我必须修复整个项目中的所有错误以运行单个单元测试！

你可能会说修复你的项目，但我正在处理一个项目，人们已经提交了其中有错误的代码。我该如何解决这个问题，我看到在设置中有一个使用 Eclipse 编译器的选项，但这没有任何区别/我不知道跳过错误的参数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-05-18T14:26:27.567

这在 IntelliJ 14 上为我修复了它：

*   在 Preferences->Build,Exec,Deploy->Compiler->Java Compiler 中，选择 Eclipse 编译器。然后选中“Proceed on errors”，一旦选择了 Eclipse 编译器就会出现。
*   然后在 Run->Edit Configurations 中展开左侧的 Defaults 部分。为您的单元测试框架选择配置（例如，JUnit 或 TestNG）。
*   然后在“启动前”部分，删除“Make”并添加“Make, no error check”
*   最后，您可能需要删除任何现有的单元测试运行配置，以便新的启动设置生效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-30T22:01:57.823

Not sure if this will be effective for what you're attempting to do and how your project is structured, but it worked perfectly well for me in my particular case, in that if your class has a main method, you can right click inside of the actual main method code and select "Run '*classname*.main()'" from there.

This worked for me, but obviously may not be identical to your situation.

I got this from another answer located here: [Intellij IDEA how to run a class not the entire project?](https://stackoverflow.com/questions/22282918/intellij-idea-how-to-run-a-class-not-the-entire-project)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-05T03:09:54.830

一个笨拙的方法是在你的项目文件下创建一个*新模块*，并在这个新模块的 src 文件夹中创建一个测试文件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-06T10:00:26.260

在 IntelliJ 2018.1.4 (Linux) 上：2018-06-06

1.  在 File->Settings->Build,Exec,Deploy->Compiler->Java Compiler 中，从下拉列表中选择 Eclipse 编译器。选项“Proceed on errors”应该已经选中（如果没有，请在上面打勾），一旦您选择了 Eclipse 编译器，该选项就会出现。
2.  然后在 Run->Edit Configurations -> 展开左侧的 Defaults 部分。为您的单元测试框架选择配置（例如，JUnit 或 TestNG）。
3.  然后在“启动前：构建，激活工具窗口”部分（见最后），删除“构建”并添加“构建，无错误检查”。点击应用就OK了
4.  最后，您可能需要删除任何现有的单元测试运行配置，以便新的启动设置生效。这可以在（例如，JUnit 或 TestNG）下的 Run->Edit Configurations 中找到。或者我们可以编辑它

# c - C 指针递增有问题（我认为）

> ID：13031600
> 
> 赞同：2
> 
> 时间：2012-10-23T13:31:37.243
> 
> 标签：c, arrays, pointers, compilation

我猜这是一个非常简单的错误，但在尝试编译我的 C 代码时出现此错误：

```
error: expected identifier before '(' token 
```

从这段代码中，我尝试为带有链表的哈希表设置结构以进行哈希冲突：

```
typedef struct bN {
    MEntry nestedEntry;
    struct bN *next;
} bucketNode;

typedef struct bL {
    bucketNode *first;
    int bucketSize;
} bucket;

struct mlist {
    bucket *currentTable;
}; 
```

而这段代码是我实际初始化链表的地方：

```
MList *ml_create(void){

    MList *temp;

    if (ml_verbose){
        fprintf(stderr, "mlist: creating mailing list\n");
    }
    if ((temp = (MList *)malloc(sizeof(MList))) != NULL){
        temp->currentTable = (bucket *)malloc(tableSize * sizeof(bucket));
        int i;
        for(i = 0; i < tableSize; i++){
            temp->(currentTable+i)->first = NULL; /**ERROR HERE*/
            temp->(currentTable+i)->bucketSize = 0; /**ERROR HERE*/
        }
    }
    return temp;

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-23T13:35:36.190

您的语法已关闭。你的意思是：

```
temp->currentTable[i].first = NULL;
temp->currentTable[i].bucketSize = 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:35:40.120

改变

```
temp->(currentTable+i)->first = NULL; 
```

成为

```
(temp->currentTable+i)->first = NULL; 
```

# c - 作为 OS X 上的普通用户，您如何使用 Xcode 调试 libpcap 代码？

> ID：13031601
> 
> 赞同：1
> 
> 时间：2012-10-23T13:31:42.170
> 
> 标签：c, macos, unix, xcode4, libpcap

我在 xCode 中使用 libpcap 编写了以下代码

```
#include<pcap.h>
#include<string.h>
#include<stdlib.h>
#include<stdio.h>
#include<ctype.h>
#include<unistd.h>
#define MAXBYTES2CAPTURE 2048

void processPacket(u_char *arg,const struct pcap_pkthdr* pkthdr,const u_char* packet){
    int i=0,*counter=(int*)arg;
    printf("Packet Count:%d\n",++(*counter));
    printf("Recived Packet Size:%d\n",pkthdr->len);
    printf("Payload:\n");
    for(i=0;i<pkthdr->len;i++){
        if(isprint(packet[i]))
           printf("%c",packet[i]);
        else
            printf(". ");
        if((i%16==0&&i!=0)||i==pkthdr->len-1)
            printf("\n");
    }
}

int main(){
    int count=0;
    pcap_t *descr=NULL;
    char errbuf[PCAP_ERRBUF_SIZE];
    memset(errbuf,0,PCAP_ERRBUF_SIZE);
    descr=pcap_open_live("en1", MAXBYTES2CAPTURE, 1, 512, errbuf);
    if(descr!=NULL)
        pcap_loop(descr, -1, processPacket,(u_char*)&count);
    else
        printf("ERROR");

        return 0;
} 
```

现在从 xCode 4.4 运行时，它显示“错误”，但是当我转到产品目录并在终端中像这样运行时：

```
sudo ./TCP_packet
password:******** 
```

它运行良好
我已经使用了 setuid(0)，但仍然无法在 xCode 中工作！！！
那么，我如何在 xCode 中以 root 身份运行这个程序，我必须在 xCode xCode ver:4.4
OSX:10.7 Lion中进行一些设置，
谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:47:16.833

您需要在构建**后**创建由 root 拥有的应用程序 setuid。

如果你想让程序工作，你需要做：

```
chown root:wheel TCP_packet
chmod u+s TCP_packet 
```

这将允许它以 root 权限运行，从而访问数据包捕获设备。

如果您安装了wireshark，它应该已经将您的用户帐户添加到一个`access_bpf`组中，该组允许访问`/dev/bpf*`设备，这是您执行数据包捕获所需的。

在这个助手之前，我曾经这样做：`sudo chgrp admin /dev/bpf*; sudo chmod g+r /dev/bpf*`，它允许访问数据包捕获设备，直到下次重新启动

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:40:43.253

setuid 仅适用于 system()、fork() 或 exec() 调用，因此这对您没有帮助

你可以做的是`chmod u+s TCP_packet`作为root用户，这将做你想做的事

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T21:23:53.533

我不确定为什么人们说要对`/dev/bpf*`文件进行 chmod。只需将您自己添加到该`access_bpf`组，以便您的用户帐户可以访问数据包过滤设备。

转到`Apple menu > System Preferences... > Users & Groups`，如果需要，解锁面板，单击`+`，`Group`从下拉列表中选择，命名组`access_bpf`，然后创建它。然后展开`Groups`并确保您的用户帐户已添加到其中。

为我工作。我不需要`sudo`用来捕获数据包。（或`chmod`每次开机）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T21:12:18.603

或者，因为您正在调试并希望以 root 身份完成此操作；只需以 root 身份启动 Xcode。

```
cd /Applications/Xcode.app/Contents/MacOS/
sudo ./Xcode 
```

导航到您的项目，一切顺利。

享受。

~摩西

# jmeter - 通过 JMeter 测试网站是否实际上使主服务器超载

> ID：13031607
> 
> 赞同：4
> 
> 时间：2012-10-23T13:32:11.883
> 
> 标签：jmeter

我用来测试我的网络服务器[https://buyandbrag.in](https://buyandbrag.in)。我已经为 100 个用户进行了测试。但是主服务器没有显示它是否拥挤。我想知道它是否真的对主服务器（我正在使用的云服务器）施加压力。或者只是使用安装该工具的客户端资源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:08:42.573

是的，如上所述，您应该监视两台服务器以查看它们如何处理负载。最简单的方法是使用 TOP（如果您的服务器操作系统是 *NIX），您还应该观察网络活动，即带宽、连接状态（时间等待、关闭等待等）。

此外，如果您使用 apache 密切关注日志，您应该会看到那里记录的请求

祝你考试顺利

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-05T11:37:20.917

> 我想知道“我的网站可以处理多少用户？”，当我用 50 个线程进行测试时，我的服务器的 cpu 使用率增加了，但连接日志没有增加（它只显示 2 个连接）。带宽使用量也没有那么多

首先，您指的是什么连接？阿帕奇，数据库等？

其次，如果您想查看当前设置可以提供多少用户，您需要创建一个普通用户将在您的网站上做什么的配置文件或流量模型。

例如：

```
Say 90% of the time they will search for something
5% of the time they will purchase x
5% of the time they login. 
```

一旦定义了“流量模型”，在 jMeter 中实现它，然后开始以增量方式增加负载，即用 x 个用户运行负载测试 10 分钟，10 分钟后增加该数字，依此类推，直到找到断点。

如果您绘制响应图，您应该会看到两个主要内容：

1) 服务降级前的最佳响应时间/用户数量 2) 临界点，即您从什么时候开始返回 503 等

现在您将拥有足够的数据来扩展您的站点或从代码的角度开始改进性能。

# ios - 使用 UIActionSheet 更改视图时工具栏项消失

> ID：13031608
> 
> 赞同：3
> 
> 时间：2012-10-23T13:32:15.403
> 
> 标签：ios, ios6, uitoolbar, uiactionsheet, viewwillappear

从`UIActionSheet`按钮启动视图时，在通过导航栏后退按钮返回视图时，工具栏虽然仍然可见，但没有以前在其上的任何按钮。此错误自更新到 iOS 6 后出现，并在模拟器和仅运行 iOS 6 的设备上测试时发生。如果我注释掉隐藏工具栏的代码，`UIActionSheet`按钮会在返回时添加。

我正在以编程方式制作我的工具栏项目，`viewWillAppear`并显示`UIActionSheet`我通过`self.navigationController.toolbar`.

知道是什么导致了这个问题吗？自从 iOS 6 出现以来才发生这种情况，所以我需要考虑任何更改`viewWillAppear`吗？

这是从 actionSheet 推送视图的方式：

```
- (void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {

    if (actionSheet.tag == 2) {

    if (buttonIndex == 0) {

        [self dismissAllTips];

        self.actionNoteAddView= [[self.storyboard instantiateViewControllerWithIdentifier:@"IDActionNoteAddView"] retain];

        actionNoteAddView.note_id = 0;
        actionNoteAddView.iscompleted=0;

        [[NSUserDefaults standardUserDefaults] setBool:NO forKey:@"tool_tips"];

        [self.navigationController pushViewController:actionNoteAddView animated:TRUE];

        [actionNoteAddView release];

    }else if(buttonIndex == 1){

        ... 
```

这些是推送视图的视图方法：

```
-(void)viewWillAppear:(BOOL)animated{

    [super viewWillAppear:animated];

    self.navigationItem.hidesBackButton = NO;
    [self.navigationController setToolbarHidden:YES];

    txtcontent.layer.cornerRadius = 10.0f;

}

-(void)viewDidAppear:(BOOL)animated{

    [super viewDidAppear:animated];

} 
```

这些是使用 actionSheet 推送视图的视图的视图方法：

```
- (void) viewWillAppear:(BOOL)animated{

    [super viewWillAppear:animated];

    self.navigationItem.hidesBackButton = YES;
    [self.navigationController setToolbarHidden:NO];
    self.navigationController.navigationBarHidden=NO;

    self.navigationController.navigationBar.barStyle = UIBarStyleBlackOpaque;
    self.navigationController.navigationBar.tintColor = [UIColor colorWithRed:0.8 green:0.45 blue:0.2 alpha:1];
    self.navigationController.toolbar.barStyle = UIBarStyleBlackOpaque;
    self.navigationController.toolbar.tintColor = [UIColor colorWithRed:0.8 green:0.45 blue:0.2 alpha:1]; 

    UIImage *actionButtonImage = [UIImage imageNamed:@"31-circle-plus@2x.png"];
    UIBarButtonItem *actionButton = [[UIBarButtonItem alloc] initWithImage:actionButtonImage style:UIBarButtonItemStylePlain target:self action:@selector(actionPressed:)
                                     ];

    UIImage *dashButtonImage = [UIImage imageNamed:@"19-gear.png"];
    UIBarButtonItem *dashButton = [[UIBarButtonItem alloc] initWithImage:dashButtonImage style:UIBarButtonItemStylePlain target:self action:@selector(settingsPressed:)];

    UIBarButtonItem *flexItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace
                                                                              target:nil
                                                                              action:nil];

    NSArray *toolitems = [NSArray arrayWithObjects:dashButton, flexItem, actionButton, flexItem, nil];

    [self setToolbarItems:toolitems];

    self.title = @"Dashboard";

    defaultProfile.text = [[NSUserDefaults standardUserDefaults] stringForKey:@"default_profile"];

    BOOL dailyProcess = [[NSUserDefaults standardUserDefaults] boolForKey:@"daily_process"];

    if(dailyProcess){

        [[NSUserDefaults standardUserDefaults] setBool:NO forKey:@"daily_process"];
        [[NSUserDefaults standardUserDefaults] synchronize];

        loading = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)];

        labelProcess = [[UILabel alloc]initWithFrame:CGRectMake(60, 105, 240, 30)];
        labelProcess.text = @"Processing...";
        labelProcess.backgroundColor = [UIColor clearColor];
        labelProcess.textColor=[UIColor colorWithRed:0.8 green:0.45 blue:0.2 alpha:1];
        [labelProcess setFont:[UIFont systemFontOfSize:20]];

        loading.opaque = NO;
        loading.backgroundColor = [UIColor colorWithWhite:0.0f alpha:0.6f];

        indicator = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
        [indicator setHidesWhenStopped:YES];
        indicator.center = self.view.center;

        [self.view addSubview:loading];
        [self.view addSubview:indicator];

        [self.view addSubview:labelProcess];

        [indicator startAnimating];

    }

}

-(void)viewDidAppear:(BOOL)animated{

    [super viewDidAppear:animated];

    CGRect frame = CGRectMake(157, 365, 10, 10);
    UIView *viewToPointAt = [[UIView alloc] initWithFrame:frame];

    [self.view addSubview:viewToPointAt];

    BOOL willies = [[NSUserDefaults standardUserDefaults] boolForKey:@"tool_tips"];

    if(willies==YES){

        if(popTip == nil) {

            popTip = [[[CMPopTipView alloc] initWithMessage:@"Step 1/3: This is the Action Button. You can create, view and auto-fill notes which are then added to your timeline.(Click for step 2)."] autorelease];
            popTip.delegate = self;

            [popTip presentPointingAtView:viewToPointAt inView:self.view animated:YES];
            popTip.backgroundColor = [UIColor colorWithRed:0.8 green:0.45 blue:0.2 alpha:1];
            popTip.textColor = [UIColor whiteColor];

        }

    }

    [viewToPointAt release];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T16:37:45.527

尝试了很多不同的技术，最终通过在一个视图方法中显示它并在下一个视图方法中隐藏它来对其进行排序。这是我遇到的最奇怪的错误之一，这很难解决，但我讨厌有未回答的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T02:26:16.547

您可以通过在下一个视图中隐藏工具栏来解决此问题，但这不是一个很好的解决方案，因为可以从包含工具栏的视图中打开的其他视图都必须在需要时隐藏工具栏，这很烦人.

另一种解决方案是在 viewDidDisappear 中隐藏工具栏，但还有另一个问题，假设另一个新视图也需要工具栏，并且它设置工具栏在自己的 viewWillAppear 中可见，那么问题是新视图的 viewWillAppear 将被调用实际上在前一个视图的 viewDidDisappear 之前，所以在这种情况下，即使新视图需要它，工具栏也会消失。

无论如何，我不确定这是否是 iOS6 的错误，因为它适用于 iOS5，对我有用的是将打开新视图的代码包装到**dispatch_async(dispatch_queue_t queue, dispatch_block_t block)**中，我的理解是这样做，操作表将在显示新视图之前被解除，因为您将打开新视图的代码放在主队列的末尾（就像我们为 viewDidDisappear 所做的那样，但这发生在调用下一个视图的 viewWillAppear 之前所以它完美无缺）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T08:02:37.833

得到了解决方案，我认为这是 iOS 6.0 及更高版本中的 Apple 错误。

在`NavigationController`视图堆栈中，如果任何视图隐藏了工具栏，例如`self.navigationController.toolbarHidden = YES`，那么由于所有已经创建了带有按钮的工具栏的视图上的那个点，都会松开按钮。

所以，我对这个问题的解决方案是将工具栏保留在所有视图中（不得不在 UI 上妥协，但在我的应用 pikSpeak 中，功能非常重要。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-15T02:48:53.117

这是一个古老的线程，我知道，但我最近遇到了这个问题。我的解决方案的线索是在推送新视图和关闭操作表之间需要一些延迟。我从使用 clickedButtonAtIndex 更改为 didDismissWithButtonIndex 以便在操作表消失后进行推送。问题解决了！

# php - 将 jQuery 数组转换为 php 形式

> ID：13031611
> 
> 赞同：0
> 
> 时间：2012-10-23T13:32:19.903
> 
> 标签：php, jquery, ajax, arrays, forms

我有一个表单，其中包含几个输入文本字段和一个可排序的列表（下面的代码）。下面的函数检索保存到数组（订单）中的新位置。但是，我想要的是将数组包含在表单中，以便当用户完成排序、填写文本字段并提交表单时，该数组将成为表单的一部分。

那么，如何使用 AJAX 将这个数组放入表单中呢？

```
$('#listElements').sortable({
            //revert: true,
            update: function(event, ui) {

                var order = [];
                $('.listObject li').each(function (e) {
                    order.push($(this).attr('id'));
                });
                $.ajax({
                    url: "/index.php?type=list&action=showList&listId=1",
                    type: "post",
                    data: {
                        order_data: order
                    }
                }).success(function (data) {
                    console.log(data);
                });
            }
        }); 
```

注意：为了清楚起见，我想将数组放入表单中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:46:08.117

将其作为 JSON 编码字符串发送并在服务器端对其进行解码。据我所知，jquery 有一个 JSON 函数数组，而 php 得到了 json_decode()

# ajax - Wicket：BehaviorRequestTarget - 组件未启用或可见；无视电话

> ID：13031612
> 
> 赞同：0
> 
> 时间：2012-10-23T13:32:22.523
> 
> 标签：ajax, wicket

在一页上，我添加了两个面板，请参见图`"select one or more"`和`"select one"`。该图形`"select one or more"`是第一次`panel`加载页面时对用户可见的第一个图形。在用户做出一些选择后，他/她可以点击`next`按钮。这样做，另一个`panel` `"select one"`变得可见，而第一个面板变得不可见。单击`back`按钮，第一个面板可见，第二个面板消失。在第二个面板上进行选择并单击下一页`"your selection"`打开页面。

一切正常，直到我单击`browser`从第二页`"your selection"`到第一页的后退按钮。回到第一页，用户会看到面板`"select one or more"`，但没有任何效果。当我点击我在调试中看到的复选框时：

`BehaviorRequestTarget - component not enabled or visible; ignoring call. Component: [MarkupContainer [Component id = selection]]`

当我点击下一个按钮

`BehaviorRequestTarget - component not enabled or visible; ignoring call. Component: [MarkupContainer [Component id = next]]`

这是 ajax 调试文本：

`INFO: focus set on idb`

`INFO: Initiating Ajax POST request on ?wicket:interface=:2:allpopup:content:form:allItemsContainer:items:7:selectionContainer:selected::IBehaviorListener:0:&random=0.997746484662292`

`INFO: Invoking pre-call handler(s)...`

`INFO: Received ajax response (0 characters)`

`ERROR: Wicket.Ajax.Call.failure: Error while parsing response: Could not find root <ajax-response> element`

`INFO: Invoking post-call handler(s)...`

`INFO: Invoking failure handler(s)...`

知道为什么会发生这种情况以及该怎么做吗？

谢谢

![在此处输入图像描述](../Images/3acd846491f8afa9a6f7248360e49cf5.png)![在此处输入图像描述](../Images/97e415fcf1f323e0ac1265498480cf1c.png)![在此处输入图像描述](../Images/3e3c98cf88e71cc06795d4610358768a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T17:18:24.273

我将以下内容添加到我的 BasePage.java 文件（它扩展了 WebPage）中，以在单击后退浏览器按钮时强制页面重新加载。

```
// Sets page reload on browser back button
@Override
protected void configureResponse() {
    super.configureResponse();
    WebResponse response = getWebRequestCycle().getWebResponse();
    response.setHeader("Cache-Control", "no-cache, max-age=0, must-revalidate, no-store");
    response.setHeader("Expires","-1");
    response.setHeader("Pragma","no-cache");
} 
```

我相信我从以下链接得到了建议：[http ://www.richardnichols.net/2010/03/apache-wicket-force-page-reload-to-fix-ajax-back/](http://www.richardnichols.net/2010/03/apache-wicket-force-page-reload-to-fix-ajax-back/)

# java - POST 值数组到 java servlet

> ID：13031617
> 
> 赞同：3
> 
> 时间：2012-10-23T13:32:39.913
> 
> 标签：java, arrays, post

我想放置以下表格：

```
<input type="hidden" name="MPK[]" value="x" class="MPK"/>
<input type="hidden" name="MPK[]" value="y" class="MPK"/>
<input type="hidden" name="MPK[]" value="z" class="MPK"/>
... 
```

并将其发布到 servlet 或 JSP 页面。如何在 servlet 的一个数组中获取这些输入的值？

```
request.getParameterValues("MPK"); 
```

即使我从名称中删除 [] 也不起作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-23T13:38:33.177

您必须通过解析从数组中获取值。

```
String[] mpk;

mpk= request.getParameterValues("mpk");
for(int i = 0; i < mpk.length; i++)
{
System.out.println(mpk[i]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:38:24.643

从参数名称中删除“[]”。例如

```
<input type="hidden" name="MPK" value="x" class="MPK"/> 
```

# ruby-on-rails - Ruby on Rails 中的 bgStretcher (jQuery)

> ID：13031625
> 
> 赞同：1
> 
> 时间：2012-10-23T13:32:56.767
> 
> 标签：ruby-on-rails

我在网上遇到了以下代码：

[http://www.ajaxblender.com/bgstretcher-2-jquery-stretch-background-plugin-updated.html](http://www.ajaxblender.com/bgstretcher-2-jquery-stretch-background-plugin-updated.html)

它就像 HTML & Javascript & CSS 的魅力。

现在的问题是如何在 Ruby on Rails 环境中实现这种代码。

我把这个问题分成了多个问题：

*   我在哪里放置 CSS 和 jQuery
*   如何将javascript实现到erb文件中
*   如何链接到我的 css 和 jQuery 文件（如 HTML）

亲切的问候，文森特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:56:47.450

你最好的选择是通过资产管道，这将清除很多事情

[http://guides.rubyonrails.org/asset_pipeline.html](http://railscasts.com/episodes/279-understanding-the-asset-pipeline)

[http://railscasts.com/episodes/279-understanding-the-asset-pipeline](http://railscasts.com/episodes/279-understanding-the-asset-pipeline)

# configuration - Inno 设置服务登录为

> ID：13031626
> 
> 赞同：4
> 
> 时间：2012-10-23T13:32:57.567
> 
> 标签：configuration, windows-services, inno-setup, advapi32

您能建议我如何获取特定 Windows 服务的“登录身份”参数吗？我需要在我们的升级项目中重新注册服务，并且它需要在最初设置的相同帐户下运行。我在 advapi32.dll 中找到了 QueryServiceConfig，lpServiceStartName 在返回的结构中，但我无法通过 Inno Setup 使其工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T15:11:14.183

您不能使用[`QueryServiceConfig`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684932%28v=vs.85%29.aspx)InnoSetup 脚本中的函数。要使用此功能，您必须从堆中分配缓冲区，而这在 InnoSetup 中是不可能的。相反，您可以使用 WMI，或者更具体地说，是[`Win32_Service`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394418%28v=vs.85%29.aspx)WMI 类，它包含`StartName`您要求的属性。在 InnoSetup 脚本中，它可能如下所示：

```
[Setup]
AppName=My Program
AppVersion=1.5
DefaultDirName={pf}\My Program

[Code]
function GetServiceStartName(const AServiceName: string): string;
var
  WbemLocator: Variant;
  WbemServices: Variant;
  WbemObject: Variant;
  WbemObjectSet: Variant;  
begin;
  Result := '';
  WbemLocator := CreateOleObject('WbemScripting.SWbemLocator');
  WbemServices := WbemLocator.ConnectServer('localhost', 'root\CIMV2');
  WbemObjectSet := WbemServices.ExecQuery('SELECT * FROM Win32_Service ' +
    'WHERE Name = "' + AServiceName + '"');
  if not VarIsNull(WbemObjectSet) and (WbemObjectSet.Count > 0) then
  begin        
    WbemObject := WbemObjectSet.Item('Win32_Service.Name="' + 
      AServiceName + '"');    
    if not VarIsNull(WbemObject) then
      Result := WbemObject.StartName;      
  end;
end;

procedure SvcStartNameTestButtonClick(Sender: TObject);
begin
  MsgBox(GetServiceStartName('Netlogon'), mbInformation, MB_OK);
end;

procedure InitializeWizard;
var
  SvcStartNameTestButton: TNewButton;
begin
  SvcStartNameTestButton := TNewButton.Create(WizardForm);
  SvcStartNameTestButton.Parent := WizardForm;
  SvcStartNameTestButton.Left := 8;
  SvcStartNameTestButton.Top := WizardForm.ClientHeight - 
    SvcStartNameTestButton.Height - 8;
  SvcStartNameTestButton.Width := 175;
  SvcStartNameTestButton.Caption := 'Get service start name...';
  SvcStartNameTestButton.OnClick := @SvcStartNameTestButtonClick;
end; 
```

制作一个外部库并从脚本中调用它会更容易（并且可能更快）。如果您有 Delphi 或 Lazarus，则可以使用以下函数，该函数使用该[`QueryServiceConfig`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684932%28v=vs.85%29.aspx)函数获取[`lpServiceStartName`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684950%28v=vs.85%29.aspx)您要求的成员：

```
function GetServiceStartName(const AServiceName: string): string;
var
  BufferSize: DWORD;
  BytesNeeded: DWORD;
  ServiceHandle: SC_HANDLE;
  ServiceManager: SC_HANDLE;
  ServiceConfig: PQueryServiceConfig;
begin
  Result := '';
  ServiceManager := OpenSCManager(nil, nil, SC_MANAGER_CONNECT);
  if ServiceManager <> 0 then
  try
    ServiceHandle := OpenService(ServiceManager, PChar(AServiceName),
      SERVICE_QUERY_CONFIG);
    if ServiceHandle <> 0 then
    try
      if not QueryServiceConfig(ServiceHandle, nil, 0, BufferSize) and
        (GetLastError = ERROR_INSUFFICIENT_BUFFER) then
      begin
        ServiceConfig := AllocMem(BufferSize);
        try
          if QueryServiceConfig(ServiceHandle, ServiceConfig, BufferSize,
            BytesNeeded)
          then
            Result := ServiceConfig^.lpServiceStartName;
        finally
          FreeMem(ServiceConfig);
        end;
      end;
    finally
      CloseServiceHandle(ServiceHandle);
    end;
  finally
    CloseServiceHandle(ServiceManager);
  end;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T13:09:12.573

我不喜欢链接外部库的想法，所以我最终以这种方式解决了这个问题：

```
function GetServiceLogonAs():string;
var
  res : Integer;
  TmpFileName, FileContent: String;
begin
  TmpFileName := ExpandConstant('{tmp}') + '\Service_Info.txt';
  Exec('cmd.exe', '/C sc qc "MyServiceName" > "' + TmpFileName + '"', '', SW_HIDE, ewWaitUntilTerminated, res);
  if LoadStringFromFile(TmpFileName, FileContent)  then
  begin    
    Result := Trim(Copy(FileContent,Pos('SERVICE_START_NAME', FileContent)+20,Length(FileContent)-(Pos('SERVICE_START_NAME', FileContent)+21)));
    DeleteFile(TmpFileName);
  end
  else
  begin
    ShowErrorMsg('Error calling: GetServiceLogonAs(" + MYSERVICE + ")', res);
    Result := '';
  end;
end; 
```

# c++ - 防止通过纯虚函数实例化一个类？

> ID：13031627
> 
> 赞同：7
> 
> 时间：2012-10-23T13:32:57.780
> 
> 标签：c++, class, polymorphism, abstract-class

我正在看我书中的以下代码：

```
class Shape
{
    public:
        Shape(){}
        ~Shape(){}
        virtual long getArea() = 0; // Pure virtual function
        virtual long getPerim() = 0;
        virtual void draw() = 0;
}; 
```

现在它说这些虚函数使类抽象（我从Java中理解），因此无法实例化该类。

但是，它说： “通过在类声明中包含***一个或多个****虚函数，**类是抽象数据类型。”*

 **这是否意味着如果我用一个纯虚函数声明一个**类**：

```
class Shape
{
    public:
        Shape(){}
        ~Shape(){}
        virtual long getArea() = 0; // Only pure virtual function
        virtual long getPerim(){}
        virtual void draw(){}
}; 
```

整个班级都变得抽象了吗？`=0`因为如果一个类有 100 多个方法，如果我决定稍后将其抽象化，那么为每个方法编写都会很乏味。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-23T13:34:05.253

是的，一个纯`virtual`方法就足以使类抽象。

`virtual`此外，如果没有其他方法适合纯析构函数，则始终可以使析构函数纯。

此外，你的析构函数应该是`virtual`，因为你显然要从这个类继承。如果您计划通过指向基类型的指针删除派生类型的对象，则这是强制性的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T13:44:20.920

您是正确的，因为一个纯虚拟方法足以使类抽象。这意味着您必须在派生类中实现该方法才能实例化（派生类的）实例。

我对您的“具有 100 多种方法的课程”有疑问。通常这是设计非常糟糕的标志。

我也对您“为每种方法都写 = 0”的态度感到厌烦。首先，我不明白为什么写 =0 比写 {} 作为默认的无操作实现更乏味（如果该方法返回任何东西，就像这样`getPerim()`做，你会因为不返回某些东西而冒着未定义的行为的风险）。不过，首先，业务逻辑决定了是否存在默认行为，而不是编写工作量。

记住 Liskov 替换原则：虽然一个人不能拥有基类的实例，但有人会拥有一个指针或引用，并在其上调用虚方法，而不必知道他们真正拥有的是什么类。（顺便说一下，Liskov 是女性，名字叫 Barbara，并在 1983 年左右的某个时候陈述了这一原则）。

顺便说一句，您的抽象基类几乎肯定应该有一个虚拟析构函数。

不会改变类状态的方法应该声明为 const。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-23T14:49:20.717

将函数标记为纯不仅使类抽象，它还使任何不覆盖该函数的派生类也抽象。

所以，如果你想强制派生类实现所有这些功能，那么就让它们都是纯的。`getArea`如果派生类只实现而不实现其他两个是有意义的，那么只标记`getArea`纯。在这个例子中，我怀疑它*没有*意义，因为如果所有派生类都添加了一种计算面积的方法，那么基类仍然无法计算周长。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T13:44:08.460

将方法声明为纯虚拟意味着继承您的类的类必须实现该方法或将其保留为纯虚拟，在这种情况下，派生类也将是无法实例化的抽象类。

此外，正如 Luchian 之前所说，对于每个将被继承的类，您应该始终将析构函数声明为虚拟的。**

# c# - 如何从网页中获取 HTML 代码？

> ID：13031630
> 
> 赞同：2
> 
> 时间：2012-10-23T13:33:09.867
> 
> 标签：c#, html

我正在尝试从特定网页获取 HTML 代码，但是当我使用

```
 HttpWebRequest request;
        HttpWebResponse response;
        StreamReader streamReader;
        request = (HttpWebRequest)WebRequest.Create(pageURL);
        response = (HttpWebResponse)request.GetResponse();
        streamReader = new StreamReader(response.GetResponseStream(), Encoding.GetEncoding("windows-1251"));
        htmlCode = streamReader.ReadToEnd();
        streamReader.Close(); 
```

或使用 WebClient，我被重定向到登录页面并获得其代码。有没有其他方法可以获取 HTML 代码？

我在这里阅读了一些信息：[How to get HTML from a current request, in a postback](https://stackoverflow.com/questions/2632838/how-to-get-html-from-a-current-request-in-a-postback)，但不明白我应该做什么，或者如何以及在哪里指定 URL。

PS：我在浏览器中登录。Notepad++ 通过“右键-查看源代码”完美地得到了我需要的东西。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:36:03.497

如果您被重定向到登录页面，那么大概您必须先登录才能获取内容。

因此，您需要使用合适的凭据向登录页面发出请求。获取发送的任何令牌（通常以 cookie 的形式）以维护登录。然后请求您想要的页面（随请求发送 cookie）。

或者（这是首选方法），大多数希望自动化系统与其交互的主要站点都提供 API（通常使用 OAuth 进行身份验证）。查阅他们的文档以了解他们的 API 是如何工作的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:38:43.827

如果您要访问的页面位于登录屏幕后面 - 您将需要通过代码执行登录机制。并添加一个关联的 CookieCollection 来保存网站将尝试在您的请求中删除的登录 cookie。

或者，如果您有可以帮助程序的用户，您可以尝试在他们通过浏览器登录后列出该站点的 cookie。复制该 cookie 并将其添加到 CookieCollection。

干杯西蒙

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:43:36.733

如果您想废弃需要认证的 html 页面，我建议您使用 Watin[填写](http://watin.org/) 正确的字段并导航到您要下载的页面。可能iot乍一看似乎有点矫枉过正，但以后会省去很多麻烦。

# wpf - 未找到静态资源参考“设置”

> ID：13031634
> 
> 赞同：0
> 
> 时间：2012-10-23T13:33:18.750
> 
> 标签：wpf, xaml

我的一个 WPF 应用程序已开始在窗口的设计器视图中抛出此错误。它编译和运行没有问题，但不会在设计器中加载。

然而，错误中最奇怪的部分是它只发生在第一次引用设置时。在下面的代码中，如果我注释掉第一个`<Setter>`，错误会向下移动到下一个。如果我随后取消注释 first `<Setter>`，则错误将移回它。

```
 <Style TargetType="{x:Type ComboBox}">
        <Setter Property="FontSize" Value="{Binding Source={StaticResource Settings}, Path=Default.setFontSize}" />
    </Style>
    <Style TargetType="{x:Type TextBox}">
        <Setter Property="FontSize" Value="{Binding Source={StaticResource Settings}, Path=Default.setFontSize}" />
    </Style>
    <Style TargetType="{x:Type Label}">
        <Setter Property="Foreground" Value="{Binding Source={StaticResource Settings}, Path=Default.setFontColor}" />
    </Style> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-12T17:01:46.063

我刚刚遇到了同样的问题。这是我在 App.xaml 中为应用程序全局解决它的方法。注意 xmlns:properies 和 properties:Settings 行。

```
<Application x:Class="MyApp.App"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:properties="clr-namespace:MyApp.Properties"
         StartupUri="MainWindow.xaml">
<Application.Resources>
    <properties:Settings x:Key="Settings" />
</Application.Resources> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T14:19:12.570

嗯 - 这很奇怪.. 在您的 Xaml 文件中，您是否看到任何带有 Settings 键的元素？

也许有什么东西在它运行时将它注入到资源字典中，所以这就是它构建和运行良好的原因。

# python - 字符串格式：以 0 开始科学计数法。对于正数，以 - 开头。对于负数

> ID：13031636
> 
> 赞同：0
> 
> 时间：2012-10-23T13:33:23.870
> 
> 标签：python, string-formatting

我想格式化具有固定指数格式的数字列表：

```
0.xxxxxxxxxxxxEsee 
```

如果数字为负数，则 0 应替换为 0：

```
-.xxxxxxxxxxxxEsee 
```

我可以用格式字符串来完成这个吗？例如

```
output.write('{:+016.10E}{:+016.10E}{:+016.10E}\n'.format(a,b,c)) 
```

效果很好，但不能满足降零的要求，也确实给出了领先的`0.`.

一个示例输出是

```
-.704411727284E+00-.166021493805E-010.964452299466E-020.229380762349E-07
-.103417103118E-05-.269314547877E-040.140398741573E-020.000000000000E+00
0.000000000000E+00-.704410110737E+00-.166019042695E-010.964139641580E-02
-.196412061468E-070.125311265867E-050.269427086293E-04-.140464403693E-02
0.000000000000E+000.000000000000E+00-.496237902548E-020.505395880357E-03
-.332217159196E-02-.192047286272E-030.139005979401E-02-.146291733047E-03
0.947012666403E-030.000000000000E+000.000000000000E+00-.496237514486E-02
0.505449126498E-03-.332395118617E-020.192048881658E-03-.139035528110E-02 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-26T09:45:38.987

这个怎么样？

```
import re

# "fix" a number in exponential format
def fixexp(foo):
  # shift the decimal point
  foo = re.sub(r"(\d)\.", r".\1", foo)
  # add 0 for positive numbers
  foo = re.sub(r" \.",    r"0.",  foo)
  # increase exponent by 1
  exp = re.search(r"E([+-]\d+)", foo)
  newexp = "E{:+03}".format(int(exp.group(1))+1)
  foo = re.sub(r"E([+-]\d+)", newexp, foo)
  return foo

nums = [ -0.704411727284, -1.66021493805, 0.00964452299466, 0.0000000229380762349, -0.00000103417103118, -0.0000269314547877, 0.00140398741573 ]

# print the numbers in rows of 4
line = ""
for i in range(len(nums)):
  num = "{:18.11E}".format(nums[i])
  num = fixexp(num)
  line += num
  if (i%4 == 3 or i == len(nums)-1):
    print line
    line = "" 
```

输出：

```
-.704411727284E+00-.166021493805E+010.964452299466E-020.229380762349E-07
-.103417103118E-05-.269314547877E-040.140398741573E-02 
```

# java - 将 JPanel 添加到 JScrollPane

> ID：13031637
> 
> 赞同：1
> 
> 时间：2012-10-23T13:33:29.387
> 
> 标签：java, jpanel, jscrollpane, layout-manager, springlayout

我有一个 gui，它有一个面板，其中包含一系列标签和 TextField，并使用弹簧布局（这是 mainPanel）和另一个仅包含按钮（buttonPanel）的面板。我试图让我的 mainPanel 也有一个垂直滚动条。我想实现我的 GUI，以便在 JFrame 中有 2 个面板。mainPanel 出现在框架的顶部，而 buttonPanel 出现在 mainPanel 的下方。

我的问题是我无法使面板显示为使 buttonPanel 位于 mainPanel 下方，而且我也不确定如何向 mainPanel 添加滚动条。任何帮助，将不胜感激。

**编辑：**我能够解决我关于 JPanel 的问题，现在我唯一的问题是我无法让我的 mainPanel 滚动。我在下面添加了我最近的代码：

这是我到目前为止的代码：

```
public static void main(String args[]) {

            JFrame frame = new JFrame("SpringLayout");
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            JScrollPane scroll = new JScrollPane();
            Container contentPane = frame.getContentPane();

           JButton next = new JButton("Next");
           JPanel buttonPanel = new JPanel();
           buttonPanel.add(next);
            SpringLayout layout = new SpringLayout();
            JPanel mainPanel = new JPanel();
            mainPanel.setLayout(layout);
            contentPane.setLayout(new BorderLayout());

            int j = 25;
            for(int i =0;i<150;i++){
                JLabel label = new JLabel("Enter Name " + i );
                JTextField text = new JTextField(15);

            mainPanel.add(label);
            mainPanel.add(text);
            layout.putConstraint(SpringLayout.WEST, label, 10, SpringLayout.WEST,
                            contentPane);
            layout.putConstraint(SpringLayout.NORTH, label, j, SpringLayout.NORTH,
                            contentPane);
            layout.putConstraint(SpringLayout.NORTH, text, j, SpringLayout.NORTH,
                            contentPane);
            layout.putConstraint(SpringLayout.WEST, text, 20, SpringLayout.EAST,
                            label);
            j+=30;
            }
            //mainPanel.setSize(500,800);
            scroll.setPreferredSize(new Dimension(500,500));
            scroll.setViewportView(mainPanel);
            contentPane.add(scroll);
            contentPane.add(buttonPanel,BorderLayout.SOUTH);
            //mainWindow.add(contentPane);
            frame.setSize(500, 600);
            frame.setVisible(true);

        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T15:08:44.183

为了使其可滚动，我只需要增加我的 mainPanel 的首选大小，使其比滚动条大。

```
 public static void main(String args[]) {
                JFrame frame = new JFrame("SpringLayout");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                JScrollPane scroll = new JScrollPane();
                Container contentPane = frame.getContentPane();

               JButton next = new JButton("Next");
               JPanel buttonPanel = new JPanel();
               buttonPanel.add(next);
                SpringLayout layout = new SpringLayout();
                JPanel mainPanel = new JPanel();
                mainPanel.setLayout(layout);
                contentPane.setLayout(new BorderLayout());

                int j = 25;
                for(int i =0;i<18;i++){
                    JLabel label = new JLabel("Enter Name " + i );
                    JTextField text = new JTextField(15);

                mainPanel.add(label);
                mainPanel.add(text);
                layout.putConstraint(SpringLayout.WEST, label, 10, SpringLayout.WEST,
                                contentPane);
                layout.putConstraint(SpringLayout.NORTH, label, j, SpringLayout.NORTH,
                                contentPane);
                layout.putConstraint(SpringLayout.NORTH, text, j, SpringLayout.NORTH,
                                contentPane);
                layout.putConstraint(SpringLayout.WEST, text, 20, SpringLayout.EAST,
                                label);
                j+=30;
                }
                mainPanel.setPreferredSize(new Dimension(mainPanel.getWidth(), 1500));
                scroll.setPreferredSize(new Dimension(500,500));
                scroll.setViewportView(mainPanel);
                contentPane.add(scroll);
                contentPane.add(buttonPanel,BorderLayout.SOUTH);
                //mainWindow.add(contentPane);
                frame.setSize(500, 600);
                frame.setVisible(true);
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T14:02:45.917

*   我无法发表评论，尝试比较

*   请注意，此时我不明白为什么`SpringLayout`并且`JFrame#pack()`没有基于 构建适当的 GUI `PreferredSize`，这看起来像（此时）我的问题

硬编码`JFrame.setSize()`而不是正确的代码`JFrame#pack()`

```
import java.awt.BorderLayout;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.SpringLayout;
import javax.swing.SwingUtilities;

public class Main {

    public Main() {
        JFrame frame = new JFrame("SpringLayout");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JButton next = new JButton("Next");
        JPanel buttonPanel = new JPanel();
        buttonPanel.add(next);
        SpringLayout layout = new SpringLayout();
        JPanel mainPanel = new JPanel();
        mainPanel.setLayout(layout);
        int j = 25;
        for (int i = 0; i < 5; i++) {
            JLabel label = new JLabel("Enter Name");
            JTextField text = new JTextField(15);
            layout.putConstraint(SpringLayout.WEST, label, 10, SpringLayout.WEST,
                    mainPanel);
            layout.putConstraint(SpringLayout.NORTH, label, j, SpringLayout.NORTH,
                    mainPanel);
            layout.putConstraint(SpringLayout.NORTH, text, j, SpringLayout.NORTH,
                    mainPanel);
            layout.putConstraint(SpringLayout.WEST, text, 20, SpringLayout.EAST,
                    label);
            j += 30;
            mainPanel.add(label);
            mainPanel.add(text);
        }
        frame.add(mainPanel, BorderLayout.CENTER);
        frame.add(buttonPanel, BorderLayout.SOUTH);
        frame.setSize(300, 300);
        frame.setVisible(true);
    }

    public static void main(String args[]) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                 Main mn = new Main();
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T14:01:56.450

我会这样做：

```
public static void main(String args[]) {
    JFrame frame = new JFrame("SpringLayout");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    Container contentPane = frame.getContentPane();

    JButton next = new JButton("Next");
    JPanel buttonPanel = new JPanel();
    buttonPanel.add(next);
    GridBagLayout layout = new GridBagLayout();
    JPanel mainPanel = new JPanel();
    mainPanel.setLayout(layout);
    contentPane.setLayout(new BorderLayout());

    GridBagConstraints gbc = new GridBagConstraints();

    int j = 25;
    for (int i = 0; i < 50; i++) {
        JLabel label = new JLabel("Enter Name (" + i + ")");
        JTextField text = new JTextField(15);

        gbc.gridx = 0;
        gbc.gridy = i;

        mainPanel.add(label, gbc);

        gbc.gridx = 1;
        mainPanel.add(text, gbc);
    }
    contentPane.add(new JScrollPane(mainPanel, JScrollPane.VERTICAL_SCROLLBAR_ALWAYS, JScrollPane.HORIZONTAL_SCROLLBAR_AS_NEEDED), BorderLayout.CENTER);
    contentPane.add(buttonPanel, BorderLayout.SOUTH);
    frame.setSize(500, 800);
    frame.setVisible(true);
} 
```

一些修改： * 使用 GridBagLayout 而不是 SpringLayout（只是因为我不知道 SpringLayout） * 将你的 mainPanel 包装在 JScrollPane 中

看起来和感觉与您的示例完全不同。GridBagConstraints 可以调整。

# asp.net-mvc - ICollection 中的对象未与模型一起传递给视图

> ID：13031649
> 
> 赞同：0
> 
> 时间：2012-10-23T13:34:10.090
> 
> 标签：asp.net-mvc, razor, ef-code-first

我正在尝试创建一个包含可以发表评论的新闻的网站。我一直在关注pluralsight.com 的指南，并且我已经按照信函指南中的内容进行了操作，但是当我在运行时调试并查看模型内部的内容时，不包括注释。

我的数据库类：

```
public class ProjectDB {
        public DbSet<ContentNode> ContentNodes{ get; set; }
        public DbSet<Comment> Comments { get; set; }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {

            base.OnModelCreating(modelBuilder);

            modelBuilder.Entity<ContentNode>()
                .Property(n => n.ID).HasColumnName("NodeID");
            modelBuilder.Entity<ContentNode>()
                .HasMany(node => node.Comments)
                .WithRequired(comment => comment.Node);
        }
} 
```

涉及的模型：

```
 public class ContentNode : Node
    {
        public ContentType ContentType { get; set; }
        public ContentCategory Category { get; set; }
        public ICollection<Comment> Comments { get; set; }

        public ContentNode()
        {
            Comments = new List<Comment>();
        }
    }

    public class Comment
    {
        public int ID { get; set; }
        public ContentNode Node { get; set; }
        public string Body { get; set; }
    } 
```

从数据库中提取新闻文章并将其发送到视图的控制器方法

```
[GET("frettir/{year}/{month}/{day}/{title}")]
public ActionResult GetArticle( int year, int month, int day, string title)
{
    var model = (from f in _db.ContentNodes
                 where f.dateCreated.Year == year &&
                       f.dateCreated.Month == month &&
                       f.dateCreated.Day == day &&
                       f.Title == title &&
                       f.ContentType.ID == 1
                 select f).Single();

    return View(model);
} 
```

最后是视图本身：

```
@model Project.Models.ContentNode

@{
    ViewBag.Title = "GetByID";
}

<h2>GetByID</h2>

<fieldset>
    <legend>News</legend>

    <div class="display-label">
         @Html.DisplayNameFor(model => model.Title)
    </div>
    <div class="display-field">
        @Html.DisplayFor(model => model.Title)
    </div>

    <div class="display-label">
         @Html.DisplayNameFor(model => model.Body)
    </div>
    <div class="display-field">
        @Html.DisplayFor(model => model.Body)
    </div>

    <div class="display-label">
         @Html.DisplayNameFor(model => model.dateCreated)
    </div>
    <div class="display-field">
        @Html.DisplayFor(model => model.dateCreated)
    </div>
</fieldset>
<p>
    @Html.ActionLink("Edit", "Edit", new { id=Model.ID }) |
    @Html.ActionLink("Back to List", "Index")
</p>

    @foreach (var item in Model.Comments)
    {
        @Html.Partial("_Comment",item)
    }

@Html.ActionLink("New comment", "Create", "Comment", new { NodeID = Model.ID }, null) 
```

我查看了示例，并且查看了视频指南十几次，看看我做错了什么。我想出的唯一解决方案是将 NodeContent 表与 Comments 表连接起来，并将其投影到另一个模型中，但据我所知，这不是必需的。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:48:20.160

```
var model = _db.ContentNodes
    .Include(f => f.Comments) // eager load the child collection
    .Single(f => f.dateCreated.Year == year 
         && f.dateCreated.Month == month
         && f.dateCreated.Day == day 
         && f.Title == title 
         && f.ContentType.Id == 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:40:04.740

这很可能是因为 Entity Framework 默认启用了延迟加载。您可以使用`First`方法而不是方法来明确强制查询运行`Single`：

```
var model = (from f in _db.ContentNodes
             where f.dateCreated.Year == year &&
                   f.dateCreated.Month == month &&
                   f.dateCreated.Day == day &&
                   f.Title == title &&
                   f.ContentType.ID == 1
             select f).First();
return View(model); 
```

# python - 仅保留列表列表中的 2 个重复项

> ID：13031655
> 
> 赞同：3
> 
> 时间：2012-10-23T13:34:22.970
> 
> 标签：python, list

我在 python 中有一个或多个列表，类似于以下内容：

```
[
['name1',value2],
['name2',value3],
['name3',value4],
['name4',value4],
['name5',value5],
['name6',value2],
['name7',value2],
['name8',value4]
] 
```

我想从“值”字段中删除列表中具有超过 2 个重复项的任何列表。结果列表如下所示：

```
[
['name1',value2],
['name2',value3],
['name3',value4],
['name4',value4],
['name5',value5],
['name6',value2]
] 
```

**编辑：**

我不认为这会是一个问题，所以为了一个明确的问题而保持简单，但我实际上有四个值，而不是每个内部列表中的两个。IE：

```
[
['name1',value2,'something','else'],
['name2',value3,'something','else'],
['name3',value4,'something','else'],
['name4',value4,'something','else'],
['name5',value5,'something','else'],
['name6',value2,'something','else']
] 
```

Ashwini Chaudhary 的回答完美，但只返回两个第一个元素，而不是全部四个......我没有添加完整的细节是我的错。学过的知识！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:53:55.873

这段代码可以解决问题：

```
from collections import defaultdict
def dup2(sequence):
    seen = defaultdict(int)
    for key, value in sequence:
        if seen[value] < 2:
            seen[value] += 1
            yield [key, value] 
```

`dup2`是一个生成器，因此它会在您遍历结果时处理列表：

```
for key, value in dup2(seq):
    # ... your code here 
```

要将结果作为普通列表获取，请使用`list`函数：

```
list(dup2(seq)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T14:21:37.667

如果顺序无关紧要：

```
In [14]: lis=[
['name1','value2','something','else'],
['name2','value3','something','else'],
['name3','value4','something','else'],
['name4','value4','something','else'],
['name5','value5','something','else'],
['name6','value2','something','else']
]

In [22]: dic={}

In [23]: for x in lis:
    dic.setdefault(x[1],[]).append([x[0]]+x[2:])
   ....:     
   ....:     

In [25]: dic
Out[25]: 
{'value2': [['name1', 'something', 'else'], ['name6', 'something', 'else']],
 'value3': [['name2', 'something', 'else']],
 'value4': [['name3', 'something', 'else'], ['name4', 'something', 'else']],
 'value5': [['name5', 'something', 'else']]}

In [27]: [[y[0]]+[x]+y[1:] for x in dic for y in dic[x][:2]]
Out[27]: 
[['name5', 'value5', 'something', 'else'],
 ['name3', 'value4', 'something', 'else'],
 ['name4', 'value4', 'something', 'else'],
 ['name2', 'value3', 'something', 'else'],
 ['name1', 'value2', 'something', 'else'],
 ['name6', 'value2', 'something', 'else']] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:56:30.713

```
from collections import defaultdict

list1 = [['name1','value2'],
         ['name2','value3'],
         ['name3','value4'],
         ['name4','value4'],
         ['name5','value5'],
         ['name6','value2'],
         ['name7','value2'],
         ['name8','value4']]

list2 = [['name1','value2'],
         ['name2','value3'],
         ['name3','value4'],
         ['name4','value4'],
         ['name5','value5'],
         ['name6','value2']]

d = defaultdict(list)
for name, value in list1:
    d[value].append(name)

list3 = [[name, value] for value, names in d.items() for name in names[:2]]

print(sorted(list3) == sorted(list2))  # True 
```

我确信有人会想出一个更好的解决方案来保持顺序并作为迭代器工作。

# visual-studio - MDX 参数 - SSRS

> ID：13031661
> 
> 赞同：1
> 
> 时间：2012-10-23T13:34:33.257
> 
> 标签：visual-studio, tsql, reporting-services, mdx, business-intelligence

```
Parameter Value (It’s Unique Name) = [Company].[Company Hierarchy].&[10] 

Parameter Label (It’s Name) = HQ 
```

我想输入“HQ”并为“[Company].[Company Hierarchy].&[10]”生成报告</p>

所以，基本上，我想在标签文本中输入类型并以某种方式进行转换，以便 ssrs 会生成与 MDX 格式匹配的值的报告 [dim].[hierarchy].&[member]

这有点难以解释，但我将如何设置参数以及如何将该参数用于数据集？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:44:13.083

可以`NameColumn`在`SSAS`. 如果您正确设置`Company`维度，您将能够通过其名称而不是通过其键来访问您的维度。

`[Company].[Company Hierarchy].`**&** `[10]` *（这是您使用键 10 获取维度的方式。键 10 是唯一的，仅返回一个成员）*

`[Company].[Company Hierarchy].[HQ]` *（这就是您获取维度及其名称的方式。在此示例中可能不是唯一的。请注意，我这次`[HQ]`不使用**& 。）***

# html - 使用 Watir 与 HTML 5 画布交互

> ID：13031665
> 
> 赞同：1
> 
> 时间：2012-10-23T13:34:52.863
> 
> 标签：html, canvas, watir

我正在尝试对依赖于画布的某些元素（主要是图形等）的 UI 进行自动化测试。我想要做的是以某种方式提取值，因为它们使用 Watir 在图表中显示给用户，问题是这些值仅显示在弹出窗口中，当用户将鼠标放在时添加到 html 中使用 gwt 代码在画布中绘制的图标。

使用 firefox，我可以看到 canvas 元素中的鼠标事件包含我想要的值（无需实际悬停 Java 代码绘制的图标），如果我能得到它们，我可以在 ruby​​ 脚本中解析它们。无论如何都可以触发事件并使用 watir 获取实际的事件详细信息或有效负载。

该代码位于公司防火墙后面，因此无法指向任何人，但例如说我有这个鼠标事件（在萤火控制台中）

```
mousemove clientX=400, clientY=230 
```

与当前目标

```
canvas#indicators-result.MULTI_INDICATORS_TABLE 
```

如果我点击它，我可以看到一个属性 d ，其中包含我要验证的值的二维数组。反正有没有得到这些信息

谢谢

# cocos2d-iphone - 从纹理图集中屏蔽精灵

> ID：13031666
> 
> 赞同：0
> 
> 时间：2012-10-23T13:34:58.620
> 
> 标签：cocos2d-iphone, opengl-es-2.0, shader

我需要屏蔽一个精灵。我遵循了本教程：[http://www.raywenderlich.com/4428/how-to-mask-a-sprite-with-cocos2d-2-0](http://www.raywenderlich.com/4428/how-to-mask-a-sprite-with-cocos2d-2-0)，但是问题是当我不是从单个 png 文件创建精灵时，而是从带有“initWithSpriteFrameName”方法的精灵表。

蒙版文件正在应用于大精灵表的纹理，而不是小精灵的纹理。

任何线索我该如何解决这个问题？

干杯，马尔辛

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T16:01:47.980

这里的问题是相同的tex坐标被用于你的精灵和你的面具。

您需要为每个顶点再发送两个 UV 坐标，这适合您在地图集中的蒙版。

为这些掩码坐标创建另一个变量 v_maskTexCoord，然后在其中执行此操作：

```
vec4 texColor = texture2D(u_texture, v_texCoord);
vec4 maskColor = texture2D(u_mask, v_texCoord); 
```

将其更改为

```
vec4 texColor = texture2D(u_texture, v_texCoord);
vec4 maskColor = texture2D(u_mask, v_maskTexCoord); 
```

# linux - Linux在csv中用$替换^M$

> ID：13031670
> 
> 赞同：0
> 
> 时间：2012-10-23T13:35:06.587
> 
> 标签：linux, csv, line-endings

我从 ftp 服务器收到了一个 csv 文件，我正在将其摄取到表中。在摄取文件时，我收到错误“文件是被截断的文件”

实际原因是文件中的数据在行尾包含 $ 和 ^M$。例如：

ACT_RUN_TM、PROG_RUN_TM、US_HE_DT* *^M$* * "CONFIRMED","","3600" **$**

如何使用 linux 命令从行尾删除这些 $ 和 ^M$。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T14:10:12.347

最终正确的解决方案是以文本模式而不是二进制模式从 FTP 服务器传输文件，这会为您进行适当的行尾转换。更改您的下载脚本或 FTP 应用程序配置以启用文本传输以在将来解决此问题。

假设这是一次性传输并且您已经下载了文件并且只想修复它，您可以使用 tr(1) 来翻译字符。因此，要从文件中删除*所有*control-M 字符，您可以通过`tr -d '\r'`. 或者，如果你想用 control-J 替换它们——例如，如果文件来自预 OSX Mac 系统，你会这样做——做`tr '\r' '\n'`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:44:25.100

看到 ^M 不是最后一个字符很奇怪，但是：

> sed -e 's/^M*\$$//g' <坏文件>好文件

或使用“sed -i”就地更新。（注意，“^M”是在命令行中按 键输入的`CTRL-V CTRL_M`）。

**更新：** 已确定问题是错误的，因为“^M$”**不在**文件中，而是与 VI 一起显示。他实际上想将 CRLF 对更改为 LF。

> sed -e 's/^M$//g' <坏文件>好文件

# service - OAuth 2.0 和 SAML - 细粒度授权

> ID：13031680
> 
> 赞同：2
> 
> 时间：2012-10-23T13:35:36.130
> 
> 标签：service, oauth, authorization, token, saml

在 OAuth 2.0 设置中，假设除了 OAuth 授权（可选地使用 OAuth 范围）之外，您希望资源服务器使用 SAML 断言来实现细粒度的授权检查，例如，仅当“消费者”持有“金”的地位。

1) OAuth 访问令牌是否可以“传达”SAML 2 断言？如何？

2）如果没有，有没有办法同时使用 Oauth 和 SAML 2 来获得类似的结果？

3）有没有办法自己使用 OAuth（没有 SAML）来获得类似的结果？

请注意，我知道您可以在*获取令牌*时使用 SAML 断言作为用户凭证，但这里的要点不同：需要的是在访问资源时使用 SAML 断言，即*使用令牌*时。

# html - 而不是 在 Visual Studio 中

> ID：13031694
> 
> 赞同：6
> 
> 时间：2012-10-23T13:36:21.773
> 
> 标签：html, visual-studio-2010, visual-studio, xhtml

我使用 Visual Studio 来教授 HTML。我们使用 HTML 4.01 过渡。Visual Studio 默认使用 XHTML 1.0，我需要解决一个问题，这两个 HTML 标准之间的典型区别是：每当我们输入`<br>`or`<hr>`时，它会自动分别更改为`<br />`or `<hr />`。这对 XHTML 非常有用，但在 HTML 4.01 模式下工作时不需要。

那么**如何关闭这个自动功能呢？**我们主要使用 Visual Studio 2010，有时也使用 2012 和 2008。

（我知道如何轻松地将验证切换到 HTMl 4.01 模式，但它仍然在每个`<br>`.`<hr>`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-23T13:38:34.140

```
Tools -> Options -> Text Editor -> HTML -> Formatting -> Tag Specific Options 
```

您可以为每个单独的标签定义行为。点击`CTRL + K + D`重新格式化文档，您应该会看到更改。

## 特定标签

![在此处输入图像描述](../Images/970858e96774774db1efaf2dd9f163b7.png)

## 替代方法（所有标签）

![在此处输入图像描述](../Images/048429b83ffa55d38a62f1dc409b767c.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-14T17:29:53.300

老问题，但今天更相关。

在 Visual Studio 2015 中，工具、选项：

[![工具 |  Visual Studio 2015 中的选项](../Images/4ce848da4441729adc7473fb528f6838.png)](https://i.stack.imgur.com/tc7cN.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:39:49.797

```
Tool -> Options -> Text Editor -> HTML -> Format -> Tag Specific Options... -> Client HTML Tags -> br 
```

# zend-framework - 在 dev 上获取 zend 应用程序

> ID：13031695
> 
> 赞同：0
> 
> 时间：2012-10-23T13:36:22.047
> 
> 标签：zend-framework, config, propel

有一个使用 zend+propel 开发并托管在生产服务器上的 Web 应用程序（debian 挤压）。我需要在我的本地电脑上复制这个应用程序（这是一个 Windows 7 + wamp）。

我在 httpd.conf 中添加了一个虚拟主机：

```
<VirtualHost *:8083>
  DocumentRoot "c:/wamp/www/myapp/public"
  <Directory "c:/wamp/www/myapp/public">
      Options All
      AllowOverride All
      Allow from all
  </Directory>
</VirtualHost> 
```

当我在浏览器上打开开发应用程序时，我得到以下结果：

```
doctype() ?> headTitle(); ?> headMeta(); ?> headStyle(); ?> headLink(); ?> headScript(); ?>
render('menu.phtml') ?>
render('session.phtml') ?> 
```

我使用 xdebug 来尝试查找问题。但是当我在 IndexController 的 indexAction 中设置断点时，它并没有被调试器命中。

我在旁边创建了一个示例 zend 应用程序，我可以让它工作。现在我不知道发生了什么...

有禅师救我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T15:10:06.860

您需要`short_open_tag`在 PHP 配置中启用。见[http://www.php.net/manual/en/ini.core.php#ini.short-open-tag](http://www.php.net/manual/en/ini.core.php#ini.short-open-tag)

此配置选项允许`<?=`作为 . 的简写`<?php echo`，例如`<?=$this->headTitle()?>`. 目前，您模板中的这些语句正在呈现为文本。

# objective-c - 为什么苹果使用 NSOrderedSet 而不是 NSArray 来处理 CoreData 中的有序多值关系？

> ID：13031704
> 
> 赞同：23
> 
> 时间：2012-10-23T13:36:42.037
> 
> 标签：objective-c, xcode, core-data

在核心数据中，如果我们有多值关系，比如当一个业务可以有多个关键字时，在子类 NSManagedObject 生成器中，Apple 会使用 NSOrderedSet 而不是 NSArray。

它们几乎相等，只是在 NSOrderedSet 中检查所有权稍快一些。

为什么 Apple 不使用更为熟悉和著名的 NSArray 的任何原因？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-10-23T13:46:35.720

我的猜测是：因为`NSOrderedSet`管理*不同*元素的集合，类似于`NSSet`无序关系。

您可以创建一个与`NSArray`另一个对象多次相关的对象。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-23T13:51:39.887

从[文档](http://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSOrderedSet_Class/Reference/Reference.html)：

> 当元素的顺序很重要并且测试对象是否包含在集合中的性能是一个考虑因素时，您可以使用有序集合作为数组的替代方案——测试数组的成员资格比测试集合的成员资格慢。

# python - 由 Python 脚本在 Windows XP 上创建的文件名中的错误编码

> ID：13031705
> 
> 赞同：3
> 
> 时间：2012-10-23T13:36:44.833
> 
> 标签：python, windows, unicode, encoding, utf-8

我的 Python 脚本在 Windows XP 下创建了一个 xml 文件，但该文件没有使用西班牙字符（如“ñ”或一些重音字母）进行正确编码。

首先，使用以下代码从 excel shell 中读取文件名，我用它来读取 Excel 文件 xlrd 库：

```
filename = excelsheet.cell_value(rowx=first_row, colx=5) 
```

然后，我尝试了一些编码，但没有成功生成具有正确编码的文件：

```
filename = filename[:-1].encode("utf-8")
filename = filename[:-1].encode("latin1")
filename = filename[:-1].encode("windows-1252") 
```

使用“windows-1252”我得到了一个错误的编码，带有字母“ñ”、“í”和“é”。例如，我得到了*BAJO ARAGÓN_AlcaÃ±iz.xml*而不是*BAJO ARAGÓN_Alcañiz.xml*

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T16:39:58.163

您应该使用 unicode 字符串作为文件名。通常操作系统支持包含任意 Unicode 字符的文件名。所以如果你这样做：

```
fn = u'ma\u00d1o'  # maÑo
f = open(fn, "w")
f.close()
f = open(fn, "r")
f.close() 
```

它应该工作得很好。不同的是，当您列出该文件所在目录的内容时，您在终端中看到的内容。如果终端的编码是 UTF-8，你会看到文件名 maño，但如果编码是 iso-8859-1，你会看到 maÃo。但是即使您看到这些奇怪的字符，您也应该能够如上所述从 python 打开文件。

总之，不要编码的输出

```
filename = excelsheet.cell_value(rowx=first_row, colx=5) 
```

而是确保它是一个 unicode 字符串。

阅读[Python Unicode HOWTO的](http://docs.python.org/howto/unicode.html)*Unicode 文件名*部分会对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T08:37:13.630

尝试你的答案我找到了一个快速的解决方案，从 Python 2.7 到 Python 3.3 移植我的脚本，移植我的代码的原因是 Python 3 默认以 Unicode 工作。

我不得不对我的代码做一些小改动，导入 xlrd 库（以前我必须安装 xlrd3）：

```
import xlrd3 as xlrd 
```

此外，我必须使用 str 而不是 encode() 将内容从“字节”转换为“字符串”

```
filename = str(filename[:-1]) 
```

现在，我的脚本完美运行，并且在 Windows XP 上生成了没有奇怪字符的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T16:39:35.230

首先，如果您还没有，请阅读[http://www.joelonsoftware.com/articles/Unicode.html](http://www.joelonsoftware.com/articles/Unicode.html) -

现在，“latin-1”应该适用于 Windows 下的西班牙语编码 - 有两个假设：您尝试“编码”为任一编码的字符串不是 Unicdoe 字符串，但已经在某些编码中。然而，与奇怪的字符相比，它更有可能给你一个 UnicodeDecodeError ，但它可能在某些极端情况下工作。

更有可能的情况是您正在使用 windows Prompt AKA 'CMD" 检查文件 - 嗯，出于某种原因，Microsoft Windows 确实为系统使用*了两种*不同的编码 - 一种来自“本机”windows程序内部 - 这应该是兼容的使用latin1，另一个用于遗留DOS程序，它将命令提示符放在哪个类别中。对于葡萄牙语，第二个编码是“cp852”（环顾四周，cp852没有定义“ñ” - 但cp850有）。

所以，会发生这种情况：

```
>>> print u"Aña".encode("latin1").decode("cp850")
A±a
>>> 
```

因此，如果您希望文件名在 DOS 提示符下正确显示，您应该使用“CP850”对它们进行编码 - 如果您希望它们在 Windows 程序中看起来正确，请使用“cp1252”（或“latin1”或“iso -8859-15" - 它们几乎相同，给出或采用“€”符号）

当然，不要试图猜测并选择一个看起来不错的，如果有人在挪威、俄罗斯或 a Posix 系统中运行你的程序就会失败，你应该这样做

```
import sys
encoding = sys.getfilesystemencoding() 
```

（这应该为您返回上述之一 - 再次，如果从 Windows 程序而不是 DOS shell 看起来文件名看起来正确）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T17:41:03.930

在 Windows 中，文件系统使用 UTF-16，因此不需要显式编码。只需使用 Unicode 字符串作为文件名，并确保声明*源文件*的编码。

```
# coding: utf8
with open(u'BAJO ARAGÓN_Alcañiz.xml','w') as f:
    f.write('test') 
```

此外，即使我的美国 Windows 系统`Ó`的编码不支持`cp437`，我的控制台*字体*也支持该字符，并且它仍然可以在我的控制台上正确显示。控制台支持 Unicode，但非 Unicode 程序只能读/写代码页字符。

# xslt - 如何使用 XSLT 删除根节点？

> ID：13031709
> 
> 赞同：1
> 
> 时间：2012-10-23T13:37:00.787
> 
> 标签：xslt

> 输入文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<ns0:root xmlns:ns0="http://xyz.com/separate">
    <ns0:root1>
        <ns3:Detail xmlns:ns3="http://POProject/Details">
        <DetailLines>
                <ItemID>
                <ItemDescription/>
            </DetailLines>
        </ns3:Detail>
    </ns0:root1>
</ns0:root> 
```

> 输出文件：

```
<?xml version="1.0" encoding="UTF-8"?>
        <ns0:Detail xmlns:ns0="http://POProject/Details">
        <DetailLines>
                <ItemID>
                <ItemDescription/>
            </DetailLines>
        </ns0:Detail> 
```

> 问题：我必须删除 root1 和 root 节点，并且需要在 Detail 节点中做一些小的改动。如何编写 xslt 代码来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T15:49:04.720

**这...**

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:ns0="http://xyz.com/separate"
  xmlns:ns3="http://POProject/Details">
<xsl:output method="xml" indent="yes"/>
<xsl:strip-space elements="*" />

<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
  </xsl:copy>
</xsl:template>

<xsl:template match="/">
  <xsl:apply-templates select="*/*/ns3:Detail" />
</xsl:template>

<xsl:template match="ns3:Detail">
  <xsl:apply-templates select="." mode="copy-sans-namespace" />
</xsl:template>

<xsl:template match="*" mode="copy-sans-namespace">
  <xsl:element name="{name()}" namespace="{namespace-uri()}">
    <xsl:copy-of select="@*"/>
    <xsl:apply-templates mode="copy-sans-namespace" />
  </xsl:element>
</xsl:template>

</xsl:stylesheet> 
```

**...会产生这个...**

```
<?xml version="1.0" encoding="utf-8"?>
<ns3:Detail xmlns:ns3="http://POProject/Details">
  <DetailLines>
    <ItemID />
    <ItemDescription />
  </DetailLines>
</ns3:Detail> 
```

我不确定是否可以控制前缀。XDM 数据模型不认为它是重要信息。

* * *

## UDPATE

要获得前缀重命名，我认为您必须使用支持 XML 1.1 的 XSLT 处理器（允许前缀未定义），但我找到了一种使用 XML 1.0 的方法。试试这个 ...

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:ns0="http://xyz.com/separate">
<xsl:output method="xml" indent="yes"/>
<xsl:strip-space elements="*" />

<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
  </xsl:copy>
</xsl:template>

<xsl:template match="/" xmlns:ns3="http://POProject/Details">
  <xsl:apply-templates select="*/*/ns3:Detail" />
</xsl:template>

<xsl:template match="ns0:Detail" xmlns:ns0="http://POProject/Details">
  <ns0:Detail xmlns:ns0="http://POProject/Details">
    <xsl:apply-templates select="*" mode="copy-sans-namespace" />
  </ns0:Detail>  
</xsl:template>

<xsl:template match="*" mode="copy-sans-namespace">
  <xsl:element name="{name()}" namespace="{namespace-uri()}">
    <xsl:copy-of select="@*"/>
    <xsl:apply-templates mode="copy-sans-namespace" />
  </xsl:element>
</xsl:template>

</xsl:stylesheet> 
```

# php - Joomla 3.0 的 db->loadObjectList() 可能存在问题

> ID：13031710
> 
> 赞同：1
> 
> 时间：2012-10-23T13:37:01.930
> 
> 标签：php, mysql, joomla, joomla3.0

我们开发了一个可以在 Joomla 1.5 和 2.5 上正常工作的喊话箱。我通过更改 XML 中的版本和其他一些位 n bobs 使其与 Joomla 3.0 兼容。

当我尝试加载分配了喊话框模块的页面时，我收到以下错误消息：

```
Notice: Trying to get property of non-object in C:\wamp\www\XXX\libraries\legacy\module\helper.php on line 150

Notice: Undefined property: stdClass::$content in C:\wamp\www\XXX\templates\system\html\modules.php on line 17 
```

我将其缩小到导致问题的一行，即：

```
$rows = $db->loadObjectList(); 
```

此行来自以下用于检索喊声的函数：

```
function getShouts($number, $timezone, $message) {
    global $mainframe;
    $shouts = array();
    $db =& JFactory::getDBO();
    $query = 'SELECT * FROM #__shoutbox ORDER BY id DESC';
    $db->setQuery($query , 0 , $number);
    $rows = $db->loadObjectList();
    $i=0;
    $timezone=$timezone*60*60;
    foreach ( $rows as $row ) {
        $shouts[$i]->id = $row->id;
        $shouts[$i]->name = $row->name;
        $adjustedtime = strtotime($row->when) + $timezone;
        $shouts[$i]->when = date( 'Y-m-d H:i:s', $adjustedtime);
        $shouts[$i]->ip = $row->ip;
        $shouts[$i]->msg = $row->msg;
        $i++;
    }
    return $shouts;
} 
```

老实说，我不知道为什么会出现这两个错误，因为它们的模块在以前的 Joomla 版本中运行良好。我尝试使用不同的方法来获得呼喊声，但没有任何效果。

有没有人知道为什么会发生这种情况并有解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T17:15:34.430

我不知道它在 2.5 中如何为您工作，但您需要 [http://www.theartofjoomla.com/home/9-developer/135-database-upgrades-in-joomla-16.html](http://www.theartofjoomla.com/home/9-developer/135-database-upgrades-in-joomla-16.html) $query = $db- >getQuery(真);

而且你不应该在这里使用 & $db =& JFactory::getDBO(); 因为对象总是通过引用传递。

# mysql - 计算列 MySQL 中的唯一数字

> ID：13031711
> 
> 赞同：0
> 
> 时间：2012-10-23T13:37:05.247
> 
> 标签：mysql, sql

我有一个查询以下列格式返回数据：

```
id | name | number
 1   John    12545
 1   John    50496
 2   Mary    23443
 3   Mark    54
 3   Mark    5600
 3   Mark    50206 
```

我想找出`ids`结果集中出现的不同数量。例如，对于上面的结果。我想获得值 3。

有没有办法添加一列，所以结果看起来像这样？

```
count | id | name | number
 3      1   John    12545
 3      1   John    50496
 3      2   Mary    23443
 3      3   Mark    54
 3      3   Mark    5600
 3      3   Mark    50206 
```

我的查询是：

```
 SELECT * FROM (
    SELECT id FROM tableA
    WHERE xyz
 ) as t1
 JOIN tableB using (id) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T13:38:33.740

```
SELECT (SELECT COUNT(DISTINCT id) FROM tableName) totalCount,
       id,name,number
FROM tableName 
```

或通过使用`CROSS JOIN`

```
SELECT x.totalCount,
       a.id, a.name, a.number
FROM tableName a, (SELECT COUNT(DISTINCT id) totalCount 
                   FROM tableName) x 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:44:02.157

```
SELECT COUNT(id) AS count , id, name, number 
FROM 
( 
    SELECT id 
    FROM tableA 
    WHERE xyz 
) as t1 
JOIN tableB using (id)
GROUP BY id, name, number 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:40:06.370

你应该试试 ：

`SELECT id,name,number, (SELECT COUNT(DISTINCT name) FROM YourTableName) FROM YourTableName`

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T13:40:14.857

`SELECT COUNT(DISTINCT id)`会比使用 column 更快`name`。

```
SELECT (SELECT COUNT(DISTINCT id) FROM tableName) as 'count',
        id,name,number  
FROM tableName 
```

# java - 有什么方法可以获取联系人应用程序的图标？

> ID：13031714
> 
> 赞同：3
> 
> 时间：2012-10-23T13:37:15.230
> 
> 标签：java, android, icons, contacts

在 android rom 之间，联系人应用程序的徽标可能不同（例如，三星设备的联系人图标与 HTC 设备不同）。有没有办法以编程方式获取这个图标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:40:47.183

```
private Drawable getIconFromPackageName(final String packageName) {
        PackageManager packageManager = getPackageManager();
        try {
            Drawable icon = packageManager.getApplicationIcon(packageName);
            return icon;
        } catch (NameNotFoundException e) {
            Toast toast = Toast.makeText(this, "error in getting icon", Toast.LENGTH_SHORT);
            toast.show();
            e.printStackTrace();
        }
        return null;
} 
```

`Drawable`如果存在，这将返回具有指定包名称图标的对象，`null`否则返回。

# ios - UIAutomation 获取视图

> ID：13031716
> 
> 赞同：3
> 
> 时间：2012-10-23T13:37:25.763
> 
> 标签：ios, ui-automation, ios-ui-automation

我正在玩 UIAutomation，但我无法引用视图...

这是日志，其中视图可见： main_view

```
UIAApplication: name:MyProjectDemo rect:{{0, 0}, {1024, 768}}
UIAWindow: rect:{{0, 0}, {1024, 768}}
UIAElement: name:main_view rect:{{0, 0}, {1024, 768}} 
```

我如何引用它并获取他们的子视图？

```
target = UIATarget.localTarget();
app = target.frontMostApp();
app.logElementTree();
mainWindow = app.mainWindow();

var view = mainWindow.views()["main_view"]; // doesn't work => undefined
var view = mainWindow.views()[0]; // doesn't work  => undefined 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T06:17:21.250

从元素树可见，它不是 a `UIAView` 所以你必须将它称为 `mainWindow.elements()["main_view"]` .

# python - python - 从文件中读取几列

> ID：13031719
> 
> 赞同：1
> 
> 时间：2012-10-23T13:37:54.333
> 
> 标签：python, python-2.7

这是从[这个问题](https://stackoverflow.com/questions/13017130/gnuplot-histogram-with-histeps-connects-bars/13021876#comment17689622_13021876)衍生而来的。在那一个中​​，以下行出现在`python`脚本中：

```
c1,c2 = [float(x) for x in line.split()] #convert line into 2 floats and unpack 
```

读取具有两列的数据文件时。

现在，我**的真实**数据文件有 31 列，我需要使用第 28 列和第 31 列而不是第 1 列和第 2 列。当我尝试升级该行时最简单（也是最丑陋）的方法时：

```
c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17,c18,c19,c20,c21,c22,c23,c24,c25,c26,c27,c28,c29,c30,c31 = [float(x) for x in line.split()] 
```

我得到错误：

```
ValueError: too many values to unpack 
```

如何正确读取文件中的所有列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:45:43.930

另一种方法：

```
cols = [float(x) for x in line.split()]
c28, c31 = cols[27], cols[30] 
```

因此，整体设置将如下所示：

```
with open('<file name here>') as source_file:
    for line in source_file:
        cols = [float(x) for x in line.split()]
        c28, c31 = cols[27], cols[30] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:41:23.117

```
cols = [float(x) for x in line.split()]
for i in len(cols):
    print i, cols[i] 
```

无需实例化 N 个变量，只需在读取文件时使用您拥有的数组

在这种情况下，for 循环可以帮助您查看您真正拥有多少值

# c++ - 多线程程序生产者/消费者 [boost]

> ID：13031720
> 
> 赞同：0
> 
> 时间：2012-10-23T13:37:57.563
> 
> 标签：c++, multithreading, boost-thread, boost-mutex

我正在玩boost库和C++。我想创建一个包含生产者、消费者和堆栈的多线程程序。生产者填充堆栈，消费者从堆栈中删除项目（int）。一切正常（pop，push，mutex）但是当我在线程中调用pop/push时，我没有任何效果

我做了这个简单的代码：

```
#include "stdafx.h"
#include <stack>
#include <iostream>
#include <algorithm>
#include <boost/shared_ptr.hpp>
#include <boost/thread.hpp>
#include <boost/date_time.hpp> 
#include <boost/signals2/mutex.hpp>
#include <ctime>

using namespace std;

/ *
* this class reprents a stack which is proteced by mutex
* Pop and push are executed by one thread each time.
*/
class ProtectedStack{
private : 
stack<int> m_Stack;
boost::signals2::mutex m;

public : 
ProtectedStack(){
}
ProtectedStack(const ProtectedStack & p){

}
void push(int x){
    m.lock();
    m_Stack.push(x);
    m.unlock();
}

void pop(){
    m.lock();
    //return m_Stack.top();
    if(!m_Stack.empty())
        m_Stack.pop();
    m.unlock(); 
}
int size(){
    return m_Stack.size();
}
bool isEmpty(){
    return m_Stack.empty();
}
int top(){
    return m_Stack.top();
}
};

/*
*The producer is the class that fills the stack. It encapsulate the thread object 
*/

class Producer{
public:
Producer(int number ){
    //create thread here but don't start here
m_Number=number;

}
void fillStack (ProtectedStack& s ) {
    int object = 3; //random value
    s.push(object);
    //cout<<"push object\n";
}

void produce (ProtectedStack & s){
    //call fill within a thread 
    m_Thread = boost::thread(&Producer::fillStack,this, s);  
}

 private :
int m_Number;
boost::thread m_Thread;

};

/* The consumer will consume the products produced by the producer */ 

class Consumer {
private : 
int m_Number;
boost::thread m_Thread;
public:
Consumer(int n){
    m_Number = n;
}

void remove(ProtectedStack &s ) {

     if(s.isEmpty()){ // if the stack is empty sleep and wait for the producer      to fill the stack
        //cout<<"stack is empty\n";
        boost::posix_time::seconds workTime(1); 
        boost::this_thread::sleep(workTime);
     }
     else{
        s.pop(); //pop it
        //cout<<"pop object\n";

     }

}

void consume (ProtectedStack & s){
    //call remove within a thread 
    m_Thread = boost::thread(&Consumer::remove, this, s);  
}

};

int main(int argc, char* argv[])  
{  

ProtectedStack s;

    Producer p(0);
    p.produce(s);

    Producer p2(1);
    p2.produce(s);

    cout<<"size after production "<<s.size()<<endl;
    Consumer c(0);
    c.consume(s);
    Consumer c2(1);
    c2.consume(s);
    cout<<"size after consumption  "<<s.size()<<endl;

getchar();
return 0;  
} 
```

在我在 VC++ 2010 / win7 中运行它之后，我得到：0 0

你能帮我理解为什么当我从 main 调用 fillStack 函数时我得到了效果，但是当我从线程调用它时没有任何反应？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T19:30:16.000

正如其他人所指出的，您的示例代码存在几个同步问题：

*   对 ProtectedStack 的某些成员的调用缺少锁。
*   主线程可以退出而不允许工作线程加入。
*   生产者和消费者不会像您期望的那样循环。生产者应该总是（当他们可以）生产，消费者应该在新元素被推入堆栈时继续消费。
*   主线程上的 cout 很可能在生产者或消费者有机会工作之前执行。

我建议考虑使用条件变量在生产者和消费者之间进行同步。在此处查看生产者/消费者示例：http: [//en.cppreference.com/w/cpp/thread/condition_variable](http://en.cppreference.com/w/cpp/thread/condition_variable) 这是 C++11 标准库中的一个相当新的功能，并且从 VS2012 开始支持。在 VS2012 之前，您需要 boost 或使用 Win32 调用。

使用条件变量来解决生产者/消费者问题很好，因为它几乎强制使用互斥锁来锁定共享数据，并且它提供了一种信号机制让消费者知道某些东西已经准备好被消费，所以他们没有那么自旋（这始终是消费者的响应能力和轮询队列的 CPU 使用率之间的权衡）。它本身也是原子的，可以防止线程丢失信号的可能性，如这里解释的那样：[https ://en.wikipedia.org/wiki/Sleeping_barber_problem](https://en.wikipedia.org/wiki/Sleeping_barber_problem)

简要介绍条件变量如何处理此问题...

*   生产者在不拥有互斥锁的情况下在其线程上执行所有耗时的活动。
*   生产者锁定互斥体，将它产生的项目添加到全局数据结构（可能是某种队列），释放互斥体并发出信号通知单个消费者去 - 按那个顺序。
*   等待条件变量的消费者自动重新获取互斥锁，将项目从队列中移除并对其进行一些处理。在此期间，生产者已经在生产一个新项目，但必须等到消费者完成后才能将项目排队。

这将对您的代码产生以下影响：

*   不再需要 ProtectedStack，一个普通的堆栈/队列数据结构就可以了。
*   如果您使用的是足够新的编译器，则无需提升 - 删除构建依赖项总是一件好事。

我觉得线程对您来说相当新，所以我只能提供建议，看看其他人如何解决同步问题，因为很难让您全神贯注。对具有多线程和共享数据的环境中发生的事情感到困惑通常会导致诸如死锁之类的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T15:49:27.670

您的代码的主要问题是您的线程不同步。请记住，默认情况下，线程执行不是有序的，也不是有序的，因此消费者线程实际上可以（并且在您的特定情况下）在任何生产者线程产生任何数据**之前完成。**

为了确保消费者在生产者完成工作后运行，您需要`thread::join()`在生产者线程上使用函数，它将停止主线程执行，直到生产者退出：

```
// Start producers
...

p.m_Thread.join();  // Wait p to complete
p2.m_Thread.join(); // Wait p2 to complete

// Start consumers
... 
```

这可以解决问题，但这可能对典型的生产者-消费者用例不利。

要实现更有用的案例，您需要修复消费者功能。您的消费者函数实际上不会等待生成的数据，如果堆栈为空，它将退出，如果尚未生成数据，则永远不会消耗任何数据。

应该是这样的：

```
void remove(ProtectedStack &s)
{
   // Place your actual exit condition here,
   // e.g. count of consumed elements or some event
   // raised by producers meaning no more data available etc.
   // For testing/educational purpose it can be just while(true)
   while(!_some_exit_condition_)
   {
      if(s.isEmpty())
      {
          // Second sleeping is too big, use milliseconds instead
          boost::posix_time::milliseconds workTime(1); 
          boost::this_thread::sleep(workTime);               
      }               
      else
      {
         s.pop();
      }
   }
} 
```

另一个问题是错误的`thread`构造函数用法：

```
m_Thread = boost::thread(&Producer::fillStack, this, s); 
```

引用自[Boost.Thread 文档](http://www.boost.org/doc/libs/1_51_0/doc/html/thread/thread_management.html#thread.thread_management.thread.multiple_argument_constructor)：

> 带参数的线程构造函数
> 
> `template <class F,class A1,class A2,...>` `thread(F f,A1 a1,A2 a2,...);`
> 
> 前提条件： `F`并且每一个都`An`必须是可复制的或可移动的。
> 
> 效果：好像`thread(boost::bind(f,a1,a2,...))`。因此，**f 和每个 an 都被复制到内部存储中，以供新线程访问**。

这意味着您的每个线程都会收到自己的副本，`s`并且所有修改都不会应用于`s`本地线程副本。当您按值将对象传递给函数参数时，情况也是如此。您需要`s`通过引用传递对象 - 使用`boost::ref`：

```
void produce(ProtectedStack& s)
{
   m_Thread = boost::thread(&Producer::fillStack, this, boost::ref(s));
}

void consume(ProtectedStack& s)
{
   m_Thread = boost::thread(&Consumer::remove, this, boost::ref(s));
} 
```

另一个问题是关于您的互斥锁的使用。这不是最好的。

1.  为什么使用 Signals2 库中的互斥锁？只需[`boost::mutex`](http://www.boost.org/doc/libs/1_51_0/doc/html/thread/synchronization.html#thread.synchronization.mutex_types.mutex)从 Boost.Thread 使用并删除对 Signals2 库的不需要的依赖。

2.  使用 RAII 包装器[`boost::lock_guard`](http://www.boost.org/doc/libs/1_51_0/doc/html/thread/synchronization.html#thread.synchronization.locks.lock_guard)而不是直接`lock/unlock`调用。

3.  正如其他人所提到的，您应该锁定所有成员`ProtectedStack`。

样本：

```
boost::mutex m;

void push(int x)
{ 
   boost::lock_guard<boost::mutex> lock(m);
   m_Stack.push(x);
} 

void pop()
{
   boost::lock_guard<boost::mutex> lock(m);
   if(!m_Stack.empty()) m_Stack.pop();
}              

int size()
{
   boost::lock_guard<boost::mutex> lock(m);
   return m_Stack.size();
}

bool isEmpty()
{
   boost::lock_guard<boost::mutex> lock(m);
   return m_Stack.empty();
}

int top()
{
   boost::lock_guard<boost::mutex> lock(m);
   return m_Stack.top();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-23T13:48:25.953

在尝试使用之前，您没有检查生产线程是否已执行。你也没有锁定大小/空/顶部......如果容器正在更新，那是不安全的。

# python - 列表编号的 bij 顺序的每个条目

> ID：13031721
> 
> 赞同：0
> 
> 时间：2012-10-23T13:38:00.713
> 
> 标签：python, list

我正在尝试按顺序对列表中的所有条目进行编号，我的脚本是：

```
 for item in klantgegevens:
       teller = (number, item)
       number = number + 1
       print teller 
```

klantgegevens：

```
(['Cautus B.V. Zei 9-11', 'Cautus B.V.', '1', '2', '', '', '', '', '', ' Zei 9-11', '1009023', '10', 'Geachte Daa', 'Mevrouw Daa', 'chaa.c2000@planet.nl']) 
(['Cautus B.V. 32', 'Cautus B.V.', '1', '2', '', '', '', '', '', 'Trias 92', '1109008', '10', 'Geachte mevrouw Daa', 'Mevrouw Daa', 'chaa.c2100@planet.nl']) 
```

我希望我的输出是：

```
 (0, ['Cautus B.V. Zei 9-11', 'Cautus B.V.', '1', '2', '', '', '', '', '', ' Zei 9-11', '1009023', '10', 'Geachte Daa', 'Mevrouw Daa', 'chaa.c2000@planet.nl']) 
    (1, ['Cautus B.V. 32', 'Cautus B.V.', '1', '2', '', '', '', '', '', 'Trias 92', '1109008', '10', 'Geachte mevrouw Daa', 'Mevrouw Daa', 'chaa.c2100@planet.nl'])
     2 .....
     3 .....
     4 .... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:40:36.700

您正在寻找内置[`enumerate`](http://docs.python.org/library/functions.html#enumerate)函数。似乎您有一个包含一个元素的列表，该元素是列表列表，因此您必须调用`enumerate`这个元素（列表列表）：

```
for teller in enumerate(klantgegevens[0]):
    print teller 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:40:17.430

在这里使用`enumerate()`：

```
In [229]: klantgegevens=[['Cautus B.V. Zei 9-11', 'Cautus B.V.', '1', '2', '', '', '', '', '', ' Zei 9-11', '1009023', '10', 'Geachte Daa', 'Mevrouw Daa', 'chaa.c2000@planet.nl'],
['Cautus B.V. 32', 'Cautus B.V.', '1', '2', '', '', '', '', '', 'Trias 92', '1109008', '10', 'Geachte mevrouw Daa', 'Mevrouw Daa', 'chaa.c2100@planet.nl']]

In [231]: for i,x in enumerate(klantgegevens):
   .....:     print (i,x)
   .....:     
   .....:     
(0, ['Cautus B.V. Zei 9-11', 'Cautus B.V.', '1', '2', '', '', '', '', '', ' Zei 9-11', '1009023', '10', 'Geachte Daa', 'Mevrouw Daa', 'chaa.c2000@planet.nl'])
(1, ['Cautus B.V. 32', 'Cautus B.V.', '1', '2', '', '', '', '', '', 'Trias 92', '1109008', '10', 'Geachte mevrouw Daa', 'Mevrouw Daa', 'chaa.c2100@planet.nl']) 
```

# jquery - jQuery 提交（）；不升值

> ID：13031724
> 
> 赞同：0
> 
> 时间：2012-10-23T13:38:07.623
> 
> 标签：jquery, forms, button, submit, radio

我通过隐藏按钮并根据单击的图像选择它们来使用单选按钮的图像替换。

单击图像时，我希望他们选择一个单选按钮，然后提交。

这是我的原始代码：

```
$('#settings img').click(function() {
  $(this).parent().find(":radio").attr('checked', true);
}); 
```

如果我单击图像然后提交，则此方法有效。

我将其扩展为单击提交表单：

```
$('#settings img').click(function() {
  $(this).parent().find(":radio").attr('checked', true);
  $("#settings").submit();
}); 
```

在这种情况下，表单提交但不会更改值。如果我通过单击按钮提交它，它工作正常。

我哪里出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-17T14:18:31.790

这里的问题是`true`赋予`checked`属性的值。

提供的[jsfiddle](http://jsfiddle.net/eLGBt/)在 Chrome 中**工作。**但它**不在**Firefox 中。要使其在 Firefox 中也能正常工作，请使用该属性的`checked`值。`checked`

```
$('#settings img').click(function() {
  $(this).parent().find(":radio").attr('checked', 'checked');
}); 
```

另一种方法是**直接**操作（以及）`checked`DOM 元素的属性：

```
$(this).parent().find(":radio").get(0).checked = true; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-23T13:45:44.787

Javascript是异步的。看起来表单在 jQuery 可以选中复选框之前提交。尝试将提交放在回调中：

```
$('#settings img').click(function() {
  $(this).parent().find(":radio").attr('checked', true).one('change', function(){
     $("#settings").submit();
  });
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-23T13:56:47.577

也许不是最好的答案，但如果你给你的图像一个你可以替换的类：#settings img with .image 那么它可以工作

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-10-23T13:44:25.317

我已经分叉了你的问题：http: [//jsfiddle.net/fC38V/](http://jsfiddle.net/fC38V/)并做了一些补充：

```
$('#settings').submit(function(){
    alert($(this).serialize());
});

$('#settings img').click(function() {
    $(this).parent().find(":radio").attr('checked', true);
    $("#settings").submit(); // submits form on click
});​ 
```

通过在单击处理程序之前添加提交处理程序并测试分叉的小提琴，我只能在我的浏览器（Mac OS X 10.8 上的 Safari 6.0.1）中验证它是否按预期工作（据我所知）。

请确保：

1.  没有嵌套表格。浏览器对此非常挑剔。
2.  只有一个 ID 为“#settings”的元素

我能想到的唯一其他可能的问题是你的浏览器......你在用什么？

# android - 如何创建自定义进度对话框（微调器）？

> ID：13031725
> 
> 赞同：0
> 
> 时间：2012-10-23T13:38:13.943
> 
> 标签：android, android-spinner

![抱歉更新晚了..但这是我正在谈论的那种微调器布局](../Images/55086fd6a3cbca0d226c9f4b8485f12b.png)我用谷歌搜索了很多，甚至解决了这个网站的许多问题，但我就是找不到解决问题的方法。

我想创建一个像下面这样的微调器。这只是我到目前为止所做的普通微调器。我尝试了各种微调示例，但它们没有给我想要的结果。

这是我的代码：

```
public class nextclass extends Activity {

    Thread t;
    ProgressBar dia;

    private ProgressDialog progressDialog;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        MainActivity.progressDialog.dismiss();
        setContentView(R.layout.nextclassview);
    //  requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);

        ((Button) findViewById(R.id.button1))
                .setOnClickListener(new OnClickListener() {

                    public void onClick(View v) {
                        // TODO Auto-generated method stub
                        // progressDialog = findViewById(R.id.progressBar1);

                        new AuthenticateUserTask().execute();
                    }
                });
    }

    private class AuthenticateUserTask extends AsyncTask<Void, Void, String> {

        @Override
        protected void onPreExecute() {
            // TODO Auto-generated method stub
            super.onPreExecute();

            progressDialog = ProgressDialog.show(
                    nextclass.this, "","Sucessful", true);
/*            progressDialog.setIndeterminate(true);

            progressDialog.setIndeterminateDrawable(getResources()
                    .getDrawable(R.layout.customspinner));
*/

            progressDialog = ProgressDialog.show(nextclass.this, "",
                    "Processing....", true);
            progressDialog.getWindow().setLayout(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT);

        }

        protected void onPostExecute(String s) {
            if (progressDialog.isShowing())
                progressDialog.dismiss();

            Intent my = new Intent(getApplicationContext(), CountTime.class);
            startActivity(my);

        }

        @Override
        protected String doInBackground(Void... params) {
            // TODO Auto-generated method stub
            try {
                Thread.sleep(2000);![custom spinner][2]
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            return null;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:41:04.170

我没有在您的代码中看到任何 Spinner。但无论如何，您可以使用下面的代码来制作自定义微调器。

在您的布局文件中：

```
 <Spinnerandroid:id="@+id/spinnerview"
android:layout_width="180dp"
android:layout_height="42dp"
android:layout_marginLeft="105dp"
android:layout_marginTop="45dp"
android:background="@drawable/spinner_back"
android:paddingLeft="5dp"
android:spinnerMode="dropdown"android:visibility="visible" /> 
```

在你的 String.xml 里面：

```
<string-array name="spinner_array_environtment">
        <item>Test</item>
        <item>Production</item>
    </string-array> 
```

在 OnCreate 方法中的 Java 文件中：

```
spinner_environment = (Spinner) findViewById(R.id.spinnerview);
            adapter = ArrayAdapter.createFromResource(this,
                    R.array.spinner_array_environtment, R.layout.spinner);
            adapter.setDropDownViewResource(R.layout.spinner);
            spinner_environment.setAdapter(adapter); 
```

将新的 spinner.xml 文件添加到您的布局文件夹中：

在 spinner.xml 文件中：

```
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/spinnerTarget"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:textSize="25dp"
    android:textColor="#4C4646" /> 
```

而已！！！

# mahout - PlusAnonymousUserDataModel 的使用

> ID：13031726
> 
> 赞同：2
> 
> 时间：2012-10-23T13:38:14.870
> 
> 标签：mahout, recommendation-engine, collaborative-filtering, mahout-recommender

以下代码有什么问题，为什么它没有为匿名用户提供建议？
我无法弄清楚出了什么问题，但我无法使用 PlusAnonymousUserDataModel 获得匿名用户的建议。这是示例代码，它不显示对匿名用户的推荐，但为模型中具有完全相同偏好的用户提供推荐：

```
public static void main(String[] args) throws Exception {
    DataModel model = new GenericBooleanPrefDataModel(
            GenericBooleanPrefDataModel.toDataMap(new FileDataModel(
                    new File(args[0]))));
    PlusAnonymousUserDataModel plusAnonymousModel = new PlusAnonymousUserDataModel(model);

    UserSimilarity similarity = new LogLikelihoodSimilarity(model);
    UserNeighborhood neighborhood =
            new NearestNUserNeighborhood(
                    Integer.parseInt(args[1]), similarity, model);
    //new ThresholdUserNeighborhood(Float.parseFloat(args[1]), similarity, model);

    System.out.println("Neighborhood=" + args[1]);
    System.out.println("");

    Recommender recommender = new GenericBooleanPrefUserBasedRecommender(model,
            neighborhood, similarity);

    PreferenceArray anonymousPrefs =
            new BooleanUserPreferenceArray(12);
    anonymousPrefs.setUserID(0,
            PlusAnonymousUserDataModel.TEMP_USER_ID);
    anonymousPrefs.setItemID(0, 1105L);
    anonymousPrefs.setItemID(1, 1201L);
    anonymousPrefs.setItemID(2, 1301L);
    anonymousPrefs.setItemID(3, 1401L);
    anonymousPrefs.setItemID(4, 1502L);
    anonymousPrefs.setItemID(5, 1602L);
    anonymousPrefs.setItemID(6, 1713L);
    anonymousPrefs.setItemID(7, 1801L);
    anonymousPrefs.setItemID(8, 1901L);
    anonymousPrefs.setItemID(9, 2002L);
    anonymousPrefs.setItemID(10, 9101L);
    anonymousPrefs.setItemID(11, 9301L);

    synchronized(anonymousPrefs){
        plusAnonymousModel.setTempPrefs(anonymousPrefs);
        List<RecommendedItem> recommendations1 = recommender.recommend(PlusAnonymousUserDataModel.TEMP_USER_ID, 20);
        plusAnonymousModel.clearTempPrefs();

        System.out.println("Recm for anonymous:");

        for (RecommendedItem recommendation : recommendations1) {
            System.out.println(recommendation);
        }
        System.out.println("");
    }

    List<RecommendedItem> recommendations = recommender.recommend(
            Integer.parseInt(args[2]), 20);

    System.out.println("Recomedation for user_id="
            + Integer.parseInt(args[2]) + ":");

    for (RecommendedItem recommendation : recommendations) {
        System.out.println(recommendation);
    }
    System.out.println(""); 
```

此代码产生的输出如下： Neighborhood=100

匿名推荐：

user_id=1680604 的推荐：RecommendedItem[item:1701, value:24.363672] ... 等等。所以没有对匿名用户的推荐！:(

事实证明，要获得推荐，您必须使用不是“真实的”（在我的情况下是基于文件的）持久性 DataModel 模型，而是使用 PlusAnonymousUserDataModel plusAnonymousModel 来构建相似性、邻域和推荐器！
因此，关于 Mahout 的基本文档（[https://builds.apache.org/job/Mahout-Quality/javadoc/org/apache/mahout/cf/taste/impl/model/PlusAnonymousUserDataModel.html](https://builds.apache.org/job/Mahout-Quality/javadoc/org/apache/mahout/cf/taste/impl/model/PlusAnonymousUserDataModel.html)）是错误的`ItemSimilarity similarity = new LogLikelihoodSimilarity(realModel); // not plusModel`

早些时候，SO 上的其他人也遇到了同样的问题，在这里没有得到任何答案：[Model creation for User User collaborative filtering](https://stackoverflow.com/questions/9907320/model-creation-for-user-user-collanborative-filtering) 所以我想我应该去那里回答他。Sean Owen，感谢您的关注，您能确认我找到的解决方案是正确的吗？

# jquery - jQuery嵌套可排序插件几乎可以工作

> ID：13031729
> 
> 赞同：0
> 
> 时间：2012-10-23T13:38:22.923
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable, nested-sortable

看看[这个 jsfiddle](http://jsfiddle.net/s28Jj/1/)。

我正在使用嵌套的可排序插件，但由于某种原因，您无法将孩子`<li>`拖出其父级。问题是，仅当元素最初位于第二层时才会出现问题。如果您从`<li>`第一层的所有元素开始，则可以毫无问题地将它们拖入和拖出父元素。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:45:59.653

只需将“项目”添加到选项中：

```
$(function(){
    $('#menu-item-sort-list').nestedSortable({
        listType: 'ul',
        items: 'li'
    });
});​ 
```

文档[在这里](https://github.com/mjsarfatti/nestedSortable)。

# ruby - 在 Mac 10.5.8 上安装/更新 RubyGems

> ID：13031731
> 
> 赞同：1
> 
> 时间：2012-10-23T13:38:28.440
> 
> 标签：ruby, macos, gem, compass-sass

我正在尝试在 mac OSX 10.5.8 上更新我的 Rubygems。当前运行 1.0.1。我已经从[https://rubygems.org/pages/download](https://rubygems.org/pages/download)下载了 v.8.24 。

正如他们所说的CD'd到解压缩的文件夹，然后出来了：

```
macbook-10:~ sergehonderdos$ cd ~/Desktop/rubygems-1.8.24
macbook-10:rubygems-1.8.24 sergehonderdos$ sudo ruby setup.rb
Password:
./lib/rubygems.rb:335: warning: parenthesize argument(s) for future version
./lib/rubygems.rb:517: warning: parenthesize argument(s) for future version
./lib/rubygems.rb:32:in `require': ./lib/rubygems/deprecate.rb:54: syntax error, unexpected ',', expecting '|' (SyntaxError)
... define_method name do |*args, &block| # TODO: really works ...
                              ^
./lib/rubygems/deprecate.rb:55: syntax error, unexpected tCONSTANT, expecting '}'
./lib/rubygems/deprecate.rb:64: syntax error, unexpected kEND, expecting '}'
./lib/rubygems/deprecate.rb:69: syntax error, unexpected kEND, expecting '}'
    from ./lib/rubygems.rb:32
    from setup.rb:27:in `require'
    from setup.rb:27
macbook-10:rubygems-1.8.24 sergehonderdos$ gem -v
1.0.1 
```

我尝试更新的原因是安装指南针。

我不知道出了什么问题，有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T19:48:44.407

通过`ruby 1.8.6`在安装了`rvm`. 确认`rubygems 1.8.24`版本与版本不兼容`ruby 1.8.6`。

可能有一些方法可以安装与 1.8.6\. 兼容的早期版本的 ruby​​gems，但我预计这是一项复杂的任务。大多数 ruby​​ 组件将向前推进以与新版本的 ruby​​（1.8.7 或 1.9.3）兼容

解决这个问题的最好方法是升级 ruby​​ 版本。

# php - Magento 未在本地主机上安装

> ID：13031735
> 
> 赞同：0
> 
> 时间：2012-10-23T13:38:34.193
> 
> 标签：php, mysql, magento

我是 magento 商务的新手。我正在尝试在我的本地主机上安装 magento。当我输入所有详细信息时，数据库名称='madame_magento'，用户名='madame_mageusr'，密码=''。但它显示**数据库连接错误**。我也试过输入密码，但没有成功。谁能帮我。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:43:55.427

你的用户名不是root吗？如果是这样，请尝试以root身份输入用户名...

# c# - 为什么我无法捕捉到这个异常？

> ID：13031741
> 
> 赞同：1
> 
> 时间：2012-10-23T13:38:49.200
> 
> 标签：c#, visual-studio, exception, xamlparseexception, xamlreader

为什么我无法捕捉到以下内容`XamlParseException`？

![在此处输入图像描述](../Images/f3be1df3b16083db4bef47ea8e7d5073.png)

单击“*继续*”按钮后，程序继续正常行为（捕获异常并`ex.Message`在控制台上打印）。

问题是 Visual Studio 异常对话框。为什么会出现？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-23T13:40:56.783

您很可能在调试中打开了所有异常。查看 Debug 菜单下的“Exceptions...”（Ctrl+Alt+E），看看“CLR Exceptions”是否勾选了 Throw。如果是这样，那么您可能想要取消勾选它。

启用后，这意味着即使是通常捕获的抛出异常（第一次机会异常）也会被调试器捕获。

# c# - 查找属性 == true 的列表的总和？

> ID：13031750
> 
> 赞同：4
> 
> 时间：2012-10-23T13:39:06.093
> 
> 标签：c#, .net, linq, list

在我的 C# 代码中，我有一个 type 列表`CustomClass`。此类包含一个布尔属性`trueOrFalse`。

我有一个`List<CustomClass>`. 我希望使用此列表创建一个整数，该列表保存列表中`trueOrFalse`值为`True`.

做这个的最好方式是什么 ？我认为有一种巧妙的方法可以使用 Linq 来完成此任务，而不必遍历每个对象？

非常感谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-23T13:41:40.183

您可以使用[`Enumerable.Count`](http://msdn.microsoft.com/en-us/library/bb535181.aspx)：

```
int numTrue = list.Count(cc => cc.trueOrFalse); 
```

记得添加`using system.Linq;`

请注意，您不应该使用此方法来检查序列是否包含元素（`list.Count(cc => cc.trueOrFalse) != 0`）。因此，您应该使用[`Enumerable.Any`](http://msdn.microsoft.com/en-us/library/bb534972.aspx)：

```
bool hasTrue = list.Any(cc => cc.trueOrFalse); 
```

不同之处在于`Count`枚举整个序列，而`Any`一旦找到一个通过测试谓词的元素，它将尽早返回 true。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-23T13:41:04.743

使用 LINQ，您确实可以做到这一点。

```
int amountTrue = list.Where(c => c.trueOrFalse).Count(); 
```

或者在计数中使用 Where 更短：

```
int amountTrue = list.Count(c => c.trueOrFalse); 
```

正如[Tim Schmelter](https://stackoverflow.com/users/284240/tim-schmelter)所说：添加`using System.Linq;`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-23T13:42:00.390

```
 list.Count(a => a.TrueOrFalse); 
```

我冒昧地在开始时给你的财产一个大写字母。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-23T13:41:46.287

这对于 LINQ 来说是微不足道的：

```
list.Count(x => x.trueOrFalse); 
```

只需调用[`Count`](http://msdn.microsoft.com/en-us/library/bb535181.aspx)列表中的扩展方法并传入条件即可。在您的情况下，条件只是您的布尔属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-23T13:42:38.457

```
var count = listOfCustomClass.Where(a => a.trueOrFalse).Count(); 
```

# javascript - Javascript 客户端/服务器模块约定

> ID：13031751
> 
> 赞同：2
> 
> 时间：2012-10-23T13:39:07.213
> 
> 标签：javascript, requirejs, amd, commonjs

是否有编写可在客户端和服务器上使用的 Javascript 中间件库的约定？

假设我们有一个数据抽象层，我们称之为[JEFRi](http://jefri.org)。JEFRi 运行时需要在客户端和服务器上运行相同，以便使用 DAL 的应用程序的所有部分都可以引用相同的实现、API 等。JEFRi 具有依赖项（特别是下划线），并且具有依赖于的子模块它（Mongo 存储、LocalStore 存储）。

可用于在浏览器和节点之间实现最简单的代码共享的最直接模式是什么？

它应该：

*   可以使用 NPM 安装在服务器上
*   可以使用 CommonJS`require()`调用在服务器中加载
*   可以使用以下之一为浏览器项目安装：ender、bower、npm
*   通过复制文件中没有库依赖项的 .min.js 可以为浏览器项目安装。
*   可以使用标签在页面上加载`<script>`（并在全局范围内注册自身）
*   可以使用 AMD 加载到页面上`define()`并`require()`调用

任何数量的构建步骤都是可以接受的，例如在必要时调用 r.js。

# emacs - Emacs 中是否有类似 gud 的八度调试模式？

> ID：13031754
> 
> 赞同：2
> 
> 时间：2012-10-23T13:39:26.047
> 
> 标签：emacs, octave

我知道有像*dbstop*和*dbstep*等命令来调试**Octave**脚本。我想在 Emacs 中为 Octave 找到类似**gud**的模式，但失败了。有这样一种模式吗？或者我该如何实施？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-28T06:55:01.567

AFAIK，Octave 没有类似 GUD 的。此外，Octave 的 Emacs 模式已过时。Octave 中有一个开发分支，旨在为基于 Qt 的 Octave 创建一个 GUI。我不知道 GUI 什么时候会足够成熟。R 有一个非常漂亮的 GUI 前端 R-studio。我只是希望 Octave 社区会有类似的好伙伴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-22T14:14:21.813

我自己是emacs用户，但根据这个线程： [如何在vscode中使用八度？](https://stackoverflow.com/questions/61961007/how-to-use-octave-in-vscode) 您可以在 VS 代码中运行 octave 调试器。我刚试过，太棒了。这对于 octave 用户来说意义重大，因为 Octave GUI 调试器存在严重缺陷，即在编辑/保存文件后偶尔无法保留断点。这个错误已经存在多年，但就在前几天我在 Octave 5.2.0 中开始一个新项目时，突然出现了这个错误的新行为，这是我之前从未见过的，这让我更加沮丧。这个关于 VS 代码的消息对我来说来得正是时候。

# sql - 如何在 ZF2 的 join sql 请求中使用 CONCAT

> ID：13031755
> 
> 赞同：3
> 
> 时间：2012-10-23T13:39:27.790
> 
> 标签：sql, zend-framework2

我正在将我的 zf1 应用程序移动到 zf2 并且我在移动我的映射器时遇到了很多问题。显然，我不能只是复制/过去我的查询（太糟糕了！）

我正在尝试`CONCAT`在像这样的连接中使用

```
$resultSet = $this->select(function (Select $select) use($userId, $filter, $status){ 

 $select->columns(array("id_project", "name", "current_to", "avancement"));
 $prj = "PRJ_";
 $select->join(array("ru" => "role_users"), "CONCAT( $prj , projects.id_project ) = ru.element", array())
                   ->where("ru.user_id = $userId"); 
```

如果我打印`$select->getSqlString()`，我得到：

```
 SELECT "projects"."id_project" AS "id_project", "projects"."name" AS "name", 
    "projects"."current_to" AS "current_to", "projects"."avancement" AS "avancement" FROM 
"projects" INNER JOIN "role_users" AS "ru" ON "CONCAT"( "PRJ_" "," "projects"."id_project"
 ) = "ru"."element" WHERE ru.user_id = 3 
```

批准所有“”，这是正确的（如果我删除所有“”并在phpmyadmin中执行它，它可以工作。但是，如果zf2正在执行它，我会收到一个错误：

```
SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in 
your SQL syntax; check the manual that corresponds to your MySQL server version 
for the right syntax to use near '`projects`.`id_project` ) = `ru`.`element` 
WHERE ru.user_id = 3' at line 1 
```

看起来有问题，`CONCAT()`但我找不到问题所在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T09:01:05.447

我觉得这不是很优雅，但它有效：

```
$select->join(array("ru" => "role_users"), 
new Expression("CONCAT( $prj , projects.id_project ) = ru.element"), array())
->where("ru.user_id = $userId")); 
```

# c# - NullReferenceException 与 C# 中的 HtmlDocument 引用

> ID：13031757
> 
> 赞同：2
> 
> 时间：2012-10-23T13:39:30.057
> 
> 标签：c#, unity-container, html-agility-pack, nullreferenceexception

我正在使用`HtmlAgilityPack`为了从谷歌翻译中刮取信息用于翻译程序。我已经下载了`HtmlAgilityPack`dll，并在我的程序中成功引用了它。我在 Unity 中使用 Assembly。下面是我的两个程序的代码：

```
using UnityEngine;
using System.Collections;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net;
using HtmlAgilityPack;

public class GUIScript : MonoBehaviour {
    private string textField = "";
    private string input;
    public Texture2D icon;
    Dictionary search;
    Encoding code;
    // Use this for initialization
    void Start () { 
        search = new Dictionary();
        input = " ";
        code = Encoding.UTF8;
        //This is what is run to translate
        print (search.Translate("Hola","es|en",code));
    }

    // Update is called once per frame
    void Update () {

    }
    void OnGUI(){
        textField = GUI.TextField(new Rect(0, Screen.height -50, Screen.width-80, 40), textField);
        if(GUI.Button(new Rect(Screen.width-80, Screen.height -50, 80,40), icon)){
            input = textField;
            textField = "";

        }
        //GUI.Label(new Rect(0,Screen.height -70, Screen.width-80,20), search.Translate("Hola","es|en",code));
        //print (search.Translate("Hola","es|en",code));
    }
} 
```

这是引用我的`Dictionary`类的代码，如下所示：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using UnityEngine;
using System.Collections;
using System.Net;
using HtmlAgilityPack;

public class Dictionary{
    string[] formatParams;
    HtmlDocument doc;
    public Dictionary(){
        formatParams = new string[2];
        doc = new HtmlDocument();
    }
    public string Translate(String input, String languagePair, Encoding encoding)
     {
        formatParams[0]= input;
        formatParams[1]= languagePair;
        string url = String.Format("http://www.google.com/translate_t?hl=en&ie=UTF8&text={0}&langpair={1}", formatParams);

        string result = String.Empty;

        using (WebClient webClient = new WebClient())
        {
            webClient.Encoding = encoding;
            result = webClient.DownloadString(url);
        }       
        doc.LoadHtml(result);
        return doc.DocumentNode.SelectSingleNode("//span[@title=input]").InnerText;
    }
    // Use this for initialization
    void Start () {

    }
} 
```

运行此程序时，我收到错误：

```
NullReferenceException: Object reference not set to an instance of an object
Dictionary.Translate (System.String input, System.String languagePair,System.Text.Encoding encoding) (at Assets/Dictionary.cs:32)
GUIScript.Start () (at Assets/GUIScript.cs:22) 
```

我已经尝试更改代码、查找解决方案、API`HtmlDocument`以及如何修复`NullReferenceExceptions`，但由于某种原因，我无法弄清楚为什么我会得到一个`NullReferenceException`. 这个问题已经阻碍了我一两个星期，我需要继续我的项目。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:53:58.863

如果我计算正确，这是第 32 行：

```
return doc.DocumentNode.SelectSingleNode("//span[@title=input]").InnerText 
```

这意味着要么`doc.DocumentNode`为空，要么`DocumentNode.SelectSingleNode("//span[@title=input]")`返回空。

如果是前者，请检查您是否收到了实际文档。您的 URL 可能未正确编码。另请参阅[为什么 HTML Agility Pack HtmlDocument.DocumentNode 为空？](https://stackoverflow.com/questions/9139156/why-html-agility-pack-htmldocument-documentnode-is-null)

如果是后者，那么 XPath 可能会发生一些奇怪的事情。我不知道这`DocumentNode`应该是文档的根目录有多相关， [http](http://htmlagilitypack.codeplex.com/discussions/249129) ://htmlagilitypack.codeplex.com/discussions/249129 上的讨论可能适用。据此，'//' 是从*文档*的根目录搜索，您可能不得不尝试（在字符串的开头`doc.DocumentNode.SelectSingleNode(".//span[@title=input]")`添加 a ）。`.`

调试方法并准确查看这些调用的值将完成这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T21:08:06.330

你想找回什么？我打开了您正在使用的 url 并做了一个简单的查找`title=input`并没有返回任何内容。我猜你正在寻找 Hola 的翻译，你好？

如果是这样，我在控制台应用程序中这样做了。希望这可以帮助。

```
 static void Main(string[] args)
    {
        string Input = "Hola";
        HtmlWeb web = new HtmlWeb();
        HtmlDocument doc = web.Load("http://www.google.com/translate_t?hl=en&ie=UTF8&text=Hola&langpair=es|en");

        string definition = doc.DocumentNode.SelectSingleNode(string.Format("//span[@title='{0}']",Input)).InnerText;
        Console.WriteLine(definition);
        Console.ReadKey();
    } 
```

编辑：刚刚意识到你不是在寻找`title=input`但是`title=Hola`. 正如您在我的代码中看到的那样，请尝试`String.Format(("//span[@title='{0}']",Input)`. 这会将变量的文本插入`Input`到字符串行中。

# php - PHP IRC bot 读取从 IRC 服务器的命令返回的数据

> ID：13031760
> 
> 赞同：0
> 
> 时间：2012-10-23T13:39:37.113
> 
> 标签：php, sockets, bots, irc

我正在使用最初由 Phil 创建的用程序 PHP 编写的 IRC 机器人，现在我将其用于学习目的。该机器人工作，它设置 IRC 服务器并加入设置的频道，它还可以处理简单的命令并将某些内容响应回频道。但是，每当有人写“！call wakey wakey，现在该醒来了”时，我都会尝试创建一个命令，然后机器人在频道内发送一条消息，其中包含用户名列表和写在“！call”之后的消息发布带有名称的列表后的换行符。

例如：

频道中的当前用户有： foo bar foobar barfoo

人 A 说： !call 有人知道我在哪里可以找到我的泰迪熊吗？机器人回复：foo、bar、foobar、barfoo 机器人回复：有人知道我在哪里可以找到我的泰迪熊吗？

is 的作用是，如果“！call”位于消息的开头，则会触发它。然后它会调用一个函数 get_data_call，该函数将从通道中获取消息并将 !call 和消息拆分，该函数只返回消息或返回 false。到目前为止它有效，我确实将消息存储在一个变量中。

现在我的问题是：

现在我必须向 IRC 服务器发送一个“NAMES”命令，然后它返回一个当前在机器人所在频道中的用户名列表。但我似乎无法捕捉到该列表，我确实看到了从服务器返回一条消息，我尝试使用类似的方法，但我确信这不是正确的方法（否则它会起作用）：

```
while (!feof($sock)) 
{
$readCall = fread($sock, 4024);
if ($readCall === true) 
{
while (strpos($readCall, ':irc.rizon.no') !== false) 
{
echo "irc.rizon.no found!";
break;
}
}
else 
{
echo "readCall returns false.";
break;
}
} 
```

这不起作用，并且总是返回 false。

完整的代码可以在这里找到： http://pastebin.com/edit.php?i= [F2bAdDmS](http://pastebin.com/edit.php?i=F2bAdDmS)

我希望这个精彩网站上的人可以帮助我，我将非常感激。

谢谢你。//Xenios

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:47:42.397

`strpos()`找到匹配项时将返回一个正整数或 0。`!== false`您应该尝试在您的条件中使用 a ，因为`strpos()`如果在第一个字符中找到匹配项，则可以返回 0。

# python - Python将数据文件读入列表或数组

> ID：13031764
> 
> 赞同：5
> 
> 时间：2012-10-23T13:40:01.727
> 
> 标签：python, file-io

出于某种原因，我决定将我的数据列表保存为字符串。如果我使用

```
f = open('tarfile.txt')
for line in f.readlines():
    print line
f.close() 
```

我的输出看起来像：

```
[  53.7775   13.4375   26.525    48.63    125\.      185\.      653\.    ]    
[  53.7775    13.33625   26.73375   48.68375  125\.       185\.       653\.     ]    
[  53.7775    13.325     27.11375   48.8875   126\.       187\.       653\.     ]    
[  53.7775    13.43625   27.3175    48.92875  126\.       187\.       653\.     ]    
[  53.7775    14.4825    33.07375   51.7325   141\.       202\.       595\.     ] 
```

我想将这些数据读入二维数组。我已经搜索并尝试了各种方法，例如 pickle、eval、json 等，但没有任何效果

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-23T13:53:13.483

如果您正在使用`numpy`（或不介意使用它），您可以使用`numpy.loadtxt('tarfile.txt', usecols=range(1,8))`. 如果您`numpy`无论如何都希望将数据保存在二维数组中，那就太好了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T13:47:17.063

首先，您需要将其转换`[]`为 python 可以处理的内容：

```
import string
table = string.maketrans('[]','  ') 
```

现在您可以遍历文件、翻译、拆分和浮动：

```
for line in f:
    print [float(x) for x in line.translate(table).split()] 
```

如果您保证这`[`是第一个字符并且`]`是该行的最后一个字符，则可以通过切片来实现：

```
print [float(x) for x in line[1:-2].split()]  #-2 accounts for the newline too. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-23T13:44:18.080

我的猜测是您的输入文件包含由空格分隔的浮点数。

要读取这样的文件，请去掉`[`and `]`，拆分每一行，并将每个字段映射到一个浮点实例。

```
records = []
for line in f:
    record = [float(field) for field in line.strip().lstrip('[').rstrip(']').split()]
    records.append(record) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-23T13:52:56.453

我认为正则表达式是解析数据的最佳方式：

```
import re
pattern = r'\d+.\d*'
array = []
for line in open('tarfile.txt'):
    array.append(re.findall(pattern, line)) 
```

# ruby-on-rails - rails_admin gem 中的自定义操作

> ID：13031774
> 
> 赞同：5
> 
> 时间：2012-10-23T13:40:42.997
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-admin

我不太了解它是如何工作的[rails_admin gem](https://github.com/sferik/rails_admin)来创建一个新的动作。

我想在 rails_admin root 中创建一个名称为**balance的操作。**

我在**myapp/lib文件夹中创建了一个名为****rails_admin_balance.rb**的文件，例如：

 **```
require 'rails_admin/config/actions'
require 'rails_admin/config/actions/base'

module RailsAdminBalance
end

module RailsAdmin
  module Config
    module Actions
      class Balance < RailsAdmin::Config::Actions::Base
       RailsAdmin::Config::Actions.register(self)
        register_instance_option :object_level do
          true
        end
        register_instance_option :link_icon do
         'icon-eye-open'
        end
        register_instance_option :root? do
          true
        end
      end
    end
  end
end 
```

我在**/views/rails_admin/main/balance.html.erb上创建了一个新文件**

在我的`rails_admin.rb`文件里面

```
config.actions do
 dashboard                     # mandatory
 # collection actions 
 index                         # mandatory
 new
 export
 history_index
 bulk_delete
 # member actions
 show
 edit
 delete
 history_show
 show_in_app
 balance 
end 
```

当我尝试运行 rails server 时，出现此错误：

退出

```
/home/ubuntu/Desktop/myapp/config/initializers/rails_admin.rb:33:in `block (2 levels) in <top (required)>': undefined method `balance' for RailsAdmin::Config::Actions:Module (NoMethodError).... 
```

我的错误在哪里？

我在做什么坏事？

非常感谢你！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-02T12:15:41.927

我遇到了完全相同的问题。我认为这是因为`rails_admin_[my_action].rb`/lib 下的文件没有被加载，这在 rails_admin 文档中没有记录。

您可以尝试从`rails_admin.rb or just move all the code you have on`rails_admin_[my_action].rb `to the`rails_admin.rb` 初始化程序加载它（将其粘贴在文件的开头）。

还有第三个选项（仅当您不想重用该操作时），恕我直言看起来更干净：

摆脱`rails_admin_[my_action].rb`(your `rails_admin_balance.rb`) 并在内部重写您的操作`rails_admin.rb`，如下所示：

```
config.actions do
  dashboard                     # mandatory
  # collection actions 
  index                         # mandatory
  new
  export
  history_index
  bulk_delete
  # member actions
  show
  edit
  delete
  history_show
  show_in_app

  member :balance do
    link_icon 'icon-eye-open'
    root? true
  end
end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-01T12:28:39.123

只需将其添加到您的**rails_admin.rb**

```
module RailsAdmin
  module Config
    module Actions
      class Balance < RailsAdmin::Config::Actions::Base
        RailsAdmin::Config::Actions.register(self)
      end
    end
  end
end 
```

在 RailsAdmin 范围内打开 Actions 模块可避免此特定错误。您的定义可以保留在 lib 上的 Balance 模块中。**

# c# - 如何从嵌入式资源中提取文件并将其保存到磁盘？

> ID：13031778
> 
> 赞同：60
> 
> 时间：2012-10-23T13:40:52.203
> 
> 标签：c#, .net, embedded-resource, csharpcodeprovider

我正在尝试使用 CSharpCodeProvider 编译下面的代码。该文件已成功编译，但是当我单击生成的 EXE 文件时，出现错误（Windows 正在搜索此问题的解决方案）并且没有任何反应。

当我使用 CSharpCodeProvider 编译下面的代码时，我`MySql.Data.dll`使用这行代码将其添加为嵌入式资源文件：

```
if (provider.Supports(GeneratorSupport.Resources))
    cp.EmbeddedResources.Add("MySql.Data.dll"); 
```

该文件已成功嵌入（因为我注意到文件大小增加了）。

在下面的代码中，我尝试提取嵌入的 DLL 文件并将其保存到 System32，但由于某种原因，下面的代码不起作用。

```
namespace ConsoleApplication1
{
    class Program
    {
        public static void ExtractSaveResource(String filename, String location)
        {
            //Assembly assembly = Assembly.GetExecutingAssembly();
            Assembly a = .Assembly.GetExecutingAssembly();
            //Stream stream = assembly.GetManifestResourceStream("Installer.Properties.mydll.dll"); // or whatever
            //string my_namespace = a.GetName().Name.ToString();
            Stream resFilestream = a.GetManifestResourceStream(filename);
            if (resFilestream != null)
            {
                BinaryReader br = new BinaryReader(resFilestream);
                FileStream fs = new FileStream(location, FileMode.Create); // Say
                BinaryWriter bw = new BinaryWriter(fs);
                byte[] ba = new byte[resFilestream.Length];
                resFilestream.Read(ba, 0, ba.Length);
                bw.Write(ba);
                br.Close();
                bw.Close();
                resFilestream.Close();
            }
            // this.Close();
        }

        static void Main(string[] args)
        {
            try
            {
                string systemDir = Environment.SystemDirectory;
                ExtractSaveResource("MySql.Data.dll", systemDir);
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.Message);
                Console.ReadKey();
            }
        }
    }
} 
```

如何提取作为资源嵌入的 DLL 文件并将其保存到 System32？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-11-14T15:48:42.107

我建议做起来更轻松。我假设资源存在并且文件是可写的（如果我们谈论系统目录，这可能是一个问题）。

```
public void WriteResourceToFile(string resourceName, string fileName)
{
    using(var resource = Assembly.GetExecutingAssembly().GetManifestResourceStream(resourceName))
    {
        using(var file = new FileStream(fileName, FileMode.Create, FileAccess.Write))
        {
            resource.CopyTo(file);
        } 
    }
} 
```

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2016-01-07T20:29:10.987

我发现最简单的方法是使用`Properties.Resources`and `File`。这是我使用的代码（需要`using System.IO`）...

对于二进制文件： `File.WriteAllBytes(fileName, Properties.Resources.file);`

对于文本文件： `File.WriteAllText(fileName, Properties.Resources.file);`

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-10-25T07:55:39.640

我一直在使用这种（经过测试的）方法：

OutputDir：要复制资源的位置

ResourceLocation：命名空间（+ dirnames）

文件：要复制的资源位置中的文件列表。

```
 private static void ExtractEmbeddedResource(string outputDir, string resourceLocation, List<string> files)
    {
        foreach (string file in files)
        {
            using (System.IO.Stream stream = System.Reflection.Assembly.GetExecutingAssembly().GetManifestResourceStream(resourceLocation + @"." + file))
            {
                using (System.IO.FileStream fileStream = new System.IO.FileStream(System.IO.Path.Combine(outputDir, file), System.IO.FileMode.Create))
                {
                    for (int i = 0; i < stream.Length; i++)
                    {
                        fileStream.WriteByte((byte)stream.ReadByte());
                    }
                    fileStream.Close();
                }
            }
        }
    } 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-12-17T02:26:17.913

这完美！

```
public static void Extract(string nameSpace, string outDirectory, string internalFilePath, string resourceName)
{
    //nameSpace = the namespace of your project, located right above your class' name;
    //outDirectory = where the file will be extracted to;
    //internalFilePath = the name of the folder inside visual studio which the files are in;
    //resourceName = the name of the file;
    Assembly assembly = Assembly.GetCallingAssembly();

    using (Stream s = assembly.GetManifestResourceStream(nameSpace + "." + (internalFilePath == "" ? "" : internalFilePath + ".") + resourceName))
    using (BinaryReader r = new BinaryReader(s))
    using (FileStream fs = new FileStream(outDirectory + "\\" + resourcename, FileMode.OpenOrCreate))
    using (BinaryWriter w = new BinaryWriter(fs))
    {
        w.Write(r.ReadBytes((int)s.Length));
    }
} 
```

使用示例：

```
public static void ExtractFile()
{
    String local = Environment.CurrentDirectory; //gets current path to extract the files

    Extract("Geral", local, "Arquivos", "bloquear_vbs.vbs");
} 
```

如果这仍然没有帮助，请尝试此视频：[https ://www.youtube.com/watch?v=_61pLVH2qPk](https://www.youtube.com/watch?v=_61pLVH2qPk)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-01-12T15:44:05.247

或者使用扩展方法...

```
 /// <summary>
 /// Retrieves the specified [embedded] resource file and saves it to disk.  
 /// If only filename is provided then the file is saved to the default 
 /// directory, otherwise the full filepath will be used.
 /// <para>
 /// Note: if the embedded resource resides in a different assembly use that
 /// assembly instance with this extension method.
 /// </para>
 /// </summary>
 /// <example>
 /// <code>
 ///       Assembly.GetExecutingAssembly().ExtractResource("Ng-setup.cmd");
 ///       OR
 ///       Assembly.GetExecutingAssembly().ExtractResource("Ng-setup.cmd", "C:\temp\MySetup.cmd");
 /// </code>
 /// </example>
 /// <param name="assembly">The assembly.</param>
 /// <param name="resourceName">Name of the resource.</param>
 /// <param name="fileName">Name of the file.</param>
 public static void ExtractResource(this Assembly assembly, string filename, string path=null)
 {
     //Construct the full path name for the output file
     var outputFile = path ?? $@"{Directory.GetCurrentDirectory()}\{filename}";

     // If the project name contains dashes replace with underscores since 
     // namespaces do not permit dashes (underscores will be default to).
     var resourceName = $"{assembly.GetName().Name.Replace("-","_")}.{filename}";

     // Pull the fully qualified resource name from the provided assembly
     using (var resource = assembly.GetManifestResourceStream(resourceName))
     {
         if (resource == null)
             throw new FileNotFoundException($"Could not find [{resourceName}] in {assembly.FullName}!");

         using (var file = new FileStream(outputFile, FileMode.Create, FileAccess.Write))
         {
             resource.CopyTo(file);
         }
     }
 } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-23T13:53:15.590

尝试将您的目标程序集读入 a`MemoryStream`然后保存到`FileStream`这样的（请记住，此代码未经测试）：

```
//Imports
using System;
using System.IO;
using System.Reflection;

    Assembly assembly = Assembly.GetExecutingAssembly();
    using (var target = assembly.GetManifestResourceStream("MySql.Data.dll"))
    {
        var size = target.CanSeek ? Convert.ToInt32(target.Length) : 0;

        // read your target assembly into the MemoryStream
        MemoryStream output = null;
        using (output = new MemoryStream(size))
        {
            int len;
            byte[] buffer = new byte[2048];

            do
            {
                len = target.Read(buffer, 0, buffer.Length);
                output.Write(buffer, 0, len);
            } 
            while (len != 0);
        }

        // now save your MemoryStream to a flat file
        using (var fs = File.OpenWrite(@"c:\Windows\System32\MySql.Data.dll"))
        {
            output.WriteTo(fs);
            fs.Flush();
            fs.Close();
        }
    } 
```

# java - 模运算符在 Java 中给出了意外的输出

> ID：13031780
> 
> 赞同：4
> 
> 时间：2012-10-23T13:41:02.180
> 
> 标签：java, mathematical-optimization, modulo, floating-accuracy

我在Java中有以下工作方法：

```
/**
 * Determines if n is a power of z
 * 
 * @param z the number that n may be a power of
 * @param n the number that may be a power of z
 * @return true if n is a power of z 
 */
public boolean isPowerOf(int z, int n) {
    double output = Math.log(n) / Math.log(z);
    if(output % 1 > 0) {
        return false;
    } else {
        return true;
    }
}

isPowerOf(3, 729); //returns true, because 3^6 = 729 
```

工作正常n强大，但我第一次尝试不同：

```
public boolean isPowerOf(int z, int n) {
    double output = Math.log(n) % Math.log(z);
    if(output != 0) {
        return false;
    } else {
        return true;
    }
} 
```

然而，对于`log(729) % log(3)`似乎回归`1.0986122886681093`，而结果`log(729) / log(3) is 6`。

谁能告诉我是什么原因导致模运算符仍然`1.09`在这里给出余数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-23T13:47:46.360

> 谁能告诉我是什么原因导致模运算符在这里仍然给出 1.09 余数？

基本上，正常的浮点数不准确。您使用的值不*完全是*log(729) 和 log(3)。如果您看一下`log(3)`，`log(729) % log(3)`您会发现它们几乎完全相同：

```
public class Test {
    public static void main(String[] args) {
        double x = Math.log(729);
        double y = Math.log(3);
        System.out.println(x);
        System.out.println(y);
        System.out.println(x % y);
    }
} 
```

输出：

```
6.591673732008658
1.0986122886681098
1.0986122886681093 
```

换句话说，`log(729)`是有效的`log(3) * 5.9999999999999`（或类似的东西）。基本上，您可能希望为您的测试添加一些容差，并返回余数是否*非常接近 0*或*非常接近`log(z)`*.

或者，使用`log`和除法“粗略地”计算出功率应该是多少，然后`Math.pow`检查确切的值：

```
int power = (int) (Math.log(n) / Math.log(z) + 0.5);
return n == Math.pow(z, power); 
```

在这里，在数字变得“相当大”之前，您在浮点不准确性方面应该没问题。如果您想精确`BigInteger`处理*非常*大的数字，您可以使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T13:48:26.733

```
Math.log(729)  = 6.591673732008658
Math.log(3) = 1.0986122886681098

d= 1.0986122886681093 
```

如果您注意到，它`d (1.0986122886681093)`比 value add 略小（最后一位）， `Math.log(3)-(1.0986122886681098)`它似乎工作正常。可能您缺少对双精度数据类型的理解。**由于浮点数的实际表示形式，浮点数对于高精度值有一些不准确之处。**

# jquery - jquery循环和jcarousel

> ID：13031790
> 
> 赞同：0
> 
> 时间：2012-10-23T13:41:31.417
> 
> 标签：jquery, jcarousel, jquery-cycle

我有一个带有 jquery 循环和 jcarousel 的画廊设置。我用 php 生成缩略图

```
<ul id="pager">
    <?php foreach ($thumbs as  $thumb) : ?>
<li><a href="#"><?php echo $thumb ?> </a></li>
    <?php endforeach; ?>
</ul> 
```

现在我创建一个轮播并将寻呼机附加到循环

```
$('#pager').jcarousel({});
if ( $('#images').length > 0 ) {
     $('#images').before('<ul id="nav">').cycle({ 
     fx:     'turnDown', 
     speed:  500, 
     timeout: 5000, 
     pagerEvent: 'mouseover',
     pager:  '#pager', 
     pagerAnchorBuilder: function(idx, slide) { 
         return '#pager li:eq(' + idx + ') a'; 
    } ,
    after: function(dir, id, el) {
        var w= $('.jcarousel-clip-horizontal').width();
        var i = $('.jcarousel-item-horizontal').width();
        var slide = $('#pager .activeSlide');
        if ( slide.position.left > w-i  ) {
            $('div.jcarousel-next').trigger('click');
        }
    }
});
  $('#pager a').mouseenter(function() { 
     $('#images').cycle('toggle'); 
}).mouseleave(function(){
     $('#images').cycle('toggle'); 
}); 
```

我的寻呼机中有 7 个元素可见，我想为下一个不可见的项目触发滚动事件。

我尝试使用 jquery index() 函数为 activeSlider 添加一个计数器，但是当将光标悬停在寻呼机项目上时它变得混乱。

对此有任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:18:05.600

我认为您可以使用循环的第 2 版

[http://jquery.malsup.com/cycle2/demo/caro-pager.php](http://jquery.malsup.com/cycle2/demo/caro-pager.php)

[http://jquery.malsup.com/cycle2/demo/carousel.php](http://jquery.malsup.com/cycle2/demo/carousel.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T13:21:26.973

好的，所以我找到了解决这个问题的方法，我花了一段时间，可能可以做得更好，但这是我使用的代码，我认为它非常简单

```
$('#pager').jcarousel({
    scroll: 1,
    wrap:'last',
});
if ( $('#images').length > 0 ) {
    $('#images').before('<ul id="nav">').cycle({ 
        fx:     'turnDown', 
        speed:  500, 
        timeout: 5000, 
        pagerEvent: 'mouseover',
        pager:  '#pager', 
        pagerAnchorBuilder: function(idx, slide) { 
            return '#pager li:eq(' + idx + ') a'; 
        } 
        ,after: onBefore
    });
};

function onBefore(curr,next,opts) {
    var size = $('#pager li').size();
    var activeSlide = $('#pager .activeSlide');
    var position = activeSlide.offset();

    // get the position of the carousel clip container
    var container = $('.jcarousel-clip');
    var containerOff = container.offset();

    //first load 
    if(position!=null){
                    // get the information 
        var slideRigt = position.left + activeSlide.width();
        var containerRight = containerOff.left + container.width();
                    // slide is out ou bound on the right
            if ( slideRigt > containerRight ) {
                    $('div.jcarousel-next').trigger('click');
                }
                    // slide is out of bound on the left - rewind/wrap thumbnails to first item
                    else if ( position.left < containerOff.left ) {
                    $('div.jcarousel-next').trigger('click');
                };
    }
}; 
```

希望这对有同样问题的人有用。仍在尝试找出是否有办法使用 wrap: jcarousel 的“循环”选项来完成这项工作。

# iphone - iPhone 5 vs 模拟器上的 UIKit 布局问题

> ID：13031791
> 
> 赞同：0
> 
> 时间：2012-10-23T13:41:38.907
> 
> 标签：iphone, user-interface, uikit, ios6

当我在模拟器（iOS 6，4 英寸屏幕）中运行我的 iOS 应用程序时，该应用程序不会尝试填满整个屏幕。它只是在 480 高度应用程序的上方和下方运行黑色带。但是，当我在 iPhone 5 上运行该应用程序时，它会尝试全屏运行。

我很欣赏 UIKit 的灵活性，它使这成为可能。然而，这个应用程序的用户界面（不是我创建的）设计得不是很好。因此，UIKit 在 4 英寸屏幕上的自动调整非常糟糕。所以我想暂时关闭这个“自动调整”功能，这样应用程序就可以使用了，而我花时间实际修复大屏幕的布局。

**如何防止基于 UIKit 的 iOS 应用程序尝试在 iPhone 5 上全屏运行？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:43:04.217

你设置了4英寸的闪屏吗？如果是这样，请将其删除，然后 Product->clean 您的项目。在再次运行之前，还要从 iPhone 5 上删除该应用程序。

# jquery - jQuery 在每个具有 display:block 样式的子元素之后追加元素

> ID：13031801
> 
> 赞同：0
> 
> 时间：2012-10-23T13:41:49.323
> 
> 标签：jquery, css-selectors

另一个 jQuery 的东西给你，我正在摸不着头脑。我有一些使用 jQuery 打开和关闭的浮动 div（如下所示）。我需要在每三个**不**具有 display:none 样式的子元素之后附加一些位。

```
<div class="ItemList">
    <div class="Item">A</div>
    <div class="Item" style="display:none;">B</div>
    <div class="Item">C</div>
    <div class="Item">D</div>
    <div class="Item" style="display:none;">E</div>
    <div class="Item">F</div>
    <div class="Item">G</div>
    <div class="Item">H</div>
    <div class="Item">I</div>
    <div class="Item" style="display:none;">J</div>
    <div class="Item">K</div>
    <div class="Item">L</div>
    <div class="Item">M</div>
    <div class="Item">N</div>
</div> 
```

我想出了这个，但这是不对的！

```
$(".Item[style*='display: block']:nth-child(3n)").after("<div class='Clear'></div>"); 
```

有任何想法吗？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:51:15.860

您可以使用`:visible`选择器：

```
$(".Item:visible:nth-child(3n)").after("<div class='Clear'></div>"); 
```

或者：

```
$(".Item:nth-child(3n):visible").after("<div class='Clear'></div>"); 
```

请注意，选择器的顺序很重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:48:50.290

我不确定您是否需要在选择`.Item`元素之前或之后过滤元素。

选择元素后。

```
$(".Item:nth-child(3n)").filter(function(){
     return $(this).css("display") != "none";
}).after("<div class='Clear'></div>"); 
```

@undefined 也有很好的答案。

# javascript - 在主干中填充集合

> ID：13031802
> 
> 赞同：0
> 
> 时间：2012-10-23T13:41:53.100
> 
> 标签：javascript, backbone.js

我有一个骨干集合，我想创建一个填充集合的方法。我发现的是 push 方法，但这需要遍历所有项目：

```
define([
    ...
], function($, _, Backbone, imagesCollection, imageTemplate, gridView) {
    var AppView = Backbone.View.extend({
        el: '#container',
        template: _.template( imageTemplate ),
        events: {
            'click #search': 'search'
        },
        initialize: function() {
            this.input = this.$('#search-term');
        },
        populate: function(data) {
                for (var i=0;i<data.length;i++) {
                    imagesCollection.push(data[i]);
                }
                //IS THERE ANY WAY TO PREVENT ITERATING OVER ALL THE ITEMS?
        },
        search: function() {
            $.ajax({
                type: 'get',
                url: myurl,
                dataType:'jsonp',
                success: function(response){
                    populate(response);
                }
            });
        }
    });

    return AppView;
}); 
```

还有其他解决方案吗？我是骨干新手，所以如果您发现任何问题 - 请告诉我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T14:04:22.193

至少有两种方法可以在不迭代我自己的代码的情况下填充主干集合。

方法**add**（**附加**您传入的模型）

```
populate: function(data) {
    imagesCollection.add(data); // old models will be preserved
} 
```

方法**重置**（将集合中的所有模型**替换**为您提供的新模型）

```
populate: function(data) {
    imagesCollection.reset(data); // new models will erase the old ones
} 
```

请参阅[http://backbonejs.org/#Collection-reset](http://backbonejs.org/#Collection-reset)和[http://backbonejs.org/#Collection-add](http://backbonejs.org/#Collection-add)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-29T14:40:25.733

看起来您想要一种添加模型的方法。最灵活的方法是使用集合现有的**set**方法，传递任何必需的选项

```
populate: function(data, options) {
    imagesCollection.set(data, options);
} 
```

**set**的选项允许您控制集合中已经存在的模型发生的情况（例如，当再次调用 populate 时），主要选项是： `{add: false}`、、`{remove: false}`或`{merge: false}`- 请参阅[http://backbonejs.org/#Collection-set](http://backbonejs.org/#Collection-set) - 这允许您仅更新现有模型 ( `{add:false}`)，更新和添加新模型 ( `{remove: false}`)。默认值`{merge: true}`将合并到您正在添加的模型中，并通过您的数据数组传入。

您也可以使用没有选项的**重置**方法。这不太灵活，但如果您只想清除集合的现有模型并添加您传入的新模型，这是最简单的方法。它与**set**不同，它不会为每个新模型触发“添加”事件这是添加的。根据您的观点如何运作，这可能有益也可能无益。

鉴于您正在编写搜索功能，使用**set**触发的增量添加/删除事件可能对动态更新结果视图很有用（您可以监听集合上的添加和删除事件）。骨干集合还有一个“更新”事件，每组集合更改只触发一次，将由**set**或**add**触发，并可用于在您的视图上触发重新渲染。

# python - 创建一个基于 Python 中的另一列递增的列

> ID：13031803
> 
> 赞同：6
> 
> 时间：2012-10-23T13:41:52.870
> 
> 标签：python, r, pandas, data.table

我目前已将注意力从 R 转移到 Python。我经常在 R 中使用 data.table，我发现有时很难找到 Python 中某些函数的等价物。

我有一个看起来像这样的熊猫数据框：

> df = pd.DataFrame({'A':['abc','def', 'def', 'abc', 'def', 'def','abc'],'B':[13123,45, 1231,463,142131,4839, 4341]})
> 
> > ```
> >  A       B  
> > 0  abc   13123    
> > 1  def      45  
> > 2  def    1231  
> > 3  abc     463  
> > 4  def  142131  
> > 5  def    4839
> > 6  abc    4341 
> > ```

我需要创建一个基于A和B从1递增的列，以便它指示B的递增顺序。所以我首先创建排序数据框，我有兴趣创建的列是C如下：

> ```
>  A       B   C
> 1  abc     463  1
> 6  abc    4341  2
> 0  abc   13123  3
> 3  def      45  1
> 2  def    1231  2
> 5  def    4839  3
> 4  def  142131  4 
> ```

在 R 中，使用 library(data.table)，这可以很容易地在一行中完成，并在原始数据表中创建一个列：

> df[, C := 1:.N, by=A]

我环顾四周，我想我可以利用这样的东西：

> df.groupby('A').size()
> 或
> df['B'].argsort()

但不确定如何从这里开始，以及如何将新列连接回原始数据框。如果有人能给我任何指示，那将非常有帮助。

非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-23T14:17:06.900

```
In [61]: df
Out[61]:
     A       B
1  abc     463
6  abc    4341
0  abc   13123
3  def      45
2  def    1231
5  def    4839
4  def  142131

In [62]: df['C'] =  df.groupby('A')['A'].transform(lambda x: pd.Series(range(1, len(x)+1), index=x.index))

In [63]: df
Out[63]:
     A       B  C
1  abc     463  1
6  abc    4341  2
0  abc   13123  3
3  def      45  1
2  def    1231  2
5  def    4839  3
4  def  142131  4 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T14:35:22.143

为了比较，正确的`data.table`语法是：

```
df[, C := 1:.N, by=A] 
```

这通过引用添加了一个新列`df`C。该`:=`运算符是`data.table`R 包的一部分。它允许您添加和删除列，并按`data.table`组、按引用分配给 的子集，根本没有副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T14:57:02.117

索引魔法似乎是另一种方式：

```
df['C']=df.sort(['A','B'],inplace=True).groupby('A').reset_index().index.labels[1] 
```

# wpf - 验证规则不应触发文本框上的红色背景画笔

> ID：13031808
> 
> 赞同：0
> 
> 时间：2012-10-23T13:42:04.477
> 
> 标签：wpf, validation

我已向 wpf 文本框添加了验证规则。每当验证规则失败时，我都会在单独的文本块中显示错误消息。

此外，作为默认行为，当验证失败时，文本框边框颜色会变为红色。我想删除这种行为。

我已经查看了自定义控件模板和自定义错误模板。我无法删除该行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:52:24.433

[对Meleaks 答案](https://stackoverflow.com/questions/4135955/remove-red-rectangle-around-combobox)的小修改。感谢[威廉](https://stackoverflow.com/users/393879/willem)提供链接。

```
<ControlTemplate x:Key="ComboBoxValidationErrorTamplate">
    <DockPanel>
            <AdornedElementPlaceholder />          
    </DockPanel>
</ControlTemplate> 
```

# delphi - 以小时、分钟、秒为单位的日期时间之间的差异

> ID：13031811
> 
> 赞同：12
> 
> 时间：2012-10-23T13:42:11.650
> 
> 标签：delphi, delphi-2010

我正在尝试获取两个日期时间之间的差异并将其以字符串显示为 hh:mm

```
q.parambyname('vstart').asdatetime:=  vstart;
q.parambyname('vend').asdatetime:= vend;
d:= vend-vstart;
mins:= d * 1440;
q.ParamByName('mins').asBCD:= mins; 
```

目前数据库在几分钟内存储它

示例 (0.39)

然后我想从数据库中获取它并以字符串格式显示它 hh:mm

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-23T14:12:20.610

其中`DateUtils`有一个`MinutesBetween`可以这样使用的功能：

```
m := MinutesBetween(vend,vstart);
yourHMStr := Format('%2.2d:%2.2d',[m div 60,m mod 60]); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-07-13T09:39:31.780

我可以使用以下方法提出这个简单的代码`DateUtils`：

```
DiffTimeStr:= FormatDateTime('hh:nn:ss', TimeEnd - TimeStart); 
```

# c# - 复数瑞典语单词？

> ID：13031813
> 
> 赞同：7
> 
> 时间：2012-10-23T13:42:18.577
> 
> 标签：c#

有没有办法让`PluralizationService`瑞典语单词复数？

我尝试使用 PluralizationService 但我得到了例外，它只支持英语。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T14:55:42.557

您需要创建自己的`PluralizationService`支持瑞典语的版本。创建一个派生类，该类继承`PluralizationService`并覆盖那里的方法以提供功能。似乎没有支持瑞典语的内置服务。完成后，在`EntityModelSchemaGenerator.PluralizationService`属性上设置新服务。

[这篇博](http://blogs.msdn.com/b/efdesign/archive/2008/12/02/pluralization.aspx)文很好地解释了这个过程。

正如您可能知道或可能不知道的那样，在瑞典语中复数单词有点棘手，因为名词有一个基本上不规则的性别系统。例如：

*   猴子->猴子是阿帕->阿波
*   香蕉 -> 香蕉是香蕉 -> 香蕉
*   鹿 -> 鹿是 Hjort -> Hjortar

因此，语言规则需要付出一些努力才能正确，并且到处都有大量的特殊情况，例如 Fot -> Fötter（巧合的是，英语中也有一个特殊情况有 foot -> feet）。

# android - 使用 bundle 在活动之间传递多个数组

> ID：13031815
> 
> 赞同：0
> 
> 时间：2012-10-23T13:42:19.797
> 
> 标签：android, android-activity, bundle

当我调用活动时，我想将数组作为额外的传递，所以我使用了下面的代码：

```
Intent activityIntent = new Intent(getContext(), abc.class);
Bundle bundle = new Bundle();
bundle.putStringArray(EXTRA_MESSAGE_LOCATION, new String[] { "vlaue1" });
activityIntent.putExtras(bundle);
startActivity(activityIntent); 
```

但是有了这个，我一次只能传递一个数组。我可以传递多个数组吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:44:35.260

```
bundle.putStringArray(EXTRA_MESSAGE_LOCATION, new String[] { "vlaue1" }); 
```

bundle 就像一个 HashMap。使用不同的密钥：

```
putStringArray(EXTRA_MESSAGE_LOCATION_2 
```

例如。

# javascript - jQuery 模板不显示内容

> ID：13031817
> 
> 赞同：1
> 
> 时间：2012-10-23T13:42:28.413
> 
> 标签：javascript, jquery, jquery-templates

我一直在尝试学习使用 jQuery Javascript 模板。我在这里学习教程：http: [//net.tutsplus.com/tutorials/javascript-ajax/quick-tip-working-with-the-official-jquery-templating-plugin/](http://net.tutsplus.com/tutorials/javascript-ajax/quick-tip-working-with-the-official-jquery-templating-plugin/)（接收来自推特的推文）。

我相信我已经完美地遵循了代码，我把它放在这里[http://jqupload.herokuapp.com/tmpl](http://jqupload.herokuapp.com/tmpl)

代码在这里。所有脚本/样式表似乎都被正确引用，并且根据教程，代码似乎是正确的。

```
<!DOCTYPE HTML>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <title></title>
      <link rel="stylesheet" href="public/stylesheets/tmpl-style.css" />
      <script src="public/javascripts/jquery-1.6.4.min.js"></script>
      <script src="public/javascripts/jquery.tmpl.js"></script>
   </head>
   <body>
      <h1> Tweets about Nettuts+ </h1>
      <script id="tweets" type="text/x-jquery-tmpl">
         <li>
            <img src="${imgSource}" alt="${username}" />
            <h2> ${username} </h2>
            <p> ${tweet} </p>
            {{if geo}} 
            <span>
               ${geo} 
            </span>
            {{/if}} 
         </li>
      </script>
      <ul id="twitter"></ul>
      <script>
         $.ajax({
            type : 'GET',
            dataType : 'jsonp',
            url : 'http://search.twitter.com/search.json?q=nettuts',
            success : function(tweets) {
               var twitter = $.map(tweets.results, function(obj, index) {
                  return {                      
                     username : obj.from_user,
                     tweet : obj.text,
                     imgSource : obj.profile_image_url,
                     geo : obj.geo
                  };
               });
               $('#tweets').tmpl(twitter).appendTo('#twitter');
            }
      });
      </script>
   </body>
</html> 
```

使用萤火虫我可以看到从 Twitter 接收到正确的信息，但实际上并没有显示推文。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:46:46.330

您的模板中有拼写错误 - 更改

```
alt="${userName}" 
```

到

```
alt="${username}" 
```

没有它，它可能会默默地失败。

它看起来也`${attributes}`以某种方式从您部署的应用程序中删除。

# windows - 如何在薄荷中拯救超级钥匙

> ID：13031821
> 
> 赞同：1
> 
> 时间：2012-10-23T13:42:34.300
> 
> 标签：windows, emacs, cygwin, mintty

最近打算在 Cygwin 中使用 Emacs 和 mintty，因为我发现 mintty 可以完美地代表 256 色。但是，super(win) 键似乎在 mintty 中不起作用，并且其他一些组合键绑定（例如`M-p`，`M-n`在 minibuffer 中）不起作用。

我怎么解决这个问题？请给我一些建议，提前谢谢你。

# html - 嵌套模式

> ID：13031826
> 
> 赞同：4
> 
> 时间：2012-10-23T13:42:48.007
> 
> 标签：html, schema.org

这是我第一次使用[schema.org](http://schema.org)模式，幸运的是，我尝试放入 a 模式的项目并不完全适合。

给你一个想法。我有一种食品，它的营养和过敏细节似乎与[recipy 模式](http://schema.org/Recipe)很好地匹配。然而，我的问题正是这样：它是一种产品，而不是一种配方。

我可以将配方模式嵌入到具有[产品模式](http://schema.org/Product)详细信息的 div 中吗？

IE

```
<div itemtype="http://schema.org/Product">
    <div itemtype="http://schema.org/Recipe">
        <div itemtype="http://schema.org/Nutrition">
            @* Nutrition goes here *@
        </div>
        <div itemtype="http://schema.org/Allergy">
            @* Allergy goes here *@
        </div>
   </div
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T14:22:41.493

你会想要使用[`additionalType`](http://semanticweb.com/schema-org-adds-additional-type-property_b30861)

> 项目的附加类型，通常用于从微数据语法中的外部词汇表中添加更具体的类型。这是事物与事物所在的类之间的关系。在 RDFa 语法中，最好使用原生 RDFa 语法 - 'typeof' 属性 - 用于多种类型。Schema.org 工具可能对额外类型的理解较弱，尤其是那些外部定义的类型。
> 
> 来自[http://schema.org/Recipe](http://schema.org/Recipe)

例子：

```
<div itemscope itemtype="http://schema.org/Product" additionalType="http://schema.org/Recipe">
    <div itemscope itemtype="http://schema.org/Nutrition">
        @* Nutrition goes here *@
    </div>
    <div itemscope itemtype="http://schema.org/Allergy">
        @* Allergy goes here *@
    </div>
</div> 
```

我猜你想这样做是因为你在卖食谱或类似的东西。正如上面的引用所说，Schema.org 工具可能对您使用的原因的理解较弱 `http://schema.org/Product`，`http://schema.org/Recipe`但至少您已经准备好对这种用途的任何可能的理解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-08T23:49:16.853

@尼古拉斯·贾内尔

```
<meta itemprop="additionaltype" content="http://schema.org/Recipe"> 
```

然而，话虽如此，附加属性未被识别。我们现在在我们的网站上使用两个块，它似乎在我们的自然搜索（丰富片段）和谷歌 PLA 的产品页面上按预期工作。例如。

```
<div itemscope itemtype="http://schema.org/Product"></div>
<div itemscope itemtype="http://schema.org/Recipe"></div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-13T09:04:59.363

使用微数据=> 你可以作为 'Josh Davenport' 回答或如下

```
<div itemscope itemtype="http://schema.org/Product">
  <link property="additionalType" href="http://schema.org/Recipe"/>
  <link property="additionalType" href="http://schema.org/X"/>
  <link property="additionalType" href="http://schema.org/Y"/>
  <link property="additionalType" href="http://schema.org/Z"/>
</div> 
```

使用 RDFa

```
<div vocab="https://schema.org/" typeof="Product Recipe X Y Z">

</div> 
```

# eclipse-rcp - 手动触发Eclipse4（e4）类的方法，使用注入？

> ID：13031827
> 
> 赞同：2
> 
> 时间：2012-10-23T13:42:49.760
> 
> 标签：eclipse-rcp, e4

我有一个类，它注入了一个 MApplication 。它是一个处理程序。我想手动触发处理程序的方法。

**问题**：当我从另一个类手动实例化处理程序时 - MApplication 为空。我触发 Handler 的类已经注入了一个 MApplication，所以这不是生命周期问题。

**问题**：如何触发类中具有@Inject 注释方法的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T14:23:29.727

以下成就了这一天。

```
 ManipulateModelhandler man = new ManipulateModelhandler();

    //inject the context into an object
    //IEclipseContext iEclipseContext was injected into this class
    ContextInjectionFactory.inject(man,iEclipseContext);

    man.execute(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T08:51:50.687

更短：

```
ContextInjectionFactory.make(ManipulateModelhandler.class, iEclipseContext).execute(); 
```

或者通过执行独立于其名称的注释方法（框架执行的方式）：

```
ContextInjectionFactory.invoke(new ManipulateModelhandler(), Execute.class, iEclipseContext); 
```

# android - 为 Intent 设置数据

> ID：13031828
> 
> 赞同：0
> 
> 时间：2012-10-23T13:42:50.853
> 
> 标签：android, android-intent

我有一个意图：

```
Intent intentEndGame = new Intent(Class2.this, EndGame.class); 
```

此代码属于 Class2 类。但我想使用 Class1 的类。我试图将代码更改为：

```
Class1 c1 = new Class1;
Intent intentEndGame = new Intent(c1, EndGame.class); 
```

但它不起作用。拜托，你能帮帮我吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:44:41.173

```
Intent intentEndGame = new Intent(Class2.this, EndGame.class);
startActivity(intentEndGame); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:58:30.417

您需要从 class2 调用 class1 吗？为此，您应该使用以下代码：

```
Intent intent=new Intent(class2.this,class1.class);
intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
/* Intent.FLAG_ACTIVITY_CLEAR_TOP If set, and the activity being launched is already running in the current task, then instead of launching a new instance of that activity, all of the other activities on top of it will be closed and this Intent will be delivered to the (now on top) old activity as a new Intent. */

startActivity(intent); 
```

有关 FLAGS 的更多信息，请参阅：有关 FLAGS 的更多信息，请参阅[意图文档](http://developer.android.com/reference/android/content/Intent.html "意向文档")

# php - 功能 delete_img 不起作用

> ID：13031829
> 
> 赞同：1
> 
> 时间：2012-10-23T13:42:52.620
> 
> 标签：php, jquery, file-upload, blueimp

我点击了链接 [https://github.com/blueimp/jQuery-File-Upload/wiki/Working-with-databases](https://github.com/blueimp/jQuery-File-Upload/wiki/Working-with-databases)

除功能外的所有作品`del_img()`

```
function delete_img($delimg)
{
    $delete_from_db = $this->query("DELETE FROM files WHERE file = '$delimg'") or die(mysql_error());
    return $delete_from_db;
} 
```

我不明白为什么它不起作用

# android - Android 网络唤醒

> ID：13031833
> 
> 赞同：1
> 
> 时间：2012-10-23T13:43:01.783
> 
> 标签：android, android-networking, wake-on-lan

我正在尝试编写一个可以唤醒我的计算机的应用程序。我想我有解决方案，但由于某种原因它不起作用。

下面的脚本是一类。那是用 mainactivity 中的 mac 和 broadcastip 调用的：

```
Wake.wakeup(broadcastIP, mac);

public class Wake { 
```

BroadcastIP 和 mac 将是字符串。

```
 public static void wakeup(String broadcastIP, String mac) {
        if (mac == null) {
            return;
        } 
```

包应该算好。

```
 try {
            byte[] macBytes = getMacBytes(mac);
            byte[] bytes = new byte[6 + 16 * macBytes.length];
            for (int i = 0; i < 6; i++) {
                bytes[i] = (byte) 0xff;
            }
            for (int i = 6; i < bytes.length; i += macBytes.length) {
                System.arraycopy(macBytes, 0, bytes, i, macBytes.length);
            }

            InetAddress address = InetAddress.getByName(broadcastIP);
            DatagramPacket packet = new DatagramPacket(bytes, bytes.length, address, 9);
            DatagramSocket socket = new DatagramSocket();
            socket.send(packet);
            socket.close();

        }
        catch (Exception e) {
        }
    } 
```

从mac的转换应该是好的。这在有意唤醒时被调用。

```
 private static byte[] getMacBytes(String macStr) throws IllegalArgumentException {
        byte[] bytes = new byte[6];
        if (macStr.length() != 12)
        {
            throw new IllegalArgumentException("Invalid MAC address...");
        }
        try {
            String hex;
            for (int i = 0; i < 6; i++) {
                hex = macStr.substring(i*2, i*2+2);
                bytes[i] = (byte) Integer.parseInt(hex, 16);
            }
        }
        catch (NumberFormatException e) {
            throw new IllegalArgumentException("Invalid hex digit...");
        }
        return bytes;
    }

} 
```

我很感激你能给我的每一个帮助/提示。

# mongodb - 将用户添加到 mongodb admin DB 使我无法使用 HTTP 管理界面

> ID：13031843
> 
> 赞同：0
> 
> 时间：2012-10-23T13:43:27.547
> 
> 标签：mongodb

我将一个用户添加到全新 MongoDB 安装 (v2.2) 的管理数据库中，现在通常位于[http://mysite.com:28017](http://mysite.com:28017)的监控用户界面需要身份验证；然而，当我使用我刚刚添加的那个用户的凭据进行身份验证时，我仍然被拒绝。将用户添加到管理员还不够吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T14:26:17.287

您是否有任何防火墙设置或端口可供全世界使用（如果它是实际域）。

你是如何运行 mongodb 的？

```
db.serverCmdLineOpts() 
```

也许截图（imgur.com）可能有助于查看错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T03:16:02.937

我通过返回并更仔细地查看[安全和身份验证文档](http://www.mongodb.org/display/DOCS/Security+and+Authentication)解决了这个问题。具体来说，我停止了副本集中的所有服务器，关闭了安全性，从管理数据库中删除了所有用户（这是一个新安装），然后启动了副本集。然后我添加了用户，重新启动了启用安全性的副本集（--keyfile），在 :28017 处点击管理界面，当提示进行身份验证时，成功使用了新创建的管理员凭据。只是需要小心。

# sql - 处理结果以将行显示为列

> ID：13031846
> 
> 赞同：3
> 
> 时间：2012-10-23T13:43:34.300
> 
> 标签：sql, tsql

我有两张桌子。表 A 包含部门列表，共有 20 个。

看图片

![在此处输入图像描述](../Images/07e4fe2cf146352a1e0afbccfa5084ee.png)

表 B 包含表 A 中的每个部门至少 1 行，其中一些包含一些。

看图片

![在此处输入图像描述](../Images/d240d319c74536cffb5c7fe6e354b314.png)

我想要的是从 A & B 创建的第三张表，它基本上列出了每个部门，然后是全职和兼职的人数。例如，如果在表 b 中找到一个部门，该部门只有全职或兼职的数字（例如部门 D），那么我希望该表显示 0（零）而不是将其留空。

看图片

![在此处输入图像描述](../Images/f1765f8558bf332300fbc96e0950f16c.png)

有人可以就此提出建议吗？

**编辑** 如果其中一个部门没有例如“兼职”，这意味着他们的兼职员工人数通常为零。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:49:45.830

你想要一个[PIVOT](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)

```
select *
from (tableb) s
pivot (Max(staffno) for employee_class in ([Full Time],[Part Time])) p 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:49:41.807

试试这个：

```
select A.DEPTNAME, 
       sum(case when B.EMPLOYEE_CLASS='Full time' then B.STAFF_NO else 0) as FullTimeNo,
       sum(case when B.EMPLOYEE_CLASS='Part time' then B.STAFF_NO else 0) as PartTimeNo,
from TabA A
join TabB B on A.DEPTNAME=B.DEPTNAME
group by A.DEPTNAME 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:55:12.653

```
SELECT
  A.DEPTNAME,
  (SELECT COUNT(*) FROM TABLEA A2 INNER JOIN TABLEB B ON B.TableAID = A2.TableAID WHERE B.EMPLOYEE_CLASS = 'Full time' AND A2.TableAID = A.TableAID) FullTimeNo,
  (SELECT COUNT(*) FROM TABLEA A2 INNER JOIN TABLEB B ON B.TableAID = A2.TableAID WHERE B.EMPLOYEE_CLASS = 'Part time' AND A2.TableAID = A.TableAID) PartTimeNo
FROM
  TABLEA 
```

# sql - 如何在 SQL Server 中的日期列中查找平均值

> ID：13031850
> 
> 赞同：25
> 
> 时间：2012-10-23T13:43:51.617
> 
> 标签：sql, sql-server

我有一个包含 5000 条记录的表，其中包含一个日期列。

我如何找到这些日期的平均值。我试过`AVG(datefield)`了，但它说`Operand data type datetime is invalid for avg operator`

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-10-23T13:50:05.277

如果您只想平均日期：

```
SELECT CAST(AVG(CAST(datefield AS INT)) AS DATETIME) FROM dates; 
```

如果你想考虑时间：

```
SELECT CAST(AVG(CAST(datefield AS FLOAT)) AS DATETIME) FROM dates; 
```

请参阅[小提琴](http://sqlfiddle.com/#!6/a32af/1)进行测试。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-23T13:47:33.227

```
CONVERT(DATETIME, AVG(CONVERT(FLOAT, datefield))) as [AverageDate] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-12-13T18:41:20.077

对于那些遇到转换错误的人（无法将日期转换为 int 或 float）......这是一个简单的解决方案，使用`datediff`and`dateadd`

```
SELECT 
DATEADD(DAY, AVG(DATEDIFF(DAY, '1900-01-01', datefield)), '1900-01-01') AS [AverageDate]
FROM dates; 
```

请注意，1900 年 1 月 1 日的日期是任意的，只需在两个地点都相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-09T18:32:20.577

我做了这个，我希望它在未来对其他人有所帮助！SQL 因没有使这更容易而臭名昭著。

```
Declare @Day as int;
Declare @Month as int;
Declare @Year as int;
Declare @Date as varchar(50);
SET @Day = (SELECT AVG(DAY(Column_name)) FROM Table_Name)
SET @Month = (SELECT AVG(MONTH(Column_name)) FROM Table_Name)
SET @Year = (SELECT AVG(YEAR(Column_name)) FROM Table_Name)
SET @Date =  CAST(@Day as varchar) +'-' + CAST(@Month as varchar) + '-' + CAST(@Year as varchar);
SELECT CONVERT(datetime2,@Date,103) 
```

# mysql - Toad for MySQL 访问被拒绝但 Workbench 连接正常

> ID：13031852
> 
> 赞同：3
> 
> 时间：2012-10-23T13:43:56.673
> 
> 标签：mysql, windows-7, toad

我正在尝试使用 TOAD 连接到远程 mysql 服务器，但一直被拒绝访问 'user@laptop-hostname'。

这会让我认为这是一个权限问题，除了我可以毫无问题地与 MYSQL Workbench 连接这一事实。

另一个奇怪的事情是，我可以连接以查看表并使用 TOAD 获取数据库列表，但是当我去做快照或比较时，我得到一个拒绝访问错误。

错误：

`"SELECT command denied to user 'MY-USER'@'MY-LOCAL-HOSTNAME' for table 'db' Quest.Compare.Schema.MySQl.DBModel`

有任何想法吗？

编辑：我还应该提到我可以使用 TOAD 很好地执行查询。似乎是快照和比较的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-12T22:45:01.497

我最近不得不自己解决这个问题。在这种情况下，toad 所指的 DB 表是 mysql 模式的 DB 表。要解决此问题，只需向 MY-USER 添加授予权限，如下所示：

```
GRANT SELECT ON 'mysql'.'db' TO 'my-user'@'my-local-hostname'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T06:43:16.647

因此，错误意味着您可以使用指定的帐户（MySQL 用户）连接到服务器，但用户没有所需的权限。

尝试以 身份连接`root`，并将 SELECT 权限授予用户 'MY-USER'@'MY-LOCAL-HOSTNAME'。您可以授予全局级`SELECT`权限、数据库级或表级权限。例如 -

```
-- Global level
GRANT SELECT ON *.* TO 'MY-USER'@'my-local-hostname';

-- Database level
GRANT SELECT ON <database_name>.* TO 'MY-USER'@'my-local-hostname';

-- Table level
GRANT SELECT ON TABLE <database_name>.<table_name> TO 'MY-USER'@'my-local-hostname'; 
```

然后再次以 'MY-USER'@'my-local-hostname' 身份重新连接。

# c# - Repeater 是否有效绑定可序列化的 DataStructures

> ID：13031865
> 
> 赞同：0
> 
> 时间：2012-10-23T13:44:16.867
> 
> 标签：c#, asp.net

我一直在使用中继器来绑定一个`nested collection`. 基本上我正在做的是，显示网页中的所有元素和值。

我的方法是使用嵌套中继器并在其中绑定`a level below`中继器数据源`current ItemDataBount Event`（请参阅下面的代码）

为每个项目创建控件并使用`Eval`.

考虑到这样一个事实`DataSource is serializable`，这是绑定嵌套集合的有效且最简单的方法吗？

```
<asp:Repeater ID="rpt1" OnItemDataBound="rpt1_ItemDataBound" runat="server">   
    <ItemTemplate>

        <asp:Label ID="lblSomeProperty" Text='<%#Eval("SomeProperty") %>' runat="server" />
        <%--few other controls--%>
        <asp:Repeater ID="rpt2"OnItemDataBound="rpt2_ItemDataBound" runat="server">
            <ItemTemplate>

            <asp:Label ID="Label1" Text='<%#Eval("SomeOtherProperty") %>' runat="server" />
                <asp:Repeater ID="rpt3" runat="server">
                    <ItemTemplate>
                    <asp:Label ID="Label1" Text='<%#Eval("SomeMoreProperty") %>' runat="server" />
                    </ItemTemplate>
                </asp:Repeater>

            </ItemTemplate>
        </asp:Repeater>

    </ItemTemplate>
</asp:Repeater> 
```

**代码隐藏：**

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        rpt1.DataSource = //RootElement IEnumerable
    }
}

protected void rpt1_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    //proceed only if ItemTemplate OR AlternatingItemTemplate

    //populate user control values from DataItem in current context
    var rpt2 = e.Item.FindControl("rpt2") as Repeater;
    rpt2.DataSource = //Child Level1 IEnumerable
}

protected void rpt2_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    //bind rpt3 DataSource
} 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:50:12.363

我想说你的实现是完全可行的，而且效率很高。这是处理您的方案的“.NET 方式”，使用中继器来显示模板化的信息集合，无论这是数据的主要集合还是子集合。

对于未来的开发人员来说，弄清楚发生了什么也很容易，而不是让事情变得过于复杂。无论如何，这就是我处理您的方案的方式，除非有任何进一步的业务需求涉及我扩展中继器控件并使用它。无需在不需要的情况下过度复杂化场景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T14:16:26.690

如果数据源是可序列化的，那么您绝对应该考虑使用[ListViews](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listview.aspx) (MSDN) 而不是中继器来显示您的数据。使用 ListViews，您可以以声明方式绑定数据源，而无需编写任何代码隐藏。您将能够有效地消除用于绑定每个中继器的所有 C# 代码。

请查看此[StackOverflow 答案](https://stackoverflow.com/a/6754987/1762489)，以获取有关如何执行此操作的详细说明。

关键是在每个嵌套 ListView 内的标记中设置 DataSource

# c++ - Visual C++ 数组文字

> ID：13031873
> 
> 赞同：1
> 
> 时间：2012-10-23T13:44:26.680
> 
> 标签：c++, arrays, visual-studio-2010, visual-c++, literals

我在 Windows 中工作，我想通过 netbeans 创建我的程序，所以我需要通过 cygwin 使用 linux 编译器。到目前为止，我已经能够`int`像这样使用 s 的文字数组：

```
int x[6] = {1, 2, 3, 4, 5, 6} 
```

或在方法中

```
methodName({1, 2, 3, 4, 5, 6}) 
```

我最近换到了视觉工作室，但我不被允许这样做。有替代方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T14:49:06.290

```
int x[6] = {1, 2, 3, 4, 5, 6} 
```

MSVC2010 已经支持这种语法

```
methodName({1, 2, 3, 4, 5, 6}) 
```

但这不受支持。如上所述，它仅对“int const (&)[6]”函数参数有意义。

Intead 您可以使用以下语法：

```
methodName(make_array(1,2,3,4,5,6)); 
```

[示例实现](http://ideone.com/MZ2T6c)：

```
#include <iostream>
#include <ostream>

using namespace std;

template<typename T,unsigned size>
struct Array
{
    typedef T type[size];
    mutable type data;
    Array()
    {
        cout << "Array::Array" << endl;
    }
    ~Array()
    {
        cout << "Array::~Array" << endl;
    }
};

template<typename T> inline
typename Array<T,1>::type &make_array(const T &p1,const Array<T,1> &aux=Array<T,1>())
{
    aux.data[0]=p1;
    return aux.data;
}

template<typename T> inline
typename Array<T,2>::type &make_array(const T &p1,const T &p2,const Array<T,2> &aux=Array<T,2>())
{
    aux.data[0]=p1;
    aux.data[1]=p2;
    return aux.data;
}

template<typename T> inline
typename Array<T,3>::type &make_array(const T &p1,const T &p2,const T &p3,const Array<T,3> &aux=Array<T,3>())
{
    aux.data[0]=p1;
    aux.data[1]=p2;
    aux.data[2]=p3;
    return aux.data;
}

// ...

void test_array(int (&p)[3])
{
    cout << p[0] << " " << p[1] << " " << p[2] << endl;
}

void test_ptr(int *p)
{
    cout << p[0] << " " << p[1] << " " << p[2] << endl;
}

int main(int argc,char *argv[])
{
    test_array(make_array(33,22,11));
    test_ptr(make_array(33,22,11));
    return 0;
} 
```

或者，[在 Boost.Preprocessor 的帮助下](http://ideone.com/t42DIm)：

```
#include <iostream>
#include <ostream>
using namespace std;

// ______________________________________________________________

template<typename T,unsigned size>
struct Array
{
    typedef T type[size];
    mutable type values;
    Array()
    {
        cout << "Array::Array" << endl;
    }
    ~Array()
    {
        cout << "Array::~Array" << endl;
    }
};

#include <boost/preprocessor/iteration/local.hpp>
#include <boost/preprocessor/repetition/enum.hpp>
#include <boost/preprocessor/repetition/repeat.hpp>

#define MAKE_ARRAY_PP_MAX_ARG_COUNT 16

#define MAKE_ARRAY_PP_PARAM_LIST(z, n, data) const T & BOOST_PP_CAT(p, n)
#define MAKE_ARRAY_PP_PARAM_ASSIGN(z, n, data) aux.values[n] = BOOST_PP_CAT(p, n);

#define BOOST_PP_LOCAL_MACRO(n) \
template<typename T> inline \
typename Array<T,n>::type &make_array(BOOST_PP_ENUM(n, MAKE_ARRAY_PP_PARAM_LIST, _) , const Array<T,n> &aux=Array<T,n>()) \
{ \
    BOOST_PP_REPEAT(n, MAKE_ARRAY_PP_PARAM_ASSIGN, _) \
    return aux.values; \
} \
/**/
#define BOOST_PP_LOCAL_LIMITS (1, MAKE_ARRAY_PP_MAX_ARG_COUNT)
#include BOOST_PP_LOCAL_ITERATE()

// ______________________________________________________________

void test_array(int (&p)[3])
{
    cout << p[0] << " " << p[1] << " " << p[2] << endl;
}

void test_ptr(int *p)
{
    cout << p[0] << " " << p[1] << " " << p[2] << endl;
}

int main(int argc,char *argv[])
{
    test_array(make_array(33,22,11));
    test_ptr(make_array(33,22,11));
    make_array(33,22,11,00,55,44,66);
    make_array(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16);
    return 0;
} 
```

# android - 处理 QR 码的 Android 应用程序（扫描+自定义操作）

> ID：13031874
> 
> 赞同：2
> 
> 时间：2012-10-23T13:44:27.513
> 
> 标签：android, qr-code

我在工作中使用供应商生成的二维码。实际上，我需要通过网站手动记录所有这些项目。

二维码包含所有数据，所以我想创建一个自动执行操作的应用程序。

例如，二维码显示“AAA|BBB|CCC|123”。我想要一个读取它的应用程序，并将用户浏览器重定向到一个 URL：[http](http://myserver.com/qr?data=AAA|BBB|CCC|123) ://myserver.com/qr?data=AAA|BBB|CCC|123 “。我将在服务器端进行处理并输出结果页面作为 html 页面。

有哪些方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:53:33.517

[zxing](http://code.google.com/p/zxing/)拥有您想要的一切。您可以以简单的意图启动应用程序

```
Intent intent = new Intent("com.google.zxing.client.android.SCAN");
intent.putExtra("SCAN_MODE", "QR_CODE_MODE");
startActivityForResult(intent, MAIN_ZXING); 
```

或者，您可以使用他们的自定义意图，如果设备上缺少应用程序，将提示用户安装他们的应用程序。

无论 QR 码扫描什么返回到您的应用程序，您只需要设置重定向。

# validation - 如何验证 CIM RDF

> ID：13031879
> 
> 赞同：3
> 
> 时间：2012-10-23T13:44:41.550
> 
> 标签：validation, rdf, rdfs

我正在使用通用信息模型，我们正在使用 RDF 文件来表示变电站。但是我发现使用您的 RDF Schema 验证文件 RDF 时存在一些问题。我需要帮助解决这个问题。有人知道如何使用 JAVA 来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T13:08:34.683

我将首先指出我对公共信息模型一无所知，而且我一般是针对 RDF、RDFS 和“验证”...

解析有效是非常容易的，所以我假设这不是你的意思。我的猜测是您来自 XML，并且您认为 RDFS 是 RDF，就像 XML 模式对于 XML 文档一样。

它不是。

你必须记住，如果你为一个属性指定了两个范围（我们称它们为 A 和 B），这并不意味着该属性的值*应该*是 A 或 B。它实际上意味着它们是两者，即 A 和 B 的交集。域的工作方式类似，没有什么可以阻止您使用规定域/范围之外的值。因此，您可能需要小心您对验证的期望。

此外，如果您开始冒险进入 OWL 世界，您会增加对模式（也称为本体）的一致性及其可满足性的关注。这些与数据的有效性一样有效。

更不用说在 OWL 中很难验证一张桌子有 4 条腿的限制。您可以定义三个腿并假设它是有效的；只有第四条腿系统还不知道。同样，如果您定义五条腿，它将假定其中两条腿可能相同，因此它并非严格无效。

如果您想使用 RDFS 或真正的 OWL 作为约束语言，您可能想要查看的是[Pellet 的 Integrity Constraint Validator (ICV)](http://clarkparsia.com/pellet/icv/)。它允许您使用 OWL 作为语言来形式化模式对数据施加的约束。它通过稍微改变 OWL 的语义来使它更适合这个用例来做到这一点。该软件实际上已被移植到[Stardog](http://stardog.com/docs/sdp/)上，它可以与数据库中的事务支持相结合以保持数据完整性。Stardog 站点还参考了如何评估完整性约束的形式语义，如果您有足够的好奇心来进一步研究定义。

除此之外，假设这是您感兴趣的验证类型，您将需要定制软件来为您进行验证。或者您可以查看一个与 ICV 类似但功能较少（正式）的软件，称为[Jena Eyeball](http://jena.sourceforge.net/Eyeball/) .

# c++ - C++ 中的继承和接口

> ID：13031880
> 
> 赞同：3
> 
> 时间：2012-10-23T13:44:43.827
> 
> 标签：c++, inheritance, interface

多年来，我一直在兜圈子，试图在 C++ 中正确实现继承，而 Google 并没有真正提供帮助。我有工作 Java 代码，我正在移植到严重依赖接口的 C++。

我正在为一些遗传算法编写一个测试平台，所以我需要通用变量，允许该类的任何类型与它们相关联，允许执行相同的功能，而不管具体类型如何。例如，我需要一个“交叉”类型，它允许将任何类型的交叉存储在变量中，并允许对其执行相同的交叉方法集。

我用纯虚函数“performCrossover”创建了一个接口。然后由通用“交叉”类继承，然后由各个交叉类型继承。

目前，链接器抱怨我正在重新定义“problem::performCrossover”，但这正是我所需要的。我可以通过在通用交叉类中使函数纯虚拟来解决这个问题，但是我无法实例化它，这又正是我所需要的。

我也尝试过更改它“crossovername::performCrossover”，但后来我得到“不允许继承的成员”。这就是我现在的位置。

我的界面：

```
class crossoverinterface {
public:
    virtual genome** performCrossover(genome* firstParent, genome* secondParent) = 0;
}; 
```

我需要能够用任何类型的交叉实例化的通用交叉类型。

```
class crossover: public crossoverinterface{ 
public:
    crossover() {};
    crossover(int genomeLength, int nObjectives);
    ~crossover();

    genome** preCrossover(genome* firstParent, genome* secondParent);
    virtual genome** performCrossover(genome* firstParent, genome* secondParent);

private:
    genome** solution;
    int genomeLength;
    int nObjectives;
}; 
```

子类 1 的示例：

```
class simulatedbinarycrossover: public crossover {
public:
    simulatedbinarycrossover(int genomeLength, int nObjectives, double lowerBound, double upperBound);
};

genome** simulatedbinarycrossover::performCrossover(genome* firstParent, genome* secondParent){
    ...code...
} 
```

最后是错误：“performCrossover”：成员函数未在 'simulatedbinarycrossover' 中声明” Intellisense 将其称为“不允许继承的成员”。

希望我说得有道理，尝试和描述这是一个非常棘手的问题。

欢迎所有建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-23T13:46:31.650

您必须在实例化它的每个类定义中编写方法原型。

在基类中定义的事实`performCrossover`并不意味着您不必在派生类中再次定义它。

```
class simulatedbinarycrossover: public crossover {
public:
    simulatedbinarycrossover(int genomeLength, int nObjectives, double lowerBound, double upperBound);

    genome** performCrossover(genome* firstParent, genome* secondParent) ;
};

genome** simulatedbinarycrossover::performCrossover(genome* firstParent, genome* secondParent){
    ...code...
} 
```

# jsf - JSF/PrimeFaces 中的单页主详细信息

> ID：13031885
> 
> 赞同：4
> 
> 时间：2012-10-23T13:44:58.283
> 
> 标签：jsf, jpa, primefaces, master-detail

我很想知道在**JSF-PrimeFaces / JPA**堆栈中实现**单页主从**视图有哪些好的模式。似乎网络上的大多数材料和教程都只是在讨论相当琐碎的“每个视图一个表”模式。

 **但我对诸如在数据库中有**CUSTOMER**和**ORDER**表以及一个**xhtml**页面感兴趣，您可以在其中查看上半部分的客户（例如**p:datatable**）和下半部分当前选定客户的订单（再次作为**p:datatable**）。我不清楚如何最好地组织 JSF/PrimeFaces/backing bean 和外观/实体/JPA 代码，以一种普遍适用的方式实现上述目标，并最大限度地重用代码。例如

1.  我应该为整个**xhtml**视图定义一个支持 bean，还是为视图的每个组件（主/详细信息）定义两个支持 bean？
2.  可以将模式推广到多个明细表（在同一级别）吗？例如，在上半部分有一个**CUSTOMER**表的视图，在下半部分有一个选项卡式视图，分别由**ORDER**和**PAYMENT 明细表**的两个视图组成（两者都与表**CUSTOMER存在 N-1 关系**
3.  模式是否可以推广到多个详细级别（例如，在同一页面上有**CUSTOMER**、**INVOICE**和**INVOICELINE**表的视图。
4.  提议的模式也能轻松适应修改。例如，使用可编辑的数据表可以更改客户详细信息并删除订单并使用*提交更改*按钮一次性完成这两项更改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-10-09T09:56:02.187

对于最近的培训课程，我们构建了以下 proofOfConcept。我们创建了一个包含两个表的单个视图，一个主（部门）表和一个详细（员工）表。该视图由两个使用 cdi 事件进行通信的控制器 bean 支持。proofOfConcept 被部署到一个 jee6 容器（glassfish 3.1.1）。

这个想法是，每当您单击部门行时，ajax-Listener 都会触发一个 cdi-Event 来更新详细信息控制器并作为回报更新详细信息表。这种模式可以扩展到多个明细表或多个主-从-明细级别。

为了编辑您的实体，我建议打开一个编辑器对话框，例如在表格的每一行中添加一个编辑器按钮。要添加新的详细信息，请使用表格页脚中的 add-Actions 并使用新实体打开编辑器对话框。在您的编辑器对话框中的“确定”上，您再次使用新实体触发一个 cdi 事件以更新依赖的详细信息表。要保存您的工作，请使用单个“提交”按钮，它可以保存主实体。在训练中，我们将 jpa 与正确定义的实体一起使用，尤其是在 @OneToMany 关系中使用 orphanRemoval=true 属性。

视图（scott.xhtml）：

```
<p:panel id="deptPanel" header="Departements">
    <p:dataTable id="deptTable" var="dept" value="#{deptUiController.departements}"
                 selectionMode="single" rowKey="#{dept.id}">
        <p:ajax event="rowSelect" listener="#{deptUiController.onRowSelect}" update="@form"/>
        <p:column headerText="Name">
            <h:outputText id="name" value="#{dept.dname}"/>
        </p:column>
        <p:column headerText="Location">
            <h:outputText id="loc" value="#{dept.loc}"/>
        </p:column>
        <p:column headerText="# of Emps">
            <h:outputText id="size" value="#{dept.emps.size()}"/>
        </p:column>
    </p:dataTable>
</p:panel>
<p:panel id="empPanel" header="Employees in departement #{deptUiController.currentDept.dname}">
    <p:dataTable id="empTable" var="emp" value="#{empUiController.employees}">
        <p:column headerText="Name">
            <h:outputText id="name" value="#{emp.ename}"/>
        </p:column>
        <p:column headerText="Job">
            <h:outputText id="job" value="#{emp.job}"/>
        </p:column>
        <p:column headerText="Hiredate">
            <h:outputFormat id="hiredate" value="{0,date,dd.MM.yyyy}">
                <f:param value="#{emp.hiredate}"/>
            </h:outputFormat>
        </p:column>
    </p:dataTable>
</p:panel> 
```

主控制器：

```
@Named
@SessionScoped
public class DeptUiController implements Serializable {

    private boolean initialized = false;

    @EJB
    private ScottCRUD crudEJB;

    private List<Departement> departements;

    private Departement currentDept;

    public void populateData() {
        if ( !initialized ) {
            departements = crudEJB.findAllDepartements();
            currentDept =  departements.isEmpty() ? null : departements.get(0);
            initialized = true;
            fireDeptChange();
        }
    }

    @Inject
    private Event<Departement> deptChangeEvt;

    private void fireDeptChange() {
        deptChangeEvt.fire( currentDept );
    }

    public void onRowSelect(SelectEvent event) {
        currentDept = (Departement) event.getObject();
        fireDeptChange();
    }

    ... getter, setter, more actions...

} 
```

细节控制器

```
@Named
@SessionScoped
public class EmpUiController implements Serializable {

    private List<Employee> employees;

    private Employee currentEmp;

    private void populateData(Departement master) {
        if ( master==null ) {
            employees = Collections.emptyList();
        } else {
            employees = master.getEmps();
        }
        currentEmp =  employees.isEmpty() ? null : employees.get(0);
    }

    public void observeDeptChanged( @Observes Departement master ) {
        populateData( master );
    }

    ... getter, setter, more actions...

} 
```**

# python - Python 并发性能

> ID：13031886
> 
> 赞同：0
> 
> 时间：2012-10-23T13:45:05.277
> 
> 标签：python, multithreading, performance, concurrency, parallel-processing

我第一次在 Python 中遇到并发问题，我的目标是优化我的脚本。基本上我有一个脚本，它使用 os.system 针对某些文件调用第三方 jar 工具。我的第一个“程序”版本大约需要 135 秒才能完成，在使用线程（**threading.Thread**和**threading.Queue**）127 之后，现在切换到多进程（**multiprocessing.Process**和**multiprocessing.JoinableQueue**）113 秒......但仍然很多时间......你能给我一些反馈和/或给我指出一篇可以解决我的问题的文章吗？

（我使用的是 Python 2.7.1，我想避免使用 3d 派对模块）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T14:52:46.423

许多人似乎认为多线程会“神奇地”加速他们的应用程序。多线程可能带来的性能提升取决于几个因素：主要是 CPU 内核的数量和应用程序的类型。

当我说“应用程序类型”时，我指的是将您的应用程序分成多个部分并并行执行是否有意义。你没有提供足够的信息让我们能够确定，但你应该分析它并尝试确定它是否有意义。

今天的大多数 CPU 都是多核的，因此线程不应受此约束，除非您创建的线程多于内核，因此请注意创建的线程数量。

如果您想知道为什么多处理（分叉进程）比线程更快，这很可能是由于 Python[全局解释器锁](http://wiki.python.org/moin/GlobalInterpreterLock)(GIL) 导致 Python 多线程性能不佳。

**更新：**如果您正在编译（基于您的评论：“我正在使用 Google Closure JavaScript 编译器”）并且想要坚持使用 Python，您应该尝试[SCons](http://www.scons.org/)。它是一个非常酷的构建工具，它的构建脚本都是 Python 的。

# javascript - 第一个中间名 javascript

> ID：13031889
> 
> 赞同：1
> 
> 时间：2012-10-23T13:45:14.643
> 
> 标签：javascript

在 Javascript 中，我试图采用输入到字段中的全名（名字、中间名和姓氏），一旦单击提交按钮，输出到三个单独的字段字符长度、中间名和 3 个首字母。到目前为止，我已经进入了字符字段，但我对如何获取两个空格之间的信息感到困惑。

```
// strings.js
// This script takes a name and spits out its character length with initials.

// Function called when the form is submitted.
// Function performs the calculation and returns false.
function formatNames() {
'use strict';

// For storing the Full Name, Middle name, initials, length:
var lengthName;
var middleName;
var yourInitials;

// Get a reference to the form values:
var fullName = document.getElementById('fullName').value;

// Perform the character spit out:
lengthName = fullName.length;

// Pull out the middle name:

// Display the volume:
document.getElementById('nameLength').value = lengthName;

// Return false to prevent submission:
return false;

} // End of formatNames() function.

// Function called when the window has been loaded.
// Function needs to add an event listener to the form.
function init() {
'use strict';
document.getElementById('theForm').onsubmit = formatNames;
} // End of init() function.
window.onload = init; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:58:14.143

这听起来像是家庭作业，所以我会给你一些提示，而不会破坏学习体验。

您可以[`split(' ')`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split)在字符串上使用来获取该字符串中的单词数组（由空格分隔）。

您可以[`charAt(0)`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/charAt)在字符串上使用来获取字符串的第一个字母。

# php - 共享主机上 ssh2_connect 的解决方法

> ID：13031893
> 
> 赞同：0
> 
> 时间：2012-10-23T13:45:24.380
> 
> 标签：php, ssh

我正在尝试连接以与 PHP 建立 SSH 连接，我的托管公司说我们不允许在共享服务器上进行 SSH 连接。所以有什么解决方法，我可以使用其他一些功能来连接。

```
 <?php

    if (!function_exists("ssh2_connect")) die("function ssh2_connect doesn't exist");
    // log in at server1.example.com on port 22
    if(!($con = ssh2_connect("server5500.asd.com", 22))){
        echo "fail: unable to establish connection\n";
    } else {
        // try to authenticate with username root, password secretpassword
        if(!ssh2_auth_password($con, "asd", "gh45@asd")) {
            echo "fail: unable to authenticate\n";
        } else {
            // allright, we're in!
            echo "okay: logged in...\n";

            // execute a command
            if (!($stream = ssh2_exec($con, "ls -al" ))) {
                echo "fail: unable to execute command\n";
            } else {
                // collect returning data from command
                stream_set_blocking($stream, true);
                $data = "";
                while ($buf = fread($stream,4096)) {
                    $data .= $buf;
                }
                fclose($stream);
            }
        }
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T22:13:16.583

试试[phpseclib，一个纯 PHP SSH 实现](http://phpseclib.sourceforge.net)。例如。

```
<?php
include('Net/SSH2.php');

$ssh = new Net_SSH2("server5500.asd.com");
if (!$ssh->login("asd", "gh45@asd")) {
    exit('Login Failed');
}

echo $ssh->exec('ls -la');
?> 
```

# c# - 使用验证器验证从 excel 文件上传到 gridview 的数据

> ID：13031895
> 
> 赞同：0
> 
> 时间：2012-10-23T13:45:26.987
> 
> 标签：c#, asp.net, validation

我有一个从用户上传的excel文件填充的gridview。代码：

```
<asp:GridView ID="gvData" runat="server" SkinID="GridView" Width="100%" AllowPaging="True" AllowSorting="false"
                EmptyDataText="Data not found." AutoGenerateColumns="false" AutoGenerateEditButton="true" AutoGenerateDeleteButton="true" 
                OnRowEditing="gvData_RowEditing" OnRowCancelingEdit="gvData_RowCancelingEdit" OnRowUpdating="gvData_RowUpdating" OnRowDeleting="gvData_RowDeleting"> 
                <Columns>
                <asp:TemplateField HeaderText="Date" HeaderStyle-ForeColor="White">
                    <ItemTemplate>
                        <asp:Label ID="lblDate" runat="server" Text='<%#Eval("Date", "{0:MM/dd/yyyy}")%>'/>
                    </ItemTemplate>
                    <EditItemTemplate>
                        <asp:TextBox ID="txtDate" runat="server" Text='<%#Eval("Date", "{0:MM/dd/yyyy}")%>'  CssClass="datepicker"/>
                        <asp:RequiredFieldValidator ID="rfvDate" runat="server" CssClass="validator"  ErrorMessage="Required" Display="Dynamic"  ControlToValidate="txtDate"/>
                        <asp:CompareValidator id="dateValidator" runat="server" CssClass="validator" Type="Date" Operator="DataTypeCheck" ControlToValidate="txtDate" ErrorMessage="Please enter a valid date."/>
                    </EditItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField HeaderText="Ref Number" HeaderStyle-ForeColor="White">
                    <ItemTemplate>
                        <asp:Label ID="lblRefNumber" runat="server" Text='<%#Eval("Ref Number")%>' />
                    </ItemTemplate>
                    <EditItemTemplate>
                        <asp:TextBox ID="txtRefNumber" runat="server" Text='<%#Eval("Ref Number")%>' />
                        <asp:RegularExpressionValidator ID="revRefNumber" runat="server" ControlToValidate="txtRefNumber" CssClass="validator" Display="Dynamic" ErrorMessage="Numbers only"
                            ValidationExpression="^[0-9]+$"/>
                    </EditItemTemplate>
                </asp:TemplateField>
</Columns>
</asp:GridView> 
```

正如你所看到的，我在每个字段上都没有几个验证器，它们只有在相关文本框被编辑时才会起作用。例如，在用户完成编辑后，我确保日期列中的文本框包含有效的日期值。问题是，当数据首次从 excel 文件上传时，用户可以将任何数据插入这些单元格 - 验证器完全“绕过”。

我想知道是否有办法对上传的数据应用和强制执行这些验证器。

# objective-c - 简单的 OS X 视图控制器

> ID：13031897
> 
> 赞同：1
> 
> 时间：2012-10-23T13:45:30.573
> 
> 标签：objective-c, macos, cocoa, operating-system

我已经做了几年的 iphone 开发人员，并试图学习 mac os x 编程。

该应用程序非常简单。流程就像 Finder 应用程序。左侧是 NSTableView，右侧是“body”视图，在 tableView 中选择单元格后，它将加载到不同的视图控制器中。

所以我有一个主视图，其中有两个 NSView。

我试图弄清楚在左视图中选择单元格后如何在右视图中加载不同的视图控制器。

我创建了控制主视图的 AppController.h 类。

我的第一个想法是让 AppController 成为单例，并让左视图调用该类中的方法。像这样的东西：

```
- (void)changeViewControllerInRightView:(int)whichView; 
```

但由于我在界面构建器中构建应用程序，并将 AppController 作为 NSObject，我不太确定如何使用单例来解决它。

这样做的流程是什么？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:52:59.333

将您的实例保存在您的 App Delegate 的属性中。而应用程序委托实例就是这样一个单例。

首先在您的应用程序委托中为您的 AppController 实例创建一个 IBOutlet。然后将您的 AppController 从 Interface Builder（右键单击 AppController，拖动“新建引用插座”）连接到头文件中的此 IBOutlet 属性行（通常显示在助手编辑器中，拖放可以帮助您创建属性，如果还不存在）。

# c# - 读取 00 字节后停止 Readchars/readbytes

> ID：13031900
> 
> 赞同：0
> 
> 时间：2012-10-23T13:45:34.550
> 
> 标签：c#, char, byte

遇到00字节时有没有办法停止`BinaRyreader.readchars()`/ ？`BinaryReader.readbytes()`谢谢你。

样本：

```
for (int i = 0x88; i <= num_pointers; i += 0x50)
            {
                br.BaseStream.Position = i;
                listView1.Items.Add(br.ReadBytes(21).ToString());
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T14:14:55.877

我很想使用 ReadByte 而不是 ReadBytes。

然后添加一个内部循环，这样您一次只读取一个字节，而不是分块读取。使用 while 循环，以便您继续阅读，直到您刚刚阅读的值为 0x0。

# unit-testing - 如何模拟测试 REST 客户端？

> ID：13031901
> 
> 赞同：2
> 
> 时间：2012-10-23T13:45:38.187
> 
> 标签：unit-testing, rest, mocking, mockito

我有一个正在尝试测试的 Rest 服务客户端。这是我要测试的客户端方法：

```
public RestPriceRow getPriceRow(String customer, String product, String qt)
    throws Exception {
    // Prepare acceptable media type
    List<MediaType> acceptableMediaTypes = new ArrayList<MediaType>();
    acceptableMediaTypes.add(MediaType.APPLICATION_XML);

    // Prepare header
    HttpHeaders headers = new HttpHeaders();
    headers.setAccept(acceptableMediaTypes);
    HttpEntity<PriceRowDto> entity = new HttpEntity<PriceRowDto>(headers);

    // Prepare response
    RestPriceRow res = new RestPriceRow();

    // Send the request as GET
    try {
        ResponseEntity<PriceRowDto> result =
          restTemplate.exchange(baseURL + "{customerId}/{productId}/{quantity}",
          HttpMethod.GET, entity, PriceRowDto.class, customer,product,qt);
        PriceRowDto response = result.getBody();
        return response;
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

这是我的测试课：

```
@Before
public void setUp() {
    RestTemplate r = mock(RestTemplate.class);
    restPriceService = new RestPriceServiceImpl();
    restPriceService.setRestTemplate(r);
    restPriceService.setBaseURL("url");
}

@Test
public void prueba() {
    PriceRowDto r = new PriceRowDto("100","200","9","10","0","19/11/2012");
    try {
        when(restPriceService.getPriceRow("100","200","16")).thenReturn(r);
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

我的问题是，当我运行这个测试时，它会`NullPointerException`在执行时抛出一个`result.getBody()`. （结果为空）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T14:03:00.347

您将 SUT（被测系统）与模拟的协作者混为一谈。SUT 是您测试的方法。协作者根据 SUT 工作的需要进行操作并返回数据。

1.  `RestPriceService`调用您要测试的实例`sut`：**TODO**
2.  模拟`restTemplate`：**好的**
3.  给这个模拟起一个名字，让它像这样突出`restTemplateMock`：**TODO**
4.  设置它`sut`：**好的**
5.  用途`when(restTemplateMock.exchange(...).thenReturn(r)`：**待办事项**
6.  呼叫`sut.getPriceRow`：**待办事项**
7.  验证`RestPriceRow`此调用返回的是否正确：**TODO**
8.  验证`restTemplateMock`：**待办事项**

**编辑：**

如果您想阅读一本关于不同形式的单元测试的*非常好的书，我可以推荐*[XUnit Test Patterns](http://xunitpatterns.com/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T14:02:06.777

所以这里有两个问题。如果您想测试 REST 接口，即进行调用并查看结果并检查，我建议使用 Jersey Test 框架。它在测试服务器上运行，可以节省大量工作。（假设您使用的是泽西岛。）

[http://jersey.java.net/nonav/documentation/latest/test-framework.html](http://jersey.java.net/nonav/documentation/latest/test-framework.html)

但是如果你只想测试服务层，你可以编写普通的junit测试。

# javascript - 检查用户输入是否有效

> ID：13031907
> 
> 赞同：0
> 
> 时间：2012-10-23T13:45:55.587
> 
> 标签：javascript, jquery, validation, knockout.js

我正在使用 knockout.js 和 knockout.validation。我创建了一个书籍视图模型，其中包含书籍作者姓名和书籍名称的 2 个属性：

```
function BookViewModel(bookObject) {
        var self = this;
        self.AuthorName = ko.observable(bookObject.AuthorName)
            .extend({
                required: { message: "Please enter menu name" },
                minLength: 4,
                maxLength: 10
            });
        self.Name = ko.observable(bookObject.Name)
            .extend({
                required: { message: "Please enter course name" },
                minLength: 4,
                maxLength: 10
            });
} 
```

我已经对属性应用了本机验证规则。现在我知道我们可以通过以下方式检查属性值是否有效：

```
 bookViewModelObject.AuthorName.isValid() 
```

现在通过上面的语句我们可以检查用户输入的作者姓名是否满足我们的验证规则。我的问题是如何在单个语句中检查 bookViewModel 的所有属性是否有效？意思是这样的：

```
 bookViewModelObject.isValid() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T14:09:02.230

您可以使用`ko.validation.group`：

```
var viewModel = new BookViewModel(data);
viewModel.errors = ko.validation.group(viewModel); 
```

在`viewModel.errors`您将有许多错误`viewModel`。

这是一个小提琴：http: [//jsfiddle.net/vyshniakov/3J3qV/](http://jsfiddle.net/vyshniakov/3J3qV/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-17T17:35:46.653

不确定这是否可行，但现在（使用 KnockoutJS 3.0 和验证插件 2.1）你可以做到这一点，即。

```
ko.validation.init();
var validatedViewModel = ko.validatedObservable(new BookViewModel(book))();
ko.applyBindings(validatedViewModel);

validatedViewModel.isValid(); 
```

注意`ko.validatedObservable()`方法。

这是适当的[jsfiddle](http://jsfiddle.net/LGyT6/1/)。

# mysql - 为结果集中的每个 id 获取 n 行 MYSQL

> ID：13031910
> 
> 赞同：3
> 
> 时间：2012-10-23T13:46:13.223
> 
> 标签：mysql, greatest-n-per-group

我有一个查询，它以这样的降序返回结果。

```
 comment     postid      name      userid    tempid
  ----------------------------------------------------- 
    c1          199        User1      123321    1
    c2          199        User1      123321    2
    c3          199        User1      123321    3
    c4          199        User1      123321    4
    c5          199        User1      123321    5
    c6          199        User1      123321    6
    c7          198        User1      123321    7
    c8          198        User1      123321    8
    c9          198        User1      123321    9
    c10         197        User1      123321    10
    c11         197        User1      123321    11
    c12         197        User1      123321    12
    c13         197        User1      123321    13
    c14         197        User1      123321    13
    c15         197        User1      123321    13
    c16         197        User1      123321    13 
```

现在我想为每个选择前 5 条记录`postid`。期望的结果应该是

```
 comment     postid      name      userid    tempid
  ----------------------------------------------------- 
    c1          199        User1      123321    1
    c2          199        User1      123321    2
    c3          199        User1      123321    3
    c4          199        User1      123321    4
    c5          199        User1      123321    5
    c7          198        User1      123321    7
    c8          198        User1      123321    8
    c9          198        User1      123321    9
    c10         197        User1      123321    10
    c11         197        User1      123321    11
    c12         197        User1      123321    12
    c13         197        User1      123321    13
    c14         197        User1      123321    13 
```

这是我的查询。

```
 DECLARE rangee INT;
 DECLARE uid BIGINT;

 SET @rangee = plimitRange * 10; 
 SET @uid    = puserid;

PREPARE STMT FROM
'
SELECT comments.comment,comments.postid,user.name,comments.userid,comments.tempid 
FROM
user
INNER JOIN comments ON user.userid=comments.userid
INNER JOIN posts ON posts.postID = comments.postid
 WHERE 
comments.postid <=  
(SELECT MAX(postid) FROM
 (
  SELECT wall.postid FROM wall,posts WHERE  
  wall.postid = posts.postid AND posts.userid=?
  ORDER BY wall.postid DESC LIMIT 10 OFFSET ?
 )sq1
)

AND
comments.postid >= 
(SELECT MIN(postid) FROM
 (
   SELECT wall.postid FROM wall,posts WHERE
   wall.postid = posts.postid AND posts.userid=?
   ORDER BY wall.postid DESC LIMIT 10 OFFSET ?
  )sq2
)

 AND
 posts.userid = ?
 ORDER BY comments.postid DESC,comments.tempid DESC;
'; 
EXECUTE STMT USING @uid,@rangee,@uid,@rangee,@uid;
DEALLOCATE PREPARE STMT; 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T15:22:47.207

您必须使用子查询来具体化一个表，该表包含每个记录（评论）的每个组（通过帖子）中的排名。然后，在外部查询中，您可以仅过滤排名在所需范围内的那些记录（例如`[1,5]`，前 5 名）：

```
-- select top 5 comments of each of the user's desired posts
SELECT   comments.comment,
         comments.postid,
         user.name,
         comments.userid,
         comments.tempid
FROM     user JOIN (
           -- rank comments on user's desired posts by grouping a self-join
           -- use index (postid, tempid) for performance
           SELECT      c1.*, COUNT(*) rank
           FROM        (
                         -- select user's posts within desired range
                         SELECT postid
                         FROM   (
                                  -- rank user's posts by grouping a self-join
                                  -- use index (userid, postid) for performance
                                  SELECT      p1.postid, COUNT(*) rank
                                  FROM        posts p1
                                    LEFT JOIN posts p2
                                           ON p1.userid = p2.userid
                                          AND p1.postid < p2.postid
                                  WHERE       p1.userid = @uid
                                  GROUP BY    p1.postid
                                ) ranked_posts
                         WHERE  rank BETWEEN @rangee + 1 AND @rangee + 10
                       ) interesting_posts
                  JOIN comments c1 USING (postid)
             LEFT JOIN comments c2
                    ON c1.postid = c2.postid
                   AND c1.tempid < c2.tempid
           GROUP BY c1.postid
         ) comments USING (userid)
WHERE    comments.rank BETWEEN 1 AND 5
ORDER BY postid DESC, tempid DESC 
```

# android - 想要使用 RTSP 进行视频流式传输吗？

> ID：13031913
> 
> 赞同：0
> 
> 时间：2012-10-23T13:46:21.907
> 
> 标签：android, video-streaming, rtsp

我想使用 RTSP 在我的应用程序中播放 3gp 和 mp4 视频。我有一个类似于`rtsp://www.somesite.com/4600099.mp4`我想流式传输视频的 URL 并使用此 URL。

我已经尝试过这个[问题](https://stackoverflow.com/questions/3332773/android-video-streaming%20thread)，但它对我不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:15:18.483

在视频方面，Android 可能是个问题，任何冰淇淋前的东西都令人沮丧:)

您也可以尝试构建示例。它们位于：（`\android-sdk\samples\android-8\ApiDemos\src\com\example\android\apis\media`这是针对 android api lvl 8 的，其他版本的 android 位于类似的文件夹中）。

寻找：`MediaPlayerDemo_Video.java`或`VideoViewDemo.java`

# javascript - Django / Ajax：javascript 对象格式化

> ID：13031923
> 
> 赞同：2
> 
> 时间：2012-10-23T13:46:47.367
> 
> 标签：javascript, jquery, ajax, django

我是 javascript 和 jquery 的新手。我有以下情况。我正在序列化表的已编辑行并通过 ajax 将其发送到服务器。

我必须将原始数据（编辑前）和最终数据（编辑行）传递给服务器。

分别通过它们每个都很好，但是当我把它们放在一起时，发生了一些奇怪的事情。对于那些了解javascript的人来说，这可能是微不足道的。

“发送代码”是：

```
$.ajax({
        data: data,
        dataType: 'json',
        ...
       }); 
```

当我将原始行数据或编辑后的行数据获取为：

```
data = tr.find(':input').serializeArray(); 
```

我在 request.POST 中得到一个正常的字典，如下所示：

```
<QueryDict: {u'Type': [u'CNAME'], u'Name': [u'domain_2'], Ttl': [u'500'], u'Value': [u'domain_1']}> 
```

但是当我尝试像这样获取原始数据和新数据时：

```
original_data = tr.find(':input').serializeArray();
new_data = tr.find(':input').serializeArray();
var data = {}
data.original_data = original_data
data.new_value = new_data 
```

这只是行不通。我得到这样的东西：

```
<QueryDict: {u'new_value[1][name]': [u'Type'], u'new_value[3][name]': [u'Ttl'], u'new_value[2][value]': [u'domain_1'], u'original_data[2][name]': [u'Value'], u'new_value[2][name]': [u'Value'], u'original_data[0][name]': [u'Name'], u'original_data[3][value]': [u'300'], u'original_data[1][value]': [u'CNAME'], u'new_value[3][value]': [u'500'], u'original_data[0][value]': [u'domain_2'], u'new_value[1][value]': [u'CNAME'], u'original_data[3][name]': [u'Ttl'], u'new_value[0][name]': [u'Name'], u'original_data[2][value]': [u'domain_1'], u'original_data[1][name]': [u'Type'], u'new_value[0][value]': [u'domain_2']}> 
```

我希望得到

```
<QueryDict: {'original_data': {u'Type': [u'CNAME'], u'Name': [u'domain_2'], Ttl': [u'500'], u'Value': [u'domain_1']}, 'new_value': {u'Type': [u'CNAME'], u'Name': [u'domain_2'], Ttl': [u'500'], u'Value': [u'domain_1']}>> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T15:45:45.187

解决方案是使用`encodeURIComponent(JSON.stringify(data))`而不是`data`仅使用。

当我使用 django 时，我也使用了 dajaxice，所以我实际上添加了`'argv='+encodeURIComponent(JSON.stringify(data))`，所以 Dajaxice 会查找一个名为的键`'argv'`并为我获取值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:58:15.507

`request.POST`用于以正常形式编码发送的数据。你不是在发送那个，你是在发送一个原始的 JSON 字符串。要在视图中访问它，请使用`request.body`.

# playframework - 数据库连接字符串无效时的异常处理

> ID：13031924
> 
> 赞同：1
> 
> 时间：2012-10-23T13:46:53.583
> 
> 标签：playframework, playframework-1.x

尝试通过无效的数据库连接来测试未连接到我的数据库的错误情况。当我运行我的应用程序时，我在 IDE 中得到了这个

```
Exception in thread "main" play.exceptions.DatabaseException: Cannot connected to the database, Communications link failure 
```

我有以下

```
@Before
static void initFromDB()
{
    try{
        //Get some values from DB
       }catch (Exception ex)
       {
           Logger.fatal(ex.toString(), new Object());
           error("Database issue");
       }
} 
```

如果我在 IE 中启动我的网站，那么我会得到

```
Internet Explorer cannot display the webpage 
```

我没有得到 500 页。

我在`DEV`模式下运行`playframework 1.2.4`

在`PROD`，我不会得到错误页面，因为它不能以 prod 模式下的错误开始，或者说我的 IDE 中的消息

更新 1：我确保我所有的数据库连接都是有效的。切换到`prod`模式。启动了我的网站，在加载网站时，我与网络断开连接，并收到一条通用错误消息

```
Oops, an error occured 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T10:56:27.097

如果数据库连接失败，则服务器初始化失败，因此您不会获得应用程序的 500 页，而是默认的（根据浏览器），因为服务器不会运行。

# css - 按输入类型选择标签

> ID：13031926
> 
> 赞同：10
> 
> 时间：2012-10-23T13:47:07.227
> 
> 标签：css, css-selectors, label

有没有办法通过输入类型排除或选择标签，类似于输入字段？

```
label:not([type=checkbox])
label[type=checkbox] 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-23T15:13:18.360

如果您为您的复选框提供所有以相同内容开头的特定 id，您可以执行以下操作：

HTML

```
<input type="checkbox" id="chkTerms" />
<label for="chkTerms">Read terms & conditions</label> 
```

CSS

```
label[for*="chk"], label[htmlfor*="chk"]
{
css here
} 
```

可能只有现代浏览器。编辑：我刚刚尝试了一个小提琴：[链接](http://jsfiddle.net/AZpfU/3/)，它适用于 chrome 和 IE 8 & 9 但不是 7。我没有在 FF 中尝试过。

EDIT2：只是为了解释这里发生了什么，方括号会查找所需的属性。asterix 将 equals 的行为从普通的 equals 更改为包含 - 只要 for 属性包含“chk”，它将应用该样式。您可以将 * 替换为 ^，它会将其更改为以开头而不是包含开头。

EDIT3：BoltClock 在评论中为 IE7 提供了修复，我已经更新了答案以包含它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-23T14:04:39.240

怎么样`input[type=checkbox] + label { /*label style here*/ }`？如果文本就在输入元素之后，它可能会起作用。我没有测试过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-23T14:21:19.460

您可以将复选框与基本数据属性参考一起使用。

```
<input type="checkbox" name="checkbox-1" id="checkbox-0" class="custom" />
<label for="checkbox-0">Whatever</label> 
```

如果你不期待这个......让我们知道......

# post - 上传到 S3 不断失败，出现 SignatureDoesNotMatch 错误

> ID：13031927
> 
> 赞同：0
> 
> 时间：2012-10-23T13:47:09.307
> 
> 标签：post, upload, amazon-s3, amazon-web-services

我正在遵循本指南：[http](http://aws.amazon.com/articles/1434/) ://aws.amazon.com/articles/1434/我显然遗漏了一些东西，因为每次我尝试上传东西时都会收到 SignatureDoesNotMatch 错误。这是我的政策：

```
{"expiration": "2099-01-01T00:00:00Z",
    "conditions": [ 
    {"bucket": "<my bucket>"}, 
    {"key": "${filename}"},
    {"acl": "private"}
    ]
} 
```

我客人这是我目前唯一能提供的信息。这是html页面： http: [//pastebin.com/9dNSsgqZ](http://pastebin.com/9dNSsgqZ)

有任何想法吗？

编辑：问题出在我创建签名的方式上。这是一个链接，以防有人（像我一样）想要一个可行的解决方案：http://aws.amazon.com/code/Amazon-S3/1618

# silverlight - SilverlightL 客户端启用网站，服务器禁用

> ID：13031928
> 
> 赞同：1
> 
> 时间：2012-10-23T13:47:11.413
> 
> 标签：silverlight, client-server

*   你好

我有一个 Silverlight Web 应用程序（名称：WebApp），其中一个功能用于访问另一个网站（名称：TestWebsite）。

问题是：

如果只能从特定机器（在机器识别的环境中）访问该 TestWebise，并且如果托管 WebApp 的服务器无法访问该网站，那么客户端是否能够从 WebApp 连接到 TestWebsite？

编辑：机器被它的 IP 地址识别以连接到网站（TestWebsite）。

# joomla - 特定类别项目的布局

> ID：13031930
> 
> 赞同：3
> 
> 时间：2012-10-23T13:47:15.033
> 
> 标签：joomla, joomla2.5

我在 Joomla 中有一堆类别和项目，我希望其中一个类别与其他类别不同 - 这些类别项目必须使用不同的布局。我没有使用任何扩展，只是`com_content`. 我尝试`default.php`在我的目录中创建副本，`/components/com_content/views/article/tmpl`但无法将其分配给我的类别。任何帮助，将不胜感激。似乎向模块添加新布局要容易得多，或者我只是弄错了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T14:05:29.743

我从未尝试过，但我认为您首先必须进行模板覆盖。您可以通过以下链接查看这是如何完成的：

[http://docs.joomla.org/How_to_override_the_output_from_the_Joomla!_core](http://docs.joomla.org/How_to_override_the_output_from_the_Joomla!_core)

然后，在 default.php 中，您可以尝试添加以下内容：

```
if (JRequest::getVar('id')=='22' && JRequest::getVar('view')=='category' && JRequest::getVar('option')=='com_content') {
  //layout for category goes in here
}
else {
  //default category layout
} 
```

您当然需要更改`22`为`ID`要更改布局的类别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T14:03:30.820

您可以尝试下面给出的链接将不同的模板分配给特定的菜单项。您可以`categorylist`从菜单管理器分配菜单项中的菜单类型，并从模板管理器将模板分配给特定菜单。**请注意**，您不能将默认模板分配给单个页面。有关更多信息，请访问此链接：

[[如何将模板分配给特定页面？](http://docs.joomla.org/How_do_you_assign_a_template_to_a_specific_page%3F)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-23T16:25:28.080

对于 1.6 或更高版本，替代布局的工作方式类似于布局覆盖，但存储在具有不同名称的文件中。因此，它们可能被命名为 myalternatelayout.php，而不是被称为 default.php。当您创建或编辑项目时，备用布局会分配给它们。

备用菜单项布局要求您同时创建 php 文件和同名的 xml 标题，因此 myalternatemenulayout.php 和 myalternatemenulayout.xml。这些将在您创建新菜单项时显示。

我有点不清楚您是否想要以编程方式分配布局，因此您不必每次都这样做。我可能会使用插件来做到这一点。

# spring - 在具有多个http元素Spring Security的模式中使用服务器名称？

> ID：13031932
> 
> 赞同：0
> 
> 时间：2012-10-23T13:47:15.550
> 
> 标签：spring, spring-security

Spring Security 3.1 支持多个 http 元素。

我希望我们的移动网站的安全性基本上总是需要登录，而“普通”网站将有更多的公共页面。

我正在考虑为此使用 Spring Security 的多个 http 元素功能，但我找不到任何关于在模式字段中使用服务器名称 (egmsite.com) 等变量的信息。

我可以在 http 模式字段中使用请求变量吗？如果是这样，怎么做？

这是我尝试过的一些代码：

```
 <http security="none" pattern="/assets/**"/>
<!-- 
<http use-expressions="true" request-matcher-ref="mobileHttpConfigSelector" entry-point-ref="myAuthenticationProcessingFilterEntryPoint" >

    <intercept-url pattern="/*/*/login.html"  access="permitAll" />
    <intercept-url pattern="/*/*/registration/**"  access="permitAll" />
    <intercept-url pattern="/**"  access="isAuthenticated()" />

    <anonymous enabled="true" granted-authority="ROLE_ANONYMOUS"/>
    <remember-me services-ref="rememberMeServices" key="${msa.security.key}" use-secure-cookie="true"/>
    <custom-filter position="CONCURRENT_SESSION_FILTER" ref="concurrencyFilter" />
    <custom-filter position="FORM_LOGIN_FILTER" ref="myUserPassFilter"/>
    <custom-filter position="LOGOUT_FILTER" ref="myLogoutFilter"/>
    <custom-filter ref="countrySelectFilter" before="FIRST" />
    <custom-filter ref="userAgentFilter" before="LAST" />

    <session-management invalid-session-url="/" session-authentication-strategy-ref="sas">
    </session-management>
</http>
-->
<http use-expressions="true" entry-point-ref="myAuthenticationProcessingFilterEntryPoint" >

    <intercept-url pattern="/*/*/account/**" access="isAuthenticated()" />

    <intercept-url pattern="/**"  access="permitAll" />

    <anonymous enabled="true" granted-authority="ROLE_ANONYMOUS"/>
    <remember-me services-ref="rememberMeServices" key="${msa.security.key}" use-secure-cookie="true"/>

    <custom-filter position="CONCURRENT_SESSION_FILTER" ref="concurrencyFilter" />
    <custom-filter position="FORM_LOGIN_FILTER" ref="myUserPassFilter"/>
    <custom-filter position="LOGOUT_FILTER" ref="myLogoutFilter"/>
    <custom-filter ref="countrySelectFilter" before="FIRST" />
    <custom-filter ref="userAgentFilter" before="LAST" />

    <session-management invalid-session-url="/" session-authentication-strategy-ref="sas">
        <!-- <concurrency-control max-sessions="2" error-if-maximum-exceeded="false" session-registry-alias="sessionRegistry"/>-->
    </session-management>
</http>
<global-method-security secured-annotations="enabled" pre-post-annotations="enabled"/>

<beans:bean id="mobileHttpConfigSelector" class="nl.msw.compraventa.interceptor.security.MobileHttpConfigSelector"/> 
```

带有 mobileHttpConfigSelector 的 http 部分已被注释掉，因为如果我激活我得到 No unique bean of type [org.springframework.security.web.context.SecurityContextRepository] ​​is defined。

亲切的问候，马克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T14:12:10.670

您可以使用该`request-matcher-ref`属性而不是`pattern`注入一个`RequestMatcher`实例，该实例可以利用`HttpRequest`. using只是用于选择过滤器链`pattern`的一种特殊情况。[`AntPathRequestMatcher`](http://static.springsource.org/spring-security/site/docs/3.1.x/apidocs/org/springframework/security/web/util/AntPathRequestMatcher.html)

有关可用属性的更多信息，请参阅[命名空间附录](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#nsa-http)。

# java - 基于主题的服务

> ID：13031934
> 
> 赞同：0
> 
> 时间：2012-10-23T13:47:20.663
> 
> 标签：java, soa, esb, mule

我正在向 SOA/ESB 专家寻求一些架构设计方面的帮助。如果问题不是很清楚，请道歉。

我们有几个业务案例，我们目前正在使用 P2P 通信或大量代码块，例如

```
 if(...)
               Update System 1
               Then Update System 2
               Then Update System 3
       Else If (...)
                Update System 1 in a different Way
                 Don't Update 2 at all
                 Update 3 but differently 
```

现在到处都是样板代码和数据库更新代码。有趣的是，我们从一个面向客户端的界面开始，然后继续添加更多并获得“快速获胜”，并不断复制代码。现在，当需要进行小改动时，它就变成了一项艰巨的任务。

这是一个典型的 ESB 类型案例恕我直言，我们正在考虑采用主题 - 发布 - 订阅模型来满足这种情况。这样所有参与的客户端都可以将消息发布到主题，然后我们只需在需要时随时随地连接订阅者。所有 Db 或系统更新代码将是通用的并用于单个集群部署。

但是，应该在所有系统中更新数据。例如，如果 1 个订阅者的更新失败，我们应该回滚其他系统中的更新，或者至少在失败的地方进行审计。实现上述目标的最佳方法是什么？有我们可以使用的标准工具/实用程序吗？

仅供参考 - 我们正在使用 Java 技术和 Mule ESB，并希望充分利用它的潜力。提前致谢。如果需要更清晰，请告诉我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T20:07:49.080

使用主题是一种将服务联系在一起的非常强大的方法。这是我称之为[Saga](http://rgoarchitects.bit.ly/4xNwpp)的模式。你应该确保你的主题设计应该同时传达事件和上下文，因为同一事件可能需要根据上下文路由到不同的接收者（因此主题可能看起来像 context.evetnType 并且订阅者可以订阅所有类型 (*.eventType) 或仅在特定上下文中的事件）

请注意，将这种行为从服务外部化的另一种选择是使用[Orchestration](http://arnon.me/soa-patterns/orchestration/)。编排使查看和监控预定义的业务流程变得更容易，但代价是偶然性和一定的灵活性（与 saga 相比）。它还可以鼓励[纳米服务](http://arnon.me/wp-content/uploads/2010/10/Nanoservices.pdf)

# youtube-api - 实时视频广播提要

> ID：13031936
> 
> 赞同：1
> 
> 时间：2012-10-23T13:47:24.050
> 
> 标签：youtube-api

我想知道是否可以创建一个受限访问频道/组，其中有体育赛事的实时视频广播。频道/组访问按观看次数支付给在线主播网站和版权所有者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T05:02:40.027

我认为你可以使用：

```
<mean: price 
```

我不太了解您应用中的付款机制。无论如何，这些是限制访问的方法：

[http://apiblog.youtube.com/2011/12/understanding-playback-restrictions.html](http://apiblog.youtube.com/2011/12/understanding-playback-restrictions.html)

# javascript - 在数组中搜索字符串并返回这些对象的好方法

> ID：13031938
> 
> 赞同：0
> 
> 时间：2012-10-23T13:47:29.517
> 
> 标签：javascript, arrays, knockout.js

所以我几乎完成了我一直在研究的这个客人名单前端应用程序。我要做的最后一件事是允许传递一个字符串来按名称过滤列表。因此，通过订阅用户在字段中输入一些名称，我应该能够使用这个 ko 计算函数以这种不同的方式搜索数组。请记住，self.guests 是一组来宾对象。

```
self.displayResults = ko.computed(function(){
    if(self.displayTypeOf() == 'slice'){
        var ary = self.guests.slice(self.startValue(),self.endValue());
        console.log(ary)
        return ary
    }else if(self.displayTypeOf() == 'string'){
        //Code I need goes here
    }
}); 
```

您可以看到通常列表是使用列表的切片部分计算的，当用户开始在输入中输入内容时，我将使用我要求的搜索数组函数覆盖并更新此计算列表。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T14:24:32.770

我建议使用`ko.utils.arrayFilter`实用功能进行过滤：

```
self.displayResults = ko.computed(function(){
    if(self.displayTypeOf() == 'slice'){
        var ary = self.guests.slice(self.startValue(),self.endValue());
        console.log(ary)
        return ary
    }else if(self.displayTypeOf() == 'string'){
        // Init filter
        var filter = self.SomeValue();
        var ary = ko.utils.arrayFilter(self.guests(), function(item) {
           return ko.utils.stringStartsWith(item.name().toLowerCase(), filter);
        });
        console.log(ary);
        return ary;
    }
}); 
```

在此处阅读有关 ko utils 方法的更多信息：[http ://www.knockmeout.net/2011/04/utility-functions-in-knockoutjs.html](http://www.knockmeout.net/2011/04/utility-functions-in-knockoutjs.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T14:05:31.127

您可以使用[Array::filter](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter)。

```
var guestlist = [ 'Foo Bar', 'Doo Bar', 'Foo Doo', ... ];

function guestFilter(element) {
    return element.indexOf('Bar') > 0;
}

guestlist.filter(guestFilter); // [ 'Foo Bar', 'Doo Bar' ] 
```

# worksheet - 将工作表复制到工作表 - 如何仅复制值？

> ID：13031945
> 
> 赞同：0
> 
> 时间：2012-10-23T13:47:46.857
> 
> 标签：worksheet

```
Sub Sample()

Dim wsI As Worksheet, wsO As Worksheet, ws2 As Worksheet
Dim LastRow As Long, i As Long, j As Long

Set wsI = Sheets("EC6")
Set wsO = Sheets("2")

 LastRow = wsI.Range("A" & Rows.Count).End(xlUp).Row

j = 1

With wsI
    For i = 1 To LastRow
        wsI.Rows(i).Copy wsO.Rows(j)

        j = j + 1
    Next i
End With
End Sub 
```

如何仅将 VALUE 从 wsI 复制到 wsO ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:57:56.000

如果您的目标工作表已经存在（即您有 31 个工作表，命名为 1 到 31）：

```
Dim wsI As Worksheet, wsO As Worksheet, ws2 As Worksheet
Dim LastRow As Long, i As Long, j As Long

Set wsI = Sheets("EC6")

Set wsO = Sheets(wsI.Cells(49, 1).Value)

LastRow = wsI.Range("A" & Rows.Count).End(xlUp).Row

j = 1

With wsI
    For i = 1 To LastRow
        wsI.Rows(i).Copy wsO.Rows(j)

        j = j + 1
    Next i
End With 
```

# iphone - 目标 c / iphone 应用程序中的直方图生命数据类型

> ID：13031951
> 
> 赞同：0
> 
> 时间：2012-10-23T13:48:01.633
> 
> 标签：iphone, objective-c, ios, xcode, arrays

我有一个包含许多数字的数组，我想将其转换为类似数组的直方图，其中对于每个数字，我都有该数字在数组中出现的次数。如果有任何用于 xcode 的 API，我试图到处寻找，但找不到。

最好的方法是什么？

谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T04:47:09.677

```
 NSCountedSet *set = [[NSCountedSet alloc] initWithArray:array]; 
```

其中 array 是包含所有元素的组合数组。

# android - 我如何在android中启动服务

> ID：13031952
> 
> 赞同：0
> 
> 时间：2012-10-23T13:48:02.453
> 
> 标签：android, android-service

我正在尝试了解 Android 中的 Service 类。

我创建了一个非常简单的活动：

```
public class ServiceLauncher extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_service_launcher);
    Intent intent = new Intent(this, NavOverrideService.class);
    startService(intent);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_service_launcher, menu);
    return true;
} 
```

}

此活动应该调用以下服务，但它似乎不是因为我的日志或 toast 消息都没有显示：

```
 public class NavOverrideService extends Service{

    /* (non-Javadoc)
     * @see android.app.Service#onBind(android.content.Intent)
     */

    @Override
    public void onCreate() {
      // Start up the thread running the service.  Note that we create a
      // separate thread because the service normally runs in the process's
      // main thread, which we don't want to block.  We also make it
      // background priority so CPU-intensive work will not disrupt our UI.
        Log.v("Nav Service: ","Created");
        View disableStatusBar = new TableLayout(getApplicationContext());
        //mView = new HUDView(getApplicationContext());

         WindowManager.LayoutParams handleParams = new WindowManager.LayoutParams(
                WindowManager.LayoutParams.FILL_PARENT,
                50,
                 // This allows the view to be displayed over the status bar
               // WindowManager.LayoutParams.TYPE_SYSTEM_ALERT |  
                WindowManager.LayoutParams.TYPE_SYSTEM_OVERLAY,
                 // this is to keep button presses going to the background window
                WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE |
                WindowManager.LayoutParams.FLAG_WATCH_OUTSIDE_TOUCH |
                 // this is to enable the notification to recieve touch events
                WindowManager.LayoutParams.FLAG_NOT_TOUCH_MODAL |
                 // Draws over status bar
                WindowManager.LayoutParams.FLAG_LAYOUT_NO_LIMITS,
                 PixelFormat.TRANSPARENT);

         handleParams.gravity = Gravity.TOP;
         handleParams.y = 750;

         //disableStatusBar.setBackgroundColor(Color.GREEN);
         disableStatusBar.setBackgroundResource(R.drawable.fake_nav);

         WindowManager winMgr = (WindowManager)getSystemService(WINDOW_SERVICE); 

         winMgr.addView(disableStatusBar, handleParams);

    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        Toast.makeText(this, "service starting", Toast.LENGTH_SHORT).show();

        Log.v("Nav Service: ","started");

        // If we get killed, after returning from here, restart
        return START_REDELIVER_INTENT;
    }

    @Override
    public IBinder onBind(Intent intent) {
        // We don't provide binding, so return null
        return null;
    }

    @Override
    public void onDestroy() {
      Toast.makeText(this, "service done", Toast.LENGTH_SHORT).show(); 
    }
} 
```

我究竟做错了什么？

哦，我的清单：

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <service android:name="com.eliddell.services_test.NavOverrideService" />
    <activity
        android:name="com.eliddell.services_test.ServiceLauncher"
        android:label="@string/title_activity_service_launcher" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T14:12:41.827

我已经创建了一个新项目。它对我有用：

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        startService(new Intent(this, ServiceTest.class));
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
}

public class ServiceTest extends Service {

    @Override
    public void onCreate() {
        Log.v(null, "SERVICE TEST onCreate");
        super.onCreate();
    }

    @Override
    public void onStart(Intent intent, int startId) {
        Log.v(null, "SERVICE TEST onStart");
        super.onStart(intent, startId);
    }

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

}

<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.servicetest"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <service android:name="ServiceTest"></service>
    </application>

</manifest> 
```

# wpf - wpd datagrid，在 mvvm 场景中编辑单元格值

> ID：13031955
> 
> 赞同：1
> 
> 时间：2012-10-23T13:48:07.250
> 
> 标签：wpf, mvvm, datagrid

我有一个 wpd 数据网格，它绑定到视图模型中的一个属性（该属性是一个数据表对象）。数据网格在单元格中有 texbox，因此我可以编辑该值。问题是编辑的值没有发送回我的视图模型。我不知道我错过了什么。

数据网格的代码：

```
 <DataGrid
        ItemsSource="{Binding Path=Translations}"
        AutoGenerateColumns="True">
        <DataGrid.Resources>
            <Style
                TargetType="{x:Type DataGridCell}">
                <Setter
                    Property="Template">
                    <Setter.Value>
                        <ControlTemplate
                            TargetType="{x:Type DataGridCell}">
                            <Border
                                Name="DataGridCellBorder">
                                <ContentControl
                                    Content="{TemplateBinding Content}">
                                    <ContentControl.ContentTemplate>
                                        <DataTemplate>
                                            <TextBox
                                                Background="Transparent"
                                                TextWrapping="WrapWithOverflow"
                                                Height="auto"
                                                Width="auto"
                                                Text="{Binding Text, Mode=TwoWay}" />
                                        </DataTemplate>
                                    </ContentControl.ContentTemplate>
                                </ContentControl>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </DataGrid.Resources>
    </DataGrid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T14:06:41.127

如果您在绑定上使用 UpdateSourceTrigger="PropertyChanged" 会怎样 - 这有帮助吗？

# javascript - Javascript 时间不会打印出来 (date.js)

> ID：13031956
> 
> 赞同：0
> 
> 时间：2012-10-23T13:48:08.670
> 
> 标签：javascript, date, time

我使用 date.js 有以下代码：

```
 <div id="Timer">
                    <script>Date.parse("hh:mm");</script> 
                    <div class="Timers">

                        <div class="timerSpace"><span style="text-align: left; color: #DDDD11;">Hours from now</span></div>
                        <div class="timer1"><span style="color: #FFFF11;"><script>var d1 = date.parse(Date.today().addHours(6.0)); document.write(d1);</script><span></div>
                        <div class="timer2"><span style="color: #FFFF11;"><script>var d2 = date.parse(Date.today().addHours(12.0)); document.write(d2);</script><span></div>
                        <div class="timer3"><span style="color: #FFFF11;"><script>var d3 = date.parse(Date.today().addHours(18.0));document.write(d3);</script><span></div>
                        <div class="timer4"><span style="color: #FFFF11;"><script>var d4 = date.parse(Date.today().addHours(24.0));document.write(d4);</script><span></div>
                        <div class="timerSpace"></div>
                    </div>
                </div> 
```

而且我没有在我的页面上打印任何内容？为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:51:06.510

代替

```
var d1 = date.parse(Date.today().addHours(6.0)); 
```

尝试

```
var d1 = new Date();
d1.setHours( d1.getHours() + 6 );
document.write( d1.toTimeString() );​ 
```

[http://jsfiddle.net/P5RL6/](http://jsfiddle.net/P5RL6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:51:16.750

`parse`用于将现有解析`String`为`Date`对象。改用`toString()`：

```
Date.today().toString("hh:mm") 
```

另外，用于`document.write`写入文档，即：

```
<script>document.write(Date.today().toString("hh:mm"))</script> 
```

# jquery - Fancybox 弹出 - 背景页面的下半部分消失

> ID：13031957
> 
> 赞同：0
> 
> 时间：2012-10-23T13:48:09.383
> 
> 标签：jquery, css, fancybox, fancybox-2

我在这里设置了一个测试页面：[http ://www.hestiacookware.com/shop/product.php?s=presentation-product](http://www.hestiacookware.com/shop/product.php?s=presentation-product)

当您单击任何图像启动 Fancybox 时，背景页面的一半会消失 - 它只是在某个点切断。

感谢您对此的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T17:23:52.147

[您的布局行为很奇怪，因为您的stylesheet.css](http://www.hestiacookware.com/css/stylesheet.css)文件中有这两个 CSS 属性：

第 2 行：

```
html {
  overflow-y:scroll;
} 
```

第 5 行：

```
body {
  background: none repeat scroll 0 0 #143721;
  width: 100%;
} 
```

...除非您有充分的理由拥有它们，否则我建议您`overflow-y:scroll`从`html`标签和`width: 100%`标签中删除`body`。

没有它们，您的布局将正常工作，并且在大多数浏览器中都是一致的。

# batch-file - 批量编程设置 ERRORLEVEL 来自失败的 FIND 命令

> ID：13031958
> 
> 赞同：9
> 
> 时间：2012-10-23T13:48:14.480
> 
> 标签：batch-file, error-handling, errorlevel

我发现需要向调用批处理脚本的程序报告错误级别。

该脚本将创建一个我想要检查的 CSV 日志文件，以显示脚本是否成功运行。

我想说的是

```
IF NOT FIND "[ERR" "test.csv" 
```

或者说，如果字符串`"[ERR"`不在输出中`ERRORLEVEL = 0 ELSE ERRORLEVEL = 1`

希望这是有道理的。我敢肯定这很简单，但设置错误级别似乎是 a$se 的一大难题！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-23T15:01:16.283

FIND "[ERR" "text.csv" 如果至少找到一个，则将 ERRORLEVEL 设置为 0 `[ERR`，如果没有找到，则设置为 1 `[ERR`。您需要一种反转逻辑的方法。

如果您只想在没有`[ERR`找到或`1`至少`[ERR`找到一个时立即返回 0，那么我将使用以下命令：

```
find "[ERR" "test.csv" >nul && exit /b 1 || exit /b 0 
```

如果您想将结果捕获到稍后返回的变量中，则：

```
find "[ERR" "test.csv" >nul && set "err=1" || set "err=0" 
```

或者

```
find "[ERR" "test.csv" >nul
set /a "err=!%errorlevel%" 
```

当您准备好返回结果时

```
exit /b %err% 
```

* * *

以下是我接受的原始答案，但***令人尴尬的是错误***:-(
感谢Corey指出逻辑错误。正如他在评论中所说，如果所有行都有`[ERR`文本，下面的错误代码只会报告错误。

> 如果找到，FIND 会将 ERRORLEVEL 设置为 0，如果未找到，则设置为 1。要反转逻辑，只需使用 /V 选项。
> 
> ```
> find /v "[ERR" "test.csv" >nul 
> ```
> 
> 如果您有一个指示错误级别的变量集，那么您可以使用 EXIT /B 来设置错误级别
> 
> ```
> set err=1
> exit /b %err% 
> ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-08-04T09:53:16.983

*请注意，如果 ERRORLEVEL大于或等于*以下数字，则 IF 命令具有返回 true 的逻辑！所以

```
IF ERRORLEVEL 0 (... 
```

对所有 FIND 命令返回 true。如果您只想测试一个短语是否在文件中，您需要什么：

```
find "string" "test.txt" > NUL & IF NOT ERRORLEVEL 1 ECHO String was found 
```

我花了很长时间才解决这个问题！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-12T00:21:29.657

这是我之前在 BAT 文件中使用的逻辑。

```
find "string" "test.txt" > NUL & IF ERRORLEVEL 1 (
    ECHO String was NOT found
) ELSE (
    ECHO String was found
) 
```

您可以在 IF/ELSE 块中放置您想要的任何命令。

# css - Twitter Bootstrap 响应式 ul 文本换行

> ID：13031959
> 
> 赞同：4
> 
> 时间：2012-10-23T13:48:15.330
> 
> 标签：css, twitter-bootstrap, html-lists

这是我在这里的第一个问题，尽管我使用堆栈溢出作为常规资源来寻求帮助，并且直到现在它总是让我回到正轨，因为我已经搜索和搜索并且找不到答案。

我有一个响应式布局，当文本以较小的屏幕尺寸换行时，我正在努力让我的 ul 保持其左边距，这导致文本换行到位于图标下方的第二行或第三行，而不是保持利润。我正在使用引导程序，并且我的列表还使用引导程序字形图标的图标标签而不是普通项目符号，如下所示；

```
<ul class="unstyled starlist">

<li><i class="icon-star icon-white"></i><span>List text here....................................</span></li>

<li><i class="icon-star icon-white"></i><span>List text here....................................</span></li>

<li><i class="icon-star icon-white"></i><span>List text here....................................</span></li>

<li><i class="icon-star icon-white"></i><span>List text here....................................</span></li>

</ul> 
```

我的（非常简单的）CSS（在引导程序之外）是

```
.startlist li span {Margin-left:15px;} 
```

我尝试了很多不同的方法，但似乎都不起作用，我最接近的方法是将跨度显示为一个阻止文本在图标下换行的块，但图标将无法与文本正确对齐并且看起来很糟糕，图标看起来略微凸起。

我还在每个 li 中使用了 2 个 div 并在左侧内联浮动，这一直有效，直到屏幕尺寸减小并且一切都变得混乱，我没有尝试媒体查询，因为认为简单的列表必须有更好的方法。我还尝试了列表样式图像，但它也无法正确对齐文本。

我目前正在使用一张桌子（不要打败我，这只是临时的最后手段，直到我弄明白为止）只是为了暂时看起来正确，但真的希望能在输入适用于所有屏幕的列表格式方面提供一些帮助尺寸。Tbh 表格布局看起来很完美，并且对屏幕尺寸的响应很好，但它不是表格数据，而且它有很多代码用于一个简单的列表，带有一个星号！

我期待任何人的建议（或者被告知一个明显的解决方案并且看起来像个白痴！）

非常感谢史蒂夫。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-04T17:44:21.747

这是解决方案。在您的文本周围环绕一个`p`标签，将您的边距设置为您想要的任何内容，然后使用. 现在漂浮你的左边。那应该行得通。`li``p``overflow:hidden``<i>`

示例标记：

```
#left-column .advantages li {font: normal 14px arial; margin:0 0 10px 0; color:#333; list-style:none;}
#left-column .advantages li p {margin:0 0 0 20px; overflow:hidden;}
#left-column .advantages li i {float:left;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T14:12:56.693

您是否尝试过使用该`:before`实现？

像这样的东西：

```
.startlist li span:before {

  content: url(../star.jpg);

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T09:46:39.290

尝试使用一些填充在列表项上设置背景。

```
ul.fancy-bullets {
    list-style-type:none;
}
ul.fancy-bullets li {
    background: url(../images/icons/star.png) left top no-repeat;
    padding-left: 2em;
} 
```

尝试过长线，但它没有在图标下方。

# asp.net - 在程序集中找不到上下文类型

> ID：13031965
> 
> 赞同：32
> 
> 时间：2012-10-23T13:48:31.337
> 
> 标签：asp.net, entity-framework, connection-string, data-access-layer, entity-framework-5

我首先使用带有代码的 .NET 4.0、MVC3 和 EF5。

我的解决方案分为三个项目，其依赖关系如下所示：

Project.Web -> Project.BLL -> Project.DAL

Project.DAL 层包含我的实体框架数据上下文类和我的所有实体，但我的启动项目是 Project.Web，因此它包含我的 Web.config、连接字符串和实际的 SQL 紧凑型数据库。

我正在尝试启用迁移，以便可以在不擦除现有数据的情况下向我的 EF 模型添加一个新表。但是，当我运行“启用迁移”时，我得到

```
No context type was found in the assembly 'Project.Web'. 
```

如果我将启动项目设置为 Project.DAL，则错误更改为

```
Could not load assembly 'Project.Web'. (If you are using Code First Migrations inside Visual Studio this can happen if the startUp project for your solution does not reference the project that contains your migrations. You can either change the startUp project for your solution or use the -StartUpProjectName parameter.) 
```

有谁知道为什么会导致此错误或我可以做些什么来解决它？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-10-23T15:39:54.780

我最终在[这个](https://stackoverflow.com/a/9527372/1080891)问题中找到了答案。基本上，在包管理器控制台中有一个“默认项目”下拉菜单。您需要将此设置为包含您的 EF 上下文的项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-02T21:47:19.410

我发现了类似的帖子：[在单独的程序集中启用带有上下文的迁移？](https://stackoverflow.com/questions/18126711/enable-migrations-with-context-in-separate-assembly/18128768#18128768)

例子：

```
enable-migrations -ContextProjectName MyProject.DBContexts -contexttypename MyProject.DBContexts.MyContextName -Verbose 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-28T13:15:58.993

谁像我一样犯了这个错误：

您的上下文类必须继承自`DbContext`，就像这样：

```
public class DirectorRequestContext : DbContext
{
    public DbSet<DirectorRequest> DirectorRequests { get; set; }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-08T21:43:08.670

上面的其他答案都没有回答我的问题。

我最终放弃了包管理器控制台，因为它似乎使用的是 EF6 而不是 EFCore ......

幸运的是，您可以从普通的 PowerShell 运行这些实体框架命令：

```
C:\MyRepository\MyProject dotnet ef migrations add InitialDbCreation 
```

（确保您位于包含`DbContext`继承的项目目录中）。

最后，我得到了真正的错误：

```
Your startup project 'FantasyFitness' doesn't reference Microsoft.EntityFrameworkCore.Design. 
This package is required for the Entity Framework Core Tools to work. 
Ensure your startup project is correct, install the package, and try again. 
```

所以，我去项目上的“管理 NuGet 包”并安装`Microsoft.EntityFrameworkCore.Design`，关闭我所有可能锁定文件的 IDE，然后它终于工作了。

请注意，我什至不必运行`Enable-Migration`命令来让它工作......这很神奇。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-22T13:54:57.827

如果由于某种原因您的连接类不在项目中，也会发生这种情况。所以右键单击并“添加到项目”可以解决这个问题。

# php - javascript变量传输到php

> ID：13031967
> 
> 赞同：0
> 
> 时间：2012-10-23T13:48:34.490
> 
> 标签：php, javascript, transfer

这是我的代码

**javascript:**

```
<script type="text/javascript">
$(function() {
    var scntDiv = $('.create');
    var i = $('.create table').size() + 1;
    $('.add').live('click', function() {
            $('<table><tr><td><input type="text" name="item' + i +'" id="textbox_input" placeholder="Item" /></td><td> <input type="number" name="qtty'+ i + '" id="textbox_number" placeholder="Qtty'+i+'"/></td><td><button type="button" class="remove" id="button">Remove</button></td></tr></table>').appendTo(scntDiv);
            i++;
var number = i;
            return false;
    });
    $('.remove').live('click', function() { 
            if( i > 1 ) {
                    $(this).parents('table').remove();
                    i--;
            }
            return false;
    });
}
});
 </script> 
```

## **.html：**

```
<div class="create" style=" padding:10px; width:450px; -moz-border-radius:10px;-webkit-    border-radius:10px; top:10px; left:10px; height:540px; background-color:#FFF; position:absolute; overflow:scroll;">

<form method="POST" action="create.php">
<table>
<tr>
<td><input type="text" name="title" id="textbox_input" placeholder="Title"/></td>
<td></td>
<td><input type="submit" value="Save" class="save" id="button" /></td>
</tr>
<tr>
<td><input type="text" name="item1" id="textbox_input" placeholder="Item"/></td>
<td><input type="number" name="qtty1" id="textbox_number" placeholder="Qtty"/></td>
<td><button type="button" class="add" id="button">Add</button></td>
</tr>
</table>
</form>
</div> 
```

* * *

我需要将 var 号转移到 create.php。该表格是为用户创建一个清单。当他们单击添加按钮时，项目和数量字段将添加。当点击添加按钮时，var i 将增加 1，var number 将保存最后一个 var i。问题是如何将 var 编号传输到 create.php？

# http - 压缩从浏览器发送的 HTTP Post 数据

> ID：13031968
> 
> 赞同：50
> 
> 时间：2012-10-23T13:48:37.353
> 
> 标签：http, gzip

我想使用 Javascript 将压缩的 POST 数据发送到我控制的服务器。有没有办法让 HTTP 层处理压缩。

我正在发送 JSON。如果我将内容类型设置为 GZIP/deflate，浏览器会自动压缩它，然后带有 deflate mod 的 Apache 会自动解压它，这样我的应用程序就不必考虑压缩的数据了吗？

我知道它可以反过来工作，但有什么办法让它以这种方式工作？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-10-23T14:16:38.117

浏览器会自动为您的数据进行 gzip 编码吗？最简洁的答案是不。

长的答案是一些用户代理可以做这样的事情，但你**绝对**不能依赖它。apache mod_deflate 文档状态：

> 一些特殊的应用程序确实支持请求压缩，例如一些 WebDAV 客户端。

所以，不，那是行不通的。您需要自己生成适当的 HTTP 请求消息。在这种情况下，适当的标头是`Content-Encoding: gzip`而不是`Content-Type:`因为内容本身是`application/json`，您只是希望对 HTTP 请求消息的实体主体进行编码以进行传输。

请注意，您还需要添加适当的`Content-Length:`标头，指定压缩后消息实体主体的大小（以字节为单位） - 或 - 使用`Transfer-Encoding: chunked`并放弃内容长度规范发送 HTTP 消息。

在接收端，您*可以* [指示`mod_deflate`使用输入过滤器](http://httpd.apache.org/docs/2.2/mod/mod_deflate.html)来解压信息：

```
<Location /dav-area>
SetInputFilter DEFLATE
</Location> 
```

如果您只接收几个资源的压缩消息正文，这有点麻烦。相反，您可能应该只使用客户端脚本来检查`Content-Encoding: gzip`标头并手动解压缩请求正文。如何做到这一点说，PHP，完全是另一个问题。如果您需要详细信息，您应该发布另一个问题。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2018-02-01T21:50:01.447

这是可能的，但我强烈建议不要接受传入服务器的 gzip 压缩数据。主要原因是防止您的服务器被[gzip 轰炸](https://en.wikipedia.org/wiki/Zip_bomb)。在实际解压缩之前通常不可能知道未压缩的数据是什么样的，因此用户可以向您发送一个看起来像无害的 1 KB 或 1 MB 数据但实际上是 100 GB 数据的 Web 请求，然后您的 Web服务器（nginx 或 apache）在接下来的 10 分钟内挂起，试图将其全部解压，最终内存不足/锁定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-03T21:05:13.873

刚刚使用[https://github.com/dankogai/js-deflate](https://github.com/dankogai/js-deflate)实现了这一点 但是无论出于何种原因，postdata 都会去掉 + 符号并用空格替换它们。

通过 javascript 发送数据：

```
params.mapdata=  btoa(RawDeflate.deflate(JSON.stringify(mapdata))); 
```

通过 php 接收数据：

```
$value = gzinflate(base64_decode(preg_replace('/\s/', '+',$value))); 
```

# c# - 如何在 ASP.net 网页的服务器端使用文本文件读/写？

> ID：13031969
> 
> 赞同：0
> 
> 时间：2012-10-23T13:48:37.063
> 
> 标签：c#, javascript, asp.net, file, google-maps

我正在尝试运行它；

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Text;
using System.IO;

public partial class _Default : System.Web.UI.Page
{

protected void Page_Load(object sender, EventArgs e)
 {
        DosyadanOku("c:\\sucdefteri.txt");

        Console.ReadLine();
    }

    public void DosyadanOku(string sucdefteri)
    {
        StreamReader dosyaOku = new StreamReader(@"C:\\sucdefteri.txt");

            string metin;
            metin = dosyaOku.ReadLine();

            string kesme = "\t";
            char[] b = kesme.ToCharArray();
            string[] satirlar = metin.Split(b);
            Page.ClientScript.RegisterArrayDeclaration("Skills", satirlar[2]);

        dosyaOku.Close();

}
} 
```

在我的 ASP.net 页面的服务器端。这只是从 sucdefteri.txt 中获取一行，然后剪切其中的一部分并将其传递到页面的客户端

**Page.ClientScript.RegisterArrayDeclaration("技能", satirlar[2]);** . 我的意思是它应该，但它不能。如果我尝试将此文件读取/剪切代码作为控制台应用程序，它工作正常，从行中获取部分并将其打印到控制台。但它不适用于此。如果我添加这样的代码；

```
satirlar[2] ="'izmit'"; 
```

然后将其发送给客户，它正在工作。所以我认为文件读取有问题。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T13:52:22.473

`Server.MapPath(" ")`
像这样使用

```
StreamWriter _testData = new StreamWriter(Server.MapPath("~/data.txt"), true);
    _testData.WriteLine(TextBox1.Text); // Write the file.
    _testData.Flush();
    _testData.Close(); // Close the instance of StreamWriter.
    _testData.Dispose(); // Dispose from memory. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T10:58:16.843

这个问题似乎不清楚，但我相信你想在 asp.net 中读/写一个文本文件。如果是，试试这个：

```
 public void WriteTextFile(String FileName)
    {
    TextWriter objTextWriter= new StreamWriter(FileName);
    objTextWriter.WriteLine(DateTime.Now); //Writing current time in textfile
    objTextWriter.Close();
    }
    public String ReadTextFile(String FileName)
    {
    Textreader objTextReader= new StreamReader(FileName);
    String fileContent = objTextWriter.ReadLine();
    objTextReader.Close();
    return fileContent;
    } 
```

# c# - 通过客户端打开IE页面

> ID：13031971
> 
> 赞同：0
> 
> 时间：2012-10-23T13:48:46.127
> 
> 标签：c#, javascript, jquery, asp.net

如何在客户端打开 IE 页面？

**示例：** 我们使用 FireFox 作为我们 Web 系统的默认浏览器。我的用户在特定时刻必须打印一个页面。如何通过 FireFox 打印页面？

**详细信息：** 要访问我们需要的打印机`ActiveX`，但 FireFox 不接受`ActiveX`。我尝试通过`Dll`localhost 访问打印机，因为这是服务器端，所以如果我在服务器中部署我的应用程序，打印机将无法在客户端工作。我的第三次尝试是打开`IE`via 代码隐藏，但这也是服务器端，只在 localhost 中工作。

当我使用 FireFox 时，我只需要在 IE 中打开一个特定页面（因为 activex），但在客户端。

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T13:52:39.637

如果不安装插件或协议处理程序或类似的东西，您不能使用客户端代码从 Firefox 打开 IE。这是一条复杂的路线，当然，需要您的用户安装特定的东西。

相反，我建议让他们使用 Firefox 打印页面。打开一个包含内容的窗口，可能带有特定于打印的样式表，然后`window.print();`在其上发出 a。Firefox 将处理其余部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:52:11.930

浏览器不为网页提供运行任意软件的方法，所以你不能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:52:32.890

如果您在 javascript`window.print();`中调用标准打印对话框将被打开。所以不需要任何dll或activex。

# jquery - 如何使用 jquery 从不同区域获取价值？

> ID：13031973
> 
> 赞同：0
> 
> 时间：2012-10-23T13:48:49.700
> 
> 标签：jquery

我正在尝试使用 jquery 将唯一的 passnum 值传递给不同的区域信息，以便 passnum 信息特定于特定区域。例如 zone1 可能 passnum = 100 而 zone2 可能有 50

`<h5> </h5>`是否可以使用 jquery 根据区域将唯一的 passnum 值传递给每个区域？因为可能有数百个动态创建的区域块。

```
<div class="wrapper" class="zone1">

other divs here (could have unknown amount of div block or tages here

<div ><span class="pass-num"><h5>some num  </h5></span> </div>

</div>

<div class="wrapper" class="zone2">

other divs here (could have unknown amount of div block or tages here

<div><span class="pass-num"><h5>some num(pass val here)  </h5></span> </div>

</div>

I have cthe ode below which works when u know the zone and structure

$(document).ready(function() {

            var passnum ="110";
            var passtext="All";

            $('div.pass-text>h4').text(passtext);
            $('div.pass-num>h4').text(passnum);

    });
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:57:20.923

给定你的 html，这个函数应该这样做：

```
function get_passnum(zone) {
   return $('.zone'+zone+' .pass-num').text();
} 
```

像这样使用它：

```
passnum = get_passnum(2); 
```

查看工作[**演示**](http://jsfiddle.net/gnel/rUYdk/)

# opengl - 绑定 OpenGL 纹理采样器

> ID：13031977
> 
> 赞同：8
> 
> 时间：2012-10-23T13:49:10.933
> 
> 标签：opengl, textures

我对如何将纹理绑定到 GLSL 中的插槽有点困惑。这是我的着色器：

```
#version 330

layout(location=0) in vec4 in_Position;
layout(location=1) in vec4 texCoords;
out vec4 ex_texCoords;

uniform mat4 ModelMatrix;
uniform mat4 ViewMatrix;
uniform mat4 ProjectionMatrix;

void main(void)
{
    gl_Position = (ProjectionMatrix * ViewMatrix * ModelMatrix) * in_Position;
    ex_texCoords = texCoords;
}

#version 330

in vec4 ex_texCoords;
out vec4 out_Color;

uniform sampler2D textureSampler;

void main(void)
{
    out_Color = texture(textureSampler2, ex_texCoords.xy);
} 
```

当我设置矩阵时，我需要查询统一位置，然后手动设置该位置的值，执行如下操作：

```
modelMatrixUniformLocation = glGetUniformLocation(ShaderIds[0], "ModelMatrix");
...
glUniformMatrix4fv(modelMatrixUniformLocation, 1, GL_FALSE, modelMatrix.data); 
```

但是，据我所知，我不需要这样做来初始化我的纹理采样器。在设置时，我似乎需要做的就是：

```
glGenTextures(1, &TextureID);
glBindTexture(GL_TEXTURE_2D, TextureID);
glTexImage2D(...); 
```

所以，我的问题是，为什么我不需要对纹理进行与矩阵相同的处理？OpenGL 运行时如何“知道”我绑定的纹理应该是我定义的采样器？如果我想拥有多个纹理，我会怎么做呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-23T14:10:59.503

OpenGL 不知道要使用哪个采样器，您必须使用`glActiveTexture(GL_TEXTUREi)`(where `i`from `0`to `GL_MAX_TEXTURES`) 手动绑定它。您的代码有效，因为默认采样器是`GL_TEXTURE0`. 显然你很幸运，着色器链接器设置`textureSampler`为 0。

此外，版本 3 和更高版本的 OpenGL API 中还有一个新功能 - [glGenSamplers](http://www.opengl.org/sdk/docs/man4/xhtml/glGenSamplers.xml)，[glBindSampler](http://www.opengl.org/sdk/docs/man4/xhtml/glBindSampler.xml)。它允许您使用与纹理无关的采样器配置！您可以阅读[http://www.g-truc.net/post-0267.html](http://www.g-truc.net/post-0267.html)了解更多详情。

我建议您从[http://www.g-truc.net/project-0026.html下载示例](http://www.g-truc.net/project-0026.html)

# sql - 派生表 SQL Server 2008 中的强制转换函数失败

> ID：13031980
> 
> 赞同：4
> 
> 时间：2012-10-23T13:49:26.183
> 
> 标签：sql, sql-server, casting

我有一张带有字母数字代码的表格。在这个特定的例子中，我不关心本质上是字母数字的代码，只关心那些包含整数的代码。我写了一个小查询来查找我需要的代码子集：

```
 select CAST(icd as float) as icd

from
(
select i.icd
    from icd as i
    where icd like '952%' or icd like '806%' or icd like '3440%' or icd like '3441'
)t 
```

这将返回我需要的代码列表。但是，当我尝试使用 where 子句时：

`where icd between 80600 and 80610`查询失败，告诉我它无法将 varchar 数据类型转换为 int。但是，如果我做类似的事情

```
select CAST(icd as float) as icd,icd+10

from
(
select i.icd
    from icd as i
    where icd like '952%' or icd like '806%' or icd like '3440%' or icd like '3441'
)t 
```

我可以在每个代码中添加 10 并且它运行，这意味着它们实际上是整数。我想使用这样的`where`子句，因为代码 80600-80610 应该标记为 X，而 80611-80620 它们应该标记为 Y。我可以为每个代码手动执行此操作，但我希望比这更可扩展。

如何确保 SQL Server 在使用此 where 子句时只查看派生表，而不是失败？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:54:13.357

您的内部查询可能返回 varchar 字段。你能跑吗

```
select i.icd
from icd as i
where icd like '952%' or icd like '806%' or icd like '3440%' or icd like '3441' 
```

并确保没有返回字符串数据？

仅供参考，由于您使用的是内部查询，您可以添加

```
WHERE IsNumeric(t.icd ) = 1 
```

确保只返回整数

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T13:53:25.063

## 在转换结果之前运行过滤器

您正在做的是在查询运行时转换结果而不是列值（并进行所有过滤）。`where`在转换结果值之前评估过滤器（子句）。

为了仍然使用您在示例中显示的相同结果集，最简单的方法是使用 CTE 而不是子查询，然后对其进行额外的过滤：

```
with codes as (
    select cast(icd as int) as icd
    from icd
    where icd like '952%' or
          icd like '806%' or
          icd like '3440%' or
          icd like '3441'
)
select icd, 'X' as label
from codes
where icd between 80600 and 80610
union all
select icd, 'Y'
from codes
where icd between 80611 and 80620 
```

CTE 是否比子查询更具可读性是一个无休止的讨论/争论的问题。但是在这种情况下，我们重用相同的表表达式来获得**X**和**Y**标记的结果，与对子查询执行相同操作时所需的代码相比，它使用的代码更少。在这种情况下，它的可读性要高得多。

## 要转换的数据当然必须是数字

当您转换数据时，您必须确保它实际上可以转换为结果类型。如果您的值是`064 V`这显然不是一个数字，因此不能转换。致电`isnumeric`可以在这里提供帮助：

```
with codes as (
    select cast(icd as int) as icd
    from icd
    where isnumeric(icd) = 1 and
          (
              icd like '952%' or
              icd like '806%' or
              icd like '3440%' or
              icd like '3441'
          )
)
select icd, 'X' as label
from codes
where icd between 80600 and 80610
union all
select icd, 'Y'
from codes
where icd between 80611 and 80620 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-23T13:54:24.987

您需要确保您的 where 过滤器将 ICD 视为字符串（确实如此），然后仅过滤那些可转换为数字的 ICD。

特别要注意的是，字符串比较需要注意数字的“长度”（例如，“8061”位于“80600”和“80610”之间），但幸运的是，您的过滤器似乎位于长度是恒定的。

例如

```
where icd between '80600' and '80610' -- i.e. exclude '12345' and 'Apple'
      and length(icd) = 5             -- i.e. exclude '8061' and '806000001'
      and isnumeric(icd) = 1          -- i.e. exclude '8060A' 
```

# bash - 添加到路径以便文件在任何地方都可用 - bash

> ID：13031982
> 
> 赞同：1
> 
> 时间：2012-10-23T13:49:29.697
> 
> 标签：bash, unix, path, terminal, ubuntu-11.10

我正在尝试将几个目录添加到我的路径中，以便该目录中的文件及其子目录可供我从跨会话的命令提示符使用。

```
export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/home/username/OpenFOAM/OpenFOAM-2.1.0/etc/bashrc:/usr/share/texmf-texlive/tex/latex:/etc/crontab:/home/username/Research/Dissertation/wigner/ic/L=lambda:/home/username/Research/Dissertation/wigner/ic/L=2lambda:/home/username/Research/Dissertation/wigner/ic/L=3lambda:/home/username/Research/Dissertation/wigner/ic 
```

追加以下内容

```
 /home/username/Research/Dissertation/wigner/ic/L=lambda:/home/username/Research/Dissertation/wigner/ic/L=2lambda:/home/username/Research/Dissertation/wigner/ic/L=3lambda:/home/username/Research/Dissertation/wigner/ic 
```

到`export PATH`我的生产线`.bashrc`并采购它并没有帮助。我究竟做错了什么？当我尝试从 say 访问文件时`/home/username/Research/Dissertation/wigner/ic`，我不能。

我在这里阅读了一些帖子，但它们并没有真正帮助。我是否缺少冒号、分号、美元符号？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T13:55:16.653

听起来您可能误解了`$PATH`. `$PATH`只是告诉 Bash 在哪里寻找可执行文件和脚本。例如，这个命令：

```
foo bar.txt 
```

将（通常）搜索`$PATH`名为 的可执行文件`foo`，以及以下命令：

```
bash foo.sh
. foo.sh 
```

将（通常）搜索`$PATH`，`foo.sh`除非`foo.sh`当前目录中有 a；但这些命令：

```
cat foo.txt
vi foo.txt
less foo.txt 
```

不会搜索。*_*`$PATH` _`foo.txt`

此外，您写的是“该目录中的文件及其子目录”，但`$PATH`对子目录没有用。Bash 永远不会搜索`$PATH`可执行文件名是否包含`/`. 例如，这个命令：

```
foo/bar baz.txt 
```

将运行`./foo/bar`，并且*不会*搜索`$PATH`名为`foo`.

* * *

**编辑添加：**所以，你可以做什么。. .

最终，您需要在`montage`命令中包含目录信息：

```
cd /home/username/Research/Dissertation/wigner/ic
montage -geometry +4+4 L=3lambda/three.jpg L=2lambda/two.png output.jpg 
```

如果每次都输入目录信息太麻烦，您可以在 中设置自己的变量`.bashrc`，然后显式使用它。例如，`.bashrc`可能有：

```
export IC=/home/username/Research/Dissertation/wigner/ic
export ICL=$IC/L=lambda
export ICL2=$IC/L=lambda2
export ICL3=$IC/L=lambda3 
```

然后你可以写：

```
montage -geometry +4+4 $ICL3/three.jpg $ICL2/two.png output.jpg 
```

如果您甚至不想记住给定文件所在的子目录，则可以使用 fileglob：

```
export IC=/home/username/Research/Dissertation/wigner/ic
export ICLs=$IC/L=lambda* 
```

和写：

```
montage -geometry +4+4 $ICLs/three.jpg $ICLs/two.png output.jpg 
```

让外壳为您找到它。（当然，这只有在不同子目录中的文件之间没有名称冲突的情况下才能正常工作。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T14:06:48.023

您可以在 中定义一些变量`.bashrc`：

```
H="/home/username/Research/Dissertation/wigner/ic"    
oneLam="$H/L=lambda"
twoLam="$H/L=2lambda"
threeLam="$H/L=3lambda" 
```

这样就可以从任何地方引用文件，如下所示：

```
user@box:/some/horrendously/deep/path/$ vi $twoLam/some_file.txt 
```

# android - 根据日期选择器更改从数据库重新加载 ListView 内容

> ID：13031983
> 
> 赞同：1
> 
> 时间：2012-10-23T13:49:39.043
> 
> 标签：android, listview, filter, android-cursorloader

我首先要说这是一个两部分的问题。我有一个带有 3 个按钮和一个列表视图的活动。一个按钮打开一个带有日期选择器的对话框片段，按钮文本显示选定的日期。其他 2 个按钮可让您分别前往前/后几天。ListView 应显示与所选日期相对应的记录。

目前，加载活动时，按钮显示今天的日期，列表视图显示数据库中今天的记录。我设法创建了一个重新启动加载程序并在上一个/下一个按钮中调用它的方法，因此当一次导航一天时，列表视图会更新以显示正确的记录，但是当我通过调用 datepicker 更改日期时对话框，我似乎找不到让它正确更新的方法 - 这是问题的第一部分。

第二部分有点难以解释。当我选择一个有 4 条记录（列表视图中的 4 行）的日期时，所有 4 条记录都会显示，但是例如，如果我去第二天只有 2 条记录（列表视图中的 2 行），它将正确显示第一个2 条记录，但接下来的 2 行仍显示上一个日期的数据。为了更好地解释这一点，我们假设列表视图中的每一行都显示了数据库记录 _id 编号。在日期 1（有 4 条记录）我显示 ID 1、2、3、4，但是当更改为日期 2（有 2 条记录）时，它显示 ID 5、6、3、4。

我假设通过合并一个完全清除列表视图内容然后重新填充新日期的方法，我可以同时解决这两个问题。我只是不确定该怎么做。我的代码如下：

```
public class FuncLogbook extends ListActivity implements
LoaderManager.LoaderCallbacks<Cursor>, OnItemClickListener {        

Button btn_logbook_date;

LogDateDialogFragment fragDate;
Calendar now;
Date nowD, newD, PrevDate, NextDate;

int lMonth;
String strDate;

private SimpleCursorAdapter adapter;        

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView (R.layout.dash_logbook);     
    this.getListView().setDividerHeight(2);         

    ListView list = getListView();
    list.setOnItemClickListener(this);

    btn_logbook_date = (Button) findViewById(R.id.btn_logbook_date);
    now = Calendar.getInstance();
    nowD = now.getTime();

    SimpleDateFormat dFormatter = new SimpleDateFormat("dd MMM yyyy");
    strDate = dFormatter.format(nowD);
    btn_logbook_date.setText(strDate);              

    fillData();             
}       

public void modifyDate(View v) {
    int id = v.getId ();
    switch (id) {
    case R.id.btn_logbook_date :
        showDialogDate();
        break;
    case R.id.btn_logbook_prev :
        updateDatePrev();
        break;
    case R.id.btn_logbook_next :
        updateDateNext();
        break;
    }   
}

public interface LogDateDialogFragmentListener {
    public void logbookChangedDate(int year, int month, int day);
}

public void showDialogDate() {
    FragmentTransaction ftLogDate = getFragmentManager().beginTransaction();
    fragDate = LogDateDialogFragment.newInstance(this, new LogDateDialogFragmentListener() {
        public void logbookChangedDate(int year, int month, int day) {          
            now.set(Calendar.YEAR, year);
            now.set(Calendar.MONTH, month);
            now.set(Calendar.DAY_OF_MONTH, day);
            newD = now.getTime();
            SimpleDateFormat newDFormatter = new SimpleDateFormat("dd MMM yyyy");
            strDate = newDFormatter.format(newD);
            btn_logbook_date.setText(strDate);
        }}, now);
    fragDate.show(ftLogDate, "DateDialogFragment");     
}

public void updateDatePrev() {
    String prevVar[] = btn_logbook_date.getText().toString().split(" ");

    if (prevVar[1].equalsIgnoreCase("Jan")) {
        lMonth = 0;
    } else if (prevVar[1].equalsIgnoreCase("Feb")) {
        lMonth = 1;
    } else if (prevVar[1].equalsIgnoreCase("Mar")) {
        lMonth = 2;
    } else if (prevVar[1].equalsIgnoreCase("Apr")) {
        lMonth = 3;
    } else if (prevVar[1].equalsIgnoreCase("May")) {
        lMonth = 4;
    } else if (prevVar[1].equalsIgnoreCase("Jun")) {
        lMonth = 5;
    } else if (prevVar[1].equalsIgnoreCase("Jul")) {
        lMonth = 6;
    } else if (prevVar[1].equalsIgnoreCase("Aug")) {
        lMonth = 7;
    } else if (prevVar[1].equalsIgnoreCase("Sep")) {
        lMonth = 8;
    } else if (prevVar[1].equalsIgnoreCase("Oct")) {
        lMonth = 9;
    } else if (prevVar[1].equalsIgnoreCase("Nov")) {
        lMonth = 10;
    } else if (prevVar[1].equalsIgnoreCase("Dec")) {
        lMonth = 11;
    }

    int lYear = Integer.parseInt(prevVar[2]);
    int lDay = Integer.parseInt(prevVar[0]);
    now = Calendar.getInstance();
    now.set(Calendar.YEAR, lYear);
    now.set(Calendar.MONTH, lMonth);
    now.set(Calendar.DAY_OF_MONTH, lDay - 1);
    PrevDate = now.getTime();
    SimpleDateFormat prevDFormatter = new SimpleDateFormat("dd MMM yyyy");
    strDate = prevDFormatter.format(PrevDate);
    btn_logbook_date.setText(strDate);

    refillData();       
}

public void updateDateNext() {
// Same as updateDatePrev() method, but moves forward 1 day, instead of backward
}

protected void onActivityResult(int requestCode, int resultCode, Intent intent) {
    super.onActivityResult(requestCode, resultCode, intent);
}

private void fillData() {       
    String[] from = new String[] { AddDBHelper.KEY_BGL, AddDBHelper.KEY_ROWID,
            AddDBHelper.KEY_CATEG, AddDBHelper.KEY_TIME };
    int[] to = new int[] {R.id.logBGL, R.id.logRowID, R.id.logCateg, R.id.logTime };

    getLoaderManager().initLoader(0, null, this);
    adapter = new SimpleCursorAdapter(this, R.layout.logbook_item, null, from, to, 0);

    setListAdapter(adapter);
}

private void refillData() { 
    getLoaderManager().restartLoader(0, null, this);        
}

public Loader<Cursor> onCreateLoader(int id, Bundle args) { 
     String selection = AddDBHelper.KEY_DATE + "=?";
     String[] selectionArgs = { String.valueOf(btn_logbook_date.getText().toString()) };

    CursorLoader cl = new CursorLoader(this, DBProvider.CONTENT_URI,
            null, selection, selectionArgs, null);
    return cl;
}

public void onLoadFinished(Loader<Cursor> loader, Cursor data) {
    adapter.swapCursor(data);
}

public void onLoaderReset(Loader<Cursor> loader) {
    // data is not available anymore; delete reference
    adapter.swapCursor(null);
}
} 
```

**更新**

显示来自 ContentProvider 的查询信息：

```
@Override
public Cursor query(Uri uri, String[] projection, String selection, String[] selectionArgs,
        String sortOrder) {

    // Using SQLiteQueryBuilder instead of query() method
    SQLiteQueryBuilder queryBuilder = new SQLiteQueryBuilder();     

    // Set the DB table to query
    queryBuilder.setTables(AddDBHelper.DB_TABLE);

    int uriType = sURIMatcher.match(uri);
    switch (uriType) {
    case DBAllEntries:
        //no filter or WHERE clause
        break;
    case DBSingleEntry:
        //add ROWID filter when selecting individual item
        queryBuilder.appendWhere(AddDBHelper.KEY_ROWID + "="
                + uri.getLastPathSegment());
        break;      
    default:
        throw new IllegalArgumentException("Unknown URI: " + uri);
    }

    SQLiteDatabase sqlDB = mDBP.getWritableDatabase();
    Cursor cursor = queryBuilder.query(sqlDB, projection, selection,
            selectionArgs, null, null, sortOrder);
    // Ensure potential listeners are getting notified
    cursor.setNotificationUri(getContext().getContentResolver(), uri);

    return cursor;
} 
```

**更新**

下面的调用适用于`refillData()`第一次日期更改，但没有再次起作用。重新启动模拟器并再次尝试后，我能够看到 2 个单独的日期更改的记录，但它不会再次更改数据。

```
public void showDialogDate() {
    FragmentTransaction ftLogDate = getFragmentManager().beginTransaction();
    fragDate = LogDateDialogFragment.newInstance(this, new LogDateDialogFragmentListener() {
        public void logbookChangedDate(int year, int month, int day) {          
            now.set(Calendar.YEAR, year);
            now.set(Calendar.MONTH, month);
            now.set(Calendar.DAY_OF_MONTH, day);
            newD = now.getTime();
            SimpleDateFormat newDFormatter = new SimpleDateFormat("dd MMM yyyy");
            strDate = newDFormatter.format(newD);
            btn_logbook_date.setText(strDate);

            refillData();

        }}, now);
    fragDate.show(ftLogDate, "DateDialogFragment");     
} 
```

通过以下调用，日期更改后数据不会更改，但是当我按下按钮再次打开日期选择器时，我可以看到后台（对话框片段后面）的列表视图更新。比如我选择日期2，数据不变。我打开日期选择器并在对话框后面显示日期 2 数据。我将日期选择器设置为日期 3，但列表视图仍显示日期 2 的数据。如果再次打开日期选择器，日期 3 的数据会在对话框片段后面的后台加载。

如果我`refillData()`在`FragDate.show(...)`线路之后或线路之前调用，我会得到相同的结果`FragmentTransaction ftLogDate...`。

```
public void showDialogDate() {
    FragmentTransaction ftLogDate = getFragmentManager().beginTransaction();
    fragDate = LogDateDialogFragment.newInstance(this, new LogDateDialogFragmentListener() {
        public void logbookChangedDate(int year, int month, int day) {          
            now.set(Calendar.YEAR, year);
            now.set(Calendar.MONTH, month);
            now.set(Calendar.DAY_OF_MONTH, day);
            newD = now.getTime();
            SimpleDateFormat newDFormatter = new SimpleDateFormat("dd MMM yyyy");
            strDate = newDFormatter.format(newD);
            btn_logbook_date.setText(strDate);              
        }}, now);
    refillData();
    fragDate.show(ftLogDate, "DateDialogFragment");     
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T13:30:31.527

让`FuncLogbook`活动实现日期设置事件的侦听器`LogDateDialogFragmentListener`：

```
public class FuncLogbook extends ListActivity implements
LoaderManager.LoaderCallbacks<Cursor>, OnItemClickListener, LogDateDialogFragmentListener {

//... 
```

然后你需要`logbookChangedDate`在活动中实现：

```
@Override
public void logbookChangedDate(int year, int month, int day) {          
            now.set(Calendar.YEAR, year);
            now.set(Calendar.MONTH, month);
            now.set(Calendar.DAY_OF_MONTH, day);
            newD = now.getTime();
            SimpleDateFormat newDFormatter = new SimpleDateFormat("dd MMM yyyy");
            strDate = newDFormatter.format(newD);
            btn_logbook_date.setText(strDate);
            refillData();
} 
```

显示对话框的方法是：

```
public void showDialogDate() {
    FragmentTransaction ftLogDate = getFragmentManager().beginTransaction();
    fragDate = LogDateDialogFragment.newInstance(this, now);
    fragDate.show(ftLogDate, "DateDialogFragment");     
} 
```

`LogDateDialogFragment`然后，您可以在`onAttach`回调中或使用另一个 setter 方法将活动注册为侦听器。

# mockito - 使用 mockito 测试 DAO 会话为空

> ID：13031985
> 
> 赞同：1
> 
> 时间：2012-10-23T13:49:42.117
> 
> 标签：mockito

我正在使用 Mockito 进行 DAO 测试，但是当我调用`save`具有会话的方法时：`Session session = (Session) getEntityManager().getDelegate();`，但是`session`来了`null`，我不知道发生了什么，有人可以帮助我吗？

```
Mockito.when(MyDAOImplMock.salvarOuEditar(object)).thenReturn(object);
objectTest = MyDAOImpl.salvarOuEditar(object);
Mockito.verify(MyDAOImplMock).salvarOuEditar(object); 
```

`MyDAOImplMock`是我的 DAO 实现的模拟，并且`MyDAOImpl`是我的 DAO 实现的一个实例。

```
@Override
@Transactional(readOnly = false, propagation = Propagation.REQUIRED)
public T salvarOuEditar(T entidade) {
    Session session = (Session) getEntityManager().getDelegate();
    session.saveOrUpdate(entidade);
    return entidade;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:26:02.323

```
@Autowired
private MyDAOImpl myDAOImpl;

@PersistenceContext
private EntityManager entityManager;

@Before
public void init() {
    myDAOImpl.setEntityManager(entityManager);
    objectTeste = new MyObject();
    object = new MyObject();
}

@Test
    public void testSave() {
    objectTeste = myDAOImpl.salvarOuEditar(object);
    Assert.assertEquals(objectTeste, object);
    Assert.assertEquals(object.getId(), objectTeste.getId());
} 
```

这样会话就不会为空！谢谢大家！

# .net - 当我在 IIS7 中将 png 保存到 MemoryStream 时，GDI+ 中发生一般错误

> ID：13031988
> 
> 赞同：4
> 
> 时间：2012-10-23T13:49:46.220
> 
> 标签：.net, iis-7, bitmap, png, memorystream

当我尝试将 png 保存到内存流时出现错误。在我的 ASP.NET 开发服务器上，一切正常，但是当我在 IIS7 下运行站点时 - 生成了一个错误。此外，当我尝试保存 jpg 格式时 - 一切都正确。在 IIS 中，我将 .NET Trusted Level 设置为 Full。但它仍然不起作用。我需要你的帮助。

```
private static Stream DrawBarChart(IEnumerable<Tuple<string, ulong, double>> data){
using (MemoryStream stream = new MemoryStream())
{
    var canvasWidth = PageSize.A4.Width;
    var canvasHeight = PageSize.A4.Height;

    using (
        System.Drawing.Image bitmap = new Bitmap((int) canvasWidth,
                                                 (int) canvasHeight))
    {
        using (var graphics = Graphics.FromImage(bitmap))
        {
            var penBlack1 = new Pen(Brushes.Black, 1);

            graphics.DrawLine(penBlack1, 0, 0, canvasWidth, 0);
            graphics.DrawLine(penBlack1, 0, 0, 0, canvasHeight);

            graphics.Save();
        }
        bitmap.Save(stream, ImageFormat.Png);

    stream.Flush();
    stream.Position = 0;

    return stream;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T18:16:40.980

您的代码中至少有 2 个完全独立的问题导致其出现故障。

# 问题 #1：GDI+ 错误

这是一个反复出现的问题，在生态系统的各个地方不断涌现。我有它，我设法修复它，现在我不记得具体如何了。我试图复制您的问题，但未能收到失败消息。

我建议你检查这个线程：[http](http://forums.asp.net/t/624305.aspx/1) ://forums.asp.net/t/624305.aspx/1 这里有些人很高兴地通过以下方式克服了这个问题：

*   确保他们在处理其他绘图之前处理了所有的 Bitmap 实例
*   （**有趣的一个**）：做一个**GC.Collect()**（可能在每次位图渲染之后）

这不是我想尝试帮助您回答的主要原因。看来你已经做了（你说你做了）我通常做的所有事情，以确保我不会最终陷入这种情况（安全、信任等）。此外，您自己进行的清理工作超出了需要（阅读我的答案时您会发现有点太多了）。

我发现您的代码有第二个问题，您可能不知道。通过在我自己的 VS 环境中简单地解决这个问题，我成功地渲染了位图（在 IIS 7 和 Express 以及 ASP 开发服务器中）。

很有可能通过在应用程序代码中重新组织一些东西，您将设法解决问题 #1。所以：请查看我对问题 #2 的看法。

# 问题#2：不能同时处理和返回流

您不能返回刚刚创建**和处置**的流，例如：

```
public static Stream SomeMethod() {
  using (MemoryStream stream = new MemoryStream()) {
    // write something to the stream
    return stream;
  }
} 
```

我真的不明白那段代码在 ASP.NET 开发服务器中是如何工作的。我在这里要指出的问题是您的代码总是会抛出 ObjectDisposedException （无论您是将代码作为服务运行还是在交互式用户空间中运行）：

![无法访问已关闭的流](../Images/8b388824277cfc4e6ac5bb79e101265c.png)

谁关闭了流？**using**语句的终止。

# 问题 #2 的可能解决方案

这个特定问题的快速解决方案（可能会占用比您预期的更多的内存）是让您的方法返回一个 byte[] 而不是一个流。

```
public static byte[] SomeMethod() {
  using (MemoryStream stream = new MemoryStream()) {

    // ... create bitmap and render things ...

    // write something to the stream
    bitmap.Save(stream, ImageFormat.Png);

    return stream.ToArray();
  }
} 
```

允许我自己对您的应用程序需求做出假设，我会说这个其他解决方案可能会更好：

**如果**您希望将这些生成的图表图像以*<img>*标记返回到 Web 浏览器，并且您通过 ASP.NET 通用处理程序来完成此操作，那么您可以将 OutputStream 传递给当前 WebResponse**对**您的绘图方法，而不是从中获取结果 byte[] （或 Stream）**，**如下所示：

在 HTML 中：

```
<img src="path/Foo.ashx" alt="chart" ... etc ... /> 
```

在应用程序中：

```
public class Foo : IHttpHandler {
  public void ProcessRequest(HttpContext context) {

   context.Response.ContentType = "application/octet-stream";
   Stream alreadyExistingStream = context.Response.OutputStream;

   Etc.SomeMethod(stream);       
  }
}

public class Etc {

public static void SomeMethod(Stream stream) {
  // There used to be a using here that would create a stream
    // simply because the parameter name **stream** is the same as the former local var's name
    // the instructions that do the drawing of things 
    // + saving of the resulting Bitmap **to** the stream
    // keep on compiling without any problems

    // draw things to a bitmap
    // write the bitmap to the stream
    bitmap.Save(stream, ImageFormat.Png);

    // returning stuff is not needed anymore
  // This used to be the time and place where the stream would be disposed
  // and it's resources given back to the community
}

} 
```

# python - glob.glob 中的正则表达式用法？

> ID：13031989
> 
> 赞同：59
> 
> 时间：2012-10-23T13:49:50.027
> 
> 标签：python, glob

```
import glob

list = glob.glob(r'*abc*.txt') + glob.glob(r'*123*.txt') + glob.glob(r'*a1b*.txt')

for i in list:
  print i 
```

此代码用于列出当前文件夹中具有`'abc'`或其`'123'`名称的文件`'a1b'`。

我将如何使用一个`glob`来执行此功能？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-10-23T14:07:36.140

最简单的方法是自己过滤 glob 结果。以下是使用简单循环理解的方法：

```
import glob
res = [f for f in glob.glob("*.txt") if "abc" in f or "123" in f or "a1b" in f]
for f in res:
    print f 
```

您也可以使用正则表达式和 no `glob`：

```
import os
import re
res = [f for f in os.listdir(path) if re.search(r'(abc|123|a1b).*\.txt$', f)]
for f in res:
    print f 
```

（顺便说一句，命名变量`list`是个坏主意，因为`list`它是 Python 类型......）

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2018-07-09T12:57:18.923

我很惊讶这里没有使用过滤器的答案。

```
import os
import re

def glob_re(pattern, strings):
    return filter(re.compile(pattern).match, strings)

filenames = glob_re(r'.*(abc|123|a1b).*\.txt', os.listdir()) 
```

这接受任何返回字符串的迭代器，包括列表、元组、字典（如果所有键都是字符串）等。如果要支持部分匹配，可以更改`.match`为`.search`. 请注意，这显然会返回一个生成器，因此如果您想使用结果而不对其进行迭代，您可以自己将结果转换为列表，或者使用 list(...) 包装 return 语句。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-06-19T17:35:14.387

这是基于其他答案的现成方法。这不是最关键的性能，但它的工作原理与描述的一样；

```
def reglob(path, exp, invert=False):
    """glob.glob() style searching which uses regex

    :param exp: Regex expression for filename
    :param invert: Invert match to non matching files
    """

    m = re.compile(exp)

    if invert is False:
        res = [f for f in os.listdir(path) if m.search(f)]
    else:
        res = [f for f in os.listdir(path) if not m.search(f)]

    res = map(lambda x: "%s/%s" % ( path, x, ), res)
    return res 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-24T15:21:28.767

```
for filename in glob.iglob(path_to_directory + "*.txt"):
    if filename.find("abc") != -1 or filename.find("123") != -1 or filename.find("a1b") != -1:
        print filename 
```

# jacob - Jacob 64 位 dll 不适用于 jre 1.6

> ID：13031996
> 
> 赞同：0
> 
> 时间：2012-10-23T13:50:18.307
> 
> 标签：jacob

> **以下是我的项目边界**

视窗 7 64 位

jre 1.6 64位

雅各布 dll (jacob-1.17-M2-x64.dll)

> **问题是**

jacob-1.17-M2-x64.dll 在 jre 1.7 中支持，但在 jre 1.6 中不支持

> **抛出异常**

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: no jacob-1.17-M2-x64 in java.library.path
    at java.lang.ClassLoader.loadLibrary(Unknown Source)
    at java.lang.Runtime.loadLibrary0(Unknown Source)
    at java.lang.System.loadLibrary(Unknown Source)
    at com.jacob.com.LibraryLoader.loadJacobLibrary(LibraryLoader.java:184)
    at com.jacob.com.JacobObject.<clinit>(JacobObject.java:107)
    at com.osg.sqe.env.framework.control.web.Outlook.main(Outlook.java:14) 
```

请不要将其视为重复问题，因为我的问题不是“java.library.path”问题，因为我能够使用 jre1.7 运行应用程序而没有任何问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T06:30:33.683

这不是真的。我刚刚`jacob-1.17-M2-x64`使用以下命令运行：

```
%java% -Djava.library.path=%jacobPath% -cp %cp% %class% 
```

如果我输入了错误的 jacob 路径，则会收到一条消息：

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: no jacob-1.17-M2-x64 in java.library.path 
```

`java -version`：

```
java version "1.6.0_30"
Java(TM) SE Runtime Environment (build 1.6.0_30-b12)
Java HotSpot(TM) 64-Bit Server VM (build 20.5-b03, mixed mode) 
```

这是我的整个脚本：

```
@echo off
set jacobPath=C:\lang\java\jacob-1.17-M2
set cp=.;%jacobPath%\jacob.jar
set class=JacobFso
rem following line was to test 32-bit version
rem set java="C:\Program Files (x86)\Java\jre6\bin\java.exe"
set java=java.exe
set jdk=C:\Program Files\Java\jdk1.6.0_30\bin
"%jdk%\javac.exe" -cp %cp% %class%.java
if errorlevel 1 goto leave
rem my real, longer line, which I usually use
rem %java% -Djava.library.path=%jacobPath% -cp %cp% -Xms5m -Xss5m -Xmx5m -Dcom.jacob.debug=false -Dcom.jacob.autogc=false %class%
%java% -Djava.library.path=%jacobPath% -cp %cp% %class%
:leave 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-12T17:13:19.327

在 Eclipse 中将该 dll 作为本机库导入。那么它肯定会起作用