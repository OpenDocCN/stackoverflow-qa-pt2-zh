# StackOverflow 问答 15042000-15042999

# php - 使用 scp/sftp 传输在表单中选择的文件

> ID：15042003
> 
> 赞同：0
> 
> 时间：2013-02-23T15:11:48.667
> 
> 标签：php, forms, sftp, scp

我想通过 php 脚本中的 scp/sftp（我知道它们的语法）从 html 表单上传文件，而不是传统方式（上传到服务器的 /tmp 文件夹，然后调用 `move_uploaded_file`）。提交表单后，我只想从中获取上传文件的完整路径 `<input type="file"...>` 并将其传递给 `ssh2_scp_send` .

如果有办法请告诉我，如果没有，请解释原因。

顺便说一句，如果有一种方法可以在用户想要在服务器上上传文件的网页中选择（一些 gui/对话框），请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:23:54.983

您需要将服务器端与客户端分开。网页（客户端）通常无法直接在任何地方上传任何内容（不使用某些插件或小程序 - Java 小程序可以正常工作）。PHP 本身是一种服务器端语言（一般来说，我现在忽略边界情况）不能用于直接将文件从用户计算机传输到某个 SFTP 服务器。

所以最好的选择是让用户将文件作为表单的一部分上传到HTTP服务器，然后将接收到的文件上传到SFTP服务器。如果您不能这样做（例如，由于大小限制），您可以创建一个 Java 小程序，让用户选择文件并将其传输到服务器。

# perl - 在 perl 上模拟 coreutils 超时

> ID：15042004
> 
> 赞同：4
> 
> 时间：2013-02-23T15:11:48.883
> 
> 标签：perl, bash, timeout

我尝试使用 perl 替换超时（centos5 中需要）

这里的脚本：

```
#!/usr/bin/perl
use strict;
my $pid=$$;
my $timeout=shift;
my @args=@ARGV;
eval {
        local $SIG{ALRM} = sub {
          print "Timed OUT!\n";
          exit 142;
          kill 9,$pid;
        };
        alarm($timeout);
        system(@args);
};
exit $?; 
```

在测试时我发现：

**这里一切都好**

```
time /tmp/timeout 3 sleep 6
Timed OUT!

real    0m3.007s
user    0m0.000s
sys     0m0.004s 
```

**但这里都不好**

```
time echo `/tmp/timeout 3 sleep 6`
Timed OUT!

real    0m6.009s
user    0m0.000s
sys     0m0.004s 
```

在我测试过的debian系统上`/usr/bin/timeout`：

```
time echo `/usr/bin/timeout 3 sleep 6`

real    0m3.004s
user    0m0.000s
sys     0m0.000s 
```

**所以问题**

*   为什么 perl 脚本工作如此奇怪？
*   是否有任何真正的工作方式可以在 perl 上写入超时，这将与二进制超时相同？

*请注意，我知道`/usr/share/doc/bash-3.2/scripts/timeout`并且我还发现它与我的 perl 方法相同*

*另请注意，我无法在针对此脚本的服务器上安装来自 CPAN 的模块*

我试过了，`exec()`但在那种情况下，它不能处理 sub 中的信号。

**UPD**

使用来自@rhj 的脚本（必须稍作修正）

```
#!/usr/bin/perl
use strict;
use warnings;
my $PID=$$;
my $timeout=shift;
my @args=@ARGV;

my $pid = fork();
defined $pid or die "fork: $!";
$pid == 0 && exec(@args);

my $timed_out = 0;
$SIG{ALRM} = sub { $timed_out = 1; die; };
alarm $timeout;
eval { waitpid $pid, 0 };
alarm 0;
if ($timed_out) {
    print "Timed out!\n";
    kill 9, $pid;
    kill 9, $PID;
}
elsif ($@) {
    warn "error: $@\n";
} 
```

它通过了上述测试，但在调用外部脚本的情况下失败：

**运行脚本**

```
#!/bin/sh
sleep 6 
```

**测试.sh**

```
#!/bin/sh
a=`./timeout.pl 2 ./run_script.sh` 
```

**输出**

```
$ time ./test.sh 

real    0m6.020s
user    0m0.004s
sys     0m0.008s 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:31:01.757

此版本应始终有效：

```
#!/usr/bin/perl
use strict;
use warnings;
my $pid=$$;
my $timeout=shift;
my @args=@ARGV;

my $pid = fork();
defined $pid or die "fork: $!";
$pid == 0 && exec(@args);

my $timed_out = 0;
$SIG{ALRM} = sub { $timed_out = 1; die; };
alarm $timeout;
eval { waitpid $pid, 0 };
alarm 0;
if ($timed_out) {
    print "Timed out!\n";
    kill 9, $pid;
}
elsif ($@) {
    warn "error: $@\n";
} 
```

但是，它不处理 exec() 调用中的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T04:33:18.767

必须使用 IPC::Cmd；

```
#!/usr/bin/perl -w 
use strict;
use IPC::Cmd qw(run_forked);
my $timeout=shift;
my $stdout;
my $hashref = run_forked(@ARGV, { timeout => $timeout});
print $hashref->{'stdout'};
print STDERR $hashref->{'stderr'}; 
if ($hashref->{'timeout'}) {            
        print STDERR "Timed out!\n";
        exit 142;
}
exit $hashref->{'exit_code'}; 
```

我不得不使用 rpmforge 安装 IPC::Cmd 的坏事。

# java - 从文件中查找命令行中指定的单词

> ID：15042005
> 
> 赞同：-1
> 
> 时间：2013-02-23T15:11:50.603
> 
> 标签：java, command-line, client-server

我正在尝试从文件中搜索命令行中指定的单词。但是，当它正在运行时，它什么也不显示。问题可能是什么？这是我的代码的一部分。感谢你们对我的帮助！

```
class ClientHandler extends Thread {
        private Socket client;
        private Scanner input;
        private PrintWriter output;
        private ArrayList<String> quotes;
        public ClientHandler3(Socket socket, String file) {
            client = socket;
            try {
                BufferedReader buffer = new BufferedReader(new FileReader(file));
                BufferedReader reader = new BufferedReader(new InputStreamReader(client.getInputStream())); 
                String line = reader.readLine();
                try {
                    int ctr = 0;
                    quotes = new ArrayList<String>();
                    while(line != null){
                        quotes.add(ctr, line);

                        ctr++;
                        line = buffer.readLine();
                    }
                } catch (IOException e) {
                    e.printStackTrace();
                }

            } catch (FileNotFoundException e1) {
                e1.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }

            try {
                input = new Scanner(client.getInputStream());
                output = new PrintWriter(client.getOutputStream(), true);
            }
            catch(IOException e) {
                e.printStackTrace();
            }
        }

        public void run(String[] args) {
            String target;
            String message = "";
                target= args[3];
                for(int i = 0; i<quotes.size(); i++){
                    if(quotes.get(i).toUpperCase().contains(target.toUpperCase())){
                        output.println(quotes.get(i));
                    }
                }
                output.println("|");
            try {
                if (client != null) {
                    System.out.println("Closing down connection...");
                    client.close();
                }
            }
            catch(IOException e) {
                System.out.println("Unable to disconnect!");
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:24:21.553

您的客户端读取`args[1]`（主机），`args[2]`（端口），但不是`args[3]`要搜索的单词。

您的代码也很难阅读，因为它不遵守标准命名约定。类以大写字母开头，而方法以小写字母开头。您的代码执行相反的操作。

# java - Spring Autowire 原始布尔值

> ID：15042006
> 
> 赞同：1
> 
> 时间：2013-02-23T15:11:51.460
> 
> 标签：java, spring, autowired

我的 XML 配置包括这些 bean 定义：

```
<bean id="abstractFormAction" class="staffing.server.action.form.AbstractFormAction" abstract="true" parent="baseAction">
    <property name="volunteerSaver" ref="volunteerSaver"/>
    <property name="emailSender" ref="emailSender"/> 
    <property name="closed" value="${form.closed}"/>
</bean>

<bean id="volunteerFormAction" class="staffing.server.action.form.VolunteerFormAction" parent="abstractFormAction">
    <property name="captchaGenerator" ref="captcha"/>
</bean> 
```

表示VolunteerFormAction是AbstactFormAction的具体实现，会继承AbstactFormAction的属性。

在 AbstractFormAction 中，我声明如下属性：

```
@Autowired protected VolunteerSaver volunteerSaver;
@Autowired protected EmailSender emailSender;
@Autowired protected boolean closed; 
```

尝试部署时出现以下异常：

> org.springframework.beans.factory.BeanCreationException：创建名为“volunteerFormAction”的bean时出错：注入自动装配的依赖项失败；嵌套异常是org.springframework.beans.factory.BeanCreationException：无法自动装配字段：受保护的布尔staffing.server.action.form.AbstractFormAction.closed；嵌套异常是 org.springframework.beans.factory.NoSuchBeanDefinitionException：没有为依赖项找到类型为 [boolean] 的匹配 bean：预计至少有 1 个 bean 有资格作为此依赖项的自动装配候选者。依赖注解：{@org.springframework.beans.factory.annotation.Autowired(required=true)}

似乎在抱怨它找不到字节布尔值的 bean。但是，当通过值而不是引用定义属性“关闭”时，为什么它会想要一个 bean？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T15:17:00.733

您需要使用[@Value](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/beans/factory/annotation/Value.html)注释来使用属性占位符传递值。@Autowire 期望指定类型的 bean 出现在 applicationContext 中。

如果要自动装配值，为什么要将值传递到 bean 定义中？我想你需要的是

```
<bean id="abstractFormAction" class="staffing.server.action.form.AbstractFormAction" abstract="true" parent="baseAction"><bean>
<bean id="volunteerFormAction" class="staffing.server.action.form.VolunteerFormAction" parent="abstractFormAction">
    <property name="captchaGenerator" ref="captcha"/>
</bean> 
```

和

```
@Autowired protected VolunteerSaver volunteerSaver;
@Autowired protected EmailSender emailSender;
@Value("#{form.closed}") protected boolean closed; 
```

如果您可以使用[组件扫描](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html#beans-annotation-config)，您甚至不需要指定创建 bean

您可以添加`<context:component-scan base-package="<your base package>"/>`到您的 context.xml 文件并将注释添加`@Controller`到您的控制器文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:15:43.600

你不应该`closed`用`@Autowired`.

`@Autowired`指示 Spring 在您的上下文中查找自动装配字段（布尔）类型的 bean，这就是为什么它抱怨“没有匹配类型的 bean [boolean]”

如果您从 xml 配置中注入值，则不需要对该字段进行任何注释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T16:03:07.633

根据您显示的代码，您加载 Spring 上下文的方式可能存在问题。我的猜测是，您在根 Web 应用程序上下文和控制器*应该*存在的子上下文中都错误地对控制器进行了组件扫描。这意味着创建了这个类的*两个*实例，并且只有一个是通过 XML 配置的。Spring 正在尝试自动装配另一个实例并因给定错误而失败。您将在其他几个 SO 答案中找到问题和解决方案的描述，如下所示：

[在父上下文与子上下文中声明 Spring Bean](https://stackoverflow.com/questions/7746633/declaring-spring-bean-in-parent-context-vs-child-context/7748108#7748108)

[Spring XML 文件配置层次结构帮助/说明](https://stackoverflow.com/questions/7774295/spring-xml-file-configuration-hierarchy-help-explanation/7774597#7774597)

[Spring-MVC：什么是“上下文”和“命名空间”？](https://stackoverflow.com/questions/7451325/spring-mvc-what-are-a-context-and-namespace/7451389#7451389)

如果您提供有关配置文件和上下文配置的更多详细信息，那么有人可能会准确指出您出错的地方。

# sql - 如何将两个相同的数据库数据合并为一个？

> ID：15042007
> 
> 赞同：5
> 
> 时间：2013-02-23T15:11:58.887
> 
> 标签：sql, sql-server, sql-server-2005, stored-procedures

两个客户将合并。他们都在使用我的应用程序，以及他们自己的数据库。大约几周后，他们正在合并（他们成为一个组织）。所以他们希望将所有数据都放在一个数据库中。

所以这两个数据库结构是相同的。问题出在数据上。例如，我有表位置和人员（这些只是两个 50 人的表）：

**数据库 1：**

`Locations`：

```
Id    Name         Adress   etc....
1     Location 1
2     Location 2 
```

`Persons`：

```
Id    LocationId     Name     etc...
1     1              Alex
2     1              Peter
3     2              Lisa 
```

**数据库 2：**

`Locations`：

```
Id    Name         Adress   etc....
1     Location A
2     Location B 
```

`Persons`：

```
Id    LocationId     Name     etc...
1     1              Mark
2     2              Ashley
3     1              Ben 
```

我们看到那个人与位置有关（列`locationId`）。请注意，我有更多表是指位置表和人员表。

数据库包含它们自己的位置和人员，但 ID 可以相同。以防万一，当我想将所有内容导入 DB2 时，应将 DB1 的位置插入到 ID 为 3 和 4 的 DB2 中。来自 DB1 的人员应具有新的 ID 4、5、6 以及人员表中的位置必须更改为 ids 4,5,6。

我对这个问题的解决方案是编写一个处理所有事情的查询，但我不知道从哪里开始。

什么是最好的方法（在查询中）重新编号 Id 字段也对孩子有级联？数据库不包含参照完整性和外键（外键未在数据库中定义）。创建 FKey 和级联不是一种选择。

我正在使用 sql server 2005。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:37:27.273

你说这两个客户都在使用你的应用程序，所以我假设它是某种“收缩包装”软件，被更多的客户使用，而不仅仅是这两个，对吗？

如果是，向表中添加特殊列或类似的东西可能会在未来造成痛苦，因为您要么必须为这两个可以处理附加列的客户维护一个特殊版本。或者您必须将这些列引入您的主代码库，这意味着您的所有其他客户也会得到它们。

我可以想出一种更简单的方法来做到这一点，而无需更改任何表或添加任何列。
为了使它起作用，**您需要找出两个数据库中同时存在的最大 ID（无论它在哪个表或哪个数据库中）**。

这可能需要一些复制和粘贴来获得很多看起来像这样的查询：

```
select max(id) as maxlocationid from locations
select max(id) as maxpersonid from persons
-- and so on... (one query for each table) 
```

在两个数据库中运行查询后找到最大 ID 时，**取一个大于该 ID 的数字，并将其添加到第二个数据库中所有表的所有 ID 中。
该数字必须大于两个数据库中已经存在的最大 ID，这一点非常重要！**
这有点难以解释，所以这里有一个例子：

假设两个数据库中任何表中的最大 ID 都是`8000`.
然后运行一些 SQL 来添加`10000`到**第二个数据库**中每个表中的每个 ID ：

```
update Locations set Id = Id + 10000
update Persons set Id = Id + 10000, LocationId = LocationId + 10000
-- and so on, for each table 
```

查询相对简单，但这是最多的工作，因为您必须为数据库中的每个表手动构建这样的查询，并使用所有 ID 列的正确名称。

在第二个数据库上运行查询后，您问题中的示例数据将如下所示：

**数据库 1：（** *和以前完全一样）*

`Locations`：

```
Id    Name         Adress   etc....
1     Location 1
2     Location 2 
```

`Persons`：

```
Id    LocationId     Name     etc...
1     1              Alex
2     1              Peter
3     2              Lisa 
```

**数据库 2：**

`Locations`：

```
Id    Name         Adress   etc....
10001 Location A
10002 Location B 
```

`Persons`：

```
Id    LocationId     Name     etc...
10001 10001          Mark
10002 10002          Ashley
10003 10001          Ben 
```

就是这样！现在，您可以将数据从一个数据库导入另一个数据库，而根本不会违反任何主键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:18:47.210

如果这是我的问题，我可能会在要保留的数据库中的表中添加一些列。这些将用于存储来自其他数据库的 pk 值。然后我会从其他表中插入记录。对于那些有外键的，我会使用一个已知的值。然后我会根据需要更新并删除我添加的列。

# caching - 在运行时探索数据库类型方案

> ID：15042017
> 
> 赞同：3
> 
> 时间：2013-02-23T15:12:54.670
> 
> 标签：caching, database-design, entity-framework-5, scaffolding

我们使用在 Len Silverston 的 Data Model Resource Book Vol. 中找到的两种模式在 SQL Server 中构建了一个数据库。3，一个用于类型和类别：分类，另一个用于层次结构、聚合和对等关系。本质上，它的实现如下：

**分类**

[实体] (M x M) [EntityType] (M x M) [EntityTypeType]

...其中 (M x M) 是由分类表在数据库中实现的多对多关系。

**协会**

上面的实体和类型表也有自己的类型汇总：

*   [实体] (M x M) [实体]
*   [实体类型] (M x M) [实体类型]
*   [EntityTypeType] (M x M) [EntityTypeType]

...其中每个 (M x M) 是在汇总表中实现的多对多关系，具有汇总/关联类型的外键。

由此产生的数据结构在描述我们的实体及其相互关系方面为我们提供了巨大的表达能力。但是，我们在应用程序中利用这种表现力时遇到了麻烦。主要问题是，尽管 EF 4 和 5 取得了进步，但 M-2-M 关系仍然很棘手，而且每当我们访问数据库时，我们都会尝试在至少 2 个方向上访问 M-2-M。尤其复杂的是：

1.  我们对 [Entity] 和 [Entity] 的一些子类型进行子类型化。
2.  所有 M2M 表 - 所有分类和汇总/关联表 - 都有一个有效负载，其中至少包含一个 From 和 Thru 日期。汇总还包含至少一个汇总类型。
3.  我们不希望每次访问实体时都为了在运行时解释数据而加载输入模式的大而遥远的部分（EntityTypeType 表及其汇总）。

**技术**：

*   SQL Server 2008 R2
*   实体框架 5
*   .NET 4.5
*   MVC 4（在网络应用部分，我们也有一些控制台应用）

**关于模型本身的问题：**

*   这仅仅是 .NET 中不可行的数据模型吗？
*   我们是否应该首先将我们的数据库扁平化为对我们的业务对象进行建模的对 .NET 更友好的视图？

**关于打字方案的问题**- 请记住，类型是相当静态的：

*   我们是否应该将 [EntityType] 和 [EntityTypeType] 表、它们的分类以及它们汇总到 C# 类中？这将类似于枚举脚手架，只是我们需要的不仅仅是名称/int，因为它们具有有效负载日期范围和类型有效负载。如果是这样，对于如何将这些文件构建为静态类的一些想法是什么？硬编码的对象列表？
*   我们是否应该在启动时缓存打字方案（这让我很困扰，因为它增加了启动控制台应用程序的大量开销）？
*   任何其他想法 - 脚手架 XML 文件？ETC...

非常感谢任何想法或经验！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:02:12.097

我试图回答每个问题，但我不得不承认我不确定您是否尝试在运行时在数据库之上动态创建实体 - 或者您是否只是尝试在运行时动态创建实体.

如果您尝试发布在 SQL Server 中的架构更改时动态更改/调整的代码，那么我会有一些不同的答案。=)

> 这仅仅是 .NET 中不可行的数据模型吗？

你提到的一些让我印象深刻的事情：

1.  很多 M x M 关系。
2.  实体/实体类型/实体类型类型
3.  汇总

我阅读后的一些问题：

1.  你们是否选择了一个数据建模框架，希望它能让一切变得更容易？
2.  你选择一个框架是因为它看起来是“正确”的方式吗？
3.  我很难理解你是如何对数据建模的。EntityTypeType 到底是什么？
4.  真的需要所有 M x M 关系吗？仅仅因为实体 A 和实体 B 可以处于 M x M 关系，他们应该吗？

我不知道您的域名，但我知道我很难按照您的描述进行操作。=）在我看来，它已经变得有些不可行，原因有两个：1）你在问这个问题，b）没有很多文字就不容易描述。

> 我们是否应该首先将我们的数据库扁平化为对我们的业务对象进行建模的对 .NET 更友好的视图？

是的！

至少根据我的经验，我会说是的。=)

我认为可以在数据库中创建具有复杂关系的实体。父/子、点对点、分层等。一切都很好，很正常。

但是应用程序不应该解释所有这些来理解它。该数据库擅长连接、分组数据、创建视图等。我建议创建尽可能接近您的业务对象的视图或存储过程 - 至少对于读取而言。

还要考虑到，如果您将关联对象的复杂性推到应用程序中，您可能会付出一些性能损失。

> 我们是否应该将 [EntityType] 和 [EntityTypeType] 表、它们的分类以及它们汇总到 C# 类中？

我建议不要这样做。唯一的原因是你现在在应用层做数据库工作。如果你想做加入/汇总/等。您在应用程序中管理该数据 - 而不是数据库。

我确定您已经知道这一点，但您希望避免将数据库中的所有内容带回应用程序，*然后*运行查询/构建对象。

SQL Server 非常擅长关联对象并将不同的实体组合在一起。在那个层它会非常快。

我将创建业务对象并从 SQL 填充这些对象。

如果您需要构建 EntityType/EntityTypeType，请注意不要遇到 N+1 问题。

> 关于如何将这些文件搭建为静态类的一些想法是什么？硬编码的对象列表？

选项：

1.  使用 ORM 为您生成类。您已经在 EF 中看到了其中的一些内容。
2.  通过查看实体的 SQL Server 架构来编写您自己的代码生成工具。
3.  手动编写未生成的类。我一直看到这样做，它并没有你想象的那么糟糕。绝对是一些繁重的工作，但也提供了灵活性。

> 我们是否应该在启动时缓存打字方案（这让我很困扰，因为它增加了启动控制台应用程序的大量开销）？

您想在应用程序加载时根据您的实体生成业务对象吗？或者另一种表达问题的方式......在运行时生成代理类？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T12:41:58.660

我不熟悉 Len Silverston 的书，而且我认为绝大多数 StackOverflow 用户也不熟悉。由于您在 3 天内没有得到问题的答案，我现在无论如何都会对此发表评论。

在您的数据库模型中让我感到奇怪的是，您似乎有多个嵌套的 N:M 关系。很少有真正的 N:M 关系 - 大多数时候 N:M 关系模型中的中间表实际上代表了现实生活中存在的对象，给您留下两个常规的 1:N 关系，并且不仅仅是两列链接表。在过去的 25 年中，我只遇到过一两个真正的 N:M 关系，所以我有点怀疑你实际上在这里有三个 - 看起来你使用的模式更有可能不适用于你认为的方式。

你描述的东西有点像你试图在数据库中建模一个数据库。尤其是“我们是否应该首先将我们的数据库扁平化为对我们的业务对象进行建模的对 .NET 更友好的视图？” 听起来很可疑。除了极少数例外，您的数据库表应该从一开始就与您的业务对象匹配。如果您需要创建一个平面视图来查看您的实际对象，那么您可能完全朝着错误的方向前进。但是话又说回来，很难从您提供的信息中分辨出来。

请对您正在尝试做的事情、到目前为止所做的事情做一个不那么抽象的描述。

# javascript - Chrome 扩展 img.onload 函数不断执行

> ID：15042019
> 
> 赞同：0
> 
> 时间：2013-02-23T15:13:26.850
> 
> 标签：javascript, image, google-chrome, onload

我正在编写一个阻止可能令人反感的内容的 Chrome 扩展程序。我正在实施的一种方法是扫描所有图像并查看显示了多少皮肤。我创建了一个新的图像对象，将 crossOrigin 标志设置为“”，然后创建一个 onload 函数，将图像绘制到画布上，从画布中读取数据，然后执行分析，为调用函数设置一个布尔标志. 定义 onload 函数后，我从网页的源列表中为我的图像节点分配一个 src。image_scanner 函数在 for 循环中调用，该循环遍历网页上的每个图像节点并执行各种操作以阻止。这是我执行的最后一个操作。这是调用 image_scanner 的代码：

```
 if (image_scanner(options.scanner_sensitivity, images[i]))
                {
               // Replace the image with a blank white image
               images[i].src = chrome.extension.getURL("replacement.png");

                } 
```

这是 image_scanner 函数

```
 function image_scanner(sensitivity, image)
    {
       // Sensitivity is a number and image is an image node.

      // Declare a variable to count the number of skin pixels
      var skin_count = 0;

      if (image.width == 0 && image.height ==0)
      {
       // This means the image has no size and we cannot block it.
       return false;
      } // end if

      var return_value = null; // set bool flag
      // Create an HTML5 canvas object.
   var canvas = document.createElement('canvas');

      //window.alert("Created Canvas."); // used for testing.

      // Get the context for the canvas.
      var context = canvas.getContext("2d"); // This is what we actually use to draw images and pull the data from them.

      context.canvas.width = image.width; // Set the canvas width to the width of the image
      context.canvas.height = image.height; // Set the canvas height to the height of the image

      img = new Image(); // Create a new image node to circumvent cross-domain restrictions.
      img.crossOrigin = " "; // Set crossOrigin flag to ' ' so we can extract data from it.

      img.onload = function(){
          window.alert(img.src); // This always gives the same src until Chrome ends the function
          context.drawImage(this, 0,0); // Draw the image onto the canvas.

          var pixels = context.getImageData(0, 0, image.width, image.height).data;

          // Now pixels is an array where every four entries in the array is the RGBa for a single pixel.
          // So pixels[0] is the R value for the first pixel, pixels[1] is the G value for the first pixel,
          // pixels[2] is the B value for the first pixel, and pixels[3] is the a (alpha or transparency) value for the first pixel.

          // This means that pixels.length/4 is the number of pixels in the image.
          // Now we calculate the number of skin pixels we can have before blocking the image.
          var limit = ((pixels.length)/4) * (sensitivity/100);

          // Now we go through the array of pixel data, checking if each pixel is a skin colored pixel based on its RGB value (the first 3 entries for that pixel in the pixels array)
          // Each time we find a skin colored pixel, we increment skin_count and check if skin_count >= limit. If so, we return true.
          for (var i = 0; i < pixels.length; i += 4) // We go up by four since every four entries describes 1 pixel
          {

           // pixel is skin if 0 <= (R-G)/(R+G)  <= .5  and B/(R+G) <= .5 pixels[i] is the R value, pixels[i+1] is the G value, and pixels[i+2] is the B value.
           if ((0 <= ((pixels[i] - pixels[i+1])/(pixels[i] + pixels[i+1]))) && (((pixels[i] - pixels[i+1])/(pixels[i] + pixels[i+1])) <= 0.5) && ((pixels[i+2]/(pixels[i] + pixels[i+1])) <= 0.5))
           {
               skin_count++;
               //window.alert("Found skin pixel."); // used for testing.

               if (skin_count >= limit)
               {
                   //window.alert("Blocking image with src: " + image.src); // used for testing.
                   img.onload = null; // try to clear the onload function
                   return_value = true;
                   return false;
               } // end inner if
           } // end outer if
          } // end for loop

       //var temp;
       img.onload = null;
       return_value = false;
       return false;

      }; // end onload function

   img.src = image.src; // Set the new image to the same url as the old one.    

   return return_value;
} // end image_scanner 
```

我不确定问题是什么，但是 onload 函数会运行，遍历像素，设置标志，返回，然后再次运行。我已经尝试在 Chrome 的调试器中进行调试，这就是我能找到的全部。我尝试在 onload 函数内部将 onload 设置为 null，但它不起作用。我试过从 onload 函数返回 false 。我试过在 image_scanner 函数中等待，直到 return_value != null，但这似乎进入了一个无限循环，我什至从未从 onload 函数中得到警报。如果有人知道为什么 onload 函数会重复执行，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:22:51.453

如果您要设置`.src`为空白图像并且不想`.onload`在加载时再次被调用，那么您应该`.onload`在设置之前清除`.src`。

```
if (image_scanner(options.scanner_sensitivity, images[i])) {
    // clear our onload handler
    images[i].onload = function() {};
    // Replace the image with a blank white image
    images[i].src = chrome.extension.getURL("replacement.png");
} 
```

看起来您正在从`onload`处理程序返回一个值，并期望从 image_scanner 函数返回该值。它不是那样工作的。onload 处理程序在很长一段时间后被调用，很久之后`image_scanner`已经返回。您将需要重写代码以使用`onload`.

# c# - 如何隔离 Razor 视图？

> ID：15042020
> 
> 赞同：5
> 
> 时间：2013-02-23T15:13:35.293
> 
> 标签：c#, asp.net-mvc-4, isolation, razor-2

有没有办法向人们公开 Razor 语法和（自定义）助手，但是说......不允许他们创建代码块，或者，只限制他们在助手的使用中并且不给他们执行纯的权力视图中的 C# 代码？

欢迎任何想法和类似解决方案的指针！

**更新：** //我想赋予用户编写自己的 HTML 并仅访问 html 助手列表的权力。主要是默认的和我创建的。

例如，我不希望他们能够在`@{ //code }`块内执行代码，也没有`using`和`@model`（不确定这个）只能访问`@Html.*` `@if` `else` `for` `foreach`

或者更好的是，只允许他们访问特定的命名空间（这只是一个想法）

update:// 经过一些测试，我发现 RazorEngine 与我正在尝试做的事情一样接近：在隔离环境中运行视图并添加对特定命名空间的访问。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T12:57:59.417

我不建议你这样做。根本没有一种简单可靠的方法可以在不损害站点安全性的情况下赋予他们这种能力。如果您信任您的用户，那么您可以做到。如果您不这样做，那么模板引擎[`DotLiquid`](http://dotliquidmarkup.org/)就更适合此目的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T23:33:36.393

您可以尝试更改 razor 视图引擎和相关类以检查不允许的情况。

生成源码时（查看引擎生成要编译的源文件），必须手动检查（通过解析c#或vb.net代码）。这是可能的，但不可行（真的）。

即使您设法解析和检查代码，您也必须识别您的代码（允许）和客户代码（有限制）。

最后，您必须接受这样一个事实，即除了使用另一个模板引擎之外，您不能真正禁止任何事情。

因为

1.  您的客户会找到一种方法让他们的观点看起来像您的观点。
2.  您不能限制最基本的必需功能，例如`var r = new Random();`
3.  你无法估计最基本的要求是什么
4.  当您的客户需要使用他们的自定义库时，您不能对他们说不

顺便说一句，你可以尝试另一件事。编写虚拟路径提供程序，并在`AviatrixTemplate`运行时请求时转换写入的客户模板。通过使用这条路线，您仍然使用剃须刀引擎，转换时仅松动一点时间（仅一次）。但是您`AviatrixTemplate`不会被突出显示，您仍然需要检查不允许的代码。

PS：一个基本的循环可能会给你的用户比你想要的更多。例如，下面的代码允许创建一个类并调用它一次。他们可以使用完全限定的类名，也可以使用`Activator.CreateInstance`.

```
@for (var r = new Random(); r != null; r = null)
{
    @r.NextDouble()
} 
```

只是不要打扰。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-28T03:25:33.240

有一个名为[RazorEngine](http://razorengine.codeplex.com/)的项目，它建立在 Microsoft 的 Razor 之上，它允许您在不返回 MVC 视图的上下文中解析该语法。以下是它的使用方法：

```
 string template = "Hello @Model.Name! Welcome to Razor!";
 string result = Razor.Parse(template, new { Name = "World" }); 
```

您还可以指定自定义模板库，它应该允许您仅定义要向用户公开的 Html 助手：

```
 Razor.SetTemplateBase(typeof(HtmlTemplateBase<>));

 string template = 
  @"<html>
      <head>
        <title>Hello @Model.Name</title>
      </head>
      <body>
        Email: @Html.TextBoxFor(m => m.Email)
      </body>
    </html>";

  var model = new PageModel { Name = "World", Email = "someone@somewhere.com" };
  string result = Razor.Parse(template, model); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T13:03:44.630

我以前从未这样做过，但听起来你想让用户能够编写代码并编译它以供使用，是吗？

如果是这样，您可能需要查看`CSharpCodeProvider`类、`RazorTemplateEngine`类和`System.CodeCom.Compiler`命名空间。

在这里查看有关这些类的一些信息：

CSharpCodeProvider： http: [//support.microsoft.com/kb/304655](http://support.microsoft.com/kb/304655)

RazorTemplateEngine： http: [//msdn.microsoft.com/en-us/library/system.web.razor.razortemplateengine (v=vs.111).aspx](http://msdn.microsoft.com/en-us/library/system.web.razor.razortemplateengine(v=vs.111).aspx)

# javascript - 在下划线 js 和骨干 je 中实现模板时出错

> ID：15042021
> 
> 赞同：0
> 
> 时间：2013-02-23T15:13:45.927
> 
> 标签：javascript, jquery, backbone.js, underscore.js

我在开始同时使用下划线 js 和骨干 js 时遇到了一些问题。我只能显示带有主干的普通 html，但我无法显示模板。

模板：

```
<script type="text/template" id="edit-user-template">
        <form class="edit-user-form">
            <legend>Create User</legend>
            <label>First Name</label>
            <input type="text" name="firstname" />
            <label>Last Name</label>
            <input type="text" name="lastname" />
            <label>Age</label>
            <input type="text" name="age" />
            <hr />
            <button type="submit" class="btn">Create a User</button>
        </form>
</script> 
```

看法：

```
var EditUser = Backbone.View.extend({
                el: '.page',
                template: _.template($('#edit-user-template').html),                
                render: function() {    
                this.$el.html(this.template({}));
                return this;
                }
            }); 
```

路线：

```
var Router = Backbone.Router.extend({
                routes:{
                    '':'home',
                    'new':'editUser'
                }
            });

            var userList = new UserList();
            var editUser = new EditUser();

            var router = new Router();
            router.on('route:home', function(){
                userList.render();
            });
            router.on('route:editUser', function(){
                editUser.render();
            });
            Backbone.history.start(); 
```

当我尝试在浏览器中加载页面时，出现错误：

> **未捕获的类型错误：对象函数** `(e){return b.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(gt,""):t;if(!("string"!=typeof e||Tt.test(e)||!b.support.htmlSerialize&&mt.test(e)||!b.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(vt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(b.cleanData(Ot(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)}` **没有“替换”方法下划线-min.js:1**

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:17:04.940

[`jQuery.html()`](http://api.jquery.com/html/)是一种方法，所以不是这个：

```
template: _.template($('#edit-user-template').html) 
```

你需要

```
template: _.template($('#edit-user-template').html()) 
```

# mongodb - mongoimport csv 忽略注释行

> ID：15042024
> 
> 赞同：0
> 
> 时间：2013-02-23T15:14:01.423
> 
> 标签：mongodb, mongoimport

我正在使用 csv 类型执行 mongoimport，但找不到忽略注释行的选项。我的 csv 已经注释了标有“#”作为起始字符的行。基本上，我通过 node.js 应用程序调用 MongoDB。没有办法忽略这些吗？有人可以建议是否有选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T13:08:58.313

[CSV (Comma Separated Values)](http://en.wikipedia.org/wiki/Comma-separated_values) format is intentionally simple and does not have support for comments. You'll have to pre-filter your commented lines before passing through to `mongoimport`.

`mongoimport` is intended to be used from a command-line, but you've mentioned you are talking to MongoDB from a Node.js app.

Rather than invoking `mongoimport`, I would recommend using a [node.js csv module](https://nodejsmodules.org/tags/csv). You can then easily do your own line-based filtering for comments or other format deviations, and insert using the [MongoDB driver](http://mongodb.github.com/node-mongodb-native/) directly.

# java - 如何在没有渲染的情况下在 Libgdx 中获取旋转网格的顶点？

> ID：15042025
> 
> 赞同：1
> 
> 时间：2013-02-23T15:14:15.213
> 
> 标签：java, android, rotation, libgdx, mesh

首先，我想知道是否可以在不绘制网格的情况下旋转网格。

如果可能的话，我怎么能得到旋转网格的新顶点？

我需要这个来验证旋转后某个网格是否仍然在矩形内，并且我只想在它仍然在里面时绘制它。

# php - 过滤掉早于当前日期的事件帖子

> ID：15042032
> 
> 赞同：1
> 
> 时间：2013-02-23T15:15:18.637
> 
> 标签：php, wordpress, date, filtering

如何过滤掉日期早于当前日期的活动帖子？如果该事件已过期，我当前的代码会向该事件添加一个过期的类，但因为我需要显示接下来的 5 个即将发布的帖子，当前代码实际上根本没有显示任何事件帖子......这是我的代码......

```
<?php 

 wp_reset_query();

 query_posts(array('post_type' => 'events',
           'showposts' => 5,
                   'meta_key'=>'event_date',  
           'orderby' => 'meta_value', 
           'order' => ASC));
            ?>

            <?php while (have_posts()) : the_post(); ?>

            <?php 

$eventDate = DateTime::createFromFormat('Ymd', get_field('event_date'));
$currentDate = new DateTime();

          ?>

             <li class="<? if ($eventDate < $currentDate) { echo "expired"; } ?>">
             <h4><a href="<?php the_permalink() ?>"><?php the_title(); ?></a></h4>
             <span class="date"><strong>Event Date:</strong> <? echo $eventDate->format('d/m/Y'); ?></span></li>

            <?php endwhile;?> 
```

请帮助某人:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:11:50.997

好回答你的问题。您可以使用元值比较日期，但请记住，这些日期需要采用 Mysql 格式 YYYY-MM-DD 才能在数据库中进行比较。因此，您的自定义字段需要采用该格式，或者您需要在使用之前在代码中重新格式化它。这是 Wordpress Stack 上的一个很好的主题；

[https://wordpress.stackexchange.com/questions/18303/fail-to-compare-dates-in-meta-query](https://wordpress.stackexchange.com/questions/18303/fail-to-compare-dates-in-meta-query)

我没有对此进行测试，但它应该为您指明正确的方向；

```
 $eventDate = date('Y-m-t', get_field('event_date'));
            $currentDate = date('Y-m-t');  

            $args = array(
                'post_type' => 'events',
                'posts_per_page' => '-1',
                'orderby'  => 'meta_value',
                'meta_query' => array(
                    'relation' => 'AND',
                    array(
                    'key' => $eventDate,
                    'value' => $currentDate,
                    'compare' => '>',
                    'type' => 'DATE'
                    )
                )   
            ); 
```

当然，另一种方法是将所有帖子拉入您的查询中，设置一个计数器并显示满足您条件的前五个；

```
<?php
 $counter = 0;

 query_posts(array('post_type' => 'events',
                   'posts_per_page' => -1,
                   'meta_key'=>'event_date',  
                   'orderby' => 'meta_value', 
                   'order' => ASC));

 while (have_posts()) : the_post(); 

    $eventDate = DateTime::createFromFormat('Ymd', get_field('event_date'));
    $currentDate = new DateTime();

    if ( ($eventDate > $currentDate) && $counter<5) : ?>

      <li class="<? if ($eventDate < $currentDate) { echo "expired"; } ?>">
         <h4><a href="<?php the_permalink() ?>"><?php the_title(); ?></a></h4>
         <span class="date"><strong>Event Date:</strong> <? echo $eventDate->format('d/m/Y'); ?></span></li>

      <?php
      $counter++;

    endif; ?> 
```

# delphi - 如何可靠地等待刚刚创建的线程？

> ID：15042038
> 
> 赞同：10
> 
> 时间：2013-02-23T15:15:46.833
> 
> 标签：delphi, delphi-xe3

考虑以下程序：

```
program TThreadBug;
{$APPTYPE CONSOLE}

uses
  SysUtils, Classes, Windows;

type
  TMyThread = class(TThread)
  protected
    procedure Execute; override;
  end;

procedure TMyThread.Execute;
var
  i: Integer;
begin
  for i := 1 to 5 do begin
    Writeln(i);
    Sleep(100);
  end;
end;

procedure UseTThread;
var
  Thread: TMyThread;
begin
  Writeln('TThread');
  Thread := TMyThread.Create;
  Thread.Terminate;
  Thread.WaitFor;
  Thread.Free;
  Writeln('Finished');
  Writeln;
end;

procedure UseTThreadWithSleep;
var
  Thread: TMyThread;
begin
  Writeln('TThreadWithSleep');
  Thread := TMyThread.Create;
  Sleep(100);
  Thread.Terminate;
  Thread.WaitFor;
  Thread.Free;
  Writeln('Finished');
  Writeln;
end;

begin
  UseTThread;
  UseTThreadWithSleep;
  Readln;
end. 
```

输出是：

```
线程
完成的

TThreadWithSleep
1
2
3
4
5
完成的

```

因此，出于某种原因，主线程似乎必须等待任意时间才能终止并等待工作线程。我是否认为这是一个错误`TThread`？有什么办法可以解决这个问题吗？我希望如果我让我的线程表明它已经开始（使用事件），那么这将解决这个问题。但这让我觉得很脏。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-23T15:22:27.967

你可以称之为错误或`TThread`设计缺陷，这个问题已经讨论过很多次了。参见例如[http://sergworks.wordpress.com/2011/06/25/sleep-sort-and-tthread-corner-case/](http://sergworks.wordpress.com/2011/06/25/sleep-sort-and-tthread-corner-case/)

问题是如果`TThread.Terminated`标志设置得太早，`TThread.Execute`则永远不会调用方法。所以在你的情况下，不要打电话`TThread.Terminate`before `TThread.WaitFor`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-25T19:32:10.377

我认为发生这种情况的原因已经被 Serg 的回答充分回答，但我认为你通常不应该调用 Thread.Terminate 无论如何。如果您希望线程终止，例如在应用程序关闭时，调用它的唯一原因。如果您只想等到它完成，您可以调用 WaitFor（或 WaitForSingleObject）。这是可能的，因为线程的句柄已经在其构造函数中创建，因此您可以立即调用它。

此外，我在这些线程上将 FreeOnTerminate 设置为 true。就让他们跑吧，让他们自由自在。如果我想要通知他们，我可以使用 WaitFor 或 OnTerminate 事件。

这只是一堆工作线程以阻塞方式清空队列的示例。

我认为你不应该需要这个，大卫，但也许其他人可能会对一个例子感到满意。另一方面，您可能不会问这个问题只是为了对 TThread 的糟糕实现进行更改，对吧？;-)

首先是队列类。我认为这不是一个真正的传统队列。在真正的多线程队列中，您应该能够随时添加到队列中，即使处理处于活动状态。此队列要求您预先填充其项目，然后调用 -blocking-run 方法。此外，已处理的项目将保存回队列。

```
type
  TQueue = class
  strict private
    FNextItem: Integer;
    FRunningThreads: Integer;
    FLock: TCriticalSection;
    FItems: TStrings; // Property...
  private

    // Signal from the thread that it is started or stopped.
    // Used just for indication, no real functionality depends on this.
    procedure ThreadStarted;
    procedure ThreadEnded;

    // Pull the next item from the queue.
    function Pull(out Item: Integer; out Value: string): Boolean;

    // Save the modified value back in the queue.
    procedure Save(Item: Integer; Value: string);

  public
    property Items: TStrings read FItems;
    constructor Create;
    destructor Destroy; override;

    // Process the queue. Blocking: Doesn't return until every item in the
    // queue is processed.
    procedure Run(ThreadCount: Integer);

    // Statistics for polling.
    property Item: Integer read FNextItem;
    property RunningThreads: Integer read FRunningThreads;
  end; 
```

然后是消费者线程。那是简单易行的。它只有一个对队列的引用，以及一个一直运行到队列为空的执行方法。

```
 TConsumer = class(TThread)
  strict private
    FQueue: TQueue;
  protected
    procedure Execute; override;
  public
    constructor Create(AQueue: TQueue);
  end; 
```

在这里，您可以看到这个不起眼的“队列”的实现。它的主要方法是 Pull 和 Save，消费者使用它们来拉下一个项目，并将处理后的值保存回来。

另一个重要的方法是 Run，它启动给定数量的工作线程并等待它们全部完成。所以这实际上是一个阻塞方法，只有在队列清空后才返回。我在这里使用 WaitForMultipleObjects，它允许您在需要添加额外技巧之前等待多达 64 个线程。这与在您问题的代码中使用 WaitForSingleObject 相同。

看看 Thread.Terminate 是如何从不被调用的？

```
{ TQueue }

constructor TQueue.Create;
// Context: Main thread
begin
  FItems := TStringList.Create;
  FLock := TCriticalSection.Create;
end;

destructor TQueue.Destroy;
// Context: Main thread
begin
  FLock.Free;
  FItems.Free;
  inherited;
end;

function TQueue.Pull(out Item: Integer; out Value: string): Boolean;
// Context: Consumer thread
begin
  FLock.Acquire;
  try
    Result := FNextItem < FItems.Count;
    if Result then
    begin
      Item := FNextItem;
      Inc(FNextItem);
      Value := FItems[Item];
    end;
  finally
    FLock.Release;
  end;
end;

procedure TQueue.Save(Item: Integer; Value: string);
// Context: Consumer thread
begin
  FLock.Acquire;
  try
    FItems[Item] := Value;
  finally
    FLock.Release;
  end;
end;

procedure TQueue.Run(ThreadCount: Integer);
// Context: Calling thread (TQueueBackgroundThread, or can be main thread)
var
  i: Integer;
  Threads: TWOHandleArray;
begin
  if ThreadCount <= 0 then
    raise Exception.Create('You no make sense no');
  if ThreadCount > MAXIMUM_WAIT_OBJECTS then
    raise Exception.CreateFmt('Max number of threads: %d', [MAXIMUM_WAIT_OBJECTS]);

  for i := 0 to ThreadCount - 1 do
    Threads[i] := TConsumer.Create(Self).Handle;

  WaitForMultipleObjects(ThreadCount, @Threads, True, INFINITE);
end;

procedure TQueue.ThreadEnded;
begin
  InterlockedDecrement(FRunningThreads);
end;

procedure TQueue.ThreadStarted;
begin
  InterlockedIncrement(FRunningThreads);
end; 
```

消费者线程的代码简单明了。它表示它的开始和结束，但这只是装饰性的，因为我希望能够显示正在运行的线程数，一旦创建了所有线程，它就处于最大值，并且只有在第一个线程退出后才开始下降（即即，当正在处理队列中的最后一批项目时）。

```
{ TConsumer }

constructor TConsumer.Create(AQueue: TQueue);
// Context: calling thread.
begin
  inherited Create(False);
  FQueue := AQueue;
  // A consumer thread frees itself when the queue is emptied.
  FreeOnTerminate := True;
end;

procedure TConsumer.Execute;
// Context: This consumer thread
var
  Item: Integer;
  Value: String;
begin
  inherited;

  // Signal the queue (optional).
  FQueue.ThreadStarted;

  // Work until queue is empty (Pull returns false).
  while FQueue.Pull(Item, Value) do
  begin
    // Processing can take from .5 upto 1 second.
    Value := ReverseString(Value);
    Sleep(Random(500) + 1000);

    // Just save modified value back in queue.
    FQueue.Save(Item, Value);
  end;

  // Signal the queue (optional).
  FQueue.ThreadEnded;
end; 
```

当然，如果你想查看进度（或至少一点），你不想要一个阻塞的 Run 方法。或者，像我一样，您可以在单独的线程中执行该阻塞方法：

```
 TQueueBackgroundThread = class(TThread)
  strict private
    FQueue: TQueue;
    FThreadCount: Integer;
  protected
    procedure Execute; override;
  public
    constructor Create(AQueue: TQueue; AThreadCount: Integer);
  end;

    { TQueueBackgroundThread }

constructor TQueueBackgroundThread.Create(AQueue: TQueue; AThreadCount: Integer);
begin
  inherited Create(False);
  FreeOnTerminate := True;
  FQueue := AQueue;
  FThreadCount := AThreadCount;
end;

procedure TQueueBackgroundThread.Execute;
// Context: This thread (TQueueBackgroundThread)
begin
  FQueue.Run(FThreadCount);
end; 
```

现在，从 GUI 本身调用它。我创建了一个表单，其中包含两个进度条、两个备忘录、一个计时器和一个按钮。Memo1 充满了随机字符串。处理完成后，Memo2 将接收处理后的字符串。计时器用于更新进度条，而按钮是唯一真正做某事的东西。

因此，表单只包含所有这些字段，以及对队列的引用。它还包含一个事件处理程序，以便在处理完成时得到通知：

```
type
  TForm1 = class(TForm)
    Button1: TButton;
    Memo1: TMemo;
    Memo2: TMemo;
    Timer1: TTimer;
    ProgressBar1: TProgressBar;
    ProgressBar2: TProgressBar;
    procedure Button1Click(Sender: TObject);
    procedure Timer1Timer(Sender: TObject);
  private
    Q: TQueue;
    procedure DoAllThreadsDone(Sender: TObject);
  end; 
```

Button1 点击事件，初始化 GUI，创建包含 100 个项目的队列，并启动后台线程来处理队列。此后台线程接收 OnTerminate 事件处理程序（TThread 的默认属性）以在处理完成时向 GUI 发出信号。

您可以在主线程中调用 Q.Run，​​但它会阻止您的 GUI。如果那是你想要的，那么你根本不需要这个线程！

```
procedure TForm1.Button1Click(Sender: TObject);
// Context: GUI thread
const
  ThreadCount = 10;
  StringCount = 100;
var
  i: Integer;
begin
  ProgressBar1.Max := ThreadCount;
  ProgressBar2.Max := StringCount;

  Memo1.Text := '';
  Memo2.Text := '';

  for i := 1 to StringCount do
    Memo1.Lines.Add(IntToHex(Random(MaxInt), 10));

  Q := TQueue.Create;
  Q.Items.Assign(Memo1.Lines);
  with TQueueBackgroundThread.Create(Q, ThreadCount) do
  begin
    OnTerminate := DoAllThreadsDone;
  end;
end; 
```

处理线程完成时的事件处理程序。如果您希望处理阻止 GUI，则不需要此事件处理程序，只需将此代码复制到 Button1Click 的末尾即可。

```
procedure TForm1.DoAllThreadsDone(Sender: TObject);
// Context: GUI thread
begin
  Memo2.Lines.Assign(Q.Items);
  FreeAndNil(Q);
  ProgressBar1.Position := 0;
  ProgressBar2.Position := 0;
end; 
```

计时器仅用于更新进度条。它获取正在运行的线程数（只有在处理几乎完成时才会减少），并获取“项目”，这实际上是下一个要处理的项目。因此，实际上最后 10 个项目仍在处理中时，它可能看起来已经完成。

```
procedure TForm1.Timer1Timer(Sender: TObject);
// Context: GUI thread
begin
  if Assigned(Q) then
  begin
    ProgressBar1.Position := Q.RunningThreads;
    ProgressBar2.Position := Q.Item;
    Caption := Format('%d, %d', [Q.RunningThreads, Q.Item]);
  end;
  Timer1.Interval := 20;
end; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-01T22:04:17.520

我不认为这种行为是 TThread 中的错误。新线程的执行应该独立于/异步于当前线程的执行发生。如果设置为保证新线程在 TThread.Create() 将控制权返回给当前线程中的调用者之前开始执行，则意味着新线程的执行（部分）与当前线程同步。

线程资源分配完毕后，新线程加入线程调度队列。如果您从头开始构建一个新线程（我似乎记得 TThread 确实如此），这可能需要一段时间，因为必须在幕后分配很多东西。避免启动线程的成本是创建 ThreadPool.QueueUserWorkItem 的原因。

此外，您看到的行为与您制定的说明非常吻合。构造一个新的 TThread。立即终止它。为什么期望新线程有机会执行？

如果您必须围绕线程创建进行同步行为，您至少需要放弃当前线程上剩余的时间片。睡眠（0）就足够了。Sleep(0) 放弃当前时间片的其余部分，并立即返回到任何其他线程（具有相同优先级）正在等待的调度队列中。

如果您观察到 Sleep(0) 不足以在当前线程调用 Terminate 之前启动并运行新线程，那么线程创建开销可能会阻止新线程尽快进入线程就绪队列以满足您的不耐烦当前线程。在这种情况下，尝试通过在挂起状态下构造新线程，然后启动新线程，然后在当前线程中休眠（0），然后终止新线程，来分离线程构造和执行的开销。这将使新线程在当前线程终止之前有最好的机会在当前线程之前进入线程就绪调度队列。

这与您将在 WinAPI 中获得“定向收益”一样接近，而无需来自新线程内部的显式合作或信号。来自新线程的显式合作/信号是保证调用线程将等到新线程开始执行之后的唯一方法。

线程之间的信号状态不是脏的。肮脏的是期望/需要新的线程构造来阻塞调用线程。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-09-17T12:26:39.807

正如已经解释的那样，您必须等待线程直到它开始之前调用，`Terminate`否则`TThread.Execute`将永远不会被调用。为此，您可以等到该属性`TThread.Started`为`true`.

```
while not Thread.Started do; 
```

您也可以[`TThread.Yield`](http://docwiki.embarcadero.com/Libraries/XE3/en/System.Classes.TThread.Yield)在等待线程启动时调用，因为这

> 通知系统它可以将执行传递给当前处理器上的下一个调度线程。操作系统将选择下一个线程。

```
while not Thread.Started do
  TThread.Yield; 
```

至少我们最终会得到

```
procedure UseTThreadWithYield;
var
  Thread: TMyThread;
begin
  Writeln('TThreadWithYield');
  Thread := TMyThread.Create;

  // wait for the thread until started
  while not Thread.Started do
    TThread.Yield;

  Thread.Terminate;
  Thread.WaitFor;
  Thread.Free;
  Writeln('Finished');
  Writeln;
end; 
```

和这样的生成输出

```
TThreadWithYield
1
2
3
4
5
完成的

```

# jquery - 如何检查相对于文本框的单选按钮？

> ID：15042042
> 
> 赞同：1
> 
> 时间：2013-02-23T15:16:56.167
> 
> 标签：jquery, textbox, focus, radio-button, checked

我正在尝试检查对所选文本框的引用，但是当我更改为其他文本框时，第一个单选按钮保持选中状态！而且我不知道如何根据每个文本框检查单选按钮。

```
<html>
<head>
<script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>
<p><input type="text" /> <input name="radio" type="radio" value="val1"/></p>
<p><input type="text" /><input name="radio" type="radio" value="val2"/></p>
<p><input type="text" /><input name="radio" type="radio" value="val3"/></p>
<p><input type="text" /><input name="radio" type="radio" value="val4"/></p>
<script>
$("input").focus(function () {
$('input:radio[name=radio]:nth(0)').attr('checked',true);

});
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:20:52.010

您可以[`.next()`](http://api.jquery.com/next/)用于您的特定布局。也就是说，考虑到单选按钮紧跟在输入文本之后。

```
$("input").focus(function() {
  $(this).next(":radio").prop("checked", true);
}); 
```

此外，从 jQuery 1.6 开始，建议`.prop()`在这种情况下使用。

[看这里。](http://jsfiddle.net/jZsRt/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:26:04.157

```
<html>
<head>
<script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>
<p><input type="text" /> <input name="radio" type="radio" value="val1"/></p>
<p><input type="text" /><input name="radio" type="radio" value="val2"/></p>
<p><input type="text" /><input name="radio" type="radio" value="val3"/></p>
<p><input type="text" /><input name="radio" type="radio" value="val4"/></p>
<script>
$(':text').focus(function () {
    $(this).parent().children('input[type=radio]').attr('checked',true);
});
</script>
</body>
</html> 
```

# sql - Oracle SQL - 只有在某个条件为真时才能连接两个表？

> ID：15042051
> 
> 赞同：2
> 
> 时间：2013-02-23T15:17:45.343
> 
> 标签：sql, oracle, oracle10g, oracle11g

我有一张我必须使用的桌子，不幸的是它的设计不是很好。该表列出了与其他产品匹配的现有产品。有两种类型的匹配：与主要类别产品的匹配和与替代类别产品的匹配。

只要有匹配项，该匹配项的 ID 就会填充到表的相关列中，如下面的 PRODUCT_MATCH 中所示。因此，在每个产品行中，将在 PRODUCT_MAIN_CATEGORY_ID 或 PRODUCT_ALTERNATIVE_CATEGORY_ID 中指定一个 PRODUCT_ID，但不会同时指定两者。

产品

```
PRODUCT_ID  PRODUCT_CATEGORY PRODUCT_SERIAL_NO
1001        Book             XSDAD132   
1002        MP3              X348023948
1003        DVD              5234234023948
2003        CD               SDRX83489
2002        Video            23423879JJ0 
```

PRODUCT_MATCH

```
PRODUCT_MATCH_ID, PRODUCT_ID, MAIN_CATEGORY_ID, ALTERNATIVE_CATEGORY_ID, PRODUCT_CATEGORY
1         1001      1002                        Book
2         1001                  1003            Book
3         1002      1004                        Book
4         2002                  1002            Video
5         2002      1003                        Video
6         2002      1001                        Video       
7         2002      1002                        Video       
8         1003                  2003            DVD 
```

我必须阅读 PRODUCT_MATCH 表，以便如果在 MAIN_CATEGORY_ID 上匹配我显示 ID，或者如果有 ALTERNATIVE_CATEGORY_ID 我必须显示 product_id 和产品 ID 的序列号。

我编写了以下查询来显示结果

```
select product_id,
cast(collect(coalesce(MAIN_CATEGORY_ID,
  decode(ALTERNATIVE_CATEGORY_ID,null,null, ALTERNATIVE_CATEGORY_ID || '-' || PRODUCT_CATEGORY))) as myType) as product_matches
from product_match
group by product_id 
```

注意：MyType 定义为 varchar(2000) 的表

如果 MAIN_CATEGORY_ID 不为空，则查询将使用 MAIN_CATEGORY_ID，否则将使用 ALTERNATIVE_CATEGORY_ID 中的值来构建输出。我想更改它，以便每当合并函数使用 ALTENATIVE_CATEGORY_ID 值时，它都会显示与 PRODUCT 编号中的 product_serial_no 连接的 product_id。这将需要与 PRODUCT 表连接。

基本上我想要实现的输出如下所示：

```
PRODUCT_ID  PRODUCT_MATCHES
-----------------------------------
1001        1002,DVD-5234234023948
1002        1004
2002        MP3-X348023948, 1003, 1001, 1002
1003        CD-SDRX83489 
```

我知道我可以简单地加入表格，但它不是那么简单。问题是我只想在使用 ALTERNATIVE_CATEGORY_ID 时使用连接。这意味着一个简单的连接将影响使用 MAIN_CATEGORY_ID 时的结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T15:45:21.813

```
select 
   pm.product_id, 
   cast(
      collect(
         coalesce(
            pm.MAIN_CATEGORY_ID, 
            pm.ALTERNATIVE_CATEGORY_ID || '-' || pr.PRODUCT_SERIAL_NO
         )
      ) as myType
   ) as product_matches
from 
   product_match pm
   left join PRODUCT pr
      on pr.PRODUCT_ID = pm.ALTERNATIVE_CATEGORY_ID
group by 
   pm.product_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T15:03:36.550

我认为 LISTAGG() 或 WM_CONCAT() 函数是你正在寻找的，因为你写的是你有表而不是嵌套表或集合。Collect 将返回一个集合，主要用于 PL/SQL 数据类型而不是简单表。LISTAGG() 或 WM_CONCAT() 会将值连接成一个字符串，与您的示例完全相同。抱歉，我不会添加任何查询，因为您的输出让我非常困惑。我只看到与 product_id = 1001 匹配的图书，而不是 DVD 和其他内容。如果您使用 SQL Fiddle 创建示例数据或简单地创建表并插入，那就太好了。请在将来这样做。

这对我有用 - emp_test 是 scott.emp 表的精确副本：

```
ALTERE TABLE emp_test MODIFY ename VARCHAR2(3000);

Update emp_test set ename = rpad(ename, 3000, ' '); Commit;

SELECT deptno
     , LISTAGG(TRIM(SUBSTR(ename, 1, 3000)), ',') WITHIN GROUP (ORDER BY ename) AS employees
    , count(*) total_emps
  FROM emp_test
GROUP BY deptno
/

SELECT deptno
     , WM_CONCAT(TRIM(SUBSTR(ename, 1, 3000))) AS employees
     , count(*) total_emps
 FROM emp_test
GROUP BY deptno
/ 
```

# sql - 查询以找到共同的喜欢？

> ID：15042054
> 
> 赞同：4
> 
> 时间：2013-02-23T15:18:05.600
> 
> 标签：sql, sql-server

我有一张桌子，上面有特定人的 id 和他喜欢的人的 id。

喜欢

```
(p1,p2)
id1,id2
id2,id1
id3,id4
id3 id5 
```

预期产出

```
id1,id2 
```

我必须删除重复项，这也意味着 id1,id2 要返回一次。

这是一道练习题。

```
select hh.id, hh.name, hh.grade as gr
     , hh.id2, kk.name, kk.grade as gr1
  from ( select id, id2, grade, name 
           from highschooler ab 
              , Likes cd 
          where ab.id = cd.id1 ) hh 
     , highschooler kk 
 where hh.id2 = kk.id 
```

此查询返回类似这样的内容

> 学生id,学生姓名,学生成绩,朋友学生喜欢,朋友姓名,朋友成绩

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T15:26:42.830

这应该让它自己加入：

```
SELECT p.p1, p.p2
FROM Likes p
    INNER JOIN Likes p2 ON 
        p.p1=p2.p2 AND 
        p.p2=p2.p1 AND 
        p.p1<p2.p1 
```

[小提琴演示示例](http://sqlfiddle.com/#!3/7530d/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:51:25.827

我认为最好的方法是使用`group by`. 在 SQL Server 中，这需要使用`case`语句：

```
with l as (
    select (case when p1 < p2 then p1 else p2 end) as pfirst,
           (case when p1 < p2 then p2 else p1 end) as psecond
    from likes
   )
select pfirst, psecond
from l
group by pfirst, psecond
having count(*) = 2 
```

如果原始数据中有重复项，则having子句应为：

```
having count(distinct p1) = 2 
```

# android - 警报管理器延迟不起作用

> ID：15042056
> 
> 赞同：0
> 
> 时间：2013-02-23T15:18:18.163
> 
> 标签：android

你好，

我使用以下代码片段在使用 AlarmManager 的延迟后调用操作。但是警报会立即被调用。

AlarmUtility.java

```
public void setAlarm(Context context) {
    AlarmManager am = (AlarmManager) context
            .getSystemService(Context.ALARM_SERVICE);
    Intent i = new Intent(context, AlarmReceiver.class);
    PendingIntent pi = PendingIntent.getBroadcast(context, 0, i, 0);    
    am.setRepeating(AlarmManager.RTC_WAKEUP, 1000 *24*3600,
            1000 *24*3600, pi); // Millisec * Second * Minute
    } // trying to first trigger the alarm after 24 hrs and repeat after 24 hours 
```

请让我知道我的错误是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:48:10.687

你应该这样使用：

```
am.setRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis()+time, time, pi); 
```

如果您想使用`1000 *24*3600`，请使用`(1000 *24*3600)L`。因为`1000 *24*3600`大于`Integer.Max_value`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:48:12.137

乍一看，问题似乎出在

```
am.setRepeating(AlarmManager.RTC_WAKEUP, 1000 *24*3600,
        1000 *24*3600, pi); 
```

第二个参数 triggerAtTime 应该指向警报应该响起的时间。它不应该是一个时间间隔。

检查以下示例：

```
 am.setRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis() + 1000 *24*3600,
        1000 *24*3600, pi); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T15:44:41.430

`1000 *24*3600`肯定是过去了，所以警报会[立即触发](http://developer.android.com/reference/android/app/AlarmManager.html#setRepeating%28int,%20long,%20long,%20android.app.PendingIntent%29)：

> 如果时间发生在过去，将立即触发警报，警报计数取决于触发时间相对于重复间隔过去多长时间。

取而代之的是获取当前时间，然后为初始唤醒添加 24 小时：

```
Calendar calendar =  Calendar.getInstance();
calendar.add (Calendar.DATE,1);
long day = 1000 *24*3600;

am.setRepeating(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), day , pi); 
```

# jquery - 使用jQuery上一个和下一个按钮在递增/递减期间限制x值

> ID：15042064
> 
> 赞同：0
> 
> 时间：2013-02-23T15:18:56.600
> 
> 标签：jquery, increment, decrement

主图像下方有上一个和下一个按钮，有 x 数量的照片（在这种情况下为 7），我需要限制添加到 x 数量的值，以便它只能在 1 到 x 的范围内（1在这种情况下为 7）。

显然，当用户到达 x 时，点击下一步应该回到 1。

问题可以在这里看到：http: [//mylandscapes.splintertaeal.com/gardens/regents-park.htm](http://mylandscapes.splintertaeal.com/gardens/regents-park.htm)

任何帮助将非常感激。

代码：

```
$(document).ready(function () {
  var el = $('.nr');

  function change(amt) {
    el.text(parseInt(el.text(), 10) + amt);
  }

  $('#next').click(function () {
    change(1);
  });

  $('#prev').click(function () {
    change(-1);
  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:45:32.383

我会说你应该完全删除这段代码：

```
$(document).ready( function() {
    var el = $('.nr');
    function change( amt ) {
        el.text( parseInt( el.text(), 10 ) + amt );
    }
    $('#next').click( function() {
        change( 1 );
    });
    $('#prev').click( function() {
        change( -1 );
    });
}); 
```

而是修改以下事件处理程序。

```
var $nr = $(".nr");
$('#next, #prev').on('click', function() {
    var A = this.id == 'next',X=A?T:0,Y=A?0:T,Z=A?N+1:N-1;N=N==X?Y:Z;
    $("#display").html('<img src="'+$(E[N]).attr('href')+'" />');
    $(".display2").html('<img src="'+$(F[N]).attr('href')+'" />');
    /* Update the slide number */ 
    $nr.text(N + 1);
}); 
```

在这种情况下不需要有两个事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:28:28.647

```
 int i = 0
        $(nextbutton).click(function () {
          i++;
          if (i == 7) {
            i = 0;
          }
 showImage(i); // get i indexed image from array
        });

        $(prevbutton).click(function () {
          i--;
          showImage(i); // get i indexed image from array
          if (i == 0) {
            return;
          }
        });

I hope I understood your problem  in a right way . 
```

# django - Django Tastypie - 包括许多领域

> ID：15042070
> 
> 赞同：0
> 
> 时间：2013-02-23T15:19:26.250
> 
> 标签：django, api, tastypie

我正在尝试使用 django sweetpie，但遇到了一些麻烦。这是我的 api.py：

```
from tastypie.resources import ModelResource
from tastypie import fields
from app.models import First, Second, Third

class FirstResource(ModelResource):
    second = fields.ToManyField('app.api.SecondResource', 'second_set', related_name='first', null=True, blank=True, full=True)

    class Meta:
        queryset = First.objects.all()
        resource_name = 'first'

class SecondResource(ModeResource):
    first = fields.ForeignKey(FirstResource, 'first', full=True)
    third = fields.ToManyField('app.api.ThirdResource', 'third_set', related_name='second', null=True, blank=True, full=True)

    class Meta:
        queryset = Second.objects.all()
        resource_name = 'second'

class ThirdResource(ModelResource):
    poll = fields.ForeignKey(SecondResource, 'second', full=True)

    class Meta:
        queryset = Third.objects.all()
        resource_name = 'third' 
```

当我尝试使用它获取 SecondResource 时，`http://127.0.0.1:8000/app/api/v1/second/`它​​包括 FirstResource，但我也希望与 ThirdResource 相关联。现在它只给了我一个空数组。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T20:47:52.597

尝试在您的第三个模型中添加相关名称：

```
class Third(models.Model):
    second = models.ForeginKey(Second, related_name=thirds) 
```

然后在资源中：

```
 class SecondResource(ModeResource):`
       first = fields.ForeignKey(FirstResource, 'first', full=True)
       third = fields.ToManyField('app.api.ThirdResource', 'thirds', null=True, blank=True, full=True) 
```

# javascript - javascript没有保存在博客中

> ID：15042071
> 
> 赞同：-2
> 
> 时间：2013-02-23T15:19:29.683
> 
> 标签：javascript, error-handling, blogger

我最近在 github 上创建了一个代码如下：-

```
 function showDashBoard(){
      for(var i = 1; i <= 3; i++) {
        $('.col'+i).each(function(){
            $(this).addClass('fadeInForward-'+i).removeClass('fadeOutback');
        });
      }
    }

    function fadeDashBoard(){
      for(var i = 1; i <= 3; i++) {
        $('.col'+i).addClass('fadeOutback').removeClass('fadeInForward-'+i);
      }
    }
    // fadeDashBoard();

    $(".lock-thumb").click(function(){
        fadeDashBoard();
        $('.login-screen').addClass('slidePageInFromLeft').removeClass('slidePageBackLeft');
    });

    $('#unlock-button').click(function(){
          $('.login-screen').removeClass('slidePageInFromLeft').addClass('slidePageBackLeft');
          showDashBoard();
    });

  $('.big, .small').each(function(){
    var $this= $(this),
        page = $this.data('page');
    $this.on('click',function(){
      $('.page.'+page).addClass('openpage');
      fadeDashBoard();
    })
  });
  $('.close-button').click(function(){
    $(this).parent().addClass('slidePageLeft')
          .one('webkitAnimationEnd oanimationend msAnimationEnd animationend', function(e) {
                $(this).removeClass('slidePageLeft').removeClass('openpage');
              });
      showDashBoard();
  }); 
```

但是在保存代码时，我发现错误为：-

解析 XML 时出错，第 9 行，第 25 列：元素的内容必须由格式正确的字符数据或标记组成。

请通过查找错误来帮助我编写代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:22:21.830

问题是由于某种原因您的 JavaScript 被 XML 解析器解析。

假设脚本在一个`<script>`标签内，把该标签内的所有内容放在一个 CDATA 部分中：

```
<script>
// <![CDATA[
    // put your JS here
// ]]>
</script> 
```

另一个（更好的）选项是将您的 JS 存储在一个单独的文件中，然后使用

```
<script src="whatever.js"></script> 
```

# debugging - 为 Surface Pro 平板电脑调试 Windows 8 应用程序

> ID：15042073
> 
> 赞同：0
> 
> 时间：2013-02-23T15:19:57.180
> 
> 标签：debugging, windows-8, microsoft-metro, visual-studio-debugging

我已经发布了一个适用于 Windows 8 的应用程序，桌面用户对它很满意，但 Surface 平板电脑用户在应用程序启动时抱怨崩溃问题。

现在我没有 Surface 平板电脑来调试应用程序，尽管我已经尝试过内置模拟器，它也可以在模拟器上完美运行。

那么如何在 Windows Surface 平板电脑上调试我的应用程序，是否有任何设置可以将模拟器环境更改为目标 Surface Pro 平板电脑。

# linux - Vala 和 PolicyKit

> ID：15042074
> 
> 赞同：3
> 
> 时间：2013-02-23T15:20:00.230
> 
> 标签：linux, permissions, dbus, vala

我正在 Vala 中创建一个简单的基于 GTK+ 的应用程序，它应该能够写入系统目录，因此它需要 root 访问权限。我意识到授予完全 root 访问权限是一个坏主意，因此我需要一种获得临时权限的方法。

理论上，PolicyKit D-Bus 服务是完成这项工作的工具，但我不知道如何使用它，更不用说在 Vala 代码中了。任何见解将不胜感激。

**更新：** 我做了一些进一步的挖掘。我的出发点是[这个](https://live.gnome.org/Vala/DBusClientSamples)。所以基本上我需要的是找出如何使这些解决方案适应 PolicyKit。为此，需要找到PolicyKit的D-Bus接口。我在[这里](http://www.freedesktop.org/software/polkit/docs/0.105/eggdbus-interface-org.freedesktop.PolicyKit1.Authority.html)找到了。（奇怪的是我没有在我的本地*/usr/share/dbus-1/interfaces*文件夹中找到它。）但现在我不知道如何继续。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T01:57:03.117

polkit[参考手册包含一些很好的信息，包括关于](http://www.freedesktop.org/software/polkit/docs/latest/index.html)[编写 polkit 应用程序](http://www.freedesktop.org/software/polkit/docs/latest/polkit-apps.html)的高级概述。

与其直接使用 D-Bus 接口，不如考虑使用[libpolkit-gobject-1](http://www.freedesktop.org/software/polkit/docs/latest/ref-api.html)库。您可以直接使用 GIR，也可以使用 vapigen 生成 VAPI（我会推荐）。 [这](http://pastebin.com/y471Gb8J)是我刚刚生成的一个。我对 API 不是很熟悉，但是很容易使用 C API 参考作为参考来找出 Vala API。

# python - 从 python 调用多级命令/程序

> ID：15042075
> 
> 赞同：0
> 
> 时间：2013-02-23T15:20:13.347
> 
> 标签：python, shell

我有一个 shell 命令“fst-mor”。它采用文件形式的参数，例如 NOUN.A，它是一个 lex 文件或其他东西。最终命令：`fst-mor NOUN.A`

然后它产生以下输出：

```
analyze>INPUT_A_STRING_HERE
OUTPUT_HERE 
```

现在我想从我的 python 脚本中调用 fst-mor，然后输入字符串并希望在脚本中返回输出。

到目前为止，我有：

```
import os
print os.system("fst-mor NOUN.A") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T15:22:53.593

您想要捕获另一个命令的输出。为此使用该[`subprocess`模块](http://docs.python.org/2/library/subprocess.html)。

```
import subprocess

output = subprocess.check_output('fst-mor', 'NOUN.A') 
```

如果您的命令需要交互式输入，您有两种选择：

*   使用一个`subprocess.Popen()`对象，并将`stdin`参数设置为`subprocess.PIPE`并将输入写入可用的标准输入管道。对于一个输入参数，这通常就足够了。详细阅读该模块的文档`subprocess`，但基本的交互是：

    ```
    proc = subprocess.Popen(['fst-mor', 'NOUN.A'], stdin=subprocess.PIPE, stdout=subprocess.PIPE)
    output, err = proc.communicate('INPUT_A_STRING_HERE') 
    ```

*   使用[`pexpect`库](http://www.noah.org/wiki/pexpect)来驱动进程。这让您可以通过查找模式来创建与子流程的更复杂的交互，这是它生成的输出：

    ```
    import pexpect

    py = pexpect.spawn('fst-mor NOUN.A')
    py.expect('analyze>')
    py.send('INPUT_A_STRING_HERE')
    output = py.read()
    py.close() 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T15:49:22.340

你可以试试：

```
from subprocess import Popen, PIPE

p = Popen(["fst-mor", "NOUN.A"], stdin=PIPE, stdout=PIPE)
output = p.communicate("INPUT_A_STRING_HERE")[0] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T15:54:05.723

与另一个进程通信的示例：

```
pipe = subprocess.Popen(['clisp'],stdin=subprocess.PIPE, stdout=subprocess.PIPE)
(response,err) = pipe.communicate("(+ 1 1)\n(* 2 2)")
#only print the last 6 lines to chop off the REPL intro text. 
#Obviously you can do whatever manipulations you feel are necessary 
#to correctly grab the input here
print '\n'.join(response.split('\n')[-6:]) 
```

请注意，通信将在运行后关闭流，因此您必须提前了解所有命令才能使此方法起作用。似乎 pipe.stdout 在标准输入关闭之前不会刷新？我很好奇是否有办法解决我失踪的问题。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-23T15:25:03.613

您应该使用子流程模块[子流程模块](http://docs.python.org/2/library/subprocess.html)

在您的示例中，您可能会运行：

```
subprocess.check_output(["fst-mor", "NOUN.A"]) 
```

# android - Android 手机未列出

> ID：15042086
> 
> 赞同：0
> 
> 时间：2013-02-23T15:20:56.137
> 
> 标签：android, adb, ubuntu-11.04, sony

我有一部在 Ubuntu 11.04 上运行的 Android 版本 4.04 和 adb 1.0.31 的索尼 Experia 手机。我无法在 Eclipse/adb 中列出我的手机

我的 USB 规则文件是：

```
SUBSYSTEM=="usb", ATTR{idVendor}=="0fce", ATTR{idProduct}=="5173", MODE="0666" 
```

我尝试重新启动 adb 和 USB 服务仍然无法正常工作。

# matlab - 非向量化到向量化，ma tlab

> ID：15042087
> 
> 赞同：1
> 
> 时间：2013-02-23T15:21:08.510
> 
> 标签：matlab

我有两个问题。请看followinf代码

```
it=0:0.01:360;
jt=0:0.01:270;

LaserS=zeros(size(it,2)*size(jt,2),2);
p=1;
for m=it
    for n=jt
        LaserS(p,:)=[m,n];
        p=p+1;
    end
end 
```

它非常慢，也需要大量内存（大约 7.7765e+009 字节）。所以我不能运行它。我该如何改进它并解决内存问题。我正在使用带有 8Gb RAM 的 win7 64。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:32:49.460

你想做什么？“重塑”应该可以解决您的问题。

```
LaserS=zeros(size(it,2)*size(jt,2),2);
JT=reshape(repmat(jt,[1,numel(it)]),1,numel(jt)*numel(it));
IT=reshape(repmat(it,[numel(jt),1]),1,numel(jt)*numel(it));

LaserS = [JT.', IT.']; 
```

预分配数组将节省您的内存命中。否则这里没有内存优化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T15:33:13.103

除非您使用更少的值，否则您无法减少内存使用量。可以`it`和`jt`一步 0.1 而不是 0.01？

这是一种无需循环即可构建结果矩阵的方法。

```
LaserS = [rempat(it.', length(jt), 1), kron(ones(length(it), 1), jt.')]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T15:47:59.957

从某种意义上说，这段代码似乎“什么也不做”，在它运行之后，你最终得到的矩阵`LaserS`的形状为 972000000 x 2。如果你真的需要同时将这些值加载到内存中，那就是大小，没有什么可做的。

我的第一种方法是什么，不能直接从您发布的代码中推断出来，如果您在执行进一步处理时“动态”生成矩阵数据，也许您可​​以实现程序的总体目标`LaserS`。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-23T15:37:01.150

这应该这样做：

```
it = it(:);
jt = jt(:);

jt = repmat(jt,size(it,1),1)
it = repmat(it',size(jt,1),1);
it = it(:);

LaserS = [it, jt] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-24T09:31:47.617

除了这里已经介绍的不错的解决方案，如果你想减少内存，没有理由使用`double`. 您可以使用`single`所需内存的一半。您可以将步长编码`0.01`为单位步长（也就是说，`it=uint16(0:1:36000)`将数字编码为整数`uint16`，这将只使用四分之一的内存。等等......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-24T09:46:23.037

Meshgrid 也会干净利落地执行此操作，如果您坚持将其置于 (n*m)-by-2 矩阵中，则可能会进行重塑。但是你为什么想要那个？看起来你实际上是在追求别的东西，而且 bsxfun(,it,jt') 可能会做你想做的事。

# php - 如何使用 PHP 在指定索引处添加/删除特定节点？

> ID：15042088
> 
> 赞同：0
> 
> 时间：2013-02-23T15:21:28.217
> 
> 标签：php, list, linked-list

我正在尝试使用 PHP 实现一个链表。我已经完成了其中的一部分，但是，我不确定我的代码是否正确。您能否建议如何在指定索引处添加/删除特定节点？

请参考以下代码：（共3个文件）

## 1) [ListNode.class.php]

我定义的节点结构：

```
<?php

class ListNode
{
    protected $next;        // Next node in the list
    protected $value;       // Value of the node

    // Constructor
    // Input: Value of the node
    public function __construct($value)
    {
        $this->value = $value;
        $this->next = NULL;
    }

    public function __get($name)
    {
        return $this->$name;
    }

    public function __set($name, $value)
    {
        $this->$name = $value;
    }

    // Return the node as string
    public function toString()
    {
        return $this->value . "\n";
    }
} 
```

## 2) [LinkList.class.php]

链表和我没有完成的操作：

```
<?php

require('ListNode.class.php');

class LinkedList
{
    protected $first;           // First node of the list
    protected $last;            // Last node of the list
    protected $count;             // Total numbers of nodes in the list

    // Constructor
    // Input: Array of values (Optional)
    public function __construct($values = array())
    {
        $this->first = null;
        $this->last = null;
        $this->count = 0;

        foreach ($values as $value) {
            $this->add($value);
        }
    }
    public function isEmpty()

        if ($this->sizeOf() !== 0) 
        return ($this->first == NULL);
    }

    // Add a node at the beginning of the list
    public function add($value)
    {
        $link = new ListNode($value);
        $link->next = $this->first;
        $this->first = &$link;

        if($this->last == NULL)
           $this->last = &$link;

        $this->count++;
    }

    // Add a node at the specified index
    public function addAtIndex($value, $index)
    {

    }

    // Remove a node at the end of the list
    public function remove()
    {
        if($this->first != NULL)
        {
          if($this->first->next == NULL)
          {
            $this->first == NULL;         
            $this->cout--;
        }
        else
        {
             $previous = $this->first;
             $current = $this->first->next;

             while($current->next != NULL)
             {
              $previous = $current;
              $current = $current->next;

             $previous->next = NULL;
             $this->count--;
        }
    }

    // Remove a node at the specified index
    public function removeAtIndex($index)
    {

    }

    // Return the value of the first node
    public function getNode()
    {

    }

    // Return the value of the node at the specified index
    public function getNodeAtIndex($index)
    {
         if($index <= $this->count)
        {
            $current = $this->firstNode;
            $pos = 1;
            while($pos != $index)
            {
                if($current->next == NULL)
                    return null;
                else
                    $current = $current->next;

                $pos++;
            }
            return $current->value;
        }
        else
            return NULL;  
    }

    // Return the number of nodes
    public function sizeOf()
    {
        return $this->count;
    }

    // Return the list as string
    public function toString()
    {
        $list = "";
        $node = $this->first;

        while ($node != null) {
            $list .= $node->toString();
            $node = $node->next;
        }

        return $list;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:43:57.847

如果您需要一个链表，为什么不使用标准 PHP 库呢？您拥有[`SplDoublyLinkedList`](http://php.net/spldoublylinkedlist)所需的所有功能：

*   在索引处添加节点：[`offsetSet()`](http://www.php.net/manual/en/spldoublylinkedlist.offsetset.php)
*   删除索引处的节点：[`offsetUnset()`](http://www.php.net/manual/en/spldoublylinkedlist.offsetunset.php)

这些方法是实现`ArrayAccess`接口的一部分，这意味着您不必直接调用它们，但可以执行以下操作：

```
$list = new SplDoublyLinkedList;
$list->push('item 1');
$list->push('item 2');
$list->push('item 3');
echo $list[1];
unset($list[1]);

foreach($list as $index => $value) {
    echo "\n$index: $value";
} 
```

**输出：**

```
item 2
0: item 1
1: item 3 
```

# android - 如何将图像保存在数据库中？

> ID：15042090
> 
> 赞同：0
> 
> 时间：2013-02-23T15:21:33.643
> 
> 标签：android, database, image

我有数据库，其中有 3 列（第一个`Id`、第二个标题`String`、第三个图像`int`）。DB 喜欢带照片的联系人列表。

```
ContentValues cv = new ContentValues();
cv.put(COLUMN_TITLE, "John");
cv.put(COLUMN_IMG_OUTSIDE, R.drawable.john_photo);
db.insert(DB_TABLE, null, cv)); 
```

然后`SimpleCursorAdapter`我从名字和他们的照片中填写列表

```
SimpleCursorAdapter scAdapter;
String[] from = new String[] { DataBase.COLUMN_IMG_OUTSIDE,DataBase.COLUMN_TITLE};
int[] to = new int[] { R.id.img, R.id.text1, };

cursor = db.getAll();
startManagingCursor(cursor);

scAdapter = new SimpleCursorAdapter(ListOfItems.this, R.layout.list, cursor, from, to);
listView.setAdapter(scAdapter); 
```

一切正常，但是当我想将记录添加到数据库并从画廊中选择一张图片时，我不知道如何将其保存在数据库中。我想我可以保存文件的路径，比如`String path = "/sdcard/DCIM/Camera/IMG20130222_008.jpg"`；但是当我填写列表时可能会出现问题，因为在 DB 图像中保存的是整数值。对不起我的英语=（

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:29:38.270

也许您应该尝试将整个图像作为 blob 保存到数据库中？

请参阅[Android 如何将相机图像保存在数据库中并在列表视图中显示另一个活动？](https://stackoverflow.com/questions/9941637/android-how-to-save-camera-images-in-database-and-display-another-activity-in-li)

在这种情况下，您必须编写自己的 CursorAdapter，然后
[在 SimpleCursorAdapter 中查看此图像](https://stackoverflow.com/questions/6710565/images-in-simplecursoradapter)

# ruby-on-rails - 设计超级用户

> ID：15042091
> 
> 赞同：0
> 
> 时间：2013-02-23T15:21:59.163
> 
> 标签：ruby-on-rails, devise

我使用设计进行注册，每个用户都属于一个位置。我想创建一个超级用户，无论创建多少位置，他都可以访问所有位置。

当前位置参数是 location_id = some integer

关于如何将 location_id 分配给等于所有位置的超级用户的任何想法？

我还应该补充一点，这样做的目的是让我的 iOS 应用程序能够验证和查看所有 api 数据。

我现在正在尝试定义 location_id = nil 以返回 location.all

```
if current_user.location = nil
    @locations = Location.all
  else
    @locations = current_user.location
  end 
```

但我仍然需要定义 nil，因为使用具有 location_id = nil 的用户登录时出现以下错误

没有路线匹配 {:action=>"show", :controller=>"locations", :id=>nil}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:03:57.193

也许我误解了你正在做的更详细的细节，但是你可以在`super_user`你的模型中添加一个布尔字段，并在控制器中简单地使用这样的东西：

```
if current_user.super_user
  @locations = Location.all
else
  @locations = current_user.location
end 
```

或者，您可以使用 nil 的 location_id 来表示“全部”，如果这更适合您的需要，则使用`if current_user.location`代替。`if current_user.super_user`

# ruby-on-rails - 如何有效地检索 rails 3.2 中的所有记录并将它们分配给可查询的对象？

> ID：15042095
> 
> 赞同：0
> 
> 时间：2013-02-23T15:22:32.340
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

在我们的 rails 3.2 应用程序中，我们需要从客户表中检索所有客户记录并将它们分配给一个变量，然后对变量`customers`进行查询（例如 .where(:active => true) `customers`。这里有两个问题：

1.  检索所有记录的更好方法是什么？

    `Customer.all`作品。但是根据 rails 文档，当客户表变大时可能会出现性能问题。我们试过`Customer.find_each`了，它有错误`"no block given (yield)"`。

2.  如何使变量`customers`query_able？

    对变量`customers`（如`customers.where(:active => true)`）执行查询时，出现错误：`undefined method`where' for #customers where `. It seems that the`customers`以这种方式可以查询？`is an array object and can't take``. How can we retrieve`

感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:18:59.120

在 Rails < 4`.all`中立即调用数据库，加载记录并返回数组。而是使用返回可链接对象的“惰性”[范围](http://apidock.com/rails/ActiveRecord/NamedScope/ClassMethods/scoped)方法。`ActiveRecord::Relation`例如：

```
customers = Customer.scoped
...
customers = customers.where(:active => true)
customers = customers.where(...)
etc... 
```

当您需要加载记录并对其进行迭代时，您可以调用[find_each](http://apidock.com/rails/ActiveRecord/Batches/ClassMethods/find_each)：

```
customers.find_each do |customer|
  ...
end 
```

# linq - 获取子对象集合的子对象

> ID：15042098
> 
> 赞同：0
> 
> 时间：2013-02-23T15:22:47.670
> 
> 标签：linq, linq-to-entities

我在对 dbContext 使用 Linq 时遇到困难，无法获取子对象的子对象集合具有特定最高值的对象计数。

我有类请求，事件，用户。我的简化对象图是这样的：-

```
Request                        Event                  User
  |                             |                      |-> Username
  |-> EventsCollection          |-> Description
  |-> User                      |-> WhenDone 
```

我确信可以更改域模型，但无论如何，使用当前结构，我想要的是最近事件具有特定描述的特定用户的请求数的计数。

我最初认为像下面这样的东西会给我我正在寻找的价值

```
value = _db.Requests.Where(r => r.User.UserName.Equals("username") &&  r.Events.OrderByDescending(e => e.WhenDone).First().Description.Equals( "description")).Count(); 
```

然而，在运行这个我得到一个错误'First' can only be used as a final query operation change it I get other errors such as unsupported method etc.

我猜我应该使用子查询，但无法正确使用语法。

任何指向有用资源或建议解决方案的指针将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:06:00.857

尝试这样的事情：

```
int count = _db.Requests.Where(r => r.User.UserName == "username")
               .Select(r => 
                   r.Events.OrderByDescending(e => e.WhenDone).FirstOrDefault())
               .Count(r => r != null && r.Description == "description"); 
```

# c# - 这种使用字典存储产品信息和应用计算的方式是否正确

> ID：15042106
> 
> 赞同：1
> 
> 时间：2013-02-23T15:23:23.300
> 
> 标签：c#, sql-server-2008, dictionary

我有一个包含产品名称和相应价格的字典对象：

```
 var products = new List<Dictionary<string, decimal>>()
            {
                new Dictionary<string, decimal> {{"product1", 10}},
                new Dictionary<string, decimal> {{"product2", 20}},
                new Dictionary<string, decimal> {{"product3", 30}}
            }; 
```

然后我循环遍历并应用每个产品的一些计算：

```
 foreach (var product in products)
        {
            foreach (KeyValuePair<string, decimal> kvp in product)
            {
               var result = GetRatePerProduct(kvp.Key) * kvp.Value;        
            }
        } 
```

**GetRatePerProduct**只需获取产品名称并返回十进制汇率。

基于此循环，计算结果将被插入到订单表中，该表包含每个产品的列，产品 1、产品 2、产品 3...

所以在循环之后，表格应该是这样的：

```
Product1 Product2 Product3 ...
12       24       36 
```

我想过创建另一个这样的字典：

```
var results = new List<Dictionary<string, decimal>>(); 
```

并在 for 循环内填充它，然后在循环外使用此字典将数据插入 SQL 数据库。**我在这个例子中缩短了产品的数量，但是我们将有 52 个产品，这个数字永远不会改变。**

这种方法对吗？有没有更好的方法，可能使用 Linq？你能指出我用 Linq 做这件事的正确方向吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:31:41.770

尽管还有很多其他选择，但您的操作方式并没有什么特别的错误。在 c# 中，您可以轻松地使用 Linq 进行此类操作，并且您还可以非常轻松地并行化操作。

您的问题标记为“sql-server-2008”，这让我想知道此操作的数据是否来自数据库。如果是这样，在 SQL 中而不是在 C# 中完成工作可能更有效。

所以回答你的两个问题：

这种方法对吗？——当然没有错。

有没有更好的方法来做到这一点？- 还有其他方法，但它们是否更好取决于问题中未提及的因素。

... 更多：我想出了两种 linq-ish 方法。第一个保留您的数据结构：

```
 var products = new List<Dictionary<string, decimal>>()
        {
            new Dictionary<string, decimal> {{"product1", 10}},
            new Dictionary<string, decimal> {{"product2", 20}},
            new Dictionary<string, decimal> {{"product3", 30}}
        };
        var results = new List<Dictionary<string, decimal>>();

        results.AddRange(products.Select(product =>
        {
            var resultDictionary = new Dictionary<string, decimal>();
            foreach (string key in product.Keys)
            {
                resultDictionary.Add(key, GetRatePerProduct(key));
            }
            return resultDictionary;
        })); 
```

第二个创建一个新的 Product 类来涵盖您正在使用的三个属性，但对它们执行相同的操作。

```
 public class Product
    {
        public string ProductName { get; set; }
        public decimal ProductValue { get; set; }
        public decimal ProductResult { get; set; }
    }

        var products = new List<Product>()
        {
            new Product () {ProductName = "product1", ProductValue = 10},
            new Product () {ProductName = "product2", ProductValue = 20},
            new Product () {ProductName = "product3", ProductValue = 30},
        };

        var results = new List<Dictionary<string, decimal>>();

        foreach (var product in products)
        {
            product.ProductValue = GetRatePerProduct(product.ProductName);
        }

        // the next two lines do exactly the same thing, just one of them is explicitly parallelized
        products.ForEach(product => { product.ProductValue = GetRatePerProduct(product.ProductName); });
        Parallel.ForEach(products, product => { product.ProductValue = GetRatePerProduct(product.ProductName); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:33:12.827

如果您只打算使用它来存储一个键值对，那么没有理由使用字典对象。

更好的解决方案是创建一个具有属性名称和价格的产品类，然后将这些对象添加到列表中。

# windows-runtime - 如何使用 Stack Overflow API 进行身份验证

> ID：15042107
> 
> 赞同：0
> 
> 时间：2013-02-23T15:23:27.120
> 
> 标签：windows-runtime, windows-store-apps, c#-5.0, stackexchange-api

如何在 C# (Windows RT) 中使用 Stack Overflow 进行身份验证？我不知道该怎么做，所以任何例子都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:09:41.120

我认为您可以使用`WebAuthenticationBroker`通过 OAuth 2 进行身份验证。这里有一个[示例](http://code.msdn.microsoft.com/windowsapps/Web-Authentication-d0485122)。您可能需要从[此处](http://api.stackexchange.com/docs/authentication)获取 Stack Exchange API 的一些文档。

# html - 在 html mailto 链接中提供电子邮件证书

> ID：15042111
> 
> 赞同：1
> 
> 时间：2013-02-23T15:23:51.223
> 
> 标签：html, email, hyperlink, x509, mailto

我想知道是否可以提供电子邮件证书（由公认的 CA 签名），以便单击 mailto 链接的用户可以将加密的电子邮件发送给证书的所有者？

```
<a href="mailto:hello@gmail.com">hello@gmail.com</a> 
```

有没有办法使用 mailto 链接或使用一些 JS 来做到这一点？鉴于 mailto 链接由本地电子邮件客户端处理，应该可以吗？

如果没有直接的方法可以做到这一点，如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:42:17.940

一种选择是用于发送消息的 Web 表单，通过 HTTPS 提供服务。表单的服务器端处理程序将在服务器上编写加密邮件，然后通过 SMTP 发送。这提供了与直接加密几乎相同的安全级别（假设您的服务器是安全的）。不幸的是，没有其他简单的方法可以做你想做的事。当然，你可以给你的 .cer 文件下载一个链接，告诉用户下载 .cer 文件并用它来编写加密邮件，但是你会如何处理 GMail 用户和移动用户呢？Web 表单更灵活，更易于发件人使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T15:56:38.697

您可以根据当前规范查找[RFC 2368](http://www.faqs.org/rfcs/rfc2368.html)中的 mailto URL 可以做什么。您会看到它只涉及邮件文本和标题的构造，而不是它们的编码或加密。某些邮件客户端可能有扩展，但这不是人们通常应该指望的东西。

此外，无论如何，Web 邮件用户通常都会遇到此类链接的问题。因此，对于任何人都必须使用的解决方案，依赖某些客户端程序的方案不是一个好的选择。

因此，@Eugene 提到的某些只能通过 https 访问的 Web 表单最能满足您的要求。

# ruby-on-rails-3 - 带有产生的javascript的rails资产管道

> ID：15042114
> 
> 赞同：0
> 
> 时间：2013-02-23T15:24:13.937
> 
> 标签：ruby-on-rails-3, asset-pipeline

因为我不想为某些视图保留我的 js 文件，所以我在视图中使用了一个辅助函数，它将 js 文件生成到 html 头中

```
 def javascript(*files)
    content_for(:head) { javascript_include_tag(*files) }
   end 
```

所以我想知道如何使用资产管道和预编译机制来实现这一点？最好的，菲尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:46:17.233

Every JS file that is being required in the HTML head section needs to be precompiled. By default only application.js is being precompiled, but you can schedule additional files for precompilation in config/application.rb:

```
config.assets.precompile += ['admin.js', 'customer_page.js'] 
```

Those files can be manifests, just like application.js, if you want to group the JS-files together.

# xamarin.ios - 使用 Xamarin MonoTouch / Xamarin Studio 进行核心绘图

> ID：15042115
> 
> 赞同：0
> 
> 时间：2013-02-23T15:24:21.083
> 
> 标签：xamarin.ios, core-plot, xamarin-studio

我正在使用当前的 Xamarin Studio 并尝试启动并运行 Core Plot 项目。通过组件库导入非常完美。

现在我有散点图并运行缩放和平移工作。

我喜欢固定 X 和 Y 轴 - 始终可见 - 无论显示的数据范围如何。

在 XPTXYAxis 上设置 IsFloating 属性会导致崩溃。

这似乎已经过时了？

不幸的是，axisConstraints 参数不存在 - 因为这似乎是将轴固定在视图左侧或右侧的方法。

知道如何解决吗？也许绑定在那里有问题？

# eclipse - 将 Eclipse 与 db2 集成

> ID：15042120
> 
> 赞同：1
> 
> 时间：2013-02-23T15:24:40.800
> 
> 标签：eclipse, db2

我正在做一个与 IBM 竞赛相关的项目，需要创建一个 Web 应用程序。我之前通过连接netbeans和mysql完成了一个Web应用程序。但是，现在从安装开始就面临问题。db2 是否有任何工作台（如 mysql 的东西）。如果有的话谁能给个链接。另外，我需要建立 jdbc 连接。那么，是否还有其他需要安装的软件。请详细向我解释，因为我对此不太确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:52:56.933

您只需要一个[DB2 JDBC JAR](http://www-01.ibm.com/support/docview.wss?uid=swg21363866)。为您的版本选择一个合适的并将其添加到您的 CLASSPATH 中。

您应该使用 DB2 管理客户端来创建表和查看数据，或者使用类似[SQL Squirrel](http://squirrel-sql.sourceforge.net/)的工具。

# php - 行重复每个页面重新加载

> ID：15042124
> 
> 赞同：0
> 
> 时间：2013-02-23T15:25:14.093
> 
> 标签：php, header, return

我制作了一个简单的评论系统。当我重新加载页面时，第一次插入的评论被复制了。我应该使用标头通过 request_uri 重定向吗？我这样做了，它变成了一个标题循环。提前致谢

```
public function comment($username, $comment, $code)
        {
            if(!empty($username) && !empty($comment) && !empty($code))
            {
                $date =date("Y-m-d H:i:s");
                if($insert = $this->db->prepare("INSERT INTO reviews (username, comment, time) VALUES (?, ?, ?)"))
                {
                    $insert->bind_param('sss', $username, $comment, $date);
                    $insert->execute();
                }
                else
                {
                    echo "iets gaat mis met inserten";
                }
            }
            else
            {
                echo "missing fields";
            }
        } 
```

```
public function retrieve()
                {
                    if($retrieve = $this->db->query("SELECT username, comment, time FROM reviews ORDER BY id LIMIT 0, 5"))
                    {
                            while($row = $retrieve->fetch_assoc())
                            {
                                $output .= '<div class="comment">';
                                $output .= '<div class="name">'.$row['username'].'</div>';
                                $output .= '<div class="date">Added at '.date('H:i \o\n d M Y',strtotime($row['time'])).'"></div>';
                                $output .= '<p>'.$row['comment'].'</p>';
                                $output .= '</div>';
                            }
                            return $output;

                    }

                } 
```

```
<?php
$reizen= new reizen;
echo $reizen->retrieve();
?>
<script type="text/javascript">
</script>
<?php
$output = '';
$output .= '<div id="contactform">';
$output .= '<form name="form" id="form" action="index.php?page=review" method="post">';
$output .= '<label>Name:</label>';
$output .= '<input type="text" name="username" />';
$output .= '<label>comment</label>';
$output .= '<textarea name="comment" rows="20" cols="20"></textarea>';
$output .= '<label><img src="captcha.php"></label>';
$output .= '<input type="text" name="code">';
$output .= '<input type="submit" class="submit" name="submit" value="Send message" />';
$output .= '</form>';
$output .= '</body>';
$output .= '</div>';
$output .= '</html>';
echo $output;
if(isset($_POST['submit']))
{
  $username = $_POST['username'];
  $comment = $_POST['comment'];
  $code = $_POST['code'];
  $reizen->comment($username, $comment, $code);
}
?> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-23T15:32:32.587

你能给我们提示一下你如何显示 $input 吗？

*也通过复制你的意思是html复制或表单仍然包含相同的评论？如果是这样，您可以将 attr autocomplete="false" 添加到提交评论的输入中以避免这种情况。*

因为您的数据库也在重复。那么请向我们展示您的表单工作流程。因为有些地方你两次调用评论功能..

一个好主意是在两个用户名、post_id、comment 上放置唯一键，这样用户就不能对同一个帖子说两次完全相同的评论。根据您目前的情况，当您的代码尝试重新提交相同的评论两次时，此唯一键将触发错误，并且您将能够在发生这种情况时识别。

* * *

用于调试

* * *

- 做独特的关键技巧来帮助你在问题发生时触发错误。

-u 在页面末尾调用comment() 函数.. 和检索函数`BEFORE`IT

所以你要做的是加载所有旧评论然后添加该评论（除非你刷新它不会显示）来修复你`if($_POST['submit'])`在调用数据库中的所有评论之前的移动

# ruby - 如何选择要显示警告的文件？

> ID：15042127
> 
> 赞同：5
> 
> 时间：2013-02-23T15:25:21.553
> 
> 标签：ruby, warnings, suppress-warnings

要使用 Ruby 显示警告，可以`ruby`使用 flag调用`-w`。使用库时，Ruby 可能会显示大量警告，因此很难从您实际处理的文件中找到警告。是否可以告诉`ruby`仅显示某些文件的警告？

这里有一个例子来说明这个问题。以下加载了一个生成大量警告的库，它还通过重新定义一个常量自行生成警告。

```
require 'grooveshark'

CONSTANT = 'foo'
CONSTANT = 'bar' 
```

的输出`ruby -w warning_test.rb`如下：

```
/var/lib/gems/1.9.1/gems/rest-client-1.6.7/lib/restclient/exceptions.rb:157：警告：已分配但未使用的变量 - 消息
/var/lib/gems/1.9.1/gems/rest-client-1.6.7/lib/restclient/exceptions.rb:167：警告：已分配但未使用的变量 - 消息
/var/lib/gems/1.9.1/gems/rest-client-1.6.7/lib/restclient/response.rb:11：警告：方法重新定义；丢弃旧身体
/var/lib/gems/1.9.1/gems/rest-client-1.6.7/lib/restclient/payload.rb:47：警告：“end”处的缩进不匹配，“case”处为 40
/var/lib/gems/1.9.1/gems/macaddr-1.6.1/lib/macaddr.rb:63：警告：已分配但未使用的变量 - 状态
/var/lib/gems/1.9.1/gems/macaddr-1.6.1/lib/macaddr.rb:63：警告：已分配但未使用的变量-stderr
/var/lib/gems/1.9.1/gems/macaddr-1.6.1/lib/macaddr.rb:56：警告：已分配但未使用的变量 - re
/var/lib/gems/1.9.1/gems/macaddr-1.6.1/lib/macaddr.rb:59：警告：已分配但未使用的变量 - null
/var/lib/gems/1.9.1/gems/systemu-2.5.2/lib/systemu.rb:126：警告：阴影外部局部变量 - cid
/var/lib/gems/1.9.1/gems/systemu-2.5.2/lib/systemu.rb:213：警告：遮蔽外部局部变量 - buf
/var/lib/gems/1.9.1/gems/systemu-2.5.2/lib/systemu.rb:215：警告：遮蔽外部局部变量 - buf
/var/lib/gems/1.9.1/gems/systemu-2.5.2/lib/systemu.rb:208：警告：已分配但未使用的变量 - 忽略
/var/lib/gems/1.9.1/gems/systemu-2.5.2/lib/systemu.rb:252：警告：隐藏外部局部变量 - 键
/var/lib/gems/1.9.1/gems/systemu-2.5.2/lib/systemu.rb:249：警告：已分配但未使用的变量 - 忽略
/var/lib/gems/1.9.1/gems/grooveshark-0.2.7/lib/grooveshark/user.rb:65：警告：方法重新定义；丢弃旧的播放列表
/var/lib/gems/1.9.1/gems/grooveshark-0.2.7/lib/grooveshark/user.rb:93：警告：方法重新定义；丢弃旧的最爱
warning_test.rb:4：警告：已初始化常量 CONSTANT

```

在这种情况下，我只想看到最后一个警告

```
warning_test.rb:4：警告：已初始化常量 CONSTANT

```

由于其他警告是由于库引起的，因此我无法直接控制它们的警告，因此它们并不那么有趣。我希望能够告诉 Ruby 只显示正在运行的项目的警告。

我意识到定义电流可能很棘手。也许只显示给定文件的警告和包含的文件`require_relative`就可以了。另一种选择是对在给定文件的目录结构中接近的文件显示警告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-31T01:26:45.110

您可以将stderr 重定向到stdout，然后grep。这是一个例子：

`ruby -w warning_test.rb 2>&1 | grep "warning_test"`

# python - 更改 3D 图（Matplotlib）的垂直（z）轴的位置？

> ID：15042129
> 
> 赞同：18
> 
> 时间：2013-02-23T15:25:36.670
> 
> 标签：python, matplotlib, mplot3d

我正在使用 Python 中的 Matplotlib 绘制一些 3D 曲面图，并注意到一个烦人的现象。根据我设置视点（相机位置）的方式，垂直 (z) 轴在左侧和右侧之间移动。这里有两个示例：[示例 1, Axis left](http://i.imagebanana.com/img/itzgmxva/Selection_001.png)，[示例 2, Axis right](http://i.imagebanana.com/img/myvwqs11/Selection_002.png)。第一个例子有 ax.view_init(25,-135) 而第二个例子有 ax.view_init(25,-45)。

我想保持观点相同（查看数据的最佳方式）。有没有办法将轴强制到一侧或另一侧？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-08-01T15:15:22.733

我需要类似的东西：在两侧绘制 zaxis。感谢@crayzeewulf 的回答，我找到了以下解决方法（左侧、右侧或两侧）：

![在此处输入图像描述](../Images/ad6102bb34cd35f87fb6406373d588d4.png)

首先根据需要绘制 3d，然后在调用`show()`wrap之前`Axes3D`使用 Wrapper 类来简单地覆盖该`draw()`方法。

Wrapper 类调用只是将某些特征的可见性设置为 False，它自己绘制并最终绘制带有修改过的 PLANES 的 zaxis。这个 Wrapper 类允许您在左侧、右侧或两侧绘制 z 轴。

```
import matplotlib
matplotlib.use('QT4Agg')
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import axes3d

class MyAxes3D(axes3d.Axes3D):

    def __init__(self, baseObject, sides_to_draw):
        self.__class__ = type(baseObject.__class__.__name__,
                              (self.__class__, baseObject.__class__),
                              {})
        self.__dict__ = baseObject.__dict__
        self.sides_to_draw = list(sides_to_draw)
        self.mouse_init()

    def set_some_features_visibility(self, visible):
        for t in self.w_zaxis.get_ticklines() + self.w_zaxis.get_ticklabels():
            t.set_visible(visible)
        self.w_zaxis.line.set_visible(visible)
        self.w_zaxis.pane.set_visible(visible)
        self.w_zaxis.label.set_visible(visible)

    def draw(self, renderer):
        # set visibility of some features False 
        self.set_some_features_visibility(False)
        # draw the axes
        super(MyAxes3D, self).draw(renderer)
        # set visibility of some features True. 
        # This could be adapted to set your features to desired visibility, 
        # e.g. storing the previous values and restoring the values
        self.set_some_features_visibility(True)

        zaxis = self.zaxis
        draw_grid_old = zaxis.axes._draw_grid
        # disable draw grid
        zaxis.axes._draw_grid = False

        tmp_planes = zaxis._PLANES

        if 'l' in self.sides_to_draw :
            # draw zaxis on the left side
            zaxis._PLANES = (tmp_planes[2], tmp_planes[3],
                             tmp_planes[0], tmp_planes[1],
                             tmp_planes[4], tmp_planes[5])
            zaxis.draw(renderer)
        if 'r' in self.sides_to_draw :
            # draw zaxis on the right side
            zaxis._PLANES = (tmp_planes[3], tmp_planes[2], 
                             tmp_planes[1], tmp_planes[0], 
                             tmp_planes[4], tmp_planes[5])
            zaxis.draw(renderer)

        zaxis._PLANES = tmp_planes

        # disable draw grid
        zaxis.axes._draw_grid = draw_grid_old

def example_surface(ax):
    """ draw an example surface. code borrowed from http://matplotlib.org/examples/mplot3d/surface3d_demo.html """
    from matplotlib import cm
    import numpy as np
    X = np.arange(-5, 5, 0.25)
    Y = np.arange(-5, 5, 0.25)
    X, Y = np.meshgrid(X, Y)
    R = np.sqrt(X**2 + Y**2)
    Z = np.sin(R)
    surf = ax.plot_surface(X, Y, Z, rstride=1, cstride=1, cmap=cm.coolwarm, linewidth=0, antialiased=False)

if __name__ == '__main__':
    fig = plt.figure(figsize=(15, 5))
    ax = fig.add_subplot(131, projection='3d')
    ax.set_title('z-axis left side')
    ax = fig.add_axes(MyAxes3D(ax, 'l'))
    example_surface(ax) # draw an example surface
    ax = fig.add_subplot(132, projection='3d')
    ax.set_title('z-axis both sides')
    ax = fig.add_axes(MyAxes3D(ax, 'lr'))
    example_surface(ax) # draw an example surface
    ax = fig.add_subplot(133, projection='3d')
    ax.set_title('z-axis right side')
    ax = fig.add_axes(MyAxes3D(ax, 'r'))
    example_surface(ax) # draw an example surface
    plt.show() 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-24T04:24:15.067

**正如 OP 在下面的评论中指出的那样，下面建议的方法没有为原始问题提供足够的答案。**

如[本说明所述，](http://matplotlib.org/mpl_toolkits/mplot3d/api.html#axis3d) [axis3d](http://matplotlib.org/mpl_toolkits/mplot3d/api.html#axis3d)中有许多硬编码值，这使得自定义其行为变得困难。所以，我认为在当前的 API 中没有很好的方法来做到这一点。您可以通过修改如下所示的`_PLANES`参数来“破解”它：`zaxis`

```
tmp_planes = ax.zaxis._PLANES 
ax.zaxis._PLANES = ( tmp_planes[2], tmp_planes[3], 
                     tmp_planes[0], tmp_planes[1], 
                     tmp_planes[4], tmp_planes[5])
view_1 = (25, -135)
view_2 = (25, -45)
init_view = view_2
ax.view_init(*init_view) 
```

现在，无论您如何旋转图形，z 轴将始终位于图形的左侧（只要正 z 方向指向上方）。x 轴和 y 轴将继续翻转。您可以使用`_PLANES`并且可能能够为所有轴获得所需的行为，但这可能会在未来版本的`matplotlib`.

# delphi - Shellexecute 返回值错误信息

> ID：15042132
> 
> 赞同：5
> 
> 时间：2013-02-23T15:25:52.343
> 
> 标签：delphi, shellexecute

当我调用 ShellExecute 时，我得到了返回值 - 一个整数。我在哪里可以获得相关的错误消息？我知道它们很笼统，但我在 MS 文档中看到了消息。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T15:32:49.867

错误处理`ShellExecute`是一场灾难。Raymond Chen 在这里讨论它：[为什么 ShellExecute 几乎对所有东西都返回 SE_ERR_ACCESSDENIED？](http://blogs.msdn.com/b/oldnewthing/archive/2012/10/18/10360604.aspx)因此，即使您可以将少数可能的`ShellExecute`错误转换为文本，您也会发现您总是得到`Access denied`. 这不是很有帮助。

底线是，如果您想要真正的错误报告，那么您需要使用[`ShellExecuteEx`](http://msdn.microsoft.com/en-gb/library/windows/desktop/bb762154.aspx). 如果失败，则调用`GetLastError`以获取 Win32 错误。要将其转换为带有描述性文本的异常，请调用`RaiseLastOSError`. 如果您只想要与错误关联的描述性文本，请调用`SysErrorMessage`.

# android - Android存储图像并在图库中查看

> ID：15042133
> 
> 赞同：1
> 
> 时间：2013-02-23T15:25:54.983
> 
> 标签：android, android-image

我正在存储来自`imageView`可用的图像`bitmap`。

我将图像存储`test.jpg`在外部存储器中，尽管图像以该名称保存（我通过使用手机中的文件管理器确认）图像未显示在显示所有其他图像的画廊中。

为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:33:50.060

媒体重新扫描通常在重新启动时完成。

您需要手动触发它以使新文件包含在图库中。

[在此处](http://developer.android.com/reference/android/media/MediaScannerConnection.html)阅读如何手动重新扫描以使其显示

# ruby-on-rails - 如何将ajax日期传递给jquery？

> ID：15042135
> 
> 赞同：0
> 
> 时间：2013-02-23T15:26:03.587
> 
> 标签：ruby-on-rails, ajax, jquery

我有一个`datepicker`，并且我想在 Movements 表的查询中使用选择的日期来检索相应的营业额。但是“ `currentDate`”没有加载`picked date`：我捕获了一个“无效日期”异常。我应该怎么做？

```
$("#datepicker").change(function(){
        var currentDate = $( "#datepicker" ).datepicker( "getDate" );
        var wantedTO = <%=Movement.where(:movementDate =>Date.parse("currentDate")).sum("turnover")%>;  
        $(document).ajaxComplete(function(){ $("#result").html("<p>Result here : </p>" + wantedTO);     
        });             
    }); 
```

请注意，如果我更换

```
var wantedTO = <%=Movement.where(:movementDate =>Date.parse("currentDate")).sum("turnover")%>; 
```

经过

```
var wantedTO = <%=Movement.where(:movementDate =>Date.today).sum("turnover")%>; 
```

它给了我今天的营业额。所以我可能不会那么远！

编辑：为了确定日期格式，我添加了一行

```
 var dateString = $.datepicker.formatDate("yy-mm-dd", currentDate); 
```

并检查确定，如果我以这种格式输入手动日期，它就可以工作。似乎是如何传递这个变量的问题，但我无法修复它。任何想法 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:02:37.217

好的，我有我的答案。如果其他新手也遇到同样的问题，我会总结一下。我的代码中有一个大错误：您不能在 Ajax 代码中进行 ruby​​ 查询。所以，你必须这样做：

1- 在您的控制器 (movements_controller.rb) 中创建一个新方法（排序）：

```
def sort
    selected_date = params[:date]
    new_html_to_return = Movement.where(:movementDate =>Date.parse(params[:date])).sum("turnover")
    render :text => new_html_to_return
end 
```

2- 在您的视图中创建一个 POST ajax 函数（index.html.erb）：

```
<script>
$(document).ready(function(){
var $datepicker = $("#datepicker"),
    currentDate = new Date(),
    dateString = "";

$datepicker.change(function(){
    currentDate = $datepicker.datepicker( "getDate" );
    dateString = $.datepicker.formatDate("yy-mm-dd", currentDate);  
    $.ajax({
        type: "POST",
        // You're sending the variable to your Ruby on Rails controller
        url: "movements/sort/",
        data: {"date":dateString},
        }).done(function(data) {
                $("#result").html("<p>Turnover: </p>" + data)
        });                         
    }); 
});
</script> 
```

3- 在您的 routes.rb 中创建关联的路由：

```
 post "movements/sort" 
```

你就完成了！享受 ！

# c# - c#中如何将ascii代码转换为普通代码？

> ID：15042137
> 
> 赞同：0
> 
> 时间：2013-02-23T15:26:13.827
> 
> 标签：c#, .net, ascii

嗨，伙计们，我想从 ascii 代码转换为普通代码，因为我做了一个从普通代码转换为 ascii 代码的方法，我想将其反转，这是我转换为 ascii 的方法

```
public string CreatSerial()
    {
        string serial = "";
        string P1, P2 = "";
        string Befor_Serial = GetDeviceSerial().Trim() + 5;
        P1 = Befor_Serial.Substring(0, Befor_Serial.Length / 2);
        P2 = Befor_Serial.Substring(Befor_Serial.Length / 2);
        Befor_Serial = P2 + "ICS" + P1;
        char[] strarr = Befor_Serial.ToCharArray();
        Array.Reverse(strarr);
        serial = new string(strarr);
        byte[] asciiBytes = Encoding.ASCII.GetBytes(serial);
        serial = "";
        foreach (byte b in asciiBytes)
        {
            serial += b.ToString();
        }
        return serial;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:26:43.220

您正在创建的字符串是不可逆的。[从MSDN](http://msdn.microsoft.com/pl-pl/library/xd12z8ts.aspx)看这个例子

```
byte[] bytes = {0, 1, 14, 168, 255};
foreach (byte byteValue in bytes)
   Console.WriteLine(byteValue.ToString());
// The example displays the following output to the console if the current
// culture is en-US:
//       0
//       1
//       14
//       168
//       255 
```

如果你把这些数字放在一起，你会得到`0114168255`。您无法从中获取字节。你能做的就是`Byte.ToString("x")`改用。它将产生底层字节值的十六进制表示。它总是长度为 2。

# c++ - 如何使用 wstring 上的任何流来提取数据

> ID：15042142
> 
> 赞同：0
> 
> 时间：2013-02-23T15:26:55.760
> 
> 标签：c++, string, stream, stringstream

我正在使用从文件中读取数据`wifstream`

txt 文件如下所示：

```
1,2,3,4,5,6,7
2,3,4,5,6,7,8
...
... 
```

每个数字都是我的程序所需的 id，逗号是分隔符这是我的代码

```
wifstream inputFile(FILE_PATH);
if(inputFile)
{
    wchar_t regex;
    int id;
    while(inputFile)
    {
        inputFile>>id;
        inputFile.get(regex);

        cout << id << ", ";                         
    }
    inputFile.close();
} 
```

这段代码工作得很好，直到我改变一次读取一行的读取方案，我想在行上做类似的事情，这样我就可以从行中读取数据，而流的缓冲区会弹出一次数据它已经像上面一样被阅读了。但我无法让它工作。这是我的代码

```
 wifstream inputFile(FILE_PATH);
    wstring line;
    if(inputFile)
    {
        while(!inputFile.eof())
        {

            std::getline(inputFile, line);

            for(int i=0; i<line.length(); i+=2)
            {
                int id;
                wchar_t regex;
                wstringstream(line)>>id; // doesn't work as it keep getting the same number
                wstringstream(line).get(regex);

                cout << id << ", ";
            }
            cout << endl;

        }
        inputFile.close();
    } 
```

我认为它不起作用的原因是我没有正确使用流并且它一直在第一个索引处读取 id 并且无论我使用多少次都不会进步`>>`（无论如何可能不是正确的使用方式)，我也试过`wifstream`了，也没用。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:37:21.400

`wstringstream`每次使用它时，您都在重新创建它。将创建移出循环：

```
wifstream inputFile(FILE_PATH);
wstring line;
if(inputFile)
{
    while(!inputFile.eof())
    {

        std::getline(inputFile, line);

        wstringstream istring(line);
        for(int i=0; i<line.length(); i+=2)
        {
            int id;
            wchar_t regex;
            istring>>id;
            istring.get(regex);

            cout << id << ", ";
        }
        cout << endl;

    }
    inputFile.close();
} 
```

# ios - 谷歌地图 SDK 与 ios6 的集成

> ID：15042143
> 
> 赞同：1
> 
> 时间：2013-02-23T15:27:19.690
> 
> 标签：ios

我创建了 API 密钥并在谷歌提供的演示项目中进行了尝试，谷歌地图工作正常。但是，尝试创建示例项目并集成 google map sdk 在运行时崩溃。

遵循的步骤

创建了一个禁用 USE STORYBOARDS 和 ARC 的单视图应用程序。使用我的项目的包标识符创建了一个 API 密钥，它是 rosnMapTest 将 GoogleMapsframework 包复制到框架组中。将 GoogleMapsbundle 从 Resources 文件夹复制到 Framework 组添加了以下所有框架

```
<pre>
<code>
    AVFoundation.framework  
    CoreData.framework
    CoreLocation.framework 
    CoreText.framework 
    GLKit.framework 
    ImageIO.framework 
    libicucore.dylib  
    libstdc++.dylib  
    libz.dylib 
    OpenGLES.framework 
    QuartzCore.framework  
    SystemConfiguration.framework
</code>
</pre>

Fixed the default Architectures and Other Linker Flags

Imported GoogleMaps.h and added google API key in AppDelegate

<pre>
<code>
  - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
        {
            self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
            // Override point for customization after application launch.
            self.viewController = [[TestViewController alloc] initWithNibName:@"TestViewController" bundle:nil];
            self.window.rootViewController = self.viewController;
            [self.window makeKeyAndVisible];
            [GMSServices provideAPIKey:@"AIzaSyAVEDscm0b307ZDFpOnn4zr4saLJF43E0Y"];
            return YES;
        }
</code>
</pre>

Added following code in viewcontroller

<pre>
<code>
     #import "TestViewController.h"
        #import <GoogleMaps/GoogleMaps.h>
        @interface TestViewController ()

        @end

        @implementation TestViewController
        GMSMapView *mapView_;

        - (void) viewDidLoad
        {
            [super viewDidLoad];

        }

        - (void)loadView {
            GMSCameraPosition *camera = [GMSCameraPosition cameraWithLatitude:-33.8683
                                                                longitude:151.2086
                                                                     zoom:6];
            mapView_ = [GMSMapView mapWithFrame:CGRectZero camera:camera];
            mapView_.myLocationEnabled = YES;
            self.view = mapView_;

            GMSMarkerOptions *options = [[GMSMarkerOptions alloc] init];
            options.position = CLLocationCoordinate2DMake(-33.8683, 151.2086);
            options.title = @"Sydney";
            options.snippet = @"Australia";
            [mapView_ addMarkerWithOptions:options];
        }

        @end
</code>
</pre>

<pre>
<code>
Error in RUNTIME: “2013-02-23 19:37:27.697 MapTest[2947:c07] +[GMSCameraPosition cameraWithLatitude:longitude:zoom:]: unrecognized selector sent to class 0xf2a4
(lldb)”
</code>
</pre> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T04:23:23.897

我认为。您没有在第 7 步设置

[https://developers.google.com/maps/documentation/ios/start#add_a_map](https://developers.google.com/maps/documentation/ios/start#add_a_map)

“选择您的项目，而不是特定目标，然后打开 Build Settings 选项卡。将 Architectures 的默认值替换为 armv7。在 Other Linker Flags 部分中，添加 -ObjC。如果这些设置不可见，请更改过滤器从基本到全部构建设置栏。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T07:44:02.090

您可以使用故事板。我认为它让 iOS 的生活更轻松 :)

你有一个工作[示例here](https://github.com/rendulic/GMaps3D)

Google 地图控制器上还附加了 OpenGL 控制器。如果你不想要它，你可以通过删除 ViewController.m 中的以下代码来忽略它：

```
UIStoryboard *mainStoryboard = [UIStoryboard storyboardWithName:@"MainStoryboard_iPhone" bundle:nil];
    _openGLController = (OpenGLController *)[mainStoryboard instantiateViewControllerWithIdentifier:@"openGLController"];

[self addChildViewController:_openGLController];
[self.view addSubview:_openGLController.view];
[self didMoveToParentViewController:self]; 
```

有了这个，如果您遇到问题，我可以帮助您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T03:26:33.657

我有同样的问题。确保将 -ObjC 标志添加到“目标”而不是“项目”的“构建设置”中。

PS 在这两个地方添加它也不会破坏它。

# iphone - 自定义 UINavigationBar 字体不显示

> ID：15042144
> 
> 赞同：3
> 
> 时间：2013-02-23T15:27:24.123
> 
> 标签：iphone, xcode, uinavigationbar, uifont

我带入 Xcode 的自定义 TrueType 字体文件未在 UINavigationBar 中正确显示。它不显示自定义字体，而是显示系统字体（Helvetica Bold）。

**根视图控制器.m**

```
self.title = @"Library";
    [[UINavigationBar appearance] setTitleTextAttributes:
     [NSDictionary dictionaryWithObjectsAndKeys:
      [UIColor whiteColor], UITextAttributeTextColor,
      [UIFont fontWithName:@"adellebasic_bold.ttf" size:20.0], UITextAttributeFont,nil]]; 
```

我还确保我将其正确复制到 Xcode 中，并`UIAppFonts`在`Info.plist`文件中声明了它。另请注意，如果我将代码设置为 iPhone SDK 中包含的 UIFont 但不是引入的自定义字体，则该代码有效。

有没有人知道我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T17:41:39.397

试试这个：

```
 NSMutableDictionary *titleBarAttributes = [NSMutableDictionary dictionaryWithDictionary: [[UINavigationBar appearance] titleTextAttributes]];

    [titleBarAttributes setValue:[UIFont fontWithName:@"adellebasic_bold" size:25.0f] forKey:UITextAttributeFont];

    [self.navigationController.navigationBar setTitleTextAttributes:titleBarAttributes];

    [self.navigationController.navigationBar setTitleVerticalPositionAdjustment:4.0f forBarMetrics:UIBarMetricsDefault]; 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:16:51.223

实际上字体文件名和字体名是两个不同的东西。检查这个：[iOS：如何设置非系统字体系列、样式、UILabel 大小？](https://stackoverflow.com/questions/6747325/ios-how-can-i-set-a-non-system-font-family-style-size-of-uilabel).

试试这个名字“Adelle Basic Bold”。

# java - 如何获取 JTable 中最后一个单元格的值？

> ID：15042147
> 
> 赞同：0
> 
> 时间：2013-02-23T15:27:54.947
> 
> 标签：java, swing, jtable, tablemodel

我有一个查询...代码运行良好，但无法获取最后一行和最后一列的最后一个单元格的值。以下是代码...请指导

使用此代码将行动态添加到 JTable ： if(e.getSource()==addb) {

```
 model.addRow(new Object[3]);
        repaint();

    } 
```

下面是从 JTable 逐行获取值的代码，稍后将代替 System.out.println() 将数据发送到数据库...

```
if(e.getSource()==submit)
    {
        int j = table.getRowCount();
        for(int row=1;row<j;row++)
        {
            for(int column=0;column<3;column++)
            {
                System.out.println("row  "+row+"   Column is  "+column);                    
                System.out.println(model.getValueAt(row, column));
            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T15:38:40.990

像这样的东西：

```
int i= table1.getRowCount()-1;
int j= table1.getColumnCount();
Object [] value = new Object[j];
for(int k = 0 ; k<j ; k++)
{
value[k] = model.getValueAt(i,k);
} 
```

另见这个小例子

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class TableTest extends JFrame implements ActionListener{

    JTable table ;
    JButton button;
    public TableTest(){
        String []colNames = {"Subject","lecturer"}; 
        String [][] rowDatas = { {"Java Programming","Jon"},
                                 {"C++ Programming","Nuhara"},
                                 {"Mathematicz","Mike"},
                                 {"Database","Saran"}
                                };
        table = new JTable(rowDatas,colNames);

        button = new JButton("Show Last Record");
        button.addActionListener(this);

        this.add(table);
        this.add(button);
        this.setVisible(true);
        this.setSize(300,200);
        this.setDefaultCloseOperation(3);
        this.setLayout(new FlowLayout());
    }
    @Override
    public void actionPerformed(ActionEvent e) {
        int i= table.getRowCount()-1;
        int j= table.getColumnCount();
        Object [] value = new Object[j];
        for(int k = 0 ; k<j ; k++)
        {
        //value[k] = table.getValueAt(i,k);
            System.out.println(table.getValueAt(i, k));
        }  
    }

    public static void main(String...ag){
        new TableTest();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T17:21:05.117

当您单击“提交”按钮时，疯狂地猜测您正在编辑最后一个单元格。

如果是这样，请参阅：[表格停止编辑](http://tips4java.wordpress.com/2008/12/12/table-stop-editing/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T03:21:21.540

谢谢阿扎德，
它现在工作得很好......
我稍微编辑了代码以从所有行中获取数据......

```
 int i= table.getRowCount()-1;
        int j= table.getColumnCount();

        for (int d=1;d<i+1;d++){   // will provide row wise data
        for(int k = 0 ; k<j ; k++)  // will provide column wise data
        {
          System.out.println("row num   "+d+"   "+model.getValueAt(d,k));
        }   } 
```

# prolog - 不要在 Prolog 中重复解决方案

> ID：15042152
> 
> 赞同：9
> 
> 时间：2013-02-23T15:28:43.947
> 
> 标签：prolog, prolog-setof

假设您有一个包含以下内容的数据库：

```
son(a, d).
son(b, d).
son(a, c).
son(b, c). 
```

所以 a 和 b 是 d 和 c 的儿子。现在你想知道，给定一个更大的数据库，谁是谁的兄弟。一个解决方案是：

```
brother(X, Y) :-
    son(X, P),
    son(Y, P),
    X \= Y. 
```

问题在于，如果您问“兄弟（X，Y）”。并开始按“；” 你会得到多余的结果，如：

*   X = a，Y = b；
*   X = b，Y = a；
*   X = a，Y = b；
*   X = b，Y = a；

我可以理解为什么我会得到这些结果，但我正在寻找一种方法来解决这个问题。我能做些什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T15:59:58.003

考虑到您的一组事实，Prolog 将始终尝试为您的陈述找到所有可能的解决方案。扩展作为深度优先搜索：

```
son(a, d).
son(b, d).
son(a, c).
son(b, c).

brother(X, Y) :-
    son(X, P),
    son(Y, P),
    X \= Y.

                         brother(X, Y)
       _______________________|____________________________        [son(X, P)]
      |               |                  |                 |
X = a, P = d     X = b, P = d       X = a, P = c      X = a, P = b
      |               |                  |                 |  
      |              ...                ...               ...
      |
      | (X and P are already defined for this branch;
      |  the algorithm now looks for Y's)
      |__________________________________________                  [son(Y, d)]
                |                                |
      son(a, d) -> Y = a               son(b, d) -> Y = b
                |                                |
                |                                |                 [X \= Y]
      X = a, Y = a -> false            X = a, Y = b -> true
                                                 |
                                                 |
                                  solution(X = a, Y = b, P = d) 
```

但是，正如您所看到的，扩展将在所有分支中执行，因此您最终会得到更多与最终答案相同的解决方案。正如@Daniel Lyons 所指出的，您可以使用`setof`内置的。

`!`一旦发现分支有效，您也可以使用--cut 运算符停止“水平”扩展，或者添加一些避免多个解决方案的语句。

有关更多信息，请查看[统一](http://en.wikipedia.org/wiki/Unification_%28computer_science%29)算法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-04-29T14:39:40.897

首先，我建议不要动态更新 Prolog 数据库。由于某些原因，请考虑文章 [“如何处理 Prolog 动态数据库？”](http://www.swi-prolog.org/howto/database.txt) .

正如@DanielLyons 在他的回答中所建议的那样，您*可以*使用内置`setof/3`和的组合。`member/2`

作为另一种选择，请考虑以下查询，它`setof/3`以一种非常不寻常的方式使用，如下所示：

```
?- setof(t,brother(X,Y),_).
X = a, Y = b ;
X = b, Y = a. 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-23T15:55:19.847

您可以通过比较消除一组：

```
brother(X, Y) :-
   son(X, P),
   son(Y, P),
   X \= Y, X @< Y.

?- brother(X, Y).
X = a,
Y = b ;
X = a,
Y = b ;
false. 
```

由于 X 和 Y 将以两种方式实例化，因此要求 X 小于 Y 是将解决方案减半的好方法。

您的第二个问题是 X 和 Y 是不止一位父母的兄弟。这里最简单的解决方案是使您的规则更加明确：

```
mother(a, d).
mother(b, d).
father(a, c).
father(b, c).

brother(X, Y) :-
  mother(X, M), mother(Y, M),
  father(X, F), father(Y, F),
  X \= Y, X @< Y.

?- brother(X, Y).
X = a,
Y = b ;
false. 
```

这种方法非常特定于这个特定问题，但根本原因不是：您有两个副本，因为`a`和`b`是“兄弟”，`c`并且也是“兄弟” `d`——Prolog 两次生成该解决方案是正确的，因为有一个隐藏变量被实例化为两个不同的价值观。

一个更优雅的解决方案可能是用来`setof/3`获取解决方案。这甚至可以使用您的原始代码：

```
?- setof(X-Y, (brother(X, Y), X @< Y), Brothers).
Brothers = [a-b]. 
```

这种方法的缺点是您最终会得到一个列表，而不是 Prolog 生成不同的解决方案，尽管您可以使用`member/2`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T17:50:20.270

这应该有效。但我认为它可以改进（我不是 Prolog 专家）：

```
brother(X, Y) :-
    son(X, P1),
    son(Y, P1),
    X @< Y,
    (son(X, P2), son(Y, P2), P1 @< P2 -> false; true). 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-23T20:18:41.757

如果您使用的是 Strawberry Prolog 编译器，您不会通过键入以下内容获得所有答案：

```
?- brother(X, Y),
   write(X), nl,
   write(Y), nl. 
```

为了得到所有的答案，写这个：

```
?- brother(X, Y),
   write(X), nl,
   write(Y), nl,
   fail. 
```

我希望它对你有帮助。:)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-02-23T23:28:05.690

我得到了一个答案。

```
% Include the dictionary
:- [p1]. % The dictionary with sons

:- dynamic(found/2).

brother(X, Y) :-
    % Get two persons from the database to test
    son(X, P),
    son(Y, P),

    % Test if the two persons are different and were not already used
    testBrother(X, Y).

% If it got here it's because there is no one else to test above, so just fail and retract all
brother(_, _) :-
    retract(found(_, _)),
    fail.

testBrother(X, Y) :-
    X \= Y,
    \+found(X, Y),
    \+found(Y, X),

    % If they were not used succed and assert what was found
    assert(found(X, Y)). 
```

它最终总是返回失败，但它通过以下方式成功。

*   兄弟（X，Y）。% 兄弟不重复
*   兄弟（'乌拉卡'，X）。％乌拉卡的每个兄弟都没有重复
*   兄弟（'乌拉卡'，'桑乔一世'）。% 是的，因为乌拉卡和桑乔我有同一个父亲和母亲。事实上，即使他们只有同一个母亲或同一个父亲，它也会返回真实的。有点脱离上下文但仍然有效，如果他们有三个或更多共同的父母，它仍然可以工作

它失败并显示以下内容：

*   兄弟（X，X）。% 错误，因为是同一个人
*   兄弟（'不'，X）。% False 因为 not 甚至不在数据库中
*   兄弟（'不'，'桑乔一世'）。% 错误，同样的原因

所以像这样我可以，例如，问：兄弟（X，Y），然后开始按“;” 看到每一个兄弟姐妹，没有任何重复。

我也可以做兄弟（a，b）和兄弟（b，a），假设a和b是数据库中的人。这很重要，因为某些解决方案会使用 @< 来测试事物，就像这样，兄弟（b，a）会失败。

就这样。

# javascript - 使用 JavaScript 中的图像刷新按钮

> ID：15042154
> 
> 赞同：0
> 
> 时间：2013-02-23T15:28:45.960
> 
> 标签：javascript, image, button, refresh

我正在尝试使用图像（.jpg）在 JavaScript 中为一个网站制作一个刷新按钮，每次它刷新两个图像都会更改（从数据库上传），但由于某种原因它不会工作。到目前为止，这是我的代码：

```
<div align="center">
<SCRIPT LANGUAGE="JavaScript">
var body = document.getElementsByTagName("body")[0];
var s = document.createElement("input");
s.src = "/Volumes/playground_people/s1267664/html/dwd/buttons/next_btn.jpg";
s.type = "image";
body.appendChild(s);

document.write('<form><input type=button value="Next" onClick="history.go()"></form>')
</script>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:01:51.020

由于我不清楚你真正想要实现什么，我只能猜测什么可以帮助你。

首先是您的“下一个”-`input`在类型周围缺少一些引号：

```
document.write('<form><input type="button" value="Next" onClick="history.go()"></form>'); 
```

我建议您将`form`直接放入`div`-container 而不是使用`document.write`.

您是否尝试将脚本中的图像添加到`button`您在下面定义的内容中？然后你必须参考它，例如`id`：

```
<div align="center">
    <input type="button" id="nextBtn" value="Next" onClick="location.reload(true)">
    <script language="JavaScript">
        var b = document.getElementById("nextBtn");
        b.src = "/Volumes/playground_people/s1267664/html/dwd/buttons/next_btn.jpg";
        b.type = "image";
    </script>
</div> 
```

我还删除了`form`, 因为它将图像坐标发送到重新加载的页面，并使用`location.reload`而不是`history.go()`.

此代码将图像添加到按钮，单击时刷新页面。

# javascript - Javascript总和没有返回正确的值

> ID：15042156
> 
> 赞同：-3
> 
> 时间：2013-02-23T15:28:55.570
> 
> 标签：javascript, jquery, html, sum

我正在编写一个代码来根据小时分钟和秒表计算总分钟数。

我一直在吃我的神经，无法弄清楚为什么这些值是错误的，小时字段乘以 600 而不是 60，分钟加起来也是错误的，似乎一团糟。

这是我的代码

```
<table width="90%"><tr>
<td><input size="4" type="text" name="<?php esc_attr_e( $field->field_id ); ?>hrs"  />   </td>
<td><input size="4" type="text" name="<?php esc_attr_e( $field->field_id ); ?>mins" /></td>
<td><input size="4" type="text" name="<?php esc_attr_e( $field->field_id ); ?>secs" /></td>
<td><input size="10" type="text" name="<?php esc_attr_e( $field->field_name ); ?>" id="    <?php esc_attr_e( $field->field_id ); ?>" class="attachments attachments-field attachments-field-<?php esc_attr_e( $field->field_name ); ?> attachments-field-<?php esc_attr_e(  $field->field_id ); ?>" value="<?php esc_attr_e( $field->value ); ?>" readonly/></td>
</tr><tr><td>&nbsp;&nbsp;&nbsp;Hours</td><td>&nbsp;&nbsp;Minutes</td>    <td>&nbsp;Seconds</td><td>&nbsp;&nbsp;&nbsp;Audio Minutes</td></tr></table> 
```

脚本：

```
jQuery(document).ready(function($)
{
    $('input[name="<?php esc_attr_e( $field->field_id ); ?>hrs"],input[name="<?php   esc_attr_e( $field->field_id ); ?>mins"],input[name="<?php esc_attr_e( $field->field_id );  ?>secs"]').change(function()
    {
        var sum = parseFloat($('input[name="<?php esc_attr_e( $field->field_id ); ?>hrs"]').val() * 60) + parseFloat(($('input[name="<?php esc_attr_e( $field->field_id ); ?>mins"]').val()) + parseFloat($('input[name="<?php esc_attr_e( $field->field_id ); ?>secs"]').val() / 60)).toFixed(2) 
        $('input[name="<?php esc_attr_e( $field->field_name ); ?>"]').val(parseFloat(sum));
    }) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:46:50.527

你的括号放错地方了。你的代码说：

```
parseFloat($('input[name=fieldname]').val() * 60) 
```

它应该说：

```
parseFloat($('input[name=fieldname]').val()) * 60 
```

（对于除以 60 的秒计算的建议相同。）

# asp.net - 启用分页后，Gridview 在回发后消失

> ID：15042157
> 
> 赞同：0
> 
> 时间：2013-02-23T15:29:01.213
> 
> 标签：asp.net, data-binding, gridview, datatable

我的问题是，当我单击按钮将数据加载到 gridview 中时，它工作正常。但是当我点击一个新页面时，gridview 消失了；然后我必须再次单击该按钮才能看到它。

有人有什么建议吗？

这是c#：

```
SqlConnection sqlConnection1 = new SqlConnection(strSQLConnection1);
SqlConnection sqlPopGrid = new SqlConnection(strSQLConnection1);
SqlCommand sqlCommandPopGrid = new SqlCommand("select id, quote, author from TABLE", sqlConnection1);

DataTable dt = new DataTable();

sqlPopGrid.Open();
SqlDataAdapter sqlDataAdapter1 = new SqlDataAdapter(sqlCommandPopGrid);
sqlDataAdapter1.Fill(dt);

if (dt.Rows.Count > 0)
{
   grd1.DataSource = dt;
   grd1.DataBind();
}

sqlPopGrid.Close(); 
```

这是aspx：

```
<asp:GridView runat="server" AllowPaging="True" AllowSorting="True"
              AutoGenerateSelectButton="True" ID="grd1" 
              OnPageIndexChanging="grd1_PageIndexChanging" 
              OnSelectedIndexChanged="grd1_SelectedIndexChanged"  
              OnSorting="grd1_Sorting">
      <PagerSettings PageButtonCount="5"></PagerSettings>
</asp:GridView> 
```

顺便说一句，如果有任何用处，我正在使用 asp.net 4.0。

# c++ - 为什么一堆树中的根节点会覆盖堆栈中的其他根节点？

> ID：15042161
> 
> 赞同：1
> 
> 时间：2013-02-23T15:29:26.987
> 
> 标签：c++, tree, stack

我创建了一个指向树的指针的下推堆栈。当用户在后缀中键入方程式时，程序将方程式存储为树（即如下所示）

34*7+ 58+ 12* 等于

```
 ----+----        ---+---      ---*---
   |        |       |     |      |     |
---*---     7       5     8      1     2
|     |
3     4 
```

然而，目前任何存储多于一个节点的树的尝试（当遇到 + 或 * 时）都会覆盖先前的树，即上述等式导致以下堆栈：

```
 ---+---      ---+---       ---*---
 |     |      |     |       |     |
 1     2      1     2       1     2 
```

我的代码如下：

```
#include <iostream>
using namespace std;

struct node
{
    char info; struct node *r, *l;
};

class Stack
{
    private:
        node *stack;
        int p;
    public:
        Stack (int max = 100)
            { stack = new node[max]; p=0; }
       ~Stack ()
            { delete stack;}
        inline void push(node item)
            { 
                stack[p] = item;
                p++;
            }
        inline node pop()
            { 
                p--;                
                return stack[p];
            }
        inline int empty ()
            { return !p; }
};

void tree(const char *ltr)
{
    struct node *z;
    Stack stack(50);
    z = new node;
    z->l =z; z->r =z;z->info='a';
    while(*ltr)
    {
        while (*ltr == ' ')
        {
            ltr ++;
        }
        struct node *x;
        x = new node;
        x ->info = *ltr; 
        if ( (*ltr == '+' || *ltr == '*') && !stack.empty())
        {
            x->r=&stack.pop();
            x->l=&stack.pop();          
        }else{
            x->l = z; x->r = z;
        }
        stack.push(*x);
        ltr++;
    }
}

int main()
{
    char word[100];
    cin.get(word, 100);
    cin.ignore(100, '\n');
    tree(word);
    cin.get();
} 
```

似乎是当 x->r = &stack.pop(); 执行它会覆盖所有先前的节点-> r。但是 node->info 没有改变，z 节点也不影响树。

有人知道发生了什么吗？几个小时以来，我一直在努力弄清楚发生了什么以及我做错了什么。

亲切的问候山姆

* * *

**修正案**

为了测试我一直在使用非递归遍历类型函数的代码（由于问题导致堆栈溢出的递归），这个代码有点乱，但我已经将它包含在下面，如果你运行它并输入：

12+ 34* 56+

你会看到我遇到的问题，它应该说：

aa5+ aa3* aa1+

而是产生：

aa5+ aa5* aa5+

```
#include <iostream>
using namespace std;

struct node
{
    char info; struct node *r, *l;
};

void traverse3(struct node *tree)
{
    {
        cout << tree->info;
    }
}
void traverse2(struct node *tree)
{
    {
        traverse3(tree->r);
        cout << tree->info;
    }
}
void traverse1(struct node *tree)
{
    {
        traverse2(tree->r);
        cout << tree->info;
    }
}

void traverse(struct node *tree)
{
    {
        traverse1(tree->r);
        cout << tree->info;
    }
}

class Stack
{
    private:
        node *stack;
        int p;
    public:
        Stack (int max = 100)
            { stack = new node[max]; p=0; }
       ~Stack ()
            { delete stack;}
        inline void push(node item)
            { 
                stack[p] = item;
                p++;
            }
        inline node pop()
            { 
                p--;                
                return stack[p];
            }
        inline int empty ()
            { return !p; }
};

void tree(const char *ltr)
{
    struct node *z,*c;
    Stack stack(50);
    z = new node;
    z->l =z; z->r =z;z->info='a';
    while(*ltr)
    {
        while (*ltr == ' ')
        {
            ltr ++;
        }
        struct node *x;
        x = new node;
        x ->info = *ltr; 
        if ( (*ltr == '+' || *ltr == '*') && !stack.empty())
        {
            x->l = &stack.pop();
            x->r = &stack.pop();
        }else{
            x->l = z; x->r = z;
        }
        stack.push(*x);
        ltr++;
    }
    c = new node;
    int q;
    for(q=0; q<3; q++)
    {
    *c = stack.pop();
    traverse(c);
    }
}

int main()
{
    char word[100];
    cin.get(word, 100);
    cin.ignore(100, '\n');
    tree(word);
    cin.get();
} 
```

# php - Apache mod_auth_form 导致内部服务器错误 500

> ID：15042162
> 
> 赞同：1
> 
> 时间：2013-02-23T15:29:37.223
> 
> 标签：php, html, forms, apache, login

我已将服务器设置为要求对所有目录进行身份验证。我正在使用 Apache 的 mod_auth_form 生成内联登录表单，以保留 HTTP_REQUEST 以便模块可以将用户保留在他们在显示登录表单时指定的任何文件/目录中。

我的问题是：我导航到域（example.com）并显示登录表单。好的。我使用不正确的凭据登录，登录表单再次显示。好的。我输入正确的凭据，收到内部服务器 500 错误。

但是，我不明白的奇怪之处是，如果我要访问一个目录（example.com/images/），登录表单会按原样显示，如果我登录，它会正确登录并显示/images 的目录索引。这适用于任何子目录，甚至适用于我在 http.conf 中创建的任何别名子目录。

唯一一次搞砸只是在根/域级别。我迷路了。

这是来自 http.conf 的相关信息 - 如果需要任何进一步的信息，请告诉我。

```
# Deny access to the entirety of your server's filesystem. You must
# explicitly permit access to web content directories in other 
# <Directory> blocks below.
<Directory />
    Options FollowSymLinks Indexes
    AllowOverride All
    Require all granted
</Directory>

--------------------------------------------------------

DocumentRoot "E:/"
# This should be changed to whatever you set DocumentRoot to.
# ======================================================
# !!! DO NOT CHANGE THIS LINE AND THE FOLLOWING ONES !!!
# DocumentRootDirectory 
<Directory "E:/">
    Options Indexes FollowSymLinks
    AllowOverride All
    Require all granted
</Directory>

--------------------------------------------------------

<IfModule alias_module>
    Alias /images_easyphp "${path}/home/server_images"

    <Directory "${path}/home/server_images">
        Options Indexes MultiViews
        AllowOverride None
        Allow from all
        Require all granted
    </Directory>

    <Directory "E:/">
        Options FollowSymLinks Indexes
        AuthFormProvider file
        AuthType form
        AuthName "Restricted Access"
        Session On
        SessionCookieName session path=/
        require valid-user
        ErrorDocument 401 /WWW/login/index.php
        AuthUserFile "c:/server/apache/passwd"
    </Directory>

    <Directory "E:/WWW/login">
        Options FollowSymLinks Indexes
        Order allow,deny
        Allow from all
        Require all granted
    </Directory>

    <Location /logout>
        SetHandler form-logout-handler
        AuthFormLogoutLocation http://domain.com
        Session On
        SessionMaxAge 1
        SessionCookieName session path=/
    </Location>

    ScriptAlias /cgi-bin/ "${path}/apache/cgi-bin/"
</IfModule> 
```

另外值得一提的是，如果我访问一个子目录并成功登录，我可以返回根/域级别，它加载得很好，没有 500 错误。

# java - 堆栈实现问题/不打印某些字符

> ID：15042165
> 
> 赞同：0
> 
> 时间：2013-02-23T15:30:00.643
> 
> 标签：java, postfix-notation

我正在尝试为后缀计算器编写中缀。我正在读取包含以下内容的文件：

> (4>3)+(3=4)+2

当我运行我的代码时，我应该得到一个包含输入的后缀表示法的字符串，但是我什么也没得到。我的代码似乎没有达到最终的打印声明。同样，当我修改代码以使其至少打印时（尽管符号不正确），它只打印数字而不是运算符（+、-、& 等）。我无法弄清楚为什么会这样！我在下面的代码中标记了打印语句的位置：

```
public static void main(String[] args) {

        readMathFile();
}

static String PF = "";

    public static void postfix(char c, myStack s, myQueue q) {
        if (c == '0' || c == '1' || c == '2' || c == '3' || c == '4' ||
                c == '5' || c == '6' || c == '7' || c == '8' || c == '9') {
            String cc = Character.toString(c);
            PF.concat(cc);
        } else if(c == '!' || c == '*' || c == '/' || c == '+' || c == '-' || 
                c == '<' || c == '>' || c == '=' || c == '&' || c == '|') {
            if(s.isEmpty())
                s.push(c);
            else {
                char top = s.peek();
                while ((precedence(top) > precedence(c)) && !s.isEmpty()) {
                    String cd = Character.toString(s.pop());
                    PF.concat(cd);
                }
                s.push(c);
            }
        }

    }

    public static myStack s;
    public static myQueue q;
    public static int i = 1;

    // the file reading code was borrowed from:
    // http://www.java2s.com/Code/Java/File-Input-Output/Readfilecharacterbycharacter.htm
    public static void readMathFile() {
        s = new myStack();
        q = new myQueue();
        File file = new File("test.txt");
        if (!file.exists()) {
            System.out.println(file + " does not exist.");
            return;
        }
        if (!(file.isFile() && file.canRead())) {
            System.out.println(file.getName() + " cannot be read from.");
            return;
        }
        try {
            FileInputStream fis = new FileInputStream(file);
            char current;
            // in this while loop is where all of the reading happens
            while (fis.available() > 0) {
                current = (char) fis.read();
                //readMath(current, s, q);
                postfix(current, s, q);
            }
            if(fis.available() == 0) {
                char x = s.pop();
                while(!s.isEmpty()) {
                    //q.enqueue(s.pop());
                    String ce = Character.toString(s.pop());
                    PF.concat(ce);
                }
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
        System.out.println("\n\n"+PF); // <----CODE NEVER REACHES THIS POINT! (and when i modify so it does, it will not print the operators!)
    } 
```

# java - 如何在 JSP 页面中添加数据过滤器

> ID：15042170
> 
> 赞同：1
> 
> 时间：2013-02-23T15:30:44.260
> 
> 标签：java, jsp, jakarta-ee, servlets

我的 JSP 页面中有 2 个或更多下拉列表...现在在我的 servlet 中，我想将两个下拉列表中选定项目的两个值传递给数据库，并将该值查询到数据库。我不想对所有可能的组合有这么多的方法，并将所有这些组合归为一类。现在我怎样才能在 ddl 中传递所选项目的两个值？

这是我的尝试

```
protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException
    {
        int SelectedOrg;
        int SelectedSec;
        String FilterByOrg = req.getParameter("OrgFilter");
        String FilterBySec = req.getParameter("SectorFilter");
        if (!"11".equals(FilterByOrg) && !"11".equals(FilterBySec))
        {       
                SelectedOrg = Integer.parseInt(req.getParameter("OrgFilter"));
                SelectedSec = Integer.parseInt(req.getParameter("SectorFilter"));
                List<OrganizationItems> orgItems = new ViewAllOrganizations().findEMSOnly(SelectedOrg, SelectedSec);
                req.setAttribute("orgItems", orgItems);
                jsp.forward(req, resp);
        }
        else
        {
            List<OrganizationItems> orgItems = new ViewAllOrganizations().findAll();
            req.setAttribute("orgItems", orgItems);
            jsp.forward(req, resp);
        }
    } 
```

这是我的 JSP 页面

```
 <form method="GET">
                            <div>
                                <span>Organization: </span> <select name="OrgFilter">
                                <option value="11">Organization Type</option>
                                <option value="22">All</option>
                                    <option value="1">Emergency Medical Service</option>
                                    <option value="3">Fire Suppression Group</option>
                                    <option value="4">Medical Facilities</option>
                                </select>
                            </div>
                            <div>
                                <span>Sector: </span> <select name="SectorFilter" onchange="submit()">
                                <option value="11">Sector Type</option>
                                    <option value="22">All</option>
                                    <option value="1">NA</option>
                                    <option value="2">Government</option>
                                    <option value="3">Private</option>
                                    <option value="4">Volunteer</option>
                                    <option value="5">Corporate/Industrial</option>
                                </select>
                            </div>
                            </form> 
```

在此之后，我的表格位于显示结果的表单标记下方

# node.js - 只返回集合猫鼬中的一项

> ID：15042175
> 
> 赞同：0
> 
> 时间：2013-02-23T15:31:06.677
> 
> 标签：node.js, mongoose

我有方法 getFollowing 来获取关注用户的列表

```
UserSchema.statics.getFollowing = function(data, callback) {
    console.log("data: ", data);
    this.findOne({
        name : data.name
    }, function(err, docs) {
        if (err)
            callback("error " + err)
        else if (docs) {
            console.log("XXXX", docs.following_count)
            mongoose.model('User').findOne({
                                     _id : docs._id
                                }).populate('following', 'name screen_name avatar _id').exec(function(err, res) {
                                    if (err)
                                        callback(err);
                                    // console.log('The following is %s', res)                          

                                });         

            callback(docs.following);
        }
        else callback('{"error": "user-not-found"}');
    });
} 
```

我只想回调发送到客户端 docs.following 列表我不知道什么时候我 console.log(docs.following) 它打印但是当我回调(docs.following) 它返回错误。

我这样定义 UserSchema

```
var UserSchema = new Schema({
created_at : { type: Date, default: Date.now }
, name : String
,   hashedPass : String
,   salt: String
,   email : Email
,   avatar : {type: String, default: "images/default_profile.png" }
,   statuses_count : Number
,   screen_name : String
,   location : String
,   about : String
,   followers: [{ type: ObjectId, ref: 'User' }]
,   following: [{ type: ObjectId, ref: 'User' }]
,   followers_count : Number
,   following_count : Number
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:36:08.717

我认为您想将该`callback(docs.following);`调用移动到回调中（您当前拥有的位置`// console.log('The following is %s', res)`）。此外，按照惯例，回调的第一个参数是错误，第二个参数是数据，因此更改`callback(docs.following);`为`callback(null, docs.following);`.

# ios - UISearchDisplayController：将多个过滤器添加到现有过滤器

> ID：15042177
> 
> 赞同：0
> 
> 时间：2013-02-23T15:31:19.377
> 
> 标签：ios, objective-c, uitableview, uisearchbar, uisearchdisplaycontroller

我正在使用`UISearchDisplayController`默认方式`UITableViewController`通过其文本值过滤 a 的单元格（例如，仅显示以字母“ab”开头的单元格）。表格视图的单元格中的值由 填充`NSFetchedResultsController`。

除了这个基于文本的过滤之外，我还想根据项目的数字范围添加额外的过滤功能（例如，我目前正在按人的姓名进行过滤，并希望应用一个额外的过滤器来仅显示指定范围）。

由于这个原因，我不能使用默认的搜索范围按钮，但需要添加额外的视图和按钮，例如按年龄过滤（`Age > 18`和`Age < 35`：一个标签和两个文本字段）。

在您的视图中向现有的`UISearchDisplayController`（如果可能与其 default 结合使用`UISearchDisplayDelegate`）添加额外的标签和文本字段的推荐视图是什么？

谢谢！

# iphone - UIRefreshControl 在 iOS6 中使用但在 iOS5 中不使用

> ID：15042180
> 
> 赞同：1
> 
> 时间：2013-02-23T15:31:33.923
> 
> 标签：iphone, ios, objective-c, uikit

我想为 iOS6 用户添加一个 UIRefreshControl 为 iOS5 用户添加一个按钮。我只想将一个包交付到应用商店（显然），那么我该怎么做呢？

我能感觉到操作系统版本

```
float ver = [[[UIDevice currentDevice] systemVersion] floatValue];
if (ver >= 6.0) {
    // Programmatically add UIRefreshControl.
} 
```

但是如果我想支持iOS5，编译器不会让我使用UIRefreshControl？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T15:35:44.560

如果编译器不让你使用它，那就让你愚弄他。您还可以（并且**应该**）从操作系统版本检测切换到功能检测。总而言之：

```
if (NSClassFromString(@"UIRefreshControl") != Nil) {
    id control = [[NSClassFromString(@"UIRefreshControl") alloc] init];
} 
```

# javascript - url中的javascript方案

> ID：15042181
> 
> 赞同：0
> 
> 时间：2013-02-23T15:31:40.040
> 
> 标签：javascript

请参考代码，

```
javascript:x=123;void(); 
```

所以当你在url中输入时，浏览器不会替换页面的内容，这是一个预期的结果。无论如何，由于js逐行执行语句，当第一个语句被执行时，浏览器应该立即替换内容，然后继续下一步不是吗？谁能解释一下js是如何执行url中的语句以及将void关键字放在最后是如何工作的。我只需要这些问题的帮助。将var x替换为未定义的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:36:55.163

这是因为，当内联使用时，浏览器会将页面内容替换为最后一个 JavaScript 语句的返回值，**除非它是`undefined`**.

运算符的值`void`恰好是`undefined`，这就是没有内容替换的原因。实际上，您也可以这样编写代码：

```
javascript:void(x=123); 
```

也可以看看：[`void`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/void)

# html - 将pdf文件嵌入html中，并允许下载

> ID：15042184
> 
> 赞同：2
> 
> 时间：2013-02-23T15:31:46.870
> 
> 标签：html, css

我想在 HTML 页面中包含一个小的 pdf 文件。棘手的部分是：我不想将它作为链接包含，而是包含完整的二进制文件。因此 html 文件将具有该 pdf 的二进制文件。我只想有一个下载按钮，它可以让我从那个 html 文件中下载 pdf 文件。是的，我希望所有内容都在一个 html 文件中。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:35:56.290

编码为 base64 并使用[Data URI](http://en.wikipedia.org/wiki/Data_URI_scheme)嵌入内联。

# java - 油漆组件不工作（Java）

> ID：15042185
> 
> 赞同：3
> 
> 时间：2013-02-23T15:31:54.430
> 
> 标签：java, swing, jframe, repaint, paintcomponent

我一直在尝试覆盖和使用paint 组件方法而不是paint 方法，因为我已经看到这里的多个问题都建议了它。

我已经查看了很多问题，但我似乎仍然无法让它发挥作用。我正在发布用于渲染屏幕的原始代码。我认为扩展 JFrame 不是正确的方法，相反我需要扩展 JPanel，并从那里使用绘图组件。我有另一个对象，我实际上扩展了 JPanel，并添加了 JFrame（用于渲染）。

这是我用来渲染的对象，顺便说一下，它可以完美地覆盖paint方法。

```
package render;

import java.util.Arrays;

import javax.swing.*;

import java.awt.*; //Graphics, Graphics2D, Image

import sprites.Picture;

public class Window extends JFrame{
    private static final long serialVersionUID = 1L;

    public static Picture[] image_list =  new Picture[0]; // All the images I want to render
    private static String win_title = "Window"; // The name of the window
    private static CustomComponents cc = new CustomComponents();

    public Window(){
        setTitle(win_title); // set my title
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); // close when you hit x button
        setUndecorated(true); // window has nothing on it

    }

    // paints all the images in image list according to their priority

    public void display(){
        add(cc);
        CustomComponents.updateImageList(image_list);
        pack();

        setMinimumSize(getSize());
        setLocationRelativeTo(null); // puts the screen in the middle
        setResizable(false); // can't resize the window
        setVisible(true); // to see the window

    }

    public double[] getWinSize(){
        double[] size = {this.getSize().getWidth(),this.getSize().getWidth()};

        return size;
    }

    public static void endAll(){
        for (Picture i:image_list){
            i = null;
        }
        image_list = new Picture[0];
        CustomComponents.updateImageList(image_list);
    }

    // close the window (seen in the game object)
    public static void close(){
        System.exit(0);
    }

    // called when adding a new sprite to the image_list array
    public static void addPicture(Picture element){
        Picture[] result = Arrays.copyOf(image_list, image_list.length +1); // does the same thing as the addObject method in objects
        result[image_list.length] = element;
        image_list = result;
        Arrays.sort(image_list);
        CustomComponents.updateImageList(image_list);

    }

    // updates the screen... Just repaints everything
    public void update() {
        cc.repaint();

    }

}

class CustomComponents extends JComponent {

    private static final long serialVersionUID = 1L;

    private static Picture[] image_list;

    public static void updateImageList(Picture[] image_list){
        CustomComponents.image_list = image_list;
    }

    @Override
    public Dimension getMinimumSize() {
        return new Dimension(640,360);
    }

    @Override
    public Dimension getPreferredSize() {
        return new Dimension(640,360);
    }

    @Override
    public Dimension getMaximumSize() {
        return new Dimension(640,360);
    }

    @Override
    public void paintComponent(Graphics graphics) {
        super.paintComponent(graphics);
        Graphics2D g2d = (Graphics2D) graphics;
        for (Picture i:image_list){
            if (i.getVisibility()){
            g2d.drawImage(i.getPic(), i.getXY()[0], i.getXY()[1], this);
            }
        }
        Toolkit.getDefaultToolkit().sync(); // this is for linux machines
        graphics.dispose(); // just good programming practice to collect the garbage
    }
} 
```

我会发布实际添加到窗口中的对象，但现在太复杂了，只发生了几件事。在构造函数中，我添加了上面的 JFrame 窗口，然后我使用计时器调用 JFrame 对象的更新方法。

如果你们真的需要代码，我可以发布它，但希望这已经足够了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-23T15:39:00.633

*   不要画画

    1.  通过`paintComponent()`直接`JFrame`使用
    2.  直接上色不是好主意`JFrame`，`JFrame`不是这项工作的合适容器
    3.  必须使用`paint()`而不是`paintComponent()`for `JFrame`，
*   *在您认为*应该覆盖父方法的`@Override`任何方法之前添加，这里是方法。这样，如果您实际上没有覆盖您认为的内容，编译器会警告您。*`paintComponent(...)`*

**   放到`JComponent / JPanel`_`JFrame`

    *   覆盖`getPreferredSize`（`JComponent / JPanel`你的硬编码 `// window size handle`），[否则`JComponent / JPanel`返回零维度](https://stackoverflow.com/a/9258934/714968)，简单的屏幕上不会显示任何内容* 

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-10T13:01:11.600

你的答案很简单：你只需要扩展`JPanel`，而不是`JFrame`。

`paintComponent`method 是一个方法 in `JPanel`，因此你从`JPanel`not from覆盖它`JFrame`*

# jquery - 如何使用jquery根据内容更改div#container高度

> ID：15042186
> 
> 赞同：-4
> 
> 时间：2013-02-23T15:32:15.960
> 
> 标签：jquery

在这个链接中，当我按下一个点时，我有一个带有一些点的地图，除了地图之外还会出现一个文本，但是当内容更大（如 Ilam 点）时，文本会出现在页脚的顶部。我如何使用 jquery 来根据点（城市）内容调整高度。谢谢！

链接是[http://test.dariuscarpets.gr/%CF%80%CE%B5%CF%81%CF%83%CE%B9%CE%BA%CE%AC-%CF%87%CE%B1 %CE%BB%CE%B9%CE%AC/](http://test.dariuscarpets.gr/%CF%80%CE%B5%CF%81%CF%83%CE%B9%CE%BA%CE%AC-%CF%87%CE%B1%CE%BB%CE%B9%CE%AC/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:58:54.437

您可以通过修改 html 结构和 css 来解决此问题。修复应该是这样的。

```
<div class="map_container">
    links........
</div>
<div class="detail_container" style="display: block;">
</div>
<div class="city_detail_container">
</div> 
```

将 .map_container 的高度更改为 800px。从 .detail_container 中删除 position: absolute 和 top: 800px。

# dart - Dart Mirror API：获取反射调用的结果

> ID：15042187
> 
> 赞同：2
> 
> 时间：2013-02-23T15:32:18.273
> 
> 标签：dart, dart-mirrors

让镜子返回期货极大地限制了你可以用它们做的事情。

例如，

```
class ObjectA {
  methodA(){}
  methodB(){}
}

class DynamicWrapper extends MagicalDynamicWrapper {
  ObjectA real;
  Map<String, Function> methods;
  DynamicWrapper(this.real, this.methods);
}

var w = new DynamicWrapper(new ObjectA(), {"methodB" : (){ 'do something' }});
w.methodA() // calls ObjectA.methodA
w.methodB() // calls 'do something' 
```

我通常这样做的方式是在 MagicalDynamicWrapper 中定义 noSuchMethod：

*   这将检查方法映射中是否存在具有这样名称的方法，然后调用它。
*   如果没有，它将通过反射调用“真实”对象。

不幸的是，调用真实对象总是会返回一个未来。所以它不起作用。

在某些时候，可以获得 Future 的值（使用 value getter），但该 getter 不再可用。

我的问题：

有没有办法同步获得反射调用的结果？

在分布式环境中，futures 绝对是要走的路。但是在所有元信息都可用的非分布式设置中，应该可以获取反射调用的值。我会对测试框架和构建工具的作者产生巨大的影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:07:29.250

> 让镜子返回期货当然是有道理的

不，它没有（好吧，至少对我来说不是:-)）。它可能会改变，见[http://dartbug.com/4633#c17](http://dartbug.com/4633#c17)

> 我通常这样做的方式是在 MagicalDynamicWrapper 中定义 noSuchMethod ，它将检查方法映射中是否存在具有这样名称的方法，然后调用它，如果没有，它将通过调用“真实”对象反射。

检查`InvocationMirror`文档。您可以使用以下方法转发方法调用`invokeOn`：

```
class Proxy {
  var target;
  Map<String, Function> overrides;

  Proxy(this.target, this.overrides);

  noSuchMethod(invocation) {
    if (overrides.containsKey(invocation.memberName)) {
      return overrides[invocation.memberName]();
    } else {
      return invocation.invokeOn(target);
    }
  }
} 
```

> 有没有办法同步获得反射调用的结果？

不，不是。不是现在。如果您愿意，可以为[http://dartbug.com/4633 加注星标。](http://dartbug.com/4633)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T20:20:15.580

暂时你可以使用 deprecatedFutureValue(aFuture)。显然，他们不鼓励使用它，它最终会消失，但我同意，在我们获得同步镜像 API 之前，你绝对需要这样的东西。

# android - 如何向用户显示网络连接状态

> ID：15042192
> 
> 赞同：0
> 
> 时间：2013-02-23T15:33:15.147
> 
> 标签：android, android-layout, android-view, layout-inflater

我的应用程序只有在有网络连接的情况下才能工作。因此，我在应用程序启动和恢复时检查是否相同。

我有一个监听网络变化的广播接收器。

如果没有网络，我想显示一个简单的“无网络连接”视图。“无网络连接”包含一个文本视图，说明没有悲伤的脸的互联网。

当网络可用时，从广播接收器，我想将“无连接视图”更改为“仪表板”视图。

“仪表板”视图包含应用程序的主要业务逻辑和工作流程。

因此，根据网络状态，活动在两个视图之间摆动。

**实现这一目标的最佳方法是什么？**

**案例1：**两个视图都有自己的活动。问题：我需要为“无连接”视图处理多余的后压和生命周期事件。

**案例2：**一项活动并根据网络状态动态使用切换视图

**案例 3：**在同一个 xml 文件中有两个布局（相对布局）。根据状态打开/关闭可见性。

**案例 4：使用 Inflater**动态切换视图。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:36:32.863

使用一个活动和两个片段：ConnectStatusFragment,DashboardFragment

```
private void showFramentDepends(){
    if(networkisfine){
        // init your fragmnet
        switchFragment(ConnectStatusFragment);
    }else{
        switchFrament(DashboardFragment);
    }
}

private void switchFragment(Fragment fragment){
    FragmentTransaction ft = getSupportFragmentManager().beginTransaction();
    ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
    ft.replace(R.id.content_fragment, fragment);
    ft.commit();
} 
```

并且您的活动布局 xml 文件应如下所示：

```
<FrameLayout
    android:id="@+id/content_fragment"
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:layout_weight="1">
</FrameLayout> 
```

# facebook - 在 PHP SDK 中使用批量请求获取 Facebook 专辑封面

> ID：15042195
> 
> 赞同：1
> 
> 时间：2013-02-23T15:33:35.030
> 
> 标签：facebook, facebook-php-sdk, facebook-batch-request

我正在通过批处理请求使用 PHP SDK（以便更快地获取所有专辑的封面）。它工作正常，但我得到的图片不是专辑封面，而是各种裁剪尺寸的单张图片。

```
$albums_resp = $facebook->api('/'.$fbid.'/albums','GET');
$albums = $albums_resp['data'];

//prepare batch query for album covers
$queries = array ();    
foreach ($albums as $album)
{
    if ($album['cover_photo'] != null)
    {
        $query = array('method' => 'GET', 'relative_url' => $album['cover_photo']);
        array_push($queries, $query);
    }
}

$queries_str = json_encode($queries);
$batchResponse = $facebook->api('?batch='.$queries_str, 'POST'); 
```

我知道还有另一种方法可以使用[此处](https://stackoverflow.com/questions/5169543/facebook-php-sdk-getting-cropped-album-cover)`/{albumID}/picture?type=small`所示的 URL，但我仍然无法获得 facebook 在封面中显示的相同图像大小（我尝试过, , ），当我在对所有专辑的批量请求中使用这种方法时，我似乎没有任何方法可以将响应与专辑 ID 关联起来。我得到的响应是带有图像位置的重定向状态 302。`thumbnail``small``cover`

我也不想直接放图片链接`/{albumID}/picture?type=small`，因为如果有 25 个相册，这意味着 25 个图片重定向，使页面变慢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T23:34:31.643

我最终所做的是使用`cover_photo`ID 获取完整的图像信息（包括不同大小的图像的 URL 以及 ID 本身）并将其与专辑的封面照片 ID 相关联。

```
$cover_photos = array();
foreach ($batchResponse as $cover_photo_resp)
{   
    if ($cover_photo_resp['code'] == 200)
    {
        $cover_photo = json_decode($cover_photo_resp['body'], true);    
        $cover_photos[$cover_photo['id']] = $cover_photo;
    }
}

//correlate the cover photos with the respective albums, according to the cover photo ID
for ($i = 0; $i < count($albums); $i++)
{
    $albums[$i]['cover_photo_obj'] = $cover_photos[$albums[$i]['cover_photo']]; 
} 
```

你最终得到的是`$albums[]`关联数组的数组，每个数组在每个相册中都有一个额外的字段，指的是`cover_photo_obj`包含有关封面照片的所有信息的对象。

# php - 在匿名 PHP 函数中从父范围访问变量

> ID：15042197
> 
> 赞同：34
> 
> 时间：2013-02-23T15:33:41.357
> 
> 标签：php, closures

我想编写一个函数来记录事务，但匿名函数范围似乎没有注册父范围`$db`和`$value`变量。如何将变量传递到闭包中？

具有讽刺意味的是，SO 标签“闭包”并没有非常准确地描述它的 PHP 版本......？

```
class controller
{
    function submit()
    {
        $db = new database();
        $result = $db->execute_tx(function() {
            $db->insert_model_a($value_a); // ERROR: $db is non-object
            $db->insert_model_b($value_b);
        });
    }
}

class database
{
   function execute_tx($atomic_action)
   {
        try
        { 
            $this->start();
            $atomic_action();
            $this->commit();
            // etc..
        }
        catch(...)
        { 
            $this->rollback();
            // etc..
        } 
        finally
        {
            // etc..
        }
   }

   function insert_model_a() { ... }
   function insert_model_b() { ... }
} 
```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-02-23T15:35:21.807

使用`use`关键字将变量绑定到函数的范围内。

```
function() use ($db) { 
```

> 闭包也可以从父作用域继承变量。任何此类变量都必须在函数头中声明 [使用`use`]。
> 
> [http://www.php.net/manual/en/functions.anonymous.php](http://www.php.net/manual/en/functions.anonymous.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-06-25T18:59:47.287

自 PHP 8.0 起，[箭头函数](https://www.php.net/manual/en/functions.arrow.php)已经可用。这些从父范围继承变量而没有任何声明：

> 箭头函数支持与[匿名函数](https://www.php.net/manual/en/functions.anonymous.php)相同的功能，只是使用父作用域中的变量始终是自动的。

它们旨在与单个表达式一起使用，因此对于问题中的代码并不理想，但使用其中两个将起作用：

```
class Controller
{
    function submit()
    {
        $db = new database();
        // one assumes $value_a and $value_b are defined in the submit method
        $result = $db->execute_tx(fn() => $db->insert_model_a($value_a));
        $result = $db->execute_tx(fn() => $db->insert_model_b($value_b));
    }
} 
```

# vb.net - 在 Visual Basic 2010 中嵌入自定义字体文本框使用

> ID：15042199
> 
> 赞同：2
> 
> 时间：2013-02-23T15:33:57.813
> 
> 标签：vb.net, visual-studio-2010, fonts, textbox, gdi

好的，我正在解决在文本框中嵌入 LCD 类型 True Type 字体的问题。至于一些背景，如果我将字体安装到我的系统上，我可以显示 lcd 字体，然后将其加载为文本框的字体类型，效果很好。但是，它不能作为应用程序中的嵌入字体。我正在使用 Visual Basic 中的 Windows 窗体应用程序，来自 Windows 7 机器上的 Microsoft Visual Studio 2010。

在将字体存储为资源文件并将属性设置为嵌入资源之后，我使用内存中的私有字体集合尝试了以下代码。

```
Imports System.Drawing.Text

Imports System.Runtime.InteropServices

Module CustomFont

'PRIVATE FONT COLLECTION TO HOLD THE DYNAMIC FONT

Private _pfc As PrivateFontCollection = Nothing

Public ReadOnly Property GetInstance(ByVal Size As Single, _

                                     ByVal style As FontStyle) As Font

    Get

        'IF THIS IS THE FIRST TIME GETTING AN INSTANCE

        'LOAD THE FONT FROM RESOURCES

        If _pfc Is Nothing Then LoadFont()

        'RETURN A NEW FONT OBJECT BASED ON THE SIZE AND STYLE PASSED IN

        Return New Font(_pfc.Families(0), Size, style)

    End Get

End Property

Private Sub LoadFont()

    Try

        'INIT THE FONT COLLECTION

        _pfc = New PrivateFontCollection

        'LOAD MEMORY POINTER FOR FONT RESOURCE

        Dim fontMemPointer As IntPtr = _

            Marshal.AllocCoTaskMem( _

            My.Resources.DIGITALDREAMNARROW.Length)

        'COPY THE DATA TO THE MEMORY LOCATION

        Marshal.Copy(My.Resources.DIGITALDREAMNARROW, _

                     0, fontMemPointer, _

                     My.Resources.DIGITALDREAMNARROW.Length)

        'LOAD THE MEMORY FONT INTO THE PRIVATE FONT COLLECTION

        _pfc.AddMemoryFont(fontMemPointer, _

                           My.Resources.DIGITALDREAMNARROW.Length)

        'FREE UNSAFE MEMORY

        Marshal.FreeCoTaskMem(fontMemPointer)

    Catch ex As Exception

        'ERROR LOADING FONT. HANDLE EXCEPTION HERE

    End Try

End Sub

End Module 
```

此代码的问题在于您应该将控件的 UseCompatibleTextRendering 属性启用为 true。如果在标签或按钮文本上使用此模块，则效果很好。但是，对于文本框，没有 UseCompatibleTextRendering 属性。

我开始明白文本框使用 GDI 渲染，而其他文本控件使用 GDI+（我可能已经切换了那些，所以不要引用我的话，我只记得它们是不同的）。

我发现一些较旧的代码片段尝试使用 Windows 中 gdi32.dll 文件中的 AddFontMemResourceEX 函数，有些人声称它可以在文本框中使用。所以我创建了以下课程。

```
Imports System
Imports System.Drawing.Text
Imports System.IO
Imports System.Reflection

Public Class GetLCDFont
Private Declare Auto Function AddFontMemResourceEX Lib "gdi32.dll" _
    (ByVal pbFont As Integer, ByVal cbFont As Integer, _
     ByVal pdv As Integer, ByRef pcFonts As Integer) As IntPtr

Public Shared Function GetFont(ByVal fontName As String) As FontFamily

    Dim exeCurrent As [Assembly] = [Assembly].GetExecutingAssembly()
    Dim nameSpc As String = exeCurrent.GetName().Name.ToString()
    Dim fontCollection As New PrivateFontCollection
    Dim loadStream As Stream = exeCurrent.GetManifestResourceStream( _
        nameSpc + "." + fontName)
    Dim byteBuffer(CType(loadStream.Length, Integer)) As Byte

    loadStream.Read(byteBuffer, 0, Int(CType(loadStream.Length, Integer)))

    Dim fontPtr As IntPtr = Runtime.InteropServices.Marshal.AllocHGlobal( _
        Runtime.InteropServices.Marshal.SizeOf(GetType(Byte)) * _
        byteBuffer.Length)

    Runtime.InteropServices.Marshal.Copy(byteBuffer, 0, fontPtr, byteBuffer.Length)

    fontCollection.AddMemoryFont(fontPtr, byteBuffer.Length)

    Dim pcFonts As Int32 = 1

    AddFontMemResourceEX(fontPtr, byteBuffer.Length, 0, pcFonts)

    Runtime.InteropServices.Marshal.FreeHGlobal(fontPtr)
    Return fontCollection.Families(0)

End Function

Public Sub New()

End Sub

Protected Overrides Sub Finalize()
    MyBase.Finalize()
End Sub
End Class 
```

然而，当调用这个类时，我得到一个 InvalidOperationException 未处理。错误是无法在 DLL 'gdi32.dll' 中找到一个名为 'AddFontMemResourceEX' 的条目。

希望有人可以帮助我告诉我哪里出了问题，或者指出一个方向，以帮助我在文本框中嵌入字体以与 Windows 窗体应用程序一起使用。

MSDN 中引用的大多数示例都指向如何在使用 WPF 应用程序时打包字体。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T01:42:31.367

我一直在使用上面的代码作为标签，但从未尝试过使用文本框。

您可以创建一个继承自 Textbox 的自定义文本框类，然后重写 WndProc 方法，因为 OnPaint 不会呈现文本。

```
Public Class CustomTextBox
  Inherits TextBox

  Public Const WM_NCPAINT As Integer = &H85

  <DllImport("User32.dll")> _
  Public Shared Function GetWindowDC(ByVal hWnd As IntPtr) As IntPtr
  End Function

  <DllImport("user32.dll")> _
  Private Shared Function ReleaseDC(ByVal hWnd As IntPtr, ByVal hDC As IntPtr) As Boolean
  End Function

  Protected Overrides Sub WndProc(ByRef m As Message)
    MyBase.WndProc(m)

    If m.Msg = WM_NCPAINT Then
      Dim hDC As IntPtr = GetWindowDC(m.HWnd)
      Using g As Graphics = Graphics.FromHdc(hDC)
        g.DrawString(Me.Text, GetInstance(10, FontStyle.Bold), New SolidBrush(Me.ForeColor), Me.ClientRectangle)
      End Using
      ReleaseDC(m.HWnd, hDC)
    End If

  End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-19T19:19:49.940

虽然它不是很干净，但您可以使用安装程序将字体放在应用程序目录中，然后使用以下方法将它们加载到 PrivateFontCollection 中：

```
 For Each fontfile As String In System.IO.Directory.GetFiles(filepath & "\Fonts", "*.ttf")
        _pfc.AddFontFile(fontfile)
    Next fontfile 
```

我不知道为什么微软会以不同的方式对待它，但我的 TextBoxes 和 ComboBoxes 现在使用我的自定义字体，即使它们没有 UseCompatibleTextRendering 属性。

# python - python中的希伯来日历

> ID：15042200
> 
> 赞同：8
> 
> 时间：2013-02-23T15:34:02.310
> 
> 标签：python, calendar

我必须在 Python 中使用犹太日历。我想知道 Python 中是否有犹太日历，或者 python 中是否有导入

希望得到答案

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T15:42:10.953

您可以使用[Python Date Utilities 模块](http://sourceforge.net/projects/pythondateutil/)，该模块声称可以在不同的日期系统（包括希伯来语）之间进行转换。

此站点上有更多信息（[Python 中的犹太日历计算](http://www.david-greve.de/luach-code/jewish-python.html)），其中涵盖了一些实用程序的手动实现，例如犹太假期的计算和每周的 Torah 会议。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-11-17T19:36:57.163

[pyluach](https://github.com/simlist/pyluach)使得将犹太日期转换为公历，反之亦然。
它也有每周托拉阅读（Parasha），但没有犹太节日。

# json - 如何在 Play 2.1 中序列化/反序列化与 Json 之间的案例类

> ID：15042205
> 
> 赞同：14
> 
> 时间：2013-02-23T15:34:25.247
> 
> 标签：json, scala, playframework-2.0, playframework-2.1

我正在尝试将一些案例类序列化/反序列化到/来自 Json ......并且在处理只有一个字段的案例类时遇到了麻烦（我使用的是 Play 2.1）：

```
import play.api.libs.json._
import play.api.libs.functional.syntax._

case class MyType(type: String)

object MyType {

  implicit val myTypeJsonWrite = new Writes[MyType] {
    def writes(type: MyType): JsValue = {
      Json.obj(
        "type" -> MyType.type
      )
    }
  }

  implicit val myTypeJsonRead = (
    (__ \ 'type).read[String]
  )(MyType.apply _)
} 
```

上面的代码总是生成以下错误消息：

```
[error] /home/j3d/Projects/test/app/models/MyType.scala:34: overloaded method value read with alternatives:
[error]   (t: String)play.api.libs.json.Reads[String] <and>
[error]   (implicit r: play.api.libs.json.Reads[String])play.api.libs.json.Reads[String]
[error]  cannot be applied to (String => models.MyType)
[error]     (__ \ 'method).read[String]
[error]                        ^ 
```

我知道......一个只包含一个字符串的案例类没有多大意义......但我需要序列化/反序列化一个与我上面描述的来自外部库的案例类非常相似的案例类。

任何的想法？我错过了什么吗？任何帮助将不胜感激......我快疯了:-(谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-23T17:04:54.270

Json 组合器不适用于 Play 2.1 中的单字段案例类（在 2.2 中应该可以）

Pascal（此 API 的作者）在这里解释了这种情况[https://groups.google.com/forum/?fromgroups=#!starred/play-framework/hGrveOkbJ6U](https://groups.google.com/forum/?fromgroups=#!starred/play-framework/hGrveOkbJ6U)

有一些可行的解决方法，例如：

```
case class MyType(value: String)
val myTypeRead = (__ \ 'value).read[String].map(v => MyType(v)) // covariant map 
```

ps:`type`是 Scala 中的关键字，不能用作参数名称（但我假设仅用于此示例）

编辑：play 2.3.X 还不需要这个解决方法。宏工作正常。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-23T17:13:28.717

问题是（据我所知）Play 2.1 框架仅处理从`Tuple2`. 在示例中，它是这样使用的：

```
case class CaseClass(key1: String, key2: String)
object CaseClass {
  implicit val caseClassFormat = {
    val jsonDescription =
      (__ \ "key1").format[String] and (__ \ "key2").format[String]

    jsonDescription(CaseClass.apply _, unlift(CaseClass.unapply))
  }
} 
```

然后使用它

```
val caseClassJson = Json.toJson(CaseClass("value1", "value2"))

println(caseClassJson)
println(Json.fromJson[CaseClass](caseClassJson)) 
```

在您的情况下，您不能使用该`and`方法（您只有一个值），因此无法访问那个不错的`apply`函数`FunctionalBuilder#CanBuildX`（其中 X 是 1 到 22）。

为了提供类似的东西，您可以创建一个隐式类，该类提供一个`build`与那个不错的方法具有相似签名的`apply`方法

```
implicit class FormatBuilder[M[_], A](o: M[A]) {
  def build[B](f1: A => B, f2: B => A)(implicit fu: InvariantFunctor[M]) =
    fu.inmap[A, B](o, f1, f2)
} 
```

现在你可以像这样调整你的案例类

```
case class MyType(tpe: String)

object MyType {
  implicit val myTypeFormat =
    ((__ \ "type").format[String]) build (MyType.apply _, unlift(MyType.unapply))
} 
```

然后你可以像这样使用它

```
val myTypeJson = Json.toJson(MyType("bar"))

println(myTypeJson)
println(Json.fromJson[MyType](myTypeJson)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-24T09:13:28.133

为什么不简单地将未使用的字段添加到案例类。发表体面的评论或使用不言自明的字段名称。

```
//f2 is unused field for de/serialization convenience due to limitation in play

case class SingleField(f1: String, f2: Option[String]) 
object SingleField {
   implicit val readSingleField : Reads[SingleField] = (
        (__ \ "f1").read[String] and 
           (__ \ "f2").readNullable[String])(SingleField.apply _)  
} 
```

# perl - 我如何将它插入哈希？

> ID：15042210
> 
> 赞同：2
> 
> 时间：2013-02-23T15:34:52.057
> 
> 标签：perl

我是 perl 的新手，我试图将一些数据插入哈希中，但卡住了，不胜感激....

我有以下数据

```
Catalog database partition number          = 0
Snapshot timestamp                         = 02/23/2013 21:02:08.262661
Number of automatic storage paths          = 1
      File system ID                       = 2304
      Storage path free space (bytes)      = 1385955328
      File system used space (bytes)       = 26495475712
      File system total space (bytes)      = 27948539904
High water mark for connections            = 82
Application connects                       = 32747
Secondary connects total                   = 3
Applications connected currently           = 22
Appls. executing in db manager currently   = 1
Agents associated with applications        = 24
Maximum coordinating agents                = 82
Locks held currently                       = 6
Lock waits                                 = 172
Lock list memory in use (Bytes)            = 33264
Deadlocks detected                         = 2
Lock escalations                           = 0
Exclusive lock escalations                 = 0
Agents currently waiting on locks          = 0
Lock Timeouts                              = 87
Number of indoubt transactions             = 0
Total Private Sort heap allocated          = 0
Total Shared Sort heap allocated           = 45
Shared Sort heap high water mark           = 36412
Total sorts                                = 44986014
Sort overflows                             = 4928
Active sorts                               = 1
Buffer pool data logical reads             = 137473219
Buffer pool data physical reads            = 6403328
Buffer pool temporary data logical reads   = 9360028
Buffer pool temporary data physical reads  = 7684
Asynchronous pool data page reads          = 6031755
Buffer pool data writes                    = 1477714
Asynchronous pool data page writes         = 6667
Buffer pool index logical reads            = 7386632979
Buffer pool index physical reads           = 418928
Buffer pool temporary index logical reads  = 0
Buffer pool temporary index physical reads = 0
Asynchronous pool index page reads         = 26653
Buffer pool index writes                   = 127741
Asynchronous pool index page writes        = 103030
Buffer pool xda logical reads              = 4
Buffer pool xda physical reads             = 4
Buffer pool temporary xda logical reads    = 0
Buffer pool temporary xda physical reads   = 0
Buffer pool xda writes                     = 0
Asynchronous pool xda page reads           = 0
Asynchronous pool xda page writes          = 0
Total buffer pool read time (milliseconds) = 39674360
Total elapsed asynchronous read time       = 33908937
Total elapsed asynchronous write time      = 1806167
Asynchronous data read requests            = 5770802
Asynchronous index read requests           = 2997
Asynchronous xda read requests             = 0
No victim buffers available                = 6679989
LSN Gap cleaner triggers                   = 162
Dirty page steal cleaner triggers          = 1150
Dirty page threshold cleaner triggers      = 118
Time waited for prefetch (ms)              = 18934507
Unread prefetch pages                      = 2147
Direct reads                               = 126622020
Direct writes                              = 43430
Direct read requests                       = 228012
Direct write requests                      = 3441
Direct reads elapsed time (ms)             = 1732753
Direct write elapsed time (ms)             = 12100
Database files closed                      = 0
Commit statements attempted                = 118401
Rollback statements attempted              = 1128
Dynamic statements attempted               = 352842
Static statements attempted                = 36096602329
Failed statement operations                = 26388
Select SQL statements executed             = 21659801876
Xquery statements executed                 = 0
Update/Insert/Delete statements executed   = 549460
DDL statements executed                    = 906
Inactive stmt history memory usage (bytes) = 0
Internal automatic rebinds                 = 42
Internal rows deleted                      = 9428
Internal rows inserted                     = 44
Internal rows updated                      = 117
Internal commits                           = 39840
Internal rollbacks                         = 104
Internal rollbacks due to deadlock         = 17
Rows deleted                               = 6225
Rows inserted                              = 295031
Rows updated                               = 12347
Rows selected                              = 14447342482
Rows read                                  = 656654938
Binds/precompiles attempted                = 27
Log space used by the database (Bytes)     = 3750726
Maximum secondary log space used (Bytes)   = 0
Maximum total log space used (Bytes)       = 40319972
Secondary logs allocated currently         = 0
Log pages read                             = 5561
Log read time (sec.ns)                     = 5.000000004
Log pages written                          = 89962
Log write time (sec.ns)                    = 3046.000000004
Number write log IOs                       = 74822
Number read log IOs                        = 696
Number partial page log IOs                = 22821
Number log buffer full                     = 0
Log data found in buffer                   = 152701
Appl id holding the oldest transaction     = 11
Log to be redone for recovery (Bytes)      = 3765430
Log accounted for by dirty pages (Bytes)   = 3765430
File number of first active log            = 3691
File number of last active log             = 3740
File number of current active log          = 3691
Package cache lookups                      = 185429597
Package cache inserts                      = 9486
Package cache overflows                    = 0
Package cache high water mark (Bytes)      = 52494336
Application section lookups                = 1737096759
Application section inserts                = 173693
Catalog cache lookups                      = 737785
Catalog cache inserts                      = 960
Catalog cache overflows                    = 0
Catalog cache high water mark              = 4521984
 Shared high water mark                    = 0
 Corresponding shared overflows            = 0
 Total shared section inserts              = 0
 Total shared section lookups              = 0
 Private high water mark                   = 13232700
 Corresponding private overflows           = 0
 Total private section inserts             = 173693
 Total private section lookups             = 2927458754
Number of hash joins                       = 1418296
Number of hash loops                       = 0
Number of hash join overflows              = 15
Number of small hash join overflows        = 0
Post threshold hash joins (shared memory)  = 0
Active hash joins                          = 0
       Current size (bytes)                    = 655360
       High water mark (bytes)                 = 7733248
       Configured size (bytes)                 = 20512768
       Current size (bytes)                    = 47710208
       High water mark (bytes)                 = 52494336
       Configured size (bytes)                 = 1059061760
       Current size (bytes)                    = 4521984
       High water mark (bytes)                 = 4521984
       Configured size (bytes)                 = 1059061760
       Secondary ID                            = 6
       Current size (bytes)                    = 15073280
       High water mark (bytes)                 = 15073280
       Configured size (bytes)                 = 1059061760
       Secondary ID                            = 5
       Current size (bytes)                    = 69402624
       High water mark (bytes)                 = 69402624
       Configured size (bytes)                 = 1059061760
       Secondary ID                            = 4
       Current size (bytes)                    = 41549824
       High water mark (bytes)                 = 41549824
       Configured size (bytes)                 = 1059061760
       Secondary ID                            = 3
       Current size (bytes)                    = 263454720
       High water mark (bytes)                 = 263454720
       Configured size (bytes)                 = 1059061760
       Secondary ID                            = 2
       Current size (bytes)                    = 8585216
       High water mark (bytes)                 = 8585216
       Configured size (bytes)                 = 1059061760
       Secondary ID                            = 1
       Current size (bytes)                    = 169279488
       High water mark (bytes)                 = 169279488
       Configured size (bytes)                 = 1059061760
       Current size (bytes)                    = 851968
       High water mark (bytes)                 = 851968
       Configured size (bytes)                 = 1059061760
       Current size (bytes)                    = 589824
       High water mark (bytes)                 = 589824
       Configured size (bytes)                 = 1059061760
       Current size (bytes)                    = 458752
       High water mark (bytes)                 = 458752
       Configured size (bytes)                 = 1059061760
       Current size (bytes)                    = 393216
       High water mark (bytes)                 = 393216
       Configured size (bytes)                 = 1059061760
       Current size (bytes)                    = 2490368
       High water mark (bytes)                 = 18284544
       Configured size (bytes)                 = 146800640
       Current size (bytes)                    = 212926464
       High water mark (bytes)                 = 212926464
       Configured size (bytes)                 = 212992000
       Current size (bytes)                    = 15073280
       High water mark (bytes)                 = 25690112
       Configured size (bytes)                 = 105381888
       Current size (bytes)                    = 131072
       High water mark (bytes)                 = 131072
       Configured size (bytes)                 = 20971520 
```

现在我如何将它插入哈希

我做的方式是

```
%hash = map {chomp ; split /\s+=\s+[0-9]/} (@dblst); 
```

其中 dblst 是包含数据的数组

当我这样做时，我得到

```
$VAR1 = {
          '' => '0971520',
          '385955328' => '      File system used space (bytes)',
          'Deadlocks ' => 'detected',
          'triggers' => '18',
          'Catalog cache ' => 'overflows',
          '69279488' => '       Configured size (bytes)',
          'Catalog cache high water ' => 'mark',
          'Internal rows ' => 'updated',
          'Failed statement ' => 'operations',
          'Snapshot ' => 'timestamp',
          '733248' => '       Configured size (bytes)',
          'Rows ' => 'read',
          'written' => '9962',
          'Buffer pool temporary data physical ' => 'reads',
          'reads' => 'Asynchronous pool xda page ',
          'time' => '806167',
          'Number of small hash join ' => 'overflows',
          '31072' => '       Configured size (bytes)',
          '750726' => 'Maximum secondary log space used (Bytes)',
          'Asynchronous pool index page ' => 'writes',
          'Direct ' => 'reads',
          '      File system total space (bytes)' => '',
          'lookups' => '926693856',
          'transactions' => 'Total Private Sort heap ',
          'Log space used by the database (Bytes)' => '',
          'sorts' => 'Buffer pool data logical ',
          '490368' => '       High water mark (bytes)',
          'Buffer pool temporary index physical ' => 'reads',
          '.000000004' => 'Log pages ',
          'inserted' => '95031',
          '684' => 'Asynchronous pool data page ',
          '28012' => 'Direct write ',
          '691' => 'Package cache ',
          'Time waited for prefetch (ms)' => '',
          'rebinds' => '2',
          '059061760' => '       Current size (bytes)',
          'connections' => '2',
          'Database files ' => 'closed',
          '       Current size (bytes)' => '',
          'Log write time (sec.ns)' => '',
          '17' => 'Internal ',
          '7948539904' => 'High water mark for ',
          '7710208' => '       High water mark (bytes)',
          'transaction' => '1',
          '51968' => '       High water mark (bytes)',
          'Log read time (sec.ns)' => '',
          'Update/Insert/Delete statements ' => 'executed',
          'Shared Sort heap high water ' => 'mark',
          'total' => 'Applications connected ',
          '3908937' => 'Total elapsed asynchronous write ',
          '6653' => 'Buffer pool index ',
          'Asynchronous xda read ' => 'requests',
          'joins' => '       Current size (bytes)',
          'Inactive stmt history memory usage (bytes)' => 'Internal automatic ',
          'Commit statements ' => 'attempted',
          '      Storage path free space (bytes)' => '',
          ' Total private section ' => 'inserts',
          'ID' => '       Current size (bytes)',
          'Agents associated with ' => 'applications',
          '765430' => 'Log accounted for by dirty pages (Bytes)',
          'Agents currently waiting on ' => 'locks',
          'Buffer pool temporary index logical ' => 'reads',
          '6412' => 'Total ',
          '1549824' => '       High water mark (bytes)',
          '       Configured size (bytes)' => '',
          '8934507' => 'Unread prefetch ',
          '96' => 'Number partial page log ',
          '585216' => '       High water mark (bytes)',
          '486' => 'Package cache ',
          'Log to be redone for recovery (Bytes)' => '',
          'commits' => '9840',
          '05381888' => '       Current size (bytes)',
          '93216' => '       Configured size (bytes)',
          '46800640' => '       Current size (bytes)',
          'writes' => '3430',
          'Exclusive lock ' => 'escalations',
          'No victim buffers ' => 'available',
          '428' => 'Internal rows ',
          '7' => 'Number of indoubt ',
          'loops' => 'Number of hash join ',
          'mark' => '3232700',
          '52842' => 'Static statements ',
          'Maximum total log space used (Bytes)' => '',
          '72' => 'Lock list memory in use (Bytes)',
          'Buffer pool data ' => 'writes',
          'Total elapsed asynchronous read ' => 'time',
          'currently' => 'Log pages ',
          'Application ' => 'connects',
          'File number of first active ' => 'log',
          'Dirty page steal cleaner ' => 'triggers',
          'agents' => '2',
          'allocated' => '5',
          'Xquery statements ' => 'executed',
          'inserts' => ' Total shared section ',
          ' Corresponding private ' => 'overflows',
          'pages' => '147',
          'Number of hash ' => 'joins',
          '225' => 'Rows ',
          '2747' => 'Secondary connects ',
          'Buffer pool index logical ' => 'reads',
          'Dynamic statements ' => 'attempted',
          'paths' => '      File system ',
          '6388' => 'Select SQL statements ',
          'deadlock' => '7',
          '       High water mark (bytes)' => '',
          '63454720' => '       Configured size (bytes)',
          '26622020' => 'Direct ',
          'IOs' => '2821',
          'attempted' => '7',
          '0319972' => 'Secondary logs allocated ',
          'Asynchronous data read ' => 'requests',
          'executed' => '06',
          'Catalog database partition ' => 'number',
          '403328' => 'Buffer pool temporary data logical ',
          'Direct read ' => 'requests',
          'Number read log ' => 'IOs',
          '477714' => 'Asynchronous pool data page ',
          'Locks held ' => 'currently',
          '046.000000004' => 'Number write log ',
          'Application section ' => 'lookups',
          'overflows' => '5',
          '       Secondary ' => 'ID',
          '03030' => 'Buffer pool xda logical ',
          '49460' => 'DDL statements ',
          '52701' => 'Appl id holding the oldest ',
          '04' => 'Internal rollbacks due to ',
          'Log data found in ' => 'buffer',
          'read' => '561',
          '89824' => '       Configured size (bytes)',
          '732753' => 'Direct write elapsed time (ms)',
          'Package cache ' => 'inserts',
          '18401' => 'Rollback statements ',
          '928' => 'Active ',
          'Sort ' => 'overflows',
          'Appls. executing in db manager ' => 'currently',
          'Direct reads elapsed time (ms)' => '',
          '150' => 'Dirty page threshold cleaner ',
          'Post threshold hash joins (shared memory)' => 'Active hash ',
          '2347' => 'Rows ',
          '37785' => 'Catalog cache ',
          'Internal ' => 'rollbacks',
          'Number log buffer ' => 'full',
          '9402624' => '       Configured size (bytes)',
          '521984' => '       Configured size (bytes)',
          'Buffer pool data physical ' => 'reads',
          '12926464' => '       Configured size (bytes)',
          '2/23/2013 21:01:29.252390' => 'Number of automatic storage ',
          '58752' => '       High water mark (bytes)',
          '5073280' => '       High water mark (bytes)',
          '56654938' => 'Binds/precompiles ',
          'log' => '740',
          '733272267' => 'Application section ',
          'requests' => '441',
          '385867681' => 'Buffer pool index physical ',
          '73693' => ' Total private section ',
          '679989' => 'LSN Gap cleaner ',
          '4' => 'Maximum coordinating ',
          '770802' => 'Asynchronous index read ',
          'Lock ' => 'Timeouts',
          'selected' => '4445812686',
          'File number of current active ' => 'log',
          ' 
```

你看到一些数字在左边，我想要所有的数字在右边，所以我想用那个哈希执行一些算术运算......感谢帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T15:49:00.737

你的问题是你正在使用的正则表达式，以及无限分裂。由于您只寻找一个键和一个值，您应该（可能）将拆分限制为两个字段。如果您应该有一个拆分为更少或更多字段的字段，您的哈希分配将被破坏。您还应该只在分隔符上拆分，这是一个由空格包围的等号。

你的正则表达式：

```
/\s+=\s+[0-9]/ 
```

将在“空格后跟等号后跟空格后跟数字”拆分。数字将被删除。假设一行如`foo = 0`，您将得到一个结果列表`"foo", ""`。

你需要的是：

```
split /\s*=\s*/, $_, 2; 
```

这将去除等号周围的所有空格，并且最多只返回两个字段（大概是键和值）。您仍然会发现一些包含前导空格的字段，但我认为这是可以接受的。

使用`map`语句的缺点是它返回整个列表，并且正如您所见，该列表可能会损坏。更明智的方法是使用 for 循环：

```
my %hash;
for (@dblst) {
    chomp;
    my ($key, $val) = split /\s*=\s*/, $_, 2;
    $hash{$key} = $val;
} 
```

使用此代码还可以轻松插入控制语句以防止插入空白键/值、防止重复以及执行您想要的各种其他测试。

# winapi - 是否可以在原始输入中吞下一个键？

> ID：15042211
> 
> 赞同：5
> 
> 时间：2013-02-23T15:35:01.663
> 
> 标签：winapi, keyboard, raw-input

我正在使用**[原始输入 API](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645536%28v=vs.85%29.aspx)**，因为我需要能够以不同的方式响应来自不同 USB HID 设备的密钥，即使它是相同的密钥。

我的窗口`WM_INPUT`正确接收消息。我可以检索[`RAWKEYBOARD`结构](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645575%28v=vs.85%29.aspx)以获得我需要的所有信息。

现在我想阻止那些 USB 设备能够切换 NumLock。我希望原始输入 API 可以让我吞下 NumLock 按键？

我尝试将 WM_INPUT 消息的 Result 设置为 1，但这似乎没有效果。

（我是用 C# 编写的，但由于这都是低级 Windows API，你可能不需要 C# 或 .NET 知识来回答这个问题。）

编辑：哦，是的，我也尝试过使用全局键盘钩子 ( `SetWindowsHookEx`) 来吞下 NumLock 按键。不幸的是，当我初始化原始输入 API 时，在窗口处于活动状态时不再调用全局键盘挂钩。我也尝试在原始输入*之后设置全局钩子，但效果相同。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-15T12:44:00.230

原始输入 API 不支持吞咽按键。

此外，它不与`SetWindowsHookEx` *同一进程内*交互。一旦原始输入 API 被初始化，钩子就被解开。

解决方案是将它们放在*不同的进程中*。一个进程可以`SetWindowsHookEx`用来吞下不需要的键，而另一个进程使用原始输入 API 来处理确实通过的按键。然后你只需运行两者。这对我来说很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-21T12:37:15.120

如上所述，没有直接的可能性，但是您可以通过结合低级键盘挂钩来实现。

就我而言，我需要从条码扫描仪中获取代码，因此只有数字和 ENTER。

我的解决方案是 RawInput 仅从条形码扫描仪设备捕获所有键，而键盘连接仅捕获数字 0-9 和 ENTER 并且根本不返回它。然后，在代码中，我决定是否需要通过以下方式返回密钥：

```
SendKeys.SendWait("{ENTER}"); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-05-11T16:07:45.280

您只能通过编写内核键盘过滤器驱动程序来“吞下”某些按键。因此，如果您仍然在其中，您将需要一个 DDK。

# c - 无法写入共享内存段

> ID：15042212
> 
> 赞同：0
> 
> 时间：2013-02-23T15:35:09.173
> 
> 标签：c, linux

....大家好，我在运行代码时总是收到“分段错误”。我知道当写入文件出现问题时会发生此错误（我想共享内存也是如此），我知道错误来自 for 循环，我尝试了所有方法来解决此错误但失败了（我什至删除了 for 循环，只输入 *s = 'A')。请帮忙。

```
#include <stdio.h>
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/shm.h>
#include <stdlib.h>

main()
{
    //Shared memory parameters
    int shmid ;
    int shmsize = 14;
    key_t key = 2121;
    char *shm, *s;
    //Create SMS
    if ((shmid = shmget (key , shmsize, 0666 | IPC_CREAT)) == -1) { 
        perror ("Error in Creating the SMS");
        abort();
    }
    //Attatching the sms to the address space
    if (shm = shmat(shmid , NULL , 0) == (char *)-1) {    /*<<<< 23 */
        perror ("Error in attatching the SMS");
        abort();
    }
    int i ;
    s = shm;
    for(i = 0 ; i <= 63 ; i++)
        *s++ = (char)i;
        *s = NULL;    /*<<<< 33 what's the problem */
} 
```

我也在 23 和 33 收到警告

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:23:41.607

您应该听听编译器的警告（并且您应该收到第 7 行的警告，也就是上面的警告`main`- 如果您不这样做，那么您应该添加`-Wall`到编译器开关）。

所以在第 23 行它说“从整数制作指针而不进行强制转换”[1]：

```
 if (shm = shmat(shmid , NULL , 0) == (char *)-1) 
```

这是因为你的代码行没有做你认为应该做的事情。如果我们把它分成不同的行，那就更清楚了，不是吗？

```
 shm = shmat(shmid , NULL , 0) == (char *)-1;
  if (shm) 
```

因此， shm 成为“从`shmat(...) == -1`. 返回值的结果。希望为零。然后分配`s`给`shm`，这意味着`*s++`尝试写入地址为零 - 这肯定会给出段错误。

通过添加括号以首先进行分配来解决此问题，然后进行比较（如`shmid = shmget`上面的几行） - 或者像这样拆分它（我的首选解决方案）：

```
 shm = shmat(shmid , NULL , 0);
  if (shm == (char *)-1) 
```

这一行：

```
 *s = NULL;  //what's the problem 
```

是错误的，因为您试图将 NULL （即`(void *)0`，因此是指针）分配给一个`char`值。通过以下两行之一更正此问题：

```
*s = '\0';
*s = 0; 
```

根据下面的评论：您还应该注意调整共享内存的大小以覆盖您要存储的内容。目前您要求 14 字节，然后写入 64。这不会失败，但这只是因为大小被四舍五入到 4096 字节 - 重要的是不要对操作系统“撒谎”你要求的内容 - 甚至如果你有时能侥幸逃脱...

[1] 如果您发布实际的警告消息总是有帮助的，这样我就不必编译代码来查找警告......

# c# - 如何在查询中使用组合框的值

> ID：15042214
> 
> 赞同：1
> 
> 时间：2013-02-23T15:35:14.630
> 
> 标签：c#, combobox, selecteditem, selectedvalue

我使用填充了表格名称的组合框。当我发出插入命令并通过获取组合框的值来确定表名时，它不起作用

```
 private void Form2_Load(object sender, EventArgs e)
    {
        Conn.Open();
            foreach (DataRow dr in dt.Rows)
            {
                comboBox1.Items.Add(dr["TABLE_NAME"].ToString());
            }
        Conn.Close();  

    }

//cmd = new SqlCommand("insert into dbo."+ comboBox1.SelectedItems.ToString()     +"(Phone, Email, Address) values('" + txt1.Text + "','" + txt2.Text + "','" + txt3.Text + "')", Conn); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:43:16.893

[组合框文章](http://www.c-sharpcorner.com/uploadfile/mahesh/combobox-in-C-Sharp/)

您可以在那里找到一个非常好的资源，用于组合框的所有内容。您可以使用 datasource 属性并让知道值并显示您需要的内容。

```
comboBox1.datasource = datatable;
comboBox1.displayname = "ColumnNameForDisplayName";
comboBox1.valuename = "ColumnsNameForValueName"; 
```

# c - 我假设下面的 C 代码做了一些事情。但它不是我的假设。请检查我的假设有什么问题？

> ID：15042215
> 
> 赞同：-4
> 
> 时间：2013-02-23T15:35:19.303
> 
> 标签：c

代码是：

```
#include<stdio.h>
main()
{
   char arr[]={'a','b','c','d'};
   char *i,*j,*k;
   i=&arr[1];
   j=&arr[2];
   k=&arr[3];
   printf("%s %p %p %p %s\n",(j-i)'i,j,k,(k-i));
} 
```

1.  当我尝试编译此错误时，显示的错误是 %s 期望 (char *) 但它是 (即 (ji)) 是 int。但我认为我将 j&i 定义为 char 指针，那么 (ji) 如何成为整数。

2.  如果我使用 %d 而不是 %s，则 (ji) 的答案为 1，而 (ki) 的答案为 2，这实际上是元素差异。这是如何发生的。

3.  当我使用 %p 打印上面的 i,j,k 的地址时，它会执行正确的地址，但是为什么不能减去 2 个地址以给出它们的字节差异呢？

请给出你的观点？

编辑：为关于指针差异的问题的第二部分添加代码：

```
#include<stdio.h> 

main() 
{ 
    int arr[]={10,20,34,65}; 
    int *i,*j,*k; 
    i=&arr[1]; 
    j=&arr[2]; 
    k=&arr[3]; 
    printf("%d %p %p %p %d\n",(j-i),i,j,k,(k-i)); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:49:36.097

由于没有人费心写实际答案：

1.  从另一个中减去指针会给出指针的差异，如整数。

2.  指针值的差异在于指向*类型的大小*（当您想到做什么时，这一点很明显`intptr++`）。

3.  要获得字节差异，请乘以类型的大小，例如`(sizeof int)*(j-i)`

# asp.net-mvc-4 - 无法使用 ASP.NET 热毛巾水疗模板的 ace 编辑器工作

> ID：15042217
> 
> 赞同：0
> 
> 时间：2013-02-23T15:35:25.423
> 
> 标签：asp.net-mvc-4, ace-editor, hottowel

我是 web 开发的新手，所以请怜悯 :) 我已经使用热毛巾模板 ( [http://nuget.org/packages/HotTowel/](http://nuget.org/packages/HotTowel/) ) 创建了一个新的 ASP.NET 项目并添加了

```
<script src="http://d1n0x3qji82z53.cloudfront.net/src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script> 
```

到 index.cshtml。另外，我将 home.html 修改为如下所示：

```
<section>
    <div id="editor">
        function foo(items) {
            var x = "All this is syntax highlighted";
            return x;
        }
    </div>
</section> 
```

最后，我更改了 home.js：

```
define(['services/logger'], function (logger) {
    var vm = {
        activate: activate,
        title: 'Home View'
    };

    var editor = ace.edit("editor");
    editor.setTheme("ace/theme/monokai");
    editor.getSession().setMode("ace/mode/javascript");

    return vm;

    //#region Internal Methods
    function activate() {
        logger.log('Home View Activated', null, 'home', true);
        return true;
    }
    //#endregion
}); 
```

当我运行应用程序时，Chrome 告诉我 ace.js 有一个 Uncaught TypeError: Cannot read property 'env' of null。当然，主屏幕不会出现。我应该怎么做才能让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T20:25:45.223

看起来像在创建`var editor = ace.edit("editor");`之前运行的行`<div id="editor">`，请确保 home.js 脚本包含在之后`<div id="editor">`或在 document.onload 事件之后被激活

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T08:51:16.820

@Papa Mufflon 我不允许发表评论，所以我会把它作为答案。HotTowel 使用了 Durandal，它会`activate`在页面变为活动状态时调用该函数（activate 由 vm 公开）。

您可以将激活用作“页面加载事件”。只需将`return true;`activate 函数中的语句更改为 a 即可`return yourDefinedStartupMethod();`。你可以看看`boot()`shell.js中的函数用法

这里有更详细的行为描述[http://oscarmeszar.com/hottowel-with-breeze-example/](http://oscarmeszar.com/hottowel-with-breeze-example/)。

# java - Java：如何在程序中使用键盘

> ID：15042218
> 
> 赞同：0
> 
> 时间：2013-02-23T15:35:32.790
> 
> 标签：java, keyboard, key

我知道有很多来源，但我找不到任何对我有用的东西。所以，-我正在创建小程序/游戏。有对话询问有关字符的内容，例如姓名等（我为此使用了扫描仪），但现在我需要制作以便有可选择的选项，例如您出生的地方：A.Something1 B.Something2 C.Something3。因此，当您在键盘上按例如 B 时，您将选择“Something2”。它有点混乱的问题，但请回答我，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:41:34.123

您需要使用密钥侦听器。

从键盘获取键码并相应地执行操作：

这是教程：[http ://docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html](http://docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html)

暗示 ：

```
 public void keyTyped(KeyEvent e) {
        char keyPress=e.getKeyChar();
        if keyPress=='a' or 'A' 
            select option 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T15:45:00.183

如果您正在编写游戏，我猜您将使用 Swing 或 AWT 来显示您的东西。

如果是这种情况，那么您必须侦听关键事件。有两种方法：

### 使用 KeyListener

您将侦听器注册到您的组件。请参阅[Oracle 的教程](http://docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html)。

这里的问题是您可能有多个组件，并且将侦听器附加到所有组件是不切实际的。另一方面，如果你只有一个大画布，那么就没有麻烦了。

### 使用键盘焦点管理器

您可以通过向 KeyboardFocusManager 添加自定义 KeyEventDispatcher 来监听应用程序中的所有键事件：

```
KeyboardFocusManager.getCurrentKeyboardFocusManager()
  .addKeyEventDispatcher(new KeyEventDispatcher() {
      @Override
      public boolean dispatchKeyEvent(KeyEvent e) {
        // your stuff
        return false;
      }
}); 
```

# php - 是否有使用生成器作为迭代器的接口？

> ID：15042220
> 
> 赞同：3
> 
> 时间：2013-02-23T15:35:35.293
> 
> 标签：php, class, iterator, generator

我想创建一个目录类，并希望它用作迭代器（foreach-able）。但我希望它是基于生成器的（例如一个执行“yield”的函数）。是否可以？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T15:46:33.620

类没有明确的接口来实现生成器，但您可以在`IteratorAggregate`此处使用。

`IteratorAggregate`请参阅从[生成器 RFC](https://wiki.php.net/rfc/generators)实现的这个示例

```
class Test implements IteratorAggregate {
    protected $data;

    public function __construct(array $data) {
        $this->data = $data;
    }

    public function getIterator() {
        foreach ($this->data as $key => $value) {
            yield $key => $value;
        }
        // or whatever other traversation logic the class has
    }
}

$test = new Test(['foo' => 'bar', 'bar' => 'foo']);
foreach ($test as $k => $v) {
    echo $k, ' => ', $v, "\n";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:50:42.947

生成器**是**迭代器。

来自[http://www.php.net/manual/en/language.generators.object.php](http://www.php.net/manual/en/language.generators.object.php)

> 当第一次调用生成器函数时，会返回一个内部生成器类的对象。该对象以与只进迭代器对象相同的方式实现 Iterator 接口。

# python - 如何禁用 Tkinter 列表框的鼠标控制？

> ID：15042221
> 
> 赞同：3
> 
> 时间：2013-02-23T15:35:42.037
> 
> 标签：python, tkinter

我想知道是否可以在 Tkinter 中禁用对列表框的鼠标控制。我只想要箭头键导航。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:44:32.633

如果您创建一个到事件的绑定，并且在该绑定中您这样做`return "break"`，您将阻止执行默认行为。因此，您只需要为您不希望用户能够使用的事件创建自己的绑定。

例如：

```
...
    my_listbox.bind("<1>", self.no_op)
    my_listbox.bind("<Double-1>", self.no_op)
...
def no_op(self, event):
    return "break" 
```

您可能需要禁用其他一些绑定，但这可能会让您完成 95% 的工作。

# django - 将当前用户名添加到 Django 模型中的“用户”字段

> ID：15042222
> 
> 赞同：1
> 
> 时间：2013-02-23T15:35:43.913
> 
> 标签：django, model

我正在使用一个遗留数据库，其中所有表中都有“adduid”和“moduid”字段。这些字段是 varchar(64)。

这些在保存和修改时用*实际*的用户 ID 标记记录。当然，当使用 django 时，这些字段由 django db 用户填充。

我想要的是一种用登录用户填充这些字段的方法；最好在模型定义中。

我该怎么办？（我见过的大多数解决方案都依赖于对 User 表使用外键；但是我们需要该字段中用户名的实际文本 - 而不是 fk）。

在此先感谢 - 帕特里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:01:20.310

我认为您不能在模型级别执行此操作，因为用户无法访问模型的保存方法。无需用户参与即可保存模型（例如，通过 celery 等任务管理应用程序）。但是，用户在`HttpRequest`传递给视图的对象上可用，因此您可以在视图中执行此操作。

```
def your_view(request):
    # get your object
    obj.modified = request.user.username
    obj.save() 
```

django 上还有一个可以覆盖的[save_model](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.save_model)函数。`ModelAdmin`就像是 -

```
def save_model(self, request, obj, form, change):
    obj.modified = request.user.username
    obj.save() 
```

# javascript - Django同时将视图中的var传递给两个模板

> ID：15042226
> 
> 赞同：1
> 
> 时间：2013-02-23T15:36:03.393
> 
> 标签：javascript, django, django-templates, django-views

我想同时将视图中的 var 传递给模板和 javascript 库（javascript.js）。可能吗？

视图.py：

```
def setAppOptions(request, map_name):
    if request.user.is_authenticated():
        app_selected = EzApp.objects.get(app_name=app_name, created_by=request.user)
        formset = ezAppOptionFormSet(user=request.user, instance=app_selected)
        if request.method == 'POST':
            formset = ezAppOptionFormSet(request.POST, instance=app_selected, user=request.user)
            if formset.is_valid():
                formset.save()

        return render_to_response("manage_app_options.html", {'formset': formset}, context_instance=RequestContext(request)) 
    else:
        error_msg = u"You are not logged in"
        return HttpResponseServerError(error_msg) 
```

模板：

```
{% extends "basemap.html" %}
{% block library %}
#I want to pass var to this library and to this template in the same time...
<script type="text/javascript" src="/static/javascript.js"></script>
{% endblock %}
{% block content %}
<table border="1">
<tr>
<td>
    <h1>Define App options</h1>
    {% if formset.errors %}
        <p style="color: red;">
            Please correct the error{{ formset.errors|pluralize }} below.
        </p>
    {% endif %}
    <form method="post" action="" encrypt="multipart/form-data">{% csrf_token %}
            {{ formset.as_p }} 
        <input type="submit" value="Submit" onclick="initialize()">
    </form>
</td>
</tr>
</table>
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:18:38.910

假设您只想保留 javascript 文件 js，实现此目的的一种方法是让您的 js`initialize`接受一些配置数据。在您的 html 模板中（由 django 呈现，因此可以访问您传递数据的上下文变量

javascript.js

```
...
function initialize(options) {
... 
```

模板.html

```
<input type="submit" value="Submit" onclick="initialize({
    myvar: {{ value_from_django }},
    other_stuff: 10
})"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T08:31:36.630

您不需要将变量“传递”到库。

只需将其设置在脚本标记中，如下所示：

```
{% block library %}
<script type="text/javascript">
    var foo = "{{ variable }}";
</script>
<script type="text/javascript" src="/static/javascript.js"></script>
{% endblock %} 
```

然后，您可以在 JS 中将其引用为`VARIABLE`或`window.foo`。

# eclipse - 加载描述符时 Ubuntu 上 Eclipse Juno 中的 org.eclipse.emf.ecore.xmi.FeatureNotFoundException

> ID：15042232
> 
> 赞同：0
> 
> 时间：2013-02-23T15:36:14.683
> 
> 标签：eclipse, maven-plugin, ubuntu-12.04, eclipse-juno

我有一个 GWT+GAE 项目，它也在使用 Spring Security。在我将其迁移到 Maven 之前，该项目运行良好。现在，在它被转换为 maven 项目之后，每次我尝试构建项目时，eclipse 都会给出以下错误。

> 在“加载 MyProj 的描述符”期间发生内部错误。org.eclipse.emf.ecore.xmi.FeatureNotFoundException：未找到功能“系统属性”。（平台：/resource/MyProj/src/main/webapp/WEB-INF/web.xml, 65, 22）

Eclipse 版本：Juno Service Release 1 操作系统：Ubuntu 12.04 插件：m2e maven 插件。

我尝试禁用验证，但错误仍然存​​在。我还尝试按照错误建议在 web.xml 中添加 system-properties 标记，但这也无济于事。

有趣的是，我能够运行该项目，但是每次构建时出现的这个错误都非常烦人。

任何帮助将不胜感激。谢谢。

![Juno 中的 FeatureNotFoundException](../Images/1590ea86ba41a77b9c3a285c415fb7c8.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T17:31:48.990

我已经弄清楚了错误。这是因为它是为 web.xml 中的 log 属性定义的，理想情况下应该在 appengine-web.xml 中。删除该属性标签后，错误消失了。

# tomcat - Tomcat 7 Manager - 如何进行身份验证？

> ID：15042235
> 
> 赞同：18
> 
> 时间：2013-02-23T15:36:36.877
> 
> 标签：tomcat, tomcat7

我正在尝试登录 tomcat manager 应用程序，但无法在 tomcat-users.xml 中成功创建登录用户。最初的内容是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--><tomcat-users>
<!--
  NOTE:  By default, no user is included in the "manager-gui" role required
  to operate the "/manager/html" web application.  If you wish to use this app,
  you must define such a user - the username and password are arbitrary.
-->
<!--
  NOTE:  The sample user and role entries below are wrapped in a comment
  and thus are ignored when reading this file. Do not forget to remove
  <!.. ..> that surrounds them.
-->
<!--
  <role rolename="tomcat"/>
  <role rolename="role1"/>
  <user username="tomcat" password="tomcat" roles="tomcat"/>
  <user username="both" password="tomcat" roles="tomcat,role1"/>
  <user username="role1" password="tomcat" roles="role1"/>
-->
</tomcat-users> 
```

[在官方页面上](http://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html)阅读我这样修改了文件，但没有结果。

```
<?xml version="1.0" encoding="utf-8"?>
<tomcat-users>
  <role rolename="manager-gui"/>
  <role rolename="manager-status"/>
  <role rolename="manager-script"/>
  <role rolename="manager-jmx"/>
  <user username="admin" password="admin" roles="manager-gui"/>
</tomcat-users> 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-23T18:03:08.433

看来这是正确的配置。注意不要用空格分隔角色！

```
<?xml version="1.0" encoding="UTF-8"?>
<tomcat-users>  
  <role rolename="manager-gui"/>
  <role rolename="manager-script"/>
  <role rolename="manager-jmx"/>
  <role rolename="manager-status"/>
  <role rolename="admin-gui"/>
  <role rolename="admin-script"/>
  <user username="admin" password="admin" roles="manager-gui,manager-script,manager-jmx,manager-status,admin-gui,admin-script"/>
</tomcat-users> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-06-09T10:52:04.363

接受的答案在一个细节上是错误的，但非常重要 - 管理员角色之间不应有任何空格，因为此列表应以逗号分隔（如此处指出的[Tomcat 7 Manager can't login](https://stackoverflow.com/questions/18746195/tomcat-7-manager-cant-login)）。我只是遇到了同样的问题并以同样的方式解决了它。

所以，而不是这个（如一些答案中所建议的：

```
<user username="admin" password="admin" roles="manager-gui, manager-script, manager-jmx, manager-status, admin-gui, admin-script"/> 
```

它必须是这样的：

```
 <user username="admin" password="admin" roles="manager-gui,manager-script,manager-jmx,manager-status,admin-gui,admin-script"/> 
```

所以总的来说它应该是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<tomcat-users>
  <role rolename="manager-gui"/>
  <role rolename="manager-script"/>
  <role rolename="manager-jmx"/>
  <role rolename="manager-status"/>
  <role rolename="admin-gui"/>
  <role rolename="admin-script"/>
  <user username="admin" password="admin" roles="manager-gui,manager-script,manager-jmx,manager-status,admin-gui,admin-script"/>
</tomcat-users> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-07-31T14:10:38.523

您不应将 manager-gui 角色与 manager-script 或 -jmx 角色结合使用，因为这会损害跨站点脚本保护。最后的经理角色不能像 gui 角色那样受到保护。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-18T18:43:11.843

您是否在 conf 文件夹的 server.xml 中配置了数据库领域？默认 server.xml 已经设置了 UserDatabase 资源，因此如果您更改了该资源，那么无论您如何设置 tomcat-user xml，您都将无法进行身份验证。

在 conf/server.xml 文件中... 在 GlobalNamingResource 标记中定义一个 Resource 以使用 MemoryUserDatabaseFactory 并在您的 Engine 中定义一个 Realm 以使用 UserDatabaseRealm。只需打开原始 server.xml（我使用的是 tomcat 7.0.62）并搜索这些名称，您就会看到配置。根据您的应用和需求，您可能需要进行其他更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-09T05:34:22.463

您已添加管理员角色用户以访问此功能。对于这个编辑`tomcat-users.xml`文件， `apache-tomcat-7.0.56-windows-x64\apache-tomcat-7.0.56\conf`如果你在 Windows 上。搜索`<role rolename= >`线。这可能会被评论。添加此代码：-

```
<role rolename="manager-gui"/>
<user username="your-user-name" password="your-password" roles="manager-gui,manager-script"/> 
```

# java - 检查异常和初始化程序块

> ID：15042236
> 
> 赞同：7
> 
> 时间：2013-02-23T15:36:37.367
> 
> 标签：java

根据 JLS：如果命名类的实例变量初始化程序或实例初始化程序可以抛出已检查的异常类，则这是编译时错误，除非该异常类或其超类之一在每个构造函数的 throws 子句中显式声明它的类并且该类至少有一个显式声明的构造函数。

所以如果我这样做 -

```
class A{
 {
  throw new FileNotFoundException();
 }
public A() throws IOException{
    // TODO Auto-generated constructor stub
}
} 
```

这给出了编译时错误“初始化程序必须正常完成”

尽管

```
class A{
 {
  File f=new File("a");
  FileOutputStream fo=new FileOutputStream(f);
  fo.write(3);
 }
public A() throws IOException{
    // TODO Auto-generated constructor stub
}
} 
```

此代码不显示任何编译时错误。为什么即使我在构造函数中声明了 throws 子句，前面的代码也无法编译？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T15:38:26.553

初始化程序实际上可以毫无例外地完成时应该有一些条件。

在你的情况下，它不可能发生。

尝试：

```
if(/*condition-to-fail*/) {
    /*Not always, only when something is wrong. Compiler knows that.*/
    throw new FileNotFoundException(); 
} 
```

* * *

**更新：**

下面的语句实际上是在抛出异常。

```
throw new FileNotFoundException(); 
```

因此，没有任何条件，您的程序执行总是在那里结束。

虽然在以下 -

```
FileOutputStream fo = new FileOutputStream(f); 
```

构造函数`FileOutputStream(File)`并不总是抛出该异常。

中的 throws 子句`public FileOutputStream(File file) throws FileNotFoundException`只是说它可能会抛出该异常，并且只有在运行时找不到文件时才会这样做，否则不会。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T16:16:00.273

[http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.6](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.6)

> 如果实例初始化程序无法正常完成，则为编译时错误

[http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.21](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.21)

> 一个不是 switch 块的非空块可以正常完成，前提是它的最后一条语句可以正常完成。
> 
> ...
> 
> if 语句，无论它是否具有 else 部分，都以不寻常的方式处理。因此，在本节末尾单独讨论。
> 
> ...
> 
> 为了让 if 语句方便地用于“条件编译”目的，实际规则有所不同。
> 
> ...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T16:20:16.403

在第一种情况下，编译器已经知道实例初始化程序永远不会正常完成，因为您已经明确地抛出`FileNotFoundException`了那里。你可以说它是编译器的智能代码评估。但是，如果您让编译器相信实例初始化程序有一点点成功完成的机会，那么编译器就不会在编译时抱怨。例如，在下面给出的代码中，虽然文件`IDonotexist.txt`在我的目录中不存在，我确信它会抛出`FileNotFoundException`，但编译器仍然会让它编译成功。**为什么？**因为文件的存在是在代码执行期间检查的，而不是在编译时检查的。

```
class A
{
    {
        FileReader fr = new FileReader(new File("IDonotexist.txt"));
    }
    public A() throws IOException
    {
        // TODO Auto-generated constructor stub
    }
    public static void main(String st[])throws Exception
    {
        A a = new A();
    }
} 
```

这类似于最终变量初始化的情况。例如以下代码中的示例，编译器将显示编译时错误

```
public void calling()
    {
        final int i;
        int k = 90;
        if ( k == 90)
        {
            i = 56;
        }
        System.out.println(i);//Compiler will show error here as: variable i might not have been initialized
    } 
```

但是，如果我将条件替换为`if ( k == 90)`then`if(true)`编译器将不会显示错误。因为编译器现在知道`i`肯定会被赋予一些价值。

# android - Android 中的 ListAdapter 过滤器

> ID：15042237
> 
> 赞同：0
> 
> 时间：2013-02-23T15:36:50.240
> 
> 标签：android, filter, android-listview, listadapter, textwatcher

我的应用程序中的 listview 过滤器有问题。在 KartyListFragment.java 我声明：

```
ListAdapter adapter = new SimpleCursorAdapter(ctx,
    R.layout.karty_list_item, db.getKarty(), from, to, 0); 
```

现在在 OnCreate 方法的 StartActivity.java 中，我有 EditText 和 TextWatcher。

```
EditText searchInput = (EditText) findViewById(R.id.search_edit_text);

    watcher = new TextWatcher() {

        @Override
        public void onTextChanged(CharSequence s, int start, int before, int count) {
            KartyListFragment.this.adapter.getFilter().filter(s); //THIS ROW IS WRONG
            //it doesn't know getFilter() 

        }

        @Override
        public void beforeTextChanged(CharSequence s, int start, int count,
                int after) { }

        @Override
        public void afterTextChanged(Editable s) { }
    };

    searchInput.addTextChangedListener(watcher); 
```

在 OnTextChanged 方法中，我需要调用适配器的 getFilter() 方法，但它写入错误。我读了一些教程。有使用的 ArrayAdapters，我正在使用 List (Cursor)。你有什么主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-03T08:54:40.727

更改`ListAdapter`为`SimpleAdapter`

这些对我有用:)`SimpleAdapter`有`getFilter`方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:43:55.050

将您的适配器`ListAdapter`从`CursorAdapter`. A`ListAdapter`没有实现“getFilter”方法。顺便说一句，您需要实现一个[QueryFilterProvider](http://developer.android.com/reference/android/widget/FilterQueryProvider.html)来在后台运行您的查询并对列表进行实际过滤。

# php - 使用字符串作为键访问数组中的数组

> ID：15042238
> 
> 赞同：0
> 
> 时间：2013-02-23T15:36:54.547
> 
> 标签：php, arrays, associative-array

我目前正在尝试在 PHP 中构建一个验证类。我试图做的是匹配数组所需的验证`$_POST`数组。我的验证数组给出了以下值，它们是字段名称

```
$validation[0] = “order[0][company]”
$validation[1] = “order[1][company]”
$validation[2] = “order[2][company]” 
```

等等。`$_POST`数组看起来像这样

```
Array ( [order] => Array ( [0] => Array ( [company] => [link] => [username] => [password] => [comments] => ) [1] => Array ( [公司] => [链接] => [用户名] => [密码] => [评论] => )
```

如何使用上面给出的字段名称访问 post 数组中的值？我试过`$_POST[$validation[0]]`了，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:40:23.433

$_POST[$validation[0]]，使用一对括号而不是括号，因为您可以访问任何其他数组。

# c# - 使用自定义工厂通过 Automapper 创建目标类型

> ID：15042240
> 
> 赞同：1
> 
> 时间：2013-02-23T15:36:57.890
> 
> 标签：c#, automapper

我有`CustomerDto`和`CustomerDomainModel`。我希望 Automapper在构造对象时使用`DataBindingFactory` [这里提到的。](http://ayende.com/blog/4106/nhibernate-inotifypropertychanged)`CustomerDomainModel`我在课堂上看过`ConstructUsing`和`AfterMap`函数，`Mapper`但我找不到完成我想做的事情的方法。我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:07:42.800

您应该可以使用`ConstructUsing`它。不过，您可能必须像这样显式转换为正确的表达式：

```
class Program
    {
        private static void Main(string[] args)
        {
            Mapper.CreateMap<CustomerDto, CustomerDomainModel>()
                    .ForMember(d => d.Id, opt => opt.Ignore())
                      .ConstructUsing((Func<ResolutionContext, CustomerDomainModel>) (rc => DataBindingFactory.Create<CustomerDomainModel>()));

            var dto = new CustomerDto {FirstName = "First", LastName = "Last"};
            var domain = Mapper.Map<CustomerDto, CustomerDomainModel>(dto);
            Console.WriteLine("First: " + domain.FirstName);
            Console.WriteLine("Last: " + domain.LastName);
            Console.ReadLine();
        }
    }

    public class CustomerDto
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
    }

    public class CustomerDomainModel
    {
        public int Id { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
    }

    public static class DataBindingFactory
    {
        public static T Create<T>()
        {
            return Activator.CreateInstance<T>();
        }
    } 
```

# java - 如何在java中隐式或自动转换

> ID：15042243
> 
> 赞同：0
> 
> 时间：2013-02-23T15:37:15.670
> 
> 标签：java, casting

我在“自动”转换属性时遇到了一些麻烦。

```
public abstract class MyType<T> {
    public abstract T getValue(String content);
}

public class MyString extends MyType<String> {
    @Override
    public String getValue(String content) {
        return String.valueOf(content);
    }
}

public class MyInteger extends MyType<Integer> {
    @Override
    public Integer getValue(String content) {
        return Integer.valueOf(content);
    }
}

public class User {
    private String _name;
    private int _id;

    public void setName(String name) {
        _name = name;
    }

    public String getName() {
        return _name;
    }

    public void setId(int id) {
        _id = id;
    }

    public int getId() {
        return _id;
    }
}

public class MainTest {
    public static void main(String[] args) {
        ArrayList<MyType> myTypes = new ArrayList<MyType>();
        myTypes.add(new MyString());
        myTypes.add(new MyInteger());

        User user = new User();

        for (MyType myType : myTypes) {
            try {
                user.setName((String) myType.getValue("foobar")); // getValue always returns an Object that I have to parse
                user.setId((Integer) myType.getValue("42")); // getValue always returns an Object that I have to parse
            } catch (Exception e) {
            }
        }
    }
} 
```

请记住，这只是我的问题的一个抽象示例。

如何更换铸件？我需要这样的东西：

```
user.setName((user.getName().getClass()) myType.getValue("foobar")); 
```

不幸的是，eclipse告诉我这是错误的`The method getValue(String) is undefined for the type Class<capture#3-of ? extends String>`

我不会明确地投射。我会更加隐式/自动地投射。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T15:43:59.047

问题在于`myTypes`列表被声明为 a `List<MyType>`，它使用[原始类型](https://stackoverflow.com/q/2770321/139010) `MyType`而不是列表中的特定参数化`MyType`。[通常不鼓励这样做，警告不要这样做，不好的做法等。](http://docs.oracle.com/javase/tutorial/java/generics/rawTypes.html)

通常你会像`List<MyType<String>>`or一样声明这个列表`List<MyType<Integer>>`。这将使您能够在无需强制转换的情况下取出元素。但是，这是有问题的，因为您希望能够混合`MyType<String>`并`MyType<Integer>`在*同一个*列表中。同样，这通常是不推荐的，而且是[代码异味](https://stackoverflow.com/q/2279121/139010)。

所以你*可以*声明 a `List<MyType<?>>`，它比 好`List<MyType>`，但不是很多。唯一正确的结论是设计本身就有缺陷：不要尝试在集合中混合异构类型。*

* * *

> MyType 类只是一个抽象示例。实际上我的问题是我如何转换：`user.setName((user.getName().getClass()) object);`if object is Object object = "foobar";

无论如何，问题基本上仍然是您在列表中使用原始类型。似乎您最好使用维护类型参数化的东西，例如 a`Map<Class<T>, MyType<T>>`而不是 a `List<MyType>`。

考虑[在此处应用策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)。

* * *

[*专家模式：除非有一个合理的通用超类型可以用作上限。]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T15:52:13.513

我 100% 同意[Matt Ball 的回答](https://stackoverflow.com/a/15042302/839646)。一个简单、快速的解决方案（虽然可能不是理想的解决方案）是从 MyType 中删除抽象性并添加将值作为特定类型获取的能力。[您会在标准库的ResultSet](http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSet.html)以及其他地方找到这种模式：

```
public class MyType {
    private String content;
    MyType(String content) { this.content = content }
    public String getStringValue() { return content; }
    public Integer getIntValue() { return Integer.parseInt(content); }
} 
```

# javascript - 在 Node.JS 中读取 AJAX 发布变量（使用 Express）

> ID：15042245
> 
> 赞同：13
> 
> 时间：2013-02-23T15:37:50.513
> 
> 标签：javascript, jquery, ajax, node.js, express

我试图在我的节点应用程序中获取我为 ajax 帖子发送的值。使用[这篇文章](https://stackoverflow.com/questions/6289276/nodejs-express-ajax-posting-w-jquery-and-recieving-response)作为指导，我到目前为止有这个：

在节点中：

```
 var express = require('express');
 var app = express();

 var db = require('./db');

 app.get('/sender', function(req, res) {
    res.sendfile('public/send.html');
 });

 app.post('/send_save', function(req, res) {
  console.log(req.body.id)
  console.log(req.body.title);
  console.log(req.body.content);
  res.contentType('json');
  res.send({ some: JSON.stringify({response:'json'}) });
});

app.listen(3000); 
```

在 AJAX 方面：

```
$('#submit').click(function() {
            alert('clicked')
            console.log($('#guid').val())
            console.log($('#page_title').val())
            console.log($('#page-content').val())
            $.ajax({
                url: "/send_save",
                type: "POST",
                dataType: "json",
                data: {
                    id: $('#guid').val(),
                    title: $('#page_title').val(),
                    content: $('#page-content').val()
                },
                contentType: "application/json",
                cache: false,
                timeout: 5000,
                complete: function() {
                  //called when complete
                  console.log('process complete');
                },

                success: function(data) {
                  console.log(data);
                  console.log('process sucess');
               },

                error: function() {
                  console.log('process error');
                },
              });
        }) 
```

这个问题是我不能 req.body.id （以及任何其他值，如标题或内容），我在节点中收到此错误：

```
 TypeError: Cannot read property 'id' of undefined 
```

如果我评论这些调用，则 ajax 是成功的。我搞不清楚了。我是不是忘记了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T15:42:47.713

您在那里拥有的`req`对象没有`body`属性。看看[http://expressjs.com/api.html#req.body](http://expressjs.com/api.html#req.body)：

> 此属性是一个包含已解析请求正文的对象。此功能由 bodyParser() 中间件提供，尽管其他正文解析中间件也可能遵循此约定。当使用 bodyParser() 时，此属性默认为 {}。

因此，您需要像这样将 bodyParser 中间件添加到您的 express webapp 中：

```
var app = express();
app.use(express.bodyParser()); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-07-27T15:45:26.087

按照thejh的建议，通过包含bodyParser中间件确实解决了这个问题。

只需确保访问该答案中提供的 url 以访问 Express 更新规范：[http ://expressjs.com/api.html#req.body](http://expressjs.com/api.html#req.body)

文档提供了这个例子（Express 4.x）：

```
var app = require('express')();
var bodyParser = require('body-parser');
var multer = require('multer'); 

app.use(bodyParser.json()); // for parsing application/json
app.use(bodyParser.urlencoded({ extended: true })); // for parsing application/x-www-form-urlencoded
app.use(multer()); // for parsing multipart/form-data

app.post('/', function (req, res) {
  console.log(req.body);
  res.json(req.body);
}) 
```

为此，需要单独安装 body-parser 模块：

[https://www.npmjs.com/package/body-parser](https://www.npmjs.com/package/body-parser)

# c++ - 找到它做什么的算法

> ID：15042246
> 
> 赞同：-8
> 
> 时间：2013-02-23T15:37:51.307
> 
> 标签：c++

我有一个算法，我不知道它是做什么的，它的复杂性是什么，有人可以帮助我吗？

```
PUZZLE (A:int[], L:int, R:int)
{

// Assume L, R >0 and L <= R

If( L = R) Then

  return A[L];

double Temp1 :=PUZZLE(A,L, (L+R)/2);

double Temp2 :=PUZZLE(A, 1 + (L+R)/2,R);

If(Temp1 < Temp2) Then

return Temp1;

else Then

return Temp2;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:47:25.783

计算给定间隔内给定数组的最小值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:19:27.910

此代码计算序列 A 的子序列中存在的最小值。子序列从索引 i 开始，到索引 j 结束。您的算法可以用英文翻译为：

```
puzzle(A, i, j) :
  if the subsequence has only one element :
    return this element
  min-left is the minimum value present at the first half of the subsequence(it's computed recursively)
  min-right is the minimum value present at the second half of the subsequence(it's computed recursively)
  return the minimum of min-left, min-right 
```

这个算法的复杂度显然是线性的(O(N))。但是，如果你不相信我，我会用主定理（[http://en.wikipedia.org/wiki/Master_theorem](http://en.wikipedia.org/wiki/Master_theorem)）为你证明。

让 T(N) 成为您的算法的递归。然后：

```
T(N) = 2T(N/2) =>
T(N) = 2T(N/2) + Theta(1) =>
T(N) = Theta(N) (from the first case of the master theorem, which states
that if f(N) = O(N^logb a-e), for e>0, then the complexity is Theta(N^logb a),
where a=2, b=2, f(N)=Theta(1), and e=1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T15:48:34.977

对我来说，它似乎是前馈[神经网络](http://en.wikipedia.org/wiki/Artificial_neural_network)的一部分。查看其 wiki 以获取更多信息

# html - 在 Orchard 中应用自定义内容（jQuery 滑块）

> ID：15042248
> 
> 赞同：0
> 
> 时间：2013-02-23T15:38:17.097
> 
> 标签：html, css, orchardcms

我想在我的起始页上应用一个滑块（nivo 滑块）。

滑块 HTML：

```
<div class="slider-wrapper theme-default">
    <div class="ribbon"></div>
    <div id="slider" class="nivoSlider">
        <img src="Images/Demo/walle.jpg" alt="" />
        <img src="Images/Demo/nemo.jpg" alt="" />
        <img src="Images/Demo/story.jpg" alt="" />
    </div>
</div> 
```

目前我可以直接编辑起始页上的内容（启用适当的模块，如小部件内容）。

可以在此处插入 HTML，但是所有这些 HTML 到底去哪里了？当我尝试查找我添加的 html 时，搜索返回 0 个结果。

*   所有的 HTML 到底去哪里了？感觉自己什么都控制不了。
*   我在哪里放置`Style.Include("slider.css");`？我不想将它放在 Layout.cshmtl 上。
*   包含和放置自定义 javascript 文件的正确位置是什么？

我想在我的网站上的每个页面`.cshtml`的`Views`文件夹中都有一个页面（就像一个 MVC4 项目，所以我有一个清晰的概述）。

在开始页面上更新一些文本以进行测试时，我尝试了“在文件中搜索”，但找不到任何东西。

我是否必须在我的自定义主题中创建/复制一个视图，以便我可以准确地看到 HTML 的位置（如果是，是哪一个，以及这对新页面有何作用）？

**Orchard 版本：**源版本 1.6 (Visual Studio)

谢谢。

# php - PHP：来自自定义类的矩阵

> ID：15042254
> 
> 赞同：0
> 
> 时间：2013-02-23T15:38:43.730
> 
> 标签：php, arrays, class, default

我已经创建了一个瓷砖矩阵。我添加了一个名为 Tiles 的新类，它具有一些成员属性，如 x、y、pos 等。

我有一个函数初始化这个数组并用它返回，但是我得到了错误：

```
$matrix = array ( array ( new Tile)); 
```

比函数获取 this`$matrix`作为参数，并执行以下操作：

```
$matrix[$i][$j]->x = ... 
```

在这里我得到这个警告：

**警告：从空值创建默认对象**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:49:13.123

您创建的矩阵大小仅为 1x1。使用此代码创建 MxN 大小的矩阵：

```
$matrix = array();
for ($i = 0; $i < $M; $i++) {
  $matrix[$i] = array();
  for ($j = 0; $j < $N; $j++) {
    $matrix[$i][$j] = new Tile;
  }
} 
```

# mysql - 单个查询中的 MySQL 百分比

> ID：15042255
> 
> 赞同：0
> 
> 时间：2013-02-23T15:38:47.763
> 
> 标签：mysql

到目前为止，我有这个：\

```
SELECT Bike_Number, MaintFaultDetails, MaintactionTaken, MaintfaultDate, MaintActionDate,
       COUNT(*) 
FROM   MaintHistory
WHERE  (MaintfaultDate + 5) < MaintactionTaken 

SELECT Bike_Number, MaintFaultDetails, MaintactionTaken, MaintfaultDate, MaintActionDate,
       COUNT(*) 
FROM   MaintHistory 
```

我会添加/编辑什么，以便计算使用时间超过 5 天的自行车的百分比

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:54:13.047

试试看

```
 SELECT Bike_Number, MaintFaultDetails, MaintactionTaken, MaintfaultDate, MaintActionDate,
   Concat(count(Bike_Number)*100/COUNT(*).'%' ) as percent
 FROM   MaintHistory
 WHERE  DATE_ADD(MaintfaultDate, INTERVAL +5 DAY) < MaintactionTaken 
```

# java - Java XPath 仅在添加不必要的 jar 后才有效

> ID：15042260
> 
> 赞同：0
> 
> 时间：2013-02-23T15:39:24.103
> 
> 标签：java, xpath

我正在尝试从`XML file via XPath`. 我的代码在`XML`没有命名空间的情况下工作，但由于我的代码有命名空间，我将必要的内容添加`NamespaceContext`到 X Path 对象中。不幸的是，它`XPath`没有提供任何数据，所以经过一番摆弄后，我的代码没有改变，但是这个 jar `xmlparserv2.jar` 添加到了类路径中。瞧，突然之间一切都完美无缺。

我可以看到 jar 包含已经在`JDK`（1.7.0_15）中但可能是不同版本的类。

所以我的问题是

a) 有没有办法找出原始类出了什么问题，`JDK`除了我必须通过无尽的调试`classes`吗？

b）是否有人对替代解决方案有想法/我如何更改我的代码，以便我不必发送额外的“不必要的” `jar`？

谢谢西蒙

那是有问题的代码：

```
public class JavaApplication1 {

public static void main(String[] args) throws IOException, SAXException {
    Document doc = createDoc("Persons.xml");
    parseSFMessage(doc);
}

private static void parseSFMessage(Node node) {
    if (node.getNodeName().startsWith("Persons:person") && node.hasChildNodes()) {
        print("PLZ: " + getNodeValue(node, "ns1:PLZ"));
    }
    NodeList nodeList = node.getChildNodes();
    for (int i = 0; i < nodeList.getLength(); i++) {
        Node currentNode = nodeList.item(i);
        if (currentNode.getNodeType() == Node.ELEMENT_NODE) {
            parseSFMessage(currentNode);
        }
    }
}

private static Document createDoc(String s) {
    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    DocumentBuilder builder = null;
    Document doc = null;
    try {
        builder = factory.newDocumentBuilder();
        doc = builder.parse(new FileInputStream(s));
    } catch (SAXException e) {
    } catch (IOException e) {
    } catch (ParserConfigurationException e) {
    }
    return doc;
}

private static String getNodeValue(Node dom, String element) {
    NamespaceContext ctx = new NamespaceContext() {
        public String getNamespaceURI(String prefix) {
            String uri;
            if (prefix.equals("ns1")) {
                uri = "http://someurl.com/schemas/class/Utils";
            } else {
                uri = null;
            }
            return uri;
        }
        public Iterator getPrefixes(String val) {
            return null;
        }
        public String getPrefix(String uri) {
            return null;
        }
    };
    String result = null;
    XPathFactory xpf = XPathFactory.newInstance();
    XPath xp = xpf.newXPath();
    xp.setNamespaceContext(ctx);
    try {
        result = xp.evaluate(element, dom);
    } catch (XPathExpressionException e) {
        e.printStackTrace();
    }
    return result;
}

private static void print(Object o) {
    if (o != null) {
        System.out.println(o.toString());
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:56:23.883

您需要注意默认情况下不支持命名`DocumentBuilderFactory`空间*。*您必须先调用`factory.setNamespaceAware(true);`才能`factory.newDocumentBuilder()`获得一个构建器，该构建器将使用命名空间支持正确解析 XML。

至于为什么它可以工作，`xmlparserv2`我只能推测可能那个特定的解析器违反了 JAXP 规范并默认启用了命名空间。

# php - 从外部脚本访问 Joomla 2.5 以通过 id 获取文章

> ID：15042262
> 
> 赞同：2
> 
> 时间：2013-02-23T15:39:33.610
> 
> 标签：php, sql, joomla, article

我喜欢阅读来自 Joomla 2.5 的 id 文章。因为我不在框架内，所以我必须先包含它。我还发现了一些如何通过 id 获取文章的示例，但它曾经失败过......这是我正在尝试的示例：

```
define( '_JEXEC', 1 );
define( '_VALID_MOS', 1 );
define( 'JPATH_BASE', realpath(dirname(__FILE__)));
define( 'DS', DIRECTORY_SEPARATOR );
require_once ( JPATH_BASE .DS.'includes'.DS.'defines.php' );
require_once ( JPATH_BASE .DS.'includes'.DS.'framework.php' );
echo JPATH_BASE .DS.'includes'.DS.'framework.php';
$mainframe =& JFactory::getApplication('site');
$mainframe->initialise();
echo  $mainframe->getCfg('sitename');

$articleId = JRequest::getInt('Itemid');
$db =& JFactory::getDBO();

$sql = "SELECT fulltext FROM #__content WHERE id = 260"; //.intval($articleId);
$db->setQuery($sql);
$fullArticle = $db->loadResult(); 
```

文章 ID 260 可用，但它曾经返回 null ...

当我跟踪它时， loadResult() 中的 $cursor 是每个空值：

```
public function loadResult()
{
    // Initialise variables.
    $ret = null;

    // Execute the query and get the result set cursor.
    if (!($cursor = $this->execute()))
    {
        return null;
    }
     ... 
```

有人可以帮忙吗？

谢谢安德烈

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:41:35.843

脚本中有一些你不需要的东西，我已将其更改为 Joomla 2.5 编码标准：

```
define('_JEXEC', 1);
define('JPATH_BASE', realpath(dirname(__FILE__)));
require_once ( JPATH_BASE .'/includes/defines.php' );
require_once ( JPATH_BASE .'/includes/framework.php' );
require_once ( JPATH_BASE .'/libraries/joomla/factory.php' );

$db = JFactory::getDBO();
$query = $db->getQuery(true);
$query->select('introtext')
 ->from('#__content')
 ->where('id = 260');
$db->setQuery($query);

$fullArticle = $db->loadResult();

echo $fullArticle; 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:11:58.973

试试这个 SQL 查询，它现在应该可以工作了！

```
$sql  = 'SELECT `fulltext` FROM `#__content` WHERE `id` = 260'; 
```

Lodder 所说的完全一样，只是比您的查询结构更好。

因此，如果它适合您，您可以使用这种风格进行编码。在他的编码方式中，它将变成：

```
$sql = $db->getQuery(true);
$sql->select('fulltext')
 ->from('#__content')
 ->where('id = 260');
$db->setQuery($sql); 
```

这种方式易于阅读和修改，不是吗？:)

此外，您可以从**`introtext`**获取内容，因为**`fulltext`**有时为空。

# perl - 如何在 perl 文件测试运算符中使用标量变量？

> ID：15042263
> 
> 赞同：0
> 
> 时间：2013-02-23T15:39:40.987
> 
> 标签：perl

我在 perl 的第一个下午，无法弄清楚我的脚本出了什么问题。似乎我没有正确使用文件测试运算符，但我不确定我是如何错误地使用它的。

```
use v5.14;

print "what file would you like to find? ";
my $file = <STDIN>;
my $test = -e $file;
if ($test) {
print "File found";
}
else {
print "File not found";
} 
```

我也尝试将第 5 行和第 6 行替换为

```
if (-e $file) { 
```

和第 6 行

```
if ($test == 1) { 
```

没有运气。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T15:43:50.073

问题不在于测试，而在于`$file`. 当您这样做时，行尾不会被剥离`$file = <STDIN>;`，并且很可能您的文件名中没有包含行尾的文件。

```
chomp($file); 
```

读完之后，你应该好好去。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:01:49.483

[http://perldoc.perl.org/functions/-X.html](http://perldoc.perl.org/functions/-X.html)

```
use v5.14;

use warnings;
use strict;

print "what file would you like to find? ";
#chomp to remove new line
chomp my($filename = <STDIN>);

#test if exists but can still be an empty file
if (-e $filename) {
    print "File found\n";
} else {
        print "File not found\n";
} 
```

# algorithm - 大 O 符号的写作技巧

> ID：15042267
> 
> 赞同：1
> 
> 时间：2013-02-23T15:40:04.107
> 
> 标签：algorithm, complexity-theory, big-o

`f(n)=O(g(n))`这么说和有区别`f(n) ∈ O(g(n))`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T15:44:50.527

“=”并不意味着在其正常的数学意义上表示“等于”，而是更通俗的“是”，因此第二个表达式在技术上是准确的！

[http://en.wikipedia.org/wiki/Big_O_notation](http://en.wikipedia.org/wiki/Big_O_notation)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T19:02:59.117

= 和 ∈ 的符号表示相同的意思，但前者是大多数作者实际使用的符号。

我看了半打手边的书。这些书使用**=**：

*   de Berg 等人，*计算几何*
*   Dasgupta 等人，*算法*
*   Knuth，*计算机编程的艺术*
*   Papadimitriou & Stieglitz，*组合优化*

在这些书中，我发现没有使用任何一种表示法：我发现的所有 O/o/Θ/Ω 都出现在“算法 A 是 O( *n* )”这样的上下文中：

*   Aho 等人，*计算机算法的设计与分析*
*   Ericson，*实时碰撞检测*

我没有发现任何 ∈。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-23T16:05:08.583

*   关系**“f(n) ∈ O(g(n))”**读作“f(x) is little-o of
    g(x)”。这意味着 g(x) 比 f(x) 增长得快得多，或者类似地，
    f(x) 的增长与 g(x) 的增长相比微不足道。
*   它假设 f 和 g 都是一个变量的函数。形式上， **f(n) = o(g(n))** as n → ∞ 意味着对于每个正常数 ε，存在一个常数 N，使得 f(n)<=ɛ(g(n)。

希望你得到你的答案...

# forms - 通过搜索唯一 ID 拉取数据

> ID：15042269
> 
> 赞同：1
> 
> 时间：2013-02-23T15:40:17.677
> 
> 标签：forms, excel, vba

我是 VBA 新手。我只是设法创建我的表单并填充 Excel。我想知道是否有一种方法可以创建一个新按钮，如果它找到唯一的 ID，它将提取信息。

例如：

```
Unique ID   Name     Place
1         John Doe   X
2         Jane Doe   Y
3         Tim Doe    Z 
```

因此，例如，在“添加”（获取工作表中的数据）旁边的表单中，我希望在此处输入“搜索：”，然后输入唯一 ID，并在所有其他单元格中填充信息。

如果我应该提供更多信息，我很抱歉。我是 VBA 新手。如果需要，我可以复制+粘贴代码。

如果我添加信息并点击“添加此部分”，它会在 Excel 中自动完成行（A1：唯一 ID；B1：名称；C1：地点）。

我想通过此操作添加另一个按钮，例如“搜索”：单击 > 询问唯一 ID > 它搜索输入的数据 > 如果找到某些内容，则使用信息填充文本框（SR 在 A:A 上的行）

![在此处输入图像描述](../Images/f10a642d571501535ac172e8d037b91d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T09:41:41.210

我假设您足够熟练地创建一个按钮并编写初始子项？另外，我假设您只有 1 列具有唯一 ID，例如 A 列。

```
Sub Find_Id()
    Dim rng1 As Range
    Dim strSearch As String 
    strSearch = inputbox("Enter a Unique Id", "User Input")
    If strSearch =  vbNullString then exit sub

    Set rng1 = Range("A:A").Find(strSearch, , xlValues, xlWhole) 
    If Not rng1 Is Nothing Then
        'set text box values using rng1.offset(0, column offset).value
        TbxAddStep.value = rng1.offset(0, 1).value
    Else 
        'clear texboxes
    End if

End Sub 
```

如果您需要我可以提供的更多信息，但这会找到单元格并为您提供更改文本框值的空间。

# javascript - 在javascript中下载和合并多部分文件

> ID：15042273
> 
> 赞同：0
> 
> 时间：2013-02-23T15:40:47.053
> 
> 标签：javascript, download, multipart, filemerge

我需要一些帮助来满足以下要求。

*   从网络服务器下载巨大的多部分 csv 文件，并在为用户打开之前在客户端加入这些部分。
*   在下载之前，我可以从网络服务器获取部件的数量和它们的 URL。
*   我需要在客户端浏览器中执行此操作，因此我认为 javascript 是最佳选择。
*   用户使用 IE 作为主要浏览器，但我不能要求他们更改安全设置（vbscript/activxcontrol 不起作用）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T20:48:44.900

如果您别无选择，只能使用它，您可以使用聚合：

```
var data; // will contain the retrieved data

/**
 * Grab data from the first URL in the list, adding it
 * to the global data variable. If the list is empty,
 * we got all the data and we succeed. If an XHR fails, we fail.
 */
function prepData(urlList, success, fail) {
  if(urlList.length===0) {
    succes(); // wrap in timeout if you need to break out of call chain
    return;
  }
  var xhr = new XMLHttpRequest();
  var url = urlList.splice(0,1)[0];
  xhr.open("GET", url, true);
  xhr.onreadystatechange = function() {
    if (xhr.status === 200 && xhr.readyState === 4) {
      data += xhr.responseText;
      prepData(urlList, success, fail);
    } else {
      fail(urlList, xhr);  // again, wrap in timeout to break out of call chain
    }
  }
} 
```

然后我们可以使用如下代码调用它：

```
/**
 * prepare our data prior to application "start"
 */
prepData(['...','...','...'], function (){
  console.log("finished aggregating data");
  // all went well. Start the actual data-consuming code
}, function(notLoadedList, failedXhrObject){
  console.log("ohnoes!", notLoadedList, failedXhrObject);
  // something went wrong, and we can fail gracefully
}); 
```

# jquery - jquery 验证插件：验证隐藏输入，跳过所需的输入文本

> ID：15042275
> 
> 赞同：0
> 
> 时间：2013-02-23T15:41:02.717
> 
> 标签：jquery, validation, jquery-plugins, jquery-validate, hidden-field

我正在尝试验证具有隐藏和非隐藏输入的表单。我在表单验证设置中添加了行 ignore: "" 来验证隐藏的输入，但是这样做，它不会验证它之前的所需文本输入，但只有在它之后才验证。发生的另一件事是，第一次提交后，名字的验证在模糊上起作用（但它仍然不会阻止提交本身）......

这是我的代码，以及 js fiddle [DEMO](http://jsfiddle.net/68uu5/2/)的链接：

JS：

```
 var countries = [{label:"Vanuatu", code:"VU"},
        {label:"Ecuador", code:"EC"}];    
    $().ready(function() {
$('#country').autocomplete({
    source : function(request, response) {
        var matcher = new RegExp('^'+$.ui.autocomplete.escapeRegex(request.term), "i");
        response($.grep(countries, function(element, index) {
            return matcher.test(element.label);
        }));
    },
    delay : 0,
    change : function(event, ui) {
        $('#countryCode').val(ui.item ? ui.item.code : '');
    }
});
$("#signupForm").validate({
    ignore: "",
    rules: {
        firstname: {
            required: true
        },
        lastname: {
            required: true
        },
        country: {
            required: true
        },
        countryCode: {
            required: function(element){
                return $("#signupForm").validate().element( "#country" );
            }
        },
        email: {
            required: true,
            email: true
        }
    },  
    messages: {
        firstname: "Please enter your first name",
        lastname: "Please enter your last name",
        country: "Please select a country",
        countryCode: "Please select a valid country",
        email: "Please enter a valid email address"
    },
    submitHandler: function(form) {
        alert("fine!");
    }
}); 
```

});
HTML 表单：

```
 <form id="signupForm" method="post" name="" action="">
<p>
        <label for="firstname"></label>
        <input class="inputText" type="text" id="firstname" name="firstname" placeholder="First Name">
    </p>
            <p>
        <label for="country"></label>
        <input class="inputText" type="text" id="country" name="country" placeholder="Country"/>

        <input type="hidden" name="countryCode" id="countryCode" />
    </p>
                <p>
        <label for="lastname"></label>
        <input class="inputText" type="text" id="lastname" name="lastname" placeholder="Last Name">
                    </p>
                    <p>
        <label for="email"></label>
        <input class="inputText" type="text" id="email" name="email" placeholder="Email">
                        </p>
                        <p>
        <input class="submit" type="submit" id="signupButton" value="SUBMIT" />   
                        </p>
    </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:49:37.793

我认为问题在于`countryCode`验证

你可以试试

```
countryCode: {
    required: function(element){
        return $("#country").val().length > 0;
    }
} 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/68uu5/3/)

# google-maps - 当前位置 - 谷歌地图 - 链接到方向

> ID：15042283
> 
> 赞同：48
> 
> 时间：2013-02-23T15:42:14.463
> 
> 标签：google-maps

我正在尝试做似乎很容易但导致一些混乱的事情。我试图有一个链接到谷歌地图，其中预先填写了目标地址和从地址继承用户的当前位置。根据其他人的指示，如果我使用“当前位置”作为“发件人地址”，它会为我做所有事情。

相反，当我从其他位置访问 URL 时，它仍在加载原始的“当前位置”，而不是实际的当前位置。

我敢肯定这很容易，但我希望有人能指出我正确的方向。

链接可以在[这里](https://maps.google.com/maps?saddr=Current%20Location&daddr=312%20Ponce%20De%20Leon%20Boulevard,%20Coral%20Gables,%20FL&hl=en&sll=27.698638,-83.804601&sspn=15.932816,33.815918&geocode=Ff35jwEdVXw3-ymzjDyZSgTZiDGXlQJPf2LmTw;FWwyiQEdAFw3-ykrYmyXc7fZiDFjKiNW2vN30w&mra=ls&t=m&z=11)找到。

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2014-03-11T16:10:01.387

对于那些仍在寻找的人，这里有一些链接到谷歌地图的方法：

空格可以更改为`+`或编码为`%20`.

*   链接到某个位置（无方向）

    ```
    https://www.google.com/maps?q=760+West+Genesee+Street+Syracuse+NY+13204 
    ```

*   无起点（生成方向需要用户输入）。

    ```
    https://www.google.com/maps?daddr=760+West+Genesee+Street+Syracuse+NY+13204 
    ```

*   以设定的位置为起点（自动生成方向，无需用户输入）。

    ```
    https://www.google.com/maps?saddr=760+West+Genesee+Street+Syracuse+NY+13204&daddr=314+Avery+Avenue+Syracuse+NY+13204 
    ```

*   以“我的位置”为起点（自动生成方向，无需用户输入）。

    ```
    https://www.google.com/maps?saddr=My+Location&daddr=760+West+Genesee+Street+Syracuse+NY+13204 
    ```

*   当前位置到纬度和经度

    ```
    https://www.google.com/maps?saddr=My+Location&daddr=43.12345,-76.12345 
    ```

*   查询经纬度搜索。还显示设置默认缩放级别。

    ```
    https://www.google.com/maps?ll=43.12345,-76.12345&q=food&amp;z=14 
    ```

*   字符串搜索作为目的地

    ```
    https://www.google.com/maps?saddr=My+Location&daddr=Pinckney+Hugo+Group 
    ```

[这是我发布的一个帖子，我会不断更新，因为有一些更新的方法可以做到这一点！](http://gearside.com/easily-link-to-locations-and-directions-using-the-new-google-maps/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-12-11T13:51:04.030

改用**我的位置**：

```
https://maps.google.com/?saddr=My%20Location&daddr=myDestinationAddress 
```

**当前位置**仅适用于具有英语语言环境设置的操作系统。

我还没有找到任何关于此的文档。但是，按照此处[https://developers.google.com/maps/documentation/ios-sdk/urlscheme的建议将](https://developers.google.com/maps/documentation/ios-sdk/urlscheme)**saddr**留空将提示用户输入起始地址。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-07-23T14:49:45.553

另外，您可以尝试使用

```
 https://maps.google.com/?daddr=53.9187068,27.5862874 
```

它至少在 android 和 ios 上适用于我。可能有用。更多详细信息：[https ://developers.google.com/maps/documentation/ios/urlscheme?utm_source=welovemapsdevelopers&utm_campaign=GM-for-iOS-sdk-1-7](https://developers.google.com/maps/documentation/ios/urlscheme?utm_source=welovemapsdevelopers&utm_campaign=GM-for-iOS-sdk-1-7)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2019-12-09T13:12:08.067

GreatBlakes 和 Jon Alslund-Lanthén 的回答提出了一种有时会给你正确的结果但如果你的用户的语言不是英语的方法可能会失败。

截至 2019 年，最好的方法似乎是：

[https://www.google.com/maps/dir/?api=1&destination=Googleplex,+1600+Amphitheatre+Pkwy](https://www.google.com/maps/dir/?api=1&destination=Googleplex,+1600+Amphitheatre+Pkwy)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-24T20:46:30.750

尝试取出大量信息，并使用“当前+位置”，奇怪的是，使用 .co.uk 而不是 .com。

链接 [https://maps.google.co.uk/maps?t=m&f=d&saddr=Current+Location&daddr=312%20Ponce%20De%20Leon%20Boulevard,%20Coral%20Gables,%20FL](https://maps.google.co.uk/maps?t=m&f=d&saddr=Current+Location&daddr=312%20Ponce%20De%20Leon%20Boulevard,%20Coral%20Gables,%20FL) 按预期工作（Win7 、Chrome 和 IE9、Android Chrome）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-08T23:00:10.557

我的+位置查询字符串不起作用。但是 Current+Location queryString 值是很好的工作。

真实链接

```
https://www.google.com/maps?saddr=Current+Location&daddr=36.8957642,30.7089634 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-01T10:56:34.620

如果您使目的地和当前位置相同，那将起作用。

因此，您应该将目标地址也复制/粘贴到我的位置，而不是计划路线并复制 URL。

这将起作用

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-12-15T02:11:54.593

我假设您希望此链接在手机上打开。

提到的字符串都没有填充我在 iOS 14 或最新版本的 android 上的实际 GPS 位置。

这对我有用，

```
https://www.google.com/maps/dir//Address1/Address2 
```

//（双斜线） - 表示自定义起点。

在桌面上，该字段无人填写，但在移动设备上，它需要您的实际 GPS 位置。

*看起来我毕竟不需要谷歌 api 密钥。*

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2013-02-23T19:26:41.997

您期望的用户位置不是您期望的，“当前位置”将被 google 视为任何其他地址，并且 google 会尝试找到与查询匹配的位置。

当有人告诉你“当前位置”将迫使谷歌解析用户的位置时，这是错误的。

您可以自行对用户进行地理定位，然后根据地理定位结果创建链接。

# c# - 如何从音频设备 ID 中获取音频设备编号？

> ID：15042295
> 
> 赞同：4
> 
> 时间：2013-02-23T15:43:26.157
> 
> 标签：c#, audio, device

有一个 Windows 窗体 (C#) 应用程序显示连接到系统的音频设备（麦克风组合和扬声器组合）列表。用户可以选择他的输入设备（麦克风）和输出设备（扬声器）偏好来说话和听。还有另一个平台级代码（用 C 程序编写），它期望设备号播放和收听适当的设备。这是一个整数值（我们称之为 Wave in 和 Wave out id）。此设备编号值会随着 windows 音频 (I/O) 设备优先级的更改而变化。现在我的 Windows 窗体 UI（C#）需要根据下拉选择（麦克风/扬声器）将设备编号发送到平台代码（C 语言）。

我能够使用以下方法（DirectXSound / Microsoft Expression Encoder / Wmi 查询）在下拉列表中列出设备（设备名称和设备 ID（GUID））这些给了我唯一的 DeviceId（GUID）。但是我无法获得相应的所选输入和输出音频设备的设备号（整数值）。

是否有任何映射可以从设备 ID（GUID）获取设备编号（整数）？

我google了很多，很沮丧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T17:19:32.813

我相信这个链接会回答你的问题。答案的代码是用 C++ 编写的，但您应该能够相当容易地将其移植出来。

[是否可以在不同的 API 中关联相同的音频设备？](https://stackoverflow.com/questions/1929658/is-it-possible-to-relate-the-same-audio-device-in-different-apis)

# php - PHP MySQL - IN/ALL/ANY 子查询中的列“id”不明确

> ID：15042296
> 
> 赞同：0
> 
> 时间：2013-02-23T15:43:26.083
> 
> 标签：php, mysql

我目前有以下查询工作：

```
$sql = $db->Query("SELECT a.id FROM surf a LEFT JOIN users b ON b.id = a.user LEFT JOIN surfed c ON c.user = '".$data['id']."' AND c.site = a.id WHERE a.active = '0' AND (b.coins >= a.cpc AND a.cpc >= '2') AND (c.site IS NULL AND a.user !='".$data['id']."')".$dbt_value." ORDER BY a.cpc DESC LIMIT 1"); 
```

但我想在其中添加以下 AND 语句：

```
 AND `cpc`<='10' AND (`id` NOT IN (SELECT `site` FROM `surfed_site`)) 
```

所以我让它看起来像：

```
$sql = $db->Query("SELECT a.id FROM surf a LEFT JOIN users b ON b.id = a.user LEFT JOIN surfed c ON c.user = '".$data['id']."' AND c.site = a.id WHERE a.active = '0' AND (b.coins >= a.cpc AND a.cpc >= '2') AND `cpc`<='10' AND (`id` NOT IN (SELECT `site` FROM `surfed_site`)) AND (c.site IS NULL AND a.user !='".$data['id']."')".$dbt_value." ORDER BY a.cpc DESC LIMIT 1"); 
```

但后来我收到这条消息：

IN/ALL/ANY 子查询中的列“id”不明确

我的查询有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T15:45:54.863

尝试改变

```
AND `cpc`<='10' AND (`id` NOT IN (SELECT `site` FROM `surfed_site`)) 
```

到

```
AND `cpc`<='10' AND (`a.id` NOT IN (SELECT `site` FROM `surfed_site`)) 
```

您需要`a.id`，因为不确定`id`要引用哪个表中的哪一列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T15:46:06.977

该错误的原因是因为有多个表包含 column `ID`。为了执行查询，您必须提供列`ID`所在的表，以便服务器识别与哪个表相关，例如

```
AND `cpc`<='10' AND (a.`id` NOT IN (SELECT `site` FROM `surfed_site`)) 
```

如果您的意思是`ID`您要比较的是来自表`surf`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T15:47:29.700

您必须指定`id`您想要的。`a.id`等`b.id`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T15:50:15.740

另外我假设 $data 包含转义数据（单引号）？如果不是，那是第二个问题。

# android - 如何在 Android 上下载时显示图像预览？

> ID：15042297
> 
> 赞同：0
> 
> 时间：2013-02-23T15:43:31.430
> 
> 标签：android, image, preview, download, bitmapfactory

我想编写一个显示来自 Cherokee 网络服务器的图像的应用程序。我使用以下代码下载图像：

```
@Override
protected Bitmap doInBackground(URL... params) { 
    URL urlToDownload = params[0];
    String downloadFileName = urlToDownload.getFile();
    downloadFile = new File(applicationContext.getCacheDir(), downloadFileName);
    new File(downloadFile.getParent()).mkdirs(); // create all necessary folders

    // download the file if it is not already cached
    if (!downloadFile.exists()) {
        try {
            URLConnection cn = urlToDownload.openConnection();   
            cn.connect();
            cn.setReadTimeout(5000);
            cn.setConnectTimeout(5000);
            InputStream stream = cn.getInputStream();

            FileOutputStream out = new FileOutputStream(downloadFile);   
            byte buf[] = new byte[16384];
            int numread = 0;
            do {
                numread = stream.read(buf);   
                if (numread <= 0) break;   
                out.write(buf, 0, numread);
            } while (numread > 0);
            out.close();
        } catch (FileNotFoundException e) {
            MLog.e(e);
        } catch (IOException e) {
            MLog.e(e);
        } catch (Exception e) {
            MLog.e(e);
        }
    }

    if (downloadFile.exists()) {
        BitmapFactory.Options options = new BitmapFactory.Options();
        options.inSampleSize = 16;
        return BitmapFactory.decodeFile(downloadFile.getAbsolutePath(), options);   
    } else {
        return null;
    }
} 
```

这可行，但由于我需要下载的图像非常大（数兆字节），用户需要一些时间才能看到任何东西。

我想在加载完整图像时显示图像的低分辨率预览（就像任何网络浏览器一样）。我怎样才能做到这一点？BitmapFactory 似乎只接受在解码之前完全下载的完全加载的文件或流。

服务器上只有高分辨率图像。我只想显示我在下载时已经下载的图像的所有内容，以便在完全下载之前显示（部分）图片。这样，用户一发现这不是他正在寻找的图片，就可以中止下载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:38:32.323

那么最简单的方法就是下载两个图像。一个很小的（比如说几个字节）然后放大它（它看起来很糟糕，但会给出进度的概念），同时在后台加载更大的图像。很可能小一个会首先返回，您将能够使它看起来好像从低分辨率变为高分辨率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T11:15:09.733

2 AsyncTask 怎么样？第一个下载小或低分辨率图像并将其显示在 ImageView 上，然后第一个 AsyncTask 调用第二个 AsyncTask 下载全分辨率图像。

# c# - 为二维情况调整包装类

> ID：15042298
> 
> 赞同：3
> 
> 时间：2013-02-23T15:43:40.387
> 
> 标签：c#, interop, pinvoke, matlab-coder

这个问题是这个问题的[延伸](https://stackoverflow.com/questions/15022890/emxarray-real-t-to-c-sharp-struct-plus-initialisation)。

我想为二维情况调整包装器。这是我的第一次尝试：

```
public class EmxArrayRealTWrapper : IDisposable
{
private readonly emxArray_real_T _value;
private GCHandle _dataHandle;
private GCHandle _sizeHandle;

public emxArray_real_T Value
{
    get { return _value; }
}

public EmxArrayRealTWrapper(double[,] data)
{
    _dataHandle = GCHandle.Alloc(data, GCHandleType.Pinned);
    _value.data = _dataHandle.AddrOfPinnedObject();
    _sizeHandle = GCHandle.Alloc(new int[] { data.GetLength(0), data.GetLength(1) }, GCHandleType.Pinned);
    _value.size = _sizeHandle.AddrOfPinnedObject();
    _value.allocatedSize = data.GetLength(0) * data.GetLength(1) * sizeof(double);
    _value.numDimensions = 2;
    _value.canFreeData = false;
}

public void Dispose()
{
    _dataHandle.Free();
    _sizeHandle.Free();
    GC.SuppressFinalize(this);
}

~EmxArrayRealTWrapper()
{
    Dispose();
}
}

[StructLayout(LayoutKind.Sequential)]
public struct emxArray_real_T
{
public IntPtr data;
public IntPtr size;
public int allocatedSize;
public int numDimensions;
[MarshalAs(UnmanagedType.U1)]
public bool canFreeData;
} 
```

PS：

原始 matlab 代码如下所示：

```
 function [x] = test(a)
    %#codegen

    x = 0;
    if(~isempty(coder.target))
      assert(isa(a,'double'));
      assert(all(size(a) == [1 Inf]));
   end

    x = sum(a); 
```

并且可以像这样调用：

```
a = [ 1 2; 3 4]

r = test(a) 
```

生产：

```
r =

     4     6 
```

不幸的是，生成的 C 无法达到 Matlab 可以达到的效果（即返回一个数组）：

```
__declspec(dllexport) real_T test(const emxArray_real_T *a);

real_T test(const emxArray_real_T *a)
{
  real_T x;
  int32_T k;
  if (a->size[1] == 0) {
    x = 0.0;
  } else {
    x = a->data[0];
    for (k = 2; k <= a->size[1]; k++) {
      x += a->data[k - 1];
    }
  }

  return x;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:59:56.130

我假设 MATLAB 数组结构使用 col-major 排序。在这种情况下，结构构造函数需要如下所示：

```
public EmxArrayRealTWrapper(double[,] data)
{
    int nRow = data.GetLength(0);
    int nCol = data.GetLength(1);

    double[] flattenedData = new double[nCol * nRow];
    int index = 0;
    for (int col=0; col<nCol; col++)
    {
        for (int row=0; row<nRow; row++)
        {
            flattenedData[index] = data[row, col];
            index++;
        }
    }                    

    _dataHandle = GCHandle.Alloc(flattenedData, GCHandleType.Pinned);
    _value.data = _dataHandle.AddrOfPinnedObject();
    _sizeHandle = GCHandle.Alloc(new int[] { nCol, nRow }, GCHandleType.Pinned);
    _value.size = _sizeHandle.AddrOfPinnedObject();
    _value.allocatedSize = nCol * nRow;
    _value.numDimensions = 2;
    _value.canFreeData = false;
} 
```

如果本机代码需要行优先，那么它更简单。AC# 多维数组存储为连续的行优先数组。因此，您可以使用与我在您最近的问题中提供的一维代码非常相似的代码。

```
public EmxArrayRealTWrapper(double[,] data)
{
    int nRow = data.GetLength(0);
    int nCol = data.GetLength(1);
    _dataHandle = GCHandle.Alloc(data, GCHandleType.Pinned);
    _value.data = _dataHandle.AddrOfPinnedObject();
    _sizeHandle = GCHandle.Alloc(new int[] { nRow, nCol }, GCHandleType.Pinned);
    _value.size = _sizeHandle.AddrOfPinnedObject();
    _value.allocatedSize = nCol * nRow;
    _value.numDimensions = 2;
    _value.canFreeData = false;
} 
```

请注意，这两种变体在将数据传递给本机代码的方式上有所不同。第一个版本传递原始数据的副本。第二个传递对原始数据的引用。我不确定你希望你的代码如何表现。调整第二个版本以传递副本很容易。对于第一个版本，如果您希望本机代码修改数据并将这些修改反映回托管代码，那么您需要在本机调用返回后将修改编组回来。

# android - 如何在没有嵌套权重的情况下获得复杂的流体布局

> ID：15042305
> 
> 赞同：0
> 
> 时间：2013-02-23T15:44:20.993
> 
> 标签：android, android-layout

如何获得类似的布局

![所需布局](../Images/6165c5043de931f5aa4e1348a2db38f5.png)

底部元素的高度是 wrap_content，但嵌套布局 Eclipse 提示我`nested weights are bad for performance`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:31:32.067

那是权重为 1 的垂直线性布局和嵌套的水平线性布局，内容高包装，权重 1 宽。是的，嵌套权重对性能不利，但如果这是您需要的，那就是您所需要的。正如 Moecklin 先生指出的那样，就您而言，这可能并不重要。

**编辑添加：**

你可能已经有了这个：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >

        <TextView
            android:layout_height="wrap_content"
            android:layout_width="0dp"
            android:layout_weight="1" />

        <TextView
            android:layout_height="wrap_content"
            android:layout_width="0dp"
            android:layout_weight="1" />
    </LinearLayout>

</LinearLayout> 
```

# html - 我如何使我的利润适应许多分辨率？

> ID：15042307
> 
> 赞同：0
> 
> 时间：2013-02-23T15:44:35.480
> 
> 标签：html, css, fluid-layout, margins

这是我一生中制作的第一个网站，因此非常感谢您的帮助！我还在学习html和css。我的第一个网站几乎完成了，除了我已经为我的原始分辨率 - 1280x800 构建了它。当我改变分辨率时，元素会分开。为了弥补这一点，我只需要更改 body 属性中右边距的值。例如，当前是 7em。如果我想以 1920x1200 的分辨率为中心，值应该是 27em。我尝试过使用 site-wrapper 和 @media 查询技术，但这似乎不起作用。解决方案显然很简单，但我自己无法弄清楚。

请帮我！

我的 HTML：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
        <title>Autoprevoznik Damjanić</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="description" content="Autoprevoznik Damjanić / Prevoz robe / Špediterske usluge" />
<meta name="keywords" content="Damjanić, autoprevoznik, špediter, prevoz robe, špediterske usluge" />
        <link rel="stylesheet" type="text/css" href="naslovna.css" />
        <link rel="shortcut icon" href="Truck.ico" />
</head>

<body>

<h1><a href="naslovna.html">:::Autoprevoznik Damjanić</a></h1>

<div id="border_left"></div>
<ul>
    <li><a href="kontakt.html">Kontakt Informacije</a></li>
    <li><a href="galerija.html">Galerija slika</a></li>
    <li id="empty"><a href="onama.html">O nama</a></li>
</ul>
<div id="border_right"></div>

<div id="content">
    <p>Ispum schmipsum.</p>
</div>

<div class="background">
<div class="border">
<div id="box1">
    <h2>Ukratko o nama</h2>
    <h3>Usluge prevoza</h3>
<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
<div class="button" ><a href="galerija.html"  style="text-decoration:none" title="Galerija slika" class="read_more">galerija</a></div>
</div>
</div>
</div>

<div class="background">
<div class="border">
<div id="box2">
    <h2>Aktuelnosti</h2>
    <h3>Poslednje vesti</h3>
<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
<div class="button" ><a href="onama.html"  style="text-decoration:none" title="Detaljnije" class="read_more">detaljnije</a></div>
</div>
</div>
</div>

<div class="background">
<div class="border">
<div id="box3">
    <h2>Kontakt informacije</h2>
    <h3>Identifikacija preduzeća</h3>
<p>Možete nas kontaktirati na brojeve telefona :</p>

<p>+381 (0) 6</p>

<p>+381 (0) 34</p>

<p>Email:</p>
 <div class="button" ><a href="kontakt.html" style="text-decoration:none" title="Detaljnije" class="read_more">detaljnije</a></div>
</div>
</div>
</div>

</body>
</html> 
```

还有我的 CSS：

```
body  {
    background:url(background.jpg);
    background-repeat: no-repeat;   
    background-position: top center;
    background-color:#b0d3f6;
    margin: 3em 7em 0em;
    }

p {
    font-size: 11px;
    margin: 0px 30px 0px 0px;
    color: rgb(111, 130, 150);
    line-height: 18px;
    text-align: left;
}

h1 a {
    color: rgb(27, 63, 150);
    position: relative;
    top: 30px;
    text-decoration: none;
}

h2 {
    font-size: 16px;
    color: rgb(27, 63, 98);
    margin-bottom: -5px;
}

h3 {
    font-size: 12px;
    color: rgb(84, 130, 175);
}

#box1, #box2, #box3 {
    display: inline-block;
    width: 306px;
    background: url(box_top.png) top left no-repeat;
    padding: 0px 18px;
    position: relative;
    top: -35px;
}

.border {
    display: inline-block;
    background: url(box_bottom.png) bottom left no-repeat;
    position: relative;
    top: 17px;
    vertical-align: top;
}

.background {
    display: inline-block;
    background: url(box_in.png) repeat-y;
}

.button {
    position: relative;
    left: -10px;
    width: 77px;
    height: 19px;
    line-height: 16px;
    background: url("button.png") no-repeat;
    font-size: 11px;
    color: rgb(255, 255, 255);
    text-align: center;
    margin: 20px 10px 0px;
}

a { color:white;}

ul {
    float:right;
    position:relative;
    top: -35px;
    left: -60px;
    list-style: none;
    padding:0;
    margin:0;
    height: 48px;
    line-height: 70px;
    background: url("menu_back.png") no-repeat;
}

ul a {
    color:  rgb(113, 136, 157);
    text-decoration: none;
    font-size: 12px;
    line-height: 45px;
    display:block;
}

ul li {
    background: url("menu_line.png") no-repeat;
    position: relative;
    float: right;
    margin: 7px 0px 0px;
    height: 40px;
}

li { 
    float: right;
    border-bottom-width: 0;
    padding: 0px 20px;
}

#content {
    position: relative;
    top: -35px;
    clear: both;
    width: 1005px;
    height: 247px;
    background: url("slider_back.png") no-repeat;
}

#content p {
    margin-left: 2em;
}

#border_left {
    background: url("menu_back_left.png") no-repeat;
    position: relative;
    right: 440px;
    top: -35px;
    height: 48px;
    width: 11px;
    float: right;
}

#border_right {
    background: url("menu_back_right.png")no-repeat;
    position: relative;
    right: -320px;
    top: -35px;
    height: 48px;
    width: 11px;
    float: right;
}

#empty {
    background: none;
} 
```

如您所见，唯一有问题的行是 margin: 3em 7em 0em; 如果我可以使右边距值（7em）流动，问题就会解决！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:20:42.523

你想要的是让你的网页**居中？**如果你想居中，我建议使用：

```
margin: 0 auto; /*left and right margin are "automatic"*/ 
```

您可以使用它以任何分辨率使您的身体居中：

```
body {
    margin: 0 auto;
    width: 80%;
} 
```

如果你把 100% 的内容有全宽，所以没有什么可以居中。如果你想居中另一个东西，你想要居中的盒子应该比他的父母有更小的宽度。

无论如何，使用 body 元素中的值来居中是**不好的**。

# r - 在 R 中设置子集值时保持数据框大小不变

> ID：15042310
> 
> 赞同：0
> 
> 时间：2013-02-23T15:44:44.380
> 
> 标签：r, dataframe, subset

我想通过删除值但不删除任何列来对数据框进行子集化。

**例子**

```
> df <- as.data.frame(rbind(c(1,2,3,4,5,6, 1), c(4,5,6,7,3,0, 0)))
> df
  V1 V2 V3 V4 V5 V6 V7
1  1  2  3  4  5  6  1
2  4  5  6  7  3  0  0 
```

正如预期的那样，子集返回一个较小的数据框：

```
> df[which(df[1,] > 2)]
  V3 V4 V5 V6
1  3  4  5  6
2  6  7  3  0 
```

**如何让子集返回以下数据框？**

```
 V1 V2 V3 V4 V5 V6  V7
1  NA NA  3  4  5  6  NA
2  NA NA  6  7  3  0  NA 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T15:45:26.173

您实际上并不想要`subset`您的数据框，您只想空白某些列。所以只需反转`which`命令中的逻辑..

```
df[ , df[ 1 , ] <= 2]

# and set all of _those_ values to NA
df[ , df[ 1 , ] <= 2] <- NA

# look at the result
df 
```

注意：如果您的数据框`NA`在第一列中已经包含 s，`<=`则将返回一个`NA`可能不是您想要的。只要确保您使用的任何测试都不会返回`NA`值。

# php - 除了 stock lang 类之外的 codeigniter 定位

> ID：15042311
> 
> 赞同：1
> 
> 时间：2013-02-23T15:44:47.803
> 
> 标签：php, codeigniter, localization, html-parsing

除了浪费时间的 lang() 类之外，还有什么更好的定位？

当前方法

index.php 视图

在语言文件中，我必须设置默认语言和其他语言。但是我发现每次我需要显示一个单词/段落时都必须转到 lang 文件，这有点让人分心并且浪费时间。如果我不设置英语语言，它将显示空行。

那么是否有一个已经存在的方法可以让我自由开发，并且在加载视图时检查所有可见文本并在其他语言（如果设置）中搜索它的替代项，其他保持原样？

例如

```
<h1 data-lang='login'>please login<h1>
<p><label for='username'>Username</label><input name='username' /></p>
<p><label for='username'>Password</label><input name='password' /></p> 
```

和本地化解析所有标签并搜索 data-lang 以找到 lang_ 键，如果它不存在则留下我的默认值..？例如，如果标签搜索 for='' 值

这是一个粗略的想法，我认为这会让我的生活变得更好......但是，如果有任何更好的解决方案不需要我将默认语言分离到它自己的文件中，我很想听听。

我如何在 codeigniter 中解析 html ？

# recaptcha - 我可以在公共脚本中使用 ReCaptcha 吗？（关于 API 密钥）

> ID：15042318
> 
> 赞同：0
> 
> 时间：2013-02-23T15:45:13.090
> 
> 标签：recaptcha

我正在编写一个 PHP 脚本，并希望包含 ReCaptcha

但是，在脚本中使用我的私有/公共 API 密钥是否安全？我的意思是我可以为所有域启用它，还是用户只需要在 Google 注册并获得密钥？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:49:38.787

它是安全的。Yoy 必须注册并编写您的域，或者您可以为所有域创建全局密钥，但它将与您的私钥一起使用。

# javascript - 使用 $().load() 方法加载脚本。为什么我在 Chrome 开发者工具源选项卡中看不到它？

> ID：15042321
> 
> 赞同：0
> 
> 时间：2013-02-23T15:45:30.033
> 
> 标签：javascript, google-chrome, google-chrome-devtools

我正在用这段代码加载一个脚本

```
 $('#taskScript').load(scriptName, function (data, textStatus, xmlHttpRequest) { 
```

进入我文件中的这个空脚本标签

```
 <script id="taskScript"></script> 
```

我想调试脚本，但在 CDT 的源选项卡中看不到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:48:12.920

这不是`.load()`API 的用途。我想你想要`$.getScript()`。这将获取您的脚本并执行它。您不需要空`<script>`标签，只需：

```
$.getScript( yourURL, function(theScript, status, jqxhr) {
  // called on success after script has run
}); 
```

# c# - 如何在每个段周围显示矩形..并测量图像的 x 和 y 坐标

> ID：15042325
> 
> 赞同：1
> 
> 时间：2013-02-23T15:45:48.433
> 
> 标签：c#, rtd

我要数没有。rtd 图像中的段，并且必须在每个对象周围绘制矩形。我还必须在 c# 中测量 x 和 y 坐标

# html - 强制所有 要在单行中水平显示的元素

> ID：15042330
> 
> 赞同：1
> 
> 时间：2013-02-23T15:46:09.813
> 
> 标签：html, css

我希望将我所有的 li 元素显示为

ul

li1 li2 li3...（直到屏幕的宽度）

...li(n-1) 林

ul

即水平而不是垂直显示它们。我在 SO 上看到了很多与它相关的问题，但不知何故，即使在尝试了很多事情之后，我也无法为我的 html 和 css 修复它。

我只是一个初学者，所以我可能犯了一个非常基本的错误。

```
 <ul class="iconlist">
                <div class="inline">
                    <li>
                        <a href="http://www.google.com" target="_blank"><img src="images/profile/0.png"</a>
                        <h3><a href="http://www.google.com" target="_blank">ABB</a></h3>
                    </li>
                    <li>
                        <a href="http://www.google.com" target="_blank"><img src="images/profile/14.png"</a>    
                        <h3><a href="http://www.google.com" target="_blank">Siemens</a></h3>
                    </li>
                    <li>
                        <a href="http://www.google.com" target="_blank"><img src="images/profile/0.png"</a>    
                        <h3><a href="http://www.google.com" target="_blank">Alstom</a></h3>
                    </li>
                    <li>
                        <a href="http://www.google.com" target="_blank"><img src="images/profile/14.png"</a>
                        <h3><a href="http://www.google.com" target="_blank">Linde</a></h3>                    
                    </li>
                </div>
            </ul>

.iconlist{
list-style:none;
text-align:center;
padding:20px 0px 20px 0px;
clear:none;
float:left;
}

.inline
{
display:inline;
clear:none;
float:left;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T15:49:16.170

你不能有`<div>`一个`<ul>`. [的内容模型`<ul>`实际上是特定的](http://www.w3.org/TR/html5-author/the-ul-element.html#the-ul-element)

无论如何，您想要`.iconlist`样式，但要将它们应用于`<li>`元素，而不是`<ul>`：

[http://jsfiddle.net/vaQma/](http://jsfiddle.net/vaQma/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T15:49:53.780

换行`li`无效`div`。你只需要给`display:inline-block`元素`li`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T15:57:03.717

以下是您的操作方法：

```
.iconlist{
list-style:none;
text-align:center;
padding:20px 0px 20px 0px;
clear:none;
}

.iconlist li{
float:left;
} 
```

删除 div 和 .inline 类和你的黄金

编辑：显示：内联块；也可以代替浮动

# c# - 如何在 c# winforms 中添加上标幂运算符？

> ID：15042334
> 
> 赞同：5
> 
> 时间：2013-02-23T15:46:32.763
> 
> 标签：c#, winforms

我知道可以使用其 unicode 值将方形运算符添加到标签（[如何在 .NET GUI 标签中显示上标字符？](https://stackoverflow.com/questions/625759/how-can-i-show-a-superscript-character-in-net-gui-labels)）。有没有办法为标签添加任何力量？我的应用程序需要显示多项式函数，即 x^7 + x^6 等。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T16:29:44.297

您可以使用（出色的）[HtmlRenderer](http://htmlrenderer.codeplex.com/)并构建您自己的支持 html 的标签控件。

这是一个例子：

```
public class HtmlPoweredLabel : Control
{
    protected override void OnPaint(PaintEventArgs e)
    {
        string html = string.Format(System.Globalization.CultureInfo.InvariantCulture,
        "<div style=\"font-family:{0}; font-size:{1}pt;\">{2}</div>",
        this.Font.FontFamily.Name,
        this.Font.SizeInPoints,
        this.Text);

        var topLeftCorner = new System.Drawing.PointF(0, 0);
        var size = this.Size;

        HtmlRenderer.HtmlRender.Render(e.Graphics, html, topLeftCorner, size);

        base.OnPaint(e);
    }
} 
```

使用示例：

```
// add an HtmlPoweredLabel to you form using designer or programmatically,
// then set the text in this way:
this.htmlPoweredLabel.Text = "y = x<sup>7</sup> + x<sup>6</sup>"; 
```

结果 ：

![在此处输入图像描述](../Images/d1fa3fa587bb121e500cd4f42c1141cf.png)

请注意，此代码将您的 html 包装到 div 部分中，该部分将字体系列和大小设置为控件使用的字体。所以你可以通过改变`Font`标签的属性来改变大小和字体。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-23T16:49:23.880

您还可以使用本机支持的 ​​UTF 字符串的强大功能，并执行类似的扩展方法，将整数（甚至是 uint）转换为字符串，例如：

```
public static class SomeClass {

    private static readonly string superscripts = @"⁰¹²³⁴⁵⁶⁷⁸⁹";
    public static string ToSuperscriptNumber(this int @this) {

        var sb = new StringBuilder();
        Stack<byte> digits = new Stack<byte>();

        do {
            var digit = (byte)(@this % 10);
            digits.Push(digit);
            @this /= 10;
        } while (@this != 0);

        while (digits.Count > 0) {
            var digit = digits.Pop();
            sb.Append(superscripts[digit]);
        }
        return sb.ToString();
    }

} 
```

然后以某种方式使用该扩展方法：

```
public class Etc {

   private Label someWinFormsLabel;

   public void Foo(int n, int m) {
     // we want to write the equation x + x^N + x^M = 0
     // where N and M are variables
     this.someWinFormsLabel.Text = string.Format(
       "x + x{0} + x{1} = 0",
       n.ToSuperscriptNumber(),
       m.ToSuperscriptNumber()
     );
   }

   // the result of calling Foo(34, 2798) would be the label becoming: x + x³⁴+ x²⁷⁹⁸ = 0

} 
```

遵循这个想法，并进行**一些**额外的调整，（例如连接到文本框的 TextChange 和诸如此类的事件处理程序），您甚至可以允许用户编辑此类“上标兼容”字符串（通过在其他按钮上打开和关闭“上标模式”在您的用户界面上）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-16T13:19:09.403

您可以将 unicode 转换为上标、下标和任何其他符号的字符串并添加到字符串中。例如：如果你想要 10^6，你可以用 C# 或其他编写如下代码。

幂 6 的 unicode 为 U+2076，幂 7 的 unicode 为 U+2077，因此您可以将 x^6+x^7 写为

label1.Text = "X"+(char)0X2076+"X"+(char)0x2077;

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-26T18:34:08.780

我认为没有*确切*或*正确的*方法来做到这一点。[但是你可以做到这一点的一种方法是在这个网站https://lingojam.com/SuperscriptGenerator](https://lingojam.com/SuperscriptGenerator)中输入你想成为指数的数字 。

然后复制转换后的版本。例如，我在其中放了一个 3，我得到的转换后的版本是 ³。然后，您只需将其连接在一起。

`m³`

现在您可以将其添加到标签中...

```
mylabel.Text="m³"; 
```

或者无论如何你想。

# google-chrome-extension - 使用谷歌选择器需要 OAuth 2.0？

> ID：15042337
> 
> 赞同：0
> 
> 时间：2013-02-23T15:47:08.507
> 
> 标签：google-chrome-extension, google-api, oauth-2.0, google-drive-api

在我的 chrome 扩展中，我想通过使用 google dirve UI 或特别是 google 选择器将文件上传到 google drive。我想知道这是否需要 OAuth 2.0，或者我可以简单地使用 API 密钥。我检查了文件，但没有找到答案。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-11T06:18:33.450

是的，截至 2014 年 1 月 15 日。请参阅[https://groups.google.com/forum/#!topic/google-picker-api/gN98MUGl4Jg](https://groups.google.com/forum/#!topic/google-picker-api/gN98MUGl4Jg)

# android - 如何点亮屏幕或打开屏幕？

> ID：15042340
> 
> 赞同：0
> 
> 时间：2013-02-23T15:47:23.103
> 
> 标签：android, mobile, bada

如果屏幕处于关闭状态，那么如何点亮屏幕或打开屏幕。

Android 和 Bada 的答案我都可以接受。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:52:11.940

在 android 上，您需要使用[PowerManager](http://developer.android.com/reference/android/os/PowerManager.html)并获得[WakeLock](http://developer.android.com/reference/android/os/PowerManager.WakeLock.html)。您可以查看此[答案](https://stackoverflow.com/questions/3689878/wakelock-is-not-turning-on-the-screen-help)以获取有关如何使用它的示例。

# android - 如何从网上下载图像并将其保存在内部存储中？

> ID：15042342
> 
> 赞同：-7
> 
> 时间：2013-02-23T15:47:25.913
> 
> 标签：android

如何从网上下载图像并将其保存在内部存储中？之后，我该如何显示它？任何帮助将不胜感激

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Bitmap bitmap = getBitmap("http://www.parkcinema.az/uploads/structures/movies/images/vozvra%C3%BCenie_geroya_poster1_resized.jpg");
        ImageView image = (ImageView)findViewById(R.id.pick);
        image.setImageBitmap(bitmap);
    }

public Bitmap getBitmap(String bitmapUrl){
        try {
            URL url = new URL(bitmapUrl);
            return BitmapFactory.decodeStream(url.openConnection().getInputStream());
            }
        catch(Exception ex) {return null;}
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:55:17.627

```
 private DownloadImageTask task;   

public void onCreate(){
task = new DownloadImageTask();

}   

private class DownloadImageTask extends AsyncTask<String, Void, Bitmap> {

        protected Bitmap doInBackground(String... urls) {
            String urldisplay = urls[0];
            Bitmap mIcon11 = null;
            try {
                InputStream in = new java.net.URL(urldisplay).openStream();
                mIcon11 = BitmapFactory.decodeStream(in);
            } catch (Exception e) {
                Log.e("Error", e.getMessage());
                e.printStackTrace();
            }
            return mIcon11;
        }

        protected void onPostExecute(Bitmap result) {
            // Do your staff here to save image
        }
    } 
```

# php - .htaccess 在传递给模板之前重写 PATH_INFO 变量为空；不从 url 中删除 index.php

> ID：15042344
> 
> 赞同：1
> 
> 时间：2013-02-23T15:47:42.177
> 
> 标签：php, .htaccess, url-rewriting, url-routing, pathinfo

大家早上好，我希望这将是一件容易的事！（我还没喝咖啡呢，怎么起这么早？！）

无论如何.. 为您提供了一个两部分： **第一个（基本）问题**，我试图从我的链接中删除 index.php（这似乎几乎是不可能的，感谢 hostgator :)）。经过一堆搜索，我已经到了 /page 重定向到 /index.php/page 的地步。现在这总比没有好，但当然仍然不理想。我必须使用 [R] 来做到这一点。我的 .htaccess 是：

```
RewriteCond   %{REQUEST_FILENAME}   !-f 
RewriteCond   %{REQUEST_FILENAME}   !-d 
RewriteRule   ^(.*)$                index.php/$1  [R,L] 
```

* * *

**第二个（硬）问题**我需要从 url 中删除 index.php，但仍要确保显示正确的页面控制器（即 url 中的页面）。我正在使用 PATH_INFO 来获取 var 并显示正确的页面，并且当 index.php 存在时它可以工作。

但是由于某种原因，当您从最后一个 RewriteRule 中取出 R 时，/page 总是默认为主 index.php 模板。这就像 .htaccess 或任何在我的网站可以处理页面之前将 PATH_INFO 重写为空的东西。我想我需要在 .htaccess 重写它**之前锁定 PATH_INFO 。**

对于我坚持的一些测试`var_dump(path_segments());` ，当在 /index.php/page 上时它给出：`array(2) { [0]=> string(0) "" [1]=> string(10) "proper-page" }`. 但是，当您将 R 从上述重写规则中取出并仅使用 /page 进行访问时，它只会给出： `array(2) { [0]=> string(0) "" [1]=> string(0) "" }`.

* * *

现在我什至不知道我是否需要担心第二个问题，如果有一个简单的方法来做第一个。但至少这就是我现在想要弄清楚的一切。感谢我能得到的所有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:22:25.743

那你有两个选择。您可以通过调整重写器来跳过使用 PATH_INFO 以将路径作为 GET 参数：

```
 RewriteRule   ^(.*)$     index.php?path=$1  [L,QSA] 
```

因此`$_GET["path"]`现在使用。

或者从 using 切换`$_SERVER["PATH_INFO"]`并从`$_SERVER["REQUEST_URI"]`. 有时还有其他环境变量，例如`REDIRECT_PATH_INFO`，检查`print_r($_SERVER);`。

# php - WordPress mysql错误

> ID：15042345
> 
> 赞同：0
> 
> 时间：2013-02-23T15:47:49.207
> 
> 标签：php, mysql, wordpress

我是这里的初学者

我需要一个邮件订阅的东西

所以使用 php 和 mysql 我设法创建了这个表单

```
 <?php

  /*
  Template name: mail form
  */
 // if using a custom function, you need this
 $Email = $_POST['email-form'];
 $firstn = $_POST['First-name'];

   global $wpdb;
   $table_name = $wpdb->prefix . "new_mail_form";
   $wpdb->insert( $table_name, array( 'email' => $Email, 'name' => $firstn ) )

    ?>

    <form method="post" action="#"  enctype="multipart/form-data" id="Submitform" >

 <fieldset class="email-form"> 
   <label for="email-form">:</label> 
   <input type="text" name="email-form" id="email-form"  placeholder="Enter Your Email here" />

</fieldset>

  <fieldset class="First-name"> 
  <label for="First-name">:</label> 
  <input type="text" name="First-name" id="First-name"  placeholder="Enter Your Name here" />

 </fieldset>
  <  input type="submit" value="Publish Post" tabindex="40" id="submit" name="submit" class="submitbutton" />
  </form> 
```

但问题是，在每次页面刷新时，它都会在我的 sql 中添加一个条目

因此，当有人加载页面时，它会自动添加空白条目

我怎样才能防止这样做？/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:50:15.003

那是因为您没有检查表单是否先提交。尝试这个：

```
if (!empty($_POST)) {
    $Email = $_POST['email-form'];
    $firstn = $_POST['First-name'];

    global $wpdb;
    $table_name = $wpdb -> prefix . "new_mail_form";
    $wpdb -> insert($table_name, array('email' => $Email, 'name' => $firstn));
} 
```

# java - 频繁刷新页面信息

> ID：15042357
> 
> 赞同：1
> 
> 时间：2013-02-23T15:48:43.223
> 
> 标签：java, spring, jsp, spring-mvc

我是 Spring 和 MVC 的新手，但我有一个问题要解决。我不知道在这种情况下什么是正确的方法。

我有课：

```
public class RandomNumbers
extends TimerTask

{ 
private Random random;
private int actualNumber;

public RandomNumbers(  )
{    
    this.random = new Random();
}

@Override
public void run()
{
    actualNumber =
        random.nextInt( 100 );        
    System.out.println( actualNumber );
}

public int getActualNumber()
{
return actualNumber;
}
} 
```

这很好用。我从这个类和计划任务中创建了新的 bean。例如。每 2s run() 执行一次并生成新的 acutalNumber。我添加了内部控制器：

```
model.addAttribute( "actualNumber", randomNumbers.getActualNumber() ); 
```

这很有效，我在我的jsp页面上打印了actualNumber的第一个值。

问题是：即使生成了新号码（sysout 有效），页面上的信息也不会刷新。我应该如何从 randomNumbers bean 接收新值？例如，我想在“actualNumber”更改时或每 5 秒获取新信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:21:41.470

当用户看到 JSP 页面的输出时，他们只是看到了从页面生成的 HTML。为了使其动态化，浏览器必须“知道”才能获得新值。

例如，您的页面上可能有一些 javascript，它会不断刷新整个页面。你可以这样做：

```
<head>
<script type="text/JavaScript">
function timedRefresh() {   
  setTimeout("location.reload(true);",2000); 
}
</script>
</head>
<body onload="JavaScript:timedRefresh(5000);">
... 
```

您的下一个问题将是：如何获取更新后的值？您的后台进程可以简单地将新值更新为会话变量。然后，该页面可以始终从该会话变量中获取值。

这可能会引发更多问题，但我希望它能让你走上正确的道路。

# xpath - 如何计算 XPath 中特定国家的数量

> ID：15042358
> 
> 赞同：1
> 
> 时间：2013-02-23T15:48:43.797
> 
> 标签：xpath, xpath-2.0

我想计算数据库中俄语国家的数量。我从

```
doc("countries.xml")//country[language="Russian"]/data(@name) 
```

这给了我国家的名字。我知道我必须将“名称”更改为“数字”，但我还能如何获得数字 (6) 而不是他们的名字？我会很感激你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:24:17.707

**使用**：

```
count(doc("countries.xml")//country[language="Russian"]) 
```

**或者，可以使用这个 XPath 2.0 - only 表达式：**

```
(doc("countries.xml")//country[language='Russian']/last())[1] 
```

# java - 排序哈希集

> ID：15042360
> 
> 赞同：2
> 
> 时间：2013-02-23T15:48:59.073
> 
> 标签：java, sorting

我已经编写了一个程序来在 HashSet 中插入数据......这是代码

```
public class Person implements Comparable<Person>
{
    private int person_id;
    private String person_name;
    public Person(int person_id,String person_name)
    {
        this.person_id=person_id;
        this.person_name=person_name;
    }
    /* getter and setter method */
    public boolean equals(Object obj)
    {
        Person p=(Person)obj;
        if(!(p instanceof Person))
        {
            return false;
        }
        else if(this.person_id==p.person_id)
            return true;
        else
            return false;
    }
    @Override
    public int hashCode()
    {
        return person_id*6;
    }
    @Override
    public int compareTo(Person o)
    {
        if(this.person_id>o.person_id)
            return 1 ;
        else if(this.person_id<o.person_id)
            return -1;
        else return 0;
    }
} 
```

我没有粘贴其他两个类。我在这些类中所做的只是填充数据，其他是主类。

现在我明白了，通过 Java Doc Api 我知道 Collections 类中有一个名为 sort() 的方法。现在我的问题是排序方法需要列表。

这是来自文档排序（列表列表）的签名。我在对我的哈希集进行排序时遇到问题。有人告诉我将 HashSet 转换为 TreeSet（其中一个线程中还提到了 stackoverflow）...这是唯一的方法

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T15:50:49.437

几乎是唯一的方法。**`HashSet`从来都不是为了排序。**它不保留您的项目的任何顺序，以换取性能`contains`和操作。`add``remove`

[http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html](http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html)

> 该类实现了由哈希表（实际上是 HashMap 实例）支持的 Set 接口。**它不保证集合的迭代顺序；特别是，它不保证订单会随着时间的推移保持不变**。此类允许空元素。

因此，只需使用`TreeSet`which 根据您的班级的自然顺序进行排序。我看到你的类实现`Comparable`了它很容易在`TreeSet`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-16T10:36:40.883

改为使用**`LinkedHashSet`**，因为它以排序方式插入元素，因此集合始终是排序的。

请参阅[http://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashSet.html](http://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashSet.html)更多信息：

> **Set 接口的哈希表和链表实现，具有可预测的迭代顺序**。此实现与 HashSet 的不同之处在于它维护一个双向链表，该列表贯穿其所有条目。该链表定义了迭代顺序，即元素插入集合的顺序（插入顺序）。请注意，如果将元素重新插入集合中，则插入顺序不受影响。（如果 s.add(e) 被调用，而 s.contains(e) 将在调用之前立即返回 true，则元素 e 被重新插入到集合 s 中。）

# python - Tkinter：按钮打开另一个窗口（并关闭当前窗口）

> ID：15042362
> 
> 赞同：1
> 
> 时间：2013-02-23T15:49:04.867
> 
> 标签：python, graphics, tkinter

我正在创建一个“定义测试”类型的程序（用户输入单词、词性和每个单词的同义词，然后程序就所述信息对用户进行测验）。在最后一个窗口（测验窗口）中，我有一个像这样的窗口布局：

```
1/25 What is the definition of _word_? # number out of total + prompt
Definition: _entry_ # entry fields for information
Part of Speech: _entry_
Next Help Quit # buttons; 'Next' checks the info and goes to the next word 
# 'Help' shows the info and goes to the next word
# 'Quit' force-quits the program
Tries Left: 5 # how many tries before the info is shown 
```

我遇到的问题是“帮助”按钮。正常情况下，只要输入错误信息 5 次，就会成功创建“帮助”窗口；但是，它仍然保持原始单词（无法回答的单词）打开。当这个新窗口关闭时，新词会出现，但是会有两个窗口：新词+旧词。此外，“帮助”按钮本身会引发错误：

```
>>> 

Traceback (most recent call last):
  File _filepath_, line 455, in <module>
    main()
  File _filepath_, line 68, in main
    test(screenDim, test_dict)
  File _filepath_, line 451, in test
    root.destroy()
  File "C:\Python2.7.3\lib\lib-tk\Tkinter.py", line 1728, in destroy
    self.tk.call('destroy', self._w)
TclError: can't invoke "destroy" command:  application has been destroyed 
```

这是我的`test`功能（我修剪了一些代码，以便更容易找到问题）：

```
def test(screenDim, test_dict):
    class TestWords:
        def __init__(self, master):
            w, h = screenDim[0], screenDim[1]
            rootW, rootH, xPos, yPos = int(float(w)/3), int(float(h)/4), w/2 - (w/6), h/2 - (h/8)
            self.frame = Frame(master)
            self.frameB = Frame(self.frame)
            self.frameE = Frame(self.frame)
            self.posE = Entry(self.frameE, width = 50, justify = CENTER)
            self.defE = Entry(self.frameE, width = 50, justify = CENTER)
            self.posE.grid(row = 1, column = 2, pady = 5)
            self.defE.grid(row = 2, column = 2, pady = 5)
            # there are a few other widgets/frames that don't pertain to this problem
            self.goButton = Button(self.frameB, text = 'Next', command = self.getInfo, width = 10)
            self.helpButton = Button(self.frameB, text = 'Help', command = self.getHelp, width = 10)
            self.quitButton = Button(self.frameB, text = 'Quit', command = self.quitBox, width = 10, fg = 'red')
            self.goButton.grid(row = 1, column = 1, padx = 10)
            self.helpButton.grid(row = 1, column = 2, padx = 10)
            self.quitButton.grid(row = 1, column = 3, padx = 10)
            master.geometry("%sx%s+%s+%s" % (rootW, rootH, xPos, yPos))
            self.frameE.grid(row = 3, pady = 5)
            self.frameB.grid(row = 4, padx = rootW/4 - 60, pady = 5)
            self.frame.grid()
        def quitBox(self):
            import sys
            sys.exit('Program Terminated.')
        def getHelp(self):
            triesLeft = 0
            self.frame.quit()
            root.destroy()
        def getInfo(self):
            info = (self.posE.get(), self.defE.get())
            self.frame.quit()
            return info
    class GetHelp:
        def __init__(self, master):
            w, h = screenDim[0], screenDim[1]
            rootW, rootH, xPos, yPos = int(float(w)/4), int(float(h)/4), w/2 - (w/8), h/2 - (h/8)
            self.frame = Frame(master)
            self.frameB = Frame(self.frame)
            self.goButton = Button(self.frameB, text = 'Next', command = self.frame.quit, width = 10)
            self.quitButton = Button(self.frameB, text = 'Quit', command = self.quitBox, fg = 'red', width = 10)
            self.goButton.grid(row = 1, column = 1, padx = 5)
            self.quitButton.grid(row = 1, column = 2, padx = 5)
            self.frameB.grid(row = 2, padx = rootW/4 - 20, pady = 5)
            master.geometry("%sx%s+%s+%s" % (rootW, rootH, xPos, yPos))
            self.frame.grid()
            # again, a few widgets were removed for brevity
        def quitBox(self):
            import sys
            sys.exit('Program Terminated.')
    n, words, reviewWords = len(test_dict.keys()), test_dict.keys(), []
    shuffle(words)
    for i in range(n):
        word, triesLeft = words[i], 4
        while triesLeft >= 0:
            root = Tk(className = ' Definition Tester')
            root.columnconfigure(0, weight=1)
            root.rowconfigure(0, weight=1)
            app = TestWords(root)
            root.mainloop()
            try:
                info = app.getInfo()
            except TclError:
                info = ('', '')
            if info[0] == test_dict[word][0] and info[1] in test_dict[word][1]:
                del words[i]
                root.destroy()
                break
            elif triesLeft == 0:
                reviewWords.append(word)
                root = Tk(className = ' Definition Tester')
                root.columnconfigure(0, weight=1)
                root.rowconfigure(0, weight=1)
                app = GetHelp(root)
                root.mainloop()
                break
            else:
                triesLeft -= 1
                root.destroy() 
```

剩余 0 次尝试后，程序会自动显示帮助窗口。因此，“帮助”按钮设置`triesLeft`为 0。但是，这似乎并没有打开窗口。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:46:44.550

您需要重新设计您的解决方案，以便您只创建一个根窗口并且只运行一个`mainloop`. 与其一遍又一遍地创建和销毁根窗口，不如创建和销毁`Toplevel`. Tkinter 根本不是为了创建和销毁多个根窗口而设计的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-12T12:42:32.467

您必须更改 tkinter 变量并退出函数中的当前窗口，然后再打开另一个

```
def new_window():
    current_tkinter_variable.quit()
    new_variable=Tk()
    #carry on 
```

# html - CSS3背景大小和背景位置问题

> ID：15042370
> 
> 赞同：4
> 
> 时间：2013-02-23T15:49:24.147
> 
> 标签：html, css, background-position

我正在编写一个小的 WP 主题，需要一些新的 CSS3 background-size 属性的帮助。

我有一个包含图像作为背景的 DIV。图像本身被设置为大于 div 以呈现原始图像的一个小切口：

```
.imageContainer {
    background-size:154% 102%;
    background-position-x:-28%;
    background-position-y:0.28%;
} 
```

到目前为止一切都很好。但是如果大小≥ 100%，调用 background-position 属性会变得很棘手。我整理了一些 JS/CSS Playground 进行测试：

*   如果图像的宽度 ≤ 99%，则较少的 background-position-x 意味着图像向左移动。
*   如果图像 == 100% 宽，则 background-position-x 什么都不做
*   如果图像 ≥ 101% 宽，较少的 background-position-x 意味着图像向右。

对于以下情况，我计算了：

*   大容器：350x350px
*   图片：540x359 像素
*   表示：(100/350) * 540 ≙ 154% 宽度
*   (100/350) * 359 ≙ 102% 高度。
*   另外：位置-x：-28% 和位置-y：-0.28%

所以我渲染了一个页面（包括自动计算）并且大小大约是正确的大小。但正如我所说，较少的 background-position-x (-28%) 意味着图像正确，图像位置错误。

它必须向左移动，因为我计算了 -28% 的“左边距”。所以我做了一些试验和错误，结果发现正确的位置应该在 50% 左右。

这仍然是一个 CSS3 问题，还是我完全误解了这个属性的功能？

**编辑：** [这里也是一个 JSFiddle](http://jsfiddle.net/FJ3Ub/)

这是一张图片来说明我的目标…… ![在此处输入图像描述](../Images/6b4ac12ac72825004f75e7994000acad.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T19:39:14.563

您的问题的关键是您指定的百分比给出了容器和图像**匹配**的点。这个点是在图像和容器中计算的。

因此，如果您希望图像居中，则意味着图像的中心位于容器的中心。因此，这是您通过反复试验找到的值。

这里的关键是 50%，因为 background-position**总是**让图像居中，你不需要任何计算

如果您为该属性指定 10%，则意味着图像中距左侧 10% 的点位于距容器左侧距 10% 的点处。

**这个公式**

如何从百分比转换为 px（根据要求）。假设您有一个大小**为 n**的容器，并且图像大了**f**倍您指定了**x** % 的背景位置。我们把它作为一个单位因子**a**是**a=x*100**

容器中要匹配的位置**是**. 图像中要匹配的位置是**afn**。容器中图像的位置是差异**afn-an**，可以给出为**an(f-1)**。

这就解释了为什么：

当 f > 1 时，该属性的明显结果被反转。（图像比容器大。

当 f = 1 时结果为 nil（图像与容器大小相同）

现在要将其转换为空间百分比，您只需除以容器的大小（**n**）即可

**a(f-1)**

或除以图像的大小**(fn)**得到

**a(f-1)/f**

# java - 整个计算机的真正单例？

> ID：15042373
> 
> 赞同：0
> 
> 时间：2013-02-23T15:49:48.787
> 
> 标签：java, single-instance

如何用 Java 为整台计算机创建一个真正的单例？

我有一个用 Java 编写的控制台应用程序。如果应用程序第二次执行，我希望它知道主应用程序已经在运行（并正在执行作业）。第二次执行将只允许用户查询数据（作业）。我知道我可以创建一个文件并将所有内容写入其中，但是我还必须支持计算机重置等。

有更好的方法吗？

总结一下：

*   我启动应用程序。它有作业并以想要的间隔执行它们。
*   我第二次启动应用程序。我收到作业已经在运行的消息，我可以从第一个应用程序查询数据。
*   第三次启动应用程序，它的工作方式与第二次相同。
*   如果我停止第一个实例并启动一个新实例，它就像第一个实例一样工作。

PS 我确实知道这个问题一定被问过不止一次，但谷歌和 StackOverflow 搜索只给我与单例设计模式相关的链接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T15:58:47.070

[这](http://www.rbgrn.net/content/43-java-single-application-instance)是一个链接，可以做你想做的事。

这提供了一个在启动时绑定到套接字的代码示例，然后如果在启动时绑定了某些东西，那么它会发送一条消息

您可以使用它在您的进程之间进行通信。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T15:56:30.150

正如评论中提到的@PaulTomblin，您可能应该将服务器套接字绑定到特定端口。这有两个目的。如果端口当前未绑定，则正在运行的进程成为主实例。如果端口已经绑定，那么正在运行的进程将成为客户端，而是连接到端口以便与主实例通信。

# javascript - JQuery：如何检查元素是否只有这个类，没有其他类？

> ID：15042374
> 
> 赞同：2
> 
> 时间：2013-02-23T15:49:50.757
> 
> 标签：javascript, jquery, class, select

我正在尝试想出一种选择元素 2 的方法。

```
<div class="wrapper">
    <div class="qe datepicker">Element 1</div>
    <div class="qe">Element 2</div>
    <div class="qe fileuploader">Element 3</div>
    <div class="qe fileuploader datepicker">Element 4</div>
</div> 
```

虽然我没有测试过这段代码，但我可以做这样的事情，但这有点愚蠢，我想要一个更通用的方法：

```
var wanted_elements = $('.wrapper').children('.qe').not('.datepicker').not('.fileuploader'); 
```

对此有什么想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T15:53:18.977

```
$(".wrapper").children("[class=qe]") 
```

更改选择器以匹配`class`等于的元素`"qe"`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T15:55:48.950

您可以使用属性选择器来做到这一点：

```
$('.wrapper>[class=qe]') 
```

演示：http: [//jsfiddle.net/ZdNaf/](http://jsfiddle.net/ZdNaf/)

# c++ - 几个 std::atomic 的条件

> ID：15042379
> 
> 赞同：4
> 
> 时间：2013-02-23T15:50:10.240
> 
> 标签：c++, multithreading, c++11, atomic

在我的多线程应用程序中，我有一个可以简化为这个例子的条件

```
std::atomic<bool> a, b;
// ...
if ( a.load() && b.load() )
{
   // ...
} 
```

显然，在条件之后，a 和 b 可以保持不同的值。

在我的应用程序中，它认为，如果两个值同时为真，它们就不能再改变状态。但是在`a.load()`返回之后`true`，它甚至可能在`b.load()`评估之前改变它的值。

是否有一个*优雅*的解决方案来原子地评估这个语句？显然，锁定 a.store(..) 和 b.store(..) 的每次调用都可以在这里工作，但这远非好事。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T15:52:21.510

您是否考虑过使用 an`atomic<int>`并为 bools 设置位？这将允许您以原子方式查询两者。

# android - 日期更改事件仅在日期增加时触发，而不是在减少时触发

> ID：15042382
> 
> 赞同：2
> 
> 时间：2013-02-23T15:50:22.627
> 
> 标签：android

```
public class AlarmReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {

        if(Intent.ACTION_DATE_CHANGED.equals(intent.getAction())){
            AlarmUtility alarmUtility = new AlarmUtility();
            alarmUtility.setAlarm(context.getApplicationContext());
            Toast.makeText(context, "Date Changed !!!!!!!!!!", 10000).show();
        }
      }
} 
```

将日期更改为明天会触发事件，但再次将其减少到今天不会触发任何事件。

我做错什么了吗？请帮忙。提前致谢。

# c - 从 ac 应用程序中获取所有方法

> ID：15042388
> 
> 赞同：2
> 
> 时间：2013-02-23T15:50:48.393
> 
> 标签：c

对于任何 c 应用程序（在这种情况下假设为 apache），我想返回所有方法的列表以及在其中找到它们的文件。例如，我希望看到如下内容：

```
int add (int a, int b)..... math.c
int subtract (int a, int b)..... math.c
int Multiply (int a, int b)..... math.c
int foo ()..... foo.c 
```

我想这样做并避免手动解析物理 c 文件以获取方法输出的繁琐任务。我知道其他语言有反射器。

谢谢大家。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T15:55:32.050

人纳米（1）

但是，只有在 (-g) 中编译了调试信息时，符号源文件才可用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T15:55:40.280

您没有指定平台，因此一种可能的解决方案是“ctags”程序：

> 说明 ctags 实用程序应在支持用户可移植性实用程序选项、软件开发实用程序选项以及 C 语言开发实用程序选项和 FORTRAN 开发实用程序选项中的一个或两个的系统上提供。在其他系统上，它是可选的。
> 
> ctags 实用程序应从路径名操作数指定的 C 语言或 FORTRAN 源文件中写入标签文件或对象索引。标签文件应列出源文件中特定语言对象的定位器。定位器由名称、路径名以及可用于搜索对象定义的搜索模式或行号组成。应识别的对象在扩展描述部分中指定。
> 
> 选项 ... -x 生成对象名称列表、行号和定义每个对象的文件名，以及该行的文本，并将其写入标准输出。指定 -x 时不应创建标签文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-23T15:55:56.097

你可以用[ctags](http://ctags.sourceforge.net/whatis.html)做到这一点。从网站：

> Ctags 生成在源文件中找到的语言对象的索引（或标记）文件，允许文本编辑器或其他实用程序快速轻松地找到这些项目。标记表示可以使用索引条目的语言对象（或者，为该对象创建的索引条目）。

Ctags[与多种工具兼容](http://ctags.sourceforge.net/tools.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-23T16:00:08.980

听起来像是链接器的工作。您是否尝试过生成地图文件？检查您的链接器文档以了解如何生成映射文件。

# java - 警告出现多次

> ID：15042392
> 
> 赞同：0
> 
> 时间：2013-02-23T15:50:59.927
> 
> 标签：java, eclipse, swing, warnings, capslock

只是一个简单的问题，如果我保持大写锁定它会出现警告消息 3 次？我只希望它出现一次

```
 jButton1.addActionListener(new ActionListener() {
               @SuppressWarnings("deprecation")
               public void actionPerformed(ActionEvent evt) {
                  for( int i=0; i < users.size(); i++ ){
                     temp = (logins)users.elementAt(i);
                     if( Toolkit.getDefaultToolkit().
                        getLockingKeyState(KeyEvent.VK_CAPS_LOCK))
                     {
                        check = "true";
                        {
                           JOptionPane.showMessageDialog(
                              null, "Please turn off the capslock", "Error",
                              JOptionPane.ERROR_MESSAGE );
                        }
                     }
                  }
               }
            });
            pack();
            this.setSize(643, 434);
         }
         catch (Exception e) {
         e.printStackTrace();
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:57:28.057

你已经完成了

```
check = true; 
```

但从未检查过，将其添加到`if`

```
if( Toolkit.getDefaultToolkit().getLockingKeyState(KeyEvent.VK_CAPS_LOCK)
   && ! check )
{
   check = "true";
   ... 
```

**或者，更好的是，将其放在循环之外，因为 的条件`if`不使用迭代的数据......**

# cocoa - 在圆形 NSView 的顶部绘制弯曲的高光色调，类似于使用 Quartz Composer UI 看到的效果

> ID：15042394
> 
> 赞同：3
> 
> 时间：2013-02-23T15:51:12.207
> 
> 标签：cocoa, core-graphics, nsview, quartz-graphics

我一直在玩一个自定义视图，它看起来像 Quartz 作曲家的补丁对象。我的假 Quartz Composer 视图看起来不错。这是一个单一的视图，具有 2 个不同的线性渐变、一个阴影和顶部的一条高光线，

![假 Quartz Composer 用户界面。](../Images/c3f69b8b810134ee7690ddcd156bb45f.png "假 Quartz Composer 用户界面")

我想将其扩展为圆角。这对于渐变等非常简单，但是，我不确定如何沿着视图顶部绘制弯曲的高光。例如，查看真实的 Quartz Composer UI，

![真正的 Quartz Composer 用户界面。](../Images/30cb8422767710c53fde3c49d189f001.png "真正的 Quartz Composer 用户界面")

我一直在尝试使用一种基于`CGContextReplacePathWithStrokedPath()`. 我的目标是绘制弯曲路径（顶部突出显示），将路径转换为“描边路径”，然后用渐变填充生成的路径。但是，当我尝试这样做时，这种方法（至少是我的代码）实际上并没有绘制*任何东西。*

一些示例代码来显示该方法。**请注意**，该`CGPathCallback`函数来自[NSBezierPath+MCAdditions](https://github.com/fileability/Ingredients/blob/master/NSBezierPath+MCAdditions.m)（我找不到代码的原始作者，但如果您搜索它会在很多地方出现）。

```
- (void)drawRect:(NSRect)dirtyRect
{
    /* Make any line you like */
    CGContextRef context = [[NSGraphicsContext currentContext] graphicsPort];
    CGMutablePathRef centerline = CGPathCreateMutable();
    CGContextSetLineWidth(context, 10.);
    CGPathMoveToPoint(centerline, NULL, NSMinX(dirtyRect), NSMidY(dirtyRect));
    CGPathAddLineToPoint(centerline, NULL, NSMaxX(dirtyRect), NSMidY(dirtyRect));
    CGContextAddPath(context, centerline);

    /* Make a line "fill-able" */
    CGContextReplacePathWithStrokedPath(context);

    /* Clip to this line (maybe not required?)*/
    CGContextClip(context);

    /* Convert to a NSBezierPath */
    NSBezierPath *centrePath = [NSBezierPath bezierPath];
    CGPathApply(centerline, (__bridge void *)(centrePath), CGPathCallback);

    /* Finally fill the line with the gradient */
    NSGradient *lineGradient = [[NSGradient alloc] initWithStartingColor:[NSColor redColor] endingColor:[NSColor greenColor]];
    [lineGradient drawInBezierPath:centrePath angle:-90];
} 
```

**问**：沿着曲线绘制这样的高光最好的方法是什么，你会选择这种方法吗（这实际上不起作用！）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T03:18:08.423

实现您想要的效果的一种方法是使用贝塞尔路径缠绕规则。按照您的示例，此代码有效：

```
NSBezierPath* path = [ NSBezierPath bezierPathWithRoundedRect: dirtyRect xRadius: 5 yRadius: 5 ];
dirtyRect = NSInsetRect( dirtyRect, 2, 2 );
[ path appendBezierPathWithRoundedRect: dirtyRect xRadius: 3 yRadius: 3 ];
[ path setWindingRule: NSEvenOddWindingRule ];

/* Finally fill the line with the gradient */
NSGradient *lineGradient = [[NSGradient alloc] initWithStartingColor:[NSColor redColor] endingColor:[NSColor greenColor]];
[lineGradient drawInBezierPath:path angle:-90]; 
```

NSevenOddWindingRule 允许您在未绘制的路径上打一个洞。为了达到最终效果，您可以将渐变从半透明白色变为完全透明的白色，并根据矩形的大小计算所需的端点。例如，这与您的原始图像接近：

```
NSBezierPath* path = [ NSBezierPath bezierPathWithRoundedRect: dirtyRect xRadius: 5 yRadius: 5 ];
dirtyRect = NSInsetRect( dirtyRect, 2, 2 );
[ path appendBezierPathWithRoundedRect: dirtyRect xRadius: 3 yRadius: 3 ];
[ path setWindingRule: NSEvenOddWindingRule ];

/* Finally fill the line with the gradient */
CGFloat heightOfHilight = 8;
CGFloat endLocation = heightOfHilight / dirtyRect.size.height;
NSGradient *lineGradient = [[NSGradient alloc] initWithColorsAndLocations:
        [NSColor colorWithCalibratedWhite: 1.0 alpha: 0.5], 0.0,
        [NSColor colorWithCalibratedWhite: 1.0 alpha: 0.0], endLocation,
        nil ];
[lineGradient drawInBezierPath:path angle:-90]; 
```

# ruby - 在 Google Drive API 中收到错误 403 - 已超出未经验证使用的每日限制。继续使用需要注册

> ID：15042399
> 
> 赞同：4
> 
> 时间：2013-02-23T15:51:40.287
> 
> 标签：ruby, google-api, google-drive-api, google-api-client, google-api-ruby-client

我正在使用用于 ruby​​ 的 Google Drive API，并且正在尝试将文件插入到用户驱动器中。我可以成功插入文件，但是当我尝试获取文件 Self Link 时，这是返回的 URL [https://www.googleapis.com/drive/v2/files/1PxrbKaO2xwOonUO0TB0FO3pkZDnSmRKTvIUmXw0vL6w](https://www.googleapis.com/drive/v2/files/1PxrbKaO2xwOonUO0TB0FO3pkZDnSmRKTvIUmXw0vL6w)，表示我已经超过未经身份验证的请求数。

好吧，我很确定我已通过身份验证，因为我遵循了所有教程并且代码几乎相同。

任何人都知道为什么会这样？为什么我可以插入文件，但不能查看它的自我链接？

这是在用户允许应用程序离线访问后在驱动器中创建文档的代码：

```
SCOPES = [
              'https://www.googleapis.com/auth/drive',
              'https://www.googleapis.com/auth/userinfo.email',
              'https://www.googleapis.com/auth/userinfo.profile'
          ]

class DriveAuthenticator

    def self.create_document(user, title, description, parent_title, user_array)
        client = DriveAuthenticator.initiate_client
        if user.google_id.present?
            if DriveAuthenticator.authenticate_client client, user
                parent_id = get_parent_id client, parent_title
                file_data = insert_empty_file client, title, description, DOCUMENT_MIME_TYPE, parent_id
                return file_data.selfLink
            end
        end
    end

    private
    def self.initiate_client
        client = Google::APIClient.new(:application_name => 'stuff_app')

        credentials = Google::APIClient::ClientSecrets.load

        client.authorization.client_id = credentials.client_id
        client.authorization.client_secret = credentials.client_secret
        client.authorization.redirect_uri = credentials.redirect_uris.first
        client.authorization.scope = SCOPES
        client
    end

    private
    def self.get_token_by_refresh_token(client, refresh_token)
        client.authorization.refresh_token = refresh_token
        client.authorization.grant_type = 'refresh_token'
        client.authorization.fetch_access_token!
    end

    private
    def self.insert_empty_file(client, title, description, mime_type, parent_id)
        drive = client.discovered_api('drive', 'v2')
        file = create_file_schema drive, title, description, mime_type, parent_id
        result = client.execute(
          :api_method => drive.files.insert,
          :body_object => file)
        if result.status == 200
            result.data
        else
            puts "An error occurred: #{result.data['error']['message']}"
            nil
        end
    end

    private
    def self.create_file_schema(drive, title, description, mime_type, parent_id)
        file = drive.files.insert.request_schema.new({
            'title' => title,
            'description' => description,
            'mimeType' => mime_type
        })
        file.parents = [{'id' => parent_id}]
        file
    end

end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T21:04:44.887

您是否尝试在浏览器中打开该网址？文件自链接仍然需要授权才能访问，您应该向该 URL 发送授权的 GET 请求以检索其元数据。

Google Drive SDK 文档中的参考指南展示了如何获取文件元数据和内容：

[https://developers.google.com/drive/v2/reference/files/get](https://developers.google.com/drive/v2/reference/files/get)

另请查看文档以获取有关如何从云端硬盘下载文件的指导，包括如何在浏览器中打开文件：

[https://developers.google.com/drive/manage-downloads](https://developers.google.com/drive/manage-downloads)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-02T04:29:27.063

即使我遇到了同样的错误，然后我用[https://www.googleapis.com/auth/drive.file](https://www.googleapis.com/auth/drive.file)替换了我的范围，然后它开始正常工作。尝试替换您的范围或将此范围添加到您的范围列表中。希望这对你有用。

-丹努什

# c - 在不同函数中初始化指针（malloc）时出现分段错误

> ID：15042401
> 
> 赞同：0
> 
> 时间：2013-02-23T15:51:48.960
> 
> 标签：c, tree, malloc

我正在尝试通过这样做来初始化一棵树：

```
typedef struct {
    char *value;
    struct children_list *children;
} tree;

typedef struct t_children_list {
    tree *child;
    struct t_children_list *next;
} children_list;

void initializeTree(tree *root, char *input)
{
  if((root = malloc(sizeof(tree))) == NULL) { abort(); }
  root->value = input;
}

void main()
{
  // Create the tree
  char *input = "aaaaaa";
  tree *my_tree = NULL;

  initializeTree(my_tree, input);
} 
```

但是我遇到了分段错误。为什么会这样？我正在传递一个指向函数的指针，并在其中保留内存。那是错的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:56:12.407

指针“my_tree”按值传递（这是在 C 中完成的唯一方法）

所以 my_tree 基本上是复制的，并且没有分配 'root' 对 'my_tree' 变量有任何影响。

你想得到一个指针，所以将一个指针传递给一个指针（**），然后初始化 *root 来实际修改我的树

```
void initializeTree(tree **pRoot, char *input)
{
  if((*pRoot = malloc(sizeof(tree))) == NULL) { abort(); }
  *pRroot->value = input;
}

void main()
{
  // Create the tree
  char *input = "aaaaaa";
  tree *my_tree = NULL;

  initializeTree(&my_tree, input);
} 
```

或者根本不通过它，而是返回它：

```
tree *initializeTree(char *input)
{
  tree *root = NULL;
  if((root = malloc(sizeof(tree))) == NULL) { abort(); }
  root->value = input;
  return root;
}

void main()
{
  // Create the tree
  char *input = "aaaaaa";
  tree *my_tree = initializeTree(input);
} 
```

# jquery - 如何读取和显示json数据

> ID：15042402
> 
> 赞同：0
> 
> 时间：2013-02-23T15:52:02.523
> 
> 标签：jquery, json

我有以下 json 数据。

```
{
  "movies": [{
  "id": "770687943",
  "title": "Harry Potter and the Deathly Hallows - Part 2",
  "year": 2011,
  "mpaa_rating": "PG-13",
   "runtime": 130,
   "critics_consensus": "Thrilling, powerfully acted, and visually dazzling, Deathly Hallows Part II brings the Harry Potter franchise to a satisfying -- and suitably magical -- conclusion.",
  "release_dates": {"theater": "2011-07-15"},
  "ratings": {
  "critics_rating": "Certified Fresh",
  "critics_score": 97,
  "audience_rating": "Upright",
  "audience_score": 93
},
"synopsis": "Harry Potter and the Deathly Hallows - Part 2, is the final adventure in the Harry Potter film series. The much-anticipated motion picture event is the second of two full-length parts. In the epic finale, the battle between the good and evil forces of the wizarding world escalates into an all-out war. The stakes have never been higher and no one is safe. But it is Harry Potter who may be called upon to make the ultimate sacrifice as he draws closer to the climactic showdown with Lord Voldemort. It all ends here. -- (C) Warner Bros",
"posters": {
  "thumbnail": "http://content8.flixster.com/movie/11/15/86/11158674_mob.jpg",
  "profile": "http://content8.flixster.com/movie/11/15/86/11158674_pro.jpg",
  "detailed": "http://content8.flixster.com/movie/11/15/86/11158674_det.jpg",
  "original": "http://content8.flixster.com/movie/11/15/86/11158674_ori.jpg"
},
"abridged_cast": [
  {
    "name": "Daniel Radcliffe",
    "characters": ["Harry Potter"]
  },
  {
    "name": "Rupert Grint",
    "characters": [
      "Ron Weasley",
      "Ron Wesley"
    ]
  },
  {
    "name": "Emma Watson",
    "characters": ["Hermione Granger"]
  },
  {
    "name": "Helena Bonham Carter",
    "characters": ["Bellatrix Lestrange"]
  },
  {
    "name": "Ralph Fiennes",
    "characters": ["Lord Voldemort"]
  }
],
"alternate_ids": {"imdb": "1201607"},
"links": {
  "self": "http://api.rottentomatoes.com/api/public/v1.0/movies/770687943.json",
  "alternate": "http://www.rottentomatoes.com/m/harry_potter_and_the_deathly_hallows_part_2/",
  "cast": "http://api.rottentomatoes.com/api/public/v1.0/movies/770687943/cast.json",
  "clips": "http://api.rottentomatoes.com/api/public/v1.0/movies/770687943/clips.json",
  "reviews": "http://api.rottentomatoes.com/api/public/v1.0/movies/770687943/reviews.json",
  "similar": "http://api.rottentomatoes.com/api/public/v1.0/movies/770687943/similar.json"
}
}],
 "links": {
  "self": "http://api.rottentomatoes.com/api/public/v1.0/lists/movies/box_office.json?limit=1&country=us",
  "alternate": "http://www.rottentomatoes.com/movie/box_office.php"
 },
"link_template":  "http://api.rottentomatoes.com/api/public/v1.0/lists/movies/box_office.json?limit={num-results}&country={country-code}"
} 
```

从上面的 json 输出中我唯一需要的是`image`内部`poster`对象名为`profile`. 第二`title`。第三个评级即`critics_score`和`audience_score`哪些在`rating`对象内部。我使用`underscorejs`模板引擎阅读本文的方式如下

```
<% _.each(movies, function(movie) { %>
<% var imdb_id; %>
<div class="boxone">
    <% _.each(movie, function (poster) { %>
        <img class="poster" src="<%= poster.profile %>" />
    <% }); %>
    <h4><%= movie.title %></h4>
    <p>
        <span>Up vote: </span>
        <% _.each(movie, function (rating) { %>
            <%= rating.audience_score %>
        <% }); %>
    </p>

    <p>
        <span>Down vote: </span>
        <% _.each(movie, function (rating) { %>
            <%= rating.critics_score %>
        <% }); %>
    </p>

    <p>
        <% _.each(movie, function (alternate_ids) { %>
            <% imdb_id = alternate_ids.imdb; %>
            <%= imdb_id %>
        <% }); %>
        <span>ID: </span><%= imdb_id %>
        <a href="http://www.imdb.com/title/tt<% imdb_id %>">IMDB</a>
    </p>

</div>
<% }); %> 
```

**问题**

我当前代码的问题是，当我想在对象`profile`内部读取和显示图像时，我首先使用内部函数，然后它会创建几个空的 img 标签。每个函数中的其他两个也是如此。**如果是的话，有没有更好的方法来读取上面的json数据？**`poster``each()`

# asp.net-mvc - 每个应用程序的 Unity 和多个 EF 上下文

> ID：15042408
> 
> 赞同：2
> 
> 时间：2013-02-23T15:52:31.230
> 
> 标签：asp.net-mvc, entity-framework, unity-container

我们目前将 Unity 用于我们的 Windows 服务和 MVC 应用程序，它运行良好。我们为每个 Web 请求创建一个 ChildContainer 并将 DbContext 注入定义为分层的，因此每个 Web 请求都有自己的上下文实例。我们还有一个 BaseDbContext 类，它确保 EF 设置在我们所有的上下文中都是一致的。

到目前为止，一切都很好。现在的问题是添加了第二个数据库，因此，第二个上下文也继承自 BaseDbContext。

我们不能配置 Unity 来注入不同的上下文，因为基类是相同的。

我们找到的解决方案是创建一个*ContextProvider where T : BaseDbContext*并将其注册到 Unity 中，这样我们就可以通过类型来区分上下文。

但是，这似乎不对，因为 Unity 应该能够处理这种情况。

有什么建议的方法来处理这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T12:04:26.267

您可以使用命名注册进行两个相同类型的注册：

```
Container
  .RegisterType<BaseDbContext>("context1", ...)
  .RegisterType<BaseDbContext>("context2", ...) 
```

并且，在客户端代码中：

```
public void MyClass {

   public MyClass([Dependency("context1")] BaseDbContext context1, 
                  [Dependency("context2")] BaseDbContext context2) {
         ....
   }
} 
```

# javascript - javascript：获取印度的日期和时间（不是个人计算机的日期和时间）

> ID：15042412
> 
> 赞同：1
> 
> 时间：2013-02-23T15:53:00.510
> 
> 标签：javascript, datetime

如何在 Javascript 中获取印度的日期和时间？它不应该采用计算机的日期和时间，而应该采用标准世界时区，而不采用个人计算机的时间参考。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:10:26.413

您可以向服务器发出 ajax 请求并返回时间：

html

```
<p>The time is <span id="time"></span></p> 
```

JS

```
var time = document.getElementById('time');

time.innerHTML = getTime();

function getTime(){
    var xmlHttp;
    try {
        //FF, Opera, Safari, Chrome
        xmlHttp = new XMLHttpRequest();
    }
    catch (err1) {
        //IE
        try {
            xmlHttp = new ActiveXObject('Msxml2.XMLHTTP');
        }
        catch (err2) {
            try {
                xmlHttp = new ActiveXObject('Microsoft.XMLHTTP');
            }
            catch (eerr3) {
                //AJAX not supported, use CPU time.
                alert("AJAX not supported");
            }
        }
    }
    xmlHttp.open('HEAD',window.location.href.toString(),false);
    xmlHttp.setRequestHeader("Content-Type", "text/html");
    xmlHttp.send('');
    return xmlHttp.getResponseHeader("Date");
} 
```

这是一个 js 小提琴：http: [//jsfiddle.net/A8vxa/](http://jsfiddle.net/A8vxa/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T15:56:14.747

那是不可能的。Javascript 知道计算机的日期/时间，但如果它与当前时区不对应，则 Javascript 无法检测到。

但是，有用于 Date 对象的 UTC API，因此如果 OP 愿意信任客户端时钟，则可以这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T16:10:48.990

Javascript 是一种客户端语言。它在用户系统上执行，因此 datetime 对象保存用户系统时间。但是 Javascript 可以进行 HTTP 调用，并且只能对服务器进行调用。

您可以拨打[Working Demo](http://jsfiddle.net/HU5qj/)的电话：

`http://json-time.appspot.com/time.json?tz=GMT`

你会得到响应（在浏览器中打开）：

```
{
  "tz": "GMT", 
  "hour": 16, 
  "datetime": "Sat, 23 Feb 2013 16:07:44 +0000", 
  "second": 44, 
  "error": false, 
  "minute": 7
} 
```

这是格林威治标准时间。但是由于它正在调用某个服务器，因此您的代码取决于该服务器功能，您可以创建您的服务器并相应地处理请求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T18:04:58.917

您可以将最近和未来时间的 UTC 时间增加 5 个半小时 - 印度目前没有 DST，只有一个时区。

假设您可以从客户端获取 UTC：

```
function IndiaTime(D){
    D= D || new Date();
    D.setUTCMinutes(D.getUTCMinutes()+330);

    var A= [D.getUTCHours(), D.getUTCMinutes(), D.getUTCSeconds()];
    if(A[1]<10) A[1]= '0'+A[1];
    if(A[2]<10) A[2]= '0'+A[2];
    return A.join(':');
}

alert(IndiaTime()) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-04T18:15:17.587

如果您使用 Node 和 NPM 进行开发，您可以使用这个包： [https](https://www.npmjs.com/package/ez-local-time) ://www.npmjs.com/package/ez-local-time 它包含所有世界时区，因此您始终可以通过编程方式获取印度的日期和时间.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-23T07:52:31.933

在php上创建一个函数

```
public function ajax_getDate()
{
    ini_set("date.timezone", "Asia/Kolkata");
    echo json_encode(date('F d, Y h:i:s A')); 

    //you can use any date format you want check http://php.net/manual/en/function.date.php
} 
```

然后使用ajax检索数据..

```
$.ajax({
    url : url + "ajax_getDate",
    type: "GET",
    dataType: "JSON",
    success: function(data)
        {
          date = data;
          // do something
        }
}); 
```

# mongodb - 有 YAML 数据库吗？

> ID：15042413
> 
> 赞同：22
> 
> 时间：2013-02-23T15:53:06.807
> 
> 标签：mongodb, yaml, database

我非常喜欢 YAML 的数据模型，它保留了 JSON 的大部分简单性，并使用一些有时很重要的特性（例如自定义数据类型和引用）对其进行了扩展。

那么有没有什么方法可以在 YAML 数据模型（或非常类似的东西）中存储大量数据并使用索引进行查询？类似于 YAML 数据库，类似于[XML 数据库](http://en.wikipedia.org/wiki/XML_database)或 Mongo DB 等 JSON 数据库。或者是否有一个从 YAML 到 Mongo DB 之类的映射器，可以让我透明地将它用作 YAML 存储？

我没有找到任何东西，所以也许没有。为什么会这样？这是一个愚蠢的想法还是 YAML 太年轻而他们会来？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-02T23:44:24.397

> 或者是否有一个从 YAML 到 Mongo DB 之类的映射器，可以让我透明地将它用作 YAML 存储？

据我所知，不是直接的。

主要问题似乎是 Mongo DB 的接口基于散列（即键值对）。所以本质上你是在问是否有从 YAML 到哈希的映射器。答案并不简单，因为 YAML 可以存储任意结构，而哈希则不能。

但是，如果您愿意简化对象，则可以部分执行此操作：

```
class SomeObject
  def initialize
    @bob = 'abc'
    @fred = 'cde'
  end

  def to_hash
    h = {}
    instance_variables.sort.each do |v|
    h[v] = instance_variable_get(v)
  end
  return h
end 
```

如果您查看 to_yaml 代码，您会发现它与 to_hash 方法非常相似（因为这是我的想法）。

请注意，您可能还需要一个 from_hash 方法。你可能想开始为具有对象实例变量的类制定一个方案（即不仅仅是字符串、符号等）

现在插入项目的 mongo 代码：

```
include Mongo
db = MongoClient.new.db('test')
stuff = db.collection('stuff')
item = SomeClass.new()
... other code ...
stuff.insert(item.to_hash) 
```

我意识到这并不能直接回答您的问题，但希望它仍然有帮助。

约翰

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-01-27T21:51:28.373

更新话题，看看：[http](http://blog.varunajayasiri.com/yamldb) ://blog.varunajayasiri.com/yamldb 。

“YAML 数据库是一个文档数据库，将文档存储为 YAML 文件。只需编辑 yaml 文件即可维护数据库中的文档。

该数据库被设计用于像 CMS 系统这样的系统，在这些系统中，需要一种简单的方法来编辑数据并且数据对象的数量不是很多。它还可用于存储设置和配置。

将数据库存储为单独的文件可以让您在数据库上使用 git 等版本控制系统，这也是存储设置、配置、博客文章和 CMS 内容的理想选择。”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-18T19:07:24.060

`Yaml`而是用于配置目的。它不用于 MongoDB 等数据库，因为序列化时间比`json`. 事实上，json 不是 yaml 的子集（虽然很接近）。`Json`库通常更快：[stackoverflow.com/questions/2451732/](https://stackoverflow.com/users/627042/erik-aronesty) ...。

> 如果需要考虑互操作性和速度，请使用 JSON。—— [埃里克·阿罗内斯蒂](https://stackoverflow.com/users/627042/erik-aronesty)

# windows - 通过 curl 命令行发送到 github (Windows)

> ID：15042418
> 
> 赞同：5
> 
> 时间：2013-02-23T15:53:39.200
> 
> 标签：windows, r, curl, github

我问了一个[相关](https://stackoverflow.com/questions/15034471/using-git-and-curl-command-line)的问题并意识到我没有问正确的问题（即，这与 git 无关）。

[问题是如何在不首先使用 R 在云中创建项目的情况下将项目推送到 github。目前，您可以使用此问题](https://stackoverflow.com/questions/14912161/repo-from-rstudio-to-github)中的信息从 RStudio 中的 git 命令行执行此操作。

现在我正试图从 Windows 机器（Linux 很容易）将它变成 R 代码。`system`我被困在通过 R调用从命令行使用 curl 的第一步。我会展示我所拥有的，然后是错误消息（[感谢 SimonO101 让我走到这一步。](https://stackoverflow.com/a/15038461/1000343)）。根据他在下面的评论，我进行了大量编辑以反映问题：

**代码：**

```
repo <- "New"
user <- "trinker"
password <- "password"

url <- "http://curl.askapache.com/download/curl-7.23.1-win64-ssl-sspi.zip"
tmp <- tempfile( fileext = ".zip" )
download.file(url,tmp)
unzip(tmp, exdir = tempdir())

system(paste0(tempdir(), "/curl http://curl.haxx.se/ca/cacert.pem -o " , 
    tempdir() , "/curl-ca-bundle.crt"))

cmd1 <- paste0(tempdir(), "/curl -u '", user, ":", password, 
    "' https://api.github.com/user/repos -d '{\"name\":\"", repo, "\"}'")

system(cmd1)

cmd2 <- paste0(tempdir(), "/curl -k -u '", user, ":", password, 
    "' https://api.github.com/user/repos -d '{\"name\":\"", repo, "\"}'")

system(cmd2) 
```

**错误消息（两种方法相同）：**

```
> system(cmd1)
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100    12    0     0  100    12      0     24 --:--:-- --:--:-- --:--:--    30
100    47  100    35  100    12     65     22 --:--:-- --:--:-- --:--:--    83{
  "message": "Bad credentials"
} 
```

我知道所有文件都在那里，因为：

```
> dir(tempdir())
[1] "curl-ca-bundle.crt"   "curl.exe"             "file1aec62fa980.zip"  "file1aec758c1415.zip" 
```

它不能是我的密码或用户名，因为这适用于 Linux Mint（唯一的区别是 curl 之前的部分）：

```
repo <- "New"
user <- "trinker"
password <- "password"

cmd1 <- paste0("curl -u '", user, ":", password, 
    "' https://api.github.com/user/repos -d '{\"name\":\"", repo, "\"}'")

system(cmd1) 
```

***注意：Windows 7 机器。R 2.14.1***

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T23:37:19.330

**编辑 - 在 OP 提供赏金之后**

好的，事实证明这与命令行上一些疯狂的 Windows 字符转义有关。本质上问题是我们向 github 传递了格式不正确的 json 请求。

您可以使用`shQuote`正确格式化 Windows 的 curl 请求的违规部分。我们可以测试平台类型，看看我们是否需要为 Windows 情况包含特殊格式，如下所示：

```
repo <- "NewRepository"
json <- paste0(" { \"name\":\"" , repo , "\" } ") #string we desire formatting
os <- .Platform$OS.type #check if we are on Windows
if( os == "windows" ){
json <- shQuote(json , type = "cmd" )
cmd1 <- paste0( tempdir() ,"/curl -i -u \"" , user , ":" , password , "\" https://api.github.com/user/repos -d " , json )
} 
```

这适用于我的 Windows 7 机器，没有任何问题。如果你愿意，我可以更新 GitHub 脚本吗？

**旧答案**

我在[这里](https://stackoverflow.com/a/7599151/1478381)和[这里](https://superuser.com/a/442797)做了一些挖掘，可能你的问题的答案是更新 curl-ca-bundle。在 Windows 上让 R 使用[internet2.dll](http://cran.r-project.org/bin/windows/rw-FAQ.html#The-Internet-download-functions-fail_002e)可能会有所帮助。

```
repo <- "New"
user <- "trinker"
password <- "password"

url <- "http://curl.askapache.com/download/curl-7.23.1-win64-ssl-sspi.zip"
tmp <- tempfile( fileext = ".zip" )
download.file(url,tmp)
unzip(tmp, exdir = tempdir())
system( paste0( "curl http://curl.haxx.se/ca/cacert.pem -o " , tempdir() , "/curl-ca-bundle.crt" ) )
system( paste0( tempdir(),"/curl", " -u \'USER:PASS\' https://api.github.com/user/repos -d \'{\"name\":\"REPO\"}\'") ) 
```

同样，我无法对此进行测试，因为我无法访问我的 Windows 机器，但更新证书颁发机构文件似乎帮助了其他一些人。在[curl 网站上](http://curl.haxx.se/docs/sslcerts.html)，Windows 版本的 curl 应按`curl-ca-bundle.crt`以下顺序查找文件：

1.  应用程序目录
2.  当前工作目录
3.  Windows 系统目录（例如 C:\windows\system32）
4.  Windows 目录（例如 C:\windows）
5.  %PATH% 上的所有目录

# ajax - jQuery mobile "pageinit" 短时间调用 hashtag

> ID：15042419
> 
> 赞同：0
> 
> 时间：2013-02-23T15:53:51.493
> 
> 标签：ajax, jquery-mobile, page-init

我目前正在使用 jQuery mobile 构建一个页面。我需要在一页上加载一些自定义 JavaScript，所以我找到了[pageInit](http://jquerymobile.com/demos/1.2.0/docs/pages/page-scripting.html)函数。这是我正在使用的一个简短示例：

page1.html：

```
<!doctype html>
<meta charset="uft-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>page1 | test page for jquery mobile</title>

<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css">

<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
<script src="js.js"></script>

<div data-role="page" id="page1">
    <div data-role="header">
        <h1>Page 1 Title</h1>
    </div>

    <div data-role="content">
        <a href="page2.html">go to page2</a>
        <p>Page 1 content goes here.</p>
    </div>

    <div data-role="footer">
        <h4>Page 1 Footer</h4>
    </div>
</div> 
```

page2.html：

```
<!doctype html>
<meta charset="uft-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>page1 | test page for jquery mobile</title>

<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css">

<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
<script src="js.js"></script>

<div data-role="page" id="page2">
    <div data-role="header">
        <h1>Page 2 Title</h1>
    </div>

    <div data-role="content">
        <a href="page1.html">go to page1</a>
        <p id="addstuff">Page 2 content goes here.</p>
    </div>

    <div data-role="footer">
        <h4>Page 2 Footer</h4>
    </div>
</div> 
```

js.js

```
$(document).delegate('#page2', 'pageinit', function() {
    $('<div />', {
        html: 'Some text that was added via jQuery'
    }).appendTo('#addstuff');
}); 
```

所以我需要在 page2.html 上执行一些 JavaScript。它实际上很好用（创建了 div 并且您看到了文本）。但是，当我单击链接更改页面时，您可以看到，jQuery 首先调用 URL 中的主题标签。所以它看起来像：

```
example.org/page1.html#/page2.html 
```

当我点击 page1.html 上的链接（可能只有几毫秒）然后它重定向到

```
example.org/page2.html 
```

我想这是因为 id .. 但我需要这个用于 pageInit（据我所知）。这种行为正常吗？还是我做错了什么。也许甚至有一个不调用哈希标签的命令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:23:03.533

干得好：

> 请务必注意，如果您从通过 AJAX 加载的移动页面链接到包含多个内部页面的页面，则需要在链接中添加 rel="external" 或 data-ajax="false"。这告诉框架重新加载整个页面以清除 URL 中的 AJAX 哈希。这一点很关键，因为 AJAX 页面使用哈希 (#) 来跟踪 AJAX 历史，而多个内部页面使用哈希来指示内部页面，因此这两种模式之间的哈希会发生冲突。
> 
> 例如，指向包含多个内部页面的页面的链接如下所示：
> 
> <a href="multipage.html" rel="external">多页链接</a>

源：http: [//view.jquerymobile.com/1.3.0/#Linkingwithinamulti-pagedocument](http://view.jquerymobile.com/1.3.0/#Linkingwithinamulti-pagedocument)

# scala - 在scala中从Iterator创建SortedMap

> ID：15042421
> 
> 赞同：6
> 
> 时间：2013-02-23T15:53:55.910
> 
> 标签：scala, collections, sortedmap

我有一个`val it:Iterator[(A,B)]`，我想`SortedMap[A,B]`用我从`Iterator`. 我现在的做法是：

```
val map = SortedMap[A,B]() ++ it 
```

它工作正常，但使用起来感觉有点尴尬。我检查了`SortedMap`文档，但找不到更优雅的东西。有没有类似的东西：

```
 it.toSortedMap 
```

或者

```
SortedMap.from(it) 
```

在我可能错过的标准 Scala 库中？

**编辑**：混合@Rex 的回答中的两个想法我想出了这个：

```
SortedMap(it.to:_*) 
```

哪个工作得很好，并且避免了指定`SortedMap`. 虽然看起来仍然很有趣，所以欢迎进一步的回答。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T16:04:49.517

您正在寻找的功能确实存在于其他组合中，但不是您想要的。如果您的集合只需要一个参数，您可以使用`.to[NewColl]`. 所以，例如，

```
import collection.immutable._

Iterator(1,2,3).to[SortedSet] 
```

此外，`SortedMap`伴生对象有一个可变参数应用，可用于创建排序映射，如下所示：

```
SortedMap( List((1,"salmon"), (2,"herring")): _* ) 
```

（注意`: _*`这意味着使用内容作为参数）。不幸的是，这需要一个`Seq`，而不是一个`Iterator`。

所以你最好的选择是你已经这样做了。

# bash - 在 Bash 脚本中运行两个 C++ 文件

> ID：15042425
> 
> 赞同：0
> 
> 时间：2013-02-23T15:54:24.297
> 
> 标签：bash

我编写了一个 bash 脚本来运行客户端和服务器。
代码是用 cpp 编写的，*客户端*和*服务器*都是可执行的。

```
$port=8008
$pack_rate=16     
echo "Starting server"
./server -p $port -n 512 -e 0.001
echo "Starting client"
./client -p $port -n 512 -l 16 -s localhost -r $pack_rate -d
echo "end" 
```

在上述情况下，客户端会向服务器发送数据包，服务器会对其进行处理。
因此，客户端和服务器都应该同时运行。
我尝试运行脚本文件，但仅符合预期

```
"Starting server" 
```

正在打印。因此，*服务器*正在运行，并且在收到来自客户端的 512 个数据包之前，服务器不会终止。但是*客户端*进程要等到服务器在 bash 脚本中结束后才能启动。

那么，有什么方法可以让我使用单个 bash 脚本同时运行这两个进程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:02:54.223

您需要添加一个 &：

```
./server -p $port -n 512 -e 0.001 & 
```

因此，脚本不会等待服务器程序结束继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:04:02.950

add`&`添加`./server`行尾，它将以批处理模式运行该进程，并继续执行脚本的其余部分

# debugging - ocamlyacc 中的冲突

> ID：15042429
> 
> 赞同：0
> 
> 时间：2013-02-23T15:54:35.050
> 
> 标签：debugging, types, ocamlyacc, reduce-reduce-conflict

我正在尝试为一种使用 ocamlyacc 识别整数和浮点表达式的简单语言编写解析器。但是，我想介绍具有变量的可能性。所以我在我的*lexer.mll*文件中定义了令牌**VAR** ，它允许它是任何以大写字母开头的字母数字字符串。

 *```
 expr:
 | INT                      { $1 }
 | VAR                      { /*Some action */}
 | expr PLUS expr           { $1 + $3 }
 | expr MINUS expr          { $1 - $3 }

 /* and similar rules below for real expressions differently */ 
```

现在我对实数有了类似的定义。但是，当我运行此文件时，我会遇到 2 个减少/减少冲突，因为如果我只是输入一个随机字符串（标识为令牌 VAR）。解析器不知道它是实数还是整数类型的变量，因为在我的语法中定义 int 和 real 表达式时存在关键字 VAR。

```
Var + 12  /*means that Var has to be an integer variable*/
Var  /*Is a valid expression according to my grammar but can be of any type*/ 
```

如何在不失去变量声明的一般性和维护我可用的 2 种数据类型的情况下消除这种减少/减少冲突。*

# java - 递归删除导致堆栈溢出错误

> ID：15042432
> 
> 赞同：1
> 
> 时间：2013-02-23T15:55:13.750
> 
> 标签：java, delete-file

我问了一个关于如何从目录中的文件夹中删除所有文件但保留文件夹的问题，可以在这里找到：

[如何删除目录的文件而不是文件夹](https://stackoverflow.com/questions/15041971/how-to-delete-files-of-a-directory-but-not-the-folders-java)

有目的的解决方案之一是使用递归来实现这一点：

```
public void DeleteFiles() {
    File file =
       new File(
          "D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/"+
          "resources/pdf/");
    System.out.println("Called deleteFiles");
    if (file.isDirectory()) {
        for (File f : file.listFiles()) {
            DeleteFiles();
        }
    } else {
        file.delete();
    }
} 
```

但是我只是得到一个充满Called deleteFiles的控制台，直到我得到堆栈溢出错误，它似乎没有通过目录查找文件并删除它们，我该如何实现呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T16:16:11.003

当有更简单的解决方案时，递归就是在自找麻烦。使用[commons-io](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#iterateFiles%28java.io.File,%20org.apache.commons.io.filefilter.IOFileFilter,%20org.apache.commons.io.filefilter.IOFileFilter%29)：

```
import java.io.File;
import org.apache.commons.io.FileUtils;
import static org.apache.commons.io.filefilter.TrueFileFilter.TRUE;

File root = new File("D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/");
Iterator<File> files = FileUtils.iterateFiles(root, TRUE, TRUE);
for (File file : files) {
    file.delete();
} 
```

或使用[JDK 7](http://docs.oracle.com/javase/7/docs/api/java/nio/file/package-summary.html)：

```
import java.nio.file.*;
import java.nio.file.attribute.BasicFileAttributes;

Path root = Paths.get("D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/");
Files.walkFileTree(root, new SimpleFileVisitor<Path>() {
    @Override
    public FileVisitResult visitFile(Path file, BasicFileAttributes attrs)
            throws IOException {
        file.delete();
        return FileVisitResult.CONTINUE;
    }
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T16:00:33.913

```
public void DeleteFiles() {
    File file = new File("D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/");
    System.out.println("Called deleteFiles");
    DeleteFiles(file);
}

public void DeleteFiles(File file) {
    if (file.isDirectory()) {
        for (File f : file.listFiles()) {
            DeleteFiles(f);
        }
    } else {
        file.delete();
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T15:58:19.177

```
 File file = new File("D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/"); 
```

您一次又一次地创建相同的文件。在函数之外声明该文件。

您的递归与建议的递归不同。

```
public void DeleteFiles( File file) {
    System.out.println("Called deleteFiles");
    if (file.isDirectory()) {
        for (File f : file.listFiles()) {
            DeleteFiles(f);
        }
    } else {
        file.delete();
    }
} 
```

# r - 如何估计 R 中散点图的最佳拟合函数？

> ID：15042435
> 
> 赞同：4
> 
> 时间：2013-02-23T15:55:31.440
> 
> 标签：r, curve-fitting, model-fitting

我有两个变量的散点图，例如：

```
x<-c(0.108,0.111,0.113,0.116,0.118,0.121,0.123,0.126,0.128,0.131,0.133,0.136)

y<-c(-6.908,-6.620,-5.681,-5.165,-4.690,-4.646,-3.979,-3.755,-3.564,-3.558,-3.272,-3.073) 
```

我想找到更适合这两个变量之间关系的函数。

准确地说，我想比较三个模型的拟合`linear`：`exponential`和`logarithmic`。

我正在考虑将每个函数拟合到我的值，计算每种情况下的可能性并比较 AIC 值。

但我真的不知道如何或从哪里开始。任何可能的帮助将不胜感激。

非常感谢您提前。

蒂娜。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T18:26:26.423

我将从解释性情节开始，如下所示：

```
x<-c(0.108,0.111,0.113,0.116,0.118,0.121,0.123,0.126,0.128,0.131,0.133,0.136)
y<-c(-6.908,-6.620,-5.681,-5.165,-4.690,-4.646,-3.979,-3.755,-3.564,-3.558,-3.272,-3.073)
dat <- data.frame(y=y,x=x)
library(latticeExtra)
library(grid)
xyplot(y ~ x,data=dat,par.settings = ggplot2like(),
       panel = function(x,y,...){
         panel.xyplot(x,y,...)
       })+
  layer(panel.smoother(y ~ x, method = "lm"), style =1)+  ## linear
  layer(panel.smoother(y ~ poly(x, 3), method = "lm"), style = 2)+  ## cubic
  layer(panel.smoother(y ~ x, span = 0.9),style=3)  + ### loeess
  layer(panel.smoother(y ~ log(x), method = "lm"), style = 4)  ## log 
```

![在此处输入图像描述](../Images/2cd514703d1a60a038f1ead97d027050.png)

看起来你需要一个立方体模型。

```
 summary(lm(y~poly(x,3),data=dat))

Residual standard error: 0.1966 on 8 degrees of freedom
Multiple R-squared: 0.9831, Adjusted R-squared: 0.9767 
F-statistic: 154.8 on 3 and 8 DF,  p-value: 2.013e-07 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-23T20:04:44.073

这是比较五个模型的示例。由于前两个模型的形式，我们可以`lm`用来获得良好的起始值。（请注意，`y`不应比较使用不同变换的模型，因此我们不应使用`lm1`and`lm2`作为比较模型，而只能用于起始值。）现在`nls`为前两个运行一个。在这两个模型之后，我们尝试 中的各种次数的多项式`x`。幸运的是`lm`并`nls`使用一致`AIC`的定义（尽管其他 R 模型拟合函数不一定具有一致的`AIC`定义）所以我们可以只使用`lm`多项式。最后，我们绘制了前两个模型的数据和拟合。

AIC 越低越好，所以`nls1`最好后面`lm3.2`跟着`nls2`.

```
lm1 <- lm(1/y ~ x)
nls1 <- nls(y ~ 1/(a + b*x), start = setNames(coef(lm1), c("a", "b")))
AIC(nls1) # -2.390924

lm2 <- lm(1/y ~ log(x))
nls2 <- nls(y ~ 1/(a + b*log(x)), start = setNames(coef(lm2), c("a", "b")))
AIC(nls2) # -1.29101

lm3.1 <- lm(y ~ x) 
AIC(lm3.1) # 13.43161

lm3.2 <- lm(y ~ poly(x, 2))
AIC(lm3.2) # -1.525982

lm3.3 <- lm(y ~ poly(x, 3))
AIC(lm3.3) # 0.1498972

plot(y ~ x)

lines(fitted(nls1) ~ x, lty = 1) # solid line
lines(fitted(nls2) ~ x, lty = 2) # dashed line 
```

![在此处输入图像描述](../Images/b0c11e8a54b75324921917d08b7fc8cc.png)

添加了更多模型，随后对其进行了修复并更改了符号。为了跟进 Ben Bolker 的评论，我们可以用AICcmodavg 包替换`AIC`上面的任何地方。`AICc`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T18:50:08.647

您可以先阅读 Box 和 Cox 关于转换的经典论文。他们讨论了如何比较转换以及如何在一组或一系列潜在转换中找到有意义的转换。对数变换和线性模型是 Box-Cox 系列的特例。

正如@agstudy 所说，也要始终绘制数据。

# javascript - 无法从 Ajax getAllResponseHeaders 获取自定义 HTTP 标头响应

> ID：15042439
> 
> 赞同：29
> 
> 时间：2013-02-23T15:55:40.737
> 
> 标签：javascript, jquery, ajax, cross-domain

我确实获得了响应数据，但我无法获得我的自定义 HTTP 标头数据。

是的，这是一个跨域请求。我正在使用 Javascript 执行 Ajax 请求。我已经用 XMLHttpRequest 和 jQuery $.ajax 试过这个。我已经完成了我的服务器设置，我在发送数据时设置了这些：

```
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: POST, GET 
```

我**确实**得到了我想要的响应数据。但我无法获得完整的 HTTP 标头响应。

使用 PHP，我在发送文本响应之前设置了以下内容。所以我假设我应该使用 getAllResponseHeaders() 来获取它。

```
header('Expires: 0');
header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
header('My-Own-Test: nodatahere'); 
```

但这就是我得到的。

```
Content-Type: text/plain; charset=x-user-defined
Cache-Control: must-revalidate, post-check=0, pre-check=0
Expires: 0 
```

它缺少`My-Own-Test`. 仅供参考，这是我的 Javascript：

```
var formData = new FormData();
formData.append('username', 'my_username');
formData.append('book_id', 'test password');
var xhr = new XMLHttpRequest();
xhr.open('POST', 'https://mydomain.com/proc.php', true);
xhr.overrideMimeType("text/plain; charset=x-user-defined");
xhr.onload = function(e) { 
    console.log(this.getAllResponseHeaders());
};
xhr.send(formData); 
```

我什至用 jQuery 尝试过......结果相同。

```
var data_to_send = {
    username: 'my_username',
    password: 'test_password'
};
var ajaxObj;
ajaxObj = $.ajax({
    url: "https://mydomain.com/proc.php",
    data: data_to_send,
    type: "POST", 
    beforeSend: function ( xhr ) {
        xhr.overrideMimeType("text/plain; charset=x-user-defined");
    }
})
.done(function ( data ) {
    console.log( ajaxObj.getAllResponseHeaders()  );
}); 
```

仍然......没有运气。

但如果我通过 Firebug 或 Chrome 的开发者工具，我可以看到这些工具确实返回完整的 HTTP 标头信息，包括`Content-Length`, `Content-Encoding`, `Vary`, `X-Powered-By`, `Set-Cookie`, `Server`, 当然还有`My-Own-Test`.

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-02-23T16:54:57.877

我要感谢[jbl](https://stackoverflow.com/users/1236044/jbl)指出我正确的 SO 问题。我现在明白了...

所以，好吧……答案。如果您想设置自己的 HTTP Header 信息，然后使用跨域 Ajax 或类似的方式获取它，那么在发送响应文本之前，您应该在服务器端设置一些额外的 HTTP Header。

```
header('Access-Control-Allow-Origin: *');
header("Access-Control-Allow-Methods: POST, GET");      
header('Custom-Header: Own-Data');
header('Access-Control-Expose-Headers: Custom-Header'); 
```

上面的示例使用 PHP。但是使用你自己的语言，无论你用什么来设置它们。

当我问这个问题时，除了`Access-Control-Expose-Headers`. 放入之后，我的 Javascript Ajax 就可以读取 HTTP Header Custom-Header 的内容了。

# emacs - emacs 自动加载模式

> ID：15042447
> 
> 赞同：0
> 
> 时间：2013-02-23T15:55:57.960
> 
> 标签：emacs, global, yasnippet

我是新手。现在我想

> 自动启动 yasnippet 自动完成 gtags flymake 模式

当我打开 (php/java/el/...) 文件时。

> 我应该在我的 emacs 配置文件中放什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T03:49:01.267

正如 liu 所说，您用于`add-hook`指定在启动特定模式时运行的操作。文档[在这里](http://www.gnu.org/software/emacs/manual/html_node/elisp/Hooks.html#Hooks)。钩子类似于C# 中的*事件*，或 OOP 中的*观察者模式*。

每个模式都应该定义一个在该模式启动时运行的钩子，例如。对于名为*java-mode 的模式*，有一个名为*java-mode-hook*的相应钩子。`add-hook`让你将一个动作连接到这个钩子：

```
(add-hook 'java-mode-hook 'my-action) 
```

您可以使用匿名`lambda`函数就地定义操作，如下所示：

```
(add-hook 'java-mode-hook (lambda () (message "hello from java-mode"))) 
```

每当您启动 java 模式时，这将打印一条消息。

通常最好为此目的定义一个命名函数。如果使用命名函数，`add-hook`将确保不会多次调用同一个函数。

```
 (defun hello () 
    (message "hello from java-mode"))

  (add-hook 'java-mode-hook 'hello) 
```

语言编辑模式源自 prog-mode。如果您想在启动任何编程语言模式时运行某个操作，请将您的函数添加到`prog-mode-hook`.

* * *

您需要为要使用的每种模式手动配置自动完成模式。对于每种模式，将该模式添加到`ac-modes`列表中：

```
(add-to-list 'ac-modes 'java-mode) 
```

作为旁注，您将希望`flyspell-prog-mode`用于编程语言模式，因此您只会在注释和字符串文字中收到拼写建议。

```
(defun on-prog-mode ()
  (flyspell-prog-mode t))

(add-hook 'prog-mode-hook 'on-prog-mode) 
```

你可能会想要使用[flycheck](https://github.com/lunaryorn/flycheck)而不是旧的 flymake。Flycheck 正在积极开发中，并且有用于 php 的检查器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:08:30.967

你可以像下面这样添加：

```
(global-auto-complete-mode t)
(yas-global-mode 1) 
```

然后相应地在下面更新：

```
(add-hook 'php-mode-hook (lambda () (flyspell-mode 1)))
(add-hook 'php-mode-hook (lambda()(gtags-mode 1))) 
```

# excel - 如何在matlab中将最后4位数字与一行分开？

> ID：15042453
> 
> 赞同：-1
> 
> 时间：2013-02-23T15:56:22.010
> 
> 标签：excel, matlab

我有一个 excel 文档，我想为每一行分隔 B 列的最后 4 位数字。比如说第一个。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:29:06.603

我不确定您是否想在 Excel 中执行此操作，但如果您不介意 - 这个简单的公式：

```
=VALUE(RIGHT(B1,4)) 
```

将返回您想要的（假设您的数据从第一行开始）。如果需要，自动填充公式。如果您希望将 4 位数字返回为`string`, 螺母编号 - 删除`VALUE(...)`部分。

**编辑：**

根据评论，您需要使用以下公式：

```
=HEX2DEC(RIGHT(B2,4)) 
```

自动填充或复制/粘贴到第 554 行。

示例文件：[https ://www.dropbox.com/s/4mnx5x3h28gv3rs/4DigitsHEX2DEC.xlsx](https://www.dropbox.com/s/4mnx5x3h28gv3rs/4DigitsHEX2DEC.xlsx)

# extjs - 使用 Extjs 3.4 History 和 ie8 和 ie9 标准文档模式的后退按钮

> ID：15042460
> 
> 赞同：3
> 
> 时间：2013-02-23T15:56:43.507
> 
> 标签：extjs

我遇到了 Ext.History 实用程序（版本 3.4.0）在 IE8+ 中正常工作的问题。它适用于 Quirks 模式，但不适用于 IE8 标准模式 (IE8) 或 IE9 标准模式 (IE9) 中的文档模式。Quirks 模式对我们不起作用，因为它不能正确渲染我们的 CSS。

我已经从应用程序中删除了除历史实用程序之外的所有内容，现在有两个文件（除了 extjs 文件）：

索引.html：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">
<html>

<head>
        <script type="text/javascript" src="ext-base.js"></script>
        <script type="text/javascript" src="ext-all.js"></script>
        <script type="text/javascript" src="myapp.js"></script>
</head>

<body>

<div>
    <div align="center">
        <table width="97%" border="0" cellpadding="0" cellspacing="0" >
            <tr>
                <td>
                    <a href="#link1">Link1</a> |
                    <a href="#link2">Link2</a> |
                    <a href="#link3">Link3</a> |
                    <a href="#link4">Link4</a> |
                    <a href="#link5">link5</a>
                </td>
            </tr>
        </table>
    </div>
</div>

<!-- Fields required for history management -->
<form id="history-form" class="x-hidden">
    <input type="hidden" id="x-history-field"/>
    <iframe id="x-history-frame"></iframe>
</form>

</body>
</html> 
```

myapp.js：

```
Ext.ns('MyApp');

Ext.onReady(function()
{
Ext.History.init();
    Ext.History.on('change', function(token){}, this);
}); 
```

当我在 Web 服务器中加载应用程序时，转到 index.html，然后单击 link1，地址栏显示 #link1。然后我单击link2，地址栏显示#link2。然后我单击link3，地址栏显示#link3。

在带有 IE7 Emulation 的 IE、Chrome 或 Firefox 中使用后退按钮，地址栏将从 #link3 变为 #link2。当我第二次点击返回按钮时，地址栏从#link2 变为#link1。这是我所期望的行为。

但是，在适当的文档标准模式下使用 IE8 或 IE 9，当我再次单击后退按钮时，地址栏会从 #link2 返回到 #link3。进一步点击后退按钮只会在#link2 和#link3 之间切换用户。这种行为是出乎意料的，导致我们的应用程序无法正常工作。

请注意，这是 Sencha 示例适用于 3.4.0 的方式：

[Sencha 3.4 示例](http://dev.sencha.com/deploy/ext-3.4.0/examples/history/history.html "Sencha 3.4 示例")

（页面以 Quirks 模式呈现，但如果您将其更改为 IE8 标准或 IE9 标准，它将不起作用）。

它确实工作似乎在 4.1 中正常工作：

（只让我发布 2 个链接，但你可能会找到它......）

我无权访问 Ext 3.4.1，但此问题未在错误修复中列出。我看到一个线程（[here](http://www.sencha.com/forum/showthread.php?81393-Unpredictable-behavior-of-Ext.History-and-back-button-on-IE)）表明更改文档类型会起作用，但似乎并非如此（我已经尝试了所有文档类型......）。

请注意，我们应用程序的许多部分都使用历史实用程序进行导航，因此删除它不是一个可接受的解决方案。

任何人都可以就我如何让它发挥作用提供任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T00:51:54.860

这实际上非常简单。我下载了 Ext 4.1 并查看了他们对 Ext.util.History 类所做的工作。他们为 oldIEMode 定义了一个变量，并将其用于在 3.4 中他们使用 Ext.isIE 的所有条件。

所以我在 ext-all-debug.js 中编辑了 Ext.History 类，并在顶部定义了以下变量：

var oldIEMode = Ext.isIE6 || Ext.isIE7 || !Ext.isStrict && Ext.isIE8;

类中有三个条件检查 Ext.isIE，我将其替换为 oldIEMode。

我重建并部署了应用程序，问题得到解决。

编辑 ext-all.js 不是最佳实践，但我应该能够覆盖这个类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T13:28:44.463

这就是我最终解决它的方式：

我创建了一个新的补丁 javascript 文件并将其包含在 ext 文件之后

```
/*
 @Author: RWR 20130224

 This fixes the issue with backward traversal of history in IE8 & higher in standard document mode.

 This class was challenging to override (http://www.sencha.com/forum/showthread.php?46306-Help-How-to-extend-Ext.History)
 I ended up pasting all of the source original code here and making the necessary changes.

 NOTE that this may be patched in version 3.4.1\.  It is definitely patched in 4.1\.  When upgrading, validate that this patch is still required.
 */
NewHistory = (function () {
var iframe, hiddenField;
var ready = false;
var currentToken;
var oldIEMode = Ext.isIE6 || Ext.isIE7 || !Ext.isStrict && Ext.isIE8;

function getHash() {
    var href = location.href, i = href.indexOf("#"),
        hash = i >= 0 ? href.substr(i + 1) : null;

    if (Ext.isGecko) {
        hash = decodeURIComponent(hash);
    }
    return hash;
}

function doSave() {
    hiddenField.value = currentToken;
}

function handleStateChange(token) {
    currentToken = token;
    Ext.History.fireEvent('change', token);
}

function updateIFrame (token) {
    var html = ['<html><body><div id="state">',Ext.util.Format.htmlEncode(token),'</div></body></html>'].join('');
    try {
        var doc = iframe.contentWindow.document;
        doc.open();
        doc.write(html);
        doc.close();
        return true;
    } catch (e) {
        return false;
    }
}

function checkIFrame() {
    if (!iframe.contentWindow || !iframe.contentWindow.document) {
        setTimeout(checkIFrame, 10);
        return;
    }

    var doc = iframe.contentWindow.document;
    var elem = doc.getElementById("state");
    var token = elem ? elem.innerText : null;

    var hash = getHash();

    setInterval(function () {

        doc = iframe.contentWindow.document;
        elem = doc.getElementById("state");

        var newtoken = elem ? elem.innerText : null;

        var newHash = getHash();

        if (newtoken !== token) {
            token = newtoken;
            handleStateChange(token);
            location.hash = token;
            hash = token;
            doSave();
        } else if (newHash !== hash) {
            hash = newHash;
            updateIFrame(newHash);
        }

    }, 50);

    ready = true;

    Ext.History.fireEvent('ready', Ext.History);
}

function startUp() {
    currentToken = hiddenField.value ? hiddenField.value : getHash();

    if (oldIEMode) {
        checkIFrame();
    } else {
        var hash = getHash();
        setInterval(function () {
            var newHash = getHash();
            if (newHash !== hash) {
                hash = newHash;
                handleStateChange(hash);
                doSave();
            }
        }, 50);
        ready = true;
        Ext.History.fireEvent('ready', Ext.History);
    }
}

return {
    /**
     * The id of the hidden field required for storing the current history token.
     * @type String
     * @property s
     */
    fieldId: 'x-history-field',
    /**
     * The id of the iframe required by IE to manage the history stack.
     * @type String
     * @property s
     */
    iframeId: 'x-history-frame',

    events:{},

    /**
     * Initialize the global History instance.
     * @param {Boolean} onReady (optional) A callback function that will be called once the history
     * component is fully initialized.
     * @param {Object} scope (optional) The scope (<code>this</code> reference) in which the callback is executed. Defaults to the browser window.
     */
    init: function (onReady, scope) {
        if(ready) {
            Ext.callback(onReady, scope, [this]);
            return;
        }
        if(!Ext.isReady){
            Ext.onReady(function(){
                Ext.History.init(onReady, scope);
            });
            return;
        }
        hiddenField = Ext.getDom(Ext.History.fieldId);
        if (oldIEMode) {
            iframe = Ext.getDom(Ext.History.iframeId);
        }
        this.addEvents(
            /**
             * @event ready
             * Fires when the Ext.History singleton has been initialized and is ready for use.
             * @param {Ext.History} The Ext.History singleton.
             */
            'ready',
            /**
             * @event change
             * Fires when navigation back or forwards within the local page's history occurs.
             * @param {String} token An identifier associated with the page state at that point in its history.
             */
            'change'
        );
        if(onReady){
            this.on('ready', onReady, scope, {single:true});
        }
        startUp();
    },

    /**
     * Add a new token to the history stack. This can be any arbitrary value, although it would
     * commonly be the concatenation of a component id and another id marking the specifc history
     * state of that component.  Example usage:
     * <pre><code>
     // Handle tab changes on a TabPanel
     tabPanel.on('tabchange', function(tabPanel, tab){
     Ext.History.add(tabPanel.id + ':' + tab.id);
     });
     </code></pre>
     * @param {String} token The value that defines a particular application-specific history state
     * @param {Boolean} preventDuplicates When true, if the passed token matches the current token
     * it will not save a new history step. Set to false if the same state can be saved more than once
     * at the same history stack location (defaults to true).
     */
    add: function (token, preventDup) {
        if(preventDup !== false){
            if(this.getToken() == token){
                return true;
            }
        }
        if (oldIEMode) {
            return updateIFrame(token);
        } else {
            location.hash = token;
            return true;
        }
    },

    /**
     * Programmatically steps back one step in browser history (equivalent to the user pressing the Back button).
     */
    back: function(){
        history.go(-1);
    },

    /**
     * Programmatically steps forward one step in browser history (equivalent to the user pressing the Forward button).
     */
    forward: function(){
        history.go(1);
    },

    /**
     * Retrieves the currently-active history token.
     * @return {String} The token
     */
    getToken: function() {
        return ready ? currentToken : getHash();
    }
};
})();
Ext.apply(NewHistory, new Ext.util.Observable());
Ext.apply(Ext.History, NewHistory); 
```

# java - java中相同字符串的不同名称

> ID：15042462
> 
> 赞同：0
> 
> 时间：2013-02-23T15:56:50.613
> 
> 标签：java, string

```
class test
{
public static void main(String[] args)
 {
  String s1 = new String("JAVA");
  String s2 = new String("JAVA");
  String s3 = new String("JAVA");
 }
} 
```

这里创建了多少字符串对象，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:02:02.650

3 个不同的 String 对象被声明并初始化为“JAVA”。

每次调用时`new String()`都会创建一个新的不可变 String 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:14:33.707

我不知道您如何打印出每个对象的哈希码，但请尝试以下操作，看看您会得到什么。您应该为每个 String 对象使用不同的哈希码，因为虽然每个对象都是具有相同值的 String，但它们存储在内存中的不同位置。

```
class test{
    public static void main(String[] args)
    {
        String s1 = new String("JAVA");
        String s2 = new String("JAVA");
        String s3 = new String("JAVA");

        System.out.println(System.identityHashCode(s1));
        System.out.println(System.identityHashCode(s2));
        System.out.println(System.identityHashCode(s3));
    }
} 
```

那应该返回如下结果：

```
219604438
1514883920
87924608 
```

这就是它在我的系统上返回的方式。你的会不一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T16:05:36.450

正在创建三个不同的字符串对象，即使每个对象具有相同的值。`new`操作员创建一个对象的新实例。如果你从内存的角度来考虑它，它可能看起来像这样（假设左边的数字是内存中的位置）：

```
String s1: 01
01 J
02 A
03 V
04 A

String s2: 06
06 J
07 A
08 V
09 A

String s3: 11
11 J
12 A
13 V
14 A 
```

所以每个字符串在内存中都有自己的位置，但可以包含相同的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T16:11:46.377

创建了 3 个不同的 String 实例。“new”关键字总是创建新对象。尽管它们具有相同的值，但它们被分配到不同的内存地址:)

# java - HttpClient单例实例的区别与否

> ID：15042463
> 
> 赞同：1
> 
> 时间：2013-02-23T15:56:53.380
> 
> 标签：java, post, singleton, httpclient, instance

正如 HttpClient 文档所建议的那样 - 通常建议每个通信组件甚至每个应用程序都有一个 HttpClient 实例。

我在 HttpClient 是否是单例之间有不同的行为。

1）使用单例，我首先创建了一个全局静态 HttpClient 实例，并使用该实例发送每个请求，并带有以下段，

```
PostMethod post = new PostMethod(url);
int status = httpClient.executeMethod(post); 
```

2）没有单例，我通过创建一个新的 HttpClient 实例来发送每个请求

```
PostMethod post = new PostMethod(url);
HttpClient httpClient = new HttpClient();
int status = httpClient.executeMethod(post); 
```

不同的是，没有单例，一切正常，我可以在连续的请求中分别得到正确的结果。但是对于单例，似乎有一些请求上下文，第二个请求没有按预期返回响应字符串，因为第一个请求参数（奇怪！！）。

我没有服务代码和服务器配置。你能帮我找出可能的原因吗？

提前致谢。

# android - 在获取绘图缓存之前从 textview 中删除下划线

> ID：15042467
> 
> 赞同：3
> 
> 时间：2013-02-23T15:57:13.123
> 
> 标签：android, textview, underline

我正在尝试将文本视图转换为 Android 中的图像。问题是，当用户在 textView 中输入时，最后一个单词下面有一个下划线。仅当键盘被隐藏（例如，如果按下取消按钮）时，下划线才会消失。我尝试手动隐藏它，但它没有帮助 - 即使我在隐藏键盘之后缓存了文本，我仍然在生成的 bitamp 中看到下划线。任何人都知道如何解决这个问题？这是我的代码：

```
 public void finishEditing() {
    InputMethodManager imm = (InputMethodManager)context.getSystemService(Context.INPUT_METHOD_SERVICE); 
    imm.hideSoftInputFromWindow(mEditText.getWindowToken(),0 );
    mEditText.setCursorVisible(false);

    mEditText.setDrawingCacheEnabled(true);

    Bitmap cache = mEditText.getDrawingCache();
    Bitmap text = cache.copy(cache.getConfig(),true);
    ((FrameLayout) findViewById(R.id.mainLayout)).removeView(mEditText);
    m_simView.addTextBitmap(text);

} 
```

请注意，隐藏键盘似乎工作正常 - 如果我注释掉位图的创建，我会得到没有下划线的 textView。在输入隐藏命令和键盘真正消失之间似乎有一些“等待期”。我尝试添加睡眠或虚拟循环，但这也无济于事:(
非常感谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T19:05:43.910

I found the answer - it's

```
someTextView.clearComposingText(); 
```

# ios - 在拖动音频/屏幕视频的同时实现流畅度/性能

> ID：15042468
> 
> 赞同：0
> 
> 时间：2013-02-23T15:57:14.277
> 
> 标签：ios, objective-c, performance, audio, video

拖动 UIImageView 时需要有性能/平滑度。在使用Apple 的[MoveMe 示例](http://developer.apple.com/library/ios/#samplecode/MoveMe/Introduction/Intro.html)应用程序时，我变得很流畅，但是当我在代码中实现相同功能时，性能会下降。

我也在录制屏幕和音频的视频。我已经在后台保存了视频和音频录制，因此我获得了更多的性能，但它仍然有些痒。

如果您注意到iTunes 上的[PuppetpalHD](https://itunes.apple.com/in/app/puppet-pals-hd/id342076546?mt=8)应用程序，它的流畅度非常好。怎么实现？？？

这是我的代码：

点击按钮：

```
if (Isrecording ==YES)
{
    [captureview performSelectorInBackground:@selector(startRecording) withObject:nil];
    [self performSelectorInBackground:@selector(startAudioRecording) withObject:nil];
    Isrecording =NO;
    [btnRecord setTitle:@"Stop" forState:UIControlStateNormal];
}
else if (!Isrecording)
{
    [captureview performSelector:@selector(stopRecording) withObject:nil afterDelay:1.0];
    [self performSelector:@selector(stopAudioRecording) withObject:nil afterDelay:3.0];
    Isrecording=YES;
    [btnRecord setTitle:@"Record" forState:UIControlStateNormal];
    [self performSelector:@selector(putTogether) withObject:nil afterDelay:5.0];
} 
```

现在，如果您看到上面的代码，我的 startRecording 函数将记录屏幕。startAudioRecording 将录制音频。

下面的代码用于拖动 UIImageView：

```
- (void) touchesMoved:(NSSet*)touches withEvent:(UIEvent*)event
{
    UITouch *t = [touches anyObject];
    CGPoint pPrev = [t previousLocationInView:self];
    CGPoint p = [t locationInView:self];

    CGPoint center = self.center;
    center.x += p.x - pPrev.x;
    center.y += p.y - pPrev.y;
    self.center = center;
}

If I stop recording audio or video, then dragging is very smooth. How can I achieve smooth performance along with audio and video recording. 
```

**编辑：**

我也尝试过使用 http://www.icodeblog.com/2010/10/14/working-with-uigesturerecognizers/ 中给出的 UIPanGestureRecognizer[但](http://www.icodeblog.com/2010/10/14/working-with-uigesturerecognizers/)情况与上述相同。我在没有音频和视频录制的情况下获得了足够的平滑度，但是当包含它时，性能会下降......

**编辑2：**

`pointInside:withEvent:`与相比有什么性能提升`touchesMoved:withEvent:`？？如何在使用上面的第一种方法时从下面的代码中获得性能？

```
UITouch *t = [touches anyObject];
CGPoint pPrev = [t previousLocationInView:self];
CGPoint p = [t locationInView:self];

CGPoint center = self.center;
center.x += p.x - pPrev.x;
center.y += p.y - pPrev.y;
self.center = center; 
```

**编辑 3：**

包括我的屏幕录像代码部分：

```
-(BOOL) setUpWriter {
NSError* error = nil;
videoWriter = [[AVAssetWriter alloc] initWithURL:[self tempFileURL] fileType:AVFileTypeQuickTimeMovie error:&error];
NSParameterAssert(videoWriter);

//Configure video
NSDictionary* videoCompressionProps = [NSDictionary dictionaryWithObjectsAndKeys:
                                       [NSNumber numberWithDouble:1024.0*1024.0], AVVideoAverageBitRateKey,
                                       nil ];

NSDictionary* videoSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                               AVVideoCodecH264, AVVideoCodecKey,
                               [NSNumber numberWithInt:self.frame.size.width], AVVideoWidthKey,
                               [NSNumber numberWithInt:self.frame.size.height], AVVideoHeightKey,
                               videoCompressionProps, AVVideoCompressionPropertiesKey,
                               nil];

videoWriterInput = [[AVAssetWriterInput assetWriterInputWithMediaType:AVMediaTypeVideo outputSettings:videoSettings] retain];

NSParameterAssert(videoWriterInput);
videoWriterInput.expectsMediaDataInRealTime = YES;
NSDictionary* bufferAttributes = [NSDictionary dictionaryWithObjectsAndKeys:
                                  [NSNumber numberWithInt:kCVPixelFormatType_32ARGB], kCVPixelBufferPixelFormatTypeKey, nil];

avAdaptor = [[AVAssetWriterInputPixelBufferAdaptor assetWriterInputPixelBufferAdaptorWithAssetWriterInput:videoWriterInput sourcePixelBufferAttributes:bufferAttributes] retain];

//add input
[videoWriter addInput:videoWriterInput];
[videoWriter startWriting];
[videoWriter startSessionAtSourceTime:CMTimeMake(0, 1000)];

return YES;
} 
```

# c++ - struct error的重新定义，我只定义了一次

> ID：15042470
> 
> 赞同：11
> 
> 时间：2013-02-23T15:57:21.267
> 
> 标签：c++

我真的不明白如何解决这个重新定义错误。

**编译+错误**

```
g++ main.cpp list.cpp line.cpp
In file included from list.cpp:5:0:
line.h:2:8: error: redefinition of âstruct Lineâ
line.h:2:8: error: previous definition of âstruct Lineâ 
```

**主文件**

```
#include <iostream>
using namespace std;
#include "list.h"

int main() {
    int no;
    // List list;

    cout << "List Processor\n==============" << endl;
    cout << "Enter number of items : ";
    cin  >> no;

    // list.set(no);
    // list.display();
} 
```

**列表.h**

```
#include "line.h"
#define MAX_LINES 10
using namespace std;

struct List{
    private:
        struct Line line[MAX_LINES];
    public:
        void set(int no);
        void display() const;
}; 
```

**线.h**

```
#define MAX_CHARS 10
struct Line {
    private:
        int num;
        char numOfItem[MAX_CHARS + 1]; // the one is null byte
    public:
        bool set(int n, const char* str);
        void display() const;
}; 
```

**列表.cpp**

```
#include <iostream>
#include <cstring>
using namespace std;
#include "list.h"
#include "line.h"

void List::set(int no) {}

void List::display() const {} 
```

**线.cpp**

```
#include <iostream>
#include <cstring>
using namespace std;
#include "line.h"

bool Line::set(int n, const char* str) {}

void Line::display() const {} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-02-23T15:59:51.330

您需要在标题中[添加包含防护](http://en.wikipedia.org/wiki/Include_guard)。

```
#ifndef LIST_H_
#define LIST_H_

// List.h code

#endif 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-02-23T16:02:02.963

在 list.cpp 中，您同时包含“line.h”和“list.h”。但是“list.h”已经包含“line.h”，所以“list.h”实际上在您的代码中包含了两次。（预处理器不够聪明，不能包含它已经拥有的东西）。

有两种解决方案：

*   不要将“list.h”直接包含在您的 list.cpp 文件中，但这是一种无法扩展的做法：您必须记住每个头文件包含的内容，这将很快。
*   使用包括警卫，正如@juanchopanza 所解释的那样

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T16:01:44.387

您包含“line.h”两次，并且您的头文件中没有包含保护。

如果您添加以下内容：

```
 #ifndef LINE_H
 #define LINE_H
 ... rest of header file goes here ... 
 #endif 
```

到你的头文件，一切都会好起来的。

# jquery - 滚动表，保持标题固定

> ID：15042474
> 
> 赞同：0
> 
> 时间：2013-02-23T15:57:35.127
> 
> 标签：jquery, css, jquery-ui, scroll

当我垂直滚动时，我希望我的表头是固定的。

另外，如何让我的表格留在 jQuery UI 选项卡的选项卡内容中？我希望它与底部对齐；它不应该是选项卡内容高度的 100%，因为表格上方还有其他内容，但我希望它填充所有可用空间（选项卡具有一定的高度，不会低于屏幕，所以正文不是应该有一个滚动条，也没有标签）。正如你今天看到的，我有一个 450px 的固定表格高度，在某些屏幕上是完美的，但在某些屏幕上它超出了（见图）。

![在此处输入图像描述](../Images/8a51e89e860532617a554a4684d93d6c.png)

如果可能的话，我希望滚动条位于最右侧（黄线），而不是靠近表格结束的位置。我认为类似于 Facebook。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-24T05:37:46.100

我发现的其他解决方案都没有满足我的所有要求，因此我创建了一个非常轻量级的 jQuery 插件来实现这一点。它支持固定页眉、页脚、列跨度 (colspan)、调整大小以及在滚动开始之前显示的可选行数。

[jQuery.scrollTableBody (GitHub)](https://github.com/nheldman/jquery.scrollTableBody)

只要您有一张带有正确`<thead>`、`<tbody>`和 (optional)的表格`<tfoot>`，您需要做的就是：

```
$('table').scrollTableBody(); 
```

**更新：** 也增加了对水平滚动的支持

# android - android获取最后5条记录

> ID：15042477
> 
> 赞同：0
> 
> 时间：2013-02-23T15:57:44.793
> 
> 标签：android, sqlite

我想在我的表中获取最新的 5 条记录，到目前为止我尝试了这个，但是效果并不好。那么，获取表中最后 5 条记录的最简洁有效的方法是什么？

```
"select * from (select * from People order by Date DESC limit 5) order by Date ASC;" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T21:59:03.333

您的查询工作得很好。

为了使其高效，请确保`Date`列上有索引；那么 SQLite 将只从索引和表中读取最后五个条目，而不需要扫描整个表。

如果此表有一个自动递增的 ID 列，并且如果“最新”表示插入顺序，那么您可以使用该 ID 进行排序；这将与带有索引的原始查询一样有效`Date`：

```
SELECT * FROM (SELECT * FROM People
               ORDER BY _id DESC
               LIMIT 5)
ORDER BY Date ASC 
```

# assembly - 当我们要使用用户输入时，为什么我们必须清除 ax 寄存器？

> ID：15042494
> 
> 赞同：0
> 
> 时间：2013-02-23T15:59:32.830
> 
> 标签：assembly, keyboard, x86, dos, xor

那么我的问题是，为什么我们必须用`xor ax,ax`登记`ax`表清除？我认为当用户为 variable 输入一个字符`A`时，当用户再次为 variable 输入一个字符时`B`，这可能会覆盖 中的内容值`ax`，但似乎有所不同。

这是在 x86 程序集中。

使用 DOS，一个 16 位的汇编器。在 DOS 中断下按任意字符：

```
mov ah, 01h 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:06:12.407

因为在 AH 中您要发送 INT 16 的参数，

如果 AH == 0 则读取键盘输入

如果 AH == 1 则查询键盘状态/预览键等。

读[这个](http://webpages.charter.net/danrollins/techhelp/0228.HTM)。

# ruby - be_valid 匹配器如何知道某些东西实际上是有效的

> ID：15042496
> 
> 赞同：2
> 
> 时间：2013-02-23T15:59:36.320
> 
> 标签：ruby, rspec

我正在阅读 RSpec，在第一个示例中，我看到如下内容：

```
Class Foo  # in the model

attr_accessible :name, :phone , etc#....

validates :name, presence: true
validates :phone, presence: true 
```

然后在 RSpec 我看到像

```
it "is valid with a name" do
  foo = Foo.new (name: "blah")
  expect(foo).to be_valid
end 
```

所以我想我的困惑是这个 be_valid 在做什么？它怎么知道名字是有效的？be_valid 是否意味着去检查我们是否为我们的模型定义了验证器，去看看是什么？在这种情况下，我们说 name 应该存在，所以现在我们已经传递了 name，这意味着它是有效的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:03:08.990

`be_*`matcher 是 rspec 的技巧之一。当你说

```
foo.should be_valid 
```

rspec 将调用`valid?`方法`foo`并检查其返回值。`valid?`方法（在您的 ORM 中定义）反过来会调用您的验证器。

简而言之，`be_valid`对验证器一无所知。这是一个通用的机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T23:15:20.067

如上所述， foo.should be_valid 只是调用 foo.valid?。由于 Foo 模型继承自 ActiveRecord::Base，并且 ActiveRecord::Base 包括其 ActiveRecord::Validations 模块，该模块本身又包括模块 ActiveModel::Validations （其中定义了 valid? 方法），您的 Foo 类立即也可以访问此方法。

你能找到关于有效的信息吗？方法在这里：[api.rubyonrails.org/classes/ActiveRecord/Validations.html#method-i-valid-3F](http://api.rubyonrails.org/classes/ActiveRecord/Validations.html#method-i-valid-3F)

# java - 是否可以回调多个监听器？

> ID：15042503
> 
> 赞同：3
> 
> 时间：2013-02-23T16:00:04.983
> 
> 标签：java, callback

是否可以使用回调设置多个侦听器？

我试图了解回调是如何工作的，我试图弄清楚这就是我所需要的。

我有一个接收/发送消息的 UDP 消息传递类。当我解析某些消息时，我想更新多个 UI 类。

目前我有这样的事情：

```
class CommInt {

    private OnNotificationEvent notifListener;

    public setNotificationListener(OnNotificationEvent notifListner) {
        /* listener from one UI */
        this.notifListener = notifListener;
    }

    private parseMsg(Message msg) {

        if (msg.getType() == x) {
            notifListener.updateUI();
        }

    }

} 
```

我还需要更新另一个 UI。其他 UI 将使用相同的界面，但主体会有所不同。

如何调用从该接口实现的所有侦听器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:02:26.767

您很可能需要创建一个侦听器列表，然后遍历每个调用`updateUI()`。当然，您还需要一种`addListener()`方法，以免被覆盖。

```
class CommInt {

  private List <OnNotificationEvent> listeners= new ArrayList <OnNotificationEvent>();

  public void addNotificationListener(OnNotificationEvent notifListner) {
    listeners.add (notifListener);
  }

  private void parseMsg(Message msg) {

    if (msg.getType() == x) {
      for (notifListener : listeners){
        notifListener.updateUI();
      }
    }

  }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:07:35.570

使用您的代码：不，因为您正在使用单个变量进行记录。用一个可变长度的容器替换它，它会占用尽可能多的侦听器：

```
class CommInt {
  private ArrayList<NotificationListener> listeners =
    new ArrayList<NotificationListener>();

  public addNotificationListener(NotificationListener listener) {
    listeners.add(listener);
  }

  private doSomething(Something input) {
    if (input.hasProperty(x)) {
      for (NotificationListener l: listeners) {
        l.inputHasProperty(x);
      }
    }
  }
} 
```

还要注意不同的命名。Java 约定是按照事物的本质或行为来调用事物。如果您有一个侦听器列表，请让它们实现 NotificationListener 接口并按原样存储它们。

此外，“set”现在是“add”（因为我们可以添加无限数量的它们），并且回调以我们执行的测试命名，以确定回调是否必要。这使您的代码保持干净，因为它强制您的方法名称和其中的代码有意义。

基于“message is type ...”的“updateUI”没有多大意义，而“msg.type = Message.CLEAR_DIALOGS”上的“l.clearDialogs()”会。

# java - 将变量名声明为方法参数的 Eclipse 快捷方式

> ID：15042506
> 
> 赞同：5
> 
> 时间：2013-02-23T16:00:23.187
> 
> 标签：java, eclipse

假设我们有一个这样的变量：

```
byte[] someByteArray; 
```

和这样的方法原型：

```
public void someMethodRequiringString(String someByteArray); 
```

然后我们想在我们的字节数组上调用我们的方法：

```
someMethodRequiringString(someByteArray); 
```

现在我们意识到我们的方法需要一个字符串来代替。假设我们已经在包**Util**中有一个名为*convertFromByteArrayToString()*的转换函数。什么是最好的获取方式

```
someMethodRequiringString(someByteArray); 
```

到

```
someMethodRequiringString(Util.convertFromByteArrayToString(someByteArray)); 
```

我的方法是将光标放在*someByteArray*前面并输入*Util。*, 点击 CTRL+Space 和 Eclipse 建议转换函数的方法名称。但是，一旦我按回车键选择这个功能，我最终会得到这样的结果：

```
 someMethodRequiringString(Util.convertFromByteArrayToString(bytearray)someByteArray); 
```

其中**bytes是在***Util.convertFromByteArrayToString(byte[] bytearray)*中声明的输入参数名称；. 我知道这可能是初学者的问题，但这里的最佳做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:16:04.183

您可能希望代码完成覆盖现有代码（而不是将其插入现有文本之前），如下所述：[http ://www.vogella.com/articles/Eclipse/article.html#tips_completion](http://www.vogella.com/articles/Eclipse/article.html#tips_completion)

或者，您也可以考虑删除已经编写的方法参数`someByteArray`点击`Ctrl``Delete`3 次（如果您的光标在它前面）或`Ctrl``Backspace`3 次（如果您的光标直接在参数之后）。然后像现在一样通过代码完成添加 Utils 方法，然后通过代码完成重新添加字节数组参数（因为 Eclipse 会建议您的变量作为最佳选择，即使尚未写入任何字符）。

第二种选择一开始可能听起来很复杂，但如果经常使用，应该会让你打字更快。

# string - 提取部分字符串

> ID：15042508
> 
> 赞同：1
> 
> 时间：2013-02-23T16:00:25.637
> 
> 标签：string, r, extract

我一直试图从 R 中的字符串（实际上是 $call）中提取一些东西，这让我抓狂。如果你有：

```
library(vars)
data <- as.data.frame(matrix(c(runif(40)), ncol=2))
z <- matrix(c(runif(40)), ncol=2)
var.modell <- VAR(data, p = 2, exogen=z, type = "trend") 
```

你如何提取z？我试过谷歌搜索和搜索堆栈溢出。我发现了这个：[R 在 R 中提取字符串的一部分](https://stackoverflow.com/questions/12443278/r-extract-a-part-of-a-string-in-r)

这让我尝试：

```
sub(".*?exogen=(.*?)", "\\1", var.modell$call, perl = TRUE) 
```

但它返回：

```
[1] "VAR"   "data"  "2"     "trend" "z" 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:10:06.847

查看`call`对象本身：

```
m <- lm(speed~dist,data=cars)
m$call$data
## cars 
```

你会想要`var.modell$call$exogen`的。

# ruby-on-rails - 遵循 Hartl's rails guide 的 Rspec 错误

> ID：15042524
> 
> 赞同：1
> 
> 时间：2013-02-23T16:02:22.590
> 
> 标签：ruby-on-rails, rspec

我已经关注该指南有一段时间了，不幸的是一直无法通过这些测试。感谢您抽出宝贵时间，因为我已经放弃寻找问题所在，迫切需要任何帮助。

```
Failures:

1) signup with valid information after saving user 
 Failure/Error: it {should have_link('Sign out')}
   expected link "Sign out" to return something
 # ./spec/requests/user_pages_spec.rb:97:in `block (4 levels) in <top (required)>'

2) signup with valid information after saving user 
 Failure/Error: it { should have_selector('div.alert.alert-success', text: 'Welcome') }
   expected css "div.alert.alert-success" with text "Welcome" to return something
 # ./spec/requests/user_pages_spec.rb:96:in `block (4 levels) in <top (required)>'

3) signup with valid information after saving user 
 Failure/Error: it { should have_selector('title', text: user.name) }
   expected css "title" with text "Example User" to return something
 # ./spec/requests/user_pages_spec.rb:95:in `block (4 levels) in <top (required)>'

4) create user page 
 Failure/Error: it {should have_selector('h1', text: 'Creating New User')}
   expected css "h1" with text "Creating New User" to return something
 # ./spec/requests/user_pages_spec.rb:56:in `block (2 levels) in <top (required)>'

5) create user page 
 Failure/Error: it {should have_selector('title', text: 'Sign Up')}
   expected css "title" with text "Sign Up" to return something
 # ./spec/requests/user_pages_spec.rb:57:in `block (2 levels) in <top (required)>'

6) edit with valid information 
 Failure/Error: it { should have_selector('div.alert.alert-success') }
   expected css "div.alert.alert-success" to return something
 # ./spec/requests/user_pages_spec.rb:132:in `block (3 levels) in <top (required)>'

7) edit with valid information 
 Failure/Error: it { should have_selector('title', text: new_name) }
   expected css "title" with text "New Name" to return something
 # ./spec/requests/user_pages_spec.rb:131:in `block (3 levels) in <top (required)>'

8) edit with valid information 
 Failure/Error: it { should have_link('Sign out', href: signout_path) }
   expected link "Sign out" to return something
 # ./spec/requests/user_pages_spec.rb:133:in `block (3 levels) in <top (required)>'

9) edit with invalid info 
 Failure/Error: it {should have_content('error')}
   expected there to be content "error" in "with invalid info"
 # ./spec/requests/user_pages_spec.rb:117:in `block (3 levels) in <top (required)>'

10) edit page 
 Failure/Error: it { should have_selector('h1',    text: "Update your profile") }
   expected css "h1" with text "Update your profile" to return something
 # ./spec/requests/user_pages_spec.rb:111:in `block (3 levels) in <top (required)>'

11) edit page 
 Failure/Error: it { should have_selector('title', text: "Edit user") }
   expected css "title" with text "Edit user" to return something
 # ./spec/requests/user_pages_spec.rb:112:in `block (3 levels) in <top (required)>'

12) profile page 
 Failure/Error: it{should have_selector('h2', text: user.name)}
   expected css "h2" with text "Person 66" to return something
 # ./spec/requests/user_pages_spec.rb:63:in `block (2 levels) in <top (required)>'

13) profile page 
 Failure/Error: it{should have_selector('title', text: user.name)}
   expected css "title" with text "Person 67" to return something
 # ./spec/requests/user_pages_spec.rb:64:in `block (2 levels) in <top (required)>' 
```

我的用户页面规范

```
require 'spec_helper'

describe "UserPages" do
subject {page}

describe "index" do
  before do
    sign_in FactoryGirl.create(:user)
    FactoryGirl.create(:user, name: "Bob", email: "bob@example.com")
    FactoryGirl.create(:user, name: "Ben", email: "ben@example.com")
    visit users_path
  end

 it { should have_selector('title', text: 'All users') }
 it { should have_selector('h1',    text: 'All Users') }

  describe "pagination" do
    before(:all) {30.times {FactoryGirl.create(:user)}}
    after(:all) {User.delete_all}

  it {should have_selector('div.pagination')}

  describe "delete links" do

    it { should_not have_link('delete') }

    describe "as an admin user" do
      let(:admin) { FactoryGirl.create(:admin) }
      before do
        sign_in admin
        visit users_path
      end

      it { should have_link('delete', href: user_path(User.first)) }
      it "should be able to delete another user" do
      expect { click_link('delete') }.to change(User, :count).by(-1)
    end

    it { should_not have_link('delete', href: user_path(admin)) }
    end
    end
  end

  it "should list each user" do
  User.all.each do |user|
    page.should have_selector('li', text: user.name)
     end
    end

  end
end

 describe "create user page" do
 before {visit new_user_path}

    it {should have_selector('h1', text: 'Creating New User')}
    it {should have_selector('title', text: 'Sign Up')}
end

describe "profile page" do
 let(:user){FactoryGirl.create(:user)}
 before {visit user_path(user)}
    it{should have_selector('h2', text: user.name)}
    it{should have_selector('title', text: user.name)}    
end 

describe "signup" do
  before { visit new_user_path }

  let(:submit) { "Create my account" }

  describe "with invalid information" do
  it "should not create a user" do
    expect { click_button submit }.not_to change(User, :count)
    end
  end

  describe "with valid information" do
   before do
    fill_in "Name",         with: "Example User"
    fill_in "Email",        with: "user@example.com"
    fill_in "Password",     with: "foobar"
    choose("user_admin_true")
    fill_in "Confirmation", with: "foobar"
   end

   it "should create a user" do
    expect { click_button submit }.to change(User, :count).by(1)  
   end

   describe "after saving user" do
    before {click_button submit}
    let(:user) { User.find_by_email('user@example.com') }

    it { should have_selector('title', text: user.name) }
    it { should have_selector('div.alert.alert-success', text: 'Welcome') }        
    it { should have_link('Sign out')}
  end

end
end

describe "edit" do
 let(:user) {FactoryGirl.create(:user)}
  before do
  sign_in user
  visit edit_user_path(user)
  end

 describe "page" do
  it { should have_selector('h1',    text: "Update your profile") }
  it { should have_selector('title', text: "Edit user") }
 end

 describe "with invalid info" do
  before {click_button "Save changes"}
  it {should have_content('error')}
 end

 describe "with valid information" do
  let(:new_name)  { "New Name" }
  let(:new_email) { "new@example.com" }
  before do
    fill_in "Name",             with: new_name
    fill_in "Email",            with: new_email
    fill_in "Password",         with: user.password
    fill_in "Confirm Password", with: user.password
    click_button "Save changes"
  end

  it { should have_selector('title', text: new_name) }
  it { should have_selector('div.alert.alert-success') }
  it { should have_link('Sign out', href: signout_path) }
  specify { user.reload.name.should  == new_name }
  specify { user.reload.email.should == new_email }
end
end 
```

用户控制器

```
 class UsersController < ApplicationController
  before_filter :signed_in_user, only: [:index, :edit, :update, :destroy]
  before_filter :correct_user,   only: [:edit, :update]
  before_filter :admin_user,     only: :destroy

  def index
    @users = User.paginate(page: params[:page])
  end

  def show
    @user = User.find(params[:id])
  end 

  def new
    @user = User.new
  end

  def create
    @user = User.new(params[:user])

      if @user.save
        sign_in @user
        flash[:success] = "Account creation succesful. Welcome to the CeFam Online Database"    
        redirect_to @user
      else
        render 'new'
     end 
  end

 def destroy
    User.find(params[:id]).destroy
    flash[:success] = "User removed."
    redirect_to users_url
  end

  def edit
    @user = User.find(params[:id])
  end

  def update
  @user = User.find(params[:id])

    if @user.update_attributes(params[:user])
      flash[:success] = "Profile updated"
      sign_in @user
      redirect_to @user
    else 
      render 'edit'
    end
  end

  private

  def admin_user
    redirect_to(root_path) unless current_user.admin?
  end

  def signed_in_user
    flash[:notice] = "Please sign in." unless signed_in?
    redirect_to signin_url unless signed_in?
  end

  def correct_user
    @user = User.find(params[:id])
    redirect_to(root_path) unless current_user?(@user)
  end

end 
```

标题

```
 <header class="navbar navbar-fixed-top navbar-inverse">
      <div class="navbar-inner">
        <div class="container">
          <%= link_to "Image Home Logo", '#', id: "logo" %>
          <nav>

            <ul class="nav pull-right">
              <li><%= link_to "Home", root_path %></li>
              <li><%= link_to "Help", help_path %></li>

              <!--Visibile only when signed in-->
              <% if signed_in? %>

              <li><%= link_to "List users", users_path %></li>
              <li><%= link_to "Search", '#' %></li>
              <li><%= link_to "Add Entry", '#' %></li>

              <li id="fat-menu" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Account <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li><%= link_to "Profile", current_user %></li>
                <li><%= link_to "Settings", edit_user_path(current_user) %></li>
                <li class="divider"></li>
                <li><%= link_to "Sign out", signout_path, method: "delete" %>
                </li>

              <%else%>
              <li><%= link_to "Sign in", signin_path %></li>
              <%end%>
            </ul>

          </nav>
        </div>
      </div>
    </header> 
```

用户的 show.html.erb

```
<% provide(:title,@user.name) %>
<h1> User Profile </h1>
<h2><%=@user.name%><br>
<%= @user.email %><br>
Administrator: <%= @user.admin%>
</h2> 
```

用户的 new.html.erb

```
<% provide(:title,'Sign Up')%>

<h1>Creating New User</h1>

<div class="row">
  <div class="span4 offset4">
    <%= form_for(@user) do |f| %>
      <%= render 'shared/error_messages' %>

      <%= f.label :name %>
      <%= f.text_field :name %>

      <%= f.label :email %>
      <%= f.text_field :email %>

      <%= f.label :admin %>

      <%= f.radio_button :admin, "true"%> Yes <br>
      <%= f.radio_button :admin, "false"%> No<br><br>

      <%= f.label :password %>
      <%= f.password_field :password %>

      <%= f.label :password_confirmation, "Confirmation" %>
      <%= f.password_field :password_confirmation %>
      <br>

      <%= f.submit "Create my account", class: "btn btn-large btn-primary" %>
    <% end %>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T05:09:13.397

这是您的至少一个问题的根源，请查看您的`user_pages_spec.rb`：

```
it "should list each user" do
  User.all.each do |user|
    page.should have_selector('li', text: user.name)
  end
end 
```

你想测试一下（因为 Capybara`User.paginate`无法`User.all`看到在单个分页视图上呈现的默认 30）。教程中解释说，测试一页就足够了，因为`will_paginate`gem 已经经过很好的测试。

所以用这个替换那个块，你的分页测试应该通过：

```
it 'should list each user' do
  User.paginate(page: 1).each do |user|
    page.should have_selector('li', text: user.name)
  end
end 
```

# c - 使用 pthreads 逐行读取文件...意外退出

> ID：15042527
> 
> 赞同：0
> 
> 时间：2013-02-23T16:02:31.713
> 
> 标签：c, pthreads, fopen, fread, pthread-join

我有以下代码：

```
 /*//not important
    FILE * INFILE;
    list_file = optarg;
    if( ( INFILE = fopen( list_file, "a+" ) ) == NULL ) {
        fprintf( stderr, "Can't open input file\n");
        exit(0);
    }
    */

    pthread_mutex_t input_queue;
    pthread_mutex_init(&input_queue, NULL);

    for( i = 0 ; i < number_thread; i++)
    {
        if( pthread_create( &thread_id[i], NULL, &work, NULL) != 0 )
        {
            i--;
            fprintf(stderr, RED "\nError in creating thread\n" NONE);
        }
    }
    for( i = 0 ; i < number_thread; i++)
        if( pthread_join( thread_id[i], NULL) != 0 )
        {
            fprintf(stderr, RED "\nError in joining thread\n" NONE);
        }

    void * work(void * data)
    {
        unsigned long line;
        char buf[512];
        while ( !feof(INFILE) )
        {
            pthread_mutex_lock(&input_queue);
            fgets((char *)&buf, sizeof(buf), INFILE);
            if (buf[strlen (buf) - 1] == '\n')
                buf[strlen (buf) - 1] = '\0';
            line = (unsigned long)buf;
            pthread_mutex_unlock(&input_queue);
            do_work( line );
        }
        fclose(INFILE);
        return NULL;
    } 
```

它从文件中读取行，但过了一会儿它意外退出，没有错误消息。我想我搞砸了什么。

***如何使用 pthreads 逐行读取文件但尽可能保持代码不变（我的意思是不要弄乱整个程序）？***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:07:48.427

您正在关闭`INFILE`遇到 EOF 的第一个线程。之后其他线程将调用`feof()`（并且可能`fclose()`）关闭的文件，这将破坏堆并且几乎肯定会导致崩溃。此外，您的换行代码可能会在 EOF 处超出您的缓冲区，请参阅下面的注释。

要解决此问题，请使用相同的互斥锁保护`feof()`和`fclose()`，并将 INFILE 设置为 NULL。获取互斥锁后，检查 INFILE 是否为 NULL，如果是则立即返回：

```
for (;;) {
  pthread_mutex_lock(&input_queue);
  if (!INFILE) {
    pthread_mutex_unlock(&input_queue);
    break;
  }
  if (feof(INFILE)) {
    INFILE = NULL;
    pthread_mutex_unlock(&input_queue);
    break;
  }

  fgets(buf, sizeof(buf), INFILE);
  pthread_mutex_unlock(&input_queue);

  // ...strip newline, do_work...
} 
```

几点说明：

*   `buf[strlen(buf) - 1]`您的代码在不检查是否`strlen(buf)`为零的情况下写入。`buf`在 EOF 时将是空的，所以这不是理论上的问题，每次执行都会发生一次。

*   `line`是 type `unsigned long`，但您正在为其分配一个指针值。这将在`long`不包含指针的平台上失败，例如 Win64。声明`line`和`do_work`as的参数`char *`（或者`void *`如果它必须接受其他指针类型）。

*   避免将您的互斥锁称为“队列”；在多线程编程队列中指的是[生产者-消费者感知 FIFO](http://en.wikipedia.org/wiki/Producer-consumer_problem)。

*   您不需要像`fgets`互斥锁那样保护单个 stdio 函数。根据 POSIX 的要求，它们是 MT 安全的。（但是，在我修改后的代码中，`fgets()`确实需要受互斥体保护，因为`INFILE`在互斥体未被持有时可能会失效。）

*   `(char *) &buf`没有意义。由于`buf`是一个`char`数组，它已经衰减为指向其第一个成员的指针，因此您可以简单地发送`buf`到`fgets`. 如果你坚持使用 address-of 运算符，正确的表达式是`&buf[0]`.

*   正如卡尔诺鲁姆暗示的那样，`feof()`可能不是你想要的，因为它只检测`fgets()`. 检查 EOF 的正确方法是*在剥离换行符之前*`fgets()`测试是否返回空字符串。

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:39:19.580

如果 INFILE 是一个全局变量，那么你已经关闭了线程函数中的引用，如果你创建了多个线程，那么其他线程中的 flcose(INFILE) 即 fclose(NULL) 预计会崩溃。无法猜测您要对多个线程执行什么操作，但是当您确定 INFILE 不再被任何其他线程访问时，最好在最后关闭它。我认为您应该在所有线程之后关闭 main 中的 INFILE 参考加入 main 并完成他们的处理。

```
#include<stdio.h>
#include<pthread.h>
#include<string.h>
#include<stdlib.h>
#define number_thread 10

FILE * INFILE;
char *list_file = "test_thread";
pthread_mutex_t input_queue;

void do_work(unsigned long buf)
{
    printf("working on %u\n",buf);
}

void * work(void * data)
{
    unsigned long line;
    char buf[512];
    printf("IAM NEW THREAD\n" );

    while ( !feof(INFILE) )
      {
        pthread_mutex_lock(&input_queue);
        fgets((char *)&buf, sizeof(buf), INFILE);
        if (buf[strlen (buf) - 1] == '\n')
            buf[strlen (buf) - 1] = '\0';
        line = (unsigned long)buf;
        pthread_mutex_unlock(&input_queue);
        do_work( line );
      }

    return NULL;
}

int main()
{
    printf("IAM MAIN THREAD\n")
    pthread_mutex_init(&input_queue, NULL);
    if( ( INFILE = fopen( list_file, "a+" ) ) == NULL ) {
        fprintf( stderr, "Can't open input file\n");
        exit(0);
    }
    pthread_t thread_id[10];

    int i=0;
    for( i = 0 ; i < number_thread; i++)
      { 
        if( pthread_create( &thread_id[i], NULL, &work, NULL) != 0 )
          {
            i--;
            fprintf(stderr,  "\nError in creating thread\n");
          }
      }

    for( i = 0 ; i < number_thread; i++)
        if( pthread_join( thread_id[i], NULL) != 0 )
          {
            fprintf(stderr,  "\nError in joining thread\n" );
          }

    fclose(INFILE);
} 
```*

# objective-c - 在 Cocoa 中解密 RSA 公钥

> ID：15042529
> 
> 赞同：0
> 
> 时间：2013-02-23T16:02:46.477
> 
> 标签：objective-c, cocoa, openssl, sscrypto

我在 Cocoa 环境中解密 RSA 公钥时遇到了麻烦。我在 public.pem 中加密了哈希、公钥和`-----BEGIN PUBLIC KEY-----`警卫（由 openssl 生成）

```
NSData *encryptedData = base64dec(license);

NSString *publicKeyPath = [[NSBundle mainBundle] pathForResource:@"public" ofType:@"pem"];
NSData *publicKeyData = [NSData dataWithContentsOfFile:publicKeyPath];

SSCrypto *crypto = [[SSCrypto alloc] initWithPublicKey:publicKeyData];

[crypto setClearTextWithData:encryptedData];
[crypto verify];

NSString *verifiedKey = [crypto clearTextAsString]; 
```

但`verifiedKey`始终为零。看起来 SSCrypto 无法将 NSData 转换为 NSString。我如何才能真正解密数据？

* * *

最终使用此代码（以消除 base64 解码步骤）

```
[crypto setCipherTextFromBase64String:license];
NSString *verifiedKey = [crypto clearTextAsString]; 
```

但`verifiedKey`始终是一个空字符串。这是什么意思？输入数据似乎是正确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:31:39.063

由于您正在解密加密数据，因此您应该执行 setCipherText: 而不是 setClearTextWithData:

此外，调用 verify 而不使用其返回值是没有用的。

# sql - 在 sql server 中使用 ROW_NUMBER 时索引不起作用

> ID：15042532
> 
> 赞同：-1
> 
> 时间：2013-02-23T16:02:53.887
> 
> 标签：sql, sql-server, row-number, non-clustered-index

我已经使用 Row_Number() 在我的存储过程中实现分页。分页工作正常。但问题是，在实现 Row_Number() 之后，索引不起作用，即使我按部分顺序使用主键列，也会发生聚集索引 SCAN。以下是示例查询：

```
SELECT TOP (@insPageSize) A.RowNum, A.AdID, A.AdTitle, A.AdFor, A.AdCondition, 
A.AdExpPrice, A.CreatedDate, A.ModifiedDate, A.AdUID
FROM
(
SELECT ROW_NUMBER() OVER (ORDER BY vaa.AdID DESC) AS RowNum,
    vaa.AdID, vaa.AdTitle, vaa.CityID, vaa.AdFor, vaa.AdCondition, 
    vaa.AdExpPrice, vaa.CreatedDate, vaa.ModifiedDate, vaa.AdUID
FROM Catalogue.vwAvailableActiveAds vaa
WHERE vaa.CategoryID = @intCategoryID AND vaa.CountryCode = @chrCountryCode 
        AND vaa.CreatedDate > DATEADD(dd, -90, GETUTCDATE()) 
        AND vaa.StateID = @inbStateID AND vaa.CityID = @inbCityID
) A
WHERE A.RowNum > (@insPageSize * (@insPageNo - 1)) 
```

如果我尝试只执行内部查询：

```
 SELECT ROW_NUMBER() OVER (ORDER BY vaa.AdID DESC) AS RowNum,
    vaa.AdID, vaa.AdTitle, vaa.CityID, vaa.AdFor, vaa.AdCondition, 
    vaa.AdExpPrice, vaa.CreatedDate, vaa.ModifiedDate, vaa.AdUID
FROM Catalogue.vwAvailableActiveAds vaa
WHERE vaa.CategoryID = @intCategoryID AND vaa.CountryCode = @chrCountryCode 
        AND vaa.CreatedDate > DATEADD(dd, -90, GETUTCDATE()) 
        AND vaa.StateID = @inbStateID AND vaa.CityID = @inbCityID 
```

它不使用任何索引。AdID 是主键，还有另一个非聚集索引涵盖所有 where 子句。但是会发生索引扫描。如果我从内部查询中删除 Row_Number() 并检查其执行计划，所有索引都可以正常工作，但 StateID 和 CityID 在非聚集索引中时再次显示为“谓词”。

请给我一些指导来解决我的两个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:28:59.263

你期待什么，寻求？您在这里做了几件事，这使得执行查找变得非常困难：（a）返回一个范围的行；(b) 按 AdID *DESC*排序以获得 ROW_NUMBER() - 可能不是定义 PK 的顺序；(c) 过滤除 PK 之外的其他内容，以及 (d) 在输出中包括许多列，这些列不太可能被任何 NC 索引覆盖。很多人把手举在空中，大喊：“天哪！这是扫描！这太可怕了！” 即使在事实上，这是最有效的方法的情况下。

（仅仅因为没有发生搜索并不意味着“索引不起作用”——这只是意味着它们在满足这个查询方面可能效率更低。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:23:25.203

`row_number()`没有使用索引，因为必须先过滤数据。而且，这似乎需要全表扫描。或者，至少，索引的复杂组合。

如果你建立一个索引，`vwAvailableActiveAds(CategoryId, COuntryCode, StateId, CityId, CreatedDate)`那么它应该使用这个索引作为`where`子句。的应用程序`row_number()`仍然不会使用索引，但可能会使用更小的数据集。

顺便说一句，这假设视图实际上只是基础表上的一个选择。如果视图中的查询更复杂（即使使用`where`子句`join`、、或`group by`），那么该特定索引可能不是最佳方法。

# c++ - boost-asio 编译失败（C++ 类中的初始化列表）？

> ID：15042540
> 
> 赞同：0
> 
> 时间：2013-02-23T16:03:55.760
> 
> 标签：c++, class, boost-asio, initializer-list

我正在尝试编译此代码

```
#ifndef TCPIP_H
#define TCPIP_H

#include <cstdlib>
#include <cstring>
#include <iostream>
#include <boost/asio.hpp>

using boost::asio::ip::tcp;

enum { max_length = 1024 };

class TCPIP
{
        private:

            boost::asio::io_service io_service;
            tcp::resolver resolver;
            tcp::resolver::query query;
            tcp::resolver::iterator iterator;
            tcp::socket s;

        public:

        TCPIP():resolver(io_service),
        query("127.0.0.1", "2345"),
        iterator(resolver.resolve(query)),
        s(io_service),
        boost::asio::connect(s, iterator)
        {}
        ~TCPIP(){}
        void IO()
        {
            std::cout << "Enter message: ";
            char request[max_length];
            std::cin.getline(request, max_length);
            size_t request_length = std::strlen(request);
            boost::asio::write(s, boost::asio::buffer(request, request_length));

            char reply[max_length];
            size_t reply_length = boost::asio::read(s,
            boost::asio::buffer(reply, request_length));
            std::cout << "Reply is: ";
            std::cout.write(reply, reply_length);
            std::cout << "\n";
        }
};
#endif 
```

我得到了这些错误

```
c:\program files\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\boost\asio\detail\config.hpp|205|warning: #warning Please define _WIN32_WINNT or _WIN32_WINDOWS appropriately.|
c:\program files\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\boost\asio\detail\config.hpp|206|warning: #warning For example, add -D_WIN32_WINNT=0x0501 to the compiler command line.|
c:\program files\codeblocks\mingw\bin\..\lib\gcc\mingw32\4.4.1\..\..\..\..\include\boost\asio\detail\config.hpp|207|warning: #warning Assuming _WIN32_WINNT=0x0501 (i.e. Windows XP target).|
C:\Documents and Settings\My Documents\project5\erlang_connect\TCPIP.h||In constructor 'TCPIP::TCPIP()':|
C:\Documents and Settings\My Documents\project5\erlang_connect\TCPIP.h|26|error: expected class-name before '(' token|
C:\Documents and Settings\My Documents\project5\erlang_connect\TCPIP.h|26|error: expected '{' before '(' token|
C:\Documents and Settings\My Documents\project5\erlang_connect\erlang_connect.cpp||In function 'int main()':|
C:\Documents and Settings\My Documents\project5\erlang_connect\erlang_connect.cpp|7|error: expected primary-expression before ';' token|
C:\Documents and Settings\My Documents\project5\erlang_connect\erlang_connect.cpp|5|warning: unused variable 'INTERFACE'|
||=== Build finished: 3 errors, 4 warnings ===| 
```

基本上这个问题与初始化列表和声明的问题有关`boost::asio::connect(s, iterator)`。这是用于制作它的原始 Boost 源代码（boost 阻塞 tcp-client）。我尝试使用指针，但 boost 库不喜欢这个主意！

```
//
// blocking_tcp_echo_client.cpp
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
// Copyright (c) 2003-2012 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0\. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#include <cstdlib>
#include <cstring>
#include <iostream>
#include <boost/asio.hpp>

using boost::asio::ip::tcp;

enum { max_length = 1024 };

int main(int argc, char* argv[])
{
  try
  {
    if (argc != 3)
    {
      std::cerr << "Usage: blocking_tcp_echo_client <host> <port>\n";
      return 1;
    }

    boost::asio::io_service io_service;

    tcp::resolver resolver(io_service);
    tcp::resolver::query query(tcp::v4(), argv[1], argv[2]);
    tcp::resolver::iterator iterator = resolver.resolve(query);

    tcp::socket s(io_service);
    boost::asio::connect(s, iterator);

    using namespace std; // For strlen.
    std::cout << "Enter message: ";
    char request[max_length];
    std::cin.getline(request, max_length);
    size_t request_length = strlen(request);
    boost::asio::write(s, boost::asio::buffer(request, request_length));

    char reply[max_length];
    size_t reply_length = boost::asio::read(s,
        boost::asio::buffer(reply, request_length));
    std::cout << "Reply is: ";
    std::cout.write(reply, reply_length);
    std::cout << "\n";
  }
  catch (std::exception& e)
  {
    std::cerr << "Exception: " << e.what() << "\n";
  }

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:20:05.927

在初始化列表中，表达式需要调用父类的任一成员的构造函数。要解决这个问题，只需移动`boost::asio::connect()`到构造函数主体。

```
TCPIP()
  : resolver(io_service),              // calls resolver constructor
    query("127.0.0.1", "2345"),        // calls query constructor
    iterator(resolver.resolve(query)), // calls iterator constructor
    s(io_service)                      // calls socket constructor
{
  boost::asio::connect(s, iterator);
} 
```

此外，请考虑解析器、查询和迭代器是否需要在`TCPIP`对象的整个生命周期内都可以访问。`TCPIP`让它们成为' 的构造函数中的自动变量可能是值得的，结果如下：

```
TCPIP()
  : s(io_service)
{
  tcp::resolver resolver(io_service);
  tcp::resolver::iterator iterator =
    resolver.resolve(tcp::resolver::query(("127.0.0.1", "2345"));
  boost::asio::connect(s, iterator);
} 
```

# php - 将 kannel SMS 存储到 mysql 数据库中

> ID：15042543
> 
> 赞同：1
> 
> 时间：2013-02-23T16:04:02.267
> 
> 标签：php, mysql, kannel

我的 Kannel.conf 和 sqlbox.conf 设置良好并且工作正常，我可以正确发送和接收消息，除了现在我想将它们存储在发送和接收的数据库中。能否请一些人显示将 kannel 接收和发送的消息保存到 MySql 数据库中的脚本

# java - JSyn：两个通道上的正弦波

> ID：15042555
> 
> 赞同：1
> 
> 时间：2013-02-23T16:05:11.367
> 
> 标签：java, audio, trigonometry, jsyn

**在发布此问题之前，我已经解决了问题。不过我认为这可能对其他人有帮助，所以我还是发布了它。如果有人知道更好或更优雅的方法来做到这一点，请发布答案。如果我同意，我当然会接受你的回答。这是我原来的问题：**

我正在尝试使以下内容与[JSyn](http://www.softsynth.com/jsyn/)一起使用：

我想在两个通道上播放 800Hz 正弦波，并随时打开或关闭各个通道。因此，例如，我想要以下序列：

```
 time  0s  0.3s      0.8s   1s            1s  1.1s    1.5s
 left  |--------------------|              |-----------|  
 right |----|         |------------------------| 
```

我可以在一个或两个通道上生成正弦波，但我还没有弄清楚如何打开/关闭它们。这是一些代码：

```
import com.jsyn.JSyn;
import com.jsyn.Synthesizer;
import com.jsyn.unitgen.LineOut;
import com.jsyn.unitgen.SineOscillator;

public class MusicTest {
    public static void main(String[] args) {
        playSound();
    }

    public static void playSound() {
        Synthesizer synth = JSyn.createSynthesizer();
        try {
            synth.start();
            SineOscillator sineOsc1 = new SineOscillator(500, 0.2);
            SineOscillator sineOsc2 = new SineOscillator(500, 0.2);
            LineOut lineOut= new LineOut();

            synth.add(lineOut);
            synth.add(sineOsc1);
            synth.add(sineOsc2);

            sineOsc1.output.connect(0, lineOut.input, 0); // left channel
            sineOsc2.output.connect(0, lineOut.input, 1); // right channel

            lineOut.start();

            sineOsc1.start(); // start left
            sleep(1000);
            sineOsc2.start(); // after 1s, start right
            sleep(1000);
            sineOsc1.stop(); // after 1s, stop left
            sleep(1000);
            sineOsc2.stop(); // after 1s, stop

            lineOut.stop();
        } finally {
            synth.stop();
        }
    }

    private static void sleep(int ms) {
        try {
            Thread.sleep(ms);
        } catch (InterruptedException e) {}
    }
} 
```

不幸的是，这不起作用......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T16:25:06.993

第一个示例不起作用的原因是 JSyn 通过连接的单元生成器“拉”数据。

start() 方法将一个单元添加到由引擎直接执行的单元列表中。您 start() 链的末端，例如 LineOut。当一个单元执行时，它会从连接到其输入的任何单元中请求数据。反过来，这些单元从与其连接的任何单元请求数据。这保证了单元以最小化延迟的顺序执行。JSyn 检查循环连接以防止无限循环。

即使您 stop()ped SineOscillators，LineOut 仍在拉动它们。于是他们发出声音。

不要在振荡器上调用 start() 或 stop()，而是调用 setEnabled(f)。这将阻止数据的拉取。在您的第一个示例中尝试此代码段：

```
sineOsc1.setEnabled( false ); // begin disabled
sineOsc2.setEnabled( false );
lineOut.start();

sineOsc1.setEnabled(true); // start left
sleep(1000);
sineOsc2.setEnabled(true); // after 1s, start right
sleep(1000);
sineOsc1.setEnabled( false ); // after 1s, stop left
sleep(1000);
sineOsc2.setEnabled( false ); // after 1s, stop 
```

另一种方法是使用一个振荡器并通过乘法单元将其连接到 LineOut 的每个通道。然后，您可以通过乘以 1.0 或 0.0 打开或关闭该通道上的正弦波。这允许您乘以标量，例如。0.5，如果你想半开。

```
    sineOsc ---> multiply1 ---> lineOut(0) // 左声道
            `--> multiply2 ---> lineOut(1) // 右声道

```

我意识到 setEnabled() 和 start() 方法没有很好的记录。我现在会解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:05:11.367

解决方案是不要尝试打开/关闭正弦波，而只需使用两个`LineOut`. 像这样：

```
public static void playSound() {
    Synthesizer synth = JSyn.createSynthesizer();
    try {
        synth.start();
        SineOscillator sineOsc1 = new SineOscillator(500, 0.2);
        LineOut lineOut1 = new LineOut();
        LineOut lineOut2 = new LineOut();

        synth.add(lineOut1);
        synth.add(lineOut2);
        synth.add(sineOsc1);

        sineOsc1.output.connect(0, lineOut1.input, 0); // connect to left channel
        sineOsc1.output.connect(0, lineOut2.input, 1); // connect to right channel

        lineOut1.start(); // start left
        sleep(1000);
        lineOut2.start(); // after 1s, start right
        sleep(1000);
        lineOut1.stop(); // after 1s, stop left
        sleep(1000);
        lineOut2.stop(); // after 1s, stop
    } finally {
        synth.stop();
    }
} 
```

我不知道这是否是最优雅的解决方案，但它真的很棒。我希望这对其他人有帮助。

# ruby-on-rails-3 - 使用 new_foo_path(@bar) 添加具有外键关系的新记录

> ID：15042557
> 
> 赞同：0
> 
> 时间：2013-02-23T16:05:17.683
> 
> 标签：ruby-on-rails-3, foreign-keys

我正在尝试使用 Ruby on Rails添加一个新`location`的。`restaurant`

在`restaurants#show`我运行的动作中：

```
<%= link_to 'Add Location', new_location_path(@restaurant) %> 
```

我得到一个 URL: ，餐厅的 id 在`http://localhost:3000/locations/new.1`哪里。`1`但是没有出现新的位置表格。

处理这个简单案例的 Rails 方法是什么？使用`new_FOO_path`甚至是正确的事情吗？

在这种情况下，我**不应该**通过下拉菜单来选择餐厅，因为我希望最终用户只能将餐厅添加`location`到他们自己的餐厅。我会以某种方式需要在添加位置表单中使用餐厅 ID 进行隐藏输入，并在后端验证该 ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:10:37.627

我会在你的 routes.rb 中创建一个[嵌套资源。](http://guides.rubyonrails.org/routing.html#nested-resources)例子：

```
resources :restaurants do
  resources :locations
end 
```

那么您的链接目标将是`new_restaurant_location_path(@restaurant)`. 在您的控制器中，您可以通过`Restaurant.find(params[:restaurant_id])`.

或者，将餐厅 ID 设置为 GET 参数`new_location_path(:restaurant_id => @restaurant.id)`。

# javascript - 在画布 html 5 上堆叠框使其正常工作无法通过网格数组和速度来解决小问题

> ID：15042560
> 
> 赞同：0
> 
> 时间：2013-02-23T16:05:49.703
> 
> 标签：javascript, canvas

我的代码在下面，你可以在这里查看[http://jsfiddle.net/ShaShads/S9Pc5/](http://jsfiddle.net/ShaShads/S9Pc5/)

```
$(document).ready(function() {

var canvas = $('canvas')[0]; // get the canvas element
var ctx = canvas.getContext('2d'); // create the canvas context
var engine = new engine(); // holds the game engine
var blockActive = false; // whether a block is actively dropping

function engine() {

    this.cellSize = 50; // the size of each side of a grid cell square

    this.cellX = canvas.width / this.cellSize; // the amount of columns along the x axis

    this.cellY = canvas.height / this.cellSize; // the amount of cells along the y axis

    this.totalCells = this.cellX * this.cellY; // the total amount of cells in the grid

    this.buildGrid = function() { // returns the grid which is dynamically built
        var arr = new Array(this.cellX); // array with the same length as number of cells on x axis
        for(var i = 0; i < arr.length; ++i) { // iterate over the array
            arr[i] = new Array(this.cellY); // each value of array contains an array to the length of cells on y axis
        }
        return arr;
    };

    this.grid = this.buildGrid(); // where the grid array is stored

    this.getGridX = function(x) { // returns the x coordinate of where an entity should be placed in the grid array
        return Math.ceil(x / this.cellSize);
    };

    this.getGridY = function(y) { // returns the y coordinate of where an entity should be placed in the grid array
        return Math.ceil(y / this.cellSize);
    };

    this.checkGridDown = function(x, y) { // check for collision on next block down
        if(y >= (canvas.height - this.cellSize)) { // block has hit bottom of canvas
            return true;
        }
        if(this.grid[this.getGridX(x)][this.getGridY(y) + 1]) { // block has landed on top of another block
            return true;
        }
        return false; // no collisions found
    };

    this.gridDraw = function() { // draws all the entities of the grid onto the canvas
        for(var i = 0; i < this.grid.length; ++i) { // for each array in grid
            for(var i2 = 0; i2 < this.grid[i].length; ++i2) { // for each array in array of grid
                if(this.grid[i][i2]) { // entity exists, paint it to the canvas
                    ctx.fillStyle = this.grid[i][i2].color;
                    ctx.fillRect(this.grid[i][i2].x, this.grid[i][i2].y, this.cellSize, this.cellSize);
                }
            }
        }
    };
}

function block() {

    this.xStart = function() { // returns a random location of where a block should be inserted onto the grid
        var x = Math.floor(Math.random() * (engine.cellX - 1 + 1)) + 1; // generates random number between 1 and max column of grid
        return (x - 1) * engine.cellSize; // returns the x coordinate for the block
    };

    this.x = this.xStart();

    this.y = 0 - engine.cellSize; // the y coordinate for the block

    this.velocity = 10; // the speed at which the block will travel

    this.generateColor = function() { // returns a random color for the given block
        var colors = ['blue', 'red', 'green', 'black', 'orange']; // the colors a block can be
        return colors[Math.floor(Math.random() * colors.length)];
    };

    this.color = this.generateColor(); // the color of the block

    this.draw = function() { // draws the block onto the canvas
        ctx.fillStyle = this.color;
        ctx.fillRect(this.x, this.y, engine.cellSize, engine.cellSize);
    };

    this.update = function() { // updates the blocks movements
        if(!engine.checkGridDown(this.x, this.y)) { // check for collision
            this.y += this.velocity;
        } else { // block has collided
            this.storeBlock(); // store the block in the allocated cell
            blockActive = false; // change the blockActive boolean
        }
    };

    this.storeBlock = function() { // stores the block in the required cell of the grid

        engine.grid[engine.getGridX(this.x)][engine.getGridY(this.y)] = blockActive;
    };
}

function clearCanvas() {
    ctx.fillStyle = '#eee';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
}

function gameLoop() {
    clearCanvas(); // clear the canvas background
    engine.gridDraw(); // draw all of the blocks stored in the grid
    if(!blockActive) { // no block is actively dropping
        blockActive = new block(); // create new block
    } else { // block is actively dropping
        blockActive.draw(); // draw the block
        blockActive.update(); // update the block
    }
}

setInterval(gameLoop, 16); // run the game
}); 
```

您会注意到，在第一个盒子落地后，我已经成功地将盒子堆叠在一起，并且由于某种原因，第一个盒子被保存在网格数组中的错误单元格中。第一个盒子着陆方式的差异还取决于它的行进速度。

我已经尝试了 2 个小时来弄清楚，但我做不到。我才学了2天，如果很简单请见谅！

**编辑**

将速度更改为 20 可以更好地显示问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:29:19.257

您的问题出在更新方法中。

Even though your array says the new block has collided with the block underneath, the “Y coordinate” of the new block might not be exactly on top of the block underneath.

So if the array indicates a collision, be sure to adjust the new block’s “Y coordinate” so the new block sits flushly on top of the block it collided into.

Here is pseudocode to correct your problem:

```
this.update = function() { // updates the blocks movements
if(!engine.checkGridDown(this.x, this.y)) { // check for collision
    this.y += this.velocity;
} else { // block has collided

    // PROBLEM -- this newest colliding block might not have been
    // set exactly on top of the block underneath
    // PSEUDOCODE CORRECTION
    this.y = // the block underneath this block’s “Y coordinate” – cellSize;

    this.storeBlock(); // store the block in the allocated cell
    blockActive = false; // change the blockActive boolean
} 
```

};

# javascript - 将字符串包裹在括号中，但在字符串中也有随机值：

> ID：15042565
> 
> 赞同：-4
> 
> 时间：2013-02-23T16:06:38.820
> 
> 标签：javascript, string

如何将字符串包装在其中包含另一个随机值的括号中？看看这个，以便更好地理解：

```
var str = "ss(X)+ss(X)" 
```

进入：

```
"(ss(X))+(ss(X))" 
```

注意：X 可以是任何值，例如：“223”或“abc”“2+2+2”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:14:50.783

如果字符串是随机数据，那么这是不可能的，因为你不知道你真正想要包装什么。第 1 步：找出“这应该被包装”与“这不应该被包装”的条件。然后我们可以做一个简单的替换：

```
var shouldbewrapped = /([a-zA-Z\(\)])+/g;
var wrapped = string.replace(shouldbewrapped, function(found) {
  return "(" + found + ")";
}); 
```

这会进行正则表达式替换，但不是用字符串替换字符串，而是用在该字符串上运行的函数的输出替换字符串。

（请注意，'g' 至关重要，因为它使替换适用于字符串中的所有匹配项，而不是在运行一次替换后停止）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:11:45.213

我认为你需要做一些[字符串插值](https://stackoverflow.com/questions/6088382/why-use-string-interpolation)。然后你可以设置一些`Math.random`或任何你想要生成随机性的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T16:55:26.473

你可以试试这个：

```
str = str.replace(/\w*\(\d*\)/g, function () {return '(' + arguments[0] + ')';}); 
```

[jsFiddle](http://jsfiddle.net/69gBp/)的现场演示

* * *

**编辑**

由于您已更改条件，因此无法通过正则表达式完成该任务。[我在jsFiddle](http://jsfiddle.net/RAZby/)举了一个例子，你怎么能做到这一点。作为副作用，此代码段还检测可能的奇数括号。

```
function addBrackets (string) {
    var str = '(' + string,
        n, temp = ['('], ops = 0, cls;
    str = str.replace(/ /g, '');
    arr = str.split('');
    for (n = 1; n < arr.length; n++) {
        temp.push(arr[n]);
        if (arr[n] === '(') {
            ops = 1;
            while (ops) {
                n++;
                temp.push(arr[n]);
                if (!arr[n]) {
                    alert('Odd opening bracket found.');
                    return null;
                }
                if (arr[n] === '(') {
                    ops += 1;
                }
                if (arr[n] === ')') {
                    ops -= 1;
                }
            }
            temp.push(')');
            n += 1;
            temp.push(arr[n]);
            temp.push('(');
        }
    }
    temp.length = temp.length - 2;
    str = temp.join('');
    ops = str.split('(');
    cls = str.split(')');
    if (ops.length === cls.length) {
        return str;
    } else {
        alert('Odd closing bracket found.');
        return null;
    }   
} 
```

* * *

Just as a sidenote: If there's a random string within parentheses, like `ss(a+b)` or `cc(c*3-2)`, it can't be matched by any regular pattern. If you try to use `.*` special characters to detect some text (with unknown length) within brackets, it fails, since this matches also `)`, and all the rest of the string too...

# excel - 在 VBA 中过早退出循环

> ID：15042566
> 
> 赞同：1
> 
> 时间：2013-02-23T16:06:46.147
> 
> 标签：excel, for-loop, vba

我的循环似乎过早退出。基本上，我想要以下条件：

当 WC(j-1)+WCinit*dz 大于 pwp 如果 fc-WC(j-1)+WCinit+RefEF*dz 小于 Precip *dz

那么径流和渗流等于 precip-fc- (WC+WCinit)+RefET*dz*0.5 和 WJ(j)=fc

否则径流和渗流=0 和 WC(j)=WC(j-1)+WCinit+precip-RefET*dz

但是如果 WC(j - 1) + WCinit(i) <= pwp 那么 prin WC(j)=pwp

我希望整个循环在 i 和 j =12 时结束

当 j=2 时，循环似乎正在结束

```
Dim fc As Double
fc = Cells(4, 7).Value
NumMonth = 12
i = 1
j = 2
Dim pwp As Double
pwp = Cells(4, 8).Value
Dim dz As Double
dz = 0.5    'm

While (WC(j - 1) + WCinit(i) * dz > pwp * dz) And (j <= NumMonth)
    If (fc - (WC(j - 1) + WCinit(i)) + RefET(i) * dz) < (Precip(i) * dz) Then
        Runoff(i) = (Precip(i) - fc - (WC(j - 1) + WCinit(i)) + RefET(i) * dz) * 0.5
        Percolation(i) = (Precip(i) - fc - (WC(j - 1) + WCinit(i)) + RefET(i) * dz) * 0.5
        WC(j) = fc

    Else
        Runoff(i) = 0
        Percolation(i) = 0
        WC(j) = WC(j - 1) + WCinit(i) + Precip(i) - RefET(i) * dz

    End If
    j = j + 1
    i = i + 1

Wend
If WC(j - 1) + WCinit(i) <= pwp Then
    Runoff(i) = 0
    Percolation(i) = 0
    WC(j) = pwp
End If 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:20:10.560

正如我们在评论中所讨论的，代码永远不会进入`While`循环，因为条件的第一部分`WC(j - 1) + WCinit(i) * dz`永远不会为真。第二部分，`j <= NumMonth`显然是正确的。

要进行这项工作，并能够增加 j 直到`While`条件为真，您将需要一种不同类型的循环，也许是 Do Until。请参阅此[MSDN 参考](http://msdn.microsoft.com/en-us/library/eked04a7.aspx)。

# javascript - 如果名称已被使用，请附加一个数字？

> ID：15042568
> 
> 赞同：1
> 
> 时间：2013-02-23T16:06:52.947
> 
> 标签：javascript, jquery

在 Javascript 中，我有一个脚本允许我将文件上传到我的服务器，然后检索输出。输出的一个组成部分是上载文件的名称。例如，输出名称可能如下所示：

```
test.pdf 
```

然后将 的内容`test.pdf`保存到一个`localStorage`键中，项目名称是文件的名称：`localStorage.setItem(name, data)`.

这可以正常工作，但当文件名与正在上传和检索的文件名相同时就不行了。

我的意思是，如果用户上传一个名为 的文件`Hello 34.pdf`，它将将该文件的名称和内容保存到 LS 键。但是，如果他们再次上传相同的文件，或者使用相同名称的不同文件，那么它将替换具有相同名称的当前文件。

为了解决这个问题，我需要能够在文档标题的末尾附加一个数字，以便您可以在 LS 中拥有尽可能多的同名文件版本。

我知道我可以检查文件是否与已经上传的文件同名，如下所示：

```
var title = $('#file')[0].files[0]["name"];
if (localStorage.getItem(title)) {
  alert("same name");
}
localStorage.setItem(title, data); 
```

但是从那里我无法弄清楚如何在末尾添加一个数字。我不认为正则表达式是这样做的合适方法，因为：

```
if (title.match(/[\.pdf ]\d/g) != null) {
    var number = title.match(/[\.pdf ]\d/g) + 1;
} else {
    var number = "1";
} 
```

依赖于`.pdf`扩展名，而 JS 正则表达式通常不好。

有没有更好的方法来做到这一点？我应该以不同的方式索引文件名吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:43:14.820

由于 localStorage 将所有项目存储为字符串，因此开发人员可以跟踪用于索引该数据的键。实际文件在上传时不会重复；只有密钥会被复制。
也就是说，我将为每个上传的文件附加一个唯一的 ID，如下所示：

```
fileName = test.pdf
fileKey = test.pdf#1 
```

然后将文件名作为键存储在本地存储中，值将是您现在的“版本”，例如：

```
localStorage.setItem("test.pdf", "1"); 
```

然后您可以为每个新修订增加该值并轻松获取下一个修订的密钥并将文件存储在本地存储中，如下所示：

```
localStorage.setItem("test.pdf#1", "file data here"); 
```

那有意义吗？

**编辑（一个例子）：**

-- 存储数据：

```
var title = $('#file')[0].files[0]["name"];
var revNo = 1;
if (localStorage.getItem(title)) {
  revNo = localStorage.getItem(title);
  revNo++;
}
localStorage.setItem(title, revNo);
localStorage.setItem(title + "#" + revNo, data); 
```

-- 检索数据：

```
var title = $('#file')[0].files[0]["name"];
var revNo = 1;
if (localStorage.getItem(title)) {
  revNo = localStorage.getItem(title);
}
// get the latest revision
var data = localStorage.getItem(title + "#" + revNo); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:43:38.860

您可能有超过 2 个同名文件

```
var title= $('#file')[0].files[0]["name"];
if(localStorage.getItem(title)){
    var n= 1;
    while(localStorage.getItem(title+n)) n+= 1;
    title= title+n;
}
localStorage.setItem(title, data); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T16:28:47.690

您不能将文件存储在数组中吗？像这样的东西（徒手）：

```
if (localStorage.getItem(title)) {
    var files = JSON.parse(localStorage[title]);
    files.push(data);
    localStorage.setItem(title, JSON.stringify(files);
} else
    localStorage.setItem(title, JSON.stringify([data])); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T16:29:33.857

如果您确实决定通过 RegEx 路线，这将在标题字符串的末尾找到一个数字，然后将其增加 1 -

```
var title = "hello.pdf1"

if (title.match(/(\d+)$/)) {
    var number = parseInt(title.match(/(\d+)$/)[1],10) + 1;
} else {
    var number = "1";
} 
```

# bower - 选择凉亭安装目录

> ID：15042570
> 
> 赞同：57
> 
> 时间：2013-02-23T16:07:24.447
> 
> 标签：bower

[这是对这个问题](https://stackoverflow.com/q/14079833/759866)的跟进。我正在使用 bower 0.7.1，但仍然无法将组件安装在`components`文件夹中的任何其他位置。

`component.json`根据[此 PR](https://github.com/twitter/bower/pull/94) ，我尝试将以下行添加到我的中：

```
"componentsDirectory": "public/components" 
```

但它仍然会安装在`./components`.

我试图在`.bowerrc`旁边创建一个文件`component.json`：

```
{
  "directory" : "public/components"
} 
```

但是运行时出现此错误`bower install`：

> 错误：无法解析本地 .bowerrc 文件：意外令牌}

任何的想法？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2013-02-23T18:26:04.610

实际上 .bowerrc 文件确实有效，这是我的 IDE 没有正确保存文件的问题：

```
{
  "directory" : "public/components"
} 
```

不过，我仍然想知道为什么`componentsDirectory`仍然无法在`component.json`.

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-02-28T14:57:42.803

虽然您可以愉快地使用 Bower 来管理您自己的个人项目的依赖关系，但主要是*为其他人*`component.json`描述您的项目。如果您通过 Bower 注册表共享一个组件，则它会随之描述依赖关系。这就是为什么您自己的*本地*偏好（例如在何处安装组件）不属于其中的原因。*`component.json`*

 *** * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-12-29T02:49:29.053

另一种临时更改安装目录的方法是`--config`在命令行中使用选项：

`bower install jquery --config.directory=/path/to/your/components`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-06-11T02:15:59.317

如果您在 Notepad++ 中创建此文件，请确保将编码设置为“在没有 BOM 的 UTF-8 中编码”并保存为文件类型“任何”。**

# linux - 查找出现 2 个给定单词的文件

> ID：15042580
> 
> 赞同：1
> 
> 时间：2013-02-23T16:08:32.253
> 
> 标签：linux, shell, ack

（如何）我能否找到在同一个文件中出现 2 个单词的文件，比如`Peter`和`James`？有可能`ack-grep`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:10:12.933

你可以 grep 两次：

```
grep -l Peter * | xargs grep -l James 
```

同样适用于`ack`：

```
ack -l Peter * | xargs ack -l James 
```

您可以将 替换为`*`您可能关心的任何其他文件列表，或用于`find`为您生成列表。

# twitter-bootstrap - 无法将三个 span4 元素放入 span12 容器中

> ID：15042583
> 
> 赞同：0
> 
> 时间：2013-02-23T16:09:15.930
> 
> 标签：twitter-bootstrap

我仍在学习 Twitter Bootstrap，但我遇到了一个奇怪的问题。我以前用过960gs，从来没有遇到过这样的问题。所以，我想将三个`.span3`元素放入`.span12`容器中。我的代码如下：

```
 <ul class="dropdown-menu span12 row">
                    <li class="span4">asd</li>
                    <li class="span4">asd</li>
                    <li class="span4">asd</li>
                </ul> 
```

我不明白，为什么最后一个`.span4`元素会掉下来。我认为第一个元素会被`margin-left`取消或其他东西。我做错什么了？

完整代码：http: [//jsfiddle.net/KPzBH/1/](http://jsfiddle.net/KPzBH/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-29T09:43:02.767

添加“row-fluid”类的 div 而不是“row”...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:17:02.640

应该是错的

```
<li class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle" href="#">gry <b class="caret"></b></a>
        <ul class="dropdown-menu row-fluid">
            <li class="span4">asd</li>
            <li class="span4">asd</li>
            <li class="span4">asd</li>
        </ul>
</li> 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/rtQa6/)

由于您使用 a`span12`作为父级，我建议您将其删除`row`并替换为该`dropdown-menu`行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T17:45:22.887

我解决了它。代码有点多，但仅使用 Bootstrap 的类而不需要额外定义宽度时效果很好。

这里是：

```
<li class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle" href="#">gry <b class="caret"></b></a>
                        <ul class="dropdown-menu span12">
                            <li>
                                <div class="row">
                                    <div class="span3 offset1">
                                        <ul>
                                            <li>asd</li>
                                            <li>sss</li>
                                            <li>bb</li>
                                        </ul>
                                    </div>
                                    <div class="span3">
                                        <ul>
                                            <li>asd</li>
                                            <li>sss</li>
                                            <li>bb</li>
                                        </ul>
                                    </div>
                                    <div class="span3">
                                        <ul>
                                            <li>asd</li>
                                            <li>sss</li>
                                            <li>bb</li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </li> 
```

# javascript - 从变量中获取标签源

> ID：15042585
> 
> 赞同：1
> 
> 时间：2013-02-23T16:09:23.587
> 
> 标签：javascript, jquery, html

如何从 javascript 变量中提取所有 img html 标签，如下所示：

```
var content = '<img src="http://website.com/image.jpg"><img src="http://website.com/image2.jpg"><img src="http://website.com/image3.jpg">Other content'; 
```

然后提取每个 img 链接，可能使用 jQuery .each() 函数。

提取的图像链接将是

```
http://website.com/image.jpg
http://website.com/image2.jpg
http://website.com/image3.jpg 
```

我怎样才能做到这一点？我需要正则表达式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:14:05.883

您可以从有效的 html 字符串创建 html 元素的 jQuery 集合，甚至无需将它们附加到任何文档。这将像一个普通的 jQuery 集合一样工作。

```
$(content).filter('img').each(function () {
    console.log($(this).attr('src'));
}); 
```

编辑：如果图像将*始终*是另一个元素的子元素`content`，请使用`.find`而不是`.filter`. 否则，您必须同时使用*两者*，您仍然可以这样做：

```
$(content).find('img').addBack().filter('img').each(function () { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:13:38.787

对于单级 DOM，这将很好地工作：

```
var links = $(content).filter('img').map(function() {
    return this.src;
}).toArray();
console.log(links); //["http://website.com/image.jpg", "http://website.com/image2.jpg", "http://website.com/image3.jpg"] 
```

[**小提琴**](http://jsfiddle.net/B77G2/8/)

如果您有多个级别的 DOM（其他元素内的嵌套图像），请将第一行更改为：

```
var links = $('<div>').append(content).find('img').map(function() { 
```

此外，如果你正在抓取任意数据，你应该使用[`$.parseHTML`](http://api.jquery.com/jQuery.parseHTML/)(jQuery 1.8+) 来避免 XSS。

这是完整、坚固的版本：

```
var links = $('<div>').append($.parseHTML(content)).find('img').map(function() {
    return this.src;
}).toArray(); 
```

## *[jsBin](http://jsbin.com/atetuj/1/edit)*

在上面的示例中，我将内容附加到一个动态创建的`div`元素中，这样我就可以只执行一个`find`操作。结果与@Explosion Pills 的`.find('img').addBack().filter('img')`变体相同。

* * *

此外，显然，如果您已经在页面中拥有图像，您可以使用一个共同的祖先作为根，`.find()`而不是创建新的 DOM 元素：

```
var links = $('#imagesParent').find('img').map(function() { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T16:14:00.907

你是对的，使用`.each()`它来迭代它工作正常。

```
var ary = [];
var content = '<img src="http://website.com/image.jpg"><img src="http://website.com/image2.jpg"><img src="http://website.com/image3.jpg">Other content';
$(content).each(function () {
    ary.push($(this).attr('src'));
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/Mn4rU/)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T16:14:35.853

`**[LIVE DEMO](http://jsbin.com/azezaf/1/edit)**`使用`.map()`和`.get()`

```
var srcs = $(content).map(function(){
    return this.src;
}).get(); 
```

[http://api.jquery.com/map/](http://api.jquery.com/map/)
[http://api.jquery.com/get/](http://api.jquery.com/get/)

* * *

`**[LIVE DEMO](http://jsbin.com/azezaf/2/edit)**`使用`.each()`和数组存储数据

```
var srcArray = [];
$(content).each(function(){
    srcArray.push(this.src);
}); 
```

[http://api.jquery.com/each/](http://api.jquery.com/each/)
[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/push](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/push)

# javascript - 对给出不正确顺序的数字进行排序

> ID：15042586
> 
> 赞同：2
> 
> 时间：2013-02-23T16:09:25.587
> 
> 标签：javascript, jquery, sorting

这是我的代码片段

```
 $(document).ready(function(){
        var mylist = [ "20","3","100","50"];
        mylist = mylist.sort();
        $("#mydiv").html(mylist.join(""));
    }); 
```

它在我的 div 上打印，如下所示

```
100
20
3
50 
```

但是，如果我给出“二十”、“三”、“百”、“五十”之类的数据，请给出正确的顺序。

```
fifty
hundread
three
twenty 
```

请帮忙，我错过了什么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:13:09.770

默认比较方法使用字母顺序。如果要对数字进行排序，请使用：

```
arr.sort(function(a,b) {
    return a - b;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T16:17:50.010

[`Array.sort()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort)默认情况下按字母顺序对值进行排序。该方法还可以与可选参数一起使用：比较函数

要对数值进行排序，请使用：

```
var numbers = [4, 2, 5, 10, 3];
numbers.sort(function(a, b) {
    return a - b;
});

// numbers -> [2, 3, 4, 5, 10] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T16:25:12.170

尝试这个：

```
var sortnumerically = function(a,b){
    if (a<b) return -1;
    else if (a>b) return 1; 
    else= return 0;
}
var mylist = [ 20,3,100,50];
mylist = mylist.sort(sortnumerically);
$("#mydiv").html(mylist.join(",")); 
```

好的，解释 sortnumerically 比较器功能。简单地说，它接受两个输入 a,b ：可能来自数组的元素。如果 ab 返回 1（这是比较器应该做的）。

[http://jsfiddle.net/Lmzua/1/](http://jsfiddle.net/Lmzua/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T16:33:52.373

从数组值中删除引号并使用下面的额外函数来获取升序 Mylist = Mylist.sort (function (a, b){return ab});

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-23T16:16:10.947

您将数字定义为字符串文字，因此 js 将它们排序为字符串。您需要将 then 定义为*数字*文字：`[ 20, 3, 100, 50]`以便排序按要求工作。

# python - Scrapy - 图像下载在第二次爬行中不起作用

> ID：15042589
> 
> 赞同：0
> 
> 时间：2013-02-23T16:09:54.070
> 
> 标签：python, pyqt4, scrapy

我写了一个蜘蛛从网站下载数据，然后点击链接获取详细数据。蜘蛛还使用默认的scrapy图像管道下载图像。到目前为止一切正常。

但是当我第二次[使用另一个搜索词]启动蜘蛛时，图像下载不再起作用。爬行就像应该的那样工作。我没有收到任何错误。

这是蜘蛛：

```
class DiscoSpider(BaseSpider):

    def __init__(self, query):
        super( BaseSpider, self ).__init__()
        self.name = "discogs"
        self.allowed_domains = ["discogs.com"]
        self.start_urls = [
            "http://www.discogs.com/search?q=%s&type=release" % query
        ]

    # parse all releases for the current search
    def parse(self, response):
        logging.debug('scrapy.parse')
        hxs = HtmlXPathSelector(response)
        li = hxs.select("//div[@id='page_content']/ol/li")

        items = []
        for l in li:
            item = DiscogsItem()

            ...

            # get the link for the callback for the tracklist
            link = l.select("a/@href").extract()[0]
            item['link'] = '' if link == None else link

            # get the img location
            img = l.select("a/img/@src").extract() 
            item['image_urls'] = [None] if img == None else img 

            # get the url for the tracklist callback
            url = urlparse.urljoin('%s%s' % ('http://www.', self.allowed_domains[0]), link)

            # request and callback to get tracklist for release
            item = Request(url, meta={'item':item}, callback=self.parse_tracklist)

            items.append(item)
            yield item        

    # callback to get the tracklist for each release
    def parse_tracklist(self, response):
        item = response.request.meta['item']

        hxs = HtmlXPathSelector(response)
        rows = hxs.select("//div[@class='section_content']/table[@class='playlist mini_playlist']/tr")
        tracklist = []

        for row in rows:
            track = {}

            title = row.select("td[@class='track']/span[@class='track_title']/text()").extract()
            track['title'] = '' if title in [None, '', []] else self.clean_track(title[0])

            ...

            tracklist.append(track)

        item['tracklist'] = tracklist    
        yield item 
```

这是项目：

```
class DiscogsItem(Item):
    # define the fields for your item here like:
    link = Field()
    artist = Field()
    release = Field()
    label = Field()
    year = Field()
    tracklist = Field()
    image_urls = Field()
    images = Field()
    thumb = Field() 
```

在我的scrapy设置中：

```
ITEM_PIPELINES = ['scrapy.contrib.pipeline.images.ImagesPipeline']
IMAGES_STORE = '/home/f/work/py/discogs/tmp'
CONCURRENT_REQUESTS = 100
CONCURRENT_REQUESTS_PER_IP = 20
IMAGES_EXPIRES = 0 
```

我在一个单独的过程中从 PyQt-UI 运行蜘蛛，我是 Scrapy / PyQT / StackOverflow 的新手（抱歉格式错误）。

我在一个带有 Python 2.7、PyQt4 和 Scrapy 0.12.0.2546 的 Xubuntu 12.04 机器上。

有谁知道为什么第二个图像下载不起作用？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T11:43:34.327

我现在回答我自己的问题，虽然我真的不知道问题是什么。我所做的是像这样更改蜘蛛的构造函数：

```
class DiscogsSpider(CrawlSpider):

    name = "discogs"
    allowed_domains = ["discogs.com"]

    def __init__(self, query):
        super( DiscogsSpider, self ).__init__()
        self.start_urls = [
            "http://www.discogs.com/search?q=%s&type=release" % query
        ] 
```

我现在也扩展了 CrawlSpider 而不是 BasSpider。图像下载现在按预期工作。

谢谢。

# php - mysqli_stmt::bind_param 变量数与准备语句中的参数数不匹配

> ID：15042590
> 
> 赞同：2
> 
> 时间：2013-02-23T16:09:55.913
> 
> 标签：php, mysqli

这是我创建准备好的语句的函数：

```
function query($query, $values_array) {

if ($stmt = $link->prepare($query)) {

    for ($i = 1; $i < count($values_array); $i++) {
     if (!$stmt->bind_param($values_array[0][$i-1], $values_array[$i])) {
        return false;
     }
    }

if (!$stmt->execute()) {
    return false;
}
$result = $stmt->get_result();
$stmt->close();
}

return $result;
} 
```

$查询是

```
insert into table (var1, var2, var3, var4, var5, var6) values (?, ?, ?, ?, ?, ?) 
```

$values_array 是

```
array(7) {
[0]=>
string(6) "diisii"
[1]=>
float(9)
[2]=>
int(1)
[3]=>
int(1)
[4]=>
string(5) "now()"
[5]=>
int(1)
[6]=>
int(1)
} 
```

我无法弄清楚问题，因为仅在将参数绑定到插入语句时才会引发此错误。选择语句没有问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:04:35.167

这是一个清楚的例子，说明了为什么**mysqli 完全不能用于准备好的语句。**
使用 PDO 或手动解析自定义占位符，就像[safemysql](https://github.com/colshrapnel/safemysql/blob/master/safemysql.class.php)一样。

与 mysqli 不同，PDO 有 2 个很棒的东西可以使准备好的语句可用：

*   *按值*绑定占位符，通过使用`bindValue()`数组或将数组传递给`execute()`.
*   将查询结果作为*通常的数组*返回，而不是单独变量的奇怪绑定。

# python - Python - 在whileloop中制作的列表似乎没有清除

> ID：15042591
> 
> 赞同：-2
> 
> 时间：2013-02-23T16:10:04.113
> 
> 标签：python, list

我的代码如下：

```
self.newMonsterList =[]
myKeys = []
if (len(self.myList)>0):
    for i in range(len(self.myList)-1):
        myVar = self.myList[i]
        myKeys.append(myVar[1])
        lis = game.active_entities.keys()
for k in lis:
    if (k not in myKeys):
        game.active_entities[k].destroy()
for it in self.myList:
    if (it[1] in lis):
        self.setEnt(it, game.active_entities[it[1]])
    else:
        self.newMonsterList.append(it)
self.makeEnt() 
```

这段代码，也就是它所在的方法，在一个显然有效的 while 循环中被调用。makeEnt 将带有它[1] 的实体作为 key 附加到 self.newMonsterList。这行得通，我已经测试过了。因此，在所有这些代码（即调用此代码的 while 循环）的第一轮完整循环之后，newMonsterList 中的 ID 不应该在第二轮之后出现。然而，确实如此。另一方面，如果我在 makeEnt 中检查 newMonsterList 的内容是否已经是键，我会得到正确的结果。因此，我得出结论，在 while 循环的哪个运行中没有正确清空 newMonsterList。我现在一直在尝试不同版本的 2 小时……有人知道吗？

我试图把它写下来更简单：a 是一个 Ints 列表

d 是一个以整数为键的字典

```
While True:
   b=[]
   for it in a:
      if (it not in d):
         b.append(it)
         print it
      else:
         print it
    for k in b:
          d[k] = k 
```

我现在发现，monsterlist 确实在每一轮都清空了，但是，在 ifclause ("if (it not in d):") 中，每轮都将 "it" 附加到列表中。但是，第一次迭代后，“它”也肯定在 d 中，我可以打印它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:33:02.967

你知道这个循环迭代了`self.myList`，但**跳过了列表中的最后一项**，对吧？

```
myKeys = []
if (len(self.myList)>0):
    for i in range(len(self.myList)-1):
        myVar = self.myList[i]
        myKeys.append(myVar[1])
        lis = game.active_entities.keys() 
```

跳过最后一项似乎很可疑。

仅供参考，我认为上面的代码相当于：

```
assert self.myList # Because if self.myList was empty, iterating over
                   # lis (later) would have caused an NameError.
myKeys = [value for key, value in self.myList[:-1]]
lis = game.active_entries.keys() 
```

# for-loop - Mathematica 中函数内的 For 循环

> ID：15042594
> 
> 赞同：0
> 
> 时间：2013-02-23T16:10:14.253
> 
> 标签：for-loop, wolfram-mathematica

我有以下用python编写的代码。

```
def func(r,f):
    for k in np.arange(Nb-1):
    temp = 0
    temp += f[r][k]*f[r][k+1]*np.sqrt(k+1)
    return temp 
```

我如何在 Mathematica 中做同样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:51:25.900

就像是

```
func[r_,f_]:=Sum[f[[r,k]] f[[r,k+1]] Sqrt[k+1] , {k,Nb-1}] 
```

如果你真的想要一个 For 循环：

```
 func[r_,f_]:=(temp=0;For[ ...,temp+= .. ] ; temp) 
```

您可以 RTFM For[] 语法，我想我从未使用过它，但它看起来像“c”

# c# - C# 问答游戏 - Qs/As 在同一个文件中？

> ID：15042595
> 
> 赞同：-1
> 
> 时间：2013-02-23T16:10:25.800
> 
> 标签：c#

我正在使用 Windows 窗体在 C# 中创建一个问答游戏，我最初的想法是将问题/答案放入 XML 文件中，如下所示：

```
<?xml version="1.0" ?>
<quiz>
</question>
<question>
     <answers>

</question>

// More questions here

</quiz> 
```

我计划使用如下形式的类/对象：

```
class Question
{

var listOfQuestions = new List<Question>();
listOfQuestions.Add(question); 
```

我想知道如何使用这些组合，以便我可以轻松添加新的问题/答案，然后表单将在标签中显示问题，答案将在四个单独的按钮上？也许有人可以帮助我举一个例子，说明我将在表单代码/XML文件中包含什么来实现这一点？

我也想尝试，也许有不同难度级别的不同问题，但我也不知道我会怎么做。

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:23:02.300

您的 XML 有点偏离，因为您不能在同一元素中包含自由文本**和子节点。**这会更正确一点：

```
<?xml version="1.0"?>
<quiz>
    <question id="1" difficulty="1">
        <text>What is the capital city of Australia?</text>
        <answers>
            <wrongAnswer>Sydney</wrongAnswer>
            <correctAnswer>Canberra</correctAnswer>
            <wrongAnswer>Melbourne</wrongAnswer>
            <wrongAnswer>Adelaide</wrongAnswer>
        </answers>
    </question>

    <!-- More questions here  -->

</quiz> 
```

根据您的其他问题，我还添加了一些您可以使用的属性。

至于将这些加载到 Forms 项目中，您最好创建一个可以将每个问题绑定到的 UserControl，尽管使用 WPF 会容易得多。我没有任何 ATM 的示例，但如果需要，我可以想出一些简单的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:19:28.720

如果我理解正确，您可以简单地使用级别标志扩展您的 Question 类并将您的类[序列化为](https://stackoverflow.com/questions/5937630/serialize-class-to-xml)XML。然后您可以在启动时加载 XML 文件并对其进行反序列化。

# ios - UISearchBar 宽度动画和 AutoLayout

> ID：15042601
> 
> 赞同：1
> 
> 时间：2013-02-23T16:11:33.430
> 
> 标签：ios, animation, uisearchbar, autolayout

我在尝试为 UISearchBar 设置动画以在编辑时简单地展开时遇到了很多问题，所以我想我会为其他不得不遭受这个问题的人提供一个解决方案。

动画 UISearchBar已经[存在问题](https://stackoverflow.com/questions/9636367/cant-animate-the-frame-or-bounds-of-a-uisearchbar)，并且在将其与 iOS AutoLayout 混合时问题会进一步增加。如果您有同样的问题，那么我在下面发布了解决方案。它可能并不完美，但它确实有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:11:33.430

经过多次试验和错误，我通过在 xib 中关闭 AutoLayout 功能，然后使用下面的动画方法让它工作：

```
+(CAAnimationGroup *)changeView:(UIView *)view frameTo:(CGRect)frame{
CGRect oldFrame = view.frame;

// /2.0 because size animation occurs from the anchor point which is set to (0.5,0.5) by default
CGPoint oldOrigin = CGPointMake(oldFrame.origin.x+oldFrame.size.width/2.0, oldFrame.origin.y+oldFrame.size.height/2.0);
CGPoint newOrigin = CGPointMake(frame.origin.x+frame.size.width/2.0, frame.origin.y+frame.size.height/2.0);

CABasicAnimation *positionAnimation = [CABasicAnimation animationWithKeyPath:@"position"];

positionAnimation.fromValue = [NSValue valueWithCGPoint:oldOrigin];
positionAnimation.toValue = [NSValue valueWithCGPoint:newOrigin];
view.layer.position = newOrigin;

CABasicAnimation *sizeAnimation = [CABasicAnimation animationWithKeyPath:@"bounds"];

sizeAnimation.fromValue = [NSValue valueWithCGRect:oldFrame];
sizeAnimation.toValue = [NSValue valueWithCGRect:frame];
view.layer.bounds = frame;

CAAnimationGroup *frameChangeAnimationGroup = [CAAnimationGroup animation];

frameChangeAnimationGroup.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseOut];
frameChangeAnimationGroup.animations = [NSArray arrayWithObjects:positionAnimation,sizeAnimation, nil];

[view.layer addAnimation:frameChangeAnimationGroup forKey:@"frame"];

return frameChangeAnimationGroup;} 
```

我希望这可以帮助并为人们节省一些我不得不经历的痛苦。

# ruby - Ruby 获取 RSS 提要不会获取最新提要

> ID：15042603
> 
> 赞同：0
> 
> 时间：2013-02-23T16:11:36.183
> 
> 标签：ruby, rss, sinatra

我在解析 RSS 提要时遇到问题。当我这样做时：

```
 feed = getFeed("http://example.com/rss) 
```

如果提要内容发生变化，它不会更新。

如果我这样做：

```
feed = getFeed("http://example.com/rss?" + Random.rand(20).to_s) 
```

它大部分时间都有效，但并非总是如此。

`getFeed()`是这样实现的：

```
def getFeed(url)
   rss_content = ""
   open(url) do |f|
      rss_content = f.read
   end
   return rss_content
end 
```

我在 Sinatra 中使用了 Ruby 1.9.3，如果这有什么不同的话。在我看来，它在某个地方被缓存，但我不知道在哪里。

编辑：Okey 在服务器上运行 1/2 天后它可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:58:43.917

这：

```
feed = getFeed("http://example.com/rss?" + Random.rand(20).to_s) 
```

暗示问题出在缓存上，但 Ruby、OpenURI 和 Sinatra 不应该缓存任何东西。也许您的代码在处理传出请求和传入请求的缓存设备或应用程序后面运行？

这不是解决方法，但您的代码可以大大简化：

```
def getFeed(url)
  open(url).read
end 
```

# c - 加载共享库时出错：libcmocka.so.0：没有这样的文件或目录

> ID：15042609
> 
> 赞同：6
> 
> 时间：2013-02-23T16:12:36.673
> 
> 标签：c, unit-testing

```
#include <stdarg.h>
#include <stddef.h>
#include <setjmp.h>
#include <cmocka.h>
/* A test case that does nothing and succeeds. */
static void null_test_success(void **state) {
    (void) state; /* unused */
}
int main(void) {
    const UnitTest tests[] = {
        unit_test(null_test_success),
    };
    return run_tests(tests);
} 
```

我是 cmocka 单元测试框架的新手，[http://www.ohloh.net/p/cmocka](http://www.ohloh.net/p/cmocka)。当我将上述程序编译为 gcc program.c -lcmocka 并运行 ./a.out 时，出现错误：

> ./a.out：加载共享库时出错：libcmocka.so.0：无法打开共享对象文件：没有这样的文件或目录

我试过但无法修复它。这里到底有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:54:48.470

你能检查你是否有权访问文件夹 /usr/local/lib/

执行 ls -lart /usr/local/lib/libcmocka.so 并检查访问权限并检查您是否具有读取权限

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:28:13.927

这个错误意味着程序加载器找不到 cmocka 共享库文件。您需要将共享库（例如 libmocka.so.x）所在的目录添加到文件“/etc/ld.so.conf”中。将它包含在 LD_LIBRARY_PATH 变量中也可以。

实际上，最好将库（共享和静态）安装到“标准”文件夹，例如 /usr/lib 或 /usr/local/lib，除非您有特定的理由不这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-22T15:32:10.110

我在我的项目中使用 cmake，所以我解决这个问题的方法是使用以下 cmake 命令：

```
# Find and add the cmocka library
find_library(CMOCKA_LIBRARY NAMES cmocka)
add_library(cmocka SHARED IMPORTED)
set_property(TARGET cmocka PROPERTY IMPORTED_LOCATION "${CMOCKA_LIBRARY}")

# Create and link the testing file to cmocka
add_executable(mytest my_example_test.c)
target_link_libraries(mytest cmocka)

# Add this as a test for ctest
add_test(TEST_MY_EXAMPLE mytest) 
```

或使用命令行：

```
gcc my_example_test.c -L/usr/local/lib -lcmocka -o mytest && ./mytest 
```

在最后一种情况下，您可以使用该`-L`选项告诉 gcc 在哪里查找库文件。在这种情况下，如果您将它安装在非常规的地方，如果您指定库文件的位置，gcc 仍然可以找到它

# c# - 如何在屏幕中心显示工具提示？

> ID：15042614
> 
> 赞同：4
> 
> 时间：2013-02-23T16:13:04.743
> 
> 标签：c#, windows, winforms, controls, tooltip

我正在使用 C#，我想在屏幕中央显示一个工具提示，而不是使用`MessageBox`用于一些琐碎的任务，例如显示异常和类似的事情。

怎么做？问题是工具提示总是显示在控件附近（例如`button1`，`form1`等）。

这是我使用的：

```
ToolTip t = new ToolTip();
t.Show("show tooltip", this, 1500); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T16:16:01.447

使用重载的[ToolTip.Show](http://msdn.microsoft.com/en-us/library/tksk5312.aspx)并设置要显示工具提示的[点。](http://msdn.microsoft.com/en-gb/library/s9b80s6c.aspx)例子 ：

```
TooleTip t = new ToolTip();
t.Show("show tooltip", new Point(x, y), this, 1500); 
```

应该在表格中心附近的位置和位置`x`。`y`请注意，工具提示是相对于表单显示的。因此，如果将应用程序最小化，它将没有用。就像其他人说的那样，这毕竟不是一个好主意。您可以创建一些自定义窗口，在某个时间后显示和隐藏。

请参阅[表单淡入/淡出效果和通知窗口](http://www.codeguru.com/csharp/csharp/cs_misc/userinterface/article.php/c10139/Form-Fade-InOut-Effect-and-Notification-Window.htm)

# paypal - 特定订阅标识符的 PayPal 取消订阅按钮

> ID：15042621
> 
> 赞同：2
> 
> 时间：2013-02-23T16:14:12.857
> 
> 标签：paypal, paypal-subscriptions

我创建了这个取消订阅按钮。

```
<A HREF="https://www.paypal.com/cgi-bin/webscr?cmd=_subscr-find&alias=RXXXXXXXXX">
    <IMG SRC="https://www.paypalobjects.com/en_US/i/btn/btn_unsubscribe_LG.gif" BORDER="0">
</A> 
```

问题是如果用户有多个订阅，PayPal 会显示一条消息：

> 要取消特定订阅，请单击其详细信息。这会将您带到其详细信息页面，您将在其中找到一个取消按钮。"` 而不是将用户带到特定订阅。

如何扩展此按钮以包含特定的订阅 ID，以便它直接导航到正确的订阅，而不仅仅是显示各种交易的列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T21:24:28.750

通过 HTML 取消订阅按钮没有，但 PayPal 有一个 API 调用`ManageRecurringPaymentsProfileStatus`，允许您通过您的网站取消特定配置文件。这是一个更复杂的集成，但可以为您的客户消除潜在的困惑。

以下是 API 调用所需的参数

```
USER=
PWD=
SIGNATURE=
METHOD=ManageRecurringPaymentsProfileStatus
VERSION=98.0
PROFILEID=Profile ID here
ACTION=Cancel 
```

这也意味着您必须跟踪客户的个人资料 ID 及其个人资料的状态。

# asp.net - 如何在表单的文本框中以非英语语言（例如印地语）进行用户直接输入

> ID：15042623
> 
> 赞同：0
> 
> 时间：2013-02-23T16:14:32.130
> 
> 标签：asp.net, visual-studio-2010

我想创建以印地语接受用户输入的非英语语言（例如印地语）网络表单。当我正在开发 Web 应用程序时，我想要这样的设置，用户或客户端可以轻松地输入非英语语言的字符......我的问题如下......
1）这可能吗？我如何创建这样的网页有可能
2）我可以为这个客户端或浏览器端做吗，或者它可以在没有任何设置的情况下完成
3）我是否要求客户端上的非语言字体或此类设施可以在 Web 应用程序中使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:19:27.257

是的，您可以借助该语言字体来做到这一点，在您的情况下，您可以使用`shivaji font`.

我认为 shivaji 字体适用于 devnagari 脚本。我已将此字体用于马拉地语（印度次国家语言）语言字体。

您必须在客户端安装这些字体，从任何地方下载，只需执行以下步骤

1) 将下载的包下载并解压到一个文件夹中。（您可以在桌面上执行此操作）。
2) 现在转到`My Computer –&gt; C: –&gt; WINDOWS –&gt; FONTS`“C:\WINDOWS\Fonts”中的文件夹路径将是这样的<br/>

3) 现在从桌面打开字体目录并将所有 3 种字体复制并粘贴到“C:\WINDOWS\Fonts”目录中。
4）你做到了。所有字体都将安装在您的系统中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:28:30.110

您可以`UTF-8`在 web.config 的全球化元素中将编码设置为，如下所示：

```
<globalization requestEncoding="utf-8" responseEncoding="utf-8" /> 
```

如果您想制作只需要将输入作为印地语的自定义文本框控件。

这是一篇基于此的文章：http: [//www.codeproject.com/Articles/67944/Hindi-Marathi-Transliteration-ASP-NET-Custom-Contr](http://www.codeproject.com/Articles/67944/Hindi-Marathi-Transliteration-ASP-NET-Custom-Contr)

# java - 可以将字符串转换为指令吗？

> ID：15042626
> 
> 赞同：3
> 
> 时间：2013-02-23T16:14:36.700
> 
> 标签：java, macros, substitution

Java中的这段代码：

```
for (Integer x=1; x <= 3; x++) {
    y = "array[" + Integer.toString(x) + "] = a" + Integer.toString(x) + ".getText();";
    System.out.println(y);
    } 
```

打印出来：

```
array[1] = a1.getText();
array[2] = a2.getText();
array[3] = a3.getText(); 
```

但是，我希望它执行而不是打印字符串 y。我如何在 Java 中做到这一点？

如果这是不可能的，是否有另一种方法来实现我想要的，与使用 3 条指令不同？

```
array[1] = a1.getText();
array[2] = a2.getText();
array[3] = a3.getText(); 
```

为简单起见，尽管我需要 20 条指令，但我使用了 3 条指令。更重要的是，我正在尝试更多地了解 Java，并正在寻找更优雅的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:22:40.693

您正在寻找的是许多解释语言中的“eval”。Java 不允许您在运行时评估源代码。这是一种编译语言而不是解释语言的特性。

您可以通过反射或字节码生成来获得一些功能，但这些是开发框架或库的人通常使用的高级功能，而不是日常编程的常规部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:29:51.730

尽管 Java 本身不是一种脚本语言，但它确实有一个库 javax.script，它支持带有 eval 方法的脚本。当我想允许表达式作为程序的输入参数时，我使用了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T16:19:09.230

简单的循环可以完成你的工作：

```
for(int i=0;i<array.length;i++){
array[i] = a[i].getText();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T19:01:49.463

选择：

1.  你可以从java调用java编译器，创建一个类，动态调用。这对于几行代码片段来说太过分了。

2.  如果您的“20 条指令”都是类似的形式，并且您的词汇量有限，那么您可以创建自己的“指令集”并使用一些调度功能关闭它。（这是任何语言的通用解决方案。）

3.  如果您使用过 Lisp 等功能更强大的语言，一些可用的 java 脚本语言也有 eval 函数。

我喜欢 groovy，因为它两全其美：动态和功能使用、闭包、交互式、探索性（例如，变量和方法上的选项卡完成），并且是 java 语言的超集，可以使用所有现有的 java 类和罐子。易于嵌入一个 groovy 控制台以弹出（甚至从您的服务器）并交互式地四处浏览、检查值等。

下面是从 groovy shell 评估代码的示例；从 Java 调用它实际上是相同的；见[http://groovy.codehaus.org/Embedding+Groovy](http://groovy.codehaus.org/Embedding+Groovy)

```
$ groovysh
Groovy Shell (1.8.4, JVM: 1.6.0_24)
Type 'help' or '\h' for help.
---------------------------------------------------------------------------------------------
groovy:000> class Athing {  String name; public Athing(String name){ this.name=name; }; String getText() { return name + "'s getText() returns..."; }; }
===> true
groovy:000> a1 = new Athing("a1"); a2 = new Athing("a-two");  a3 = new Athing("A_3"); 
===> Athing@6e7616ad
groovy:000> a1.getText()        // showing 
===> a1's getText() returns...
groovy:000> b = new Binding();
===> groovy.lang.Binding@2c704cf5
groovy:000> array = [ 'not','set','yet' ]   // create an array for return values
===> [not, set, yet]
groovy:000> b.setVariable( "a1", a1 ); b.setVariable( "a2", a2 ); b.setVariable( "a3", a3 ); b.setVariable( "array", array );
===> null
groovy:000> shell = new GroovyShell(binding);
===> groovy.lang.GroovyShell@24fe2558
groovy:000> code = "array[1] = a1.getText();\n" + "array[2] = a2.getText();\n" + "array[3] = a3.getText();\n";
===> array[1] = a1.getText();
array[2] = a2.getText();
array[3] = a3.getText();

groovy:000> array                        // value of array before
===> [not, set, yet]
groovy:000> shell.evaluate( code );      // evaluate the string of code we were given
===> A_3's getText() returns...
groovy:000> array
===> [not, a1's getText() returns..., a-two's getText() returns..., A_3's getText() returns...]
groovy:000> 
```

# asp.net-mvc - SpecFlow 使用 Unity 模拟 MVC / EF 行为

> ID：15042632
> 
> 赞同：0
> 
> 时间：2013-02-23T16:15:05.790
> 
> 标签：asp.net-mvc, entity-framework, unity-container, specflow

我们通过在 Unity 中基于 Per-Web-Request 拥有相同的实例来处理 EF 上下文问题。

这很完美，但我们现在引入了 SpecFlow 来编写 BDD 规范。

我们的大部分 SpecFlow 步骤直接进入控制器，因此我们希望模拟控制器在 IIS 世界上运行时会发现的相同环境。

如何才能做到这一点？

我们得到的最接近的方法是在 SpecFlow 的 BeforeStep 上创建一个子 Unity 容器，但这并不一定意味着每个控制器调用都会有不同的上下文实例（例如当您实际通过 IIS 发出 HTTP 请求时）。我们确实需要在控制器上模拟 HTTP 调用环境，否则规范可能无法捕捉到生产代码中的问题。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-24T11:39:22.540

尝试 HttpSImulator，可能会有所帮助。（[http://www.nuget.org/packages/HttpSimulator/](http://www.nuget.org/packages/HttpSimulator/)）

# java - 多维数组左移

> ID：15042634
> 
> 赞同：0
> 
> 时间：2013-02-23T16:15:36.370
> 
> 标签：java, multidimensional-array

我有一个多维数组：

```
int[][] arrMulti = new int [3][3]; 
```

我写了一个简单的循环来将里面的数据显示为一个网格：

```
123
456
789 
```

我现在需要做的是将所有内容左移一，并将网格右侧的空白替换为零，如下所示：

```
230
560
890 
```

理想情况下，我希望该方法能够移动任何大小的多维数组，例如

```
int[][] arrM = new int [28][28] or [98][98] 
```

有人可以帮我吗？

谢谢！

到目前为止，这是我的代码：

```
package testingarrymove;

public class TestingArryMove {

//Start of shift array method
public static int[][] shiftArray (int arrShiftLeft[][] ) {

int from = 1;
int   to = 0;

for (int i = 0; i < arrShiftLeft.length; i++) {
    for (int j = 0; j < arrShiftLeft[0].length; j++) {    

    // move 1 to 0, 2 to 1, 3 to 2, 4 to 3, 5 to 4 ............
    System.arraycopy(arrShiftLeft, 1, arrShiftLeft, 0, arrShiftLeft.length - 1);

    from++;
    to++;

        return arrShiftLeft;
    }
}
    return null;   
} // end shiftArray

public static void main(String[] args) {

int [][] arrMultiDim = new int [3][3];

arrMultiDim [0][0] = 1;
arrMultiDim [0][1] = 2;
arrMultiDim [0][2] = 3;
arrMultiDim [1][0] = 4;
arrMultiDim [1][1] = 5;
arrMultiDim [1][2] = 6;
arrMultiDim [2][0] = 7;
arrMultiDim [2][1] = 8;
arrMultiDim [2][2] = 9;

// outputs original array
System.out.print("Original Array: ");
    //loops thought the rows of the array
    for (int i = 0; i < arrMultiDim.length; i++) {

       System.out.println();
        //loops thought the columns of the array
        for (int j = 0; j < arrMultiDim[0].length; j++) {    
            System.out.print(" "+arrMultiDim[i][j]);

        }

    }
    System.out.println();

    System.out.println("Shifted Array: "); 
    //this should copy just the row to another array by calling the shiftedArray
    shiftArray(arrMultiDim);
    //outputs the shifted array
    System.out.println(arrMultiDim);
}

} // end class 
```

我试过system.arraycopy。上面的代码输出这个：

```
Original Array: 
1 2 3
4 5 6
7 8 9
Shifted Array: 
[[I@ece88d2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:49:38.303

乍一看，我认为双端队列数据结构在这种情况下非常方便。您可以声明一个包含 3 行的队列数组，并使用队列函数左右移动。例如，您可以将一个项目出列并入队 0 以进行右移，并从另一端出列并入队 0 以进行左移。您可能首先要查找[队列数据结构](http://en.wikipedia.org/wiki/Queue_%28abstract_data_type%29)，然后查找[双端队列数据结构](http://en.wikipedia.org/wiki/Double-ended_queue)，最后实现功能，甚至使用现有库来使用出[队](http://docs.oracle.com/javase/6/docs/api/java/util/Deque.html)（代表 [ **d** ]ouble [ **e** ] nded**队列**） 数据结构。通过这种方式，数组的大小对于执行您想要的操作并不重要，但是您必须稍微更改您提到的数据类型（3x3 数组）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-03T11:07:44.167

```
public static void shift(int[][] arr, int offs) {
    if (offs <= 0)
        return;

    offs = offs > arr[0].length ? arr[0].length : offs;

    for (int[] row : arr) {
        if (offs < arr.length)
            System.arraycopy(row, offs, row, 0, row.length - offs);
        Arrays.fill(row, row.length - offs, arr.length, 0);
    }

} 
```

# image - 抓取窗口的像素数据

> ID：15042643
> 
> 赞同：1
> 
> 时间：2013-02-23T16:16:43.110
> 
> 标签：image, bitmap, window, copy

在 Windows 中，我试图弄清楚如何从窗口中获取像素数据。假设您打开了 Microsoft Word，并且您只想获取该应用程序的屏幕截图。这是怎么做的？

这是一个好的过程吗？

1.  找出应用程序在屏幕上的位置（我该怎么做？）
2.  将屏幕的像素缓冲区数据复制到位图（如何抓取屏幕数据？）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T15:16:23.420

[可以](http://msdn.microsoft.com/en-us/library/windows/desktop/dd183402%28v=vs.85%29.aspx)在 Windows SDK 文档中找到答案。这个例子对我很有效。

# javascript - 画布0px线条图（html5）

> ID：15042644
> 
> 赞同：0
> 
> 时间：2013-02-23T16:16:48.400
> 
> 标签：javascript, html, canvas

（对不起我的英语）所以我的问题是，我怎样才能制作一条 0px 线？如果我称之为这条线保持 1px 宽度：/

```
 imgCtx.beginPath();
        imgCtx.lineWidth = 0;
        imgCtx.fill();
    imgCtx.stroke(); 
```

我只需要填充部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:12:20.077

只是不要调用该`stroke`方法。

[样本](http://jsfiddle.net/jessevanassen/JnsvM/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:30:27.653

如果你只需要填充部分，那么不要问如何得到一个0px的轮廓，问如何只得到填充部分。

```
var ctx = canvas.getContext("2d");
ctx.strokeStyle = "none"; 
```

# r - R数据框 - 如何提取唯一值

> ID：15042646
> 
> 赞同：4
> 
> 时间：2013-02-23T16:16:57.603
> 
> 标签：r, unique, match, plyr

我正在尝试从数据集中提取 和 的每个组合的第一条`SUBJ`记录。简化的集合 sampleData 是：`BLK``TR`

```
SUBJ BLK TR    BEG    END
1  1234   1  1 111021 111021
2  1234   1  1 111400 111021
3  1234   1  1 111566 111021
4  1234   1  1 111765 111021
5  1234   2  2 132050 133113
6  1234   2  2 133123 133113
7  1234   2  2 133479 133113
8  1234   2  2 133762 133113
9  5678   1  1  82503  82502
10 5678   1  1  82902  82502
11 5678   1  1  83102  82502
12 5678   1  1  83310  82502
13 5678   2  2 274870 288224
14 5678   2  2 288225 288224
15 5678   2  2 288535 288224
16 5678   2  2 288802 288224 
```

当我尝试这个时：

```
ddplyFirst <- ddply(sampleData, .(SUBJ, BLK, TR), summarize, 
                        Tr.match = match(unique(TR), TR)) 
```

我明白了：

```
ddplyFirst
  SUBJ BLK TR Tr.match
1 1234   1  1        1
2 1234   2  2        1
3 5678   1  1        1
4 5678   2  2        1 
```

我不知道如何从这个到我想要得到的，这将包括`BEG`and`END`值或`BEG - END`.

现在，事实证明，在上面的例子中，`END`是一个唯一的数字，所以我可以这样做：

```
first <- with(sampleData, match(unique(END), END)) 
```

这给了我：

```
sampleData[first,]
   SUBJ BLK TR    BEG    END
1  1234   1  1 111021 111021
5  1234   2  2 132050 133113
9  5678   1  1  82503  82502
13 5678   2  2 274870 288224 
```

问题是完整的数据集有*202,616 条记录*，我不能保证`BEG`或对于、和`END`的不同组合具有唯一值。`SUBJ``BLK``TR`

另外，我想学习如何解决更一般的情况，对我来说，现在将获得每个 、 和组合中的第一`SUBJ`条`BLK`记录`TR`。

当然，更一般的情况是在每个、和combo中*获取第 n 条记录。*如果有人能告诉我如何做这些“更”通用或“最”通用解决方案中的一个或另一个，我将不胜感激。`SUBJ``BLK``TR`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:27:48.210

此处无需使用`summarise`，可以这样做（`head`用于获取第一行）

```
 ddply(sampleData, .(SUBJ, BLK, TR), function(x) head(x,1))
  SUBJ BLK TR    BEG    END
1 1234   1  1 111021 111021
2 1234   2  2 132050 133113
3 5678   1  1  82503  82502
4 5678   2  2 274870 288224 
```

或者更一般地获得第 n 行。n 你可以这样做：

```
ddply(sampleData, .(SUBJ, BLK, TR), function(x) x[min(row.n,nrow(x),]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T16:23:28.493

您可以通过仅对其进行索引来访问第一条或第 n 条记录（假设`nth`每个组都存在索引）：

```
idx <- 2
ddply(sampleData, .(SUBJ, BLK, TR), summarise, BEG=BEG[idx], END=END[idx])

#   SUBJ BLK TR    BEG    END
# 1 1234   1  1 111400 111021
# 2 1234   2  2 133123 133113
# 3 5678   1  1  82902  82502
# 4 5678   2  2 288225 288224 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T22:57:31.293

`data.table`编码优雅（和一般效率）的解决方案

如果您获得除第一行以外的任何行（并且每个子组中可能有不同的数字行），那么您将需要考虑当您尝试获得不存在的行时会发生什么。

下面的解决方案将获得`min(`n`, `total#of rows in each group`))`每个组的

```
library(data.table)
DT <- data.table(sampleData)

# get the the row you want. This may 
#
index <- 2L
 DT[,{ idx <- min(index, .N); .SD[idx,]} ,by =list(SUBJ, BLK, TR)] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T16:46:10.997

这是`aggregate`一般情况的解决方案：

```
aggregate(. ~ SUBJ+BLK+TR, data=sampleData, FUN='[', 1)
##   SUBJ BLK TR    BEG    END
## 1 1234   1  1 111021 111021
## 2 5678   1  1  82503  82502
## 3 1234   2  2 132050 133113
## 4 5678   2  2 274870 288224

aggregate(. ~ SUBJ+BLK+TR, data=sampleData, FUN='[', 2)
##   SUBJ BLK TR    BEG    END
## 1 1234   1  1 111400 111021
## 2 5678   1  1  82902  82502
## 3 1234   2  2 133123 133113
## 4 5678   2  2 288225 288224 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-23T16:52:42.397

在特定情况下（获取第一行或最后一行），您可以使用以下功能`duplicated`：

```
sampleData[!duplicated(sampleData[,c("SUBJ","BLK","TR")],fromLast=FALSE),] 
```

# sql-server - 如何过滤最大行数的窗口函数？

> ID：15042647
> 
> 赞同：0
> 
> 时间：2013-02-23T16:17:01.473
> 
> 标签：sql-server, windowing

我正在尝试在分区结果中获取最大行。如何获得按属性编号分区的每个返回的最大行。我想要的是由 2 标记的行，因为这是集合中的最后一个值。如果属性编号没有后续编号，那么我想要那个（红色箭头）。

下面是我的结果图片。

目前，我正在制作一个临时表，并对属性编号和 max(row) 进行分组，然后使用它来过滤这组数据。

我相信可能有更好的方法，而不会浪费太多的临时空间。![在此处输入图像描述](../Images/7d1d67f7f7da04bea1679d4a9974c9a4.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:20:06.353

就像是 ：

```
WITH CTE
AS
(
  SELECT *,
    ROW_NUMBER OVER(PARTITION BY ROW 
                    ORDER BY PropertyNumber DESC) AS Rownumber
  FROM tablename
)
SELECT *
FROM CTE
WHERE rownum = 1; 
```

# ios - UITableView：重命名编辑按钮（UIBarButtonSystemItemEdit）

> ID：15042651
> 
> 赞同：1
> 
> 时间：2013-02-23T16:17:32.227
> 
> 标签：ios, objective-c, uitableview, uibarbuttonitem, uitoolbar

我正在使用`Edit`导航工具栏中的按钮将表格视图设置为编辑模式。条形按钮的标签默认为`Edit`。

如何将其标签更改为其他内容？

我不能使用任何其他 BarButton 类型，因为我需要将表格设置为编辑模式，并且我想获得`setEditing:animated:`由内置`Edit`按钮触发的行为。

```
self.editToolbarButton = [[UIBarButtonItem alloc]
   initWithBarButtonSystemItem:UIBarButtonSystemItemEdit 
   target:self action:@selector(setSearchEditMode:)]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:32:29.150

只需使用两个标签创建您自己的按钮。

```
UIBarButtonItem *btn = [[UIBarButtonItem alloc] initWithTitle:@"Title1" style: UIBarButtonItemStyleBordered target:self action:@selector(setSearchEditMode:)];
btn.possibleTitles = [NSSet setWithObjects:@"Title1", @"Title2", nil];
self.editToolbarButton = btn;

- (void)setSearchEditMode:(UIBarButtonItem *)button {
    // Toggle the view controller's editing state
    [self setEditing:!self.editing animated:YES];

    // Update the button's title
    button.title = self.editing ? @"Title2" : @"Title1";

    // other processing
} 
```

# asp.net - 根据条件计算两个单元格

> ID：15042654
> 
> 赞同：2
> 
> 时间：2013-02-23T16:17:55.840
> 
> 标签：asp.net, sql-server, tsql

我有一个带有 C# 编码的 asp.net 项目。我有一张这样的桌子；

```
NAME       WORK_TYPE        FM            FM_HOUR
-------------------------------------------------
Mike         IN            -2800                
Mike         OUT            3400             ??
Jane         IN              400
Jane         OUT            -100             ?? 
```

在这里我有这样的问题；我需要计算这 2 个单元格的加法并将其除以 60 并将其写入右侧单元格。

例如; 我需要计算 Mike FM IN 和 Mike FM OUT 的加法，我需要将其写入 Mike FM_HOUR 单元格。

我怎样才能做到这一点 ？

我写了这段代码，但它当然不起作用，只是为了帮助你；

```
SqlConnection conn;
    SqlCommand cmd = new SqlCommand();
    string strSQL = "UPDATE bilgiler3 SET FM_HOUR= SELECT SUM((FM WHERE WORK_TYPE='OUT') + (FM WHERE WORK_TYPE='IN')) / 60 "
    string bag_str = WebConfigurationManager.ConnectionStrings["asgdb01ConnectionString"].ConnectionString;
    conn = new SqlConnection(bag_str);
    conn.Open();...... and goes like this 
```

请等待您的帮助。我真的需要这样做。

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:42:28.653

这应该产生所需的输出：

```
UPDATE bilgiler3 SET FM_HOUR= T.Result
FROM (
  SELECT Name , SUM(FM) / 60 AS Result
  FROM bilgiler3
  GROUP BY Name
) T
INNER JOIN bilgiler3 ON T.Name = bilgiler3.Name
WHERE bilgiler3.Work_Type = 'OUT' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:02:08.830

这是一个用于选择使用函数的[sql-fiddle-demo 。](http://sqlfiddle.com/#!3/f9414/5)`sum() over`我*认为*它支持 sql-server 2005 及更高版本。

我认为您最好在存储过程中执行此操作，而不是内联 sql。

对于[sql-fiddle-demo](http://sqlfiddle.com/#!3/57ad9/1)*`UPDATE`*

```
update T1 set T1.fm_hour = T2.fm_hour
from T T1 join (Select distinct name,sum(fm) over (partition by name)/60 fm_hour
                from T) T2 on T1.name = T2.name
where T1.work_type = 'out' 
```

为一个*`SELECT`*

```
Select name,work_type,fm, 
       case work_type 
           when 'out' then sum(fm) over (partition by name)/60
           else null end fm_hour
from yourTable

| NAME | WORK_TYPE |    FM | FM_HOUR |
--------------------------------------
| Jane |        IN |   400 |  (null) |
| Jane |       OUT |  -100 |       5 |
| Mike |        IN | -2800 |  (null) |
| Mike |       OUT |  3400 |      10 | 
```

# c++ - Opencv运行一个简单的程序抛出一个奇怪的错误

> ID：15042657
> 
> 赞同：1
> 
> 时间：2013-02-23T16:18:16.197
> 
> 标签：c++, opencv

我编译了这个简单的opencv代码：

```
#include "opencv2/core/core.hpp"        
#include "opencv2/highgui/highgui.hpp"  
#include <boost/random.hpp>
#include <ctime>
#include <time.h>
#include <stdlib.h>
#include <math.h>
#include <iostream>

/*Compile using 

g++ -I /usr/local/boost CreateShares.cpp -o createShares `pkg-config --cflags --libs opencv` 

*/
using namespace cv;

class CreateShares
{
private:
    cv::Mat CoreImage;

    cv::Mat CoreImageR;
    cv::Mat CoreImageG;
    cv::Mat CoreImageB; 

    cv::Mat share0;
    cv::Mat share1;
    cv::Mat share2;
    cv::Mat share3;

public:
    CreateShares();
    CreateShares(std::string path);

    void showCoreImage();
    void showCoreImageR();
    void showCoreImageG();
    void showCoreImageB();

};

CreateShares::CreateShares()
{

}

CreateShares::CreateShares(std::string path)
{
    CoreImage = cv::imread(path, 1);

    if (CoreImage.empty())
    {
        std::cout<<"Could not read image !"<<std::endl;
        return;
    }
    std::vector<cv::Mat> temp_mat_vector; 
    cv::split(CoreImage, temp_mat_vector);

    //CoreImageB = (temp_mat_vector[0]).clone();
    temp_mat_vector[0].copyTo(CoreImageB);
    temp_mat_vector[1].copyTo(CoreImageB);
    temp_mat_vector[2].copyTo(CoreImageB);

}

void CreateShares::showCoreImage()
{
    cv::namedWindow("Core Image", WINDOW_AUTOSIZE);
    cv::imshow("Core Image", CoreImage);
}

void CreateShares::showCoreImageR()
{
    cv::namedWindow("Core Image R", WINDOW_AUTOSIZE);
    cv::imshow("Core Image R", CoreImageR);
}

void CreateShares::showCoreImageG()
{
    cv::namedWindow("Core Image G", WINDOW_AUTOSIZE);
    cv::imshow("Core Image G", CoreImageG);
}

void CreateShares::showCoreImageB()
{
    cv::namedWindow("Core Image B", WINDOW_AUTOSIZE);
    cv::imshow("Core Image B", CoreImageB);
}

int main()
{
    std::string path = "/home/r/l33t/Secret Sharing/nature.jpg";

    CreateShares* cs = new CreateShares(path);
    cs->showCoreImage();

    return 0;
} 
```

然后我继续运行它，但我收到了这个奇怪的错误：

```
r@r-HP-Mini-110:~/l33t/Secret Sharing$ g++ -g -I /usr/local/boost CreateShares.cpp -o createShares `pkg-config --cflags --libs opencv`
r@r-HP-Mini-110:~/l33t/Secret Sharing$ ./createShares 
OpenCV Error: Bad flag (parameter or structure field) (Unrecognized or unsupported array type) in cvGetMat, file /build/buildd/opencv-2.3.1/modules/core/src/array.cpp, line 2482
terminate called after throwing an instance of 'cv::Exception'
  what():  /build/buildd/opencv-2.3.1/modules/core/src/array.cpp:2482: error: (-206) Unrecognized or unsupported array type in function cvGetMat

Aborted (core dumped) 
```

我将 gdb 输出粘贴到错误以帮助您分析：

```
(gdb) next
[New Thread 0xb4af2b40 (LWP 17550)]
[New Thread 0xb40ffb40 (LWP 17551)]
65  s::showCoreImage()
(gdb) step
CreateShares::showCoreImageR (this=0x80516e8) at CreateShares.cpp:78
78  ", CoreImageR);
(gdb) step
79  G()
(gdb) step
OpenCV Error: Bad flag (parameter or structure field) (Unrecognized or unsupported array type) in cvGetMat, file /build/buildd/opencv-2.3.1/modules/core/src/array.cpp, line 2482
terminate called after throwing an instance of 'cv::Exception'
  what():  /build/buildd/opencv-2.3.1/modules/core/src/array.cpp:2482: error: (-206) Unrecognized or unsupported array type in function cvGetMat

Program received signal SIGABRT, Aborted.
0xb7fdd424 in __kernel_vsyscall ()
(gdb) 
```

任何想法这里可能有什么问题？我的代码有问题还是opencv有问题或者我没有在某处包含一些opencv路径或者opencv没有正确安装？我没主意了。请帮我 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-03T09:31:02.090

这是一个数据类型不匹配问题

# php - 如何计算mysql中的唯一记录

> ID：15042660
> 
> 赞同：0
> 
> 时间：2013-02-23T16:18:44.310
> 
> 标签：php, mysql

我有一个大型房产数据库，我正在尝试获取特定房产的邮政编码，然后获取第一个字母（区域），然后计算该区域数据库中的所有其他房产。

我追求的是：

物业邮政编码是`L21 5PU`

我想显示一个链接列表：

类似的属性在

L1 (4) L2 (5) L23 (27) 以此类推

这就是我要达到的地方

```
$PC = 'L';

PCSearch = mysql_query("SELECT * FROM Property WHERE POSTCODE LIKE '$PC'") 
```

但是，如何计算邮政编码以`$PC`（在本例中为 L）开头的每个属性，并显示邮政编码列表以及它们旁边的数字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:26:17.790

使用分组依据，例如

```
SELECT postcode , count(*) as property_count FROM property GROUP BY postcode 
```

这会将所有邮政编码分组并为您提供财产数量。

如果要进行部分匹配，我相信您必须为要查找的每个部分邮政编码运行一个循环，并在上述查询中添加一个“where”子句。

```
.. WHERE postcode LIKE 'L%' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:28:52.627

你可以用你的 SQL 查询来完成这一切，使用三个函数：

[子串](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substr)

[数数](http://dev.mysql.com/doc/refman/5.1/en/counting-rows.html)

[通过...分组](http://dev.mysql.com/doc/refman/5.0/en/group-by-extensions.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T16:27:58.120

试试这个查询：

```
SELECT `postcode`, CONCAT(`postcode`, COUNT(`postcode`)) AS `output`
FROM `Property`
GROUP BY `postcode` 
```

该列`output`现在应该包含您需要的内容。

# javascript - 是否可以通过 javascript 原型分配每个实例的成员？

> ID：15042661
> 
> 赞同：1
> 
> 时间：2013-02-23T16:18:44.293
> 
> 标签：javascript, prototype

当我将一个结构与一个函数的原型相关联，然后用该函数实例化多个对象时，它们都共享同一个结构实例。我希望每个对象都有自己的结构实例，而不必在实例化对象时显式创建新实例；那可能吗？

这是我正在尝试做的一个简明示例：

```
function defineClass(constructor, instanceMembers) {
    constructor.prototype.model = instanceMembers.model;
    return constructor;
}

var visualObject = defineClass(function () { }, {
    model: {
        setPosition: function (x, y) {
            this.x = x;
            this.y = y;
        }
    }
});

var testA = new visualObject();
var testB = new visualObject();
testA.model.setPosition(10, 10);
console.log(testB.model.x); // outputs "1", but want it to be undefined 
```

这不起作用，因为 testA.model 和 testB.model 都引用了同一个实体。

如果我在构建时克隆结构，那么它可以工作，但我真的希望避免这种克隆操作。这段代码有效但伤害了我：

```
function defineClass(instanceMembers) {
    var constructor = function () {
        // Create a copy of the model member in this object instance
        this.model = $.extend(true, {}, this.model);
    };
    constructor.prototype.model = instanceMembers.model;
    return constructor;
}

var visualObject = defineClass({
    model: {
        setPosition: function (x, y) {
            this.x = x;
            this.y = y;
        }
    }
});

var testA = new visualObject();
var testB = new visualObject();
testA.model.setPosition(10, 10);
console.log(testB.model.x); // is undefined, as expected 
```

javascript 是否提供了一种无需实例化复制的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T17:58:51.240

我认为这里对原型的用途存在误解。它用于新类的每个实例的**共享成员**。这些通常是函数实现，而不是属性值。

您的第二个示例有效的原因以及 Bergie 的回答有效的原因是您都首先定义了prototype.model，然后稍后在构造函数（？）中覆盖它。

在有问题的第二个示例中发生以下情况：

第一`constructor.prototype.model = instanceMembers.model;`

2nd - 从defineClass返回构造函数后，它被执行 -`this.model = $.extend(true, {}, this.model);`它覆盖来自原型的模型。

**所以你不必将属性的实例化放在原型中，而是放在构造函数中。**

[在此处](https://stackoverflow.com/a/572996/186822)查看有关 javascript 原型的详细答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T17:35:50.400

> javascript 是否提供了一种无需实例化复制的方法？

是的。你希望你的模型有一个共同的原型对象，而不是在实例化时克隆/复制：

```
function defineClass(constructor, prototypeMembers) {
    $.extend(constructor.prototype, prototypeMembers);
    return constructor;
}

var ModelObject = defineClass(function() {}, {
    setPosition: function (x, y) {
        this.x = x;
        this.y = y;
    }
});
var VisualObject = defineClass(function() {
    this.model = new ModelObject;
});

var testA = new VisualObject;
var testB = new VisualObject;
testA.model.setPosition(10, 10);
console.assert(testA.model !== testB.model);
console.log(testB.model.x); // undefined 
```

# javascript - 求和而不是串联

> ID：15042662
> 
> 赞同：0
> 
> 时间：2013-02-23T16:18:47.413
> 
> 标签：javascript

我有我的代码

```
sum=parseFloat($('input[name=fieldname]').val()) * 60 + 
parseFloat($('input[name=fieldname]').val()) + 
(($('input[name=fieldname]').val()) /60).toFixed(2). 
```

它从我输入持续时间的字段中获取值，它应该以分钟为单位给我总和。问题是我得到的总和连接了 3 个字段，而不是返回分钟数。

例如：在 1 小时 20 分钟内，我得到 6020 而不是 (60+20) 80

编辑：上面的代码是通用形式，这里是确切的代码。

```
var sum = parseFloat($('input[name="<?php esc_attr_e( $field->field_id ); ?>hrs"]').val())*60 +
parseFloat(($('input[name="<?php esc_attr_e( $field->field_id ); ?>mins"]').val()) + 
parseFloat($('input[name="<?php esc_attr_e( $field->field_id ); ?>secs"]').val())/60).toFixed(2) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:24:04.843

它连接起来是因为您的语句中仍然有一个字符串。让我们简化数字转换函数并使用直接的语法：

```
var h = $('input[name=hours]').val(),
    m = $('input[name=minutes]').val(),
    s = $('input[name=seconds]').val();
sum = 3600*(h|0) + 60*(m|0) + (s|0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:22:55.420

[`toFixed()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Number/toFixed)返回一个字符串，并将其连接到先前计算的结果。用这个：

```
var input = parseFloat($('input[name=fieldname]').val());
sum = input * 60 + input + Math.round(input / 6000) * 100; 
```

（如果您有单独的输入，则等效，我想您明白了）

# sql - 动态 SQL Server 数据透视表

> ID：15042663
> 
> 赞同：4
> 
> 时间：2013-02-23T16:18:51.177
> 
> 标签：sql, tsql, dynamic, pivot

我找到了一个很好的脚本，它可以通过列名为我的数据透视表动态创建，但我没有将分配的值返回到表中。这是我的起始表。

```
ORDER_ID    DSC_NAME        NAME
----------- --------------- -----------
2           34-1500-XXX     DWG_DOC
3           C0403           EQIP_1
4           C4054           EQIP_2
1           34-1500-013     PART
0           88-0000         PRCS 
```

我运行此 SQL 以在我的数据透视表中生成我想要的列

```
DECLARE @cols AS NVARCHAR(MAX), @query  AS NVARCHAR(MAX);

select @cols = STUFF((SELECT distinct 
           ',' + QUOTENAME(NAME)
               FROM test
               FOR XML PATH(''), TYPE
               ).value('.', 'NVARCHAR(MAX)') 
               ,1,1,'') 
```

这给了我以下输出

```
[DWG_DOC],[EQIP_1],[EQIP_2],[PART],[PRCS] 
```

当我为数据透视表运行动态 SQL 时

```
SET @query = 'SELECT ' + @cols + ' from 
         (
            SELECT ORDER_ID,DSC_NAME
            FROM test
        ) x
        pivot 
        (
            MIN(ORDER_ID)
            for DSC_NAME in (' + @cols + ')
        ) p '

execute(@query) 
```

我看到这个结果...

```
DWG_DOC     EQIP_1      EQIP_2      PART        PRCS
----------- ----------- ----------- ----------- -----------
NULL        NULL        NULL        NULL        NULL 
```

我尝试了几种不同的选项，但我没有想出解决方案来解决为什么这不起作用。

所需的输出将是 ORDER_ID 的列顺序正确的位置

```
PRCS       PART           DWG_DOC        EQIP_1    EQIP_2    
---------- -------------- -------------- --------- ---------
88-0000    34-1500-013    34-1500-XXX    C0403     C4054 
```

但这也适用于我的应用程序。

```
DWG_DOC        EQIP_1    EQIP_2    PART           PRCS
-------------- --------- --------- -------------- -----------
34-1500-XXX    C0403     C4054     34-1500-013    88-0000 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:27:53.367

从选择中删除`ORDER_ID`，然后选择列`name`：

```
SET @query = 'SELECT ' + @cols + ' from 
         (
            SELECT ORDER_ID, DSC_NAME -- <--- you didn't select the name here
            FROM test
        ) x
        pivot 
        (
            MIN(ORDER_ID)
            for DSC_NAME in (' + @cols + ')
        ) p ' 
```

并使用`MAX(DSC_Name)`而不是`MIN(ORDER_ID)`. 像这样：

```
SET @query = 'SELECT '+ @cols + ' from 
         (
            SELECT DSC_NAME, Name
            FROM test
        ) x
        pivot 
        (
            MAX(DSC_Name)
            for NAME in (' + @cols + ')
        ) p '; 
```

## [SQL 小提琴演示](http://sqlfiddle.com/#!3/e0f0e/7)

这会给你：

```
|     DWG_DOC | EQIP_1 | EQIP_2 |        PART |    PRCS |
---------------------------------------------------------
| 34-1500-XXX |  C0403 |  C4054 | 34-1500-013 | 88-0000 | 
```

# javascript - 带空格的正则表达式字符串

> ID：15042664
> 
> 赞同：-1
> 
> 时间：2013-02-23T16:18:52.923
> 
> 标签：javascript, regex

我很难找到带有空格的字符串的正则表达式（它可以使用每个字母和数字）。它的长度应为 5 到 25 个字符。

帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T16:25:38.493

以下正则表达式将匹配 5 到 25 个字符（含）之间的任何字符串，仅包含数字、字母（大写和小写）和空格字符（ascii 0x20）：

`[a-zA-Z0-9\x20]{5,25}`

替换`\x20`为`\s`以包含其他“空白”，例如制表符和换行符。

**编辑**：

@MikeM 是正确的；除非这是锚定的，否则它将贪婪地匹配目标中 5-25 字符字符串的*每个*实例（即，例如，*包含*允许字母的有效 25 字符字符串的 30 字符字符串仍将返回该 25 字符子字符串的匹配项），显然不是OP想要的。

因此，应该更新上面的正则表达式，以确保它只返回一个匹配项，并且仅当整个目标的长度在 5 到 25 个字符之间时，如下所示：

`^[a-zA-Z0-9\x20]{5,25}$`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:29:17.437

我想这就是你想要的

```
^(?=(\s*[a-zA-Z\d]){5,25}$).*$ 
```

这将匹配 5 到 25 个数字或字母，它们之间有任意数量的空格

# php - Aptana 3 和 Codeigniter 外部库自动完成

> ID：15042666
> 
> 赞同：0
> 
> 时间：2013-02-23T16:19:00.993
> 
> 标签：php, codeigniter, aptana

我已经调整了构建路径以自动完成本地 CI 库，但我无法自动完成外部库，如模板和东西。我已按照[http://taggedzi.com/articles/display/autocomplete-eclipse-codeigniter-2](http://taggedzi.com/articles/display/autocomplete-eclipse-codeigniter-2)和[http://r15ch13.de/2011/03/autocomplete-in-aptana-3-for的说明进行操作-codeigniter-2/](http://r15ch13.de/2011/03/autocomplete-in-aptana-3-for-codeigniter-2/)两者都是非常有用的网站，只是为您提供的信息，但一个问题是，我无法自动完成外部库，我已经调整了基本代码以包含它，但它什么也没做。

你们中的任何人都尝试过调整外部 CI 库的自动完成功能，例如模板..等。请分享

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-22T13:44:07.857

我没有尝试过您提到的内容，但使用了[https://github.com/hicode/codeigniter.ruble](https://github.com/hicode/codeigniter.ruble)。它工作得很好。您所要做的就是搜索有关 Aptana 的 codeigniter 卢布。

# visual-studio-2012 - VS2012 IDE将文件拖放到代码中不再起作用

> ID：15042667
> 
> 赞同：0
> 
> 时间：2013-02-23T16:19:05.293
> 
> 标签：visual-studio-2012

我曾经能够将 CSS 或 JS 文件从我的解决方案资源管理器拖到 HTML 中，它会创建必要的引用。这不再有效，我不知道为什么。

我知道这很琐碎，但我已经习惯了，我想念它:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:25:46.013

显然，您必须在 asp.net 解决方案或项目中才能使用此功能。我创建了一个新项目并导入了准确的 HTML 文件，现在拖放功能已返回。

![你在跟我开玩笑吗？](../Images/b03e80284e513c5560aee04e5d2c6a51.png)

# c++ - C++ 错误：使用 Qt 和 QVariant 从指针到指针引用没有匹配的函数调用

> ID：15042672
> 
> 赞同：0
> 
> 时间：2013-02-23T16:19:51.993
> 
> 标签：c++, qt, compiler-errors, qvariant

我有一个这样定义的 QObject 子类（在“Danbooru”命名空间内）：

```
#ifndef DANBOORUPOST_H
#define DANBOORUPOST_H

// Qt

#include <QtCore/QObject>
#include <QtCore/QVariant>
#include <QtCore/QStringList>
#include <QtXml/QXmlStreamAttributes>

// KDE

#include <kurl.h>

class QPixmap;

namespace Danbooru {

    class DanbooruPost : public QObject
    {

    Q_OBJECT

    Q_PROPERTY(QPixmap* pixmap READ pixmap WRITE setPixmap)
    Q_PROPERTY(int id READ id)
    Q_PROPERTY(KUrl fileUrl READ fileUrl)
    Q_PROPERTY(QStringList tags READ tags)
    Q_PROPERTY(KUrl thumbnailUrl READ thumbnailUrl)

    private:

        QPixmap* m_pixmap;

        // basic features of a post

        int m_id;
        int m_height;
        int m_width;
        int m_size;

        KUrl m_url;
        KUrl m_thumbnailUrl;
        QStringList m_tags;

    public:
        explicit DanbooruPost(QVariantMap postData, QPixmap* pixmap = 0,
                              QObject* parent = 0);
        explicit DanbooruPost(QXmlStreamAttributes& postData,
                              QPixmap* pixmap = 0,  QObject* parent=0);

        bool operator==(const DanbooruPost&);

        ~DanbooruPost();

        // Post attributes

        int id() const;
        int height() const;
        int width() const;
        int size() const;

        const KUrl fileUrl() const;
        QStringList tags() const;
        const KUrl thumbnailUrl() const;

        QPixmap* pixmap() const;
        void setPixmap(QPixmap* pixmap);

        const QString toString();

    };

}; // namespace Danbooru

Q_DECLARE_METATYPE(Danbooru::DanbooruPost*)
#endif // DANBOORUPOST_H 
```

我在另一个这样定义的类中使用它：

```
#ifndef DANBOORUSERVICE_H
#define DANBOORUSERVICE_H

#include <QtCore/QObject>
#include <QtCore/QString>
#include <QtCore/QStringList>

#include <KUrl>
#include <KIO/JobClasses>

class QPixmap;
class KUrl;
class KJob;

class DanbooruPost;

namespace Danbooru {

    enum TagType {
        General,
        Artist,
        Copyright,
        Character
    };

    using KIO::StoredTransferJob;

    class DanbooruService : public QObject
    {
    Q_OBJECT

    private:

        // URL fragments

        static const QString POST_URL;
        static const QString TAG_URL;
        static const QString POOL_URL;
        static const QString ARTIST_URL;
        static const QString POOL_DATA_URL;
        static const QString RELATED_TAG_URL;

        // member variables

        KUrl m_url;
        QString m_username;
        QString m_password;
        QStringList m_blacklist;
        QString m_maxRating;

    public:
        DanbooruService(KUrl& boardUrl, QString username = QString(),
                        QString password = QString(),
                        QStringList blacklist = QStringList(),
                        QObject* parent=0);
        ~DanbooruService();

        void getPostList(int page=1, QStringList tags=QStringList(),
                        int limit=100, QString rating="Safe");
        void getPoolList(int page=0);
        void getPool(int poolId, int page=1, QString rating="Safe");
        void getTagList(int limit=10, QString name="");
        void getRelatedTags(QStringList tags=QStringList(),
                            TagType tag_type=General);

        QString allowedRating() const;
        QStringList blacklist() const;

    private Q_SLOTS:
        void processPostList(StoredTransferJob* job);
        void processPoolList(StoredTransferJob* job);
        void processRelatedTagList(StoredTransferJob* job);
        void downloadThumbnail(StoredTransferJob* job);
        void downloadAllTags(StoredTransferJob* job);

    Q_SIGNALS:
        void postDownloadFinished();
        void poolDownloadFinished();
        void downloadError(QString error);
        void postDownloaded(DanbooruPost*&post);
        void postMetadataDownloaded(DanbooruPost* post);
        // TODO: Tags and similar

    };
}; 
```

我遇到的问题来自这段代码（StoredTransferJob 是一个 KDE 类）：

```
void DanbooruService::downloadThumbnail(StoredTransferJob* job)
    {
        if (job->error()) {
            Q_EMIT(downloadError(job->errorString()));
        }

        QVariant postData = job->property("danbooruPost");

        DanbooruPost* post = (DanbooruPost*) postData.data();
        QPixmap* pix = new QPixmap();
        bool ok = pix->loadFromData(job->data());

        if (!ok) {
            Q_EMIT(downloadError(QString("Pixmap data could not be loaded")));
        }

        post->setPixmap(pix);

        Q_EMIT(postDownloaded(post));

    } 
```

但是，编译时，Q_EMIT 部分会生成此错误：

```
/home/lb/Coding/cpp/danbooru_client/src/libdanbooru/danbooruservice.cpp: In member function ‘void Danbooru::DanbooruService::downloadThumbnail(KIO::StoredTransferJob*)’:
/home/lb/Coding/cpp/danbooru_client/src/libdanbooru/danbooruservice.cpp:186:35: error: no matching function for call to ‘Danbooru::DanbooruService::postDownloaded(Danbooru::DanbooruPost*&)’
/home/lb/Coding/cpp/danbooru_client/src/libdanbooru/danbooruservice.cpp:186:35: note: candidate is:
In file included from /home/lb/Coding/cpp/danbooru_client/src/libdanbooru/danbooruservice.cpp:30:0:
/home/lb/Coding/cpp/danbooru_client/src/libdanbooru/danbooruservice.h:104:14: note: void Danbooru::DanbooruService::postDownloaded(DanbooruPost*&)
/home/lb/Coding/cpp/danbooru_client/src/libdanbooru/danbooruservice.h:104:14: note:   no known conversion for argument 1 from ‘Danbooru::DanbooruPost*’ to ‘DanbooruPost*&’ 
```

生成函数中使用的变体的代码是：

```
void DanbooruService::processPostList(KIO::StoredTransferJob* job)
{

    qDebug() << "Got data OK";

    if (job->error()) {
        Q_EMIT(downloadError(job->errorString()));
    }

    QByteArray data = job->data();

    QJson::Parser parser;

    bool ok;

    QVariant result = parser.parse(data, &ok);

    if (!ok) {
        Q_EMIT(downloadError(QString("Unable to decode data")));
    }

    QList<QVariant> postList = result.toList();

    Q_FOREACH(QVariant element, postList) {
        QVariantMap map = element.toMap();
        DanbooruPost* post = new DanbooruPost(map);
        StoredTransferJob* pixmapJob = KIO::storedGet(post->thumbnailUrl(),
            KIO::NoReload, KIO::HideProgressInfo);

        qDebug() << "Basic job info";
        qDebug() << post->id() << post->thumbnailUrl() << post->fileUrl();

        QVariant variant;

        variant.setValue(post);

        pixmapJob->setProperty("danbooruPost", variant);
        connect(pixmapJob, SIGNAL(result(KJob*)), this,
                SLOT(downloadThumbnail(StoredTransferJob*)));

    } 
```

我对这个错误感到非常困惑。我可能做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:34:44.017

您已`class DanbooruPost`在全局命名空间中前向声明`namespace Danbooru`. 您最终得到了两个不同的类，`::DanbooruPost`并且`::Danbooru::DanbooruPost`.

如果这不是您的意图，请从全局命名空间中删除前向声明。

# c# - 多线程快速排序未正确排序

> ID：15042673
> 
> 赞同：1
> 
> 时间：2013-02-23T16:19:53.267
> 
> 标签：c#, multithreading, quicksort

作为一项学校作业，我应该使用至少 2 个线程来执行多线程快速排序算法，但我的代码存在一些我似乎无法修复的问题。

编辑：这就是它不是多线程时的样子。我已经确认这有效。

```
public class Sorter
{
    private int[] mInts;

    public void QuickSort()
    {
        QuickSort(mInts, 0, mInts.Length - 1);
    }

    public Sorter(int[] ints)
    {
        mInts = ints;
    }

    private int Partition(int[] ints, int left, int right)
    {
        int pivotIndex = (right + left) / 2;
        int pivotValue = ints[pivotIndex];

        Swap(ints, right, pivotIndex);

        int storeIndex = left;

        for (int i = left; i <= right - 1; i++)
        {
            if (ints[i] < pivotValue)
            {
                Swap(ints, storeIndex, i);
                storeIndex++;
            }
        }

        Swap(ints, storeIndex, right);

        return storeIndex;
    }

    private void Swap(int[] ints, int x, int y)
    {
        int temp = ints[x];
        ints[x] = ints[y];
        ints[y] = temp;
    }

    private void QuickSort(int[] ints, int left, int right)
    {
        if (left < right)
        {
            int newIndex = Partition(ints, left, right);

             QuickSort(ints, left, newIndex - 1);
             QuickSort(ints, newIndex + 1, right);
        }
    } 
```

上面的工作正常，下面的代码没有。现在它没有正确排序，在我看来，加粗的代码段必须位于其他地方......还是什么？我很难理解线程编程，所以我希望有人能给我一些关于如何解决这个问题的指导，如果可能的话，不必重组我的整个程序。以下是我在线程版本方面取得的进展。

```
public class Sorter
{
    private int[] mInts;

    Thread myThread = null;
    int numThreads = 0;
    int maxThreads = 10;

    public void QuickSort()
    {
        QuickSort(mInts, 0, mInts.Length - 1);
    }

    public Sorter(int[] ints)
    {
        mInts = ints;
    }

    private int Partition(int[] ints, int left, int right)
    {
        int pivotIndex = (right + left) / 2;
        int pivotValue = ints[pivotIndex];

        Swap(ints, right, pivotIndex);

        int storeIndex = left;

        for (int i = left; i <= right - 1; i++)
        {
            if (ints[i] < pivotValue)
            {
                Swap(ints, storeIndex, i);
                storeIndex++;
            }
        }

        Swap(ints, storeIndex, right);

        return storeIndex;
    }

    private void Swap(int[] ints, int x, int y)
    {
        int temp = ints[x];
        ints[x] = ints[y];
        ints[y] = temp;
    }

    private void QuickSort(int[] ints, int left, int right)
    {
        if (left < right)
        {
            int newIndex = Partition(ints, left, right);

            if (numThreads < maxThreads)
            {
                numThreads++;
                myThread = new Thread(new ParameterizedThreadStart(startSort));
                myThread.Start(new SortParameters(this, ints, left, newIndex - 1));
                **QuickSort(ints, newIndex + 1, right);**
            }
        }
    }

    static void startSort(Object obj)
    {
        SortParameters sortParams = (SortParameters)obj;
        sortParams.instance.QuickSort(sortParams.ints, sortParams.left, sortParams.right);
    }

    public class SortParameters
    {
        public Sorter instance;
        public int[] ints;
        public int left;
        public int right;

        public SortParameters(Sorter instance, int[] ints, int left, int right)
        {
            this.instance = instance;
            this.ints = ints;
            this.left = left;
            this.right = right;
        }
    }
} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:47:56.197

问自己以下问题：

1.  一个元素序列将运行多少个线程`n`？
2.  该数字是否受到您的代码的某种限制？
3.  当达到这个限制时会发生什么？

*我在下面提供了我的解决方案，但您可能想先自己考虑一下。*

以下是我的回答：

1.  从理论上讲，您的代码将计算 log [2] (n) 个快速排序，因为它在分区后将每个排序划分为 2 个子调用。在您的线程版本中，您为每个子调用启动一个补充线程，因此您总共可以启动尽可能多的线程。

2.  您提供的代码实际上使用该值限制了启动线程的数量`maxThreads`。所以事实上，如果 log [2] ( `n`) > `maxThreads`，即。如果`n`> 2 ^(`maxThreads`)，代码将达到可能的最大并发线程数。

3.  在线程代码中，围绕突出显示的部分，对该最大值的测试决定了任何递归调用的执行。因此，如果`n`高于第 2 点中提到的限制，代码将停止正常工作。

修复很简单，添加一个`else`子句来完成当前线程的排序。

```
 if (numThreads < maxThreads)
        {
            numThreads++;
            myThread = new Thread(new ParameterizedThreadStart(startSort));
            myThread.Start(new SortParameters(this, ints, left, newIndex - 1));
        }
        else {
            QuickSort(ints,left,newIndex - 1);
        }
        QuickSort(ints, newIndex + 1, right); 
```

正如你所看到的，我也从测试中移出了将由当前线程运行的部分。

# ruby-on-rails - http_basic_authenticate_with 不工作。为什么？

> ID：15042678
> 
> 赞同：2
> 
> 时间：2013-02-23T16:20:40.790
> 
> 标签：ruby-on-rails

我刚开始使用这些东西学习 ruby​​-on-rails：http: [//guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html)

我停在这一步：

**10 安全**

```
class PostsController < ApplicationController
  http_basic_authenticate_with :name => "dhh", :password => "secret", :except => [:index, :show]

  # GET /posts
  # GET /posts.json
  def index
    @posts = Post.all
    respond_to do |format|

    [...]

class CommentsController < ApplicationController
  http_basic_authenticate_with :name => "dhh", :password => "secret", :only => :destroy

  def create
    @post = Post.find(params[:post_id])

    [...] 
```

它没有用。我的意思是，没有提示输入密码和登录，也没有错误。我只是这样做了，没有任何改变。

有人可以帮我解决这个问题，或者至少为我指出解决问题的正确方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T10:24:39.817

这取决于您拥有的 Rails 版本。如果它是 3.2，它应该可以正常工作，正如您在页面顶部看到的那样：

**本指南基于 Rails 3.2。此处显示的某些代码不适用于早期版本的 Rails。**

因此，您可能想先检查一下，然后如果您的版本是较早的版本，请尝试以下操作：

```
class ApplicationController < ActionController::Base
USER, PASSWORD = 'dhh', 'secret'

before_filter :authentication_check, :except => :index

#Any other method

 private
  def authentication_check
   authenticate_or_request_with_http_basic do |user, password|
    user == USER && password == PASSWORD
   end
  end
end 
```

它应该可以正常工作。然后，最后一个选项，您可能已经提供了一次正确的凭据，现在应用程序会记住它是您并允许您执行所有操作，因此（只是为了确定）尝试在其他任何内容中更改用户名。您想编辑该行使其看起来像这样：

```
http_basic_authenticate_with :name => "anotherName", :password => "secret", :except => [:index, :show] 
```

显然，这行代码（如前所述）只能在 Rails 3.2 上工作（我实际上认为它也应该在 3.1 上工作）或更高版本。

# java - Java JFrame setSize 导致滞后

> ID：15042683
> 
> 赞同：0
> 
> 时间：2013-02-23T16:21:40.433
> 
> 标签：java, swing, graphics, jframe, frame-rate

我有一个简单的东西，我正在用 Java 进行测试。

```
package us.superdisk.Teststs;

import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.MouseInfo;
import java.awt.PointerInfo;

import javax.swing.*;

public class Main 
{
    public static void main(String[] argv) {
    JFrame jf = new JFrame("test");
    jf.setVisible(true);

    //jf.setSize(new Dimension(512, 512));

    Graphics g = jf.getGraphics();

    PointerInfo a;
    while (true) {
        a = MouseInfo.getPointerInfo();
        g.drawLine(0, 50, (int)a.getLocation().getX(), (int)a.getLocation().getY());

    }

    }
} 
```

这会在鼠标光标处画一条线。

创建时，窗口非常小且不可见，您必须调整它的大小才能看到线条。但是，线条绘制流畅流畅。

当您取消注释该`setSize`位时，线条图比没有注释时要滞后得多...这对我来说没有多大意义？问题是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:15:13.413

[`LinePanel`](https://stackoverflow.com/a/5797965/230513)是有关您的问题的一些有用评论中建议的方法的示例。该示例包括键绑定，因此您可能希望关注更早、更简单的[修订](https://stackoverflow.com/revisions/5797965/2)。

# python - Ruby 和 Python 中的作用域

> ID：15042691
> 
> 赞同：7
> 
> 时间：2013-02-23T16:22:34.603
> 
> 标签：python, ruby, scope

我一直在同时学习 Ruby 和 Python，我注意到的一件事是这两种语言似乎以不同的方式对待范围。这是我的意思的一个例子：

```
# Python
a = 5
def myfunc():
  print a

myfunc() # => Successfully prints 5

# Ruby
a = 5
def myfunc
  puts a
end

myfunc # => Throws a "NameError: undefined local variable or method `a' for main:Object" 
```

似乎 def 块可以访问在 Python 中其直接范围之外声明的变量，但在 Ruby 中则不能。有人可以确认我的理解是否正确吗？如果是这样，这些思考范围的方式中的一种是否在编程中更常见？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T16:47:18.377

免责声明：我不是 python 专家

在 python 中，模块中定义的变量默认是模块变量，因此是该模块的全局变量。在 Ruby 中，当您定义一个小写变量时，它始终是一个局部变量。局部变量只能在定义它们的块中以及在包装变量的块中定义的 procs/lambdas 中访问。

在 Ruby 中，对于跨范围的变量，它需要是：

*   常量 ( `ALL_CAPS`)：总是可访问的，如果以正确的范围为前缀
*   类变量 ( `@@double_at`)：始终可以从定义类和任何子类访问，但不能从外部访问
*   实例变量 ( `@single_at`)：只能从该对象内部访问，并且可以从外部使用 getter 方法/ 访问`get_instance_variable`。
*   全局 ( `$starts_with_dollar`)：一个坏主意。跨越所有范围，不需要范围。不使用！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:35:30.027

在 Ruby 中，如果您想访问在您正在调用的方法之外定义的变量，您需要将其定义为全局变量。Ruby 尝试匹配本地范围内定义的变量，如果没有找到，则抛出异常。

你可以定义一个带`$`符号的全局变量。

```
$a = 5
def myfunc
  puts $a
end

myfunc 
```

然而，作为一般规则，定义全局变量并不是一个好习惯，否则会冒着污染全局命名空间的风险。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T18:20:35.673

您可以使用`dis`模块来查看 Python 正在做什么。

```
import dis

a = 5
def myfunc():
  print a 
```

结果：

```
>>> dis.dis(myfunc)
 15           0 LOAD_GLOBAL              0 (a)
              3 PRINT_ITEM          
              4 PRINT_NEWLINE       
              5 LOAD_CONST               0 (None)
              8 RETURN_VALUE 
```

所以你可以看到它`a`在全局范围内。

# javascript - 带有 Ajax（单页应用程序）和虚拟 URL 的历史 API

> ID：15042695
> 
> 赞同：1
> 
> 时间：2013-02-23T16:23:04.737
> 
> 标签：javascript, single-page-application, history.js

目前我没有任何脚本只有一个想法，但不确定是否可能。

我想做的事：

我想创建一个具有能力的单页应用程序，用户可以单击后退和前进（历史 api）。

当用户第一次访问页面时，内容将从服务器加载。如果他点击另一个链接，我想隐藏当前页面的内容并显示新目标的内容。

我的问题：

1.  那有可能吗？
2.  有没有可能的例子？
3.  为什么 History.js 有很多像 history.adapter.jquery.js 这样的“适配器”？
4.  您使用哪种技术来隐藏大型内容？
5.  您是否有保存、缓存大型内容以供以后显示的建议？

# java - 在 iText 中更改文本大小

> ID：15042696
> 
> 赞同：0
> 
> 时间：2013-02-23T16:23:06.267
> 
> 标签：java, pdf, itext

我正在尝试使用 iText 更改字体属性，但无法正常工作。你对这段代码有什么问题有什么看法吗？

```
public static ByteArrayOutputStream createPersonnelReport(String sablonDir, String g,byte[] fotograf) {
        ByteArrayOutputStream baos = null;
        try {
            baos = new ByteArrayOutputStream();
            BaseFont fontTimes = BaseFont.createFont(sablonDir + File.separator + fontName, BaseFont.IDENTITY_H, BaseFont.NOT_EMBEDDED);

            PdfReader reader = new PdfReader(sablonDir + File.separator + tmSablonForSicilKaydiName);
            PdfStamper stamper = new PdfStamper(reader, baos);
            AcroFields form = stamper.getAcroFields();
            PdfContentByte canvas = stamper.getOverContent(1);

            form.setField("g", g);
            boolean check=form.setFieldProperty("g", "textsize", new Float(26), null);                                     
            System.out.println("check: "+ check);

            InputStream fotografImage = new ByteArrayInputStream(fotograf);
            BufferedImage bImageFromConvert = ImageIO.read(fotografImage);
            int type = bImageFromConvert.getType() == 0 ? BufferedImage.TYPE_INT_ARGB : bImageFromConvert.getType();
            BufferedImage dimensionedImage = resizeImage(bImageFromConvert, type);
            ImageIO.write(dimensionedImage, "jpg", new File("c:/yeniPersonelFoto.jpg"));
            Image image1 = Image.getInstance("c:/yeniPersonelFoto.jpg");
            image1.setAbsolutePosition(450f, 650f);
            canvas.addImage(image1);        
            stamper.setFormFlattening(true);
            stamper.close();

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            return baos;
        }
    } 
```

编辑：检查：真在输出中返回

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T08:09:56.157

答案是缺少一行代码：

```
form.regenerateField("g"); 
```

解决了这个问题。进行更改后，您必须重新生成该字段。

# matlab - Matlab 预分配与 SimBiology 对象

> ID：15042697
> 
> 赞同：2
> 
> 时间：2013-02-23T16:23:12.440
> 
> 标签：matlab

我正在运行一个具有几个嵌套循环的 MatLab 脚本，并被告知要预先分配我的一些向量和数组。

我已经能够找到如何为单元格或双精度数执行此操作，但是很难找到如何为其他数据类型预分配数组。

具体来说，我正在使用包含 SimBiology 对象的向量和数组。

所以我们有：

*   allModels 作为 100 个 SimBiology 模型的向量

*   resultsData 作为 SimData 的向量

*   allResults 作为 amxn SimData 矩阵

我认为所有这些都可以从预分配中受益——目前，当我运行脚本时，我看到我的内存使用量急剧增加，这可能是由于重新分配和内存碎片，以及释放的内存没有被有效地清理/返回给操作系统。

我对matlab很陌生，所以如果答案很明显，或者我没有提供足够的信息，我深表歉意......感谢您的帮助！

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T15:11:17.920

我稍后会给您一些预分配技巧，但我首先要指出，您的内存使用更有可能是由于 SimBiology 模型在您退出 MATLAB 之前一直保留在内存中。SimBiology 模型在以下几个重要方面表现与细胞或双胞胎完全不同：

1.  SimBiology 模型是“处理对象”而不是“值对象”。您可以在 MATLAB 文档中阅读有关[句柄和值对象](http://www.mathworks.com/help/matlab/matlab_oop/comparing-handle-and-value-classes.html)的更多信息，但这里的关键点是多个变量可以同时引用同一个内存中 SimBiology 模型。
2.  SimBiology 模型会一直保留在内存中，直到被明确删除。您始终可以使用函数[sbioroot](http://www.mathworks.com/help/simbio/ref/sbioroot.html)访问所有内存中的 SimBiology 模型。要从内存中删除 SimBiology 模型，您必须调用该[`delete`](http://www.mathworks.com/help/simbio/ref/delete.html)方法，例如`delete(modelObj)`. 如果您想一次删除**所有**SimBiology 模型，您可以调用该函数[`sbioreset`](http://www.mathworks.com/help/simbio/ref/sbioreset.html)（但请谨慎使用此函数！）。

现在，进行预分配。“[反向 for 循环”](http://blogs.mathworks.com/loren/2006/07/19/how-for-works/#10)是一种可以预先分配**任何**数据类型的方法（无需为每种数据类型学习特定函数）。这个想法是利用 MATLAB 的自动数组分配，以一种最初分配最大大小的数组的方式。这是一个愚蠢的例子，它制作了 2 的前 5 个幂的向量：

```
for ind = 5:-1:1
  squares(ind) = ind^2;
end 
```

我说这是一个愚蠢的例子，因为它最好在 MATLAB 中实现为`(1:5)^2`. 尽管如此，我希望它能够理解使用反向 for 循环进行分配的想法。

对于您使用 SimBiology 的特殊情况，您需要结合显式删除 SimBiology 模型和反向 for 循环。您的代码可能如下所示：

```
% Note the reverse for loop below
for modelIndex = 100:-1:1
  % First, load the model
  % Option 1: Load your models from a list of SBML files stored in sbmlFileNames
  allModels(modelIndex) = sbmlimport(sbmlFileNames{modelIndex})
  % Option 2: Load your models from a list of sbproj files stored in projFileNames
  loadedProject = sbioloadproject(projFileNames{modelIndex});
  allModels(modelIndex) = loadedProject.m1;
  % Option 3: Explicitly create your model
  allModels(modelIndex) = sbiomodel(['Model ' num2str(modelIndex)]);
  % Of course, you'll need to customize each model somehow

  % Store a "baseline" simulation of each in resultsData
  resultsData(modelIndex) = sbiosimulate(allModels(modelIndex));

  % Now create the matrix of SimData
  % Note the reverse for loop below
  for variantIndex = 20:-1:1
    % Setup for the modified simulation.
    % One option: Use some previously defined variant objects stored in variantList
    allResults(modelIndex, variantIndex) = ...
      sbiosimulate(allModels(modelIndex), variantList(variantIndex));
  end
end

% Once you are done, delete SimBiology models to free memory
delete(allModels) 
```

如果您还有其他问题，请随时联系 MathWorks 技术支持。（我是 SimBiology 的开发人员之一，我总是很高兴有机会听到我们的用户在做什么，并找到让他们的生活更轻松的方法。）

-亚瑟

# javascript - 如何比较两个 javascript 数组并添加和删除不同的项目？

> ID：15042707
> 
> 赞同：-3
> 
> 时间：2013-02-23T16:24:56.027
> 
> 标签：javascript, arrays

我想读取array2并从array1中删除项目并将新项目添加到array1：

如果参数“Removed”是 1，那么我想删除这个项目。如果参数“已移除”为 0，那么我想添加项目。

如何使用 javascript 制作以下解决方案？

我有两个数组：

```
var array1 = [
{ItemId: "1", Name: "John"},
{ItemId: "2", Name: "George"}, 
{ItemId: "3", Name: "Peter"}
] 
```

和

```
var array2 = [
{ItemId: "1", Name: "John", Removed: "1"},
{ItemId: "4", Name: "Mario", Removed: "0"}, 
{ItemId: "5", Name: "Mike", Removed: "0"}
] 
```

我想要以下结果：

```
var array1 = [
    {ItemId: "2", Name: "George"}, 
    {ItemId: "3", Name: "Peter"},
    {ItemId: "4", Name: "Mario"}, 
    {ItemId: "5", Name: "Mike"}
    ] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:37:03.797

尝试这个：

注意：这不会对具有相同“名称”或相同“ItemId”的重复条目进行任何检查。您可能也想这样做。

```
var array1 = [
    {ItemId: "1", Name: "John"},
    {ItemId: "2", Name: "George"}, 
    {ItemId: "3", Name: "Peter"}
];

var array2 = [
    {ItemId: "1", Name: "John", Removed: "1"},
    {ItemId: "4", Name: "Mario", Removed: "0"}, 
    {ItemId: "5", Name: "Mike", Removed: "0"}
];

for(var i = 0; i < array2.length; i++) {
    if(array2[i]["Removed"] == "1") {
        // Remove elements
        for(var j = 0; j < array1.length; j++) {
            if(array1[j]["Name"] == array2[i]["Name"]) {
                array1.splice(j,1);
            }
        }
    } else {
        item = {};
        item["ItemId"] = array2[i]["ItemId"];
        item["Name"] = array2[i]["Name"];
        array1.push(item);
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-23T16:47:49.513

`Object.equals()`从[https://stackoverflow.com/a/1144249/1922787](https://stackoverflow.com/a/1144249/1922787)使用：

```
function mergeArrays(array, operations) {
  var obj;
  var removed;

  for (var i = 0; i < operations.length; i++) {
    obj = operations[i];
    removed = obj.Removed;
    delete obj.Removed;

    if (removed === '0') { array.push(obj); }
    if (removed === '1') { array = removeObjFromArray(array, obj); }
  }

  return array;
}

function removeObjFromArray(array, obj) {
  for (var i = 0; i < array.length; i++) {
    if (obj.equals(array[i])) {
      array.splice(i, 1);
      break; // assuming you don't have dupplicated objects in your array
    }
  }

  return array;
}

array1 = mergeArrays(array1, array2); 
```

# python - ImportError：没有名为 prop2part (TuLiP) 的模块

> ID：15042710
> 
> 赞同：0
> 
> 时间：2013-02-23T16:25:12.107
> 
> 标签：python, python-2.7, compiler-errors

在 Python 中使用 TuLiP 模块，当我尝试编译我拥有的代码时，总是会出现一条错误消息：

`ImportError: No module named prop2part`

在代码中，初始化包含：

```
import sys, os
import matplotlib as mpl
import matplotlib.pyplot as plt
sys.path.append(os.path.join(os.path.abspath(os.path.dirname(sys.argv[0])), '..'))
from prop2part import Region, PropPreservingPartition 
```

任何想法为什么会出现错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:46:10.840

从此链接下载 prop2part 模块`http://tulip-control.sourceforge.net/doc/_modules/prop2part.html`然后将下载的路径附加到 sys.path 列表中，或者您可以将下载的模块移动到 sys.path 中可用的任何路径中。

# php - 有没有办法用 Zend_Db_Adapter 检索 SHOW WARNINGS 的输出？

> ID：15042716
> 
> 赞同：1
> 
> 时间：2013-02-23T16:26:03.480
> 
> 标签：php, mysql, zend-framework

让我们考虑一个非常基本的表格：

```
CREATE TABLE test_warning (col_a INT NOT NULL, col_b INT NOT NULL)

+-------+---------+------+-----+---------+-------+
| Field | Type    | Null | Key | Default | Extra |
+-------+---------+------+-----+---------+-------+
| col_a | int(11) | NO   |     | NULL    |       |
| col_b | int(11) | NO   |     | NULL    |       |
+-------+---------+------+-----+---------+-------+ 
```

当我插入未指定其中一列的行时，会生成警告：

```
INSERT INTO test_warning (col_a) VALUES (1);
Query OK, 1 row affected, 1 warning (0.05 sec)

SHOW WARNINGS;
+---------+------+--------------------------------------------+
| Level   | Code | Message                                    |
+---------+------+--------------------------------------------+
| Warning | 1364 | Field 'col_b' doesn't have a default value |
+---------+------+--------------------------------------------+ 
```

有没有人试图检索在 zend 应用程序中`SHOW WARNINGS`使用的输出？`Zend_Db_Adapter`

我试过以下：

*   插入带有适配器的行（例如，通过创建`Zend_Db_Row`并保存它）缺少列的值以引发警告。
*   执行类似的命令`$adapter->query('SHOW WARNINGS')->fetchAll();`。这将返回一个空数组。

我开始相信这`Zend_Db_Adapter`“仅”对通过`SELECT`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T21:54:04.300

有趣的问题。我刚刚运行了一个测试， fetchAll()似乎*确实*返回了 MySQL 警告的结果，至少对我来说是这样！我正在运行 ZF 1.12.0

首先，我在命令行上运行了一条 SQL 语句，其中字段的值超过了 VARCHAR 限制，并且列没有默认值。

结果如下：

```
mysql> INSERT INTO `myTable` (`example2`) VALUES ('a value that is too long');

mysql> show warnings;
+---------+------+-------------------------------------------------+
| Level   | Code | Message                                         |
+---------+------+-------------------------------------------------+
| Warning | 1364 | Field 'example1' doesn't have a default value   |
| Warning | 1265 | Data truncated for column 'example2' at row 1   |
+---------+------+-------------------------------------------------+ 
```

然后我使用 Zend_Db 运行相同的查询...

```
$stmt = $db->query(
    'INSERT INTO `myTable` (`example2`) VALUES (\'a value that is too long\')'
);

$stmt = $db->query(
    'SHOW WARNINGS;'
);

$result = $stmt->fetchAll();

echo '<pre>';
var_dump($result);
echo '</pre>'; 
```

结果如下：

```
array(4) {
  [0]=>
  array(3) {
    ["Level"]=>
    string(7) "Warning"
    ["Code"]=>
    string(4) "1364"
    ["Message"]=>
    string(44) "Field 'example1' doesn't have a default value"
  }
  [1]=>
  array(3) {
    ["Level"]=>
    string(7) "Warning"
    ["Code"]=>
    string(4) "1265"
    ["Message"]=>
    string(44) "Data truncated for column 'example2' at row 1"
  }
} 
```

这里的主要区别是我将 SQL 直接写入 query() 方法，而不是使用 Zend_db_Select 构造它。值得一试，尽管理论上它不应该有所作为。

# wordpress - 限制对特定角色的修订（在 WordPress 中）

> ID：15042717
> 
> 赞同：0
> 
> 时间：2013-02-23T16:26:06.407
> 
> 标签：wordpress

我正在构建一个平台，允许会员创建教科书、课程、教室和“实验室”。有没有办法只允许某些成员存储超过 3 个修订版？

我想也许我可以做这样的检查：

`if(!has_cap('store_unlimited_revisions')) define('WP_REVISIONS', 3);`

除了那些有`'store_unlimited_revisions'`. 但是，如果已经有 10 个修订并且您定义了 3 个，那么当您创建新修订时，只会保存最新的 3 个，其余的会被删除。

这行得通吗？如果具有角色 (A) 的人在没有角色 (B) 的人之前保存了一个瞬间，那么 A 会丢失他们的修订，因为 B 是最后一个定义修订限制的人吗？

如果没有，是否有其他方法可以在保存时删除 3 以上的最旧版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:00:57.880

你的第一个“这行得通吗？” 问题 - 老实说，我不熟悉该常量的使用方式，也不具体是如何/何时根据该常量清除修订版，所以我无法回答这个抱歉。自己试试吧，我猜。

重新“另一种方式”，这就是我的做法。像这样的东西会提取给定帖子 ID 的所有修订：

```
SELECT 
 ID 

FROM 
 wp_posts 

WHERE 
 post_parent = {$id_of_post_being_saved}
 and
 post_type = 'revision'
 and 
 post_name like '{$id_of_post_being_saved}-revision%'

ORDER BY 
 id 
```

（`post_name like '{$id_of_post_being_saved}-revision%'`包含在 where 子句中以排除例如自动保存）。

然后可以（回到 PHP 中）确定返回的修订数是否超过 3，并排序`post_name`（例如，“425-revision”、“425-revision-2”、“425-revision-3”等，以获取帖子 id 425 的修订) 或`post_date`继续获得“最旧”的修订版（基本上，无论逻辑满足您的需求 - 无论哪种方式，我都建议您进行一些研究/实验以确认逻辑实际上会隔离您所追求的修订版，尽管我正在拉这不是我自己在实践中自己做过的！）

现在，我在实践中使用此代码*删除*所有帖子的所有修订（即在基于 WP 的小册子网站上发布生产之前清理所有旧草稿）：

```
DELETE 
 a,b,c 

FROM 
 wp_posts a  

 LEFT JOIN wp_term_relationships b 
 ON (a.ID = b.object_id)  

 LEFT JOIN wp_postmeta c 
 ON (a.ID = c.post_id)  

WHERE 
 a.post_type = 'revision' 
```

但是现在您已经有了`ID`想要敲击头部的特定帖子的特定修订版的帖子（来自第一个查询），请将以下内容添加到上面的 where 子句中以执行此操作：

```
 and a.id = {$post_id_to_delete} 
```

NB 这都可以在一个聪明的 SQL 语句中实现，例如，通过在第一个结果集和第一个结果集的分组最大值之间使用自连接，然后基于此删除......但我个人会处理“智能” " 在 PHP 中，以便您可以根据 WP/PHP 等中可用的参数更轻松地调整逻辑（例如，超过 3 个修订规则）。

# python - 使用 Python mechanize 触发 onclick 按钮

> ID：15042718
> 
> 赞同：0
> 
> 时间：2013-02-23T16:26:06.530
> 
> 标签：python, onclick, mechanize

所以，问题来了：我得到了一个提供信息的表格。该表单只有一个字段，我可以使用 mechanize 的 .select_form 和 .form 函数轻松地在任何内容中写入。

然而，提交 func.doesn't work as well as it should.

如何使用机械化单击 onclick 按钮？我知道它是 JS，但它也应该是在 Py 中执行此操作的正确方法。

这是表单的 HTML 代码：

```
<input type="text" name="P_COD" value="IT001990225863" class="textbox2" maxlength=14 size=20 onblur="this.value=this.value.toUpperCase()">
&nbsp;&nbsp;&nbsp;
<input TYPE="button" VALUE="Search" onclick="query()" class="pulsante"> 
```

我也试过`br.click('Search')`了，它正确指向按钮，但出现以下错误：`ControlNotFoundError: no control matching name 'Search', kind 'clickable'`

这是表格列表：

```
<HiddenControl(P_CAP=BOV) (readonly)>
  <HiddenControl(P_COD_S=) (readonly)>
  <TextControl(P_COD=IT001990225863)>
  <IgnoreControl(<None>=<None>)>> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:28:49.303

您将需要使用 Selenium 之类的东西，或者无头浏览器，在您的页面上运行 JavaScript。Mechanize 没有内置 JavaScript 引擎。

# asp.net - 如果我需要将站点的中间始终保持在中间，那么 1140 像素 CSS 网格系统会起作用吗？

> ID：15042721
> 
> 赞同：0
> 
> 时间：2013-02-23T16:26:24.773
> 
> 标签：asp.net, css, bing-maps, asp.net-webpages

我需要创建一个站点（一页原始内容），如果我使用 1140px/12 列系统（[http://cssgrid.net/](http://cssgrid.net/)），左侧 3 列，中间 6 列，3在右侧。

左边的条带将包含控件，可能主要是一个 Treeview。

“巨大”的中间部分将是 Bing 地图。

在手机或平板电脑上查看时，我需要将地图固定为中心。

这是否适用于 1140/12 项目，还是我应该转向另一个方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:44:10.030

我将从创建示例布局开始，这样我们就可以确定我们在那里谈论的是同一件事。3+6+3 网格的基本布局为：

```
<div class="container">
    <div class="row">
        <div class="threecol"></div>
        <div class="sixcol"></div>
        <div class="threecol"></div>
    </div>
</div> 
```

有 3 个 div`width`设置了百分比并`float: left;`应用于向他们展示买方。然后将窗口大小调整为小于 768px 的宽度，媒体查询开始工作。此媒体查询将从列中删除浮动，并使它们各自占据 100% 的宽度。

所以简短的回答不是，中间的列不会停留在屏幕的中心，它会被推到左边的列下面，占据屏幕宽度的 100%，也会占据屏幕宽度的 100%。第三列也将被推到第二列下方并占据 100% 的宽度。

如果您只需要将地图留在其他列的顶部以便首先看到，我建议编写媒体查询，将在手机上隐藏左列并在灯箱中单击时打开它，然后用户将需要它。

如果您需要将它们并排显示在同一个屏幕上，您可能需要为您的网格编写自己的类。

# javascript - 脊柱。没有方法'hasMany'

> ID：15042725
> 
> 赞同：1
> 
> 时间：2013-02-23T16:26:43.597
> 
> 标签：javascript, spine.js

我对 spinjs 关联有疑问。

```
 class Category extends Spine.Model
    @configure 'Category', 'name', 'id'
    @extend Spine.Model.Ajax

    @hasMany 'children_categories', 'Category'
    @url: Route.categories() 
```

但它写了一个错误

> 未捕获的类型错误：对象类别（名称，id）没有方法“hasMany”

我做错了什么？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:33:29.573

你有没有包含`relation.js`文件？根据[文档](http://spinejs.com/docs/relations)：

> Spine 的关系逻辑在库的其余部分的单独模块中可用，relation.js。在继续之前，您需要将其包含在您的应用程序中。

# android - 为什么接收器不响应？

> ID：15042726
> 
> 赞同：0
> 
> 时间：2013-02-23T16:27:05.513
> 
> 标签：android, plugins, broadcastreceiver

在我的应用程序 myApp1 我只有一个接收器

```
<receiver
    android:name="com.plugins.Plugin">
    <intent-filter android:priority="1000" >
        <action android:name="Plugin.Broadcast" />
    </intent-filter>
</receiver> 
```

如果我将 BroadcastReceiver 从我的另一个应用程序 myApp2 发送到该接收器

```
Intent activityIntent = new Intent();
activityIntent.setAction("Plugin.Broadcast");
activityIntent.putExtra("appWidgetId", finalAppWidgetId);
sendBroadcast(activityIntent); 
```

它不响应。如果我在 myApp1 中添加一些带有 Launcher 类别的 Activity，主要操作并在安装 myApp1 后运行它，然后接收器工作。为什么会发生？我该如何解决？

答：为了确保收到广播，我需要在我的意图中添加标志：

```
 i.addFlags(Intent.FLAG_INCLUDE_STOPPED_PACKAGES); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:19:26.267

从 Android 3.0 (Honeycomb) 开始，出于安全原因，应用程序在至少启动一次（即一个 Activity 已启动）之前无法接收广播。

这样做是为了防止恶意应用程序被安装并在常见的广播（如`BOOT_COMPLETED`和`BATTERY_CHANGED`.

因此，myApp1 中的接收器仅在您的 UI 已在该应用程序中至少打开一次时才有效。

# http - 是否有 HTTP 验证器来显示我的供应商的 API 是否正在创建格式不正确的 POST？

> ID：15042728
> 
> 赞同：6
> 
> 时间：2013-02-23T16:27:21.263
> 
> 标签：http, multipartform-data

如果这不是正确的论坛，我深表歉意，但我无法弄清楚这个问题在所有网站中的位置。我的供应商有一个用于将文件上传到服务器的 API，使用 Content-Type 创建一个 POST：multipart/form-data。我的 node.js express 无法解析请求，当使用其他工具生成上传请求时，我看到的主要区别在于，在 Fiddler 中，边界之间有一段绝对没有内容。例如：

```
POST /upload HTTP/1.1
Content-Type: multipart/form-data; boundary=887c07d2-ff01-4eaa-b374-a807f9673742
Cache-Control: no-cache
Pragma: no-cache
User-Agent: Java/1.7.0_15
Host: 192.168.1.109:3000
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Connection: keep-alive
Content-Length: 2539

--887c07d2-ff01-4eaa-b374-a807f9673742
--887c07d2-ff01-4eaa-b374-a807f9673742
Content-Disposition: form-data; name="Filename"

picture_178.jpg
--887c07d2-ff01-4eaa-b374-a807f9673742
Content-Disposition: form-data; name="folder"

whatever
--887c07d2-ff01-4eaa-b374-a807f9673742
Content-Disposition: form-data; name="Filedata"; filename="picture_178.jpg"
Content-Type: image/jpeg

......JFIF.....H.H.....C.........................................
(etcetera) 
```

我查看了相关的 RFC，我认为这是无效的，但是是否有一些工具可以帮助我就此达成一致，向我的供应商展示？我知道 HTML 验证器和其他验证器，但我找不到任何东西来验证线路协议结果。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-04T22:53:52.633

我不知道任何在线验证工具，但[多部分规范](http://www.w3.org/Protocols/rfc1341/7_2_Multipart.html)要求边界之间的部分是符合 RFC 822 的消息。由于上述 RFC 要求消息至少有一些空格，因此空字符串是不够的。因此我相信，该示例不是有效的多部分消息。

# sql - SQL合并2个表

> ID：15042729
> 
> 赞同：2
> 
> 时间：2013-02-23T16:27:22.237
> 
> 标签：sql, join

我是数据库查询编码的新手，我做了一些谷歌来了解如何将两个表合并为一个，但 INNER JOIN 和 UNION ALL 并不完全符合我的需要。

我有 2 个完全不同的表格，我希望它并排合二为一

这是我所拥有的：

```
+-----------+  +------------+
| ids type  |  | d1  d2  d3 |
+-----------+  +------------+
| 1   01    |  | 45  13  4  |
| 2   02    |  | 46  14  4  |
| 3   03    |  | 47  15  4  |
+-----------+  | 48  16  4  |
               +------------+ 
```

我想得到这个：

```
+-----------------------+
| ids  type  d1  d2  d3 |
+-----------------------+
| 1    01    45  13  4  |
| 2    02    46  14  4  |
| 3    03    47  15  4  |
| NULL NULL  48  16  4  |
+-----------------------+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:36:21.873

您遇到的问题是您没有 ke 可以加入表格。假设您使用的是合理的数据库，您可以使用`row_number()`. 我将假设第一个表按顺序排列，`ids`第二个按顺序排列`d1`。

```
select t1.ids, t1.type, t2.d1, t2.d2, t2.d3
from (select t1.*, row_number() over (order by ids) as seqnum
      from t1
     ) t1 full outer join
     (select t2.*, row_number() over (order by d1) as seqnum
      from t2
     ) t2
     on t1.seqnum = t2.seqnum 
```

这样做是为每个表分配一个序号，然后将其用于连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:40:05.973

这是使用几个 CTE 的一种方法`ROW_NUMBER`：

```
with cte1 as (
  select ids, type, ROW_NUMBER() OVER (ORDER BY ids) rn
  from table1 
  ), cte2 as (
  select d1, d2, d3, ROW_NUMBER() OVER (ORDER BY d1) rn
  from table2 
  ) 
select t1.ids, t1.type, t2.d1, t2.d2, t2.d3
from cte1 t1 
  left join cte2 t2 on t1.rn=t2.rn
union 
select t1.ids, t1.type, t2.d1, t2.d2, t2.d3
from cte2 t2 
  left join cte1 t1 on t1.rn=t2.rn
where t1.ids is null 
```

[小提琴演示示例](http://sqlfiddle.com/#!3/42b381/5)

# java - 在 JAVA 中创建 CSV 字符串时添加空值

> ID：15042730
> 
> 赞同：3
> 
> 时间：2013-02-23T16:27:36.610
> 
> 标签：java, jsp, servlets, csv

我有一个表格，我从 3 复选框中获取值。我在 servlet 中得到的值如下，

```
String csvSkills = null;

String[] skills = request.getParameterValues("chkSkills");

for(int i=0; i<skills.length; i++){
    csvSkills   +=  skills[i]+",";
}

System.out.println(csvSkills); 
```

输出：

```
nullPHP,JAVA,MYSQL, 
```

虽然最初 csvSkills 值为 null，但会显示 null 值。我尝试了很多，不知道如何做到这一点。我的疑问是如何在没有`null`开始的情况下制作 csv 值？希望我的问题很清楚。提前致谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:55:47.493

其他答案告诉你为什么会有一个空值：你没有初始化你的 csvSkills 字符串。

您应该知道的另一件事是您应该为 csvSkills 使用 StringBuilder 而不是 String。在循环内附加到字​​符串是**非常**低效的。在幕后，编译器每次通过循环创建一个新的 StringBuilder 以将两个字符串连接在一起，然后将其丢弃。每次通过循环，为该迭代创建的 StringBuilder 的大小都会变得越来越大。您想对所有附加使用单个 StringBuilder 实例。

```
StringBuilder  csvSkills = new StringBuilder();
for (String s:  request.getParameterValues("chkSkills")){
    if (csvSkills.length > 0) csvSkills.append(",");
    csvSkills.append(s);
}
return csvSkills.toString(); 
```

我是处理 CSV 的免费开源 Java 实用程序的作者。我建议为此使用[Ostermiller CSV 库](http://ostermiller.org/utils/CSV.html)。除了处理仅在需要时附加逗号的逻辑外，它还将在您附加的字段包含引号或逗号的情况下处理引用和转义。

```
StringWriter writer = new StringWriter();
CSVPrinter  csvSkills = new ExcelCsvPrinter(writer);
for (String s:  request.getParameterValues("chkSkills")){
    csvSkills.write(s);
}
return writer.toString(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T16:28:35.550

初始化`csvSkills`为空字符串，而不是`null`.

```
String csvSkills = ""; 
```

`null`当你在 java 中连接字符串时，你会得到`null`. 此外，如果您不想在列表末尾添加逗号，则可以有条件地添加逗号。像这样的东西：

```
for (int i=0; i<skills.length; i++){
    if (i > 0) {
        csvSkills += ",";
    }
    csvSkills += skills[i];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T16:29:07.847

您想将“csvSkills”初始化为“”（空字符串）而不是 null。

还可以考虑添加一个 if 语句来确定是否添加逗号，这样最后就没有逗号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T16:44:55.533

仅当 csvSkills 大于 0 时才应添加逗号

```
StringBuilder csvSkills = new StringBuilder();

String[] skills = request.getParameterValues("chkSkills");

for (String skill : skills) 
{
   if(csvSkills.length() > 0)
    csvSkills.append(",");

   csvSkills.append(skill);

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-23T16:33:30.697

您需要初始化`csvSKills`为空 String `""`。

```
String csvSkills = ""; 
```

一个更好的解决方案是`StringBuilder`用于连接很多`String`s：

```
StringBuilder csvSkills = new StringBuilder();

String[] skills = request.getParameterValues("chkSkills");

for (String skill : skills) {
    csvSkills.append(skill).append(",");
}

System.out.println(csvSkills.toString()); 
```

# ajax - 如果窗口模糊，则暂停 Setinterval

> ID：15042731
> 
> 赞同：0
> 
> 时间：2013-02-23T16:27:42.113
> 
> 标签：ajax, focus, setinterval, blur

我在这里找到了一个代码来帮助查找选项卡是否处于活动状态。目标是每十秒调用一次 ajax（跨域）url，以了解用户在网站上停留的时间。在找到不同的改编后，我在这里寻求帮助！提前感谢您的任何解释:)

```
<script type="text/javascript">
var state='';

(function() {
    var hidden, change, vis = {
            hidden: "visibilitychange",
            mozHidden: "mozvisibilitychange",
            webkitHidden: "webkitvisibilitychange",
            msHidden: "msvisibilitychange",
            oHidden: "ovisibilitychange" /* not currently supported */
        };             
    for (hidden in vis) {
        if (vis.hasOwnProperty(hidden) && hidden in document) {
            change = vis[hidden];
            break;
        }
    }
    if (change)//this is for detecting without  focus, so it works for your second requirement
        document.addEventListener(change, onchange);
    else if (/*@cc_on!@*/false) // IE 9 and lower
        document.onfocusin = document.onfocusout = onchange
    else
        window.onfocus = window.onblur = onchange;

    function onchange (evt) {
        var body = document.body;
        evt = evt || window.event;

        if (evt.type == "focus" || evt.type == "focusin")
       {   
    body.className = "visible";
       state='visible';
        }         else if (evt.type == "blur" || evt.type == "focusout")
        {  body.className = "hidden";     state='';}
            else    {    
            body.className = this[hidden] ? "hidden" : "visible";}
    }

})();

setInterval(function() {
if(state=='visible')
{
var request = new XMLHttpRequest();
request.onreadystatechange = function() {
     if (request.readyState == 4 && request.status == 200) {
        console.log(request.responseText);
     }
  }
request.open('GET', 'http://mywebsite.com.php?v=<?php echo $idvisite;?>', true);
request.send();
}
}, 10000);

</script> 
```

# ruby-on-rails - 将 Ruby 更新到 1.9.3，现有应用程序上的 Gems 现在会导致错误

> ID：15042732
> 
> 赞同：0
> 
> 时间：2013-02-23T16:27:44.663
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, gem

我用 Ruby 1.8 编写了一个 Rails 应用程序，各种 gem 都可以正常工作。通过 RVM，我现在正在运行 1.9.3（是的，我确实需要 1.9.x），但是开发服务器不会启动，而是抛出以下错误：

```
$ rails s
/usr/lib/ruby/vendor_ruby/1.8/rubygems/dependency.rb:247:in `to_specs': Could not find railties (>= 0) amongst [bigdecimal-1.1.0, bundler-1.2.4, io-console-0.3, json-1.5.5, minitest-2.5.1, rake-10.0.3, rake-0.9.2.2, rdoc-3.9.5, rubygems-bundler-1.1.0, rvm-1.11.3.6] (Gem::LoadError)
from /usr/lib/ruby/vendor_ruby/1.8/rubygems/dependency.rb:256:in `to_spec'
from /usr/lib/ruby/vendor_ruby/1.8/rubygems.rb:1208:in `gem'
from /usr/local/bin/rails:18 
```

所以，我想该应用程序至少仍在寻找 1.8 gems。我需要做什么？

```
$ ruby -v && gem -v
ruby 1.9.3p392 (2013-02-22 revision 39386) [x86_64-linux]
1.8.25 
```

**更新**

跑步

```
gem install railties 
```

似乎可以工作，但是 railties 仍然没有出现在 gem 列表中，并且服务器仍然无法启动。为了它，我又试了一次，这一次 gem（及其依赖项）似乎确实已经安装了。

但是，我仍然需要运行 bundle install，它（在我的 Gemfile 中指定正确的 Ruby 版本之后）给了我以下..

```
$ sudo bundle install
Your Ruby version is 1.8.7, but your Gemfile specified 1.9.3
$ ruby -v
ruby 1.9.3p392 (2013-02-22 revision 39386) [x86_64-linux] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:13:33.390

这是由与 Ruby 1.8 的冲突引起的。删除它（通过普通的旧 apt-get）解决了这个问题。

# c++ - 结构数组的指针范围和构造函数创建

> ID：15042736
> 
> 赞同：0
> 
> 时间：2013-02-23T16:28:13.330
> 
> 标签：c++, arrays, constructor, struct, function-pointers

下面详细介绍的问题集：为什么我会收到这样的错误消息`studentList`并且`indexPtr`没有在此范围内声明？

我编写了一个程序，它应该创建一个结构数组并允许用户添加、删除和打印该数组中的项目。该程序运行良好，但我无法让添加、删除和打印功能自行正常工作。如果我的 main 函数中包含所有代码，一切都会完美运行。

现在我正在尝试重新编写我的程序并通过将所有信息发送到适当的函数来使其工作，但我不明白从我的主函数来回发送信息的正确方法。

这是我所有声明的头文件：

```
#include <iostream>
#include <string>
#define MAXSIZE 20;
using namespace std;

class Student
{
private:    
    struct studentEntry
    {
        string FIRST;
        string LAST;
        string ID;
        string CLASSIFICATION;
        string MAJOR;
    };
    int index;

public:
    void add(string &firstname, string &lastname, string &id, string &classification, string &major);
    void remove(string &id);
    void print(string &argument);
    int commandCompare(string &command);
    bool idCheck(string &id);
    Student();
}; 
```

然后这是我的文件中的一些代码，其中包含我的所有函数，即第一件事，它是我的学生班级的构造函数。我试图做的是创建一个学生结构数组和一个指向索引的指针，这样我就可以在所有函数中使用相同的数组：

```
#include "students.h"

//constructor for Student class to create students array and pointer to index
Student::Student(){
    int *indexPtr = &index;
    studentEntry *studentList = new student[MAXSIZE];
}

//function to add entry to array of students
void Student::add(string &firstname, string &lastname, string &id, string &classification, string &major)
{
    string m_first = firstname; 
    string m_last = lastname;
    string m_id = id;
    string m_classification = classification;
    string m_major = major;
    int error = 0;

    //check if id is all digits, print error
    if (studentList[indexPtr]->idCheck(id) == false)
    {
        cout << "Error! ID can only contain digits." << endl;
        error = 1;
    }

    //search match for existing ids
    for(int i=0; i<indexPtr; i++)
    {
        //match found, print error, mark error true
        if(id.compare(studentList[i]->student->ID) == 0)
        {
            cout << "Error! ID already exists." << endl;
            error = 1;
        }   
    }

    else if(error != 1)
    {
        studentList[indexPtr]->FIRST = m_first;
        studentList[indexPtr]->LAST = m_last;
        studentList[indexPtr]->ID = m_id;
        studentList[indexPtr]->CLASSIFICATION = m_classification;
        studentList[indexPtr]->MAJOR = m_major;
        indexPtr = indexPtr++;
    }
} 
```

我认为一旦我得到关于指针和数组初始创建的信息，我的程序中的所有内容都将正常工作。非常感谢您的帮助！

编辑：这是我的主要功能的片段，只是为了展示我如何调用 Student 构造函数并尝试调用 Student 类中的函数：

```
int main()
{
    Student students;
    string command;
    int quit = 0;

    //loop while user command != quit
    do
    {       
        cout << "students> ";
        cin >> command;

        //if user command = add
        if(students.commandCompare(command) == 1)
        {   
            string first, last, id, classification, major;
            cin >> first >> last >> id >> classification >> major;
            students.add(first, last, id, classification, major);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:36:42.407

在您的构造函数中：

```
Student::Student(){
    int *indexPtr = &index;
    studentEntry *studentList = new student[MAXSIZE];
} 
```

这两行没有用：

```
 int *indexPtr = &index;
    studentEntry *studentList = new studentEntry[MAXSIZE]; 
```

他们创建局部变量并为它们分配一些东西，但是这些局部变量超出了范围。你也在做`new student`而不是`new studentEntry`.

我认为您打算将 studentList 和 indexPtr 放在您的班级中。

```
 int index;
    studentEntry *studentList;  // add this line
    int *indexPtr;              // add this line

public:
    void add(string &firstname, string &lastname, string &id, string &classification, string &major); 
```

并像这样更改您的构造函数：

```
Student::Student(){
    indexPtr = &index;
    studentList = new studentEntry[MAXSIZE];
} 
```

更好——使用构造函数初始化语法：

```
Student::Student()
  : indexPtr(&index),
    studentList(new studentEntry[MAXSIZE])
{
} 
```

并确保定义一个析构函数来释放内存：

```
~Student()
{
    delete [] studentList;
} 
```

甚至更好——如果你使用std::vector，你可以完全避免手动分配内存。

另一个问题。在这条线上：

```
#define MAXSIZE 20; 
```

你有一个额外的分号。它应该只是

```
#define MAXSIZE 20 
```

如果那里有分号，那么无论使用 MAXSIZE 的地方，分号都会放在代码中，所以这一行：

```
 studentList = new studentEntry[MAXSIZE]; 
```

会成为

```
 studentList = new studentEntry[20;]; 
```

这是一个语法错误。

另一个问题——像这样的行：

```
 studentList[indexPtr]->FIRST = m_first; 
```

应该是这样的：

```
 studentList[*indexPtr].FIRST = m_first; 
```

`studentList`是一个指针，但`studentList[x]`不是。另外，`indexPtr`是一个指针，所以你必须先间接它才能得到它指向的东西。

# linux - 通过脚本验证 sudoing 密码

> ID：15042740
> 
> 赞同：2
> 
> 时间：2013-02-23T16:28:42.150
> 
> 标签：linux, bash, shell, command-line, sudo

我正在编写一个 BASH 脚本，它以交互方式向用户询问 sudoing 密码。这应该在脚本运行时只发生一次。在继续之前，脚本需要确保密码有效。

验证该密码的最简单方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:34:57.170

## 使用`-v`验证标志

您可以使用 sudo 使用`-v`标志验证凭据，然后检查 sudo 的退出状态。例如：

```
if sudo -v; then
    echo "Exit status: $?"
    echo "You're validated."
else
    echo "Exit status: $?"
    echo "You've failed to validate."
fi 
```

# javascript - AJAX 调用导致状态 0

> ID：15042747
> 
> 赞同：0
> 
> 时间：2013-02-23T16:28:59.957
> 
> 标签：javascript, ajax, http, jquery

```
$.ajax({
    url:"myurl",
    async:true,
    success:function (data) {
         //....
    },
    complete:function (x, st) {
         //....
    },
    error:function (x, st, e) {
         alert(JSON.stringify(x));
    }
}); 
```

这是ajax调用。如果我尝试在浏览器中访问“myurl”，它工作正常。但是 Ajax 调用总是会导致错误。如果我对 xhr 进行字符串化，它看起来像这样：

```
{
  "readyState": 0,
  "responseText": "",
  "status": 0,
  "statusText": "error"
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:08:19.790

问题可能出在这些 URL 重定向的地方——只有 1 个留在域内：

```
http://www.barnesandnoble.com/s?keyword=9780735619678&store=ebook #->
http://www.barnesandnoble.com/...

http://www.barnesandnoble.com/s?keyword=9780201485677&store=ebook #->
http://search.barnesandnoble.com/... 
```

您需要包含`search.barnesandnoble.com`在您的权限中：

```
"permissions": [
    "http://www.barnesandnoble.com/",
    "http://search.barnesandnoble.com/"
] 
```

# android - 保存按钮的状态

> ID：15042752
> 
> 赞同：1
> 
> 时间：2013-02-23T16:29:19.233
> 
> 标签：android

任何人都知道如何保存按钮的状态？我想启用一个按钮，该按钮将根据特定条件永久启用，即使用户退出应用程序，它也应该保持启用状态。我已经启用了按钮。现在如何保存它以使其始终启用？

我正在设置它启用这种方式。我在另一个类上使用 putExtra 来设置按钮启用。

```
Button page2 = (Button) findViewById(R.id.button2);

    Intent intent2=getIntent();

    String isEnabled2 = intent2.getStringExtra("isEnabled2");
    if(isEnabled2==null||isEnabled2.equals("disabled")){
            page2.setEnabled(false);
    }
    else{
            page2.setEnabled(true);
    }

    page2.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {

            Intent myIntent = new Intent(view.getContext(), p3.class);
            startActivityForResult(myIntent, 0);

        }
    }); 
```

**编辑**

```
Button page2 = (Button) findViewById(R.id.button2);

    Intent intent2=getIntent();
    String isEnabled2 = intent2.getStringExtra("isEnabled2");
    if(isEnabled2==null||isEnabled2.equals("disabled")){
            page2.setEnabled(false);
    }
    else

    {

            page2.setEnabled(true);
            SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(Enable.this);
            SharedPreferences.Editor editor = preferences.edit();
            editor.putBoolean("Name",true);    //name is the key so may use a username or whatever you want 
            editor.commit();  
    }
    SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(this);
    boolean btnEnabled = preferences.getBoolean("Name",false); //false because you probably want that as your default value
    if(btnEnabled)
    {
         page2.setEnabled(true);
    }

    page2.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {

            Intent myIntent = new Intent(view.getContext(), p3.class);
            startActivityForResult(myIntent, 0);

        }
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:34:04.663

您可以将状态保存在[Shared Preferences](http://developer.android.com/reference/android/content/SharedPreferences.html)中，然后在用户打开应用程序时检查该值。如果您有很多其他需要为用户存储的数据，另一种选择是将其存储在[SQLite DB中](http://developer.android.com/guide/topics/data/data-storage.html#db)

有很多关于使用 Shared Prefs 的例子，所以不要在这里写另一个例子，而是一个很好的例子

[共享首选项示例](https://stackoverflow.com/questions/3624280/how-to-use-sharedpreferences-in-android-to-store-fetch-and-edit-values/3624358#3624358)

**例子**

```
if(isEnabled2==null||isEnabled2.equals("disabled")){
        page2.setEnabled(false);
}
else{
        page2.setEnabled(true);
        //create an editor and put your value in there
        SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(YourActivity.this);
        SharedPreferences.Editor editor = preferences.edit();
        editor.putBoolean("Name",true);    //name is the key so may use a username or whatever you want 
        editor.commit();
     } 
```

然后当你想检索这个值时

```
SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(this);
boolean btnEnabled = preferences.getBoolean("Name",false); //false because you probably want that as your default value
if(btnEnabled)
{
     page2.setEnabled(true);
} 
```

像这样的东西应该工作。我还没有检查它，但它应该让你去

**编辑**

要让它开始，在 xml 中：

```
android:clickable="false" 
```

`onCreate()`或在检查共享首选项之前以编程方式设置它

```
page2.setEnabled(false); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-16T16:25:03.593

保存视图和其他类型状态的更好方法是通过 onSavedInstanceState(Bundle state) 方法并通过 onRestoreInstanceState(Bundle state) 方法恢复它。这两者都需要被覆盖。

第一种方法是使用捆绑状态保存状态：

```
state.putString("A KEY ID", "KEY Value"); 
```

这是一个关于如何保存字符串的示例。您可以保存许多不同的类型，例如布尔值、捆绑包、可序列化的等。只需使用“state.put”查看可用的内容，它应该会根据您的 IDE 显示您可以使用的方法列表。

然后您可以从第二种方法恢复状态，onRestoreInstanceState 对您保存的信息执行您需要执行的操作，例如在视图上设置文本或显示用户保存的名称。

如果您有任何问题，请告诉我

# c++ - 在单独的文件中编译程序集时出现编译错误

> ID：15042754
> 
> 赞同：0
> 
> 时间：2013-02-23T16:29:24.647
> 
> 标签：c++, assembly

这是我的（非常简单的）程序。当函数在我自己的 .cpp 文件中时，它可以完美运行，`function`但是当我将它链接到另一个`.asm`文件时，我会得到错误。我正在使用 Visual C++ 2010 Express 进行编译，我相信这是我正在使用的 32 位程序集。

```
#include <iostream>

extern "C" int function();

int main() {

    std::cout << function();

    std::cin.get();
} 
```

`function`定义为：

```
.code

function proc
    mov eax, 50

    ret
function endp

end 
```

我得到了错误：

```
error A2013: .MODEL must precede this directive
error A2034: must be in segment block : function
error A2034: must be in segment block
error A2034: must be in segment block
fatal error A1010: unmatched block nesting : function 
```

这是我第一次使用 Assembly，所以我不熟悉这些错误。它们是什么意思，我如何让这个程序发挥作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:36:44.320

您应该有一个 .model 和一个 cpu 声明，通常还有一个堆栈声明。看看这里： [http ://www.talreg.com/?cat=58](http://www.talreg.com/?cat=58)

# php - 灵活的正则表达式来取出部分 DOM

> ID：15042755
> 
> 赞同：-2
> 
> 时间：2013-02-23T16:29:24.947
> 
> 标签：php, regex, pcre

首先，我知道 Simple HTML Dom 解析器和 PHP 的内置解决方案，它们都没有做我要求的那种工作（据我所知）。

我正在寻找 PHP 的 PCRE，它将在 DOM 中找到元素和所属内容，删除它并原谅标记是否包含任何额外的空格。

这是代码：

```
<div id="maindiv">
    <div class="unusefuldiv1">Unuseful content</div>
    <div id="unusefuldiv2">Unuseful content2</div>
    <!--  ... some content I'm after for -->
</div> 
```

我对正则表达式模式感到绝望，它将删除 .uunusefuldiv1 和 #unusefuldiv2 （标记与内容一起）并且（如果可能）足够灵活地完成这项工作，例如，如果`<div class="unusefuldiv1">`由于额外的空白空间略有错误：`<div class="unusefuldiv1" >`.

这可能*类似于*

`preg_replace('/<div\b[^>]*>(.*?)<\/div>/is', '', $dom_content);`

除了此模式将删除所有 div，无论它们是否具有某些类、id 或没有。

有没有人有解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:47:47.567

这里没有理由不使用专用的 DOM 解析器：

```
$dom = new DOMDocument();
$dom->loadHTML($data);

$xpath = new DOMXPath($dom);

$id = 'unusefuldiv2';
$classname = 'unusefuldiv1';
$query = "//div[@id='$id']|//*[contains(concat(' ', normalize-space(@class), ' '), ' $classname ')]";
foreach ($xpath->query($query) as $node) {    
    $node->parentNode->removeChild($node);
}

echo $dom->saveHTML(); 
```

演示：[http ://eval.in/11108](http://eval.in/11108)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T17:02:49.040

```
$dom_content = preg_replace( 
    '/\s*<div [^<>]*unuseful[^<>]+>.*?<\/div\s*>\s*/is', '', $dom_content ); 
```

将删除开始标签包含单词 unuseful 的 div（和周围的空格）。

要获得更好的正则表达式解决方案，您需要更好地描述删除 div 的标准。

# ant - 覆盖 Ant 目标中的属性

> ID：15042761
> 
> 赞同：6
> 
> 时间：2013-02-23T16:30:01.603
> 
> 标签：ant

我们在从 Eclipse 运行的 Ant 脚本中使用了很多属性。我想建立一个并行部署，它使用稍微不同的属性值构建项目，并部署到不同的位置......部署位置也是一个属性。

[如何] 我的新目标可以将某些属性更新为自定义测试值，然后运行普通目标以获得所需的结果？

简单的示例脚本非常受欢迎，我只知道足够的 Ant 来获得:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-05-08T07:37:39.287

您可以使用 antcall ( [https://ant.apache.org/manual/Tasks/antcall.html](https://ant.apache.org/manual/Tasks/antcall.html) ) 在被调用目标中使用参数覆盖属性，例如，考虑这个文件 example-antcall-properties.ant

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="AntCall Properties and Params" default="first">
    <property name="my.property" value="initial" />

    <target name="first">
      <echo message="main: my.property=${my.property}"/>
      <antcall target="second" />
      <antcall target="second">
        <param name="my.property" value="changed"/>
      </antcall>
      <antcall target="second" />
    </target>

    <target name="second">
      <echo message="second: my.property=${my.property}"/>
      <antcall target="third" />
    </target>

    <target name="third">
      <echo message="third: my.property=${my.property}"/>
    </target>
</project> 
```

看看结果

```
ant -f example-antcall-properties.ant
Buildfile: example-antcall-properties.ant

first:
     [echo] main: my.property=initial

second:
     [echo] second: my.property=initial

third:
     [echo] third: my.property=initial

second:
     [echo] second: my.property=changed

third:
     [echo] third: my.property=changed

second:
     [echo] second: my.property=initial

third:
     [echo] third: my.property=initial

BUILD SUCCESSFUL
Total time: 0 seconds 
```

请注意，属性的值在使用“param”的第二次目标“second”调用中发生了变化（并且更改传播到被调用目标内部调用的目标，在本例中为“third”），但在其他调用中没有（没有“参数”）。

但是，正如文档[https://ant.apache.org/manual/Tasks/antcall.html](https://ant.apache.org/manual/Tasks/antcall.html)中所报告的，

> 命令行上定义的属性不能被嵌套`<param>`元素覆盖。

通过此调用可以看出这一点：

```
ant -f example-antcall-properties.ant -Dmy.property="from command line"
Buildfile: example-antcall-properties.ant

first:
     [echo] main: my.property=from command line

second:
     [echo] second: my.property=from command line

third:
     [echo] third: my.property=from command line

second:
     [echo] second: my.property=from command line

third:
     [echo] third: my.property=from command line

second:
     [echo] second: my.property=from command line

third:
     [echo] third: my.property=from command line

BUILD SUCCESSFUL
Total time: 0 seconds 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-25T20:53:57.573

```
<?xml version="1.0" encoding="UTF-8" ?>
<project default="all" basedir="."> 
    <taskdef resource="net/sf/antcontrib/antcontrib.properties" />
    <target name="all">
        <property name="prop" value="1" />
        <echo message="prop = ${prop}" />
        <var name="prop" unset="true"/>
        <property name="prop" value="2" />
        <echo message="prop = ${prop}" />
    </target>
</project> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-03-22T12:01:11.067

覆盖属性可以通过将逻辑拆分为单独的文件来完成，这些文件可以作为基础包含，然后被覆盖。

例如，创建一个基本文件，`base.xml`其中包含所有默认属性和目标：

```
<?xml version="1.0" encoding="UTF-8"?>
<project>
  <!-- Sets the default properties. Override in your main build file when needed. -->
  <property name="admin.user" value="admin"/>
  <property name="admin.pass" value="admin"/>
  <target name="job1"/>
  <target name="job2"/>
</project> 
```

然后在主文件（例如`build.xml`）中，覆盖属性，然后[`import`](https://ant.apache.org/manual/Tasks/import.html)是基本文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="MyProject">
  <!-- Override properties -->
  <property name="admin.user" value="root"/>
  <property name="admin.pass" value="new_pass"/>

  <!-- Import default properties -->
  <import file="${basedir}/base.xml"/>
  <!--<import><url url="https://example.com/base.xml"/></import>-->

  <target name="job1">
  <!-- Overriden job1 -->
  </target>
  <target name="job2">
  <!-- Overriden job2 -->
  </target>
</project> 
```

GitHub 上的示例：[`National-Theatre/base-build-xml`](https://github.com/National-Theatre/base-build-xml).

对于并行执行，您可以使用[`parallel`task](https://ant.apache.org/manual/Tasks/parallel.html)。

# java - 在 Java 代码中定位文件

> ID：15042762
> 
> 赞同：0
> 
> 时间：2013-02-23T16:30:06.567
> 
> 标签：java, eclipse, file, embedded-resource

我正在尝试制作一个播放声音的简单应用程序。我的 java 项目中有一个名为 sound.wav 的声音文件（使用 eclipse btw）。我不确定如何导航到声音文件。问题是我不知道如何通过代码导航到声音文件。我现在运行的会引发空指针异常，即。该文件不存在。到目前为止，这是我的代码：

```
 private static Sound sound;

public static void main(String[] args) {
    JFrame j = new JFrame("Sound");
    j.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    j.setSize(300, 150);
    sound = new Sound("/Users/Chris/Desktop/Workspace/Sound/sound.wav");
            //this is the problem line
    JButton play = new JButton("Play");
    play.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            sound.play();               
        }

    });

    j.add(play,BorderLayout.SOUTH);
    j.setVisible(true);
} 
```

这是我的声音类的代码：

```
 private AudioClip clip;

public Sound(String fileName) {
    try {
        clip = Applet.newAudioClip(Sound.class.getResource(fileName));
    }
    catch (Exception e) {
        e.printStackTrace();
    }
}

public void play() {
    try {
        new Thread(){
            public void run() {
                clip.play();
            }
        }.start();
    }
    catch (Exception e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T16:33:31.023

`Class.getResource()`，正如它的 javadoc 所指出的，从类路径中读取资源。不是来自文件系统。

要么你想从一个文件中读取，并且应该使用文件 IO（即 a `FileInputStream`），或者你想从类路径中读取，你应该使用`Class.getResource()`并传递一个资源路径，从类路径的根开始。例如，如果 sound.wav 在运行时类路径中，则在 package`com.foo.bar.sounds`中，代码应该是

```
Sound.class.getResource("/com/foo/bar/sounds/sound.wav") 
```

# javascript - parseFloat('4.2.2') 产生 4.2 而不是 NaN？

> ID：15042764
> 
> 赞同：3
> 
> 时间：2013-02-23T16:30:16.010
> 
> 标签：javascript, parsing

我在尝试破坏我的代码时发现了这种意外行为......有人可以向我解释为什么会这样以及应该如何确保提供的值是真正的浮点数？

例如：

```
alert(parseFloat('4.2.2')); 
```

我期待`NaN`......不是我得到的。

[我在这里](http://jsfiddle.net/xmkJq/)做了一个非常简单的 jsfiddle 演示。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T16:32:49.223

这就是`parseFloat`and`parseInt`方法的工作原理。他们解析到输入变得无效的点。它们`NaN`仅在第一个字符无效时返回..

* * *

引用[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseFloat](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseFloat)

> `parseFloat`解析它的参数，一个字符串，并返回一个浮点数。如果遇到符号（+ 或 -）、数字 (0-9)、小数点或指数以外的字符，则返回该点之前的值并忽略该字符和所有后续字符。允许前导和尾随空格。
> 
> 如果第一个字符无法转换为数字，则`parseFloat`返回`NaN`。

* * *

要检查字符串是否是可以使用的数字（*来自[Validate decimal numbers in JavaScript - IsNumeric()](https://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric)*）

```
function isNumber(n) {
  return !isNaN(parseFloat(n)) && isFinite(n);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T16:32:10.160

将浮点数解析回字符串并比较它们是否相等

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T16:32:55.593

**parseFloat**从左到右解析其字符串参数，直到遇到错误条件，此时它停止解析。

根据[Mozilla](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseFloat)

> parseFloat 解析它的参数，一个字符串，并返回一个浮点数。如果遇到符号（+ 或 -）、数字 (0-9)、小数点或指数以外的字符，则返回该点之前的值并忽略该字符和所有后续字符。如果第一个字符不能转换为数字，则 parseFloat 返回 NaN。

所以它开始从左到右解析一个浮点数，直到它不能再解析它。在您的情况下，一切正常，直到遇到小数点后第二位。此时，它不再是有效的浮点数，因此它停止解析。

在另一个示例中，如果您调用 parseFloat('100ASDF')，它将返回 100，而不是 NaN。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-23T16:33:40.627

[当您阅读它的文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseFloat)时，它似乎足够基本：

> parseFloat 解析它的参数，一个字符串，并返回一个浮点数。**如果遇到符号（+ 或 -）、数字 (0-9)、小数点或指数以外的字符，则返回该点之前的值并忽略该字符和所有后续字符**。允许前导和尾随空格。

# javascript - angular.js 中的自定义 $routeParam 分隔符

> ID：15042768
> 
> 赞同：0
> 
> 时间：2013-02-23T16:30:31.790
> 
> 标签：javascript, url, angularjs

我想要所有参数都`[http://example.com/#/news/](http://example.com/#/news/){abc}_{def}_{ghi}`在哪里的网址。`{abc}, {def}, {ghi}`请注意，参数由下划线分隔。我怎样才能做到这一点？我试过了`/news/:param1_:param2_:param3`，`/news/:param1\_:param2\_:param3`但没有一个有效。帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:20:13.823

您是否尝试过简单地调用它：params，然后在路由解析或控制器中执行 params.split('_')？

# javascript - 如何使用麦克风检测声音吹/尖叫（用于概念证明）？

> ID：15042769
> 
> 赞同：2
> 
> 时间：2013-02-23T16:30:37.413
> 
> 标签：javascript, html

我目前正在为黑客马拉松编写一个快速的 HTML5 原型。

用户必须对他的笔记本电脑麦克风吹气（或对着它尖叫！），直到它达到某个（任意）级别。

到目前为止，我没有找到任何可以帮助我在紧迫的日程安排中的东西......

由于事件类型（黑客马拉松），我想实现一些可以工作的东西，它不必是稳定或安全的......嗯，它是一个原型:-)

我们使用 HTML5，当然还有 JavaScript。项目中已经使用了 jQuery，演示将使用最新版本的 Chromium 进行展示。

我希望我足够清楚，如果需要，请随时向我询问更多信息。

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:46:56.583

您可以使用不稳定的 Web Audio API 和`getUserMedia`.

在 html5rocks 上有一篇关于该功能的短文：http: [//updates.html5rocks.com/2012/09/Live-Web-Audio-Input-Enabled](http://updates.html5rocks.com/2012/09/Live-Web-Audio-Input-Enabled)

# ios - Apple iTunes 应用程序的限制

> ID：15042770
> 
> 赞同：2
> 
> 时间：2013-02-23T16:30:39.957
> 
> 标签：ios, ios6

我有一个 iPhone 应用程序的想法，它允许用户在特定呼叫时拨打电话，即使它处于静音模式。但问题是我不知道苹果会不会允许它。苹果可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:32:04.587

是的，为什么不？我已经使用过这样的应用程序。它绝对合法

# css - 响应式背景图像

> ID：15042776
> 
> 赞同：0
> 
> 时间：2013-02-23T16:31:07.330
> 
> 标签：css, responsive-design

使背景图像响应的最佳方法是什么？我希望 .container 类扩大 16% 的窗口大小。我还希望文本覆盖并垂直/水平居中。

示例： [http ://codepen.io/zerostyle/pen/avHqG](http://codepen.io/zerostyle/pen/avHqG)

```
<div class="container">
    <div class="cat"><p>CATS ARE AWESOME!</p></div>
</div>

.cat {
  background: url("http://placekitten.com/300/300") no-repeat; 
  position: absolute; 
  width: 300px; 
  height: 300px;  
  display: table; 
}

.cat p {
  display: table-cell; 
  vertical-align: middle; 
  text-align: center; 
  color:#FFF;
  font-size:24px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:34:15.300

试试这个[http://jsfiddle.net/TM3WF/1/](http://jsfiddle.net/TM3WF/1/)

```
.cat {
    background: url("http://placekitten.com/300/300") no-repeat; 
  position: absolute; 
  width:100%; 
  height: 100%;  
  display: table; 
  background-size:cover;
}

.cat p {
  display: table-cell; 
  vertical-align: middle; 
  text-align: center; 

  color:black;
  font-size:24px;    
} 
```

# jquery - 如何拥有一个在加载和点击时都运行的 jquery 函数

> ID：15042777
> 
> 赞同：1
> 
> 时间：2013-02-23T16:31:11.243
> 
> 标签：jquery, attributes, onclick, title, onload

我如何运行***在加载***和***单击***时都运行的*jquery 函数*

 **```
$("#prevd,#nextd").live("click",function() {
alert('test');
$('#m0d1y2013').attr('title', 'New Year!');
$('#m0d21y2013').attr('title', 'Marthin Luthor King Day');
$('#m1d25y2013').attr('title', 'Presidents Day');
}); 
```

如何在**不单击**或设置***加载单击的情况下运行此 jquery 的内容***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:33:34.250

```
function mySuperThings(){

   alert('test');
   $('#m0d1y2013').attr('title', 'New Year!');
   $('#m0d21y2013').attr('title', 'Marthin Luthor King Day');
   $('#m1d25y2013').attr('title', 'Presidents Day');

}

$(function(){              // DOM IS READY TO BE MANIPULATED

    mySuperThings();       // RUN FUNCTION

    $(document).on("click", "#prevd, #nextd", function() {
        mySuperThings();   // RUN ON CLICK
    });

}); 
```

PS：考虑到您使用 jQuery *v.* >= 1.7 [http://api.jquery.com/on/](http://api.jquery.com/on/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:41:14.873

您也可以尝试使用`.click()`.

```
$("#prevd,#nextd").live("click",function() {
  alert('test');
  ...
}).click(); 
```

此外，从 jQuery 1.7 开始，您应该使用[`.on()`](http://api.jquery.com/on/)将事件处理程序绑定到动态生成的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T16:53:51.543

你可以试试这个：

```
 $(function(){
    $("#prevd,#nextd").live("click",function() {
      alert('test');
      $('#m0d1y2013').attr('title', 'New Year!');
      $('#m0d21y2013').attr('title', 'Marthin Luthor King Day');
      $('#m1d25y2013').attr('title', 'Presidents Day');
    });
    $(this).find("#prevd,#nextd").click();
  }); 
```**

# c - C 程序存储路由表

> ID：15042778
> 
> 赞同：-2
> 
> 时间：2013-02-23T16:31:15.680
> 
> 标签：c, linux, routing

我需要知道如何编写一个获取目标 IP 地址的程序，将它们与表中的条目进行比较，并从路由表中识别正确的下一跳地址（将结果存储在物理文件中，例如 txt）。

任何指针？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T03:37:00.733

The routing table is maintained inside the kernel, as part of the TCP/IP stack. A userland C program just has no access to it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:42:20.297

为路由表条目创建链接列表并使用结构

```
struct routeTable
{
    struct routeTable *next_Entry;
    int ipAddress;
    int interface;
}; 
```

有点像这样，您需要创建结构并创建链接列表。

# apache - 卸载 xampp

> ID：15042779
> 
> 赞同：0
> 
> 时间：2013-02-23T16:31:21.383
> 
> 标签：apache, xampp

我想完全重新安装xampp。执行uninstall.exe后，我留下了php，apache，mysql之类的文件夹，无法删除。Apache 服务似乎已被禁用。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:39:21.870

重新启动机器并尝试再次删除文件夹。

# ruby-on-rails-3 - Rails - rake 测试失败

> ID：15042780
> 
> 赞同：0
> 
> 时间：2013-02-23T16:31:25.177
> 
> 标签：ruby-on-rails-3, db2, rake, jruby

使用以下语句：

```
rails generate scaffold Product title:string description:text image_url:string price:decimal 
```

并稍微编辑生成的迁移我有以下迁移：

```
class CreateProducts < ActiveRecord::Migration
  def change
    create_table :products do |t|
      t.string :title
      t.text :description
      t.string :image_url
      t.decimal :price, precision: 8, scale: 2

      t.timestamps
    end
  end
end 
```

之后，我成功运行了以下命令：

```
rake db:migrate 
```

并连接到我的数据库并检查是否确实创建了表。然后，我跑

```
rake test 
```

并得到了很多错误，我相信问题的根源是rails无法找到“产品”表：

```
 1) Error:
test_should_create_product(ProductsControllerTest):
ActiveRecord::JDBCError: Table products does not exist
    arjdbc/jdbc/RubyJdbcConnection.java:115:in `columns'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activerecord-jdbc-adapter-1.2.7/lib/arjdbc/db2/adapter.rb:514:in `columns'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activerecord-3.2.12/lib/active_record/fixtures.rb:660:in `column_names'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activerecord-3.2.12/lib/active_record/fixtures.rb:651:in `timestamp_column_names'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activerecord-3.2.12/lib/active_record/fixtures.rb:585:in `table_rows'
    org/jruby/RubyHash.java:1257:in `each'
    org/jruby/RubyEnumerable.java:718:in `map'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activerecord-3.2.12/lib/active_record/fixtures.rb:579:in `table_rows'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activerecord-3.2.12/lib/active_record/fixtures.rb:494:in `create_fixtures'
    org/jruby/RubyArray.java:1613:in `each'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activerecord-3.2.12/lib/active_record/fixtures.rb:492:in `create_fixtures'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activerecord-3.2.12/lib/active_record/fixtures.rb:491:in `create_fixtures'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract_adapter.rb:168:in `disable_referential_integrity'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activerecord-3.2.12/lib/active_record/fixtures.rb:476:in `create_fixtures'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activerecord-3.2.12/lib/active_record/fixtures.rb:895:in `load_fixtures'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activerecord-3.2.12/lib/active_record/fixtures.rb:849:in `setup_fixtures'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activesupport-3.2.12/lib/active_support/callbacks.rb:432:in `_run__858744690__setup__1004892786__callbacks'
    org/jruby/RubyBasicObject.java:1659:in `__send__'
    org/jruby/RubyKernel.java:2086:in `send'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activesupport-3.2.12/lib/active_support/callbacks.rb:405:in `__run_callback'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activesupport-3.2.12/lib/active_support/callbacks.rb:390:in `_run_setup_callbacks'
    org/jruby/RubyBasicObject.java:1659:in `__send__'
    org/jruby/RubyKernel.java:2086:in `send'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activesupport-3.2.12/lib/active_support/callbacks.rb:81:in `run_callbacks'
    /home/gotqn/.rvm/gems/jruby-1.7.2/gems/activesupport-3.2.12/lib/active_support/testing/setup_and_teardown.rb:35:in `run' 
```

据我了解，在进行测试时，我的“测试”数据库被删除，“开发”数据库的迁移适用于它。因为，我使用的是“IBM DB2 Express 10.1”数据库，我想我需要对负责测试的文件进行一些更改。

你能帮我解决这个问题吗？

下面，我展示了有关整个情况的更多信息：

1.  使用“IBM DB2 Express”版本 10.1
2.  使用 jRuby 1.7.2
3.  使用 Rails 版本 3.2.12
4.  使用 Ubuntu 10.04 LTC
5.  这就是我的“database.yml”文件的样子：

> ```
> development:
>     adapter: jdbc
>     driver: com.ibm.db2.jcc.DB2Driver
>     url: jdbc:db2://localhost:50000/ddevelop
>     host: localhost
>     port: 50000
>     database: ddevelop
>     username: db2inst1
>     password: pass
> 
> test:
>     adapter: jdbc
>     driver: com.ibm.db2.jcc.DB2Driver
>     url: jdbc:db2://localhost:50000/dtest
>     host: localhost
>     port: 50000
>     database: dtest
>     username: db2inst1
>     password: pass 
> ```

注意：“dtest”数据库已经创建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:41:35.650

测试数据库尚未更新。您需要`rake db:test:prepare`在`rake db:migration`. 您现在可以运行它并重试。

# css - 页面缩放时图像位置偏移

> ID：15042781
> 
> 赞同：0
> 
> 时间：2013-02-23T16:31:28.450
> 
> 标签：css, image, html, zooming

这是实际的项目（测试页），因为我无法重新创建问题：

[http://benphilippi.com/ben-home-final.php](http://benphilippi.com/ben-home-final.php)

我有一系列链接图像位于背景图像上，作为“按钮”。

缩放页面时，所有图像都会移动。最差的是 110%，到 125% 时会好一些。

我尝试将 div 包装在容器中，完全删除 div，并将图像设置为 div 背景，但似乎无法解决此问题。

任何建议表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:38:43.010

您的尺寸使用 px 单位指定。尝试使用 ex 单位指定您的尺寸。这会根据文本大小映射所有内容的大小和位置。因此，当用户放大和缩小时，您的页面应该统一缩放。

顺便说一句，我没有注意到在浏览器中缩放页面有任何问题。我在 OS X 上使用 Firefox。

# ruby-on-rails - Rails - 从另一个控制器使用本地 JSON API

> ID：15042783
> 
> 赞同：2
> 
> 时间：2013-02-23T16:31:35.370
> 
> 标签：ruby-on-rails, json, api, controller

我正在构建一个用作 android 应用程序和 rails webapp 后端的应用程序。作为后端，我构建了一系列 api 控制器（例如：带有显示、更新等操作的 api_users 控制器），它们将返回 JSON/XML 输出（使用 RABL）。

在我的 Web 应用程序中，当需要更新用户配置文件时，我只想调用 api_users 控制器的更新操作并解析用户控制器中的 json 输出，解析此输出，然后将数据传递给我的视图等。我该如何拨打这样的电话？

一个非常糟糕的解决方法似乎是将其视为任何外部 API 并使用 Net::Http 等调用它。有人可以帮助/指导我推荐的方法吗？

谢谢，

拉姆库马尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T14:27:39.083

由于我没有找到任何简单的方法来执行此操作，因此我决定将其视为外部 api。只是我没有一直到 dns 并返回，而是决定简单地使用 localhost 来调用它。

# pyqt - 在 PyQt4 主循环中集成 Scrapy/Twisted 事件循环

> ID：15042784
> 
> 赞同：1
> 
> 时间：2013-02-23T16:31:38.253
> 
> 标签：pyqt, twisted, scrapy, event-loop

我正在开发一个 PyQt4 工具，它使用 scrapy 来抓取网站。我启动了一个新进程[multiprocessing] 来从 ui 运行 Scrapy spider。一切正常~ ui 正在阻塞，而 Scrapy 正在抓取。

我想要一个非阻塞的 ui，虽然我想在 PyQt 主循环中集成 Twisted 事件循环。

有谁知道如何尽可能简单地实现这一目标？我是 Scrapy / PyQt / Multiprocessing / Twisted 的新手。

我在一个带有 PyQt4、Python 2.7 和 Scrapy 0.12.0.2546 的 Xubuntu 12.04 机器上。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T16:25:51.550

Twisted reactor 与 qt reactor 轻松集成：http: [//twistedmatrix.com/trac/wiki/QTReactor](http://twistedmatrix.com/trac/wiki/QTReactor)

# c# - 如何自动更改添加到列表中的对象？

> ID：15042786
> 
> 赞同：0
> 
> 时间：2013-02-23T16:31:45.900
> 
> 标签：c#, list

```
class MyClass                { MyClass parent; }    
class Container    : MyClass { List<MyClass> children; }
class NonContainer : MyClass {} 
```

我希望能够为自动添加到其中的每个实例`List<MyClass> children`自动设置`parent`当前值。我真的不想在我添加到代码中的任何地方放置一个单独的方法。`Container``MyClass``MyClass``children`

在我的整个应用程序中，我通过三种方式将项目添加到列表中：

1.  `children.Add()`
2.  `children.AddRange()`
3.  `new List<MyClass>(){ new MyClass(){}, /* ... */, new MyClass(){} }`

也许有更好的方法让所有第一代孩子都知道他们的父对象是谁？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T17:00:17.577

将子列表保持私有，并通过公共方法和属性使子列表可访问

```
class Container : MyClass {
    private readonly List<MyClass> _children = new List<MyClass>();

    public void AddChild(MyClass child)
    {
        child.Parent = this;
        _children.Add(child);
    }

    public void AddChildren(IEnumerable<MyClass> children)
    {
        foreach (MyClass child in children) {
            AddChild(child);
        }
    }

    public IEnumerable<MyClass> Children { get { return _children; } }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:37:19.187

继承`List`这样的：

```
public class ChildrenList : List<MyClass>
{
    public MyClass Parent { get; private set; }

    public ChildrenList(MyClass parent) { this.Parent = parent; }

    public override void Add(MyClass item)
    {
        item.Parent = Parent;
        base.Add(item);
    }
} 
```

然后在容器中使用它：

```
class Container : MyClass { List<MyClass> children = new ChildrenList(parent); } 
```

# java - 在 Java 中使用对话框打印二维数组

> ID：15042790
> 
> 赞同：0
> 
> 时间：2013-02-23T16:32:13.840
> 
> 标签：java, dialog, type-2-dimension

我们得到了一个家庭作业，用java实现生命游戏。

我有一个二维数组，我想在对话框中打印它。

我的数组类型是布尔值。

我所做的是通过以下方式将其转换为一个大字符串

```
public void Build_Matrix_String()
{
    String str1 = "";
    int i, j;

    for (i = 0; i < Rows; i++){
        str1 = str1.concat("    ");
        for (j = 0; j < Columns; j++){                
            if (Matrix[i][j] == true){
                str1 = str1.concat(" + ");
            }
            else {
                str1 = str1.concat(" - ");
            }
        }
        str1 = str1.concat("    \n");
    }
    JOptionPane.showMessageDialog(null, str1);
} 
```

有什么方法可以做得更好，然后先将其转换为字符串？

如果没有，有什么办法让它看起来更好？

非常感谢。

阿萨夫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:42:59.377

像那样？

![在此处输入图像描述](../Images/f846959fc12082e018602d311e68ddac.png)

```
import javax.swing.JLabel;
import javax.swing.JOptionPane;

public class ShowMatrix {
   public static void main( String[] args ) {
      boolean[][]   matrix = new boolean[3][3];
      matrix[ 0 ][ 0 ] = true;
      matrix[ 0 ][ 2 ] = true;
      matrix[ 1 ][ 1 ] = true;
      matrix[ 2 ][ 0 ] = true;
      matrix[ 2 ][ 2 ] = true;

      StringBuilder str1   = new StringBuilder();
      for( int i = 0; i < matrix.length; i++ ) {
         for( int j = 0; j < matrix[ i ].length; j++ ) {
            str1 = str1.append( matrix[i][j] ? " + " : " - " );
         }
         str1 = str1.append( '\n' );
      }
      JOptionPane.showMessageDialog(
         null, new JLabel( "<html><pre>" + str1.toString()));
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T18:54:42.117

我知道这没有被问到，我不应该那样做，但我无法抗拒……为什么要为此使用对话框？到目前为止，我还没有编写任何带有 swing 的程序，但是让事情运行起来似乎要好得多，例如滥用`JTextField`作为彩色框，然后将它们堆叠在矩阵布局中，例如：

```
static int MATRIX_SIZE = 15;
static int CELL_SIZE = 20;

static Color ACTIVE = new Color(255, 128, 128);
static Color INACTIVE = new Color(0, 127, 127);

static JComponent items[][] = new JComponent[MATRIX_SIZE][MATRIX_SIZE];

// here we should use something more appropriate than dummy text fields
private static JComponent createItem() {
    JTextField item = new JTextField("");
    Dimension d = new Dimension(CELL_SIZE, CELL_SIZE);
    item.setPreferredSize(d);
    item.setBackground(INACTIVE);
    item.setEditable(false);
    item.setBorder(new EmptyBorder(0, 0, CELL_SIZE, CELL_SIZE));
    return item;
}

private static void createMatrixView() {
    JFrame frame = new JFrame("Show Pixels");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    JComponent panel = new JPanel();
    GridBagLayout layout = new GridBagLayout();
    panel.setLayout(layout);

    GridBagConstraints c = new GridBagConstraints();
    for (int i = 0; i < MATRIX_SIZE; i++) {
        for (int j = 0; j < MATRIX_SIZE; j++) {
            items[i][j] = createItem();
            c.gridx = i;
            c.gridy = j;
            panel.add(items[i][j], c);
        }
    }

    frame.getContentPane().add(panel);
    frame.pack();
    frame.setVisible(true);
}

private static void update(boolean[][] values) {
    for (int i = 0; i < MATRIX_SIZE; i++) {
        for (int j = 0; j < MATRIX_SIZE; j++) {
            items[i][j].setBackground(values[i][j] ? ACTIVE : INACTIVE);
        }
    }
}

public static void main(String[] args) {
    createMatrixView();

    boolean[][] matrix = new boolean[MATRIX_SIZE][MATRIX_SIZE];
    matrix[0][0] = true;
    matrix[0][2] = true;
    matrix[1][1] = true;
    matrix[2][0] = true;
    matrix[2][2] = true;

    update(matrix);
} 
```

# c++ - 流操作符的模板类型推导

> ID：15042791
> 
> 赞同：5
> 
> 时间：2013-02-23T16:32:16.013
> 
> 标签：c++, templates, iostream, manipulators

我不确定这段代码是否不会编译。

我正在使用的示例代码：

```
#include <iostream>
using std::cout;
using std::endl;

class Foo {
    public:
        template<typename T>
        Foo& operator<<(const T& t) {
            cout << t;
            return *this;
        }
};

int main() {
    Foo foo;
    foo << "Hello World"; // perfectly fine
    foo << endl; // shit hits the fan

    return 0;
} 
```

这是错误：

```
test.cpp:19:12: error: no match for ‘operator<<’ in ‘foo << std::endl’
test.cpp:19:12: note: candidates are:
test.cpp:10:14: note: template<class T> Foo& Foo::operator<<(const T&)
test.cpp:10:14: note:   template argument deduction/substitution failed:
test.cpp:19:12: note:   couldn't deduce template parameter ‘T’ 
```

我很困惑为什么它不能用`endl`( `ostream& (*)(ostream&)`)的函数类型代替`T`，当你指定时它显然可以这样做`cout << endl;`

我发现这解决了问题也令人费解[已编辑]

```
Foo& operator<<(ostream& (*f)(ostream&)) {
    cout << f;
    return *this;
} 
```

如果问题不清楚，我问为什么它不能首先推断出模板。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T16:40:56.097

`endl`是一个操纵器，即它是一个*未解析的函数类型*。有几个重载，类型推导无法决定你想要哪一个。

更具体地说，`endl`如下所示（在 GNU libc++ 中）：

```
/**
 *  @brief  Write a newline and flush the stream.
 *
 *  This manipulator is often mistakenly used when a simple newline is
 *  desired, leading to poor buffering performance.  See
 *  http://gcc.gnu.org/onlinedocs/libstdc++/manual/bk01pt11ch25s02.html
 *  for more on this subject.
*/
template<typename _CharT, typename _Traits>
  inline basic_ostream<_CharT, _Traits>&
  endl(basic_ostream<_CharT, _Traits>& __os)
  { return flush(__os.put(__os.widen('\n'))); } 
```

**更新**所以，问题是，编译器无法*推断出*您将传递哪个*实例（这是一个未解决的重载）。`endl`****您可以通过执行 a 来解决此问题`static_cast<ostream&(*)(ostream&)>(endl)`。***

当然，这样不方便。这是一个简单的修复： http: [//liveworkspace.org/code/2F2VHe$1](http://liveworkspace.org/code/2F2VHe%241)

```
#include <iostream>
using std::cout;
using std::endl;

class Foo : public std::ostream
{
    public:
        template<typename T>
        Foo& operator<<(T&& t) {
            cout << std::forward<T>(t);
            return *this;
        }

        typedef std::ostream& (manip)(std::ostream&);

        Foo& operator<<(manip& m) {
            cout << m;
            return *this;
        }
};

int main() {
    Foo foo;
    foo << "Hello World"; // perfectly fine
    foo << endl; // everything is fine

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T16:54:20.187

问题在于`endl`将操纵器定义为*函数模板*。C++11 标准的第 27.7.1 段指定了它的签名：

```
template <class charT, class traits>
basic_ostream<charT,traits>& endl(basic_ostream<charT,traits>& os);
template <class charT, class traits> 
```

此外，根据第 13.3.1 段关于重载解决方案：

> 在候选函数模板的每种情况下，**候选函数模板特化是使用模板参数推导**（14.8.3、14.8.2）生成的。然后以通常的方式将这些候选函数作为候选函数处理。

Your`operator <<`被定义为模板，编译器需要推导出`T`. 但是，编译器如何知道`endl`您的意思是哪个实例化？它如何推断模板参数`charT`和`traits`？在你的调用中没有其他`operator <<`可以推断出来的东西。

你有两种方法可以解决这个问题。要么`endl`显式地转换类型，以告诉编译器应该选择哪个重载：

```
foo << (std::ostream& (*)(std::ostream&))endl; 
```

或者，正如您所做的那样，您创建一个`operator <<`接受具有该特定签名的函数的重载。您的编译器现在将选择它：

```
Foo& operator<<(ostream& (*f)(ostream&)) 
{
    return *this << f;
} 
```

在这个函数定义中，关于什么是没有歧义`f`的：它的类型是精确定义的。但是，在这里要小心：这个函数不可能达到你的预期！事实上，它只是不断地调用自己，产生**无限递归**！

因此，这个断言：

> [...] 请注意，我实际上是在调用我的其他方法实现：

不**正确**：您没有调用其他方法实现，而是一遍又一遍地调用相同的函数。

# c++ - 循环依赖通常需要很多时间来编译吗？

> ID：15042792
> 
> 赞同：0
> 
> 时间：2013-02-23T16:32:25.937
> 
> 标签：c++, circular-dependency

**编辑：修改了带有保护的头文件。我忘了把这些放在这个例子中。虽然我的项目中已经有了这些。**

我有这两个课。

档案啊：

```
#ifdef A_H
#define A_H
#include "b.h"
#include "x.h" //not related to problem, is just included
class B; //fwd declaration, needed to use getB() outside of A
class A
{
public:
    A(X &x);
    B &getB();
    ...
private:
    X &x;
}
#endif 
```

文件 b:

```
#ifdef B_H
#define B_H
#include "x.h"
class A; //fwd declaration
class B
{
public:
    B(X &x, A &a);
    void methodThatUsesA();
    ...
private:
    X &x;
    A &a;
}
#endif 
```

文件 a.cpp：

```
#include "a.h"
#include "b.h"
A::A(X &x):x(x){}
B& A::getB()
{
    static B b(x, *this);
    return b;
}
... 
```

文件 b.cpp：

```
#include "b.h"
#include "a.h"
B::B(X &x, A &a) : x(x), a(a){}
void B::methodThatRequiresA(){
    //does its thing...
} 
```

在它们之外，我像这样使用它们：

```
#include "x.h"
#include "a.h"
X x(...);
A a(x);
a.getB().methodThatRequiresA(); 
```

继续这一点，我有一个 B 类，它需要 A 类的对象才能工作，而 A 通过 getB() 提供了一个使用自身的 B 类型的对象，因为每个 A 必须只有一个 B 的实例，我虽然这没关系。自从我这样做以来，编译时间增加了几秒钟，而我的项目中只有一个非常少的类。

循环依赖编译需要这么长时间吗？如果是这样，编译具有大量循环依赖项的项目可能会非常耗时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:45:36.970

编译大项目，特别是优化可能需要很长时间。但在你的情况下，罪魁祸首是你没有在你的头文件中使用警卫，编译器必须多次解析同一个头文件。所以解决方案可能是（对于文件啊）：

```
#ifndef A_H_
#define A_H_
// 
//

#endif // A_H_ 
```

对此有不同的解决方案，例如来自 MS VS 等的 pragma once，但这是 IMO 最便携的方式。符号不必完全像这样，但必须是唯一的。

# php - 尽管 URL 具有适当的形式，但无法从 URL 获取和回显 PHP $_GET 变量

> ID：15042794
> 
> 赞同：0
> 
> 时间：2013-02-23T16:32:29.457
> 
> 标签：php, url, get, populate, post-redirect-get

我在原型阶段。

我使用 post-redirect-get 方法制作了我的自定义电子邮件 php 页面。**我的问题是：**

我在填写电子邮件表格时故意犯了错误。名称必须是字母数字，但我输入的名称不是字母数字。正如我所期望的那样，我的验证页面会重定向到带有错误警告的邮件发送页面。

url 正是我所期望的，但尽管我检查了我的变量，但我无法将 url GET 值打印到屏幕上。你能帮我么？

为什么我不能通过`$_GET`变量将值从 url 打印到屏幕？我应该怎么办？

谢谢， BR

**带有错误警告的网址**（如我所料）

`http://localhost/english/contact?if_isim=john!*nash&if_eposta=example@dot.com&if_mesaj=message&eposta_hatalari=Only%20letters%20and%20numbers%20are%20allowed%20in%20name%20input.%3Cbr%20/%3E`

**以及我希望填充先前填充的输入并打印累积的错误消息的相关页面。（但什么都不做）**

```
<?php 
//okur bilgileri kaybolmasın
if (!isset($_GET['if_isim'])) {$if_isim_d = "";} else {$if_isim_d = $_GET['if_isim'];}
if (!isset($_GET['if_eposta'])) {$if_eposta_d = "";} else {$if_eposta_d = $_GET['if_eposta'];}
if (!isset($_GET['if_mesaj'])) {$if_mesaj_d = "";} else {$if_mesaj_d = $_GET['if_mesaj'];}

//hata mesajı
if (!isset($_GET['eposta_hatalari'])) {$hatali_eposta_d = '';} else {$hatali_eposta_d = $_GET['eposta_hatalari'];}
?>

            <div class="sol-icerik-kapsar">
                <?php if ($hatali_eposta_d !='') {echo $hatali_eposta_d;} //varsa hatalar yazdırılıyor ?>
                <form method="post" id="iletisim-formu" action="<?php echo sitenin_koku.'eposta-doğrula'; ?>">
                        <fieldset id="fset-iletisim">
                            <legend id="leg-iletisim" class="font75"><?php if ($page_language == 'tr') {echo 'İletişim Formu:';} else {echo 'Contact Form:';} ?></legend>
                            <label for="if_isim"><span class="font75"><?php if ($page_language == 'tr') {echo 'İsminiz:';} else {echo 'Name:';} ?></span></label><br />
                            <input type="text" value="<?php echo $if_isim_d; ?>" name="if_isim" id="if_isim" /><br />
                            <label for="if_eposta"><span class="font75"><?php if ($page_language == 'tr') {echo 'E-posta adresiniz:';} else {echo 'E-mail:';} ?></span></label><br />
                            <input type="text" value="<?php echo $if_eposta_d; ?>" name="if_eposta" id="if_eposta" /><br />
                            <input type="hidden" name="dilang" value="<?php echo $adres_get_elemanlari[0]; ?>">
                            <label for="if_mesaj"><span class="font75"><?php if ($page_language == 'tr') {echo 'Mesajınız:';} else {echo 'Message:';} ?></span></label><br />
                            <textarea rows="6" cols="20" name="if_mesaj" id="if_mesaj"><?php echo $if_mesaj_d; ?></textarea><br />
                            <input type="submit" id="epostayolla" class="font75" value="<?php if ($page_language == 'tr') {echo 'Gönder';} else {echo 'Send';} ?>" />
                        </fieldset>
                </form><!-- end #iletisim-formu -->
            </div><!-- end .sol-icerik-kapsar --> 
```

**我怀疑也许我应该在`URLENCODE()`某个地方使用！**希望它能点亮你心中的灯泡。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T19:32:09.370

我使用过`print_r($_GET)`并且看到它`$_GET`没有携带来自表单元素和错误变量的附加值。

我的问题与[这个](https://stackoverflow.com/questions/7295837/how-to-add-additional-url-variables-to-a-url-already-rewritten-with-mod-rewrite)、[这个](https://stackoverflow.com/questions/10555589/how-to-read-get-variables-with-mod-rewrite-powered-nice-urls)和[这个](https://stackoverflow.com/questions/9721114/mod-rewrite-and-get-variable)帖子直接相关。

明确地说，我的问题是：如果没有正确的 .htaccess 设置，可能无法将 $_GET 变量添加到（mod rewrite 驱动的）SEO 友好的好 URL。

# ruby-on-rails - 类语法，什么时候需要或不需要符号？

> ID：15042804
> 
> 赞同：1
> 
> 时间：2013-02-23T16:33:04.063
> 
> 标签：ruby-on-rails, ruby

所以我有一个这样的模型类：

```
attr_accessible :email, :firstname, :lastname, :phones_attributes 
```

甚至像这样在该模型中进行验证：

```
 validates :firstname, presence: true 
```

请注意，它们都在变量名之前使用了那个“：”符号。

但是在那个模型中，我有一个这样的方法：

```
 def name
    [firstname, lastname].join(' ')
  end 
```

那么这次我们为什么不需要在变量名之前输入那些“：”呢？有什么不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:41:32.323

你看，你传递给`attr_accessor`的实际上不是一个变量，而是一个变量的名称。变量的名称是一个符号，`:name`是符号的字面语法。在您的`name`方法中，您实际上使用的是一个变量，而不仅仅是它的名称，因此， no `:`​​。

更详细地说，`attr_accessor`从不直接使用变量。相反，它使用按名称获取变量的方法。因此，它需要名称，而不是变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:49:41.697

将符号视为以“Rails 方式”表示某事的简单字符串。所以这与：

```
attr_accessible "email", "firstname", "lastname", "phones_attributes" 
```

但是在实例方法`name`中，名字和姓氏实际上被理解为`model_object.firstname`等`model_object.lastname`。因此，没有冒号。

# php - 获取 Dom 对象 PHP 的长度

> ID：15042808
> 
> 赞同：0
> 
> 时间：2013-02-23T16:33:30.487
> 
> 标签：php, dom

我有这个代码：

```
 $strhtml = $segatieladvance;
    $dochtml = new DOMDocument();
    $dochtml->loadHTML($strhtml);
    $elm = $dochtml->getElementById('upPanelActuciones');
$segatiel= $dochtml->saveXml($elm); 
```

我想知道 $segatiel 中的字符数，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:35:17.433

您可以使用该[`strlen`](http://php.net/strlen)功能

`strlen($segatiel)`

# php - codeigniter 会话被自动删除

> ID：15042818
> 
> 赞同：0
> 
> 时间：2013-02-23T16:33:59.260
> 
> 标签：php, codeigniter, session

我有几个使用 tank auth 和 ion auth 的 codeigniter 项目。

我现在注意到，用户登录后，在他们移动的第一页中，他们被注销了......

我找不到为什么会这样，而且这不仅在一个项目上，所以它不可能是我的代码。

有什么建议吗？

它只发生在 chrome 上....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:49:03.850

我的朋友有类似的问题，并通过设置`$config['cookie_secure']` 为 FALSE 解决了它。基本上，由于他没有使用 https，因此没有创建 cookie。

# php - 是向用户显示还是仅对开发人员显示的例外？

> ID：15042820
> 
> 赞同：3
> 
> 时间：2013-02-23T16:34:05.907
> 
> 标签：php, exception

我最近刚刚阅读了一篇关于[http://phpmaster.com/exceptional-exceptions/](http://phpmaster.com/exceptional-exceptions/)的文章，他谈到了异常：

> 您的调用代码永远不应该阅读该消息。该消息唯一对开发人员有利。

在 W3Schools 网站上，他们展示了一个示例，当异常消息被捕获时会输出异常消息，所以我很困惑。我从[http://www.phpmaster.com](http://www.phpmaster.com)学到了很多东西，并且相信他们所说的，但是 W3Schools 也总是可靠的，所以正确的做法是什么？

异常消息应该输出给用户还是只是开发人员的东西？也许它甚至没有那么重要，并且可以双向使用而不会造成任何伤害？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:42:22.150

这取决于场景，但最大的问题是安全性。当开发人员抛出异常时，他们通常会尝试在消息中包含一些关于究竟出了什么问题的有用信息。他们不知道在当前情况下您是否会认为该信息是敏感信息。

例如，假设您有一个包含登录表单的网站。如果`Users`数据库中的表丢失并且有人尝试登录，则抛出的异常可能类似于`Unable to find table users in database MyDb (db.mysite.com)`

如果该消息显示给恶意用户，他们现在知道您的数据库在哪里以及 db/table 名称是什么。

在这种情况下，我倾向于使用唯一的 ID 记录完整的异常并将该 ID 显示给用户，以便他们稍后可以在需要时与我跟进。

相反，如果它是桌面应用程序，那么我倾向于另一种方式 - 异常消息可以帮助最终用户（例如`Access Denied`，用户可能能够解决的问题）。即使这样，您也不确定异常消息是否有用（ala `Reference not set to an instance of an object`）所以我倾向于将任何异常包装在更有用的消息中（例如`Unable to connect to database`）并公开所有内部异常的列表。这意味着用户会收到可以理解的消息，但如果可用，也可能会获得更多有用的信息，而不是安全风险

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:52:40.170

没有一个明确的答案。这取决于消息提供的信息。
如果您的消息不提供任何敏感信息，您可以将它们打印给客户。

我喜欢使用`$code`参数来将错误打印到客户端。
像这样的东西：

```
function clientError(Exception $e) {
    $error = 'Unknown error!';
    switch ($e->getCode()) {
        case 404:
            $error = 'Not found error!';
            break;
        case 403:
            $error = 'You cannot access this page!';
            break;
        ...
        ...
    }
    return "$error [error code: {$e->getCode()}]";
} 
```

将错误信息保存在错误日志中，并将 clientError 打印到客户端：

```
try {
    if (!$user->isMember()) {
        throw new Exception("Guest {$user->id} tried to access to newPost.php page", 403);
    }
}
catch (Exception $e) {
    $errorLog->newError($e);
    echo clientError($e);
} 
```

此示例应在错误日志中添加一行消息：
“Guest 123 尝试访问 newPost.php 页面”
并打印：
“您无法访问此页面！”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T16:59:11.297

几乎是对的。您当然不想用 Stackframe 来呈现黑客类型。向用户展示它们也不是那么有用。话虽如此，遵循这个建议，因为它被提出来陷入陷阱。

有时您获得的异常类过于通用，识别它的唯一方法是测试文本。OLE 是经典的。无论如何，运行一条你得到 OLEDB 异常的 sql 语句。另一个相关的问题是当您尝试 catch end 并假设将抛出的唯一异常是您认为可能的异常，然后您得到一个用户打电话说我收到“保存您的文档时出现问题"，这可能是一大堆问题中的任何一个。

不管你做什么，如果你得到它，你会记录原始异常和堆栈帧。这很明显，但太多人掉进了这个陷阱。

不要将问题简化为您提供的信息是完全无用的路线。

Even exceptions for devs have gone down that route Access Violation 0000000 at 0000000 was a good one, "Unknown ole error(5)" was brilliantly stupid, or the ever annoying msi one "error 1603".

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T16:41:46.017

重新 W3Schools：[http ://w3fools.com/](http://w3fools.com/)

例外仅适用于开发人员。它们可能包含有助于攻击者入侵您的网站的信息，而且它们并不漂亮。如果您期望它发生异常并执行用户期望的操作，例如显示他们可以理解的错误消息，请捕获该异常。如果您没想到会发生异常，那么您有一个需要修复的问题。

未捕获的异常也称为“错误”；）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-23T16:42:23.557

由于缺乏编程经验，大多数异常对最终用户没有帮助，您应该处理自己的异常并向最终用户发出明确的信息

# c# - 如何将“传递参数”添加到自定义 AuthorizeAttribute

> ID：15042821
> 
> 赞同：9
> 
> 时间：2013-02-23T16:34:17.277
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, custom-attributes

我想保护控制器操作，以便只有具有“管理员”角色的用户才能进入。
我根本不使用角色/成员资格提供程序，一切都是自定义的。
到目前为止我做了这个：

```
public class CustomAuthorizeAttribute : AuthorizeAttribute
{
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        var isAuthorized = base.AuthorizeCore(httpContext);            
        if (!isAuthorized)
            return false;

        string username = httpContext.User.Identity.Name;

        UserRepository repo = new UserRepository();

        return repo.IsUserInRole(username, "Admin");
    }
} 
```

请注意，我在这里硬编码了“Admin”。
我希望这是动态的。
现在这项工作：

```
[CustomAuthorize]
        public ActionResult RestrictedArea()... 
```

但我想要这样的东西：

```
[CustomAuthorize(Roles = "Admin")]
        public ActionResult RestrictedArea() 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-23T16:35:50.870

`AuthorizeAttribute`已有`Roles`可用于此目的的属性：

```
public class CustomAuthorizeAttribute : AuthorizeAttribute
{
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        var isAuthorized = base.AuthorizeCore(httpContext);            
        if (!isAuthorized)
        {
            return false;
        }

        string username = httpContext.User.Identity.Name;

        UserRepository repo = new UserRepository();

        return repo.IsUserInRole(username, this.Roles);
    }
} 
```

# php - 复合透明图像上的 Imagick 运动模糊

> ID：15042825
> 
> 赞同：2
> 
> 时间：2013-02-23T16:34:45.447
> 
> 标签：php, imagemagick, imagick

我正在尝试合成多个现有图像的图像，并在其上应用运动模糊。我正在使用透明画布来绘制所有图像。结果如下：![在此处输入图像描述](../Images/fd1b14939cc705b4a56fe9a15508eedb.png)

如您所见，模糊部分不会留下单个图像的不透明部分。我怎样才能让它们在这些部分之外变得模糊？

**更新：** 这也是我模糊边缘的意思：

![在此处输入图像描述](../Images/f16b89ea5b7a21371c8548ae667226ba.png)

这是我的代码：

```
header("Content-Type: image/png");

$images = array("a.png","b.png","c.png");

$canvas = new Imagick();
$canvas->newImage(128*3, 128, new ImagickPixel("rgba(0,0,0,0)"));
$canvas->setImageFormat("png");

for($i=0; $i<count($images); $i++)
{
    $img = new Imagick($images[$i]);
    $canvas->compositeimage($img, Imagick::COMPOSITE_DEFAULT, $i*128, 0);
}
$canvas->motionblurimage(100, 40, 90);

echo $canvas; 
```

感谢您提供任何帮助或指示如何解决此问题！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T12:00:50.250

尝试为通道添加参数：

```
$canvas->motionblurimage(100, 40, 90, Imagick::CHANNEL_ALL); 
```

我认为默认通道设置使效果仅限于非透明部分。

当我使用那条确切的线时，图像变得非常模糊 - 可能比你想要的更模糊。前两个值可能需要减少，甚至减半。

# escaping - 用于将其放入 TCL 中的正则表达式的转义字符串

> ID：15042826
> 
> 赞同：2
> 
> 时间：2013-02-23T16:34:54.903
> 
> 标签：escaping, tcl, expect

我`Expect`用作测试框架并编写一些辅助函数来简化`expect`命令匹配模式的键入。

因此，我寻找将任何字符串转换为字符串的函数，其中所有特殊的正则表达式语法都已转义（如`*`、`|`、和其他字符） `+`，`[`因此我可以将任何字符串放入正则表达式，而不必担心我会破坏正则表达式：

```
expect -re "^error: [escape $str](.*)\\."
refex "^error: [escape $str](.*)\\."  "lookup string..." 
```

因为`expect -ex`编写`expect -gl`转义函数非常容易。但是`expect -re`因为我是 TCL 的新手，所以很难......

**PS**我写了这段代码，目前正在测试它们：

```
proc reEscape {str} {
    return [string map {
        "]" "\\]" "[" "\\[" "{" "\\{" "}" "\\}"
        "$" "\\$" "^" "\\^"
        "?" "\\?" "+" "\\+" "*" "\\*"
        "(" "\\(" ")" "\\)" "|" "\\|" "\\" "\\\\"
    } $str]
}

puts [reEscape {[]*+?\n{}}] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T18:05:33.937

一种安全的策略是转义所有非单词字符：

```
proc reEscape {str} {
    regsub -all {\W} $str {\\&}
} 
```

将`&`被表达式中匹配的任何内容替换。

例子

```
% set str {^this is (a string)+? with REGEX* |metacharacters$}
^this is (a string)+? with REGEX* |metacharacters$

% set escaped [reEscape $str]
\^this\ is\ \(a\ string\)\+\?\ with\ REGEX\*\ \|metacharacters\$ 
```

# xpath - XSLT：选择所有以

> ID：15042829
> 
> 赞同：2
> 
> 时间：2013-02-23T16:35:23.717
> 
> 标签：xpath, xslt-1.0

我正在尝试进行 XSLT 转换，其中输入 XML 是任意的。唯一不变的是，它将有一个名称以“first”开头的节点。我需要获取该节点的值，它是直接兄弟节点。但是，以下模板仅生成 XML 声明。

如果重要的话，这段代码是使用 Nokogiri XML 解析器在 Ruby 中编写的。但是，我认为这更像是一个 XSLT/XPath 问题而不是 Ruby 问题，因此相应地进行了标记。

输入 XML：

```
<?xml version="1.0"?>
<employees>
  <employee>
    <first_name>Winnie</first_name>
    <last_name>the Pooh</last_name>
  </employee>
  <employee>
    <first_name>Jamie</first_name>
    <last_name>the Weeh</last_name>
  </employee>
</employees> 
```

所需的输出 XML：

```
<?xml version="1.0"?>
<people>
  <person>
    <first>Winnie</first>
    <last>the Pooh</last>
  </person>
  <person>
    <first>Jamie</first>
    <last>the Weeh</last>
  </person>
</people> 
```

XSLT：

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes" encoding="UTF-8" />
<xsl:template match="/">
  <xsl:for-each select="node()[starts-with(name(), 'first')]">
    <people>
      <person>
        <name>
      <first><xsl:value-of select="." /></first>
      <last><xsl:value-of select="following-sibling::*[1]" /></last>
    </name>
      </person>
    </people>
  </xsl:for-each>
</xsl:template>
  </xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T19:12:24.157

如果输入 XML 如您所建议的那样任意，我看不出如何将员工/员工更改为人员/人员。但是，您可以通过以下方式获得大致正确的效果

```
<xsl:template match="*">
  <xsl:copy><xsl:apply-templates/></xsl:copy>
</xsl:template>

<xsl:template match="*[starts-with(name(), 'first')]">
  <first><xsl:apply-templates/></first>
</xsl:template>

<xsl:template match="*[preceding-sibling::*[1][starts-with(name(), 'first')]]">
  <last><xsl:apply-templates/></last>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T20:39:28.763

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes" encoding="UTF-8" />
  <!-- match the node that has a name starting with 'first' -->
  <xsl:template match="node()[starts-with(name(), 'first')]">
    <xsl:element name="people">
      <xsl:element name="person">
        <xsl:element name="name">
          <xsl:element name="first">
            <xsl:value-of select="." />
          </xsl:element>
          <xsl:element name="last">
            <xsl:value-of select="following-sibling::*[1]" />
          </xsl:element>
        </xsl:element>
      </xsl:element>
    </xsl:element>
    <xsl:apply-templates />
  </xsl:template>
  <!-- stop the processor walking the rest of the tree and hitting text nodes -->
  <xsl:template match="text()|@*" />
</xsl:stylesheet> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T16:41:38.880

使用`.//node()`而不是`node()`.

# c# - 如何在 DataGrid 中显示大量行

> ID：15042832
> 
> 赞同：3
> 
> 时间：2013-02-23T16:36:09.333
> 
> 标签：c#, .net, wpf, database, performance

我有一个从 DataTable 填充的 WPF DataGrid。到目前为止，我从未有超过 200 条左右的记录，因此 DataGrid 被完美地填充。但是，我现在必须添加对更大数据库的支持。因此，我想向用户显示 200 条记录，然后让他按下某种按钮，以显示接下来的 200 条记录，依此类推。这样我可以更快地加载 DataGrid。

最好的方法是什么？我有一些在 ASP.NET 中进行分页的经验，但我在 WPF 中从未有过这样的要求。

这是我的 DataGrid 代码：

```
<DataGrid Name="dgResults" 
                  IsReadOnly="True"
                  AutoGenerateColumns="True"
                  AllowDrop="False"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  CanUserReorderColumns="False"
                  CanUserResizeColumns="False"
                  CanUserResizeRows="False"
                  CanUserSortColumns="False"
                  Margin="15,10,10,10"
                  Visibility="Collapsed" 
                  ItemsSource="{Binding}"/> 
```

**捆绑：**

```
dgResults.DataContext = dtResults.AsDataView(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T09:52:28.657

*我认为您需要通过使用LinqToSql*实现 类似这样的分页来解决**数据访问层中的问题**

 *```
var query = yourPersistenceManager.Context<YourTable>();
-- apply filters
query = query.Skip(pageNumber * pageSize).Take(pageSize); 
```

或者如果使用*ADO.Net* ，您可以使用一些像这样的通用分页查询（在 oracle 中实现）

```
select * from 
(
     select yourTable.*, rownum row_number from cc1customer 
     where  rownum <= pageSize*pageNumber 
) where row_number > (pageNumber -1) * pageSize 
```

在sqlserver`SELECT TOP`和 ...

一般推荐使用 an`ORDER BY`来获取页面间一致的数据

在**用户界面层**中，您必须在 WPF DataGrid 上手动实现分页
[这](http://www.codeproject.com/Articles/350447/WPF-Paging-in-DataGrid-ListBox)是一篇有用的文章，可能有用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:58:07.083

回避该问题的一种方法是为用户提供一些搜索条件，他们可以使用这些条件来查找特定结果。至少，用户通常不会翻阅数千个结果，除非他们必须这样做。您可以通过仅返回任何给定搜索的前 X 个结果来利用这一点。您可以使用 TSQL`SELECT TOP 200 *`或使用 linq来限制查询返回的结果数量`.Take(200)`*

# php - htaccess - 为什么我的重写规则不起作用？

> ID：15042839
> 
> 赞同：0
> 
> 时间：2013-02-23T16:37:01.790
> 
> 标签：php, .htaccess

我的 htaccess 中有一些我无法解决的错误配置：/

这是htaccess：

```
RewriteEngine on
RewriteRule ^([^\.]+)/?$ index.php?page=$1 

rewritecond %{http_host} ^domain.com [NC]
rewriterule ^(.*)$ http://www.domain.com/$1 [r=301,L] 
```

.htaccess 实际上工作正常，除了在一种情况下：当我连接到没有“www.”的根域的子页面时，如下所示：

```
http://domain.com/somestuff 
```

然后第一条规则不适用，我被重定向到：

```
http://www.domain.com/index.php?page=somestuff 
```

我做错了什么？？感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:46:28.843

尝试移动

`RewriteRule ^([^\.]+)/?$ index.php?page=$1`

以下

`RewriteRule ^(.*)$ http://www.domain.com/$1 [r=301,L]`

# android - 在 Handler 和 Thread Widget 中设置 TextView

> ID：15042841
> 
> 赞同：1
> 
> 时间：2013-02-23T16:37:10.997
> 
> 标签：android, multithreading, widget, textview, handler

如何在处理程序中设置 TextView？

```
public class DigitalClock extends AppWidgetProvider {

public void onUpdate(Context context, AppWidgetManager appWidgetManager,
        int[] appWidgetIds) {
    int N = appWidgetIds.length;

    RemoteViews views = new RemoteViews(context.getPackageName(),
            R.layout.digitalclock);

    for (int i = 0; i < N; i++) {
        int appWidgetId = appWidgetIds[i];

        Intent clockIntent = new Intent(context, DeskClock.class);
        PendingIntent pendingIntent = PendingIntent.getActivity(context, 0,
                clockIntent, 0);

        views.setOnClickPendingIntent(R.id.rl, pendingIntent);

        appWidgetManager.updateAppWidget(appWidgetId, views);
    }
}

private static Handler mHandler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        // update your textview here.

    }
};

class TickThread extends Thread {
    private boolean mRun;

    @Override
    public void run() {
        mRun = true;

        while (mRun) {
            try {
                sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        mHandler.sendEmptyMessage(0);
    }
}
} 
```

我应该在这里更新 TextView：

```
 private static Handler mHandler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        // update your textview here.
    ... 
```

我该怎么做呢？在`OnUpdate`我将使用的方法`views.setTextViewText(R.id...`中，但在`Handler`RemoteViews 中不存在。我已经尝试了我所知道的一切，到目前为止，什么都没有

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:16:30.293

创建一个新的 :) RemoteViews 刚刚附加到远程实体，并且您几乎将它在实现时所做的一堆更改排队。

所以当你这样做时

```
appWidgetManager.updateAppWidget(appWidgetId, views); 
```

那是 RemoteViews 真正做某事的时候。

我认为真正的问题是使用的设计有点混乱。所以你有一个线程，不确定它从哪里开始，但它调用了一个处理程序，这很好，但你可能应该发送一些结构化数据，以便处理程序知道该做什么。RemoteViews 实例本身是 Parcelable，这意味着它们可以作为 Intent 和 Message 实例等事物的有效负载的一部分发送。这种设计的真正问题是您不能在没有 AppWidgetManager 实例的情况下调用 updateAppWidget 来实际执行您的更改。

您可以在小部件的生命周期内缓存 AppWidgetManager，也可以更新更新频率并移动到更多延迟队列工作人员。您从系统收到的下一个更新事件的位置，或两者的混合。

```
private SparseArray<RemoteView> mViews;

public void onUpdate(Context context, AppWidgetManager appWidgetManager,
        int[] appWidgetIds) {

       ....
       for (int appWidgetId : appWidgetIds) {
          RemoteViews v = mViews.get(appWidgetId);
          if (v != null) {
              appWidgetManager.updateWidget(appWidgetId, v);
          } else {
              enqueue(appWidgetManager, appWidgetId, new RemoteViews(new RemoteViews(context.getPackageName(),
            R.layout.digitalclock)));
             /* Enqueue would pretty much associate these pieces of info together
                and update their contents on your terms. What you want to do is up
                to you. Everytime this update is called though, it will attempt to update
                the widget with the info you cached inside the remote view. 
              */
          }
        }
} 
```

# java - 通过jtable编辑用户信息

> ID：15042842
> 
> 赞同：-1
> 
> 时间：2013-02-23T16:37:18.067
> 
> 标签：java, swing, jtable, mouseevent, abstracttablemodel

我有一个 jtable，它显示一个包含自己的文本文件。文本文件中的每一行都是一个用户记录。我添加了一个编辑按钮来编辑表格上的每个选定行。我使用此代码，但我不明白如何执行此操作：

```
public class AllUser extends AbstractTableModel {

UserInformation uiS = new UserInformation();
String[] col = {"ID", "Fname", "Lname", "Gender", "Date"};
List<UserInformation> Udata = new ArrayList<UserInformation>();

public AllUser() {
BufferedReader br = null;
    try {
        FileReader fr = new FileReader("xxx.txt");
        br = new BufferedReader(fr);
        String line;
        while ((line = br.readLine()) != null) {
            if (line.trim().length() == 0) {
                continue;
            }
            Udata.add(initializeUserInfos(line));
        }
    } catch (IOException e) {
    } finally {
        if (br != null) {
            try {
                br.close();
            } catch (IOException ioe) {
            }
        }
    }
}

private UserInformation initializeUserInfos(String str) {
    UserInformation Uinit = new UserInformation();
    String[] CellArray = str.split("     ");
    Uinit.setID(CellArray[0]);
    Uinit.setFname(CellArray[1]);
    Uinit.setLname(CellArray[2]);
    Uinit.setGender(CellArray[3]);
    Uinit.setDate(CellArray[4]);
    return Uinit;
}
@Override
public String getColumnName(int colu) {
    return col[colu];
}

@Override
public int getRowCount() {
    return Udata.size();
}

@Override
public int getColumnCount() {
    return col.length;
}

@Override
public Object getValueAt(int rowIndex, int columnIndex) {
    UserInformation uinfoS = Udata.get(rowIndex);
    Object value = null;
    switch (columnIndex) {
        case 0:
            value = uinfoS.getID();
            break;
        case 1:
            value = uinfoS.getFname();
            break;
        case 2:
            value = uinfoS.getLname();
            break;
        case 3:
            value = uinfoS.getGender();
            break;
        case 4:
            value = uinfoS.getDate();
            break;
        default:
            value = "...";
    }
    return value;
}

@Override
public void setValueAt(Object value, int rowIndex, int columnIndex) {
    UserInformation userInfo = new UserInformation();

    switch (columnIndex) {

        case 0:
            userInfo.setID((String) value);
            break;
        case 1:
            userInfo.setFname((String) value);
            break;
        case 2:
            userInfo.setLname((String) value);
            break;
        case 3:
            userInfo.setGender((String) value);
            break;
        case 4:
            userInfo.setDate((String) value);
            break;
    }

}

public Object getSelectedMember(int row){
    UserInformation userInf=new UserInformation();

    Object fname=userInf.getFname();
    Object lname=userInf.getLname();
    Object gender=userInf.getGender();
    Object date=userInf.getDate();
    return // ?

}
} 
```

我添加了这个`getSelectedMember(int row)`方法来做到这一点，但是不正确！

```
public class UserPage extends JFrame implements ActionListener {

private AllUser userModel;
private JTable uTable;
private JButton editButton;

public UserPage() {
    userModel = new AllUser();
    uTable = new JTable(userModel);
    add(new JScrollPane(uTable), BorderLayout.CENTER);
    add(buttonPanels(), BorderLayout.PAGE_START);
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    this.setSize(800, 600);
}
public final JPanel buttonPanels() {
    JPanel buttonsPanel = new JPanel(new FlowLayout(FlowLayout.LEFT));
    editButton=new JButton("Edit");
    editButton.addActionListener(this);
    buttonsPanel.add(editButton);
    return buttonsPanel;
}
@Override
public void actionPerformed(ActionEvent e) {
        if(e.getSource()== editButton){
        int selectedRow=uTable.getSelectedRow();
        if(selectedRow>0){
            editUser(selectedRow);
        }
        else{
            JOptionPane.showMessageDialog(null, "Select a user");
        }

    }
}
    public void editUser(int row){
    userModel.getSelectedMember(row);
    new NewUserFrame_Edit().setVisible(true);  
}
} 
```

`UserInformation`班级：

```
public class UserInformation {

private String Fname;
private String Lname;
private String ID;
private String Gender;
private String Date;

public String getFname() {
    return Fname;
}

public void setFname(String fname) {
    this.Fname = fname;
}

public String getLname() {
    return Lname;
}

public void setLname(String lname) {
    this.Lname = lname;
}

public String getID() {
    return ID;
}

public void setID(String i_d) {
    this.ID = i_d;
}

public String getGender() {
    return Gender;
}

public void setGender(String gndr) {
    this.Gender = gndr;
}

public String getDate() {
    return Date;
}

public void setDate(String date) {
    this.Date = date;
}

@Override
public String toString() {
    return ID + "     " + Fname + "     "
            + Lname + "     " + Gender + "     " + Date + "\n";
}
} 
```

对不起，长代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:59:07.693

> 它应该是这样的：当用户单击 jtable 中的一行并单击一个新页面时，应该打开一个新页面，然后每个旧数据都应该插入到自己的文本文件中

1.  将 MouseListener 添加到表中。

2.  双击创建一个 JDialog，其中包含编辑数据所需的文本字段。

3.  然后，您可以使用 getValueAt(...) 方法从表中获取数据。

4.  然后用户编辑文本字段中的数据。

5.  当用户单击对话框上的“保存”按钮时，您会从每个文本字段中获取数据并使用 setValueAt(...) 方法更新表格。

6.  如果要将数据保存在文本文件中，则需要通过写出表中的所有数据来重新创建整个文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T23:59:20.503

在表中创建一个额外的列并用 填充单元格值`Edit`。然后`Edit`使用适当的`TableCellRenderer`. 添加`MouseListener`到表中。获取点击表格的单元格的`row`编号`column`。如果单击的单元格包含 value `Edit`，则在该行的每一列检索 value 并将其显示在包含 的 Panel 中`JTextFields`。使用 JOptionpane 或在 JDialog 中显示该面板。以下是实现此任务的简短代码演示：

```
import java.awt.BorderLayout;
import java.awt.GridLayout;
import java.awt.Component;
import java.awt.Color;
import java.awt.Point;
import java.awt.event.MouseListener;
import java.awt.event.MouseEvent;
import java.awt.event.MouseAdapter;
import java.awt.Cursor;
import javax.swing.BorderFactory;
import javax.swing.border.BevelBorder;
import javax.swing.JFrame;
import javax.swing.JTable;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.JButton;
import javax.swing.JScrollPane;
import javax.swing.JOptionPane;
import javax.swing.JLabel;
import javax.swing.SwingUtilities;
import javax.swing.event.TableModelListener;
import javax.swing.event.TableModelEvent;
import javax.swing.table.TableModel;
import javax.swing.table.AbstractTableModel;
import javax.swing.table.TableColumn;
import javax.swing.table.DefaultTableCellRenderer;
class TableRowEdit extends JFrame  
{
    private JTable table;
    private JScrollPane jsPane;
    private TableModel myModel;
    private JPanel dialogPanel;
    private JTextField tf[];
    private JLabel     lbl[];
    public void prepareAndShowGUI()
    {
        myModel = new MyModel();
        table = new JTable(myModel);
        jsPane = new JScrollPane(table);
        table.getColumnModel().getColumn(2).setCellRenderer(new LabelCellRenderer());
        table.addMouseListener(new MyMouseAdapter());
        getContentPane().add(jsPane);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        prepareDialogPanel();
        pack();
        setVisible(true);

    }
    private void prepareDialogPanel()
    {
        dialogPanel = new JPanel();
        int col = table.getColumnCount() - 1;
        dialogPanel.setLayout(new GridLayout(col,2));
        tf = new JTextField[col];
        lbl = new JLabel[col];
        for (int i = 0; i < col; i++)
        {
            lbl[i] = new JLabel(table.getColumnName(i));
            tf[i] = new JTextField(10);
            dialogPanel.add(lbl[i]);
            dialogPanel.add(tf[i]);
        }
    }
    private void populateTextField(String[] s)
    {
        for (int i = 0 ; i < s.length ; i++ )
        {
            tf[i].setText(s[i]);
        }
    }
    public class LabelCellRenderer extends DefaultTableCellRenderer 
    {
        public Component getTableCellRendererComponent(JTable table,Object oValue, boolean isSelected, boolean hasFocus, int row, int column) 
        {
            Component c = super.getTableCellRendererComponent(table, oValue,isSelected, hasFocus,row, column);
            String value = (String)oValue;
            JLabel label =(JLabel)c;
            label.setBorder(BorderFactory.createBevelBorder(BevelBorder.RAISED));
            label.setBackground(Color.lightGray);
            label.setHorizontalTextPosition(SwingUtilities.CENTER);
            label.setHorizontalAlignment(SwingUtilities.CENTER);
            label.setText(value);
            return label;
        }
    }

    private class MyMouseAdapter extends MouseAdapter
    {
        @Override
        public void mousePressed(MouseEvent evt)
        {
            int x = evt.getX();
            int y = evt.getY();
            int row = table.rowAtPoint(new Point(x,y));
            int col = table.columnAtPoint(new Point(x,y));
            if (col == 2)
            {
                String arr[] = new String[table.getColumnCount() - 1];
                for (int i = 0 ; i < arr.length ; i++)
                {
                    arr[i] = (String)table.getValueAt(row,i);
                }
                populateTextField(arr);
                JOptionPane.showMessageDialog(TableRowEdit.this,dialogPanel,"Information",JOptionPane.INFORMATION_MESSAGE);
                //Write here the code to save changed values to file and update to JTable also.
            }
        }
    }
    private class MyModel extends AbstractTableModel 
    {
        String[] columns = {
                            "Roll No.",
                            "Name",
                            "Action"
                            };
        String[][] inData = {
                                {"1","Huge Jackman","Edit"},
                                {"2","Thomas Andrews","Edit"},
                                {"3","Shiney","Edit"}
                            };
        @Override
        public void setValueAt(Object value, int row, int col)
        {
            inData[row][col] = (String)value;
        }
        @Override
        public Object getValueAt(int row, int col)
        {
            return inData[row][col];
        }
        @Override
        public int getColumnCount()
        {
            return columns.length;
        }
        @Override 
        public int getRowCount()
        {
            return inData.length;
        }
        @Override
        public String getColumnName(int col)
        {
            return columns[col];
        }
    }
    public static void main(String st[])
    {
        SwingUtilities.invokeLater( new Runnable()
        {
            @Override
            public void run()
            {
                TableRowEdit td = new TableRowEdit();
                td.prepareAndShowGUI();
            }
        });
    }
} 
```

# bash - 使用bash中的顶级程序将cpu时间提取到变量中

> ID：15042844
> 
> 赞同：0
> 
> 时间：2013-02-23T16:37:33.047
> 
> 标签：bash, time, cpu

我在 bash 脚本中有一个任务，试图测量用于按名称传递到脚本中的进程的 cpu 时间。我可以找到进程 ID 并将其传递给 bash 中的顶级程序。但是，我还没有弄清楚如何从顶级程序中提取 cpu 时间。例如：

顶部正在打印：

```
top - 00:57:07 up  6:06,  2 users,  load average: 0.46, 0.31, 0.55
Tasks:   1 total,   1 running,   0 sleeping,   0 stopped,   0 zombie
%Cpu(s):  3.7 us,  0.8 sy,  0.0 ni, 94.6 id,  0.9 wa,  0.0 hi,  0.1 si,  0.0 st
KiB Mem:   1928720 total,  1738072 used,   190648 free,    57184 buffers
PID USER      PR  NI  VIRT  RES  SHR S  %CPU %MEM    TIME+  COMMAND
3337 amarkovi  20   0  372m  31m  10m R   0.7  1.7  13:28.74 chromium-browse 
```

我想要的只是将 TIME+ 字段分配给变量，这样我就可以将时间相加并自行打印出来。

我是 bash 脚本的菜鸟，所以请耐心等待。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:45:55.613

你必须使用`top`吗？它应该更简单（一旦你制定出正确的选项）来`ps`为你提供你想要的字段，然后用它`grep`来选择你想要的过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:43:49.923

因为这是一个任务，我不想破坏所有的乐趣：D。我将向您指出一些可以帮助您努力的命令`sed`：`awk`和`cut`. 有了这 3 个，您可以通过多种方式解决它，尽情享受吧！

# php - 无法使用 phpMyAdmin 登录 MySQL

> ID：15042845
> 
> 赞同：0
> 
> 时间：2013-02-23T16:37:50.863
> 
> 标签：php, mysql, phpmyadmin

我在运行 Windows 7 Ult 64 位的桌面上安装了 IIS7、MySQL 5.5 和 PHP 5.3 来开发网站并在本地测试 *.php 网页，而无需将它们上传到我的网络主机。几个月来一切都运行良好，直到最近。当我尝试使用 phpmyadmin 登录 MySQL 数据库时，网页只会清除用户名和密码并停留在登录页面。即使我输入了错误的用户名和密码，它也不会说登录凭据错误，它只是停留在登录页面上。甚至我的根用户名和密码都不起作用。

我尝试按照其他论坛的说明进行手动密码重置，但这并没有让我通过登录页面。

我的数据库只是一个测试数据库，所以我什至卸载并重新安装了 MySQL。这安装了更新版本的 MySQL 5.6。那没有用。

我尝试了从 5.2 到最新版本 5.7 的不同版本的 phpmyadmin。我将 IIS7 中的 PHP 更改为 PHP 5.4，但这也没有让我的登录工作。

*.php 中的所有网页都可以在 localhost 机器上正常打开。我可以很好地查看它们。我运行家庭服务器，当我从远程计算机访问该网站时，我可以浏览整个网站。当我转到 http://[remotecomputername]/phpmyadmin 并尝试登录时，它只是进入一个空白页面，并没有显示 phpmyadmin gui。

不知道为什么在 localhost 上的登录停止工作，但任何解决此问题的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-03T14:10:12.403

转到控制面板>管理工具>服务>

然后你会找到一个项目列表，导航到 MYSQL

右键单击它>属性>常规选项卡>开始类型（使其自动）

然后应用/保存

最后重新启动 wamp 中的所有服务

# c++ - 刷新缓冲区是什么意思？

> ID：15042849
> 
> 赞同：121
> 
> 时间：2013-02-23T16:38:28.537
> 
> 标签：c++, input, buffer, output, flush

我正在学习 C++，但我发现了一些我无法理解的东西：

> 可以显式刷新输出缓冲区以强制写入缓冲区。默认情况下，读取`cin`刷新`cout`；`cout`程序正常结束时也会刷新。

所以刷新缓冲区（例如输出缓冲区）：这是通过删除缓冲区中的所有内容来清除缓冲区，还是通过输出其中的所有内容来清除缓冲区？或者刷新缓冲区是否意味着完全不同的东西？

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2013-02-23T16:42:04.677

考虑写入文件。这是一项昂贵的操作。如果在您的代码中一次写入一个字节，那么每次写入一个字节将非常昂贵。因此，提高性能的一种常用方法是将正在写入的数据存储在临时缓冲区中。只有当有大量数据时才将缓冲区写入文件。通过推迟写入，一次写入一个大块，性能得到了提高。

考虑到这一点，刷新缓冲区是将数据从缓冲区传输到文件的行为。

> 这是通过删除缓冲区中的所有内容来清除缓冲区，还是通过输出缓冲区中的所有内容来清除缓冲区？

后者。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-02-23T16:50:05.067

你引用了答案：

> 可以显式刷新输出缓冲区以强制写入缓冲区。

也就是说，您可能需要“刷新”输出以将其写入底层流（可能是一个文件，或者在列出的示例中，一个终端）。

通常，stdout/cout 是行缓冲的：在您写入换行符或显式刷新缓冲区之前，输出不会发送到操作系统。优点是类似的东西`std::cout << "Mouse moved (" << p.x << ", " << p.y << ")" << endl`只会导致对底层“文件”的一次写入而不是六次，这对性能来说要好得多。缺点是这样的代码：

```
for (int i = 0; i < 5; i++) {
    std::cout << ".";
    sleep(1); // or something similar
}

std::cout << "\n"; 
```

将立即输出`.....`（有关确切`sleep`实施，请参阅[此问题](https://stackoverflow.com/q/1658386/2675672)）。在这种情况下，您将需要额外`<< std::flush`的以确保显示输出。

读取`cin`刷新`cout`，因此您不需要显式刷新来执行此操作：

```
std::string colour;
std::cout << "Enter your favourite colour: ";
std::cin >> colour; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-23T16:41:57.777

通过输出所有内容来清除缓冲区。

# delphi - 同一可执行文件中的 TIdHTTPServer 和 TIdHTTP 可以连接吗？

> ID：15042854
> 
> 赞同：0
> 
> 时间：2013-02-23T16:38:59.953
> 
> 标签：delphi, delphi-xe2, indy

我有一个使用 TIdHTTPServer 的程序。现在我想使用与 TIdHTTPServer 对话的 TIdHTTP 编写一些自动化测试。测试代码在程序本身中。

当 TIdHTTP 尝试连接时出现“套接字错误 #10061 连接被拒绝”。引发异常。我猜那是因为 TIdHTTPServer 已经在使用该端口了。

位于同一可执行文件中的 TIdHTTPServer 和 TIdHTTP 是否可以相互通信？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T17:46:00.197

是的，它们可以在同一个可执行文件中运行并相互连接。只需在您传递给 TIdHTTP 的 URL 中指定（一个）TIdHTTPServer 的侦听 IP，例如：

```
with IdHTTPServer1.Binding.Add do
begin
  IP := '127.0.0.1';
  Port := 80;
end;
IdHTTPServer1.Active := True;
...
IdHTTP1.Get('http://127.0.0.1/'); 
```

# java - 删除超过 x 天的文件

> ID：15042855
> 
> 赞同：43
> 
> 时间：2013-02-23T16:39:04.150
> 
> 标签：java, time, delete-file

我如何找出使用java创建文件的时间，因为我希望删除早于某个时间段的文件，目前我正在删除目录中的所有文件，但这并不理想：

```
public void DeleteFiles() {
    File file = new File("D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/");
    System.out.println("Called deleteFiles");
    DeleteFiles(file);
    File file2 = new File("D:/Documents/NetBeansProjects/printing~subversion/fileupload/Uploaded/");
    DeleteFilesNonPdf(file2);
}

public void DeleteFiles(File file) {
    System.out.println("Now will search folders and delete files,");
    if (file.isDirectory()) {
        for (File f : file.listFiles()) {
            DeleteFiles(f);
        }
    } else {
        file.delete();
    }
} 
```

以上是我当前的代码，我现在正在尝试添加一个 if 语句，该语句只会删除一周之前的文件。

编辑：

```
@ViewScoped
@ManagedBean
public class Delete {

    public void DeleteFiles() {
        File file = new File("D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/");
        System.out.println("Called deleteFiles");
        DeleteFiles(file);
        File file2 = new File("D:/Documents/NetBeansProjects/printing~subversion/fileupload/Uploaded/");
        DeleteFilesNonPdf(file2);
    }

    public void DeleteFiles(File file) {
        System.out.println("Now will search folders and delete files,");
        if (file.isDirectory()) {
            System.out.println("Date Modified : " + file.lastModified());
            for (File f : file.listFiles()) {
                DeleteFiles(f);
            }
        } else {
            file.delete();
        }
    } 
```

现在添加一个循环。

编辑

我注意到在测试上面的代码时我得到了最后一次修改：

```
INFO: Date Modified : 1361635382096 
```

我应该如何对 if 循环进行编码，以说明它是否超过 7 天，当它采用上述格式时将其删除？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-02-23T16:41:41.770

您可以使用[`File.lastModified()`](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#lastModified%28%29)获取文件/目录的最后修改时间。

可以这样使用：

```
long diff = new Date().getTime() - file.lastModified();

if (diff > x * 24 * 60 * 60 * 1000) {
    file.delete();
} 
```

这会删除早于`x`(an `int`) 天的文件。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-02-23T23:11:19.853

[Commons IO](http://commons.apache.org/io/)内置了通过[AgeFileFilter](https://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/filefilter/AgeFileFilter.html)按年龄过滤文件的支持。你`DeleteFiles`可能看起来像这样：

```
import java.io.File;
import org.apache.commons.io.FileUtils;
import org.apache.commons.io.filefilter.AgeFileFilter;
import static org.apache.commons.io.filefilter.TrueFileFilter.TRUE;

// a Date defined somewhere for the cutoff date
Date thresholdDate = <the oldest age you want to keep>;

public void DeleteFiles(File file) {
    Iterator<File> filesToDelete =
        FileUtils.iterateFiles(file, new AgeFileFilter(thresholdDate), TRUE);
    for (File aFile : filesToDelete) {
        aFile.delete();
    }
} 
```

**更新：**要使用编辑中给出的值，请将其定义`thresholdDate`为：

```
Date tresholdDate = new Date(1361635382096L); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-02-04T19:57:44.293

使用 Apache utils 可能是最简单的。这是我能想到的最简单的解决方案。

```
public void deleteOldFiles() {
    Date oldestAllowedFileDate = DateUtils.addDays(new Date(), -3); //minus days from current date
    File targetDir = new File("C:\\TEMP\\archive\\");
    Iterator<File> filesToDelete = FileUtils.iterateFiles(targetDir, new AgeFileFilter(oldestAllowedFileDate), null);
    //if deleting subdirs, replace null above with TrueFileFilter.INSTANCE
    while (filesToDelete.hasNext()) {
        FileUtils.deleteQuietly(filesToDelete.next());
    }  //I don't want an exception if a file is not deleted. Otherwise use filesToDelete.next().delete() in a try/catch
} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-09-09T01:51:24.637

# 使用 Java 8 的 Time API 的示例

```
LocalDate today = LocalDate.now();
LocalDate eailer = today.minusDays(30);

Date threshold = Date.from(eailer.atStartOfDay(ZoneId.systemDefault()).toInstant());
AgeFileFilter filter = new AgeFileFilter(threshold);

File path = new File("...");
File[] oldFolders = FileFilterUtils.filter(filter, path);

for (File folder : oldFolders) {
    System.out.println(folder);
} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2018-09-14T18:04:12.993

这是使用 Time API 的 Java 8 版本。它已经在我们的项目中经过测试和使用：

```
 public static int deleteFiles(final Path destination,
        final Integer daysToKeep) throws IOException {

    final Instant retentionFilePeriod = ZonedDateTime.now()
            .minusDays(daysToKeep).toInstant();

    final AtomicInteger countDeletedFiles = new AtomicInteger();
    Files.find(destination, 1,
            (path, basicFileAttrs) -> basicFileAttrs.lastModifiedTime()
                    .toInstant().isBefore(retentionFilePeriod))
            .forEach(fileToDelete -> {
                try {
                    if (!Files.isDirectory(fileToDelete)) {
                        Files.delete(fileToDelete);
                        countDeletedFiles.incrementAndGet();
                    }
                } catch (IOException e) {
                    throw new UncheckedIOException(e);
                }
            });

    return countDeletedFiles.get();
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2017-10-17T13:43:14.113

# 使用 lambdas (Java 8+)

**非递归选项，用于删除当前文件夹中超过 N 天的所有文件（忽略子文件夹）：**

```
public static void deleteFilesOlderThanNDays(int days, String dirPath) throws IOException {
    long cutOff = System.currentTimeMillis() - (days * 24 * 60 * 60 * 1000);
    Files.list(Paths.get(dirPath))
    .filter(path -> {
        try {
            return Files.isRegularFile(path) && Files.getLastModifiedTime(path).to(TimeUnit.MILLISECONDS) < cutOff;
        } catch (IOException ex) {
            // log here and move on
            return false;
        }
    })
    .forEach(path -> {
        try {
            Files.delete(path);
        } catch (IOException ex) {
            // log here and move on
        }
    });
} 
```

**递归选项，遍历子文件夹并删除所有超过 N 天的文件：**

```
public static void recursiveDeleteFilesOlderThanNDays(int days, String dirPath) throws IOException {
    long cutOff = System.currentTimeMillis() - (days * 24 * 60 * 60 * 1000);
    Files.list(Paths.get(dirPath))
    .forEach(path -> {
        if (Files.isDirectory(path)) {
            try {
                recursiveDeleteFilesOlderThanNDays(days, path.toString());
            } catch (IOException e) {
                // log here and move on
            }
        } else {
            try {
                if (Files.getLastModifiedTime(path).to(TimeUnit.MILLISECONDS) < cutOff) {
                    Files.delete(path);
                }
            } catch (IOException ex) {
                // log here and move on
            }
        }
    });
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-11-15T22:39:31.977

对于同时使用 NIO 文件流和 JSR-310 的 JDK 8 解决方案

```
long cut = LocalDateTime.now().minusWeeks(1).toEpochSecond(ZoneOffset.UTC);
Path path = Paths.get("/path/to/delete");
Files.list(path)
        .filter(n -> {
            try {
                return Files.getLastModifiedTime(n)
                        .to(TimeUnit.SECONDS) < cut;
            } catch (IOException ex) {
                //handle exception
                return false;
            }
        })
        .forEach(n -> {
            try {
                Files.delete(n);
            } catch (IOException ex) {
                //handle exception
            }
        }); 
```

这里最糟糕的是需要在每个 lambda 中处理异常。`UncheckedIOException`如果 API为每个 IO 方法提供重载，那就太好了。有了帮手来做这件事，一个人可以写：

```
public static void main(String[] args) throws IOException {
    long cut = LocalDateTime.now().minusWeeks(1).toEpochSecond(ZoneOffset.UTC);
    Path path = Paths.get("/path/to/delete");
    Files.list(path)
            .filter(n -> Files2.getLastModifiedTimeUnchecked(n)
                    .to(TimeUnit.SECONDS) < cut)
            .forEach(n -> {
                System.out.println(n);
                Files2.delete(n, (t, u)
                              -> System.err.format("Couldn't delete %s%n",
                                                   t, u.getMessage())
                );
            });
}

private static final class Files2 {

    public static FileTime getLastModifiedTimeUnchecked(Path path,
            LinkOption... options)
            throws UncheckedIOException {
        try {
            return Files.getLastModifiedTime(path, options);
        } catch (IOException ex) {
            throw new UncheckedIOException(ex);
        }
    }

    public static void delete(Path path, BiConsumer<Path, Exception> e) {
        try {
            Files.delete(path);
        } catch (IOException ex) {
            e.accept(path, ex);
        }
    }

} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2020-05-19T03:00:19.190

JavaSE 规范解决方案。删除`expirationPeriod`几天前的文件。

```
private void cleanUpOldFiles(String folderPath, int expirationPeriod) {
    File targetDir = new File(folderPath);
    if (!targetDir.exists()) {
        throw new RuntimeException(String.format("Log files directory '%s' " +
                "does not exist in the environment", folderPath));
    }

    File[] files = targetDir.listFiles();
    for (File file : files) {
        long diff = new Date().getTime() - file.lastModified();

        // Granularity = DAYS;
        long desiredLifespan = TimeUnit.DAYS.toMillis(expirationPeriod); 

        if (diff > desiredLifespan) {
            file.delete();
        }
    }
} 
```

例如 - 删除文件夹“/sftp/logs”中所有超过 30 天的文件调用：

`cleanUpOldFiles("/sftp/logs", 30);`

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-02-23T16:47:13.647

您可以使用 NIO 获取文件的创建日期，方法如下：

```
BasicFileAttributes attrs = Files.readAttributes(file, BasicFileAttributes.class);
System.out.println("creationTime: " + attrs.creationTime()); 
```

更多信息可以在这里找到：http: [//docs.oracle.com/javase/tutorial/essential/io/fileAttr.html](http://docs.oracle.com/javase/tutorial/essential/io/fileAttr.html)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-07-31T12:59:33.800

Apache commons-io 和 joda 的另一种方法：

```
private void deleteOldFiles(String dir, int daysToRemainFiles) {
    Collection<File> filesToDelete = FileUtils.listFiles(new File(dir),
            new AgeFileFilter(DateTime.now().withTimeAtStartOfDay().minusDays(daysToRemainFiles).toDate()),
            TrueFileFilter.TRUE);    // include sub dirs
    for (File file : filesToDelete) {
        boolean success = FileUtils.deleteQuietly(file);
        if (!success) {
            // log...
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-01-17T15:25:46.367

# 使用带有 lambda 和 Commons IO 的 Java NIO 文件

```
final long time = System.currentTimeMillis();
// Only show files & directories older than 2 days
final long maxdiff = TimeUnit.DAYS.toMillis(2); 
```

列出所有找到的文件和目录：

```
Files.newDirectoryStream(Paths.get("."), p -> (time - p.toFile().lastModified()) < maxdiff)
.forEach(System.out::println); 
```

[或使用FileUtils](https://commons.apache.org/proper/commons-io/javadocs/api-2.5/org/apache/commons/io/FileUtils.html)删除找到的文件：

```
Files.newDirectoryStream(Paths.get("."), p -> (time - p.toFile().lastModified()) < maxdiff)
.forEach(p -> FileUtils.deleteQuietly(p.toFile())); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-08-11T10:18:16.843

这是删除六个月以来未修改的文件并创建日志文件的代码。

```
package deleteFiles;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.logging.FileHandler;
import java.util.logging.Logger;
import java.util.logging.SimpleFormatter;

public class Delete {
    public static void deleteFiles()
    {
        int numOfMonths = -6;
        String path="G:\\Files";
        File file = new File(path);
        FileHandler fh;
        Calendar sixMonthAgo = Calendar.getInstance();
        Calendar currentDate = Calendar.getInstance();
        Logger logger = Logger.getLogger("MyLog");
        sixMonthAgo.add(Calendar.MONTH, numOfMonths);
        File[] files = file.listFiles();
        ArrayList<String> arrlist = new ArrayList<String>();

        try {
            fh = new FileHandler("G:\\Files\\logFile\\MyLogForDeletedFile.log");
            logger.addHandler(fh);
            SimpleFormatter formatter = new SimpleFormatter();
            fh.setFormatter(formatter);

            for (File f:files)
            {
                if (f.isFile() && f.exists())
                {
                    Date lastModDate = new Date(f.lastModified());
                    if(lastModDate.before(sixMonthAgo.getTime()))
                    {
                        arrlist.add(f.getName());
                        f.delete();
                    }
                }
            }
            for(int i=0;i<arrlist.size();i++)
                logger.info("deleted files are ===>"+arrlist.get(i));
        }
        catch ( Exception e ){
            e.printStackTrace();
            logger.info("error is-->"+e);
        }
    }
    public static void main(String[] args)
    {
        deleteFiles();
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-07-07T19:04:21.657

需要指出列出的第一个解决方案的一个错误，如果 x 很大，x * 24 * 60 * 60 * 1000 将最大化 int 值。所以需要将其转换为长值

```
long diff = new Date().getTime() - file.lastModified();

if (diff > (long) x * 24 * 60 * 60 * 1000) {
    file.delete();
} 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2015-12-16T21:57:08.470

使用 Apache commons-io 和 joda：

```
 if ( FileUtils.isFileOlder(f, DateTime.now().minusDays(30).toDate()) ) {
            f.delete();
        } 
```

# android - 将复选框中的值分配给不完整的变量

> ID：15042857
> 
> 赞同：0
> 
> 时间：2013-02-23T16:39:17.067
> 
> 标签：android

抱歉，如果有人问过这个问题，我搜索了但没有找到任何东西。我正在android中制作一个表格，并且有一些复选框，如果它们被选中，我想传递它们。所以我制作了复选框并将视图投射到复选框，因此它将检查我单击的任何复选框（尚未添加复选框侦听器）。问题是，当它确定选中了一个复选框时，我想让该框的布尔值为真

例如，当您勾选购买复选框时，我希望将 isbuyable 布尔值设置为 true。如果不使用许多 if 语句来设置每个语句，这是否可能？我创建了字符串变量 nameofboolean，它是用于更改状态的布尔值的名称，但不确定现在如何在没有大量 IF 语句检查每个语句的情况下实际更改该布尔值。

编辑：为了澄清，我想要的只是在选中复选框时将与每个复选框匹配的布尔值设置为 true。如果可能的话，我只是不想使用很多 IF 来做到这一点。

```
package com.Assist.assistme;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.CheckBox;
import android.widget.CompoundButton;
import android.widget.Spinner;
import android.widget.TextView;

public class market extends Activity implements OnItemSelectedListener
{
//UI elements
TextView choose;
Spinner list;
TextView buyrent;
CheckBox buyable;
CheckBox rentable;
TextView type;
CheckBox hard;
CheckBox soft;
CheckBox ebook;
TextView condition;
CheckBox new_book;
CheckBox used_book;
Button search;

String course_chosen;
Boolean isbuyable;
Boolean isrentable;
Boolean ishard;
Boolean issoft;
Boolean isebook;
Boolean isnew_book;
Boolean isused_book;

@Override
protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.market);

    iteminit();

    OnClickListener checkboxlistener = new OnClickListener()
    {

        @Override
        public void onClick(View v) 
        {
            if(((CheckBox) v).isChecked())
            {
                String nameofboolean = "is" + v.toString();

            }

        }

    };

}

private void iteminit() 
{
    choose = (TextView)findViewById(R.id.market_choose);
    buyrent = (TextView)findViewById(R.id.market_buyrent);
    buyable = (CheckBox)findViewById(R.id.market_buy);
    rentable = (CheckBox)findViewById(R.id.market_rent);
    type = (TextView)findViewById(R.id.market_type);
    hard = (CheckBox)findViewById(R.id.market_hardcover);
    soft = (CheckBox)findViewById(R.id.market_softcover);
    ebook = (CheckBox)findViewById(R.id.market_ebook);
    condition = (TextView)findViewById(R.id.market_condition);
    new_book = (CheckBox)findViewById(R.id.market_new);
    used_book = (CheckBox)findViewById(R.id.market_used);
    search = (Button)findViewById(R.id.market_search);

    list = (Spinner)findViewById(R.id.market_list);
    ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this,
            R.array.course_choices, android.R.layout.simple_spinner_item);                 adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    list.setAdapter(adapter);
    list.setOnItemSelectedListener(this);

}

@Override
public void onItemSelected(AdapterView<?> parent, View view, int pos,
        long id) 
{
    course_chosen = parent.getItemAtPosition(pos).toString();

}
@Override
public void onNothingSelected(AdapterView<?> arg0) 
{

} 
```

}

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:06:36.193

如果我理解你的问题，你想要这样的东西

```
CheckBox buyable,rentable,hard,soft,ebook,condition,new_book,used_book;
CheckBox[] checklist={ buyable,rentable,hard,soft,ebook,condition,new_book,used_book};
int ids[]={R.id.market_buy,R.id.market_rent,R.id.market_hardcover,R.id.market_softcover,R.id.market_ebook,R.id.market_new,R.id.market_used}; 
```

在设置 contentView 后的 onCreate

```
for(int i=0;i<checklist.length;i++)
{
checklist[i]=findViewById(ids[i]);
} 
```

像这样调用这个方法

```
String data=getAllcheckedValues(); 
```

获取所有选中的值

```
public String getAllCheckedValues()
{
String checkItems="";
for(int i=0;i<checklist.length;i++)
{
if(checklist[i].isChecked())
{
checkItems+=checkItems+checklist[i].getText()+"is Checked"+"\n";
}
}
return checkItems;
} 
```

根据您的要求格式化字符串。

# android - 使用 ArrayAdapter 过滤 ListView 而不覆盖 getFilter 方法

> ID：15042860
> 
> 赞同：3
> 
> 时间：2013-02-23T16:39:27.003
> 
> 标签：android, android-listview, android-arrayadapter

在这个 Stackoverflow[答案](https://stackoverflow.com/questions/2718202/custom-filtering-in-android-using-arrayadapter#answer-9418457)中，表明过滤可以在 a 中完成，`ListView`而无需覆盖 的`getFilter`方法，`ArrayAdapter`而是`toString`在`POJO`类中实现。

我已经尝试实现它，但过滤无法正常工作。尽管`ListView`确实过滤了，但它没有在数组中显示正确的项目。因此，例如，如果过滤器与 中的单行匹配，则在 中`array`显示一个项目`ListView`，但显示的是错误的项目。在这种情况下，始终显示数组的第一项，而不是实际匹配输入的搜索文本的项。

这是我的代码`ArrayAdapter`：

```
public class TitleListingArrayAdapter extends ArrayAdapter<Title> {

    private List<Title> items;
    private Context context;

    public TitleListingArrayAdapter(Context context, int textViewResourceId, List<Title> items) {
        super(context, textViewResourceId, items);
        this.items = items;
        this.context = context;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) 
    {
        View view = convertView;
        if (view == null) {
            LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            view = inflater.inflate(R.layout.titlelisting_single_row, null);
        }
        Title item = items.get(position);
        if (item!= null) {
            TextView titleView = (TextView) view.findViewById(R.id.title);            
            if (titleView != null) {
                titleView.setText(item.getName());
            }
            TextView yearView = (TextView) view.findViewById(R.id.year);
            if (yearView != null) {
                yearView.setText(String.valueOf(item.getYear())+", ");
            }
            TextView genreView = (TextView) view.findViewById(R.id.genre);
            if (genreView != null) {
                genreView.setText(item.getGenre());
            }
            TextView authorView = (TextView) view.findViewById(R.id.author);
            if (authorView != null) {
                authorView.setText(item.getAuthor());
            }
            RatingBar ratingView = (RatingBar) view.findViewById(R.id.rating);
            if (ratingView != null) {
                ratingView.setRating(item.getRating());
            }
            ImageView iconView = (ImageView) view.findViewById(R.id.list_image);
            iconView.setImageResource(lookupResourceId(context, item.getID()));            
        }
        return view;
    }

    private int lookupResourceId(Context context, String id) {
        String resourceName =  "thumb_"+id;
        return context.getResources().getIdentifier(resourceName, "drawable", context.getPackageName());
    }
} 
```

这是我的`Activity`代码的相关部分：

```
 @Override
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.listing);
    databaseHandler = new DatabaseHandler(this);
    listView = (ListView) findViewById(R.id.list);
    List<Title> titles = databaseHandler.getAllTitles();
    adapter = new TitleListingArrayAdapter(this, R.id.list, titles);
    listView.setAdapter(adapter);
    filterText = (EditText) findViewById(R.id.filter);
    filterText.addTextChangedListener(filterTextWatcher);
}

private TextWatcher filterTextWatcher = new TextWatcher() {
    public void afterTextChanged(Editable s) {}
    public void beforeTextChanged(CharSequence s, int start, int count, int after) {}
    public void onTextChanged(CharSequence s, int start, int before, int count) {
        adapter.getFilter().filter(s.toString().toLowerCase());
    }
}; 
```

Title`POJO`类实现 toString 如下：

```
@Override
public String toString() {
    String name = this.getName() == null ? "" : this.getName().toLowerCase();
    String year = this.getYear() == null ? "" : this.getYear().toString();
    String genre = this.getGenre() == null ? "" : this.getGenre().toLowerCase();
    return name + " " +year+ " "+ genre;
} 
```

有谁知道为什么过滤不能正常工作以及我该如何解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T21:36:35.957

以下[问题](https://stackoverflow.com/questions/10704037/arrayadapter-filter-return-wrong-items)涉及与我遇到的完全相同的问题。这个问题还给出了过滤的示例，通过不显示列表中的正确项目来显示正确的项目*数量。*

所以看起来这个[答案](https://stackoverflow.com/questions/2718202/custom-filtering-in-android-using-arrayadapter#answer-9418457)是错误的，尽管被投票了六次。我通过根本不使用的`getFilter`方法解决了这个问题`ArrayAdapter`。`ArrayAdapter`相反，我在我的实例中创建一个新的`TextWatcher`，如下所示：

```
private TextWatcher filterTextWatcher = new TextWatcher() {
     public void afterTextChanged(Editable s) {}
     public void beforeTextChanged(CharSequence s, int start, int count, int after) {}
     public void onTextChanged(CharSequence s, int start, int before, int count) {
         if (!s.toString().equals("")) {
              List<Title> filteredTitles = new ArrayList<Title>();
              for (int i=0; i<titles.size(); i++) {
                   if (titles.get(i).toString().contains(s)) {
                       filteredTitles.add(titles.get(i));                   
                   }            
              }
              adapter = new TitleListingArrayAdapter(TitleListingActivity.this, R.id.list, filteredTitles);
              listView.setAdapter(adapter);
         }
         else {
              adapter = new TitleListingArrayAdapter(TitleListingActivity.this, R.id.list, titles);
              listView.setAdapter(adapter);             
         }
    }
}; 
```

请注意，我还将声明`List<Title> titles`移出`onCreate`并使其成为我的`Activity`类的成员变量，以便可以`onTextChanged`在`filterTextWatcher`.

# cloud-foundry - CloudFoundry nodeJS 教程过时了？

> ID：15042862
> 
> 赞同：0
> 
> 时间：2013-02-23T16:39:38.647
> 
> 标签：cloud-foundry

我正在关注[nodeJS 教程](http://docs.cloudfoundry.com/frameworks/nodejs/nodejs.html)，当我将应用程序推送到 Cloudfoundry.com 时，教程中的推送流程与我看到的推送流程非常不同。我使用 vmc 0.999，这就是我所看到的：

> 名称>你好节点
> 
> 实例> 1
> 
> 1：节点 2：其他框架>节点
> 
> 1：节点 2：node06 3：node08 4：其他 Runtime> 3
> 
> 1：64M 2：128M 3：256M 4：512M 5：1G 6：2G 内存限制>64M
> 
> 创建 ido-hello-node... 好的
> 
> 1：ido-hello-node.cloudfoundry.com 2：无 URL> ido-hello-node.cloudfoundry.com
> 
> 正在更新 ido-hello-node... 好的
> 
> 为应用程序创建服务？> n
> 
> 保存配置？> y
> 
> 保存到 manifest.yml... OK 上传 ido-hello-node... OK 使用清单文件 manifest.yml
> 
> 正在启动 ido-hello-node... OK 检查 ido-hello-node

我做错了什么还是教程已经过时了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:05:49.097

看起来您的应用程序已成功推送。运行它有问题吗？

vmc 命令正在更改，您引用的文档可能已过时。正在此处创建和发布新文档：http: [//cloudfoundry.github.com/docs/using/deploying-apps/javascript/](http://cloudfoundry.github.com/docs/using/deploying-apps/javascript/)。这些文档是一个正在进行中的工作，但是是最新的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T16:27:48.867

没有 vmc 0.999，所以我不确定您实际拥有的版本 - 目前的最新版本（通过键入“gem install vmc --pre”获得）是 vmc-0.5.0-rc1。您可以使用“vmc --version”检查您拥有的版本

[是的， http](http://docs.cloudfoundry.com) ://docs.cloudfoundry.com 上的教程已经过时，我们正忙于[http://cloudfoundry.github.com](http://cloudfoundry.github.com)上的更新版本。

你可以在这里找到最新的 Node 教程：http: [//cloudfoundry.github.com/docs/using/deploying-apps/javascript/](http://cloudfoundry.github.com/docs/using/deploying-apps/javascript/)

如果您发现任何错误或想提出补充建议，请随时通过发送 Github 拉取请求做出贡献。

# r - 使用ggplot2的龙卷风图，按bin-count降序排列

> ID：15042864
> 
> 赞同：1
> 
> 时间：2013-02-23T16:39:50.233
> 
> 标签：r, ggplot2, histogram

我正在寻找一种使用 ggplot2创建[龙卷风图的方法。](http://en.wikipedia.org/wiki/Tornado_diagram)[geom_linerange](http://docs.ggplot2.org/current/geom_linerange.html)的例子很接近：

```
library(ggplot2)
dmod <- lm(price ~ cut, data=diamonds)
cuts <- data.frame(cut=unique(diamonds$cut),
          predict(dmod, data.frame(cut = unique(diamonds$cut)),
          se=TRUE)[c("fit","se.fit")])
se <- ggplot(cuts, aes(cut, fit, ymin = fit - se.fit,
        ymax=fit + se.fit, colour = cut))+ geom_linerange(size=2) + coord_flip()
se 
```

但是线条应该按长度降序排列，即顶部最宽的范围。我不知道如何实现这一目标。

谢谢，

托尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T18:34:23.050

要更改因子的绘制顺序，您需要更改因子水平的顺序。有几种方法可以做到这一点。我更喜欢使用`factor(..., levels=new_levels)`. 在您的情况下，您想使用 cut$se.fit 重新排序级别。

以下代码有点难看，但它完成了工作：

```
cuts$cut = factor(as.character(cuts$cut), 
                  levels=levels(cuts$cut)[order(cuts$se.fit, decreasing=TRUE)]) 
```

![在此处输入图像描述](../Images/08ec7ec60deb8dff18f749668994d161.png)

# facebook - 从画布应用程序内部更改 Facebook URL

> ID：15042867
> 
> 赞同：3
> 
> 时间：2013-02-23T16:40:31.430
> 
> 标签：facebook, facebook-javascript-sdk, facebook-apps

我正在使用 JS SDK 构建一个单页 Facebook Canvas 应用程序。

应用程序内的导航不需要新的完整 HTTP 请求，所以我想知道如何更改“主要”facebook URL (http://apps.facebook.com/my_app/[URL])。

更改浏览器 URL 我所能做的就是调用

```
parent.location.href = 'http://apps.facebook.com/my_app/[SOME_URL]' 
```

但这当然会重新加载整个页面，这并不是我想要做的。我看到很多关于这个的未回答的问题，是否存在 JS SDK 技巧或类似的东西，因为出于安全考虑，禁止从应用程序框架内部访问所有历史记录/位置，或者这只是我们永远无法做到的事情？

# ios - NSMutableArray 不添加对象

> ID：15042870
> 
> 赞同：3
> 
> 时间：2013-02-23T16:40:38.867
> 
> 标签：ios, objective-c, count, nsmutablearray

我想，我犯了一个非常基本的错误，但我正在使用 an`NSMutableArray`并且这不会以某种方式添加对象，我正在按照它的方式发送它。我有一个属性（并合成）

```
@property (nonatomic, strong) NSMutableArray *kpiStorage; 
```

进而：

```
ExampleObject *obj1 = [[ExampleObject alloc] init];
[kpiStorage addObject:obj1];
ExampleObject *obj2 =  [[ExampleObject alloc] init];
[kpiStorage addObject:obj2];

NSLog(@"kpistorage has:%@", [kpiStorage count]); 
```

并且总是在控制台中返回 (null)。我有什么误解？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-23T16:47:22.217

确保为 kpiStorage 分配了内存。

```
self.kpiStorage = [[NSMutableArray alloc] init]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-23T16:51:23.473

除了忘记为 NSMutableArray 分配内存之外，您的 NSLog 格式也是错误的。当你运行它时，你的应用程序会崩溃。需要进行以下更改

您将需要添加

```
self.kpiStorage = [[NSMutableArray alloc] init]; 
```

并将您的 NSLog 更改为以下内容

```
NSLog(@"kpistorage has:%d", [self.kpiStorage count]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T18:47:45.393

如果您不使用 ARC，请确保您不应该在项目中造成内存泄漏。所以更好的方法是像这样分配

```
NSMutableArray *array = [[NSMutableArray alloc] init];
self.kpiStorage = array;
[array release]; 
```

养成不直接做的习惯

> self.kpiStorage = [[NSMutableArray alloc] init];

在这种情况下，您的财产的保留计数增加 2。为了进一步阅读，您可以[在保留财产时防止内存泄漏](https://stackoverflow.com/questions/13953716/memory-leak-when-retaining-property)

# javascript - 在 Wordpress 中的其他脚本之后加载 JQuery UI

> ID：15042871
> 
> 赞同：0
> 
> 时间：2013-02-23T16:40:41.273
> 
> 标签：javascript, jquery, fancybox, nivo-slider

我正在使用一个正在使用 fancybox 的插件。但是在控制台中它有错误

读取未定义的属性 msie。

我认为这与我在 wordpress 函数文件中调用的 NivoSlider 有关，如下所示：-

```
<?php if (!is_admin()) add_action("wp_enqueue_scripts", "my_jquery_enqueue", 11);

function my_jquery_enqueue() {

wp_deregister_script('jquery');

        wp_register_script('jquery', 'http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js', false, null, false);

        wp_enqueue_script('jquery');

wp_register_script( 'jquery-ui', get_template_directory_uri().'/js/jquery-ui.min.js', array('jquery'), false, null, false);

wp_enqueue_script( 'jquery-ui' );

wp_register_script( 'nivoslider', get_template_directory_uri().'/js/jquery.nivo.slider.pack.js', array('jquery'), null, false);

wp_enqueue_script( 'nivoslider' );

wp_register_script( 'nq', get_template_directory_uri().'/js/nqmedia.js', array('jquery'), null, false);

wp_enqueue_script( 'nq' );

}

?> 
```

网站是 www.nqmedia.co.uk

谁能告诉我这两个为什么会发生冲突？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:47:40.670

您的网站使用的是 jQuery 1.9.1

在 jQuery >= 1.9 中删除了 jQuery.browser（或 $.browser）（参见此处：[http](http://api.jquery.com/jQuery.browser/) ://api.jquery.com/jQuery.browser/ ）

fancybox 插件正在使用 $.browser.msie （其中 $.browser 未定义）

如果你想使用那个fancybox插件，你需要使用jQuery 1.8.3，或者重写插件

# ios - 理想情况下，我应该如何创建结构良好的 UITableViewDataSource？

> ID：15042873
> 
> 赞同：2
> 
> 时间：2013-02-23T16:40:50.033
> 
> 标签：ios, nsarray, nsdictionary, conceptual

我有一`NSArray`首从服务器获取的歌曲。那是我的原始数据源。该数组包含具有`NSDictionary`和`NSArray`作为后端的自定义对象。

我想知道使用 an 来实现格式化的数据源`NSDictionary`是否明智。字典将部分标题作为键，并且某个键的值将`NSArray`包含该部分的行。

我将遍历我的原始数据源并将其按字母顺序排列到字典中。

我有一种感觉，这不是一个可靠的实现，而且非常昂贵。还有比这更可靠的实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T20:33:17.930

对于小表，而不是`NSDictionary`，我通常使用`NSArray`，因为字典不保留顺序（而且您可能不想不断地重新排序）。所以我通常有一个节数组，对于每个节条目，我至少有一个节标题和一个行数组。我的行数组具有我需要呈现给定行的信息（例如行的文本等）。

单独的行和部分对象，您可以将它们实现为`NSDictionary`对象本身（有时在从 JSON 或 XML 解析数据时，这是最简单的），但我通常定义自己的对象`Row`和`Section`对象，例如：

```
@interface Row : NSObject

@property (nonatomic, strong) NSString *title;
@property (nonatomic, strong) NSString *subtitle;

@end 
```

和

```
@interface Section : NSObject

@property (nonatomic, strong) NSString *title;
@property (nonatomic, strong) NSMutableArray *rows;

@end 
```

然后我的表视图控制器有一个`NSArray`部分：

```
@property (nonatomic, strong) NSMutableArray *sections; 
```

我像这样填充它：

```
self.sections = [NSMutableArray array];

Section *sectionObject;

sectionObject = [[Section alloc] initWithTitle:@"Marx Brothers" rows:nil];
[sectionObject.rows addObject:[[Row alloc] initWithTitle:@"Chico"   subtitle:@"Leonard Marx"]];
[sectionObject.rows addObject:[[Row alloc] initWithTitle:@"Harpo"   subtitle:@"Adolph Marx"]];
[sectionObject.rows addObject:[[Row alloc] initWithTitle:@"Groucho" subtitle:@"Julius Henry Marx"]];
[sectionObject.rows addObject:[[Row alloc] initWithTitle:@"Zeppo"   subtitle:@"Herbert Manfred Marx"]];
[self.sections addObject:sectionObject];

sectionObject = [[Section alloc] initWithTitle:@"Three Stooges" rows:nil];
[sectionObject.rows addObject:[[Row alloc] initWithTitle:@"Moe"   subtitle:@"Moses Harry Horwitz"]];
[sectionObject.rows addObject:[[Row alloc] initWithTitle:@"Larry" subtitle:@"Louis Feinberg"]];
[sectionObject.rows addObject:[[Row alloc] initWithTitle:@"Curly" subtitle:@"Jerome Lester \"Jerry\" Horwitz"]];
[self.sections addObject:sectionObject]; 
```

然后我有典型的`UITableViewDataSource`方法：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return [self.sections count];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    Section *sectionObject = self.sections[section];
    return [sectionObject.rows count];
}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section
{
    Section *sectionObject = self.sections[section];
    return sectionObject.title;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"Cell"];

    Section *sectionObject = self.sections[indexPath.section];
    Row *rowObject = sectionObject.rows[indexPath.row];

    cell.textLabel.text = rowObject.title;
    cell.detailTextLabel.text = rowObject.subtitle;

    return cell;
} 
```

对于更大的数据库数据驱动表，我可能不会将数据保存在数组中，而是使用 Core Data 或 SQLite，但想法是一样的。确保我的类`Section`和`Row`类可以使我的表视图控制器代码不言自明，并与数据实现的细节隔离开来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:46:41.963

你试过 RestKit 吗？您只需要提供 json 编码对象的来源并创建模型类

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T17:24:04.360

您可以使用**模型类**，然后使用来自服务器的数据创建此模型类的对象。然后使用模型类对象数组作为 UITableView 的源。
您还可以考虑**core-data**，在其中创建数据模型和关系非常容易。但是，它带有许多附加功能，这对您来说可能是额外的负担。

# c# - 使用 jeditable 添加内联编辑 - jquery

> ID：15042876
> 
> 赞同：0
> 
> 时间：2013-02-23T16:41:05.400
> 
> 标签：c#, jquery, asp.net-mvc, jeditable

我正在按照教程进行内联编辑。我正在关注的教程[如下](http://www.codeproject.com/Articles/265211/Using-JEditable-plugin-as-ASP-NET-MVC3-jQuery-inli)；

```
@model MyPro.Models.MyMod

@{
    ViewBag.Title = "Test";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="~/Scripts/jquery.jeditable.js" type="text/javascript"></script>

 $(".display-label").editable("/Contr/TestMethod");

@using (Html.BeginForm())
{

    <div class="field">
        <div class="display-label" id="lblHi">Hi</div>
    </div>

... 
```

现在，当我双击标签时，它无法编辑。为什么是这样 ？我是否正确添加了脚本标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T23:22:55.647

我没有使用 C#，但只想分享几个建议：

1）尝试添加脚本打开/关闭标签：

```
<script type="text/javascript">
$(".display-label").editable("/Contr/TestMethod");
</script> 
```

2) 将脚本添加到 $.ready 部分

```
<script type="text/javascript">
  $(document).ready(function() {
    $(".display-label").editable("/Contr/TestMethod");
  })
</script> 
```

3) 确保你已经加载了 jQuery 本身。这是 jQuery 插件，因此在这种情况下需要 jQuery。

# mysql - 如何更新具有某些字段的表？

> ID：15042877
> 
> 赞同：-1
> 
> 时间：2013-02-23T16:41:06.137
> 
> 标签：mysql, sql-update, multiple-columns

我有一个带有两个副本的 MySQL 表（一个在本地服务器中，一个在 Web 主机中），我想更新我的本地服务器中的**一些**字段，而不是**只**更新我的 Web 主机中的那些值。所以说我的桌子就像

本地主机中的表，最初：

```
 id   username   money
---- ---------- -------
 1     user_01     0
 2     user2       0 
```

网络主机中的表格，最初：

```
 id   username   money
---- ---------- -------
 1     user_01   1000
 2     user2     2000 
```

比我想将`username`user_01 更改为*user1*并更新 Web 数据库，但**不**更改`money`字段

本地主机中的表，更改后：

```
 id   username   money
---- ---------- -------
 1     user1       0
 2     user2       0 
```

&

```
query -> ???? 
```

更改后我想要在 Web 服务器中的表：

```
 id   username   money
---- ---------- -------
 1     user1     1000
 2     user2     2000 
```

我试图删除表并从头开始创建它，但随后货币价值变为 0，我想避免这种情况。

那么我应该使用什么查询/导出类型（在 phpMyAdmin 或其他中）来仅更新某些字段？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:42:43.963

不是这样吗？

```
UPDATE  localhost
SET     username = 'user'
WHERE   username = 'user_01' 
```

或者

```
UPDATE  localhost
SET     username = REPLACE(username, '_0', '')
WHERE   username LIKE '%\_0%' 
```

*   [expr LIKE pat [ESCAPE 'escape_char']](http://dev.mysql.com/doc/refman/5.0/en/string-comparison-functions.html#operator_like)

# java - Java字符对齐算法

> ID：15042879
> 
> 赞同：8
> 
> 时间：2013-02-23T16:41:28.890
> 
> 标签：java, algorithm

我有两个要对齐的 100 个字符的数组（最大，可以小于或不同的大小）。当字符与另一个字符不同时，我想添加一个“-”。我发现了基于动态规划的[Needleman-Wunsch](http://en.wikipedia.org/wiki/Needleman%E2%80%93Wunsch_algorithm)算法和基于动态规划的通用局部对齐方法[Smith-Waterman](http://en.wikipedia.org/wiki/Smith%E2%80%93Waterman_algorithm)算法，但它们对于我想做的事情来说似乎太复杂了。我只需要一个简单的Java算法，大概不到50行，这段代码会被翻译成汇编语言，所以我需要一个简单的算法。

有没有办法用 diff 算法进行这种对齐？如果是的话，有人可以指出我该怎么做吗？我在 biostar 部分进行了搜索，但似乎我需要使用我提到的两种算法。

英语不是我的母语，所以也许我搜索了错误的关键字。

我的程序已经使用 Needleman 算法及其大约 200 行（ish）代码。

所需输入/输出示例：

```
Input
Array 1 : MKNLASREVNIYVNGKLV
Array 2 : QMASREVNIYVNGKL

Output
Array 1 (or a simple print) : -MKNLASREVNIYVNGKLV 
Array 2 (or a simple print) : QM---ASREVNIYVNGKL- 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-23T17:36:36.447

使用完全符合您要求的 Levenshtein 距离的变体：

输出

```
-MKNLASREVNIYVNGKLV
QM---ASREVNIYVNGKL- 
```

代码：

```
public class Main {
    public static void main(String[] args) {
        String[] aligned = align("MKNLASREVNIYVNGKLV", "QMASREVNIYVNGKL");
        System.out.println(aligned[0]);
        System.out.println(aligned[1]);
    }

    public static String[] align(String a, String b) {
        int[][] T = new int[a.length() + 1][b.length() + 1];

        for (int i = 0; i <= a.length(); i++)
            T[i][0] = i;

        for (int i = 0; i <= b.length(); i++)
            T[0][i] = i;

        for (int i = 1; i <= a.length(); i++) {
            for (int j = 1; j <= b.length(); j++) {
                if (a.charAt(i - 1) == b.charAt(j - 1))
                    T[i][j] = T[i - 1][j - 1];
                else
                    T[i][j] = Math.min(T[i - 1][j], T[i][j - 1]) + 1;
            }
        }

        StringBuilder aa = new StringBuilder(), bb = new StringBuilder();

        for (int i = a.length(), j = b.length(); i > 0 || j > 0; ) {
            if (i > 0 && T[i][j] == T[i - 1][j] + 1) {
                aa.append(a.charAt(--i));
                bb.append("-");
            } else if (j > 0 && T[i][j] == T[i][j - 1] + 1) {
                bb.append(b.charAt(--j));
                aa.append("-");
            } else if (i > 0 && j > 0 && T[i][j] == T[i - 1][j - 1]) {
                aa.append(a.charAt(--i));
                bb.append(b.charAt(--j));
            }
        }

        return new String[]{aa.reverse().toString(), bb.reverse().toString()};
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T17:14:17.877

你对问题的描述立刻让我想到了[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)及其相关算法，它很简单（绝对少于 50 行）但也是基于动态编程的。

原始算法只是计算所需的更改次数，但可以轻松修改它以找到所需的插入、删除和替换。实际上，我不确定您是否甚至想处理替换，例如 ABC 和 ADC 将如何对齐？

# javascript - 多维数组中的最小值和最大值

> ID：15042887
> 
> 赞同：4
> 
> 时间：2013-02-23T16:41:53.277
> 
> 标签：javascript, arrays

我的数组是：

```
var a = new Array();
a[0] = {x: 10,y: 10};
a[1] = {x: 20,y: 50};
a[2] = {x: 30,y: 20};
a[3] = {x: 10,y: 10}; 
```

`var min = Math.min.apply(null, a.x)`不起作用。一些想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T16:45:50.240

您有正确的想法，`.apply`但您需要传递一组`x`值。

```
var xVals = a.map(function(obj) { return obj.x; });
var min = Math.min.apply(null, xVals); 
```

* * *

该`.map()`方法创建了一个新数组，其中包含您在每次迭代中返回的任何内容。

```
[10, 20, 30, 10] 
```

* * *

然后将 Array 作为第二个参数传递给 Array`.apply`的成员作为单独的参数。所以就好像你这样做了：

```
Math.min(10, 20, 30, 10) // 10 
```

* * *

但既然你需要`.map()`，你不妨跳过`Math.min`, 而只是使用`.reduce`。

```
var min = a.reduce(function(min, obj) { 
                      return obj.x < min ? obj.x : min; 
                   }, Infinity); 
```

# c++ - 用 C 或汇编制作一个简单的 CRT0

> ID：15042893
> 
> 赞同：5
> 
> 时间：2013-02-23T16:42:20.983
> 
> 标签：c++, assembly, runtime, crt

我用 C/C++ 和 ASM 回来了，我想玩一点火。我发现，当您将代码编译并链接到 Windows 的可执行文件中时，它会动态链接到一些库，这些库必须存在于预期运行该应用程序的任何计算机上。您可以指定编译器不链接它们并为此创建自己的库。

除此之外（如果我在这里所说的一切都错了，请纠正我）还有一个目标文件，它总是沿着我们应用程序的主代码编译和链接。它是 crt0.o（C 运行时）文件，据我所知，它准备堆栈、获取 argc 和 argv 并调用 main 函数（可能还有其他东西）。我也相信它是系统在执行应用程序时调用的第一段代码。

所以，我正在尝试创建一个简单的 crt0.obj 并将其链接到一个简单的 C++ 目标文件

```
int main(int argc, char** argv) {
    return 0; 
} 
```

我使用 GCC 并且我不想使用标准库，所以我的命令如下所示：

```
g++ -s -nostartfiles -nodefaultlibs -nostdlib testapp.cpp -o test.exe crt0.o 
```

我想*-nostartfiles*指令告诉链接器不要嵌入默认的 crt0.o，因此它希望我为任何函数提供每个定义并处理应用程序的启动。我在这里有点困惑。

无论如何，我想创建一个非常基本的 crt0 目标文件，这足以让 GCC 创建我的可执行文件，并让系统启动它。我知道 Internet 上有很多代码文件（C 和 ASM），但我想编写自己的代码文件以了解它是如何工作的。我需要的不仅仅是代码，而是关于它必须做什么以及如何编译/链接以实现它的一点帮助。如果您知道任何有用的链接，也非常感谢。

我的疑问是：
**1.**编译器/链接如何从我的代码和 C 运行时创建最终文件？我是否必须从 crt0.o 调用 main 函数（使用 extern 指令）？当我执行时，`g++ -s -nostartfiles -nodefaultlibs -nostdlib testapp.cpp -o test.exe`我得到“* undefined reference to __main*”错误。在crt0.o文件中定义了main函数吗？奇怪的是，如果我改变`int main`我`int start`没有得到任何错误。这意味着什么？
**2.** crt0 必须包含哪些基本操作（如获取命令行参数、调用 main）？
**3.**我的代码文件是 CPP，crt0 是 C 文件中的一个程序集（用 GCC 编译）。我将发布一些我设法从我发现并部分理解的片段中创建的“frankencode”：

```
// crt0.c
__asm(".section .text\n" 
".global _start\n"
"_start:\n"
"mov $0, %ebp\n"
"push %ebp\n"
"mov %esp, %ebp\n"
"push %esi\n"
"push %edi\n"
"call _init\n"
"pop %edi\n"
"pop %esi\n"
"call main\n"
"movl %eax, %edi\n"
"call exit\n"
".section .init\n"
".global _init\n"
"_init:\n"
"push %ebp\n"
"mov %esp, %ebp\n"
".section .fini\n"
".global _fini\n"
"_fini:\n"
"push %ebp\n"
"mov %esp, %ebp\n"); 
```

**4.)**所以，在这个文件中，我调用了一些初始化函数。init 和 fini 函数已经创建（它们看起来像简单的构造函数和析构函数，我不知道）还有 main 函数，我不知道它与 .cpp main 函数有什么关系。我的意思是，我应该导入它吗？主函数和退出函数都`undefined reference`出现错误。
**5.)** c0 必须具有特定格式或包含特定功能，以便系统找到它的开始吗？

好吧，我认为制作一个小的 crt0 并使编译器将其附加到可执行文件并不难，但是有些事情我无法正确看到。我希望有人可以帮助我将所有这些组合在一起。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:59:04.893

我没有要测试的 Windows 机器，但这应该是您需要的基本位：

```
#// crt0.c
__asm(".section .text\n" 
".global _start\n"
"_start:\n"
"mov $0, %ebp\n"
"push %ebp\n"
"mov %esp, %ebp\n"
"call main\n"
"pop  %ebp\n"
"ret\n"); 
```

编辑：空`__main`：

```
__asm(".global __main\n"
      "__main:\n" 
      "ret\n"); 
```

# email - MailChimp 自定义编码教程

> ID：15042897
> 
> 赞同：0
> 
> 时间：2013-02-23T16:42:40.810
> 
> 标签：email, html-email, newsletter, mailchimp

我必须为 MailChimp 电子邮件模板编写设计代码，我想在 Dreamweaver 中对其进行编码，然后导入到 MailChimp。我非常了解电子邮件模板标准，并且很容易为跨电子邮件客户端编写代码；问题是我没有找到好的资源或教程来展示如何根据 MailChimp API 在模板中编码电子邮件，然后导入到 MailChimp。

请您提及一些在 Dreamweaver 中从头开始编写 MailChimp 模板的资源或教程、链接或书籍吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T15:01:00.193

MailChimp 自己的教程很不错 - [http://kb.mailchimp.com/article/how-do-i-create-my-own-custom-template](http://kb.mailchimp.com/article/how-do-i-create-my-own-custom-template)

您还需要记住他们的模板语言 - [http://kb.mailchimp.com/article/getting-started-with-mailchimps-template-language](http://kb.mailchimp.com/article/getting-started-with-mailchimps-template-language)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-25T13:07:54.120

如果您想在 dreaweaver 上编写代码，那么本教程将对您有很大帮助 [http://www.whatcreative.co.uk/blog/email-marketing/building-awesome-mailchimp-templates/](http://www.whatcreative.co.uk/blog/email-marketing/building-awesome-mailchimp-templates/)

否则 mailchimp 教程更好 [http://mailchimp.com/resources/guides/mailchimp-for-designers/html/](http://mailchimp.com/resources/guides/mailchimp-for-designers/html/)

谢谢

# android - 如何为android构建一个跨平台的html5应用程序

> ID：15042900
> 
> 赞同：4
> 
> 时间：2013-02-23T16:42:58.407
> 
> 标签：android, html, cross-platform

我是 android 开发的新手，在网上扫描这个特定问题后，我仍然对如何开发 html5 跨平台应用程序感到困惑？我可以用eclipse来做吗？我的可能性是什么？你能告诉我我应该经历什么以及具体在哪里吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T16:45:44.260

您可以使用PhoneGap。访问[http://phonegap.com/](http://phonegap.com/)。它将让您使用 html、css 和 javascript 开发跨平台应用程序。

这也是PhoneGap API 的“入门”页面。 [http://docs.phonegap.com/en/2.4.0/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android](http://docs.phonegap.com/en/2.4.0/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android)

Cordova 插件： [http ://cordova.apache.org/](http://cordova.apache.org/)

快乐编码：D

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T16:48:21.550

是的，Eclipse 很好；谷歌提供了一个一体化的包，见[http://developer.android.com/sdk/index.html#download](http://developer.android.com/sdk/index.html#download)；对于 HTML/JavaScript 应用程序，您可以查看 PhoneGap ( [http://phonegap.com/](http://phonegap.com/) )。他们为初学者提供了非常好的教程。
检查[http://en.wikipedia.org/wiki/PhoneGap](http://en.wikipedia.org/wiki/PhoneGap)以了解功能概述。

还有其他的，例如 Titanium 或 Appcelerator（参见[http://developer.appcelerator.com/blog/2012/05/comparing-titanium-and-phonegap.html](http://developer.appcelerator.com/blog/2012/05/comparing-titanium-and-phonegap.html)）

# r - 使用 SCAD 的 SVM 特征选择

> ID：15042904
> 
> 赞同：1
> 
> 时间：2013-02-23T16:43:17.187
> 
> 标签：r, svm

使用`penalizedSVM`R 包，我正在尝试进行特征选择。有一个名为 trainingdata 的几个 data.frames 的列表。

```
trainingdata <-lapply(trainingdata, function(data)
                   {
                     levels(data$label) <- c(-1, 1)
                     train_x<-data[, -1]
                     train_x<-data.matrix(train_x)
                     trainy<-data[, 1]
                     print(which(!is.finite(train_x)))
                     scad.fix<-svm.fs(train_x, y=trainy, fs.method="scad",
                                      cross.outer=0, grid.search="discrete",
                                      lambda1.set=lambda1.scad, parms.coding="none",
                                      show="none", maxIter=1000, inner.val.method="cv",
                                      cross.inner=5, seed=seed, verbose=FALSE)

                     data <- data[c(1, scad.fix$model$xind)]
                     data
                   }) 
```

一些迭代进展顺利，但在一个 data.frame 上我收到以下错误消息。

```
[1] "feature selection method is scad"
Error in svd(m, nv = 0, nu = 0) : infinite or missing values in 'x'
Calls: lapply ... scadsvc -> .calc.mult.inv_Q_mat2 -> rank.condition -> svd 
```

使用以下调用，我还检查 x 是否真的是无限的，但调用返回 0 为所有前面和当前发生错误的 data.frame。

```
print(which(!is.finite(train_x))) 
```

有没有其他方法可以检查无限值？还有什么办法可以纠正这个错误？有什么方法可以确定在 lapply 中处理的当前 data.frame 的索引吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:01:33.170

对于第一个问题，`infinite or missing values in 'x'` 建议您将条件更改为 .

```
 idx <- is.na(train_x) | is.infinite(train_x) 
```

例如，您可以将 0 分配给这些值。

```
 train_x[idx] <- 0 
```

对于第二个问题，关于如何获取当前 data.frame 的名称， `lapply`您可以遍历 data.farmes 的名称，并执行以下操作：

```
 lapply(names(trainingdata), function(data){ data <- trainingdata[data]....} 
```

例如：

```
 ll <- list(f=1,c=2)
> lapply(names(list(f=1,c=2)), function(x) data <- ll[x])
[[1]]
[[1]]$f
[1] 1

[[2]]
[[2]]$c
[1] 2 
```

**编辑**

您可以`tryCatch`在此行之前使用 scad.fix<-svm.fs

```
 tryCatch(
    scad.fix<-svm.fs(....)
      , error = function(e) e)
           }) 
```

例如，这里我在这个列表上测试它，代码继续执行到列表的末尾，即使列表中有一个 NA。

```
lapply(list(1,NA,2), function(x){
  tryCatch(
  if (any(!is.finite(x)))
     stop("infinite or missing values in 'x'")
  , error = function(e) e)
       }) 
```

# c++ - 从二进制文件（如 PDF）中读取文本

> ID：15042905
> 
> 赞同：-1
> 
> 时间：2013-02-23T16:43:20.467
> 
> 标签：c++, file-io

我在用 C++ 读取二进制文件时遇到问题。目前我的代码是这样的：

```
FILE *s=fopen(source, "rb");
fseek(s,0,SEEK_END);
size_file size=ftell(s);
rewind(s);

char *sbuffer=(char *) malloc(sizeof(char) * size);
if(sbuffer==NULL){
    fputs("Memory error", stderr);
    exit(2);
}
size_t result=fread(sbuffer,1,size,s);
if(result != size){
    fputs("Reading error",stderr);
    exit(3);
}
fclose(s);
cout<<sbuffer<<endl; 
```

但是，终端上打印出来的字符都是随机字符，而不是我在PDF文件中写的。它们就像：

```
% P D F - 1 . 3 
 % ? ? ? ? ? ? ? ? ? ? ? 
 4   0   o b j 
 < <   / L e n g t h   5   0   R   / F i l t e r   / F l a t e D e c o d e   > > 
 s t r e a m 
 x  ? ? ? j ? 0  E ? ? ? k ?  y Q E # ? ? ? m ? & ? ? @  % + ? .     ? ?  ? ? A i  ?     4 z \ 1 G W ? ?  - , ? ? ? (  ? ? ?  9 ? ? ? ? ?  \ ? } ? ? ? e ? ? ? ? 0 ? ? ? ~ ? , ? ? & 8 ? ? x e 4 ? r 
 | ? ? ? 
          ? ? ? ? E  > a ? ? z & ? Z ? < ?  }  '  ? ? ? j p ? ? Q 7 0 ? ? ? S %  - p ? ? ? 7 D  ?  ? ? ' Q z Q ?  ? ? ? ? ? ? ? ? ? \ 2 ? ? 7 ? ? ? < ? ? D ~  ? ? ? 

 e n d s t r e a m 
 e n d o b j 
 5   0   o b j 
 2 2 8 
 e n d o b j 
 2   0   o b j 
```

还有许多其他类似上述的角色。我试图搜索很长时间，但无法找到如何获取实际字符以供以后处理。顺便说一句，我正在尝试编写一个以二进制文件作为输入和输出的压缩器。非常感谢这里的任何帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T16:56:40.253

只有少数文件格式（如纯原始 .TXT 文本文件）可以直接“读取”和“理解”。大多数文件格式，包括几乎所有二进制格式，都是 ..**格式**。这意味着文件中包含某些**结构**。与完全无结构的 .TXT 文本文件完全相反，或者更确切地说，它是一大块纯数据。

打开写字板或 Word 或任何其他**最不智能的**文本编辑器并在那里写一些文本，然后将其保存为 RTF、DOC、ODT 或任何其他非 TXT 文件。然后也将其保存为 TXT 文件。

下载十六进制查看器/十六进制编辑器。随便一个。拿其中一个免费的，你不需要很多功能，只需要一个在一列中显示原始二进制值，在另一列中显示 ASCII 文本的功能。几乎所有免费的十六进制查看器/编辑器都可以做到这一点。

打开并比较这两个文件。您将立即看到差异。

返回PDF：

PDF 甚至可以包含与文本交错的图形。如果文本像在 TXT 中一样“只是坐在文件中”，您希望如何保留它？如何嵌入图像位置/描述/数据？如果我没记错的话，PDF 甚至可以包含类似于 JavaScript 的脚本。可执行。在 PDF 类型的文档中，您可以拥有执行某些操作的按钮。这比文件中的文本要复杂得多。

二进制文件通常不包含任何可读的文本。他们将文本以块的形式结构化，包裹在关于颜色、文本布局、分页等的元数据中，甚至是关于文档版本控制、创作、分类等的特殊结构（...）。这一切都必须存储在某个地方。

通常，二进制文件有节。第一部分通常称为 HEADER。在里面，会有以下信息：格式类型、格式版本、文件/块/数据长度、图像分辨率等。所有这些最有可能以二进制形式保存：没有“800x600”文本，只有“|00|00|03|20|00|00|02|58|” 假设 32 位 BE。在您阅读、解码和理解描述之后，您就会知道实际数据从哪里开始，数据块是如何布局的，以及如何解码它们并理解它们包含的内容。

编辑：

在了解了文本文件和二进制文件之间的区别后，请查看[http://en.wikipedia.org/wiki/Entropy_(information_theory)](http://en.wikipedia.org/wiki/Entropy_(information_theory))上的绝对基础知识。然后尝试使用 RLE ( [http://www.daniweb.com/software-development/cpp/code/216388/basic-rle-file-compression-routine](http://www.daniweb.com/software-development/cpp/code/216388/basic-rle-file-compression-routine) ) 或 Huffman ( [http://www.cprogramming.com/tutorial /computersciencetheory/huffman.html](http://www.cprogramming.com/tutorial/computersciencetheory/huffman.html)）只是开始一些相对简单的事情。然后开始阅读有关 Huffman 代码的更多信息，然后，您将为这项任务做好充分的准备，例如 ZIP 或 LZH..

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T16:58:29.513

要将 PDF 解析为文本，请使用一些 PDF 库，例如[gnupdf](https://www.gnu.org/software/pdf/)或 [poppler](http://poppler.freedesktop.org/)。

# linux - 以 root 身份运行 vim 的问题

> ID：15042906
> 
> 赞同：1
> 
> 时间：2013-02-23T16:43:26.063
> 
> 标签：linux, vim, nerdtree

如果这个问题被认为在这个论坛中没有这个位置，告诉我我会立即删除它！

我在我的 ubuntu 上安装了一个 vim 插件（称为 NERDTree）。当我打开具有非 root 状态的文件时，它运行良好。当我以 root 身份运行 vim 并尝试使用 :NERDTree 启动插件时，我被告知命令 'NERDTree' 是未知的。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T19:06:41.903

放置的插件`/usr/share/vim/vim7x`很可能会在下次升级时被覆盖。如果您希望您的插件可用于 root，您应该将它们安装在`/root/.vim`.

也就是说，Vim 默认带有一个名为 netrw 的文件浏览器插件。`:h netrw`在安装任何第三方替代品之前，您可以尝试学习如何使用它 ( )。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:47:42.093

您是否在主目录中安装了 NERDTree 插件`~/.vim/plugins`？如果是这样，那么 root 用户可能不会“看到”它。将它移动到全局插件目录，这应该可以修复它。

# windows - 使用 Windows 批处理提取文本文件的一部分

> ID：15042909
> 
> 赞同：1
> 
> 时间：2013-02-23T16:43:47.543
> 
> 标签：windows, file, batch-file, text, cmd

我有一个文本文件，我有兴趣只拥有其中的一部分，所有内容都包含在 wordA 和 wordB 之间

可以使用 cmd 批处理文件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T03:44:33.807

这是一种方法。假设 wordA 和 wordB 在同一行（两者都必须存在）。子例程 :FindString 删除不需要的前面文本，然后将“wordB”替换为我们不希望出现在文本中的字符，然后将其用作分隔符（在本例中为`）。必要时使用另一个字符。

```
@ECHO OFF
SET InFile=Test.txt

FOR /F "tokens=*" %%A IN ('FINDSTR "wordA" "%InFile%" ^| FINDSTR "wordB"') DO CALL :FindString "%%A"
pause
GOTO :eof

:FindString
SET String=%~1
SET String=%String:*wordA =%
SET String=%String: wordB=`%
FOR /F "tokens=1 delims=`" %%A IN ('ECHO.%String%') DO ECHO.%%A]
GOTO :eof 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T15:19:07.353

当“wordA”和“wordB”不在同一行时，这是一种方法。它将输出发送到 Output.txt。这将是输入文件中第一个“wordA”和第一个“wordB”之间的文本（区分大小写）。如果有多个（或不匹配的）wordA/B 集，您没有指定要做什么。

:RemoveWordB 将“wordB”替换为我们不希望出现在文本中的字符，然后将其用作分隔符（在本例中为`）。必要时使用另一个字符。

```
@ECHO OFF
SET InFile=Test.txt
SET OutFile=Output.txt
IF EXIST "%OutFile%" DEL "%OutFile%"
SET TempFile=Temp.txt
IF EXIST "%TempFile%" DEL "%TempFile%"

FOR /F "tokens=*" %%A IN ('FINDSTR /N "wordA" "%InFile%"') DO (
   CALL :RemovePrecedingWordA "%%A"
   FOR /F "tokens=1 delims=:" %%B IN ('ECHO.%%A') DO (
      MORE +%%B "%InFile%"> "%TempFile%"
      FINDSTR /V "wordB" "%TempFile%">> "%OutFile%"
      FOR /F "tokens=*" %%C IN ('FINDSTR "wordB" "%InFile%"') DO (
         CALL :RemoveWordB "%%C"
         IF EXIST "%TempFile%" DEL "%TempFile%"
         GOTO :eof
         )
      )
   )
GOTO :eof

:RemovePrecedingWordA
SET String=%~1
SET String=%String:*wordA =%
ECHO.%String%> "%OutFile%"
GOTO :eof

:RemoveWordB
REM Replace "wordB" with a character that we don't expect in text that we will then use as a delimiter (` in this case)
SET LastLine=%~1
SET LastLine=%LastLine:wordB=`%
FOR /F "tokens=1 delims=`" %%A IN ('ECHO.%LastLine%') DO ECHO.%%A>> "%OutFile%"
GOTO :eof 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-18T18:59:17.610

`repl.bat`这使用从 - [http://www.dostips.com/forum/viewtopic.php?f=3&t=3855](http://www.dostips.com/forum/viewtopic.php?f=3&t=3855)调用的帮助程序批处理文件

放在`repl.bat`与批处理文件相同的文件夹中。

```
@echo off
type infile |repl ".*wordA(.*)wordB.*" "$1" >outfile 
```

# backbone.js - Backbonejs - 如何通过多个参数过滤集合？

> ID：15042912
> 
> 赞同：1
> 
> 时间：2013-02-23T16:43:59.687
> 
> 标签：backbone.js

**我有一个场景，我需要通过多个参数过滤车辆集合 - 用户可以**选择组合的一系列收音机、选择框等，即燃料、座椅、颜色。示例组合可能是：

*   颜色=红色
*   座位=4 & 燃料=汽油
*   燃料=柴油
*   燃料=汽油和颜色=黑色和座椅=2
*   ETC

**通过一个**参数过滤集合很简单，但需要一些关于多个参数的提示。

这是我的车辆收藏：

```
 Vehicles = Backbone.Collection.extend({
        model: Vehicle,
        withFuelType: function(fuel) {
            return this.models.filter(function(vehicle) { return vehicle.get('fuel') === fuel; });
        },
        withSeats: function (seats) {
            return this.models.filter(function (vehicle) { return vehicle.get('seats') === seats; });
        },
        withColor: function(color) {
            return this.models.filter(function (vehicle) { return vehicle.get('color') === color; });
        }
    }) 
```

任何指针都非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T17:26:59.790

您可以[`where`](http://backbonejs.org/#Collection-where)用于简单的相等搜索：

> **在哪里** `collection.where(attributes)`
> 
> **返回集合中与传递的属性**匹配的所有模型的数组。对 的简单情况很有用`filter`。

所以你不需要这些功能，你可以这样做：

```
c.where({ fuel: 'petrol', color: 'black' });
c.where({ seats: 2 }); 
```

您应该能够将您的搜索查询字符串转换为一个对象并将其交给`where`您以获取您需要的内容。

# node.js - 从 Node.js 访问 OpenSSL 的不同方法

> ID：15042919
> 
> 赞同：7
> 
> 时间：2013-02-23T16:45:03.820
> 
> 标签：node.js, openssl

我现在正在寻找一种集成 OpenSSL 和 Node.js 的方法。

我的目标是：

*   我想独立于平台，因此解决方案应该适用于 OS X、Linux 和 Windows。
*   我想避免不必要的磁盘操作。例如，私钥可能不在文件中，而是在数据库中（可能是一个愚蠢的例子，但让我们认为这是一个有效的要求）。
*   我想支持创建密钥、csrs、签署 csrs、创建 ca 证书……所有证书的东西，从头到尾。

现在我考虑的选项是：

*   使用集成在 Node.js 中的 OpenSSL 库。不幸的是，加密模块不提供证书的东西。
*   使用外部模块使用 OpenSSL 库。不幸的是，我不知道该怎么做，可能是由于缺少 C/C++ 知识。
*   使用 OpenSSL 二进制文件作为子进程。鉴于 OpenSSL 可用，这应该适用于所有平台。这不是很好，但它有效。

问题 #1：正如我所写，我对如何直接访问与 Node.js 捆绑在一起的 OpenSSL 库一无所知。我将如何处理这个？

目前，我坚持使用二进制文件作为子进程。不幸的是，这要求所有的东西，比如私钥等等，要么作为文件给出（我明确地想避免），要么我使用 /dev/stdin 交出所有东西（这在 Windows 上不起作用）。

问题2：我该如何处理？＃1的解决方案也能解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-17T23:08:10.093

The answer to question #1 is that you cannot. Without bindings, you can only access the functions exposed by nodejs.

Unfortunately there doesn't seem to be a way work around for /dev/stdin in windows. Namedpipes would be an option but nodejs does not support them. You may be able to have nodejs launch openssl.exe in interactive mode and send commands through stdin, and read the output through stdout but this seems very inefficient.

So the answer is question #2 is that you cannot deal with the windows problem.

Writing your won binding seems to be the only option. It's actually not so difficult - something I'm sure you could get collaborators to help with.

# php - 是否有任何 php 函数来获取 csv 数据作为 mysql 选择查询

> ID：15042920
> 
> 赞同：0
> 
> 时间：2013-02-23T16:45:10.053
> 
> 标签：php, select, csv

我正在处理几个 csv 文件。在 mysql SELECT col FROM table WHERE id = '11'; 这是我将获取 id = 11 的所有记录的方法。我正在搜索 php 函数，例如 SELECT column/title FROM file.csv WHERE id ='11'。然后它可能会返回所有 id= '11' 的记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:55:22.327

使用 fgetcsv 您可以逐行读取文件。只需将行存储在具有相关搜索键作为索引的数组中。因此，您将拥有一个键为 11 的数组，其中包含一个行数组作为值。或者将数据存储在内存数据库中并使用 SQL 进行查询。

# c++ - 我使用私有继承了一个构造函数，为什么我仍然可以从主函数访问它？

> ID：15042921
> 
> 赞同：1
> 
> 时间：2013-02-23T16:45:14.193
> 
> 标签：c++, oop, object

```
#include <iostream>
using namespace std;

class base{
public:
    int i;
    base(){
    i=1;
    cout<<"Base Constructor";
    }
};

class derived: private base{
    public:
    derived(){
    i=2;
    cout<<"Derived constructor";
    }
};

int main(){ 
derived c;
return 0;
} 
```

对于上面的代码，即使我使用私有继承，为什么我得到的输出为“Base ConstructorDerived Constructor”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:54:54.587

> 为什么我仍然可以从 main 函数访问它？

你不是。

您的 main 函数访问`derived`它可以访问的构造函数。

And`derived`的构造函数访问**它**`base`可以访问的构造函数。

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:49:08.330

构造函数在执行构造函数主体之前自动初始化基类和成员。私有继承不会改变这一点。它只是使类的基础部分无法在类外部访问。由于调用基类构造函数的是派生类构造函数，因此私有继承不会限制它可以做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T16:50:46.030

你的意思是做基类的构造函数`protected`。那么只有派生类可以使用它：

```
class base
{
protected:
    base() : i(1) { }
private:
    int i;
};

class derived : private base
{
public:
    derived() : base() { }
};

int main()
{ 
    // base b;  // error: inaccessible constructor base::base()
    derived d;  // fine
} 
```

一种比较流行的模式也是使*析构函数*受到保护。不过，你明白了。**

# php - 冗余数据是否可以省去查询的必要性？

> ID：15042924
> 
> 赞同：1
> 
> 时间：2013-02-23T16:45:32.370
> 
> 标签：php, sql, database, database-design

我试图创建一个清单系统，例如。要收集的项目列表。用户将能够将列表添加到他们的个人资料中，然后当他们收集项目时，可以选中列表中项目的复选框，单击提交，选中的项目现在将被标记为已收集。我已经对其进行了编码并且工作正常，但是它对数据库进行了大量的查询才能正常工作。

我有 5 张桌子。一个用户表（用于注册用户的用户名、id..etc）、一个列表表（包含列表名称、描述、id）、一个列表项表（包含单个项目。id、标题和 listID（用于引用列表）它属于））。userslist 表（用于用户添加到其个人资料中的列表。userID 和 listID）和collecteditems 表（其中包含一个人已选中复选框的列表项。listItemsID、UserID）

问题是当我查看 mylists.php 页面时，它将查询 userslist 表并返回用户添加的列表的所有 ID。然后，一旦我有了列表的 ID，它就会查询列表以找出列表的名称（如果我添加了 10 个不同的列表，这可能意味着必须对列表进行 10 次查询）。如果我在 userslist 表中添加了一个 listname 列，我只需要对该页面进行 1 次查询，即对 userslists 表进行查询，然后我可以使用该 1 次查询来构建页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:47:26.020

听起来您应该保持数据标准化（即避免冗余数据），而是使用[`JOIN`](http://en.wikipedia.org/wiki/Join_%28SQL%29).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:48:21.383

首先，我不会担心对主键的查询。您的所有表都有一个由其他表引用的主键。这些将使用连接。

其次，您不必单独获取列表名称。使用如下查询：

```
select l.listName
from UserLists ul join
     Lists l
     on ul.listId = l.listId
where userId = $userid 
```

这将在单个查询中返回所有名称。

# facebook - FQL facebook 查询好友活动

> ID：15042932
> 
> 赞同：1
> 
> 时间：2013-02-23T16:46:15.600
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我有一个关于 FQL 查询的问题：

这个查询：

```
SELECT pic_big, name, venue, location, start_time, eid 
FROM event
WHERE eid IN (
    SELECT eid
    FROM event_member
    WHERE uid IN (
        SELECT uid2
        FROM friend
        WHERE uid1 = me()
    ) 
    AND start_time > '2013-02-21T00:00:00'
    OR uid = me()
) 
```

就等于要求我每一个朋友的事件？

```
for each friend {

    SELECT name, description, pic_small, pic_big, eid,venue, location 
    FROM event
    WHERE eid in (
        SELECT eid 
        FROM event_member
        WHERE uid = me()
        AND start_time > '2013-02-21T00:00:00'
    )

} 
```

我有不同的结果..以第二种方式（我还排除了我的事件 uid = me ()）我获得了更多的事件...

# html - 尽管未能满足媒体查询，但 css 文件始终加载

> ID：15042933
> 
> 赞同：1
> 
> 时间：2013-02-23T16:46:14.937
> 
> 标签：html, css, media-queries

我的 index.html 文档的头部中有以下样式表链接代码：

```
<link href="static/css/mobile.css" rel="stylesheet" media="screen and (max-width: 739px)"> 
```

但是，在我的 1920px 宽屏幕上，chrome 和 firefox 都加载了 mobile.css - 它似乎忽略了内容。它只是将渲染页面所需的时间增加了一倍。

如果 CSS 文件无法满足媒体查询，有什么办法可以阻止它加载？（我想我可以忍受一些 .js）还是我实现错了？

浏览器加载文件然后忽略它似乎是完全错误的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:56:22.720

恐怕浏览器总是会加载媒体查询，即使它们不匹配。您可以在此处详细了解它：

[http://christianheilmann.com/2012/12/19/conditional-loading-of-resources-with-mediaqueries/](http://christianheilmann.com/2012/12/19/conditional-loading-of-resources-with-mediaqueries/)

在这篇文章中也展示了防止这种情况的方法。简而言之，它将是这样的：

1.  您使用 JS 而不是 CSS: 的测试查询`window.matchMedia('screen and (max-width: 739px)');`。
2.  然后，如果它匹配你添加你的CSS与类似：`document.write('<link rel="stylesheet" href="small.css">');`

实际文章有更好的方法来包含它`document.write`，所以你应该检查一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:10:33.033

这是我最后使用的。它使用了一些 jquery，但如果需要，您可以将其从 jquery 转换出来。

首先像这样设置html：

```
<link class="matchmedia" data-href="static/css/mobile.css" data-rel="stylesheet" data-max="739"> 
```

data-max 是我们告诉下面的函数检查最大宽度的方式。当函数被调用时，它将查找具有名为“matchmedia”的类的元素，然后测试您在 data-max 和 data-min 中指定的约束，如果它通过这些测试，它将复制其名称的任何属性以“data-”开头并复制值。嘿，我们有条件加载。

```
ws.width = <your favourite method of getting the width>;

function mediaMatchHTML() {
$(".matchmedia").each(function(){
    var min = this.getAttribute("data-min");    //in pixels
    var max = this.getAttribute("data-max");

    //Check condition
    if ((min === null || ws.width >= min) && (max === null || ws.width <= max)) {
        for (var c=0; c<this.attributes.length; c++) {
            var name = this.attributes[c].name.slice(5);
            if ("data-"+name == this.attributes[c].name) {  //is this lined up for conversion?
                this.setAttribute(name, this.attributes[c].value);
            }
        }
    }
});
} 
```

# redirect - Spring MVC @RequestMappings 和重定向的问题

> ID：15042940
> 
> 赞同：0
> 
> 时间：2013-02-23T16:46:51.120
> 
> 标签：redirect, spring-mvc, post-redirect-get

我遇到了 Spring MVC`@RequestMapping`和重定向的问题。

我的一个控制器中有以下方法：

```
@RequestMapping(value = "/activateEmail/{token}", method = RequestMethod.GET, produces = "text/html")
    public String activateEmail(@PathVariable("token") String token) {
        preferencesService.activateEmail(token);
        signinService.signin(memberRepository.findByToken(token));
        return "redirect:preferences/email";//HERE
} 
```

但是，当用户最初位于：

```
http://localhost:8080/bignibou/preferences/email 
```

上面的“重定向指令”重定向到：

```
http://localhost:8080/bignibou/activateEmail/preferences/email 
```

而我希望它会将我重定向到：

```
http://localhost:8080/bignibou/preferences/email 
```

为了达到预期的效果，我不得不求助于以下丑陋的黑客：

```
return "redirect:../preferences/email";//HERE 
```

谁能建议一个更好的做法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:59:18.487

我想你需要的是`"redirect:/preferences/email"`

# c++ - 从向量中擦除时向量迭代器不兼容

> ID：15042942
> 
> 赞同：1
> 
> 时间：2013-02-23T16:47:04.520
> 
> 标签：c++, map, vector, iterator, erase

我有一个元素是向量的地图。我必须从这些向量中删除所有等于特殊数字的元素`num`

```
std::map<size_t,std::vector<size_t> > myMap;
for (std::map<size_t,std::vector<size_t> >::iterator itMap = myMap.begin();itMap != myMap.end();++itMap )
{
    for (std::vector<size_t>::iterator itVec = itMap->second.begin();itVec != itMap->second.end();)
    {
        auto itNextVec = itVec;
        ++itNextVec;
        if (*itVec == num)
        {
            itMap->second.erase(itVec );
        }
        itVec = itNextVec;
    }
} 
```

该代码导致运行时 exepssion .In VS - `vector iterators incompatible`。有人可以指出这是什么原因吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T17:01:45.207

`std::vector::erase`返回一个`iterator`到列表的下一个位置，所以当你执行擦除时，你应该让你的迭代器等于返回的值。

你唯一需要考虑的是返回的`iterator`可能是结束，所以你应该检查一下。

我个人喜欢做的是在擦除之后，我得到下一个迭代器位置，我回到返回的迭代器的前一个位置，然后在`for loop`

例子：

```
#include <vector>
#include <iostream>

int main()
{
    std::vector<int> myInt;
    myInt.push_back(1);myInt.push_back(2);myInt.push_back(3);

    for(auto iter = myInt.begin();
        iter != myInt.end();
        ++iter)
    {
        if(*iter == 1)
        {
            iter = myInt.erase(iter);
            if(iter != myInt.begin())
            {
                iter = std::prev(iter);
                continue;
            }
        }

        std::cout << *iter << std::endl;
    }
} 
```

但是在迭代器循环中进行擦除是不受欢迎的，因为它会使旧的迭代器无效，如果你没有计划的话，这可能会导致很多问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T16:50:47.597

擦除将使迭代器无效

```
Iterator validity
Iterators, pointers and references pointing to position (or first) and beyond are 
invalidated, with all iterators, pointers and references to elements before position (or 
first) are guaranteed to keep referring to the same elements they were referring to 
before the call. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T16:50:19.340

在迭代它时，您不能轻易地从集合中删除一个项目。想一想，您删除了`itVec`“指向”的内容，删除后`itVec`不再“指向”一个元素，因此它不再具有“下一个”指针。

如果您检查例如[this reference](http://en.cppreference.com/w/cpp/container/vector/erase)，您将看到该`erase`函数将迭代器返回到下一个元素。继续这个循环（当然不要增加它）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-23T16:53:34.763

考虑使用不同的集合类，`vector`或者创建一个新的向量，删除所需的项目，而不是从现有向量中删除。

# python - 安装 ngcgh 的命令“gcc”失败，退出状态为 1

> ID：15042945
> 
> 赞同：0
> 
> 时间：2013-02-23T16:47:19.253
> 
> 标签：python, gcc

我在安装 ngch 时遇到 gcc failed 错误：[https](https://github.com/seandavi/ngCGH) ://github.com/seandavi/ngCGH 它在easy_install 时也给出了同样的错误，我正在使用 Windows。

```
Running pysam-0.7.4\setup.py -q bdist_egg --dist-dir c:\users\sam\appdata\lo
cal\temp\easy_install-ilqggk\pysam-0.7.4\egg-dist-tmp-rolwff
In file included from pysam\csamtools.c:241:
samtools/razf.h:38:18: error: zlib.h: No such file or directory
In file included from pysam\csamtools.c:241:
samtools/razf.h:91: error: expected specifier-qualifier-list before 'z_stream'
pysam\csamtools.c: In function '__pyx_pf_9csamtools_7Samfile_10fetch':
pysam\csamtools.c:9814: warning: passing argument 7 of 'bam_fetch' from incompatible  
pointer type
pysam\csamtools.c: In function '__pyx_pf_9csamtools_7Samfile_11mate':
pysam\csamtools.c:10254: warning: passing argument 7 of 'bam_fetch' from incompa
tible pointer type
pysam\csamtools.c: In function '__pyx_pf_9csamtools_7Samfile_12count':
pysam\csamtools.c:10730: warning: passing argument 7 of 'bam_fetch' from incompa
tible pointer type
pysam\csamtools.c: In function '__pyx_pf_9csamtools_7Samfile_13pileup':
pysam\csamtools.c:11148: warning: passing argument 7 of 'bam_fetch' from incompa
tible pointer type
pysam\csamtools.c: In function '__pyx_f_9csamtools___advance_snpcalls':
pysam\csamtools.c:17424: warning: implicit declaration of function 'bam_prob_rea
ln'
pysam\csamtools.c:17452: warning: implicit declaration of function 'bam_cap_mapQ
'
pysam\csamtools.c: In function '__pyx_pf_9csamtools_20IteratorColumnRegion_1__ne
xt__':
pysam\csamtools.c:18907: warning: passing argument 1 of '__pyx_f_9csamtools_make
PileupProxy' from incompatible pointer type
pysam\csamtools.c: In function '__pyx_pf_9csamtools_21IteratorColumnAllRefs_1__n
ext__':
pysam\csamtools.c:19134: warning: passing argument 1 of '__pyx_f_9csamtools_make
PileupProxy' from incompatible pointer type
pysam\csamtools.c: In function '__Pyx_InitGlobals':
pysam\csamtools.c:38587: warning: this decimal constant is unsigned only in ISO
C90
error: Setup script exited with error: command 'gcc' failed with exit status 1 
```

谁能让我知道如何克服这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-27T16:26:28.707

由于缺少 zlib-dev，很可能是 pysam 无法编译。尝试在我之前在 Ubuntu 中安装它： `sudo apt-get install zlib1g-dev`

对于 Fedora，您可以尝试：
`yum install zlib-devel`

不过我不知道windows...

# java - 从服务中获取 Activity 的小部件

> ID：15042947
> 
> 赞同：1
> 
> 时间：2013-02-23T16:47:22.743
> 
> 标签：java, android, service, android-activity

主要活动有一个 AlarmManager，它每 X 分钟调用一次服务。我需要一种方法，服务类中的方法可以更新主活动中的 TextView，但我不知道如何在服务中获取 TextView 的对象。有什么办法吗？

以下是部分代码：

```
Intent myIntent = new Intent(MainActivity.this, MyAlarmService.class);
pintent = PendingIntent.getService(MainActivity.this, 0, myIntent, 0);

AlarmManager alarmManager = (AlarmManager)getSystemService(ALARM_SERVICE);
alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), 60000, pintent); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:15:16.060

我有同样的需求，在一个加速度计读取服务和一个可以启动/停止服务并显示当前平均加速度计幅度的应用程序中。

我使用服务绑定允许服务向活动发送消息，其中包含加速度计值。

有关绑定的背景信息，请参阅[http://developer.android.com/guide/components/bound-services.html#Messenger](http://developer.android.com/guide/components/bound-services.html#Messenger)。有关一个很好的示例，请参阅 API 示例的 MessengerServiceActivities 和 MessengerService 类。

我做了以下。为了清楚起见，我省略了平凡的细节（例如同步以避免比赛）。请注意，我使用了 bind() 和 StartService()。bind() 用于在 Activity 和 Service 之间发送消息；StartService() 是这样服务在活动退出后继续运行。

基本上，Activity 和 Service 交换 Messenger，允许彼此向对方发送消息。Activity 向服务发送自定义消息，以便订阅服务消息或取消订阅服务消息。当 Service 要向 Activity 发送数据时，它会向 Activity 的 Messenger 发送自定义消息。Activity 收到这样的消息后，会向用户显示新值。

建议使用通知的答案使用一种简单的方法将数据显示到屏幕上。如果您想在 Activity 中显示数据（相对于通知栏），则需要这种更复杂的消息传递答案。

对于以下示例代码的长度，我深表歉意，但有很多必要的细节需要传达。

在我的 Activity 中，名为 AccelServiceControl：

```
private FromServiceHandler handler;  // My custom class for Handling Messages from my Service.
private Messenger fromService;  // For receiving messages from our Service
...
public void onCreate(Bundle savedInstanceState) {
    ...
    handler = new FromServiceHandler(this);
    fromService = new Messenger(handler);
    ...
}
protected void onResume() {
    ...
    // While we're in the foreground, we want to be bound to our service.
    // onServiceConnected() will return the IBinder we'll use to communicate back and forth.
    bindService(new Intent(this, AccelService.class), this, Context.BIND_AUTO_CREATE);
}
protected void onPause() {
    ...
    // Note: By itself, this doesn't stop the Service from sending messages to us.
    // We need to send a custom Unsubscribe Message to stop getting messages from the Service.
    unbindService(this);

}
public void onClick(View v) {
    // Send a custom intent to start or stop our Service.
    if (buttonStart == v) {
        startService(new Intent(AccelService.ACTION_START));
    } else if (buttonStop == v) {
        startService(new Intent(AccelService.ACTION_STOP));
    }
    ...
}
public void onServiceConnected(ComponentName name, IBinder service) {
    ...
    // Ask our Service to send us updates.
    toService = new Messenger(service);
    Message msg = Message.obtain(null, FromClientHandler.MSG_SUBSCRIBE);    // our custom Subscribe message
    msg.replyTo = fromService;
    try {
        toService.send(msg);
    } catch (RemoteException e) {
        // Failed because the Service has died.
        // We handle this in onServiceDisconnected().
    }
} 
```

在 Activity 的自定义消息处理程序中：

```
....
public void handleMessage(Message msg) {
    switch (msg.what) {
    case MSG_ACCEL_UPDATE:
        ...
        Bundle bundle = msg.getData();
        double accelValue = bundle.getDouble(ACCEL_UPDATE_VALUE);
        ...then display the new accelValue in, for example, a TextView.
    ...
    }
} 
```

在名为 AccelService 的服务中：

```
...
private Messenger fromClient;   // For receiving messages from our Client(s).
private FromClientHandler handler;      // needed just for unlinking at in onDestroy().
// Since we have only one Client, we store only one Activity's Messenger
private Messenger subscribedMessenger;
public void onCreate() {
    ...
    handler = new FromClientHandler(this);
    fromClient = new Messenger(handler);
}
public void onDestroy() {
    // Unlink ourselves from our Handler, so the Garbage Collector can get rid of us.  That's a topic in itself.
    handler.unlink();
    ....
}
public int onStartCommand(Intent intent, int flags, int startId) {
    ...
    int returnValue = START_NOT_STICKY;
    String action = intent.getAction();
    if (ACTION_START.equals(action)) {
        doActionStart();
        returnValue = START_STICKY;
    } else if (ACTION_STOP.equals(action)) {
        ...
        // Our Service is done
        stopSelf();
    }
    ... 
    return returnValue;
}
public IBinder onBind(Intent intent) {
    // Hand back a way to send messages to us.
    return fromClient.getBinder();
}
...when we want to send data to the Activity:
    Message msg = Message.obtain(null, FromServiceHandler.MSG_ACCEL_UPDATE);
    Bundle bundle = new Bundle();
    bundle.putDouble(FromServiceHandler.ACCEL_UPDATE_VALUE,  avgAccel);
    msg.setData(bundle);
    try {
        subscribedMessenger.send(msg);
    } catch (RemoteException e) {
        // Failed because the Client has unbound.
        subscribedMessenger = null;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:54:56.483

在您的警报服务中，您有一个 onReceive 方法

```
 public void onReceive(Context context, Intent arg1) {

        String data = "haha";
        if (data.isEmpty() == false && data.contentEquals("") == false) {

            nm = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);
            CharSequence from = "sing";
            CharSequence message = data;
                   //get the activity
            PendingIntent contentIntent = PendingIntent.getActivity(context, 0,
                    new Intent(), 0);
            Notification notif = new Notification(R.drawable.icon,
                    data, System.currentTimeMillis());
            notif.defaults |= Notification.DEFAULT_SOUND;
            notif.setLatestEventInfo(context, from, message, contentIntent);
            nm.notify(1, notif);

        } 
```

方法调用：

```
AlarmManager am = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
        Intent intent = new Intent(this, ReminderReceiverActivity.class);
        PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 0,
                intent, PendingIntent.FLAG_CANCEL_CURRENT);

        am.setRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis(),
                100000, pendingIntent);
    } 
```

# border - CSS缩放边框图像

> ID：15042949
> 
> 赞同：6
> 
> 时间：2013-02-23T16:47:26.620
> 
> 标签：border, scaling, css

我正在寻求一些帮助，以创建可随不同屏幕尺寸/设备缩放的边框。我已经附上了想要的结果，我到目前为止写的 html/css 和一个实时页面来预览迄今为止的结果。

## 问题/疑问：

1.  边框是使用像素设置的，我担心它不会在不同的设备/浏览器上缩放到正确的比例。
2.  边角不太匹配。
3.  有没有更好的方法来实现所需的边框，以便按比例缩放并实现所需的角格式？也许是矢量图像？

我接近实现匹配，但必须有一种（更简单？更好？）方法来重新创建这种类型的边框。非常感谢您查看此内容并提供您的意见。

问候，

和风

## 编辑/更新：

我还尝试使用`background-image:`和创建六个 .png 文件，每个角一个，具有纯白色背景，一个用于“边框”的顶部/底部和左侧/右侧。同样，它很接近，但图像并不总是正确排列。

必须有一种方法可以做到这一点，也许是在一个 svg 图像中，它可以根据其所在部分的大小自行缩放，但这超出了我的才能。

感谢您考虑这个问题！

* * *

# 所需的格式：

[在此处查看所需的格式](https://dl.dropbox.com/u/33322337/EP%20example.jpg)

# 当前结果 & html/css：

[在这里查看`border-image:`结果](https://dl.dropbox.com/u/33322337/EP%20Layout%20Test-1.html)

[在这里查看`background-image:`结果](https://dl.dropbox.com/u/33322337/EP%20Layout%20Test-2.html)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"> 
    <title>
        EP Layout Test
    </title>
    <style type="text/css">
.ep { 
    background-image: url(ep_border_top_left-w.png), url(ep_border_top_right-w.png),url(ep_border_bottom_right-w.png), url(ep_border_bottom_left-w.png), url(ep_border_vertical.png), url(ep_border_vertical.png), url(ep_border_horizontal.png), url(ep_border_horizontal.png);
    background-position: top left, top right, bottom right, bottom left, left, right, top, bottom;
    background-repeat: no-repeat, no-repeat, no-repeat, no-repeat, repeat-y, repeat-y, repeat-x, repeat-x;      
    width: 70%;
    margin-left: auto;
    margin-right: auto;
}
.ep_content {
    padding: 2.5em;
}
.ep_title {
    background-color: black;
    padding: 0.5em 0em;
    color: white;
}
p {
    text-align:left;
}

</style> 
</head>
<body>
    <p>
        This is some regular text.
    </p>
    <div class="ep">
        <div class="ep_content">
        <h3 class="ep_title">
            SINGLE-ENGINE FAILURE/FLAMEOUT
        </h3>
        <p>
            Symptoms:
        </p>
        <ol>
            <li>
                TGT, Ng, torque, and Np on malfunctioning engine decreasing toward zero.
            </li>
            <li>
                NO. 1 ENG OUT or NO. 2 ENG OUT warning light illuminated.
            </li>
        </ol>
        <p>
            Corrective Action:
        </p>
        <ol>
            <li class="boldface">
                Nr - MAINTAIN.
            </li>
            <li class="boldface">
                CONTGCY PWR - ON.
            </li>
            <li class="boldface">
                Altitude/Airspeed - AS REQUIRED.
            </li>
            <li class="boldface">
                Fuel/stores - JETTISON AS REQUIRED.
            </li>
            <li class="boldface">
                ENG Anti-ice - AS REQUIRED.
            </li>
            <li>
                Analyze.
            </li>
        </ol>
        <p>
            If no indication of mechanical malfunction or engine fire:
        </p>
        <ol start="7">
            <li>
                Perform Engine Restart Procedure.
            </li>
        </ol>
        <p>
            If Engine Restart Procedure is not to be performed:
        </p>
        <ol start="8">
            <li>
                Conduct EMER ENG SHUTDOWN.
            </li>
            <li>
                LAND AS SOON AS PRACTICABLE.
            </li>
        </ol>
        </div>
    </div>
    <p>
        This is some regular text.
    </p>
</body>
</html> 
```

## 使用边框图像的原始代码

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"> 
    <title>
        EP Layout Test
    </title>
<style type="text/css">

.ep { 
    border-width: 32px 31px 32px 31px;
    border-image: url(chapter_3_background-small.png) 32 31 32 31 round round;
    border-color: #cccccc;
    border-style: solid;

    width: 70%;
    margin-left: auto;
    margin-right: auto;
}

.ep_title{
    background-color: black;
    padding: 0.5em 0em;
    color: white;
}
p {
    text-align:left;
}

</style> 
</head>
<body>
    <p>
        This is some regular text.
    </p>
    <div class="ep">
        <h3 class="ep_title">
            SINGLE-ENGINE FAILURE/FLAMEOUT
        </h3>
        <p>
            Symptoms:
        </p>
        <ol>
            <li>
                TGT, Ng, torque, and Np on malfunctioning engine decreasing toward zero.
            </li>
            <li>
                NO. 1 ENG OUT or NO. 2 ENG OUT warning light illuminated.
            </li>
        </ol>
        <p>
            Corrective Action:
        </p>
        <ol>
            <li class="boldface">
                Nr - MAINTAIN.
            </li>
            <li class="boldface">
                CONTGCY PWR - ON.
            </li>
            <li class="boldface">
                Altitude/Airspeed - AS REQUIRED.
            </li>
            <li class="boldface">
                Fuel/stores - JETTISON AS REQUIRED.
            </li>
            <li class="boldface">
                ENG Anti-ice - AS REQUIRED.
            </li>
            <li>
                Analyze.
            </li>
        </ol>
        <p>
            If no indication of mechanical malfunction or engine fire:
        </p>
        <ol start="7">
            <li>
                Perform Engine Restart Procedure.
            </li>
        </ol>
        <p>
            If Engine Restart Procedure is not to be performed:
        </p>
        <ol start="8">
            <li>
                Conduct EMER ENG SHUTDOWN.
            </li>
            <li>
                LAND AS SOON AS PRACTICABLE.
            </li>
        </ol>
    </div>
    <p>
        This is some regular text.
    </p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:39:05.160

这能解决你的问题吗？[http://jsfiddle.net/65nhJ/](http://jsfiddle.net/65nhJ/)

```
<div id="borderImage" >
    <div class="ep" >Text</div>
</div> 
```

CSS：

```
#borderImage{
   /* background-image: url(chapter_3_background-small.png); */ /*Your border image*/
    background-color: red; /*removeme*/
    width: 70%;
    margin: 0 auto;
    padding: 20px; /*Border size*/
}
.ep {
    background-color: white;
} 
```

不要使用真正的边框图像，而是使用带有图像背景的假父 div（重复），然后将背景设置为白色以不显示父 div 的背景（边框）。

我需要更多帮助，请发表评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T21:06:18.410

# 解决方案！

正如 José Cabo（上图）所建议的那样，我在[这里](https://developer.mozilla.org/en-US/docs/CSS/Using_CSS_gradients)`repeating-linear-gradient`偶然发现了一个属性示例，再加上内容 div 的纯白色背景，我*完全*拥有了我希望实现的目标——***所有这些都只需要几行 CSS。***

 **没有弄乱图像、角落和像素宽度...... grrr。

*简单、优雅、可扩展——漂亮！*

我要使用其他浏览器进行更多测试，但它可以在 Safari 中运行，这是朝着我想要实现的目标迈出的一大步。

[在此处查看解决方案](https://dl.dropbox.com/u/33322337/EP%20Layout%20Test%20-%20Solution.html)

问候，

和风

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"> 
    <title>
        EP Layout Test 
    </title>
    <style type="text/css" >
    .ep { 
        padding: 1.5em;
        background: -moz-repeating-linear-gradient(top left -45deg, black, black 1.1em, white 1em, white 2em); 
        background: -ms-repeating-linear-gradient(top left -45deg, black, black 1.1em, white 1em, white 2em); 
        background: -o-repeating-linear-gradient(top left -45deg, black, black 1.1em, white 1em, white 2em);
        background: -webkit-repeating-linear-gradient(-45deg, black, black 1.1em, white 1em, white 2em);
        width: 70%;
        margin-left: auto;
        margin-right: auto;
    }
    .ep_content {
        padding: .5em;
        background: white;
    }
    .ep_title {
        background-color: black;
        padding: 0.5em 0em;
        color: white;
    }
    p {
        text-align:left;
    }

    </style> 
</head>
<body>
    <p>
        This is some regular text. 
    </p>
    <div class="ep">
        <div class="ep_content">
            <h3 class="ep_title">
                SINGLE-ENGINE FAILURE/FLAMEOUT 
            </h3>
            <p>
                Symptoms: 
            </p>
            <ol>
                <li>
                    TGT, Ng, torque, and Np on malfunctioning engine decreasing toward zero. 
                </li>
                <li>
                    NO. 1 ENG OUT or NO. 2 ENG OUT warning light illuminated. 
                </li>
            </ol>
            <p>
                Corrective Action: 
            </p>
            <ol>
                <li class="boldface">
                    Nr - MAINTAIN. 
                </li>
                <li class="boldface">
                    CONTGCY PWR - ON. 
                </li>
                <li class="boldface">
                    Altitude/Airspeed - AS REQUIRED. 
                </li>
                <li class="boldface">
                    Fuel/stores - JETTISON AS REQUIRED. 
                </li>
                <li class="boldface">
                    ENG Anti-ice - AS REQUIRED. 
                </li>
                <li>
                    Analyze. 
                </li>
            </ol>
            <p>
                If no indication of mechanical malfunction or engine fire: 
            </p>
            <ol start="7">
                <li>
                    Perform Engine Restart Procedure. 
                </li>
            </ol>
            <p>
                If Engine Restart Procedure is not to be performed: 
            </p>
            <ol start="8">
                <li>
                    Conduct EMER ENG SHUTDOWN. 
                </li>
                <li>
                    LAND AS SOON AS PRACTICABLE. 
                </li>
            </ol>
        </div>
    </div>
    <p>
        This is some regular text. 
    </p>
</body> 
```**

# liferay-6 - 我的自定义 Liferay 主题看起来很奇怪

> ID：15042952
> 
> 赞同：0
> 
> 时间：2013-02-23T16:47:44.223
> 
> 标签：liferay-6

我使用 Liferay 6.1 和 IDE 作为 Eclipse Juno 版本。

我对在 Liferay 中开发新主题有疑问。

我按照以下步骤执行此操作

1.  从 IDE 中，选择名为“Test”的新 Liferay 项目并启用单选按钮主题
2.  创建了测试主题的基本结构。
3.  在 _diffs 文件夹下，我按原样复制了 4 个文件夹，即 css、images、js 和 templates
4.  使用 ant“部署”选项部署它
5.  然后最后在 Manage --> Page --> Look and Feel OPtion 下，选择 Test as Theme 并保存

我在下面的屏幕截图中表示了上述步骤。

![在此处输入图像描述](../Images/b61b23a3f6c73999fac90cddcd478628.png)

我所期望的是页面应该显示为与经典主题相同，因为我没有对任何文件夹（css、图像、js、模板）进行任何更改，但不幸的是看起来很奇怪。

请查看使用测试主题显示的页面的屏幕截图。

![在此处输入图像描述](../Images/a74a39d32351d8411530166734bb17bc.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:34:20.827

```
Its look like it is missing css.just extend the classic theme in build.xml
<project name="Fao-theme" basedir="." default="deploy">
    <import file="../build-common-theme.xml" />

    <property name="theme.parent" value="classic" />
</project> 
```

检查 [http://javadispute.com/content/how-add-custom-css-liferay](http://javadispute.com/content/how-add-custom-css-liferay)

# asp.net - ajax自动刷新更新面板后jquery不起作用

> ID：15042959
> 
> 赞同：-1
> 
> 时间：2013-02-23T16:48:04.363
> 
> 标签：asp.net, ajax, jquery

```
<script>
    !window.jQuery && document.write('<script src="jquery-1.4.3.min.js"><\/script>');
    </script>
        //this the jquery I'm using
    <script type="text/javascript" src="jquery.fancybox-1.3.4.pack.js"></script>

<script type="text/javascript">
     //the function calls the query
    $(document).ready(function x() {
        /*
        *   Examples - images
        */
            //set the position of title on image

        $("a#example7").imagebox({
            'titlePosition': 'inside'
        });
    });

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T11:22:31.603

在 updatepanels 的异步页面回发期间，$(document).ready 函数不会被触发，因此必须以其他方式执行 $(document).ready 的代码。

您可以执行以下两种方式中的任何一种：

第一种方式：

```
<script type="text/javascript">
        var prm = Sys.WebForms.PageRequestManager.getInstance();
        prm.add_initializeRequest(InitializeRequest);
        prm.add_endRequest(EndRequest);
        function InitializeRequest(sender, args) {               
            //do any action that you want to be executed before postbacks
        }
        function EndRequest(sender, args) {
            $("a#example7").imagebox({
                 'titlePosition': 'inside'
            });
        }
</script> 
```

第二种方式，即使用 RegisterStartupScript：

```
<script type="text/javascript">
            function CreateImageBox() {
                $("a#example7").imagebox({
                     'titlePosition': 'inside'
                });
            }
</script> 
```

在 c# 代码中使用：

```
ScriptManager.RegisterStartupScript(UpdatePanel1, UpdatePanelTab.GetType(), "createimagebox", "CreateImageBox();", true); 
```

# asp.net - 我的 .NET Framework 4 Web 应用程序可以在 Windows 8 上运行吗？

> ID：15042963
> 
> 赞同：-2
> 
> 时间：2013-02-23T16:48:25.580
> 
> 标签：asp.net, sql-server-2008, windows-8

我一直在使用预期的 XP 客户端计算机操作系统开发 Web 应用程序。我刚刚发现客户将他们的机器升级到了 Windows 8。

所以我的问题是：

*   我还能按预期在 Win 8 机器上部署我的 Web 应用程序（.NET 4.0 和 2008 SQL Server express 后端）吗？
*   在 Win 8 上运行我的应用程序是否有任何顾虑？

我还没来得及检查 Windows 8，因为我没想到会这样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:50:47.390

是的，.NET 4.0 应用程序可以在 Windows 8 和 Windows Server 2008/2012 上正常运行。

# android - 如何禁用列表视图中的其他项目

> ID：15042965
> 
> 赞同：0
> 
> 时间：2013-02-23T16:49:04.207
> 
> 标签：android, sqlite, listview

我有一个列表视图，这个设置就像猜标志游戏，在你完成之前的关卡之前你不能继续下一个关卡。我已经整晚都在搜索，我发现了有关在列表视图中禁用其他项目的示例和问题，但我找不到可以在我的问题中使用的具体答案。现在我在问。**如何禁用列表视图中的其他项目？**并在它们之前的级别完成时启用它们，我还试图通过从 sqlite 数据库获取“级别状态”来实现这一点。

这是扩展 ListActivity 的 java 代码：

```
static final String[] LEVELS = new String[] { "Level 1", "Level 2", "Level 3",
        "Level 4", "Level 5", "Level 6", "Level 7", "Level 8", "Level 9", "Level 10" };

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setListAdapter(new ArrayAdapter<String>(this, R.layout.activity_play, LEVELS));

        final ListView listView = getListView();
        listView.setTextFilterEnabled(true);

        listView.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(
                    AdapterView<?> parent, View v, int position, long id) {
                        //Toast.makeText(getApplicationContext(), ((TextView) v).getText(), Toast.LENGTH_SHORT).show();
                        switch(position) {          
                        case 0:
                            Intent lvlOne = new Intent(".LevelOneActivity");
                            startActivity(lvlOne);                          
                            break;
                        case 1:
                            Intent lvlTwo = new Intent(".LevelTwoActivity");
                            startActivity(lvlTwo);
                            break;
                        case 2:
                            break;
                        case 3:
                            break;
                        case 4:
                            break;
                        case 5:
                            break;
                        case 6:
                            break;
                        case 7:
                            break;
                        case 8:
                            break;
                        case 9:
                            break;
                        default:
                            break;
                        }
                    }
        });
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:11:57.923

我认为你应该只做简单的课程来保持你的水平和应该开始的课程

```
public class ListItemInfo
{
String mActivityToStart;
int mLevel
} 
```

然后只需在创建视图时将在适配器中保存的每个列表项添加一个 TAG

在那之后

```
listView.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(
                    AdapterView<?> parent, View v, int position, long id) 
{               
if (#DB GET UNLOCKED LVL) >= ((ListItemInfo)v.getTag()).mActivityToStart)
 {
  Intent lvlOne = new Intent(getContext(), ((ListItemInfo)v.getTag()).mLevel);
                            startActivity(lvlOne);   
 }
}); 
```

# http - 消息传递是请求/回复的良好实现吗

> ID：15042968
> 
> 赞同：2
> 
> 时间：2013-02-23T16:49:21.073
> 
> 标签：http, jms, messaging, tibco-rv

JMS 或消息传递非常适合捆绑不同的应用程序并形成许多 ESB 和 SOA 架构的基础架构。

但是，假设应用程序 A 需要立即响应应用程序 B 上的服务，例如需要订单的供应详细信息或需要立即确认某些更新。从性能的角度来看，消息传递是否是正确的解决方案？通常，客户端将连接到队列上的 MoM - 然后必须空闲的侦听器将拾取消息并转发到服务器端处理器 - 它将处理响应并将其发送回队列或主题和请求客户将遵循相同的过程并拿起它。如果消息大小很大，MoM 也必须将其考虑在内。

让我想知道 Http 是否是访问此类解决方案而不是通过消息传递路由的更好解决方案？我已经看到很多应用程序使用像 AMQ 或 TIBCO Rvd 这样的 MoM 来实际用于即时请求/响应 - 但这是糟糕的设计，还是一些微调或设置使其与 Http 相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T22:22:52.053

这真的取决于你的要求。通常消息传递服务将支持以下一项或全部：

*   保证交货
*   事务性的
*   持久性（即消息在传递之前一直存在，即使系统在此期间出现故障）

HTTP 连接不能[轻松] 实现这些属性，但话又说回来，如果您不需要它们，那么我想您可以证明“*简单*”HTTP 将提供更简单、更轻量级的解决方案。（强调“简单”，因为一些消息传递实现将通过 HTTP 运行）。

我不认为通过消息传递实现的请求/响应本身就是糟糕的设计。我的意思是，事情是这样的......你是否在实施这个过程的两个方面？如果没有，并且您已经建立了可以响应请求的消息传递服务，除了所有其他考虑因素之外，这似乎是要走的路......并且由于某些设计概念而绕过它以使用 HTTP 重新实现将需要一些公平在我看来，这背后有很强的推理能力。

但反过来也是如此。如果您已经是 HTTP 可访问资源，并且您没有任何超严格的要求可能会建议更强大的消息传递解决方案，那么我不会在没有保证的情况下强行使用它。

如果您完全使用 tabula-rasa 并且您必须从头开始实施双方......那么......在这里发布另一个问题并提供一些细节！:)

# c - C中的运算符优先级

> ID：15042970
> 
> 赞同：-2
> 
> 时间：2013-02-23T16:49:32.593
> 
> 标签：c, gcc, operators

无法解释以下程序的输出。据我所知，输出应该是 19，但运行它会给我 20 的输出。我使用 gcc 编译这个程序。

```
int main()
{ 

    int x, y = 5;

    x = ++y + ++y + --y;
    printf("%d", x);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T16:52:40.760

`y`当您在两个序列点（在您的情况下，语句的结尾）之间多次修改时，您的程序会利用未定义的行为。如果你用 开启警告`-Wall`，你的编译器甚至可能会警告你。

* * *

## 回答 #2

> 赞同：-6
> 
> 时间：2013-02-23T16:53:08.967

6+7+6 = 19 所以 19 将是你的输出

# java - 部署 java 应用程序 (Tomcat/Glassfish)

> ID：15042973
> 
> 赞同：0
> 
> 时间：2013-02-23T16:49:41.163
> 
> 标签：java, jakarta-ee, tomcat, glassfish, web-deployment

我们目前正在为大学开发一个项目，我们希望将其实现为逻辑模块和 UI 模块。我们几乎没有部署 Web 应用程序的经验，但是我们提出了以下替代方案：

1.  将其部署为单个 WAR 项目（这将解决我们在将 UI 与应用程序后端通信时遇到的问题）。
2.  使用 Web 服务在同一服务器上部署两个 WAR 项目，以便在项目之间进行通信。（我们有一个使用这种方法的原型部署在 Tomcat 服务器上）
3.  部署 WAR 项目和 EJB 项目。
4.  部署一个包含对 WAR 和 EJB 项目的引用的 EAR 项目。（我们有一个使用这种方法的原型部署在 Glassfish 服务器上）

我们想知道这些替代方案中是否有任何一个不正确，或者是否有任何替代方案比另一个更好。具体来说，为什么将项目部署为 EAR 模块有用（或没有用）？

该项目现在正在启动，所以我们现在只会处理几百个用户。但是，如果项目成功，我们将需要处理数百万用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:03:18.727

尽管 Tomcat 是一个 servlet 容器，但没有一个替代方案是不正确的，如果您想要在那里使用 EJB，您需要像[TomEE](http://tomee.apache.org/apache-tomee.html)这样的东西，它是 Tomcat 扩展到完全 EE 支持的。或者使用那个 Glassfish。

什么是最好的取决于您的具体要求：您是否需要/更重视模块的解耦，或者您是否希望将事物捆绑在一起具有一致性和可靠性。EJB 还具有一些可能令人感兴趣的额外好处，但它们并不适用于每个项目。请注意，除了提到的替代方案之外，还有其他替代方案，例如基于 JMS 的通信、HTTP REST 通信以及使用 OSGi 来解耦包。

关于为什么将项目部署为 EAR 模块会很有用，引用维基百科：“EAR（Enterprise ARchive）是 Java EE 用于将一个或多个模块打包到单个存档中的一种文件格式，以便部署各种模块到应用程序服务器上同时发生且连贯。它还包含称为部署描述符的 XML 文件，用于描述如何部署模块。”。所以基本上你得到了归结为可靠性的耦合的好处，你总是知道你的模块是如何部署的。EAR 模块很好地支持 EE 机制，例如 EJB 模块，并且您获得了一个可控的容器。

已经存在一个线程[什么时候适合使用 EAR 以及您的应用程序什么时候应该在 WAR 中？](https://stackoverflow.com/questions/1364273/when-is-it-appropriate-to-use-an-ear-and-when-should-your-apps-be-in-wars)，这可能很有趣。

# c# - Tpl 的延续和例外？

> ID：15042975
> 
> 赞同：1
> 
> 时间：2013-02-23T16:49:44.960
> 
> 标签：c#, .net-4.0, task-parallel-library, task

如果我有一个引发异常的任务，如果有异常，我可以检查继续：

```
Task task1 = Task.Factory.StartNew (() => { throw null; });
Task task2 = task1.ContinueWith (ant => Console.Write (ant.Exception)); 
```

但我也知道：

> 如果**前件**抛出并且延续**未能**查询前件的 Exception 属性（并且没有以其他方式等待前件），则该异常被视为未处理并且 **应用程序死亡**。

所以我尝试了：

```
Task task1 = Task.Factory.StartNew (() => { throw null; });
Task task2 = task1.ContinueWith (ant => Console.Write (1));//1 
```

但应用程序没有崩溃。

请问，我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T17:30:23.573

发生了一些不同的事情：

首先，如果你调用`Wait()`一个 faulted `Task`，它*总是*会抛出一个异常，无论你是否已经观察到它。在您的代码中，这意味着如果您`task.Wait()`从调用`Main()`，整个应用程序将崩溃，因为您在`Main()`.

其次， s[中未处理异常的行为`Task`在 .Net 4.5 中发生了变化](http://blogs.msdn.com/b/pfxteam/archive/2011/09/28/10217876.aspx)，它们将不再导致应用程序崩溃。本文还介绍了如何切换回原始行为。如果您安装了 .Net 4.5，这也适用于面向 .Net 4.0 的应用程序（例如使用 VS 2010 构建的应用程序）。

第三，对于 .net 4.0 行为，应用程序*在`Task`被垃圾回收*时崩溃（假设在那之前没有观察到异常）。这是因为在此之前，您的代码仍有可能观察到该异常。

因此，以下代码使应用程序崩溃（假设您在安装了 .Net 4.5 的情况下启用了 .Net 4.0 行为）：

```
static void Main()
{
    Task.Factory.StartNew(() => { throw new Exception(); });

    // give the Task some time to run
    Thread.Sleep(100);

    GC.Collect();
} 
```

您的代码没有崩溃，因为在应用程序正常退出之前 GC 没有机会运行。

# php - 在发布帖子之前检查字段值（wordpress）

> ID：15042977
> 
> 赞同：0
> 
> 时间：2013-02-23T16:49:51.540
> 
> 标签：php, jquery, ajax, wordpress, wordpress-theming

我在我的编辑器中定义了许多自定义字段，来自许多来源（各种插件和硬编码的 php）。

当我点击发布按钮时，我如何检查特定字段是否已成为字段（如果 $_POST['field'] 有任何值），如果没有，则不允许发布帖子。

换句话说，使其成为必填字段。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:13:34.020

两个互补的验证：

1) JS/jQuery 中的客户端验证：

如果特定字段为空，则检查事件（单击、模糊等），然后为提交表单返回 false，否则无论如何都提交。

2）PHP中的服务器端验证：

如果`$_POST['field']`为空，则重定向到带有已填充内容的表单页面，其中特定字段被标记为空内容。否则，允许发布帖子。

您可以根据需要进行这些验证。

# css - Bootstrap 响应式 CSS 图像宽度倾斜和扭曲

> ID：15042986
> 
> 赞同：3
> 
> 时间：2013-02-23T16:50:50.553
> 
> 标签：css, twitter-bootstrap

我正在使用 Bootstrap 创建一个网站，该网站使用占据页面大部分的轮播组件。我发现当我调整浏览器窗口的大小并水平拖动视口时，图像宽度会倾斜和扭曲。我为我的轮播设置了以下整体 CSS 样式以及不同宽度的媒体查询。

是否对我的 CSS 规则或属性进行了任何修改，`.carousel .item`以`.carousel img`防止水平拖动浏览器窗口时图像的宽度变形？我在想`width:100%;`我可能解决这个问题吗？

这是水平调整浏览器大小时发生倾斜的图像： ![在此处输入图像描述](../Images/c1006b1ae3c2fa12cb1d0f9fd3bd76ea.png)

这是网站：[http ://www.the-session.co.uk/jen/](http://www.the-session.co.uk/jen/)

这是CSS：

```
.carousel .item {
  height: 900px;
}
.carousel img {
  min-width: 100%;
  height: 900px;
}

@media (max-width: 979px) {

  .carousel .item {
    height: 500px;
  }
  .carousel img {
    width: auto;
    height: 500px;
  }
}

@media (max-width: 767px) {

  .carousel .item {
    height: 300px;
  }
  .carousel img {
    height: 300px;
  } 
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-16T18:23:33.817

问题在于您正在定义导致问题的特定高度和/或宽度（取决于您的布局）。如果您的设计允许，请将两个@media 文件中的*“height:900px”*从*.carousel img*更改为*“height:auto”*，这样您的图像就不会被扭曲。

然而，如果期望的结果是实际让轮播图像扩展以填充整个视口，则需要另一个解决方案，可能需要将图像更改为背景图像以填充绝对定位的 div。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-24T02:31:10.413

您在媒体查询中设置了错误的高度值。由于您在主 css 中的 img 高度设置为 `height:900px;`您需要执行以下操作：

```
@media (max-width: 979px) {

 .carousel .item {
     height: 750px;
 }
  .carousel img {
    width: auto;
    height: 75 0px;
 }
}

@media (max-width: 767px) {

   .carousel .item {
     height: 600px;
    }
   .carousel img {
     height: 600px;
 } 
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-23T17:23:08.187

尝试以这种方式缩放图像的问题在于您没有保留图像的初始纵横比。

相反，尝试`background-size: contain`. 这指示浏览器按比例缩放图像，以使图像沿长轴填充容器。

# symfony - 使用 FOSUserBundle 更改另一个用户的密码

> ID：15042988
> 
> 赞同：2
> 
> 时间：2013-02-23T16:50:57.947
> 
> 标签：symfony, fosuserbundle

我的系统中有两个角色：用户和管理员。默认情况下，当某人以用户或管理员身份登录时，他可以使用 FOSUserBundle 的实现形式修改自己的密码。但是我想禁止用户更改自己的密码，必须向管理员请求，所以管理员会重置它，要么引入管理员选择的新密码，要么生成随机密码。我还想向用户发送一封电子邮件，告诉他他的密码已更改，从现在开始他必须使用新密码。但我找不到如何做到这一点。有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-05-07T12:01:52.050

如果您希望管理员更改其他用户的密码，您可以使用自己的表单：

```
class UserType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            ->add('username',               TextType::class, array(
                                                    'required' => true,
                                                    'label' => "Username "
                                                    ))
            ->add('email',                  TextType::class, array(
                                                    'required' => true,
                                                    'label' => "Adresse email "
                                                    ))
            ->add('plainPassword',          RepeatedType::class, array(
                                                    'type' => PasswordType::class,
                                                    'options' => array('translation_domain' => 'FOSUserBundle'),
                                                    'first_options' => array('label' => 'form.password'),
                                                    'second_options' => array('label' => 'form.password_confirmation'),
                                                    'invalid_message' => 'fos_user.password.mismatch',
                                                    ))
            ->add('roles',                  ChoiceType::class, array(
                                                    'required' => true,
                                                    'choices' => array('Salarié' => 'ROLE_SALARIE', 'Admin' => 'ROLE_ADMIN'),
                                                    'multiple' => true,
                                                    'expanded'=>true,
                                                    'label' => "Rôle ",
                                                    'label_attr' => array('class' => 'checkbox-inline')
                                                    ))
        ;
    } 
```

//...

然后，在您的控制器中：

```
public function updateAction(Request $request, Member $user)
{
    $em = $this->getDoctrine()->getManager();

    $form = $this->createEditForm($user);
    $form->handleRequest($request);

    if ($form->isValid()) {
        $userManager = $this->container->get('fos_user.user_manager');
        $userManager->updatePassword($user);
        $em->flush(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T18:09:22.507

`fos_user_change_password`您可以通过删除文件中的和`fos_user_resetting`路由来防止用户更改密码`app/config/routing.yml`。这样，用户和管理员都无法通过页面更改自己的密码`/profile`。

然后，您需要创建一个安全的控制器操作，允许管理员更改密码并发送电子邮件。为此，您可以使用 FOSUserBundle`UserManager`及其`setPlainPassword()`方法。

看一下文档：

[Symfony2 安全性](http://symfony.com/doc/current/book/security.html)

[FOSUserBundle 用户管理器](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/user_manager.md)

[如何发送电子邮件](http://symfony.com/doc/current/cookbook/email/email.html)

# javascript - 改进的 isNumeric() 函数？

> ID：15042989
> 
> 赞同：39
> 
> 时间：2013-02-23T16:50:58.267
> 
> 标签：javascript, validation, numbers, isnumeric

在一些项目中，我需要验证一些数据，并尽可能确定它是可用于数学运算的 javascript 数值。

jQuery 和其他一些 javascript 库已经包含这样的函数，通常称为 isNumeric。还有一篇[关于 stackoverflow](https://stackoverflow.com/a/1830844/592253)的帖子已被广泛接受为答案，与前面提到的库正在使用的通用例程相同。

```
function isNumber(n) {
  return !isNaN(parseFloat(n)) && isFinite(n);
} 
```

作为我的第一篇文章，我无法在该线程中回复。我在接受的帖子中遇到的问题是，似乎有一些极端情况影响了我正在做的一些工作，因此我进行了一些更改以尝试解决我遇到的问题。

首先，如果参数是长度为 1 的数组，并且该单个元素是上述逻辑视为数字的类型，则上面的代码将返回 true。在我看来，如果它是一个数组，那么它就不是数字的。

为了缓解这个问题，我添加了一个检查以从逻辑中折扣数组

```
function isNumber(n) {
  return Object.prototype.toString.call(n) !== '[object Array]' &&!isNaN(parseFloat(n)) && isFinite(n);
} 
```

当然，你也可以使用`Array.isArray`代替`Object.prototype.toString.call(n) !== '[object Array]'`

**编辑：**我已更改代码以反映数组的通用测试，或者您可以使用 jquery`$.isArray`或原型`Object.isArray`

我的第二个问题是负十六进制整数文字字符串（“-0xA”-> -10）没有被算作数字。但是，正十六进制整数文字字符串（“0xA”-> 10）被视为数字。我需要两者都是有效的数字。

然后我修改了逻辑以考虑到这一点。

```
function isNumber(n) {
  return Object.prototype.toString.call(n) !== '[object Array]' &&!isNaN(parseFloat(n)) && isFinite(n.toString().replace(/^-/, ''));
} 
```

如果您担心每次调用函数时创建正则表达式，那么您可以在闭包中重写它，就像这样

```
isNumber = (function () {
  var rx = /^-/;

  return function (n) {
      return Object.prototype.toString.call(n) !== '[object Array]' && !isNaN(parseFloat(n)) && isFinite(n.toString().replace(rx, ''));
  };
}()); 
```

然后我拿了 CMS [+30 测试用例并](http://dl.getdropbox.com/u/35146/js/tests/isNumber.html)[在 jsfiddle 上](http://jsfiddle.net/Xotic750/2q8pp/embedded/result/)克隆了测试，添加了我的额外测试用例和我上面描述的解决方案。

一切似乎都按预期工作，我没有遇到任何问题。您可以看到任何问题，代码或理论吗？

它可能不会取代广泛接受/使用的答案，但如果这是您所期望的 isNumeric 函数的结果，那么希望这会有所帮助。

**编辑：正如**[Bergi](https://stackoverflow.com/a/15230431/592253)所指出的，还有其他可能的对象可以被认为是数字的，白名单比黑名单更好。考虑到这一点，我将添加到标准中。

我希望我的 isNumeric 函数只考虑数字或字符串

考虑到这一点，最好使用

```
function isNumber(n) {
  return (Object.prototype.toString.call(n) === '[object Number]' || Object.prototype.toString.call(n) === '[object String]') &&!isNaN(parseFloat(n)) && isFinite(n.toString().replace(/^-/, ''));
} 
```

这已添加为测试 22

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T17:36:38.163

> 在我看来，如果它是一个数组，那么它就不是数字的。为了缓解这个问题，我添加了一个检查以从逻辑中折扣数组

您也可以在任何其他对象上遇到这个问题，例如`{toString:function(){return "1.2";}}`. 你认为哪些对象是数字的？`Number`对象？没有任何？

与其尝试将某些未通过测试的事物列入黑名单，不如将您希望成为数字的事物明确列入白名单。你的函数应该得到什么，原始字符串和数字？然后准确地测试它们：

```
(typeof n == "string" || typeof n == "number") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T13:54:03.520

如果您可以使用正则表达式，这可能会奏效：

```
function (n) 
    { 
    return (Object.prototype.toString.call(n) === '[object Number]' ||
            Object.prototype.toString.call(n) === '[object String]') && 
           (typeof(n) != 'undefined')  &&  (n!=null) && 
           (/^-?\d+((.\d)?\d*(e[-]?\d)?(\d)*)$/.test(n.toString()) ||
           /^-?0x[0-9A-F]+$/.test(n.toString()));
    } 
```

*编辑：* 修复了十六进制数字的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T01:18:29.970

```
function isNumber(value){
    return !isNaN(parseFloat(value)) && 
        isFinite(value.toString().replace(/^-/, '')) && 
        typeof value !== 'object'; 
```

}

或者 ：

```
function isNumber(value){
    return !Array.isArray(value) && !isNaN(parseFloat(value)) && 
        isFinite(value.toString().replace(/^-/, '')) && 
        Object.prototype.toString.call(value) !== '[object Object]';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-09T13:02:52.103

isNaN 函数用于检查值是否为数字。如果值是数字，则返回 true，否则返回 false。

代码：

```
 <script>

         function IsNumeric(val) {

              if (isNaN(parseFloat(val))) {

                 return false;

          }

          return true

  }

  bool IsNumeric(string);

</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T00:01:41.090

怎么样：

```
function isNumber(value) {
  value = Number(value);
  return typeof value === 'number' && !isNaN(value) && isFinite(value);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T02:02:33.617

```
function isNumber(value){return typeof value == 'number';} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-27T23:47:32.953

如果 AMD 听起来不错，请查看[mout 的 isNumber()](http://moutjs.com/docs/latest/lang.html#isNumber)。

# c++ - C++：依赖跟踪工具（逆向工程）

> ID：15042991
> 
> 赞同：1
> 
> 时间：2013-02-23T16:51:02.787
> 
> 标签：c++, dependencies

我的问题与类似的问题不同，例如：

[逆向工程 C++ 的工具（即查看 C++ 类）](https://stackoverflow.com/questions/8312328/tools-to-reverse-engineer-c-i-e-to-view-c-classes)

而不是寻找类图，我更感兴趣的是寻找调用链和依赖关系并生成漂亮的图表。

有这样的工具吗？我知道**cscope**和**ctags**可以做一些我想做的事情，但是以非常低级的交互方式（一次一个查询）。我想要更自动化的东西，例如，给定一个 API，找到它的所有子例程调用路径，直到它到达叶子并将它们显示给我。

已经有这个工具了吗？是否有可能在二进制级别上做到这一点？像库中的逆向工程函数依赖项（.a、.so、.dll 作为输入）？

**编辑：**

我更喜欢静态分析工具而不是分析器，因为我希望它也适用于库和模块代码。

我也更喜欢跨平台的解决方案。我主要使用 Mac，但 Linux 或 Windows 的工具也会很有趣。

**更新**

在研究了这些建议后，我决定 Doxygen 是我想要的。它提供调用者和被调用者图表，并使用静态分析，跨平台，免费。

感谢所有其他建议。他们让我大开眼界。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T17:08:28.163

CppDepend 看起来非常适合这项任务。

![在此处输入图像描述](../Images/2b3b0ecbf65651f8e9982953e56939a5.png)

[http://www.cppdepend.com/](http://www.cppdepend.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T18:16:08.883

Doxygen 可以显示调用者和被调用者树：
[doxygen](http://www.doxygen.nl/ "多氧")

**编辑1：**
![示例 Doxygen 调用树](../Images/665c4789876dcad88e9a9e4b00dbb64d.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T16:54:35.017

您可以使用 DEPENDS 应用程序来检测 Windows 中的大多数 C C++ 和 C# 库。
但仍然不会给你打电话链......
这里的链接[取决于](http://www.dependencywalker.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-23T17:04:23.580

在您可以使用的 Windows 上`CodeTune`，它会给您显示函数依赖关系的调用图

[http://www.thewallsoft.com/codetune-documentation/](http://www.thewallsoft.com/codetune-documentation/)

在 GNU/Linux 上，您可以使用`gprof`此可视化工具来创建调用图

[http://code.google.com/p/jrfonseca/wiki/XDot#Screenshots](http://code.google.com/p/jrfonseca/wiki/XDot#Screenshots)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-24T08:59:48.920

**从评论中推广。**

您是否尝试过将 valgrind 与[callgrind](http://valgrind.org/docs/manual/cl-manual.html)工具一起使用？

Valgrind 对调试很有用，但 valgrind 中的 callgrind 工具对于分析和了解哪些函数调用了哪些其他函数非常有用。它带有一个名为[kcachegrind](http://kcachegrind.sourceforge.net/html/Home.html)的可视化工具，可让您在函数调用的其他块中查看块。

而且它是**完全免费**的。

![在此处输入图像描述](../Images/726732231e338b070d243caa951a591e.png)

# excel - 如何在 Excel VBA 中获取总和值

> ID：15042992
> 
> 赞同：0
> 
> 时间：2013-02-23T16:51:08.933
> 
> 标签：excel, vba

我是 Excel VBA 的新手。有人可以帮我解决这个问题：

如果`C5`or`D5`不为空，则从单元格值中减去它们`B5`并获得单元格中的总和`E5`，

```
EX: E5= (C5+D5)-B5 
```

同时 的值`E5`应该从值中减少`B5`

```
EX: B5=B5-E5 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-17T20:01:05.270

好吧，如果仅根据您的描述，它看起来像这样：

```
Sub summation()

If Cells(5, 3) <> "" Then
If Cells(5, 4) <> "" Then

    Cells(5, 5) = Cells(5, 3) + Cells(5, 4) - Cells(5, 2)
    Cells(5, 2) = Cells(5, 2) - Cells(5, 5)

End If
End If

End Sub 
```

# android - 以编程方式将 GIF 转换为 PNG

> ID：15042993
> 
> 赞同：1
> 
> 时间：2013-02-23T16:51:22.893
> 
> 标签：android, image-processing, png, gif

我有一个从网站 ( [http://radar.weather.gov/ridge/RadarImg/N0R/](http://radar.weather.gov/ridge/RadarImg/N0R/) ) 抓取的 GIF，并希望显示给用户。我正在构建 Jelly Bean (4.1) 并且在我对这个主题的搜索中发现 GIF 兼容性正在逐步用于 Android 并且完全不适用于 Jelly Bean。

所以，我想即时将 GIF 转换为 PNG。我该怎么做？是否像将字节从 GIF 读取到 PNG 文件一样简单？

我将使用 ImageView 在 UI 上显示图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T00:18:48.473

在稍微改变了我的问题后，我在这里通过全能的谷歌找到了答案：

[http://gayashan-a.blogspot.com/2012/02/android-how-to-display-gif-image-in.html](http://gayashan-a.blogspot.com/2012/02/android-how-to-display-gif-image-in.html)

总结在这里：

```
public Bitmap getBitmap(String url)
{
    Bitmap bmp = null;
    try
    {
        HttpClient client = new DefaultHttpClient();
        URI imageUri = new URI(url);
        HttpGet req = new HttpGet();
        req.setURI(imageUri);
        HttpResponse resp = client.execute(req);
        bmp = BitmapFactory.decodeStream(resp.getEntity().getContent());            
    }
    catch(URISyntaxException ex)
    {           
        Log.e("ERROR", ex.getMessage());
    }
    catch(ClientProtocolException ex)
    {
        Log.e("ERROR", ex.getMessage());
    }
    catch(IllegalStateException ex)
    {
        Log.e("ERROR", ex.getMessage());
    }
    catch(IOException ex)
    {
        Log.e("ERROR", ex.getMessage());
    }

    return bmp;
} 
```

这会将其解码为可以压缩为 PNG 的位图 ...

```
Bitmap mCurrentRadar = getBitmap("http://radar.weather.gov/ridge/RadarImg/N0R/ABC_N0R_0.gif");
ByteArrayOutputStream stream = new ByteArrayOutputStream();     
mCurrentRadar.compress(Bitmap.CompressFormat.PNG, 100, stream); 
```

...或者可以立即用于`ImageView`...

```
ImageView imageView = (ImageView) findeViewById(R.id.radarImageView);
imageView.setImageBitmap(getBitmap("http://radar.weather.gov/ridge/RadarImg/N0R/ABC_N0R_0.gif"); 
```

# c - 内联汇编，进入中断

> ID：15042996
> 
> 赞同：1
> 
> 时间：2013-02-23T16:51:42.390
> 
> 标签：c, inline-assembly, gnu-assembler

再会。我遇到了一个几天都无法解决的问题。当我尝试用 C 语言编译这个函数时出现错误。

```
void GetInInterrupt(UChar Interrupt)
{
    //asm volatile(".intel_syntax noprefix");
    asm volatile
    (
        "movb %0, %%al\n"
        "movb %%al, 1(point)\n"
        "point:\n"
        "int $0\n"
        : /*output*/ : "r" (Interrupt) /*input*/ : /*clobbered*/
    );
    //asm volatile(".att_syntax noprefix");
} 
```

我从gas中得到的信息如下：

```
Error: junk '(point)' after expression 
```

* * *

据我所知，第二行的指针有问题，但不幸的是我自己无法解决。

* * *

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T17:48:32.327

如果你可以使用 C++，那么这个：

```
template <int N> static inline void GetInInterrupt (void)
{
    __asm__ ("int %0\n" : "N"(N));
} 
```

会做。如果我使用该模板，例如：

```
GetInInterrupt<123>();
GetInInterrupt<3>();
GetInInterrupt<23>();
GetInInterrupt<0>(); 
```

这将创建以下目标代码：

```
 0:   cd 7b                   int    $0x7b
   2:   cc                      int3
   3:   cd 17                   int    $0x17
   5:   cd 00                   int    $0x0 
```

这几乎是最佳的（即使对于这种`int3`情况，这是断点操作）。`0..255`如果操作数超出范围，它也会创建编译时警告，因为`N`约束只允许这样做。

**编辑：**当然，普通的旧 C 风格宏也可以工作：

```
#define GetInInterrupt(arg) __asm__("int %0\n" : : "N"((arg)) : "cc", "memory") 
```

创建与 C++ 模板化函数相同的代码。由于`int`行为方式，最好告诉编译器（通过`"cc", "memory"`约束）屏障语义，以确保它在嵌入内联汇编时不会尝试重新排序指令。

显然，两者的局限性在于中断号必须是编译时常量。如果您绝对不希望这样，那么创建一个`switch()`例如在涵盖所有 255 个案例的帮助下创建的语句`BOOST_PP_REPEAT()`是比自我修改代码更好的选择，例如：

```
#include <boost/preprocessor/repetition/repeat.html>

#define GET_INTO_INT(a, INT, d) case INT: GetInInterrupt<INT>(); break;

void GetInInterrupt(int interruptNumber)
{
    switch(interruptNumber) {
    BOOST_PP_REPEAT(256, GET_INTO_INT, 0)
    default:
        runtime_error("interrupt Number %d out of range", interruptNumber);
    }
} 
```

这*可以*在纯 C 中完成（`__asm__`当然，如果您将模板函数调用更改为纯 C） - 因为 boost 预处理器库不*依赖*于 C++ 编译器......并且 gcc 4.7.2 为此创建了以下代码：

```
 GetInInterrupt:
.LFB0:
        cmpl    $255, %edi
        jbe     .L262
        movl    %edi, %esi
        xorl    %eax, %eax
        movl    $.LC0, %edi
        jmp     runtime_error
        .p2align 4,,10
        .p2align 3
.L262:
        movl    %edi, %edi
        jmp     *.L259(,%rdi,8)
        .section        .rodata
        .align 8
        .align 4
.L259:
        .quad   .L3
        .quad   .L4
[ ... ]
        .quad   .L258
        .text
.L257:
#APP
# 17 "tccc.c" 1
        int $254

# 0 "" 2
#NO_APP
        ret
[ ... accordingly for the other vectors ... ] 
```

请注意，如果您执行上述操作...编译器（gcc 高达并包括 4.8）*不够*智能，无法优化`switch()`离开，即即使您说它`static __inline__ ...`会创建完整的跳转表版本，`GetInInterrupt(3)`而不是内联`int3`的 as会更简单的实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T21:26:49.753

下面展示了如何写入代码中的某个位置。它确实假设代码首先是可写的，这在主流操作系统中通常不是这种情况——因为这会隐藏一些令人讨厌的错误。

```
void GetInInterrupt(UChar Interrupt)
{
    //asm volatile(".intel_syntax noprefix");
    asm volatile
    (
        "movb %0, point+1\n"
        "point:\n"
        "int $0\n"
        : /*output*/ : "r" (Interrupt) /*input*/ : /*clobbered */
    );
    //asm volatile(".att_syntax noprefix");
} 
```

我还简化了代码以避免使用两个寄存器，而只使用`Interrupt`已经存在的寄存器。如果编译器抱怨它，您可能会发现它`"a"`或`"r"`解决问题。