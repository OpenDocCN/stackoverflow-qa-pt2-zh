# StackOverflow 问答 13261000-13261999

# c - SOCK_STREAM socket listen() 导致发送 TCP syn/ack

> ID：13261004
> 
> 赞同：4
> 
> 时间：2012-11-06T23:21:00.560
> 
> 标签：c, sockets, network-programming, freebsd

我设置了一个套接字来接受 TCP 连接

```
socket(AF_INET, SOCK_STREAM, 0) 
```

然后我打电话`bind()`给`listen()``accept()`

问题是当我调用listen() 时，它会导致向客户端发送一个SYN/ACK 数据包。我以为直到我调用了 accept() 才会发生这种情况，但更糟糕的是 SYN/ACK 数据包没有确认增加一。

是什么原因造成的，我该如何解决？

谢谢

作为旁注 - 我的 TCP 连接不对称是否重要？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T00:45:14.510

您机器上的 TCP 实现可能会选择在您调用时实际“接受”传入连接`listen`。这实际上是有道理的，以避免由于“懒惰”接受而导致不必要的延迟。提醒一下，其中一个参数`listen`就是所谓的积压数，即“缓冲”接受待处理的数量。

关于syn+ack数据报中ACK的递增。我不记得协议规定了什么，但这可能是握手期间的正确行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T00:51:58.110

这是 TCP 'backlog' 队列的正常操作。它是堆栈已经完成但应用程序尚未接受的连接队列。这个队列的大小由listen() 的第二个参数设置，尽管平台可以向上或向下调整它（通常是向上）。

无论您观察到有关序列号的任何内容，都必然是正确的行为，否则将无济于事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-16T05:43:22.433

正如其他答案和评论中提到的，这是 TCP 实现的实际标准行为。

如果您坚持通过接受应用程序中的传入连接来明确完成 TCP 握手，则您有平台相关的解决方案。

对于 Windows 堆栈，您可以`SO_CONDITIONAL_ACCEPT`在侦听套接字上设置套接字选项。请参阅[winsock 文档](https://docs.microsoft.com/en-us/windows/desktop/api/winsock/nf-winsock-setsockopt)。

# android - Android异步任务异常

> ID：13261008
> 
> 赞同：4
> 
> 时间：2012-11-06T23:21:26.987
> 
> 标签：android, xml, xml-parsing, android-asynctask, nullpointerexception

我正在做一个必须从 url 获取 XML 文件并解析它的应用程序。我总是找到这个日志猫（PS：我找不到正确的 google prettify sintax 代码突出显示）：

```
11-06 23:12:44.940: E/Trace(8751): error opening trace file: No such file or directory(2)
11-06 23:12:51.345: E/Error:(8751): expected: /hr read: body (position:END_TAG </body>@6:8 in java.io.StringReader@431887b8) 
11-06 23:12:51.360: E/AndroidRuntime(8751): FATAL EXCEPTION: AsyncTask #1
11-06 23:12:51.360: E/AndroidRuntime(8751): java.lang.RuntimeException: An error occured while executing doInBackground()
11-06 23:12:51.360: E/AndroidRuntime(8751):     at android.os.AsyncTask$3.done(AsyncTask.java:299)
11-06 23:12:51.360: E/AndroidRuntime(8751):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
11-06 23:12:51.360: E/AndroidRuntime(8751):     at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
11-06 23:12:51.360: E/AndroidRuntime(8751):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
11-06 23:12:51.360: E/AndroidRuntime(8751):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
11-06 23:12:51.360: E/AndroidRuntime(8751):     at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
11-06 23:12:51.360: E/AndroidRuntime(8751):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
11-06 23:12:51.360: E/AndroidRuntime(8751):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
11-06 23:12:51.360: E/AndroidRuntime(8751):     at java.lang.Thread.run(Thread.java:856)
11-06 23:12:51.360: E/AndroidRuntime(8751): Caused by: java.lang.NullPointerException
11-06 23:12:51.360: E/AndroidRuntime(8751):     at com.ambro.app.Update$connection.doInBackground(Update.java:39)
11-06 23:12:51.360: E/AndroidRuntime(8751):     at com.ambro.app.Update$connection.doInBackground(Update.java:1)
11-06 23:12:51.360: E/AndroidRuntime(8751):     at android.os.AsyncTask$2.call(AsyncTask.java:287)
11-06 23:12:51.360: E/AndroidRuntime(8751):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
11-06 23:12:51.360: E/AndroidRuntime(8751):     ... 5 more 
```

xml 可以在以下位置找到：[http ://www.lookedpath.tk/apps/firstapp/version.xml](http://www.lookedpath.tk/apps/firstapp/version.xml)

update.java 代码：

```
public class Update extends Activity {
    private TextView testo2;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        setContentView(R.layout.update);
        super.onCreate(savedInstanceState);
        testo2= (TextView) findViewById(R.id.textView2);

    }
    public void goToUpdate (View view) {
        System.out.println("ciao");
        new connection().execute();
    }
    public class connection extends AsyncTask<Void, Void, Boolean> {
        protected Boolean doInBackground(Void... params) {
             boolean updated=false;
             String lastversion=null;
             Element e=null;
             final String URL = "http://www.lookedpath.tk/apps/firstapp/version.xml";
             final String VERSION = "version";
             final String APPLICATION = "application";
             XMLParser parser = new XMLParser();
             String xml = parser.getXmlFromUrl(URL); // getting XML
             Document doc = parser.getDomElement(xml); // getting DOM element

             NodeList nl = doc.getElementsByTagName(APPLICATION);
             for (int i=0;i<nl.getLength();i++) {
                e = (Element) nl.item(0);
                lastversion = parser.getValue(e, VERSION); // name child value
             }

             String actver = getString(R.string.version);
             if(actver==lastversion) updated=true;

             return updated;
        }
        protected void onPostExecute(Boolean... result) {
            if(result[0]==false){
                testo2.setText(R.string.newversion);
            } else {
                testo2.setText(R.string.nonewversion);
            }

        }

    };

} 
```

所以这是 xmlparser.java 文件：

```
public class XMLParser {
public String getXmlFromUrl(String url) {
    String xml = null;

    try {
        // defaultHttpClient
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        xml = EntityUtils.toString(httpEntity);

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
    // return XML
    return xml;
}

public Document getDomElement(String xml){
    Document doc = null;
    DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
    try {

        DocumentBuilder db = dbf.newDocumentBuilder();

        InputSource is = new InputSource();
            is.setCharacterStream(new StringReader(xml));
            doc = db.parse(is); 

        } catch (ParserConfigurationException e) {
            Log.e("Error: ", e.getMessage());
            return null;
        } catch (SAXException e) {
            Log.e("Error: ", e.getMessage());
            return null;
        } catch (IOException e) {
            Log.e("Error: ", e.getMessage());
            return null;
        }
            // return DOM
        return doc;
}
public String getValue(Element item, String str) {
    NodeList n = item.getElementsByTagName(str);
    return this.getElementValue(n.item(0));
}

public final String getElementValue( Node elem ) {
         Node child;
         if( elem != null){
             if (elem.hasChildNodes()){
                 for( child = elem.getFirstChild(); child != null; child = child.getNextSibling() ){
                     if( child.getNodeType() == Node.TEXT_NODE  ){
                         return child.getNodeValue();
                     }
                 }
             }
         }
         return "";
  }
} 
```

logcat 说错误在更新类的第 39 行：

```
NodeList nl = doc.getElementsByTagName(APPLICATION); 
```

但我无法解决问题。谁能帮我？

**更新：** 我已经修复了错误 405，但我仍然有一个空指针异常。我发现程序运行正确，但由于此异常而从未进入后执行方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T13:38:28.660

我试过你的代码没有任何问题，很好。问题出在链接中。

在浏览器中看起来像这样

```
<?xml version="1.0" encoding="UTF-8"?>
<menu>
<application>
<version>1.5</version>
</application>
</menu> 
```

但是当我打印 xml 变量时，它给了我

```
<html>
<head><title>405 Not Allowed</title></head>
<body bgcolor="white">
<center><h1>405 Not Allowed</h1></center>
<hr><center>nginx</center>
</body>
</html> 
```

然后在 dom 变量中你得到 null 并且当你尝试在 nl 变量中找到为 null 的元素时你得到错误..,。

我用其他一些 xml 提要尝试了你的代码，效果很好..,。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T06:55:53.407

从日志中，我可以看到 Update.java 第 39 行中有一个 NullPointer。您可以从那里开始。我相信它与 AsyncTask 无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T06:44:08.790

您可以检查此链接以从 xml 解析 xml。 [http://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/](http://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/)

在您的活动中，您正在开发`AsyncTask`但您忘记了覆盖`onPreExecute`方法。请参阅此示例，了解如何`AsyncTask`在您的活动中进行开发。

```
package com.androidhive.jsonparsing;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.util.ArrayList;
import java.util.HashMap;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.ListActivity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ListAdapter;
import android.widget.ListView;
import android.widget.SimpleAdapter;
import android.widget.TextView;

public class AndroidJSONParsingActivity extends ListActivity {

    // url to make request
    private static String url = "http://api.androidhive.info/contacts/";

    // JSON Node names
    private static final String TAG_CONTACTS = "contacts";
    private static final String TAG_ID = "id";
    private static final String TAG_NAME = "name";
    private static final String TAG_EMAIL = "email";
    private static final String TAG_ADDRESS = "address";
    private static final String TAG_GENDER = "gender";
    private static final String TAG_PHONE = "phone";
    private static final String TAG_PHONE_MOBILE = "mobile";
    private static final String TAG_PHONE_HOME = "home";
    private static final String TAG_PHONE_OFFICE = "office";
    static InputStream is = null;
    static JSONObject jObj = null;
    static String json = "";

    // contacts JSONArray
    JSONArray contacts = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        new GetEventsTask().execute("");
    }

    protected class GetEventsTask extends
            AsyncTask<String, Integer, ArrayList<HashMap<String, String>>> {
        protected ArrayList<HashMap<String, String>> contactList;

        private final ProgressDialog dialog = new ProgressDialog(
                AndroidJSONParsingActivity.this);

        //PreExecute Method

        protected void onPreExecute() {
            this.dialog.setMessage("Loading, Please Wait..");
            this.dialog.setCancelable(false);
            this.dialog.show();
        }

        //doInBackground Method

        @Override
        protected ArrayList<HashMap<String, String>> doInBackground(
                String... params) {
            contactList = new ArrayList<HashMap<String, String>>();
            // Making HTTP request
            try {
                // defaultHttpClient
                DefaultHttpClient httpClient = new DefaultHttpClient();
                HttpPost httpPost = new HttpPost(url);

                HttpResponse httpResponse = httpClient.execute(httpPost);
                HttpEntity httpEntity = httpResponse.getEntity();
                is = httpEntity.getContent();
                BufferedReader reader = new BufferedReader(
                        new InputStreamReader(is, "iso-8859-1"), 8);
                StringBuilder sb = new StringBuilder();
                String line = null;
                while ((line = reader.readLine()) != null) {
                    sb.append(line + "\n");
                }
                is.close();
                json = sb.toString();

            } catch (UnsupportedEncodingException e) {
                e.printStackTrace();
            } catch (ClientProtocolException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }

            // try parse the string to a JSON object
            try {
                jObj = new JSONObject(json);
                Log.i("json objects",""+json);
            } catch (JSONException e) {
                Log.e("JSON Parser", "Error parsing data " + e.toString());
            }
            try {
                // Getting Array of Contacts
                contacts = jObj.getJSONArray(TAG_CONTACTS);

                // looping through All Contacts
                for (int i = 0; i < contacts.length(); i++) {
                    JSONObject c = contacts.getJSONObject(i);

                    // Storing each json item in variable
                    String id = c.getString(TAG_ID);
                    String name = c.getString(TAG_NAME);
                    String email = c.getString(TAG_EMAIL);
                    String address = c.getString(TAG_ADDRESS);
                    String gender = c.getString(TAG_GENDER);

                    // Phone number is agin JSON Object
                    JSONObject phone = c.getJSONObject(TAG_PHONE);
                    String mobile = phone.getString(TAG_PHONE_MOBILE);
                    String home = phone.getString(TAG_PHONE_HOME);
                    String office = phone.getString(TAG_PHONE_OFFICE);

                    // creating new HashMap
                    HashMap<String, String> map = new HashMap<String, String>();

                    // adding each child node to HashMap key => value
                    map.put(TAG_ID, id);
                    map.put(TAG_NAME, name);
                    map.put(TAG_EMAIL, email);
                    map.put(TAG_PHONE_MOBILE, mobile);

                    // adding HashList to ArrayList
                    contactList.add(map);
                }
            } catch (JSONException e) {
                e.printStackTrace();
            }

            return contactList;
        }

        //onPostExecute Method 

        protected void onPostExecute(ArrayList<HashMap<String, String>> result) {

            ListAdapter adapter = new SimpleAdapter(getApplicationContext(),
                    contactList, R.layout.list_item, new String[] { TAG_NAME,
                            TAG_EMAIL, TAG_PHONE_MOBILE }, new int[] {
                            R.id.name, R.id.email, R.id.mobile });
            // selecting single ListView item
            ListView lv = getListView();
            lv.setAdapter(adapter);

            // Launching new screen on Selecting Single ListItem
            lv.setOnItemClickListener(new OnItemClickListener() {
                @Override
                public void onItemClick(AdapterView<?> parent, View view,
                        int position, long id) {
                    // getting values from selected ListItem
                    String name = ((TextView) view.findViewById(R.id.name)).getText().toString();
                    String cost = ((TextView) view.findViewById(R.id.email)).getText().toString();
                    String description = ((TextView) view.findViewById(R.id.mobile)).getText().toString();

                    // Starting new intent
                    Intent in = new Intent(getApplicationContext(),SingleMenuItemActivity.class);
                    in.putExtra(TAG_NAME, name);
                    in.putExtra(TAG_EMAIL, cost);
                    in.putExtra(TAG_PHONE_MOBILE, description);
                    startActivity(in);
                }
            });
            if (this.dialog.isShowing()) {
                this.dialog.dismiss();
            }
        }

    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-18T22:29:30.587

您必须将正确的 DTD 添加到您的 xml（文档类型定义）中，尝试一下，您会看到解析运行顺利。第 1 步：生成正确的 DTD 第 2 步：将其添加到您的 xml 文件并保存 第 3 步：上传您的 xml 文件，解析它并享受。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-07T07:00:57.260

你在那个位置只得到空 xml 所以调试你的应用程序首先检查你得到的任何 xml 响应？？？？

如果你得到 null xml 然后使用下面的代码来解析 xml

```
import org.xml.sax.Attributes;
import org.xml.sax.SAXException;
import org.xml.sax.helpers.DefaultHandler;
import android.util.Log;
public class XMLHandler extends DefaultHandler {

String elementValue = null;
Boolean elementOn = false;
userdata d = userdata.getInstance();
public static XMLGettersSetters data = null;

public static XMLGettersSetters getXMLData() {
    return data;
}

public static void setXMLData(XMLGettersSetters data) {
    XMLHandler.data = data;
}

/**

 * This will be called when the tags of the XML starts.

 **/

@Override

public void startElement(String uri, String localName, String qName,

        Attributes attributes) throws SAXException {

    elementOn = true;

    if (localName.equals("application"))

    {
        data = new XMLGettersSetters();
    } 

}

/**

 * This will be called when the tags of the XML end.

 **/

@Override

public void endElement(String uri, String localName, String qName)

        throws SAXException {

    elementOn = false;

    /**

     * Sets the values after retrieving the values from the XML tags

     * */

    if (localName.equalsIgnoreCase("version")){

        System.out.println("ststus" + elementValue);

        d.setIsregi(elementValue);

    }

/**

 * This is called to get the tags value

 **/

@Override

public void characters(char[] ch, int start, int length)

        throws SAXException {

    if (elementOn) {

        elementValue = new String(ch, start, length);

        elementOn = false;

    }
}
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-06T23:29:37.240

嘿，看看我的[图书馆](http://code.google.com/p/javaxmlquery/)。

您可以使用它轻松操作 XML ;)

# android - Android 支持库错误

> ID：13261012
> 
> 赞同：-1
> 
> 时间：2012-11-06T23:21:58.873
> 
> 标签：android, android-support-library

我最近更新了一个使用 Android 支持库 (android-support-v4.jar) 的项目

我通过“Android 工具 > 添加支持库”更新了支持库

执行此操作后，我的项目无法构建，并且以前运行良好的以下导入现在错误。

```
import android.support.v4.app.FragmentManager;
import android.support.v4.widget.SearchViewCompat;
import android.support.v4.widget.SearchViewCompat.OnQueryTextListenerCompat; 
```

错误很长，“无法解决导入 android.support.v4.widget”的行

我做错了什么？我如何让它再次工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:57:42.490

jar 文件也需要在您的构建路径中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T23:31:02.530

您使用的是哪个 API？最好使用 Eclipse(ADT) 插件中的 Android SDK Manager 来下载支持库。

Android Support v4 JAR 需要位于项目的“libs”文件夹中。确保您在文件夹中“复制”了 JAR。最好自己手动完成以确保它在那里。

修复 Eclipse 中“红色”导入错误的最佳方法是

```
Ctrl + Shift + O 
```

自动导入正确的导入。

请让我知道这可不可以帮你！我也遇到了 Android 导入问题。

问候，

# oracle - 无法使用 EFPowerTools Beta2 VS2012 对代码进行逆向工程

> ID：13261018
> 
> 赞同：4
> 
> 时间：2012-11-06T23:22:46.987
> 
> 标签：oracle, entity-framework, ef-power-tools

我想首先使用 PowerTools 对代码进行逆向工程。当我从本地 MS-SQL 数据库而不是 Oracle DB 进行逆向工程时，它可以工作。我在输出控制台中收到以下错误：

```
 System.Data.ProviderIncompatibleException: The provider did not return a ProviderManifestToken string. ---> Oracle.DataAccess.Client.OracleException: ORA-1005: null password given; logon denied
   at Oracle.DataAccess.Client.OracleException.HandleErrorHelper(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, OpoSqlValCtx* pOpoSqlValCtx, Object src, String procedure, Boolean bCheck)
   at Oracle.DataAccess.Client.OracleException.HandleError(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, Object src)
   at Oracle.DataAccess.Client.OracleConnection.Open()
   at Oracle.DataAccess.Client.EFOracleProviderServices.GetDbProviderManifestToken(DbConnection connection)
   at System.Data.Common.DbProviderServices.GetProviderManifestToken(DbConnection connection)
   --- End of inner exception stack trace ---
   at System.Data.Common.DbProviderServices.GetProviderManifestToken(DbConnection connection)
   at System.Data.Entity.Design.EntityStoreSchemaGenerator.GetProviderSchemaMetadataWorkspace(DbProviderServices providerServices, DbConnection providerConnection, Version targetEntityFrameworkVersion)
   at System.Data.Entity.Design.EntityStoreSchemaGenerator.CreateStoreSchemaConnection(String providerInvariantName, String connectionString, Version targetEntityFrameworkVersion)
   at System.Data.Entity.Design.SsdlGenerator.EntityStoreSchemaGeneratorDatabaseSchemaLoader.CreateStoreSchemaConnection(String providerInvariantName, String connectionString, Version& storeSchemaModelVersion)
   at System.Data.Entity.Design.EntityStoreSchemaGenerator..ctor(String providerInvariantName, String connectionString, String namespaceName)
   at Microsoft.DbContextPackage.Handlers.ReverseEngineerCodeFirstHandler.ReverseEngineerCodeFirst(Project project) 
```

我可以通过右键单击项目 > 添加 > ADO.NET 实体数据模型 > 选择“来自现有数据库”并按照向导的其余部分来正常生成 EF 文件。不过，我更喜欢 powertools，原因有几个（主要是映射为 .cs 文件）。为什么我在使用 Oracle 时不能进行逆向工程？TIA

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T23:57:55.710

我不确定我是否完全理解......在您尝试生成文件之前，您似乎需要检查“记住密码”框。（即使没有检查，测试也可以正常返回！）

# c++ - C++ 类设计 - 如何在基类析构函数中进行清理

> ID：13261024
> 
> 赞同：3
> 
> 时间：2012-11-06T23:23:20.410
> 
> 标签：c++, oop, virtual, feedback

对于以下问题，我无法跳出框框思考。我有一个类层次结构：

`[BaseClass] --> [Win32Class]`

`[BaseClass] --> [LinuxClass]`

`[BaseClass] --> [VxWorksClass]`

实现类将调用 API 级函数。这些是在基类的纯虚函数中完成的。

现在，当用户创建、使用并完成对象时，他应该调用该`Done`函数（来自基类），该函数将进行清理和资源释放。这种清理工作的一部分是调用一些 API 级函数——这些自然是基类中的纯虚函数，并在派生类中实现。到目前为止，一切都很好。

这就是问题所在。如果用户**没有**显式调用`Done`，则会由于资源没有被正确释放而导致各种内存泄漏。所以，我想我会让它变得简单并调用- 破坏时自动清理，我想`Done`。`~BaseClass()`好吧，没有那么多。由于`Done`对这些纯虚拟的调用，所有地狱都崩溃了。

关于如何重新设计它以避免这个问题的任何想法？

示例代码

```
class BaseClass{ 
  virtual ~BaseClass(){
    Done();
  }
  void Done(){
    // A bunch of OS-independent clean-up logic
    Cleanup();
    // some more OS-independent clean-up logic
  }
  virtual void Cleanup() = 0;
};
class Win32Class : public BaseClass{
  virtual void Cleanup(){
    // call some Win32-specific cleanup code
  }
};
class LinuxClass : public BaseClass{
  virtual void Cleanup(){
    // call some Linux-specific cleanup code
  }
}; 
```

===========================================
这是我的解决方案。使用包装类。不要调用or`Done`的析构函数`Win32Class``BaseClass`

```
class Win32Wrapper{
public:
  Win32Class* object_;
public:
  Win32Wrapper(){
    this->object_ = new Win32Class;
  }
  ~Win32Wrapper(){
    this->object_->Done();
    delete this->object_;
  }
}; 
```

== 如何在析构函数中调用 Pure Virtuals ==

```
class Base{
public:
  Base(){
  }
  virtual ~Base(){
    Done();
  }
  void Done(){
    Clean();
  }
  virtual void Clean() = 0;
};

class Derived : public Base{
public:  
  Derived(){
  }
  ~Derived(){
  }
  virtual void Clean(){
  }
}; 
```

用户认为该程序可以运行，因为编译器不会抱怨对 PFV in 的调用`Base::Done()`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:27:39.320

您可以将清理代码放在派生的析构函数中：

```
struct Base
{
    virtual ~Base() { }

    void CleanUp() { /* ... */ }
};

struct Derived : Base
{
    virtual ~Derived()
    {
        CleanUp();
    }
}; 
```

如果您愿意，您甚至可以将对更多虚拟函数的调用放入非虚拟`Base::CleanUp()`函数中，以允许特定于派生的行为（尽管根据您的描述，听起来您不需要那样）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T23:39:03.907

我认为 RAII 成语是您正在寻找的。

你可以在这里找到一个相当全面的描述：[http ://www.hackcraft.net/raii/](http://www.hackcraft.net/raii/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:25:22.320

你有两个选择。

1.  的用户`BaseClass`必须打电话`Done()`，任何由于不这样做而引起的错误都是他的责任。
2.  每个派生类都会在其析构函数中执行任何需要的清理工作。他们可以`BaseClass`在清理中使用函数，这些`BaseClass`函数甚至可以调用被派生类覆盖的函数。

# hadoop - 如何确定并行映射器/减速器的数量以及堆内存？

> ID：13261026
> 
> 赞同：2
> 
> 时间：2012-11-06T23:23:31.890
> 
> 标签：hadoop, mapreduce, elastic-map-reduce, emr

假设我有一个 EMR 作业在 11 个节点集群上运行：m1.small 主节点，而 10 个 m1.xlarge 从节点。

现在一个 m1.xlarge 节点有 15 GB 的 RAM。

那么如何决定可以设置的并行映射器和减速器的数量？

我的工作是内存密集型的，我希望将越来越多的堆分配给 JVM。

另一个相关问题：如果我们设置以下参数：

```
 <property><name>mapred.child.java.opts</name><value>-Xmx4096m</value></property>
 <property><name>mapred.job.reuse.jvm.num.tasks</name><value>1</value></property>
 <property><name>mapred.tasktracker.map.tasks.maximum</name><value>2</value></property>
 <property><name>mapred.tasktracker.reduce.tasks.maximum</name><value>2</value></property> 
```

那么这 4GB 将由 4 个进程（2 个映射器和 2 个减速器）共享还是每个进程都获得 4GB？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T17:04:52.757

他们每人将获得 4GB。

你应该检查任务跟踪器和数据节点的堆设置是什么，然后你就会知道你有多少内存要分配给孩子（实际的映射器/减速器）。

那么这只是一个平衡的行为。如果您需要更多内存，则需要更少的映射器/减速器，反之亦然。

还要记住你的 CPU 有多少个内核，你不希望单个内核上有 100 个映射任务。要进行调整，最好随着时间的推移监控堆使用情况和 cpu 使用情况，以便您可以调整旋钮。

# c++ - X&0 游戏 IPC FIFO 窗口

> ID：13261027
> 
> 赞同：-1
> 
> 时间：2012-11-06T23:23:47.943
> 
> 标签：c++

我想用 ci 中的 ipc 制作一个 x&0 游戏，声明 3 个字符数组，读取要选择的女巫线以及放置 x 或 0 的位置。当我尝试从客户端通过 fifo 发送行号时服务器收到一个不同的数字。例如，我发送 1 并且服务器得到 3144200 ....这是代码，它不仅仅是一次读写。这是服务器：

```
#include <windows.h>
#include <stdio.h>
#include <string.h>
#include <iostream>

int main() {
HANDLE f1, f2;
DWORD x;
char l1[3]="\0";
char l2[3]="\0";
char l3[3]="\0";
char X='x';
char* a="";
char* lineChar="";
int n=1,lineInt=0,coor=0;
printf("I am the server \n");
printf("You will play with x\n");
// creating pipes
f1=CreateNamedPipe(TEXT("\\\\.\\PIPE\\fifo1"), PIPE_ACCESS_INBOUND,PIPE_TYPE_BYTE|PIPE_WAIT, 3, 0, 0, 0, NULL);
f2=CreateNamedPipe(TEXT("\\\\.\\PIPE\\fifo2"), PIPE_ACCESS_OUTBOUND,PIPE_TYPE_BYTE|PIPE_WAIT, 3, 0, 0, 0, NULL);
ConnectNamedPipe(f1, NULL);
ConnectNamedPipe(f2, NULL);

while(n<=9){
    for(int i=0;i<=2;i++){
        printf("[%s]",&l1[i]);
    }
    printf("\n");
    for(int i=0;i<=2;i++){
        printf("[%s]",&l2[i]);
    }
    printf("\n");
    for(int i=0;i<=2;i++){
        printf("[%s]",&l3[i]);
    }
    printf("\n");
    printf("You will begin,select the line from 1 to 3 : \n");
    scanf_s("%d",&lineInt);
    x=0;
    lineChar=reinterpret_cast<char*>(lineInt);
    printf("%s",lineChar);
    //strcpy_s(a,sizeof(lineChar),lineChar);
    if (WriteFile(f2,lineChar,sizeof(lineChar)+1, &x, NULL)==0) {
                printf("writing error..%d\n", x);
    }
    n++;
}
DisconnectNamedPipe(f1);
DisconnectNamedPipe(f2);
CloseHandle(f1);
CloseHandle(f2);
} 
```

这是客户：

```
#include <windows.h>
#include <stdio.h>
#include <string.h>
#include<stdlib.h>

int main(){
HANDLE f1, f2;
DWORD x;
char l1[3]="\0";
char l2[3]="\0";
char l3[3]="\0";
char o='0';
char* lineChar="";
int n=1,lineInt=0,coor=0;
printf("I am the client \n");
printf("You will play with 0\n");

    // connect to pipes created by server
f1=CreateFile(TEXT("\\\\.\\PIPE\\fifo1"), GENERIC_WRITE, FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0, NULL);
f2=CreateFile(TEXT("\\\\.\\PIPE\\fifo2"), GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, 0, NULL);

while(n<=9){
    for(int i=0;i<=2;i++){
        printf("[%s]",&l1[i]);
    }
    printf("\n");
    for(int i=0;i<=2;i++){
        printf("[%s]",&l2[i]);
    }
    printf("\n");
    for(int i=0;i<=2;i++){
        printf("[%s]",&l3[i]);
    }
    printf("\n");
    x=0;
    Sleep(3000);
    if (ReadFile(f2, lineChar, sizeof(lineChar), &x, NULL)==0) {
                printf("reading error..%d\n", x);
            }
    printf("%s",lineChar);
    //lineInt=atoi(lineChar);
    //printf("\n%d\n",lineInt);
    n++;
}
CloseHandle(f1);
CloseHandle(f2);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T06:43:37.603

您的代码中的字符串和指针有很多问题或问题。

首先将数组中的单个字符打印为*strings*，这将导致奇怪的输出。

其次，*也是*问题的原因之一，当您调用`WriteFile`时使用`sizeof(lineChar)`它返回*指针*的大小，而不是字符串的长度。改为使用`strlen`。

问题的第二个原因是您将整数转换为字符串。*这行不通！*什么说法

```
lineChar=reinterpret_cast<char*>(lineInt); 
```

所做的是它从`lineInt`. *这不是一个有效的指针！*有几种方法可以做到：

1.  使用 new[`std::to_string`](http://en.cppreference.com/w/cpp/string/basic_string/to_string)将值转换为`std::string`.
2.  因为无论如何你混合了 C 和 C++，你也可以使用[`sprintf`](http://en.cppreference.com/w/c/io/fprintf)。

你的程序有很多所谓的*未定义行为*，你应该很高兴它们都没有彻底崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T11:14:39.580

```
#include<stdio.h>
#include<string.h>

int main(){
char l1[3]="\0";
char l2[3]="\0";
char l3[3]="\0";
char x='x';
char o='0';
int n=1,lineInt=0,coor=0,next=1;
printf("X & 0 Game :  \n");
while(n<=3){
    for(int i=0;i<=2;i++){
        printf("[%s]",&l1[i]);
    }
    printf("\n");
    for(int i=0;i<=2;i++){
        printf("[%s]",&l2[i]);
    }
    printf("\n");
    for(int i=0;i<=2;i++){
        printf("[%s]",&l3[i]);
    }
    printf("\n");
    switch (next){
        case 1 :{
            printf("To select the line enter 1,2 or 3 : \n");
            scanf_s("%d",&lineInt);
            switch (lineInt){
                case 1 :{
                    printf("Enter the coordinates : \n");
                    scanf_s("%d",&coor);
                    //printf("%c",x);
                    //printf("%d",coor);
                    //strcpy_s(&l1[coor],1,"x");
                    l1[coor]=x;
                    break;
                }
                case 2 :{
                    printf("Enter the coordinates : \n");
                    scanf_s("%d",&coor);
                    l2[coor]=x;
                    break;
                }
                case 3 :{
                    printf("Enter the coordinates : \n");
                    scanf_s("%d",&coor);
                    l2[coor]=x;
                    break;
                }
        next=2;
        }
        for(int i=0;i<=2;i++){
            printf("[%s]",&l1[i]);
        }
        printf("\n");
        for(int i=0;i<=2;i++){
            printf("[%s]",&l2[i]);
        }
        printf("\n");
        for(int i=0;i<=2;i++){
            printf("[%s]",&l3[i]);
        }
        printf("\n");
        case 2 :{
            printf("To select the line enter 1,2 or 3 : \n");
            scanf_s("%d",&lineInt);
            switch (lineInt){
                case 1 :{
                    printf("Enter the coordinates : \n");
                    scanf_s("%d",&coor);
                    l1[coor]=o;
                    break;
                }
                case 2 :{
                    printf("Enter the coordinates : \n");
                    scanf_s("%d",&coor);
                    l2[coor]=o;
                    break;
                }
                case 3 :{
                    printf("Enter the coordinates : \n");
                    scanf_s("%d",&coor);
                    l2[coor]=o;
                    break;
                }
        next=2;
        }
    }
}
n++;
}
} 
```

}

# javascript - 数据是否自动推送到网站？(Python/Flask + WSIG + jquery AJAX)

> ID：13261028
> 
> 赞同：1
> 
> 时间：2012-11-06T23:23:50.873
> 
> 标签：javascript, jquery, python, ajax, flask

当服务器端完成某些操作并且 python 准备好发送它时，我是否可以将一个值自动推送到网站上（使用 AJAX = JQuery？），而不仅仅是响应网站的请求。

如何让 Jquery 准备好接受这些临时数据？

我正在学习的教程：http: [//flask.pocoo.org/docs/patterns/jquery/#the-html](http://flask.pocoo.org/docs/patterns/jquery/#the-html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T00:56:12.903

Walk 的答案是正确的，但现在还有另一种选择。Web Sockets 可以将数据从服务器推送到浏览器。对于某些语言（尤其是 Node.js），有用于处理 Web 套接字的复杂库，这些库通常处理旧浏览器的回退。

根据您的需要，Python 有许多库。这两个是一些最受欢迎的：

*   [https://github.com/abourget/gevent-socketio](https://github.com/abourget/gevent-socketio)
*   [https://github.com/stephenmcd/django-socketio](https://github.com/stephenmcd/django-socketio)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T23:27:25.313

您可以让 jquery 发出 AJAX 请求并等待一段时间，同时服务器处理响应并返回它，您可能会冒事务超时的风险。如果响应很快返回，这是最佳选择。

另一种方法是使用定时脚本来轮询服务器以获取更新。服务器会将特定会话的更新放在例如数据库或内存中，然后返回结果。如果这是一个长时间运行的过程，这是最佳选择。

# ios - touchUpInside 和 toutchUpOutside 都不会在手掌按下/抬起多个按钮时调用

> ID：13261032
> 
> 赞同：0
> 
> 时间：2012-11-06T23:24:00.230
> 
> 标签：ios, uibutton

我正在实现一个 IOS APP，其视图提供了一个用于控制远程设备的键盘，如果您使用手掌同时按下 6 个或 8 个（UI）按钮，则该应用程序会获得 touchDown 但不会收到 touchUpInside或当您抬起手掌时 touchUpOutside。

问题是我在 touchDown 时启动了一个计时器来重复键，但我从来没有收到结束键重复的回调。有谁知道如何处理这个问题。

我意识到这是一个肛门场景，但如果重复没有按时停止，那么昂贵的设备可能会被损坏。

我不确定这对情况有什么影响，但我在 iPhone 5 上使用 ios 6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:35:32.990

同时触摸它们也是必需的吗？如果没有，请设置`exclusiveTouch`为`YES`所有按钮。如果是，请`UIControlEventTouchCancel`同时检查。

# sql - 数据丢失时插入表格

> ID：13261037
> 
> 赞同：1
> 
> 时间：2012-11-06T23:24:44.243
> 
> 标签：sql, oracle, plsql, oracle11g

我有下表，为了便于阅读，我对每个案例编号的每个经理进行了分解。

最后一列是倒数第二列的累积和。

理想情况下，月值应该在 1-3 之间（就像您在芝加哥的两种情况下看到的那样）。

但从表中您可以看到在某些情况下缺少某些条目（由 <----- 标记）。

```
CITY     CASE   CASE_NUMBER   MANAGER  MONTH  MONTHLY_TOTAL   FISCAL_TOTAL 
---------------------------------------------------------------------------
chicago  case_1   1             John       1         2              2     
chicago  case_1   1             John       2         3              5  
chicago  case_1   1             John       3         5              10

chicago  case_1   1             Jeff       1         4              4     
chicago  case_1   1             Jeff       2         2              6  
chicago  case_1   1             Jeff       3         3              9

chicago  case_2   2             John       1         3              3     
chicago  case_2   2             John       2         2              5  
chicago  case_2   2             John       3         4              9

chicago  case_2   2             Jeff       1         2              2     
chicago  case_2   2             Jeff       2         7              9 <----

newyork  case_1   1             Lee        1         3              3     
newyork  case_1   1             Lee        2         4              7 <----

newyork  case_1   1             Sue        1         2              2     
newyork  case_1   1             Sue        2         3              5     
newyork  case_1   1             Sue        3         2              7 

newyork  case_1   2             Lee        1         2              2     
newyork  case_1   2             Lee        2         4              6  
newyork  case_1   2             Lee        3         4              10  

newyork  case_1   2             Sue        1         3              3     
newyork  case_1   2             Sue        2         2              5 <---- 
```

我想要的是首先找出那些缺失的行并插入值。

对于那些丢失的月总计 = 0

财务总计 = 上一行中的值。

例如，对于第一个缺失的行，它应该是：

```
CITY     CASE   CASE_NUMBER   MANAGER  MONTH  MONTHLY_TOTAL   FISCAL_TOTAL 
---------------------------------------------------------------------------
chicago  case_2   2             Jeff       3         0              9 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T15:47:57.733

假设每个案例的每个经理都应该有三个条目，您可以尝试以下操作：

```
SELECT City, Case, Manager, COUNT(Manager) AS CASE_COUNT
FROM table(put actual table name)
GROUP BY City, Case, Manager 
```

CASE_COUNT 列将向您显示经理处理的每个案例在表中的条目，如果该数字小于 3，则您知道缺少一个条目（当然这假设应该有 3 个条目对于他们每个人）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T03:30:51.883

也许这可以提供一些想法。我在 Postgresql 上运行它，但 Oracle 只需要稍作改动。然后清理一些。这个想法是这样的：

*   生成月份列表
*   用一组键交叉乘积月份
*   然后将结果连接回原始表中的值
*   对运行总计使用分析函数

设置：

```
create table theTable(city varchar(64), theCase varchar(64), case_number int, manager varchar(64), month int, monthly_total int, fiscal_total int);

insert into theTable values('chicago', 'case_1', 1, 'John', 1, 2, 2);
insert into theTable values('chicago', 'case_1', 1, 'John', 2, 3, 5);
insert into theTable values('chicago', 'case_1', 1, 'John', 3, 5, 10);

insert into theTable values('chicago', 'case_1', 1, 'Jeff', 1, 4, 4);
insert into theTable values('chicago', 'case_1', 1, 'Jeff', 2, 2, 6);
insert into theTable values('chicago', 'case_1', 1, 'Jeff', 3, 3, 9);

insert into theTable values('chicago', 'case_2', 2, 'John', 1, 3, 3);
insert into theTable values('chicago', 'case_2', 2, 'John', 2, 2, 5);
insert into theTable values('chicago', 'case_2', 2, 'John', 3, 4, 9);

insert into theTable values('chicago', 'case_2', 2, 'Jeff', 1, 2, 2);
insert into theTable values('chicago', 'case_2', 2, 'Jeff', 2, 7, 9);

insert into theTable values('newyork', 'case_1', 1, 'Lee', 1, 3, 3);
insert into theTable values('newyork', 'case_1', 1, 'Lee', 2, 4, 7);

insert into theTable values('newyork', 'case_1', 1, 'Sue', 1, 2, 2);
insert into theTable values('newyork', 'case_1', 1, 'Sue', 2, 3, 5);
insert into theTable values('newyork', 'case_1', 1, 'Sue', 3, 2, 7);

insert into theTable values('newyork', 'case_1', 2, 'Lee', 1, 2, 2);
insert into theTable values('newyork', 'case_1', 2, 'Lee', 2, 4, 6);
insert into theTable values('newyork', 'case_1', 2, 'Lee', 3, 4, 10);

insert into theTable values('newyork', 'case_1', 2, 'Sue', 1, 3, 3);
insert into theTable values('newyork', 'case_1', 2, 'Sue', 2, 2, 5); 
```

询问：

```
 -- the 3 months
with three as (select 1 AS month  union select 2 union select 3)
            -- select rownum from all_tables where rownum < 4  -- Oracle world

    -- the key
    ,city as (select distinct city, theCase, case_number, manager from theTable)

select x.city, x.theCase, x.case_number, x.manager, x.month, COALESCE(y.monthly_total,0)
      ,SUM(COALESCE(y.monthly_total,0)) OVER (PARTITION BY x.city, x.theCase, x.case_number, x.manager
                                              ORDER BY x.month) AS fiscal_total2
      ,y.fiscal_total

         -- cross product the key to form record for each month
  from ( select c.city, c.theCase, c.case_number, c.manager, t.month
           from city c
               ,three t
       ) x

  -- join "desired" set back to "have" set

  left outer join theTable y ON (    x.city = y.city
                                 and x.theCase = y.theCase
                                 and x.case_number = y.case_number
                                 and x.manager = y.manager
                                 and x.month = COALESCE(y.month, x.month)
                                )

  order by x.city, x.theCase, x.case_number, x.manager, x.month; 
```

结果：

```
 city   | thecase | case_number | manager | month | coalesce | fiscal_total2 |fiscal_total
---------+---------+-------------+---------+-------+----------+---------------+--------------
 chicago | case_1  |           1 | Jeff    |     1 |        4 |             4 |           4
 chicago | case_1  |           1 | Jeff    |     2 |        2 |             6 |           6
 chicago | case_1  |           1 | Jeff    |     3 |        3 |             9 |           9
 chicago | case_1  |           1 | John    |     1 |        2 |             2 |           2
 chicago | case_1  |           1 | John    |     2 |        3 |             5 |           5
 chicago | case_1  |           1 | John    |     3 |        5 |            10 |          10
 chicago | case_2  |           2 | Jeff    |     1 |        2 |             2 |           2
 chicago | case_2  |           2 | Jeff    |     2 |        7 |             9 |           9
 chicago | case_2  |           2 | Jeff    |     3 |        0 |             9 |
 chicago | case_2  |           2 | John    |     1 |        3 |             3 |           3
 chicago | case_2  |           2 | John    |     2 |        2 |             5 |           5
 chicago | case_2  |           2 | John    |     3 |        4 |             9 |           9
 newyork | case_1  |           1 | Lee     |     1 |        3 |             3 |           3
 newyork | case_1  |           1 | Lee     |     2 |        4 |             7 |           7
 newyork | case_1  |           1 | Lee     |     3 |        0 |             7 |
 newyork | case_1  |           1 | Sue     |     1 |        2 |             2 |           2
 newyork | case_1  |           1 | Sue     |     2 |        3 |             5 |           5
 newyork | case_1  |           1 | Sue     |     3 |        2 |             7 |           7
 newyork | case_1  |           2 | Lee     |     1 |        2 |             2 |           2
 newyork | case_1  |           2 | Lee     |     2 |        4 |             6 |           6
 newyork | case_1  |           2 | Lee     |     3 |        4 |            10 |          10
 newyork | case_1  |           2 | Sue     |     1 |        3 |             3 |           3
 newyork | case_1  |           2 | Sue     |     2 |        2 |             5 |           5
 newyork | case_1  |           2 | Sue     |     3 |        0 |             5 |
(24 rows) 
```

# javascript - Jqplot 仅显示几个 x 轴刻度

> ID：13261043
> 
> 赞同：1
> 
> 时间：2012-11-06T23:25:21.787
> 
> 标签：javascript, graph, jqplot, bar-chart

我必须创建一个显示 30 天图表的条形图。所以我将在图表上显示总共 30 个柱。但它在 x 轴上看起来非常拥挤。有没有一种方法可以只显示 6 个 x 轴刻度而不是所有 30 个 x 轴刻度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-06T11:11:05.010

我知道这是一个老问题，但我也需要一些解决方案，所以这里是：
当你`jqplot`用来打印条时，你不能说它应该打印多少刻度，因为它只打印相关值，所以你必须打印所有刻度. 我的解决方案不是很好，但它有效。只需打印带有空标签的刻度。例如：

```
axes: {
      xaxis: {
             min:1,
             max: 30,
             ticks: [[1,""],[2,""],[3,""],[4,""],[5,"5"],
                    [6,""],[7,""],[8,""],[9,""],[10,"10"],
                    [11,""],[12,""],[13,""],[14,""],[15,"15"],
                    [16,""],[17,""],[18,""],[19,""],[20,"20"],
                    [21,""],[22,""],[23,""],[24,""],[25,"25"],
                    [26,""],[27,""],[28,""],[29,""],[30,"30"]]
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T07:03:45.337

通过使用`ticks`轴选项，您可以准确指定要显示的刻度。

链接到文档：[http ://www.jqplot.com/docs/files/jqplot-core-js.html#Axis.ticks](http://www.jqplot.com/docs/files/jqplot-core-js.html#Axis.ticks)

# python - Numpy：乘以两个排列

> ID：13261044
> 
> 赞同：4
> 
> 时间：2012-11-06T23:25:27.910
> 
> 标签：python, numpy, permutation

我有两个排列表示为 Numpy 数组：

A：

```
 0  1  2  3
A = [1, 3, 2, 0] 
```

和乙：

```
 0  1  2  3
B = [0, 2, 1, 3] 
```

我怎样才能得到C = A * B，其中

```
0->1 * 1->2 = 2
1->3 * 3->3 = 3
2->2 * 2->1 = 1
3->0 * 0->0 = 0

C = (2, 3, 1, 0) 
```

有效地使用 Numpy？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T23:28:34.267

很简单，`b[a]`会做的伎俩：

```
>>> import numpy as np
>>> a = np.array([1, 3, 2, 0])
>>> b = np.array([0, 2, 1, 3])
>>> c = b[a]
>>> print c
[2 3 1 0] 
```

# c# - 在循环内执行 Web 请求仅在第一遍有效

> ID：13261046
> 
> 赞同：2
> 
> 时间：2012-11-06T23:25:46.850
> 
> 标签：c#, .net, httpwebrequest

我正在接收一条字符串消息并将其分解为多个块，以便我可以将其发送到短信服务（因此不会为您分解它）。在我完成我的工作以分解这些消息之后，我尝试遍历生成的数组并执行一个 Web 请求。问题是它只适用于第一条消息，然后挂起。不久之后，我收到一条错误消息，提示“连接已意外关闭”。这发生在它第二次尝试 GetResponse(); 我在这里看到了其他一些帖子，它们只是说要关闭并处理响应和请求流。这根本不适合我。这是我的代码当前所在的位置：

```
private static void Main(string[] args)
{
    var oldMessage = GetFileString();
    Console.WriteLine(string.Format("Old message: {0}", oldMessage.Length));

    var newMessage = UrlPathEncodeString(oldMessage);
    Console.WriteLine(string.Format("New message: {0}", newMessage.Length));

    var brokenUp = SplitByLength(newMessage, 145).ToArray();
    for(var i = 0; i < brokenUp.Count(); i++)
    {
        brokenUp[i] = brokenUp[i].Insert(0, UrlPathEncodeString(string.Format("({0:D2} of {1:D2})", i + 1, brokenUp.Count())));
        Console.WriteLine(string.Format("Appended length: {0}", brokenUp[i].Length));
    }

    System.Net.ServicePointManager.DefaultConnectionLimit = 100;
    foreach (var block in brokenUp)
    {
        Thread.Sleep(1500);
        SendSms((HttpWebRequest)WebRequest.Create("http://172.20.5.214:90/method/sendsms"), block);
    }
    Console.ReadKey();
}

public static void SendSms(HttpWebRequest request, string message)
{
    //build the request
    var url = "http://ipaddress/method/sendsms";
    //var request = (HttpWebRequest)WebRequest.Create(url);
    request.Method = "POST";
    request.ContentType = "application/x-www-form-urlencoded";

    var fields = "CellNumber={0}&Message={1}";
    fields = string.Format(fields, "16021234567", message);

    var fieldsBytes = Encoding.UTF8.GetBytes(fields);
    request.ContentLength = fieldsBytes.Length;
    var length = fieldsBytes.Length;

    using (var requestStream = request.GetRequestStream())
    {
        requestStream.Write(fieldsBytes, 0, length);

        using (var response = request.GetResponse())
        {
            using (var responseStream = response.GetResponseStream())
            {
                responseStream.Close();
            }
        }
        requestStream.Close();
    }
}

public static byte[] ReadFully(Stream stream)
{
    var buffer = new byte[32768];
    using (var ms = new MemoryStream())
    {
        while (true)
        {
            int read = stream.Read(buffer, 0, buffer.Length);
            if (read <= 0)
                return ms.ToArray();
            ms.Write(buffer, 0, read);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T01:31:45.527

`response.Close`如果您未能下载响应的全部内容，我遇到过似乎挂起的情况。为什么会这样，我不知道，但是在调用`request.Abort`之前拨打电话`Close()`可以解决问题。不过，我不希望您会看到这个问题，除非响应的大小可能有数兆字节。

此外，未能在调用之前关闭请求流`GetResponse`可能会阻止发送所有数据。我建议`requestStream.Close`在提出请求之前先打电话。但是同样，您的代码第一次可以工作但在随后的请求中不能工作，这似乎很奇怪。

考虑到我建议的更改，您修改的代码将是：

```
using (var requestStream = request.GetRequestStream())
{
    requestStream.Write(fieldsBytes, 0, length);
}

using (var response = request.GetResponse())
{
    using (var responseStream = response.GetResponseStream())
    {
        // read the response here.
        request.Abort();
        responseStream.Close();
    }
} 
```

# vba - 堆叠时间序列

> ID：13261048
> 
> 赞同：0
> 
> 时间：2012-11-06T23:25:52.993
> 
> 标签：vba

```
1/2012 36.5
2/2012 37.1
3/2012 37.5
4/2012 37.9
5/2012 38.0 
6/2012 38.1
7/2012 38.3 
```

我有一个时间序列（日期作为第一列，值作为第二列）。我试图从顶部选择系列的前 5 个值，将其复制并粘贴到 excel 文件中的第二个工作表中，然后返回到第一个工作表，获取该系列的下五个值，转到下一个工作表并将 5 个值作为下一列。所以我试图在下一张纸上并排堆叠 5 个系列。我怎么做？

到目前为止，我一直在同一页面上尝试这个过程，这就是我到目前为止的位置。

```
Range(ActiveCell, ActiveCell.Offset(5, 0)).Copy
ActiveCell.Offset(0, 5).PasteSpecial
ActiveCell.End(xlDown).Select
ActiveCell.Offset(1, 0).Select
ActiveCell.End(xlToLeft).Select
Range(ActiveCell, ActiveCell.Offset(5, 0)).Copy
ActiveCell.Offset(0, 5).PasteSpecial 
```

任何帮助，将不胜感激。我再次尝试将系列并排堆叠，长度为 5。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:18:47.940

```
Sub TT()

Const BLOCK_SIZE As Long = 5
Dim rng As Range, rngDest As Range

    Set rng = ActiveCell.Resize(BLOCK_SIZE, 1)
    Set rngDest = ActiveSheet.Parent.Sheets(2).Range("A1")

    Do While Application.WorksheetFunction.CountA(rng) > 0
        rngDest.Resize(BLOCK_SIZE, 1).Value = rng.Value
        Set rng = rng.Offset(BLOCK_SIZE, 0)
        Set rngDest = rngDest.Offset(0, 1)
    Loop

End Sub 
```

# git - 带有兄弟姐妹的git子模块功能？

> ID：13261054
> 
> 赞同：5
> 
> 时间：2012-11-06T23:27:14.190
> 
> 标签：git, git-submodules

我有一个由库和各种应用程序组成的项目：

```
foo/
foolib/
bar/
baz/
qux/foo/ 
```

所有应用程序都链接到一个静态库*傻瓜。*

我希望*git commit* on *foo记录**傻瓜*所在位置的 SHA1 ID，还希望*git status* on *foo*报告是否有未提交的*更改*。

但是，我不想将*傻瓜*移动到拥有它的副本作为每个应用程序的子目录。除了臃肿之外，这将失去在多个应用程序中尝试对*傻瓜*进行一些更改而不提交更改的能力。

我尝试制作一个指向 ../foolib 的 .gitmodules 文件，但它似乎被*git status*完全忽略了。我还尝试在 foo 中制作一个软链接*，**但 git*似乎*将*软链接视为文件而不是跟随链接。

 *我想要的是可能的，还是您有任何替代的工作流程解决方案？

在我的公共存储库中，结构是相同的，并且每个应用程序（和傻瓜）都是从公众单独克隆的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T07:42:06.423

这个想法是创建*另一个*repo `fooProject`，它将**声明为 submodules**：

*   `foo`
*   `foolib`

（如果您调用您的父项目`appProjects`而不是`fooProject`，您可以将所有子目录声明为子模块：`foo`, `foolib`, `bar`, `baz`, ...）

如果任何子目录 (`foo`或`foolib`) 更改并进行新的提交，您将返回父 repo 并提交，以记录不同子模块的 SHA1。*

# textbox - TinyMCE 仅段落文本，但带有一些按钮，如粗体、斜体

> ID：13261063
> 
> 赞同：1
> 
> 时间：2012-11-06T23:28:40.487
> 
> 标签：textbox, tinymce

对于我的网站，我需要从 TinyMCE 传递的输入为 1 种特定字体。我需要它们能够插入链接、使文本变为粗体、下划线或斜体。他们有 2 个标题可供选择，标题 2 和标题 3 以及段落。

现在的问题是，我不能让编辑器粘贴为文本。如果我打开 word，我可以复制和粘贴带有字体的文本，比如说 Chiller，它显示为 chiller。

如何使所有复制/粘贴的文本显示为我想要的字体（段落格式），同时允许一些按钮工作，例如粗体..等。

**我目前拥有的：**

```
<script type="text/javascript">                             
                            tinyMCE.init({
                            mode : "textareas",
                            theme : "advanced",
                            editor_selector : "body_content",
                            theme_advanced_toolbar_location : "top",
                            theme_advanced_toolbar_align: "left",
                            theme_advanced_buttons1: "bold,italic,underline,hr,strikethrough,formatselect,separator,undo,redo",
                            theme_advanced_buttons2: "justifyleft,justifycenter,justifyright,justifyfull,separator,bullist,numlist,separator,link,unlink",
                            theme_advanced_buttons3: "",
                            theme_advanced_blockformats: "p,h2,h3",
                            extended_valid_elements: "iframe[title|width|height|src]",
                            theme_advanced_fonts : "Arial=arial",
                            plugins : "wordcount",

                                    setup : function(ed){ 
                                        ed.onKeyUp.add(function(ed){
                                            ///
                                            var r = 0;
                                            var y = tinyMCE.get('body_content').getContent();
                                            var n = "<?php echo $max;?>";                                               
                                            y = y.replace(/\s/g,' ');
                                            y = y.split(' ');
                                            for (i=0; i<y.length; i++) 
                                            {
                                                if (y[i].length > 0) r++;
                                            }
                                            var word_remain=n-r;
                                            if(word_remain<0)
                                                word_remain=0;
                                            jQuery('#body_word_remain').html(word_remain);
                                            var keypressed = null;

                                            if (window.event)
                                            {
                                                keypressed = window.event.keyCode; 
                                            }
                                            else
                                            {
                                                keypressed = ed.which; //NON-IE, Standard
                                            }
                                            if (r > n )
                                            {   
                                                var prescribed = "<?php _e('You have exceeded the prescribed ','ad')?>";
                                                prescribed += (r-n);
                                                prescribed += "<?php _e(' word(s)','ad');?>";
                                                jQuery('#prescribed').html(prescribed);                                                 
                                            }
                                            else
                                            {
                                                jQuery('#prescribed').html('');
                                            }
                                        });
                                    }                                       
                            });

                            </script> 
```

**这里的示例按我想要的方式工作：http:** [//fiddle.tinymce.com/](http://fiddle.tinymce.com/)

但我不确定他们用什么来达到这种效果。我正在使用 2010 年 12 月 20 日发布的 3.9.3 版本，如果可能的话，我宁愿不更新它。但如果我确实需要更新它以获得我想要的效果，我会的。

谢谢！任何帮助表示赞赏。

# vim - Vim 自动完成：取消自动完成弹出窗口

> ID：13261068
> 
> 赞同：17
> 
> 时间：2012-11-06T23:29:25.600
> 
> 标签：vim, autocomplete

如果我在 vim 中按 ctrl+n，我将在弹出框中获得建议的自动完成选项列表。

这很好......但如果我决定我不想自动完成，我不太确定要按什么来恢复建议。

例如，假设我键入`rea`，按 ctrl+n，然后自动完成弹出`really_long_method_name_damn_this_is_annoying`...而我不希望这样。我不太清楚如何将语法恢复为`rea`……我必须手动删除不需要的字符。

我猜这是一件非常简单的事情，但仍然 - 如果有人知道如何，请告诉我。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-11-07T03:17:58.480

`Ctrl`+`E`将结束当前完成并放回最初键入的文本。

看

```
:h complete_CTRL-E
:h ins-completion 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T23:36:42.167

试着按`Ctrl+P`一下把你带回到原来的状态（或者如果你觉得雄心勃勃，`Ctrl+N`直到你循环回来:)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T23:36:59.353

按`Ctrl`+ `P`，然后按`Esc`。前者将删除自动完成的文本，后者将关闭弹出窗口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T23:38:53.133

输入`:help ins-completion-menu`所有选项的详细说明。

# regex - 正则表达式 - 匹配注释

> ID：13261069
> 
> 赞同：0
> 
> 时间：2012-11-06T23:29:29.063
> 
> 标签：regex, comments, pattern-matching

我需要匹配这种类型的评论：

```
{This is a comment} 
```

注释可以包含换行符。

我已经尝试并提出了这个正则表达式：

```
\{(.|[\r\n])*\} 
```

问题是这个正则表达式匹配两个评论之间的所有内容，例如：

```
{comment}

text

{comment} 
```

在上述情况下，文本也将被匹配。

我怎样才能解决这个问题 ？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T23:30:41.290

使用`?`使您的正则表达式模式不贪婪（懒惰）>>

```
\{[\s\S]*?\} 
```

注意：`[\s\S]`等于`(?:.|\n|\r)`or `(?:.|[\n\r])`or `[.\n\r]`... 匹配**任何东西**

# java - GWT/Gradle 项目示例。

> ID：13261070
> 
> 赞同：4
> 
> 时间：2012-11-06T23:29:28.820
> 
> 标签：java, gwt, gradle

我需要有关如何构建多层 GWT/Spring 项目的建议，以便 Gradle 可以构建工件并部署正确的 jar。

谷歌没有多大帮助——我可以找到一些关于构建多项目的文章，并且确实在 Gradle 中构建 GWT 项目，但是，对于我的问题域，所有这些似乎都不完整，因为我遇到了以下问题以下问题。

1.  在多项目示例中，GWT 依赖项被包含在来自 war 插件的 Web 应用程序中。

2.  如果我沿着单一的 gradle 构建路线走，那么我将失去与项目的脱钩..

3.  客户端和服务器都依赖于某些类文件（对于 GWT-RPC）；目前这些都打包在客户端项目中，因此再次导致服务器依赖于客户端（对于 GWT-RPC DTO 对象）。这让我觉得我需要一个专门用于共享类文件的第三个模块源代码也存在于 gwt-client 项目中（供 GWT 编译器获取）..

所以; 问题是有没有人遇到过使用 Gradle 作为构建工具并处理上述部分/全部问题的多层 GWT 示例？

在此先感谢，伊恩。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:51:26.033

我们使用的是单个构建，但我们使用[Classcycle](http://classycle.sourceforge.net/) maven 依赖插件解决了第 2 点 - “项目耦合”。

最终，您需要三种类型的代码：服务器、客户端和共享。将它们单独打包在单独的 jar 中（如您在第 3 点中所说）的优点是您的服务器 jar 大小将减小，并且您可以在`.gwt.xml`文件中使用更自由的源目录。

如果您决定使用单个 jar/war，那么您将在服务器上包含额外的、未使用的客户端类。这可能会导致代码泄漏导致运行时异常和（可能？）服务器性能下降。我们通过在构建时强制分层分离（使用 Classcycle）来避免运行时异常，并且来自额外客户端类的额外性能开销应该是微不足道的。您始终可以在编译后使用构建后任务从 jar 中删除客户端代码。

抱歉，我对 gradle 了解不多，但我想无论如何我都会尽力提供帮助。

# sql - select中子查询语句的where子句

> ID：13261071
> 
> 赞同：13
> 
> 时间：2012-11-06T23:29:31.257
> 
> 标签：sql, sql-server-2008-r2

假设我有这样的查询：

```
 Select col1, 
          col2, 
          (select count(smthng) from table2) as 'records'
   from table1 
```

我想将它过滤为“记录”列不为空。

我不能做到这一点：

```
 Select col1, 
                col2, 
               (select count(smthng) from table2) as 'records'
          from table1
        where records is not null 
```

我想出的最好的方法是将此结果集写入表值参数并对该结果集进行单独的查询。有任何想法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-06T23:45:22.020

只需将其移至派生查询即可。您不能在 WHERE 子句中使用 SELECT 子句中定义的列。

```
Select col1, col2, records
from
(
    Select col1, 
           col2, 
           (select ..... from table2) as records
    from table1
) X
where records is not null; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T23:41:59.230

你应该在那里做一些小的修改：

首先，在子查询上添加 TOP 子句，强制查询只返回该表的一条记录2。像这样的子查询应该只返回一个标量值。

其次，子查询在其列列表中只能有一列，因此返回值应该是一个标量。

最后，您无法在选择子句中过滤子查询或任何已生成的列。所以我的建议是使用`"join"`s 或`"exists"`.

```
Select col1, 
       col2
       from table1
       left outer join
            table2
       on table1.key = table2.key
       where not table2.key is null 
```

或这个：

```
Select col1, 
       col2
       from table1
       inner join
            table2
       on table1.key = table2.key 
```

或者这个：

```
Select col1, 
       col2
       from table1
       where exists (
            select *
                  from table2
                  where table2.key = table1.key
                  and   not table2.somethingelse is null
                  -- or any other relevant conditions
       ) 
```

干杯

# javascript - 让元素在 IE 中可见？

> ID：13261073
> 
> 赞同：0
> 
> 时间：2012-11-06T23:29:37.580
> 
> 标签：javascript, css, internet-explorer, getelementbyid

正如标题所说..有没有办法让它与 IE 一起工作？

我正在使用：

```
document.getElementById('loadingImage').style.visibility='visible'; 
```

为了

```
<img id="loadingImage" src="images/25.gif" style="padding:0px;margin-bottom:-7px;visibility:hidden;"> 
```

但它不起作用。谢谢。

***编辑：*** *正在调用列表此* [警报然后重新加载页面检测文件扩展名上传脚本](https://stackoverflow.com/questions/13260629/alert-then-reload-page-in-detect-file-extension-upload-script)：

```
function TestFileType( fileName, fileTypes ) {
if (!fileName) return;

dots = fileName.split(".")
//get the part AFTER the LAST period.
fileType = "." + dots[dots.length-1];

if (fileTypes.join(".").indexOf(fileType) != -1) {
   document.getElementById('loadingImage').style.visibility='visible';
   return true;
} else {
   alert('Please select (.w3g) file only!');
   return false;
}
} 
```

和

```
<input name="replay_file" id="replay_file" type="file" accept=".w3g*"/>
<input type="submit" id="upload_file" value="Upload" name="uploadReplay" onClick="return TestFileType(this.form.replay_file.value, ['w3g','.w3g']);" />
<img id="loadingImage" src="images/25.gif" style="padding:0px;margin-bottom:-7px;visibility:hidden;"> 
```

*PS：这不是一个重复的问题，因为其他问题没有那么相关。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T10:40:17.707

这两个变化怎么样：

将~~this.form.replay_file.value~~替换为：

```
document.getElementById('replay_file').value 
```

并在此行末尾添加缺少的分号：

```
dots = fileName.split("."); 
```

* * *

顺便说一句，您将函数的第二个参数作为一个数组并将其连接到一个字符串。为什么不将它作为字符串传递呢？

此外，在 2 个数组成员中，'w3g' 永远不会匹配（只有 '.w3g' 可能匹配），因为您总是查找以点开头的字符串......

以及一个建议：与返回类型保持一致。如果此函数预期返回布尔值，则第一行应更改为：

```
if (!fileName) return false; 
```

# c# - C# Outlook 2010 插件 - AppointmentItem.ItemProperties.Add 异常

> ID：13261075
> 
> 赞同：3
> 
> 时间：2012-11-06T23:29:45.277
> 
> 标签：c#, vsto, outlook-addin, outlook-2010

我正在开发一个将表单区域添加到 IPM.Appointment 消息类的 Outlook 加载项。当这个区域显示出来时，它首先会向 AppointmentItem 添加一些属性。

```
Outlook.AppointmentItem appItem;

private void FormRegion_FormRegionShowing(object sender, System.EventArgs e)
{
    try
    {
        appItem = (Outlook.AppointmentItem)this.OutlookItem;

        appItem.ItemProperties.Add("CustomProperty", Outlook.OlUserPropertyType.olText);
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.ToString());
    }
} 
```

这在我的日历上运行良好，但如果我尝试将插件与我拥有编辑器或所有者访问权限的委托日历一起使用，则会引发以下异常：

```
System.UnauthorizedAccessException: You don't have appropriate permission to perform this operation.
  at Microsoft.Office.Interop.Outlook.Itemproperties.Add(String Name, OlUserPropertType Type, ObjectAddToFolderFields, Object DisplayFormat)
  at ThisAddin.FormRegion.FormRegion_FormRegionShowing(Ovject sender,EventArgs e) 
```

任何和所有的帮助表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-10-21T13:34:35.270

我通过 UserProperties 遇到了同样的问题。对我来说，只有在我第一次尝试添加该属性时才会出现异常。因此，为了解决这个问题，我捕获了异常并重试。

```
Outlook.UserProperties properties = appointmentItem.UserProperties;
Outlook.UserProperty property = null;
try
{
    property = properties.Add(propertyName, Outlook.OlUserPropertyType.olText);
}
catch (System.UnauthorizedAccessException exception)
{
    // the first time didn't work, try again once before giving up
    property = properties.Add(propertyName, Outlook.OlUserPropertyType.olText);
} 
```

# list - Prolog-匹配列表的部分

> ID：13261079
> 
> 赞同：0
> 
> 时间：2012-11-06T23:30:26.067
> 
> 标签：list, prolog, dcg, unification

> **可能重复：**
> [Prolog- 将英语翻译成 C](https://stackoverflow.com/questions/13257058/prolog-translating-english-to-c)

我们基本上有一个作业，我们得到一个表示英语符号的列表，例如 [add,3,to,5]，我们需要接受它并让它在 C 中输出相应的符号。

```
english2C([add,3,to,5], C).
C = 3+5 
```

我们的数量是有限的。我们也可以将两个这样的列表组合成一个更长的列表

```
english2C([add,3,to,5,',',then,subtract,7], C).
C = 3+5-7 
```

但是这些较长的列表总是由较短的列表组成，其中有一定数量的。这就是我卡住的地方。我希望能够使用模式匹配，但我不完全确定 prolog 中的语法如何

```
english2C([first,second,third,fourth|rest], C)
*pseudo code*
match first with an operator
C = second (matched operator) third 
```

所以会有一种情况用于加法，一种用于减法，一种用于乘法等。基本上我想在列表中搜索短语“将 I 加到 J”并将该短语与 (I + J) 统一。或者在列表中搜索“除以 J 后取 I 的余数”并将其与 (I '%' J) 统一。但是所有的短语都是不同的长度，即使我知道我想做什么以及如何去做，我似乎无法在序言中得到它。

有点更新，但我忘了提及我现在拥有的文件中所有基本规则的列表，就像这样

```
rule([add,I,to,J], X) :- X = I+J
rule([subtract,I,from,J], X) :- X = J-I 
```

等等等等。问题是组合列表。例如，我们拥有的列表可能是 [add,I,to,J,',',then,subtract,H]，它必须是 I+JH。定义了各个基本规则（I+J 和 XH），但我必须能够匹配更长列表中的每个部分。

# sql - 如何在多对多插入中生成映射表

> ID：13261087
> 
> 赞同：-1
> 
> 时间：2012-11-06T23:30:46.773
> 
> 标签：sql, database, sql-server-2008, database-design

我有一张交易所公司的交易表。因此，在某一天，我可以为一家公司进行许多交易。我现在想进行这些交易并将它们分组到头寸中。

根据国家、类型等属性，一个交易可以低于多个头寸，一个头寸可以由多个交易组成。

所以我有以下表格

**表交易**

```
Id   Date      Company   Trade  Type
1 2012-11-01     IBM     1000    A
2 2012-11-01     IBM     3000    B
3 2012-11-01     Dell    1000    A
4 2012-11-01     HP      5000    A
5 2012-11-01     HP      6000    A
6 2012-11-01     HP      7000    B 
```

**表 TradePositionMapping**

```
PK     TableTradeID      PositionID
1          1                100      --IBM 1000
2          1                101      --IBM 1000
3          2                101      --IBM 3000
4          3                102      --Dell 1000
5          4                103      --HP 5000
6          5                103      --HP 6000
7          4                104      --Hp 5000
7          5                104      --Hp 6000
7          6                104      --Hp 7000 
```

**表位置**

```
PK   Company Position
100   IBM      1000
101   IBM      4000
102   Dell     1000
103   Hp      11000
104   Hp      18000 
```

所以在上面的头寸中，IBM 贸易 ID 1 转到了 2 个位置 100 和 101。贸易 ID 2 也转到了位置 101，总共 4000

好的，这个想法是一笔交易可以组成一个或多个头寸，一个头寸可以有很多笔交易。业务逻辑将确定交易流向的位置，因此我现在使用 A 和 B 作为标志，仅作为示例。

所以问题是..

当我从交易表中选择和汇总时，我将由各种交易组成的所有新头寸插入到头寸表中。现在创建映射表的最佳方法是什么。

我目前所做的是将新创建的职位 ID 存储在临时表中，然后重复我首先要生成职位的选择......并加入临时表。这似乎有很多重复的代码，我想知道做这种事情的最佳实践是什么。

最好的问候米克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T09:38:57.597

您应该使用 TableTradeID、PositionID 创建一个简单的表 TradePositionMapping。

然后根据你的业务逻辑：
(0.) Begin Transaction
1\. 插入仓位
2\. 获取 PositionID
3\. 插入 TableTradeID,PositionID 对到 TradePositionMapping
(4.) Commit

应该就这么简单。

您可以在提交之前预先计算位置的总和以插入或更新它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T11:17:03.037

好的，经过更多研究，我采取的方法似乎是最好的方法。创建映射以将一个表中的源行连接到另一个表中的聚合行时，两种思想流派是

1 遍历源行并使用游标处理数据组。然后在 Destination 表中插入 1 条聚合记录，并在 Mapping 表中使用新 ID 构建 Mappings。然而，这对于游标来说可能很昂贵。

2 另一种方法和我采用的方法是从源表中提取和聚合数据，然后批量插入到目标表中，将新 ID 存储在临时表变量中。诀窍是确保您还复制您分组的标准，因为您需要将记录连接在一起以创建映射。

举个例子：

:Long 和 S 的短方向 :PK 是所有表中的标识列

：没有时间构建正确的代码，所以请原谅任何语法错误。

**表交易** ——这是我们的源表

```
 TradeId 日期 公司 贸易方向
    10 2012-11-01 IBM 1000 L
    20 2012-11-01 IBM 3000 L
    30 2012-11-01 IBM 5000 S
    40 2012-11-01 戴尔 1000 S
    50 2012-11-01 戴尔 2000 S
    60 2012-11-01 戴尔 3000 S
    70 2012-11-01 惠普 5000 升
    80 2012-11-01 惠普 6000 升
    90 2012-11-01 惠普 7000 S
    100 2012-11-02 ORA 1000 S
    110 2012-11-02 欧拉 1000 S
    120 2012-11-02 欧拉 1000 S

```

因此选择所有交易并根据公司和方向汇总它们

 `````
declare @feedDate DateTime = '2012-11-01'  -- feed date to run for
declare @newPositionIds Table (newPositionId bigint)  -- temp table to store new PositionId

-- Aggregate and insert the trades only for the feed date. ORA should not be processed
Insert into Position (Company, Direction, Position)
 Output inserted.PositionID         
  Into @newPositionIds (newPositionId)
select Company, Direction, sum(Trade)
  from Trade t where t.date = @feedDate 
    group by Company, Direction 
````  `这应该将这些记录添加到 Positions 表中

**表位置**

```
 PositionID 公司 职位 方向 
    100 IBM 4000 升
    200 IBM 5000 S
    300 戴尔 6000 S
    400 马力 11000 升
    500 马力 7000 秒

```

好的现在我们要使用用于聚合每个位置的记录来填写映射表

所以我们需要将交易加入职位，但我们需要使用我们用来分组的相同标准。这就是为什么我们需要将该标准插入到位置表中

所以这次我们选择所有交易但不求和并加入头寸表..然后将结果插入映射表。因此，这是通过在查询中构建 2 个派生表来完成的。1 个用于交易，另一个用于头寸，并根据最初用于对它们进行分组的标准将它们连接起来。我们从这两个查询中需要的只是 PK Id

 `````
-- Select Trades for the feed date. ORA should not be included
Insert into TradePositionMapping(t.TradeID, p.PositionID)
(  select TradeId, Company, Direction, Trade            -- select the Trades
      from Trade t where t.date = @feedDate ) t
inner join
               -- join to temp table as we are only interested in the new ids we inserted
(select PositionId, Company,Direction from Position pos  
    inner join @newPositionIds npIds on pos.PositionId = npIds.newPositionIds
) p
on t.Company = p.Company and t.Direction = p.Direction 
````  `这应该给我们以下映射表

**表 TradePositionMapping** - TPM

```
 TPM_PK TradeID PositionID
    1 10 100 --IBM 1000 升
    2 20 100 --IBM 3000 升
    3 30 200 --IBM 5000 S
    4 40 300 --戴尔 1000 S
    5 50 300 --戴尔 2000 S
    6 60 300 --戴尔 3000 S
    7 70 400 --Hp 5000 升
    7 80 400 --Hp 6000 升
    7 90 500 --Hp 7000 S

```

因此，我们也可以将提要日期作为标准加入到临时表中，而不是加入到临时表中，但临时表也可以正常工作，因为我不希望在我的位置表中使用日期文件

所以现在我可以使用映射表查看哪些交易构成了哪些头寸。

我希望这可以帮助任何人查看批量插入和生成映射表。

问候米````

# maven - 从 jenkins -> maven -> testng 传递一个 java 参数

> ID：13261094
> 
> 赞同：0
> 
> 时间：2012-11-06T23:31:49.240
> 
> 标签：maven, jenkins, parameter-passing, testng, maven-surefire-plugin

我们的自动化 QA 测试用例由 Jenkins 安排和执行。我必须在不同的环境中运行测试用例，比如**UAT**、**STAGE**和**PROD**（因为它们有不同的测试数据），并且这些测试用例被“分组”为**SANITY**、**REGRESSION**和**BATS**。我正在使用 maven + testNG（surefire 插件）来构建和执行它。

现在我需要将其作为 Jenkins 中的作业运行为“STAGE 中的 BATS”或说“DEV 中的回归”等。为此，我认为最好的方法是，在 Jenkins 作业中，调用类似 ..

```
mvn test -Denv=STAGE -Dgroup=SANITY 
```

其他选项是在 Jenkins 的系统变量中设置参数（环境和组）并从那里开始。

但我面临着一些主要障碍，正如这里的另一篇文章中提出的那样..

[如何从maven传递java代码一个参数进行测试](https://stackoverflow.com/questions/13245411/pass-a-java-parameter-from-maven-for-testng)

这看起来像一个常见的要求，以前有没有人解决过这个问题？我的方法是否正确，还有更好的方法吗？

请建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:21:42.730

您可以为每个测试场景/环境创建单独的 Maven 构建配置文件，然后根据 Jenkins 中设置的命令行参数或环境变量设置它们的激活。

编辑：

您基本上将拥有每个测试场景的配置文件，然后您将使用 surefire-plugin 的包含/排除配置来控制哪些测试被触发。理想情况下，您可以通过顶级测试类运行所有这些，因此您所称的每组“组”都将具有某种触发底层测试套件的 AllTests.java 类。

```
 <profile>
    <id>Stage</id>
    <activation>
      <activeByDefault>false</activeByDefault>
    </activation>
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.12.4</version>
            <configuration>
              <includes>
            <include>**/Sanity/AllTests.java</include>
              </includes>
            </configuration>
          </plugin>
        </plugins>
  </profile> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-28T17:33:45.563

假设您正在使用 Build 部分运行“mvn test”，这对我有用。我去了提到的同一个帖子OP，但发现了这种更简单的方法。

（Jenkins 为作业配置页面）

```
Build
Invoke Maven 3
  Maven Version [<latest version>]
  Root POM      [pom.xml]
  Goals and options [test -Denv=STAGE -Dgroup=SANITY] 
```

您还可以参数化构建并将参数用于以下选项。

```
Goals and options [test -Denv=$PARAM_ENV -Dgroup=$PARAM_GROUP] 
```

# tcl - 使用 Tcl expect 从命令获取输出

> ID：13261097
> 
> 赞同：3
> 
> 时间：2012-11-06T23:32:03.293
> 
> 标签：tcl, expect, gnu-screen

我花了一天的大部分时间到处寻找答案，但到目前为止没有任何效果。我要做的是运行一个将附加到 GNU 屏幕会话的期望脚本，向它发送命令行参数（一个命令），并输出该命令的结果。到目前为止，这是我的脚本之一：

```
 #!/usr/bin/expect -f

set timeout 3
#exp_internal 1

spawn screen -raAd call_sess
sleep 1

expect -re "\\\$" {
  send $argv
  send "\n"
  sleep 1
}

expect -re ".*" {
    set output $expect_out(0,string)
}

expect "\$" {
  send "\001"
  send "d"
}

expect eof {
  puts "OUTPUT---------------"
  puts $output
  puts "OUTPUT---------------"
} 
```

并且 $expect_out(0,string) 只匹配换行符，即使 .* 应该匹配自上次匹配以来的所有内容。如果有人可以帮助我完成这项工作，那将是很棒的，我准备放弃并称其为不可能。

编辑：在评论中回答，但我应该指定命令确实在屏幕上运行，我只是无法正确捕获输出。

EDIT2：按照建议将脚本更改为生成屏幕，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T19:17:28.010

答案的简单部分`.*`是匹配空字符串，因此进入`expect_out`.

困难的部分是屏幕会给你整个屏幕 - 包括任何以前的命令 - 所以仅仅找到你发送的命令的输出可能有点困难。

# google-apps-script - 我无法理解脚本/日历中的时区

> ID：13261099
> 
> 赞同：1
> 
> 时间：2012-11-06T23:32:24.870
> 
> 标签：google-apps-script

我在时区得到奇怪结果时遇到问题。

我正在一个全新的日历上测试一个小代码。我在 2012 年 11 月 7 日 22:00 到 23:00 进行了测试活动。

```
function myFunction() {
  Logger.clear();
  var calendar=CalendarApp.getCalendarById("foo@group.calendar.google.com");
  var now=new Date();
  Logger.log(calendar.getTimeZone());
  Logger.log(Session.getTimeZone());
  Logger.log(now.toISOString());
  Logger.log(now.toUTCString());
  Logger.log(calendar.getEventsForDay(now)[0].getStartTime());
} 
```

这就是我在 11 月 7 日 00:29 运行它的结果

```
Europe/Rome
Europe/Rome
2012-11-06T23:28:25.889Z
Tue, 06 Nov 2012 23:28:25 GMT
Wed Nov 07 13:00:00 PST 2012 
```

我读了一篇旧博客文章[http://googleappsscript.blogspot.it/2011/03/demystifying-time-zones-in-apps-script_21.html](http://googleappsscript.blogspot.it/2011/03/demystifying-time-zones-in-apps-script_21.html)但它对我没有帮助。

如何在日历的时区（或脚本的时区）中获取开始日期？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T03:57:33.683

将日期转换为字符串时，使用的时区是服务器的时区。要确保字符串表示在所需的时区（在本例中为脚本），您需要使用该`Utilities.formatDate()`方法，该方法[在此处](https://developers.google.com/apps-script/class_utilities#formatDate)记录。

# iphone - iPhone：UICollectionView 的 Indexpath.row

> ID：13261104
> 
> 赞同：0
> 
> 时间：2012-11-06T23:32:45.857
> 
> 标签：iphone, uicollectionview, nsindexpath

我尝试重新制作 iOS 的图片库。

在图像的详细信息屏幕中，我想将导航栏的标题更新为喜欢

```
3 of 19 
```

有没有办法获取可见对象的当前**indexpath.row并在****UICollectionView**停止滚动并更新“3 of 19”标题时更新图像标题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:32:45.857

此代码工作正常！

```
- (void)collectionView:(UICollectionView *)collectionView didEndDisplayingCell:(UICollectionViewCell *)cell forItemAtIndexPath:(NSIndexPath *)indexPath{
    BOPhotoCollectionViewCell* currentCell = ([[collectionView visibleCells]count] > 0) ? [[collectionView visibleCells] objectAtIndex:0] : nil;
    if(cell != nil){
        _index = [collectionView indexPathForCell:currentCell].row;
        [self updateTitle];
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-13T07:32:06.647

实现下面的 UIScrollViewDelegate 委托方法（因为 UICollectionViewDelegate 是从 UIScrollViewDelegate 继承的）。

```
- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView{
  NSInteger currentIndex = scrollView.contentOffset.x / scrollView.frame.size.width;
  [self setTitle:[NSString stringWithFormat:@"%ld of %ld",(long)currentIndex + 1, (long)self.itemList.count]]; 
} 
```

# python - Python - 作为文字的二进制转义序列字符串

> ID：13261109
> 
> 赞同：8
> 
> 时间：2012-11-06T23:33:02.657
> 
> 标签：python, string

我需要打印出一串二进制转义序列，例如`\x05\x03\x87`，完全按照它们出现的样子。当我尝试打印它们时，Python 返回一串奇怪的非 ASCII 字符。如何将它们打印为字符串文字？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-06T23:34:55.033

`repr`

```
>>> a='\x05\x03\x87'
>>> print a
?
>>> print repr(a)
'\x05\x03\x87' 
```

**编辑**

Sven 指出，OP 可能希望*每个*字符都以十六进制转储，甚至是可打印的字符，在这种情况下，我能想到的最佳解决方案是：

```
>>> print ''.join(map(lambda c:'\\x%02x'%c, map(ord, a)))
\x05\x03\x87 
```

**附加编辑**

四年后，我突然想到这可能更快，更易读：

```
>>> print ''.join(map(lambda c:'\\x%02x'% ord(c), a)) 
```

甚至

```
>>> print ''.join([ '\\x%02x'% ord(c) for c in a ]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-06T23:35:22.150

使用[字符串转义编码](http://docs.python.org/2/library/codecs.html#standard-encodings)：

```
>>> print '\x05\x03\x87'.encode('string-escape')
\x05\x03\x87 
```

来自文档：

> 在 Python 源代码中生成一个适合作为字符串文字的字符串

这基本上会给你同样的东西`repr()`，没有那些讨厌的引号。

请注意，就像 Malvolio 的回答一样，这假设您只想要不可打印字符的转义版本，如果这不是您想要的，请澄清。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-07T09:08:58.273

您可以派生您自己的子类，`str`其行为和打印方式符合您的要求，但几乎可以在任何常规字符串可能存在的地方使用，并且具有所有相同的内置方法。

如您所见，该示例打印了它包含的*所有*字符的十六进制值，无论它们是否可以正常打印——当然，如果您愿意，可以采用不同的方式来完成。

```
class HexStr(str):
    def __repr__(self):
        return "'" + ''.join('\\x{:02x}'.format(ord(ch)) for ch in self) + "'"
    __str__ = __repr__

a = HexStr('abc\x05\x03\x87')
print a
print str(a)
print repr(a) 
```

输出：

```
'\x61\x62\x63\x05\x03\x87'
'\x61\x62\x63\x05\x03\x87'
'\x61\x62\x63\x05\x03\x87' 
```

# javascript - 使用 Django 时让 JavaScript 下拉菜单在 Twitter Bootstrap 中工作的问题

> ID：13261111
> 
> 赞同：3
> 
> 时间：2012-11-06T23:33:16.467
> 
> 标签：javascript, django, drop-down-menu, twitter-bootstrap, django-templates

我编写了一个非常简单的 Django Web 应用程序，它将 url 指向视图，然后让视图呈现模板。我想在我的模板中使用 Twitter Bootstrap，以使我的应用程序的前端更可用。Twitter Bootstrap 的 CSS 似乎工作正常，但我在使用 JavaScript 时遇到了问题。我在我的模板目录中设置了一个名为 dropdown.html 的测试页面，它包含以下内容：

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Simple test of JavaScript dropdown menus in Twitter Bootstrap</title>

    <!-- Le styles -->
    <link href="{{ STATIC_URL }}bootstrap/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
    </style>

    <script src="{{ STATIC_URL }}bootstrap/js/bootstrap.js"></script>
  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="#">Dropdown test</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="#">Action</a></li>
                  <li><a href="#">Another action</a></li>
                </ul>
              </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

  </body>
</html> 
```

这是结果页面的屏幕截图：

![在此处输入图像描述](../Images/aff60499f45fd5f112aa34917d2e874a.png)

我知道 CSS 和 JavaScript 文件正在传送到浏览器，因为我可以看到 Django 的日志输出，它显示以下内容：

```
[06/Nov/2012 18:14:30] "GET /dropdown/ HTTP/1.1" 200 1465
[06/Nov/2012 18:14:30] "GET /static/bootstrap/js/bootstrap.js HTTP/1.1" 200 56478
[06/Nov/2012 18:14:30] "GET /static/bootstrap/css/bootstrap.css HTTP/1.1" 200 121663 
```

此外，当我在 Firefox 中加载页面并使用 Firebug 来“查看源代码”时，我可以看到包含的 JavaScript（bootstrap.js 的所有 2025 行），并且下拉代码正好在我期望的位置（第 571 行）。

不幸的是，当我单击下拉菜单时，没有任何反应。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T00:47:35.577

一旦我也包含了 JQuery，它就开始工作了。在我上面的`<head>`例子中应该如下：

```
<head>
    <meta charset="utf-8">
    <title>Simple test of JavaScript dropdown menus in Twitter Bootstrap</title>

    <!-- Le styles -->
    <link href="{{ STATIC_URL }}bootstrap/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
    </style>

    <script src="{{ STATIC_URL }}jquery/jquery-1.8.2.js"></script>
    <script src="{{ STATIC_URL }}bootstrap/js/bootstrap.js"></script>
  </head> 
```

# intellij-idea - 在 IntelliJ 中运行时编译

> ID：13261112
> 
> 赞同：6
> 
> 时间：2012-11-06T23:33:21.607
> 
> 标签：intellij-idea

当我在 IntelliJ 中运行测试时，它不会首先自动编译文件。这是正常行为吗？我知道我可以在保存时使用 eclipse 模式自动编译，但是在运行文件之前自动编译似乎是合乎逻辑的。这在 IntelliJ 中可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T10:34:02.287

配置屏幕下有一个“Before Launch”选项组，其中“Make”作为选项之一。如果选中此选项，整个模块/项目将在启动之前重建。

如果您希望此选项为 IntelliJ 自动创建的所有未来配置保留，请在“默认”组中的相关配置下标记它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-13T00:15:43.763

我已经制作了一个宏来保存和编译映射到`CMD+s`

还制作了一个宏来保存、编译和运行映射到`CMD+r`

编辑：

根据此链接：[http ://blog.jetbrains.com/scala/2012/12/28/a-new-way-to-compile/](http://blog.jetbrains.com/scala/2012/12/28/a-new-way-to-compile/)

**使用 SBT 增量类型而不是 IDEA 将更好地检测对 scala 文件的修改并按我们预期的那样运行。**

首选项 -> 构建 -> 编译器 -> Scala

# mysql - mysql order by and union 和圆括号

> ID：13261113
> 
> 赞同：0
> 
> 时间：2012-11-06T23:33:38.810
> 
> 标签：mysql, sql, sql-order-by, union

所以我有一个这样的查询：

```
(SELECT last_updated FROM ...) UNION (SELECT last_updated FROM ...) ORDER BY last_updated 
```

请注意，ORDER BY 语句在两个括号之外......当我运行查询时，它似乎按 last_updated 进行组合排序（这是我想要做的）。IE。它采用组合的联合结果集并按 last_updated 将它们全部排序为单个集。

但是，我想确认这确实是这样做的，那么是否有人有任何指向某些文档的链接来确认这确实会发生？如果您以这种方式执行查询，任何人都可以确认事实确实会发生这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:37:27.837

来自[UNION 语法](http://dev.mysql.com/doc/refman/5.5/en/union.html)：

> 要将 ORDER BY 或 LIMIT 应用于单个 SELECT，请将子句放在括住 SELECT 的括号内

和后面的一段：

> 要使用 ORDER BY 或 LIMIT 子句对整个 UNION 结果进行排序或限制，请将各个 SELECT 语句括起来并将 ORDER BY 或 LIMIT 放在最后一个之后。

# c# - ASP.net(c#) 中的应用程序变量。

> ID：13261114
> 
> 赞同：1
> 
> 时间：2012-11-06T23:33:47.237
> 
> 标签：c#, asp.net, webforms, application-state

我对 Asp.net 中的应用程序状态有疑问。我需要一个字符串列表，我将在同一个应用程序中以不同的形式使用这些字符串。在这里我添加列表：

```
Application.Add("users", new List<String>()); 
```

在一个新表单中，我尝试将一个字符串添加到列表中，但是在下面代码的第二行中我得到了 NullReferenceException。

```
 List<String> ls=(List<String>) Application.Get("users");
            ls.Add(TextBox4.Text); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T10:09:53.497

在第一个代码槽中，字符串是空的，因为`{new List<String>()}`. 您需要在列表中添加字符串。只有在那之后，以另一种形式调用Application变量以避免`NullReferenceException`异常。

# php - 不明白为什么单击输入按钮后未设置 $_POST

> ID：13261116
> 
> 赞同：0
> 
> 时间：2012-11-06T23:33:58.907
> 
> 标签：php, forms, post

在没有提交按钮的表单的上下文中，我不明白为什么 $_POST 变量没有设置。这是我的代码：

```
<?php
  $view="blablabla";
?>
<form class="" method='POST' accept-charset="UTF-8" action='index.php'>
<p>
  <textarea rows="4" cols="60" name='article' id='article' WRAP=SOFT>
    <?php
      echo $view;
    ?>
  </textarea>
</p>    
<p>
  <input type="button" name='do1' id='do1' value="do 1"/>
  <input type="button" name='do2' id='do2' value="do 2"/>
</p>
</form>

<?php
  var_dump("POST :",$_POST);
?> 
```

一旦我单击两个按钮之一，var_dump 不应该向 $_POST 显示一个值吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T23:35:12.697

不，输入类型必须是**提交**（`<input type="submit"/>`）才能提交表单。必须将 POST 请求发送到您的 PHP 脚本，以便在 $_POST 数组中填充任何值:)

*编辑：他们*不必提交，但在上面的代码的情况下，按钮上没有外部触发器，你需要提交按钮:)

## 对于您的多个按钮问题：

如果您使用 JavaScript/Ajax 在单击按钮时将 POST 请求发送到 PHP，则需要执行类似的操作：

```
if (isset($_POST['x'])) {
    var_dump($_POST);
    exit;
} 
```

这样脚本就不会返回页面的 HTML（即您的表单） - 如果您要发布到另一个页面，这不是问题 :)

下面是一些示例 jQuery 代码，用于在单击按钮时发送一些 POST 数据（不会为您提供确切的代码，您必须根据需要对其进行修改！）

```
$('#my_button').click(function(){
    $.post('myfile.php', data, function(response) { //the var 'data' is the POST data you're sending
        // handle response here, the data being in the response variable 
    });
}); 
```

# node.js - ExpressJS GET 重定向

> ID：13261117
> 
> 赞同：2
> 
> 时间：2012-11-06T23:34:02.060
> 
> 标签：node.js, express

我在我的 Node 应用程序上实现了一些认证路由，就像这样简单：

```
 app.get('/admin', function(req, res) {
    res.render('login', { error: false });
  });
  app.post('/admin', function(req, res) {    
    if((adminAccount.username === req.body.username) && 
      (adminAccount.password === req.body.password)) {

      res.redirect('/admin/books');
    }
    else {
      res.redirect('/admin', { error: true });
    }
  }); 
```

如果我使用正确的凭据登录，它可以完美运行，但是如果我失败了，它应该`/admin`通过重定向发出 GET 请求。但是我得到：`undefined. Redirecting to //127.0.0.1:3000/admin`

这让我`res.redirect`提出了一个`POST`请求而`/admin`不是一个请求`GET`。

我能做些什么？如何指定`res.redirect`以正确的方式重定向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:50:18.320

对我来说看起来不错，您可以尝试这样做以排除错误：错误是问题：

```
res.redirect('/admin'); 
```

如果你想闪烁一条消息，我会使用 connect-flash：

应用程序.js：

```
var flash = require('connect-flash');
app.use(flash()); 
```

路线：

```
req.flash('error', 'Woops, looks like that username and password are incorrect.');
res.redirect('/login'); 
```

中间件：

```
res.locals.message = req.flash(); 
```

看法：

```
 <% if ( message.error ) { %>
    <div class="message error"><%= message.error %></div>
  <% } %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-27T11:06:55.940

我的经验。如果你总是得到

> 不明确的。重定向到

代替

```
res.redirect('/admin', { error: true }); 
```

到

```
res.redirect('/admin'); 
```

如果没有错误，请继续尝试您想做的事情。

# python - 在调用 Matplotlib 的 PdfPages 时添加填充

> ID：13261122
> 
> 赞同：1
> 
> 时间：2012-11-06T23:35:09.297
> 
> 标签：python, matplotlib

我使用 Matplotlib 的 PdfPages 后端将一些数字保存到 PDF 文件中。不幸的是，我的一些数字被插入到 PDF 文件中，其中大部分 y 轴标签被截断。如何指定应添加额外空间以避免标签截断？我尝试调用 subplot_adjust 命令并传递 left= 和 pad= 参数无济于事。

欢迎任何其他建议！

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-04T12:31:31.223

这对我有用：

```
fig = plt.figure(figsize=(5,3.5))
fig.subplots_adjust(bottom=0.2)
ax = fig.add_subplot(111) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-12T02:20:13.323

使用 保存 pdf 时`plt.savefig`，使用 bbox_inches 和 pad_inches 参数指定填充：

```
plt.savefig('test.pdf', bbox_inches='tight', pad_inches=1) 
```

# windows-7-x64 - 它甚至不会发送 ctrl-alt-delete

> ID：13261126
> 
> 赞同：0
> 
> 时间：2012-11-06T23:35:19.937
> 
> 标签：windows-7-x64, autoit

这段代码有什么问题，我知道它应该发送`ctrl`++ ，但它没有！`alt`：`del`

```
Sleep(1000)
Send("^!{DELETE}") 
```

这应该发送`Win`+ `l`，它应该锁定计算机：

```
Sleep(1000)
Send("#l") 
```

为什么他们不工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:51:32.090

从[文档](http://www.autoitscript.com/autoit3/docs/functions/Send.htm)[中`Send`](http://www.autoitscript.com/autoit3/docs/functions/Send.htm)：

> NB Windows 不允许模拟“CTRL-ALT-DEL”组合！

此外，似乎其他人无法使用`Send("#l")`. 你可以使用它，而不是（来自[这个线程](http://www.autoitscript.com/forum/topic/139747-lock-computer/)）：

```
dllcall("user32.dll","Int","LockWorkStation") 
```

# java - 在Java中将xml文档转换为字节数组

> ID：13261128
> 
> 赞同：2
> 
> 时间：2012-11-06T23:35:22.007
> 
> 标签：java, xml, base64, bytearray

我正在尝试将任意 Xml 文档转换为字节数组，以便可以使用 Base64 对其进行编码。任何人都可以帮我解决这个问题。另外，在 Java 中用于 base64 编码的最简单的 api 是什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:41:19.613

base64 编码最简单的 API 可能是[Commons Codec](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html#encodeBase64String%28byte%5b%5d%29)。

# php - 找不到 jQuery AJAX 网址

> ID：13261131
> 
> 赞同：0
> 
> 时间：2012-11-06T23:35:35.627
> 
> 标签：php, jquery, ajax

我正在尝试让表单使用 ajax 向数据库添加评论。我遇到的问题是 ajax 无法找到 url，因为我当前的 url 是如何构造的

```
url.com/thread/id 
```

我正在尝试将 ajax 请求发送到

```
url.com/ajax_comment 
```

如果我输入整个 URL，它可以正常工作。但是我需要避免这样做，因为这个脚本可以安装在多个域上。那么如何在不硬编码网址的情况下完成此操作？

javascript中是否有类似于PHP的结构，您可以在其中执行此操作，`include('./folder/file.php');`还是有另一种方法可以完成此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:36:52.347

为什么不使用相对 URL？

```
$.ajax({
    url: "/ajax_comment",
    ...
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T23:41:58.397

相对 url 将起作用。这将检索当前域并将您的页面字符串附加到它：

```
window.location.protocol+"//"+window.location.hostname+"/ajax_comment" 
```

# git - Github 问题：credential-osxkeychain

> ID：13261133
> 
> 赞同：0
> 
> 时间：2012-11-06T23:35:41.540
> 
> 标签：git, github

每次我尝试推送某些东西时，都会被要求输入我的 git 用户和密码。我最近按照设置页面上的建议添加了 credential-osxkeychain，并将我的 git 版本升级到 1.8。

不管助手安装发生了什么，都搞砸了。我仍然可以推动，但知道有什么问题吗？以及我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T22:05:23.443

我不明白这个问题，但从评论中我看到你想更改你的推送网址。您始终可以使用重新创建遥控器

```
git remote add <name> <url> 
```

# php - 澄清 Project Euler #24 的措辞是什么意思？

> ID：13261136
> 
> 赞同：0
> 
> 时间：2012-11-06T23:35:56.893
> 
> 标签：php, permutation

[问题 24](http://projecteuler.net/problem=24 "问题 24")明确要求：

> 数字 0、1、2、3、4、5、6、7、8 和 9 的百万分之一字典排列是什么？

如果我的初始字符串是：

```
$str = "0123456789"; 
```

我将请求解释为：对 $string 执行 1,000,000 次排列。

```
for( $i = 0; $i < 1000000; $i++ ) {

    $str = lexicographicPermute($str);

}

echo $str; // prints 2783915604, an incorrect answer. 
```

但是，如果我只执行 999,999 次排列，那么它会返回正确的答案。

我仍在努力思考为什么它是正确的。

对这个问题的什么解释会导致你不执行 1,000,000 次排列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:38:24.480

你错过了你的原始字符串 ( `$str = "0123456789"`) 实际上也是一个排列的事实，它也应该被计算在内。) 考虑一下：如果你这样写会`for`怎样：

```
for( $i = 0; $i < 1; $i++ ) {
    $str = lexicographicPermute($str);
} 
```

...你会有多少排列？两个，当然：原始字符串和对其`lexicographicPermute()`调用的结果。)

作为旁注，我不认为直接方法（从字面上构建那些（百万 - 1）排列）是解决这个问题的正确方法。否则对人类来说不会有这么大的问题，不是吗？)

# google-maps-api-3 - 将 GSize 像素转换为静态图像的 LatLngBounds

> ID：13261140
> 
> 赞同：2
> 
> 时间：2012-11-06T23:36:19.193
> 
> 标签：google-maps-api-3

在 Google Maps API v2 中，我使用 GSize(125,130) 使用第 3 方 EInsert 在我的地图上放置了一个 125 x 130 像素的 png 图像。

API v3 使用 imageBounds 对象提供本机 groundOverlay。

好的，我让它工作了，通过猜测 LatLngBounds 我非常接近，但更愿意知道如何将图像的像素转换为度数，以便我的图像以正确的纵横比呈现 100%。

我不想做任何花哨的调整大小或动态计算。

我只想知道**1 像素 = x 度**[接近 (37,-122) 且缩放级别为 10]

# java - 需要 Java 等价于 php 中的 pack("H32", param)

> ID：13261147
> 
> 赞同：0
> 
> 时间：2012-11-06T23:36:48.363
> 
> 标签：java, php, pack

我需要这个 php 代码的 java 等效项：

```
$string = "testing";
$hexchal = pack('H32', $string); 
```

我确实搜索了互联网，但没有找到答案。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:16:28.743

我不认为你上面的代码有效。您希望字符串为十六进制格式。这应该可以解决问题，但不如 php 好。

```
String hex = "4a616d6573";
StringBuilder output = new StringBuilder();
for (int i = 0; i < hex.length(); i+=2) {
    String str = hex.substring(i, i+2);
    output.append((char)Integer.parseInt(str, 16));
}
System.out.println(output); 
```

# javascript - 移动Safari元素神秘地显示多项选择 这是一个糟糕的问题，因为我无法提供任何可重现的示例。但是，我没有找到任何关于我在任何地方看到的行为的参考，所以我认为这是我最好的选择。我将三个 <select>元素设置为日期选择机制。它们背后有一些事件处理程序来执行诸如更新月份或年份变化时的日期列表之类的事情，仅此而已。元素本身非常简单：</select> <option value="1">01

ID：13261152

赞同：3

时间：2012-11-06T23:37:17.357

标签：javascript, html, ios, html-select</option>

# c++ - 使用 C++ 进行多任务处理。线程或不同的设计？

> ID：13261160
> 
> 赞同：3
> 
> 时间：2012-11-06T23:37:46.250
> 
> 标签：c++

我一直使用诸如 PHP 之类的脚本语言来运行页面、完成运行并给出输出。但是，我想在需要多线程两个任务的 C++ 上做一些不同的事情。

首先，主线程应该运行，（比方说）一个每 1 秒刷新一次的 cpu 温度计，第二个线程应该做其他事情。（比如读取windows目录下的所有目录。）

照这样说;

1.  使用线程是我唯一的机会，还是我可以为这项任务使用不同的编程概念？

2.  尤其是在游戏中，有很多东西在后台运行。例如，NPC/Monsters 的 AI、图形引擎、物理引擎、玩家移动、键盘交互等。它们在一个进程中工作，那么它是如何处理的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:43:12.757

创建一个线程来读取 CPU 温度计，并且每秒读取目录结束。多线程没有太多好处，但管理线程可能会有些痛苦。您可以将您的*任务*放在一个列表中，并以第二种方式安排它们。

我不确定游戏的东西，但我相信他们对项目/任务进行分类，并在循环中安排/检查/处理。为某些专用任务（如套接字通信、gui 渲染等）创建了一些线程，但为每个项目创建一个专用线程，说蠕变已经结束。

如果可以在一个线程中完成，我的建议是不要轻易将多线程引入您的应用程序。多线程会产生其他方面的影响，如同步问题、线程管理问题等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T07:45:36.223

我认为，您的挑战假定基于任务的并发性。所以，从异步工作的角度来考虑它，而不仅仅是底层线程。但是，许多库为并发任务提供了安全、高效和可靠的高级异步 API。我建议如下：

1.  Qt 与[QtConcurrent](http://qt-project.org/doc/qt-4.8/threads-qtconcurrent.html)框架。
2.  [带有多线程](http://pocoproject.org/slides/130-Threads.pdf)子部分的 POCO C++ 库。
3.  [来自 C++11 的std::async](http://en.cppreference.com/w/cpp/thread/async)模板。或者 boost::thread 用于旧环境。

我应该提到标准的 std::async 或 boost 替换在基于任务的并发方面有不同的问题（它没有提供许多调整执行策略的功能，例如当派生新线程时，当窃取任务时等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T23:45:35.190

线程将是正确的选择恕我直言。

一种替代方法（依赖于操作系统）是分叉子进程。是的，线程也依赖于操作系统，但至少对于 C++11，这些线程有标准抽象。对于非 C++11 应用程序，如果有适当的端口可用，则可以轻松使用为操作系统或 POSIX pthreads 库提供的各种线程 API。

非常简单的操作系统的另一种选择是使用所谓的协同程序而不是线程，例如，FreeRTOS 提供了这种方法。

详细说明您的观点2）：

这需要实现某种共享内存来在运行自己的执行线程的对象之间交换信息和状态。共享内存需要使用适当的同步机制，如互斥锁、读/写锁、信号量等。

在某些特殊情况下，实现自己的任务调度机制而不是依赖操作系统可能是有意义的。但这也需要一些中断驱动机制来切换您的任务执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T00:03:03.103

这取决于具体的任务和它们之间的依赖关系。

当你有不相关的任务时，我会在单独的进程中运行它们，这里不需要线程。但是，如果您有强耦合，多线程可能是正确的答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T06:33:59.763

您可以使用多个线程或多个进程。

线程和进程之间的一个关键区别是**线程**共享**一个内存空间**，而**每个进程**都有**自己的内存空间**。

如果您的任务需要频繁共享对象，例如在图中插入/删除/搜索/更新节点，多线程将允许每个线程通过指针轻松访问图。这对于多个进程来说更加困难。

如果您的任务不经常共享对象，例如测量温度、渲染图像、播放音乐，那么共享一个内存空间不会给您带来太多好处。在这种情况下，多个进程更适合您。

# oracle - 使用 plsql 的用户定义的自定义聚合函数

> ID：13261164
> 
> 赞同：4
> 
> 时间：2012-11-06T23:38:45.903
> 
> 标签：oracle, plsql, oracle10g

我有问题。我使用的工具不接受子查询。所以我必须编写一个用户定义的自定义聚合函数来执行以下操作。

示例： col1 和 col2 具有数字数据类型。

```
**col1**    **col2**
243         401
57489       400
2789        401
598         400

SELECT sum(MinValue) 
FROM
    (SELECT Min(col1) AS MinValue,col2
    FROM
    Table1
    GROUP BY col2)

Output:841 
```

我希望这个查询通过使用单个函数而不是上面显示的查询在一个步骤中工作。就像是：

```
SELECT MyMinSum(col1, col2),col3 from table1 Group by col3; 
```

我希望这是有道理的。我将不胜感激对此的任何意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T05:37:15.840

如果您正在寻找与使用子查询的选择语句相同的输出，您可以通过以下方式获得相同的结果

```
 SELECT   SUM (MIN (col1)) AS minvalue
 FROM   Table1
GROUP BY   col2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T15:04:15.020

最好的方法可能是将您的 SQL 放在一个视图中，假设它适用于您的工具。

但是如果你真的需要一个自定义聚合函数，有两种主要方法可以做到。典型的方式是使用[Oracle Data Cartridge Interface](http://docs.oracle.com/cd/E11882_01/appdev.112/e10765/aggr_functions.htm#CECJAAJG)，例如流行的[STRAGG](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3aNO%3a%3aP11_QUESTION_ID:2196162600402)。但根据我的经验，Data Cartridge 令人困惑，充满了 bug，而且速度很慢。通常该`COLLECT`功能工作得更好。请参阅下面的示例或此[SQL Fiddle](http://sqlfiddle.com/#!4/acb68/4)。

```
create table table1(col1 number, col2 number, col3 number)
/

insert into table1
select 243,   401, 1 from dual union all
select 57489, 400, 1 from dual union all
select 2789,  401, 1 from dual union all
select 598,   400, 1 from dual union all
select 598,   400, 2 from dual
/

create or replace type col1_col2_obj is object
(
  col1 number,
  col2 number
)
/

create or replace type col1_col2_nt is table of col1_col2_obj
/

create or replace function MyMinSum(p_col1_col2_nt in col1_col2_nt)
return number is
  v_result number;
begin
  SELECT sum(MinValue)
  INTO v_result
  FROM
  (
    SELECT Min(col1) AS MinValue,col2
    FROM
    table(p_col1_col2_nt)
    GROUP BY col2
  );

  return v_result;
end;
/

select
  MyMinSum(cast(collect(col1_col2_obj(col1, col2)) as col1_col2_nt)) test
  ,col3
from table1
group by col3
/

TEST    COL3
841     1
598     2 
```

# c - 使用 C 中的指针扫描字符串

> ID：13261169
> 
> 赞同：1
> 
> 时间：2012-11-06T23:39:09.497
> 
> 标签：c, string, pointers, scanf

> **可能重复：**
> [动态字符串输入 - 使用 scanf(“%as”)](https://stackoverflow.com/questions/2329909/dynamic-string-input-using-scanfas)
> [strcmp 和指针在 C 中不起作用](https://stackoverflow.com/questions/13253113/strcmp-with-pointers-not-working-in-c)

以下被认为是好的代码吗？我不应该在某处使用 malloc 吗？我能够编译它并且它有效，但我觉得它不应该。

```
#include <stdio.h>

int main (void) {

    char *name;

    printf("Whats your name? ");
    scanf("%s", &name);
    printf("\nyour name is %s", &name);

    return 0;
} 
```

如果我想修改名称会怎样？我该怎么做呢？

编辑：我真的只是在寻找使用指针的最有效和正确的方法。我假设 malloc 是必要的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T23:51:27.083

`name`是一个指针，并`&name`返回变量的地址`name`，因此`scanf`将您输入的名称放入指针本身。

例如，如果您输入，`ABC`则指针将为 0x00434241（如果 CPU 是 little-endian）或 0x41434200（如果 CPU 是 big-endian），其中 0x41 是 'A' 的字符代码，0x42 是'B' 等。

您应该分配可以存储输入名称的内存，然后将指向它的指针传递给`scanf`.

这是一个在堆栈上分配的示例：

```
#include <stdio.h>

#define MAX_NAME_LENGTH 256

int main (void) {

    char name[MAX_NAME_LENGTH];

    printf("Whats your name? ");
    scanf("%s", name);
    printf("\nyour name is %s", name);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-06T23:56:19.343

或者，您也可以使用获取，以避免在您有超过 2 个连续输入的情况下使用标准输入缓冲区。

```
#include <stdio.h>

#define LENGTH 256

int main (void) {

   char name[LENGTH];

   printf( "Whats your name? " );
   fgets( name, sizeof( name ), stdin );
   printf( "\nYour name is %s", name );

   return 0;
} 
```

# html - 页面在除 chrome 之外的所有地方都正确显示。？

> ID：13261172
> 
> 赞同：0
> 
> 时间：2012-11-06T23:39:36.487
> 
> 标签：html, css, google-chrome

在这里敲我的头。这可能是我所缺少的显而易见的东西，但是[这里](http://shopkosher.ca/)的 css ，特别是 Background，除了 chrome 之外在任何地方都可以工作。似乎无法弄清楚为什么:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:15:14.780

在 global.css 文件中查找第 28 行：

```
.clearfix::before, .clearfix::after {
  content: ".";
  display: block;
  height: 0;
  overflow: hidden; 
```

“显示：块；” 是你的问题。尝试删除或创建一个新类，因为我可以看到它严重影响了整个页面。
**注意**已编辑 - 使用“显示：内联；” 这似乎解决了这个错误。

# mysql - MySQL - 多个唯一/限制数量

> ID：13261174
> 
> 赞同：0
> 
> 时间：2012-11-06T23:39:49.803
> 
> 标签：mysql

我的问题比示例更笼统，但我认为说明这个想法的唯一方法是使用示例。

假设我想为聊天应用程序创建一个数据库。会有一个主题列表。任何“房间”4 个用户在任何时间。

假设有一个话题叫“贝多芬”。如果用户选择该主题，则会获取或创建一个房间。一旦 4 个用户加入了该房间，就会创建房间的另一个实例（相同主题），在创建另一个实例之前最多需要 4 个用户。如果第一个房间实例的用户离开，则该槽是打开的，因此加入主题的第 9 个用户将被发送到第一个房间实例。

管理此问题的最佳方法是什么？我有两个想法：

1.  “主题”表：id、标签
2.  “房间”表：id、topicId
3.  “人口”表：roomId、userId

当用户选择/加入一个主题时，例如`SELECT COUNT(userId) FROM Population WHERE topicId = <id>`... 如果 count > 4，创建一个新 Room，将其插入并返回插入 ID。当用户离开房间时，会删除 Population 中的该行。

或者...

1.  “主题”表：id、标签
2.  “房间”表：id、topicId、user1、user2、user3、user4。

然后当用户加入时，类似`SELECT id FROM Rooms WHERE ISNULL(user1) OR ISNULL(user2) OR ISNULL(user3) OR ISNULL(user4) LIMIT 1`

如果没有匹配的行，则插入一个新 Room 并返回插入 ID。当用户离开房间时，该列设置为 NULL。

蒂亚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T23:54:39.460

我使用了你的第一个模式。

获取未满房间的列表：

```
SELECT room.id
FROM       topic
INNER JOIN room       ON room.topic_id = topic.id
INNER JOIN population ON population.room_id = room.id
WHERE topic.label = 'purcell'
GROUP BY room.id
HAVING COUNT(*) < 4 
```

如果没有找到这样的房间，则获取第一个未满的房间 id 或 NULL：

```
SELECT MIN( room_id )
FROM (
  SELECT room.id AS room_id
  FROM       topic
  INNER JOIN room       ON room.topic_id = topic.id
  INNER JOIN population ON population.room_id = room.id
  WHERE topic.label = 'purcell'
  GROUP BY room.id
  HAVING COUNT(*) < 4
) AS non_full_rooms 
```

# python - pandas 将数据框转为 3d 数据

> ID：13261175
> 
> 赞同：3
> 
> 时间：2012-11-06T23:39:52.993
> 
> 标签：python, pandas

将平面表数据转换为 3d 数组似乎有很多可能性，但我不知何故找不到一个可行的方法：假设我有一些数据，其中 columns=['name', 'type', 'date', '价值']。当我尝试通过

```
pivot(index='name', columns=['type', 'date'], values='value') 
```

我明白了

```
ValueError: Buffer has wrong number of dimensions (expected 1, got 2) 
```

我可能在阅读来自 dev pandas 的文档吗？似乎这是那里描述的用法。我正在运行 0.8 只熊猫。

我想，我想知道我是否有一个 MultiIndex ['x', 'y', 'z'] 系列，有没有一种熊猫方法可以将它放在面板中？我可以使用 groupby 并完成工作，但这几乎就像我在 numpy 中组装一个 nd 数组一样。似乎是一个相当通用的操作，所以我想它可能已经实现了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-07T13:16:49.540

`pivot`仅支持使用单个列来生成列。您可能希望[`pivot_table`](https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html#pivot-tables)使用多列生成数据透视表，例如

```
pandas.tools.pivot.pivot_table(your_dataframe, values='value', index='name', columns=['type', 'date'], aggfunc='sum') 
```

[API 参考](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot.html?highlight=pivot#pandas.DataFrame.pivot)和[文档](https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html#reshaping-by-pivoting-dataframe-objects)中提到的分层列与`pivot`您有多个*值*字段而不是多个*类别*的情况有关。

假设 'type' 和 'date' 是类别，它们的值应该用作列名，那么你应该使用`pivot_table`.

但是，如果您想为同一类别（例如“类型”）的不同值字段提供单独的列，那么您应该使用`pivot`而不指定值列和您的类别作为列参数。

例如，假设你有这个 DataFrame：

```
df = DataFrame({'name': ['A', 'B', 'A', 'B'], 'type': [1, 1, 2, 2], 'date': ['2012-01-01', '2012-01-01', '2012-02-01', '2012-02-01'],  'value': [1, 2, 3, 4]})

pt = df.pivot_table(values='value', index='name', columns=['type', 'date'])
p = df.pivot('name', 'type') 
```

pt 将是：

```
type           1           2
date  2012-01-01  2012-02-01
name                        
A              1           3
B              2           4 
```

和 p 将是：

```
 date              value   
type           1           2      1  2
name                                  
A     2012-01-01  2012-02-01      1  3
B     2012-01-01  2012-02-01      2  4 
```

**注意**：对于 < 0.14.0 的 pandas 版本，`index`和`columns`关键字参数应分别替换为`rows`和`cols`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-13T16:40:16.813

原帖以问题结尾：

> “我想知道我是否有一个 MultiIndex ['x', 'y', 'z'] 系列，有没有一种熊猫方法可以将它放在面板中？”

我自己正在寻找解决方案。

我最终得到以下结果：

```
In [1]: import pandas as pd

## generate xyz example:
In [3]: df = pd.DataFrame({col:pd.np.random.randint(0,10,10) 
                               for col in ['x','y','z','data']})

## set all x,y,z coordinates as indices
In [5]: df.set_index(['x','y','z'], inplace=True)

## set the z coordinate as headers of the columns 
# NB: this is will turn the data into "dense" with NaNs where there were no 'data'
In [7]: df = df['data'].unstack()

## now it is ready to be "pivot"ed into a panel
In [9]: data_panel = df.to_panel()

In [10]: df
Out[10]: 
     data                        
z       1   3   4   5   6   7   9
x y                              
1 5   NaN NaN NaN NaN NaN NaN   1
  6   NaN NaN NaN NaN NaN NaN   0
2 9   NaN NaN NaN NaN NaN   1 NaN
3 9     6 NaN NaN NaN NaN NaN NaN
5 9   NaN NaN NaN NaN NaN NaN   8
7 1   NaN NaN NaN NaN   8 NaN NaN
  3   NaN NaN NaN NaN NaN NaN   5
  7   NaN NaN NaN   1 NaN NaN NaN
  9   NaN   0 NaN NaN NaN NaN NaN
9 5   NaN NaN   1 NaN NaN NaN NaN

[10 rows x 7 columns]

In [11]: data_panel
Out[11]: 
<class 'pandas.core.panel.Panel'>
Dimensions: 7 (items) x 6 (major_axis) x 6 (minor_axis)
Items axis: 1 to 9
Major_axis axis: 1 to 9
Minor_axis axis: 1 to 9 
```

列标题将是面板的项目，第一级索引是 MajorAxis（行），第二级是 MinorAxis（列）

# extjs - 网格中缺少滚动条，缓冲网格中缺少数据，布局不会调整大小

> ID：13261181
> 
> 赞同：0
> 
> 时间：2012-11-06T23:40:13.337
> 
> 标签：extjs, extjs4, extjs4.1

> 可在 github 上找到重现源和问题描述： [https ://github.com/romacafe/extjs_4.1.1_scrollIssue](https://github.com/romacafe/extjs_4.1.1_scrollIssue)

我正在尝试在选项卡面板中创建一个带有 2 个“无限网格”的 extjs 4.1.1（GPL 版本）应用程序，嵌套在边框布局中。

*   我可以渲染非缓冲（非无限）网格，但没有滚动条。
*   当我配置网格并存储无限滚动（缓冲存储，网格上的verticalScroller 配置）时，它根本不会呈现任何数据。
*   总的来说，当我调整窗口大小时，整个布局不会调整大小。

应用程序呈现到 div，而不是文档正文。这对我很重要，但可能会导致这个问题。我已经在引用的 github 存储库中完全复制了这个问题。

任何帮助将不胜感激！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T15:50:10.133

我认为您的问题在于未能为父容器指定布局，这使您的选项卡面板的主体可以无限期扩展。这可以防止网格从布局中获得定义的高度/宽度，并导致缓冲网格中的零高度网格，以及扩展其高度以包含静态记录的所有记录的网格。在 app.js 的中心面板定义中，这对我有用：

```
//Store a reference to the main element that you create and add the to application div
ScrollIssue.element = Ext.create('Ext.container.Container', {
    renderTo: 'application',
    height: windowHeight,
    layout: 'border',
    bodyBorder: true,
    defaults: {
        bodyPadding: 5
    },
    items: [
        {
            title: 'Filters',
            region:'north',
            floatable: false,
            margins: '5 0 0 0',
            height: 150,
            minHeight: 150,
            maxHeight: 150,
            collapsible: true,
            collapsed: true,
            html: 'filters would go here'
        },
        {
            title: 'Main Content',
            region: 'center',
            margins: '5 0 0 0',
            //Add a layout here
            layout: 'fit',
            items: [
                Ext.widget(
                    'tabpanel', {
                        activeTab: 0,
                        plain: true,
                        //Add a layout here
                        layout: 'fit',
                        //Change this to regular padding
                        defaults: {padding: 10},
                        items: [
                            {
                                title: "Static",
                                xtype: 'staticGrid'
                            },
                            {
                                title: "Buffered",
                                xtype: "bufferedGrid"
                            }
                        ]
                    }
                )
            ]
        },
        {
            title: 'Detail',
            region: 'south',
            height: 150,
            minHeight: 100,
            maxHeight: 250,
            html: 'Detail Panels',
            collapsible: true
        }
    ]
});

//Listen to the window resize event and reset the height to
// 50 pixels less than the total viewport height to account
// for the banner above
Ext.EventManager.onWindowResize(function(w, h) {
    ScrollIssue.element.setHeight(h - 50);
}) 
```

请注意“布局：适合”添加到主内容和选项卡面板以及从 bodyPadding 到常规填充的更改（主体样式导致出现水平滚动条）。

**编辑** 要使窗口调整大小起作用，您需要告诉顶层 ext 组件窗口高度的变化。由于顶部的横幅不在代码中的任何位置，因此它无法知道屏幕上其他元素的大小或您希望布局管理器如何与它们交互。此外，当您将高度设置为像此处一样的静态值时，它不会尝试更改，因为它的容器发生了变化。但是，如果您在调整窗口大小时显式重置高度，则效果很好。

# c# - 如何打开服务端口？

> ID：13261184
> 
> 赞同：1
> 
> 时间：2012-11-06T23:40:16.533
> 
> 标签：c#, asp.net, .net, wcf, iis-7

调用 WCF 服务时收到错误代码 10061。错误是

> 无法连接到`<service uri`>。连接尝试持续了 xxxx 的时间跨度。TCP 错误代码 10061。由于目标机器主动拒绝，无法建立连接。

当我做一个

```
netstat -a 
```

我没有看到这个 net.tcp 服务地址应该在监听的端口。在 IIS 中，该服务所在的网站已经启动。任何想法为什么该端口未在 TCP 中列为侦听或我如何让它侦听？

# c++ - 我可以使用 use_lazy_terminal 使终端的第一个参数变得懒惰吗？

> ID：13261185
> 
> 赞同：3
> 
> 时间：2012-11-06T23:40:24.277
> 
> 标签：c++, boost-spirit

我有一个自定义终端`boost::spirit`，我希望用户能够将终端的第一个参数作为惰性参数提供，其余参数作为普通文字字符串。`use_lazy_terminal`例如，如果在我的专业中我使用：

```
template<>
struct use_lazy_terminal<qi::domain, my_custom_tag, 1 /*only first parameter*/>
    : mpl::true_ {}; 
```

@sehe 非常感谢您的回答，我对这个问题的关注不是性能，我知道编译器会优化和 ... 。让我解释一下我创建自定义终端的原因：

如您所知，`qi`语法的编译真的很慢，并且很难找到错误的来源（与简单使用`qi`它本身相比），所以我决定编写一个自定义终端来获得这个：`debug_position( debug_callback, rule_name, msg )`. 因此，我可以将自定义消息从我的规则发送到自定义调试器，正如您所见，它非常简单，我可以借助语义操作来做到这一点，但是使用这种技术并将其与在发布模式下扩展为空的宏结合起来，我可以简单地编写我的语法并调试我想要的任何语法。但是由于我的消息和规则名称是不变的，我将它们存储为`const char*`不是一个`std::string`或类似的东西，所以我认为是否有可能从函数提供第一个参数但其余的强制为文字？我可以`const char (&) [N]`在我的专业中使用`use_terminal`强制用户使用字符串文字。

如你所见，没有这个我也可以生活，但我真的很想知道，我能在精神上做到这一点吗？

我的源代码位于： http: [//pastebin.com/275S6Czu](http://pastebin.com/275S6Czu)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T10:44:21.077

我在这里看不到确切的问题。代码是否编译为文字或引用将取决于调用代码。

使用语义操作时更简单的示例：

```
rule1 = int_ [ myactor(_1, phx::val("thisvalue"), phx::cref(instance) ];

// or equivalently

rule1 = int_ [ myactor(_1, "thisvalue", phx::cref(instance) ]; 
```

这里，

*   第一个论点是一个懒惰的演员
*   第二个参数是一个*文字*，它的值（在这种情况下是 a `const char(&)[10]`）将被绑定。这将作为`const char*`on 调用传递。( `action_dispatch`)
*   第三个将传递一个 const 引用`instance`，即它不会在`expression template`初始化时复制该值。

所有这些都是*编译时通用的*，这意味着您可以期望编译器生成相同的代码（启用优化），就像您编写直接函数调用时一样

```
 myfunction(?, "thisvalue", instance); // assuming instance a const lvalue 
```

**结束语**

我认为你可以忽略这个问题。我想说*不*将参数视为惰性参与者主要是*编译时优化*（例如，减少编译时间和模板实例化的优化）。

我希望你应该得到你想要的，只需***将所有参数声明为 'potentially lazy' ¹***：

*   它会复制你作为演员传入的任何演员
*   它将任何非凤凰值包装在 val 演员中 - 这与通用引用有点不同
*   但是，最终生成的代码应该通过将其内联来“蒸发”该包装层

**注意**我没有时间检查/证明我在上面所做的断言。我仍然把它扔在那里，所以你可以咀嚼它。

* * *

¹在这里寻找类似于 [ *universal references* ] 的术语：一种*形式参数类型*，它根据传入的*实际参数*“推导”（编译为）演员***或文字。***

 *当然，在这种情况下，文字只会被包裹在 phx::val 中*

# php - 如何使用 Imagick、ImageMagick 和 PHP 从 PDF 创建特定数量的缩略图？

> ID：13261189
> 
> 赞同：0
> 
> 时间：2012-11-06T23:41:14.503
> 
> 标签：php, pdf, image-processing, imagemagick, imagick

我想使用 PHP、ImageMagick 和 Imagick（PHP 类）来创建 PDF 的缩略图。有些 PDF 只有一页，有些则有很多。我想指定要创建的缩略图数 ( N )，PDF 中的前 N ​​页中的每一页都有一个。

下面的代码有效，但是当 PDF 没有足够的页面时会产生错误（因为我试图在不存在的 PDF 页面上实例化 Imagick）。我也知道 ImageMagick 在命令行中使用时可以为 PDF 中的所有页面创建缩略图。我想以最有效的方式（内存和处理器）模仿这种行为，同时控制创建的拇指数量......我只需要大型 PDF 中前 N 页的缩略图。

我查看了各种方法来确定 PDF 中的页数，它们似乎都是资源密集型的。也许下面的代码是我最好的选择。它实现了我的目标，但让我感到困扰，因为它会导致一些错误......即使它们不会影响最终结果。

这是我目前有效的代码（当 PDF 的页面少于 N 页时出现错误）：

```
private function create_thumbnails(
    $num_thumbs = 3     // how many thumbnails to create, defaults to one
) {

    echo "\n\n    creating thumbnails ... ";

    $num_thumbs_created = 0;
    while( $num_thumbs_created < $num_thumbs )
    {

        try {

            // instantiate imagick with the pdf
            $Image = new Imagick( $this->file_path_pdf . '[' . $num_thumbs_created . ']' );

            // define image file
            $Image->setImageColorspace( 255 );
            $Image->setCompression( Imagick::COMPRESSION_JPEG );
            $Image->setCompressionQuality( 60 );
            $Image->setImageFormat( 'jpg' );

            // size the thumbnail
            //  - resized relative to 8.5x11 ( assuming most pdfs are paper sized )
            $Image->resizeImage( 180, 232, imagick::FILTER_POINT, 1 );

            // save image
            $Image->writeImage( substr( $this->File->path, 0, -4 ) . '-' . $num_thumbs_created . '.jpg' );
            $Image->clear();

            $num_thumbs_created++;

        } catch( Exception $e ) {

            echo "\n  * failed to create some or all thumbnails: " . $e->getMessage();
            break;

        }

    }   

    $Image->destroy();

    echo "done";

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:18:08.990

我很确定如果您打开 PDF，那么`Imagick::getNumberImages`会给您页数。同样，此时您可以使用 magick 迭代它们，而不必每页实例化。不过，所有这些都是基于文档的推测。所以你必须自己测试并找出：

```
private function create_thumbnails( $num_thumbs = 3) {

    echo "\n\n    creating thumbnails ... ";

    try {
        $Image = new Imagick( $this->file_path_pdf);
        $nbCreated = 0;
        if($num_thumbs > 0) {
           foreach($Image as $idx => $im) {
              if($nbCreated < $num_thumbs) {
                $im->setImageColorspace( 255 );
                $im->setCompression( Imagick::COMPRESSION_JPEG );
                $im->setCompressionQuality( 60 );
                $im->setImageFormat( 'jpg' );

                $im->resizeImage( 180, 232, imagick::FILTER_POINT, 1 );

                // save image
                $im->writeImage( $idx . '-' . $nbCreated . '.jpg' );
                $im->clear();

                $nbCreated++;
              }
              else 
              {
                 break; // pop out of loop we have reach our limit and are done
              }
           }

        }

        $Image->destroy();
    }
    catch( Exception $e ) {
       echo "\n  * failed to create some or all thumbnails: " . $e->getMessage();
       $Image->destroy();    
    }   

    echo "done";
} 
```

注意我也改变了你尝试/捕捉的地方。如果出现错误，IMO 最好保释并停止一起创建图像，因为如果您正在处理单个文件，那么每次迭代都会抛出错误，因此在第一个异常时停止可能更有效。您可以轻松地将其包装在不同的位置，这就是我的做法。

# c++ - 等效 C 字符串的不同语法？

> ID：13261191
> 
> 赞同：1
> 
> 时间：2012-11-06T23:41:21.133
> 
> 标签：c++, arrays, string, null, character

```
char s[] = "hello world";
char s[] = {'h', 'e', 'l', 'l', 'o', ' ', 'w', 'o', 'r', 'l', 'd', 0}; 
```

这两行代码在 C++ 中是否等效？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T23:53:21.917

不，第一个通过从存储在静态内存中的字符串文字复制来初始化数组。第二个是从数组初始化器列表初始化的，它可能不会在静态内存中创建任何东西，但会生成指令以将常数（指令固有的）移动到数组中的每个位置。

此外，如果两个事物相等，那么对它们应用相同的变换也将导致相等。但是，将两者都更改为指针而不是数组（并添加 const）将阻止具有初始化程序列表的那个进行编译，因此它们进一步不同。

忽略这些差异，无论哪种方式，您最终在数组中得到的结果都是相同的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T23:43:09.730

是的，它们是等价的，但它是 C，而不是 C++。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-06T23:43:32.710

如果您忘记了第二个更难写的事实，那么它们是相同的！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T23:43:07.340

差不多……是的。两者都是可变的并以空字符终止。

除了第一个被隐式终止。

# tsql - 获取每个月的最大日期 (T-SQL)

> ID：13261194
> 
> 赞同：1
> 
> 时间：2012-11-06T23:41:30.573
> 
> 标签：tsql

我有一个表格，其中包含屏幕截图中给出的数据

.![在此处输入图像描述](../Images/85b7b78bb0abd9c7eba2205c170e3f26.png)

我只需要获取每个月具有最大 Snapshot_Date 的那些记录。

我需要我的结果数据集如下

![在此处输入图像描述](../Images/8ed6170954b8639e1af502faf933053f.png)

我怎么能这样做。我需要你的想法。

我尝试使用

```
select * 
from table 
where Snapshot_Date = (select MAX(Snapshot_Date) 
                       from table 
                      where DATEPART(MONTH,Snapshot_Date)=11) 
```

但我需要在这里硬编码月份数字！！谢谢你的时间！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T23:45:00.270

```
SELECT Snapshot_Date, Quantity
FROM
    (
        SELECT  DATENAME(month, Snapshot_Date) MonthName, 
                Snapshot_Date, Quantity,
                ROW_NUMBER() OVER (PARTITION BY DATENAME(month, Snapshot_Date)
                                    ORDER BY Snapshot_Date DESC) rn
        FROM    tableName
    ) a
WHERE rn = 1 
```

*   [**SQLFiddle 演示**](http://sqlfiddle.com/#!3/07467/5)

来源

*   [**日期名称**](http://msdn.microsoft.com/en-us/library/ms174395(v=sql.90).aspx)
*   [**OVER**条款](http://msdn.microsoft.com/en-us/library/ms189461.aspx)
*   [**ROW_NUMBER()**](http://msdn.microsoft.com/en-us/library/ms186734.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:22:55.613

嗨，我通过使用分区函数解决了这个问题，如下所示

`SELECT Snapshot_Date, Quantity FROM ( SELECT Snapshot_Date, Quantity, rn = ROW_NUMBER() OVER (PARTITION BY DATEDIFF(MONTH, '20000101', Snapshot_Date) ORDER BY Snapshot_Date desc) FROM table ) AS x WHERE x.rn = 1 ORDER BY x.Snapshot_Date`

# android - HTTPS 请求：SchemeRegistry 有必要吗？

> ID：13261200
> 
> 赞同：1
> 
> 时间：2012-11-06T23:42:05.163
> 
> 标签：android, https, request, httpclient

根据[此响应](https://stackoverflow.com/questions/2603691/android-httpclient-and-https)（2010 年 4 月），他们说有必要使用适当的 SchemeRegistry 配置 HttpClient 以发送 HTTPS 请求。

[相反，另一个响应](https://stackoverflow.com/questions/3989806/https-request-response-in-android)（2010 年 10 月）表示在请求 uri 中指定 HTTPS 协议就足够了。

我尝试执行 HTTPS 请求，只需在 uri 地址中添加“https”，它似乎可以工作（我尝试使用 www.google.com 或 www.facebook.com 之类的地址）。2010 年 4 月到 2010 年 10 月之间标准库有什么变化吗？还是在某些特定情况下我必须使用解决方案而不是其他解决方案？

谢谢。

# asp.net - SelectedIndexChanged 的 ASP.NET AutoPostBack 触发表单的 onsubmit 脚本

> ID：13261201
> 
> 赞同：0
> 
> 时间：2012-11-06T23:42:08.430
> 
> 标签：asp.net, onsubmit, autopostback, selectedindexchanged

自从从 .NET 1.1 升级到 4.0 后，我的表单出现了问题。

该表单有一些带有 AutoPostBack=true 的下拉列表，因为它们有一些 SelectedIndexChanged 处理程序需要触发以填充其他下拉列表等。

但是现在，当在下拉列表中选择一个新值时，它会触发表单标记中指定的 onSubmit 脚本：

```
<form id="Form1" method="post" runat="server" onsubmit="return jvsValidate() ;"> 
```

以前，只有在单击按钮控件时才会触发：

```
<asp:button id="btnRoute" runat="server" text="Save"></asp:button> 
```

纠正这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T07:42:06.377

从 onsubmit="return jvsValidate() 中删除；" 在表单标签中并使用如下按钮更新语法

```
<asp:button id="btnRoute" runat="server" text="Save" OnClientClick="return jvsValidate();" ></asp:button> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T23:54:00.350

似乎最简单的解决方法是附加`jvsValidate()`到`btnRoute`点击事件，而不是表单的提交事件。只需在效果中添加一些 Javascript `document.getElementById('btnRoute').click = jsValidate;`，然后从表单中删除该`onsubmit`属性。

# regex - 为什么这个正则表达式与另一个不匹配？

> ID：13261203
> 
> 赞同：0
> 
> 时间：2012-11-06T23:42:37.607
> 
> 标签：regex

我试图在下面的例子`@@BOKeyword-`中匹配最里面的内容：`-End@@`

```
@@BOKeyword-Here is@@BOKeyword-I want to match this!-End@@stuff-End@@ 
```

所以我的比赛是：`I want to match this!`我正在使用以下正则表达式：`@@BOKeyword-([^@@BOKeyword--End@@]*)-End@@`

但是，这根本不匹配。我基于这个例子开发了这个，这个例子是我从[上一个问题的答案](https://stackoverflow.com/a/13260947/971592)中得出的：

```
AC I want to match this! BD I don't want to match this! AC I want to match this! BD I don't want to match this! BD 
```

使用正则表达式：`AC([^ACBD]*)BD`

这按预期工作。我想我误解了这是如何工作的。任何提示将不胜感激！谢谢！

**注意：**我在 Java 中运行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:49:47.430

如果你的正则表达式引擎支持`lookaround`，你可以试试这个：

```
(?<=@@BOKeyword-).((?<!@@BOKeyword-).(?!-End@@))*.(?=-End@@) 
```

*   第一个`DOT`匹配起始字符：`I`
*   中间`DOT`匹配未被分隔符包围的字符：`·want·to·match·this`
*   最后`DOT`匹配结束字符：`!`

* * *

有 2 种情况未涵盖（两者之间只有一个/零字符）：

```
(?<=@@BOKeyword-).?(?=-End@@) 
```

* * *

将这两个正则表达式结合起来非常困难。另一种方法是：

*   `{`用/ `}`（或其他单个字符对）替换您的分隔符
*   写一个更简单的正则表达式来匹配

# azure - GitHub 推送到 Azure 网站

> ID：13261205
> 
> 赞同：0
> 
> 时间：2012-11-06T23:43:03.460
> 
> 标签：azure, github, azure-web-roles

我有一个 GitHub 存储库，我希望 Azure 监视更改并在更新时获取最新信息。我在“部署”选项卡中可以“关联 GitHub 存储库”。当我单击“授权 Windows Azure”链接时，会弹出一个对话框并且我的一些存储库可用，但我要发布的存储库未列出。

是什么驱动了此对话框中出现的存储库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:47:49.990

目前仅支持公共存储库（这可能很快会改变）。

# image-processing - 用于分类的前景对象上的边界矩形

> ID：13261216
> 
> 赞同：0
> 
> 时间：2012-11-06T23:43:44.057
> 
> 标签：image-processing, opencv, computer-vision

我有以下程序在前景对象上绘制边界框。通过测量矩形一侧的长度，该边界框将有助于按长度对对象进行分类。

现在，这只在一个实例上仅在一个对象上绘制矩形，我想让它同时绘制所有它们。但我被困住了。需要指导或帮助。请参阅所附图片。![前景蒙版！[带有边界框的原始图像](../Images/bdf58e4cd47b4da4bbc302a8e92ff585.png)

```
Rect boundingRect(InputArray contours);
    // Finds the contour with the largest area
    int area = 200;
    int idx = 0;
    for(int i=0; i<contours.size() ;i++) 
    {
        if(area < contours[i].size())
            idx = i; 
    }

    //cout<< contours.size();
    // Calculates the bounding rect of the largest area contour
    Rect rect = boundingRect(contours[idx]);
    Point pt1, pt2;
    pt1.x = rect.x;
    pt1.y = rect.y;
    pt2.x = rect.x + rect.width;
    pt2.y = rect.y + rect.height;
    cout<< idx<< "\t \t";
    // Draws the rect in the original image and show it
    rectangle(frame_Original, pt1, pt2, CV_RGB(0,0,255), 2);
    //cout << pt1; cout << pt2; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T06:09:45.207

如果要绘制所有`countours`大于的矩形`area`，则应保存索引，然后使用循环绘制所有矩形。

```
vector<int> idx;
for(int i=0; i < contours.size() ;i++)
{
    if(area < contours[i].size())
        idx.push_back(i);
}
for((int i=0; i < idx.size() ;i++)
    \\ Draw every contours[idx[i]] 
```

# git - 如何将子文件夹从一个 git repo 包含到另一个？

> ID：13261220
> 
> 赞同：1
> 
> 时间：2012-11-06T23:44:51.677
> 
> 标签：git, git-submodules, svn-externals

假设我在 git repo 中有 Project1。在 Project1 中有一个我想包含在 Project1+ 中的子文件夹（Project2、Project3 等）。“包含”并不是指复制和粘贴。我想要一个对 Project1 的引用，以便如果我对 Project1 进行更改，我可以自动将这些更改集成到 Projects1+ 中。此外，我想将它放置在 Project1+中的*多个位置。*

例子：

```
Project1
|-Subfolder1
  |-Stuff I want...
|-README.md

Project2
|-Subfolder1 <- from Project1
|-SomeOtherFolder
  |-Subfolder1 <- from Project1
|-README.md 
```

Git 子模块不起作用，因为：

*   子模块是整个仓库，而不是子文件夹。我不想要整个仓库，只想要一个文件夹。

[子树合并策略](http://www.kernel.org/pub/software/scm/git/docs/howto/using-merge-subtree.html)不起作用，因为：

*   只支持一个子树；当您对子树进行拉取（git pull -s subtree...）时，它只会更新最高级别的那个（无论它们的创建顺序如何）。

现在请记住，我是 git 新手，所以上述结论可能是错误的。但这是我通过研究和实验发现的。

我想出的可能的解决方案是：

1.  为 Project1 创建一个分支。
2.  从此分支中删除我不想要的所有内容。
3.  将我想要的文件移动到此分支的根目录。
4.  删除子文件夹。
5.  将此分支作为子模块添加到 Project1+。

这有点奏效。我修改了 Project1 主分支并能够将更改合并到新分支中，因此更新了子模块，但这似乎不必要地复杂（考虑到它在 SVN 中的简单程度）。此外，当我合并 Project1 中的更改时，它似乎认为删除的文件有冲突；即更新Project1 只是一个巨大的PITA。也许我需要不同的合并策略？

但主要是我问这甚至是正确的道路吗？

作为记录，这对于 SVN Externals 来说非常简单。所以用例就在那里。我意识到完全有可能没有人用 git 来做这件事。经过几天的研究，我可以在网上找到的解释都归结为“重组你的项目，让每个 repo 都有你想要分享的东西”；即 Project1 中的“子文件夹”成为它自己的存储库。我希望这不是最终的答案。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:31:35.490

无论如何，对于所有可能的工作流程，您必须使用 3 个存储库：Subfolder1 成为单独的存储库，您将在“superrepos”中使用它

*   我*认为*，您甚至可以使用子模块（上面的注释）
*   恕我直言（非常谦虚），[git-subtree](http://github.com/apenwarr/git-subtree)是更好的迭代，将在不久的将来完全替换 uly 子模块。[使用 git subtree 在项目之间共享代码](http://psionides.eu/2010/02/04/sharing-code-between-projects-with-git-subtree/)展示了与您的情况几乎相同的很好的用例，详细的分步说明了将单片存储库转换为由子树 2 存储库链接的命令指南，分离的存储库已准备好重新使用

# youtube-api - YouTube 分析 API 内容所有者报告 - 禁止

> ID：13261226
> 
> 赞同：2
> 
> 时间：2012-11-06T23:46:12.047
> 
> 标签：youtube-api, analytics

下午好，

我在尝试使用 YouTube 分析 API 发出内容所有者报告查询时遇到了问题。我已作为应用程序进行身份验证，并获得内容所有者（YouTube 合作伙伴）的许可，可以访问他们的 YouTube 分析数据，但在发出查询时收到 403（禁止）响应。我能够在同一个 OAUTH2 会话中对用户运行频道报告而不会出现问题。我不确定该应用程序的内容所有者权限的某些方面，并希望有人能澄清我的问题：

1) 应用程序能否访问具有 yt-analytics.readonly OAUTH 范围的合作伙伴用户的内容所有者报告，或者是否需要额外的范围？

2) 有没有办法让应用程序与合作伙伴帐户本身相关联，以便它可以代表非合作伙伴用户检索内容所有者报告？

3) 如果我在我的 CMS 中注册了多个 YouTube 频道，是否可以在单个 OAUTH 会话中查询所有频道？

以下是失败的内容所有者请求之一（没有访问令牌或用户 ID）-以防信息有用。谢谢您的帮助！

问候，

大卫

获取[https://www.googleapis.comyoutube/analytics/v1/reports?access_token=myAccessToken&start-date=1970-01-01&end-date=2012-11-01&ids=contentOwner==contentOwnerUserID&metrics=views&filters=claimedStatus==claimed](https://www.googleapis.comyoutube/analytics/v1/reports?access_token=myAccessToken&start-date=1970-01-01&end-date=2012-11-01&ids=contentOwner==contentOwnerUserID&metrics=views&filters=claimedStatus==claimed)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T14:48:41.783

关于您的具体问题：

1.  YT Analytics 只读范围应该足以同时运行内容所有者和“正常”YT Analytics 报告。没有特殊的内容所有者范围。
2.  我不确定你在这里问什么。您拥有的权限完全取决于您在通过 OAuth 2 授予访问权限时使用的帐户。这本身并不特定于应用程序。
3.  如果有多个频道的内容与单个内容所有者“父级”相关联，则使用该“父级”的凭据通过 OAuth 2 流程应该足以获取 OAuth 2 令牌，该令牌在针对任何视频运行报告时都可以使用那些频道。

我很难在不知道 contentOwnerUserID 值的情况下调试您遇到的特定问题（最好知道通过 OAuth 2 流程的内容所有者帐户的电子邮件地址）。如果您不喜欢在 Stack Overflow 上发布该内容，请直接与我联系，我将在此处跟进解决方案。

# hadoop - 大数据应用？

> ID：13261228
> 
> 赞同：-2
> 
> 时间：2012-11-06T23:46:52.220
> 
> 标签：hadoop, bigdata

所以我们很多人都在谈论大数据问题。我知道一些应用程序，例如页面排名、k-means 和其他机器学习算法以及网络索引等。

有谁知道任何其他类型的大数据应用程序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T23:50:49.027

这是一个集体智慧的时代。每天，我们创建大约 2.5 万亿字节的数据。据估计，当今世界上 90% 的数据都是在过去两年中创建的。这就是我们生成数据的速度！这类数据的新来源每天都在堆积。

这些数据来自我们每个人每天无数次离开的在线足迹、用于收集气候信息的各种传感器、我们在社交媒体网站上的帖子、我们的数字图片和视频、短信、在线销售/购买交易记录、手机 GPS 信号和每日新闻文章为数百万部手机提供服务，仅举几例。这些数据就是大数据。

但是，如果我们用纯技术术语谈论：

> 当使用我们传统的数据库管理工具存储、搜索、分析、共享等给定数量的数据变得困难时，这个庞大而复杂的数据集被称为大数据。

工业界很快意识到数据挖掘的潜力。因此，处理或分析一个组合的巨大数据集，而不是单独处理各种较小的数据集，势必会提供更多的见解/趋势/模式。例如，根据出租车公司预订出租车的历史数据，可以很可能地预测出租车应该在城市的哪个位置、哪种类型的出租车以及一天中的什么时间停放出租！

大数据很难通过传统的处理方式来处理。它可能需要在数十、数百甚至数千台服务器上运行的大规模并行软件。对于像谷歌和苹果这样的大型组织来说，建立这样的服务器集群可能是可行的，但它不适合较小的玩家。但随后商品硬件、云架构和社区驱动的开源软件的进步也将大数据处理带入了较小的范围。即使是初创公司，大数据处理也变得越来越可行，他们可以简单地在云中租用服务器时间，而不是建立自己的服务器机房等等。

大数据的进步每天都在影响着我们！无论是 Facebook 上的“好友推荐”还是 Google 上的“个性化广告”。行业在不断挖掘数据（实际上是大数据）以提供高度个性化的用户体验，同时创造一种新的广告业务，让广告商事先知道您需要购买什么！

所以你去了，很多大数据的实际例子。

资料来源：[bigdataspeak](http://bigdataspeak.com)

# java - 使用扫描仪的 Java 计算器，但控制台中未显示输出

> ID：13261229
> 
> 赞同：0
> 
> 时间：2012-11-06T23:46:55.977
> 
> 标签：java, debugging, java.util.scanner, calculator

我正在学习 Java，并且一直致力于创建一个小计算器。我正在写一个可以让我输入任意数量的数字的东西，直到我按下等号，此时我希望计算器显示总数。

我认为扫描仪有问题，因为在调试时我只能`Scanner input = new Scanner (System.in):`在调试器中说找不到源。这真的很奇怪，尤其是当我在同一个项目中使用另一个类的两个扫描仪时完全没有问题。如您所知，我曾经在这篇文章中有 2 台扫描仪，但我读到这不应该工作，所以我现在正在使用一台。这是代码...

```
package Calculator;

import java.util.Scanner;

public class Calculator3 {

    public static void main(String[] args) {

        Scanner input = new Scanner (System.in);
    //  Scanner opin = new Scanner (System.in);     
        String operative = input.next();        
        double numb = input.nextDouble();
        int answer = 0;
        int calc = 1;

        System.out.print("#######################################" + "\n");             
        while (operative.equalsIgnoreCase("="))
            {
            System.out.print("Interger " + calc + " :");
            System.out.print("Type your Operative :");
            if (operative.equals("+")) 
                answer += numb;
            {
                if (operative.equals("-")) 
                    answer -= numb;
                    {
                        if (operative.equals("/")) 
                            answer /= numb;
                            {
                                if (operative.equals("*")) 
                                    answer *= numb;
                                {
                                }
                            }
                    }
            }
        calc += 1;  
            }
        System.out.print("#######################################" + "\n");     
        System.out.println("Your answer is: " + answer + ".");
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T23:52:47.730

您的代码的问题`operative`是未更新，并且可能`=`在第一次阅读后没有更新。因此，您的循环将不会退出，并且不会到达 print 语句。按照您的逻辑，您需要在循环中添加读取语句。我还建议使用`switch`, 将使您更具可读性和易于维护。

另请注意，在调试时，对于调试器无法检测到源的类，您将得到“找不到源”。可能您的 JDK 配置缺少源条目。如果您使用的是 Eclipse，请参阅此[答案以获取有关修复 JDK 配置所需检查的详细信息。](https://stackoverflow.com/a/6203647/1613867)

# authentication - 通过 LDAP 登录用户的电子邮件地址：是否提供密码以搜索 LDAP？

> ID：13261231
> 
> 赞同：0
> 
> 时间：2012-11-06T23:47:00.553
> 
> 标签：authentication, asp-classic, vbscript, ldap, basic-authentication

我正在编写一个 VBScript 文件来获取当前登录的用户名和电子邮件地址。一些解决方案需要硬编码用户名/密码来执行 LDAP 搜索，而另一些则不需要。

每种方法的优缺点是什么？

**选项 1：没有 LDAP 用户名/密码** [源](http://ss64.com/vb/syntax-userinfo.html)

```
Set objSysInfo = CreateObject("ADSystemInfo")
Set objUser = GetObject("LDAP://" & objSysInfo.UserName) ' Currently logged in User
Response.Write("Email: " & objUser.mail) 
```

**选项 2：硬编码 LDAP 用户名/密码** [源](https://support.zendesk.com/entries/21860832-configure-zendesk-for-your-active-directory-microsoft-environment)

```
strUsername = split(Request.ServerVariables("LOGON_USER"),"\")(1)

Set rootDSE = GetObject("LDAP://RootDSE")
Set oConn = CreateObject("ADODB.Connection")

sDomainContainer = rootDSE.Get("defaultNamingContext")
oConn.Provider = "ADSDSOObject"
oConn.properties("user id") = sLdapReaderUsername
oConn.properties("password") = sLdapReaderPassword
oConn.Open "ADs Provider"

sQuery = "<LDAP://" & sDomainContainer & ">;(sAMAccountName=" & strUsername & ");adspath,mail,displayName,sAMAccountName;subtree"
Set userRS = oConn.Execute(sQuery)

If NOT userRS.EOF AND NOT err Then Response.Write(userRS("mail")) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:48:56.760

这取决于您的 LDAP 服务器的配置方式。通常它们被配置为允许匿名搜索不访问任何私有属性的用户，例如只返回没有任何属性的 DN。然后您使用该 DN 和密码“绑定”，并建立身份验证；然后您可以访问您自己（用户）的所有属性，例如“Hi Jim”等。

# iphone - Iphone 应用程序崩溃：UIKit`-[UINibDecoder validateAndIndexKeys:length:]

> ID：13261239
> 
> 赞同：3
> 
> 时间：2012-11-06T23:48:23.803
> 
> 标签：iphone, ios, xcode, uikit, uilabel

我已经对这个进行了广泛的搜索，但我不确定发生了什么。我在我的项目中添加了一个新的 ViewController 并将一个连接`UILabel`到情节提要文件并为其分配了新的自定义类。它是完全空白的，不执行任何操作，但在此行加载时崩溃：

```
UIKit`-[UINibDecoder validateAndIndexKeys:length:] 
```

我有另一个 ViewController 以完全相同的方式设置，它工作正常。我一定在这里遗漏了一些东西。我尝试清理和构建，甚至尝试完全重建，包括`UIViewController`在情节提要上删除和制作新内容。我发现一旦我`UILabel`从代码中删除它，它就可以正常加载。这是我的代码：

```
@interface GoalDetailViewController : UIViewController

@property (nonatomic, strong) IBOutlet UILabel *goalLabel;
@property (nonatomic, strong) NSString *goal;

@end

#import "GoalDetailViewController.h"

@implementation GoalDetailViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
// Do any additional setup after loading the view.

    // nameLabel.text = name;
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
} 
```

# r - data.table 中的横截面子集

> ID：13261240
> 
> 赞同：2
> 
> 时间：2012-11-06T23:48:24.623
> 
> 标签：r, data.table

我有一个包含多列的 data.table，如下所示：

```
DT <- data.table(date = as.IDate(rep(c("2012-10-17", "2012-10-18", "2012-10-19"), each=10)), 
                   session = c(1,2,3), price = c(10, 11, 12,13,14), 
                   volume = runif(30, min=10, max=1000)) 
```

我想提取一个多列表，该表显示特定类型会话中每个价格的交易量——每列代表一个日期。

目前，我使用以下方法一次提取一个数据：

```
DT[session==1,][date=="2012-10-17", sum(volume), by=price] 
```

然后绑定列。

有没有一种方法可以在不将所有单个查询粘在一起的情况下获得最终产品（每列指向特定日期的表）——就像我目前正在做的那样？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:59:54.837

以下内容是否符合您的要求。

`reshape2`和 data.table的组合

```
library(reshape2)

.DT <- DT[,sum(volume),by = list(price,date,session)][, DATE := as.character(date)]
# reshape2 for casting to wide -- it doesn't seem to like IDate columns, hence
# the character DATE co
dcast(.DT, session + price ~ DATE, value.var = 'V1')

    session price 2012-10-17 2012-10-18 2012-10-19
1        1    10   308.9528   592.7259         NA
2        1    11   649.7541         NA   816.3317
3        1    12         NA   502.2700   766.3128
4        1    13   424.8113   163.7651         NA
5        1    14   682.5043         NA   147.1439
6        2    10         NA   755.2650   998.7646
7        2    11   251.3691   695.0153         NA
8        2    12   791.6882         NA   275.4777
9        2    13         NA   111.7700   240.3329
10       2    14   230.6461   817.9438         NA
11       3    10   902.9220         NA   870.3641
12       3    11         NA   719.8441   963.1768
13       3    12   361.8612   563.9518         NA
14       3    13   393.6963         NA   718.7878
15       3    14         NA   871.4986   582.6158 
```

如果你只是想要会话 1

```
dcast(.DT[session == 1L], session + price ~ DATE)

   session price 2012-10-17 2012-10-18 2012-10-19
1        1    10   308.9528   592.7259         NA
2        1    11   649.7541         NA   816.3317
3        1    12         NA   502.2700   766.3128
4        1    13   424.8113   163.7651         NA
5        1    14   682.5043         NA   147.1439 
```

# java - 在java数组中存储时间间隔

> ID：13261241
> 
> 赞同：0
> 
> 时间：2012-11-06T23:48:24.473
> 
> 标签：java, arrays

这是我正在做的家庭作业。在我问之前，我不是在寻找一段代码。我只是想要一些帮助来找出我可能出错的地方。

作业的目标是运行一个循环 100,000 次的小程序。有 25 个间隔，每个间隔的时间需要存储在一个数组中。到目前为止，我能够让小程序正确运行和打印，但数组只存储第一个值。我在想有一个格式问题或一些小问题让我无法弄清楚这个问题，但我已经搜索了一段时间，我似乎无法弄清楚这一点。

我的代码如下：

```
 public class Line1TimedTest extends JApplet 
    {
        long start, elapsed, arrayValue;
        int x1=50, y1=50, x2=500, y2=500, limit=100000, value;
        DecimalFormat fmt;

        public void init() 
        {
    start = System.nanoTime();
    fmt = new DecimalFormat("###,###,###,###,###");
    }

    public void paint (Graphics g) 
    {
        int x, y, temp;
        float m, b;
            long [] arrayTimes = new long [25];

        for (int i = 1; i <=limit; i++) 
        {   
            m = (float)(y2-y1)/(x2-x1);
            b = y1 - m * x1;
            int value = 0;

            for (x = x1; x <= x2; x++)
            {
                y = (int)(m * x + b + 0.5);
                g.drawRect(x,y,0,0);

            }
            if (i%4000==0)
            {
                elapsed = System.nanoTime() - start;
                arrayValue = elapsed;
                arrayTimes[value] = arrayValue;
                System.out.println(fmt.format(i) + " lines drawn");
                value++;
            }

        }

    //insert print statement

     } 

} 
```

该程序编译并运行没有错误，但该数组仅在索引 0 处填充了一个值。所有其他值都是 0。如果有人可以看看我可能缺少什么，我将非常感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T23:54:11.300

`value`在每个循环中，您都用一个新整数覆盖整数。

```
arrayTimes[i%4000] = arrayValue; 
```

应该管用。

`value`或者在循环外定义整数

# objective-c - 无缝 UIWebview 背景

> ID：13261242
> 
> 赞同：0
> 
> 时间：2012-11-06T23:48:34.640
> 
> 标签：objective-c, ios, uiwebview

有没有办法摆脱 UIWebView 的边框？现在，即使我将背景设置为白色，在页面外滚动时也会看到边框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T03:58:27.910

您无法删除灰色区域，您可以禁用滚动，这似乎是最好的方法。

我们目前在 UIWebView 上设置了透明背景

```
webview.opaque = NO;
webview.backgroundColor = [UIColor clearColor]; 
```

在 HTML 中

```
<body topmargin=0 leftmargin=0 rightmargin=0 bottommargin=0style="background-color:transparent"> 
```

# javascript - 根据 HTML 中的浏览器类型确定要使用的超链接

> ID：13261243
> 
> 赞同：2
> 
> 时间：2012-11-06T23:48:34.410
> 
> 标签：javascript, html, browser, backwards-compatibility, graceful-degradation

我有一个网站，我嵌入了 lightview 以调出一个 iframe，其中包含 Google Voice 徽章。此徽章是基于 Flash 的，因此在 iOS 中看不到。为了在 iOS 中获取要拨打的电话号码，它必须具有不同的格式。

我的问题是如何向 HTML 添加逻辑以了解根据浏览器类型（移动设备与普通）选择哪种类型？

完整的浏览器支持：

```
Feel free to give me a <a class='lightview' data-lightview-type="iframe" href="pages/call.html" data-lightview-options="width: 230, height: 101">call</a>. 
```

移动浏览器支持：

```
Feel free to give me a <a href="tel:1-408-555-5555">call</a>. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T00:08:17.940

您可以尝试检测[Flash 是否可用](http://www.featureblend.com/javascript-flash-detection-library.html)，而不是检测浏览器。

您可以通过将以下代码放入HTML 文档元素中包含的 JS 脚本，将适当的`click`事件处理程序动态绑定到具有`href`属性的所有链接（`tel:`如果 Flash 可用） ：`HEAD`

```
if (FlashDetect.installed) {
    // $ means jQuery which is used to bind `click` event.
    $(document).on('click', 'A[href^="tel:"]', function() {
        // [Some specific code for Flash-enabled systems.]
    })
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:08:48.993

使用 JavaScript，您可以检查`touchstart`事件`document.documentElement`以检测触摸设备：

```
var isTouch = 'touchstart' in document.documentElement; 
```

然后在 Android 上你可以检查 userAgent 看它是否是手机：

```
var isMobile = navigator.userAgent.toLowerCase().indexOf("mobile") > -1; 
```

在 IOS 上只需检查`iPhone`：

```
var isMobile = navigator.userAgent.toLowerCase().indexOf("iphone") > -1; 
```

派对的其余部分您可以自己添加。希望你能得到图片：

```
var isTouch = 'touchstart' in document.documentElement,
    ua = navigator.userAgent.toLowerCase(),
    isMobile = isTouch ? ua.indexOf("android") > -1 ? ua.indexOf("mobile") > -1 : ua.indexOf("iphone") > -1 : false; 
```

有点复杂。

* * *

只是为了快速回答您的评论：

```
onload = function() {
    var isTouch = 'touchstart' in document.documentElement,
        ua = navigator.userAgent.toLowerCase(),
        isMobile = isTouch ? ua.indexOf("android") > -1 ? ua.indexOf("mobile") > -1 : ua.indexOf("iphone") > -1 : false;

    if ( isMobile ) {
        document.getElementById("mobileLink").style.display = 'block';
        document.getElementById("browserLink").style.display = 'none';
    }
    else {
        document.getElementById("mobileLink").style.display = 'none';
        document.getElementById("browserLink").style.display = 'block';
    }
} 
```

**还有你的 HTML：**

```
<div id="mobileLink">Feel free to give me a <a href="tel:1-408-555-5555">call</a</div>
<div id="browserLink">Feel free to give me a <a class='lightview' data-lightview-type="iframe" href="pages/call.html" data-lightview-options="width: 230, height: 101">call</a>.</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T13:47:01.127

HTML：

```
<span class="flash-enabled">Feel free to give me a <a class='lightview' data-lightview-type="iframe" href="pages/call.html" data-lightview-options="width: 230, height: 101">call</a>.</span>
<span class="flash-disabled">Feel free to give me a <a href="tel:1-408-555-5555">call</a>.</span> 
```

CSS：

```
.flash-disabled,
.flash-enabled {
    display: none;
} 
```

查询：

```
$(document).ready(function() {
    if (FlashDetect.installed) {
        $('.flash-enabled').show();
        $('.flash-disabled').remove();
    } else {
        $('.flash-disabled').show();
        $('.flash-enabled').remove();
    }
}); 
```

[FlashDetect 答案的学分来自 Marat。](https://stackoverflow.com/a/13261382/1064325)

# ant - 从 Gradle 构建文件调用 Ant jar 目标

> ID：13261246
> 
> 赞同：0
> 
> 时间：2012-11-06T23:49:05.877
> 
> 标签：ant, gradle

如何从 Gradle 构建文件中调用 Ant 目标“jar”？我尝试了很多事情都无济于事。重命名 Ant 构建文件中的“jar”目标不是一种选择。我正在将基于 Ant 的构建系统转换为 Gradle，第一步是从 Gradle 调用所有 Ant 目标。

'jar' 任务是一个默认的 Gradle 任务，所以我正在覆盖/覆盖它，但我需要调用我类似命名的 Ant 目标。

Gradle build.gradle 文件：

```
// Prevents error "Cannot add task {taskname} as a task with that name already exists"
ant.project.addTarget('clean', new org.apache.tools.ant.Target())
ant.project.addTarget('jar', new org.apache.tools.ant.Target())
ant.project.addTarget('test', new org.apache.tools.ant.Target())
ant.project.addTarget('javadoc', new org.apache.tools.ant.Target())

ant.importBuild 'build.xml'

task jar(overwrite: true) {        
    println 'jar'
}

task clean(overwrite: true) {        
    println 'clean'
}

task test(overwrite: true) {
    println 'test'
} 
```

和我的 Ant build.xml：

```
<target name='jar' description='jar'>
    <echo>Called jar task in ant build</echo>
</target> 
```

运行 Gradle v1.2

```
------------------------------------------------------------
Gradle 1.2
------------------------------------------------------------

Gradle build time: Wednesday, September 12, 2012 10:46:02 AM UTC
Groovy: 1.8.6
Ant: Apache Ant(TM) version 1.8.4 compiled on May 22 2012
Ivy: 2.2.0
JVM: 1.6.0_25 (Sun Microsystems Inc. 20.0-b11)
OS: Linux 2.6.37.6 amd64 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T02:28:47.973

Gradle 仅`jar`在您应用 Java 插件时添加一个任务，您不应该为您导入 Ant 构建的项目执行此操作。我认为您不应该`ant.project.addTarget`从 Gradle 构建脚本中调用。

# excel - Excel 查找的理想概念 - 使用高值和低值来定义属于区域的邮政编码范围

> ID：13261247
> 
> 赞同：2
> 
> 时间：2012-11-06T23:49:09.670
> 
> 标签：excel, vlookup

我有两个选项卡，一个是“销售详细信息”，其中包含一个名为“销售邮政编码”的字段。“销售区域”选项卡具有一系列邮政编码和相应的“销售区域 ID”

```
Zipcode Low        Zipcode High       Sales Territory ID

10000              19999                    15

20000              24999                    20

25000              33999                    22 
```

ETC ETC

如何根据邮政编码编写销售区域 ID 的公式？

例如

```
Zipcode  Sales Territory ID

02348        =???       

23485

23433 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:54:55.853

您可以尝试使用 a`VLOOKUP`但将`range_lookup`值设置为`TRUE`：

```
=VLOOKUP(A2,'Sales Detail'!$A$2:$C$4,3,TRUE) 
```

这假设您的`Sales Detail`数据范围从 开始`A2`。此外，您需要确保您的数据按升序排序，以便`VLOOKUP`行为正常。当您将该属性设置为 时`TRUE`，它不需要找到直接匹配项 - 它会查找仍小于目标的最大值。

此外，正如@barryhoudini 所提到的，您可以使用`LOOKUP`公式完成同样的事情，默认情况下匹配小于或等于目标的最大值。巴里公式：

```
=LOOKUP(A2,'Sales Detail'!$A$2:$C$4) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T23:56:51.260

VLOOKUP 将完全按照您的意愿行事。函数参数为`VLOOKUP( value, table_array, index_number, [not_exact_match] )`。如果为 not_exact_match 传递 TRUE（或 1），VLOOKUP 会选择小于 value 参数的最大值。

在您的情况下，请确保表格按 Zipcode Low 排序，然后您的函数是 = VLOOKUP(ZipcodeCell,$SalesTerritoryRange, 3,1)。

# php - 用于匹配字符串中的单引号单词并忽略转义的单引号的正则表达式模式

> ID：13261250
> 
> 赞同：2
> 
> 时间：2012-11-06T23:49:28.497
> 
> 标签：php, regex, preg-match

我的 PHP 代码如下所示：

```
$input = "City.name = '纽约'";
$literal_pattern = '/\'.[^\']*\'/';
preg_match($literal_pattern, $input, $token);
回声$令牌[0]；// 打印“纽约”

```

我的正则表达式需要使用转义的单引号来获取文字，例如：

```
$input = "City.name = '新\'约克'";
$literal_pattern = ?????????????;
preg_match($literal_pattern, $input, $token);
回声$令牌[0]；// 应该打印 'New \' York'

```

$literal_pattern 的规则是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T23:55:25.167

没有这个条件，简单...

```
/('[^']*')/ 
```

...当然就足够了：匹配所有“单引号，后跟任意数量的非单引号符号，再后跟单引号”的序列。

但是因为我们需要在这里为两*件事*做好准备——“正常”和“逃逸”。所以我们应该为我们的模式添加一些香料：

```
/('[^'\\]*(?:\\.[^'\\]*)*')/ 
```

它可能看起来很奇怪（确实如此），但实际上也很简单：匹配...的序列

*   单引号...
*   ...后跟零个或多个“正常”字符（不是`'`or `\`），
*   ...后跟（“转义”符号，然后是零个或多个“正常”符号）的子表达式，重复 0 次或更多次...
*   后跟一个单引号。

例子：

```
$input   = "City.name = 'New \\' York (And Some Backslash Fun)\\\\'\\'"; 
# ...as \' in any string literal will be parsed as a _single_ quote

$pattern = "/('[^'\\\\]*(?:\\\\.[^'\\\\]*)*')/";
# ... a choice: escape either slashes or single quotes; I choose the former

preg_match($pattern, $input, $token);
echo $token[0]; // 'New \' York (And Some Backslash Fun)\\' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T00:00:22.807

这是您要查找的正则表达式：`/\'(\\.|[^\'\\])*\'/`

在 PHP 中，这看起来像`$literal_pattern = '/(\'(?:\\.|[^\'\\])*\')/';`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T23:56:38.573

正则表达式是自动贪婪的，因此它会使用文字捕获尽可能多的数据。因此，如果您识别“ `'`s 之间的所有内容”，它将捕获 first 和 last 之间的任何内容`'`。

因此，您可以安全地执行此操作：

```
$literal_pattern = "#('.*')#"; 
```

*示例：http: [//ideone.com/gI5bXs](http://ideone.com/gI5bXs)*

*注意：正如[@m.buettner 所](https://stackoverflow.com/users/1633117/m-buettner)指出的，这种方法只有`'`在您的输入中有一个 -encased 字符串时才有效。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T00:15:38.840

您可以使用否定的后向匹配。[http://www.regular-expressions.info/lookaround.html](http://www.regular-expressions.info/lookaround.html)

> `(?<!a)b`匹配前面没有“a”的“b”，使用否定的lookbehind

唯一的事情是我很确定 PHP 正则表达式不支持它。如果它们受到支持，正则表达式将如下所示：

```
/(?<!\\)'(.*?)(?<!\\)'/ 
```

我的建议是使用一个简单的解析器。这是我刚想出来的东西（显然是用伪代码）：不保证它的逻辑可以满足您的目的，但实际上构建自己并不太难。

```
let inString = false
let escaping = false
let match = ''    
for each letter in string
    if letter == "\\" and not escaping
        escaping = true
    else
        if letter == "'" and not escaping
            inString = not inString
        else if inString
            match += letter
        escaping = false
return match 
```

# java - 使主要接受字符串以外的对象？

> ID：13261251
> 
> 赞同：2
> 
> 时间：2012-11-06T23:49:37.640
> 
> 标签：java

*是否可以让 main 方法接受字符串*数组以外的参数？例如，我们可以有一个类似的方法`main(Animals[]args){/*code*/}`吗？如果不是，那为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T23:50:57.090

否 - 入口点始终是带有标头的方法`public static void main(String[] args)`（即 JVM 调用此特定方法）。你当然可以定义一个方法

```
public static void main(Animals[] args) {...} 
```

但它不会在运行程序时直接执行。

* * *

***编辑***：该`main`方法特别具有字符串数组参数的原因是因为该数组将在程序运行时[包含命令行参数。](http://docs.oracle.com/javase/tutorial/essential/environment/cmdLineArgs.html)直观地说，这些应该是字符串（`Animal`例如，当然不是 s）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T23:52:43.597

因为当您从命令行输入时，您输入的是字符串，而不是复杂类型。

因此，参数是指向字符串的指针（引用）数组是有意义的，包括或不包括（取决于语言）参数的计数。在 Java 中，这不是必需的，因为您可以使用`length`.

不知道你为什么想要那个？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T23:54:07.260

[规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.1-100)说它只能处理字符串数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-07T00:45:23.777

没有什么可以阻止您拥有一个采用 String 以外的参数类型的公共静态 void main。问题是 JVM 需要简单的规则来识别和调用方法。它有一个字符串数组，例如来自命令行，可用于传递给程序。在它开始运行你的程序之前，JVM 如何将它变成一个 Animal 数组或其他类型的数组？

这是一个采用不同参数类型的 main 示例，以及处理从 JVM 拥有的字符串数组生成 Animal 数组的程序本身。当然，给第二个主要方法起一个更有意义的名字确实会更好。

```
 import java.util.Arrays;

  public class Bad {

    public static void main(String[] args) {
      Animal[] animals = new Animal[args.length];
      for (int i = 0; i < args.length; i++) {
        animals[i] = new Animal(args[i]);
      }
      main(animals);
    }

    public static void main(Animal[] args) {
      System.out.println(Arrays.asList(args));
    }

  }

  class Animal {
    String species;

    public Animal(String species) {
      this.species = species;
    }

    public String toString() {
      return "Animal: " + species;
    }
  } 
```

# java - javax.crypto.IllegalBlockSizeException：解密中的最后一个块不完整 - 解密加密的 AES 字符串

> ID：13261252
> 
> 赞同：16
> 
> 时间：2012-11-06T23:49:38.627
> 
> 标签：java, encryption, encoding, character-encoding, aes

我正在尝试解密`"~9?8?m???=?T?G"`从后端服务器收到的字符串，该服务器使用 OpenSSL 使用 AES-256-CBC 加密字符串。有代码块：

```
public static String decryptText(String textToDecrypt) {
    try {

        byte[] base64TextToDecrypt = Base64.encodeBase64(textToDecrypt.getBytes("UTF-8"));

        byte[] guid = "fjakdsjkld;asfj".getBytes("UTF-8");

        byte[] iv = new byte[16];
        System.arraycopy(guid, 0, iv, 0, guid.length);
        IvParameterSpec ips = new IvParameterSpec(iv);

        byte[] secret = DECRYPTION_SECRET_HASH.getBytes("UTF-8");
        SecretKeySpec secretKey = new SecretKeySpec(secret, "AES");

        Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
        // decryption pass
        cipher.init(Cipher.DECRYPT_MODE, secretKey, ips);
        byte[] converted = cipher.doFinal(base64TextToDecrypt);
        System.out.println(new String(converted));

    } catch (Exception e) {
        e.printStackTrace();
        Log.e(TAG, "Decipher error for " + textToDecrypt, e);
    }
    return "";
} 
```

不幸的是，当我到达

```
byte[] converted = cipher.doFinal(base64TextToDecrypt); 
```

声明抛出以下异常：

```
javax.crypto.IllegalBlockSizeException: last block incomplete in decryption 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-07T16:35:05.397

您应该在方法开始时对字符串进行*解码*，而不是对字符串的平台特定表示进行编码。

```
byte[] base64TextToDecrypt = Base64.decodeBase64(textToDecrypt); 
```

或更准确地说：

```
byte[] bytesToDecrypt = Base64(base64TextToDecrypt); 
```

如果您正确命名变量。

通常，每次您（感觉必须）使用`String.getBytes(): byte[]`方法或`String(byte[])`构造函数时，您都可能做错了什么。您应该首先考虑您正在尝试做什么，如果您*确实*需要使用它，请指定一个[字符编码。](/questions/tagged/character-encoding "显示标记为“字符编码”的问题")

 *在您的情况下，`converted`变量中的输出可能是字符编码的。因此，您可以使用以下片段：

```
String plainText = new String(converted, StandardCharsets.UTF_8);
System.out.println(plainText); 
```

而不是你现在拥有的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T00:30:16.943

所以感谢@owlstead，我能够找出解决方案。那是我犯了 Base64encoding 一个已经 Base64 编码的字符串的错误。以下是代码块。

```
public static String decryptText(String textToDecrypt) {
    try {
        byte[] decodedValue = Base64.decodeBase64(textToDecrypt.getBytes());

        byte[] iv = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
        IvParameterSpec ips = new IvParameterSpec(iv);

        byte[] input = textToDecrypt.getBytes();

        Cipher cipher = Cipher.getInstance(ENCRYPTION_METHOD);

        // decryption pass
        cipher.init(Cipher.DECRYPT_MODE, SECRET_KEY, ips);
        byte[] plainText = cipher.doFinal(decodedValue);

        return new String(plainText);
    } catch (Exception e) {
        e.printStackTrace();
        Log.e(TAG, "Decipher error for " + textToDecrypt, e);
    }

    return "";
} 
```

对应的加密是这样的

```
public static String encryptText(String textToEncrypt) {
    try {
        byte[] guid = "1234567890123456".getBytes("UTF-8");

        byte[] iv = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
        IvParameterSpec ips = new IvParameterSpec(iv);

        // The secret key from the server needs to be converted to byte array for encryption.
        byte[] secret = ENCRYPTION_SECRET_HASH.getBytes("UTF-8");

        // we generate a AES SecretKeySpec object which contains the secret key.
        // SecretKeySpec secretKey = new SecretKeySpec(secret, "AES");
        Cipher cipher = Cipher.getInstance(ENCRYPTION_METHOD);
        cipher.init(Cipher.ENCRYPT_MODE, SECRET_KEY, ips);

        byte[] cipherText = cipher.doFinal(textToEncrypt.getBytes());
        byte[] base64encodedSecretData = Base64.encodeBase64(cipherText);
        String secretString = new String(base64encodedSecretData);
        return secretString;
    } catch (Exception e) {
        e.printStackTrace();
        Log.e(TAG, "Encryption error for " + textToEncrypt, e);
    }
    return "";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-15T07:20:32.227

在加密和解密字符串时请记住以下事项，

加密：

1.  使用 toByteArray(Charsets.UTF-8) 将字符串转换为 byteArray，并始终使用 UTF-8 指定字符集。

2.  使用 cipher.doFinal(byteArray) 对上述 byteArray 进行加密。

3.  现在这还不够，您需要使用 Base64.encode(encryptedByteArray, Base64.DEFAULT) 对加密的 byteArray 进行 base64 编码

4.  请记住，这再次返回 byteArray ，如果要转换为字符串，请使用 toString(Charsets.UTF-8) 并且最重要的是再次将字符集指定为 UTF-8，然后根据需要处理或存储在 DB 中。

解密：

1.获取加密字符串，解密的第一步是使用base64.decode(encryptedString.toByteArray(Charsets.UTF-8), Base64.DEFAULT)对加密字符串进行解码

2.  现在使用 cipher.dofinal(decodedByteArray) 解密解码后的 byteArray。

3.  使用 toString(Charsets.UTF-8) 将 Decrypted byteArray 转换为 String。注意：始终指定字符集。这将返回原始字符串。

我知道我没有共享任何代码，但相信我，流程是加密和解密字符串时的重要部分..*

# java - Apache POI表`getMergedRegion`中的参数`index`是什么意思？

> ID：13261256
> 
> 赞同：7
> 
> 时间：2012-11-06T23:50:44.543
> 
> 标签：java, apache-poi

是什么`index`意思`getMergedRegion`？

Apache 的[HSSFSheet 文档](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFSheet.html#getMergedRegion%28int%29)没有明确描述`index`参数的含义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T00:19:52.527

要回答这个问题，我们首先定义一个`MergedRegion`.

A`MergedRegion`本质上是一组可以作为一个单元的单元组合在一起。这是使用可以跨越数字或行或列的[CellAdress创建的。](http://poi.apache.org/apidocs/org/apache/poi/ss/util/CellRangeAddress.html)

A`HSSFSheet`可以包含由[getNumMergedRegions](http://poi.apache.org/apidocs/org/apache/poi/ss/usermodel/Sheet.html#getNumMergedRegions%28%29)`MergedRegions`给出的其中一些。

索引指的`MergedRegion`是`HSSFSheet`in`Sheet`对象支持中的 in `MergedCellsTable`，它本质上是一个`ArrayList`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T00:20:52.607

从可在此处下载的免费源[http://poi.apache.org/download.html](http://poi.apache.org/download.html)我们有...

```
/**
 * @return the merged region at the specified index
 */
public CellRangeAddress getMergedRegion(int index) {
    return _sheet.getMergedRegionAt(index);
} 
```

当我们深入研究时，`getMergedRegionAt`我们发现

```
public CellRangeAddress getMergedRegionAt(int index) {
    //safety checks
    MergedCellsTable mrt = getMergedRecords();
    if (index >=  mrt.getNumberOfMergedRegions()) {
        return null;
    }
    return mrt.get(index);
} 
```

在这里我们可以看到有一个`MergedCellsTable`this 表示每个工作表都有一个数据结构，该结构维护工作表中合并单元格的列表。

通过查看代码，索引引用了特定的**MergedRegion**，其**CellRangeAddress**在具有许多区域的上下文中是必需的。

您可以将其记录为文档错误或提交补丁以改进 JavaDoc。

# python - 请求使用 Python 中的另一个衬垫

> ID：13261264
> 
> 赞同：-4
> 
> 时间：2012-11-06T23:51:27.013
> 
> 标签：python, append

你们能想到任何一个等于 if/else 语句的衬里吗：

```
d = dict()

key = 1, 2

if key in d:
    d[key]['idx'] += [2]
else:
    d[key] = {'idx': [2]}

print d 
```

?

编辑：谢谢大家。您将我缩小到 collection.defaultdict 和 dict.setdafault 并考虑到这一点，我能够实现我想要的：

```
from collections import defaultdict

d = dict()
key = 1, 2
d.setdefault(key, {'idx': []})
d[key]['idx'] += [2] 
```

也许它不是一个衬里，因为它分布在 2 行上（setdefault() 调用，然后就地添加），但看起来更好。

但是，如果有人有任何想法如何使它成为真正的一个班轮，请分享它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T00:06:37.797

有时最好在多行中做事，这就是其中一种情况。但是，有时尝试避免这种“此键是否存在”逻辑是合理的，为此您可以使用[collections.defaultdict](http://docs.python.org/2/library/collections.html#collections.defaultdict)或[`dict.setdefault()`](http://docs.python.org/2/library/stdtypes.html#dict.setdefault). 现在只是为了好玩，这是一个你不应该使用的可怕的单行代码（但在行为上等同于你的 if/else）：

```
d.setdefault(key, {'idx': []})['idx'] += [2] if d[key]['idx'] else [1] 
```

请注意，这比您的原始版本效率低，因为它需要额外的查找，并且每次使用它时都会创建不必要的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T01:55:40.740

也许：

```
d = dict()
key = 1,2

d[key] = (d[key]['idx'] + [2] if key in d and 'idx' in d[key] else {'idx': [2]}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T02:48:36.693

```
key=1,2
d={key:'idx'}
d[key]['idx'] = d[key]['idx']+[2] if key in d else ['2'] 
```

# vb.net - 在 VBA 中达到内存限制，Visual Studio VB 会更好吗？

> ID：13261266
> 
> 赞同：0
> 
> 时间：2012-11-06T23:51:40.310
> 
> 标签：vb.net, vba, memory

Excel VBA 中的用户窗体今天开始达到 64 kB 的内存限制。我预计这个界面至少会增长 10-15%，并且现在可以很容易地看到它越来越大。VB6 听起来会更好，但我读到它也有 64 kB 相同类型的内存限制。

我坚持使用 Visual Basic，因为该项目的其他工作人员不懂 C++ 或任何其他语言。除了压缩表单控件之外还有什么快速的建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:15:37.650

我刚刚写了以下简单的测试......

```
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    Try
        While True
            Dim B As New Button
            Me.Controls.Add(B)
            Me.Text = String.Format("Controls: {0}", Me.Controls.Count)
        End While
    Catch ex As Exception
        Me.Text = ex.Message
    End Try
End Sub 
```

它开始出现约 4,000 个控件的问题。我怀疑这是由于我使用的笔记本电脑的内存限制所致。

# ios - UIToolbar 不显示

> ID：13261267
> 
> 赞同：0
> 
> 时间：2012-11-06T23:51:41.457
> 
> 标签：ios, keyboard, hidden, uitoolbar

我希望 a`UIToolbar`在单击某个 时显示`UITextField`，但是在 中定义的工具栏`@interface`没有显示。这是我用于初始化并将其附加到文本字段的代码：

```
toolbar = [[UIToolbar alloc]initWithFrame:CGRectMake(0, 0, 320, 50)];
toolbar.barStyle = UIBarStyleBlackTranslucent;
toolbar.items = [NSArray arrayWithObjects:[[UIBarButtonItem alloc]initWithTitle:@"Done" style:UIBarButtonItemStyleBordered target:self action:@selector(isDone:)], nil];
toolbar.hidden = NO;
[toolbar sizeToFit];

angleField.inputAccessoryView = toolbar; 
```

有人可以看到我做错了什么吗？

PS 我在另一个项目中使用过类似的代码，并且它有效。这是代码：

```
 UIToolbar* numberToolbar = [[UIToolbar alloc]initWithFrame:CGRectMake(0, 0, 320, 50)];
numberToolbar.barStyle = UIBarStyleBlackTranslucent;
numberToolbar.items = [NSArray arrayWithObjects:
                       [[UIBarButtonItem alloc]initWithTitle:@"Clear" style:UIBarButtonItemStyleBordered target:self action:@selector(cancelNumberPad:)],
                       [[UIBarButtonItem alloc]initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil],
                       [[UIBarButtonItem alloc]initWithTitle:@"Done" style:UIBarButtonItemStyleDone target:self action:@selector(doneWithNumberPad:)],
                       nil];
[numberToolbar sizeToFit];
changes.inputAccessoryView = numberToolbar; 
```

哪里`changes`是`UITextField`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T17:58:29.073

我不确定是不是这样，但我所做的不是`setItems:`在工具栏上调用，而是调用`setItems:animated:`，现在它可以工作了......

感谢所有回复并花时间尝试帮助我的人。快乐编码！

# javascript - 使用键盘箭头使用three.js 进行第一人称模拟

> ID：13261270
> 
> 赞同：9
> 
> 时间：2012-11-06T23:52:16.923
> 
> 标签：javascript, canvas, webgl, three.js

### *对于我的来源，请访问[http://jsfiddle.net/fYtwf/](http://jsfiddle.net/fYtwf/)*

## 背景

我有一个使用three.js 的简单3d 模拟，其中相机被立方体包围在3 维中。在对视图控件进行编码和测试之前，这些立方体将帮助可视化相机正在查看的位置。我想创建一个简单的 3D 应用程序，通过**up**、**down**、**left**和**right**键控制相机。就像移动你的头一样

## 问题

在我当前的应用程序中，当面向前方并开始向上看时，我们是成功的。但是，当我们向左转 90 度并按下向上箭头时……错误的事情发生了。相机增加 x 轴，但因为我们面向另一个方向，单独修改 x 轴是错误的......

现在我假设这是因为需要一些三角函数来计算 z 轴的正确值。但是，我的三角并不出色。

## 当前的

为了更好地理解我的意思，请访问我的 jsfiddle：http: [//jsfiddle.net/fYtwf/](http://jsfiddle.net/fYtwf/)

**UP**键仅增加 X

**DOWN**键仅递减 X

**LEFT**键仅增加 Y

**RIGHT**键仅递减 Y

**Q**键仅增加 Z

**W**键仅递减 Z

*（ Q 和 W 只是为了帮助我理解而编码。）*

根据我目前的理解，当我按下 UP 键时，X 必须递增，Z 轴必须根据当前的 Y 轴进行修改。但是我不知道算法:(

所以必须在KEYUP代码中修改X和Z（我认为，如果我错了，请纠正我）

```
// setRotateX, getRotateX, setRotateY and getRotateY are extended
// camera functions I wrote so I could work with degrees. Solution
// IS NOT required to use them, they just helped me

switch( key )
{
    case KEYUP:
        if ( camera.getRotateX() < 90 ){ // restrict so they cannot look overhead
            camera.setRotateX( camera.getRotateX() + VIEW_INCREMENT );
        }
        break;

    case KEYDOWN:
        if ( camera.getRotateX() > -90 ){ // restrict so they cannot look under feet
            camera.setRotateX( camera.getRotateX() - VIEW_INCREMENT );
        }
        break;

    case KEYLEFT:
        camera.setRotateY( camera.getRotateY() + VIEW_INCREMENT );
        break;

    case KEYRIGHT:
        camera.setRotateY( camera.getRotateY() - VIEW_INCREMENT );
        break;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T03:12:09.650

这个问题有很多解决方案，但是由于您只希望相机上下左右旋转，因此这种情况下的答案很简单。

您只需将相机*欧拉顺序*设置为“YXZ”，如下所示：

```
camera.rotation.order = "YXZ"; // three.js r.65 
```

如果你这样做，一切都会变得非常直观。

这是一个更新的小提琴： http: [//jsfiddle.net/fYtwf/3/](http://jsfiddle.net/fYtwf/3/)（但是这个演示使用的是 r.54）

一旦你改变`camera.rotation.z`它的默认值`zero`，事情就会变得非常混乱。所以不要那样做。:-)

三.js r.65

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T07:14:05.617

虽然这不会直接修复您的代码，但我想我会提到 Three.js 提供了两个现成的控制器来在 FPS 模式下导航。它们都使用鼠标进行查看并且可以移动，但应该相当简单地适应键盘外观并在需要时移除移动。他们是：

*   [`FirstPersonControls`](https://github.com/mrdoob/three.js/blob/master/examples/js/controls/FirstPersonControls.js)
*   [`PointerLockControls`](https://github.com/mrdoob/three.js/blob/master/examples/js/controls/PointerLockControls.js)

我推荐后者作为起点，因为它相当简单，而前者令人困惑地具有两次外观代码，可能是旧功能的产物。

# xss - HTML Purifier - 更改默认允许的 HTML 标签配置

> ID：13261271
> 
> 赞同：5
> 
> 时间：2012-11-06T23:52:17.447
> 
> 标签：xss, htmlpurifier

我想允许用户可以在我的论坛中使用的**有限的 HTML 标签白名单。**所以我已经像这样配置了 HTML Purifier：

```
$config = HTMLPurifier_Config::createDefault();
$config->set('HTML.Allowed', 'p,a[href|rel|target|title],img[src],span[style],strong,em,ul,ol,li');
$purifier = new HTMLPurifier($config); 
```

我想知道的是，HTML Purifier 的默认配置是否仍然适用，除了接受的 HTML 标签数量减少，*还是*我需要手动重新设置每个可能的配置参数？

此外，我应该以任何方式调整默认配置以保持安全吗？我是整个 XSS 保护的新手，是 HTML Purifier 的新手，并没有发现手册提供了很多“基本”提示和提示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T05:58:33.503

默认情况下，HTML Purifier 是安全的，您通过更改 %HTML.Allowed 对其施加的任何限制只能保证减少允许的标记集。查看[http://htmlpurifier.org/live/smoketests/printDefinition.php](http://htmlpurifier.org/live/smoketests/printDefinition.php)以了解调整配置如何更改允许的标签集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:05:10.280

为什么不直接使用 DOM 解析器并检查标签类型是否在允许的 HTML 标签白名单中？

将输入转换为 DOM 节点列表，您应该能够遍历所有 DOM 节点并检查是否允许该类型。php.net 有很好的例子来说明如何做到这一点，这些例子是由其他人写的，比如你试图解决输入清理问题。

更多信息在这里： http: [//php.net/manual/en/class.domdocument.php](http://php.net/manual/en/class.domdocument.php)

# iphone - 子视图随机改变位置 40 像素？

> ID：13261276
> 
> 赞同：0
> 
> 时间：2012-11-06T23:52:53.430
> 
> 标签：iphone, xcode, uiview, constraints

我有一个覆盖 iphone 5 的全屏的子视图，每当我突然构建和运行时，它的框架是 (0,-40,320,586) 而不是 (0,0,320,586)。所以它喜欢向上移动。现在我在文件检查器中取消选中“使用自动布局”。这摆脱了所有那些我不明白它们在做什么的烦人的约束。

每当我检查启用约束的“使用自动布局”时，我注意到这解决了问题，并且子视图不会随机向上移动 40 像素。

但是，我无法保持这些约束，因为我使用子视图制作动画，只要启用约束，这些动画就不起作用。

我能做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:00:45.283

如果您在任何时候使用自动布局，[请阅读并了解自动布局系统和约束](https://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/AutolayoutPG/Articles/Introduction.html)。如果您不想这样做，请将其关闭并且不要使用它。

在您的情况下，如果您想为单个视图摆脱它，也许从该视图中删除所有约束就足够了。可以这样做： `[view removeConstraints:view.constraints]`.

[自动布局参考](https://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/AutolayoutPG/Articles/Introduction.html)。

# linux - 杀死进程和所有后代的安全方法

> ID：13261277
> 
> 赞同：2
> 
> 时间：2012-11-06T23:53:16.500
> 
> 标签：linux, security, ubuntu, kernel, kill

我正在使用[apparmor](http://manpages.ubuntu.com/manpages/precise/man2/aa_change_profile.2.html)、[setrlimit](http://manpages.ubuntu.com/manpages/precise/man2/setrlimit.2.html)、[cap_set_rpoc](http://manpages.ubuntu.com/manpages/precise/man3/cap_set_proc.3.html)在 Linux 中创建一个沙盒环境，让匿名用户基本上在我的服务器上在科学应用程序的上下文中执行一些任意代码。沙盒中特别允许的一件事是通过分叉和调用可执行文件来启动新进程（尽管一个用户的进程总数受限于`RLIMIT_NPROC`）。

在给定的时间段之后，比如 1 分钟，系统将杀死主进程，以及所有潜在的子进程。我目前依靠进程组 id 来识别孩子。但是，理论上，子进程可以调用以更改其进程组，这样当我调用主进程 id`setpgid`时它将不再受到影响（对吗？）。`kill(-1 * pid)`不幸的是，我无法设置 linux`capability`来阻止进程调用`setpgid`.

什么是杀死进程及其所有（递归）子进程的稳健方法，这将使子进程很难以某种方式“逃脱”屠杀并继续作为孤儿进程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:53:35.723

如果你使用[lxc](http://lxc.sourceforge.net/)（Linux 容器）来隔离每个进程树，那么你可以使用`lxc-stop`来杀死一个容器中的所有进程。[请参阅lxc 手册页](http://lxc.sourceforge.net/man/lxc.html)的“启动/停止容器”部分。

# validation - 如果验证失败，CodeIgniter 会取回值

> ID：13261280
> 
> 赞同：0
> 
> 时间：2012-11-06T23:53:30.367
> 
> 标签：validation, codeigniter

我是codeigniter的新手，我有一个问题。我有一个带有验证的表单并且工作正常，但是如果我在一个字段中输入数据并将其余部分留空，验证将向我显示错误并清除已输入的数据....我该如何解决这个问题?

这是我的控制器代码：

```
function submitclub()
    {

        $this->form_validation->set_rules('lastname', 'Last Name', 'required');
        $this->form_validation->set_rules('firstname', 'First Name', 'required');
        if ($this->form_validation->run() == FALSE)
        {
            $dataclub['clubname'] = $this->club_model->get(0, FALSE);
            $dataclub['division'] = $this->division_model->get(0, FALSE);
            $data['reset'] = TRUE;
            $view = 'individual/individual_view';
        } 
```

任何帮助都会非常感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:19:45.207

在我看来，这样做解决了这个问题：

```
<?php echo form_input('lastname', set_value('lastname'), 'id=lastname'); ?>
<?php echo form_error('lastname'); ?> 
```

# mysql - mysql得到完全加入的相反结果

> ID：13261282
> 
> 赞同：0
> 
> 时间：2012-11-06T23:53:45.553
> 
> 标签：mysql, join

这个查询给了我想要的结果，而且效果很好。

```
 SELECT * 
        FROM npc5 
        FULL JOIN joeall ON merchnumber = joeall.id 
        WHERE date='$period' 
        ORDER BY DATE"); 
```

现在我想获取商家编号不在`joeall`表中的记录，例如`ON merchnumber != joeall.id`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:14:04.517

排除在 NOT IN 的 SELECT STATEMENT 中找到的任何 id

```
$query1 = mysql_query("
    SELECT * 
    FROM npc5 
    WHERE date='$period' 
    AND merchnumber NOT IN (SELECT id FROM joeall)
    ORDER BY DATE"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:14:36.237

确保你有一个多字段索引`date`并`merchnumber`保持你的速度。

```
 SELECT * 
    FROM npc5 
    WHERE date='$period' 
    AND merchnumber NOT IN (SELECT id FROM JOEALL)
    ORDER BY DATE 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T00:51:36.003

相关子查询可能非常低效，应尽可能避免。

因此我不建议你这样做

```
SELECT * 
FROM npc5 
WHERE date='$period' 
AND merchnumber NOT IN (SELECT id FROM JOEALL)
ORDER BY DATE 
```

看看[http://devzone.advantagedatabase.com/dz/content.aspx?Key=42&ID=75](http://devzone.advantagedatabase.com/dz/content.aspx?Key=42&ID=75)

我建议您将其更改为类似

```
SELECT 
    * 
FROM npc5 LEFT JOIN JOEALL on 
    npc5.merchnumber = joeall.id 
WHERE 
    joeall.id is null 
        and 
    date='$period'
ORDER BY
    date; 
```

问候

# cocos2d-iphone - 复杂的节点坐标层次结构碰撞检测

> ID：13261283
> 
> 赞同：0
> 
> 时间：2012-11-06T23:53:51.910
> 
> 标签：cocos2d-iphone, collision-detection

我在让两个“hitbox”位于同一平面或类似平面上时遇到问题。我知道答案在 convertToNodeSpace 或 convertToWorldSpace 方法的某个地方，但是尽管查看了 API 和一些示例并尝试了一些东西，但我仍然不确定如何最好地更改我的 Node/Worldspace 以获得正确的比较

我的层次结构如下。我想比较两个boundingBox数量

```
SCENE
   -GameLayer
      -HeroCharacter
         -Sprite
            -boundingBox
      -WorldLayer
         -EnemyCharacter
            -EnemySprite
               -boundingBox 
```

让我感到震惊的是，让 WorldLayer 成为 SCENE 的孩子可能要简单得多，我会尝试这样做 - 但我仍然想知道如何比较这两个数量

**编辑：**事实证明，在同一级别上制作 GameLayer 和 WorldLayer 要容易得多。我的碰撞现在按预期工作-但是我仍然想知道如何使其他版本仅用于我自己的教育

**编辑编辑：** 我现在得出的结论是，我确实需要了解这是如何工作的，因为我正在寻找相互竞争的信息并遇到非常复杂的父子碰撞和放置问题。任何资源都很棒。API并没有真正帮助我

# javascript - Javascript函数返回未定义

> ID：13261288
> 
> 赞同：0
> 
> 时间：2012-11-06T23:54:38.140
> 
> 标签：javascript, function

我有四个函数可以处理我的应用程序的某个部分以获取照片 url。

在函数 handleGetPhotoResponse 中，警报中有我的网址，一切看起来都应该如此。

问题出在函数 handleGetUsersFurKidsResponse 中。变量“fkimg”未定义。谁能告诉我哪里出错了？

为了使用应用程序的这一部分，我调用了“getUsersFurKids”。

```
function handleGetPhotoResponse(responseText, size) {
    var photoDetails = JSON.parse(responseText);
    var thePhoto = photoDetails[size];
    alert(thePhoto);
    return thePhoto;
}

function getPhoto(id, size) {
    var url = "url-removed"+id;
    var request = new XMLHttpRequest();
    //Send the proper header information along with the request
    request.open("GET", url);
    request.onload = function() {
        if (request.status == 200) {
            return handleGetPhotoResponse(request.responseText, size);
        }
    };
    request.send(null);
}

// function to handle the response of getting a users fur kids
function handleGetUsersFurKidsResponse(responseText) {
    var ul = document.getElementById("furKidList");
    var furKids = JSON.parse(responseText);
    for(var i = 0; i<furKids.length; i++){
        var li = document.createElement("li");
        var fkimg = getPhoto(furKids[i].ui_id, 'small');
        li.innerHTML = "<a href=\"\"><img src=\""+fkimg+"\"> "+furKids[i].p_name;
        ul.appendChild(li);
    }
}

// function to get a users fur kids
function getUsersFurKids(id) {
    // api url for getting fur kids
    var url = "url-removed"+id;
    var request = new XMLHttpRequest();
    //Send the proper header information along with the request
    request.open("GET", url);
    request.onload = function() {
        if (request.status == 200) {
            handleGetUsersFurKidsResponse(request.responseText);
        }
    };
    request.send(null);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:58:29.910

```
 // receive a callback---v
function getPhoto(furKid, size, callback) {
         //         ^---and the current furKid

        // use the ui_id------------v
    var url = "url-removed" + furKid.ui_id;
    var request = new XMLHttpRequest();

    request.open("GET", url);
    request.onload = function() {
        if (request.status == 200) {

         // Invoke the callback, and pass it the result of handleGetPhotoResponse
            callback(handleGetPhotoResponse(request.responseText, size), furKid.p_name);
                     // use the p_name-----------------------------------------^
        }
    };
    request.send(null);
}

function handleGetUsersFurKidsResponse(responseText) {
    var ul = document.getElementById("furKidList");
    var furKids = JSON.parse(responseText);
    for(var i = 0; i<furKids.length; i++){

            // pass a callback-----------------v
        getPhoto(furKids[i], 'small', function(fkimg, p_name) {
            var li = document.createElement("li");
            li.innerHTML = "<a href=\"\"><img src=\""+fkimg+"\"> "+ p_name;
            ul.appendChild(li);
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T23:59:29.337

您似乎不明白 getPhotos 是一个异步函数。它内部的 onload 处理程序会在 getPhoto 函数本身返回并完成后很长时间后调用。因此，您不能从 getPhoto 返回在 onload 中检索到的值。

相反，您必须将需要使用来自 getPhoto 的 onload 响应的所有代码放入 onload 处理程序本身（或从 onload 处理程序内部调用），因为只有在调用 onload 处理程序时才知道该数据。

这就是异步编程在 javsacript 中的工作方式。

向 getPhoto 添加一个回调并从 onload 处理程序内部调用该回调，将您从异步调用中获得的 img 传递给它。然后，只有这样，您才能使用该 img 数据。

# codeigniter - 如何在应用程序目录之外调用我的 codeigniter 模型或控制器？

> ID：13261295
> 
> 赞同：0
> 
> 时间：2012-11-06T23:55:13.147
> 
> 标签：codeigniter, activerecord

我有以下疑问：

我在使用 Flash 的 codeigniter 中有我的项目。其结构如下：

```
name_proyect
      application /
             controller /
             model /
             view /
      audiofiles/
            //Here are being saved all audios.
      user_guide /
      flash /
            archivos.swf
            save_audio.php
      system /
      index.php 
```

闪存使用**save_audio.php**文件，该文件将音频保存在我的服务器上。但是，当我在服务器上保存物理文件时，还需要将文件路径保存在与用户关联的数据库中。

我的问题是，我可以使用 codeigniter **save_audio.php**文件中的活动记录吗？o 我可以在我的项目中使用我的模型或控制器来保存到数据库吗？

***注意：*** `save_audio.php`是一个简单的脚本（不是一个类）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T07:23:55.970

将 的当前内容移动`save_audio.php`到 CI 控制器中。如果可以，请编辑 flash 文件，以便将文件/请求发送到新位置。

如果您无法更新 flash 文件，请移除`save_audio.php`CI 将接收请求，并使用路由配置将路径路由到 CI 内的新控制器。在这种情况下，你最终会是这样的：

**application/controllers/upload.php** - 新创建的控制器

```
class Upload extends CI_Controller {
    public function handle_audiofile() {
        // the original content of the save_audio.php comes here.
        // might need to update some superglobal usage
    }
} 
```

**应用程序/config/routes.php**

```
$route['application/flash/save_audio.php'] = 'upload/handle_audiofile'; 
```

# c# - DataContext.Submit 和 TransactionScope

> ID：13261299
> 
> 赞同：0
> 
> 时间：2012-11-06T23:55:47.643
> 
> 标签：c#, linq-to-sql, datacontext, transactionscope, submitchanges

请在下面解释我的伪代码。

我的想法是：第三次 SubmitChanges 将提交 o.Status 而不会提交 o.TransactionId，并且我的对象将在数据库中损坏（我的意思是它不再一致）。

```
XDataContext DB = .....; 
XOrder o = DB.XOrders.Single(.......);

try
{
    using (var t = new TransactionScope())
    {
        o.Status = XOrderStatus.Completed;
        DB.SubmitChanges(); // 1
        string s = null;
        s.Trim(); // crash here;
        o.TransactionId = ......; // some calculations here
        DB.SubmitChanges(); // 2
        t.Complete();
    }
}
catch (Exception ex)
{
    XEvent e = new XEvent();
    e.Type = XEventType.Exception;
    e.Data = .........; // some calculations here
    DB.XEvents.InsertOnSubmit(e);
    DB.SubmitChanges(); // 3
} 
```

我的案例有什么“最佳实践”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T16:48:32.847

> 我的案例有什么“最佳实践”吗？

是的。每个工作单元使用一个 DataContext 实例。

```
catch (Exception ex)
{
    XEvent e = new XEvent();
    e.Type = XEventType.Exception;
    e.Data = .........; // some calculations here
   using (XDataContext dc2 = new XDataContext())
   {
    dc2.XEvents.InsertOnSubmit(e);
    dc2.SubmitChanges(); // 3
   }
} 
```

# c# - 在运行代码之前，可以在锁之前和内部“仔细检查”吗？

> ID：13261300
> 
> 赞同：10
> 
> 时间：2012-11-06T23:55:51.447
> 
> 标签：c#, multithreading, thread-safety

在使用线程安全时，我发现自己在执行锁定块中的代码之前总是“双重检查”，我想知道我是否做对了。考虑以下三种方法来做同样的事情：

示例 1：

```
private static SomeCollection MyCollection;
private static Object locker;
private void DoSomething(string key)
{
    if(MyCollection[key] == null)
    {
         lock(locker)
         {
              MyCollection[key] = DoSomethingExpensive(); 
         }
    }
    DoSomethingWithResult(MyCollection[key]);
} 
```

示例 2：

```
private static SomeCollection MyCollection;
private static Object locker;
private void DoSomething(string key)
{
    lock(locker)
    {
         if(MyCollection[key] == null)
         {
              MyCollection[key] = DoSomethingExpensive(); 
         }
    }
    DoSomethingWithResult(MyCollection[key]);
} 
```

示例 3：

```
private static SomeCollection MyCollection;
private static Object locker;
private void DoSomething(string key)
{
    if(MyCollection[key] == null)
    {
        lock(locker)
        {
             if(MyCollection[key] == null)
             {
                  MyCollection[key] = DoSomethingExpensive(); 
             }
        }
    }
    DoSomethingWithResult(MyCollection[key]);
} 
```

我总是倾向于示例 3，这就是为什么我认为我在做正确的事情

*   线程 1 进入`DoSomething(string)`
*   `MyCollection[key] == null`所以线程 1 获得了锁，就像线程 2 进入一样
*   `MyCollection[key] == null`仍然为真，所以线程 2 等待获取锁
*   线程 1 计算值`MyCollection[key]`并将其添加到集合中
*   线程 1 释放锁并调用`DoSomethingWithResult(MyCollection[key]);`
*   线程 2 获得锁，此时`MyCollection[key] != null`
*   线程 2 什么也不做，释放锁并继续其愉快的方式

示例 1 可行，但线程 2 可能会冗余计算`MyCollection[key]`.

示例 2 可以工作，但每个线程都会获得一个锁，即使它不需要 - 这可能是一个（诚然非常小的）瓶颈。如果不需要，为什么要挂起线程？

我是否过度考虑了这一点，如果是这样，处理这些情况的首选方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T00:17:46.590

不应该使用第一种方法。正如您所意识到的，它会泄漏，因此最终可能会有多个线程运行这种昂贵的方法。该方法花费的时间越长，另一个线程也将运行它的风险就越大。在大多数情况下，这只是一个性能问题，但在某些情况下，结果数据后来被一组新数据替换也可能是一个问题。

第二种方法是最常用的方法，如果数据访问如此频繁以至于锁定成为性能问题，则使用第三种方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-07T01:35:29.087

我将介绍某种不确定性，因为这个问题并非微不足道。基本上我同意 Guffa 的观点，我会选择第二个例子。这是因为第一个被破坏了，而第三个又被破坏了，尽管事实似乎是优化的，但很棘手。这就是为什么我将在这里专注于第三个：

```
if (item == null)
{
    lock (_locker)
    {
        if (item == null)
            item = new Something();
    }
} 
```

乍一看，它可能会在不一直锁定的情况下提高性能，但也存在问题，因为内存模型（读取可能会重新排序以在写入之前进行）或激进的编译器优化（[参考](http://blogs.msdn.com/bali_msft/archive/2008/09/15/how-to-utilize-double-check-locking-in-c-correctly.aspx)），例如：

1.  线程**A**注意到该值`item`没有被初始化，因此它获得了锁并开始初始化该值。
2.  **由于内存模型、编译器优化等原因，允许编译器生成的代码在A**完成初始化之前更新共享变量以指向部分构造的对象。
3.  线程**B**注意到共享变量已被初始化（或者看起来如此），并返回它的值。因为线程**B**认为该值已经初始化，所以它不会获取锁。**如果在A**完成初始化之前使用该变量，程序可能会崩溃。

有解决该问题的方法：

1.  您可以将其定义`item`为 volatile 变量，以确保读取变量始终是最新的。Volatile 用于在变量的读取和写入之间创建内存屏障。

    （请参阅[.NET 中双重检查锁定中对 volatile 修饰符的需求](https://stackoverflow.com/questions/1964731/the-need-for-volatile-modifier-in-double-checked-locking-in-net)和[在 C# 中实现单例模式](http://csharpindepth.com/Articles/General/Singleton.aspx)）

2.  您可以使用`MemoryBarrier`（`item`非易失性）：

    ```
    if (item == null)
    {
        lock (_locker)
        {
            if (item == null)
            {
                var temp = new Something();
                // Insure all writes used to construct new value have been flushed.
                System.Threading.Thread.MemoryBarrier();                     
                item = temp;
            }
        }
    } 
    ```

    执行当前线程的处理器不能以这样一种方式重新排序指令，即在调用之前的内存访问在调用`MemoryBarrier`之后的内存访问之后执行`MemoryBarrier`。

    （请参阅[Thread.MemoryBarrier 方法](http://msdn.microsoft.com/en-us/library/system.threading.thread.memorybarrier.aspx)和本[主题](http://blogs.msdn.com/brada/archive/2004/05/12/volatile-and-memorybarrier.aspx)）

**更新：**双重检查锁定，如果正确实施，似乎在 C# 中工作正常。有关更多详细信息，请查看其他参考资料，例如[MSDN](http://msdn.microsoft.com/en-us/library/ff650316.aspx)、[MSDN 杂志](http://msdn.microsoft.com/en-us/magazine/cc163715.aspx)和[此答案](https://stackoverflow.com/a/394932/270315)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-07T00:33:18.947

我建议你把这个问题留给专业人士并使用[ConcurrentDictionary](http://msdn.microsoft.com/en-us/library/dd287191.aspx)（我知道我会的）。它具有[GetOrAdd 方法](http://msdn.microsoft.com/en-us/library/ee378677.aspx)，该方法完全符合您的要求，并保证正常工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-22T20:12:52.957

可以使用多种模式来创建惰性对象，这正是您的代码示例所关注的内容。如果您的集合类似于数组，或者`ConcurrentDictionary`允许代码自动检查值是否已设置并仅在未设置时才写入，则另一种有时可能有用的变体是：

```
Thing theThing = myArray[index];
if (theThing == null) // Doesn't look like it's created yet
{
  Thing tempThing = new DummyThing(); // Cheap
  lock(tempThing) // Note that the lock surrounds the CompareExchange *and* initialization
  {
    theThing = System.Threading.Interlocked.CompareExchange
       (ref myArray[index], tempThing, null);
    if (theThing == null)
    {
      theThing = new RealThing(); // Expensive
      // Place an empty lock or memory barrier here if loose memory semantics require it
      myArray[index] = theThing ;
    }
  }
}
if (theThing is DummyThing)
{
  lock(theThing) { } // Wait for thread that created DummyThing to release lock
  theThing = myArray[index];
  if (theThing is DummyThing)
      throw something; // Code that tried to initialize object failed to do so
  }
} 
```

此代码假定可以廉价地构造一个从`Thing`. 新对象不应*是*单例，也不应以其他方式重用。每个插槽都`myArray`将被写入两次——首先是预先锁定的虚拟对象，然后是真实对象。只有一个线程能够写入一个虚拟对象，只有成功写入虚拟对象的线程才能写入真正的对象。任何其他线程要么会看到一个真实的对象（在这种情况下，该对象已完全初始化），要么会看到一个虚拟对象，该对象将被锁定，直到使用对真实对象的引用更新数组为止。

与上面显示的其他方法不同，这种方法将允许同时初始化数组中的不同项目；唯一会阻塞的情况是尝试访问正在初始化的对象。

# java - 在Java中声明变量之前给另一个类变量值

> ID：13261302
> 
> 赞同：0
> 
> 时间：2012-11-06T23:56:09.713
> 
> 标签：java, variables

我正在尝试将值传递给可能尚未声明的变量。从我的主要源类中，我给另一个类一些值，但后来似乎这些值已经消失了。

# **源代码：**

**server.java（主要）：**

```
public class server {

public static void main(String[] args)  {

    //Print a simple message to the user to notify there is something going on...
    System.out.println("Starting server, please wait...");

    //Connecting all class files to the server.
    filehandler filehandlerclass = new filehandler();
    networking networkingclass = new networking();
    //End of class files connecting.

    //Preparing the filehandler's file information to open a new filestream.
    filehandlerclass.filetohandlename = "server";
    filehandlerclass.filetohandleextention = "ini";
    filehandlerclass.filetohandlepath = "configs\\";

    //Request a new filestream using the filehandler's file variables.
    filehandlerclass.openfilestream(filehandlerclass.filestream, filehandlerclass.filetohandle);

    //Checks if the filehandler has tried to open a filestream.
    if(filehandlerclass.filestreamopen == true) {
        //Request a check if the filestream was opened sucessfully.
        filehandlerclass.filestreamexists(filehandlerclass.filestream);
    }
    //If the filehandler has not tried to open a filestream...
    else    {
        System.out.println("Error: The filehandler does not seem to have tried to open a filoestream yet.");
        System.out.println("A possibility is that the server could not call the method from the filehandler properly.");
    }

    //Checks if the boolean "filestreamexists" from the filehandlerclass is true.
    if(filehandlerclass.filestreamexists(filehandlerclass.filestream) == true)  {
        //The filestream seems to exist, let's read the file and extract it's information.
        filehandlerclass.readfile(filehandlerclass.filestream);
    }
    else    {
        filehandlerclass.openfilestream(filehandlerclass.filestream, filehandlerclass.filetohandle);
    }
}
} 
```

**文件处理程序.java：**

```
//Imports the java.io library so the filehandler can read and write to text files.
import java.io.*;

public class filehandler    {

//Variables for the filehandler class.
public String filetohandlename;
public String filetohandleextention;
public String filetohandlefullname = filetohandlename + "." + filetohandleextention;
public String filetohandlepath;
public String filetohandle = filetohandlepath + filetohandlefullname;

//Boolean that is true if the filehandler's "openfilestream"-method has tried to open a filestream.
//Is false as long as none filestreams have been touched.
public boolean filestreamopen = false;

//Declares a variable for the filestream to access text files.
public File filestream;
//End of variable list.

//Called to open a filestream so the server can load properties from text files.
public void openfilestream(File filestream, String filetohandle)    {

    //Tell the user that a filestream is about to be opened.
    System.out.println("Opening filestream for \"" + filetohandlefullname + "\"...");
    //Open a filestream called "filestream" using the variable "filetohandle"'s value
    //as information about wich file to open the filestream for.
    filestream = new File(filetohandle);
    //Turn the boolean "filestreamopen" to true so next time the server checks it's
    //value, it knows if the filehandler has tried to open a filestream.
    filestreamopen = true;
}

//Boolean that checks if the filestream exists.
public boolean filestreamexists(File filestream)    {
    //Tell the user that a check on the filestream is going on.
    System.out.println("Checking if filestream for \"" + filetohandlefullname + "\" exists...");
    //If the filestream exists...
    if(filestream.exists()) {
        //Tell the user that the filestream exists.
        System.out.println("Filestream for \"" + filetohandlefullname + "\" exists!");
        //Make the boolean's value positive.
        return true;
    }
    //If the filestream does not exist...
    else    {
        //Tell the user that the filestream does not exist.
        System.out.println("Filestream for \"" + filetohandlefullname + "\" does not exist!");
        //Make the boolean's value negative.
        return false;
    }
}

//Called to read files and collect it's information.
public void readfile(File filestream)   {
    //Checks if the file that is going to be read is a configuration file.
    if(filetohandleextention == "ini")  {
        //Tell the user that a configuration file is going to be read.
        System.out.println("Extracting information from the configuration file \"" + filetohandle + "\".");
    }
}
} 
```

**网络.java：**

```
public class networking {

} 
```

# **问题：**

server.java 将为源文件提供命令并告诉他们该做什么。除非 server.java 给了它们一个命令，否则源文件不会自行运行。通过这种方式，我计划能够在 server.java 中编写简单的函数调用，以从不同的源文件中执行更大的任务。

server.java 似乎在声明变量之前传递了变量“filetohandlename”、“filetohandleextention”和“filetohandlepath”，当它们被声明时，它们被声明为“null”作为值。

# **结果：**

![Java 编译/运行错误。](../Images/696ec0025a3dc87d618a927ce532e53d.png)

编译时没有错误。我认为正在发生的只是与指定要读取的文件的正确值的变量不匹配。它还会引发一个我暂时不关心的异常，要么是因为“null.null”不存在，要么是我写错了代码。

# **最终要求：**

有谁知道我是否可以制作一种接收变量值的方法，或者是否有另一种更合适的方法？我可以在 server.java 中创建一个变量数组并从该数组中收集值吗？

非常感谢您的参与。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T00:03:14.847

这个：

```
public String filetohandlename;
public String filetohandleextention;
public String filetohandlefullname = filetohandlename + "." + filetohandleextention; 
```

将前两个变量初始化为 null，将第三个变量初始化为“null.null”。请注意，如果您更改组成 的组件变量之一`filetohandlefullname`，则不会更改 的值`filetohandlefullname`。如果您希望发生这种情况，`filetohandlefullname`则应替换为执行附加操作的方法。

这个：

```
public void openfilestream(File filestream, String filetohandle) 
```

将不同的变量传递给`filetohandle`方法。该变量*不同于*.`this.filetohandle`

我认为这段代码（上面）有很多问题，我会做以下事情。

1.  用动态执行此操作的方法替换通过其他变量实例化的变量。这样，当您更改`var1`您希望更改的值时`var2`，这将通过方法返回自动发生。例如创建一个私有方法`getFileToHandleFullName()`并将相应的变量装箱
2.  范围类成员`this`
3.  在可能的情况下，制作这些成员`final`，这样您就不会*无意中*更改它们

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:07:16.823

这条线

```
public String filetohandlefullname = filetohandlename + "." + filetohandleextention; 
```

当您实例化类时执行（即`filehandler filehandlerclass = new filehandler();`）。在那个时间点，两个变量都没有设置，因此`filetohandlefullname`被初始化为`null.null`

但是您的代码也存在许多其他问题，例如

```
//Request a new filestream using the filehandler's file variables.
filehandlerclass.openfilestream(filehandlerclass. filestream,filehandlerclass.filetohandle); 
```

例如，您传递的参数是来自同一实例的字段。这完全没用，因为该方法已经可以访问这些，而且非常令人困惑。

并且可能有点争议：

```
//Make the boolean's value positive.
return true; 
```

注释只有在它们阐明代码时才有用，如果没有它们会不那么明显，并且它们必须是 100% 真实的，而不是像经常发生的那样，程序希望代码会做什么。在这种特定情况下，这些条件都不满足，因为注释没有说明发生了什么，实际上设置了方法的返回值，而不是一些不起眼的“布尔值”

# jsf - 如何使用 Primefaces 发送 ajax 回调参数？

> ID：13261307
> 
> 赞同：1
> 
> 时间：2012-11-06T23:56:41.670
> 
> 标签：jsf, primefaces

我正在尝试使用 RequestContext 发送 Ajax 回调，但无法正常工作。

我尝试了[Primefaces 登录演示](http://www.primefaces.org/showcase/ui/dialogLogin.jsf)，但 javascript 函数中的“args.loggedIn”始终未定义，而“args”是一个对象。

这是我的代码：

对话框登录.xhtml：

```
<h:body>
<h:outputLink
        id="loginLink" 
        value="javascript:void(0)" 
        onclick="dlg.show()"
        title="login">
        Click
</h:outputLink>

<p:dialog id="dialog" header="Login" widgetVar="dlg">  
    <h:form>  

        <h:panelGrid columns="2" cellpadding="5">  
            <h:outputLabel for="username" value="Username:" />  
            <p:inputText value="#{logBean.username}"   
                    id="username" required="true" label="username" />  

            <h:outputLabel for="password" value="Password:" />  
            <h:inputSecret value="#{logBean.password}"   
                    id="password" required="true" label="password" />  

            <f:facet name="footer">  
                <p:commandButton id="loginButton" value="Login" update=""   
                    actionListener="#{logBean.login}"   
                    oncomplete="handleLoginRequest(xhr, status, args)"/>  
            </f:facet>  
        </h:panelGrid>  

    </h:form>  
</p:dialog>  

<script type="text/javascript">  
    function handleLoginRequest(xhr, status, args) {  
        if(args.validationFailed || !args.loggedIn) {  
            jQuery('#dialog').effect("shake", { times:3 }, 100);  
        } else {  
            dlg.hide();  
            jQuery('#loginLink').fadeOut();  
        }  
    }  
</script>
</h:body> 
```

LogBean.java：

```
@ManagedBean
public class LogBean {  

    private String username;      
    private String password;  

    // getters & setters

    public void login(ActionEvent actionEvent) {  
        RequestContext context = RequestContext.getCurrentInstance();  
        boolean loggedIn = false;  

        if(username != null  && username.equals("admin") && password != null  && password.equals("admin")) {  
            loggedIn = true;  
        } else {  
            loggedIn = false;  
        }  
        System.out.println("loggedIn : " + loggedIn);
        context.addCallbackParam("loggedIn", loggedIn);  
    }
} 
```

调用了 javascript 函数“handleLoginRequest”，但“args.loggedIn”始终未定义。我不明白为什么...

发送的响应（我从 Firebug 得到）是：

```
<?xml version="1.0" encoding="utf-8"?>
<partial-response>
    <changes>
        <update id="javax.faces.ViewState">
            <![CDATA[3585116548358262356:-8608378680794066522]]>
        </update>
    </changes>
</partial-response> 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T18:35:47.773

如果验证失败，您会从应用程序获得以下响应：

```
<extension ln="primefaces" type="args">{"validationFailed":true}</extension> 
```

其中包含一个 JSON 响应，其中*仅* `validationFailed : true`包含. 响应中没有`loggedIn`字段，这就是`undefined`您调用的原因`args.loggedIn`。

如果验证通过但登录失败，您将收到以下响应：

```
<extension ln="primefaces" type="args">{"loggedIn":false}</extension> 
```

此响应具有`loggedIn`值，因此调用`args.loggedIn`结果为`false`. 因为`validationFailed`在 JSON 响应中没有调用`args.validationFailed`导致未定义的结果。

# module - play framework 2.x 发生了什么变化

> ID：13261308
> 
> 赞同：-1
> 
> 时间：2012-11-06T23:56:44.687
> 
> 标签：module, console, dependencies, playframework-2.0

播放框架 2.0.4 不支持某些控制台吗？

当我使用 1.x 时，我可以使用控制台“play eclipsify”

以及对 fbconnect 和 fbgraph 模块的“播放依赖项”

但是从我更改版本开始，它就无法正常工作。

那么我该如何连接这些模块呢？我不知道这样做

我认为新版本不支持那些控制台的模块

这是对的吗？

方式完全不同吗？如果那时请告诉我。

* * *

也juz前段时间我检查了1.2.5版本

并且没有 dependencies.yml 和模块文件夹

你能告诉我发生了什么变化，我该如何申请和调整？

感谢您的时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:23:23.663

[https://github.com/playframework/Play20/wiki/Play-2.0-for-Play-1.x-developers](https://github.com/playframework/Play20/wiki/Play-2.0-for-Play-1.x-developers)

看一下这个

我想告诉你一些评估我问题的人

如果没有真正想学习的初学者问，发展如何生存？

我讨厌名誉！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:36:13.960

是的，它完全不同，虽然有些想法是相同的，但它[`Play 2.x`](https://stackoverflow.com/questions/tagged/playframework-2.0)是一个相当新的产品（正如*许多个月以来的**许多*主题和问题所述），（幸运的是）和之间没有向后兼容性！*[`Play 1.x`](https://stackoverflow.com/questions/tagged/playframework-1.x)[`2.x`](https://stackoverflow.com/questions/tagged/playframework-2.0)*

 *当您访问[Play 1.x (only) modules 页面](http://www.playframework.org/modules)时，您首先会看到免责声明：

> 这些模块仅适用于**Play 1.x**系列。**Play 2.0**模块可以托管在任何 Ivy、Maven 或 Git 存储库的任何位置。我们很快就会在这里为他们添加一个目录。

**感谢 Pere Villega**，您也可以在[PlayModules.net](http://www.playmodules.net/)网站上搜索[`Play 2.0 for Java`](http://www.playmodules.net/module/list?nameFilter=&versionFilter=2&inputTagFilter=)或[`Scala`](http://www.playmodules.net/module/list?nameFilter=&versionFilter=3&inputTagFilter=)模块，但是您需要仔细选择和系列。[`Play 1.x`](https://stackoverflow.com/questions/tagged/playframework-1.x)[`Play 2.x`](https://stackoverflow.com/questions/tagged/playframework-2.0)

要使用[eclipse](/questions/tagged/eclipse "显示标记为“日食”的问题")，请查看[Play 的 2.0 IDE 文档](http://www.playframework.org/documentation/2.0.4/IDE)。*

# ios - 将 iOS 应用程序连接到 adhoc wifi 网络

> ID：13261311
> 
> 赞同：4
> 
> 时间：2012-11-06T23:56:53.770
> 
> 标签：ios, sockets, wifi

我通过 WiFly 模块设置了一个 adhoc wifi 网络。我想知道如何将 iOS 设备连接到该网络。现在我正在使用 CFStream api。我找到了一个使用这个的教程：

```
CFStreamCreatePairWithSocketToHost(NULL, (CFStringRef)@"localhost", 80, &readStream, &writeStream); 
```

连接到服务器。但是我不想拥有服务器，我只想通过服务器与我的 WiFly 模块与 iOS 设备通信。只需通过 adhoc 网络进行直接通信。我怎样才能做到这一点？

谢谢

# string - 为什么通过 GDB 中的“print”输出看到 C++ 字符串似乎没有正确初始化？

> ID：13261312
> 
> 赞同：1
> 
> 时间：2012-11-06T23:56:53.863
> 
> 标签：string, gdb, flush

我有以下一段代码。

```
#include <string>
#include <ctype.h>

std::string lowerCase(const std::string &exprName)
{
    std::string dummy(exprName);
    char firstChar = tolower(exprName.at(0));
    dummy.replace(0, 1, &firstChar);
    return dummy;
} 
```

当我使用 GDB 单步执行代码并在第 6 行中断时 (std::string dummy(exprName))，我希望 dummy 为空。但是当我使用打印它时

```
p dummy 
```

GDB 以下列方式打印变量的值

```
Breakpoint 1, lowerCase (exprName=...) at Utility.cpp:49
49      std::string dummy("");

(gdb) print dummy
$1 = {
  static npos = 18446744073709551615, 
  _M_dataplus = {
    <std::allocator<char>> = {
      <__gnu_cxx::new_allocator<char>> = {<No data fields>}, <No data fields>}, 
    members of std::basic_string<char, std::char_traits<char>, std::allocator<char> >::_Alloc_hider: 
    _M_p = 0x634261 "Expr * input2 = facade->derefE(facade->varE(v));\nNode * subject = f->"
  }
} 
```

另外，如果我进入下一行代码，即

```
char firstChar = tolower(exprName.at(0)); 
```

我在 GDB 中打印“dummy”的值，它的值保持不变并且不会更改为 exprName 的值。我打印了“exprName”，它肯定包含不同的值！

这很莫名其妙！为什么 dummy 不会被初始化为与 exprName 相同的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:17:04.420

这正是*uninitialized*的含义：该值（某种程度上）是不可预测的，当您查看内容时，它可能没有意义。

在您的情况下，`_M_ptr`指针意外地指向有效的内存范围，因此您确实看到了一些看起来像字符串的东西。内容取决于另一个函数临时存储在堆栈中的值，该函数在此之前调用。

# ruby-on-rails - 在会话中存储用户数据并稍后在表单（Rails）中使用它？

> ID：13261313
> 
> 赞同：0
> 
> 时间：2012-11-06T23:56:59.840
> 
> 标签：ruby-on-rails, session

**我的会话**控制器中有一个`omniauth_create`动作。它将用户重定向到一个名为**enter_email.html.erb**的视图并将一些传递给重定向（从[omniauth](https://github.com/intridea/omniauth/wiki)获取）：****`params`****

 ****```
 def omniauth_create
    auth = request.env["omniauth.auth"]
    user = User.from_omniauth(env["omniauth.auth"])
    .
    .
    .
    else
      redirect_to(enter_email_path(oprovider: user.provider,
                                   ouid: user.uid,
                                   oname: user.name,
                                   opassword: user.password,
                                   opassword_confirmation: user.password))
    end
  end 
```

它们在隐藏字段中使用的位置（基本上是注册表单）：

```
<%= form_for(@user) do |f| %>
      <%= render 'shared/error_messages', object: f.object %>

      <%= f.label :email %>
      <%= f.text_field :email %>

      <%= f.hidden_field :provider, value: params[:oprovider] %>
      <%= f.hidden_field :provider, value: params[:oprovider] %>
      <%= f.hidden_field :uid, value: params[:ouid] %>
      <%= f.hidden_field :name, value: params[:oname] %>
      <%= f.hidden_field :password , value: params[:opassword] %>
      <%= f.hidden_field :password_confirmation, value: params[:opassword_confirmation] %>

      <% # To know to which form to redirect in case of validation error %>
      <%= hidden_field_tag 'form_name', 'enter_email' %>

      <%= f.submit "Create my account", class: "btn btn-large btn-primary" %>
    <% end %> 
```

现在的问题是，当出现验证错误时（例如，电子邮件已被占用）。视图呈现`enter_email`并`params`从隐藏字段（从值）中清除。

所以我正在考虑将数据存储在**会话**中，而不是通过`redirect_to`我从未以这种方式使用过会话的方式传递它们，所以我有点迷茫（我什至不确定如果我将数据存储在会议？）

谁能给我一个提示或一个例子？****

# c# - Windows 窗体控件装饰

> ID：13261314
> 
> 赞同：0
> 
> 时间：2012-11-06T23:57:13.973
> 
> 标签：c#, .net, forms

我是 C# 新手，我正在尝试构建自己的简化 Windows 资源管理器。我想应用 Windows 主题来装饰树视图和列表视图。我浏览了这个很棒的[链接](https://stackoverflow.com/questions/3014816/visualstylerenderer-and-themes-winforms)，但不知道如何将它们附加到我的树视图中。我正在寻找详细的答案。到目前为止，我只知道我需要将 DrawMode 设置为 OwnerDrawAll。接下来是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:02:28.497

我找到了[解决方案](http://cyotek.com/blog/enabling-shell-styles-for-the-listview-and-treeview-controls-in-csharp)，所以下次有人会有更简单的方法

# c# - 从浏览器查看时，Sharepoint 2010 设置 cookie 过期日期似乎有效，但服务器代码看到 01/01/0001 过期

> ID：13261316
> 
> 赞同：0
> 
> 时间：2012-11-06T23:57:26.577
> 
> 标签：c#, sharepoint-2010, httpcookie, httpcookiecollection

这是将cookie添加到请求中

```
 HttpCookie cookie = new HttpCookie(myCookie);
    cookie.Expires = DateTime.Now.AddDays(30);
    cookie.Value = myValue;
    cookie.Domain = myDomain;
    cookie.HttpOnly = true;
    response.Cookies.Add(cookie); 
```

似乎很好，直到在 Sharepoint 2010 context.PostAuthenticateRequest 事件期间，当我尝试读取 cookie

```
 HttpCookieCollection cookies = request.Cookies;
        HttpCookie tosCookie = cookies.Get(TOS_COOKIE_KEY_ACKNOWLEDGEMENT);
        tosCookie.Expires 
```

当我在浏览器中看到 cookie 过期日期为 12/6/2012 时，我得到日期 01/01/0001

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:08:44.153

是的，服务器不知道传入 cookie 的到期时间。

浏览器不会向服务器发送过期的 cookie，也不会以任何方式让服务器知道什么是 cookie 过期。

# c++ - 如何改善我的功能

> ID：13261317
> 
> 赞同：1
> 
> 时间：2012-11-06T23:57:37.373
> 
> 标签：c++, sfml

我的班级中有一个函数可以加载 2 张图像，但仅根据特定条件显示一次。

问题是我必须在条件之前先加载图像，这发生在我的主循环中。而且我不确定这是否明智，所以想知道我能做些什么来让它稍微优雅一点....

这就是我所拥有的：

* * *

`Main Loop`：

```
btn_quit.RenderBttn(window,mouseX,mouseY); 
```

* * *

`Class function`

```
void RenderBttn(sf::RenderWindow &destination,int mouseX, int mouseY)
{

    std::string img = "button.png";
    sf::Texture button;
    if (!button.loadFromFile(img)){
      exit(4);
    }

    std::string img_on = "button_on.png";
    sf::Texture button_on;
    if (!button_on.loadFromFile(img_on)){
      exit(5);
    }

    sf::Sprite sprite(button);
    m_w = sprite.getLocalBounds().width; //get dimensions
    m_h = sprite.getLocalBounds().height; //get dimensions

    sf::Sprite result(IsIn(mouseX,mouseY) ? button_on : button);    //check if mouse is over the button 
    result.setPosition(m_x,m_y);
    destination.draw(result);
} 
```

* * *

我的一个解决方案是使用固定数量的按钮大小，但这限制了以后更改图像大小的能力。

而且我每次都在我的主循环中加载 2 张图像，这肯定不利于性能吗？

希望你能帮忙:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:30:28.663

您应该做的是将加载的图像存储为可以在主循环中访问的变量。例如，如果您的主循环在一个类中，`sf::Texture button;`则向它添加成员变量。当您加载程序时，加载这两个图像，然后您可以在循环的每次迭代中执行检查以查看是否绘制它们。这里的关键是加载一次并将它们存储在内存中，在需要时选择使用它们。如果您注意到在您玩的大多数游戏中，通常在地图开始时，它的所有资源（例如纹理、声音等）都会在“加载屏幕”中加载，此时它们会一直保存在内存中，直到它们被使用（注意不是所有游戏都是这样，但这只是一个例子）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:32:46.103

为什么不先测试条件然后加载图像？例如，

编辑：您需要将加载从主循环中拉出来。在您的类中有两个按钮变量，并将以下代码放入您的构造函数中。

```
if (button.loadFromFile("button.png")) {
  exit(4);
}

if (button_on.loadFromFile("button.png")) {
  exit(4);
} 
```

在主循环中，您不需要一次又一次地加载文件。

# javascript - 如何为 Closure 编译器设置 language_in 选项？

> ID：13261325
> 
> 赞同：19
> 
> 时间：2012-11-06T23:58:46.733
> 
> 标签：javascript, google-closure-compiler, compiler-options

我需要在 Closure 编译器上设置 language_in 选项以防止 IE8 解析错误：

错误 - 解析错误。IE8（及以下）将错误地解析数组和对象文字中的尾随逗号。如果您的目标是较新版本的 JS，请设置适当的 language_in 选项。

我确实在闭包组中找到了与此相关的帖子，但是，该选项是直接在 java 编译器上设置的，而不是通过构建脚本之一。我需要能够在构建脚本上设置它。

我正在查看closure/bin/build/ 中的脚本，那里有几个。我尝试将选项添加到闭包构建器，但失败了。

有人可以指导我如何正确设置此选项吗？

谢谢你。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-07T06:25:07.703

运行带有标志的[闭包编译器应用程序](https://developers.google.com/closure/compiler/docs/gettingstarted_app)`--help`以查看每个标志的描述。

```
java -jar compiler.jar --help 
```

[CommandLineRunner](https://github.com/google/closure-compiler/blob/f087f70c6e4b595f9a8f8067691de2fa3c8a9e03/src/com/google/javascript/jscomp/CommandLineRunner.java#L608-L616)定义了一组允许的值`--language_in`：

> `--language_in`
> 设置输入源符合的语言规范。
> 选项：ECMASCRIPT3、ECMASCRIPT5、ECMASCRIPT5_STRICT、ECMASCRIPT6_TYPED（实验）、ECMASCRIPT_2015、ECMASCRIPT_2016、ECMASCRIPT_2017、ECMASCRIPT_NEXT

[LanguageMode 枚举](https://github.com/google/closure-compiler/blob/f087f70c6e4b595f9a8f8067691de2fa3c8a9e03/src/com/google/javascript/jscomp/CompilerOptions.java#L3048-L3093)有更多关于这些值的细节。

使用[Closure Builder](https://developers.google.com/closure/library/docs/closurebuilder)，`--language_in`标志将作为参数传递给
`--compiler_flags`，如下所示：

```
--compiler_flags="--language_in=ECMASCRIPT5" 
```

# php - PHP 脚本在超过 60 秒时执行两次

> ID：13261327
> 
> 赞同：5
> 
> 时间：2012-11-06T23:59:27.500
> 
> 标签：php, apache

好吧，所以在过去的 3 个小时里，我一直在为此绞尽脑汁，并且疯狂地在谷歌上搜索，却没有解决问题。因此，我编写了一个示例脚本来重现这一点，因为我的原始脚本大约有 800 行。

```
<?php
    set_time_limit(0);
    ini_set('max_input_time', '-1');
    ini_set('max_execution_time', '0');

    error_log("executing script... ");
    $time = time();
    for ($t = 0; $t <= 15; $t++) {
        error_log("Logging: $t (".(time()-$time)." seconds)");
        sleep(5);
    }
    error_log("execution done (".(time()-$time)." seconds)");
?> 
```

现在，sleep 函数只是用来重新创建页面的执行时间，并没有在原始代码中使用。这将在 error_log 文件中产生以下结果

```
[Tue Nov 06 16:24:14 2012] executing script...
[Tue Nov 06 16:24:14 2012] Logging: 0 (0 seconds)
[Tue Nov 06 16:24:19 2012] Logging: 1 (5 seconds)
[Tue Nov 06 16:24:24 2012] Logging: 2 (10 seconds)
[Tue Nov 06 16:24:29 2012] Logging: 3 (15 seconds)
[Tue Nov 06 16:24:34 2012] Logging: 4 (20 seconds)
[Tue Nov 06 16:24:39 2012] Logging: 5 (25 seconds)
[Tue Nov 06 16:24:44 2012] Logging: 6 (30 seconds)
[Tue Nov 06 16:24:49 2012] Logging: 7 (35 seconds)
[Tue Nov 06 16:24:54 2012] Logging: 8 (40 seconds)
[Tue Nov 06 16:24:59 2012] Logging: 9 (45 seconds)
[Tue Nov 06 16:25:04 2012] Logging: 10 (50 seconds)
[Tue Nov 06 16:25:09 2012] Logging: 11 (55 seconds)
[Tue Nov 06 16:25:14 2012] executing script...
[Tue Nov 06 16:25:14 2012] Logging: 0 (0 seconds)
[Tue Nov 06 16:25:14 2012] Logging: 12 (60 seconds)
[Tue Nov 06 16:25:19 2012] Logging: 1 (5 seconds)
[Tue Nov 06 16:25:19 2012] Logging: 13 (65 seconds)
[Tue Nov 06 16:25:24 2012] Logging: 2 (10 seconds)
[Tue Nov 06 16:25:24 2012] Logging: 14 (70 seconds)
[Tue Nov 06 16:25:29 2012] Logging: 3 (15 seconds)
[Tue Nov 06 16:25:29 2012] Logging: 15 (75 seconds)
[Tue Nov 06 16:25:34 2012] Logging: 4 (20 seconds)
[Tue Nov 06 16:25:34 2012] execution done (80 seconds)
[Tue Nov 06 16:25:39 2012] Logging: 5 (25 seconds)
[Tue Nov 06 16:25:44 2012] Logging: 6 (30 seconds)
[Tue Nov 06 16:25:49 2012] Logging: 7 (35 seconds)
[Tue Nov 06 16:25:54 2012] Logging: 8 (40 seconds)
[Tue Nov 06 16:25:59 2012] Logging: 9 (45 seconds)
[Tue Nov 06 16:26:04 2012] Logging: 10 (50 seconds)
[Tue Nov 06 16:26:09 2012] Logging: 11 (55 seconds)
[Tue Nov 06 16:26:14 2012] Logging: 12 (60 seconds)
[Tue Nov 06 16:26:19 2012] Logging: 13 (65 seconds)
[Tue Nov 06 16:26:24 2012] Logging: 14 (70 seconds)
[Tue Nov 06 16:26:29 2012] Logging: 15 (75 seconds)
[Tue Nov 06 16:26:34 2012] execution done (80 seconds) 
```

这是来自 phpinfo 的一些相关设置

```
=== apache2handler ===
Max Requests: Per Child: 1000 - Keep Alive: on - Max Per Connection: 200
Timeouts: Connection: 300 - Keep-Alive: 2 

=== PHP Version 5.4.5 Core Settings ===
max_execution_time     Local: 0     Master: 30
max_input_time         Local: -1    Master: -1 
```

我已经尝试了我能想到的一切。它似乎是使用 Apache 或 PHP 的服务器设置，因为当我在本地主机上运行相同的脚本时，它会成功执行，就像它应该没有双重负载一样。在它被问到之前，是的，每次我进行 INI 更改或 apache 配置更改时，我都在重新启动 apache。

此外，这里是上面示例的 access_log 条目。

```
*.*.*.* - - [06/Nov/2012:16:43:56 -0700] "GET /test.php HTTP/1.1" 200 20 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:16.0) Gecko/20100101 Firefox/16.0" *.*.*.* *********.com 80 55050278 1012 321 *.*.*.*
*.*.*.* - - [06/Nov/2012:16:44:56 -0700] "GET /test.php HTTP/1.1" 200 20 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:16.0) Gecko/20100101 Firefox/16.0" *.*.*.* *********.com 80 60054985 1012 321 *.*.*.* 
```

一旦执行时间达到 60 秒，肯定会执行此操作，因为当我将执行时间更改为 55 秒时，它会按原样运行一次。

```
[Tue Nov 06 16:46:00 2012] executing script...
[Tue Nov 06 16:46:00 2012] Logging: 0 (0 seconds)
[Tue Nov 06 16:46:05 2012] Logging: 1 (5 seconds)
[Tue Nov 06 16:46:10 2012] Logging: 2 (10 seconds)
[Tue Nov 06 16:46:15 2012] Logging: 3 (15 seconds)
[Tue Nov 06 16:46:20 2012] Logging: 4 (20 seconds)
[Tue Nov 06 16:46:25 2012] Logging: 5 (25 seconds)
[Tue Nov 06 16:46:30 2012] Logging: 6 (30 seconds)
[Tue Nov 06 16:46:35 2012] Logging: 7 (35 seconds)
[Tue Nov 06 16:46:40 2012] Logging: 8 (40 seconds)
[Tue Nov 06 16:46:45 2012] Logging: 9 (45 seconds)
[Tue Nov 06 16:46:50 2012] Logging: 10 (50 seconds)
[Tue Nov 06 16:46:55 2012] execution done (55 seconds) 
```

对此的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T00:23:32.663

诸如缺少图标之类的东西是否会导致您的脚本被调用两次。请参阅[http://www.webdeveloper.com/forum/showthread.php?245809-Script-Running-Twice](http://www.webdeveloper.com/forum/showthread.php?245809-Script-Running-Twice)。如果您将非 www 重定向到 www 或反之亦然，它也可以发生。[从非 www 重定向到 www 时，](https://stackoverflow.com/questions/13093337/php-executes-twice-on-page-load-when-redirecting-from-non-www-to-www)请参阅PHP 在页面加载时执行两次

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T00:10:36.843

只是为了排除它，您是否尝试过在另一个浏览器中进行测试？我只提到它是因为我最近偶然发现了这个：

[https://support.mozilla.org/en-US/questions/922783](https://support.mozilla.org/en-US/questions/922783)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-17T17:16:48.633

作为一种解决方法，也许您可​​以将执行分成两页；完成第一个后，只需加载第二个。这也可以解决某些资源限制，例如 PHP 配置中的低 RAM 预算。

# ipv6 - Java Web Start 无法打开 jnlp 文件

> ID：13261328
> 
> 赞同：2
> 
> 时间：2012-11-06T23:59:28.510
> 
> 标签：ipv6, jnlp, java-web-start, socketexception, proxy-server

我从这里下载了文件 SwingSet3.jnlp：[java.net/.../SwingSet3.jnlp](http://download.java.net/javadesktop/swingset3/SwingSet3.jnlp)。我正在运行 Windows 7 64 位操作系统，每次单击文件时，**java 7**都会启动，但随后会出现以下错误：无法启动应用程序。

这是例外：

```
com.sun.deploy.net.FailedDownloadException: Resource could not be loaded: http://download.java.net/javadesktop/swingset3/SwingSet3.jnlp
at com.sun.deploy.net.DownloadEngine.actionDownload(Unknown Source)
at com.sun.deploy.net.DownloadEngine._downloadCacheEntry(Unknown Source)
at com.sun.deploy.cache.ResourceProviderImpl.getResourceCacheEntry(Unknown Source)
at com.sun.deploy.cache.ResourceProviderImpl.getResourceCacheEntry(Unknown Source)
at com.sun.deploy.cache.ResourceProviderImpl.getResource(Unknown Source)
at com.sun.javaws.Launcher.updateFinalLaunchDesc(Unknown Source)
at com.sun.javaws.Launcher.prepareToLaunch(Unknown Source)
at com.sun.javaws.Launcher.prepareToLaunch(Unknown Source)
at com.sun.javaws.Launcher.launch(Unknown Source)
at com.sun.javaws.Main.launchApp(Unknown Source)
at com.sun.javaws.Main.continueInSecureThread(Unknown Source)
at com.sun.javaws.Main.access$000(Unknown Source)
at com.sun.javaws.Main$1.run(Unknown Source)
at java.lang.Thread.run(Unknown Source) 
```

**在另一个选项卡中，我得到了这个例外：**

```
java.net.SocketException: Connection reset
at java.net.SocketInputStream.read(Unknown Source)
at java.net.SocketInputStream.read(Unknown Source)
at java.io.BufferedInputStream.fill(Unknown Source)
at java.io.BufferedInputStream.read1(Unknown Source)
at java.io.BufferedInputStream.read(Unknown Source)
at sun.net.www.http.HttpClient.parseHTTPHeader(Unknown Source)
at sun.net.www.http.HttpClient.parseHTTP(Unknown Source)
at sun.net.www.http.HttpClient.parseHTTP(Unknown Source)
at sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown Source)
at java.net.HttpURLConnection.getResponseCode(Unknown Source)
at com.sun.deploy.net.BasicHttpRequest.doRequest(Unknown Source)
at com.sun.deploy.net.BasicHttpRequest.doRequest(Unknown Source)
at com.sun.deploy.net.BasicHttpRequest.doGetRequest(Unknown Source)
at com.sun.deploy.net.DownloadEngine.actionDownload(Unknown Source)
at com.sun.deploy.net.DownloadEngine._downloadCacheEntry(Unknown Source)
at com.sun.deploy.cache.ResourceProviderImpl.getResourceCacheEntry(Unknown Source)
at com.sun.deploy.cache.ResourceProviderImpl.getResourceCacheEntry(Unknown Source)
at com.sun.deploy.cache.ResourceProviderImpl.getResource(Unknown Source)
at com.sun.javaws.Launcher.updateFinalLaunchDesc(Unknown Source)
at com.sun.javaws.Launcher.prepareToLaunch(Unknown Source)
at com.sun.javaws.Launcher.prepareToLaunch(Unknown Source)
at com.sun.javaws.Launcher.launch(Unknown Source)
at com.sun.javaws.Main.launchApp(Unknown Source)
at com.sun.javaws.Main.continueInSecureThread(Unknown Source)
at com.sun.javaws.Main.access$000(Unknown Source)
at com.sun.javaws.Main$1.run(Unknown Source)
at java.lang.Thread.run(Unknown Source) 
```

**在控制台中**

```
 Java Web Start 10.9.2.05
JRE-Version uses 1.7.0_09-b05 Java HotSpot(TM) Client VM
Benutzer-Home-Verzeichnis = C:\Users\Devid
----------------------------------------------------
c:   Konsolenfenster löschen
f:   Objekte in Finalisierungs-Queue finalisieren
g:   Garbage Collect
h:   Diese Hilfemeldung anzeigen
m:   Speicherauslastung drucken
o:   Logging auslösen
p:   Proxykonfiguration neu laden
q:   Konsole ausblenden
r:   Policy-Konfiguration neu laden
s:   System- und Deployment-Eigenschaften ausgeben
t:   Threadliste ausgeben
v:   Thread-Stack ausgeben
0-5: Trace-Ebene auf <n> setzen
----------------------------------------------------
#### **Java Web Start Error**:
#### Ressource could not be loaded: http://download.java.net/javadesktop/swingset3/SwingSet3.jnlp 
```

**这**不是唯一的问题，当我访问这样的网站时：[Game Of Life](http://www.math.com/students/wonders/life/life.html) 我得到一个异常：ClassNotFoundException

也许有人知道是什么问题。

**现在我在尝试打开文件时遇到了一些其他异常：**

```
java.net.SocketException: Connection reset
at java.net.SocketInputStream.read(Unknown Source)
at java.net.SocketInputStream.read(Unknown Source)
at java.io.BufferedInputStream.fill(Unknown Source)
at java.io.BufferedInputStream.read1(Unknown Source)
at java.io.BufferedInputStream.read(Unknown Source)
at sun.net.www.http.HttpClient.parseHTTPHeader(Unknown Source)
at sun.net.www.http.HttpClient.parseHTTP(Unknown Source)
at sun.net.www.http.HttpClient.parseHTTP(Unknown Source)
at sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown Source)
at java.net.HttpURLConnection.getResponseCode(Unknown Source)
at com.sun.deploy.net.BasicHttpRequest.doRequest(Unknown Source)
at com.sun.deploy.net.BasicHttpRequest.doRequest(Unknown Source)
at com.sun.deploy.net.BasicHttpRequest.doGetRequest(Unknown Source)
at com.sun.javaws.jnl.LaunchDescFactory._buildDescriptor(Unknown Source)
at com.sun.javaws.jnl.LaunchDescFactory.buildDescriptor(Unknown Source)
at com.sun.javaws.Launcher.updateFinalLaunchDesc(Unknown Source)
at com.sun.javaws.Launcher.prepareToLaunch(Unknown Source)
at com.sun.javaws.Launcher.prepareToLaunch(Unknown Source)
at com.sun.javaws.Launcher.launch(Unknown Source)
at com.sun.javaws.Main.launchApp(Unknown Source)
at com.sun.javaws.Main.continueInSecureThread(Unknown Source)
at com.sun.javaws.Main.access$000(Unknown Source)
at com.sun.javaws.Main$1.run(Unknown Source)
at java.lang.Thread.run(Unknown Source) 
```

我尝试了很多不同的东西。我禁用了我的防火墙、avira 和 Windows Defender（这个已经被禁用了）。我也这样做了：netsh advfirewall set global StatefulFTP disable

但我也为一些 FTP 问题从 Windows 安装了一个修补程序（[在此处输入链接描述](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7077696)），在此处[输入链接描述](http://go.microsoft.com/?linkid=9728869Fix%20this%20problem)。我还为我的互联网连接禁用了 IPV6。

从设置中的控制面板-> **Java 控制面板**中，我删除了跟踪和日志文件以及缓存的应用程序。我还取消选中该框以在我的计算机上保留临时文件。

Java 控制面板中唯一剩下的就是更改互联网设置，我可以将其设置为 Use **ProxyServer**，但我不知道我应该在里面输入什么地址或端口号。

有趣的是 Eclipse 运行良好！

我真的不知道接下来我应该做什么。似乎也没有人知道如何解决问题。

* * *

什么都没做，我只是将我的 Windows 从 Windows 7 家庭版升级到专业版，现在问题已经消失了。

##

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T23:49:47.123

在没有对这个问题做任何事情的情况下，我将我的 Windows 7 Home 升级到了 Windows 7 Professional，java 的问题现在已经过去了。

我还记得我使用了**CCleaner** Programm，但我认为这不能解决问题。很奇怪，但 Java 和 Windows 7 Home Edition 64 位可能存在一些问题

# html - 无法对未定义的值调用方法“get_token”

> ID：13261330
> 
> 赞同：1
> 
> 时间：2012-11-06T23:59:30.637
> 
> 标签：html, perl, parsing, web-crawler

每当我运行 TokeParser 时，我都会收到这个未定义的错误。我认为这是因为它从 HTML 中提取的最后一件事是导致错误的“undef”，但我确定这是否正确，或者如果它来自该错误该怎么办。

```
#!usr/bin/perl
use warnings;
use strict;

use HTML::TokeParser;

sub findTokens {
    my $htmlFileName = "83.html";

    my $p = HTML::TokeParser->new($htmlFileName);
    my @tokens;

    while (my $newChunk = $p->get_token) {
            if ($newChunk->[0] eq 'T') {
                my @lineArray = split(' ', $newChunk->[1]);
                foreach my $i (@lineArray) {
                    if ( lc($i) =~ /^[a-z]*\-?'?s?$/) {
                        push(@tokens, lc($i));
                    }
                }
            }
    }
    return @tokens;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:13:23.410

这显然`$p`是 undef，并且`$p`是`HTML::TokeParser->new($htmlFileName)`. 这意味着打开文件时出错。正如概要中所建议的，使用以下内容来确定该错误是什么：

```
my $p = HTML::TokeParser->new($htmlFileName)
   or die("Can't open $htmlFileName: $!\n"); 
```

# c# - Sitecore 树展开事件处理程序

> ID：13261332
> 
> 赞同：1
> 
> 时间：2012-11-06T23:59:51.207
> 
> 标签：c#, asp.net, content-management-system, sitecore, sitecore6

有谁知道当有人单击项目节点以展开树时我可以挂钩哪个事件/管道/命令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-20T17:11:54.327

当用户单击或与影响树节点的项目交互时，我看到人们发布各种解决方案。我认为如果你能描述你如何尝试与树节点交互会更容易。但为了提供帮助，我相信您想查看 RenderContentEditor 管道。

# php - 使用带有动态生成 PHP 信息的 JQuery slideToggle

> ID：13261336
> 
> 赞同：0
> 
> 时间：2012-11-06T23:59:58.197
> 
> 标签：php, jquery, for-loop

我把自己彻底搞糊涂了。

我有一个页面，其中包含使用 PHP 动态生成的信息。我正在尝试使用 jQuery 来隐藏和显示信息。但是，当我执行代码时，该函数仅适用于第一个实例。

这是html/php代码：

```
<div id="container">

<?php

foreach ($datas as $name)
{
    if ($name['state'] === 'PA') 
    {
        echo
        '<input type="hidden" name="id" value="' . $name['id'] . '" />' .
        '<h1 id="name">' . htmlentities($name['name']) . '</h1>' .
        '<p id="descriptionlist">' .
        htmlentities($name['description']) . ' ' .
        '<br />' .
        '<ul id="link">' .
        '<li class="l1">' .
        '<a href="' . $name['site'] . '"target="_blank">' . $name['sname'] . '</a>' .
        '</li>' .
        '</ul>' .                           
        '</p>' .

'<div id = "locBar' . $name['id'] . '">' .  '<div id="locText' . $name['id'] . '">' .   
'<h2 id="location">Location</h2>' .
'</div>' . '</div>' .
'<div id="locDiv' . $name['id'] . '">' . 
```

这是 jQuery 脚本：

```
$(document).ready(function(){
$('#locBar').click(function(){
$('#locDiv').slideToggle('slow')
})
}); 
```

显然，jQuery 不明白如果我在第二次迭代中单击 div，那么任何事情都会发生。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:05:25.283

生成的 html 是什么样的？我猜这是 foreach 循环的开始，您正在生成具有相同 ID（locBar 和 locDiv）的多个 div。您永远不应拥有多个具有相同 ID 的项目。将其更改为使用类

# ios - 如何解析从索引到索引的 NSString？

> ID：13261337
> 
> 赞同：0
> 
> 时间：2012-11-07T00:00:06.403
> 
> 标签：ios, nsstring, nsrange

我想解析这样的字符串：
`NSString *str = @"firstcolumn second column text Third Column Text";`

我有三列文本，每列可以是带空格的文本。
我知道列有多宽，col1 = 10 个字符长，col2 = 20，col3 = 30
我知道我可以使用 NSRange(0,len1),(10,len2),(20,len3)。

我收到崩溃“超出范围”错误，因为长度不同，列文本的长度不必达到其最大限制。

任何想法如何做到这一点？

```
NSString *str = @"A000 B11 This is text description This column is a longer Text description"; 
//A000 column can be 10 chars long
//B11 can be 20 chars
//This is some text description can be 30 characters long
 NSString *code1 = [line substringWithRange:NSMakeRange(0,10)];
 NSString *code2 = [line substringWithRange:NSMakeRange(10,20)];
 NSString *shorttext = [line substringWithRange:NSMakeRange(20,20)];
 NSString *longtext = [line substringWithRange:NSMakeRange(30,30)]; 
```

我想在上面的例子中得到 code1 = A000，它的长度可以是 10 个字符，但不必像你看到的那样。同样，其他 2 列代码 2 和文本也是如此。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:33:35.493

# google-apps-script - 防止服务器处理程序触发

> ID：13261342
> 
> 赞同：0
> 
> 时间：2012-11-07T00:00:37.727
> 
> 标签：google-apps-script

如果客户端处理程序（在同一个小部件上）满足验证条件，我们可以阻止服务器处理程序触发吗？ [用户界面](https://script.google.com/macros/s/AKfycbw1PVgbtiakL8EHS7YwXC2E-sj0Ypj0_zTK2Nzq4zQ-z9Gg_PMA/exec)

如果文本框为空，我不希望提交执行任何服务器功能。

```
function doGet() {
  var app = UiApp.createApplication();
  var flex = app.createFlexTable()
     .setWidget(0, 0, app.createTextBox().setId('textbox'))
     .setWidget(0, 1, app.createButton('Submit').setId('submit'))
     .setWidget(0, 2, app.createLabel().setId('status'));

  var clientHandler = app.createClientHandler().validateNotMatches(app.getElementById('textbox'), ' ');

  var serverHandler = app.createServerHandler('submit').addCallbackElement(flex);

  app.getElementById('submit').addClickHandler(clientHandler).addClickHandler(serverHandler);

  app.add(flex);
  return app;

}

function submit(e) {
  var app = UiApp.getActiveApplication();
  app.getElementById('status').setText('Server handler fired');
  return app;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T03:02:15.670

您在这里不需要或不需要客户端处理程序，只是服务器处理程序上的验证器：

```
function doGet() {
  var app = UiApp.createApplication();
  var flex = app.createFlexTable()
     .setWidget(0, 0, app.createTextBox().setId('textbox'))
     .setWidget(0, 1, app.createButton('Submit').setId('submit'))
     .setWidget(0, 2, app.createLabel().setId('status'));

  var serverHandler = app.createServerHandler('submit')
     .validateLength(app.getElementById('textbox'), 1, null)
     .addCallbackElement(flex);

  app.getElementById('submit').addClickHandler(serverHandler);

  app.add(flex);
  return app;

}

function submit(e) {
  var app = UiApp.getActiveApplication();
  app.getElementById('status').setText('Server handler fired');
  return app;
} 
```

如果您想要一条解释问题所在的消息，您可以添加以下内容：

```
var clientHandler = app.createClientHandler()
    .validateNotLength(app.getElementById('textbox'), 1, null)
    .forTargets(app.getElementById('status'))
    .setText('Cannot be empty');

app.getElementById('submit').addClickHandler(serverHandler)
    .addClickHandler(clientHandler); 
```

# xcode - 如何在点击时删除 UITextfield？

> ID：13261346
> 
> 赞同：0
> 
> 时间：2012-11-07T00:01:33.433
> 
> 标签：xcode, uitextfield, xcode4.3, uigesturerecognizer, gesture

我有一个程序，当我点击视图时`UITextField`会出现一个。我还有一个撤消按钮。当我双击`UITextfield`它可以删除时，我想创建一个删除功能。请帮我。

这是我的代码：

视图控制器.h

```
#import <UIKit/UIKit.h>
#import <QuartzCore/QuartzCore.h>

@interface ViewController : UIViewController<UITextFieldDelegate, UIGestureRecognizerDelegate>
{

    NSMutableArray *textfieldform;
    UITextField *textField1;
    float   angle;
    CGFloat beginX;
    CGFloat beginY;
    IBOutlet UIView *blahBlah;
    CGPoint prevPanPoint;
    float prevPinchScale;
    float prevRotation;
}

@property (nonatomic, retain) NSMutableArray *textfieldform;

-(IBAction) undo;
- (IBAction)handleTap2:(UITapGestureRecognizer *)recognizer;

@end 
```

视图控制器.m

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

@synthesize text1, textfieldform;

- (void)viewDidLoad
{
    [super viewDidLoad];
    //textfieldform = [[NSMutableArray alloc] init];
    // Do any additional setup after loading the view, typically from a nib.
    textfieldform = [NSMutableArray arrayWithCapacity:0];
    angle = 180;

    UIPinchGestureRecognizer *pinchGesture = [[UIPinchGestureRecognizer alloc] initWithTarget:self action:@selector(scaleImage:)];
    [blahBlah addGestureRecognizer:pinchGesture];

    UIRotationGestureRecognizer *rotationGesture = [[UIRotationGestureRecognizer alloc] initWithTarget:self action:@selector(rotateImage:)];
    [blahBlah addGestureRecognizer:rotationGesture];

    UIPanGestureRecognizer *pan = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(panGestureAction:)];
    [pan setMaximumNumberOfTouches:1];
    [pan setMinimumNumberOfTouches:1];
    [blahBlah addGestureRecognizer:rotationGesture];

    UITapGestureRecognizer *twoFingersTwoTaps = 
  [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(twoFingersTwoTaps)] ];
[twoFingersTwoTaps setNumberOfTapsRequired:2];
[twoFingersTwoTaps setNumberOfTouchesRequired:2];
[blahBlah addGestureRecognizer:twoFingersTwoTaps];

}

- (void)twoFingersTwoTaps {
  NSLog(@"Action: Delete text, two taps");
} 

-(void)panGestureAction:(UIPanGestureRecognizer *)pan {

    if (pan.state == UIGestureRecognizerStateBegan){
        prevPanPoint = [pan locationInView:blahBlah];
    }

    CGPoint curr = [pan locationInView:blahBlah];

    float diffx = curr.x - prevPanPoint.x;
    float diffy = curr.y - prevPanPoint.y;

    CGPoint centre = textField1.center;
    centre.x += diffx;
    centre.y += diffy;
    textField1.center = centre;

    prevPanPoint = curr;
}

-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer{
    return YES;
}

-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch{

    if([touch.view isKindOfClass:[UIView class]]) {
        return YES;
    }
    return NO;
}

- (void)scaleImage:(UIPinchGestureRecognizer *)recognizer
{
    if (recognizer.state == UIGestureRecognizerStateBegan)
        prevPinchScale = 1.0;

    float thisScale = 1 + (recognizer.scale-prevPinchScale);
    prevPinchScale = recognizer.scale;
    textField1.transform = CGAffineTransformScale(textField1.transform, thisScale, thisScale);
}

- (void)rotateImage:(UIRotationGestureRecognizer *)recognizer
{
    if([recognizer state] == UIGestureRecognizerStateEnded) {

            prevRotation = 0.0;
    } 

    float thisRotate = recognizer.rotation - prevRotation;
    prevRotation = recognizer.rotation;
    textField1.transform = CGAffineTransformRotate(textField1.transform, thisRotate);
}

-(IBAction)undo{
    UITextField *textFieldToRemove = [textfieldform lastObject];
    if (textFieldToRemove) {
        [textfieldform removeObject:textFieldToRemove];
        [textFieldToRemove removeFromSuperview];
    }
}

- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField{ 

    NSLog(@"textFieldShouldBeginEditing");
    return YES;
}
- (void)textFieldDidBeginEditing:(UITextField *)textField{           

    NSLog(@"textFieldDidBeginEditing");
    [textField1  setBackgroundColor:[UIColor colorWithRed:(248/255.0) green:(248/255.0) blue:(255/255.0) alpha:1.0]];
    textField1.borderStyle = UITextBorderStyleRoundedRect;
}
- (BOOL)textFieldShouldEndEditing:(UITextField *)textField{

    NSLog(@"textFieldShouldEndEditing");
    textField.backgroundColor = [UIColor clearColor];
    return YES;
}
- (void)textFieldDidEndEditing:(UITextField *)textField{

    NSLog(@"textFieldDidEndEditing");
    [textField1  setBackgroundColor:[UIColor clearColor]];
    textField1.borderStyle = UITextBorderStyleNone;
}
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string{

    NSLog(@"textField:shouldChangeCharactersInRange:replacementString:");

    if ([string isEqualToString:@"#"]) {
        return NO;
    }
    else {
        return YES;
    }

}
- (BOOL)textFieldShouldClear:(UITextField *)textField{

    NSLog(@"textFieldShouldClear:");
    return YES;
}
- (BOOL)textFieldShouldReturn:(UITextField *)textField{

    NSLog(@"textFieldShouldReturn:");

    if (textField.tag == textfieldform.count) {
        textField1 = (UITextField *)[self.view viewWithTag:textfieldform.count];
        [textField1 becomeFirstResponder];
    }
    else {
        [textField resignFirstResponder];
    }

    return YES;
}

- (IBAction)handleTap2:(UITapGestureRecognizer *)recognizer{

    if (recognizer.state == UIGestureRecognizerStateEnded){
        CGPoint point = [recognizer locationInView:[self view]];
        textField1 = [[UITextField alloc] init];
        textField1.borderStyle = UITextBorderStyleLine;
        textField1.font = [UIFont systemFontOfSize:15];

        CGRect frame ;    
        frame.origin.x = point.x;
        frame.origin.y = point.y; 
        frame.size.width=300;
        frame.size.height=40;

        textField1.frame=frame;

        textField1.autocorrectionType = UITextAutocorrectionTypeNo;
        textField1.keyboardType = UIKeyboardTypeDefault;
        textField1.returnKeyType = UIReturnKeyDefault;
        textField1.clearButtonMode = UITextFieldViewModeWhileEditing;
        textField1.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;    
        textField1.delegate = self;
        textField1.tag = textfieldform.count;
        textField1.font = [UIFont fontWithName:@"Arial" size:30];
        [textfieldform addObject:textField1];
        [blahBlah addSubview:textField1];

        [textField1 addTarget:self action:@selector(wasDragged:withEvent:) forControlEvents:UIControlEventTouchDragInside];

    }

}

- (void)wasDragged:(UIButton *)button withEvent:(UIEvent *)event{
    // get the touch
    UITouch *touch = [[event touchesForView:textField1] anyObject];

    // get delta
    CGPoint previousLocation = [touch previousLocationInView:textField1];
    CGPoint location = [touch locationInView:textField1];
    CGFloat delta_x = location.x - previousLocation.x;
    CGFloat delta_y = location.y - previousLocation.y;

    // move button
    textField1.center = CGPointMake(textField1.center.x + delta_x,textField1.center.y + delta_y);

}

- (void)moveImage:(UIPanGestureRecognizer *)recognizer
{
    CGPoint newCenter = [recognizer translationInView:self.view];
    if([recognizer state] == UIGestureRecognizerStateBegan) {
        beginX = textField1.center.x;
        beginY = textField1.center.y;
    }
    newCenter = CGPointMake(beginX + newCenter.x, beginY + newCenter.y);
    [textField1 setCenter:newCenter];
}

- (void)viewDidUnload{
    [super viewDidUnload];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T00:40:38.553

```
UITextField *textFieldToRemove = [textfieldform objectAtIndex:0];
            if (textFieldToRemove) {
                NSLog(@"baaaaaaam! remove %i", textfieldform.count);
                [textfieldform removeObject:textFieldToRemove];
                [textFieldToRemove removeFromSuperview];
            } 
```

我有点想通了。:)

# jar - 正确解码 zip 条目文件名——CP437、UTF-8 还是？

> ID：13261347
> 
> 赞同：11
> 
> 时间：2012-11-07T00:01:46.817
> 
> 标签：jar, zip, 7zip, zipfile, winzip

[我最近编写了一个名为zipzap](https://github.com/pixelglow/zipzap)的 zip 文件 I/O 库，但我正在努力从任意 zip 文件中正确解码 zip 条目文件名。

现在，[PKWARE 规范](http://www.pkware.com/documents/casestudies/APPNOTE.TXT)指出：

> D.1 ZIP 格式历来仅支持原始 IBM PC 字符编码集，通常称为 IBM Code Page 437...
> 
> D.2 如果未设置通用位 11，则文件名和注释应符合原始 ZIP 字符编码。如果设置了通用位 11，则文件名和注释必须支持 Unicode 标准，版本 4.1.0 或更高版本，使用 UTF-8 存储规范定义的字符编码形式...

这意味着符合标准的 zip 文件将文件名编码为 CP437，除非设置了 EFS 位，在这种情况下文件名是 UTF-8。

不幸的是，似乎很多 zip 工具要么没有正确设置 EFS 位（例如 Mac CLI、GUI zip），要么使用了其他一些编码，通常是默认的系统编码（例如 WinZip？）。如果您知道 WinZip、7-Zip、Info-Zip、PKZIP、Java JAR/Zip、.NET zip、dotnetzip 等如何对文件名进行编码以及它们在*压缩*时将“版本制作者”字段设置为什么，请告诉我.

特别是，Info-Zip 在*解压缩*时会尝试这样做：

*   文件系统 = MS-DOS (0) => CP437
    *   除外：版本 = 2.5、2.6、4.0 => ISO 8859-1
*   文件系统 = HPFS (6) => CP437
*   文件系统 = NTFS (10) 和版本 = 5.0 => CP437
*   否则，ISO 8859-1

**如果我想支持检查或从任意 zip 文件中提取并在没有 EFS 标志的情况下对文件名编码进行*合理*尝试**，我可以寻找什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-11T12:09:37.463

目前情况如下：

*   大多数 Windows 实现使用 DOS (OEM) 编码
*   Mac OS zip 实用程序使用 utf-8，但它不设置 utf-8 位标志
*   *nix zip 实用程序静默使用系统编码

因此，唯一的方法是检查文件名是否包含类似 utf-8 字符的内容（检查 utf8 编码的描述 - 第一个字节应该是 110xxxxx，第二个 - 10xxxxxx 对于 2 字节编码的字符）。如果是正确的 utf8 字符串 - 使用 utf8 编码。如果不是 - 回退到 OEM/DOS 编码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T00:31:46.470

在不使用 EFS 标志的情况下确定文件名是否被编码为 UTF-8 的唯一方法是检查是否在其中一个字符中设置了高位。这*可能*意味着该字符是 UTF-8 编码的。但是，它仍然可能是另一种方式，因为 CP437 中的某些字符设置了高位并且不打算解码为 UTF-8。

我会坚持 PKWARE 应用笔记规范，而不是尝试符合现有的每个已知 zip 应用程序的解决方案。

# r - 使用 tcltk 包制作简单的 R GUI

> ID：13261348
> 
> 赞同：4
> 
> 时间：2012-11-07T00:01:55.427
> 
> 标签：r, function, user-interface, rgui

我正在尝试为我的脚本制作非常简单的 GUI。简而言之，问题看起来像这样：

`dataset`是数据框，我想将一列绘制为时间，并使用简单的 GUI 来选择下一列/上一列。

`dataset <-data.frame(rnorm(10), rnorm(10), rnorm(10))`

`columnPlot <- function(dataset, i){`

`plot(dataset[, i])`

`}`

如何使用不同的`tcltk`通话？`fplot``i`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-09T22:41:32.713

不是你要求的（不`tcltk`相关），但我建议你看看[`shiny`](http://www.rstudio.com/shiny/)RStudio 的新包。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T16:55:32.217

您是否特别喜欢使用 tcltk 的想法？我一直在使用该`gWidgets`软件包进行类似的工作，并取得了一些成功。根据它的 CRAN 站点，“gWidgets 提供了一个独立于工具包的 API，用于构建交互式 GUI”。这个包使用 tcltk 或 GTK2，我一直在使用 GTK2 部分。这是一个带有用于更改`i`. 我还为您的函数添加了一点花哨，因为您提到您将绘制时间序列，所以我制作了 x 轴时间。

```
data<-data.frame(rnorm(11),rnorm(11),rnorm(11))

i = 1

fplot <- function(i, data = data){
  library(ggplot2)
  TimeStart <- as.Date('1/1/2012', format = '%m/%d/%Y')
  plotdat <- data.frame(Value = data[ ,i], Time = seq(TimeStart,TimeStart + nrow(data) - 1, by = 1))
  myplot <- ggplot(plotdat, aes(x = Time, y = Value))+
    geom_line()
  print(myplot)
}

library(gWidgets)
options(guiToolkit = 'RGtk2')

window <- gwindow ("Time Series Plots", visible = T)
notebook <- gnotebook (cont = window)
group1 <- ggroup(cont = notebook, label = "Choose i", horizontal=F)
ichooser <- gspinbutton(cont = group1, from = 1, to = ncol(data), by = 1, value = i, handler = function(h,...){
  i <<- svalue(h$obj)})
plotbutton <- gbutton('Plot', cont = group1, handler=function(h,...){
  fplot(i, data)})
graphicspane1 <- ggraphics(cont = group1) 
```

# python - python re 与 groupdict

> ID：13261349
> 
> 赞同：2
> 
> 时间：2012-11-07T00:02:01.067
> 
> 标签：python

我正在编写一个 python 代码来从 .txt 中删除所有信息。我已经写了一个代码，但总是出现错误： *'NoneType' 对象没有属性'groupdict'*

代码：

```
import re
readfile = open("test.txt")
try:
all_the_text =readfile.read()
m = re.match("(pdflink=[\w\s/]*)author=([\w\s/]*/n)",unicode(all_the_text),flags=re.UNICODE)
m.groupdict()
print m.groupdict()
finally:
readfile.close()
writefile = open('test5.txt','w')
print >> writefile, m.groupdict()
writefile.close() 
```

请帮帮我！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:12:52.803

来自 Python 文档：

`re.match(pattern, string, flags=0)¶ If zero or more characters at the beginning of string match the regular expression pattern, return a corresponding MatchObject instance. Return None if the string does not match the pattern; note that this is different from a zero-length match`

在您的代码中， re.match 返回 None 并将其存储在`m`. `m`也是如此`None`。然后您尝试调用`groupdict`from `m`，您会收到上述错误。因此，您应该先检查是否`m`是`None`，然后再继续处理。

# python - 捕获所有输出以登录 CherryPy

> ID：13261350
> 
> 赞同：1
> 
> 时间：2012-11-07T00:02:19.960
> 
> 标签：python, logging, cherrypy

我的 cherrypy 应用程序（Python 2.6 上的 3.2.2）正在使用 3rd 方库，这些库在内部使用标准日志记录，如下所示：

```
logger = logging.getLogger(__name__)
logger.info("a message from some library") 
```

现在，在我的cherrypy配置中，我有：

```
log.access_file = '/path/access.log'
log.error_file = '/path/error.log' 
```

但只有 CP 消息出现在这两个文件中，而不是任何其他日志记录。但我需要那里的所有日志记录，而不仅仅是 CP 本身内部发布的日志记录。

有没有办法捕获*所有*输出，包括第 3 方日志记录（我假设它进入 stdout/stderr 然后消失，因为该进程是一个分离的守护进程）`/path/error.log`？以某种方式将任意标准输出/标准错误插入 CP 的日志？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T15:08:02.187

这是你要找的吗？全部输出到错误日志中？

```
python yourCherryServer.py &>> /path/error.log 
```

# javascript - jQuery 原型

> ID：13261357
> 
> 赞同：3
> 
> 时间：2012-11-07T00:03:25.920
> 
> 标签：javascript, jquery

根据这个 StackOverflow 答案[jQuery.fn 是什么意思？](https://stackoverflow.com/questions/4083351/what-does-jquery-fn-mean)，中的 fn 属性`jQuery.fn.jquery`是原型属性的别名。我认为这在这两种方法中是相同的，其完整代码如下

`$.fn.map = function()` 和`$.fn.tweets = function()`

那么我的问题是，例如，如果 $.fn.tweets 使用原型创建一个 tweets 方法，那么这段代码`$('tweets').tweets` 是否会调用它......

```
var $tweets = $('#tweets').tweets({
        query: buildQuery(approxLocation),
        template: '#tweet-template'
    }); 
```

如果是这样，它如何触发该方法。**例如，仅在文件加载时创建变量是否会触发该函数，**该函数内部还有其他方法，即查询？谢谢你的帮助

方法的完整代码

```
 $.fn.map = function(method) {
         console.trace();
         console.log(method);
        if (method == 'getInstance') {
            console.log("fn.map");
            return this.data('map');
        }

        return this.each(function() {
            var $this = $(this);
            var map = $this.data('map');

            if (map && MyMap.prototype[method]) {
                 map[method] (Array.prototype.slice.call( arguments, 1 ));
            } else if ( typeof method === 'object' || ! method ) {
                var options = method;
                $this.data('map', new MyMap( this, options ));
            } else {
                $.error( 'Method ' +  method + ' does not exist on jQuery.map' );
            }
        });
    }

   $.fn.tweets = function(method) {

        if ( methods[method] ) {
            return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof method === 'object' || ! method ) {

            return methods.init.apply( this, arguments );
        } else {
            $.error( 'Method ' +  method + ' does not exist on jQuery.tweets' );
        }
    } 
```

**调用这些方法的变量？**

```
 var $tweets = $('#tweets').tweets({
        query: buildQuery(approxLocation),
        template: '#tweet-template'
    });
var $map = $('#map').map({
    initialLocation: approxLocation,
    radius: 1000,
    locationChanged: function(location) {
        $tweets.tweets('setQuery', buildQuery(location));
    }
}); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-07T00:14:45.767

首先，原型只是对象。在这种情况下，是的：

```
jQuery.prototype === jQuery.fn 
```

所以说`jQuery.fn.map = function() {}`就像说`jQuery.prototype.map = function() {}`

当您**实例化一个新的 jquery 对象**时，`$(selector | dom node | ...)`您将返回一个`jQuery`自动继承所有原型方法的对象，包括 map、tweet 等。研究 Javascript 的原型继承模型以及对象原型如何工作`new`

`$`只是一个引用，`jQuery`它返回一个经过特殊修改的**新对象**。`$`是一个返回新对象引用的**函数。**这是一个简化的示例（但您确实应该更多地研究原型继承，已多次重复回答）：

```
var A = function() {
};

A.prototype.doThing = function() {
};

var newObj = new A();

newObj.doThing // this new object has this method because it's on A's prototype 
```

所以`newObj.doThing`就像`$(selector).tweet`

还可以随意[阅读](http://code.jquery.com/jquery-1.8.2.js)jQuery 的源代码并跟踪创建新对象时发生的情况。您可以在顶部附近看到评论下发生的确切情况`// Define a local copy of jQuery`

# windows - Windows 上的 awk - 打印字段 - 引号作为分隔符

> ID：13261359
> 
> 赞同：0
> 
> 时间：2012-11-07T00:03:52.340
> 
> 标签：windows, awk, field, quotes, delimiter

这是提要文件，

```
dfscmd /map "\\SERVER24\dfs\shared\can\Group Pension\Quality Assurance Auditors" "\\serverfile16\bugp-qaaud$" ""
dfscmd /map "\\SERVER24\dfs\userhome\serverfile52_d" "\\serverfile52\userhome_d" ""
dfscmd /map "\\SERVER24\dfs\shared\can\Wealth Management\WM CSC Stats - Support Team, CRT Team & CSR Performance" "\\serverfile48\bucan-WM_CSC_Support_&_CRT_Team_Stats" "" 
```

使用这条线

```
gawk -v FS=""" "{print $2 \";\" $4 }" a.txt 
```

我可以打印，但无法保存输出，

```
C:\>gawk -v FS=""" "{print $2 \";\" $4 }" a.txt   >b.txt
\\SERVER24\dfs\shared\can\Group Pension\Quality Assurance Auditors;\\serverfile16\bugp-qaaud$
\\SERVER24\dfs\userhome\serverfile52_d;\\serverfile52\userhome_d
\\SERVER24\dfs\shared\can\Wealth Management\WM CSC Stats - Support Team, CRT Team & CSR Performance;\\serverfile48\bucan-   WM_CSC_Support_&_CRT_Team_Stats
gawk: (FILENAME=a.txt FNR=3) fatal: cannot open file `>b.txt' for reading (Invalid argument) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:16:24.453

单引号应始终用于包围`awk`的大括号。这会更好：

```
 gawk -v FS=\" '{ print $2 ";" $4 }' a.txt > b.txt 
```

内容`b.txt`：

```
\\SERVER24\dfs\shared\can\Group Pension\Quality Assurance Auditors;\\serverfile16\bugp-qaaud$
\\SERVER24\dfs\userhome\serverfile52_d;\\serverfile52\userhome_d
\\SERVER24\dfs\shared\can\Wealth Management\WM CSC Stats - Support Team, CRT Team & CSR Performance;\\serverfile48\bucan-WM_CSC_Support_&_CRT_Team_Stats 
```

* * *

***编辑：***

如果您使用的是 Windows，您可能还想考虑运行这样的脚本：

```
gawk -f script.awk a.txt > b.txt 
```

内容`script.awk`：

```
BEGIN { FS="\"" }
{ print $2 ";" $4 } 
```

这避免了必须在表达式周围加上引号并产生您需要的结果。HTH。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:16:27.293

```
gawk -v FS=""" "{print $2 \";\" $4 }" a.txt   ">b.txt 
```

# mysql - mysql2 gem 在 OSX 上加载 Rails env 时出错：“找不到符号：_rb_prohibit_interrupt”

> ID：13261360
> 
> 赞同：2
> 
> 时间：2012-11-07T00:04:00.803
> 
> 标签：mysql, ruby-on-rails, ruby, bundle, mysql2

*   我在 OSX 10.7.5

*   我正在设置一个现有的 Rails 3 应用程序

*   我已经安装了 MySQL (v5.5.28) 的 64 位 dmg 包

*   我已将 mysql2 gem (v0.3.11) 作为应用程序包的一部分安装

每当我尝试加载 rails env（倾斜、加载控制台等）时，我都会得到：rake aborted！dlopen（/Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2/mysql2.bundle, 9）：找不到符号：_rb_prohibit_interrupt 引用自：/ Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2/mysql2.bundle 预期在：/Users/daretorant/.rvm/gems/ 中的平面命名空间ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2/mysql2.bundle - /Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/ mysql2-f4d004ac5194/lib/mysql2/mysql2.bundle /Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2.rb:9:in `require' /Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2.rb:9:in`'

…………

我尝试过的事情：

*   其他版本的mysql2

*   全新安装 mysql 本身

*   清洁我的宝石

*   清洁 rvm

*   拔头发

帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-28T17:07:27.310

我刚刚遇到这个问题。帮助我的是安装 64 位版本的`mysql2`gem，如下所示：

```
$ env ARCHFLAGS="-arch x86_64" gem install mysql2 
```

# macos - OSX FSEvent API 和跟踪多个重命名事件

> ID：13261361
> 
> 赞同：6
> 
> 时间：2012-11-07T00:04:09.437
> 
> 标签：macos, cocoa, fsevents

有一个[讨论](https://stackoverflow.com/questions/7300998/tracking-file-renaming-deleting-with-fsevents-on-lion)是连续的*FSEventStreamEventId*可用于检测*kFSEventStreamEventFlagItemRenamed*事件的旧名称和新名称。这似乎在我对基本重命名案例的测试中起作用。但是，这似乎在以下情况下被打破：

*   监视目录**test_dir**的事件
*   文件**A**存在于**test_dir**
*   从 bash 终端发出命令**mv AB;touch C;mv CA** in *test_dir*

这会导致以下事件：

```
2012-11-06 18:13:01.246 test[45080:1603] event [60095818] [10800] [/Users/tim/test_dir/B]
2012-11-06 18:13:01.248 test[45080:1603] event [60095824] [10900] [/Users/tim/test_dir/C]
2012-11-06 18:13:01.253 test[45080:1603] event [60095825] [10800] [/Users/tim/test_dir/A] 
```

事件位 0x10800 =“文件重命名”和 0x10900 =“文件创建/重命名”

（来自 FSEvents.h）

```
kFSEventStreamEventFlagItemCreated = 0x00000100
kFSEventStreamEventFlagItemRenamed = 0x00000800
kFSEventStreamEventFlagItemIsFile = 0x00010000 
```

**在这种情况下，似乎将A**重命名为**B**的事实丢失了。

我希望看到像 A 的 60095817 10800 这样的事件。

任何人都可以确认这种行为吗？如果是这样，是否有人对如何处理此限制有任何想法，而无需维护目录内容的单独表示并重新扫描/比较整个目录？

我正在 OS X 10.8.2 上进行测试。

编辑：刚刚发现另一个[讨论](https://stackoverflow.com/questions/8314348/cocoa-fsevents-kfseventstreamcreateflagfileevents-flag-and-renamed-events)表明这可能是一个更普遍的问题，有多个重命名。

# javascript - 返回变量并再次使用它的正确语法（javascript）

> ID：13261362
> 
> 赞同：0
> 
> 时间：2012-11-07T00:04:28.230
> 
> 标签：javascript, function, return

我有一个非常简单的东西，它不起作用。怎么了？根据我读过的教程，这应该输出4 ...

```
function sum(a,b) {
    var result = a + b;
    return result;
    }

sum(2,2);        
var test = sum();

alert(test); // shouldn't this return "4"? 
```

[链接到 JSFiddle](http://jsfiddle.net/8dKgB/2/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:05:56.623

```
function sum(a,b) {
    var result = a + b;
    return result;
}

var test = sum(2,2);

alert(test); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:06:11.203

改变这个：

```
sum(2,2);        
var test = sum(); 
```

对此：

```
var test = sum(2,2); 
```

第一个代码在技术上没有错，只是没有做你想做的事。您正在使用适当的值调用 sum 函数，但从未将其返回值设置为任何变量，因此它只会被丢弃。您似乎认为该值将“坚持”到函数上，但事实并非如此。（不过，一些 BASIC 语言可以使它看起来像这样。也许这就是您的误解的来源。）

你的第二个电话基本上相当于

```
var test = sum(null, null); 
```

当你连接两个空值时，你再次得到空值。

# c++ - 为什么我不能将方法链接到构造函数？

> ID：13261364
> 
> 赞同：6
> 
> 时间：2012-11-07T00:04:33.913
> 
> 标签：c++, qt, object

我正在尝试为文件设置权限。我以为我可以在处理`QFile`对象时节省一行代码，就像这样。

```
QFile("somefile.txt").setPermissions(QFile::WriteOther); 
```

它编译并运行，但没有做任何事情。当然，当我以**正确**的方式做到这一点时，它就奏效了。（毫不奇怪，那里。）

```
QFile tempFileHandle("somefile.txt");
tempFileHandle.setPermissions(QFile::WriteOther); 
```

我认为这是了解 C++ 语法的好机会。我会接受我原来的方式行不通，但*为什么呢？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T08:42:07.477

好吧，我不知道 QFile 也不知道你的观察结果是什么，但它可能归结为 QFile 的析构函数中所做的任何事情。

第一个示例创建临时对象。我猜它的构造函数创建了 somefile.txt。然后 setPermissions 设置您在该文件上指定的任何内容。现在的问题是析构函数做了什么：

*   它可能会删除文件，而您什么也看不到
*   它可能（我没想到但谁知道）将文件设置为只读
*   恢复到一些默认值

在另一个示例中，您创建了命名变量，该变量在超出范围之前不会被销毁，您甚至可以将对象从磁盘上的文件中分离出来，这可能会使析构函数对该文件的影响无效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T07:59:03.783

好的，你说它编译并运行但没有做任何事情。setPermissions() 甚至被调用，你检查过吗？在我看来，编译器已经优化了整行，因为您纯粹是在处理临时对象。

# php - Xampp imagecreatefrompng() 产生损坏的图像

> ID：13261366
> 
> 赞同：1
> 
> 时间：2012-11-07T00:05:16.860
> 
> 标签：php, imagecreatefrompng

我看过其他几个类似的问题，但不幸的是，他们都没有帮助解决我遇到的问题。

这是脚本。

```
 <?php
    // returns a PNG graph from the $_GET['per'] variable
    $per = imagecreate(302,7);
    $background = imagecolorallocate($per, 0xFF, 0xFF, 0xFF);
    $foreground = imagecolorallocate($per, 0x00, 0x8A, 0x01);
    $border = imagecolorallocate($per, 0x99, 0x99, 0x99);
    if ($_GET['per'] > 0)
    {
        $grad = imagecreatefrompng("images/grad.png");
        $per2 = imagecopy($per, $grad, 1, 1, 0, 0, ($_GET['per'] * 3), 5);
        imagerectangle($per, 0, 0, 301, 6, $border);
    }

    header("Content-type: image/png");
    imagepng($per,NULL,5);
?> 
```

我已经检查了 GD 支持，所以我不确定问题是什么。如果我只构建一个简单的条而不使用图像，它会正常工作，但是当我尝试使用图像构建时，它只会显示损坏图像的图片。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:18:47.023

您需要确保它`per`存在，否则这将引发未定义的索引错误

```
if ($_GET['per'] > 0) 
```

应该是这个

```
if (isset($_GET['per']) && $_GET['per'] > 0) 
```

或者如果你想确保它不为空并且存在，你可以这样做

```
if (!empty($_GET['per']) && $_GET['per'] > 0) 
```

因为该`empty()`函数还在检查变量是否为空之前检查变量是否存在。

# javascript - 无法让 javascript 弹出闰年警报

> ID：13261370
> 
> 赞同：0
> 
> 时间：2012-11-07T00:05:40.683
> 
> 标签：javascript, date

```
<button onclick="isleap(1992)">Try it</button>​

function isleap(year);
{
var yr=document.getElementById("year").value;
if ((parseInt(yr)%4) == 0)
{
 if (parseInt(yr)%100 == 0)
 {
 if (parseInt(yr)%400 != 0)
 {
 alert("Not Leap");
 return "false";
 }
  if (parseInt(yr)%400 == 0)
  {
  alert("Leap");
    return "true";
    }
  }
  if (parseInt(yr)%100 != 0)
  {
    alert("Leap");
    return "true";
  }
 }
 if ((parseInt(yr)%4) != 0)
 {
    alert("Not Leap");
    return "false";
 } 
} 
```

​</p>

[http://jsfiddle.net/kcyCd/](http://jsfiddle.net/kcyCd/)

在弄清楚如何让代码弹出带有闰年答案的警报框时遇到问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T00:10:25.143

一个简单的`isLeapYear`功能是：

```
function isLeapYear(year) {
  var d = new Date(year, 1, 29);
  return d.getMonth() == 1;
} 
```

它只是查看 2 月 29 日是否发生在给定的年份。你应该能够做到：

```
function isLeapYear2(year) {
  return !!Date.parse(year + '-02-29');
} 
```

基于解析无效日期应返回 NaN，其类型转换为 false，但并非所有浏览器都正确实现[`Date.parse`](http://ecma-international.org/ecma-262/5.1/#sec-15.9.4.2). 例如

```
isLeapYear2('2001'); // false in Firefox, true in IE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:09:21.167

```
<button onclick="alert(isleap(1992));">Try it</button> 
```

如果您提醒从 isleap 函数返回的值，它应该可以工作。我不保证弹出的答案是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T00:35:25.620

您的小提琴不起作用，因为您保留了将 JS 放置在`onload`处理程序中的默认 jsfiddle 设置，这意味着您的函数不是全局的，并且无法从 inline`onclick`属性访问 - 这应该在下拉列表中更改在左侧到“不换行”设置之一。此外，如果调用该函数，该函数要做的第一件事是尝试从具有 id 的元素中读取值，`"year"`而您没有这样的元素。您当前忽略该`year`参数。

话虽如此，您的功能比它需要的要复杂得多。`parseInt()` *您可以通过在开始时执行一次*来大大简化您的代码，然后如果要测试的值不是整数，则执行您需要执行的任何操作，然后您只需一行即可执行闰年测试。

此外，如果您`parseInt()`在用户输入上使用，如果您想避免由于以前导零开头的输入被视为八进制而导致的模糊错误，则*必须指定一个基数作为第二个参数。*所以`parseInt(year, 10)`。

最后，为什么要返回字符串`"true"`和`"false"`？返回实际的布尔值是否更有意义，以便您可以将函数调用为：

```
if (isleap(1992)) {
   // do something
} 
```

无论如何，这是一个简短的版本：

```
function isleap(year) {
    year = parseInt(year,10);
    if (isNaN(year)) {
       alert("Not a number");
       return false;
    }
    if (year%4===0 && (year%100!=0 || year%400===0)) {
       alert("Leap");
       return true;
    } else {
       alert("Not leap");
       return false;
    }
} 
```

演示：http: [//jsfiddle.net/kcyCd/1/](http://jsfiddle.net/kcyCd/1/)

如果您不需要显示警报，您可以将其缩短：

```
function isleap(year) {
    year = parseInt(year,10);
    if (isNaN(year)) {
       alert("Not a number");
       return false;
    }
    return (year%4===0 && (year%100!=0 || year%400===0));
} 
```

显然，如果您不需要测试无效值，它将是单行的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T00:08:42.107

您将一个值传递给函数，然后在 DOM 中寻找一个不存在的不同值。

此外，由于您合并了真/假条件，并且您使用的是字符串而不是布尔值，因此代码很难遵循 - 这很糟糕，因为 if(isleap(1992)) 在您的代码中将始终为真。

简化：

```
function isleap(year)
{
    if(year % 4 == 0 || (year % 100 == 0 && year % 400 == 0)){
        return true;
    }
    return false;
} 
```

# razor - 将 MVC-4 数据绑定到 Knockout.js foreach

> ID：13261371
> 
> 赞同：3
> 
> 时间：2012-11-07T00:05:50.910
> 
> 标签：razor, knockout.js, asp.net-mvc-4

我们的 Web 应用程序中有一个表单，它在一个地方要求用户输入一个值列表。我们使用 Razor 和 knockout.js 编写了表单的这一部分，以便列表的每个值都有一个文本框，类似于[本教程](http://learn.knockoutjs.com/#/?tutorial=collections)。我们如何将这些文本框数据绑定到我们的 MVC 模型？

这是我们的表格：

```
@model OurProject.Models.Input.InputModel
@{
    ViewBag.Title = "Input";
}
<h2>
    Inputs</h2>
<div id="inputKOApp">
    @using (Html.BeginForm())
    {
        <!-- snip - lots of part of our form that work correctly -->
        <div class="row-fluid">
            <div class="control-group">
                <div class="span8 control-label">
                    @Html.LabelFor(model => model.POSTransactionCodes)
                </div>
                <div class="controls">
                    <!-- These are the textboxes we would like to bind to MVC -->
                    <ul class="pull-right" data-bind="foreach: POSTransactionCodes">
                        <li>
                            <input data-bind="value: code" />
                            <a href="#" data-bind="click: $root.removePOSTransactionCode">Delete</a></li>
                    </ul>
                    <button class="pull-right" data-bind="click: addPOSTransactionCode">
                        Add another POS Transaction Code</button>
                    @Html.ValidationMessageFor(model => model.POSTransactionCodes, null, new { @class = "help-inline" })
                </div>
            </div>
        </div>
        <!-- snip - more cshtml that is irrelevant to the problem -->
</div>
        <input type="submit" value="Submit" />
    }
</div>
<script type="text/javascript" src='~/Scripts/jquery-1.8.2.min.js'></script>
<script type="text/javascript" src='~/Scripts/knockout-2.1.0.js'></script>
<script type="text/javascript" src='~/Scripts/OP/OP.js'></script>
<script type="text/javascript" src='~/Scripts/OP/Input/OP.Input.Input.Form.js'></script>
<script type="text/javascript" src='~/Scripts/OP/Input/OP.Input.Input.Data.js'></script>
<script type="text/javascript">
    var inputApp = $('#inputKOApp')[0];
    OP.Input.Form.init(inputApp);
</script> 
```

这是我们的 knockout.js 脚本 OP.Input.Input.Form.js：

```
extend(OP, 'OP.Input.Form');
OP.Input.Form = function (jQuery) {
    var TransactionCodeView = function () {
        var self = this;
        self.code = "";
    };

    //The ViewModel for the page
    var ViewModel = function () {
        var self = this;        

        //Fields
        /* snip - lots of fields that work as expected */
        self.POSTransactionCodes = ko.observableArray([]); //is a list of transaction codes

        //Set up with initial data
        /* I'm guessing that we won't need this function anymore since MVC will populate
         * everything for us, but I'll leave it in until I'm far enough along to know
         * I won't need to gut lots of stuff */
        self.initialize = function () {
            var c = function (data, status, response) {
            /* snip - lots of fields that work as expected */
                if (status === "success") {
                    if(data.POSTransactionCodes != null) ko.utils.arrayPushAll(self.POSTransactionCodes, data.POSTransactionCodes);
                    self.POSTransactionCodes.valueHasMutated();
                } else {

                }
            };
            OP.Input.Data.GetInput(c);
        }

        //When saving, submit data to server
        self.save = function (model) {
            var c = function (data, status, response) {
                if (status === "success") {

                } else {
                }
            };
            OP.Input.Data.SaveInput(model, c);
        }

        //Modifying POSTransactionCodes array
        self.removePOSTransactionCode = function (POScode) {
            self.POSTransactionCodes.remove(POScode);
        }

        self.addPOSTransactionCode = function () {
            self.POSTransactionCodes.push(new TransactionCodeView());
        }
    };

    //Connect KO form to HTML
    return {
        init: function (elToBind) {
            var model = new ViewModel();
            ko.applyBindings(model, elToBind);
            model.initialize();
        }
    };
} ($); 
```

这是我们的 MVC 模型：

```
namespace OurProject.Models.Input
{
    public class InputModel : IModel
    {
        //Snip - lots of properties that aren't interesting for this problem
        [Required]
        [DisplayName("POS Transaction Codes")]
        public List<double> POSTransactionCodes { get; set; }

        public InputModel()
        { }

        /* I ommitted a few other methods that
         * aren't relevant to this problem. */
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T06:11:26.370

我看不到您如何将数据发送回服务器，但您需要以允许模型绑定的方式命名您的输入：

如果您要绑定到列表/集合，您的输入应该是这样的名称：

```
<input type="text" name="CollectionPropertyName[index]" /> 
```

[您可以在本文](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)中阅读有关模型绑定到列表的信息

因此，您只需要为您的输入生成正确的名称：

```
<input data-bind="value: code, attr: { name: 'POSTransactionCodes[' + $index() + ']' }" /> 
```

您应该注意，上述解决方案可能仅在您使用提交按钮时才有效，如果您`form-urlencoded`以 json 格式发送数据，则可能需要调整序列化逻辑以使模型绑定器满意：

在这种情况下，您的 json 应该是这样的：

```
{
   //...
   POSTransactionCodes: [ 1 , 3  ]
   //..
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-10T03:23:36.997

感谢 nemesv 的回答，让我明白这一点。

但我需要有用于 jquery 验证的“正常”名称和 id 属性。所以我想出了编写自己的数据绑定器的想法。

```
ko.bindingHandlers.nameId = {
    update: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        var value = valueAccessor(),
            allBindings = allBindingsAccessor();
        var valueUnwrapped = ko.utils.unwrapObservable(value);
        var bindName = $(element).data('bind-name');
        bindName = bindName.replace('{0}', valueUnwrapped);
        $(element).attr({name : bindName, id : bindName});
    }
}; 
```

并在 html 中使用

```
<input
      data-bind="value: qty, nameId: $index"
      data-bind-name="inventory[{0}].qty" /> 
```

[jsfiddle](http://jsfiddle.net/8g2hr/3/)

# matlab - MATLAB：使用 find 函数获取数组中某个值的索引

> ID：13261372
> 
> 赞同：1
> 
> 时间：2012-11-07T00:05:51.437
> 
> 标签：matlab, floating-point

我制作了一个双精度数组，当我想使用 find 命令搜索数组中特定值的索引时，这会产生一个空矩阵，这不是我想要的。我认为问题在于数组读数中未显示的值和/或小数位的精度。

命令：

```
peaks=find(y1==0.8236) 
```

阵列读数：

```
y1 =

Columns 1 through 11

0.2000    0.5280    0.8224    0.4820    0.8239    0.4787    0.8235    0.4796    0.8236    0.4794    0.8236

Columns 12 through 20

0.4794    0.8236    0.4794    0.8236    0.4794    0.8236    0.4794    0.8236    0.4794 
```

输出：

```
peaks =

Empty matrix: 1-by-0 
```

我尝试使用命令

```
format short 
```

但我猜这只会截断显示的值，而不是数组中的实际值。

如何使用 find 命令给出索引数组？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T00:35:28.580

默认情况下，Matlab 中数值矩阵的每个元素都使用浮点双精度存储。正如您在问题中所猜测的那样`format short`，`format long`只是更改了显示的格式，而不是数字的实际格式。

因此，如果`y1`是使用类似的东西创建的`y1 = rand(100, 1)`，并且您想在`y1`using中找到特定元素`find`，则需要知道要查找的元素的浮点双精度的确切值 - 这取决于您的应用程序可能是非琐碎的。当然，如果只包含类似的值，`peaks=find(y1==0.8236)`将返回空矩阵`y1``0.823622378...`

那么，如何解决这个问题呢？这取决于您的应用程序。一种方法是将所有值截断为`y1`您想要使用的给定精度。有趣的是，关于这个主题的 SO matlab 问题在大约 12 小时前吸引了两个很好的答案，请参阅[此处](https://stackoverflow.com/questions/13252868/how-change-percision-of-float-point-in-matlab-treat-5-145556666-as-5-24)了解更多信息。

如果你决定走这条路，我会推荐这样的东西：

```
a = 1e-4 %# Define level of precision
y1Round = round((1/a) * y1); %# Round to appropriate precision, and leave y1 in integer form
Index = find(y1Round == SomeValue); %# Perform the find operation 
```

请注意，我以整数形式使用`find`命令。`y1Round`这是因为整数在使用浮点双精度时精确存储，因此您无需担心浮点精度。

解决此问题的另一种方法是使用`find`对错误的一些容忍度，例如：

```
Index = find(abs(y1 - SomeValue) < Tolerance); 
```

选择哪条路取决于你。但是，在采用这些方法中的任何一种之前，我会仔细检查您的应用程序，看看它是否可以以某种方式重新制定，这样您就不需要从一组“实”。那将是最理想的结果。

**编辑：**这个问题的其他两个答案中提倡的代码比我的第二种方法更整洁 - 所以我已经相应地改变了它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T00:34:51.713

用浮点数测试相等性几乎总是一个坏主意。您可能想要做的是测试以查看哪些数字*足够接近*目标值：

```
peaks = find( abs( y - .8236 ) < .0001 ); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-07T00:32:29.020

问题确实在于精度。您看到显示的数组不是实际数组，因为实际数组中每个数字都有更多位数。改变格式只是改变了数组的显示方式，所以并不能解决问题。

您有两个选择，要么修改数组，要么修改您要查找的内容。修改您要查找的内容可能会更好，因为这样您就不会更改实际值。

因此，您可以寻找接近度，而不是寻找相等性（因此您要搜索的数字与数组中的数字之间的差异最多是一些小的 epsilon）：

```
peaks = find( abs(y1-0.8236) < epsilon ) 
```

通常，当您处理浮点数时，请始终尽量避免精确比较并使用一些错误阈值，因为这些数字的表示是有限的，因此它们通常以小的不准确性存储。

# ruby-on-rails - 在 ERB 块中的字符串内包含 ERB 定界符

> ID：13261376
> 
> 赞同：4
> 
> 时间：2012-11-07T00:06:47.340
> 
> 标签：ruby-on-rails, ruby, erb

我正在编写一个显示代码和输出的样式指南。它目前的结构使得代码只需要描述一次，并以原始版本和解释版本显示，如下所示：

```
<% code = <<PLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR
<div>
  #{ image_tag 'image.png' }
</div>  
PLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR
%>

<%= raw code %>
<%= content_tag :pre, code, class: "prettyprint linenums" %> 
```

这很棒，而且相当容易维护。问题出现在 rails helpers 上，就像`image_tag`上面的例子一样。视图示例正确显示了 div 中的图像，代码示例显示了相关的 HTML。在这种情况下，相关的 HTML 包含一个锚标记 -`image_tag`方法的结果，而不是调用本身。

我更喜欢代码示例来显示辅助方法，而不是它们的结果。我可以通过在文件中指定示例代码并渲染或读取文件来完成这项工作。如上所述，我更愿意通过在变量中指定代码来完成这项工作，但我似乎无法让 ERB 分隔符在 erb 块内的字符串内工作。即使是最简单的情况`<% foo = '<%= bar %>' %>`也根本不起作用。我尝试过使用[官方文档](http://ruby-doc.org/stdlib-1.9.3/libdoc/erb/rdoc/ERB.html)中的详细信息（例如），`<%% %%>`但没有取得多大成功。`% %`

我能找到的关于此事的唯一信息是[here](http://markmail.org/message/gpz5bpqvbclogo7a)， using `<%= "<" + "%=" %> link_to <%= image.css_tag.humanize %> <%= "%" + ">" %> %>`，这在这个用例中不起作用（如果有的话）。

那么，有没有办法在 ERB 字符串中指定一个包含 ERB 结束分隔符 ( `%>`) 的字符串，还是我使用稍微笨拙的文件读取方法卡住了？谢谢！

**编辑：**

我想最终得到的是这个的工作版本：

```
<%# Idealized code - does not work %>
<% code = <<PLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR
<div>
  <% image_tag 'image.png' %>
</div>  
PLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR
%> 
```

所以这`<%= raw code %>`将（继续）输出：

```
<div>
  <img src="/images/image.png" alt="Image" />
</div> 
```

并`<%= content_tag :pre, code, class: "prettyprint linenums" %>`会输出：

```
<pre class="prettyprint linenums">
  <div>
    <% image_tag 'image.png' %>
  </div>  
</pre> 
```

而不是当前使用变量时所做的事情，即：

```
<pre class="prettyprint linenums">
  <div>
    <img src="/images/image.png" alt="Image" />
  </div>
</pre> 
```

我希望用户能够复制代码示例并将其粘贴到新视图中，而无需将 HTML 转换回生成它们的帮助程序。我认为我基本上需要的是一个替代的 ERB 分隔符，就像`'`和`"`（或什至`%q{}`）为字符串而变化一样。似乎即使最终的 ERB 分隔符出现在字符串内部，它实际上也被作为块的结尾处理。最简单的例子在`<% foo = '<%= bar %>' %>`某种程度上展示了我想要完成的事情。在生成器中，您可以使用`<% foo = '<%%= bar %>' %>`（或类似的东西），告诉它不要立即作为 ERB 处理。这在从文件中读取时，甚至在纯 rb 文件（如助手）中都可以正常工作，但在这种情况下，将它放在视图中是最有意义的，因为它旨在由我们的设计师。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T03:33:25.310

如果我对您的理解正确，那么您真正的问题是，就插值而言，heredoc 的行为类似于双引号。因此，您所需要的只是一个行为类似于单引号的引用机制。Ruby 有很多字符串引用机制，特别是我们有`%q{...}`：

```
<% code = %q{
<div>
  #{ image_tag 'image.png' }
</div>  
} %> 
```

如果您愿意，可以使用其他分隔符：`%q|...|`,`%q(...)`等。当然还有一些变化，但至少您不必担心插值问题。

如果你真的想使用heredoc，你可以[用引号指定heredoc终止符，](http://ruby-doc.org//docs/ProgrammingRuby/html/language.html#UD)相应的引用样式将应用于内容：

```
<% code = <<'PLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR'
<div>
  #{ image_tag 'image.png' }
</div>  
PLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR
%> 
```

中的单引号`<<'PLACE...'`指定单引号规则（即无插值）适用于heredoc 的内容。

* * *

当然，这些东西都不能像这样与嵌入式 ERB 一起使用：

```
<% code = %q{
<div>
  <% ... %>
</div>  
} %> 
```

因为 ERB 解析器会将第一个`%>`视为外部`<% code...`部分的结束分隔符。不要害怕，我想我有一个计划，可以在不涉及严重黑客或过多工作的情况下工作。

**一些准备工作**：

*   Rails 使用[Erubis](http://www.kuwata-lab.com/erubis/)进行 ERB 处理。
*   Erubis 允许您使用其构造函数的[选项](http://www.kuwata-lab.com/erubis/users-guide.02.html#tut-pattern)[更改分隔符。`:pattern`](http://www.kuwata-lab.com/erubis/users-guide.02.html#tut-pattern)
*   Rails 使用[Tilt](https://github.com/rtomayko/tilt)和[Sprockets](https://github.com/sstephenson/sprockets)来处理模板处理管道，这些允许您以正确的顺序发生正确的事情`pancakes.js.coffee.erb`。

使用上述方法，您可以添加自己的模板格式，即带有不同分隔符的 ERB，并且您可以让 Rails 使用这种新格式来处理您的“特殊”部分，然后正常的 ERB 处理可能会弄得一团糟。

首先，您需要连接 Tilt。如果你看一下`lib/tilt/erb.rb`你的 Tilt 安装，你会`Tilt::ErubisTemplate`在底部看到 Erubis 的东西。您应该能够子类化`Tilt::ErubisTemplate`并提供`prepare`覆盖，例如，将`:pattern => '<!--% %-->'`选项和平底船添加到超类。然后在 Rails 初始化程序中使用 Tilt 和 Sprockets 注册它，如下所示：

```
Tilt.register(Your::Template::Subclass, 'klerb') # "kl" for "kludge" :)
Rails.application.assets.register_engine('.klerb', Your::Template::Subclass) 
```

现在您的应用程序应该能够处理`.klerb`带有`<!--% ... %-->`模板分隔符的文件。您还可以使用类似名称将您的 klerb 与 erb 链接起来`pancakes.html.erb.klerb`，文件将在 ERB 之前通过 klerb；这意味着像这样的模板（在一个名为 的文件中`whatever.html.erb.klerb`）：

```
<!--% code = <<PLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR
<div>
  <% image_tag 'image.png' %>
</div>  
PLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR
%-->
<!--%= "code = escape_the_erb_as_needed(%q{#{code}})" %-->
<% do_normal_erb_stuff %> 
```

会做正确的事。

当然，您需要一个助手来实现该`escape_the_erb_as_needed`功能；一些小实验应该可以帮助您理清需要逃避什么以及以什么方式逃避。

所有这些可能看起来有点复杂，但实际上非常简单。我使用 Tilt 和 Sprockets 添加了自定义模板处理步骤，结果证明它非常简单；弄清楚要做哪些简单的事情需要一些工作，但我已经为你完成了这项工作：

1.  `Tilt::Template`子类，你可以通过捎带得到这个`Tilt::ErubisTemplate`。
2.  通过调用 Tilt 注册`Tilt.register`。
3.  通过调用 Sprockets 注册`Rails.application.assets.register_engine`。
4.  ...
5.  利润。

# python - 如何为单个 URL 参数传递多个值？

> ID：13261377
> 
> 赞同：20
> 
> 时间：2012-11-07T00:07:15.187
> 
> 标签：python, django, url, urlencode

是否可以在不使用您自己的分隔符的情况下为单个 URL 参数传递多个值？

我想要做的是后端期望输入参数`urls`具有一个或多个值。它可以设置为单个或多个 URL。有什么方法可以设置 urls 参数以便它可以有多个值？我不能使用自己的分隔符，因为它可以是值本身的一部分。

示例：http://example.com/?urls=[value,value2...]

`urls`参数设置为 just`http://google.com`或可设置为`http://google.com` `http://yahoo.com ...`。在后端，我想将每个 url 作为单独的值处理。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-07T00:10:45.020

```
http://.../?urls=foo&urls=bar&... 
```

...

```
request.GET.getlist('urls') 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-07T00:11:05.210

以下可能是最好的方法 - 即，不要指定 URL 的分隔列表，而是使用可以多次指定相同参数名称的事实，例如：

```
http://example.com/?url=http://google.co.uk&url=http://yahoo.com 
```

然后通过 URL 列表使用和检索`request.GET.getlist('url')`

# java - 如何将时间存储在变量中？

> ID：13261388
> 
> 赞同：2
> 
> 时间：2012-11-07T00:09:00.093
> 
> 标签：java, datetime, time, milliseconds

我的一个类`Event`将有一个名为`timeStamp`. 现在，我有另一个类，它将`timeStamp`根据其他一些在这里并不真正相关的算法来设置。

我的问题是我应该将其存储在哪种**类型**`timeStamp`中？从我迄今为止的研究来看，我的印象是它应该以毫秒为单位计算，因此将它存储在一个`double`可能的范围内。

基本上，`Clock`我的课程以以下格式模拟时间：hh:mm:ss。但是，由于它是我正在开发的离散事件模拟，它会从一个事件跳转到另一个事件，它由`timeStamp`值确定，即每个事件对象都有一个`timeStamp`存储在`PrioityQueue`. 所以我考虑`timeStamp`以与. 还是我应该让时钟以毫秒为单位模拟时间？`Clock``TimeStamp``timestamp`

您对此有何看法？我不确定实现这一点的最有效/最干净的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:15:58.060

将毫秒存储在`long`.

您可以使用[`DateTime`](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html)Joda Time 中的类对结果数字执行各种复杂的操作。 [此重载](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html#DateTime%28long%29)允许您将毫秒值直接插入`DateTime`对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T00:19:06.850

当日期存储为*自纪元以来的毫秒*数时，您应该使用`long`.

不需要 a `double`，因为您对毫秒的分数不感兴趣。

您不能使用 an，`int`因为最大 int 值仅大到以毫秒为单位表示大约一个月。

你可以得到这样的值：

`long millisSinceEpoch = Calendar.getInstance().getTimeInMillis();`

# android - 我需要配置多行编辑文本，但不要留下换行符 ENTER

> ID：13261390
> 
> 赞同：1
> 
> 时间：2012-11-07T00:09:15.663
> 
> 标签：android, android-edittext

> **可能重复：**
> [防止在 EditText 上输入键，但仍将文本显示为多行](https://stackoverflow.com/questions/6070805/prevent-enter-key-on-edittext-but-still-show-the-text-as-multi-line)

我需要配置多行编辑文本，但不要留下换行符 ENTER，只有字符。

```
EditText editText = new EditText(context);
editText.setSingleline(false);
editText.setInputType( ???? ); 
```

谢谢

# jquery - Bootstrap 弹出框剪辑到包含 div 的范围

> ID：13261393
> 
> 赞同：8
> 
> 时间：2012-11-07T00:09:31.410
> 
> 标签：jquery, html, css, twitter-bootstrap, popover

我希望将弹出框包含在可折叠的 div 中：http: [//jsfiddle.net/nathan9/qgyS7/](http://jsfiddle.net/nathan9/qgyS7/)。但是，popover 似乎仅限于 div 的范围。有没有办法防止剪裁？

```
<a href="#toggle" data-toggle="collapse" data-target="#toggle" onClick="return false;">Toggle collapse</a>
<div id="toggle" class="collapse" style="background-color: yellow">
    Content of collapsible div. Click for popover: 
    <i class="icon-info-sign" id="info"></i>
</div> 
```

...

```
<script>
    $('#info').popover({ html: true, placement: 'left', title: 'Popover', content: "<ul><li>The</li><li>popover</li><li>is</li><li>clipped.</li></ul>" });
</script> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-03T13:12:47.750

使用计时器始终是一项有风险的业务。我使用了 Mike Lucid 的变体，它监听可折叠事件，显示和隐藏。

[这是一个工作小提琴](http://jsfiddle.net/CdNuX/2/)

代码如下：

```
$(document).ready(function(){
  $('#toggle')
    .on('shown', function(evnt) {
      $(evnt.target).addClass('visible');  
    })
    .on('hide', function(evnt) {
      $(evnt.target).removeClass('visible');  
    })
  ;   
}); 
```

如果您希望您的可折叠在加载时可见，请不要忘记在您的可折叠 div 中**添加**类**并**使其**可见**。

 ****编辑**

从 Bootstrap 2.3 开始，工具提示和弹出框有了一个新`container`选项。如果您将容器设置为“body”，您的工具提示和弹出框将不会被剪裁。[这是一个工作小提琴](http://jsfiddle.net/snT9P/1/)。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T00:36:03.133

添加`.collapse.in {overflow:visible}`似乎可以解决问题

[http://jsfiddle.net/ZArX7/](http://jsfiddle.net/ZArX7/)

编辑：以上答案仅适用于 chrome

这是一个延迟添加类的jquery。

```
 $('#toggle_link').click(function() {
    if($('#toggle').hasClass('in')){
        $('#toggle').removeClass('visible');
    }else{
        setTimeout(function() {
            $('#toggle').addClass('visible');
        }, 1000);
    }
}); 
```

此解决方案有效

[http://jsfiddle.net/fnP7y/](http://jsfiddle.net/fnP7y/)**

# symfony - Symfony2 资产（带树枝）sass（s css 过滤器）导入和观察

> ID：13261394
> 
> 赞同：2
> 
> 时间：2012-11-07T00:09:34.143
> 
> 标签：symfony, twig, sass, watch, assetic

我正在尝试使用一个主文件，我只使用 include sass 语法来按我想要的顺序包含其他 scss 文件，它工作正常，但只有问题资产似乎不会关注包含的文件，我必须手动执行转储，要么对我用于包含的主文件进行一些修改。使用纯sass手表时，我不希望出现这样的麻烦。

可能有人可以建议解决此问题的方法吗？

# ssh - vagrant 无法连接虚拟机

> ID：13261402
> 
> 赞同：4
> 
> 时间：2012-11-07T00:10:41.983
> 
> 标签：ssh, virtual-machine, vagrant

我正在运行 vagrant up 命令以连接到 VM，并且在运行此命令时出现下面提到的错误。

> 我尝试了几个步骤以在 gui 模式打开的情况下运行它，但 GUI 模式本身并没有打开任何东西。

运行此命令时，一个单独的命令提示符会打开并自行关闭。之后我得到以下错误。谁能给我一些想法，我该如何解决这个问题..

**详细信息：** 操作系统：Windows 7 遵循的步骤是：1\. `vagrant box add box1 c:/vmBoxFolder`- 运行良好 2\. `vagrant init box1`- 运行良好 3\. `vagrant up`- 失败

**主机文件条目：** 127.0.0.1 localhost ::1 localhost

错误 ：

```
C:\blog>vagrant up
[default] VM already created. Booting if its not already running...
[default] Running any VM customizations...
[default] Clearing any previously set forwarded ports...
[default] Forwarding ports...
[default] -- ssh: 22 => 2222 (adapter 1)
[default] Cleaning previously set shared folders...
[default] Creating shared folders metadata...
[default] Booting VM...
[default] Waiting for VM to boot. This can take a few minutes.
[default] Failed to connect to VM!
Failed to connect to VM via SSH. Please verify the VM successfully booted
by looking at the VirtualBox GUI. 
```

谢谢，幸运。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:59:16.643

在`Vagrant Up`您的 Windows 系统尝试连接到 SSH 期间。如果您在命令行中键入：

```
set VAGRANT_LOG=INFO 
```

您可能会看到它失败并尝试几次。它看起来像这样：

```
INFO ssh: Connecting to SSH: 127.0.0.1:2222 
```

发生这种情况是因为超时设置为 10。这可以通过在 Vagrantfile 中放置以下内容来修改：

```
config.ssh.timeout = 300 
```

您可以使用任何您喜欢的数字，但我建议您使用 100 以上的数字。

资料来源：

1.  [这家伙有一些有用的故障排除信息。](http://devops.me/2011/10/10/vagrant-tricks-and-troubleshooting/)
2.  [Vagrantfiles 的 Vagrant 文档](http://docs.vagrantup.com/v1/docs/config/ssh/timeout.html)
3.  [Vagrantfile SSH 超时的 Vagrant 文档](http://docs.vagrantup.com/v1/docs/config/ssh/timeout.html)
4.  [用于调试的 Vagrant Docs](http://docs.vagrantup.com/v1/docs/debugging.html)
5.  [故障排除时间（保持微笑）](http://i.imgur.com/spyALqO.gif)

# java - 从表单提交中获取两个值

> ID：13261404
> 
> 赞同：1
> 
> 时间：2012-11-07T00:10:53.610
> 
> 标签：java, html, jsp, servlets

因此，假设我在与数据库中某个 ID 相关的输入字段中有信息。

因此，例如，如果我想更改某个对象的特性，而该对象只能通过数据库中的 ID 访问，我不仅需要知道该对象的 ID，还需要知道用户输入的值。我想到的一种方法是隐藏输入字段，所以

```
<input type="text" name="valueEntered" />
<input type="hidden" name="id" value="theId"/>
<input type="submit" value="update"/> 
```

所以这意味着当我访问我的 servlet 中的结果时，我应该得到一个值数组

```
request.getParameter("valueEntered"); 
```

如果我用 name="id" 进行类似的调用，那么我还应该得到一个 id 数组。然后，我可以假设索引 0 处的 id 是索引 0 处具有特征的对象的 id。

但是，是否有另一种方法可以做到这一点，例如 id 和输入的值之间已经存在映射？例如，我不想依赖索引 i 处的 id 指的是在索引 i 处具有特征的产品的假设。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:25:56.890

您可以将 id 添加到值的输入字段的名称中，如下所示：

```
<input type="text" name="valueEntered.theId" />
<input type="hidden" name="id" value="theId"/>
<input type="text" name="valueEntered.secondId" />
<input type="hidden" name="id" value="secondId"/> 
```

这样，字段的顺序无关紧要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T06:34:28.810

假设你有这个带有每个文本的 html 代码，隐藏的有相同的名称。

```
<input type="text" name="valueEntered" />
<input type="hidden" name="id" value="1"/>

<input type="text" name="valueEntered" />
<input type="hidden" name="id" value="2"/>

<input type="text" name="valueEntered" />
<input type="hidden" name="id" value="3"/>

<input type="submit" value="update"/> 
```

现在您可以将所有文本字段值和隐藏字段值设置为：

```
String textValues[] = getParameterValues("valueEntered");
String hiddenValues[] = getParameterValues("id"); 
```

现在您可以从第一个文本字段值`textValues[0]`
和第一个隐藏字段值`hiddenValues[0]`

等等...

# c# - Eclipse 类似 Visual Studio 2010 C# 中的控制台

> ID：13261405
> 
> 赞同：2
> 
> 时间：2012-11-07T00:10:55.763
> 
> 标签：c#, visual-studio-2010

我将使用 Visual Studio 2010 在 C# 中编写一些代码。问题是每次我运行程序时它都会出现在命令提示符中。

我想将程序的输出放在控制台中，就像在 Eclipse 中一样。`System.Diagnostics.Debug.Write("abc");`这不起作用，因为如果我查看输出，我会看到比我想要的更多的信息。*我只想查看将在命令提示符中显示的数据*。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:33:50.140

我认为您希望关闭详细输出日志记录，以便只有您`Debug.Write's`将被写入输出窗口。

为此，您转到工具 > 选项 > 调试 > 输出窗口 > 并关闭详细日志记录：

![在此处输入图像描述](../Images/0695808eb33e90ad8bab5dea55c2b3b6.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:58:45.313

如果要保留所有输出，可以将 Debug.Print 重定向到输出到即时窗口。

工具 -> 选项 -> 调试 -> 常规 | 单击将所有输出窗口文本重定向到立即窗口。

这并不意味着所有内容都将输出给它，只是您在代码中指定的输出以及抛出的任何异常消息。它少了很多话，并且仍然保留了所有标准消息的输出窗口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T00:18:35.293

查看“工具->选项->调试->输出窗口”-您应该能够根据自己的喜好减少跟踪量。

旁注：通常“程序的输出”是指 Console.WriteXXXX 方法的结果，所以也许你正在寻找完全不同的东西。

# python - 如何使用来自另一个函数的变量？

> ID：13261407
> 
> 赞同：1
> 
> 时间：2012-11-07T00:10:56.970
> 
> 标签：python

这是我的代码：

```
def Area():
    area = pi * radius * radius
    pi = 3.14
    radius = diameter * 2

def cost():
    diameter = eval(input("diamater: "))
    print ("Area is", area)
cost() 
```

它说区域未定义，但我有一个名为区域的变量！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T00:11:57.250

`area`是函数中的局部变量，这意味着在该函数之外，您无法访问它。您应该阅读范围和功能。这里最好的解决方案是从你的函数返回值，并将参数传递给其他函数。

您似乎对代码的评估方式缺乏了解。代码作为一系列语句依次执行，一个接一个。变量只有在定义后才能使用。在`Area()`中，您是在尝试使用变量后定义变量。这没有意义。

另请注意，这`eval()`是从字符串中获取数字的不好方法（它很慢，不是为此目的而设计的，并且允许执行任意代码），请`int()`改用。

另请注意，[PEP-8](http://www.python.org/dev/peps/pep-0008/)建议保留`CapWords`用于类，并使用`lowercase_with_underscores`用于函数名称，因此`Area()`可能应该是`area()`. 这将有助于保持代码的一致性和可读性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:22:41.963

我建议看看这门课程[https://class.coursera.org/programming1-2012-001/class/index](https://class.coursera.org/programming1-2012-001/class/index)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T00:12:40.820

你应该：

1.  `Area()` *退货* `area`；_
2.  调用`Area()`from `cost()`，适当使用其结果。

最后，内部语句的顺序`Area()`看起来确实很奇怪。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T00:13:23.370

变量被本地化到方法的范围内。如果要使用方法中的值，`return`它：

```
def area(diameter=1):
    pi = 3.14
    radius = diameter * 2
    area = pi * radius * radius
    return area

# Calling the value
def cost():
    diameter = eval(input("diamater: "))
    print ("Area is", area(diameter)) 
```

还值得一提的是，在您的原始代码中：

*   `diameter`没有在任何地方定义。您的意图是将其传递给方法；我在这里提供了这个提示。
*   您的变量顺序不正确。它们必须在使用*前*声明。

# java - Can someone correct the way I understand this code because the output is different than what I think?

> ID：13261414
> 
> 赞同：2
> 
> 时间：2012-11-07T00:12:01.447
> 
> 标签：java, output

```
public class Test{
   public static void main(String[] args){
      int[] a = {3, 2, 5, 21}; // created an array with 4 elements
      int b,c;

      for (b=0; b<=2; b++)//for loop that will have 3 iterations  
      {
        if (a[b] < a[b+1])
        {
           c=a[b];//this
           a[b] = a[b+1];//is 
           a[b+1] = c;//swapping
        }
      }

      for(b=0; b<4; b++)
      {
        System.out.println(a[b]);
      }
   }
} 
```

This outputs :

> 3
> 5
> 21
> 2

What I got when I was writing it down:

> 3
> 5
> 21
> 21

Could someone tell me how to approach it in my thoughts?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T00:21:50.310

Well if you really want to just trace out the program you could go through each iteration of that first `for`-loop by hand (the second loop just prints the contents of `a`).

Before the loop starts, `a` holds

```
{3, 2, 5, 21}
```

* * *

**First iteration (`b = 0`):**
`a[0]` *is not* less than `a[1]` so we do nothing.

* * *

**Second iteration (`b = 1`):**
`a[1]` *is* less than `a[2]`, so we swap them. Now `a` holds

```
{3, 5, 2, 21}
```

* * *

**Third iteration (`b = 2`):**
`a[2]` *is* less than `a[3]`, so we swap them. Now `a` holds

```
{3, 5, 21, 2}
```

which is what gets printed subsequently.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:18:12.170

Well, the code always outputs the initial elements of `a`, possibly permuted. Thus your expectation can't possibly have been correct, since it lost `2` and made `21` appear twice.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T00:20:15.090

Well you got lost at the 3rd iteration so I'll start there.

The array is `{3, 5, 2, 21}`. `b = 2`

`if (a[b] < a[b+1])` is equivalent to `if (2 < 21)`, this is `true`, so...

`c=a[b];//this` -> `c = 2`

`a[b] = a[b+1];//is` -> `a[2] = 21`

`a[b+1] = c;//swapping` -> `a[2+1] = 2`

so now `a[2] = 21` and `a[3] = 2` and the final array is:

`{3, 5, 21, 2}`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T00:24:07.707

Each time you run the full outer loop you will end up with the next smallest element at the end of the array. So as you're only running the loop once you end up with 2 (being the first smallest element) at the end of the array.

As others have mentioned, if you want to make this a complete sort then you need more iterations of the main loop to complete the sort (n-1, where n is the length of the array, so in this case you would need to run the loop 3 times).

# objective-c - 使用带有块参数的 NSURLConnection 异步 URL 请求

> ID：13261415
> 
> 赞同：1
> 
> 时间：2012-11-07T00:12:02.810
> 
> 标签：objective-c, objective-c-blocks

我正在尝试适当地使用 NSURLConnection 的 sendAsynchronousRequest 方法，但我遇到了 block 参数的问题。我在调用上方构建了块，并使用 __block 变量尝试检索其中收集的数据。我已经确认块内的数据是正确的，所以块工作得很好，让块数据的检索成为问题。我在方法末尾的赋值和返回语句没有得到正确的值，我认为这是因为在赋值发生之前块尚未完成执行。如何在不中断主线程的情况下“等待”块完成执行后再执行分配？

```
- (NSData *) sendAsynchronousURLRequest: (NSMutableURLRequest *)request withResponse: (NSURLResponse *)response andError:(NSError *)error
{
    // Prepare the block handler.
    __block NSURLResponse *retrievedBlockResponse;
    __block NSError *retrievedBlockError;
    __block NSData *retrivedBlockData;
    void(^requestHandler)(NSURLResponse*, NSData*, NSError*) =
    ^(NSURLResponse *blockResponse, NSData *blockData, NSError *blockError)
    {
        retrievedBlockResponse = blockResponse;
        retrivedBlockData = blockData;
        retrievedBlockError = blockError;

        // NOTE: Correct data is here...
        NSLog(@"Data Inside Block:\n%@", [NSMutableDictionary DictionaryFromJSONData:blockData errorReport:nil]);
    };

    // Send the asynchronous request (operationQueue initialized elsewhere in class).
    [NSURLConnection sendAsynchronousRequest:request queue:operationQueue completionHandler:requestHandler];

    // NOTE: Reference to data cannot be established here!
    // Establish references to block variables and return NSData object.
    response = retrievedBlockResponse;
    error = retrievedBlockError;
    return retrivedBlockData;
} 
```

# android - 带有 Fragment 的 Android Gui

> ID：13261422
> 
> 赞同：0
> 
> 时间：2012-11-07T00:12:57.123
> 
> 标签：android, android-layout, user-interface, android-fragments, android-actionbar

我只是想知道是否有人可以为我提供一些帮助或向我展示一些代码，这些代码将显示带有可滚动内容的选项卡视图，例如水平和垂直滚动内容的脉冲应用程序。我让它完全使用 TabActivity 和 Activity 类工作，但我很难将它转换为使用片段和或 ActionBarTab 设置，因为 TabActivity 已经被贬值了。它一直困扰着我，我一直在阅读 API，但我只是好奇是否有任何简单的示例可以让我看到如何使用 FragmentActivity 和 Tab Manager 或 ActionBar 进行设置。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:18:11.980

您可以使用[ActionBarSherlock](http://actionbarsherlock.com/)。它非常整洁且向后兼容。

# c# - SharpDX：从 DataStream 初始化 Texture2D 失败（尽管 Texture1D 工作正常）

> ID：13261427
> 
> 赞同：2
> 
> 时间：2012-11-07T00:13:23.567
> 
> 标签：c#, directx, textures, directx-11, sharpdx

我正在尝试从内存数据创建一个 SharpDX.Direct3D11.Texture2D，但总是得到一个 SharpDXException（HRESULT：0x80070057，“参数不正确。”）。为此，我使用了 Texture1D，之前可以毫无问题地创建它。

我已将代码简化为仍然产生异常的示例：

```
using (var device = new Device(DriverType.Hardware, DeviceCreationFlags.Debug)) {
    // empty stream sufficient for example
    var stream = new DataStream(16 * 4, true, true);

    var description1D = new Texture1DDescription() {
        Width = 16,
        ArraySize = 1,
        Format = Format.R8G8B8A8_UNorm,
        MipLevels = 1,
    };
    using (var texture1D = new Texture1D(device, description1D, new[] { new DataBox(stream.DataPointer) })) {
        // no exception on Texture1D
    }

    var description2D = new Texture2DDescription() {
        Width = 8,
        Height = 2,
        ArraySize = 1,
        MipLevels = 1,
        Format = Format.R8G8B8A8_UNorm,
        SampleDescription = new SampleDescription(1, 0),
    };
    using (var texture2D = new Texture2D(device, description2D, new[] { new DataBox(stream.DataPointer) })) {
        // HRESULT: [0x80070057], Module: [Unknown], ApiCode: [Unknown/Unknown], Message: The parameter is incorrect.
    }
} 
```

在不传递数据的情况下创建纹理可以正常工作。有人可以告诉我如何修复 Texture2D 初始化吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-07T01:24:24.967

您需要将纹理 2D 的行跨度传递到 DataBox。就像是：

```
new DataBox(stream.DataPointer, 8 * 4) 
```

或者以更通用的方式：

```
new DataBox(stream.DataPointer, description2D.Width
            * (int)FormatHelper.SizeOfInBytes(description2D.Format)) 
```

# vba - 在 Excel VBA 中从“此工作表”中选择到末尾

> ID：13261428
> 
> 赞同：1
> 
> 时间：2012-11-07T00:13:24.010
> 
> 标签：excel, vba, excel

我正在用[excel](/questions/tagged/excel "显示标记为“excel”的问题")建立一个报告。

*   完成步骤是选择大部分工作表（“封面”页面右侧的所有工作表，包括封面本身）并将它们打印为 PDF。
*   工作表列表可能会有所不同。

我目前正在手动执行此操作，但如果您知道正确的命令，它似乎可以自动化。

是否可以按照以下方式做一些事情？

```
Sheets(Array(Sheets("Cover")..Sheets(Worksheets.Count())).Select
ActiveSheet.ExportAsFixedFormat 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T00:41:43.490

我不认为有一个单一的衬里。

```
Sub Tester()

    Dim i As Long, fnd As Boolean

    For i = 1 To ActiveWorkbook.Sheets.Count
        With ActiveWorkbook.Sheets(i)
            If .Name = "Cover" Then
                fnd = True
                .Select
            Else
                If fnd Then .Select False
            End If
        End With
    Next i

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T02:00:38.660

如果您输入一组工作表位置，您可以在一行中完成，即

```
Sheets(Application.Transpose(Application.Evaluate("=ROW(" & Sheets("Cover").Index & ":" & Sheets(Sheets.Count).Index & ")"))).Select 
```

**这个怎么运作**

1.  如果`Cover`是工作表位置 12 并且总共有 20 个工作表，则 `("=ROW(" & Sheets("Cover").Index & ":" & Sheets(Sheets.Count).Index & ")")))`等于 `"=ROW("12:20")`
2.  `Application.Evaluate`生成一个包含 {12,13,14 ... 20} 的二维数组
3.  `Application.Transpose`将此转换为已处理的一维数组`Sheets(1D Array).Select`

# xpath - 定位器和选择器有什么区别？

> ID：13261435
> 
> 赞同：0
> 
> 时间：2012-11-07T00:14:18.873
> 
> 标签：xpath, selenium, phpunit

当我为 PHPUnit 编写测试脚本时，我阅读了很多关于选择器和定位器的内容，但我真的不知道有什么区别。

有谁知道区别？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T07:07:18.377

Selenium 使用所谓的定位器来查找和匹配需要与之交互的页面元素。Selenium 中包含 8 种定位器策略：

```
Identifier
Id
Name
Link
DOM
XPath
CSS
UI-element 
```

这里的 CSS 定位器策略使用 CSS 选择器来查找页面中的元素。您对这些还有什么疑问？

# c# - 将 LINQ 附加到 C# 中的现有数据源/网格视图

> ID：13261444
> 
> 赞同：0
> 
> 时间：2012-11-07T00:15:04.597
> 
> 标签：c#, asp.net, linq, gridview

我的 .aspx 页面中有以下内容：

```
<asp:GridView ID="Table1" runat="server" AutoGenerateColumns="False"    BorderColor="Black" OnRowCreated="Table1_RowCreated" OnRowDataBound="Table1_RowDataBound" CellPadding="3" CellSpacing="0" DataSourceID="Table1DataSrc" DataKeyNames="Field1">
<Columns>
<asp:BoundField DataField="Field1" HeaderText="Field1" SortExpression="Field1">
     <ItemStyle HorizontalAlign="Left" Font-Size="8" Wrap="false" />
     <HeaderStyle CssClass="header" Font-Size="8" />
 </asp:BoundField>
 </Columns>
 </asp:GridView> 
```

gridview 有一个加载几个字段的数据源。在我后面的 C# 代码中，我有以下函数，它运行 LINQ 查询来处理存储过程（在与我的其他数据源不同的服务器上）

```
 private void RenderTables()
    {
        SqlDataAdapter adapter = new SqlDataAdapter();
        DataTable dt = new DataTable();

        using (SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString))
        {
            conn.Open();
            SqlCommand cmd = new SqlCommand("sp_special", conn);
            cmd.CommandType = System.Data.CommandType.StoredProcedure;
            cmd.Parameters.AddWithValue("@AmIY", "Y");
            adapter.SelectCommand = cmd;
            adapter.Fill(dt);
            adapter.Dispose();
            conn.Close();
        }
        var enumvar = dt.AsEnumerable();
        var query = from x in enumvar
                    orderby x.Field<string>(3)
                    select new 
                    { 
                        Field3 = x.Field<string>(3),
                        Field4 = x.Field<int>(4),
                    };
        //I do some data manipulation using LINQ, but omitted here
        //do something with query.....
    } 
```

如何将新列 Field3 和 Field4 添加到我的 Gridview 并绑定这些新记录？我不想在任一服务器上的临时表中存储任何内容

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T07:50:54.063

它会像这样工作......

```
<asp:BoundField DataField="Field3" HeaderText="Field3" SortExpression="Field3"> 
<asp:BoundField DataField="Field4" HeaderText="Field4" SortExpression="Field4"> 
```

# asp.net - 公共属性有多个具有相同签名的定义

> ID：13261447
> 
> 赞同：0
> 
> 时间：2012-11-07T00:15:14.577
> 
> 标签：asp.net, vb.net, sdk, dynamics-crm-2011

我正在编写一个应用程序来在内部 Web 应用程序和 Microsoft Dynamics CRM 2011 实例之间传输数据。我使用 Dynamics CRM SDK 附带的 CrmSvcUtil 生成了早期绑定的实体类，并具有以下参数：

> crmsvcutil /l:vb /url:http://nameofserver/MicrosoftDynamics/XRMServices/2011/Organization.svc /out:myorganizationcrmsdktypes.vb /username:username /password:password /domain:domain

然后，我重命名了项目中现有的标准 sdk 输出文件，并添加了使用上述命令生成的文件。然后我构建了项目并开始收到许多错误，如下所示：

> 公共属性 account_activity_parties As System.Collections.Generic.IEnumerable(Of ActivityParty)' 具有多个具有相同签名的定义。

任何想法为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:17:21.220

好吧，我想通了......我会在这里发布解决方案，以防万一其他人遇到它。我重命名了我原来的早期绑定实体类 myorganizationcrmsdktypes-old.vb 并留在了项目中。显然该项目是从这两个文件构建的，这导致了重复。

# git - 更改 git 存储库的默认目录

> ID：13261452
> 
> 赞同：1
> 
> 时间：2012-11-07T00:15:51.610
> 
> 标签：git, path, repository

是否可以更改 git 查找项目的默认/根目录，以便您可以像这样克隆项目：

```
git clone git@myserver.com:project.git 
```

而不是这样：

```
git clone git@myserver.com:/var/www/html/project.git 
```

我`git --git-dir=<path>`在帮助页面中看到过，但它似乎只对那个特定的命令生效，而不是一个全局设置——即使它做了我想要它做的事情。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:26:00.587

当您使用 ssh 路径时，它总是从给定用户的主目录开始。因此，要使问题中的示例正常工作，您只需将`git`用户的 HOME 目录设置为`/var/www/html`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:24:08.843

使用 git 协议时，可以通过给出选项在服务器上进行`git daemon`设置。`--base-path`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T02:22:32.800

好吧，在所有其他之前：您使用 scp 样式的表示法，标准 URL 将更好地进行通信

回到问题：是的，你[可以做到](http://www.kernel.org/pub/software/scm/git/docs/git-clone.html#URLS)

> 如果您想为它们使用不同的格式（这样您使用的 URL 将被重写为有效的 URL），您可以创建表单的配置部分：

```
 [url "<actual url base>"]
            insteadOf = <other url base> 
```

在你的例子中，它将是

```
 [url "myserver.com:/var/www/html/"]
            insteadOf = myserver.com 
```

甚至

```
 [url "git@myserver.com:/var/www/html/"]
            insteadOf = myserver: 
```

用于使用 URL`myserver:project.git`

# python - Numpy 将 j, j+1, j+2 设置为 a

> ID：13261455
> 
> 赞同：0
> 
> 时间：2012-11-07T00:16:07.263
> 
> 标签：python, numpy

是否有一种短代码有效的方法可以将两个数组“粘合”在一起，这样如果数组的长度不同，那么粘合的产品必须使得较长的值填充在较小的值之间，直到新产品具有与两个数组的长度之和相同的长度？或者：有没有办法创建一个x = [ajjjbjjj]的数组，也就是说，取值为[ab]的数组，通过在该数组的每个元素之间填充3个js来创建一个新的数组：[ajjjb ]

由于我事先知道产品的大小，因此有明显的方法可以通过循环执行此操作，但我怀疑手头必须有一个更“numpyic”的解决方案。

当我想“粘合”的两个数组大小相同并且产品是 [ajbjcj] 时，这很容易做到，即每个其他数组，如下所示：

```
np.append(np.zeros((10,1)),np.ones((10,1)),1).reshape(2*10)
array([ 0.,  1.,  0.,  1.,  0.,  1.,  0.,  1.,  0.,  1.,  0.,  1.,  0.,
    1.,  0.,  1.,  0.,  1.,  0.,  1.])
but you cannot do
np.append(np.zeros((10,1)),np.ones((20,1)),1).reshape(20+10) 
```

如果问题不够清楚，我深表歉意，请告诉我可以澄清哪些部分，我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:58:12.903

假设`len(A) == n`and是 的倍数`len(B) == N`，即有一个整数，这样, 你可以这样做：`N``n``m``N = m*n`

```
import numpy as np
A = np.zeros(10)
B = np.ones(20)

n = len(A)
C = np.concatenate([A.reshape(n, 1), B.reshape(n, -1)], axis=1)
C = C.ravel() 
```

这几乎就是您在问题中的内容，但诀窍是将 B 重塑为 (n, m) 而不是 (N, 1) 即 (10, 2) 而不是 (20, 1) 在这种情况下。`-1`in`reshape`是“whatever will make it work”的简写，它是一种懒惰的做事方式`B.reshape(n, len(B)//n)`。

根据您的问题，似乎数组 B 可能只是同质数组（即`all(B == j)`），在这种情况下您可以这样做：

```
import numpy as np
A = np.zeros(10)
j = 1.

C = np.zeros([10, 3])
C[:, 0] = A
C[:, 1:] = j
C = C.ravel() 
```

# java - HttpServletRequest如何获取数组的参数

> ID：13261457
> 
> 赞同：1
> 
> 时间：2012-11-07T00:16:24.713
> 
> 标签：java

我知道在 PHP 中我们可以做这样的事情

```
$_POST['x']['y'] or $_GET['x']['y'] 
```

获取一个参数，但这是如何在 Java 中使用 HttpServletRequest.getParameter();

谢谢

# asp.net-mvc-3 - 导入前导零的 3 位字段

> ID：13261460
> 
> 赞同：1
> 
> 时间：2012-11-07T00:16:35.720
> 
> 标签：asp.net-mvc-3, c#-3.0, import-from-excel, oledbdataadapter

ASP.NET、C#、MVC 3、代码优先项目

我正在尝试从 Excel 电子表格中导入数据。我已将所有单元格格式化为文本。
导入工作表中的示例行如下。

```
Account             Card               ThreeCode  Route  
04562954830287127   32849321890233127  183        154839254 
04562954830287128   32849321890233128  233
04562954830287129   32849321890233129  082
04562954830287130   32849321890233130  428 
```

当我在调试中运行并深入了解 ds DataSet 时，Account 和 Card 列作为字符串导入，3-Digit 和 Route 列作为双精度导入。问题出现在数据行 3 中以 0 (082) 开头的 3 位数字。它作为 System.DBNull 导入并且为空。我需要能够导入带前导零的 3 位代码。有没有办法强制导入为所有字符串或解决此问题的另一种方法？我在网上搜索并没有找到解决方案。这将从浏览器运行，因此与本地计算机上的注册表、dll 或 ini 文件无关。导入代码如下。预先感谢您的任何帮助。

```
public ActionResult ExcelToDS(string Path = "C;\File.xls")
{ 
  string strConn = "Provider= Microsoft.Jet.OLEDB.4.0;" + "Data Source=" + Path + "; " + "Extended Properties=Excel 8.0;";

  OleDbConnection conn = new OleDbConnection(strConn);
  conn.Open(); string strExcel = "";
  OleDbDataAdapter myCommand = null;
  DataTable dt = new DataTable();
  strExcel = "select * from [Import$]";
  DataSet ds = null; 
  myCommand = new OleDbDataAdapter(strExcel, strConn);
  ds = new DataSet(); myCommand.Fill(ds, "table1"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:37:55.613

啊，是的，Excel 驱动程序的乐趣。发生的情况是它从数据类型的前十行中做出决定，该格式之外的任何内容都变为空。

解决方案是使用更强大的第三方驱动程序，通常会花费一些东西，或者将注册表项设置为对所有行进行全面采样，而不是默认的 8 行。

在此处查看 TypeGuessRows 的链接 [http://www.connectionstrings.com/excel](http://www.connectionstrings.com/excel)

HKLM\Software\Wow5432Node\Microsoft\Jet\4.0\Engines\Excel 将值 TypeGuessRows 设置为零

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T15:18:36.047

似乎没有办法使这项工作始终如一。我想出的解决方法是将 1000 添加到 Excel 工作簿中的 ThreeCode 列。然后，您可以将数据导入数据集。然后当数据被读出时，您只需去掉“1”前缀。这是我的内联方法。

```
public static string last3(this string instring)
{ int len = instring.Length - 3; string outstring = instring.Substring(len, 3); return outstring; } 
```

您可以在代码中调用：

```
card.3Dig = code.last3(); 
```

'card' 和 '3dig' 是要填充的类和字段。“代码”是 4 位数据集数据。

# android - 如何跨多个 AOSP 项目创建补丁？

> ID：13261462
> 
> 赞同：1
> 
> 时间：2012-11-07T00:17:07.320
> 
> 标签：android, android-source

[此处](http://source.android.com/source/submit-patches.html)记录的过程用于对单个项目（又名 git repo）进行更改。

但是我所做的更改（实现单个新功能）跨越多个项目，是否可以创建一个补丁来执行此操作，或者是否需要将其分解为单独的相互依赖的补丁？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T09:05:30.230

我认为你应该将你的补丁分成每个项目的补丁。这就是我为什么这么认为的逻辑。每个 Android 项目都有自己的 .git 目录，即这些项目位于不同的 git 存储库中。Repo 工具只是对 git 命令的补充，即它不为您提供新功能。因此，您无法创建跨越项目的补丁（因为它们未连接）。因此，对于受新功能影响的每个 AOSP 项目，您需要将补丁分成单独的补丁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-07-20T16:34:04.570

要创建项目范围的差异，请使用以下命令： `repo diff > /path/to/store/patch/all-changes.diff`

接下来，还可以`repo forall -p -c git status`用来检查每个项目的状态。

`repo forall -p -c git diff`将显示每个项目的差异。

甚至我也在试图弄清楚如何为单个项目生成补丁。但是，如果您了解`AOSP`来源，那么所有项目都来自`aosp_root/.repo/manifests/default.xml`

如果你尝试类似的东西`repo forall -p -c git diff > /path/to/patch/change.diff`，这个文件将包含所有的补丁。我还没有弄清楚如何提取`-p`部分，打印项目名称（通常是 aosp_root 内的相对路径），并将其转换为补丁名称。

但是，这些东西在带有一些脚本的 bash 环境中确实不难。哎呀，我认为 repo 也是开源的，这意味着你甚至可以自己修改它！

如果您查看此清单，您应该注意到项目的解释方式与 git repo 项目相同，这些项目很容易克隆和复制补丁。虽然与 git 非常相似，但 AOSP 文件夹结构因设备、SOM 和 SOM 而异。由于路径和其他不同之处，实际创建单个项目变得更加困难。

我熟悉的一件事是使用`splitpatch`linux 机器上的工具来拆分补丁。但是，这个工具和其他工具一样，会发现拆分AOSP补丁，因为许多文件具有相同的名称，例如，如果您`Android.mk`跨多个项目进行更改，则补丁拆分器很难理解这种结构，因此认为修改了同一个文件一遍又一遍。

如果您参考 AOSP 文档，您会发现大量信息。现在，您将需要使用非传统搜索技术来实际找到其中的大部分。Google 在网络上提供的 AOSP 文档不足以理解所有内容。这只是一个起点。

实际文档位于特定项目中。如果您查看`Readme`该项目或`docs/`文件夹下的文件，那么您可能会发现更相关的内容。

说它没有很好的文档记录很容易，但实际上问题在于曝光和组织。有大量可用的文档，发现它经常是问题所在。

# android - 如何在Android中隐藏一些拨出电话号码

> ID：13261463
> 
> 赞同：1
> 
> 时间：2012-11-07T00:17:12.700
> 
> 标签：android, broadcastreceiver

> **可能重复：**
> [我可以以编程方式拨打匿名电话吗？](https://stackoverflow.com/questions/10526007/can-i-programmatically-place-an-anonymous-phone-call)

我想在拨出电话中隐藏电话号码。我尝试使用 BroadCastReceiver 来完成，我可以替换号码但不能隐藏。

```
public class OutgoingCallReceiver extends BroadcastReceiver {

    private static final String TAG = "OutCallReceiver";

    @Override
    public void onReceive(Context context, Intent intent) {
        String orginalNumber = intent.getStringExtra(Intent.EXTRA_PHONE_NUMBER);
                Log.d(TAG, ">>>>> orginalNumber:" + orginalNumber);

        //This does not work
        //intent.putExtra(Intent.EXTRA_PHONE_NUMBER, "");

        String resultData = super.getResultData();
        Log.d(TAG, ">>>>> resultData:" + resultData);

                //This makes end call.
                //this.setResultData("");
    }

} 
```

我必须更换拨出电话屏幕吗？有没有办法实现它。请帮我。提前致谢。

# android - 在 Android 上创建另一个文件夹

> ID：13261466
> 
> 赞同：0
> 
> 时间：2012-11-07T00:17:23.640
> 
> 标签：android, directory

现在已经两天了，我被困在一个我似乎无法解决的常见而简单的问题上（而其他人却是）：

**在 Android 上的 SD 卡上创建文件夹！！！**是的！！！

我在这里红了很多帖子，很多教程似乎都在说同样的事情：

*   使用外部文件夹路径 + /yourFolderName 创建一个字符串
*   创建一个将路径作为参数传递的新文件
*   调用 mkdir()（或 mkdirs()）就可以了
*   完毕！

您可以在旁边检查 SD 卡是否已安装、可读、可写，当然不要忘记在您的 Manifest.xml 中放入 WRITE_EXTERNAL_STORAGE 的权限，但请注意，它必须设置为清单的直接子级，而不是应用程序！！！

好吧，这似乎对我不起作用。

folder_creation 代码在 onCreate() 内部，我正在尝试调用 MediaScannerConnection 来测试文件是否存在，但它在 OnScanCompleteListener 上返回 null - 但我不确定我是否以正确的方式使用它。

应用程序运行良好（启动默认相机活动，然后返回主活动），但未创建文件夹！（现在我只想创建里面什么都没有的文件夹）

也许是与我的包名中包含“example”一词的包名有关的问题？（我在某处红了一些相关的东西......）

有什么问题？请给我一个提示，建议，一些东西......

我正在使用 minSdkVersion = 8 在带有 Eclipse 的 Mac 1.7.5 上构建，并在带有 2.3.5 (sdkVersion = 10) 的 HTC Wildfire S 上进行测试。在非 root 设备上使用 ES File Manager 1.6.1.6 检查

这是代码的主要部分让我发疯......

我会很高兴知道我能做些什么......提前谢谢你！

```
myPath = Environment.getExternalStorageDirectory().getAbsolutePath() + File.separator
                + "myFolder";

        File newDirectory = new File(myPath);
        Log.v("judy says", newDirectory.toString());
        newDirectory.mkdir(); // this doesn't work because "no directory" is displayed in the logCat window
        if (!newDirectory.exists()) {
            newDirectory.mkdir(); 
            Log.v("no, no, no", "no directory");
        }
MediaScannerConnection.scanFile(this,
            new String[] { newDirectory.toString() }, null,
            new MediaScannerConnection.OnScanCompletedListener() {
                public void onScanCompleted(String path, Uri uri) {
                    Log.i("ExternalStorage", "Scanned " + path + ":");
                    Log.i("ExternalStorage", "-> uri=" + uri);
                }
            }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:32:12.617

如果你想创建一个目录“/mnt/sdcard/somedir/newdir”，这可行

```
 File temp = new File (Environment.getExternalStorageDirectory (),
                "somedir" + File.separator + "newdir");
        if (!temp.exists ())
            temp.mkdirs (); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T08:41:45.480

好的，我解决了：简单地使用“使用权限”而不是“权限”，问题是我很难在manifest.xml中编写它，而不是使用图形界面，这样我可以使用内置列表来选择一个许可...

如果我感到无聊，真的很抱歉......我希望这对某人有用。

# c++ - 使用 mbsnrtowcs 将多字节转换为 Widechar

> ID：13261468
> 
> 赞同：0
> 
> 时间：2012-11-07T00:17:34.387
> 
> 标签：c++, unicode, utf-8

我正在尝试将多字节（UTF）字符串转换为 Widechar 字符串，而 mbsnrtowcs 总是失败。这是输入和预期的字符串：

```
char* pInputMultiByteString = "A quick brown Fox jumps \xC2\xA9 over the lazy Dog.";
wchar_t* pExpectedWideString = L"A quick brown Fox jumps \x00A9 over the lazy Dog."; 
```

特殊字符是版权符号。

当我使用 Windows MultiByteToWideChar 例程时，此转换工作正常，但由于该 API 在 linux 上不可用，我必须使用 mbsnrtowcs - 这是失败的。我也尝试过使用其他角色，但总是失败。唯一的期望是，当我仅使用基于 ASCII 的输入字符串时，mbsnrtowcs 可以正常工作。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T12:40:23.053

UTF 不是多字节字符串（尽管 Unicode 字符确实会使用超过 1 个字节来表示）。多字节字符串是使用特定代码页来表示字符的字符串，其中一些将使用多个字节。

由于您正在组合 ANSI 字符和 UTF 字符，因此您应该使用 UTF8。

因此，尝试将 UTF 转换为`wchar_t`（在 Windows 上是 UTF16，在 linux 上是 UTF32）`mbsnrtowcs`只是无法完成。

如果您使用 UTF8，您应该为此查看 UNICODE 处理库。[对于大多数任务，我建议使用来自http://utfcpp.sourceforge.net/](http://utfcpp.sourceforge.net/)的 UTF8-CPP

您可以在 Wikipedia 上阅读有关 UNICODE 和 UTF8 的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:38:40.277

MultiByteToWideChar 有一个参数，您可以在其中指定代码页，但 mbsnrtowcs 没有。在 Linux 上，您是否在您的语言环境中设置了 LC_CTYPE 以指定 UTF-8？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T22:50:31.327

解决方案：默认情况下，每个 C 程序都使用“C”语言环境，所以我必须调用 setlocale(LCTYPE,"").."" 意味着它将使用我的环境的语言环境，即 en_US.utf8 并且转换有效。

# pointers - 将指针复制到 C 中的指针“内容”

> ID：13261469
> 
> 赞同：2
> 
> 时间：2012-11-07T00:17:40.960
> 
> 标签：pointers, malloc, free

我在复制指针的内容时遇到了一些麻烦。我只是在尝试这个：

```
 char* vigia1; 
 char* vigia2; 
```

和..

```
 char* aux = (char*) malloc (strlen (vigia1)+1);
  aux=vigia1;
  vigia1=vigia2;
  vigia2=aux;
  free (aux); 
```

*vigia1, vigia2*是指向*char*指针的指针。它们的*malloc*都大于它们的最大可能大小，没关系。

由于我正在尝试对列表进行排序，因此我需要进行此更改以对节点的内容进行排序。但我很困惑：**在*free(aux)*之后，*vigia2*没有任何价值。**我想我必须将*vigia2指向**aux*所在的内存区域，该区域在*free*之后“消失” 。所以我该怎么做？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T00:27:13.487

指针，指针，对他们不好，没有他们更糟

指针是存储某物在内存中的存储位置的数字，考虑到这一点，让我们深入研究您在那里所做的事情：

```
char* aux = (char*) malloc (strlen (vigia1)+1); 
```

很好，您已经在称为*heap*的内存的某处创建了空间，并将新创建的内存空间的地址存储在 aux 中。

```
aux=vigia1; 
```

操作，现在您已经用存储在 vigia1 中的数字覆盖了您“创建”的内存空间的地址，这恰好是另一个内存空间的地址。

```
vigia1=vigia2; 
```

现在您将 vigia2 的值分配给 vigia1，这是一些内存空间的另一个地址。

```
vigia2=aux; 
```

并且，到最后，您使 vigia2 指向以前由 vigia1 指向的内存区域。

```
free (aux); 
```

现在，您正在*释放*aux 指向的内存。稍等一下，在此行上方的行中，您刚刚使 vigia2 指向*同一个地址*。难怪它没有任何用处:)

试图帮助你做你想做的事：

只要您没有任何约束*要求*您维护在内存中排序的列表节点，您就不需要复制节点的内容，只需使第一个节点的指针指向第二个节点的内存区域节点。

一个完美的交换将是：

```
char *aux; // you'll need an aux to make the swap, the normal stuff
aux = vigia1; // now aux points to the same address as vigia1
vigia1 = vigia2; // vigia1 now points to the contents of vigia2
vigia2 = aux; // and now vigia2 points to the content pointed previously by vigia1
/* and tada! the swap is done :D */ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T00:25:18.797

将一个指针分配给另一个指针只是将一个指针的值复制到另一个指针，即地址。它不会将指针所指的内容复制到不同地址的另一个位置。所以是的，你可以让 N 个指针都指向同一个内存块，但是一旦`free()`被称为其中之一，它们都是无效的。

所以这意味着：

```
char* aux = (char*) malloc (strlen (vigia1)+1);
aux=vigia1; 
```

是内存泄漏。您`malloc`需要一些内存`aux`，然后立即丢弃该地址。没有办法找回它，再也没有办法找回它`free()`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T00:23:47.437

你所做的只是指针分配。Malloc 的内存只是被浪费导致泄漏。

```
aux=vigia1; // Makes aux point to the location where vigia1 is pointing to
            // Doesn't copy the contents of vigia1 to malloc'ed memory for aux 
```

您需要使用`strcpy`.

```
strcpy(aux, vigia1); 
```

希望这能给你提示。

# mysql - MySQL中的几何

> ID：13261472
> 
> 赞同：0
> 
> 时间：2012-11-07T00:17:58.613
> 
> 标签：mysql, geometry

我明白里面有什么`POINT()`，`MySQL`但我只是不知道这种格式是什么意味着 `1 POINT (8.04665153 -44.39902520)`我有以下内容`CSV`

`104|104||CURR|N|14102|4428||71816|71816|1|1 POINT (8.04665153 -44.39902520)|`

我正在使用以下查询将其加载`CSV`到我的表中

```
LOAD DATA LOCAL INFILE '/data/disc/sad1.csv' INTO TABLE sad1 
FIELDS TERMINATED BY '|' ENCLOSED BY '"' lines terminated by '\n' IGNORE 23 LINES
(@var1, @var2,@var3,@var4,@var5,@var6,@var7,@var8,@var9,@var10,@var11,@var12)
SET `house_number` = @var1,
    `range_low` = @var2,
    `range_high` = @var3,
    `status` = @var4,
    `unofficial_flag` = @var5,
    `rcl_id` = @var6,
    `rna_id` = @var7,
    `alt_id` = @var8,
    `se_row_id` = @var9,
    `id` = @var10,
    `audit_id` = @var11,
    `shape` = GeomFromText(@var12); 
```

我正在`NULL`为这个`shape`领域。当我更改为时`1 POINT (8.04665153 -44.39902520)`，`POINT (8.04665153 -44.39902520)`我正在填写一些数据。我应该如何处理`1`上述数据中的前缀？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T09:05:18.803

我不确定`1`ypur 输入数据中的这个前缀是什么意思。[SFA 第 1 部分标准](http://www.opengeospatial.org/standards/sfa)第 7 节中定义的众所周知的几何文本表示不包括这样的前缀。这个数字可能表示特征的数量。或者它可能表示点类型的整数代码，如该标准第 8.2.3 节中的表 7 中所指定。

在任何情况下，只要前缀`1`在所有情况下，并且您的输入 csv 数据的创建者没有提供有关该值含义的其他详细信息，您最好的选择就是简单地删除这些前缀。您可以使用 CSV 上的预处理阶段来代替`POINT`整个`1 POINT`文档。您很可能会不小心替换文本列中某处出现的事件。

如果你想安全，或者想避免额外的步骤，你也可以在 SQL 查询中进行更改，使用如下表达式：

```
`shape` = GeomFromText(IF(@var12 LIKE '1 POINT%', SUBSTRING(@var12, 3), @var12)) 
```

这将检查相应的列是否以 开头`1 POINT`，如果是，则省略列文本中的前两个字符。

# ruby-on-rails - ruby 模块和类在结构中同名

> ID：13261474
> 
> 赞同：34
> 
> 时间：2012-11-07T00:18:10.670
> 
> 标签：ruby-on-rails, ruby

在我的一个项目中，我的文件夹结构如下所示：

*   库
    *   bar.rb
    *   酒吧
        *   other_bar.rb
        *   another_bar.rb
        *   next_bar.rb
        *   ...

**bar.rb**

```
require File.expand_path(File.dirname(__FILE__) + "/bar/other_bar.rb")

class Bar
  puts "running BarBase"
end 
```

**酒吧/其他酒吧.rb**

```
module Bar
  class OtherBar
    puts "running module Bar with class OtherBar"
  end
end 
```

如果我现在运行，`ruby bar.rb`我会得到：

> 使用类 OtherBar
> bar.rb:3:in 运行模块 Bar `'：Bar 不是类（TypeError）

我想有一个类似于 rails 模型继承结构的结构。我怎样才能解决这个问题？据我所知，ruby 不支持这个开箱即用。这种情况有解决方法吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-11-07T00:23:18.083

`Bar`不能是模块和类，它们是不同的东西。

更改`bar.rb`为`module Bar`或更改`other_bar.rb`为`class Bar`。

无论是哪一种，都必须是一致的。你不能把一个换成另一个。问题是应该是哪个？如果`Bar`是其他类的容器并且只有几个全局单例方法？然后是一个`module`。但如果它可以被实例化，那么它就是一个`class`.

是的，你可以嵌套类。这是完全可以接受的：

```
class Bar
  class OtherBar
    puts "running module Bar with class OtherBar"
  end
end

Bar::OtherBar.new # yay! 
```

模块和类可以以任何你认为合适的方式嵌套在其中。

* * *

编辑一些带注释的示例以帮助清除这一切：

```
module Foo

  # Foo::A
  class A
    # simple namespaced class
  end

  # Foo::B, inherits from Foo::A
  class B < A
    # inherting from a class in the same namespace
  end

  # modify Foo::B
  class B
    # When modifying an existing class you don't need to define the superclass
    # again. It will raise an error if you reopen a class and define a different
    # superclass. But leaving it off is fine.
  end

  # nested module Foo::Inner
  module Inner

    # Foo::Inner::C 
    class C
      # simple more deeply namespaced class
    end

    # Foo::Inner::D, inherits from Foo::A
    class D < A
      # inherits from a class in a parent namespace

      # works because ruby looks upward in the nesting chain to find missing constants.
    end

    # Foo::Inner::Foo
    class Foo
      # simple nested class with the same name as something in a parent namespace

      # This is a totally different Foo, because it's in a different namespace
    end

    # Foo::Inner::E, inherits from Foo::Inner::Foo
    class E < Foo
      # class inhereting from another class in the same namespace

      # Foo::Inner::Foo is "closer" than the global Foo, so that gets found as the superclass
    end

    # Foo::Inner::F, which mixes in the gloabl module Foo
    class F
      # the :: constant prefix says to start looking in the global namespace
      # so here we include the top level module Foo, and not the "closer" in namespace Foo::Inner::Foo
      include ::Foo

      # This is an error. This attempts to include the class Foo::Inner::Foo since thats the closest by namespace
      # thing that matches the constant Foo. (you can't include classes, only modules)
      # You need the :: prefix to grab the global Foo module
      include Foo
    end

  end
end

# Z decalred in the global namespace, which inherits from the deeply nested class Foo::Inner::C
class Z < Foo::Inner::C
  # Any class anywhere can inherit from any other class in any namespace.
  # Just drill in!
end

# the following 2 declarations at this point would be identical

# This defines a class deep with in a namespace
class Foo::Inner::Foo::Bar < Foo::A
end

# same as above, but reopens each namespace
module Foo
  module Inner
    class Foo
      class Bar < ::Foo::A
      end
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-07T00:22:47.983

只需使用`class Bar`而不是`module Bar`. 在 Ruby 中，可以重新打开和添加类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-13T08:21:13.770

建议不要将类用作命名空间，尤其是在使用 Rails 时。

如果您想保留 Bar 类`lib/bar.rb`，一个选项是将 Bars 命名空间中的其他类移到`lib/bars.rb`.

在此处阅读有关原因的更多信息：[https ://blog.jetbrains.com/ruby/2017/03/why-you-should-not-use-a-class-as-a-namespace-in-rails-applications/](https://blog.jetbrains.com/ruby/2017/03/why-you-should-not-use-a-class-as-a-namespace-in-rails-applications/)

更新：此行为已在 ruby​​ 2.5 中修复

请参阅：[https ://blog.bigbinary.com/2017/10/18/ruby-2.5-has-removed-top-level-constant-lookup.html](https://blog.bigbinary.com/2017/10/18/ruby-2.5-has-removed-top-level-constant-lookup.html)

# javascript - 是否可以控制浏览器窗口滚动条的可见性？

> ID：13261482
> 
> 赞同：0
> 
> 时间：2012-11-07T00:19:03.413
> 
> 标签：javascript, html, css

`overflow`我们可以通过CSS 属性来影响 HTML 元素的滚动条。

会不会影响浏览器窗口的滚动条？

动机 - 调整窗口大小时，我正在调整代码中 HTML 元素的大小。在调整大小期间，两个滚动条是可见的——窗口之一和特定 HTML 元素之一。当调整大小结束时，只剩下一个滚动条——元素的滚动条，所以一切都很好。但是在调整大小时它看起来很丑。

你可以在这里看到它 - [http://jsfiddle.net/mark69_fnd/DaYCa/9/](http://jsfiddle.net/mark69_fnd/DaYCa/9/)：

![在此处输入图像描述](../Images/56cf98dce94bc97945e74abcaf266655.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:22:05.403

是的，这是可能的——只需使用[`body { overflow: hidden; }`](http://jsfiddle.net/6CvE4/). 您可以通过运行从 Firebug 在此页面上轻松测试它`$("body").css("overflow", "hidden");`。

# angularjs - 带有传单指令的Angularjs - 清除标记

> ID：13261484
> 
> 赞同：1
> 
> 时间：2012-11-07T00:19:08.693
> 
> 标签：angularjs, leaflet

我的设置工作正常，但是，我遇到了一些小问题..尝试了很多方法，但在添加新标记之前我无法摆脱标记..

通过以下示例，每当您从控制器推送时，都会不断添加标记。在添加任何新标记之前擦除现有标记的最佳方法是什么……？

```
 var module = angular.module('Map', []);   
 module.directive('sap', function() {

    return {
        restrict: 'E',
        replace: true,
        template: '<div></div>',
        link: function(scope, element, attrs) {
            var map = L.map(attrs.id, {
                center: [-35.123, 170.123],
                zoom: 14
            });
            //create a CloudMade tile layer and add it to the map
            L.tileLayer('http://{s}.tile.cloudmade.com/57cbb6ca8cac418dbb1a402586df4528/997/256/{z}/{x}/{y}.png', {
                maxZoom: 18
            }).addTo(map);

            //add markers dynamically
            var points = [];
            updatePoints(points);

       function updatePoints(pts) {

                for (var p in pts) {

                    L.marker([pts[p].lat, pts[p].long]).addTo(map).bindPopup(pts[p].message);
                }

            }

            scope.$watch(attrs.pointsource, function(value) {
                updatePoints(value);
            });

        }

    };
}); 
```

在控制器内部，添加新标记的方法是

```
 $scope.pointsFromController.push({
                lat: val.geoLat,
                long: val.geoLong
            }); 
```

HTML 中的代码很简单

```
<sap id="map" pointsource="pointsFromController"></sap> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T18:02:39.713

传单创建者在这里。清除标记的最佳方法是将它们添加到组中（而不是直接添加到地图中），然后在需要时调用 group.clearLayers()。[http://leafletjs.com/examples/layers-control.html](http://leafletjs.com/examples/layers-control.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T03:12:34.637

假设`pointsFromController`是一个简单的 javascript 数组。您可以简单地撤消您所做的推送。

```
$scope.removePoints = function() {
  for (var i=$scope.pointsFromController.length; i>=0; i--)
    $scope.pointsFromController.pop();
}; 
```

# delphi - 通过 Socket 发送动态数组（在记录内）？

> ID：13261486
> 
> 赞同：1
> 
> 时间：2012-11-07T00:19:31.557
> 
> 标签：delphi, sockets, winsock

我正在尝试直接使用.SendBuf() 将记录从服务器传输到客户端。

但是，该记录有一个成员，它是一个动态数组，我在某处（在 SOF 中）读到，在发送记录时，成员必须是静态的（固定长度），但问题是......我无法确定如何我会发送许多论点（将来）。

我怎么解决这个问题 ？

```
procedure TServerClass.SendBufToSocket(const vmName: TVMNames; const vmArgs: Array of TValue);
var
  // this record is sent to client
  // vmName = method to be called [in]
  // vmArgs = Argument for the method [in, optional]
  BufRec: packed record
    vmName: array[0..49] of char;
    vmArgs: Array of TValue;
  end;

  s: string;
  i: integer;
begin
  // convert enum method name to string
  s:= GetEnumName(TypeInfo(TVMNames), Integer(vmName));

  // copy method name to record
  lstrcpy(BufRec.vmName, pChar(s));

  // copy arg array to record
  SetLength(BufRec.vmArgs, length(vmArgs));

  for i:=0 to high(vmArgs)
    do BufRec.vmArgs[i] := vmArgs[i];

  // send record
  ServerSocket.Socket.Connections[idxSocket].SendBuf(PByte(@BufRec)^, SizeOf(BufRec));
end; 
```

我从我读过它的地方找到了，这里： [ReceiveBuf from TCustomWinSocket won't work with dynamic arrays for the buffer](https://stackoverflow.com/questions/8945267/receivebuf-from-tcustomwinsocket-wont-work-with-dynamic-arrays-for-the-buffer)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T01:13:09.687

您将无法按原样发送记录，因此实际上您甚至根本不需要使用记录。您必须将数据序列化为适合通过网络传输的平面格式。例如发送字符串时，先发送字符串长度，再发送字符串数据。同样，发送数组时，请在发送数组项之前发送数组长度。至于项目本身，由于`TValue`是动态的，您也必须将其序列化为平面格式。

在发送端尝试这样的事情：

```
procedure TServerClass.SendBufToSocket(const vmName: TVMNames; const vmArgs: Array of TValue);
var
  I: integer;

  procedure SendRaw(Data: Pointer; DataLen: Integer);
  var
    DataPtr: PByte;
    Socket: TCustomWinSocket;
    Sent, Err: Integer;
  begin
    DataPtr := PByte(Data);
    Socket := ServerSocket.Socket.Connections[idxSocket];
    while DataLen > 0 do
    begin
      Sent := Socket.SendBuf(DataPtr^, DataLen);
      if Sent > 0 then
      begin
        Inc(DataPtr, Sent);
        Dec(DataLen, Sent)
      end else
      begin
        Err := WSAGetLastError();
        if Err <> WSAEWOULDBLOCK then
          raise Exception.CreateFmt('Unable to sent data. Error: %d', [Err]);
        Sleep(10);
      end;
    end;
  end;

  procedure SendInteger(Value: Integer);
  begin
    Value := htonl(Value);
    SendRaw(@Value, SizeOf(Value));
  end;

  procedure SendString(const Value: String);
  var
    S: UTF8string;
    Len: Integer;
  begin
    S := Value;
    Len := Length(S);
    SendInteger(Len);
    SendRaw(PAnsiChar(S), Len);
  end;

begin
  SendString(GetEnumName(TypeInfo(TVMNames), Integer(vmName)));
  SendInteger(Length(vmArgs));
  for I := Low(vmArgs) to High(vmArgs) do
    SendString(vmArgs[I].ToString);
end; 
```

然后在接收端：

```
type
  TValueArray := array of TValue;

procedure TServerClass.ReadBufFromSocket(var vmName: TVMNames; var vmArgs: TValueArray);
var
  Cnt, I: integer;
  Tmp: String;

  procedure ReadRaw(Data: Pointer; DataLen: Integer);
  var
    DataPtr: PByte;
    Socket: TCustomWinSocket;
    Read, Err: Integer;
  begin
    DataPtr := PByte(Data);
    Socket := ClientSocket.Socket;
    while DataLen > 0 do
    begin
      Read := Socket.ReceiveBuf(DataPtr^, DataLen);
      if Read > 0 then
      begin
        Inc(DataPtr, Read);
        Dec(DataLen, Read);
      end
      else if Read = 0 then
      begin
        raise Exception.Create('Disconnected');
      end else
      begin
        Err := WSAGetLastError();
        if Err <> WSAEWOULDBLOCK then
          raise Exception.CreateFmt('Unable to read data. Error: %d', [Err]);
        Sleep(10);
      end;
    end;
  end;

  function ReadInteger: Integer;
  begin
    ReadRaw(@Result, SizeOf(Result));
    Result := ntohl(Result);
  end;

  function ReadString: String;
  var
    S: UTF8String;
    Len: Integer;
  begin
    Len := ReadInteger;
    SetLength(S, Len);
    ReadRaw(PAnsiChar(S), Len);
    Result := S;
  end;

begin
  vmName := TVMNames(GetEnumValue(TypeInfo(TVMNames), ReadString));
  Cnt := ReadInteger;
  SetLength(vmArgs, Cnt);
  for I := 0 to Cnt-1 do
  begin
    Tmp := ReadString;
    // convert to TValue as needed...
    vmArgs[I] := ...;
  end;
end; 
```

话虽如此，请注意套接字编程比这个简单示例显示的更复杂。您必须进行适当的错误处理。您必须考虑部分数据的发送和接收。如果您使用的是非阻塞套接字，如果套接字进入阻塞状态，那么您必须等待它再次进入可读/可​​写状态，然后才能尝试读取/写入仍然挂起的数据。你还没有这样做。你需要给自己一本关于有效套接字编程的好书。

**更新**：如果您尝试使用套接字组件的`OnRead`和`OnWrite`事件，则必须采用不同的方法：

```
procedure TServerClass.ClientConnect(Sender: TObject; Socket: TCustomWinSocket);
begin
  Socket.Data := TMemoryStream.Create;
end;

procedure TServerClass.ClientDisconnect(Sender: TObject; Socket: TCustomWinSocket);
begin
  TMemoryStream(Socket.Data).Free;
  Socket.Data := nil;
end;

procedure TServerClass.ClientWrite(Sender: TObject; Socket: TCustomWinSocket);
var
  OutBuffer: TMemoryStream;
  Ptr: PByte;
  Sent, Len: Integer;
begin
  OutBufer := TMemoryStream(Socket.Data);
  if OutBuffer.Size = 0 then Exit;

  OutBuffer.Position := 0;
  Ptr := PByte(OutBuffer.Memory);

  Len := OutBuffer.Size - OutBuffer.Position;
  while Len > 0 do
  begin
    Sent := Socket.SendBuf(Ptr^, Len);
    if Sent <= 0 then Break;
    Inc(Ptr, Sent);
    Dec(Len, Sent)
  end;

  if OutBuffer.Position > 0 then
  begin
    if OutBuffer.Position >= OutBuffer.Size then
      OutBuffer.Clear
    else
    begin
      Move(Ptr^, OutBuffer.Memory^, Len);
      OutBuffer.Size := Len;
    end;
  end;
end;

procedure TServerClass.SendBufToSocket(const vmName: TVMNames; const vmArgs: Array of TValue);
var
  I: integer;
  Socket: TCustomWinSocket;
  OutBuffer: TMemoryStream;

  procedure SendRaw(Data: Pointer; DataLen: Integer);
  var
    DataPtr: PByte;
    Sent: Integer;
  begin
    if DataLen < 1 then Exit;
    DataPtr := PByte(Data);
    if OutBuffer.Size = 0 then
    begin
      repeat
        Sent := Socket.SendBuf(DataPtr^, DataLen);
        if Sent < 1 then Break;
        Inc(DataPtr, Sent);
        Dec(DataLen, Sent)
      until DataLen < 1;
    end;
    if DataLen > 0 then
    begin
      OutBuffer.Seek(0, soEnd);
      OutBuffer.WriteBuffer(DataPtr^, DataLen);
    end;
  end;

  procedure SendInteger(Value: Integer);
  begin
    Value := htonl(Value);
    SendRaw(@Value, SizeOf(Value));
  end;

  procedure SendString(const Value: String);
  var
    S: UTF8string;
    Len: Integer;
  begin
    S := Value;
    Len := Length(S);
    SendInteger(Len);
    SendRaw(PAnsiChar(S), Len);
  end;

begin
  Socket := ServerSocket.Socket.Connections[idxSocket];
  OutBuffer := TMemoryStream(Socket.Data);

  SendString(GetEnumName(TypeInfo(TVMNames), Integer(vmName)));
  SendInteger(Length(vmArgs));
  for I := Low(vmArgs) to High(vmArgs) do
    SendString(vmArgs[I].ToString);
end; 
```

然后在接收端：

```
procedure TServerClass.ClientConnect(Sender: TObject; Socket: TCustomWinSocket);
begin
  Socket.Data := TMemoryStream.Create;
end;

procedure TServerClass.ClientDisconnect(Sender: TObject; Socket: TCustomWinSocket);
begin
  TMemoryStream(Socket.Data).Free;
  Socket.Data := nil;
end;

procedure TServerClass.ClientRead(Sender: TObject; Socket: TCustomWinSocket);
var
  InBuffer: TMemoryStream;      
  Ptr: PByte;
  OldSize, Pos, Read: Integer;

  function HasAvailable(DataLen: Integer): Boolean;
  being
    Result := (InBuffer.Size - InBuffer.Position) >= DataLen;
  end;

  function ReadInteger(var Value: Integer);
  begin
    Result := False;
    if HasAvailable(SizeOf(Integer)) then
    begin
      InBuffer.ReadBuffer(Value, SizeOf(Integer));
      Value := ntohl(Value);
      Result := True;
    end;
  end;

  function ReadString(var Value: String);
  var
    S: UTF8String;
    Len: Integer;
  begin
    Result := False;
    if not ReadInteger(Len) then Exit;
    if not HasAvailable(Len) then Exit;
    SetLength(S, Len);
    InBuffer.ReadBuffer(PAnsiChar(S)^, Len);
    Value := S;
    Result := True;
  end;

  function ReadNames: Boolean;
  var
    S: String;
    vmName: TVMNames;
    vmArgs: TValueArray;
  begin
    Result := False;
    if not ReadString(S) then Exit;
    vmName := TVMNames(GetEnumValue(TypeInfo(TVMNames), S));
    if not ReadInteger(Cnt) then Exit;
    SetLength(vmArgs, Cnt);
    for I := 0 to Cnt-1 do
    begin
      if not ReadString(S) then Exit;
      // convert to TValue as needed...
      vmArgs[I] := ...;
    end;
    // use vmArgs as needed...
    Result := True;
  end;

begin
  InBuffer := TMemoryStream(Socket.Data);

  Read := Socket.ReceiveLength;
  if Read <= 0 then Exit;

  OldSize := InBuffer.Size;
  InBuffer.Size := OldSize + Read;

  try
    Ptr := PByte(InBuffer.Memory);
    Inc(Ptr, OldSize);
    Read := Socket.ReceiveBuf(Ptr^, Read);
  except
    Read := -1;
  end;

  if Read < 0 then Read := 0;
  InBuffer.Size := OldSize + Read;
  if Read = 0 then Exit;

  InBuffer.Position := 0;

  repeat
    Pos := InBuffer.Position;
  until not ReadNames;

  InBuffer.Position := Pos;
  Read := InBuffer.Size - InBuffer.Position;
  if Read < 1 then
    InBuffer.Clear
  else
  begin
    Ptr := PByte(InBuffer.Memory);
    Inc(Ptr, InBuffer.Position);
    Move(Ptr^, InBuffer.Memory^, Read);
    InBuffer.Size := Read;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T12:43:06.837

正如一些评论中提到的，将您的记录序列化为流，然后通过网络发送流内容。我在我的一些项目中使用[了 kbLib](http://code.google.com/p/kblib/)，它的效果非常好。您可以在记录中使用任何动态类型，例如字符串、数组。

小例子：

```
type 
  TMyRecord = record
    str : string;
  end;

procedure Test;

var
 FStream : TMemoryStream;
 MYrecord : TMyRecord;
 MYrecord1 : TMyRecord;

begin
 FStream := TMemoryStream.Create;
 try
  MyRecord.Str := 'hello world';
  // save record to stream 
  TKBDynamic.WriteTo(FStream, MyRecord, TypeInfo(TMyRecord)); 
  FStream.Position := 0;
  // read record from stream
  TKBDynamic.ReadFrom(FStream, MyRecord1, TypeInfo(TMyRecord));  
  If MyRecord1.Str <> MyRecord.Str then
   ShowMessage('this should not happen!');
  finally
   FStream.Free; 
  end;
end; 
```

# android - 了解有关 Android 手机上的硬件组件的更多信息？

> ID：13261487
> 
> 赞同：0
> 
> 时间：2012-11-07T00:19:40.517
> 
> 标签：android, hardware, vibration

我正在寻找一个 linux 命令，它可以让我更多地了解手机上的振动电机组件。

您可以通过查看 /proc 并查看加载了哪些内核模块来对硬件进行很好的自省。例如，这列出了我的 Droid 手机上当前使用的中断号（“adb shell”到我的手机）

```
1|shell@cdma_spyder:/proc $ cat interrupts
cat interrupts
           CPU0       CPU1
 41:          0          0       GIC  l3-dbg-irq
 42:          0          0       GIC  l3-app-irq
 43:       9226          0       GIC  prcm
 44:      47509          0       GIC  DMA
 52:          0          0       GIC  gpmc
 53:     216846          0       GIC  SGX ISR
 57:       2045          0       GIC  OMAP DISPC
 58:        126          0       GIC
 60:          0          0       GIC  omap-iommu.1
 69:     140651          0       GIC  gp timer
 77:          0          0       GIC  rproc-wdt
 79:          0          0       GIC  rproc-wdt
 85:       6368          0       GIC  omapdss_dsi1
 88:         29          0       GIC  omap_i2c
 89:       5317          0       GIC  omap_i2c
 90:        397          0       GIC  omap_hdq
 93:         10          0       GIC  omap_i2c
 94:         81          0       GIC  omap_i2c
102:       6054          0       GIC
104:      16254          0       GIC  OMAP UART0
105:         77          0       GIC
108:        402          0       GIC  ohci_hcd:usb2
109:       3338          0       GIC  ehci_hcd:usb1
112:        181          0       GIC  omap_wdt
115:        676          0       GIC  mmc0
118:      84283          0       GIC  mmc1
124:        819          0       GIC  musb-hdrc
125:        740          0       GIC  musb-hdrc
126:      65421          0       GIC  mmc2
131:         66          0       GIC  ABE
132:          0          0       GIC  omap-iommu.0
133:          0          0       GIC  OMAP HDMI
141:          0          0       GIC  McASP
142:          0          0       GIC  omap_emif
143:          0          0       GIC  omap_emif
152:          0          0       GIC  omap4-keypad
163:          0          0      GPIO  wrigley_ctrl-reset
166:          5          0      GPIO  msp430_irq
167:       7115          0      GPIO  cpcap-irq
168:          0          0      GPIO  mdm_bp_resout
202:          6          0      GPIO  cy8c201xx
212:          0          0      GPIO  mdm_bp_status0
213:          0          0      GPIO  mdm_bp_status1
215:          1          0      GPIO  mdm_bp_status2
222:         38          0      GPIO  oob-wake-host-wake
223:          0          0      GPIO  hpd
260:       6728          0      GPIO  wl1271
275:          8          0      GPIO  usb_wake_host
309:       2909          0      GPIO  Remote Wakeup
336:          0          0      GPIO  mmc0
337:        140          0      GPIO  ct405
338:          0          0      GPIO  pcb_temp_sensor
343:        525          0      GPIO  atmxt-i2c
IPI0:          0          0  Timer broadcast interrupts
IPI1:     392542     449194  Rescheduling interrupts
IPI2:          0          0  Function call interrupts
IPI3:      66924      67462  Single function call interrupts
IPI4:          0          0  CPU stop interrupts
IPI5:          0          0  CPU backtrace
LOC:     538193     484328  Local timer interrupts
Err:          0
shell@cdma_spyder:/proc $

$ cat modules
wl12xx_sdio 4046 0 - Live 0xbf0c6000
vpnclient 67812 1 - Live 0xbf0b0000
btwilink 3462 0 - Live 0xbf0ac000
wl12xx 133371 1 wl12xx_sdio, Live 0xbf081000
mac80211 220250 1 wl12xx, Live 0xbf03d000
cfg80211 163244 2 wl12xx,mac80211, Live 0xbf009000
compat 2530 0 - Live 0xbf005000
evfwd 4650 0 - Live 0xbf000000
shell@cdma_spyder:/proc $ 
```

但是，我无法将这些芯片名称中的任何一个与振动电机联系起来。（例如通过谷歌搜索，“cy8c201”是 Cypress 的可编程片上系统 SoC，可以控制其他 IO 设备[http://www.ic-on-line.cn/view_online.php?id=1691996&file=0347](http://www.ic-on-line.cn/view_online.php?id=1691996&file=0347) \cy8c20134_2665305.pdf ）我猜测振动电机连接到那个或其他一些控制器芯片（或者可能是 i2C ？）并且该控制器芯片被分配给上述中断之一。

那么，关于如何获取下一层信息的任何想法？我可以编写一个 C 程序，或者使用 gdb 来获取有关 vibe 电机在哪里以及它是什么组件的更多信息。欢迎任何信息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:23:19.260

至少某些手机中的振动器实际上是一种*音频设备*。TI TWL4040 和 TWL6040 就是这种情况，它们分别是 TI 的 OMAP3 和 4 音频配套 IC。没有关于您的设备是否支持的见解，但它肯定有 OMAP4 参考平台的其他组件。

如果您启动`alsamixer`，您可能会发现一些与振动器相关的混音器设置。

如果使用单独的 PCM 音频输出来驱动它，

`aplay -l`

可能会提供一些见解。

Cypress 部分是一个触摸屏控制器。

另一个从事逆向工程的好地方`sysfs`。

# c++ - 当我尝试实例化特定类时，CDT 中的“类型符号未找到体系结构 x86_64”

> ID：13261491
> 
> 赞同：1
> 
> 时间：2012-11-07T00:20:01.283
> 
> 标签：c++, macos, eclipse-cdt

我有以下类和相应的头文件：

```
#ifndef ORDER_H_
#define ORDER_H_

#include "Side.h"

using namespace std;

class Order {
public:
    int _id;
       Side _side;
       int _ackedPrc;
       int _ackedQty;
       int _requestedPrc;
       int _requestedQty;
       int _filledQty;

       Order(){
           _id = -1;
           _side = BID;
           _ackedPrc = -1;
           _ackedQty = 0;
           _requestedPrc = 0;
           _requestedQty = 0;
           _filledQty = 0;
       }
       void cancel(){
           _requestedQty = 0;
       }
       void amend(int prc, int qty){
           _requestedPrc = prc;
           _requestedQty = qty;
       }
       void amended(){
           _ackedPrc = _requestedPrc;
           _ackedQty = _requestedQty;
       }
       void acked(){
           amended();
       }
       void onFill(int fillQty){
           _filledQty += fillQty;
       }
       int filledQty(){
           return _filledQty;
       }
       int prc(){
           return _requestedQty;
       }
       int remainingQty(){
           return _requestedQty - _filledQty;
       }
       int id(){
           return _id;
       }
       Side side(){
           return _side;
       }
       bool pendingMod(){
           return _ackedPrc != _requestedPrc || _ackedQty != _requestedQty;
       }

};
#endif

#ifndef ORDER_H_
#define ORDER_H_
#include "Side.h"

class Order {
public:
    int _id;
    Side _side;
    int _ackedPrc;
    int _ackedQty;
    int _requestedPrc;
    int _requestedQty;
    int _filledQty;

    Order();
    void cancel();
    void amend(int prc, int qty);
    void amended();
    void acked();
    void onFill(int fillQty);
    int filledQty();
    int prc();
    int remainingQty();
    int id();
    Side side();
    bool pendingMod();
};

#endif /* ORDER_H_ */ 
```

当我尝试实例化此对象时，我在我的 Mac 上的 CDT/Eclipse 中收到符号未找到错误。但是，我可以轻松地实例化项目中的任何其他类，所以我很确定我的问题在于 Order 类：

```
int main() {
   Order o;//This gives me an error
//   OrderBook ob; But this works
//   QuoteBook qb; And this works
    return 0;
} 
```

谁能发现我的问题？我一直在想，我的声明在某处与我的定义不符，但我不知道如何。（是的，我是 C++ 新手。请原谅任何违反最佳实践的行为。）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:07:22.780

一个Java程序员有机会吗？从您的代码来看，您实际上已经两次*声明*了该类。`Order`在 C++ 中，您通常*声明*一个类，然后在其中*定义*成员变量和函数。实际上，您可以像第一次声明一样声明和定义`Order`，但除非代码非常简短，否则这通常不是好的做法。无论如何，我建议您的标题应如下所示：

```
#ifndef ORDER_H_
#define ORDER_H_
#include "Side.h"

class Order {
public:
    int _id;
    Side _side;
    int _ackedPrc;
    int _ackedQty;
    int _requestedPrc;
    int _requestedQty;
    int _filledQty;

    Order();
    void cancel();
    void amend(int prc, int qty);
    void amended();
    void acked();
    void onFill(int fillQty);
    int filledQty();
    int prc();
    int remainingQty();
    int id();
    Side side();
    bool pendingMod();
};

#endif /* ORDER_H_ */ 
```

这仍然包含包含保护，因此它只会在任何编译单元中包含一次。现在您的 cpp 文件（其中包含*定义*）应该看起来像这样：

```
#include <Order.hpp>

Order::Order(){
    _id = -1;
    _side = BID;
    _ackedPrc = -1;
    _ackedQty = 0;
    _requestedPrc = 0;
    _requestedQty = 0;
    _filledQty = 0;
}
void Order::cancel(){
    _requestedQty = 0;
}
void Order::amend(int prc, int qty){
    _requestedPrc = prc;
    _requestedQty = qty;
}
void Order::amended(){
    _ackedPrc = _requestedPrc;
    _ackedQty = _requestedQty;
}
void Order::acked(){
    amended();
}
void Order::onFill(int fillQty){
    _filledQty += fillQty;
}
int Order::filledQty(){
    return _filledQty;
}
int Order::prc(){
    return _requestedQty;
}
int Order::remainingQty(){
    return _requestedQty - _filledQty;
}
int Order::id(){
    return _id;
}
Side Order::side(){
    return _side;
}
bool Order::pendingMod(){
    return _ackedPrc != _requestedPrc || _ackedQty != _requestedQty;
} 
```

请注意，我显然根本没有对此进行测试。需要注意的主要事情是，这里是您的 Order 类函数的主体。请注意，名称必须在 Order 类中限定范围。希望这可以帮助。

# php - 如果 $variable = 0 不起作用

> ID：13261495
> 
> 赞同：5
> 
> 时间：2012-11-07T00:20:21.167
> 
> 标签：php, if-statement

```
if($_POST['user_admin'] = 0){ $acct_type = "a standard"; }
elseif($_POST['user_admin'] = 1){ $acct_type = "an administrator"; }
echo $acct_type;
echo $_POST['user_admin']; 
```

不管`$_POST['user_admin']`是0还是1，`$acct_type`还是返回“管理员”为什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-07T00:24:12.540

比较变量时需要使用“==”。

```
if($_POST['user_admin'] == 0){ $acct_type = "a standard"; }
elseif($_POST['user_admin'] == 1){ $acct_type = "an administrator"; }
echo $acct_type;
echo $_POST['user_admin']; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-07T00:22:46.163

它应该是

```
if $variable == 0 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-07T00:46:44.300

你用 = 赋值你应该使用 $variable == 0 来比较这个值

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-07T00:32:33.003

您是[要避免的 10 个常见 PHP 错误中](http://www.ultramegatech.com/2009/11/10-common-php-mistakes-to-avoid/)的第一个:-)

```
 $_POST['user_admin'] = 0 
   $_POST['user_admin'] = 1 
```

都是任务。PHP 在将值分配给 $_POST['user_admin'] 后评估最终分配的表达式是真还是假。因此，第一个将评估为 false，因为分配的值为 0，第二个将评估为 true，因为分配的值为 1。

正如每个人都指出的那样，您必须使用“==”而不是“=”来表示条件语句。

# c++ - 如何扩展 C++ 升压列表容器以使用升压升级互斥体实现线程安全实现？

> ID：13261496
> 
> 赞同：2
> 
> 时间：2012-11-07T00:20:31.107
> 
> 标签：c++, list, shared-ptr, boost-thread, boost-mutex

我编写了一些示例测试代码来验证使用 boost 升级互斥锁在 boost 列表容器上实现读/写互斥锁的功能。我有 10 个线程，5 个是读者，5 个是作者。
我使用智能指针来简化内存管理并允许同一对象包含在多个列表中。编写者不断地删除对象并将其重新插入到各自的列表中，而读者则定期迭代列表。这一切似乎都按预期工作，但是当调用列表擦除成员函数时，当我已经拥有它时，它必须找到要删除的条目。
擦除方法是否足够聪明，可以知道要擦除的条目而无需再次搜索，或者它是否经过优化以在列表元素已知时消除搜索？如果它进行搜索，那么是否有一种直接的方法来扩展它，以便只能在从列表中实际删除时应用唯一锁，而不是在查找列表元素时应用？这是我与 boost 1.51 库链接并使用 vs2008 测试的代码。

```
 //******************************************************************************
  // INCLUDE FILES
  //******************************************************************************
  #include <boost/thread.hpp>
  #include <boost/date_time.hpp>
  #include <boost/thread/locks.hpp>  
  #include <boost/thread/shared_mutex.hpp>                  
  #include <boost/container/list.hpp>      
  #include <boost/shared_ptr.hpp>
  #include <boost/make_shared.hpp>
  #include <iostream>

  using namespace std;

  //******************************************************************************
  // LOCAL DEFINES
  //******************************************************************************
  #define NUM_THREADS  10
  #define NUM_WIDTH    5

  #ifdef UNIQUE_MUTEX
  #define MAIN_LIST_MUTEX           g_listMutex
  #define INT_LIST_MUTEX            g_intListMutex
  #define FLOAT_LIST_MUTEX          g_floatListMutex
  #else
  #define MAIN_LIST_MUTEX           g_listMutex
  #define INT_LIST_MUTEX            g_listMutex
  #define FLOAT_LIST_MUTEX          g_listMutex
  #endif

  //******************************************************************************
  // LOCAL TYPEDEFS
  //******************************************************************************
  typedef boost::upgrade_mutex                   myMutex;
  typedef boost::shared_lock<myMutex>            SharedLock;
  typedef boost::upgrade_to_unique_lock<myMutex> UniqueLock;
  typedef boost::upgrade_lock<myMutex>           UpgradeLock;
  class myDataIntf;
  typedef boost::shared_ptr<myDataIntf>          myDataIntfPtr;
  typedef boost::container::list<myDataIntfPtr>  myList;

  //******************************************************************************
  // LOCAL CLASS DECLARATIONS
  //******************************************************************************
  class myDataIntf
  {
  public:
     virtual char* getDataType(void) = 0;
  };

  class intData : public myDataIntf
  {
  private:
     int  data;

  public:
     intData(int new_data) : data(new_data){};
     ~intData(void)
     {
        extern int instIntDeletes;

        instIntDeletes++;
     };
     char* getDataType(void)
     {
        return "Int";
     }
     int getData(void)
     {
        return data;
     }
     void setData(int new_data)
     {
        data = new_data;
     }
  };

  class floatData : public myDataIntf
  {
  private:
     float  data;

  public:
     floatData(float new_data) : data(new_data){};
     ~floatData(void)
     {
        extern int instFloatDeletes;

        instFloatDeletes++;
     };
     char* getDataType(void)
     {
        return "Float";
     }
     float getData(void)
     {
        return data;
     }
     void setData(float new_data)
     {
        data = new_data;
     }
  };

  //******************************************************************************
  // LOCALLY DEFINED GLOBAL DATA
  //******************************************************************************

  // Define one mutex per linked list
  myMutex  g_listMutex;
  myMutex  g_intListMutex;
  myMutex  g_floatListMutex;

  int instReadFloatCount[NUM_THREADS];
  int instWriteFloatCount[NUM_THREADS];
  int instReadIntCount[NUM_THREADS];
  int instWriteIntCount[NUM_THREADS];
  int instFloatDeletes = 0;
  int instIntDeletes = 0;

  //******************************************************************************
  // Worker Thread function
  //******************************************************************************
  void workerFunc(int inst, myList* assigned_list, myMutex*  mutex)
  {
     boost::posix_time::millisec workTime(1*inst);
     myList::iterator            i;
     int                         add_delay = 0;
     int                         add_f_count = 0;
     int                         add_i_count = 0;

     instReadFloatCount[inst] = 0;
     instReadIntCount[inst] = 0;
     instWriteIntCount[inst] = 0;
     instWriteFloatCount[inst] = 0;

     mutex->lock();
     cout << "Worker " << inst << ": ";
     for (i =  assigned_list->begin(); i != assigned_list->end(); ++i)
     {
        cout << (*i)->getDataType();
        if ( 0 == strcmp("Float", (*i)->getDataType() ) )
        {
           floatData*  f = (floatData*)i->get();
           cout << " " << f->getData() << " ";
        }
        if ( 0 == strcmp("Int", (*i)->getDataType() ) )
        {
           intData*  f = (intData*)i->get();
           cout << " " << f->getData() << " ";
        }
     }
     cout << endl;
     mutex->unlock();

     // Do some work for 10 seconds.
     for ( int tick = 0; tick < 10000/(1*inst+1); tick++)
     {
        add_delay++;
        boost::this_thread::sleep(workTime);
        if ( inst < (NUM_THREADS/2) )
        {
           // reader - Get a shared lock that allows multiple readers to
           // access the linked list. Upgrade locks act as shared locks
           // until converted to unique locks, at which point the 
           // thread converting to the unique lock will block until
           // all existing readers are done.  New readers will wait
           // after the unique lock is released.
           SharedLock shared_lock(*mutex);

           for (i =  assigned_list->begin(); i != assigned_list->end(); ++i)
           {
              if ( 0 == strcmp("Float", (*i)->getDataType() ) )
              {
                 floatData*  f = (floatData*)i->get();
                 instReadFloatCount[inst]++;
              }
              if ( 0 == strcmp("Int", (*i)->getDataType() ) )
              {
                 intData*  f = (intData*)i->get();
                 instReadIntCount[inst]++;
              }
           }
        }
        else
        {
           // writer - get the upgrade lock that will allow us
           // to make multiple modifications to the linked list
           // without being interrupted by other writers (other writers attempting
           // to get an upgrade lock will block until the writer that
           // has it releases it.)
           UpgradeLock  upgrade_lock(*mutex);

           for (i =  assigned_list->begin(); i != assigned_list->end(); )
           {
              if ( 0 == strcmp("Float", (*i)->getDataType() ) )
              {
                 floatData*   f = (floatData*)i->get();
                 UniqueLock   unique_lock(upgrade_lock); // Convert an existing upgrade lock to unique lock

                 f->setData(f->getData() + 0.123f);
                 assigned_list->push_front(*i); 
                 assigned_list->erase(i++);
                 instWriteFloatCount[inst]++;

                 // While the unique lock is in scope let's do some additional
                 // adds & deletes
                 if ( (add_delay > 100) && (add_f_count < 2) )
                 {
                    if ( add_f_count < 1)
                    {
                       // Delete the first record
                    }
                    else if ( add_f_count < 2)
                    {
                       // Add new item using separate allocations for smart pointer & data
                       assigned_list->insert(assigned_list->end(), new floatData(-(float)(inst*10000+add_f_count)));
                    }
                    else
                    {
                       // Add new item using make_shared function template.  Both objects are created using one allocation.
                       assigned_list->insert(assigned_list->end(), boost::make_shared<floatData>(-(float)(inst*10000+add_f_count)));
                    }
                    add_f_count++;
                 }
              }
              else if ( 0 == strcmp("Int", (*i)->getDataType() ) )
              {
                 intData*     f = (intData*)i->get();
                 UniqueLock   unique_lock(upgrade_lock); // Convert an existing upgrade lock to unique lock

                 f->setData(f->getData() + 123);
                 assigned_list->push_front(*i);
                 assigned_list->erase(i++);
                 instWriteIntCount[inst]++;

                 // While the unique lock is in scope let's do some additional
                 // adds & deletes
                 if ( (add_delay > 100) && (add_i_count < 3) )
                 {
                    if ( add_i_count < 1)
                    {
                       // Delete the first record
                    }
                    else if ( add_i_count < 2)
                    {
                       // Add new item using separate allocations for smart pointer & data
                       assigned_list->insert(assigned_list->end(), new intData(-(int)(inst*10000+add_i_count)));
                    }
                    else
                    {
                       // Add new item using make_shared function template.  Both objects are created using one allocation.
                       assigned_list->insert(assigned_list->end(), boost::make_shared<intData>(-(int)(inst*10000+add_i_count)));
                    }
                    add_i_count++;
                 }
              }
              else
              {
                 ++i;
              }
           }
        }
     }

     cout << "Worker: finished" << " " << inst << endl;
  }

  //******************************************************************************
  // Main Function
  //******************************************************************************
  int main(int argc, char* argv[])
  {
     {
        myList              test_list;
        myList              test_list_ints;
        myList              test_list_floats;
        myList::iterator    i;

        // Fill the main list with some values
        test_list.insert(test_list.end(), new intData(1));
        test_list.insert(test_list.end(), new intData(2));
        test_list.insert(test_list.end(), new intData(3));
        test_list.insert(test_list.end(), new floatData(333.333f));
        test_list.insert(test_list.end(), new floatData(555.555f));
        test_list.insert(test_list.end(), new floatData(777.777f));

        // Display the main list elements and add the specific values
        // for each specialized list containing specific types of elements.
        // The end result is that each object in the main list will also
        // be in the specialized list.
        cout << "test:";
        for (i =  test_list.begin(); i != test_list.end(); ++i)
        {
           cout << " " << (*i)->getDataType();
           if ( 0 == strcmp("Float", (*i)->getDataType() ) )
           {
              floatData*  f = (floatData*)i->get();
              cout << " " << f->getData();
              test_list_floats.insert(test_list_floats.end(), *i);
           }
           if ( 0 == strcmp("Int", (*i)->getDataType() ) )
           {
              intData*  f = (intData*)i->get();
              cout << " " << f->getData();
              test_list_ints.insert(test_list_ints.end(), *i);
           }
        }
        cout << endl;

        // Display the list with float type elements
        cout << "float test:";
        for (i =  test_list_floats.begin(); i != test_list_floats.end(); ++i)
        {
           cout << " " << (*i)->getDataType();
           floatData*  f = (floatData*)i->get();
           cout << " " << f->getData();
        }
        cout << endl;

        // Display the list with integer type elements
        cout << "int test:";
        for (i =  test_list_ints.begin(); i != test_list_ints.end(); ++i)
        {
           cout << " " << (*i)->getDataType();
           intData*  f = (intData*)i->get();
           cout << " " << f->getData();
        }
        cout << endl;

        // NOTE: To reduce mutex bottleneck coupling in a real application it is recommended that
        // each linked list have it's own shareable mutex.
        // I used the same mutex here for all three lists to have the output from each thread
        // appear in a single line. If I use one mutex per thread then it would appear
        // jumbled up and almost unreadable.
        // To use a unique mutex per list enable UNIQUE_MUTEX macro.
        // For this test I did not notice any performance differences, but that will
        // depend largely on how long the unique lock is held.
        boost::thread workerThread0(workerFunc, 0, &test_list,        &MAIN_LIST_MUTEX);
        boost::thread workerThread1(workerFunc, 1, &test_list_ints,   &INT_LIST_MUTEX);
        boost::thread workerThread2(workerFunc, 2, &test_list_floats, &FLOAT_LIST_MUTEX);
        boost::thread workerThread3(workerFunc, 3, &test_list,        &MAIN_LIST_MUTEX);
        boost::thread workerThread4(workerFunc, 4, &test_list_floats, &FLOAT_LIST_MUTEX);
        boost::thread workerThread5(workerFunc, 5, &test_list_ints,   &INT_LIST_MUTEX);
        boost::thread workerThread6(workerFunc, 6, &test_list,        &MAIN_LIST_MUTEX);
        boost::thread workerThread7(workerFunc, 7, &test_list_floats, &FLOAT_LIST_MUTEX);
        boost::thread workerThread8(workerFunc, 8, &test_list,        &MAIN_LIST_MUTEX);
        boost::thread workerThread9(workerFunc, 9, &test_list_ints,   &INT_LIST_MUTEX);
        workerThread0.join();
        workerThread1.join();
        workerThread2.join();
        workerThread3.join();
        workerThread4.join();
        workerThread5.join();
        workerThread6.join();
        workerThread7.join();
        workerThread8.join();
        workerThread9.join();

        cout << "*** Test End ***:";
        for (i =  test_list.begin(); i != test_list.end(); ++i)
        {
           cout << " " << (*i)->getDataType();
           if ( 0 == strcmp("Float", (*i)->getDataType() ) )
           {
              floatData*  f = (floatData*)i->get();
              cout << " " << f->getData();
           }
           if ( 0 == strcmp("Int", (*i)->getDataType() ) )
           {
              intData*  f = (intData*)i->get();
              cout << " " << f->getData();
           }
        }
        cout << endl;
        cout << "float test end:";
        for (i =  test_list_floats.begin(); i != test_list_floats.end(); ++i)
        {
           cout << " " << (*i)->getDataType();
           floatData*  f = (floatData*)i->get();
           cout << " " << f->getData();
        }
        cout << endl;
        cout << "int test end:";
        for (i =  test_list_ints.begin(); i != test_list_ints.end(); ++i)
        {
           cout << " " << (*i)->getDataType();
           intData*  f = (intData*)i->get();
           cout << " " << f->getData();
        }
        cout << endl;
        cout << "*** thread counts***" << endl;
        for ( int idx = 0; idx < NUM_THREADS; idx++)
        {
           cout << "    thread " << idx;
           cout << ": int rd(" << setw(NUM_WIDTH) << instReadIntCount[idx];
           cout << ") int wr(" << setw(NUM_WIDTH) << instWriteIntCount[idx];
           cout << ") flt rd(" << setw(NUM_WIDTH) << instReadFloatCount[idx];
           cout << ") flt wr(" << setw(NUM_WIDTH) << instWriteFloatCount[idx];
           cout << ")" <<  endl;
        }
     }

     // All records in the linked list have now been deallocated automatically(due to smart pointer)
     // as the linked list objects have been destroyed due to going out of scope.  
     cout << "*** Object Deletion counts***" << endl;
     cout << "  int deletes: " << instIntDeletes << endl;
     cout << "float deletes: " << instFloatDeletes << endl;

     return 0;
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T01:43:48.913

的复杂性`boost::container::list::erase(const_iterator)`是[摊销的常数时间](https://stackoverflow.com/q/200384/424459)（`iterator erase(const_iterator p)`在[boost/container/list.hpp](http://www.boost.org/doc/libs/1_52_0/boost/container/list.hpp)中搜索）。所以调用这个函数时没有重复搜索。

但是，我要提出几点。

一位并发专家最近建议我，只有在确定明确需要之后才使用 UpgradeLockable 概念是明智的；即分析后。与`upgrade_mutex`es 相关的锁必然比简单`boost::mutex::scoped_lock`的 s 或`std::lock_guard`s 更复杂，因此性能较差。

在您的示例中，您可能会发现当前（更复杂的）设置与替换为并始终独占锁定之间没有显着的性能`upgrade_mutex`差异`mutex`。

另一点是您的代码注释似乎表明您认为`boost::upgrade_lock`给定的 a 的多个实例`upgrade_mutex`可以共存。不是这种情况。一次只能有*一个*线程持有一个`upgrade_lock`。

`shared_lock`当 an被持有时，其他几个线程可能持有s `upgrade_lock`，但这些`shared_lock`s 必须在`upgrade_lock`升级为唯一之前释放。

有关详细信息，请参阅[UpgradeLockable Concept](http://www.boost.org/doc/libs/1_52_0/doc/html/thread/synchronization.html#thread.synchronization.mutex_concepts.upgrade_lockable)上的 boost 文档。

* * *

### 编辑

只是为了确认下面评论中的观点，以下示例显示 new`shared_lock`可以在 an`upgrade_lock`存在时获取，但不能在 an`upgrade_to_unique_lock`存在时获取（使用 boost 1.51 测试）：

```
#include <iostream>
#include <vector>

#include <boost/thread.hpp>
#include <boost/date_time.hpp>
#include <boost/thread/locks.hpp>
#include <boost/thread/shared_mutex.hpp>

typedef boost::shared_lock<boost::upgrade_mutex>            SharedLock;
typedef boost::upgrade_to_unique_lock<boost::upgrade_mutex> UniqueLock;
typedef boost::upgrade_lock<boost::upgrade_mutex>           UpgradeLock;

boost::upgrade_mutex the_mutex;

void Write() {
  UpgradeLock upgrade_lock(the_mutex);
  std::cout << "\tPreparing to write\n";
  boost::this_thread::sleep(boost::posix_time::seconds(1));
  UniqueLock unique_lock(upgrade_lock);
  std::cout << "\tStarting to write\n";
  boost::this_thread::sleep(boost::posix_time::seconds(5));
  std::cout << "\tDone writing.\n";
}

void Read() {
  SharedLock lock(the_mutex);
  std::cout << "Starting to read.\n";
  boost::this_thread::sleep(boost::posix_time::seconds(1));
  std::cout << "Done reading.\n";
}

int main() {
  // Start a read operation
  std::vector<boost::thread> reader_threads;
  reader_threads.push_back(std::move(boost::thread(Read)));
  boost::this_thread::sleep(boost::posix_time::milliseconds(250));

  // Start a write operation.  This will block trying to upgrade
  // the UpgradeLock to UniqueLock since a SharedLock currently exists.
  boost::thread writer_thread(Write);

  // Start several other read operations.  These won't be blocked
  // since only an UpgradeLock and SharedLocks currently exist.
  for (int i = 0; i < 25; ++i) {
    boost::this_thread::sleep(boost::posix_time::milliseconds(100));
    reader_threads.push_back(std::move(boost::thread(Read)));
  }

  // Join the readers.  This allows the writer to upgrade to UniqueLock
  // since it's currently the only lock.
  for (auto& reader_thread : reader_threads)
    reader_thread.join();

  // Start a new read operation.  This will be blocked since a UniqueLock
  // currently exists.
  boost::this_thread::sleep(boost::posix_time::milliseconds(100));
  boost::thread reader_thread(Read);

  writer_thread.join();
  reader_thread.join();

  return 0;
} 
```

# sql - 在远程数据库上创建存储过程时语法不正确

> ID：13261497
> 
> 赞同：-1
> 
> 时间：2012-11-07T00:20:45.757
> 
> 标签：sql, sql-server, sql-server-2008, stored-procedures

我正在尝试在托管在远程服务器上的数据库上重新创建存储过程。在本地创建相同的 SP 时，我没有收到任何错误，但是当我尝试在远程服务器上创建 SP 时，我收到以下错误：

```
Msg 102, Level 15, State 1, Procedure MySP, Line 26
Incorrect syntax near 'MERGE'.
Msg 102, Level 15, State 1, Procedure MySP, Line 27
Incorrect syntax near 'S'. 
```

这些错误在多个 SP 中重复出现，当我在本地服务器上创建 SP 时我没有得到它们。知道那会是什么吗？这是一个示例 SP：

```
USE [MyDatabase]
GO
/****** Object:  StoredProcedure [dbo].[InsertContractorInfo]    Script Date: 11/07/2012 01:08:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      <Author,,Name>
-- Create date: <Create Date,,>
-- Description: <Description,,>
-- =============================================
--exec [dbo].[InsertContractorInfo] 
CREATE PROCEDURE [dbo].[InsertContractorInfo]
(@CompanyName nvarchar(50), 
 @LicenseNumber nvarchar(50),
 @MailingAddress1 nvarchar(200),
 @MailingAddress2 nvarchar(200),
 @Phone nvarchar(10),
 @Fax nvarchar(10),
 @Mobile nvarchar(10),
 @Email nvarchar(200),
 @PercentCommercial int,
 @PercentResidental int,
 @TotalEmployees int,
 @AnnualSales decimal(18,2),
 @InsuranceCompanyContact nvarchar(100)=null,
 @InsuranceCompanyContactEmail nvarchar(100)=null,
 @InsuranceCompanyContactPhone nvarchar(100)=null,
 @ContractorID uniqueidentifier)
AS
BEGIN
MERGE dbo.Contractor con
USING(SELECT 1 S) S
ON con.Oid = @ContractorID
WHEN MATCHED THEN UPDATE 
   SET       
      [CompanyName] = @CompanyName      
      ,[LicenseNumber] = @LicenseNumber
      ,[MailingAddress1] = @MailingAddress1
      ,[MailingAddress2] = @MailingAddress2
      ,[Phone] = @Phone
      ,[Fax] = @Fax
      ,[EMail] =@Email
      ,[Mobile] =@Mobile      
      ,[PercentCommercial] = @PercentCommercial
      ,[PercentResidental] = @PercentResidental
      ,[TotalEmployees] = @TotalEmployees
      ,[ApproximateAnnualSales] = @AnnualSales      
      ,[InsuranceCompanyContact] = @InsuranceCompanyContact
      ,[InsuranceCompanyContactPhone] = @InsuranceCompanyContactPhone
      ,[InsuranceCompanyContactEmail] = @InsuranceCompanyContactEmail      
WHEN NOT MATCHED THEN
INSERT 
           ([Oid]       
           ,[CompanyName]           
           ,[LicenseNumber]
           ,[MailingAddress1]
           ,[MailingAddress2]
           ,[Phone]
           ,[Fax]
           ,[EMail]
           ,[Mobile]                      
           ,[PercentCommercial]
           ,[PercentResidental]
           ,[TotalEmployees]
           ,[ApproximateAnnualSales]                      
           ,[InsuranceCompanyContact]
           ,[InsuranceCompanyContactPhone]
           ,[InsuranceCompanyContactEmail])
     VALUES
           (@ContractorId           
           ,@CompanyName           
           ,@LicenseNumber
           ,@MailingAddress1
           ,@MailingAddress2
           ,@Phone
           ,@Fax
           ,@EMail
           ,@Mobile
           ,@PercentCommercial
           ,@PercentResidental
           ,@TotalEmployees
           ,@AnnualSales                     
           ,@InsuranceCompanyContact
           ,@InsuranceCompanyContactPhone
           ,@InsuranceCompanyContactEmail
           );
END
GO 
```

谢谢，拉齐尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T05:50:15.007

您也可以在 CREATE PROCEDURE 脚本之前尝试此操作。

USE [MyDatabase] GO IF EXISTS(SELECT Name FROM SysObjects WHERE ID = OBJECT_ID(N'[InsertContractorInfo]')) BEGIN DROP PROCEDURE InsertContractorInfo END GO

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:41:42.050

此合并功能适用于 sql sever 2008 + 版本，如果您尝试在 sql server 2005 中使用，您可以在 2005 中执行此合并模拟

> [http://sqlserver-tips.blogspot.com/2006/09/mimicking-merge-statement-in-sql.html](http://sqlserver-tips.blogspot.com/2006/09/mimicking-merge-statement-in-sql.html)

# facebook - 获取与 facepy 一起使用的 facebook 访问令牌

> ID：13261498
> 
> 赞同：4
> 
> 时间：2012-11-07T00:20:45.623
> 
> 标签：facebook, facebook-access-token

我正在为学校做一个项目，我必须从 Facebook 获取我所有的朋友数据以及我的一些朋友的朋友数据，以便制作它的图表。为此，我计划使用 facepy，但为此我需要一个访问令牌。我的问题是如何获得此访问令牌？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-13T16:28:16.090

`facepy`本身不包含用于 OAuth 过程的方法

[https://github.com/jgorset/facepy/issues/22](https://github.com/jgorset/facepy/issues/22)

您将需要使用自己的方法或外部库，以便通过 Web 应用程序引导用户。

![服务器登录](../Images/c99fef71d578519239080ecdbdb2cb7d.png)

例如使用`web.py`和`facepy`获得许可`me/posts``read_stream`

```
import web
from facepy import GraphAPI
from urlparse import parse_qs

url = ('/', 'index')

app_id = "YOUR_APP_ID"
app_secret = "APP_SECRET"
post_login_url = "http://0.0.0.0:8080/"

user_data = web.input(code=None)

if not user_data.code:
    dialog_url = ( "http://www.facebook.com/dialog/oauth?" +
                               "client_id=" + app_id +
                               "&redirect_uri=" + post_login_url +
                               "&scope=read_stream" )

    return "<script>top.location.href='" + dialog_url + "'</script>"
else:
    graph = GraphAPI()
    response = graph.get(
        path='oauth/access_token',
        client_id=app_id,
        client_secret=app_secret,
        redirect_uri=post_login_url,
        code=code
    )
    data = parse_qs(response)
    graph = GraphAPI(data['access_token'][0])
    graph.get('me/posts') 
```

有关更多信息，请参阅

[* Facebook API - 用户帖子： http: [//developers.facebook.com/docs/reference/api/user/#posts](http://developers.facebook.com/docs/reference/api/user/#posts)
* 用 Python 发布 Facebook 照片 - 基础知识：http: [//philippeharewood.com/facebook/publish -a-facebook-photo-in-python-the-basic-sauce/](http://philippeharewood.com/facebook/publish-a-facebook-photo-in-python-the-basic-sauce/)
* Facebook 和 Python - 基本酱汁： http: [//philippeharewood.com/facebook/facebook-and-python-the-basic-sauce/](http://philippeharewood.com/facebook/facebook-and-python-the-basic-sauce/)]

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-07T00:25:34.343

基本上，您只需要登录。如果您转到[图形 API 概览页面](https://developers.facebook.com/docs/reference/api/)，它会要求您使用自己的 Facebook 帐户登录。之后，页面上的所有链接都将拥有一个访问令牌，该令牌有权查看您可以看到的任何内容。

# php - 没有 jQuery 的跨域 AJAX 解决方法

> ID：13261501
> 
> 赞同：0
> 
> 时间：2012-11-07T00:20:58.953
> 
> 标签：php, javascript, html, ajax

我在博客页面上有自定义 AJAX 代码，我设置它来访问我自己域上的 PHP 文件，但是哦，不！我不能那样做。

我会使用 jQuery 来解决这个问题，但不能，因为我无法将明显必要的 jQuery.js 上传到网站，因为它不是我的。

**有没有办法通过仅**在页面上修改 HTML 来访问 PHP 请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:27:44.033

如果您可以从您的站点链接到外部站点，则不必托管 jQuery：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script> 
```

# c++ - 使用 boost 精神 (longest_d) 解析 int 或 double

> ID：13261502
> 
> 赞同：9
> 
> 时间：2012-11-07T00:21:02.223
> 
> 标签：c++, boost, boost-spirit, boost-spirit-qi

我正在寻找一种将字符串解析为 int 或 double 的方法，解析器应该尝试两种选择并选择与输入流的最长部分匹配的那个。

有一个已弃用的指令 (longest_d) 完全符合我的要求：

```
number = longest_d[ integer | real ]; 
```

...因为它已被弃用，还有其他选择吗？如果有必要实施语义动作来实现所需的行为，有人有建议吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-07T10:59:31.620

首先，一定要切换到 Spirit V2——它已经取代了*古典*精神多年。

其次，您需要确保 int 得到首选。默认情况下，double 可以同样好地解析任何整数，因此您需要`strict_real_policies`改用：

```
real_parser<double, strict_real_policies<double>> strict_double; 
```

现在你可以简单地说

```
number = strict_double | int_; 
```

看

*   [实际政策文件](http://www.boost.org/doc/libs/1_52_0/libs/spirit/doc/html/spirit/qi/reference/numeric/real.html#spirit.qi.reference.numeric.real._code__phrase_role__identifier__realpolicies__phrase___code_)

**[查看Coliru 上的实时](http://coliru.stacked-crooked.com/a/07c40aa42b49ca05)**测试程序

```
#include <boost/spirit/include/qi.hpp>

using namespace boost::spirit::qi;

using A  = boost::variant<int, double>;
static real_parser<double, strict_real_policies<double>> const strict_double;

A parse(std::string const& s)
{
    typedef std::string::const_iterator It;
    It f(begin(s)), l(end(s));
    static rule<It, A()> const p = strict_double | int_;

    A a;
    assert(parse(f,l,p,a));

    return a;
}

int main()
{
    assert(0 == parse("42").which());
    assert(0 == parse("-42").which());
    assert(0 == parse("+42").which());

    assert(1 == parse("42.").which());
    assert(1 == parse("0.").which());
    assert(1 == parse(".0").which());
    assert(1 == parse("0.0").which());
    assert(1 == parse("1e1").which());
    assert(1 == parse("1e+1").which());
    assert(1 == parse("1e-1").which());
    assert(1 == parse("-1e1").which());
    assert(1 == parse("-1e+1").which());
    assert(1 == parse("-1e-1").which());
} 
```

# android - 当我删除进度对话框时，它可以工作。为什么？

> ID：13261504
> 
> 赞同：0
> 
> 时间：2012-11-07T00:21:06.520
> 
> 标签：android, progressdialog

我有一个进程的进度对话框。但是我在我的线程中出现了一个空指针异常。但是，当我删除进度对话框时。我不再例外。

我的代码是这样的

```
public class PlayedActivity extends ListActivity {

private PullToRefreshListView listView;

final Context context = this;

public Handler handler;

Runnable sendNumbers2;

List<On> playedOn;

DatabaseHandlerOn db;

private ProgressDialog m_ProgressDialog;

private ArrayList<On> m_results = null;
private PlayedOnAdapter m_adapter;

    @SuppressLint({ "HandlerLeak", "HandlerLeak" })
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_playedonnumara);

            db = new DatabaseHandlerOnNumara(getApplicationContext());

            m_results = new ArrayList<OnNumara>();

        this.m_adapter = new PlayedOnNumaraAdapter(this, R.layout.playedrowon, m_results);
        this.setListAdapter(this.m_adapter);

        sendNumbers2 = new Runnable() {

            @Override
            public void run() {

                playedOn = db.getAllContacts();      

                for (On on : playedOn) {

                    m_results.add(on);  

                }  

                Collections.reverse(m_results);

                //m_ProgressDialog.dismiss();

                handler.sendEmptyMessage(0);
            }
        };
            Thread thread = new Thread(sendNumbers2,"sendNumbers2");
            thread.start();

            /*m_ProgressDialog = ProgressDialog.show(PlayedOnNumaraActivity.this,
                    "",getString(R.string.PleaseWait), true);

            m_ProgressDialog.setCancelable(true);
        */

            handler = new Handler() {
                @Override
                public void handleMessage(Message msg) {

                    m_adapter.notifyDataSetChanged();

                }

             };

        }
}

} 
```

上面的代码正在运行，并且在进度对话框代码被注释时也不例外

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T00:26:18.683

如果没有您的 LogCat 日志，我只能猜测。

`m_ProgressDialog`在您启动线程后定义。为什么？在线程启动之前定义它。

另外，我会为此推荐一个[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html)。有关详细信息，请参阅[无痛线程](http://android-developers.blogspot.ca/2009/05/painless-threading.html)。

# php - 从 MySQL 数据库填充下拉列表的问题

> ID：13261505
> 
> 赞同：0
> 
> 时间：2012-11-07T00:21:06.233
> 
> 标签：php, mysqli

嗨，使用以下 php 代码，我正在尝试从 mysql 数据库中填充一个保管箱：

```
enter code here
<?php
$mysqli = new mysqli('localhost', 'root', '', 'testdb');
if (mysqli_connect_errno())
 {
   die('Unable to connect!');
 }
else
{
 $query = 'SELECT * FROM language';
  if ($result = $mysqli->query($query))
   {
    if ($result->num_rows > 0)
     {
 ?>
   <p> Select a language
    <select id="selectLanguage">
    <option value="">select</option>
 <?php
    while($row = $result->fetch_assoc())
 {
  ?>
  <option value='<?php echo $row[0]; ?>'><?php echo $row[1]; ?></option>
 <?php
  }
   ?>
 </select>
 </p>
  <p id="result"></p>
 <?php
  }
 else
  {
   echo 'No records found!';
   }
 $result->close();
   }
  else
   {
      echo 'Error in query: $query. '.$mysqli->error;
    }
   }
   $mysqli->close();
   ?> 
```

我没有收到任何错误，但是此消息填充的保管箱而不是存储在数据库中的单元格值：（ **！）注意：第 40 行 C:\wamp\test\index.ph 中的未定义偏移量：0 Call Stack#TimeMemoryFunctionLocation 10.0009684656{ main}()...\index.php:0'>** 你能告诉我为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:29:00.570

你的问题在这里：

```
<option value='<?php echo $row[0]; ?>'><?php echo $row[1]; ?></option> 
```

您使用关联的数组获取数据。不是索引数组。

```
 while($row = $result->fetch_assoc()) 
```

您会收到该错误消息，因为索引“1”不存在。

# javascript - ie8中的getElementsByClassName

> ID：13261506
> 
> 赞同：2
> 
> 时间：2012-11-07T00:21:18.440
> 
> 标签：javascript, html, css, internet-explorer-8

我正在尝试在 Internet Explorer 8 中为我拥有的 HTML 创建一个可折叠列表：

```
<li>
 <a href="#" onclick="test('node1')">hello</a>
 <ul id="node1" class="node" style="display:none">
   <li>Sub-item 1</li>
   <li>Sub-item 2</li>
 </ul>
</li>
<li>
 <a href="#" onclick="test('node2')">test</a>
  <ul id="node2" class="node" style="display:none">
   <li>Sub-item 1</li>
   <li>Sub-item 2</li>
 </ul>
</li> 
```

在javascript中我有

```
function test2(className, link) {
 var e = document.getElementsByClassName(className);

 for (var i = 0, len = e.length; i < len; i++) {
   e[i].style.display = "none";
  }

  link.innerHTML = "Expand";
 } 
```

我用这个来称呼它：

```
 <a href="#" onclick="test2('node', this)">Collapse</a> 
```

不幸的是，这种方法在 IE8 中不起作用，`querySelectAll`. 有人可以提供一个如何解决这个问题的例子吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-11T00:29:11.620

这是通过扩展`Element.prototype`和 的快速解决方案`document`：

```
(function() {
if (!document.getElementsByClassName) {
    var indexOf = [].indexOf || function(prop) {
        for (var i = 0; i < this.length; i++) {
            if (this[i] === prop) return i;
        }
        return -1;
    };
    getElementsByClassName = function(className, context) {
        var elems = document.querySelectorAll ? context.querySelectorAll("." + className) : (function() {
            var all = context.getElementsByTagName("*"),
                elements = [],
                i = 0;
            for (; i < all.length; i++) {
                if (all[i].className && (" " + all[i].className + " ").indexOf(" " + className + " ") > -1 && indexOf.call(elements, all[i]) === -1) elements.push(all[i]);
            }
            return elements;
        })();
        return elems;
    };
    document.getElementsByClassName = function(className) {
        return getElementsByClassName(className, document);
    };

    if(Element) {
        Element.prototype.getElementsByClassName = function(className) {
            return getElementsByClassName(className, this);
        };
    }
}
})(); 
```

然而，扩展原型对象并不总是最好的主意，尤其是对于一个名称与不存在的本机函数完全一样的函数。如果你想逃避原型扩展带来的问题，使用这段代码：

```
(function() {
    var indexOf = [].indexOf || function(prop) {
        for (var i = 0; i < this.length; i++) {
            if (this[i] === prop) return i;
        }
        return -1;
    };
    window.getElementsByClassName = function(className,context) {
        if (context.getElementsByClassName) return context.getElementsByClassName(className);
        var elems = document.querySelectorAll ? context.querySelectorAll("." + className) : (function() {
            var all = context.getElementsByTagName("*"),
                elements = [],
                i = 0;
            for (; i < all.length; i++) {
                if (all[i].className && (" " + all[i].className + " ").indexOf(" " + className + " ") > -1 && indexOf.call(elements,all[i]) === -1) elements.push(all[i]);
            }
            return elements;
        })();
        return elems;
    };
})();​ 
```

这样，您可以安全地使用`getElementsByClassName()`接受两个参数的函数：

1.  `className`: CSS 类
2.  `context`: 节点

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-07T00:23:14.830

IE8不支持`getElementsByClassName`，但是支持`querySelectorAll`。

要使用`querySelectorAll`，您需要一个有效的类选择器，这意味着它需要对一个类使用 Selectors API 语法，该语法使用 a`.`来表示一个类。

```
function test2(className, link) {
    var e = document.querySelectorAll("." + className);

    for (var i = 0, len = e.length; i < len; i++) {
        e[i].style.display = "none";
    }

    link.innerHTML = "Expand";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T02:53:47.873

如果它不存在，您可以自己实现它：

```
// shim for older browsers:
if (!document.getElementsByClassName) {
    document.getElementsByClassName = (function(){
        // Utility function to traverse the DOM:
        function traverse (node, callback) {
            callback(node);
            for (var i=0;i < node.childNodes.length; i++) {
                traverse(node.childNodes[i],callback);
            }
        }

        // Actual definition of getElementsByClassName
        return function (name) {
            var result = [];
            traverse(document.body,function(node){
                if (node.className == name) {
                    result.push(node);
                }
            });
            return result;
        }
    })()
} 
```

现在您可以`document.getElementsByClassName`在旧版浏览器中使用。shim 和本机实现之间的一个区别是 shim 返回一个真正的数组而不是 nodelist（或 htmlelementcollection）。

# diff - 如何在 Kdiff3 中隐藏匹配行

> ID：13261507
> 
> 赞同：14
> 
> 时间：2012-11-07T00:21:29.010
> 
> 标签：diff, kdiff3

有谁知道在 Kdiff3（在 Windows 中）中**隐藏匹配行的方法。**我真的只关心差异，宁愿快速滚动浏览差异列表，而无需在两者之间添加所有填充符（即匹配行）。

我对其他软件选项持开放态度，但我很难相信 Kdiff3 没有此功能。

# android - 滑动整个应用程序窗口以在下面显示一个新菜单？

> ID：13261508
> 
> 赞同：0
> 
> 时间：2012-11-07T00:21:30.173
> 
> 标签：android, android-layout, android-widget

我有一个带有操作栏、片段等的应用程序，我想通过向上拉底部栏来获得一个额外的菜单。当它被拉起时，整个屏幕应该向上移动，显示菜单。

我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:32:46.020

我可能会将您的主要视图包含在布局中（称为“A”），将其放在 a 中`RelativeLayout`，然后将您的菜单（“B”）放在它后面（因此它们被覆盖）。当您的底部栏被向上拖动时，您必须计算手指 delta-Y 位置（从`GestureDetector`或类似位置），并将“A”向上移动该数量，将“B”留在原处。

不过要非常非常小心，因为在 Android 4.1+ 设备上从屏幕底部向上滑动会显示 Google Now。我建议您改用[滑动菜单库](https://github.com/iPaulPro/SlidingMenu)（而是从左侧滑入）。

# python - 嵌入式文档 MongoDB 的最佳数据结构是什么？

> ID：13261511
> 
> 赞同：0
> 
> 时间：2012-11-07T00:21:46.487
> 
> 标签：python, mongodb

假设我的每个用户都可以保存许多“智能搜索”：

```
user = {
    'username':'johncit',
    'smart_searches': [
        {'name':'last 24 hrs','terms':{'modifiedby':datetime(2012,1,1),'title':'foobar'}},
        {'name':'blabla','terms':{'title':'whatever','otherfield':500}}
            ]
        } 
```

现在说约翰点击了他的“blabla”搜索。我如何获得条款？我可以像这样得到约翰的所有智能搜索：

```
db.Users.find_one({
        'username':'johncit','smart_searches':{'$elemMatch':{'Name':'blabla'}}}) 
```

但这会返回整个文档，而不仅仅是我真正需要的“blabla”搜索的术语。然后我必须弄清楚客户端的确切条款吗？或者这是将“smart_searches”放在他们自己的收藏中的情况吗？有更好的结构吗？

我很想听听你的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:32:54.013

[位置运算符](http://www.mongodb.org/display/DOCS/Updating#Updating-The%24positionaloperator)会解决问题

```
> db.Users.find({'username':'johncit','smart_searches':{'$elemMatch':{'name':'blabla'}}},{'smart_searches.$.terms':1}).pretty()
{
    "_id" : ObjectId("5099ab303d550a068f16d5c5"),
    "smart_searches" : [
        {
            "name" : "blabla",
            "terms" : {
                "title" : "whatever",
                "otherfield" : 500
            }
        }
    ]
} 
```

**更新：**

要使用位置运算符更新术语，您可以编写

```
db.Users.update({'username':'johncit',
                 'smart_searches':{'$elemMatch':{'name':'blabla'}}},
                  {$set:{'smart_searches.$.terms':{title:'changed',otherfield:200}}},
                  false,true) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:33:13.850

您想使用[`$elemMatch`](http://docs.mongodb.org/manual/reference/projection/elemMatch/)投影运算符而不是查询运算符。

```
db.Users.find_one(
    {'username':'johncit', 'smart_searches.name':'blabla'},
    {'username': 1, 'smart_searches': {'$elemMatch': {'name':'blabla'}}}) 
```

您不需要`$elemMatch`在查询对象中使用，因为您只匹配一个组件：`name`.

# jquery - 在悬停（）上的jQuery中的位置

> ID：13261514
> 
> 赞同：1
> 
> 时间：2012-11-07T00:22:09.397
> 
> 标签：jquery, html

我是 jQuery 解决方案的新手，我知道你们中的很多人都在使用它，所以也许有人可以帮助我解决这个问题。

我正在尝试在另一个元素的悬停上更改 div 的位置。

这是我尝试过的代码：

```
<script>
$(document).ready(function(){
$(".NEWS_menu").hover(function(){$("#dropdown_NEWS").position({
my: "bottom",
at: "top",
of: ".NEWS_menu"
})});

</script>

<ul class="lithos gradient" id="menu">
    <li><a class="NEWS_menu" href="/news/index.php"><span class="BIGLETTER">N</span>ouvelles</a>
        <div id="dropdown_NEWS">
            <a class="ARTICLES_link" href="#"><span class="BIGLETTER">A</span>rticles</a>
        </div>
    </li>
[...] 
```

[academiemarisa.com](http://academiemarisa.com)如果你想看看它应该给我什么。

代码尚未上传。我试图让它首先与 jquery 一起工作。

现在，它与 CSS :hover 一起工作得很好，但出于兼容性原因，我需要 jQuery。

如果有人可以帮助我定位 jQuery。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T06:44:25.783

假设#dropdown_NEWS 绝对定位，您可以使用jQuery css 方法将其定位在悬停的菜单下。也许是这样的：

```
$(".NEWS_menu").hover(function(){$("#dropdown_NEWS").css({ "left": "value", "top": "value", })}); 
```

# facebook - access_token facebook 注册说“试图获取非对象的属性”

> ID：13261521
> 
> 赞同：-1
> 
> 时间：2012-11-07T00:22:57.540
> 
> 标签：facebook, codeigniter, access-token

我在 facebook 注册时遇到了一些“试图获得非对象的财产”的问题。服务器返回与 access_token 相关的错误。

我在第 490 行和第 451 行有错误。在第 451 行我成功解决了它，但我仍然在第 490 行有 2 个错误。

该行是通过将 if ( $token->access_token ) 更改为 if ( $token['access_token'] ) 来修复的，我认为问题出在 codeigniter 上。

第 490 行如下：

```
 private function _token_string()
    {
        return 'access_token='.$this->_get('token')->access_token;
    } 
```

这是整个代码：

```
class Facebook_Lib extends CI_Config
{

    private $_api_url;
    private $_api_key;
    private $_api_secret;
    private $_errors = array();
    private $_enable_debug = FALSE;

    function __construct()
    {
        $this->_obj =$CI =& get_instance();

        $this->_obj->load->library('session');
        $this->_obj->load->helper('url');
        $this->_obj->load->helper('facebook');

        $fb_api_id     = $CI->db->get_where('settings', array('code' => 'SITE_FB_API_ID'))->row()->string_value;
        $fb_api_secret = $CI->db->get_where('settings', array('code' => 'SITE_FB_API_SECRET'))->row()->string_value;

        $this->_api_url        = $this->_obj->config->item('facebook_api_url');
        $this->_api_key     = $fb_api_id;
        $this->_api_secret  = $fb_api_secret;

        $this->session = new facebookSession();
        $this->connection = new facebookConnection();
    }

    public function logged_in()
    {
        return $this->session->logged_in();
    }

    public function login($scope = NULL)
    {
        return $this->session->login($scope);
    }

    public function login_url($scope = NULL)
    {
        return $this->session->login_url($scope);
    }

    public function logout()
    {
        return $this->session->logout();
    }

    public function user()
    {
        return $this->session->get();
    }

    public function call($method, $uri, $data = array())
    {
        $response = FALSE;

        try
        {
            switch ( $method )
            {
                case 'get':
                    $response = $this->connection->get($this->append_token($this->_api_url.$uri));
                break;

                case 'post':
                    $response = $this->connection->post($this->append_token($this->_api_url.$uri), $data);
                break;
            }
        }
        catch (facebookException $e)
        {
            $this->_errors[] = $e;

            if ( $this->_enable_debug )
            {
                echo $e;
            }
        }

        return $response;
    }

    public function errors()
    {
        return $this->_errors;
    }

    public function last_error()
    {
        if ( count($this->_errors) == 0 ) return NULL;

        return $this->_errors[count($this->_errors) - 1];
    }

    public function append_token($url)
    {
        return $this->session->append_token($url);
    }

    public function set_callback($url)
    {
        return $this->session->set_callback($url);
    }

    public function enable_debug($debug = TRUE)
    {
        $this->_enable_debug = (bool) $debug;

    }
}

class facebookConnection {

    // Allow multi-threading.

    private $_mch = NULL;
    private $_properties = array();

    function __construct()
    {
        $this->_mch = curl_multi_init();

        $this->_properties = array(
            'code'      => CURLINFO_HTTP_CODE,
            'time'      => CURLINFO_TOTAL_TIME,
            'length'    => CURLINFO_CONTENT_LENGTH_DOWNLOAD,
            'type'      => CURLINFO_CONTENT_TYPE
        );
    }

    private function _initConnection($url)
    {
        $this->_ch = curl_init($url);
        curl_setopt($this->_ch, CURLOPT_RETURNTRANSFER, TRUE);
    }

    public function get($url, $params = array())
    {
        if ( count($params) > 0 )
        {
            $url .= '?';

            foreach( $params as $k => $v )
            {
                $url .= "{$k}={$v}&";
            }

            $url = substr($url, 0, -1);
        }

        $this->_initConnection($url);
        $response = $this->_addCurl($url, $params);

        return $response;
    }

    public function post($url, $params = array())
    {
        // Todo
        $post = '';

        foreach ( $params as $k => $v )
        {
            $post .= "{$k}={$v}&";
        }

        $post = substr($post, 0, -1);

        $this->_initConnection($url, $params);
        curl_setopt($this->_ch, CURLOPT_POST, 1);
        curl_setopt($this->_ch, CURLOPT_POSTFIELDS, $post);

        $response = $this->_addCurl($url, $params);

        return $response;
    }

    private function _addCurl($url, $params = array())
    {
        $ch = $this->_ch;

        $key = (string) $ch;
        $this->_requests[$key] = $ch;

        $response = curl_multi_add_handle($this->_mch, $ch);

        if ( $response === CURLM_OK || $response === CURLM_CALL_MULTI_PERFORM )
        {
            do {
                $mch = curl_multi_exec($this->_mch, $active);
            } while ( $mch === CURLM_CALL_MULTI_PERFORM );

            return $this->_getResponse($key);
        }
        else
        {
            return $response;
        }
    }

    private function _getResponse($key = NULL)
    {
        if ( $key == NULL ) return FALSE;

        if ( isset($this->_responses[$key]) )
        {
            return $this->_responses[$key];
        }

        $running = NULL;

        do
        {
            $response = curl_multi_exec($this->_mch, $running_curl);

            if ( $running !== NULL && $running_curl != $running )
            {
                $this->_setResponse($key);

                if ( isset($this->_responses[$key]) )
                {
                    $response = new facebookResponse( (object) $this->_responses[$key] );

                    if ( $response->__resp->code !== 200 )
                    {
                        $error = $response->__resp->code.' | Request Failed';

                        if ( isset($response->__resp->data->error->type) )
                        {
                            $error .= ' - '.$response->__resp->data->error->type.' - '.$response->__resp->data->error->message;
                        }

                        throw new facebookException($error);
                    }

                    return $response;
                }
            }

            $running = $running_curl;

        } while ( $running_curl > 0);

    }

    private function _setResponse($key)
    {
        while( $done = curl_multi_info_read($this->_mch) )
        {
            $key = (string) $done['handle'];
            $this->_responses[$key]['data'] = curl_multi_getcontent($done['handle']);

            foreach ( $this->_properties as $curl_key => $value )
            {
                $this->_responses[$key][$curl_key] = curl_getinfo($done['handle'], $value);

                curl_multi_remove_handle($this->_mch, $done['handle']);
            }
      }
    }
}

class facebookResponse {

    private $__construct;

    public function __construct($resp)
    {
        $this->__resp = $resp;

        $data = json_decode($this->__resp->data);

        if ( $data !== NULL )
        {
            $this->__resp->data = $data;
        }
    }

    public function __get($name)
    {
        if ($this->__resp->code < 200 || $this->__resp->code > 299) return FALSE;

        $result = array();

        if ( is_string($this->__resp->data ) )
        {
            parse_str($this->__resp->data, $result);
            $this->__resp->data = (object) $result;
        }

        if ( $name === '_result')
        {
            return $this->__resp->data;
        }

        return $this->__resp->data->$name;
    }
}

class facebookException extends Exception {

    function __construct($string)
    {
        parent::__construct($string);
    }

    public function __toString() {
        return "exception '".__CLASS__ ."' with message '".$this->getMessage()."' in ".$this->getFile().":".$this->getLine()."\nStack trace:\n".$this->getTraceAsString();
    }
}

class facebookSession {

    private $_api_key;
    private $_api_secret;
    private $_token_url     = 'oauth/access_token';
    private $_user_url      = 'me';
    private $_data          = array();

    function __construct()
    {
        $this->_obj =$CI =& get_instance();

        $fb_api_id     = $CI->db->get_where('settings', array('code' => 'SITE_FB_API_ID'))->row()->string_value;
        $fb_api_secret = $CI->db->get_where('settings', array('code' => 'SITE_FB_API_SECRET'))->row()->string_value;

        $this->_api_key     = $fb_api_id;
        $this->_api_secret  = $fb_api_secret;

        $this->_token_url   = $this->_obj->config->item('facebook_api_url').$this->_token_url;
        $this->_user_url    = $this->_obj->config->item('facebook_api_url').$this->_user_url;

        $this->_set('scope', $this->_obj->config->item('facebook_default_scope'));

        $this->connection = new facebookConnection();

        if ( !$this->logged_in() )
        {
             // Initializes the callback to this page URL.
            $this->set_callback();
        }

    }

    public function logged_in()
    {
        return ( $this->get() === NULL ) ? FALSE : TRUE;
    }

    public function logout()
    {
        $this->_unset('token');
        $this->_unset('user');
    }

    public function login_url($scope = NULL)
    {
        $url = "http://www.facebook.com/dialog/oauth?client_id=".$this->_api_key.'&redirect_uri='.urlencode($this->_get('callback'));

        if ( empty($scope) )
        {
            $scope = $this->_get('scope');
        }
        else
        {
            $this->_set('scope', $scope);
        }

        if ( !empty($scope) )
        {
            $url .= '&scope='.$scope;
        }

        return $url;
    }

    public function login($scope = NULL)
    {
        $this->logout();

        if ( !$this->_get('callback') ) $this->_set('callback', current_url());

        $url = $this->login_url($scope);

        return redirect($url);
    }

    public function get()
    {
        $token = $this->_find_token();
        if ( empty($token) ) return NULL;

        // $user = $this->_get('user');
        // if ( !empty($user) ) return $user;

        try 
        {
            $user = $this->connection->get($this->_user_url.'?'.$this->_token_string());
        }
        catch ( facebookException $e )
        {
            $this->logout();
            return NULL;
        }

        // $this->_set('user', $user);
        return $user;
    }

    private function _find_token()
    {
        $token = $this->_get('token');

        if ( !empty($token) )
        {
            if ( !empty($token->expires) && intval($token->expires) >= time() )
            {
                // Problem, token is expired!
                return $this->logout();
            }

            $this->_set('token', $token);
            return $this->_token_string();
        }

        if ( !isset($_GET['code']) )
        {
            return $this->logout();
        }

        if ( !$this->_get('callback') ) $this->_set('callback', current_url());
        $token_url = $this->_token_url.'?client_id='.$this->_api_key."&client_secret=".$this->_api_secret."&code=".$_GET['code'].'&redirect_uri='.urlencode($this->_get('callback'));

        try 
        {
            $token = $this->connection->get($token_url);
        }
        catch ( facebookException $e )
        {
            $this->logout();
            redirect($this->_strip_query());
            return NULL;
        }

        $this->_unset('callback');

        if ( $token['access_token'] )
        {
            if ( !empty($token->expires) )
            {
                $token->expires = strval(time() + intval($token->expires));
            }

            $this->_set('token', $token);
            redirect($this->_strip_query());
        }

        return $this->_token_string();
    }

    private function _get($key)
    {
        $key = '_facebook_'.$key;
        return $this->_obj->session->userdata($key);
    }

    private function _set($key, $data)
    {
        $key = '_facebook_'.$key;
        $this->_obj->session->set_userdata($key, $data);
    }

    private function _unset($key)
    {
        $key = '_facebook_'.$key;
        $this->_obj->session->unset_userdata($key);
    }

    public function set_callback($url = NULL)
    {
        $this->_set('callback', $this->_strip_query($url));
    }

    private function _token_string()
    {
        return 'access_token='.$this->_get('token')->access_token;
    }

    public function append_token($url)
    {
        if ( $this->_get('token') ) $url .= '?'.$this->_token_string();

        return $url;
    }

    private function _strip_query($url = NULL)
    {
        if ( $url === NULL )
        {
            $url = ( empty($_SERVER['HTTPS']) ) ? 'http' : 'https';
            $url .= '://'.$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'];
        }

        $parts = explode('?', $url);
        return $parts[0];
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T22:27:50.180

我不确定这个库发生了什么。在第 451 行，您正在 $token 数组中查找返回的值，然后它通过一种非常复杂的方式在 CI 会话中设置它，然后立即从 CI 会话中调用它。

第 458 行将令牌设置到会话中，然后在 462 上他们返回它，但通过调用一个方法来调用返回 session->userdata('token') 的方法。这似乎是它在 490 上失败的原因，因为它获取了会话数据中的值，但随后尝试在返回值之上查找 ->access_token 的数据并且该数据不存在。

在第 462 行之前转储 $token 并查看它是对象还是数组。如果它是 ann 数组，那么这将解释为什么 490 上的 ->access_token 不起作用。如果它是一个对象，那么我会将第 462 行更改为

```
return 'access_token='.$token->access_token; 
```

或者 $token 的转储说明对象的值是什么（我假设它是 access_token），看看它是否有效。如果确实如此，那么您必须弄清楚他们为什么要编写所有这些额外的步骤以及它将用于什么。如果没有，那就说它好。

Facebook 在 github 上有一个编写的库，您可以将其放入 codeigniter 中的库目录中，它会正常工作。我建议放弃你正在使用的这个课程，只使用 Facebook 提供的课程。通过这种方式，您可以直接从他们的开发者网站了解如何与 Facebook 集成，并且如果他们更改了 API 调用，您不必重写代码；您只需替换库目录中的两个文件。

[https://github.com/facebook/facebook-php-sdk/tree/master/src](https://github.com/facebook/facebook-php-sdk/tree/master/src)

希望这可以帮助。

# perl - perl中的大写重音字符

> ID：13261522
> 
> 赞同：3
> 
> 时间：2012-11-07T00:23:00.153
> 
> 标签：perl, uppercase

有没有办法在 perl 中大写重音字符，

```
my $string = "éléphant";

print uc($string); 
```

所以它实际上打印 ÉLÉPHANT ？

我的 perl 脚本以 ISO-8859-1 编码，$string 以相同编码打印在 xml 文件中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-07T00:41:18.497

`perl`只懂 US-ASCII 和 UTF-8，后者需要

```
use utf8; 
```

如果要将文件保留为`iso-8859-1`，则需要显式解码文本。

```
use open ':std', ':encoding(locale)';
use Encode qw( decode );

# Source is encoded using iso-8859-1, so we need to decode ourselves.
my $string = decode("iso-8859-1", "éléphant");
print uc($string); 
```

但最好将脚本转换为 UTF-8。

```
use utf8;  # Source is encoded using UTF-8
use open ':std', ':encoding(locale)';

my $string = "éléphant";
print uc($string); 
```

如果要打印到文件，请确保`:encoding(iso-8859-1)`在打开文件时使用（无论您使用哪种替代方法）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T00:34:38.557

尝试这样做：

```
use Encode qw/encode decode/;

my $enc = 'utf-8'; # This script is stored as UTF-8
my $str = "éléphant\n";

my $text_str = decode($enc, $str);
$text_str = uc $text_str;
print encode($enc, $text_str); 
```

**输出**：

```
ÉLÉPHANT 
```

# javascript - jQuery/JS 重定向文件拖放到不同的元素

> ID：13261524
> 
> 赞同：1
> 
> 时间：2012-11-07T00:23:11.530
> 
> 标签：javascript, jquery, drag-and-drop, wordpress

我正在为 WordPress Drag 'n' Drop 上传器制作一个解决方法插件原型，以帮助将 DnD 文件上传直接包含到系统中（生成正确的数据库条目等），而不会增加太多开销、重建或黑客攻击。

我遇到了一个障碍，试图获取放入元素中的文件并以编程方式模拟它们被放入不同的元素（以触发 WP 中的本机上传序列）。

JS

```
$('#uploader').on(
    {dragenter: function(e) {
        e.preventDefault();
        e.stopPropagation();
        console.log('dragenter');
    },
    dragover: function(e) {
        e.preventDefault();
        e.stopPropagation();
        console.log('dragover');
    },
    drop: function(e){
        if(e.originalEvent.dataTransfer){
            if(e.originalEvent.dataTransfer.files.length) {
                e.preventDefault();
                e.stopPropagation();
                /*Do Stuff*/
        var id, remoteFrame, uploader, plupload, file, i, files = [], id, fileNames = {}, native_files;

                    remoteFrame = $('#media_uploader_hidden')[0].contentWindow; // iFrame context
                    plupload = remoteFrame.plupload // localize
                    uploader = remoteFrame.uploader; // localize

                    native_files = e.originalEvent.dataTransfer.files; // raw files

                // Initialize Runtime
                plupload.runtimes['Html5'].init(uploader,function(){console.log('initialized HTML5')});

                // Add files to the file queue
                for (i = 0; i < native_files.length; i++) {
                    file = native_files[i];

                    // Safari on Windows will add first file from dragged set multiple times
                    // @see: https://bugs.webkit.org/show_bug.cgi?id=37957
                    if (fileNames[file.name]) {
                        continue;
                    }
                    fileNames[file.name] = true;

                    // Store away gears blob internally
                    id = plupload.guid();

                    // Create queue array with id, name and size
                    files.push(new plupload.File(id, file.fileName || file.name, file.fileSize || file.size)); // fileName / fileSize deprecated
                }

                // Trigger FilesAdded event if we added any
                if (files.length) {
                    uploader.trigger("FilesAdded", files);
                }

                console.log(uploader.files);

            }   
        }
        console.log('drop');
    }},
    '.drag-drop-area'
); 
```

HTML：

```
<div id="uploader"><div class=".drag-drop-area"></div></div>
<div id="test"></div> 
```

我确实有一个日志集以在某些内容“丢弃”到#test 时触发。

最终，被删除的文件将被定向到带有 WordPress 媒体上传器的隐藏 iFrame 中的元素。

**编辑：** 一直在寻找一种直接插入 Plupload（WordPress 用于 DND 的 jQuery 插件）以将文件添加到队列中的方法 - 但找不到任何东西。似乎所有“添加到队列”功能都包含在内。

# jquery - 为什么我不能在 jQuery ajax/post 中发送数据数组？

> ID：13261528
> 
> 赞同：2
> 
> 时间：2012-11-07T00:23:24.867
> 
> 标签：jquery, ajax

我有这个 JavaScript 源代码：

```
var mydata = [];

$('.myManyElements').each(function() {
    mydata.push({
        'id': $(this).data('id'),
        'quantity': $(this).data('quantity'),
        'price': $(this).data('price'),
        'price_total': Order.getTotalPrice()
    });
});

$.post('/archive', mydata, function(data) {
    if(data.success) {
        alert(data.response);
    } else {
        alert('Custom Error Report!');
    }
}, 'json'); 
```

在我的`/archive`请求中，我有这个示例 PHP：

```
echo json_encode(array(
    'success' => true,
    'response' => print_r($_POST, true),
)); 
```

当我检查 Firebug 的 XHR 的 NET 面板时，在 POST 选项卡中它说我已经发送了这个：

```
undefined= 
```

当我收到我的回复时，`alert`它会输出：

```
Array
(
    [undefined] => 
) 
```

* * *

**为什么我不能为我的 POST 请求发送数据数组？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:33:55.923

尝试

```
$.post('/archive', {'mydata': JSON.stringify(mydata)}, function(data) 
```

# codeigniter - CodeIgniter form_radio 和 set_value

> ID：13261536
> 
> 赞同：7
> 
> 时间：2012-11-07T00:24:20.823
> 
> 标签：codeigniter, radio-button

我的表单和单选按钮有点麻烦，输入文本我这样做：

```
<?php echo form_input('lastname', set_value('lastname'), 'id=lastname'); ?>
<?php echo form_error('lastname'); ?> 
```

并且当验证运行并且填写的输入字段获得返回的值时......我正在寻找的是一种使用单选按钮执行此操作的方法

```
<tr><td><?php echo form_label('Gender: ', 'gender'); ?></td><td><?php echo form_label('Male', 'male') . form_radio('gender', 'M', '', 'id=male'); ?><br><?php echo form_label('Female', 'female') . form_radio('gender', 'F', '', 'id=female'); ?></td><td><?php echo form_error('gender'); ?></td></tr> 
```

如您所见，我的两个单选按钮都已经有值 F 或 M .....我如何选择返回的按钮？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-07T00:33:56.537

来自用户指南：[https ://www.codeigniter.com/user_guide/helpers/form_helper.html](https://www.codeigniter.com/user_guide/helpers/form_helper.html)

> `form_radio()`
> 
> 这个函数在所有方面都与上面的 form_checkbox() 函数相同，只是将它设置为“radio”类型。

所以进一步阅读：

> `form_checkbox()`
> 
> 允许您生成复选框字段。简单的例子：
> 
> ```
> echo form_checkbox('newsletter', 'accept', TRUE); 
> ```
> 
> 会产生：
> 
> ```
> <input type="checkbox" name="newsletter" value="accept" checked="checked" /> 
> ```
> 
> 第三**个参数**包含一个布尔值 TRUE/FALSE，以确定是否应选中该框。

所以在你的情况下，它可能是这样的：

```
// Pass boolean value to third param
// Example:
$radio_is_checked = $this->input->post('gender') === 'F';

echo form_radio('gender', 'F', $radio_is_checked, 'id=female'); 
```

由于`set_radio()`只返回一个 string `checked="checked"`，如果你真的想的话，你可以把它楔入第四个参数，但这会产生一些难看的代码：

```
echo form_radio('gender', 'F', NULL, 'id="female" '.set_radio('gender', 'F')); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-11-09T06:11:54.340

我为此使用三元运算符。假设您的返回值为“M”（男）。例如，我正在制作 $selected 变量，并假设它的值为 M。

```
<tr>
    <td>
        <?php echo form_label('Gender: ', 'gender'); ?>
    </td>
    <td>
        <?php echo form_label('Male', 'male') . form_radio(array('name' => 'gender', 'value' => 'M', 'checked' => ('M' == $selected) ? TRUE : FALSE, 'id' => 'male')); ?><br>
        <?php echo form_label('Female', 'female') . form_radio(array('name' => 'gender', 'value' => 'F', 'checked' => ('F' == $selected) ? TRUE : FALSE, 'id' => 'female')); ?>
    </td>
    <td>
        <?php echo form_error('gender'); ?>
    </td>
</tr> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-24T09:30:02.027

这对我来说效果很好。即使我没有使用 form_helper，这也是更简单的方法。每个人都面临接受性别领域输入的问题:)

```
 <input id="gender" name="gender" type="radio" class="" <?php if($gender=='0') echo "checked='checked'"; ?> value="0" <?php echo $this->form_validation->set_radio('gender', 0); ?> />
                <label for="gender" class="">Male</label>

                <input id="gender" name="gender" type="radio" class="" <?php if($gender=='1') echo "checked='checked'"; ?> value="1" <?php echo $this->form_validation->set_radio('gender', 1); ?> />
                <label for="gender" class="">Female</label>

                <input id="gender" name="gender" type="radio" class="" <?php if($gender=='2') echo "checked='checked'"; ?> value="2" <?php echo $this->form_validation->set_radio('gender', 2); ?> />
                <label for="gender" class="">Others</label> 
```

我希望它会帮助某人:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-07T00:35:07.320

这肯定有效....

```
<tr><td><?php echo form_label('Gender: ', 'gender'); ?></td><td><?php echo form_label('Male', 'male') . form_radio(array("name"=>"gender","id"=>"male","value"=>"M", 'checked'=>set_radio('gender', 'M', FALSE))); ?><br><?php echo form_label('Female', 'female') . form_radio(array("name"=>"gender","id"=>"female","value"=>"F", 'checked'=>set_radio('gender', 'F', FALSE))); ?></td><td><?php echo form_error('gender'); ?></td></tr> 
```

像这样写了我的单选按钮

```
<?php form_radio(array("name"=>"gender","id"=>"female","value"=>"F", 'checked'=>set_radio('gender', 'F', FALSE))); ?> 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-04-20T13:31:22.537

```
$_fldProyectoMostrar = array(
"id"        => "_FLDPROYDER",
"name"      => "_FLDPROYDER"
);

<?php echo form_radio($_fldProyectoMostrar, "FALSE",    set_radio("_FLDPROYDER", "FALSE", TRUE)); ?>NO

<?php echo form_radio($_fldProyectoMostrar, "TRUE",     set_radio("_FLDPROYDER", "TRUE", FALSE )); ?>SI 
```

Donde el el segundo valor del set radio, debe ser = al string value del form_radio

# macos - 在 git repo 中包含一个克隆的 repo

> ID：13261538
> 
> 赞同：1
> 
> 时间：2012-11-07T00:24:49.127
> 
> 标签：macos, git, github

我正在用 xcode 编写一个应用程序，并且我正在使用 git（尽管使用 github 应用程序来提交和管理它，而不是 xcode）进行版本控制。我在项目中使用 PXSourceList，我已将其克隆到我的计算机上。我将这些文件作为 Xcode 中的引用包含在内，因此这意味着它们不是我同步到 github 的 git 存储库的一部分。因此，如果有人要从 github 下载或克隆，他们将无法在没有自己获取 PXSourceList 的情况下进行构建。如何包含 PXSourceList，以便在我的存储库中“引用”它？

在我的计算机上（到我的本地克隆）和 github 上（到 github 上的 PXSourceList）？因此，当其他人独立于我的存储库对其进行更改时，PXSourceList 将在我的存储库中保持最新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T02:26:45.587

Subrepo 或 git-subtree。在这两种情况下，您都必须将 PXSourceList 移动到您的项目树中

# node.js - 连接闪存中间件不工作

> ID：13261550
> 
> 赞同：0
> 
> 时间：2012-11-07T00:26:30.683
> 
> 标签：node.js, express

我试图让连接闪存在我的 express3 应用程序中工作。

我成功安装了包：

```
$ npm install connect-flash 
```

我包括它：

```
var flash = require('connect-flash'); 
```

设置中间件：

```
app.use(function(req, res, next) {
    res.locals.message = req.flash();
    next();
  });
app.use(flash()); 
```

并使用它：

```
app.get('/admin', function(req, res) {   
    if(loggedIn === true) {      
      res.redirect('/admin/books');
    }
    else {      
      res.render('login', {message: req.flash('error') });
    }    
  });
  app.post('/admin', function(req, res) {    
    if((adminAccount.username === getCrypted(req.body.username)) && 
      (adminAccount.password === getCrypted(req.body.password))) {

      loggedIn = true;
      res.redirect('/admin/books');
    }
    else {
      req.flash('error', 'Woops, looks like that username and password are incorrect.');
      res.redirect('/admin');
    }
  }); 
```

但是我得到：`TypeError: Object #<IncomingMessage> has no method 'flash'`。我按照其 github 页面上的说明进行操作。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T01:06:14.743

颠倒排序：

```
app.use(flash());

app.use(function(req, res, next) {
  res.locals.message = req.flash();
  next();
}); 
```

# mercurial - 删除一个 mercurial 存储库 - 一些文件从目录中“丢失”

> ID：13261553
> 
> 赞同：1
> 
> 时间：2012-11-07T00:26:43.763
> 
> 标签：mercurial, undo

我通过终端从我的计算机上的谷歌字体项目中获得了所有字体，方法是：

```
hg clone someURL; 
```

我想把它从我的电脑上全部删除。我在另一个线程中看到了以下代码：

```
rm -r .hg 
```

我不确定 .hg 指的是什么。'googlefontdirectory' 文件夹中的字体少于 20 种，尽管我可以在各种应用程序中使用更多的 Google 字体。我担心简单地删除“googlefontdirectory”文件夹不会删除所有内容，因为大多数字体似乎都不存在。删除/删除“hg clone”附带的所有字体的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:56:42.267

**repo 中的所有**文件，由放置在一个目录中的命令克隆`hg clone`，该目录是 .hg 子目录中的工作副本和本地存储库。`rm -r .hg`不会删除所有克隆数据，仅删除*没有工作副本的存储库*

> hg帮助克隆
> 
> ...
> 
> 在新目录中创建现有存储库的副本。
> 
> 如果未指定目标目录名称，则默认为源的基本名称。

**添加了 repo-clone 的结果**

> “googlefontdirectory”文件夹中的字体少于 20 个

真的？！

```
hg clone https://code.google.com/p/googlefontdirectory/
...
added 3056 changesets with 60182 changes to 46816 files (+1 heads)
updating to branch default
27215 files updated, 0 files merged, 0 files removed, 0 files unresolved

dir /S *.ttf
...
Total Files Listed:
            1295 File(s)    201 270 824 bytes 
```

# ios - 如何改进我的 Adob e Air iOS 应用程序的启动时间？

> ID：13261555
> 
> 赞同：1
> 
> 时间：2012-11-07T00:27:37.337
> 
> 标签：ios, air, startup

我构建了一个在 Android 设备和 iOS 设备上运行的 Air 应用程序。该应用程序使用 Air 3.4 和 Flex SDK 4.6。在我的 Android 设备上，应用程序在 5 秒后启动。在我的 iPad 设备上，应用程序在 95 秒后启动。

我的应用程序有一个启动屏幕，它通过 ViewNavigatorApplication 属性 splashScreenImage 启动。这是我在每台设备上看到的。

## iPad 2 - ipa 大小，11.7M

12秒黑屏。然后我的启动画面出现了。90 多秒的闪屏。然后我的第一个视图出现了。

## Android Nexus 7 - apk 大小，4.0M

2.5秒黑屏。然后我的启动画面出现了。2.5 秒的闪屏。然后我的第一个视图出现了。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T05:26:29.093

您可以尝试将图形资源和声音移动到不同的 SWF 文件，并在运行时加载它们。

显然，iOS 中的加载时间很大程度上取决于二进制文件的大小。将内容移动到外部文件意味着应用程序启动时不需要加载这些内容。如果您遵循此路径，请注意从 SWF 加载数据可能会降低应用程序的性能。例如，如果您的应用程序是游戏，请不要在关卡的中间进行...

查看 Adob​​e 的这篇文章：http: [//www.adobe.com/devnet/flash/articles/combine-swfs-with-swcs.html](http://www.adobe.com/devnet/flash/articles/combine-swfs-with-swcs.html)

> 请记住，可以在 iOS 上加载 SWF 文件，但不会解释其中的代码。以这种方式加载 SWF 对于动画或矢量图形等图形资源非常有用。您可以创建一个充满符号的库，然后简单地选择您要使用的符号。

这意味着您的 SWF 不能包含任何 AS 代码。

# javascript - 使用 javascript 请求远程 XML 数据

> ID：13261558
> 
> 赞同：1
> 
> 时间：2012-11-07T00:27:55.760
> 
> 标签：javascript, jquery, xml, same-origin-policy

好的，这是我的问题。我正在这个名为 10winstreak 的小站点上工作，我正在尝试使用 javascript 检测流是否处于实时状态，因为我们运行该站点的服务器无法处理使用 PHP 处理的每个请求。检测流是否实时的基础是您转到他们的 XML 文件并在他们的一个标签中（如果它是实时的）它会说一些类似于真实的内容，并且通常他们网站上的 XML 文件将是空的如果特定流未直播。例如，如果您有一个用于游戏点的 twitch.tv 流，您可以访问[http://api.justin.tv/api/stream/list.xml?channel=gamespot](http://api.justin.tv/api/stream/list.xml?channel=gamespot)，如果里面有东西，那么它就是直播的，如果没有，那就是不是。

所以基本上我的代码如下所示：

```
 function check (URL, term){
    $.get(URL , function(data){
        console.log(data);
        //data is whatever the server returns from the request, do whatever is needed with it to show who is live.

        var number = data.search(term);
        if (number > -1)            
        {
            document.write("Live");
        }

        else 
        {   
            document.write("Offline");
        }
    });
    } 
```

URL 是传入的 url，term 是要在 xml 文件中搜索的术语（通常是“true”或“True”）。但在发生任何事情之前，我最终得到“XMLHttpRequest 无法加载[http://api.own3d.tv/liveCheck.php?live_id=6815 。Access](http://api.own3d.tv/liveCheck.php?live_id=6815) -Control-Allow-Origin 不允许来源（我的服务器的 URL）。”

我已经在整个网络上进行了调查，但似乎找不到任何可以使用的东西。有很多理论的东西，但没有足够的实际代码，我不明白理论的东西能够开始输入代码。从我所见，您有两种方法可以使用，使用 JSONP 或在服务器的某处添加一行以允许跨域访问。我既不完全理解也不知道如何或做什么。有人向我展示需要做些什么来摆脱这个错误会很有帮助。当然，如果您可以向像我这样的非编码人员解释它会更棒，但就我目前而言，只要代码适用于我所关心的一切，它也可能是魔法哈哈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T21:48:07.510

你可以解决它:)

看看[xReader](http://kincrew.github.com/xReader/)

```
<script src="http://kincrew.github.com/xReader/xReader.full.js"></script> 
<script type="text/javascript"> 
xReader("http://api.own3d.tv/liveCheck.php?live_id=6815", function(data) { 
    alert(data.content); 
})
</script> 
```

我认为您需要 cacheburst 选项。但是你可以被禁止使用 YQL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:36:59.437

我认为这是因为路径不是相对的。您可能从不同的域/子域调用它。您可以潜在地允许其他来源访问，这可能会打开安全漏洞，或者您可以在本地创建代理。

在 PHP 中创建代理很容易：[http](http://blog.proxybonanza.com/programming/php-curl-with-proxy/) ://blog.proxybonanza.com/programming/php-curl-with-proxy/ 现在，不要将您的请求直接发送到该 URL，而是将请求从 jQuery 发送到您自己的本地 url 和让它在服务器端访问它。

另一种选择是使用 YQL：[http](http://www.parrisstudios.com/?p=333) ://www.parrisstudios.com/?p=333 （我不久前写过一篇关于此的文章）...这样您就可以将响应转换为 JSON，这可以是跨域访问（与 javascript 一样）。

您可以要求使用 JSONP 服务器和 JSON 格式返回所有 API 响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T00:34:26.293

简短的回答：除非 10winstreak 提供 JSONP 服务，否则您必须在服务器端执行操作。

稍微长一点的答案：

出于安全原因，浏览器不允许您从 www.example.com 向 www.example2.com（或除 www.example.com 之外的任何其他域）发出 AJAX 请求。除了使用 JSONP 之外，您对此无能为力（只有在远程 Web 服务提供它的情况下，您才能这样做）。

因此，您最终需要做的是询问您的服务器“嘿，另一台服务器上有什么？” 并且（因为它不限制浏览器的方式）它可以从其他服务器获取 XML。有多种方法可以做到这一点，无论是使用代码还是 Apache 配置；不确定什么适合您，但希望您现在了解一般原则。

PS 看到这个问题：[为跨域 XHR 丢弃 cookie 不会更简单吗？](https://stackoverflow.com/questions/13110764/wouldnt-have-been-simpler-to-just-discard-cookies-for-cross-domain-xhr)如果你很好奇*为什么*浏览器会这样做。

*** 编辑 ***

我刚刚查看了 JustinTV 的网站，看来他们已经有一个 PHP 库供您使用： [https ://github.com/jtvapi/jtv_php_api](https://github.com/jtvapi/jtv_php_api)

这很可能是您最好的选择（如果您想继续使用 PHP；如果没有，他们有其他语言的库：[http](http://www.justin.tv/p/api) ://www.justin.tv/p/api ）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T00:39:22.087

您将无法通过客户端 javascript 执行此操作，除非他们启用*了某种*方式来检索他们的跨域数据（[CORS](http://en.wikipedia.org/wiki/Cross-Origin_Resource_Sharing)、[JSONP 、一些从](http://en.wikipedia.org/wiki/JSON#JSONP)[crossdomain.xml](http://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html)文件获得读取权限的闪存小部件）位于他们的服务器上...）

# jquery - 尝试使用 jQuery validate 停止即时验证

> ID：13261559
> 
> 赞同：0
> 
> 时间：2012-11-07T00:28:06.280
> 
> 标签：jquery, validation, blur, onkeydown

我试图阻止 jQuery 验证插件在输入框时检查它们。相反，我希望在相关输入框失去焦点时进行验证（例如，已选择下一个输入框......）。

这是我到目前为止所尝试的。

```
 <script type = "text/javascript">
        $("#contact").validate({
            onkeyup: false,
            rules: {
                name: "required name",
                email: "required email",
                message: "required message"
            }
        });
    </script> 
```

不幸的是，它没有产生预期的结果。实际上，它正在提交表单并完全跳过验证。

期待您的评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:45:36.350

这可能归结为时机。[尝试像这样（来自http://docs.jquery.com/Plugins/Validation#Example](http://docs.jquery.com/Plugins/Validation#Example) ）在 ready() 中调用 validate( ) ：

$(document).ready(function(){ $("#commentForm").validate(); });

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:49:45.687

javascript onblur 事件可能会满足您的需求。

```
$('#contact').blur(function(){
    validator.validate()
}); 
```

附带说明一下，如果您的代码中有错误，则不会运行任何 javascript，因此请确保您正在查看错误控制台。如果您的表单在没有经过验证的情况下提交，这可能是一个原因。你能张贴你的表格吗？

# c - 让 GCC 在转换 OpenMP 并行代码时调用 pthread_exit

> ID：13261560
> 
> 赞同：1
> 
> 时间：2012-11-07T00:28:07.067
> 
> 标签：c, gcc, openmp, libgomp

我刚刚发现 gcc 的 OpenMP 实现（libgomp）没有调用 pthread_exit()。我需要它来使用 perfsuite（用于分析）。

有没有办法告诉 GCC 在将 OpenMP 代码转换为 pthread 代码时在 OpenMP 并行部分的末尾包含 pthread_exit() ？

我正在使用 GCC 4.7.0 和 Perfsuite 1.1.1 。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T10:27:34.197

`libgomp`实现线程池。一旦创建，池中的线程将保持空闲状态，直到它被通知成为线程组的成员。团队完成工作后，线程进入空闲循环，直到再次发出信号。池按需增长，但从不缩小。线程仅在程序完成时才发出退出信号。

您可以在[此处](http://gcc.gnu.org/svn/gcc/branches/gcc-4_7-branch/libgomp/team.c)`libgomp`阅读 4.7.x 分支中实现线程池和团队的代码。

池线程是这样终止的：`libgomp`注册一个名为 的析构函数`team_destructor()`。每当`main()`函数返回、`exit(3)`被调用或`libgomp`通过调用卸载库时都会调用它`dlclose(3)`（如果之前使用 加载`dlopen(3)`）。析构函数删除一个`pthreads`名为 的键，该键具有由删除触发`gomp_thread_destructor`的关联析构函数。使池中的所有线程作为它们的下一个任务执行。调用，因此池中的所有线程不再存在。`gomp_free_thread()``gomp_free_thread()``gomp_free_pool_helper()``gomp_free_pool_helper()``pthread_exit(3)`

这是一张漂亮的 ASCII 图片中的相同过程：

```
main() returns, exit() called or library unloaded
  |
  |
team_destructor() deletes gomp_thread_destructor
  |
  |
gomp_free_thread() called by pthreads on gomp_thread_destructor deletion
  |
  +-------------------------+---------------------------+
  |                         |                           |
gomp_free_pool_helper()   gomp_free_pool_helper() ... gomp_free_pool_helper()
 installed as next task    installed as next task      installed as next task
  |                         |                           |
  |                         |                           |
pthread_exit(NULL)        pthread_exit(NULL)      ... pthread_exit(NULL) 
```

请注意，这只在程序执行结束时发生一次，而不是在每个`parallel`区域结束时发生。

# symfony - Assetic 未创建组合链接

> ID：13261562
> 
> 赞同：3
> 
> 时间：2012-11-07T00:28:21.347
> 
> 标签：symfony, assetic

只是在尝试让 Assetic 在呈现的网页中生成组合链接时遇到了一些问题。文件本身生成良好，但在生产环境的网页中，我继续看到单独的文件 URL（在生产中不起作用，因为那些未组合的文件不可用）。

在模板中，我有：

```
{% stylesheets
    '@TBundle/Resources/public/css/bootstrap/bootstrap.css'
    '@TBundle/Resources/public/css/bootstrap/bootstrap-responsive.css'

    '@TBundle/Resources/public/css/jquery-selectbox/jquery.selectBox.css'
%}
    <link href="{{ asset_url }}" rel="stylesheet" media="screen" />
{% endstylesheets %} 
```

在生产中，这仍然呈现为：

```
<link href="/css/2f787d0_bootstrap_1.css" rel="stylesheet" media="screen" />
<link href="/css/2f787d0_bootstrap-responsive_2.css" rel="stylesheet" media="screen" />
<link href="/css/2f787d0_jquery.selectBox_3.css" rel="stylesheet" media="screen" /> 
```

尽管如此，当我调用时，`php app/console assetic:dump --env=prod`我得到：

```
11:13:43 [dir+] /var/www/tbundle/app/../web/css
11:13:43 [file+] /var/www/tbundle/app/../web/css/2f787d0.css 
```

我正在使用 Symfony2 的默认 Assetic 设置。关于可能导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-11T08:41:09.583

我遇到了同样的问题，对我来说问题出在我的 app.php 文件中。我正在按如下方式加载内核：

```
$kernel = new AppKernel('prod', true); 
```

似乎这导致该功能无法在调试模式下运行并合并资产。当我将第二个参数更改为 false 时，资产在生产中成功组合，而在开发中保持未组合：

```
$kernel = new AppKernel('prod', false); 
```

此外，您可以将 combine=true 作为参数传递，以显式请求组合资产，以测试此功能是否正常工作。

# ios - 使用 3rd 方服务推送通知传递速度？

> ID：13261564
> 
> 赞同：1
> 
> 时间：2012-11-07T00:28:51.187
> 
> 标签：ios, push-notification, apple-push-notifications

我目前使用 Pushwoosh 作为 iOS 推送通知的推送通知提供程序。我注意到的是，通知发出后平均需要 10-15 秒才能收到通知。我想知道的是，考虑到 Apple 接收到其 APNS 服务器的流量，这个数字是否是正常数字？使用 Pushwoosh 或其他服务可以获得什么样的速度？是时候切换到更可靠的东西了，还是这只是 APNS 的本质，无论我选择哪个提供商？

Pushwoosh 非常便宜且负担得起，但我开始意识到你得到你所支付的，这不是质量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T13:03:06.903

有几个可能的问题

1.  您与 pushwoosh 的连接。
    只需 ping Pushwoosh API 网关 cp.pushwoosh.com
2.  pushwoosh 方面的一些延迟。
    发送消息，然后转到 https://cp.pushwoosh.com/notifications 并在列表中找到您的消息，它必须从顶部开始。消息的状态可以是待处理、处理或完成。处于待处理状态，您的消息现在未发送。这意味着 pushwoosh 服务器当前非常繁忙（非常罕见的情况）。当状态变为“处理中”时，pushwoosh 立即开始向 APNS 发送通知。在正常情况下，您应该在您的消息在 pushwoosh 控制面板中“完成”之前收到通知。如果没有，请参阅 4
3.  设备连接。
    即使您确定您的设备已连接到互联网 - 请再次检查。这是最常见的延迟问题。
4.  APNS 延迟。
    我不知道 100% 的诊断方法，但如果 pushwoosh 控制面板中的消息状态为“完成”并且您确定 (3)，APNS 会出现一些延迟。

PS 如果我的回复没有帮助，请随时联系 Pushwoosh 支持 (http://www.pushwoosh.com/contact-us/)。他们会更仔细地调查您的案件。但不要忘记向他们发送延迟消息的 messageid（您可以在通知页面上找到它）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T03:53:19.570

这似乎取决于速度，有时直接对 APNS 的 PHP 调用会立即出现，有时可能需要长达 15 秒，有时我会将其归结为与手机和 Apple 服务器的通信链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T03:59:01.433

我们目前正在使用 Drupal 模块来发送推送通知，并且它们几乎是即时发送的。（2-5 秒）。我不知道是哪一个，但如果你有兴趣我会问我的同事...

# spring - JSF2 + Spring3 和休眠：Spring Managed Bean (@Scope value="view") LazyInitializationException 异常

> ID：13261566
> 
> 赞同：0
> 
> 时间：2012-11-07T00:29:12.320
> 
> 标签：spring, hibernate, jsf-2

我使用[此链接](http://comdynamics.net/blog/109/spring3-jsf2-view-scope/)中的代码创建了自定义 Spring 范围，它允许使用`view`类似于 JSF2 @ViewScoped 的范围 Spring 托管 bean。

当用户按下提交按钮时，会发生以下情况：

```
- Backbean AA (@Scope(value="view") calls injected @Service BB
- @Service BB calls DAO class CC 
- CC is @Transactional(readOnly = true) and has sessionFactory injected 
     private SessionFactory sessionFactory;

    //inject sessionGactory
    public void setSessionFactory(SessionFactory sessionFactory) {
        this.sessionFactory = sessionFactory;
    }
- in CC i set the @Transactional(readOnly = false, propagation = Propagation.REQUIRED)
  for functions such as save/delete/saveOrUpdate 
```

与此类有关的 Hibernate 映射是：

## RegUser.hbm.xml

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <class name="com.testApp.hibernate.RegUser" table="reg_users" schema="dbo" catalog="devDB">
        <id name="userPk" type="java.lang.Long">
            <column name="userPK" />
            <generator class="identity" />
        </id>
        <property name="firstname" type="java.lang.String">
            <column name="firstname" length="25" not-null="true" />
        </property>
        <property name="lastname" type="java.lang.String">
            <column name="lastname" length="50" not-null="true" />
        </property>
        <set name="UserVsOrderses" inverse="true">
            <key>
                <column name="userPK" not-null="true" />
            </key>
            <one-to-many class="com.testApp.hibernate.UserVsOrders" />
        </set>
    </class>
</hibernate-mapping> 
```

## UserVsOrders.hbm.xml

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <class name="com.testApp.hibernate.custOrders" table="custOrders" schema="dbo" catalog="devDB">
        <composite-id name="id" class="com.testApp.hibernate.custOrdersId">
            <key-property name="userPk" type="java.lang.Long">
                <column name="userPK" />
            </key-property>
            <key-property name="OrderPk" type="java.lang.Long">
                <column name="OrderPK" />
            </key-property>
        </composite-id>
        <many-to-one name="RegUser" class="com.testApp.hibernate.RegUser" update="false" insert="false" fetch="select">
            <column name="userPK" not-null="true" />
        </many-to-one>
        <many-to-one name="Order" class="com.testApp.hibernate.Order" update="false" insert="false" fetch="select">
            <column name="OrderPK" not-null="true" />
        </many-to-one>
    </class>
</hibernate-mapping> 
```

## 应用程序上下文.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
                        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
                        http://www.springframework.org/schema/tx
                        http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
                        http://www.springframework.org/schema/context
                        http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <context:component-scan base-package="com.testApp" />
    <context:annotation-config />

    <bean class="org.springframework.beans.factory.config.CustomScopeConfigurer">
        <property name="scopes">
            <map>
                <entry key="view">
                    <bean class="com.testApp.util.ViewScope" />
                </entry>
            </map>
        </property>
    </bean>

    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
        <property name="driverClassName" value="net.sourceforge.jtds.jdbc.Driver">
        </property>
        <property name="url" value="jdbc:jtds:sqlserver://localhost:1433/devDB">
        </property>
        <property name="username" value="blabla"></property>
        <property name="password" value="blabla"></property>
    </bean>

    <bean id="sessionFactory"
        class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
        <property name="dataSource">
            <ref bean="dataSource" />
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.SQLServer2008Dialect</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.c3p0.min_size">5</prop>
                <prop key="hibernate.c3p0.max_size">20</prop>
                <prop key="hibernate.c3p0.idle_test_period">300</prop>
                <prop key="hibernate.c3p0.timeout">1800</prop>
                <prop key="hibernate.c3p0.max_statements">50</prop>
                <prop key="cache.provider_class">org.hibernate.cache.NoCacheProvider</prop>
                <prop key="c3p0.acquire_increment">1</prop>
            <props>
        </property>

    <bean id="transactionManager"
        class="org.springframework.orm.hibernate4.HibernateTransactionManager"
        p:sessionFactory-ref="sessionFactory" />

    <bean id="transactionTemplate" class="org.springframework.transaction.support.TransactionTemplate">
        <property name="transactionManager" ref="transactionManager"/>
    </bean>

    <tx:annotation-driven transaction-manager="transactionManager"/>

    ...
    <!-- some other beans declared below -->

    ...
    <!-- all the Mapping Resource  -->
</beans> 
```

我的问题是第一个表单提交一切都很好，但是在下一个表单提交时我得到：

```
failed to lazily initialize a collection, no session or session was closed

viewId=/page/regNewCust.xhtml
location=C:\repo\dev\WebRoot\nz\regNewCust.xhtml
phaseId=PROCESS_VALIDATIONS(3)

Caused by:
org.hibernate.LazyInitializationException - failed to lazily initialize a collection, no session or session was closed
at org.hibernate.collection.internal.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:394) 
```

如果我将 bean 范围设置为`@Scope(value='request')`

我尝试添加以下内容，`web.xml`但没有帮助：

```
<filter>
    <filter-name>openSessionInViewFilter</filter-name>
    <filter-class>org.springframework.orm.hibernate4.support.OpenSessionInViewFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>openSessionInViewFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

我也尝试过添加`<set name="UserVsOrderses" inverse="true" fetch="join">`也没有帮助。

谁能指出我做错了什么以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:01:20.523

在这里找到解决方案：

[堆栈溢出链接](https://stackoverflow.com/questions/8802854/lazyinitializationexception-with-cdi-managed-bean-and-stateful-session-bean)

我需要添加

```
<f:attribute name="collectionType" value="java.util.HashSet" /> 
```

对所有`<h:selectManyListbox`>

# nginx - 从旧域重定向到新域

> ID：13261567
> 
> 赞同：0
> 
> 时间：2012-11-07T00:29:34.493
> 
> 标签：nginx

如何在 nginx 上设置重定向？我需要实现的是将旧域重定向到作为服务器名称的新域。尝试使用重写我遇到了问题，因为我需要将旧域设置为服务器名称，并将新域设置为重写。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T12:11:49.733

```
server {
    server_name old.example.com;
    return 301 http://new.example.org/;
}

server {
    server_name new.example.org;

    location / {
        ...
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:36:32.687

尝试在旧主机名的服务器块配置中使用“proxy_pass example.newdomain.com:8080”指令。

# emacs - emacs - 加载编译完成错误

> ID：13261569
> 
> 赞同：2
> 
> 时间：2012-11-07T00:29:51.037
> 
> 标签：emacs

在 emacs 中 - 我时不时地运行一个我不想要的命令（不知道是哪个命令）并且状态栏显示`"Loading compile...done"`并且 emacs 没有响应。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:30:23.733

尝试通过`emacs -Q`. 如果错误仍然存​​在，您需要自己调试。如果您无法调试，您应该向 GNU emacs-devel 列表发送电子邮件。

如果错误消失，这意味着你有一个坏的`.emacs`或`startup.el`.

# maven - 在 Maven 中配置 Javadoc 聚合

> ID：13261571
> 
> 赞同：6
> 
> 时间：2012-11-07T00:30:07.103
> 
> 标签：maven, javadoc

我正在尝试为我的项目中的所有模块创建一个聚合 Javadoc 站点，但我似乎无法以令人满意的方式配置插件。主要是，在检测链接并排除某些包时，我似乎无法让它一直聚合 javadocs。本质上，插件的配置似乎被完全忽略了。

我有一个根 pom.xml 引用一堆子模块并包含以下配置：

```
<modules>
    <module>foo</module>
    <module>bar</module>
</modules>
<build>
<plugins>
   <plugin>
       <groupId>org.maven.apache.plugins</groupId>
       <artifactId>maven-javadoc-plugin</artifactId>
       <version>2.9</version>
       <executions>
           <execution>
               <id>aggregate</id>
               <phase>site</phase>
               <goals>
                   <goal>aggregate</goal>
               </goals>
               <configuration>
                  <links>
                    <link>http://docs.oracle.com/javase/6/docs/api</link>
                    <link>http://static.netty.io/3.5/api</link>
                    <link>http://google-guice.googlecode.com/git/javadoc</link>
                    <link>http://docs.guava-libraries.googlecode.com/git-history/release/javadoc</link>
                    <link>http://fasterxml.github.com/jackson-databind/javadoc/2.0.4</link>
                    <link>https://developers.google.com/protocol-buffers/docs/reference/java</link>
                  </links>
                  <bootclasspath>${sun.boot.class.path}</bootclasspath>
                  <additionalJOption>-J-Xmx1024m</additionalJOption>
                  <detectJavaApiLink>true</detectJavaApiLink>
                  <detectLinks>true</detectLinks>
                  <excludePackageNames>*.testing.*</excludePackageNames>
               </configuration>
           </execution>
      </executions>
  </plugin>
</plugins>
</build> 
```

但是，当我`mvn javadoc:aggregate`使用此设置运行时，我最终会得到一个 javadoc 站点，该站点没有指向任何引用库的链接，并且仍然包含所有测试类。

我什至没有看到插件试图为每个声明的链接源下载包列表。

另一方面，为每个单独的模块生成 javadoc 效果很好并且符合预期。

我怎么了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T10:02:17.727

插件配置可以放在两个层次上；`execution`标签内部或外部（“全局”）。

当配置在`execution`标签内时，它属于该特定执行。在您的情况下，您必须运行`mvn site`它才能执行，因为它绑定到该阶段。

使用该`mvn javadoc:aggregate`命令时，它会查找“全局”配置。在您的 pom 中没有这样的配置，因此它使用默认配置。

将您的插件配置更改为此：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-javadoc-plugin</artifactId>
    <version>2.9</version>
    <configuration>
        <links>
            <link>http://docs.oracle.com/javase/7/docs/api</link>
            <link>http://static.netty.io/3.5/api</link>
            <link>http://google-guice.googlecode.com/git/javadoc</link>
            <link>http://docs.guava-libraries.googlecode.com/git-history/release/javadoc</link>
            <link>http://fasterxml.github.com/jackson-databind/javadoc/2.0.4</link>
            <link>https://developers.google.com/protocol-buffers/docs/reference/java</link>
        </links>
        <bootclasspath>${sun.boot.class.path}</bootclasspath>
        <additionalJOption>-J-Xmx1024m</additionalJOption>
        <detectJavaApiLink>true</detectJavaApiLink>
        <detectLinks>true</detectLinks>
        <excludePackageNames>*.testing.*</excludePackageNames>
    </configuration>
    <executions>
        <execution>
            <id>aggregate</id>
            <phase>site</phase>
            <goals>
                <goal>aggregate</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

您可以`configuration`在零件内部放置一个`execution`来覆盖和专门化该执行的配置。

**顺便说一句**，你的`<groupId>`pom 是错误的。它应该是

```
<groupId>org.apache.maven.plugins</groupId> 
```

并不是

```
<groupId>org.maven.apache.plugins</groupId> 
```

# php - 如何将数据存储在php文件本身中？

> ID：13261573
> 
> 赞同：-3
> 
> 时间：2012-11-07T00:30:22.883
> 
> 标签：php

我正在制作一个系统，它会询问用户 mysql 的详细信息。我希望将这些详细信息写入 settings.php 文件中。

设置文件包含以下数据：

```
$host = "";
$database = "";
$user = "";
$password = "";
$localelang = ""; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:34:58.393

[在http://php.net/manual/en/ref.filesystem.php](http://php.net/manual/en/ref.filesystem.php)查看文件系统操作- 特别是`file_put_contents()`- [http://www.php.net/manual/en/function.file-put-contents.php](http://www.php.net/manual/en/function.file-put-contents.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:36:14.417

将文件另存为`.ini`，`.php`然后在其上使用[parse_ini_file()](http://php.net/manual/en/function.parse-ini-file.php)函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T00:36:15.407

PHP 文件是文本文件，因此您可以根据需要对其进行修改。这是一个简单的例子：

您要修改的文件（file.original.php）：

```
$host = "[%%HOST%%]";
$database = "[%%DATABASE%%]";
$user = "[%%USER%%]";
$password = "[%%PASSWORD%%]";
$localelang = "[%%LANG%%]"; 
```

修改脚本：

```
$file = file_get_contents("path/to/your/file.original.php");

$file = str_replace("[%%HOST%%]", $hostSuppliedByUser, $file);
$file = str_replace("[%%DATABASE%%]", $databaseSuppliedByUser, $file); 
```

（等等每个var）

像这样写入文件：

```
file_put_contents('/path/to/your/newfile.php', $file); 
```

就像蒂姆建议的那样，确保你写入不同的文件

# windows - Windows 上的 Jenkins 从属（代理）有时会在启动时因 socketAccept 超时而失败

> ID：13261577
> 
> 赞同：2
> 
> 时间：2012-11-07T00:30:47.470
> 
> 标签：windows, jenkins, slave

我将 Jenkins 从代理设置为在 Windows 服务器上作为服务运行，但它偶尔会工作。

```
Starting javaw.exe -Xrs  -jar "d:\build_tools\jenkins\slave.jar" -tcp d:\build_tools\jenkins\port.txt 
```

有时它会启动，有时它会因以下错误而失败。我不知道为什么。

```
Exception in thread "main" java.net.SocketTimeoutException: Accept timed out
at java.net.TwoStacksPlainSocketImpl.socketAccept(Native Method)
at java.net.AbstractPlainSocketImpl.accept(Unknown Source)
at java.net.PlainSocketImpl.accept(Unknown Source)
at java.net.ServerSocket.implAccept(Unknown Source)
at java.net.ServerSocket.accept(Unknown Source)
at hudson.remoting.Launcher.runAsTcpServer(Launcher.java:312)
at hudson.remoting.Launcher.run(Launcher.java:211)
at hudson.remoting.Launcher.main(Launcher.java:173) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T06:29:09.970

可能是由许多问题引起的，但最常见的是：

*   防火墙或防病毒软件正在阻止通信：
    禁用它们并查看是否有帮助
*   从站启动时，网络尚不可用：
    确保服务设置为在一两分钟后重试

另请参阅 Jenkins 的指南：

*   [在 Windows 上设置主计算机和代理计算机的分步指南](https://wiki.jenkins.io/display/JENKINS/Step+by+step+guide+to+set+up+master+and+agent+machines+on+Windows)
*   [如何使用 Jenkins 解决 JNLP 从属连接问题](https://support.cloudbees.com/hc/en-us/articles/218097237-How-to-troubleshoot-JNLP-slaves-connection-issues-with-Jenkins-)

# cocos2d-iphone - Box2D 和滞后隧道

> ID：13261591
> 
> 赞同：0
> 
> 时间：2012-11-07T00:33:11.280
> 
> 标签：cocos2d-iphone, box2d, physics, tunnel

我对 Box2D 物理有这个问题，如果游戏中的延迟足够高，物体将穿过墙壁。游戏延迟是我正在解决的问题，但我认为某些事情最终会导致游戏延迟是不可避免的，我最不想要的就是当延迟达到足够高时让玩家穿过墙壁。

是的，我已经打开了连续碰撞检测并启用了我想要拥有子弹物理的对象，但问题仍然存在。有什么建议吗？我想也许如果我让世界的速度与 FPS 成正比，但我不确定如何干净地实现这一点，或者 cocos2d/box2d 是否有一个简单的解决方案来解决这类问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:19:10.573

尝试使用固定的时间步长。可变时间步长通常对物理模拟不利。

# python - 循环中“time.sleep”与“threading.Timer”的资源使用情况

> ID：13261593
> 
> 赞同：6
> 
> 时间：2012-11-07T00:33:17.197
> 
> 标签：python, multithreading, memory, timer, python-2.7

第一种方法：

```
import threading
import time

def keepalive():
    while True:
        print 'Alive.'
        time.sleep(200)
threading.Thread(target=keepalive).start() 
```

第二种方法：

```
import threading

def keepalive():
    print 'Alive.'
    threading.Timer(200, keepalive).start()

threading.Timer(200, keepalive).start() 
```

哪种方法占用更多内存？而在第二种方法中，线程被激活后是否结束？或者它是否保留在内存中并开始一个新线程？（多线程）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-07T01:19:05.183

[`Timer`](http://hg.python.org/cpython/file/7d5f35326a77/Lib/threading.py#l802)为每个启动的计时器创建一个新的线程对象，因此在创建和垃圾收集这些对象时肯定需要更多资源。

由于每个线程在产生另一个线程后立即退出`active_count`保持不变，但不断有新线程创建和销毁，这会导致开销。我会说第一种方法肯定更好。

尽管您不会真正看到太大的差异，但只有在间隔非常小的情况下。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-07T01:04:41.223

这是一个如何自己测试的示例：

> 而在第二种方法中，线程被激活后是否结束？或者它是否保留在内存中并开始一个新线程？（多线程）

```
import threading

def keepalive():
    print 'Alive.'
    threading.Timer(200, keepalive).start()
    print threading.active_count()

threading.Timer(200, keepalive).start() 
```

我还将 200 更改为 .2，因此不会花费很长时间。

线程数永远是 3。

然后我这样做了：

```
top -pid 24767 
```

#TH 列从未改变。

所以，这就是你的答案：我们没有足够的信息来知道 Python 是为所有计时器维护一个计时器线程，还是在计时器运行后立即结束并清理线程，但我们可以确定线程不会不要到处乱堆。（如果您确实想知道前者发生了什么，您可以，例如，打印线程 ID。）

另一种查找方法是查看源。正如[文档](http://docs.python.org/2/library/threading.html#timer-objects)所说，“Timer 是 Thread 的子类，因此也可以作为创建自定义线程的示例”。它是 的子类的事实`Thread`已经告诉您每个`Timer`都是`Thread`. 它“作为示例”的事实意味着它应该易于阅读。如果您单击从文档到[源](http://hg.python.org/cpython/file/2.7/Lib/threading.py)的链接，您可以看到它是多么的微不足道。大部分工作都是由 完成的`Event`，但它们在同一个源文件中，而且几乎一样简单。实际上，它只是创建一个条件变量，等待它（因此它会阻塞直到超时，或者您通过调用通知条件`cancel`），然后退出。

我之所以回答一个子问题并解释我是如何做到的，而不是回答每个子问题，是因为我认为完成相同的步骤对您更有用。

进一步思考，这可能不是首先由优化决定的问题：

如果您有一个简单的同步程序，需要在 200 秒内什么都不做，请对`sleep`. 或者，更简单，只需完成工作并退出，然后选择一个外部工具来安排您的脚本每 200 秒运行一次。

另一方面，如果你的程序本质上是异步的——特别是如果你已经有了线程、信号处理程序和/或事件循环——那么你就无法开始`sleep`工作了。如果`Timer`效率太低，请转到 PyPI 或 ActiveState 并找到更好的计时器，让您可以使用单个实例和线程安排可重复的计时器（甚至多个计时器）。（或者，如果您正在使用信号，请使用`signal.alarm`or `setitimer`，如果您正在使用事件循环，请将计时器构建到您的主循环中。）

我想不出任何用例`sleep`都`Timer`可以成为真正的竞争者。

# c++ - C++ sizeof 自定义类返回不正确的值？

> ID：13261595
> 
> 赞同：3
> 
> 时间：2012-11-07T00:33:27.027
> 
> 标签：c++, class, sizeof

> **可能重复：**
> [为什么结构的 sizeof 不等于每个成员的 sizeof 之和？](https://stackoverflow.com/questions/119123/why-isnt-sizeof-for-a-struct-equal-to-the-sum-of-sizeof-of-each-member)

给定以下类，没有其他数据成员：

```
typedef uint32_t id_t;
typedef int64_t loc_t;

class foo:
{
public:
    enum bar : uint8_t
    {
        BAR1,
        BAR2,
        BAR3
    };
private:
    id_t id;
    loc_t  start;
    loc_t  stop;
    bar std;
}; 
```

谁能解释为什么：

> sizeof( id_t ) 返回 4...
> sizeof( loc_t ) 返回 8...
> sizeof( bar ) 返回 1...
> 
> 4+(2*8)+1 = 21

然而：

> sizeof( foo ) 返回 32？

删除 bar 枚举类型的 uint8_t 要求只会成功地使 sizeof( bar ) 返回 4 (int) 而 sizeof( foo ) 在 24 正确字节对齐时仍返回 32。

编辑：为什么已经得到令人满意的回答。我感谢每个发表评论的人，因为每个人都带来了不同的细节。

我需要的修复是能够使用 sizeof() 创建文件位置偏移量。因此，当我将 foo 以二进制格式写入文件时，如果我稍后给出它的位置，我可以立即找到它后面的位置。如果我找到一个优雅的解决方案，我会在这里更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:37:24.183

那是因为内存对齐。处理器根据总线宽度获取数据，32 位操作系统将在 4 字节边界上对齐数据，而 64 位操作系统将在 8 字节边界上对齐数据。非对齐内存需要两次内存读取并导致性能下降。

在此处阅读有关内存对齐的所有信息：

1.  [http://www.devx.com/tips/Tip/13265](http://www.devx.com/tips/Tip/13265)
2.  [http://msdn.microsoft.com/en-us/library/83ythb65.aspx](http://msdn.microsoft.com/en-us/library/83ythb65.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:39:46.300

这是由于填充。编译器可能会在您的结构中留下“空格”，以确保结构内的变量对齐良好，以便更有效地访问。

您可以覆盖默认的结构成员对齐方式（至少在 MSVC 中，通过指定`#pragma pack`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T00:42:05.093

由于`int64_t`s，类型可能是 8 字节对齐的，所以

```
sizeof(id_t) + 4 bytes padding + 2*sizeof(loc_t) + `sizeof(uint8_t)` + padding up to the next multiple of 8 =
4 + 4 bytes of padding + 16 + 1 + (padding up to the next multiple of 8) =
25 + padding to multiple of 8 =
32 
```

一些编译器对填充有警告（clang 有 -Wpadded）：

```
warning: padding class 'foo' with 4 bytes to align 'start' [-Wpadded]
    loc_t  start;
           ^
warning: padding size of 'foo' with 7 bytes to alignment boundary [-Wpadded]
class foo
      ^ 
```

您也可以使用编译器扩展来控制它，例如`#pragma pack(1)`

```
#pragma pack(1)
class foo:
{
public: 
```

当然，这样做会降低性能，但 `sizeof(foo)`在这个系统上，这种方式对我来说是 21。

# c - 在 XCode 4.5.2 中的 C 项目上使用静态库

> ID：13261597
> 
> 赞同：3
> 
> 时间：2012-11-07T00:33:45.600
> 
> 标签：c, xcode, file, static

我是 Xcode 的新手，所以还不太热衷于它。在我的大学里，Visual Studio 使用 C 语言进行编程，他们在其中创建解决方案并用应用程序填充它，然后包含带有 .h 和 .c 文件的静态库。一直在尝试在 Xcode 中执行此操作，但似乎无法像在 Visual Studio 中那样包含它们或添加依赖项

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T05:46:37.570

One approach is just using the standard gcc command line options for static library linking which you can specify using the XCode project settings. This will work if the static library is installed and accessible in the standard locations.

Alternatively you can add a static library explicitly to your project and set the dependencies and search paths for headers etc appropriately. This may sound a bit involved, but there's not really that much to do, and you only need to set it up once. It's all done in the same place as other project settings, and you can use the search box to find exactly where to enter the options.

I'm assuming you don't want to actually build the static library with your project. if you do there's more to do - basically you need to set up the static library project, set it as a target dependency, and setup a build step to copy the resulting library.

# java - 在 Jena 中使用 OWL.sameAs 链接概念

> ID：13261599
> 
> 赞同：0
> 
> 时间：2012-11-07T00:33:52.083
> 
> 标签：java, jena, owl

我试图将来自不同来源的两个相同的人联系起来。我的想法是，如果 IndividualA 缺少属性 P，但使用 OWL.sameAs 与现有 P 绑定到 IndividualB，那么推理器应该输出 IndividualA 有 P！我很困惑为什么这不起作用。这是我的代码。

```
public class Main {

static String NS_A = "http://www.namespacea.com/ontoa.owl#";
static String NS_B = "http://www.namespaceb.com/ontob.owl#";
static String NS_C = "http://www.namespacec.com/ontoc.owl#";

public static void main(String[] args) {

    OntModelSpec spec = OntModelSpec.OWL_MEM_MINI_RULE_INF;

    OntModel modelA = ModelFactory.createOntologyModel(spec);
    OntModel modelB = ModelFactory.createOntologyModel(spec);
    OntModel modelC = ModelFactory.createOntologyModel(spec);

    // Populate Model A
    OntClass animal = modelA.createClass(NS_A + "Animal");
    OntProperty hasFeathers = modelA.createOntProperty(NS_A + "hasFeathers");
    hasFeathers.addDomain(animal);
    hasFeathers.addRange(XSD.xboolean);

    // Populate Model B
    OntClass duck = modelB.createClass(NS_B + "Duck");
    duck.setSuperClass(animal);
    Individual donaldA = modelB.createIndividual(NS_B + "DonaldDuck", duck);

    // NEXT LINE IS REMOVED ON PURPOSE
    //donaldA.addLiteral(hasFeathers, true);

    //Populate Model C
    Individual donaldB = modelC.createIndividual(NS_C + "DonaldDuck", duck);

    // Donald hasFeathers IS DECLARED HERE
    donaldB.addLiteral(hasFeathers, true);

    // THIS TIES UP THE TWO INDIVIDUALS
    donaldA.addProperty(OWL.sameAs, donaldB);

    // Query
    System.out.println(
        "Does " + donaldA.getLocalName() +
        " have feathers? " + "Ans. " + donaldA.getPropertyValue(hasFeathers).asLiteral().getValue()
    );
}
} 
```

结果是 NullPointerException。你怎么解决这个问题？

我想到的一个更困难的情况是，如果有个人 A、B、C、D 和 E st A isSameAs B、B isSameAs C 等等，其中 E 的 P = true。然后询问 A 是否有 P = true 应该说 TRUE！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T11:56:20.690

好的，我在耶拿邮件列表中发布了同样的问题。感谢伊恩的更新。根据 Dave Reynolds 的说法，推理器在一个模型内工作，而不是跨不同的模型工作。

因此，答案应该是使用说，例如只有模型A，以便所有个人都存储在其中。

# android - RadioGroup.setEnabled(false) 无法按预期工作

> ID：13261602
> 
> 赞同：34
> 
> 时间：2012-11-07T00:34:15.967
> 
> 标签：android, android-widget

我曾经`setEnabled(false)`设置它无法，但是它不起作用，并且在这个方法之后，它的值`RadioGroup.isEnabled()`是false。值已更改。

代码来自 Android 编程指南。

PS：`Spinner`组件`setEnabled(false)`也使用。

代码如下：

```
import android.app.Activity;
import android.graphics.Color;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.RadioGroup;

public class TestRadioGroup extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.radiogroup);

    final RadioGroup testRadioGroup = (RadioGroup) findViewById(R.id.testRadioGroup);

    final Button changeEnabledButton = (Button) findViewById(R.id.changeEnabledButton);
    changeEnabledButton.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            changeEnabled(testRadioGroup);
        }
    });

    final Button changeBgColorButton = (Button) findViewById(R.id.changeBackgroundColorButton);
    changeBgColorButton.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            changeBgColor(testRadioGroup);
        }
    });

}

protected void changeBgColor(RadioGroup testRadioGroup) {
    // TODO Auto-generated method stub
    testRadioGroup.setBackgroundColor(Color.BLUE);
}

protected void changeEnabled(RadioGroup testRadioGroup) {
    // TODO Auto-generated method stub
    if (testRadioGroup.isEnabled()) {
        testRadioGroup.setEnabled(false);
    } else {
        testRadioGroup.setEnabled(true);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-11-07T02:17:59.423

通过循环迭代和禁用属于 radio 组的每个按钮，例如：

```
for (int i = 0; i < testRadioGroup.getChildCount(); i++) {
    testRadioGroup.getChildAt(i).setEnabled(false);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-18T09:42:58.267

视图可以由多个可触摸元素组成。您必须将它们全部禁用，如下所示：

```
for(View lol : your_spinner.getTouchables() ) {
    lol.setEnabled(false);
} 
```

如果它是一个简单的，因为它也返回自己：

> 查找并返回作为该视图后代的所有可触摸视图，如果它本身是可触摸的，则可能包括该视图。

[查看#getTouchables()](http://developer.android.com/reference/android/view/View.html#getTouchables%28%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-25T05:34:13.583

您不能使用以下代码；

```
for(View lol : your_spinner.getTouchables() ) {
    lol.setEnabled(false);
} 
```

一旦视图被禁用，就不再有可触摸的子/后代视图。

# objective-c - 使用 Core OpenGL 以编程方式创建具有深度缓冲区的上下文：我做错了什么？

> ID：13261603
> 
> 赞同：1
> 
> 时间：2012-11-07T00:34:19.187
> 
> 标签：objective-c, opengl

我正在尝试`OpenGL`使用深度缓冲区创建上下文`Core OpenGl`。然后我希望通过`CAOpenGLLayer`. 从我读过的内容看来，我应该能够通过以下方法创建所需的上下文：

我在接口中声明了以下实例变量

```
@interface TorusCAOpenGLLayer : CAOpenGLLayer
{
    //omitted code
    CGLPixelFormatObj pix;
    GLint pixn;
    CGLContextObj ctx;
} 
```

然后在我覆盖的实现`copyCGLContextForPixelFormat`中，我认为应该创建所需的上下文

```
- (CGLContextObj)copyCGLContextForPixelFormat:(CGLPixelFormatObj)pixelFormat
{
    CGLPixelFormatAttribute attrs[] = 
    {
        kCGLPFAColorSize,     (CGLPixelFormatAttribute)24,
        kCGLPFAAlphaSize,     (CGLPixelFormatAttribute)8,
        kCGLPFADepthSize,     (CGLPixelFormatAttribute)24,
        (CGLPixelFormatAttribute)0
    };

    NSLog(@"Pixel format error:%d", CGLChoosePixelFormat(attrs, &pix, &pixn)); //returns 0

    NSLog(@"Context error: %d", CGLCreateContext(pix, NULL, &ctx)); //returns 0

    NSLog(@"The context:%p", ctx); // returns same memory address as similar NSLog call in function below

   return ctx;
} 
```

最后我重写`drawInCGLContext`以显示内容。

```
-(void)drawInCGLContext:(CGLContextObj)glContext pixelFormat:    (CGLPixelFormatObj)pixelFormat forLayerTime:(CFTimeInterval)timeInterval displayTime:(const CVTimeStamp *)timeStamp
{
    // Set the current context to the one given to us.
    CGLSetCurrentContext(glContext);

    int depth;

    NSLog(@"The context again:%p", glContext); //returns the same memory address as the NSLog in the previous function

    glMatrixMode (GL_PROJECTION);
    glLoadIdentity ();
    glOrtho(0.5, 0.5, 1.0, 1.0, -1.0, 1.0);

    glClearColor(0.0f, 0.0f, 0.0f, 0.0f);
    glEnable(GL_DEPTH_TEST);

    glGetIntegerv(GL_DEPTH_BITS, &depth);
    NSLog(@"%i bits depth", depth); // returns 0

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    //drawing code here

    // Call super to finalize the drawing. By default all it does is call glFlush().
    [super drawInCGLContext:glContext pixelFormat:pixelFormat forLayerTime:timeInterval displayTime:timeStamp];
} 
```

该程序编译良好并显示内容，但没有深度测试。我需要做些什么才能让它工作吗？还是我的整个方法都错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T04:55:22.293

看起来我覆盖了错误的方法。要获得所需的深度缓冲区，应覆盖`copyCGLPixelFormatForDisplayMask`类似的内容：

```
- (CGLPixelFormatObj)copyCGLPixelFormatForDisplayMask:(uint32_t)mask {
    CGLPixelFormatAttribute attributes[] =
    {
        kCGLPFADepthSize, 24,
        0
    };
    CGLPixelFormatObj pixelFormatObj = NULL;
    GLint numPixelFormats = 0;
    CGLChoosePixelFormat(attributes, &pixelFormatObj, &numPixelFormats);
    if(pixelFormatObj == NULL)
        NSLog(@"Error: Could not choose pixel format!");
return pixelFormatObj;
} 
```

基于[这里](https://web.archive.org/web/20130514052521/http://www.cocoabuilder.com/archive/cocoa/202651-caopengllayer.html)的代码。

# node.js - 将用户图像上传到 s3 并从节点生成缩略图

> ID：13261606
> 
> 赞同：3
> 
> 时间：2012-11-07T00:34:29.273
> 
> 标签：node.js, amazon-s3, amazon-web-services, express, meteor

我目前正在考虑开发 Meteor node.js 应用程序，但正在努力解决如何最好地处理用户图像的上传。特别是，我想创建一个摄影网站，允许摄影师在“管理”部分上传图像，然后这些图像将显示在网站上。我需要创建这些图像的缩略图，并将相应的 URL 保存到数据库中。我正在努力解决如何在流星中最好地实现这一点。

我最好的选择是将 s3 之类的东西与 AWS 流程结合使用来生成缩略图吗？

或者我应该直接在 Meteor/node 会话中保存和托管图像吗？

或者我应该废弃 Meteor 并在这个项目中使用 Express.js 之类的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T08:04:26.210

为什么不直接使用 Filepicker.io 之类的东西来处理上传和托管图像并简单地存储图像唯一 url（由回调中的 filepicker 给你）？缩略图也可以由 Filepicker 动态生成（使用简单的 url 修改）。

在图像方面，Cloudinary 是文件选择器更好的替代品，但集成过程会更加混乱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T01:04:19.457

我会将图像存储在文件系统上，而不是数据库中。如果您有唯一的 id，则可以将其用作 url 的一部分，例如图像所属项目的 id。可能看起来像这样：

```
./uploads/img-<id>-<size>.jpg 
```

如果需要，您可以使用 node-imagemagick 写入磁盘并调整大小，并且您的 cdn 应该不时轮询这些图像。不完全确定该部分在 html 中包含图像的 url 方面将如何工作。

# javascript - Javascript IE 冲突

> ID：13261608
> 
> 赞同：0
> 
> 时间：2012-11-07T00:34:46.080
> 
> 标签：javascript, internet-explorer

以下 javascript 代码在 FF 和 Chrome 中运行，但在任何版本的 IE 中运行。我似乎找不到任何明显的错误。

任何帮助将不胜感激。

```
<script type="text/javascript">
// hide/expose  search_by2 to/from dates 
function hide_search_by2(that){
    selected_value = that.options[that.selectedIndex].value;

    if(selected_value == 'vehicles_sales.nodate'){
        document.getElementById("search_by2_from_row").hidden=true;
        document.getElementById("search_by2_to_row").hidden=true;  
    } else {
        document.getElementById("search_by2_from_row").hidden=false;
        document.getElementById("search_by2_to_row").hidden=false;  
    }
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:42:58.040

隐藏了什么？

如果要隐藏元素，请将 display 设置为 none。

**隐藏**

```
document.getElementById("search_by2_from_row").style.display = "none"; 
```

**显示**

```
document.getElementById("search_by2_from_row").style.display = "inline";  //or "block" 
```

或能见度

**隐藏**

```
document.getElementById("search_by2_from_row").style.visibility = "hidden"; 
```

**显示**

```
document.getElementById("search_by2_from_row").style.visibility = "visible"; 
```

# stack - VxWorks（PowerPC）上使用的中断处理程序堆栈

> ID：13261614
> 
> 赞同：0
> 
> 时间：2012-11-07T00:35:09.463
> 
> 标签：stack, interrupt, vxworks

中断处理程序是使用被中断任务的堆栈还是单独的堆栈作为其堆栈？（PowerPC、VxWorks）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-13T09:02:54.720

这取决于架构。从 VxWorks 内核程序员指南（v6.8）：

> 所有 ISR 都使用相同的中断堆栈。[...]
> 
> 注意：某些架构不允许使用单独的中断堆栈，而 ISR 使用被中断任务的堆栈。[...] 请参阅您的 BSP 的 VxWorks 参考以确定您的架构是否支持单独的中断堆栈。

在您的情况下，PowerPC 确实支持单独的共享中断堆栈（每个内核）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T13:24:16.853

在 VxWorks 中，有一个特定的中断堆栈。所有中断处理程序共享同一个堆栈，该堆栈位于加载 vxWorks 映像的正上方。

我相信默认堆栈大小是 5K，但可以通过内核配置器轻松更改。

ISR 机制大致是这样工作的：
您可以认为 VxWorks 通常会在您的 ISR 代码周围安装一个汇编代码包装器。

在进入时，它会自动保存通用寄存器（在 ISR 堆栈上），以便保留执行上下文（另一个 ISR 或任务）状态。

在退出时，寄存器被恢复，但另外，调用 OS 调度程序来查看刚刚完成的 ISR 是否改变了更高优先级任务的状态。如果发生这种情况，则更高优先级的任务将继续。如果没有更高优先级的任务可用，则恢复原始任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:47:34.373

xiaokaoy，在 VxWorks 程序员指南第 2.6 节中有一个很好的关于中断如何工作的描述。如果您没有副本，可以从许多来源在线获得。

# php - 是否可以通过 post 发送 json 数组？

> ID：13261615
> 
> 赞同：2
> 
> 时间：2012-11-07T00:35:15.530
> 
> 标签：php, html, json, post

我试图将一个 json 数组发送到一个 php post 请求。

```
$myarray[] = 500;
$myarray[] = "hello world"; 
```

如何将 $myarray json 数据发送到 php 发布请求？

这是我尝试过的：

```
<form name="input" action="post.php">
<input type="hidden" name="json" value="[500,'hello world']" />
<input type="submit" value="Submit">
</form> 
```

我正在测试 API 并被告知它只需要 json 数据......但我似乎无法让它工作。我的猜测是我错误地发送了 json 数据。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T01:06:54.363

你遇到的问题是这个字符串不是正确的 JSON：`[500,'hello world']`

这将是正确的 JSON `[500,"hello world"]`。JSON 对格式非常严格，要求所有字符串值都用双引号括起来，绝不能用单引号括起来。

避免问题的正确做法是使用 php 函数`json_encode()`和`json_decode()`

例如，

```
<?php
    $myarray[] = 500;
    $myarray[] = "hello world";
    $myjson = json_encode($myarray);
?>
<form name="input" action="post.php">
    <input type="hidden" name="json" value="<?php echo $myjson ?>" />
    <input type="submit" value="Submit">
</form> 
```

在 post.php 中你会这样读，

```
<?php
    $posted_data = array();
    if (!empty($_POST['json'])) {
        $posted_data = json_decode($_POST['json'], true);
    }
    print_r($posted_data);
?> 
```

中的`true`标志`json_decode()`告诉函数您希望它作为关联数组而不是 PHP 对象，这是它的默认行为。

该`print_r()`函数将输出转换后的 JSON 数组的 php 结构：

```
Array(
    [0] => 500
    [1] => hello world
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T01:03:02.720

API 是您的第三方还是您制作的？

如果它是你的，那么使用你的表单发送的数据应该在你的 API 上像这样简单：

```
<?php
    $data = json_decode($_REQUEST['json']);

    echo $data[0]; // Should output 500
    echo $data[1]; // Should output hello world 
```

如果是第 3 方，他们可能希望您在帖子正文中发送 json。为此，请关注这篇文章：[如何使用 curl 将 JSON 发布到 PHP](https://stackoverflow.com/questions/813487/how-to-post-json-to-php-with-curl)。

# ruby-on-rails - 如何在 Rails 3 模型中访问 image_path 路由助手？

> ID：13261616
> 
> 赞同：17
> 
> 时间：2012-11-07T00:35:20.087
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, asset-pipeline, sprockets

我正在尝试在 Rails 3 模型中使用 Sprockets 的 image_path 方法。我已经尝试`ActionView::Helpers::AssetTagHelper`在我的模型中包含并调用 image_path 但这不起作用（`undefined local variable or method 'config'`）。

有任何想法吗？

**更新 - 这对我有用：**

```
ActionController::Base.new.view_context.asset_path("image.png") 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-03-29T01:52:10.563

我认为这是加载资产助手的标准方式：

```
ActionController::Base.helpers.asset_path("image.png") 
```

这似乎比创建一个新的 ActionController::Base 实例并请求视图上下文更可取，因为它更明确。

# php - 使用 Phalcon 标签动态加载 CSS 和 Javascript 文件

> ID：13261618
> 
> 赞同：1
> 
> 时间：2012-11-07T00:35:23.370
> 
> 标签：php, phalcon

[我想这个问题可能与如何在多模块 Phalcon 应用程序中使用“主布局”视图](https://stackoverflow.com/questions/12951048/how-do-i-use-main-layout-views-in-a-multi-module-phalcon-application)具有相同的结果？

我的**主布局**视图具有整个应用程序的基本 html 结构，并且我正在使用**控制器布局**视图来呈现该控制器的内容。我相信到目前为止我做得对吗？

但是现在我需要在我的**主布局**视图中加载与该模块控制器相关的特定 JS 和 CSS 文件。

目前我正在我的**主布局**文件中加载所有 CSS 和 JS，但这完全违背了多模块方法。每个模块都应该能够加载 css/js 文件，而无需修改核心布局文件。

理想情况下，我希望采用与设置页面标题相同的方法

**控制器：** Phalcon\Tag::setStylesheetLink(" [http://fonts.googleapis.com/css?family=Rosario](http://fonts.googleapis.com/css?family=Rosario) ", false);

**视图：**回声 Phalcon\Tag::getStylesheetLink();

有没有其他方法可以实现我可能会错过的这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T05:33:40.843

目前没有办法创建某种排序功能（样式表按照您设置的顺序打印出来）或一个收集工具，您只需将样式表添加到其中`\Phalcon\Tag::stylesheetLink()`就可以打印出来。

但是，您可以使用自定义类实现所需的功能，如下所示：

在您的 config.ini 中，您有此部分

```
[resource]
css.bootstrap = "/public/css/bootstrap.css"
css.index     = "/public/css/index.css"
css.about     = "/public/css/about.css"
css.contact   = "/public/css/contact.css" 
```

创建一个类`\MyApp\Tag`

```
namespace MyApp;

class Tag
{
    private $_css = array();

    public function add($css)
    {
        $this->_css[$css] = true;
    }

    public function remove($css)
    {
        $this->_css[$css] = false;
    }

    public function clear()
    {
        $this->_css = array();
    }

    public function generate()
    {
        $config = \Phalcon\DI::getDefault()->get('config');
        $output = '';

        foreach ($this->_css as $css => $active)
        {
            if ($active)
            {
                if (isset($config->resource->css->$css))
                {
                    $output .= \Phalcon\Tag::stylesheetLink($config->resource->css->$css);
            }
        }

        return $output;
    }
} 
```

然后在您的控制器中，您可以执行以下操作：

```
$style = new \MyApp\Tag();
$style->add('bootstrap');
$style->add('about');

$this->view->setVar('stylesheets', $style->generate(); 
```

在您看来：

```
<?php echo $stylesheets; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-16T00:05:54.197

这是一种手动操作 js 和 css 文件资产顺序的方法。

首先，在控制器中添加 css 和 js 路径时，使用自动 Phalcon\Assets\Collection 容器来存储您的临时资产：

```
$this->assets->addJs('js/bootstrap-multiselect.js');
$this->assets->addCss('css/bootstrap-multiselect.css'); 
```

在所有控制器扩展的自定义 BaseController 中，添加一个 afterExecuteRoute() 公共方法：

```
/**
 * stuff to do after a route has been executed
 * this is where we attach standard js and css assets
 * */
public function afterExecuteRoute(){
    // wait to rebuild assets until after the dispatcher is finished
    if( ! $this->dispatcher->isFinished() ){
        return;
    }
    ...
} 
```

一旦我们确定当前路由已完成执行，我们可以从 Phalcon\Assets\Manager 中的自动 js 和 css 集合中提取临时资产，将它们附加到我们的常见资产文件列表中，对它们进行排序和去重，然后将它们放入新的自定义集合中：

```
// get list of js files added to the standard js collection
$append_js = array();
forEach( $this->assets->getJs() as $js){
    $append_js[] = $js->getPath();
}
// declare paths to common js assets
$js_assets = array(
    'js/jquery-2.1.1.min.js',
    'js/jquery-ui.min.js',
    'js/bootstrap.min.js',
);
// merge common paths with ad-hoc paths
$js_assets = array_merge( $js_assets, $append_js );
$js_assets = array_unique( $js_assets ); // dedup
// add js assets to a new collection
$js_collection = $this->assets->collection('header_js');
forEach( $js_assets as $js_path ){
    $js_collection->addJs( $js_path );
} 
```

将 css 资源重新构建到新集合中的工作方式相同：

```
// get list of css files added to the standard css collection
$append_css = array();
forEach( $this->assets->getCss() as $css ){
    $append_css[] = $css->getPath();
}
// declare paths to common css assets
$css_assets = array(
    'css/jquery-ui.min.css',
    'css/jquery-ui.theme.min.css',
    'css/jquery-ui.structure.min.css',
    'css/bootstrap.min.css',
    'css/bootstrap-theme.min.css',
    'css/main.css',
);
// merge common paths with ad-hoc paths
$css_assets = array_merge( $css_assets, $append_css );
$css_assets = array_unique( $css_assets ); // dedup
// add css assets to a new collection
$css_collection = $this->assets->collection('header_css');
forEach( $css_assets as $css_path ){
    $css_collection->addCss( $css_path );
} 
```

最后，当您在模板中输出 js 和 css 资产时，输出新的自定义集合，而不是 Phalcon\Assets\Manager 自动创建的默认集合：

```
{{ getDoctype() }}
<html>
    <head>
        {{ tag.getTitle() }}
        {{ assets.outputCss( 'header_css' ) }}
        {{ assets.outputJs( 'header_js' ) }}
    </head> 
```

# excel - VBA 中的双循环

> ID：13261621
> 
> 赞同：1
> 
> 时间：2012-11-07T00:35:36.403
> 
> 标签：excel, vba

我正在尝试运行此循环，其中循环中的索引同时更改。

```
For i = 0 To 20 Step 5
For j = 0 To 5 Step 1

Range(ActiveCell, ActiveCell.Offset(5 + i, 0)).Copy Destination:=Cells(8, 12 + j)

Next i
Next j 
```

我正在尝试让循环执行此操作

```
Range(ActiveCell, ActiveCell.Offset(5 + 0, 0)).Copy Destination:=Cells(8, 12 + 0)
Range(ActiveCell, ActiveCell.Offset(5 + 5, 0)).Copy Destination:=Cells(8, 12 + 1)
Range(ActiveCell, ActiveCell.Offset(5 + 10, 0)).Copy Destination:=Cells(8, 12 + 2)
Range(ActiveCell, ActiveCell.Offset(5 + 15, 0)).Copy Destination:=Cells(8, 12 + 3)
Range(ActiveCell, ActiveCell.Offset(5 + 20, 0)).Copy Destination:=Cells(8, 12 + 4) 
```

我不幸的循环是这样做的：

```
Range(ActiveCell, ActiveCell.Offset(5 + 0, 0)).Copy Destination:=Cells(8, 12 + 0)
Range(ActiveCell, ActiveCell.Offset(5 + 5, 0)).Copy Destination:=Cells(8, 12 + 0)
Range(ActiveCell, ActiveCell.Offset(5 + 10, 0)).Copy Destination:=Cells(8, 12 + 0)
...
Range(ActiveCell, ActiveCell.Offset(5 + 0, 0)).Copy Destination:=Cells(8, 12 + 1)
Range(ActiveCell, ActiveCell.Offset(5 + 5, 0)).Copy Destination:=Cells(8, 12 + 1) 
```

我想我可以有一个这样的循环： 但这还不够。

```
For i = 0 To 20 Step 5

Range(ActiveCell, ActiveCell.Offset(5 + i, 0)).Copy Destination:=Cells(8, 12 + j-4)

Next j 
```

任何人都可以提出任何想法来建立一个循环同时变化的指标吗？谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:50:37.760

由于您希望它们并行运行，因此您实际上不想要两个循环。从另一个变量计算一个变量：

```
For j = 0 To 4 Step 1
  i = j * 5

  Range(ActiveCell, ActiveCell.Offset(5 + i, 0)).Copy Destination:=Cells(8, 12 + j)

Next i 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T00:39:40.540

```
for j = 0 to 5
    Range(ActiveCell, ActiveCell.Offset(5 + i, 0)).Copy _
         Destination:=Cells(8, 12 + j)
    i = i + 5
next j 
```

编辑：为了让我的回答更完整：嵌套的 for 循环不会“同时工作”。最里面的 for 循环执行每次迭代，结束，然后下一个循环可以完成它的循环，依此类推。你正在做的事情的诀窍是只有一个控制两个变量的循环。你可以选择任何你想在你的外观中加入的东西（i 并手动增加 j 或相反）。

# jquery - 在 Redactor 所见即所得中创建字体系列下拉菜单

> ID：13261622
> 
> 赞同：3
> 
> 时间：2012-11-07T00:35:37.963
> 
> 标签：jquery, drop-down-menu, wysiwyg, text-editor, rich-text-editor

我正在尝试在[Redactor](http://imperavi.com/redactor/)编辑器中创建一个下拉列表。最大的问题是使用选定的字体系列围绕选定的文本创建一个容器。

到目前为止，我已经完成了自定义下拉菜单的基本设置：

```
$("#text_edit").redactor({
    buttons: ['html', '|', 'bold', 'italic', 'deleted', '|', 'table', 'link', '|', 'fontcolor', 'backcolor', '|', 'fontfamily'],
    buttonsCustom: {
        fontfamily: {
            title: "Select Font",
            dropdown: {
                Arial: {
                    title: 'Arial',
                    callback: insertFont
                },
                Georgia: {
                    title: 'Georgia',
                    callback: insertFont
                }
            }
        }
    }
});

function insertFont(obj, e, key)
{
    // wrap selected text in <span> container with style attribute and selected font
} 
```

事实上，所需的方法与内置的 fontcolor 函数非常相似，它也将选定的文本包装在一个容器中，并为其分配正确的颜色样式属性。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T21:25:51.217

改进了之前的响应，这是 JQuery 中的一个实现，它将在下拉列表中很好地列出所有可能的 Web 安全字体：

```
var oFontMap: {
arial: ["Arial", "Arial, Helvetica, sans-serif"],
arialblack: ["Arial Black", '"Arial Black", Gadget, sans-serif'],
comicsans: ["Courier New", '"Courier New", Courier, monospace'],
courier: ["Comic Sans", '"Comic Sans MS", cursive, sans-serif'],
impact: ["Impact", 'Impact, Charcoal, sans-serif'],
lucida: ["Lucida", '"Lucida Sans Unicode", "Lucida Grande", sans-serif'],
lucidaconsole: ["Lucida Console", '"Lucida Console", Monaco, monospace'],
georgia: ["Georgia", "Georgia, serif"],
palatino: ["Palatino Linotype", '"Palatino Linotype", "Book Antiqua", Palatino, serif'],
tahoma: ["Tahoma", "Tahoma, Geneva, sans-serif"],
times: ["Times New Roman", "Times, serif"],
trebuchet: ["Trebuchet", '"Trebuchet MS", Helvetica, sans-serif'],
verdana: ["Verdana", "Verdana, Geneva, sans-serif"] };

//Create the font dropdown
var oFontDropdown = {}
$.each(oFontMap, function(iIndex, oFont){
    var sFontName = oFont[0];
    var sFontFace = oFont[1];
    oFontDropdown[iIndex] = {
        title: "<font face='"+sFontFace+"'>"+sFontName+"</font>",
        callback: function(obj, e, sFont){
            obj.execCommand("fontname", sFontFace);
        }
    }
});

return $(".redactor").redactor({
    focus: true,
    buttonsAdd: ["|", "font"],
    buttonsCustom: {
        font: {
            title: "Advanced Font List",
            dropdown: oFontDropdown
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T17:36:27.357

你可以试试这个，我已经解决了同样的要求，它以这种方式，在这里运行良好。

```
var setFontFamily;

setFontFamily = function(obj, e, key) {
  if (key === "serif") {
    obj.execCommand("fontname", "Times New Roman");
  }
  if (key === "sans") {
    return obj.execCommand("fontname", "Helvetica");
  }
};

$(document).ready(function() {
  return $(".redactor").redactor({
    focus: true,
    buttonsAdd: ["|", "font"],
    buttonsCustom: {
      font: {
        title: "Advanced List",
        dropdown: {
          serif: {
            title: "Times",
            callback: setFontFamily
          },
          sans: {
            title: "Helvetica",
            callback: setFontFamily
          }
        }
      }
    }
  });
}); 
```

setFontFamily 函数不是世界上最漂亮的，但它是一个概念证明，然后您可以看到它是如何定义字体系列的。

我是一个 Rails 编码器，所以我会在这里留下相同的代码，但 coffescript 版本（以防万一有人需要）

```
setFontFamily = (obj, e, key) ->
  obj.execCommand "fontname", "Times New Roman"  if key is "serif"
  obj.execCommand "fontname", "Helvetica"  if key is "sans"

$(document).ready ->
  $(".redactor").redactor
    focus: true
    buttonsAdd: ["|", "font"]
    buttonsCustom:
      font:
        title: "Advanced List"
        dropdown:
          serif:
            title: "Times"
            callback: setFontFamily
          sans:
            title: "Helvetica"
            callback: setFontFamily 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-29T14:11:31.737

Redactor 为此发布了新插件：

```
fontcolor.js, fontsize.js and fontfamily.js 
```

包含后，您可以像这样使用它们：

```
elem.redactor({
      plugins: ['fontcolor', 'fontsize', 'fontfamily']
}); 
```

请参阅此存储库： [https ://github.com/johnsardine/redactor-plugins](https://github.com/johnsardine/redactor-plugins)

# c# - 一台服务器多客户端：线程或类

> ID：13261625
> 
> 赞同：4
> 
> 时间：2012-11-07T00:36:12.587
> 
> 标签：c#, .net, sockets

我正在用 C# 做一个应用程序，有一个服务器和一些客户端（不超过 60 个），我希望能够独立处理每个客户端。服务器和客户端之间的通信很简单，但我必须等待一些确认，我不想阻止任何查询。

到目前为止，我已经做了两个版本的服务器端，一个基于此：

[http://aviadezra.blogspot.com.es/2008/07/code-sample-net-sockets-multiple.html](http://aviadezra.blogspot.com.es/2008/07/code-sample-net-sockets-multiple.html)

在另一个中，我基本上为每个客户端创建一个新线程。两个版本都可以正常工作......但我想知道这两种方法的优缺点。

在这种情况下要遵循什么编程模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:26:24.703

要回答你的问题，两者兼而有之。您有线程和类在这些线程中运行。无论您使用 WCF、异步、套接字还是其他任何方式，您都将在线程中运行一些对象（或像使用异步一样在线程池中混洗）。使用 WCF，您可以[配置并发模型](http://msdn.microsoft.com/en-us/library/system.servicemodel.concurrencymode.aspx)，如果您必须等待 ack 或其他确认，您最好将其设置为多个线程，这样您就不会阻塞其他请求。

在您链接到作者的示例中，它`AsyncCallback`用作告诉您套接字有数据的机制。但是，从[MSDN](http://msdn.microsoft.com/en-us/library/system.asynccallback.aspx)你可以看到：

> 使用 AsyncCallback 委托在单独的线程中处理异步操作的结果

所以对于小规模的应用程序来说真的没有什么不同。像这样使用异步可以帮助您避免为每个线程分配堆栈空间，如果您要执行大型应用程序，这将很重要。但对于一个小型应用程序，我认为它只会增加复杂性。C# 4.5+ 和 F# 用 async 做了更干净的工作，所以如果你可以使用类似的东西，那么也许会去。

按照您的方式进行操作，您将拥有一个负责套接字管理的线程。它会坐下来接受新的连接。当它收到一个请求时，它将该套接字交给一个新的专用线程，然后该线程将坐在该套接字上并从中读取。该线程是您的客户端连接。我喜欢将读取的套接字客户端封装到一个基类中，该基类可以执行所需的低级 io，然后充当请求的路由器。即，当我收到请求 XYZ 时，我会请求 ABC。您甚至可以让它分派事件并在其他地方订阅这些事件（如在异步示例中）。现在您已经将客户端逻辑与套接字读取逻辑解耦了。

如果您使用 WCF 执行操作，则不需要套接字和所有额外处理，但您仍然应该知道调用是多线程的，并且在适用时正确同步您的应用程序。

对于 60 位客户，我认为您应该选择最适合您的。WCF 易于设置且易于使用，我会使用它，但套接字也很好。如果您担心正在运行的线程数，请不要担心。虽然运行太多线程是不好的，但大多数线程实际上会在等待 IO 时被阻塞。处于等待状态的线程不是由操作系统调度的，并且并不重要。更不用说等待很可能是在引擎盖下使用 io 完成端口，因此对于像您这样的小型应用程序，等待开销几乎可以忽略不计。

最后，我会选择最容易编写、维护和扩展的东西。

# css - 如何在 DIV 中包装 DIV

> ID：13261630
> 
> 赞同：0
> 
> 时间：2012-11-07T00:36:20.320
> 
> 标签：css, html

我正在尝试将 div (noint_box1) 包装在一些 div 中，但是我没有成功。有人可以检查一下css，看看我做错了什么。

HTML：

```
<div id="tabs-container">
        <div id="tabs-box">
      <div class="tab active" id="tab1" onclick="showtab(1)">Delivery</div>
    <div class="tab" id="tab2" onclick="showtab(2)">Payments</div>
    <div class="tab" id="tab3" onclick="showtab(3)">Returns</div>
    <div class="tab" id="tab4" onclick="showtab(4)">Discount</div>
    </div>
    <div id="tab-content-box">
    <div class="tab-content active" id="content1">CONTENT </div>
    <div class="tab-content" id="content2">CONTENT</div>
    <div class="tab-content" style="text-decoration:none" id="content3">COTENT</div>
    <div class="tab-content" id="content4">CONTENT</div>
    </div>

    </div>
    </div> 
```

样式表：

```
#noint_box1{text-align:center;}
#tabs-container { width:942px; border-color: transparent}
#tab-content-box { border:none; border-color: transparent }
#tabs-box { height: 30px; border-color: transparent; padding-bottom:3px;}
.header1 {font: 22px 'MuliLight', Arial, sans-serif; color: #026c9f; text-align:left; vertical-align:top; text-shadow: #6ac6f0 1px 1px 1px; font-weight:bold }
.tab {     
 font-family:Arial, Helvetica, sans-serif;
 cursor:pointer
.tab.active { border-bottom: 2px solid white; text-align:left }
.tab.active { border-bottom: 2px solid white; text-align:left}
.tab-content { display: none; padding: 5px; text-align:left}
.tab-content.active { display: block; text-align:left}
#tab1 {margin-right:10px; text-align:center}
#tab2 {margin-right:10px; text-align:center}
#tab3 {margin-right:10px; text-align:center}
#tab4 {margin-right:10px; text-align:center}
#content1 {font: 16px 'MuliLight', Arial, sans-serif; text-align:left; color: #CCC; line-height:20px}
#content2 {font: 16px 'MuliLight', Arial, sans-serif; text-align:left; color: #CCC; line-height:20px; margin-bottom:3px}
#content3 {font: 16px 'MuliLight', Arial, sans-serif; text-align:left; color: #CCC; line-height:20px}
#content4 {font: 16px 'MuliLight', Arial, sans-serif; text-align:left; color: #CCC; line-height:20px} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:49:08.530

html 和 css 都很臃肿，我不建议使用这种风格

美化两者后

HTML 通过[http://jsbeautifier.org/](http://jsbeautifier.org/)

```
<div id="noint_box1">
    <td class="topparts" width="936">MY CONTENT1</td>
    <div id="tabs-container">
        <div id="tabs-box">
            <div class="tab active" id="tab1" onclick="showtab(1)">Delivery</div>
            <div class="tab" id="tab2" onclick="showtab(2)">Payments</div>
            <div class="tab" id="tab3" onclick="showtab(3)">Returns</div>
            <div class="tab" id="tab4" onclick="showtab(4)">Discount</div>
        </div>
        <div id="tab-content-box">
            <div class="tab-content active" id="content1">CONTENT1
                <br />
            </div>
            <div class="tab-content" id="content2">CONTENT2</div>
            <div class="tab-content" style="text-decoration:none" id="content3">CONTENT3</div>
            <div class="tab-content" id="content4">CONTENT4</div>
        </div> 
```

和 CSS 通过[http://cssbeautify.com/](http://cssbeautify.com/)

```
#noint_box1 {
    text-align: center;
}

#tabs-container {
    width: 942px;
    border-color: transparent;
}

#tab-content-box {
    border: none;
    border-color: transparent;
}

#tabs-box {
    height: 30px;
    border-color: transparent;
    padding-bottom: 3px;
}

.header1 {
    font: 22px 'MuliLight', Arial, sans-serif;
    color: #026c9f;
    text-align: left;
    vertical-align: top;
    text-shadow: #6ac6f0 1px 1px 1px;
    font-weight: bold;
}

.tab {
    font-family: Arial, Helvetica, sans-serif;
    cursor: pointer
.tab.active { border-bottom: 2px solid white;
    text-align: left;
}

.tab.active {
    border-bottom: 2px solid white;
    text-align: left;
}

.tab-content {
    display: none;
    padding: 5px;
    text-align: left;
}

.tab-content.active {
    display: block;
    text-align: left;
}

#tab1 {
    margin-right: 10px;
    text-align: center;
}

#tab2 {
    margin-right: 10px;
    text-align: center;
}

#tab3 {
    margin-right: 10px;
    text-align: center;
}

#tab4 {
    margin-right: 10px;
    text-align: center;
}

#content1 {
    font: 16px 'MuliLight', Arial, sans-serif;
    text-align: left;
    color: #CCC;
    line-height: 20px;
}

#content2 {
    font: 16px 'MuliLight', Arial, sans-serif;
    text-align: left;
    color: #CCC;
    line-height: 20px;
    margin-bottom: 3px;
}

#content3 {
    font: 16px 'MuliLight', Arial, sans-serif;
    text-align: left;
    color: #CCC;
    line-height: 20px;
}

#content4 {
    font: 16px 'MuliLight', Arial, sans-serif;
    text-align: left;
    color: #CCC;
    line-height: 20px;
} 
```

您可以很容易地观察到 HTML 代码中的问题，而且 css 看起来过多并且可能会被清理

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:41:52.143

我发现 HTML 代码存在三个问题：

*   您在各个部门之间有一个表格单元格。如果您在表格行中，则分区不能在那里，如果您不在表格行中，则表格单元格不能在那里。

*   没有结束标签`<div id="tabs-container">`

*   没有结束标签`<div id="noint_box1">`

# asp.net - 如何在 IIS 6 上启用 HTTP PUT？

> ID：13261632
> 
> 赞同：3
> 
> 时间：2012-11-07T00:36:55.583
> 
> 标签：asp.net, http, iis-6, http-put

我有一个 ASP.NET 3.5 网站，我试图在运行 IIS 6 的服务器上部署该网站。一切正常，但在尝试向页面发出 HTTP`PUT`请求时出现错误*`.aspx`*：

> 错误消息：路径“PUT”被禁止。堆栈跟踪：在 System.Web.HttpMethodNotAllowedHandler.ProcessRequest(HttpContext context) 在 System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() 在 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)

这是一个 ASP.NET 3.5 Forms 应用程序。我努力了：

*   在 IIS 映射中为 .aspx 设置“所有”动词
*   在 IIS 映射中为 .svc 设置“所有”动词
*   添加通配符应用程序映射 *`C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll`*
*   将“PUT”添加到 web.config 中的 system.webServer -> handlers 部分

如果有人有任何建议，将不胜感激。

我在 IIS 7.5 上运行的同一个站点没有任何问题，但不幸的是，在这种情况下我被 6.0 困住了。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-05T17:39:24.127

[MSDN 注册 Http 处理程序](http://msdn.microsoft.com/en-us/library/46c5ddfy%28v=vs.100%29.aspx)

根据 MSDN，您应该在 web.config 的 httpHandlers 部分而不是 System.WebServer handlers 部分中注册动词，因为您正在运行 IIS 6.0。

# javascript - 将脚本部分添加到子窗口 Javascript

> ID：13261634
> 
> 赞同：0
> 
> 时间：2012-11-07T00:37:13.263
> 
> 标签：javascript, jquery, events, onclick, childwindow

我正在尝试制作一个弹出窗口，显示地址表，并让用户单击其中一个地址并将该信息发送回父级。我的功能目前看起来像（其他部分是我遇到问题的地方）：

```
 function ups_address_validation(address1, address2, city, state, zip)
     {
         var address = new Object;
            address.address1 = address1.value;
            address.address2 = address2.value;
            address.city = city.value;
            address.state = state.value;
            address.zip = zip.value;
            var data = {address: address};
            var info = ups_api('validate_address', data);
            if (info.hasOwnProperty('ValidAddressIndicator'))
            {
                $("#" + address1.field).val(info.Candidate.AddressKeyFormat.AddressLine[0]);
                $("#" + address2.field).val(info.Candidate.AddressKeyFormat.AddressLine[1]);
                $("#" + city.field).val(info.Candidate.AddressKeyFormat.PoliticalDivision2);
                $("#" + state.field).val(info.Candidate.AddressKeyFormat.PoliticalDivision1);
                $("#" + zip.field).val(info.Candidate.AddressKeyFormat.PostcodePrimaryLow + '-' + info.Candidate.AddressKeyFormat.PostcodeExtendedLow);
            }
            else
            {
                var candidates = info.Candidate;
                var popup = window.open('', 'Addresses', 'width=850, height=350, scrollbars=1' );
                var html = "<head>" +
                            "<link rel='stylesheet' type='text/css' href='css/style.css' media='screen'></link>" +
                            "<link type='text/css' href='/public/utilities/jquery/css/smoothness/jquery-ui-1.8.22.custom.css' rel='stylesheet'></link>" +
                            "<script type='text/javascript' src='/public/utilities/jquery/js/jquery-1.7.2.min.js'></script>" +  
                            "<script type='text/javascript'> $(document).ready(function(){$('td').click(function(){alert('clicked');})});});</script>" +
                            "</head><body>" +
                            "<div class='wrapper' style='width: 800; background-color: #fff'><div class='content' style='width: 800'>" +
                            "<div class='module_header'>Confirmed Addresses</div><table class='lookup_table' style='width: 800'><tr><th>Address1</th><th>Address2</th><th>City</th><th>State</th><th>Zip</th></tr>";
                var i = 0;
                for (var i in candidates)
                {
                    var row = (i %2)? 'alt': '';
                    html += "<tr class='"+row+"'>";
                    if (info.Candidate[i].AddressKeyFormat.AddressLine instanceof Object)
                        {
                            for (var p in info.Candidate[i].AddressKeyFormat.AddressLine)
                            {
                                html += "<td>" + info.Candidate[i].AddressKeyFormat.AddressLine[p] + "</td>";
                            }
                        }
                    else
                        {
                            html+= "<td>" + info.Candidate[i].AddressKeyFormat.AddressLine + "</td><td></td>";
                        }
                    html +=     "<td>" +
                                    info.Candidate[i].AddressKeyFormat.PoliticalDivision2 +
                                "</td><td>" +
                                    info.Candidate[i].AddressKeyFormat.PoliticalDivision1 +
                                "</td><td>" +
                                    info.Candidate[i].AddressKeyFormat.PostcodePrimaryLow + "-" + info.Candidate[i].AddressKeyFormat.PostcodeExtendedLow +
                                "</td></tr>";
                }
                html += "</table><div class='module_header'>Submitted Address</div><table class='lookup_table' style='width: 800'><tr><th>Address1</th><th>Address2</th><th>City</th><th>State</th><th>Zip</th></tr>";
                html += "<tr><td>" + address1.value + "</td><td>" + address2.value + "</td><td>" + city.value + "</td><td>" + state.value + "</td><td>" + zip.value + "</td><tr></table>";
                html += "</div></div></body>";
                popup.document.write(html);
                $(popup.document).ready(function(){
                    $('td').click(function(){alert('clicked');});
                });
            }

     } 
```

我想在每个表行上添加一个 onClick 事件，并使用一个将该数据发送回父窗口的函数。但是，我尝试了以下方法：

```
$(popup.document).ready(function(){ $('td').click(function(){ alert('clicked');});}); 
```

或使用脚本部分

如何将 onclick 事件传递给我的子窗口标签（通过将其传递给子窗口或从父窗口设置），以便我可以从表中返回信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:43:07.773

您可以在父窗口中执行一个函数，并从新打开的窗口中使用该函数发送参数。

然后父窗口将是`window.opener`，并且父窗口中的函数将是全局的，即在窗口范围内，您可以从打开的窗口调用该函数`window.opener.myFunction(parameters, from, myPopup);`

这意味着您将在新打开的窗口中编写 onclick 事件处理程序，并在单击时调用父窗口中的函数，将您选择的数据作为参数传递给父窗口中的函数。

这是一个[**演示**](http://jsfiddle.net/mGqgT/3/embedded/result/)

# mysql - 查询：具有索引/预测键/相关数据的表

> ID：13261636
> 
> 赞同：4
> 
> 时间：2012-11-07T00:37:47.707
> 
> 标签：mysql, database

我目前正在使用 MySQL 数据库表结构。我在网上找到了一个很棒的表结构，但我不知道如何复制这样的东西。我是新手，我请求帮助创建一个查询，该查询将创建所有表（具有相关数据（索引）、外键、多对多关系等）。

**随机**我能够进行查询以选择所有字段：

```
SELECT *

FROM schedule 

INNER JOIN semester 

ON schedule.semester_id = semester.id

INNER JOIN office_hours

ON office_hours.schedule_id = schedule.semester_id

INNER JOIN faculty

ON faculty.id = office_hours.faculty_id

INNER JOIN faculty_titles

ON faculty_titles.faculty_id = faculty.id

INNER JOIN faculty_education

ON faculty_education.faculty_id = faculty.id 

INNER JOIN section

ON section.faculty_id = faculty.id 

INNER JOIN class

ON class.id = section.class_id

INNER JOIN major_class_br 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T07:54:08.337

您可以在相应的 MySQL 文档中找到有关如何创建表的良好文档：

*   [MySQL 5.0](http://dev.mysql.com/doc/refman/5.1/en/create-table.html)
*   [MySQL 5.1](http://dev.mysql.com/doc/refman/5.0/en/create-table.html)
*   [MySQL 5.5](http://dev.mysql.com/doc/refman/5.5/en/create-table.html)

如果你想玩一点图形前端，你可以使用[MySQL Workbench 。](http://dev.mysql.com/downloads/workbench/)您可以从链接下载它或从 Linux 存储库安装它。

工作台中包含三个部分：SQL 开发、数据建模和服务器管理。在 Data Modeling 部分中选择“Create new EER Model”，然后选择“Add Diagramm”。您可以通过从左侧栏中拖放来插入新表，并通过单击“数据库”菜单条目然后单击“Forward Engineer...”将模型应用于数据库。

您在查询中链接的表结构也是由 MySQL Workbench 创建的。因此，您应该很容易比较它。

# xcode - XCode 忽略目标级预处理器宏

> ID：13261642
> 
> 赞同：1
> 
> 时间：2012-11-07T00:38:25.280
> 
> 标签：xcode, preprocessor

在 XCode 4.5 中，我的预处理器宏在目标级别定义时会被忽略，但在项目级别定义时会受到尊重。这是一个用于#ifdef 的简单符号定义（RESTKIT_GENERATE_SEED_DB）。使用“级别”显示，XCode 在已解析部分显示我的符号。另外，我已经仔细检查了我当前的方案是否正在运行定义宏的调试配置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T21:44:59.317

这是一个新手错误。设置是我有两个目标，一个定义了宏，一个没有定义。宏没有在目标级别被选中的原因是我从未运行过该目标。我以为您是通过在 TARGETS 下的目标列表中选择目标来运行它的。我现在意识到，为了运行目标，您必须在选择设备目标旁边的方案菜单中选择它。

# floating-point - 使用 IEEE 浮点格式 A 和 B 的 9 位浮点表示

> ID：13261647
> 
> 赞同：1
> 
> 时间：2012-11-07T00:38:47.450
> 
> 标签：floating-point, binary, hex, decimal, data-representation

我在处理浮点数时遇到了一些问题。我很难从浮点表示转换为十进制值，也很难从表示的格式 A 转换为表示的格式 B。

问题：

考虑以下两个基于 IEEE 浮点格式的 9 位浮点表示。

*   格式 A

有一个符号位。有 k = 5 个指数位。指数偏差为 15。有 n = 3 个小数位。

*   格式 B

有一个符号位有 k = 4 个指数位。指数偏差为 7。有 n = 4 个派系位

问题要我将浮点表示“0 10110 011”从格式 A 转换为格式 B。它还想知道每种格式的值。谁能帮助我完成这两项任务的程序。或者也许将我引导到一个能够向我展示的信息丰富的网站。我已经搜索了一段时间，但找不到任何资源。谢谢！

-马特

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T01:39:00.107

1-5-3格式的010110011是符号0，有偏指数10110 [2]，编码有效位011。符号是+，无偏指数是22-15 = 7，有效位是1.011 [2] = 1.375。（我们在编码后的有效数字前加上“1”。）所以表示的数字是 +2 ⁷ •1.375 = 176。

^(要将 176 编码为 1-4-4 格式，请利用您已经知道它是 +2 7) •1.375的事实。因此，符号为 +，无偏指数为 7，有效数字为 1.011 [2]。此有效位适合四位（因此不需要四舍五入）；编码后的有效数字（去掉前导“1”）是 0110。无偏指数是 7，偏差是 7，所以有偏指数是 14 = 1110 [2]。所以位域是符号0，指数1110，有效位0110，所有九位都是011100110。

# mysql - 基于多个表的聚合查询

> ID：13261650
> 
> 赞同：1
> 
> 时间：2012-11-07T00:38:57.843
> 
> 标签：mysql, database-design

我想创建一个包含员工、他们的工作、薪水和项目信息的数据库

我想保留项目成本的信息（项目的实际价值和员工投资的天数）

对于员工和项目，每个员工通过 PK 约束在项目中拥有一个角色，并允许将来添加新的角色类型（可能是“第三级”）。

```
 CREATE TABLE Employee(
      EmployeeID  INTEGER      NOT NULL PRIMARY KEY,
      Name        VARCHAR(30)  NOT NULL,
      Sex         CHAR(1)      NOT NULL,
      Address     VARCHAR(80)  NOT NULL,
      Security    VARCHAR(15)  NOT NULL,
      DeptID      INTEGER      NOT NULL,        
      JobID       INTEGER      NOT NULL
    );

    CREATE TABLE Departments  (
        DeptID   INTEGER     NOT NULL PRIMARY KEY,
        DeptName VARCHAR(30) NOT NULL
    );

    CREATE TABLE Jobs (
        JobID            INTEGER      NOT NULL PRIMARY KEY,
        JobName          VARCHAR(30)  NOT NULL,
        JobSalary        DOUBLE(15,3) NOT NULL default '0.000', 
        JobSalaryperDay  DOUBLE(15,3) NOT NULL default '0.000', 
        DeptID           INTEGER      NOT NULL
    );

    CREATE TABLE Project(
      ProjectID    INTEGER NOT NULL PRIMARY KEY,
      ProjectDesc   VARCHAR(200) NOT NULL,
      StartDate     DATE NOT NULL,
      EndDate       DATE NOT NULL, 
      DaysOfWork    INTEGER NOT NULL,
      NoEmployees   INTEGER NOT NULL,
      EstimatedCost DOUBLE(15,3) NOT NULL default '0.000', 
      RealCost      DOUBLE(15,3) NOT NULL default '0.000' 
    );

    CREATE TABLE `Project-Employee`(
      ProjectID    INTEGER NOT NULL,
      EmployeeID   INTEGER NOT NULL,
      Note         VARCHAR(200),
      DaysWork     INTEGER NOT NULL,
      CONSTRAINT fk_ProjectID  FOREIGN KEY (ProjectID)  REFERENCES Project(ProjectID),
      CONSTRAINT fk_EmployeeID FOREIGN KEY (EmployeeID) REFERENCES Employee(EmployeeID)
    );

INSERT INTO `Departments` VALUES (1, 'Outsourcing');
INSERT INTO `Departments` VALUES (2, 'Technician');
INSERT INTO `Departments` VALUES (3, 'Administrative');

INSERT INTO `Jobs` VALUES (1, 'welder'    ,500.550,16.7 ,2);
INSERT INTO `Jobs` VALUES (2, 'turner'    ,500.100,16.67,2);
INSERT INTO `Jobs` VALUES (3, 'assistant' ,650.100,21.67,2);
INSERT INTO `Jobs` VALUES (4, 'supervisor',800.909,26.70,3);
INSERT INTO `Jobs` VALUES (5, 'manager'   ,920.345,30.68,3);
INSERT INTO `Jobs` VALUES (6, 'counter'   ,520.324,17.35,1);

INSERT INTO `Employee` VALUES (10, 'Joe',  'M', 'Anywhere', '927318344', 1, 3);
INSERT INTO `Employee` VALUES (20, 'Moe',  'M', 'Anywhere', '827318322', 2, 3);
INSERT INTO `Employee` VALUES (30, 'Jack', 'M', 'Anywhere', '927418343', 3, 4);
INSERT INTO `Employee` VALUES (40, 'Marge','F', 'Evererre', '127347645', 1, 6);
INSERT INTO `Employee` VALUES (50, 'Greg' ,'M', 'Portland', '134547633', 3, 5);

INSERT INTO `Project` VALUES (1, 'The very first', '2008-7-04' , '2008-7-24' , 20, 5, 3000.50, 2500.00);
INSERT INTO `Project` VALUES (2, 'Second one pro', '2008-8-01' , '2008-8-30' , 30, 5, 6000.40, 6100.40);

INSERT INTO `Project-Employee` VALUES (1, 10, 'Worked all days'    , 20);
INSERT INTO `Project-Employee` VALUES (1, 20, 'Worked just in defs', 11);
INSERT INTO `Project-Employee` VALUES (1, 30, 'Worked just in defs', 17);
INSERT INTO `Project-Employee` VALUES (1, 40, 'Contability '       , 8);
INSERT INTO `Project-Employee` VALUES (1, 50, 'Managed the project', 8); 
```

因此，要获得项目成本的总金额并将其用于未来的工作报价，我只需在汇总查询中汇总每个员工的每个工作的工作日。

知道参与特定项目的员工了解他们的工作产生的成本，将所有工作日求和的查询**是什么，是否有可能通过这种设计知道这一点？**

所以假设我知道在项目 1 中，有 5 名员工参与其中，并且我通过其他表“工作”知道我每天支付给他们每个人的薪水

我在[这里用 sqlfiddle做一些查询](http://sqlfiddle.com/#!2/4744e)

**更新**

```
 CREATE TABLE `Sexes` (
   Sex char(1) primary key
 );
 INSERT INTO Sexes values ('M');
 INSERT INTO Sexes values ('F');

CREATE TABLE `Employee`(
  EmployeeID  INTEGER      NOT NULL PRIMARY KEY,
  Name        VARCHAR(130)  NOT NULL,
  Sex         CHAR(1)      NOT NULL,
  Address     VARCHAR(380)  NOT NULL,
  Security    VARCHAR(15)  NOT NULL,
  FOREIGN KEY (Sex) references Sexes (Sex),
  CONSTRAINT `uc_EmployeeInfo` UNIQUE (`EmployeeID`,`Name`,`Security`)           
);

CREATE TABLE `Department`  (
  DeptID   INTEGER     NOT NULL PRIMARY KEY,
  DeptName VARCHAR(30) NOT NULL,
  CONSTRAINT `uc_DeptName` UNIQUE (`DeptID`,`DeptName`)
);

CREATE TABLE `Dept-Employee`(
  EmployeeID   INTEGER NOT NULL,          
  DeptID       INTEGER NOT NULL,     
  CONSTRAINT fk_DeptID     FOREIGN KEY (DeptID)     REFERENCES `Department`(DeptID),
  CONSTRAINT fk_EmployeeID FOREIGN KEY (EmployeeID) REFERENCES `Employee`(EmployeeID)
);

 CREATE TABLE `Dept-Manager`(
  EmployeeID   INTEGER NOT NULL,          
  DeptID       INTEGER NOT NULL,
  CONSTRAINT fk_DeptIDs     FOREIGN KEY (DeptID)     REFERENCES `Department`(DeptID),
  CONSTRAINT fk_EmployeeIDs FOREIGN KEY (EmployeeID) REFERENCES `Employee`(EmployeeID)
);

CREATE TABLE `Jobs` (
  JobID            INTEGER      NOT NULL PRIMARY KEY,
  JobName          VARCHAR(30)  NOT NULL,
  JobSalary        DECIMAL(7,3) NOT NULL default '0000.000', 
  JobSalaryperDay  DECIMAL(7,3) NOT NULL default '0000.000', 
  CONSTRAINT `uc_jobs` UNIQUE (`JobID`,`JobName`)
);

CREATE TABLE `Jobs-Employee`(
  EmployeeID   INTEGER NOT NULL,
  JobID        INTEGER NOT NULL,
  CONSTRAINT fk_JobIDs       FOREIGN KEY (JobID)      REFERENCES `Jobs`(JobID),
  CONSTRAINT fk_EmployeeIDss FOREIGN KEY (EmployeeID) REFERENCES `Employee`(EmployeeID)
);

CREATE TABLE `Project`(
  ProjectID     INTEGER NOT NULL PRIMARY KEY,
  ProjectName   VARCHAR(200) NOT NULL,
  StartDate     DATE    NOT NULL,
  DaysOfWork    INTEGER NOT NULL,
  NoEmployees   INTEGER NOT NULL,
  EstimatedCost DECIMAL(9,3) NOT NULL default '000000.000', 
  RealCost      DECIMAL(9,3) NOT NULL default '000000.000', 
  CONSTRAINT `uc_project` UNIQUE (`ProjectID`,`ProjectName`)           
);

CREATE TABLE `Project-Employee`(
  ProjectID    INTEGER NOT NULL,
  EmployeeID   INTEGER NOT NULL,
  Note         VARCHAR(200),
  DaysWork     INTEGER NOT NULL,
  CONSTRAINT fk_ProjectIDsss  FOREIGN KEY (ProjectID)  REFERENCES `Project`(ProjectID),
  CONSTRAINT fk_EmployeeIDsss FOREIGN KEY (EmployeeID) REFERENCES `Employee`(EmployeeID)
);

    INSERT INTO `Department` VALUES (1, 'Outsourcing');
    INSERT INTO `Department` VALUES (2, 'Technician');
    INSERT INTO `Department` VALUES (3, 'Administrative');

    INSERT INTO `Jobs` VALUES (1, 'welder'    ,500.550, 16.7 );
    INSERT INTO `Jobs` VALUES (2, 'turner'    ,500.100, 16.67);
    INSERT INTO `Jobs` VALUES (3, 'assistant' ,650.100, 21.67);
    INSERT INTO `Jobs` VALUES (4, 'supervisor',800.909, 26.70);
    INSERT INTO `Jobs` VALUES (5, 'manager'   ,920.345, 30.68);
    INSERT INTO `Jobs` VALUES (6, 'counter'   ,520.324, 17.35);

    INSERT INTO `Employee` VALUES (10, 'Joe',  'M', 'Joewhere', '927318344');
    INSERT INTO `Employee` VALUES (20, 'Moe',  'M', 'Moewhere', '827318322');
    INSERT INTO `Employee` VALUES (30, 'Jack', 'M', 'Jaswhere', '927418343');
    INSERT INTO `Employee` VALUES (40, 'Marge','F', 'Evererre', '127347645');
    INSERT INTO `Employee` VALUES (50, 'Greg' ,'M', 'Portland', '134547633');

    INSERT INTO `Dept-Employee`  VALUES (10,1);
    INSERT INTO `Dept-Employee`  VALUES (20,2);
    INSERT INTO `Dept-Employee`  VALUES (30,3);
    INSERT INTO `Dept-Employee`  VALUES (40,1);
    INSERT INTO `Dept-Employee`  VALUES (50,3);

    INSERT INTO `Jobs-Employee`  VALUES (10,3);
    INSERT INTO `Jobs-Employee`  VALUES (20,3);
    INSERT INTO `Jobs-Employee`  VALUES (30,4);
    INSERT INTO `Jobs-Employee`  VALUES (40,6);
    INSERT INTO `Jobs-Employee`  VALUES (50,5);

    INSERT INTO `Project` VALUES (1, 'The very first', '2008-7-04' , 20, 5, 3000.50, 2500.00);
    INSERT INTO `Project` VALUES (2, 'Second one pro', '2008-8-01' , 30, 5, 6000.40, 6100.40);

    INSERT INTO `Project-Employee` VALUES (1, 10, 'Worked all days'    , 20);
    INSERT INTO `Project-Employee` VALUES (1, 20, 'Worked just in defs', 11);
    INSERT INTO `Project-Employee` VALUES (1, 30, 'Worked just in defs', 17);
    INSERT INTO `Project-Employee` VALUES (1, 40, 'Contability '       , 8);
    INSERT INTO `Project-Employee` VALUES (1, 50, 'Managed the project', 8); 
```

对于新结构，我这样做了

```
CREATE VIEW `Emp-Job` as
SELECT e.*,j.jobID  
FROM  Employee e,`Jobs-Employee` j
WHERE e.EmployeeID = j.EmployeeID;

CREATE VIEW `employee_pay` as
select e.*, j.jobname, j.jobsalary, j.jobsalaryperday
from `Emp-Job` e
inner join `Jobs` j
        on e.JobID = j.JobID;

create view project_pay as 
select pe.projectid, pe.employeeid, pe.dayswork,
       e.jobsalaryperday, (e.jobsalaryperday * dayswork) as total_salary
from `Project-Employee` pe
inner join `employee_pay` e
        on e.employeeid = pe.employeeid 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T01:43:08.700

您问题末尾的数据似乎与您的 INSERT 语句中的数据不匹配。

你听说过“分而治之”吗？这是使用它的好时机。这就是我要做的。

```
create view employee_pay as
select e.*, j.jobname, j.jobsalary, j.jobsalaryperday
from employee e
inner join jobs j on e.jobid = j.jobid

create view project_pay as 
select pe.projectid, pe.employeeid, pe.dayswork,
       e.jobsalaryperday, (e.jobsalaryperday * dayswork) as total_salary
from project_employee pe
inner join employee_pay e
        on e.employeeid = pe.employeeid 
```

我*会这样做*，因为我希望这些观点通常是有用的。（尤其是调试。）创建了这些视图后，项目的总和非常简单。

```
select projectid, sum(total_salary) as total_salaries
from project_pay
group by projectid

projectid  total_salaries
--
1          1509.91 
```

你*真的*不想用 DOUBLE 来赚钱。[请改用 DECIMAL](http://dev.mysql.com/doc/refman/5.5/en/fixed-point-types.html)。

* * *

使用此查询来找出我的总和与您的不匹配的原因。

```
select p.*, e.name
from project_pay p
inner join employee e on e.employeeid = p.employeeid;

projectid  employeeid  dayswork  jobsalaryperday  total_salary  name
1          10          20        21.67            433.4         Joe
1          20          11        21.67            238.37        Moe
1          30          17        26.7             453.9         Jack
1          40           8        17.35            138.8         Marge
1          50           8        30.68            245.44        Greg 
```

* * *

# 反模式

## 破碎的身份

每当你看到这样一张桌子

```
CREATE TABLE Departments  (
    DeptID   INTEGER     NOT NULL PRIMARY KEY,
    DeptName VARCHAR(30) NOT NULL
); 
```

你应该假设它的结构是错误的，并深入挖掘。（在被证明无罪之前，它被假定为有罪。）您寻找的反模式

*   整数作为人工主键，以及
*   *没有*其他独特的约束。

像这样的表允许复制真实数据，消除了人工密钥的用处。

```
DeptID  DeptName
--
1       Wibble
2       Wibble
...
175     Wibble 
```

像这样的表也将允许多个外键引用。这意味着一些外键可能引用 Wibble (DeptID = 1)，一些可能引用 Wibble (DeptID = 175)，等等。

要解决这个问题，请在 DeptName 上添加一个 UNIQUE 约束。

## 缺少外键引用

每当你看到这样一张桌子

```
CREATE TABLE Employee(
  EmployeeID  INTEGER      NOT NULL PRIMARY KEY,
  Name        VARCHAR(30)  NOT NULL,
  ...
  DeptID      INTEGER      NOT NULL,        
  JobID       INTEGER      NOT NULL
); 
```

你应该假设它的结构是错误的，并深入挖掘。（同样，在被证明无罪之前，它被假定为有罪。）您寻找的反模式

*   其他表中的 ID 号，以及
*   没有引用这些表的外键约束。

要解决此问题，请为 DeptID 和 JobID 添加外键约束。在 MySQL 上，请确保您也在使用 INNODB 引擎。（从 MySQL 5.6 开始，[MyISAM 仍然不会强制执行外键约束](http://dev.mysql.com/doc/refman/5.6/en/ansi-diff-foreign-keys.html)，但如果您编写它们，它不会给您错误或警告。它们被解析并忽略。）

如果你从另一个 dbms 来到 MySQL，你会惊讶地发现 MySQL 不支持内联外键引用语法。这意味着你不能写这个。

```
DeptID integer not null references Departments (DeptID) 
```

相反，您必须在 CREATE TABLE 语句中编写单独的外键子句。（或者使用单独的 ALTER TABLE 语句来声明 FK 引用。）

```
DeptID integer not null,
foreign key (DeptID) references Departments (DeptID) 
```

[在此页面](http://dev.mysql.com/doc/refman/5.6/en/innodb-foreign-key-constraints.html)中搜索“inline ref”，但请阅读全文。

## 缺少 CHECK() 约束

MySQL 不强制执行 CHECK() 约束，因此对于请求 CHECK() 约束的列，您需要一个表和一个外键引用。当你看到这样的结构时

```
CREATE TABLE Employee(
  EmployeeID  INTEGER      NOT NULL PRIMARY KEY,
  Name        VARCHAR(30)  NOT NULL,
  Sex         CHAR(1)      NOT NULL, 
```

“Sex”列请求 CHECK() 约束。

```
CREATE TABLE Employee(
  EmployeeID  INTEGER      NOT NULL PRIMARY KEY,
  Name        VARCHAR(30)  NOT NULL,
  Sex         CHAR(1)      NOT NULL CHECK( Sex IN ('M', 'F')), 
```

但是 MySQL 不强制执行 CHECK() 约束，因此您需要另一个表和一个外键引用。

```
create table sexes (
  sex char(1) primary key
);
insert into sexes values ('M');
insert into sexes values ('F');

CREATE TABLE Employee(
  EmployeeID  INTEGER      NOT NULL PRIMARY KEY,
  Name        VARCHAR(30)  NOT NULL,
  Sex         CHAR(1)      NOT NULL,
  ...
  foreign key (Sex) references Sexes (Sex) 
```

对于这些列中的大多数，我会考虑 CHECK() 约束。有些可以实现为具有外键引用的表。

*   员工安全
*   Jobs.JobSalary
*   Jobs.JobSalaryperDay
*   Project.DaysOfWork
*   Project.NoEmployees
*   Project.EstimatedCost
*   项目.RealCost
*   Project_Employee.DaysWork

## 使用浮点数据类型赚钱

不要那样做。浮点数是有用的近似值，但它们仍然是近似值。请改用 DECIMAL。

# php - 滚动到与单击的缩略图对应的图像的图像库

> ID：13261653
> 
> 赞同：1
> 
> 时间：2012-11-07T00:39:28.023
> 
> 标签：php, javascript, html, css

我正在创建一个包含图片库的网站。

您有一个包含不同类别的侧边菜单，当您单击类别时会出现一个隐藏的 div，其中填充有缩略图，当您单击任何缩略图时，它会隐藏缩略图 div 并在其位置显示图像库。

我正在尝试做的一个例子是：http: [//www.matitacorp.com/web/portfolio.php](http://www.matitacorp.com/web/portfolio.php)

我想做的是当缩略图 div 隐藏并且图像库出现时，我也希望与单击的缩略图相对应的图像出现，即使它在可滚动缩略图库中低 3 或 4 张图片。

我尝试使用 .scrolltop() 并设置值，但我认为我遗漏了一些东西。我的 div 显示正确，但我没有让 scrolltop 值起作用，或者我使用了完全错误的功能。希望有人可以帮忙。

这是我正在尝试使用的一段代码：

```
//thumbnail section
<div id="booth">      
  <a href="#" id="identityoverlay"><img src="thumb1" alt="" /></a>
  <a href="#" id="identityoverlayA"><img src="thumb2" alt="" /></a>
  <a href="#" id="identityoverlayB"><img src="thumb3" alt="" /></a>
</div>

//main image section
<div id="identityOverlay" style="background-image:url(images/bkgrnd_700.gif); height:720px; display:none;">               

    <div id="imageGallery style="padding-left:95px; padding-top:10px; padding-bottom:15px; overflow:auto; height:610px;">            
                <img src="mainImg1" /><br />              
                <img src="mainImg2" /><br />              
                <img src="mainImg3" /><br />              
    </div>
</div>

<script>
    $("#identityoverlay").click(function () {
      $("#identityOverlay").show();     
      $("#booth").hide();
});    

    $("#identityoverlayA").click(function () {       
      var myCont = document.getElementById ("imageGallery");
              myCont.scrollTop(100); 

      $("#identityOverlay").show();       
      $("#booth").hide();
});   
</script> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:13:16.603

那么你的代码有几个问题。

首先，您应该防止点击时的默认操作，其次您应该先隐藏/显示 div，然后滚动到想要的位置。

这是修改后的代码：

```
$("#identityoverlayA").click(function (e) {
    e.preventDefault;

    $("#booth").hide();
    $("#identityOverlay").show();       

    var myCont = document.getElementById ("imageGallery");
    myCont.scrollTop(100); 
}); 
```

# php - 使用 Jquery/Javascript 查找多个 PHP 生成的输入

> ID：13261654
> 
> 赞同：2
> 
> 时间：2012-11-07T00:39:35.127
> 
> 标签：php, javascript, jquery, ajax, xhtml

我似乎无法弄清楚这一点。我正在尝试使用 Javascript 来选择输入值。问题是表单正在通过一个 php 数组循环，该数组获取 eve 使得每个表单都具有相同的名称，并且输入的名称。javascript 只会让我得到第一个表单的值。我已经尝试将表单放入数组中，`[]`但我无法得到它..请帮忙。

```
 $find = mysql_query("
       SELECT `name`, `desc`, LEFT(`desc`, 80),`price`, `page`, `id`
       FROM `bang` 
       ORDER BY id ASC LIMIT 2 ") or die(mysql_error());

       while($resultt= mysql_fetch_array($find)){
          echo '<form id="linkcenter" action="">';
          echo '<input type="hidden" value="'.$resultt['id'].'" id="linkcenterr" name="linkcenterr"';
          echo '<input type="button" name="butn" value="Send" onClick="loadInfoo()">';
          echo '</select>';
          echo '</form>';
    } 
```

Javascript 和 jQuery 在单独的文件中：

```
 function loadInfoo() {  
       var id = document.getElementById('linkcenterr').value;
       //ajax and more java bellow that i know is working..
    } 
```

我使用 jquery 只是为一个框设置动画，然后这个输入通过 javascript 并发送到一个 php 文件，该文件运行一个 sqlquery 并回显数据库中的所有数据。

我知道所有其他代码都在工作，问题是我不知道如何将这些表单格式化为数组，以便 javascript 在单击时可以获取每个值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:43:01.020

HTML 元素中的`id`属性对于文档必须是唯一的。`id='linkcenterr'`您对所有表单输入和标签都使用相同的`<form>`，这是无效的。大多数浏览器只会选择第一个。

您必须为每个节点提供唯一的 ID：

```
while($resultt= mysql_fetch_array($find)){
    // Use $resultt['id'] in the node id
    echo '<form id="linkcenter' . $resultt['id'] . '" action="" class="linkcenter-form">';
    // Use $resultt['id']  with another string in the node id
    // Don't forget to close the tag > here.
    echo '<input type="hidden" value="'.$resultt['id'].'" id="input_linkcenterr' . $resultt['id'] . '" name="linkcenterr" class="linkcenterr-input">' ;
    echo '<input type="button" name="butn" value="Send" onClick="loadInfoo()">';
    echo '</select>';
    echo '</form>';
} 
```

然后，在您的 JavaScript 中，您必须通过 单独定位它们`document.getElementById()`或通过 分组定位它们`document.getElementsByTagName()`。

如果您使用已标记的 jQuery，则可以使用以下命令定位所有表单：

```
// Get all by class
var forms = $('form.linkcenter-form');

// Get all the inputs by class
var inputs = $('input.linkcenterr-input'); 
```

在您的函数`loadInfoo()`中，您应该将`$resultt['id']`作为参数传递，您可以使用它来按 id 定位元素。

```
 // Pass the id into the function
 echo '<input type="button" name="butn" value="Send" onClick="loadInfoo(' . $resultt['id'] . ')">'; 
```

并定义函数以在其选择器中使用 id 参数：

```
function loadInfoo(idVal) {  
    // Concatenate the id param with onto linkcenterr:
    var id = document.getElementById('input_linkcenterr' + idVal).value;

    // Or the jQuery version:
    var id = $('#input_linkcenterr' + idVal).val();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:43:48.617

只需在循环中实现一个计数器并将计数器值添加到 id 中，如下所示：

```
$i=0;
while($resultt= mysql_fetch_array($find)){
    echo '<form id="linkcenter'.$i.'" action="">';
    echo '<input type="hidden" value="'.$resultt['id'].'" id="linkcenterr'.$i.'" name="linkcenterr"';
    echo '<input type="button" name="butn" value="Send" onClick="loadInfoo('.$i.')">';
    echo '</select>';
    echo '</form>';
    $i++;
} 
```

然后根据传递的参数调整您的javascript以获取值

```
function loadInfoo(index) {  
var id = document.getElementById('linkcenterr'+index).value;
//ajax and more java bellow that i know is working..
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T00:44:43.257

给出`<form>`一个`class`属性并使用它来获取表单。例如

HTML：

```
<form class="my_forms">
... 
```

查询：

```
var forms = $(".my_forms"); 
```

# c++ - C++访问容器类方法

> ID：13261656
> 
> 赞同：1
> 
> 时间：2012-11-07T00:39:40.617
> 
> 标签：c++

我正在学习 C++ 继承，并且正在尝试访问容器类方法。

我有一个**Environment**类，它有一个名为**drawText()**的公共方法。

**Environment**类里面有一个 Robot 类**机器人**：

```
robot = new Robot; 
```

如何从**Robot类中调用****drawText()**？

 **先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T01:00:19.217

您可以添加 Robot.h 环境参考

```
//robot.h    
namespace envrNamespace    
{    
   class Environment;
};

namespace rbtNamespace
{
class Robot
{
    Environment* _parent;
    void setParent(Environment* _env) {_parent = _env;};
    Environment* getParent() {return _parent;};
    //...
}    
};

//Environment.cpp
Robot* robot = new Robot();
robot->setParent(this); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T01:00:43.643

这就是你需要的：

```
class Environment {
public:
  Environment() { }
  ~Environment() { }

  setRobot(Robot* robot) {
    robot_ = robot;
  }
  drawTest() { }

private:
  Robot* robot_;
};

class Robot {
public:
  Robot(Environment* env) {
    env_ = env;
  }

  void foo() {
    env_.drawTest();
  }

private:
  Environment* env_;
}; 
```**

# grails - gorm投影和元信息丢失

> ID：13261658
> 
> 赞同：8
> 
> 时间：2012-11-07T00:40:16.733
> 
> 标签：grails, grails-orm, nhibernate-projections, createcriteria

在属性上使用投影时，结果以列表的形式返回，其中元素的顺序与投影块中定义的顺序相同。同时，列表中缺少属性名称，这对开发人员来说确实是不利的，因为结果将被传递，调用者需要知道哪个值属于哪个属性。有没有办法从 Criteria 查询中返回一个映射，其中属性名称作为值的键？

所以，下面的代码：

```
def c = Trade.createCriteria()
def remicTrades = c.list {

    projections {
        property('title', 'title')
        property('author.name', 'author')
    }
    def now = new Date()
    between('publishedDate', now-365, now)
} 
```

这将返回：

```
[['book1', 'author1']['book2', 'author2']] 
```

相反，我希望它返回：

```
[[book:'book1', author:'author1'][book:'book2', author:'author2']] 
```

我知道我可以在得到结果后以这种方式安排，但我真诚地认为标准应该使用属性别名来返回一个模仿 SQL 查询结果的映射列表，而不是一个平淡无奇的列表。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-07T00:59:04.607

重复：[带有条件的 Grails 查询：如何取回带有列的地图？](https://stackoverflow.com/questions/9184688/grails-queries-with-criteria-how-to-get-back-a-map-with-column)
以及相应的答案（和解决方案）：[https ://stackoverflow.com/a/16409512/1263227](https://stackoverflow.com/a/16409512/1263227)

使用结果转换器。

```
import org.hibernate.criterion.CriteriaSpecification

Trade.withCriteria {
  resultTransformer(CriteriaSpecification.ALIAS_TO_ENTITY_MAP)
  projections {
    property('title', 'title')
    property('author.name', 'author')
  }
  def now = new Date()
  between('publishedDate', now-365, now)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T05:49:53.533

同意您的问题推理，这确实应该是核心 GORM 解决方案的一部分。也就是说，这是我的解决方法；

```
def props = ['name','phone']
def query = Person.where {}.projections {
        props.each{
                property(it)
        }

}
def people = query.list().collect{ row->
        def cols = [:]
        row.eachWithIndex{colVal, ind->
            cols[props[ind]] = colVal
        }
        cols
}
println people // shows [['name':'John','phone':'5551212'],['name':'Magdalena','phone':'5552423']] 
```

# facebook - “喜欢”按钮喜欢我的旧版本网址

> ID：13261659
> 
> 赞同：1
> 
> 时间：2012-11-07T00:40:18.760
> 
> 标签：facebook, url, facebook-like

我网站的 URL 最近被重定向到另一个恰好拥有自己 Facebook 个人资料的网站。我刚刚将一个网站上传到该 URL，因此停止了重定向。

我在这个网站上放置了一个“喜欢”按钮，但它喜欢的是我的 URL 曾经重定向到的网站，而不是我的实际 URL。

任何人都知道我怎样才能让它喜欢我的网址？

该代码肯定包含我的 URL 而不是另一个，我已经清除了我的缓存等等，我已经用不同的方法重新上传了几次“赞”按钮，但都无济于事。

如果有人愿意提供帮助，将不胜感激，谢谢。

# binaryreader - Visual Basic.NET "输出字符缓冲区太小，无法包含解码字符，编码'Unicode (UTF-8)' fallback '系统

> ID：13261660
> 
> 赞同：3
> 
> 时间：2012-11-07T00:40:25.083
> 
> 标签：binaryreader

我正在尝试读取一个二进制文件，其中我一直在使用`BinaryWriter`对象附加数据。我不断收到此错误：

> “输出字符缓冲区太小，无法包含解码字符，编码 'Unicode (UTF-8)' fallback 'System.Text.DecoderReplacementFallback'。”

我的文件有`|`我怀疑是问题的字符，但我不知道如何解决它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-29T12:58:55.003

最可能的原因是您的文件在您尝试读取 UTF-8 字符的位置包含一些不代表有效 UTF-8 代码点的二进制数据。

如果您的读取算法与您的写入算法失去“同步”并尝试从错误的位置读取字符，则可能会发生这种情况，其中写入了其他内容（不是字符）。

# javascript - 添加一个单独的类以使用 jquery 列出父项？

> ID：13261665
> 
> 赞同：0
> 
> 时间：2012-11-07T00:41:46.017
> 
> 标签：javascript, jquery, jquery-selectors

我有一个不同深度的列表：

```
<ul id="top-level" class="top-level">
  <li>Item 1</li>
  <li>Item 2
    <ul class="sub-menu">
      <li>Sub item 1</li>
      <li>Sub item 2</li>
      <li>Sub item 3
        <ul class="sub-menu">
          <li>Subsub item 1</li>
          <li>Subsub item 2</li>
        </ul>
      </li>
      <li>Sub item 4</li>
    </ul>
  </li>
  <li>Item 3</li>
</ul> 
```

我正在使用以下 jquery 脚本向父母添加一个类：

```
$("ul li ul").parent().addClass("menuparent"); 
```

有没有办法将此类仅添加到顶级 parent`li`和所有其他（更深的） parent 的不同类`li`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:46:30.963

只需使用`>`顶层的选择器`ul`。

根据您当前的选择器：

```
$("ul.top-level > li > ul").parent().addClass("menuparent"); 
```

或`li`仅用于：

```
$("ul.top-level > li").parent().addClass("menuparent"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:46:20.057

对于顶级`li`s

```
$("#top-level > li").addClass("menuparent"); 
```

并且对于较低级别`li`

```
$("#top-level li li").addClass("someotherclass"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T00:57:16.133

如果我理解正确，人们并没有为您找到更深层次的**父母**li 的答案，这是我的看法：

```
$("ul.top-level > li > ul").find('li > ul').parent().addClass("deeper-parent-li"); 
```

# django - 在Django的表列中获取不同的项目

> ID：13261666
> 
> 赞同：0
> 
> 时间：2012-11-07T00:41:50.193
> 
> 标签：django

我有以下模型：

```
class Part (models.Model):
adder=models.ForeignKey(User, related_name="added_models", verbose_name=_('adder'), editable=False) 
```

我正在尝试选择`adder`一个`Part`对象的所有不同的 s。为此，我尝试了：

`Part.objects.filter('adder', flat=True).distinct()`

但它并没有给我不同的价值观并重复这些`adder`价值观。

任何洞察我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T01:14:37.270

尝试这个，

User.objects.filter(id__in = Part.objects.values_list('adder', flat=True))

# magento - 使用 addText 在布局 xml 文件中的 Magento 动态文本

> ID：13261669
> 
> 赞同：0
> 
> 时间：2012-11-07T00:42:02.143
> 
> 标签：magento

我目前有这个：

```
 <block type="core/text" name="top.address" as="topAddress">
        <action method="addText"><text>PO BOX 1124, Rockdale, Sydney, NSW 2216, Australia</text></action>
    </block> 
```

但是，当我需要更新地址时，我必须在布局文件中手动进行。我想从商店配置 ( **general/store_information/address** ) 中提取地址，因此，我可以轻松地从一个位置更新网站上的任何地方。

我想它可以像这样直接在模板上完成：

```
<?php echo Mage::getStoreConfig('general/store_information/address') ?> 
```

但是我想尝试布局，可以吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-06-18T09:49:58.913

我的回答可能是过时了，但是我刚才遇到了这样的问题，我找到了另一种解决方法：

1.  在布局中，您可以指定`core/text`块并通过助手设置其文本。您可以使用任何合适的参考。

    ```
    <reference name="before_body_end">
        <block type="core/text" name="some.config">
            <action method="addText">
                <text helper="module_name/data/getSomeConfig" />
            </action>
        </block>
    </reference> 
    ```

2.  `getSomeConfig`在助手中声明函数：

    ```
    public function getSomeConfig()
    {
        return Mage::getStoreConfig('your_config_path');
    } 
    ```

通过这种方式，您甚至可以将一些动态数据传递到 javascript 代码中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T02:54:22.240

简短的回答 - 不。它没有任何功能。这并不是说它不能完成。您可以在操作标签上使用一个属性 - `ifconfig`。它会查看是否设置了系统配置标志，如果它返回 true，那么它将继续执行该操作。您可以*覆盖*或*扩展* `Mage/Core/Model/Layout.php`以添加该功能。

不过，这个问题有很多选择。

1.  您可以使用模板，就像您提到的那样。
2.  如果您想避免使用模板，您可以使用您提供的代码创建一个扩展`Mage_Core_Block_Text`并指定方法的块。`_toHtml`
3.  **最好的：**我会看到在通用模块中创建一个通用块，用于拉取系统配置请求并将它们作为文本输出。你可以让它成为一个自定义的动作/方法，或者发送一个属性值，它最终会出现在块的数据数组中，然后你可以在`_toHtml`.

# sql - 将数据从一个表插入到另一个按列排序的表

> ID：13261674
> 
> 赞同：1
> 
> 时间：2012-11-07T00:42:57.977
> 
> 标签：sql, oracle, plsql

有一个`TMP_OA_PSTN_CMP_11035`带有字段的临时表：

```
ACTION_OBJID NUMBER,
CONTRACT_OBJID NUMBER,
STATUS varchar2(40),
UPDATE_DATE DATE 
```

这包含 700 万个数据。我想创建七个不同的临时表，其中的数据来自 TMP_OA_PSTN_CMP_11035，按 action_objid 排序，每个表包含 100 万条记录。**ACTION_OBJID 列不是序列。**

我尝试使用 rownum 但输入随机数据。

对于 EG：

Temp1：包含action_objid的数据从5 ,8...到1100000（因为action_objid不是一个序列，这就是100万个数据）。同样，对于其他 6 个临时表。我正在使用oracle 10g。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:58:15.257

怎么样

```
CREATE TABLE TEMP_TABLE_1
  SELECT *
    FROM (SELECT *
            FROM TMP_OA_PSTN_CMP_11035
            WHERE ACTION_OBJID > 0
            ORDER BY ACTION_OBJID)
    WHERE ROWNUM <= 1000000 
```

然后对其他每个临时表重复上述操作，替换`WHERE ACTION_OBJID > 0`为`(SELECT MAX(ACTION_OBJID) FROM name of previous temp table)`. 所以对于 TEMP_TABLE_2 语句将是

```
CREATE TABLE TEMP_TABLE_2
  SELECT *
    FROM (SELECT *
            FROM TMP_OA_PSTN_CMP_11035
            WHERE ACTION_OBJID > (SELECT MAX(ACTION_OBJID) FROM TEMP_TABLE_1)
            ORDER BY ACTION_OBJID)
    WHERE ROWNUM <= 1000000 
```

分享和享受。

# java - 我需要帮助创建实例变量和构造函数

> ID：13261677
> 
> 赞同：2
> 
> 时间：2012-11-07T00:43:28.417
> 
> 标签：java, variables, constructor, jgrasp

对不起，我知道这个答案很明显，但我想我只是慢了。谁能给我一个实例变量和构造函数的明确定义？

实例变量：
您的类将需要一个名为 numbers 的实例变量，它是一个一维数组。数组的大小将由构造函数确定。您可能会或可能不会发现拥有其他实例变量很有用。

构造函数：
您将编写两个构造函数。一个构造函数将是没有参数的默认构造函数。它将创建一个包含 10 个 int 的数组，并将数组的每个元素设置为 42。

第二个构造函数将接受一个参数，它将是一个 int 数组。此构造函数将创建一个与参数大小相同的实例数组，然后将整数从参数复制到实例数组。

* * *

我什至不知道如何开始。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T00:47:36.873

实例成员只是属于类对象的变量，只要它不是**静态**变量！静态变量，严格来说属于类而不是对象，构造函数只是你用来创建和初始化对象的特殊方法。它也是**您班级的名称。**

所以你想要的是

```
class WhateverYourClassIs
{
   int[] members;
   public WhateverYourClassIs()//constructor. 
   {
    members = new int[10] ;
    }
   public WhateverYourClassIs(int n) //overloaded constructor.
   {
     members = new int[n] ;
   }
} 
```

正如你在上面的例子中看到的，像方法这样的构造函数可以被重载。重载意味着签名不同。一个构造函数不带参数，另一个只带一个 int 参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T00:45:51.787

构造函数是生成该类*实例*的类的一部分。它与类命名相同，并且没有返回类型。例如：

```
public class Foo{
  public Foo(){
      System.out.println("Hi from the constructor!!");
   }
} 
```

实例字段是类的每个实例的局部变量。您可以拥有公共、受保护或私有实例字段。私有实例字段对外界“隐藏”，只有实例本身可以访问它。使用`.`运营商访问公共的。例如：

公共类 Foo{ 公共 int x; 私人int y；}

```
Foo foo = new Foo(); //Thats a call to the constructor Foo()
foo.x = 1;
foo.y; //Error can't access private variables from outside the class 
```

对于你的情况，你会想要

```
class Name{
   int[] numbers;
   public Name(){
      numbers = new int[10];
   }
   public Name(int n){
      numbers = new int[n];
   }
} 
```

在这里，您重载构造函数（就像方法一样）并创建一个数组，在这种情况下，它是`int`一个固定长度的 s 的列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T01:05:47.893

```
public class MyClass{
    int numbers[];
    MyClass(){
        numbers = new int[10];
        for (int i = 0; i < numbers.length; i++) {
                numbers[i] = 42;
        }
    }
    MyClass(int[] array){
        numbers = new int[array.length];
        for (int i = 0; i < array.length; i++) {
            numbers[i] = array[i];
        }
    }
} 
```

# jquery-mobile - 使用 twitter bootstrap 获得双范围滑块

> ID：13261679
> 
> 赞同：2
> 
> 时间：2012-11-07T00:43:51.360
> 
> 标签：jquery-mobile, twitter-bootstrap

我想使用这个升级的 jQuery Mobile 双范围滑块。
[jQuery Mobile 双范围滑块工作但有问题](https://stackoverflow.com/questions/9237191/jquery-mobile-dual-range-slider-working-but-buggy/13259790#13259790)

我需要将它与 twitter 引导程序一起使用。然而，jQuery Mobile 不能很好地配合 Twitter 引导程序，并且当 javaScript 文件放置在页面底部时（根据 yslow）正在杀死下拉菜单。这里有 3 个 jsbin 示例来说明问题：

添加 jQuery Mobile 后，twitter 引导菜单失败：http: [//jsbin.com/ibecox/1](http://jsbin.com/ibecox/1)

没有 jQuery Mobile .js 文件，twitter 引导菜单工作正常：http: [//jsbin.com/ibecox/2](http://jsbin.com/ibecox/2)

标题中包含所有 javaScript（不好的做法），菜单也可以工作，但我需要避免将所有 javaScript 放在标题中：http: [//jsbin.com/ibecox/3](http://jsbin.com/ibecox/3)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:53:03.423

我可以看到 twitter bootstrap js 的链接断开了，我已经修复了它，你的示例对我来说很好，下拉菜单和进度条

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-11T20:24:41.043

如果您想要做的只是让 jquerymobile 的[Range Slider](https://api.jquerymobile.com/rangeslider/#entry-examples)与 Bootstrap 一起工作，您可以使用[自定义下载工具](http://jquerymobile.com/download-builder/)来下载（某种程度上）使 Range Slider 工作的切片。

不幸的是，你得到的是不完整的，最重要的是它不会自初始化，所以你需要手动完成：

```
$('div[data-role=rangeslider]').rangeslider(); 
```

而且您需要应用自己的一些样式来弥补自定义下载中遗漏的过多内容。但是你会在不破坏 Bootstrap 的情况下获得 Range Sliders。

当您使用所有 jquery mobile 时，Bootstrap 中断的原因更为复杂。Init 模块在你的代码中应用了大量的类，特别是 .ui-btn 到按钮。这是导致 Bootstrap 崩溃的主要原因——导航菜单使用了一个按钮标签，该标签应用了有问题的类，然后是来自 jquerymobile 的所有问题样式。

解决这个问题的更巧妙的方法是只使用没有 Init 模块的 jquerymobile，然后只初始化你需要的东西——希望它们的按钮不是其中之一。解决它的最佳方法是非常激烈：改进 jquerymobile，以便永远不会与 Bootstrap 发生冲突，或者，某种特殊的 noBSconflict() 方法或您可以运行的东西，以避免应用会破坏 Bootstrap 的类，但否则会正常进行.

# asp.net - 使用实体框架插入记录（数据库优先）

> ID：13261680
> 
> 赞同：2
> 
> 时间：2012-11-07T00:44:37.303
> 
> 标签：asp.net, entity-framework, linq-to-sql, linq-to-entities, entity-relationship

有 3 个数据库表（电影、评论、用户）

评论表包括（MemeberID、MovieID、评论文本、Rate、ReviewDate）（评论中的 MemeberID 和 MovieID 是成员表和电影表的 FK）电影可以有很多评论，我正在尝试为电影添加评论

即使我有电影类和会员类，我也有问题，为了插入评论，我需要将其引用给电影和用户，链接它们，我不知道该怎么做

**此代码出错：**

```
" The relationship between the two objects cannot be defined because they are attached to different ObjectContext objects. " 
```

这是我的代码...

```
public bool InsertNewReview(Movie _TheMovie, Member _TheMember, string _Text, byte _Rate, DateTime _ReviewDate)
    {

       Review ReviewToInsert = new Review()
            {
                MovieID = _TheMovie.MovieID,
                MemberID = _TheMember.MemberID,
                Movie = _TheMovie,
                Member =  _TheMember,
                Rate = _Rate,
                ReviewDate = _ReviewDate,
                ReviewText = _Text
            };

        videoLib.Reviews.AddObject(ReviewToInsert);
        videoLib.SaveChanges();

            return true;

    } 
```

..

**有更多数据要插入 Review 类**

图片：[这里](http://www.gamesff.com/1.png)

..

**和表：（** “所有列”不是数据库表中的字段）

图片：[这里](http://www.gamesff.com/2.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T09:15:51.263

我有一个解决方案，我只需要定义 MovieID、MemberID，而不是使用它们的对象

并使用 try & catch 来检测同一行中是否有相同的 MovieID (fk) 和 MemberID (fk)（因为评论在数据库中没有自己的 id）

```
 public bool InsertNewReview(string _MovieID, int _MemberID, string _Text, byte _Rate, DateTime _ReviewDate)
    {
        try
        {
            Review ReviewToInsert = new Review()
            {
                Rate = _Rate,
                ReviewDate = _ReviewDate,
                ReviewText = _Text,
                MovieID = _MovieID,
                MemberID = _MemberID
            };

            videoLib.Reviews.AddObject(ReviewToInsert);
            videoLib.SaveChanges();
            return true;
        }

        catch
        {
            return false;
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T07:36:13.770

你能这样试试吗

```
Review ReviewToInsert = videoLib.Reviews.CreateObject();
ReviewToInsert.MovieID = _TheMovie.MovieID
...
...
videoLib.Reviews.AddObject(ReviewToInsert);
videoLib.SaveChanges(); 
```

# json - 在 Grails 中，我怎样才能用前导零作为小数来啜饮一个数字

> ID：13261685
> 
> 赞同：1
> 
> 时间：2012-11-07T00:45:29.730
> 
> 标签：json, grails

```
String number = "{'number':000645}"
net.sf.json.groovy.JsonSlurper slurper = new net.sf.json.groovy.JsonSlurper()
def resource = slurper.parseText(number)
System.out.println(resource.number) 
```

上面代码的结果是 421 而不是 645。我知道这个数字被解释为八进制。无论如何指定忽略前导零并将其解释为小数？

我可以有一个预处理步骤，在将前导零传递给 slurper 之前删除它，但想看看是否有更优雅的解决方案。

我正在使用 grails 1.3.7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T00:59:57.953

传递引用的数字。您所看到的是 groovy 将该值强制为 String 值的行为。

展示，尝试

```
String number = "000645" 
```

对比

```
String number = 000645 
```

在常规控制台中。（你的 slurper 的来源在这里，如果你想追踪发生了什么：[http ://grepcode.com/file/repo1.maven.org/maven2/net.sf.json-lib/json-lib/2.4 /net/sf/json/groovy/JsonSlurper.java](http://grepcode.com/file/repo1.maven.org/maven2/net.sf.json-lib/json-lib/2.4/net/sf/json/groovy/JsonSlurper.java) )

# resharper - Resharper 无法访问的代码错误

> ID：13261687
> 
> 赞同：0
> 
> 时间：2012-11-07T00:45:38.937
> 
> 标签：resharper

我已经读过这个错误，但那是 3 年前的事了！ReSharper 说内部 if 语句代码无法访问。这个错误有补丁吗？

```
int[] t = new int[1000];
if(t!=null)
{
     if(t[0] ==2)
     {

     }   
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T00:51:57.910

从您发布的代码来看，内部`if`语句确实无法访问，因为外部语句`if`总是计算为`false`（`t`总是`null`）。

# objective-c - 指向父类的指针 - 防止警告消息

> ID：13261689
> 
> 赞同：1
> 
> 时间：2012-11-07T00:45:52.600
> 
> 标签：objective-c, pointers, methods

我有一个由父类的实例创建的类实例。创建子类时，它会被赋予一个指向父类的指针，这样我就可以从子类在父类上启动一个实例方法（*myMethod*）。

我的父类是一个 UIViewController，称为*myViewController*。但是，XCode 给了我一个警告，说“UIViewController 可能无法响应 myMethod”。

导致错误的行（在子类中）如下所示：

```
[self.parent myMethod]; 
```

尽管这可以通过并且工作正常，但我想阻止警告消息。我可以做些什么来向 XCode 保证没有问题，并且“self.parent”（这是一个 UIViewController）*会*响应“myMethod”吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:28:47.040

用正确的类声明指针，而不仅仅是 UIViewController。

为避免循环声明，请使用`@class MyOwningViewController;`. 例如，MyContainedViewController.h：

```
@class MyOwningViewController;
@interface MyContainedViewController {
    MyOwningViewController* owningViewController;
}
@property (weak, nonatomic) MyOwningViewController* owningViewController;
@end; 
```

但是在 MyContainedViewController.m 中包含通常的 MyOwningViewController.h（除了可能在 MyOwningViewController.m 中包含 MyContainedViewController.h）。

MyOwningViewController.h：

```
#import "MyContainedViewConroller.h"  // Though you could use @class here as well
@interface MyOwningViewController {
    MyContainedViewController* containedViewController;  
}
@property (strong, nonatomic)  MyContainedViewController* containedViewController;
-(void) myMethod;
@end; 
```

最后，在 MyContainedViewController.m 中：

```
#import "MyOwningViewController.h"

...

-(void) doSomething {
   [owningViewController myMethod];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:50:53.573

你可以对它进行类型转换：

```
myViewController * p = (myViewController*)self.parent;
assert([p isKindOfClass:[myViewController class]]);
[p myMethod]; 
```

…虽然设计通常是一种气味。

# python - 了解多索引

> ID：13261691
> 
> 赞同：4
> 
> 时间：2012-11-07T00:46:05.977
> 
> 标签：python, pandas

所以我在csv中有一个这样的样本数据集： -

```
name    team    date       score
John    A   3/9/12      100
John    B   3/9/12      99
Jane    B   4/9/12      102
Peter   A   9/9/12      103
Josie   C   11/9/12     111
Rachel  A   30/10/12    98
Kate    B   31/10/12    103
David   C   1/11/12     104 
```

执行以下操作：-

```
from pandas.io.parsers import read_csv

df = read_csv("data/Workbook1.csv", index_col=["team", "name"])

df

                 date  score
team name                   
A    John      3/9/12    100
B    John      3/9/12     99
     Jane      4/9/12    102
A    Peter     9/9/12    103
C    Josie    11/9/12    111
A    Rachel  30/10/12     98
B    Kate    31/10/12    103
C    David    1/11/12    104 
```

如何进一步压缩第一个索引（“团队”）以使我没有重复值？成为：-

```
 date  score
team name                   
A    John      3/9/12    100
     Peter     9/9/12    103
     Rachel  30/10/12     98
B    John      3/9/12     99
     Jane      4/9/12    102
     Kate    31/10/12    103
C    Josie    11/9/12    111
     David    1/11/12    104 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T01:08:22.333

我自己想通了。

```
df = read_csv("data/Workbook1.csv")

df

     name team      date  score
0    John    A    3/9/12    100
1    John    B    3/9/12     99
2    Jane    B    4/9/12    102
3   Peter    A    9/9/12    103
4   Josie    C   11/9/12    111
5  Rachel    A  30/10/12     98
6    Kate    B  31/10/12    103
7   David    C   1/11/12    104

df2 = df.pivot('team', 'name').stack()

df2

                 date  score
team name                   
A    John      3/9/12    100
     Peter     9/9/12    103
     Rachel  30/10/12     98
B    Jane      4/9/12    102
     John      3/9/12     99
     Kate    31/10/12    103
C    David    1/11/12    104
     Josie    11/9/12    111 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-23T21:59:25.563

作为替代解决方案，如果 - 无论出于何种原因 - 您想在 read_csv 语句中保留多索引。

相同的数据集。

```
df = pd.read_csv("Workbook1.csv", index_col=["team", "name"])
df.stack().unstack()

        date    score
team    name        
A   John    3/9/2012    100
    Peter   9/9/2012    103
    Rachel  30/10/12    98
B   Jane    4/9/2012    102
    John    3/9/2012    99
    Kate    31/10/12    103
C   David   1/11/2012   104
    Josie   11/9/2012   111 
```

# monodevelop - MonoDevelop：重置 C# 代码格式

> ID：13261693
> 
> 赞同：0
> 
> 时间：2012-11-07T00:46:22.220
> 
> 标签：monodevelop

当我要求进行代码清理 (CTRL+SHIFT+F) 时，我的项目（许多）的格式有些奇怪

有没有办法清除所有项目偏好，建立一个全局偏好，并且适用于任何地方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T01:53:15.140

格式化策略不是全局的，它们是每个解决方案的。全局首选项仅用于新的解决方案或不知何故没有格式化策略的解决方案（例如由 Visual Studio 创建）。

如果需要，您可以使用“自定义策略”对话框创建新的命名策略集，并将其应用于现有解决方案。

# citrix - Citrix 远程断开/远程断开源

> ID：13261699
> 
> 赞同：0
> 
> 时间：2012-11-07T00:46:59.513
> 
> 标签：citrix, xenapp, terminal-services

考虑托管已发布应用程序的 xen 应用程序服务器。是否可以查明远程断开是否是由 citrix 或其他来源触发的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T01:01:38.427

如果 Citrix 断开连接，则通常是因为空闲超时，如果是这种情况，则 Windows 事件中将出现一个事件，说明会话由于空闲超时而断开连接

# sql - 在使用 PredicateBuilder 时需要帮助

> ID：13261700
> 
> 赞同：6
> 
> 时间：2012-11-07T00:47:04.737
> 
> 标签：sql, linq, predicatebuilder

我需要了解如何使用`PredicateBuilder`. 在几乎每个如何使用它的示例中，他们显示的代码如下：

```
var predicate = PredicateBuilder.True<employee>();

if (!string.IsNullOrEmpty(txtAddress.Text))
   predicate = predicate.And(e1 => e1.Address.Contains(txtAddress.Text));
if (!string.IsNullOrEmpty(txtEmpId.Text))
    predicate = predicate.And(e1 => e1.Id == Convert.ToInt32(txtEmpId.Text));
if (!string.IsNullOrEmpty(txtDesc.Text))
    predicate = predicate.And(e1 => e1.Desc.Contains(txtDesc.Text));
if (!string.IsNullOrEmpty(txtName.Text))
    predicate = predicate.And(e1 => e1.Name.Contains(txtName.Text));

EmployeeDataContext edb= new EmployeeDataContext();
var emp = edb.Employees.Where(predicate);
grdEmployee.DataSource = emp.ToList();
grdEmployee.DataBind(); 
```

那个`Employee`对象是什么，大于和小于括号之间的那个？我已经为此绞尽脑汁了。我正在使用 Linq to SQL 实体，当我自己尝试此操作时出现编译错误。我认为错误是这样的：

> *“不能从 Linq 表投射到……”*

我是初学者。请原谅我问什么可能是显而易见的事情。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T04:07:09.817

正如@MatsRietdijk 在评论部分所述，这是使用的泛型。基本上，使用泛型，您可以创建一个方法，该方法将对未知的类型/类（在本例中为“员工”）进行操作（尽管您可以使用[`where`语句](http://msdn.microsoft.com/en-us/library/6b0scde8.aspx)来控制它）。

如果您要更改`employee`某个其他类型的类型（例如`customer`），那么[lambda 表达式](http://msdn.microsoft.com/en-us/library/bb397687.aspx)中可用的属性也会有所不同，具体取决于公开公开的任何属性。例如：

```
var predicate = PredicateBuilder.True<customer>();

// There is no "CustomerName" property from employee, but there is for customer objects
if (!string.IsNullOrEmpty(txtName.Text))
    predicate = predicate.And(e1 => e1.CustomerName.Contains(txtName.Text)); 
```

# database - Spring AOP - 数据库审计

> ID：13261702
> 
> 赞同：0
> 
> 时间：2012-11-07T00:47:21.303
> 
> 标签：database, spring, aop, audit

我正在使用 Spring AOP 尝试定义一种很好的方法来轻松审核我的所有表。场景示例：我有一个名为 Person 的表及其各自的表 PersonLog，除了每次更新的修改用户、时间和事件类型之外，它还将存储 Person 值。

简单地说，我的问题是：

我试图想出一种方法，让我的建议类足够聪明，可以处理任何正在审核的新表，而无需对其进行任何必要的修改……假设我创建了表 Car 及其 CarLog 表，如果可以的话避免在我的建议实现中更改任何内容（它会自动将 Car 识别为被审计并能够持久化 CarLog 实体）---> 我可以很容易地将表 Car 识别为被审计（通过注释），但我' 正在努力寻找一种方法来动态创建和持久化 CarLog 实例。

谁能想到一种方法来实现这一点？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T00:50:59.300

这称为[“变更数据捕获”](http://en.wikipedia.org/wiki/Change_data_capture)或 CDC。

就个人而言，我不认为这对 Spring 或 AOP 有很好的用途。我认为最好在数据库本身中完成，特别是如果数据库由多个应用程序共享/修改。

您没有说您使用的是哪个数据库，但我建议您深入研究供应商的文档以了解他们开箱即用的内容来支持 CDC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T05:18:48.467

我在项目中有类似的要求，我想在保存之前拍摄复杂对象图的快照。

我应用的解决方案是 1) 开发了具有某些属性的自定义注释 @Archivable，如 nullify、ignore、orignal、setArchiveFlag

2) 编写了 hiberante 深度克隆实用程序，它创建对象的副本并插入到同一个表中。深度克隆器适用于简单的技巧 searlize 然后反序列化对象，这将创建新实例，然后将 id 和 version 设置为 null。

3）在实体拦截器中使用克隆器实用程序来决定天气是否存档。

下面是其中的一些代码。

```
@Retention(RetentionPolicy.RUNTIME)
@Target( { ElementType.TYPE })
public @interface Archivable {

/** This will mark property as null in clone */
public String[] nullify() default {};

/**
 * If property is archivable but not from enclosing entity then specify as
 * ignore.
 */
public String[] ignore() default {};

/**
 * sets original reference to clone for back refer data. This annotation is
 * applicable to only root entity from where archiving started.
 * 
 * @return
 */
public String original() default "";

/**
 * if marks cloned entity to archived, assumes flag to be "isArchived". 
 * @return
 */
public boolean setArchiveFlag() default false;
}

@Component
public class ClonerUtils {

private static final String IS_ARCHIVED = "isArchived";
@Autowired
private SessionFactory sessionFactory;

public Object copyAndSave(Serializable obj) throws Exception {
    List<BaseEntity> entities = new ArrayList<BaseEntity>();
    Object clone=this.copy(obj,entities);
    this.save(clone, entities);
    return clone;
}

public Object copy(Serializable obj,List<BaseEntity> entities) throws Exception{
    recursiveInitliaze(obj);
    Object clone = SerializationHelper.clone(obj);
    prepareHibernateObject(clone, entities);
    if(!getOriginal(obj).equals("")){
        PropertyUtils.setSimpleProperty(clone, getOriginal(obj), obj);
    }
    return clone;
}

private void save(Object obj,List<BaseEntity> entities){
    for (BaseEntity baseEntity : entities) {
        sessionFactory.getCurrentSession().save(baseEntity);
    }
}

@SuppressWarnings("unchecked")
public void recursiveInitliaze(Object obj) throws Exception {
    if (!isArchivable(obj)) {
        return;
    }
    if(!Hibernate.isInitialized(obj))
        Hibernate.initialize(obj);
    PropertyDescriptor[] properties = PropertyUtils.getPropertyDescriptors(obj);
    for (PropertyDescriptor propertyDescriptor : properties) {
        Object origProp = PropertyUtils.getProperty(obj, propertyDescriptor.getName());
        if (origProp != null && isArchivable(origProp) && !isIgnore(propertyDescriptor, obj)) {
            this.recursiveInitliaze(origProp);
        }
        if (origProp instanceof Collection && origProp != null) {               
            for (Object item : (Collection) origProp) {
                this.recursiveInitliaze(item);
            }
        }
    }
}

@SuppressWarnings("unchecked")
private void prepareHibernateObject(Object obj, List entities) throws Exception {
    if (!isArchivable(obj)) {
        return;
    }
    if (obj instanceof BaseEntity) {
        ((BaseEntity) obj).setId(null);
        ((BaseEntity) obj).setVersion(null);
        if(hasArchiveFlag(obj)){
            PropertyUtils.setSimpleProperty(obj, IS_ARCHIVED, true);
        }
        entities.add(obj);
    }
    String[] nullifyList = getNullifyList(obj);
    for (String prop : nullifyList) {
        PropertyUtils.setProperty(obj, prop, null);
    }
    PropertyDescriptor[] properties = PropertyUtils.getPropertyDescriptors(obj);
    for (PropertyDescriptor propertyDescriptor : properties) {
        if (isIgnore(propertyDescriptor, obj)) {
            continue;
        }
        Object origProp = PropertyUtils.getProperty(obj, propertyDescriptor.getName());         
        if (origProp != null && isArchivable(origProp)) {
            this.prepareHibernateObject(origProp, entities);
        }   
        /**  This code is for element collection */
        if(origProp instanceof PersistentBag){
            Collection elemColl=createNewCollection(origProp);
            PersistentBag pColl=(PersistentBag) origProp;
            elemColl.addAll(pColl.subList(0, pColl.size()));
            PropertyUtils.setSimpleProperty(obj, propertyDescriptor.getName(), elemColl);
            continue;
        }
        if (origProp instanceof Collection && origProp != null) {
            Collection newCollection  = createNewCollection(origProp);
            PropertyUtils.setSimpleProperty(obj, propertyDescriptor.getName(),    newCollection);
            for (Object item : (Collection) origProp) {
                this.prepareHibernateObject(item, entities);
            }
        }
    }
}

@SuppressWarnings("unchecked")
private Collection createNewCollection(Object origProp) {
    try {
        if(List.class.isAssignableFrom(origProp.getClass()))
            return new ArrayList((Collection)origProp);
        else if(Set.class.isAssignableFrom(origProp.getClass()))
                return new HashSet((Collection)origProp);
        else{
            Collection tempColl=(Collection) BeanUtils.cloneBean(origProp);
            tempColl.clear();
            return tempColl;
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
    return new ArrayList();     
}

private boolean isIgnore(PropertyDescriptor propertyDescriptor,Object obj){
    String propertyName=propertyDescriptor.getName();
    String[] ignores=getIgnoreValue(obj);
    return ArrayUtils.contains(ignores, propertyName);
}

private String[] getIgnoreValue(Object obj) {
    String[] ignore=obj.getClass().getAnnotation(Archivable.class).ignore();
    return ignore==null?new String[]{}:ignore;
}

private String[] getNullifyList(Object obj) {
    String[] nullify=obj.getClass().getAnnotation(Archivable.class).nullify();
    return nullify==null?new String[]{}:nullify;
}

public boolean isArchivable(Object obj) {
    return obj.getClass().isAnnotationPresent(Archivable.class);
}

private String getOriginal(Object obj) {
    String original=obj.getClass().getAnnotation(Archivable.class).original();
    return original==null?"":original;
}

private boolean hasArchiveFlag(Object obj) {        
    return obj.getClass().getAnnotation(Archivable.class).setArchiveFlag();
}

@SuppressWarnings({ "unchecked", "unused" })
private Collection getElemColl(Object obj, Object origProp) {
    Collection elemColl=createNewCollection(origProp);
    for (Object object : (Collection)origProp) {
        elemColl.add(object);
    }
    return elemColl;
}

@SuppressWarnings("unused")
private boolean isElementCollection(Object obj, String name) {
    try {
        Annotation[] annotations=obj.getClass().getDeclaredField(name).getAnnotations();
        for (Annotation annotation : annotations) {
            if(annotation.annotationType() == ElementCollection.class)
                return true;
        }
    } catch (Exception e) {
        e.printStackTrace();            
    }
    return false;
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T01:29:02.210

Envers 是您出于审计目的而需要的

# parsing - 用简单的语言语法定义函数签名

> ID：13261710
> 
> 赞同：0
> 
> 时间：2012-11-07T00:48:22.323
> 
> 标签：parsing, compiler-construction, syntax, bnf, irony

我目前正在学习如何使用[Irony](http://irony.codeplex.com/)创建简单的表达语言。我在找出定义函数签名的最佳方法以及确定验证这些函数输入的责任时遇到了一些麻烦。

到目前为止，我有一个简单的语法来定义我的语言的基本元素。这包括一些二元运算符、括号、数字、标识符和函数调用。我的语法的 BNF 看起来像这样：

```
<expression> ::= <number> | <parenexp> | <binexp> | <fncall> | <identifier>
<parenexp>   ::= ( <expression> )
<fncall>     ::= <identifier> ( <argumentlist> )
<binexp>     ::= <expression> <binop> <expression>
<binop>      ::= + - * / %
... the rest of the grammar definition 
```

使用 Irony 解析器，我能够验证各种输入字符串的语法，以确保它们符合以下语法：

```
x + y / z * AVG(a + b, p)   -> Valid Syntax
x +/ AVG(x                  -> Invalid Syntax 
```

这一切都很好，但现在我想更进一步，定义可用的函数，以及每个函数所需的参数数量。因此，例如，我想要一个`FOO`接受一个参数并`BAR`接受两个参数的函数：

```
FOO(a + b) * BAR(x + y, p + q)    -> Valid
FOO(a + b, 13)                    ->  Invalid 
```

解析第二条语句时，我希望能够输出一条错误消息，该消息知道此函数的预期输入：

```
Too many arguments specified for function 'FOO' 
```

我实际上不需要评估任何这些语句，只需验证语句的语法并确定它们是否是有效的表达式。

我到底应该怎么做？我知道从技术上讲，我可以像这样简单地将函数添加到语法中：

```
<foofncall> ::= FOO( <expression> )
<barfncall> ::= BAR( <expression>, <expression> ) 
```

但是这方面的某些事情感觉不太对劲。在我看来，语法似乎应该只定义一个通用函数调用，而不是该语言可用的每个函数。

*   这通常在其他语言中是如何实现的？
*   哪些组件应该负责分析语言语法的基本语法与函数定义等更具体的元素？这两个职责应该由同一个组件处理吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T01:08:54.557

虽然您可以直接在语法中进行类型检查，以便在解析器中强制执行，但这样做通常是个坏主意。相反，解析器应该只解析基本语法，并且应该使用单独的类型检查代码进行类型检查。

在编译器的正常情况下，解析器只生成抽象语法树或程序的某种等效表示。然后，在 AST 上运行类型检查传递，以确保所有类型正确匹配——确保函数具有正确数量的参数并且这些参数具有正确的类型，以及确保变量具有分配给的正确类型它们以及它们的使用方式。

除了通常更简单之外，这通常可以让您提供更好的错误消息——而不仅仅是“无效”，您可以说“FOO 的参数太多”或者你有什么。

# android - Android分享内容只能准备好了吗？

> ID：13261711
> 
> 赞同：0
> 
> 时间：2012-11-07T00:48:22.643
> 
> 标签：android, android-intent, share

我想知道我是否可以在不允许用户更改文本的情况下分享内容。

例如：

```
Intent sendIntent = new Intent();
sendIntent.setAction(Intent.ACTION_SEND);
sendIntent.putExtra(Intent.EXTRA_TEXT, "This is my text to send.");
sendIntent.setType("text/plain");
startActivity(sendIntent); 
```

用户无法更改“这是我要发送的文本”。也不能添加或删除文本。这是可能的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T01:13:30.020

> 这是可能的？

不，不使用您显示的代码。

`startActivity(...)`与`Intent`which uses一起使用`ACTION_SEND`只会导致操作系统找到一个能够发送您传递给它的类型的数据的外部（第 3 方）应用程序。应用程序启动后，它的行为方式与用户手动启动它的方式完全相同。

你可以做你想做的唯一方法是，如果你编写自己的代码来使用你想要发送的任何协议（SMTP、SMS、HTTP 等）发送文本。

# c - 我似乎无法弄清楚如何使用纯指针表示法正确传递参数

> ID：13261712
> 
> 赞同：0
> 
> 时间：2012-11-07T00:48:32.020
> 
> 标签：c, pointers, parameter-passing, notation

我正在尝试修改我以前使用纯指针表示法编写的程序。它是一个生成40个大写字母的随机字符串，最多输入20个大写字母和一个字符的程序。程序用输入的字符替换生成的字符串中重复出现的字符。现在，我正在尝试传递随机生成的字符串的参数，以便我可以在第二个函数中访问它们，但不知道该怎么做。

感谢您的帮助。

```
#include <stdio.h>
#include <stdlib.h>

/* Function prototypes */
void fillS1(char * x);

void fillS2(char * x, char * y, char z);

void strFilter(char * a, char * b, char c);

int main(int argc, const char * argv[])
{

char s1[41];
char s2[21];
char x = 0;

char * pointerToS1;
char * pointerToS2;

pointerToS1 = s1;
pointerToS2 = s2;

fillS2(pointerToS2, pointerToS1, x);

return 0;
}

/* Function to generate a random string of 40 uppercase letters */
void fillS1(char * randomlyGeneratedPointer)
{
char randomlyGeneratedArray[41];

randomlyGeneratedPointer = randomlyGeneratedArray;

int i;

for (i = 0; i < 40; i++) {
    *(randomlyGeneratedPointer + i) = 'A' + rand() % 26;
}

}

/* Function to get user input of characters */
void fillS2(char * userStringPointer, char * randomStringPointer, char     replacementCharacter)
{

char userstring[21];
char randomString[41];
char copyString[42];
//char * pointerToCopyString = copyString;

userStringPointer = userstring;

int i = 0;
int n = 0;
int lowercaseCheck = 0;

char loopContinue = 0;

fillS1(randomStringPointer);  //here is the function call for the randomly generated       string.

printf("This is the random string: %s", randomStringPointer);

do {

    /* For loop to copy the first randomly generated string */
    for(i = 0; i < 42; i++)
        *(randomStringPointer + i) = copyString[i];

    randomStringPointer = copyString;

    i = 0;
    lowercaseCheck = 0;

    /* While loop to to get user input */
    printf("Please enter at least 2 capital letters and a maximum of 20.\n");
    while  ((((*(userStringPointer + i)) = getchar()) != '\n'))  {

        /* Counter to determine how many characters were entered */
        i++;

    }

    /* Adding 1 to add to add null character */
    i++;

    *(userStringPointer + i) = '\0';

    //printf("This is the user's string %s", userStringPointer);

    /* Capital letter check */
    for (n = 0; n < 20; n++) {
        if (((*(userStringPointer + n)) >= 'a') && (*(userStringPointer + n) <= 'z')) {

            lowercaseCheck++;
        }
    }

    if (--i < 3) {
        printf("You need at least two letters\n");
    }

    else if (i > 21){
        printf("You cannot have more than twenty letters\n");
    }

    else if (lowercaseCheck == 0) {

        puts(userStringPointer);

        printf("Enter a character to replace occuring letters.\n");
        scanf("%c", &replacementCharacter);
        getchar();

        //printf("this is the copy string before strFilter: %s", randomStringPointer);
        //printf("This is the replacement character %c", replacementCharacter);

        strFilter(randomStringPointer, userStringPointer, replacementCharacter);

    }

    else

        printf("You  must have 2 capital letters.\n");

    printf("Would you like to enter another string (y/n)?\n");
    loopContinue = getchar();
    getchar();

} while (loopContinue != 'n' && loopContinue != 'N');

}

/* Function to replace letters with the character chosen by the user */
void strFilter(char * replacementCopyStringPointer, char * replacementUserStringPointer,         char c)
{

int i = 0;
int n = 0;

while (n < 20) {

    for (i = 0; i < 40; i++) {
        if ((*(replacementCopyStringPointer + i)) == *(replacementUserStringPointer + n)){
            *(replacementCopyStringPointer + i) = c;
        }
    }
    i = 0;
    n++;
}

puts(replacementCopyStringPointer);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:59:46.373

一旦 fillS1 函数返回，fillS1 中的 randomGeneratedArray 数组将被销毁。您应该从堆中为 randomGeneratedArray 分配内存。

`randomlyGeneratedArray = (char *)malloc(sizeof(char)*41)`

也对 fillS2 中的 userStringPointer 执行相同的操作。那应该可以解决问题。

对于堆栈和堆之间的区别，请阅读这个问题堆栈和堆[是什么以及在哪里？](https://stackoverflow.com/q/79923/929210)

# iphone - 如何在 UIWebView 上的 Long Tap 手势上创建 Tap 事件？

> ID：13261713
> 
> 赞同：3
> 
> 时间：2012-11-07T00:48:54.483
> 
> 标签：iphone, ios, ipad, cocoa-touch, uiwebview

我在 上添加了长按手势`UIWebView`。但我想`UIWebView`在我的 Long Tap 被识别之前处理一个标准的 Tap 事件。（Long Tap 应该处理两个手势——一个简单的 Tap 和我的 Long Tap）。这个怎么做？

我认为需要将 Tap 事件发送到`UIWebView`on `TouchBegin`。这是对的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T14:23:11.110

正确的代码：

```
- (void)viewDidLoad {
    UILongPressGestureRecognizer* gesture = [[[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(handleLongPress:)] autorelease];
    gesture.delegate = self;
    [myWebView addGestureRecognizer:gesture];
}

- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer {
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T04:45:56.320

请参考本节 UIGestureRecognizerDelegate

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIGestureRecognizerDelegate_Protocol/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIGestureRecognizerDelegate_Protocol/Reference/Reference.html)

你发现这在 2 个手势同时工作时被调用。

`gestureRecognizer:shouldRecognizeSimultaneouslyWithGestureRecognizer:`

# vb.net - VB.net 如何让流阅读器忽略某些行？

> ID：13261716
> 
> 赞同：0
> 
> 时间：2012-11-07T00:49:03.547
> 
> 标签：vb.net, string, httpwebrequest, streamreader

我正在使用流阅读器来获取某些页面的 HTML，但有些行我想忽略，例如一行以`<span>` 

有什么建议吗？这是我的功能

```
Public Function GetPageHTMLReaderNoPrx(ByVal address As Uri) As StreamReader
  Dim request As HttpWebRequest
  Dim response As HttpWebResponse = Nothing
  Dim reader As StreamReader

  Try
    request = DirectCast(WebRequest.Create(address), HttpWebRequest)
    response = DirectCast(request.GetResponse(), HttpWebResponse)

    Select Case CType(response, Net.HttpWebResponse).StatusCode
      Case 200
        reader = New StreamReader(response.GetResponseStream(), Encoding.Default)

      Case Else
        MsgBox(CType(response, Net.HttpWebResponse).StatusCode)
    End Select
  Catch
    If Not response Is Nothing Then response.Close()
  End Try
  Return reader
End Function 
```

这就是 HTML 的样子

```
<tr>Text
<span>show all</span>
</tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:39:13.617

如果你坚持使用字符串，你可以这样做：

```
Do
  Dim line As String = reader.ReadLine()
  If line Is Nothing Then Exit Do 'end of stream
  If line.StarsWith("<span>") Then Exit Do 'ignore this line
  'otherwise do some processing here
  '...
Loop 
```

但这种方法并不稳定 - 输入 HTML 中的任何微小变化都会破坏您的流程。

更优雅的解决方案是使用`XElement`：

```
Dim xml = <tr>Text
            <span>show all</span>
          </tr>
xml.<span>.Remove()
MsgBox(xml.Value.Trim) 
```

# java - 将注释作为超接口时的 @SuppressWarnings 值

> ID：13261718
> 
> 赞同：11
> 
> 时间：2012-11-07T00:49:09.747
> 
> 标签：java, annotations, suppress-warnings

我有一个实现注释的枚举，我收到警告：注释类型 A 不应用作 MyClass 的超接口。

@SuppressWarnings 是否有处理此警告的值？我不想使用@SuppressWarnings("all")，我宁愿警告而不是压制所有警告。

我正在使用 Eclipse。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T00:58:46.727

我相信没有这样的价值`@SuppressWarnings`。如果有这样的值，那么编译器会在警告的同时给你一个使用它的提示。

由于它不存在，这可能意味着让您的枚举扩展注释不是一个好主意。

如果你仍然想走那条路，那么我认为这`@SuppressWarnings("all")`是你唯一的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-20T15:19:11.617

```
@SuppressWarnings("ClassExplicitlyAnnotation") 
```

在 IntelliJ 中，您可以打开上下文菜单并选择“Suppress for class”选项。

[![在此处输入图像描述](../Images/38cac29e0e05e7706e8d78b80230d7f1.png)](https://i.stack.imgur.com/wVhGC.png)

# javascript - jQuery 文本显示有限和切换

> ID：13261725
> 
> 赞同：1
> 
> 时间：2012-11-07T00:49:51.580
> 
> 标签：javascript, jquery

我从 mysql 输出的文本内容，但我们现在可以将其视为纯文本。我想把我的话限制在 120 字以内，然后添加切换`show more`按钮。我知道切换很容易实现，但我真的不知道如何限制我的文字并自动插入显示更多切换按钮。

这是我的代码

```
<div id="paragrah">
    Donec vitae mollis leo. Quisque ut metus ac velit porttitor sollicitudin quis mattis purus. Quisque id risus id sem porta gravida eu nec neque. Praesent non odio nibh, vitae tincidunt sapien. Maecenas rutrum mollis mauris, eu condimentum nunc viverra nec. Donec fringilla imperdiet volutpat. Morbi in sem ante. Phasellus libero purus, viverra a aliquam ac, eleifend eu nisl. Etiam quis odio nec quam rhoncus iaculis ac quis velit. Sed ut lacus quis enim tempor ullamcorper. Donec odio ligula, porta et bibendum aliquam, blandit vitae lacus.
    <div class="myimage">picture</div>
    <div class="myimage">picture</div>
    <div class="myimage">picture</div>
</div> 
```

我还附上了一张图片来解释我期望实现的目标。

![在此处输入图像描述](../Images/bded3bb317fb11ea3c15a5d1bc68450d.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T01:04:49.677

试试这个片段：

```
function excerpt(str, nwords) {
  var words = str.split(' ');
  words.splice(nwords, words.length - 1);
  return words.join(' ') + '&hellip;';
} 
```

然后缓存您的原始内容`data`并创建一个按钮以在文本之间切换`data`并`excerpt`基于文本，“显示”或“隐藏”。

**演示：http:** [//jsfiddle.net/elclanrs/QLYey/](http://jsfiddle.net/elclanrs/QLYey/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T01:04:44.213

为什么要在意字数？给定数量的单词占用的区域可能会因单词的长度而有很大差异。最好的方法可能是用 CSS/javascript 来处理这个问题。

将 div 设置为固定高度并为其提供文本溢出设置（您可以为溢出定义自定义字符串）。然后通过 javascript 扩展，您可以只使用一个覆盖固定高度和文本溢出的类，为您提供完整的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T01:10:34.423

通常，您将在服务器端处理“预告片”文本的格式，您可以在服务器端使用您想要创建 HTML 的任何语言。然后客户端可以运行 JavaScript 来扩展已经隐藏在页面中的内容。jsfiddle 底部链接了一个完整的示例，其中包含多个可扩展部分。

使用 jQuery 的扩展代码：

```
$('.show-more').click(function(event) {
    $(event.target)
        .closest('.expando')
            .find('.three-dots')
                .remove()
                .end()
            .find('.rest')
                .show()
                .end()
            .end()
        .detach();
});​ 
```

jsfiddle 上的工作示例：http: [//jsfiddle.net/wJMh9/3/](http://jsfiddle.net/wJMh9/3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T01:21:14.570

你可以试试这样

```
var text=$("#paragrah").html().substring(1,200)​;
$("#paragrah").html(text + '...' );​​​​ 
```

# jquery - 何时使用 clone()

> ID：13261727
> 
> 赞同：1
> 
> 时间：2012-11-07T00:50:18.583
> 
> 标签：jquery

我需要动态地将行添加到表中。我知道我希望模型行如下所示：

```
<tr id="row">
  <td><input type="text" name="name"/></td>
  <td><span>TEXT HERE</span></td>
  <td><input type="checkbox" name="asdf"/></td>
</tr> 
```

我想知道我是否应该编写代码从头开始重现这一行，或者我是否应该使用 jQuery 的 clone() 方法，如下所示：

```
//Would document this better in production
$('#row').clone().attr('id', 'row2').insertAfter('#row'); 
```

然后确保`#row`使用 CSS 隐藏原始元素。

概括这个问题，是否会有一个隐藏的 DOM 元素，然后在需要 jQuery 的良好实践时克隆该元素？还是有针对此类问题的更清洁的解决方案？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:53:34.583

没有将格式硬编码到 JavaScript 中，这确实是最好的方法。

另一种方法是复制现有的（数据）行并从元素中删除所有文本*。*然后你得到一个没有隐形行的克隆。

还有一些插件可以处理这个问题，比如[`dynoTable`](http://www.seomoves.org/blog/web-design-development/dynotable-a-jquery-plugin-by-bob-tantlinger-2683/)和[其他](https://www.google.com/search?hl=en&q=jquery+table+row+clone+plugin)。

# javascript - javascript 不会传递 json 字符串 ~ System ArgumentException

> ID：13261729
> 
> 赞同：2
> 
> 时间：2012-11-07T00:50:27.677
> 
> 标签：javascript, silverlight

我有一个 json 字符串，我试图从我的 javascript 传递到 silverlight 命令。这是我试图运行的代码行：

```
silverlightPlugin.Content.essentialsViewer.RunCommand("findShapeInArea", "{'area':0,'shape':77}"); 
```

这在 Visual Studio 2010 中有效，但是当我将其上传到 IIS7 并进行测试时，它运行时出现此错误：

> “System.ArgumentException：无法将整数转换为字符串。在 System.Windows.Browser.ManagedObjectInfo.Invoke（ManagedObject obj，InvokeType invokeType，String memberName，ScriptParam [] args）在 System.Windows.Hosting.ManagedHost.InvokeScriptableMember（IntPtr pHandle , Int32 nMemberID, Int32 nInvokeType, Int32 nArgCount, ScriptParam[] pArgs, ScriptParam& pResult, ExceptionInfo& pExceptInfo)"

我不确定为什么它认为它正在尝试将 Integer 转换为 String。有谁知道这里发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T02:01:18.380

好的，我发现了这个问题。当像我在上面所做的那样传递一个 json 字符串时，如果参数要求一个字符串，那么 json 对象内的所有内容都必须是字符串类型，即使它已经是一个整体的字符串。所以下面的代码有效：

```
silverlightPlugin.Content.essentialsViewer.RunCommand("findShapeInArea", "{'area':'0','shape':'77'}"); 
```

# iphone - “文件未找到”

> ID：13261730
> 
> 赞同：0
> 
> 时间：2012-11-07T00:50:34.590
> 
> 标签：iphone, ios, xcode, frameworks

我想在我的 iPhone 应用程序中加入线性回归。经过一番搜索，我发现 Accelerate Framework 中的 LAPACK 和 BLAS 是正确使用的库。但是我很难将加速框架添加到我的 XCode 中。我正在使用 XCode 4.3.2 和 MAC OS X 10.7.4 当我将以下行添加到我的 XCode 中时：#include 它给了我“找不到文件”。

如果删除此行，我将无法使用 LAPACK 或 BLAS 中的任何功能。我已将框架从 /system/library/frameworks/Accelerate.framework 复制并粘贴到我的项目文件夹中。我还通过在 XCode 中控制单击我的项目并添加框架来添加它。这些似乎都不起作用，我仍然收到错误：`"file not found"`.

任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-07T00:54:31.943

您确定在构建设置中包含 iOS Accelerate Framework 吗？

我不确定 Xcode 4.3.2 中的情况如何，但目前您需要在单击项目时在“目标”部分添加框架。转到构建阶段并单击 - 'Link Binary With Libraries'。

然后简单地包括使用 —</p>

```
#import <Accelerate/Accelerate.h> 
```

# highcharts - 在Highcharts中使用百分比和绝对值对同一系列的双轴

> ID：13261736
> 
> 赞同：4
> 
> 时间：2012-11-07T00:51:06.927
> 
> 标签：highcharts

我需要使用一个系列中 Y 轴的百分比和绝对值。

highchart [http://www.highcharts.com/demo/combo-multi-axes](http://www.highcharts.com/demo/combo-multi-axes)中有一些示例，但它使用两个不同的系列。例如，我需要 Y 轴中的值直到 1000，而在另一个 Y 轴中显示项目系列的百分比。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T07:55:44.560

**[`xAxis.linkedTo`](http://api.highcharts.com/highstock#xAxis.linkedTo)**您可以使用该属性创建第二个 Y 轴并将其链接到第一个（第 0 个）轴。然后在第二个轴的标签格式化程序中，进行计算以得到百分比。

```
yAxis:[{            
    },
    {
        labels:{
            formatter:function(){
                var max=this.axis.linkedParent.dataMax,
                    min=this.axis.linkedParent.dataMin,
                    range=max-min;                       
                return ((this.value-min)/(range)*100) + ' %';
            }
        },
        linkedTo:0,
        opposite:true
    }
] 
```

**[双轴 | Highchart & Highstock @ jsFiddle](http://jsfiddle.net/jugal/JBdLw/)**

# python - 在 pandas 中附加两个多索引数据框

> ID：13261737
> 
> 赞同：3
> 
> 时间：2012-11-07T00:51:10.110
> 
> 标签：python, pandas

我正在尝试这个简单的变量设置：

```
In [94]: cc
Out[94]: 
                 d0         d1
class sample                    
5     66      0.128320  0.970817
      66      0.160488  0.969077
      77      0.919263  0.008597
6     77      0.811914  0.123960
      88      0.639887  0.262943
      88      0.312303  0.660786

In [101]: bb
Out[101]: 
                     d0         d1
class sample                    
2     22      0.730631  0.656266
      33      0.871292  0.942768
3     44      0.081831  0.714360
      55      0.600095  0.770108

In [102]: aa
Out[102]: 
                     d0         d1
class sample                    
0     00      0.190409  0.789750
      11      0.588001  0.250663
1     22      0.888343  0.428968
      33      0.185525  0.450020 
```

我可以执行以下命令

```
In [103]: aa.append(bb)
Out[103]: 
                     d0         d1
class sample                    
0     00      0.190409  0.789750
      11      0.588001  0.250663
1     22      0.888343  0.428968
      33      0.185525  0.450020
2     22      0.730631  0.656266
      33      0.871292  0.942768
3     44      0.081831  0.714360
      55      0.600095  0.770108 
```

为什么我不能以相同的方式执行以下命令？

```
aa.append(cc) 
```

[我得到以下异常]

```
ValueError: all arrays must be same length 
```

## 更新：

如果我没有提供列名，它工作正常，但如果我有 4 列，名称为 ['d0'，'d0'，'d1'，'d1'] 用于 4X4 和 8X4，它不再工作

这是重现错误的代码

```
import pandas
y1 = [['0','0','1','1'],['00','11','22','33']]
y2 = [['2','2','3','3','4','4'],['44','55','66','77','88','99']]
x1  = np.random.rand(4,4)
x2 = np.random.rand(6,4)
cols = ['d1']*2 + ['d2']*2
names = ['class','idx']
aa = pandas.DataFrame(x1,index=y1,columns = cols)
aa.index.names = names
print aa
bb = pandas.DataFrame(x2,index=y2,columns = cols)
bb.index.names = names
print bb

aa.append(bb) 
```

我应该怎么做才能让它运行？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:23:02.833

```
concatenated = pd.concat([bb, cc])

concatenated

                      0         1
class  sample                    
2      22      0.730631  0.656266
       33      0.871282  0.942768
3      44      0.081831  0.714360
       55      0.600095  0.770108
5      66      0.128320  0.970817
       66      0.160488  0.969077
       77      0.919263  0.008597
6      77      0.811914  0.123960
       88      0.639887  0.262943
       88      0.312303  0.660786 
```

**回答您编辑的问题**

因此，要回答您编辑的问题，问题在于您的列名重复。

```
 cols = ['d1']*2 + ['d2']*2  # <-- this creates ['d1', 'd1', 'd2', 'd2'] 
```

并且您的数据框最终具有被认为是重复的列，即

```
In [62]: aa
Out[62]: 
                 d1        d1        d2        d2
class idx                                        
0     00   0.805445  0.442059  0.296162  0.041271
      11   0.384600  0.723297  0.997918  0.006661
1     22   0.685997  0.794470  0.541922  0.326008
      33   0.117422  0.667745  0.662031  0.634429 
```

和

```
In [64]: bb
Out[64]: 
                 d1        d1        d2        d2
class idx                                        
2     44   0.465559  0.496039  0.044766  0.649145
      55   0.560626  0.684286  0.929473  0.607542
3     66   0.526605  0.836667  0.608098  0.159471
      77   0.216756  0.749625  0.096782  0.547273
4     88   0.619338  0.032676  0.218736  0.684045
      99   0.987934  0.349520  0.346036  0.926373 
```

`pandas.append()`（或`concat()`方法）只有在您有唯一的列名时才能正确附加。

试试这个，你不会得到任何错误：-

```
cols2 = ['d1', 'd2', 'd3', 'd4']

cc = pandas.DataFrame(x1, index=y1, columns=cols2)
cc.index.names = names

dd = pandas.DataFrame(x2, index=y2, columns=cols2)
cc.index.names = names 
```

现在...

```
In [70]: cc.append(dd)
Out[70]: 
                 d1        d2        d3        d4
class idx                                        
0     00   0.805445  0.442059  0.296162  0.041271
      11   0.384600  0.723297  0.997918  0.006661
1     22   0.685997  0.794470  0.541922  0.326008
      33   0.117422  0.667745  0.662031  0.634429
2     44   0.465559  0.496039  0.044766  0.649145
      55   0.560626  0.684286  0.929473  0.607542
3     66   0.526605  0.836667  0.608098  0.159471
      77   0.216756  0.749625  0.096782  0.547273
4     88   0.619338  0.032676  0.218736  0.684045
      99   0.987934  0.349520  0.346036  0.926373 
```

# matlab - matlab：将函数的值发送到其他函数

> ID：13261742
> 
> 赞同：0
> 
> 时间：2012-11-07T00:52:28.173
> 
> 标签：matlab, session, user-interface

我有两个 GUI-s。

第一个 GUI 被命名为：GUI1，用户在其中插入三个值。

然后用户有一个“提交”按钮，所以我希望每次按下它时将这些值发送到其他功能（GUI2）。

我的函数 GUI2.m 获得三个元素：

```
function GUI2(x,y,r)
   .
   .
   .
end 
```

这是第一个 GUI：

```
function [E] = GUI1()
    num_of_columns = 3;

    E = [];  % In case the user closes the GUI.
    S.fh = figure('units','pixels',...
          'position',[500 500 850 100],...
          'menubar','none',...
          'name','Number Of Columns',...              
          'numbertitle','off',...
          'resize','off');
    num = 0;
    for i = 1:num_of_columns
        S.ed(i) = uicontrol('style','edit',...
             'units','pix',...
            'position',[num 60 100 30],...
            'string','');
        num = num + 500/num_of_columns;
        uicontrol(S.ed(1))  % Make the editbox active.
     end

     S.pb = uicontrol('style','pushbutton',...
             'units','pix',...
            'position',[290 20 180 30],...
            'string','Submit',...
            'callback',{@pb_call});

     uiwait(S.fh)  % Prevent all other processes from starting until closed.

     function [] = pb_call(varargin)
         % Callback for the pushbutton.
         E = get(S.ed(:),'string');
         E{1} = str2num(E{1});
         E{2} = str2num(E{2});
         E{3} = str2num(E{3}); 
```

**在这一行中，我想将 E{1}、E{2} 和 E{3} 发送到 GUI2**

```
 end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T08:10:36.393

怎么样：

```
GUI2(E{1},E{2},E{3}) 
```

# numbers - 如何手动检查Prolog中的值是否为数字？

> ID：13261744
> 
> 赞同：4
> 
> 时间：2012-11-07T00:52:39.247
> 
> 标签：numbers, prolog

如何在不使用内置谓词的情况下检查给定值是否是 Prolog 中的数字`number`？

假设我有一个列表`[a, 1, 2, 3]`。我需要一种方法来检查此列表中的每个元素是否都是数字。困扰我的唯一部分问题是如何在不使用`number`谓词的情况下进行检查。

我试图弄清楚这一点的原因是我有一个大学作业，其中明确规定不要使用任何内置谓词。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T10:31:00.717

您需要一些内置谓词来解决这个问题 - 除非您明确枚举所有数字（这是不切实际的，因为它们有无限多）。

# 1

最直接的方法是：

```
maplist(number, L). 
```

或者，递归

```
allnumbers([]).
allnumbers([N|Ns]) :-
   number(N),
   allnumbers(Ns). 
```

# 2

在评论中，您说“值作为原子给出”。这可能意味着你得到 [a, '1', '2'] 或 '[a, 1, 2]`。我假设第一个。同样，您需要一个内置谓词来分析名称。依靠 ISO-Prolog 的错误，我们编写：

```
numberatom(Atom) :-
   atom_chars(Atom, Chs),
    catch(number_chars(_, Chs), error(syntax_error(_),_), false). 
```

使用`numberatom/1`代替`number/1`，所以写一个递归规则或者使用`maplist/2`

# 3

您可能想编写语法而不是`catch...`目标。最近有很多这样的定义，你可以看看[这个问题](https://stackoverflow.com/q/12939794/772868)。

# 4

如果整个“值”作为原子给出，您将再次需要，`atom_chars/2`或者您可能需要一些特定于实现的解决方案，例如`atom_to_term/3`然后应用上述解决方案之一。

# matplotlib - matplotlib 集合线宽映射？

> ID：13261751
> 
> 赞同：0
> 
> 时间：2012-11-07T00:53:23.950
> 
> 标签：matplotlib

我在道路网络等的 matplotlib 中创建了一些 GIS 样式的图，所以我使用 LineCollection 来存储和表示所有的道路和颜色。这工作正常，我根据标准和以下地图为道路着色：

```
from matplotlib.colors import ListedColormap,BoundaryNorm
from matplotlib.collections import LineCollection

cmap = ListedColormap(['grey','blue','green','yellow','orange','red','black'])
norm = BoundaryNorm([0,0.5,0.75,0.9,0.95,1.0,1.5,100],cmap.N)

roads = LineCollection(road_segments, array=ratios, cmap=cmap, norm=norm)
axes.add_collection(roads) 
```

这很好用，但是我真的很想以与颜色图类似的方式定义线宽 - 每种颜色的范围从 0.5 到 5

有谁知道这样做的聪明方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T08:41:08.360

`linewidths`关键字。

```
import matplotlib.pyplot as plt
from matplotlib.collections import LineCollection

axes = plt.axes()

roads = LineCollection([
                        [[0, 0], [1, 1]],
                        [[0, 1], [1, 0]] 
                        ], 
                       colors=['black', 'red'],
                       linewidths=[3, 8],
                       )
axes.add_collection(roads)

plt.show() 
```

高温高压

# c - 计算机如何比较十六进制和十进制值

> ID：13261753
> 
> 赞同：0
> 
> 时间：2012-11-07T00:53:35.257
> 
> 标签：c

我正在查看 C 中的现有代码，其中检查了特定范围 100 到 899 中的否。我想再添加一个条件，即 no 可以具有值 1FE。我不应该将其转换为十进制数。但我需要检查这个十六进制值。我的疑问是，硬件将如何解释十进制和十六进制的比较。硬件将解释零和一中的值。那么它会将十进制和十六进制数字转换为二进制以检查值吗？（因为1FE转换成十进制是510，会包含在899里面）。请大家帮忙理解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T00:57:19.143

`int x = 0x1fe;`并且`int x = 510;`对计算机来说是完全相同的（或者更具体地说，对编译器来说——实际的硬件永远不会看到“0x1fe”或“510”——它只会看到二进制版本）所以你的问题没有多大意义感觉。

更改基数只会更改值的表示；它不会改变实际值。如果你有 101[个 2 个]苹果，你有 5[个 10 个]苹果，你仍然有相同数量的苹果。

计算机使用的表示恰好是二进制的。（嗯，不是“恰好”是，但是....是的。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T00:56:40.450

> 我的疑问是，硬件将如何解释十进制和十六进制的比较。

硬件没有十进制或十六进制的概念。对机器来说 0x1FE 和 510 是无法区分的；它们只是完全相同事物的两种不同表示。

# android - 居中对齐 ActionBar 标题并使用自定义字体

> ID：13261755
> 
> 赞同：0
> 
> 时间：2012-11-07T00:53:56.313
> 
> 标签：android, customization, android-actionbar

这里是绝对的Android开发初学者，所以请多多包涵。我试图用我在 ActionBar 中的标题来实现两件事：

1.  居中对齐标题文本
2.  为标题文本使用自定义字体

我正在尝试遵循[此](https://stackoverflow.com/questions/8607707/how-to-set-a-custom-font-in-the-actionbar-title)答案，因此请先查看该答案。

**MainActivity.java**的内容

 **```
 // ATTEMPT TO STYLE THE ACTIONBAR
    this.getActionBar().setDisplayShowCustomEnabled(true);
    this.getActionBar().setDisplayShowTitleEnabled(false);

    LayoutInflater inflator = (LayoutInflater)this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View v = inflator.inflate(R.layout.titleview, null);

    //if you need to customize anything else about the text, do it here.
    //I'm using a custom TextView with a custom font in my layout xml so all I need to do is set title
    ((TextView)v.findViewById(R.id.title)).setText(this.getTitle());

    //assign the view to the actionbar
    this.getActionBar().setCustomView(v); 
```

我创建了一个新的 XML 文件：**layout/titleview.xml**对应于`R.layout.titleview`上面。它包含：

```
<com.muppethead.app.name.CustomTextView
    android:id="@+id/title"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerVertical="true"
    android:layout_marginLeft="10dp"
    android:textSize="20dp"
    android:maxLines="1"
    android:ellipsize="end"
    android:text="MY APP TITLE" /> 
```

这给出了错误： `The following classes could not be found: com.muppethead.app.name.CustomTextView`

**问题**

我哪里错了？除了修复上述错误，我在哪里引用我的字体，它位于`assets/fonts/font.otf`？那么文本居中呢？

我得说，Google 很遗憾没有通过 XML 实现这一点。它消除了新开发人员创造任何有吸引力的东西的可能性。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:04:07.153

老实说，我会忘记 custom `TextView`，而只使用 XML 中的默认值。您只使用它一次，并且仅用于自定义字体。

你可以这样做：

```
TextView tv = (TextView) v.findViewById(R.id.title);
Typeface tf = Typeface.createFromFile(getAssets(), "fonts/font.otf");
tv.setTypeface(tf);
tv.setText(this.getTitle()); 
```**

# asp.net-mvc - 如何在 Json .NET Web API 中 POST 但 JsonIgnore GET 时读取属性

> ID：13261760
> 
> 赞同：2
> 
> 时间：2012-11-07T00:54:45.267
> 
> 标签：asp.net-mvc, json, asp.net-web-api, json.net

我正在尝试通过在客户端获取对象时使用 Json Ignore 属性来使 Json .NET Ignore 属性，但我希望能够在客户端发布时接收该属性

例如，我有：

当客户端 POST 数据时，应发送密码：

```
{"email":"email@domain.com","password":"P@ssW0rd1!","firstname":"Joe","lastname":"Doe"} 
```

但是，当客户端获取相同的对象时，我应该忽略密码：

```
{"email":"email@domain.com","firstname":"Joe","lastname":"Doe"} 
```

班级：

```
 public class User
    {
        public User()
        {
            this.JoinDate = DateTime.UtcNow;
            this.IsActive = false;
        }
        public int Id { get; set; }

        [Required(ErrorMessage = "Email is required!")]
        public string Email { get; set; }

        [JsonIgnore]
        public string HashedPassword { get; set; }

        [Required(ErrorMessage = "Password is required!")]
        public string Password { get; set; }

        public DateTime JoinDate { get; set; }

        [Required(ErrorMessage = "First Name is required!")]
        public string FirstName { get; set; }

        [Required(ErrorMessage = "Last Name is required!")]
        public string LastName { get; set; }

   } 
```

任何想法，建议，意见？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T23:59:03.163

在您的场景中，我建议您将 User 类拆分为 2 个单独的模型类：

1.  登录类，包含登录信息（即Email、Password）
2.  UserInfo 类，其中包含有关用户的其余元数据（即 FirstName、LastName）

这样，我们就不用依赖序列化器来隐藏敏感数据了。

您可以使用 [IgnoreDataMember] 属性，并且开箱即用的 XML 和 JSON 格式化程序将支持它们，但不能保证任何其他注册的自定义格式化程序都会支持它。

请注意，[JsonIgnore] 仅在 JSON 格式化程序中受支持，而不在 XML 格式化程序中受支持。

# ruby-on-rails-3 - 根据计算填充 Rails 字段

> ID：13261762
> 
> 赞同：2
> 
> 时间：2012-11-07T00:55:24.143
> 
> 标签：ruby-on-rails-3

在我的 Rails 3.2 应用程序中，我想根据用户输入的字段值是变量的计算来填充一些字段。但是，使用我当前的代码，计算似乎只能基于数据库中已有的值 - 它在初始保存时计算不正确，但如果我返回记录并保存它，它将正确计算时间。

我的模型中有这四个字段（贸易）：

1.  entry_price
2.  退出价格
3.  百分比结果
4.  美元结果

用户创建一个带有入场价格的交易，然后使用 exit_price 编辑该交易。输入 exit_price 后，应用程序应计算 percent_result 和 Dollar_result。但是，现在，这些结果字段在第一次更新时没有正确填充 - 这似乎是因为它没有从字段中读取 exit_price（当用户在表单中输入它时），只有在它保存在D B。

我的控制器出了什么问题？

我的控制器：

```
def update
  @trade = Trade.find(params[:id])
  exit_price = params[:trade][:exit_price]

  if !exit_price.blank?
    @trade.percent_result = ((exit_price.to_f - @trade.entry_price)/@trade.entry_price) * 100
    @trade.dollar_result = exit_price.to_f - @trade.entry_price 
  end

  params[:trade][:exit_date] = Date.strptime(params[:trade][:exit_date], '%m/%d/%Y') unless params[:trade][:exit_date].blank?
  params[:trade][:entry_date] = Date.strptime(params[:trade][:entry_date], '%m/%d/%Y') unless params[:trade][:entry_date].blank?
  respond_to do |format|
    if @trade.update_attributes(params[:trade])
      format.html { redirect_to @trade, :flash => {:share =>"Your trade was successfully updated.  Don't forget to share it with your friends, so you can profit together!"} }
      format.json { head :no_content }
    else
      format.html { render action: "edit" }
      format.json { render json: @trade.errors, status: :unprocessable_entity }
    end
  end
end 
```

风景

```
<%= simple_form_for(@trade, :html=>{:class=> "form-horizontal well"})  do |f| %>  
  <%= f.text_field :entry_price, :class=>"input-small" %>
  <%= f.text_field :exit_price, :class=>"input-small" %>

  <%= submit_tag "Edit Trade" %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T01:38:34.023

使用模型中的 before_save 过滤器可能会更好地完成此操作。

添加

```
before_save :calculate_results 
```

到模型的顶部，然后定义

```
def calculate_results
    unless self.exit_price.blank? || self.entry_price.blank?
        self.percent_result = ((self.exit_price - self.entry_price)/self.entry_price) * 100
        self.dollar_result = self.exit_price - self.entry_price 
    end
end 
```

在你的模型中也是如此。采用这种方法可确保您的结果始终与您的入场和出场价格值一致。在控制器中强制执行这一点违反了Rails“厚模型和薄控制器”的原则，也可能导致数据一致性问题。

一种更一致的方法是将 Dollar_result 和 percent_result 定义为模型中的方法。正如您的模型现在一样，您将 Dollar_result 存储在数据库中，即使它是派生值。作为一般规则，您应该只对每条数据有一个表示，而在这里您有两个。辅助方法可能看起来像

```
def dollar_result
    self.exit_price - self.entry_price unless self.exit_price.blank? || self.entry_price.blank?
end 
```

您将为 percent_result 定义一个类似的方法。使用这种方法，您可以保证所有数据都是一致的，因为它在系统中只有一个规范表示。

# java - 使用 UiBinder 的 GWT 项目结构

> ID：13261765
> 
> 赞同：1
> 
> 时间：2012-11-07T00:55:38.763
> 
> 标签：java, gwt, uibinder

如果我有以下课程`com.mywebapp.client.ui.MyWidget`：

```
public class MyWidget extends Composite {
    interface MyWidgetUiBinder extends UiBinder<Widget, MyWidget>{}
    private static MyWidgetUiBinder uiBinder = GWT.create(MyWidgetUiBinder.class);

    ...
} 
```

和它对应的UiBinder：

```
<!-- MyWidgetUiBinder.ui.xml -->
<ui:UiBinder xmlns:ui='urn:ui:com.google.gwt.uibinder' xmlns:g='urn:import:com.google.gwt.user.client.ui'>
    <!-- ... -->
</ui:UiBinder> 
```

然后：

1.  去哪里（什么包或文件夹）`MyWidgetUiBinder.ui.xml`？GWT 是否允许您将其配置为可配置的，还是要求您将其放置在特定位置？
2.  UiBinder 片段应该有多精细？对于每个小部件？对于每个显示区域？每个“页面”/屏幕 1 个？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:44:51.270

> 1.  MyWidgetUiBinder.ui.xml 去哪里（什么包或文件夹）？GWT 是否允许您将其配置为可配置的，还是要求您将其放置在特定位置？

GWT 要求 ui.xml 文件与 .java 文件位于同一文件夹（源文件夹）中。如果您使用 eclipse 的 GWT 插件，它会在文件不存在时警告您。如果您确实需要，您还可以使用`@UiTemplate`界面 ( ) 上的注释来指定不同的位置。`MyWidgetUiBinder`

> 1.  UiBinder 片段应该有多精细？对于每个小部件？对于每个显示区域？每个“页面”/屏幕 1 个？

这真的取决于。我喜欢从每页一个 UiBinder 开始，然后打破可重复使用的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T01:46:29.290

UiBinder 在与该类相同的包中查找以接口的封闭类（如果有，否则为接口名称）命名的文件。

在你的情况下，它会寻找一个`com/mywebapp/client/ui/MyWidget.ui.xml`.

这是默认设置，可以使用`@UiTemplate`. 请参阅[https://developers.google.com/web-toolkit/doc/latest/DevGuideUiBinder#Apply_different_xml](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiBinder#Apply_different_xml)

至于*粒度*，UiBinder 模板应该保留一个小部件的实现细节。

# java - Java 球对象不会像预期的那样从绘制的矩形中反弹。

> ID：13261767
> 
> 赞同：2
> 
> 时间：2012-11-07T00:55:42.807
> 
> 标签：java, applet, mouseevent, collision-detection, rectangles

对不起这个糟糕的标题。Java 小程序的目的是这样的：一个球在屏幕上弹跳。这个球的大小和速度可以通过滚动条来改变。用户可以在屏幕上按下并拖动鼠标来绘制矩形。球也会从这些矩形中反弹。这些矩形的边界存储在一个向量中。单击一个矩形时，它（以及该点处的所有其他矩形）将从矢量（和屏幕）中删除。

我遇到的问题有两个：第一，当我单击一个矩形将其删除时，它不会被删除，但可以稍后解决。

二：球不会像它应该的那样从矩形反弹。当我在与球相同的行或列中绘制一个矩形时，球会在一个小矩形内反弹，就像它被卡住一样。

这是我的代码，用于检测球是否击中小程序或任何矩形的边界：

```
 public void move()
  {
    //if it will hit the right or left boundary, flip the x direction and set it
    if (loc.x+size >= boundx || loc.x <= 0)
    { dx *= -1; }
    //if it will hit the top or bottom boundray, flip the y direction and set it
    if (loc.y+size >= boundy || loc.y <= 0)
    { dy *= -1; }

    for (int i = 0; i < r.size(); i++)
    {

      temp = new Rectangle(r.elementAt(i));
      int rx = temp.x;
      int ry = temp.y;
      int rh = temp.height;
      int rw = temp.width;
      //If the ball hits either side of the rectangle, change the x direction
      if((loc.x > rx && loc.x > ry && loc.x < (ry + rh))||(loc.x < (rx + rw) && loc.x > rx && loc.x <(ry + rh)))
        {dx *= -1;}
      //If the ball hits either the top or bottom, change the y direction
      if((loc.y > ry && loc.y > rx && loc.y < (rx + rw))||(loc.y < (ry + rh) && loc.y > ry && loc.y <(rx + rw)))
        {dy *= -1;}
    }
    //Increment or decrement the location of the ball based on the X and Y directions.
    loc.x += dx;
    loc.y += dy;
  } 
```

如果您想查看完整的代码，请访问：http: [//ideone.com/R1hpBx](http://ideone.com/R1hpBx)

在此先感谢您提供的所有出色帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-07T04:12:50.230

我终于找到了一个我喜欢的边缘检测系统...

![旋转的厄运球](../Images/b9c2035a9a1af7b7b7554910d6298a10.png)

基本上，魔法发生在这里......

```
// Detect if we collided with any one (collision is the rectangle, bounds is us)
if (collision.intersects(bounds)) {
    // Determine the intersect of the collision...
    insect = collision.intersection(bounds);

    // Flags...
    boolean vertical = false;
    boolean horizontal = false;
    boolean isLeft = false;
    boolean isTop = false;

    // Left side...
    if (insect.x == collision.x) {
        horizontal = true;
        isLeft = true;
    // Right side
    } else if (insect.x + insect.width == collision.x + collision.width) {
        horizontal = true;
    }
    // Top
    if (insect.y == collision.y) {
        vertical = true;
        isTop = true;
    // Bottom
    } else if (insect.y + insect.height == collision.y + collision.height) {
        vertical = true;
    }

    // Technically, we can really only collide with a single edge...more or less
    if (horizontal && vertical) {
        // Basically, we try and give precedence to the longer edge...
        if (insect.width > insect.height) {
            horizontal = false;
        } else {
            vertical = false;
        }
    }

    // We collided with a horizontal side...
    if (horizontal) {
        dx *= -1;
        // Move the ball to the approriate edge so we don't get caught...
        if (isLeft) {
            bounds.x = collision.x - bounds.width;
        } else {
            bounds.x = collision.x + collision.width;
        }
    // We collided with a vertical side...
    } else if (vertical) {
        dy *= -1;
        // Move the ball to the approriate edge so we don't get caught...
        if (isTop) {
            bounds.y = collision.y - bounds.height;
        } else {
            bounds.y = collision.y + collision.height;
        }
    }

} 
```

现在，我只有一个障碍，但我怀疑要让它与一系列障碍一起工作需要付出很多努力......;）

```
public class TestBouncingBall {

    private Rectangle insect;

    public static void main(String[] args) {
        new TestBouncingBall();
    }

    public TestBouncingBall() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new BallPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class BallPane extends JLayeredPane {

        private Ball ball;
        private Timer timer;
        private Rectangle world;

        public BallPane() {

//            world = new Rectangle(random(400), random(400), random(100), random(100));
            world = new Rectangle(100, 100, 200, 200);

            ball = new Ball();
            ball.setSize(ball.getPreferredSize());
            ball.setLocation(10, 10);

            add(ball);

            timer = new Timer(16, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    ball.move(getBounds(), world);
                    invalidate();
                    repaint();
                }
            });
            timer.setRepeats(true);
            timer.setCoalesce(true);
            timer.start();

        }

        protected int random(int max) {

            return (int) Math.round(Math.random() * max);

        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(400, 400);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g.create();
            g2d.setColor(Color.GRAY);
            g2d.fill(world);
            if (insect != null) {
                g2d.setColor(Color.RED);
                g2d.fill(insect);
            }
            g2d.dispose();
        }
    }

    public class Ball extends JPanel {

        public int maxSpeed = 10;
        private BufferedImage beachBall;
        private int dx = 10 - (int)Math.round(Math.random() * (maxSpeed * 2)) + 1;
        private int dy = 10 - (int)Math.round(Math.random() * (maxSpeed * 2)) + 1;
        private int spin = 20;
        private int rotation = 0;

        public Ball() {
            try {
                beachBall = ImageIO.read(getClass().getResource("/ball.png"));
            } catch (IOException ex) {
                ex.printStackTrace();
            }
            setOpaque(false);
        }

        @Override
        public Dimension getPreferredSize() {
            Dimension size = beachBall == null ? new Dimension(48, 48) : new Dimension(beachBall.getWidth(), beachBall.getHeight());
            size.width += 4;
            size.height += 4;
            return size;
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            if (beachBall != null) {
                Graphics2D g2d = (Graphics2D) g.create();
                g2d.setRenderingHint(RenderingHints.KEY_ALPHA_INTERPOLATION, RenderingHints.VALUE_ALPHA_INTERPOLATION_QUALITY);
                g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                g2d.setRenderingHint(RenderingHints.KEY_COLOR_RENDERING, RenderingHints.VALUE_COLOR_RENDER_QUALITY);
                g2d.setRenderingHint(RenderingHints.KEY_DITHERING, RenderingHints.VALUE_DITHER_ENABLE);
                g2d.setRenderingHint(RenderingHints.KEY_FRACTIONALMETRICS, RenderingHints.VALUE_FRACTIONALMETRICS_ON);
                g2d.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);
                g2d.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);
                g2d.setRenderingHint(RenderingHints.KEY_STROKE_CONTROL, RenderingHints.VALUE_STROKE_PURE);

                int x = (getWidth() - beachBall.getWidth()) / 2;
                int y = (getHeight() - beachBall.getHeight()) / 2;
                AffineTransform transform = g2d.getTransform();
                AffineTransform at = new AffineTransform();
                at.translate(getX(), getY());
                at.rotate(Math.toRadians(rotation), getWidth() / 2, getHeight() / 2);
                g2d.setTransform(at);
                g2d.drawImage(beachBall, x, y, this);
                g2d.setTransform(transform);
                g2d.dispose();
            }
        }

        public void move(Rectangle world, Rectangle collision) {
            Rectangle bounds = getBounds();
            bounds.x += dx;
            bounds.y += dy;

            if (bounds.x < 0) {
                bounds.x = 0;
                dx *= -1;
            }
            if (bounds.y < 0) {
                bounds.y = 0;
                dy *= -1;
            }
            if (bounds.x + bounds.width > world.width) {
                bounds.x = world.width - bounds.width;
                dx *= -1;
            }
            if (bounds.y + bounds.height > world.height) {
                bounds.y = world.height - bounds.height;
                dy *= -1;
            }

            if (collision.intersects(bounds)) {
                insect = collision.intersection(bounds);

                boolean vertical = false;
                boolean horizontal = false;
                boolean isLeft = false;
                boolean isTop = false;

                if (insect.x == collision.x) {
                    horizontal = true;
                    isLeft = true;
                } else if (insect.x + insect.width == collision.x + collision.width) {
                    horizontal = true;
                }
                if (insect.y == collision.y) {
                    vertical = true;
                    isTop = true;
                } else if (insect.y + insect.height == collision.y + collision.height) {
                    vertical = true;
                }

                if (horizontal && vertical) {
                    if (insect.width > insect.height) {
                        horizontal = false;
                    } else {
                        vertical = false;
                    }
                }

                System.out.println("v = " + vertical + "; h = " + horizontal);

                if (horizontal) {
                    dx *= -1;
                    if (isLeft) {
                        bounds.x = collision.x - bounds.width;
                    } else {
                        bounds.x = collision.x + collision.width;
                    }
                } else if (vertical) {
                    dy *= -1;
                    if (isTop) {
                        bounds.y = collision.y - bounds.height;
                    } else {
                        bounds.y = collision.y + collision.height;
                    }
                }

            }

            rotation += spin;

            setBounds(bounds);
            repaint();

        }
    }
} 
```

# java - 在多个 Android 应用程序之间共享一条数据

> ID：13261768
> 
> 赞同：3
> 
> 时间：2012-11-07T00:55:55.483
> 
> 标签：java, android

我正在为 Android 编写一个 SDK，它将被许多不同的应用程序使用。每个应用程序都需要知道之前是否安装了另一个使用 SDK 的应用程序；第一个将创建一个随机 id（一个 cookie）并存储它，所有以后的应用程序都必须读取它并重用它。请注意，将为每台设备重新创建 cookie。

我找了很久的答案；请在回答之前仔细阅读，因为我已经阅读了很多不同的 StackOverflow 答案，并且已经在互联网上搜索了随机博客；我已经尝试了很多东西，但都没有奏效（我会保存你的链接）。

*   ContentProvider 绝对是矫枉过正。它还需要侵入应用程序`AndroidManifest.xml`，这是我试图避免的。
*   同样对于服务：需要在 中定义`AndroidManifest.xml`，我无法控制并且不想要求对其进行更改。
*   使用外部存储可能是一种选择，但我不想要求额外的权限。
*   `SharedPreferences`直接使用with`getSharedPreferences()`不起作用，因为应用程序只能访问自己的首选项。
*   我可以使用`createPackageContext(package, MODE).getSharedPreferences()`. 如果我有一个主包和许多数据客户端，这会很好地工作，但实际上我不知道将首先安装的应用程序包——它可以是其中的任何一个。我什至没有要搜索的包名称列表。传递尚未安装的包名称失败。
*   按照上述方法，我尝试搭载一些我可以依赖的标准 Android 应用程序，并将我的偏好存储在那里——比如：

    ```
    createPackageContext(
        "com.android.browser",
        Context.CONTEXT_RESTRICTED)
        .getSharedPreferences(
            "GLOBAL_PREFS",
            Context.MODE_WORLD_READABLE); 
    ```

    但它不起作用：错误读取

    ```
    Couldn't create directory for SharedPreferences file
      /data/data/com.android.browser/shared_prefs/GLOBAL_PREFS.xml 
    ```

所以，回顾一下：我需要在某个标准位置存储一段数据（一个短字符串），以便任何其他应用程序可以去那里读取它（如果存在），并且如果可能的话它应该可以工作，而不需要做任何魔法或`AndroidManifest.xml`请求任何权限。

可能没有任何完美的答案，所以也许最好的解决方案是写入外部存储；那么就这样吧。把事情放在上下文中，显然在 iOS 上使用钥匙串来做到这一点是微不足道的，钥匙串旨在存储安全数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T02:02:50.813

Unfortunately there really isn't a great answer for this that I know of. You've come up with a pretty good outline of your options and the best way may well be with external storage.

Just to throw something out there, I suppose it's possible you could use a flat file with a fixed name and world readable (and possibly writable) permissions. You'd have to then iterate through all applications' directories and check for this known-named file in each folder and attempt to open it.

While this might work theoretically, consider the case where the app that contains the "cookie" is uninstalled. Then you're left cookie-less. You might want to create the cookie in every app, copying over the value of the previous cookies to new cookies.

I haven't actually tried this, but I imagine it should work.

# c# - 设置实时日志记录窗口以从不同线程写入的最佳架构，例如visualstudio中的输出窗口

> ID：13261769
> 
> 赞同：1
> 
> 时间：2012-11-07T00:56:05.483
> 
> 标签：c#, .net, multithreading, architecture

我正在设计一个应用程序，它在不同的线程上运行不同的组件。我需要一种方法来向用户界面报告这些组件的状态、它们完成的任务以及是否发生了任何错误。我的第一种方法是将所有不同的组件写入日志文件。然后我监视该文件的更改，以在文本框（我的输出窗口）中重新加载更改。但是我注意到使用文件监视器并不能很好地执行，它会减慢组件线程及其任务的速度。所以我想在vs2010中创建类似输出窗口的东西，他们可以在调试时记录任何数据，它似乎非常高效，并且可以保存大量数据。任何想法什么是最好的方法？一个重要的事实，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:03:48.007

我认为您可以通过写入日志文件来改进您的想法，只需异步执行，这样您就不会阻塞线程。

您可以使用[NLog](http://nlog-project.org/)或[log4net 之](http://logging.apache.org/log4net/)类的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T01:41:34.787

好吧，我不明白为什么您不能在此示例代码中执行类似的操作（我必须说，我认为您正在执行所有同步和线程停止，这只是使用 Control.Invoke 进行操作的一个快速示例线程安全，您也可以使用 BeginInvoke，它不会阻塞正在写入文本框的线程）：

```
 List<Thread> threads = new List<Thread>();
        bool closeThreads;
        private void button1_Click(object sender, EventArgs e)
        {
            closeThreads = false;
            for (int i = 1; i < 10; i++)
            {
                Thread t = new Thread(new ParameterizedThreadStart(ThreadMethod));
                threads.Add(t);
                t.Start(i);
            }
        }
        private void button2_Click(object sender, EventArgs e)
        {
            closeThreads = true;
            foreach (Thread t in threads)
            {
                if (t.ThreadState != ThreadState.Stopped)
                    t.Join(3);
            }
        }

        delegate void textWriter(string textToWrite);
        void WriteText(string textToWrite)
        {
            this.textBox1.AppendText(textToWrite);
        }

        void ThreadMethod(object i)
        {
            int threadNumber = (int)i;
            int currentNumber = 100 * threadNumber;
            Random rand = new Random(threadNumber);
            while(!closeThreads)
            {
                currentNumber = (currentNumber + rand.Next(0,100))%1000;
                Thread.Sleep(currentNumber);
                //textBox1.Invoke(new textWriter(WriteText), new object[]{"Thread " + threadNumber.ToString() + " " + currentNumber.ToString() + Environment.NewLine});
                //this won't block your threads
                string text = "Thread " + threadNumber.ToString() + " " + currentNumber.ToString() + Environment.NewLine;
            textBox1.BeginInvoke(new textWriter(WriteText), new object[]{text});
            }
        } 
```

为了尝试代码，您需要制作一个包含两个`Buttons`和一个的表单`TextBox`

# c++ - 列出 dylib 中的所有符号

> ID：13261774
> 
> 赞同：0
> 
> 时间：2012-11-07T00:56:44.553
> 
> 标签：c++, c, macos

我正在尝试列出 dylib 中的所有符号，以便知道需要在我的应用程序中更新哪个符号（因为我的应用程序存储所有功能链接及其名称，以创建自动检测/在运行时自动更新函数）。

基本上，我搜索的内容与 nm 命令所做的类似，但在代码中（而不是通过在控制台上启动 nm 然后获取输出并解析）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T08:33:13.343

我认为[rsym_macosx](http://modular.math.washington.edu/home/wstein/www/home/page/fricas-src/gcl/unixport/rsym_macosx.c%20rsym_macosx)可以为您提供一些帮助，例如`nm`. 我不知道你真的想在你的代码中做什么样的符号，但你可以根据那个和 Mach-O 格式来修改它。

# c# - 未调用自定义控件的 OnMouseLeftButtonDown

> ID：13261775
> 
> 赞同：1
> 
> 时间：2012-11-07T00:56:58.153
> 
> 标签：c#, wpf, wpf-controls

我对 WPF 很陌生，我正在尝试编写一个基本上是 TextBlock 的自定义控件，但也有一个单击事件。我尝试从各种来源将这些东西拼凑在一起，但它不起作用。

在下面的代码中，我希望`OnMouseLeftButtonDown`在元素上执行鼠标单击时调用它。如果发生这种情况，我想提出这个`Click`事件。在调试器中查看，该函数从未被调用。

我是否误解了这应该如何工作，或者是否有其他错误发现它进入了我的代码？

```
namespace EP3_gui.Controls
{
    public class ClickableTextBlock : TextBlock
    {
        public ClickableTextBlock() : base()
        { }

        public ClickableTextBlock( Inline inline )
            : base( inline )
        { }

        protected override void OnMouseLeftButtonDown( MouseButtonEventArgs e )
        {
            base.OnMouseLeftButtonDown( e );
            RoutedEventArgs args = new RoutedEventArgs( ClickEvent );
            RaiseEvent( args );
        }

        public static readonly RoutedEvent ClickEvent = EventManager.RegisterRoutedEvent(
            "Click",
            RoutingStrategy.Bubble,
            typeof( RoutedEventHandler ),
            typeof( ClickableTextBlock )
        );

        public event RoutedEventHandler Click
        {
            add { AddHandler( ClickEvent, value ); }
            remove { RemoveHandler( ClickEvent, value ); }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T01:07:04.147

正如@menty 指出的那样，代码中没有错误，我在测试控件时犯了一个错误。在 XAML 中对其进行测试，我输入了一个值，否则控件将没有高度和宽度（使用 Auto 作为大小）

我的代码是

```
 <cc:ClickableTextBlock x:Name="bit3" ... Click="bitText_Click" Text="{Binding Value}">0<cc:ClickableTextBlock> 
```

如果将其更改为

```
 <cc:ClickableTextBlock x:Name="bit3" ... Click="bitText_Click" Text="{Binding Value}" /> 
```

它有效，但随后无法在设计器中看到该元素。在我的情况下，它非常糟糕，因为父用户控件的大小设置为`auto`，所以整个控件在设计器上看起来是错误的。

解决方案是为绑定提供一个默认值：

```
 <cc:ClickableTextBlock x:Name="bit3" ... Click="bitText_Click" Text="{Binding Value, FallbackValue=0}" /> 
```

这样它就可以工作，并且控件在设计器中是可见的。

# c - C atoi 函数中的潜在错误

> ID：13261783
> 
> 赞同：1
> 
> 时间：2012-11-07T00:57:29.337
> 
> 标签：c, atoi

您是否可以向 atoi 函数提供任何会产生错误（可能会或可能不会使程序崩溃）的东西？

编辑：错误被定义为任何会产生编译错误的东西，或者会导致程序在执行期间终止的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T00:59:39.187

> 任何会产生编译错误的东西

如果您提供的参数`atoi()`是不兼容的类型，您将收到编译时错误。

> 会导致程序在执行期间终止的东西

如果你提供`atoi()`了一个无效的`const char*`指针，你的代码的行为将是不确定的。虽然没有任何保证，但如果指针是`NULL`或指向不可读的内存，则程序可能会终止（这取决于操作系统和硬件架构）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T01:15:27.063

我怀疑这个问题更像是“在将输入传递给 atoi 之前，我是否必须对来自我不信任的来源的输入进行清理？”

大多数情况下都指定了正确编写的 atoi 函数的行为。它将字符转换为数字，直到遇到非数字的东西然后停止。然而 atoi 被认为容易受到溢出的影响

您应该改用 strtol ；它的规格更严格

当然，您的 c 运行时中的实现可能会被破坏-但是您对此无能为力

# java - 2 个集合中的一个对象（参考）

> ID：13261790
> 
> 赞同：1
> 
> 时间：2012-11-07T00:58:46.787
> 
> 标签：java, collections, reference

我很好奇java中的对象引用假设我们有一个Person对象

```
Person object = new Person("Joe"); 
```

我把它放在一个`ArrayList<Person>`

```
ArrayList<Person> person_collection = new ArrayList<Person>();
person_collection.add(object); 
```

我再次创建一个新的集合`Person`，然后复制的项目`person_collection`

```
ArrayList<Person> collection = new ArrayList<Person>(person_collection); 
```

如果我从`collection`

```
Person p = collection.get(i); 
```

有`p`参考`person_collection` 吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:00:34.050

在这种情况下，`p`在初始化步骤中至少包含 的所有元素`person_collection`。

因此，当您直接迭代这个新创建的集合时，您将获得与`Person`初始集合中包含的相同的指向元素。

顺便说一句，由于 Java 从不使用按引用传递但始终使用**按值传递**方法，因此引用本身并不相同，但这并不妨碍它们指向真正相同的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T01:01:10.883

是的， Person "object" 变量引用将在 Person "p" variable 中返回。

person_collection 和 collection 将引用 2 个包含指向 p 的对象的不同集合。

# drupal - 具有多个 (ALL) 词汇表的 Drupal 7 访问控制

> ID：13261792
> 
> 赞同：1
> 
> 时间：2012-11-07T00:59:09.500
> 
> 标签：drupal, drupal-7, drupal-taxonomy

我们正在尝试使用 3 个词汇表进行访问控制，将分类术语附加到用户和节点。

有 2 个很棒的 Drupal 7 模块允许分类访问控制：分类访问（基于角色）和 TAC Lite（基于用户）。

但是两个模块在使用多个词汇表时都使用 OR 逻辑，而我们需要匹配所有它们。

是否有任何替代或推荐的方法通过匹配所有相关类别（使用或不使用分类法）来获得用户和节点之间的访问控制？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-30T10:30:27.527

我正在将分类访问控制用于基于角色的权限。您可以将每个分类词汇的默认选择添加到拒绝，然后设置仅允许每个词汇中的特定术语。使用此设置，您只有在选择每个词汇表中的每个术语时才能访问内容。我没有设法完成的是允许访问，如果来自词汇 1 的术语 1、术语 2 匹配并且词汇 2 的术语 3、术语 4 也匹配。

# spring - 在 Spring 登录中显示错误消息

> ID：13261794
> 
> 赞同：7
> 
> 时间：2012-11-07T00:59:26.250
> 
> 标签：spring, security, authentication, login, messages

我正在使用 Spring 安全性对用户进行身份验证。我创建了一个自定义身份验证提供程序，现在我想知道如何从提供程序获取错误消息到我的表单中。这是我的自定义身份验证提供程序中的 authenticate() 方法：

```
@Override
public Authentication authenticate(Authentication authentication) throws AuthenticationException {
    UserProfile profile = userProfileService.findByEmail(authentication.getPrincipal().toString());

    if(profile == null){
        throw new UsernameNotFoundException(String.format("Invalid credentials", authentication.getPrincipal()));
    }

    String suppliedPasswordHash = DigestUtils.shaHex(authentication.getCredentials().toString());

    if(!profile.getPasswordHash().equals(suppliedPasswordHash)){
        throw new BadCredentialsException("Invalid credentials");
    }

    UsernamePasswordAuthenticationToken token = new UsernamePasswordAuthenticationToken(profile, null, profile.getAuthorities());

    return token;
} 
```

这是我的表格：

```
<form name='f' action="<c:url value='j_spring_security_check' />" method='POST'>
<div id="data-entry-form">

    <div class="form-entry">
        <label><spring:message code="login.form.label.email"/></label>
        <input type='text' name='j_username' value=''>
    </div>
    <div class="form-entry">
        <label><spring:message code="login.form.label.password"/></label>
        <input type='password' name='j_password'/>
    </div>
    <div class="form-entry">
        <input type="submit" value="Verzenden"/>
    </div>
</div> 
```

如何将错误消息输入我的表单？从我按下登录按钮的那一刻起，Spring 就接管了，所以我可以生成错误消息的唯一方法是 authenticate() 方法......

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2019-07-10T13:10:19.740

最安全的 3 个步骤（我们不依赖 LAST_EXCEPTION）：

1.  在您的自定义身份验证提供程序的配置中指定错误页面（例如“登录错误”）

    ```
    httpSecurity
    .authorizeRequests()
    .antMatchers("/css/**", "/js/**", "/img/**").permitAll()
    .anyRequest().fullyAuthenticated()
    .and()
    .formLogin().loginPage("/login").permitAll()
    .failureUrl("/login-error")
    .and()
    .logout().permitAll() 
    ```

2.  为 url /login-error 创建控制器，返回自定义登录页面的视图（例如“登录”），并使用以下代码：

    ```
    @Controller
    public class LoginController {

        @GetMapping("/login-error")
        public String login(HttpServletRequest request, Model model) {
            HttpSession session = request.getSession(false);
            String errorMessage = null;
            if (session != null) {
                AuthenticationException ex = (AuthenticationException) session
                        .getAttribute(WebAttributes.AUTHENTICATION_EXCEPTION);
                if (ex != null) {
                    errorMessage = ex.getMessage();
                }
            }
            model.addAttribute("errorMessage", errorMessage);
            return "login";
        }
    } 
    ```

3.  最终将错误消息放入您的页面（例如，ThymeLeaf 标签）：

    ```
    <!--/*@thymesVar id="errorMessage" type="java.lang.String"*/-->
    <div class="alert" th:if="${errorMessage}" th:text="${errorMessage}"></div> 
    ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-07-11T07:19:02.000

我能够像这样解决它：

```
<c:if test="${param.auth eq 'failure'}">
  <div class="error">
    <c:out value="${SPRING_SECURITY_LAST_EXCEPTION.message}" />
  </div>
</c:if> 
```

请注意，您需要通过可以在 spring-security 配置中设置的特殊参数来检测是否存在错误，如下所示：

```
<security:form-login [...] authentication-failure-url="/login?auth=failure" /> 
```

**编辑：** 实际上，不需要传递该参数。相反，可以简单地检查是否`SPRING_SECURITY_LAST_EXCEPTION.message`已定义，如下所示：

```
<c:if test="${not empty SPRING_SECURITY_LAST_EXCEPTION.message}">
  <div class="error">
    <c:out value="${SPRING_SECURITY_LAST_EXCEPTION.message}" />
  </div>
</c:if> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-27T11:40:55.470

我认为您应该能够以与使用“标准”身份验证器相同的方式获取消息。如果在身份验证过程中抛出异常（或多个），则最后一个异常存储在会话属性中：SPRING_SECURITY_LAST_EXCEPTION。

因此，要从 JSP 获取最后一条异常消息，您可以使用如下内容：

```
<%=((Exception) request.getSession().getAttribute("SPRING_SECURITY_LAST_EXCEPTION")).getMessage()%>; 
```

当然，如果您有一个控制器，您可能应该从控制器获取消息并仅将字符串传递给 jsp。这只是一个例子；）

# mysql - Rails 和 Windows 8 - “%1 不是有效的 Win32 应用程序”错误

> ID：13261800
> 
> 赞同：2
> 
> 时间：2012-11-07T01:00:17.030
> 
> 标签：mysql, ruby-on-rails-3

## 目标

**我试图让 Rails**第一次运行**并连接到 MySQL**，所有这些都在我的本地机器上。据我所知，Rails 是按照规范安装的。我的设置是：

*   Ruby 1.9.3（通过最新版本的 RubyInstaller 安装）
*   导轨 3.2.8
*   视窗 8
*   WAMP（它有我想将 Rails 连接到的 MySQL 数据库）

## 问题

当我运行命令`rails s`时，我收到以下错误：

```
C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/mysql2.rb:2:in 'require': 193: %1 is not a valid Win32 application - C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/1.9/mysql2.so (LoadError)
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/
lib/mysql2/mysql2.rb:2:in '<top (required)>'
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/
lib/mysql2.rb:9:in 'require'
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/
lib/mysql2.rb:9:in '<top (required)>'
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/
runtime.rb:68:in 'require'
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/
runtime.rb:68:in 'block (2 levels) in require'
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/
runtime.rb:66:in 'each'
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/
runtime.rb:66:in 'block in require'
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/
runtime.rb:55:in 'each'
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/
runtime.rb:55:in 'require'
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler.
rb:128:in 'require'
    from C:/Users/Andrew/Desktop/rails_test/simple_cms/config/application.rb
:7:in '<top (required)>'
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/c
ommands.rb:53:in 'require'
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/c
ommands.rb:53:in 'block in <top (required)>'
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/c
ommands.rb:50:in 'tap'
    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/c
ommands.rb:50:in '<top (required)>'
    from script/rails:6:in 'require'
    from script/rails:6:in '<main>' 
```

那么`mysql2`gem好像有问题？我的阅读告诉我，大约 1-2 年前这是一个大问题，但我的理解是，此时问题已经解决。（如果它确实比 更好`mysql`，那么我想使用它！）

## 我试过的

*   我收到错误“126：找不到指定的模块” *；*在查找相关信息时，我遇到了将“libmysql.dll”复制到 Ruby 的 bin 文件夹的建议。它显然修复了 126 错误，但现在我收到了这个 193 错误。
*   完全卸载 Ruby、Rails，并使用各种不同的指南多次重新安装。
*   发现[这篇博](http://myrailslearnings.wordpress.com/2012/07/03/error-cdevruby193librubysite_ruby1-9-1rubygemscustom_require-rb36in-require-193-1-is-not-a-valid-win32-application/)文，作者发现他正在运行的另一个程序正在阻止`rails s`工作，所以我关闭了所有内容并再次尝试。没有什么。
*   过去两天都在阅读有相同问题的人们的博客和不同帖子，但似乎*所有*这些都来自一年多以前，链接到（显然是成功的！）修复了链接所在的位置，不幸的是，现在已经死了。

如果需要任何进一步的信息，请告诉我！在过去 48 小时的大部分时间里，我一直在谷歌搜索这个问题，但完全无济于事。任何方向将不胜感激。：） 谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T19:27:07.543

在这里。我刚刚让 Rails 工作。不幸的是，没有规范（我使用 SQLlite 而不是通过 WAMP 安装的 MySQL 安装），但它正在运行。我使用[RailsInstaller](http://railsinstaller.org/)并按照他们的说明进行设置，它运行良好。我推荐给任何和我有同样问题的人！

# python-3.x - 将字符串转换为 Base 64 和从 Base 64 转换

> ID：13261802
> 
> 赞同：20
> 
> 时间：2012-11-07T01:00:21.730
> 
> 标签：python-3.x, base64

我正在尝试编写两个程序，一个将字符串转换为base64，然后另一个将base64编码的字符串转换回字符串。
到目前为止，我无法通过 base64 编码部分，因为我不断收到错误

```
TypeError: expected bytes, not str 
```

到目前为止，我的代码看起来像这样

```
def convertToBase64(stringToBeEncoded):
import base64
EncodedString= base64.b64encode(stringToBeEncoded)
return(EncodedString) 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-11-07T10:29:29.400

字符串已经“解码”，因此 str 类没有“解码”功能。因此：

```
AttributeError: type object 'str' has no attribute 'decode' 
```

如果要解码字节数组并将其转换为字符串调用：

```
the_thing.decode(encoding) 
```

如果要对字符串进行编码（将其转换为字节数组），请调用：

```
the_string.encode(encoding) 
```

就 base 64 的内容而言：使用 'base64' 作为上述编码的值会产生错误：

```
LookupError: unknown encoding: base64 
```

打开控制台并输入以下内容：

```
import base64
help(base64) 
```

你会看到base64有两个非常方便的函数，分别是b64decode和b64encode。b64 decode 返回一个字节数组，而 b64encode 需要一个字节数组。

要将字符串转换为其 base64 表示，您首先需要将其转换为字节。我喜欢 utf-8，但使用你需要的任何编码......

```
import base64
def stringToBase64(s):
    return base64.b64encode(s.encode('utf-8'))

def base64ToString(b):
    return base64.b64decode(b).decode('utf-8') 
```

# java - 可靠地识别序列化 Java 对象的类

> ID：13261804
> 
> 赞同：0
> 
> 时间：2012-11-07T01:00:40.073
> 
> 标签：java, object, serialization, deserialization, identification

我需要在不反序列化的情况下可靠地识别 Java 中序列化对象的类。

到目前为止，我发现原始数据流将包含类名。然而，有人可以创建一个具有任意名称的自定义类来欺骗识别。

现在我正在考虑实现一个系统，其中还根据模板检查对象的存储数据，但这似乎很麻烦。

是否有已经这样做的包和/或是否有更简单的方法来可靠地识别序列化 Java 对象的类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:14:53.433

你看过 JavaAssist (http://www.csg.ci.iu-tokyo.ac.jp/~chiba/javassist/) 吗？它似乎能够加载类文件元数据并使其可用而不必创建类。

# javascript - 使用javascript以秒为单位获取UTC时间

> ID：13261811
> 
> 赞同：1
> 
> 时间：2012-11-07T01:01:16.080
> 
> 标签：javascript, utc

我需要以秒为单位获取 UTC 时间（对于格林威治标准时间 11 月 7 日星期三 00:50:28，我需要它返回：1352249428）

我现在有这个代码：

```
current_date = new Date()
var x_timestamp = current_date.getUTCSeconds(); 
```

但它返回 28.00

帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:05:31.903

尝试`UTC`取消您的日期对象并将结果除以 1000。

# python - 如何将重音字符与 Python 中的正则表达式匹配？

> ID：13261813
> 
> 赞同：7
> 
> 时间：2012-11-07T01:01:23.723
> 
> 标签：python, regex, unicode, non-ascii-characters

我需要[这个问题](https://stackoverflow.com/questions/7292395/how-to-match-accented-characters-with-a-regex)的解决方案，Python 除外！我已经尝试为 Python 安装正则表达式库，[显然](http://www.velocityreviews.com/forums/t739967-enabling-the-use-of-posix-character-classes-in-python.html)这可以在 Python 的正则表达式中使用 POSIX 表达式，但我猜它在`[:alpha:]`类中不包含 Unicode 字符。例如：

```
>>> re.search(r'[[:alpha:] ]+','Please work blåbær and NOW stop 123').group(0)
'Please work bl' 
```

当我想要它匹配时`Please work blåbær and NOW stop`

**编辑：**我正在使用 Python 2.7

**编辑2：**我尝试了以下方法：

```
>>> re.search(re.compile('[\w ]+', re.UNICODE),'Please work blåbær and NOW stop 123').group(0)
'Please work bl\xc3' 
```

不是我想要的（我也想匹配第一个非 ASCII 字符之后的部分），但至少它比以前更匹配字符。我应该在这里做什么才能让它与我想要的其余部分相匹配？

**编辑 3：**我不想匹配任何非“单词”字符；“单词”是指 az、AZ、空格和单词字符的任何重音变体。我希望我能理解我的想法；在一个短语中

```
lets match força, but stop before that comma 
```

我只想匹配`lets match força`

**编辑 4：**所以我尝试只为这个脚本使用 Python 3：

```
>>> re.search(re.compile('[\w ]+', re.UNICODE),'lets match força, but stop before that comma').group(0)
'lets match força' 
```

我猜它在 Python 3 中大部分时间都有效，除了它还匹配数字（我绝对不想要）和下划线。*在 Python 2或*3中有什么方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T01:15:07.783

目前尚不清楚您使用的是哪个 python 版本。如果您使用 2.x，那么您可能会遇到 unicode 问题。请参阅此[帖子](https://stackoverflow.com/a/393856/1107807)以获取更多指示，并随时更新您的问题以进一步详细说明。

我很惊讶，我无法将重音字符转换为正确的 unicode 表示...

但有解决方法：

```
re.search(re.compile('((\w+\s)|(\w+\W+\w+\s))+', re.UNICODE), ur'Please work blåbær and NOW stop 123').group(0) 
```

或者

```
re.search(re.compile('\D+', re.UNICODE), ur'Please work blåbær and NOW stop 123').group(0) 
```

# android - sqlite 数据库的简单导入/导出选项

> ID：13261814
> 
> 赞同：0
> 
> 时间：2012-11-07T01:01:25.347
> 
> 标签：android, sqlite, import, backup

考虑到我的应用程序仍在开发中，有时会出现影响我与应用程序连接的数据库的错误。因为我已经有测试数据，不想每次出错都输入，我想实现一个简单的导入/导出功能。

我最近偶然发现了[这个](https://stackoverflow.com/questions/6540906/android-simple-export-import-of-sqlite-database)问题，这或多或少是我想要的。我向您展示了我实现的代码。导出功能工作正常，我可以使用`SQLIte Database`android 市场的应用程序对其进行测试。问题是进口。它向我显示`Toast`，一切都很好，但什么也没有发生。不过，我不太确定我是否做得对。

在`MainMenuActivity`我实现了以下方法：

```
(...)

public boolean onCreateOptionsMenu(Menu menu){
    menu.add(1, Menu.FIRST, Menu.FIRST, "backup DB").setIcon(R.drawable.ic_action_save);
    menu.add(1, Menu.FIRST+1, Menu.FIRST+1, "import DB").setIcon(R.drawable.ic_action_upload);
    return super.onCreateOptionsMenu(menu);
}

(...)

public boolean onOptionsItemSelected(MenuItem item){
    switch(item.getItemId()){
    case 1:
        backupDatabase();
        return true;
    case 2:
        importDatabase();
        return true;
        default:
        break;
    }
    return super.onOptionsItemSelected(item);
}

private void backupDatabase(){
    try{
         File sd = Environment.getExternalStorageDirectory();
         File data = Environment.getDataDirectory();

         if (sd.canWrite()) {
             String currentDBPath = "//data//challenge.main//databases//DBCHALLENGES";
             String backupDBPath = "DBCHALLENGES";
             File currentDB = new File(data, currentDBPath);
             File backupDB = new File(sd, backupDBPath);

             FileChannel src = new FileInputStream(currentDB).getChannel();
             FileChannel dst = new FileOutputStream(backupDB).getChannel();
             dst.transferFrom(src, 0, src.size());
             src.close();
             dst.close();
             Toast.makeText(getBaseContext(), "Successfully backed up database!", Toast.LENGTH_LONG).show();
         }
    }catch (IOException e){
        Toast.makeText(getBaseContext(), "Error in backing up database!", Toast.LENGTH_LONG).show();
    }
}

private void importDatabase(){
    datasource = new CustomDataSource(this);
    datasource.open();
    try{
        datasource.importDatabase("DBCHALLENGES");
        Toast.makeText(getBaseContext(), "Successfully imported database!", Toast.LENGTH_LONG).show();
    }catch (IOException e){
        Toast.makeText(getBaseContext(), "Error in importing database!", Toast.LENGTH_LONG).show();
    }finally{
        datasource.close();
    }
} 
```

在我的`CustomDataSource`：

```
public boolean importDatabase(String dbPath) throws IOException{
    return dbHelper.importDatabase(dbPath);
} 
```

最后在`DBHelper`扩展中`SQLiteOpenHelper`

```
public boolean importDatabase(String dbPath) throws IOException{
    close();
    File newDB = new File(dbPath);
    File oldDB = new File("//data//challenge.main//databases//DBCHALLENGES");
    if(newDB.exists()){
        FileUtils.copyFile(new FileInputStream(newDB), new FileOutputStream(oldDB));
        getWritableDatabase().close();
        return true;
    }

    return false;
} 
```

但是，按下导入`Button`，出现正面`Toast`，表示导入成功。但是我的应用程序，之前是空的，现在仍然是空的。备份的数据库应该位于内部存储的第一级，它的作用。我想，也许我把一些东西与路径混淆了，但我无法理解到底是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T01:16:56.767

试试这个：

```
private void importDatabase(String inputFileName) throws IOException
{
    InputStream mInput = new FileInputStream(inputFileName);
    String outFileName = YOUR_DB_PATH_HERE;
    OutputStream mOutput = new FileOutputStream(outFileName);
    byte[] mBuffer = new byte[1024];
    int mLength;
    while ((mLength = mInput.read(mBuffer))>0)
    {
        mOutput.write(mBuffer, 0, mLength);
    }
    mOutput.flush();
    mOutput.close();
    mInput.close();
} 
```

# c# - 从 RichTextBox 中提取原始 RTF

> ID：13261815
> 
> 赞同：1
> 
> 时间：2012-11-07T01:01:27.420
> 
> 标签：c#, wpf, wpf-controls, rtf

必须有比我正在做的更好的方法来做到这一点。

我正在尝试从 WPF RichTextBox 中提取原始 RTF。好吧，实际上我正在尝试使用一堆我的自定义类并将其转换为 RTF 字符串，但我使用 RichTextBox 来执行此操作，因为我不是特别想编写自己的 RTF 库。

我正在使用的方法（从这里第一次看到的东西修改[并](https://stackoverflow.com/questions/3003984/how-to-set-rtf-from-winforms-to-wpf-richtextbox "这里")用于在[此处](https://stackoverflow.com/questions/601838/get-rtf-from-richtextbox)提取 XML ）如下：

```
RTB.Selection.Save(memstream, DataFormats.Rtf);
memstream.Seek(0, SeekOrigin.Begin);
var sr = new StreamReader(memstream);
var myText = sr.ReadToEnd(); 
```

这行得通，但看起来非常笨拙。而且我担心对大量文本的性能影响。有没有更好的办法？（出于这个问题的目的，我们假设我不能使用 WinForms RichTextBox。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T19:12:13.410

使用[这个](https://stackoverflow.com/questions/542850/how-can-i-insert-an-image-into-a-richtextbox)问题。

```
string mpic = @"{\pict\pngblip\picw" + 
    img.Width.ToString() + @"\pich" + img.Height.ToString() +
    @"\picwgoal" + width.ToString() + @"\pichgoal" + height.ToString() + 
    @"\bin " + str + "}" 
```

# android - Android 在没有意图标志 FLAG_ACTIVITY_BROUGHT_TO_FRONT 的情况下启动 singleTask 活动

> ID：13261823
> 
> 赞同：0
> 
> 时间：2012-11-07T01:02:29.477
> 
> 标签：android, android-intent, android-launcher

从 Android 启动器源代码，

```
if ((intent.getFlags() & Intent.FLAG_ACTIVITY_BROUGHT_TO_FRONT) !=
        Intent.FLAG_ACTIVITY_BROUGHT_TO_FRONT) {
    //reset homescreen to default page
} 
```

如果 startActivity 意图没有标志 FLAG_ACTIVITY_BROUGHT_TO_FRONT，启动器会将主屏幕重置为默认页面。

只有在堆栈顶部已经有一个正在启动的活动实例时，才不会设置该标志。

当它从另一个应用程序启动时，有没有办法让启动器认为它已经在堆栈顶部运行（导致它重置主屏幕页面）？（不是从主页键按下）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:59:19.160

按照我对您的问题的理解。我认为 FLAG_ACTIVITY_NEW_TASK 标志可以帮助你。文件说：

> 使用此标志时，如果您现在正在启动的 Activity 已经在运行任务，则不会启动新的 Activity；相反，当前任务将简单地以其上次所处的状态被带到屏幕的前面

并且如果已经有一个活动实例正在运行。方法 ：

```
protected void onNewIntent(Intent intent) 
```

将被调用。因此，每当有新意图出现时，您都可以通过此方法重置主屏幕。

希望它有所帮助。

# c++ - 打印向量的内容

> ID：13261839
> 
> 赞同：2
> 
> 时间：2012-11-07T01:04:32.703
> 
> 标签：c++, opencv, feature-detection

我想执行一个非常简单的任务，但由于我无法弄清楚的错误而无法执行。我想使用以下代码将检测到的特征的内容保存到向量中到 txt 文件中

```
Ptr<FeatureDetector> feature_detector = FeatureDetector::create("SIFT");
vector<KeyPoint> keypoints;

feature_detector->detect(img, keypoints);

for(unsigned int i = 0; i < keypoints.size(); i++)
{
    ofstream outf("vector.txt", ios::app);
    outf<<"value at "<< i << " = " << keypoints.at<KeyPoint>(i)<<endl;
} 
```

但我收到以下错误：

> std::vector<_Ty>::at': 函数调用缺少参数列表；使用 '&std::vector<_Ty>::at' 创建指向成员的指针

我检查了我的语法，没有发现任何错误。

**编辑：**在此之前，我想打印出矩阵的内容，这种格式非常适合它，这是我用来打印矩阵内容的代码：

```
for(int x = 0;x < dst.rows ; x++)
{
    for( int y = 0; y < dst.cols; y++)
    {
        ofstream outf("Sample.txt", ios::app);
        outf<<"value at "<< x << "  " << y << " = " << dst.at<float>(x,y)<<endl;
    }
} 
```

其中 dst 是一个由浮点数据类型组成的矩阵

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T01:59:16.447

尝试将代码更改为以下：

```
 ofstream outf("vector.txt", ios::app);  // you don't want to open file again and again
 for(unsigned int i = 0; i < keypoints.size(); i++)
 {
     outf<<"value at "<< i << " = " << keypoints.at(i)<<endl;
 }
 outf.close(); 
```

正如@jogojapan 提到的，OpenCV KeyPoint 的重载运算符<<(..)。

```
std::ostream& operator<<(std::ostream& out,const KeyPoint& keypoint)
{
  // add stream keypoint member by yourself here
  out << keypoint.size;
  out << keypoint.angle;
  out << keypoint.response;
  out << keypoint.octave;
  out << keypoint.class_id;
  return out;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T01:07:04.023

说：`outf << "value at "<< i << " = " << keypoints[i] <<endl;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-11T16:22:08.970

使用内置的 FileStorage 类就像添加两行一样简单。我使用以下行打印了 KeyPoints 的向量：

```
FileStorage fs("test.xml", FileStorage::WRITE);

    fs << "meh" << keypoints; 
```

# c++ - Python 在加载 C++ 编写的扩展模块时收到 SIGSEGV

> ID：13261843
> 
> 赞同：6
> 
> 时间：2012-11-07T01:05:30.360
> 
> 标签：c++, python, unix

正确的代码示例：

```
#include "Python.h"
#include <string>

extern const int someConstant;

void some_function()
{
  const char *begin = NULL;
  const char *end = NULL;

  std::string s(begin, end);
  const int v = someConstant;
}

static PyMethodDef _G_methods[] =
{
    {NULL, NULL, 0, NULL}        /* Sentinel */
};

PyMODINIT_FUNC initsf()
{
  PyObject *module;

  if (!(module = Py_InitModule("sf", _G_methods)))
  {
    return;
  }

  PyObject *pyerror = PyErr_NewException("fs.error", NULL, NULL);
  Py_INCREF(pyerror);

  PyModule_AddObject(module, "error", pyerror);
} 
```

这是扩展模块草案。尽可能简单。[它有一个从原始docpage](http://docs.python.org/2/extending/extending.html)复制的空方法表和初始化函数。它包含 2（两个）故意错误：

*   变量 someConstant 已声明但从未定义；

*   函数 some_function 已定义，但从未调用；

如果用 dlopen/dlsym 编译打开：

```
sf.so: undefined symbol: someConstant 
```

按要求。但如果由 Python 解释器加载：

```
>>> from sf import *
Segmentation fault (core dumped) 
```

最奇怪的是从核心文件中转储的python的回溯：

```
#0  0x00000bd6 in ?? ()
#1  0xb775c057 in char* std::string::_S_construct<char const*>(char const*, char const*, std::allocator<char> const&, std::forward_iterator_tag) () from /usr/local/lib/python2.7/dist-packages/sf.so
#2  0xb6f9abb6 in std::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string(char const*, std::allocator<char> const&) () from /usr/lib/i386-linux-gnu/libstdc++.so.6
#3  0xb6c3fe30 in pkgInitConfig(Configuration&) () from /usr/lib/i386-linux-gnu/libapt-pkg.so.4.12
#4  0xb6cf959e in ?? () from /usr/lib/python2.7/dist-packages/apt_pkg.so
#5  0x081949c1 in PyEval_EvalFrameEx ()
#6  0x0819af70 in PyEval_EvalCodeEx ()
#7  0x0819bb03 in PyImport_ExecCodeModuleEx ()
#8  0x0814bd40 in ?? ()
#9  0x080a38c2 in ?? ()
#10 0x0814c6d4 in ?? ()
#11 0x081031ae in ?? ()
... 
```

看来，Python 的加载器调用 std::string 构造函数:-)。

所以，堆栈损坏。它发生在加载无效模块或在处理错误后卸载它时。如果示例代码几乎没有改变，它永远不会发生。此行为已在 Python 2.7.3/Linux Ubuntu 10/gcc 4.6.3 上观察到，并且绝对未在 Python 2.7.1/FreeBSD 8.1/gcc 4.2.1 上显示。

问题：

1.  是 Python 的错误还是我的示例代码有错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T01:50:36.723

让我们再看看那个堆栈跟踪

```
#0 0x00000bd6 在?? ()
#1 0xb775c057 in char* std::string::_S_construct<char const*>(char const*, char const*, std::allocator<char> const&, std::forward_iterator_tag) () 来自 /usr/local/lib /python2.7/dist-packages/sf.so
#2 0xb6f9abb6 in std::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string(char const*, std::allocator<char> const&) () 来自 /usr/ lib/i386-linux-gnu/libstdc++.so.6
#3 0xb6c3fe30 in pkgInitConfig(Configuration&) () from /usr/lib/i386-linux-gnu/libapt-pkg.so.4.12
#4 0xb6cf959e 在?? () 来自 /usr/lib/python2.7/dist-packages/apt_pkg.so

```

因此，一个函数`libapt-pkg.so`调用一个函数，`libstdc++.so`该函数调用模块中的一个函数。

你的函数永远不会被调用。但是，您的代码使用`std::string`并实例化了一些函数`std::string`，这些函数包含在您的`*.so`中，覆盖了完全不同的函数`*.so`，并且由于某种原因而崩溃，我不完全确定为什么。

我的直觉告诉我，您曾经`gcc`创建过您的`*.so`而不是`g++`. 您不会在链接时收到错误，因为链接共享对象不是这样工作的。您不会在加载时收到错误，因为*巧合*`libstdc++`的是已经加载了。

 *您是使用`gcc`还是`g++`链接？尝试使用`g++`.*

# html - 在 javascript 中调整内容大小的纯 HTML/CSS 解决方案

> ID：13261845
> 
> 赞同：1
> 
> 时间：2012-11-07T01:05:42.653
> 
> 标签：html, css

请注意以下 jsFiddle - [http://jsfiddle.net/mark69_fnd/DaYCa/14/](http://jsfiddle.net/mark69_fnd/DaYCa/14/)： ![在此处输入图像描述](../Images/3f6277160ef87597ba3dc654a77f1e9d.png)

内容恰好位于页眉和页脚之间。如果我们向标题添加更多项目（注意滚动条），布局的这个属性会保留： ![在此处输入图像描述](../Images/d619eb6d502176b0cf2ffe9e4d5724e3.png) 现在滚动它： ![在此处输入图像描述](../Images/ec5393ea677bd370472c12f1a98e8cd5.png) 我们可以向内容添加更多项目： ![在此处输入图像描述](../Images/3b23dcfaca8f643f9aa81d3e07e0fe74.png) 向下滚动： ![在此处输入图像描述](../Images/78a975dc569fe418ad7c0ecf33916c38.png) 一旦我们调整窗口大小，滚动条就会消失： ![在此处输入图像描述](../Images/a9f91c0a6246881e33f5aba095a530ed.png) 或者减少内容 DOM 树： ![在此处输入图像描述](../Images/ac75fd63d8b6e9504fce374362546823.png) 或者减少标题 DOM 树： ![在此处输入图像描述](../Images/ed68b4f4d083706ba00211d23e19312f.png)

此行为在代码中强制执行。我想知道是否有 HTML/CSS 技巧以纯粹的声明方式实现相同的效果。

这是 javascript 代码（为了让大家开心）：

```
YUI().use('node', 'event-valuechange', function(Y){
    var headerNode = Y.one('.header');
    var footerNode = Y.one('.footer');
    var contentNode = Y.one('.content');
    var containerNode = Y.one('.container');

    function set(n, node){
        var i, content = [];

        for (i = 1; i <= n; i += 1) {
            content.push('<div>'+i+'</div>');
        }
        node.set('innerHTML', content.join(''));
    }
    function restyleContent(){
       var hh, fh, ch, bw;
        hh = headerNode.getDOMNode().getBoundingClientRect().height;
        fh = footerNode.getDOMNode().getBoundingClientRect().height;
        ch = containerNode.getDOMNode().getBoundingClientRect().height;
        bw = Number(contentNode.getComputedStyle('borderWidth').slice(0, -2));
        contentNode.setStyle('height', (ch - hh - fh - bw * 2) + 'px');
    }

    Y.one('win').on('resize', restyleContent);
    Y.one('#newContent').on('valuechange', function (e) {
        set(Number(e.newVal), contentNode);
    });
    Y.one('#newHeader').on('valuechange', function (e) {
        set(Number(e.newVal), headerNode);
        restyleContent();
    });

    set(Number(Y.one('#newContent').get('value')), contentNode);
    set(Number(Y.one('#newHeader').get('value')), headerNode);
    restyleContent();
}); 
```

​<strong>编辑

我想稍微放松一下约束。让我们假设标题的高度是已知的并且无法更改。因此，页眉和页脚都具有预先已知的固定恒定高度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T03:42:19.537

如果固定高度是可以接受的，你可以使用`position:fixed`和`padding`/`margin`来归档这个：

[http://jsfiddle.net/DaYCa/16/](http://jsfiddle.net/DaYCa/16/)

重要组成部分：

```
.container {position:relative;padding:20px 0px 24px} /*dimension base on Chrome*/
.header {position:fixed;top:0px}
.footer {position:fixed;bottom:0px} 
```

但我怀疑这是否真的可以接受。鉴于在您的演示中，JS 无论如何都是不可避免的，我认为这可能会有所帮助：

[http://jsfiddle.net/DaYCa/17/](http://jsfiddle.net/DaYCa/17/)

非常类似于“纯”的 CSS 方案，只是添加了一个简单的 JS 来确定页眉和页脚的大小（所以要修改 的`padding`部分`.container`）。

请注意，我不知道 YUI，所以我做了无库演示。

# javascript - javascript getElementById.label.style

> ID：13261849
> 
> 赞同：1
> 
> 时间：2012-11-07T01:06:11.560
> 
> 标签：javascript, css, label

这对我不起作用，并且不起作用是指它不会在标签上显示任何内容....

```
document.getElementById('clubname').label.style.display = 'none'; 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T02:00:52.140

[Labelable elements](http://dev.w3.org/html5/spec/forms.html#category-label) can have multiple labels, so the elements have a [`labels` property](http://dev.w3.org/html5/spec/the-label-element.html#dom-lfe-labels) not a `label` property.

But I don't know what the level of browser support is for this property currently.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T02:07:11.670

破译你所拥有的：

```
document.getElementById('clubname') 
```

将尝试返回 id 为“clubname”的元素。如果不存在这样的元素，它将返回`null`。

```
.label 
```

将尝试访问`label`上面返回的对象的属性。如果是`null`，将引发错误。

```
.style 
```

将尝试访问`style`上面返回的任何内容的属性。如果该值不是对象（或不可转换为对象）`null`，`undefined`则它会引发错误。

```
.display = 'none'; 
```

将访问或分配`display`先前返回的对象的属性，并为其分配`'none'`.

在 HTML5 中，有一类可标记[元素](http://dev.w3.org/html5/spec/single-page.html#category-label)具有`labels`引用其关联标签的 NodeList 的属性。所以上面可能做的（如果它没有错误地完成并访问了相关标签NodeList的单个成员，例如`...labels[0].style...`）是隐藏相关标签。如果元素是标签的子元素（它们经常是），它也会隐藏元素。

但该`labels`属性尚未广泛实施。

这有帮助吗？

无论如何，做你想做的更安全的方法是：

```
// First attempt to get a reference to the element
var el = document.getElementById('clubname');

// If the above returned an element, and it has a labels property
// and that property has at least one member
if (el && el.labels && el.labels[0]) {

    // Safe to assume el.labels[0] is a DOM element, so
    // mess with its style object
    el.labels[0].style.display = 'none'; 
```

# javascript - 如何让 javascript 字符计数器添加多个文本框的总数

> ID：13261852
> 
> 赞同：0
> 
> 时间：2012-11-07T01:06:29.717
> 
> 标签：javascript, html, arguments

我似乎无法在任何地方找到有关如何执行此操作的任何信息。我什至不知道使用 && 是否可以将文本框值添加在一起。我可以让计数器轻松计算一个框或另一个框，但我需要两个框中的文本来给出剩余的总字符数，因为每个框中的组合字符不超过 500。

这是我的 javascript 计数器。

```
<SCRIPT type="text/javascript">
function textCounter(field,cntfield,maxlimit) 
{
  if (field.value.length > maxlimit)
    field.value = field.value.substring(0, maxlimit);
  else
    cntfield.value = maxlimit - field.value.length;
}
</script> 
```

这是我的文本框。

```
 <form name="myForm">
    <textarea name="message1" wrap="physical" cols="28" rows="5"
    onKeyDown="textCounter(document.myForm.message1 && document.myForm.message2,document.myForm.chars,500)"
onKeyUp="textCounter(document.myForm.message1 && document.myForm.message2,document.myForm.chars,500)"></textarea>
<br>
<textarea name="message2" wrap="physical" cols="28" rows="5"
onKeyDown="textCounter(document.myForm.message1 && document.myForm.message2,document.myForm.chars,500)"
onKeyUp="textCounter(document.myForm.message1 && document.myForm.message2,document.myForm.chars,500)"></textarea>
<br>
<input readonly type="text" name="chars" size="3" maxlength="3" value="500">
characters left 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:15:31.170

看起来您正试图将两个对象作为第一个参数传递给您的函数 textCounter。您不能将它们与 && （这是逻辑“和”）放在一起。但是，您可以将对象数组传递给 textCounter。

```
textCounter( [document.myForm.message1,document.myForm.message2], ... ) 
```

在 textCounter 中，您可以通过索引访问对象

```
textCounter( fields, ... ) {
    if ( fields[0].value. length ... ){}
    if ( fields[1].value. length ... ){}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T01:27:46.067

`form`使用表单控件的属性可以使您的代码更加简洁：

```
<form name="myForm">
    <textarea name="message1" wrap="physical" cols="28" rows="5"
    onKeyDown="textCounter(this.form.message1 && this.form.message2, this.form.chars, 500)"
    ...></textarea> 
```

在上面的thea中：

```
this.form.message1 && this.form.message2 
```

由第一个评估处理`this.form.message1`，它返回对 DOM 元素的引用，该元素的类型转换为`true`. 所以下一个表达式被评估并返回结果。

所以你有效地传递`this.form.message2`给函数。似乎您想通过两个控件，然后获取两者的字符总数。

所以你需要将这两个元素都传递给函数并相应地调整你的逻辑，例如

```
function textCounter(field0, field1, cntfield, maxlimit) {
  var totalChars = field0.value.length + field1.value.length;
  var diff = maxlimit - totalChars;

  if (diff < 0) {
    field0.value = field0.value.substring(0, field0.value.length + diff);

  } else {
    cntfield.value = diff;
  }
} 
```

和标记：

```
<form name="myForm">
    <textarea name="message1" wrap="physical" cols="28" rows="5"
    onKeyDown="textCounter(this, this.form.message2, this.form.chars, 500)"
    onKeyUp="textCounter(this, this.form.message2, this.form.chars, 500)"></textarea>
<br>
    <textarea name="message2" wrap="physical" cols="28" rows="5"
    onKeyDown="textCounter(this, this.form.message1, this.form.chars, 500)"
    onKeyUp="textCounter(this, this.form.message1, this.form.chars, 500)"></textarea>
<br>
<input readonly type="text" name="chars" size="3" maxlength="3" value="500">
characters left 
```

请注意，一旦达到限制，这会产生相当烦人的行为，特别是如果在中间添加更多字符并且用户没有注意到它们从末尾被修剪。

最好让用户知道他们还剩下多少字符或需要删除多少字符，并让他们弄清楚如何满足该要求（例如，查看 StackOverflow 评论的工作方式）。

### 编辑

我只会显示剩下多少个字符，如果它变为负数，则带有减号和颜色变化，例如

```
<style ...>
  .negative {
    font-weight: bold;
    color: red;
   }
</style>

<script>

function textCounter(field0, field1, cntfield, maxlimit) {
  var totalChars = field0.value.length + field1.value.length;
  var diff = maxlimit - totalChars;

  if (diff < 0) {
      addClass(cntfield, 'negative');

  } else {
      removeClass(cntfield, 'negative');
  }
  cntfield.value = diff;
} 
```

一些辅助函数：

```
function hasClass(el, cName) {
  var re = new RegExp('(^|\\s)' + cName + '(\\s|$)');
  return re.test(el.className);
}

function addClass(el, cName) {
  if (!hasClass(el, cName)) {
    el.className = (el.className + ' ' + cName).replace(/(^\s*)|(\s*$)/g,'').replace(/\s+/g,' ');
  }
}

function removeClass(el, cName) {
  var re;
  if (hasClass(el, cName)) {
    re = new RegExp('(^|\\s)' + cName + '(\\s|$)');
    el.className = el.className.replace(re, ' ').replace(/(^\s*)|(\s*$)/g,'').replace(/\s+/g,'');
  }
}

</script> 
```

# javascript - 子元素无法识别 KineticJS 中的功能？

> ID：13261854
> 
> 赞同：1
> 
> 时间：2012-11-07T01:07:00.483
> 
> 标签：javascript, kineticjs

使用 KineticJS，我一直在尝试创建一个只有一个圆圈和 4 个矩形的组，但是当单击时，矩形会出现在它们周围（用于选项）并在下次单击时隐藏它们。它们被创建得很好（我认为？），我可以到达我只选择矩形的地步，但是当单击主圆来改变它们的状态时，我需要使用 Rect 对象的 setVisible() 函数。

```
 function makePlayer(xPos, yPos) {
            var bufferSize = 15;
            var player = new Kinetic.Group();
            var ball = new Kinetic.Circle({
                x: xPos,
                y: yPos,
                radius: 40,
                fill: 'black',
                stroke: 'black',
                strokeWidth: 1
            });
            player.add(ball);
            ball.setAttr("menuShow", false);

            for (var i = 0; i < 4; i++) {
                var menuBox = new Kinetic.Rect({
                    x: ball.getX(),
                    y: ball.getY(),
                    width: 50,
                    height: 50,
                    visible: false
                });
                if (i == 0) {
                    menuBox.setFill('red');
                    menuBox.setOffset(menuBox.getWidth() / 2, ball.getHeight() + bufferSize);
                    menuBox.on("click tap", function () { alert("red box clicked/tapped") });
                } else if (i == 1) {
                    menuBox.setFill('blue');
                    menuBox.setOffset(((ball.getWidth() / 2) * -1) - bufferSize, menuBox.getHeight() / 2);
                    menuBox.on("click tap", function () { alert("blue box clicked/tapped") });
                } else if (i == 2) {
                    menuBox.setFill('yellow');
                    menuBox.setOffset(menuBox.getWidth() / 2, ((ball.getHeight() / 2) * -1) - bufferSize);
                    menuBox.on("click tap", function () { alert("yellow box clicked/tapped") });
                } else if (i == 3) {
                    menuBox.setFill('white');
                    menuBox.setOffset(ball.getWidth() + bufferSize, menuBox.getHeight() / 2);
                    menuBox.on("click tap", function () { alert("white box clicked/tapped") });
                }
                menuBox.setAttr("menu", true);
                player.add(menuBox);
            }
            ball.on("click tap", function () {
                var menuPopup = ball.getAttrs();
                if (menuPopup.menuShow == false) {
                    for (var i = 1; i <= 4; i++) {
                        var menuBox = player.get('Rect');
                        menuBox.setVisible(true);
                    }
                }
            }); 
```

圆圈正常生成，但只要单击它们，代码就会在 setVisible 处出现，如前所述。

这是我得到的 javascript 错误： Uncaught TypeError: Object [object Object],[object Object],[object Object],[object Object] has no method 'setVisible'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T02:55:30.740

我不知道 kinectjs，但我想知道它是否与您添加和显示菜单的方式有关。您不使用循环变量来识别特定菜单。例如，您似乎可以将 menuBox 创建为数组或名称与数字连接。然后，在单击/点击处理程序循环中，您可能希望以相同的方式引用各个菜单。

再次查看它，似乎 player.get('Rect') 行正在返回匹配的项目数组。因此，我怀疑您问题的真正解决方案是忽略我的第一段，而是将点击处理程序的循环行更改为以下内容：

```
menuBox[i-1].setVisible(true); 
```

# python - `pandas.DataFrame.apply` 逐行操作

> ID：13261855
> 
> 赞同：1
> 
> 时间：2012-11-07T01:07:03.693
> 
> 标签：python, pandas

我想返回一个每行排序的数据帧（比如说降序）。所以如果我有`pandas.DataFrame`名字`data`：

```
In [38]: data
Out[38]: 
                  c1        c2        c3        c4        c5        c6
Date                                                                  
2012-10-22  0.973371  0.226342  0.968282  0.872330  0.273880  0.746156
2012-10-19  0.497048  0.351332  0.310025  0.726669  0.344202  0.878755
2012-10-18  0.315764  0.178584  0.838223  0.749962  0.850462  0.400253
2012-10-17  0.162879  0.068409  0.704094  0.712860  0.537545  0.009789 
```

我想返回以下内容：

```
In [39]: sorted_frame
Out[39]: 
                   0         1         2         3         4         5
Date                                                                  
2012-10-22  0.973371  0.968282  0.872332  0.746156  0.273880  0.226342
2012-10-19  0.878755  0.726669  0.497048  0.351332  0.344202  0.310025
2012-10-18  0.850462  0.838223  0.749962  0.400253  0.315764  0.178584
2012-10-17  0.712860  0.704094  0.537545  0.162879  0.068409  0.009789 
```

但是我试过`DataFrame.sort(axis = 1)`了，没有达到预期的效果：

```
In [40]: data.sort(axis = 1)
Out[43]: 
                  c1        c2        c3        c4        c5        c6
Date                                                                  
2012-10-22  0.973371  0.226342  0.968282  0.872330  0.273880  0.746156
2012-10-19  0.497048  0.351332  0.310025  0.726669  0.344202  0.878755
2012-10-18  0.315764  0.178584  0.838223  0.749962  0.850462  0.400253
2012-10-17  0.162879  0.068409  0.704094  0.712860  0.537545  0.009789 
```

我创建了以下功能来完成我正在寻找的东西（使用`pandas.TimeSeries.order()`）：

```
import numpy

def sorted_by_row(frame, ascending = False):
    vals = numpy.tile(numpy.nan,frame.shape)
    for row in numpy.arange(frame.shape[0]):
        vals[row, :] = frame.ix[row, :].order(ascending = ascending)
    return pandas.DataFrame(vals, index = frame.index) 
```

但是，我的目标是能够在`DataFrame.apply()`方法中使用逐行函数（这样我就可以将所需的功能应用于我构建的其他函数）。我试过了：

```
 #TimeSeries.order() sorts a pandas.TimeSeries object
 data.apply(lambda x: x.order(), axis = 1) 
```

但同样，我没有得到上述期望`DataFrame`（我已经输出了足够多`DataFrame'`的 s，所以我会为页面腾出空间）。

非常感谢您的帮助，

-B

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T05:26:09.213

好吧，开箱即用的熊猫并不容易。首先，熟悉`argsort`：

```
In [8]: df
Out[8]: 
                   0         1         2         3         4
2012-10-17  1.542735  1.081290  2.602967  0.748706  0.682501
2012-10-18  0.058414  0.148083  0.094104  0.716789  2.482998
2012-10-19  2.396277  0.524733  2.169018  1.365622  0.590767
2012-10-20  0.513535  1.542485  0.186261  2.138740  1.173894
2012-10-21  0.495713  1.401872  0.919931  0.055136  1.358439
2012-10-22  1.010086  0.350249  1.116935  0.323305  0.506086

In [12]: inds = df.values.argsort(1)

In [13]: inds
Out[13]: 
array([[4, 3, 1, 0, 2],
       [0, 2, 1, 3, 4],
       [1, 4, 3, 2, 0],
       [2, 0, 4, 1, 3],
       [3, 0, 2, 4, 1],
       [3, 1, 4, 0, 2]]) 
```

这些是每一行的间接排序索引。现在你想做类似的事情：

```
new_values = np.empty_like(df)
for i, row in enumerate(df.values):
    # sort in descending order
    new_values[i] = row[inds[i]][::-1]

sorted_df = DataFrame(new_values, index=df.index) 
```

不是那么令人满意，但它完成了工作：

```
In [15]: sorted_df
Out[15]: 
                   0         1         2         3         4
2012-10-17  2.602967  1.542735  1.081290  0.748706  0.682501
2012-10-18  2.482998  0.716789  0.148083  0.094104  0.058414
2012-10-19  2.396277  2.169018  1.365622  0.590767  0.524733
2012-10-20  2.138740  1.542485  1.173894  0.513535  0.186261
2012-10-21  1.401872  1.358439  0.919931  0.495713  0.055136
2012-10-22  1.116935  1.010086  0.506086  0.350249  0.323305 
```

更一般地，您可以执行以下操作：

```
In [23]: df.apply(lambda x: np.sort(x.values)[::-1], axis=1)
Out[23]: 
                   0         1         2         3         4
2012-10-17  2.602967  1.542735  1.081290  0.748706  0.682501
2012-10-18  2.482998  0.716789  0.148083  0.094104  0.058414
2012-10-19  2.396277  2.169018  1.365622  0.590767  0.524733
2012-10-20  2.138740  1.542485  1.173894  0.513535  0.186261
2012-10-21  1.401872  1.358439  0.919931  0.495713  0.055136
2012-10-22  1.116935  1.010086  0.506086  0.350249  0.323305 
```

但是您有责任自己分配新列

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T02:02:03.943

排序是一个很大的主题，我相信有很多方法可以做到这一点。这是一个。

首先创建一个示例数据框。

```
In [31]: rndrange = pd.DatetimeIndex(start='10/17/2012', end='10/22/2012', freq='D')    
In [32]: df = pd.DataFrame(np.random.randn(len(rndrange),5),index=rndrange)
In [33]: df = df.applymap(abs)  #Easier to see sorting if all vals are positive
In [34]: df
Out[34]: 
                   0         1         2         3         4
2012-10-17  1.542735  1.081290  2.602967  0.748706  0.682501
2012-10-18  0.058414  0.148083  0.094104  0.716789  2.482998
2012-10-19  2.396277  0.524733  2.169018  1.365622  0.590767
2012-10-20  0.513535  1.542485  0.186261  2.138740  1.173894
2012-10-21  0.495713  1.401872  0.919931  0.055136  1.358439
2012-10-22  1.010086  0.350249  1.116935  0.323305  0.506086 
```

排序：

```
In [35]: df.as_matrix().sort(1)    
In [36]: df
Out[36]: 
                   0         1         2         3         4
2012-10-17  0.682501  0.748706  1.081290  1.542735  2.602967
2012-10-18  0.058414  0.094104  0.148083  0.716789  2.482998
2012-10-19  0.524733  0.590767  1.365622  2.169018  2.396277
2012-10-20  0.186261  0.513535  1.173894  1.542485  2.138740
2012-10-21  0.055136  0.495713  0.919931  1.358439  1.401872
2012-10-22  0.323305  0.350249  0.506086  1.010086  1.116935 
```

# python - 如何从查询中计算推文而不重复计算？

> ID：13261858
> 
> 赞同：1
> 
> 时间：2012-11-07T01:07:15.690
> 
> 标签：python, twitter, twython

我正在开展一个项目，该项目需要计算满足查询参数的推文数量。我在 Python 中工作，使用 Twython 作为我的 Twitter 界面。

不过有几个问题，你如何记录哪些推文已经被计算在内？你会简单地记下最后一条推文 ID 并忽略它以及之前的所有推文吗？--这个最简单的实现是什么？

作为另一个优化问题，我想确保计数器错过的推文数量最少，有什么方法可以确保这一点？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:08:35.807

您可以考虑使用套装！他们防止重复。

一些伪代码：

```
s = set()
for tweet in tweets:
   s.add(tweet.id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-16T03:06:56.400

考虑到类似推文和转发的情况，我建议对整条推文进行语义注释，提取每条推文的文本部分并进行字典查找。但是 tweet id 更简单，损失很大，用法如上所述。

# matlab - 如何将函数应用于矩阵的每一行并取回更大的矩阵

> ID：13261863
> 
> 赞同：2
> 
> 时间：2012-11-07T01:08:07.340
> 
> 标签：matlab, matrix

我有一个函数，它接受一个维度为 [1,2] 的矩阵并返回一个维度为 [1,136] 的矩阵。我还有一个维度矩阵 [N,2]。我想将此函数应用于矩阵的每一行，最终得到一个维度为 [N,136] 的矩阵。

我完全不知道如何在 Matlab 中做到这一点。一个 for 循环解决方案就足够了（此时我什至不能这样做），但据我所知，在 Matlab 中有更好和更可并行化的做事方式。

我目前的尝试如下所示：

```
 phi = arrayfun(@(x,y) gaussianBasis([x y])' , trainIn(:,1), trainIn(:,2), 'UniformOutput', false); 
```

其中`gaussianBasis`是返回向量 [136,1] 的函数，`trainIn`是矩阵 [N,2]。`phi`应该是 [N,136]，但这会返回一个由 N 个元胞数组组成的数组，每个元胞数组都包含一个矩阵 [1,136]。

感谢所有的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T01:12:17.503

您只需要`cat`沿第一个维度使用并连接它：

```
phi = cat(1, phi{:}) 
```

这应该给你一个 N x 136 矩阵

# java - 线程：从 ArrayList 检索然后执行对象

> ID：13261869
> 
> 赞同：1
> 
> 时间：2012-11-07T01:08:35.500
> 
> 标签：java, multithreading

我正在使用线程，需要首先从集合中检索一个对象，然后在该对象中执行该方法。我使用 ArrayList.get(0) 来检索第一个元素，但现在如何为刚刚检索到的 Runnable 对象执行 run() 方法？

到目前为止，这是我的代码：

```
public class MyThread extends Thread{

//Instance Variables
private List<Runnable> requestQueue;

//Constructor
public MyThread() {
    requestQueue = new LinkedList<Runnable>();
}

//Methods
public void run() {
    while (!requestQueue.isEmpty()) { 
        try {
            wait();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        requestQueue.get(0);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T01:14:42.043

当您的队列*不*为空时，您可以运行：

```
new Thread(requestQueue.get(0)).start(); 
```

顺便说一句：你应该得到一个循环名称冲突，表明你不能扩展`Thread`. 您可以将类重命名为`MyThread`.

还可以查看[ExecutorService](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorService.html)作为一种抽象与原始线程等较低级别抽象相关的许多复杂性的方法。

# passwords - 为什么在密码中允许重复字符是不安全的？

> ID：13261873
> 
> 赞同：-2
> 
> 时间：2012-11-07T01:09:08.790
> 
> 标签：passwords, character, policy

我检查了几个密码策略，这些策略确定密码中不允许出现 2 个或更多重复字符，例如：“xxxxx5”。但是该策略对我来说没有意义，因为密码空间减少了，（我知道 xxxxx5 是一个极端不安全的密码，但是确实有很好的密码使用重复字符并增加密码熵），我认为这种的密码更容易使用暴力攻击破解（需要检查的密码更少）。

我错过了什么吗？

我不是安全专家，所以...

有人可以解释一下这个政策是对还是错吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:14:45.023

为了便于计算，我们假设我们只允许使用字母数字密码。所以我们有 26 + 26 + 10 个字符可供选择。

如果我们还假设密码的最大长度为 8 个字符，我们的密码空间为 62 ^ 8。

此外，每个密码只能使用一个由 5 个重复字符组成的字符串，这意味着我们将密码空间减少了 62 个，从而使我们有 (62 ^ 8) - 62 个密码可能性。与防止某人输入极弱密码所增加的安全性相比，减少的空间量完全是微不足道的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T01:14:59.567

我同意这个政策除了作为“避免字典单词和其他琐碎密码”的一部分之外没有太大意义（但这是一个有效的政策）。

虽然排除这些确实会减少密码空间的大小，但黑客确实会使用单词列表，并且首先尝试该列表中的单词，因此传统上，您会想要禁止这些单词。但是，我不确定这仍然有多重要。对我来说，使您的密码尽可能长似乎更重要，并且输入*额外的*重复字符应该比相同但更短的密码更可取，并且删除了此填充。

无论您怎么看，同时“简单”和简短的密码显然都是不好的。所以排除“xxxxx5”是一个好策略，但“hys99h23sblahblahblahblahblahblahblah”可能是一个好密码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T03:19:12.067

禁止使用恰好包含重复字符（如）的*良好*`jjjbtieooygn`密码确实会略微降低安全性，因为它会略微减少搜索空间（假设攻击者知道规则）。

但这种限制的重点是禁止使用非常糟糕的密码，例如`jjjkkklllmmm`.

一个理想的解决方案是拒绝容易破解的密码——但判断密码是否容易破解是一个非常困难的问题。如果可以信任用户使用好的密码，那将不是问题，但根据[本文](http://www.cbsnews.com/8301-205_162-57539366/the-25-most-common-passwords-of-2012/)，三个最流行的密码是`password`、`123456`和`12345678`。

与碰巧从高质量随机数生成器获得的人相比，拒绝`xxxxx5`更有可能抓住试图使用非常糟糕的密码的人*。*`xxxxx5`

# c# - 尝试在不安全的代码中捕获异常

> ID：13261875
> 
> 赞同：3
> 
> 时间：2012-11-07T01:09:13.873
> 
> 标签：c#, image-processing, try-catch, unsafe

我正在编写一些图像处理代码并使用 C# 进行低级像素操作。每隔一段时间，就会发生一次 accessViolationException。

有几种方法可以解决这个典型问题，有些人认为代码应该写得健壮，这样就不会出现访问冲突异常，而且就我而言，应用程序运行良好，但是我想添加一个 try catch 以便如果某些事情是发生这种情况时，应用程序不会以太丑陋的方式失败。

到目前为止，我已经放入了一些示例代码来测试它

```
unsafe
{
    byte* imageIn = (byte*)img.ImageData.ToPointer();
    int inWidthStep = img.WidthStep;
    int height = img.Height;
    int width = img.Width;
    imageIn[height * inWidthStep + width * 1000] = 100; // make it go wrong
} 
```

当我在这个语句周围放一个 try catch 时，我仍然得到一个异常。有没有办法捕获在不安全块中生成的异常？

编辑：如下所述，除非通过将此属性添加到函数并添加“使用 System.Runtime.ExceptionServices”显式启用对它们的检查，否则不再处理此类异常。

```
[HandleProcessCorruptedStateExceptions]
    public void makeItCrash(IplImage img)
    {
        try
        {
            unsafe
            {
                byte* imageIn = (byte*)img.ImageData.ToPointer();
                int inWidthStep = img.WidthStep;
                int height = img.Height;
                int width = img.Width;
                imageIn[height * inWidthStep + width * 1000] = 100; // to make it crash
            }
        }
        catch(AccessViolationException e)
        {
            // log the problem and get out
        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T01:21:41.877

`ArgumentOutOfRangeException`如果参数使您在图像之外写入，请检查大小并返回。

An`AccessViolationException`是损坏状态异常 (CSE)，而不是结构化异常处理 (SEH) 异常。从 .NET 4 开始，`catch(Exception e)`除非您使用属性指定它，否则不会捕获 CSE。这是因为您应该首先编写避免 CSE 的代码。您可以在此处阅读有关它的更多信息：http: [//msdn.microsoft.com/en-us/magazine/dd419661.aspx#id0070035](http://msdn.microsoft.com/en-us/magazine/dd419661.aspx#id0070035)

# c - 哪个更可取 - printf 或 fprintf

> ID：13261879
> 
> 赞同：8
> 
> 时间：2012-11-07T01:10:12.827
> 
> 标签：c, printf, output

我知道这两个函数都可以用来输出到控制台。
我读[**了那个问题**](https://stackoverflow.com/questions/4627330/difference-between-fprintf-printf-sprintf)，但没有人不知道在输出到控制台时更喜欢使用哪个。那么哪个功能更好，有什么大的区别吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-07T01:13:17.233

引用标准（n1570 中的 7.21.6.3）：

> 该`printf`函数等效于`fprintf`在 的参数`stdout`之前插入参数`printf`。

所以`printf`打印到控制台时更方便，否则没有区别。但是`fprintf`如果要更改输出目标，则更容易修改。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-07T01:57:38.090

每个进程都有一个输入流、命名流`stdin`和两个输出流，`stdout`以及`stderr`. 这些输出流都连接到您的终端，因此以下命令都会将“hello”行打印到您的终端：

```
printf("hello\n");
fprintf(stdout, "hello\n");

fprintf(stderr, "hello\n"); 
```

前两个完全相同，第一个更短更方便。第一种是最常用的。

第三个不同之处在于发送到的内容与发送到的内容在`stderr`逻辑上是分开的`stdout`。它通常用于您希望用户看到的错误消息。库函数`perror`将其错误消息打印到`stderr`.

流在逻辑上分离的意义`stderr`在于它的内容可以从`stdout`. 例如，假设我们使用命令`ls -l`列出一个文件。

```
$ touch myfile
$ ls -l myfile
-rw-r--r--  1 wrm  staff  0  6 Nov 20:44 myfile 
```

现在，如果我们将输出重定向`ls`到另一个文件，我们会看到以下内容：

```
$ ls -l myfile > otherfile
$ 
```

没有打印输出，因为将流程的流`>`重定向到. 您可以通过查看以下内容来查看它重定向的输出：`stdout``ls``otherfile``otherfile`

```
$ cat otherfile 
-rw-r--r--  1 wrm  staff  0  6 Nov 20:44 myfile
$ 
```

但是`>`没有重定向`stderr`流。您可以通过删除`myfile`并重新运行重定向`ls -l`命令来测试它：

```
$ rm myfile
$ ls -l myfile > otherfile
ls: myfile: No such file or directory
$ 
```

所以在这里你可以看到虽然`stdout`被重定向到`otherfile`，`stderr`但没有被重定向，所以它的内容出现在终端上。另请注意，`otherfile`现在是空的，因为`ls`命令没有找到`myfile`，所以没有什么可以发送到`stdout`.

也可以重定向`stderr`，但这取决于您的 shell（控制终端的程序）如何完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-07T01:13:16.623

如果您需要打印到特定的输出流，请使用 fprintf。

如果您需要显示错误消息，请使用 fprintf w/stderr

如果您正在开发命令行可执行文件并且只想向用户显示某些内容，请使用 printf。

# winapi - 无法使用 Visual Studio 命令提示符与 system32.dll 链接

> ID：13261881
> 
> 赞同：0
> 
> 时间：2012-11-07T01:10:29.443
> 
> 标签：winapi, assembly, linker, nasm, x86-64

在 Visual Studio 命令提示符下使用 link.exe：

```
link.exe "C:\Users\Jon\Desktop\euler\asm\test" kernel32.dll 
```

提供了有用的信息：`LINK : fatal error LNK1181: cannot open input file 'kernel32.dll'` 为什么它不能链接到系统 dll？

我继续使用 GoLink：

```
"C:\Program Files (x86)\nasm\golink.exe" /console test.obj Kernel32.dll 
```

哪个链接很好，但是一旦我运行它就会崩溃。我正在使用 NASM`"C:\Program Files (x86)\nasm\nasm.exe" -fwin64 "test.asm"`

这是我的汇编程序[Pastebin](http://pastebin.com/q8ucpUBu)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T03:16:47.803

MSVC 的链接不能直接链接到 DLL - 您需要改用`kernel32.lib`导入库：

```
link.exe "C:\Users\Jon\Desktop\euler\asm\test.obj" kernel32.lib 
```

您需要确保环境设置正确，以便`link.exe`找到导入库。这通常由`vcvarsall.bat`（或类似的）脚本/批处理文件完成，该文件配置用于运行工具的命令行窗口。如果您没有为构建工具配置环境的东西，则需要通过使用完整路径或通过使用`/libpath`链接器选项传递目录来传递库的位置。

我不知道 GoLink 是什么，所以我无法评论它做对或错的事情......

# ruby-on-rails-3 - Rails 应用程序无法识别现场验收

> ID：13261884
> 
> 赞同：0
> 
> 时间：2012-11-07T01:10:55.793
> 
> 标签：ruby-on-rails-3

> **可能重复：**
> [验证接受总是失败](https://stackoverflow.com/questions/4746710/validates-acceptance-always-failing)

我在 Rails 3.2 应用程序中使用[Simple Form](https://github.com/plataformatec/simple_form) and [Devise](https://github.com/plataformatec/devise) gems。在用户注册视图中，我添加了一个复选框，供用户检查是否同意应用程序的使用条款。然而，现在，即使它被选中，代码也没有意识到它已经被选中，所以它给出了这个必填字段不被接受的错误消息。

这可能与我`content_for`根据这个[问题](https://stackoverflow.com/questions/13053863/simple-form-how-to-make-accept-terms-checkbox-inline)以表单实现代码有关。

用户型号：

```
class User < ActiveRecord::Base
  devise :database_authenticatable, :registerable,
     :recoverable, :rememberable, :trackable, :validatable, :omniauthable

  validates :agree_to_terms, :acceptance => true
end 
```

风景：

```
<%= content_for(:the_links) do %>
  I agree to the <%= link_to "Terms of Service", terms_path,:remote => true %> 
  and <%=link_to "Privacy Policy", privacy_path, :remote => true%>
<% end %>

<%= simple_form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f| %>
  <%= f.input :agree_to_terms, :as => :boolean, :inline_label => content_for(:the_links), :label => false %>
  <%= f.button :submit, "Sign up", :class =>"btn btn-success btn-large" %>
<% end %>

<%= render "devise/shared/links" %> 
```

# c++ - 修改自己类的本地实例

> ID：13261885
> 
> 赞同：0
> 
> 时间：2012-11-07T01:11:09.550
> 
> 标签：c++

我有一个类，其中一个私有属性是该类的一个实例。在 Java 中（因为我习惯了 Java），这看起来像：

```
class Node {
    private Node Pi;
} 
```

现在我正在用 C++ 编写它，当我尝试做同样的事情时，我得到一个红色下划线（我使用的是 Visual C++ 2010 Express），“不允许不完整的类型”。

```
class Node {
    private:
        Node Pi; //Incomplete type is not allowed
}; 
```

我已经尝试通过将其更改为来解决此问题，`Node Pi(void);`但是为什么我尝试使用另一个修改此属性的函数我得到“表达式必须是可修改的左值”。

```
class Node {
    private:
        Node Pi(void);
    public:
        void setPi(Node n);
};
void Node::setPi(Node n) {
    Pi = n; //Node Node::Pi() expression must be a modifiable lvalue
} 
```

通常在Java中没有问题，所以我的问题是，我该如何实现呢？我不是 C++ 的初学者，但我有一段时间没有用它写过。

```
class Node {
    private Node Pi;
    void setPi(Node n) {
        this.Pi = n;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T01:12:22.667

变成`Pi`引用或指向`Node`.

1.  引用 ( `Node& Pi`) 将产生更好的语法，但不能为空，必须在构造时初始化，并且不能更改为引用不同的对象。
2.  指针 ( `Node* Pi`) 不需要漂亮的语法，但可以为 null 并且可以在不同时间指向不同的对象。

有关更多详细信息，请参阅[C++ 中的指针变量和引用变量有什么区别？](https://stackoverflow.com/questions/57483/what-are-the-differences-between-pointer-variable-and-reference-variable-in-c)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T01:14:33.817

试试这个：（直接发送指向对象而不是类对象的指针）

```
class Node {
    private:
        Node* Pi(void);
    public:
        void setPi(Node* n);
};

void Node::setPi(Node* n) {
    Pi = n; //Node Node::Pi() expression must be a modifiable lvalue
} 
```

Java“自动”转换这些对象，使用 C++，你必须自己做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T01:20:55.237

Java 的语法隐藏了它在任何地方都使用指针的事实。在 C++ 中，您必须显式使用指针语法才能模仿 Java：

```
// Java
class Node {
    private Node Pi; // This is actually a pointer
}

// C++
class Node {
    private:
        Node *Pi; // So you use a pointer in C++ too
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T01:15:52.370

更改以下代码：

```
class Node {
    private:
        Node Pi; //Incomplete type is not allowed
}; 
```

到：

```
class Node {
    private:
        Node* Pi; 
}; 
```

# regex - 如何使用变量作为正则表达式值？

> ID：13261886
> 
> 赞同：3
> 
> 时间：2012-11-07T01:11:39.203
> 
> 标签：regex, lisp, scheme, racket

例如：

```
(regexp-match #rx"a|b" "cat") 
```

我想绑定一个变量，`"a|b"`以便我可以动态创建模式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T01:18:13.363

您可以根据需要动态构建模式（请参阅[文档](http://docs.racket-lang.org/guide/regexp-intro.html)），如下所示：

```
(regexp "a|b")
> #rx"a|b" 
```

请注意，*模式*只是一个字符串，该`regexp`过程负责将其转换为正则表达式对象。该`#rx""`符号只是正则表达式的文字表示，您可以通过使用该`regexp`过程来实现相同的效果。之后，正则表达式可以绑定到一个变量：

```
(let ((regexp (regexp "a|b")))
  (regexp-match regexp "cat")) 
```

或用作过程参数：

```
(define (matcher regexp)
  (regexp-match regexp "cat"))

(matcher (regexp "a|b")) 
```

或者你喜欢的任何其他方式。

# .net - WCF 随机返回的 JSON 无效

> ID：13261887
> 
> 赞同：6
> 
> 时间：2012-11-07T01:11:47.163
> 
> 标签：.net, json, wcf, iis, aspnet-regiis.exe

我在 Windows Server 2008 R2 上运行 ASP.Net 应用程序。我最多安装了 .NET Framework 4.5。从 .NET Framework v2.0 迁移到 v4.0 后，我开始体验 WCF 的随机行为。

我的网络服务返回 JSON。重新启动 IIS 后，该服务将返回大约 3 到 5 次完全有效的 JSON。之后，JSON 变为无效。我已经检查了通过 Fiddler 传输的内容以及我自己在客户端应用程序（调用服务的 Adob​​e AIR 应用程序）和服务器本身上的日志。

Fiddler 显示原始响应确实包含无效的 JSON。似乎 JSON 中的某个随机点开始再次写入响应 JSON！，覆盖应该存在的内容并在此过程中产生损坏的 JSON。

请参阅此串联示例：

```
{"responseCode":0,"actionCode":"OK","cdn{"responseCode":0, "actionCode"..... 
```

请注意“responseCode”（它应该只出现在 JSON 响应的开头）如何突然再次出现在 JSON 中。`"cdn{"responseCode":0`当然是无效的 JSON。

我尝试了很多补丁。我尝试过在不同的框架和不同的组合下运行*`ServiceModelReg.exe`*和运行。*`aspnet_regiis.exe`*相同的行为。如果我恢复到 v2.0 下的先前代码并将应用程序池切换回 v2.0，那么一切正常。

我相信这是 WCF 中的一个错误。有任何想法吗？

在这一点上，我唯一的办法是去掉 WCF 并切换到 ServiceStack 之类的东西，如果需要，我可以在其中调试所有代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T10:28:43.310

有完全相同的问题。我通过从我的 web.config 中删除这两个条目来解决这个问题：

```
<system.serviceModel>
    <diagnostics>
        <messageLogging logEntireMessage="true" logMessagesAtTransportLevel="true" maxSizeOfMessageToLog="-1" maxMessagesToLog="-1" />
    </diagnostics>
</system.serviceModel> 
```

和

```
<system.diagnostics>
    <sources>
        <source name="System.ServiceModel.MessageLogging">
            <listeners>
                <add name="messages" type="MyCustomListener" />
            </listeners>
        </source>
    </sources>
</system.diagnostics> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-03T19:23:17.747

您是否将 InstanceContextMode 设置为 Single/PerSession？

参考这个... [混合两个响应](https://stackoverflow.com/questions/18630920/wcf-mix-up-two-responses/22846952#22846952)

# jquery-ui - 使用 CSS3 过渡动画 jQueryUI 可排序

> ID：13261889
> 
> 赞同：5
> 
> 时间：2012-11-07T01:12:07.063
> 
> 标签：jquery-ui, css, jquery-animate, css-transitions, jquery-ui-sortable

如何使用 CSS3 过渡（或任何其他方式）使[jQuery 可排序](http://jqueryui.com/sortable/)行为更像 iOS 中的列表重新排序，其中列表项在拖动时平滑动画，因此项目在您拖动时匆匆离开？

[编辑将其变成常见问题解答并为其他想要解决此问题的人节省时间]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T05:45:47.850

[https://gist.github.com/801570](https://gist.github.com/801570)展示了如何使用[jQuery Sortable](http://jqueryui.com/sortable/)平滑地动画拖动。当您拖动时，物品会匆匆离开。它使用[CSS3 过渡](http://www.css3.info/preview/css3-transitions/)，效果正是我想要的。很酷。

这是代码：

**JSFIDDLE：**

[http://jsfiddle.net/LTWMp/](http://jsfiddle.net/LTWMp/)

**HTML：**

```
<style name="impostor_size">
    .marker + li { border-top-width:0px; }
</style>
<ul>
    <li>1</li>
    <li>2</li>
    <li>3</li>
    <li>4</li>
    <li>5</li>
    <li>6</li>
</ul> 
```

**CSS：**

```
body { color:white; font-family:Helvetica, sans-serif;  padding: 10px}
ul { float:left; width:300px; overflow:hidden; border-radius:6px; }
li { display:block; position:relative; padding:12px 6px; z-index:1; margin:5px 20px; }
li:after { background:#18629D; display:block; position:absolute; height:100%; width:100%; top:0px; left:0px; content:' '; border-radius:6px; z-index:-1; }
li { -moz-transition:border-top-width 0.1s ease-in; -webkit-transition:border-top-width 0.1s ease-in; border-top:0px solid rgba(0,0,0,0); }
.marker { opacity:0.0; } 
```

**脚本：**

```
var stylesheet = $('style[name=impostor_size]')[0].sheet;
var rule = stylesheet.rules ? stylesheet.rules[0].style : stylesheet.cssRules[0].style;
var setPadding = function(atHeight) {
    rule.cssText = 'border-top-width: '+atHeight+'px'; 
};
$('ul').sortable({
    'placeholder':'marker',
    'start':function(ev, ui) {
        setPadding(ui.item.height());
    },
    'stop':function(ev, ui) {
        var next = ui.item.next();
        next.css({'-moz-transition':'none', '-webkit-transition':'none', 'transition':'none'});
        setTimeout(next.css.bind(next, {'-moz-transition':'border-top-width 0.1s ease-in', '-webkit-transition':'border-top-width 0.1s ease-in', 'transition':'border-top-width 0.1s ease-in'}));
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-03T03:52:15.350

通过利用可排序 api 中的“更改”功能，我对上述所有内容进行了改进。这是代码。查看下面的小提琴以查看所需的 css。

```
$('ul').sortable({
placeholder:'marker',
distance: 15,
cursor: 'move',
revert: 200,
start:function(ev, ui) {
   $(".marker").css({"height": "0px"});
    console.log("start");
},
change:function(ev, ui) {
    $(".marker").css({"height": "0px"});
    setTimeout(function(){
        $(".marker").css({"height": "40px"});
    },10);
} }); 
```

[您可以在此处](http://jsfiddle.net/LTWMp/284/)查看完整的代码示例

[http://jsfiddle.net/LTWMp/284/](http://jsfiddle.net/LTWMp/284/)

# java - 如何构造以下构造函数？

> ID：13261890
> 
> 赞同：-3
> 
> 时间：2012-11-07T01:12:09.160
> 
> 标签：java, arrays, eclipse, constructor, jgrasp

> **可能重复：**
> [我需要帮助创建实例变量和构造函数](https://stackoverflow.com/questions/13261677/i-need-help-creating-an-instance-variable-and-constructors)

第二个构造函数将接受一个参数，它将是一个 int 数组。此构造函数将创建一个与参数大小相同的实例数组，然后将整数从参数复制到实例数组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:17:30.760

```
this.myArray = Arrays.copyOf(nrray,nrray.length); 
```

这应该创建传入 int 数组的副本并将其分配给实例数组

# c# - 从单元格中托管的控件退出编辑模式

> ID：13261895
> 
> 赞同：2
> 
> 时间：2012-11-07T01:12:59.280
> 
> 标签：c#, .net, winforms, datagridview, editmode

我有一个自定义 datagridviewcolumn，一个托管在单元格中的自定义控件。我想以编程方式退出编辑模式并验证单元格中的当前值（这个值是正确的）。我检查了以下方法但没有成功：

```
this.datagridview.currentCell.datagridview.endEdit()
this.EditingControlDataGridView.endEdit()
this.datagridview.endEdit(); 
```

还通过强制当前单元格更改：

```
this.datagridview.currentCell = this.datagridview.Rows[rowIndex].Cells[columnIndex] 
```

我需要以编程方式强制提交单元格中的挂起值，因为例如，在某些情况下我需要删除一行 datagridview 但由于单元格（在被删除的同一行中）处于编辑模式，我不能这样做如果我之前没有为单元格提交更改并退出编辑模式。

此外，当我想退出编辑模式时，我有类似的奇怪行为，但在这种情况下，丢弃单元格中的更改：根据我的应用程序的状态，有时这样做 this.datagridview.CancelEdit() 有效，有时无效。

使用 C#、.NET Framework 4.0、WinForms。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-09T14:59:04.227

添加此代码

```
Application.DoEvents(); 
```

强制事件触发：

# cakephp - Paypal PRO 与 Cakephp（或只是 php）的集成

> ID：13261904
> 
> 赞同：1
> 
> 时间：2012-11-07T01:13:21.193
> 
> 标签：cakephp, plugins, paypal

我有一个使用 CakePHP 1.3.10 的网站，我需要为那里的文章实施支付解决方案（请注意，它不是以“购物车”为中心的网站，但可以购买一些文章）。

我想使用 PayPal PRO 完全集成到网站中，但我从来没有做过这样的事情。我想知道是否有人可以为我指出如何实现这一点的正确方向。我一直在寻找 PayPal 的开发者网站，但我找不到一个简单的 PHP 示例。此外，我一直在寻找处理此问题的 CakePHP 插件，但我发现的似乎已经过时或者不是我想要的。

我已经有一个 PayPal 沙盒帐户，可以立即开始测试（当然，一旦我实现了一些东西；P）

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-22T09:57:21.633

看看这个......只需更改插件 [Paypal Website Payments Pro Component for CakePHP 2.2.X上的所有凭据](https://github.com/robmcvey/cakephp-paypal)

# google-maps-api-3 - 在 Google Maps API v3 中捕捉到道路区域

> ID：13261907
> 
> 赞同：3
> 
> 时间：2012-11-07T01:14:03.433
> 
> 标签：google-maps-api-3, area, directions

我想创建能够绘制捕捉到道路的多边形的地图侦听器。这些多边形将是一些受街道限制的区域。我正在尝试通过使用 Directions API 来实现这一目标。当用户在道路附近单击时，它工作正常 - 点被捕捉到道路上最近的点。当然，我正在收集路径包含的点，以便稍后创建多边形。

街道的方向有问题。通常，当我单击某个点时，路径是以迂回的方式创建的。当我使用任何类型的 TravelMode，甚至是 google.maps.TravelMode.WALKING 时，都会发生这种情况。有关详细信息，请参见图像。

![在此处输入图像描述](../Images/16c74c2c6dd92abbabea41914236b010.png) 红线表示我想要获取的内容，黑线是 Directions API 生成的路径。

有没有办法忽略街道的方向？我的意思是当我单击道路附近的某个点时，该点会捕捉到道路的中心，无论是否可以从先前单击的点到达那里。也许还有其他方法可以按街道选择区域？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T20:33:30.387

使用修饰键（如“shift”）关闭 DirectionsService 结果并将线直接绘制到鼠标。

看我的例子： http: [//people.missouristate.edu/chadkillingsworth/mapsexamples/snaptoroad.htm](http://people.missouristate.edu/chadkillingsworth/mapsexamples/snaptoroad.htm)

# mercurial - 比较内核源代码并忽略 mercurial 中的 win/linux 权限

> ID：13261911
> 
> 赞同：0
> 
> 时间：2012-11-07T01:14:34.827
> 
> 标签：mercurial, compare

这是我比较内核代码的步骤。

1.  获得正确的权限内核代码并存储在 src
2.  将 src 放入 mercurial 中。(cd src ; hg init ; hg ci -A -m"")
3.  将 windows guy 的修改复制到 src

因为windows中的文件权限将始终视为777。这表明几乎所有文件都已修改。

我已阅读此[链接](https://stackoverflow.com/questions/5073115/mercurial-ignore-file-permission-mode-chmod-changes)，但我认为这不是解决此问题的好方法。

我希望有一种方法可以让我“恢复”错误的权限文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T03:03:40.517

这是我将状态恢复为原始内核源代码的可行代码。

```
#!/bin/bash
find $(hg root) \( -type d -name .hg -prune \) \
  -o \( -type f -print \) | xargs chmod a-x                                                          
hg st -n -m | while read fname ; do
  v=`hg di --git $fname |head -2 | awk '/^old/{print $3;}'`
  case $v in
    100644) chmod 644 $fname;;
    100755) chmod 755 $fname;;
  esac
done 
```

# javascript - 获取 HTML 页面以与 node-xmpp/xmpp 服务器通信

> ID：13261919
> 
> 赞同：1
> 
> 时间：2012-11-07T01:15:24.540
> 
> 标签：javascript, html, node.js, node-xmpp

请记住，我对所有这种 javascript/node.js 样式的 HTML 编码都非常陌生。过去，我对 HTML 所做的只是静态/信息样式页面。

我正在尝试创建一个 HTML 网页，该网页将从用户那里获取 xmpp 相关信息（服务器地址、端口、用户 JID、密码、聊天消息、其他用户 JID 等），并将其通过 node.js 服务器路由到 xmpp服务器。最终，我要做的是获取[webrtc.io 代码](https://github.com/webRTC/)并将其扩展为绑定到 XMPP 服务器上的用户并与之交互。在尝试执行此操作时，我找到了 node-xmpp 模块并将其“安装”（npm install）到我的项目工作目录中的 node_modules 文件夹中。

然后，我创建了一个非常基本的 index.html 文件（文本输入框），它获取用户信息，然后调用 index.html 文件中包含的 javascript 文件中的函数。在 javascript 文件中，我添加了 require 函数/调用`const xmpp = require('node-xmpp')`，然后添加了`var client = new xmpp.Client({[connection settings]});`一些基本的节处理程序和其他 xmpp 函数。

然后当我在浏览器中“运行”代码时，甚至在我开始输入信息之前，我看到控制台正在报告错误。起初它们是我编写的 xmpp 函数的错误，所以我将所有内容都注释掉，`new xmpp.Client({})`只是为了看看它是否可以连接。但是，我会收到一个错误`cont xmpp = require('node-xmpp')`。那个错误是

> 未捕获的 ReferenceError：未定义要求（匿名函数）

根据我对所有这些 html/javascript/server 内容的有限理解，我认为正在发生的事情是客户端/浏览器不知道/无法访问 node.js 或 node-xmpp 库。

这是正确的吗？我应该以不同的方式做事吗？是否有任何好的教程/文档可以涵盖这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T02:19:26.223

require() 函数未知导致问题。我认为您可能犯了一些错误，包括 node.js。

检查这个[`require 'socket.io-client.js'` 不起作用](https://stackoverflow.com/questions/6785979/socket-io-client-issues-require-socket-io-client-js-not-working)

您可能会找到问题的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T02:32:29.917

如果我理解您在说什么，那么您正在尝试在浏览器中执行节点代码。节点源代码应该在服务器上执行，而不是在浏览器中。您将拥有两组 JavaScript 文件：提供给浏览器以在浏览器上执行的文件和使用节点实例在服务器上执行的文件。如果我误解了，请告诉我们更多关于您的系统结构的信息。

# php - 对多个站点使用相同的文件 (PHP)

> ID：13261925
> 
> 赞同：0
> 
> 时间：2012-11-07T01:16:07.580
> 
> 标签：php, include

我的目标是拥有多个这样的网站：

`www.mysite.com/site1/`

`www.mysite.com/site2/`

`www.mysite.com/site3/`

`www.mysite.com/site4/`

* * *

这些站点的文件位于：

`www.mysite.com/site_files/`

这些包括网站的各种页面，以及 css、js 和图像。

* * *

这些页面中的每一个都将几乎相同，但将从不同的数据库加载内容，并且某些颜色以及某些图像会有所不同。

我只是好奇这样做的最佳方法是什么。我已经尝试`index.php`从网站中获取`www.mysite.com/site_files/`并包含它`index.php`：

**`www.mysite.com/site`index.php的内容：**

```
<?php 

     $siteDB = "this";
     $domainName = "thisdomain";
     $twitterName = "thistwitter";
     $facebookName = "thisfacebook";

     include 'http://www.mysite.com/site_files/index.php'; 

?> 
```

然后在 site_files index.php 中我会引用 $siteDB：

```
echo $siteDB; 
```

使用此方法，变量不可用于包含的代码。

每个站点 index.php 都有不同的变量，但它们都包含相同的变量`site_files/index.php`

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T01:19:45.713

这不起作用：

```
include 'http://www.mysite.com/site_files/index.php'; 
```

您需要访问与脚本相关的包含文件。或通过绝对网址：

```
include $_SERVER['DOCUMENT_ROOT'].'/site_files/index.php'; 
```

您的方法在技术上是可行的，但您应该在 Web 根目录下包含一个嵌套配置文件。

```
include $_SERVER['DOCUMENT_ROOT'].'/site1_config.php'; 
include $_SERVER['DOCUMENT_ROOT'].'/site_files/index.php'; 
```

配置定义数据库连接和任何其他站点特定详细信息的位置。

这是做到这一点的一种方法，可能是最接近您所拥有的方法。但不一定是“最好的”

在这种情况下，“最佳”是一个意见问题。

# cocos2d-iphone - Cocos2dx CCRenderTexture - OpenGL ES2 未渲染

> ID：13261926
> 
> 赞同：3
> 
> 时间：2012-11-07T01:16:26.113
> 
> 标签：cocos2d-iphone, opengl-es-2.0, cocos2d-x

我正在尝试为 Cocos2dx 2、OpenGL ES2 中的纹理添加渐变。但是 OpenGL 内容没有被渲染。

此代码基于教程链接： [http ://www.raywenderlich.com/3857/how-to-create-dynamic-textures-with-ccrendertexture](http://www.raywenderlich.com/3857/how-to-create-dynamic-textures-with-ccrendertexture)

```
CCRenderTexture *rt = CCRenderTexture::create((int)textureSize, (int)textureSize);
rt->beginWithClear(bgColor.r, bgColor.g, bgColor.b, bgColor.a);

float gradientAlpha = 0.5;
CCPoint vertices[4];
ccColor4F colors[4];
int nVertices = 0;

vertices[nVertices] = CCPointMake(0, 0);
colors[nVertices++] = ccc4f(0, 0, 0, 0);
vertices[nVertices] = CCPointMake(textureSize, 0);
colors[nVertices++] = ccc4f(0, 0, 0, 0);
vertices[nVertices] = CCPointMake(0, textureSize);
colors[nVertices++] = ccc4f(0, 0, 0, gradientAlpha);
vertices[nVertices] = CCPointMake(textureSize, textureSize);
colors[nVertices++] = ccc4f(0, 0, 0, gradientAlpha);

// Set the shader program for OpenGL
setShaderProgram(CCShaderCache::sharedShaderCache()->programForKey(kCCShader_PositionColor));
CC_NODE_DRAW_SETUP();

glVertexAttribPointer(kCCVertexAttrib_Position, 2, GL_FLOAT, GL_FALSE, 0, vertices);
glVertexAttribPointer(kCCVertexAttrib_Color, 4, GL_FLOAT, GL_FALSE, 0, colors);
ccGLBlendFunc(CC_BLEND_SRC, CC_BLEND_DST);
glDrawArrays(GL_TRIANGLE_STRIP, 0, (GLsizei)nVertices);

CCSprite* noise = CCSprite::create("Noise.png");
ccBlendFunc blendFunc;
blendFunc.src = GL_DST_COLOR;
blendFunc.dst = GL_ZERO;
noise->setBlendFunc(blendFunc);
noise->setPosition(ccp(textureSize / 2, textureSize / 2));
noise->visit();

rt->end();
return CCSprite::createWithTexture(rt->getSprite()->getTexture()); 
```

如果我做错了什么，请告诉我。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T20:02:12.487

看起来我们必须使用 ccVertex2F 而不是 CCPoint 作为顶点。

此外，混合函数对于绘制渐变没有明确要求。

这是更新的 C++ 代码：

```
float gradientAlpha = 0.5;
ccVertex2F vertices[4];
ccColor4F colors[4];
int nVertices = 0;

vertices[nVertices] = vertex2(0, 0);
colors[nVertices++] = ccc4f(0, 0, 0, 0);
vertices[nVertices] = vertex2(textureSize, 0);
colors[nVertices++] = ccc4f(0, 0, 0, 0);
vertices[nVertices] = vertex2(0, textureSize);
colors[nVertices++] = ccc4f(0, 0, 0, gradientAlpha);
vertices[nVertices] = vertex2(textureSize, textureSize);
colors[nVertices++] = ccc4f(0, 0, 0, gradientAlpha);

// Set the shader program for OpenGL
setShaderProgram(CCShaderCache::sharedShaderCache()->programForKey(kCCShader_PositionColor));
CC_NODE_DRAW_SETUP();

ccGLEnableVertexAttribs(kCCVertexAttribFlag_Position  | kCCVertexAttribFlag_Color);

glVertexAttribPointer(kCCVertexAttrib_Position, 2, GL_FLOAT, GL_FALSE, 0, vertices);
glVertexAttribPointer(kCCVertexAttrib_Color, 4, GL_FLOAT, GL_FALSE, 0, colors);

glDrawArrays(GL_TRIANGLE_STRIP, 0, (GLsizei)nVertices); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T04:32:25.467

我不太确定它是如何工作的，但如果你只想要渐变颜色的东西，你可以尝试或检查 CCLayerGradient 的源代码，这里是链接[http://www.cocos2d-x.org/reference/本机-cpp/d9/d19/classcocos2d_1_1_c_c_layer_gradient.html](http://www.cocos2d-x.org/reference/native-cpp/d9/d19/classcocos2d_1_1_c_c_layer_gradient.html)

# c# - c# HTML web scriping如何处理链接点击下载文件

> ID：13261927
> 
> 赞同：-2
> 
> 时间：2012-11-07T01:16:27.937
> 
> 标签：c#, browser, web-scraping

在 C# windows 应用程序中，我正在使用 WebBrowser Control 并加载页面。我可以将所需的输入详细信息推送到下拉列表中，还可以点击按钮。它向我显示了带有下载文件链接的记录列表。我想单击并将文档保存在我的 c# windows 应用程序中。我怎样才能做到这一点？

[http://www.ceoandhra.nic.in/ceonew/home.aspx](http://www.ceoandhra.nic.in/ceonew/home.aspx)

在此站点中，单击 PDF Electrol Rolls。

请帮帮我......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:24:17.040

`web-client`如果要保存文件，可以使用。URL 应该是一个文件

```
 string extension = Path.GetExtension(url.ToString());
            List<string> imageFormats = new List<string>() { ".bmp",".dib",".jpg",".jpeg",".jpe",".jfif",".gif",".tif","tiff",".png",".ico"};
            List<string> mswordFormats = new List<string>() { ".doc", ".docx" };
            if (imageFormats.Contains(extension) || mswordFormats.Contains(extension) || extension.Equals(".pdf"))
            {
                string fileName = "download"+ extension;
                WebClient wc = new WebClient();
                wc.DownloadFile(url, fileName);
            } 
```

# android - 基于地理位置测试应用程序？

> ID：13261928
> 
> 赞同：3
> 
> 时间：2012-11-07T01:16:53.337
> 
> 标签：android, ios, automated-tests

我有需要测试智能手机应用程序的情况。目标是根据地理位置禁用我的应用程序。因此，例如，假设我正在通过我的应用程序**“直播”**一些视频，并且希望在用户前往某个受限位置时禁用流媒体，并在用户移动到可接受的地质区域时将其打开。

现在测试部分是，所有手机都可以说我面前有 5 部手机，我想测试在它们上运行的应用程序，当它们进入限制区域时，应用程序将被关闭。如何做到这一点？

**编辑：-** 实际场景 - 不应该在 android 应用程序上的体育场附近区域显示的比赛直播。因此，如果用户在应用程序上点击“播放”按钮并且手机在特定比赛期间处于视频禁区，则视频不应流式传输到该手机。

有什么想法……意见……？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T01:37:41.503

在 android 上，您有多种选择可以为您的应用程序提供模拟位置：通过 DDMS、telnet 或 LocationManager：

## 数据管理系统

从 AndroidSDK/tools/ 文件夹启动 DDMS。选择要为其欺骗位置的设备，然后转到`Emulator Control`。在选项卡的底部，您应该找到手动设置位置的选项，以及要欺骗的位置。

## 亚行/Telnet

通过 列出您的所有设备`adb devices`。从这里你应该得到这样的输出：

```
List of devices attached
emulator-5554 device 
```

然后 telnet 到指定的端口：

```
telnet localhost 5554 
```

这应该会打开 android 控制台。在那里你可以使用`geo fix`命令来设置位置

```
geo fix $lon $lat 
```

## 位置提供者

您可以使用以下`setTestProviderLocation`方法提供测试位置`LocationProvider`

```
LocationManager lm = (LocationManager)this.getContext().getSystemService(Context.LOCATION_SERVICE);
String mocLocationProvider = "Test";
locationManager.addTestProvider(mocLocationProvider, false, false,
                    false, false, true, true, true, 0, 5);
locationManager.setTestProviderEnabled(mocLocationProvider, true);

Location mockLocation = new Location(mocLocationProvider);
mockLocation.setLatitude(location.getLatitude());
mockLocation.setLongitude(location.getLongitude()); 
mockLocation.setAltitude(location.getAltitude()); 
mockLocation.setTime(System.currentTimeMillis()); 
locationManager.setTestProviderLocation( mocLocationProvider, mockLocation); 
```

我从[这里得到的这个方法](https://stackoverflow.com/questions/6015172/settestproviderlocation-does-not-trigger-calling-of-onlocationchanged)

另外，不要忘记设置权限

```
<uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T02:36:27.413

在连接 XCode 的设备上调试 iOS 应用程序时，您可以通过单击 XCode 界面下端的小箭头来覆盖设备的 gps 位置：

![在此处输入图像描述](../Images/22284c79501f2eb690b57d4dce83e66c.png)

有几个默认位置，您可以使用 File.. New.. iOS/Resource，“GPX File”添加自己的位置：

![在此处输入图像描述](../Images/35f1b917dd1a85728a6e081a2e9af184.png)

这是一个GPX文件：

```
<?xml version="1.0"?>
<gpx version="1.1" creator="Xcode"> 

    <wpt lat="45.463965" lon="9.180247">
         <name>Milan, Italy</name>
    </wpt>

</gpx> 
```

您可以指定多个位置（一个轨道），但显然您将无法控制时间：

```
<?xml version="1.0" encoding="UTF-8"?>
<gpx>
    <wpt lat="52.373" lon="4.871"></wpt>
    <wpt lat="52.374" lon="4.872"></wpt>
    <wpt lat="52.375" lon="4.871"></wpt>
</gpx> 
```

但是，也许您有兴趣通过以编程方式将位置序列发送到设备来自动化该过程。在您的应用程序的某处，您正在接收来自 CLLocationManager 实例的消息，这些消息将发送给您的委托。测试时，不要订阅 CLLocationManager - 而是构建一个虚假的位置管理器实例，它将虚假的位置发送给您的委托：

```
[delegate locationManager:nil didUpdateToLocation:newLocation fromLocation:oldLocation]; 
```

看：

[在 iPhone 模拟器上模拟位置更新](https://stackoverflow.com/questions/2056185/simulating-location-updates-on-the-iphone-simulator)

[模拟`startMonitoringSignificantLocationChanges`的位置变化](https://stackoverflow.com/questions/8541973/simulating-location-changes-for-startmonitoringsignificantlocationchanges)

和：

[https://github.com/futuretap/FTLocationSimulator](https://github.com/futuretap/FTLocationSimulator)

[https://github.com/johnmckerrell/LocationManagerSimulator](https://github.com/johnmckerrell/LocationManagerSimulator)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T01:27:02.853

我不知道我是否理解得很好，但是如果您想通过更改位置来测试应用程序的禁用部分是否有效，iPhone 模拟器可能会有所帮助。

模拟器的地理位置可以设置到多个预定的重要位置，例如香港和伦敦。限制其中之一并对其进行测试。

要模拟一个位置，您必须在 xcode 中设置它。单击靠近调试控制按钮的箭头状按钮。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T01:36:12.570

如果您使用的是有根设备，尤其是在开发人员菜单中允许模拟位置的方法。还可以查看[Fake GPS App (Android)之类的应用](https://play.google.com/store/apps/details?id=com.lexa.fakegps)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-13T06:58:12.170

使用 Chrome DevTools 更容易：

*   打开 Chrome/ium DevTool
*   按 Command+Shift+P (Mac) 或 Control+Shift+P（Windows、Linux、Chrome 操作系统）打开命令菜单。
*   打开传感器选项卡
*   选择您的位置（位置列表是自定义的：）

[![在此处输入图像描述](../Images/87182a4ccaf0113ff378093d1acaab0f.png)](https://i.stack.imgur.com/FVBfV.png)

# php - 如何使用参数和回调从 PHP 调用 JSON Web 服务？

> ID：13261929
> 
> 赞同：3
> 
> 时间：2012-11-07T01:16:54.880
> 
> 标签：php, json, web-services, curl, callback

我从 JQuery $.getJSON 函数调用 web 服务，它工作正常。

```
 var p = {
       'field1': 'value1',
       'field2': 'value2',
       'field3': 'value3'
    };

    $.getJSON('https://service:xxx@xxx.xxx.yyyyy.com.xx/service/search?callback=?', p, function(data) {
    if (data[0]) {      
        // print results
    } else  {
        // no results found
    }
}); 
```

我正在尝试从 PHP 和 CURL 进行连接，但是它不起作用，它总是返回 false。

//第一次尝试

```
$params = array(  'field1' => 'value1',  'field2' => 'value2', 'field3'=> 'value3');
$ch = curl_init();
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_URL, 'https://service:xxx@xxx.xxx.yyyyy.com.xx/service/search?callback=?');
curl_setopt($ch, CURLOPT_POSTFIELDS, $params);
$result = curl_exec($ch); // return false instead of my JSON 
```

// 第二次尝试

```
 $data_string = json_encode($params);                                                                                   
    $ch = curl_init('https://https://service:xxx@xxx.xxx.yyyyy.com.xx/service/search?callback=?');                                                                      
    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "POST");                                                                     
    curl_setopt($ch, CURLOPT_POSTFIELDS, $data_string);                                                                  
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);                                                                      
    curl_setopt($ch, CURLOPT_HTTPHEADER, array(                                                                          
    'Content-Type: application/json',                                                                                
    'Content-Length: ' . strlen($data_string))                                                                       
);                                                                                                                   

    $result2 = curl_exec($ch); //return false instead of my JSON 
```

我做错了什么？

非常感谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T05:46:42.390

Try changing your code to this:

```
$params = array(  'field1' => 'value1',  'field2' => 'value2', 'field3'=> 'value3');

$data_string = implode('&',$params);
//NB: you may need to urlencode the each of your params

$ch = curl_init('https://service:xxx@xxx.xxx.yyyyy.com.xx/service/search?  callback=?&' .$data_string);                                                                      
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);    
$result2 = curl_exec($ch); 
```

Untested code, hope it helps.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T01:31:09.710

jquery 请求使用 GET。您编写的 curl 代码似乎正在发送一个发布请求（我不是 curl 方面的专家）。显然，接收服务器以不同的方式处理不同类型的请求，因此请确保您通过 curl 发送 get ，这应该会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T09:20:40.673

getJSON 发送 GET 请求，因此您需要使用 http_build_query 将 params 数组转换为字符串并将其附加到查询中。当您使用 HTTPS 请求数据时，您需要使用 CURLOPT_CAINFO / CURLOPT_CAPATH 将 CURL 指向有效证书，我将忽略代码中的验证。

```
$params = array(  'field1' => 'value1',  'field2' => 'value2', 'field3'=> 'value3');
$url = 'https://service:xxx@xxx.xxx.yyyyy.com.xx/service/search?callback=?' . http_build_query($params);

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch , CURLOPT_SSL_VERIFYPEER , false);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

$result = curl_exec($ch);
if($result === FALSE) {
    echo curl_error($ch);
} 
```

# javascript - 具有自定义设置的两个 jquery datepicker 字段之间的天数

> ID：13261933
> 
> 赞同：5
> 
> 时间：2012-11-07T01:17:45.750
> 
> 标签：javascript, jquery, datepicker

我的 jquery datepicker 字段为开始和结束字段设置了最小和最大日期，这似乎让我尝试编写脚本来计算所选日期之间的天数。我知道其他人已经问过这个问题，但是我在 stackoverflow 上尝试的每个修复都失败了，我怀疑是因为我在代码中进行了自定义。谁能帮我弄清楚如何获取下面的代码并让它在一个名为#totaldays的输入字段中为我提供一个值？谢谢

```
// Calendar Dates
/* create an array of days which need to be disabled */
var disabledDays = ["11-13-2012","11-14-2012","11-15-2012","11-29-2012","11-30-2012"];

/* utility functions */
function nationalDays(date) {
  var m = date.getMonth(), d = date.getDate(), y = date.getFullYear();
  //console.log('Checking (raw): ' + m + '-' + d + '-' + y);
  for (i = 0; i < disabledDays.length; i++) {
    if($.inArray((m+1) + '-' + d + '-' + y,disabledDays) != -1 || new Date() > date) {
      return [false];
    }
  }
  return [true];
}

//Block the Weekends
function noWeekendsOrHolidays(date) {
   var noWeekend = $.datepicker.noWeekends(date);
    if (noWeekend[0]) {
        return nationalDays(date);
    } else {
        return noWeekend;
    }
} 

$(document).ready(function () {
$.datepicker.setDefaults({dateFormat: 'mm/dd/yy',minDate: +1,changeMonth: true,changeYear: true,numberOfMonths: 2,constrainInput:true,beforeShowDay:nationalDays,});
        var selector = function (dateStr) {
            var d1 = $('#datepicker_start').datepicker('getDate');
            var d2 = $('#datepicker_end').datepicker('getDate');
            var diff = 0;
            if (d1 && d2) {
                diff = Math.floor((d2.getTime() - d1.getTime()) / 86400000); // ms per day
            }
            $('#totaldays').val(diff);
        }
$('#datepicker_start').datepicker({onSelect: function(selectedDate) {
    var minDate = $(this).datepicker('getDate');
    if (minDate) {minDate.setDate(minDate.getDate() + 3);}//min days requires
    $('#datepicker_end').datepicker('option', 'minDate', minDate || 1); // Date + 1 or tomorrow by default
}});
$('#datepicker_end').datepicker({minDate: 1, onSelect: function(selectedDate) {
    var maxDate = $(this).datepicker('getDate');    
    if (maxDate) {maxDate.setDate(maxDate.getDate() - 1);}
    $('#datepicker_start').datepicker('option', 'maxDate', maxDate); // Date - 1    
}});
    $('#datepicker_start,#datepicker_end').change(selector)
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-07T01:51:23.097

我创建了这个函数，我通常在`onSelect`datepickers 的函数中运行它来计算它们之间的天数：

```
function days() {
    var a = $("#datepicker_start").datepicker('getDate').getTime(),
        b = $("#datepicker_end").datepicker('getDate').getTime(),
        c = 24*60*60*1000,
        diffDays = Math.round(Math.abs((a - b)/(c)));
    console.log(diffDays); //show difference
} 
```

[**小提琴**](http://jsfiddle.net/Jd4xn/2/)

# python - 在 Windows 8 上安装 Python，在简单语句上出现语法错误

> ID：13261938
> 
> 赞同：0
> 
> 时间：2012-11-07T01:19:08.803
> 
> 标签：python, command-line, syntax, windows-8

> **可能重复：**
> [使用 Python 3 打印时出现语法错误](https://stackoverflow.com/questions/826948/syntax-error-on-print-with-python-3)

例如，如果我只是从命令行使用“python”启动 python 然后运行类似

`print "test"`

它会引发语法错误。这真的很奇怪，但是像这样的陈述

`1+1`

工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T02:17:40.233

我的朋友，您不再安装 2.7。

这可能会有所帮助

[http://wiki.python.org/moin/Python2orPython3](http://wiki.python.org/moin/Python2orPython3)

# opengl - 桌面上的ETC1纹理压缩？

> ID：13261940
> 
> 赞同：0
> 
> 时间：2012-11-07T01:19:22.703
> 
> 标签：opengl, textures

我想知道如何在桌面应用程序中加载 ETC1 压缩纹理，因为似乎 ETC1 仅适用于移动设备。

具体来说，我希望知道`GL_ETC1_RGB8_OES`openGL 3.2 的变体是否存在

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:31:32.350

你不能（一般来说[。NVIDIA 提供了一种创建 ES 2.0 上下文的方法](http://www.opengl.org/registry/specs/EXT/wgl_create_context_es2_profile.txt)，你可能会有更好的运气）；您必须对其进行解压缩并将其用作解压缩的纹理。

处理这种情况的一般方法是为感兴趣的各种平台构建纹理。您在桌面 GL 上使用各种 S3TC 格式，在存在的平台上使用 ETC1，在这些平台上使用 PVR，等等。所有这些的来源都是原始的未压缩纹理。

# putty - 我在腻子中的方程式，完全难倒

> ID：13261941
> 
> 赞同：2
> 
> 时间：2012-11-07T01:19:28.953
> 
> 标签：putty

我一生都无法弄清楚我在腻子中的这些简单方程式有什么问题。我认为一切都设置正确，但我的输出与我的教授样本输出略有不同。

```
//This program is used to calculate total cost of painting.
#include <iostream>
#include <iomanip>
using namespace std;

//These are the function prototypes that will be used for the main function.
void displayInstructions(int &feet, float &price);
float paintprice (int feet, float price);
float laborprice (int feet);
float totalcost(float paint, float labor);
void displayoutput (float paint, float labor, float total, int feet);

int main()
{
  int feet=0;
  float price=0;
  float paint=0;
  float labor=0;
  float total=0;

  displayInstructions(feet, paint);
  paint=paintprice(feet, paint);
  labor=laborprice(feet);
  total=totalcost(labor, paint);
  displayoutput(paint, labor, total, feet);
  return 0;
}

void displayInstructions(int &feet, float &price)
{
  cout<<setw(35)<<"==================================="<<endl;
  cout<<setw(30)<<"Painting Cost Calculator" <<endl;
  cout<<setw(35)<<"===================================" <<endl;
  cout<<"This program will compute the costs (paint, labor, total)\nbased on th\
e square feet of wall space to be painted \
and \nthe price of paint." <<endl;
 cout<<"How much wall space, in square feet, is going to be painted?" <<endl;
  cin>>feet;
  cout<<"How much is the price of a gallon of paint?" <<endl;
  cin>>price;
}

float paintprice (int feet, float price)
{
  float paint;
  paint=((feet/115)*price);
  return paint;
}

float laborprice (int feet)
{
  float labor;
  labor=((feet/115)*18*8);
  return labor;
}

float totalcost (float paint, float labor)
{
  float total;
  total=(paint+labor);
  return total;
}

void displayoutput (float paint, float labor, float total, int feet)
{
  cout<<"Square feet:" <<feet <<endl;
  cout<<"Paint cost:" <<paint <<endl;
  cout<<"Labor cost:" <<labor <<endl;
  cout<<"Total cost:" <<total <<endl;
} 
```

基于输入为英尺=12900，价格=12.00 油漆成本的最终输出应为 1346.09 美元 人工成本的最终输出应为 16153.04 美元

我分别得到：$1344.00、$16128.00

如果你能帮助我，这将是一个救生员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:33:08.083

`labor=(((float)feet/115)*18*8);`应该解决您的正确性问题。同样与`paint =`

之所以可行，是因为**C++ 计算的工作方式**。在计算像 a+b 这样的表达式时，两者都会**自动转换为最准确的通用类型**。

但是，当您**将整数除以整数**时，`feet/115`结果在分配给值之前被**计算为 int**。这意味着该**计算中的小数位会丢失**，因此您会失去准确性。`float``labor`

 **例如，如果英尺 = 120，则答案`feet/115`将是 1，而不是 1.04。

解决此问题的另一种方法是通过编写 115.0f**将 115 转换为浮点数**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T01:32:23.647

你的脚是一个整数，当整数相除时，它会忽略小数点后的数字，例如`int a = 10;` a/3 = 3 而不是 3.33333333。(float) 将您的 int 转换为浮动，因此它可以工作。**

# java - 如何在java中按频率排序字符串，然后按字母顺序排序？

> ID：13261942
> 
> 赞同：1
> 
> 时间：2012-11-07T01:19:28.147
> 
> 标签：java

为了练习，我想在java中按频率排序ASCII字符串，然后按字母顺序排序，所以'banana'应该变成'bnnaaa'，'grammar'应该变成'gaammrr'。这是我到目前为止所拥有的。

```
public static orderByFrequencyAndThenAlphabet(String str) {
  // 128 ASCII characters possible.
  int[] charCount = new int[128]

  // Get the counts.
  str = str.toCharArray();
  for (char c : str) {
    charCount[int(c)] += 1;
  }

  // Sort by frequency...
} 
```

如您所见，我创建了一个数据结构来存储输入字符串中每个字符的计数。但是，我现在如何使用数据结构按频率对字符进行排序？我应该考虑使用优先队列吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:28:45.237

您所要做的就是创建一个字符数组来存储字符串中的所有字符（注意字符数组的大小必须是字符串的长度）。然后对字符数组进行排序（任何你喜欢的冒泡排序），然后用排序后的字符数组构造一个新字符串（注意在对数组进行排序时确保正确的字符大小写）。这是低效的，但它可以完成工作。

# html - Firefox 和 Chrome 显示“顶部：-5px 不同”

> ID：13261945
> 
> 赞同：2
> 
> 时间：2012-11-06T16:35:29.993
> 
> 标签：html, css

使用 Google Web Toolkit，我有一个带有 DIV 和锚子的 DIV 父级。

```
<div class="unseen activity">
  <div class = "unseen-label"/>
  <a href .../>
</div> 
```

使用以下 CSS，Chrome 会在锚点下方显示“看不见的标签”。它在 Chrome 和 FireFox 中都正确定位。

但是，FireFox 显示的标签与锚点一致。

```
.unseen-activity div.unseen-label {
    display: inline-block;
    position: relative;
    top: -5px;
} 
```

和

```
.unseen-activity a {
    background: url('style/images/refreshActivity.png') no-repeat;
    background-position: 0 2px;
    height: 20px;
    overflow: hidden;
    margin-left: 10px;
    display: inline-block;
    margin-top: 2px;
    padding-left: 20px;
    padding-right: 10px;
    position: relative;
    top: 2px;
} 
```

请告诉我如何更改我的 CSS，以便 Chrome 将标签呈现在锚点的中心。但是，我需要让 FireFox 满意并正确渲染。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T16:45:27.043

要将班级居中`unseen-label`设置为班级的宽度`unseen`，然后为您的班级`unseen-label`设置`margin:0 auto;`宽度并根据需要对齐。我不在 Firefox 中，所以无法评论您所看到的内容。但是您可以将您的班级`unseen`设置为绝对位置，这将允许您使用负左上角左下角间距将其定位在任何地方。然后也摆脱 display inline-block`position:relative;``unseen-label`

# java - 内部类的 Java 类型捕获

> ID：13261953
> 
> 赞同：1
> 
> 时间：2012-11-07T01:21:03.770
> 
> 标签：java, types

我有以下（在这种形式下显然没用）Java类：

```
public class EntrySet<T> {

    public static class Entry<T> {
        T obj;
    }

    private final Set<Entry<T>> set;

    public EntrySet() {
        this.set = Sets.newHashSet();
    }

    public Set<Entry<T>> getEntries() {
        return set;
    }
} 
```

鉴于此类，以下内容无法编译：

```
EntrySet<?> entrySet = new EntrySet<SomeClass>();
Set<EntrySet.Entry<?>> entries = entrySet.getEntries(); 
```

第二行有编译错误“cannot convert from `Set<EntrySet.Entry<capture#1-of ?>>`to `Set<EntrySet.Entry<?>>`”。即使使用强制转换或使用辅助函数，我也找不到消除此错误的方法。

这里到底是什么问题，有没有办法获得干净的编译？

我能做的最好的是：

```
EntrySet<?> entrySet = new EntrySet<SomeClass>();
Set<?> tmp = entrySet.getEntries();
Set<EntrySet.Entry<?>> entries = (Set<EntrySet.Entry<?>>) tmp; 
```

这显然很糟糕（即使有相关的警告抑制）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:33:02.203

删除`entrySet`您正在尝试将 a 分配`Set<EntrySet.Entry<SomeClass>>`给`Set<EntrySet.Entry<?>>`。有数百个 Stack Overflow 问题本质上是相同的。您可以将 a 添加`EntrySet.Entry<OtherClass>`到后者但不能添加到前者，这样会破坏类型安全。

处理这个问题的方法可能是通过调用带有（命名的）泛型参数的方法来捕获通配符。

```
 EntrySet<?> entrySet = new EntrySet<SomeClass>();
    fn(entrySet);
...
private static <T> void fn(EntrySet<T> entrySet) {
    Set<EntrySet.Entry<T>> entries = entrySet.getEntries(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T02:28:23.567

无界通配符`<?>`就像所有泛型类型的超类型。它类似于 Object 类对所有 java 类的作用。您可以对无界通配符引用执行的唯一操作是那些采用“null”（如果`<?>`在参数引用中使用参数）或返回“Object”（如果`<?>`在返回类型引用中使用参数）的操作。因此，如果它返回 Object 类型的引用，您的代码将编译。

```
 class EntrySet<T> {

    public static class Entry<T> {
        T obj;
    }

    private final java.util.Set<Entry<T>> set;

    public EntrySet() {
        this.set = new java.util.HashSet();
    }

    public java.util.Set<Entry<T>> getEntries() {
        return set;
    }

    public static void main(String [] args){
        EntrySet<?> entrySet = new EntrySet<SomeClass>();

    //java.util.Set<EntrySet.Entry<?>> entries = entrySet.getEntries(); // Error

         Object o = entrySet.getEntries();         // OK !
    }
}

class SomeClass{} 
```

# c++ - 为什么此代码在使用带有字符串的映射 (C++) 时会出现运行时错误？

> ID：13261958
> 
> 赞同：6
> 
> 时间：2012-11-07T01:21:40.507
> 
> 标签：c++, string, stl, map, printf

为什么这段代码会出现运行时错误？

```
#include <cstdio>
#include <map>
#include <string>
#include <iostream>

using namespace std;
map <int, string> A;
map <int, string>::iterator it;

int main(){
    A[5]="yes";
    A[7]="no";
    it=A.lower_bound(5);
    cout<<(*it).second<<endl;    // No problem
    printf("%s\n",(*it).second); // Run-time error
    return 0;
} 
```

如果你使用 cout，它工作正常；但是，如果您使用 printf 它会给出运行时错误。我该如何纠正？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-07T01:23:45.497

您将 a 传递`std::string`给期望 a 的东西`char *`（从文档中可以看到`printf`，这是一个 C 函数，没有类，更不用说 了`string`）。要访问底层的 const 版本`char *`，请使用以下`c_str`函数：

```
printf("%s\n",(*it).second.c_str()); 
```

此外，`(*it).second`等同于`it->second`，但后者更易于键入，并且在我看来，它可以更清楚地说明正在发生的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T01:23:58.257

使用`c_str()`：

```
printf("%s\n",(*it).second.c_str()); 
```

`printf()`期待一个 C 字符串`%s`，而你却给它一个 C++ 字符串。因为`printf()`它不是类型安全的，所以它无法诊断这个错误（尽管一个好的编译器可能会警告你这个错误）。

# visual-studio-2010 - 包含单元测试的非常简单的项目中奇怪的 Visual Studio 2010 崩溃

> ID：13261961
> 
> 赞同：3
> 
> 时间：2012-11-07T01:21:46.437
> 
> 标签：visual-studio-2010, unit-testing, testing, crash

我发现使用自动生成的*Unit Tests使***Visual Studio 2010**崩溃的方法非常简单。

 *我就是这样做的：`File`=> `New Project`=> `Class Library` *[.NET Framework 4]*。
这是程序的完整源代码（15 行**C#**代码）：

```
namespace UnitTestsCrash
{
    class ClassA<T>
    {
        private T a;
    }

    class ClassB : ClassA<ClassB>
    {
        private void FooA()
        {
            return;
        }
    }
} 
```

`Build it`然后点击`Right Mouse Button`正文`ClassB`=> `Create Unit Tests...`=> `OK`=> `Create`=> `Yes`。结果是*Visual Studio**崩溃***（[截图](http://oi50.tinypic.com/2z4bade.jpg)）！

我在更复杂的解决方案中发现了这种奇怪的崩溃。我从更大的项目中提取了这个问题并简化为上面的示例。
我不太确定这是*Visual Studio 2010*的错还是我的错。请核实并解释是否是我的错。

我需要测试以类似方式继承的大类，`ClassB`但我不能以自动化方式进行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T07:23:27.193

私有访问器存在一些问题。实际上，您的案例再次证明了我访问者只是纯粹的邪恶。每次更改测试用例时，它们都会强制重新编译所有引用的项目。另外，根据这篇文章[http://blogs.msdn.com/b/vstsqualitytools/archive/2010/01/18/publicize-and-code-generation-for-visual-studio-2010.aspx](http://blogs.msdn.com/b/vstsqualitytools/archive/2010/01/18/publicize-and-code-generation-for-visual-studio-2010.aspx)，VS团队测试停止VS2010 对访问器的支持，所以访问器出现问题也就不足为奇了。使用反射！

VS2012 也崩溃了。所以他们没有改变访问器中的任何东西，除了访问器在 VS2012 中被弃用。*

# linux - 检查linux机器是否空闲

> ID：13261964
> 
> 赞同：3
> 
> 时间：2012-11-07T01:22:38.220
> 
> 标签：linux, power-management

如果机器空闲，我想关闭它，并且正在寻找“空闲”的最可靠定义。它应该衡量计算机（最终用户的笔记本电脑或台式机）是否正在执行有用的工作。值得注意的是，这里有一些我想检查的东西：

*   没有用户活动

    `w`命令打印终端会话的空闲时间

    [xprintidle](http://www.alex.ballas.org/tag/xprintidle/)似乎对 X 做同样的事情，使用 X 屏幕保护程序扩展

*   低负载平均

    `uptime`打印平均负载

*   没有正在运行的下载

    [bwm-ng](http://www.gropp.org/?id=projects&sub=bwm-ng)计算当前网络和磁盘使用情况

现在我的问题：

1.  是否有任何现有的工具执行这些检查？

2.  我们应该检查哪些其他活动以使其更可靠？打开网络连接可能吗？或者一个永远不应该被中断的进程白名单？我们能否使用一些机器学习技术以某种方式了解有用工作的特征？

期待您的想法和建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:24:12.470

恕我直言，直截了当的方法是其中`Perl`之一`shell`：

```
cpan -i X11::IdleTime # or any otherway to install X11::IdleTime module
sleep 2
perl -MX11::IdleTime -e 'print GetIdleTime(), $/;' 
```

# javascript - 如何获取当前javascript文件名的绝对路径

> ID：13261970
> 
> 赞同：43
> 
> 时间：2012-11-07T01:23:25.027
> 
> 标签：javascript

我有一个名为`main.js`.

在里面`main.js`我想得到这个当前文件的绝对路径，比如：

```
http://server/app/main.js

http://server/app/script/main.js 
```

获得绝对路径的最快方法是什么？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-11-07T01:31:05.817

您可以在以下位置调查脚本收集：

```
var scripts = document.getElementsByTagName("script"); 
```

对于返回`scripts`数组中的每个元素，您都可以访问其`src`属性。

当前执行的包含文件将始终是`scripts`数组中的最后一个。因此，您可以在`scripts[scripts.length-1]`.

当然，这只会在初始代码运行时起作用，例如在加载初始脚本后调用的函数中没有用处，因此如果您需要稍后可用的值，则需要将其保存到变量中。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-11-16T03:55:09.617

**获取 javascript 文件的当前路径名**

将它放在 /tmp 下的 apache 目录中，并将其命名为 test.html。访问网址

```
localhost/grader/test.html?blah=2#foobar 
```

Javascript：

```
<html>
<script>
  alert(location.pathname);  // /tmp/test.html
  alert(location.hostname);  // localhost
  alert(location.search);    // ?blah=2
  alert(document.URL);       // http://localhost/tmp/test.html?blah=2#foobar
  alert(location.href);      // http://localhost/tmp/test.html?blah=2#foobar
  alert(location.protocol);  // http:
  alert(location.host);      // localhost
  alert(location.origin);    // http://localhost
  alert(location.hash);      // #foobar
</script>                            
</html> 
```

有关位置属性的更多信息：http: [//www.w3schools.com/jsref/obj_location.asp](http://www.w3schools.com/jsref/obj_location.asp)

**或者如果你有 jquery：**

```
<html>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js">
</script>
<script>
  $(location).attr('href');      // http://localhost/tmp/test.html?blah=2#foobar
  $(location).attr('pathname');  // /tmp/test.html
</script>
</html> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-12T20:15:50.700

这将起作用。但是，它要求您已经知道脚本的文件名是什么。但在大多数情况下，您会知道这一点。

```
function absFileLoc(filename) {
  var scriptElements = document.getElementsByTagName('script');
  for (var i = 0; i < scriptElements.length; i++) {
    var source = scriptElements[i].src;
    if (source.indexOf(filename) > -1) {
      var location = source.substring(0, source.indexOf(filename)) + filename;
      return location;
    }
  }
  return false;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-09-04T19:27:18.123

## 现代方式

获取绝对路径最快的方法是使用[document.currentScript](https://developer.mozilla.org/en-US/docs/Web/API/document.currentScript)

```
const url = document.currentScript.src; 
```

还可以使用[URL](https://developer.mozilla.org/en-US/docs/Web/API/URL)来读取 url 的组件:)

```
const url = new URL('http://www.example.com/cats');
console.log(url.hostname); // "www.example.com"
console.log(url.pathname); // "/cats" 
```

所有现代浏览器都应该支持这些方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-07T01:35:30.847

```
var path = document.location.pathname 
```

将提供当前的 html 页面。

如果您查找当前脚本，请尝试本网站中提到的方式：

[http://bencarpenter.co.uk/javascript-path-to-the-current-script](http://bencarpenter.co.uk/javascript-path-to-the-current-script)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-03T15:12:47.187

我知道这是一个较老的问题，但仍然是实际的，因为 IE 仍然不提供脚本 src。

我最好的形式是给脚本标签一个唯一的ID：

```
 <script id="kuvaScript" src="jscripts/kuva/kuva.min.js"></script> 
```

在我使用的脚本中：

```
 var thisScript = $("#kuvaScript").attr("src");
    var thisPath = thisScript.split('/').slice(0, -1).join('/')+'/'; 
```

它将保持 src 格式原样（相对或完整），并在 IE 和 Chrome 中进行了测试。

希望它会为您节省很多时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-01-12T14:05:05.410

# 好简单

把它放在你想要获取路径的 *.js 文件中：

```
let scripts = document.getElementsByTagName('script')
let lastScript = scripts[scripts.length -1]
console.log('lastScript', lastScript.src) 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2017-02-17T18:52:47.327

如果要获取当前文件名或目录，请尝试此操作

```
location.href.split('/')[ location.href.split('/').length - 1 ];
```

# linux - 如何使用 x 资源在 x 窗口程序中删除小部件的边框？

> ID：13261974
> 
> 赞同：5
> 
> 时间：2012-11-07T01:23:57.220
> 
> 标签：linux, widget, x11, xlib, xt

我想改变 gv 的 GUI 丑陋的默认外观。我使用editres来获取gv的x资源树，并尝试使用以下设置删除按钮的边框：

```
GV.control.MButton.borderWidth: 0
GV.control.MButton.borderColor: white 
```

它们都不起作用。后来我发现相关资源可能是：

```
GV.control.MButton.unsetFrameStyle: sunken/raised/ledged 
```

凹陷、凸起、壁架 3 个选项确实改变了框架的样式。但是我找不到使框架成为简单线条或消失的选项。

似乎 gv 基于 Xaw3d （我不确定）。我不知道这些资源是由 Xlib、Xt、Xaw 还是由 gv 本身提供的。它们不太可能是特定于 gv 的。如果它们是由 Xlib、Xt 或 Xaw 提供的，我可以在找到正确的资源和设置选项后以同样的方式更改类似 x 窗口程序的外观。

所以我的问题是如何找到正确的 x 资源和选项来删除 x 小部件的边框？

PS：editres 只提供资源列表，不提供选项列表。如果我将它们用于 gv，appres 和 listres 会显示一个非常短的资源设置列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T03:04:05.217

以下设置移除 3D 效果

```
GV.control.MButton.bottomShadowContrast: 0
GV.control.MButton.topShadowContrast: 0 
```

以下设置更改阴影宽度

```
GV.control.MButton.shadowWidth: 1 
```

1 是它所取的最小值。0 不起作用。现在只剩下一条细线。不完全是我想要的，但总比没有好。

我通过随机更改editres中的资源来解决这个问题。如果有人可以提供相关文档的链接，那就太好了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T02:06:50.383

关于 Xt的[Wikipedia 文章](http://en.wikipedia.org/wiki/X_Toolkit_Intrinsics)提供了一些有用的上下文。您正在寻找有关配置 Xaw 小部件的信息，尽管 Xt 中可能有一些相关配置。

# c++ - 显示图像数据

> ID：13261975
> 
> 赞同：1
> 
> 时间：2012-11-07T01:23:58.710
> 
> 标签：c++, image-processing

我试图弄清楚如何通过 C++ 可视化图像（主要是 Tiff 和 jpg）。虽然存在一些预定义的库，但我希望在我的 shell 本身上解决这个问题。任何为此查找 c++ 代码的提示或方法。

注意：请相信我，这不是家庭作业，我正在努力做到这一点，因为我正在使用一些旧版本的 c++ 库，因此我无法链接像 opencv 这样的新库。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T03:35:57.327

人们为这些东西使用库是有原因的——这很难。除了最简单的格式之外，所有格式都需要大量代码来解码。

对于 JPEG，标准是[IJG 组的](http://www.ijg.org/)实现。

对于 TIFF，您可以使用[LibTIFF](http://www.libtiff.org/)。

这些库都不是微不足道的。

# javascript - 使用 jquery 在单击触发器时加载 iframe

> ID：13261983
> 
> 赞同：-1
> 
> 时间：2012-11-07T01:24:37.570
> 
> 标签：javascript, jquery, onclick

我正在开发一个基于搜索引擎的网站，该网站使用 iframe 将谷歌地图嵌入到每个搜索引擎结果中。问题是大多数用户不关心查看地图，并且在每个搜索结果页面上加载 20 个 iframe，而其中超过 1 个被查看的机会非常渺茫，这很糟糕，因为会减慢网站的加载时间。我正在尝试仅在单击具有“地址链接”的触发器时才加载具有“地址弹出”类的容器内的 iframe。我在我的 css 中将 iframe 的显示设置为 none，尽管它似乎仍在加载，甚至在它可见之前。

触发代码：

```
<span class="address-link">Address</span> 
```

iframe 代码：

```
echo '<div class="address-popup">
            <iframe class="map" style="margin-top:45px;" width="570" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com/maps?f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q='.$addressString.'&amp;aq=&amp;ie=UTF8&amp;hq=&amp;hnear='.$addressString.'&amp;t=m&amp;z=14&amp;iwloc=A&amp;output=embed"></iframe>
       </div>'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:41:00.233

为什么要使用 iframe？您可以直接在一个常见的“弹出式”DIV 中加载谷歌地图，然后在每次点击链接时将该地图居中到选定的地址。这可能比加载整个 HTML 页面要好得多。

这是一个来自概念证明的工作示例，我帮助我的一个朋友实现了 javascript/maps 功能。

```
http://184.106.239.214/pacific_grove_zoning/ 
```

只看源代码。您可以通过在自动完成字段中输入一些地址（“1234..”、“1000...”等）然后选择一个地址来查看地图的变化。

这是该站点中与 google maps 功能相关的主要 javascript 部分

```
function map_initialize() {
    // instantiate google map
    var initialLatlng = new google.maps.LatLng(37.4328, -122.077);
    var initialOptions = {
        zoom: 18,
        center: initialLatlng,
        mapTypeId: google.maps.MapTypeId.HYBRID
    }
    map = new google.maps.Map(document.getElementById('property_map'), initialOptions);
    geocoder = new google.maps.Geocoder();
}

function map_to_address(address) {
    if (marker != undefined) {
        marker.setMap(null);
    }
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        // map.fitBounds(results[0].geometry.bounds);
        marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
        });
      } else {
        alert("Unable to map provided address. Error: " + status);
      }
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T01:31:10.867

您可以在 javascript 中包含所有 iframe 的代码。如果你喜欢使用 jQuery，可以这样做：

```
$('.address-link').click(function(){
   $('.address-popup').html('<iframe class="map" style="margin-top:45px;" width="570" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com/maps?f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q='.$addressString.'&amp;aq=&amp;ie=UTF8&amp;hq=&amp;hnear='.$addressString.'&amp;t=m&amp;z=14&amp;iwloc=A&amp;output=embed"></iframe>'); 
}); 
```

一种更具体的方法可能是使用 data 属性定义目标容器的 id，如下所示：

HTML

```
<span class="address-link" data-target-id="target-div-7">Address</span>
<div id="target-div-7"></div> <!-- target div --> 
```

jQuery

```
$('.address-link').click(function(){
   var targetId = $(this).data('target-id');
   $('#' + targetId).html('<iframe class="map" style="margin-top:45px;" width="570" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com/maps?f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q='.$addressString.'&amp;aq=&amp;ie=UTF8&amp;hq=&amp;hnear='.$addressString.'&amp;t=m&amp;z=14&amp;iwloc=A&amp;output=embed"></iframe>'); 
}); 
```

因此对于每个触发器，您可以将目标 id 定义为数据属性，并且可以使用相同的脚本。

# grails - GORM 多对多映射并可与附加字段连接

> ID：13261984
> 
> 赞同：10
> 
> 时间：2012-11-07T01:24:39.317
> 
> 标签：grails, many-to-many, grails-orm, jointable

我正在使用遗留数据库，并且与一个连接表有一个多对多的关联，我已经在很大程度上解决了这个问题，因为映射工作正常。但是还有一个额外的列，如果是 Book，Author 模型可以说 nm_author_books 包含一个名为“royalty”的字段。问题是如何从任何方向访问此字段？

```
class Book {
    String title
    static belongsTo = Author
    static hasMany = [authors: Author]
    static mapping = { authors joinTable: [name: "mm_author_books", key: 'mm_book_id' ] } 
}
class Author {
    String name
    static hasMany = [books: Book]
    static mapping = { books joinTable: [name: "mm_author_books", key: 'mm_author_id'] } 
} 
```

如果 nm_author_book 表有 [nm_book_id, nm_author_id, 版税] 访问版税的方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-06-17T14:18:41.757

基本思想是从 1 多对多到 2 多对一：一本书有很多 BookAuthorDetail，而作者有很多 BookAuthorDetail

```
class Book {
    String title

    static hasMany = [details: BookAuthorDetail]
}
class Author {
    String name
    static hasMany = [details: BookAuthorDetail]
}

class BookAuthorDetail {
    String royalty
    static belongsTo = [book: Book, author: Author]
} 
```

要通过 BookAuthorDetail 访问版税，您可以执行以下操作：`BookAuthorDetail.findAllByBookAndAuthor(bookInstance, authorInstance)`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-07T14:14:45.023

您可以创建一个域对象来对连接表进行建模，这样您就不必更改 Book 和 Author 的映射，而是让它们指向 AuthorBookRoyalty 域。

```
Class AuthorBookRoyalty {
  Author author
  Book book
  Long royalty
}

class Book {
  String title
  static belongsTo =Author
  Static hasMany[authors: AuthorBookRoyalty]
} 
```

对作者执行类似操作，您现在可以处理版税。您可能需要调整连接表上的映射以使其映射到您当前的数据库。

# regex - R中的字符匹配

> ID：13261985
> 
> 赞同：0
> 
> 时间：2012-11-07T01:24:44.793
> 
> 标签：regex, r

在 R 中，我有表：

```
Field1

&&hello
&hi
Hello
Hi 
```

如何删除以“&”开头的所有内容？

```
gsub("&", "", A$Field1) 
```

只会删除“&”，但不会删除“&&hello”或“&hi”，因为我需要它。我尝试了“&*”或“&+”，但它仍然无法正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:34:40.233

使用`gsub`，您需要匹配整个字符串：

```
gsub("^&.*", "", A$Field1) 
```

但我发现了一个更优雅`ifelse`的组合：`grepl`

```
ifelse(grepl("^&", A$Field1), "", A$Field1) 
```

如果目标是在您的数据框中替换它，那么您可以重新分配：

```
A$Field1 <- ifelse(grepl("^&", A$Field1), "", A$Field1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T01:40:25.510

我不是 100% 确定你在问什么，但如果你想删除带有 & 符号的行，你可以使用：

```
a <- c("&hi", "&&hello", "Hello", "Hi")

b <- a[-grep("&", a)]

> b
[1] "Hello" "Hi" 
```

干杯，吉姆

# ruby-on-rails - 测试 Resque 时如何区分测试队列和真实队列（使用 rspec 和 rails？）

> ID：13261986
> 
> 赞同：3
> 
> 时间：2012-11-07T01:25:15.953
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, rspec2, resque

我想测试一些 resque 工人，以及与这些工人一起排队工作的行为。我正在使用 rspec 和 rails。

目前我有一个模型，我们称之为 Article.rb，它有一个名为 updates_related_categories 的 before_save 方法，用于检查是否需要将具有 CategoriesSorter 的作业加入队列。如果是这样，它会使用与该文章相关的类别 id 的参数将该工作排入队列。

然而，在测试中，这些作业被发送到与开发服务器发送作业相同的队列中。（我使用 resque 服务器进行检查，您可以在 root/redis/overview 中绑定到您的服务器）

我想知道：

1) 如何将测试作业发送到与开发作业不同的队列？

如果这是可能的，也欢迎任何其他关于测试 resque 的建议。

我已经看到一些相关的问题，建议使用 resque-unit 和 resque-spec，但这些问题还很不成熟，我无法让它们进入有用的工作状态。另外，我听说过使用 Resque.inline 但我不知道这在这种情况下是否相关，因为在测试规范中没有调用 resque，它是在保存测试中创建的对象的文章模型中调用的。

示例代码：

文章.rb：

```
 before_save :update_related_categories
 def update_related_categories
     #some if statements/checks to see if a related category needs updating
         Resque.enqueue(CategoriesWorker, [category_id])
     end
 end 
```

分类排序器：

```
 class CategoriesSorter
     @queue=:sorting_queue
     def self.perform(ids)
        ids.each do |id|
           #some code
        end
      end
 end 
```

眼镜：

```
 it "should do something" do
     @article = #set something to enqueue a job
     @article.save
     #can i check if a job is enqueued? can i send this job NOT to the development queue but a different one?
 end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T18:51:18.527

正如我所看到的，您不想测试将作业排入队列是否会导致执行被调用 - 我们相信 Resque 会做它应该做的事情。但是，您可以测试 1\. 调用 update_related_categories 将作业排入队列。然后，您可以单独测试 2\. 调用 perform 的工作人员是否会产生所需的行为。

一般来说，为了测试 Resque，结合 resque-spec 和模拟一个 worker 可以实现上述两个目标。

对于 1，使用 resque-spec，您可以模拟一个工作人员在您的类上调用 perform 方法，然后检查它是否已正确入队：

```
describe "Calling update_related_categories " do
  before(:each) do
    ResqueSpec.reset!
  end

  it "should enqueue the job" do
    Article.update_related_categories
    CategoriesSorter.should have_queue_size_of(1)
  end
end 
```

对于 2，您可以创建一个 Job（并指定一个与开发队列不同的队列名称）、一个 Resque::Worker 然后将 Worker 分配给 Job：

```
def run_worker_simulation
  # see Resque::Job api for setting the args you want
  Resque::Job.create('test_queue_name', 'class_name', 'type', 'id')

  worker = Resque::Worker.new('test_queue_name')
  worker.very_verbose = true

  job = worker.reserve
  worker.perform(job)
end 
```

希望能给你一些想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T18:56:01.077

我有

```
Resque.inline = ENV['RAILS_ENV'] == "test" 
```

这使得所有 resque 任务在**测试**环境中都是内联的。

为了测试每个作业类，我有单独的规范来分别测试每个**作业的****执行**方法。

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T13:36:26.400

您不应该测试 resque，这是 resque 开发团队的工作，您的应用程序应该只测试您的 perfom 方法是否完成了它必须做的事情。您还可以测试您的模型 Article.rb 是否根据需要将作业排入队列。将真正的作业发送到 resque 是没有用的，您的测试将结束，reque 队列将充满无用的作业。

执行以下操作：

```
describe 'Article' do
  before(:each) do
    Resque.stub!(:enqueue)
  end

  it 'enqueues the job' do
    cat_id = 1
    Resque.should_receive(:enqueue).once.with(CategoriesWorker, [cat_id])
    Article.create(:category_id => cat_id)
  end
end

describe 'CategoriesSorter' do
  it 'sorts the categories' do
    result = CategoriesSorter.perform([1,4,6,3,2])
    result.should == [1,2,3,4,6]
  end
end 
```

存根或模拟不需要的方法/类

编辑：另外，当您测试文章时，最好将 before(:each) 过滤器设置为存根 resque，这样您的规范就不会将作业发送到真正的队列，我已经编辑了我的答案**

# ios - Facebook iOS SDK v3.1：当其他用户在 Facebook 登录时，如何注销我的应用程序中的前一个用户？

> ID：13261988
> 
> 赞同：1
> 
> 时间：2012-11-07T01:25:51.943
> 
> 标签：ios, facebook, facebook-ios-sdk

如果用户从 Facebook 应用注销，我的应用不会受到影响。然后，如果他通过 Facebook 应用程序使用其他帐户登录，我的应用程序无法检测到它。

如何检测是否有其他用户/帐户正在使用我的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T03:16:08.303

您可以使用图形 api 获取 facebook 用户的 id（以及更多）：

```
[[FBRequest requestForMe] startWithCompletionHandler:^(FBRequestConnection *connection,NSDictionary<FBGraphUser> *user, NSError *error) {
    if (!error) {
        NSLog(@"%@",user.id);
    }
}]; 
```

您可以使用它来检测哪个用户正在使用您的应用程序。

# c# - 使用 LINQ to Entities 获取字符的最后一个索引

> ID：13261991
> 
> 赞同：2
> 
> 时间：2012-11-07T01:26:38.567
> 
> 标签：c#, linq-to-entities

我收到错误：

```
LINQ to Entities does not recognize the method 'Int32 LastIndexOf(System.String)' 
method, and this method cannot be translated into a store expression. 
```

当使用此代码来判断一个人的姓氏是否以某些字符开头时：

```
persons = persons.Where(c => c.FullName.IndexOf(" ") > 0 &&
c.FullName.Substring(c.FullName.LastIndexOf(" ")+1).StartsWith(lastNameSearch)); 
```

任何线索如何在不使用 LastIndexOf() 的情况下实现这一目标？也许我必须在使用 ToList() 从数据库中获取结果后检查这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T01:34:53.547

您受到可转换为 SQL 查询的[规范函数](http://msdn.microsoft.com/en-us/library/bb738681.aspx)集的限制，因此任何解决方案都必须仅使用规范函数提供的内容来实现。

幸运的是，支持的功能之一是`bool Contains(string)`实例方法。您可以将支票重写为

```
persons = persons.Where(c => c.FullName.Contains(" " + lastNameSearch)); 
```

这与您当前的版本不*完全*一样（因为它允许拥有多个名字的人匹配他们的第二个名字，而前者不会），但它非常接近，恕我直言。

当然，如果可能的话，将姓氏作为一个单独的列保存在数据库中会比任何其他方法都要好得多。

# ruby-on-rails - RDoc 只是我自己的应用程序？

> ID：13261994
> 
> 赞同：1
> 
> 时间：2012-11-07T01:26:53.493
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rubygems, rdoc

有没有办法阻止 RDoc 高于当前目录？我刚试过

```
rdoc -O -x ../ 
```

但这也阻止了它解析子目录中的相对路径；我真正需要的是：

如果 App 的绝对路径是 /foo/bar/MyAppDir/，则只需 RDoc /foo/bar/MyAppDir/ 内部和下方的所有源，而不解析 /foo/bar/OtherRepository/ 从其中一些类派生并获取我不想记录的函数.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T13:48:54.250

这可能会有所帮助 -[为 Rails 应用程序创建 Rdoc](https://stackoverflow.com/questions/7279953/creating-rdoc-for-a-rails-app)

您可能会包含您只需要解析的文件/目录。这对于轨道 2 和 3 应该以相同的方式工作。

# ruby-on-rails - Ruby on Rails div_for vs

> ID：13261995
> 
> 赞同：8
> 
> 时间：2012-11-07T01:27:01.567
> 
> 标签：ruby-on-rails

我是 Ruby on Rails 的新手。在我的 erb 文件中，是否有任何理由使用`div_for`帮助程序而不是仅键入`<div>`标签并将属性设置为 HTML？使用 有什么好处`div_for`，是否有推荐的最佳实践？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-07T01:43:06.767

我认为人们使用 helper 的主要原因`div_for`是因为它可以接受 ActiveRecord 对象数组作为参数。这样它就变成了循环迭代器和标签生成器的简写组合。

```
<%= div_for(@people, :class => "foo") do |person| %>
    <%= person.name %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-07T01:39:23.773

`div_for`为您做了一些“魔术”，因为它设置了它生成的元素的类和 ID。

`<div>`如果您不打算使用这些属性，或者打算为它们使用不同的值，则没有理由选择它而不是简单的标记。

无论哪种方式，都没有强烈的约定。我多年来一直在编写 Rails 代码，但实际上从未使用过它，把它从你的脑海中抹去，没关系。有很多更重要的决定要做，比如选择[erb](http://ruby-doc.org/stdlib-1.9.3/libdoc/erb/rdoc/ERB.html)或[haml](http://haml.info/)或[slim](http://slim-lang.com/)，或者决定是否采用[CoffeeScript](http://coffeescript.org/)。将从根本上改变您编写 Rails 代码方式的决策。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T01:45:31.080

在许多情况下，铁轨“助手”就像自行车上的辅助轮。当您刚开始时，它们会有所帮助，但在某些时候，您会抛弃训练轮并开始进行带轮、滑行和跳跃自制坡道。

但是帮手各不相同，有些非常有帮助，以至于您永远无法摆脱它们，而有些则在您想开始做带轮车时会妨碍您。

如果您发现使用任何特定的“助手”会限制您的风格，请停止使用它！

# c# - 在C#中一个接一个地启动进程

> ID：13261997
> 
> 赞同：1
> 
> 时间：2012-11-07T01:27:05.227
> 
> 标签：c#, process, foreach

有没有办法遍历数组/列表并启动一个进程，然后等到它退出直到启动下一个，等等？

我有代码：

```
string[] processPaths = new string[]{ @"c:\foo.exe", @"c:\bar.exe" };
foreach(string s in processPaths){
    Process p = new Process();
    p.Exited += (obj, ev) => { continue; };
} 
```

但显然进程是异步执行的，并且 lambda 函数不是`foreach`循环的一部分。这是一个控制台应用程序，我不介意它是否在主线程上运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T01:29:59.570

[`Process.WaitForExit()`](http://msdn.microsoft.com/en-us/library/a4b407xt.aspx)就是你要找的。

> 指示 Process 组件无限期地等待关联的进程退出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T01:39:02.883

```
foreach (var name in names)
{
   var process = Process.Start(name);
   process.WaitForExit();
} 
```

# internet-explorer - 直接设置 `scrollTop` 和使用 `$.animate` 设置的区别

> ID：13261999
> 
> 赞同：0
> 
> 时间：2012-11-07T01:27:41.690
> 
> 标签：internet-explorer, scroll, jquery-animate, mousewheel

在`mousewheel`事件处理程序中，我更改了更新元素的语句`scrollTop`：

```
-        list.scrollTop(newScrollTop);
+        list.animate({
+            scrollTop: newScrollTop
+        }, 80); 
```

我添加了这个`animate`以使列表平滑滚动，并且它像原始声明一样在 Chrome 上工作。

但在 IE7 上，该`animate`版本使滚动无法使用，当我滚动时，列表仅在屏幕上移动 10px。

这可能是什么原因？