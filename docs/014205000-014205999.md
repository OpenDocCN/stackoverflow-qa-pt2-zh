# StackOverflow 问答 14205000-14205999

# c++ - 在数据类型由传入值确定的函数中分配内存

> ID：14205013
> 
> 赞同：1
> 
> 时间：2013-01-07T22:15:43.397
> 
> 标签：c++, type-conversion

我想为函数内的 3D 数组分配内存。

```
void*** myFunc(int myType){

  double ***p2DArray;

  // Allocate memory
  p2DArray = new double**[HEIGHT];
  for (int i = 0; i < HEIGHT; ++i) {
    p2DArray[i] = new double*[WIDTH];

    for (int j = 0; j < WIDTH; ++j) {
      p2DArray[i][j] = new double[DEPTH];
      for (int k = 0; k < LENGTH; ++k)
          p2DArray[i][j][k] = 0;
    }
  }
  return p2DArray;
} 
```

在上面的代码中，创建了 double 类型。我的问题是如何根据`myType`参数创建不同的数据类型？顺便说一句，我不想​​把上面的代码复制两次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:27:02.973

当您发现自己想要将类型传递给 C++ 中的函数时，您需要使用模板：

```
template <typename T>
T*** func() {
    T*** array;
    array = new T**[HEIGHT];
    ...
    return array
} 
```

然后你可以像这样调用这个函数：

```
double*** var = func<double>(); 
```

当编译器看到对它的调用时`func<double>()`，它将查找模板`func()`并生成一个常规（非模板）函数，该函数只需将所有`T`'s替换为`double`.

对于此设计，您应该考虑使用惯用的 C++ 容器，例如向量。这提供了许多使您的代码更安全、更易读的功能，例如迭代器。

向量的一种选择是简单地将数组替换为`vector<vector<vector<T>>>`. 另一种选择是使用`vector<T>`大小为`WIDTH * HEIGHT * DEPTH`.

# android - 发出 WebView http 请求，以便网站/服务不返回移动特定内容

> ID：14205014
> 
> 赞同：1
> 
> 时间：2013-01-07T22:15:43.487
> 
> 标签：android

我正在创建一个 Webview，它从提供移动特定 http 响应的站点加载内容。问题是我不想要这个回复，我更喜欢常规的提要。如何防止网站将请求视为来自移动设备？我在想也许有一种方法可以防止网站将请求识别为来自移动设备。也许是 Webview 中的清单选项或某些选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:30:32.400

```
String UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/20100101 Firefox/13.0.1";

WebSettings webSettings = myWebView.getSettings();
webSettings.setUserAgentString(UserAgent); 
```

或者：

`myWebView.getSettings().setUserAgentString(UserAgent);`

# javascript - Rails 3 Trigger AJAX Submit On Radio Button Change正在呈现html响应

> ID：14205016
> 
> 赞同：1
> 
> 时间：2013-01-07T22:15:53.270
> 
> 标签：javascript, ruby-on-rails, ajax, forms

rails 3 形成部分

```
<%= form_for(answer, :remote => true) do |f| %>
  <% if answer.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(answer.errors.count, "error") %> prohibited this answer from being saved:</h2>
      <ul>
        <% answer.errors.full_messages.each do |msg| %>
            <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <div class="field">
    <%= f.hidden_field :conduct_evaluation_id, :value => conduct_evaluation.id %>
  </div>
  <div class="field">
      <%= f.hidden_field :question_id, :value => question.id %>
  </div>
  <div class="field">
    <%= f.hidden_field :program_block_id, :value => conduct_evaluation.program_block_id %>
  </div>
  <div class="field">
    <%= f.radio_button :answer, true, :onchange => "$(this.form).trigger('submit.rails');" %>yes<br/>
    <%= f.radio_button :answer, false, :onchange => "$(this.form).trigger('submit.rails');" %>no<br/>
  </div>
  <div class="actions">
    <%= f.submit "Answer" %>
  </div>
<% end %> 
```

控制器动作

```
 # POST /answers
  # POST /answers.json
  def create
    @answer = Answer.new(params[:answer])
    @answer.user = current_user
    @answer.conduct_evaluation = ConductEvaluation.find(params[:answer][:conduct_evaluation_id])

    respond_to do |format|
      if @answer.save
        format.js { }
        format.html { redirect_to @answer, notice: 'Answer was successfully created.' }
        format.json { render json: @answer, status: :created, location: @answer }
      else
        format.js { }
        format.html { render action: "new" }
        format.json { render json: @answer.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /answers/1
  # PUT /answers/1.json
  def update
    @answer = Answer.find(params[:id])

    respond_to do |format|
      if @answer.update_attributes(params[:answer])
        format.js { }
        format.html { redirect_to @answer, notice: 'Answer was successfully updated.' }
        format.json { head :no_content }
      else
        format.js { }
        format.html { render action: "edit" }
        format.json { render json: @answer.errors, status: :unprocessable_entity }
      end
    end
  end 
```

谁能告诉我我做错了什么让javascript通过ajax提交？当我使用提交按钮时，请求是通过 ajax 发送的。如果我对单选按钮使用 onchange 事件并尝试通过 javascript 提交表单，它会认为请求是 HTML。

任何帮助将非常感激！

-J

**编辑：** 所以当我使用表单提交按钮时，请求略有不同：

```
Processing by AnswersController#create as JS
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"IcJkV1GnIOEGRs7kaRuVQsp0sTNtHQw0Q+HMM7m/mV0=", "answer"=>{"conduct_evaluation_id"=>"15", "question_id"=>"1", "program_block_id"=>"1", "answer"=>"true"}, "commit"=>"Answer"} 
```

与使用 onchange javascript 触发 rails.submit 事件相比：

```
Processing by AnswersController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"IcJkV1GnIOEGRs7kaRuVQsp0sTNtHQw0Q+HMM7m/mV0=", "answer"=>{"conduct_evaluation_id"=>"15", "question_id"=>"1", "program_block_id"=>"1", "answer"=>"true"}} 
```

有谁知道为什么会发生这种情况？触发 submit.rails 事件时是否需要指定额外的参数？请帮忙！:-D

**编辑2：** 所以我找到了一种解决方法。如果我将单选按钮的更改事件绑定到实际单击提交按钮，它会起作用。这不是理想的解决方案，但至少它有效。

**编辑 3：** 我决定使用以下咖啡脚本：

```
$(document).ready ->
    $('#my_form input:submit').hide()
    $('#my_form input:radio').change ->
        $.ajax
            type: $(this.form).attr('method')
            url: $(this.form).attr('action')
            data: $(this.form).serialize()
            dataType: 'script' 
```

这允许将相应的 js 操作文件作为响应返回并在成功时自动执行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T16:49:16.760

使用`onchange()`绕过 Rails 魔法，因此它不会按照您的意愿提交表单。编写自己的更改方法，fe：

```
$('input.radio_button_selector').change( function() {
    $.ajax({
        url: $('#my_form').attr('action'),
        data: $('#my_form').serialize()
    });
}); 
```

# ruby - Rubinius 语法错误

> ID：14205019
> 
> 赞同：0
> 
> 时间：2013-01-07T22:16:00.993
> 
> 标签：ruby, lambda, ruby-1.9, rubinius, locomotivecms

在使用[Rubinius使用](http://rubini.us/)[LocomotiveCMS](http://www.locomotivecms.com/)时，我遇到了一堆语法错误。一切都是如此。没有人发布关于此的[问题](https://github.com/locomotivecms/engine/issues)，所以我想我会问：我该如何解决这些问题？这是鲁比尼乌斯的问题吗？`expecting '|'`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:16:00.993

首先，LocomotiveCMS 仅支持“Ruby 的最新版本”（Ruby 1.9.2 及更高版本）。[查看要求部分](http://doc.locomotivecms.com/installation/requirements)。

Rubinius 默认为 Ruby 1.8.7（[在 rvm.io 上查看](https://rvm.io/interpreters/rbx/)）。如果您查看大多数这些语法错误发生的行，就像`app/models/locomotive/page.rb`它们最有可能出现在 Ruby 1.9 之前不支持的“lambdas”中一样。

要解决此问题，您可以通过两种方式让 Rubinius (rbx) 使用 Ruby 1.9：

1.  使用[rvm](https://rvm.io/)重新安装 rbx，默认使用 Ruby 1.9：

    ```
    rvm reinstall rbx --1.9 
    ```

    注意：如果 rvm 抱怨参数错误，请使用or[升级 rvm](https://rvm.io/rvm/upgrading/)。`rvm get master``rvm get stable`

2.  或者，如果您不想完全重新安装 rbx，您可以在您将调用 Rubinius 的目录中设置一个环境变量，例如在 rails 根目录中。

    ```
    export RBXOPT=-X19 
    ```

    `rbx -v`您可以使用检查 Ruby 版本来检查是否设置了环境变量。它应该返回如下内容：

    ```
    rubinius 2.0.0.rc1 (1.9.3 release ...) 
    ```

    注意：如果您从另一个目录运行 Rubinius，您将需要再次设置此选项。

# perl - Text::CSV perl 模块中的 is_quoted() 方法

> ID：14205022
> 
> 赞同：6
> 
> 时间：2013-01-07T22:16:09.447
> 
> 标签：perl, csv, perl-module

我可能遗漏了一些明显的东西，但是我有一个非常简单的 perl 脚本，其中 Text::CSV 模块中的 is_quoted() 方法没有按预期工作。这是代码：

```
# cat ./testcsv.pl
#!/usr/bin/perl

use strict;
use Text::CSV;

my $csv = Text::CSV->new ( { quote_char => '"' } )
        or die "Cannot use CSV: ".Text::CSV->error_diag ();

print "Text::CSV version = " . $csv->version() . "\n\n";

my $line = '"text field 111",222,"text field 333",444';

my $status  = $csv->parse($line);
if ($status)
  {
  my $column_idx = 0;
  my @fields = $csv->fields ();
  foreach my $field (@fields)
     {
     my $quoted = $csv->is_quoted ($column_idx);
     $column_idx++;
     print "field #$column_idx: '$field'; quoted = " . ($quoted ? "YES\n" : "NO\n");
     }
  } 
```

这是我运行脚本时得到的结果：

```
    # perl -v | grep "是 perl"
    这是为 PA-RISC2.0 构建的 perl，v5.10.1 (*)
    # ./testcsv.pl
    文本::CSV 版本 = 1.29

    字段 #1: '文本字段 111'; 引用 = 否
    字段#2：'222'；引用 = 否
    字段 #3: '文本字段 333'; 引用 = 否
    字段#4：'444'；引用 = 否
    #

```

正如我们所看到的， parse() 方法正确地将原始字符串分隔为字段，因此我知道 Text::CSV 已安装并正常工作。我通过阅读[Text::CSV 的文档](http://search.cpan.org/~makamaka/Text-CSV-1.21/lib/Text/CSV.pm)了解到，如果指定列中的数据包含在 quote_char 引号中，则 is_quoted() 方法应该返回一个真值。因此，我希望在字段 1 和 3 之后看到“是”，因为它们在 $line 变量的初始化中明确引用。但这并没有发生。

我做错了什么，还是 Text::CSV 坏了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T22:25:42.623

您需要指定`keep_meta_info => 1`.

* * *

顺便说一句，我不喜欢有两个迭代器，所以我会迭代索引。

```
my @fields = $csv->fields();
for my $column_idx (0..$#fields) {
   my $field = $fields[$column_idx];
   ...
} 
```

# ember.js - 以后如何在 Ember 的 v2 路由器中存储路径并转换到它？

> ID：14205024
> 
> 赞同：4
> 
> 时间：2013-01-07T22:16:16.910
> 
> 标签：ember.js, ember-router

我正在尝试迁移到 Ember 中的新路由器。用例是这样的：用户未登录，但请求需要登录的 URL。他被重定向到登录路径，成功登录后，他被重定向到原来的目的地。

我通过覆盖 Router.route(path) 并在应用程序处于未经授权状态时拦截路径请求，使用先前的路由器实现了这一点。

新的路由器没有 route() 函数，而且我不知道如何覆盖它，因为路由器实例是由 Ember 自动创建的。我可能不应该那样做。

有一个看起来很有用的 Route.redirect() 钩子。但是，Route 不再扩展 v2 Router 中的 Path，因此没有 Root.path，也没有将路径信息传递给 Route.redirect()，所以我不知道如何保存调用 transitionTo() 的路径信息之后。

我在下面提供了我的一般方法。我怎样才能做到这一点？对于许多应用程序来说，这似乎是一个非常常见的用例。

```
 // i imagine something like this should happen
  App.AuthRequiredRoute = Ember.Route.extend({
       redirect: function() {
            if(!App.controllerFor('login').get('isLoggedIn')) {
                  var pathToSave = ????
                  App.controllerFor('login').set('pathAfterLogin',pathToSave);
                  this.transitionTo('login');
             }
        }
   }
   // and then after login, the LoginController would call App.router.transitionTo(this.pathAfterLogin) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:05:48.940

在过去的一两天里，我自己对此做了很多研究。我可以与您分享我的发现和一些想法。

首先，您可以获得一些有关当前路径和上下文的信息，如下所示：

```
this.router.router.currentHandlerInfos 
```

这将返回一个数组。每个对象都有一个名称和一个上下文属性。这些名称对应于您将在 transitionTo 中调用的路由器的名称。

在我看来，虽然你可以使用这样的东西，但它会很混乱。API 文档没有提到这一点，并且可能无意将其用作公共 API。

对于更深的嵌套动态段，我也看到了上述解决方案的问题。鉴于路由器 v2 有多新，我认为它将继续发展，并且可能会出现更好的解决方案。想要保存当前位置并在以后返回它是一件相当普遍的事情。

同时，如果未在 ApplicationController 上设置身份验证标志，则可能在模板中使用条件块而不是重定向，以呈现登录而不是出口？我知道这不是“正确的”，而是“现在”。

# scala - 是否有任何功能语言编译器/运行时可以优化链式迭代？

> ID：14205027
> 
> 赞同：11
> 
> 时间：2013-01-07T22:16:26.113
> 
> 标签：scala, optimization, functional-programming, compiler-optimization

任何函数式语言编译器/运行时是否会在适用时将所有链式迭代减少为一个？从程序员的角度来看，我们可以使用惰性和流等结构来优化功能代码，但我有兴趣了解故事的另一面。我的功能示例是用 Scala 编写的，但请不要将您的答案局限于该语言。

功能方式：

```
// I assume the following line of code will go
// through the collection 3 times, one for creating it
// one for filtering it and one for summing it 
val sum = (1L to 1000000L).filter(_ % 2 == 0).sum // => 250000500000 
```

我希望编译器优化为以下命令式等价物：

```
/* One iteration only */
long sum, i;
for (i = 1L, sum = 0L; i <= 1000000L; i++) {
  if (i % 2 == 0)
    sum += i;
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-07T23:43:18.763

Haskell 根据定义是一种非严格语言，我知道的所有实现都使用惰性求值来提供非严格语义。

类似的代码（带有开始和结束的参数，所以编译时评估是不可能的）

```
val :: Int -> Int -> Int
val low high = sum $ filter even [low .. high] 
```

仅通过一次遍历计算总和，并且在恒定的小内存中。`[low .. high]`是 for 的语法糖，for的`enumFromTo low high`定义基本上是`enumFromTo``Int`

```
enumFromTo x y
    | y < x     = []
    | otherwise = go x
      where
        go k = k : if k == y then [] else go (k+1) 
```

（实际上，GHC 的实现使用 unboxed`Int#`是为了提高 worker 的效率`go`，但这对语义没有影响；对于其他`Integral`类型，定义类似）。

的定义`filter`是

```
filter :: (a -> Bool) -> [a] -> [a]
filter _pred []    = []
filter pred (x:xs)
  | pred x         = x : filter pred xs
  | otherwise      = filter pred xs 
```

和`sum`：

```
sum     l       = sum' l 0
  where
    sum' []     a = a
    sum' (x:xs) a = sum' xs (a+x) 
```

组装起来，即使没有任何优化，评估也会继续进行

```
sum' (filter even (enumFromTo 1 6)) 0
-- Now it must be determined whether the first argument of sum' is [] or not
-- For that, the application of filter must be evaluated
-- For that, enumFromTo must be evaluated
~> sum' (filter even (1 : go 2)) 0
-- Now filter knows which equation to use, unfortunately, `even 1` is False
~> sum' (filter even (go 2)) 0
~> sum' (filter even (2 : go 3)) 0
-- 2 is even, so
~> sum' (2 : filter even (go 3)) 0
~> sum' (filter even (go 3)) (0+2)
-- Once again, sum asks whether filter is done or not, so filter demands another value or []
-- from go
~> sum' (filter even (3 : go 4)) 2
~> sum' (filter even (go 4)) 2
~> sum' (filter even (4 : go 5)) 2
~> sum' (4 : filter even (go 5)) 2
~> sum' (filter even (go 5)) (2+4)
~> sum' (filter even (5 : go 6)) 6
~> sum' (filter even (go 6)) 6
~> sum' (filter even (6 : [])) 6
~> sum' (6 : filter even []) 6
~> sum' (filter even []) (6+6)
~> sum' [] 12
~> 12 
```

这当然比循环效率低，因为对于枚举的每个元素，都必须生成一个列表单元格，然后对于每个通过过滤器的元素，必须生成一个列表单元格，然后立即被总和消耗.

让我们检查一下内存使用量确实很小：

```
module Main (main) where

import System.Environment (getArgs)

main :: IO ()
main = do
    args <- getArgs
    let (low, high) = case args of
                        (a:b:_) -> (read a, read b)
                        _       -> error "Want two args"
    print $ sum $ filter even [low :: Int .. high] 
```

并运行它，

```
$ ./sumEvens +RTS -s -RTS 1 1000000
250000500000
      40,071,856 bytes allocated in the heap
          12,504 bytes copied during GC
          44,416 bytes maximum residency (2 sample(s))
          21,120 bytes maximum slop
               1 MB total memory in use (0 MB lost due to fragmentation)

                                    Tot time (elapsed)  Avg pause  Max pause
  Gen  0        75 colls,     0 par    0.00s    0.00s     0.0000s    0.0000s
  Gen  1         2 colls,     0 par    0.00s    0.00s     0.0002s    0.0003s

  INIT    time    0.00s  (  0.00s elapsed)
  MUT     time    0.01s  (  0.01s elapsed)
  GC      time    0.00s  (  0.00s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time    0.01s  (  0.01s elapsed)

  %GC     time       6.1%  (7.6% elapsed)

  Alloc rate    4,367,976,530 bytes per MUT second

  Productivity  91.8% of total user, 115.8% of total elapsed 
```

它为 50 万个列表单元^((1))分配了大约 40MB，并进行了一些更改，但最大驻留量约为 44KB。以 1000 万的上限运行它，总体分配（和运行时间）增长了 10 倍（减去常量），但最大驻留时间保持不变。

^((1)) GHC 将枚举和过滤器融合在一起，只产生类型为 的范围内的偶数`Int`。不幸的是，它不能融合`sum`，因为那是一个左折叠，而 GHC 的融合框架只融合右折叠。

现在，为了融合`sum`，必须做很多工作来教 GHC 用重写规则来做到这一点。幸运的是，包中的许多算法已经这样做了`vector`，如果我们使用它，

```
module Main where

import qualified Data.Vector.Unboxed as U
import System.Environment (getArgs)

val :: Int -> Int -> Int
val low high = U.sum . U.filter even $ U.enumFromN low (high - low + 1)

main :: IO ()
main = do
    args <- getArgs
    let (low, high) = case args of
                        (a:b:_) -> (read a, read b)
                        _       -> error "Want two args"
    print $ val low high 
```

我们得到了一个更快的程序，它甚至不再分配任何列表单元，管道*实际上被*重写为循环：

```
$ ./sumFilter +RTS -s -RTS 1 10000000
25000005000000
          72,640 bytes allocated in the heap
           3,512 bytes copied during GC
          44,416 bytes maximum residency (1 sample(s))
          17,024 bytes maximum slop
               1 MB total memory in use (0 MB lost due to fragmentation)

                                    Tot time (elapsed)  Avg pause  Max pause
  Gen  0         0 colls,     0 par    0.00s    0.00s     0.0000s    0.0000s
  Gen  1         1 colls,     0 par    0.00s    0.00s     0.0001s    0.0001s

  INIT    time    0.00s  (  0.00s elapsed)
  MUT     time    0.01s  (  0.01s elapsed)
  GC      time    0.00s  (  0.00s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time    0.01s  (  0.01s elapsed)

  %GC     time       1.0%  (1.2% elapsed)

  Alloc rate    7,361,805 bytes per MUT second

  Productivity  97.7% of total user, 111.5% of total elapsed 
```

这是 GHC 为 (the worker of) 生产的核心`val`，如果有人感兴趣的话：

```
Rec {
Main.main_$s$wfoldlM'_loop [Occ=LoopBreaker]
  :: GHC.Prim.Int# -> GHC.Prim.Int# -> GHC.Prim.Int# -> GHC.Prim.Int#
[GblId, Arity=3, Caf=NoCafRefs, Str=DmdType LLL]
Main.main_$s$wfoldlM'_loop =
  \ (sc_s303 :: GHC.Prim.Int#)
    (sc1_s304 :: GHC.Prim.Int#)
    (sc2_s305 :: GHC.Prim.Int#) ->
    case GHC.Prim.># sc1_s304 0 of _ {
      GHC.Types.False -> sc_s303;
      GHC.Types.True ->
        case GHC.Prim.remInt# sc2_s305 2 of _ {
          __DEFAULT ->
            Main.main_$s$wfoldlM'_loop
              sc_s303 (GHC.Prim.-# sc1_s304 1) (GHC.Prim.+# sc2_s305 1);
          0 ->
            Main.main_$s$wfoldlM'_loop
              (GHC.Prim.+# sc_s303 sc2_s305)
              (GHC.Prim.-# sc1_s304 1)
              (GHC.Prim.+# sc2_s305 1)
        }
    }
end Rec } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T22:43:00.443

理论上，正如一位评论者所写，编译器可以在编译时将其简化为结果。使用某些宏可以做到这一点并非不可想象，但在一般情况下不太可能。

如果你插入一个`.view`调用，你会在 Scala 中获得惰性语义，因此只会执行一次迭代，尽管它不像你的命令式代码那么简单：

```
val lz = (1L to 1000000L).view.filter(_ % 2 == 0) // SeqView (lazy)!
lz.sum 
```

* * *

PS你的假设是错误的，否则会有三个迭代。`(1L to 1000000L)`创建一个`NumericRange`不涉及对元素进行任何迭代的 a。因此，这可以为`.view`您节省一次迭代。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-08T12:50:21.687

几年前，我发布了两篇关于这个主题的博客文章：

[http://jnordenberg.blogspot.de/2010/03/scala-stream-fusion-and-specialization.html](http://jnordenberg.blogspot.de/2010/03/scala-stream-fusion-and-specialization.html) [http://jnordenberg.blogspot.de/2010/05/scala-stream-fusion-and-specialization.html](http://jnordenberg.blogspot.de/2010/05/scala-stream-fusion-and-specialization.html)

请注意，Scala 编译器完成的专业化和优化从那时起已经有了很大的改进（可能在 Hotspot 中也是如此），所以今天的结果可能会更好。

# sql - 使 SQL 查询结果“打印”？

> ID：14205032
> 
> 赞同：2
> 
> 时间：2013-01-07T22:16:40.297
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我有一个查询，我最终可以正常工作，但我真正需要的是使用 SQL`PRINT`命令显示的结果。这样做的原因是我正在自动化发送电子邮件的结果，如果我可以让它们以打印文本的形式出现，那么我可以使用我们在这里使用的工具将结果嵌入到电子邮件中。否则，必须将当前结果作为文件附加，如果可能，我更喜欢打印文本。

我试图通过添加来修改查询`DECLARE`，`PRINT`但我真的很困惑，无法弄清楚。该查询有 2 个 CTE 从多个数据库中提取数据。它所做的是从我们的 SAP 系统中选择昨天的所有销售编号/ID，并将它们与我们昨天从我们的 POS 系统中的销售编号/ID 进行比较，以确保我们 POS 系统中的每笔销售现在都在 SAP 中。查询本身工作正常。

如何打印此查询的结果？

```
WITH CTE1 (SAP_SALE)
AS
(          
  select distinct convert(BIGINT,convert(varchar(15),WERKS)+(select RIGHT(convert(Varchar(20),BONNR),7)))
  as Branch_tx_no from [PDP].[pdp].[S120] WITH (NOLOCK)
  where SPTAG >= CAST(CONVERT(VARCHAR(10), GETDATE() -1, 101) AS DATETIME) AND
  SPTAG < CAST(CONVERT(VARCHAR(10), GETDATE(), 101) AS DATETIME)
),
CTE2 (AR_SALE)
AS
(
  select convert(varchar(15),branch_no)+convert(varchar(15),sale_tx_no)
  from [ARDB01].[PP_BODATA].[DBO].[sales_tx_hdr] WITH (NOLOCK)
  WHERE sale_date >= CAST(CONVERT(VARCHAR(10), GETDATE() -1, 101) AS DATETIME) AND
  sale_date < CAST(CONVERT(VARCHAR(10), GETDATE(), 101) AS DATETIME)
  and sale_type in ('C','L')
)
SELECT AR_SALE FROM CTE2 AS CTE2
  Left OUTER JOIN CTE1 AS CTE1
  ON CTE1.SAP_SALE = CTE2.AR_SALE
WHERE CTE1.SAP_SALE IS NULL
ORDER BY CTE2.AR_SALE 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:44:24.133

最简单的解决方案是一次使用一个游标和`PRINT`一行。或者，如果结果中没有任何特殊字符，则可以使用 XML 连接：

```
DECLARE @txt NVARCHAR(MAX);

WITH CTE1 (SAP_SALE)
AS
(          
  select distinct convert(BIGINT,convert(varchar(15),WERKS)+(select RIGHT(convert(Varchar(20),BONNR),7)))
  as Branch_tx_no from [PDP].[pdp].[S120] WITH (NOLOCK)
  where SPTAG >= CAST(CONVERT(VARCHAR(10), GETDATE() -1, 101) AS DATETIME) AND
  SPTAG < CAST(CONVERT(VARCHAR(10), GETDATE(), 101) AS DATETIME)
),
CTE2 (AR_SALE)
AS
(
  select convert(varchar(15),branch_no)+convert(varchar(15),sale_tx_no)
  from [ARDB01].[PP_BODATA].[DBO].[sales_tx_hdr] WITH (NOLOCK)
  WHERE sale_date >= CAST(CONVERT(VARCHAR(10), GETDATE() -1, 101) AS DATETIME) AND
  sale_date < CAST(CONVERT(VARCHAR(10), GETDATE(), 101) AS DATETIME)
  and sale_type in ('C','L')
)
SELECT @txt = (
SELECT CHAR(13)+CHAR(10)+AR_SALE FROM CTE2 AS CTE2
  Left OUTER JOIN CTE1 AS CTE1
  ON CTE1.SAP_SALE = CTE2.AR_SALE
WHERE CTE1.SAP_SALE IS NULL
ORDER BY CTE2.AR_SALE
FOR XML PATH(''),TYPE
).value('.','NVARCHAR(MAX)');

PRINT @txt; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T22:44:49.380

如果您需要使用 PRINT，您可以将查询结果组合成逗号（或其他字符）分隔的 VARCHAR 变量，然后打印该变量，例如

```
DECLARE @sTMP varchar(1000)
SET @sTMP = ''

-- Your CTE....
SELECT @sTMP = @sTMP + AR_SALE + ',' FROM CTE2 AS CTE2
  Left OUTER JOIN CTE1 AS CTE1
  ON CTE1.SAP_SALE = CTE2.AR_SALE
WHERE CTE1.SAP_SALE IS NULL
ORDER BY CTE2.AR_SALE

PRINT @sTMP 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T22:46:29.593

```
WITH CTE1 (SAP_SALE)
AS
(          
  select distinct convert(BIGINT,convert(varchar(15),WERKS)+(select RIGHT(convert(Varchar(20),BONNR),7)))
  as Branch_tx_no from [PDP].[pdp].[S120] WITH (NOLOCK)
  where SPTAG >= CAST(CONVERT(VARCHAR(10), GETDATE() -1, 101) AS DATETIME) AND
  SPTAG < CAST(CONVERT(VARCHAR(10), GETDATE(), 101) AS DATETIME)
),
CTE2 (AR_SALE)
AS
(
  select convert(varchar(15),branch_no)+convert(varchar(15),sale_tx_no)
  from [ARDB01].[PP_BODATA].[DBO].[sales_tx_hdr] WITH (NOLOCK)
  WHERE sale_date >= CAST(CONVERT(VARCHAR(10), GETDATE() -1, 101) AS DATETIME) AND
  sale_date < CAST(CONVERT(VARCHAR(10), GETDATE(), 101) AS DATETIME)
  and sale_type in ('C','L')
)
SELECT AR_SALE, row_number() over (order by AR_SALE) as r
into #temp  -- added this row right here 
FROM CTE2 AS CTE2
  Left OUTER JOIN CTE1 AS CTE1
  ON CTE1.SAP_SALE = CTE2.AR_SALE
WHERE CTE1.SAP_SALE IS NULL
ORDER BY CTE2.AR_SALE 
```

然后...

```
declare @x varchar(100) 
declare @i int 
    set @i = 1 

while (@i <= (select max(r) from #temp)) begin
    select @x=AR_SALE from #temp where r=@i
    print @x
    set @i=@i+1
end 
```

# entity-framework-4 - 实体，处理大量记录（> 35 百万）

> ID：14205033
> 
> 赞同：7
> 
> 时间：2013-01-07T22:16:49.243
> 
> 标签：entity-framework-4, entity-framework-4.1, entity, entity-framework-5

我们有一组相当大的相关表，每个表有超过 3500 万条相关记录。我需要创建几个 WCF 方法，它们将使用一些参数（数据范围、类型代码等）查询数据库并返回相关的结果集（从 10 到 10,000 条记录）。

该公司在 EF 4.0 上进行了标准化，但对 4.X 开放。我可能会提出迁移到 5.0 的论据，但可能性较小。

使用实体处理如此大量记录的最佳方法是什么？我应该创建一组存储过程并从实体调用它们还是我可以在实体中做些什么？

我对数据库没有任何控制权，因此我无法拆分表或创建一些物化视图或分区表。

非常感谢任何输入/想法/建议。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-10-11T07:21:20.150

在我的工作中，我遇到了类似的情况。我们有一个包含许多表的数据库，其中大多数每个表包含大约 7 到 1000 万条记录。我们使用实体框架来显示数据，但页面显示速度似乎很慢（比如 90 到 100 秒）。甚至网格上的排序也需要时间。我的任务是看它是否可以优化。并且在对其进行分析（ANTS 分析器）之后，我能够对其进行优化（不到 7 秒）。

所以答案是**肯定的，实体框架可以处理大量记录（以百万计），但必须小心**

1.  了解仅在需要实际记录时才调用数据库。所有操作都只是用来进行查询（SQL），所以尽量只获取一条数据而不是请求大量记录。尽可能修剪 fetch 大小
2.  是的，你不应该，你必须使用存储过程并将它们导入你的模型，并为它们导入函数。也可以直接调用它们 ExecuteStoreCommand()、ExecuteStoreQuery<>()。同样适用于函数和视图，但 EF 有一种非常奇怪的调用函数“SELECT dbo.blah(@id)”的方式。
3.  EF 在必须填充具有较深层次结构的实体时执行较慢。对层次结构较深的实体要格外小心。
4.  有时，当您请求记录并且不需要修改它们时，您应该告诉 EF 不要查看属性更改 (AutoDetectChanges)。这样记录检索要快得多
5.  数据库的索引很好，但在 EF 的情况下它变得非常重要。您用于检索和排序的列应该被正确索引。
6.  当您的模型很大时，VS2010/VS2012 模型设计师会变得非常疯狂。所以把你的模型分成中型模型。存在一个限制，即来自不同模型的实体不能共享，即使它们可能指向数据库中的同一个表。
7.  当您必须在不同位置对同一实体进行更改时，请尝试通过传递来使用同一实体并仅发送一次更改，而不是每个人都获取一个新的片段，进行更改并存储它（真正的性能增益提示）。
8.  当您只需要一两列中的信息时，尽量不要获取完整的实体。你可以直接执行你的 sql 或者有一个迷你实体。您可能还需要在应用程序中缓存一些常用数据。
9.  交易很慢。小心他们。

如果你牢记这些事情，EF 应该提供与普通 ADO.NET 几乎相似的性能，如果不一样的话。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T19:18:37.147

我对 EF4.1 的经验，代码优先：如果您只需要读取记录（即您不会将它们写回），您将通过为您的上下文打开更改跟踪来获得性能提升：

```
yourDbContext.Configuration.AutoDetectChangesEnabled = false; 
```

在加载任何实体之前执行此操作。如果您需要更新加载的记录，您可以随时调用

```
yourDbContext.ChangeTracker.DetectChanges(); 
```

在调用 SaveChanges() 之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-30T22:13:32.547

当我听到类似这样的声明时：“公司在 EF4 或 EF5 或其他方面进行了标准化”这让我脊背发凉。

这相当于汽车租赁说“我们已经为我们的整个车队标准化了单一车型”。

或者木匠说“我已经将凿子标准化为我的整个工具包。我不会有锯子、钻头等......”

有一种东西叫做正确的工具来做正确的工作 这句话只是强调了负责制定关键软件架构决策的人对软件架构一无所知。

如果您正在处理超过 100K 的记录并且数据模型很复杂（即非平凡的），也许 EF6 不是最佳选择。EF6 基于动态反射的概念，与 Castle Project Active Record 有类似的设计模式

您是否需要将所有 100K 记录加载到内存中并对这些记录执行操作？如果是的话，问问你自己你真的需要这样做吗，为什么在 100K 记录中执行存储过程不能达到同样的效果。做一些分析，看看实际的数据使用模式是什么。也许用户执行的搜索返回 10 万条记录，但他们只浏览前 200 条记录。例如谷歌搜索，几乎没有人超过数百万搜索结果的第 3 页。

如果答案仍然是肯定的，您需要将所有 100K 记录加载到内存中并执行操作。然后，也许您需要考虑其他一些东西，例如使用轻量级对象通过缓存自定义构建的写入。也许延迟加载嵌套对象的动态对象指针。等等......我使用类似这样的东西的一个例子是电子商务网站的大型产品目录，其中对目录执行了大量搜索。为什么是为了提供自定义行为，例如提前退出搜索，以及使用预编译的正则表达式进行正则表达式通配符搜索，或自定义 Hashtable 索引到产品目录中。

对于这个问题，没有一个万能的答案。这一切都取决于数据使用场景以及应用程序如何处理数据。想想大猩猩对鲨鱼谁会赢？这一切都取决于环境和背景。

也许 EF6 非常适合从动态反射中受益的部分，而 NetTiers 更适合需要静态反射和可扩展 ORM 的另一部分。而低级 ADO 可能最适合极高性能的作品。

# android - Android：已删除的文件和消息恢复

> ID：14205039
> 
> 赞同：1
> 
> 时间：2013-01-07T22:16:59.587
> 
> 标签：android, data-recovery

我正计划为我设计一个应用程序来恢复已删除的文件和/或消息。但是，在进入开发阶段之前，我有很多问题要问。

1.  Android外部存储器使用的文件系统是什么？
2.  我可以在内部或外部存储器中恢复已删除的文件吗？
3.  我可以恢复已删除的消息吗？
4.  Q#2 和 Q#3 的后续问题，这可以在不生根/越狱手机的情况下完成吗？
5.  如果我要继续进行开发，我应该考虑什么方法？

这可能很多，但是如果您可以找到一些参考资料，无论这是否可行（我宁愿获得积极的可行性结果），这都会有所帮助？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T22:27:07.493

> Android外部存储器使用的文件系统是什么？

在 Android 1.x/2.x 上，FAT32（又名 vfat）。在 Android 3.0+ 上，我认为它会有所不同，尽管在大多数设备上它可能是 ext4。

> 我可以在内部或外部存储器中恢复已删除的文件吗？

可能。这与从 Linux 机器上的 vfat 或 ext4 分区恢复已删除文件没有太大区别。请注意，Android 1.x/2.x 内部存储是 YAFFS2，而不是 vfat 或 ext4。

> 我可以恢复已删除的消息吗？

英文单词“message”有许多可能的定义。大多数相关性（短信、电子邮件、即时消息）都由应用程序管理。可能有数以万计的应用程序处理“消息”，它们会以数千种不同的方式进行处理。您几乎无法访问它们，因为很少有开源的。

> Q#2 和 Q#3 的后续问题，这可以在不生根/越狱手机的情况下完成吗？

不可以，可移动媒体除外（例如，在 Android 1.x/2.x 上作为微型 SD 卡实现的外部存储）。没有root您无法访问内部存储，并且没有root您无法访问外部存储。“越狱”不是通常用于 Android 设备的术语。

# java - Java 上的多个扩展

> ID：14205041
> 
> 赞同：0
> 
> 时间：2013-01-07T22:17:09.283
> 
> 标签：java, extends, slick2d

我用 Java 制作了一个游戏，我的游戏是一个基于状态的游戏，所以它扩展了 StateBasedGame，我想把游戏放在一个网站上，这需要我把它做成一个小程序（除非有其他方法）所以它也必须扩展 JApplet，在尝试扩展多个类并在线阅读之后，我没有运气，并在论坛帖子上读到不可能有多个扩展。现在这是否意味着我不能将我的游戏放到网站上？

到目前为止，这是我的主要课程，它扩展了 StateBasedGame：

```
 package javagame;

import org.newdawn.slick.*;
import org.newdawn.slick.state.*;

public class Game extends StateBasedGame{

    public static final String gamename = "Croft";
    public static final int menu = 0;
    public static final int play = 1;

    public Game(String gamename){//create window on statup
        super(gamename);//adds title to screen
        this.addState(new Menu(menu));//"this" means get from this class
        this.addState(new Play(play));
    }

    public void initStatesList(GameContainer gc) throws SlickException{
//we need this because we inhereted from StateBasedGame, gc manages behind the scene stuff
        this.getState(menu).init(gc, this);//telling java what states we have
        this.getState(play).init(gc, this);
        this.enterState(menu);//tells java that you want to show menu before play
    }

    public static void main(String[] args) {
        AppGameContainer appgc;//the window for your game
        try{
            appgc = new AppGameContainer(new Game(gamename));//window holding the Game
            appgc.setDisplayMode(640, 360,false);//size, sizetrue would make it full screen //640,360
            appgc.start();//creates the window
        }catch(SlickException e){//built into slick for error handelling
        e.printStackTrace();}
    }

} 
```

编辑1：

html代码：

```
 <applet code="org.lwjgl.util.applet.AppletLoader" 
        archive="lwjgl_util_applet.jar" 
        codebase="." 
        width="640" height="480">

  <param name="al_title" value="Ham Blaster"> 
  <param name="al_main" value="org.newdawn.slick.AppletGameContainer"> 
  <param name="game" value="org.javagame.Game">

  <param name="al_jars" value="slick.jar, lwjgl.jar, slick.jar"> 

  <param name="al_windows" value="windows_natives.jar"> 
  <param name="al_linux" value="linux_natives.jar"> 
  <param name="al_mac" value="macosx_natives.jar"> 

  <param name="separate_jvm" value="true"> 
</applet> 
```

我的jar文件名是racegame，我的主类是Game，我的包名是javagame。

错误：ClassNotFoundException org.lwjgl.util.applet.AppletLoader

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T22:19:09.460

Java 不支持多重继承。对于打字问题，请使用接口。但在这种情况下，你对行为更感兴趣，所以我会使用组合。

```
public class GameApplet extends JApplet {
  private Game game = new Game();

  public void init() {
    game.foo();
    ...
  }

  ...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-07T22:19:02.287

您不能从超过 1 个类扩展一个类。有一些方法可以得到你想要的，其中最简单的可能是拥有另一个扩展类`JApplet`，并让该类使用你的游戏类。这称为组合——当一个类使用一个或多个其他类的实例时。

通常，如果您想从多个来源扩展，您将使用接口，并且`implement`来自多个来源。但是，这不一样，因为使用接口实际上并不提供功能。它只定义行为，即指定实现类必须实现的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T22:22:59.567

如果我没记错的话，`StateBasedGame`该类来自 Slick 2D API。您应该查找有关使用 Slick 2D 制作小程序的信息，例如[这篇文章](http://ninjacave.com/slickapplet)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T22:20:16.680

您需要将此类封装在一个可以从 Applet 中引导的对象中。

也就是说，Java 不允许扩展多个类，所以您阅读的内容是正确的。

# php - 通过变量从数组中获取数据

> ID：14205044
> 
> 赞同：0
> 
> 时间：2013-01-07T22:17:18.887
> 
> 标签：php, arrays, variables, offset

我有这个数组：

```
$array = array();
 $array['123'] = 'abc';
 $array['456'] = 'def'; 
```

现在我想根据一个变量从该数组中获取数据。这是我尝试过的：

```
$variable = '123';    
$result = $array[$variable];
echo $result; 
```

这似乎是错误的，但我不知道为什么。它会导致警告：

```
Illegal offset type […] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:23:50.760

我将确切的代码运行到我的编译器中，它工作了；可能是空格错误（您看不到但仍会导致错误的随机字符）。我会尝试重新输入那段代码并删除旧的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T22:32:46.687

我建议尝试这样做以确保将变量转换为字符串：

```
$result = $array[(string)$variable]; 
```

这很可能是你的问题。我认为也许 $post['id'] 要么错误地是一个多维数组，要么以某种方式成为不被接受为数组键的类型的对象。

# assembly - 汇编中的“MOV”指令是否分配内存？

> ID：14205054
> 
> 赞同：4
> 
> 时间：2013-01-07T22:18:02.417
> 
> 标签：assembly

我注意到 MOV 应该从寄存器复制和覆盖数据，但是如果任何其他寄存器中没有当前数据，MOV 是否会将一定大小的字节从 RAM 移动到寄存器以临时保存它，或者如何这项工作到底是什么？

为了澄清我的问题，假设我使用：

```
MOV AL, 0x10; 
```

在这种情况下，移动到 8 位寄存器的“10”位数据在哪里？

这是从 RAM 移动到 AL 的 8 位来保存，还是“10”字节只是一个不在内存中的暂存器数字？

我不明白这一点，如果有人能解决这个问题，那就太棒了。

我的问题是我需要知道在哪里使用了多少内存以及使用了多少内存，以及如何以及究竟是什么解决了它（教程并没有明确这一点）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T22:35:51.213

猜测心理障碍：重要的是要了解 RAM 既包含代码*又包含*包含数据。值 0x10 来自代码。它被汇编器编码成机器代码指令。该代码在开始执行您的代码时被操作系统加载到 RAM 中。

值得注意的是它不是一个变量，指令将*始终*加载 0x10，无论程序的状态如何。RAM 的其他部分存储您在汇编程序中声明的数据。就像 .data 和 .stack 部分一样。但是此特定指令并未以其他方式使用。

增加可能的混淆：它不必*在*RAM 中。在没有操作系统或引导驱动器的嵌入式系统上，代码通常被烧录到 ROM 中。处理器并不关心它，它只是从内存总线读取字节，使用 EIP 寄存器（指令指针）告诉内存子系统它需要什么字节。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-07T22:21:10.140

您的代码位于 RAM 中，即代表`MOV AL, 0x10;`0x10 的字节是指令的一部分，它不是单独存储的。通常，它不会在执行时来自 RAM，而是来自 CPU 上的指令流水线，CPU 在它认为合适的时候将指令从 RAM 提取到它的流水线中。

想要一本关于组装的免费在线书籍，请尝试[http://cs.smith.edu/~thiebaut/ArtOfAssembly/artofasm.html](http://cs.smith.edu/~thiebaut/ArtOfAssembly/artofasm.html)

第 4 章处理内存寻址 [http://cs.smith.edu/~thiebaut/ArtOfAssembly/CH04/CH04-1.html](http://cs.smith.edu/~thiebaut/ArtOfAssembly/CH04/CH04-1.html)

有很多概念可以让您了解，各种形式的内存寻址以及如何使用 CPU 架构一开始似乎令人生畏，但当您尝试时会慢慢开始变得有意义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T13:27:01.260

我想您的设备/机器中的主内存是 RAM。因此，基本上您的应用程序将在运行时存在（例如，在您从硬盘运行该应用程序后，它将被加载到设备内存中）。顺便说一句，处理器可执行的所有二进制指令现在都在 RAM 中。

为了简化这一点，假设处理器将从第一个单元格开始读取内存，如 0，将尝试了解如何处理它，完成后将继续移动到下一个单元格，在这种情况下为 1，依此类推.

现在让我们说在我们的假想处理器`mov al, 0x10`中等于。`0xAABB`在物理内存中，`0xAA`存储在单元格号`20`和`0xBB`处`21`。我们的处理器仍在忙于读取流。当它到达内存时`20`，它将加载`0xAA`在这种情况下的二进制值。顺便说一句，在我们的处理器文档中，这意味着**用以下数据填充 AL**。在我们的例子中，以下数据是`0xBB`，所以处理器会这样做。

如你看到的：

*   在这里，在我们的示例中，所有内容都存在于 RAM 中（在运行时），包括可执行指令、数据等。
*   CPU 从 RAM 中读取它，并将尝试做任何应该/必须做的事情
*   正如您可能注意到的那样，它不是在**运行时**`mov al, 0x10`分配的，而是由编译器硬编码的，并存储到一个可执行文件中（例如）
***   所以，这个假想`0xBB`存在于 RAM 中，但您不能在运行时更改它。再次记住，它不是在运行时创建的，它只是在运行时加载到 RAM 中**

 **我希望它可以帮助您更好地理解这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T10:12:47.453

组装说明

```
mov al, 0x10 
```

等于`0xb010`二进制

```
mov al, 0xff 
```

等于 0xb0ff

如果您在 Windows 上，您可以单击开始 - 运行 - 调试并在调试窗口中写入

```
a      
[Enter]
mov al, ff
[Enter]
[Enter] 
```

它将 mov al, ff 更改为二进制

然后你可以看到 0xb0ff by..

```
u 100
[Enter]

a 
mov al, ff 
```

表示 'assemble' mov al, ff 并保存到当前位置（可能是 0x100）

`u 100`表示“拆开”位置 0x100**

# gps - 以不同的方式编写 KML 扩展数据

> ID：14205056
> 
> 赞同：1
> 
> 时间：2013-01-07T22:18:06.883
> 
> 标签：gps, kml, raw-data

我有一些 GPS 原始数据，想放在 KML 文件中。

目前，我可以使用此处描述的 KML 格式生成带有扩展数据的 KML 文件[https://developers.google.com/kml/documentation/kmlreference#trackexample](https://developers.google.com/kml/documentation/kmlreference#trackexample)这很好，但需要太多时间。

我正在收集六种不同类型的扩展数据，使用 Arduino 并将它们写入 SD 卡，但是每个样本的整个写入过程太慢（我将数据写入六个不同的文件，然后我将每个文件附加到最后KML，使用 gx:track 元素）。

有没有其他方法可以使用扩展数据以 KML 格式同时写入所有六个参数？也许以不同的顺序使用不同的标签或相同的标签？

收集gps原始数据后，我没有足够的cpu能力来修改文件，所以我需要第一次写正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T02:08:47.340

完全自己编写 kml，不要使用库。然后它就像简单地将文本写入文件一样快。如果瓶颈是文件系统，那么 kml 不是正确的格式。使用自定义二进制文件，稍后在服务器端转换为 kml。

# c# - 如何将我的 ObjectResults 存储到 POCO？

> ID：14205060
> 
> 赞同：0
> 
> 时间：2013-01-07T22:18:30.433
> 
> 标签：c#, asp.net, entity-framework

这个问题对大多数人来说可能是最微不足道的，但我刚刚开始使用 EF 4，似乎无法将我的结果从存储过程分配给我的对象。这可能吗？

```
List<GetRotationSummary_Result> currentPD;
RotationData myData = new RotationData();

currentPD = context.GetData(compId, roleId, email).ToList()
MyData = currentPD;  // Can this even be done??? 
```

我想将数据存储在 MyData 对象中，因为用户将能够更改数据。之后我想更新数据库。完全接受任何建议。非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T22:21:32.330

您不能直接分配这样的对象，因为它们是完全不同的类型。您需要创建一个函数来逐字段分配从`currentPD`to的属性`myData`。像[automapper](http://automapper.org/)这样的工具可以使这变得更容易。

# perl - 从 perl 获取 ini 信息

> ID：14205062
> 
> 赞同：0
> 
> 时间：2013-01-07T22:18:43.243
> 
> 标签：perl, ini

我想知道如何从 perl 中的 INI 文件中检索信息。[我在这里](http://learn.perl.org/examples/configuration_files.html)的 perl.org 文档中找到了一些东西 ，但是它没有被评论，并且需要一些解释。是否有更易于使用的模块来解析 INI 信息？

```
[version]
ver=1.0.3

[ServerInfo]
port=1234
address="localhost" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:25:38.230

尝试通过示例执行此操作：

```
use strict;
use warnings;

use Config::IniFiles;

my $ini = new Config::IniFiles(
    -file => '/tmp/config.ini',
    -allowcontinue => 1
);

print $ini->val('version', 'ver'); 
```

看`perldoc Config::IniFiles`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T22:30:26.423

CPAN 中有一个很好的[INI 文件阅读器](http://search.cpan.org/~rjbs/Config-INI-0.018/lib/Config/INI/Reader.pm)，您可以根据需要对其进行子类化。

```
% cpan install 'Config::INI::Reader' 
```

然后...

```
% cat blah.pl 
#!/usr/bin/env perl -w

use strict;
use Config::INI::Reader;

my $filename = "blah.ini";

my $ini = Config::INI::Reader->read_file($filename);
my $server_info = $ini->{'ServerInfo'};

printf "Will connect to %s:%d\n"
    , $server_info->{'address'}
    , $server_info->{'port'}
    ; 
```

跑步：

```
% ./blah.pl 
Will connect to "localhost":1234 
```

您的 INI 文件中不需要`"`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T11:13:43.983

在研究如何在 Perl 中做某事时，第一步应该始终是在[CPAN](http://metacpan.org/)中搜索看起来有用的模块。

在这种情况下，[搜索“ini”](https://metacpan.org/search?q=ini)为您提供了很多可供选择的选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T18:37:33.437

您还可以查看[Config::Auto](https://metacpan.org/pod/Config%3a%3aAuto)模块。

# api - 如果我想使用一些 api，我需要做些什么吗？

> ID：14205072
> 
> 赞同：0
> 
> 时间：2013-01-07T22:19:09.497
> 
> 标签：api, eventbrite

我想使用从[http://eventbrite.github.com/#examples](http://eventbrite.github.com/#examples)看到的**Eventbrite** API 和

**搜索事件列表 (jsFiddle)**

在 jsfiddle.net/zTyZz/72/ 中，我可以使用 eventbrite，**但**任何其他脚本测试人员都不接受 eventbrite。

它说**“ReferenceError：未定义Eventbrite”**

然后.. 我需要导入 Eventbrite 还是其他东西？如何？

感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:14:28.590

尝试单击 jsFiddle 左侧面板中的“管理资源”。

您需要获取客户端库才能引用它： [https ://github.com/ryanjarvinen/Eventbrite.jquery.js/blob/master/example.html#L8](https://github.com/ryanjarvinen/Eventbrite.jquery.js/blob/master/example.html#L8)

# javascript - 无法从 jquery 'this' 对象中找到 .attr

> ID：14205080
> 
> 赞同：1
> 
> 时间：2013-01-07T22:19:36.440
> 
> 标签：javascript, jquery, json

我正在尝试从 jquery 中的 html 输入中查找数据属性。`$(this).attr("data-jsonid");`在下面的代码中使用 ：

```
$.fn.serializeObject = function () {
        var o = {};
        var a = this.serializeArray();
        $.each(a, function () 
        {
            if(!isNaN(this.name))
            {
                var currentId = $(this).attr("data-jsonid");

                if (currentId !== undefined)
                {
                    alert(currentId);
                }
                if (o[this.name] !== undefined) 
                {
                    if (!o[this.name].push) 
                    {
                        o[this.name] = [o[this.name]];
                    }
                    o[this.name].push(this.value || '');
                } 
                else 
                {
                    o[this.name] = this.value || '';
                }
            }
        });
        return o;
    };
    $(function () {
        $('form').submit(function () {
            $('#result').text(JSON.stringify($('form').serializeObject()));
            return false; 
```

我可以在我的 html 源代码中看到我所有的文本输入都有一个 data-jsonid 属性，但我无法确定它在 javascript/jquery 中是什么。调试时只能找到名称和值。

我创建了一个 jsfiddle 项目来帮助解释，[http://jsfiddle.net/mvargos/dSz38/](http://jsfiddle.net/mvargos/dSz38/)。如果单击“提交查询”，则会打印页面的 json。我的最终目标是我希望能够读取 data-jsonid 属性，以便我可以格式化我的 json 的保存方式（如果该属性存在）。目前json保存为

```
`{"1028":["Matt","Varg","27","2","Cris","Vargz","23","A"]}` 
```

但是一旦我可以确定 data-jsonid，我想创建类似于以下内容的 json：

```
`"1028":[{"id":"1", "tenantInfo":["Matt","Varg","27","2"]},{"id":"2", "tenantInfo":["Cris","Vargz","23","A"]}]` 
```

我不确定我是在做一些错误的语法还是犯了其他错误。感谢您的帮助，如果这个解释很差，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T22:24:24.907

```
var a = this.serializeArray(); 
```

上面的行序列化了对象..

所以基本上你正在迭代`array members`那些**不是 jquery 对象**

```
$.each(a, function () 
```

**$(this)**在这种情况下不是合适的选择器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T22:30:20.947

在序列化之前，您可以“记住”以下 jQuery 版本`this`：

```
$.fn.serializeObject = function() {

   var $this = $(this);

   ... 
```

然后，当您想将它用作 jQuery 对象时，您可以使用 $this。

```
 $this.data('some-data-attr'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T22:24:33.620

`this`在那种情况下不是输入元素，它只是一个普通的对象。您必须导航回输入以获取该信息：

```
$("[name=" + this.name + "]").data("jsonid"); 
```

# html - 用 Nokogiri在标签之间提取？

> ID：14205082
> 
> 赞同：-2
> 
> 时间：2013-01-07T22:19:40.457
> 
> 标签：html, ruby, parsing, nokogiri

我正在尝试使用 Nokogiri从该[站点提取电话号码和地址。](http://map.burlingamedowntown.org/textdir.cfm?p=1213)它们都在`<br>`标签之间。我怎样才能做到这一点？

* * *

万一网站关闭，这里是我希望从中提取电话号码和地址的一些 HTML 的摘录：

```
<table width="900" style=" margin:8px; padding:5px; font-family:Verdana, Geneva, sans-serif; font-size:12px; line-height:165%; color:#333333; border-bottom:1px solid #cccccc; "><tbody><tr valign="top"><td>
<strong>Alana's Cafe</strong><br>
<em>Cafe/Desserts </em>
<br>
650 348-0417
<br>
1408 Burlingame Ave
<br>
<a href="http://www.alanascafe.com/burlingame.html" target="_blank">http://www.alanascafe.com/burlingame.html</a>

</td><td align="right">
<a href="index.cfm?vid=44885" style="text-decoration:none; color:black">
<img src="iconmap.png" height="30" border="0"><br>
Map</a></td></tr></tbody></table>

<table width="900" style=" margin:8px; padding:5px; font-family:Verdana, Geneva, sans-serif; font-size:12px; line-height:165%; color:#333333; border-bottom:1px solid #cccccc; "><tbody><tr valign="top"><td>
<strong>Amber Moon Indian Restaurant and Bar</strong><br>
<em>Indian </em>

<br>
1425 Burlingame Ave

</td><td align="right">
<a href="index.cfm?vid=44872" style="text-decoration:none; color:black">
<img src="iconmap.png" height="30" border="0"><br>
Map</a></td></tr></tbody></table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T00:09:43.690

最简单的是：

```
data = doc.search('em').map{|em| em.search('~ br').map{|br| br.next.text.strip}}
#=> [["650 348-0417", "1408 Burlingame Ave", "http://www.alanascafe.com/burlingame.html"], etc... 
```

这意味着：对于每个 em，映射每个后续兄弟 br 元素之后的文本。

**更新**

要将其分类为电话/地址，您可以执行以下操作：

```
data.map{|row| {:phone => row[0][/^[\d \(\)-]+$/] ? row.shift : nil, :address => row.shift}}
#=> [{:phone=>"650 348-0417", :address=>"1408 Burlingame Ave"}, etc... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T22:46:33.270

### 代码

```
require 'nokogiri'
require 'open-uri'

doc = Nokogiri.HTML(open('http://map.burlingamedowntown.org/textdir.cfm?p=1213'))
addresses = doc.xpath('//td[strong][em]/br[3]/following-sibling::text()[1]')
p addresses.map(&:text).map(&:strip)
#=> #=> ["1408 Burlingame Ave", "347 Primrose Rd", "305 California Dr", "1409 Burlingame Avenue", "260 Lorton Ave", "1219 Burlingame Avenue", "1108 Burlingame Avenue", "1212 Donnelly Ave", "1243 Howard Ave", "283 Lorton Avenue", "245 California Drive", "1107 Howard Ave", "1300 Howard Ave", "1216 Burlingame Avenue", "1310 Burlingame Ave", "322 Lorton Avenue", "203 Primrose Dr", "1125 Burlingame Avenue", "327 Lorton Avenue", "1451 Burlingame Ave", "221 Primrose Rd", "1101 Burlingame Ave", "", "1123 Burlingame Avenue", "1407 Burlingame Ave", "1318 Burlingame Avenue", "1213 Burlingame Avenue", "231 Park Road", "246 Lorton Ave", "1453 Burlingame Ave", "1309 Burlingame Avenue", "321 Primrose Road", "", "209 Park Road", "1207 Burlingame Avenue", "1090 Burlingame Avenue", "1223 Donnelly Ave", "243 California Dr", "1080 Howard Ave", "270 Lorton Ave", "1447 Burlingame Ave", "361 California Drive", "1160 Burlingame Avenue", "333 California Drive", "401 Primrose Road", "1100 Burlingame Avenue", "1100Howard Ave #D", "1309 Burlingame Avenue", "220 Lorton Ave", "", "1101 Howard Avenue", "266 Lorton Avenue", "240 Park Rd", "1118 Burlingame Ave", "221 Park Road", "1400 Howard Ave", "225 Primrose Road", "248 Lorton Avenue"] 
```

### 这个怎么运作

由于 HTML 没有在语义上进行标记，因此第一个挑战是仅查找带有地址的条目。查看源代码，我们知道它们在`<td>`页面上，所以我们从它开始：

*   `//td`-*查找`<td>`文档中的任何位置...*

但是，此页面充满了[错误的标记](http://phrogz.net/css/WhyTablesAreBadForLayout.html)，因此我们需要将搜索限制在正确的表格单元格中。在这种情况下，`<strong>`and`<em>`标签在每个条目中都使用一致，并且不会出现在任何其他不需要的单元格中：

*   `//td[strong][em]`- *...但确保`<td>`至少有一个`<strong>`和至少一个`<em>`子元素...*

现在，我们想要第三个元素之后的文本`<br>`，所以首先我们只选择`<br>`每个匹配的第三个子元素`<td>`：

*   `//td[strong][em]/br[3]`- *...然后找到子`<br>`元素，只选择第三个...*

然后我们得到下面的第一个文本节点`<br>`：

*   `//td[strong][em]/br[3]/following-sibling::text()[1]`- *...找到 的所有后来的兄弟文本节点`<br>`，并只选择第一个。*

这给我们留下了一个[`Nokogiri::XML::Text`](http://nokogiri.org/Nokogiri/XML/Text.html)实例数组，因此我们将这个数组映射为每个实例的字符串文本，最后我们*将该*数组映射到一个去除了任何前导和尾随空格的数组。这不是最快的方法，但它既简洁又清晰，而且足够快。

为电话号码做类似的事情留给读者作为练习。

* * *

**编辑**：这是一个稍微更健壮的变体，足以处理没有电话号码的条目：

```
# Make all the `<br>` be real "\r\n".
doc.xpath('//td[strong][em]/br').each{ |br| br.replace("\r\n") }

# Get the text inside each entry
entries = doc.xpath('//td[strong][em]').map(&:text)

# Change the multi-line string into an array of lines
entries = entries.map{ |entry| entry.strip.split(/(?:\r\n)+/).map(&:strip) }

# Find the first line in each that has no letters in it
phones = entries.map{ |entry_lines| entry_lines.grep(/^[^a-z]+$/i).first }

# Find the first line in each that has a string of digits followed by a letter
addresses = entries.map{ |entry_lines| entry_lines.grep(/\d+ [a-z]/i).first }

# Zip and iterate them together
phones.zip(addresses).each do |phone,address|
  puts "For %s call %s" % [address,phone || "-"]
end

#=> For 1408 Burlingame Ave call 650 348-0417
#=> For 1425 Burlingame Ave call -
#=> For 347 Primrose Rd call 650-548-0300
#=> For 305 California Dr call 650 340-8642
#=> For 1409 Burlingame Avenue call 650 348-1204
#=> ... 
```

# android - Android Fragments Lifecycle：绘制视图后我该怎么做？

> ID：14205084
> 
> 赞同：1
> 
> 时间：2013-01-07T22:19:57.960
> 
> 标签：android, android-fragments, lifecycle

根据我对正常活动的经验，我的印象是，在该`onResume()`函数中，您可以对视图执行操作，并且它们已经被渲染到屏幕上。

但是，我现在将我的一些代码转换为 a`Fragment`并且在`onResume()`我调用 a 时`view.getWidth()`它返回 0（视图是在 中创建的`onCreateView`）。该视图最终会被渲染，但我似乎无法在片段的生命周期中访问它。

这是正常的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T05:23:27.057

当 Fragment 回到前台时会调用 onResume，但它不保证它仍然可见或布局已经发生。[Fragment 的 onResume 与其 Activity 相关联 - 这是文档](http://developer.android.com/reference/android/app/Activity.html#onResume%28%29)的摘录：

> 请记住，onResume 并不是您的活动对用户可见的最佳指标；系统窗口（例如键盘保护）可能位于前面。使用 onWindowFocusChanged(boolean) 确定您的活动对用户可见（例如，恢复游戏）。

* * *

获取视图大小的最佳方法是通过[ViewTreeObserver.OnGlobalLayoutListener](http://developer.android.com/reference/android/view/ViewTreeObserver.OnGlobalLayoutListener.html)。一旦布局完成就会调用它，您可以从那里安全地获取视图的大小。

只需在您感兴趣的视图上注册一个 OnGlobalLayoutListener 并在布局发生后获取其大小。一旦您阅读了该值，就应该取消注册您的侦听器并且不关心任何进一步的更新。（否则会多次调用侦听器。）

```
View v = ... ;
...
v.getViewTreeObserver().addOnGlobalLayoutListener(
    new ViewTreeObserver.OnGlobalLayoutListener() {

    @SuppressWarnings("deprecation")                                                
    @SuppressLint("NewApi")
    public void onGlobalLayout() {
        if (Build.VERSION.SDK_INT < Build.VERSION_CODES.JELLY_BEAN) {
            v.getViewTreeObserver().removeGlobalOnLayoutListener(this);
        } else {
            v.getViewTreeObserver().removeOnGlobalLayoutListener(this);
        }

        height = v.getHeight();
        width = v.getWidth();
    }
}); 
```

（注意兼容性检查 - 该方法在 Jelly Bean 中重命名。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T22:33:32.047

在绘制整个窗口后，视图的尺寸是已知的。由于片段通常是包含在宿主活动布局中的子视图，因此在片段中创建子视图这一事实并不意味着它已添加到父视图中`ViewGroup`。

# mysql - 如何将同一张表的两个查询放在一起

> ID：14205087
> 
> 赞同：0
> 
> 时间：2013-01-07T22:20:16.343
> 
> 标签：mysql, sql

我无法将两个查询合二为一。

查询1：

```
SELECT *
FROM (`text`)
WHERE `text` LIKE '%TERM1%' ORDER BY `text`.`start` DESC 
```

查询2：

```
SELECT *,
  MATCH (col1,  col2,  col3) AGAINST ('%TERM2%' IN BOOLEAN MODE) AS relevance
FROM `text`
WHERE MATCH (col1, col2, col3) AGAINST ('%TERM2%' IN BOOLEAN MODE)
      AND status=2
ORDER BY `text`.`start` DESC 
```

任何建议都会被接受。

表“文本”看起来像

```
+-------+--------+-------+------+------+
|  col1 |  col2  | col3  | text |  id  |
+-------+--------+-------+------+------+
| name1 | place1 | date1 | val1 |   1  |
| name2 | place2 | date2 | val2 |   2  |
| name3 | place2 | date5 | val1 |   3  |
| name4 | place4 | date4 | val5 |   4  |
| name5 | place5 | date5 | val5 |   5  |
:
:
| namex | placex | datex | valx |   x  |
+-------+--------+-------+------+------+ 
```

我忘了写，第一个查询也必须按开始 DESC 排序...

我期望结果如下：term1 = val1，term2 = val5

```
+-------+--------+-------+------+------+
|  col1 |  col2  | col3  | text |  id  |
+-------+--------+-------+------+------+ 
```

qery1 结果：

```
| name3 | place2 | date5 | val1 |   3  |
| name1 | place1 | date1 | val1 |   1  | 
```

查询2结果

```
| name5 | place5 | date5 | val5 |   5  |
| name4 | place4 | date4 | val5 |   4  |
:
:
| namex | placex | datex | valx |   1  |
+-------+--------+-------+------+------+ 
```

谢谢。

@PinnyM - 是的表被命名`text`并且在表立场列内`text`，不幸的是，我采用了具有完整数据库的项目，这很荒谬，但因为有必要或不需要更改表名，所以更改完整代码也是荒谬的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:30:45.223

这是一种方式：

```
SELECT t.*, -1 as relevance
FROM `text` t
WHERE `text` LIKE '%TERM1%'
union all
SELECT t.*, MATCH (col1,  col2,  col3) AGAINST ('%TERM2%' IN BOOLEAN MODE) AS relevance
FROM `text` t
WHERE MATCH (col1, col2, col3) AGAINST ('%TERM2%' IN BOOLEAN MODE) AND status=2
ORDER BY `text`.`start` DESC 
```

# cakephp - 为什么 GIT 不跟踪我的 cakephp 迁移插件？

> ID：14205093
> 
> 赞同：0
> 
> 时间：2013-01-07T22:20:30.727
> 
> 标签：cakephp, plugins, migration, cakephp-2.0, cakedc

我正在使用 GIT 部署我的 cakephp 应用程序，几天前我开始在我的应用程序中使用迁移插件（由 cakeDC 提供）来简化数据库版本和更改。

在我的本地开发机器上安装迁移插件后，我提交了更改并将其推送到我的生产服务器，并尝试从那里运行迁移插件。在查看服务器很长一段时间后，我意识到它并没有抓住所有的迁移插件，但是以下内容发生了变化：

app/Config/bootstrap.php 附加了以下行 CakePlugin::load('Migrations');

Plugin 文件夹现在有一个 Migrations 文件夹，但它是空的。

我通过 FTP 上传插件解决了这个问题。我在上面运行了一个 git status ，它显示工作目录干净......

为什么 GIT 不跟踪我的 Migrations 插件文件夹内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T21:48:43.277

插件文件夹没有被跟踪，因为 GIT 认为它是一个子模块。

我遇到了这个问题，因为我使用 GIT 将此插件克隆到插件目录中。并且 git 没有添加它，因为它本身就是一个存储库。当 GIT 没有将它添加到我跟踪的文件中时，我手动完成了它：`git add app/Plugin/Migrations/` 这创建了一个 gitlink 并且本质上就像一个子模块，如在这个线程中看到的：

[Git - 如何跟踪未跟踪的内容？](https://stackoverflow.com/questions/4161022/git-how-to-track-untracked-content/4162672#4162672)

由于当时我不想将该插件用作子模块，因此我使用以下命令更正了此问题：

`git rm --cached app/Plugin/Migrations`

`git status`我可以看到 GIT 现在正在识别我的插件

`git add .`然后我可以继续`git commit -m "finally adding the plugin"`

我希望这对将来的某人有所帮助。

谢谢！

# c++ - c++11正则表达式比python慢

> ID：14205096
> 
> 赞同：83
> 
> 时间：2013-01-07T22:20:33.153
> 
> 标签：c++, python, regex, performance, c++11

嗨，我想了解为什么以下代码使用正则表达式进行拆分字符串拆分

```
#include<regex>
#include<vector>
#include<string>

std::vector<std::string> split(const std::string &s){
    static const std::regex rsplit(" +");
    auto rit = std::sregex_token_iterator(s.begin(), s.end(), rsplit, -1);
    auto rend = std::sregex_token_iterator();
    auto res = std::vector<std::string>(rit, rend);
    return res;
}

int main(){
    for(auto i=0; i< 10000; ++i)
       split("a b c", " ");
    return 0;
} 
```

比下面的python代码慢

```
import re
for i in range(10000):
    re.split(' +', 'a b c') 
```

这里是

```
> python test.py  0.05s user 0.01s system 94% cpu 0.070 total
./test  0.26s user 0.00s system 99% cpu 0.296 total 
```

我在 osx 上使用 clang++。

使用 -O3 编译将其降至`0.09s user 0.00s system 99% cpu 0.109 total`

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2013-01-09T06:02:38.130

## 注意

另请参阅此答案：[https](https://stackoverflow.com/a/21708215) ://stackoverflow.com/a/21708215 ，这是此处底部**EDIT 2的基础。**

* * *

我已将循环增加到 1000000 以获得更好的时序测量。

这是我的 Python 时间：

```
real    0m2.038s
user    0m2.009s
sys     0m0.024s 
```

这是您的代码的等价物，只是更漂亮一点：

```
#include <regex>
#include <vector>
#include <string>

std::vector<std::string> split(const std::string &s, const std::regex &r)
{
    return {
        std::sregex_token_iterator(s.begin(), s.end(), r, -1),
        std::sregex_token_iterator()
    };
}

int main()
{
    const std::regex r(" +");
    for(auto i=0; i < 1000000; ++i)
       split("a b c", r);
    return 0;
} 
```

定时：

```
real    0m5.786s
user    0m5.779s
sys     0m0.005s 
```

* * *

这是避免构造/分配向量和字符串对象的优化：

```
#include <regex>
#include <vector>
#include <string>

void split(const std::string &s, const std::regex &r, std::vector<std::string> &v)
{
    auto rit = std::sregex_token_iterator(s.begin(), s.end(), r, -1);
    auto rend = std::sregex_token_iterator();
    v.clear();
    while(rit != rend)
    {
        v.push_back(*rit);
        ++rit;
    }
}

int main()
{
    const std::regex r(" +");
    std::vector<std::string> v;
    for(auto i=0; i < 1000000; ++i)
       split("a b c", r, v);
    return 0;
} 
```

定时：

```
real    0m3.034s
user    0m3.029s
sys     0m0.004s 
```

这接近 100% 的性能提升。

向量在循环之前创建，并且可以在第一次迭代中增长其内存。之后没有内存释放`clear()`，向量维护内存并*就地*构造字符串。

* * *

另一个性能提升将是完全避免构造/销毁`std::string`，从而避免其对象的分配/释放。

这是这个方向的初步尝试：

```
#include <regex>
#include <vector>
#include <string>

void split(const char *s, const std::regex &r, std::vector<std::string> &v)
{
    auto rit = std::cregex_token_iterator(s, s + std::strlen(s), r, -1);
    auto rend = std::cregex_token_iterator();
    v.clear();
    while(rit != rend)
    {
        v.push_back(*rit);
        ++rit;
    }
} 
```

定时：

```
real    0m2.509s
user    0m2.503s
sys     0m0.004s 
```

最终的改进是返回一个`std::vector`of `const char *`，其中每个 char 指针将指向原始`s` *c 字符串*本身内的一个子字符串。问题是，您不能这样做，因为它们中的每一个都不会以空值终止（为此，请参阅`string_ref`后面示例中 C++1y 的用法）。

* * *

最后的改进也可以通过以下方式实现：

```
#include <regex>
#include <vector>
#include <string>

void split(const std::string &s, const std::regex &r, std::vector<std::string> &v)
{
    auto rit = std::cregex_token_iterator(s.data(), s.data() + s.length(), r, -1);
    auto rend = std::cregex_token_iterator();
    v.clear();
    while(rit != rend)
    {
        v.push_back(*rit);
        ++rit;
    }
}

int main()
{
    const std::regex r(" +");
    std::vector<std::string> v;
    for(auto i=0; i < 1000000; ++i)
       split("a b c", r, v); // the constant string("a b c") should be optimized
                             // by the compiler. I got the same performance as
                             // if it was an object outside the loop
    return 0;
} 
```

* * *

我用-O3 用clang 3.3（来自主干）构建了样本。也许其他正则表达式库能够表现得更好，但无论如何，分配/解除分配经常会影响性能。

* * *

# 升压正则表达式

这是*c 字符串*参数示例的`boost::regex`时间：

 *```
real    0m1.284s
user    0m1.278s
sys     0m0.005s 
```

本示例中相同的代码`boost::regex`和`std::regex`接口是相同的，只需要更改命名空间和包含。

祝愿它随着时间的推移变得更好，C++ stdlib 正则表达式实现还处于起步阶段。

## 编辑

为了完成，我已经尝试过这个（上面提到的“终极改进”建议），它并没有提高等效`std::vector<std::string> &v`版本的任何性能：

```
#include <regex>
#include <vector>
#include <string>

template<typename Iterator> class intrusive_substring
{
private:
    Iterator begin_, end_;

public:
    intrusive_substring(Iterator begin, Iterator end) : begin_(begin), end_(end) {}

    Iterator begin() {return begin_;}
    Iterator end() {return end_;}
};

using intrusive_char_substring = intrusive_substring<const char *>;

void split(const std::string &s, const std::regex &r, std::vector<intrusive_char_substring> &v)
{
    auto rit = std::cregex_token_iterator(s.data(), s.data() + s.length(), r, -1);
    auto rend = std::cregex_token_iterator();
    v.clear(); // This can potentially be optimized away by the compiler because
               // the intrusive_char_substring destructor does nothing, so
               // resetting the internal size is the only thing to be done.
               // Formerly allocated memory is maintained.
    while(rit != rend)
    {
        v.emplace_back(rit->first, rit->second);
        ++rit;
    }
}

int main()
{
    const std::regex r(" +");
    std::vector<intrusive_char_substring> v;
    for(auto i=0; i < 1000000; ++i)
       split("a b c", r, v);

    return 0;
} 
```

这与[array_ref 和 string_ref 提案](http://cxx1y-array-string-ref.googlecode.com/git/paper.html)有关。这是使用它的示例代码：

```
#include <regex>
#include <vector>
#include <string>
#include <string_ref>

void split(const std::string &s, const std::regex &r, std::vector<std::string_ref> &v)
{
    auto rit = std::cregex_token_iterator(s.data(), s.data() + s.length(), r, -1);
    auto rend = std::cregex_token_iterator();
    v.clear();
    while(rit != rend)
    {
        v.emplace_back(rit->first, rit->length());
        ++rit;
    }
}

int main()
{
    const std::regex r(" +");
    std::vector<std::string_ref> v;
    for(auto i=0; i < 1000000; ++i)
       split("a b c", r, v);

    return 0;
} 
```

对于带有向量返回的情况，返回向量`string_ref`而不是`string`副本也会更便宜。`split`

# 编辑 2

这种新的解决方案能够通过返回获得输出。我使用了[https://github.com/mclow/string_view](https://github.com/mclow/string_view)`string_view`上的 Marshall Clow 的（已`string_ref`重命名）libc++ 实现。

```
#include <string>
#include <string_view>
#include <boost/regex.hpp>
#include <boost/range/iterator_range.hpp>
#include <boost/iterator/transform_iterator.hpp>

using namespace std;
using namespace std::experimental;
using namespace boost;

string_view stringfier(const cregex_token_iterator::value_type &match) {
    return {match.first, static_cast<size_t>(match.length())};
}

using string_view_iterator =
    transform_iterator<decltype(&stringfier), cregex_token_iterator>;

iterator_range<string_view_iterator> split(string_view s, const regex &r) {
    return {
        string_view_iterator(
            cregex_token_iterator(s.begin(), s.end(), r, -1),
            stringfier
        ),
        string_view_iterator()
    };
}

int main() {
    const regex r(" +");
    for (size_t i = 0; i < 1000000; ++i) {
        split("a b c", r);
    }
} 
```

定时：

```
real    0m0.385s
user    0m0.385s
sys     0m0.000s 
```

请注意，这与以前的结果相比有多快。当然，它不是`vector`在循环内部填充 a （也可能事先也不匹配任何东西），但无论如何你都会得到一个范围，你可以使用 range-based 来覆盖`for`它，甚至可以用它来填充 a `vector`。

由于在原始（或以*空结尾的字符串*）上的 create s 范围内，这变得非常轻量级，不会产生不必要的字符串分配`iterator_range`。`string_view``string`

 *只是为了比较使用这个`split`实现但实际上填充 a`vector`我们可以这样做：

```
int main() {
    const regex r(" +");
    vector<string_view> v;
    v.reserve(10);
    for (size_t i = 0; i < 1000000; ++i) {
        copy(split("a b c", r), back_inserter(v));
        v.clear();
    }
} 
```

这使用boost range copy算法在每次迭代中填充向量，时间为：

```
real    0m1.002s
user    0m0.997s
sys     0m0.004s 
```

可以看出，与优化后的`string_view`输出参数版本相比没有太大区别。

另请注意，有[一个提案`std::split`](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3593.html)可以像这样工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-09T19:30:50.120

对于优化，一般来说，您要避免两件事：

*   为不必要的东西消耗 CPU 周期
*   无所事事地等待某事发生（内存读取、磁盘读取、网络读取……）

两者可能是对立的，因为有时它最终会比将所有内容缓存在内存中更快地计算某些东西......所以这是一个平衡游戏。

让我们分析一下您的代码：

```
std::vector<std::string> split(const std::string &s){
    static const std::regex rsplit(" +"); // only computed once

    // search for first occurrence of rsplit
    auto rit = std::sregex_token_iterator(s.begin(), s.end(), rsplit, -1);

    auto rend = std::sregex_token_iterator();

    // simultaneously:
    // - parses "s" from the second to the past the last occurrence
    // - allocates one `std::string` for each match... at least! (there may be a copy)
    // - allocates space in the `std::vector`, possibly multiple times
    auto res = std::vector<std::string>(rit, rend);

    return res;
} 
```

我们能做得更好吗？好吧，如果我们可以重用现有存储而不是继续分配和释放内存，我们应该会看到显着的改进 [1]：

```
// Overwrites 'result' with the matches, returns the number of matches
// (note: 'result' is never shrunk, but may be grown as necessary)
size_t split(std::string const& s, std::vector<std::string>& result){
    static const std::regex rsplit(" +"); // only computed once

    auto rit = std::cregex_token_iterator(s.begin(), s.end(), rsplit, -1);
    auto rend = std::cregex_token_iterator();

    size_t pos = 0;

    // As long as possible, reuse the existing strings (in place)
    for (size_t max = result.size();
         rit != rend && pos != max;
         ++rit, ++pos)
    {
        result[pos].assign(rit->first, rit->second);
    }

    // When more matches than existing strings, extend capacity
    for (; rit != rend; ++rit, ++pos) {
        result.emplace_back(rit->first, rit->second);
    }

    return pos;
} // split 
```

在您执行的测试中，子匹配的数量在迭代中是恒定的，这个版本不太可能被击败：它只会在第一次运行时分配内存（for`rsplit`和`result`），然后继续重用现有内存。

*[1]：免责声明，我只证明了这段代码是正确的，我没有测试过它（正如 Donald Knuth 所说）。*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-06T08:52:19.920

这个版本怎么样？它不是正则表达式，但它很快解决了拆分问题......

```
#include <vector>
#include <string>
#include <algorithm>

size_t split2(const std::string& s, std::vector<std::string>& result)
{
    size_t count = 0;
    result.clear();
    std::string::const_iterator p1 = s.cbegin();
    std::string::const_iterator p2 = p1;
    bool run = true;
    do
    {
        p2 = std::find(p1, s.cend(), ' ');
        result.push_back(std::string(p1, p2));
        ++count;

        if (p2 != s.cend())
        {
            p1 = std::find_if(p2, s.cend(), [](char c) -> bool
            {
                return c != ' ';
            });
        }
        else run = false;
    } while (run);
    return count;
}

int main()
{
    std::vector<std::string> v;
    std::string s = "a b c";
    for (auto i = 0; i < 100000; ++i)
        split2(s, v); 
    return 0;
} 
```

$ 时间 splittest.exe

实际 0m0.132s 用户 0m0.000s 系统 0m0.109s

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-04T00:47:39.727

我想说 C++11 正则表达式比 perl 慢得多，也可能比 python 慢。

为了正确测量性能，最好使用一些不平凡的表达式进行测试，否则您正在测量除正则表达式本身之外的所有内容。

例如，比较 C++11 和 perl

C++11 测试代码

```
 #include <iostream>
  #include <string>
  #include <regex>
  #include <chrono>

  int main ()
  {
     int veces = 10000;
     int count = 0;
     std::regex expres ("([^-]*)-([^-]*)-(\\d\\d\\d:\\d\\d)---(.*)");

     std::string text ("some-random-text-453:10--- etc etc blah");
     std::smatch macha;

     auto start = std::chrono::system_clock::now();

     for (int ii = 0;  ii < veces; ii ++)
        count += std::regex_search (text, macha, expres);

     auto milli = std::chrono::duration_cast<std::chrono::milliseconds>(std::chrono::system_clock::now() - start).count();

     std::cout << count << "/" << veces << " matches " << milli << " ms --> " << (milli / (float) veces) << " ms per regex_search" << std::endl;
     return 0;
  } 
```

在我用 gcc 4.9.3 编译的计算机中，我得到了输出

```
 10000/10000 matches 1704 ms --> 0.1704 ms per regex_search 
```

perl 测试代码

```
 use Time::HiRes qw/ time sleep /;

  my $veces = 1000000;
  my $conta = 0;
  my $phrase = "some-random-text-453:10--- etc etc blah";

  my $start = time;

  for (my $ii = 0; $ii < $veces; $ii++)
  {   
     if ($phrase =~ m/([^-]*)-([^-]*)-(\d\d\d:\d\d)---(.*)/)
     {
        $conta = $conta + 1;
     }
  }
  my $elapsed = (time - $start) * 1000.0;
  print $conta . "/" . $veces . " matches " . $elapsed . " ms --> " . ($elapsed / $veces) . " ms per regex\n"; 
```

在我的电脑上再次使用 perl v5.8.8

```
 1000000/1000000 matches 2929.55303192139 ms --> 0.00292955303192139 ms per regex 
```

所以在这个测试中，C++11 / perl 的比率是

```
 0.1704 / 0.002929 = 58.17 times slower than perl 
```

在实际场景中，我得到的比率要慢 100 到 200 倍。因此，例如，解析具有一百万行的大文件对于 perl 大约需要一秒钟，而对于使用正则表达式的 C++11 程序可能需要更多分钟（！）。**

# html - Chrome Firefox 像素关闭 CSS

> ID：14205098
> 
> 赞同：0
> 
> 时间：2013-01-07T22:20:37.567
> 
> 标签：html, google-chrome, firefox, css, pixel

![像素关闭](../Images/45c3c68ec3d4188311be14747e0ab3d7.png)

所以在过去的 6 个月里，我一直在使用 Html5 和 CSS3，但现在刚刚开始在 firefox(17.0.1) 和 chrome(23.0.1271.101) 之间遇到一些像素缺失。我尝试了一个 CSS 重置，但没有改变。奇怪的是，在 chrome 中（图片右侧）它是 2 个像素，而在 firefox（图片左侧）它是 2 个像素。

在这里自己看看[http://jsfiddle.net/976a3/2/](http://jsfiddle.net/976a3/2/)

CSS：

```
body
      {
        margin: 0px 0px 0px 0px;
        background:rgba(75, 75, 75, 1);
        color:#c0c0c0;
      }

#container
  {
    margin:0px auto;
    padding:0px 0px 0px 0px;
    width:300px;
    height:350px;
  }

#contact_info
  {
    margin:0px 0px 0px 75px;
    padding:15px 15px 15px 15px;
    width:270px;
    height:150px;
    border:1px solid black;
    color:black;
    background:rgba(200,200,200,1);
    border-radius:20px;
    box-shadow:7px 7px 12px rgba(0,0,0,1);
  }
.title
  {
    font-size:1.3em;
    margin:-10px 0px 0px -30px;
    padding:4px 0px 0px 10px;
    width: 235px;
    height:30px;
    color:white;
    background:rgba(22,22,22,1);
    border-top-right-radius:10px;
    border-bottom-right-radius:10px;
    text-shadow:0 0 3px rgba(192, 192, 192, 1);
    box-shadow: 0 0 2px rgba(255, 255, 255, 0.1) inset,
    0 5px 10px rgba(0, 0, 0, 0.5) inset,
    0 4px 6px rgba(255, 255, 255, 0.2) inset,
    1pt 16px 0 -2px rgba(255, 255, 255, 0.2) inset,
    0pt 16px 10px rgba(0, 0, 0, 0.3) inset,
    0pt 1px 0px rgba(0, 0, 0, 0.2);
  }

.title:after
  {
    top:40px;
    left:-163px;
    position:relative;
    z-index:-2;
    content: "";
    border-left: 20px solid transparent;
    border-right: 20px solid transparent;
    border-top: 10px solid rgba(22, 22, 22, 1);
  } 
```

html:

```
<div id="container">
    <div id="contact_info">
    <p class="title">CONTACT INFO</p>
    <br />
    </div>
</div> 
```

任何修复或想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T04:46:25.117

`.title:after` `position:relative`你可以尝试给它，而不是给它`position:absolute`；并给`.title` `position:relative;`

[http://jsfiddle.net/976a3/3](http://jsfiddle.net/976a3/3)

# python - 用 Python 截取 DirectX 游戏的屏幕截图

> ID：14205113
> 
> 赞同：2
> 
> 时间：2013-01-07T22:21:44.627
> 
> 标签：python, directx, screenshot

我正在寻找一种在 Python 中截取 DirectX 游戏的方法。我已经尝试过使用 PIL 和其他东西，但我最终只得到了黑色的屏幕截图。我看到项目 directpython11 提供了与一些 DirectX 内容的 Python 绑定，但我没有找到与外部 DirectX 应用程序的屏幕截图相关的任何内容。

我有点迷路，任何帮助将不胜感激；）。

PS：我在 Windows 7 上使用 Python 2.7.3 32 位进行编码。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T22:30:38.713

这是一个相当复杂的话题。

实际上，以最简单的方式截取屏幕截图涉及抓取后缓冲区并将其写入文件。您的 Python DirectX 绑定应该支持从后缓冲区或前缓冲区制作纹理并用数据填充它；之后，图像写作由您决定。

不幸的是，进入后台缓冲区需要挂钩 DirectX 并在应用程序获取它之前拦截渲染上下文。虽然很简单，但这并没有很好的记录，并且需要相当多的（C++）代码来实现。您必须强制应用程序使用您控制的备用渲染上下文，然后自己截取屏幕截图。

据我所知，这种拦截的基础知识不能用纯 Python 完成。您可能能够找到使用显示编解码器的方法（在将屏幕传送到合成器后抓取屏幕），或者您可以使用现有的 DirectX 挂钩并实现最小的 IPC 来抓取数据并将其输入 Python 进行处理和写入到一个文件。

*编辑：*如果您对此感兴趣，我可以添加更多细节和一些可能有用的代码链接。我仍然不确定仅在 Python 中是否可行，但不要让这阻止你尝试。

# java - Servlet 不能提供简单的小程序

> ID：14205115
> 
> 赞同：1
> 
> 时间：2013-01-07T22:21:51.557
> 
> 标签：java, servlets, jetty, japplet

我有一个简单的小程序，我想在与我的服务器和 servlet 连接的本地网页上显示它。

小程序代码：

```
public class MyApplet extends JApplet implements ActionListener {
    JPanel panel = new JPanel();
    JButton btnPush;

    public MyApplet() {}

    public void init() {
        createGUI();
    }

    public void createGUI() {
        getContentPane().add(panel, BorderLayout.CENTER);
        panel.setLayout(null);
        btnPush = new JButton("Push");
        btnPush.addActionListener(this);
        btnPush.setBounds(54, 94, 89, 23);
        panel.add(btnPush);
        setSize(200, 200);
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        if(e.getSource() == btnPush) {
            JOptionPane.showMessageDialog(this, "Button was pushed");
        }

    }
} 
```

这是 servlet/服务器代码：

```
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.servlet.ServletContextHandler;

public class MyServlet extends HttpServlet {

    public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("text/html; chaset=utf-8");
        Writer writer = response.getWriter();

        writer.write("<applet codebase=\"bin\" code=\"MyApplet.class\" width=\"200\" height=\"200\">" + 
                "If your browser was Java-enabled, a button would appear here. </applet>");
    }

    public static void main(String... args) throws Exception {
        ServletContextHandler context = new ServletContextHandler(ServletContextHandler.SESSIONS);
        context.addServlet(MyServlet.class, "/");

        MyApplet applet = new MyApplet();
        applet.init();
        applet.start();

        Server server = new Server(8080);
        server.setHandler(context);
        server.start();
        server.join();

    }
} 
```

我正在使用 servlet-api3.0 和 jetty 8。我可以连接到 http://"localhost:8080"，但是当我的小程序尝试加载时它会停止加载。当我运行带有小程序标记的 html 文件时，它可以正常工作。所以看起来servlet是这里的麻烦。我忘了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:31:25.577

您的服务器的配置只能响应 Servlet 本身。没有 DefaultServlet 设置来实际返回所请求的 MyApplet.class 文件。

```
ServletContextHandler context = new ServletContextHandler(ServletContextHandler.SESSIONS);
context.setContextPath("/");
server.setHandler(context);

// Serve content from bin directory (where the classes are compiled into)
ServletHolder holder = context.addServlet(DefaultServlet.class,"/*");
holder.setInitParameter("resourceBase","bin");
holder.setInitParameter("pathInfoOnly","true");

// Serve some hello world servlets
context.addServlet(MyServlet.class,"/*"); 
```

有关 1 个 Servlet + 1 个 DefaultServlet 的更完整示例，请参阅嵌入式示例。 [http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/tree/example-jetty-embedded/src/main/java/org/eclipse/jetty/embedded/OneServletContext.java？ h=jetty-8](http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/tree/example-jetty-embedded/src/main/java/org/eclipse/jetty/embedded/OneServletContext.java?h=jetty-8)

只要确保你的 resourceBase 初始化参数指向你的类文件所在的路径。

# c# - asp.net 文件上传问题；文件没有上传

> ID：14205118
> 
> 赞同：-1
> 
> 时间：2013-01-07T22:21:53.737
> 
> 标签：c#, asp.net, iis

文件夹权限很好。它不会给我一个错误。我单击下面调用此函数的上传按钮，完成后，我上传的文件不存在。有任何想法吗？谢谢！

```
protected void submitFile(object sender, EventArgs e){
    if(fileUpload.HasFile)
    {
        try
        {
            if(
            fileUpload.PostedFile.FileName.ToLower().Substring(fileUpload.PostedFile.FileName.Length - 3) == "doc" ||
            fileUpload.PostedFile.FileName.ToLower().Substring(fileUpload.PostedFile.FileName.Length - 4) == "docx")

            {
                if(fileUpload.PostedFile.ContentLength < 512000)
                {
                    string filename = Path.GetFileName(fileUpload.FileName);
                    filename = filename.Replace(" ", "");
                    fileUpload.SaveAs("C:/inetpub/ ------ directory --------/Data" + filename);
                    StatusLabel.Text = "Upload status: File uploaded complete.";
                }
                else
                    StatusLabel.Text = "Upload status: The file has exceded the maximum file size of 500 kb. Please ensure that the file is smaller than 500 kb and try again";
            }
            else
                StatusLabel.Text = "Upload status: Only PDF and Microsoft Word files are accepted. Please try again.";
        }
        catch(Exception ex)
        {
            StatusLabel.Text = "Upload status: The file could not be uploaded. The following error occured: " + ex.Message;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T22:26:06.647

这应该 -->("C:/inetpub/wwwroot/w4/DanyaWebReports/Data" + 文件名);

是这样 -->("C:/inetpub/wwwroot/w4/DanyaWebReports/Data/" + 文件名);

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T22:26:25.870

看着这条线

```
fileUpload.SaveAs("C:/inetpub/ ------ directory --------/Data" + filename); 
```

文件保存在目录------目录--------

例如文件名 this.jpg 代码提出的文件将是 Datathis.jpg 并将保存在文件夹 ------ 目录 --------

如果要保存在网站的 Data 目录中，请尝试

```
fileUpload.SaveAs(Server.MapPath("Data")+"\\"+filename); 
```

# css - 将按钮组的宽度设置为 100% 并使按钮宽度相等？

> ID：14205125
> 
> 赞同：74
> 
> 时间：2013-01-07T22:22:26.477
> 
> 标签：css, twitter-bootstrap

我正在使用 Bootstrap，我想将一个整体设置为`btn-group`其父元素的 100% 的宽度。我还希望内部按钮具有相等的宽度。事实上，我也无法实现。

我在这里做了一个 JSFiddle：http: [//jsfiddle.net/BcQZR/12/](http://jsfiddle.net/BcQZR/12/)

这是HTML：

```
<div class="span8 background">
<div class="btn-group btn-block" id="colours">
<span class="btn"><input type='checkbox' name='size' value='red'/>red</span>
<span class="btn"><input type='checkbox' name='size' value='orange'/>orange</span>
<span class="btn"><input type='checkbox' name='size' value='yellow'/>yellow</span>
</div> <!-- /btn-group -->
</div> 
```

这是我当前的 CSS，它不起作用：

```
#colours { 
  width: 100%;
} 
```

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2014-02-27T22:10:16.457

Bootstrap 有`.btn-group-justified`css 类。

它的结构取决于您使用的标签类型。

[带`<a>`标签](http://getbootstrap.com/components/#with-%3Ca%3E-elements)

```
<div class="btn-group btn-group-justified" role="group" aria-label="...">
   ...
</div> 
```

[带`<button>`标签](http://getbootstrap.com/components/#with-<button>-elements)

```
<div class="btn-group btn-group-justified" role="group" aria-label="...">
  <div class="btn-group" role="group">
    <button type="button" class="btn btn-default">Left</button>
  </div>
  <div class="btn-group" role="group">
    <button type="button" class="btn btn-default">Middle</button>
  </div>
  <div class="btn-group" role="group">
    <button type="button" class="btn btn-default">Right</button>
  </div>
</div> 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2014-05-10T15:14:11.090

类不需要额外的 css `.btn-group-justified`。

您必须将其添加到父元素，然后将每个 btn 元素包装在一个带有 .btn-group 的 div 中，如下所示

```
 <div class="form-group">

            <div class="btn-group btn-group-justified">
                <div class="btn-group">
                    <button type="submit" id="like" class="btn btn-lg btn-success ">Like</button>
                </div>
                <div class="btn-group">
                    <button type="submit" id="nope" class="btn btn-lg btn-danger ">Nope</button>
                </div>
            </div>

        </div> 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-01-07T22:26:46.057

**引导程序 2**（[来源](http://getbootstrap.com/2.3.2/)）

问题是按钮上没有设置宽度。试试这个：

```
.btn {width:20%;} 
```

**编辑：**

默认情况下，按钮采用其文本长度的自动宽度加上一些填充，因此我猜对于您的示例，5 个按钮可能更像 14.5%（以补偿填充）。

***笔记：***

如果您不想尝试补偿填充，您可以使用`box-sizing:border-box;`

[http://www.w3schools.com/cssref/css3_pr_box-sizing.asp](http://www.w3schools.com/cssref/css3_pr_box-sizing.asp)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-02-18T09:16:06.730

我不喜欢 .btn 上设置宽度的解决方案，因为它假定 .btn 组中的项目数量总是相同的。这是一个错误的假设，会导致臃肿的、特定于表示的 CSS。

更好的解决方案是更改 .btn-group 与 .btn-block 和子 .btn(s) 的显示方式。我相信这就是您正在寻找的：

```
.btn-group.btn-block {
    display: table;
}
.btn-group.btn-block > .btn {
    display: table-cell;
} 
```

这是一个小提琴：http: [//jsfiddle.net/DEwX8/123/](http://jsfiddle.net/DEwX8/123/)

如果您希望拥有等宽按钮（在合理范围内）并且只能支持支持 flexbox 的浏览器，请尝试以下操作：

```
.btn-group.btn-block {
    display: flex;
}
.btn-group.btn-block > .btn {
    flex: 1;
} 
```

这是一个小提琴：http: [//jsfiddle.net/DEwX8/124/](http://jsfiddle.net/DEwX8/124/)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2018-03-04T00:51:19.263

对于**引导程序 4**，只需添加此类：

`w-100`

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-02-27T17:54:46.670

Bootstrap 4 删除了 .btn-group-justified。作为替代，您可以使用`<div class="btn-group d-flex" role="group"></div>`.w-100 作为元素的包装器。

试试这个：

```
<div class="btn-group d-flex" role="group>
  <button type="button" class="btn btn-primary w-100">Submit</button>
  <button type="button" class="btn btn-primary w-100">Cancel</button>
</div> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-06-02T22:57:46.550

**Angular** *- 等宽按钮组*

假设您的范围内有一系列“事物”......

*   确保父 div 的宽度为 100%。
*   使用[ng-repeat](https://docs.angularjs.org/api/ng/directive/ngRepeat)在按钮组中创建按钮。
*   使用[ng-style](https://docs.angularjs.org/api/ng/directive/ngStyle)计算每个按钮的宽度。

* * *

```
<div class="btn-group"
     style="width: 100%;">
    <button ng-repeat="thing in things"
            class="btn btn-default"
            ng-style="{width: (100/things.length)+'%'}">
        {{thing}}
    </button>
</div> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-07-21T07:38:08.723

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

<div class="btn-group btn-block">
  <button type="button" data-toggle="dropdown" class="btn btn-default btn-xs  btn-block  dropdown-toggle">Actions <span class="caret"></span>
<span class="sr-only">Toggle Dropdown</span></button><ul role="menu" class="dropdown-menu"><li><a href="#">Action one</a></li><li class="divider"></li><li><a href="#" >Action Two</a></li></ul></div>
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-07T12:12:38.647

**引导程序 4**

```
 <ul class="nav nav-pills nav-fill">
                <li class="nav-item">
                    <a class="nav-link active" href="#">Active</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Longer nav link</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Link</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link disabled" href="#">Disabled</a>
                </li>
            </ul> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-09-03T10:41:56.313

**Bootstrap 4 解决方案**

```
<div class="btn-group w-100">
    <button type="button" class="btn">One</button>
    <button type="button" class="btn">Two</button>
    <button type="button" class="btn">Three</button>
</div> 
```

您基本上通过向容器添加类来告诉`btn-group`容器具有 100% 的宽度。`w-100`里面的按钮会自动填充整个空间。

# java - 设置菜单中的 Android 首选项 - 适用于 phonegap 开发人员

> ID：14205126
> 
> 赞同：0
> 
> 时间：2013-01-07T22:22:36.690
> 
> 标签：java, android, cordova, cordova-2.0.0

我从来没有用 Java 写过任何一行代码，而且我对 Java 世界也不太了解，所以当我听说我可以使用 phonegap 创建 android 应用程序时，我非常高兴。但正如我后来发现的，如果我想做更多的事情，我无法摆脱 Java。

我想为我的应用程序创建设置页面，我发现[phongeap 扩展](http://simonmacdonald.blogspot.com/2012/06/phongap-android-application-preferences.html)允许我读取 phonegap 应用程序设置，但要使用它，我必须创建可以通过 XML 和一些 Java 完成的设置 ​​GUI。我找到了很好的[教程](http://www.javacodegeeks.com/2011/01/android-quick-preferences-tutorial.html)来做这件事，但由于我不是 Java 开发人员，所以我不能从中了解很多。

有人能告诉我把所有这些 Java 和 XML 的东西放在哪里，以便让设置 GUI 在 phonegap 应用程序中工作。我的意思是我需要什么文件，内容和目录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T08:05:07.940

使用 phonegap，您可以转义所有 java 代码，正如您将在以下代码中看到的那样，您不需要任何 java 代码：

> ```
> <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
>                       "http://www.w3.org/TR/html4/strict.dtd">
> <html>
>   <head>
>     <title>Cordova Menu Button Example</title>
> 
>     <script type="text/javascript" charset="utf-8" src="cordova-2.3.0.js"></script>
>     <script type="text/javascript" charset="utf-8">
> 
>     // Call onDeviceReady when Cordova is loaded.
>     // At this point, the document has loaded but cordova-2.3.0.js has not.
>     // When Cordova is loaded and talking with the native device,
>     // it will call the event `deviceready`.
>     function onLoad() {
>         document.addEventListener("deviceready", onDeviceReady, false);
>     }
> 
>     // Cordova is loaded and it is now safe to make calls Cordova methods
>     function onDeviceReady() {
>         // Register the event listener
>         document.addEventListener("menubutton", onMenuKeyDown, false);
>     }
> 
>     // Handle the menu button
>     function onMenuKeyDown() { alert("menu btn pressed");
> 
>     }
> 
>     </script>
>   </head>
>   <body onload="onLoad()">
>   </body>
> </html> 
> ```

不要为此功能使用插件，只需转到主[文档](http://docs.phonegap.com/en/2.3.0/cordova_events_events.md.html#Events)即可。您还可以找到其他事件，例如：

*   设备就绪
*   暂停
*   恢复
*   在线的
*   离线
*   返回键
*   电池关键
*   电量不足
*   电池状态
*   菜单按钮
*   搜索按钮
*   开始呼叫按钮
*   结束通话按钮
*   音量下键
*   音量增大按钮

# android - Android ActionBar 选项卡 onclick 问题

> ID：14205128
> 
> 赞同：0
> 
> 时间：2013-01-07T22:22:41.247
> 
> 标签：android

我对 ActionBar 上的选项卡的 onclick 事件有疑问。我想将 ActionBar-Tab 逻辑“外包”给一个类，以便我可以在所有活动中重用 ActionBar-Tabs-navigation。

这是外包的“ActionBar-Tab”逻辑：

```
public class TabActivity extends Activity implements TabListener 
```

{

```
@Override
protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_tab);

    // Set up the ActionBar to show tabs:
    final ActionBar actionBar = getActionBar();
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

    // Add Tabs:
    actionBar.addTab(actionBar.newTab().setText("Dashboard").setTabListener(this),0,true);
    actionBar.addTab(actionBar.newTab().setText("Search").setTabListener(this),1,false);
    actionBar.addTab(actionBar.newTab().setText("Map").setTabListener(this),2,false);
}

@Override
public void onTabSelected(Tab arg0, FragmentTransaction arg1) 
{
    switch(arg0.getPosition())
    {
       case 0:
           Intent dashboard = new Intent(this,DashBoardActivity.class);
           startActivity(dashboard);
       break;

       case 1:
           Intent suche = new Intent(this,SucheActivity.class);
           startActivity(suche);
       break;

       case 2:
           // Start Intent
       break;

       case 3:
           // Start Intent
       break;

       case 4:
         // Start Intent
       break;
    }
}

@Override
public void onTabReselected(Tab arg0, FragmentTransaction arg1) {

}

@Override
public void onTabUnselected(Tab arg0, FragmentTransaction arg1) {

} 
```

}

这是扩展 TabActivity 类的 DashBoardActivity：

```
public class DashBoardActivity extends TabActivity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_dash_board);
} 
```

}

DashBoardActivity 也是我的应用程序的启动器活动。

所以，我的问题。当应用程序启动时，ActionBar 导航按预期成功显示。我看到（通过 Log.i），当应用程序启动时，ActionBar 的 onTabSelected() 被调用（没有点击它）。

如您所见，我想根据单击的选项卡启动不同的活动。

问题：应用程序启动，- onTabSelected 在启动时自动调用，- 然后活动“DashBoardActivity.class”开始。（但当前活动是 DashBoardActivity！？！）

启动的 Activity 扩展了 TabActivity，但未显示 ActionBar-Tabs。

有解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T23:58:44.127

更改此行：

```
actionBar.addTab(actionBar.newTab().setText("Dashboard").setTabListener(this),0,true); 
```

至：

```
actionBar.addTab(actionBar.newTab().setText("Dashboard").setTabListener(this),0,false); 
```

我从 Android 文档中得到的信息：

> public abstract void addTab (ActionBar.Tab tab, int position, boolean setSelected)
> 
> > *   setSelected - 如果添加的选项卡应成为选定选项卡，则为真。

# c# - Runtime.interop ArgumentNullException 使用 ZXing

> ID：14205129
> 
> 赞同：0
> 
> 时间：2013-01-07T22:22:44.763
> 
> 标签：c#, windows-runtime, zxing, argumentnullexception

我正在尝试使用 ZXing.Net 在 Windows 应用商店应用程序中解析 QR 码，但是当我尝试使用他们网页上的最新版本运行它时，它在第 50 行给了`ArgumentNullException`我`BitmapLuminanceSource.Silverlight.cs`一个

这条线看起来像这样

```
var data = System.Runtime.InteropServices.WindowsRuntime.WindowsRuntimeBufferExtensions.ToArray(writeableBitmap.PixelBuffer, 0, (int)writeableBitmap.PixelBuffer.Length); 
```

is not null ，`WriteableBitmap`所以我不什么，什么是null。

有谁能够帮助我？

就是从这个方法

```
public BitmapLuminanceSource(WriteableBitmap writeableBitmap)
   : base(writeableBitmap.PixelWidth, writeableBitmap.PixelHeight)
{
   var height = writeableBitmap.PixelHeight;
   var width = writeableBitmap.PixelWidth;
   var stride = width * 4;
   luminances = new byte[width * height];
   Color c;

#if NETFX_CORE
   var data = System.Runtime.InteropServices.WindowsRuntime.WindowsRuntimeBufferExtensions.ToArray(writeableBitmap.PixelBuffer, 0, (int)writeableBitmap.PixelBuffer.Length);
   for (int y = 0; y < height; y++)
   {
      int offset = y * stride;
      for (int x = 0, xl = 0; x < stride; x += 4, xl++)
      {
         c = Color.FromArgb(
            data[x + offset], 
            data[x + offset + 1], 
            data[x + offset + 2], 
            data[x + offset + 3]);
         luminances[y * width + xl] = (byte)(0.3 * c.R + 0.59 * c.G + 0.11 * c.B + 0.01);
      }
   }
#else
   var pixels = writeableBitmap.Pixels;
   for (int y = 0; y < height; y++)
   {
      int offset = y * width;
      for (int x = 0; x < width; x++)
      {
         int srcPixel = pixels[x + offset];
         c = Color.FromArgb((byte)((srcPixel >> 0x18) & 0xff),
            (byte)((srcPixel >> 0x10) & 0xff),
            (byte)((srcPixel >> 8) & 0xff),
            (byte)(srcPixel & 0xff));
         luminances[offset + x] = (byte)(0.3 * c.R + 0.59 * c.G + 0.11 * c.B + 0.01);
      }
   }
#endif
} 
```

**更新**

WriteableBitmat 是使用此代码创建的

```
// Get the File
var File = await FilePick.PickSingleFileAsync();

// Convert the File to a Bitmap
var Stream = await File.OpenAsync(FileAccessMode.Read);
var Bmp = new BitmapImage();
Bmp.SetSource(Stream);
var WBmp = new WriteableBitmap(Bmp.PixelWidth, Bmp.PixelHeight);
WBmp.SetSource(Stream); 
```

通过使用 Damir Arh 的回答，错误被移到了下面的代码中

```
c = Color.FromArgb(
    data[x + offset], 
    data[x + offset + 1], 
    data[x + offset + 2], 
    data[x + offset + 3]); 
```

`IndexOutOfRangeException`我在哪里得到一个

```
x = 580
xl = 145
offset = 31104
y = 36
height = 216
width = 216
stride = 864
data = {byte[31684]} 
```

我当然可以看到它为什么超出范围，但我不知道如何修复它

使用 Damir Arh 的更新答案修复了它`Stream.Seek(0)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T06:15:27.623

我快速移植了[项目主页](https://zxingnet.codeplex.com/)上提供的 Silverlight 示例，它确实有效：

```
var dlg = new FileOpenPicker();
dlg.FileTypeFilter.Add(".png");
var file = await dlg.PickSingleFileAsync();
if (file != null)
{
    currentBarcode = new WriteableBitmap(89, 89);
    using (var stream = await file.OpenReadAsync())
    {
        currentBarcode.SetSource(stream);
    }
    imgDecoderBarcode.Source = currentBarcode;
    var result = reader.Decode(currentBarcode);
    if (result != null)
    {
        txtDecoderType.Text = result.BarcodeFormat.ToString();
        txtDecoderContent.Text = result.Text;
    }
    else
    {
        txtDecoderType.Text = String.Empty;
        txtDecoderContent.Text = "No barcode found.";
    }
} 
```

我还尝试从您发布的代码中调用违规行，并且没有引发异常：

```
var dlg = new FileOpenPicker();
dlg.FileTypeFilter.Add(".png");
var file = await dlg.PickSingleFileAsync();
if (file != null)
{
    currentBarcode = new WriteableBitmap(89, 89);
    using (var stream = await file.OpenReadAsync())
    {
        currentBarcode.SetSource(stream);
        var data = System.Runtime.InteropServices.WindowsRuntime.WindowsRuntimeBufferExtensions.ToArray(currentBarcode.PixelBuffer, 0, (int)currentBarcode.PixelBuffer.Length);
    }
} 
```

你的问题是你如何创建`WriteableBitmap`传递给这个方法的。因为您首先从同一个流中加载 a `Bitmap`，所以当您将其设置为`WritableBitmap`. 您需要将自己重新定位到流的开头，以便可以再次加载数据：

```
// Convert the File to a Bitmap
var Stream = await File.OpenAsync(FileAccessMode.Read);
var Bmp = new BitmapImage();
Bmp.SetSource(Stream);
Stream.Seek(0);
var WBmp = new WriteableBitmap(Bmp.PixelWidth, Bmp.PixelHeight);
WBmp.SetSource(Stream); 
```

# twitter-bootstrap - 在我的博客上使用 Twitter Bootstrap。如何让移动设备的侧栏折叠？

> ID：14205133
> 
> 赞同：1
> 
> 时间：2013-01-07T22:23:08.807
> 
> 标签：twitter-bootstrap

这是我网站上的一个页面。

[http://jddorweiler.appspot.com/roomba.html](http://jddorweiler.appspot.com/roomba.html)

侧边栏在计算机上看起来不错，但在移动设备上它会挡住大部分屏幕并覆盖大部分内容。有没有一种简单的方法可以让它折叠到顶部栏或其他方法来修复它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T23:59:36.503

试试这个：

```
@media (max-width: 767px) {
   .sidebar-nav-fixed {
        position: static;
        width: 100%;
       }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T00:12:55.727

如果您使用的是 Bootstrap 的响应式 CSS，您可以为当前侧边栏指定类`.hidden-phone`，并使用类`.hidden-tablet`和`.hidden-desktop`.

[脚手架 • Bootstrap（响应式实用程序类）](http://twitter.github.com/bootstrap/scaffolding.html#responsive)

# image - 如果可能，通过代码对图像控制进行 WinRT 缩放

> ID：14205134
> 
> 赞同：0
> 
> 时间：2013-01-07T22:23:20.363
> 
> 标签：image, windows-runtime, zooming

我在一个 WinRT 应用程序中工作，这意味着在 WriteableBitmap 级别对图像进行一些操作。在我的页面上，我当然有一个`image`显示处理结果的。我现在的目标略有不同，我想知道是否有任何方法可以通过代码访问内置放大/缩小，如果在触摸设备上控制 + 鼠标滚轮，则可以通过捏合模式实现个人电脑。

这是我得到图像的一些代码：

```
<ScrollViewer  VerticalScrollBarVisibility="Auto"  HorizontalScrollBarVisibility="Auto">
    <Image Grid.Row="0" x:Name="ImagePanel" Stretch="Uniform" VerticalAlignment="Center" HorizontalAlignment="Center"/>
</ScrollViewer> 
```

我问这个，以防有人知道这是否可以实现，只是因为缩放非常优化并且非常有用:)

谢谢，非常感谢任何帮助或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:20:59.890

ScrollViewer 有一个 ZoomFactor 属性和一个可以使用的 ZoomToFactor() 方法。

# spring-mvc - 没有 web.xml 的 Spring Security

> ID：14205140
> 
> 赞同：20
> 
> 时间：2013-01-07T22:24:14.183
> 
> 标签：spring-mvc, spring-security, servlet-3.0

`WebApplicationInitializer`将 Spring Security 添加到使用 Spring 的新接口而不是 web.xml 文件的 Web 应用程序的推荐方法是什么？我正在寻找相当于：

```
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter> 
```

**更新**
提供的答案是合理的，但他们都假设我有一个`servletContext`实例。我查看了`WebApplicationInitializer`s 的层次结构，除非我选择覆盖 Spring 的初始化方法之一，否则我看不到对 servlet 上下文的任何访问。 `AbstractDispatcherServletInitializer.registerServletFilter`似乎是明智的选择，但它并不默认为 URL 模式映射，如果有更好的方法，我不想更改所有内容的过滤器注册。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-07T22:42:44.407

这就是我这样做的方式：

```
container.addFilter("springSecurityFilterChain", new DelegatingFilterProxy("springSecurityFilterChain"))
                    .addMappingForUrlPatterns(null, false, "/*"); 
```

容器是一个实例`ServletContext`

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-06-17T20:58:14.413

[Spring Security Reference](http://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#abstractsecuritywebapplicationinitializer)回答了这个问题，解决方案取决于您是否将 Spring Security 与 Spring 或 Spring MVC 结合使用。

### 在没有 Spring 或 Spring MVC 的情况下使用 Spring Security

如果您**没有**将 Spring Security 与 Spring 或 Spring MVC 一起使用（即您没有现有的`WebApplicationInitializer`），那么您需要提供以下附加类：

```
import org.springframework.security.web.context.*;

public class SecurityWebApplicationInitializer
    extends AbstractSecurityWebApplicationInitializer {

    public SecurityWebApplicationInitializer() {
        super(SecurityConfig.class);
    }
} 
```

`SecurityConfig`您的 Spring Security Java 配置类在哪里。

### 将 Spring Security 与 Spring 或 Spring MVC 一起使用

如果您将 Spring Security 与 Spring 或 Spring MVC 一起使用（即您有一个现有的`WebApplicationInitializer`），那么首先您需要提供以下附加类：

```
import org.springframework.security.web.context.*;

public class SecurityWebApplicationInitializer
    extends AbstractSecurityWebApplicationInitializer {
} 
```

然后你需要确保你的 Spring Security Java 配置类，`SecurityConfig`在这个例子中，是在你现有的 Spring 或 Spring MVC 中声明的`WebApplicationInitializer`。例如：

```
import org.springframework.web.servlet.support.*;

public class MvcWebApplicationInitializer
    extends AbstractAnnotationConfigDispatcherServletInitializer {

    @Override
    protected Class<?>[] getRootConfigClasses() {
        return new Class[] {SecurityConfig.class};
    }

    // ... other overrides ...
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-08T11:00:57.960

```
Dynamic securityFilter = servletContext.addFilter(AbstractSecurityWebApplicationInitializer.DEFAULT_FILTER_NAME, DelegatingFilterProxy.class);
securityFilter.addMappingForUrlPatterns(EnumSet.allOf(DispatcherType.class), false, "/*"); 
```

**EnumSet.allOf(DispatcherType.class)**以确保您不仅为默认 DispatcherType.REQUEST 添加映射，还为**DispatcherType.FORWARD**等添加映射...

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-07-02T05:41:44.687

经过一番努力，我发现它实际上很简单：

```
public class Initialiser extends AbstractAnnotationConfigDispatcherServletInitializer implements WebApplicationInitializer {

    @Override
    protected Class< ? >[] getRootConfigClasses() {
        return new Class[] { RootConfig.class };
    }

    @Override
    protected Class< ? >[] getServletConfigClasses() {
        return new Class[] { WebAppConfig.class };
    }

    @Override
    protected String[] getServletMappings() {
        return new String[] { "/" };
    }

    @Override
    protected Filter[] getServletFilters() {
        return new Filter[] { new DelegatingFilterProxy("springSecurityFilterChain") };
    }
} 
```

然而，最重要的是你**必须**有一个根上下文（例如`RootConfig`在这种情况下），并且它必须包含对所有 spring 安全信息的引用。

因此，我的`RootConfig`班级：

```
@ImportResource("classpath:spring/securityContext.xml")
@ComponentScan({ "com.example.authentication", "com.example.config" })
@Configuration
public class RootConfig {

    @Bean
    public DatabaseService databaseService() {
        return new DefaultDatabaseService();
    }

    @Bean
    public ExceptionMappingAuthenticationFailureHandler authExceptionMapping() {
        final ExceptionMappingAuthenticationFailureHandler emafh = new ExceptionMappingAuthenticationFailureHandler();
        emafh.setDefaultFailureUrl("/loginFailed");
        final Map<String, String> mappings = new HashMap<>();
        mappings.put(CredentialsExpiredException.class.getCanonicalName(), "/change_password");
        emafh.setExceptionMappings(mappings);
        return emafh;
    }
} 
```

并且`spring/securityContext.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans  xmlns="http://www.springframework.org/schema/beans"
        xmlns:security="http://www.springframework.org/schema/security"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:context="http://www.springframework.org/schema/context"
        xsi:noNamespaceSchemaLocation="http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"
        xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
            http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd
            http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd">

    <security:http security="none" pattern="/favicon.ico"/>

    <!-- Secured pages -->
    <security:http use-expressions="true">
        <security:intercept-url pattern="/login" access="permitAll" />
        <security:intercept-url pattern="/**" access="isAuthenticated()" />
        <security:form-login default-target-url="/index" login-processing-url="/login_form" login-page="/login" authentication-failure-handler-ref="authExceptionMapping" />
    </security:http>

    <security:authentication-manager>
        <security:authentication-provider ref="customAuthProvider" />
    </security:authentication-manager>
</beans> 
```

`RootConfig`如果我将and`WebAppConfig`类合并为 just`WebAppConfig`并具有以下内容，我将无法使其工作：

```
@Override
protected Class< ? >[] getRootConfigClasses() {
    return null;
}

@Override
protected Class< ? >[] getServletConfigClasses() {
    return new Class[] { WebAppConfig.class };
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-07-09T16:20:34.400

```
public class SIServerSecurityWebApplicationInitializer extends AbstractSecurityWebApplicationInitializer {

    @Override
    protected void beforeSpringSecurityFilterChain(ServletContext servletContext) {
        Dynamic registration = servletContext.addFilter("TenantServletFilter", TenantServletFilter.class);
        EnumSet<DispatcherType> dispatcherTypes = getSecurityDispatcherTypes();
        registration.addMappingForUrlPatterns(EnumSet.of(DispatcherType.REQUEST), false, "/*");
    }

} 
```

此方案用于在执行其他过滤器之前执行过滤器。如果要在其他过滤器传入后执行过滤`true`器`registration.addMappingForUrlPatterns(EnumSet.of(DispatcherType.REQUEST), true, "/*");`。还要检查 DispatcherType ASYNC、FORWARD 等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-18T22:59:15.093

面临同样的问题。合并 RootConfig 和 WebAppConfig - 不是最好的方法 - 因为我没有尝试这个解决方案。尝试了所有其他解决方案 - 每次都得到“org.apache.catalina.core.StandardContext.startInternal Error filterStart”。经过一番工作，得到了这样的东西：

```
 FilterRegistration.Dynamic enc= servletContext.addFilter("encodingFilter",
            new CharacterEncodingFilter());
    encodingFilter .setInitParameter("encoding", "UTF-8");
    encodingFilter .setInitParameter("forceEncoding", "true");
    encodingFilter .addMappingForUrlPatterns(null, true, "/*"); 
```

但不适用于 DelegatingFilterProxy()。继续寻找所有过滤器的最佳通用解决方案。

**更新：** 我做到了。

所以，主要问题是：如果你想使用 java config 添加过滤器，特别是如果你想添加安全过滤器，例如 DelegatingFilterProxy，那么你必须创建 WebAppSecurityConfig：

```
@Configuration
@EnableWebSecurity
@ImportResource("classpath:security.xml")
public class WebAppSecurityConfig extends WebSecurityConfigurerAdapter {
} 
```

在这种情况下，我创建 WebAppSecurityConfig 并导入资源（“security.xml”）。这让我可以在 Initializer 类中做到这一点：

```
servletContext.addFilter("securityFilter", new DelegatingFilterProxy("springSecurityFilterChain"))
            .addMappingForUrlPatterns(null, false, "/*"); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-12-15T12:40:11.037

这与那些对具有安全性的 Spring Boot 感兴趣的人有关：您不需要任何东西，Spring Boot 拿起 @components 并解决其他问题

# ssl - Nodejitsu SSL 证书

> ID：14205143
> 
> 赞同：5
> 
> 时间：2013-01-07T22:24:32.737
> 
> 标签：ssl, nodejitsu

有谁知道如何将 SSL 证书部署到我的 nodejitsu 应用程序？

我可以看到我已经启用了 https，但我想购买 SSL 证书，因为我正在营业。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T01:07:52.590

要在 Nodejitsu 上使用自定义域获取 SSL 证书，您可以执行以下操作：

1.  订阅[Nodejitsu 上的“商业”计划](https://www.nodejitsu.com/paas/pricing/#business)（自定义域 + SSL 不适用于“个人”计划）。
2.  [设置您的 DNS](https://www.nodejitsu.com/documentation/features/dns/)以使用您的域。
3.  创建一个证书签名请求 (CSR)，[可能通过像这样使用 OpenSSL](https://devcenter.heroku.com/articles/csr)。
4.  从您选择的证书颁发机构 (CA) 购买您的 SSL 证书。
5.  转到您的 Nodejitsu webops 面板，其中有一个适用于您的应用的 SSL 选项卡。
6.  通过 webops 面板上传您的私钥（使用您的 CSR 创建）、您的证书和您的 CA 证书。

这些步骤的详细信息将略有不同，具体取决于您用于创建 CSR 的内容以及您的证书提供者是谁。如果您遇到困难， [Nodejitsu 支持](https://www.nodejitsu.com/support/)可以帮助您进行设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T22:31:19.977

像这样：

```
var https = require('https');
var fs = require('fs');

var options = {
  key: fs.readFileSync('key.pem'),
  cert: fs.readFileSync('cert.pem')
};

var a = https.createServer(options, function (req, res) {
  res.writeHead(200);
  res.end("hello world\n");
}).listen(8000); 
```

`cert.pem`证书的路径应该在哪里，并且`key.pem`应该是其私钥的路径

[http://docs.nodejitsu.com/articles/HTTP/servers/how-to-create-a-HTTPS-server](http://docs.nodejitsu.com/articles/HTTP/servers/how-to-create-a-HTTPS-server)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T11:20:48.307

给我们写信到 support@nodejitsu.com 或在 IRC 上的 Freenode 中的#nodejitsu ( [http://webchat.jit.su](http://webchat.jit.su/) ) 访问我们，我们将帮助您配置自定义 ssl 证书。

# javascript - 将所有表单转换为 AJAX 表单的代码？

> ID：14205145
> 
> 赞同：0
> 
> 时间：2013-01-07T22:24:38.517
> 
> 标签：javascript, jquery, ajax, forms

因此，我使用以下代码来操作我的“登录”表单，以便将其提交到 action="" 的 url，并且响应的数据进入 target="" 指定的 id。提交方法由method=""指定

我喜欢这个。很整洁。但我想知道是否有一种方法可以让所有表单都通过 Jquery 提交，而不必每次都为每个表单重新编写此代码。那只是一团糟。

非常感激！

```
<script type="text/javascript">
$(document).ready(function(){

    $("#login").submit(function(){
         var thistarget = this.target;
         $(thistarget).html('Submitting...');   
         jQuery.ajax({
             data: $(this).serialize(),
             url: this.action,
             type: this.method,
             error: function() {
                 $(thistarget).html("Form failed to submit");
             },
             success: function(results) {
                 $(thistarget).html(results);
             }
         })
         return false;
         }
    );
});

</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:29:30.307

当然，只需替换`"#login"`为`"form"`. 然后它将影响页面上当前存在的所有表单（但不会影响未来的表单）。

```
$("#login").submit(function(){... 
```

对于未来的表格和当前的表格，您需要事件委托。

```
$(document).on("submit","form",function(){... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T22:31:46.277

如果我是你，我会使用 Jquery 的 $.post 方法。[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/) 但回答你的问题，正如 Kevin B 所说：按*表格更改**#login*

# c# - null 金额值 salesorderdetail on crm 2011-Silverlight

> ID：14205147
> 
> 赞同：0
> 
> 时间：2013-01-07T22:24:51.560
> 
> 标签：c#, silverlight, dynamics-crm-2011

我正在尝试在 SalesOrderDetail 实体上插入数据，一切正常，除了保持为空的 Amount 字段。我没有收到任何错误消息。这是我的代码示例：

```
private void beginCreateSalesOrderDetail()
{
    SalesOrderDetail orderDetail = new SalesOrderDetail();
    orderDetail.SalesOrderId = new EntityReference() 
    { 
       Id = id, 
       LogicalName = "salesorder" 
    };
    orderDetail.Quantity = element.QuantityOnHand;
    orderDetail.ProductId = new EntityReference() 
    { 
        Id = element.ProductId, 
        LogicalName = "product" 
    };
    orderDetail.UoMId = new EntityReference() 
    { 
        Id = new Guid("8DDD2AFB-73CF-E111-8140-00155D55B216"),        
        LogicalName = "uom" 
    };
    orderDetail.TransactionCurrencyId = new EntityReference() 
    { 
        Id = new Guid("77D695B5-ACB4-E111-97BC-00155D55B216"), 
        LogicalName = "transactioncurrency" 
    };

    Money Taxe = new Money(); 
    Money Amount = new Money();
    Taxe.Value = Convert.ToDecimal(element.totalCharges);
    Amount.Value = Convert.ToDecimal(InvoiceTotal);
    orderDetail.Tax = Taxe;
    orderDetail.BaseAmount = Amount;
    orderDetail.PricePerUnit = element.Price;
    orderDetail.Description = element.PDesc;
   _context.AddToSalesOrderDetailSet(orderDetail);
 _context.BeginSaveChanges(EndCreateSalesOrderDetail, orderDetail);

}

private void EndCreateSalesOrderDetail(IAsyncResult result)
  {

     try
     {
       _context.EndSaveChanges(result);
     }
            catch (Exception ex)
            {
            }

   } 
```

请注意，只有保持为空的金额

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T16:57:40.157

我得到了解决方案。实际上，crm 2011 对计算产品数量有一个限制，我们必须创建一个价目表，并将列表中的每个产品关联起来。谢谢你。

# openerp - OpenERP 6.1 未找到处理程序

> ID：14205151
> 
> 赞同：1
> 
> 时间：2013-01-07T22:25:09.220
> 
> 标签：openerp

在过去的 3 或 4 个月里，我一直在 Ubuntu 服务器 12.04 LTS 上运行 OpenERP 6.1。在那段时间里，我多次重新启动（重新启动）Ubuntu。我从他们网站上下载的包中安装了 OpenERP。我手动添加了 pychart.py 模块，因为没有它它不会启动 openerp-server。到目前为止，一切都运行得很顺利。

今天我用修改后的重新编译版本替换了purchase.pyc文件，并以不同的名称备份了原始版本。然后我重新启动了 openerp-server（sudo service openerp restart）。我从我的 Firefox windows 客户端连接到 openerp，并得到一个“未找到处理程序”的白屏。

在所有这些操作之前，它工作正常。所以我想我已经用我的更改填满了它，并决定恢复原始的 purchase.pyc 文件。按照与上述相同的步骤重新启动 openerp-server，但仍然出现“未找到处理程序”白屏。

重新启动Ubuntu，从服务重新启动openerp-server并手动多次，刷新firefox连接，将端口8069 / tcp OUT添加到UFW，因为它只是IN。没有任何帮助，我仍然得到“未找到处理程序”白屏。

这怎么可能？？？

我在网上从其他人那里阅读了其他相同的问题，但每次他们似乎都找到了自己的解决方案。

我唯一依赖的是日志文件：

```
2013-01-07 14:10:03,958 1381 INFO ? openerp: OpenERP version 6.1-20121008-233119

2013-01-07 14:10:03,958 1381 INFO ? openerp: addons paths: /home/download/openerp- 6.1-20121008-233119/openerp/addons

2013-01-07 14:10:03,958 1381 INFO ? openerp: database hostname: localhost
2013-01-07 14:10:03,958 1381 INFO ? openerp: database port: 5432
2013-01-07 14:10:03,959 1381 INFO ? openerp: database user: openerp
2013-01-07 14:10:03,959 1381 INFO ? openerp.service.netrpc_server: starting NET-RPC service on 0.0.0.0:8070
2013-01-07 14:10:03,960 1381 INFO ? openerp.netsvc: Starting 1 services
2013-01-07 14:10:03,986 1381 INFO ? openerp.wsgi.core: HTTP service (werkzeug) running on 0.0.0.0:8069
2013-01-07 14:10:04,062 1381 INFO ? openerp.addons.web: embedded mode
2013-01-07 14:10:04,226 1381 CRITICAL ? openerp.modules.module: Couldn't load module web
2013-01-07 14:10:04,227 1381 CRITICAL ? openerp.modules.module: No module named sale_order
2013-01-07 14:10:04,227 1381 ERROR ? openerp: Failed to load server-wide module `web`.
The `web` module is provided by the addons found in the `openerp-web` project.
Maybe you forgot to add those addons in your addons_path configuration.
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/openerp-6.1_20121008_233119-py2.7.egg/EGG-INFO/scripts/openerp-server", line 252, in <module>
    openerp.modules.module.load_openerp_module(m)
  File "/usr/local/lib/python2.7/dist-packages/openerp-6.1_20121008_233119-py2.7.egg/openerp/modules/module.py", line 419, in load_openerp_module
    getattr(sys.modules['openerp.addons.' + module_name], info['post_load'])()
  File "/home/download/openerp-6.1-20121008-233119/openerp/addons/web/__init__.py", line 29, in wsgi_postload
    app = common.http.Root(o)
  File "/home/download/openerp-6.1-20121008-233119/openerp/addons/web/common/http.py", line 453, in __init__
    static_dirs = self._load_addons(openerp_addons_namespace)
  File "/home/download/openerp-6.1-20121008-233119/openerp/addons/web/common/http.py", line 523, in _load_addons
    m = __import__('openerp.addons.' + module)
  File "/usr/local/lib/python2.7/dist-packages/openerp-6.1_20121008_233119-py2.7.egg/openerp/modules/module.py", line 139, in load_module
    mod = imp.load_module('openerp.addons.' + module_part, f, path, descr)
  File "/home/download/openerp-6.1-20121008-233119/openerp/addons/sale/__init__.py", line 29, in <module>
    import report
  File "/home/download/openerp-6.1-20121008-233119/openerp/addons/sale/report/__init__.py", line 22, in <module>
    import sale_order
ImportError: No module named sale_order
2013-01-07 14:10:04,228 1381 INFO ? openerp: OpenERP server is running, waiting for connections...
2013-01-07 14:10:28,283 1381 INFO ? werkzeug: 192.xxx.xx.xx - - [07/Jan/2013 14:10:28] "GET /web/webclient/home HTTP/1.1" 404 -
2013-01-07 14:10:37,390 1381 INFO ? openerp.netsvc: Stopping 1 services 
```

为澄清起见，IP 地址 192.xxx.xx.xx 对应于客户端试图通过网络访问 openerp 并收到“未找到处理程序”消息。尝试在另一个客户端上得到了相同的结果。

为什么有两条 CRITICAL 行？为什么它不能在一个小时前没有问题的情况下加载模块 Web？它告诉我 sale_order 模块不存在，但确实存在。

一些决议说将 addons 文件夹的路径添加到 openerp-server.init 文件中。但是，当它在一小时前没有要求时，我为什么要这样做呢？它还提到了一个 openerp-web 项目，一旦安装，它显然会变成插件下的 openerp-web 文件夹，并且应该指定到插件路径中。我目前没有这个文件夹，以前也不需要它，所以我不相信我在正确的道路上解决我的问题。

有人知道吗？这对我来说完全没有意义。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:55:30.270

在标准模块中，没有名为 sale_order 的模块。也许是销售模块。检查自定义模块中的依赖关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T00:36:10.923

看起来除了安装了 Debian 软件包之外还安装了其他东西，并且两者以 Bad Ways 交互。查看回溯中的路径：

```
File "/usr/local/lib/python2.7/dist-packages/openerp-6.1_20121008_233119-py2.7.egg/EGG-INFO/scripts/openerp-server", line 252, in <module> 
```

与此相比：

```
File "/home/download/openerp-6.1-20121008-233119/openerp/addons/sale/__init__.py", line 29, in <module> 
```

这绝对不是来自已安装的 Debian 软件包，无论如何，在如此不同的地方都有一些 OpenERP 是很奇怪的。这在您的环境中是预期的吗？如果没有，我敢打赌这就是问题所在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T07:55:38.883

请查看销售模块，report 文件夹中是否有一个名为 sale_order.py 的文件？如果不是，请下载销售模块并替换为您的销售模块。sale_order.py 有销售订单报告的解析器。**如果您不想要该报告，请在 sale 模块的报告文件夹中的init** .py 文件中注释 import sale_order 行。

# linux - 使用 awk 或 sed 从字符串中获取特定的文本部分

> ID：14205152
> 
> 赞同：0
> 
> 时间：2013-01-07T22:25:18.520
> 
> 标签：linux, bash, sed, awk

我正在寻找从字符串中获取两个字段。这是示例：

```
$_LANG['field1'] = "field two"; 
```

我希望能够返回：field1 fieldtwo

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T22:29:11.013

这是一种使用方法`awk`：

```
awk -F "[\"']" '{ print $2, $4 }' file 
```

结果：

```
field1 field two 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T22:30:14.933

```
sed 's/.*'\''\(.*\)'\''.*"\(.*\)".*/\1 \2/' 
```

转义 ' 在 shell <3

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T00:11:17.900

这是一种使用方法`GNU sed`：

```
sed -r "s/.*'(.*?)'.*\"(.*?)\".*/\1 \2/" file 
```

结果：

```
field1 field two 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T23:05:41.970

```
sed -ey:\"\':\\n\\n: -e'/[^\n]*\n/s:::;/\n[^\n]*\n/s:: :;/\n.*$/sxxx' FILE 
```

其他可能性：

```
sed -ey:\"\':\\n\\n: -e'/[^\n]*\n\([^\n]*\)\n[^\n]*\n\([^\n]*\)\n.*/ sxx\1 \2x' 
```

其他变体：

```
cat FILE | tr [\'\"] \\n\\n | sed '3h;6H;${x;s:\n: :p};d' 
```

# c++ - 在增强精神语义动作中通过 std::map 过滤合成属性

> ID：14205154
> 
> 赞同：1
> 
> 时间：2013-01-07T22:25:22.440
> 
> 标签：c++, boost, boost-spirit, boost-spirit-qi

我有一个案例，我想通过 std::map 过滤作为规则内部综合属性出现的值。

*   地图是预先生成的，在解析过程中不会改变。
*   映射的性质和真正的解析器意味着查找永远不会失败（尽管元素的实际数量可能非常大）
*   完全适合这个问题的常用方法（使用符号表）不适合实际情况。在真正的问题中，查找是基于一个属性的条件，该属性直到解析的很晚才会出现（在一个稍微删除的规则中）。

我的尝试：

```
#define BOOST_SPIRIT_USE_PHOENIX_V3
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix.hpp>
#include <boost/foreach.hpp>
#include <string>
#include <iostream>
#include <vector>
#include <map>

namespace qi = boost::spirit::qi;
namespace phx = boost::phoenix;

int main() {

    std::map<unsigned int, unsigned int> myMap;
    myMap[1] = 100; myMap[2] = 200; myMap[3] = 300;

    std::string test = "1 2 3";
    std::vector<unsigned int> results;

    qi::rule<std::string::iterator, unsigned int()> r
                      = qi::uint_ [qi::_val = phx::at(myMap, qi::_1)];

    qi::parse(test.begin(), test.end(), ( r % " " ), results);

    BOOST_FOREACH(unsigned int &x, results) {
        std::cout << x << "\n";
    }
} 
```

我想我的印象是，由于凤凰对[stl 容器](http://www.boost.org/doc/libs/1_47_0/libs/phoenix/doc/html/phoenix/modules/stl/container.html)的支持，这应该可以工作。但是我在规则行上得到一个编译错误。如果我用经典的无意义的语义动作替换这个错误`[qi::_val = qi::_1]`（不足为奇），这个错误就会消失。

像往常一样，MSVS10 下的编译器错误非常长，但这是我的代码文件的第一次提及：（在 C:\code\Compiler2\spirit_test.cpp(25)... 第 25 行是规则`r`）

```
C:\boost_1_50_0\boost/spirit/home/qi/nonterminal/rule.hpp(191) : see reference to function template instantiatio
n 'void boost::spirit::qi::rule<Iterator,T1>::define<boost::mpl::false_,Expr>(boost::spirit::qi::rule<Iterator,T1> &,con
st Expr &,boost::mpl::true_)' being compiled
        with
        [
            Iterator=std::_String_iterator<char,std::char_traits<char>,std::allocator<char>>,
            T1=unsigned int (void),
            Expr=boost::proto::exprns_::expr<boost::proto::tagns_::tag::subscript,boost::proto::argsns_::list2<const boo
st::spirit::terminal<boost::spirit::tag::uint_> &,const boost::phoenix::actor<boost::proto::exprns_::basic_expr<boost::p
roto::tagns_::tag::assign,boost::proto::argsns_::list2<boost::proto::exprns_::expr<boost::proto::tagns_::tag::terminal,b
oost::proto::argsns_::term<boost::spirit::attribute<0>>,0>,boost::phoenix::actor<boost::proto::exprns_::basic_expr<boost
::phoenix::detail::tag::function_eval,boost::proto::argsns_::list3<boost::proto::exprns_::basic_expr<boost::proto::tagns
_::tag::terminal,boost::proto::argsns_::term<boost::phoenix::stl::at_impl>,0>,boost::phoenix::actor<boost::proto::exprns
_::basic_expr<boost::proto::tagns_::tag::terminal,boost::proto::argsns_::term<boost::reference_wrapper<std::map<unsigned
 int,unsigned int>>>,0>>,boost::phoenix::actor<boost::spirit::argument<0>>>,3>>>,2>> &>,2>
        ]
        C:\code\Compiler2\spirit_test.cpp(25) : see reference to function template instantiation 'boost::spirit::qi
::rule<Iterator,T1>::rule<boost::proto::exprns_::expr<Tag,Args,Arity>>(const Expr &,const std::string &)' being compiled

        with
        [
            Iterator=std::_String_iterator<char,std::char_traits<char>,std::allocator<char>>,
            T1=unsigned int (void),
            Tag=boost::proto::tagns_::tag::subscript,
            Args=boost::proto::argsns_::list2<const boost::spirit::terminal<boost::spirit::tag::uint_> &,const boost::ph
oenix::actor<boost::proto::exprns_::basic_expr<boost::proto::tagns_::tag::assign,boost::proto::argsns_::list2<boost::pro
to::exprns_::expr<boost::proto::tagns_::tag::terminal,boost::proto::argsns_::term<boost::spirit::attribute<0>>,0>,boost:
:phoenix::actor<boost::proto::exprns_::basic_expr<boost::phoenix::detail::tag::function_eval,boost::proto::argsns_::list
3<boost::proto::exprns_::basic_expr<boost::proto::tagns_::tag::terminal,boost::proto::argsns_::term<boost::phoenix::stl:
:at_impl>,0>,boost::phoenix::actor<boost::proto::exprns_::basic_expr<boost::proto::tagns_::tag::terminal,boost::proto::a
rgsns_::term<boost::reference_wrapper<std::map<unsigned int,unsigned int>>>,0>>,boost::phoenix::actor<boost::spirit::arg
ument<0>>>,3>>>,2>> &>,
            Arity=2,
            Expr=boost::proto::exprns_::expr<boost::proto::tagns_::tag::subscript,boost::proto::argsns_::list2<const boo
st::spirit::terminal<boost::spirit::tag::uint_> &,const boost::phoenix::actor<boost::proto::exprns_::basic_expr<boost::p
roto::tagns_::tag::assign,boost::proto::argsns_::list2<boost::proto::exprns_::expr<boost::proto::tagns_::tag::terminal,b
oost::proto::argsns_::term<boost::spirit::attribute<0>>,0>,boost::phoenix::actor<boost::proto::exprns_::basic_expr<boost
::phoenix::detail::tag::function_eval,boost::proto::argsns_::list3<boost::proto::exprns_::basic_expr<boost::proto::tagns
_::tag::terminal,boost::proto::argsns_::term<boost::phoenix::stl::at_impl>,0>,boost::phoenix::actor<boost::proto::exprns
_::basic_expr<boost::proto::tagns_::tag::terminal,boost::proto::argsns_::term<boost::reference_wrapper<std::map<unsigned
 int,unsigned int>>>,0>>,boost::phoenix::actor<boost::spirit::argument<0>>>,3>>>,2>> &>,2>
        ]
C:\boost_1_50_0\boost/proto/transform/default.hpp(154) : error C2440: '=' : cannot convert from 'std::pair<_Ty1,_Ty2>' t
o 'unsigned int'
        with
        [
            _Ty1=const unsigned int,
            _Ty2=unsigned int
        ]
        No user-defined-conversion operator available that can perform this conversion, or the operator cannot be called 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:52:40.960

[从评论转发]

尝试`qi::_val = phx::ref(myMap)[qi::_1]`而不是`qi::_val = phx::at(myMap, qi::_1)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T00:27:03.033

问题是 phoenix::at 的返回类型在[此标头](http://www.boost.org/boost/phoenix/stl/container/container.hpp)中定义为`container::value_type`. 在地图的情况下这是一对。只需将结果专门化为 map 即可（使用 ildjarn 指出的 ref ）。

```
#define BOOST_SPIRIT_USE_PHOENIX_V3
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix.hpp>
#include <boost/foreach.hpp>
#include <string>
#include <iostream>
#include <vector>
#include <map>

namespace qi = boost::spirit::qi;
namespace phx = boost::phoenix;

namespace boost { namespace phoenix { namespace stl {
    template <typename This, typename Key, typename Value, typename Compare, typename Allocator, typename Index>
        struct at_impl::result<This(std::map<Key,Value,Compare,Allocator>&, Index)>
        {
            typedef Value & type;
        };
    template <typename This, typename Key, typename Value, typename Compare, typename Allocator, typename Index>
        struct at_impl::result<This(std::map<Key,Value,Compare,Allocator> const&, Index)>
        {
            typedef Value const& type;
        };
}}}

int main() {

    std::map<unsigned int, unsigned int> myMap;
    myMap[1] = 100; myMap[2] = 200; myMap[3] = 300;

    std::string test = "1 2 3";
    std::vector<unsigned int> results;

    qi::rule<std::string::iterator, unsigned int()> r
                      = qi::uint_ [qi::_val = phx::at(phx::cref(myMap), qi::_1)];

    qi::parse(test.begin(), test.end(), ( r % " " ), results);

    BOOST_FOREACH(unsigned int &x, results) {
        std::cout << x << "\n";
    }
} 
```

# google-chrome-extension - 如何从调试选项卡获取 DOM 到扩展脚本

> ID：14205155
> 
> 赞同：2
> 
> 时间：2013-01-07T22:25:32.293
> 
> 标签：google-chrome-extension

我在这里寻求一些帮助，因为我看到的示例只是从选项卡到扩展，而不是相反。

我正在寻找使用自定义 Chrome 扩展程序调试的页面/选项卡的源代码。我希望扩展程序调用消息并将响应发送回扩展面板 javascript 进行调用。

**显现**

```
"permissions": [
  "tabs",
  "<all_urls>",
  "debugger"
],
"background": {
  "scripts": ["background.js"],
  "persistent": false
},
"content_scripts": [
  {
  "matches": ["<all_urls>"],
  "js": ["content.js"]
  }
], 
```

**背景.js**

```
chrome.browserAction.onClicked.addListener(function() {
  chrome.tabs.query({active:true, windowId:chrome.windows.WINDOW_ID_CURRENT}, function(tabs) {
    debuggee = {tabId:tabs[0].id};
chrome.debugger.attach(debuggee, version, onAttach.bind(null, tabs[0].id));
  });
});

function onAttach(tabId) {
  chrome.windows.create({url: "spy.html?" + tabId, type: "panel", width: 900, height: 700}, function(window) {
    winId = window.id;
}); 
```

**内容.js**

```
chrome.extension.onMessage.addListener(function(request, sender, sendResponse) {
  if (request.data == "getHTML") {
      sendResponse({data: document.getElementById('header').innerHTML});
  }
}); 
```

**间谍.html**

```
<script src="spy.js" type="text/javascript"></script> 
```

**间谍.js**

```
window.addEventListener("load", function() {
  chrome.debugger.sendCommand({tabId:tabId}, "DOM.getDocument");
  chrome.debugger.onEvent.addListener(onEvent);
});

function onEvent(debuggeeId, message, params) {    
  if (message=="DOM.documentUpdated") {
    chrome.tabs.sendMessage(tabId, {data: "getHTML"}, function(response) {console.log(response.data);});
  } 
```

**结果**

端口错误：无法建立连接。接收端不存在。miscellaneous_bindings:235 chromeHidden.Port.dispatchOnDisconnect miscellaneous_bindings:235

> “未定义”的事件处理程序错误：无法读取未定义的属性“数据”类型错误：无法
> 在 chrome-extension://fpdkndicjblnkakkiiapbbdflkehjmgm/headers.js:132:91
> 在 miscellaneous_bindings:279:11
> 处读取未定义的属性“数据” chrome.Event.dispatchToListener (event_bindings:387:21)
> 在 chrome.Event.dispatch_ (event_bindings:373:27)
> 在 chrome.Event.dispatch (event_bindings:393:17)
> 在 Object.chromeHidden.Port.dispatchOnDisconnect (miscellaneous_bindings:238 :27)

当我尝试运行它时出现此错误。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T21:41:07.920

好的，我已经想通了。由于我需要加载页面的 DOM，我将在我的后台页面中使用 chrome.tabs.onUpdated.addListener 在页面加载时发送代码。这样我就不必依赖选项卡和扩展程序之间的 2 路通信。

**显现**

删除 content.js

**背景.js**

添加了以下内容

```
chrome.tabs.onUpdated.addListener(function(tabId, changeInfo, tab) {
  if (tabId != _tabId) {return;}
  if (changeInfo.status == "complete") {
    chrome.tabs.executeScript(tabId, {code:"var x = document.documentElement.innerHTML;x"}, function (r) {
      chrome.extension.sendMessage(null, {"data": r[0]});       
    });
  }
}); 
```

**内容.js**

已移除

**间谍.js**

添加了以下内容

```
chrome.extension.onMessage.addListener(function(request, sender) {
  console.log("Request.data: " + request.data);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T05:52:41.927

你是如何捕获`tabId`的`chrome.tabs.sendMessage(tabId,`，你可以发布你的完整脚本来调试问题，如果你正在寻找一个示例代码来传递消息`Chrome Extension`来`Debugging Tab`检查这个。

# 参考

*   [内容安全政策](https://developer.chrome.com/extensions/contentSecurityPolicy.html#JSExecution)
*   [标签查询](https://developer.chrome.com/extensions/tabs.html#method-query)
*   [tabs.sendMessage](https://developer.chrome.com/extensions/tabs.html#method-sendMessage)
*   [extension.onMessage](https://developer.chrome.com/extensions/extension.html#event-onMessage)

### 清单.json

注册`popup`页面和`content scripts`.

```
{
 "name": "Pass message from Chrome Extension to Debugging Tab",
 "version": "1",
 "description": "http://stackoverflow.com/questions/14205155/how-can-i-pass-a-message-from-my-chrome-extension-to-debugging-tab",
 "browser_action": {
   "default_title": "Selected Text",
   "default_popup": "popup.html" 
 },
 "permissions": [
   "tabs",
   "<all_urls>"
 ],
 "content_scripts": [
  {
    "matches": ["<all_urls>"],
    "js": ["selection.js"]
  }
 ],
 "manifest_version": 2
} 
```

### popup.html

确保 HTML 遵守 CSP

```
<!DOCTYPE html>
<html>

    <head>
        <style>
            body {
                width: 300px;
            }
            textarea {
                width: 250px;
                height: 100px;
            }
        </style>
        <script src="popup.js"></script>
    </head>

    <body>
          <button id="submit">Pass Message</button>
    </body>

</html> 
```

### popup.js

将消息传递给内容脚本。

```
function passMessage() {
    //Select current tab to send message
  chrome.tabs.query({"active":true,"currentWindow":true,"status":"complete","windowType":"normal"}, function(tabs) {
  //It returns array so looping over tabs result
    for(tab in tabs){

    //Send Message to a tab
    chrome.tabs.sendMessage(tabs[tab].id, {method: "Hi Content Script"});
    }   
});
}

// Bind On click event to passMessage() function
document.addEventListener("DOMContentLoaded",function (){

    document.getElementById("submit").onclick = passMessage;
}); 
```

### 选择.js

添加了一个处理程序来捕获从弹出页面发送的消息

```
 //Add a handler to handle message sent from popup.html
 chrome.extension.onMessage.addListener(function(request, sender) {
    console.log("Message "+request+" is recieved");

}); 
```

# 编辑：

在消除了一些不推荐使用的 API() 之后，我让你的代码工作了`sendResponse`

**背景.js**

```
chrome.browserAction.onClicked.addListener(function () {
    version = "1.0";
    chrome.tabs.query({
        active: true,
        windowId: chrome.windows.WINDOW_ID_CURRENT
    }, function (tabs) {
        debuggee = {
            tabId: tabs[0].id
        };
        chrome.debugger.attach(debuggee, version, onAttach.bind(null, tabs[0].id));
    });
});

function onAttach(tabId) {
    chrome.windows.create({
        url: "spy.html?" + tabId,
        type: "panel",
        width: 900,
        height: 700
    }, function (window) {
        winId = window.id;
    });
} 
```

**内容.js**

```
chrome.extension.onMessage.addListener(function (request, sender) {
    console.log("Message recieved");
    if (request.data == "getHTML") {
        chrome.extension.sendMessage({
            "data": "Some Stuff"
        });
    }
}); 
```

**间谍.js**

```
tabId = parseInt(window.location.search.substring(1));
window.addEventListener("load", function () {

    chrome.debugger.sendCommand({
        tabId: tabId
    }, "DOM.getDocument");
    chrome.debugger.onEvent.addListener(onEvent);
});

function onEvent(debuggeeId, message, params) {
    if (message == "DOM.documentUpdated") {
        chrome.tabs.sendMessage(tabId, {
            "data": "getHTML"
        });
    }
}
chrome.extension.onMessage.addListener(function (response, sender) {
    console.log(response);
}); 
```

如何确保您在测试期间不会手动触发开发人员工具。

# lua - 如何从 Lua 内部运行另一个脚本？

> ID：14205157
> 
> 赞同：20
> 
> 时间：2013-01-07T22:25:36.527
> 
> 标签：lua

我需要从另一个 Lua 脚本中执行一个 Lua 脚本。有多少种方法，我如何使用它们？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-07T22:25:36.527

通常你会使用以下内容：

```
dofile("filename.lua") 
```

但是你可以`require()`很好地做到这一点。例子：

foo.lua：

```
io.write("Hello,")
require("bar") 
```

bar.lua:

```
io.write(" ")
require("baz") 
```

baz.lua:

```
io.write("World")
require("qux") 
```

qux.lua：

```
print("!") 
```

这将产生输出：

```
Hello, World! <newline> 
```

请注意，您在使用时不使用`.lua`扩展名`require()`，但您确实需要它`dofile()`。如果需要，请[在此处](http://www.lua.org/pil/8.1.html)获取更多信息。

# ruby - Rubygems，gemspec，可能的 rvm 错误

> ID：14205162
> 
> 赞同：-1
> 
> 时间：2013-01-07T22:25:42.327
> 
> 标签：ruby, rubygems, ruby-on-rails-3.2, rvm

升级到 Rails 3.2 和 Rubygems 时出现错误消息。按照 stackoverflow 的建议，我`gem update --system`将 Rubygems 升级到 1.8.24。在此更新之后，我运行了一个简单的`rails s`命令，并且我运行的每个命令都出现了这个持续错误。

我的 RVM 版本是：1.17.7

我的 Ruby 版本是：`ruby 1.9.2p320 (2012-04-20 revision 35421) [x86_64-darwin11.3.0]`

当我运行时`bundle install`，我得到一个错误：

```
"Could not find twitter-1.6.0 in any of the sources" 
```

当我运行时`rails -v`，我得到一个错误：

```
could not find rack-1.2.3\. run bundle install. 
```

我想我可能`sudo`在某个时候也使用该命令安装了 gems，这可能搞砸了我的过程。有没有办法检查？或更正？

```
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/actionmailer-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d85b5f0> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/actionpack-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d93d6a8> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/activemodel-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d89b5b0> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/activerecord-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d9ddc48> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/activeresource-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d9cdca8> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/rails-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d908d68> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/railties-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8c034468> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/actionmailer-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d85b5f0> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/actionpack-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d93d6a8> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/activemodel-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d89b5b0> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/activerecord-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d9ddc48> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/activeresource-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d9cdca8> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/rails-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d908d68> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/railties-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8c034468> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/actionmailer-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d85b5f0> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/actionpack-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d93d6a8> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/activemodel-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d89b5b0> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/activerecord-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d9ddc48> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/activeresource-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d9cdca8> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/rails-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d908d68> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/railties-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8c034468> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/actionmailer-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d85b5f0> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/actionpack-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d93d6a8> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/activemodel-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d89b5b0> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/activerecord-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d9ddc48> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/activeresource-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d9cdca8> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/rails-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8d908d68> 3.2.0"]
Invalid gemspec in [/Users/jdo/.rvm/gems/ruby-1.9.2-p320/specifications/railties-3.2.0.gemspec]: Illformed requirement ["#<Syck::DefaultKey:0x007fad8c034468> 3.2.0"]
script/rails:6:in `require': no such file to load -- rails/commands (LoadError)
    from script/rails:6:in `<main>' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:23:41.590

如果您认为您使用 sudo 安装了 Rails，请尝试：

```
ls -al ~ | grep .rvm 
```

`~`是 的快捷方式`$HOME`，因此该命令将列出您的主目录，通过管道输出`grep`将搜索包含`.rvm`.

您的`.rvm`文件夹应该归您所有，如`rdo staff`列表所示。我们希望同时获取您的用户 ID 和组值`staff`（默认情况下），并告诉系统让您成为`.rvm`目录中所有文件的所有者。

```
sudo chown +r jdo:staff ~/.rvm 
```

`.rvm`对于 RVM 目录中的所有内容，包括已安装的 Rubies 和它们的 gem，这将递归地返回并重置文件和文件夹的所有权。

不要在驱动器上随意执行该命令，否则您的系统可能会变得非常糟糕，但是对于该目录，或者您知道应该属于您的用户的目录，这就是要使用的命令......只需小心指向扣动扳机时正确的目录。

# repository-pattern - 工作单元和存储库相互依赖

> ID：14205174
> 
> 赞同：4
> 
> 时间：2013-01-07T22:26:18.963
> 
> 标签：repository-pattern, unit-of-work

我看过很多关于 UnitOfWork 和 Repository 的帖子（和辩论！）。我喜欢的存储库模式之一是类型化的通用存储库模式，但我担心这会导致一些干净的代码和可测试性问题。采用以下存储库接口和泛型类：

```
public interface IDataEntityRepository<T> : IDisposable where T : IDataEntity
{
   // CRUD
   int Create(T createObject);
   // etc.
}

public class DataEntityRepository<T> : IDataEntityRepository<T> where T : class, IDataEntity
{
   private IDbContext Context { get; set; }

   public DataEntityRepository (IDbContext context)
   {
     Context = context;
   }

   private IDbSet<T> DbSet { get { return Context.Set<T>(); } }   

   public int Create(T CreateObject)
   {
      DbSet.Add(createObject);
   }

   // etc.

}

// where

public interface IDbContext
{
   IDbSet<T> Set<T>() where T : class;
   DbEntityEntry<T> Entry<T>(T readObject) where T : class;

   int SaveChanges();
   void Dispose();
} 
```

所以基本上我在每个模式中使用 Context 属性来访问底层上下文。我现在的问题是：当我创建我的工作单元时，它实际上是我需要存储库知道的上下文的包装器。因此，如果我有一个声明以下内容的工作单元：

```
public UserUnitOfWork(
    IDataEntityRepository<User> userRepository,
    IDataEntityRepository<Role> roleRepository)
{
    _userRepository = userRepository;
    _roleRepository = roleRepository;
}

private readonly IDataEntityRepository<User> _userRepository;

public IDataEntityRepository<User> UserRepository
{
    get { return _userRepository; }
}

private readonly IDataEntityRepository<Role> _roleRepository;

public IDataEntityRepository<Role> RoleRepository
{
    get { return _roleRepository; }
} 
```

我有一个问题，即我传入的两个存储库都需要使用它们被传递到的工作单元进行实例化。显然，我可以在构造函数中实例化存储库并传入“this”，但这会将我的工作单元与存储库的特定具体实例紧密耦合，并使单元测试变得更加困难。我很想知道是否还有其他人沿着这条路走并撞到了同一堵墙。这两种模式对我来说都是新的，所以我很可能会做一些根本错误的事情。任何想法将不胜感激！

## 更新（回复@MikeSW）

嗨，迈克，非常感谢您的意见。我正在使用 EF Code First，但我想抽象某些元素，以便在需要时切换到不同的数据源或 ORM，因为我（正在尝试！）将自己推向 TDD 路线并使用 Mocking 和 IOC。我想我已经意识到某些元素不能在纯粹意义上进行单元测试但可以进行集成测试的艰难方式！我想就存储库与业务对象或视图模型等一起工作提出您的观点。也许我误解了，但如果我有我认为的核心业务对象 (POCO)，然后我想使用 ORM，例如 EF 代码首先环绕这些实体以创建数据库，然后与之交互（并且，有可能，我可以在 ViewModel 中重用这些实体），我希望存储库能够在一组 CRUD 操作的上下文中直接处理这些实体。实体对持久层一无所知，任何 ViewModel 也不知道。我的工作单元只是实例化并保存允许执行事务提交的所需存储库（跨多个存储库但相同的上下文/会话）。我在我的解决方案中所做的是从 UnitOfWork 构造函数中删除 IDataEntityRepository ...等的注入，因为这是一个具体的类，它必须知道它应该创建的一种且只有一种类型的 IDataEntityRepository（在本例中为 DataEntityRepository , 这确实应该更好地命名为 EFDataEntityRepository)。我无法对其本身进行单元测试，因为整个单元逻辑将是建立具有某个数据库的上下文（本身）的存储库。它只需要一个集成测试。希望这是有道理的？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T13:01:27.017

为避免依赖工作单元中的每个存储库，您可以使用基于此合同的提供程序：

```
public interface IRepositoryProvider
{
    DbContext DbContext { get; set; }
    IRepository<T> GetRepositoryForEntityType<T>() where T : class;
    T GetRepository<T>(Func<DbContext, object> factory = null) where T : class;
    void SetRepository<T>(T repository);
} 
```

然后你可以将它注入到你的 UoW 中，如下所示：

```
public class UserUnitOfWork: IUserUnitOfWork
{
    public UserUnitOfWork(IRepositoryProvider repositoryProvider)
    {
        RepositoryProvider = repositoryProvider;
    }

    protected IDataEntityRepository<T> GetRepo<T>() where T : class
    {
        return RepositoryProvider.GetRepositoryForEntityType<T>();
    }

    public IDataEntityRepository<User> Users { get { return GetRepo<User>(); } }        
    public IDataEntityRepository<Role> Roles { get { return GetRepo<Role>(); } }        
... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T11:03:16.197

为我的反应迟缓道歉 - 我一直在尝试各种方法来解决这个问题。我已经标记了上面的答案，因为我同意所做的评论。

这是有多个答案的问题之一，它在很大程度上取决于整体方法。虽然我同意 EF 有效地提供了现成的工作单元模式，但我决定创建自己的工作单元和存储库层是为了能够控制对数据库实体的访问。

我挣扎的地方是需要能够将存储库注入到工作单元中。但我意识到，在 EF 的情况下，我的工作单元实际上是一个使用 Commit (SaveChanges) 方法围绕多个存储库的瘦包装器。它不负责执行 FindCustomer 等特定操作。

所以我决定一个工作单元可以与其特定类型的 DataRepository 模式紧密耦合。为了确保我有一个可测试的模式，我引入了一个服务层，它提供了用于执行特定操作（如 CreateCustomer、FindCustomers 等）的外观。这些服务接受了一个 IUnitOfWork 构造函数参数，该参数提供了对存储库（作为接口）的访问以及提交方法。

然后，我能够为测试目的创建工作单元和/或存储库的伪造品。这只是让我决定哪些可以用假货进行单元测试，哪些需要用具体实例进行集成测试。

这也让我有机会控制对数据库执行哪些操作以及如何执行这些操作。

我敢肯定有很多方法可以给这只特殊的猫换皮，但是提供一个可测试的干净界面的目标已经通过这种方法实现了。

感谢 g1ga 和 Mike 的投入。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-08T14:23:36.183

使用实体框架 (EF)（我假设您正在使用）时，您已经拥有一个通用存储库 IDbSet。仅仅为了调用 EF 方法而在顶部添加另一层是没有用的。

此外，存储库与应用程序对象（通常是业务对象，但它们可以是视图模型或对象状态）一起使用。如果您只是使用数据库实体，那么您有点违背了存储库模式的目的（将业务对象与数据库隔离）。原始模式只处理业务对象，但它也是业务层之外的有用模式。

关键是 EF 实体是 Persistence 对象，并且与您的业务对象没有（或应该有）任何关系。您想使用存储库模式将业务对象“转换”为持久性对象，反之亦然。

有时可能会发生应用程序对象（如视图模型）与持久性实体相同的情况（在这种情况下，您可以直接使用 EF 对象），但这是巧合。

关于工作单元（UoW），假设这很棘手。就个人而言，我更喜欢使用 DDD（域驱动设计）方法，并认为发送到存储库的任何业务对象 (BO) 都是 UoW，因此它将被包装在事务中。

如果我需要更新多个 BO，我将使用消息驱动架构向相关 BO 发送命令。当然，这更复杂，需要对最终一致性的概念感到轻松，但我并不依赖于特定的 RDBMS。

如果您知道您将使用特定的 RDBMS 并且永远不会更改，您可以启动一个事务并将关联的连接传递给每个存储库，最后提交一个提交（这将是 UoW）。如果您在网络设置中，则更容易，在请求开始时启动事务，在请求结束时提交（您可以使用 ASp.Net Mvc 的 ActionFilter）。

然而，该解决方案与一个 RDBMS 相关联，因此它不适用于 NoSql 或任何不支持事务的存储。对于这些情况，消息驱动的方式是最好的。

# javascript - 可折叠导航栏问题

> ID：14205178
> 
> 赞同：1
> 
> 时间：2013-01-07T22:26:39.537
> 
> 标签：javascript, css, twitter-bootstrap

我正在尝试创建一个类似于[Bootstrap](http://twitter.github.com/bootstrap/)的导航栏。如果您访问他们的网站并重新调整浏览器的大小。如果你把它重新调整得足够窄，顶部的导航栏就会变成一个按钮。当您单击按钮时，它会将所有内容向下推并再次显示完整的导航。

这就是我试图用这个[jsfiddle](http://jsfiddle.net/qMdYg/4/)完成的，但它有以下问题：

1.  最初，按钮并没有隐藏，它应该被隐藏并且只有在屏幕太窄时才可见。
2.  （固定）按钮不像引导程序那样显示背景
3.  （已修复）重新调整浏览器大小以使导航消失并单击按钮。然后点击子菜单，子菜单项显示不好。

问题 1 屏幕打印：

导航栏应该不可见，因为浏览器宽度大于 940px ![导航栏应该不可见，因为浏览器宽度大于 940px](../Images/f72fd743b17f3017dd5cedf9a3e92b80.png)

出现导航栏，没关系，因为浏览器宽度小于940px ![出现导航栏，没关系，因为浏览器宽度小于940px](../Images/b13ce44935d6e33c4bf471e2553285ea.png)

**完整的html代码：**

```
<html lang="en">
<head>
    <title></title>

    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-combined.min.css" rel="stylesheet" />

    <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {    
        });
    </script>
</head>
<body>
    <div class="conatiner-fluid">
        <div class="row-fluid">
            <div class="span10">

                <a class="btn btn-navbar" data-toggle="collapse"
                    data-target=".nav-collapse">
                    <span class="icon-bar"></span><span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>

                <div class="nav-collapse">
                    <ul class="nav nav-tabs">
                        <li><a href="#">Home</a></li>
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown"
                                href="#">Help<b class="caret"></b>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="#">Keep</a></li>
                                <li><a href="#">Screaming</a></li>
                            </ul>
                        </li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </div>

            </div>
        </div>
        <div class="row-fluid">
            <div class="span10">
                other content
            </div>
        </div>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T00:52:10.350

这更接近你所追求的吗？
[http://jsfiddle.net/panchroma/R4BEY/](http://jsfiddle.net/panchroma/R4BEY/)

您的示例中有一个 span10 div，但我不知道您的目标是什么，所以我在它之后添加了一个 span2 以完成该行。

HTML 如下。您在打开的容器 div 上有一个错字，并且您缺少 navbar 和 navbar-inner div。我认为这就是我所做的改变。

祝你好运

```
<div class="container-fluid"> 
<div class="row-fluid">
<div class="span10">

<div class="navbar">
<div class="navbar-inner">

<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
       <span class="icon-bar"></span>
       <span class="icon-bar"></span>
       <span class="icon-bar"></span>
 </a>

 <div class="nav-collapse collapse ">
    <ul class="nav nav-tabs">
      <li><a href="#">Home</a></li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Help<b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="#">Keep</a></li>
          <li><a href="#">Screaming</a></li>
        </ul>
      </li>
      <li><a href="#">Contact</a></li>
    </ul>
  </div> <!-- end nav-collapse -->

 </div><!-- end nav bar inner -->  
 </div> <!-- end nav bar -->

</div><!--end span10 -->
<div class="span2">span 2</div>
</div><!-- end row -->

<div class="row-fluid">
<div class="span10">
  other content
</div>
<div class="span2">span 2</div>
</div>
</div> 
```

# python - 将列表嵌入到 python 文件中

> ID：14205179
> 
> 赞同：0
> 
> 时间：2013-01-07T22:26:44.453
> 
> 标签：python, python-2.7

有没有办法将列表嵌入或集成到 .py 文件中？

我有一个字典列表，存储在磁盘上`hypotheses.npz`，打印时看起来像这样（前两个元素）：

`[[ {'d3': 936.0, 'v': 110.89930725097656, 'c1': 4.5781828608194246, 'c0': -0.11199983705745155, 'd2': 1041.0, 'd4': 495.0, 'fn_def': array([/Desktop/example/behaviors.pyc, BGL_Day_Av, [1482, 1483, 1484]], dtype=object), 'd1': 493.0}] [ {'d3': 949.0, 'v': 109.9293212890625, 'c1': 4.7908983437736889, 'c0': -0.097829151375310855, 'd2': 1054.0, 'd4': 831.0, 'fn_def': array([/Desktop/example/behaviors.pyc, BGL_Day_Av, [966, 967, 968]], dtype=object), 'd1': 321.0}]]`

我想要第二个 .py 文件来使用它，但我想让那个文件可移植，所以我不想从磁盘读取这个 .npz 文件。将列表静态写入 python 文件的最佳方法是什么，并给它一些可以在最终脚本中使用的名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T00:43:27.390

您可以序列化列表对象并嵌入字符串：

```
import pickle

lst = [[ {'d3': 936.0, 'd2': 1041.0, 'd4': 495.0} ]]

print 'pickle_string = """'+ pickle.dumps(lst) +'"""' 
```

输出：

```
pickle_string = """(lp0
(lp1
(dp2
S'd4'
p3
F495.0
sS'd2'
p4
F1041.0
sS'd3'
p5
F936.0
saa.""" 
```

解压：

```
lst = pickle.loads(pickle_string) 
```

# python - 用python处理远程服务器文件夹中的所有excel文件

> ID：14205181
> 
> 赞同：0
> 
> 时间：2013-01-07T22:26:48.307
> 
> 标签：python, directory, xlrd

我需要编写一个程序来处理Python远程服务器文件夹中的所有excel文件。要在我的计算机上处​​理一个 excel 文件，我使用

```
from xlrd import open_workbook
book = open_workbook( filename) 
```

然后处理`book` 但是，我不知道如何在远程服务器上获取 excel 文件进行处理。请帮帮我。如果可能，请告诉我如何获取远程服务器文件夹中的所有 excel 文件。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T02:05:15.630

```
import os

excelfiles = []

for cwd, folders, files in os.walk(starting_directory):  # For file in starting_directory
    for filename in files:
        path = os.path.join(cwd, filename)
        if os.path.splitext(path)[1].lower() == '.xls':  # If the file ends in '.xls'
            excelfiles.append(path)

for spreadsheet in excelfiles:
    process_spreadsheet(spreadsheet) 
```

# spring - Spring 缓存与缓存管理器

> ID：14205185
> 
> 赞同：9
> 
> 时间：2013-01-07T22:27:02.457
> 
> 标签：spring, ehcache

[Spring手册](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/cache.html#cache-store-configuration-ehcache)中的以下示例使我感到困惑。

```
<bean id="cacheManager" 
      class="org.springframework.cache.ehcache.EhCacheCacheManager"
      p:cache-manager-ref="ehcache"/>

<!-- Ehcache library setup -->
<bean id="ehcache" 
      class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean" 
      p:config-location="ehcache.xml"/> 
```

命名约定要求`EhCacheManagerFactoryBean`产生一个缓存*管理器*，更准确地说它是一个`net.sf.ehcache.CacheManager`实例。然而，bean 被称为`ehcache`not `ehcachemanager`。然而，实际的`cacheManager`bean 引用了这个 bean。

在散文中，您可以说一个是 Ehcache 缓存管理器，而另一个是 Spring 缓存管理器（由前者支持）。

如果你使用它会变得更糟`EhCacheFactoryBean`：

```
<bean
  id="myCache"
  class="org.springframework.cache.ehcache.EhCacheFactoryBean">
  <property name="cacheManager">
    <ref local="ehcache" />
  </property> 
```

有一个名为的属性`cacheManager`引用了一个名为`ehcache`.

我是不是误会了什么，还是真的那么令人困惑？示例中的糟糕设计或只是糟糕的命名？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T22:35:28.510

Spring 框架最近引入了具有中央接口的[缓存抽象。](http://static.springsource.org/spring/docs/3.1.0.RELEASE/spring-framework-reference/html/cache.html)[`org.springframework.cache.CacheManager`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/cache/CacheManager.html)该接口几乎没有内置实现，包括：

*   `ConcurrentMapCacheManager`
*   [`EhCacheCacheManager`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/cache/ehcache/EhCacheCacheManager.html)
*   `NoOpCacheManager`
*   `SimpleCacheManager`

这种设计允许您在不接触应用程序代码的情况下切换缓存库。如您所见，这些内置实现之一由 EhCache 支持。但是请注意，这`EhCacheCacheManager`只是 Spring 缓存抽象和 EhCache 库之间的桥梁。因此它需要现有的[`net.sf.ehcache.CacheManager`](http://ehcache.org/apidocs/net/sf/ehcache/CacheManager.html). 您可以自己创建此缓存管理器的实例，也可以利用现有的工厂 bean，即[`EhCacheManagerFactoryBean`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/cache/ehcache/EhCacheManagerFactoryBean.html).

我知道由于名称重叠而令人困惑，但是从上面应该清楚哪些类来自哪个库以及为什么使用它们。

# php - Yii 使用自定义字段选择

> ID：14205195
> 
> 赞同：0
> 
> 时间：2013-01-07T22:27:46.500
> 
> 标签：php, mysql, yii

我尝试使用自定义字段创建另一个自定义字段，但出现错误。我创建了该示例代码以便于理解。

模型.php：

```
public custom1;
public custom2; 
```

示例代码：

```
...
$criteria->select=array("'custom1' AS custom1, CONCAT('variable: ', custom1) AS custom2");
... 
```

错误：

```
SQLSTATE[42S22]: Column not found: 1054 Unknown column 'custom1' in 'field list'. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T06:39:19.020

好吧，因为你在 select 中使用了函数，所以它必须与 CDbExpression 一起使用：

```
$criteria->select = array(
  new CDbExpression('custom as custom1'),
  new CDbExpression('CONCAT("variable: ", custom) AS custom2'),
); 
```

# node.js - 多个并发静态托管上下文

> ID：14205198
> 
> 赞同：1
> 
> 时间：2013-01-07T22:28:03.350
> 
> 标签：node.js

如果我有一个如下所示的项目目录：

```
/
    custom_assets
        File1.txt
    generic_assets
        File2.txt 
```

是否有一个节点 http 服务器实现可以让我从同一个根 url 托管两个目录？

例如：

```
http://localhost/File1.txt 
```

或者

```
http://localhost/File2.txt 
```

几乎就像两个目录合并了一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:42:34.233

[ExpressJS](http://expressjs.com/)是一个流行的节点 Web 应用程序框架，可以做到这一点。使用两个静态[中间件](http://expressjs.com/api.html#middleware)应该可以解决问题。

您的代码应如下所示：

```
app.use(express.static(__dirname + '/custom_assets'));
app.use(express.static(__dirname + '/generic_assets')); 
```

# c - 防止 C 程序被 ctrl-c 杀死

> ID：14205200
> 
> 赞同：0
> 
> 时间：2013-01-07T22:28:10.117
> 
> 标签：c

> **可能重复：**
> [Catch Ctrl-C in C](https://stackoverflow.com/questions/4217037/catch-ctrl-c-in-c)

我正在编写一个 C 命令行程序并试图确保 ctrl-c 不会杀死它。关于我如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T22:29:58.683

当您在程序运行时按下 Ctrl-C 时，下面发生的事情是您的进程收到一个名为 SIGINT 的信号，当进程收到此信号时的默认操作是终止自身。
所以你的目标应该是修改这种行为：
使用该函数`signal`来捕获当 ctrl-c 时发送到你的进程的信号

你应该这样做：

```
signal(SIGINT, handler_function);//handler_function is a void returning function that takes one int paramter, you can do nothing there if you just want to prevent your process from terminating. 
```

PS 这里是[手册页](http://linux.die.net/man/2/signal)以获取更多信息：D
PPS 如果您不熟悉什么是信号，请参阅[此 wikipedia 页面](http://en.wikipedia.org/wiki/Signal_%28computing%29)，如果您发现那里有什么令人困惑的地方，请告诉我们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-07T22:29:11.520

> 关于我如何做到这一点的任何想法

忽略`SIGINT`使用 SIG_IGN 处置或在无操作处理程序中捕获它。在某些实现中，甚至还有一个`sigignore`函数。

无论如何，你应该没问题：

```
signal(SIGINT, SIG_IGN); 
```

`SIG_IGN`在 C11-7.14 中指定，因此它具有可移植性。

# javascript - 如何将 onmousedown 事件绘制为存储在数组某个索引处的值，而不是整个数组调用？

> ID：14205202
> 
> 赞同：0
> 
> 时间：2013-01-07T22:28:17.890
> 
> 标签：javascript, jquery, html, ajax, json

对不起，如果问题标题有点令人困惑，但我不确定如何准确表达我的问题。

我有以下同步 ajax 调用（其目的是获取 json 文件内容）。

```
$.ajax({
    url: "/JsonControl/Events.json",
    dataType: 'json',
    async: false,
    success: function(jsonObj) 
    {
        for (var i = 0; i < jsonObj.events.length; ++i) 
        {
            if(day == jsonObj.events[i].dateNumber && (navDate.getMonth() + monthAdjust) == (jsonObj.events[i].dateMonth -1) && navDate.getFullYear() == jsonObj.events[i].dateYear)
            {
                document.getElementById("cGrid" + gridMod).className="eventDay";
                document.getElementById("cGrid" + gridMod).onmousedown = function(){document.getElementById("eventBox").src="/Event htms/Event.htm"; document.getElementById("eventBox").document.getElementById("title").innerHTML = (jsonObj.events[i].title);}
                document.getElementById("cGrid" + gridMod).style.backgroundColor = "#336633";
                isAnEvent = true;
            }
        }
    }
}); 
```

我遇到的问题是以下行（第 12 行，如果 '$.ajax({' 是第 1 行）：

```
document.getElementById("cGrid" + gridMod).onmousedown = function(){document.getElementById("eventBox").src="/Event htms/Event.htm"; document.getElementById("eventBox").document.getElementById("title").innerHTML = (jsonObj.events[i].title);} 
```

有人告诉我我需要关闭，但我无法对我见过的任何示例做出正面或反面，因为我从未见过以这种方式设置的语法，而且我尝试过的示例不起作用（我会详细说明“不工作”的含义）。

这就是我所尝试的（我用这一行替换了上面提到的相关行，如下所示）。

```
(function(index) {
                document.getElementById("cGrid" + gridMod).onmousedown = function(){document.getElementById("eventBox").src="/Event htms/Event.htm"; document.getElementById("eventBox").document.getElementById("title").innerHTML = jsonObj.events[index].title;}
            })(i); 
```

我得到的错误是这样的：

```
Uncaught TypeError: Cannot call method 'getElementById' of undefined 
```

我在原始问题行以及替换行中遇到此错误，如上所示。

我发现这个自动执行功能的东西很新，所以我不知道如何进行。

任何关于如何绘制 jsonObj.events[i].title 在访问时的实际值而不是字面上绘制 'jsonObj.events[i].title' 的建议将不胜感激。

我也尝试过（猜测，就像我一样） valueOf 方法，但快速研究表明它只是返回布尔值的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:33:02.240

问题是因为 mousedown 事件总是会使用 for 循环中的最后一个索引，您需要使用函数包装 for 循环以确保其值得到正确维护。

```
for (var i = 0; i < jsonObj.events.length; ++i) (function(i){
 ....stuff here

})(i) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T23:03:56.027

将循环内代码（[由 Justin 建议](https://stackoverflow.com/a/14205273/1615483)）与移动到[`.contentDocument`](https://developer.mozilla.org/en-US/docs/HTML/Element/iframe#Scripting)for`<iframe>`内容相结合，以及其他一些更改。

请参阅代码中的注释或在下面询问以了解正在发生的事情。（我假设*#eventBox*是一个`<iframe>`）

```
function (jsonObj) {
    for (var i = 0; i < jsonObj.events.length; ++i) (function (i) { // `i` inside function is protected from outside changes
        var cGridMod; // holder to reduce lookups
        if (day == jsonObj.events[i].dateNumber
          && (navDate.getMonth() + monthAdjust) == (jsonObj.events[i].dateMonth -1)
          && navDate.getFullYear() == jsonObj.events[i].dateYear) {
            cGridMod = document.getElementById("cGrid" + gridMod);
            cGridMod.className="eventDay";
            cGridMod.onmousedown = function () {
                var eventBox = document.getElementById("eventBox"); // holder to reduce lookups
                eventBox.onload = function () { // set an onload listener so #document exists at time of execution
                    eventBox.onload = null; // unset it so it only fires once
                    eventBox.contentDocument.getElementById("title").innerHTML = (jsonObj.events[i].title);
                      // using `.contentDocument` to get <iframe> document
                };
                eventBox.src="/Event htms/Event.htm";
                  // now set location (done after so onload will fire when loaded)
            };
            cGridMod.style.backgroundColor = "#336633";
            isAnEvent = true;
        }
    }(i)); // invoke the function for this iteration of the loop; `i`
} 
```

# ios - RestKit：POST 反序列化 - 期望 A 类的对象映射，提供者为 B 返回一个

> ID：14205205
> 
> 赞同：2
> 
> 时间：2013-01-07T22:28:22.750
> 
> 标签：ios, restkit

这是我的路由设置：

```
[manager.router.routeSet addRoute:[RKRoute routeWithClass:[UserProfile class]  pathPattern:@"/api/v1/users" method:RKRequestMethodPOST]];
[manager.router.routeSet addRoute:[RKRoute routeWithClass:[UserProfileAndStatistics class]  pathPattern:@"/api/v1/profile/:userId" method:RKRequestMethodGET]];
[manager.router.routeSet addRoute:[RKRoute routeWithClass:[PrivateUserProfile class] pathPattern:@"/api/v1/privateprofile/" method:RKRequestMethodGET]];
[manager.router.routeSet addRoute:[RKRoute routeWithClass:[PrivateUserProfile class] pathPattern:@"/api/v1/privateprofile/" method:RKRequestMethodPOST]]; 
```

这是我注册映射的方式：

```
 RKResponseDescriptor *responseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:mapping pathPattern:nil keyPath:nil statusCodes:nil];
    [[RKObjectManager sharedManager] addResponseDescriptor:responseDescriptor];

    //the serialisation step
    RKRequestDescriptor *requestDescriptor = [RKRequestDescriptor requestDescriptorWithMapping:[mapping inverseMapping] objectClass:[mapping objectClass] rootKeyPath:nil];
    [[RKObjectManager sharedManager] addRequestDescriptor:requestDescriptor]; 
```

最后我打电话：

```
[[RKObjectManager sharedManager] postObject:userProfile path:nil parameters:nil success:^(RKObjectRequestOperation *operation, RKMappingResult *result) { ... } 
```

哪个帖子正确，我得到一个 HTTP 状态代码 200，数据进入服务器。这意味着序列化步骤正在工作。当响应回来时，我收到一个错误：

```
Adding mapping error: Expected an object mapping for class of type 'PrivateUserProfile', provider returned one for 'UserProfileAndStatistics' 
```

`PrivateUserProfile`现在和的映射`UserProfileAndStatistics`非常相似

```
RKObjectMapping *mapping = [RKObjectMapping mappingForClass:[PrivateUserProfile class]];
[mapping addAttributeMappingsFromDictionary:@{
 @"UserIdentifier" :   @"userId",
 @"UserName"       :   @"userName",
 @"Name"           :   @"name",
 @"Email"          :   @"emailAddress",
 @"Bio"            :   @"bio",
 @"Website"        :   @"webSite",
 @"Avatar"         :   @"avatar"
 }];

RKObjectMapping *mapping = [RKObjectMapping mappingForClass:[UserProfileAndStatistics class]];
[mapping addAttributeMappingsFromDictionary:@{
 @"UserIdentifier" :   @"userId",
 @"UserName"       :   @"userName",
 @"Name"           :   @"name",
 @"Bio"            :   @"bio",
 @"Website"        :   @"webSite",
 @"Avatar"         :   @"avatar",
 @"Posts"          :   @"posts",
 @"Followers"      :   @"followers",
 @"Following"      :   @"following"
 }]; 
```

但是为什么 RestKit 会选择其中一个呢？如何成功调试？RKRoute 和 RKObjectMapping 有没有关系。PrivateUserProfile 的映射被用于序列化步骤，那么为什么不将它用于对应的反序列化，以及如何使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T22:33:24.203

您需要两个响应描述符 - 一个带有`/api/v1/privateprofile/`类路径，`PrivateUserProfile`另一个带有`/api/v1/profile/:userId`类路径`UserProfileAndStatistics`：

```
[manager addResponseDescriptorsFromArray:@[

 [RKResponseDescriptor responseDescriptorWithMapping:privateUserProfileMapping
                                         pathPattern:@"/api/v1/privateprofile/"
                                             keyPath:nil
                                         statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)],
 [RKResponseDescriptor responseDescriptorWithMapping:userProfileAndStatisticsMapping
                                         pathPattern:@"/api/v1/profile/:userId"
                                             keyPath:nil
                                         statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)]
 ]]; 
```

# java - 飞思卡尔 Symphony Studio 未完成安装

> ID：14205207
> 
> 赞同：1
> 
> 时间：2013-01-07T22:28:24.577
> 
> 标签：java, eclipse

我要疯了。我必须为大学项目安装 Freescale Symphony Studio IDE，但我不能。该程序在 Windows XP 下运行。

我已经安装了 Java，然后我尝试安装 Symphony Studio。安装后的错误是（日志文件的第一部分）：

```
 !SESSION 2012-12-11 14:33:18.671 -----------------------------------------------      
    eclipse.buildId=M20070212-1330 java.version=1.7.0_09 java.vendor=Oracle Corporation                           
    BootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=en_US Command-line arguments: -  
    os win32   -ws win32 -arch x86
    !ENTRY org.eclipse.equinox.common 4 0 2012-12-11 14:33:13.687 !MESSAGE   
    FrameworkEvent.ERROR !STACK 0 org.osgi.framework.BundleException: The bundle could not  
    be resolved. Reason: Missing Constraint: Bundle-RequiredExecutionEnvironment: CDC-  
    1.0/Foundation-1.0,J2SE-1.3 at     
    org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:294)
    at org.eclipse.osgi.framework.internal.core.AbstractBundle.resume(AbstractBundle.java:329)
at org.eclipse.osgi.framework.internal.core.Framework.resumeBundle(Framework.java:1046)
at org.eclipse.osgi.framework.internal.core.StartLevelManager.resumeBundles(StartLevelManager.java:573)
at org.eclipse.osgi.framework.internal.core.StartLevelManager.incFWSL(StartLevelManager.java:495)
at org.eclipse.osgi.framework.internal.core.StartLevelManager.doSetStartLevel(StartLevelManager.java:275)
at org.eclipse.osgi.framework.internal.core.StartLevelManager.dispatchEvent(StartLevelManager.java:455)
at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:189)
at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:291) 
```

......

我不知道我该怎么办。我也写信给飞思卡尔支持，但没有人正确回答我。

我希望我能得到一些帮助，提前谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T11:19:29.020

解决方案是： Symphony Studio 仅适用于 JRE 1.5 所以获取 JRE 1.5 并将其安装到 Symphony Studio 目录中。然后 Symphony 将使用此版本的 JRE。更多信息：http: [//wiki.eclipse.org/FAQ_How_do_I_run_Eclipse%3F](http://wiki.eclipse.org/FAQ_How_do_I_run_Eclipse%3F)

# java - 在 Mule 的 http:outbound 端点中指定多个查询参数

> ID：14205211
> 
> 赞同：1
> 
> 时间：2013-01-07T22:28:47.137
> 
> 标签：java, web-services, jakarta-ee, mule, query-parameters

在我的 Mule-config.xml 中，我使用 2 个查询参数对服务进行了 http 发布...我尝试添加 2 个查询参数，如下所示：

```
<http:outbound-endpoint
           address="http://${server.user}:${server.passwd}@${server.host}:${server.port}/DebtService/debt/sendemail?appId=#[header:SESSION:appId]&debtId=#[header:SESSION:debtId]" 
```

但是骡子在启动时抛出了这个错误

```
Caused by: org.xml.sax.SAXParseException: The reference to entity "debtId" must end with the ';' delimiter. 
```

如果我只有一个查询参数，那么一切正常，但如果我使用 '&' 添加第二个查询参数，则会引发上述错误......

关于我在这里做错了什么的任何想法......提前谢谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T22:30:25.300

这是无效的 XML：使用`&amp;`而不是`&`.

# jboss - 如何在 JBoss AS 7 上远程部署 war 文件？

> ID：14205224
> 
> 赞同：0
> 
> 时间：2013-01-07T22:29:45.770
> 
> 标签：jboss, war

我将如何在 JBoss Application Server 7 上远程部署 war 文件？

我已将 war 文件上传到应用程序服务器并尝试在浏览器中使用： **http://[IP]:9990/[war 文件名]** ，但找不到路径。

IP：服务器IP地址

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T00:12:07.253

您需要使用的 URL 是`http://[IP]:8080/[war file name ]`. 端口 9990 是用于部署 war 文件的管理端口，但默认情况下，应用程序可通过端口 8080 访问。

# java - Ubuntu 中的 Java 拖放

> ID：14205227
> 
> 赞同：1
> 
> 时间：2013-01-07T22:30:02.380
> 
> 标签：java, swing, ubuntu, drag-and-drop, jtable

我想将字符串从 JTable 的单元格拖到浏览器中。

因此我写了这样的东西：

```
 table.setDragEnabled(true);
    table.setTransferHandler(new TransferHandler() {

        @Override
        protected Transferable createTransferable(JComponent c) {
            isDragged = true;
            return new StringSelection(exportString(c));
        }

        @Override
        public int getSourceActions(JComponent c) {
            return TransferHandler.COPY_OR_MOVE;
        }

        @Override
        protected void exportDone(JComponent c, Transferable t, int act) {
            isDragged = false;
        }

        protected String exportString(JComponent c) {
            // return some String
        }
    }); 
```

这在 Windows 和 Mac 下运行良好，但在 Linux (Ubuntu) 下我遇到了一些麻烦：

第一个拖放工作正常，但第二个甚至无法启动！鼠标没有改变，也没有完成拖放。

如果您想要一个示例，您可以简单地运行本教程的 jnlp：http: [//docs.oracle.com/javase/tutorial/uiswing/dnd/dropmodedemo.html](http://docs.oracle.com/javase/tutorial/uiswing/dnd/dropmodedemo.html)并尝试进行两次拖放。

我能做些什么来解决这个问题？此外，在 Linux 下，永远不会调用 exportDone-Method！

顺便说一句：我用 Java 6 和 7 进行了测试，两者的行为都是一样的！

# php - 将多个变量回显到一个 div 类

> ID：14205229
> 
> 赞同：0
> 
> 时间：2013-01-07T22:30:14.527
> 
> 标签：php

我正在尝试回应我所做的 IF 语句中的用户名和问候语。

```
<?php
                global $current_user;
                get_currentuserinfo();
                echo get_avatar( $current_user->ID, 64 );
                $hour = date('G');
                if ($hour < 12) {
                    $greeting = 'Good Morning';
              } else if ($hour < 18) {
                    $greeting = 'Good Evening';
              } else {
                    $greeting = 'Good Night';
        }

    echo '<div class="greeting">'.($greeting). , .$current_user->user_login. '</div>';
?> 
```

但我收到语法错误：

> 语法错误，意外的“，”

如何将 2 个变量回显到一个 div 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:32:37.777

您的逗号应包含在字符串中：

```
echo '<div class="greeting">'.$greeting.' , '.$current_user->user_login. '</div>'; 
```

# php - 过滤和重新索引数组

> ID：14205230
> 
> 赞同：0
> 
> 时间：2013-01-07T22:30:18.017
> 
> 标签：php

我正在尝试过滤和重新索引这个数组。我的原始数组是 $_SESSION['ShowingRequests']。
我试过了

```
array_values(array_filter($_SESSION['ShowingRequests'])) 
```

和

```
array_values(array_filter($_SESSION['ShowingRequests']['ListingKey']))
array_values(array_filter($_SESSION['ShowingRequests']['Key'])) 
```

但它不会到达数组的第二级。我希望它从此开始

```
Array
(
    [ListingKey] => Array
        (
            [1] => 97826889139
            [2] => 97820967049
            [4] => 97825243774
            [5] => 97824864611
        )
    [Key] => Array
        (
            [1] => 2
            [2] => 3
            [4] => 5
            [5] => 6
        )
) 
```

对此

```
Array
(
    [ListingKey] => Array
        (
            [0] => 97826889139
            [1] => 97820967049
            [2] => 97825243774
            [3] => 97824864611
        )
    [Key] => Array
        (
            [0] => 2
            [1] => 3
            [2] => 5
            [3] => 6
        )
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T22:38:47.307

PHP 数组没有索引，因为它们不是真正的数组。它们实际上是有序的哈希图，因此您不应该真正关心这里的键。遍历这些数组很简单，根本不需要使用`array_values`。

```
foreach ($_SESSION['ShowingRequests']['ListingKey'] as $key => $value) {
    echo "$key => $value\n";
} 
```

会给你...

```
 1 => 97826889139
        2 => 97820967049
        4 => 97825243774
        5 => 97824864611 
```

[使用foreach](http://php.net/foreach)构造获取数组中每个元素的键名和值。

在任何情况下，您都必须记住，[array_values](http://php.net/array-values)和[array_filter](http://php.net/array-filter)都是非破坏性函数。他们返回一个新数组。它们不会通过引用来修改数组。因此，如果要修改现有数组，则必须分配返回值。它们也不递归地工作。

```
$_SESSION['ShowingRequests']['ListingKey'] = array_values(array_filter($_SESSION['ShowingRequests']['ListingKey']));
$_SESSION['ShowingRequests']['Key'] = array_values(array_filter($_SESSION['ShowingRequests']['Key']));
$_SESSION['ShowingRequests'] = array_values(array_filter($_SESSION['ShowingRequests'])); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T22:34:09.010

您的问题是将过滤后的值分配回同一个键吗？

```
foreach (['ListingKey', 'Key'] as $key) 
{
    $_SESSION['ShowingRequests'][$key] = array_values(
        array_filter($_SESSION['ShowingRequests'][$key])
    );
} 
```

这里有一些演示它是如何与辅助函数一起工作的，只是为了让它更*明显*

```
function array_filter_values($var) {
    return array_values(array_filter($var));
}

foreach (['ListingKey', 'Key'] as $key) 
{
    $_SESSION['ShowingRequests'][$key] = 
        array_filter_values($_SESSION['ShowingRequests'][$key])
    ;
} 
```

这是一个没有该辅助函数但有一个别名的示例，我认为它可能会使它更容易理解，但显然不是：

```
foreach (['ListingKey', 'Key'] as $key) 
{
    $var = &$_SESSION['ShowingRequests'][$key];
    $var = array_values(array_filter($var));
    unset($var);
} 
```

此示例代码使用您要更改的变量的*别名*（这里是您要更改的数组部分）。这可能使它更容易看到它是如何工作的。因为它是一个别名，`unset`是用来去除别名的，它不应该在下一次迭代或迭代完成后重新使用。

# python - GTK+3：如何以 NORMAL 小部件的样式呈现 INSENSITIVE 小部件

> ID：14205238
> 
> 赞同：2
> 
> 时间：2013-01-07T22:30:41.343
> 
> 标签：python, gtk3

抱歉，如果这是转发，我只是无法在任何地方找到答案。我正在用 Python 和 GTK+3 开发一个应用程序，它的 TreeView 设置为 INSENSITIVE。这禁止我们的用户在常量表上进行直接选择。然而，INSENSITIVE GTK+3 小部件的默认行为是为不敏感的对象着色。在大多数情况下，这是一个很好的行为，但在我的情况下，我需要我的表格保持清晰易读。

我想做的是能够覆盖这个特定的 INSENSITIVE 对象的渲染以匹配 NORMAL 对象的渲染。然后，如果用户更改 GTK 主题，这个特定的 INSENSITIVE 小部件将像普通小部件一样呈现。

我附上了一些简单的代码来说明我的观点......

```
import gi.repository.Gtk as Gtk
import gi.repository.Gdk as Gdk

class Example(Gtk.Window):

    def __init__(self):
        """A minimal example of the rendering of a INSENSITIVE widget"""

        # Use Gtk.Window __init__ method
        Gtk.Window.__init__(self)

        # Add a box
        self.set_title("Example1")
        self.box = Gtk.Box()
        self.add( self.box )

        # Entry widget
        self.entry = Gtk.Entry()
        self.entry.set_text("Can't touch this")
        self.entry.set_sensitive( False )
        self.box.pack_start(self.entry, True, True, 0)

class Example2(Example):

    def __init__(self):
        """Forced recoloring of the INSENSITIVE widget.  How do I do
        this so that it matches the GTK 3+ style for normal text?
        """

        # Use Example __init__ method
        Example.__init__(self)
        self.set_title("Example2")

        # Hack the color
        self.entry.override_color(
            Gtk.StateFlags.INSENSITIVE,
            Gdk.RGBA(0,0,0,1)
            )

        self.entry.override_background_color(
            Gtk.StateFlags.INSENSITIVE,
            Gdk.RGBA(1,1,1,1)
            )

if __name__ == "__main__":

    # Example 1
    Window1 = Example()
    Window1.connect("delete-event", Gtk.main_quit)
    Window1.show_all()

    # Example 2
    Window2 = Example2()
    Window2.show_all()
    Gtk.main() 
```

这里我覆盖了 Example2 的着色。如何以始终匹配 GTK 主题的方式覆盖它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:48:48.253

[您可以从它的GtkStyleContext](http://developer.gnome.org/gtk3/3.0/GtkStyleContext.html)访问一个小部件的样式属性，您可以通过调用`get_style_context`任何小部件的方法来获得它。通过上下文的实例，您可以使用相应的[GtkStateFlag](http://developer.gnome.org/gtk3/3.0/gtk3-Standard-Enumerations.html#GtkStateFlags)访问不同的样式属性。

下面是一个示例，说明如何在小部件处于打开`NORMAL`状态时获取小部件的背景颜色：

```
from gi.repository import Gtk

def get_background_color(widget):
    context = widget.get_style_context()
    color = context.get_background_color(Gtk.StateFlags.NORMAL)

    return color # the result is a GdkRGBA instance 
```

我不完全确定你应该怎么做才能完全覆盖`INSENSITIVE`状态的样式，但我猜你应该使用[GtkStyleProvider](http://developer.gnome.org/gtk3/3.0/GtkStyleProvider.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T09:28:04.007

您为什么不尝试另一种方法，例如`treeview.props.reorderable = False`将所有单元格渲染器模式设置为`INERT`?

# php - 在 PHP 类中设置会话

> ID：14205240
> 
> 赞同：3
> 
> 时间：2013-01-07T22:30:49.057
> 
> 标签：php, class, session

我正在创建一个用户类来处理我的登录。由于我希望在验证用户名和密码后在类内设置会话，我是否必须在类的顶部使用 session_start() ，在要设置会话的公共函数内，或者实例在哪里创建？也许它可以进入函数_construct()？

这就是我想调用类的方式：

```
<php

include('user_class.php');
$user = new user;
$user->login($username,$password);

?> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T22:34:53.977

您可以添加 session_start(); 在您要包含该类的文件的顶部。

所以

```
<?php
  session_start();
  include('user_class.php');
  $user = new user;
  $user->login($username,$password);
?> 
```

会工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-07T22:39:18.950

在您的用户类旁边，也为您自己创建一个会话类。

然后用户类只是将自己存储到会话类中，不需要关心是否调用`session_start`，这是会话类的工作。

```
<php

include('session_class.php');
include('user_class.php');

$session = new session;

if ($session->hasRegisteredUser()) {
    $user = $session->getRegisteredUser();
} else {
    $user = new user;        
    $user->login($username, $password);
    $session->setRegisteredUser($user);
} 
```

这是否回答了您的问题，还是您现在需要知道如何使用会话课程来解决问题？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-12-27T16:23:48.293

是的，您可以在类中使用会话，因为会话是 php 中的全局变量。

代码示例（添加一个新的会话变量）：

```
<?php
    class sessionControle{
        ...
        ...
        public function addSession($index, $value){
            $_SESSION[$index] = $value;
            return $_SESSION[$index];
        }
    }
?> 
```

在您的主 php 文件中，您可以在主文件中包含函数`$_SESSIONS`是**全局** 代码：

```
<?php
    session_start();
    include_once("myClass.php");
    $Se = new sessionControle;
    echo $Se->addSession('User', 'Crx');

    //Double check here !!
    echo $_SESSION['User'];
?> 
```

输出：`Crx`

# ruby-on-rails - 使用 bcrypt 密码字段移动数据库

> ID：14205243
> 
> 赞同：-1
> 
> 时间：2013-01-07T22:30:57.470
> 
> 标签：ruby-on-rails, database, bcrypt

我有一个在heroku 运行的postgres 数据库。在数据库中，我使用 bcrypt 存储密码。该应用程序是使用自定义授权的 Ruby on Rails 3 应用程序。授权使用 rails 方法 has_secure_password 作为密码。

我计划将我的应用程序移至 VPS。

移动数据库后，我所有的用户密码是否仍然有效？我问这个是因为我不确定密码是如何加盐的。用于加密密码的方法是否以任何方式与数据库服务器无关？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:45:37.920

来源 - [bcrypt-ruby](http://bcrypt-ruby.rubyforge.org/)

> “哈希算法获取大量数据（例如，您的用户密码）并创建一个“数字指纹”或哈希值。因为这个过程是不可逆的，所以没有办法从哈希值返回密码。

假设您将密码哈希和盐存储为字符串，那么您将能够将其存储在任何数据存储中。看看 db/schema，你可能会发现你正在这样做。

# javascript - 自定义 JavaScript 日志功能

> ID：14205244
> 
> 赞同：2
> 
> 时间：2013-01-07T22:31:00.617
> 
> 标签：javascript

我在生产代码中遇到了一些问题，我希望能够发送一个标志来启用/禁用 JS 日志记录，所以我想编写自己的日志记录函数。

我想使用类似的东西`function log(){...}`。当我在 JS 中查找[保留字时，](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDcQFjAA&url=https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Reserved_Words&ei=NkvrUPnJJ4iU2wXmqYG4CA&usg=AFQjCNHsPuXuhYKEPqjMeG_ItOsvVTY4bA&sig2=bWNcRABSMxEvLdZabE54vw&bvm=bv.1355534169,d.b2I)我没有看到列出的日志，但我确实看到它在 w3schools 文档中列为[数学函数](http://www.w3schools.com/jsref/jsref_log.asp)。

可以在 IE 7+、Chrome 和 FF 的生产代码中使用 log() 作为函数名吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:32:50.467

是的，这绝对没问题。数学`log`函数是`Math`对象上的函数，因此不会与您的实现发生冲突。

如果您对这类事情感到困惑，请查看 JavaScript 的“命名空间”

[如何在 JavaScript 中声明命名空间？](https://stackoverflow.com/questions/881515/javascript-namespace-declaration)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T22:33:04.077

是的，没关系。数学`log`函数可用作`Math.log`，`log`因此您不会破坏任何东西...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T22:33:19.977

那应该没问题。数学`log`函数通过 调用`Math.log(x)`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T22:33:22.567

是的，没关系。数学日志函数始终需要调用为`Math.log()`. 所以你没事。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-07T22:35:09.190

我建议使用现有的对象或命名空间，而不是让你的日志函数成为全局的。

见[http://www.yuiblog.com/blog/2006/06/01/global-domination/](http://www.yuiblog.com/blog/2006/06/01/global-domination/)

# batch-file - 查找字符串，如果没有找到，不要附加到文件中

> ID：14205249
> 
> 赞同：0
> 
> 时间：2013-01-07T22:31:32.953
> 
> 标签：batch-file

使用批处理处理大量数据文件。文件名是从以前的批处理文件传递的。我正在尝试从文件中删除数据，并根据每行上的字符串将其附加到其他四个文件中。有时文件不会包含所有 4 个前缀，我不想创建一个空白的输出文件（它会在以后搞砸数据处理）。我宁愿提出一个条件，如果`"A%file1%"`找不到，不要附加。而不是最后删除空白文件。

```
find <%1 "A%file1%," >>A%file%.dat
find <%1 "B%file1%," >>B%file%.dat
find <%1 "C%file1%" >>C%file%.dat 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:02:04.413

如果未找到字符串，FIND 命令返回错误级别 1，否则返回 0。您可以在 find 命令之后使用此值来删除空文件：

```
find <%1 "A%file1%," >>A%file%.dat
if %errorlevel% equ 1 del A%file%.dat 
```

# ruby-on-rails - Rails 中没有路由匹配

> ID：14205250
> 
> 赞同：0
> 
> 时间：2013-01-07T22:31:35.457
> 
> 标签：ruby-on-rails, mongoid

我在嵌套资源路由中收到以下错误：

```
No route matches [PUT] "/admin/cities/50eb48e38bffa6daca000001/areas/50eb48ec8bffa6daca000002/edit" 
```

我的编辑表单代码如下所示：

```
<%= form_for(@area, url: edit_city_area_path(params[:city_id], @area.id) ) do |f| %> 
```

# linux - 缓冲区溢出不运行

> ID：14205262
> 
> 赞同：3
> 
> 时间：2013-01-07T22:32:21.043
> 
> 标签：linux, gcc, gdb, buffer-overflow

我尝试了一个基本的缓冲区溢出，我覆盖了堆栈上保存的 EIP 并跳转到地址。这个地址指向一个包含我的 shellcode 的 shell 变量。

但是在 gdb 上，在 nopslide 的第一个 nop 上编程 sigserv。

我像这个命令一样启动程序：

```
gdb-peda$ r $(python -c 'print "A"*22 + "\x5f\xb8\xff\xff"') 
```

我有这个痕迹：

```
[----------------------------------registers-----------------------------------]
EAX: 0x1a 
EBX: 0xf7fc3ff4 --> 0x15dd7c 
ECX: 0xffffaf38 --> 0xf7fc44e0 --> 0xfbad2a84 
EDX: 0xf7fc5360 --> 0x0 
ESI: 0x0 
EDI: 0x0 
EBP: 0x41414141 ('AAAA')
ESP: 0xffffaf80 --> 0xffffb100 --> 0xc ('\x0c')
EIP: 0xffffb85f --> 0x90909090
EFLAGS: 0x10296 (carry PARITY ADJUST zero SIGN trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0xffffb85c:  nop
   0xffffb85d:  nop
   0xffffb85e:  nop
=> 0xffffb85f:  nop
   0xffffb860:  nop
   0xffffb861:  nop
   0xffffb862:  nop
   0xffffb863:  nop
[------------------------------------stack-------------------------------------]
0000| 0xffffaf80 --> 0xffffb100 --> 0xc ('\x0c')
0004| 0xffffaf84 --> 0xf7fef060 (push   ebp)
0008| 0xffffaf88 --> 0x80484bb (<__libc_csu_init+11>:   add    ebx,0x1219)
0012| 0xffffaf8c --> 0xf7fc3ff4 --> 0x15dd7c 
0016| 0xffffaf90 --> 0x80484b0 (<__libc_csu_init>:  push   ebp)
0020| 0xffffaf94 --> 0x0 
0024| 0xffffaf98 --> 0xffffb018 --> 0x0 
0028| 0xffffaf9c --> 0xf7e7ce46 (<__libc_start_main+230>:   mov    DWORD PTR [esp],eax)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0xffffb85f in ?? ()
gdb-peda$ x/i $eip
=> 0xffffb85f:  nop 
```

我在 debian wheezy 上运行，gcc 版本是 gcc (Debian 4.7.2-4) 4.7.2，gdb 版本是 7.4.1-debian。

这个 gcc 版本有新的保护吗？还是其他想法？

谢谢。（对不起我的英语不好 ：））

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:40:35.717

您可以按照以下任何步骤删除堆栈保护：

[学生缓冲区溢出图解（linux、C）](https://stackoverflow.com/questions/2649089/illustration-of-buffer-overflows-for-students-linux-c)

# php - PHP MongoDB->插入 - utf8 的致命错误

> ID：14205265
> 
> 赞同：5
> 
> 时间：2013-01-07T22:32:40.057
> 
> 标签：php, mongodb

一个恼人的编码错误担心 mongoDB 插入中的新数据集并在出现编码问题时停止我的脚本？

```
 PHP Fatal error: Uncaught exception 'MongoException' with message 'non-utf8 string: ü' 
```

如何在 PHP 驱动程序中断之前修复新数据集？

有没有比 utf8_encode 任何字符串数据更好的主意，即使是那些已经是 utf8 的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-08-18T12:36:09.040

有同样的问题。这有效：

```
$string = mb_convert_encoding($string, 'ISO-8859-1', 'UTF-8'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T22:34:52.863

`utf8_encode()`（[http://php.net/manual/en/function.utf8-encode.php](http://php.net/manual/en/function.utf8-encode.php)）因为我认为默认的 PHP 编码仍然不是 utf8 （不确定 PHP 5.4）。

# objective-c - Objective-C 为多个服务使用委托方法

> ID：14205270
> 
> 赞同：0
> 
> 时间：2013-01-07T22:32:50.787
> 
> 标签：objective-c, cocoa, delegates

我在使用代表时遇到问题。我有一个提供一些服务的对象。现在这些服务需要另一个（异步）服务（另一个对象提供）。因此，两个不同的服务需要相同的（第三个）服务。这两个调用需要在第三个服务的委托方法中进行不同的处理。我怎么做？有没有设计模式呢？

我只需创建一些 ServiceHandlerObject 并将其注册为第三个服务委托。然后只需使用不同的 ServiceHandlerObject 为每个服务提供。但我不知道这是否是“你这样做的方式”。

# python - Python Pyramid - 带有 shash (/) 的 URL 调度和遍历问题

> ID：14205277
> 
> 赞同：1
> 
> 时间：2013-01-07T22:33:18.970
> 
> 标签：python, url, pyramid, traversal

我有一个关于 URL Dispatch 或 Traversal 的初学者问题。我想做的是使用 Mako 渲染器来渲染我的视图。所以我有这个文件夹/includes/，所有的html、css和javascript都在其中。这是我的金字塔主要代码：

```
from pyramid.config import Configurator

def main(global_config, **settings):
    config = Configurator(settings=settings)
    config.add_static_view('includes', 'includes', cache_max_age=3600)
    config.add_renderer(".html", "pyramid.mako_templating.renderer_factory")  
    config.add_route('home', '/')
    config.scan()
    return config.make_wsgi_app() 
```

这些是我的观点：

```
@view_config(route_name='home', renderer='index.html')
def my_view(request):
    return {'name':'Netherdrake'}

@view_config(name = 'login', renderer='login.html')
def login(request):
    return {'name':'Netherdrake'} 
```

问题是，当我访问 ip:port/login 时，站点工作正常，但是当我尝试 ip:port/login/ 时，css、javascript 和图像不起作用。原因是，我的绝对路径变得无效。

这是我在没有 / 的情况下登录时的 login.html 片段（实际上是 mako 模板）：

```
 <link href="includes/css/twitter/bootstrap.css" rel="stylesheet">
  <link href="includes/css/base.css" rel="stylesheet">
  <link href="includes/css/twitter/responsive.css" rel="stylesheet">
  <link href="includes/css/jquery-ui-1.8.23.custom.css" rel="stylesheet">
  <script src="includes/js/plugins/modernizr.custom.32549.js"></script> 
```

在这里，我正在登录/路径（在这种情况下站点已损坏，没有 css、图像、js ......）：

```
 <link href="includes/css/twitter/bootstrap.css" rel="stylesheet">
  <link href="includes/css/base.css" rel="stylesheet">
  <link href="includes/css/twitter/responsive.css" rel="stylesheet">
  <link href="includes/css/jquery-ui-1.8.23.custom.css" rel="stylesheet">
  <script src="includes/js/plugins/modernizr.custom.32549.js"></script> 
```

login.html 也在 /includes 中。

我该如何解决这个问题，并让它在两条路径下工作，有和没有斜线？我尝试了遍历和 url 调度，两者的问题都是一样的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T23:40:13.587

你所有的hrefs都应该以一个斜杠开头。

# c# - SetEntitySetAccessRule 变量设置

> ID：14205282
> 
> 赞同：0
> 
> 时间：2013-01-07T22:33:30.897
> 
> 标签：c#, wcf, visual-studio, database-connection

我无法想象这是一个新问题，但我没有找到有关此问题的任何答案。

为 C# 项目使用 WCF 和 VS 生成的数据对象，此问题围绕`SetEntitySetAccessRule()`（如您所知）设置数据库中每个表的访问权限的方法。每个需要交互的表都必须在`InitializeService()`每个 WCF 数据库实现调用的方法中调用此方法。然后将这些规则集发布到 Web 服务器（由 MS 2008 R2 和 IIS 7.5 托管），这就是我们的门户。

假设我们有两个表： `Orders`和`Customers`. `Orders`可以设置为只写，`Customers`也可以设置为只读。该模型运行良好，直到...您想向客户添加一行；中设置的只读权限`SetEntitySetAccessRule()`将阻止任何写入`Customers`表的尝试（包括使用 VS 接口时。）

有没有办法使在`InitializeService`某种变量中声明的表的权限依赖？或者我们是否需要允许`Customers`表是可写的，因为我们需要偶尔修改表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T11:00:54.920

我相信您可以将权限设置为*All*然后将*[更改拦截器](http://msdn.microsoft.com/en-us/library/dd744842%28v=vs.100%29.aspx)*应用于需要特殊处理的表。您可以在此处根据您的业务规则取消请求。[您可以在http://mattfrear.com/2011/02/25/inserting-odata/](http://mattfrear.com/2011/02/25/inserting-odata/)
上查看更多信息

# ruby-on-rails-3 - 如何使用omniauth 自动为我的用户分配额外的参数？

> ID：14205287
> 
> 赞同：1
> 
> 时间：2013-01-07T22:34:04.267
> 
> 标签：ruby-on-rails-3, authentication, omniauth

我拥有omniauth 并成功地为LinkedIn 和Twitter 设计了设置。

使用LinkedIn进行身份验证时，我能够自动将用户名和电子邮件传递到注册表单中-但它仍然给出错误并要求用户“检查错误”，这在技术上是错误的用户体验没有错误。

如何在创建过程中将它们自动分配给用户，但只有当它们存在时？以下是相关代码：

```
 class OmniauthCallbacksController < Devise::OmniauthCallbacksController

  def all
    user = User.from_omniauth(request.env["omniauth.auth"])
        if user.persisted?
        flash.notice = "Signed in!"
        sign_in_and_redirect user
        else
        session["devise.user_attributes"] = user.attributes
        flash.notice = "Please confirm your name and email"
        redirect_to sign_up_path
        end
  end
    alias_method :linkedin, :all
    alias_method :twitter, :all

end 
```

从用户模型：

```
 def self.from_omniauth(auth)
    where(auth.slice(:provider, :uid)).first_or_create do |user|
      user.provider = auth.provider
      user.uid = auth.uid
      user.name = auth.info.name
      user.email = auth.info.email
    end
  end 
```

# koala - 考拉测试用户 create_network

> ID：14205289
> 
> 赞同：0
> 
> 时间：2013-01-07T22:34:14.437
> 
> 标签：koala

根据考拉维基（[https://github.com/arsduo/koala/wiki/Test-Users](https://github.com/arsduo/koala/wiki/Test-Users)），使用“create_network”方法创建朋友网络非常简单

所示示例：@test_users.create_network(10, installed_status, permissions) => hash_of_10_users

如果我能做到这一点并暂时避免使用 Graph API，那就太好了。我尝试通过命令@test_users.create_network(3, false, "") 使用这种方法（通过irb，在发送秘密和appid 之后）

控制台返回消息：TestUsers#befriend requires hash arguments for both users with id and access_token

我忽略了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:47:01.993

好的，此方法仅在“installed_status”= true 时有效。

[这在http://www.ruby-doc.org/gems/docs/k/koala-1.4.0/Koala/Facebook/TestUsers.html](http://www.ruby-doc.org/gems/docs/k/koala-1.4.0/Koala/Facebook/TestUsers.html)中被引用， 我通过自己的实验证实了这一点，我将尝试添加该评论到维基。

# eclipse - Eclipse中的关键字加粗使列不对齐

> ID：14205291
> 
> 赞同：1
> 
> 时间：2013-01-07T22:34:20.683
> 
> 标签：eclipse, fonts

我一直在 Eclipse 中使用 Inconsolata 字体。我最近的硬盘出现故障，所以我不得不重新安装所有东西。我现在意识到 Eclipse 中的列没有对齐，因为当 Eclipse 将某些关键字加粗时，它会使它们比非粗体版本更宽。我想我之前会注意到这一点，所以它一定是我重新安装所有东西时如何设置它的一些人工制品。

我需要做什么才能使字体真正不成比例，因此粗体文本与非粗体文本占用相同的空间？

# slickedit - 需要在 Slick-C 中创建宏以重新枚举

> ID：14205293
> 
> 赞同：0
> 
> 时间：2013-01-07T22:34:35.480
> 
> 标签：slickedit

我在一个名为 blah_blah_blah_blah_number 的 XML 文件中有一堆测试用例

测试用例的数字都搞砸了，例如：

```
blah_3
blah_1
blah_7
.... 
```

我需要重新编号。这样第一个被重新编号为 1，第二个被重新编号为 2.. 等等。我想为此构建一个宏，但我不知道如何开始。我需要某种搜索功能，可以转到我给它的模式，然后用我保存在某个变量中的计数替换数字。我对 Slick-C 一点也不精通，想尽快完成：\

任何帮助表示赞赏，

泰德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T05:31:12.923

要获得更及时的答案，您可以考虑 slickedit.com 上的 SlickEdit 论坛，但我会在这里尝试。
我会将文件加载到缓冲区中，并按照以下行创建一个宏：

*   创建一个递增计数器的while循环
*   在 while 循环中，使用`search`with 正则表达式来查找下一个匹配项
*   找到下一个匹配项时，使用`search_replace`将找到的字符串替换为使用计数器变量组成的新字符串，并重复上一次搜索
*   当再也找不到任何东西时，终止循环

无需在 XML 文件上进行测试，这应该可以让您开始使用您的功能（假设您知道如何创建宏文件并将其加载到 SE 中），快速测试表明它可以在纯文本文件上工作，不能保证，然而：

```
/* Demo for StackOverflow question 14205293 */
_command my_renumber() name_info(','VSARG2_MARK|VSARG2_REQUIRES_EDITORCTL)
{
  int not_found = 0; /* boolean to terminate loop */
  int iLoop = 0;     /* Counter to renumber items */

  /* Use search initially; if that call doen't find an item, we're done. */
  if (search('blah_:i', 'R') != 0)
  {
    not_found = 1;
  }

  while (!not_found)
  {
    if (search_replace('blah_' :+ iLoop, 'R') == STRING_NOT_FOUND_RC)
    {
      not_found = 1;
    }
    iLoop++;
  }
} 
```

# pointers - 派生类型（在 Fortran 中）占用多少字节？位置是连续的吗？以及指向派生类型的指针？

> ID：14205294
> 
> 赞同：2
> 
> 时间：2013-01-07T22:34:40.193
> 
> 标签：pointers, types, fortran

我在任何地方都找不到这个，即使它可能是微不足道的，我也想确定我已经很好理解了。我有 4 个问题（严格相关）：

1）如果我像这样在fortran中定义派生类型

```
 TYPE :: node
       INTEGER :: int
       REAL :: REALfirst
       REAL :: REALsecond
    END TYPE
    TYPE(node)  :: var
    allocate(var) 
```

经过上述分配后，整数占用 4 个字节，2 个单精度实数占用 8 个字节，总共 12 个字节。它们是否连续位于内存中？计算机如何存储有关变量类型的信息？我想它需要一些额外的内存来保存它。

2）如果在上面的例子中而不是

```
 TYPE(node)  :: var 
```

我会写：

```
 TYPE(node),POINTER  :: var 
```

我猜如果我编译了一个 32 位可执行文件，则 ALLOCATE 语句将分配与上面示例中相同的内存量。这是正确的吗？

3）现在假设我声明了类型

```
 TYPE :: node
       INTEGER :: int
       TYPE(node), POINTER :: BEFORE
       TYPE(node), POINTER :: AFTER
    END TYPE
    TYPE(node)  :: var
    allocate(var) 
```

在这里（如果编译为 32 位），它将为整数分配 4 个字节，为 2 个指针分配其他 8 个字节，总共 12 个字节。对吗？再次，计算机如何存储有关变量类型的信息？

4）在示例（3）中，如果我现在编写 ALLOCATE(var%BEFORE)，则为具有派生类型节点的变量分配其他 12 个字节，为指针 var%BEFORE 分配的 4 个整数类型字节（参见示例 3) 现在已被释放，对吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T09:17:16.990

1) 这不在 fortran 标准中。`real`并且`integer`不必是 4 个字节宽。通过指定它们的精度来确保。如果您不关心数字精度，而是关心字节数，请这样做

```
 !In Fortran 2008
 use iso_fortran_env

 or

 !In Fortran 95
 integer,parameter :: int32  = selected_int_kind(9)
 integer,parameter :: real32 = selected_real_kind(p=6,r=37)

 and

    TYPE :: node
       INTEGER(int32) :: int
       REAL(real32) :: REALfirst
       REAL(real32) :: REALsecond
    END TYPE 
```

允许编译器插入它想要的任何填充。如果您将变量与 4、8 甚至更多字节混合使用，则很可能会发生这种情况。禁止使用任何填充`SEQUENCE`。

2）分配的内存将是相同的。编译器还使用一些数据结构（它可能只是一个地址，但不是必须的）来记账。

3）我引用的簿记数据结构存储在数据类型中。它可能只是一个地址。

4）指针数据结构可以是4字节，也可以更多。然而，更重要的一点是，它们没有被释放。您必须知道在堆上的哪里可以找到分配的空间，并为此使用指针。无论您是使用此指针分配新数据，还是指向某个现有数据，都没有关系。

Note, that bit size of the derived type cannot change at runtime, it is fixed. Another issue are polymorphic variables, but they must be allocated dynamically for this reason.

# java - 播放位于 res/raw 中的 .wav 文件的 Android 代码 - 奇怪的错误

> ID：14205295
> 
> 赞同：0
> 
> 时间：2013-01-07T22:34:51.790
> 
> 标签：java, android, audio

我已经被这个特殊问题困了一段时间了，这应该很简单，所以很烦人..我一定是在以某种方式滥用 Android API？

这是代码：

```
 try {
  String packageName = getPackageName(); 
  int resID = getResources().getIdentifier( "filename" , "raw" , packageName ); //in res/raw folder I have filename.wav audio file
  mp.setDataSource("android.resource://" + packageName + "/" + resID);
  mp.prepare();
  mp.start();
} catch (Exception e) {
  Toast.makeText(PlayScreen.this, e.toString(), Toast.LENGTH_LONG).show(); 
} 
```

我看到的吐司消息说：

```
java.io.IOException: Prepare failed.: status=0xFFFFFFFC 
```

在 eclipse logcat 中，我看到：

```
MediaPlayer Error (-4 -4) 
```

非常感谢任何可以提供帮助的人......我只想播放我的 wav 文件！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:45:42.377

尝试使用 FileDescriptor 代替：

```
String packageName = getPackageName(); 
int resID = getResources().getIdentifier( "filename" , "raw" , packageName );
AssetFileDescriptor afd = getResources().openRawResourceFd(resId);
mp.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength());
mp.prepare();
mp.start();
afd.close(); 
```

这就是我一直做的事情，这样做比硬编码路径更安全。

# iphone - 从原生 iOS Objective-C 应用程序与 Python 或 Java 通信？

> ID：14205298
> 
> 赞同：1
> 
> 时间：2013-01-07T22:34:54.183
> 
> 标签：iphone, objective-c, ios, xcode, rally

有什么方法可以在 Objective-C/XCode/etc 旁边使用 Python/Java 代码？（例如，用 Objective-C 编写我的应用程序，然后在 Python/Java 中访问函数调用？）

我希望能够通过 iPhone 应用程序与 Rally 进行通信，但据我了解，Rally API 是 Python 和 Java。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:37:31.240

Rally 的 Java 和 Python 工具包只是 Rally 的 REST Web 服务 API 的包装器。您最好的选择是利用诸如[RestKit 之](http://restkit.org/)类的 Objective C Rest Toolkit来构建您的应用程序以直接与 Rally 的 REST 服务交互。

# c# - 我应该使用哪种集合类型？

> ID：14205302
> 
> 赞同：0
> 
> 时间：2013-01-07T22:34:58.300
> 
> 标签：c#, collections

我有三个列表框：lb1、lb2 和 lb3。

假设在 lb1 中有 4 个元素，在 lb2 中有 5 个元素。

(lb1 和 lb2) 的每个唯一组合都可以分配给 lb3 中的一个元素。

我想将这些组合和关联存储在一个集合中。我的第一个想法是使用 KeyValuePair 和 Key = (lb1Element1_lb2Element1), Value = lb3Element1。

但是使用这个解决方案我会遇到问题。假设我删除了 lb1Element1，没有选项（？）可以从 KeyValuePair-List 中删除所有其他出现 lb1Element1 的组合。

在这种情况下，哪种集合类型最好？

提前感谢约翰

编辑：所有 3 个列表框都包含数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:40:11.333

2个字典怎么样，1个用于lb1，1个用于lb2：

```
Dictionary<string, Dictionary<string,string>> 
```

第一个 dic：key 是每个 lb1 的值，value 是 lb2 的所有值（key 和 value 相同的字典） 第二个 dic：key 是每个 lb2 的值，value 是 lb1 的所有值

如果您从 lb2 列表框中删除选项“x”，然后要查找已删除 lb2 值的所有连接 lb1 值，请从第一个 dic 中删除所有将“x”作为 lb2 值的对，然后删除整个“x” " 来自第二个 dic 的键：

```
Foreach(var lb1value in Dic2.ElementAt("x").value.keys)
  {
    Dic1.ElementAt("lb1value").
     value.RemoveAt("x");
  }

dic2.removeAt("x"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T22:37:41.100

您可以只使用一个`Dictionary<string,string>`for 键值，它还提供了以下功能`Remove()`

```
 Dictionary<string, string> items = new Dictionary<string, string>();

 items.Remove("mykey"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T22:58:04.767

为什么不为密钥创建类：

```
public class YourKey
{
    public int Item1 { get; private set; }
    public int Item2 { get; private set; }

    public YourKey(int item1, int item2)
    {
       this.Item1 = item1;
       this.Item2 = item2;
    }

    public override bool Equals(object obj)
    {
        YourKey temp = obj as YourKey;
        if (temp !=null)
        {
            return temp.Item1 == this.Item1 && temp.Item2 == this.Item2;
        }
        return false;
    }

    public override int GetHashCode()
    {
        int hash = 37;
        hash = hash * 31 + Item1;
        hash = hash * 31 + Item2;
        return hash;
    }
} 
```

然后您可以在 a 中使用它`Dictionary<YourKey, int>`来存储所有值。

这样做的好处是只能存储 Item1 和 Item2 的每个组合的一个值。

如果要删除您的字典中具有项目 1 == 1 的所有条目：

```
var entriesToDelete = yourDictionary.Where(kvp => kvp.Key.Item1 == 1).ToList();
foreach (KeyValuePair<YourKey, int> item in entriesToDelete)
{
    yourDictionary.Remove(item.Key);
} 
```

# regex - 正则表达式 (ab*foo) 与 (a.*foo) 的区别？

> ID：14205304
> 
> 赞同：1
> 
> 时间：2013-01-07T22:35:04.900
> 
> 标签：regex

从本[教程](http://docs.oracle.com/javase/tutorial/essential/regex/quant.html)中，我了解了“正则表达式 - 量词”，并基于本教程中使用的[测试代码。](http://docs.oracle.com/javase/tutorial/essential/regex/test_harness.html)

我对这些测试有疑问：

```
Enter your regex: ab*foo
Enter input string to search: xabfooxxxabbbfoox
I found the text "abfoo" starting at index 1 and ending at index 6.
I found the text "abbbfoo" starting at index 9 and ending at index 16. 
```

但

```
Enter your regex: a.*foo
Enter input string to search: xabfooxxxabbbfoox
I found the text "abfooxxxabbbfoo" starting at index 1 and ending at index 16. 
```

为什么不是这些：

```
I found the text "abfoo" starting at index 1 and ending at index 6.
I found the text "abbbfoo" starting at index 9 and ending at index 16. 
```

一般来说，我注意到无论何时`.*`或`.+`使用：

*   如果有的话，只有一个匹配。

*   字符串的匹配部分始终是最长的部分。

那么 Matching 是如何为每一个工作的呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:37:39.233

`ab*foo`将匹配 an `a`，后跟 0 个或多个`b`s，然后是`foo`

`a.*foo`将匹配一个`a`，后跟 0 个或多个任意字符（由 表示`.`），然后是`foo`

`b+`将匹配该字符的 1 个或多个实例`b`

查看[regex101](http://regex101.com/)以获得一个很好的正则表达式测试工具，它将解释你的模式意味着什么

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T22:40:01.790

你有一个问题，在第二个正则表达式中，`*`是一个贪婪的量词。这意味着什么？这意味着它不会停止，直到该`foo`字符串的最后一次出现。

您只需在量词之后添加即可使其成为非贪婪`?`的，这将告诉正则表达式尽可能少地匹配，以便匹配您想要的。

毕竟：

您的第一个将匹配尽可能多`b`，甚至 0 您的第二个将匹配尽可能多`.`（无论字符），甚至 0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T22:36:57.333

`*`贪婪地匹配前一个字符的零个或多个。 `.`匹配任何字符。所以`.*`意味着“匹配零个或多个任何字符”。

关键是“贪婪”的部分。 `a.*foo`将继续一直搜索到字符串的末尾，寻找最后出现的`foo`，一旦找到它，它就会“备份”并标记匹配完成。所以，如果你有`axxxxfooxxxfooxxx`，贪婪的匹配行为将匹配中间的`foo`，像对待任何其他字符一样对待那些，但会停在最后一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T22:48:02.710

## `ab*foo`

将匹配 a 后跟 0 个或多个 b 和 foo 例如：

```
afoo
abfoo
abbfoo
abbbfoo
abbbbbbbbbbbbbbbbbbbbfoo 
```

## `a.*foo`

将匹配 a 后跟 foo 的任何内容

```
afoo
abfoo
acfoo
adfoo
asdfoo
asdasdfasdfawqfefoo 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-07T22:40:58.260

.* 或 .+ 生成一个匹配项（如果有），因为默认情况下，大多数正则表达式程序设置为匹配可能的最长子字符串。

不过，有些可能可以通过选项进行配置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-07T22:36:52.540

`acfoo`例如，匹配`a.*foo`但不匹配`ab.*foo`。

# wpf - 数据网格记录中的 wpf ICommand 绑定导致内存泄漏

> ID：14205307
> 
> 赞同：2
> 
> 时间：2013-01-07T22:35:34.610
> 
> 标签：wpf, data-binding, memory-leaks

假设我有一个需要使用超链接控件呈现的类的属性。超链接将绑定到视图模型上的命令，以便单击它会触发一些操作。像这样的东西：

```
<Style x:Key="HyperlinkStyle" TargetType="{x:Type igDP:CellValuePresenter}">
   <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type igDP:CellValuePresenter}">
                    <Border BorderBrush="{StaticResource DataGridCellOuterBorder}" BorderThickness="1,0,0,0"  >
                        <TextBlock Margin="5">
                                <Hyperlink                                      
                                    Command="{Binding ElementName=dataGrid, Path=DataContext.Commands[GetSolutionSummaryCmd], Mode=OneTime}"
                                    CommandParameter="{Binding Path=(igDP:DataRecord.DataItem), Mode=OneTime}">
                                    <TextBlock Text="{TemplateBinding Value}"/>                                                                      
                                </Hyperlink>                                                                                
                            </TextBlock>
                    </Border>                 
                </ControlTemplate>
            </Setter.Value>
        </Setter>       
    </Style> 
```

如何确保从网格中删除数据项时，dataGrid.DataContext.Command[GetSolutionSummaryCmd]、ICommand 的实现与每个具有超链接列的数据记录之间的绑定被破坏，从而可以对数据项进行垃圾收集？否则，我在这里看到内存泄漏的可能性。

此外，GetSolutionSummaryCmd 是 RelayCommand 的一个实例，实现如下：

```
public class RelayCommand  : ICommand
{
    readonly protected Predicate<object> _canExecute;
    readonly protected Action<object> _execute;

    public RelayCommand(Predicate<object> canExecute, Action<object> execute)
        : this(canExecute, execute, true)
    {
    }

    public RelayCommand(Predicate<object> canExecute, Action<object> execute, bool isCommandAllowed)
    {
        _canExecute = canExecute;
        _execute = execute;
        IsAllowed = isCommandAllowed;
    }

    public void RaiseCanExecuteChanged()
    {
        if (this.CanExecuteChanged != null)
            this.CanExecuteChanged(this, EventArgs.Empty);
    }

    #region ICommand Members

    public virtual bool CanExecute(object parameter)
    {
        return _canExecute(parameter);
    }

    public event EventHandler CanExecuteChanged;

    public virtual void Execute(object parameter)
    {
        _execute(parameter);
    }    

    #endregion 
} 
```

[与此](https://stackoverflow.com/questions/12919288/icommand-binding-causing-ui-memory-leak-in-wpf-application)相反，我需要能够提高 CanExecuteChanged。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T12:09:22.940

我使用[这里](https://stackoverflow.com/questions/12919288/icommand-binding-causing-ui-memory-leak-in-wpf-application)的建议来解决这个问题。泄漏肯定是由上述样式中使用的超链接元素引起的。ANTS 探查器通过内存快照之间的 System.Windows.EffectiveValueEntry[] 的正实例计数表明了这一点。当我查看这个类的对象引用图时，总是有一个对链中超链接实例的引用。

基础数据已更改，以便在单击时始终可以执行超链接。这意味着不必引发 ICommand 的 CanExecuteChanged 事件，允许我定义某种 NoReferenceRelayCommand 类，如下所示：

```
 public class NoReferenceRelayCommand : ICommand
    {
        protected readonly Action<object> _execute;

        public NoReferenceRelayCommand(Action<object> execute)
        {
            Guard.ThrowIfArgumentIsNull(execute);
            _execute = execute;
        }

        #region ICommand Members

        public bool CanExecute(object parameter)
        {
            return true;
        }

        public event EventHandler CanExecuteChanged
        {
            add { }
            remove { }
        }

        public void Execute(object parameter)
        {
            _execute(parameter);
        }

        #endregion
    } 
```

超过 10 小时的分析解决方案显示 System.Windows.EffectiveValueEntry 的实例数没有增加。

# ios - 覆盖由内置 UIActivity 类型执行的活动

> ID：14205308
> 
> 赞同：5
> 
> 时间：2013-01-07T22:35:40.463
> 
> 标签：ios, uiactivityviewcontroller, uiactivity

是否可以覆盖由 UIActivityViewController 使用的内置 UIActivity 类型执行的活动？

例如，我希望 Facebook 活动使用我自己的自定义视图而不是内置视图。我知道你可以继承 UIActivity 来制作你自己的应用程序特定的活动，但你总是坚持内置的默认行为吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-02T11:00:09.250

您不能覆盖内置的。您能做的最好的事情就是停用它们并用您自己的 UIActivity 子类替换它们。从功能上讲，这与覆盖它们具有相同的效果。

然而，从视觉上看，这意味着您必须为这些服务提供自己的图标图像。然后，Apple 的代码将获取这些图像，丢弃颜色数据并使用 alpha 映射来制作与 Apple 通常的黑点背景相对应的灰度着色版本。您不能为自己的自定义活动提供彩色图像。据推测，这是为了阻止人们复制“官方”服务图标并出于自己的目的颠覆它们，即假装在 Facebook 上发布一些东西，而实际上却在做一些完全不同的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-15T10:03:42.977

您不能覆盖内置 UIActivity 类型的行为 - 但是您可以通过提供自己的`UIActivityItemProvider`子类来覆盖它们获得的数据。为此，您必须覆盖[– activityViewController:itemForActivityType:](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIActivityItemSource_protocol/Reference/Reference.html#//apple_ref/occ/intfm/UIActivityItemSource/activityViewController%3aitemForActivityType%3a) 因此，虽然它不是 100% 您正在寻找的东西，但您至少可以根据您的意愿弯曲内置的。

# mysql - 如何生成随机的unix时间戳mysql

> ID：14205313
> 
> 赞同：4
> 
> 时间：2013-01-07T22:36:09.060
> 
> 标签：mysql, sql, datetime, timestamp, unix-timestamp

我正在尝试生成随机的 unix 时间戳，但只找到了这个例子：

```
SELECT from_unixtime(
       unix_timestamp('2008-01-01 01:00:00')+floor(rand()*31536000)
); 
```

这适用于生成随机时间，但它将时间重新转换为这种格式`2008-06-16 14:14:38`，这*不是*我想要的格式。我希望结果是一个 unix 时间戳，例如`1357597694`在 UTC-5 中。

我想要做的就是能够告诉它要吐出多少个 unix 时间戳，并让结果以 unixtime 时间戳的形式出现。就这样。我不明白为什么没有关于这个的帖子。

*编辑* 好的萨尔曼A

好的，可以说我需要在 1354439504 和 1357599297 之间选择一个随机日期我将如何在 mysql 脚本中执行此操作

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T22:41:08.900

1 是 UNIX 时间戳。2 也是如此。123456789 也是如此[。UNIX 时间戳](http://en.wikipedia.org/wiki/Unix_time)只是一个整数；并且可以使用生成随机整数的规则。在 MySQL 中，您可以简单地编写以下代码来生成范围内的随机整数`[0, 9]`：

```
SELECT FLOOR(RAND() * 10) 
```

上面可以修改生成范围内的随机数`[min, max]`如下：

```
SELECT 1354439504 + FLOOR(RAND() * (1357599297 - 1354439504 + 1)) 
```

要使用查询生成 1000 个随机时间戳，请使用包含许多行的表（任何表）：

```
SELECT 1354439504 + FLOOR(RAND() * (1357599297 - 1354439504 + 1))
FROM table_with_1000plus_rows
LIMIT 1000 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-07T22:39:14.130

如果您想要一个 unix 时间戳，那么只需跳过`from_unixtime`：

```
select unix_timestamp('2008-01-01 01:00:00')+floor(rand()*31536000) 
```

# ios - 为什么设置窗口的 RVC 大约需要 4 秒？

> ID：14205316
> 
> 赞同：0
> 
> 时间：2013-01-07T22:36:35.353
> 
> 标签：ios

我在我的 didFinishLaunchingWithOptions: 方法的 XCode 中以交互方式逐步执行代码，并注意到它在此伪代码的最后一行暂停了大约 4 秒：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

  ...
 create and initialize model
 ...
create UIViewController
create navController with view controller

self.window.rootViewController = navController; 
```

其中 navController 顾名思义就是一个 UINavigationController。

为什么在使用 Xcode 单步执行时会在这一行暂停？

我在 didFinishLaunchingWithOptions: 中初始化我的模型，也许并非巧合的是，当模型在创建时要扫描大量数据对象时测试行为（它的扫描文件、读取文件和创建对象，因此可能会很慢有很多文件）。目前模型初始化是同步的，我看到确定它是否应该变为异步需要多长时间，那时我注意到了这种行为。

如果它的模型需要时间来构建，这就是为什么我在 IDE 中看到延迟，那么为什么在设置 rootViewController 而不是构建模型时会出现这种延迟？

为了澄清我的问题是：

*   我不是在问为什么我的代码很慢

*   我不是在问如何追踪慢代码的位置

*   我只是因为好奇而要问的是，为什么如果我的模型初始化很慢，它会在分配给窗口的 RVC 时以交互方式单步执行调试器中的代码时表现出来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:38:58.060

尝试[`Instruments`](http://developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/Introduction/Introduction.html)追踪此类问题。

# c# - 实体框架：如何动态检索列的 DatabaseGeneratedOptions 和导航属性的外键列？

> ID：14205322
> 
> 赞同：0
> 
> 时间：2013-01-07T22:36:52.200
> 
> 标签：c#, linq, entity-framework, linq-to-entities, code-first

我有一个 POCO 实体，如下所示：

```
public class Entity {
    public int Id { get; set; }
    public int? OtherEntityId { get; set; }
    public virtual OtherEntity OtherEntity { get; set; }
} 
```

代码优先配置如下：

```
conf.HasKey(e => e.Id).ToTable("entities");
conf.Property(e => e.Id).HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);
conf.HasOptional(e => e.OtherEntity).WithMany().HasForeignKey(e => e.OtherEntityId); 
```

我希望能够在运行时检索数据库生成的选项和 FK 属性。例如，我可以像这样动态检索主键属性：

```
var keyProperties = objectContext.CreateObjectSet<Entity>()
    .EntitySet
    .ElementType
    .KeyMembers
    .Select(km => typeof(Entity).GetProperty(km.Name));
    .ToList() 
```

我该怎么做（我使用的是 EF 4.3.1）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:09:25.840

要查找外键属性，只需使用@Ashraf 对[这个 SO question](https://stackoverflow.com/questions/4384081/read-foreign-key-metadata-programatically-with-entity-framework-4)的回答。

在保留 Fluent API 的同时，我找不到任何类似的东西来查找 DatabaseGenerated 属性。如果您愿意在 POCO 上添加数据注释，您应该能够使用反射来获取它，就像任何其他属性一样（类似于[此博客文章](http://blogs.southworks.net/dschenkelman/2012/08/18/creating-indexes-via-data-annotations-with-entity-framework-5-0/)中所做的）：

```
typeof(Entity).GetProperties().Where(prop => prop.GetCustomAttributes(typeof (DatabaseGeneratedAttribute), true).Any()); 
```

这将返回一个`IEnumerable><PropertyInfo>`，然后您应该可以使用它。

# c# - 输入字符串格式不正确

> ID：14205324
> 
> 赞同：-3
> 
> 时间：2013-01-07T22:36:56.023
> 
> 标签：c#, .net, input

您好，我遇到的问题可以在下面的评论中看到。基本上我到了输入格式不正确的地步，我不明白为什么，下面也是我试图输入的数据。

数据，

```
128,119,137,140,128,117,197     -0.5,0.0,0.5
125,129,136,130,125,162,125     -1.0,0.0,1.0
138,139,135,120,127,117,118     -0.5,0.0,0.5
127,149,138,160,122,217,137
149,129,140,140,129,127,126
153,159,130,140,127,112,126
147,129,130,148,128,137,134 
```

谁能看到它为什么不接受它？

```
TextReader tr = new StreamReader("c:/users/tom/documents/visual studio 2010/Projects/Exam/Exam/Data.txt");     

for (var i = 0; i < 2; i++)   // Ignores first two lines
{
   String input =  tr.ReadLine();
}                

string remainingText = tr.ReadToEnd(); //Reads remained            
string result = Regex.Replace(remainingText, @"\s+", ",");

char[] delimiterChars = {','};        //Establishes what should split the strings
string[] itemlist = (result.Split(delimiterChars)); //Splits the strings and puts them into itemlist
double[] values = new double[itemlist.Length];        //Creates an array the same size as itemlist

for (int i = 0; i < itemlist.Length; i++)
{
    values[i] = (Convert.ToDouble(itemlist[i]));  
    //Attempts to convert the >values from itemlist into values ERROR, input string not in correct format
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:53:04.380

添加`StringSplitOptions.RemoveEmptyEntries`到`Split`

```
string[] itemlist = (result.Split(delimiterChars,StringSplitOptions.RemoveEmptyEntries)); 
```

# sql-server - 如何在 VS.NET 2012 安装过程中安装 SQL Server Profiler

> ID：14205328
> 
> 赞同：1
> 
> 时间：2013-01-07T22:37:04.507
> 
> 标签：sql-server, visual-studio-2012, installation, sql-server-profiler

我在几个月前安装了 VS.NET Professional 2012 并安装了 SQL Server 2012 Express，但看来我可能错过了安装 SQL Server Profiler 的选项。所以我想回去添加它，但我不知道怎么做。当我运行 VS.NET 设置时，它给了我“修改”、“修复”和“卸载”。如果我选择“修改”，我会得到 6 个选中项：Visual Studio 的 Blend、LightSwitch、C++ 的 MFC、Microsoft Office 开发人员工具、Sharepoint 开发人员工具和 Web 开发人员工具（所有这些都被选中）。

我尝试通过在程序和功能中双击它来运行 MS SQL Server 安装，但它会弹出一个带有添加、修复和删除链接的小对话框，但单击添加（添加功能）让它询问我安装媒体和我在 VS.NET DVD 上找不到它满意的目录。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T23:25:05.067

SQL Server Express Edition 没有 Profiler。您至少需要标准版。对于一些 sufggested 替代品（我没有使用过）尝试谷歌搜索“SQL Server 2012 Express Profiler”

# php - 从PHP中的特定日期获取前7天和后7天？

> ID：14205329
> 
> 赞同：1
> 
> 时间：2013-01-07T22:37:15.810
> 
> 标签：php, date

从特定日期获取上一个和下一个 7 天

```
$date = new DateTime();
$today = $date->format('m d, Y'); 
```

如何从 $today 获取前 7 天和后 7 天？并将它们循环到一个数组中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T23:30:27.257

与其他答案不同的东西，但是呢？

```
$start   = new DateTime();
$end     = new DateTime();

$start   = $start->modify( '-7 days' ); 
$end     = $end->modify( '+8 days' ); // Date Period doesn't include the end date

$interval = new DateInterval('P1D');
$daterange = new DatePeriod($start, $interval ,$end);

foreach($daterange as $date){
    echo $date->format("'m d, Y'") . "<br>";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T22:43:39.850

可能最适合这种情况：

[`DateTime::modify`](http://us2.php.net/manual/en/datetime.modify.php)

# php - 服务器没有收到 iOS POST

> ID：14205333
> 
> 赞同：0
> 
> 时间：2013-01-07T22:37:27.753
> 
> 标签：php, ios, xcode

几个小时以来，我尝试将帖子数据从我的 iOS 应用程序发送到服务器。我最近更改了服务器，现在代码不再起作用 - 所以我会说它是我正在使用的新服务器的“故障”。（我更改了服务器，因为旧服务器无法处理流量）。但我不确定，所以我只想问一下我的代码是否有问题，或者可能是错误的。也许你有一个想法（我用谷歌搜索并在 stackoverflow 上搜索了几个小时：/）

我使用的代码是：

```
 NSString *postString = [NSString stringWithFormat:@"udid=%@&message=%@",UUID,field.text];

    NSData *postData = [postString dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES];;
    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
    [request setURL:[NSURL URLWithString:@"http://url.de/file.php"]];

    [request setHTTPMethod:@"POST"];
    [request setValue:[NSString stringWithFormat:@"%d", postData.length] forHTTPHeaderField:@"Content-Length"];
    [request setValue:@"application/x-www-form-urlencoded charset=utf-8" forHTTPHeaderField:@"Content-Type"];
    [request setHTTPBody:postData];

    NSError *error;
    NSURLResponse *response;
    NSData *urlData=[NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
    NSString *data=[[NSString alloc]initWithData:urlData encoding:NSUTF8StringEncoding];
    NSLog(@"Data: %@",data); 
```

正如我所说，它确实在另一台服务器上工作，所以也许我必须更改一些编码或类似的东西？

# go - 从标准输入读取行直到某个字符

> ID：14205337
> 
> 赞同：9
> 
> 时间：2013-01-07T22:37:41.730
> 
> 标签：go

我正在学习围棋。

我的程序应该从标准输入读取数据，直到我输入一个带有单个句点的行。

```
package main

import (

  "os"
  "fmt"
  "bufio"

)

func main(){

  in    := bufio.NewReader(os.Stdin)
  input := ""

  for input != "." {
    input, err := in.ReadString('\n')
    if err != nil {
      panic(err)
    }
  }
} 
```

我应该如何修改我的 for 循环，以在我输入一个点时停止程序？

我试图用 for 语句实现一个 while 循环，我的方法有问题，条件错误，还是 ReadString 弄乱了我的数据？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-06-18T22:58:53.037

以防万一其他人遇到这个问题：

从 Go 1.1 开始，有一种更好的方法可以循环某些可用输入的行。这就是我今天将如何解决 OP 的问题：

```
package main

import (
    "bufio"
    "fmt"
    "os"
)

func main() {
    scanner := bufio.NewScanner(os.Stdin)
    for scanner.Scan() {
        line := scanner.Text()
        if line == "." {
            break
        }
        fmt.Println(line) // or do something else with line
    }
} 
```

`scanner.Text()`自动去除尾随的换行符。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-07T22:57:34.950

> ... ReadString 是否在弄乱我的数据？

不，不是。它正在阅读到下一个`'\n'`。这意味着上面只有一个点的行将包含数据`".\n"`或`".\r\n"`取决于操作系统。

要删除行尾，我会这样做`input = strings.TrimRight(input, "\r\n")`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-21T15:58:50.217

使用任何**bufio 辅助函数**的主要**问题**是它可能会读取更多超出停止字符的数据。它读取缓冲区大小的所有可用输入。在并发访问 os.Stdin 的情况下，下一个读取器可能会错过一些之前由 bufio 读取的输入。下面是我的非缓冲“草稿”代码，用于勾画从输入流中读取直到**CR**字符的所有字符的并发安全方法。**`'\n'` **`('\n')`****

 ****```
package main

import "os"

// echo a line in input to output
// you may add exit signal in copy loop as well
func main() {
    const BUF_SIZE = 128
    in := os.Stdin
    out := os.Stdout
    bufOut := make([]byte, BUF_SIZE)
    n := 0
    for {    // copy loop 
        // non buffered byte-by-byte
        if _, err := in.Read(bufOut[n : n+1]); err != nil {
            break
        }
        if bufOut[n] == 0xa || n == BUF_SIZE { // reached CR or size limit 
            if _, err = out.Write(bufOut[0 : n+1]); err != nil {
                break
            }
            n = 0
        } else {
            n++
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-22T20:32:01.927

刚刚注意到主题内的问题与标题中的问题不同。有问题的初始样本的错误是在循环内**重新声明了输入变量。**这就是为什么您的条件检查永远不会到达退出点的原因。****

# sql - 编辑表定义

> ID：14205343
> 
> 赞同：0
> 
> 时间：2013-01-07T22:38:06.300
> 
> 标签：sql, visual-studio-2012, sql-server-2012

所以最近我的主机升级到 SQL Server 2012，所以今天我想创建一个新表并更改现有表中列的数据类型。但是，打开表定义后，它看起来与 2008 不同，我不知道如何保存更改；在我进行更改之前，点击保存并完成。现在，如果我点击保存，它会询问我要将 .sql 文件保存在我的计算机上的哪个位置，有一个新的更新按钮只会给我一个错误，并且有一个显示 t-sql 的窗口正在创建我已经创建的表.

我只能使用查询进行编辑，而且我真的不想一直这样做，有人知道如何使用 SQL Server 2012 和 Microsoft Visual Studio 2012 进行编辑和保存吗？

下面是我看到的，不知道有没有帮助..[点击查看截图](http://i.stack.imgur.com/LkmpA.png)

# c# - 带有 sql 查询的表达式树

> ID：14205351
> 
> 赞同：0
> 
> 时间：2013-01-07T22:38:34.590
> 
> 标签：c#, .net, expression-trees

我正在尝试创建一个表达式树，它将通过我的名为 test 的表查看 Foo 列中的所有字符串“电子邮件”。我几乎从 msdn 复制了一些小改动，但无法让它在我的表中搜索。让这个表达式树搜索的任何帮助都会很棒。非常感谢您

称为测试的表结构

```
id int
foo char(10) 
```

错误

> 类型“System.Linq.Queryable”上没有通用方法“Where”与提供的类型参数兼容

```
var s = new m2Entities().Test
var queryableData = new m2Entities().SaleLogs.AsQueryable<SaleLog>();
ParameterExpression pe = Expression.Parameter(typeof(string), "foo");
Expression left = Expression.Call(pe, typeof(string).GetMethod("ToLower", System.Type.EmptyTypes));
Expression right = Expression.Constant("bar");
Expression e1 = Expression.Equal(left, right);

MethodCallExpression whereCallExpression = Expression.Call(typeof(Queryable),
                                                           "Where",
                                                           new Type[] { queryableData.ElementType },
                                                           queryableData.Expression,
                                                           Expression.Lambda<Func<string, bool >>(e1,new ParameterExpression[] { pe }));
var results = queryableData.Provider.CreateQuery<string>(whereCallExpression); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T00:08:04.860

您尝试这样调用`Where`：

```
Queryable.Where<SaleLog>((string pe) => pe.ToLower() == "bar") 
```

那是不对的。它应该是：

```
Queryable.Where<SaleLog, bool>((SaleLog pe) => pe.foo.ToLower() == "bar") 
```

错误消息暗示了这一点：

> 类型“System.Linq.Queryable”上没有通用方法“Where”与提供的类型参数兼容

这是完全准确的。

# javascript - 将 SQL 命令与数据库匹配

> ID：14205356
> 
> 赞同：1
> 
> 时间：2013-01-07T22:38:49.560
> 
> 标签：javascript, sql, sql-server, web-sql

我将 webdb 用于客户端，我想匹配服务器端数据库，以便可以离线使用 Web 应用程序。这是用于创建服务器端表的脚本...

```
USE [TESTDB]
GO

/****** Object:  Table [dbo].[tblInternalMobile_SalesCalls]    Script Date: 01/08/2013 11:30:31 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[tblInternalMobile_SalesCalls](
    [newcall_id] [int] IDENTITY(1,1) NOT NULL,
    [companyname] [varchar](30) NOT NULL,
    [comment] [varchar](300) NULL,
    [dateUTC] [datetime2](7) NOT NULL,
 CONSTRAINT [PK_tblInternalMobile_SalesCalls] PRIMARY KEY CLUSTERED 
(
    [newcall_id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO 
```

我试图在客户端匹配它但围绕身份我得到一个错误`Uncaught Error: [object SQLError], Error Code: 5, Error Message: could not prepare statement (1 near "IDENTITY": syntax error)`

这是我的客户端代码...

```
//Database helper
//I want to use a 'namespace' for this to minimize name conflicts
var DbHelper = {};
//use the webDb 'namespace' so we could use indexDb if need be in the future by making a new 'namespace'
DbHelper.webDb = {};
//To store the database object
DbHelper.webDb.db = null;
//Open the database
DbHelper.webDb.openDb = function() {
    var dbSize = 5 * 1024 * 1024 //5MB I believe is the max
    DbHelper.webDb.db = openDatabase("TestDB", "1.0", "Database manager", 5 * 1024 * 1024);
};
//If there is an error its going to throw an error, I havent added any handlers for this, so it should be added where the function is called
DbHelper.webDb.onError = function(tx, e) {
    throw "Error: " + e + ", Error Code: " + e.code + ", Error Message: " + e.message;
};
//This should be used if we are doing a non query, where we dont need to use the result
DbHelper.webDb.onSuccess = function(tx, r) {
    console.log("Database result: " + r)
};
//Create the tables we are going to use
DbHelper.webDb.createTables = function() {
    var db = DbHelper.webDb.db;
    db.transaction(function(tx) {
        //I am using the same tables as I am on the server, so we dont confuse things
        tx.executeSql("CREATE TABLE IF NOT EXISTS tblInternalMobile_SalesCalls(newcall_id INT PRIMARY KEY IDENTITY(1,1), companyname varchar(30), comment varchar(300), dateUTC DATETIME2)", [], DbHelper.webDb.onSuccess, DbHelper.webDb.onError);
    });
}
DbHelper.webDb.init = function() {
    DbHelper.webDb.openDb();
    DbHelper.webDb.createTables();
}

$(document).ready(function(e) {
    DbHelper.webDb.init();
}); 
```

为什么它不起作用？我相信我使用了正确的语法，显然不是。

问题是这个声明`CREATE TABLE IF NOT EXISTS tblInternalMobile_SalesCalls(newcall_id INT PRIMARY KEY IDENTITY(1,1), companyname varchar(30), comment varchar(300), dateUTC DATETIME2)`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:51:59.243

如果您实际上在客户端和服务器端使用 SQL Server 或其变体之一，您可能应该使用相同的 CREATE TABLE 语句。但是 SQL Server 不支持 CREATE TABLE *IF NOT EXISTS*。

如果您使用**已[弃用的 HTML5 界面](http://www.w3.org/TR/webdatabase/#web-sql)**，则您的用户代理应符合 SQLite 语法。

```
CREATE TABLE tblInternalMobile_SalesCalls(
  newcall_id INTEGER PRIMARY KEY AUTOINCREMENT, 
  companyname varchar(30), 
  comment varchar(300), 
  dateUTC DATETIME2
); 
```

我相信 w3.org 的[索引数据库 API](http://www.w3.org/TR/IndexedDB/)旨在取代 webdb。

# mysql - 对用户表进行分区

> ID：14205359
> 
> 赞同：1
> 
> 时间：2013-01-07T22:38:59.183
> 
> 标签：mysql, partitioning

我有一个包含所有系统用户的表。随着时间的推移，一些用户帐户最终会在此表中处于休眠状态和未使用状态。

如果我有大量用户，最好按日期（上次登录日期）对表进行分区，然后根据日期查询用户。例如：您登录并且您的 lastlogondate 已更新，这是分区使用的。

问题：这是否意味着所有当前用户都将在第一个分区中说出，因为他们的日期戳是最新的。这是否是将当前活动用户池保留在一个分区中的好方法，并且过时帐户的重置最终将驻留在其他分区中，具体取决于上次活动日期。（注意：如果用户再次登录，他们将再次激活）。

这是加快查询速度的好方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T23:28:26.183

不，我不会使用这种分区方法。

要从 MySQL 分区修剪中受益，您的查询必须引用分区键的列。因此，为了使您提出的分区方案产生任何好处，您对用户的*所有*查询都需要引用 last_login 列，并且您需要不断更新与 last_login 列进行比较的值：

```
SELECT ... FROM users WHERE user_name = 'Adam' AND last_login >= '2013-01-01'
-- remember to change this to '2013-02-01' by next month 
```

如果没有搜索特定 last_login 的术语，查询将不得不扫描*所有*分区。

我也会担心“分区流失”，即行经常从一个分区移动到另一个分区。

还记得在 MySQL 中，分区列必须是表中每个主键或唯一键的一部分。所以使用 last_login 作为分区键需要你定义你的表：

```
CREATE TABLE Users (
  user_name VARCHAR(12) NOT NULL,
  last_login DATETIME NOT NULL,
  ...
  PRIMARY KEY (user_name, last_login)
); 
```

这会打开另一个用户创建帐户“Adam”的可能数据异常，只要他们有不同的上次登录时间。两个帐户可以无限期地存在于同一个表中，直到两个亚当碰巧同时登录。然后可能会因为违反主键而被拒绝登录。这将是一个非常令人费解的拒绝登录的原因。

一个稍微好一点的分区方案是这样的：

```
CREATE TABLE Users (
  user_name VARCHAR(12) NOT NULL,
  last_login DATETIME NOT NULL,
  is_archived TINYINT(1) NOT NULL DEFAULT 0,
  ...
  PRIMARY KEY (user_name, is_archived)
) PARTITION BY HASH(is_archived) PARTITIONS 2; 
```

目的是您定期运行作业以手动归档用户：

```
UPDATE Users SET is_archived=1 WHERE last_login < CURDATE() - INTERVAL 30 DAY; 
```

这解决了分区流失问题和分区创建杂务问题。它仍然可能允许存在多个“亚当”，但如果您仔细控制将一行从一个分区移动到另一个分区的实例，那么风险应该较低。

您仍然必须在查询中引用分区键，但您比较的值将是固定的：

```
SELECT ... FROM users WHERE user_name = 'Adam' AND is_archived = 0; 
```

# mysql - MySQL 在多行上查询 WHERE 和 AND

> ID：14205362
> 
> 赞同：3
> 
> 时间：2013-01-07T22:39:15.610
> 
> 标签：mysql

嗨，我对 MySQL 查询有疑问。

我有下表：

```
 product_properties             <-- table name
+------------------------------------------+    
|  id  |  property  |  value  | productid  | <-- field names
+------------------------------------------+
|   1  |  example   |    230  |         3  | +-- rows
|   2  |  power     |    110  |         3  | |
|   3  |  voltage   |    1.2  |         4  | |
|   4  |  example   |    240  |         4  | |
|   5  |  example   |    320  |         6  | |
|   6  |  power     |    100  |         4  | |
|   7  |  power     |    110  |         6  | +
+------------------------------------------+ 
```

我想创建一个过滤器查询。例如：

想查看与“230”匹配的“示例”的所有产品。这将返回一项，我使用的是：

```
SELECT * FROM product_properties WHERE property='example' AND value='230'; 
```

这很容易，但现在我想展示所有与“230”匹配的“示例”和与“110”匹配的“电源”的产品。

我尝试了以下方法：

```
SELECT * FROM product_properties WHERE property='example' AND value='230' AND property='power' AND value='110';

SELECT * FROM product_properties WHERE property='example' AND value='230' OR property='power' AND value='110'; 
```

第一个查询的问题是，它将返回空，我明白了。第二个查询的问题是，它还返回具有属性“示例 230,240,320”的产品。

我的问题是最好的使用方法是什么，或者我不应该创建一个动态产品属性表吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:41:40.600

您必须过滤**其中一个或**（因为两种情况都不能匹配 1 条记录），然后找到两者都与`having`子句匹配的属性

```
SELECT product_id 
FROM product_properties 
WHERE property='example' AND value='230' 
OR property='power' AND value='110'
group by product_id
having count(distinct property) = 2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T22:40:41.693

尝试：

```
SELECT *
  FROM product_properties
 WHERE ( property='example' AND value='230' )
   OR  ( property='power' AND value='110' ); 
```

# c# - 将标签的内容绑定到代码隐藏文件中的属性

> ID：14205364
> 
> 赞同：0
> 
> 时间：2013-01-07T22:39:18.617
> 
> 标签：c#, wpf

我正在制作宾果卡生成器以尝试了解有关 WPF 的更多信息，并且无法弄清楚如何设置标签内容属性以从我的代码隐藏文件中的属性中设置。

我以为我可以使用

`<Setter Property="Content" Value="{Binding BNumber}">`

对于 content 属性，将标签的内容设置为 my 的随机元素`List<String>`？

我的**MainWindow.xaml中有**

```
<Window x:Class="Bingo.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="600" Width="800"
        WindowStartupLocation="CenterScreen">
  <Grid>
    <Grid Width="350" Height="420" ShowGridLines="True">
      <Grid.RowDefinitions>
        <RowDefinition Height="70"/>
        <RowDefinition Height="70"/>
        <RowDefinition Height="70"/>
        <RowDefinition Height="70"/>
        <RowDefinition Height="70"/>
        <RowDefinition Height="70"/>
      </Grid.RowDefinitions>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="70" />
        <ColumnDefinition Width="70" />
        <ColumnDefinition Width="70" />
        <ColumnDefinition Width="70" />
        <ColumnDefinition Width="70" />
      </Grid.ColumnDefinitions>
      <!-- The Label I'm trying to set in this example -->
      <Label Grid.Column="0" Grid.Row="1" Style="{StaticResource BNumber}"
             FontSize="50" Width="70"/>
    </Grid>
  </Grid>
</Window> 
```

我的**App.xaml**代码

```
<Application x:Class="Bingo.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             StartupUri="MainWindow.xaml">
  <Application.Resources>
    <Style TargetType="Label" x:Key="BNumber">
      <Setter Property="Content" Value="{Binding}"></Setter>
      <Setter Property="Background">
        <Setter.Value>
          <SolidColorBrush Color="Beige"/>
        </Setter.Value>
      </Setter>
    </Style>
  </Application.Resources>
</Application> 
```

在我的**MainWindow.xaml.cs**我有这个`List<String> BNumbers`对象和一个返回`BNumbers`列表的随机元素的属性

```
public MainWindow() {
  InitializeComponent();
  BNumbers.Add("1");
  BNumbers.Add("2");
  BNumbers.Add("3");
  BNumbers.Add("4");
  BNumbers.Add("5");
  BNumbers.Add("6");
  BNumbers.Add("7");
  BNumbers.Add("8");
  BNumbers.Add("9");
  BNumbers.Add("10");
  BNumbers.Add("11");
  BNumbers.Add("12");
  BNumbers.Add("13");
  BNumbers.Add("14");
  BNumbers.Add("15");
}
public string RandomBNumber {
  get { return randomB(); }
}
public string randomB() {
  Random rand = new Random();
  int randomBNumber = rand.Next(0, 15);
  return BNumbers[randomBNumber];
}
public List<String> BNumbers = new List<string>(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T23:18:59.817

随机化列表本身然后每个数字可能更容易，因为这将停止重复。

Aslo 使用统一网格可能比添加一堆标签更容易。

例子：

xml:

```
<Window x:Class="WpfApplication4.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="346" Width="300" Name="UI">

    <Grid DataContext="{Binding ElementName=UI}">
        <ItemsControl ItemsSource="{Binding BNumbers}" Margin="0,29,0,0">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border Margin="1" BorderBrush="Black" BorderThickness="1" CornerRadius="2">
                         <Label Content="{Binding}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"  />
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <UniformGrid Columns="5" Rows="5"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
        </ItemsControl>
        <Button Content="New" Height="23" HorizontalAlignment="Left" Name="button1" VerticalAlignment="Top" Width="75" Click="button1_Click" />
    </Grid>
 </Window> 
```

代码：

```
public partial class MainWindow : Window, INotifyPropertyChanged
{
    public List<string> AllNumbers { get; set; }
    private List<string> _bnumbers = new List<string>();

    public MainWindow()
    {
        InitializeComponent();
        AllNumbers = new List<string>();
        // Bingo game 75 numbers, 5x5 grid
        for (int i = 0; i < 75; i++)
        {
            AllNumbers.Add(i.ToString());
        }
    }

    public List<string> BNumbers
    {
        get { return _bnumbers; }
        set { _bnumbers = value; NotifyPropertyChanged("BNumbers"); }
    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        RandomizeList(AllNumbers);
        BNumbers = AllNumbers.Take(25).ToList();
    }

    private void RandomizeList<T>(IList<T> list)
    {
        Random rng = new Random();
        int n = list.Count;
        while (n > 1)
        {
            n--;
            int k = rng.Next(n + 1);
            T value = list[k];
            list[k] = list[n];
            list[n] = value;
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(string property)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(property));
        }
    }
} 
```

结果（“New”将生成一个新游戏）

![在此处输入图像描述](../Images/fc5ce7294fe69d823bd01d91cc0b1186.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T22:42:48.780

在构造函数中，您需要设置 DataContext：

```
this.DataContext = this; 
```

您还需要更改您的设置器以匹配属性名称 RandomBNumber ：

```
<Setter Property="Content" Value="{Binding RandomBNumber }"> 
```

# macos - 用于 C++ 的 Mac OSX sqlite api

> ID：14205366
> 
> 赞同：0
> 
> 时间：2013-01-07T22:39:29.913
> 
> 标签：macos, sqlite

我在 mac 上移植了一个 C# 程序，我正在做的组件具有操作数据库的功能。添加删除/更新记录等。在原始程序中有一个 s3db 文件，程序使用 System.Data.SQLite.dll 与数据库交互。

由于我正在研究 macox 并且我对它很陌生，所有后端都是用 C/C++ 编写的，我不确定 mac 必须为 sqllite 提供什么，

所以我的问题是：在 mac 中是否有用于 sqlite 的支持 api 的构建？或者我是否需要使用单独的 sqlite C/C++ lib 或 mac 已经提供了我可以使用的东西？可以在 mac osx 上发布 s3db 还是在 mac 中创建 dbs 的任何现有内置方式？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:41:41.143

Mac OS X 自带 sqlite 3：

```
$ ls -l /usr/lib/*sqlite*
lrwxr-xr-x  1 root  wheel       16 Aug 25 10:22 /usr/lib/libsqlite3.0.dylib@ -> libsqlite3.dylib
-rwxr-xr-x  1 root  wheel  2216304 Sep 18 19:16 /usr/lib/libsqlite3.dylib*
lrwxr-xr-x  1 root  wheel       27 Aug 25 10:29 /usr/lib/sqlite3@ -> /System/Library/Tcl/sqlite3

$ ls -l /usr/include/*sqlite*
-rw-r--r--  1 root  wheel  336911 Oct 23 10:24 /usr/include/sqlite3.h
-rw-r--r--  1 root  wheel   24158 Oct 23 10:24 /usr/include/sqlite3ext.h 
```

# scala - 找到单位：必需的 Int。为什么错误不明显？

> ID：14205367
> 
> 赞同：27
> 
> 时间：2013-01-07T22:39:34.567
> 
> 标签：scala

我有一个应该返回 Int 的方法。我试图理解为什么 Eclipse 不会让我编译它，即使在 if 语句中我看起来很明显我确实返回了一个 Int。有什么我很明显的遗漏吗？在继续编写更多代码之前，我试图了解 Scala 的这一方面。

这是方法：

```
def contains1(sfType: TokenType): Int = {
     if (Tokens.KEYWORDS.contains(sfType)) {
      val retVal = TokenTypes.RESERVED_WORD
    }
  } 
```

Eclipse 在第 2 行抱怨 --- '类型不匹配; 找到：所需单位：Int"

```
TokenTypes is - public abstract interface org.fife.ui.rsyntaxtextarea.TokenTypes and RESERVED_WORD is - public static final int RESERVED_WORD = 6; 
```

我在这里读过这篇文章：[发现：所需单位：Int - 如何纠正这个？](https://stackoverflow.com/questions/10753542/found-unit-required-int-how-to-correct-this?rq=1)并试图在发布之前解决问题，但我仍然不知所措。

编辑：该方法应该返回一个 Int 并且我输入了错误的返回类型。我的问题还是一样。Eclipse 仍然抱怨。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2013-01-09T02:30:53.843

I'll first explain what type `Unit` is, just in case. Even if you know already, other people having the same kind of problem might well not know it.

Type `Unit` is similar to what is known in C or Java as `void`. In those languages, that means *"this does not return anything"*. However, *every method in Scala returns a value*.

To bridge the gap between every method returning something and not having anything useful to return, there's `Unit`. This type is an `AnyVal`, which means it isn't allocated on the heap, unless it gets boxed or is the type of a field on an object. Furthermore, it has only *one* value, whose literal is `()`. That is, you could write this:

```
val x: Unit = () 
```

The practical effect of this is that, when a method "returns" `Unit`, the compiler doesn't have to actually return any value, since it already knows what that value is. Therefore, it can implement methods returning `Unit` by declaring them, on the bytecode level, as being `void`.

Anyway, if you don't want to return anything, you return `Unit`.

Now let's look at the code given. Eclipse says it returns `Unit`, and, in fact, Eclipse is correct. However, most people would actually make the error of having that method return `AnyVal` or `Any`, not `Unit`. See the following snippet for an example:

```
scala> if (true) 2
res0: AnyVal = 2 
```

So, what happened? Well, when Scala finds an `if` statement, it has to figure out what is the type returned by it (in Scala, `if` statements return values as well). Consider the following hypothetical line:

```
if (flag) x else y 
```

Clearly, the returned value will be either `x` or `y`, so the type must be such that both `x` and `y` will fit. One such type is `Any`, since *everything* has type `Any`. If both `x` and `y` were of the same type -- say, `Int` -- then that would also be a valid return type. Since Scala picks the most specific type, it would pick `Int` over `Any`.

Now, what happens when you *don't* have an `else` statement? Even in the absence of an `else` statement, the condition may be false -- otherwise, there would be no point in using `if`. What Scala does, in this case, is to *add an `else` statement*. That is, it rewrites that `if` statement like this:

```
if (true) 2 else () 
```

Like I said before: if you do not have anything to return, return `Unit`! That is exactly what happens. Since both `Int` and `Unit` are `AnyVal`, and given that `AnyVal` is more specific than `Any`, that line returns `AnyVal`.

So far I have explained what others *might* have seen, but not what happens in that specific code in the question:

```
if (Tokens.KEYWORDS.contains(sfType)) {
  val retVal = TokenTypes.RESERVED_WORD
} 
```

We have seen already that Scala will rewrite it like this:

```
if (Tokens.KEYWORDS.contains(sfType)) {
  val retVal = TokenTypes.RESERVED_WORD
} else () 
```

We have *also* seen that Scala will pick the most specific type between the two possible results. Finally, Eclipse tells use that the return type is `Unit`, so the only possible explanation is that the type of this:

```
 val retVal = TokenTypes.RESERVED_WORD 
```

is also `Unit`. And that's precisely correct: statements that declare things in Scala have type `Unit`. And, so, by the way, do assignments.

The solution, as others have pointed out, is to remove the assignment and add an `else` statement also returning an `Int`:

```
def contains1(sfType: TokenType): Int =
  if (Tokens.KEYWORDS.contains(sfType)) TokenTypes.RESERVED_WORD
  else -1 
```

(note: I have reformatted the method to follow the coding style more common among Scala programmers)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-07T22:47:05.980

我有一种感觉你需要改变你的方法看起来像以下之一

```
def contains1(sfType: TokeType): Int = {
  if (Tokens.KEYWORDS.contains(sfType))
    TokenTypes.RESERVED_WORD
  else 
    -1
}

def contains1(sfType: TokenType) = if (Tokens.KEYWORDS.contains(sfType)) TokenTypes.RESERVED_WORD else -1 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-07T22:46:36.730

在 scala 中没有单一的`if`语句

由于每个表达式在求值时都必须返回一个值（它可以是一个空值，`Unit`类型为超类型。`if``else`

在您的代码中，您`Int`从`if`分支返回 a ，但`else`缺少该分支。

### 更新

正如其他答案中正确说明的那样：

单个`if`表达式返回其中唯一的替代方案，对于原始帖子，它是赋值的返回值，它是`()`类型`Unit`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-09T02:39:27.057

Eclipse 认为如果“if”块为假，即`Tokens.KEYWORDS.contains(sfType)`is `false`，那么返回类型确实是`Unit`，这就是问题所在。

# android - Android：创建 FIFO 数据存储的最简单方法？

> ID：14205368
> 
> 赞同：0
> 
> 时间：2013-01-07T22:39:38.810
> 
> 标签：android, data-storage

我想以以下格式存储数据：

```
file_name(string) | full_path(string) | file_type(string) 
```

除了具有这种格式之外，我还希望这种存储能够通过 FIFO 方法工作：插入新行“在”所有其他行之前。

我考虑过使用普通文件，但我不确定如何在不使用“id”列的情况下实现 FIFO 方法（以确定哪个先出现）。

有没有不使用数据库的简单方法来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:45:25.060

如果您担心数据库的“过度杀伤力”并使用文件来使事情“更轻松”，那就不要了。归根结底，SQLite 是一个单一的文件，轻巧且经过优化，您要做的就是创建自己的“数据库”，存储在一个文件中。

创建一个 SQLlite 数据库，这在 android 中是微不足道的，并且您有免费的 FIFO，标准插入将结束，检索您可以获得您想要的组合 ORDER BY、DESC 和 LIMIT 以满足您的需求。是一个单一的、简单的 SQL SELECT 语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T22:58:07.477

您说“FIFO 方法：插入新行在所有其他行之前”。

你是说后进先出法吗？如果您打算在所有其他行之前添加一些东西（并在所有其他行之前处理它），那么它就是 LIFO 。

第二个问题。你需要坚持吗？如果你不这样做，数据库将是巨大的矫枉过正。您需要做的就是拥有[Stack](http://docs.oracle.com/javase/6/docs/api/java/util/Stack.html)类的对象。

# macos - 如何在 OS X 10.8.2 上安装 rmagic 2.13.1 和 imagemagick

> ID：14205369
> 
> 赞同：3
> 
> 时间：2013-01-07T22:39:50.213
> 
> 标签：macos, imagemagick, rmagick

我已经阅读了很多帖子，似乎在 OS X 上安装 rmagick gem 时遇到了问题，但是为 MagickCore 设置 PATH 变量的解决方案似乎都不适合我。尝试安装 gem 时，我不断提出相同的堆栈跟踪。

这是我每次都得到的，我不知道如何克服它。

```
Installing rmagick (2.13.1) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        /Users/mwallace/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb 
checking for Ruby version >= 1.8.5... yes
extconf.rb:128: Use RbConfig instead of obsolete and deprecated Config.
checking for clang... yes
checking for Magick-config... yes
checking for ImageMagick version >= 6.4.9... yes
checking for HDRI disabled version of ImageMagick... yes
Package MagickCore was not found in the pkg-config search path.
Perhaps you should add the directory containing `MagickCore.pc'
to the PKG_CONFIG_PATH environment variable
No package 'MagickCore' found
Package MagickCore was not found in the pkg-config search path.
Perhaps you should add the directory containing `MagickCore.pc'
to the PKG_CONFIG_PATH environment variable
No package 'MagickCore' found
Package MagickCore was not found in the pkg-config search path.
Perhaps you should add the directory containing `MagickCore.pc'
to the PKG_CONFIG_PATH environment variable
No package 'MagickCore' found
Package MagickCore was not found in the pkg-config search path.
Perhaps you should add the directory containing `MagickCore.pc'
to the PKG_CONFIG_PATH environment variable
No package 'MagickCore' found
checking for stdint.h... yes
checking for sys/types.h... yes
checking for wand/MagickWand.h... yes
checking for InitializeMagick() in -lMagickCore... no
checking for InitializeMagick() in -lMagick... no
checking for InitializeMagick() in -lMagick++... no
Can't install RMagick 2.13.1\. Can't find the ImageMagick library or one of the dependent libraries. Check the mkmf.log file for more detailed information.

*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --without-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/Users/mwallace/.rvm/rubies/ruby-1.9.3-p194/bin/ruby
    --with-MagickCorelib
    --without-MagickCorelib
    --with-Magicklib
    --without-Magicklib
    --with-Magick++lib
    --without-Magick++lib

Gem files will remain installed in /Users/mwallace/.rvm/gems/ruby-1.9.3-p194@recruittalk/gems/rmagick-2.13.1 for inspection.
Results logged to /Users/mwallace/.rvm/gems/ruby-1.9.3-p194@recruittalk/gems/rmagick-2.13.1/ext/RMagick/gem_make.out
An error occurred while installing rmagick (2.13.1), and Bundler cannot continue.
Make sure that `gem install rmagick -v '2.13.1'` succeeds before bundling. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T11:25:14.257

我建议切换到 mini_magick gem。您可以获得 ImageMagick 提供的所有功能，但安装更容易，内存占用量也更低。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T00:27:35.243

我有同样的问题。我需要说，虽然我对 Ruby、Rails、Homebrew（以及 Unix 文件结构）还是很陌生……但是……

我怀疑一旦你解决了 PKG_CONFIG_PATH 问题，你就会有另一个问题。我将提出一个可能适用于第一个也可能不适用的快速建议，然后解释我为第二个做了什么。

首先，我在某处发现了将其添加到 .bashrc 的建议：PKG_CONFIG_PATH="/usr/local/lib/pkgconfig"。几个小时前我这样做了，它可能为我解决了第一个问题。不过具体我记不太清了。

其次，我认为 imagemagick 6.8 版已经弃用了这些所需的方法：

```
checking for InitializeMagick() in -lMagickCore... no
checking for InitializeMagick() in -lMagick... no
checking for InitializeMagick() in -lMagick++... no 
```

所以早期版本仍然会有它们。我按照此处的说明（http://wearepandr.com/blog/article/homebrew-and-installing-old-package-versions）安装了旧版本的软件包。卸载 imagemagick，在 /usr/local/Library/Formula/ 中运行建议的命令，然后重新安装 imagemagick，我能够成功安装 rmagick gem。我随机选择了 6.7.1-1 种。

我真的认为有人应该更新 rmagick 以反映对其依赖项的更改（它已经过时了一两年）。但我自己还不够了解。

# javascript - javascript中的图像尺寸

> ID：14205373
> 
> 赞同：1
> 
> 时间：2013-01-07T22:40:08.167
> 
> 标签：javascript, mootools

我正在尝试使用 javascript 获取图像的尺寸——Mootools 是加载的库。

但是，即使我没有问题地获取图像元素，并且在元素的属性中看到有效的宽度和高度，但当我尝试访问该属性时，高度值始终返回为 0。

为什么？

```
window.addEvent("domready", function(){
    var thisImg = $$("img.myimgclass");

    console.dir(thisImg[0]); // prints all image data, including width AND height values

    var height = thisImg[0].height;
    var width = thisImg[0].width;

    console.log(height); // prints 0 even though thisImg shows a valid height set
    console.log(width); // prints valid width

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:42:40.803

您正在阅读标签的`height`和`width` *属性*，`img`这些属性可能未设置，但很难说，因为您没有包含 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T22:43:53.967

尝试 image.naturalHeight 和 image.naturalWidth 来获得实际大小..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T22:45:18.470

您需要在窗口加载事件中调用您的代码，因为即使构建了 dom 也不意味着图像已加载。控制台显示活动对象，也就是说，当您查看控制台时，图像已加载，但在记录时尚未加载。

# ruby - 为什么我在使用这个 Ruby 模块时会出现 NoMethodError？

> ID：14205375
> 
> 赞同：0
> 
> 时间：2013-01-07T22:40:12.830
> 
> 标签：ruby, module, worker

我正在编写一个分布式系统，其中一个工作人员执行一些工作，为了启动工作人员，启动了一个`init.rb`加载`lib`文件夹并执行一些配置的工作人员。

### 结构

```
init.rb
lib
|-- modulename
|   |-- foo.rb
|   |-- configuration.rb
|   `-- worker.rb
`-- modulename.rb 
```

### 初始化.rb

```
$LOAD_PATH.unshift(File.expand_path("../lib", __FILE__))

require "bundler/setup"
require "modulename"

ModuleName.configure do |c|
    c.log       = "module.log"
    c.pool_size = 10
end 
```

### 模块名.rb

```
require "sidekiq"

require "modulename/foo"
require "modulename/configuration"
require "modulename/worker"

module ModuleName
    def self.config
        @config ||= Configuration.new
    end

    def self.configure
        yield(config)
    end
end 
```

### 工人.rb

```
module ModuleName
    class Worker
        include Sidekiq::Worker

        REDIS_POOL = ConnectionPool.new(:size => ModuleName.config.pool_size, :timeout => 3) { Redis.new }

        def dosomething
            # ...
        end
    end
end 
```

如果我现在运行，`ruby init.rb`我会得到一个 NoMethodError：`<class:Worker>: undefined method config for ModuleName:Module (NoMethodError)`

我真的不明白为什么，请给我一个提示如何解决这个问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:52:32.167

在 modulename.rb 中，您需要 worker.rb，因此 ruby​​ 启动并运行该文件中的代码，包括您设置的位 `REDIS_POOL`，它试图调用`Modulename.config`

`Modulename.config`尚未定义（您只在 modulename.rb 的底部这样做，因此会出现错误。

您可能只想懒惰地创建 redis 池，或者至少在配置更新之后。

# c++ - 为 C++ 设置 Eclipse

> ID：14205382
> 
> 赞同：1
> 
> 时间：2013-01-07T22:40:39.273
> 
> 标签：c++, compilation, cygwin, header-files

我正在尝试设置 eclipse 以编译和运行 C++ 应用程序。我正在使用 cygwing 并将其添加到 Eclipse 的 PATH 中。我使用默认的 Hello World 应用程序创建了一个新项目。

```
#include "TryingCompile.h"
#include <iostream>
using namespace std;

TryingCompile::TryingCompile() {
    // TODO Auto-generated constructor stub

}

TryingCompile::~TryingCompile() {
    // TODO Auto-generated destructor stub
}

int main() {
    cout << "!!!Hello World!!!" << endl; // prints !!!Hello World!!!
    int value;
    cin>> value;
    cout << value;
    return 0;
} 
```

默认情况下没有提供头文件，但是它编译了但没有产生输出。然后我添加了头文件。

```
#ifndef TRYINGCOMPILE_H_
#define TRYINGCOMPILE_H_

class TryingCompile {
public:
    TryingCompile();
    virtual ~TryingCompile();
};

#endif /* TRYINGCOMPILE_H_ */ 
```

它编译但没有输出。购买的方式，二进制文件已经创建。这是我第一次为 C++ 设置 Eclipse。顺便说一句，当您在 Windows cmd 窗口中输入“g++ -v”测试 cygwin 的安装时，它无法识别该命令。但是一旦你直接运行 cygwin，它就会产生安装细节。那有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:48:45.017

没有输出意味着它没有抱怨，所以一切都很顺利。

也许您必须通过在 shell 中运行二进制文件来执行它？

# svn - svn 删除所有同名子目录

> ID：14205395
> 
> 赞同：0
> 
> 时间：2013-01-07T22:41:43.207
> 
> 标签：svn

我不小心将存储在 CVS 中的代码签入到 SVN，而没有删除 CVS 文件夹。我如何svn同时删除它们？查找 -name "DIRNAME"-exec rm -rf {} \; 将仅在本地删除 DIRS。

任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:50:19.350

[`svn delete`](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.delete.html)使用而不是执行相同的命令`rm -rf`，然后提交。

# javascript - RequireJS 随机中断

> ID：14205400
> 
> 赞同：1
> 
> 时间：2013-01-07T22:42:27.417
> 
> 标签：javascript, jquery, jquery-mobile, backbone.js, requirejs

我正在尝试使用 Jquery Mobile、Backbone 和 RequireJS 创建一个站点。但我遇到的问题是网站随机中断以及中断不同的原因：

*   JQuery 未定义
*   主干未定义
*   未定义主干的扩展视图
*   等等等等

而且我无法确定我们的原因，因为它有时会起作用，但是当我刷新它时，它突然不起作用。我正在像这样加载我的代码（库后跟视图）：

```
requirejs(["/js/libs/jquery-1.8.3.min", "/js/libs/jquery.mobile-1.2.0.min", "/js/libs/underscore-1.4.3", "/js/libs/json2", "/js/libs/backbone.0.9.9"], function($,JQM, underscore, json2, bb) {

});

requirejs(["/js/views/pageview", '/js/views/home'], function(util) {

    HomeView = new HomeView({el : '#home', 'id' : 'home'})
}); 
```

我这样做是不是做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T22:46:48.667

jQuery Mobile、Backbone 和 Underscore 等库不是 AMD 模块，只是普通的旧 javascript 文件。而且因为它们不是模块，它们不声明依赖关系，它们只是希望在全局范围内找到`$`或。`_`

RequireJS 的加载顺序是不确定的——所以不知道哪个会先加载。如果首先评估 Backbone，它将找不到`window._`它正在寻找的并崩溃。

[RequireJS 通过 shim 配置（请参阅文档](http://www.requirejs.org/docs/api.html#config-shim)）支持非 AMD 模块，它允许您声明这些库之间的依赖关系。配置 shim 后，RequireJS 知道如何在依赖库之前加载依赖库。

带有 shim 元素的典型 RequireJS 配置如下所示：

```
requirejs.config({
  //libraries
  paths: {
      jquery:       'libs/jquery/jquery',
      backbone:     'libs/backbone/backbone',
      underscore:   'libs/underscore/underscore',
      jquerymobile: 'libs/jquery.mobile-1.2.0/jquery.mobile-1.2.0',
  },

  //shimming enables loading non-AMD modules
  //define dependencies and an export object
  shim: {
      jquerymobile: {
          deps: ['jquery'],
          exports: 'jQuery.mobile'
      },
      underscore: {
          exports: '_'
      },
      backbone: {
          deps: ['jquerymobile', 'jquery', 'underscore'],
          exports: 'Backbone'
      }
  }
}); 
```

该`paths`部分不是强制性的，您可以只使用文件路径作为该`shim`部分中的键。但是，当您使用`paths`别名时，您可以使用短名称而不是整个路径导入这些库：

```
define(['jquery', 'backbone'], function($, Backbone) { ... }); 
```

# laravel - Laravel 4：Asset::add 的替代品是什么？

> ID：14205404
> 
> 赞同：38
> 
> 时间：2013-01-07T22:42:37.633
> 
> 标签：laravel, laravel-4

你如何在新的 Laravel 4 中管理资产？看起来 Taylor Otwell 已经`Asset::add`用新的东西代替了。

我想做的是让 Laravel 添加我的 CSS 和 JS 文件。在 Laravel 3 中有几种方法可以做到这一点，但现在它们似乎已经消失了。一个是`Asset::add`，另一个是`HTML`。这些的替代品是什么？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-05-30T13:26:29.550

在 Laravel 4 中，您可以使用`HTML`该类，它默认包含在 Laravel 框架包中：

样式表：

```
{{ HTML::style('css/style.css') }} 
```

Javascript：

```
{{ HTML::script('js/default.js') }} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-05-03T13:21:33.450

我使用助手：

```
<script src="{{ asset('js/jquery-1.9.1.js') }}"></script>
<script src="{{ asset('js/bootstrap.min.js') }}"></script> 
```

也可以看看

```
vendor/laravel/framework/src/Illuminate/Support/helpers.php 
```

还有许多其他的助手，例如 app_path()、各种数组工具、link_to_route()、link_to_action()、storage_path() 等。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-06-21T19:29:55.337

Laravel 4 没有开箱即用的资产管理。但是已经创建了一些包来处理这种事情。

*   [codeleeve/asset-pipeline](https://packagist.org/packages/codesleeve/asset-pipeline)（到目前为止我最喜欢的）

*   jasonlewis/basset（有一些错误）

*   teepluss/asset（最接近 Laravel 3 Asset::add() 但不进行连接或缩小）

*   way/guard-laravel (需要 ruby​​ guard gem 来运行)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-06-11T09:29:51.590

当我只需要将一些 .css 和 .js 文件附加到特定页面时，我就是这样做的：

在我的刀片模板中：

```
<head>
<title>.....</title>
.....
@yield('head')
</head> 
```

在我的特定页面刀片文件中：

```
@extends('template')
    @section('head')
    {{ HTML::style('css/filename.css') }}
    {{ HTML::script('js/filename.js') }}
    @stop
... 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-01-08T23:59:45.977

Basset（前最佳资产）呢？： http: [//jasonlewis.me/code/basset](http://jasonlewis.me/code/basset)

我刚刚将它安装在 L4 上，仍然没有进行任何测试，但听起来很有希望。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-03T16:29:48.700

Laravel 3 的 Asset 类的一个端口。与 Laravel 4 一起工作。

[https://github.com/teepluss/laravel4-asset.git](https://github.com/teepluss/laravel4-asset.git)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-06-11T19:31:05.273

我制作了一个更简单的 Laravel 3 资产类版本，并在 Laravel 4 中完美运行。对我来说，这就是我所需要的！只需为容器选择一个名称并按最终顺序添加资产：

```
Asset::container('jq_1.10')->add('js/jquery-1.10.1.min.js')->add('css/css.css'); 
```

对于输出：

```
echo Asset::container('jq_1.10')->asset(); 
```

班上：

```
class Asset {
public static $containers = array();

public static function container($container = 'default')
{
    if ( ! isset(static::$containers[$container]))
    {
        static::$containers[$container] = new Asset_Container($container);
    }
    return static::$containers[$container];
}
}

class Asset_Container {
public $name;
public $assets = array();

public function __construct($name)
{
    $this->name = $name;
}
public function add($source)
{
    $type = (pathinfo($source, PATHINFO_EXTENSION) == 'css') ? 'style' : 'script';
    $obj = (object)array('type' => $type,'source' => $source);
    $this->assets[] = $obj;
    return $this;
}
public function asset()
{
    $str = '';
    foreach($this->assets as $aset){
        if($aset->type == 'style')$str .= HTML::style($aset->source);
        else $str .= HTML::script($aset->source);
    }
    return $str;
}
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-10-15T00:25:54.247

如果你使用它会出错：

```
{{ HTML::style('assets/css/style.css') }} 
```

因为 Laravel 将 Laravel Base Aliases 更改`HTML`为`Html`. 如果您遇到错误，我使用下面的代码来代替。

风格：

```
{{ Html::style('assets/css/style.css') }} 
```

脚本：

```
{{ Html::script('assets/css/style.css') }} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-09T01:29:39.907

我知道它已经得到了回答，但是 Orchestra 的资产包与 Laravel 3 使用的资产库相同。甚至可能是同一个包。这是我用的。

[https://github.com/orchestral/asset](https://github.com/orchestral/asset)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-08T09:39:10.263

这些在 Laravel 4 中不存在 - 我认为这个想法是使用 Composer 捆绑包来添加它们。

[Meido 创建了一个从 Laravel 3 到 Laravel 4 的 HTML、Form 和 Str 类的“端口”。](https://github.com/meido)

我不知道资产端口 - 我认为您应该查看 Composer 上已有的捆绑包，以找到适合您需求的包。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-08-18T18:47:06.940

我只是使用：

```
{{ asset('js/jquery.min.js') }} 
```

适用于所有类型的文件。请注意，它只返回 URL，不返回 HTML 标记和内容。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-08T13:21:31.040

在我看来，最好的方法是使用**URL::asset()**方法。

例如：

**CSS**

```
<link rel="stylesheet" href="{{URL::asset('css/style.css')}}" media="screen" /> 
```

或者

**JS**

```
<script type="text/javascript" src="{{URL::asset('js/scripts.js')}}"></script> 
```

您还可以将它与图像以及位于公共文件夹中的任何资产一起使用。

**即**： `<img scr="{{URL::asset('img/image.jpg')}}}} id="someid">`

通过使用这种方法，我发现更容易组织和分离我的 HTML 标记与 Laravel 方法。

假设我想指定一个使用 media="print" 属性加载的 css 文件，“Laravel”的执行方式如下：

```
{{HTML::style("print.css", array('media' => 'print'))}} 
```

而使用 {{URL::asset()}} 方法的传统方式对前端开发人员（您可能在团队项目中使用）更全面且更易于访问。

```
 <link rel="stylesheet" href="{{URL::asset('css/style.css')}}" media="print" /> 
```

您可能会说差异很小，但在处理大量标记属性（“ids、data-attributes、classes custom-attributes”）时，HTML::style()、HTML::image()、HTML:: link() 方法可能会很长，并且对于 html/css/js 开发人员来说不全面。

这一切都各不相同，取决​​于开发人员的编码风格，但在我看来，标记应尽可能保持“原始”，以便前端开发人员更容易访问。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-01-01T04:26:35.317

或者，您可以使用 Grunt.js 来管理您的资产。

Grunt 基本上是一个运行“任务”的插件库，例如：

*   编译 LESS
*   合并JS文件
*   缩小 JS 文件
*   更多……

完全独立于 PHP。

# jquery - Rails AJAX 表单提交未正确传递参数

> ID：14205408
> 
> 赞同：0
> 
> 时间：2013-01-07T22:42:48.413
> 
> 标签：jquery, ruby-on-rails, forms

因此，在我的 Rails 应用程序中，我有一个大表单，在单击“保存”按钮时提交，但我们还希望在他们使用 ajax 单击表单上的其他部分时定期保存。所以我设置了一个将表单作为 AJAX 请求提交的方法。

```
var $frm = $(form);
$frm.unbind('submit').submit(function() {
  $.ajax({
    type: $frm.attr('method'),
    url: $frm.attr('action'),
    data: $frm.serialize(),
    success: function (data) {
       // Errors out in Server side and does not succeed
    }
  });
  return false;
});
$frm.submit(); 
```

不幸的是，这在其他形式中也有效，但这种形式有点复杂，并且传递了一个对象数组，以下是我得到的错误：

```
!! Unexpected error while processing request: expected Hash (got String) for param `selected' 
```

有谁知道如何使用 ajax 提交 Rails 表单，在其中传递诸如 users[] 之类的项目数组而不会出现此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-23T03:49:27.093

请检查您的表格。这是因为有相同的名称，例如：

```
input type="text" name="user[email]" id="user_email"
input type="checkbox" name="user" value="1" 
```

处理请求时出现意外错误：参数“selected”的预期哈希（获取字符串）

文本和复选框具有相同的名称 => “用户”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-23T09:26:40.797

这不是这个问题的答案，但在某些情况下，当您有起始索引为 0 的数据数组时会发生这种情况： null [ , {data:1}, {data:2}]

前导索引 0 可能导致相同的错误

# iphone - 来自字符串的 NSDate 给出错误的结果

> ID：14205410
> 
> 赞同：2
> 
> 时间：2013-01-07T22:42:57.470
> 
> 标签：iphone, objective-c, ios, ipad

我正在尝试将字符串转换为 NSDate 对象。我正在使用以下代码进行转换：

```
NSDateFormatter * dateFormat = [[NSDateFormatter alloc] init];
NSTimeZone *tz = [NSTimeZone timeZoneWithAbbreviation:@"GMT"];
[dateFormat setDateFormat:@"M/d/yyyy HH:mm:ss a"];
[dateFormat setTimeZone:tz];

NSDate * dtEventStart = [dateFormat dateFromString:@"1/7/2013 6:30:00 AM"];
NSDate * dtEventEnd = [dateFormat dateFromString:@"1/7/2013 8:45:00 PM"];

NSLog(@"dtEventStart: %@", dtEventStart);
NSLog(@"dtEventEnd: %@", dtEventEnd); 
```

但是，输出如下所示：

```
dtEventStart: 2013-01-07 00:30:00 +0000
dtEventEnd: 2013-01-07 12:45:00 +0000 
```

输出时间和日期与用于转换的字符串不同。我也尝试将 EST 用于 timeZone，但会产生不同的错误结果，如下所示：

```
dtEventStart: 2013-01-07 05:30:00 +0000
dtEventEnd: 2013-01-07 17:45:00 +0000 
```

我知道我错过了一些东西，但我不知道是什么。任何帮助是极大的赞赏。

谢谢

更新：

这是

```
EKEventStore *eventStore = [[EKEventStore alloc] init];

EKEvent * eventForCalendar  = [EKEvent eventWithEventStore:eventStore];
eventForCalendar.title     = event.title;

NSDateFormatter * dateFormat = [[NSDateFormatter alloc] init];
NSTimeZone *tz = [NSTimeZone timeZoneWithAbbreviation:@"EST"];
[dateFormat setDateFormat:@"M/d/yyyy HH:mm:ss a"];
[dateFormat setTimeZone:tz];

NSDate * dtEventStart = [dateFormat dateFromString:@"1/7/2013 6:30:00 AM"];
NSDate * dtEventEnd = [dateFormat dateFromString:@"1/7/2013 8:45:00 PM"];

NSLog(@"dtEventStart: %@", dtEventStart);
NSLog(@"dtEventEnd: %@", dtEventEnd);

eventForCalendar.startDate = dtEventStart;
eventForCalendar.endDate = dtEventEnd;

[eventForCalendar setCalendar:[eventStore defaultCalendarForNewEvents]];
NSError *err;
[eventStore saveEvent:eventForCalendar span:EKSpanThisEvent error:&err]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T09:01:26.110

Try following code:-

```
NSDateFormatter * dateFormat = [[NSDateFormatter alloc] init];
[dateFormat setDateFormat:@"MM/dd/yyyy hh:mm:ss a"];
[dateFormat setTimeZone:[NSTimeZone timeZoneWithName:@"UTC"]];

NSDate * dtEventStart = [dateFormat dateFromString:@"1/7/2013 6:30:00 AM"];
NSDate * dtEventEnd = [dateFormat dateFromString:@"1/7/2013 8:45:00 PM"];

NSLog(@"dtEventStart: %@", dtEventStart);
NSLog(@"dtEventEnd: %@", dtEventEnd); 
```

You will get following output with 24 hours format:-

```
dtEventStart: 2013-01-07 06:30:00 +0000
dtEventEnd: 2013-01-07 20:45:00 +0000 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:57:33.647

对于解析，文档建议首先将日期格式化程序的*语言环境设置*为 en_US_POSIX：

[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html#//apple_ref/doc/uid/TP40002369-SW7](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html#//apple_ref/doc/uid/TP40002369-SW7)

此外，这个关于日期格式化程序的问答：

[http://developer.apple.com/library/ios/#qa/qa1480/_index.html](http://developer.apple.com/library/ios/#qa/qa1480/_index.html)

> 我正在使用 NSDateFormatter 来解析 Internet 样式的日期，但这对于某些地区的某些用户来说失败了。我已经设置了一个特定的日期格式字符串；这不应该强制 NSDateFormatter 独立于用户的区域设置工作吗？
> 
> 不可以。虽然设置日期格式字符串似乎适用于大多数用户，但这并不是解决此问题的正确方法。格式字符串在许多地方以意想不到的方式表现。例如：

# gwt - 如何确定在 GWT MVP 中使用缓存的活动？

> ID：14205412
> 
> 赞同：-1
> 
> 时间：2013-01-07T22:43:08.863
> 
> 标签：gwt, caching, android-activity, gwt-mvp

我有一个具有 MVP 模式的 GWT 应用程序。

我在一个页面中有两个视图。过滤器和结果视图。

当我选择任何过滤器时，我调用 goto() 去当前位置。这在功能上工作正常。但它也重写了过滤器视图。我不希望重新编写过滤器视图，因为我正在调用 goto() 去同一个地方。

我正在使用缓存活动映射器。如何使用最新的活动而不重写视图？

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:44:05.030

经过这么多调试，我观察到以下情况：在CachingActivityMapper->getActivity()中，equals方法一直返回false。

所以我试图在我的 place 类中覆盖 equals 方法。但是，由于在其他一些地方似乎调用了 equals 方法，所以它不起作用。

最后我创建了自己的 CachingActivtyManager，其中的 getActivity() 方法调用了我自己的 isEqual() 方法。它按预期工作。

谢谢。

# jquery - 如何通过 jquery GET 传递参数 mvc

> ID：14205414
> 
> 赞同：1
> 
> 时间：2013-01-07T22:43:18.377
> 
> 标签：jquery, asp.net-mvc-3

我正在尝试像这样将值传递给 Url.Action

```
 $('._select_change').change(function(n)
     {
         var param = n.target.value;

         $.get('@Url.Action("List", new { someid = param } )', function (data) {
             $('#changeArea').replaceWith(data);
         });

     }); 
```

如果我设置 someid = '123'，那么该值可以很好地进行。但是，当我替换为 someid = param - 我得到一个编译器错误“CS0103：当前上下文中不存在名称'param'”......

我应该如何构造这个方法调用？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:45:46.777

> 我应该如何构造这个方法调用？

像这样：

```
$('._select_change').change(function() {
    var param = $(this).val();
    $.get('@Url.Action("List")', { someid: param }, function (data) {
         $('#changeArea').replaceWith(data);
    });
}); 
```

请注意我如何使用该`$.get()`方法的第二个参数将查询字符串参数从客户端传递给 AJAX 调用。

这会将下拉列表的选定值传递给采用`someid`action 参数的 List 控制器操作：

```
public ActionResult List(string someid) 
{
    ...
} 
```

因此，您将在 javascript 调试工具的 Net 选项卡中看到以下 AJAX 请求正在发送到服务器：

```
GET /somecontroller/List?someid=123 
```

`$.get()`但是，如果您使用这种方法，您应该注意一件事。GET 请求通常由浏览器缓存。这意味着如果您向同一个 url 发送许多请求，例如`/list?someid=123`浏览器可以缓存结果，并且只有第一个请求会到达服务器。但是，如果您想每次都提供*新数据并且想为每个请求访问服务器怎么办。*在这种情况下，推荐的解决方案是使用`$.ajax()`允许您禁用缓存的方法：

```
$('._select_change').change(function() {
    var param = $(this).val();
    $.ajax({
        url: '@Url.Action("List")',
        data: { someid: param },
        cache: false,
        success: function (data) { 
            $('#changeArea').replaceWith(data);
        }
    });
}); 
```

这将在每个请求上附加一个随机查询字符串参数，以确保结果不被客户端浏览器缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T22:46:58.923

```
$.ajax({
            url: YourURL,
            type: "post",
           data: $('form').serialize(), // one way of submitting full form
           data: { id: "your ID", name: "your name" }, // if you have less parameters use this 
            success: function (data) {
                // handle it

            },
            error: function (data) {
                // handle your error
            },
            dataType: "JSON"
            //async:true
        }); 
```

# browser - 像从不同位置一样运行浏览器

> ID：14205415
> 
> 赞同：0
> 
> 时间：2013-01-07T22:43:23.813
> 
> 标签：browser

有时，当我尝试访问网络上的各种网站时，我会收到错误消息“您所在位置无法访问此页面”或“您所在位置无法访问此视频”

我知道有在不同时间运行程序的方法，那么有没有办法从“虚拟”位置运行程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:48:20.710

这些网站使用您的 ip 来确定您的位置，在您可以使用网站的特定区域使用代理服务器。但是这个问题应该在 superuser.com 上

# adapter - 我可以在 Z 中调整字符串和内置类型吗

> ID：14205417
> 
> 赞同：0
> 
> 时间：2013-01-07T22:43:36.567
> 
> 标签：adapter, zope, zope.interface

我有一个接口，如：

```
class IRepository(Interface):
    def __init__(path, **options):
        pass 
```

我为 Git 和 Mercurial 实现了这个接口。现在我想编写存储库工厂，它接受一个字符串（路径）并返回一个 IRepository，通过探测它是一个存储库`git`还是`hg`存储库。

然而，简单地说：

```
registerAdapter(repofactory, (str, unicode, ), IRepository) 
```

不起作用，导致既不`str`也不`unicode`支持该`IInterface`接口。

现在，我将使用：

```
registerAdapter(repofactory, (Interface, ), IRepository) 
```

但我想知道是否有只匹配字符串对象和其他 Python 内置类型的接口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T09:12:09.060

不，字符串和 unicode 对象不能有接口。但是对于这个用例，我会注册命名实用程序并按名称查找实用程序，或者列出所有可用的实用程序：

```
from zope.component import getUtilitiesFor, getUtility

names = [name for name, utility in getUtilitiesFor(IRepository)]

gitrepo = getUtility(IRepository, name='git') 
```

# php - 使用 php 从网络服务器上的画布缩放上传的图像

> ID：14205420
> 
> 赞同：1
> 
> 时间：2013-01-07T22:43:48.767
> 
> 标签：php, javascript, scale, fabricjs, imagecreatefrompng

我的问题是不仅要在我的数据库中将当前画布作为 JSON 对象上传，我还想从画布中保存缩略图。这是一种布局画廊。

几乎所有东西都在工作，除了特定大小的比例。我将本教程用于 PHP 函数`function scaleImg();` [Scale Image with PHP](http://oswaldatwork.thetaoofamp.com/2009/10/scaling-images-in-php-done-right/)

所以这是我上传脚本中的代码：

layoutupload.php

```
...
    //Save canvas as thumbnail

 //datafields
     $lt_dir = "../flyer/templateDATA/template_1_thumbs/";
     $lt_canvas_thumb = $_POST['lt_canvas_thumb'];

     //delete header
     $lt_canvas_thumb = str_replace('data:image/png;base64,','', $lt_canvas_thumb);
     $lt_canvas_thumb = str_replace(' ', '+', $lt_canvas_thumb);

     //decode to an image
     $img_data = base64_decode($lt_canvas_thumb);
     $file = $lt_dir.'tmp.png';

     //save in filesystem
     $success = file_put_contents($file, $img_data);
     print $success ? $file : 'Unable to save the file.';

     //scale img with helper class
     include "helper_scaleImg.php";
     scaleImg($file,100,141,'png'); // ($img,$width,$height,$type)
... 
```

这`var lt_canvas_thumb = canvas.toDataURL("image/png");`来自一个 JavaScript 函数
，我可以将图像保存在文件系统上，但只能使用原始画布尺寸 (370x522)。

这是用于缩放的 PHP 脚本

```
function scaleImg($img, $width, $height, $type){

//$type = exif_imagetype($img);
//Possible types
//IMAGETYPE_JPEG
//IMAGETYPE_PNG

if($type == 'jpg'){

    $source_image = imagecreatefromjpeg($img);

    // Get the size of img
    $source_imagex = imagesx($source_image); //width
    $source_imagey = imagesy($source_image); //height

    // destination image
    $dest_imagex = $width;
    $dest_imagey = $height;
    $dest_image = imagecreatetruecolor($dest_imagex, $dest_imagey);

    //best quality (slow)
    imagecopyresampled($dest_image, $source_image, 0, 0, 0, 0, 
            $dest_imagex, $dest_imagey, $source_imagex, $source_imagey);

    return imagejpeg($dest_image,NULL,100);

}
else if($type == 'png'){

    $source_image = imagecreatefrompng($img);

    if(!$source_image){
        // Get the size of img
        $source_imagex = imagesx($source_image); //width
        $source_imagey = imagesy($source_image); //height

        // destination image
        $dest_imagex = $width;
        $dest_imagey = $height;
        $dest_image = imagecreatetruecolor($dest_imagex, $dest_imagey);

        //best quality (slow)
        imagecopyresampled($dest_image, $source_image, 0, 0, 0, 0, 
                $dest_imagex, $dest_imagey, $source_imagex, $source_imagey);

        /* Output an error message */
        imagestring($source_image, 1, 5, 5, 'Error loading ' . $img);
    }

    return imagepng($dest_image,NULL,9);
    //return $dest_image;
}
else
{
    echo "Invalid image type!";
    exit;
} 
```

}

我收到以下错误消息：

> 数据：../flyer/templateDATA/template_1_thumbs/tmp.png
> **警告**：imagepng() 期望参数 1 是资源，在第**57**行的**/Applications/XAMPP/xamppfiles/htdocs/flyer/helper_scaleImg.php中给出了 null**

 **我不知道为什么它是“null”，因为文件已正确保存在我的目录中。
我希望这不是我的代码中的一个小错误，我希望有人可以帮助我。谢谢！问候马克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:49:54.910

`if(!$source_image)`如果源图像加载，则评估为 false，因此定义的代码块将`$dest_image`被跳过。**

# javascript - 如何在javascript中合并复杂对象？

> ID：14205423
> 
> 赞同：1
> 
> 时间：2013-01-07T22:44:00.257
> 
> 标签：javascript, jquery, object, merge, treeview

我有 3 个不同的对象（obj1,2,3），如下所示，我正在尝试形成 finalObj，它是 3 个对象的并集（唯一树列表）..

我不确定实现这一目标的最佳方法是什么。

编辑：文本是这里的关键。如果已经存在具有相同文本的父节点，我们只需忽略并移动到其子节点并检查该子节点是否存在，否则将该子节点附加到现有父节点等等......

```
var obj1 = [{
    text: "TreeRoot",
    items: [
        { text: "Subgroup1"},
        { text: "Subgroup2"}
    ]
}]

var obj2 = [{
    text: "TreeRoot",
    items: [
        { text: "Subgroup3"}
    ]
}]

var obj3 = [{
    text: "Subgroup3",
    items: [{
        text: "subgroup5",
        items: [{
            text: "subgroup6",
            items: [{
                text: "subgroup7",
                items: [{
                    text: "subgroup8"
                }]
            }]
        }]
    }]
}]

var finalObj = [{
    text: "TreeRoot",
    items: [
        { text: "Subgroup1"},
        { text: "Subgroup2"},
        {
            text: "Subgroup3",
            items: [{
                text: "subgroup5",
                items: [{
                    text: "subgroup6",
                    items: [{
                        text: "subgroup7",
                        items: [{
                            text: "subgroup8"
                        }]
                    }]
                }]
            }]
        }
    ]
}] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T00:38:44.403

```
var table = {}; // items by id
function recurse(items) {
    for (var i=0; i<items.length; i++) {
        var item = items[i],
            id = item.text;
        if (id in table) 
            table[id].items = (table[id].items && item.items)
              ? table[id].items.concat(item.items) // merge
              : table[id].items || item.items;
        else
            table[id] = item;
        if (item.items)
            recurse(item.items);
    }
}
recurse(obj1), recurse(obj2), recurse(obj3);

// assuming there are no cycles and only one parent per node in the graph
for (var text in table) (function recurse(text) {
    var items = table[text].items;
    if (!items) continue;
    for (var i=0; i<items.length; i++) {
        var id = items[i].text;
        if (id in table) {
            items[i] = table[id];
            recurse(id);
            delete table[id];
        }
    }
})(text);

// now, table consists only of the root keys (should be only one):
for (var id in table)
    var finalObj = table[id]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T00:50:31.970

这里的诀窍是以利用 javascript 对象的自然特征并促进合并的方式构造对象。

`obj1`,`obj2`和中的所有数组`obj3`都是多余的，因为它们每个都包含不超过一项。

与其使用属性`text`和构造对象`items`，不如使用文本作为键，将项目作为其属性，从而提供更紧凑的数据结构。

```
var obj1 = {
    "Subgroup1": null,
    "Subgroup2": null
};
var obj2 = {
    "Subgroup3": null
};
var obj3 = {
    "Subgroup3": {
        "subgroup5": {
            "subgroup6": {
                "subgroup7": {
                    "subgroup8": null
                }
            }
        }
    }
}; 
```

现在您可以使用 jQuery 的强大功能了`$.extend()`。

```
var finalObj = $.extend(true, {}, obj1, obj2, obj3); 
```

这使 ：

```
var finalObj = {
    "Subgroup1": null,
    "Subgroup2": null,
    "Subgroup3": {
        "subgroup5": {
            "subgroup6": {
                "subgroup7": {
                    "subgroup8": null
                }
            }
        }
    }
}; 
```

与您的原始文件相比，这是在*几乎*没有丢失信息的情况下实现的。发生的损失是 , , 的顺序，*它们*现在是数组中无序元素的无序属性。同样，如果在任何级别有多个子组，它们也将是无序的。`Subgroup1``Subgroup2``Subgroup3``finalObj`

*   如果你能忍受这种约束，那么上面的方法将为你省去很多心痛。
*   如果你不能忍受这个约束，那么，稍微考虑一下，仍然可以以正确的顺序提取子组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T20:40:22.540

不确定这是否是合并树对象的正确方法，但只是想得到您的反馈/建议......

我有一个递归函数，它根据 id 返回节点。我检查 parent id 和 child id ，如果 parent id 存在但找不到 child id 我将孩子添加到 parent。如果父ID不存在我创建一个新节点，如果孩子已经退出，我只是忽略那个孩子......

这样，我可以联合我的节点（通过循环）......欢迎提出建议！！！！

```
 var arrayObject=[];

            var ob =    {
                text: "root",
                id: 1,
                items: [
                    {
                        text: "child one",
                        id: 11,
                        items: [
                            {
                                text: "grand child 1",
                                id: 111,
                                items: []},
                            {
                                text: "grand child 2",
                                id: 112,
                                items: []}
                        ]},
                    {
                        text: "child two",
                        id: 12,
                        items: []}
                ]
            };

            function findObjectById(root, id) {
                if (root.items) {
                    for (var k in root.items) {
                        if (root.items[k].id == id) {
                            return root.items[k];
                        }
                        else if (root.items.length) {
                            return findObjectById(root.items[k], id);
                        }
                    }
                }
            };
            var newChild={
                text: "child x",
                id: 115,
                items: []
            };

            for(var i=0;i<2;i++){
                if(i==0){
                    var checkParent = findObjectById(ob, 11);
                    alert(JSON.stringify(checkParent));

                }else{
                    var checkParent = findObjectById(ob, 116);
                }
                if(checkParent) {
                    var checkChild=findObjectById(checkParent, newChild.id);
                    alert(JSON.stringify(checkChild));
                    if(!checkChild){
                        checkParent.items.push(newChild);
                    }
                    arrayObject.push(ob)
                }else{

                    arrayObject.push(newChild);
                }
            } 
```

# javascript - 使用 AJAX 的登录表单未提交

> ID：14205424
> 
> 赞同：1
> 
> 时间：2013-01-07T22:44:02.720
> 
> 标签：javascript, html, forms

我在 wordpress 网站上创建了一个登录表单，该表单将允许用户访问仅限会员的内容。我有三个功能`login()` `resetPassword()`和`register()`.

在我添加了第三个函数之前，`login()`和表单都可以正常工作，然后根本不会提交任何表单。`resetPassword()``register()`

如果我删除该`register()`功能，那么其​​他表单将再次开始工作。此外，如果我将其他功能放在他们自己的`<script>`标签中，那么它们会按预期工作，但该`register()`功能仍然无法正常工作。

我一遍又一遍地查看代码，并尝试将其放置在不同的区域......我不确定是什么导致了问题。以前有没有人发生过这种情况？我如何解决它？

```
<script type="text/javascript">
function login()
{
    var email = document.getElementById("LoginUName").value;
    var pword = document.getElementById("LoginPWord").value;
    var xmlhttp;
    if (window.XMLHttpRequest)xmlhttp=new XMLHttpRequest(); 
    else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
    xmlhttp.onreadystatechange=function(){document.getElementById('LoginScreen').innerHTML=xmlhttp.responseText;}
    xmlhttp.open('GET','login.php?EMail='+email+'&PWord='+pword,true);
    xmlhttp.send();
}
function resetPassword()
{
    var email = document.getElementById("ResetEMail").value;
    var xmlhttp;
    if (window.XMLHttpRequest)xmlhttp=new XMLHttpRequest(); 
    else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
    xmlhttp.onreadystatechange=function(){document.getElementById('LoginScreen').innerHTML=xmlhttp.responseText;}
    xmlhttp.open('GET','passwordReset.php?EMail='+email,true);
    xmlhttp.send();
}
function register()
{
    var firstname = document.getElementById("RegisterFirstName").value;
    var lastname = document.getElementById("RegisterLastName").value;
    var email = document.getElementById("RegisterEMail").value;
    var pword = document.getElementById("RegisterPWord").value;
    var xmlhttp;
    if (window.XMLHttpRequest)xmlhttp=new XMLHttpRequest(); 
    else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
    xmlhttp.onreadystatechange=function(){document.getElementById('LoginScreen').innerHTML=xmlhttp.responseText;}
    xmlhttp.open('GET','register.php?FirstName='+firstname+'&LastName='+lastname+'&EMail='+email'&PWord='+pword,true);
    xmlhttp.send();
}
</script>

<div id="LoginScreen">
<h1>Welcome to ****.</h1><br>
<h2>Please login or register below:</h2><br>
<form action="javascript: login()" method="get">
    <ul>
        <li>
            <h3>Username:&nbsp;</h3><input type="email" id="LoginUName" name="LoginUName" placeholder="Email address" />
        </li>
        <li>
            <h3>Password:&nbsp;</h3><input type="password" id="LoginPWord" name="LoginPWord" placeholder="Password"/>
        </li>
    </ul>
    <input type="submit" value="Login"/>
</form>
<br><hr><br>
<form action="javascript: resetPassword()" method="get">
    <h2>Forgot your password?</h2><br>
    Email address:&nbsp;<input type="email" id="ResetEMail" name="ResetEMail" placeholder="Email address" />&nbsp;&nbsp;<input type="submit" value="Reset" />
</form>
<br><hr><br>
<form action="javascript: register()" method="get">
    <h2>Register new user:</h2><br>
    <ul>
        <li>
            <h3>First Name:&nbsp;</h3><input type="text" id="RegisterFirstName" name="RegisterFirstName" placeholder="First Name" />
        </li>
        <li>
            <h3>Last Name:&nbsp;</h3><input type="text" id="RegisterLastName" name="RegisterLastName" placeholder="Last Name" />
        </li>
        <li>
            <h3>Email:&nbsp;</h3><input type="email" id="RegisterEMail" name="RegisterEMail" placeholder="email address" />
        </li>
        <li>
            <h3>Password:&nbsp;</h3><input type="password" id="RegisterPWord" name="RegisterPWord" placeholder="Password" />
        </li>
    </ul>
    <input type="submit" value="Register"/>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T23:02:19.883

这只是一个语法错误。你错过了一个`+`标志。

你有：

```
 xmlhttp.open('GET','register.php?FirstName='+firstname+'&LastName='+lastname+'&EMail='+email'&PWord='+pword,true); 
```

它需要在`+`之后有一个标志`email`：

```
xmlhttp.open('GET','register.php?FirstName='+firstname+'&LastName='+lastname+'&EMail='+email+'&PWord='+pword,true); 
```

这就是为什么如果你把它放在两个单独的脚本中它会起作用的原因。一个语法错误导致整个脚本无效。

# iis - 不为每个应用程序生成唯一密钥的安全影响是什么？

> ID：14205427
> 
> 赞同：0
> 
> 时间：2013-01-07T22:44:26.063
> 
> 标签：iis, iis-7.5, security, load-balancing

我在硬件负载平衡器后面有 Server 2008 R2 / IIS 7.5 Web 服务器。为了使负载平衡正常工作，我必须在服务器之间指定一个公共 IIS 机器密钥，并禁用“为每个应用程序生成唯一密钥”的选项以用于验证和解密密钥（也使用会话状态服务器，但现在没关系）。

IIS GUI 的机器密钥部分说“为了提高应用程序之间的安全性，为每个应用程序生成一个唯一的密钥。” 如果我不“为每个应用程序生成唯一密钥”，安全风险是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T00:33:38.657

如果一台机器的密钥被泄露，这意味着攻击者可以使用相同的密钥来解密来自共享该密钥的其他机器的通信。当您与多人共享密码时，请考虑风险。

攻击者还能够预测会话 ID 或创建与您的其他服务器兼容的会话 ID。

# assembly - 如果所有代码都访问数据，并且所有数据都访问代码，那么“代码”和“数据”有什么区别？

> ID：14205429
> 
> 赞同：3
> 
> 时间：2013-01-07T22:44:31.773
> 
> 标签：assembly

在汇编中，关于内存、代码、数据、段等有很大的理论辩论。

直言不讳是没有意义的。

什么是代码、文本、数据等？

我读过教程，他们只关注应用程序，而不是 100% 书面文字下的代码在做什么。

我不能成为汇编程序员，这还不清楚；有没有教程能更好地阐明这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T22:47:19.167

好的，所以其中一些内容有点主观，因为它可能因系统和工具链而异，但：

*   代码和文本通常是同义词，意思是“此部分/段包含可执行代码”

*   数据通常表示“此部分/段包含不可执行的数据”

如果您的硬件支持它，数据部分被加载到的内存页面可能会被标记为“不可执行”，这样如果您的程序试图跳入该区域，它将立即崩溃而不是做一些疯狂的事情。

同样，代码/文本部分可能会将其页面标记为“只读”，这样它们就不会被程序意外修改。一些系统也有“只读数据”部分，它们放置字符串文字和常量变量等。

最极端的例子可能是[哈佛架构](http://en.wikipedia.org/wiki/Harvard_architecture)，其中代码和数据存储器不是同一个物理设备。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-07T22:52:07.963

There really are no distinctions between code and data at the lowest levels. In the end all code is data, just ask a compiler, and any data can be executed. Operating systems apply rules to how various blocks of memory can be accessed. That's where the distinction starts. As you go higher in language and system levels the distinctions get more complex, you get heaps and stacks and paged memory and virtual memory and virtual machines. It all gets very complex, but at its root it is a Von Neumann machine, even if it looks like a cool gadget from Apple.

And yes, I used to be an Assembler programmer.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T03:24:01.077

我没有听过也没有见过关于这些术语的“伟大的理论辩论”，除非是在不理解和猜测的人之间。

位只是位，随着您的级别越来越低，它们的长期意义越来越少。在高级语言中，您的变量可能被非常清楚地定义为某种“类型”，并且该变量在该程序或范围内的该变量的生命周期内始终是该类型。但是当你更接近逻辑时，这些位就变成了位或信号，并失去了它们的类型。类型开始变得毫无意义并且无关紧要。如果您正在“计算地址”到您正在使用数据位执行的某事，那么它们直到它们降落在地址总线上的短暂时刻才会成为地址，只有它们是地址，其余时间它们只是位在周围。

当处理器从某处“获取”“指令”时，为了最终执行它而获取指令的行为，使这些位代码。但是，如果您将构成指令的所有这些位分解为更小的部分，则其中一些位可能是立即值，这些位可能是正在加载到寄存器中的数据或地址或正在使用的地址的一部分访问一些数据。所以其中一些“代码”只是与代码紧密捆绑在一起的纯数据。因此，从一个角度来看，位可能仅在它们被提取并注定要作为指令执行的短暂时刻被称为代码。在内存、缓存或磁盘中放置时，它们大部分时间只是数据。

当该代码从硬盘读取、写入内存时，远在操作系统尝试执行该代码之前很久，它只是数据位，在较低级别无法与 jpeg 图像或 mpeg 视频区分开来或从硬盘读取并移入内存的任何位。

当一条指令正在读取或写入内存而不是作为要执行的指令（就当时的操作而言）时，那只是数据，是这些位的通用术语。它们始终是数据，如果它们实际上或可能注定要直接或间接地作为指令执行，则它们具有代码的双重定义。

至于出于任何原因的文本与数据文本（其他人已在 stackoverflow 的其他地方更详细地解释过），文本基本上是程序的代码部分，代码的另一个词，指令部分。数据只是数据，不是指令的部分，也不会是指令。至少在这种情况下。

无论出于何种历史或实际原因，您的程序通常包含一定百分比的指令位，并且某些百分比可能被视为数据，例如保存变量的内存，或者您可能在代码中嵌入了图像，或者一个未初始化的内存数组，当你的程序运行时，它会从你的程序运行的某个地方加载一些数据。编译器术语倾向于将术语文本用于代码部分，将数据用于其他部分（如果有的话）。

在许多情况下，无论目的或目的地如何，将所有位称为“数据”并不是不正确的。

什么是内存，它是存储位的东西。那个有很多切线，但基本上它存储你的位，短期或长期或两者兼而有之。

段是这个词所暗示的东西被分解成段。许多人首先认为 x86 及其历史是一种分段架构，人们通常过于复杂化，这意味着就该架构而言，地址是使用多个寄存器或实体计算的。没有意识到通常所谓的平面内存架构一直都在使用分段。通常您的视频内存一次只能访问一个段。通常你的硬盘一次只能访问一个段，你有一个小孔径可以查看并寻址，其余的地址在其他地方管理，这两个地址在你的程序之外的某个点，一起访问你想访问的东西。访问段的边界和规则因硬件而异，有时因软件而异。

你的问题很模糊，你想做什么，你挂断了什么，你用什么资源试图自己回答这个问题。如果您正在尝试学习汇编语言并且只看过一本书，那本书可能很烂，该语言可能很烂，或者两者兼而有之，而您只是在浪费时间，请找另一本书或另一种汇编语言。有大量不同的书籍教授任何特定的编程语言，例如 C，这并不意味着这些书籍中的每一本书都非常好并且适用于每个人。特别提出你的问题，我在这本“blah”书中读到“blah”，我不明白这个词是什么意思。它是如何应用的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T22:49:29.680

也许这里有一些历史背景。目前流行的架构是 [冯纽曼](http://en.wikipedia.org/wiki/Von_Neumann_architecture)类型，代码和数据在同一个内存中共享。并非所有架构都是这样的——一些隔离代码和数据。

# php - 如何快速高效地将文件块（html5分块的结果）合并到一个文件中

> ID：14205445
> 
> 赞同：2
> 
> 时间：2013-01-07T22:46:06.950
> 
> 标签：php, html, file-upload, file-io, file-transfer

我创建了一个文件传输程序，它使用 html5 分块上传文件（大约 4gb 的大文件）。每个块的大小为 100MB（我只是无缘无故地选择这个，因为我尝试使用 10MB，据我所知，它并没有任何区别）。

它正确上传每个块。但在完成上传结束时，我尝试将文件合并回 1 件，但这需要很长时间。如果我尝试刷新上传者的 web ui，它在完成合并之前将无法工作。

我的合并代码是这样的：

```
$final_file_path = fopen($target_path.$file_name, "ab");

//Reconstructed File
for ($i = 0; $i <= $file_total_chunk; $i++) {
    $file_chunk = $target_path.$file_name.$i;    

    if ( $final_file_path ) {
        // Read binary input stream and append it to temp file
        $in = fopen($file_chunk, "rb");
        if ( $in ) {
            //while ( $buff = fread( $in, 1048576 ) ) {
            while ( $buff = fread( $in, 104857600 ) ) {
                fwrite($final_file_path, $buff);
            }   
        }
        if(fclose($in)) {
            unlink($file_chunk);
        }        
    }
}

fclose($final_file_path); 
```

无论如何，有没有效率和快速地做到这一点。我正在使用 PHP。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T00:05:20.083

如果您不想在使用带`exec`函数的 php 时等待，您可以使用[gearman 工作队列](http://gearman.org/)和工作人员的异步响应。在工作人员内部，您可以使用@hafichuk 解决方案。队列使您的整个应用程序更具可扩展性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T22:57:06.777

您可能应该考虑将上传和连接过程分成两个单独的过程。上传和通知用户文件已上传（通过网页）可以一起完成，后端处理可能应该在一个完全独立的过程中完成。

我会考虑设置一个作业队列来处理连接过程，其中 PHP 上传脚本一旦完成，就会将一个作业放入队列中，并且在服务器上运行的守护程序会产生一个工作人员来进行连接。

就个人而言，我会让工作人员使用`cat`.

```
$> cat chunk_1 chunk_2 ... chunk_n > uploaded_file_name 
```

*如果*您仍然想在 PHP 中执行此操作，那么您可以执行以下操作：

```
for ($1 = 0; $i <= $file_total_chunk; $i++) {
    $files[] = $target_path.$file_name.$i;
}

$catCmd = "cat " . implode(" ", $files) . " > " . $final_file_path;
exec($catCmd); 
```

确保您已清理文件名，否则可能会在此处注入将在命令行上执行的任意代码。

# javascript - 如何防止加载谷歌图表表格css

> ID：14205446
> 
> 赞同：11
> 
> 时间：2013-01-07T22:46:11.690
> 
> 标签：javascript, css, twitter-bootstrap, google-visualization

每次我使用谷歌图表的表格时，谷歌加载器都会加载一个`http://ajax.googleapis.com/ajax/static/modules/gviz/1.0/table/table.css` 它总是几乎会杀死我的引导 css，而且我在凌晨 2 点并不很烦人。:)
*注意：我不能修改 table.css 文件。*

您知道任何可以阻止加载 CSS 文件的方法吗？

谢谢您的帮助。

PS：是的，我已经尝试过使用 JS，但是表格在切换页面时会重新编译，所以我应该在`table`每次分页时替换 's 类名。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T19:31:14.033

如[Google Chart Table API Docs](https://developers.google.com/chart/interactive/docs/gallery/table#customproperties)中所见，您可以通过设置`cssClassNames`选项覆盖 CSS 类：

> 使用此属性将自定义 CSS 分配给表格的特定元素

通过上面的链接查看文档以查看`cssClassNames`.

* * *

非常简单，基于[Google Playground Table 示例](https://code.google.com/apis/ajax/playground/?type=visualization#table)，如果您覆盖所有属性，该表格将（几乎）没有 Google CSS。

您可以通过在 Playground 示例中复制以下代码来尝试：

```
// Create and draw the visualization.
visualization = new google.visualization.Table(document.getElementById('table'));
visualization.draw(data, {
  cssClassNames: {
    headerRow: 'someclass',
    tableRow: 'someclass',
    oddTableRow: 'someclass',
    selectedTableRow: 'someclass',
    hoverTableRow: 'someclass',
    headerCell: 'someclass',
    tableCell: 'someclass',
    rowNumberCell: 'someclass'
  }
}); 
```

这应该让 Twitter Bootstrap CSS 单独存在。

* * *

加载的 CSS 仍然会改变一些东西，但如果你只是删除 class 似乎就会消失`google-visualization-table-table`。你应该在每次`.draw()`通话后这样做。

```
var className = 'google-visualization-table-table';
$('.'+className).removeClass(className); 
```

* * *

**更新**：如果您使用 page 选项，则可以在分页时使用此代码段删除类：

```
visualization = new google.visualization.Table(document.getElementById('table'));
visualization.draw(data, {
    page: 'enable',
    pageSize: 2,
    cssClassNames: {
      /* ... */
    }
  });

google.visualization.events.addListener(visualization , 'page',
   function(event) {
       var className = 'google-visualization-table-table';
       $('.'+className).removeClass(className);
   }); 
```

不要忘记调用`.removeClass()`on 初始化（你应该做一个函数，就像那里： http: [//pastebin.com/zgJ7uftZ](http://pastebin.com/zgJ7uftZ)）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-07T22:58:54.270

给你`body`上课。然后利用该类确定您的 CSS 范围。

```
<body class="my">..</body>

.my .google-visualization-table-table { /* blah */ } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-15T00:08:39.967

My idea is still like some others here, to override the google through a more specific selector. I think with bootstrap, perhaps the easiest way to do that is something like this:

## Set up an `id` on your html tag.

**HTML**

```
<html id="myHTML">All your html goes here</html> 
```

## Set up bootstrap to load all its selectors under that `id`.

**LESS**

```
#myHTML {
   font-size: 100%;
   @import: "yourpath/bootstrap.less";
   @import: "yourpath/anyOtherBootstrapFilesYouMightLoad.less";
   etc...
} 
```

Note, the `font-size: 100%` is because the `bootstrap.less` has `html { font-size: 100% }` which you want to keep that functionality, but you will lose it if you don't replicate what is in the bootstrap call for `html`. See the CSS output below for further explanation.

## Output

**CSS** (Brief sample output)

```
#myHTML {
    font-size: 100%;
}

#myHTML article, 
#myHTML aside, 
#myHTML details, 
#myHTML figcaption, 
#myHTML figure, 
#myHTML footer, 
#myHTML header, 
#myHTML hgroup, 
#myHTML nav, 
#myHTML section {
    display: block;
}

#myHTML html { 
/* this is from the base html call in bootstrap, but will never 
   select anything as it is basically like writing "html html" 
   for a selector, which is why we added the font-size to your 
   LESS code above 
*/
    font-size: 100%;
}

#myHTML .btn {
    etc...
} 
```

By doing this, you can see how all straight classes, like `.btn`, end up having an `id` appended to them that is on your `<html>` tag. This gives the selector a higher specificity than google's `.google-visualization-table-table *`, as the `id` is higher than the `*` selector in precedence.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-18T03:41:28.057

如果您只是获取 google api 加载的 js 的副本并将其放在您的服务器中，如下例中的 table.js 中所示，并评论 google api 调用怎么办。

```
// google.load('visualization', '1', {packages:['table']}); 
```

在其中找到字符串**'/table/table.css'**并将其替换为**'/table/../core/tooltip.css'**

这样，**永远不会**加载 table.css。

```
<html>
  <head>
    <script type='text/javascript' src='https://www.google.com/jsapi'></script>
    <script type='text/javascript' src='table.js'></script>
  </head>
  <body>
    <div id='table_div'></div>
    <script type='text/javascript'>
      //      google.load('visualization', '1', {packages:['table']});
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Name');
        data.addColumn('number', 'Salary');
        data.addColumn('boolean', 'Full Time Employee');
        data.addRows([
          ['Mike',  {v: 10000, f: '$10,000'}, true],
          ['Jim',   {v:8000,   f: '$8,000'},  false],
          ['Alice', {v: 12500, f: '$12,500'}, true],
          ['Bob',   {v: 7000,  f: '$7,000'},  true]
        ]);

        var table = new google.visualization.Table(document.getElementById('table_div'));
        table.draw(data, {showRowNumber: true});

    </script>
  </body>
</html> 
```

我不确定这是否违反了任何规定，这是一个非常老套的解决方案。显然，这是有后果的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-01-11T14:22:24.577

我在那里只看到两种可能性。要么将所有 CSS 选择器更改为具有更高特异性的东西，要么使用 Javascript 删除您不想加载的样式表。

如果您使用 CSS 预处理器，更改 CSS 选择器是没有问题的。您甚至可以只使用它一次来更改所有选择器。

使用 Javascript，您需要一个可以挂起删除样式表的事件侦听器的点。这一点必须在添加样式表之后。

如果您没有这样的观点，您将不得不覆盖 document.createElement （这通常是一种不好的做法）。

这对我有用。由于 IE<9s 缺少数组的 addEventListener 和 indexOf ，它在那里不起作用。但是在你修复它之后它也应该在那里工作：

```
(function () {
    var createElement = document.createElement,
        stylesheetBlacklist = [
            'http://ajax.googleapis.com/ajax/static/modules/gviz/1.0/table/table.css'
        ];
    document.createElement = function (tagname) {
        var e = createElement.apply(this, arguments);
        if (tagname === 'link') {
            if (e.__defineSetter__) {
                var setAttr = e.setAttribute;
                e.__defineSetter__('src', function (val) {
                    e.setAttribute('src', val);
                });
                e.setAttribute = function (attrName, attrVal) {
                    if (attrName !== 'src' || stylesheetBlacklist.indexOf(attrVal) === -1) {
                        setAttr.call(e, attrName, attrVal);
                    }
                }
            } else {
                e.addEventListener('load', function () {
                    if (stylesheetBlacklist.indexOf(this.src) > -1) {
                        this.parentNode.removeChild(this);
                    }
                });
            }
        }
        return e;
    }
}()); 
```

当然这不会阻止任何样式表在样式元素中被@imported。所以它真的更像是一个肮脏的黑客而不是一个解决方案......</p>

遗憾的是，Google API 提供了“nocss”选项，但在可视化模块中不支持它。

编辑：如果浏览器支持**defineSetter**它甚至不再加载样式表。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-01-11T15:42:25.960

我相信这应该可以解决您的问题：[链接](https://groups.google.com/forum/?fromgroups=#!msg/google-visualization-api/GXCc2QrQWrY/ZyKg8Ta1DiwJ)

取自链接：

为您的 CSS 类名添加前缀

```
 var cssClassNames = {
     'tableCell': 'myTable myBorder'}; 
```

然后像这样改变你的css减速：

```
.myTable.myBorder {
 border: 1px solid #6699FF;
 font-size:11px;
 color:#226180;
 padding:135px;
 margin:135px;
 } 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-01-16T05:45:45.727

很容易，因为你已经安装了 jQuery：

```
jQuery(document).ready(function ($) {
  $('*[class*=google-visualization]').attr('class', function() {
    return $(this).attr('class').replace('google', 'yahoo')
  })
}); 
```

# ruby - 更改 Rubinius Ruby 版本

> ID：14205447
> 
> 赞同：2
> 
> 时间：2013-01-07T22:46:26.520
> 
> 标签：ruby, rvm, ruby-1.9, rubinius

无论如何都可以更改Rubinius（rbx）默认使用的Ruby版本，而不必每次都通过标志指定选项？：

```
rbx -X19 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T22:46:26.520

有 3 种方法可以做到这一点（按烦恼的升序排列）。

1.  在您将调用 rbx 的目录中设置一个环境变量（如 rails 根目录）：

    ```
    export RBXOPT=-X19 
    ```

    注意：如果从另一个项目调用 rbx，则必须重新设置。

2.  使用 rvm 重新安装 Rubinius，指定 rvm.io 上记录的默认 Ruby[版本](https://rvm.io/interpreters/rbx/)：

    ```
    rvm reinstall rbx --1.9 
    ```

    注意：如果 rvm 抱怨参数错误，请使用`rvm get master`或升级它`rvm get stable`

3.  从源代码重新安装 Rubinius，指定默认使用哪个版本，如[Rubinius 博客](http://rubini.us/2011/10/18/contributing-to-rubinius/#language-modes)中所述：

    ```
    ./configure --default-version=1.9 
    ```

完成此操作后，您可以通过以下方式检查 Rubinius 使用`rbx -v`的 ruby​​ 版本（括号中的 ruby​​ 版本）

# android - 使用 MockContext 的 Android ApplicationTestCase

> ID：14205451
> 
> 赞同：7
> 
> 时间：2013-01-07T22:46:29.780
> 
> 标签：android, unit-testing, mocking, android-context

我是 Android 测试的新手，我正在尝试使用 MockContext 创建一个 ApplicationTestCase（实际上我正在尝试使用重命名模拟上下文）。但我不断收到 AssertionFailedError。到目前为止，这是我非常基本的代码：

AppTests.java

```
package com.myProject.test;

import android.test.ApplicationTestCase;

public class AppTests extends ApplicationTestCase<MyApplication> {
    public AppTests() {
        super(MyApplication.class);
    }

    @Override
    protected void setUp() throws Exception {
        final RenamingMockContext mockContext = new RenamingMockContext(getContext());
        setContext(mockContext);
        createApplication();
    }

} 
```

我的应用程序.java

```
package com.myProject.test;

import android.app.Application;

public class MyApplication extends Application {

    public MyApplication() {
    }

    @Override
    public void onCreate() {
        super.onCreate();
    }

} 
```

重命名MockContext.java

```
package com.myProject.test;

import android.content.Context;
import android.content.SharedPreferences;
import android.test.RenamingDelegatingContext;
import android.test.mock.MockContext;

public class RenamingMockContext extends RenamingDelegatingContext {

    private static final String PREFIX = "test.";

    public RenamingMockContext(Context context) {
        super (new DelegatedMockContext(context), PREFIX);
        //super(context, PREFIX);
    }

    private static class DelegatedMockContext extends MockContext {
        private Context mDelegatedContext;
        public DelegatedMockContext(Context context) {
            mDelegatedContext = context;
        }

        @Override
        public String getPackageName() {
            return mDelegatedContext.getPackageName();
        }

        @Override
        public SharedPreferences getSharedPreferences(
          String name, int mode) {
          return mDelegatedContext.getSharedPreferences(
            PREFIX + name, mode);
        }

    }

} 
```

故障跟踪：

```
junit.framework.AssertionFailedError
at android.test.ApplicationTestCase.setupApplication(ApplicationTestCase.java:102)
at android.test.ApplicationTestCase.createApplication(ApplicationTestCase.java:118)
at com.myApplication.test.AppTests.setUp(AppTests.java:14)
at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:190)
at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:175)
at android.test.InstrumentationTestRunner.onStart(InstrumentationTestRunner.java:555)
at android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:1710) 
```

请注意，如果我在被注释掉的 RenamingMockContext 构造函数中使用第二个 super() 调用（所以不要使用扩展的 MockContext 类），它可以正常工作。

[这是从单元测试中调用 getSharedPreferences() 时](https://stackoverflow.com/questions/5267671/unsupportedoperationexception-while-calling-getsharedpreferences-from-unit-tes)的参考UnsupportedOperationException ，这对我不起作用，我还通读了 Android Application Testing Guide 一书，其中给出了一个与此完全相同的示例，但是当我下载源代码并直接运行它时它给出了同样的错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-26T13:03:00.393

作为该书示例的解决方法，请查看 Android 开发人员指南 ApplicationTestCase：“如果简单地按原样运行测试，您的应用程序将被注入一个功能齐全的上下文”（[http://developer.android.com/reference /android/test/ApplicationTestCase.html](http://developer.android.com/reference/android/test/ApplicationTestCase.html) )。

必须对 Setup 方法的几行进行注释才能使测试正常工作：

```
protected void setUp() throws Exception
    {
        super.setUp();
        // final RenamingMockContext mockContext = new RenamingMockContext(
        // getContext());
        // setContext(mockContext);

        createApplication();
        mApplication = getApplication();
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-23T20:19:03.827

我使用 AndroidTestCase 来模拟一个简单的上下文。

```
class ExampleTest extends AndroidTestCase
    public void setUp() {
      Context c = new DelegatedMockContext(getContext())
    }

    class DelegatedMockContext extends MockContext {

    private Context mDelegatedContext;
        private static final String PREFIX = "test.";

        public DelegatedMockContext(Context context) {
             mDelegatedContext = context;
        }

        @Override
        public String getPackageName(){
            return PREFIX;
        }

        @Override
        public SharedPreferences getSharedPreferences(String name, int mode) {
            return mDelegatedContext.getSharedPreferences(name, mode);
        }
    }
} 
```

它只是一个沼泽标准上下文，但会让你继续前进

# ruby-on-rails - 设施控制器中的参数错误#index

> ID：14205459
> 
> 赞同：0
> 
> 时间：2013-01-07T22:46:55.033
> 
> 标签：ruby-on-rails, ruby, databasedotcom-gem

我正在运行一个教程来在 Ruby on Rails 上创建我的第一个应用程序并发现以下问题：

设施控制器中的参数错误#index

错误参数（预期的 URI 对象或 URI 字符串） Rails.root：/Users/andreucasadella/rails_projects/DF12-Demo-master

应用程序跟踪 | 框架跟踪 | 完整跟踪 app/controllers/facilities_controller.rb:7:in `index' 请求

参数：

无 显示会话转储

显示环境转储

回复

标题：

没有任何

# eclipse - 如何使 Mylyn GitHub Connector for Eclipse 运行经过身份验证的请求？

> ID：14205461
> 
> 赞同：36
> 
> 时间：2013-01-07T22:46:59.073
> 
> 标签：eclipse, oauth, github, egit, mylyn

我正在使用非常酷的[Github Mylyn Connector](https://github.com/blog/852-github-mylyn-connector-for-eclipse) for [Eclipse Indigo](https://encrypted.google.com/url?sa=t&rct=j&q=eclipse%20indigo&source=web&cd=1&cad=rja&ved=0CC8QFjAA&url=http://www.eclipse.org/indigo/&ei=DVDrUNr2DsKctQaryoGYCA&usg=AFQjCNHDQcWhz9GRBeUv0BKil66TSfSsdQ&bvm=bv.1355534169,d.Yms)。但是，由于我在 GitHub 上的许多项目中都使用了它，因此我很快就遇到了针对 GitHub v3 API 的未经身份验证的请求执行的每秒 60 个请求的[速率限制。](http://developer.github.com/v3/#rate-limiting)

症状是刷新任何查询（无论多么小 - 再次，这里的限制因素更多是我处理可能的存储库）我收到错误：

```
Unexpected error : API Rate Limit Exceeded for XXX.XXX.XXX.XXX 
```

我的IP当然在哪里`XXX.XXX.XXX.XXX`。

我已经使用我的 GitHub 用户名和密码在任务存储库视图中配置了 GitHub 存储库，但连接器似乎没有将它们用于 OAuth 或基本身份验证。我已阅读 GitHub 连接器插件的[常见问题解答](http://wiki.eclipse.org/EGit/GitHub/UserGuide)，但没有发现任何有用的东西。

有没有办法让 GitHub 连接器发出经过身份验证的请求（这将计入更宽松的 5K/小时速率限制？）？

* * *

编辑：我尝试使用私有存储库（至少有一个活动问题）来检查是否*有一些*凭据被发送到那里。我得到了`Unexpected error: Issues are disabled for this repo`。

* * *

编辑：我注意到 Eclipse Marketplace 上的插件版本存在问题，然后切换到从[nightlies repo](http://download.eclipse.org/egit/updates-nightly)获取我的 EGit 插件，同样从[Mylyn Github Connector](http://download.eclipse.org/egit/github/updates-nightly)获取。它没有帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-06-24T23:31:17.467

带有 Mylyn Github 连接器 4.4 的 Eclipse Neon。

使用[2-factor access token 进行](https://help.github.com/articles/creating-an-access-token-for-command-line-use/)测试。在具有数百个问题的公共存储库上成功超过了匿名速率限制。我没有使用简单登录进行测试，但它应该可以工作。

# java - 将 Jython 代码转换为 Java 类

> ID：14205464
> 
> 赞同：4
> 
> 时间：2013-01-07T22:47:13.930
> 
> 标签：java, jython

目标：允许最终用户编写 jython 脚本，这些脚本将在 Java 中创建 AI 对象 [用于控制游戏中的宇宙飞船舰队]。

我希望用户能够在 .py 文件中编写 AI 的所有逻辑，然后将该代码转换为 java 对象。我想在不使用 Java 反射的情况下做到这一点，并且每次需要时都不需要通过解释器运行用户的代码。这样做的重点是让代码尽可能快地运行，因为 AI 逻辑必须运行每个游戏循环。

我看过 Jython 的`__toJava__`方法，但我真的不明白如何使用它或者它是否是我需要的。

我将不胜感激任何对我的问题的良好解决方案的见解，或有关`__toJava__`. 我致力于 Java 和 Jython，因此建议替代方案没有成效 :)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-28T19:09:08.873

不再支持“jythonc”。您必须使用 jython 进行编译：

```
jython

>>> import compileall
>>> compileall.compile_dir('directory/', force=True) 
```

对于单个文件：

```
 >>> import py_compile
 >>> py_compile.compile('Building.py') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T10:13:10.763

您应该了解[这些](http://www.jython.org/jythonbook/en/1.0/JythonAndJavaIntegration.html)在 java 应用程序中使用 jython 代码的方法。

您应该在 jython 中编写代码并在您的 Java 应用程序中按原样使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T21:10:47.977

Jythonc 已被弃用，但无论如何这里是[带有 jythonc 的旧版本](http://sourceforge.net/projects/jython/files/jython/jython_installer-2.2.1.jar)。用这样的东西编译：

```
jythonc --core --jar foo.jar foo.py 
```

另一个（未经测试的）解决方案可能是将您的类保存为 foo.py，在同一文件夹中打开一个 jython shell 并键入

```
import foo 
```

这将在该文件夹中自动创建一个 foo$py.class。

虽然 Jython 是一门不错的语言，但由于缺乏好的打包工具，我选择了[Clojure](http://clojure.org/)，它可以很容易地打包以便与[Leiningen](http://leiningen.org/)进行 java 互操作。而且由于您要编写 AI，因此使用 lisp 可能不是一个坏主意。

# excel - 如何使用多个密码锁定 Excel 中的单个单元格？

> ID：14205466
> 
> 赞同：0
> 
> 时间：2013-01-07T22:47:18.670
> 
> 标签：excel, vba

我正在为多个用户构建一个新的工作表，作为我们公司的清单。目标是在个人和团体层面引入问责制。

我们的想法是让每个用户都能够编辑工作表中的某些单元格，以便在清单中完成的每项工作上“签字”。这个群体倾向于互相掩饰，说事情是在没有实际完成的情况下完成的，但是（高中生），所以我们想包括一个用户特定的密码，这样我们就可以看到谁检查了每个项目，而不是仅仅覆盖他们的基地并为任何人输入首字母。

这个想法的第二个层次是分配一个 4 位数字（可能使用`InStr`？）来自动添加他们的首字母。即，我在一个单元格中输入 9999，然后我的首字母 AB 就是出来的。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T00:27:36.820

去年夏天我为实习做了类似的事情，而且我去做的方式有点复杂，所以我会尽量给你一个简短的答案。

1.  创建一个新的隐藏表，用于存储个人的密码和姓名首字母
2.  因为高中生可能会尝试取消隐藏密码表，所以我会完全隐藏功能区，但这只是预防措施。
3.  然后，如果您对创建最顶层的模态表单不感兴趣，我将创建一个简单的首字母/密码框，出现在 Excel 电子表格的启动中，然后如果首字母和密码组合正确，则存储首字母进入公共变量，当工作表上的项目已更改（使用事件）时，将首字母写入正确的单元格。

如果您需要更详细的答案，或者想要一些示例代码或其他任何内容，请随时给我发消息或给我发电子邮件。

希望有帮助。

# c# - C# regexp \w with +, * 似乎不能正常工作

> ID：14205467
> 
> 赞同：0
> 
> 时间：2013-01-07T22:47:49.137
> 
> 标签：c#, regex

我有这样一段代码：

```
String source = "There will will be";
Regex r = new Regex(@"There \w+ be");
Console.WriteLine(r.Match(source).Value); 
```

而且我在输出中看不到任何东西，如果源是会有的，我可以看到输出。谁能给我解释一下？

在某种程度上是一个问题。如何创建一个将在 1 或 2 之间找到的正则表达式（这是一个示例，我正在编写某种解析器并且需要创建我自己的以这种方式运行的通配符）单词。我已经尝试了一些组合，但一切都失败了。我的尝试之一：

```
@"\w+\s{1,2}" 
```

我认为这是错误的，因为 {1,2} 告诉正则表达式重复空格 1 或 2 次，而不是整个 \w+\s。你知道如何修复它或以不同的方式制作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:50:44.220

原因是该代码不匹配。`\w`可以是任何字母数字字符和下划线（本质上是`A`通过`Z`、`0`通过`9`和`_`）。然而，空间是它们自己的组（由 表示`\s`）。

要解决此问题，您可以通过创建一个组来使正则表达式匹配，其中匹配算法可以使用以下方法选择任何元素`[]`：

`There [\w\s]+? be`

请注意，我还添加了 a`?`以使其成为非贪婪匹配，尝试匹配文本中尽可能小的部分（否则您可以跳过一段`be`时间匹配）。

* * *

至于添加，只需使用非匹配组（与匹配组相比，节省一些处理时间和内存）：

`(?:\w+\s){1,2}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T22:50:49.690

`\w`匹配任何单词字符（a-zA-Z0-9 和下划线）。`There will will be`需要`\w+`匹配`will will`。`\w`无法匹配空格，因此正则表达式不匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T22:51:11.833

那是因为空间在`\w+`. 尝试使用以下任一方法：

```
@"There \w+ \w+ be" 
```

或者

```
@"There [\w\s]+ be" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T22:51:38.183

`\w`匹配所有字母数字字符和下划线。在您的示例中，它必须匹配`will will`包含空格的，因此不匹配。但是，您的表达式将`There will be`仅与一个匹配`will`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-07T23:10:45.670

\w 匹配单词字符，因此两个 'will' 字符串之间的空格会阻止匹配。您可能希望将其替换为`@"There \w+(?:\s+\w+)* be"`。

# android - 如何制作像 JB 相机一样的滚轮菜单

> ID：14205469
> 
> 赞同：1
> 
> 时间：2013-01-07T22:48:02.917
> 
> 标签：android

我的应用程序中有一个按钮，当有人按下它并按住手指时，应该会出现一个弹出式滚轮菜单（就像 JB 相机的那个）。

它看起来像这样

![在此处输入图像描述](../Images/b90b0fd5db095151a0af1854f262a207.png)

在中间会有一个按钮，当你的手指向下时会出现滚轮，当你抬起它时它会消失

我会用这段代码让轮子出现

```
b.setOnTouchListener(new View.OnTouchListener() {

        public boolean onTouch(View v, MotionEvent event) {
                switch (event.getAction()) {

                  case MotionEvent.ACTION_UP: 
                        wheel.setVisibility(View.INVISIBLE);
                        Log.w("app", "Action up");
                        return true;
                  case MotionEvent.ACTION_DOWN: 
                        wheel.setVisibility(View.VISIBLE);
                        Log.w("app", "Action down");
                  }
                return false;
            }
        }); 
```

现在我有一个问题，如何定位轮子的按钮？（我不想使用整个车轮图像，我宁愿只导出一个，因为它们看起来都一样）

同样在轮子出现后，我想通过用 ACTION_UP 将手指抬到其中一个选项上方来选择其中一个选项，我该如何实现？

# ruby-on-rails - 在 HAML 和 Rails 中使用 IE 条件注释

> ID：14205472
> 
> 赞同：2
> 
> 时间：2013-01-07T22:48:09.937
> 
> 标签：ruby-on-rails, internet-explorer, comments, haml

我正在尝试根据找到此主题的建议使用 IE 条件注释。 [“[！IE]”Haml 中](https://stackoverflow.com/questions/9107681/ie-conditional-comments-in-haml/9119406#9119406) 的条件注释但是它不起作用，我不知道为什么。

我正在尝试编辑 Ruby on Rails 应用程序，并且我是 HAML 和 Rails 的新手。任何帮助，将不胜感激。

这是我尝试使用的 HAML 代码。

```
%section#audio-controls
  =surround '<!--[if !IE]> -->'.html_safe, '<!-- <![endif]-->'.html_safe do  
    = audio_tag( '/audios/elder.wav', :controls => 'controls', :id => 'elder_audio' )
  =surround '<!--[if IE]> -->'.html_safe, '<!-- <![endif]-->'.html_safe do  
    = audio_tag( '/audios/elder.mp3', :controls => 'controls', :id => 'elder_audio' ) 
```

我也试过这段代码，认为这可能是 audio_tag 的问题

```
%section#audio-controls
  =surround '<!--[if !IE]> -->'.html_safe, '<!-- <![endif]-->'.html_safe do  
    %p
      This is not IE
  =surround '<!--[if IE]> -->'.html_safe, '<!-- <![endif]-->'.html_safe do  
    %p
      This is IE 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:55:17.203

HAML 支持使用[`/[]`语法](http://haml.info/docs/yardoc/file.REFERENCE.html#conditional_comments_)的条件注释。

将您的示例更改为这样的内容，它应该可以按预期工作：

```
%section#audio-controls
  /[if !IE]
    %p This is not IE, but this won't be rendered as all other browsers don't know about conditional comments
  /[if IE]
    %p This is IE 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:20:15.483

使用`html2haml`命令行实用程序将 HTML 转换为 HAML。

例如：

```
alhafoudh@Aluminium:~$ html2haml 
<!--[if IE 6]>
Special instructions for IE 6 here
<![endif]-->

^D
/[if IE 6]
  Special instructions for IE 6 here 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-07T13:29:42.333

对我来说有几个条件可以这样做：

```
!!!
:plain
  <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]--><!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]--><!--[if IE 8]><html class="no-js lt-ie9" lang="en"> <![endif]--> <!--[if IE 9]><html class="no-js lt-ie10" lang="en"> <![endif]--> <!--[if gt IE 9]><!-->
%html.no-js{:lang => 'en'}
  / <![endif]

  %head
    %title Yinlang 
```

# jquery-mobile - 如何更改图标的背景颜色

> ID：14205476
> 
> 赞同：1
> 
> 时间：2013-01-07T22:48:36.300
> 
> 标签：jquery-mobile

我想为按钮中的图标设置不同的背景颜色。例如，我想将信息图标的背景颜色更改为 NAVY

这是我试过的

在 HTML 中

```
<a href="index.html" data-role="button" data-icon="info" class="icon-navy" data-inline="true" data-iconpos="notext"></a> 
```

现在，在生成的按钮中，图标得到匹配的 CSS 规则 .ui-icon 链接具有规则 icon-navy。

有没有办法查看 .icon-navy 是否有 id 为 .ui-icon 的孩子并将背景色设置为

```
$('.icon-navy .ui-icon').css({'background-color':'navy'}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-28T09:31:08.013

我找到了一个解决方案，你必须创建一个新的 CSS 类

```
.ui-listview.customIconColor .ui-icon{
    background-color: #0fc21a /*{global-icon-color}*/;
    background-color: rgba(.05,.9,.1,.9) /*{global-icon-disc}*/;
} 
```

并将此类插入到您的

```
<ul class="customIconColor "></ul> 
```

标签，它对我来说很好。在您的情况下，将其插入

```
<a></a> 
```

标签也许。并检查数据角色，对我来说它是一个列表视图，根据需要修改 CSS 类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-28T10:28:14.920

```
.ui-icon-info {
    background-color: #FFFFFF !important;
} 
```

jQuery`.ui-icon`在`data-icon`属性之前添加。

动态改变颜色：`$('.ui-icon-info').css("background-color", "red");`

参见示例：http: [//jsfiddle.net/androdify/LVnZw/](http://jsfiddle.net/androdify/LVnZw/)

# jquery - jQuery UI Droppable - 阻塞覆盖区域

> ID：14205480
> 
> 赞同：2
> 
> 时间：2013-01-07T22:49:04.483
> 
> 标签：jquery, css, jquery-ui

我正在使用 jqueryui 可拖放/可拖放进行相当棘手的布局。

在一个部分中，div 容器内有一个可放置区域。容器已溢出：隐藏，但包含的可放置对象超出了容器的边界。

具体来说，假设我有一个 200px 高的 droppable 包含在一个 100px 高的 div 中，带有溢出：隐藏。

问题：当拖动一个可拖动元素时，它认为整个 200px 的可放置区域都是可放置的，即使只有 100px 通过容器暴露出来。

我怎样才能让可拖动/droppale 只尊重可放置的可见区域？

注意：此设计是包含许多 droppable 的较大复杂界面的一部分，并且此设置有正当理由。将不考虑“更改您的标记”的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:53:37.337

[JSFiddle](http://jsfiddle.net/xS7S9/)

每当父级调整大小时，您可以使子级可放置元素的大小调整为父级的高度和宽度。设置该侦听器后，只需触发父级调整大小事件，可放置容器将始终与父级的宽度和高度匹配。

```
$("#drop-container").resize(function(){
    $(this).find('#drop-content').width($(this).width());
    $(this).find('#drop-content').height($(this).height());
});
$("#drop-container").trigger('resize');
$("#drop-content").droppable({
    accept: '.special', 
    hoverClass: 'dropme'
});

$(".special").draggable(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-27T17:43:10.630

当您将表格作为内容但使用全局变量时，这是一个解决方案：

[内容为表格时的示例](http://jsfiddle.net/SilenoRocco/y5ajqq0w/ "JSFiddle - 当内容是表格时")

```
var DIV_AREA_OVER = false;

$("#drop-container").resizable();
$("#drop-container").droppable({ 
    hoverClass: 'dropme',
    over: function() { DIV_AREA_OVER = true; },
    out: function() { DIV_AREA_OVER = false; }
});
$("#table-content td").droppable({ 
    hoverClass: 'dropme',
    drop: function() {
        var wrap = $(this).closest('#drop-container');
        if (DIV_AREA_OVER == true) {
            $(this).addClass("accepted");
        }
    }
});
$(".special").draggable({
    start: function() { DIV_AREA_OVER = false; },
    stop: function() { DIV_AREA_OVER = false; }
}); 
```

# android - 如何在 Eclipse 上为 Android 开发画一个圆圈？

> ID：14205481
> 
> 赞同：0
> 
> 时间：2013-01-07T22:49:05.833
> 
> 标签：android, eclipse

我正在尝试在 Eclipse 中为 Android 开发创建一个圆圈，但找不到简单的教程。我刚开始为 Android 平台编程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:52:38.867

我建议您阅读[SurfaceView](http://developer.android.com/reference/android/view/SurfaceView.html)和[Canvas](http://developer.android.com/reference/android/graphics/Canvas.html)类。画布对象将允许您将圆形/椭圆形渲染到最终渲染到屏幕上的表面视图对象。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:13:39.147

这是创建圆形可绘制对象的语法。您将此代码放在您的 res 文件夹中（使用您希望的任何名称 - 例如 mycircle.xml）。

```
<?xml version="1.0" encoding="utf-8"?>
<shape
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="oval">
</shape> 
```

然后您可以引用此可绘制对象，并将其分配为任何视图的背景可绘制对象（可以在您的 layout.xml 或 Java 中完成）。例如：

textView.setBackgroundDrawable(R.drawable.mycircle);

# ruby-on-rails - git push heroku 和错误

> ID：14205482
> 
> 赞同：0
> 
> 时间：2013-01-07T22:49:15.987
> 
> 标签：ruby-on-rails, git, heroku, github, ruby-on-rails-3.2

当我使用 git push heroku 时，我想将我的 rails 应用程序推送到 heroku 我得到了这个错误，而且我在 heroku 中的应用程序根本没有改变。我使用导轨 3.27

无法加载此类文件 - uglifier（在 /Users/ehsanvalizadeh/Documents/cafemajale/cafemajale/app/assets/javascripts/application.js）/Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/ activesupport-3.2.7/lib/active_support/dependencies.rb:251:in `require' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.7/lib/active_support/dependencies.rb:251:in`block in require' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.7/lib/active_support /dependencies.rb:236:in `load_dependency' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.7/lib/active_support/dependencies.rb:251:in`require' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.7/lib/sprockets/compressors.rb:31:in`registered_js_compressor' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.7/lib/sprockets/bootstrap.rb:18:in`块在运行' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.7/lib/sprockets/compressors.rb:80:in`call' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.7/lib/sprockets/compressors.rb:80:in`压缩器' /Users/ehsanvalizadeh/.rvm/gems/ ruby-1.9.3-p194/gems/actionpack-3.2.7/lib/sprockets/compressors.rb:74:in`compress' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/processing.rb:265:in`块在 js_compressor=' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/processor.rb:29:in`call' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/processor.rb:29:in`评估'/Users/ehsanvalizadeh/。 rvm/gems/ruby-1.9.3-p194/gems/tilt-1.3.3/lib/tilt/template.rb:76:in`render' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/context.rb:177:in`块在评估'/Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3 -p194/gems/sprockets-2.1.3/lib/sprockets/context.rb:174:in`each' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/context.rb:174:in`评估'/Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/ lib/sprockets/bundled_asset.rb:26:in `initialize' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/base.rb:244:in`new' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/base.rb:244:in`build_asset' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/index.rb:89:in`块在 build_asset' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/caching.rb:19:in`cache_asset' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/index.rb:88:in`build_asset' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/base.rb:163:in `find_asset' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/index.rb:56:in`find_asset' /Users/ehsanvalizadeh/.rvm/gems /ruby-1.9.3-p194/gems/actionpack-3.2.7/lib/sprockets/static_compiler.rb:23:in `block in compile' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/base.rb:212:in`block in each_logical_path' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/ gems/sprockets-2.1.3/lib/sprockets/base.rb:200:in `block (2 levels) in each_file' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/base.rb:190:in`each' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets /base.rb:190:in `each_entry' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/base.rb:198:in`block in each_file' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/base.rb:197:in `each' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/base.rb:197:in`each_file ' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/sprockets-2.1.3/lib/sprockets/base.rb:210:in`each_logical_path' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.7/lib/sprockets/static_compiler.rb:18:in`编译' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.7/lib/sprockets/assets.rake:56:in`internal_precompile' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.7/lib/sprockets/assets.rake:70:in`块（3级）' /Users/ehsanvalizadeh /.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.7/lib/sprockets/assets.rake:60:in `block (3 levels) in <top (required)>' Tasks: TOP => assets:precompile:primary (See full trace by running task with --trace) rake aborted! Command failed with status (1): [/Users/ehsanvalizadeh/.rvm/rubies/ruby-1.9...] /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.7/lib/sprockets/assets.rake:12:in`ruby​​_rake_task' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3 -p194/gems/actionpack-3.2.7/lib/sprockets/assets.rake:21:in `invoke_or_reboot_rake_task' /Users/ehsanvalizadeh/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.7/lib/sprockets/assets.rake:29:in`block (2 levels) in ' Tasks: TOP => assets:precompile （通过使用 --trace 运行任务查看完整跟踪）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:04:26.777

放入此行或更改现有的`Gemfile`：

```
gem 'uglifier', :group => :production 
```

# javascript - 在其他元素上同步动画的滑动切换

> ID：14205484
> 
> 赞同：2
> 
> 时间：2013-01-07T22:49:33.720
> 
> 标签：javascript, jquery, html, css, slidetoggle

我有一个基本上有 2 个部分的网页：标题区域和内容区域。标题是固定 `position:fixed`的，即始终位于顶部。标题部分中有一些元素，我想在上面使用幻灯片功能。

我已经`padding-top`为内容区域设置了合适的。但是当标题元素的滑动执行时我需要更改它。它使用一种简单的`.CSS`方法。

示例代码：http: [//jsfiddle.net/kk7nJ/](http://jsfiddle.net/kK7nJ/)

我希望它有同步动画：即显示菜单时，应同时按下内容。现在它正在一个接一个地发生。

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T02:38:45.417

您遇到的问题源于您的 .slideToggle 调用正在使用设置持续时间的版本，然后在完成时调用函数调用动画，特别是（[如文档](http://api.jquery.com/slideToggle/)所述）：

> ### .slideToggle（[持续时间] [，完成]）
> 
> *   **持续时间**（默认值：400）
>     类型：数字或字符串 确定动画将运行多长时间的字符串或数字。
> *   **complete**
>     类型：Function()
>     动画完成后调用的函数。

虽然您的匿名函数有正确的想法，但它（如您所见）只会在动画完成后调用。

如果进一步向下滚动文档，您会发现以下调用格式：

> ### .slideToggle( 选项 )

因此，您以这种方式将对象传递给 .slideToggle 方法，而不是像以前那样只传递两个参数，从而为您提供更大的灵活性。

你应该注意的是：

> *   **step**
>     类型：Function(Number now, PlainObject fx)
>     动画每一步后调用的函数。

因此，我们构建选项对象以遵循您已经链接的内容的基本方法是简单地放入持续时间并加入其中，步骤调用以更改每个动画帧的内容元素的填充（这基本上就是一切由 jquery 动画开始，使其成为一个漂亮而整洁的解决方案）：

```
{
  duration: 'slow', step: function(){
    $(".content").css({'padding-top':$(".header").outerHeight()});
  }
}
```

这是[实现 this 的 jsfiddle](http://jsfiddle.net/wz7jt/3/)，至少在 chrome 中似乎工作得很好，即使内容框架向下滚动/等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T00:46:11.173

与其操纵填充，不如在页面顶部放置一个隐藏的 div 并将其切换到标题的对面？我怀疑不同的转换类型是您问题的根源。

这是一个显示此的示例：

```
<div class="header">
   <ul class="menu"><li>One</li><li>Two</li><li>Three</li><li>Four</li></ul>
   <a href="javascript:void(0)" id="pull">pull</a>
 </div>

<div class="menu-pad"></div>

$("#pull").on("click",function(){
  $(".menu, .menu-pad").slideToggle('slow');
}); 
```

[http://jsfiddle.net/MV5kB/1/](http://jsfiddle.net/MV5kB/1/)

# winforms - 在具有绑定到空数据源的 bindingNavigator 的 winforms 中-如何自动添加记录？

> ID：14205486
> 
> 赞同：0
> 
> 时间：2013-01-07T22:49:44.767
> 
> 标签：winforms, entity-framework-5, bindingsource

我首先使用 EF 代码，并且有一个带有绑定到数据源的 bindingNavigator 的 windows 窗体。数据输入文本框也绑定到数据源

我希望它能够工作，以便
当用户打开表单时，如果数据源中没有记录，那么表单的行为就像用户单击了添加按钮一样。

我试过了

```
private void PersonForm_Load(object sender, EventArgs e)
    {
        if (bindingSource1.Count == 0)
        {
            bindingNavigator1.BindingSource.AddNew();
        }
    }
private void bindingSource1_AddingNew(object sender, System.ComponentModel.AddingNewEventArgs e)
    {
        e.NewObject = CreatePerson();
    }

 private Person CreatePerson()
    {
        var obj = new Person();
        obj.RowId = Guid.NewGuid();
        return obj;
    } 
```

但是记录选择器保持禁用状态，当我在导航栏中单击保存时，新记录不会保存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T09:42:11.850

我发现如果我在设置数据源之前添加了实体，导航器的行为就像我想要的那样

```
DbSet<Person> dset = Db.People;
bindingList = dset.Local.ToBindingList();
if (bindingList.Count == 0)
{
   var obj = CreatePerson();
   dset.Local.Add(obj);
}
 binding.DataSource = bindingList; 
```

# typo3 - Typo3: t3lib_userAuth::getRawUserByUid: 不在对象上下文中使用 $this

> ID：14205487
> 
> 赞同：0
> 
> 时间：2013-01-07T22:49:45.950
> 
> 标签：typo3

我正在尝试使用 t3lib_userAuth 类在 Typo3 中检索特定用户的数据。具体来说，我正在这样做：

```
$user = t3lib_userAuth::getRawUserByUid ($uid); 
```

我收到以下错误：

```
Fatal error: Using $this when not in object context in /var/www/html/test/typo3_477/t3lib/class.t3lib_userauth.php on line 1384 
```

这是有道理的，因为我没有实例化这个类。但是， t3lib_userAuth 没有构造方法，所以我不知道如何正确实例化它。

有人知道如何正确设置/初始化此类或如何使用 Typo3 API 检索已配置的类吗？

问候/谢谢罗伯特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T11:03:41.873

实际上`t3lib_userAuth`是一个抽象类，这意味着您可能必须实例化 a`t3lib_beUserAuth`或`t3lib_feUserAuth`类（查看继承图，例如[http://api.typo3.org/typo3cms/45/html/classt3lib__user_auth.html](http://api.typo3.org/typo3cms/45/html/classt3lib__user_auth.html)）。

通常在大多数 TYPO3 上下文中，您已经拥有其中一个 - 例如`$GLOBALS['TSFE']->fe_user`，否则您可以使用该`t3lib_div::makeInstance()`方法获得一个。

# java - 即使我没有指定必要的代理，Eclipse 也会连接到网络

> ID：14205488
> 
> 赞同：0
> 
> 时间：2013-01-07T22:49:47.167
> 
> 标签：java, eclipse, proxy

这是一个令人费解的情况。我有一个在需要使用代理来访问网络的机器上运行的可移植版本的 Eclipse。据我所知，我还没有将任何代理信息输入到 Eclipse 设置中。实际上，您可以在下面看到网络首选项的样子（我不确定“动态”条目的含义）。

我已经为我的代理服务器的名称搜索了整个安装文件夹，但它似乎不在任何地方。我认为其他任何地方都没有此便携式安装的配置文件。

然而，即使我没有指定代理，Eclipse 也能够很好地连接到互联网（使用内部浏览器、市场、SVN/GIT 存储库等进行了测试）。这怎么可能？不幸的是，我无法在这台机器上安装 Wireshark，但我相当肯定 Eclipse 会以某种方式将其请求发送到代理。

![在此处输入图像描述](../Images/73f165295b23ec616062b9e83f2f1fcd.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T23:35:59.117

注意上面写着“Native”的地方

如果这是在 Windows 机器上（从窗口的外观可以看出），这意味着它正在使用您在 IE 中设置的代理设置。

（您在 IE9 中设置该代理信息，例如，从“齿轮图标”下的“互联网选项”选项中选择“连接”，然后单击“局域网设置”按钮。）

# php - 将 PHP 应用程序移动到 IIS 服务器

> ID：14205489
> 
> 赞同：0
> 
> 时间：2013-01-07T22:49:53.643
> 
> 标签：php, iis-6, windows-server-2008

我们有一个在 linux 服务器上运行的 PHP 应用程序，然后将 PHP 应用程序复制到本地 Windows 服务器。 `phpinfo()`工作正常，但在查看页面时，我们会在页面上获得代码，例如`''){?>` 或

```
'' ORDER BY rand() LIMIT 1 " ; $sql_result=mysql_query($sql,$connection) or die ... 
```

索引页第一行有这个代码，

```
<? $pagex="mainpage"; include("_inc_header.php");?> 
```

然后我将其更改为`<?php ...`页面不显示任何内容。当我不更改它时，Chrome 会将其呈现为类似的评论`<!-- ....`

当我在我的 Mac（使用 MAMP）上尝试该应用程序时遇到小问题时，它可以正常工作。还启用了 display_errors 我得到了数百个

> 注意：未定义索引：
> 注意：未定义变量：
> 注意：使用未定义常量

几乎使页面不可读:(

据我所见，我的本地 Windows 服务器的 IIS 有问题……知道如何解决吗？至少在 Mac 上，我看不到 PHP 代码呈现为 HTML :D

ps：我已经在 Windows Server 上尝试了包含基本 PHP 的包含函数，并且它有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T23:03:49.820

改变

```
 <? to <?php 
```

在你的所有文件中

或者只是允许

```
short_open_tags = on 
```

在 php.ini 中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:26:39.320

这太奇怪了，但在启用 short_open_tags 和 asp_tag=on 代码后正常工作。只有图像有一些问题，但是当我检查代码时，编码器没有使用相对路径。

感谢您指点short_open_tag 家伙！:)

# jquery - 通过 JQuery 删除函数

> ID：14205491
> 
> 赞同：0
> 
> 时间：2013-01-07T22:50:00.863
> 
> 标签：jquery, javascript-events

我是新手。这是代码。

```
 $(window).resize(function() {
        screenlarge();
    });
    $(window).resize(function() {
        screensmall();
    });
    function screenlarge()  {
      windowsize = $(window).width();
      if (windowsize < 1040) {
          $('#wrappernav').fadeOut("fast");
          $('#sidebar').fadeOut("fast");
          $('#wrappernavbg').fadeOut("fast");
          $('#navigationon').fadeIn("fast");
    }
    } 
    function screensmall()  {
      windowsize = $(window).width();
      if (windowsize >= 1040) {
          $('#wrappernav').fadeIn("fast");
          $('#sidebar').fadeIn("fast");
          $('#wrappernavbg').fadeIn("fast");
          $('#navigationon').fadeOut("fast");   
    }
    }
$(document).ready(function(){
    $('#naviclosed').bind('click', function () {
        $('#wrappernav').fadeIn("fast");
        $('#sidebar').fadeIn("fast");
        $('#wrappernavbg').fadeIn("fast");
        $('#navigationon').fadeOut("fast");
    });
        $("#arrow").bind('click', function(){
        $('#wrappernav').fadeOut("fast");
        $('#sidebar').fadeOut("fast");
        $('#wrappernavbg').fadeOut("fast");
        $('#navigationon').fadeIn("fast");
    });
}); 
```

我的问题是如何在按#arrow 时删除screenlarge() 和screensmall()，并在按#navigationon 时再次添加这些功能。

请帮忙！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:53:03.863

First of all, merge `screenlarge` and `screensmall` into single function like `sreenSize`. Just for clarity.

To unbind the event, simply do

```
$(window).off('resize', screenSize); 
```

If you have no other event handlers for 'resize' event, you can also do it like this:

```
$(window).off('resize'); 
```

# eclipse - 在 Talend 中重新打开错误关闭的窗口

> ID：14205493
> 
> 赞同：0
> 
> 时间：2013-01-07T22:50:08.233
> 
> 标签：eclipse, talend

在 Talend Open Studio 中，如果您在单独的窗口中打开组件视图（即，而不是停靠），并按 Esc 取消自动完成菜单（例如在编辑 Java 组件的某些代码时），则整个窗口将关闭，即使该窗口中有多个视图。这真的很烦人，而且很浪费时间。

有没有人知道一种方法...

1.  禁用 Esc 键关闭窗口或
2.  快速恢复刚刚关闭的窗口（以及其中的所有视图）？

由于 Talend 构建在 Eclipse 之上，也许你们中的一些 Eclipse 专家可能知道如何在 Eclipse 中执行此操作，这也可能适用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T14:26:45.843

据我所知，没有办法`ESC`在 Eclipse 或 Talend 中禁用快捷方式。但是，您可以做的是为组件视图分配一个快捷键。见附图。

![在此处输入图像描述](../Images/6d89a83aa1960fced2a793e66428dfab.png)

# java - 你需要在 Java 中转义 * 字符吗？

> ID：14205498
> 
> 赞同：10
> 
> 时间：2013-01-07T22:50:23.407
> 
> 标签：java, string, split, escaping, wildcard

所以我在我的一个程序中写了一小段代码，它使用 split 方法来解析和排序字符串中的各个组件。以下是代码示例：

```
String[] sArray;

String delimiter = "*";

String test = "TEXT*TEXT*TEXT*";
String a = "";
String b = "";
String c = "";

sArray= test.split(delimiter);

a = sArray[0];
b = sArray[1];
c = sArray[2];

System.out.println("A is: " + a + "\nB is: " + b + "\nC is: " + c); 
```

但是，当我运行这个程序时，它返回一个错误，指出：

`Dangling meta character '*' near index 0`

所以我用谷歌搜索了这个错误，发现它可能与如何`*`在正则表达式中被视为通配符的问题有关。所以我尝试了：

`String delimiter = "\*"`

但这只是返回了另一个错误，说明：

`illegal escape character`

有没有人遇到过这个问题，或者知道你（如果你是）应该如何`*`在 Java 中逃脱？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-07T22:51:25.947

您还必须转义反斜杠：

```
String delimiter = "\\*"; 
```

因为字符串文字`"\\"`只是一个反斜杠，所以字符串文字`"\\*"`表示转义的星号。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-07T23:03:22.750

理解解决方案的方法是意识到这里有两种“语言”在起作用。您拥有正则表达式语言（Java 风格），其中`*`是一个元字符，需要用 a 转义`\`以表示文字`*`。那给你

```
''\*''    // not Java yet ... 
```

但是您试图用 Java 字符串文字的“语言”来表示该字符串，其中 a`\`是转义字符。所以这要求任何文字`\`（无论我们试图表示什么）都必须被转义。这给你

```
"\\*"     // now Java ... 
```

如果您始终如一地应用这种方法/思考-“首先进行正则表达式转义，然后进行字符串文字转义”-您将不会感到困惑。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-06-19T17:21:24.413

您必须在“*”之前附加“\”，就好像您想在 java 中表示“\”一样，您必须在它之前再使用一个“\”。

所以，“\”代表：----->“\”所以如果你想使用“ *”作为分隔符，使用“\* ”

更正的代码：

```
String delimiter = "\\*";
String test = "TEXT*TEXT*TEXT*";
String a = "";
String b = "";
String c = "";
sArray= test.split(delimiter);
a = sArray[0];
b = sArray[1];
c = sArray[2];
System.out.println("A is: " + a + "\nB is: " + b + "\nC is: " + c); 
```

**输出：**

> A 是：文本
> 
> B 是：文本
> 
> C 是：文本

# asp.net-mvc-4 - 将字符串转换为双小数点需要是一个点

> ID：14205499
> 
> 赞同：0
> 
> 时间：2013-01-07T22:50:27.180
> 
> 标签：asp.net-mvc-4, double, viewbag

我一直在这里环顾四周，我找到了这个解决方案：

```
ViewBag.lon = double.Parse(parts[1], CultureInfo.InvariantCulture); 
```

这就是诀窍......部分......当我把这个值放在我的 ViewBag 中并写出来时，'。' 突然变成'，'......我可以解决这个问题吗？

似乎一切都很好，直到将其从 ViewBag 中取出……在 ViewBag 中它们都很好……

任何解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:54:39.257

可能发生的情况是您的默认文化使用逗号作为小数点（例如西班牙）。强制它的一种方法是把它写出来，提供一个格式字符串：

```
@(ViewBag.lon.ToString("#,##0.00")) 
```

请参阅：http: [//msdn.microsoft.com/en-us/library/0c899ak8.aspx](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)

# ios - 带有滑出表格视图的 UIPageViewController

> ID：14205504
> 
> 赞同：0
> 
> 时间：2013-01-07T22:50:50.893
> 
> 标签：ios, uipageviewcontroller

嗨，我已经用几种不同的方法来实现这个，但似乎无法使任何工作。我要做的是有一个标准的 UIPageViewcontroller，顶部有一个工具栏，然后当点击左上角的工具栏按钮时，PageView 向右滑动（例如 Path 或 Facebook），显示一个 tableView。

我可以让其中任何一个单独工作没有问题，但我很难让这些多个视图控制器与 appDelegate 一起工作。我主要使用 ViewDeck：[https](https://github.com/Inferis/ViewDeck) ://github.com/Inferis/ViewDeck来实现滑出，但如果有另一种更容易使用 pageviewcontroller 实现的方法，我肯定愿意接受。

我真的没有太多要发布的代码，因为我仍然只是想从概念上弄清楚。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:07:31.950

**编辑后：**

做你想做的事，我认为最好将下一个控制器添加为页面视图控制器的子视图控制器（即DataViewController中的self.parentViewController）。

```
#import "DataViewController.h"
#import "NextController.h"
#import "ModelController.h"

@implementation DataViewController {
    BOOL viewRevealed;
    NextController *next;
}

- (void)viewDidLoad {
    [super viewDidLoad];
    viewRevealed = NO;
}

- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    self.dataLabel.text = [self.dataObject description];
}

-(IBAction)slideInController:(UIButton *) sender {
    if (viewRevealed == NO) {
        next = [self.storyboard instantiateViewControllerWithIdentifier:@"Blue"];
        next.view.frame = self.parentViewController.view.frame;
        [self.parentViewController addChildViewController:next];
        [self.parentViewController.view insertSubview:next.view belowSubview:self.view];
        [next didMoveToParentViewController:self.parentViewController];
            [UIView animateWithDuration:.6 animations:^{
                self.view.frame = CGRectMake(self.view.frame.origin.x + self.view.frame.size.width/2, self.view.frame.origin.y, self.view.frame.size.width, self.view.frame.size.height);
            } completion:^(BOOL finished) {
                viewRevealed = YES;
                [(ModelController *)[(UIPageViewController *)self.parentViewController dataSource] setSlidOff:TRUE];
            }];
    }else{
        [UIView animateWithDuration:.6 animations:^{
            self.view.frame = CGRectMake(self.view.frame.origin.x -  self.view.frame.size.width/2 , self.view.frame.origin.y, self.view.frame.size.width, self.view.frame.size.height);
        } completion:^(BOOL finished) {
            [next.view removeFromSuperview];
            [next removeFromParentViewController];
            viewRevealed = NO;
            [(ModelController *)[(UIPageViewController *)self.parentViewController dataSource] setSlidOff:FALSE];
        }];
    }
} 
```

这是DataViewController 中的所有代码。我添加了一些必要的 ivars。在我的测试应用程序中，我将 slideInController 方法连接到双击手势识别器。如果在 DataView 部分显示在屏幕上时单击或滑动会发生奇怪的事情，因此我在 ModelController.h 文件 (slidOff) 中添加了一个 BOOL 属性，并在该类的 init 方法中将其设置为 FALSE。然后，我在两个页面视图数据源方法中的 if 语句中添加了另一个条件来检查该属性。当 slidOff 为 TRUE 时，滑动手势识别器不会做任何事情。这是 ModelController 中的这 2 个方法，因为我对其进行了修改：

```
- (UIViewController *)pageViewController:(UIPageViewController *)pageViewController viewControllerBeforeViewController:(UIViewController *)viewController
{
    NSUInteger index = [self indexOfViewController:(DataViewController *)viewController];
    if ((index == 0) || (index == NSNotFound) || _slidOff) {
        return nil;
    }

    index--;
    return [self viewControllerAtIndex:index storyboard:viewController.storyboard];
}

- (UIViewController *)pageViewController:(UIPageViewController *)pageViewController viewControllerAfterViewController:(UIViewController *)viewController
{
    NSUInteger index = [self indexOfViewController:(DataViewController *)viewController];
    if (index == NSNotFound || _slidOff) {
        return nil;
    }

    index++;
    if (index == [self.pageData count]) {
        return nil;
    }
    return [self viewControllerAtIndex:index storyboard:viewController.storyboard];
} 
```

# ios - Odd SplitView/NavigationController behavior in iOS6

> ID：14205511
> 
> 赞同：3
> 
> 时间：2013-01-07T22:51:15.887
> 
> 标签：ios, ipad, ios6, uisplitviewcontroller

This is a long shot but I figured I'd see if anybody else has seen/fixed this issue.

I have an pre-IOS 6 app that uses a `UISplitViewController` with `NavigationControllers` in both the master and detail pane.

In iOS 5 and earlier, if I push a `UIViewController` onto the master navigation controller, it slides in; popping that view controller then slides it back out.

In iOS 6, in landscape orientation only, if I push a `UIViewController` onto the master navigation controller it slides in; however, popping that view controller then appears to consider the viewcontroller modal because it centers the view controller in the screen and then drops it to the bottom like a "`dismissModalController`" command would do. If it is in portrait mode, it slides in/out as expected.

I'm not sure what to do about this - Newer apps with similar layouts don't have this problem. I suspect it has something to do with the initial window/navigator setup which (in this app) was configured the old way with `MainWindow.xib` and `MainWindow-iPad.xib`. I'd rather not try to rip all that out and reconfigure using the "new" way (which does it all in the `appdelegate`)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T10:19:41.223

在我的视图控制器中实现以下内容为我解决了

```
-(NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskAll;
} 
```

希望它也适用于你

# mysql - Column count doesn't match value count at row 1 VendorError:1136

> ID：14205514
> 
> 赞同：2
> 
> 时间：2013-01-07T22:51:22.800
> 
> 标签：mysql, jdbc

I am having the following error:

**Column count doesn't match value count at row 1**

and my code is:

```
Connection             con=DriverManager.getConnection("jdbc:mysql://127.0.0.1/BFPL","root","[PASSWORD]");
PreparedStatement ps=con.prepareStatement("Insert into User values(?,?,?,?,?,?)");
ps.setString(1,t52.getText());
ps.setString(2,pw2.getText());
ps.setString(3,t53.getText());
ps.setString(4,t54.getText());
ps.setInt(5,100);
ps.setInt(6,11);
ps.executeUpdate();
PreparedStatement ps1=con.prepareStatement("Insert into User_Team values(?,?)");
ps1.setString(1,t52.getText());
ps1.setInt(2,0);
ps1.executeUpdate();
con.close(); 
```

in first table user their are 6 columns, and in 2nd table User_team their are 13 columns in which i am inserting just 2 values from which 1st value is primary key.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T22:53:55.393

如果您没有在表的所有列中插入，那么您必须像这样在插入查询中命名要插入的列

```
Insert into User_Team (col1, col4) values(?,?) 
```

想一想——数据库引擎应该如何知道这些值属于哪些列？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T22:54:43.593

```
PreparedStatement ps1=con.prepareStatement("Insert into User_Team (col_name1, col_name2) values(?,?)"); 
```

# javascript - How to query by "equals" and $in on the same field with Mongo?

> ID：14205519
> 
> 赞同：0
> 
> 时间：2013-01-07T22:51:50.150
> 
> 标签：javascript, mongodb

Basically, the end goal is to provide a default scope to all my DB queries. This means limiting all queries to a set of object IDs. My question is, how can I query by ID and make sure that the query is limited to my list of Object IDs?

I'd like to do something like this:

```
db.posts.findOne({_id: ObjectId("50eb4a874947fb00e3cc0612")})
        .where({_id: { $in: [ObjectId("50eb4a874947fb00e3cc0610"),ObjectId("50eb4a874947fb00e3cc0611")] }}); 
```

As You can see, the query should return no results because the queried ID is not in the $in array of object IDs.

Btw, the above query just gives me an error saying `db.posts.findOne({_id: ObjectId("50eb4a874947fb00e3cc0612")}).where is not a function (shell):1`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:56:42.703

这听起来很奇怪，但您可以尝试`$and`（[http://docs.mongodb.org/manual/reference/operators/#_S_and](http://docs.mongodb.org/manual/reference/operators/#_S_and)）将这两个子句组合起来，例如：

```
db.col.find({
    $and:[
        {_id: ObjectId("50eb4a874947fb00e3cc0612")},
        {_id: {
            $in: [
                ObjectId("50eb4a874947fb00e3cc0610"),
                ObjectId("50eb4a874947fb00e3cc0611")
            ]
         }}
     ]
 }); 
```

这是我相信的一种方法。

# ruby - How do I set request payload in RSpec for Sinatra?

> ID：14205521
> 
> 赞同：1
> 
> 时间：2013-01-07T22:51:56.070
> 
> 标签：ruby, rspec, sinatra, rack

I'm trying to test my controller but my controller accept request payload for the whole json string which I can't seem to figure out how to set it in RSpec.

Here's my RSpec code

```
 xit "should update favourite movies" do
      rack_mock_session.cookie_jar["auth_token"] = "1"

      put '/user', :params => {:movie => "1}.to_json
      last_response.should be_ok

end 

```

And this is my controller code

```
 raw = request.env["rack.input"].read
  raw_json = JSON.parse(raw)

  movie_id = raw_json["movie"]
  ... 

```

But it doesn't work.

# json - 从 Splunk REST API 获取聚合结果而不是事件

> ID：14205523
> 
> 赞同：0
> 
> 时间：2013-01-07T22:51:59.417
> 
> 标签：json, api, rest, curl, splunk

在每天查询一组事件的 Splunk API 时遇到问题。我的目标是为一组服务器日志返回包含 7 天事件计数（展示次数和唯一性）的 JSON。搜索如下：

```
index=assets_index gid=30 | timechart count(clientip) AS Impressions dc(clientip) AS Uniques 
```

当我运行此搜索并在终端中获取结果时：

```
curl -u admin:ourpass -k https://ourserver.com:8089/services/search/jobs -d"search=search index=assets_index gid=30 | timechart count(clientip) AS Impressions dc(clientip) AS Uniques"
curl -u admin:ourpass \
     -k https://ourserver.com:8089/services/search/jobs/1357597855.2304/results/ \
     --get -d output_mode=json 
```

我从搜索中获取原始事件，而不是结果（在 Web 搜索应用程序中运行它会返回我想要的结果）。我确信有一种简单的方法可以请求结果，但我找不到它。帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T01:01:28.850

你非常接近......只是你传递参数的方式是错误的。每个请求参数都应使用 -d 标志单独传递，并且参数值需要进行 URL 编码。试试这个，看看它是否适合你：

`curl -u admin:ourpass -k https://ourserver.com:8089/services/search/jobs -d search="search index%3Dassets_index gid%3D30 | timechart count(clientip) AS Impressions dc(clientip) AS Uniques`"

不确定您的 web 应用程序是什么语言，Splunk 也有多种语言的[SDK 。](http://dev.splunk.com/view/sdks/SP-CAAADP7)通过 SDK 并让它们处理与 Splunk 的对话可能会更容易。

# node.js - Node+Express: Multiple authentication strategies according to page and user type

> ID：14205526
> 
> 赞同：2
> 
> 时间：2013-01-07T22:52:17.383
> 
> 标签：node.js, mongodb, authentication, login, express

I am new to node and I want to start building the following application:

The app should be a catalog of services offered by certain businesses. Users should be able to start and track the status of processes along with listed services providers.

So there are four databases:

1.  Admins
2.  Users
3.  Businesses
4.  Processes

And three types of users:

1.  Admin = Me (Authentication: username+password)
2.  Business (Authentication: username+password)
3.  User (Authentication: facebook)

Admins should have CRUD permissions to all databases. Businesses can only perform CRUD to their own profile (provided service) and update relevant processes. Users can perform CRUD to their on going processes.

I read a lot about npm modules like everyauth, mongoose-auth, passport but I have difficulties understanding their relationships with databases like mongodb especially when I have three types of users with three different permissions and four databases. I dont know how pages can check for three different types of cookies.

Should I create three different login and regestration systems? If yes, how?

Can someone please help me out..not with code..but with a concept or a relevant tutorial.

* * *

Passport requires the [following](http://passportjs.org/guide/username-password/) for username & password configuration:

What I can't understand is:

1.  Where is the resulting database?
2.  How can I connect a mongodb database that I can access later?
3.  How should the app.get() look like to redirect users to corresponding login page?
4.  How can I implement this for three different login pages (adminLogin, businessLogin, userLogin) with three corresponding databases (admin, business, user)?
5.  How can I check if correct type of cookie is available on three different home pages (adminHome, businessHome, userHome)?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T02:04:25.083

我的建议：

1.  使用“快递”。
2.  使用“护照”。请注意，“mongoose-auth”建立在“everyauth”之上，它们可以正常工作，但我喜欢“passport”中“strategies”概念的灵活性，“express”集成更好。您可以使用任何具有 Passport Local 策略的数据库/方法（如 LDAP）来存储凭据，这在护照教程中进行了说明。此外，Passport Facebook 策略已经定义并可以使用。
3.  如果可能，请为三个用户组中的每一个设置单独的快速路由 (URL)。在同一条路由上管理多个身份验证策略变得看似复杂且不可靠。
4.  企业或用户不太可能需要直接访问数据库。因此，数据库只需要一个网络服务器到数据库服务器的连接。因此，如果您的 Web 服务器是安全的，您可能根本不需要数据库身份验证，即使您确实需要它，该连接也仅供管理员使用。但是，您应该阅读这些[Mongo 安全建议](http://docs.mongodb.org/manual/administration/security/#strategies-for-reducing-risk)以了解潜在的安全问题。

# ironpython - 访问不存在的方法或属性后托管 IronPython 恢复？

> ID：14205532
> 
> 赞同：1
> 
> 时间：2013-01-07T22:52:35.980
> 
> 标签：ironpython

有没有办法让托管的 IronPython 引擎在访问对象实例的不存在的方法或属性后恢复脚本的执行？通常会抛出一个异常，不幸地会中断脚本的执行。

我使用几个不同的 C# 类（例如 A 类和 B 类）的实例来执行 IronPython 脚本，这些实例在它们的作用域中实现了或多或少相同的方法和属性。然而，除了两个类共享的方法和属性之外，A 类还实现了更多的方法和属性。

类 A 可能并且应该继续抛出异常，因为脚本访问的此类的方法必须存在。如果他们不这样做，那么脚本确实有问题。

然而，B 类**只是**或**可视化**目的，因此 IronPython 可以忽略/跳过对此类中不存在但在 A 类中的方法的调用并继续执行。

任何的想法？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T09:14:48.070

通过从 DynamicObject 继承类 B，使用*动态*作为运行脚本的方法的参数类型并在类 B 中执行此操作

```
 public override bool TryInvokeMember(InvokeMemberBinder binder, object[] args, out object result)
    {
        base.TryInvokeMember(binder, args, out result);
        return true;
    }

    public override bool TryInvoke(InvokeBinder binder, object[] args, out object result)
    {
        base.TryInvoke(binder, args, out result);
        return true;
    }

    public override bool TryGetMember(GetMemberBinder binder, out object result)
    {
        base.TryGetMember(binder, out result);
        return true;
    }

    public override bool TrySetMember(SetMemberBinder binder, object value)
    {
        base.TrySetMember(binder, value);
        return true;
    } 
```

我可以实现我的要求。以这种方式忽略对不存在的方法或属性的每次调用。无论呼叫来自什么来源。但是，对现有方法/属性的调用照常工作。

# javascript - jQuery 在本地工作，但不是实时的

> ID：14205534
> 
> 赞同：-1
> 
> 时间：2013-01-07T22:52:37.773
> 
> 标签：javascript, jquery, upload, local

我已经上传了我的第一个合适的主页，它使用了一些 jQuery 插件。这些在本地都可以正常工作，但是在正确引用和上传所有相关插件文件的情况下，它在我的服务器上托管时不起作用。

[http://www.darrenbarklie.com](http://www.darrenbarklie.com)

我已经阅读了关于 SE 的其他答案，但我仍然不知道为什么会发生这种情况，并且真的很感激所提供的任何帮助。我对服务器端管理员的经验很少，有什么我应该改变权限的吗？我在这方面花了很多时间，卡在最后一个障碍上是非常令人沮丧的。如果我在本地托管文件或链接到 googleapis，jQuery 似乎不起作用。

提前真诚感谢。

（请注意，这是一项正在进行的工作，因此可能存在一些跨浏览器差异 - 到目前为止，仅在 FF 中编码和测试。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:05:05.800

您在[**这里**](http://www.darrenbarklie.com/js/)`/js/`公开目录的结构[](http://www.darrenbarklie.com/js/)

 **您会注意到您引用了 hoverintent 和 poshytip 错误。

`poshytip.js`应该是`poshytip.min.js`而且`hoverIntent.js`应该是`hoverintent.js`

更不用说 iframe 回调无法正常工作的问题......**

# javascript - JavaScript regexp replace $0

> ID：14205538
> 
> 赞同：1
> 
> 时间：2013-01-07T22:52:43.847
> 
> 标签：javascript, jquery, replace

I have this jQuery, and I would like to search for a string and replace it. I know with php I can use `$0, $1, $2` etc. to get the matches.

This is how I would do this via php `$0` in this example would be replaced with the found `plater` and keep it's upper/lower casing:

```
preg_replace("/plater/i", "<span class='plater'>$0</span>", $input); 
```

How can I do this in javascript? When I try $0 it actually outputs $0 to the browser, and not what was found. Here is what I currently have:

```
$(document).ready(function(){
    var html = $("body").html();
    $("body").html(html.replace(/plater/ig, "<span class='plater'>$0</span>"));
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:56:56.247

用括号捕获它并使用 $1 来指代“第一个”捕获组。

```
html.replace(/(plater)/ig, "<span class='plater'>$1</span>") 
```

几种语言的正则表达式指南：[http ://www.regular-expressions.info/javascript.html](http://www.regular-expressions.info/javascript.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T22:56:20.293

要替换字符串：

```
html.replace(/(plater)/ig, '<span class="plater">$1</span>'); 
```

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T22:56:17.203

由于您只是在搜索“盘子”，因此您可以省去麻烦，只需`plater`在字符串中写入单词，但`$&`可用于引用整个匹配项。

# android - ListFragment RuntimeException 'android.R.id.list' missing

> ID：14205540
> 
> 赞同：0
> 
> 时间：2013-01-07T22:52:53.120
> 
> 标签：android, android-listfragment, android-fragmentactivity

**Edit 1/16/2013:** Problem Resolved! Two days ago, I released an updated version of the app and **correctly** identified the `ListViews` as I had originally done, by using `android:id="@android:id/list`. Really though, the exception being thrown was misleading and that had nothing to do with the actual problem...

The real fix came when I implemented the suggestions by Sean on inflating the `ListFragment` views by passing `null` to the `ViewGroup`. I have not received the same Exception from the new version, and the new version has been downloaded by enough devices to safely say this issue is resolved. However I really appreciate the comments and answer made by Lawrence, and will continue to read about how he is instantiating the Fragments. While he provided the suggestion of passing null to the View inflater, Sean was actually the first to do so, and since his solution seems to have resolved the issue, the bounty will be awarded accordingly. I will update this thread in the future if I learn/read more about the different ways of instantiating the Fragments as suggested by Lawrence's excellent answer. Too bad I can't split the bounty!

**Edit 1/14/2013:** `ListView` related `XML` files are located at [http://pastebin.com/2xnG1VfF](http://pastebin.com/2xnG1VfF) per @LawrenceChoy's request

**Edit 1/13/2013:** I released an updated version of my app and used `android:id="@+id/android:list` instead of `android:id="@android:id/list"` per Bishan's suggestion, however I am still receiving random exceptions that my Fragment Actvity does not have `a ListView whose id attribute is 'android.R.id.list'`, even though that activity does not have any `ListViews`. Added another exception from LGE phone.

**Edit 1/9/2013:** Although Bishan provided an answer, I was hoping for a little more explanation as to why his solution might prevent this exception. After reading further I believe it is because when using a custom `ListView`, one should use a + symbol. However would like to get confirmation I am correct or to get clarification, especially considering both seem to work on many different devices and emulators. Raising a bounty in about 20 minutes to seek a reputable source/answer on the matter. Thanks.

* * *

I'm getting some very odd behavior from a few devices out in the wild after a recent updated release to the play store.

In my new release I have a `FragmentActivity` (called TabsStyled) that uses a `FragmentStatePagerAdapter` to manage several fragments. I have a total of 4 fragments, and 2 of those fragments extend `ListFragment` and have listviews populated by `LoaderManager` and `CursorLoader`, all from `support.v4` libraries. The other two fragments do not have `ListViews` and do not extend `ListFragment`.

I did extensive testing on multiple devices as well as AVDs and never encountered any RuntimeExceptions for missing android.R.id.list.

However, upon release, a few ACRA crashes showed up for the FragmentAcitivty `"Your content must have a ListView whose id attribute is 'android.R.id.list'"`. TabsStyled.class is the `FragmentActivity` that manages the ListFragments and itself does not have any `ListViews'. This seems very strange to me, since I would think that if this exception were to be thrown, it should be for one of the ListFragments, and not the "parent" FragmentActivity.

Here's the top of the stack trace, and I'm happy to provide any additional code or info as requested rather than paste everything here.

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.myapp.hiddenforsecurity/com.myapp.hiddenforsecurity.TabsStyled}: 
java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list' 
```

A full stack trace available on pastebin here: [http://pastebin.com/aiV7pwXP](http://pastebin.com/aiV7pwXP).

The XML for each of the `ListFragments` which contain the ListViews (a separate `ListView` in a separate XML for each `ListFragment`):

```
<ListView android:id="@android:id/list" 
    <!--the release currently uses "@+id/android:list)-->
    android:layout_width="fill_parent" 
    android:layout_height="0dip" 
    android:layout_weight="45" /> 
```

One of the `ListFragments` (slightly simplified to make this easier to diagnose) uploaded to pastebin (the other ListFragment is very similar): [http://pastebin.com/Nts3nVx1](http://pastebin.com/Nts3nVx1)

And a slightly simplified full version of TabsStyled (`FragmentActivity`): [http://pastebin.com/ZS4Xg8kP](http://pastebin.com/ZS4Xg8kP)

The devices that created the exceptions thus far (and as of 1/14 they continue to post crashes):

```
MODEL       BRAND    ANDROID API
GT-I9305    Samsung  4.1.1 (using @android:id/list)
GT-S7562    Samsung  4.0.4 (using @android:id/list)
GalaxyNexus Samsung  4.2.1 (same exception seen with @+id/android:list)
L-01E       LGE      4.0.4 (same exception seen with @+id/android:list) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T17:32:43.817

只是预感，但尝试在不使用 ViewGroup 的情况下为 ListFragment 扩展自定义视图。所以在你的 ListFragment 改变

```
View logv = inflater.inflate(R.layout.listroot, container, false); 
```

至

```
View logv = inflater.inflate(R.layout.listroot, null); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T04:05:02.753

我无法使用您提供的代码重现您的问题，因为我没有您上面列出的任何设备。我的第一个想法是它可能与您初始化片段的方式有关。请`nFragmentAdapter`在下面查看我修改后的课程。我已更改`getItem()`为以不同的方式初始化片段：

**nFragmentAdapter：**

```
class nFragmentAdapter extends FragmentStatePagerAdapter {

        public nFragmentAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override        
        public int getItemPosition(Object object) {
            return POSITION_NONE;
        }

        @Override
        public Fragment getItem(int position) {

            Fragment f = null;
            Bundle args = new Bundle();
            args.putString("content", TabsStyled.CONTENT[position
                    % TabsStyled.CONTENT.length]);
            switch (position) {
            case 0:
                f = Fragment.instantiate(TabsStyled.this,
                        ReviewFragment.class.getName(), args);
                break;
            case 1:
                f = Fragment.instantiate(TabsStyled.this,
                        MyListFragment.class.getName(), args);
                break;
            case 2:
                f = Fragment.instantiate(TabsStyled.this,
                        SmartFragment.class.getName(), args);
                break;
            case 3:
                f = Fragment.instantiate(TabsStyled.this,
                        MyListFragment.class.getName(), args);
                break;
            case 4:
                f = Fragment.instantiate(TabsStyled.this,
                        f.getClass.getName(), args);
                break;
            case 5:
                f = Fragment.instantiate(TabsStyled.this,
                        f.getClass.getName(), args);
                break;
            case 6:
                f = Fragment.instantiate(TabsStyled.this,
                        f.getClass.getName(), args);
                break;
            }
            return f;
        }

        @Override
        public int getCount() {
            return TabsStyled.CONTENT.length;
        }

        @Override
        public CharSequence getPageTitle(int position) {
            return TabsStyled.CONTENT[position % TabsStyled.CONTENT.length].toUpperCase();
        }
    } 
```

和对应的**MyListFragment：**

```
public class MyListFragment extends ListFragment implements LoaderManager.LoaderCallbacks<Cursor> {

        myCursorAdapter mAdapter;
        String orderBy = DBAdapter.activityDateTime + " DESC";

        static final String[] activityQuery = new String[] { DBAdapter.activityRowID, DBAdapter.activityReason, DBAdapter.activityDateTime };

        String content;

    public void refreshView() {
        getLoaderManager().restartLoader(0, null, this);
    }

    @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
                Bundle args = getArguments();
                if(args != null)
                    content = args.getString("content");
                View logv = inflater.inflate(R.layout.listroot, null);
                return logv;           
        }      

        @Override
    public void onActivityCreated(Bundle savedInstanceState) {
                  super.onActivityCreated(savedInstanceState);
                mAdapter = new myCursorAdapter(getActivity(), null);
                setListAdapter(mAdapter);              
                getLoaderManager().initLoader(0, null, this);
        }

        @Override
        public void onListItemClick(ListView l, View v, int position, long id) {
        }

        @Override
        public Loader<Cursor> onCreateLoader(int id, Bundle args) {
                return new CursorLoader(getActivity().getApplicationContext(), myListProvider.activity_URI, activityQuery, null, null, orderBy);
        }

        @Override
        public void onLoadFinished(Loader<Cursor> loader, Cursor data) {
                mAdapter.swapCursor(data);             
        }

        @Override
        public void onLoaderReset(Loader<Cursor> loader) {
                mAdapter.swapCursor(null);     
        }

    public class myCursorAdapter extends CursorAdapter {

        private final LayoutInflater mInflater;

        public myCursorAdapter(Context context, Cursor c) {
                super(context, c, 0);
                mInflater = LayoutInflater.from(context);
        }

        @Override
        public void bindView(View view, Context context, Cursor cursor) {

            TextView logleft = (TextView) view.findViewById(R.id.logleft);
                        logleft.setText(cursor.getString(cursor.getColumnIndex(DBAdapter.activityDateTime)));

            TextView logcenter = (TextView) view.findViewById(R.id.logcenter);
            logcenter.setText(cursor.getString(cursor.getColumnIndex(DBAdapter.activityReason)));

        }

        @Override
        public View newView(Context context, Cursor cursor, ViewGroup parent) {
                View view = null;
                view = mInflater.inflate(R.layout.vlist, parent, false);
            return view;
        }
    }

} 
```

如果这有任何改变，请更新我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T04:24:41.910

尝试这个。

```
<ListView android:id="@+id/android:list"
    android:choiceMode="singleChoice" 
    android:paddingTop="4dp" 
    android:paddingBottom="4dp" 
    android:layout_width="fill_parent" 
    android:layout_height="0dip" 
    android:layout_weight="45" /> 
```

我已经替换`android:id="@android:id/list"` 为`android:id="@+id/android:list"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T04:45:30.240

不要在 ListView 中使用 android:id="@+id/list" 。您可以使用另外一个选项创建 id，即 android:id="@id/android:list"，或者您可以使用 android:id="@+id/list1"。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-12T21:33:59.983

谢谢你的帖子。当我刚开始使用 Android 编程时，我在这方面有点挣扎。将其更改为`android:id="@android:id/list"`对我有用。

虽然我刚刚编写了一个示例程序，其中只有一个`ListView`显示在`ListFramgment`. 现在我要尝试看看是否可以在列表中显示一些自定义对象（比如在一行中包含一个文本和图标），而不是显示字符串数组。

非常感谢！

# ios - Reusing iPhone Views in iPad

> ID：14205541
> 
> 赞同：0
> 
> 时间：2013-01-07T22:52:58.637
> 
> 标签：ios

When creating a Universal application using Storyboard do people reuse the iPhone views (UITableView) etc in their iPad application or do they make all the views for the iPad from scratch? OR it depends :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:56:32.427

这真的取决于。我尽可能多地尝试重用视图，但出于定制化的目的，它通常会在需要为 ipad 制作单独的 .xib 的地方解决。如果您正在做一个基于导航的应用程序并且您使用 splitview 控制器，您基本上可以重用 iphone 和 iPad 之间的所有导航屏幕

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-07T22:56:02.817

好吧，真的没有什么可重用的。UITableView 的布局在 iPad 上与 iPhone 上的尺寸差异很大。

当您将应用程序从 iPhone 移植到 iPad 时，您应该专注于调整用户体验以适应更大的屏幕。不仅仅是在 iPad 上使用与 iPhone 相同的视图。

# python - colobar label matplotlib in ImageGrid

> ID：14205547
> 
> 赞同：2
> 
> 时间：2013-01-07T22:53:34.873
> 
> 标签：python, matplotlib, plot

I am using this function from the documentation to make a nice plot with matplotlib.

```
def demo_grid_with_single_cbar(fig):
    """
    A grid of 2x2 images with a single colorbar
    """
    grid = AxesGrid(fig, 132, # similar to subplot(132)
                    nrows_ncols = (2, 2),
                    axes_pad = 0.0,
                    share_all=True,
                    label_mode = "L",
                    cbar_location = "top",
                    cbar_mode="single",
                    )

    Z, extent = get_demo_image()
    for i in range(4):
        im = grid[i].imshow(Z, extent=extent, interpolation="nearest")
    #plt.colorbar(im, cax = grid.cbar_axes[0])
    grid.cbar_axes[0].colorbar(im)

    for cax in grid.cbar_axes:
        cax.toggle_label(False)

    # This affects all axes as share_all = True.
    grid.axes_llc.set_xticks([-2, 0, 2])
    grid.axes_llc.set_yticks([-2, 0, 2]) 
```

I would like to change add a label to the colorbar, above or in case the colorbar is located 'right', then the label should go to the side aswell.

just changing

```
cbar = grid.cbar_axes[0].colorbar(im)
cbar.ax.set_label_text("$[a.u.]$") 
```

does do the job!!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T17:41:42.597

只是改变

```
cbar = grid.cbar_axes[0].colorbar(im)
cbar.ax.set_label_text("$[a.u.]$") 
```

做的工作！

# python - Python 2.7：print 不对 io 模块说 unicode？

> ID：14205548
> 
> 赞同：3
> 
> 时间：2013-01-07T22:53:37.747
> 
> 标签：python, unicode, io

```
import sys, codecs, io

codecsout = codecs.getwriter('utf8')(sys.stdout)
ioout = io.open(sys.stdout.fileno(), mode='w', encoding='utf8')
print >> sys.stdout, 1
print >> codecsout, 2
print >> ioout, 3 
```

失败：

```
1
2
Traceback (most recent call last):
  File "print.py", line 7, in <module>
    print >> ioout, 3
TypeError: must be unicode, not str 
```

它也失败`print(3, file=ioout)`了`__future__`。

不`print`知道如何与`io`模块交谈？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T23:25:52.133

显然不是。即使你给它一个明确的 Unicode 字符串，它也不起作用。

```
>>> print >> ioout, u'3'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: must be unicode, not str 
```

我猜问题出在自动附加到末尾的换行符中。未来的打印功能似乎没有同样的问题：

```
>>> from __future__ import print_function
>>> print(unicode(3), file=ioout)
3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T02:17:26.417

该`print`语句隐式调用`__str__`它打印的每一件事。`sys.stdout`是一个字节流，所以发送它就可以了`str`。`codecs.getwriter`是一个旧的 Python API，所以我猜它只是隐式转换`str`为`unicode`Python 2.x 传统上所做的。但是，新`io`模块严格要求转换`str`为`unicode`Python 3.x，这就是它抱怨的原因。

因此，如果要将 unicode 数据发送到流，请使用该`.write()`方法而不是`print`：

```
>>> sys.stdout.write(u'1\n')
1
>>> codecsout.write(u'1\n')
1
>>> sys.stdout.write(u'1\n')
1 
```

# mysql - Mysql调用不存在的函数

> ID：14205552
> 
> 赞同：1
> 
> 时间：2013-01-07T22:53:57.067
> 
> 标签：mysql, function, preg-replace, procedure

我在使用从另一个数据库中提取的 MySQL 函数时遇到问题。我做了和导入数据和函数和程序分开。

我现在有`makehash`一个调用`preg_replace`. 我在任何地方都看不到这个函数或过程。

如果我运行`show function status`或`show procedure status`与显示无关，则`preg_replace`只有以前存在的自定义过程和函数。

是否有我遗漏的东西安装在我复制的数据库上，而我忽略了复制到新的数据库？

这是`makehash`功能：

```
CREATE DEFINER=`root`@`localhost` FUNCTION `makehash`(description text, raw_location text, title text) RETURNS varchar(32) CHARSET utf8
NO SQL
DETERMINISTIC
begin
    declare data longtext;
    declare hash varchar(32);
    set data = ifnull(description, '');
    set hash = null;
    if length(data) > 64 then
        set data = lower(concat(data, ifnull(raw_location, ''), ifnull(title, '')));
        set hash = md5(preg_replace('/[^a-z]/', '', data));
    end if;
return hash; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T00:18:40.527

您从中复制该函数的数据库很可能正在使用[lib_mysqludf_preg](http://www.mysqludf.org/lib_mysqludf_preg/)库，该库除其他外还`preg_replace()`为 MySQL 提供了一个函数。要使用它，您需要下载、编译（除非使用预构建的二进制包）并安装该库；有关详细信息，请参阅上面的链接。

# php - arsort 使用什么算法？

> ID：14205553
> 
> 赞同：3
> 
> 时间：2013-01-07T22:54:06.870
> 
> 标签：php

该[文档](http://php.net/manual/en/function.arsort.php)似乎没有告诉我们使用什么算法进行数组排序。那么函数 arsort 使用什么算法呢？换句话说，它是使用归并排序还是快速排序？

取自文档的代码：

```
<?php
$fruits = array("d" => "lemon", "a" => "orange", "b" => "banana", "c" => "apple");
arsort($fruits);
foreach ($fruits as $key => $val) {
    echo "$key = $val\n";
} 
```

输出：

```
a = orange
d = lemon
b = banana
c = apple 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T22:56:44.187

与所有 PHP 排序函数一样，使用了快速排序算法

请参阅[手册中的注释](http://www.php.net/sort)：

> **注意**：与大多数 PHP 排序函数一样，sort() 使用 » Quicksort 的实现。

# java - Java 垃圾收集器逻辑查询

> ID：14205555
> 
> 赞同：2
> 
> 时间：2013-01-07T22:54:19.683
> 
> 标签：java, memory-management, garbage

关于 Java 运行时垃圾收集器的快速问题。

采取这种情况：

***两个对象都持有对另一个的引用。没有其他对象持有对这些对象的任何引用。对象没有做任何事情——如果它们的线程已经结束，它们就不是 Runnables。***

垃圾收集器会收集这些对象吗，因为我大量使用这些对象并通过削减引用来“处理”它们……但它们真的被处理了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T22:57:29.473

是的，这些元素符合收集条件。看：

[根源是什么？](https://stackoverflow.com/questions/6366211/what-are-the-roots)

它们是否会被收集取决于垃圾收集器。

# git - Git命令查找哪些分支合并到当前分支以及何时合并

> ID：14205561
> 
> 赞同：7
> 
> 时间：2013-01-07T22:54:43.480
> 
> 标签：git, merge, git-merge

我有几个功能分支正在自动合并到集成分支中。我想知道这种情况是否以及何时发生。

我可以输入`git log` 这将告诉我发生了合并，但由于某种原因，它没有显示来自哪个功能分支，它只是说“将 integration_branch 合并到 integration_branch”

我可以打字`git branch --merged`

但这仅列出了正在合并到集成分支中的功能分支。我想知道何时由谁执行，并能够深入了解此合并信息。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-07T23:23:41.937

我会使用`git log`一些颜色来做到这一点：

```
git log --graph --full-history --all --color \ 
--pretty=format:"%x1b[31m%h%x09%x1b[32m%d%x1b[0m%x20%s" 
```

这将为每个分支和合并着色。它还将标记每个分支的头部。

您可以使用以下命令添加相对日期和提交者名称：

```
git log --graph --full-history --all --color \
--pretty=format:"%x1b[31m%h%x09%x1b[32m%d%x1b[0m%x20%s \
%Cgreen(%cr) %C(bold blue)<%an>%Creset'" 
```

有关更多信息，请参阅： http: [//git-scm.com/book/en/Git-Basics-Viewing-the-Commit-History](http://git-scm.com/book/en/Git-Basics-Viewing-the-Commit-History)

# javascript - jQuery 周历约会只出现在 Chrome 中，而不会出现在其他浏览器中

> ID：14205563
> 
> 赞同：3
> 
> 时间：2013-01-07T22:55:16.000
> 
> 标签：javascript, jquery, cross-browser, browser

我有一个奇怪的问题。我正在使用[jQuery weekcalendar](https://github.com/themouette/jquery-week-calendar)在浏览器的日历中显示约会。

Chrome 一切正常。我所有的约会都显示出来了。在所有其他浏览器中，我只看到日历，但看不到约会。

这是我[日历](http://www.slinder.ch/admin/admin/calendar/calendar.html)的链接。

有谁知道这里发生了什么？我不知道应该在这个问题中添加什么代码，因为我不知道问题出在哪里。但是，如果您检查页面源代码，则代码是可见的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T16:27:29.087

您的问题与您解析来自 ajax 调用“ [http://www.slinder.ch/admin/php/termin_getappointments.php](http://www.slinder.ch/admin/php/termin_getappointments.php) ”的日期的方式有关。您正在使用“new Date()”转换为日期。虽然这在 chrome 中运行良好，但在其他浏览器中无法运行。尝试按照以下帖子中的说明解析您的日期格式：

[如何使用 JavaScript 中的格式规范将字符串转换为日期时间？](https://stackoverflow.com/questions/476105/how-can-i-convert-string-to-datetime-with-format-specification-in-javascript)

具有以下代码示例的答案似乎就足够了，它使用 ajax 调用返回的确切日期格式：

```
var dateString = "2010-08-09 01:02:03";
var reggie = /(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/;
var dateArray = reggie.exec(dateString); 
var dateObject = new Date(
    (+dateArray[1]),
    (+dateArray[2])-1, // Careful, month starts at 0!
    (+dateArray[3]),
    (+dateArray[4]),
    (+dateArray[5]),
    (+dateArray[6])
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T16:43:31.253

尝试更改此代码：

```
appointments.push({
  id: id,
  start: new Date(start),
  end: new Date(end),
  title: '<b>' + title + '</b> - ' + body,
  userId: userid
}); 
```

应该：

```
appointments.push({
  id: id,
  start: moment(start, "YYYY-MM-dd HH:mm:ss"),
  end: moment(end, "YYYY-MM-dd HH:mm:ss"),
  title: '<b>' + title + '</b> - ' + body,
  userId: userid
}); 
```

# actionscript-3 - 调用期望事件 AS3 的函数

> ID：14205568
> 
> 赞同：0
> 
> 时间：2013-01-07T22:55:30.387
> 
> 标签：actionscript-3

感谢您花时间阅读我的问题！所以我的代码中有一个函数，它在 TimerEvent 之后被调用。像这样：

```
shootTimer.addEventListener(TimerEvent.TIMER, shoot, false, 0, true);
private function shoot(e:Event):void 
```

这没有问题，但是如果我也想调用函数拍摄其他东西怎么办。比如说

```
if(speed > 5)
shoot(); 
```

它不是那样工作的，有人可以解释一下我该怎么做吗？非常感谢，提前。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T23:05:02.987

您可以为参数设置默认值，因此您可以在没有事件的情况下调用它：

```
private function shoot(e:Event = null):void 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:06:45.820

你可以做这样的事情

```
shootTimer.addEventListener(TimerEvent.TIMER, shoot, false, 0, true);

private function shoot(e:Event):void
{
realShoot();
}

if(speed > 5)
{
realShoot();
} 
```

# app-engine-ndb - ndb 查询不包括多个键或 ID

> ID：14205571
> 
> 赞同：1
> 
> 时间：2013-01-07T22:55:40.753
> 
> 标签：app-engine-ndb

我想查询一个实体，但在结果中排​​除了一堆我不想要的键/ID。这样做的最佳方法是什么？

我想也许 .IN 运营商会帮助我，但无法弄清楚如何。

因此，我提出了以下链接单键排除的解决方案：

```
q = models.Comment.query()
for exclude_key in list_of_comment_keys_to_exclude:
  q = q.filter( models.Comment.key != exclude_key )
q = q.order( models.Comment.key ) # without this: BadRequestError: The first sort property must be the same as the property to which the inequality filter is applied.
q = q.order( models.Comment.creationTime ) 
```

这似乎可行，但这是一种可行的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T19:00:28.787

这可能有效，但效率相当低。在获得所有结果后，排除用户代码中的单个键会更便宜。例如：

```
q = models.Comment.query().order(...)
results = [res for res in q.fetch() if res.key not in list_of_comment_keys_to_exclude] 
```

# eclipse - 即使 ClassLoader.getResource 找到了 .properties 文件，也无法加载属性

> ID：14205572
> 
> 赞同：0
> 
> 时间：2013-01-07T22:55:59.837
> 
> 标签：eclipse, properties, annotations, velocity, processor

我一直在努力解决这个问题：我正在尝试编写一个注释处理器（使用 Eclipse IDE），它应该
1 - 识别注释并处理它 - 写入找到注释的消息
2 - 使用速度模板引擎生成新的源文件

（使用本教程：[http](http://deors.wordpress.com/2011/10/31/annotation-generators/) ://deors.wordpress.com/2011/10/31/annotation-generators/ ）

我将它导出到 .jar 并与另一个客户端类一起使用。第 1 步是成功的，但是在解决第 2 步时，我无法通过这些行：

```
Properties props = new Properties();  
URL url = this.getClass().getClassLoader().getResource("velocity.properties");
messager.printMessage(Diagnostic.Kind.NOTE, url.toString());  
props.load(url.openStream());  
messager.printMessage(Diagnostic.Kind.NOTE,"Properties loaded."); 
```

url.toString() 工作正常，它接缝发现“velocity.properties”：

*jar:file:/C:/Users/Zuz/workspace/Procesor_B/zh.procesor.b.jar!/velocity.properties*

但是第二条消息（“已加载属性。”）从未出现。之后也没有任何效果。不生成文件。我想一定是出了什么问题

*props.load(url.openStream());*

我在客户端类中有三个注释，当我处理它们时，它是这样的：
找到第一个注释 - 找到速度.properties - 从 props.load(url.openStream()) 跳过直到循环结束。
找到第二个注释 - 相同的重复。
找到第三个注释 - 相同的重复。

**编辑：这是我得到的例外：**

```
JAR entry velocity.properties not found in C:\Users\Zuz\workspace\Procesor_B\zh.procesor.b.jar  
java.io.FileNotFoundException: JAR entry velocity.properties not found in C:\Users\Zuz\workspace\Procesor_B\zh.procesor.b.jar 
```

我也试过这个：

```
props.load(this.getClass().getClassLoader().getResourceAsStream("velocity.properties")); 
```

但我得到了： `java.lang.NullPointerException`

您将在下面找到有关处理器和客户端类的更多信息。提前感谢您的帮助！

**这是我的注释处理器的源代码 - 现在没有做任何有用的事情：**

```
 package zh.procesor.b;    

all necessary java, javax imports ommitted for length
import org.apache.log4j.Logger;
import org.apache.velocity.Template;
import org.apache.velocity.VelocityContext;
import org.apache.velocity.app.VelocityEngine;
import org.apache.velocity.exception.ResourceNotFoundException;

import zh.anotacia.b.Anotacia_B;

@SupportedAnnotationTypes("zh.anotacia.b.Anotacia_B")
@SupportedSourceVersion(SourceVersion.RELEASE_6)
public class Procesor_B extends AbstractProcessor{

private static final Logger LOG =
        Logger.getLogger(Procesor_B.class.getName());

private Filer file; 
private Messager messager;

@Override
public void init(ProcessingEnvironment env){    
    file = env.getFiler();
    messager = env.getMessager();

}

@Override
public boolean process(Set<? extends TypeElement> annotations,
        RoundEnvironment roundEnv)  {
    String className = "Trieda"; 
    String packageName = "Package";
    int i = 1; 

    for (Element elem: roundEnv.getElementsAnnotatedWith(Anotacia_B.class)){
        i++;
        Anotacia_B anot = elem.getAnnotation(Anotacia_B.class);
        String message = "Annotation found in : " + elem.getSimpleName();
        messager.printMessage(Diagnostic.Kind.NOTE, message);

        try{
        Properties props = new Properties();
        URL url = this.getClass().getClassLoader()
                .getResource("velocity.properties");

        messager.printMessage(Diagnostic.Kind.NOTE, url.toString());

        //from here it is not working
        props.load(url.openStream());
        messager.printMessage(Diagnostic.Kind.NOTE, "Properties loaded.");

        VelocityEngine ve = new VelocityEngine(props);
        ve.init(); 

        VelocityContext vc = new VelocityContext();
        vc.put("className", className+i);
        vc.put("packageName", packageName+i);

        Template vt = ve.getTemplate("testtemplate.vm");

        JavaFileObject jfo = file.createSourceFile(
                packageName + "." + className + "Info");

        messager.printMessage(
                Diagnostic.Kind.NOTE,
                "creating source file: " + jfo.toUri());

        Writer writer = jfo.openWriter();

        messager.printMessage(
                Diagnostic.Kind.NOTE,
                "applying velocity template: " + vt.getName());

        vt.merge(vc, writer);

        writer.close();

        } catch (Exception ex) {
            messager.printMessage(Diagnostic.Kind.ERROR, ex.getMessage());
            messager.printMessage(Diagnostic.Kind.ERROR,
                                  "Stacktrace: " + ex.toString());  
            messager.printMessage(Diagnostic.Kind.ERROR,  
                                  ex.getStackTrace().toString());
        }
    }         
    return true;
  }
} 
```

**这是客户端类：**

```
 package zh.trieda.b;  

import zh.anotacia.b.Anotacia_B;

@Anotacia_B(vstup = "50", vystup = "50")
public class Rad {  

@Anotacia_B(vstup = "10", vystup = "15")
public void basic(){
    // do something
    }  

@Anotacia_B(vstup = "2", vystup = "30")
public void premium(){
    // do something
    }
} 
```

我是新来的，所以不能放图片，但是这里有一个图片链接，用于
Procesor_B 结构，Client 类 Trieda_B 结构，Trieda_B 的工厂路径

[http://bkmbj.wz.cz/structures.jpg](http://bkmbj.wz.cz/structures.jpg)

**这是velocity.properties中的内容：**

```
runtime.log.logsystem.class = org.apache.velocity.runtime.log.SystemLogChute
resource.loader = classpath
classpath.resource.loader.class =     org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T07:25:02.117

```
props.load(this.getClass().getClassLoader().getResourceAsStream("velocity.prope‌​rties"); 
```

应该管用。

# html - 如何一次上传多个文件？

> ID：14205574
> 
> 赞同：2
> 
> 时间：2013-01-07T22:56:02.713
> 
> 标签：html, forms, post, get, request

我正在使用 input type='file' 多个元素，但是为了服务器端的限制，我一次只能上传一个文档。所以我正在努力寻找一种方法来做到这一点，同时只保留单个文件输入元素......我认为我唯一的选择是使用自己的隐藏文件输入元素创建多个表单，并且当我循环浏览文件时以某种方式设置隐藏输入字段的值，但我不确定如何。有什么推荐吗？这是我到目前为止所拥有的：

```
HTML:
<form method='POST' id='frmUploadDoc' enctype='multipart/form-data' target='hiddenIframe' action='/wle/rest'>
    <input type="file" name="data" multiple="multiple" id="filesInput">
    <input type="submit" value="Submit"/>
</form>
<iframe name="hiddenIframe" id="hiddenIframe" style="display: none;">

JAVASCRIPT:
function handleFileSelect(evt) {      
    var files = evt.target.files; // FileList is a FileList of File objects.  
    var output = [];
    var actionText;
    for (var iCount = 0, f; f = files[iCount]; iCount++) {
       actionText="/wle/rest?action=addDocument&name=" + iCount   //This creates the unique action URL for each individual form  
       $("#frmUploadDoc").attr("action", actionText);
       output.push("<li><strong>", f.name, "</strong></li>");
       postDocumentToWLE(iCount);            
    }
    document.getElementById('listDocs').innerHTML = '<ul>' + output.join('') + '</ul>';
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:17:00.710

经过大量研究，大卫似乎是正确的，通过 iframe 通过 POST 上传表单是不可能上传多个文件的。HTML5 允许多文件上传，但如果您需要单独发送每个文件，则无法使用多文件输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T09:46:52.667

未经测试，但根据您对浏览器支持的要求，您应该能够使用 FormData 来实现。

您可以通过读取 files 属性访问在具有 multiple 属性的输入字段中选择的所有文件：

```
var files = document.getElementById('input').files; 
```

然后，您可以遍历文件，为每个文件创建一个 FormData 对象并发出一个 AJAX 请求，一次一个。有关代码示例的更详细说明：[https ://developer.mozilla.org/en-US/docs/Using_files_from_web_applications](https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications)

但请记住，并非所有浏览器都支持 FormData 对象。但是话又说回来，所有浏览器也不支持多属性...

# css - 如何设计一个外观点击时？我注意到，当您单击 Twitter Bootstrap 中的 <select>元素时，弹出的选项具有未设置样式的字体。默认元素，带有 Helvetica 文本：未设置样式的元素，带有 Arial(?) 文本：是否有任何方法可以设置单击</select> 元素时出现的样式，或者这取决于浏览器？它在基本 Bootstrap 中不是很明显，但我使用的是不同的（衬线）字体，而且效果很差。使用 IDictionary 接口而不是覆盖或隐藏方法封装字典

> ID：14205575
> 
> 赞同：1
> 
> 时间：2013-01-07T22:56:06.157
> 
> 标签：css, twitter-bootstrap

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T10:21:36.507

我认为除了 `select{font-family :yourFont;}` 你必须在 CSS 中嵌入字体

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T22:59:04.580

`SELECT`样式框的选项非常有限，但是`font-family`应该可以：

```
select { font-family: serif; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T23:15:06.987

您可以使用类似于[bootstrap-select 的](https://github.com/silviomoreto/bootstrap-select)东西。如果你有类似的东西：

```
<select class='selectPicker'>
  <option>1</option>
  <option>2</option>
</select> 
```

并应用您用来美化的任何插件，这会发生在您的元素上：

```
<select class="selectpicker" style="display: none;">
      <option>Mustard</option>
      <option>Ketchup</option>
      <option>Relish</option>
  </select>
<div class="btn-group bootstrap-select open">
   <button data-toggle="dropdown" class="btn dropdown-toggle clearfix">
     <span class="filter-option pull-left">1</span>&nbsp;<span class="caret"></span>   
   </button>
   <div role="menu" class="dropdown-menu">
      <ul style="max-height: none; overflow-y: auto;">
           <li rel="0"><a href="#" tabindex="-1">1</a></li>
           <li rel="1"><a href="#" tabindex="-1">2</a></li>
      </ul>
    </div>
</div> 
```

因此，您的 css 必须针对`<ul>`实际显示您的内容的内容。 `.dropdown-menu{ font-family: serif; }`

# c# - 使用 IDictionary 接口而不是覆盖或隐藏方法封装字典

> ID：14205576
> 
> 赞同：2
> 
> 时间：2013-01-07T22:56:06.390
> 
> 标签：c#, generics, dictionary, overriding, encapsulation

我找不到如何正确封装字典的完整示例。我需要/想要做的就是“覆盖”我知道不能被覆盖的 Add 方法，因为它不是虚拟的。根据一些研究，我发现我需要使用私有 Dictionary 封装它并实现 IDictionary 接口。

我能找到的最完整的示例是[here](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=29)，我主要是复制粘贴并猜测不匹配的内容（该示例实现了一个只读字典，而我想要使用自定义的 Add() 方法的完整默认功能） .

完整的可编译代码如下：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Threading;

namespace IDictionary
{
    class Program
    {
        static void Main(string[] args)
        {
            Registers<string, dynamic> DynRegistry = new Registers<string, dynamic>();

            DynRegistry.Add("Foo", 100);
            Console.WriteLine("DynRegistry Size: {0}", DynRegistry.Count);
            foreach (var item in DynRegistry)
            {
                Console.WriteLine("\tName: {0}, Value: {1}", item.Key, item.Value);
            }
            DynRegistry.Add("Foo2", "Hello World");
            Console.WriteLine("DynRegistry Size: {0}", DynRegistry.Count);
            foreach (var item in DynRegistry)
            {
                Console.WriteLine("\tName: {0}, Value: {1}", item.Key, item.Value);
            }
            DynRegistry.Add("Foo", true);
            Console.WriteLine("DynRegistry Size: {0}\r\n", DynRegistry.Count);
            foreach (var item in DynRegistry)
            {
                Console.WriteLine("\tName: {0}, Value: {1}", item.Key, item.Value);
            }
            Console.ReadKey();
        }
    }

    class Registers<TKey, TValue> : IDictionary<TKey, TValue>,  ICollection
    {
        //Fields
        private Dictionary<TKey, TValue> source;
        private object syncRoot;

        //Constructor
                    public Registers()
    {
        this.source = new Dictionary<TKey, TValue>();
    }

        //Wrapped Methods
                                                public void Add(TKey key, TValue value)
    {
        if (this.source.ContainsKey(key))
        {
            this.source[key] = value;
        }
        else
        {
            this.source.Add(key, value);
        }
    }

        //Implement default Interfaces
                        void ICollection<KeyValuePair<TKey, TValue>>.CopyTo(KeyValuePair<TKey, TValue>[] array, int arrayIndex)
    {
        ICollection<KeyValuePair<TKey, TValue>> collection = this.source;
        collection.CopyTo(array, arrayIndex);
    }
        public int Count { get { return this.source.Count; } }
        public ICollection<TKey> Keys { get { return this.source.Keys; } }
        public ICollection<TValue> Values { get { return this.source.Values; } }
        bool ICollection<KeyValuePair<TKey, TValue>>.IsReadOnly { get { return false; } }
        bool ICollection.IsSynchronized { get { return false; } }
        object ICollection.SyncRoot
    {
        get
        {
            if (this.syncRoot == null)
            {
                ICollection collection = this.source as ICollection;

                if (collection != null)
                {
                    this.syncRoot = collection.SyncRoot;
                }
                else
                {
                    Interlocked.CompareExchange(ref this.syncRoot, new object(), null);
                }
            }
            return this.syncRoot;
        }
    }
        public TValue this[TKey key]
    {
        get { return this.source[key]; }
        set { this.source[key] = value; }
    }
        public bool ContainsKey(TKey key) { return this.source.ContainsKey(key); }
        public bool Remove(TKey key) { return this.source.Remove(key); }
        public bool TryGetValue(TKey key, out TValue value) { return this.source.TryGetValue(key, out value); }
        void ICollection<KeyValuePair<TKey, TValue>>.Add(KeyValuePair<TKey, TValue> item)
    {
        ICollection<KeyValuePair<TKey, TValue>> collection = this.source;
        collection.Add(item);
    }
        void ICollection<KeyValuePair<TKey, TValue>>.Clear()
    {
        ICollection<KeyValuePair<TKey, TValue>> collection = this.source;
        collection.Clear();
    }
        bool ICollection<KeyValuePair<TKey, TValue>>.Contains(KeyValuePair<TKey, TValue> item)
    {
        ICollection<KeyValuePair<TKey, TValue>> collection = this.source;
        return collection.Contains(item);
    }
        bool ICollection<KeyValuePair<TKey, TValue>>.Remove(KeyValuePair<TKey, TValue> item)
    {
        ICollection<KeyValuePair<TKey, TValue>> collection = this.source;
        return collection.Remove(item);
    }
        void ICollection.CopyTo(Array array, int index)
    {
        ICollection collection = new List<KeyValuePair<TKey, TValue>>(this.source);
        collection.CopyTo(array, index);
    }
        IEnumerator<KeyValuePair<TKey, TValue>> IEnumerable<KeyValuePair<TKey, TValue>>.GetEnumerator()
    {
        IEnumerable<KeyValuePair<TKey, TValue>> enumerator = this.source;
        return enumerator.GetEnumerator();
    }
        IEnumerator IEnumerable.GetEnumerator()
    {
        return this.source.GetEnumerator();
    }
    }
} 
```

我发布这个的两个原因：

1.  这样其他任何需要这样做的人都不必花费 30 分钟重新输入冗余代码。
2.  关于我是否正确执行这一切的反馈。我对是否/为什么需要实现 ICollection 接口感到困惑（即，普通字典是否会执行此操作，或者 IDictionary 是否具有完整的字典功能而不需要 ICollection）。

我真正需要的是一个普通的字典，它带有一个 AddOrReplace() 而不是 Add 的 Add 方法（或者因为 Key 已经存在而崩溃）。实现这一目标所需的工作似乎有点矫枉过正。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T23:01:13.233

您可以使用

```
dict[key]=value 
```

`add or replace`如果这就是你想要的。所以不需要包装字典。

# python - 需要确定我当前位置属于哪个多边形

> ID：14205579
> 
> 赞同：0
> 
> 时间：2013-01-07T22:56:08.997
> 
> 标签：python, google-app-engine, geolocation, geospatial

我即将开始一个旨在检索当地地质信息的 IOS 项目。我计划在后端使用 Google App Engine 和 Python。我的问题是，并非所有可能需要的 Python 库（例如[Shapely](http://pypi.python.org/pypi/Shapely)）都在 App Engine 上可用，因为它们依赖于低级 C 库。所以我认为战略预处理可能是要走的路。

我将使用对地质构造信息进行编码的 KML 数据文件进行工作。对于每个州，都有一个覆盖该州的多边形拼凑而成，每个多边形（在 Google 地球中用颜色编码）对应于​​一个地质构造。例如[nhgeol.kml](http://mrdata.usgs.gov/geology/state/kml/nhgeol.kml)

在另一个项目中，我使用了 Python [GeoModel](http://pypi.python.org/pypi/geomodel/0.2.0)库，它与 App Engine 配合得很好。但是对于那个项目，我的数据由离散点组成，GeoModel 非常适合预处理这类数据，这样您就可以进行“邻近提取”。

在这个项目中，我想知道，给定我当前的位置，我所在的多边形。一种方法是预先计算地理单元格的网格，确定每个单元格所在的多边形。然后这个问题将减少到一个GeoModel 可以处理。但我不觉得这是多么可行。

一旦我知道我所在的多边形，我就会有一个指向特定地质构造信息的指针。这就是我要呈现给最终用户的内容。

如果有人提出这种方法是否有意义，或者我是否遗漏了一些更直接的东西，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:18:14.347

我不确切知道您希望使用 Shapely 的哪些功能，但要处理多边形，您可以使用[Sympy](http://sympy.org)，它完全用 Python 编写。特别看一下[几何模块](http://docs.sympy.org/0.7.2/modules/geometry.html)和方法[`encloses_point`](http://docs.sympy.org/0.7.2/modules/geometry.html?highlight=polygon#sympy.geometry.polygon.RegularPolygon.encloses_point)。

# r - 根据条件过滤数据框中的数据

> ID：14205583
> 
> 赞同：9
> 
> 时间：2013-01-07T22:56:30.787
> 
> 标签：r, subset

我是 R 新手，无法理解这个概念。假设我有一个名为“places”的表，其中包含 3 个列 - 城市、人口和夏季平均温度

假设我想“过滤” - 生成一个人口少于 100 万且夏季平均温度大于 70 度的新表格对象。

在我使用过的任何其他程序中，这将非常容易，但是在进行了一些研究后，我使自己陷入了更大的困惑。鉴于 R 的目的和它的作用，这一定是非常简单的东西。

我如何将上述条件应用于表格？步骤是什么？据我了解，我不能轻易地根据他们的名字选择表格标题，这很好（例如 WHERE city < 1,000,000 ）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-07T23:31:41.017

给定一个数据框“dfrm”，其中包含“city”列中的城市名称、“population”列中的人口和“meanSummerT”列中的夏季平均温度，您对满足这些联合要求的子集的请求将得到满足使用以下任何一种：

```
subset( dfrm, population < 1e6 & meanSummerT > 70)
dfrm[ which(dfrm$population < 1e6 & dfrm$meanSummerT > 70) , ]
dfrm[ which( dfrm[[ 'population' ]] < 1e6 & dfrm[[ 'meanSummerT' ]] > 70) , ] 
```

如果您只想要符合这些联合标准的城市名称，那么这些将起作用：

```
subset( dfrm, population < 1e6 & meanSummerT > 70 , city)
dfrm[ which(dfrm$population < 1e6 & dfrm$meanSummerT > 70) , "city" ]
dfrm[ which(dfrm[['population']] < 1e6 & dfrm[['meanSummerT']] > 70) , "city" ] 
```

请注意，列名没有在子集中或在“$”运算符之后被引用，而是在“[[”中被引用。请注意，`which`如果没有数据行匹配，则使用可能很危险，因为您将获得整个数据帧，而不是没有行。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-07T23:04:38.213

你正在寻找`subset`

如果您的数据被调用`mydata`

```
newdata <- subset(mydata, city < 1e6) 
```

或者你可以使用`[`，这在[编程上更安全](https://stackoverflow.com/questions/9860090/in-r-why-is-better-than-subset)

```
newdata <- mydata[mydata$city < 1e6] 
```

用于多于一种条件`&`或`|`在适当的情况下使用

你也可以使用`sqldf`包来使用`sql`

```
library(sqldf)

newdata <-  sqldf('select * from mydata where city > 1e6') 
```

或者你可以使用`data.table`which 使语法更容易`[`（以及内存效率）

```
library(data.table)

mydatatable <- data.table(mydata)
newdata <- mydatatable[city > 1e6] 
```

# c# - 等待 Async Void 方法调用以进行单元测试

> ID：14205590
> 
> 赞同：84
> 
> 时间：2013-01-07T22:57:02.550
> 
> 标签：c#, .net, unit-testing, async-await

我有一个看起来像这样的方法：

```
private async void DoStuff(long idToLookUp)
{
    IOrder order = await orderService.LookUpIdAsync(idToLookUp);   

    // Close the search
    IsSearchShowing = false;
}    

//Other stuff in case you want to see it
public DelegateCommand<long> DoLookupCommand{ get; set; }
ViewModel()
{
     DoLookupCommand= new DelegateCommand<long>(DoStuff);
} 
```

我正在尝试像这样对它进行单元测试：

```
[TestMethod]
public void TestDoStuff()
{
    //+ Arrange
    myViewModel.IsSearchShowing = true;

    // container is my Unity container and it setup in the init method.
    container.Resolve<IOrderService>().Returns(orderService);
    orderService = Substitute.For<IOrderService>();
    orderService.LookUpIdAsync(Arg.Any<long>())
                .Returns(new Task<IOrder>(() => null));

    //+ Act
    myViewModel.DoLookupCommand.Execute(0);

    //+ Assert
    myViewModel.IsSearchShowing.Should().BeFalse();
} 
```

在我完成模拟 LookUpIdAsync 之前调用了我的断言。在我的正常代码中，这正是我想要的。但是对于我的单元测试，我不希望那样。

我正在从使用 BackgroundWorker 转换为 Async/Await。使用后台工作人员，这可以正常工作，因为我可以等待 BackgroundWorker 完成。

但似乎没有办法等待 async void 方法......

**如何对这种方法进行单元测试？**

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-01-08T03:05:48.700

你应该避免`async void`。仅`async void`用于事件处理程序。`DelegateCommand`是（逻辑上）一个事件处理程序，所以你可以这样做：

```
// Use [InternalsVisibleTo] to share internal methods with the unit test project.
internal async Task DoLookupCommandImpl(long idToLookUp)
{
  IOrder order = await orderService.LookUpIdAsync(idToLookUp);   

  // Close the search
  IsSearchShowing = false;
}

private async void DoStuff(long idToLookUp)
{
  await DoLookupCommandImpl(idToLookup);
} 
```

并将其单元测试为：

```
[TestMethod]
public async Task TestDoStuff()
{
  //+ Arrange
  myViewModel.IsSearchShowing = true;

  // container is my Unity container and it setup in the init method.
  container.Resolve<IOrderService>().Returns(orderService);
  orderService = Substitute.For<IOrderService>();
  orderService.LookUpIdAsync(Arg.Any<long>())
              .Returns(new Task<IOrder>(() => null));

  //+ Act
  await myViewModel.DoLookupCommandImpl(0);

  //+ Assert
  myViewModel.IsSearchShowing.Should().BeFalse();
} 
```

* * *

我推荐的答案在上面。但是如果你真的想测试一个`async void`方法，你可以用我的[AsyncEx 库来做](http://nitoasyncex.codeplex.com/)：

```
[TestMethod]
public void TestDoStuff()
{
  AsyncContext.Run(() =>
  {
    //+ Arrange
    myViewModel.IsSearchShowing = true;

    // container is my Unity container and it setup in the init method.
    container.Resolve<IOrderService>().Returns(orderService);
    orderService = Substitute.For<IOrderService>();
    orderService.LookUpIdAsync(Arg.Any<long>())
                .Returns(new Task<IOrder>(() => null));

    //+ Act
    myViewModel.DoLookupCommand.Execute(0);
  });

  //+ Assert
  myViewModel.IsSearchShowing.Should().BeFalse();
} 
```

但是此解决方案会`SynchronizationContext`在其生命周期内更改您的视图模型。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2013-01-07T23:09:21.103

方法本质上是一种`async void`“一劳永逸”的方法。没有办法取回完成事件（没有外部事件等）。

如果您需要对此进行单元测试，我建议您将其`async Task`改为一种方法。然后您可以调用`Wait()`结果，它会在方法完成时通知您。

但是，这种编写的测试方法仍然不起作用，因为您实际上并没有`DoStuff`直接测试，而是测试`DelegateCommand`包装它的 a。您需要直接测试此方法。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-01-08T17:06:11.187

我想出了一种方法来进行单元测试：

```
[TestMethod]
public void TestDoStuff()
{
    //+ Arrange
    myViewModel.IsSearchShowing = true;

    // container is my Unity container and it setup in the init method.
    container.Resolve<IOrderService>().Returns(orderService);
    orderService = Substitute.For<IOrderService>();

    var lookupTask = Task<IOrder>.Factory.StartNew(() =>
                                  {
                                      return new Order();
                                  });

    orderService.LookUpIdAsync(Arg.Any<long>()).Returns(lookupTask);

    //+ Act
    myViewModel.DoLookupCommand.Execute(0);
    lookupTask.Wait();

    //+ Assert
    myViewModel.IsSearchShowing.Should().BeFalse();
} 
```

这里的关键是，因为我是单元测试，所以我可以在我想让我的异步调用（在我的 async void 内）返回的任务中替换。然后，我只需确保任务已完成，然后再继续。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-05-18T09:43:40.050

我知道的唯一方法就是把你的`async void`方法变成`async Task`方法

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-04-10T14:29:20.340

提供的答案测试命令而不是异步方法。如上所述，您还需要另一个测试来测试该异步方法。

在花了一些时间解决类似问题后，我发现只需同步调用即可在单元测试中测试异步方法：

```
 protected static void CallSync(Action target)
    {
        var task = new Task(target);
        task.RunSynchronously();
    } 
```

和用法：

```
CallSync(() => myClass.MyAsyncMethod()); 
```

测试在这一行等待并在结果准备好后继续，因此我们可以在之后立即断言。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-10-11T07:38:04.223

您可以使用 AutoResetEvent 暂停测试方法，直到异步调用完成：

```
[TestMethod()]
public void Async_Test()
{
    TypeToTest target = new TypeToTest();
    AutoResetEvent AsyncCallComplete = new AutoResetEvent(false);
    SuccessResponse SuccessResult = null;
    Exception FailureResult = null;

    target.AsyncMethodToTest(
        (SuccessResponse response) =>
        {
            SuccessResult = response;
            AsyncCallComplete.Set();
        },
        (Exception ex) =>
        {
            FailureResult = ex;
            AsyncCallComplete.Set();
        }
    );

    // Wait until either async results signal completion.
    AsyncCallComplete.WaitOne();
    Assert.AreEqual(null, FailureResult);
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-01-19T14:25:39.607

更改您的方法以返回任务，您可以使用 Task.Result

```
bool res = configuration.InitializeAsync(appConfig).Result;
Assert.IsTrue(res); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-27T20:26:54.233

我有一个类似的问题。就我而言，解决方案是`Task.FromResult`在 moq 设置中使用，`.Returns(...)`如下所示：

```
orderService.LookUpIdAsync(Arg.Any<long>())
    .Returns(Task.FromResult(null)); 
```

或者，Moq 也有一个`ReturnsAysnc(...)`方法。

# wordpress - 将标签列表转换为 WordPress 中的标签云

> ID：14205599
> 
> 赞同：0
> 
> 时间：2013-01-07T22:57:42.787
> 
> 标签：wordpress, tags

经过大量黑客攻击后，我正在使用以下代码生成一个标签列表，用于在名为“评论”的自定义帖子类型中用于当前类别...

```
<?php
$cat_id = get_query_var('cat');
query_posts('post_type=review&posts_per_page=-1&cat='.$cat_id);
 if (have_posts()) :
 $posttags = array();
 while (have_posts()) : the_post();
   if( get_the_tag_list() ){
   $posttags = array_merge( $posttags, explode('||', get_the_tag_list('','||','')));
   }
 endwhile;
 $posttags = array_unique( $posttags );
 sort($posttags); //sort optional
   if( $posttags ) { 
    echo '<ul><li>';
   echo implode("</li>\n<li>", $posttags);
   echo '</li></ul>';
   }
 endif; wp_reset_query(); 
?> 
```

这可以正常工作并输出正确的列表，但我想将此列表变成标签云，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-08T12:41:20.820

你可以用这个，

```
http://codex.wordpress.org/Function_Reference/wp_tag_cloud 
```

或者使用一些插件，

```
https://wordpress.org/plugins/ultimate-tag-cloud-widget/ 
```

希望这可以帮助你

# nuget - 如何在 Nuget 中引用共享资源

> ID：14205600
> 
> 赞同：0
> 
> 时间：2013-01-07T22:57:49.117
> 
> 标签：nuget

我是 NuGet 的新手，我想制作一个包含 C++ 库和 C# 互操作库的包。当有人安装软件包时，我希望将互操作添加到引用中，并将所有 C++ 库复制到发布文件夹中。有没有办法轻松做到这一点？

另外，如果 C++ dll 没有分发给解决方案中的每个项目，我更愿意，有没有办法将它们保存在共享项目中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:21:18.847

是的，NuGet 具有显式程序集引用的概念。它允许您准确指定“lib”文件夹中将作为对项目的引用添加的程序集。'lib' 中未指定的其他程序集将保持原样。

请参阅此页面上的“指定显式程序集引用”部分：http: [//docs.nuget.org/docs/reference/nuspec-reference](http://docs.nuget.org/docs/reference/nuspec-reference)

# c# - 从 C# 连接到 node.js 服务器

> ID：14205604
> 
> 赞同：4
> 
> 时间：2013-01-07T22:58:02.600
> 
> 标签：c#, node.js, sockets, socket.io

我正在尝试编写一个简单的服务器，.NET 客户端可以连接到该服务器以交换消息。来自任何客户端的任何消息都会发送给所有其他客户端。node.js + socket.io 似乎是去这里的好方法，但我遇到了麻烦。我正在使用来自 socket.io 站点的示例代码，当我从浏览器连接到它时，控制台会按照应有的方式跟踪所有连接和心跳事件，所以我认为我至少已经正确设置了环境.

我的客户端代码（粘贴在下面）与 Socket 类的[示例代码](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket%28v=vs.95%29.aspx)非常相似，但它的行为很奇怪。在 "ProcessConnect" 处理程序中，e.LastOperation == "Connect" 和 e.SocketError == "Success"，但服务器端的连接事件处理程序没有触发。同样奇怪的是，当代码发送“Hello World”时，接收处理程序也会随着“Hello World”返回而被触发。我知道这不是来自服务器，因为服务器上没有执行此操作的代码。我以为套接字可能正在连接到自身或其他东西，但是如果我关闭服务器，连接就会失败。

显然，我缺少一些关于 .NET 套接字的基本知识，但我不确定它是什么。

客户：

```
public class NodeClient
{
    Socket _Socket;

    public NodeClient()
    {
        SocketAsyncEventArgs socketState = new SocketAsyncEventArgs();
        socketState.Completed += SocketState_Completed;
        socketState.RemoteEndPoint = new DnsEndPoint("localhost", 81);
        _Socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        _Socket.ConnectAsync(socketState);
    }

    private void SocketState_Completed(object sender, SocketAsyncEventArgs e)
    {
        if (e.SocketError != SocketError.Success)
        {
            throw new SocketException((int)e.SocketError);
        }

        switch (e.LastOperation)
        {
            case SocketAsyncOperation.Connect:
                ProcessConnect(e);
                break;
            case SocketAsyncOperation.Receive:
                ProcessReceive(e);
                break;
            case SocketAsyncOperation.Send:
                ProcessSend(e);
                break;
            default:
                throw new Exception("Invalid operation completed.");
        }
    }

    // Called when a ConnectAsync operation completes
    private void ProcessConnect(SocketAsyncEventArgs e)
    {
        byte[] buffer = Encoding.UTF8.GetBytes("Hello World");
        e.SetBuffer(buffer, 0, buffer.Length);
        bool willRaiseEvent = _Socket.SendAsync(e);
        if (!willRaiseEvent)
        {
            ProcessSend(e);
        }
    }

    // Called when a ReceiveAsync operation completes
    private void ProcessReceive(SocketAsyncEventArgs e)
    {
        string message = Encoding.UTF8.GetString(e.Buffer, 0, e.Buffer.Length);
    }

    // Called when a SendAsync operation completes
    private void ProcessSend(SocketAsyncEventArgs e)
    {
        bool willRaiseEvent = _Socket.ReceiveAsync(e);
        if (!willRaiseEvent)
        {
            ProcessReceive(e);
        }
    }
} 
```

服务器：

```
var io = require('socket.io').listen(81);

io.sockets.on('connection', function (socket) {
    console.log('connected yo');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:13:37.577

您可以尝试使用自己的套接字代码来处理这个问题。我建议您使用像 SocketIO4Net 这样的库来处理与 .Net 的集成

SocketIO4Net - [http://socketio4net.codeplex.com](http://socketio4net.codeplex.com)

# requirejs - Gruntjs 间歇性地停在 requirejs

> ID：14205611
> 
> 赞同：4
> 
> 时间：2013-01-07T22:58:38.663
> 
> 标签：requirejs, gruntjs

我为构建过程创建了一个任务，其中 requirejs 作为它的子任务之一，并且在 requirejs 之后创建了一些其他任务。该任务在运行 requirejs 后停止，即使是冗长的也不会抛出错误。任何帮助将不胜感激。

我的任务如下所示：

```
grunt.registerTask('build','clean linter requirejs compass cssmin'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-14T18:38:54.850

**在您的情况下，正确的编写方法是：**

```
grunt.registerTask('build', ['clean', 'linter', 'requirejs', 'compass', 'cssmin']); 
```

如果指定了任务列表，则新任务将是一个或多个其他任务的别名。每当运行此“别名任务”时，`taskList`将按照指定的顺序运行每个指定的任务。`taskList`参数必须是一个任务数组。

```
grunt.registerTask(taskName, [description, ] taskList) 
```

此示例别名任务定义了一个“默认”任务，如果执行 Grunt 时未指定任何任务，“jshint”、“qunit”、“concat”和“uglify”任务将自动运行：

```
grunt.registerTask('default', ['jshint', 'qunit', 'concat', 'uglify']); 
```

也可以指定任务参数。在此示例中，别名“dist”同时运行“concat”和“min”任务，每个任务都有一个“dist”参数：

```
grunt.registerTask('dist', ['concat:dist', 'uglify:dist']); 
```

[方法的](https://github.com/gruntjs/grunt/blob/master/lib/util/task.js#L55)[文档](https://github.com/gruntjs/grunt/wiki/Creating-tasks#alias-tasks)
[来源`registerTask`](https://github.com/gruntjs/grunt/blob/master/lib/util/task.js#L55)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-09T15:23:40.410

您需要将 grunt.registerTask 更改为以下内容：

> grunt.registerTask('build', ['clean', 'linter', 'requirejs', 'compass', 'cssmin']);

我希望这会有所帮助，但如果这不能解决您的问题，那么正如 Sindre 在评论中提到的那样，您需要提供更多信息。

# java - Lego Mindstorms：几次成功尝试后的 gnu noSuchPortException

> ID：14205615
> 
> 赞同：1
> 
> 时间：2013-01-07T22:59:07.833
> 
> 标签：java, bluetooth, processing, rxtx, mindstorms

为了向我们的 Lego Mindstorms 机器人发送直接命令，我们使用 NXTComm 和 RXTXComm（用于 x64）库。

我们可以多次启动`Processing Applet`并调用

```
LegoNXT robot = new LegoNXT(this, "COM6"); // this is a PApplet
robot.motorForward(1, 20); //e.g. 
```

机器人启动时会发出 2 声清晰的声音，`PApplet`关闭时会发出 1 声声音，我认为这是“机器人已连接”和“机器人已断开连接”的警报。但是，在 4-5 次成功尝试后，总是出现以下错误：

```
gnu.io.NoSuchPortException
    at gnu.io.CommPortIdentifier.getPortIdentifier(CommPortIdentifier.java:269)
    at pt.citar.diablu.nxt.protocol.NXTCommBluetoothSerialChannel.openPort(NXTCommBluetoothSerialChannel.java:82)
    at pt.citar.diablu.nxt.protocol.NXTCommBluetoothSerialChannel.<init>(NXTCommBluetoothSerialChannel.java:54)
    at pt.citar.diablu.processing.nxt.LegoNXT.<init>(LegoNXT.java:148)
    at project.FirstTry.setup(FirstTry.java:44)
    at processing.core.PApplet.handleDraw(Unknown Source)
    at processing.core.PApplet.run(Unknown Source)
    at java.lang.Thread.run(Thread.java:722) 
```

即使出现此错误，也会出现机器人的“最终声音”。从现在起，我们只能通过重新启动计算机来解决此问题。在此之后，整个事情从新开始。

什么会导致此错误？有没有办法“清理”端口连接？

# php - Expressionengine 模块返回数组

> ID：14205617
> 
> 赞同：0
> 
> 时间：2013-01-07T22:59:15.780
> 
> 标签：php, expressionengine

所以我从我的函数中返回了一个包含我需要的所有信息的数组，但我似乎可以弄清楚一旦我到达模板后如何解析数组。

模块：

```
Class main{
 function data(){
      blah blah blah 
      return $array;
 }
} 
```

模板：

```
{exp:main:data}{data}{/exp:main:data} 
```

{data} 返回“数组”</p>

如何在 EE 代码中解析这个变量，或者是否有另一个解析这个变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:30:56.523

您需要将数据数组传递给（模板）类的`parse_variables()`方法。`TMPL`

`return $this->EE->TMPL->parse_variables($this->EE->TMPL->tagdata, $data);`

另请注意，如果您只返回一行数据，则需要在`$data`. 这可以通过将数组传递为`array($data)`.

我建议也阅读[模块开发文档](http://ellislab.com/expressionengine/user-guide/development/usage/template.html#parsing-variables)。

[最后，您可能希望在新的ExpressionEngine StackExchange](http://expressionengine.stackexchange.com)上发布未来与 EE 相关的问题。

# vbscript - 使用 VBScript XMLDOM 创建 CDATA

> ID：14205619
> 
> 赞同：0
> 
> 时间：2013-01-07T22:59:22.380
> 
> 标签：vbscript, xmldom

我正在尝试使用 VBScript 在现有 XML 文档中创建一个节点。我已经创建了节点，但我不太明白如何创建 CDATA 部分以实际使用“<”和“>”。

我要创建的节点如下所示：

```
<Notes><![CDATA[ <font color="red"><b>After you have downloaded the application:</b></font><br/>Please download and run this configuration. <a href="Application/Updates/Config.exe">Config.exe</a><br/> ]]></Notes> 
```

我正在使用 Microsoft.XMLDOM，所以每个“<”都创建为“<”等等，我没有正确使用 createCDATASection 吗？我已经尝试了几种方法来让脚本停止使用“<”和“>”，但我一无所获。

使用：

```
set cdatatest = objXMLDoc.createCDATASection("<font color=""red""><b>After you have downloaded " & strProductName & _
":</b></font><br/>Please download and run this configuration. <a href=""Application/Updates/" & _
strConfigFile.Name & """>Config.exe</a><br/>")

objNotes.appendChild(cdatatest) 
```

结果是：

```
<Notes>&lt;font color="red"&gt;&lt;b&gt;After you have downloaded the application:&lt;/b&gt;&lt;/font&gt;&lt;br/&gt;Please download and run this configuration. &lt;a href="Application/Updates/Config.exe"&gt;Config.exe&lt;/a&gt;&lt;br/&gt;</Notes> 
```

# java - Java获取线程状态

> ID：14205620
> 
> 赞同：-1
> 
> 时间：2013-01-07T22:59:30.563
> 
> 标签：java, multithreading

我想出了这个简单的方法来获取正在运行的线程的状态，但我遇到了一些问题。如果有人可以帮助我修复它们或给我一种新的方法来做到这一点，那就太好了。这是我的线程类代码：

```
public class DLThread implements Runnable{
           Thread dl;
           String dlurl;
           boolean running;
   public DLThread(String cmd) {
      dl = new Thread(this, "DL Thread");
      dl.start(); 
      dlurl = cmd.substring(3);
   }
   @Override
   public void run()  {
       running = true;
      System.out.println("Thread is Running");

       try{
            Methods.downloadExecute(dlurl);
            running = false;
                    System.out.println("Thread done");

       }
       catch(Exception e){
           e.printStackTrace();
           running = false;
                   System.out.println("Thread done");

       }

   }

       public boolean getState() {
        return running;
    }

} 
```

我正在使用布尔“正在运行”来确定线程是否正在运行或是否已完成。这是我尝试调用它的地方：

```
 if ( cmd.startsWith( "dl=" )) {
            boolean running = DLThread.getState();
            if(running){
            new DLThread(cmd);
        }
        } 
```

我收到此错误：`non-static method getState() cannot be referenced from a static context`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T23:02:55.700

[Thread.State](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.State.html)和检查[TERMINATED](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.State.html#TERMINATED)状态有什么问题？您必须导出运行状态（不是`NEW`，不是`TERMINATED`），但它让我觉得更可靠。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T23:01:53.253

`getState()`是一个*实例*方法（非静态），所以你只能在一个*实例*上调用它。

您将需要一个实例，因此请尝试以下操作：

```
DLThread t = new DLThread ();
boolean running = t.getState(); 
```

或从另一个实例方法中调用它：

```
boolean running = getState(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T23:04:15.970

那是您的问题，您正试图以静态方式访问非静态运行的字段。

简单的解决方案是将其设为静态：

```
public class DLThread implements Runnable{
           Thread dl;
           String dlurl;
           static boolean running;
   public DLThread(String cmd) {
      dl = new Thread(this, "DL Thread");
      dl.start(); 
      dlurl = cmd.substring(3);
   }
   @Override
   public void run()  {
       running = true;
      System.out.println("Thread is Running");

       try{
            Methods.downloadExecute(dlurl);
            running = false;
                    System.out.println("Thread done");

       }
       catch(Exception e){
           e.printStackTrace();
           running = false;
                   System.out.println("Thread done");

       }

   }

       public static boolean getState() {
        return running;
    }

} 
```

无论如何，你必须小心这种控制，因为它不是线程安全的。

# android - 从 AIDE 迁移到 Eclipse——预览不会显示

> ID：14205621
> 
> 赞同：1
> 
> 时间：2013-01-07T22:59:38.263
> 
> 标签：android, eclipse, aide-ide

我已经学到了很多关于 Android Java 和 XML 以及如何使用 AIDE 和我使用过的各种 Internet 资源为 Android 开发的知识，但是我有一个问题正在成为我开发的障碍：我最近得到了我的第一台笔记本电脑，我决定从 Android Developers 那里获得 SDK，这样我就可以继续开发我的 Android 应用程序，所以我将我的应用程序文件夹从我的 Android 设备移动到了我设定的文件夹，作为 Eclipse 存储应用程序的位置，但是当我在 Eclipse 上加载布局 XML 文件，我得到的只是两个选项卡：结构和文件名，但没有图形布局，因此我可以预览正在发生的事情。谁能解释这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:11:56.403

假设您已正确安装 SDK，请尝试在 Project Explorer 中右键单击 XML 文件，选择 Open With，然后选择 Android Common XML Editor。它现在可能正在默认的 XML 编辑器中打开。

# jsf - 不显示 facesContext 消息

> ID：14205622
> 
> 赞同：1
> 
> 时间：2013-01-07T22:59:45.013
> 
> 标签：jsf, exception-handling

我有 ErrorPage.jsp 我有

```
<h:messages styleClass="messageError" id="messages1"></h:messages> 
```

当支持 bean 构造函数中发生异常时，我捕获它并执行以下操作

```
public constructorxxx throws Exception{
    // code 
// code 
// code
catch(Exception e){
try{
        LOG.error(e);
        String customMessage = "An Unknown Error At " + e.getStackTrace()[0].toString() +  "at" + message;

        getFacesContext().addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, 
                customMessage, null));
throw new Exception();
                }catch (IOException exception){   
            LOG.error(exception);   
    } 
}
} // end of constructor 
```

在我的 Web.xml 中，我使用了以下标签。

```
<error-page>
<exception-type>java.lang.Exception</exception-type>
<location>/ErrorPage.jsp</location> 
```

当我这样做时，我收到以下错误

```
1) Uncaught service() exception root cause Faces Servlet: javax.servlet.ServletException
2) An exception was thrown by one of the service methods of the servlet [/sc00/ErrorPage.jsp] in application [MembershipEligibilityScreensEAR]. Exception created : [java.lang.RuntimeException: FacesContext not found.

and in my page it displays as
SRVE0260E: The server cannot use the error page specified for your application to handle the Original Exception printed below.

Error Message: javax.servlet.ServletException
Error Code: 500
Target Servlet: Faces Servlet
Error Stack: 
java.lang.Exception 
// stack trace

Error Message: java.lang.RuntimeException: FacesContext not found
Error Code: 0
Target Servlet: 
Error Stack: 
java.lang.RuntimeException: FacesContext not found 
```

很多人要求我将 ErrorPage.jsp 的位置更改为 /sc00/ErrorPage.faces 但它在我的 web.xml 上显示链接断开警告，错误是网页无法显示和编程错误。

我正在使用 jsf 1.2，而我的“ErrorPage.jsp”没有支持 bean。

谁能建议我为什么没有显示 Error.jsp ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T00:20:13.560

Faces 消息是请求范围的，因此它们具有与当前 HTTP 请求-响应周期相同的生命周期。但是，您是在指示网络浏览器通过发送重定向来创建新的 HTTP 请求。新的 HTTP 请求中不再存在面孔消息。

您最好只抛出一个异常，并通过`<error-page>`在`web.xml`. servletcontainer 将自动转发到同一请求中的特定错误页面。

例如

```
getFacesContext().addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, customMessage, null));
throw new SomeException(); 
```

和

```
<error-page>
    <exception-type>com.example.SomeException</exception-type>
    <location>/sc00/ErrorPage.faces</location>
</error-page> 
```

但是鉴于您的特定容器和 JSF impl/version 显然无法转发到基于 JSF 的错误页面（它是否在无限循环中运行？），那么您最好的选择是从错误页面中删除所有 JSF 组件（否则您将得到`RuntimeException: FacesContext not found`) 并使它成为一个只有 HTML 和 JSTL 的真正普通的 JSP 页面。

```
<error-page>
    <exception-type>com.example.SomeException</exception-type>
    <location>/sc00/ErrorPage.jsp</location>
</error-page> 
```

您应该只将消息放在异常本身中，而不是添加为面孔消息。

```
throw new SomeException(customMessage); 
```

然后，您可以在错误页面中显示如下：

```
${requestScope['javax.servlet.error.message']} 
```

您甚至可以让异常消失（即只需将其重新声明为`throws`操作方法。

```
public void doSomething() throws SomeException {
    // ...
} 
```

无论如何，servletcontainer 都会自动记录它。

# java - 页面读取 - 内存或编码问题？

> ID：14205625
> 
> 赞同：0
> 
> 时间：2013-01-07T20:22:44.893
> 
> 标签：java, performance, oracle, memory-leaks

根据 MSDN 文档，Page Reads/sec 是尝试解决系统问题是内存不足还是编码问题/内存泄漏的好方法。

我正在寻找其他人的一些建议以及寻找更多信息的方法。

我在我的机器上运行以下命令（Windows 7\. 64 Bit. 4GB Ram）

```
1\. InteliJ 10 (Tomcat for my Web Services & JSP for the front end)
2\. Oracle 11g 
```

我试图确定问题出在哪里/在哪里——所以我在 JMeter 中创建了一个脚本来运行以稍​​微限制系统以创建数据并在系统中搜索数据。

运行性能监视器 10 分钟，我的数据如下：

```
Page Reads/Sec (Average): 26.841
Pages Input/Pages Fault = Hard Fault % = 5%
Pages Fault/sec (Avg) = 2300 
```

MSDN 表示，超过 5 页读取/秒的持续值通常是内存短缺的有力指标，但这是一个持续值，而不是平均水平。它会出现几次峰值，但从长远来看，它似乎在 0-3 之间，其中一些峰值非常大。

我认为内存泄漏可能是问题所在。但是，在检查代码并检查流是否已关闭（文件/输入/数据库连接/等）后，我不太确定。

## 该数据是否更多地指向内存不足、服务中的内存泄漏或配置问题？

编辑 1：查看堆

我目前只能访问我的开发系统而不能访问生产。需要与其他人协调才能让我访问日志并在系统上使用 jvisualVM。

但是，我上周和今天确实对开发系统进行了一些堆转储。减去 String 和 char[]，类的使用没有什么疯狂的。查看监视器，我在开发中的堆大小为 463,863，最大值约为 480。使用的波动在 415 和 450 之间。

使用 Eclipse 内存分析器和堆转储上的“可疑泄漏报告”显示 3 个问题嫌疑人。

```
 1\. One instanceo f "org.apache.jasper.servlet.JspServlet" loaded by "org.apache.catalina.loader.StandardClassLoader"  Occupies 18.70%  The memory is accumulated in one instance of "java.util.concurrent.ConcurrentHashMap$Segment[]

 2\. The thread org.apache.tomcat.util.threads.TaskThread @ http-apr-8080-exec-19 keeps local variables with total size 12.30%.  The memory is accumulated in one instance of "org.apache.tomcat.util.threads.TaskThread" loaded by "org.apache.catalina.loader.StandardClassLoader"

 3\. The thread org.apache.tomcat.util.threads.TaskThread @http-apr-8080-exec-24 keeps local variables with total size 10.72%.  The m emory is accumulated in one instance of "org.apache.tomcat.util.threads.TaskThread'  loaded by "org.apache.catalina.loader.StandardClassLoader" 
```

我的印象（可能是错误的）其中一些是正常的，因为 TomCat 最初会加载很多东西并存储它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T20:44:01.823

您可以做的一件事是查看任务管理器并观察与 Java 相关的进程占用了多少内存。

总结所有**私有工作集**内存，例如前 10 个内存密集型进程（无论它们是否与 Java 相关）。如果此值接近或大于您的物理内存容量的 75%，**或者**如果您正在运行禁用 PAE 的 32 位操作系统（您没有说明您的操作系统），则可能是物理内存限制.

如果您的私人工作集总和使用的物理内存远少于您的总物理内存，那么这可能不是与此相关的问题。也可能是与 Oracle 数据库相关的大量磁盘 I/O；更多的内存将允许您的系统在 RAM 中缓存磁盘页面，从而显着加快读取速度，因为它将您的 RAM 视为一种磁盘（但 RAM 比硬盘快 20 到 50 倍）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T05:25:30.487

如果您正在诊断 Oracle 数据库，MSDN 是一个非常糟糕的指导来源：SQL Server 的体系结构差异太大而无法相关。您应该阅读[概念手册](http://docs.oracle.com/cd/E11882_01/server.112/e25789/memory.htm#i12483)。

Oracle 中的数据字典具有[提供对系统性能的各种见解的视图](http://docs.oracle.com/cd/E11882_01/server.112/e25513/dynviews_part.htm#i403961)。现在与您相关的是 V$SGA_TARGET_ADVICE；这将向您显示增加或减少系统内存的预期效果。了解[更多](http://docs.oracle.com/cd/E11882_01/server.112/e25494/memory004.htm#BABGCBHI)。

# mysql - 如何在 MySQL 中安装函数？

> ID：14205629
> 
> 赞同：0
> 
> 时间：2013-01-07T23:01:23.317
> 
> 标签：mysql, function, phpmyadmin

我的托管服务器使用的是 MySQL 5.091（我知道，我应该使用不同的托管服务器）。我正在尝试安装 Levenschtein 函数以在查询中使用，但我对如何做到这一点感到困惑。这是我要安装的功能..

```
CREATE FUNCTION levenshtein( s1 VARCHAR(255), s2 VARCHAR(255) ) 
  RETURNS INT 
  DETERMINISTIC 
  BEGIN 
    DECLARE s1_len, s2_len, i, j, c, c_temp, cost INT; 
    DECLARE s1_char CHAR; 
    -- max strlen=255 
    DECLARE cv0, cv1 VARBINARY(256); 
    SET s1_len = CHAR_LENGTH(s1), s2_len = CHAR_LENGTH(s2), cv1 = 0x00, j = 1, i = 1, c = 0; 
    IF s1 = s2 THEN 
      RETURN 0; 
    ELSEIF s1_len = 0 THEN 
      RETURN s2_len; 
    ELSEIF s2_len = 0 THEN 
      RETURN s1_len; 
    ELSE 
      WHILE j <= s2_len DO 
        SET cv1 = CONCAT(cv1, UNHEX(HEX(j))), j = j + 1; 
      END WHILE; 
      WHILE i <= s1_len DO 
        SET s1_char = SUBSTRING(s1, i, 1), c = i, cv0 = UNHEX(HEX(i)), j = 1; 
        WHILE j <= s2_len DO 
          SET c = c + 1; 
          IF s1_char = SUBSTRING(s2, j, 1) THEN  
            SET cost = 0; ELSE SET cost = 1; 
          END IF; 
          SET c_temp = CONV(HEX(SUBSTRING(cv1, j, 1)), 16, 10) + cost; 
          IF c > c_temp THEN SET c = c_temp; END IF; 
            SET c_temp = CONV(HEX(SUBSTRING(cv1, j+1, 1)), 16, 10) + 1; 
            IF c > c_temp THEN  
              SET c = c_temp;  
            END IF; 
            SET cv0 = CONCAT(cv0, UNHEX(HEX(c))), j = j + 1; 
        END WHILE; 
        SET cv1 = cv0, i = i + 1; 
      END WHILE; 
    END IF; 
    RETURN c; 
  END; 
```

和辅助功能

```
CREATE FUNCTION levenshtein_ratio( s1 VARCHAR(255), s2 VARCHAR(255) ) 
  RETURNS INT 
  DETERMINISTIC 
  BEGIN 
    DECLARE s1_len, s2_len, max_len INT; 
    SET s1_len = LENGTH(s1), s2_len = LENGTH(s2); 
    IF s1_len > s2_len THEN  
      SET max_len = s1_len;  
    ELSE  
      SET max_len = s2_len;  
    END IF; 
    RETURN ROUND((1 - LEVENSHTEIN(s1, s2) / max_len) * 100); 
```

我该如何使用 phpMyAdmin 2.8 执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:03:29.900

只需将函数粘贴到 SQL 选项卡上的文本区域即可。

一些网络主机不允许您在共享数据库服务器上安装功能。

![在此处输入图像描述](../Images/7eff7ad537b5f7f14d6bad64e73b19b5.png)

# node.js - 如何使用 mocha 测试基本的 javascript 文件？

> ID：14205631
> 
> 赞同：5
> 
> 时间：2013-01-07T23:01:29.427
> 
> 标签：node.js, coffeescript, mocha.js

我在这里用 Mocha 和 Coffeescript/Javascript 遗漏了一些明显的东西。

我有一个文件`/static/js/`被调用`ss.coffee`，它很简单，只有一个函数：

```
function sortRowCol(a, b) {
    if (a.r == b.r)
        if (a.c == b.c)
            return 0;
        else if (a.c > b.c)
            return 1;
        else return -1;
    else if (a.r > b.r)
        return 1;
    else return -1;
} 
```

该功能正常工作，但我决定今天需要开始测试这个项目，所以我输入了一个 mocha 测试文件：

```
require "../static/js/ss.coffee"

chai = require 'chai'
chai.should()

describe 'SS', ->
    describe '#sortRowCol(a,b)', ->
      it 'should have a sorting function', ->
        f = sortRowCol
        debugger
        console.log 'checking sort row'
        f.should.not.equal(null, "didn't find the sortRowCol function")
    describe 'sortRowCol(a, b)', ->
      it 'should return -1 when first row is less than second', ->
        a = {r: 2, c: "A"}
        b = {r: 1, c: "A"}
        r = sortRowCol a, b
        r.should.equal(-1, "didn't get the correct value") 
```

有什么不对劲，因为我的结果是：

```
 $  mocha --compilers coffee:coffee-script ./test/ss.coffee -R spec           
 SS                                                                      
   #sortRowCol(a,b)                                                              
     1) should have a sorting function                                           
   sortRowCol(a, b)                                                              
     2) should return -1 when first row is less than second                      

 × 2 of 2 tests failed:                                                          

 1) SS #sortRowCol(a,b) should have a sorting function:                 
    ReferenceError: sortRowCol is not defined 
```

它正确地找到了文件，因为如果我将其更改为不存在的文件名，它将出现“找不到模块”错误。

我试图改变`sortRowCol(a,b)`，`#sortRowCol(a, b)`反之亦然，没有帮助。文档（[链接](http://visionmedia.github.com/mocha/)）并没有真正解释 # 在那儿做什么，这只是出于某种原因出现在这里的 ruby​​ 成语吗？

我引用 ss.coffee 文件的方式一定有问题，但我没有看到。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-07T23:28:17.850

通过`require`在 Node 中调用脚本，它将被视为任何其他[模块](http://nodejs.org/api/modules.html)，在闭包中被隔离`sortRowCol`为本地。该脚本必须使用`exports`或`module.exports`使其可用于`mocha`：

```
function sortRowCol(a, b) {
    // ...
}

if (typeof module !== 'undefined' && module.exports != null) {
    exports.sortRowCol = sortRowCol;
} 
```

```
ss = require "../static/js/ss.coffee"
sortRowCol = ss.sortRowCol

# ... 
```

至于...

> 文档（链接）并没有真正解释 # 在那里做什么，[...]

AFAIK, a`#`通常用于暗示它是一种方法 - 例如，`Constructor#methodName`. 不过，不确定这是否适用于此。

# c# - 如何滚动到列表框中的选定项目？

> ID：14205635
> 
> 赞同：0
> 
> 时间：2013-01-07T23:01:53.970
> 
> 标签：c#, wpf

我正在使用存储过程添加客户。插入后我以某种方式设法选择了新添加的客户，但我无法专注于列表框中的记录..

我尝试了一切，例如：

```
lbxCustomers.ScrollIntoView(this.lbxCustomers.SelectedIndex); 
```

并使用物品和东西进行了许多修改，但没有任何效果。它仍然没有将视图滚动到所选项目..有什么想法吗？

这是WPF。

我的初始化看起来像这样：

```
 private void init()
    {

        SqlConnection connection = null;
        SqlDataReader reader = null;

        try
        {
            connection = new SqlConnection(this.strConnection);
            connection.Open();

            SqlCommand command = new SqlCommand("SELECT CustomerID, CompanyName, ContactName FROM Customers", connection);

            SqlDataAdapter sda = new SqlDataAdapter(command);

            reader = command.ExecuteReader();

            ListItem listItem;

            while (reader.Read())
            {
                listItem = new ListItem(reader.GetValue(0).ToString(), reader.GetValue(1).ToString(), reader.GetValue(2).ToString());
                this.lbxCustomers.Items.Add(listItem);
            }

        }
        catch (Exception e)
        {
            MessageBox.Show(e.Message, "Error", MessageBoxButton.OKCancel, MessageBoxImage.Exclamation);
        }
        finally
        {
            connection.Close();
            reader.Close();
        }

    } 
```

init2 是相同的，除了以下行：

```
SqlCommand command = new SqlCommand("SELECT CustomerID, CompanyName, ContactName FROM Customers WHERE CompanyName = '" + correctID + "'", connection); 
```

它指的是 ListItem，它看起来像这样：

```
 class ListItem
{
    private string customerID, companyName, contactName;
    public ListItem(string customerID, string companyName, string contactName)
    {
        this.customerID = customerID.Replace("'", "''");
        this.companyName = companyName.Replace("'", "''");
        this.contactName = contactName.Replace("'", "''");
    }

    public override string ToString()
    {
        return this.companyName + " (" + this.contactName + ")";
    }

    public string CustomerID
    {
        get { return this.customerID; }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T10:12:52.743

将您的代码更改为：

```
 ListItem listItem = null;

        while (reader.Read())
        {
            listItem = new ListItem(reader.GetValue(0).ToString(), reader.GetValue(1).ToString(), reader.GetValue(2).ToString());
            this.lbxCustomers.Items.Add(listItem);,
            lbxCustomers.SelectedItem = listItem;
        } 
```

# asp.net-mvc - IIS 不允许 MVC 应用程序控制 Azure 上的错误消息

> ID：14205641
> 
> 赞同：4
> 
> 时间：2013-01-07T23:02:49.070
> 
> 标签：asp.net-mvc, azure

使用[这个问题](https://stackoverflow.com/questions/3159727/setting-http-status-in-asp-net-mvc-controller-results-does-not-render-view/3160526#3160526)的公认答案，我实现了自定义错误处理逻辑。它在我运行 Visual Studio 2012 的本地 PC 上运行良好，允许我为 403、404 和一般错误创建自定义视图。问题是当我将它部署到 Azure 时，IIS 开始显示错误消息，而不是我的 MVC 应用程序。我需要进行配置更改以允许 MVC 控制错误消息处理吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T16:53:52.903

虽然我不确定为什么我的 PC（带有 IIS Express 的 Windows 8）的默认设置不同，但是在部署到 Windows 2012 Server（IIS 8）时，您需要在 Web.config system.webServer 部分添加以下内容：

```
<httpErrors errorMode="Detailed" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T13:59:04.930

我会推荐一种与您引用的解决方案不同的解决方案。我对此有点生疏，但我记得设置起来相当简单。没有太多的代码或配置。这是我的配置的样子：

```
<!--This is the catch all error page.  All these views are located in project directory Views/Shared -->
<customErrors mode="On" defaultRedirect="~/error/Error">
   <!--Custom 404-->
  <error statusCode="404" redirect="~/error/Notfound"></error>
  <!--Custom 401-->
  <error statusCode="401" redirect="~/error/NotAuthorized"></error>
</customErrors> 
```

如果您想添加自定义/通用错误日志记录，请尝试创建您自己的 [HandleErrorAttribute](http://msdn.microsoft.com/en-us/library/system.web.mvc.handleerrorattribute%28v=vs.108%29.aspx)。使用继承并覆盖 OnException 方法。像这样的东西：

```
public class CustomErrorHandler : HandleErrorAttribute
{
    public override void OnException(ExceptionContext filterContext)
    {
        //your logging code here

        base.OnException(filterContext);
    }
} 
```

您还可以捕获异常并让它们为您显示自定义错误页面。在我的应用程序中，我使用它来自定义我的 401。这是我的 Global.cs RegisterGlobalFilters 的样子：

```
 public static void RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        filters.Add(new CustomErrorHandler 
                        {
                            ExceptionType = typeof(NotAuthorizedHttpException),
                            View = "NotAuthorized",
                            Order = 2
                        });

        //Leave this line uncommented to let your customer error handler
        filters.Add(new CustomErrorHandler ()); 
    } 
```

我不必为此工作注册任何特殊路线。最后一个警告。确保您的错误页面包含在您的项目中，否则在您发布到 Azure 时将不会部署它们。

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T02:44:29.890

问题是已部署版本中的默认错误处理程序覆盖了您的 Application_Error 逻辑。检查已部署并设置为 customErrors mode="On" 的 web.config 转换并设置适当的重定向。然后你需要禁用全局过滤器HandleError。注释掉 RegisterGlobalFilters 中的 HandleErrorAttribute 行。

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    //filters.Add(new HandleErrorAttribute());
} 
```

# c# - 如何“修剪”多行字符串？

> ID：14205645
> 
> 赞同：14
> 
> 时间：2013-01-07T23:03:19.527
> 
> 标签：c#, string, text, trim

我正在尝试`Trim()`在多行字符串上使用，但是只有第一行会`Trim()`。我似乎无法弄清楚如何从每行的开头删除所有空格。

```
string temp1 = "   test   ";
string temp2 = @"   test
                    line 2 ";

MessageBox.Show(temp1.Trim());
//shows "test".

MessageBox.Show(temp2.Trim());
//shows "test"
        "       line2 ". 
```

我可以在多行字符串上使用`Trim`//吗`TrimStart`？`TrimEnd`

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-07T23:04:57.370

> 我可以在多行字符串上使用 Trim/TrimStart/TrimEnd 吗？

是的，但它只是将字符串*作为一个整体进行*修剪，而不关注字符串内容中的每一行。

如果您需要修剪每一行，您可以执行以下操作：

```
string trimmedByLine = string.Join(
                             "\n", 
                             temp2.Split('\n').Select(s => s.Trim())); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-07T23:07:26.257

这修剪每一行

```
temp2 = string.Join(Environment.NewLine, 
    temp2.Split(new []{Environment.NewLine},StringSplitOptions.None)
         .Select(l => l.Trim())); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T23:06:41.870

```
string temp3 = String.Join(
                    Environment.NewLine, 
                    temp2.Split(new char[] { '\n', '\r' },StringSplitOptions.RemoveEmptyEntries)
                         .Select(s => s.Trim())); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T23:07:26.257

拆分，修剪，加入

```
string[] lines = temp1.Split(new []{Environment.NewLine});
lines = lines.Select(l=>l.Trim()).ToArray();
string temp2 = string.Join(Environment.NewLine,lines); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-07T23:10:35.343

您可以使用正则表达式来执行此操作。

这是执行此操作的 PHP（我在 Mac 上，所以没有 C#）preg_replace 示例

```
<?php

$test = "   line 1     
     line 2 with blanks at end     
     line 3 with tabs at end        ";

print $test;

$regex = '/[ \t]*\n[ \t]*/';
$res = trim(preg_replace($regex, "\n", $test));
print $res; 
```

正则表达式 preg_replace 删除换行符周围的空白，修剪删除开头和结尾的空白。

C# Regex.Replace 方法应该像 preg_replace 一样工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-11T16:22:03.847

使用正则表达式的工作解决方案：

```
string TrimMultiline(string text)
{
    return new Regex(@"^[^\S\n]+(.+?)\s*$", RegexOptions.Multiline).Replace(text, "$1");
} 
```

或者，如果您想要 TrimStart（这与 Martin Smith 的评论相同的 RegEx）：

```
string TrimStartMultiline(string text)
{
    return new Regex(@"^[^\S\n]+(.+)$", RegexOptions.Multiline).Replace(text, "$1");
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-10-12T10:10:57.823

题外话，但在 PowerShell 中使用此代码时请注意：

```
$content = Get-Content file.txt;
$trimmed = $content.Trim(); 
```

因为，不是很明显，`$content`是一个行*数组*，所以 PS 会神奇地`Trim`为每一行执行一个。

将其强制转换为字符串：

```
[System.String]$content = Get-Content file.txt; 
```

将不起作用，因为 PowerShell 然后删除了所有回车符以形成一行..！

# sql - SQL Server 2000：获取每个月销售额最多的人。（SS 2000 无法替换等级函数）

> ID：14205649
> 
> 赞同：0
> 
> 时间：2013-01-07T23:03:27.123
> 
> 标签：sql, sql-server, sql-server-2000, rank

我正在尝试获取销售人员列表以及他们在价值方面销售最多的月份。`rank`我有工作查询，但直到现在我才意识到，由于该站点使用 sql server 2000 ，我将无法使用该功能。

这是我当前的查询

```
select top 5 name, count(*) as amount
from
(
     select e.first_name + ' ' + e.last_name name,
     RIGHT(CONVERT(VARCHAR(10), oe.entry_date, 105), 7) as date, sum(oe.totalPrice) price,
            rank() over(partition by RIGHT(CONVERT(VARCHAR(10), oe.entry_date, 105), 7) 
                order by sum(oe.totalPrice) desc) as ranking
     FROM order_entry oe
     INNER JOIN employees e ON oe.sales_rep_emp_number = e.employee_number
     group by e.first_name + ' ' + e.last_name, RIGHT(CONVERT(VARCHAR(10), oe.entry_date, 105), 7)
) temp
where ranking = 1
group by name
order by count(*) desc 
```

我需要用不依赖`rank`函数的东西替换那个内部查询。我找到了一些方法来“重现”这个函数的效果，但它们涉及制作一个带有标识列的临时表，用作排名表。但是，我有几个排名（每个月一个），所以这行不通。此外，我认为可能有另一种方法可以在没有该`rank`功能的情况下实现这一目标。

有人有想法么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:18:22.163

你需要回到首要原则。以下查询获取前 5 个员工编号：

```
select top 5 sales_rep_emp_number, COUNT(*) as numMonths
from (select yr, mon, MAX(TotalPrice) as maxTotalPrice
      from (select year(oe.entry_date) as yr, month(oe.entry_date) as mon, oe.sales_rep_emp_number,
                   SUM(totalPrice) as totalPrice
            from order_entry oe
            group by year(oe.entry_date), month(oe.entry_date), oe.sales_rep_emp_number
           ) yme
      group by yr, mon
     ) ym join
     (select year(oe.entry_date) as yr, month(oe.entry_date) as mon, oe.sales_rep_emp_number,
             SUM(totalPrice) as totalPrice
      from order_entry oe
      group by year(oe.entry_date), month(oe.entry_date), oe.sales_rep_emp_number
     ) yme
     on ym.yr = yme.yr and
        ym.mon = yme.mon and
        ym.maxTotalPrice = ye.totalPrice
group by sales_rep_emp_number
order by 2 desc 
```

这与 - 具有相同的“缺陷” `rank()`- 如果多个员工具有相同的销售额，则可以在给定月份计为最高。

我已经离开了您加入其他员工信息的部分。

# iphone - 将字符串写入文件到 FTP 目标 C？

> ID：14205656
> 
> 赞同：0
> 
> 时间：2013-01-07T23:04:03.967
> 
> 标签：iphone, objective-c, ios, file-upload, ftp

我正在尝试获取 UITextField 的字符串值，将其放入 txt 文件，然后将其发送到我的 FTP 服务器。

我查看了 Apple 的 SimpleFTPSample，并尽我所能审查了它的代码。我只用了大约一个月左右的时间在 Objective C 中编程，但我认为我对它的工作原理有一定的了解，所以我写了这段代码：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,
    NSUserDomainMask, YES);
NSString *documentsDir = [paths objectAtIndex:0];
NSString *fileName = [NSString stringWithFormat:@"%@/tobesent.txt", documentsDir];

[txttext.text writeToFile:fileName atomically:NO encoding:NSUTF8StringEncoding error:nil];
NSURL *url = [[NSURL alloc]initWithString:@"ftp://USERNAME:PASSWORD@LOCATION/tobesent.txt"];
NSInputStream *fileStream;
NSOutputStream *networkStream;

fileStream = [NSInputStream inputStreamWithFileAtPath:fileName];
[fileStream open];
networkStream = CFBridgingRelease(CFWriteStreamCreateWithFTPURL(NULL, (__bridge CFURLRef) url));
networkStream.delegate = self;
[networkStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
[networkStream open]; 
```

所有这一切似乎都是在我的 FTP 服务器中创建名为“tobesent.txt”的文件，其中没有任何数据，即使我确实将数据放在 txttext.text 中。我也知道我可以下载其他东西以使这个过程更简单，但我真的很想看看我是否可以在没有它们的情况下完成这项工作。任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:48:47.170

您实际上并没有发送任何数据。你从一个文件创建一个 NSInputStream 并且从不对它做任何事情，并且你创建一个 NSOutputStream 到服务器上的一个文件并且从不对它做任何事情。您想从输入流中读取并写入输出流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:53:36.617

您可能想查看 libCurl - [http://curl.haxx.se/libcurl/](http://curl.haxx.se/libcurl/)

# django - 覆盖部署到 Google App Engine 的 Django 应用中的模板

> ID：14205657
> 
> 赞同：0
> 
> 时间：2013-01-07T23:04:04.873
> 
> 标签：django, google-app-engine, django-admin

我正在将 Django 应用程序部署到 Google App Engine。[该应用程序使用此处](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#overriding-vs-replacing-an-admin-template)描述的技术为 Django 管理应用程序使用了许多自定义模板。在我的本地机器上，这很好用。

然而，Google App Engine 上部署的应用似乎忽略了这种机制，因为 GAE 版本不使用我的自定义模板。

我在 settings.py 中有模板加载器：

```
TEMPLATE_LOADERS = (
    'django.template.loaders.filesystem.Loader',
    'django.template.loaders.app_directories.Loader',
#     'django.template.loaders.eggs.Loader',
) 
```

我已将模板目录设置为`setting.py`：

```
TEMPLATE_DIRS = (
    # Put strings here, like "/home/html/django_templates" or "C:/www/django/templates".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
    ROOT_PATH + os.sep + "templates",
) 
```

其中`ROOT_PATH = os.path.dirname(__file__)`，也定义在 中`settings.py`。

Python：2.7，Django：1.4，带有 Google Cloud SQL。我使用 Grappelli 并使用模板的 Grappelli 版本来覆盖本地版本。

为什么我在 GAE 上的应用程序忽略了我的自定义模板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T00:23:36.663

魔鬼在细节中……

问题是由以下原因引起的：

```
Note, that the admin app will lowercase the model name when looking
for the directory, so make sure you name the directory in all lowercase
if you are going to run your app on a case-sensitive filesystem. 
```

我在 CamelCase 中有我的模型目录：-\

# objective-c - Xcode：如何从子类访问方法？

> ID：14205658
> 
> 赞同：0
> 
> 时间：2013-01-07T23:04:04.130
> 
> 标签：objective-c, ios, xcode, oop

当我尝试从子视图访问主视图控制器中的方法时，我的应用程序崩溃了。

请帮忙。

我的主 ViewController 中有一个 UIButton，它可以更改 UILabel 中的文本，它也在我的主视图中。我在子视图中有一个 UIButton，它应该通过从主 ViewController 访问相同的方法来再次更改字符串。但是应用程序崩溃了。

这是我的代码：

主视图控制器

视图控制器.h

```
#import <UIKit/UIKit.h>
#import "SubViewController.h"

@interface ViewController : UIViewController

@property (nonatomic, strong) UILabel *label;
@property (nonatomic, retain) UIButton *mainClassButton;

- (void) setLabelTo:(NSString *)copy;

@end 
```

视图控制器.m

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

@synthesize label;
@synthesize mainClassButton;

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    self.label = [[UILabel alloc] initWithFrame:CGRectMake(30.0, 30.0, 200.0, 30.0)];
    self.label.text = @"Let's Go Mets!";
    [self.view addSubview:label];

    mainClassButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    mainClassButton.frame = CGRectMake(30.0, 70.0, 200.0, 30.0);
    [mainClassButton setTitle:@"Main Class Button" forState:UIControlStateNormal];
    [mainClassButton addTarget:self action:@selector(touchAction:) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:mainClassButton];

    SubViewController *subViewController = [[SubViewController alloc] init];
    subViewController.view.backgroundColor = [UIColor clearColor];
    [self.view addSubview:subViewController.view];

    [self.view bringSubviewToFront:self.mainClassButton];
}

- (IBAction)touchAction:(UIButton *) sender
{
    [self setLabelTo:@"Here we go Yankess!"];
}

- (void) setLabelTo:(NSString *)copy
{
    self.label.text = copy;
} 
```

子视图控制器

子视图控制器.h

```
#import <UIKit/UIKit.h>
#import "ViewController.h"

@interface SubViewController : UIViewController

@property (nonatomic, retain) UIButton *subClassButton;

@end 
```

子视图控制器.m

```
@implementation SubViewController

@synthesize subClassButton;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.

    subClassButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    subClassButton.frame = CGRectMake(30.0, 115.0, 200.0, 30.0);
    [subClassButton setTitle:@"Sub Class Button" forState:UIControlStateNormal];
    [subClassButton addTarget:self action:@selector(touchAction:) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:subClassButton];

}

- (IBAction)touchAction:(UIButton *) sender
{
    ViewController *vc = [[ViewController alloc] init];

    [vc setLabelTo:@"If you ask me, I prefer the White Sox."];
} 
```

我对 Xcode 和 Objective-C 还很陌生，如果你能提供任何帮助，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:09:39.153

您需要从内部调用`-setLabelTo`您已经存在的实例——目前，您正在创建一个新实例并调用该新实例。`ViewController``-[SubViewController touchAction:]``ViewController``-setLabelTo:`

为了调用`-setLabelTo`，`ViewController`我们需要引用那个`ViewController`。

`UIViewController`提供了一个属性`parentViewController`，在理想情况下，它会为您`SubViewController`的`ViewController`. 但是，在这种情况下，它没有提供这样的参考。您将您`SubViewController`的视图添加为您的子视图`ViewController`，但您*没有*将您的视图添加`SubViewController`为您的子视图控制器`ViewController`。（另请参阅[此问题](https://stackoverflow.com/questions/10143903/do-i-have-to-call-addsubview-after-calling-addchildviewcontroller)和[接受的答案](https://stackoverflow.com/a/10146060/1052673)。）要解决此问题，请在`-[ViewController viewDidLoad]`中添加以下行

```
[self addChildViewController:subViewController]; 
```

后

```
SubViewController *subViewController = [[SubViewController alloc] init]; 
```

给你

```
SubViewController *subViewController = [[SubViewController alloc] init];
[self addChildViewController:subViewController];
subViewController.view.backgroundColor = [UIColor clearColor];
[self.view addSubview:subViewController.view]; 
```

此时，您`SubViewController`是的子视图控制器，`ViewController`您`SubViewController`的视图是您的视图的子`ViewController`视图。

此时，您可以将实现更改`-[SubViewController touchAction:]`为

```
- (IBAction)touchAction:(UIButton *) sender
{
    ViewController *vc = self.parentViewController;

    [vc setLabelTo:@"If you ask me, I prefer the White Sox."];
} 
```

这将调用`-setLabelTo:`您的原始`ViewController`实例，而不是创建一个新实例并导致崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:08:24.430

您必须为 subviewcontroller 获取父视图控制器：`self.parentViewController` 您在 subViewController 中的 touchAction 中所做的是创建一个新的 View Controller。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T23:11:18.107

看看这些行：

```
ViewController *vc = [[ViewController alloc] init];
[vc setLabelTo:@"If you ask me, I prefer the White Sox."]; 
```

您正在实例化 ViewController，但未`viewDidLoad`调用。在那里你实例化你想在 using`setLabelTo`方法上设置标题的 UILabel 。

viewDidXXXX 和 viewWillXXXX `Storyboard`在一些 UINavigationController 中使用时会自动调用。

# php - php脚本中的隐藏数据更新

> ID：14205659
> 
> 赞同：0
> 
> 时间：2013-01-07T23:04:06.983
> 
> 标签：php, mysql, sql, date, procedure

我想制作（因为我不能说我已经拥有它..）一个脚本，我必须添加 2 个值“pesel”（类似于 id）和“id_ubezpieczenia”（只是另一个 id），但是更新 3“pesel”、“id_ubezpieczenia”和“日期”。

这是我的示例代码：

```
<?php
error_reporting(E_ALL|E_NOTICE);
$nazwabazydanych = "projekt";

$pesel = mysql_real_escape_string($_POST['pesel']);
$is_ubezpieczenia = mysql_real_escape_string($_POST['is_ubezpieczenia']);  
$data = mysql_real_escape_string($_POST['data']);

if (!$pesel || !$id_ubezpieczenia || !$data)

 {
        print "Nie zostały wypełnione wszystkie pola";
        exit;
 }

if ('pesel' != 11)

{
      print "Zły numer pesel.";
      exit;
}

$db = mysql_pconnect("localhost", "root", "");
if (!$db)  
        {  
        print "Nie można nawiązać połączenia z bazą danych";
        exit;
        }

mysql_select_db("$nazwabazydanych");

$query = mysql_query("CALL skladka ('$pesel','$id_ubezpieczenia','$data')"); 
print "Porwierdzono dodanie do skladek.";

?> 
```

它要求我用 3 个值制作过程 skladka，但我只想让它成为 2 个值，并隐藏 autp 更新日期值。当我说自动更新时，我的意思是我希望字段日期为当前日期。

这个有什么帮助吗？

综上所述：

我想在我的页面上有一个需要添加 2 个字段的站点：“pesel”和“id_ubezpeiczenia”。在我的数据库中，它将更新 3 个字段（“日期”以及当前日期）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:10:12.850

在您的 MySQL 表中添加类型的列

```
TIMESTAMP 
```

并将其选项设置为

CURRENT_TIMESTAMP 更新 CURRENT_TIMESTAMP

例如：

```
CREATE TABLE `table_name` (
  `id` int(11) NOT NULL,
  `created` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

# javascript - JQuery 搜索 DOM

> ID：14205666
> 
> 赞同：1
> 
> 时间：2013-01-07T23:04:50.823
> 
> 标签：javascript, jquery, html

所以，我是 Jquery 的新手，我想知道为什么会这样：

```
$('Button').click(bunz2);

function bunz2(){
    $('body').css({"background-color":"yellow","font-size":"200%"});

   } 
```

这是我在 HTML 中定义的按钮：

```
<button id="myButton" type="button">Click Me!</button> 
```

这有效，但是当我将代码更改为第二个时，它不再有效。：

```
$('myButton').click(bunz2);

function bunz2(){
    $('body').css({"background-color":"yellow","font-size":"200%"});

   } 
```

为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T23:06:15.120

您需要`id`属性选择器`#`：

```
$('#myButton').click(...); 
```

这告诉 jQuery “选择具有唯一 'id' 属性 'myButton' 的元素”。在您的第一个示例中，`$('Button')`告诉 jQuery“选择页面上的*所有*按钮元素”。那是因为，没有前导`#`它是一个更通用的选择器。例如`$('div')`将选择所有`<div>`元素。

干杯

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T23:08:04.583

当你把`$('Button').click(bunz2);`你指的是页面的所有按钮。要专门引用按钮，您应该使用 ID。在 Jquery 你应该把`$.('#myButton').click(`）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T23:09:26.940

`$('button')`所有`button`标签的活动，

如果你必须选择 id 你可以使用：

```
$("#myButton").click(bunz2); 
```

`#`是 ID 符号，`.`是类符号 ...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-07T23:06:02.140

`$('myButton')`查找带有标签 name 的元素`myButton`，而不是 ID `myButton`。改变

```
$('myButton').click(bunz2); 
```

至

```
$('#myButton').click(bunz2); 
```

读：

*   [元素选择器（“元素”）](http://api.jquery.com/element-selector/)
*   [ID 选择器（“#id”）](http://api.jquery.com/id-selector/)

# javascript - HTML5 视频：动态生成的视频标签仅第一次播放

> ID：14205668
> 
> 赞同：4
> 
> 时间：2013-01-07T23:05:00.443
> 
> 标签：javascript, html5-video

我正在使用 JavaScript 从一组给定的“播放列表数据”动态生成视频播放器。这个播放列表数据基本上是一个视频列表（每个视频的源 URL 和标题）。当用户单击锚点以“加载播放列表”时，视频播放器被创建。这是一个带有示例的 jsFiddle：

[http://jsfiddle.net/JFpCD/](http://jsfiddle.net/JFpCD/)

用户第一次点击锚点时，会生成视频播放器并开始播放视频。但是，当您再单击两次锚点（一次关闭，两次重新打开）时，会生成播放器，但**不会**播放视频。

这个问题出现在 Chrome 中。在 Firefox 中，视频再次播放没有任何问题。

我放置`console.log();`在 'loadedmetadata' 事件监听器中。这表明我第二次尝试加载视频时，“加载的元数据”没有被触发。

我尝试使用 Chrome 检查器中的“网络”选项卡进行调试，但是对于视频请求（我第二次尝试打开播放列表），我得到了一些非常奇怪的结果。它**尝试 4**次获取 .mp4 视频文件：

1.  在标题子选项卡下：

    > 请求网址：http://platform.mybusinesscourse.com/videos/finman3e/guidedex_finman3e_01_endmodreview1.mp4

2.  在标题子选项卡下：

    > 请求 URL：http://platform.mybusinesscourse.com/videos/finman3e/guidedex_finman3e_01_endmodreview1.mp4 请求标头查看源 Accept-Encoding:identity;q=1, *;q=0 Range:bytes=0-Referer:http:// fiddle.jshell.net/JFpCD/show/

3.  在标题子选项卡下：

    > 请求网址：http://platform.mybusinesscourse.com/videos/finman3e/guidedex_finman3e_01_endmodreview1.mp4

4.  在标题子选项卡下：

    > 请求 URL：http://platform.mybusinesscourse.com/videos/finman3e/guidedex_finman3e_01_endmodreview1.mp4 请求标头查看源 Accept-Encoding:identity;q=1, *;q=0 Range:bytes=0-Referer:http:// fiddle.jshell.net/JFpCD/show/

对于**所有**4 次尝试，响应子选项卡中**没有响应。**似乎 Chrome 甚至没有完成 GET 请求。

据我所知，Apache 正在正确处理*206 个部分内容*请求，因为我可以在视频正常工作时进行搜索；Chrome 发送 206 Partial Content 请求，服务器做出适当响应。

我什至[启用了登录 Chrome](http://www.chromium.org/for-testers/enable-logging)，但它没有给我任何有用的信息。

**编辑：**

我将此发布到 Chromium 错误跟踪器，并已确认为 Chrome 中的错误： [https ://code.google.com/p/chromium/issues/detail?id=168810](https://code.google.com/p/chromium/issues/detail?id=168810)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-10T22:07:33.580

我能够解决这个问题，我只是忘了回到这里添加它。显然 Chrome 错误是由视频的一些内部缓存问题引起的。解决此问题的方法是将唯一标识符附加到视频的源 URL。这会强制 Chrome 查询 URL，而不是尝试从其内部缓存中检索它。因此，如果您想将新`<source>`标签动态插入到现有的 HTML5`<video>`标签中，请执行以下操作：

```
var html = '';

var mime_type = 'video/ogg';
var src_url = 'http://your-name.com/some-video.ogv';

// Fix for Chrome video / internal caching bug.
src_url += ('?' + (new Date().getTime() / 1000));

html += '<source';

html +=     ' src="' + src_url + '"';
html +=     ' type="' + mime_type + '"';

html +=     ' />';

$('#some-video-tag').html(html); 
```

# ruby-on-rails-3 - 视图的引用 URL - Rails

> ID：14205671
> 
> 赞同：0
> 
> 时间：2013-01-07T23:05:06.173
> 
> 标签：ruby-on-rails-3, redirect, environment-variables, modal-dialog, referrer

我正在尝试获取引荐来源网址，并使用了几种不同的方法。似乎最可靠的一个如下：

```
session[:login_refer] = request.url 
```

但是，它有时会通过捕获模式的 URL 导致错误（我使用的是 twitter 引导程序）。这是一个问题，有人点击了一个模式，然后点击登录，然后被重定向回来......因为链接被破坏（即不能直接进入模式）。

有没有办法确保它只捕获实际页面，而不是模式/动作的 url？

谢谢！

# redis - 在 Windows 上使用 Redis 时 SignalR 节点之间没有通信 - 如何解决？

> ID：14205674
> 
> 赞同：1
> 
> 时间：2013-01-07T23:05:50.660
> 
> 标签：redis, load-balancing, signalr-hub

我将使用 SignalR 和 Redis 设置具有故障转移环境的横向扩展。第一步是确保 Redis 正在处理 SignalR 节点之间的通信（当前问题）。随后将连接 Redis Sentinel 和 BookSleeve，以便 SignalR 节点访问单个 Redis 端点。

在他的文章[Scaling SignalR with Redis](http://blog.mirajavora.com/scaling-signalr-with-redishttp://blog.mirajavora.com/scaling-signalr-with-redis.)中，@mirajavora 解释了如何设置单实例 Redis 环境。

为了测试（即使这最终将驻留在 *nix 机器上），我在 Windows 上设置了 Redis。服务器启动，我将 SignalR 应用程序配置为使用 Redis 消息总线。

我通过在没有运行 Redis 的情况下运行应用程序来验证 SignalR 应用程序正在使用 Redis。我收到一个预期的错误，指示：

> 无法建立连接，因为目标机器主动拒绝它 127.0.0.1:6379

然后我启动 Redis 并回收 SignalR 应用程序池。

使用以下 URL，我验证 SignalR 应用程序正在与 Redis 通信：

> newsfeedlocal1:8082/signalr?transport=longPolling&connectionId=7285d6e5-412c-4bca-9897-5f9ab1ebcece&connectionData=%5B%7B%22name%22%3A%22newsfeedhub%22%7D%5D&messageId=B%2C0%7CF%2C2%7CG%2C0 %7CH%2C0&tid=5&callback=jQuery17204961678246036172_1357588747275&_=1357588762433

Redis状态：

![Redis 接受的连接](../Images/f20711629fdb28d6f8ad8756c3217cbd.png)

到目前为止一切顺利......应用程序按预期运行。

在他的文章结尾处，Mira 在 Global.asax 中有以下行，我在其他文档中没有看到：

> RouteTable.Routes.MapConnection("echo", "echo/{*operation}");

我的 SignalR 项目中没有 DistributedConnection 对象，并且已将其省略（因为我在[GitHub 文档](https://github.com/SignalR/SignalR/wiki/SignalR-with-Redis-Running-on-a-Windows-Azure-Virtual-Machine)中没有看到它。对此行有任何进一步的解释吗？

Mira 的文章建议增加最大工作进程数以进行本地测试。将此设置为 1 以外的任何数字，都会中断节点之间的通信。客户端 1 执行一些操作来通知连接的客户端 2 - 其中窗口 1 在窗口 2 上向客户端 2 发送通知。

我确实看到了多个工作进程，但不知何故我认为这不是一个好的测试场景。我打开了 Fiddler，但不确定要寻找什么来进一步调试此问题。像这样的测试是否真的能正确模拟多个 SignalR 节点？

目前我正在测试这个没有负载平衡器。有推荐的软件负载均衡器吗？

# javascript - 对象性能，长项或多项哪个更好？

> ID：14205680
> 
> 赞同：0
> 
> 时间：2013-01-07T23:06:19.233
> 
> 标签：javascript, performance, events, long-integer

我必须将一些事件记录到一个 json 对象中，那么从性能的角度来看，**长的**还是**许多**子对象更好呢？

为了更好地解释，看看这两个对象：

**第一个**（长物体）

```
var eventsObj = {
  target: {
    timestamp1: window,
    timestamp2: document,
    timestamp3: document
  },
  keyCode: {
    timestamp1: 0,
    timestamp2: 66,
    timestamp3: 67
  },
  mouseX: {
    timestamp1: 1,
    timestamp2: 2,
    timestamp3: 3
  },
  mouseY: {
    timestamp1: 0,
    timestamp2: 1,
    timestamp3: 2
  }
  ...etc...
}; 
```

**第二**（许多对象）

```
var eventsObj = {
  timestamp1: {
    target: window,
    keyCode: 0,
    mouseX: 1,
    mouseY: 0
  },
  timestamp2: {
    target: document,
    keyCode: 66,
    mouseX: 2,
    mouseY: 1
  },
  timestamp3: {
    target: document,
    keyCode: 67,
    mouseX: 3,
    mouseY: 2
  }
  ...etc...
}; 
```

**更新**

[http://jsperf.com/object-performance-long-items-or-many-items](http://jsperf.com/object-performance-long-items-or-many-items)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:12:39.537

在内存消耗方面，两者将（几乎）相同。性能取决于您打算如何迭代和使用对象。

但是，第二种表示形式更具可读性和语义正确性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:22:43.933

我会说第二个，因为在第一种情况下，您可能会得到几个语句，包括一个或多个循环来获取一个事件的数据；而在第二种情况下，只有一个“for...in”循环就足以检索单个事件的数据

# windows-8 - Windows商店应用程序中的LocalSettings变量不持久？

> ID：14205681
> 
> 赞同：0
> 
> 时间：2013-01-07T23:06:19.997
> 
> 标签：windows-8, windows-store-apps

我正在尝试配置一个选项来更改字体大小并创建了一个设置但无法持久。该设置是一个选择控件。字体大小的默认设置来自 default.css，但我想根据用户选择进行覆盖。这是 Windows 8 商店中的 html/js 应用程序。任何工作示例都会很棒。谢谢你。

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Preferences</title>

    <!-- WinJS references -->
    <link href="//Microsoft.WinJS.1.0/css/ui-dark.css" rel="stylesheet" />
    <script src="//Microsoft.WinJS.1.0/js/base.js"></script>
    <script src="//Microsoft.WinJS.1.0/js/ui.js"></script>

    <!-- App references -->
    <link href="/css/default.css" rel="stylesheet" />
    <script src="/js/preferences.js"></script>
</head>
<body>
<div data-win-control="WinJS.UI.SettingsFlyout"
    data-win-options="{settingsCommandId:'preferences', width:'narrow'}">
    <div class="win-ui-dark win-header">
        <button type="button" onclick="WinJS.UI.SettingsFlyout.show()" class="win-backbutton"></button>
        <div class="win-label">Preferences</div>
    </div>
    <div class="win-content ">
        <div class="win-settings-section">
            <label for="fontSize">Font Size:</label>
            <select id="fontSize">
                <option>18px</option>
                <option>24px</option>
                <option>32px</option>
                <option>36px</option>
                <option>42px</option>
                <option>54px</option>
            </select>

        </div>
    </div>
</div>
    </body>
</html> 
```

JS：

```
(function() {
    "use strict";

    var appData = Windows.Storage.ApplicationData.current.localSettings;

    WinJS.UI.Pages.define("/settings/preferences.html", {
        // This function is called whenever a user navigates to this page. It
        // populates the page elements with the app's data.
        ready: function (element, options) {

            // Get DOM Elements
            var fontSize = document.getElementById("fontSize");

            //Wire up event handlers
            fontSize.addEventListener("change", fontSizeLeave);

           function fontSizeLeave() {
                appData.values["fontSize"] = fontSize.value;
            };

            // Get data
            // Set settings to existing values
           if (appData.values.size > 0) {
               fontSize.value = appData.values["fontSize"];

           }

        },

        checkpoint: function () {
            // Save data
            appData.values["fontSize"] = fontSize.value;

        },

        unload: function() {
            // Respond to navigations away from this page.
        },

        updateLayout: function(element, viewState, lastViewState) {
            // Respond to changes in viewState.
        }
    });
})(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T01:22:57.760

根据我对您的代码的测试，数据持久性没有任何问题。

`fontSize.value`即使`appData.values`内容正确，这行代码也会导致 in 中的值为空字符串。

```
fontSize.value = appData.values["fontSize"]; 
```

一个简单的解决方法是为您的每个选项提供值`select`

```
<select id="fontSize">
   <option value="18px">18px</option>
   <option value="24px">24px</option>
   <option value="32px">32px</option>
   <option value="36px">36px</option>
   <option value="42px">42px</option>
   <option value="54px">54px</option>
</select> 
```

# html - 使用 Twitter Bootstrap 模式，我可以在模式打开时锁定背景吗？

> ID：14205684
> 
> 赞同：1
> 
> 时间：2013-01-07T23:06:41.540
> 
> 标签：html, twitter-bootstrap, scroll, modal-dialog

我想在打开模式时使背景不可滚动。设置`data-backdrop="static"`仅使模式在您单击其外部时不会关闭。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T23:11:51.407

您可以尝试将事件处理程序附加到模式的显示和隐藏。当显示模式时，您将页面主体的溢出设置为隐藏。当模态隐藏时，您可以使溢出可见。

```
$('#myModal').on('shown', function () {
  $("body").css("overflow", "hidden");
});

$('#myModal').on('hidden', function () {
  $("body").css("overflow", "visible");
}); 
```

文档：

[https://developer.mozilla.org/en-US/docs/CSS/overflow](https://developer.mozilla.org/en-US/docs/CSS/overflow)

[http://twitter.github.com/bootstrap/javascript.html#modals](http://twitter.github.com/bootstrap/javascript.html#modals)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-07T15:03:14.210

```
// save the original function object
var _superModal = $.fn.modal;

// add locked as a new option
$.extend( _superModal.Constructor.DEFAULTS, {
    locked: false
});

// capture the original hide
var _hide = _superModal.Constructor.prototype.hide;
// console.log('HIDE:', _hide);

// add the lock, unlock and override the hide of modal
$.extend(_superModal.Constructor.prototype, {
    // locks the dialog so that it cannot be hidden
    lock: function() {
        // console.log('lock called');
        // console.log('OPTIONS',this.options);
        this.options.locked = true;
    }
    // unlocks the dialog so that it can be hidden by 'esc' or clicking on the backdrop (if not static)
    ,unlock: function() {
        // console.log('unlock called');
        this.options.locked = false;
    }
    // override the original hide so that the original is only called if the modal is unlocked
    ,hide: function() {
        // console.log('hide called');
        if (this.options.locked) return;

        _hide.apply(this, arguments);
    }
});

$('#mymodal').modal()
$('#mymodal').modal('lock') 
```

[参考](https://stackoverflow.com/questions/13421750/twitter-bootstrap-jquery-how-to-temporarily-prevent-the-modal-from-being-clo)

# iphone - 使用 AFNetworking 的 enqueueBatchOfHTTPRequestOperations 失败时如何重新添加操作

> ID：14205687
> 
> 赞同：1
> 
> 时间：2013-01-07T23:06:53.470
> 
> 标签：iphone, ios, ipad, afnetworking

我有一种方法可以使用 AFNetworking 调用 enqueueBatchOfHTTPRequestOperations 将文件列表从 Web 服务器下载到 iPad。每隔一段时间我就会遇到一次失败的操作（通常是当文件较大时）。从历史上看，我单独下载每个文件，然后简单地再次调用该操作，直到达到一定的重试次数。

我已重构代码以使用 enqueueBatchOfHTTPRequestOperations。这很好用，但我不知道如何获取有关“特定”操作失败的通知，并且如果它们失败了，我不知道如何将它们重新添加到队列中。

这是我用来下载“n”个文件的代码：

```
 NSMutableArray *operationsArray = [[NSMutableArray alloc]init];
for (MINPageDefinition *currPage in [[MINPageStore sharedInstance] pageArray])
{
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSString *serverLibraryURL = [defaults objectForKey:kRootURL];
    serverLibraryURL = [serverLibraryURL stringByAppendingPathComponent:kPageDefinitionsDirectory];
    serverLibraryURL = [serverLibraryURL stringByAppendingPathComponent:currPage.pageImageName];

    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:serverLibraryURL]];
    AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];
    operation.outputStream = [NSOutputStream outputStreamToFileAtPath:currPage.pageImageURL append:NO];

    [operationsArray addObject:operation];
}
if ([operationsArray count] > 0)
{
    AFHTTPClient *client = [[AFHTTPClient alloc] initWithBaseURL:[NSURL URLWithString:@""]];
    void (^progressBlock)(NSUInteger numberOfCompletedOperations, NSUInteger totalNumberOfOperations) = ^(NSUInteger numberOfCompletedOperations, NSUInteger totalNumberOfOperations) {
        NSLog(@"%d proccesses completed out of %d", numberOfCompletedOperations, totalNumberOfOperations);
    };
    void (^completionBlock)(NSArray *operations) = ^(NSArray *operations) {
        NSLog(@"All operations completed");
    };
    [client enqueueBatchOfHTTPRequestOperations:operationsArray
                                  progressBlock:progressBlock
                                completionBlock:completionBlock];
} 
```

之前，我有一个执行操作的方法。失败时，失败块将递归调用自身。如果操作失败，如何修改此代码以重试“n”次？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-15T13:17:14.133

检查下面的代码@justLearningAgain

```
[[WfServices sharedClient] GET:kGetAddress parameters:dicParam  success:^(AFHTTPRequestOperation *operation, id responseObject) {
        NSLog(@"RESPONSE ::: %@",responseObject);
  }failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    }];

+ (WfServices *)sharedClient
{
    static WfServices * _sharedClient = nil;
    static dispatch_once_t onceToken;

    dispatch_once(&onceToken, ^{
        _sharedClient = [[WfServices alloc] initWithBaseURL:[NSURL URLWithString:kWFBaseURLString]];
    });

    return _sharedClient;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-16T10:39:49.570

我认为[AFNetworking 自动重试](https://github.com/shaioz/AFNetworking-AutoRetry)可能会有所帮助。

或者您可以在 AFHTTPClient 中覆盖以下方法。

考虑 resumeTasksArray = 您需要重新添加到队列中的操作数组。

```
NSMutableArray *resumeTasksArray; before @implementation AFHTTPClient 

- (AFHTTPRequestOperation *)HTTPRequestOperationWithRequest:(NSURLRequest *)request
                                                success:(void (^)(AFHTTPRequestOperation *operation, id responseObject))success
                                                failure:(void (^)(AFHTTPRequestOperation *operation, NSError *error))failure {

void(^authFailBlock)(AFHTTPRequestOperation *opr, NSError *err) = ^(AFHTTPRequestOperation *opr, NSError *err){
    [resumeTasksArray addObject:request];
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0), ^{
        //now, queue up and execute the original task
        for (NSURLRequest *previousRequest in resumeTasksArray) {
            NSLog(@"^^^^^^^^^^^^^^^^^^^^^^^^^^^^Resume Task URL - %@", previousRequest.URL);
            NSMutableURLRequest *newRequest = [previousRequest mutableCopy];
            [newRequest setValue:[NSString stringWithFormat:@"Bearer %@", AppSingleton.access_token] forHTTPHeaderField:@"Authorization"];
            AFHTTPRequestOperation *opera10n = [[AFHTTPRequestOperation alloc]initWithRequest:newRequest];
            opera10n.responseSerializer = self.responseSerializer;
            [opera10n setCompletionBlockWithSuccess:success failure:failure];
            if (![[self.operationQueue operations] containsObject:opera10n]) {
                [[self operationQueue] addOperation:opera10n];
                [opera10n start];
            }
        }
        [resumeTasksArray removeAllObjects];
    });
};
AFHTTPRequestOperation *operation = [super HTTPRequestOperationWithRequest:request success:success failure:authFailBlock];
return operation;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T17:02:13.143

您不能像这样将单个失败的操作再次排入该操作的失败块中吗？

```
[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {

} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
     [[APIClient sharedClient] enqueueHTTPRequestOperation:operation];
}]; 
```

`[APIClient sharedClient]`对您的子类的引用在哪里`AFHTTPClient`（单例与否）。

# jquery - jquery：单击时，突出显示该行

> ID：14205688
> 
> 赞同：1
> 
> 时间：2013-01-07T23:06:58.723
> 
> 标签：jquery, ruby-on-rails

我用`best_in_place`.

我尝试突出显示该行的复选框被选中的行。但它不起作用。

`application.js`：

```
$(document).ready(function() {
   jQuery(".best_in_place").best_in_place();
});

$('.highlight_on_success').bind("ajax:success", function(){
   $(this).closest('tr').effect('highlight'));
}); 
```

这是我的`index.html.erb`：

```
<html>
<body>
<h1>TODO TASKS</h1>

<table>
  <tr>
    <th>Done</th>
    <th>Admin Email</th>
    <th>Task</th>
    <th>Done</th>
  </tr>

<% @tasks_worker_todo.each do |task| %>
  <tr>
    <td = "done_id"> <%= best_in_place task, :done,:classes => 'highlight_on_success', type:     :checkbox, collection: %w[No Yes] %></td>
    <td><%= task.admin_mail %></td>
    <td><%= task.task %></td>
    <td><%= task.done %></td>
  </tr>
<% end %>
</table>

<br><br>
<br><br>

<h1>DONE TASKS</h1>
<table>
  <tr>
    <th>Done</th>
    <th>Admin Email</th>
    <th>Task</th>
    <th>Done</th>
  </tr>

<% @tasks_worker_done.each do |task| %>
  <tr>
    <td> <%= best_in_place task, :done, type: :checkbox, collection: %w[No Yes]%></td>
    <td><%= task.admin_mail %></td>
    <td><%= task.task %></td>
    <td><%= task.done %></td>
  </tr>
<% end %>
</table>

<br />
</body>
</html> 
```

请帮忙！

**更新：**

我尝试了下一行，但没有光：/

```
$('.highlight_on_success').bind($("#done_id")).click(function(){ 
    $(this).closest('tr').effect('highlight'));‌​
}); 
```

这就是我的 html 的样子：

![在此处输入图像描述](../Images/cc715db2281191783b05e4da6e9bcd1f.png)

复选框位于绿线上方（从“是”更改为“否”）。

（与红线上方的列无关）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:52:35.057

我在过去的几个小时里一直在努力，并让它发挥作用，partialy ;)

尝试将此（咖啡脚本）放入您的文件中，例如`tasks.js.coffe`：

```
jQuery ->
  $('.best_in_place').best_in_place()

$(".highlight_on_success").bind "ajax:success", ->
  $(this).effect "highlight",
    color: "red",
    1000 
```

我说偏了，因为没有`closest("tr")`电话，我认为这不是致命的。

我研究了`ajax:success`，它用于 best_in_place 的每个输入和控制（包括复选框）。

这是我的`show.html.haml`：

```
%tr
  %td
    = best_in_place @product, :task, :type => :checkbox, :collection => ["Yes", "NOpe"], :classes => 'highlight_on_success' 
```

如您所见，`id`避免了定义 ，gem 有自己的命名输入约定，因此无法更改`id`复选框的 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T23:16:28.843

尝试这个 ：

```
$('.highlight_on_success').on('click',function(){ 
    $(this).closest('tr').effect('highlight');‌​
}); 
```

# ios - 企业 iOS 应用程序分发 - 应用程序安装 URL 中哪些字符是合法的？

> ID：14205690
> 
> 赞同：2
> 
> 时间：2013-01-07T23:07:07.240
> 
> 标签：ios, software-distribution, ota

我一直在试验“应用程序 URL：”字段中的哪些字符可以防止在从清单链接部署企业应用程序时触发 OTA 安装。

我正在尝试自动生成路径，但我们通常会在文件名中包含特殊字符，并且似乎 URL 中的某些字符只是阻止清单触发安装。

例如，如果您有一个空格字符，则无法使用 %20 将其转义并将 %20 放​​入应用程序 URL。如果这样做了，则不会引发任何错误，并且 itms-services://?action=download-manifest&url= 操作会在没有消息的情况下失败。

例如，如果应用程序的 pList 所在的应用程序 URL 是：http: [//mydomain.com/my-app.ipa](http://mydomain.com/my-app.ipa)

清单文件的安装链接为：itms-services://?action=download-manifest&url=http://mydomain.com/my-app.plist

在 my-app.pList 中，会有这个条目：url [http://mydomain.com/my-app.ipa](http://mydomain.com/my-app.ipa)

但是，如果将 - 替换为空格，则不能在应用程序 URL 中使用空格字符或转义的 %20，即使您使用 ipa 和 pList 的“应用程序 URL：”中的内容创建 ipa。

1.  有没有已知的解决方法？
2.  是否有在 URL 中使用时会破坏 OTA 安装的已知字符列表？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T15:42:53.337

[正如我在这里](https://stackoverflow.com/questions/4695180/wireless-iphone-app-distribution-problem-with-itms-services-protocol/15434553#15434553)回答的那样，最简单的解决方案是**用“+”（加号）替换空格，**因为 ...url=... 表示它是查询字符串参数，在为 URL 编码时，它们应编码为表单数据参数。

从这里[W3.org - HTML 文档中的表单](https://stackoverflow.com/questions/4695180/wireless-iphone-app-distribution-problem-with-itms-services-protocol/15434553#15434553)：

> “控制名称和值被转义。空格字符被 '+' 替换，然后保留字符被转义，如 [RFC1738] 中所述”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-01T01:08:39.013

当我在我的 plist 文件中使用 %20 并在我的 itms-services 链接中使用 %2520 时，它对我有用。[tc这里](https://stackoverflow.com/questions/4695180/wireless-iphone-app-distribution-problem-with-itms-services-protocol)的答案提到了 itms-services 链接的“双重转义”技巧。

# c# - Windows 服务和 Web 服务之间的 IPC

> ID：14205691
> 
> 赞同：0
> 
> 时间：2013-01-07T23:07:09.410
> 
> 标签：c#, web-services, service, windows-services, ipc

在 Windows 服务和 Web 服务之间设置进程间通信的最佳/最简单方法是什么？Windows 服务将在托管 Web 服务的同一台机器上运行。

web服务会调用windows服务来获取一些信息吗？

我知道它可以使用命名管道、Sharedmemory、WCF 等。但我正在寻找不会增加安全性方面复杂性的东西。

# php - 在 PHP 中从 phpmyadmin 订购商品

> ID：14205696
> 
> 赞同：0
> 
> 时间：2013-01-07T23:07:33.430
> 
> 标签：php, sorting, content-management-system, phpmyadmin

我正在尝试用 PHP 做一个简单的 CMS。在滑块管理中，我想更改添加照片的顺序。

```
<a href="slideup.php?order=<?php echo $result['order']; ?>&id=<?php echo $result['id']; ?>" title="Up"><img src="../images/up.png" alt="Up" /></a>
<a href="slidedown.php?order=<?php echo $result['order']; ?>&id=<?php echo $result['id']; ?>" title="Down"><img src="../images/down.png" alt="Down" /></a> 
```

它正在发送相关的 php 页面、当前顺序和幻灯片 ID。

**幻灯片.php**

```
<?php

    include('includes/functions.php');

    $order=$_REQUEST['order'];
    $id=$_REQUEST['id'];

    goUp($order, $id);

?> 
```

**滑下.php**

```
<?php

    include('includes/functions.php');

    $order=$_REQUEST['order'];
    $id=$_REQUEST['id'];

    goDown($order, $id);

?> 
```

**函数.php**

```
function goUp($order, $id)
    {
        $db = new DB_CONNECT();
        if(!$order == 1)
        {
            $neworder = $order - 1;
            mysql_query("UPDATE `slider` SET `order`='$order' WHERE `order`='$neworder'") or die(mysql_error());
            mysql_query("UPDATE `slider` SET `order`='$neworder' WHERE `id`='$id'") or die(mysql_error());
        }       

        header('Location: ../admin/slider.php');
    }

function goDown($order, $id)
    {
        $db = new DB_CONNECT();

        $totalslide = 0;
        $query = mysql_query("SELECT COUNT(`id`) as count FROM `slider`") or die(mysql_error());
        $result = mysql_fetch_array($query);
        $totalslide = $result['count'];

        if(!$order == $totalslide)
        {
            $neworder = $order + 1;
            mysql_query("UPDATE `slider` SET `order`='$order' WHERE `order`='$neworder'") or die(mysql_error());
            mysql_query("UPDATE `slider` SET `order`='$neworder' WHERE `id`='$id'") or die(mysql_error());
        }       

        header('Location: ../admin/slider.php');
    } 
```

当我单击图标时，代码可以正常工作。但结果，什么也没有发生。我的代码有问题还是逻辑错误？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:30:00.940

在你的 mysql_query() 之后放这个，因为我相信你有一个 mysql 错误：

```
echo mysql_error(); 
```

让我们知道它说了什么。编写查询时，如果字段是 varchar、日期等，则应该只用单引号将值括起来，而不是数字等。我猜你的 ID 是一个数字，而且你的 ORDER 似乎也是一个数字，所以在你的更新中你应该有这样的东西：

```
mysql_query("UPDATE `slider` SET `order`=$neworder WHERE `id`=$id") or die(mysql_error()); 
```

这至少应该让你开始，尽管你可能有逻辑问题，因为我真的不明白为什么你要更新滑块表中的每一行，将旧顺序更改为新顺序，而不管 ID 是什么。

# ios6 - pushViewController 后视图不显示

> ID：14205700
> 
> 赞同：0
> 
> 时间：2013-01-07T23:07:48.103
> 
> 标签：ios6, uinavigationcontroller, pushviewcontroller, uistoryboardsegue

我的故事板具有以下布局

> ```
>  MyView1ViewController (root controller)
>                                         / 
> ```
> 
> ContainerView --> MyNavigationController ---------
> 
> ```
>  \
>                                         MyView2ViewController 
> ```

容器视图嵌入了一个 UINavigationController，它具有 MyView1ViewController 作为根视图控制器。我从 UINavigationController 创建了到 MyView2ViewController 的手动推送序列。

根据用户输入，显示 View1 或 View2。在此示例中，按钮只是在两个控制器之间切换。如果显示 View1（根控制器），则推送 View2 控制器。控制器被推入堆栈，但 View2 永远不会显示。下面列出的代码显示了我是如何实现的：

```
- (void)transitionToView:(int)type {

if (self.v2Controller == nil) {
    self.v2Controller = (MyView2ViewController *)[self.storyboard instantiateViewControllerWithIdentifier:@"View2"];
}

NSLog(@"top=%@", self.topViewController);
NSLog(@"visible=%@", self.visibleViewController);
for (id cntrllr in self.viewControllers) {
    NSLog(@"children=%@", cntrllr);
}

switch (type) {
    case 2:
        **[self pushViewController:self.v2Controller animated:YES];**
        break;

    case 1:
        [self popToRootViewControllerAnimated:YES];
        break;

    default:
        [self popToRootViewControllerAnimated:YES];
        break;
}
for (id cntrllr in self.viewControllers) {
    NSLog(@"after children=%@", cntrllr);
}
NSLog(@"after visible=%@", self.visibleViewController); 
```

}

以下是我在模拟器中运行并运行此代码时的日志消息：

顶部 = MyView1ViewController：0x7425f80

可见=MyView1ViewController：0x7425f80

儿童=MyView1ViewController：0x7425f80

在 children=MyView1ViewController: 0x7425f80 之后

在 children=MyView2ViewController: 0x10a142c0 之后

可见后=MyView2ViewController: 0x10a142c0

我的解释是我将 View2 控制器推送到导航堆栈上，它**应该**是可见的控制器，但 View2 没有被显示。

我看过类似标题的问题，但似乎没有任何东西适用于我的情况。我的配置有问题吗？我在 IB 中缺少什么吗？我是否应该期望控制器仅通过推送来显示其视图？任何建议表示赞赏。

# javascript - Highcharts - 以编程方式“翻转”（反向）Y轴

> ID：14205701
> 
> 赞同：2
> 
> 时间：2013-01-07T23:07:54.353
> 
> 标签：javascript, html, highcharts

全部，

我在我正在开发的网络应用程序中使用 Highcharts。要求之一是用户应该能够单击按钮并“翻转”或反转 Y 轴。

换句话说 - 当用户单击按钮时 - y 轴值应该从以下位置翻转：

```
highest at the top / lowest at the bottom 
```

到

```
lowest at the top / highest at the bottom 
```

当您第一次创建图表时 - 这可以使用 y 轴的“反转”属性：

[http://api.highcharts.com/highcharts#yAxis.reversed](http://api.highcharts.com/highcharts#yAxis.reversed)

这里的例子：http: [//jsfiddle.net/ZgVNS/](http://jsfiddle.net/ZgVNS/)

但是 - 如果我尝试使用选项对象（例如，单击按钮）通过 JavaScript 以编程方式执行此操作，它似乎不起作用：

```
chart.options.yAxis.reversed = !chart.options.yAxis.reversed;
chart.redraw(); 
```

这是我设置来测试的 jsfiddle：http: [//jsfiddle.net/4JZxS/6/](http://jsfiddle.net/4JZxS/6/)

这可能吗？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-01-14T10:09:20.407

您可以使用 Axis.update() 方法：

```
$(function () {
    var chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container'
        },
        xAxis: {
            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
        },
        yAxis: {
            reversed: false
        },
        series: [{
            data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4]
        }]
   });

   var reversed = chart.options.yAxis.reversed;

   // the button action
   $('#button').click(function () {

       chart.yAxis[0].update({
           reversed: !reversed
       });  

       reversed = !reversed;
   });
}); 
```

这是更新的 JSFiddle：http: [//jsfiddle.net/4JZxS/15/](http://jsfiddle.net/4JZxS/15/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T00:15:05.377

我不认为这是可能的。

我的建议是销毁图表`chart.destroy()`并使用 reversed 属性创建新图表，就像在这个[小提琴中一样](http://jsfiddle.net/4JZxS/8/)

# php - 将图像上的点击次数与数据库中记录的点击次数进行比较

> ID：14205707
> 
> 赞同：1
> 
> 时间：2013-01-07T23:08:13.867
> 
> 标签：php, javascript

我正在为自己开发一个非常简单的登录系统，不打算在线发布。我的场景：在注册期间，用户选择他的用户名并插入所需的点击次数进行登录，它将存储在数据库中。在登录期间，用户将首先输入他的用户名，然后用户将被重定向到一个页面，用户将在该页面上单击具有 onclick 功能的图像以计算点击次数。

问题：如何从 login.php 中获取“点击次数”，然后与 checkclick.php 中记录的点击次数进行比较？我已经尽力找到自己的想法来做这几天了。然而，我失败了。老实说，我编程很慢而且很弱，所以我希望我能在这里得到一些帮助。我的朋友确实建议我使用 AJAX，但是看完教程后，我真的不明白。有人可以帮忙吗？我会很感激。

非常感谢您阅读并帮助解决我的问题。

```
login.php    

<?php
include("connection.php");
$username = $_SESSION["CID"];
$table1=mysql_query("select * from pic_a");
$table2=mysql_query("select * from pic_b");
$table3=mysql_query("select * from pic_c");

$tab1[0]=0;
$tab2[0]=0;
$tab3[0]=0;

$i=0;
while($row=mysql_fetch_assoc($table1))
{
    $tab1[$i]= $row["pic_link"];
    $i++;
}

$i=0;
while($row=mysql_fetch_assoc($table2))
{
    $tab2[$i]= $row["pic_link"];
    $i++;
}

$i=0;
while($row=mysql_fetch_assoc($table3))
{
    $tab3[$i]= $row["pic_link"];
    $i++;
}

$rand1=rand(0,9);
$rand2=rand(0,9);
$rand3=rand(0,9);

?>
<script type="text/javascript">
var count = 0;
function countClicks() {
count = count + 1;
document.getElementById("clicks").innerHTML = count;
}
</script>

<body>
<h1>login</h1>

    <form action = "" name = "allpass" method = "post" enctype = "multipart/form-data">

        <p style="font-size:20px">Username: <?php echo $username;?> </p>
        <p style="font-size:20px">Password:</p>
    <p><table border = 0>

    <td>
        <div STYLE=" height: 800px; width: 165px; font-size: 12px;">
    <table border="1">
         <tr id="bird" onclick="countClicks();">
            <td><img src="password\<?php echo $tab1[$rand1]; ?>" alt="" width="76" height="67"></td>
            <td>Bird</td>
         </tr>
         <tr id="car" onclick="countClicks();">
            <td><img src="password\<?php echo $tab2[$rand2]; ?>" alt="" width="76" height="67"></td>
            <td>Car</td>
         </tr>
         <tr id="computer" onclick="countClicks();">
            <td><img src="password\<?php echo $tab3[$rand3]; ?>" alt="" width="76" height="67"></td>
        </table>
        </div>
        </td>
        </table>
        <p id="clicks">0</p>
        <input type = "submit" style=" height: 25px; width: 75px" value = "Login" name = "submitbtn" />
</form></p>
</div>

</body>
</html>

checkclicks.php
<?php
    include("connection.php");

if(!isset($_GET["username"]) || !isset($_GET["clicks"]))
die("Error");
    $username = $_GET["username"];
    $jsClicks = $_GET["clicks"];
    $phpClicks = null;

$data = mysql_query("SELECT clicks FROM customerdetails WHERE customer_username='$username'");
while($row = mysql_fetch_array($data))
{
$phpClicks = $row["clicks"];
}
    if( $phpClicks == $clicks)
    {
    ?>
    <script type="text/javascript">
        alert("success");
        location = "welcome.php";
    </script>
<?php
} else {
?>
    <script type="text/javascript">
        alert("fail");
        location = "login.php";
    </script>

<?php
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T20:21:36.790

一种解决方案是使用 JQuery 使用[$post](http://api.jquery.com/jQuery.post/)将数据发布到数据库下面的代码将数据发布到 PHP 文件到 INSERT name & count

```
$(document).ready(function(){
   number = 0; 
   $("#count").click(function(){//id of image 
   ++number;
   $('#counter').val(number);
   });

  $("#submit").click(function(){
    name= $("input").val();//id of text field for name
    $.post("ClickInsert.php",
    {
      name:name,
      ClickCount:number
    },
    function(data,status){
      alert("Insert status: " + status);
    });
  });
}); 
```

不要使用`mysql_`已弃用的函数，而是使用 [**PDO**](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)下面的代码是新用户的 INSERT。

```
<?php
//dependant on your setup
$host= "localhost";
$username="XXX";
$password="YYY";
$database="ZZZ";
// connect to the database  
$name = $_POST["name"];
$ClickCount = $_POST["ClickCount"];

try {  

    $dbh = new PDO("mysql:host=$host;dbname=$database", $username, $password);  
    $dbh->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION );  
    //
    $stmt = $dbh->prepare("INSERT INTO `tablename` (`id`, `Name`, `ClickCount`) VALUES (NULL, ?, ?);");  
    $stmt->bindParam(1,$name);
    $stmt->bindParam(2,$ClickCount);
    $stmt->execute(); 
    echo "Welcome ". $name;
  }   
catch(PDOException $e) {  
    echo "Error .". $e->getMessage() ;// Remove or modify after testing 
    file_put_contents('PDOErrors.txt',date('[Y-m-d H:i:s]'). $e->getMessage()."\r\n", FILE_APPEND);  
}  
// close the connection
$dbh = null;
?> 
```

代码可以更改为 SELECT 用户

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:17:04.533

我认为最简单的解决方案是设置一个等于您从数据库导入的 php 变量的 java 变量。例如：

```
function countClicks() {
var myclicks = <?php echo $value_from_database; ?>;
count = count + 1;
if(count >= myclicks){
window.location = "success.html";
}} 
```

# php - 为什么这个查询不起作用？

> ID：14205710
> 
> 赞同：0
> 
> 时间：2013-01-07T23:08:36.600
> 
> 标签：php, zend-framework, doctrine

我在 Zend Framework 中的 Doctrine 查询遇到问题。构建查询的代码附在下面。

```
 $qb = $this->createQueryBuilder("m");
    $qb->select("partial m.{_follow,_contacts}");
    //$qb->from("Key\Members\Domain\AbstractMember as m");

    $first = true;
    $types = array();
    for($i = 0; $i < count($networkIds); $i++){
        if($first){
            $first = false;
            $qb->where("m._id = ?".$i);
        } else{
            $qb->orWhere("m._id = ?".$i);
        }
        $qb->setParameter($i, $networkIds[$i], 'binary');
    }

    $this->_logger->log('query:'.$qb->getDQL(), Zend_Log::DEBUG);
    $result = $this->_em->createQuery($qb->getDQL())->getResult(); 
```

据我所知，DQL 看起来不错：

```
SELECT partial m.{_follow,_contacts} FROM Key\Members\Domain\Member m WHERE (m._id = ?0) OR (m._id = ?1) OR (m._id = ?2) 
```

数组如下`$networkIds`所示：

```
array(3) { [0]=> string(32) "01915617be6f4723b0ed61d6cb30fa5a" [1]=> string(32) "083f375e256244a9accaa176f814333e" [2]=> string(32) "3e43cbafa4174a9fa8197f1c85af812a" } 
```

日志中的异常：

```
2013-01-07T20:47:28+00:00 ErrorController::errorAction() ERR (3): Controller error occured in for URI "/marketing/reach" in module "portlets", controller "member", action "onecolumn". Exception message was: Invalid parameter format, ? given, but :<name> or ?<num> expected.. Backtrace: #0 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/AST/InputParameter.php(46): Doctrine\ORM\Query\QueryException::invalidParameterFormat('?')
#1 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(2116): Doctrine\ORM\Query\AST\InputParameter->__construct('?')
#2 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(2253): Doctrine\ORM\Query\Parser->InputParameter()
#3 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(2211): Doctrine\ORM\Query\Parser->ArithmeticPrimary()
#4 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(2179): Doctrine\ORM\Query\Parser->ArithmeticFactor()
#5 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(2153): Doctrine\ORM\Query\Parser->ArithmeticTerm()
#6 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(2140): Doctrine\ORM\Query\Parser->SimpleArithmeticExpression()
#7 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(2469): Doctrine\ORM\Query\Parser->ArithmeticExpression()
#8 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(2003): Doctrine\ORM\Query\Parser->ComparisonExpression()
#9 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(1926): Doctrine\ORM\Query\Parser->SimpleConditionalExpression()
#10 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(1885): Doctrine\ORM\Query\Parser->ConditionalPrimary()
#11 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(1855): Doctrine\ORM\Query\Parser->ConditionalFactor()
#12 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(1831): Doctrine\ORM\Query\Parser->ConditionalTerm()
#13 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(1922): Doctrine\ORM\Query\Parser->ConditionalExpression()
#14 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(1885): Doctrine\ORM\Query\Parser->ConditionalPrimary()
#15 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(1855): Doctrine\ORM\Query\Parser->ConditionalFactor()
#16 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(1831): Doctrine\ORM\Query\Parser->ConditionalTerm()
#17 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(1211): Doctrine\ORM\Query\Parser->ConditionalExpression()
#18 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(766): Doctrine\ORM\Query\Parser->WhereClause()
#19 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(735): Doctrine\ORM\Query\Parser->SelectStatement()
#20 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(207): Doctrine\ORM\Query\Parser->QueryLanguage()
#21 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query/Parser.php(278): Doctrine\ORM\Query\Parser->getAST()
#22 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query.php(203): Doctrine\ORM\Query\Parser->parse()
#23 /srv/www/www.cookies.com/current/library/Doctrine/ORM/Query.php(223): Doctrine\ORM\Query->_parse()
#24 /srv/www/www.cookies.com/current/library/Doctrine/ORM/AbstractQuery.php(543): Doctrine\ORM\Query->_doExecute()
#25 /srv/www/www.cookies.com/current/library/Doctrine/ORM/AbstractQuery.php(366): Doctrine\ORM\AbstractQuery->execute(Array, 1)
#26 /srv/www/www.cookies.com/current/library/Key/Members/Repositories/MemberRepository.php(1281): Doctrine\ORM\AbstractQuery->getResult()
#27 /srv/www/www.cookies.com/current/application/modules/marketing/controllers/ReachController.php(53): Key\Members\Repositories\MemberRepository->fetchAllNetworkIds(Array)
#28 /srv/www/www.cookies.com/current/library/Zend/Controller/Action.php(513): Marketing_ReachController->indexAction()
#29 /srv/www/www.cookies.com/current/library/Jarlssen/Rest/Controller.php(59): Zend_Controller_Action->dispatch('indexAction')
#30 /srv/www/www.cookies.com/current/library/Key/Common/Controller/ActionController.php(232): Jarlssen_Rest_Controller->dispatch('indexAction')
#31 /srv/www/www.cookies.com/current/library/Zend/Controller/Dispatcher/Standard.php(295): Key\Common\Controller\ActionController->dispatch('indexAction')
#32 /srv/www/www.cookies.com/current/library/Zend/Controller/Front.php(954): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))
#33 /srv/www/www.cookies.com/current/library/Zend/Application/Bootstrap/Bootstrap.php(97): Zend_Controller_Front->dispatch()
#34 /srv/www/www.cookies.com/current/library/Zend/Application.php(366): Zend_Application_Bootstrap_Bootstrap->run()
#35 /srv/www/www.cookies.com/current/public/index.php(71): Zend_Application->run()
#36 {main} 
```

我认为问题出在`setParameter()`电话的某个地方，但我不知道它有什么问题。我也试过不带`binary`参数，也试过了`setParameters()`。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T03:32:05.223

这里的问题是 `$qb->where("m._id = ?".$i);`你`.`必须使用`,`.

所以这条线将与

```
 $qb->where("m._id = ?",$i);

  $qb->orWhere("m._id = ?",$i); 
```

# android - 系统/应用程序中的 adb start(run) .apk

> ID：14205712
> 
> 赞同：3
> 
> 时间：2013-01-07T23:08:52.947
> 
> 标签：android, adb

我需要一种方法来启动我从 adb 放入我的系统/应用程序的根设备上的 apk。（带壳或带壳都可以）

.apk 使用 adb 推送到设备上。

如果安装正常，我已经找到了执行此操作的方法，但这不是我需要的，因为出于许可原因，此应用程序需要位于系统/应用程序中。

有人可以帮助或指出正确的方向吗谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T00:21:00.447

推送到系统后，请务必设置权限，然后重新启动设备并像任何其他应用程序一样从 adb 启动。

重新启动系统应用程序将被“安装”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-12T09:30:01.363

使用以下命令：

```
adb remount
adb push apkfilename /system/app
adb reboot 
```

这将使该 apk 文件成为系统应用程序。

# android - Android 2.3 上的 webkit 渲染问题 - 一些列表视图元素的边界模糊

> ID：14205714
> 
> 赞同：0
> 
> 时间：2013-01-07T23:09:11.263
> 
> 标签：android, css, kendo-ui

我不确定这是姜饼中的 webkit 渲染错误，还是我用来构建网站的框架（Kendo UI Mobile）的问题......

我在列表视图中有多个列表项。有一个 2px 的边框将每个项目彼此分开。

奇怪的是，每一个偶数的边界都是模糊的，而每一个奇数的边界却是清晰的。当我滚动页面时，问题将在边界之间来回切换（偶数边界清晰，奇数边界模糊。滚动。偶数边界模糊，奇数边界清晰）。

有谁知道这是一个渲染问题，是在 android 的 2.3+ 默认浏览器使用的实际 webkit 核心中，还是可能是通过 Kendo UI Mobile 应用的 css？

我确实注意到剑道列表项目，`-webkit-translatez(0)`正在应用一条规则..但我不知道这是否相关。

任何帮助将不胜感激。我可以忍受它，但这很烦人，所有 < 2.3 的 android 版本都能正确渲染边框。

我正在使用最新的 JQuery 和 Kendo UI Mobile 主要版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T09:38:54.090

这是最新版本中的一个更改，以避免由于 Android 错误而在以前的版本中有时发生的丢失边框。现在边界是用盒子阴影完成的，但在 Android 2.3 中，没有模糊的盒子阴影根本不会渲染（另一个 Android 错误），因此我们用模糊来做它们，因此你看到了什么。

# javascript - 道场日历：有没有办法设置我自己的假期？

> ID：14205715
> 
> 赞同：1
> 
> 时间：2013-01-07T23:09:12.540
> 
> 标签：javascript, dojo, calendar

我想将自己的假期编程到 dojox 日历小部件中。目前它只以不同的颜色显示周末等。我也想在特殊的当地假期这样做，但我看不出有什么办法。

我可以将假期安排为全天活动，但我希望有更优雅的东西。有没有什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T09:25:33.607

这可以通过子类化视图并覆​​盖 SimpleColumnView.styleGridColumn MatrixView.styleGridCell 方法（您有一个使用子类视图的示例：http: [//livedocs.dojotoolkit.org/dojox/calendar#view-management](http://livedocs.dojotoolkit.org/dojox/calendar#view-management)）。

由于这不是微不足道的，在 Dojo 1.9（目前处于 Beta 版）中，网格单元的自定义样式得到了改进（没有覆盖），请参见带有示例的文档：http: [//livedocs.dojotoolkit.org/dojox/calendar#grid -单元格样式](http://livedocs.dojotoolkit.org/dojox/calendar#grid-cell-styling)

希望这可以帮助，

达米安

# c# - 将 C# 文本框属性保存到 SQL

> ID：14205716
> 
> 赞同：2
> 
> 时间：2013-01-07T23:09:12.243
> 
> 标签：c#, sql

在我的 C# Web 应用程序中，我有一个简单的页面，用户在一个文本框中输入他们的名字（命名`txtFirst`），在另一个文本框中输入他们的姓（命名`txtLast`）。在两个文本框中输入此信息后，他们单击继续按钮，将数据保存到 SQL 数据库。我的问题是尝试将这些值保存在 SQL 中。我有一个“值”表（列是`PersonID`、`AttributeID`和`Value`）和一个“属性”表（列是主键`AttributeID`和`AttributeName`）。

在我的属性表中，我有以下内容：

```
AttributeID:   AttributeName: 
    1            FirstName 
    2            LastName 
```

我的目标是将此保存在 Value 表中：

```
PersonID:       AttributeID:             Value: 
    A                1                     FirstName Value Here
    B                2                     LastName Value Here 
```

我知道如何通过将数据直接传递到存储过程来保存数据，但是如何正确分配 AttributeID？（例如：`AttributeID = 1`for`FirstName`和`AttributeID = 2`for `LastName`）。有没有办法可以将应用程序中的文本框分配给特定的`AttributeID`甚至是`AttributeName`？非常感谢。

这可能会令人困惑，但这里的想法是当单击按钮时，它会从表中提取与 FirstName 关联的 AttributeID，然后将值保存在表“Value”中。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:35:49.813

将每个的 AttributeID 放入每个相应文本框的 Tag 属性中。这是一个黑客，但它会完成工作。但是，当您检索它时，您需要将存储在标签中的值转换为正确的类型：

A. 设置 .Tag 属性：

```
txtFirst.Tag = firstNameAttributeID;
txtLast.Tag = lastNameAttributeID; 
```

B. 检索 .Tag 属性（例如，假设两者都是整数）：

```
firstNameAttributeID = (int)txtFirst.Tag;
lastNameAttributeID = (int)txtLast.Tag; 
```

就像我说的，你也许可以完成这项工作。但我可能会先检查你的设计。在我看来，您的个人实体应该为这些事情中的每一个指定字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:58:32.460

我会将它们存储在`ViewState`或`Session`取决于您在做什么：

```
//Code to get the values from the database.
Session("FirstNamePersionId") = fnamePId;
Session("FirstNameAttributeId") = fnameAId;
Session("LastNamePersionId") = lnamePId;
Session("LastNamePersionId") = lnameAId;
//other code. 
```

然后访问只是使用`Session("FirstNamePersionId")`或你所称的值。

我会将对属性`ViewState`或`Session`属性的调用包装起来，以使其更易于维护和阅读。

如果你需要一个例子，请告诉我。

**更新**：
要从数据库中获取值，您可以尝试以下操作。

```
int fNameId = -1, lNameId = -1;
SqlConnection sqlConn = new SqlConnection(conString);//conString is the connection string for your DB.  This should be the same as what you use to execute the stored procedure.
SqlCommand sqlQuery = new SqlCommand("SELECT AttributeID, AttributeName FROM Attribute WHERE AttributeName IN ('FirstName','LastName')", sqlConn);
SqlDataReader sqlReader;

sqlConn.Open();
sqlReader = sqlQuery.ExecuteReader();
if (sqlReader.HasRows)
{
    while (sqlReader.Read())
    {
        if (sqlReader[1].ToString().Equals("FirstName", StringComparison.CurrentCultureIgnoreCase))
        {
            fNameId = (int)fNameId;
        }
        else if (sqlReader[1].ToString().Equals("LastName", StringComparison.CurrentCultureIgnoreCase))
        {
            lNameId = (int)fNameId;
        }
    }
}
sqlReader.Close();
sqlConn.Close(); 
```

如果您愿意，您可以为每个 id 单独调用，但这会增加一些处理开销。如果您确实拨打了两次电话，那么我建议您使用相同的电话`SqlConnection`，尽管您需要创建一个新命令。有时不赞成
通过 id 访问结果（就像我使用 id 所做的那样）。`sqlReader[1]`我个人并不担心，因为我在 SQL 查询中声明了列顺序。
使用 LINQ2SQL 可能会更容易。
如果我犯了任何错误或遗漏了什么，请告诉我。

# python - 如何分析（视觉）通过 C 扩展在 python 包中实现的 CUDA 代码？

> ID：14205717
> 
> 赞同：0
> 
> 时间：2013-01-07T23:09:13.367
> 
> 标签：python, cuda, profiling, cprofile, nvvp

> **可能重复：**
> [如何使用 Visual Profiler 分析 PyCuda 代码？](https://stackoverflow.com/questions/6857384/how-to-profile-pycuda-code-with-the-visual-profiler)

CUDA 可视化分析器 (nvvp) 需要一个可执行条目来进行分析，但我的 CUDA 代码是通过 C 扩展在 python 包中实现的。无论如何要在这个 python 包中进行 CUDA 分析？谢谢！

# objective-c - 程序化屏幕截图歪曲最近邻

> ID：14205722
> 
> 赞同：7
> 
> 时间：2013-01-07T23:09:50.467
> 
> 标签：objective-c, ios, screenshot

当图像放大（在我的情况下非常远）并渲染最近邻以保留硬边缘时，我遇到屏幕截图（以编程方式使用下面的代码）与屏幕上实际显示的内容不一致。我从这些论坛获得了以下屏幕截图代码，但保存的是图像的（双线性？）渲染而不是最近邻。

```
UIGraphicsBeginImageContextWithOptions([[UIScreen mainScreen] bounds].size, NO, 0.0);
[self.view.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *imageView = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
UIImageWriteToSavedPhotosAlbum(imageView, nil, nil, nil); 
```

我做最近邻的方式是在 ViewDidLoad 中使用以下行

```
automataView.layer.magnificationFilter = kCAFilterNearest; 
```

（automataView 是一个带有 GIF 文件的 UIImageView，它作为子视图添加到处理缩放的 UIScrollView）

这里有两张图片，第一张是屏幕上的内容，第二张是使用上面的截图代码保存的。（抱歉链接 - “作为垃圾邮件预防机制，新用户不得发布图片”）

[http://www.flickr.com/photos/51983059@N08/8358662379/](http://www.flickr.com/photos/51983059@N08/8358662379/)

[http://www.flickr.com/photos/51983059@N08/8358662715/](http://www.flickr.com/photos/51983059@N08/8358662715/)

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T14:14:36.250

如果问题仍然相关。

我会认为插值是你在对象中设置的东西，它在上下文中绘制自己，但似乎上下文本身做了一些插值，它具有属性 CGInterpolationQuality 和 getter 和 setter。因此，对您的代码段的以下更改对我有用：

```
UIGraphicsBeginImageContextWithOptions([[UIApplication sharedApplication] keyWindow].bounds.size, NO, 0.0);
CGContextRef cgr = UIGraphicsGetCurrentContext();
CGContextSetInterpolationQuality(cgr, kCGInterpolationNone);
[self.view.layer renderInContext:cgr];
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
UIImageWriteToSavedPhotosAlbum(image, nil, nil, nil); 
```

# zope - Zope 2：如何在调试外壳中保存对象？

> ID：14205727
> 
> 赞同：0
> 
> 时间：2013-01-07T23:10:25.563
> 
> 标签：zope

我可以在调试 shell 中轻松地向 Zope 添加/删除对象，例如`app.manage_addProduct['OFS.Folder'].manage_addFolder('test')`. 但是我想不出一种将更改持久保存到数据库的方法。

我错过了一些明显的东西吗？TIA,

PS：我尝试过`app._p_changed=1`，但是在使用 退出 shell 后`exit()`，更改并没有保留下来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T04:42:21.210

您必须提交事务，请参阅：[http ://www.zodb.org/zodbbook/transactions.html](http://www.zodb.org/zodbbook/transactions.html)

# macos - 如何使用 AppleScript 向终端发出命令以释放内存空间 OSX ML

> ID：14205733
> 
> 赞同：0
> 
> 时间：2013-01-07T23:10:53.853
> 
> 标签：macos, memory, terminal, applescript, osx-mountain-lion

我想编写一个可以运行终端并编写“purge”的 AppleScript 命令，按回车键，然后按 cmd-q。

我试过这样：

告诉应用程序“终端”击键 ???????????? （我不知道如何使用击键命令！） end tell

我想用 AppleScript 编写这个命令来释放 RAM 空间，只在没有第三方应用程序的情况下启动脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T04:26:37.480

```
tell application "Terminal"
    activate

    tell application "System Events"
        keystroke "sudo"
        keystroke return
    end tell

end tell 
```

或 Lauri 的回答，它在不显示终端或不必激活终端的情况下做同样的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:59:07.113

你有两个选择：

1.  Shell 脚本（在不打开终端的情况下运行命令，最好的选择）
2.  击键，正如你所说

外壳脚本：

```
do shell script "purge" 
```

击键：

```
tell app "Terminal" to activate
tell app "System Events" to keystroke "purge"
tell app "System Events" to keystroke return
tell app "Terminal" to quit 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T01:25:36.547

释放非活动内存的应用程序是一个巨大的骗局。阅读[此处](https://apple.stackexchange.com/questions/72033/how-does-memory-management-work-in-mac-os-x/72036#72036)链接的一些问题。但如果你真的必须这样做，请使用`do shell script`：

```
do shell script "purge" 
```

# php - 将 div 分成多于 1 列

> ID：14205735
> 
> 赞同：0
> 
> 时间：2013-01-07T23:11:02.093
> 
> 标签：php, html, css, forms, wordpress

我正在使用[联系表格 7](http://wordpress.org/extend/plugins/contact-form-7/)在 wordpress 安装中创建联系表格。创建的表格位于[此处](http://www.sproutwellnesscenter.com/test-form/)

联系表单扩展是免费、灵活且易于使用的。但问题是，无论表单包含多少字段，它总是只创建一个 div，因此页面长度会变长（请参阅我创建的表单）

我挖掘了代码并以`contact-form-7\includes\classes.php`. 负责生成表单html的代码是

/* 生成表单 HTML */

```
function form_html() {
    global $wpcf7;

    $form = '<div class="wpcf7" id="' . $this->unit_tag . '">';

    $url = wpcf7_get_request_uri();

    if ( $frag = strstr( $url, '#' ) )
        $url = substr( $url, 0, -strlen( $frag ) );

    $url .= '#' . $this->unit_tag;

    $url = apply_filters( 'wpcf7_form_action_url', $url );

    $class = 'wpcf7-form';

    if ( $this->is_posted() ) {
        if ( empty( $wpcf7->result['valid'] ) )
            $class .= ' invalid';
        elseif ( ! empty( $wpcf7->result['spam'] ) )
            $class .= ' spam';
        elseif ( ! empty( $wpcf7->result['mail_sent'] ) )
            $class .= ' sent';
        else
            $class .= ' failed';
    }

    $class = apply_filters( 'wpcf7_form_class_attr', $class );

    $enctype = apply_filters( 'wpcf7_form_enctype', '' );

    $form .= '<form action="' . esc_url_raw( $url ) . '" method="post"'
        . ' class="' . esc_attr( $class ) . '"' . $enctype . '>' . "\n";

    $form .= $this->form_hidden_fields();

    $form .= $this->form_elements();

    if ( ! $this->responses_count )
        $form .= $this->form_response_output();

    $form .= '</form>';

    $form .= '</div>';

    return $form;
} 
```

我正在寻找一些方法，以便我可以

*   分成`<div class="wpcf7"`3 个 div，包含大致相同的字段数

*   `<div>`或在 < 之间插入`form action="`某处，以便我可以以大约（不完全）相等的方式水平扩展我的表单 `div's`

我的其他表格，我想遵循的格式位于[此处](http://www.sproutwellnesscenter.com/new-client-form/)

**更新：**

*   我正在使用 Eunoia 主题和 [one_third first] 之类的短代码来应用 CSS 和页面结构不起作用，对我来说，这是有道理的，因为插件使用相同的 '[ tag ]' 结构
*   我尝试`div`在表单代码中添加元素，但仍然没有任何反应，虽然在页面的源代码中，这些`div`标签出现了......

**想到另一个问题** 我的主题代码就像`[some theme code]`它们不起作用并且只是在页面上输出......我可以使用它的任何建议吗？

有人可以建议我这样做吗？一些粗略的想法，一些指导方针，以便我可以尝试编写代码......

谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:37:43.367

如果您可以将您的字段放入一个零索引数组中，这将起到作用（[phpFiddle](http://phpfiddle.org/main/code/996-fzy)）：

```
$fields=array('F1','F2','F3','F4','F5','F6','F7','F8');
$fieldCount=count($fields);
$column=0;
$columnCount=3;
//All columns have this many fields
$perColumn=floor($fieldCount/$columnCount);
//This many fields left over (to be distributed over the first columns)
$extras=$fieldCount - $perColumn*$columnCount;
$i=0; //All fields iterator
$j=0; //Column fields iterator
$columnFieldCount=$perColumn;
if($extras>$column)$columnFieldCount++;
echo '
<style>.column{float:left; width:25%;}</style>
<div class="column">';
for($i=0; $i<$fieldCount;$i++)
{
    echo '
<p>'.$fields[$i].'</p>';
    $j++;
    if($j>=$columnFieldCount)
    {
        $j=0;
        $column++;
        $columnFieldCount=$perColumn;
        if($extras>$column)$columnFieldCount++;
        echo '
</div><div class="column">';
    }
}
echo '
</div>'; 
```

# c# - 为 PrincipalContext 指定容器后找不到用户

> ID：14205737
> 
> 赞同：8
> 
> 时间：2013-01-07T23:11:35.907
> 
> 标签：c#, active-directory, userprincipal

我试图在 Active Directory 中按用户名查找用户。

这有效：

```
const string Domain = "SLO1.Foo.Bar.biz";
const string Username = "sanderso";

PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, Domain);
UserPrincipal userPrincipal = UserPrincipal.FindByIdentity(principalContext,  Username); 
```

这不会：

```
const string Domain = "SLO1.Foo.Bar.biz";
const string Container = "CN=Users,DC=SLO1,DC=Foo,DC=Bar,DC=biz";
const string Username = "sanderso";

PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, Domain, Container);
UserPrincipal userPrincipal = UserPrincipal.FindByIdentity(principalContext, Username); 
```

我收到错误消息：

> 服务器上没有这样的对象。

这是我的 ActiveDirectory 设置的屏幕截图：

![在此处输入图像描述](../Images/e970e6187f3a9e4dd3b6d9bd65e5d79a.png)

我也尝试过使用以下容器：

```
const string Container = "OU=Users,DC=SLO1,DC=Foo,DC=Bar,DC=biz"; 
```

这同样不成功。

如何在访问“用户”容器时指定我的容器？在引入具有更复杂要求的查找之前，我试图将其作为初始的简单设置。所以，我宁愿不满足于简单的解决方案，因为无论如何我都必须解决这个问题，我相信。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-07T23:56:52.737

我想到了 ：）

首先，我使用以下软件来确保生成正确的容器字符串：

[http://www.ldapbrowser.com/download.htm](http://www.ldapbrowser.com/download.htm)

这证实了我的字符串非常正确，除了缺少一个端口，但它只是需要一些大惊小怪。

正确的用法是：

```
const string Domain = "SLO1.Foo.Bar.biz:389";
const string Container = @"DC=Foo,DC=Bar,DC=biz";
const string Username = @"sanderso";
PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, Domain, Container);
UserPrincipal userPrincipal = UserPrincipal.FindByIdentity(principalContext,  username); 
```

# javascript - 用另一个元素替换 HTML 元素

> ID：14205738
> 
> 赞同：-1
> 
> 时间：2013-01-07T23:11:41.170
> 
> 标签：javascript, jquery, html, web

我试图让`img`一个 id的元素在按下某些键时`origImg`变成一个`iframe`具有 id 的元素。`video`我不知道任何javascript，所以我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T23:15:36.677

1.  将 keyup 事件绑定到可以捕获击键的东西，例如，`document`捕获击键。

2.  然后，评估按下了哪个键。只需观看 jQuery 的[event.which](http://api.jquery.com/event.which/)将处理浏览器支持。

3.  然后，使用 jQuery 的[.replaceWith()](http://api.jquery.com/replaceWith/)将现有的 HTML 元素替换为新元素。

这应该是你所需要的。

**编辑**

如果需要多个字符，则需要将它们的值设置为数组并检查是否存在，超级简单。

```
var accepted = ['13', '8', '9', '40'];

$(document).on('keyup', function(e){
    if($.inArray(e.which, accepted){
        $('#origImg').replaceWith('<iframe id="video"/>');
    }
}); 
```

# model-view-controller - Dotnethighcharts 库

> ID：14205741
> 
> 赞同：0
> 
> 时间：2013-01-07T23:11:51.430
> 
> 标签：model-view-controller, highcharts, dotnethighcharts

我在[http://dotnethighcharts.codeplex.com/](http://dotnethighcharts.codeplex.com/)找到了一个很棒 的库，这是一个非常棒的库，但我正在寻找愿意回答以下问题的人：

如何在我的 MVC 操作中为图表设置标题？设置标题本身很容易，但是如果我在其中指定任何单引号，则会导致语法错误。

我想将我的图表标题指定为 fe“John's statistics”。在没有 dotnethighcharts 的情况下使用 highcharts 是可行的，但我宁愿使用 dotnethighcharts，因为它允许我在后端和页面加载中指定数据。

谁能告诉我如何使用这个库将逗号放在高图表标题中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T14:56:04.413

在 Highcharts（没有 dotnethighcharts 模块）中有一个名为 setTitle 的方法。正如 Mark 在评论中所写，此方法接受字符串，并且由于它已传递给 javascript，因此您应该转义一些字符（例如“或”）。

在这里您可以学习如何在纯 highcharts 中执行此操作：http: [//jsbin.com/aqunun/1/](http://jsbin.com/aqunun/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T19:21:05.063

DotNet.Highcharts 库的 JsonSerializer 转义一次反斜杠。所以只需要再添加一个：“John\\'s statistics”。

# java - 未命名的json数组到java

> ID：14205743
> 
> 赞同：1
> 
> 时间：2013-01-07T23:12:00.313
> 
> 标签：java, json, gson

我有以下字符串：

```
"[{\"type\":\"string\",\"value\":\"value1\",\"field\":\"label\"},
    {\"type\":\"string\",\"value\":\"value2\",\"field\":\"address_unique\"}]" 
```

我想把它变成 java GSON JsonObject 数组/列表，以便调用类似的东西：

```
myJsonObjs[i].getAsJsonPrimitive("value").getAsString(); 
```

实现这一目标的最短路径是什么？我尝试像这样设置一个bean：

```
public static class Filter {
    @SerializedName("type")
    private String type;
    @SerializedName("value")
    private String value;
    @SerializedName("field")
    private String field;

    //getters, setters and ctor
} 
```

但我找不到使用 JsonParser 或 Gson 将上面的字符串反序列化为该 bean 的数组/列表的方法。特别是我试过

```
Gson gson = new Gson();
gson.fromJson(json_string, Filter[].class); 
```

（`json_string`上面的字符串在哪里）但这给了我一个

```
IllegalStateException: Expected BEGIN_ARRAY but was STRING 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T23:28:37.617

这是一种方法：

```
final String json = "[{\"type\":\"string\",\"value\":\"value1\",\"field\":\"label\"},{\"type\":\"string\",\"value\":\"value2\",\"field\":\"address_unique\"}]";
final JsonParser parser = new JsonParser();
final JsonElement rootElement = parser.parse(json);
final JsonArray values = rootElement.getAsJsonArray();
for (final JsonElement value : values) {
    final JsonObject obj = value.getAsJsonObject();
    final Filter filter = new Filter();
    filter.setType(obj.get("type"));
    filter.setValue(obj.get("value"));
    filter.setField(obj.get("field"));
} 
```

这是一种更自动化的方式：

```
final String json = "[{\"type\":\"string\",\"value\":\"value1\",\"field\":\"label\"},{\"type\":\"string\",\"value\":\"value2\",\"field\":\"address_unique\"}]";
final TypeToken<List<Filter>> token = new TypeToken<List<Filter>>() {
};
final Gson gson = new Gson();
final List<Filter> values = gson.fromJson(json, token.getType()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T23:14:00.410

你用解析尝试了什么？你有一个字符串，你需要两个步骤

1.  将字符串解析为 JsonArray
2.  使用 fromJson 将 JsonArray 转换为 java 对象

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T00:38:38.777

这看起来很奇怪，您的代码应该可以工作......无论如何，您也可以尝试[Genson library](http://code.google.com/p/genson/)，它具有与 Gson 相似的功能以及其他一些功能和更好的性能。

以下是使用 Genson 实现它的方法：

```
Genson genson = new Genson();
Filter[] filters = genson.deserialize(json, Filter[].class);

// or if you need a list
List<Filter> filters = genson.deserialize(json, new GenericType<List<Filter>>(){}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-10T16:36:46.277

它可以先解析为数组，然后转换为列表。

```
final Gson gson = new Gson();
final Filter[] values = gson.fromJson(json, Filter[].class);
ArrayList< Filter > filterList = new ArrayList< Filter >(Arrays.asList(values)); 
```

# python-2.7 - 使用 Alphasign Python 编写 Alpha 电子标牌

> ID：14205744
> 
> 赞同：0
> 
> 时间：2013-01-07T23:12:01.833
> 
> 标签：python-2.7, sign, pyusb

我正在尝试使用 alphasign python api [Alphasign] (https://alphasign.readthedocs.org/en/latest/index.html) 编写一个 alpha 符号 - 215r。我下载了 python 2.7、pyusb、pyserial 和 libusb。我使用 libusb 获得了标志的 vid 和 pid，并将其添加到 devices.py 文件中。但是，当我在 [此处] (https://alphasign.readthedocs.org/en/latest/index.html) 运行示例 python 代码时，我仍然收到一条错误消息，提示找不到 vid 和 pid 为 8765 的设备：1234（示例编号）。现在，当我打开文件时（代码是从上面的链接复制和粘贴的），它会导致 IDLE 崩溃（完全关闭）。...当我从 bash 运行文件时，它显示核心转储。请提出建议！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T21:51:01.143

我在 Mac (mtn lion) 上遇到了类似的问题：当我运行示例应用程序时，出现段错误 11。它在***sign.connect()***调用的 alphasign 库中崩溃。

将其更改为***sign.connect(reset=False)***，它工作正常。

仅供参考：段错误发生在低级 USB 驱动程序 libusb 中，而不是 python 代码中。

# php - 显示选定主题下的所有评论

> ID：14205745
> 
> 赞同：0
> 
> 时间：2013-01-07T23:12:02.047
> 
> 标签：php, mysqli

我正在创建一个带有评论的新闻系统。一切正常，但我不知道如何在特定帖子上显示评论。

当前代码仅显示表格注释中的第三条**注释**

是 ID = 3 的评论，但所有其他评论都有 $nid = 3，所以这应该都是在 ID = 3 的 news_posts 下发布的。

这些是我的 SQL 数据库表：

```
TABLE news_posts (
  id INT(11) NOT NULL AUTO_INCREMENT,
  title VARCHAR(70) NOT NULL,
  author VARCHAR(50) NOT NULL,
  post TEXT NOT NULL,
  DATE DATETIME NOT NULL,
  PRIMARY KEY (id)
)

TABLE comments (
  id INT(11) NOT NULL AUTO_INCREMENT,
  nid INT(11) NOT NULL,
  title VARCHAR(70) NOT NULL,
  author VARCHAR(50) NOT NULL,
  comment TEXT NOT NULL,
  DATE DATETIME NOT NULL,
  PRIMARY KEY (id)
) 
```

这是**news.php**应该显示所有的帖子和评论

```
$abfrage = "SELECT id, title, author, post, DATE_FORMAT(date, GET_FORMAT(DATETIME,'ISO')) as sd FROM news_posts ORDER BY id DESC LIMIT $start,$datensaetze_pro_seite";
 $result = $mysqli->query($abfrage)    

while ($row = $result->fetch_assoc()) { 

    $url = 'news/comments.php?id='. $row['id']; 

    echo '<table class="table table-bordered news"> 
           <thead> 
               <tr> 
                   <th colspan="3"># '. $row['id'] .' | '. $row['title'] .'</th>
             </tr> 
        </thead> 
        <tbody> 
               <tr> 
                   <td colspan="3">'. nl2br(htmlspecialchars(preg_replace('~\S{30}~', '\0 ', $row['post']))) .'</td>
                </tr> 
        </tbody> 
        <tfoot> 
               <tr> 
                   <td colspan="3"> 
                    <small>Beitrag von: '. $row['author'] .' | '. $row['sd'] .'</small>
                     <small class="pull-right"><i class="icon-comment"></i> Kommentar: <a class="accordion-toggle" data-toggle="collapse" href="#show_comment'. $row['id'] .'">anzeigen</a> | <a href="'. $url .'">verfassen</a></small>
                 </td> 
               </tr> 
        </tfoot> 
    </table>'; 

    $abfrage2 = "SELECT id AS comment_id, title AS comment_title, author AS comment_author, comment AS comment_text, DATE_FORMAT(DATE, GET_FORMAT(DATETIME,'ISO')) AS comment_date FROM comments WHERE nid = ". $row['id'] ." ORDER BY id DESC";

    $comment_stmt = $mysqli->prepare($abfrage2) 

    $comment_stmt->execute(); 

    $comment_stmt->bind_result($comment_id, $comment_title, $comment_author, $comment_text, $comment_date))

    while ($comment_stmt->fetch()) { 
        if($comment_stmt->errno) { 
            die($comment_stmt->error); 
        } 

        echo '<div id="show_comment'. $row['id'] .'" class="comment collapse pagination-centered">
             <h4>Kommentare zu</h4> 
            <p>'. $row['title'] .'</p> 
            <div> 
                <table class="table table-bordered news"> 
                       <thead> 
                        <tr> 
                               <th colspan="3">'. $comment_title .'</th> 
                        </tr> 
                    </thead> 
                    <tbody> 
                        <tr> 
                                 <td colspan="3">'. nl2br(htmlspecialchars(preg_replace('~\S{30}~', '\0 ', $comment_text))) .'</td>
                         </tr> 
                    </tbody> 
                    <tfoot> 
                        <tr> 
                            <td colspan="3"> 
                            <small>Beitrag von: '. $comment_author .' | '. $comment_date .'</small>
                             </td> 
                        </tr> 
                    </tfoot> 
                </table> 
            </div> 
        </div>'; 
    } 

    $total_comm = $comment_stmt->num_rows;

    if($total_comm == 0) { 

        echo '<div id="show_comment'. $row['id'] .'" class="comment collapse pagination-centered">
             <h4>Kommentare</h4> 
            <div class="alert alert-info">Es wurden noch keine Kommentare zu diesem Thema verfasst</div>
         </div>'; 
    } 
} 

$comment_stmt->close(); 
```

我现在正在尝试几天的运气，但我找不到解决我的问题的方法......我希望有人能帮助我。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-07T23:19:27.667

改变这个：

```
 while ($comment_stmt->fetch()) { 
```

对此：

```
 while ($commentRow = $comment_stmt->fetch_assoc()) { 
```

并从那里继续你的代码..

# mysql - 在 C 程序和 Ruby on Rails 应用程序之间传递数据的方式

> ID：14205746
> 
> 赞同：0
> 
> 时间：2013-01-07T23:12:07.540
> 
> 标签：mysql, c, ruby, ruby-on-rails-3, sqlite

我想实现一个算法：

1.  从 Ruby on Rails 应用程序中获取数据库对象作为输入，
2.  对输入进行计算，
3.  根据计算查询 Rails 数据库，
4.  并根据查询生成一组有序的结果。

我打算用 C（也许是 Objective-C？）编写算法有两个原因：1）练习 C 和 2）因为 C 比 Ruby 快。

查询 Rails 数据库（用于开发的 SQLite 和用于生产的 MySQL）并将 C 程序的输出传回 Rails 应用程序的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T03:47:57.400

您可以使用 RubyInline[1] 在 Ruby 代码中编写 C 代码。您还可以创建一个扩展 [2]。

[1] [http://rubyinline.rubyforge.org/RubyInline/](http://rubyinline.rubyforge.org/RubyInline/)

[2] [http://blog.jcoglan.com/2012/07/29/your-first-ruby-native-extension-c/](http://blog.jcoglan.com/2012/07/29/your-first-ruby-native-extension-c/)

# kendo-ui - Kendo Web v2012.3.1114 与 v2012.2.710 版本相比打破了 iPad 触控支持

> ID：14205747
> 
> 赞同：0
> 
> 时间：2013-01-07T23:12:15.890
> 
> 标签：kendo-ui, panelbar

从 Kendo 版本 v2012.2.710 转换到版本 v2012.3.1114 后，ipad 上的触摸事件不再触发 PanelBar 的导航事件。

此外，我注意到其他剑道控件在切换到较新版本后不适用于 ipad。

为了重现这个错误，我创建了两个相同的网站，只是使用不同的 Kendo Web 版本：

剑道 v2012.3.1114 [http://kendo.mobnation.org/](http://kendo.mobnation.org/)

剑道 v2012.2.710 [http://kendo.mobnation.org/home/old](http://kendo.mobnation.org/home/old)

您可以在 ipad 上尝试这两个 url，并看到只有 v2012.2.710 在单击项目时触发导航（在本例中为简单的 # 更改）。您可以通过启用开发者控制台 (F12) 在 Google Chrome 中模拟此操作，单击右下角的黑色齿轮图标，选择“覆盖”选项卡，将用户代理更改为“iPad iOS 5”并勾选“模拟触摸”事件”复选框（确保刷新页面）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T09:50:52.600

尝试安装最新的内部版本 - 在正式发布 (1114) 几周后，许多此类问题都得到了解决。

# clojure - Clojure core.logic 生成父母

> ID：14205748
> 
> 赞同：1
> 
> 时间：2013-01-07T23:12:18.430
> 
> 标签：clojure, clojure-core.logic

我有这个代码，它可以按照我的意愿执行，它递归地拉出给定人的父母：

```
(defn anc [child]
  (run* [q]
    (conde
     [(fresh [?p]
             (parento child ?p)
             (?== q [child ?p]))]
     [(fresh [?p ?gp]
             (parento child ?p)
             (parento ?p ?gp)
             (?== q [ ?p ?gp]))]
     [(fresh [?p ?gp ?ggp]
             (parento child ?p)
             (parento ?p ?gp)
             (parento ?gp ?ggp)
             (?== q [ ?gp ?ggp]))]
     ))) 
```

问题是，对于我回去的每一代，我都必须添加一个新的测试。

有没有办法在 core.logic 中概括这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T12:32:58.080

我尝试了一些东西，希望这可以帮助你：

```
user=> (defrel parent c p)
user=> (fact parent :b :a)
nil
user=> (fact parent :c :b)
nil
user=> (fact parent :d :c)
nil

user=> (defn anso [c a] 
             (conde  
                 [(fresh [p x] 
                     (parent c p) 
                     (anso p x) 
                     (appendo [p] x a))] 
                 [(fresh [x] 
                     (parent c x) 
                     (== a [x]))])) 
#'user/anso

user=> (last (run* [q] (anso :c q)))
(:b :a)
user=> (last (run* [q] (anso :b q)))
[:a]
user=> (last (run* [q] (anso :d q)))
(:c :b :a) 
```

# android - 前置摄像头图像失真

> ID：14205753
> 
> 赞同：3
> 
> 时间：2013-01-07T23:13:27.010
> 
> 标签：android, android-camera

我已经为 Android 开发了一个应用程序。带相机。并且在某些设备上存在非常奇怪的行为。问题是拍摄的图像非常失真。

像这样 ![结果图像](../Images/2a96a70973f15be940e9ce24e3e22381.png)

此问题仅在某些设备（例如 Nexus 4）上发生，并且仅在使用前置摄像头拍摄图像时发生！当使用后置摄像头拍摄图像时，一切正常（即使在 Nexus 4 上）

所以我不知道这是怎么回事，我应该怎么做。谷歌搜索根本没有结果。这是一个大问题，因为我没有 Nexus 4，所以我无法在上面调试应用程序。

我刚刚发现在 AndroidMainfest.xml 中，uses-feature 标签中没有描述 android.camera.front 功能，这可能是这种奇怪行为的原因吗？

需要帮忙 ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T18:19:53.007

好吧，问题出在 AndroidManifest.xml 中的“uses-feature”标签中。添加 android.camera.front 功能后，一切正常。

# java - IE 显示“Windows 找不到 https://xxxxxxx”错误以通过 HTTPS 下载

> ID：14205754
> 
> 赞同：1
> 
> 时间：2013-01-07T23:13:30.663
> 
> 标签：java, internet-explorer, jsp, ssl, download

我有一个 Struts 动作，写`HttpServletResponse`如下。代码仅适用于 HTTP，但不适用于 HTTPS。

```
BufferedInputStream in = null;
try {
    response.setHeader("Content-Disposition", "attachment; filename=\"" + fileName + "\";");
    // set response headers
    response.setContentLength(fileData.length);
    response.setContentType("application/octet-stream");

    //BUFFER
    int bufferSize = 2 * 1024 * 1024;
    in = new BufferedInputStream(new ByteArrayInputStream(fileData), bufferSize);
    byte[] buffer = new byte[bufferSize];
    int len = 0;

    // Loop through the input file and get the data chunks...
    while ((len = in.read(buffer, 0, bufferSize)) != -1) {
        response.getOutputStream().write(buffer, 0, len);
    }
} catch (Exception e) {
    throw new SystemException(e.getMessage());
} finally {
    response.getOutputStream().flush();
    response.getOutputStream().close();
} 
```

服务器是 Weblogic 10（有关系吗？）。整个 Web 应用程序都使用 HTTPS，但文件下载除外。它适用于 Chrome 和 FF，但不适用于 IE 8/9。以下消息显示在警告框中

> Windows 找不到“https://xxxxxxx”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T00:12:23.333

这是一个已知的 IE 特定问题，另请参阅 Microsoft 支持站点：[Internet Explorer 无法从 SSL 网站打开 Office 文档](http://support.microsoft.com/kb/316431)。要修复它，您需要在响应中显式设置以下标头：

```
response.setHeader("Cache-Control", "public");
response.setHeader("Pragma", "public"); 
```

# javascript - window.open 以表单提交为中心（已关闭）

> ID：14205757
> 
> 赞同：-1
> 
> 时间：2013-01-07T23:13:48.833
> 
> 标签：javascript, window.open, onsubmit

**更新：**

**答案可以在这里找到：**

[中心窗口。在表单提交时打开](https://stackoverflow.com/questions/14207482/center-window-open-on-form-submit)

==================================================== ====

我正在尝试将表单提交到以屏幕为中心的弹出窗口中。我在谷歌搜索时发现了几个 js 片段。

请记住，我可以理解 html/css，但不能理解 javascript。

```
<html>

  <head>
    <script type="text/javascript">
      function directions(sacred) {
        var x = screen.width / 2 - 700 / 2;
        var y = screen.height / 2 - 450 / 2;
        window.open(sacred.action, 'Directions', 'height=485,width=700,left=' + x + ',top=' + y);
      }
    </script>
  </head>

  <body>
    <form action="http://maps.google.com/maps" method="get" target="Directions"
    onsubmit="Directions=directions(sacred)">
      <p>
        <input class="directions-input" id="saddr" name="saddr" type="text" placeholder="enter zip-code"
        value="enter zip-code" onfocus="this.value = this.value=='enter zip-code'?'':this.value;"
        onblur="this.value = this.value==''?'enter zip-code':this.value;" />
        <input type="submit" class="directions-submit" />
        <input type="hidden" name="daddr" value="210+East+Northampton+Street,+Bath,+PA"
        />
        <input type="hidden" name="hl" value="en" />
      </p>
    </form>
  </body>

</html> 
```

[小提琴在这里](http://jsfiddle.net/jamesfinn/Dds3W/)

表单提交到新选项卡，并且不运行函数或 window.open

提前感谢任何人。

PS我刚刚掌握了这个stackoverflow的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:23:15.913

你已经写好了，但是在函数中使用它总是更好，这样你就不会迷路。

使用此功能：

```
function openCenteredWindow(url, name) {
    var width = 700;
    var height = 450;
    var left = parseInt((screen.availWidth/2) - (width/2));
    var top = parseInt((screen.availHeight/2) - (height/2));
    var windowFeatures = "width=" + width + ",height=" + height + ",status,resizable,left=" + left + ",top=" + top + "screenX=" + left + ",screenY=" + top;
    myWindow = window.open(url, name, windowFeatures);
} 
```

你会看到有什么不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:42:37.223

要不提交您的`onsubmit`函数必须的表单`return false`。

```
function directions(sacred) {
    var x = screen.width / 2 - 700 / 2;
    var y = screen.height / 2 - 450 / 2;
    window.open(sacred.action, 'Directions', 'height=485,width=700,left=' + x + ',top=' + y);
    return false;
  } 
```

和形式：

```
 <form action="http://maps.google.com/maps" method="get" target="Directions"
  onsubmit="return directions(sacred);"> 
```

我不确定变量`sacred`的来源。您还将当前`directions()`函数的返回值存储到其中，`Directions`但该函数当前不返回任何内容。但是我无法从您的代码中弄清楚这一点，但是通过上面的示例，您应该了解如何使其工作。

# c++ - 处理模板中的 void 类型

> ID：14205761
> 
> 赞同：12
> 
> 时间：2013-01-07T23:14:05.513
> 
> 标签：c++, templates, c++11

我有一个模板函数，它调用另一个函数并存储它的返回值，然后在返回值之前做一些工作。我想将此扩展到处理`T = void`，并且想知道专业化是否是我唯一的选择。

```
template<typename T>
T Foo( T(*Func)() ) 
{
    // do something first (e.g. some setup)
    T result = Func();
    // do something after (e.g. some tear down)
    return result;
}

// Is this specialization the only option?
template<>
void Foo<void>( void(*Func)() ) 
{
    // do something first (e.g. some setup)
    Func();
    // do something after (e.g. some tear down)
    return;
}

void Bar() {}
int BarInt() { return 1; }

int main()
{
    Foo<int>(&BarInt);
    Foo<void>(&Bar);
} 
```

或者可以修改常规版本`Foo`以处理`void`类型并且在这种情况下基本上什么都不做？我在想也许我的本地结果可以包装在一个可以处理的类型中`void`，但也可以将分配视为一个交易破坏者。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T23:25:30.397

鉴于您的操作不依赖于函数的结果，您可以在没有专门化的情况下进行操作。函数返回`void`返回类型的表达式是可以的`void`。所以这`return`部分不是麻烦的部分，但你需要想出一种方法来进行前后操作。构造函数和析构函数将帮助您：

```
struct do_something_helper
{
    do_something_helper()
    {
        // do something first (e.g. take a lock)
    }
    ~do_something_helper()
    {
        // do something after (e.g. release a lock)
    }
}; 
```

然后你可以这样写你的函数：

```
template<typename T>
T Foo( T(*Func)() ) 
{
    do_something_helper _dummy_helper; // constructor called here

    return Func();
    // destructor called here
} 
```

对于您评论的使用 lambdas 的更通用的解决方案，它可能如下所示：

```
template< typename Pre, typename Post >
struct scope_guard
{
    scope_guard( Pre&& pre, Post&& post )
      : _post( std::forward< Post >( post ) )
    {
        pre();
    }
    ~scope_guard()
    {
        _post();
    }

    Post _post;
};

template< typename Pre, typename Post >
scope_guard< Pre, Post > make_scope_guard( Pre&& pre, Post&& post )
{
    return scope_guard< Pre, Post >( std::forward< Pre >( pre ), std::forward< Post >( post ) );
}

template<typename T>
T Foo( T(*Func)() ) 
{
    auto do_something_helper =
        make_scope_guard(
            [](){ /* do something first (e.g. take a lock) */ },
            [](){ /* do something after (e.g. release a lock) */ }
        );

    return Func();
} 
```

使用*类型擦除的*版本`std::function< void() >`会更容易编写和使用，但效率会相当低。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T23:16:58.420

不，您需要专业化，因为您无法存储 void（如 中`T result = Func();`）。

如果您永远不会使用该值，并且您可以将 Func 作为最后一件事调用，那么您实际上可以：

```
return Func( ); 
```

if func 返回 void 或类型，因为以下是合法的：

```
void f();
void g() {
    return f();
} 
```

但是如果需要临时存储返回值，则需要特化。

但是，如果您要创建很多这些辅助函数 (Foo)，并且您不想每次都将特定的 Foo 专门化为 void，则可以创建一个包装调用程序，它将执行调用，并且需要时，返回值，无论是 void 还是某种真实类型：

```
template< typename R >
class call_wrapper {
public:
    call_wrapper( std::function< R( void ) > f )
    : temp( std::move( f( ) ) )
    { }

    R&& return_and_destroy( ) {
        return std::move( temp );
    }

private:
    R temp;
};

template< >
class call_wrapper< void > {
public:
    call_wrapper( std::function< void(void) > f ) { f( ); }

    void return_and_destroy( ) { }
}; 
```

然后，您可以在您要编写的所有 Foo 中执行以下操作，**而无需专门**化，因为它已在上面的包装器中一劳永逸地处理：

```
template<typename T>
T Foo( T(*Func)() ) 
{
    // do something first (e.g. some setup)
    call_wrapper< T > cw( Func );
    // do something after (e.g. some tear down)
    return cw.return_and_destroy( );
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T23:22:49.580

如果您所做的只是获取和释放锁，那么您应该使用 RAII 而不是调用锁定/解锁函数。如果`Func`可以抛出，尤其如此，就好像它不会调用它之​​后的代码一样。

一旦你有一个 RAII 锁（或者如果你需要多个锁，则需要一段时间的 RAII 对象），你可以简单地执行以下操作`void`：

```
template<typename T>
T Foo( T(*Func)() ) 
{
    lock my_lock;
    return Func();
} 
```

* * *

```
template<typename T>
T Foo( T(*Func)() ) 
{
    struct raii_wrapper {
      raii_wrapper(T(*Func)()) : Func(Func) {
        // pre effects
      }
      ~raii_wrapper() {
        // post effects
      }
      T(*Func)();
    } actions(Func);
    return Func;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T23:40:45.673

不确定这是否有效，但是：

```
template<>
void Foo<T>( T(*Func)() ) 
{
    // do something first (e.g. some setup)
    return tearDown(Func());
}

template<>
T tearDown<T>( T result) 
{
    // do something after
    return result;
} 
```

# python - 使用后端 NDB 的 GAE put_multi() 实体

> ID：14205763
> 
> 赞同：5
> 
> 时间：2013-01-07T23:14:17.783
> 
> 标签：python, google-app-engine, app-engine-ndb

我正在使用后端编写多个实体`ndb.put_multi(list_of_entities)`。

我遇到的问题是，在那之后，如果我进行查询，那么我没有得到任何结果。如果我设置一个睡眠定时器，例如 1 秒，我可以读取我刚刚编写的实体。

所以例如：

```
class Picture(ndb.Expando):
    pass

class Favourite(ndb.Expando):
    user_id = ndb.StringProperty(required=True)
    pass

#...make lists with Picture and Favourite kinds
entities = favourites
entities[1:1] = pictures
ndb.put_multi(entities)

favourites = Favourite.query().filter(Favourite.user_id == user_id).fetch(99999, keys_only=True)
logging.info(len(favourites)) #returns 0 in dev_appserver why? 
```

首先假设问题与缓存有关。**但是**：

在多个键或实体上读取[NDB 实体操作](https://developers.google.com/appengine/docs/python/ndb/entities#multiple)：

> 高级说明：这些方法与上下文和缓存正确交互；它们不直接对应于特定的 RPC 调用。

读取[NDB 缓存](https://developers.google.com/appengine/docs/python/ndb/cache)

> 上下文缓存
> 
> 上下文缓存仅在单个传入 HTTP 请求期间持续存在，并且仅对处理该请求的代码“可见”。它很快; 这个缓存存在于内存中。当 NDB 函数写入数据存储时，它也会写入上下文缓存。当 NDB 函数读取实体时，它首先检查上下文缓存。如果在此处找到实体，则不会发生 Datastore 交互。
> 
> 查询不会在任何缓存中查找值。但是，如果缓存策略如此，查询结果将被写回上下文缓存（但永远不会写回 Memcache）。

嗯，我在这里迷路了。一切似乎都很好。即使从控制台查询我得到正确的总和，但永远不会在同一个处理程序上，无论什么功能等。

我唯一注意到的是，当等待时`time.sleep(1)`，我得到了正确的结果。`ndb.put_multi`所以这与可能不会同步完成的事实有关。如此迷茫....

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T13:02:56.060

早上头脑清醒总比晚上头脑昏沉好。

谢谢大家的意见。问题解决了。您以正确的方式引导我，以便回答我的问题：

我使用祖先查询来正确获得结果。值得一提的是以下几点

[了解 NDB 写入：提交、使缓存无效和应用](https://developers.google.com/appengine/docs/python/ndb/overview)

> 写入数据的 NDB 函数（例如 put()）在缓存失效后返回；**Apply 阶段异步**发生。

这意味着在每次放置之后，应用阶段可能还没有完成。

和：

> 此行为会影响数据对您的应用程序可见的方式和时间。在 NDB 函数返回后几百毫秒左右，更改可能不会完全应用于基础数据存储区。在应用更改时执行的非祖先查询可能会看到不一致的状态（即，部分但不是全部更改）。有关写入和查询时间的更多信息，请参阅 App Engine 中的事务隔离。

还有一些关于读取和写入一致性的事情，取自[Google Academy 从数据存储区检索数据](https://developers.google.com/appengine/training/py101_2/lesson2)

> Google App Engine 的 High Replication Datastore (HRD) 通过在多个数据中心同步存储数据，为您的读写提供高可用性。但是，从提交写入到它在所有数据中心中可见的延迟意味着跨多个实体组的查询（非祖先查询）只能保证最终一致的结果。因此，此类查询的结果有时可能无法反映基础数据的最新更改。**但是，通过其键直接获取实体始终是一致的**。

感谢@Paul C 的不断帮助，感谢@dragonx 和@sologoub 帮助我理解。

# reporting-services - 如何在此版本的 SSRS 中预览我的报告（不确定是哪个版本）？

> ID：14205764
> 
> 赞同：0
> 
> 时间：2013-01-07T23:14:17.413
> 
> 标签：reporting-services, ssrs-2008

我需要帮助弄清楚如何导航 SSRS。我一直在使用远程桌面使用 SSRS，但是当我切换到本地计算机并在 Visual Studio 上安装 BIDS 时，我发现 SSRS 看起来完全不同......这是一个屏幕截图（[单击她的 e 以查看全屏视图](https://i.imgur.com/YLNmh.png)）：

![在此处输入图像描述](../Images/b3a4b7fa5003281ac465b9f607c61d72.png)

这是 SSRS-2008 吗？或者最新版本——

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T02:23:59.170

这看起来像 SQL Server 2012 安装的 BIDS 版本。使用菜单帮助/关于确定。

# jquery - 可以工作的jquery live的替代品

> ID：14205769
> 
> 赞同：8
> 
> 时间：2013-01-07T23:14:51.587
> 
> 标签：jquery, delegates, bind, live

我有这个简单的代码。[http://jsfiddle.net/borth/BmEZv/](http://jsfiddle.net/borth/BmEZv/) 如果您单击链接一次，它工作正常。如果你第二次点击它，它就不起作用了。由于在 DOM 加载后将 html 加载到 html 中，我尝试了 .on、.bind、.delegate 和 .live。除了 .live 已被弃用（我使用的是 jquery 1.7.2）之外，它们都不起作用。

有人可以解释为什么 .live 是唯一有效的功能以及为什么其他功能不起作用（或者我在其他功能上做错了什么）。

* * *

```
$(document).ready(function(){
  $(".OpenPopup").bind('click', function(e){
      alert('test .OpenPopup');
      // do something
      return false;
  });
  $(".EditIcon").bind('click', function(){
      alert('test .EditIcon');
      // do something
      $("#ABC").html('<div class="EditIcon OpenPopup" pwidth="800" pheight="500" ptitle="EditText">click here again</div>');
  });
});

<div id="ABC"><div class="EditIcon OpenPopup" pwidth="800" pheight="500" ptitle="EditText">click here</div></div> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-07T23:43:49.740

```
$(document).ready(function(){
        $(document.body).on('click', ".OpenPopup", function(e){
            alert('test .OpenPopup');
            // do something
            return false;
        });
        $(document.body).on('click', ".EditIcon", function(){
            alert('test .EditIcon');
            // do something
            $("#ABC").html('<div class="EditIcon OpenPopup" pwidth="800" pheight="500" ptitle="Edit Text">click here again</div>');
        });
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T23:20:29.570

`.on()`可以[带或不带委托](http://api.jquery.com/on/#direct-and-delegated-events)使用，下面是使用委托的 on() 示例。

```
$("#ABC").on('click', ".OpenPopup", function(e){ 
```

[http://jsfiddle.net/BmEZv/1/](http://jsfiddle.net/BmEZv/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-06T21:07:16.370

在@Dhofca 之后，这确实有效。我只是展示了一个我尝试使用“this”关键字的示例。

```
$(document.body).on('click', ".query-result table tr", function () {
    var el = $(this);
    el.closest('table').find('tr').removeClass('dotted');
    el.addClass('dotted');
}); 
```

# css - 媒体查询中的 CSS3 转换？

> ID：14205776
> 
> 赞同：0
> 
> 时间：2013-01-07T23:15:46.847
> 
> 标签：css, responsive-design

我一直在开发一个使用 CSS3 过渡和媒体查询的响应式设计网站。因此，我创建了几个类名为“slider”的 div。我的 CSS 中有两条规则，一条用于声明悬停状态宽度，另一条用于指定过渡。

例如：

```
#navcontainer .slider:hover{
width: 38px;
}
#navcontainer .slider{
-webkit-transition: width 2s;
} 
```

以下将起作用，但当我在这样的媒体查询中添加另一个规则时不起作用：

```
@media(max-width: 440px){
#navcontainer .slider:hover{width: 56px;}
} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:40:43.710

它应该可以工作......但我通常使用“@media only screen and (max-width: 440px){}”，而不仅仅是@media(){}。

您的媒体查询在您的 css 文件的底部？（它不应该有任何区别，但谁知道呢？）。另外，我认为您应该使用其他供应商前缀进行转换：

```
transition:...;
-o-transition:...;
-moz-transition:...;
-webkit-transition:...; 
```

我也会尝试将这些过渡线复制到 @media(){} 内部

再说一次，我认为它应该按原样工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:42:25.210

您知道`@media`问题中的选择器是 a `:hover`，对吗？

似乎对我来说工作得很好。[在此演示](http://jsfiddle.net/Marcel/k8ePf/)中，我为`@media`规则添加了背景更改，因此更加明显，只需左右滑动中间边框即可调整窗格大小并触发`@media`样式。

## 演示：http: [//jsfiddle.net/Marcel/k8ePf/](http://jsfiddle.net/Marcel/k8ePf/)

# c++ - C - 使用 lseek() 获得的 read() 位置不准确

> ID：14205778
> 
> 赞同：0
> 
> 时间：2013-01-07T23:16:01.960
> 
> 标签：c++, c

创建一个文件，移动到位置 128 并写入数据，但是，在读取时我需要从偏移量 0 而不是 128 读取它，尽管我在 128 中写入。有人可以指出我哪里出错了。

写入后，打印文件的十六进制。当我写入该页面时，数据应打印在转储 1（位置 128）中。但它显示在转储 0（位置 0）中。

来自外部的文件的十六进制转储显示数据是我写入的位置（128）。

它与模式或文件权限有关吗？我正在研究 linux 操作系统。

```
 void readyCache() {
        fd = open("database.dat",O_RDWR|O_TRUNC|O_CREAT , S_IRUSR|S_IWUSR);
    }

    char* getPage(long pageNumber, int fd) {
        long offset;
        char* buffer = (char *)malloc(pageSize);
        offset = (pageNumber)*pageSize;
        lseek(fd, offset+pageSize, SEEK_SET);
        lseek(fd, offset, SEEK_SET);
        read(fd, buffer, pageSize);
        return buffer;
    }

    void setPage(long pageNumber,char* pageData, int fd) {
        long offset;
        offset = (pageNumber)*pageSize;
        lseek(fd, offset, SEEK_SET);
        write(fd, pageData, pageSize);
    }

    void hexdump(int fileDescriptor1, long pageNumber) {
        cout << endl;
        unsigned char readChar;
        int iterator = 0, j = 0;
        char * tempBuffer = (char *)malloc(pageSize);
        tempBuffer = getPage(pageNumber, fileDescriptor1);
        for(int i=0;i<pageSize;i++) {
            readChar = tempBuffer[i];
            iterator++;
            j++;
            printf("%02x ", readChar);//%02x
            if (iterator == 16) {
                iterator = 0;
                cout<<endl;
            }
        }
    }

    int main() {
            readyCache();
            char * tempBuffer = getPage(1, fd);
            int a = 1000;
            memcpy(tempBuffer, &a, sizeof(int));
            setPage(1,tempBuffer, fd);
            cout<<"\nDump 0\n";
            hexdump(fd, 0);
            cout<<"\nDump 1\n";
            hexdump(fd, 1);
            close(fd);
            return 0;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T03:09:04.160

无论文件大小如何，您始终可以查找可以存储在“off_t”数据类型中的任何位置（与上面 Cris Dodd 的答案相反）。

您真正的问题是您将 C++ 流 IO（cout << endl 等）与 C 标准 IO（printf）和 POSIX 底层 IO（lseek）混合。他们互相混淆！

如果您首先转换为纯 C（将 cout 的所有用法更改为 printf），您的程序将按预期工作。

C++ 标准定义了一种方法“sync_with_stdio(bool sync)”，您可以使用该方法将 C++ iostream 与 stdio 同步。如果你不使用它，同步是未定义的。

# loops - ARC 似乎过度释放了在循环中创建和调度的块中引用的对象

> ID：14205779
> 
> 赞同：3
> 
> 时间：2013-01-07T23:16:03.147
> 
> 标签：loops, automatic-ref-counting, objective-c-blocks, release-builds

我正在尝试使用 dispatch_async 在后台线程上进行一些复杂的计算，但是我在块中使用的对象似乎被过度释放了。我正在使用 ARC，所以我认为我不必太在意保留和释放，但在我的情况下，要么我错过了一些重要的东西，要么 ARC 过度释放了对象。

仅在以下情况下才会出现问题

*   我调用 dispatch_async 在 for 循环中创建一个块
*   我在块外创建的块中引用了一个对象
*   循环至少进行两次迭代（因此至少创建了两个块并将其添加到队列中）
*   使用了 RELEASE 构建配置（因此它可能与一些优化有关）

这似乎无关紧要

*   无论是串行队列还是并发队列
*   使用什么样的对象

这个问题不是关于在 RELEASE 配置中释放的块（如在[iOS 5 块中仅使用 Release Build 崩溃](https://stackoverflow.com/questions/10263110/ios-5-blocks-crash-only-with-release-build)），而是在块中引用的对象被过度释放。

我使用 NSURL 对象创建了一个小示例：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    NSURL *theURL = [NSURL URLWithString:@"/Users/"];
    dispatch_queue_t myQueue = dispatch_queue_create("several.blocks.queue", DISPATCH_QUEUE_SERIAL);

    dispatch_async(myQueue, ^(){
        NSURL *newURL = [theURL URLByAppendingPathComponent:@"test"];
        NSLog(@"Successfully created new url: %@ in initial block", newURL);
    });

    for (int i = 0; i < 2; i++)
    {
        dispatch_async(myQueue, ^(){
            NSURL *newURL = [theURL URLByAppendingPathComponent:@"test"];
            NSLog(@"Successfully created new url: %@ in loop block %d", newURL, i);
        });
    }
} 
```

不在 for 循环中的第一个块将毫无问题地工作。如果循环只有一次迭代，第二个也是如此。然而，在给定的示例中，它会执行两次迭代，如果使用 RELEASE 配置运行，则会崩溃。在方案中启用 NSZombie 会输出以下内容：

```
2013-01-07 23:33:33.331 BlocksAndARC[17185:1803] Successfully created new url: /Users/test in initial block
2013-01-07 23:33:33.333 BlocksAndARC[17185:1803] Successfully created new url: /Users/test in loop block 0
2013-01-07 23:33:33.333 BlocksAndARC[17185:1803] *** -[CFURL URLByAppendingPathComponent:]: message sent to deallocated instance 0x101c32790 
```

`URLByAppendingPathComponent`调试器在 for 循环块中的调用处停止。

当使用并发队列时，失败的调用实际上是`release`调用堆栈中带有 _Block_release 的调用：

```
2013-01-07 23:36:13.291 BlocksAndARC[17230:5f03] *** -[CFURL release]: message sent to deallocated instance 0x10190dd30
(lldb) bt
* thread #6: tid = 0x3503, 0x00007fff885914ce CoreFoundation`___forwarding___ + 158, stop reason = EXC_BREAKPOINT (code=EXC_I386_BPT, subcode=0x0)
    frame #0: 0x00007fff885914ce CoreFoundation`___forwarding___ + 158
    frame #1: 0x00007fff885913b8 CoreFoundation`_CF_forwarding_prep_0 + 232
    frame #2: 0x00007fff808166a3 libsystem_blocks.dylib`_Block_release + 202
    frame #3: 0x00007fff89f330b6 libdispatch.dylib`_dispatch_client_callout + 8
    frame #4: 0x00007fff89f38317 libdispatch.dylib`_dispatch_async_f_redirect_invoke + 117
    frame #5: 0x00007fff89f330b6 libdispatch.dylib`_dispatch_client_callout + 8
    frame #6: 0x00007fff89f341fa libdispatch.dylib`_dispatch_worker_thread2 + 304
    frame #7: 0x00007fff852f0cab libsystem_c.dylib`_pthread_wqthread + 404
    frame #8: 0x00007fff852db171 libsystem_c.dylib`start_wqthread + 13 
```

但这可能只是由于时间略有不同。

我认为这两个错误都表明引用的 NSURL 对象`theURL`被过度释放。但这是为什么呢？我错过了什么，还是 ARC 和块组合中的错误？

我期望发生的是，在`dispatch_async`调用之前或在执行`dispatch_async`（无论如何：在for循环内，每次`dispatch_async`调用一次）块内引用的每个变量都被保留并在结束时释放（但是在）块。

实际上似乎发生的是，变量在代码中`retain`出现一次，但在块的末尾被调用，所以每当它被执行时，这会导致比循环中的调用更多的调用。`dispatch_async``release``release``retain`

但也许我忽略了一些东西。有更好的解释吗？我是否以某种方式滥用了块或 ARC 或者这是一个错误？

**编辑**：我尝试了@Joshua Weinberg 将引用变量复制到 for 循环内的本地变量的建议。它在给定的示例代码中工作，但在涉及函数调用时不起作用：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    NSObject *theObject = [[NSObject alloc] init];

    [self blocksInForLoopWithObject:theObject];
}

-(void)blocksInForLoopWithObject:(NSObject *)theObject
{
    dispatch_queue_t myQueue = dispatch_queue_create("several.blocks.queue", DISPATCH_QUEUE_SERIAL);
    for (int i = 0; i < 2; i++)
    {
        NSObject *theSameObject = theObject;
        dispatch_async(myQueue, ^(){
            NSString *description = [theSameObject description];
            NSLog(@"Successfully referenced object %@ in loop block %d", description, i);
        });
    }
} 
```

那么为什么它在一个案例中起作用，而在另一个案例中却不起作用呢？我看不出有什么区别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:48:37.983

当我尝试它时，我只是能够重现它。您的诊断似乎是正确的，据我所知，这是一个关于如何复制块/保留其范围出错的优化问题。似乎值得雷达。

至于你能做些什么来解决这个问题。

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    NSURL *theURL = [NSURL URLWithString:@"/Users/"];
    dispatch_queue_t myQueue = dispatch_queue_create("several.blocks.queue", DISPATCH_QUEUE_SERIAL);

    dispatch_async(myQueue, ^(){
        NSURL *newURL = [theURL URLByAppendingPathComponent:@"test"];
        NSLog(@"Successfully created new url: %@ in initial block", newURL);
    });

    for (int i = 0; i < 2; i++)
    {
        NSURL *localURL = theURL;
        dispatch_async(myQueue, ^(){
            NSURL *newURL = [localURL URLByAppendingPathComponent:@"test"];
            NSLog(@"Successfully created new url: %@ in loop block %d", newURL, i);
        });
    }
} 
```

将其复制到堆栈会强制块每次重新捕获它并强制执行您预期的内存语义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T01:42:28.143

为了帮助人们解决这个问题，我能够在我的 XCode 4.5 发布配置上使用这个简化版本重现问题：

```
- (id)test {
  return [[NSObject alloc] init];
}

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {

  id foo = [self test];
  for (int i = 0; i < 2; i++)
  {
    [^(){
      NSLog(@"%@", foo);
    } copy];
  }
  NSLog(@"%@", foo);

  return YES;
} 
```

从分析来看，似乎 ARC在循环*内部的末尾错误地插入了一个释放。*

# matlab - 在 Matlab 中找到二维数组的所有最小元素

> ID：14205780
> 
> 赞同：6
> 
> 时间：2013-01-07T23:16:20.513
> 
> 标签：matlab, multidimensional-array, minimum

拥有二维数组，`A`我想在数组中找到最小数。但是，我可以拥有多个该数字。如何找到所有最小值的 [row col]？例子：

```
2 3 4 2
1 6 7 1
9 8 3 1 
```

它应该返回 [2,1] [2,4] [3,4]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T00:00:21.830

[find](http://www.mathworks.com/help/matlab/ref/find.html)可以解决问题：

```
[I,J] = find(A == min(A(:)) );

disp([I J])
   2   1
   2   4
   3   4 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T00:02:27.857

我相信这应该有效

```
[row,col]=find(a==min(a(:))) 
```

其中 a 是您的矩阵。如果只给出一个输出，Find 也可以输出一个线性索引。

# viewstate - 如何解码 ASP.NET 4.5 ViewState

> ID：14205783
> 
> 赞同：3
> 
> 时间：2013-01-07T23:16:37.423
> 
> 标签：viewstate, asp.net-4.5

我们最近将我们的网站迁移到 .NET 4.5，其中一项更改是将 targetFramework="4.5" 添加到 httpRuntime 以选择加入 ASP.NET 4.5 行为。在我们尝试在本地重现一些异常之前，一切都按预期工作。在升级之前，我们可以使用诸如[http://www.binaryfortress.com/ASPNET-ViewState-Helper/](http://www.binaryfortress.com/ASPNET-ViewState-Helper/)之类的视图状态解码器来查看存储在视图状态中的值。但是，这似乎不再可能了，视图状态似乎在每个页面请求上都使用随机密钥加密（每次都更改）。

那么，有人知道在 ASP.NET 4.5 中正确解密/解码视图状态的步骤吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T23:31:04.323

自 ASP.NET 4 以来，.NET 4.5 中的加密方法发生了巨大变化。此博客条目作为一个很好的概述：[**ASP.NET 4.5 中的加密改进，pt。2**](http://blogs.msdn.com/b/webdev/archive/2012/10/23/cryptographic-improvements-in-asp-net-4-5-pt-2.aspx) .

当您更新`Web.config`文件以具有以下标记时：

```
<httpRuntime targetFramework="4.5" /> 
```

这开启了 ASP.NET 4.5 的新加密功能。[您可以通过将machineKey](https://msdn.microsoft.com/library/w8h3skw9(v=vs.100).aspx)元素添加到配置中来显式关闭此 ASP.NET 4.5 特定的视图状态编码逻辑：

```
<machineKey compatibilityMode="Framework20SP1" /> 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-02-18T09:29:51.120

您可以在适当的 <%@ Page %> 指令中将 ViewStateEncryptionMode 设置为“从不”。

# android - Android 存储矢量 > 在文件中

> ID：14205790
> 
> 赞同：0
> 
> 时间：2013-01-07T23:17:24.693
> 
> 标签：android, graphics, vector

我在 Canvas 上画了一张图片，并拥有 PointF 对象的路径和向量。

我将所有 Vector 存储在 Vector> 变量中。

当我尝试存储 pointF 的对象 Vector<Vector>

在一个文件中，我得到一个 IOException，它是不可序列化的，因为它是一个 android.graphics.pointf。

有人对我如何存储这些数据有建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T05:56:15.693

You'll have to use custom serialization. Just convert to a string that let's reconstruct the point. Saving X and Y with the required precision should be enough. For `Vector<Vector>>` (why are you using `Vector` at all?) you can use a simple text file (one `Vector` per line, etc.) or some structured format like JSON or XML. If you really want to use Java serialization, write a wrapper object and implement `read/writeObject()`.

# objective-c - 如何处理用 UISearchBar 和 UITableView 逐字逐句搜索？

> ID：14205795
> 
> 赞同：0
> 
> 时间：2013-01-07T23:17:57.497
> 
> 标签：objective-c, uitableview, search, uisearchbar, words

我是 UISearchBar 的新手，我有一些用于搜索单词的代码。

```
- (void)searchTableView
{
NSLog(@"Searching...");
NSString *searchText = searchBar.text;

NSMutableArray *tempSearch = [[NSMutableArray alloc] init];

for (NSDictionary *item in items) {

    if ([[item objectForKey:@"en"] isEqualToString:searchText]) {
        NSLog(@"Found");

        [tempSearch addObject:item];
    }
}

searchArray = [tempSearch copy];
} 
```

它有效，但问题是它仅适用于完整的单词（例如，如果 in`textLabel`是`UITableViewCell`文本“something”并且我在其中输入“something”，`UISearchBar`那么我已经返回了这一行，但是当我输入“some”时，我得到了行完整的单词是“some”，“something”没有显示）。我如何用我的方法搜索文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T19:53:05.967

使用`NSPredicate`你可以稍微简化你的搜索：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"en BEGINSWITH %@", searchText];
NSArray *tempSearch = [items filteredArrayUsingPredicate:predicate]; 
```

如果您想要不区分大小写的搜索，请替换`BEGINSWITH`为`BEGINSWITH[c]`.

有关详细信息，请参阅“谓词编程指南”中的[使用谓词](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/Articles/pUsing.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:21:59.797

好的，我有一些东西，但不是 100% 正确。

```
for (NSDictionary *item in items) {

    NSRange range = [[item objectForKey:@"en"] rangeOfString : searchText];
    if (range.location != NSNotFound) {

        NSLog(@"Found");

        [tempSearch addObject:item];
    }
} 
```

当我输入“e”时，我得到了“some”、“something”、“else”——我认为正确的时候只会返回“else”。

好的，我知道了。

```
 if (range.location != NSNotFound && range.location == 0) { 
```

# http - Box API 定期返回 202 状态码

> ID：14205796
> 
> 赞同：1
> 
> 时间：2013-01-07T23:18:05.973
> 
> 标签：http, box-api

我注意到该框已开始在文件上传 API 调用中随机返回 202 个状态代码。似乎返回此代码时文件上传尚未成功完成，因此需要重试尝试的操作。这是我看到的示例响应：

```
["body"]=>
  bool(true)
["header"]=>
  string(211) "HTTP/1.1 202 Accepted
Server: nginx
Date: Mon, 07 Jan 2013 23:14:08 GMT
Content-Type: text/html; charset=utf-8
Connection: keep-alive
Cache-control: no-cache, no-store
Retry-After: 4
Content-Length: 0" 
```

鉴于 202 响应的模棱两可的性质，有人知道对此状态代码的技术上适当的响应是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T00:34:12.487

[你可以在下载文件部分](http://developers.box.com/docs/#files-download-a-file)看到完整的解释（我们没有把它放在上传部分但是现在）

> 如果文件尚未准备好下载（即文件在下载请求之前上传的情况），将返回 HTTP 状态为 202 Accepted 的响应，并带有一个 Retry-After 标头，指示之后的时间（以秒为单位）该文件可供客户端下载。

这或多或少意味着您必须等待“Retry-After”秒才能真正下载文件。大多数应用程序不需要立即下载文件，但如果需要，它需要正确处理此响应。

# javascript - PageMethods 未从代码隐藏调用函数 - 未定义

> ID：14205806
> 
> 赞同：0
> 
> 时间：2013-01-07T23:19:16.453
> 
> 标签：javascript, asp.net, ajax, pagemethods

我正在建立一个网站来建立你自己的蛋糕。每个蛋糕都有一个基本价格和某些选项。一些选项（例如草莓馅）为蛋糕增加了额外的价格。此价格在数据库中，由功能 ID 找到。

我正在尝试编写一个函数，该函数将在您选择一些新选项时更新价格。要选择功能，我有下拉框和复选框列表。它们显示选项的文本，但选项的值是功能 ID。我有一个 JS 函数可以通过并获取每个选定项目的值。

我的想法是在更改 ddl/cbl 时调用 additionalPrice，这将使用功能 ID 查询数据库，并添加额外的价格。问题是 PageMethods 未定义。当我在 VS2012 中输入时，它不会自动填充，并且是黑色而不是浅蓝色。我读过类似的其他问题，我很确定我做的一切都是正确的。这是我的代码...

```
<asp:ScriptManager ID="ScriptManager1" 
EnablePageMethods="true" 
EnablePartialRendering="true"  runat="server" />

<script>
$('.featureDropDown').change(function (a) {
            //var price = $.ajax({ url: 'ajax/totalproductprice.ashx', async: false }).responseText;
            var price = PageMethods.additionalPrice();
            alert(price);
</script> 
```

代码隐藏...

```
 [WebMethod] public static int additionalPrice()
    {
        return 77; 
    } 
```

一旦我让它工作，additionPrice 将有更多的逻辑。使用此代码，当您更改下拉列表时，它会警告“未定义”。

编辑：现在第一个问题已经解决了，我还有另一个问题。我正在尝试将保存最终价格的标签设置为从附加价格返回的值。我正在尝试在 PageMethods 的 onSuccess 方法中执行此操作。我只是在页面顶部有一个通用标签-

```
<asp:Label ID="lblPrice" runat="server" /> 
```

这是我的 onSuccess，以及我尝试过的不同方法。他们都没有对标签做任何事情。

```
function onSuccess(result) {
            alert(result + "worked");
            $('.lblPrice').attr("text", result);
            $('.lblPrice').attr('text', function () {
                $(this).attr('text', result);
            })
            $('.lblPrice').text(result);
            document.getElementById('lblPrice').value = result;
            document.all('lblPrice').innerHTML = result;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:30:31.640

使用 ASP.NET AJAX 时`PageMethods`，您可以通过向调用传递两个附加参数来订阅成功和失败回调函数。在这种情况下，您需要使用

```
$(function () {
    $('.featureDropDown').change(function (a) {
        //var price = $.ajax({ url: 'ajax/totalproductprice.ashx', async: false }).responseText;
        PageMethods.additionalPrice(onSuccess, onFailure);
    });

    function onSuccess(result) {
        alert(result);
    }

    function onFailure(error) {
        alert(error);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:45:42.933

要从 JavaScript 调用 Web 方法，请确保使用Web 方法所在的`<System.Web.Script.Services.ScriptService()>` [类进行调用。](http://msdn.microsoft.com/en-us/library/system.web.script.services.scriptserviceattribute.aspx)此外，如果您决定将 Web 方法添加到一个单独的文件中，这可能是为了提高可伸缩性，您需要添加对脚本管理器的引用。

```
<asp:ScriptManager ID="scriptManager" runat="server">
    <Services>
        <asp:ServiceReference Path="~/WebServices/SomeWebServices.asmx" />
    </Services>
</asp:ScriptManager> 
```

是的，然后如前所述。如果它仍然给您带来问题，请告诉我。

```
$(function () {
    $('.featureDropDown').change(function (a) {
        //var price = $.ajax({ url: 'ajax/totalproductprice.ashx', async: false }).responseText;
        PageMethods.additionalPrice(onSuccess, onFailure);
    });

    function onSuccess(result) {
        alert(result);
    }

    function onFailure(error) {
        alert(error);
    }
}); 
```

# editor - 防止 Sublime Text 2 在我输入文件搜索时打开文件

> ID：14205808
> 
> 赞同：1
> 
> 时间：2013-01-07T23:19:21.427
> 
> 标签：editor, preferences, sublimetext2

我喜欢能够在我的项目中按名称搜索任何文件并打开它，但我不希望 Sublime Text 2 在我输入名称时打开文件。我只希望它在我按 Enter/单击结果列表中的名称时打开文件。碰巧有一些大文件会尝试打开，只是因为文件名与我要查找的文件名相似，然后程序挂起，强制退出比等待 45 秒更快-1m 让 Sublime 再次开始响应。

如何防止 Sublime Text 2 在搜索文件时打开文件？

# iphone - NSTimer 未按预期运行

> ID：14205809
> 
> 赞同：0
> 
> 时间：2013-01-07T23:19:22.970
> 
> 标签：iphone, objective-c, ios, nstimer

我希望这是一个简单的修复，你告诉我。

我拥有的是 NSTimer 类型的 IVAR *timer 类。执行 IBAction 时，会调用包含以下代码的方法：

```
if (timer) timer = nil;
timer = [NSTimer timerWithTimeInterval:0.2 target:self selector:@selector(removeOverlay) userInfo:nil repeats:NO]; 
```

在同一个类中，我有一个方法：

```
- (void)removeOverlay {
...
} 
```

在 0.2 秒的时间间隔后不会触发。

你可能知道这里有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T23:25:05.707

1.  同时确保`timer`实例`NSTimer`没有被释放。
2.  `removeOverlay`看起来它更新了一些用户界面。确保你在主线程上调用它。
3.  在方法中放置一个断点`removeLayout`以查看它是否触发。
4.  您没有安排计时器。替换`timerWithTimeInterval`为`scheduledTimerWithTimeInterval`

在主线程上执行代码（允许 UI 更新）：

```
- (void)removeOverlay {
  dispatch_async(dispatch_get_main_queue(), ^{
     // update ui
  });
} 
```

更多关于[Grand Central Dispatch (GCD)](https://developer.apple.com/library/mac/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T23:23:44.633

你需要

```
 [[NSRunLoop mainRunLoop] addTimer:timer forMode:NSDefaultRunLoopMode]; 
```

计时器通过将调用放在运行循环中的适当点来工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T23:28:34.587

由于没有人提到它，将计时器添加到运行循环的另一种方法是使用 fire 方法：

```
[timer fire]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T23:23:45.443

如果它只被调用一次我会使用`[self performSelector:@selector(removeOverlay) afterDelay:(seconds you want to delay the use the method removeOverlay)];`

# android - 具有不同渲染输出的 drawBitmap（Nexus 7 与其他设备）

> ID：14205810
> 
> 赞同：6
> 
> 时间：2013-01-07T23:19:22.757
> 
> 标签：android, android-canvas, hardware-acceleration

在我的应用程序中，我在缩小时使用 drawBitmap() 来显示低分辨率位图。我在几台设备（Galaxy Tab、Kindle Fire、Moto Xoom 和 Nexus 7）上对其进行了测试。在所有这些中，我得到相同的渲染质量，除了在 Nexus 7 中。你可以在附加的屏幕截图中看到差异。外部区域是我使用 drawBitmap 的区域，如下所示：

```
mSrcRectF.set(src_x1, src_y1, src_x2, src_y2);
mDesRectF.set(view_x1, view_y1, view_x2, view_y2);
mMatrix.setRectToRect(mSrcRectF, mDesRectF, Matrix.ScaleToFit.CENTER);
canvas.drawBitmap(bmp, mMatrix, mPagePaint); 
```

如果我尝试在没有矩阵的情况下使用其他变体 drawBitmap(Bitmap bitmap, Rect src, RectF dst, Paint paint) 我会得到相同的结果。

我相信这个问题/差异可能与硬件加速有关。如果我关闭它（在清单文件中），我会为所有设备得到相同的结果。如果我打开它，除了 Nexus 之外，其他所有的渲染都会得到改善，它仍然显示一个更“像素化”的位图。我读过 HA 不支持某些例程，但即便如此，我还是无法理解在这种情况下发生了什么。在 Romain Guy 最近在他的博客中发表的一篇文章中，他评论道：

> 请注意，alpha 位图仅在调用 drawBitmap() 的“简单”版本时与着色器一起使用。目前硬件加速不支持采用矩阵或源和目标矩形的变体。

有人可以对此有所了解吗？

Nexus 7：[Nexus 7 屏幕截图](http://imageshack.us/a/img803/2691/nexus7.png)

Xoom（或 Galaxy Tab、Kindle Fire）：[Xoom 屏幕截图](http://imageshack.us/a/img802/4815/motoxoom.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:14:18.850

您可以按照[Stack Overflow 文章中的说明有选择地关闭 Canvas 的硬件加速](https://stackoverflow.com/questions/9886772/disable-hardware-acceleration-backward-compatibility)

这不是一个理想的解决方案，但它可以让您的应用程序的其余部分获得硬件加速的好处，直到 drawBitmap() 的所有选项都支持硬件加速。

# mysql - 如何使用 SELECT 来查找能够检索其 id 的值？

> ID：14205814
> 
> 赞同：0
> 
> 时间：2013-01-07T23:19:52.550
> 
> 标签：mysql, sql, mysqli

我无法插入`QuestionId`表格`Answer`。

`Question`插入没有问题，但我试图`QuestionId`从表中检索，`Question`这是一个自动增量到`Answer`表中，通过查找`SessionId`和`QuestionNo`那个特定的`QuestionId`属于。相反，它在插入表格时一直显示`0`。`QuestionId``Answer`

现在我知道尝试`QuestionId`从`Question`表中执行选择的查询是正确的，因为这已经过测试。我认为问题在于我将代码放在哪里，但我不确定？

我想使用 SELECT 方法来尝试查找问题编号，我不想使用 mysqli->insert_id。

这是数据库表：

问题表

```
QuestionId (auto)  SessionId  QuestionNo
4                  2          1
5                  2          2
6                  2          3 
```

目前答题表：

```
AnswerId (auto)  QuestionId  Answer
7                0           A
8                0           C
9                0           A
10               0           B
11               0           True 
```

答案表应如下所示：

```
AnswerId (auto)  QuestionId  Answer
7                4           A
8                4           C
9                5           A
10               5           B
11               6           True 
```

下面是代码：

```
 $questionsql = "INSERT INTO Question (SessionId, QuestionNo) 
    VALUES (?, ?)";
if (!$insert = $mysqli->prepare($questionsql)) {
    // Handle errors with prepare operation here
    echo __LINE__.': '.$mysqli->error;
}

 $answersql = "INSERT INTO Answer (QuestionId, Answer) 
    VALUES (?, ?)";
if (!$insertanswer = $mysqli->prepare($answersql)) {
    // Handle errors with prepare operation here
    echo __LINE__.': '.$mysqli->error;
}

//make sure both prepared statements succeeded before proceeding
if( $insert && $insertanswer)
{
    $sessid =  $_SESSION['id'] . ($_SESSION['initial_count'] > 1 ? $_SESSION['sessionCount'] : '');
    $c = count($_POST['numQuestion']);

    for($i = 0;  $i < $c; $i++ )
    {

            $insert->bind_param("ii", $sessionid, $_POST['numQuestion'][$i]);

            $insert->execute();

            if ($insert->errno) 
            {
                // Handle query error here
                echo __LINE__.': '.$insert->error;
                break 1;
            }
}

        $results = $_POST['value'];
        foreach($results as $id => $value) 
        {
            $answer = $value;

            $lastID = $id;

            $questionidquery = "SELECT QuestionId FROM Question WHERE (QuestionNo = ? AND SessionId = ?)";

        if (!$questionidstmt = $mysqli->prepare($questionidquery)) {
        // Handle errors with prepare operation here
          echo __LINE__.': '.$mysqli->error;
        }

        // Bind parameter for statement
        $questionidstmt->bind_param("ii", $lastID, $sessionId);

        // Execute the statement
        $questionidstmt->execute();

                    if ($questionidstmt->errno) 
                    {
                        // Handle query error here
                        echo __LINE__.': '.$questionidstmt->error;
                        break 2;
                    }

        // This is what matters. With MySQLi you have to bind result fields to
        // variables before calling fetch()
        $questionidstmt->bind_result($quesid);

        // This populates $optionid
        $questionidstmt->fetch(); 

        $questionidstmt->close(); 

            foreach($value as $answer) 
            {
                $insertanswer->bind_param("is", $quesid, $answer);

                $insertanswer->execute();

                if ($insertanswer->errno) {
                    // Handle query error here
                    echo __LINE__.': '.$insertanswer->error;
                    break 3;
                }
            }
        }

    //close your statements at the end

    $insertanswer->close();
    $insert->close();
}

?> 
```

下面是 var_dump($_POST)：

```
array(8) { 
["numberAnswer"]=> array(2) { 
         [0]=> string(1) "1" 
         [1]=> string(1) "1" 
         } 
         ["numQuestion"]=> array(2) 
         { 
         [0]=> string(1) "1" 
         [1]=> string(1) "2" 
         } 
         ["questionText"]=> array(2) { 
         [0]=> string(12) "What is 2+2?" 
         [1]=> string(12) "What is 4+4?" 
         } 
         ["gridValues"]=> array(2) { 
         [0]=> string(1) "4" 
         [1]=> string(1) "4" 
         } 
         ["reply"]=> array(2) { 
         [0]=> string(6) "single" 
         [1]=> string(6) "single" 
         } 
         ["textWeight"]=> array(2) { 
         [0]=> string(1) "5" 
         [1]=> string(1) "5" 
         } 
         ["submitDetails"]=> string(14) "Submit Details" ["value"]=> array(2) { 
         [1]=> array(1) { 
         [0]=> string(1) "B" 
         } 
         [2]=> array(1) { 
         [0]=> string(1) "D" 
         } 
         } 
         } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:29:57.170

您可以通过以下方式找出最后插入的 id：

```
SELECT LAST_INSERT_ID(); 
```

请注意，该值只会返回*最后一次*插入，因此如果您想做*更多*插入，则必须保存它以供重复使用：

伪代码：

*   插入问题
*   运行查询`SELECT LAST_INSERT_ID()`并将应用层中的值保存到变量`qid`
*   插入答案，`qid`用于答案行的 question_id

# c# - C# - 分发 COM DLLS

> ID：14205816
> 
> 赞同：-1
> 
> 时间：2013-01-07T23:20:03.647
> 
> 标签：c#, dll, com

我最近分发了一个使用 COM DLL (Skype4COM) 的应用程序，我的一个客户说程序在运行时出错，并提到了有关检索 COM 类工厂的内容。如何将 COM DLL 与应用程序一起分发，以便应用程序可以正确调用它？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:21:46.837

您可能需要将 COM DLL 注册为应用程序安装的一部分。

话虽如此，如果它是第三方 COM 库，例如 Skype4COM，则应将其作为 Skype 安装的一部分进行安装。您可能需要在运行时检查这一点，并告诉用户安装（正确版本的）Skype（如果未安装）。

# perl - 在 perl 程序上需要帮助

> ID：14205825
> 
> 赞同：-3
> 
> 时间：2013-01-07T23:21:35.480
> 
> 标签：perl, sockets, tcp, ini

到目前为止，我有一台新计算机，并且仍在安装 perl 我需要有人来测试我的程序的输出是什么（如果它甚至可以工作）如果不是，请告诉我我能做些什么来修复它（ Config::INI::Reader 是一个 cpan 类，所以如果你没有它，你可能想得到它

perl 代码：

```
#!/usr/bin/perl

use warnings;
use strict;
use IO::Socket;
use Config::INI::Reader;

my $file = "ServerSettings.ini";
my $ini = Config::INI::Reader->read_file($file);
my $server_info = $ini->{'ServerInfo'};
my $version = $ini->{'Version'};
my $host = $server_info->{'address'};
my $port = $server_info->{port};
my $server = new IO::Socket::INET(Proto=>'tcp',PeerAddr=>$host,PeerPort=>$port);

die "Connection Failed \n" unless $server;

print "Connection Established \n";
print "James Server" . $version->{ver} . "\n";
print "Hello From James Server"; 
```

这是ini：

```
[ServerSettings]
port=1234
address"localhost"

[Version]
ver="1.0.3" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:35:30.377

```
#!/usr/bin/perl -l

use warnings;
use strict;
use Config::INI::Reader;

my $file = "/tmp/l.ini";
my $ini = Config::INI::Reader->read_file($file);
my $server_info = $ini->{ServerSettings};
my $version = $ini->{Version};

my $host = $server_info->{address};
my $port = $server_info->{port};
my $ver = $version->{ver};

print $host;
print $port;
print $ver; 
```

您在 ini 文件中有错字，缺少一个`=`

```
[ServerSettings]
port=1234
address="localhost"

[Version]
ver="1.0.3" 
```

# mysql - 在 PHP 中设置默认 MySQL 套接字，pdo_mysql.default_socket PHP 5.3

> ID：14205826
> 
> 赞同：9
> 
> 时间：2013-01-07T23:21:41.827
> 
> 标签：mysql, centos, php

我在为 MySQL 设置默认 PDO 套接字位置时遇到问题，而不是通过将 PDO 类初始化为变量来完成。我试过改变 mysql.default_socket 变量。但这并不快乐。目前唯一可行的方法是通过类 DSN 实例化。

php.ini 内容：

```
[PHP]
engine = On
zend.ze1_compatibility_mode = Off
short_open_tag = On
asp_tags = Off
precision    =  14
y2k_compliance = On
output_buffering = 4096
zlib.output_compression = Off
implicit_flush = Off
unserialize_callback_func=
serialize_precision = 100
allow_call_time_pass_reference = Off
safe_mode = Off
safe_mode_gid = Off
safe_mode_include_dir =
safe_mode_exec_dir =
safe_mode_allowed_env_vars = PHP_
safe_mode_protected_env_vars = LD_LIBRARY_PATH
disable_functions =
disable_classes =
expose_php = Off
max_execution_time = 300
max_input_time = 60
memory_limit = 128M
error_reporting = E_ALL & ~E_NOTICE
display_errors = Off
display_startup_errors = Off
log_errors = On
log_errors_max_len = 1024
ignore_repeated_errors = Off
ignore_repeated_source = Off
report_memleaks = On
track_errors = Off
variables_order = "EGPCS"
register_globals = Off
register_long_arrays = Off
register_argc_argv = Off
auto_globals_jit = On
post_max_size = 8M
magic_quotes_gpc = Off
magic_quotes_runtime = Off
magic_quotes_sybase = Off
auto_prepend_file =
auto_append_file =
default_mimetype = "text/html"
doc_root =
user_dir =
extension_dir = "/usr/lib64/php/modules"
enable_dl = On
file_uploads = On
upload_max_filesize = 500M
allow_url_fopen = On
default_socket_timeout = 60

[Syslog]
define_syslog_variables  = Off

sendmail_path = /usr/sbin/sendmail -t -i

[SQL]
sql.safe_mode = Off

[ODBC]
odbc.allow_persistent = On
odbc.check_persistent = On
odbc.max_persistent = -1
odbc.max_links = -1
odbc.defaultlrl = 4096
odbc.defaultbinmode = 1

[MySQL]
mysql.allow_persistent = On
mysql.max_persistent = -1
mysql.max_links = -1
mysql.default_port = 3306
mysql.default_socket = /home/mysql/mysql.sock
mysql.default_host = 127.0.0.1
mysql.default_user = conner
mysql.default_password = danica4eva
mysql.connect_timeout = 60
mysql.trace_mode = Off

[MySQLi]
mysqli.max_links = -1
mysqli.default_port = 3306
mysqli.default_socket = /home/mysql/mysql.sock
mysqli.default_host = 127.0.0.1
mysqli.default_user = conner
mysqli.default_pw = danica4eva
mysqli.reconnect = Off

[mSQL]
msql.allow_persistent = On
msql.max_persistent = -1
msql.max_links = -1

[PostgresSQL]
pgsql.allow_persistent = On
pgsql.auto_reset_persistent = Off
pgsql.max_persistent = -1
pgsql.max_links = -1
pgsql.ignore_notice = 0
pgsql.log_notice = 0

[Sybase]
sybase.allow_persistent = On
sybase.max_persistent = -1
sybase.max_links = -1
sybase.min_error_severity = 10
sybase.min_message_severity = 10
sybase.compatability_mode = Off

[Sybase-CT]
sybct.allow_persistent = On
sybct.max_persistent = -1
sybct.max_links = -1
sybct.min_server_severity = 10
sybct.min_client_severity = 10

[bcmath]
bcmath.scale = 0

[Informix]
ifx.default_host =
ifx.default_user =
ifx.default_password =
ifx.allow_persistent = On
ifx.max_persistent = -1
ifx.max_links = -1
ifx.textasvarchar = 0
ifx.byteasvarchar = 0
ifx.charasvarchar = 0
ifx.blobinfile = 0.
ifx.nullformat = 0

[Session]
session.save_handler = files
session.save_path = "/var/lib/php/session"
session.use_cookies = 1
session.name = PHPSESSID
session.auto_start = 0
session.cookie_lifetime = 0
session.cookie_path = /
session.cookie_domain =
session.serialize_handler = php
session.gc_probability = 1
session.gc_divisor     = 1000
session.gc_maxlifetime = 1440
session.bug_compat_42 = 0
session.bug_compat_warn = 1
session.referer_check =
session.entropy_length = 0
session.entropy_file =
session.cache_limiter = nocache
session.cache_expire = 180
session.use_trans_sid = 0
session.hash_function = 1
session.hash_bits_per_character = 5
url_rewriter.tags = "a=href,area=href,frame=src,input=src,form=fakeentry"

[MSSQL]
mssql.allow_persistent = On
mssql.max_persistent = -1
mssql.max_links = -1
mssql.min_error_severity = 10
mssql.min_message_severity = 10
mssql.compatability_mode = Off
mssql.secure_connection = Off

[Verisign Payflow Pro]
pfpro.defaulthost = "test-payflow.verisign.com"
pfpro.defaultport = 443
pfpro.defaulttimeout = 30

[Tidy]
tidy.clean_output = Off

[soap]
soap.wsdl_cache_enabled=1
soap.wsdl_cache_dir="/tmp"
soap.wsdl_cache_ttl=86400

zend_extension = /etc/ioncube/ioncube_loader_lin_5.3.so 
```

如您所见，我已经更改了 php.ini 文件中的默认套接字设置，但是当我尝试连接到 MySQL 时，仍然在 PDO 中收到套接字错误。它让我相信 PDO 驱动程序没有使用 php.ini 中的设置。我确信有某种配置 PDO 的方法，但我的 php.ini 中没有任何内容。php.ini 中是否应该有 PDO 的设置，或者它们是否包含在其他地方？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-07T23:30:11.047

PDO mysql 驱动程序有不同的 ini 设置。它被称为

```
pdo_mysql.default_socket 
```

您是否尝试设置此 ini 值？请参考[http://php.net/manual/en/ref.pdo-mysql.php](http://php.net/manual/en/ref.pdo-mysql.php)

该值也可以在编译期间使用以下配置选项受到影响：

```
--with-mysql-sock=/my/path/mysql.sock 
```

**更新**：我发现问题是一个已知的[PHP 错误](https://bugs.php.net/bug.php?id=50829)。

第一：当使用 127.0.0.1 作为 db 主机而不是 localhost 时，您可以解决该问题。PHP 将以这种方式通过 TCP 套接字进行连接。

要更改位置，您必须使用特殊配置选项从源代码编译 PHP。我成功地使用以下（基本）命令行更改了 mysql 套接字的位置：

```
 ./configure \
  --with-mysql \
  --with-mysqli=mysqlnd \
  --enable-pdo \
  --with-pdo-mysql=mysqlnd \
  --with-mysql-sock=/home/mysql/mysqld.sock

 make
 make install 
```

最后一招使他们最后的结合。`--with-mysql-sock=file`设置 .sock 文件的位置，**但**仅在`--with-pdo-mysql=`设置为`mysqlnd`（mysql 本机驱动程序）时使用。如果缺少此选项，pdo 将与系统中的 libmysqlclient 链接。因此，您还可以重新编译 libmysqlclient（使用修改的套接字路径）并保持 php 不变。

注意：这只是使 PHP 与 PDO 一起工作的基本配置。如果您需要额外的扩展（如 json、xml 等），您将需要额外的配置选项。如果您以这种方式执行（原始发行版）版本，您将找到您的 Linux 发行版用于编译 PHP 的配置：`php -i`.

# objective-c - 在 plist 文件中存储 Objective-C 代码

> ID：14205828
> 
> 赞同：1
> 
> 时间：2013-01-07T23:21:52.853
> 
> 标签：objective-c, ios, plist

我知道这听起来很奇怪，但我想从 plist 中存储和检索 Objective-C 代码的小片段。场景是这样的：

我有一个存储核心图像过滤器预设的 plist。对于具有数值的所有内容（大多数预设），这一切都很正常。但是，一些预设需要像“inputColor”这样的 CIColor 对象（即*[CIColor colorWithRed:0.75 green:0.75 blue:0.75]*）。有没有办法将类似的东西存储在 plist 中（作为 NSString 或者可能是 NSData），然后将其作为可用代码检索？

我意识到一个合乎逻辑的选择是单独存储 RGB 值，但前一个选项会更方便一些，因为还有其他宏值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T23:37:45.743

您是否希望 plist 文件可供人类编辑？

如果不是，请注意`CIColor`符合`NSCoding`协议。因此，您可以将其转换为`NSData`using`NSKeyedArchiver`并将其存储`NSData`在 plist 中。当您阅读 plist 时，您可以将`NSData`back 转换为`CIColor`using `NSKeyedUnarchiver`。

其实`CIFilter`也符合`NSCoding`。也许您可以归档和取消归档您的过滤器对象。它将自动归档和取消归档其属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T23:37:58.367

您可以将其存储为字符串，然后对其进行解析。

但为什么要这样做？将颜色转换为 NSData 对象，然后将其存储在 plist 文件中。

# css - px之间有空格有什么区别？

> ID：14205831
> 
> 赞同：4
> 
> 时间：2013-01-07T23:22:16.553
> 
> 标签：css

有什么区别：

```
border-right: 1px dotted #CCCCCC; 
```

和：

```
border-right: 1 px dotted #CCCCCC; 
```

有没有？

第二个不正确吗？你需要把号码放在旁边`px`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T23:27:42.303

> *“长度值的格式（在`<length>`本规范中**由**可选的。”`<number>`*

 **来源：[http ://www.w3.org/TR/CSS21/syndata.html#length-units](http://www.w3.org/TR/CSS21/syndata.html#length-units)

换句话说：在“px”之前有一个空格是一个语法错误。你[验证了你的 CSS](http://jigsaw.w3.org/css-validator/)吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-07T23:27:51.847

来自[CSS 规范](http://www.w3.org/TR/CSS21/syndata.html#length-units)：

> 长度值的格式（`<length>`在本规范中表示）是一个`<number>`（有或没有小数点）紧跟一个单位标识符（例如，px、em 等）。在零长度之后，单元标识符是可选的。

因此，紧跟在数字之后应该是单位标识符。不同的浏览器可能会以不同的方式执行此操作，但如果有疑问，请遵循规范中的内容。

干杯

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T23:28:00.897

右边框：1px 点缀#CCCCCC；是正确的

右边框：1 px 点缀#CCCCCC；是不正确的

这是因为有多种方法可以定义长度，如“1px”或“1”，但问题是当你用“1 px”之类的空格分隔它们时，css 会认为宽度是“1”，下一个分类器是“像素”。我的意思是在不正确的示例中，css 认为“px”是您要输入的内容，而不是“dotted”。其余代码以此类推。问题在于，在不正确的示例中，您有太多选择器，因此代码会变得混乱并且无法工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-08-08T19:43:46.350

我正在使用 wordpress，但媒体查询不起作用。它只是被完全忽略了。花了一个令人沮丧的小时才意识到这是问题所在。我在 px 之前有一个空格（例如：“648 px”而不是“648px”）。

我建议不要在两者之间留有空间，即使大部分时间它都可以正常工作。**

# qt - 如何使用 Qt 在 MainWindow 中显示 QForm？

> ID：14205832
> 
> 赞同：0
> 
> 时间：2013-01-07T23:22:18.800
> 
> 标签：qt, qtreeview

我正在尝试在 Qt 中编写一个树浏览器 GUI。在左侧，我有一个由 Qt 组件处理的树视图系统`QTreeView`，但我希望在右侧面板上显示一个取决于所选树元素的表单。我找不到在 Qt 中做到这一点的方法。我发现了一篇关于使用小部件并将其推广到表单的现有帖子。这肯定会允许我在右侧面板上的 Qt 内显示一个表单，`MainWindow`但这不会允许我在每次选择树元素时更改右侧面板上的表单。

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T00:25:40.960

刚刚找到了一种使用 a`QScrollArea`和函数`setWidget`在主窗口中动态显示 Qt 表单的方法。不理想但有效。

# ios - AFNetworking 并获取 wait_fences：未能收到回复：10004003

> ID：14205840
> 
> 赞同：0
> 
> 时间：2013-01-07T23:23:19.683
> 
> 标签：ios, afnetworking

我知道这个问题已经被报道了很多次（我点击了几十个问题/解决方案），但是，我真的没有得到这个。

我通过 POST 请求`AFJSONRequestOperation`。在成功块中，我执行以下操作：

```
 NSString *errorString = [ErrorHandler getErrorMessage:[jsonDictionary valueForKey:@"ERROR"]];
       UIAlertView *mainAlert = [[UIAlertView alloc] initWithTitle:@"Error" message:errorString delegate:nil cancelButtonTitle:@"Ok" otherButtonTitles:nil];

       [self performSelector:@selector(showAlert:) withObject:mainAlert afterDelay:.5]; // Doesn't work
       [NSTimer scheduledTimerWithTimeInterval:0.05 target:self selector:@selector(showAlert:) userInfo:mainAlert repeats:NO]; // Doesn't work!

// Function that gets called
- (void)showAlert:(NSTimer *)timer
{
    UIAlertView *mainAlert = timer.userInfo;
    [mainAlert show];
} 
```

我尝试了在 SO 上发布的多种解决方案（`performSelector`以及`NSTimer`我自己的一些想法）。但是，我不断收到那个臭名昭著的消息。`viewDidLoad`除了初始化一些变量之外，我没有在我的方法中做任何事情。还有什么可以尝试的吗？我正在为 iOS 5.0 编程，这是在模拟器上完成的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T00:11:20.617

我想到了！老实说，不知道这甚至是一个问题，一定是框架中的东西。

我有 5 个`UITextField`，我正在向服务器发送数据。我不得不这样做`resignFirstResponder`，它工作正常。

# grails - 使用 HTTPBuilder 池化连接

> ID：14205843
> 
> 赞同：1
> 
> 时间：2013-01-07T23:23:39.360
> 
> 标签：grails, groovy, connection-pooling, synchronous, httpbuilder

我有一个 Grails/Groovy 应用程序，它使用 HTTPBuilder 库来调用我们的应用程序服务器。随着资源利用率的提高，我们正在寻找一种方法来池化我们的 HTTP 连接。我发现的唯一支持池的 HTTPBuilder 版本是 AsyncHTTPBuilder，但我们的调用必须同步进行。有没有人有使用 HTTPBuilder 池连接的经验，或者是否有一个备用库我们应该使用池连接来发出我们的请求？

这是我们使用 HTTPBuilder 库的示例：

```
def get(event, request) {    
    def http = new HTTPBuilder(appServerURL)
    def result = ""
    http.client.cookieStore.addCookie
    sessionHolderService.getVPMClientUser().apiSessionCookie
    http.request(GET, TEXT) {
        uri.path = "/path/on/appserver"
        uri.query = [event: event, request: request, responseFormat: 'text/xml']

        response.success = { resp, text ->
            result = text.text                
        }

        response.failure = { resp, text ->
            result = text.text
            throw new VPMClientException(resp.status, resp.message, text.text)
        }
    }
    result
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T11:17:31.380

我们的应用程序也有类似的问题（但仅限于一个客户端实例）。以下解决方案基于 Gpars。这些操作被放入发送队列，然后由任务使用。

```
final def http = ...

final DataflowQueue sendQueue = new DataflowQueue()
final DataflowVariable finished = new DataflowVariable<Boolean>()

def sendQueueTask = task {
    while(!finished.isBound()){
            def sendAction = sendQueue.getVal(1, TimeUnit.SECONDS)
            if(sendAction)
                  sendAction()
        }
} 
```

然后将操作包装在 sendQueue 中添加的闭包中：

```
def get(event, request) { 
  sendQueue << {
       // your get implementation
    }
} 
```

# c++ - 如何通过 boost.python 或 python/c api 调用 python 字节码文件

> ID：14205845
> 
> 赞同：2
> 
> 时间：2013-01-07T23:23:39.687
> 
> 标签：c++, python, c, boost-python

我有一些 python 字节码文件为“a.pyc”，“b.pyc”。我想在 C++ 代码中运行这个文件。代码可以调用 boost.python 或 python/c api。PyEval_EvalCode？

```
PyObject* PyEval_EvalCode(PyCodeObject *co, PyObject *globals, PyObject *locals) 
```

但是如何从字节码文件中获取 PyCodeObject。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T23:49:18.520

据我所知，您无法从“非常高级”层执行此操作。（你试过`PyRun_SimpleFileExFlags`吗？）所以你想看看[Importing Modules](http://docs.python.org/2/c-api/import.html) API。

如果你只是想 import `foo`，或者做类似的 importlib-ish 东西，而不关心它是`foo.py`or `foo.pyc`，那并不难。但是，如果您试图避免通常的导入规则并通过路径名明确指定文件……那一定是可能的，但我想不出任何方法……除了：

一个 .pyc 文件实际上只是来自 的幻数`PyImport_GetMagicNumber()`，然后是一个您可以忽略的 4 字节时间戳，然后是一个编组代码对象，您可以`marshal.loads`从 Python 或`PyMarshal_ReadObjectFromString`C中获取它。

我没有用 C 测试过这个，但是用 Python 测试过：

```
>>> with open('foo.pyc', 'rb') as f:
...     data = f.read()
>>> code = marshal.loads(data[8:])
>>> code
<code object <module> at 0x110118730, file "foo.py", line 1> 
```

检查它，它似乎正是它应该是的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-07T23:55:28.080

这在 Python 网站上有很好的记录：http: [//docs.python.org/2/extending/extending.html](http://docs.python.org/2/extending/extending.html) http://docs.python.org/2/c-api/object.html#PyObject_CallObject

主要思想是初始化 Python，然后初始化模块（使用 .pyc 模块初始化 PyImport_Import），然后初始化 PyOject_CallObject。

我假设你有一个你想调用的特定方法。

[http://docs.python.org/2/extending/embedding.html#pure-embedding](http://docs.python.org/2/extending/embedding.html#pure-embedding)

# css - Magento：带有 css 的简单股票指标

> ID：14205850
> 
> 赞同：-1
> 
> 时间：2013-01-07T23:23:53.697
> 
> 标签：css, magento, retina-display, magento-1.6, hdpi

我正在寻找一个简单的股票指标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T23:23:53.697

将此添加到您想要股票指标的 yourTheme/template/catalog/product/view.phtml 中。

```
<?php

    $qty = Mage::getModel('cataloginventory/stock_item')->loadByProduct($_product)->getQty();

    switch ($qty) {
        case $qty > 5 :
        $stockcss .= 'stockindicator-green';
        $stocktext = "In stock";
        break;
        case $qty <= 5:
        $stockcss .= 'stockindicator-green';
        $stocktext = "Low stock";
        break;
        case $qty <= 0:
        $stockcss .= 'stockindicator-green';
        $stocktext = "Out of stock";
        break;
    }
?>

Stock: <div class="stockindicator <?php echo $stockcss ?>" title="<?php echo $stocktext ?>"></div> 
```

将以下代码添加到 /skin/frontend/yourTheme/default/css/styles.css

```
.stockindicator {
    display: inline-block;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    -webkit-border-radius: 50%;
    -moz-border-radius: 50%;
}

.stockindicator-green { background-color: #46A40E; }
.stockindicator-yellow { background-color: #F9E700; }
.stockindicator-red { background-color: #E42620; } 
```

# ios - IOS中具有地理位置的phonegap

> ID：14205854
> 
> 赞同：1
> 
> 时间：2013-01-07T23:24:10.580
> 
> 标签：ios, cordova, background, geolocation

总而言之，我正在开发一个使用phonegap提供的地理定位服务的应用程序（使用最新版本2.2.0。我现在只在IOS上测试这个（最终我也想至少在Android上工作）。在IOS上当前台应用程序一切正常时。当应用程序进入后台时，地理编码停止工作，我不再收到更改位置事件。我的“必需背景模式”部分下确实有必需的“应用程序注册位置更新” app-info plist 并且我已经使用此标志完成了 ISO 编码，即使应用程序处于后台，我的应用程序也会报告位置更改，所以我想知道为什么这不适用于 phonegap。

我没有做任何花哨的工作。我的代码只是用于 watchPosition 的 cordova 代码的副本。

任何指示或帮助将不胜感激。

阿米尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:48:03.077

问题是当应用程序在后台时，PhoneGap 中的 JavaScript 不会运行。要提供后台进程功能，您需要创建一个插件来管理后台进程。

[http://docs.phonegap.com/en/2.2.0/guide_plugin-development_index.md.html](http://docs.phonegap.com/en/2.2.0/guide_plugin-development_index.md.html)

我知道一个已经存在的插件可以为 Android 执行此操作，但不是为 iOS 执行此操作。

[https://github.com/phonegap/phonegap-plugins/tree/master/Android/BackgroundService](https://github.com/phonegap/phonegap-plugins/tree/master/Android/BackgroundService)

# java - 在存储在 sqllite 数据库 android 中的浮点数前 5 分钟通知

> ID：14205862
> 
> 赞同：0
> 
> 时间：2013-01-07T23:25:09.133
> 
> 标签：java, android, sqlite, alarmmanager

在将警报管理器与 sqllite 数据库中的值结合起来时，我需要一些帮助。在我的数据库中，我存储了一个带有 start_lesson (float) 列的时间表。我想从数据库中获取该值并在 star_lesson 前 5 分钟发送一条消息。Star_lesson 可能是这样的（9.30、10.20 等）。

它需要检查一整天的课程是否开始（并在 5 分钟前发送通知）。

所以我的问题是我该怎么做？

提前致谢 ;）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:35:57.463

我会编写一个函数来读取您的数据库，找到最紧迫的事件，然后使用 AlarmManager 在 T-5 分钟触发 PendingIntent。

PendingIntent 将启动一个 BroadcastReceiver，它将检查数据库中所有在接下来的五分钟内到期的事件，并以您认为合适的任何方式通知用户。

BroadcastReceiver 然后会调用上述函数来安排下一个警报。

此外，所有可能改变数据库的函数也应该调用这个函数来处理任何可能的调度变化。

您还应该编写一个由 BOOT_COMPLETED 广播触发的 BroadcastReceiver 并将调用该函数。这样可以确保在设备重新启动时一切都能正常重新启动。

# drupal - 如何从打印的网页上打印链接的 href 值

> ID：14205864
> 
> 赞同：1
> 
> 时间：2013-01-07T23:25:21.383
> 
> 标签：drupal, printing, href

我正在使用 Drupal 7 和 960 网格系统编写一些网页。

当我打印页面时，这些页面中的链接（href 值）会被打印出来。例如，可点击的图像将其 URL 打印在其下方。文本中的链接也会打印它们的 href 值。

如何防止打印 href 值。

我不确定这是否与 Drupal 相关。

感谢您的任何意见！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T05:19:11.027

发现我使用的 Drupal 主题使这些 href 值可见。这是我隐藏它的方法：

```
a[href]:after { content: ""; /* hide visible URL after links. */ } 
```

亚当，感谢您为我指明了正确的方向。

干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T23:46:35.640

我相信这可能对你有用，但我还没有测试过

```
@media print {
    a:link:after,
    a:visited:after {
       content: none;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T10:42:06.077

只是一个评论：一些主题（我想我在一个基于 zen 的子主题中找到了它）带来了像上面这样的 css 指令：

```
a[href]:after { content: "..."; } 
```

起初很难找到要搜索的模式。做得好。

# java - 使用 IntelliJ IDEA 批量重命名方法

> ID：14205865
> 
> 赞同：6
> 
> 时间：2013-01-07T23:25:22.720
> 
> 标签：java, intellij-idea, automated-refactoring

我有一个包含许多（大约 40 个）方法的类，其名称在`SCREAMING_CASE_LIKE_THIS`.

有没有一种快速的方法，也许通过代码分析/检查，将所有这些重命名为更惯用的名称`camelCaseLikeThis`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-09T11:01:37.620

这不是一个批次，但是如果您将光标放在第一个方法的上方，请开始宏录制，然后执行： control-alt-down shift-f6 down-arrow down-arrow 回车

然后停止宏，您现在有了一个宏，该宏可以转到下一个方法并根据需要重命名（驼峰式大小写，不带下划线）。然后，您可以将该宏分配给快捷方式并重复适当的次数。我尝试将宏的最后一步添加为未绑定的组合键，然后将该组合分配给宏本身（因此它是自调用的），但我无法让它工作。还尝试创建另一个调用前 x 次的宏，但由于某种原因这也不起作用。

# javascript - 用javascript中的变量用str.replace（）替换所有项目

> ID：14205866
> 
> 赞同：-1
> 
> 时间：2013-01-07T23:25:24.940
> 
> 标签：javascript, str-replace

我想要一个具有输入数组的函数，其中包含需要从字符串中删除的所有单词，但我无法实现这一点。

我知道如果我想用纯文本做到这一点，那就是

```
string = string.replace(/"word"/g, ""); 
```

但我想用下面的函数来做，

```
 function removeFromString(string, toRemove){
     for(var i = 0 ; i <  toRemove.length; i++){
     string = string.replace(/<tr>/g, "");
     string = string.replace(/<\/tr>/g, "");
     }

     return string;
    }

  var remove = new Array();
      remove[0] = '<tr>';
      remove[1] = '</tr>';

 removeFromString(string, remove) 
```

我试过的，

像这样在声明时将斜杠和 g 添加到变量中，

```
 remove[0] = '/<tr>/g';
  remove[1] = '/</tr>/g'; 
```

在我的函数中的变量旁边添加斜杠和 g，如下所示，

```
string = string.replace(/toRemove[i]/g, ""); 
```

但似乎没有人能做到这一点，

任何建议将不胜感激，

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:45:41.060

问题是您将替换表达式作为字符串而不是表达式对象传递。例如`"/</tr>/g"`是一个字符串，但却`/</tr>/g`是一个正则表达式。

```
function removeFromString(s, toRemove){
  for(var i = 0, l = toRemove.length; i <  l; ++i){
    s = s.replace(toRemove[i], "");
  }

  return s;
}

var remove = [];
// These are regular expressions
// it's best to create them only once and reuse them
remove[0] = /<tr>/g;
remove[1] = /<\/tr>/g;

removeFromString(string, remove); 
```

# bash - bash进程替换拒绝文件描述符权限？

> ID：14205868
> 
> 赞同：5
> 
> 时间：2013-01-07T23:25:33.347
> 
> 标签：bash, file-descriptor, permission-denied, process-substitution

我有一个 bash 脚本，我想在标准输出中与用户通信，但也通过文件描述符将命令发送到子进程 - 如下所示：

```
# ...
# ...

echo "Hello user, behold a cleared gnuplot window"

# pass the string "clear" to gnuplot via file descriptor 3
echo "clear" >&3 
```

所以我想我可以通过首先启动这样的子流程来“设置”：

```
#!/bin/bash

# Initiate(?) file descriptor 3, and let it direct to a newly 
# started gnuplot process:
exec >3 >( gnuplot ) 
```

但这会产生一个错误：

```
/dev/fd/63: Permission denied 
```

**这是可以预料的吗？**

我不明白发生了什么事。（我做错了什么吗？可能是我的系统有一些特殊的安全设置，不允许我尝试做的事情吗？（运行 Ubuntu Linux 12.10。））

**“解决方法”** - 以下似乎与我正在尝试做的相同，并且可以正常工作：

```
#!/bin/bash

# open fd 3 and direct to where fd 1 directs to, i.e. std-out 
exec 3>&1 

# let fd 1 direct to a newly opened gnuplot process
exec 1> >( gnuplot ) 

# fd 1 now directs to the gnuplot process, and fd 3 directs to std-out.
# I would like it the other way around. So we'll just swap fd 1 and 3 
# (using an extra file descriptor, fd 4, as an intermediary)

exec 4>&1 # let fd 4 direct to wherever fd 1 directs to (the gnuplot process)
exec 1>&3 # let fd 1 direct to std-out 
exec 3>&4 # let fd 3 direct to the gnuplot process
exec 4>&- # close fd 4 
```

或者，作为单行：

```
#!/bin/bash
exec 3>&1 1> >( gnuplot ) 4>&1 1>&3 3>&4 4>&- 
```

为什么这行得通，但初始版本却不行？

非常感谢任何帮助。

```
$ bash --version
GNU bash, version 4.2.37(1)-release (x86_64-pc-linux-gnu)
[...] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T01:04:24.107

你有一个错字；使用`exec 3> >( gnuplot )`而不是`exec >3 >( gnuplot )`.

顺便说一句，是的，这是意料之中的。`exec >3 >( gnuplot )`将 stdout 重定向到名为 3 的文件，然后尝试作为`>( gnuplot )`程序执行（转换为 /dev/fd/63）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T18:00:02.870

我得到：

> /dev/fd/63：权限被拒绝

由于使用 sudo 导致进程替换，如此[处](https://github.com/mxcl/homebrew/issues/14923#issuecomment-8588878)所述。

所以**不**要这样做：

```
$ sudo ruby <(echo "puts 'foo'")
ruby: Bad file descriptor -- /dev/fd/63 (LoadError) 
```

# ruby-on-rails - 调试 Rails 和 Trinidad

> ID：14205869
> 
> 赞同：1
> 
> 时间：2013-01-07T23:25:42.033
> 
> 标签：ruby-on-rails, ruby, rubymine, trinidad-gem, rdebug

我正在开发一个使用特立尼达的 rails 3 应用程序。我一直在使用 RubyMine(4.5)，但我一生都无法弄清楚如何调试应用程序。它在非调试模式下从 IDE 运行良好，但是当您尝试调试时，它说它无法调试 trinidad 应用程序。为什么会这样说？

我还尝试从命令行运行 trinidad 和 rdebug，然后使用远程调试配置从 RubyMine 附加到它。我可以附加，但我不能设置任何断点。而且，如果不重新启动，对 ruby​​ 代码的更改似乎也不会生效。

我认为在从 RubyMine 进行调试时，我主要通过使用 Webrick 来解决这些问题。在这种情况下，我可以设置并点击断点，但由于某种原因，我对 ruby​​ 代码所做的任何更改在我重新启动服务器之前都不会生效。事实上，我能够即时更改 ruby​​ 代码的唯一方法是在非调试模式下运行应用程序时。

所以我想做的是：使用 RubyMine 中的 trinidad 进行调试，并且能够即时更改 ruby​​ 代码。或者，如果这不可行，请使用 RubyMine 中的 Webrick，并且还可以即时更改代码。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T12:43:40.690

请尝试[EAP 版本的 RubyMine](http://blog.jetbrains.com/ruby/2012/12/enjoy-rubymine-enoki-eap-while-were-all-still-alive/)，调试应该更适合这种配置（**TorqueBox 和 Trinidad Run/Debug Support**）。

[更新：发布](http://www.jetbrains.com/ruby/download/index.html)了支持 Trinidad 的 RubyMine 5.0 。

# url - 如何使用现有查询字符串将活动跟踪添加到 URL

> ID：14205879
> 
> 赞同：-1
> 
> 时间：2013-01-07T23:26:31.800
> 
> 标签：url, query-string

我想将广告系列跟踪添加到一个 URL，但它已经有一个查询字符串。

现有 URL 是*www.mywebsite.com/?nomobile*，我想添加：

?utm_source=SOURCE&utm_medium=MEDIUM&utm_campaign=NAME

**你可以在一个 URL 中有两个 ? 吗？**如果我不能这样做，还有什么替代方法？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T23:30:28.190

看到广告系列跟踪代码中的 & 字符了吗？这将各种不同的查询字符串参数分开。这 ？开始查询字符串，然后 & 分隔不同的参数。

[http://www.mywebsite.com/?nomobile&utm_source=SOURCE&utm_medium=MEDIUM&utm_campaign=NAME](http://www.mywebsite.com/?nomobile&utm_source=SOURCE&utm_medium=MEDIUM&utm_campaign=NAME)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:30:38.293

不，你不能有两个？相反，您可以根据需要拥有尽可能多的 &。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-07T23:30:30.687

只有一个 ？; 然后你用 &; 分隔参数

读[这个](http://en.wikipedia.org/wiki/Query_string)。我希望这能解释一些事情。

# c# - 在紧凑框架中使用绑定源进行自定义排序？

> ID：14205880
> 
> 赞同：0
> 
> 时间：2013-01-07T23:26:34.987
> 
> 标签：c#, datagrid, windows-mobile, compact-framework

这就是我目前正在做的排序：

```
 BindingSource bs = ( BindingSource )m_dataGrid.DataSource;
bs.Sort = "SortingRow" + " DESC"; 
```

我想要的是自定义方法或我用来排序的东西，例如：

```
bool GreaterThan(object a, object b)
{
(...)//my own code to determine return value
} 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:45:27.347

有很多方法可以做到。

DataSource 对象通常可以转换回 DataTable、DataView 或最初的任何东西。

不知道您的项目，我将使用 DataTable。

添加数据后，将其转换回 DataTable。

```
private void AddData(object data) {
  // data would be what you would normally fill to the m_dataGrid.DataSource
  DataTable table = m_dataGrid.DataSource as DataTable;
  if (table == null) {
    DataView view = m_dataGrid.DataSource as DataView;
    if (view != null) {
      table = view.Table;
    }
  }
  if (table != null) {
    Sort(table);
  }
} 
```

看起来的方式`AddData`无关紧要，因为您只想要一种将已知数据传递给`Sort`例程的方法。

你的`Sort`例程需要是你写的东西。它将原始数据更改回您的结构化数据类型，此处显示为一些通用`MyStuff`类：

```
private void Sort(DataTable table) {
  List<MyStuff> list = new List<MyStuff>(table.Rows.Count);
  for (int i = 0; i < table.Rows.Count; i++) {
    string valueA = table.Rows[MyStuff.A_INDEX].ToString();
    int itemB = Convert.ToInt32(table.Rows[MyStuff.B_INDEX]);
    list.Add(new MyStuff() { ValueA = valueA, ItemB = itemB });
  }
  list.Sort();
  m_dataGrid.DataSource = list;
} 
```

为了`list.Sort()`工作，你需要在你的类中实现`IComparable`和`IEquatable`接口。`MyStuff`

蹩脚的通用示例给你一个想法：

```
class MyStuff : IComparable<MyStuff>, IEquatable<MyStuff> {

  public const int A_INDEX = 0;
  public const int B_INDEX = 0;

  public MyStuff() {
    ValueA = null;
    ItemB = 0;
  }

  public string ValueA { get; set; }

  public int ItemB { get; set; }

  #region IComparable<MyStuff> Members

  public int CompareTo(MyStuff other) {
    if (other != null) {
      if (!String.IsNullOrEmpty(ValueA) && !String.IsNullOrEmpty(other.ValueA)) {
        int compare = ValueA.CompareTo(other.ValueA);
        if (compare == 0) {
          compare = ItemB.CompareTo(other.ItemB); // no null test for this
        }
        return compare;
      } else if (!String.IsNullOrEmpty(other.ValueA)) {
        return -1;
      }
    }
    return 1;
  }

  #endregion

  #region IEquatable<MyStuff> Members

  public bool Equals(MyStuff other) {
    int compare = CompareTo(other);
    return (compare == 0);
  }

  #endregion

} 
```

我希望这会有所帮助。

不过，我真的不能花更多时间在这上面，因为我今天有截止日期。

〜乔

# javascript - Jquery On Blur 有时

> ID：14205887
> 
> 赞同：1
> 
> 时间：2013-01-07T23:27:44.360
> 
> 标签：javascript, jquery

我有一个搜索，焦点变大，模糊变小。我的问题是，即使您单击建议区域，它也会导致动画运行。有没有办法做到这一点，如果您在建议区域单击此代码不会执行。

```
$('.search').blur(function(e) {
    if ( !clickedInSuggest ) {
        $(this).animate({ width : '50px' }, 150);
    }
}); 
```

html:

```
<li class="search">
    <form class="searchContainer" action="<?php echo Uri::create('search') ?>" method="get">
        <input autocomplete="off" name="name" placeholder="Search" tabindex="1" type="text" value="" />
        <button type="submit" class="submit"></button>
    </form>
    <div class="suggestions">
        <ul>
            <li></li>
        </ul>
    </div>
</li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T03:39:18.500

...等等...我刚刚在不同的情况下解决了这个问题，现在我记得：

```
$(function(){

   var flag=true;

   $('.suggestions').mousedown(function(){
       flag=false;
   })
   $('.suggestions').mouseup(function(){
      flag=true;
   })

   $('.search').blur(function(e){
       if(flag==false){
           e.preventDefault();
       }
      $('....').animate({...})..etc

   })
}) 
```

为什么会这样是因为 mousedown 事件在 blur 事件之前触发，而 blur 事件在 click 事件之前触发。

祝你好运。

# arrays - 在 D 中打印数组

> ID：14205888
> 
> 赞同：2
> 
> 时间：2013-01-07T23:27:47.343
> 
> 标签：arrays, printing, formatting, d

如何最方便地在 D 中打印数值数组？有这样的高级重载还是我必须自己实现它们？

就我而言，我只想显示的内容`data`来检查结果。

```
 double data[] = [ 11,2,3,4,6,1,34 ];
  std.algorithm.sort(data); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T23:31:28.907

只需导入`std.stdio`并`writeln()`在阵列上使用。

```
import std.stdio;

void main()
{
    auto a = [1, 2, 3, 4];
    writeln(a);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:30:49.427

你有没有试过？

```
foreach(a; data) writeln(a); 
```

# java - 基于瓦片的碰撞；拐角碰撞问题

> ID：14205892
> 
> 赞同：1
> 
> 时间：2013-01-07T23:28:05.470
> 
> 标签：java, collision-detection, collision

我在我的自上而下的游戏中实现了一个简单的基于瓷砖的碰撞系统，但我在通过角落移动时遇到了问题。目前，我的程序以玩家的中心点为中心，在 20 像素的方形网格（交替的灰色 cbackground）上绘制一个图块。它检查上下左右的瓷砖是否有碰撞，如果找到，则进入下一个阶段。

下一阶段是检查玩家在瓷砖内的位置。为此，我有一个名为`getCenterDistanceFromCurrentTile()`（创意名称，我知道）的函数。这将返回从图块中心点到玩家中心点的距离的 Vector2i（x 和 y）。然后我通过以下方式使用它；

*   如果左边有一块墙砖，并且玩家的 x 距离 < 0（玩家在当前图块中心点的左侧），则玩家将移动到靠近墙的图块的 x 处。
*   如果右侧有一堵墙，并且玩家的 x 距离 > 0（当前图块中心点的右侧），则玩家将移动到墙旁边图块的 x 处。
*   Y 轴以同样的方式继续。

我的问题是对角线。我目前不检查对角线碰撞，但看来我必须这样做。我已经尝试实现它，但是玩家在碰到角落时会跳来跳去。我正在使用上面的玩家 x < 0 和玩家 y < 0 的方法，但没有成功。我制作了一些图片来更好地解释我的问题。

![问题图片 1](../Images/70b00ed49b983734b4622a4616dd0cf5.png)

这张图片展示了我的碰撞系统工作正常，左侧有碰撞（由蓝色瓷砖显示），粉色瓷砖正在检查，但没有发现碰撞。绿色方块显示玩家当前的方块，红色方块显示玩家的当前位置。

![问题图片 2](../Images/706450e0dce78d8e22a77e99fa98f62a.png)

这张图片清楚地显示了我遇到的问题。粉红色的瓷砖都没有碰撞到任何东西，因此玩家的 x 和 y 不需要检查。

我应该如何检查我的游戏中的角碰撞？

我当前的碰撞检查代码；

```
public boolean isWall(Vector2i loc)
{
    return this.isWall(loc.x, loc.y);
}

public boolean isWall(int x, int y)
{
    if (x < 0) return true;
    if (y < 0) return true;
    if (y > map[0].length-1) return true;
    if (x > map.length-1) return true;
    return map[x][y];
}

public void phys(Player plr) {
    Vector2i playerTile = plr.getTile();
    // Left
    if (isWall(playerTile.x-1, playerTile.y))
    {
        Vector2i distanceFromTile = plr.getCenterDistanceFromCurrentTile(true);
        if (distanceFromTile.x < 0)
        {
            plr.setX(playerTile.x*BLOCK_SIZE);
        }
    }
    // Right
    if (isWall(playerTile.x+1, playerTile.y))
    {
        Vector2i distanceFromTile = plr.getCenterDistanceFromCurrentTile(true);
        if (distanceFromTile.x > 0)
        {
            plr.setX(playerTile.x*BLOCK_SIZE);
        }
    }
    // Up
    if (isWall(playerTile.x, playerTile.y-1))
    {
        Vector2i distanceFromTile = plr.getCenterDistanceFromCurrentTile(true);
        if (distanceFromTile.y < 0)
        {
            plr.setY(playerTile.y*BLOCK_SIZE);
        }
    }
    // Down
    if (isWall(playerTile.x, playerTile.y+1))
    {
        Vector2i distanceFromTile = plr.getCenterDistanceFromCurrentTile(true);
        if (distanceFromTile.y > 0)
        {
            plr.setY(playerTile.y*BLOCK_SIZE);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T00:42:14.177

您的 phys 方法可能会返回布尔值，具体取决于玩家是否与任何墙壁发生碰撞。然后，您可以使用此函数的结果来决定是否返回到您在移动之前所在的空间中的先前位置，或者如果您没有碰撞，则继续前进。

这将要求您检查玩家周围的所有相邻墙壁。这将引入一种更简洁的方式来迭代 phys 方法中的碰撞检查。

这样的改进看起来像：

```
public boolean phys(Player plr)
{
    java.awt.Rectangle playerBounds = new java.awt.Rectangle(plr.x, plr.y, BLOCK_SIZE, BLOCK_SIZE);

    for (int y = 0; y < 3; y++)
    {
        for (int x = 0; x < 3; x++)
        {
            // Skip the tile the player is on assuming that he is not on a wall already
            if (x == 1 && y == 1) continue;

            java.awt.Rectangle bounds = new java.awt.Rectangle(/*tile at (x, y) xpos*/, /*tile at (x, y) ypos*/, BLOCK_SIZE, BLOCK_SIZE);

            if (bounds.intersects(playerBounds))
            {
                return true;
            }
        }
    }

    // Did not collide
    return false;
} 
```

# ios - iOS 发布到 Instagram 无法正常工作

> ID：14205896
> 
> 赞同：1
> 
> 时间：2013-01-07T23:28:32.723
> 
> 标签：ios, ios6, uidocumentinteraction

> **可能重复：**
> [UIDocumentInteractionController 不再适用于 iOS6](https://stackoverflow.com/questions/12631466/uidocumentinteractioncontroller-no-longer-works-in-ios6)

我无法从我的应用程序中打开 Instagram。这是我正在使用的代码：

```
NSString  *imageToUpload = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents/mapapic-instagram.igo"];
NSData *imageData = UIImageJPEGRepresentation(image, 0.8);
[imageData writeToFile:imageToUpload atomically:YES];

_documentInteractionController 
    = [UIDocumentInteractionController interactionControllerWithURL:[NSURL fileURLWithPath:imageToUpload]];
_documentInteractionController.delegate = self;
_documentInteractionController.UTI = @"com.instagram.exclusivegram";
NSString *defaultInstagramText = @"Hello";

_documentInteractionController.annotation = @{ @"InstagramCaption" : defaultInstagramText };
BOOL success = [_documentInteractionController presentOpenInMenuFromRect:CGRectZero 
                                                                  inView:self.view.window
                                                                animated:YES]; 
```

最后一次调用返回 YES。然而什么也没发生，Instagram 也没有打开。`UIDocumentInteractionControllerDelegate`方法不被调用。我安装了 Instagram 应用程序。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T03:49:35.540

这是我需要更改以使其工作的内容（在下面的调用中更改`self.view.window`为`self.view`）。

```
BOOL success = [_documentInteractionController presentOpenInMenuFromRect:CGRectZero 
                                                                  inView:self.view.window
                                                                animated:YES]; 
```

显然`UIDocumentInteractionController presentOpenInMenuFromRect:inView:animated`，iOS 6 中的行为发生了变化，这破坏了我以前可以工作的代码。稍后我将在 iOS 5 中测试此更改，看看它是否仍然有效。

# c# - 即使一个事件处理程序中存在异常，如何继续多个事件订阅调用

> ID：14205900
> 
> 赞同：0
> 
> 时间：2013-01-07T23:29:16.133
> 
> 标签：c#, .net, events, event-handling

这是我想要完成的。我正在尝试使用我创建的自定义事件公开一个类。此类将分发给包装在 dll 中的其他人。

现在的要求是，当其他用户尝试多次订阅此事件时，无论任何订阅者有任何异常，都需要调用所有其他订阅者。

我知道在用户端的处理程序中使用 try 和 catch 块将确保调用其他块，但是我如何在定义事件的类级别上确保这一点。是否有一个像忽略异常这样的标志，我可以在类级别设置，以便无论任何订阅者抛出异常，都将调用所有订阅者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T23:35:21.023

在定义事件的类中，您可以使用它是多播委托这一事实并分别调用成员，大致如下：

```
 Delegate[] delegates = myEvent.GetInvocationList();
 foreach (Delegate d in delegates)
 {
     try {
         d.DynamicInvoke(sender, args);
     } catch {
     }
 } 
```

一般来说，永远不要隐藏异常是个好主意，如果不向用户显示它们，至少记录它们

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:46:44.817

为了做到这一点并保留异常，您可以使用以下方法：

```
 // Extract invocation list and call recursive dispatch:
    RecursiveDispatch(0, myEvent.GetInvocationList(), arguments);

    private static void RecursiveDispatch(int index, Delegate[] delegates, object[] arguments)
    {
        if (delegates == null || index >= delegates.Length)
            return;
        try
        {
            delegates[index].DynamicInvoke(arguments);
        }
        catch
        {
            InternalInvoke(index + 1, delegates, arguments);
            throw;
        }
        InternalInvoke(index + 1, delegates, arguments);
    } 
```

# c# - 如何在 c# selenium 中使用鼠标事件？

> ID：14205907
> 
> 赞同：2
> 
> 时间：2013-01-07T23:30:19.377
> 
> 标签：c#, selenium, mouse

我正在尝试在硒中测试鼠标事件。

这是我尝试过的：

```
 Actions builder = new Actions(d);

        IWebElement elem = d.FindElementById("gbqfq");
        builder.MoveToElement(elem).Build().Perform(); 
```

没有效果，鼠标不动。

另一种选择是使用`d.Mouse.MouseMove();`，但我找不到转换为该方法接受的`IWebElement`方法`ICoordinates`。

谁能指出一个很好的例子，如何在硒中使用鼠标？

我想要完成的是将鼠标移到网络元素的中心

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T03:12:36.087

确保选择了您的浏览器，或者换句话说，您的浏览器应该在屏幕顶部处于活动状态。您可以通过最大化窗口来实现。您可以参考以下文章。 [http://www.learnseleniumtesting.com/mouse-hover-and-other-mouse-events-in-webdriver/](http://www.learnseleniumtesting.com/mouse-hover-and-other-mouse-events-in-webdriver/)

# jquery - 在 ajax 调用之后，新的“onclick”处理程序在页面上某处单击之前不起作用

> ID：14205908
> 
> 赞同：0
> 
> 时间：2013-01-07T23:30:22.403
> 
> 标签：jquery, javascript-events

从 jQuery get() ajax 调用返回后出现问题。响应用其他 div 填充一个 div。这些新的 div 包含“onclick”事件处理程序。浏览器需要单击页面上的任意位置，然后我才能单击新填充的 div 并使其“onclick”触发。

**编辑**通过从“ajaxSearch”中删除“return false”和从“keypress”中删除“event.preventdefault()”来解决

**以下是正在发生的事情的具体情况：**

1.  在“srchKey”文本框中输入一个值，按 Enter
2.  'ajaxSearch' 函数触发并获取数据。
3.  'displayResults' 函数成功更新了 'searchResults' div，并且最多 10 个 div's 垂直堆叠在左侧。每个新的 'searchResult' div 都有一个 onclick='resultClick(this, '/Path...', displayRecord)' 设置，其中 '/Path...' 根据数据而变化。
4.  **在“onclick”触发之前，我被迫单击页面上的某个位置（无论在哪里）。**
5.  第一次单击后，我可以再次单击其中一个 searchResult div 并调用“onclick”脚本。

*对用户来说，第一次单击“searchResult”div 时，似乎没有任何反应。单击一次后，随后每次单击“searchResult”div 之一都会按预期工作。*

这个问题似乎与浏览器无关（至少在 Chrome 和 Firefox 中它做同样的事情的程度）。

我在我的页面中使用以下 jquery 脚本：

```
function displayResults(data) {
    $('.searchResults').html(data);
    return false;
}

function resultClick(selected, req, callback) {
    $('.searchResult').removeClass('selected');
    $(selected).addClass('selected');
    $.get(req, callback);
    return false;
}

function displayRecord(data) {
    $('#selectedRecord').html(data);
    return false;
}

function ajaxSearch() {
    $('#selectedRecord').empty();
    var myForm = $('#searchForm');
    $.post(myForm.URL, myForm.serialize(), displayResults);
    return false;
}

$(function () {
    $('#loadingDiv').hide();

    $('.watched').blur(ajaxSearch);
    $('#srchDate').blur(ajaxSearch);

    $(document).keypress(function (event) {
        if (event.which === 13) {
            event.preventDefault();
            ajaxSearch();
        }
    });
}); 
```

我的剃须刀页面如下所示：

```
...

<div id="searchPage">
    @using (Html.BeginForm("Index","Controller",FormMethod.Post, new {id="searchForm"}))
    {
        <fieldset>
            <legend>Criteria</legend>
            <div class="search" id="srchKey">
                 @Html.LabelFor(m=>m.Key)
                 @Html.EditorFor(m=>m.Key)
            </div>
        </fieldset>
    }
    <div class="resultsBlock">
        <div class="searchResults" id="unitResults"></div>
        <div id="selectedRecord"></div>
    </div>
</div>

@section scripts
{
    <script src="@Url.Content("~/Scripts/search.js")" type="text/javascript"></script>
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T02:51:18.067

您可以打开 firebug 并切换到 net 选项卡，然后您将查看第一次单击是否有效。您也可以尝试手动添加一个 &lgt;div onclick='resultClick(this, '/Path...', displayRecord)' 以查看它是否有效。

另外，您可以查看firebug中是否有任何js错误。

# r - 在 R 中的粘贴命令中添加 '" ' 引号

> ID：14205912
> 
> 赞同：1
> 
> 时间：2013-01-07T23:30:29.290
> 
> 标签：r

我试图`"`在 R 中的粘贴命令中包含（双引号）

```
paste("perl -ane 'system("cat /auto/Sample_output/tmp.$F[0].vcf >> Sample_90061.vcf");'",sep="") 
```

它说

```
Error: unexpected symbol in "paste("perl -ane 'system("cat" 
```

我尝试单独创建引用的部分，然后将其粘贴

```
complicated = paste('"cat /auto/Sample_output/tmp.$F[0].vcf >> Sample_90061.vcf"',sep="") 
```

但它显示为

```
> complicated
[1] "\"cat /auto/Sample_output/tmp.$F[0].vcf >> Sample_90061.vcf\"" 
```

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T23:34:13.590

`"`用反斜杠转义`\`。所以你将拥有：

```
paste("perl -ane 'system(\"cat /auto/Sample_output/tmp.$F[0].vcf >> Sample_90061.vcf\");'",sep="") 
```

# jquery - popover：在弹出窗口之外单击时关闭弹出窗口

> ID：14205921
> 
> 赞同：1
> 
> 时间：2013-01-07T23:31:16.297
> 
> 标签：jquery, twitter-bootstrap

我正在使用引导程序 v2.2.2。我尝试了其他一些方法（即：在弹出框之外[关闭弹出框但在里面保持打开状态](https://stackoverflow.com/q/13235222/1043817)以及[如何通过单击外部来关闭 Twitter Bootstrap 弹出框？](https://stackoverflow.com/q/11703093/1043817)还尝试了 BootstrapX clickover 插件：[https ://stackoverflow.com/a/11029479/ 104381​​7](https://stackoverflow.com/a/11029479/1043817) ) 但我无法通过这些方法让它工作。

我已经创建了一个 JSFiddle，其方式是在我的页面上使用代码：http: [//jsfiddle.net/FYNLL/](http://jsfiddle.net/FYNLL/)（虽然我使用的是 v2.2.2，但 JSFiddle 使用的是 v2.0.2 中的 JS。我认为这些版本有一些差异。当我在本地使用 v2.2.2 时，直到我单击链接才会显示弹出框。在 JSFiddle 中，它显示为悬停。要清楚，我希望它显示在链接之后已被点击，而不是悬停）

我想要完成的是在单击弹出框之外的区域时隐藏弹出框。如果单击另一个弹出窗口链接，我希望关闭第一个弹出窗口并单击打开的那个。

这也不是绝对必要的，但是当它在 .js 文件中时我无法开始`popover`工作（我尝试过使用`.each()`）。我真的很想摆脱`<script> $(function () { $("a[rel=popover]").popover(); });</script>`我的 HTML 文件。同样，这并不是真正的优先事项。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-09T07:07:18.483

```
// Universal Popupover Outside Click Close Method :)
jQuery(document).mouseup(function(e){ 
    var popocontainer = jQuery(".popover");
    if (popocontainer.has(e.target).length === 0){
        jQuery('.popover').toggleClass('in').remove();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T00:07:38.107

侦听冒泡到文档的单击事件，并确定它的目标是否在弹出框内。如果没有，则隐藏它：

```
var popover = $('#someEl').popover(options);

$(document).on('click',function(e) {
   var src = $(e.target);

   if(src.hasClass('popover') || src.closest('popover').length) {
     $('#someEl').popover('hide');
   }
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-08T00:01:43.307

解决方案都在 API 中提供。 [http://twitter.github.com/bootstrap/javascript.html#popovers](http://twitter.github.com/bootstrap/javascript.html#popovers)

看看`options/trigger`和方法：`.popover('hide')`

至于不从脚本文件运行，如果您将代码包装在`ready`处理程序中并且您的脚本文件是在 bootstrap.js 之后加载的，那么没有理由不应该这样做。使用浏览器控制台检查错误

# mysql - ResultSet 关闭后不允许操作 VendorError:0

> ID：14205922
> 
> 赞同：0
> 
> 时间：2013-01-07T23:31:21.210
> 
> 标签：mysql, jdbc

下面的代码显示错误：**ResultSet 关闭后不允许操作** 我还没有关闭任何结果集仍然显示错误。我在另一个 ResultSet 中使用一个 ResultSet，这会导致问题吗？

```
int n=li10.getSelectedIndex();
    final String n1=(String) dl10.elementAt(n);
    String n2=t52.getText();
    String n3="Select Budget,Count1 FROM User Where U_Name=' "+n2+"'";
    String n4="Select Price From Player_Attributes Where Player_Name='"+n1+"'";
    try{
    Connection con=DriverManager.getConnection("jdbc:mysql://127.0.0.1/BFPL","root","ilovepepsi");
    Statement st=con.createStatement();
    ResultSet rs1=st.executeQuery(n4);
    ResultSet rs=st.executeQuery(n3);
    while(rs1.next()){
    int pr=rs1.getInt("Price");
    while(rs.next()){
    int f=rs.getInt("Budget");
    int f1=rs.getInt("Count1");
    if(f1>0 && pr<f ){
    try{
    Connection con5=DriverManager.getConnection("jdbc:mysql://127.0.0.1/BFPL","root","ilovepepsi");
    PreparedStatement st2=con5.prepareStatement("Update User_Team Set Player"+f1+"=? Where User_Name='"+n2+"'");
    st2.setString(1,n1);
    st2.executeUpdate();
    JOptionPane.showMessageDialog(p13,"Table is updated");
    }
    catch(SQLException ae){
    System.out.println("SQLException:"+ae.getMessage());
    System.out.println("SQLState:"+ae.getSQLState());
    System.out.println("VendorError:"+ae.getErrorCode());
    JOptionPane.showMessageDialog(p13,"Error in submitting data!");
    }
    f1=f1-1;
    f=f-pr;
    try{
    Connection con4=DriverManager.getConnection("jdbc:mysql://127.0.0.1/BFPL","root","ilovepepsi");
    PreparedStatement st1=con4.prepareStatement("Update User Set Budget=? Count1=? Where U_Name='"+n2+"'");
    st1.setInt(1,f);
    st1.setInt(2,f1);
    st1.executeUpdate();
    con4.close();
    JOptionPane.showMessageDialog(p13,"Data is successfully inserted in database");
    }
    catch(SQLException ae){
    System.out.println("SQLException:"+ae.getMessage());
    System.out.println("SQLState:"+ae.getSQLState());
    System.out.println("VendorError:"+ae.getErrorCode());
    JOptionPane.showMessageDialog(p13,"Error in submitting data!");
    }

    }
    else{

    JOptionPane.showMessageDialog(p13,"Either your budget is not sufficient or you have reached maximum limit of buying players");

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T00:37:54.773

每个语句只能打开一个结果集。因此，如果您在同一个语句中打开另一个，那么之前打开的任何一个都将被隐式关闭。如果您仍然尝试访问它，那么将抛出这个异常。

您的问题基本上有两种解决方案：

1.  在同一个连接上创建 2 个语句，并让它们各自打开一个结果集。

2.  将 2 个松散的 SQL 查询重写并合并为一个 SQL 查询，*准确*返回所需的结果，这样您就不需要创建多个语句。[SQL JOIN 子句](http://beginner-sql-tutorial.com/sql-joins.htm)可能会派上用场。

* * *

**与具体问题无关**，您的代码中还有另一个主要问题。它正在泄漏数据库资源。您没有明确关闭*所有*迄今为止打开的连接、语句和结果集，甚至没有在`finally`块中。另请参阅[在 JDBC 中应多久关闭一次连接、语句和结果集？](https://stackoverflow.com/questions/5602772/how-often-should-statement-and-resultset-objects-be-closed-in-jdbc/5602821#5602821).

# iphone - Cocos2d UITableView 编辑按钮显示但不显示删除图标

> ID：14205923
> 
> 赞同：2
> 
> 时间：2013-01-07T23:31:22.780
> 
> 标签：iphone, xcode, uitableview, cocos2d-iphone

好的，所以我的项目（确实有 Cocos2d）有 3 个 UITableView。到目前为止，我只关心第一个，这就是为什么我只粘贴第一个的代码。问题是，每当我使用该应用程序时，都会显示表格视图，其中包含所有内容。编辑/完成按钮也显示在右上角。但是，每当我尝试点击编辑按钮时，按钮会切换到完成，但单元格附近没有删除图标，我也无法删除单元格。我尝试了很多解决方案，但似乎没有一个有效。提前致谢。

```
-(id)init{
if (self == [super init]) {
    // Create initialized instance of UITabBarController
    tabController = [[UITabBarController alloc] init];
    // Create initialized instance of NSMutableArray to hold our UINavigationControllers
    tabArray = [[NSMutableArray alloc] init];

    // Create first UIViewController
    questionController = [[UIViewController alloc] init];
    [self makeQuestionTable];
    [questionController setTitle:@"Question"];
    // Initialize the UINavigationController
    navigationController = [[UINavigationController alloc] initWithRootViewController:questionController];
    questionController.navigationItem.rightBarButtonItem = questionController.editButtonItem;
    questionTableView.allowsSelection = YES;
    questionTableView.allowsMultipleSelectionDuringEditing = YES;
    questionTableView.allowsSelectionDuringEditing = YES;
    // Add UINavigationController to you tabs
    [tabArray addObject:navigationController];
    // Release UIViewController and UINavigationController
    [questionController release], [navigationController release];

    // Create second UIViewController
    answerController = [[UIViewController alloc] init];
    [self makeAnswerTable];
    [answerController setTitle:@"Answer"];
    // Initialize the UINavigationController
   navigationController = [[UINavigationController alloc] initWithRootViewController:answerController];
    // Add UINavigationController to you tabs
    [tabArray addObject:navigationController];
    // Release UIViewController and UINavigationController
    [answerController release], [navigationController release];

    // Create third UIViewController
    colorController = [[UIViewController alloc] init];
    [self makeColorTable];
    [colorController setTitle:@"Color"];
    // Initialize the UINavigationController
    navigationController = [[UINavigationController alloc] initWithRootViewController:colorController];
    // Add UINavigationController to you tabs
    [tabArray addObject:navigationController];
    // Release UIViewController and UINavigationController
    [colorController release], [navigationController release];

    // Add the tabs to the UITabBarController
    [tabController setViewControllers:tabArray];
    // Add the view of the UITabBarController to the window
    [[[CCDirector sharedDirector]view]addSubview:tabController.view];
}
return self;
}
-(void)setEditing:(BOOL)editing animated:(BOOL)animated{

[questionTableView setEditing:editing animated:animated];
[questionController setEditing:editing animated:animated];

}
-(void)makeQuestionTable{
questionTableView = [[UITableView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)          style:UITableViewStylePlain];
questionTableView.backgroundColor = [UIColor whiteColor];
questionTableView.delegate = self;
questionTableView.dataSource = self;
questionTableView.tag = 1;
[questionTableView reloadData];
[questionController.view addSubview:questionTableView];
}

-(void)makeAnswerTable{
answerTableView = [[UITableView alloc] initWithFrame:CGRectMake(0, 0, 320, 400)     style:UITableViewStylePlain];
answerTableView.backgroundColor = [UIColor whiteColor];
answerTableView.delegate = self;
answerTableView.dataSource = self;
answerTableView.tag = 2;
[answerTableView reloadData];
[answerController.view addSubview:answerTableView];

}

-(void)makeColorTable{

colorTableView = [[UITableView alloc] initWithFrame:CGRectMake(0, 0, 320, 400) style:UITableViewStylePlain];
colorTableView.backgroundColor = [UIColor whiteColor];
colorTableView.delegate = self;
colorTableView.dataSource = self;
colorTableView.tag = 3;
[colorTableView reloadData];
[colorController.view addSubview:colorTableView];
}
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
  if (currentTab == 1) {
    return [appDelegate.questionArray count];
}
else if (currentTab == 2) {
    return [appDelegate.answerArray count];
}
else if (currentTab == 3) {
    return [appDelegate.colorArray count];
}
else{
    return 0;
}
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath     *)indexPath
{
if (tableView.tag == 1) {

static NSString *simpleTableIdentifier = @"SimpleTableItem";

UITableViewCell *cell = [tableView     dequeueReusableCellWithIdentifier:simpleTableIdentifier];

if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:simpleTableIdentifier];
}
cell.textLabel.text = [appDelegate.questionArray objectAtIndex:indexPath.row];
    return cell;
    NSLog(@"Question");
}
if(tableView.tag == 2){

    static NSString *simpleTableIdentifier = @"SimpleTableItem";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:simpleTableIdentifier];
    }
    cell.textLabel.text = [appDelegate.answerArray objectAtIndex:indexPath.row];
    return cell;
    NSLog(@"Answer");
}
if(tableView.tag == 3){

    static NSString *simpleTableIdentifier = @"SimpleTableItem";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:simpleTableIdentifier];
    }
    cell.textLabel.text = [appDelegate.colorArray objectAtIndex:indexPath.row];
    return cell;
    NSLog(@"Color");
}
}
- (UITableViewCellEditingStyle)tableView:(UITableView*)tableView
       editingStyleForRowAtIndexPath:(NSIndexPath*)indexPath {
UITableViewCell *cell = [questionTableView cellForRowAtIndexPath:indexPath];
if ([cell isEditing]) {
    NSLog(@"YES");
}
else{
    NSLog(@"NO");
}
return UITableViewCellEditingStyleDelete;
}
// This only needs to be implemented if you are going to be returning NO
// for some items. By default, all items are editable.
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath     {
// Return YES if you want the specified item to be editable.
return YES;
}

// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:    (UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {
if (editingStyle == UITableViewCellEditingStyleDelete) {
    //add code here for when you hit delete
    [questionTableView delete:indexPath];
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T09:18:26.273

将 tableView 的属性“编辑”设置为“是”。像：

```
questionTableView.editing = YES; 
```

删除这一行：

```
questionTableView.allowsMultipleSelectionDuringEditing = YES; 
```

或`allowsMultipleSelectionDuringEditing`选择时设置为“否”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T09:29:03.820

在您的`edit`按钮操作中，您需要提供`setEditing`as `YES`。

```
[tableView setEditing:YES animated:YES]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T03:29:25.593

你之前错过了几个右花括号`- (void)setEditing`，你的 init 方法不应该`return self;`

# ios - 离线时如何在iOS模拟器上模拟位置？

> ID：14205927
> 
> 赞同：1
> 
> 时间：2013-01-07T23:31:42.507
> 
> 标签：ios, location, mkmapview, ios-simulator

我想在没有互联网连接的情况下离线时在 iOS 模拟器上模拟位置。

我创建了一个包含 的 iOS 应用程序`MKMapView`，并设置：

```
MKMapView.userTrackingMode = MKUserTrackingModeFollow 
```

在模拟器中显示我的位置。为了修复调试位置，我在模拟器中定义了一个自定义位置。当我在线时，它工作正常。但是当我离线时，模拟器无法显示自定义位置，而是继续在控制台中打印以下消息。如何解决？

获取位置偏移功能失败：

`Error Domain=kCFErrorDomainCFNetwork Code=-1009 "The Internet connection appears to be offline." UserInfo=0xae83fb0 {NSErrorFailingURLKey=https://gsp13-cn.ls.apple.com/shift, NSErrorFailingURLStringKey=https://gsp13-cn.ls.apple.com/shift, NSLocalizedDescription=The Internet connection appears to be offline.}`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T04:06:25.000

SAE 是正确的。需要说明的是：地图应该显示一个蓝点，指示您的模拟位置，但错误消息是指无法查看该位置周围的地图，因为 mapView 无法下载所需的信息（即地图图块）。

# ruby-on-rails - activerecord 内存共享缓存

> ID：14205928
> 
> 赞同：6
> 
> 时间：2013-01-07T23:31:45.000
> 
> 标签：ruby-on-rails, sqlite, jruby, rails-activerecord, in-memory-database

可以通过activerecord使用sqlite3的“共享缓存”吗？（见：[http](http://www.sqlite.org/inmemorydb.html) ://www.sqlite.org/inmemorydb.html ）

我在 JRuby Swing 应用程序中使用独立的 activerecord（没有 rails），其中涉及一些工作线程。问题：只有主线程可以访问数据，因为每个线程都会重建一个新的内存数据库。所以我得到了

[SQLITE_ERROR] SQL 错误或缺少数据库（没有这样的表：insert_model_name）

来自任何地方，除了主线程。有解决方法还是我错过了什么？（我使用最新版本的 jruby、java 和 gems）

提前致谢！

到目前为止的数据库配置：[https ://gist.github.com/4482423](https://gist.github.com/4482423)

**更新：**说明问题的最小脚本。它在 Linux 下运行良好，但在 WINdows 7 下运行良好：[https ://gist.github.com/4483617](https://gist.github.com/4483617)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-03-07T16:48:11.380

以下令牌效果很好：
`"file::memory:?cache=shared"`
另外，请检查您的 SQLite 版本，它应该至少是 3.7.13 才能支持此功能。

# python - 为绘制列表的曲线下区域着色

> ID：14205930
> 
> 赞同：1
> 
> 时间：2013-01-07T23:32:21.543
> 
> 标签：python, matplotlib

我正在使用以下代码生成同时有几条曲线的图形：

```
for i in data.find():
    a=[]
    for element in i["counts"]:
        a.append(element["total"])
    plt.plot(a)

plt.show() 
```

我希望能够为每条曲线下的特定区域着色。比如说，对于曲线 1，区间 x:[3,21]、x:[28, 29] 和 x:[42, 51]

我相信我**不能**使用以下变体，因为 y 不是 x 的函数。y 只是一个整数列表。

```
plt.fill_between(x,y,0,color='0.8') 
```

有没有办法解决这个问题？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T00:14:06.497

`plt.plot(a)`等效[于](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.plot) `plt.plot(np.arange(len(a)),a)`，这样，您可以更轻松地了解如何使用[`fill_between`](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.fill_between)：

```
where = np.zeros(len(a),dtype=bool)
where[3:21] = True
plt.fill_between(np.arange(len(a)),a,where=where) 
```

作为旁注，

```
a=[]
for element in i["counts"]:
    a.append(element["total"]) 
```

通常写成列表理解更好：

```
a = [element['total'] for element in i['counts']] 
```

# ios - 在 iOS 应用程序的 UITableViewCell 内按下时无法更改按钮图像

> ID：14205932
> 
> 赞同：0
> 
> 时间：2013-01-07T23:32:42.690
> 
> 标签：ios, uitableview, uibutton

我有一个 UITableViewController 包含一个表格，我希望在其单元格中添加一个按钮。这是一个自定义按钮，将充当复选框，其中包含正常状态下的图像，以及用户选择它时具有的另一个图像。不幸的是，每当我按下它时，图像都不会改变状态，并且由于某种原因，它也没有调用目标方法。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
        cell.selectionStyle = UITableViewCellSelectionStyleNone;
    }

    // Configure the cell...
    TestObject *tObject = [myNSMutableArray objectAtIndex:indexPath.row];
    cell.textLabel.text = tObject.testTitle;

    testButton = [UIButton buttonWithType:UIButtonTypeCustom];
    [testButton setFrame:CGRectMake(280, 57, 25, 25)];
    [testButton setImage:[UIImage imageNamed:@"CheckBox1.png"] forState:UIControlStateSelected];
    [testButton setImage:[UIImage imageNamed:@"CheckBox2.png"] forState:UIControlStateNormal];
    [testButton setUserInteractionEnabled:YES];
    [testButton addTarget:self action:@selector(clickOnCheckButton:) forControlEvents:UIControlEventTouchUpInside];

    [cell addSubview:testButton];

    return cell;

} 
```

作为记录，我确实实现了该方法：

```
-(void)clickOnCheckButton:(id)sender {

    NSLog(@"button has been pressed");
} 
```

并确保拼写正确，这就是为什么我不明白为什么按下每个单元格中的按钮时没有调用该方法的原因。

我的表格输出的另一个问题是我的第一个单元格里面没有按钮。但是，它下面的所有其他单元格都可以。

谁能看到我做错了什么？

提前感谢所有回复的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T05:22:01.833

如果您使用单元格的`accessoryView`属性，您可以将其设置为自定义视图，就像您的按钮一样，它的设计目的就像一个按钮。然后，您可以选择使用该`UITableViewDelegate`方法`– tableView:accessoryButtonTappedForRowWithIndexPath:`来控制操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-05T04:22:48.420

您正在我们的项目中编写流动代码

```
(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    ObjectiveCcustTcell *cell=[tableView dequeueReusableCellWithIdentifier:@"cell" forIndexPath:indexPath];
   ObjctiveString *temp=[_arraymain objectAtIndex:indexPath.row];

    cell.labQutionNo.text=temp.qutNO;
    cell.labQution.text=temp.qution;
    cell.labAns.text=temp.ans;
    cell.labAns2.text=temp.ans2;
    cell.labAns3.text=temp.ans3;

[cell.ButAns1 setBackgroundImage:[UIImage imageNamed:temp.ansD1] forState:UIControlStateNormal];
[cell.ButAns2 setBackgroundImage:[UIImage imageNamed:temp.ansD2] forState:UIControlStateNormal];
[cell.ButAns3 setBackgroundImage:[UIImage imageNamed:temp.ansD3] forState:UIControlStateNormal];

     if(indexPath.row==0&&t==1)
        {
             [cell.ButAns1 setBackgroundImage:[UIImage imageNamed:@"select"] forState:UIControlStateNormal];
        }

    if(indexPath.row==1&&t==3)
            {

             [cell.ButAns1 setBackgroundImage:[UIImage imageNamed:@"select"] forState:UIControlStateNormal];
            }

    [cell.ButAns1 addTarget:self action:@selector(MEthodBut:)forControlEvents:UIControlEventTouchUpInside];
    [cell.ButAns2 addTarget:self action:@selector(MEthodBut2:) forControlEvents:UIControlEventTouchUpInside];
     [cell.ButAns3 addTarget:self action:@selector(MEthodBut3:) forControlEvents:UIControlEventTouchUpInside];

     [cell.ButAns1 setTag:indexPath.row];
     [cell.ButAns2 setTag:indexPath.row];
    [cell.ButAns3 setTag:indexPath.row];

    return cell;

}

-(void)MEthodBut:(UIButton *)sender
{

    UIButton *button = (UIButton *)sender;
    int row = (int)button.tag;

    if(row==0)
    {

        t=1;

[_tablemain reload];

    }
} 
```

# c# - 如何获取运行 Visual Studio 实例的 DTE？

> ID：14205933
> 
> 赞同：13
> 
> 时间：2013-01-07T23:32:43.957
> 
> 标签：c#, visual-studio

如何获取所有正在运行的 Visual Studio 实例以便进行自动化操作？

（添加了这个问题，因为[这个](https://stackoverflow.com/questions/14186330/get-current-visual-studio-instance-envdte-in-c-sharp/14186555#14186555)问题已关闭）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-07T23:32:43.957

使用运行对象表获取所有实例，然后选择所需的一个。

我不认为你能做得比这更好。它类似于将调试器附加到 VS 实例的方式。您必须从列表中选择一个。

```
IEnumerable<DTE> GetInstances()
{
    IRunningObjectTable rot;
    IEnumMoniker enumMoniker;
    int retVal = GetRunningObjectTable(0, out rot);

    if (retVal == 0)
    {
        rot.EnumRunning(out enumMoniker);

        IntPtr fetched = IntPtr.Zero;
        IMoniker[] moniker = new IMoniker[1];
        while (enumMoniker.Next(1, moniker, fetched) == 0)
        {
            IBindCtx bindCtx;
            CreateBindCtx(0, out bindCtx);
            string displayName;
            moniker[0].GetDisplayName(bindCtx, null, out displayName);
            Console.WriteLine("Display Name: {0}", displayName);
            bool isVisualStudio = displayName.StartsWith("!VisualStudio");
            if (isVisualStudio)
            {
               object obj;
               rot.GetObject(moniker[0], out obj);
               var dte = obj as DTE;
               yield return dte;
            }
        }
    }
}

[DllImport("ole32.dll")]
private static extern void CreateBindCtx(int reserved, out IBindCtx ppbc);

[DllImport("ole32.dll")]
private static extern int GetRunningObjectTable(int reserved, out IRunningObjectTable prot); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-23T16:09:51.107

下面是 VB.Net 获取当前 Visual Studio 实例的解决方案。

我所做的是与使用当前程序集名称进行调试的进程进行简单的字符串比较。当打开多个 VS 实例时，它似乎按预期工作，我在 Visual Studio 2013 中以调试和发布模式进行了尝试。

进口：

```
Imports System
Imports System.Diagnostics.CodeAnalysis
Imports System.Runtime.InteropServices
Imports System.Runtime.InteropServices.ComTypes
Imports EnvDTE80 
```

P/调用：

(NativeMethods.dll)

```
''' ----------------------------------------------------------------------------------------------------
''' <summary>
''' Returns a pointer to an implementation of <see cref="IBindCtx"/> (a bind context object).
''' <para></para>
''' This object stores information about a particular moniker-binding operation.
''' </summary>
''' ----------------------------------------------------------------------------------------------------
''' <remarks>
''' <see href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms678542%28v=vs.85%29.aspx"/>
''' </remarks>
''' ----------------------------------------------------------------------------------------------------
''' <param name="reserved">
''' This parameter is reserved and must be 0.
''' </param>
''' 
''' <param name="ppbc">
''' Address of an <see cref="IBindCtx"/> pointer variable that receives the 
''' interface pointer to the new bind context object.
''' <para></para>
''' When the function is successful, the caller is responsible for calling Release on the bind context.
''' <para></para>
''' A value of <see langword="Nothing"/> for the <paramref name="ppbc"/> value indicates that an error occurred.
''' </param>
''' ----------------------------------------------------------------------------------------------------
''' <returns>
''' This function can return the standard return values <c>E_OUTOFMEMORY</c> and <c>S_OK</c>.
''' </returns>
''' ----------------------------------------------------------------------------------------------------
<SuppressMessage("Microsoft.Interoperability", "CA1401:PInvokesShouldNotBeVisible", justification:="Assembly Reference")>
<DllImport("ole32.dll")>
Public Shared Function CreateBindCtx(ByVal reserved As Integer,
                                     ByRef ppbc As IBindCtx
) As Integer
End Function

''' ----------------------------------------------------------------------------------------------------
''' <summary>
''' Returns a pointer to the <see cref="IRunningObjectTable"/> interface on the local running object table (ROT).
''' </summary>
''' ----------------------------------------------------------------------------------------------------
''' <remarks>
''' <see href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms684004%28v=vs.85%29.aspx"/>
''' </remarks>
''' ----------------------------------------------------------------------------------------------------
''' <param name="reserved">
''' This parameter is reserved and must be 0.
''' </param>
''' 
''' <param name="pprot">
''' The address of an <see cref="IRunningObjectTable"/> pointer variable that receives the 
''' interface pointer to the local ROT.
''' <para></para>
''' When the function is successful, the caller is responsible for calling Release on the interface pointer.
''' <para></para>
''' A value of <see langword="Nothing"/> for the <paramref name="pprot"/> value indicates that an error occurred.
''' </param>
''' ----------------------------------------------------------------------------------------------------
''' <returns>
''' This function can return the standard return values <c>E_UNEXPECTED</c> and <c>S_OK</c>.
''' </returns>
''' ----------------------------------------------------------------------------------------------------
<SuppressMessage("Microsoft.Interoperability", "CA1401:PInvokesShouldNotBeVisible", justification:="Assembly Reference")>
<DllImport("ole32.dll")>
Public Shared Function GetRunningObjectTable(ByVal reserved As Integer,
                                             ByRef pprot As IRunningObjectTable
) As Integer
End Function 
```

其余代码：

```
''' ----------------------------------------------------------------------------------------------------
''' <summary>
''' Gets a collection of the Visual Studio instances that are running on this PC.
''' </summary>
''' ----------------------------------------------------------------------------------------------------
''' <returns>
''' An <see cref="IEnumerable(Of DTE2)"/> that contains the running Visual Studio instances, if any.
''' </returns>
''' ----------------------------------------------------------------------------------------------------
Public Shared Iterator Function GetVisualStudioInstances() As IEnumerable(Of DTE2)

    Dim rot As IRunningObjectTable = Nothing
    Dim enumMoniker As IEnumMoniker = Nothing
    Dim retVal As Integer = NativeMethods.GetRunningObjectTable(0, rot)

    If (retVal = 0) Then

        rot.EnumRunning(enumMoniker)

        Dim fetched As IntPtr = IntPtr.Zero
        Dim moniker As IMoniker() = New IMoniker(0) {}

        While (enumMoniker.Next(1, moniker, fetched) = 0)

            Dim bindCtx As IBindCtx = Nothing
            NativeMethods.CreateBindCtx(0, bindCtx)

            Dim displayName As String = ""
            moniker(0).GetDisplayName(bindCtx, Nothing, displayName)

            If (displayName.StartsWith("!VisualStudio")) Then
                Dim obj As New Object
                rot.GetObject(moniker(0), obj)
                Yield DirectCast(obj, DTE2)
            End If

        End While

    End If

End Function

''' ----------------------------------------------------------------------------------------------------
''' <summary>
''' Gets a <see cref="DTE2"/> object that represents the current Visual Studio instance that is running this project.
''' </summary>
''' ----------------------------------------------------------------------------------------------------
''' <returns>
''' A <see cref="DTE2"/> object that represents the current Visual Studio instance that is running this project.
''' </returns>
''' ----------------------------------------------------------------------------------------------------
Public Shared Function GetCurrentVisualStudioInstance() As DTE2

    Dim currentInstance As DTE2 = Nothing
    Dim processName As String = Process.GetCurrentProcess.MainModule.FileName
    Dim instances As IEnumerable(Of DTE2) = GetVisualStudioInstances

    For Each instance As DTE2 In instances

        For Each p As EnvDTE.Process In instance.Debugger.DebuggedProcesses

            If (p.Name = processName) Then
                currentInstance = instance
                Exit For
            End If

        Next p

    Next instance

    Return currentInstance

End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-06T04:15:53.373

Powershell 5.1 示例，除了 Visual Studio 2019 没有安装，没有导入等。

[https://github.com/jefflomax/visual-studio-dte-utilities/blob/main/getDteBySolutionName.ps1](https://github.com/jefflomax/visual-studio-dte-utilities/blob/main/getDteBySolutionName.ps1)

# facebook-graph-api - 无效的 API 密钥异常 Facebook Php Sdk FQL

> ID：14205935
> 
> 赞同：1
> 
> 时间：2013-01-07T23:32:46.537
> 
> 标签：facebook-graph-api, exception, facebook-fql, facebook-php-sdk

这段代码：

```
 $fql2 = "SELECT uid, name FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = xxxxxxxxx)";

$params = array(
    'method' => 'fql.query',
    'access_token' => $user->accessToken,
    'query' => $fql2,
    'callback'  => ''
);

$result = $facebook->api($params);
var_dump($result); 
```

给我错误：`Uncaught Exception: 101: Invalid API key`

我的 appId 和 secret 是正确的。我已经通过执行`$facebook->api('/me')`which 工作正常来检查它。我的访问令牌也很好，具有所有必需的权限。我尝试调用 api 来执行 fql 查询的方式存在一些问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-05T16:07:41.453

我认为你必须写 `$user->getAccessToken();`

# paypal - 10001 paypal 内部错误：超时处理请求 Express Checkout

> ID：14205936
> 
> 赞同：8
> 
> 时间：2013-01-07T23:32:51.973
> 
> 标签：paypal, express-checkout

首先，我没有商业帐户，所以如果这是问题，请告诉我，因为几乎不可能在他们的官方网站上找到 Paypal Express Checkout 的要求。

我的这个 API 的代码是：

```
$requestParams = array(
     'METHOD' => $method,
     'VERSION' => $this -> _version,
     'USER' => $PayPalApiUsername,
     'PWD' => $PayPalApiPassword,
     'SIGNATURE' => $PayPalApiSignature
);

$request = array_merge($requestParams, $params);
//$params is bringed from other php.

$ch = curl_init();
  curl_setopt($ch,CURLOPT_URL ,'https://api-3t.paypal.com/nvp');
  curl_setopt($ch,CURLOPT_VERBOSE ,1);
  curl_setopt($ch,CURLOPT_SSL_VERIFYPEER ,false);
  curl_setopt($ch,CURLOPT_SSL_VERIFYHOST ,false);
  curl_setopt($ch,CURLOPT_RETURNTRANSFER ,1);
  curl_setopt($ch,CURLOPT_HTTPGET ,true);
  curl_setopt($ch,CURLOPT_POSTFIELDS ,$request);

$response = curl_exec($ch); 
```

然后，直到这里（我认为）没问题。但是做一些检查，这是我用 $request 发送的：

```
$request: array(16) {
["METHOD"]=>
string(18) "SetExpressCheckout"
["VERSION"]=>
string(4) "97.0"
["USER"]=>
string(27) "xxx_api1.example.com"
["PWD"]=>
string(16) "yyyyyyyyyyyyyyyy"
["SIGNATURE"]=>
string(56) "zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz"
["RETURNURL"]=>
string(50) "http%3A%2F%2Fwww.website.com%2Fcontinue.php"
["CANCELURL"]=>
string(53) "http%3A%2F%2Fwww.website.com%2Fpaypal%2Fcancel_url.php"
["PAYMENTREQUEST_0_AMT"]=>
string(5) "10.95"
["PAYMENTREQUEST_0_CURRENCYCODE"]=>
string(3) "EUR"
["PAYMENTREQUEST_0_ITEMAMT"]=>
string(5) "10.95"
["PAYMENTREQUEST_0_SELLERPAYPALACCOUNTID"]=>
string(24) "xxx%40example.com"
["PAYMENTREQUEST_0_PAYMENTACTION"]=>
string(4) "Sale"
["L_PAYMENTREQUEST_0_NAME0"]=>
string(17) "ProductA"
["L_PAYMENTREQUEST_0_AMT0"]=>
string(5) "10.95"
["L_PAYMENTREQUEST_0_QTY0"]=>
string(1) "1"
["L_PAYMENTREQUEST_0_NUMBER0"]=>
string(1) "1"
} 
```

这是我从 Paypal 收到的：

```
$response: 
TIMESTAMP=2013%2d01%2d07T23%3a20%3a43Z
CORRELATIONID=7a8130fb32e44
ACK=Failure
L_ERRORCODE0=10001
L_SHORTMESSAGE0=Internal%20Error
L_LONGMESSAGE0=Timeout%20processing%20request 
```

有谁知道这里发生了什么？这是错的吗？首要帐户是这里的问题吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-08T16:51:39.843

**解决方案：**

我用这个解决了这个问题：

**避免**使用**“urlencode()”**对参数进行编码，正常保存数据。

例子：

```
array(
   'RETURNURL' => 'http://www.yourwebsite.com/confirm.php', //without urlencode()
   'CANCELURL' => 'http://www.yourwebsite.com/cancel.php'  //without urlencode()
); 
```

**在通过“Curl”发送之前**使用 http_build_query($request) ，如下所示：****

 **```
curl_setopt($ch,CURLOPT_POSTFIELDS , http_build_query($request)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-25T21:48:21.410

我遇到了同样的错误，但是我的问题是卡到期日期的格式错误。我收到的错误是由我过去的日期引起的。它的格式不正确。它必须是“032018”而不是“3/2018”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T23:35:52.170

您绝不会将您的返回网址作为带有下划线的子域，对吗？**

# javascript - 从带有节点作为参数的 SVG 中选择会引发 DOM 异常 12

> ID：14205940
> 
> 赞同：1
> 
> 时间：2013-01-07T23:33:07.320
> 
> 标签：javascript, dom, d3.js

我不知道是什么导致了 DOM 异常 12。我能找到的一点是它与无效的选择器有关吗？

背景：

我们有一个散点图，它是一个 SVG 对象，里面有很多圆圈。

当您将鼠标悬停在一个圆圈上时，我们希望能够访问它所代表的数据以显示工具提示。

目前我们正在通过主干监听事件（散点图属于更大的应用程序），因此我们可以通过`e.currentTarget`.

在第一次通过时，我们只是做了

```
d3.select(e.currentTarget) // from here we can access the datum() method 
```

但是由于我们现在想使用 VML 兼容层[r2d3](https://github.com/mhemesath/r2d3/)，需要注意的是，如果我们想选择 SVG 中的元素，我们必须从 svg 中选择。

> 对 SVG 元素的查询必须来自 SVG 节点。示例使用 svg.select('rect') NOT d3.select('rect')

`this.svg`我们可以通过悬停事件访问 D3 包装的 SVG 元素。但是，当我打电话时：

```
this.svg.select(e.currentTarget) 
```

我得到一个 DOM 异常 12。

```
Uncaught Error: SYNTAX_ERR: DOM Exception 12
    d3_select d3.v2.js:3578
    (anonymous function) d3.v2.js:372
    d3_selectionPrototype.select d3.v2.js:3606
    Backbone.View.extend.mouseEnterBin graph.js:828
    jQuery.each.jQuery.event.special.(anonymous function).handle jquery-1.7.2.js:3616
    jQuery.event.dispatch jquery-1.7.2.js:3332
    jQuery.event.add.elemData.handle.eventHandle 
```

当我`debugger;`在尝试选择之前添加一行时，我可以 this.svg.selectAll('circle') 并确认该节点`e.currentTarget`确实存在于该集中。

任何建议或帮助表示赞赏，感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T00:13:03.663

选择器参数`selection.select(selector)`必须是字符串（例如'circle'）或函数。在您的情况下，它似乎是一个 DOM 节点。

请参阅[https://github.com/mbostock/d3/wiki/Selections#wiki-select](https://github.com/mbostock/d3/wiki/Selections#wiki-select)：

> 对于当前选择中的每个元素，选择与指定选择器字符串匹配的第一个后代元素。...
> 
> 选择器也可以指定为返回元素的函数，如果没有匹配的元素，则为 null。...

如果您有权访问某个节点，则可以使用`d3.select(node)`(https://github.com/mbostock/d3/wiki/Selections#wiki-d3_select) 将其转换为 d3 选择。

根据您的描述，您似乎只是想从 e.currentTarget 创建一个 D3 选择；这样`d3.select(e.currentTarget)`就足够了。

# python - 如何在 Python 中使用 PCA/SVD 进行特征选择和识别？

> ID：14205941
> 
> 赞同：3
> 
> 时间：2013-01-07T23:33:07.057
> 
> 标签：python, scipy, pca

我正在遵循Python 中的[主成分分析以在 Python](https://stackoverflow.com/questions/1730600/principal-component-analysis-in-python)下使用 PCA，但我正在努力确定要选择*哪些*功能（即我的哪些列/功能具有最佳方差）。

当我使用`scipy.linalg.svd`时，它会自动对我的奇异值进行排序，所以我无法分辨它们属于哪一列。

示例代码：

```
import numpy as np
from scipy.linalg import svd
M = [
     [1, 1, 1, 1, 1, 1],
     [3, 3, 3, 3, 3, 3],
     [2, 2, 2, 2, 2, 2],
     [9, 9, 9, 9, 9, 9]
]
M = np.transpose(np.array(M))
U,s,Vt = svd(M, full_matrices=False)
print s 
```

如果不对奇异值进行排序，是否有不同的方法来解决这个问题？

**更新：**看起来这可能是不可能的，至少根据 Matlab 论坛上的这篇文章：http: [//www.mathworks.com/matlabcentral/newsreader/view_thread/241607](http://www.mathworks.com/matlabcentral/newsreader/view_thread/241607)。如果有人知道，请告诉我:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:26:59.870

我的错误印象是 PCA 进行了*特征选择*，而相反它进行了*特征提取*。

相反，PCA 创建了一系列新的特征，每个特征都是输入特征的组合。

从 PCA 中，如果您真的想做*特征选择*，您可以查看输入特征在 PCA 创建的特征上的权重。例如，`matplotlib.mlab.PCA`库在属性中提供权重（[更多关于库](http://www.clear.rice.edu/comp130/12spring/pca/pca_docs.shtml#a)）：

```
from matplotlib.mlab import PCA
res = PCA(data)
print "weights of input vectors: %s" % res.Wt 
```

听起来*特征提取*路线是使用 PCA 的方式。

# clojure - 序列的最大值，其值由 key 函数确定，其中 key 返回一个向量

> ID：14205943
> 
> 赞同：2
> 
> 时间：2013-01-07T23:33:19.293
> 
> 标签：clojure

继续我使用 Udacity 的基于 python 的 CS212 并转换为 Clojure 的旅程，我正在尝试编写一个函数：

1.  返回序列中的所有项目，
2.  等于序列的最大值，
3.  使用返回向量的“键”函数

Clojure 的[max-key 函数](http://clojuredocs.org/clojure_core/clojure.core/max-key#source)几乎做到了这一点，除了它需要我的键返回一个整数，在这种情况下我不需要——我返回一个向量。通过一些修改，我可以使用 compare 函数来比较我的键控函数返回的向量：

```
(defn all-max-key
  "Returns a vector of x for which (k x), arbitrated by compare, are greatest."
  ([k x] x)
  ([k x y] (if (= 1 (compare (k x) (k y))) x y))
  ([k x y & more]
     (reduce #(all-max-key k %1 %2) (all-max-key k x y) more))) 
```

现在，问题是这不考虑关系（比较返回 0）。换句话说，我列表中的所有元素都是唯一的，但根据我的键控功能，有些元素可能具有相同的值。在命令式世界中，我可能会遍历列表，跟踪我的最大值，将每个元素与其进行比较，然后在执行过程中附加/替换一个可变列表。

但我觉得必须有一种惯用的、优雅的、实用的方式来做到这一点，而无需求助于循环。我使用 reduce 的尝试都导致将序列与成员元素进行无意义的比较。任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T23:59:30.103

这将返回最大项的向量：

```
(defn maximal-key [k x & xs]
  (reduce (fn [ys x]
            (let [c (compare (k x) (k (peek ys)))]
              (cond
                (pos? c) [x]
                (neg? c) ys
                :else    (conj ys x))))
          [x]
          xs)) 
```

在 REPL 进行测试：

```
;; convoluted key function to demonstrate that vector keys are fine
user> (maximal-key #(vector (first %))
                    (list 1 2 3) (list 4 5 6) (list 3 6 8)
                    (list 4 7 9) (list 1 5 9))
[(4 5 6) (4 7 9)] 
```

请注意，它`compare`可能会返回一个任意正整数以指示其第一个参数大于第二个参数 - 因此`pos?`代替`== 1`.

# facebook-graph-api - 如何在应用程序中的 Facebook 中设置上传照片的权限？

> ID：14205945
> 
> 赞同：1
> 
> 时间：2013-01-07T23:33:26.883
> 
> 标签：facebook-graph-api, image-uploading, restfb

如何设置 facebook 上的应用程序能够发送图片？我有 access_token、APP_ID 和 secret_id 但是当你调用这个方法的应用程序时：

```
FacebookType publishPhotoResponse = facebookClient.publish("me/photos", FacebookType.class,
      BinaryAttachment.with("albumID", bs),
      Parameter.with("message", "description")); 
```

得到这个错误：

```
com.restfb.exception.FacebookNetworkException: A network error occurred while trying to communicate with Facebook: Facebook request failed (HTTP status code null) 
```

有人可以解释如何在facebook应用程序上一一设置吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T09:17:49.140

如果您需要请求扩展权限，可以按照此处的[指南进行操作。](http://pulkitgoyal.in/2013/01/09/requesting-extended-permissions-facebook-sdk-android/)从帖子：

让我们首先定义我们需要什么权限

```
// List of additional write permissions being requested
private static final List<String> PERMISSIONS = Arrays.asList("publish_stream, publish_actions");

// Request code for reauthorization requests. 
private static final int REAUTH_ACTIVITY_CODE = 100; 

// Flag to represent if we are waiting for extended permissions
private boolean pendingAnnounce = false; 
```

我们将首先检查我们是否拥有所有必需的权限。如果没有，我们使用我们请求的权限集创建一个新的 ReauthorizeRequest。这会将我们应用之外的用户引导至 Facebook 应用或浏览器以确认权限。当用户确认请求时，他将被重定向回我们的应用程序，并调用调用重新授权请求的 Activity 的 onActivityResult。

```
private void handleAnnounce() {
    pendingAnnounce = false;
    Session session = Session.getActiveSession();

    if (session == null || !session.isOpened()) {
        return;
    }

    List<String> permissions = session.getPermissions();
    if (!permissions.containsAll(PERMISSIONS)) {
        pendingAnnounce = true; // Mark that we are currently waiting for confirmation of publish permissions 
        session.addCallback(this); 
        requestPublishPermissions(this, session, PERMISSIONS, REAUTH_ACTIVITY_CODE);
        return;
    }

    // TODO: Publish the post. You would need to implement this method to actually post something
    publishMessage();
}

void requestPublishPermissions(Activity activity, Session session, List<String> permissions,
    int requestCode) {
    if (session != null) {
        Session.ReauthorizeRequest reauthRequest = new Session.ReauthorizeRequest(activity, permissions)
            .setRequestCode(requestCode);
        session.reauthorizeForPublish(reauthRequest);
    }
} 
```

如果会话状态发生变化，这将处理结果并调用 onSessionStateChanged。然后，如果我们的令牌已成功更新，我们将检查该方法并尝试再次发布消息。

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    switch (requestCode) {
    case REAUTH_ACTIVITY_CODE:
        Session session = Session.getActiveSession();
        if (session != null) {
            session.onActivityResult(this, requestCode, resultCode, data);
        }
        break;
    }
}
protected void onSessionStateChange(final Session session, SessionState state, Exception exception) {
    if (session != null && session.isOpened()) {
        if (state.equals(SessionState.OPENED_TOKEN_UPDATED)) {
            // Session updated with new permissions
            // so try publishing once more.
            tokenUpdated();
        }
    }
}

/**
 * Called when additional permission request is copmleted successfuly.
 */
private void tokenUpdated() {
    // Check if a publish action is in progress
    // awaiting a successful reauthorization
    if (pendingAnnounce) {
        // Publish the action
        handleAnnounce();
    }
} 
```

# java - CXF 和多个 servlet 映射

> ID：14205947
> 
> 赞同：7
> 
> 时间：2013-01-07T23:33:54.673
> 
> 标签：java, spring, jax-ws, cxf, jax-rs

目前我们有一个带有 Spring MVC DispatcherServlet 和两个 CXFServlet 的 Java webapp。DispatcherServlet 是默认的 servlet（映射`/`），一个 CXFServlet 映射到`/api/*`，另一个映射到`/services/*`。

困扰我的是，如果没有映射到 CXFServlet ，似乎不可能有 1 个 CXFServlet 托管 2 个服务，一个 on`/api/v0`一个 on 。如果这是可能的，它将节省另一个 servlet 实例的初始化时间、配置麻烦和内存需求。`/services/myService``/*`

所以基本上，我的问题是，是否有人知道在 1 个 CXFServlet 中的 2 个 URL 上托管 2 个 CXF 服务的方法，没有通用的基本/根 URL，最好使用 Spring 命名空间配置，而不映射`/*`到 CXFServlet？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T18:05:30.427

[CXF ServletController](http://svn.apache.org/repos/asf/cxf/trunk/rt/transports/http/src/main/java/org/apache/cxf/transport/servlet/ServletController.java)的`invoke`方法首先调用，它返回请求的 URL 中*没有*servlet 的部分。然后，此调用的结果将用于通过对 的调用来匹配任何已定义的服务。因此，目前不可能使用包含 servlet 部分的路径让 CXF 匹配服务 - CXF 从不调用这将需要的。`HttpServletRequest#getPathInfo`*`url-pattern``DestinationRegistry#getDestinationForPath``HttpServletRequest#getServletPath`*

 *请注意，`base-address`可以在 servlet 的初始化参数 ( `<init-param>`) 中设置的值只会影响 CXF*显示*的任何 URL ，因为`ServletController#getBaseURL`在服务调用期间不使用使用该值的方法。*

# mysql - 从子祖关系中的不同表中获取名称

> ID：14205948
> 
> 赞同：1
> 
> 时间：2013-01-07T23:34:00.563
> 
> 标签：mysql, parent-child

我有三张桌子：

```
CREATE TABLE category (id integer, parent_id integer);
CREATE TABLE category_name (id integer, name (varchar(20), language_id);
CREATE TABLE language (language_id integer, language_name); 
```

我可以通过以下语句获得子-父母-祖父母关系：

```
SELECT c.id, c.parent_id, p.parent_id 
FROM category AS p, category AS c 
WHERE p.id = c.parent_id AND p.parent_id IS NOT NULL; 
```

但是我还需要从表 category_name 中获取孩子、父母和祖父母的名字，其中 language_id = 3

在没有子-父母-祖父母关系的情况下，获取名称的查询将是这样的：

```
SELECT c.id, n.name
FROM category c
LEFT JOIN category_name n ON c.id = n.id AND language_ID = 3 
```

但是如何将这两个语句合并为一个，以便我实际上得到三个名称列呢？也就是说，每一行都应该有自己的 ID 和名称，它的父母和它的祖父母（如果后者存在的话）

如何继续进行此组合查询？

以下是表格和一些示例数据：

```
CREATE TABLE category (id integer, parent_id integer);
INSERT INTO category VALUES (1,null);
INSERT INTO category VALUES (2,null);
INSERT INTO category VALUES (3,1);
INSERT INTO category VALUES (4,2);
INSERT INTO category VALUES (5,2);
INSERT INTO category VALUES (6,4);
INSERT INTO category VALUES (7,2);
INSERT INTO category VALUES (8,7);
INSERT INTO category VALUES (9,7);
INSERT INTO category VALUES (10,7);
INSERT INTO category VALUES (11,3);

CREATE TABLE category_name (id integer, name varchar(20), language_id integer);
INSERT INTO category_name VALUES (1, 'CDs', 3);
INSERT INTO category_name VALUES (2, 'Books', 3);
INSERT INTO category_name VALUES (3, 'Music', 3);
INSERT INTO category_name VALUES (4, 'Novels', 3);
INSERT INTO category_name VALUES (5, 'Childrens books', 3);
INSERT INTO category_name VALUES (6, 'European', 3);
INSERT INTO category_name VALUES (7, 'Science', 3);
INSERT INTO category_name VALUES (8, 'Math', 3);
INSERT INTO category_name VALUES (9, 'Informatics', 3);
INSERT INTO category_name VALUES (10, 'Physics', 3);
INSERT INTO category_name VALUES (11, 'Classic', 3);
INSERT INTO category_name VALUES (1, 'CDs', 4);
INSERT INTO category_name VALUES (2, 'Livres', 4);
INSERT INTO category_name VALUES (3, 'Musique', 4);
INSERT INTO category_name VALUES (4, 'Romans', 4);

CREATE TABLE language (language_id integer, language_name varchar(15));
INSERT INTO language (3, 'English');
INSERT INTO language (4, 'French'); 
```

这是我想获取一些样本的方式（对于 c.id = 5 和 8）：

```
c.id | c.parent_id | p.parent_id | nameChild          | nameParent | nameGrandparent
5    | 2           | null        | 'Children's books' | 'Books'    | null
8    | 7           | 2           | 'Math'             | 'Science'  | 'Books' 
```

* * *

我尝试了以下代码，但它给出了错误代码：1054。“on 子句”中的未知列“p.parent_id”

```
SELECT c.id, c.parent_id, p.parent_id, nc.name, np.name, ng.name 
FROM category1 AS p, category1 AS c 
LEFT JOIN category_name1 AS nc ON c.id = nc.id AND nc.language_id = 3
LEFT JOIN category_name1 AS np ON c.parent_id = np.id AND np.language_id = 3
LEFT JOIN category_name1 AS ng ON p.parent_id = ng.id AND ng.language_id = 3 AND p.parent_id IS NOT NULL
WHERE p.id = c.parent_id AND p.parent_id IS NOT NULL; 
```

说出孩子和父母的名字我没有问题，但祖父母的名字似乎超出了我的掌握:(

下面是代码工作！

```
SELECT x.id, x.pid, x.gpid, 
nc.name childName, np.name parentName, ng.name gpName 
FROM 
(SELECT  c.id , c.parent_id AS pid, p.parent_id AS gpid
FROM
category AS c
LEFT JOIN category AS p ON p.id = c.parent_id
) x

LEFT JOIN category_name AS nc ON x.id = nc.id AND nc.language_id = 3
LEFT JOIN category_name AS np ON x.pid = np.id AND np.language_id = 3
LEFT JOIN category_name AS ng ON x.gpid = ng.id AND ng.language_id = 3; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T00:01:25.687

请尝试一下并发表评论。查询和结果都基于我自己的样本。

*   [SQLFIDDLE 演示](http://sqlfiddle.com/#!2/47f88/2)

此查询选择`language name`, `category name`with `language id =`something, group by `parent id`。

询问：

```
select l.language_name, cl.name, c.parent_id
from category c
left join 
category_name cl
on c.parent_id = cl.id
inner join 
language l
on cl.language_id = l.language_id
where l.language_id = 30
group by c.parent_id
; 
```

结果：

```
LANGUAGE_NAME   NAME    PARENT_ID
eng             cat4c   4 
```

以下查询`category name`为`parent id`每个`language`.

询问：

```
select l.language_name, cl.name, c.parent_id
from language l
left join 
category_name cl
on cl.language_id = l.language_id
left join 
category c
on c.parent_id = cl.id
group by l.language_id
; 
```

结果：

```
LANGUAGE_NAME   NAME    PARENT_ID
jpn             cat1    (null)
kor             cat3    3
eng             cat4    4 
```

## 使用示例数据和预期结果根据 OP 的更新问题进行编辑

*   [SQLFIDDLE 演示](http://sqlfiddle.com/#!2/593543/1)

询问：

```
select x.id, x.pid, x.gpid, 
cl.name ccat, cl2.name pcat, cl3.name gpcat
from
(SELECT c.id , c.parent_id as pid, 
p.parent_id gpid
FROM category AS c
left join category AS p 
on p.id = c.parent_id 
WHERE c.id in (5, 8)
) x
left join 
category_name cl
on cl.id = x.id
left join category_name cl2
on cl2.id = x.pid
left join category_name cl3
on cl3.id = x.gpid
group by x.id
; 
```

结果：

```
ID  PID     GPID    CCAT        PCAT    GPCAT
5   2       (null)  Children    Books   (null)
8   7       2       Math        Science Books 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T02:03:05.697

像这样的东西应该工作：

```
SELECT 
c.id AS childId, cname.name AS childName,
p.id AS parentId, pname.name AS parentName,
g.id AS grandparentId, gname.name AS grandparentName
FROM category p
INNER JOIN category c ON (p.id = c.parent_id)
LEFT JOIN category g ON (p.parent_id = g.id)
LEFT JOIN category_name cname ON (c.id = cname.id AND cname.language_ID = 3)
LEFT JOIN category_name pname ON (p.id = pname.id AND pname.language_ID = 3)
LEFT JOIN category_name gname ON (g.id = gname.id AND gname.language_ID = 3)
WHERE p.parent_id IS NOT NULL; 
```

我觉得应该有一种更简洁的方法来做到这一点，但目前看不到。

# javascript - 长轮询 XMLHttpRequests 和间歇性网络连接的问题

> ID：14205951
> 
> 赞同：8
> 
> 时间：2013-01-07T23:34:19.213
> 
> 标签：javascript, xmlhttprequest, comet

我已经实现了一个长轮询连接，以允许我在前端使用 Tomcat Web 服务器和标准 JavaScript 进行服务器端推送（彗星）。为了保持连接继续，我有一个简单的保持活动循环，一旦最后一个请求完成/失败，就会启动一个新请求。

在绝大多数情况下，这种连接工作得非常好，并且像我预期的那样保持活力。但是，我注意到当用户的 Internet 连接中断时（例如，他们从 VPN 断开连接、拔下以太网等）并且我有一个待处理的 XMLHttpRequest 到服务器，我没有收到任何失败的迹象。正因为如此，连接无声无息地消失了，除非我不断地向服务器发送请求以测试连接（这似乎违背了使用长轮询的目的），否则我无法知道它是否发生了。

这是我在 Chrome 中看到的请求对象，当它在这种无声的死亡中死去时：

```
request: XMLHttpRequest
    onabort: function ()
    onerror: function ()
    onload: null
    onloadend: null
    onloadstart: null
    onprogress: null
    onreadystatechange: function ()
    readyState: 1
    response: ""
    responseText: ""
    responseType: ""
    responseXML: null
    status: [Exception: DOMException]
    statusText: [Exception: DOMException]
    upload: XMLHttpRequestUpload
    withCredentials: false 
```

我设置了三个侦听器（onabort、onerror、onreadystatechange）以在它们被解雇时发出警报，但每当我与服务器的连接中断时，我什么也得不到。这是我形成请求的方式：

```
var request = new XMLHttpRequest();

//url is just the url to my servlet to handle this
request.open("GET", url, true);

//handlestatechange is just my standard handling code 
//that I've put an alert at the top of
request.onreadystatechange = handleStateChange;

request.onerror = function()
{
    alert("We encountered an error");
}

request.onabort = function()
{
    alert("I've had an abortion");
}

request.send(null); 
```

看起来这将是一个非常标准的情况，但我还没有看到任何关于如何允许长轮询连接从这种断开连接中恢复的对话。

难道我做错了什么？是否有其他更标准的方法来绕过这个问题进行长轮询/彗星？

对此的任何帮助将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T14:34:52.387

我相信处理这个问题的最好方法是将长轮询请求的持续时间限制在一段时间内`T`（例如 60 秒是一个不合理的值），然后在客户端使用超时来检测停滞状态。理想情况下，您应该使用 XHR`timeout`属性来执行此操作，但[它不受支持 x-browser](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest#Browser_Compatibility)，尽管它在 W3C 规范中。因此，您需要使用`setTimeout`and来实现您自己的支持`xhr.abort()`。

然后，客户端可以假设如果他们在 T 秒内没有得到响应，则连接已停止，并且可以中止当前请求并尝试重新连接。

这工作得相当好，但确实意味着在检测客户端的连接何时停止时存在一些延迟（最多 T 秒）。对于长轮询请求，我不知道有很多事情要做。如果您确实需要更好的解决方案，那么您可能需要查看发送回心跳消息或[WebSockets的](http://en.wikipedia.org/wiki/WebSocket)[流式彗星](http://en.wikipedia.org/wiki/Comet_%28programming%29#Streaming)连接。

这就是简单的答案。不幸的是，这对于各种奇怪的边缘情况来说都是一个不小的问题。例如，您可能关心也可能不关心具有连接超时的代理服务器，或者可能会在用户计算机上更改默认 TCP 超时的各种方式。这就是为什么我们看到像[Socket.IO](http://socket.io/)这样的框架隐藏了很多这种丑陋之处。

PS 可能值得注意的是，您可以通过 监控某些浏览器中的在线状态`navigator.onLine`，但它的[支持很差](https://stackoverflow.com/questions/3181080/how-to-detect-online-offline-event-cross-browser)。它真正运行正常的唯一浏览器是 Chrome。它唯一真正告诉您的是用户是否因某种原因而处于离线状态。它不能告诉你他们有一个有效的联系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-28T13:20:42.003

解决方案是启用 TCP keepalive。它是 TCP 中的一种机制，用于在失去可达性时关闭连接。您的应用程序不需要修改。您可以在操作系统或服务器应用程序中启用保活。

# ios - 平衡ios电池寿命和定位精度

> ID：14205952
> 
> 赞同：0
> 
> 时间：2013-01-07T23:34:28.307
> 
> 标签：ios, location, cllocationmanager

我有一个包含数千个位置的应用程序，我想知道用户何时在一个位置。由于电池寿命问题，我想我可以监控显着的位置变化，直到用户进入一个相对较大的区域（例如，位置+50 米）。那时我会切换到更高的精度。当用户离开该区域时，我会切换回显着的位置变化。

问题是我似乎只能注册 20 个区域，而且我真的不想弄清楚如何预处理一堆位置以对它们进行聚类并正确计算区域大小......再加上这会导致区域大小可能大到无用的情况。

另一种可能性是只使用最近的 20 个区域，但在某些情况下这不起作用。

如果有针对此 20 个区域限制的解决方法有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:53:57.880

是的，您可以通过[监控](http://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html#//apple_ref/doc/uid/TP40009497-CH2-SW13)多少个区域是有实际限制的`startMonitoringForRegion`，但是如果您只是使用普通的旧的重大更改，那么您可以跟踪自己的多少个区域绝对没有限制。就像您说的那样`startMonitoringForRegion`，它不像可以为您启动您的应用程序那样优雅，但它是一种替代方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T01:08:39.623

虽然我知道这是一个[Android](http://android.com)链接，但来自[Google](http://google.com)的有关[Android 位置策略](http://developer.android.com/guide/topics/location/strategies.html)的信息应该很容易适用于 iPhone（以及其他移动平台），因为技术是相同的。

# meteor - 自最新 (0.5.3) Meteor 更新以来有问题吗？

> ID：14205955
> 
> 赞同：4
> 
> 时间：2013-01-07T23:34:40.040
> 
> 标签：meteor

我刚刚更新了 Meteor，现在我的所有应用程序在尝试运行它们时突然抛出以下错误：

```
app/packages/mongo-livedata/mongo_driver.js:32
      throw err;
            ^
Error: failed to connect to [127.0.0.1:3002]
    at Server.connect.connectionPool.on.server._serverState (/usr/local/meteor/lib/node_modules/mongodb/lib/mongodb/connection/server.js:482:73)
    at EventEmitter.emit (events.js:123:20)
    at connection.on._self._poolState (/usr/local/meteor/lib/node_modules/mongodb/lib/mongodb/connection/connection_pool.js:96:15)
    at EventEmitter.emit (events.js:96:17)
    at Socket.errorHandler (/usr/local/meteor/lib/node_modules/mongodb/lib/mongodb/connection/connection.js:411:10)
    at Socket.EventEmitter.emit (events.js:93:17)
    at Socket._destroy.self.errorEmitted (net.js:328:14)
    at process.startup.processNextTick.process._tickCallback (node.js:244:9)
Exited with code: 1 
```

欢迎任何提示！谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-08T06:21:05.563

**运行`meteor update`升级到 0.5.4**，应该可以修复它。请参阅下文以了解问题所在。

这是 Meteor 0.5.3 中的回归。在开发模式下，Meteor 运行`ps`是为了`mongod`在开始新的`mongod`. 在进行不相关的错误修复时，我添加了一些误导性的错误检查，以查看是否将`ps`任何内容打印到标准错误中。不幸的是，在 OSX Mountain Lion 上，如果设置了（或其他几个以, 或`DYLD_LIBRARY_PATH`开头的环境变量），则运行会向 stderr 打印警告，导致 Meteor 0.5.3 认为失败。由于这个 Stack Overflow 问题，我[修复了这个问题并在 Meteor 0.5.4 中发布了修复程序。](https://github.com/meteor/meteor/commit/071b86900a1a917ac6e93451fa7c92691d6873cb)`DYLD``LD_LIBRARY_PATH``ps``ps`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T04:07:40.693

我发现了问题，我不得不使用 sudo 来启动流星服务器。过去我不必这样做。

# ios - 仪器命令行工具出错

> ID：14205956
> 
> 赞同：2
> 
> 时间：2013-01-07T23:34:40.727
> 
> 标签：ios, xcode, command-line, instruments

尝试通过 Instruments 命令行工具在 iOS 6 设备上启动单元测试时，我一直收到以下错误消息：

```
Failed to start Instruments daemon for 'iOS' on 'Agent03 (v6.0.1)' (The service is invalid.) 
```

我过去曾在同一设备上使用相同的方法成功启动测试，目前我已经使用相同的仪器跟踪模板在另一台 Mac 和 iOS 设备上成功运行测试。

我已经看到[了这个](https://stackoverflow.com/questions/8153098/unable-to-connect-iphone-3gsios-5-0-1-with-instruments-application)问题，它描述了一个类似的问题，尽管我没有收到有关重新连接设备的消息。我已经尝试了该问题的答案中描述的各种解决方案，但没有一个对我有用。我也尝试过重新启动 Mac 和 iOS 设备。

是否有人对使设备进入此状态可能发生的事情、我如何修复它以及如何防止它再次发生有任何想法？

更新：我尝试交换连接到 Mac 的 iOS 设备，我发现故障跟随设备，而不是 Mac。我会尝试恢复有问题的设备，看看是否能解决问题。我仍然想知道设备是如何进入这种状态的，以及如何防止它再次发生，但至少有修复的希望。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:42:01.477

恢复设备为我解决了这个问题。它没有告诉我为什么问题首先出现或如何防止它再次发生，但它现在有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-19T06:54:49.540

对我来说，如果我重新启动设备，我会得到这个。

根据我对 iOS 6 到 8 的 Xcode 5 和 6 的经验，唯一的解决方案是启动 Xcode。不需要转到任何特定的窗口或对设备执行任何操作，只需启动 Xcode，它就会自动修复任何连接设备的问题。

如果 Xcode 已经打开，请重新启动它。

# jquery - 使用 jQuery 追加后重置 CSS 样式

> ID：14205965
> 
> 赞同：0
> 
> 时间：2013-01-07T23:35:09.260
> 
> 标签：jquery, css, ajax

我正在使用从回调返回的内容填充 DIV，其中包含多个 HTML 项，并且每个项都有自己的关联类。在我调用 .append 之后，内容没有以正确的关联样式出现。

```
$.ajax({
    type: "GET",
    url: "blah.xml",
    dataType: "xml",
    data: myData,
    success: function(xml) {
        $(xml).find('item').each(function(){
            var id = $(this).attr('appId');
            $('<li><h5 class="thing">' + id + '</h5>').appendTo('#results');
        });
    }
}); 
```

因此，它获取 ID 并将 ID 设置在 H5 上，类为“thing”，然后附加到 DIV 结果。这很好用，但问题是当这种情况发生时，名为“thing”的类永远不会被应用。它肯定在那里，但没有被渲染。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:46:11.273

```
$('#results').append('<li><h5 class="thing">' + id + '</h5>'); 
```

因此，出于多种原因，包括性能原因和自动关闭`<ul>`等，我建议您首先将整个子树构建为字符串。

```
var s = '<ul>';
$(xml).find('item').each(function(){
    var id = $(this).attr('appId');
    s += '<li><h5 class="thing">' + id + '</h5></li>';
});
$('#results').append(s + '</ul>'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T00:15:21.483

如果您想使用“li”列表，请使用标签“ul”，所以：

```
$('#results').append('<ul></ul>'); 
```

然后你必须编写这样的代码：

```
 var results = "";
    $(xml).find('item').each(function(){
         var id = $(this).attr('appId');
         results+= '<li><h5 class="thing">' + id + '</h5></li>';
     });
    $('#results ul').append(results); 
```

# eclipse - Web 服务部署：服务无法脱离 Eclipse

> ID：14205966
> 
> 赞同：0
> 
> 时间：2013-01-07T23:35:13.427
> 
> 标签：eclipse, deployment, wsdl, http-status-code-404, tomcat7

我开发了一个简单的 WSDL Web 服务。它在 Eclipse 中没有问题。但是当我将它部署在 Tomcat 中时，这是我在 Eclipse 中使用的同一个 Tomcat 服务器，我收到以下错误：

```
type Exception report

message (404)Not Found

description The server encountered an internal error that prevented it from fulfilling this request.

exception

org.apache.jasper.JasperException: (404)Not Found
    org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:549)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:460)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:728)

root cause

(404)Not Found
    org.apache.axis.transport.http.HTTPSender.readFromSocket(HTTPSender.java:744)
    org.apache.axis.transport.http.HTTPSender.invoke(HTTPSender.java:144)
    org.apache.axis.strategies.InvocationStrategy.visit(InvocationStrategy.java:32)
    org.apache.axis.SimpleChain.doVisiting(SimpleChain.java:118)
    org.apache.axis.SimpleChain.invoke(SimpleChain.java:83)
    org.apache.axis.client.AxisClient.invoke(AxisClient.java:165)
    org.apache.axis.client.Call.invokeEngine(Call.java:2784)
    org.apache.axis.client.Call.invoke(Call.java:2767)
    org.apache.axis.client.Call.invoke(Call.java:2443)
    org.apache.axis.client.Call.invoke(Call.java:2366)
    org.apache.axis.client.Call.invoke(Call.java:1812)
    gyte.kiosk.WriteAnnouncementSoapBindingStub.vriteAnnouncement(WriteAnnouncementSoapBindingStub.java:108)
    gyte.kiosk.WriteAnnouncementProxy.vriteAnnouncement(WriteAnnouncementProxy.java:55)
    org.apache.jsp.proxy.Result_jsp._jspService(Result_jsp.java:106)
    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:728)

note The full stack trace of the root cause is available in the Apache Tomcat/7.0.34 logs. 
```

我已经在 Web-Inf 文件夹中放置了类。我还应该做些什么来解决这个问题？

Apache Tomcat 7.0.34 Windows 8 x64

这是Tomcat日志：

```
SEVERE: Servlet.service() for servlet [jsp] in context with path [/gytekioskduyuru] threw exception [(404)Not Found] with root cause
AxisFault
 faultCode: {http://xml.apache.org/axis/}HTTP
 faultSubcode: 
 faultString: (404)Not Found
 faultActor: 
 faultNode: 
 faultDetail: 
    {}:return code:  404
&lt;html&gt;&lt;head&gt;&lt;title&gt;Apache Tomcat/7.0.34 - Error report&lt;/title&gt;&lt;style&gt;&lt;!--H1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;} H2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;} H3 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;} BODY {font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;} B {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;} P {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;}A {color : black;}A.name {color : black;}HR {color : #525D76;}--&gt;&lt;/style&gt; &lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 404 - /GyteKiosk/services/WriteAnnouncement&lt;/h1&gt;&lt;HR size=&quot;1&quot; noshade=&quot;noshade&quot;&gt;&lt;p&gt;&lt;b&gt;type&lt;/b&gt; Status report&lt;/p&gt;&lt;p&gt;&lt;b&gt;message&lt;/b&gt; &lt;u&gt;/GyteKiosk/services/WriteAnnouncement&lt;/u&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;description&lt;/b&gt; &lt;u&gt;The requested resource is not available.&lt;/u&gt;&lt;/p&gt;&lt;HR size=&quot;1&quot; noshade=&quot;noshade&quot;&gt;&lt;h3&gt;Apache Tomcat/7.0.34&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;
    {http://xml.apache.org/axis/}HttpErrorCode:404

(404)Not Found
    at org.apache.axis.transport.http.HTTPSender.readFromSocket(HTTPSender.java:744)
    at org.apache.axis.transport.http.HTTPSender.invoke(HTTPSender.java:144)
    at org.apache.axis.strategies.InvocationStrategy.visit(InvocationStrategy.java:32)
    at org.apache.axis.SimpleChain.doVisiting(SimpleChain.java:118)
    at org.apache.axis.SimpleChain.invoke(SimpleChain.java:83)
    at org.apache.axis.client.AxisClient.invoke(AxisClient.java:165)
    at org.apache.axis.client.Call.invokeEngine(Call.java:2784)
    at org.apache.axis.client.Call.invoke(Call.java:2767)
    at org.apache.axis.client.Call.invoke(Call.java:2443)
    at org.apache.axis.client.Call.invoke(Call.java:2366)
    at org.apache.axis.client.Call.invoke(Call.java:1812)
    at gyte.kiosk.WriteAnnouncementSoapBindingStub.vriteAnnouncement(WriteAnnouncementSoapBindingStub.java:108)
    at gyte.kiosk.WriteAnnouncementProxy.vriteAnnouncement(WriteAnnouncementProxy.java:55)
    at org.apache.jsp.proxy.Result_jsp._jspService(Result_jsp.java:106)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:936)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    at org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1822)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T22:48:12.517

我找到了答案：

右键单击项目 -> 导出 -> WAR 文件

![在此处输入图像描述](../Images/d7faf422f7263713ba0a6a8ca3ad794c.png)

# c - 使用 Google 的 C KD 树库

> ID：14205971
> 
> 赞同：1
> 
> 时间：2013-01-07T23:35:38.793
> 
> 标签：c, data-structures, nearest-neighbor, kdtree

Google 有一个用 C 语言编写的 KD 树库：[这里](http://code.google.com/p/kdtree/)

据我所知，您使用其中一个函数将注释插入树中，然后查询树中最近的邻居。它返回一个指向新数组的指针（据我所知）。

这是我的目标：

我有一个 3D 数组，我希望找到一种方法来返回给定点最近邻居的索引。我想说：这是一个点：（12,23,14），现在告诉我最接近的点的索引，例如：“它是数组中的第 5 项”。但是，我不知道该怎么做。

我的问题，有没有人：

A）知道一个有据可查的关于 c 的 k 维最近邻搜索库，或者：

B) 知道如何获取 Google 的代码以返回数组中最近邻居的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T04:16:18.207

据我了解，您链接的库没有实现 n 最近邻搜索功能。对于 C，我没有任何其他的 kd-tree 库。

实现一个简单的 kd-tree 并不是很复杂，它应该是一个很好的练习。例如，您可以关注[http://ldots.org/kdtree/](http://ldots.org/kdtree/)。

# php - 正则表达式帮助。没有空格的字符串，但中间有 5 位数字。仅提取数字。PHP

> ID：14205972
> 
> 赞同：-2
> 
> 时间：2013-01-07T23:35:46.063
> 
> 标签：php, regex

示例字符串

`Rpt#_SPACE_MINVTAN<br_SPACE_/> _SPACE__SPACE__SPACE__SPACE__SPACE_01212_SPACE__SPACE_`

第一行末尾有一个换行符。第二行总是有 5 个空格，然后是 5 位数字，然后是另外两个空格....现在我粘贴之前有更多随机文本，之后有更多随机文本。

客户编号后的 _SPACE_ 数量必须为 2 或更多。

我想我正在寻找的是这个：

在大字符串的中间查找`_SPACE__SPACE__SPACE__SPACE__SPACE_012345_SPACE__SPACE_`

将数字提取到变量中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T00:27:48.757

针对您的特定类型字符串的另一种解决方案：

```
$string = "Rpt#_SPACE_MINVTAN<br_SPACE_/>_SPACE__SPACE__SPACE__SPACE__SPACE_01212_SPACE__SPACE_"; 
```

我已经对此进行了测试，它确实有效。

```
<?php
$text = "Rpt#_SPACE_MINVTAN<br_SPACE_/>_SPACE__SPACE__SPACE__SPACE__SPACE_01212_SPACE__SPACE_";
$text_array = explode("<br_SPACE_/>", $text);
$array1 = explode("_SPACE_", $text_array[0]);
echo $array1[0] . ' and ' . $array1[1];
$number = trim($text_array[1], "__SPACE__");
echo '<br>and ' . $number;
?>

$array1[0] is the 'Rpt#'
$array1[1] is the 'MINVTAN'
$number is '01212' 
```

在您将此代码放入您的文件并看到它有效后，请记住将其作为解决方案选中，以便其他人知道该帖子已得到答复。如果您有任何其他问题，请随时提出；祝你有愉快的一天。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:38:45.737

如果您想要更具体的解决方案，请发布更具体的代码或信息。

但一种解决方案可能是：

```
<?php
$trimmed_text = trim($text, "__SPACE__");
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T23:46:59.057

对于像下面这样的字符串，中间有 5 个数字，周围有空格，

```
_SPACE__SPACE__SPACE__SPACE__SPACE_012345_SPACE__SPACE_ 
```

你可以`preg_match()`像下面这样使用：

```
$string='_SPACE_SPACE....'; //your string here

preg_match('/\s*(\d{5})\s*/',$string,$matches);

print_r($matches); //$matches[1] will have the matched digits 
```

编辑：

根据 OP，如果文本实际上是 SPACE_，则代码如下：

```
$string='_SPACE__SPACE__SPACE__SPACE__SPACE_12345_SPACE__SPACE_'; //your string here

preg_match('/[SPACE_]*(\d{5})[SPACE_]*/',$string,$matches);

print_r($matches); //$matches[1] will have the matched digits 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T00:19:38.640

这很丑：

```
function onlyNumber($str) { 
     $numbers = array(0,1,2,3,4,5,6,7,8,9);
     $icky = array('_','-','#','<','>','/');
     $num = "";
     for($i=0;$i<strlen($str);$i++) { 
            if(!ctype_alpha($str[$i]) && !in_array($str[$i],$icky) && in_array(intval($str[$i]),$numbers,true)) { 
                $num .= $str[$i];
            }
     }
     return trim($num);
} 
```

# php - 在 Titanium 和 PHP 之间传递数组的正确方法是什么？

> ID：14205974
> 
> 赞同：0
> 
> 时间：2013-01-07T23:35:49.237
> 
> 标签：php, titanium

我有一个名为 mobilemanager 的数据库，其中有一个名为*cc_devices*的表，它已在我的 wamp 服务器中启动和测试，我想将一个数组传递给一个 json 对象并将所有数据存储在该 json 页面中，但我只得到一个值。一切都完成后，这是我的数据库的图片

![在此处输入图像描述](../Images/9bdd142959cc330f8a3a7d193f1156fb.png)

**这是我在钛中用来传递数组的代码**

```
//insert into a databse
function submit_Device () {
    //var request = Ti.Network.createHTTPClient();
    var request = Ti.Network.createHTTPClient({
    onload: function(e){
         Ti.API.debug(this.responseXML);
        //alert('The connection was successful!');
    },
    onerror: function(e){
        Ti.API.debug(e.error);
        alert('There was an error during submission.');
    },
    timeout:5000,
    autoEncodeUrl:false,
    }); 
    request.open("POST","http://192.168.34.53/insertuser.php");
    var params = ({"id": "4", "user": "Tony Montana" , "device": "Galaxy s2" , "project": "ABA" , "date": "7/1/2013" , "hour": "4:14 pm" , "used": "True"});  
    request.send(params);
    alert('Device Summited');
    }; 
```

**这是PHP代码**

```
<?php
$username="root";
$password="somepass";
$database="somedb";

mysql_connect('localhost',$username,$password);
@mysql_select_db($database) or die( "Unable to select database");
$user = $_POST['user'];
$query="INSERT INTO somedb.cc_devices (user) VALUES ('" . $user . "')"; 
mysql_query($query);
mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T20:56:34.047

我想我明白了，一切都完成后，这是我的数据库

![在此处输入图像描述](../Images/3b0239067834c689fcb0ec4fbb9d5e13.png)

**这是我在 Titanium 中对 .js 文件所做的更改**

```
//insert into a databse
function submit_Device () {
    //var request = Ti.Network.createHTTPClient();
    var request = Ti.Network.createHTTPClient({
    onload: function(e){
         Ti.API.debug(this.responseXML);
        //alert('The connection was successful!');
    },
    onerror: function(e){
        Ti.API.debug(e.error);
        alert('There was an error during submission.');
    },
    timeout:5000,
    autoEncodeUrl:false,
    }); 
    request.open("POST","http://192.168.34.53/insertuser.php");
    var params = ({"id": "0" ,"user": "Tony Montana" , "device": "Galaxy s2" , "project": "ABA" , "date": getDate() , "hour": getTime() , "used": "true"});  
    //insert into mobilemanager.cc_devices values (0,"Mario Galván", "IPhone 3g", "ITexico", "2013-08-01", "3:52:52", "true")
    request.send(params);
    alert('Device Summited');
    }; 
```

**这就是我将所有参数传递给 .php 文件中的数据库的方式**

```
<?php
$username="root";
$password="somepass";
$database="somedb";

mysql_connect('localhost',$username,$password);
@mysql_select_db($database) or die( "Unable to select database");
$user = $_POST['user'];
$device = $_POST['device'];
$project = $_POST['project'];
$date = $_POST['date'];
$hour = $_POST['hour'];
$used = $_POST['used'];
$query="INSERT INTO somedb.cc_devices (user,device,project,date,hour,used) VALUES ('$user', '$device', 
    '$project', '$date','$hour', '$used')"; 
mysql_query($query);
mysql_close();
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:57:44.860

imm 据我了解，您在 PHP 中接收到一个 json 字符串作为参数，我不确定是 POST 还是 GET。

为了帮助测试它，首先在你的 PHP 环境中安装 krumo。使用 krumo($_POST) 和 krumo($_GET) 来查看您到底收到了什么。为我们提供结果。

我相信 PHP 理解它正在接收一个字符串，但我不知道用于存储该字符串的密钥是什么，也许是 $_POST[0] ...您还必须验证这一点。

一旦你在一个变量上有了 json 字符串，正如 boruch 所说，你必须 json_decode() 它，这将返回一个数组：

```
$newArray = json_decode($_POST[0]);
$user = $newArray['user'];
.
.
. 
```

# javascript - 在用户激活动画期间暂停所有背景动画（jquery）

> ID：14205983
> 
> 赞同：0
> 
> 时间：2013-01-07T23:36:41.733
> 
> 标签：javascript, jquery, html, animation

所以我在后台有几组动画。但是，在用户动画期间，我想暂停所有其他动画，以便浏览器可以呈现用户最需要的内容。

```
Element.mousein()  --> Pause (NOT STOP) all animations except those related to Element
                       i.e. $(body).not(Element).pauseAnimations();
Element.mouseout() --> Resume all animations
                       i.e. $(body).not(Element).resumeAnimations(); 
```

像这样的[http://tobia.github.com/Pause/](http://tobia.github.com/Pause/)而是暂停所有其他的，除了悬停的那个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T12:17:49.017

这对用户来说很难使用，因为他/她应该跟随一个移动的盒子来让它保持悬停。但是除了定位之外的动画当然会更有用。

无论如何，这里是[**jsFiddle 上官方 Pause 插件演示**](http://jsfiddle.net/onury/9GQra/)的修改版本。

你应该在`setupBox()`函数内部做的是：

```
function setupBox(i) {
    var $box = $('#box' + i);

    function phase1() {
        $box.animate({left: 100}, 1000, 'swing', phase2);
    }

    function phase2() {
        $box.animate({left: 0}, 1000, 'swing', phase1);
    }

    // This pauses rest of the boxes except the targeted. 
    // I added a class ('box') to each element to easily select all boxes. 
    // You could also do: $('.demo').children() since all the children are boxes.
    function pauseRest() {
        $('.box').not('#box' + i).pause(); 
        $box.resume();
    }

    $box.hover(function () {
        pauseRest($box);
    }, function () {
        $('.box').resume();
    });
    phase1();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T23:41:47.667

您可以在需要时使用[stop()](http://api.jquery.com/stop/)停止动画。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T23:42:44.197

使用 stop() 的问题，您必须指定每个动画手册，但我刚刚发现[这个（链接）](http://api.jquery.com/jQuery.fx.off/)显然允许停止所有当前动画。

`$("button").click($.fx.off)`

* * *

好的，上面的解决方案并不好，因为你说它是一个通用的选择器。

`$("div:animated").not('#AnimationYouWantToContiune').stop();`

请看这个[小提琴](http://jsfiddle.net/vmcng/)我设法添加了 3 个正在动画的 div，当单击一个按钮时，它将停止除指定 div 之外的所有 div 动画。这有帮助吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-25T10:54:16.127

像拥有它一样使用 jQuery...

jQuery 有选择器：[这里没有描述](http://api.jquery.com/not-selector/)

这是一个暂停插件的例子，它可以暂停其他元素而不是悬停的元素；

```
<html>
    <head>
        <link rel='stylesheet' href='http://tobia.github.com/Pause/style.css'>
        <script src='http://tobia.github.com/Pause/jquery-1.4.2.min.js'></script>
        <script src='http://github.com/tobia/Pause/raw/master/jquery.pause.min.js'></script>
    </head>
    <body>
        <div class="demo">
            <div id="box1" class="boxy"></div>
            <div id="box2" class="boxy"></div>
            <div id="box3" class="boxy"></div>
        </div>
        <script type="text/javascript">
            $(function() {
                $(".boxy").each(function(){
                    $(this).hover(function() {
                        var id = $(this).attr("id");
                        $(":not(#" + id + ")").pause();
                    }, function() {
                        var id = $(this).attr("id");
                        $(":not(#" + id + ")").resume();
                    });
                    setupBox($(this));
                });
                function setupBox(elem) {
                    function phase1() {
                        elem.animate({ left: 450 }, 2000, 'swing', phase2);
                    }
                    function phase2() {
                        elem.animate({ left: 0 }, 2000, 'swing', phase1);
                    }
                    phase1();
                }
            });
        </script>
    </body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-07T23:40:24.090

您可以使用**[delay()](http://api.jquery.com/delay/)**函数来延迟队列中项目的执行，但这不是首选的方法。

如果可以，您应该在[**animate()**](http://api.jquery.com/animate/)方法中使用回调函数。

# php - PHP XML DomDocument 值

> ID：14205986
> 
> 赞同：0
> 
> 时间：2013-01-07T23:37:06.180
> 
> 标签：php, xml, web-applications, domdocument

我正在通过 API 获取一些数据，它以以下形式返回 XML：

```
<SUBSCRIBER_ROW>
<SUBSCRIBER>
    <ACCOUNT_NUMBER Value="0123456789123"/>
    <FIRST_NAME Value="fakeFirstName         "/>
    <INITIAL Value="w "/>
    <SURNAME Value="fakeLastName        "/>
    <TELEPHONE_NUMBER Value="5551234"/>
    <TELEPHONE_AREA Value="403"/> 
```

我必须提取数据的代码如下：

```
 protected function par_getSubscriber($webCBSXML, $isJSON = false){
  ////parse XML
    $msg = 'WebCBS ERR: ';
    $dom = new DOMDocument();
    if(@$dom->loadXML($webCBSXML)) {
        $errors = $dom->getElementsByTagName('Error');
        if($parsedData = self::checkError($dom)) {
            $parsedData = self::formatOutput($parsedData, $isJSON, true);
            return $parsedData;
        } else {
            $subscriber['account_number']      = $dom->getElementsByTagName('account_number')->getAttribute('Value');
            $subscriber['first_name']          = $dom->getElementsByTagName('first_name')->getAttribute('Value');
            $subscriber['surname']             = $dom->getElementsByTagName('surname')->getAttribute('Value');
            $subscriber['telephone_number']    = $dom->getElementsByTagName('telephone_number')->getAttribute('Value'); 
```

但是，整个脚本在这一行之后就死了：

```
$subscriber['account_number']      = $dom->getElementsByTagName('account_number')->getAttribute('Value'); 
```

我没有太多处理 DOM 文档的经验，因为它是从 XML 创建一个对象，所以我无法使用 var_dump/print_r 来查看它的结构！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T23:41:25.843

虽然我会建议使用 XPath 来提取您需要的信息，但似乎您只是误解了`getElementsByTagName()`. 它返回一个 DOMNodeList 而不是单个节点。此外，您还必须将提到的@salathe 节点名称大写。将代码更改为：

```
$subscriber['account_number'] =
    $dom->getElementsByTagName('ACCOUNT_NUMBER')->item(0)->getAttribute('Value'); 
```

此外，您应该检查节点是否真的存在于 XML 中。您可以用 PHP 编写检查，也可以使用 XSD 等模式语言。

# symfony - 构建动态 Doctrine 查询

> ID：14205991
> 
> 赞同：0
> 
> 时间：2013-01-07T23:37:40.937
> 
> 标签：symfony, doctrine

我正在尝试为我的数据库构建过滤器。基于几个表单输入的值，我需要构造适当的查询。这是代码：

```
 $qb = $em->createQueryBuilder();
            $qb->select('c.title')
            ->from('Baza\BlogBundle\Entity\Conferences', 'c');         
    $conditions=array(
        $qb->expr()->gt('c.title',$enquiry->getNaziv()) );//First condition 

    if ($enquiry->getKontakt()!=null) {
         $conditions[] = $qb->expr()->lt('c.contactemail',$enquiry->getKontakt())}//Adding second, optional condition

    $conditions = call_user_func_array(array($qb, 'andX'), $conditions);
    $qb->where($conditions);
    $query = $qb->getQuery(); 
```

当我运行它时，我得到以下异常：

> 警告：call_user_func_array() 期望参数 1 是一个有效的回调，类 'Doctrine\ORM\QueryBuilder' 没有方法 'andX'

*编辑 call_user_func_array() 修改后，我收到以下错误：

> QueryException: SELECT c.title FROM Baza\BlogBu​​ndle\Entity\Conferences c WHERE c.title > ITRO AND c.contactemail < somemail@yahoo.com

显然，查询的格式不正确。我在关注这篇文章：[Doctrine DQL 条件查询](https://stackoverflow.com/questions/9283700/doctrine-dql-conditional-query)

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T12:21:54.523

我使用以下代码构建了动态查询：

```
$em = $this->getDoctrine()->getEntityManager();

            $naziv = $enquiry->getNaziv();
            $drzava=$enquiry->getDrzava();
            $oblast=$enquiry->getOblast();
            $grad=$enquiry->getGrad();
            $provincija=$enquiry->getProvincija();
            $kontakt=$enquiry->getKontakt();
            $sajt=$enquiry->getSajt();

            $testquery = "SELECT c.title FROM Baza\BlogBundle\Entity\Conferences c JOIN c.topicid t JOIN c.locationid l JOIN l.stateid s WHERE c.lh = :lh";
            $testparam ['lh'] = $lh;

            if ($kontakt != '') {
                    $testquery .= " and c.contactemail = :kontakt";
                    $testparam['kontakt'] = $kontakt;
            }
            if ($drzava != '') {
                    $testquery .= " and s.name = :drzava";
                    $testparam['drzava'] = $drzava;
            }

            if ($provincija != '') {
                    $testquery .= " and l.province = :provincija";
                    $testparam['provincija'] = $provincija;
            }

             if ($grad != '') {
                    $testquery .= " and l.city = :grad";
                    $testparam['grad'] = $grad;
            }

             if ($sajt != '') {
                    $testquery .= " and c.siteurl = :sajt";
                    $testparam['sajt'] = $sajt;
            }

             if ($oblast != '') {
                    $testquery .= " and t.name = :oblast";
                    $testparam['oblast'] = $oblast;
            }

            $query = $em->createQuery($testquery)->setParameters($testparam);
            $result = $query->getResult(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T23:43:57.117

1.  andx 都是小写
2.  andx 是 expr() 的函数，而不是查询生成器的函数：

    $conditions = call_user_func_array(array($qb->expr(), 'andx'), $conditions);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T00:35:19.450

关于您的编辑：

```
$qb = $em->createQueryBuilder();
            $qb->select('c')
            ->from('Baza\BlogBundle\Entity\Conferences', 'c'); 
```

使用学说（作为 ORM）选择整个对象。您仍然可以在字段上使用 where 子句。此外 gt 和 lt 搜索字符串并不是真正正确的 sql 实践。如果字母大小写不正确，它们可能会产生奇怪的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-06T02:44:35.740

多年后，这就是我的做法：

```
 if (array_key_exists('phone', $filters)) {
        $qb->andWhere('p.phone LIKE :phone')
        ->setParameter(':phone', '%' . $filters['phone'] . '%');
    } 
```

希望这对某人有帮助

# java - SQL Server 函数返回 � 对于特殊字符 utf-8

> ID：14205997
> 
> 赞同：0
> 
> 时间：2013-01-07T23:38:03.820
> 
> 标签：java, sql-server-2005, jdbc, utf-8

我有一个名为 mydata 的表，其类型为 nvarchar(max)。这包含如下字符：é á ñ。使用 Java (Spring) 提取数据。Java 应用程序使用 utf-8 进行请求和响应。

当我执行一个简单的选择特殊字符时正确显示。

```
Select myData from myTable 
```

我有一个简单的 SQL 函数，它刚刚收到一个 nvarchar 并返回它。

```
CREATE function getIt (@mydata nvarchar(max) )
returns nvarchar(max)
as
begin
    return @mydata;
end 
```

当我对特殊字符使用函数时，不显示并由 � 符号替换。

```
Select dbo.getIt(myData) as myData from myTable 
```

我已经使用 mySQL 和 Oracle 测试了相同的过程，在这种情况下，SQL 函数不会更改特殊字符。我在 Ubuntu Linux 机器中使用 Tomcat。数据库是 SQL Sever 2005。我使用的是 JDTS 1.3。

感谢您的帮助。

额外说明

如果字段 myData 包含 ñ 例如，如果 a 执行以下操作：

```
Select
myData,
dbo.getIt(myData) as myData2
from myTable 
```

网页中显示的列的结果将是 ñ ? 或ñ � NVarchar 正确存储数据，但由于某种原因，该函数发生了一些变化。如果我在编码时遇到问题，则 ñ 在这两种情况下都不会正确显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:52:14.667

我有问题。

由于某种原因，对 nvarchar 的常规选择被 JDBO 捕获为类型 (12) VARCHAR。但是也返回 nvarchar 的函数被捕获为类型 (-1) LONGVARCHAR。

MySQL 和 Oracle 以不同的方式工作，我的 Java 代码最初是用于这个数据库的。

另一种情况是 nVarchar(400) 将返回类型 (12) VARCHAR 但 nVarchar(MAX) 将返回类型 (-1) LONGVARCHAR。

我的代码将所有“LONG”值作为二进制文件处理，SQL Server 在此循环中输入。

感谢@jlordo 和@chooban 指导我找到解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T08:18:10.397

那是Unicode替换字符。如果您告诉应用程序将数据库中的字节*解释*为 UTF-8，但为其*提供*Latin-1（或其他字符集），则可能会发生这种情况。我认为 nvarchar 意味着数据存储为 UTF-16，对吗？我对 SQL 服务器不太感兴趣。

与数据库建立连接后，解释连接的元数据并查看正在使用的字符集。

您还应该准确检查列中存储的内容。在 MySQL 中，我使用*十六进制*函数来准确显示字段中的字节，但我不确定 SQL Server 的等效项是什么。但是，[这个页面](http://www.sqlservercentral.com/blogs/steve_jones/2011/03/25/how-many-bytes-are-in-my-column_3F00_-_1320_-t_2D00_sql-functions/)告诉我有*LEN*和*DATALENGTH*函数可以用来比较字符数和字节数。找到相当于 MySQL 的*hex*函数的方法绝对是 g.

# vba - VBA 数组 - 检查严格（非近似）匹配

> ID：14205999
> 
> 赞同：4
> 
> 时间：2013-01-07T23:38:07.613
> 
> 标签：vba, excel-2007

```
If UBound(Filter(myArray, Sheets(i).Cells(1, j).Value, True)) = -1 Then
 'take action
End if 
```

我使用此语法将 Cells(1, j) 中的元素（例如“ally”）与数组的所有元素（例如“mally”、“kate”、“becks”）进行比较，并在没有时采取行动找到完全匹配。麻烦的是，根据这行代码，似乎“ally”被认为是匹配“mally”（可能是因为“ally”是“mally”的子字符串），而我希望“ally”被识别为与“mally”不同”。

对实现此目的的语法有任何帮助吗？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-01-09T12:49:45.160

```
IsInArray = Not IsError(Application.Match(stringToBeFound, arr, 0)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T23:46:54.677

过滤器将返回任何部分匹配的项目。Microsoft 建议的解决方法是在过滤后的数组中搜索精确匹配。

```
Function FilterExactMatch(astrItems() As String, _
                          strSearch As String) As String()

   ' This function searches a string array for elements
   ' that exactly match the search string.

   Dim astrFilter()   As String
   Dim astrTemp()       As String
   Dim lngUpper         As Long
   Dim lngLower         As Long
   Dim lngIndex         As Long
   Dim lngCount         As Long

   ' Filter array for search string.
   astrFilter = Filter(astrItems, strSearch)

   ' Store upper and lower bounds of resulting array.
   lngUpper = UBound(astrFilter)
   lngLower = LBound(astrFilter)

   ' Resize temporary array to be same size.
   ReDim astrTemp(lngLower To lngUpper)

   ' Loop through each element in filtered array.
   For lngIndex = lngLower To lngUpper
      ' Check that element matches search string exactly.
      If astrFilter(lngIndex) = strSearch Then
         ' Store elements that match exactly in another array.
         astrTemp(lngCount) = strSearch
         lngCount = lngCount + 1
      End If
   Next lngIndex

   ' Resize array containing exact matches.
   ReDim Preserve astrTemp(lngLower To lngCount - 1)

   ' Return array containing exact matches.
   FilterExactMatch = astrTemp
End Function 
```

此代码取自[http://msdn.microsoft.com/en-us/library/office/aa164525%28v=office.10%29.aspx](http://msdn.microsoft.com/en-us/library/office/aa164525%28v=office.10%29.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-08T23:01:31.117

如果该数组仅用于此比较而不用于其他任何操作，您还可以通过添加您自己的从未出现在数据中的分隔符来强制进行全字比较 - 可能是方括号。
因此，如果您将数组更改为包含“[mally]”、“[kate]”、“[becks]”，
那么您的条件将变为：

```
If UBound(Filter(myArray, "[" & Sheets(i).Cells(1, j).Value & "]", True)) = -1 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-07T23:54:08.990

如果您不需要使用过滤器，那么下面的代码片段就可以了

```
Dim v
Dim bMatch As Boolean
bMatch = False

For Each v In myArray
    'compare strings
    If StrComp(CStr(v), Sheets(i).Cells(1, j).Value, vbTextCompare) = 0 Then
        bMatch = True
    End If
Next

If Not bMatch Then
'do something
End If 
```