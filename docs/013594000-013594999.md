# StackOverflow 问答 13594000-13594999

# spring - 如何测试使用 spring @values 注释设置属性的类？

> ID：13594001
> 
> 赞同：0
> 
> 时间：2012-11-27T22:06:04.463
> 
> 标签：spring, testing, constructor, annotations, mocking

我有一个如下所示的课程

```
public class Abcd{

private  @Value("${username}")
String username;

private @Value("${password}")
String password;

public Abcd(){
   ServiceService serv = new ServiceService();
   Service port = serv.getServicePort();
   BindingProvider bp = (BindingProvider) port;
   bp.getRequestContext().put(BindingProvider.USERNAME_PROPERTY, username);
   bp.getRequestContext().put(BindingProvider.PASSWORD_PROPERTY, password);

}

public void getSomeValueMethod(){
....
} 
```

**那么我该如何为此编写测试呢？当我从属性文件中读取值时，当我尝试调用构造函数进行测试时，由于用户名和密码为空，我得到一个空指针异常并且测试失败。有什么办法可以克服这个问题并成功测试吗？如何在调用构造函数之前设置这些带注释的值？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T22:18:00.730

就像 Spring 注入的所有内容一样：通过在单元测试中自己注入它们：

```
public class Abcd{

    private String username;
    private String password;

    public Abcd(@Value("${username}") userName, @Value("${password}") String password) {
        ...
    }
    ...
} 
```

在你的单元测试中：

```
Abcd abcd = new Abcd("someUserName", "somePassword"); 
```

请记住，依赖注入的主要目标是能够在单元测试中手动注入虚假或模拟依赖。

# java - 在使用一组 3 个不同的数字后，如何修改我的程序以继续查找适用的数字？

> ID：13594003
> 
> 赞同：0
> 
> 时间：2012-11-27T22:06:08.957
> 
> 标签：java, class

我的问题是，即使它正确打印出值和所有内容，我仍然需要它来测试更高的值，显然仍然小于我的样本输入的最大值，即 110。

这是我的代码：

```
import static java.lang.System.*;

public class Triples
{
  private int first;
  private int second;
  private int third;
  private int number;

  public Triples()
  {
    //this(0);
  }

  public Triples(int num)
  {
    number = num;
  }

  public void setNum(int num)
  {
    number = num;
  }

  private int greatestCommonFactor(int a, int b, int c)
  {
    int g;
    int h;

    if(a<b && a<c)
      g = a;
    else if(b< a && b<c)
      g = b;
    else
      g = c;

    for(int i = g; i > 0; i--)
    {
      if((a%i == 0) && (b%i == 0))
      {
        h = i;
        for(int j = i; j>0; j--)
        {
          if((h%j==0) && (c%j == 0))
          {
            return j;
          }
        }
      }
    }
  return -1;
  }

  public String check4Triples()
  {
    int max = number;
    String amIdoneYet;
    //int a;
    //int b;
    //int c;
    for(int n = 1; n <= max; n++)
      //{

      for(int a = n; a <= max; a++)
      {
        first = a;
        for(int b = a +1; b <= max; b++)
        {
          second =b;
          for(int c = b + 1; c <= max; c++)
          {
            third = c;
            if(Math.pow(a, 2)+ Math.pow(b, 2)== Math.pow(c, 2))
            {
              if((a%2==1 && b%2==0)|| (a%2==0 && b%2==1))
              {
                if(this.greatestCommonFactor(a, b, c)== 1)
                {
                  amIdoneYet = "";
                  amIdoneYet += a + " " + b + " "+ c;
                  return amIdoneYet;
                }
              }
            }                   
          }
        }   
      }
      return null;
    }

    public String toString()
    {
      String output=" ";
      output += check4Triples() + " \n";

      return output;
    }
  } 
```

但是，我相信手头的问题在于我的跑步者课程：

```
import static java.lang.System.*;

import java.util.Scanner;

public class Lab11j
{
  public static void main(String args[])
  {
    Scanner keyboard = new Scanner(System.in);
    String choice="";
    do{
      out.print("Enter the max number to use : ");
      int big = keyboard.nextInt();

      //instantiate a TriangleThree object
      Triples triple = new Triples(big);

      //call the toString method to print the triple
      out.println( triple );

      System.out.print("Do you want to enter more data? ");
      choice=keyboard.next();
    }while(choice.equals("Y")||choice.equals("y"));
  }
} 
```

这是我的输出应该是这样的：

*   3 4 5
*   5 12 13
*   7 24 25
*   8 15 17
*   9 40 41
*   11 60 61
*   12 35 37
*   13 84 85
*   16 63 65
*   20 21 29
*   20 99 101
*   28 45 53
*   33 56 65
*   36 77 85
*   39 80 89
*   48 55 73
*   60 91 109
*   65 72 97

**更新** 在考虑了一些之后，我认为问题在于 for 循环无法知道是否再去......我仍然认为这个问题与我的跑步者类有关。但在我的`check4Triples`方法中，我基本上只告诉它找到三个最低的适用数字。我不知道如何告诉它也检查其他值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:57:38.813

问题的症结在于，您在找到 GCF 为 1 后立即返回一个字符串值，而您*要做*的是循环到最大数量并找到*所有*三元组：

```
if (this.greatestCommonFactor(a, b, c) == 1) {
    return "" + a + " " + b + " "+ c;
} 
```

第二个问题是不正确代码周围的循环有一个额外的循环，`1..n`已经由 处理`a = 1..n`：

```
for (int n = 1; n <= max; n++) {
    for (int a = n; a <= max; a++) {
        ... 
```

现在，您*可以*通过以下方式解决此问题：

1.  消除额外的循环，以及
2.  将三元组添加到单个字符串后跟换行符。

就个人而言，我会`List<String>`为此使用 a 并迭代输出，但这是一个不同的问题。

我们最终得到了更接近于这个的东西：

```
public String check4Triples() {
    int max = number;
    String ret = "";

    for (int a = 1; a <= max; a++) {
        for (int b = a + 1; b <= max; b++) {
            for (int c = b + 1; c <= max; c++) {
                if (isPythagoreanTriple(a, b, c)) {
                    if (mod2(a, b) || mod2(b, a)) {
                        if (greatestCommonFactor(a, b, c) == 1) {
                            ret += "" + a + " " + b + " " + c + "\n";
                        }
                    }
                }
            }
        }
    }

    return ret;
} 
```

使用`100`最大数量，我的输出是这样的：

```
3 4 5
5 12 13
7 24 25
8 15 17
9 40 41
11 60 61
12 35 37
13 84 85
16 63 65
20 21 29
28 45 53
33 56 65
36 77 85
39 80 89
48 55 73
65 72 97 
```

我相信这更接近你的意图。我也可能使用短路逻辑：

```
if (isPythagoreanTriple(a, b, c)
        && (mod2(a, b) || mod2(b, a))
        && (greatestCommonFactor(a, b, c) == 1)) {
    ret += "" + a + " " + b + " " + c + "\n";
} 
```

# html - 更改焦点文本框周围的选择颜色

> ID：13594004
> 
> 赞同：4
> 
> 时间：2012-11-27T22:06:10.270
> 
> 标签：html, css, textbox

当用户输入数据时，我正在尝试更改文本框周围选择的颜色。现在，当用户在我的机器上选择它时，它变成蓝色。我希望这个是红色的。是否可以更改焦点文本框周围的选择颜色？我尝试在我的 css 中使用 -moz-selection 和 selection ，但它不起作用。

```
#myTextBox {
    border: 3px solid gray;/*background img not available, added border to see textbox*/
    background: transparent url(IMAGEHERE.png);
    width: 368px;
    height: 33px;
    color: silver;
    font-size: 22px;
    padding-left: 10px;
}

::-moz-selection {
    background-color: #dd2020;
    color: #fff;        
}

::selection {
    background-color: #dd2020;
    color: #fff;        
} 
```

[jsFiddle](http://jsfiddle.net/9Zjbm/1/)

![在此处输入图像描述](../Images/6284bd5ce046a7fb58eaf552f11a1a1b.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-27T22:13:15.793

试试这个代码：

```
#myTextBox {
    border: 3px solid gray;
    width: 368px;
    height: 33px;
    color: silver;
    font-size: 22px;
    padding-left: 10px;
    border:2px solid red;
    border-radius:7px;
    font-size:20px;
    padding:5px; 

}

#myTextBox:focus{
    outline:none;
    border-color:blue;
    box-shadow:0 0 10px blue;
} 
```

[​演示](http://jsfiddle.net/9Zjbm/4/)

它在焦点上将红色变为蓝色。

# php - jQuery令牌输入不处理跨域结果

> ID：13594006
> 
> 赞同：0
> 
> 时间：2012-11-27T22:06:14.430
> 
> 标签：php, javascript, google-chrome-extension, cross-domain, jquery-tokeninput

我正在创建一个 chrome 扩展，它使用[http://loopj.com/jquery-tokeninput/](http://loopj.com/jquery-tokeninput/)添加令牌，请参阅[上一个问题](https://stackoverflow.com/questions/13541612/chrome-extension-error-when-returning-json-resource-interpreted-as-script-but-t)。

我对如何从我的服务器获取结果以由 tokenInput 处理感到困惑。下面的文章，[什么是 JSONP？](http://remysharp.com/2007/10/08/what-is-jsonp/)，建议我需要添加一个回调查询参数以使跨域 jsonp 工作：

```
$(function() {
  $("#token").tokenInput("http://localhost/token/search?callback=jsonprocess", {
    preventDuplicates: true,
    crossDomain: true,
  });
}); 
```

这用于将响应包装在我的 php 代码中：

```
header('Content-type: text/javascript');
echo $this->request->query('callback') . '(' . json_encode($token_array) . ')';
exit; 
```

`jsonprocess()`然后在我的javascript中调用该方法。但是，这超出了 tokenInput 实例的上下文，因此我无法填充结果。这是正确的功能吗？或者有没有办法让jQuery tokeninput 插件直接处理jsonp？

tokeninput 中的成功回调：

```
ajax_params.success = function(results) {
    cache.add(cache_key, $(input).data("settings").jsonContainer ? results[$(input).data("settings").jsonContainer] : results);
    if($.isFunction($(input).data("settings").onResult)) {
        results = $(input).data("settings").onResult.call(hidden_input, results);
    }
}; 
```

...从未被调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T14:51:11.157

伙计，您需要像这样在 javascript 和 php 中进行回调：

**javascript:**

```
script.php?callback=?&your_parametars_here 
```

**并在 php**

```
echo $_GET['callback'].$your_data_here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T14:17:15.833

比我想象的要容易；不需要`?callback=jsonprocess`在搜索网址中

```
$(function() {
  $("#token").tokenInput("http://localhost/token/search", {
    preventDuplicates: true,
    crossDomain: true,
  });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T01:12:30.867

正如您在[jQuery Tokeninput 文档](http://loopj.com/jquery-tokeninput/)中看到的，如果您希望它是一个 jsonp 请求，则必须在选项中`crossDomain`设置。`true`

```
$(function() {
  $("#token").tokenInput("http://localhost/token/search?callback=jsonprocess", {
    preventDuplicates: true,
    crossDomain: true
  });
}); 
```

并且[*正确*](https://stackoverflow.com/questions/477816/the-right-json-content-type)[的JSON 内容类型](https://stackoverflow.com/questions/477816/the-right-json-content-type)*是`application/json`.*

 *```
header('Content-type: application/json'); 
```

## 更新：

好的，如果它不能与 jsonp 一起使用，你应该通过[启用 CORS](http://enable-cors.org/)来尝试它。

在这里你会做什么，

```
$(function() {
  $("#token").tokenInput("http://localhost/token/search?callback=jsonprocess", {
    preventDuplicates: true,
    crossDomain: false, //it's also false as default.
  });
}); 
```

在 PHP 中，您必须启用 CORS，并且您不需要将结果带入回调函数。您将只转储 JSON。

```
header("Access-Control-Allow-Origin: *");
header('Content-type: text/javascript');
echo json_encode($token_array);
exit; 
```*

# iphone - 如果使用自定义字体，Apple 会拒绝我的应用程序吗？

> ID：13594007
> 
> 赞同：1
> 
> 时间：2012-11-27T22:06:22.433
> 
> 标签：iphone, fonts, appstore-approval

我一直在阅读[App Store Review Guidelines](https://developer.apple.com/appstore/resources/approval/guidelines.html)（包括链接的网站），试图了解应用程序中使用的字体是否存在一些限制。我正在做一个需要看起来很现代的应用程序，排版是让它看起来非常重要的事情。我在官方文档上没有找到任何相关的主题，但我不确定他们是否会通过审查。现在我正在使用 Roboto 字体（来自 Android，是的），因为它看起来非常棒，但它是 Android 字体这一事实可能会给审批过程带来问题。有没有人遇到过这种情况或知道在那种情况下发生了什么？应用程序中使用的排版是否有任何限制？非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T22:10:48.350

只要您拥有使用该字体的许可（“权利”），Apple 就不会在意。

App Store 审核指南 8.5：

`Apps may not use protected third party material such as trademarks, copyrights, patents or violate 3rd party terms of use. Authorization to use such material must be provided upon request.`

Roboto 的许可证是 Apache 2 许可证，可在[http://www.fontsquirrel.com/license/roboto获得](http://www.fontsquirrel.com/license/roboto)

要做的主要事情并不是严格要求应用商店的批准（尽管它可能有助于符合人机界面准则），而是为了统一美学。确保确实需要使用自定义字体。iOS 包含相当多的字体： http: [//iosfonts.com](http://iosfonts.com)并且尽可能使用内置组件总是好的。

# directx - 像素着色器中的全屏四边形具有屏幕坐标？

> ID：13594015
> 
> 赞同：3
> 
> 时间：2012-11-27T22:06:50.873
> 
> 标签：directx, hlsl

我有一个 640x480 的渲染目标（它的主要后备缓冲区）。

我将一个全屏四边形传递给顶点着色器，全屏四边形的 X 和 Y 坐标都在 [-1,1] 之间，这意味着我只将坐标传递给像素着色器而不进行计算：

```
struct VSInput
{
    float4 Position : SV_POSITION0;
};

struct VSOutput
{
    float4 Position : SV_POSITION0;
};

VSOutput VS(VSInput input)
{
    VSOutput output = (VSOutput)0;
    output.Position = input.Position;
    return output;
} 
```

但在像素着色器上，每个片段的 x 和 y 坐标位于屏幕空间中（0 < x < 640 和 0 < y < 480）。这是为什么？我一直认为坐标会在到达像素着色器的途中被插值并设置在 -1,1 之间，在这种情况下更是如此，因为我在顶点着色器上硬编码了 -1 和 1 之间的坐标！

但事实是，这个像素着色器有效：

```
float x = input.Position.x;

if(x < 200)
    output.Diffuse = float4(1.0, 0.0, 0.0, 1.0);
else if( x > 400)
    output.Diffuse = float4(0.0, 0.0, 1.0, 1.0);
else
    output.Diffuse = float4(0.0, 1.0, 0.0, 1.0);

return output; 
```

它在我的渲染窗口上输出 3 条彩色条纹，但如果我将屏幕空间（上面代码中的 200 和 400）的值更改为 -1,1 空间并使用类似 if(x < 0.5) 的东西，它将无法工作。

我已经试过了

> 浮点 x = input.Position.x / input.Position.w;

因为我在某处读到这样我可以获得-1,1之间的值，但它也不起作用。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T23:51:56.870

从关于 SV_POSITION的[语义页面上的 MSDN ：](http://msdn.microsoft.com/en-us/library/windows/desktop/bb509647%28v=vs.85%29.aspx)

> 在像素着色器中使用时，SV_Position 描述像素位置。

所以你看到了预期的行为。

最好的解决方案是将屏幕空间坐标作为附加参数传递。我喜欢使用这个“全屏三角形”顶点着色器：

```
struct VSQuadOut {
    float4 position : SV_Position;
    float2 uv: TexCoord;
};

// outputs a full screen triangle with screen-space coordinates
// input: three empty vertices
VSQuadOut VSQuad( uint vertexID : SV_VertexID ){
    VSQuadOut result;
    result.uv = float2((vertexID << 1) & 2, vertexID & 2);
    result.position = float4(result.uv * float2(2.0f, -2.0f) + float2(-1.0f, 1.0f), 0.0f, 1.0f);
    return result;
} 
```

（原文出处：[不带顶点缓冲的全屏四边形？](http://www.gamedev.net/topic/609917-full-screen-quad-without-vertex-buffer/page__p__4857328#entry4857328)）

# php - var_dump 输出空字符串 - php

> ID：13594019
> 
> 赞同：3
> 
> 时间：2012-11-27T22:06:59.627
> 
> 标签：php, mysql, var-dump

嗨，我正在执行一个 SQL 查询（只返回一行），我正在屏幕上打印一个特定的列，只是为了测试目的。我遇到的问题是，我正在打印的列包含一个 12 个字符的字符串（abcdef123456），但有时打印的变量为空。所以当我这样做的时候`var_dump($test);`

有时我得到：

```
string(12) "abcdef123456" 
```

但其他时候我得到

```
string(12) "" 
```

我不明白为什么它知道有 12 个字符但它仍然是空的，有时它说 12 个字符但它已经满了。因此，我无法执行其他功能，因为它们依赖于字符串。

编辑：这是查询

```
$query="SELECT * FROM members WHERE name='$member'";
$sqlResult=mysql_query($query);
$row = mysql_fetch_assoc($sqlResult);
$test = $row["membercode"];
var_dump($test); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:10:24.990

你在哪里看到它说的`string(12) ""`？请记住始终查看原始输出；源代码。不是浏览器如何呈现它。

例如，如果字符串是`<span></span>`，那将显示为空。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:11:27.930

1.  尝试添加`header('Content-Type: text/plain')`以将您的页面呈现为文本而不是 HTML。或者使用“查看源代码”来查看 HTML 源代码而不是呈现的页面。字符串中可能有隐藏的 HTML 标签。

2.  试试`var_dump(bin2hex($test))`。可能有一些不可见的控制字符，例如`"\0"`您看不到的。例如：

    ```
    $ php <<< '<?php var_dump("\0\0\0\0"); ?>'
    string(4) ""
    $ php <<< '<?php var_dump(bin2hex("\0\0\0\0")); ?>'
    string(8) "00000000" 
    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:09:29.913

您的字符串中很可能有浏览器正在呈现的 html 标记。

```
$foo = "<p><img><div><table>";
var_dump($foo); // string(20) "" 
```

# r - 计算导数 diff() 并保持长度 - 添加 NA

> ID：13594021
> 
> 赞同：6
> 
> 时间：2012-11-27T22:07:23.167
> 
> 标签：r

如何计算数据框中列的数值导数（使用 diff()）并通过添加 NA 值来保持长度？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-27T22:12:05.980

目前尚不清楚您到底想要 NA 在哪里，但您可以直接将它们连接起来。

```
 dif <- c(NA, diff(dfrm$id, lag=1)) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-09-14T08:50:43.187

从这个[答案](https://stackoverflow.com/a/39485948/90580)到我的一个问题。

如果您正在寻找一种通用的方式来预先`NA`

```
pad  <- function(x, n) {
    len.diff <- n - length(x)
    c(rep(NA, len.diff), x) 
} 

x <- 1:10
dif <- pad(diff(x, lag=1), length(x)) 
```

但如果你不害怕带`zoo`图书馆**，最好这样做**：

```
library(zoo)
x <- 1:5
as.vector(diff(zoo(x), na.pad=TRUE)) # convert x to zoo first, then diff (that invokes zoo's diff which takes a na.pad=TRUE)
# NA 1 1 1 1 (same length as original x vector) 
```

# asp.net-web-api - Web API - 支持的动词？

> ID：13594023
> 
> 赞同：3
> 
> 时间：2012-11-27T22:07:31.887
> 
> 标签：asp.net-web-api, asp.net-web-api-routing

我正在为本地代码营组织一次演讲，并试图了解 ApiController 中 HTTP 动词的细微差别。在 Beta、RC 和最终版本之间，关于 ApiController 的一些事情发生了显着变化，关于如何设置它的建议是相互矛盾的，有时甚至是错误的。

假设我只是将标准路由留在 WebApiConfig 中：

```
 config.Routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional } 
```

（因为如果你在这里添加一个 {action} 参数，你真的可以把事情放在他们的头上）

我了解该约定如何适用于简单的 Crud 调用，例如：

```
 // GET api/values
    public IEnumerable<string> Get()
    {
        return new string[] { "value1", "value2" };
    }

    // GET api/values/5
    public string Get(int id)
    {
        return "value";
    }

    // POST api/values
    public void Post([FromBody]string value)
    {
    } 
```

或者，只要它们以动词名称开头，您就可以更改它们：

```
 // GET api/values/5
    public string GetMyStuff(int id)
    {
        return "value";
    } 
```

但是，最初的规范说 ApiController 支持 Get、Put、Post 和 Delete。然而，我可以添加以下方法：

```
 public void HeadOfTheClass()
    {
    } 
```

这适用于头部动词，但我不能为晦涩或不存在的动词添加方法：

```
 public void MKCOL()
    {
    }
    public void Bubba()
    {
    } 
```

原生“支持”动词的完整列表是什么？

但是，我可以使用 AcceptVerb 属性添加对这些方法的支持：

```
 [AcceptVerbs("MKCOL")] 
    public void MKCOL()
    {
    }
    [AcceptVerbs("Bubba")]
    public void Bubba()
    {
    } 
```

这也有效，或者对于任何“定义的”动词使用 Http 属性：

```
 [HttpHead]
    public void HeadOfTheClass()
    {
    }

   [HttpGet]
    public void Bubba()
    {
    } 
```

哪个是正确的或首选的？（还有像 [GET] 和 [POST] 这样的属性，这些是否已弃用？）

[HttpBindNever] 和 [NonAction] 是否等效？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T00:32:22.400

我喜欢开源。:)

来自 ReflectedHttpActionDescriptor：

```
private static readonly HttpMethod[] _supportedHttpMethodsByConvention = 
    { 
        HttpMethod.Get, 
        HttpMethod.Post, 
        HttpMethod.Put, 
        HttpMethod.Delete, 
        HttpMethod.Head, 
        HttpMethod.Options, 
        new HttpMethod("PATCH") 
    }; 
```

# c - MS SQL Server 跟踪日志的集合

> ID：13594024
> 
> 赞同：0
> 
> 时间：2012-11-27T22:07:39.820
> 
> 标签：c, sql-server, smo, etw

我需要编写一个可以从 C 代码中收集 SQL Server 跟踪日志的程序。似乎有几种方法可以做到这一点：

1.  使用最常见的[SQL 跟踪](http://msdn.microsoft.com/en-us/library/ms191006%28v=sql.105%29.aspx)方法，其中跟踪文件通过存储过程映射到表。然后可以使用 SQL/ODBC 收集此跟踪日志。这样做的问题是跟踪文件被旋转并且大小受到限制。收集跟踪时，可能会交换跟踪文件，但并未收集所有事件。其次，这些存储过程将在未来的版本中[删除](http://msdn.microsoft.com/en-us/library/ms173875.aspx)，因此在此基础上进行构建似乎不是一个好主意。
2.  推荐的方法是使用[扩展事件](http://msdn.microsoft.com/en-us/library/bb630339%28v=sql.105%29.aspx)。这支持 ETW 和文件目标，但服务器端的设置似乎更复杂，并且并非所有 SQL Server 版本似乎都支持这一点。
3.  还有[SMO](http://msdn.microsoft.com/en-us//library/ms162169.aspx)，但这不提供 C API。

那么正确收集 SQL Server 跟踪日志的推荐方法是什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-10T04:04:28.910

这似乎是一个流行的问题。学习 C# 并使用

```
public void FileToTable()
{
    TraceServer reader = new TraceServer();

    ConnectionInfoBase ci = new SqlConnectionInfo("localhost");
    ((SqlConnectionInfo)ci).UseIntegratedSecurity = true;

    reader.InitializeAsReader(ci, @"Standard.tdf");

    int eventNumber = 0;

    while (reader.Read())
    {
        Console.Write( "{0}\n", reader.GetValue(0).ToString() );
    }
    reader.Close();        
} 
```

# enterprise-library - 用于记录到平面文件跟踪侦听器的企业库

> ID：13594027
> 
> 赞同：0
> 
> 时间：2012-11-27T22:07:49.533
> 
> 标签：enterprise-library, error-logging

需要对服务器（运行 IIS 7.5）中的 Error.log 文件授予什么样的权限，以便将错误写入 Error.log 文件？

我创建了一个名为 ErrorLog 的目录，并在 web.config 中设置了监听器，如下所示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T13:02:39.723

正在使用的 Windows 身份（取决于您的身份验证方式）

```
var principal = ClaimsPrincipal.Current;  //normally this reverts to Thread.CurrentPrincipal, but can be changed
return principal.Identity.Name; 
```

或者

```
var windowsIdentity = WindowsIdentity.GetCurrent();
            if (windowsIdentity != null)
            {
                return windowsIdentity.Name;
            } 
```

执行 windows 身份将需要在目录中创建权限并对 EL 配置中指定的文件具有写入权限。您可以使用 config.xml 将文件放置在您喜欢的任何位置。没有路径的文件的默认值是包含程序集 dll 的启动项目目录。

请参阅在 IIS 中网站使用的**应用程序池**。池确定 windows 身份。请参阅**Pool 的高级设置选项卡**。此处定义了要使用的标识方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T19:23:15.447

我没有看到您的配置示例，但是..

我发现最好不要在开发之外使用平面文件。事件日志或数据库侦听器更适合生产中的 Web 应用程序。

如果您必须使用平面文件，则需要授予帐户（对于分配给 Web 应用程序的应用程序池）对应在其中创建文件的目录的写入权限。默认情况下，我认为这是 Web 应用程序的 bin目录，除非您在配置中的文件名中包含路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T03:19:18.620

这可能取决于您的应用程序在什么上下文中运行。应用程序池线程负责写入日志，因此授予与您的应用程序池相同身份的读/写文件夹权限。我认为这是 NETWORKSERVICE 默认情况下。

# jquery - 使用附加输入数据自动完成标记

> ID：13594031
> 
> 赞同：3
> 
> 时间：2012-11-27T22:08:04.010
> 
> 标签：jquery, autocomplete, tags

你们都知道 Stackoverflows 的标签输入字段中的一维自动完成标签。现在看看这个：[http](http://documentcloud.github.com/visualsearch/#demo) ://documentcloud.github.com/visualsearch/#demo：对于给定的方面（国家、帐户、...），您还可以输入自定义信息。不幸的是，构面列表是静态的，我无法在输入字段中输入时“即时”添加新构面。有谁知道准二维自动完成标签/构面形式的解决方案，其中标签/构面是可变的并作为附加信息自动完成？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T12:58:34.477

您应该检查[http://podio.github.com/jquery-mentions-input/](http://podio.github.com/jquery-mentions-input/)。它允许您基于 triggerChar 自动完成。有可能在 textarea 上多次使用它？！

编辑：这个稍微好一点，可以接受多个触发字符。 [https://github.com/dtime/jquery-mentions-input](https://github.com/dtime/jquery-mentions-input)

编辑：我发现我最喜欢这个版本：http: [//daniel-zahariev.github.com/jquery-textntags/](http://daniel-zahariev.github.com/jquery-textntags/)

# html - 表格单元格布局和空 div 的奇怪行为

> ID：13594033
> 
> 赞同：3
> 
> 时间：2012-11-27T22:08:08.977
> 
> 标签：html, css

我只是偶然发现了一个使用`table-cell`css 属性的布局的非常奇怪的行为。我在当前的 FF、Safari 和 Chrome 中尝试了以下代码。行为在任何地方都是相同的。

**我的问题**是是否有人知道为什么会发生这种情况。它是浏览器错误还是定义的行为？我发现[这个](https://stackoverflow.com/questions/7451626/issue-with-div-set-to-display-table-cell)问题暗示了如何解决这个问题，但我想知道为什么会发生这种情况。我想其他人也想知道。

**问题：**如果我在`&nbsp;`第二个表格单元格中评论，一切都很好。但是，如果*div*保持为空，则其他两个单元格的内容类似于“偏移顶部”。此偏移量与中间单元格的高度具有相同的尺寸。即外部单元格的内容被移到底部。我添加了两个截图*div_not_empty.png*和*div_empty.png*。

谢谢

**更新** 我忘记了截图。他们来了： ![分区为空](../Images/b47fd587be0435d8ccabb1a473f0d21b.png) ![div 不为空](../Images/a8fc4e0f3278719d73f2196233ed070d.png)

* * *

代码：

```
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>Strange behavior with table-cell formatting</title>
    <style type="text/css" media="screen">
      #table {
        display:    table;
        background: #efefef;
      }
      div.cell {
        display:    table-cell;
      }
      #c1 div.content {
        width:    200px;
      }
      #c2 {
        border-left: 2px solid #ccc;
      }
      #c2 div.content {
        height:   150px;
        width:    150px;
        background: #aaa;
        vertical-align: bottom;
      }
      #c3 {
        width:    200px;
        border-left: 2px solid #ccc;
      }
    </style>
  </head>
  <body>
    <div id="table">
      <form id="c1" class="cell">
        <div class="content">
          Lorem ipsum dolor sit amet, consectetur adipisicing 
          elit, sed do eiusmod tempor incididunt ut.
        </div>
      </form>
      <div id="c2" class="cell">
        <div class="content">
          <!-- &nbsp; -->
        </div>
      </div>
      <div id="c3" class="cell">
        <div class="content">
           Dolore magna aliqua. Ut enim ad minim veniam, 
           quis nostrud exercitation ullamco laboris nisi ut 
           aliquip ex ea commodo consequat. Duis aute irure 
           dolor in reprehenderit.
        </div>
      </div>
    </div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T22:37:42.417

这与`vertical-align: bottom`计算方式有关 - 请参阅[mdc 文档](http://developer.mozilla.org/en-US/docs/CSS/vertical-align)，当应用于表格单元格时，`bottom`“将单元格的底部填充边缘与行的底部对齐”。

当表格单元格没有内容时，框内不绘制填充（即当为0时，如果有内容，浏览器会计算填充的位置）。

有了`&nbsp;`元素，就有内容可以作为对齐的基础；没有它，您会注意到浏览器将元素本身的底部与其他元素中第一行内容的底部对齐。

回复：您链接到的问题，使用`vertical-align: top`作品，因为布局是根据块元素的顶部计算的，而不是它们包含的内容。

`&nbsp;`解决此问题的一个简单方法是在样式表中的 .content div 中添加填充，然后使它们呈现为好像它们有内容一样，这意味着当没有可显示的内容时，您不需要在代码中包含's：

```
 div.content {
    height:   150px;
    padding-bottom: 1px;
  } 
```

试试这个，你会看到它的行为符合你的预期。

所以; 并不是真正的浏览器错误，因为浏览器正在尝试根据元素的内容（或填充的底部）计算位置，并且该元素没有内容。在这种情况下，可能是规范的意外副作用。

在相关说明中，您的 css 规则与作为元素`div.cell`的第一个“单元格”不匹配`form`。它之所以有效，是因为元素内的所有元素`display: table`都已`display: table-cell`自动应用，但不是最好的。

# r - 格式化R中的所有小数位

> ID：13594049
> 
> 赞同：8
> 
> 时间：2012-11-27T22:09:37.273
> 
> 标签：r

如何使用一个命令指定整个 R 会话期间显示的位数？也就是说，我怎样才能获得`0`始终显示为的值`0.0`？我已经尝试了命令`options(digits=1)`，但`0`仍然显示为`0`而不是`0.0`。我真的很想避免将每个命令包装在类似`print(ifelse(x==0,"0.0",x))`.

如果这个问题的解决方案`5`显示为`5.0`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T22:26:57.770

我不确定是否有一个`options`for 尾随 0。一种可能性是拥有自己的 print.numeric 和 print.integer 函数。

```
print.integer <- print.numeric <- function(..., digs=1)   {
    print(format(as.numeric(...), nsmall=digs), quote=F)
} 
```

它仍然需要`print`，但更整洁

```
> print(-1:5)
[1] -1.0  0.0  1.0  2.0  3.0  4.0  5.0 
```

* * *

或者，您可以`nsmall`直接使用格式中的参数。

```
mat <- matrix(as.numeric(rep(0:3, 5)), ncol=4)
print(format(mat, nsmall=2), quote=F) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-30T13:00:16.910

你可以试试我的包[formattable](https://github.com/renkun-ken/formattable)。

```
> # devtools::install_github("renkun-ken/formattable")
> library(formattable)
> n <- formattable(0, format = "f", digits = 1)
> n
[1] 0.0 
```

`n`是`formattable, numeric`在算术计算中保留其格式的向量。

```
> n+5
[1] 5.0 
```

# matlab - 选择数据集的百分比

> ID：13594050
> 
> 赞同：1
> 
> 时间：2012-11-27T22:09:42.703
> 
> 标签：matlab, octave

我是 matlab 新手，我在文档中找不到任何内容，我有一种对数据集进行采样的方法，但我想知道如何使用百分比而不是使用直接数字：

```
normIdx = strmatch('normal.', TestDataLabels);
normalSubset = Testdata(normIdx, :);
normal = randperm(size(normalSubset , 1));
p = (normal(1:10000))'; % here I choose 10000 samples but I would like to use a percentage 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:32:30.710

你的意思是这样吗？

```
pcnt = 75; % The percent of original data set size you wish your sample size to be
sampleN = ceil( (pcnt/100) * length(normal) ); % figure out what pcnt percent of original N is, and round upward

p = normal(1:sampleN)'; 
```

# c++ - 将 LARGE_INTEGER 转换为 base 64 字符串

> ID：13594052
> 
> 赞同：1
> 
> 时间：2012-11-27T22:09:50.007
> 
> 标签：c++

我`QueryPerformanceCounter();`用来获取一个数字，用作要包含在文件名中的唯一时间戳。

```
LARGE_INTEGER performanceCount;
QueryPerformanceCounter(&performanceCount); 
```

我需要将`performanceCount.HighPart`哪个类型`LONG`和`performanceCount.LowPart`哪个类型编码`DWORD`为 base64 字符串。然后连接它们并将它们存储在一个`wstring`变量中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:06:25.997

为避免将 base64-chars 与文件名一起使用时出现问题[（请参阅此问题）](https://stackoverflow.com/questions/3945541/base64-encoding-safe-for-filenames)，使用 base16 的有限字符集可能会更好。即使在 32 位编译中，MS 仍然支持 LARGE_INTEGER 的 QuadPart 成员[，](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383713%28v=vs.85%29.aspx)所以我们正在使用它。

**编辑**：根据评论建议，这样做的主要方法应该是使用字符串流：

```
#include <sstream>
#include <iomanip>

std::wstring LargeIntToString(const LARGE_INTEGER& li)
{
    std::wstringstream wss;
    wss << hex << setw(16) << setfill(L'0') << li.QuadPart;
    return wss.str();
}

int main()
{
    LARGE_INTEGER li;
    QueryPerformanceCounter(&li);

    wcout << LargeIntToString(li) << endl;
    return 0;
} 
```

**输出**（无论如何，当时我在我的机器上运行它）

```
00000041f40cdd33 
```

# capybara - Capybara RackTest 无法单击或找到按钮，但 Selenium 可以

> ID：13594057
> 
> 赞同：0
> 
> 时间：2012-11-27T22:10:18.593
> 
> 标签：capybara, selenium-webdriver, rack-test

我在使用 Capybara (2.0.0) 进行 Cucumber 测试时遇到问题。

`page.html`这是在 RackTest 中运行时生成的（有效）html ：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <title>EmbeddedUiWeb</title>
</head>
<body class="embedded_ui">

<form action="/patient_context/test_host" id="patientidentity" method="POST">
  <input id="root" name="root" type="text" value="root"/>
  <input id="extension" name="extension" type="text" value="extension"/>
  <input class="btn" type="Submit" value="Show Stuff"/>
</form>

</body></html> 
```

Capybara 方法`click_on("Show Stuff")`返回错误：

```
 Unable to find link or button "Show Stuff" (Capybara::ElementNotFound)
  org/jruby/RubyBasicObject.java:1704:in `__send__'
  org/jruby/RubyKernel.java:2101:in `send'
  org/jruby/RubyBasicObject.java:1704:in `__send__'
  org/jruby/RubyKernel.java:2101:in `send' 
```

使用 Selenium 驱动程序时它工作正常，有趣的是，它有一个不同的源`page.html`

```
<HTML><HEAD><META content="IE=8.0000" http-equiv="X-UA-Compatible">
<TITLE>EmbeddedUiWeb</TITLE></HEAD>
<BODY class=embedded_ui>
<FORM id=patientidentity method=post action=/patient_context/test_host>
<INPUT id=root value=root type=text name=root></INPUT> 
<INPUT id=extension value=extension type=text name=extension></INPUT> 
<INPUT class=btn value="Show Stuff" type=submit></INPUT> 
</FORM>
</BODY></HTML> 
```

谢谢你的帮助！我需要它！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T14:28:39.097

属性必须全部小写。设置按钮`type=submit`解决了问题

# scheme - Scheme中如何计算列表中的语句数

> ID：13594061
> 
> 赞同：-5
> 
> 时间：2012-11-27T22:10:29.517
> 
> 标签：scheme, racket

statement -> if bool then statement_list -> while bool statement_list -> id = 表达式

所以如果输入：((id = id + id)(if bool then (if bool then (id = id + id))(id = const / const)(id = id + id))(while bool (id = id - const)(id = id - id)))

语句数应为 9。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T23:50:09.733

方案是同音的。没有办法区分表示方案代码（例如语句）的列表和表示数据的列表，因为方案代码*是*方案数据。但是，当然可以计算一个列表中包含多少个列表，这可以通过以下函数完成。

```
(define (list-count list)
  (cond ((null? list) 0)
        ((list? (car list))
         (+ (list-count (car list)) 
            (list-count (cdr list))
            1))
        (else (list-count (cdr list))))) 
```

根据您的规范，`9`当您给出问题中的列表时，这将返回。

```
> (list-count '((id = id + id)(if bool then (if bool then ( id = id + id ))(id = const / const)(id = id + id))(while bool (id = id - const)(id = id - id))))
9 
```

# mysql - 如何通过 phpmyadmin 创建触发器？

> ID：13594062
> 
> 赞同：1
> 
> 时间：2012-11-27T22:10:30.243
> 
> 标签：mysql, triggers, phpmyadmin

在我的 wamp 服务器上，我有一个 phpMyadmin 版本，允许我通过界面创建触发器。但是在我的服务器上来自 OVH 该选项不存在，所以我尝试更新几乎所有我可以（mysql，phpmyadmin）的东西，现在似乎与我的本地安装相同。但我仍然不能做那个手术。当我比较两个版本时，表 informations_schema 存在一些差异，但我不知道如何解决该问题。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T12:18:25.807

phpMyAdmin 仅在您的 MySQL 服务器支持触发器（MySQL 5.0.2 及更高版本）并且您的用户被允许创建触发器（他需要“TRIGGER”权限）时才显示此选项。您可以通过在 phpMyAdmin 的 SQL 查询框中查询“SHOW GRANTS”来检查您的权限。也许您的提供商不希望您使用触发器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:14:18.627

If your user have rights to create triggers try to use [CREATE TRIGGER Syntax](http://dev.mysql.com/doc/refman/5.0/en/create-trigger.html)

Or use [Devart dbForge Studio](http://www.devart.com/dbforge/mysql/studio/) - the best tool for mysql

# php - CakePHP 1.3.10 元素缓存

> ID：13594065
> 
> 赞同：0
> 
> 时间：2012-11-27T22:10:52.047
> 
> 标签：php, performance, cakephp, caching

我正在尝试为某些元素设置元素缓存，但无论我做什么，我都无法将缓存文件写入 tmp/cache/view/

这是元素的代码

```
echo $this->element('carinfo',
array(
    'car_id' => $car['Car']['id'],
    'show_user_info_box' => true,
    'car_display_size' => 'medium'
),
array('cache' => '+1 day')
); 
```

我的 core.php 中有以下所有设置

```
Configure::write('debug', 0);
Configure::write('Cache.check', true); 
```

我在这里真的很茫然，因此网站的速度真的很糟糕。

我还尝试了 'cache' => '35000' 和 'cache' => '1 day' 等的所有变体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:02:06.883

将`cache`键/值放入第二个参数 - 元素将布尔值作为第三个参数，而不是数组。

# android - 如何通过音频插孔检测输入数据？

> ID：13594074
> 
> 赞同：11
> 
> 时间：2012-11-27T22:11:28.063
> 
> 标签：android, audio, microphone

我知道某些设备的耳机端口（可能全部？这里的任何参考都很好）有 3 个通道，用于立体声和麦克风。所以我想知道是否有可能在这些设备上检测到类似[这个踏板的东西。](http://www.sweetwater.com/store/detail/PedalExp/)

如果可能的话，使用[录音机](http://developer.android.com/reference/android/media/AudioRecord.html)就足够了吗？我在这里研究应用程序的可能性，如果可能的话，这听起来很有希望。

谢谢

**编辑**

我正在寻找更多关于它的信息，我想知道踏板是否会与那些带按钮的耳机具有相同的效果。[覆盖它们的效果非常容易，](https://stackoverflow.com/questions/6287116/android-registering-a-headset-button-click-with-broadcastreceiver)我创建了一个简单的应用程序，现在我正在等待我的踏板尝试。有什么想法吗？

**更新**

我刚刚在踏板上试过了，它不起作用。尽管我们设法使用踏板来暂停音乐应用程序。不过，该设备正在运行 Cyanogen。录音机也没有检测到按键上的任何内容。需要有关如何检测它的建议:)。

**更新**

由于赏金即将到期，因此进行了一次小更新。@Nick.T 提供的最后一个链接得到了一些有用的信息，但我仍然无法创建样本来检测踏板。所以我在标题问题上做了一个小改动，非常感谢任何关于这个方向的指导！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T19:58:16.050

目前尚不清楚这是否会在我手中没有实际硬件的情况下工作，但是......不要将插孔一直插入插座。然后，插孔的尖端应连接到此图的引脚 2，左侧音频输出：http: [//pinoutsguide.com/CellularPhones-PW/samsung_galaxy_headset_pinout.shtml](http://pinoutsguide.com/CellularPhones-P-W/samsung_galaxy_headset_pinout.shtml) 并且环应连接到引脚 3，麦克风输入。如果你推插孔一直插进去，插孔上的接地引脚使麦克风输入短路，您不会检测到任何东西 - [https://en.wikipedia.org/wiki/File:Photo-audiojacks.jpg](https://en.wikipedia.org/wiki/File:Photo-audiojacks.jpg)上的图片显示了如何连接将匹配。

从左声道播放一些音频，在麦克风声道上录制，然后测量幅度。这可能 - 如果所有连接都正确 - 会告诉您踏板位置。如果电位器的远端连接到插孔的环上，那是行不通的。

这一切听起来更像是希思·罗宾逊。您可以购买一个直列 3 针母插孔插座和一个 4 针公插孔插头，然后将两者连接在一起以获得您需要的任何引脚排列。没有电子产品；只是连接器和一些电线！或者使用这样的电缆： [http ://www.ebay.co.uk/itm/1mt-3-5mm-4-Pin-Jack-Male-Plug-4-Pole-Jack-female-Socket-Extension-铅电缆-/251172651017?pt=UK_Computing_Sound_Vision_Audio_Cables_Adapters&hash=item3a7b0e8009&_uhb=1](http://www.ebay.co.uk/itm/1mt-3-5mm-4-Pin-Jack-Male-Plug-4-Pole-Jack-female-Socket-Extension-Lead-Cable-/251172651017?pt=UK_Computing_Sound_Vision_Audio_Cables_Adapters&hash=item3a7b0e8009&_uhb=1) 和一把锋利的刀和一些胶带。

如果在插孔未完全插入时手机拒绝向插孔发送音频，则会出现另一个问题 - 插座中有一个额外的触点可以机械地检测到这一点。但是，如果您制作 3 针转 4 针适配器，它会起作用。

或者，只需将 3.5 毫米插孔从您的（闪亮的新）表情踏板上剪下来。将其替换为您躺在身边的其中一个损坏的电话耳机上的 4 针连接器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T15:10:05.327

根据您上次的更新，看起来踏板的反应就像免提耳机上的按钮一样。也就是说，播放、暂停和跳过音乐或接听/挂断电话。如果 API 的基础知识无法让您掌握它（我对此表示怀疑），那么您可以向下移动到 NDK 并查看它是否可以被本机级别捕获。

我查了一下，认为这可能会帮助您找到自己的方式：

*   [音频硬件](http://developer.android.com/training/managing-audio/audio-output.html)

永远不知道...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:19:07.730

这里有两条潜在的可能性路径。

*   一种是使用耳机（或者更具体地说是麦克风）存在检测电路，并通过适当的 API 读取该状态。这将相当简单（只需弄清楚正在测量真实耳机的哪些属性）。但是，很有可能响应可能相当慢，因为手机可能会经历一些音频配置更改，并且在“确定”耳机已连接或断开之前不会这样做。此外，最简单的非麦克风耳机检测可能是通过插孔中的机械机制进行的，这可能难以跨型号进行电驱动。

*   一个更复杂的想法是将一些声音耦合到麦克风输入中，并在软件中进行检测。但是，它必须是一个振荡信号，因为麦克风带宽通常不会低至 DC。如果你只是施加一个稳定的电压，当它改变时你会得到一个“咔哒”瞬变，但不会。注入音频信号需要电源 - 通过精心设计，您可能能够从麦克风偏置电源中窃取足够的功率来运行小型振荡器。但也许更简单的方法是让软件在扬声器上输出音频，然后让您的踏板开关通过一个小电容器将其耦合回麦克风。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-06T15:53:51.413

我终于设法读取了踏板输入。@emrys57 是对的，用 4 针连接器替换插孔，触发输入的方式与带有挂钩按钮的麦克风相同。但是偶尔它似乎也会触发音量增大和音量减小键。我想这与我用刀和胶带替换 4 针插孔有关。

覆盖 onKeyUp 相当简单。请注意，您还必须覆盖 onKeyDown 以防止默认行为：

```
@Override
public boolean onKeyDown(int keyCode,KeyEvent event){
    int action = event.getAction();
    if (keyCode == KeyEvent.KEYCODE_VOLUME_UP
            || keyCode == KeyEvent.KEYCODE_VOLUME_DOWN
            || keyCode == KeyEvent.KEYCODE_HEADSETHOOK) {

        if (action == KeyEvent.ACTION_UP) {
            Log.d(TAG, "action_up");
            clickStart(null);
            return true;
        } else if (action == KeyEvent.ACTION_DOWN) {
            Log.d(TAG, "action_down");
            return true;
        } else {
            Log.d(TAG, "action:" + action);
            return true;
        }
    }
    return false;
}

@Override
public boolean onKeyUp(int keyCode, KeyEvent event) {
    int action = event.getAction();
    Log.d(TAG, "onKeyDown!");
    if (keyCode == KeyEvent.KEYCODE_VOLUME_UP
            || keyCode == KeyEvent.KEYCODE_VOLUME_DOWN
            || keyCode == KeyEvent.KEYCODE_HEADSETHOOK) {

        if (action == KeyEvent.ACTION_UP) {
            Log.d(TAG, "action_up");
            clickStart(null);
            return true;
        } else if (action == KeyEvent.ACTION_DOWN) {
            Log.d(TAG, "action_down");
            return false;
        } else {
            Log.d(TAG, "action:" + action);
            return true;
        }
    }
    if (keyCode == KeyEvent.KEYCODE_BACK) {         
        finish();
        return true;
    }
    Log.d(TAG, "returning false");
    return false;
} 
```

# oracle - 如何在oracle中减去两列Longvarchar

> ID：13594080
> 
> 赞同：0
> 
> 时间：2012-11-27T22:11:40.260
> 
> 标签：oracle

我有`TABLE1`with columns `COL1`，在 Oracle 中`COL2`定义。`LongVarChar`

每次用户将记录加载到 TABLE1 时，COL1 将具有旧值，COL2 将具有旧值 + 新值。IE

例如：

```
COL1            COL2
                Bat
Bat             Bat Ball
Bat Ball        Bat Ball Wicket
Bat Ball Wicket Bat Ball Wicket Stump 
```

为了获得唯一的新值，我计划从 COL1 内容中删除 COL2 的内容..我认为这是一个非常糟糕的主意..

我尝试了通常的“-”运算符，它说`"Expected Numeric but received CLOB"`

但是有没有人有更好的想法或如何做到这一点？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:37:45.020

假设您的意思是 Varchar2，并且（如您的示例中所示），每个旧值都由一个额外的空格分隔，那么这样的事情应该可以工作：

```
SELECT SUBSTR(col2, NVL(LENGTH(col1)+2,0)) "New Value" FROM TABLE1 
```

例如：

```
select substr('Bat', nvl(length(null)+2,0)) from dual; 
```

结果是“蝙蝠”

```
select substr('Bat Ball', nvl(length('Bat')+2,0)) from dual; 
```

结果是“球”

* * *

但是，如果您实际上是在谈论`CLOB`数据类型，请替换：

```
dbms_lob.substr( colX, 4000, 1) 
```

而不是 colX（其中 X 是 1 或 2）

[This will give you the first 4000 bytes of the CLOB - in order to get more, you'd have to use PL/SQL]

# sql - Wordpress SQL 转储以恢复新站点上的示例数据

> ID：13594081
> 
> 赞同：1
> 
> 时间：2012-11-27T22:11:43.273
> 
> 标签：sql, xml, wordpress, themes

我已经建立了一个wordpress站点，安装了一个主题，导入了示例数据xml文件，并在完成这些步骤后对数据库进行了sqldump。我有一个脚本可以自动为新站点创建 wordpress 目录和数据库。我想添加使用转储文件恢复新数据库。我已经能够做到这一点，但是 wp-admin 和 wp-login 的链接指向旧站点的目录而不是新站点的目录。知道为什么会这样以及可以做些什么来避免这种情况吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:45:36.583

我发现了问题。sql 转储只包含所有数据，包括生成的绝对链接。所以我使用 perl 在将数据放入新数据库之前，在 sql 转储中搜索我需要更新的字符串。谢谢。

# php - 无错误，但未创建记录

> ID：13594084
> 
> 赞同：0
> 
> 时间：2012-11-27T22:12:03.620
> 
> 标签：php, mysql, sql

我有一个在数据库中创建发票记录的 html 表单。当表单提交时，会显示“Invoice Created”消息，并且没有错误消息。但是，当我进入数据库时​​，记录显然不存在。我有一个非常相似的表格，可以添加客户记录，它工作得很好。

我的 php 代码的相关部分（连接代码工作正常，我省略了它）：

```
if(isset( $_POST["add"]) ) {
if (!($stmt = $mysqli->prepare("INSERT INTO INVOICE VALUES (?,?,?,?,?,?,?,?,?)"))) {
    echo "Prepare failed: (" . $mysqli->errno . ") " . $mysqli->error;
}

if (!$stmt->bind_param("sssissddd", $_POST['fname'], $_POST['lname'], $_POST['phone'], $_POST['date'], $_POST['invoice_num'], $_POST['item_num'], $_POST['price'], $_POST['discount'], $_POST['total'])) {
    echo "Binding parameters failed: (" . $stmt->errno . ") " . $stmt->error;
}

if (!$stmt->execute()) {
    echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
}

else{
    printf("%d row inserted.<br/>", $stmt->affected_rows);
}

$stmt->close();
} 
```

# python - 在python中的两个线程之间共享一个变量

> ID：13594092
> 
> 赞同：0
> 
> 时间：2012-11-27T22:12:38.823
> 
> 标签：python, multithreading

我想在解释器中使用原子操作在两个线程之间共享一个变量，如此处所述[http://effbot.org/zone/thread-synchronization.htm](http://effbot.org/zone/thread-synchronization.htm)。核心数据类型的简单赋值（单字节码操作）应该是线程安全的，因为 python < 3.2 中的 GIL。理论到此为止。以下代码可以在主模式或从模式（-m 或 -s）下运行。主模式确实通过 UDP 不断发送数据。从模式确实会创建一个线程来从 udp 端口​​读取数据并更新每个接收到的数据包上的变量。

示例代码确实在创建时将共享变量作为参数传递给线程。我也尝试过使用全局变量或将线程本地存储传递给线程。

结果总是一样的。在 read_time_master 线程内，变量被分配。但是在主线程中，共享变量的值没有更新。

```
#!/usr/bin/env python

import socket
import itertools
import multiprocessing
from optparse import OptionParser
from time import sleep

PORT = 1666

def read_time_master(sock, time_master):
   while True:
     time_master = float(sock.recvfrom(1024)[0])

def main():
    time_master = 0.0
    p = OptionParser()
    p.add_option('--master', '-m', action='store_true')
    p.add_option('--slave', '-s', action='store_true')
    options, arguments = p.parse_args()
    if options.master or options.slave:
        sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, 0)
    if options.master:
        sock.connect(('127.0.0.1', PORT))
    if options.slave:
        sock.bind(('0.0.0.0', PORT))
        recv_thread = multiprocessing.Process(target=read_time_master, args=(sock, time_master))
        recv_thread.start()

    for time in itertools.count():
        print time
        if options.slave:
            print "master: %f" % time_master # -> not updated from other thread
        if options.master:
            try:
                sock.send(str(time))
            except socket.error:
                pass
        sleep(1)

    if options.master or options.slave:
        sock.close()

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T22:20:21.417

您正在使用`multiprocessing`, not `threading`，这对您的情况没有帮助。如果您`threading.Thread`用于创建后台工作人员，您*可能*`global time_master`只需在由后台操作控制的函数中进行调用即可获得所需的内容。因为您使用的是`multiprocessing`，而不是`threading`，您可能需要查看`multiprocessing.Queue`该类以查找可用于在进程之间来回传递信息或同步它们的容器。您还可以创建在进程之间共享的变量（所有这些都包含在[Python 主页](http://docs.python.org/2/library/multiprocessing.html#sharing-state-between-processes)`multiprocessing`的文档/示例中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:43:42.873

您可以使用共享内存，如此处[http://docs.python.org/2/library/multiprocessing.html#sharing-state-between-processes](http://docs.python.org/2/library/multiprocessing.html#sharing-state-between-processes)所述。请记住在从共享空间读取之前等待该过程完成。

# asp.net - 从 LinkBut ton 导航到项目文档

> ID：13594093
> 
> 赞同：0
> 
> 时间：2012-11-27T22:12:49.490
> 
> 标签：asp.net

当用户单击 web 表单上的 asp:linkbutton 时，我试图让一个 excel 文件在新窗口中的页面上弹出。我将其设置为使用 OnClick 函数，并在后面的代码中对项目中 excel 文件的位置进行了 response.redirect。您可以在下面的代码中看到这一点。由于某种原因它不起作用，我在浏览器中弹出一个空白页面。这甚至是最佳实践吗？我还可以将链接指向可以存储 excel 文件的共享网络驱动器，但这似乎有点太复杂了。

```
<asp:LinkButton ID="btnCBFormat" runat="server" Text="CB Format Example" OnClick="btnCBFormat_Click" Target="_blank" />
<asp:LinkButton ID="btnMBFormat" runat="server" Text="MB Format Example" OnClick="btnMBFormat_Click" Target="_blank" />

        protected void btnCBFormat_Click(object sender, EventArgs e)
        {
            Response.Redirect("//Chargebacks/Formats/CBFormat.xsl");
        }

        protected void btnMBFormat_Click(object sender, EventArgs e)
        {
            Response.Redirect("//Chargebacks/Formats/MBFormat.xls");
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:31:05.957

首先，我认为 Dai 是对的：您应该使用`<a>`Excel 文件的链接，而不是回发。

其次，我怀疑您遇到的问题与 IIS 未设置为提供 Excel 文件有关。你告诉它加载它不知道如何返回的东西。

这就是它应该的样子。如果您出于其他原因必须回发并且需要将 Excel 流式传输给您的用户，请通过 ASP.NET 研究流式传输文件给用户。这就是通常的做法。

顺便说一句，如果这些 Excel 文件要持续更新，将它们放在文件共享上是有意义的：您将能够在不摆弄 Web 服务器的情况下修改它们。

# c# - 字符串数组和参数的扩展方法

> ID：13594098
> 
> 赞同：9
> 
> 时间：2012-11-27T22:12:54.923
> 
> 标签：c#, extension-methods, params

我怎样才能同时编译这两种方法？

```
public static IEnumerable<string> DoSomething(params string[] args)
{ // do something }
public static IEnumerable<string> DoSomething(this string[] args)
{ // do something } 
```

我得到这个编译错误：

```
Type 'Extensions' already defines a member called 'DoSomething' with the same parameter types Extensions.cs 
```

这样我就可以做到这一点：

```
new string[] { "", "" }.DoSomething();
Extensions.DoSomething("", ""); 
```

如果没有 params 方法，我必须这样做：

```
Extensions.DoSomething(new string[] { "", "" }); 
```

**更新：**基于[OR Mapper的回答](https://stackoverflow.com/users/1430156/o-r-mapper)

```
public static IEnumerable<string> DoSomething(string arg, params string[] args)
{
    // args null check is not required
    string[] argscopy = new string[args.Length + 1];
    argscopy[0] = arg;
    Array.Copy(args, 0, argscopy, 1, args.Length);
    return argscopy.DoSomething();
} 
```

**更新：**我现在喜欢[HugoRune](https://stackoverflow.com/users/145999/hugorune)的回答。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-27T22:15:07.620

您可以向版本添加附加参数`params`：

```
public static IEnumerable<string> DoSomething(string firstArg, params string[] moreArgs) 
```

这应该足以让编译器将其与`string[]`扩展方法区分开来。

正如用户[SLaks](https://stackoverflow.com/users/34397/slaks)`params`所建议的，如果需要支持空数组的情况，则应在这种情况下提供不带任何参数的额外重载：

```
public static IEnumerable<string> DoSomething() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-02T09:40:35.850

迟到的答案：

另一种选择是将两种方法放在不同的类中。由于您在调用扩展方法（带`this`参数的方法）时从不使用类名，因此扩展方法可以在同一命名空间中的任何公共静态类中，没有任何明显的区别。

```
// contains static methods to help with strings
public static class StringTools
{
    public static IEnumerable<string> DoSomething(params string[] args)
    {
        // do something
    }
}

// contains only extension methods
public static class StringToolsExtensions
{
    public static IEnumerable<string> DoSomething(this string[] args)
    {
        return StringTools.DoSomething(args);
    }
} 
```

这样可以避免复制字符串数组，不需要不带参数的额外重载，我会说它看起来更干净。我总是将扩展方法和其他静态方法分开以避免混淆。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:16:34.673

1.  您可以为这两种方法之一指定不同的名称。IE`DoSomething2`
2.  您可以只使用一种方法。相同的方法，相同的参数列表；显然他们在做同样的事情（因为你没有按照#1给他们不同的名字）。把它们结合起来。
3.  您可以更改其中一种方法的参数列表。即（此字符串[] args，对象未使用参数）

# .net - 为本地开发设置 Azure 缓存客户端

> ID：13594100
> 
> 赞同：2
> 
> 时间：2012-11-27T22:13:03.600
> 
> 标签：.net, caching, azure

我在 web.config 中设置了我们的网站，如下所示：

```
<dataCacheClients>
    <dataCacheClient name="default">
      <hosts>
        <host name="mysite.cache.windows.net" cachePort="22233" />
      </hosts>

      <securityProperties mode="Message">
        <messageSecurity
          authorizationInfo="{key}">
        </messageSecurity>
      </securityProperties>
    </dataCacheClient>
  </dataCacheClients> 
```

我想编辑这个，所以当我在我的笔记本电脑上开发时，我没有点击生产缓存，而是我的笔记本电脑上的缓存。

这对 Google 来说是一个难题（至少对我而言），因为“本地 Azure 缓存”会在 Web 角色上提供缓存。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T02:23:21.977

看起来您正在使用 Windows Azure 共享缓存，并且您希望在开发时使用一些本地缓存。

在您的系统中拥有一个抽象缓存层可能会更好，这样您就可以在云和本地之间切换缓存，而不是更改配置。例如，有一个接口`ICache`，比如`GetItem`,`SetItem`等。然后你可以让一些类实现这个接口，这些类在内存缓存中用于本地开发，Azure Cache 用于生产。

在 GitHub 上有一个名为 ServiceStack 的项目，它包含了一些缓存实现，您可以参考[https://github.com/ServiceStack/ServiceStack.Contrib/tree/master/src](https://github.com/ServiceStack/ServiceStack.Contrib/tree/master/src)

Alternatively, you can use the new Cloud Service Caching, which provides co-located/dedicate cache clusters alone with your cloud services (web role and worker role). It has full local emulator support which means you don't need to change any code and any configuration between local development (use local cache emulator) and production.

For more information about this Cloud Service Caching you can refer [https://www.windowsazure.com/en-us/develop/net/how-to-guides/cache/](https://www.windowsazure.com/en-us/develop/net/how-to-guides/cache/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T00:08:59.437

一种选择是使用 Web.config 转换来更改每个部署的配置文件。我不是这方面的专家，但你可以用谷歌弄清楚。

另一种选择是在代码中配置缓存。然后，您可以轻松更改每个环境的 .cscfg 文件中的设置。这是代码中配置的基本示例：

```
DataCacheFactoryConfiguration cacheConfig = new DataCacheFactoryConfiguration();

//Insert the Authentication Token as shown below
cacheConfig.SecurityProperties = new DataCacheSecurity(config.AuthToken, config.UseSSL);

int cachePort = (cacheUseSSL ? 22243 : 22233);
cacheConfig.Servers = new DataCacheServerEndpoint[] { new DataCacheServerEndpoint(cacheHostName, cachePort) };
cacheConfig.RequestTimeout = TimeSpan.FromSeconds(1);
cacheConfig.ChannelOpenTimeout = TimeSpan.FromSeconds(45);
cacheConfig.MaxConnectionsToServer = config.MaxConnections;
cacheConfig.TransportProperties.ReceiveTimeout = TimeSpan.FromSeconds(30);
cacheConfig.TransportProperties.ChannelInitializationTimeout = TimeSpan.FromSeconds(10);

var cacheFactory = new DataCacheFactory(cacheConfig); 
```

# ios - 如何用动画在 x 方向上拉长 UISearchBar？

> ID：13594101
> 
> 赞同：1
> 
> 时间：2012-11-27T22:13:09.147
> 
> 标签：ios, core-animation, uisearchbar

我想将右侧搜索栏向左延长 20 像素，并通过动画将左侧搜索栏向右缩短 20 像素。我怎样才能做到这一点？

```
CGRect leftFrame = self.leftSearchBar.frame;
    //leftFrame.origin.x = leftFrame.origin.x - 20;
    leftFrame.size.width = leftFrame.size.width - 40;

    CGRect rightFrame = self.rightSearchBar.frame;
    rightFrame.origin.x = rightFrame.origin.x - 40;
    rightFrame.size.width = rightFrame.size.width + 40;

    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.5];
    [UIView setAnimationDelay:0.0];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseOut];

    self.leftSearchBar.frame = leftFrame;
    self.rightSearchBar.frame = rightFrame;

    [UIView commitAnimations]; 
```

它不起作用。它首先在没有动画的情况下调整视图的大小，然后使用动画移动正确的视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:15:04.207

假设您没有更改锚点或类似的东西，只需扩展宽度即可使其向右拉伸。将其包装在 UIView 动画块中，它应该根据问题中的规范进行动画处理，如下所示：

```
UISearchBar* searchbar = ...; // However you've created your UISearchBar, we'll refer to it as 'searchbar'

CGRect searchFrame = searchbar.frame;
[UIView animateWithDuration:0.8 
                      delay:0.0
                    options:UIViewAnimationOptionBeginFromCurrentState
                 animations:^{
                     searchFrame.size.width += 30;
                     searchbar.frame = searchFrame;
                 }
                 completion:nil]; 
```

您需要确保`+= 30`不会多次调用 ，否则**每次**调用时您将扩展 30 个点。如果您事先知道大小，则可以简单地将其替换为，如果您`= size + 30`多次调用动画，这是一个更安全的选择。

# android - 包含在 Eclipse 中，用于抛出“找不到资源”的布局

> ID：13594105
> 
> 赞同：1
> 
> 时间：2012-11-27T22:13:23.240
> 
> 标签：android, eclipse, layout

我对 Java 和 Eclipse 完全陌生。我在 /res/layout 下有两个布局文件：

活动主.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >
    <include layout="@layout/layoutTst" />
</LinearLayout> 
```

布局测试.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@+id/layoutTst"
    android:orientation="vertical" >
</LinearLayout> 
```

当我尝试在“包含”部分进行编译时，我收到以下消息：

```
Description Resource    Path    Location    Type error: Error: No resource
found that matches the given name (at 'layout' with value
'@layout/layoutTst').   activity_main.xml   /YouSherlock/res/layout line
6   Android AAPT Problem 
```

那么有什么问题呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:14:40.920

您需要包含布局文件名 ( **layout_test** .xml)，而不是该布局中根的 ID。

```
<include layout="@layout/layout_test" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:15:04.357

```
 @layout/layoutTst 
```

应该是文件名而不是它的 android:id

```
 @layout/layout_test 
```

# jquery-ui - jQuery UI Accordion 子 div 大小

> ID：13594109
> 
> 赞同：2
> 
> 时间：2012-11-27T22:13:48.657
> 
> 标签：jquery-ui, accordion

我的页面上有一个手风琴，子 div 中有不同长度的内容。当手风琴显示时，第一个折叠只有一行文本，但 div 占用的空间与最长的 div 相同。有没有办法让子div在展开时只占用他们需要的空间？

如果这太模糊，我可以发布一些代码来解释我的意思。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:18:52.893

如果您希望手风琴动态调整其包含的内容的高度，您可以实现以下代码：

```
$( "#accordion" ).accordion( "option", "autoHeight", false ); // or true if you want to change back 
```

**或者使用 heightStyle：**

控制手风琴和每个面板的高度。可能的值：

```
"auto" // All panels will be set to the height of the tallest panel.
"fill" //Expand to the available height based on the accordion's parent height.
"content" //Each panel will be only as tall as its content. 
```

代码示例：

使用指定的 heightStyle 选项初始化手风琴：

```
 $( ".selector" ).accordion({ heightStyle: "fill" }); 
```

# ios - HidesBottomBarWhenPushed 离开指示器

> ID：13594112
> 
> 赞同：0
> 
> 时间：2012-11-27T22:14:04.663
> 
> 标签：ios, xamarin.ios, ios6, monotouch.dialog

我有一个设置对话框，我想全屏显示并覆盖屏幕底部的标签栏。我使用[了这个 SO 答案](https://stackoverflow.com/a/6282104/132599)并添加`HidesBottomBarWhenPushed`到我的视图控制器中，它确实隐藏了标签栏。不幸的是，它留下了由子类显示的小三角形指示器子视图`UITabBarController`。

![在此处输入图像描述](../Images/631038f09d278081b6208c4d6bd8d5ac.png)

我假设我可以订阅某种形式的通知以隐藏指示器，但我不知道那是什么。这里有一点帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:44:08.970

当您使用此处描述的方法将栏设置为隐藏时，也许您可​​以发布 NSNotification ？ [无法从 ImageView 访问 TabBarController](https://stackoverflow.com/questions/13546906/cant-access-tabbarcontroller-from-imageview/13546952#13546952)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T17:24:33.163

我将自己回答这个问题，因为我认为值得记录以供将来参考。我有一个`SettingsDialogViewController`我在我的`ViewDidLoad()`方法中连接`HomeDialogViewController`：

```
NavigationItem.LeftBarButtonItem = new UIBarButtonItem("Settings", UIBarButtonItemStyle.Plain, (e, sender) => {
    ActivateController (_settingsDvc());
}); 
```

是`SettingsDialogViewController`用`HidesBottomBarWhenPushed = true`. 因此，当激活设置对话框时，底部栏被隐藏，这会导致调用`ViewWillLayoutSubviews()`方法。`CustomTabBarController`通过覆盖该方法，我可以根据可见视图控制器（例如`SettingsDialogViewController`）在按下时是否隐藏底栏来设置指示器的可见性。当那个视图控制器被弹出时，指示器会自动重新出现。

```
public override void ViewWillLayoutSubviews () {
    base.ViewWillLayoutSubviews ();
    var selectedVc = SelectedViewController as UINavigationController;
    indicator.Hidden = selectedVc != null && selectedVc.VisibleViewController.HidesBottomBarWhenPushed;
} 
```

最后一点，我发现激活新设置视图时出现的动画会在状态栏下方的屏幕上显示一条黑带。我通过`AutoResizingMask`在“来自”视图控制器中设置来解决这个问题。

```
public override void ViewDidLoad () {
    base.ViewDidLoad ();
    NavigationItem.LeftBarButtonItem = new UIBarButtonItem("Settings", UIBarButtonItemStyle.Plain, (e, sender) => {
        ActivateController (_settingsDvc());
    });
    View.AutoresizingMask = UIViewAutoresizing.FlexibleHeight;
} 
```

# c# - 如何从 TFS-API 获取有关警告的信息

> ID：13594117
> 
> 赞同：0
> 
> 时间：2012-11-27T22:14:25.427
> 
> 标签：c#, tfs, tfs-sdk

我正在尝试在 TFS API 中编写一个简单的程序，给定更改集编号，它将获取该更改集中所有文件的最新信息。希望这将使更新构建服务器更容易。

代码使用一些黑魔法计算出需要更新的文件列表。一旦它有一个映射文件的列表，它就`Workspace.Get`会对它们执行一个。这将返回一个`GetStatus`对象。

我遇到的问题是，在我们的一些虚拟构建服务器上，克隆过程产生了未标记为只读的文件。当 TFS 尝试更新这些文件时，这会产生一条警告消息。在这种情况下，`GetStatus.NoActionNeeded`布尔值为 false，并且`GetStatus.NumWarnings`设置为无法获取的文件数。问题是没有办法查明哪些文件特别有这个问题。`GetStatus.GetFailures()`返回一个大小为 0 的数组，所以我不知道如何获取这些信息。

是否可以检索该列表？我想将它呈现给用户，以便他们决定是覆盖有问题的文件还是采取其他措施。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:55:17.923

如果 get 失败并且没有失败，您可以通过获取传递给 get 调用的相同项目列表并将它们传递给来检索冲突列表`Workspace.QueryConflicts`。这将返回与文件名冲突的数组以及有关问题所在的信息。

# internationalization - Silverstripe: Adding to the translation tables

> ID：13594122
> 
> 赞同：0
> 
> 时间：2012-11-27T22:14:41.433
> 
> 标签：internationalization, silverstripe

I need to add additional translations to the Silverstripe 3 translation tables in sapphire/lang/[lang].yml

I am pulling in 'sapphire' as an SVN external so cannot just add the new values to the existing yml files.

Am I able to create additional language yml files for languages to add to these translations in mysite directory?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T10:00:39.380

是的，只需创建一个具有以下结构的新模块：

```
z_translations/
    _config.php
    lang/
        en.yml 
```

前缀确保它按字母顺序排在`z_`最后，目前无法影响加载顺序。该`translations`部分可以是任何东西。`_config.php`可以为空，但需要存在才能将该文件夹检测为模块。

请注意，为了覆盖中的翻译`framework/admin/lang/`，您还必须在模块中创建一个`admin`子文件夹......不要问;）

# java - 用按钮摇摆改变图像

> ID：13594139
> 
> 赞同：2
> 
> 时间：2012-11-27T22:15:33.383
> 
> 标签：java, image, swing, button

我以这种方式定义了 2 个类：

```
public class Cartes extends JPanel
{
  private BufferedImage image;
  protected int tabC[] = new int[9];
  public int randomC ;

  public Cartes ()
  {

    ..........

    BufferedImage myPicture = null;

    try {
      myPicture = ImageIO.read(new File("images/"+randomC+".png"));
    } 
    catch (IOException e)
    {
      // TODO Auto-generated catch block
      e.printStackTrace();
    }

    JLabel picLabel = new JLabel(new ImageIcon( myPicture ));
    add( picLabel );
  }

  public void paintComponent(Graphics g)
  {
    super.paintComponent(g);
    g.drawImage(image, 0, 0, null); //
  }
} 
```

注意：`randomC`是在构造函数中生成的整数，允许我随机选择图像。

和

```
public class VueGeo extends JFrame
{
  public Cartes pan = new Cartes();
  private JButton bouton = new JButton("Change");

  public VueGeo()
  {

    ...

    container.add(pan, BorderLayout.CENTER);

    bouton.addActionListener(new BoutonListener ());

    ...

    this.setContentPane(container);

    this.setVisible(true);

  }

  class BoutonListener implements ActionListener
  {
    public void actionPerformed(ActionEvent arg0) {
      ????????
    }
  }
} 
```

问题是我不知道要放什么`actionPerformed`才能让我在单击 Change 时更改图像。有人有想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:20:13.200

在 Cartes 中创建一个 setter 方法：

```
public void setImage(BufferedImage i)
{ image = i; } 
```

然后，在 actionPerformed 中，

```
cartes.setImage( (whatever image you would like) );
cartes.repaint(); 
```

# groovy-console - 停止 Groovy 控制台截断输出？

> ID：13594146
> 
> 赞同：0
> 
> 时间：2012-11-27T22:16:08.573
> 
> 标签：groovy-console

是否可以停止 Groovy 控制台截断输出？

使用 1.8.4 控制台，如果我执行以下脚本：

```
for (i in 0..4000) println i 
```

我得到以下输出：

```
01
602
603
...
3999
4000 
```

我看不到任何保留所有程序输出的选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-23T15:43:00.390

扩展已接受的答案，groovyconsole 使用 JAVA_OPTS，因此您在其中设置的任何内容都会被拾取。例如，如果您想将最大内存增加到 4 GB 并将控制台限制增加到 200,000，那么您可以在运行 groovyConsole 之前执行此语句：

```
export JAVA_OPTS="-Xmx4096m -Dgroovy.console.output.limit=200000" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T01:36:27.563

这个文件：

[https://svn.codehaus.org/groovy/trunk/groovy/groovy-core/src/main/groovy/ui/Console.groovy](https://svn.codehaus.org/groovy/trunk/groovy/groovy-core/src/main/groovy/ui/Console.groovy)

包含此代码：

```
// Maximum number of characters to show on console at any time
int maxOutputChars = System.getProperty('groovy.console.output.limit','20000') as int 
```

这似乎是我想要改变的事情。甚至还有一个 JIRA：

[https://issues.apache.org/jira/browse/GROOVY-4425](https://issues.apache.org/jira/browse/GROOVY-4425)

但到目前为止，我还无法通过or将此属性作为`-D`选项传递，启动的控制台立即关闭。如果/当我弄清楚如何轻松将此属性传递给控制台时，将更新..`groovyConsole``groovyConsole.bat`

# modx-revolution - MODX - 用户个人资料照片

> ID：13594150
> 
> 赞同：0
> 
> 时间：2012-11-27T22:16:19.033
> 
> 标签：modx-revolution

MODX Revolution 2.2.5-pl 插件：登录

我试图让用户上传个人资料图片，然后将其显示在他们的个人资料中，但我并不是很成功。我知道该领域存在，但我找不到这样做的方法。

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T02:34:57.103

您需要使用 Hooks ( [http://rtfm.modx.com/display/ADDON/Login.Using+Pre+and+Post+Hooks](http://rtfm.modx.com/display/ADDON/Login.Using+Pre+and+Post+Hooks) )。FormIt 的类似钩子示例 - [http://forums.modx.com/thread/?thread=47603&page=1](http://forums.modx.com/thread/?thread=47603&page=1)

# windows - 使用批处理文件向系统变量路径添加一行

> ID：13594154
> 
> 赞同：6
> 
> 时间：2012-11-27T22:16:32.093
> 
> 标签：windows, batch-file, path

我一直在寻找一个脚本，它可以让我在当前系统变量路径的末尾添加文本。对我如何做到这一点有什么建议吗？（特别是在现有文本中添加“;C:\Program Files (x86)\Java\jre7\bin\java.exe”）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T23:45:49.067

```
echo Set objShell = CreateObject( "WScript.Shell" ) > %TEMP%\sp.vbs
echo Set objSystemEnv = objShell.Environment( "SYSTEM" ) >> %TEMP%\sp.vbs
echo objSystemEnv("Path") = objSystemEnv("Path") ^& ";C:\Program Files (x86)\Java\jre7\bin" >> %TEMP%\sp.vbs
cscript.exe /nologo %TEMP%\sp.vbs
del %TEMP%\sp.vbs 
```

此 CMD 必须以提升的权限运行，否则 cscript.exe 只会写“权限被拒绝”而不会发生任何事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T09:27:44.443

如果您想要最简单的解决方案，您可以在 Windows 7 中使用 SETX 命令：

```
SETX PATH "%PATH%;C:\New Added Folder" 
```

PS1：如果您希望 SETX 命令对 HKLM 键执行更改，请使用 -M 参数。

PS2：更改是永久性的，但您需要重新启动用户会话或控制台。

如果你想要更专业的东西，那么你可以使用我用 Ruby 编写的实用程序**PATHS ，我为 Windows 制作了一个可执行文件。**

```
PATHS.EXE 
```

[http://exoshare.com/download.php?uid=1TKIOMR6](http://exoshare.com/download.php?uid=1TKIOMR6)

![在此处输入图像描述](../Images/63281c2d7a08a0847ad8a37005954abc.png)

![在此处输入图像描述](../Images/90080ad694497fd7563a17af1b363cf8.png)

![在此处输入图像描述](../Images/df18c8ebb7e2cc2188351cd3acbf2594.png)

选项：

/？（或）-帮助 | 显示此信息。

-l（或）-list | 列出条目。

-c（或）-clean | 清除路径中的重复和无效目录。

-r（或）-reset | 将路径重置为 Windows 默认值。

-a（或）-添加 | 添加一个条目。

-d（或）-del | 删除条目。

-添加-当前| 强制将条目添加到当前用户路径中。

-添加-本地| 强制在本地机器路径中添加一个条目。

例子：

PATHS -l [+] 索引所有条目。

PATHS -a "C:\Folder" [+] 在本地路径中添加一个条目。

PATHS -a current "C:\Folder" [+] 在当前用户路径中添加一个条目。

PATHS -d "3" [+] 删除索引列表的第三个条目。

PATHS -d "C:\Folder" [+] 删除一个条目。

> 路径.RB

```
require 'win32/registry'
require 'rainbow'

# PATHS v0.1
#
# By Elektro H@cker

# Description:
# -----------
# This is a tool to manage the windows PATH enviroment.

exit if Object.const_defined?(:Ocra)

def logo()
  print "
   PATHS v0.1

   By Elektro H@cker

".foreground(:white)
end

def help()
  print '

   Options:

   /? (or) -help  | Show this info.

   -l (or) -list  | List the entries.

   -c (or) -clean | Clean duplicates and invalid directories in the paths.

   -r (or) -reset | Reset the paths to the Windows defaults.

   -a (or) -add   | Add a entry.

   -d (or) -del   | Delete a entry.

   -add -current  | Force adding a entry into the current user path.

   -add -local    | Force adding a entry into the local machine path.

   Examples:

   PATHS -l
   [+] Indexes all the entries.

   PATHS -a "C:\Folder"
   [+] Adds a entry into the local path.

   PATHS -a current "C:\Folder"
   [+] Adds a entry into the current user path.

   PATHS -d "3"
   [+] Deletes the 3rd entry of the indexed list.

   PATHS -d "C:\Folder"
   [+] Deletes a entry.

  '
  Process.exit
end

def error(kind)
  print "[+] ERROR"
  if kind == "pos"      then print "\n    Index #{ARGV[1]} is out of range, only #{$pos} entries.\n" end
  if kind == "notfound" then print "\n    Directory \"#{ARGV[1]}\" not found on PATH.\n" end

  Process.exit
end

def args()
  if ARGV.empty?                                   then get_paths("visible") end
  if ARGV[0] == "/?"    or ARGV[0] =~ /^-help$/i   then help()               end  
  if ARGV[0] =~ /^-l$/i or ARGV[0] =~ /^-list$/i   then get_paths("visible") end
  if ARGV[0] =~ /^-c$/i or ARGV[0] =~ /^-clean$/i  then clean_path()         end    
  if ARGV[0] =~ /^-d$/i or ARGV[0] =~ /^-del$/i    then del_path()           end
  if ARGV[0] =~ /^-a$/i or ARGV[0] =~ /^-add$/i    then add_path()           end
  if ARGV[0] =~ /^-r$/i or ARGV[0] =~ /^-reset$/i  then reset_path()         end
end

def get_paths(visibility)

  $pos = 0

  # HKCU path
  if not visibility == "hidden" then puts "\n   [+] Current User PATH:\n\n" end
  Win32::Registry::HKEY_CURRENT_USER.open('Environment') do |reg|
    for dir in reg['Path', Win32::Registry::REG_SZ].split(";").sort do
      $pos = $pos+1
      dir = dir.gsub(/^PATH=/, "")
      instance_variable_set "@_#{$pos}", dir + "?CURRENT_USER"
      if not File.directory? dir then invalid = "(Directory doesn't exist)".foreground(:red).bright else invalid ="" end
      if not visibility == "hidden"
        if $pos < 10 then puts "    #{$pos.to_s} = #{dir} #{invalid}" else puts "    #{$pos.to_s}= #{dir} #{invalid}"end
      end
    end
  end

  # HKLM path
  if not visibility == "hidden" then puts "\n\n   [+] Local Machine PATH:\n\n" end
  Win32::Registry::HKEY_LOCAL_MACHINE.open('SYSTEM\CurrentControlSet\Control\Session Manager\Environment') do |reg|
    for dir in reg['Path', Win32::Registry::REG_SZ].split(";").sort do
      $pos = $pos+1
      dir = dir.gsub(/^PATH=/, "")
      instance_variable_set "@_#{$pos}", dir + "?LOCAL_MACHINE"
      if not File.directory? dir then invalid = "(Directory doesn't exist)".foreground(:red).bright else invalid ="" end
      if not visibility == "hidden"
        if $pos < 10 then puts "    #{$pos.to_s} = #{dir} #{invalid}" else puts "    #{$pos.to_s}= #{dir} #{invalid}"end
      end
    end
  end
  if not visibility == "hidden" then Process.exit end
  $max_pos = $pos

end

def add_path()

  if ARGV[1] =~ /^-current$/ then key = "current" else key = "local" end

  # HKCU path
  if key == "current"
    Win32::Registry::HKEY_CURRENT_USER.open('Environment', Win32::Registry::KEY_ALL_ACCESS) do |reg|
      value = reg['Path']
      reg.write('Path', Win32::Registry::REG_SZ, "#{value};#{ARGV.last}")
      puts "[+] Entry added in User PATH: #{ARGV.last}"
    end
  end

  # HKLM path
  if key == "local"
    Win32::Registry::HKEY_LOCAL_MACHINE.open('SYSTEM\CurrentControlSet\Control\Session Manager\Environment', Win32::Registry::KEY_ALL_ACCESS) do |reg|
      value = reg['Path']
      reg.write('Path', Win32::Registry::REG_SZ, "#{value};#{ARGV.last}")
      puts "[+] Entry added in Local PATH: #{ARGV.last}"
    end
  end

end

def del_path()

    get_paths("hidden")
    final_path = ""
    found      = 0
    notfound   = 0

  if ARGV[1] =~ /^[1-9]+$/

    choose     = instance_variable_get "@_#{ARGV[1]}"

    if ARGV[1].to_i > $max_pos.to_i then error("pos") end

    # HKCU PATH index deletion
    if choose["?CURRENT_USER"]
      Win32::Registry::HKEY_CURRENT_USER.open('Environment', Win32::Registry::KEY_ALL_ACCESS) do |reg|
        value = reg['Path']
        for dir in reg['Path', Win32::Registry::REG_SZ].split(";").sort do
          if not dir == choose.split("?").first then final_path << ";" + dir end
        end
        reg.write('Path', Win32::Registry::REG_SZ, final_path[1..-1])
      end
      puts "[+] Entry deleted in User PATH: #{choose.split("?").first}"
    end

    # HKLM PATH index deletion
    if choose["?LOCAL_MACHINE"]
      Win32::Registry::HKEY_LOCAL_MACHINE.open('SYSTEM\CurrentControlSet\Control\Session Manager\Environment', Win32::Registry::KEY_ALL_ACCESS) do |reg|
        value = reg['Path']
        for dir in reg['Path', Win32::Registry::REG_SZ].split(";").sort do
          if not dir == choose.split("?").first then final_path << ";" + dir end
        end
        reg.write('Path', Win32::Registry::REG_SZ, final_path[1..-1])
      end
      puts "[+] Entry deleted in Local PATH: #{choose.split("?").first}"
    end

  elsif

    # HKCU PATH str deletion
      Win32::Registry::HKEY_CURRENT_USER.open('Environment', Win32::Registry::KEY_ALL_ACCESS) do |reg|
        value = reg['Path']
        for dir in reg['Path', Win32::Registry::REG_SZ].split(";").sort do
          if not dir =~ /^#{Regexp.escape(ARGV[1])}$/i then final_path << ";" + dir else found = "yes" end
        end
        reg.write('Path', Win32::Registry::REG_SZ, final_path[1..-1])
        if found == "yes" then puts "[+] Entry deleted in User PATH: #{ARGV[1]}" else notfound = 1 end
      end

    # HKLM PATH str deletion
      final_path = ""
      found = ""
      Win32::Registry::HKEY_LOCAL_MACHINE.open('SYSTEM\CurrentControlSet\Control\Session Manager\Environment', Win32::Registry::KEY_ALL_ACCESS) do |reg|
        value = reg['Path']
        for dir in reg['Path', Win32::Registry::REG_SZ].split(";").sort do
          if not dir =~ /^#{Regexp.escape(ARGV[1])}$/i then final_path << ";" + dir else found = "yes" end
        end
        reg.write('Path', Win32::Registry::REG_SZ, final_path[1..-1])
        if found == "yes" then puts "[+] Entry deleted in Local PATH: #{ARGV[1]}" else notfound = notfound+1 end
        if notfound == 2 then error("notfound") end
      end

    end

end

def reset_path()
  Win32::Registry::HKEY_CURRENT_USER.open('Environment', Win32::Registry::KEY_ALL_ACCESS) do |reg| reg.write('Path', Win32::Registry::REG_SZ, 'C:\Windows;C:\Windows\system32;C:\Windows\System32\Wbem;C:\Windows\syswow64') end
  Win32::Registry::HKEY_LOCAL_MACHINE.open('SYSTEM\CurrentControlSet\Control\Session Manager\Environment', Win32::Registry::KEY_ALL_ACCESS) do |reg| reg.write('Path', Win32::Registry::REG_SZ, 'C:\Windows;C:\Windows\system32;C:\Windows\System32\Wbem;C:\Windows\syswow64') end
  puts "[+] PATH restored to Windows defaults."
end

def clean_path()

  puts "\n[+] Searching invalid or duplicated entries in the PATH...\n\n"

  # HKCU PATH
  final_path = ""
  Win32::Registry::HKEY_CURRENT_USER.open('Environment', Win32::Registry::KEY_ALL_ACCESS) do |reg|
    value = reg['Path']
    for dir in reg['Path', Win32::Registry::REG_SZ].split(";").sort do
      if File.directory? dir and not final_path[/#{Regexp.escape(dir)}$/i] then final_path << ";" + dir else puts "[+] Entry deleted in User PATH: #{dir}" end
    end
    reg.write('Path', Win32::Registry::REG_SZ, final_path[1..-1])
  end

  # HKLM PATH
  final_path = ""
  Win32::Registry::HKEY_LOCAL_MACHINE.open('SYSTEM\CurrentControlSet\Control\Session Manager\Environment', Win32::Registry::KEY_ALL_ACCESS) do |reg|
    value = reg['Path']
    for dir in reg['Path', Win32::Registry::REG_SZ].split(";").sort do
      if File.directory? dir and not final_path[/#{Regexp.escape(dir)}$/i] then final_path << ";" + dir else puts "[+] Entry deleted in Local PATH: #{dir}" end
    end
    reg.write('Path', Win32::Registry::REG_SZ, final_path[1..-1])
  end

  puts "\n[+] PATH is cleaned.\n\n"

end

logo()
args()

Process.exit 
```

# ruby-on-rails - Paperclip + Rails 与负载平衡机器

> ID：13594161
> 
> 赞同：5
> 
> 时间：2012-11-27T22:17:10.610
> 
> 标签：ruby-on-rails, image, paperclip, scalability

如何让 Paperclip 图像上传在 8 台机器上运行的 Rails 应用程序（负载平衡）上工作？

用户可以在应用程序上上传图像。图像存储在其中一台机器上。用户稍后请求图像，但未找到，因为它是从另一台机器请求的。

此类问题的解决方法是什么？我不能使用 AWS 或任何云服务；图像必须在内部存储。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T22:41:40.077

一种解决方案是使用 NFS 挂载一个共享文件夹，该文件夹将成为您`public/system`或您所称的包含回形针图像的文件夹的根目录。

不过，要使一切正常工作，需要考虑一些事项：

*   使用仅包含资产的专用服务器，这样您的硬盘驱动器专用于服务您的回形针图像
*   NFS 可能很昂贵。使用它仅将文件从您的应用服务器写入您的资产服务器。您必须配置负载均衡器或反向代理或 Web 服务器以直接从资产服务器检索所有图像，而无需要求应用程序服务器通过 NFS 进行。
*   当然，建议在您的资产服务器上使用 RAID 系统
*   建议使用具有相同规格的第二个资产服务器。您可以使其充当备份服务器，并定期将您的回形针图像同步到它。如果主资产服务器出现故障，您将能够切换到该服务器。
*   挂载共享 NFS 文件夹时，使用该`soft`选项，并通过高速本地网络连接挂载，例如：`mount -o soft 10.0.0.1:/export/shared_image_folder`. 如果您没有指定该`soft`选项，并且资产服务器出现故障，您的 Ruby 实例将继续等待服务器启动。一切都会卡住，网站会往下看。艰难地学会了这一点...

这些是使用 NFS 的一般准则。我在一个拥有数十万张图片的大型制作网站上使用它，它对我来说效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-02T18:35:04.890

如果您不想使用 NFS 之类的文件共享，可以将图像存储在数据库中。这是一个为 Paperclip 提供`:database`存储类型的 gem：

[https://github.com/softace/paperclip_database](https://github.com/softace/paperclip_database)

# css - 不重复时CSS背景不显示

> ID：13594162
> 
> 赞同：0
> 
> 时间：2012-11-27T22:17:13.813
> 
> 标签：css

我写了下面的css样式，**它不起作用**……而且我一无所知，为什么？！

```
td.PostiveNumber
{
color:Green;
background-image:url(images/1354052077_arrow_large_up.png) no-repeat left !important;
text-align:right;
z-index:100;
} 
```

我试过这个并且它奏效了，所以我心想这只是设置 no-repeat 和定位图片。

**这可行，但看起来很笨拙......** :(

```
{
color:Green;
background-image:url(images/1354052077_arrow_large_up.png);
text-align:right;
z-index:100;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T22:19:22.837

`background-image`CSS 属性只能用于定义所用图像的 url 。

`no-repeat`属于`background-repeat`财产，`left`对应于`background-position`. `background`将所有这些分组，因此：

更改`background-image:`为`background:`，或将其拆分：

```
background-image:url(images/1354052077_arrow_large_up.png);
background-repeat: no-repeat;
background-position: left; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:24:07.230

你有两种方法：

一 ：

```
background-image:url(images/1354052077_arrow_large_up.png) no-repeat left !important; 
```

改成 ：

```
background:url(images/1354052077_arrow_large_up.png) no-repeat left !important; 
```

或者

使用这种方式：

```
 background-image:url(images/1354052077_arrow_large_up.png) ;
    background-repeat:no-repeat ;
    background-position: left; 
```

# python - 更改 dotcloud 上的依赖项代码。姜戈

> ID：13594164
> 
> 赞同：1
> 
> 时间：2012-11-27T22:17:22.670
> 
> 标签：python, django, dotcloud

我正在使用 Dotcloud 部署我的 Django 应用程序。在本地开发时，我必须在一些依赖项的代码中进行更改（在我的 virtualenv 中）。

所以我的问题是：有没有办法在 dotcloud 上部署时对依赖项（例如 django-registration 或 django_socketio）进行相同的更改？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:57:35.303

如果您使用的是`requirements.txt`，不，没有办法从 pypi 做到这一点，因为 Dotcloud 只是下载您从 pypi 指定的包，显然您在 virtualenv 中的更改不会反映在规范版本中的包。

为了使用您的依赖项的编辑版本，您必须将它们捆绑到您的代码中，就像您编写的任何其他模块一样，并`import`从那里开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:00:02.730

有很多方法，但并非所有方法都是干净/简单/可能的。

如果这些依赖项位于 github、bitbucket 或类似的代码存储库上，您可以：

*   分叉依赖，
*   编辑你的叉子，
*   指向`requirements.txt`文件中的分叉。

这将允许您跟踪对这些依赖项的进一步更改，并轻松地将您自己的修改与未来版本合并。

否则，您可以在代码中包含（修改后的）依赖项。它不是很干净，并且会增加您的应用程序的大小，但这也很好。

最后但同样重要的是，您可以编写一个非常 hackish 的`postinstall`脚本来定位要修改的 .py 文件（例如`import foo ; foopath = foo.__file__`），然后在该文件上应用补丁。这可能会导致大多数系统管理员感到恐惧，但值得一提 :-)

# perl - 为 SQL 查询的结果分配一个标量

> ID：13594168
> 
> 赞同：1
> 
> 时间：2012-11-27T22:17:44.560
> 
> 标签：perl, postgresql, dbi

在我看来，必须有更好的方法来做到这一点，但我还没有找到。而且我敢肯定，我不是唯一一个可以使用一种方法来做到这一点的人：运行一个 SQL 查询，它只在一行中生成一个字段，然后将该字段分配给一个标量。（在我的情况下，如果查询导致多个字段/行，那么我要担心的事情比脚本破坏要大）。

例如，要从 SQL 服务器获取时间戳，可以使用：

```
my $timestamp;
my $cmd = $dbh->prepare('SELECT cast(now() AS timestamp);') or die $!;
$cmd->execute();
while (my @asd = $cmd->fetchrow_array) {  $timestamp = $asd[0] } 
```

很脏，但它有效。但是对于一个简单的任务来说，使用 4 行似乎有点多，尤其是考虑到 perl 和 postgresql 可以通过 DBI 相互通信的程度。当然，我可以为它编写一个子例程，但是是否有本地程序可以让我像提交数据一样轻松地获取数据`$dbh->do()`？

是的，我确实尝试过谷歌。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:57:19.843

通常我会写：

```
$value = $dbh->selectall_arrayref($sql)->[0]->[0]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:41:46.087

总有[`selectrow_array`](http://search.cpan.org/dist/DBI/DBI.pm#selectrow_array)：

> *选择行数组*
> 
> ```
> @row_ary = $dbh->selectrow_array($statement);
> @row_ary = $dbh->selectrow_array($statement, \%attr);
> @row_ary = $dbh->selectrow_array($statement, \%attr, @bind_values); 
> ```
> 
> 此实用方法将`prepare`,`execute`和组合`fetchrow_array`成一个调用。

所以是这样的：

```
my $timestamp = $dbh->selectrow_array('select cast(now() as timestamp)'); 
```

还有类似的情况[`selectrow_arrayref`](http://search.cpan.org/dist/DBI/DBI.pm#selectrow_arrayref)。[`selectrow_hashref`](http://search.cpan.org/dist/DBI/DBI.pm#selectrow_hashref)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:45:18.450

来自`perldoc DBI`：

```
 "selectrow_arrayref"

     $ary_ref = $dbh->selectrow_arrayref($statement);
     $ary_ref = $dbh->selectrow_arrayref($statement, \%attr);
     $ary_ref = $dbh->selectrow_arrayref($statement, \%attr, @bind_values);

   This utility method combines "prepare", "execute" and
   "fetchrow_arrayref" into a single call. It returns the first row of
   data from the statement.  The $statement parameter can be a previously
   prepared statement handle, in which case the "prepare" is skipped.

   If any method fails, and "RaiseError" is not set, "selectrow_array"
   will return undef. 
```

这将使您获得最大的收益。您仍然需要进行一些错误检查，但无论如何您都会这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T22:27:07.710

实际上不会`fetchrow_array`只返回一个标量，因为您只要求一列？

# jquery - jQuery click() 使用 AJAX 更新列表

> ID：13594169
> 
> 赞同：0
> 
> 时间：2012-11-27T22:17:52.747
> 
> 标签：jquery

我正在尝试使用 jQuery 使用 AJAX 制作可编辑和更新的项目列表。

HTML

```
<ul>
   <li data-id="1">
       <span class="title">Title 1</span><span><a href="#" class="changeLink">Change</a></span>
   </li>
   <li data-id="2">
       <span class="title">Title 2</span><span><a href="#" class="changeLink">Change</a></span>
   </li>
   <li data-id="3">
       <span class="title">Title 3</span><span><a href="#" class="changeLink">Change</a></span>
   </li>
</ul> 
```

jQuery

```
$('a.changeLink').on('click', function(e) 
{
    e.preventDefault();
    // get parent LI element
    var li = $(this).closest('li'); 
    // catch current title
    var title = li.children('span.title').text(); 
    // replace span
    li.children('span.title').html('<input type="text" value="'+title+'" />');
    // change the link class and label 
    $(this).removeClass('changeLink').addClass('saveLink').text('Save'); 
});

$('a.saveLink').on('click', function(e) 
{
    e.preventDefault();
    // get parent LI element
    var li = $(this).closest('li'); 
    // get the id for the AJAX query
    var id = li.attr('data-id'); 
    // get the input value
    var title = li.children('span.title input').val(); 
    // restore span text with new
    li.children('span.title').text(title); 
    // restore link
    $(this).removeClass('saveLink').addClass('changeLink').text('Change'); 
    // make AJAX post to save new title
    $.post('updatetitle.php',{ 'id': id, 'title': title }, function(){ alert('OK'); }); 
}); 
```

我的问题似乎是 saveLink 点击事件永远不会发生。此外，changeLink 点击事件似乎不止一次发生。为什么会发生这种情况 - 链接不再有`changeLink`课程？

我把它放在一个 jsFiddle 里：http: [//jsfiddle.net/jtheman/SZk4h/1/](http://jsfiddle.net/jtheman/SZk4h/1/)

很高兴我能得到一些意见，我的错误是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:21:32.143

**该事件将与一个元素相关联，而不是特定于一个类**..

如果您想与班级一起工作，您可能需要**委派**活动

**更新代码**

```
$('ul#list').on('click', 'a.changeLink , a.saveLink', function(e) {
    e.preventDefault();
    if ($(this).hasClass('changeLink')) {
        var li = $(this).closest('li');
        var title = li.children('span.title').text();
        li.children('span.title')
            .html('<input type="text" value="' + title + '" />');
        $(this).removeClass('changeLink')
               .addClass('saveLink').text('Save');
    }
    else if ($(this).hasClass('saveLink')) {
        var li = $(this).closest('li');
        var id = li.attr('data-id');
        var title = li.children('span.title').find('input').val();
        li.children('span.title').text(title);
        $(this).removeClass('saveLink')
               .addClass('changeLink').text('Change');
        //$.post('updatetitle.php',
        // { 'id': id, 'title': title }, function(){ alert('OK'); });
    }
});​ 
```

你的问题是这条线

```
var title = li.children('span.title input').val(); 
```

`.children()`只会得到元素的直接子元素。

将其替换为

```
var title = li.children('span.title').find('input').val(); 
```

**[检查更新的小提琴](http://jsfiddle.net/sushanth009/SZk4h/16/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:20:48.430

使用[.live()](http://api.jquery.com/live/)代替。这是因为

> $('a.saveLink').on('click', function(e)) //此时不存在元素，
> 
> .addClass('saveLink') // 之后执行

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:21:13.107

`.saveLink`第一次绑定事件时 DOM 中不存在。一种可能的解决方案是在添加类后绑定它`.saveLink`。另一种是使用委托。理想情况下，`ul`将具有一个`id`属性（否则您将不得不使用另一个父级`document`：

```
$("#ul-id").on('click', '.saveLink', function () { ... 
```

此外，`.changeLink`回调永远不会脱离它最初绑定的链接。这可以使用委托以相同的方式解决，或者您可以在回调中取消绑定事件。

# c# - Windows Phone 8 上的 Map.SetView()

> ID：13594170
> 
> 赞同：6
> 
> 时间：2012-11-27T22:17:55.157
> 
> 标签：c#, maps, windows-phone, windows-phone-8

在页面的生命周期中是否存在应该调用[Map.SetView()](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj663035%28v=vs.105%29.aspx)函数的特定时间？在我们的应用程序中，我们在各种地图对象上使用它，它似乎随机工作，有时完美，有时没有效果，但也不例外。

示例代码：

```
RouteMap.SetView(LocationRectangle.CreateBoundingRectangle(DirectionCoordinates)); 
```

其中 RouteMap 是映射组件，DirectionCoordinates 包含地图的开始/结束坐标。

我可以看到边界框正在正确创建，但即使加载相同的数据，地图的定位也并不总是受到影响。如果我添加一个断点，它似乎确实有效，所以我假设它与地图加载有关，但是将*SetView()*功能添加到*Loaded*事件有同样的问题。我们目前在页面Loaded事件中处理地图信息。

**更新**

我一直在测试更多并尽可能添加事件，我知道 MapLoaded 事件在 SetView 之前被调用。调用 SetView 后，它有时会工作而不是其他人。不会调用 ViewChanging 或 ViewChanged 事件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T17:17:27.780

这显然不是最好的解决方案，但是当调用 Loaded 事件时一定有一些东西没有完全完成加载，这会阻止它完成。

我在 Map_Loaded 事件中添加了 100 毫秒的睡眠，它解决了我遇到的问题。

```
System.Threading.Thread.Sleep(500); 
```

**更新**

100 毫秒对某些人不起作用，您可能想玩弄数字、200、500 等。这仍然是地图加载时间的一个非常短的延迟。我已就此与 Microsoft 联系，他们告诉我他们正在调查此问题，我们希望很快能得到他们的某种回应。

**更新和编辑**

请改用以下代码来防止 UI 挂起：

```
await Task.Delay(250); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-12-12T14:38:19.540

`ResolveCompleted`我使用事件和布尔标志解决了这个问题。

```
private void Map_ResolveCompleted(object sender, MapResolveCompletedEventArgs e)
    {
        if (this.zoomReq)
        {
            this.zoomReq = false;
            if (this.locationList != null && this.locationList.Count > 0)
            {
                var viewRect = LocationRectangle.CreateBoundingRectangle(this.locationList);
                this.Map.SetView(viewRect);
            }
        }
    } 
```

在地图缩放之前有明显的停顿，但至少这似乎一直有效。该标志是必需的，因为`ResolveCompleted`每次地图移动时都会触发。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-08T04:36:04.367

我在一个方法中构建了一个地图层（`Microsoft.Phone.Maps.Controls.MapLayer`）和设置视图（`public void SetView(LocationRectangle boundingRectangle);`）`async`：

```
public async Task CreateMap()
{
    map.Add(mapLayer);
    map.SetView(locationRectangle);
} 
```

我正在做一些加载，这就是我使用`async`.

这只会设置一次视图，这是我第一次导航到页面。

解决方案是调度 set view 调用：

```
public async Task CreateMap()
{
    map.Add(mapLayer);
    Dispatcher.BeginInvoke(() =>
            {
                map.SetView(locationRectangle);
            });
} 
```

希望有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T23:16:15.420

Loaded 事件是 SetView() 的合适位置。您可以尝试在 OnNavigatedTo 方法中创建矩形。当我处理位置时，我总是在 OnNavigatedTo 中启动我的观察者，并在 _Loaded 中处理任何地图图层。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-18T00:06:23.517

我有一个非常相似的问题。基本上 map 的 setview 将在第一次加载页面时工作（即在所有数据完成加载之后），但如果我离开页面并返回并且不需要重新加载所有数据，它就不起作用。在调试时，似乎我在完成加载之前为地图设置了信息。

所以我为解决这个挑战所做的是：

1.  在 XAML 中 - 我为地图的 Loaded 事件添加了一个事件处理程序。示例：Loaded="myMap_Loaded"
2.  在 myMap_Loaded 事件中，我只是调用了一个异步方法来等待数据加载然后映射它。
    例子：

> private void myMap_Loaded(object sender, RoutedEventArgs e) { WaitAndLoadMap(); }

3.  对 WaitAndLoadMap 方法进行编码以在加载地图之前等待数据完成加载。

> ```
> private async void WaitAndLoadMap()
>     {
>         //Check if the data is loaded and if it is not - loop. 
>         while (!App.NearbyLocationsViewModel.IsLocationDataLoaded)
>             await Task.Delay(250);
> 
>         //Load the map content and set the mapview.
>     } 
> ```

它似乎正在工作。希望这对其他人有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-27T07:59:07.090

我有这个问题`MapAnimationKind.Linear`但是因为`MapAnimationKind.None`它没有任何问题

```
map.SetView(LocationRectangle.CreateBoundingRectangle(...), MapAnimationKind.None); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-06T02:23:10.503

我自己在这个问题上工作了一段时间。将大部分内容加载到页面的构造函数中并没有帮助。我尝试了这个技巧，`System.Threading.Thread.Sleep(500)`但效果远远超过 500 毫秒，这对我来说是不可接受的。对于某些人来说，它有助于触发`ZoomLevelChanged`事件并在其中设置视图。对于我自己，我使用了一个`DispatcherTimer`我使用`SetView()`并触发了一个“ViewChanging”事件来停止计时器。如果您使用动画，则差异很小。

# algorithm - 创建最佳二叉搜索树，与创建霍夫曼树一样吗？

> ID：13594173
> 
> 赞同：2
> 
> 时间：2012-11-27T22:18:06.320
> 
> 标签：algorithm, data-structures, binary-search-tree

很快就在这里学习期末考试，我想知道在下面的问题中创建一个最佳二叉搜索树是否与在给定符号和频率的情况下创建一个霍夫曼树相同。

用键 K1 < K2 < K3 < K4 计算最优二叉搜索树的概率：

```
p1 = .1  p2 = .2   p3 = .3  p4 = .1   
q0 = .15 q1 = .05  q2 = 0   q3 = .1 
```

所以在这里我们将配对最低的两个概率并创建一个概率 = n1 + n2 的内部节点，然后将下一个最低的两个概率配对，等等？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:29:56.140

它们实际上是两个不同的问题。霍夫曼树生成不需要保留密钥顺序，而 BST 生成则需要。此外，Huffman 树的生成需要额外的节点来“加入”其他节点，而 BST 中并非如此（您将节点与已经存在的节点连接起来）。

对于“最佳”BST 生成，您希望最小化所有节点深度的加权和（权重是节点的频率）。在这种情况下，p3 应该是 p2 和 p4 的父级，而 p2 应该是 p1 的父级。这会生成一个“加权和”：

```
Node Probability Depth Product Parent
K1   .1          2     .2      K2
K2   .2          1     .2      K3
K3   .3          0     0       None (root)
K4   .1          1     .1      K3
                       .5 (total, smaller than all other configurations) 
```

不清楚你的意思`q0`to `q3`，但如果这些也是所需 BST 中的节点，你仍然会尝试优化深度的加权总和。

# flash - 如何在实时 RTMP 流中提供隐藏式字幕？

> ID：13594175
> 
> 赞同：2
> 
> 时间：2012-11-27T22:18:08.250
> 
> 标签：flash, caption, flash-media-server, closed-captions, flashmedialiveencoder

在 Adob​​e Media Server 5.0.1 中，Adobe[引入了](http://help.adobe.com/en_US/adobemediaserver/devguide/WS5262178513756206232b27a91396cda04c9-8000.html)对在视频流中嵌入 EIA-608/708 隐藏式字幕数据以交付给客户端的支持。

为了获得这些字幕，AMS 可以从 ATSC 图片用户数据、定时文本轨道或与视频流一起发送的 AMF 消息中提取数据。

虽然这在理论上很好，但我很难弄清楚如何让它在实践中真正发挥作用——即，哪些实时媒体编码器实际上会保留 ATSC 字幕数据并将其传递给服务器（或传递字幕数据作为 RTMP 流中的 AMF 消息）。

人们*实际*使用哪些解决方案来为实时网络广播添加字幕？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T17:38:50.473

Elemental Live 和 Inlet Spinnaker/Cisco 媒体处理器编码器目前正在现场制作中用于执行此操作。他们使用 OnCuePoint 和/或 onCaptionInfo 在 RTMP 流中提供字幕。

# ruby-on-rails - 太阳黑子 Solr 无法启动

> ID：13594176
> 
> 赞同：1
> 
> 时间：2012-11-27T22:18:09.820
> 
> 标签：ruby-on-rails, solr, sunspot

如果我尝试：

```
$ bundle exec rake sunspot:solr:run --trace 
```

它返回：

```
** Invoke sunspot:solr:run (first_time)
** Invoke environment (first_time)
** Execute environment
** Execute sunspot:solr:run
java version "1.6.0_37"
Java(TM) SE Runtime Environment (build 1.6.0_37-b06-434-11M3909)
Java HotSpot(TM) 64-Bit Server VM (build 20.12-b01-434, mixed mode)
rake aborted!
No such file or directory - solr/runtime/apache-solr-3.5.0/example 
```

我不记得删除了这个..虽然我同时在几个项目上工作..有谁知道我需要做什么来解决这个问题？

# python - Python 字典：从元组中删除一个字符串（哪个是键。）

> ID：13594179
> 
> 赞同：0
> 
> 时间：2012-11-27T22:18:19.863
> 
> 标签：python, dictionary

我有一本字典

```
dic ={('L', 'N', 'C'):6, ('N', 'L', 'C'):4, ('C', 'N', 'L'):3}) 
```

我想从所有键中删除字符串“C”。有什么有效的方法吗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T22:19:54.137

这可以通过一个[字典理解](http://www.python.org/dev/peps/pep-0274/)来完成：

```
>>> dic ={('L', 'N', 'C'):6, ('N', 'L', 'C'):4, ('C', 'N', 'L'):3}
>>> {tuple(l for l in k if l != 'C'):v for k,v in dic.items()}
{('L', 'N'): 6, ('N', 'L'): 4} 
```

请注意，将 make 和冲突删除，`'C'`因为`('N', 'L', 'C')`它们`('C', 'N', 'L')`都变为`('N', 'L')`. 从问题中不清楚您希望如何处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T03:56:57.297

```
for k,v in dic.iteritems():
    if 'C' in k:
        dic[tuple(el for el in k if el!='C')] = dic.pop(k) 
```

在此解决方案中，
仅更改包含要消除的元素的键（新对象，因为元组是不可变的）。
字典已就地修改，
值保持不变。

以下代码显示了这一点。

```
dico = {(1,2,8):'aa',  
        (25,8,45,9):'gerard',
        (268,54,0):'marine',
        (81,3,8,7):'emma',
        (7,9,6):'louis'}

print '  id(dico) : ',id(dico)
for k,v in dico.iteritems():
    print id(k),'%-25s' % repr(k),id(v),v

idk = [id(el) for el in dico]

for k,v in dico.iteritems():
    if 8 in k:
        dico[tuple(el for el in k if el!=8)] = dico.pop(k)

print
print '  id(dico) : ',id(dico)
for k,v in dico.iteritems():
    print '%d %-30s %d %s' %\
          (id(k), ('[new id] ' if id(k) not in idk else '         ')+repr(k),id(v),v) 
```

结果

```
 id(dico) :  18737456
18751976 (268, 54, 0)              18718464 marine
11258576 (1, 2, 8)                 18566968 aa
18539072 (25, 8, 45, 9)            18603776 gerard
18606768 (81, 3, 8, 7)             18718432 emma
18752056 (7, 9, 6)                 18718592 louis

  id(dico) :  18737456
18752216 [new id] (1, 2)                18566968 aa
18751976          (268, 54, 0)          18718464 marine
18752176 [new id] (81, 3, 7)            18718432 emma
18752056          (7, 9, 6)             18718592 louis
18752416 [new id] (25, 45, 9)           18603776 gerard 
```

# c# - ASP.NET MVC 3 - 在后重定向获取工作流中检测当前页面是否被重定向到

> ID：13594181
> 
> 赞同：4
> 
> 时间：2012-11-27T22:18:25.843
> 
> 标签：c#, asp.net, asp.net-mvc-3

在我的 C# .NET 4 MVC 3 应用程序中，我有一个用于一组 CRUD 页面的删除控制器，它使用*Post Redirect Get*模式在成功删除后重定向到索引控制器。仅当此页面未被此类操作重定向到时，我才想在索引页面上呈现一个按钮。有没有一种简单的方法来检测当前页面是否被重定向到（即作为 PRG 重定向的结果到达）？

阅读[http://blog.simonlovely.com/archive/2008/11/26/post-redirect-get-pattern-in-mvc.aspx](http://blog.simonlovely.com/archive/2008/11/26/post-redirect-get-pattern-in-mvc.aspx)后，我目前的方法是在方法成功`TempData`后在我的删除控制器中设置它`DeleteMyEntity`：

```
try {
    MyService.DeleteMyEntity(MyViewModel.MyEntity);
    TempData["Redirected"] = true;
    args = new RouteValueDictionary(new { Foo = 1, Baa = 2 });
    return RedirectToAction("Index", args);
} catch (Exception e)
{
   //Logging etc. - redirect should never be reached on exception (and TempData item not set)
   throw(e);
} 
```

然后在我的索引控制器中我检查这个值是否存在并且是真的：

```
if (TempData["Redirected"] != null)
{
    //we can then do something useful with this
} 
```

我看到的另一个机会是`args`在控制器中添加另一个项目并检查它，但在这种情况下，我不妨只使用`TempData`. 有没有办法在请求上使用 HTTP 响应代码来执行此操作，而无需通过 with`TempData`或类似机制传递此数据？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-10T18:46:07.507

另一条路线是设置一个全局动作过滤器，为您“注入”该标志......

```
public class RedirectDetect: ActionFilterAttribute{
   public override void OnActionExecuted(ActionExecutedContext filterContext){
        if (filterContext.Result is RedirectToRouteResult ||
            filterContext.Result is RedirectResult)
        {
             TempData["Redirected"] = true;
             //or what ever other indicator you want to set
        }
   }
} 
```

然后你可以调用 redirectToAction("Index") 然后检查你的接收处理程序

旁注：我挑战你大声说 RedirectDetect 而不是假笑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T22:34:45.440

我以类似的方式使用 TempData - 例如，在添加/更新/删除记录时显示状态消息（重定向到）我的视图。这是 TempData 用于的那种简单的、一次性的东西，所以我说你有什么是合适的。

就个人而言，除非我绝对需要它，否则我不会弄乱 HTTP 状态代码。并且您可能可以使用referrer http 标头做一些事情，但同样，这将比仅使用 TempData 更加混乱和复杂。你有一个干净，简单的解决方案，我说你有什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T22:31:21.473

我不知道任何更简单的机制，并且已经使用 TempData 很长一段时间来实现 Post-Redirect-Get 功能。据我所知，这具体是 TempData 存在的原因之一。我会继续使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T22:26:53.250

由于 3xx 重定向或直接的用户发起的 GET，没有办法区分请求之间的区别。最好的方法是提供一个查询字符串参数，该参数仅由初始 POST 请求的重定向附加，但没有什么可以阻止用户使用相同的查询字符串重新加载页面。

嗯，或者您可以从 POST 发送带有重定向的 cookie，然后在后续 GET 的响应中删除 cookie，如下所示：

```
public ActionResult PostHandler(ViewModel model) {
    SetCookie("redirected", "true"); // psuedocode
    return Redirect("GetHandler2");
}

public ActionResult GetHandler2() {
    if( GetCookie("redirected") == "true" ) {
        // do something
    }
    DeleteCookie("redirected");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-14T15:12:58.280

基于乔治的回答：

```
public class MarkRedirects : ActionFilterAttribute
{
   public override void OnActionExecuted(ActionExecutedContext context)
   {
        if (context.Result is RedirectToActionResult ||
            context.Result is RedirectResult)
        {
            // Obtain and verify the underlying IController
            var controller = context.Controller as Controller;
            if (controller != null)
                controller.TempData["Redirected"] = true; // or set other dictionary data here
        }
   }
} 
```

context.Result 的条件检查可以根据您用于重定向的方法而有所不同，例如，如果您通过 RedirectToAction() 方法重定向用户，`context.Result is RedirectToActionResult`将返回 true 但`context.Result is RedirectToRouteResult`不会。

因此，您将需要根据您对如何重定向用户的个人品味来更改该条件。当前代码适用于 OP 的情况。

如果您要在任何地方使用它，修改基本控制器可能是明智之举。

# python - 使用 flask-mongoengine 抓取多个文档

> ID：13594187
> 
> 赞同：0
> 
> 时间：2012-11-27T22:18:45.953
> 
> 标签：python, flask, mongoengine

我在我的 python 应用程序中使用 Flask-MongoEngine，我试图获取一个字段等于某个值的文档列表。我知道如何使用 get(name="chris") 根据字段的值获取单个文档，但是如何通过返回多个文档来做到这一点？文档中的任何内容都没有真正突出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:43:58.193

MongoEngine Document 类有一个 objects 属性，用于访问与该类关联的数据库中的对象。例子：

```
uk_users = User.objects(country='uk') 
```

对于高级查询，您可以使用 filter 属性：

```
uk_female_users = User.objects(country='uk').filter(gender='f') 
```

这是相关文档[MongoEngine - Querying the database](https://mongoengine-odm.readthedocs.org/en/latest/guide/querying.html)

# c++ - 打印奇怪的结果

> ID：13594196
> 
> 赞同：1
> 
> 时间：2012-11-27T22:19:17.953
> 
> 标签：c++

为什么调用 c2.view() 会打印出客户 ID 的 ID 和名称？

我已经盯着这个看了一段时间，找不到原因。我要么错过了一些非常明显的东西，要么我不明白 cstrings 是如何工作的 :)

客户.h

```
#ifndef CUSTOMER_H
#define CUSTOMER_H
 class Customer
 {
 private:
     char accountID[6];
     char name[30];
 public:
     Customer();
     Customer(char[], char[]);
     void view();
     Customer operator=(const Customer&);

 };
#endif 
```

客户.cpp

```
#include <string>
#include <iostream>
#include "Customer.h"
using namespace std;

Customer::Customer()
{
    strcpy(accountID, "");
    strcpy(name, "");
}

Customer::Customer(char acc[], char n[])
{
    strcpy(accountID, acc);
    strcpy(name, n);
}

void Customer::view()
{
    cout << "Customer name: " << name << endl;
    cout << "Customer ID: " << accountID <<endl;
}

Customer Customer::operator=(const Customer& right)
{
    strcpy(accountID, right.accountID);
    strcpy(name,  right.name);
    return* this;
} 
```

驱动程序.cpp

```
#include <iostream>
#include "Customer.h"
using namespace std;

int main()
{
    char id[] = "123456";
    char n[] = "Bob";
    Customer c1;
    Customer c2(id, n);
    c1.view();
    c2.view();
    system("pause");
    return 0;
} 
```

输出：

```
Customer name:
Customer ID:
Customer name: Bob
Customer ID: 123456Bob
Press any key to continue . . . 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:22:18.990

您正在传递一个包含七个字符的字符串：

```
char id[] = "123456"; // one more character for null termination '\0' 
```

但是您的数组大小为 6。因此，当您 print 时`accountId`，您会超出`'6'`字符并打印出它旁边的任何内容，在这种情况下恰好是`name`.

`std::strings`使用而不是字符数组可以为自己省去很多麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:24:18.573

因为 accoutID 的长度为 6，并且当您在 n 中进行 strcpy 时，您会覆盖 accountID 的终止符，该终止符溢出到 name[0]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:24:39.963

`strcpy`复制直到它到达一个空终止符；`\0`因为你没有定义并且你正在运行调试，所以 name 恰好占据了与 id 相邻的内存，并且也被复制到 id 的缓冲区中。

如果你要构建发布，你很可能会在那里胡说八道。无论哪种方式，如果您使用 C 字符串，则在所有字符串的末尾都需要空终止符。

`strcpy`的实现类似于；

```
while (*ptr2 != '\0')
{
    // copy string2 into string1's buffer until we reach it's null termintor
    *ptr1 = *ptr2
    ptr1++;
    ptr2++;
}
*(ptr1 + 1) = '\0'  // append null terminator 
```

如您所见，它依赖于空终止符，如果不存在，您将获得缓冲区溢出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T22:22:26.493

使用 C++ `std::string`。您正在写超出`accountID`成员的范围。这`char id[] = "123456";`有七个要素。

在这种情况下发生的是终止空字符首先结束，`name[0]`然后被覆盖，`strcpy (name, n)`你得到一个连续的序列`123456Bob\0`

# ruby - 使用 axlsx 电子表格 ruby gem 将单元格格式化为文本？

> ID：13594199
> 
> 赞同：13
> 
> 时间：2012-11-27T22:19:40.720
> 
> 标签：ruby, axlsx

我正在使用[axlsx ruby​​ gem](https://github.com/randym/axlsx)来创建与 Excel 兼容的`.xlsx`文件。我不知道如何覆盖由它的自动类型检测生成的单元格类型。对于类型`string`的 Active Record 模型属性，gem 将 Excel 单元格格式设置为 General，但我希望它明确使用 Text。这样我就可以避免从邮政编码等中去除前导零。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-11-28T00:56:36.853

您可以使用添加行上的类型选项覆盖数据类型。

就像是：

```
worksheet.add_row ['0012342'], :types => [:string] 
```

如果您需要任何帮助以使其正常工作，请在 irc (JST) 上抓住我。

最好的

随机的

# 编辑 -

我在 repo 中的 examples/example.rb 中添加了一个示例。

```
wb.add_worksheet(:name => "Override Data Type") do |sheet|
  sheet.add_row ['dont eat my zeros!', '0088'] , :types => [nil, :string]
end 
```

[https://github.com/randym/axlsx/blob/master/examples/example.rb#L349](https://github.com/randym/axlsx/blob/master/examples/example.rb#L349)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-09-18T18:23:36.897

format_code: '@' 会为你工作。请在下面找到代码以供参考。

```
def default_data_type_as_string
    @xlsx_package = Axlsx::Package.new
    @workbook = @xlsx_package.workbook
    @worksheet = @workbook.add_worksheet(:name => "Introduction")
    default_style = @workbook.styles.add_style({ format_code: '@' })
    row_data_array = ['1', '2%', '3$']
    @worksheet.add_row row_data_array, :style => [nil, default_style, nil]
    @xlsx_package.serialize('default_data_type_as_string.xlsx')
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-08-23T20:15:32.410

对于 gem 版本`gem 'axlsx', '2.1.0.pre'`，`gem 'axlsx_rails'`为了使文件列具有文本类型，应同时指定样式和类型

```
default_style = worksheet.styles.add_style({ format_code: '@' })
worksheet.add_row ['0012687'], :types => [:string], :style => [default_style] 
```

# c# - itextsharp和pdf

> ID：13594201
> 
> 赞同：1
> 
> 时间：2012-11-27T22:19:47.360
> 
> 标签：c#, pdf, itextsharp

我想每行读取一个 pdf 文件行，但我想保持他的原始格式

¿我可以用 itextsharp 做到这一点吗？

我使用下一个代码：

```
private void button1_Click(object sender, EventArgs e)
        {

            string text = string.Empty;
            string path = string.Empty;
            path = "C:\\Documents and Settings\\Rafael\\Desktop\\Imprimiendo\\Print1.pdf";
            PdfReader reader = new PdfReader(path);

            for (int page = 1; page <= reader.NumberOfPages; page++)
            {
                text = PdfTextExtractor.GetTextFromPage(reader, page);
                richTextBox1.Text = text;

            }
            reader.Close();
            return;
        } 
```

谢谢，我真的需要你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T08:09:22.383

If you want to read PDF file with small data in it, iTextsharp would be the best choice, you may find answer here:

[Reading PDF content with itextsharp dll in VB.NET or C#](https://stackoverflow.com/questions/2550796/reading-pdf-content-with-itextsharp-dll-in-vb-net-or-c-sharp)

However, if you have huge data in your PDF file, iTextsharp will have problems in realizing this task. in such a case, you may need a third party library. This article may help you much:

[Read PDF file in C#](http://www.codeproject.com/Tips/466394/Extract-and-Remove-PDF-Attachments-with-Csharp)

# mysql - mysql --ignore-table - 简洁的多个

> ID：13594204
> 
> 赞同：0
> 
> 时间：2012-11-27T22:19:54.583
> 
> 标签：mysql

是否有一种简洁的方法可以使用忽略多个表`mysql --ignore-table`？

文档说`--ignore-table`必须用于每个表。

我必须忽略大约 20 张桌子，所以命令会很大

这必须通过命令行运行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:22:28.490

尝试使用[MySQL Workbench](http://mysqlworkbench.org/)来构建命令。它将提供通过复选框指定您想要的表格的选项。

如果需要，您可以从“导出进度”选项卡复制并粘贴命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T22:30:16.910

走白名单路线而不是黑名单路线。从手册页：

```
mysqldump [options] [db_name [tbl_name ...]] 
```

您仍然必须输入所有内容，但至少您不必连续输入`--ignore-table`标志。

# c - malloc 有效，cudaHostAlloc 段错误？

> ID：13594205
> 
> 赞同：1
> 
> 时间：2012-11-27T22:19:59.023
> 
> 标签：c, cuda

我是 CUDA 新手，我想使用`cudaHostAlloc`. 我能够将我的问题与以下代码隔离开来。`malloc`用于主机分配工作，使用导致`cudaHostAlloc`段错误，可能是因为分配的区域无效？当我在这两种情况下转储指针时它都不为空，所以`cudaHostAlloc`返回一些东西......

作品

```
 in_h = (int*) malloc(length*sizeof(int)); //works
    for (int i = 0;i<length;i++)
            in_h[i]=2; 
```

不工作

```
 cudaHostAlloc((void**)&in_h,length*sizeof(int),cudaHostAllocDefault); 
    for (int i = 0;i<length;i++)
            in_h[i]=2; //segfaults 
```

* * *

**独立代码**

```
#include <stdio.h>
void checkDevice()
{
        cudaDeviceProp info;
        int deviceName;
        cudaGetDevice(&deviceName);
        cudaGetDeviceProperties(&info,deviceName);
        if (!info.deviceOverlap)
        {
                printf("Compute device can't use streams and should be discarded.");
                exit(EXIT_FAILURE);
        }
}
int main()
{
        checkDevice();
        int *in_h;
        const int length = 10000;
        cudaHostAlloc((void**)&in_h,length*sizeof(int),cudaHostAllocDefault);
        printf("segfault comming %d\n",in_h);
        for (int i = 0;i<length;i++)
        {
                in_h[i]=2; // Segfaults here
        }
        return EXIT_SUCCESS;
} 
```

~
**调用**

```
[id129]$ nvcc fun.cu 
[id129]$ ./a.out 
segfault comming 327641824
Segmentation fault (core dumped) 
```

**细节**

程序在集群上以交互模式运行。有人告诉我，从计算节点调用程序会将其推送到集群。其他自制玩具 cuda 代码没有任何问题。

**编辑**

```
cudaError_t err = cudaHostAlloc((void**)&in_h,length*sizeof(int),cudaHostAllocDefault);
printf("Error status is %s\n",cudaGetErrorString(err)); 
```

给驱动错误...

```
Error status is CUDA driver version is insufficient for CUDA runtime version 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T23:21:13.497

始终检查错误。很可能`cudaHostAlloc`无法分配任何内存。如果它失败了，你不是在逃避，而是在写入未分配的地址空间。使用时`malloc`，它会按要求分配内存并且不会失败。但是有些情况下 malloc 也可能导致失败，因此最好在写入指针之前对其进行检查。

对于未来，最好做这样的事情

```
int *ptr = NULL;
// Allocate using cudaHostAlloc or malloc
// If using cudaHostAlloc check for success 
if (!ptr) ERROR_OUT();
// Write to this memory 
```

**编辑**（对问题中的编辑的回应）

错误消息表明与工具包相比，您的驱动程序较旧。如果您不想被卡住一段时间，请尝试下载与您的驱动程序兼容的旧版本的 cuda 工具包。您可以将它安装在您的用户帐户中并临时使用它的 nvcc + 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:02:45.510

您的段错误不是由对 cudaHostAlloc 分配的内存块的写入引起的，而是由尝试“释放”从 cudaHostAlloc 返回的地址引起的。我能够使用您提供的代码重现您的问题，但是用 cudaFreeHost 替换 free 为我修复了段错误。

[cudaFreeHost](http://www.clear.rice.edu/comp422/resources/cuda/html/group__CUDART__MEMORY_gedaeb2708ad3f74d5b417ee1874ec84a.html#gedaeb2708ad3f74d5b417ee1874ec84a)

# java - 在 1 次交互中从未排序的数组列表生成排序的数组列表？

> ID：13594208
> 
> 赞同：1
> 
> 时间：2012-11-27T22:20:08.647
> 
> 标签：java

假设我有 arraylist`A`并比较`A`I do的 2 个对象`a.getDistanceFromPlayer() < b.getDistanceFromPlayer()`。

我现在想要`B`一个包含所有`A`对象的列表，但在第一个对象最接近玩家的位置排序，最后一个对象最远。

最快的方法可能是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:24:35.703

你应该让你的班级实现*[Comparabl](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html) e*。

然后您可以使用[Collections.sort()](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html)对您的列表进行排序。

如果你想要一个排序的列表**和**一个未排序的列表，你必须制作一个副本。

* * *

另一种选择是创建一个[Comparator](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)。

如果您阅读[Collections 的文档](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html)，您会看到它有两种*排序*方法。

一种基于对象的*compareTo*方法（即它们的“*自然顺序*”）进行排序。

另一个基于作为第二个参数传递的 Comparator 进行排序。

* * *

这是另一个问题的链接，它提供了 Comparable 的示例实现：

*   [Comparable 的示例实现](https://stackoverflow.com/q/13576577/778118)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:27:31.627

Use Collections.sort with a custom comparator.

```
eg.
public class DistanceComparator implements Comparator<Integer>{

    @Override
    public int compare(YourObject o1, YourObject o2) {
        if (o1.getDistanceFromPlayer() > o2.getDistanceFromPlayer())
        {
           return 1;
        } 
        else if (o1.getDistanceFromPlayer() < o2.getDistanceFromPlayer())
        {
           return -1;
        }
        return 0;
    }
} 
```

Then in your program, call

```
Collections.sort(YourArrayInstance, new DistanceComparator()) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T22:29:30.463

让 A 实现 Comparable ，然后像这样定义方法 compareTo(Object other) ：

```
public int compareTo(Object other) {
  if( this.getDistanceFromPlayer() < other.getDistanceFromPlayer() ) {
      return -1;
  } else if( this.getDistanceFromPlayer() > other.getDistanceFromPlayer())  {
      return 1;
  }
  return 0;
} 
```

现在您可以在对象列表上调用 Collections.sort()

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T22:26:47.073

使用`Custom Comparator`：

```
B = Collections.sort(A, new CustomComparator());

public class CustomComparator implements Comparator<ClassA> {

    @Override
    public int compare(final ClassA a, final ClassA b) {
         //Make sure you check that neither a nor b are null..
         //..
         if (a.getDistanceFromPlayer() < b.getDistanceFromPlayer()) {
             return 1;
         } else if (a.getDistanceFromPlayer() > b.getDistanceFromPlayer()) {
             return -1;
         }
         return 0;

   }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-27T22:31:53.293

您可以使用自定义[Comparator](http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html)并对[ArrayList](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)[进行排序](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29)，如下所示：

```
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;

class Main {
    public static class Player {
        private final float distance;

        public Player (final float position) {
            this.distance = position;           
        }

        public float getDistanceFrom () {
            return distance;
        }

        @Override
        public String toString() {
            return "Player [distance=" + distance + "]";
        }
    }

    public static void main(String[] args) throws Exception {
        final ArrayList<Player> players = new ArrayList<Player> ();

        players.add (new Player (2));
        players.add (new Player (5));
        players.add (new Player (-3));
        players.add (new Player (1));

        Collections.sort(players, new Comparator<Player> () {
            @Override
            public int compare(Player o1, Player o2) {
                final float distance1 = o1.getDistanceFrom();
                final float distance2 = o2.getDistanceFrom();
                return (int) Math.signum (distance1 - distance2);
            }           
        });
        System.out.println(players);
    }
} 
```

和一个[小提琴](http://ideone.com/aTViJS)。

# list - Mathematica 参数方程和列表图

> ID：13594209
> 
> 赞同：0
> 
> 时间：2012-11-27T22:20:09.247
> 
> 标签：list, plot, wolfram-mathematica, equation

x = e^1/2*Cos((pi/4)t) + Cos(2Pi*t) y = e^1/3*1/2Sin(pi*t) + sin(2pi * t)

t E [a,b] 其中“a”和“b”是通过输入输入的。如何在 t = a、a+1、a+2、...、b 时刻画出“t”在哪里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T05:17:29.733

我不确定我是否理解你所说的`How can I draw where t is'. But if you want to draw`ParametricPlot `in`t` 命令是什么意思

```
x = Exp[1/2]*Cos[(Pi/4) t] + Cos[2 Pi*t] ;
y = Exp[1/3]*1/2 Sin[Pi*t] + Sin[2 Pi*t];
a = -1; b = 1;
ParametricPlot[{x, y}, {t, a, b}] 
```

![在此处输入图像描述](../Images/4cda0d0a6774e9779684e987e234df4b.png)

# android - 用于移动编程的物理 Flex 库

> ID：13594211
> 
> 赞同：0
> 
> 时间：2012-11-27T22:20:14.130
> 
> 标签：android, ios, flash, flex4, physics-engine

我正在寻找与 Flex 4 兼容的物理库。

有什么建议吗？

是否有任何物理库与 iPhone 和 Android 兼容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:00:11.103

[Box2d](http://www.sideroller.com/wck/)，它具有与 Box2D C++ 2D 物理引擎的 AS3 接口。

Jesse Sternberg 有一个基于 Alchemy 的[Box2d Flash Alchemy Port + World Construction Kit（GitHub 上的 AS3 物理引擎）](https://github.com/jesses/wck)。

# php - 如何在没有 OAuth 的情况下异步使用 Magento 的 API？

> ID：13594214
> 
> 赞同：1
> 
> 时间：2012-11-27T22:20:30.567
> 
> 标签：php, api, magento, rest, oauth

我正在将 Magento 商店与现有的桌面销售点软件集成在一起。我的想法是，这个桌面程序将通过 Magento 的 REST API 连接以收集产品列表、库存更改等，它还将通过 API 端点提交新产品和其他更新。

当我不希望 PoS 负责人知道 API 凭据或不想打扰提示它们时，就会出现问题。最好的办法是将它们设置在配置文件中。

我考虑在后台加载 API 授权页面并自动将凭据发布到登录表单。但这看起来是一种令人讨厌的方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:17:48.327

不是解决方案，而是在这件事上的一些经验...

Magento 的 API 可能很慢，用户将永远等待任务完成，尤其是在服务器负载不足的情况下。我们使用另一个应用程序，它使用我使用 java 构建的 Magento 的 SOAP API 来处理 magento 和我们的 POS 之间的所有更新/下载。这样，用户就不会等待缓慢的响应，也不会因失去连接而停止。

我们采用了您的队列方法，而让 1 个应用程序具有队列的另一个原因是它处理来自所有用户的所有更新，并且只允许一次执行 1 个任务。您需要这样做以避免数据库锁定。例如，两个用户修改了一个产品，你得到一个表锁错误，更新失败。您还可以通过向服务器发送大量单用户请求来使服务器过载。我们仍然有事件驱动的处理，而不是同步脚本，方法是让我们的 POS 向我们的本地应用程序发送消息，指示应用程序有关任务的信息，并且它只是将任务排队等待处理。我们的应用程序没有任何用户界面，我将它作为我们服务器上的系统服务运行，用户凭据存储在配置文件中。

# iphone - 从 XML 源过滤 UITableView

> ID：13594216
> 
> 赞同：1
> 
> 时间：2012-11-27T22:20:39.673
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我有这个在 UITableView 中显示的 XML：

```
<result>
<trip duration="03:30">
<takeoff date="2010-06-19" time="18:40" city="Moscow"/>
<landing date="2010-06-19" time="20:10" city="Novgorod"/>
<flight carrier="Rossiya" number="8395" eq="320"/>
<price>13429.00</price>
</trip>
<trip duration="03:40">
<takeoff date="2010-06-19" time="09:20" city="Omsk"/>
<landing date="2010-06-19" time="11:15" city="Paris"/>
<flight carrier="AirFrance" number="1145" eq="320"/>
<price>13229.00</price>
</trip>
<trip duration="03:50">
<takeoff date="2010-06-19" time="07:20" city="Omsk"/>
<landing date="2010-06-19" time="14:15" city="Barcelona"/>
<flight carrier="AirFrance" number="1100" eq="320"/>
<price>13329.00</price>
</trip>
</result> 
```

我正在使用此代码来保存它：

```
if ([elementname isEqualToString:@"trip"]) {
    currentTweet = [Tweet alloc];
    isStatus = YES;
    flightTime = [attributeDict objectForKey:@"duration"];
    currentTweet.flightDuration = [NSString stringWithFormat:@"Flight duration is: %@", flightTime];
}

if([elementname isEqualToString:@"takeoff"]) {

    takeoffPlace = [attributeDict objectForKey:@"city"];
} 
if ([elementname isEqualToString:@"landing"]) {
    landingPlace = [attributeDict objectForKey:@"city"];
    currentTweet.content = [NSString stringWithFormat:@"%@ - %@", takeoffPlace, landingPlace];
}

if ([elementname isEqualToString:@"takeoff"]) {
    takeoffDate = [attributeDict objectForKey:@"date"];
    takeoffTime = [attributeDict objectForKey:@"time"];
    currentTweet.takeOffAll = [NSString stringWithFormat:@"Take off date %@. Take off time %@", takeoffDate, takeoffTime];
}

if ([elementname isEqualToString:@"landing"]) {
    landingDate = [attributeDict objectForKey:@"date"];
    landingTime = [attributeDict objectForKey:@"time"];
    currentTweet.landingAll = [NSString stringWithFormat:@"Landing date %@. Landing time %@", landingDate, landingTime];
}

if ([elementname isEqualToString:@"flight"]) {
    companyName = [attributeDict objectForKey:@"carrier"];
    companyNumber = [attributeDict objectForKey:@"number"];
    eqStuff = [attributeDict objectForKey:@"eq"];
    currentTweet.companyInfo = [NSString stringWithFormat:@"Carrier: %@ Flight number: %@ Eq: %@", companyName, companyNumber, eqStuff];
} 
```

我需要按 2 个参数对 TableView 进行排序：

1.  `<trip duration="03:50">`时间_

2.  这`<price>`

我不确定我是否使用了正确的结构 - 基本上所有数据都是 NSStrings 分配给一个单独的数据类，然后分配给 UITableView 单元格内的 UILabels。

按时间和价格对数据进行排序的最佳方法是什么？关于我应该如何重新格式化代码的任何想法？

PS 我正在使用 SegmentedControl 重新加载 TableView 并相应地对其进行排序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:37:05.080

您需要将所有内容放入一个数组中，然后在排序后使用该数组加载 UITableView。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:58:32.687

您可以将结果存储在字典条目数组中，然后您可以使用`sortedArrayUsingComparator`我在此答案末尾演示的那样对数组进行排序。

例如，我的解析器如下：

```
@interface XmlParserViewController () <NSXMLParserDelegate>
{
    NSMutableArray *trips;
    NSMutableDictionary *currentTrip;
    NSMutableString *currentElement;
}
@end

@implementation XmlParserViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    trips = [[NSMutableArray alloc] init];

    // clearly I'm reading your XML from a file in my bundle, but you'll get it
    // how ever you're retrieving it from your remote source

    NSString *filename = [[NSBundle mainBundle] pathForResource:@"results" ofType:@"xml"];
    NSData *data = [NSData dataWithContentsOfFile:filename];
    NSXMLParser *parser = [[NSXMLParser alloc] initWithData:data];
    parser.delegate = self;
    [parser parse];
}

#pragma mark - NSXMLParserDelegate methods

#define kRowElementTag @"trip"

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qualifiedName attributes:(NSDictionary *)attributeDict
{
    NSArray *attributeElementNames = @[@"takeoff", @"landing", @"flight"];
    NSArray *foundCharacterElementNames = @[@"price"];

    if ([elementName isEqualToString:kRowElementTag])
    {
        currentTrip = [[NSMutableDictionary alloc] init];
        [trips addObject:currentTrip];
        if (attributeDict)
            [currentTrip setObject:attributeDict forKey:elementName];
    }
    else if (currentTrip)
    {
        if ([attributeElementNames containsObject:elementName])
        {
            if (attributeDict)
                [currentTrip setObject:attributeDict forKey:elementName];
        }
        else if ([foundCharacterElementNames containsObject:elementName] && currentElement == nil)
        {
            // you can change this to just grab a few fields ... add whatever fields you want to this

            currentElement = [[NSMutableString alloc] init];
            [currentTrip setObject:currentElement forKey:elementName];
        }
    }
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
{
    if ([elementName isEqualToString:kRowElementTag])
    {
        currentTrip = nil;
    }
    else if (currentElement)
    {
        currentElement = nil;
    }
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
{
    if (currentElement)
    {
        [currentElement appendString:string];
    }
}

- (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError
{
    NSLog(@"%s error=%@", __FUNCTION__, parseError);

    // we should handle the error here
}

- (void)parserDidEndDocument:(NSXMLParser *)parser
{
    NSLog(@"Order in XML:");

    for (NSDictionary *trip in trips)
    {
        NSLog(@"    %@ %@ %@ %@ %@ %@", trip[@"flight"][@"carrier"], trip[@"flight"][@"eq"], trip[@"takeoff"][@"date"], trip[@"takeoff"][@"time"], trip[@"trip"][@"duration"], trip[@"price"]);
    }

    NSArray *sortedTrips = [self sortResultsByDurationAndPrice];

    NSLog(@"Sorted order:");

    for (NSDictionary *trip in sortedTrips)
    {
        NSLog(@"    %@ %@ %@ %@ %@ %@", trip[@"flight"][@"carrier"], trip[@"flight"][@"eq"], trip[@"takeoff"][@"date"], trip[@"takeoff"][@"time"], trip[@"trip"][@"duration"], trip[@"price"]);
    }

    // you can now update your user interface or do whatever at this point
    //
    // [self.tableView reloadData];
} 
```

你会注意到那个`parserDidEndDocument`调用`sortResultsByDurationAndPrice`看起来像：

```
- (NSArray *)sortResultsByDurationAndPrice
{
    NSArray *sortedTrips = [trips sortedArrayUsingComparator: ^(id trip1, id trip2) {

        double duration1 = [self durationFromString:trip1[@"trip"][@"duration"]];
        double duration2 = [self durationFromString:trip2[@"trip"][@"duration"]];

        double price1 = [trip1[@"price"] doubleValue];
        double price2 = [trip2[@"price"] doubleValue];

        if (duration1 < duration2 || (duration1 == duration2 && price1 < price2)) {
            return (NSComparisonResult)NSOrderedAscending;
        }

        if (duration1 > duration2 || (duration1 == duration2 && price1 > price2)) {
            return (NSComparisonResult)NSOrderedDescending;
        }

        return (NSComparisonResult)NSOrderedSame;
    }];

    return sortedTrips;
}

// this assumes that duration is in the form of "h:mm"

- (double)durationFromString:(NSString *)durationString
{
    NSArray *durationArray = [durationString componentsSeparatedByString:@":"];

    return [durationArray[0] doubleValue] + [durationArray[1] doubleValue] / 60.0;
}

// sort by date and time not used, but was part of my original answer
// so I provide it here for the sake of completeness

- (NSArray *)sortResultsByDateTime
{
    NSArray *sortedTrips = [trips sortedArrayUsingComparator: ^(id trip1, id trip2) {

        NSComparisonResult dateComparison = [trip1[@"takeoff"][@"date"] compare:trip2[@"takeoff"][@"date"]];
        NSComparisonResult timeComparison = [trip1[@"takeoff"][@"time"] compare:trip2[@"takeoff"][@"time"]];

        if (dateComparison == NSOrderedAscending || (dateComparison == NSOrderedSame && timeComparison == NSOrderedAscending)) {
            return (NSComparisonResult)NSOrderedAscending;
        }

        if (dateComparison == NSOrderedDescending || (dateComparison == NSOrderedSame && timeComparison == NSOrderedDescending)) {
            return (NSComparisonResult)NSOrderedDescending;
        }

        return (NSComparisonResult)NSOrderedSame;
    }];

    return sortedTrips;
} 
```

显然，您可以`sortResults`根据您个人的字典条目数组进行调整，但这应该让您了解它是如何工作的。

# connection-pooling - Petapoco 和 Azure SQL 连接池

> ID：13594217
> 
> 赞同：4
> 
> 时间：2012-11-27T22:20:39.937
> 
> 标签：connection-pooling, azure-sql-database, petapoco

Petapoco.cs 的核心是函数 OpenShareConnection。我相信这不能利用 SQL Azure 中的连接池。我正在监视我的连接，并且连接数超过了池限制。

有人做过一些改进吗？

这是 OpenShareConnection（来自 Petapoco 开源）：

```
 public void OpenSharedConnection()
    {
        if (_sharedConnectionDepth == 0)
        {                
            //read the connection string from web.config and 
            //create a new connection
            _sqlConnection = _factory.CreateConnection(); 
            _sqlConnection.ConnectionString = _connectionString;

            // Wrap this method with a retry policy.
            _sqlConnection.Open();

            _sqlConnection = OnConnectionOpened(_sqlConnection);

            if (KeepConnectionAlive)
                _sharedConnectionDepth++;       // Make sure you call Dispose
        }
        _sharedConnectionDepth++;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-29T15:14:22.310

[https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql-server-connection-pooling](https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql-server-connection-pooling)

据我所见，Petapoco 正在与 ADO 连接池背后的基本前提作斗争，而不是创建新的 SQLConnection(string connectionString)，然后在连接关闭时执行 .Close() 方法。

这 4 年除了蟋蟀唧唧喳喳什么都没有，这并不奇怪。9个月大的问题。

# biztalk - 如何从编排中返回带有内容的肥皂错误？

> ID：13594220
> 
> 赞同：0
> 
> 时间：2012-11-27T22:20:53.853
> 
> 标签：biztalk, biztalk-2010, biztalk-orchestrations, biztalk-wcf

在一个业务流程 (BizTalk 2010) 中，我们收到一条 xml 消息，根据架构验证消息，并执行 schematron（内容）验证。我们的编排通过 WCF 服务公开。我们的验证例程能够捕获所有验证错误，我们希望通过包含所有验证错误的 soap 错误返回这些错误。此外，我们希望编排正常完成，即使在验证错误的情况下（没有挂起的消息）。我们怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T10:39:49.213

如果你想使用普通的肥皂故障，那么你需要做的就是将肥皂故障消息部分添加到接收端口。在您的编排中进行验证，如果验证失败，则构建一个soap错误消息并发送该消息而不是正常结果。

您可能需要在一个范围内执行上述操作，以便您可以处理异常并让编排优雅地终止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T09:23:27.683

请参阅[Using SOAP Headers](http://msdn.microsoft.com/en-us/library/ee253855%28v=bts.10%29.aspx)，特别是 SOAP Headers with Published Web Services。

# r - 数字值包括逗号——如何使这些数字化？

> ID：13594223
> 
> 赞同：10
> 
> 时间：2012-11-27T22:21:03.807
> 
> 标签：r, numeric

我有一整列数字，其中包括数千个逗号分隔符。当我尝试从中创建一个数字列时，超过 999 的任何内容都变为 NA。

我使用了cbind：

```
df <- cbind(df, var2 = as.numeric(as.character(df$var1))) 
```

最后得到：

```
 var1  var2
1   2,518.50    NA
2   2,518.50    NA
3   5,018.50    NA
4   4,018.50    NA
5  10,018.50    NA
6     318.50 318.5
7   2,518.50    NA
8   3,518.50    NA
9   7,518.50    NA
10  1,018.50    NA 
```

有没有办法去掉逗号或告诉`as.numeric`如何处理它们？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-27T22:36:30.730

如果您尝试向 中添加新列`var2`，`df`可以使用以下命令

```
 df$var2 <- as.numeric(gsub(",", "", as.character(df$var1))) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T22:37:14.897

使用`as.numeric(gsub(",", "", df$var1))`.

您想使用`gsub`as`sub`只会替换第一个逗号。

# jquery - 带有水豚的 Jquery UI 滑块

> ID：13594224
> 
> 赞同：0
> 
> 时间：2012-11-27T22:21:10.250
> 
> 标签：jquery, ruby-on-rails-3, capybara, jquery-ui-slider

我们目前定义了一个 jQuery UI 滑块：

```
/ Search implementation
$("input#price-range").slider({
  from:1,
  to:200,
  step:5,
  round:0,
  scale:[1, '|', 50, '|', 100, '|', 150, '|', 200],
  dimension:"$",
  skin:"round",
  callback: do_search
}); 
```

我要做的是测试移动滑块的效果和回调函数的结果。实时，代码可以工作，但用 Capybara/Cucumber 测试它被证明是困难的。

我努力了

```
page.execute_script("$('#price-range').slider('value',#{price});") 
```

设置一个值，但回调似乎不是以这种方式调用的。知道如何设置值并在我的黄瓜测试中触发回调吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:37:12.337

我不相信 jQueryUI Slider 实现了“回调”选项。至少，它没有在此处列出：http: [//api.jqueryui.com/slider/](http://api.jqueryui.com/slider/)，并且在此处的代码中不明显： [http ://code.google.com/p/jquery-ui/source/browse/tags /1.8.2/ui/jquery.ui.slider.js](http://code.google.com/p/jquery-ui/source/browse/tags/1.8.2/ui/jquery.ui.slider.js)。我想它可以在继承层次结构中进一步定义。

在滑块的源代码中，您可以看到`value`方法调用`_change`，这将触发“更改”事件。因此，如果您像这样传递回调函数，它可能会更好：

```
/ Search implementation
$("input#price-range").slider({
  from:1,
  to:200,
  step:5,
  round:0,
  scale:[1, '|', 50, '|', 100, '|', 150, '|', 200],
  dimension:"$",
  skin:"round",
  change: do_search
}); 
```

# git - git 有时会丢失第二个 svn 合并父级的跟踪

> ID：13594233
> 
> 赞同：0
> 
> 时间：2012-11-27T22:21:53.607
> 
> 标签：git, svn, merge, git-svn

天，

我正在使用 git、svn 和 git-svn。

我一直在使用颠覆来合并主题分支。

有时，我注意到当我随后执行 git svn fetch 时，第二个父级的合并信息会丢失给 git，因此在 git 历史记录中，合并看起来像一个单一的大型提交，而不是保留对第二个父母。这并不总是发生，但我无法确定导致它发生的确切情况。

谁能解释为什么会发生这种情况以及可以采取哪些措施来防止这种情况发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:31:03.703

本[文档](http://git-scm.com/book/en/Git-and-Other-Systems-Git-and-Subversion)解释了一些集成 svn 和 git 的问题，可能会有所帮助。具体来说：

> 当您熟悉 Git 工作流程时，您可能会创建主题分支，对其进行处理，然后将它们合并。如果您通过 git svn 推送到 Subversion 服务器，您可能需要重新设置您的工作每次都放到一个分支上，而不是将分支合并在一起。更喜欢变基的原因是 Subversion 具有线性历史并且不像 Git 那样处理合并，因此 git svn 在将快照转换为 Subversion 提交时仅遵循第一个父级。

# vb.net - 如何完全停止运行代码并退出应用程序？

> ID：13594234
> 
> 赞同：10
> 
> 时间：2012-11-27T22:21:58.257
> 
> 标签：vb.net, visual-studio-2010

在我的代码中，我检查可执行文件`op.exe`是否在应用程序运行路径目录中，如果不是，它会显示`MsgBox`并退出应用程序，问题是它并没有真正退出应用程序，因为后面的代码正在执行每次。

这是我正在谈论的代码：

```
 If Not File.Exists("op.exe") Then
        MsgBox("op.exe not found!", MsgBoxStyle.Critical, "Error")
        Application.Exit()
    End If
    IO.Directory.CreateDirectory('files') 
```

MsgBox 出现，应用程序确实退出，但它在`files`之后创建目录 ( `IO.Directory.CreateDirectory('files')`) 。我不想这样，我想在显示 MsgBox 后完全关闭应用程序。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-27T23:33:58.360

试试`Environment.Exit(0)`吧。[`Application.Exit`](http://msdn.microsoft.com/en-us/library/system.windows.application.exit.aspx)导致消息循环退出，但这是通过消息循环从其队列中读取“退出”消息而发生的。[`Environment.Exit`](http://msdn.microsoft.com/en-us/library/system.environment.exit.aspx)导致进程本身退出。

# javascript - 用于自动填充多个字段的 jQuery 库

> ID：13594238
> 
> 赞同：1
> 
> 时间：2012-11-27T22:22:06.367
> 
> 标签：javascript, jquery

我有多个带有字符限制的文本框，它们共同构成一个代码。由于各种原因，将盒子分开是有价值的。我希望能够在第一个文本框中粘贴完整的代码并让它自动填充所有文本框。对于这种情况，有没有办法在 javascript 或 jquery 库中执行此操作？

目前我在每个文本框上使用 jQuery autotab，我更愿意保留该功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:10:21.383

你当然可以在 JS 中做到这一点。我不知道有一个图书馆可以为你做这件事。在这里从臀部拍摄，但可能是这样的：

**示例 HTML**

```
<input type='text' data-auto-pop='true' data-group='1' data-char-limit='3'/>
<input type='text' data-auto-pop='true' data-group='1' data-char-limit='3'/>
<input type='text' data-auto-pop='true' data-group='1' data-char-limit='4'/> 
```

**示例 JS**

```
$("input[data-auto-pop='true']").change(function () {
  var $this = $(this), val = $this.val();
  if ($this.data("char-limit") > val.length) {
    return;
  } else {
    var setVal = function() {
      $this.val(val.slice(0, $this.data("char-limit"));
      val = val.slice($this.data("char-limit"));
    };
    setVal();
    while ($this.closest("input[data-group='"+$this.data("group")+"']") && val.length > 0) {
      $this = $this.closest("input[data-group='"+$this.data("group")+"']");
      setVal();
    }
  }
} 
```

可能有一些错误，但你应该明白。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:30:23.067

**[演示](http://jsfiddle.net/9DDvQ/)**

使用 onpaste 事件从用户的剪贴板中捕获数据。然后获取该数据并生成适合您输入的数组。然后使用 .val() 设置这些值

**JS**

```
$(function(){

    // get first input element
    pastable = document.getElementById('pastable');          
    // listen for the user to paste
    pastable.onpaste = function(e){
        // retrieve paste data as an array split to each 3 characters (3 dots below in regex)
        var inputArray = e.clipboardData.getData('text/plain').match(/.../g);
        // loop over input fields
        $('input').each(function(i){
             // place data from paste
             $(this).val(inputArray[i]);                
        });
    };

});​ 
```

**HTML**

```
<input type='text' id="pastable" maxlength="3"/>
<input type='text' maxlength="3" />
<input type='text' maxlength="3" />​ 
```

# actionscript-3 - 从 Blender 导出到 Flare3D

> ID：13594240
> 
> 赞同：1
> 
> 时间：2012-11-27T22:22:13.023
> 
> 标签：actionscript-3, export, blender, collada, flare3d

我在 Blender 中创建了一个地图对象，并希望将其导出以在 Flash Builder 中与 Flare3D 一起使用。但是，当我尝试这个时，没有包含任何纹理。这样做的正确方法是什么以便包含纹理？还是我必须单独生成 UV 纹理贴图？

# javascript - 如何在javascript中的两个分隔符之间拆分字符串？

> ID：13594241
> 
> 赞同：11
> 
> 时间：2012-11-27T22:22:14.157
> 
> 标签：javascript, html, arrays, regex, string

我知道如何使用多个分隔符进行拆分，但我不知道如何将字符串拆分为两个字符*之间的数组。*所以：

```
var myArray = "(text1)(text2)(text3)".split(???)
//=> myArray[0] = "text1", myArray[1] = "text2", myArray[2] = "text3" 
```

我应该在“？？？”中输入什么？还是我应该使用其他方法？

*使“）（”分隔符不起作用，因为我想用各种分隔符（例如“>”）拆分数组，这使得列出所有可能的分隔符组合非常不切实际*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-27T22:32:46.960

```
.split(/[()]+/).filter(function(e) { return e; }); 
```

请参阅**[此演示](http://jsfiddle.net/wsNx7/)**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:26:56.697

使用 JavaScript 在不丢失任何字符的情况下使用特定字符之间的拆分是不可能的，因为您需要对此进行查看（不支持）。但是，由于您似乎想要括号*内*的文本，而不是拆分，您可以只`match`使用不包含括号的最长可能字符串：

```
myArray = "(text1)(text2)(text3)".match(/[^()]+/g) 
```

# java - 可以将带有可能异常的动态加载的对象声明为最终对象吗？

> ID：13594242
> 
> 赞同：3
> 
> 时间：2012-11-27T22:22:16.023
> 
> 标签：java, variables, dynamic, exception-handling, final

起初我打算只提出关于`Image`班级的问题，但我想让它尽可能广泛地适用。

基本上，这就是场景。我正在为 GUI 常量制作一个文件，在这个文件中，我想为`Image`我正在使用的每个 s 提供最终变量。所以我的字段声明如下`UP_ARROW`：

```
public static final Image UP_ARROW; 
```

然后我尝试在`ImageIO`API 时加载它们，如下所示：

```
static {
    UP_ARROW = ImageIO.read(new File("img/upArrow.png"));
} 
```

不幸的是，这不是有效的、可编译的代码，因为它是明确`throws IOException`的，我必须处理。所以我修改它并用 try/catch 包围它：

```
static {
    try {
        UP_ARROW = ImageIO.read(new File("img/upArrow.png"));
    }
    catch(IOException ioe) {
        //TODO
    }
} 
```

现在我得到一个不同的编译器错误。这次它说该字段可能尚未初始化。好吧，这是有道理的。感谢您向我指出这一点，编译器。这似乎是一个简单的解决方法：

```
static {
    try {
        UP_ARROW = ImageIO.read(new File("img/upArrow.png"));
    }
    catch(IOException ioe) {
        UP_ARROW = null;
    }
} 
```

现在，无论如何，`UP_ARROW`必须使用我的图像或`null`. 我准备宣布胜利并继续前进。但现在我得到*另一个*意外的编译器错误：

![最后一个字段 UP_ARROW 可能已经被分配](../Images/6c4769f3f5501b4da55f7b0cac0989b5.png)

...再次挫败，编译器！

因此问题是：有什么办法可以解决这个问题，以便我可以在运行时动态加载最终字段？还是我宣布失败并简单地将`Image`s 设为非决赛？

此外，解释为什么编译器不允许这样做也会有所帮助。据我了解，根据上面的代码，在到达块之前*无法*分配`UP_ARROW`对象，*因为那肯定是抛出异常的原因*。因此，如果成功执行，则只发生一项分配。如果它没有成功执行，仍然只有一个分配发生。那怎么无效？*`catch{}`*`try{}`**

 *** * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:24:17.013

以下应该做到这一点：

```
static {
    Image up_arrow = null;
    try {
        up_arrow = ImageIO.read(new File("img/upArrow.png"));
    }
    catch(IOException ioe) {
        // log the error?
    }
    UP_ARROW = up_arrow;
} 
```

`finally`将最终分配包含在一个block中可能是有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:34:49.843

NPE 的回答很好，但我认为这个（基于他的和）更好：

```
public enum Arrows {
    UP ("img/upArrow.png"),
    DOWN ("img/downArrow.png"),
    LEFT ("img/leftArrow.png"),
    RIGHT ("img/rightArrow.png");

    public final Image myImage;

    private Arrows(String fileName) {
        Image tempImage;
        try {
            tempImage = ImageIO.read(new File(fileName));
        } catch (IOException e) {
            tempImage = null;
        }
        myImage = tempImage;
    }
} 
```

这解决了您的问题，并为您提供了`enum`over `static final`variables 的所有优势。**

# vb.net - 在 vb.net 中嵌入 null 的字符串长度

> ID：13594248
> 
> 赞同：4
> 
> 时间：2012-11-27T22:22:40.537
> 
> 标签：vb.net, vb6, string-length

我有一个简单的问题：vb.net 如何确定字符串长度并处理字符串的终止？
我知道`C`（及其系列）空字符是字符串的结尾。在 vb6 中，空字符对字符串的终止没有影响，但在 vb.net 中它似乎有雾！
假设 vb6 中的代码：

```
Private Sub Command1_Click()
Dim Str As String
Str = "Death is a good user," & Chr(0) & " Yes I'm good"
RichTextBox1.Text = Str
RichTextBox1.Text = RichTextBox1.Text & vbNewLine & Len(Str)
End Sub 
```

当此代码运行时会发生以下情况： ![在此处输入图像描述](../Images/ea935c23b886afa62e732fe2fbac8008.png)

而且没关系。这是类似的代码`C`：

```
#include "stdafx.h"
#include <string.h> 
int main(int argc, char* argv[])
{
    char *p="Death is a good user,\0 Yes I'm good";

    printf("String:%s\nString length:%d\n",p,strlen(p));

    return 0;
} 
```

这就是发生的事情：
![在此处输入图像描述](../Images/17f0f79b3e33c26dcf680808483d4aaf.png)

根据规则，这也很好`C`，但这是 vb.net 中的相同代码：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim str As String = "Death is a good user," & Chr(0) & " Yes I'm good"
    RichTextBox1.Text = str
    RichTextBox1.Text &= vbNewLine & str.Length
End Sub 
```

会发生什么：
![在此处输入图像描述](../Images/4077254c9352ab3f810852c6ec833c08.png)

这似乎不太对劲！

**编辑1**：写入文件似乎是正确的：

![在此处输入图像描述](../Images/abbe695527d069062901b59a11c8fb58.png)

**编辑 2**：[Mark](https://stackoverflow.com/questions/13594248/string-length-in-vb-net#comment18636219_13594313) 和[tcarvin](https://stackoverflow.com/a/13594313/440546)建议，这可能是 UI 的问题，但它没有解释为什么 vb6 显示整个字符串！

**编辑 3**：我知道 Windows 及其 API、UI、... 是用 编写的`C`，所以他们会做出类似的反应是正常的`C`，但正如我上面所展示的，他们没有。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-27T22:27:37.853

In VB.NET (and C#) strings are treated very similarly to how they are in VB6, and that is they have an explicit length that is not based on any particular character or characters contained within them.

In regards to the RichTextBox, it would simply appear that it does not support an embedded null character.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-06T23:36:33.773

底层运行时支持库在您的代码片段中使用了 3 种不同的字符串类型：

*   BSTR，由 VB6 使用。它是所有 ActiveX 控件使用的 COM 自动化类型，可以存储 Unicode 字符串并包括显式长度。因此，BSTR 可以存储嵌入的零。
*   C 字符串，由 C 语言使用。没有存储显式长度，零表示字符串结束。winapi 是基于 C 的，并在其函数中使用 C 字符串。
*   System.String，.NET 字符串类型，用于任何 .NET 代码。与 BSTR 类似，它也有一个明确的长度字段，因此可以存储嵌入零的字符串。

在所有三种情况下，底层运行时支持库都需要使用互操作来使字符串可见：

*   VB6 为 RichEditBox 使用 ActiveX 控件。很难猜出该控件的确切外观，它非常特定于 VB6，并被命名为richtx32.ocx。它也使用原生 Windows Richedit 控件 (riched32.dll)，因此 ActiveX 控件非常充当包装器，使原生 Windows 控件可在 VB6 应用程序中使用。您已经最终证明它尊重 BSTR 的行为并处理嵌入的零，就像任何 ActiveX 控件一样。

*   C 程序使用 C 运行时库，该库又通过调用 winapi 控制台函数 WriteConsole() 来实现 printf()。这个 api 函数是基于 C 的，但降压已经在 printf() 处停止，嵌入的零是该函数的字符串终止符。这里没有惊喜。

*   Winforms 程序使用 .NET RichEditBox 类，它是riched20.dll 本机 Windows 控件的托管包装。底层机制是 pinvoke，类的几乎所有属性和方法都是通过 pinvoking SendMessage() 来实现的，以发送消息，例如 EM_SETTEXTEX，该消息会更改控件显示的文本。这也是一个基于 C 的 api，零就像一个字符串终止符。与richtx32.ocx 包装器不同，.NET RichEditBox 包装器类**不努力**正确处理嵌入零的字符串。它只是按原样传递字符串并将其留给 pinvoke 编组器将 .NET 字符串转换为 C 字符串。除了在零处截断字符串之外别无选择，因为 C 字符串没有长度字段。

# html - 使浏览器包装表格单元格

> ID：13594253
> 
> 赞同：5
> 
> 时间：2012-11-27T22:22:55.887
> 
> 标签：html, css

我有这个代码

```
HTML:
<div id="table">
    <div class="table-cell"></div>
    <div class="table-cell"></div>
    <div class="table-cell"></div>
    <div class="table-cell"></div>
    <div class="table-cell"></div>
    <div class="table-cell"></div>
    <div class="table-cell"></div>
    <div class="table-cell"></div>
</div>

CSS:
#table {
    display: table;
    width: 940px;
    table-layout: fixed;
}
.table-cell {
    display: table-cell;
    overflow: hidden;
    width: 220px;
    height: 282px;
    padding: 9px 10px;
} 
```

是否可以在每添加 4 个后让浏览器包装表格单元格。我的意思是每 4 个表格单元创建新行。

谢谢！

PS 一行中只有 4 个单元格的位置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:31:21.917

CSS：

```
#table {
    display: table;
    width: 940px;
    table-layout: fixed;
}
.table-row
{display:table-row;}

.table-cell {
    display: table-cell;
    overflow: hidden;
    width: 220px;
    height: 282px;
    padding: 9px 10px;
} 
```

html:

```
<div id="table">
    <div class="table-row" >
        <div class="table-cell">1</div>
        <div class="table-cell">2</div>
        <div class="table-cell">3</div>
        <div class="table-cell">4</div>
    </div>
    <div class="table-row" >
        <div class="table-cell">1a</div>
        <div class="table-cell">2a</div>
        <div class="table-cell">3a</div>
        <div class="table-cell">4a</div>
    </div>
</div> 
```

你说需要自动：

您可以将 css 更改为：

```
#table {
    display: table;
    width: 960px !important;
    table-layout: fixed;
}
.table-cell {
    float: left;
    display: table-cell;
    overflow: hidden;
    width: 220px;
    height: 282px;
    padding: 9px 10px;
} 
```

# maven - 通过 Maven 运行 SoapUi 不会加载数据源

> ID：13594254
> 
> 赞同：2
> 
> 时间：2012-11-27T22:23:04.133
> 
> 标签：maven, soapui

带有 Maven 的 SoapUI 4.5.1 插件

我有一个正确加载数据源的功能测试，然后我可以在后续的 Groovy 脚本步骤中访问加载的数据。

```
log.info context.expand( '${DataSource#req_messageID}' ) 
```

但是，当通过 Maven 插件运行相同的测试用例时，不会加载数据源。我已经验证了用于加载的 xls 文件的路径已传递到 maven 运行中，并且是准确的。

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T15:30:06.557

我遇到了这个问题，最终意识到您需要 maven-soapui- **pro** -plugin才能使数据源工作，因为这是一个专业功能

# url - url 中的用户名但使用“/”跟随上下文路径？

> ID：13594255
> 
> 赞同：0
> 
> 时间：2012-11-27T22:23:04.233
> 
> 标签：url, jakarta-ee, jquery, url-rewriting, urlencode

我正在使用*Servlets在***Java EE中开发在线招聘系统，我想通过使用****'/'**将用户名添加到上下文路径来为每个用户提供自己唯一的 url 。

 ***简单地说，我想将我的 url 从**/main**重写为**/main/username**，这样当人们登录时，他们可以在地址栏中看到他们的用户名（就像在 stackoverflow 或 facebook 上一样）。

例如。目前我正在使用*Jquery Ajax重定向到***"/main?username="+username** (工作正常)，但我想重定向到**/main/username**。我尝试了*encodeURL 方法*，但 '/' 使搜索进入子目录。如果有人认为它应该工作，请给我语法。我已经在*web.xml*中完成了 url 映射。（例如，signin.jsp 映射到*登录*uri）

 ****** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:28:00.350

Usually this is achieved using url rewrites on the server. For IIS that means creating a web.config or in apache creating a .htaccess file. You'll need to find the equivalent for your server and it can then be made to parse the directory structure type /username/ into a HTTP GET variable for your application.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:33:36.037

如果我理解您的问题，您希望拥有一个 Java EE 站点`myrecruitingsite.com`，例如可以将用户重定向到`myrecruitingsite.com/main/<username>`. 当向`myrecruitingsite.com/main/arg21`或发出请求时`myrecruitingsite.com/main/geoffreywiseman`，您希望请求转到同一个 servlet，并且您想知道请求了哪个用户名。

Java servlet 映射不像许多现代 Web 框架那样直接支持复杂的路由模式。您不能将 web.xml 配置为向`myrecruitingsite.com/main/<username>`用户配置文件 servlet 和`myrecruitingsite.com/main/<username>/contact`联系人 servlet 发送请求。您可以进行通配符映射，但之后的所有路由决策都必须在`web.xml`.

或者，您可以进行[URL 重写](http://en.wikipedia.org/wiki/Rewrite_engine)（通常使用 servlet 过滤器），以使浏览器请求的 URL 不是 servlet 映射层最终解释的 URL。有这方面的框架，或者你可以自己做。

基本上，您需要使用通配符配置[servlet mapping](http://docs.oracle.com/cd/E13222_01/wls/docs92/webapp/configureservlet.html)的 url 模式，然后查询 [getPathInfo()](http://docs.oracle.com/javaee/1.2.1/api/javax/servlet/http/HttpServletRequest.html#getPathInfo%28%29)以找出通配符的其余部分是什么。仅此一项就很简单了。

如果您正在使用各种 Java Web 框架中的任何一个，那么将会有路由功能，并且很可能有一个前端控制器 servlet 可以满足您的需求。在这种情况下，您需要查看框架的文档以获取更多信息。

另一方面，如果您自己使用 servlet（甚至是 servlet + jsp），您可以只对单个 servlet 进行通配符映射，当您向其添加更多功能时，该 servlet 会变得越来越大，或者更多很可能，您需要开发自己的微框架，其中 servlet 充当[前端控制器 servlet](http://martinfowler.com/eaaCatalog/frontController.html)并执行路由工作并将所有后续工作委托给普通的旧 Java 对象 (POJO)。

例如，您的路由 servlet 可以维护 url 模式（可能在 java 正则表达式中指定）与您自己创建的对象之间的映射，这些对象要么模仿 servlet 接口，要么模仿您自己创建的另一个接口。这样，您就有了一个负责绑定在 web.xml 中的路由决策的 servlet，以及一个负责特定请求细节的小类网络。这是工作，但并不是非常困难。********

# joomla2.5 - 我如何从 Joomla K2 图像处理中生存下来？

> ID：13594256
> 
> 赞同：2
> 
> 时间：2012-11-27T22:23:05.770
> 
> 标签：joomla2.5, joomla-extensions, joomla-k2

一年前，我为特定业务领域开设了一个新闻网站。该网站列出了新闻，每篇文章都有一张特色图片。不幸的是，一年内发布了大约 1500 条新闻，该网站占用了 1,07GB 的空间。这对我来说似乎完全疯了，因为 joomla 只有几兆字节，而且我这边没有大的添加（如文件或图形等）。

我犯了一个巨大的错误。我信任 joomlaworks 的人并安装了 K2。我这样做的主要原因是默认的 joomla 文章管理器没有提供为每个帖子保存特色图片。但这是在新的 3.0 版本中添加的！

K2 做了一些极其愚蠢的事情。如果您保存一张 2 MB 的照片，那么它将保存原始照片和另外 4 张照片，每种尺寸（小、大、中、XL）各一张。疯狂的是，你上传了一个 2Mb 的图像，它最终占用了 4Mbytes 的空间！

托管服务提供商给了我 2GB 的空间来存储我的文件。我晚上开始失眠，因为空间一天比一天扩大，如果超过 2GB，我将不得不升级托管计划，我没有钱这样做。

我相信我有三个选择：

1.  将所有项目、类别、图像从 K2 移回更快的 Joomla 文章，然后升级到支持特色图像的 3.0 版。这似乎非常困难，我不知道这是否可能。即使我将所有表行从 K2 移动到 Joomla，我对 1500 个行感到不舒服，并且图像的路径也没有保存在数据库中。混乱。

2.  将所有内容移至 wordpress。完全不知道该怎么做。

3.  压缩缓存中的图像或寻找阻止 K2 这样做的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T00:00:28.733

k2 将图像保存在两个不同的文件夹中。一个文件夹专门保存原件，另一个文件夹保存所有调整大小的版本。从技术上讲，您可以删除带有原件的文件夹，因为这些不是文章中或网站上其他任何地方使用的文件夹。让我们不要说 k2 的坏话，因为它们保存了原件。我认为这是一个很好的功能。我曾经需要进入我主机上的那个文件夹并找到一个从我的计算机中删除的文件。此外，您将来可以轻松地使用该文件夹来重建所有调整大小的文件，以防您想更改布局的大小。

我只是每隔一段时间备份一次文件夹并删除您主机上的副本。这应该可以节省很多空间。您还可以设置一个选项，使调整大小的文件的质量降低，这样它们就不会占用太多空间。后端有一个选项。在 70-80% 时，照片质量仍然很棒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:32:44.850

为什么你认为塑造小、中、大形象是非常糟糕的？你真的有图像的预览，它以较小的尺寸出现吗？如果是这样 - 这是一个明智的做法。

如果您真的不使用任何较小的图像 - 我建议逐行通过 K2 插件（或其他任何插件）并找到保存这些附加图像的行的确切位置并评论它们。

只是另一件事。你是如何为新闻网站获得 2 Mb 图片的。在我看来，这应该是真正的高分辨率图像，因为正常大小是 300kb。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-08T13:34:23.100

在 www__TemplateName__\media\k2\items 文件夹中，您将看到两个子文件夹“cache”和“src” - 后一个用于源文件。每月一次可以将内容安全地移出到本地驱动器。然而，我会说如果你最终得到 1.5k 条新闻，datadase 也会占用大量空间。大多数托管商也将数据库空间计入其中。而且您将无能为力-您就是不能扔掉DB ...

然后，即使您不使用它（可能），您也很可能在同一主机上拥有电子邮件服务器。如果你一年内有 1.5k 条新闻——我可以想象有多少垃圾邮件最终会进入你的邮件文件夹——这会占用你在主机上的 2 场演出的空间……检查你的邮件文件夹——杀死所有你不需要的东西那里...

你说“我需要 joomla 专家的回答”——Joomla 专家不会告诉你太多——需要 k2 专家。并且给出了答案 - 将 k2 兑现的图像质量降低到 70% - 它会做得很好 - 节省大量空间并且质量下降将不可见 - 此设置设置一次，适用于所有作者。 ..

对于 DB，我强烈建议安装[http://extensions.joomla.org/extensions/access-a-security/site-security/site-protection/14087](http://extensions.joomla.org/extensions/access-a-security/site-security/site-protection/14087)，然后单击 Clean Temp and Repare Tables -它也有帮助。

然后，另一件事是为 k2 批量调整原始文件夹中的文件大小 - 在互联网的坑中有大量不同的脚本。不时在那里运行它，来自您的用户的疯狂大文件将令人难以置信地缩小！

但最重要的是 - 在这些日子里，有很多 2gigs ？？？这太疯狂了。在我的情况下，每年 50 美元给我 6gigs - 这不是这里最便宜的主机......所以......改变你的主机！

# linux - 在 Linux 中检查目录内容的脚本

> ID：13594257
> 
> 赞同：1
> 
> 时间：2012-11-27T22:23:17.710
> 
> 标签：linux, shell

我如何编写 Linux shell 脚本来检查目录的内容以查看是否已存在同名文件？

要检查的目录/位置将使用 grep 函数从文件 /root/TAM/store 中获取。

store 的内容是我在之前的脚本中移动到垃圾箱的文件的目录，它存储了它们在 mv 之前所在的目录

输入只是垃圾箱中您要恢复到其原始位置的文件的名称，如果我的文件存在，它应该要求您重命名或选择一个新的目录

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:27:20.090

[这是](http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_07_01.html)在 bash 脚本中使用 if 语句检查文件是否存在的一个很好的示例（在 7.1.1.3 标题下）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:28:09.910

If the file `/root/TAM/store` has just a line with the directory to search, you can do as follows

```
if ls `cat /root/TAM/store` | grep -q filename_to_look_for; then
    echo "filename_to_look_for exists"
else
    echo "filename_to_look_for doesn't exist"
fi 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T22:29:30.577

您的要求缺少很多细节，但通常您可以这样做来检查特定文件是否存在：

```
grep "pattern" location_file | xargs ls 
```

# .net - Soap Exception 消息从两个不同的服务器为同一个 asmx 服务返回两个不同的错误消息

> ID：13594265
> 
> 赞同：1
> 
> 时间：2012-11-27T22:24:15.043
> 
> 标签：.net, service, asmx

我们在两台不同的服务器上部署了一个 ASMX 服务和相同的代码，但是每当一台服务器发生异常或错误时，两台服务器返回的异常消息都是不同的。特别是故障字符串不同。以下是返回的示例消息来自两台服务器的错误

**来自第一台服务器的消息**

```
The remote server returned an error: (500) Internal Server Error.
SOAP Response: 

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <soap:Body>
    <soap:Fault>
      <faultcode>soap:Client</faultcode>
      <faultstring>Fault occurred</faultstring>
      <faultactor>http://bbbonline.consumerservice/service.asmx?op=FileComplaint</faultactor>
      <detail>ErrorOccured at so and so..</detail>
    </soap:Fault>
  </soap:Body>
</soap:Envelope> 
```

**来自第二个服务器的消息**

```
The remote server returned an error: (500) Internal Server Error.
SOAP Response: 
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <soap:Body>
    <soap:Fault>
      <faultcode>soap:Client</faultcode>
      <faultstring>
        System.Web.Services.Protocols.SoapException: Fault occurred
        at BBBOnline.Application.MyService.MySoapException(XmlNode ErrorNode)
        at BBBOnline.Application.MyService.FileAComplaint(String SSN, String Buisness, String Issue, String Reason, String date)
      </faultstring>
      <faultactor>http://bbbonline.consumerservices/service.asmx?op=FileComplaint</faultactor>
      <detail>ErrorOccured..</detail>
    </soap:Fault>
  </soap:Body>
</soap:Envelope> 
```

在上面的两个消息中，FaultString 是不同的，但是两个服务器中的代码是完全一样的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:37:27.217

此问题通常是由两台服务器上的 web.config 文件的差异引起的。特别是，看看`<customErrors>`元素是否不同。

如果 web.configs 相同，请查找`machine.config`两台服务器上文件的差异。

# c# - 除非使用管理员帐户，否则 Windows 服务不会启动 OnStart

> ID：13594267
> 
> 赞同：3
> 
> 时间：2012-11-27T22:24:16.817
> 
> 标签：c#, .net, service, windows-services, privileges

该服务安装正确，但是当尝试通过`net start`或从服务窗口启动它时，它根本没有启动，甚至没有到达`OnStart`处理程序。

如果我使用管理员帐户，该服务将启动并正常工作。这似乎表明服务中的某些内容需要管理员权限，但这纯粹是一种按需样式的服务，在请求之前不会执行任何操作。对于这种类型的服务，我假设至少应该启动，然后在向它发出需要管理员权限的请求时失败？

调试是不可能的，因为我什至无法启动它，并且事件日志上除了表明服务已停止的信息日志之外什么也没有出现。服务中的代码太多，无法在此处全部添加，但入口点是相当标准的 Unity 样式服务：

```
partial class MyServiceHost : UnityServiceBase
{
    private Bootstrapper _bootstrapper;

    public MyServiceHost()
    {
        InitializeComponent();
    }

    protected override void OnStart( string[] args )
    {
        TextWriter tw = new StreamWriter( "ServiceTestLog.txt" );
        tw.Write( "Date: " + DateTime.Now + "\n" );

        try
        {
            base.OnStart( args );

            _bootstrapper = new Bootstrapper( UnityContainer );
            _bootstrapper.Run();
        }
        catch ( Exception ex )
        {
            tw.Write( ex.ToString() );
        }

        tw.Close();
    }

    protected override void OnStop()
    {
        _bootstrapper.Teardown();
        base.OnStop();
    }
} 
```

出于商业原因，我不能只使用管理员的用户帐户，所以我很感激有关如何解决此问题的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:26:48.743

确保您的用户帐户具有“作为服务登录”权限。没有它，这将无法工作，并且默认情况下它不会为用户启用，尽管它会为管理员启用。说明[在这里](http://social.technet.microsoft.com/Forums/en-US/winserverGP/thread/a6fcbe72-6f75-4bd2-bb96-440e2c8913c2)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:30:57.573

写入“ServiceTestLog.txt”可能需要本地管理员权限。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-28T14:33:12.573

运行 Visual Studio 调试器并附加到服务，您可以单步执行它并查看发生了什么。

您可以在 initializecomponent() 之前添加它，并在服务控制面板的“启动参数”文本框中为您的服务添加 WAITFORDEBUGGER。

C＃：

```
foreach (string arg in args) {
    if (arg == "WAITFORDEBUGGER") {
        while (!Debugger.IsAttached) {
            Threading.Thread.Sleep(1000);
        }
    }
} 
```

VB.Net：

```
For Each arg As String In args
   If arg = "WAITFORDEBUGGER" Then
       While Not Debugger.IsAttached
            Threading.Thread.Sleep(1000)
       End While
   End If
Next 
```

然后，该服务将等待您启动 Visual Studio 并附加调试器，此时您可以跟踪整个初始化和运行序列并查看发生了什么问题。

如果它从未遇到 WAITFORDEBUGGER 代码，则可能无法加载依赖项，在这种情况下，Sysinternals Process Monitor ( [https://technet.microsoft.com/en-us/sysinternals/bb896645](https://technet.microsoft.com/en-us/sysinternals/bb896645) ) 可以告诉您它正在处理什么。

# scheme - 麻省理工学院方案传递信息等级表

> ID：13594272
> 
> 赞同：2
> 
> 时间：2012-11-27T22:25:02.483
> 
> 标签：scheme, message, procedure

目前，作为作业的一部分，我正在尝试编写一个方案程序，该程序接受 3 条消息`'get-student-average` `'get-assignment-average`和`'add-grade`，并根据需要返回信息。`'add-grade`基本上给出了按顺序插入的学生 ID、作业和成绩。我仍在处理学生和作业的平均消息（因此在它们前面有分号），但是当我尝试运行它时一直失败的是`'add-grade`消息。它一直说成绩是一个未绑定的变量。这是我正在测试它的代码：

```
(define (make-grades)
  (define T '())
  (define (dispatch op)
    ((eq? op 'add-grade) (lambda(id as gr) (set! T (append T (list (list id as gr)
    )))))
   ;((eq? op 'get-student-average) (lambda(x) ( )))
   ;((eq? op 'get-assignment-average)
))

(define grades (make-grades))
((grades 'add-grade) 7 1 85)) 
```

我不确定我做错了什么，试图用它来取回信息。我认为，与方案中的表一样，诀窍是将列表作为列表附加到空值，然后设置它。

还有很多其他测试用例（包括一些用于`'average`消息的测试用例），但我没有包括它们，因为我觉得它只是在重复更多相同的东西。我觉得我应该提到的另一件事是所有测试用例都放在一个列表中，以 . 开头`'(`和结尾`)`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:30:54.627

您的代码有几个问题。对于初学者，您实际上并没有检查正在接收什么消息（应该有一个`cond`或一系列嵌套`if`的 s 或`case`某处）。而且您没有返回调度程序。在这里，试试这个开始：

```
(define (make-grades)
  (define T '())
  (define (dispatch op)
    (cond ((eq? op 'add-grade)
           (lambda (id as gr)
             (set! T (append T (list (list id as gr))))))
          ;((eq? op 'get-student-average) (lambda(x) ( )))
          ;((eq? op 'get-assignment-average)
          ))
  dispatch) 
```

此外，出于测试目的，您应该添加第四条消息以返回列表。

# c# - Html.ListBoxFor 不选择项

> ID：13594283
> 
> 赞同：0
> 
> 时间：2012-11-27T22:25:44.443
> 
> 标签：c#, html, asp.net-mvc

首先，我使用的是 MVC 2.0。我无法在回发到我的控制器时使用多选列表框进行选择。这是我的代码：

**模型**

```
public class TestModel
{
    public MultiSelectList AvailableTestTypes { get; set; }
    public List<TestType> SelectedTestTypes { get; set; } 
}

public class TestType
{
   public long Id { get; set; }
   public string Name { get; set; }
   public bool isActive { get; set; }
} 
```

**控制器**

```
public ActionResult Index(TestModel model)
{
    if (model == null) model = new TestModel();

    List<TestType> testList = new List<TestType>()
    {
        new TestType() { Id = 1, Name = "TESTING", isActive = true },
        new TestType() { Id = 2, Name = "TESTING2", isActive = true },
        new TestType() { Id = 3, Name = "TESTING3", isActive = true }
    };

    model.AvailableTestTypes = testList; //TODO: Fetch From Repository 
    return View(model);
}

[HttpPost]
public ActionResult PostForm(TestModel model)
{
    List<long> act = model.SelectedTestTypes != null ? model.SelectedTestTypes.Select(x => x.Id).ToList() : new List<long>(); 
```

**看法**

```
 <%= Model != null && Model.AvailableTestTypes != null ?
                                    Html.ListBoxFor(x => x.SelectedTestTypes,
                                                             new MultiSelectList(Model.AvailableTestTypes, "Id", "Name", Model.SelectedTestTypes), 
                                                             new { @id = "testListboxId", @class = "blah", @title = "title" }) : null%> 
```

在发布到控制器之后，无论我选择多少，我的选定列表计数都是 0……我在这里做错了什么？

我尝试了一些不同的解决方案，例如 [在 ListBoxFor 中选择值的挑战，](https://stackoverflow.com/questions/3194143/challenges-with-selecting-values-in-listboxfor/3195986#3195986) 但没有任何效果:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:46:23.053

您的脚本与其他脚本中的示例之间的区别在于您尝试绑定到 List，而不是 int[]。

当您要填充多选列表框时，您必须设置 DataValueField 和 DataTextfield，否则不会设置任何值。

```
model.AvailableTestTypes = new MultiSelectList(testList, "Id", "Name); 
```

然后尝试使用这个类：

```
public class TestModel
{
    public MultiSelectList AvailableTestTypes { get; set; }
    public int[] SelectedTestTypes { get; set; } 
} 
```

在您的 PostForm 操作中，您可以使用 Id 来检索 TestTypes。

# c# - 2 在不同线程中运行的控制台应用程序

> ID：13594284
> 
> 赞同：0
> 
> 时间：2012-11-27T22:25:48.600
> 
> 标签：c#, .net, console

我将如何做到这一点，以便我拥有一个带有后台进程的主程序，该进程“侦听”捕获（例如通过类似 sendDebugInfo(Exception e) 的函数），然后取消隐藏第二个控制台并显示消息，但如果用户关闭调试窗口它不会退出程序。

如果以上内容不够清楚，这里有一个简单的版本：

使用控制台应用程序 1 函数 helloWord() 控制台应用程序 1 函数 helloWorld() 将字符串发送到第二个控制台窗口（但在同一个项目中） 第二个控制台显示“hello world”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:29:55.173

您实际上是在询问进程间通信（IPC）。

有很多方法可以实现IPC。我建议你看看命名管道。它们易于使用且非常可靠。

[http://msdn.microsoft.com/en-us/library/system.io.pipes.aspx](http://msdn.microsoft.com/en-us/library/system.io.pipes.aspx)

命名管道背后的基本思想是，您有一个命名资源，您可以在一个进程中写入消息并从另一个进程中读取消息。消息可以是任何你想要的。进程只需使用预先商定的名称即可连接到管道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T23:15:00.340

只是为了澄清，说您希望两个控制台应用程序在不同的线程中运行有点误导。控制台应用程序通常完全在不同的进程上运行，并且由于进程之间不共享线程，因此两个控制台应用程序在不同的线程中运行是常态。但是，当您明确地说出这句话时，听起来您是在尝试在同一*进程*上运行它们，但是我什至不确定是否可能在不同的线程上运行它们。

也就是说，Eric J. 是对的，您似乎真的在询问可以通过多种方式执行的 IPC。命名管道是一种方式，而 TCP 环回是另一种方式。如果您希望这些应用程序在某些时候在不同的机器上运行，您将需要使用 TCP。否则命名管道更容易处理。

我建议阅读 IPC，找出适合您需求的方法并尝试使其发挥作用。当您遇到诸如“我的消息未通过”之类的特定问题时，您应该返回并搜索类似的问题或创建一个新问题。

# c++ - 在结构中搜索具有相似属性的数据

> ID：13594285
> 
> 赞同：1
> 
> 时间：2012-11-27T22:25:51.907
> 
> 标签：c++, search, loops, struct

我已经创建了一个结构并用变量填充了一个数组，这些变量可以被认为是 xyz 平面中的坐标，或者是到一个点的 3 维距离。

```
for (a=1; a<=lst; a++) {
for (b=1; b<=hst; b++) {    
        for (c=1; c<=wst; c++) {

    point[d].x=a*k+px;
    point[d].y=b*k+py;
    point[d].z=c*k+pz;
    d++;

    }
    }
} 
```

变量 px ... 作为通用 k 的一小部分的随机添加，以制作一个不那么“刚性”的立方体。我想在循环的迭代中识别在所选“点”的给定半径内的“点”，该循环的运行次数与点数一样多。但是，我想在不运行循环来检查 point[num] 数组中的每个点以查看它是否接近的情况下执行此操作。如果不进行基于 point[num] 数组中点的顺序的检查，我能做些什么来避免这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:46:05.243

我可以看到两种很好的方法来做到这一点。

1.  如果您要查找的点位于某个有序的轴向对齐网格中，那么您可以立即访问某个半径内的点。这样做的方法是获取 x、y、z 点并将其转换为其网格位置以及半径，以定义 x、y 和 z 的最小和最大网格位置。然后，您可以立即访问这些变量。

2.  如果这些点的形式不是轴向对齐并排列成网格，那么您需要将其放入一个可以快速搜索的形式中。我会建议**kd**树。从 be`O(n)`到需要一个搜索操作`O(log(n)`。它的方法是将点集沿平均值分成两半并重复，直到你有一个快速可搜索的树：

![在此处输入图像描述](../Images/bdcc0e2aab715d1b54e7858fc8e56ae6.png)

PCL（点云库）也将为您做到这一点！

这是一个链接：

[http://pointclouds.org/](http://pointclouds.org/)

还有一个关于使用 pcl 的 kd 树的教程：

[http://pointclouds.org/documentation/tutorials/kdtree_search.php#kdtree-search](http://pointclouds.org/documentation/tutorials/kdtree_search.php#kdtree-search)

事实上，它甚至向您展示了从输入点到 kd 树存储点云的半径搜索代码。在我提供的教程页面上查看*半径搜索中的邻居。*

祝你好运！

# php - 我在 wordpress 中的联系表存在未知问题

> ID：13594287
> 
> 赞同：1
> 
> 时间：2012-11-27T22:26:09.843
> 
> 标签：php, wordpress, contact-form

我开始使用 wordpress 模板，我非常卡在这个联系表格上，我似乎没有找到问题所在。我必须提到我对 php 有点陌生，但我可以很快理解。这是我用于联系页面的内容（还有其他元素，但它们不会干扰我遇到问题的代码）：

```
 <?php get_header();
$two2_option = two2_get_global_options();
global $post; setup_postdata($post); ?>

<?php if($two2_option['two2_contact_email']){ ?>
        <form method="post" id="ajax_form" action="#">
        <fieldset>
          <ul class="form-item" id="field-name">
            <li>
              <label><?php _e("Name","jbirdie"); ?>:<span class="field-required" title="<?php _e("Required Field","jbirdie"); ?>">*</span></label>
              <input type="text" maxlength="90" name="name" id="name" placeholder="<?php _e("name","jbirdie"); ?>" size="30" class="form-field required text_input clear" />
            </li>
            <li>
              <label><?php _e("E-mail","jbirdie"); ?>:<span class="field-required" title="<?php _e("Required Field","jbirdie"); ?>">*</span></label>
              <input type="email" maxlength="90" name="email" id="email" placeholder="<?php _e("e-mail","jbirdie"); ?>" size="30" class="form-field required email text_input clear" />
            </li>
            <li>
              <label><?php _e("Phone","jbirdie"); ?></label>
              <input type="number" maxlength="90" name="phone" id="phone" placeholder="<?php _e("phone number","jbirdie"); ?>" size="30" class="form-field required email text_input clear" />
            </li>
            <li class="message">
              <label><?php _e("Comments","jbirdie"); ?> <span>Available for quotation</span></label>
              <textarea cols="55" rows="" name="message" id="message" placeholder="<?php _e("Comments","jbirdie"); ?>"  class="form-textarea text_area clear" ></textarea>
            </li>
          </ul>
          <input type="submit" name="submit" id="submit" value="send" class="submit form-submit" />
          <div id="result"></div>
        </fieldset>
     </form>
         </div>
        <?php } ?>
    </div>
    <?php } ?>
</div>

</div>

<?php get_footer(); ?> 
```

**以及 functions.php 中的以下内容：**

```
add_action('wp_ajax_nopriv_two2_send_contact_form', 'two2_send_contact_form');
add_action('wp_ajax_two2_send_contact_form', 'two2_send_contact_form');

function two2_send_contact_form(){
    $two2_option = two2_get_global_options();
    $name = $_POST['name'];
    $email = $_POST['email'];
    $phone = $_POST['phone'];
    $message = $_POST['message'];

    $subject = "Message from your portfolio";
    $body = "From $name, \n\n$email, \n\n$phone, \n\n$message";

    $to = $two2_option['two2_contact_email'];

    $result = mail($to, $subject, $body);

    if($result){ 
        print "<h3>".__("Success","two2")."</h3><p>".__("Your email has been sent!","two2")."</p>"; 
    } else {  
        print "<h3>".__("Error","two2")."</h3><p>".__("Try it again later, please.","two2")."</p>"; 
    }

    die();
} 
```

...而且它根本不起作用...有人可以给我一个提示或某事来找到错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T11:48:02.343

您是否有将表单提交给 ajax 处理程序的脚本？例如

```
<script type="text/javascript" >
  jQuery(document).ready(function($) {
     $('#ajax_form').submit(function(evt){
       var form_data = {
        action: 'two2_send_contact_form',
        name: jQuery('#name').val(),
        email: jQuery('#email').val(),
        phone: jQuery('#phone').val(),
        message: jQuery('#message').val()
      };
      $.post('<?php echo admin_url('admin-ajax.php'); ?>', form_data, function(response) {
        console.log(response);
      });
      return false;
    });
  });
</script> 
```

[http://codex.wordpress.org/AJAX_in_Plugins](http://codex.wordpress.org/AJAX_in_Plugins)

您的联系表格中还有一个额外的 php 右括号`<?php } ?>`。

**编辑** 更正了 jQuery 选择器和 ajax url。

# c++ - qt。如何按位置获取图形项（x & y 值）

> ID：13594288
> 
> 赞同：0
> 
> 时间：2012-11-27T22:26:13.827
> 
> 标签：c++, qt, qt-creator, qgraphicsitem, qgraphicsscene

我在 qt creator 的图形视图上画了一些矩形。现在我想得到一个矩形来改变它的颜色和它的已知位置。可能吗？我不想使用 for 循环来检查每个矩形的位置。有没有简单的方法？谢谢在先！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:50:35.103

[QGraphicsScene::itemAt()](http://qt-project.org/doc/qt-4.8/qgraphicsscene.html#itemAt)将返回给定位置的项目。

# ruby - DateTime 序列化和反序列化

> ID：13594289
> 
> 赞同：4
> 
> 时间：2012-11-27T22:26:23.350
> 
> 标签：ruby, datetime, serialization

我想将 Ruby DateTime 对象序列化为 json。不幸的是，我的方法不是对称的：

```
require 'date'
date = DateTime.now
DateTime.parse(date.to_s) == date
 => false 
```

我可以使用一些任意的 strftime/parse 字符串组合，但我相信必须有更好的方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-06-28T15:01:31.480

不幸的是，接受的答案不是一个好的解决方案。与往常一样，marshal/unmarshal 是您应该仅作为最后手段使用的工具，但在这种情况下，它可能会破坏您的应用程序。

OP 特别提到将日期序列化为 JSON。根据[RFC 7159](https://www.rfc-editor.org/rfc/rfc7159#section-8.1)：

> JSON 文本应以 UTF-8、UTF-16 或 UTF-32 编码。默认编码是 UTF-8，并且以 UTF-8 编码的 JSON 文本是可互操作的，因为它们将被最大数量的实现成功读取；有许多实现无法成功读取其他编码（例如 UTF-16 和 UTF-32）的文本。

现在让我们看看我们从 Marshal 那里得到了什么：

```
marsh = Marshal.dump(DateTime.now)
# => "\x04\bU:\rDateTime[\vi\x00i\x03\xE0\x7F%i\x02s\xC9i\x04\xF8z\xF1\"i\xFE\xB0\xB9f\f2299161"
puts marsh.encoding
# -> #<Encoding:ASCII-8BIT>

marsh.encode(Encoding::UTF_8)
# -> Encoding::UndefinedConversionError: "\xE0" from ASCII-8BIT to UTF-8 
```

除了返回一个人类不可读`Marshal.dump`的值之外，还给了我们一个无法转换为 UTF-8 的值。这意味着将其放入（有效）JSON 的唯一方法是以某种方式对其进行编码，例如 base-64。

没有必要这样做。已经有一种非常可互操作的方式来表示日期和时间：[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)。我不会讨论为什么它是 JSON（以及一般情况下）的最佳选择，但这里的答案很好地涵盖了它：[什么是“正确的”JSON 日期格式？](https://stackoverflow.com/questions/10286204/the-right-json-date-format).

从 Ruby 1.9.3 开始，DateTime 类具有分别用于解析和格式化 ISO 8601 日期的`iso8601` [类](http://ruby-doc.org/stdlib-2.3.1/libdoc/date/rdoc/DateTime.html#method-c-iso8601)和[实例方法。](http://ruby-doc.org/stdlib-2.3.1/libdoc/date/rdoc/DateTime.html#method-c-iso8601)后者需要一个参数来指定小数秒的精度（例如`3`毫秒）：

```
require "date"

date = DateTime.now
str = date.iso8601(9)
puts str
# -> 2016-06-28T09:35:58.311527000-05:00

DateTime.iso8601(str) == date
# => true 
```

请注意，如果您指定较小的精度，这可能不起作用，因为 eg`58.311`不等于`58.311527`. （纳秒）的精度`9`对我来说似乎是安全的，因为 DateTime 文档说：

> 假设小数的精度最多为纳秒。

但是，如果您正在与可能使用更高精度的系统进行互操作，则应该考虑到这一点。

最后，如果您想让 Ruby 的 JSON 库自动`iso8601`用于序列化，请覆盖`as_json`和`to_json`方法：

```
unless defined?(::JSON::JSON_LOADED) and ::JSON::JSON_LOADED
  require 'json'
end
require 'date'

class DateTime
  def as_json(*)
    iso8601(9)
  end

  def to_json(*args)
    as_json.to_json(*args)
  end
end

puts DateTime.now.to_json
# -> "2016-06-28T09:35:58.311527000-05:00" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T22:51:27.097

`to_s`方法和`to_json`方法（提供）都`require 'json'`忽略 DateTime 对象存储的纳秒`date`。好老`Marshal`提供：

```
require 'date'
date = DateTime.now
m_date = Marshal.dump(date)
p Marshal.load(m_date) == date # => true 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T22:35:29.403

这是因为`date`具有亚秒值，并且`#to_s`方法将返回以秒为单位的ISO时间格式，比较不成功。

```
1.9.3p327 :021 > date = DateTime.now
 => #<DateTime: 2012-11-28T07:32:40+09:00 ((2456259j,81160s,283019000n),+32400s,2299161j)> 
1.9.3p327 :022 > DateTime.parse(date.to_s)
 => #<DateTime: 2012-11-28T07:32:40+09:00 ((2456259j,81160s,0n),+32400s,2299161j)> 
```

所以它们实际上是不同的。

如果你不关心亚秒，就忘记比较是否成功。

或者，您可以将`DateTime#marshal_load`and`DateTime#marshal_dump`用于 1.9.3。（直到现在我才知道这个..）

它的工作原理是：

```
date1 = DateTime.now
dump  = date1.marshal_dump
date2 = DateTime.new.marshal_load(dump)
date1 == date2 # => true 
```

# java - Java 用反斜杠替换所有

> ID：13594292
> 
> 赞同：2
> 
> 时间：2012-11-27T22:26:27.823
> 
> 标签：java, escaping

对于这个简单的程序...

```
import java.lang.String;

public class test {

    public static void main(String[] argv) {

        String s = "Hello <BSLASH>";
        String sReplaced = s.replaceAll("<BSLASH>", "\\\\");

        System.out.println("s = " + s);
        System.out.println("sReplaced = " + sReplaced);

    }
} 
```

为什么 sReplaced 不等于带有 2 个反斜杠的 Hello \\ ？

```
$javac test.java
$ java test
s = Hello <BSLASH>
sReplaced = Hello \ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:29:52.343

不要`replaceAll`为此使用，请使用`replace`：

```
String sReplaced = s.replace("<BSLASH>", "\\\\"); 
```

`replaceAll`接受一个正则表达式，这在此处不是必需的（这就是`\\\\`计算结果为 的原因`\`）。

哦，你真的不需要`import java.lang.String`-`String`默认情况下导入该类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:29:22.950

由于 replaceAll 使用正则表达式，它实际上确实将四个斜杠转义为两个，然后反斜杠的转义是另一个反斜杠。

所以你的代码实际上只是 \

用两个反斜杠替换它，它应该是

```
String sReplaced = s.replaceAll("<BSLASH>", "\\\\\\\\"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:27:47.127

you should use total of 8 backslash's to get 2 backslashes. single backslash should be escaped with one backslash,backslash is a meta character is regex world, in-order to consider it as a normal character you will have to escape it againwith two backslash's.

```
 String sReplaced = s.replaceAll("<BSLASH>", "\\\\\\\\"); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-27T22:44:27.983

我也建议`replace`改用`replaceAll`. 我在这里写了一个代码来解决这个问题，并尝试解释如何在 java 字符串中使用反斜杠。

```
String bs1="\\";
String bs2="\\";
String sReplaced = s.replace("<BSLASH>", bs1.concat(bs2)); 
```

# ruby-on-rails-3 - 使用 rails 控制台测试 Rails/Rack 应用程序

> ID：13594293
> 
> 赞同：1
> 
> 时间：2012-11-27T22:26:28.387
> 
> 标签：ruby-on-rails-3, testing, rack, rails-console

我对 Rails 堆栈的简单理解是它执行以下操作（通常）

1.  输入是一个 HTTP 消息（GET、POST、PUT、DELETE、HEAD）、一个 URL、一些（可选）cookie、一个（可选）会话令牌，可能还有一些以 JSON 或 XML 格式打包的数据。
2.  这个 HTTP 消息由 Rack 处理，它可以通过一组“中间件”函数运行它，这些函数从消息中添加或删除数据，并且可以使用这些数据从程序的数据存储中添加、更改或删除数据。
3.  Rack 输出的 HTTP 消息被发送到 Rails 路由器，后者将其映射到控制器、操作和参数散列，其中包含会话信息、cookie 和其他参数。数据被分派给适当的控制器。
4.  控制器方法解析参数，并在算法上将其与数据库中的数据（通过模型）组合，可选地更改数据，然后将一组以 @ 开头的变量调度到视图模板。
5.  视图模板获取数据并将其与视图模板合并以形成具有适当格式（例如 HTML、JS、JSON、XML 等）的视图，或者它告诉调用者（通过 HTTP 返回代码）重定向到另一个网址。

我想使用 Rails 控制台对我的 Rails Web 应用程序执行的操作是

1.  使用 URL、会话 ID、cookie 和编码数据（JSON 或 XML）编写有效的 HTTP 消息。
2.  将此数据注入 Rack 接口，并在将其发送到 Rails 路由器之前检查输出的内容。
3.  然后我想将该数据发送到 Rails 路由器，看看在它进入控制器之前会出现什么。
4.  然后我想将该数据发送到控制器，看看在发送到视图模板之前会出现什么。
5.  然后我想获取该数据并通过视图模板运行它并在 STDOUT 上显示，或者让它自动打开 Web 浏览器并查看它的呈现。

是否有任何现有的 Rails 工具可以做到这一点？如果没有，谁能指出这些接口出现的 Rails 代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T01:07:11.583

您要查找的大部分内容都在 rails 的 actionpack 库中。

ActionDispatch 处理与机架、中间件和路由器的接口。该请求作为最后一个中间件到达路由器。路由器本身在 action_dispatch/routing/mapper 中被调用。因此，如果您想在请求到达路由器之前拦截请求，请在调用路由之前注入您自己的中间件。

一旦路由器映射验证它有一个有效的路由，它就会调用 railties 库中的应用程序。我相信这会让你回到动作包到 ActionController 中间件中。我不确定在到达控制器之前你想在哪里拦截，但我猜它会在那个 ActionMiddleware 类周围的某个地方。

从那里你进入行动包。你的控制器调用的渲染/重定向设置了 actionpack 中会发生什么。我不确定 AC 调用 AP 的确切位置，但您应该能够通过它筛选并找到您正在寻找的路径。

至于响应，你回到中间件。一旦 rails 将视图拼接在一起，它基本上会自行展开并返回中间件堆栈，然后再将响应发送回 Rack。

希望有帮助。

# prefuse - 在 prefuse 中创建 4 个节点和弯曲边缘的圆

> ID：13594300
> 
> 赞同：1
> 
> 时间：2012-11-27T22:26:55.483
> 
> 标签：prefuse

我正在尝试用多边形制作一个圆圈（我知道我可以使用例如形状渲染器，但我需要这样）。

圆应该由 4 个节点和 4 个弯曲的边缘组成。节点由 ShapeRenderer 渲染并像“+”一样定位，边缘由边缘渲染器弯曲它们。现在我有一个问题，边缘进入侧面的所有节点，这对于顶部和底部节点是可以的，但对于左右节点不起作用，因为它们应该进入顶部和底部的节点，所以我没有得到一个完美的圆圈，而是更多的蛋形。

有谁知道我如何改变边缘进入节点的位置或如何将这个节点旋转 90 度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T09:07:23.197

设置控制点的方法`EdgeRenderer`看起来很简单：

```
protected void getCurveControlPoints(EdgeItem eitem, Point2D[] cp, 
                double x1, double y1, double x2, double y2) 
{
    double dx = x2-x1, dy = y2-y1;      
    cp[0].setLocation(x1+2*dx/3,y1);
    cp[1].setLocation(x2-dx/8,y2-dy/8);
} 
```

可能，您必须覆盖它以设置达到您想要的曲线。

如果是这种情况，请在此处分享您的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T19:40:31.367

好的，我正在尝试一些东西并想出了以下内容：

```
 protected void getCurveControlPoints(EdgeItem eitem, Point2D[] cp, 
                    double x1, double y1, double x2, double y2) 
    {
        double dx = x2-x1, dy = y2-y1;      
//        cp[0].setLocation(x1+2*dx/3,y1);
//        cp[1].setLocation(x2-dx/8,y2-dy/8);
        cp[0].setLocation(x1+2*dx/3,y1);
        cp[1].setLocation(x2,y2-dy/3);
    } 
```

这对我有用，我不确定它是否是一个完美的圆圈，但我看不出有什么不同。我也不太明白它为什么会起作用，因为我将 2*dx/3 添加到 x1，但仅从 y2 中减去 dy/3。有人知道为什么会这样吗？

# javascript - 单击时使用 jQuery 获取 href

> ID：13594303
> 
> 赞同：0
> 
> 时间：2012-11-27T22:27:06.007
> 
> 标签：javascript, jquery

我想知道是否有机会使用 jQuery 获取 href 链接？

例如，我有这些：

```
<li><a href="head.php">Head</a></li>
<li><a href="body.php">Body</a></li>
<li><a href="settings.php">Settings</a></li> 
```

所以我用 jQuery 做了一些动画，但我必须要 preventDefault(); 所以现在点击这些`<a>`标签中的任何一个，我都会得到我喜欢的动画，就是这样。对于索引，我能够将其重定向，因为它基本上是 index.php，所以我写了以下内容：

```
$('a#logo').on('click', function() {
     setTimeout(function() {
          window.location.replace('index.php');
     }, 1100);
}); 
```

现在，因为为每个链接制作 ID 并用 jQuery 编写它是太多了……这太过分了，对吧？

那么我如何告诉 jQuery...嘿，点击指定`<a>`延迟重定向 1 秒，然后继续之前的位置（将页面重定向到指定的 href）。

我希望你们能理解我，我真的希望这是可能的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:30:52.437

```
$('a').click(function(e){
  e.preventDefault();
  var href = $(this).attr('href');  
  setTimeout(function(){
    window.location.href = href;
  }, 1100);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:30:21.347

我想你正在寻找这个：

```
$(this).attr('href'); 
```

所以：

```
$('li a').click(function(e){
  e.preventDefault();
  var href = $(this).attr('href');  
  setTimeout(function(){
    window.location.href = href;
  }, 1100);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:30:42.373

您可以动态使用

```
$(this).attr('href') 
```

得到目标。

# amazon-web-services - 通过 API 在亚马逊上购买

> ID：13594306
> 
> 赞同：7
> 
> 时间：2012-11-27T22:27:15.140
> 
> 标签：amazon-web-services, amazon, product

有谁知道是否有某种方法可以通过 API 在亚马逊上购买产品？

目前，我每天购买几种产品，每种产品都可以运送到不同的地址，每次我都必须在亚马逊上完成结帐阶段（多次点击）。

根据我的搜索（例如[Programmatically make Amazon purchase？](https://stackoverflow.com/questions/9048756/programatically-make-amazon-purchase)），似乎无法通过 API 购买产品，我理解其原因。但是，我想知道是否有其他方法可以自动化在亚马逊上订购多种产品的过程。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-06T18:54:38.493

另一种方法是使用 Selenium 自动化浏览器。当然，这需要在每次亚马逊网站更改时更新代码。

# java - KeyEvent.VK_REDO 和类似常量如何在加速器中工作？

> ID：13594308
> 
> 赞同：2
> 
> 时间：2012-11-27T22:27:20.423
> 
> 标签：java, keyevent, undo-redo, accelerator

我正在尝试在 Java 应用程序中为撤消、重做等创建菜单项加速器，以便我可以使用键盘命令访问它们。我还想让正确的键盘命令出现在正确的平台上。对于某些菜单项，例如“撤消”，它非常简单，因为它是`Cmd`/ `Ctrl`+ `Z`：

```
this.undoMenuItem.setAccelerator(KeyStroke.getKeyStroke(
                    KeyEvent.VK_Z, Toolkit.getDefaultToolkit().getMenuShortcutKeyMask())); 
```

该方法`getMenuShortcutKeyMask()`返回`Cmd`Mac 上的`Ctrl`密钥和 Windows 机器上的密钥。到目前为止，一切都很好。

但有些菜单项在不同平台上的组合键完全不同。要在 Mac OS 上重做，你需要`Cmd`+ `Shift`+ `Z`，但在 Windows 上你需要`Ctrl`+ `Y`。因此，除非您执行 if/then 语句来检查您所在的平台并将两组参数中的一组参数传递给函数，否则上述代码将不起作用。

我注意到[KeyEvent](http://docs.oracle.com/javase/7/docs/api/java/awt/event/KeyEvent.html)类中有常量，例如[`KeyEvent.REDO`](http://docs.oracle.com/javase/7/docs/api/java/awt/event/KeyEvent.html#VK_REDO). 我假设这是“重做”组合键的常量，尽管我不确定，因为没有任何文档说明它的作用。所以我尝试了以下方法：

```
this.redoMenuItem.setAccelerator(KeyStroke.getKeyStroke(
                    KeyEvent.VK_REDO, 0)); 
```

我曾希望这会导致应用适当的组合键作为加速键，但似乎没有分配加速键（即菜单项名称旁边没有任何组合键指示符）。这是正确使用，`KeyEvent.VK_UNDO`如果是，我做错了什么？

# javascript - redirect_uri is not owned by the application

> ID：13594310
> 
> 赞同：2
> 
> 时间：2012-11-27T22:27:25.310
> 
> 标签：javascript, facebook, redirect, sdk

Similar questions and answers have not solved my problem.

I have two Facebook apps. One is a test version for the other so they are nearly identical. I am having no problems on test. But on the live app I am getting "redirect_uri is not owned by the application" errors.

A case in point this apprequest.

```
FB.ui(
    { method: 'apprequests',
        message: 'Greetings! Would you be my neighbor?',
        data: 'invite_friends'
    },
    function (response) {

    }); 
```

I even manually added redirect_uri in this next snippet.

```
FB.ui(
    { method: 'apprequests',
        message: 'Greetings! Would you be my neighbor?',
        data: 'invite_friends',
        redirect_uri: location.protocol + '//' + location.host + location.pathname
    },
    function (response) {

    }); 
```

Either way I get the "redirect_uri is not owned by the application" error with the code on my live app and not my testing app.

In both apps the settings follow this pattern.

*   App Domains: subdomain.domain.com , domain.com
*   Site URL: http ://subdomain.domain.com/
*   Canvas URL: http ://subdomain.domain.com/Facebook/
*   Secure Canvas URL : https ://subdomain.domain.com/Facebook/
*   Page Tab URL: http ://subdomain.domain.com/Facebook/
*   Secure Page Tab URL: https ://subdomain.domain.com/Facebook/

We are using the FB JS SDK. That being the case the redirect_uri should be supplied by the SDK and from what I can see it uses `location.protocol + '//' + location.host + location.pathname`.

So, if the redirect_uri is supplied by the SDK and my settings are correct why would it work in one app and not the other?

Please help this has wasted over a day of my time already. I'm sure it is something stupid but I can't find it for the life of me.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T18:04:43.897

确定问题源于我们的应用代码中设置不正确的 AppID。这可能导致该应用程序被识别为我们公司生产的另一个应用程序，因此在 redirect_uri 中不匹配。

# android - 从服务中静音电话（不是主线程）

> ID：13594315
> 
> 赞同：0
> 
> 时间：2012-11-27T22:27:40.940
> 
> 标签：android

我只是在看这个例子：

[用 Java 使 Android 手机静音](https://stackoverflow.com/questions/3738724/silence-android-phone-in-java)

您可以在后台运行的服务中使电话静音，还是需要将消息传递给 Activity 以便它可以使电话静音？

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:30:24.700

Service 扩展了 Context，因此您不必使用 Activity。

这是由于 Java 的工作方式。有关继承的信息，请参见[此处。](http://docs.oracle.com/javase/tutorial/java/concepts/inheritance.html)

对于服务 API，请参见[此处。](http://developer.android.com/reference/android/app/Service.html)

# report - Simplest, Open Source Reporting Engine Recommendations

> ID：13594321
> 
> 赞同：0
> 
> 时间：2012-11-27T22:28:02.343
> 
> 标签：report, reporting

I'm currently investing Pentaho, Jaspersoft and Birt as possible reporting engines to integrate with the custom software my company develops.

I don't need ETL or OLAP style features. Rather, I want a more productive wysiwyg report designer with a simple deployment option for embedding/deploying over the web.

Are there any recommendations out there that I'm missing?

Thanks a lot.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T00:22:34.943

不是开源的，但[DBxtra](http://www.dbxtra.com/)有一个易于使用的所见即所得编辑器，用于报告和查询，并允许您使用 Web Report Widget 功能嵌入您创建的报告，唯一的缺点是：它仅在 Windows 上运行，因此取决于您要部署自定义软件的平台，它可能对您没有用处。

# php - Is there any reason a .php file would be hit by a remote postback, but an MVC action wouldn't be?

> ID：13594322
> 
> 赞同：2
> 
> 时间：2012-11-27T22:28:02.807
> 
> 标签：php, asp.net, asp.net-mvc, post, postback

I've got two scripts on a windows server, setup to receive data from a post.

One is a PHP file that works.

```
<?php   
echo "Hello! <br/> This is a Post Back script that writes to a text file!";

// retrieving information from Post Back
$accounting         = $_POST["accountingAmount"];
$accounting_txt     = "accounting: " . "$accounting" . "\n\n";
$address1           = $_POST["address1"];

// LOTS MORE FIELDS //

$address1_txt       = "address1: " . "$address1" . "\n\n";
"$recurPrice_txt" . "$referer_txt" . "$referringUrl_txt" . "$reservationId_txt" . "$responseDigest_txt" . "$start_date_txt" . "$state_txt" . "$sub_id_txt" . "$typId_txt" . "$username_txt" . "$zipcode_txt";

// write to a text file
$myFile = "postback.txt";
$fh = fopen($myFile, 'w') or die("can't open file");
$stringData = $message;
fwrite($fh, $stringData);
fclose($fh);
?> 
```

The ASP.NET MVC script is this:

```
[HttpPost]
    public ActionResult approved(FormCollection formValues)
    {           
            var context = new LSmixDbEntities();
            PaymentHistory ph = new PaymentHistory();
            StringBuilder s = new StringBuilder();
            foreach (string key in Request.Form.Keys)
            {
                s.AppendLine(key + ": " + Request.Form[key] + Environment.NewLine);
            }
            string formData = s.ToString();
    //save formData in db
    } 
```

I tested by putting vs on the server itself and breakpointing, the action doesn't even start.

Is there any reason a .php file would be hit by a remote postback, but an MVC action wouldn't be?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:37:33.273

PHP 脚本没有任何 HTTP 方法保护 - 它会在 GET 或 POST 请求中运行，而 MVC 引擎仅`approved`在响应 POST 请求时触发该方法（因为您具有该`[HttpPost]`属性）。我猜你只是用你的网络浏览器访问你的服务器（它总是会触发一个 GET 请求），而不是使用一个工具来创建一个 POST 请求。

# php - 我可以将图像的文件名保存在数据库中，但是当我刷新屏幕时它消失了 - 为什么？

> ID：13594323
> 
> 赞同：0
> 
> 时间：2012-11-27T22:28:03.830
> 
> 标签：php, image, codeigniter

我需要将图像保存到会话中：

到目前为止，这是我的代码：

模型：

```
 function ProfileImages()
   {
    parent::__construct();

    }

  function exists($username)
    {
     $this->db->select('*')->from("profileimages")->where('user', $username);
     $query = $this->db->get();

     if ($query->num_rows() > 0)
     {

        return true;
        /*
         echo "user $user exists!";
        $row = $query->row();
        echo " and his profileimage is $row->profileimage";
        */
       }

    else

        {

        return false;
        //echo "no such user as $user!";
         }

    }

function putProfileImage($username, $img)
{

    $record = array('user' => $username, 'profileimage' => $img);
    if ($this->exists($username))
    {
        $this->db->where('user', $username)->update('profileimages', $record);

    }
    else
    {
        $this->db->where('user', $username)->insert('profileimages', $record);

    }

}

function getProfileImage($username)
{

    $this->db->select('*')->from('profileimages')->where('user', $username);

    $query = $this->db->get();
      if ($query->num_rows() > 0){
    $row = $query->row();
    return $row->profileimage;
     }

     return "";
    }
} 
```

控制器：

```
function __construct()
{
// Call the parent construct
   parent::__construct();

   $this->load->model("profiles");
   $this->load->model("profileimages");
   $this->load->helper(array('form', 'url'));      

} 

function upload()
{
    $config = array(

        'allowed_types' =>'gif|jpg|jpeg|png',
        'upload_path' =>'./web-project-jb/assets/puploads/',
         'max_size' => 10000,
         'max_width' => 1024,
        'max_height' => 768);

    $this->load->library('upload', $config);
    $img = $this->session->userdata('img');
    $username = $this->session->userdata('username');
//fail show upload form
if (! $this->upload->do_upload())
{

    $error = array('error'=>$this->upload->display_errors());

    $username = $this->session->userdata('username');

    $viewData['username'] = $username;
    $viewData['profileText'] = $this->profiles->getProfileText($username);

    $this->load->view('shared/header');
    $this->load->view('homeprofile/homeprofiletitle', $viewData);
    $this->load->view('shared/nav');
    $this->load->view('homeprofile/homeprofileview', $error, $viewData, array('error' => ' ' ));
    $this->load->view('shared/footer');

    //redirect('homeprofile/index');

   }

  else
   {
    //successful upload so save to database

    $file_data = $this->upload->data();

    $img = $file_data['file_name'];

    $data['img'] = '/web-project-jb/assets/puploads/'.$file_data['file_name'];
    // you may want to delete the image from the server after saving it to db
    // check to make sure $data['full_path'] is a valid path
    // get upload_sucess.php from link above
    //$image = chunk_split( base64_encode( file_get_contents( $data['file_name'] ) ) );

    $this->img = $this->session->userdata('img');

    $this->username = $this->session->userdata('username');

    $this->profileimages->putProfileImage($username, $img);

    $data['username'] = $username;
    $data['profileimages'] = $this->profileimages->getProfileImage($username);

    $viewData['username'] = $username;
    $viewData['profileText'] = $this->profiles->getProfileText($username);

    $username = $this->session->userdata('username');

    $this->load->view('shared/header');
    $this->load->view('homeprofile/homeprofiletitle', $viewData);
    $this->load->view('shared/nav');
    $this->load->view('homeprofile/homeprofileview', $data, $viewData);
    $this->load->view('shared/footer');

    //redirect('homeprofile/index');
    }

 }

   function index()
  {

    $username = $this->session->userdata('username');

    $data['username'] = $username;
    $data['profileimages'] = $this->profileimages->getProfileImage($username);

    $viewData['username'] = $username;
    $viewData['profileText'] = $this->profiles->getProfileText($username);

    $this->load->view('shared/header');
    $this->load->view('homeprofile/homeprofiletitle', $viewData);
    $this->load->view('shared/nav');
    //$this->load->view('homeprofile/upload_form', $data);
    $this->load->view('homeprofile/homeprofileview', $data, $viewData, array('error' => ' ' ) );
    $this->load->view('shared/footer');
  }

 } 
```

看法：

```
<h3><?="Profile Image"?></h3>
 <img src="<?php if (isset($img)) echo base_url($img); ?>" 
 width='300' height='300'/>
  <?=form_open_multipart('homeprofile/upload');?>
    <input type="file" name="userfile" value=""/>
    <?=form_submit('submit', 'upload')?>
    <?=form_close();?> 
    <?php if (isset($error)) echo $error;?>
  </div> 
</div> 
```

我在想我实际上是否需要将图像作为链接保存到我的数据库中，而不是文件名？get profileimage 函数旨在将图像扔回屏幕，使其停留在那里。再次感谢您的所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:42:14.357

这条线是问题所在：

```
$this->profileimages->putProfileImage($username, $img); 
```

您正在保存`image`，但不是路径。因此，正如您所说，您需要保存实际路径：

```
$img = '/web-project-jb/assets/puploads/'.$file_data['file_name'];
...etc
$this->profileimages->putProfileImage($username, $img); 
```

希望这可以帮助您解决您遇到的问题。

**编辑**

关于`session`尝试做类似的事情：

```
$this->session->set_userdata($img); //note I've changed the name above as well. 
```

查看 codeigniter 会话类[指南](http://ellislab.com/codeigniter/user-guide/libraries/sessions.html)以获取更多参考。

# git - How to find the branch for a commitId in git?

> ID：13594324
> 
> 赞同：5
> 
> 时间：2012-11-27T22:28:06.317
> 
> 标签：git

lets say I have a commit Id "0678dd19c498ede50e7714505eb5af3a5494beef" I tried "git log" command, which prints,

```
$git log --full-history   1c57338cd62ee1a83df57d2c37ce1f3fa17bee17
commit 1c57338cd62ee1a83df57d2c37ce1f3fa17bee17
Author: blah@blah.com
Date:   Thu Feb 3 15:39:33 2011 -0800

Updated ejo syntax

commit 8fb7a6b3e44a020e4e495fd1c9a9976c8675c339
Author: blah@blah.com
Date:   Thu Feb 3 14:49:19 2011 -0800

Added a sample controller

commit 628788eb81c365a88ab435ffa62978077065f72c
Author: blah@blah.com
Date:   Wed Feb 2 11:33:41 2011 -0800

Test checkin 
```

Is there anyway to print the branch on which this commit is made?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-27T22:36:17.650

你想要的命令是

```
git branch --contains <commit> 
```

请注意，提交可能包含在多个分支中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:17:15.457

在`git log`手册页中挖掘了一下之后，我想出了这个，我认为它会起作用：

```
git log --all --pretty=oneline --source --since=yesterday 
```

这将列出自昨天以来添加的任何分支上的所有提交，以及提交所在的分支的名称。在存在合并和/或新分支的情况下，您可能会遇到一些奇怪的事情，并且您可能希望将输出传递给诸如`awk '{print $2}' | sort -u`摆脱重复项之类的东西。

# xcode - XCode Convert SQL Blob to .txt file or Read contents

> ID：13594328
> 
> 赞同：1
> 
> 时间：2012-11-27T22:28:28.833
> 
> 标签：xcode, text-files, blob

I'm working on a iOS application that access data from SQL Server through an XML service running on the server. Within this database, there's a textile BLOB field that I need to get and save in a temporary folder. I have searched high and low for a solution on the internet without any luck. I'm new to Objective-C programing and don't have all the tools as of yet. Any help on this would be greatly appreciated.

Thanks, Hamid

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:10:42.423

好的...我找到了答案。

```
NSString *myString = [[NSString alloc]initWithData:myData encoding:NSASCIIStringEncoding];
[myString writeToFile:filePath atomically:NO encoding:NSUTF8StringEncoding error:&error]; 
```

myData 是用 Blob 填充的 NSData 文件路径是沙盒保存位置。

# php - 如何将表单中的 3 个值发布到 1 中？

> ID：13594334
> 
> 赞同：0
> 
> 时间：2012-11-27T22:29:03.600
> 
> 标签：php, post, get

我有以下具有 3 个不同选择 ID 的日期选择器

```
<form id="testform" method="get" action="../Untitled-1.html">
    <select id="date-sel-dd" name="date-sel-dd">
      <option value="-1">Day</option>

      <option value="1">1st</option>
      <option value="2">2nd</option>
      <option value="3">3rd</option>
      <option value="4">4th</option>
      <option value="5">5th</option>
      <option value="6">6th</option>

      <option value="7">7th</option>
      <option value="8">8th</option>
      <option value="9">9th</option>
      <option value="10">10th</option>
      <option value="11">11th</option>
      <option value="12">12th</option>

      <option value="13">13th</option>
      <option value="14">14th</option>
      <option value="15">15th</option>
      <option value="16">16th</option>
      <option value="17">17th</option>
      <option value="18">18th</option>

      <option value="19">19th</option>
      <option value="20">20th</option>
      <option value="21">21st</option>
      <option value="22">22nd</option>
      <option value="23">23rd</option>
      <option value="24">24th</option>

      <option value="25">25th</option>
      <option value="26">26th</option>
      <option value="27">27th</option>
      <option value="28">28th</option>
      <option value="29">29th</option>
      <option value="30">30th</option>

      <option value="31">31st</option>
    </select>
    <select id="date-sel-mm" name="date-sel-mm">
      <option value="-1">Month</option>
      <option value="1">January</option>
      <option value="2">February</option>
      <option value="3">March</option>

      <option value="4">April</option>
      <option value="5">May</option>
      <option value="6">June</option>
      <option value="7">July</option>
      <option value="8">August</option>
      <option value="9">September</option>

      <option value="10">October</option>
      <option value="11">November</option>
      <option value="12">December</option>
    </select>
    <select id="date-sel" name="date-sel">
      <option value="-1">Year</option>
      <option value="2012">2012</option>
      <option value="2013">2013</option>
      <option value="2014">2014</option>
    </select>

  <input type="submit" name="submit" id="submit" value="Submit" /> 
```

我需要从这 3 个不同的选择字段中获取值，并将其与表单一起发布到一个新的命名为：'arrival'。当我提交到页面时，我希望我的 url 看起来像：

mydomain.php?arrival=date-sel-dd/date-sel-mm/date-sel

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:30:26.380

你可以使用一个数组。

全部重命名`select`为`arrival[]`.

在您的 php 页面中，您可以将该值作为数组获取。尝试：

```
print_r($_POST['arrival']); 
```

如果您想加入日期，请​​使用：

```
$date = implode('/', $_POST['arrival']);

header('Location: mydomain.php?arrival=' . $date); 
```

# asp.net-mvc-3 - 理解 MVC3 中的 Html.ActionLink(..., ..., ...) 语法

> ID：13594335
> 
> 赞同：0
> 
> 时间：2012-11-27T22:29:06.757
> 
> 标签：asp.net-mvc-3

我正在做一个关于 MVC 3 的教程，我偶然发现了助手 @Html.ActionLink(genre.Name, "Browse", new {genre =genre.Name})。

现在我明白了这些值的作用，第三个值是一个路由参数值，但这是我第一次看到这种语法，由于某种原因真的让我很烦。

我的意思是**new {genre =genre.Name}**。我开始明白“new”在对象/类型声明之前，但是，这一次它只是“new”关键字和大括号。这具体是如何处理的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:33:53.910

该语法`new { prop = val }`创建了一个**匿名类型**。它本质上与创建类的实例相同，只是您一次性声明了类和实例。有些人认为匿名类型不是静态类型的，也不是类型安全的。这不是真的。属性的类型是从它们分配的值中推断出来的。这种结构在 MVC 和 linq 中经常使用。

请注意，此语法并非特定于 MVC。您可以在任何方便的地方使用它。我在日常编码中大量使用匿名类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:33:03.633

很简单。。第一个参数就是你要显示的链接，所以`genre.Name`can 对应**Rock**。第二个参数是`action`，第三个参数是你的**Controller**类。最后一个参数是匿名对象形式的**路由值（您将永远不会再次使用的对象，MVC 引擎在这种情况下使用匿名对象）。**所以你的`action`（方法）需要一个`string`论点。

例如：“Home”是用户看到的链接（第一个参数），Home（第二个参数）是`action`你的类的（方法）`Controller`，它需要一个`string`参数。

```
class HomeController
{
  public ActionResult GenreAction(string genre)
  {

  }
} 
```

当一个请求发出时，它变成`Home/GenreAction/genre`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T22:32:10.450

这是一个名为[Anonymous Type](http://msdn.microsoft.com/en-us/library/bb397696.aspx)的 C# 语言功能，如果我没记错的话，它是在 C# 3.5 中引入的。

# mono - Mono / MonoDevelop 上的 Umbraco 4.X

> ID：13594338
> 
> 赞同：1
> 
> 时间：2012-11-27T22:29:23.900
> 
> 标签：mono, monodevelop, umbraco

我想获取最新版本的 4.X umbraco 并让它在 Mono 上运行，并且能够在 MonoDevelop 中编辑（和构建）项目。

有一个很棒的视频有人在[这里](http://topsy.com/vimeo.com/9438884)运行它，但没有说明。我能找到的只是这篇 SO 帖子引用的一篇旧的且大多过时的详细文章：[MonoDevelop 和 Umbraco](https://stackoverflow.com/questions/7141137/monodevelop-and-umbraco)

我尝试下载最新的 Umbraco 源，因为它是一个*网站*项目，不会在 MonoDevelop 上打开，所以我创建了一个新的 Web 应用程序并将 umbraco 中的所有内容复制到该项目中。然后，我将所有 umbraco 文件包含在 Web 应用程序项目中，然后添加了对 Umbraco 的 bin 文件夹中所有 DLL 的引用。这是编译的，但是当我尝试运行任何东西时到处都是错误 - 例如

```
System.InvalidOperationException
Current has already been initialized. It is not possible to re-initialize Current once it has been initialized. 
```

在我放弃并回到 Visual Studio 之前，有人可以建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T08:13:47.597

它不是开箱即用地在 Mono 上运行，但名为 Can Koluman 的社区成员实际上创建了一个可以在 Mono 上运行的版本，并且正在进一步开发它。希望有一天它能够开箱即用地支持 Mono。在此处阅读更多信息：

[http://our.umbraco.org/forum/core/general/32923-Umbraco-472-on-Linux?p=4#comment131290](http://our.umbraco.org/forum/core/general/32923-Umbraco-472-on-Linux?p=4#comment131290)

# sql - 如何在此 SQL 查询中获得每个帐户的第一个结果？

> ID：13594339
> 
> 赞同：3
> 
> 时间：2012-11-27T22:29:27.530
> 
> 标签：sql, sql-server

我正在尝试编写一个遵循此逻辑的查询：

*查找先前状态代码为 X 的帐户的以下第一个状态代码。*

所以如果我有一张桌子：

```
id    account_num    status_code
64        1               X
82        1               Y
72        2               Y
87        1               Z
91        2               X
103       2               Z 
```

结果将是：

```
id   account_num     status_code
82        1               Y
103       2               Z 
```

我已经提出了几个解决方案，但我对 SQL 并不是那么好，所以到目前为止它们都非常不优雅。我希望这里的某个人能够为我指出正确的方向。

看法：

```
SELECT account_number, id
FROM   table
WHERE  status_code = 'X' 
```

询问：

```
SELECT account_number, min(id)
FROM   table
INNER JOIN view
ON table.account_number = view.account_number
WHERE table.id > view.id 
```

在这一点上，我有我需要的 id，但我必须编写另一个使用 id 来查找 status_code 的查询。

**编辑：**为了添加一些上下文，我正在尝试查找 status_code 为 X 的呼叫。如果呼叫的 status_code 为 X，我们希望在下次尝试时以不同的方式拨打它。此查询的目的是提供一个报告，如果第一次拨号产生 X 状态代码，则该报告将显示第二次拨号的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:54:29.870

这是一个 SQL Server 解决方案。

**更新**

这个想法是为了避免 Olaf 提出的许多 NESTED LOOP 连接，因为它们大致具有 O(N * M) 复杂性，因此对您的性能非常不利。MERGED JOINS 复杂度为 O(N *Log(N) + M* Log(M))，这对于现实世界的场景要好得多。

以下查询的工作方式如下：

`RankedCTE`是一个子查询，它为每个按帐户划分的 id 分配一个行号，并按表示时间的 id 排序。所以对于这个输出下面的数据

```
SELECT 
    id, 
    account_num, 
    status_code,
    ROW_NUMBER() OVER (PARTITION BY account_num ORDER BY id DESC) AS item_rank
FROM dbo.Test 
```

将会：

```
id          account_num status_code item_rank
----------- ----------- ----------- ----------
87          1           Z           1
82          1           Y           2
64          1           X           3
103         2           Z           1
91          2           X           2
72          2           Y           3 
```

一旦我们给它们编号，我们就可以像这样加入结果：

```
WITH RankedCTE AS
(
    SELECT 
        id, 
        account_num, 
        status_code,
        ROW_NUMBER() OVER (PARTITION BY account_num ORDER BY id DESC) AS item_rank
    FROM dbo.Test
)
SELECT 
    *
FROM
    RankedCTE A
    INNER JOIN RankedCTE B ON 
            A.account_num = B.account_num
            AND A.item_rank = B.item_rank - 1 
```

这将在同一张表中为我们提供一个事件和一个先前的事件

```
id          account_num status_code item_rank   id          account_num status_code item_rank
----------- ----------- ----------- ----------- ----------- ----------- ----------- -----------
87          1           Z           1           82          1           Y           2
82          1           Y           2           64          1           X           3
103         2           Z           1           91          2           X           2
91          2           X           2           72          2           Y           3 
```

最后，我们只需要获取代码为“X”的前面事件和代码*不是*“X”的事件：

```
 WITH RankedCTE AS
    (
        SELECT 
            id, 
            account_num, 
            status_code,
            ROW_NUMBER() OVER (PARTITION BY account_num ORDER BY id DESC) AS item_rank
        FROM dbo.Test
    )
    SELECT 
        A.id, 
        A.account_num, 
        A.status_code
    FROM 
        RankedCTE A
        INNER JOIN RankedCTE B ON 
            A.account_num = B.account_num
            AND A.item_rank = B.item_rank - 1
            AND A.status_code <> 'X'
            AND B.status_code = 'X' 
```

此查询和@Olaf Dietsche 解决方案（其中一个版本）的查询计划如下。

![查询计划](../Images/e46b52ce34837db6540ce7487b2d17a5.png)

数据设置脚本

```
CREATE TABLE dbo.Test
(
    id int not null PRIMARY KEY,
    account_num int not null,
    status_code nchar(1)
)
GO

INSERT dbo.Test (id, account_num, status_code)
SELECT 64 ,       1,               'X' UNION ALL
SELECT 82 ,       1,               'Y' UNION ALL
SELECT 72 ,       2,               'Y' UNION ALL
SELECT 87 ,       1,               'Z' UNION ALL
SELECT 91 ,       2,               'X' UNION ALL
SELECT 103,       2,               'Z' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:41:38.627

[SQL Fiddle 与子选择](http://www.sqlfiddle.com/#!6/fa842/1/0)

```
select id, account_num, status_code
from mytable
where id in (select min(t1.id)
             from mytable t1
             join mytable t2 on t1.account_num = t2.account_num
                             and t1.id > t2.id
                             and t2.status_code = 'X'
             group by t1.account_num) 
```

和[SQL Fiddle with join](http://www.sqlfiddle.com/#!6/fa842/4/0)，都适用于 MS SQL Server 2012，都返回相同的结果。

```
select id, account_num, status_code
from mytable
join (select min(t1.id) as min_id
      from mytable t1
      join mytable t2 on t1.account_num = t2.account_num
                      and t1.id > t2.id
                      and t2.status_code = 'X'
      group by t1.account_num) t on id = min_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T22:51:38.230

```
SELECT MIN(ID), ACCOUNT_NUM, STATUS_CODE FROM (
    SELECT ID,  ACCOUNT_NUM, STATUS_CODE
    FROM ACCOUNT A1
    WHERE EXISTS 
       (SELECT 1 
        FROM ACCOUNT A2 
        WHERE A1.ACCOUNT_NUM = A2.ACCOUNT_NUM
         AND A2.STATUS_CODE = 'X'
         AND A2.ID < A1.ID)
    ) SUB
GROUP BY ACCOUNT_NUM 
```

这是一个[SQLFIDDLE](http://sqlfiddle.com/#!2/bf6ec0/15)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T22:52:10.200

这是在 PostgreSQL 下检查您的数据的查询：

```
SELECT t0.*
FROM so13594339 t0 JOIN
 (SELECT min(t1.id), t1.account_num
   FROM so13594339 t1, so13594339 t2
   WHERE t1.account_num = t2.account_num AND t1.id > t2.id AND t2.status_code = 'X'
   GROUP BY t1.account_num
 ) z
 ON t0.id = z.min AND t0.account_num = z.account_num; 
```

# http - cloudfoundry groovy（java）应用程序无法读取外部 url，给出 403

> ID：13594340
> 
> 赞同：0
> 
> 时间：2012-11-27T22:29:29.130
> 
> 标签：http, url, groovy, cloud-foundry

[https://groups.google.com/group/caelyf/feed/rss_v2_0_topics.xml](https://groups.google.com/group/caelyf/feed/rss_v2_0_topics.xml)在浏览器窗口中正确返回 xml 流；

在 cloudfoundry 应用程序中使用 groovy，这会因 http 403 权限失败而失败，例如：

```
def url = "https://groups.google.com/group/caelyf/feed/rss_v2_0_topics.xml:443".toURL()
def tx = url.getText('UTF-8') 
```

cloudfoundry 论坛暗示只有 https 加端口 443 可以读取外部 url

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:56:40.827

不知道为什么你停留`:443`在网址的末尾？

403 表示禁止。我猜谷歌不会让你用 java 抓取组网站。

您可以尝试将用户代理设置为浏览器的用户代理吗？

```
def tx = url.openConnection().with {
  setRequestProperty("User-Agent", "Firefox/2.0.0.4")
  inputStream.with {
    def ret = getText( 'UTF-8' )
    close()
    ret
  }
} 
```

或类似的...

我不认为这是一个云铸造问题。您是否尝试过从您的机器上运行上述内容来确认这一点？

## 编辑：

刚刚尝试过，它可以工作（至少在我的机器上）。这显示了如何将 XMl 加载到解析器中，并从提要中打印标题：

```
URL url = "https://groups.google.com/group/caelyf/feed/rss_v2_0_topics.xml".toURL()

def tx = new XmlSlurper().with { x ->
  url.openConnection().with {
    // Pretend to be an old Firefox version
    setRequestProperty("User-Agent", "Firefox/2.0.0.4")
    // Get a reader
    inputStream.withReader( 'UTF-8' ) {
      // and parse it with the XmlSlurper
      parse( it )
    }
  }
}

// Print all the titles
tx.channel.item.title.each { println it } 
```

# git - 强制 Git 在合并期间始终选择较新的版本？

> ID：13594344
> 
> 赞同：110
> 
> 时间：2012-11-27T22:29:42.620
> 
> 标签：git, merge, conflict

假设我`merge`git 并且存在合并冲突。

我的问题是：如何强制 git 始终选择冲突代码的较新版本，这样我就不需要手动解决冲突？

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2012-11-27T22:34:32.747

它不完全是“较新”的版本，但你可以告诉 git 总是使用当前分支上的版本`git merge branch -X ours`，或者更喜欢正在合并的分支的版本，使用`git merge branch -X theirs`.

来自`man git-merge`：

> **我们的：**
> 
> 此选项通过支持我们的版本来强制冲突的大块头被干净地自动解决。与我们这边不冲突的另一棵树的更改会反映到合并结果中。对于二进制文件，整个内容都是从我们这边获取的。
> 
> **他们的：**
> 
> 这与“我们的”相反。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-08-10T05:40:03.317

我用这个，

```
git fetch --prune
git reset --hard origin/master 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-08-08T21:44:06.517

看看我在[基于 Git 时间戳的自动同步中的回答](https://stackoverflow.com/questions/68604789/git-timestamp-based-automated-sync?noredirect=1&lq=1)

本质上，我们必须进行手动时间戳比较。我不认为`git merge`有任何内置的实用程序。

# c# - 向应用程序用户发送通知/请求（Facebook - C#）

> ID：13594345
> 
> 赞同：2
> 
> 时间：2012-11-27T22:29:47.820
> 
> 标签：c#, facebook, facebook-requests

标题可能无法描述我真正想要的内容，但我希望这不是一个重复的问题，因为我在搜索中找不到相关答案。

我正在为我自己的魔兽世界公会开发一个 Facebook 团队管理器应用程序，我想要它做的是：

*   当军官创建突袭时，向所有应用程序用户发送通知（或应用程序请求），无论他们是否是该军官的朋友。
*   这个请求可以是用户对用户或应用对用户的请求，唯一重要的是它必须在 Facebook 端触发通知。

同样，需要明确的是，我并不是要向非应用程序用户发送应用程序请求。我只想要一种向由用户事件触发的应用程序用户发送请求的方法。

应用程序已经拥有“Facebook 群组”授权，这意味着所有应用程序用户都是特定 Facebook 群组（而不是页面）的成员。

这可以通过 Facebook 对话实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T22:19:14.950

下面是一些使用 C# SDK 发送应用请求的粗略代码：

```
private string getAppAccessToken()
{
    string facebookAppId = ConfigurationProvider.GetSetting("FacebookAppId");
    string facebookAppSecret = ConfigurationProvider.GetSetting("FacebookAppSecret");
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(
        String.Format("https://graph.facebook.com/oauth/access_token?grant_type=client_credentials&client_id={0}&client_secret={1}",
        facebookAppId, facebookAppSecret));
    HttpWebResponse response = (HttpWebResponse)request.GetResponse();
    var responseStream = new StreamReader(response.GetResponseStream());
    var responseString = responseStream.ReadToEnd();

    if (responseString.Contains("access_token="))
    {
        return responseString.Replace("access_token=", string.Empty);
    }

    return "";
}

private void postRequest(string id, string message)
{
    FacebookClient app = new FacebookClient(this.getAppAccessToken());
    dynamic parameters = new ExpandoObject();
    parameters.message = message;
    parameters.title = "Please use our app";
    dynamic myId = app.Post(id + "/apprequests", parameters);
} 
```

通知应出现在 App Center / Requests 下。

希望这可以帮助。

# objective-c - Xcode 在视图控制器之间传递数据？

> ID：13594352
> 
> 赞同：-1
> 
> 时间：2012-11-27T22:30:23.203
> 
> 标签：objective-c, xcode, avaudioplayer

> **可能的重复：**
> [在视图控制器之间传递数据](https://stackoverflow.com/questions/5210535/passing-data-between-view-controllers)

我对 Xcode 有一个奇怪的问题，我无法理解。

```
@interface MenuViewController : UIViewController{
    AVAudioPlayer *audioPlayer;
} 
```

这是我在一个视图中实现的，在另一个视图中我尝试使用该音频播放器但它不起作用。是的，我已经在我的另一个视图中导入了这个视图控制器。任何人都可以帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:51:53.817

这是 OOP 的一个特性。根据您想要做的事情，您需要做两件事之一。要么在两个地方实例化对象，要么在一个地方实例化它并将它传递给另一个地方。如果你想通过它，你可以使用类似[NSNotification](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNotification_Class/Reference/Reference.html)的东西。在将使用共享 audioPlayer 的类中，您可以执行以下操作：

```
- (id)init
{
  self = [super init];
  if (self) {
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(incomingAudioPlayer:)
                                                 name:@"ShareAudioPlayer" 
                                               object:nil];
  }
  return self;
}

- (void)incomingAudioPlayer:(NSNotification *)notification {
  // do stuff here
} 
```

在您实例化 audioPlayer 的类中（就在实例化之后），您可以执行以下操作：

```
[[NSNotificationCenter defaultCenter] postNotificationName:@"ShareAudioPlayer" 
                                                            object:self
                                                          userInfo:audioPlayer]; 
```

实际上，您可能必须使用 userInfo 并将 audioPlayer 粘贴在 NSDictionary 或其他东西中，但这应该让您更接近。这是我通常使用的方法，可能还有其他方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T22:37:23.320

您应该使用属性而不是实例变量来访问`AVAudioPlayer`其他类：

```
@interface MenuViewController : UIViewController {
}

@property (retain) AVAudioPlayer* audioPlayer; 
```

在另一个视图控制器中，您可以`audioPlayer`使用

```
[myMenuViewController audioPlayer] 
```

# javascript - jQuery + Javascript - 在匿名函数中访问对象字段

> ID：13594356
> 
> 赞同：1
> 
> 时间：2012-11-27T22:30:24.417
> 
> 标签：javascript, jquery, this

我不喜欢 JavaScript OOP，所以我创建了一个包含一些字段的对象，其中包含一些要调用的函数。

```
var test = {
    questions: [],

    addQuestion: function(questionTitle, possibleAnwsers)
    {
        // not really important
    },

    appendQuestionToHTML: function(question)
    {
        // not really important
    },

    makeQuestionFieldsEditable: function($questionNode)
    {
        $questionNode.find(".questionTitle").first(function(){this.changeTextOnClick($(this));});
        $questionNode.find(".questionChoice").each(function(){this.changeTextOnClick($(this));});
    },

    changeTextOnClick: function($spanElement)
    {
        // not really important
    }
}; 
```

makeQuestionFieldsEditable() 函数中的以下对象查找“.questionTitle”类节点，所有“.questionChoice”类节点为它们调用另一个函数。问题是在匿名函数引用中使用它本身，而不是保存在字段 changeTextOnClick 上的函数。Javascript/JQuery 想要在不存在的 HTMLDivElement 上调用此函数。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:39:58.827

您可以使用对`this`变量的引用来解决问题：

```
makeQuestionFieldsEditable: function($questionNode)
{
    var that = this;
    $questionNode.find(".questionTitle").first(function(){that.changeTextOnClick($(this));});
    $questionNode.find(".questionChoice").each(function(){that.changeTextOnClick($(this));});
}, 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:39:11.730

我认为您需要做的就是将“this”更改为“test”（您已将此对象分配给的变量）。

# ruby - `<<': 哈希中的无效日期 (ArgumentError)

> ID：13594359
> 
> 赞同：0
> 
> 时间：2012-11-27T22:30:46.233
> 
> 标签：ruby

这是我的代码：

```
item = []
today = Date.today

dates = {"3 years" => today << 12*3, "2 years" => today << 12*2,
"1.5 years" => today <<  12*1.5,"1 year" => today << 12, "6 months" => today << 6,
"3 months" => today << 3, "today" => today} 
```

每次运行它时，我都会``<<': invalid date (ArgumentError)`在开始的行上收到此错误。`dates...`

怎么了？`today`应该是一个有效的日期，我尝试在乘法和值字段周围加上括号，但仍然是那个错误。当我在 irb 中尝试时，效果很好。文件顶部需要日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:04:35.800

```
"1.5 years" => today <<  12*1.5 
```

这个是罪魁祸首。将其替换为`"1.5 years" => today << 18`，因为该`<<`方法显然无法处理浮点数（在 1.9.3 中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:18:47.013

你忘了`require 'date'`吗？

似乎在所有版本上都运行良好。

### [这是一个证明](http://cibox.org/slivu/stackoverflow?lang=ruby&file=invalid-date-argumenterror-in-hash.rb&versions=%2a&run=true)

# matlab - 两个连接边界的形态分离

> ID：13594367
> 
> 赞同：7
> 
> 时间：2012-11-27T22:31:04.547
> 
> 标签：matlab, octave, morphological-analysis, mathematical-morphology

我有一个关于以下场景的问题。当我对图像进行后处理时，我得到了一个轮廓，不幸的是，正如你在底线看到的那样，它连接了两次。为了清楚起见，我想要的只是外线。因此我放大并标记了这条线，我想要大图像。

![](../Images/6a9ce63ae81ac71d7c9f61fff949d234.png)

我从这个选择中想要的只是外部部分，我在下一张图片中将其标记为绿色。对不起我的绘画技巧不好。;) ![](../Images/619dcfad63ed4fc1737dc00474348fdd.png)

我正在使用带有 IPT 的 MatLab。所以我也尝试使用`bwmorph`and`hbreak`选项，但它抛出了一个错误。

我该如何解决这个问题？如果你成功了，你能告诉我更多关于它的信息吗？先感谢您！

真挚地

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T18:26:43.433

您的输入图像似乎与您发布的图像有点不同，因为我无法直接收集分支点（它们太多了）。因此，要开始处理您的问题，我考虑先进行细化，然后进行分支点检测。我还扩大了它们并从细化图像中删除，这保证了初始图像中不同段之间实际上没有连接（4 或 8）。

```
f = im2bw(imread('http://i.imgur.com/yeFyF.png'), 0);
g = bwmorph(f, 'thin', 'Inf');
h = g & ~bwmorph(bwmorph(g, 'branchpoints'), 'dilate'); 
```

由于`h`持有断开的段，以下操作收集所有段的端点：

```
u = bwmorph(h, 'endpoints'); 
```

现在要实际解决您的问题，我对您要丢弃的内容进行了一些快速分析。考虑两个不同的段，`a`并且`b`，在 中`h`。我们说`a`和`b`如果一个端点包含在另一个端点中，则重叠。包含我的意思是，如果一个的起始 x 点小于或等于另一个，并且结束 x 点也大于或等于。在您的情况下，“山”与您要删除的部分重叠。要确定您删除的每一个，请考虑它们的区域。但是，由于这些是段，因此面积是一个没有意义的术语。为了解决这个问题，我连接了一个段的端点，并将内部点用作区域。您可以清楚地注意到，底部重叠部分的面积非常小，所以我们说它基本上是一条线并丢弃它，同时保留“山”部分。要执行此步骤，图像`u`至关重要，因为有了它，您可以清楚地指示从哪里开始和停止跟踪轮廓。如果您按`h`原样使用图像，您将难以确定从哪里开始和停止收集轮廓点（即，光栅顺序会给您不正确的重叠指示）。

要将段重建为单个段（目前您有三个），请考虑您从`g`中丢弃的点`h`，并使用不属于现在删除的底部段的点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T01:31:10.293

我也会用`bwmorph`

```
%# find the branch point
branchImg = bwmorph(img,'branchpoints');

%# grow the pixel to 3x3
branchImg = imdilate(branchImg,ones(3));

%# hide the branch point
noBranchImg = img & ~branchImg;

%# label the three lines
lblImg = bwlabel(noBranchImg);

%# in the original image, mask label #3
%# note that it may not always be #3 that you want to mask
finalImg = img;
finalImg(lblImg==3) = 0;

%# show the result
imshow(finalImg) 
```

# ubuntu - 用于 Ubuntu 中 C 代码和笔记本电脑摄像头使用的 openCV 库

> ID：13594370
> 
> 赞同：0
> 
> 时间：2012-11-27T22:31:18.240
> 
> 标签：ubuntu, opencv, camera

我正在尝试使用 openCV 从安装在我的笔记本电脑（运行 Ubuntu 11.04）的相机中获取图像，但我有一些问题/问题：

1.  我检查了一些代码示例使用以下包括：

    #包括“cv.h”

    #include “highgui.h”

    但是一旦我编译了代码，就会因为这些包含而给出错误。如何设置这些包/库以在我的代码中使用？我尝试按照此网站[http://www.samontab.com/web/2011/06/installing-opencv-2-2-in-ubuntu-11-04/](http://www.samontab.com/web/2011/06/installing-opencv-2-2-in-ubuntu-11-04/)进行操作，但没有成功。

2.  一旦图像被加载到对象 IplImage* 中，我如何通过套接字发送它？我有关于使用“cvSaveImage（fileName，img）”将它保存到文件中，然后打开这样的文件并发送它（我没有问题，因为我已经通过套接字发送了文件 .bmp 和 .jpg），但是我不确定这是否是最佳方法。我检查了结构 IplImage 有几个字段，但我不确定其中哪一个可以用于我的目的。

3.  如何在 openCV 中获取笔记本电脑相机的变量作为 cvCaptureFromCAM 的参数？

提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T02:52:05.980

我面临的主要问题是我正在为不同版本的 Ubuntu 安装 openCV。一旦我为适当版本的 Ubuntu 安装了正确的方法，我的问题中提到的问题就消失了，使用“0”作为我的笔记本电脑相机的索引。

# java - 正则表达式 - 树语法 Antlr Java

> ID：13594376
> 
> 赞同：1
> 
> 时间：2012-11-27T22:31:52.683
> 
> 标签：java, antlr, tree-grammar

*我正在尝试用**ANTLR** (Java) 编写一个关于简化正则表达式的程序。我已经写了一些代码（下面的**语法**文件内容）*

```
grammar Regexp_v7;
options{
    language = Java;
    output = AST;
    ASTLabelType = CommonTree;
    backtrack = true;
}

tokens{
    DOT;
    REPEAT;
    RANGE;
    NULL;
} 

fragment
    ZERO
            :    '0'
            ;

fragment
    DIGIT
            :    '1'..'9'
            ;

fragment
    EPSILON
            :    '@'
            ;

fragment
    FI
            :    '%'
            ;

    ID
            :    EPSILON
            |    FI
            |    'a'..'z'
            |    'A'..'Z'
            ;

 NUMBER
            :    ZERO
            |    DIGIT (ZERO | DIGIT)*
            ;

 WHITESPACE
            :    ('\r' | '\n' | ' ' | '\t' ) + {$channel = HIDDEN;}
            ;

list
            :    (reg_exp ';'!)*
            ;

term
            :        ID -> ID
            |    '('! reg_exp ')'!
            ;

repeat_exp
            :    term ('{' range_exp '}')+ -> ^(REPEAT term (range_exp)+)
            |    term -> term
            ;

range_exp
            :    NUMBER ',' NUMBER -> ^(RANGE NUMBER NUMBER)
            |    NUMBER (',') -> ^(RANGE NUMBER NULL)
            |    ',' NUMBER -> ^(RANGE NULL NUMBER)
            |    NUMBER -> ^(RANGE NUMBER NUMBER)
            ;
kleene_exp
            :    repeat_exp ('*'^)*
            ;
concat_exp
            :    kleene_exp (kleene_exp)+ -> ^(DOT kleene_exp (kleene_exp)+)
            |    kleene_exp -> kleene_exp
            ;

reg_exp
            :    concat_exp ('|'^ concat_exp)*
            ; 
```

*我的下一个目标是写下能够简化正则表达式的**树语法代码（例如 a|a -> a 等）。**我已经做了一些编码（见下文），但我在定义将节点视为子树的规则时遇到了麻烦（为了简化以下类型的表达式，例如：(a|a)|(a|a) to a 等。 )*

```
tree grammar Regexp_v7Walker;

options{
    language = Java;
    tokenVocab = Regexp_v7;
    ASTLabelType = CommonTree;
    output=AST;
    backtrack = true;
}

tokens{
    NULL;
}

bottomup
            : ^('*' ^('*' e=.)) -> ^('*' $e)    //a** -> a*
            | ^('|' i=.* j=.* {$i.tree.toStringTree() == $j.tree.toStringTree()} ) 
            -> $i // There are 3 errors while this line is up and running: 
                  // 1\. CommonTree cannot be resolved, 
                  // 2\. i.tree cannot be resolved or is not a field,
                  // 3\. i cannot be resolved.
; 
```

*小司机班：*

```
public class Regexp_Test_v7 {
    public static void main(String[] args) throws RecognitionException {
        CharStream stream = new ANTLRStringStream("a***;a|a;(ab)****;ab|ab;ab|aa;");
        Regexp_v7Lexer lexer = new Regexp_v7Lexer(stream);
        CommonTokenStream tokenStream = new CommonTokenStream(lexer);
        Regexp_v7Parser parser = new Regexp_v7Parser(tokenStream);
        list_return list = parser.list();
        CommonTree t = (CommonTree) list.getTree();
        System.out.println("Original tree: " + t.toStringTree());
        CommonTreeNodeStream nodes = new CommonTreeNodeStream(t);
        Regexp_v7Walker s = new Regexp_v7Walker(nodes);
        t = (CommonTree)s.downup(t);
        System.out.println("Simplified tree: " + t.toStringTree()); 
```

*谁能帮我解决这个案子？在此先感谢和问候。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T18:31:17.070

现在，我不是专家，但在你的树语法中：

1.  添加`filter=true`
2.  将规则的第二行更改`bottomup`为：
    `^('|' i=. j=. {i.toStringTree().equals(j.toStringTree()) }? ) -> $i }`

如果我没记错的话，`i=.*`你就`i`可以不存在了，你会得到一个`NullPointerException`转换为`String`.

两者`i`和`j`都是类型`CommonTree`，因为您已经这样设置它：`ASTLabelType = CommonTree`，所以您应该调用`i.toStringTree()`.

由于它是 Java 并且您正在比较字符串，因此请使用`equals()`.

此外，为了使大括号中的表达式成为谓词，您需要在结束后加一个问号。

# java - 错误的数据类型 - 泛型

> ID：13594382
> 
> 赞同：3
> 
> 时间：2012-11-27T22:32:31.230
> 
> 标签：java, generics

在下面的 Java 代码中：

```
import java.util.*;

public class TestGenericMethod {

public static <E> void ArrayToArrayList(E[] a, ArrayList<E> lst) {
    for (E e : a) lst.add(e);
}

public static void main(String[] args) {
    ArrayList<Integer> lst = new ArrayList<Integer>();
    Integer[] intArray = {55, 66};  // autobox
    ArrayToArrayList(intArray, lst);

    for (Integer i : lst) System.out.println(i);    
    String[] strArray = {"one", "two", "three"};

    //ArrayToArrayList(strArray, lst);   // Compilation Error
}
} 
```

有人可以解释一下编译器是如何知道这一行的：

```
ArrayToArrayList(strArray, lst); 
```

抛出异常？

如果该方法接受通用类型的数据，为什么它接受 Integer 数组而不接受 String 数组？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T22:35:21.027

这不会编译，因为`ArrayToArrayList`需要一个数组和一个**相同类型的数组列表 ( `E`)**：

```
public static <E> void ArrayToArrayList(E[] a, ArrayList<E> lst) { 
```

您已注释掉的示例尝试使用数组 of`String`和`ArrayList`of调用它`Integer`。

以下确实编译：

```
 String[] strArray = {"one", "two", "three"};
      ArrayList<String> strLst = new ArrayList<String>();
      ArrayToArrayList(strArray, strLst); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:34:54.820

```
public static <E> void ArrayToArrayList(E[] a, ArrayList<E> lst) 
```

在此方法中，`ArrayList`传递的类型应与您的数组类型**相同****（E）**

因此，如果您要通过`ArrayList<Integer>`，则必须通过`Integer[]`，因为您对它们都使用了相同的类型`E`。

现在在这个调用中： -

```
ArrayToArrayList(strArray, lst); 
```

your `lst`is 的类型`ArrayList<Integer>`，并且 your `strArray`is `String[]`，所以有一个`type mismatch`.

# html - 在 Kohana2 中输入图像类型

> ID：13594383
> 
> 赞同：0
> 
> 时间：2012-11-27T22:32:39.513
> 
> 标签：html, input, kohana, kohana-2

如何在 Kohana2 中使用图像类型正确输入标签？我需要在我的表单中制作一个图形提交按钮。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T09:42:33.670

这并不难，你读过文档吗？[http://docs.kohanaphp.com/helpers/form#input](http://docs.kohanaphp.com/helpers/form#input)

# python - 错误构建 NumPy：找不到 -lpython2.7

> ID：13594384
> 
> 赞同：0
> 
> 时间：2012-11-27T22:32:41.957
> 
> 标签：python, build, numpy

我需要在工作中的集群上构建 NumPy（我没有 root 访问权限）。我已经编译了我自己的 Python 2.7.3 版本（带有 --enable-shared），并且因为我没有 root 访问权限，所以 Python 位于非标准位置。不过，我在编译 NumPy 时遇到了问题。这就是我得到的：

```
gfairchild@cj-fe1 ~/code/packages/src/numpy-1.6.2> export CFLAGS="-L/usr/projects/infmodels/gfairchild/packages/lib"
gfairchild@cj-fe1 ~/code/packages/src/numpy-1.6.2> python setup.py build --fcompiler=gnu95
...
...
...
compile options: '-Inumpy/core/src/private -Inumpy/core/src -Inumpy/core -Inumpy/core/src/npymath -Inumpy/core/src/multiarray -Inumpy/core/src/umath -Inumpy/core/include -I/usr/projects/infmodels/gfairchild/packages/stow/Python-2.7.3/include/python2.7 -c'
gcc: _configtest.c
gcc -pthread _configtest.o -o _configtest
_configtest
failure.
removing: _configtest.c _configtest.o _configtest
building data_files sources
build_src: building npy-pkg config files
running build_py
copying numpy/version.py -> build/lib.linux-x86_64-2.7/numpy
copying build/src.linux-x86_64-2.7/numpy/__config__.py -> build/lib.linux-x86_64-2.7/numpy
copying build/src.linux-x86_64-2.7/numpy/distutils/__config__.py -> build/lib.linux-x86_64-2.7/numpy/distutils
running build_clib
customize UnixCCompiler
customize UnixCCompiler using build_clib
running build_ext
customize UnixCCompiler
customize UnixCCompiler using build_ext
customize Gnu95FCompiler
customize Gnu95FCompiler using build_ext
building 'numpy.linalg.lapack_lite' extension
compiling C sources
C compiler: gcc -pthread -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -L/usr/projects/infmodels/gfairchild/packages/lib -fPIC

compile options: '-DATLAS_INFO="\"3.6.0\"" -I/usr/include/atlas -Inumpy/core/include -Ibuild/src.linux-x86_64-2.7/numpy/core/include/numpy -Inumpy/core/src/private -Inumpy/core/src -Inumpy/core -Inumpy/core/src/npymath -Inumpy/core/src/multiarray -Inumpy/core/src/umath -Inumpy/core/include -I/usr/projects/infmodels/gfairchild/packages/stow/Python-2.7.3/include/python2.7 -Ibuild/src.linux-x86_64-2.7/numpy/core/src/multiarray -Ibuild/src.linux-x86_64-2.7/numpy/core/src/umath -c'
gcc: numpy/linalg/lapack_litemodule.c
gcc: numpy/linalg/python_xerbla.c
/usr/bin/gfortran -Wall -Wall -shared build/temp.linux-x86_64-2.7/numpy/linalg/lapack_litemodule.o build/temp.linux-x86_64-2.7/numpy/linalg/python_xerbla.o -L/usr/lib64/atlas -L. -Lbuild/temp.linux-x86_64-2.7 -llapack -lf77blas -lcblas -latlas -lpython2.7 -lgfortran -o build/lib.linux-x86_64-2.7/numpy/linalg/lapack_lite.so
/usr/bin/ld: cannot find -lpython2.7
collect2: ld returned 1 exit status
/usr/bin/ld: cannot find -lpython2.7collect2: ld returned 1 exit status
error: Command "/usr/bin/gfortran -Wall -Wall -shared build/temp.linux-x86_64-2.7/numpy/linalg/lapack_litemodule.o build/temp.linux-x86_64-2.7/numpy/linalg/python_xerbla.o -L/usr/lib64/atlas -L. -Lbuild/temp.linux-x86_64-2.7 -llapack -lf77blas -lcblas -latlas -lpython2.7 -lgfortran -o build/lib.linux-x86_64-2.7/numpy/linalg/lapack_lite.so" failed with exit status 1 
```

由于某种原因，它`libpython2.7.so`甚至认为它位于`CFLAGS`. 我什至将目录添加到`LD_LIBRARY_PATH`：

```
gfairchild@cj-fe1 ~/code/packages/lib> echo $LD_LIBRARY_PATH
/usr/projects/infmodels/gfairchild/packages/lib:/usr/projects/infmodels/ep_packages/db-4.3.28/lib:/usr/projects/infmodels/ep_packages/boost/lib:/usr/projects/infmodels/ep_packages/log4cpp/lib:/usr/projects/infmodels/gfairchild/packages/lib:/usr/projects/infmodels/ep_packages/db-4.3.28/lib:/usr/projects/infmodels/ep_packages/boost/lib:/usr/projects/infmodels/ep_packages/log4cpp/lib:/opt/OpenMPI/openmpi-1.4.3-gcc/lib64 
```

我该怎么做才能让它发挥作用？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:55:03.700

我刚刚修好了！查看 numpy-1.6.2 目录，我看到了一个名为`site.cfg.example`. 往里看，我看到你可以指定库和包含目录。我只是创建了一个名为的文件`site.cfg`，其内容如下：

```
[DEFAULT]
library_dirs = /usr/projects/infmodels/gfairchild/packages/lib:/usr/local/lib
include_dirs = /usr/projects/infmodels/gfairchild/packages/include:/usr/local/include 
```

这就是它完成建造所需要的一切。m01 的解决方案（添加路径`LDFLAGS`）让我更进一步，但它仍然出错。该`site.cfg`文件允许它完成构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:46:13.937

我认为您需要将`-L/some/path`选项放入`LDFLAGS`而不是`CFLAGS`. `CFLAGS`[通常] 传递给编译器，`LDFLAGS`[通常] 传递给链接器，而您正在查看链接器错误:)

顺便说一下，在这种情况下，错误出现在 Fortran 编译器错误之后。您也可以尝试提供`-L`in `FCFLAGS`（即使它不是真正的编译器，而是链接器标志..这是以防万一您真的迫切需要破解）。

# xcode - 如何在 Xcode 4 中构建屏幕保护程序？

> ID：13594389
> 
> 赞同：2
> 
> 时间：2012-11-27T22:32:50.923
> 
> 标签：xcode, macos, xcode4, osx-mountain-lion, screensaver

我正在 Xcode 中制作 OSX 屏幕保护程序（Objective-C、ScreenSaverView 类等），它在 Xcode 中正确运行。当我导航到构建输出文件夹并双击该`.saver`文件时，它会打开系统偏好设置/桌面和屏幕保护程序并询问我是否要安装它。全都正确。

但是当我通过电子邮件将`.saver`文件发送给自己并打开它时，系统偏好设置会打开，但不会打开桌面和屏幕保护程序，并且没有显示安装它的选项。我认为这可能与当我构建它时（据我所知，构建设置指定“发布”而不是“调试”），输出文件仍然在`/Users/Me/Library/Developer/Xcode/DerivedData/ScreenSaver/Build/Products/Debug/`而不是发布文件夹中。

我在这里想念什么？我在配置构建设置、编译器标志等方面经验很少。

* * *

**编辑：**

`.saver`对于它的价值，如果我将输出文件压缩为 a`.zip`并通过电子邮件发送它，它似乎可以工作。虽然不是一个很好的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T16:09:49.333

如上面评论中所述，显然它正在正确构建；电子邮件混淆了二进制文件附件，因此为了使其正常工作，应在附加之前对其进行编码（例如通过压缩它）。

# objective-c - iOS：在 ImageView 上绘制矩形并调整边框

> ID：13594391
> 
> 赞同：3
> 
> 时间：2012-11-27T22:32:54.213
> 
> 标签：objective-c, ios, core-graphics

附件[1](https://i.stack.imgur.com/Uqlmy.jpg)是来自名为 GeniusScan 的应用程序的屏幕截图，您可以在其中拍摄任何文档，并在 imageview 上显示可调整的矩形网格。您可以用手指轻松调整网格的边界，以选择要扫描的图像部分。然后它将被转换为正确的预期。

1- 如何在 imageview 上绘制网格并与之交互？

2-如何将网格的角点返回到我的视图控制器。

![在此处输入图像描述](../Images/eb989f89601b03e94df08e12fe6beff7.png)

更新：我发现了一个名为 BJImageCropper 的精彩类，它允许使用手指调整边框，但仅适用于矩形框。谁能建议如何更新它以支持 GeniusScan 应用程序中的形状？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-02T10:54:24.153

老兄：

我创建了一个演示来解决这两个问题：

1- 如何在 imageview 上绘制网格并与之交互？

通过添加 UIPanGestureRecognizer 添加 4 个将充当交互式控制点的视图，然后在视图顶部使用 CAShapeLayer 绘制网格。

2-如何将网格的角点返回到我的视图控制器。

您必须保留对网格的四个控制点的引用。

这是我的[代码](https://github.com/darioalessandro/Salami.git)的链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:37:09.530

这实际上并不是在 UIImageView 之上绘制的。它实际上是 UIImageView 之上的一个叠加层（视图）。您需要跟踪 4 个点（有 4 个视图作为图层的子视图），跟踪它们的位置，一旦移动，用于`drawRect:`根据 4 个点绘制线条。

我在我的应用程序中实现它的方式是，我用透明的“SelectionView”（我编写的自定义视图）覆盖 UIImageView。selectionView 包含 4 个“顶点”类的自定义子视图。每次用户触摸/移动顶点时，顶点都会通过协议方法与 selectionView 对话（实际上哪个顶点移动并不重要，只是它移动了）：

```
- (void)vertexMoved:(Vertex *)vertex; 
```

然后 selectionView 知道它需要重新绘制，所以它调用`setNeedsDisplay`which call 内部调用`drawRect`（你不应该调用`drawRect`），我在其中实际绘制边界矩形。基本上，遍历每个顶点并使用 Quartz API 绘制一条线，并用半透明/空心颜色填充它。

至少我是这样做的，我相信还有其他方法。

# python - 编译 pyopencl

> ID：13594392
> 
> 赞同：0
> 
> 时间：2012-11-27T22:32:57.143
> 
> 标签：python, gcc, opencl, pyopencl

我正在尝试在 virtualenv 目录中的 Ubuntu 12.10 上编译 pyopencl，但它似乎输出了一个错误：

```
gcc -pthread -fno-strict-aliasing -fwrapv -Wall -O3 -DNDEBUG -fPIC -DPYGPU_PACKAGE=pyopencl -DBOOST_PYTHON_SOURCE=1 -DPYOPENCL_USE_DEVICE_FISSION=1 -DPYGPU_PYOPENCL=1 -DBOOST_MULTI_INDEX_DISABLE_SERIALIZATION=1 -DBOOST_THREAD_BUILD_DLL=1 -Dboost=pyopenclboost -DBOOST_ALL_NO_LIB=1 -Ibpl-subset/bpl_subset -I/opencl-install-location/include -I/home/stephen/Downloads/Software/poclbm/python/local/lib/python2.7/site-packages/numpy/core/include -I/usr/include/python2.7 -c bpl-subset/bpl_subset/libs/thread/src/pthread/once.cpp -o build/temp.linux-x86_64-2.7/bpl-subset/bpl_subset/libs/thread/src/pthread/once.o
In file included from bpl-subset/bpl_subset/boost/thread/detail/platform.hpp:17:0,
                 from bpl-subset/bpl_subset/boost/thread/once.hpp:12,
                 from bpl-subset/bpl_subset/libs/thread/src/pthread/once.cpp:7:
bpl-subset/bpl_subset/boost/config/requires_threads.hpp:29:4: error: #error "Threading support unavaliable: it has been explicitly disabled with BOOST_DISABLE_THREADS"
In file included from bpl-subset/bpl_subset/boost/thread/once.hpp:12:0,
                 from bpl-subset/bpl_subset/libs/thread/src/pthread/once.cpp:7:
bpl-subset/bpl_subset/boost/thread/detail/platform.hpp:67:9: error: #error "Sorry, no boost threads are available for this platform."
In file included from bpl-subset/bpl_subset/libs/thread/src/pthread/once.cpp:7:0:
bpl-subset/bpl_subset/boost/thread/once.hpp:18:2: error: #error "Boost threads unavailable on this platform"
In file included from bpl-subset/bpl_subset/libs/thread/src/pthread/once.cpp:7:0:
bpl-subset/bpl_subset/boost/thread/once.hpp:25:42: error: variable or field ‘call_once’ declared void
bpl-subset/bpl_subset/boost/thread/once.hpp:25:34: error: ‘func’ was not declared in this scope
bpl-subset/bpl_subset/boost/thread/once.hpp:25:42: error: ‘once_flag’ was not declared in this scope
bpl-subset/bpl_subset/boost/thread/once.hpp:25:53: error: ‘flag’ was not declared in this scope
bpl-subset/bpl_subset/libs/thread/src/pthread/once.cpp:16:9: error: ‘BOOST_THREAD_DECL’ does not name a type
bpl-subset/bpl_subset/libs/thread/src/pthread/once.cpp:17:9: error: ‘BOOST_THREAD_DECL’ does not name a type
bpl-subset/bpl_subset/libs/thread/src/pthread/once.cpp:18:9: error: ‘BOOST_THREAD_DECL’ does not name a type
bpl-subset/bpl_subset/libs/thread/src/pthread/once.cpp:39:9: error: ‘uintmax_t’ in namespace ‘pyopenclboost’ does not name a type
bpl-subset/bpl_subset/libs/thread/src/pthread/once.cpp:23:28: warning: ‘pyopenclboost::detail::{anonymous}::epoch_tss_key_flag’ defined but not used [-Wunused-variable]
bpl-subset/bpl_subset/libs/thread/src/pthread/once.cpp:32:29: warning: ‘void pyopenclboost::detail::{anonymous}::create_epoch_tss_key()’ defined but not used [-Wunused-function]
error: command 'gcc' failed with exit status 1
make: *** [install] Error 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T04:55:03.960

使用 git 版本。这最近出现在邮件列表中。我会尽快发布更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-15T08:30:56.280

在网上搜索你会发现过去一年什么都没有，但是人们问如何在 ubuntu 上安装它。我不确定这是否对您有帮助，但如果您只是想将它安装到 ubuntu，请使用，

```
sudo apt-get install python-pyopencl 
```

那应该让你滚动。

# php - 自动加载和命名空间

> ID：13594396
> 
> 赞同：1
> 
> 时间：2012-11-27T22:33:07.700
> 
> 标签：php, oop, namespaces, autoload

假设我在相同的命名空间中有类：

目录 ：

> *   （文件夹）一个
>     
>     
>     *   一个.php
> *   (文件夹) b
>     
>     
>     *   b.php
>     *   c.php

我们使用命名空间，`__autoload`如您所见：在文件夹中`b\b.php`：

```
<?php          
namespace b;
use b as x;

function __autoload($clsName){
  $clsName='../'.str_replace('\\', '/', $clsName).'.php';
  require_once $clsName;
}
class b{
  function __construct(){
    print("b file<hr/>");
  }
}
$t=new x\c(); // line 13 
?> 
```

并在文件夹中`b\c.php`：

```
<?php
namespace b;

class c{
    function __construct(){
        print("c file<hr/>");
    }
}
?> 
```

当我们定义时`$t=new x\c`，`__autoload`不调用！请帮我 ：（

错误信息：

```
Fatal error: Class 'b\c' not found in C:\xampp\htdocs\project\TEST\b\b.php on line 13 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:22:49.117

您还没有定义自动加载器。PHP 查找`__autoload`（或`\__autoload`- 在全局命名空间中定义的函数），而您只定义了`\b\__autoload`（是的，函数被命名为！）

如何解决：将`__autoload`声明移到命名空间之外

更好的解决方法：你应该使用`spl_autoload_register`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:01:08.457

很难确切地看到出了什么问题。从错误的外观来看，似乎`__autoload()`没有调用该函数。如果是这样，我希望该`require_once`语句会失败，并显示找不到文件或类似的错误。

你可以尝试在你的函数中加入一些调试语句`__autoload()`来看看发生了什么，包括`var_dump`你的`$clsName`变量。

可能值得注意的是[PHP 手册中出现的有关自动加载](http://php.net/manual/en/language.oop5.autoload.php)的以下消息：

> [spl_autoload_register()](http://www.php.net/manual/en/function.spl-autoload-register.php)为自动加载类提供了更灵活的替代方案。出于这个原因，不鼓励使用[__autoload()](http://www.php.net/manual/en/function.autoload.php)并且将来可能会弃用或删除。

您还应该注意，PHP 自动加载有一个“标准”，称为[PSR-0](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md)。这是[一篇文章的链接，](http://phpmaster.com/autoloading-and-the-psr-0-standard/)它给出了很好的解释。

在上面提到的[文章](http://phpmaster.com/autoloading-and-the-psr-0-standard/)和[PSR-0 文档](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md)中，都是您可以使用的示例自动加载器。我建议使用其中之一，而不是尝试实现自己的。

# java - 聊天服务器写入已关闭的套接字

> ID：13594397
> 
> 赞同：1
> 
> 时间：2012-11-27T22:33:10.640
> 
> 标签：java, sockets

本质上，我有一个服务器类和一个客户端类，客户端创建一个套接字并将您键入的任何内容发送到服务器，该服务器被写入来自所有现有客户端的套接字向量的输出流。它运行良好，除非您关闭聊天客户端，之后发送的下一条消息会出现以下异常：

```
java.net.SocketException: Software caused connection abort: socket write error 
```

我认为发生的事情是客户端关闭的套接字要么没有关闭服务器的套接字向量中的套接字，要么即使它关闭了，它仍然保留在向量中，然后尝试写入已关闭的套接字。这听起来像可能发生的事情吗？我不明白 socket.close() 方法对它所连接的套接字做了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:37:12.527

您在客户端关闭了套接字，但在服务器端它没有关闭，这就是您收到此异常的原因。

在正常关闭中，您应该从客户端发送 CLOSE 消息，该消息将关闭服务器端的套接字。

如果客户端上的套接字已关闭，那么您必须在服务器端处理您的异常，例如通过从套接字向量中删除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:44:02.193

如果客户端关闭他的套接字，您将在服务器上读取 EOS（`read()`返回 -1、`readLine()`返回`null`、`readXXX()`抛出`EOFException`任何其他 X），或者`IOException: connection reset by peer`在写入时获得一个，可能不是在第一次写入时。如果发生上述任何一种情况，您必须关闭服务器中的套接字并以各种方式忘记该客户端。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-27T22:37:19.297

我不认为这就像连接的双方是手牵手，如果你分开他们总是会感觉到。发送前检查socket是否关闭，并捕获异常来解决这个问题。

# java - HashMap 元素的 ArrayList 到 Array

> ID：13594400
> 
> 赞同：2
> 
> 时间：2012-11-27T22:33:20.387
> 
> 标签：java, android, arrays, arraylist, hashmap

如何获得 a `ArrayList`of中的元素数组`HashMaps`？我有一个带有 url 键的 HashMap。该值是一个 url 地址。有几个`HashMaps`存储在一个`ArrayList`. 我想要的是`array`所有 url 字符串。我对找到的解决方案不满意，因为我认为可以通过`ArrayList`一些操作来提取它。

```
 // Hashmap for ListView        
    ArrayList<HashMap<String, String>> itemsList = new ArrayList<HashMap<String, String>>();

    // Creating JSON Parser instance
    JSONParser jParser = new JSONParser();
    jParser.execute(url); 

    try {
        JSONObject json = jParser.get();

        items = json.getJSONArray(TAG_ITEMS);
        //This is the solution that I want to optimize
        urls = new String[items.length()];

        // looping through All items
        for(int i = 0; i < items.length(); i++){
            JSONObject c = items.getJSONObject(i);

            // Storing each json item in variable
            String title = c.getString(TAG_TITLE);
            String description = c.getString(TAG_DESCRIPTION);
            String author = c.getString(TAG_AUTHOR);

            // Media is another JSONObject
            JSONObject m = c.getJSONObject(TAG_MEDIA);
            String url = m.getString(TAG_URL);

            // creating new HashMap
            HashMap<String, String> map = new HashMap<String, String>();

            // adding each child node to HashMap key => value
            map.put(TAG_TITLE, title);
            map.put(TAG_DESCRIPTION, description);
            map.put(TAG_AUTHOR, author);
            map.put(TAG_URL, url);

            // Solution
            urls[i] = url;

            // adding HashList to ArrayList
            itemsList.add(map);
        }
    } catch (JSONException e) {
        e.printStackTrace();
    } catch (InterruptedException e) {
        e.printStackTrace();
    } catch (ExecutionException e) {
        e.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T01:08:43.403

从我可以从您的问题中推断出，听起来您正在尝试执行以下操作

```
// Assuming previously declared and instantiated urls ArrayList with populated values in the nested HashMaps. 
ArrayList<HashMap<String, String>> urls;
// Create a new List using HashMap.values from urls.
List<String> urlList = new ArrayList<String>(urls.get(index).values()); 
```

`urls.get(index).values()`将返回指定索引处`Collection`包含的值的视图，该视图将用于实例化和填充新的.`HashMap``ArrayList``ArrayList`

如果您想获取*每个*嵌套or中的*所有*值，您可以以类似的方式执行此操作，但您需要遍历整个*`HashMaps``urls``urls ArrayList`*

 *```
for (HashMap<String, String> urlValues : urls) {
    urlList.addAll(urlValues.values());
} 
```

PS 原谅我不好的变量名！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T22:40:23.897

看起来你正在构建一张桌子。如果您可以添加 Google Guava 库，则可以使用以下内容：

```
Table<Integer, String, String> Table = HashedBasedTable.create() 
```

请参阅 JavaDoc：

[http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Table.html](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Table.html)*

# python - 可以在 sqlalchemy 中指定类而不指定 __tablename__ 吗？

> ID：13594413
> 
> 赞同：4
> 
> 时间：2012-11-27T22:34:21.217
> 
> 标签：python, sqlalchemy

我正在尝试创建一个基类，其中为方便起见指定了 id 和 url。

```
Base = declarative_base()
Base.query = session.query_property()

class CrawlableEntity(Base):
  """CrawlableEntity class for all entities crawled online.
  """
  id = Column(Integer, primary_key=True)
  url = Column(String, nullable=False)

class Model(CrawlableEntity):
  __tablename__ = 'models'
  name = Column(String)       # Bobby Raffin
  looks = relationship('Look', backref='model') 
```

我收到以下错误

```
sqlalchemy.exc.InvalidRequestError: Class <class 'CrawlableEntity'> does not have a __table__ or __tablename__ specified and does not inherit from an existing table-mapped class. 
```

这种模式在 sqlalchemy 中是否可行？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-29T07:18:28.277

请参阅[抽象具体类](https://docs.sqlalchemy.org/en/13/orm/inheritance.html#abstract-concrete-classes)：

```
class CrawlableEntity(Base):
  """CrawlableEntity class for all entities crawled online.  """
  __abstract__ = True
  id = Column(Integer, primary_key=True)
  url = Column(String, nullable=False) 
```

# java - 从 QueryDSL 生成的 bean 和查询创建模式

> ID：13594414
> 
> 赞同：0
> 
> 时间：2012-11-27T22:34:21.230
> 
> 标签：java, mysql, orm, querydsl

虽然我不是 Ruby 用户，但我真的很喜欢 ActiveRecord 在代码中定义模式的方式，并且能够生成和查询它。我知道这不能在 Java 中完全复制，但我想做一些合理的事情。

我使用 QueryDSL 文档中的以下内容使用 maven 插件从我的 SQL 数据库生成 bean 和元数据：[http ://www.querydsl.com/static/querydsl/2.9.0/reference/html/ch02s08 .html#d0e1244](http://www.querydsl.com/static/querydsl/2.9.0/reference/html/ch02s08.html#d0e1244)

```
<plugin>
  <groupId>com.mysema.querydsl</groupId>
  <artifactId>querydsl-maven-plugin</artifactId>
  <version>${querydsl.version}</version>
  <configuration>
    <jdbcDriver>com.mysql.jdbc.Driver</jdbcDriver>
    <jdbcUrl>jdbc:mysql://localhost:3306/test</jdbcUrl>         
    <packageName>com.example.schema</packageName>
    <targetFolder>${project.basedir}/src/main/scala</targetFolder>
    <exportBeans>true</exportBeans>             
  </configuration>
  <dependencies>
    <dependency>
      <groupId>mysql</groupId>
      <artifactId>mysql-connector-java</artifactId>
      <version>5.1.16</version>
    </dependency>
      <dependency>
        <groupId>com.mysema.querydsl</groupId>
        <artifactId>querydsl-scala</artifactId>
        <version>${querydsl.version}</version>
      </dependency>
  </dependencies>
</plugin> 
```

现在我已经有了所有这些 bean 和表，并定义了它们的键和外键约束，有没有办法生成 MySQL 命令来重新创建该表的模式？

如果这是不可能的，那么以相互对应的方式分发源和模式的推荐方法是什么？我是否应该只拥有一个空的 MySQL 转储并拥有相应生成 bean 的工具？或者我应该包含生成的源以及要导入 MySQL 的空模式？如果版本不同步，后一个选项似乎可能会出现问题，所以如果有人有任何其他想法，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-02T09:18:40.390

一种方法是打包生成的源代码和数据库模式的版本化 DDL/DML 文件。我们已经在一些项目中成功地使用[了 DbMaintain](http://dbmaintain.sourceforge.net/overview.html)。

无法从生成的 Querydsl 源中获取模式数据。

# magento - 弹出窗口中的 Magento 产品评论表单

> ID：13594415
> 
> 赞同：2
> 
> 时间：2012-11-27T22:34:26.970
> 
> 标签：magento, magento-1.6

我从产品页面中删除了评论表单，因为我使用了一个扩展程序，该扩展程序向客户发送了一封电子邮件，其中包含指向特定 URL 的链接以及他们购买的产品的评论表单。

但是，如果我在商店外卖了产品，我需要一个或多或少的隐藏页面（www.shop.com/productname/review）和评论表。

我使用 Magento 1.6

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T02:17:51.193

我希望你对 Magento 的内部运作有点熟悉，因为这绝对不适合初学者:)。

首先，您需要从观察`controller_front_init_router`事件开始，如下所示：

```
<global>
    <events>
        <controller_front_init_routers>
            <observers>
                <controller_noroute>
                    <type>singleton</type>
                    <class>Namespace_Module_Controller_Router</class>
                    <method>initControllerRouters</method>
                </controller_noroute>
            </observers>
        </controller_front_init_routers>
    </events>
</global> 
```

现在，如果您从事开发工作，您会注意到我在这里使用控制器作为观察者有点不合常规。对我来说，它清理了一些东西。但是，谁知道，可能有更好的方法来做到这一点？

这里是控制器。如您所见，我们有效地将路由器插入到路由器匹配列表的末尾（`default`如果您查看，就在路由器之前`Mage_Core_Controller_Varien_Front`）。

```
class Namespace_Module_Controller_Router extends Mage_Core_Controller_Varien_Router_Abstract
{
    public function initControllerRouters($observer)
    {
        /* @var $front Mage_Core_Controller_Varien_Front */
        $front = $observer->getFront();

        $front->addRouter('Namespace_Module', $this);
    }

    public function match(Zend_Controller_Request_Http $request) {
        $identifier = trim($request->getPathInfo(), '/');

        $parts = explode("/", $identifier);
        if (count($parts) > 1) {
            $productKey = $parts[0];
            $action = $parts[1];

            if (count($parts) > 2 && (count($parts)%2) == 0) {
                for ($i = 2; $i < count($parts); $i++) {
                    $request->setParam($parts[$i], $parts[$i++]);
                }
            }

            $product = Mage::getModel('catalog/product')->loadByAttribute($productKey, 'url_key');
            if ($product->getId()) {
                $request->setModuleName('your_module')
                    ->setControllerName('index')
                    ->setActionName($action);

                $request->setAlias(Mage_Core_Model_Url_Rewrite::REWRITE_REQUEST_PATH_ALIAS, $identifier);

                return true;
            } else {
                // Redirect to an error.
                return true;
            }
        }
        return false;

    }

} 
```

# android - 如何有效地从 Base64 解码 JPEG？

> ID：13594417
> 
> 赞同：1
> 
> 时间：2012-11-27T22:34:33.293
> 
> 标签：android, base64, jpeg

在我的 android 应用程序中，我从相机捕获图像，将其压缩为 jpeg，将其发送到服务器并将其保存在硬盘上。那里需要48,9kb（例如）。我将它发送回 Base64-String 并在 Android 端解码，如下所示：

```
byte[] img;
img = Base64.decode(base64, Base64.DEFAULT);
ByteArrayInputStream in = new ByteArrayInputStream(img);
BitmapFactory.Options options = new BitmapFactory.Options();
options.inSampleSize = 3;

Bitmap bmp = BitmapFactory.decodeStream(in, null, options);
return bmp; 
```

大于 3 的值

```
options.inSampleSize 
```

会使图像看起来很难看。但如果我现在看看

```
bmp 
```

它是 156kb。为什么尺寸会增加？我如何对其进行解码，以使其保持原始大小并且看起来不丑（下采样太难）？

# jquery - Fancybox 未加载

> ID：13594424
> 
> 赞同：0
> 
> 时间：2012-11-27T22:34:56.273
> 
> 标签：jquery, wordpress, fancybox

Fancybox 不适合我，但我无法弄清楚。我想我按要求做了一切。代码资料：

```
 <script src="/wp-content/themes/ase/js/jquery-1.8.2.min.js" type="text/javascript"></script>
    <script src="/wp-content/themes/ase/js/transition.js" type="text/javascript"></script>
    <script src="/wp-content/themes/ase/fancybox/jquery.mousewheel-3.0.4.pack.js" type="text/javascript"></script>
    <script src="/wp-content/themes/ase/fancybox/jquery.fancybox-1.3.4.pack.js" type="text/javascript"></script>
    <link href="/wp-content/themes/ase/fancybox/jquery.fancybox-1.3.4.css" rel="stylesheet" type="text/css" media="screen" />
    <script type="text/javascript">
        $('.fancybox').fancybox();
    </script> 
```

之后：

```
<a href="/wp-content/gallery/uber-uns/armatur-1.png" class="fancybox" rel="fancybox">/wp-content/gallery/uber-uns/armatur-1.png</a>

<a href="/wp-content/gallery/uber-uns/armatur-2.png" class="fancybox" rel="fancybox">/wp-content/gallery/uber-uns/armatur-2.png</a>

<a href="/wp-content/gallery/uber-uns/armatur-3.png" class="fancybox" rel="fancybox">/wp-content/gallery/uber-uns/armatur-3.png</a> 
```

链接是绝对的，因为它们是由 WordPress 创建的。我的错误在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:39:07.157

如果你尝试怎么办：

```
<script type="text/javascript">
 $(document).ready(function(){
  $('.fancybox').fancybox();
 });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:32:43.703

使用 Firebug 与 Firefox 或 Safari 或 IE 中的开发工具来查看您遇到的 javascript 错误。

使用 Wordpress，您需要正确地将脚本排入队列，而不是简单地将它们链接到 header.php，尤其是。用于依赖 jQuery 的 jQuery 库和其他脚本。您的主题可能已经在加载主 jQuery 库。

如果transition.js 依赖于jQuery——可能是——在functions.php 中加载它

见[http://codex.wordpress.org/Function_Reference/wp_enqueue_script](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)

作为该文档中的一个示例，它位于您主题的 functions.php 中：

```
function my_scripts_method() {
    wp_enqueue_script(
        'custom-script',
        get_template_directory_uri() . '/transition.js',
        array('jquery')
    );
}
add_action('wp_enqueue_scripts', 'my_scripts_method'); 
```

# list - 序言。列出删除元素的谓词

> ID：13594426
> 
> 赞同：1
> 
> 时间：2012-11-27T22:34:59.997
> 
> 标签：list, prolog, element, win-prolog

我试图删除“（b，10）”的“b”。我的代码是：

```
 remove(C, L1, L2).

    remove(C, [C|N], N).

    remove(C, [C|L1], [C|L2]) :- remove(C, L1, L2). 
```

“C”代表胸部。“L”代表一个位置。“N”代表一个数字。

我不确定我是否朝着正确的方向前进，或者我只是错过了一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T13:58:42.547

你需要一些修正：

```
remove(_, [], []).  % drop this if must fail when no element found
remove(C, [(C,_)|N], N) :- !.
remove(C, [A|L1], [A|L2]) :-
    remove(C, L1, L2). 
```

你必须传递一个匹配的参数

```
?- remove(c, [(a,1),(b,2),(c,3),(d,4)], L).
L = [(a,1),(b,2),(d,4)] 
```

# haml - Escape attribute value / prevent html sanitization in Haml

> ID：13594429
> 
> 赞同：1
> 
> 时间：2012-11-27T22:35:18.707
> 
> 标签：haml

Here is my Haml:

```
%a{:href => "/settings", "data-icon" => "&#9881;"} 
```

Which outputs:

```
<a data-icon='&amp;#9881;' href='/settings'>Settings</a> 
```

I want to output:

```
<a data-icon='&#9881;' href='/settings'>Settings</a> 
```

So I've tried [escaping](http://haml.info/docs/yardoc/file.REFERENCE.html#escaping_) the ampersand:

```
%a{:href => "/settings", "data-icon" => "\&#9881;"} 
```

But it seems escapes only work for the first character of a line.

I've also tried different methods of interpolation/escaping with no success:

```
"#{"&#9881;"}" 
```

Using plain html (`<a href="/settings" data-icon="&#9881">Settings</a>`) is a stopgap measure that I do not consider a solution. What if I want to set the `data-icon` programatically?

Another option is:

```
%a{:href => "#", "data-icon" => "⚙"} Settings 
```

But what if I want to use [PUA](http://en.wikipedia.org/wiki/Private_Use_%28Unicode%29#Private_Use_Areas) characters? It also makes it a lot harder to tell what the character is in the markup.

[Demo](http://codepen.io/bookcasey/pen/DkKni)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T12:32:51.867

You need to set the [`escape_attrs` option](http://haml.info/docs/yardoc/Haml/Options.html#escape_attrs-instance_method) to `false` or `:once`.

```
$ haml --no-escape-attrs
%a{:href => "/settings", "data-icon" => "&#9881;"} 
```

output:

```
<a data-icon='&#9881;' href='/settings'></a> 
```

`--no-escape-attrs` sets the `escape_attrs` option to `false` from the command line. See [the docs](http://haml.info/docs/yardoc/file.REFERENCE.html#options) for info on how to set options in other cases.

(It doesn’t look like codepen.io lets you specify Haml options, so I can’t provide a demo there).

# c# - 动态改变画布对象的图像源

> ID：13594434
> 
> 赞同：0
> 
> 时间：2012-11-27T22:35:44.960
> 
> 标签：c#, wpf

我有一个在计时器上运行的动画以及其他一些动画。我希望能够在触发事件时更改图像源文件，但我目前无法访问 element.Source（元素等于当前画布对象，即图像）。

```
public static void Clouds(Canvas canvas, int boundry)
{
    var random = new Random();
    foreach (FrameworkElement element in canvas.Children)
    {
        var elementName = Regex.Split(element.Name, "_");
        if (elementName[0] == "cloud")
        {
            if (Canvas.GetLeft(element) < canvas.ActualWidth + element.Width)
            {
                Canvas.SetLeft(element, Canvas.GetLeft(element) + 1);
            } else
            {
                // Change image source file here.
                Canvas.SetTop(element, random.Next(0 - ((int)element.Height / 2), Core.GetPercentage((int)canvas.ActualHeight, boundry)));
                Canvas.SetLeft(element, 0 - element.Width);
            }
        }
    }
} 
```

任何帮助都会很棒，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:46:35.253

这是因为 FrameworkElement 没有名为 Source 的属性，所以您必须投射或只选择您想要的图像元素。

像这样的东西可能会起作用

```
 public static void Clouds(Canvas canvas, int boundry)
        {
            var random = new Random();
            foreach (var image in canvas.Children.OfType<Image>())
            {
                if (image.Name.Contains("cloud_"))
                {
                    if (Canvas.GetLeft(image) < canvas.ActualWidth + image.Width)
                    {
                        Canvas.SetLeft(image, Canvas.GetLeft(image) + 1);
                    }
                    else
                    {
                        Canvas.SetTop(image, random.Next(0 - ((int)image.Height / 2), Core.GetPercentage((int)canvas.ActualHeight, boundry)));
                        Canvas.SetLeft(image, 0 - image.Width);
                    }
                }
            }
        } 
```

现在您将能够访问源属性，因为 var "image" 是一个 Image

# actionscript-3 - 如何调用 AS3 交换机

> ID：13594436
> 
> 赞同：0
> 
> 时间：2012-11-27T22:35:52.960
> 
> 标签：actionscript-3, switch-statement

我的 switch 语句有点挣扎（我以前从未使用过 switch）。当我的对象到达舞台的顶部或底部时，我进行了命中测试。发生这种情况时，我想切换状态（有问题的游戏是一个简单的平台游戏，允许玩家在碰到新表面时切换重力。下面是我当前的代码：

```
{
    ...

    if(player.hitTestObject(bottom)) {
        //Switch state to normal
    }
    if(player.hitTestObject(top)) {
        //Switch state to inverted
    }
}

switch (myGrav){
    case "NORMAL":
        trace("Normal")
        player.gotoAndPlay(1);
        oktoJump = false;
        player.y = 376.5;

    case "INVERTED":
        trace("Inverted")
        player.gotoAndPlay(8);
        oktoJump = false;
        player.y = 12;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:50:30.687

switch 语句中的 case 缺少`break`; 因此，代码将通过 switch 语句继续执行。

这应该是：

```
var myGrav:String = "NORMAL";

if (player.hitTestObject(bottom))
    myGrav = "NORMAL";

if (player.hitTestObject(top))
    myGrav = "INVERTED";

switch (myGrav)
{
    case "NORMAL":
        trace("Normal")
        player.gotoAndPlay(1);
        oktoJump = false;
        player.y = 376.5;
        break;

    case "INVERTED":
        trace("Inverted")
        player.gotoAndPlay(8);
        oktoJump = false;
        player.y = 12;
        break;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T14:04:51.647

当我可以摆脱它时，我更喜欢更少的变量。

```
switch (true){
    case (player.hitTestObject(bottom)):
        trace("Normal")
        player.gotoAndPlay(1);
        oktoJump = false;
        player.y = 376.5;
        break;

    case (player.hitTestObject(top)):
        trace("Inverted")
        player.gotoAndPlay(8);
        oktoJump = false;
        player.y = 12;
        break;
} 
```

# ajax - 使用 ajax 更新，未定义的索引

> ID：13594440
> 
> 赞同：0
> 
> 时间：2012-11-27T22:36:26.630
> 
> 标签：ajax, sql-update

我正在尝试为我一直在处理的投票脚本构建一个主题构建器。我正在尝试这样做，以便您可以查看预览，因此不希望页面重新加载。我对 AJAX 很陌生，如果我绕过它，一切似乎都可以工作。

问题是当我调用 php 文件来更新我的数据库时出现错误

HTML 文件：（所有的输入实际上都在 index.php 中，但为了篇幅，这里没有包含它）

```
 <div id="theme" name="theme" class="theme">
      <form class="css_form">
            <table>
               <tr>
                    <td align="left" valign="center"><label>Map Navigation Color</label></td>
                    <td align="left" valign="center"><input type="text" id="map_navigation" name="map_navigation" class="colorwell" value="#ffffff" /></td>
                </tr>    
                <tr>
                    <td align="left" valign="center"><label>Test It</label></td>
                    <td align="left" valign="center"><input type="button" value="preview" onClick="getTheme();"></td>
                </tr>
            </table>
        </form>
 </div> 
```

AJAX 文件 (theme_builder.js)

```
function getTheme(str)
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("theme").innerHTML=xmlhttp.responseText;
    }
  }

    var button_style = document.getElementById('button_style').value;
    var div_grad_1 = document.getElementById('div_grad_1').value;
    var div_grad_2 = document.getElementById('div_grad_2').value;
    var gradient_direction = document.getElementById('gradient_direction').value;
    var map_0 = document.getElementById('map_0').value;
    var map_100 = document.getElementById('map_100').value;
    var map_selected = document.getElementById('map_selected').value;
    var map_outline = document.getElementById('map_outline').value;
    var map_navigation= document.getElementById('map_navigation').value;
    var queryString =
        "button_style=" + button_style +
        "&div_grad_1=" + div_grad_1 +
        "&div_grad_2=" + div_grad_2 +
        "&gradient_direction=" + gradient_direction +
        "&map_0=" + map_0 +
        "&map_100=" + map_100 +
        "&map_selected=" + map_selected +
        "&map_outline=" + map_outline +
        "&map_navigation=" + map_navigation;

    xmlhttp.open("GET", "theme_builder.php?"+queryString, true);
    xmlhttp.send();  
} 
```

最后是 php 文件（theme_builder.php

```
<?php
    include('../../connection.php');

    $button_style = ($_GET['button_style']);
    $div_grad_1 = ($_GET['div_grad_1']);
    $div_grad_2 = ($_GET['div_grad_2']);
    $gradient_direction = ($_GET['gradient_direction']);
    $map_0 = ($_GET['map_0']);
    $map_100 = ($_GET['map_100']);
    $map_selected = ($_GET['map_selected']);
    $map_outline = ($_GET['map_outline']);
    $map_navigation = ($_GET['map_navigation']);
    $id='2';

    $update_settings = "UPDATE vs_vote_settings SET 
                        button_style = ?,
                        div_grad_1 = ?,
                        div_grad_2 = ?,
                        gradient_direction = ?,
                        map_0 = ?,
                        map_100 = ?,
                        map_selected = ?,
                        map_outline = ?,
                        map_navigation = ?
                            WHERE id=?";

    $query_update_settings = $conn->prepare($update_settings);
        if(!$query_update_settings)
            {
                die ("error" .$conn->errorInfo());
            }
    $query_update_settings->execute(array($button_style, $div_grad_1, $div_grad_2, $gradient_direction, $map_0, $map_100, $map_selected, $map_outline, $map_navigation, $id));

$conn = null;
?> 
```

我得到的错误是：

```
Notice: Undefined index: div_grad_2 in C:\Program Files (x86)\EasyPHP-12.0\www\my portable files\status201\applications\201vote\theme_builder.php on line 6

Notice: Undefined index: gradient_direction in C:\Program Files (x86)\EasyPHP-12.0\www\my portable files\status201\applications\201vote\theme_builder.php on line 7

Notice: Undefined index: map_0 in C:\Program Files (x86)\EasyPHP-12.0\www\my portable files\status201\applications\201vote\theme_builder.php on line 8

Notice: Undefined index: map_100 in C:\Program Files (x86)\EasyPHP-12.0\www\my portable files\status201\applications\201vote\theme_builder.php on line 9

Notice: Undefined index: map_selected in C:\Program Files (x86)\EasyPHP-12.0\www\my portable files\status201\applications\201vote\theme_builder.php on line 10

Notice: Undefined index: map_outline in C:\Program Files (x86)\EasyPHP-12.0\www\my portable files\status201\applications\201vote\theme_builder.php on line 11

Notice: Undefined index: map_navigation in C:\Program Files (x86)\EasyPHP-12.0\www\my portable files\status201\applications\201vote\theme_builder.php on line 12 
```

请注意， button_style 和 div_grad_1 不会引发错误，但其余的是。我找不到错误，但我认为它与我的 ajax 文件有关。[我按照Tizag](http://www.tizag.com/ajaxTutorial/ajax-mysql-database.php) For the Ajax 文件的教程进行操作，并尝试根据我的需要对其进行修改...

任何帮助将不胜感激，我知道这里有大量代码，但我已经被难住了一段时间。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:48:55.983

尝试在 theme_builder.php 中使用 isset

```
$div_grad_1 = (isset($_GET['div_grad_1'])) ? $_GET['div_grad_1'] : ""; 
```

# android - expandableList 中的空组不可选择

> ID：13594442
> 
> 赞同：1
> 
> 时间：2012-11-27T22:36:35.833
> 
> 标签：android, expandablelistview, expandablelistadapter, jquery-ui-selectable

长时间单击时，我希望 ExpandableList 中的每个组都有一个菜单。但目前只有非空组在长按时显示蓝色背景并且可以选择。所有空组都不会对长按做出反应。

我使用 registerForContextMenu(list) 将列表注册到片段并编写以下代码：

```
@Override
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    MenuInflater inflater = getActivity().getMenuInflater();
    inflater.inflate(R.menu.item_task_long_click_menu, menu);
}

@Override
public boolean onContextItemSelected( android.view.MenuItem item) {
    ExpandableListContextMenuInfo info = (ExpandableListView.ExpandableListContextMenuInfo) item.getMenuInfo();

    switch(item.getItemId()) {
        case R.id.itlcm_menu_edit:
            //do something
            break;  
        case R.id.itlcm_menu_remove:
            //do something
            break;
    }
    return true;
} 
```

在我设置的适配器中：

```
@Override
public boolean isChildSelectable(int groupPosition, int childPosition) {
    return false;
} 
```

为什么空组不可选择？还没找到改的方法...

编辑：我想这是

```
registerForContextMenu(list) 
```

也许没有任何孩子的组没有注册到长按....

有人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T09:25:38.830

我能够解决它。

问题不在于 registerForContextMenu()。问题是我的自定义 ExpandableListAdapter，其中我为 GroupViews (getGroup(...)) 使用了两个不同的视图。对任何点击都没有反应的那个包含一个 CheckBox，它覆盖了整个 GroupView 的焦点。所以我补充说：

```
android:focusable="false" 
```

对于 XML 中的 CheckBox，瞧，带有 CheckBox 的 GroupView 对点击做出了反应。

# javascript - setTimeout 中的 setInterval 不起作用...为什么？

> ID：13594443
> 
> 赞同：3
> 
> 时间：2012-11-27T22:36:37.877
> 
> 标签：javascript, settimeout, setinterval

我正在尝试根据数组上预设的一系列值来更改元素的不透明度。该操作应在用户单击按钮并且系统等待一秒钟后开始。

这是我得到的：

```
<script>
$(function() {
$("#Listening").click(function() {

    setTimeout(triggerListening, 1000);
    function triggerListening()
    {
        document.getElementById("listening").className = "listeningIn";
    }

    setTimeout(triggerUserTalking, 2000);
    function triggerUserTalking()
    {

        var audioSim = [3, 2, 7, 15, 15, 16, 15, 7, 7, 3, 8, 8, 17, 17, 20, 20, 21, 21, 17, 17, 13, 13, 12, 12, 13, 13, 16, 16, 18, 18, 17, 17, 16, 16, 14, 10, 11, 11, 15, 15, 16, 16, 15, 15, 14, 14, 13, 13, 13, 13, 15, 15, 23, 44, 55, 55, 56, 55, 44, 44, 33, 29, 31, 31, 42, 50, 60, 63, 60, 54, 39, 39, 30, 28, 30, 30, 33, 33, 36, 39, 38, 38, 33, 16, 6, 6, 5, 7, 18, 18, 28, 31, 28, 28, 26, 26, 23, 22, 23, 23, 25, 28, 28, 28, 27, 27, 28, 28, 28, 28, 28, 28, 27, 27, 28, 28, 35, 35, 43, 43, 49, 54, 56, 55, 43, 36, 26, 28, 31, 52, 65, 70, 68, 68, 51, 45, 41, 41, 38, 40, 49, 49, 57, 58, 58, 31, 42, 42, 46, 51, 55, 55, 54, 42, 33, 31, 37, 37, 45, 46, 42, 42, 37, 38, 38, 41, 41, 44, 44, 46, 48, 47, 47, 43, 44, 44, 47, 47, 49, 49, 48, 45, 44, 44, 44, 44, 45, 45, 44, 44, 43, 39, 36, 34, 35, 59, 59, 85, 93, 98, 98, 100, 95, 67, 67, 43, 36, 34, 34, 39, 51, 62, 62, 68, 76, 75, 75, 50, 36, 27, 20, 18, 36, 57, 57, 52, 48, 43, 44, 49, 50, 50, 49];

        var i = 0;

        window.setInterval('step()', 20)

        function step() {
            var element = document.getElementById("listening");
            element.style.opacity = "0." + audioSim[i];
            i++;
            if (i == audioSim.length) i = triggerStopTalking;
        }

        function triggerStopTalking()
        {
            document.getElementById("listening").className = "listeningOut";
        }

    }                   

});
});
</script> 
```

这很好用，期待不断变化的不透明度部分......

用户单击 Listening，1 秒后，通过切换“listeningIn”类，监听对象出现在屏幕上……再过一秒，该元素应根据“audioSim”中的值多次更改不透明度……但它没有不...

我已经在一个单独的 html 文件中测试了 setInterval 代码，它工作正常......所以我想我不能在 setTimeout 函数中有一个 setInterval ？帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:38:24.257

您将字符串传递给`setInverval`.
不要那样做。

`setInterval`在全局范围内`eval`输入您的字符串；`step()`是一个局部变量。因此，它什么也找不到。

相反，您需要传递函数本身：

```
setInterval(step); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T22:38:33.240

代替

```
window.setInterval('step()', 20); 
```

尝试

```
window.setInterval(step, 20); 
```

我相信文本版本将在`step`可能不存在的全球范围内进行评估。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-27T22:39:51.337

在行中：

```
> window.setInterval('step()', 20) 
```

setInterval 在全局上下文中执行，但在另一个无法访问的`step`上下文中声明。`window`将其更改为：

```
setInterval(step, 20) 
```

以便您改为传递对该函数的引用。

# sas - sas宏调用宏

> ID：13594445
> 
> 赞同：0
> 
> 时间：2012-11-27T22:36:56.703
> 
> 标签：sas, sas-macro

嗨，我有一个程序可以使用一个宏来调用另一个宏。

我有两个月（jun12 和 jul12），每个月都有两个部分（1 和 2），我想做一个循环，我构造了一个名为“Loop”的宏，在其中，我构造了一个数组，并使用了 Do comment do调用宏“尝试”。

好像行不通。有人可以帮我吗？谢谢！

```
 LIBNAME EC100006 "G:\sample";
%MACRO try(month=,part=);
      ...FROM EC100006.monthitsum&month.lag&part AS t1
%MEND try;

%Macro test;
    ARRAY Mon(2) jun12 jul12;
    %Do i=1 %to 2;
        %Do j=1 %to 2
            %try(month=Mon(i),part=j)
        %End
    %End
%Mend test;

%test 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T14:21:13.007

你不能有一个宏变量数组。

使用参数列表重复调用宏的最简单方法是使用这些参数创建数据集并从数据集中调用它，或者使用 CALL EXECUTE 或使用 PROC SQL 创建宏调用的宏列表。

```
data call;
input month $ part;
datalines;
jun12 1 
jul12 2
;;;;
run;

proc sql;
select cats('%try(month=',month,',part=',part,')') into :mcalllist 
  separated by ' ' 
  from call;
quit;

&mcalllist; 
```

这仅在您的调用少于 20,000 个字符时才有效 - 如果超过了您需要尝试不同的选项（%include 文件或调用执行）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T18:28:46.900

所以现在是这样的

```
LIBNAME EC100006 "G:\sample";
%MACRO try(month=,part=);
  ...FROM EC100006.monthitsum&month.lag&part AS t1
%MEND try;

Data Array
ARRAY Mon{2} jun12 jul12;
RUN;
%Macro test;
    %Do i=1 %to 2;
    %Do j=1 %to 2
        %try(month=Mon(i),part=j)
    %End
%End
%Mend test;

%test 
```

# batch-file - 在两个 .reg 文件之间切换

> ID：13594460
> 
> 赞同：1
> 
> 时间：2012-11-27T22:37:53.290
> 
> 标签：batch-file, errorlevel

我正在寻找一种快速简便的方法（我不需要任何错误检查）通过打开批处理文件在两个 reg 文件之间切换。

如果用户运行一个批处理文件，该批处理文件应该将 reg 文件 A 合并到注册表中。如果用户再次运行它，批处理文件应该将 reg 文件 B 合并到注册表中。如果用户再次运行它，文件 A 将被合并......你明白了。

一般来说，我认为有两种方法可以做到这一点：

1.  创建某种变量来存储接下来应该运行哪个 reg。
2.  检查注册表项值以查看最近合并的注册表（可能是首选方法）。

目前，我正在这样做：

```
REG QUERY "KeyName" /v "ValueName" | Find "x"

IF ERRORLEVEL 1 regedit /S file1.reg
IF ERRORLEVEL 0 regedit /S file2.reg 
```

REG QUERY 部分似乎有效，但在`IF ERRORLEVEL`语句中出现了问题。但也许我应该完全使用不同的方法。

希望有一些建议..提前谢谢！

**编辑**

抱歉有点含糊：我相信以前的解决方案不起作用，因为当第一个`IF`是正确的时，第二个在第一个命令`IF`之后也会太。`IF`所以我需要一个`IF ELSE`声明来防止运行第二个`IF`.

我现在想出了这个解决方案，它有效：

```
REG QUERY "KeyName" /v "ValueName" | Find "x
IF ERRORLEVEL 1 (REGEDIT /S "file1.reg") ELSE REGEDIT /S "file2.reg" 
```

我还想知道：在批处理文件中添加注册表项/值而不是使用单独的 .reg 文件是否会有所改进？值类型是 REG_BINARY 和 REG_DWORD。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:57:21.717

我会试试这个：

```
REG QUERY "KeyName" /v "ValueName" | Find "x"

IF ERRORLEVEL 1 (
  regedit /S file1.reg
  goto :EOF
)
regedit /S file2.reg 
```

当 ERRORLEVEL 等于或大于 ERRORLEVEL 编号（请参见此处： http: [//support.microsoft.com/kb/39585/en-us](http://support.microsoft.com/kb/39585/en-us)）时，IF 条件设置为 TRUE，因此第二个 IF 条件始终为评价为真。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T09:45:40.707

您可以将值存储在环境变量中

```
@Echo OFF
:: By Elektro H@cker
Set | FIND "Merged" >NUL && Regedit /S "File_B.reg" || Regedit /S "File_A.reg" && SETX Merged YES >NUL
Pause&Exit 
```

这是相同的代码，但缩进并快速解释：

```
@Echo OFF

:: By Elektro H@cker

REM If it's batfile first launch then I add a value "YES" to a variable and then only merges the File A.
REM If isn't batfile first launch then only merges FILE B

Set | FIND "Merged" >NUL && (
     Regedit /S "File_B.reg"
) || Regedit /S "File_A.reg" && (
     SETX Merged YES >NUL
)

Pause&Exit 
```

# python - Python、libxslt 和在默认命名空间中查找对象

> ID：13594461
> 
> 赞同：1
> 
> 时间：2012-11-27T22:37:53.913
> 
> 标签：python, xml, xslt, xml-namespaces, libxslt

我一直在寻找使用 python libxml2 库和 XSLT 处理 XSTL 的任何示例时遇到了麻烦。我有一组带有默认命名空间的遗留文档，我一直在尝试将它们转换为可以导入到符合 tinkerpop 的数据库中的内容。遗留数据有一个默认命名空间，我不知道如何说服 libxslt 在数据中找到任何东西。

正如您从我的示例中看到的那样，我似乎根本无法从内部模板中获取任何东西来渲染。它似乎确实找到了最顶层的 (cmap) 模板，因为它吐出了`<graphml>`样板文件。我对 XSLT 相当陌生，所以这可能只是一个缺点，但 SO 或谷歌上似乎没有人有任何这种工作的例子。

我曾考虑过使用正则表达式删除有问题的默认命名空间，但使用正则表达式解析 XML 通常是一个糟糕的计划，而且这似乎是个错误的想法。

我有以下 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
  <cmap xmlns="http://cmap.ihmc.us/xml/cmap/">
    <map width="1940" height="3701">
      <concept-list>
        <concept id="1JNW5YSZP-14KK308-5VS2" label="Solving Linear&#xa;Systems by&#xa;Elimination&#xa;[MAT.ALG.510]"/>
        <concept id="1JNW55K3S-27XNMQ0-5T80" label="Using&#xa;Inequalities&#xa;[MAT.ALG.423]"/>
      </concept-list
    </map>
  </cmap> 
```

还有更多，但这是其中的一个示例。我能够使用该`xpathRegisterNS()`命令注册默认命名空间并使用它找到我的地图、概念地图等。尝试使用 libxslt 处理此问题时，我没有同样的运气。

```
<?xml version="1.0" encoding="UTF-8" ?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:c="http://cmap.ihmc.us/xml/cmap/">
  <xsl:output method="xml" indent="yes"/>
  <xsl:template match="c:cmap">
    <graphml xmlns="http://graphml.graphdrawing.org/xmlns">
      <xsl:apply-templates select="c:concept"/>
    </graphml>      
  </xsl:template>
  <xsl:template match="c:concept">
    <node> Found a node </node>
  </xsl:template>
</xsl:stylesheet> 
```

而python实验只是：

```
 import libxml2
 import libxslt
 styledoc = libxml2.parseFile("cxltographml.xsl")
 style = libxslt.parseStylesheetDoc(styledoc)
 doc = libxml2.parseFile("algebra.cxl")
 result = style.applyStylesheet(doc, None)
 print style.saveResultToString(result) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:15:14.507

您已经掌握了有关 xslt 中命名空间的正确技术，即您必须将 uri 映射到前缀，因为“默认命名空间”不适用于 xpath 或模板匹配表达式。问题是在你的`c:cmap`模板中你正在做

```
 <xsl:apply-templates select="c:concept"/> 
```

但是该`cmap`元素没有任何名为 的直接子级`concept`。尝试

```
 <xsl:apply-templates select="c:map/c:concept-list/c:concept"/> 
```

或更一般地（但可能效率较低）

```
 <xsl:apply-templates select=".//c:concept"/> 
```

查找所有后代`concept`元素，而不仅仅是直接子元素。

此外，在`c:concept`模板中，您将需要添加`xmlns="http://graphml.graphdrawing.org/xmlns"`到`<node>`元素，否则它将在没有命名空间（带有`xmlns=""`）中输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T11:51:56.240

> 我一直在寻找任何 XSTL 处理的例子

也许是因为你拼错了？（对不起，但我们都犯了愚蠢的错误，不应该排除它们......）

实际上（请原谅我试图反省一下为什么这个问题很难解决），我怀疑是因为很多人在使用默认命名空间时遇到了麻烦，所以您不知何故将其视为原因，而未能寻求其他可能性。

此外，您似乎怀疑问题出在 libxslt 上。养成使用不同 XSLT 处理器尝试代码的习惯可能会很好，这样您就可以放心并消除处理器错误作为可能的原因。

通常，当您确定路径表达式无法选择某些内容时，有几种诊断方法：（a）盯着表达式直到您发现问题所在，（b）简化表达式，例如。通过删除过滤器，直到您确定其中的哪一部分是错误的，或者 (c) 转而使用模式感知和 XSLT 2.0。（一般来说，遗憾的是，（c）对大多数人来说太费力了，而（b）对于非常简单的表达毫无用处，所以他们继续浪费时间做（a））。

# .net - 如果 NETFX_CORE 适用于 Windows 8，那么什么适用于 Windows Phone 8？

> ID：13594472
> 
> 赞同：6
> 
> 时间：2012-11-27T22:38:45.660
> 
> 标签：.net, windows-8, windows-phone-8, conditional-compilation

我了解使用 NETFX_CORE 指令，如下所示：

```
#if NETFX_CORE 
    // Windows 8
#else 
    // Windows Phone 8
#endif 
```

更多信息： http: [//msdn.microsoft.com/en-us/library/windowsphone/develop/jj714084 (v=vs.105).aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj714084(v=vs.105).aspx)

但是是否有特定于 Windows Phone 8 的指令？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-28T04:03:16.427

是的，Windows Phone 指令是：

```
#if WINDOWS_PHONE 
```

这被记录[在这里](http://msdn.microsoft.com/en-us/library/dd282469.aspx)，但我很惊讶[这里](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj714084(v=vs.105).aspx)没有提到它。我还在一些代码中对此进行了测试，并且可以正常工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T01:53:36.743

WP8 应使用开发人员引入的自定义条件编译标志。[在此处](http://www.developer.nokia.com/Resources/Library/Lumia/#!co-development-and-porting-guide.html;#toc_Compiletimeadaptation)阅读有关此确切主题的更多信息。诺基亚有一整篇专门[针对 WP7 和 WP8 进行编码的](http://www.developer.nokia.com/Resources/Library/Lumia/#!co-development-and-porting-guide.html)文章，我强烈建议您查看所有技术，看看哪种技术最适合您使用。

> 定义条件编译符号：
> 
> 1.  右键单击 WP 8 项目并选择属性。打开
> 2.  项目设计器的构建页面并将 WP8 插入到条件编译符号中。在此之后，它们应该包含如下内容：**SILVERLIGHT;WINDOWS_PHONE;WP8**

这是内联代码示例

```
// Separate implementations for different OS versions
#if WP8
    // code using enhancements introduced in Windows Phone 8 
#else
    // code using Windows Phone OS 7.1 features 
#endif

// A new Windows Phone 8 feature
#if WP8
    // code using new Windows Phone 8 feature
#endif 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:43:33.383

据我所知，没有这样的指令。但是如果没有，您可以使用：

```
#if !NETFX_CORE 
    // Windows Phone 8
#endif 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T04:13:02.973

> 但是是否有特定于 Windows Phone 8 的指令？

您可以定义自己知道的预处理器指令。WINDOWS_PHONE 恰好由 Windows Phone 项目的 Visual Studio 项目模板定义。

DEBUG、TRACE 以及您可能拥有的任何自定义项也是如此，例如 EXTENSIVE_LOGGING 或 LOOKING_FOR_A_CATBUS

# ruby-on-rails - 如何将 gem 打包到 Rails 引擎中？

> ID：13594474
> 
> 赞同：1
> 
> 时间：2012-11-27T22:39:01.823
> 
> 标签：ruby-on-rails, rubygems

我正在构建一个 Rails 引擎，我需要在其中打包一个 gem，因为它不公开。最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:40:52.587

在您的 Gemfile 中：

```
gem 'super-private-sneaky-gem', :git => 'https://github.com/Inc1982/super-private-sneaky-gem', :branch => 'master' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:27:18.380

当您确实可以访问不公开可用的 gem 时，您需要出售 gem。这将使未公开可用的 gem 的源代码可用，但不会使其位置可用。这是[一个指南，描述了如何在有或没有 bundler 的情况下供应单个 rails gem](https://makandracards.com/makandra/538-freeze-vendor-unpack-a-single-ruby-gem-with-and-without-bundler)。

# c# - List.Sort 与 lambda 表达式

> ID：13594475
> 
> 赞同：14
> 
> 时间：2012-11-27T22:39:06.400
> 
> 标签：c#, list, sorting, delegates, lambda

我正在尝试使用 lambda 表达式对列表的一部分进行排序，但尝试这样做时出现错误：

```
List<int> list = new List<int>();
list.Add(1);
list.Add(3);
list.Add(2);
list.Add(4);

// works fine
list.Sort((i1, i2) => i1.CompareTo(i2) );

// "Cannot convert lambda expression to type 'System.Collections.Generic.IComparer<int>' because it is not a delegate type"
list.Sort(1, 2, (i1, i2) => i1.CompareTo(i2) );

foreach (int i in list)
    Console.WriteLine(i); 
```

猜测这是因为对于采用范围的排序没有 System.Comparison 重载。是否出于任何特殊原因而省略了？

有没有一种简单的方法可以从 lambda 表达式中获取合适的 IComparer （比如我可以用来去的类`list.Sort(1, 2, new CompareyThing<int>((...) => ...))`或其他东西）？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-27T22:43:42.913

您可以使用[Comparer.Create](http://msdn.microsoft.com/en-us/library/hh737198.aspx)方法，尽管这在 .Net 4.5 中似乎是新的

```
list.Sort(1, 2, Comparer<int>.Create((i1, i2) => i1.CompareTo(i2))); 
```

您始终可以创建自己的比较器：

```
public class FuncComparer<T> : IComparer<T>
{
    private readonly Func<T, T, int> func;
    public FuncComparer(Func<T, T, int> comparerFunc)
    {
        this.func = comparerFunc;
    }

    public int Compare(T x, T y)
    {
        return this.func(x, y);
    }
} 
```

那么您的代码将是：

```
list.Sort(1, 2, new FuncComparer<int>((i1, i2) => i1.CompareTo(i2))); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-27T22:50:10.740

如果您不使用 .Net 4.5，则可以创建自定义比较器：

```
class IntComparer : IComparer<int>
{
    public int Compare(int x, int y)
    {
        return x.CompareTo(y);
    }
}
list.Sort(1, 2, new IntComparer()); 
```

# mahout - Mahout：使用 regexconverter 或 arff.vector 将 CSV 文件导入序列文件

> ID：13594479
> 
> 赞同：1
> 
> 时间：2012-11-27T22:39:46.527
> 
> 标签：mahout

我刚开始学习如何使用 mahout。但是，我不是 java 程序员，所以我试图避免使用 java 库。

我注意到有一个 shell 工具 regexconverter。但是，文档很少且没有指导意义。指定正则表达式选项究竟是做什么的，转换器类和格式化程序类是做什么的？[mahout wiki](https://cwiki.apache.org/MAHOUT/file-format-integrations.html)非常不透明。我假设正则表达式选项指定什么算作“单位”左右。

他们列出的示例是使用 regexconverter 将 http 日志请求转换为我相信的序列文件。我有一个 csv 文件，其中包含稍微改变的 http 日志请求，我希望将其转换为序列文件。我是否只需更改正则表达式以获取每一行？我正在尝试运行一个贝叶斯分类器，类似于[20 个新闻组示例](https://cwiki.apache.org/confluence/display/MAHOUT/Twenty+Newsgroups)，它似乎完全在 shell 中完成，无需 Java 编码。

顺便说一句，[arff.vector](https://cwiki.apache.org/MAHOUT/creating-vectors-from-wekas-arff-format.html)命令似乎允许我将 arff 文件直接转换为向量。我对 arff 不熟悉，认为它似乎是我可以轻松将 csv 日志文件转换成的东西。我应该改用这种方法，并完全跳过序列文件步骤吗？

谢谢您的帮助。

# facebook - Facebook 发布在另一个应用程序的域中定义的操作

> ID：13594483
> 
> 赞同：2
> 
> 时间：2012-11-27T22:39:58.890
> 
> 标签：facebook, permissions, facebook-javascript-sdk

我想使用一个 facebook 应用程序发布在另一个应用程序的域中定义的操作，可以这样做吗？我的意思是，我们可以更改操作的设置以使其全局可用或专门授予其他应用程序的权限吗？

例如，如果我在 app1 中定义了一个自定义操作，假设它是 app1:laugh（这是虚构的），那么我尝试使用 javascript 测试控制台 (http://developers.facebook.com/tools/console/) 来测试以下代码，我得到一个错误：

**(#100) 应用程序 184484190795 不拥有 xxxxxxxxxxxx 动作类型**

```
<script>
window.postAction = function()
{
FB.api(
    '/me/app1:laugh',
    'post',
    { someobject: 'http://domain.com/12345' },
    function(response) {
       console.log(response);
    });
}
</script>
<fb:login-button show-faces="true" width="200" max-rows="1" scope="publish_actions">
Login
</fb:login-button>
<button onclick="postAction()" >
Post Action
</button> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:41:10.923

不，这是对 API 的有意限制；您不能针对其他网站的对象发布操作，只能在源自您应用的网站或画布 URL 的网站上发布

# java - 用杰克逊解析 JSON。为什么 HashMap 而不是我的类型？

> ID：13594484
> 
> 赞同：0
> 
> 时间：2012-11-27T22:40:02.317
> 
> 标签：java, json, jackson

我正在使用 Jackson 库来解析 JSON：

```
{
"employees": [
{ "firstName":"John" , "lastName":"Doe" }, 
{ "firstName":"Anna" , "lastName":"Smith" }, 
{ "firstName":"Peter" , "lastName":"Jones" }
]
} 
```

这是我正在做的事情：

```
public void testJackson() throws IOException {
    JsonFactory factory = new JsonFactory();
    ObjectMapper mapper = new ObjectMapper(factory);
    File from = new File("emp.txt"); // JSON object comes from
    TypeReference<HashMap<String, Object>> typeRef = new TypeReference<HashMap<String, Object>>() {};
    HashMap<String, Object> o = mapper.readValue(from, typeRef);
    Employees employees = new Employees();
    employees.employees = (List<Employer>)o.get("employees"); // retrieving list of Employer(s)
    employees.showEmployer(1); // choose second to print out to console

    System.out.println("Got " + o); // just result of file reading
}

public static class Employees {
    public List<Employer> employees;

    public void showEmployer(int i) {
        System.out.println(employees.get(i));
    }
}

public static class Employer {
    public String firstName;
    public String lastName;
} 
```

我得到的输出：

> {名=安娜，姓=史密斯}
> 
> 得到 {employees=[{firstName=John, lastName=Doe}, {firstName=Anna, lastName=Smith}, {firstName=Peter, lastName=Jones}]}

但我不希望我的元素`List`是`HashMap`实例，而是`Employer`对象。这就是`Jackson`图书馆应该是的，不是吗？你们能纠正我哪里错了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:49:26.517

我没有使用杰克逊，但似乎你得到了你所要求的 - 一个字符串，对象对的 HashMap。也许您需要在地图的“价值”部分更加明确？由于该值是一个 Employee 对象数组，您可以尝试：

```
TypeReference<HashMap<String, List<Employee>>> typeRef = new TypeReference<HashMap<String, List<Employee>>>() {};
HashMap<String, List<Employee>> o = mapper.readValue(from, typeRef); 
```

# jquery-mobile - 复选框收音机未定义

> ID：13594485
> 
> 赞同：0
> 
> 时间：2012-11-27T22:40:16.690
> 
> 标签：jquery-mobile

我正在使用带有 jQ​​uery Mobile 的 Visual Studio 2012 开发 MVC4 移动应用程序。我需要记住复选框和单选按钮的状态，以便将它们的值存储在 cookie 中。当我回到 pageinit 事件中的页面时，我设置了值，但控件永远不会在视觉上更新。使用 Firebug 将页面呈现为移动设备，我可以看到值已正确更改。我试过在这样的元素上调用 checkboxradio('refresh')：

```
$('#btnCompany').prop('checked', true)checkboxradio('refresh'); 
```

但我总是收到一条错误消息，提示 checkboxradio 未定义且不受支持。我知道控件是一个单选按钮。为了尝试解决这个问题，我在 jQuery Mobile 中提取了代码以刷新我调用的单选按钮和复选框，我再次可以在 Firebug 中清楚地看到，不仅输入检查正确，而且标签类也已适当更改。然而，在视觉上没有任何变化，它们看起来就像原来一样。我错过了什么吗？为什么即使我在 pageinit 事件中调用它，我也会收到错误消息，说 checkboxradio 不受支持：

```
$("input[type='radio']").checkboxradio("refresh"); 
```

我尝试通过隐藏然后显示包含的 div 来刷新，但失败了。我没有尝试过在视觉上刷新控件。任何和所有的帮助将不胜感激！！！

这是我正在调用以绕过复选框收音机刷新页面的函数。这是我调用来尝试解决问题的函数：

```
function SetSearchFormState() {
if ($.cookie('cmdSearchForm') != null) {

    //$('#searchParamsDiv').hide();

    var formData = JSON.parse($.cookie('cmdSearchForm'));

    $('#SearchText').val(formData.SearchText);        

    // Set all search buttons to not selected.       
    $('.searchBtn').each(function () {
        $(this).prop('checked', false);
        RefreshCheckboxRadio(this, false);
    });

    // Set the appropriate search button selected.
    $('#hidSearch').val(formData.hidSearch);
    switch (formData.hidSearch) {
        case 'Opportunity':
            $('#btnOpportunity').prop('checked', true);
            RefreshCheckboxRadio($('#btnOpportunity'), true);
            break;
        case 'Company':
            $('#btnCompany').prop('checked', true);
            RefreshCheckboxRadio($('#btnCompany'), true);
            break;            
        case 'Contact':
            $('#btnContact').prop('checked', true);
            RefreshCheckboxRadio($('#btnContact'), true);
            break;
    }

    // Set all status buttons to not selected.
    $('.statusBtn').each(function () {
        $(this).prop('checked', false);
        RefreshCheckboxRadio(this, false);
    });        

    // Set the appropriate status button selected.
    $('#hidStatus').val(formData.hidStatus);
    switch (formData.hidStatus) {
        case 'Lead':
            $('#btnLead').prop('checked', true);
            RefreshCheckboxRadio($('#btnLead'), true);
            break;
        case 'Prospect':
            $('#btnProspect').prop('checked', true);
            RefreshCheckboxRadio($('#btnProspect'), true);
            break;
        case 'Customer':
            $('#btnCustomer').prop('checked', true);
            RefreshCheckboxRadio($('#btnCustomer'), true);
            break;
    }        

    // Set the appropriate include button selected.
    $('#hidAllUsers').val(formData.hidAllUsers);
    $('#btnAllUsers').prop('checked', false);
    RefreshCheckboxRadio($('#btnAllUsers'), false);
    if (formData.hidAllUsers == 'True') {
        $('#btnAllUsers').prop('checked', true);
        RefreshCheckboxRadio($('#btnAllUsers'), true);
    }

    $('#hidDead').val(formData.hidDead);
    $('#btnDead').prop('checked', false);
    RefreshCheckboxRadio($('#btnDead'), false);
    if (formData.hidDead == 'True') {
        $('#btnDead').prop('checked', true);
        RefreshCheckboxRadio($('#btnDead'), true);
    }

    //$('#searchParamsDiv').show();
    $("input[type='radio']").checkboxradio("refresh");
    $("input[type='checkbox']").checkboxradio("refresh");
}
}; 
```

这是我从 jQuery mobile 的 checkboxradio 刷新方法中提取的函数：

```
function RefreshCheckboxRadio(control, value) {
if ($(control).is(':radio')) {
    var parent = $(control).parent('div');        
    var controlId = $(control).attr('id');
    var label = $(parent).find("label[for='" + controlId + "']");
    var icon = $(label).find(".ui-icon");
    //$(parent).hide();
    if (value == false) {            
        $(control).removeAttr('checked');
        $(label).removeClass('ui-radio-on ui-button-active').addClass('ui-radio-off');
        $(icon).removeClass('ui-icon-radio-on').addClass('ui-icon-radio-off');
    } else if (value == true) {            
        $(control).attr('checked', 'checked');
        $(label).addClass('ui-radio-on ui-button-active').removeClass('ui-radio-off');
        $(icon).addClass('ui-icon-radio-on').removeClass('ui-icon-radio-off');
    }
    //$(parent).show();
} else if ($(control).is(':checkbox')) {
    var parent = $(control).parent('div');       
    var controlId = $(control).attr('id');
    var label = $(parent).find("label[for='" + controlId + "']");
    var icon = $(label).find(".ui-icon");
    //$(parent).hide();
    if (value == false) {
        $(control).removeAttr('checked');
        $(label).removeClass('ui-checkbox-on ui-button-active').addClass('ui-checkbox-off');
        $(icon).removeClass('ui-icon-checkbox-on').addClass('ui-icon-checkbox-off');
    } else if (value == true) {
        $(control).attr('checked', 'checked');
        $(label).addClass('ui-checkbox-on ui-button-active').removeClass('ui-checkbox-off');
        $(icon).addClass('ui-icon-checkbox-on').removeClass('ui-icon-checkbox-off');
    }
   // $(parent).show();
}
}; 
```

运行此代码后，我可以看到值是正确的，并且与调用 checkboxradio('refresh') 时的值完全相同。因此，即使我无法让 checkboxradio 工作，手动执行工作应该可以工作，事实上，当我在 Firebug 中查看更改时，控件仍然不会改变它们的外观。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T22:58:28.037

经过大量的实验，我最终放弃了这段代码，在 jQuery Mobile 中禁用了 Ajax，然后手动处理了所有的 Ajax。我可以写一本关于我所学到的关于使用 MVC4 开发 jQuery Mobile 应用程序的书，并且可能会帮助那里的许多人，但可惜我没有时间，也没有得到报酬，抱歉。我只能希望有一天有人记录如何以正确的方式做事，这样人们就可以求助于单一来源，而不必花费数小时到处寻找零碎的东西。

# c++ - 旋转精灵对象 Directx9

> ID：13594486
> 
> 赞同：0
> 
> 时间：2012-11-27T22:40:19.090
> 
> 标签：c++, directx, sprite

我正在使用 Directx 9 在 C++ 中制作小游戏。我阅读了一些教程，我可以绘制我的精灵对象并移动它等。但我想旋转它。我尝试：

```
void D3DGraphics::DrawSprite(LPDIRECT3DTEXTURE9 &texture,ID3DXSprite* pSprite, D3DXVECTOR3* pos, D3DXVECTOR3* dim ){

pDevice->Clear( 0,NULL,D3DCLEAR_STENCIL,D3DCOLOR_XRGB(0,0,0),0.0f,0 );

D3DXMATRIX matrix;
D3DXMatrixRotationX(&matrix, 0.05f);

pSprite->Begin(D3DXSPRITE_ALPHABLEND);

    hresult= pSprite->SetTransform(&matrix);

    hresult= pSprite->Draw(texture, NULL, dim, pos, 0xFFFFFFFF);

pSprite->End();

} 
```

当我删除 settransform 部分时，它工作得很好。我检查了 hresult 他们返回了 S_OK。知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T01:21:48.067

我认为旋转精灵是没有意义的，因为精灵通常带有 2d 纹理并用于广告牌，如果围绕 X 轴旋转它，就像图片围绕 X 轴翻转一样，你不能得到你想要的效果，我试着绕 Z 轴旋转它，这很好用，因为纹理通常在 XOY 平面上。

如果你想制作一个旋转的球，为什么不使用 3D 网格？sprite 不是这个请求的好选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T10:36:28.380

我认为主要问题是，您尝试将 3D-Transformations 用于 2D 用例。尝试使用`D3DXMatrixTransformation2D`（[doc](http://msdn.microsoft.com/en-us/library/windows/desktop/bb205366%28v=vs.85%29.aspx)）矩阵。但是还有其他问题。我假设名称 dim 代表维度，但`Draw()`( [doc](http://msdn.microsoft.com/en-us/library/windows/desktop/bb174251%28v=vs.85%29.aspx) ) 的这个参数设置精灵的中心，而不是大小。最后，全屏清除您的模板缓冲区而不使用它是不必要的昂贵，但我不知道您的其他代码。希望有帮助:)

# php - PHP str_replace 函数

> ID：13594487
> 
> 赞同：5
> 
> 时间：2012-11-27T22:40:21.120
> 
> 标签：php, str-replace

是否可以`str_replace()`在替换中使用和使用功能？

```
$value = "gal($data)";

$replace = str_replace($dat, $value, $string); 
```

**`gal($data)`**是一个函数，我需要为这个函数替换一个代码并显示，但脚本最终只给了我 this **`gal($data)`**，函数没有显示什么

是否可以`str_replace()`用于替换代码并用函数或类似方法替换？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-27T22:41:41.130

PHP 有一个名为的函数[`preg_replace_callback`](http://php.net/manual/en/function.preg-replace-callback.php)来执行此操作。当您向它传递一个回调函数时，它将通过您的函数传递每个匹配项。您可以根据匹配的值选择替换或忽略它。

例如，假设我有一个匹配各种字符串的模式，例如`[a-z]+`. 我可能不想用相同的值替换每个实例，所以我可以在找到匹配项时调用一个函数，并确定我应该如何响应：

```
function callback ($match) {
    if ($match[0] === "Jonathan")
        return "Superman";
    return $match[0];
}

$subject = "This is about Jonathan.";
$pattern = "/[a-z]+/i";
$results = preg_replace_callback($pattern, "callback", $subject);

// This is about Superman.
echo $results; 
```

请注意，在我们的回调函数中，我如何能够为某些匹配项返回特殊值，而不是所有匹配项。

### 扩展缩写

另一个例子是查找。假设我们想找到编程语言的缩写，并用它们的完整名称替换它们。我们可能有一个以缩写作为键，以长名称作为值的数组。然后我们可以使用我们的回调功能来查找全长名称：

```
function lookup ($match) {
    $langs = Array(
        "JS"  => "JavaScript", 
        "CSS" => "Cascading Style Sheets", 
        "JSP" => "Java Server Pages"
    );
    return $langs[$match[0]] ?: $match[0];
}

$subject = "Does anybody know JS? Or CSS maybe? What about PHP?";
$pattern = "/(js|css|jsp)/i";
$results = preg_replace_callback($pattern, "lookup", $subject);

// Does anybody know JavaScript? Or Cascading Style Sheets maybe? What about PHP?
echo $results; 
```

所以每次我们的正则表达式找到一个匹配，它通过匹配`lookup`，我们可以返回适当的值，或者原始值。

# android - 是否可以阻止在android中安装应用程序？

> ID：13594491
> 
> 赞同：-4
> 
> 时间：2012-11-27T22:40:55.110
> 
> 标签：android, installation

这应该由认为用户安装恶意代码的安全应用程序来完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:44:01.703

我假设您想编写一个应用程序来执行此操作，因为您在编程网站上发帖。但是，您的问题是如此含糊，以至于我不确定您遇到了什么问题。

如果这就是您正在寻找的东西，那么已经有几个应用程序可以做到这一点...... [https://play.google.com/store/search?q=antivirus&c=apps](https://play.google.com/store/search?q=antivirus&c=apps)

# c - 与 EVP_ENCRYPT 一起使用时遇到问题

> ID：13594492
> 
> 赞同：1
> 
> 时间：2012-11-27T22:40:58.510
> 
> 标签：c, encryption, openssl, corruption

您好我正在尝试编写一个使用 EVP_Encrypt Openssl 库的程序，但我遇到了一些麻烦。我使用了[用 openssl 河豚简单示例插入垃圾字符的帖子协助](https://stackoverflow.com/questions/993780/assistance-with-openssl-blowfish-simple-example-inserting-garbage-characters)作为指导，认为它应该给我一个很好的起点。但是，我很确定出了什么问题，但我不知道是什么。我知道有问题，因为我使用 openssl 测试是否可以解密密文。命令是：我的程序创建的密文文件在`cat file.enc | openssl bf-cbc -d -K cafefacedeadbeef -iv 0 > output`哪里。`file.enc`运行 Openssl 命令后，我收到此错误消息`bad decrypt 7418:error:06065064:digital envelope routines:EVP_DecryptFinal_ex:bad decrypt:evp_enc.c:330:` 此问题可能与我试图将初始化向量设为 0 或我在密钥中读取的方式有关，但我并不肯定。任何帮助都会很棒。

加密功能：

```
void encrypt(unsigned char *key, unsigned char* msg)
{
        unsigned char iv[8]={0};

        int length = 0;
        EVP_CIPHER_CTX enc_struct;
        EVP_CIPHER_CTX_init(&enc_struct);
        EVP_EncryptInit(&enc_struct, EVP_bf_cbc(), key, iv);

        unsigned char* out = (unsigned char *) malloc(sizeof(unsigned char) * 1024 +EVP_MAX_BLOCK_LENGTH);

        if (EVP_EncryptUpdate(&enc_struct, out, &length, msg, 8) != 1)
        {
                printf("error update\n");
                exit(EXIT_FAILURE);
        }

        write(STDOUT_FILENO, out, length);

        int temp_length = 0;

        if(EVP_EncryptFinal(&enc_struct, out+length, &temp_length) !=1)
        {
                printf("error final\n");
                exit(EXIT_FAILURE);
        }

        write(STDOUT_FILENO, out+length, temp_length);

        EVP_CIPHER_CTX_cleanup(&enc_struct);

        free(out);
} 
```

调用加密函数并读入密钥。

```
int main(int argc, char* argv[])
{
        setprogname("bf");
        setproctitle("-%s", "bf");
        int decrypt_flag = 0;
        int encrypt_flag = 0;
        int key_flag = 0;
        char ch;
        unsigned char raw_key[16] = {'\0'};

        if (argc <=1)
              help();
        memcpy(raw_key, argv[optind], 24);

        bytes_read = read(STDIN_FILENO, msg, 8);
        if (encrypt_flag)
                encrypt(raw_key, msg);
        else
                decrypt();
        return 0;
} 
```

# list - 如何在 lisp 中制作对的列表？

> ID：13594493
> 
> 赞同：0
> 
> 时间：2012-11-27T22:41:00.047
> 
> 标签：list, lisp

我正在尝试将配对列表作为家庭作业的一部分。

我试着做（在函数中间的某个地方）

```
(setq list1 (append list1 (cons n1 n2))) 
```

由于某种原因，我不明白，这适用于第一对，但是当我尝试附加第二对时，会弹出此错误：

> *** - APPEND：正确的列表不能以 2 结尾

我该如何解决这个问题？

所以，继续这个主题，感谢给出的答案，我能够纠正我的问题。但是一个新的出现了，我认为它与它有关。所以，我有这个功能：

```
(defun action(state)
(let ((list_actions '())
      (limNumActions (1- (list-length state)))
      (limNumSubActions 0)
      (numActions 0)
      (numSubActions 0))
  (loop for numActions from 0 to limNumActions do
    (setq limNumSubActions (1- (list-length (nth numActions state))))
    (loop for numSubActions from 0 to limNumSubActions do
      (setq list_actions (append list_actions
        (list (cons numActions numSubActions))))
      (print 'list_actions)
      (print list_actions))))) 
```

我将该`print`函数用作简单的“调试器”。它返回这个：

```
 LIST_ACTIONS 
 ((0 . 0)) 
 LIST_ACTIONS 
 ((0 . 0) (0 . 1)) 
 LIST_ACTIONS 
 ((0 . 0) (0 . 1) (1 . 0)) 
 LIST_ACTIONS 
 ((0 . 0) (0 . 1) (1 . 0) (1 . 1)) 
 NIL 
```

而这正是我所期待的结果！除了`NIL`部分...你能理解为什么列表`list_actions`在`NIL`最后吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:08:03.257

`append`需要两个列表，而不是列表和单个元素。在使用它之前，您需要在该对周围放置一个列表`append`。

目前，这对被视为列表的一部分，这使得列表不正确并导致第二次追加失败，因为不正确的列表并没有完全结束追加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T03:59:47.543

代码可以更简洁地表达如下：

```
(defun action (state)
  (let ((list-actions '()))
    (loop for i from 0 for state-i in state do
      (loop for j from 0 below (length state-i) do
        (setf list-actions (append list-actions (list (cons i j))))
        (print 'list-actions)
        (print list-actions)))
    list-actions)) 
```

如果只需要结果，它可以更短（并且成本更低，因为它不使用昂贵的`append`功能），

```
(defun action (state)
  (loop for i from 0 for state-i in state append
    (loop for j below (length state-i) collect (cons i j)))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T01:15:13.000

我试图稍微改进您的示例 + 编写一个使用不同但 IMO 更惯用的解决问题方法的版本：

```
;; Your original version, but cleaned up a bit
(defun action (state)
  (loop with list-actions = nil
     with lim-num-actions = (1- (list-length state))
     with lim-num-sub-actions = 0
     for num-actions from 0 to lim-num-actions
     do (setq lim-num-sub-actions (1- (list-length (nth num-actions state))))
       (loop for num-sub-actions from 0 to lim-num-sub-actions
          do (push (cons num-actions num-sub-actions) list-actions)
            (format t "~&~s ~s" 'list-actions list-actions))
     finally (return list-actions)))

;; A more traditional approach (if you want to use iteration)
(defun action (state)
  (reverse 
   (loop for i in state
      for j from 0
      collect (cons j 0))))

;; Using a nice library to do iteration
(ql:quickload "iterate")
;; Note, you could do (in-package :iterate)
;; to lose `iterate:' prefix to make it even shorter
(defun action (state)
  (iterate:iter
    (iterate:for i #:on state)
    (iterate:for j #:from 0)
    (iterate:accumulate (cons j 0) #:by #'cons)))

;; Just another way to do this, using `reduce'
(reduce #'(lambda (a b)
            (declare (ignore b))
            (cons (cons (1+ (caar a)) 0) a))
        (cdr (mapcar #'list '(1 2 3 4 5)))
        :initial-value '((0 . 0)))

(action (mapcar #'list '(1 2 3 4 5))) 
```

# javascript - twitter bootstrap 动态显示模式 - 递归错误太多

> ID：13594495
> 
> 赞同：2
> 
> 时间：2012-11-27T22:41:11.510
> 
> 标签：javascript, jquery, twitter-bootstrap

我有 jQuery v1.8.3 和 twitter-bootstrap v2.2.1

我想创建一个函数来动态显示消息。

```
function showMsg(header, text, closeFunc) {
    var randId = Math.round(Math.random()*1000000);

    var dialog = '<div id="modal_' + randId + '" class="modal hide fade">';
    dialog += '<div class="modal-header">';
    dialog += '<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>';
    dialog += '<h3>' + header + '</h3>';
    dialog += '</div>';
    dialog += '<div class="modal-body">';
    dialog += text;
    dialog += '</div>';
    dialog += '<div class="modal-footer">';
    dialog += '<button id="modalBtn_' + randId + '" class="btn btn-primary">Close</button>';
    dialog += '</div>';
    dialog += '</div>'; 

    $('body').append(dialog);

    var modal = $('#modal_' + randId);

    modal.modal({backdrop : false, show : false, keyboard : false});
    modal.modal('show');

    var btn = $('#modalBtn_' + randId);
    btn.click(function(){
       closeFunc();
       modal.modal('hide');     
    });

} 
```

但是在一次显示超过 3 条这些消息后，我在 Jquery 中得到一个错误：`too much recursion`

我该如何解决它或有其他方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-28T06:24:51.417

我无法重新创建您的*“递归过多”*错误，但我确实想建议一种比您当前拥有的代码更好的处理动态消息的方法。也就是说，您可以只使用一个 Modal 并在显示之前更新其中的内容。这将消除您目前产生的所有开销

1.  让 jQuery 反复将相同的字符串解析为 html；
2.  为每条消息实例化一个新的 Modal 对象；和
3.  生成随机 id，然后在 DOM 中搜索使用它们创建的元素。

作为替代方案，从一开始就在标记中使用以下空白模式。在哪里并不重要，但底部`<body>`是一个典型的位置。如果您*必须*动态生成它，请在`showMsg`函数之外执行并且只执行一次。

```
<div id="msgModal" class="modal hide fade">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3></h3>
  </div>
  <div class="modal-body">
  </div>
  <div class="modal-footer">
    <button class="btn btn-primary callback-btn" data-dismiss="modal">Close</button>
  </div>
</div> 
```

请注意，我确实通过将固定添加`id="msgModal"`到模态并将类`callback-btn`和属性添加`data-dismiss="modal"`到`button`.

那么代码`showMsg`可能是：

```
var $msgModal = $('#msgModal').modal({
      backdrop: false,
      show: false,
      keyboard: false
    }),

  showMsg = function (header, body, callback) {
    $msgModal
      .find('.modal-header > h3').text(header).end()
      .find('.modal-body').text(body).end()
      .find('.callback-btn').off('click.callback')
        .on('click.callback', callback).end()
      .modal('show');
  }; 
```

这是一个演示，如果单击页脚按钮，它将输出到控制台：

## [PLNKR](http://embed.plnkr.co/RHIPp8)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T10:37:16.937

或者只是触发这个事件：

```
jQuery('<a href="#my_new_div_with_modal_template" data-toggle="modal">Click me !</a>').trigger('click.modal.data-api'); 
```

# php - 标记上传到 Facebook 的视频？

> ID：13594498
> 
> 赞同：0
> 
> 时间：2012-11-27T22:41:34.463
> 
> 标签：php, facebook, video, tagging

我正在开发一个将视频上传到您的 Facebook 时间线的 Facebook 应用程序。我希望能够在视频中标记用户的朋友，因为我正在处理视频以包含他们的个人资料图片。朋友最多不超过 4 个，而且他们出现在视频中，因此不应该违反任何垃圾邮件规则。

有没有办法自动标记此视频中的人？我正在使用 PHP 中的 Curl 上传 /videos 端点，并将视频 ID 作为响应返回，并尝试发布到 /video_id/tags 以标记用户，但它不起作用。有没有办法处理这个？

谢谢， 伊萨

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:53:23.550

对，似乎不可能通过发布到[https://graph-video.facebook.com/me/videos](https://graph-video.facebook.com/me/videos)来标记上传的视频（无论是使用`tags=`或上传视频时`tags[]=`，还是在上传视频后）。

作为一种解决方法，您可以考虑使用 Open Graph 操作并标记该操作。例如，“Esa 上传了一个视频”并为 Esa 的朋友添加标签。这也会在用户的时间线中为您提供 OG 聚合故事。

有关标记 OG 操作的信息：

[https://developers.facebook.com/docs/opengraph/actions/#taggingpeople](https://developers.facebook.com/docs/opengraph/actions/#taggingpeople)

# primefaces - 如何更改 Primefaces 文件上传取消按钮图标

> ID：13594499
> 
> 赞同：0
> 
> 时间：2012-11-27T22:41:33.887
> 
> 标签：primefaces

我想使用 jQuery`ui-icon-close`而不是`ui-icon-cancel`. 所以我转到`fileupload.js`primefaces jar（3.3.1）中的文件，将引用更改`ui-icon-cancel`为`ui-icon-close`（第2082行，上传模板）。但它不起作用。任何想法？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:10:26.540

我找到了一种更简单的方法来解决这个问题：

1.  我在文件上传控件中添加了一个 id：

    ```
    <p:fileUpload id="related_file" ..../> 
    ```

2.  然后在我的 css 中，添加以下行：

    ```
    div[id*=related_file] .ui-icon-cancel{
        background-position: -96px -128px !important;
    } 
    ```

这有效，取消按钮最终使用 ui-icon-closeThick 图标。

但是如果有人知道答案，我仍然想知道为什么我原来的方法不起作用。谢谢。

# java - 客户端断开连接后进程是否仍继续

> ID：13594501
> 
> 赞同：2
> 
> 时间：2012-11-27T22:41:38.110
> 
> 标签：java, servlets, request

当客户端过早地与服务器请求断开连接时，服务器是否仍然执行其余的工作？
具体来说，如果我有以下代码，则在 Java Servlet doGet 中：

```
公共无效doGet（HttpServletRequest req，HttpServletResponse res）抛出ServletException，IOException
{
   一个（）; //客户端在 A() 之后断开连接；
   乙（）；
   C（）;  
}

如果客户端在 A() 完成后断开连接，B 和 C 还会执行吗？

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T22:43:12.397

是的。服务器不知道断开连接，直到它尝试将某事物写入输出流（作为响应）。事件然后由于中间的代理服务器或由于输出流缓冲，可能很难知道客户端已断开连接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:51:56.030

这取决于。

如果在`A()`（或任何其他方法）期间您尝试将响应（使用`res`）发送回客户端，`IOException`则会被抛出。如果没有被捕获，它将终止 servlet 执行。

否则计算将在 之后继续并退出`C()`。

# objective-c - UITableView 委托方法没有被调用

> ID：13594505
> 
> 赞同：0
> 
> 时间：2012-11-27T22:41:54.210
> 
> 标签：objective-c, xcode, ipad

我有一个包含三个不同 .xib 文件的选项卡视图。每个都有自己的控制器和头文件。其中两个几乎相同。因此，我将 UI 元素从一个 .xib 文件复制到了第二个，并将代码从一个控制器复制到了第二个。当然，根据需要更改控制器名称。第一个表按预期显示。第二个根本不显示。

单步执行代码，我可以看到第一个调用委托方法的位置，但第二个调用没有调用它们。就像代码不知道从那个 .xib 文件中调用这些方法一样。但是我的头文件中确实有那个 .xib 的 UITableViewDelegate。

关于我错过了什么的任何想法？

谢谢你，P

# tsql - 如何制作等效的动态事务 sql 块？

> ID：13594506
> 
> 赞同：0
> 
> 时间：2012-11-27T22:42:13.733
> 
> 标签：tsql, sql-server-2005, dynamic-sql

我有一个关于 T-SQL 动态 SP 的问题。第一个块是我的失败尝试，第二个是我的目标（非动态块）。

```
CREATE PROCEDURE UDP1_TRY_EQQQ
(@FACTUTABLE nvarchar(100))
AS 
declare @sqlquery as nvarchar(100)
BEGIN
SET @sqlquery = 'DELETE FROM ' + @FACTUTABLE + ' WHERE ANEXO IN 
    (SELECT ANEXO FROM ' + @FACTUTABLE + ' A LEFT JOIN ALTAS_MOVILES B 
    ON A.ANEXO=B.TCNFOL WHERE B.TCNFOL IS NULL)'
EXEC sp_ExecuteSql @sqlquery
END

DELETE FROM FACTURACION_201210
WHERE ANEXO IN 
(
SELECT ANEXO
FROM FACTURACION_201210 A
LEFT JOIN ALTAS_MOVILES B
ON A.ANEXO=B.TCNFOL
WHERE B.TCNFOL IS NULL
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:51:51.983

您的 @sqlquery 变量只允许 100 个字符。让它更大。

此外，在您需要替换表名的这些动态查询中，我喜欢采取两个额外的预防措施：

1.  使用[QUOTENAME()](http://msdn.microsoft.com/en-us/library/ms176114.aspx)。例如：`@sql = 'Select * FROM ' + QuoteName(@table);`
2.  在 information_schema 中查找表名，以确保它不会导致语法错误：`SELECT Table_Name FROM Information_schema.Tables WHERE Table_Name = @FACTUTABLE;`

如果您想真正花哨，您还可以检查表是否在正确的模式中，甚至检查 information_schema.columns 以确保所选表具有正确的列名，但通常只有前两个检查我去。

# python - 标量变量误差的索引是什么意思？Python

> ID：13594507
> 
> 赞同：36
> 
> 时间：2012-11-27T22:42:22.327
> 
> 标签：python

```
import numpy as np

with open('matrix.txt', 'r') as f:
    x = []
    for line in f:
        x.append(map(int, line.split()))
f.close()

a = array(x)

l, v = eig(a)

exponent = array(exp(l))

L = identity(len(l))

for i in xrange(len(l)):
    L[i][i] = exponent[0][i]

print L 
```

1.  我的代码打开一个包含矩阵的文本文件：
    `1 2`
    `3 4`
    并将其`x`作为整数放入列表中。

2.  然后将列表`x`转换为数组`a`。

3.  的特征值`a`放在 中`l`，特征向量放在 中`v`。

4.  然后我想把 exp(a) 放在另一个数组`exponent`中。

5.  `L`然后我创建一个任意长度的单位矩阵`l`。

6.  我的 for 循环应该在单位矩阵的对角线上取值`exponent`并替换 1，但我收到错误消息

    > `invalid index to scalar variable`.

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-11-27T22:45:58.990

`exponent`是一维数组。这意味着这`exponent[0]`是一个标量，并且`exponent[0][i]`正试图像访问数组一样访问它。

你的意思是说：

```
L = identity(len(l))
for i in xrange(len(l)):
    L[i][i] = exponent[i] 
```

甚至

```
L = diag(exponent) 
```

?

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-09-19T20:36:37.770

`IndexError: invalid index to scalar variable`当您尝试索引`numpy`标量时会发生`numpy.int64`or `numpy.float64`。这与`TypeError: 'int' object has no attribute '__getitem__'`您尝试索引`int`.

```
>>> a = np.int64(5)
>>> type(a)
<type 'numpy.int64'>
>>> a[3]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
IndexError: invalid index to scalar variable.
>>> a = 5
>>> type(a)
<type 'int'>
>>> a[3]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'int' object has no attribute '__getitem__' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-04-07T19:46:56.520

就我而言，我收到此错误是因为我有一个名为的输入`x`，并且我正在创建（没有意识到）一个名为`x`. 我以为我正在尝试访问输入的一个元素`x`（这是一个数组），而我实际上是在尝试访问局部变量的一个元素`x`（这是一个标量）。

# php - 用于 AJAX 的 PHP 文件中是否需要 doctype 和其他 HTML 标记？

> ID：13594510
> 
> 赞同：0
> 
> 时间：2012-11-27T22:42:40.800
> 
> 标签：php, ajax, doctype, html

我在我的动态网站中使用 AJAX。我没有重新加载整个页面，而是使用 AJAX 来请求 PHP 文件，并更改页面的内容。

从 AJAX 请求的那些 PHP 文件中删除 doctype 和标签是否可以？如果我从 PHP 中留下 doctype 和标签，我将来会收到任何错误...

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:51:47.543

## 方案 1

如果“页面”实际上是动态插入到完整文档中的片段，则不需要这些标签（实际上，它们是无效的）。

```
<!DOCTYPE html>
<head></head>
<body>

    <div></div>
    <!-- fine to insert a fragment here -->
</body>
</html> 
```

## 方案 2

如果页面需要独立，它必须是完整且有效的。即使它显示正确，它也有可能出现重大问题。

## 方案 3

如果 PHP 页面只是为响应 AJAX 请求而提供数据（例如 JSON），那么它根本不需要任何 HTML 标记（@Sean Dunwoody 演示了这一点）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T22:54:07.253

你的意思是你有一个 PHP 文件并且你正在向它发出一个 ajax 请求 - 例如，使用 get 请求获取有关用户的更多信息，例如：

[http://www.example.com/ajax/userInfo.php?id=4](http://www.example.com/ajax/userInfo.php?id=4)

您的 PHP 代码可能如下所示：

```
$userId = $_GET['id'];

$currentUser = new user($userId);
$user->printDetails; 
```

（我希望这一切都有意义）

如果是这种情况，那么不，**您不需要`<html><head>`文件中的文档类型或元素。**

我希望我已经正确理解了您的问题，如果没有，请告诉我。

# mysql - 如何将两列的每个字段相加为一列

> ID：13594513
> 
> 赞同：-2
> 
> 时间：2012-11-27T22:42:59.190
> 
> 标签：mysql, sql, sum

我有一张桌子（table1）：

```
=====================================
|  column1         |  Column2       |
=====+========+===============+=====|
|   1              |     1          |
|----+--------+---------------+-----|
|   2              |     2          |
|----+--------+---------------+-----| 
```

我需要这个输出

```
====================
|       Sum        |
=====+========+=====
|        2         |
|----+--------+----|
|        4         | 
|----+--------+----| 
```

我基本上只需要将每个字段的总和并排组合成一个新列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:43:39.010

是不是就这么简单？

```
SELECT (Column1 + Column2) `SUM`
FROM   tableName 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/1692d/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:43:48.347

```
SELECT column1+column2 as `sum`
FROM your_table 
```

# objective-c - 如何缓存远程图像？

> ID：13594514
> 
> 赞同：0
> 
> 时间：2012-11-27T22:43:07.147
> 
> 标签：objective-c, rubymotion

我正在使用 Rubymotion 构建一个 iOS 应用程序。我需要缓存位于表格视图中的远程图像。我正在尝试使用此处找到的名为“JMImageCache”的 Cocoapod：[https](https://github.com/jakemarsh/JMImageCache) ://github.com/jakemarsh/JMImageCache 。

我不知道如何使用它以及如何将 Objective-c 代码转换为 Ruby。

*这是 Objective-C 代码：*

```
UIImage *image = [[JMImageCache sharedCache] imageForURL:@"http://dundermifflin.com/i/MichaelScott.png" delegate:self]; 
```

*我试图像这样转换它，但它是错误的：*

```
image = JMImageCache.sharedCache(imageForURL:post.image_medium, delegate:self) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T17:38:57.120

尝试这个：

```
image = JMImageCache.sharedCache.imageForURL(post.image_medium, delegate:self) 
```

`imageForURL`是 on 的一个方法`sharedCache`，`sharedCache`返回一个对象，但是您向它发送参数就像它是一个方法一样。

# c++ - C ++：将变量从main外部的函数传递到main内部的函数调用中

> ID：13594515
> 
> 赞同：0
> 
> 时间：2012-11-27T22:43:07.740
> 
> 标签：c++

这是我正在研究的一个小硬币翻转程序。我正在尝试从函数**promptUser(); 传递一个变量；**翻转**币（）；**. 我知道您可以在主函数中创建一个局部变量，但我想将提示组织成函数。

有没有办法从**promptUser();传递****flipCount**值？**flipCoin()**的函数；功能？

 ****我在谷歌上花了一些时间寻找一种方法来做到这一点（如果有办法的话），但我认为我无法正确表达我想要做的事情，或者这不是它的方式完毕。但是，如果有人理解我想要达到的目标，或者为什么我不应该这样做，我将不胜感激。谢谢

```
#include <iostream>
#include <cstdlib>
#include <time.h>

// function prototype
void promptUser();
void flipCoin(time_t seconds);

// prefix standard library
using namespace std;

const int HEADS  = 2;
const int TAILS = 1;

int main(){

    time_t seconds;
    time(&seconds);
    srand((unsigned int) seconds);

    promptUser();
    flipCoin(seconds);
    return 0;
}

void promptUser(){
    int flipCount;
    cout << "Enter flip count: " << endl;
    cin >> flipCount;
}

void flipCoin(time_t seconds){
    for (int i=0; i < 100; i++) {
        cout << rand() % (HEADS - TAILS + 1) + TAILS << endl;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:46:18.860

只需返回`flipCount`到`main`，然后`main`将其作为参数传递给`flipCoin`.

```
int main() {
  // ...
  // Get the flip count from the user
  int flipCount = promptUser();
  // Flip the coin that many times
  flipCoin(seconds, flipCount);
  // ...
}

int promptUser() {
  int flipCount;
  cout "Enter flip count: " << endl;
  cin >> flipCount;
  // Return the result of prompting the user back to main
  return flipCount;
}

void flipCoin(time_t seconds, int flipCount) {
  // ...
} 
```

认为`main`是负责。第一个`main`命令“提示用户翻转次数！” 并且`promptUser`函数按照它的指示执行，将翻转次数返回给 main。然后`main`说：“现在我知道用户想要翻转多少次了……所以把硬币翻转那么多次！” 传递该号码以`flipCoin`执行工作。

```
main              promptUser      flipCoin
  |                   :               :
  |------------------>|               :
    "How many flips?" |               :
                      |               :
  |<------------------|               :
  |         3         :               :
  |                   :               :
  |---------------------------------->|
        "Flip the coin 3 times!"      |
                      :               |
  |<----------------------------------|
  |        <void>     :               :
  V
 END 
```****

# objective-c - iOS 6：从通知中心删除视图控制器

> ID：13594518
> 
> 赞同：1
> 
> 时间：2012-11-27T22:43:13.280
> 
> 标签：objective-c, notifications, ios6, automatic-ref-counting, dealloc

在 iOS 6 应用程序中，我有一些视图控制器被添加为具有默认通知中心的观察者。它们被添加到`viewDidLoad`方法中是因为我希望控制器即使不在顶部也能接收通知。

很多人建议在`dealloc`方法中删除观察者。但是，在添加和删除观察者时，我一直在记录消息`NSLog()`，并且看起来`dealloc`从未调用过（我正在使用 ARC）。

与人们的想法相反，该`viewDidUnload`方法不是一个选项，因为在 iOS 5 中它只在内存不足的情况下被调用，而在 iOS 6 中它根本不被调用。

实际上似乎没有办法做文档要求的事情！顺便说一句，到目前为止，我的应用程序还没有崩溃，即使控制器被多次添加并且（显然）从未被删除。

注意：到目前为止，我只使用模拟器进行测试；是否有可能`dealloc`在实际设备中被调用，但在模拟器中却没有？或者只是没有出现的呼吁`NSLog()`（尽管它出现在其他任何地方）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:49:49.773

即使在 arc 中，也会调用 dealloc。您不能在 arc 中调用 [super dealloc]，但如果您的视图控制器正在被释放，则应该调用 dealloc。但是，如果你发现它真的很难管理，你为什么不在 viewWillAppear 中添加通知观察者然后在 viewWillDisappear 中删除它的情况。这样，您将在视图显示之前收到通知，并且当视图未显示时，它可能会被释放，因此在 viewWillDisappear 中删除观察者不会太麻烦。但是，肯定会调用足够多的 dealloc 并且是这样做的好地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T22:34:41.547

@NSProxy 是正确的，`dealloc`应该被调用。但是，我的某些控制器没有调用它。原因如下：

视图控制器 A 正在连接到控制器 B。在`prepareForSegue`中，控制器 A 正在创建一个包含对控制器 B（目标控制器）的引用的块。由于块由控制器 A 持有（它是家庭控制器从未离开过），并且块一直持有 B，控制器 B 从未被释放。

我将块中对 B 的引用更改为弱指针，并且当 B 的视图消失时调用了*voilà 。*`dealloc`这个故事的寓意是，你需要非常小心你在属于一个存在的类的块中引用的内容。

这仍然给我留下了一个谜：我仍然不知道为什么我的家庭控制器`dealloc`永远不会被调用，即使通过单击主页按钮退出应用程序或在模拟器中停止它也是如此。没有块指的是家庭控制器，因此在某处必须有其他东西在控制控制器。

# macos - 无法在 OS X Mountain Lion 上安装 Mono

> ID：13594520
> 
> 赞同：2
> 
> 时间：2012-11-27T22:43:28.193
> 
> 标签：macos, mono, osx-lion

我正在尝试在 Mac OS X 10.8.2 Mountain Lion 上安装 Mono 框架 MRE 2.11.4。当我双击下载的包文件时，我收到令人抓狂的消息“无法打开“MonoFramework - MRE-22.11.4.macos10.xamarin.x86.pkg”，因为它来自身份不明的开发人员。好的，现在呢？如何在我的 Mac 上安装它？谢谢阅读。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T22:45:41.547

命令单击它以打开上下文菜单并选择“打开”。下一个对话框将为您提供运行它的机会。这是绕过“Gatekeeper”保护的[官方方式。](http://support.apple.com/kb/HT5290)

# ruby - 如何优化这种 ruby 方法？它将查询结果解析为数组。

> ID：13594529
> 
> 赞同：0
> 
> 时间：2012-11-27T22:43:48.747
> 
> 标签：ruby, ruby-on-rails-3

这是我所拥有的：

```
def existing_photos
  @existing_photos = Array.new
  event.photos.each do |ep|
    @existing_photos << URI.unescape(ep.dropbox_path.split('/').last) rescue []
  end
  @existing_photos
end 
```

它从数据库查询中返回一个文件名数组。我敢肯定有一种更像红宝石的方式来做到这一点。

我也有一个类似的方法，它对 dropbox-api`ls`结果做同样的事情。

```
def all_photos
  @all_photos = Array.new
  @dropbox_files.each do |dbf|
    @all_photos << dbf.path.split('/').last
  end
  @all_photos
end 
```

我认为也应该优化。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T23:00:44.277

我可能会这样做...

```
def existing_photos
  event.photos.map { |ep|
    URI.unescape(ep.dropbox_path.sub(%r{.*/}, '') rescue nil
  }.compact
end 
```

获取`event.photos`类似于数组的内容并使用块将其映射以将其转换为您想要的内容。最后压缩它以处理 nil 情况。的使用`sub`只是一种偏好，可能比分割路径和选择最后一个元素更快（但您可能需要计时查看）。

# typescript - 如何存储对构造函数的引用？

> ID：13594530
> 
> 赞同：3
> 
> 时间：2012-11-27T22:43:48.857
> 
> 标签：typescript

演示相关行为的示例代码：

```
export class NodePool {
    private tail: Node;
    private nodeClass: Function;
    private cacheTail: Node;

    constructor(nodeClass: Function) {
        this.nodeClass = nodeClass;
    }

    get(): Node {
        if (this.tail) {
            var node = this.tail;
            this.tail = this.tail.previous;
            node.previous = null;
            return node;
        } else {
            return new this.nodeClass();
        }
    }
} 
```

示例的第 17 行（返回新......）导致编译器抱怨：
“函数”类型的值不是新的。

将任意类的构造函数存储在变量中以便我以后实例化它的正确方法是什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T22:59:59.047

您可以使用类型文字来指定可以新建的对象。这也具有增加类型安全性的优点：

```
export class NodePool {
    private tail: Node;
    private cacheTail: Node;

    constructor(private nodeClass: { new(): Node; }) {
    }

    get(): Node {
        if (this.tail) {
            var node = this.tail;
            this.tail = this.tail.previous;
            node.previous = null;
            return node;
        } else {
            return new this.nodeClass();
        }
    }
} 
```

* * *

```
class MyNode implements Node {
    next: MyNode;
    previous: MyNode;
}

class NotANode {
    count: number;  
}

var p1 = new NodePool(MyNode);   // OK
var p2 = new NodePool(NotANode); // Not OK 
```

# javascript - 无法设置未定义的属性 - JavaScript 中的全局对象和命名空间

> ID：13594531
> 
> 赞同：1
> 
> 时间：2012-11-27T22:43:51.903
> 
> 标签：javascript, namespaces, window, global-variables, globalization

我正在使用附加到窗口的变量：

`window.App`

作为我的应用程序中其余变量的参考点。但是，当我尝试这样做时：

```
window.App = {};

App.Views.User.Login = /* Login View Instance */; 
```

它会抱怨`Views`没有被定义。这在大多数情况下都很好，因为我可以预定义`App.Views, App.Models, App.Collections`等。

但是，当我们进入并不总是需要的子模块（`App.Views.User`）时，我希望在需要时加载它......

以下是唯一的选择吗？

```
if( ! App.Views.User ) { App.Views.User = {}; };

App.Views.User.Login = /* Login View Instance */; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:55:56.080

我会像这样开始你的子模块：

```
App.Views.User = App.Views.User || {};
App.Views.User.Login = new Backbone.Marionette.ItemView.extend({}); 
```

只比你已经拥有的干净一点，但这通常是你所做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:36:44.557

就像是：

```
namespace("myapp.mymodule.submodule.component",{}); 
```

在哪里：

```
function namespace (ns, module, optional_root) {
    var root = optional_root || window,
        array = ns.split("."),
        name = "",
        component_name = array.pop(),

        i = 0, l = array.length;

    for (; i < l; i += 1) {
        name = array[i];
        root[name] = root[name] || {};
        root = root[name];
    }

    root[component_name] = module;
} 
```

这应该允许您编写：

```
namespace("Appname.module.component", {}); 
```

函数期望找到的位置`window.Appname`，或类似：

```
namespace("module.component", function(){}, Myapp); 
```

如果它不存在，则通过定义`module`in来告诉它开始。`Myapp`

唯一的缺点是该函数必须在加载模块之前存在。

# iced-coffeescript - 为什么冰咖啡脚本会发出警告：抛出异常时过度使用延迟

> ID：13594537
> 
> 赞同：3
> 
> 时间：2012-11-27T22:44:04.957
> 
> 标签：iced-coffeescript

冰咖啡脚本中的“过度使用延迟”警告是什么意思？当我在代码中抛出未捕获的错误时，似乎会发生这种情况。我怎样才能让错误冒泡，因为我需要它是单元测试的未捕获错误。例如，如果我的 getByName 方法抛出错误，它会冒出冰咖啡脚本警告而不是冒泡异常。

```
await Profile.getByName p.uname, defer(err, existingUser)
return done new errors.DuplicateUserName(), 409 if existingUser isnt null
return done new Error("error in looking up user name " + err), 500 if err 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T21:13:44.247

`defer`多次调用 生成的回调时会生成此错误。在您的情况下，可能是`Profile.getByName`两次（或更多）调用其回调。这个警告几乎总是表明我的经验有错误。

如果您从 Rendezvous 创建回调并明确将其设为“多”回调，则可以禁用此警告。否则，只有让 return from`defer`给你一个一次性回调才有意义。

更多信息在这里：[https ://github.com/maxtaco/coffee-script/blob/iced/iced.md#icedrendezvousidimultidefer-slots](https://github.com/maxtaco/coffee-script/blob/iced/iced.md#icedrendezvousidimultidefer-slots)

关于术语的一点说明：在 IcedCoffeeScript 中，生成的回调`defer`在错误消息和文档中称为“延迟”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-30T10:43:58.490

在 Max 的回答之上，延续样式编程的适当用法应该是替换一次性回调，而不是重复回调。所做的只是等待其所有`await`延期完成，以便继续前进。以下示例使用`node.js`'`fs`模块读取大文件将重现此错误：

```
toread = process.argv[2]
fs = require 'fs'
rs = fs.createReadStream toread
await rs.on 'data', defer content
console.log "content: #{content}" 
```

现在用一个巨大的文本文件运行这个脚本。由于由于`data`大文件内容不适合缓冲区，事件将多次触发，因此它会多次触发生成的延迟回调，从而给出相同的错误。

```
<partial file contents...>
ICED warning: overused deferral at <anonymous> (C:\Users\kk\3.coffee:4)
ICED warning: overused deferral at <anonymous> (C:\Users\kk\3.coffee:4)
ICED warning: overused deferral at <anonymous> (C:\Users\kk\3.coffee:4)
... 
```

在这种情况下，使用不完整是错误`await/defer`的。`content`这正是 Max 提到此错误的存在通常表示代码错误的原因。事实上，IMO 它应该抛出一个错误，而不是一个可以静音的警告。

# matlab - 基于矩阵值的颜色

> ID：13594540
> 
> 赞同：0
> 
> 时间：2012-11-27T22:44:08.347
> 
> 标签：matlab, octave

我对 Matlab/octave 很陌生，但我习惯于使用 R。所以我想做的是以下内容。我想绘制我的 t.test 结果（y 值）与 t.test 差异（x 值）。很简单，我确实用 R 获得了这些数据，但我想用 Matlab 绘图。问题是点的颜色应该根据某一列中的值而变化。所以基本上它是p值。所以我得到了 yx 和 p 值的三列。

我缺少的是 R 中的 ifelse 函数。

所以也许：

```
if [:,3]<0.05
     a='red';
elseif [:,3]<0.01
      a='green';
else 
   a=  black;
end 
```

它应该更容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:11:19.140

我不确定我是否完全理解您的要求，但是如果您提前在方阵中设置数字，请尝试使用[`imagesc`](http://www.mathworks.co.uk/help/matlab/ref/imagesc.html)

例如，尝试做`imagesc(rand(5));`. 在这种情况下，`rand(5)`生成一个 5x5 的随机数矩阵。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:36:41.467

假设您有一个 n×3 数组，列 [difference,result,p-value] 称为`data`。然后，您可以`data`像这样绘制：

```
figure,hold on
idxK = data(:,3) > 0.05;
plot(data(idxK,1),data(idxK,2),'k')
idxG = data(:,3) < 0.01;
plot(data(idxG,1),data(idxG,2),'g')
plot(data(~(idxG|idxK),1),data(~(idxG|idxK),2),'r') 
```

或者，您可以使用`scatter`

```
colorIdx = data(:,3)>0.05 + data(:,3)>0.01 + 1;
figure 
scatter(data(:,1),data(:,2),[],colorIdx)
colormap([0 1 0;1 0 0;0 0 0]) 
```

# macos - FSEventStream：kFSEventStreamCreateFlagIgnoreSelf 标志有什么作用？

> ID：13594545
> 
> 赞同：3
> 
> 时间：2012-11-27T22:44:13.460
> 
> 标签：macos, fsevents

我正在使用 OSX FSEventStream 监视特定目录中的文件系统更改。[我在这里](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/FSEvents_Ref/Reference/reference.html)查看文档，发现描述了一个有趣的标志，kFSEventStreamCreateFlagIgnoreSelf。

根据使用此标志的文档，FSEvents 框架不会通知您“由当前进程触发的事件”。

这听起来很棒。这正是我想要的，但在实践中我发现我仍然会得到一些由当前进程触发的事件。

在我有限的测试中，如果监控过程创建一个新文件，或者重命名现有文件，一个事件仍然会被触发。虽然至少对现有文件的某些修改不会触发事件。

根据有限的文档（和标志的名称），我不希望当前进程触发任何事件。

所以我的问题有两个： - 这是预期的行为吗？我担心如果我指望它存在的行为，它可能是无意的，并且将来它可能会从我下面改变。

第二：——如果是，有谁知道在使用这个标志时我可以期望哪些事件仍然被传递。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T01:42:10.223

我注意到，使用此标志时，我在进程中所做的任何文件更改都不会作为事件发送给我。如果在那之后我没有收到任何外部事件，我最后记录的 eventId（下次创建流时使用）将早于我没有收到的事件，所以我会在下次开始我的流程时看到这些事件，在事件历史转储中。

很抱歉，这不是一个很好的答案，但我观察到的一些东西可能有助于解释你所看到的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-03T19:50:09.403

我还观察到设置`kFSEventStreamCreateFlagIgnoreSelf`标志没有效果。

但是，**同时**设置the`kFSEventStreamCreateFlagMarkSelf`和 the `kFSEventStreamCreateFlagIgnoreSelf`（使用按位 OR ( `|`) ）对我有用。我不再收到有关我的应用程序保存的文件（在我的情况下是文档）的通知。

`kFSEventStreamCreateFlagMarkSelf`自 OS X 10.9 起可用。

# javascript - 是否可以利用允许 PEMDAS 的 javascript 数学函数？

> ID：13594546
> 
> 赞同：8
> 
> 时间：2012-11-27T22:44:18.457
> 
> 标签：javascript, regex, math, exploit

我的页面上有一个表单字段，如果用户在其中键入一个简单的数学方程式，我想用解决方案替换该值。因此，如果用户`1 + 2`在字段中输入并点击，`enter`我将输入值替换为`3`.

目前我只评估与这个正则表达式匹配的方程：

```
/^[\d. \+/\*-]+$/ 
```

也就是说，如果整个字符串由数字、空格、加号、减号、乘号或除号字符组成。

**然后我像这样评估值：**

```
(new Function('try {var a = ' + val + '; return a;} catch(e) {return -1;}'))() 
```

**此表单字段可以由查询字符串参数预先填充，客户端将尝试执行它。又名潜在的攻击将是 mysite.com?inputVal=cookieStealingProgram**。我不希望用户能够链接到利用代码。

**我想在正则表达式中添加括号和指数，**以便用户可以输入`(1 + 2) / 3 ^ 5`例如。虽然我相当确定仅使用数字和运算符是不可能的，但我不确定带括号的情况。

我知道只使用字符组合`! [ ] + ( )`就可以创建一个[完全可执行的 javascript 程序](http://my.opera.com/QuHno/blog/brainfuck-like-javascript)。我还尝试在 Google 中搜索“javascript 漏洞利用字符”和各种组合，但这并不是一件容易找到的事情。

**我的具体问题是**`0-9 . + - / * ( ) ^`可以仅使用（允许空格字符）编写任意 javascript 程序吗？由于它有点开放式，如果几天后无法提供示例，我可以结束这个问题。

**我没有实现也没有制作解析器来做到这一点。这与问题无关**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T03:58:44.020

**答案 1.**仅使用您列出的符号，您无法制作标识符，因此唯一可能的程序是算术表达式。要回答狭窄的问题，答案是否定的。

然而 Stack Overflow 被许多人阅读，并且有一些密切相关的问题会改变类似情况下的后果。

**答案 2。**当代码库由一个知道自己在做什么的人维护时，最好使用答案 1。如果有人后来出现并希望用户（比如说）能够在其他地方象征性地引用价格，那么现在您有了标识符。如果以后的更改只是将字符添加到正则表达式，因为这是使其工作的最简单方法，那么您就有风险了。虽然我通常不喜欢试图防止愚蠢的语言功能，但这是一种为特定任务编写代码的特殊方式，似乎太容易被错误修改。

**答案 3.** JSON 解析器的原始参考实现实际上使用`eval()`，但它使用 JSON 语法验证器保护该语句，以确保输入格式正确。它在没有解析器的情况下执行此操作，而是通过一些巧妙编写的正则表达式来识别有效的子字符串并压缩它们。它有点类似于`reduce`语法导向翻译中的操作，但没有实际评估表达式。在目前的情况下，正则表达式替换，例如`/[0-9]+\+[0-9]+/0/`将原始加法重写为`0`. 为每个可能的减少写一个规则，并将它们全部放在一个循环中。当初始字符串长度与最终字符串长度相同时，循环终止。重写后的接受模式将是`/[0-9]+/`, 通常只是`0`.

**答案 4.**如果表达式的种类可能需要标识符，则使用解析器生成器通常是此类问题的最佳解决方案。在这种情况下，我不相信正则表达式重写系统能够正确维护。诚然，对于提出的问题来说，这似乎有点矫枉过正。

我建议将**答案 3**用于生产代码。

* * *

**答案 2 扩展。**最大的可识别风险（所有风险的一个子集）是有人将您添加`$`到可接受的字符列表中，因为它毕竟是一个价格字段，并且“用户已抱怨”。`$`是一个有效的标识符（通常分配为 jQuery），但也是`$0`，并且`$0()`是一个有效的函数调用。虽然这不是一个直接风险，但它**是**一个促成风险，例如，如果存在其他一些允许定义但不能调用 property 的安全缺陷`window.$0`。这样的代码将是一个安全缺陷，即使它本身不会导致安全漏洞。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:29:39.933

评论有一些有效的观点。

不过，要回答您的问题，请限制可以输入的方程式的大小。

这`document.getElementsByTagName("body")[0].style.display = "none";`

转换为：

```
[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]](([][[]]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+!![]+!![]+!![]+!![]+[])+([][[]]+[])[!+[]+!![]])+([][[]]+[])[!+[]+!![]+!![]]+([][[]]+[])[+!![]]+(!![]+[])[+[]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+([][[]]+[])[!+[]+!![]+!![]])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![ 
```

以上只是它变成的一小部分。总脚本为 48,000 个字符。Stack 甚至不让我全部发布

这与“功能齐全”的脚本一样基本，我怀疑任何用户都想输入一个甚至接近这个长度的方程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T23:33:41.603

`Eval`正如你所了解的，这是非常危险的。不必使用 eval 客户端（`JSON`对象）的现代浏览器逃生舱不会满足您的需求，因为您需要评估`JSON`不允许的表达式。

从好的方面来说，你真的只想允许几个运算符`+ - / * ^`和括号，这不是一种非常复杂的表达语言。

与其尝试使用正则表达式来验证 eval 的输入，我建议您只需在 JavaScript 客户端或您选择的服务器端语言中实现表达式评估器。

谷歌搜索会发现很多不同的功能略有不同，或者您可以将其作为学习练习来滚动自己的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-29T03:28:02.673

问题的答案是**否定**的，不可能使用给定的输入（包括括号）创建任意程序。为了创建程序，您必须能够创建字符串。最接近这些限制的是`NaN`，`Infinity`但是如果不允许使用引号或大括号，就不可能将其中任何一个转换为字符串。

tl; dr 你被阻止了，因为你不能制作字符串。

# winrt-xaml - 如何将当前日期设置为 XAML (WinRT) 中的属性？

> ID：13594548
> 
> 赞同：0
> 
> 时间：2012-11-27T22:44:26.910
> 
> 标签：winrt-xaml

我`MaxValue`在一个控件上有一个属性`DataTemplate`，我只想设置为当前日期。我真的不希望我的对象上的属性绑定到返回当前日期的数据模板，因为这样的属性在逻辑上不属于那里。在不支持的 WinRT 中如何做到这一点`x:Static`？

```
<DataTemplate x:Name="DateTimeTemplate">
...
        <Input:RadDatePicker MaxValue="{Binding ?}"/>
...
</DataTemplate> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T13:32:03.603

`MaxValue`通过像这样设置后面的代码来解决它：

```
<DataTemplate x:Name="DateTimeTemplate">
...
    <Input:RadDatePicker Loaded = "DatePickerLoaded"/>
...
</DataTemplate>

//Event handler
private void DatePickerLoaded(object sender, RoutedEventArgs e)
{
   ((DatePicker)sender).MaxValue = System.DateTime.UtcNow;
} 
```

# c++ - 基类的类型不完整

> ID：13594549
> 
> 赞同：0
> 
> 时间：2012-11-27T22:44:33.353
> 
> 标签：c++, inheritance

我有一个`Point`从中继承的基类`Point3D`。但是，由于某种原因，类`Point`必须始终返回`Point3D`操作`add`，所以我将它包含在我的包含中。

这是我的课`Point`：

```
#ifndef POINT_H
#define POINT_H

#include "Point3D.hpp"

class Point{

  public:
    Point(double, double, double);

    void print() const;
    Point3D add( const Point& );

  protected:
    double mX;
    double mY;
    double mZ;

};

#endif 
```

在我的课堂`Point3D`上，我知道我还没有遇到`Point`第一次调用我的时间的定义（因为`Point3D`包含在`Point`标题中），所以我定义`class Point;`了，然后我定义了我将使用的部分`Point`：

```
#ifndef POINT3D_H
#define POINT3D_H

#include <iostream>
#include "Point.hpp"  // leads to the same error if ommitted

class Point;    

class Point3D : public Point {

  public:
        Point3D(double, double, double);
        void print() const ;
        Point3D add(const Point&);
};

#endif 
```

但是，这是行不通的。当我编译它时，它给了我以下错误：

```
./tmp/Point3D.hpp:9:24: error: base class has incomplete type
class Point3D : public Point {
                ~~~~~~~^~~~~
./tmp/Point3D.hpp:7:7: note: forward declaration of 'Point'
class Point;
      ^
1 error generated. 
```

[这里](https://stackoverflow.com/questions/12680287/base-class-has-incomplete-type-error)的问题是`#include "Point.hpp"`要从我的`Point3D`声明中删除包含。然而，这样做会导致相同的结果，而且我认为头卫基本上会完成同样的事情。

我正在用clang编译。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T22:52:47.783

您不能从不完整的类型继承。您需要按如下方式构建代码：

```
class Point3D;

class Point
{
    // ...
    Point3D add(const Point &);
    // ...
};

class Point3D: public Point
{
    // ...
};

Point3D Point::add(const Point &)
{
    // implementation
} 
```

函数返回类型可能不完整，这就是您的类定义`Point`这样工作的原因。

我相信您可以弄清楚如何将其拆分为头文件和源文件。（比如前两部分可以进入`Point.hpp`，第三部分可以进入`Point3D.hpp`includes `Point.hpp`，最后的实现可以进入`Point.cpp`includes`Point.hpp`和`Point3D.hpp`.）

# popcornjs - 使用 popcorn.js 时更改 Vimeo 上的嵌入选项

> ID：13594552
> 
> 赞同：0
> 
> 时间：2012-11-27T22:45:06.033
> 
> 标签：popcornjs

我的问题很简单。您能否更改通过 Popcorn.js 播放的 vimeo 视频的嵌入选项（例如，隐藏标题、您的头像等）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T09:09:15.283

是的，只要您使用新的 Vimeo“包装器”。（从 Popcorn 1.4 开始，原始播放器模块已被弃用。）

包装在这里：

[https://github.com/mozilla/popcorn-js/blob/master/wrappers/vimeo/popcorn.HTMLVimeoVideoElement.js](https://github.com/mozilla/popcorn-js/blob/master/wrappers/vimeo/popcorn.HTMLVimeoVideoElement.js)

您还需要先包含[此文件](https://github.com/mozilla/popcorn-js/blob/master/wrappers/common/popcorn._MediaElementProto.js)。

默认情况下，Vimeo 包装器禁用标题、署名和肖像。

**编辑**：您只需要来自 popcorn-js 存储库的三个脚本，并按以下顺序将它们包含在脚本标签中：

1.  [爆米花.js](https://github.com/mozilla/popcorn-js/blob/master/popcorn.js)
2.  [popcorn._MediaElementProto.js](https://github.com/mozilla/popcorn-js/blob/master/wrappers/common/popcorn._MediaElementProto.js)
3.  [HTMLVimeoVideoElement.js](https://github.com/mozilla/popcorn-js/blob/master/wrappers/vimeo/popcorn.HTMLVimeoVideoElement.js)

创建一个用于放置视频的容器元素：

```
<div id="video"></div> 
```

实例化视频包装器和爆米花：

```
var video = Popcorn.HTMLVimeoVideoElement('#video');
video.src = 'vimeo url goes here';
var popcorn = Popcorn(video); 
```

# c++ - C2248：无法访问在类中声明的私有成员

> ID：13594556
> 
> 赞同：1
> 
> 时间：2012-11-27T22:45:27.273
> 
> 标签：c++, class, private, member

我们正在尝试使用 VS2005 编译应用程序，并且收到以下错误消息：

错误 C2248：“palo::bytecode_generator::WM_OPCODES”：无法访问在类“palo::bytecode_generator”c:\users\administrator\desktop\htbase\development\palo_server_988\server_export\source\library\virtualmachine\VirtualMachine 中声明的私有枚举.h 199

这是一段代码：

```
struct machine_state {
    EPath path;
    ERule* rule;
    Value defValue;
    Status defStatus;
    uint8_t is_base;
    Bytecode * pc;
    Value* sp_dbl;
    string* sp_str;
    bytecode_generator::WM_OPCODES return_pos;
}; 
```

关于如何解决这个问题的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:47:04.823

好吧，显然`WM_OPCODE`枚举类型是在私有部分中定义的`bytecode_generator`。将其移至公共部分或课外。

# php - 点击按钮加载页面

> ID：13594558
> 
> 赞同：0
> 
> 时间：2012-11-27T22:45:30.627
> 
> 标签：php, jquery, html

如何在页面加载时点击某个按钮？

```
<script src="http://code.jquery.com/jquery-latest.js"></script>

<script>
$("#submit").click(function() {
  $("#submit").click();
});
</script>

</head>

<body>

<form action="Untitled-9.php" method="post">
<input type="text" name="name" value="dsa"/>
<input type="submit" name="submit" value="Register" />
</form>

<?php

$name = $_POST['name'];

echo $name;

?>

</body> 
```

这是我拥有的代码，我希望在加载页面时自动按下“注册”按钮

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:47:27.107

```
<?php if ($_POST["name"] == "") { ?>

<script type="text/javascript">
    $(document).ready(function() {
        $("input[name=submit]").click();
    });
</script>

<?php } else {

    echo $_POST["name"];

} ?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:47:52.460

试试这个：`$("#submit").trigger('click');`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:47:50.960

```
<script>
    $(document).ready(function() {
      $("#submit").click();
  });
</script> 
```

并将 id 放在：

```
<input type="submit" name="submit" value="Register" id="submit/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T22:55:14.550

```
<script type="text/javascript">
  $(function(){
     $("#submit").trigger('click');
  });
</script> 
```

会像其他人建议的那样工作

你也可以使用

```
<script type="text/javascript">
  $(function(){
     $("form").submit();
  });
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-22T04:37:19.497

```
<script>
function aclick(){
document.getElementById("submit").click();	
}
</script>
```

```
<body onLoad="aclick();">
<form action="name.php" method="post" >
<p >
<label>Email</label><br />
<input type="text" name="number" value="<?php echo $row['Mobileno']; ?>" /><br />
<label>Message</label><br />
<textarea name="msg">  </textarea><br /></p>

<input type="submit" name="submit" value="For Old Student Next to Reciepent" style="background-color:#006; color:#FFF;" id="submit" />
</form>

</body>
```

# java - Java 调用兄弟类的方法

> ID：13594560
> 
> 赞同：2
> 
> 时间：2012-11-27T22:45:37.970
> 
> 标签：java

再会，

我已经尝试过很好的谷歌搜索，甚至一些阅读，但不完全确定如何进行。这是问题所在：

当我调用`duplicate()`java.nio.Buffer 的任何实现时，我用原始缓冲区设置的字节顺序`buf.order(ByteOrder.LITTLE_ENDIAN)`不会被保留。这是个问题。所以我开始创建一个静态方法，它允许我像这个例子一样执行以下操作：

```
public static ByteBuffer endianPreservingDuplicate(ByteBuffer b){
    ByteOrder holder = b.order();
    ByteBuffer ret = b.duplicate();
    ret.order(holder);
    return ret;
} 
```

这可行，但是有没有任何实际的方法可以做到这一点（可能是泛型？）而不必为每种类型（ByteBuffer、FloatBuffer、IntBuffer 等）实现这个函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:57:40.497

`duplicate`据编译器所知，这些不同类的方法之间没有任何关系；它们不是由任何超类型（超类或接口）定义的。因此，它们唯一的共同点在于它们的方法签名（名称和参数），而访问它的唯一方法是通过反射。同样对于`order`. 这是可能的，但会非常混乱，并且会干扰您的 IDE 帮助您查看代码在做什么的能力；这可能不值得。

此外，还有一个更大的问题：您的方法取决于`ByteBuffer#order(ByteOrder)`设置字节顺序；但是`FloatBuffer`，`IntBuffer`甚至*没有*这样的方法。他们确实有一个`order()`不带参数并返回它们的字节顺序的，但他们没有一个`order(ByteOrder)`接受字节顺序并采用它的。（这是因为它们的字节顺序并不是它们自己的：如果它们是字节缓冲区的包装器，那么它们使用它的字节顺序，如果它们是数组的包装器，它们使用系统的字节顺序。）

所以好消息是。. . 您不需要为每种类型都实现此方法，因为您不能。:-P

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T23:03:27.637

您可以结合使用泛型和反射，但这很丑：

```
public static <T extends Buffer> T endianPreservingDuplicate(T b) throws Exception {
    Class<?> clazz = b.getClass();
    Method getOrder = getMethod(clazz, "order");
    ByteOrder orderTemp = (ByteOrder) getOrder.invoke(b);
    Method duplicate = getMethod(clazz, "duplicate");
    @SuppressWarnings("unchecked") // cast is safe
    T copy = (T) duplicate.invoke(b);
    Method setOrder = getMethod(clazz, "order", ByteOrder.class);
    setOrder.invoke(copy, orderTemp);
    return copy;
}

private static Method getMethod(Class<?> clazz, String name, Class<?>...params) throws NoSuchMethodException {
    try {
        Method method = clazz.getDeclaredMethod(name, params);
        method.setAccessible(true);
        return method;
    } catch (NoSuchMethodException e) {
        Class<?> superclass = clazz.getSuperclass();
        if (!superclass.equals(Buffer.class)) {
            return getMethod(superclass, name, params);
        } else {
            throw new NoSuchMethodException("no " + name + " method");
        }
    }
} 
```

`order()`如果没有或作为参数`duplicate()`传递的 Buffer 实现，它将抛出异常。`b`

最好的选择是为每种缓冲区类型创建单独的方法。

部分归功于[ruakh](https://stackoverflow.com/users/978917/ruakh)审查​​代码并提出更新建议。

# android - 尝试为事件设置时区

> ID：13594567
> 
> 赞同：6
> 
> 时间：2012-11-27T22:46:02.593
> 
> 标签：android, google-calendar-api

就像标题所说，我正在创建一个事件，它似乎没有设置正确的时区......我做错了什么？作为参考，我使用 12:00 PM 作为开始时间。开始时间显示正确，但时区显示不正确。我不想将时间转换为用户/设备的时区。

```
 Calendar cal = new GregorianCalendar();         
        cal.setTime(tDate);

        Intent intent = new Intent(Intent.ACTION_EDIT);
        intent.setType("vnd.android.cursor.item/event");
        intent.putExtra("beginTime", cal.getTimeInMillis());
        intent.putExtra(Events.ALL_DAY, false);
        intent.putExtra(Events.TITLE, "Title goes here");
        intent.putExtra(Events.EVENT_LOCATION, "Los Angeles");
        intent.putExtra(Events.EVENT_TIMEZONE, "America/Los_Angeles");
        intent.putExtra(Events.DESCRIPTION, "Test");
        startActivity(intent); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-20T18:57:57.030

添加事件的意图方法（如此[处](http://developer.android.com/guide/topics/providers/calendar-provider.html#intent-insert)所述）似乎不支持额外的时区 - 至少在给出的示例中不支持。以下是基于该示例的一些指针：

*   您应该使用该`Intent.ACTION_INSERT`操作
*   `setData()`您应该使用常量[CalendarContract.Events.CONTENT_URI](http://developer.android.com/reference/android/provider/CalendarContract.Events.html#CONTENT_URI)通过 设置 URI
*   您应该使用常量[CalendarContract.EXTRA_EVENT_BEGIN_TIME](http://developer.android.com/reference/android/provider/CalendarContract.html#EXTRA_EVENT_BEGIN_TIME)而不是`"beginTime"`
*   您应该使用常量[CalendarContract.EXTRA_EVENT_ALL_DAY](http://developer.android.com/reference/android/provider/CalendarContract.html#EXTRA_EVENT_ALL_DAY)而不是`Events.ALL_DAY`

如果您需要设置时区，您可以使用 ContentResolver 来添加事件，而无需使用 intent 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-17T19:34:37.017

这可能会迟到，但它现在可以工作（使用 测试`compileSdkVersion 31`）。

```
Intent createEventIntent = new Intent(Intent.ACTION_INSERT)
    .setData(CalendarContract.Events.CONTENT_URI)
    .putExtra(CalendarContract.Events.EVENT_TIMEZONE, "America/Cayman")
    ...; 
```

*   要查看可用时区列表：`TimeZone.getAvailableIDs()`。
*   要使用当前时区：`TimeZone.getDefault().getID()`.

[1][使用意图插入事件](https://developer.android.com/guide/topics/providers/calendar-provider#intent-insert)

# json - 如何将 JSON 加载到 TreeStore？

> ID：13594571
> 
> 赞同：1
> 
> 时间：2012-11-27T22:46:14.420
> 
> 标签：json, extjs, extjs4, store, treepanel

我想将 JSON 文件加载到 TreeStore 以在 TreePanel 中使用。如果我对树进行硬编码，我可以加载带有值的商店并显示它，但是当我尝试从 JSON 文件加载它时，它不会在树中显示任何内容。这是我的代码：

JSON 文件：exampleDoc.json

```
{
    "success": true, 
    "Root": [{
        "name": "Bookmark 1",
        "leaf": true,
        "element": "1"
    }, {
        "name":"Bookmark 2",
        "leaf": true,
        "element": "2"
    }, {
        "name":"Bookmark 3",
        "leaf": true,
        "element": "3"
    }]
} 
```

这是我的模型

```
Ext.define('bkmark', {
    model: 'Ext.data.Model',
    fields: ['name', 'element']
}); 
```

这是我的树店

```
var store = Ext.create('Ext.data.TreeStore', {
    model: 'bkmark',
    proxy: {
        type: 'ajax',
        url: 'exampleDoc.json',
        reader: {
            type: 'json'
        }
    }
}); 
```

这是我的树面板

```
var treePanel = Ext.create('Ext.tree.Panel', {
    title: 'Bookmarking',
    width: 225,
    height: 150,
    store: store,
    rootVisible: false,
    region: 'west',
    collapsible: true,
}); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T23:18:22.537

代理`reader`有一个名为 的配置`root`，它定义了当您拥有顶级字段（如`success`.

由于您的数据在 下`"Root"`，您应该像这样定义您的阅读器：

```
reader: {
    type: 'json',
    root: 'Root'
} 
```

或者，您可以使用默认值`root`，即`data`. 因此，在您的 json 中更改`"Root"`为`"data"`.

顺便说一句，定义模型的标准方法是：

```
Ext.define('bkmark', {
    extend: 'Ext.data.Model',
    fields : ['name', 'element']
}); 
```

# c# - 加载的方法与调用其他方法无关

> ID：13594575
> 
> 赞同：0
> 
> 时间：2012-11-27T22:46:23.450
> 
> 标签：c#, asp.net-mvc-3

例如我有以下控制器 `example.com/controller/`

有以下三种方法：

*   `example.com/controller/method1`
*   `example.com/controller/method2`
*   `example.com/controller/validate`

无论调用什么方法，我都希望 validate 运行，我想确保 validate 运行，因为它包含验证客户端是否设置了有效的 cookie 或从页面启动它们的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:49:33.347

我认为您需要[ActionFilter](http://msdn.microsoft.com/en-us/library/system.web.mvc.actionfilterattribute%28v=vs.98%29.aspx)来进行验证。创建您的自定义验证过滤器属性，覆盖其[OnActionExecuting](http://msdn.microsoft.com/en-us/library/system.web.mvc.actionfilterattribute.onactionexecuting%28v=vs.98%29.aspx)方法（进行 cookie 验证），并将属性应用于控制器（或特定操作）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T22:51:02.720

我建议查看操作过滤器：

> 动作过滤器是一个属性，您可以将其应用于控制器动作——或整个控制器——修改动作的执行方式。ASP.NET MVC 框架包括几个动作过滤器：
> 
> *   OutputCache – 此操作过滤器将控制器操作的输出缓存指定的时间量。
> *   HandleError – 此操作过滤器处理控制器操作执行时引发的错误。
> *   授权 - 此操作过滤器使您能够限制对特定用户或角色的访问。
> 
> 您还可以创建自己的自定义操作过滤器。例如，您可能希望创建自定义操作过滤器以实现自定义身份验证系统。或者，您可能想要创建一个操作过滤器来修改控制器操作返回的视图数据。

[http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/understanding-action-filters-cs](http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/understanding-action-filters-cs)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:52:19.273

根据您想要执行此检查的时间，您可以将其放在控制器的构造函数中，或者从基本控制器（通常是 AsyncController）覆盖 OnActionExecuting *。*

如果您想在每个控制器上运行此检查，那么我建议您创建一个 ControllerBase 类，然后您的其他控制器可以从该类继承。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T15:04:05.197

您应该将验证代码从操作移动到自定义授权过滤器。与操作过滤器不同，授权过滤器是首先运行的过滤器，因此您应该将它们用于此类安全检查。

已经有一个内置的授权过滤器`Authorize`做得不错，如果你想创建一个自定义的，我建议扩展`Authorize`属性并覆盖所需的方法。该`Authorize`属性做了一些解决方法以避免缓存问题，这就是我推荐它的原因。

# google-app-engine - 无法在 google appengine 的实时实例上写入 cookie

> ID：13594577
> 
> 赞同：1
> 
> 时间：2012-11-27T22:46:42.630
> 
> 标签：google-app-engine, python-2.7, django-1.2

我一直在努力将我们的一个应用程序转换为线程安全的。在本地开发应用服务器上进行测试时，一切都按预期工作。但是，在部署应用程序时，似乎没有正确写入 Cookie？

在日志中有一个没有堆栈跟踪的错误：

```
2012-11-27 16:14:16.879 Set-Cookie: idd_SRP=Uyd7InRpbnlJZCI6ICJXNFdYQ1ZITSJ9JwpwMAou.Q6vNs9vGR-rmg0FkAa_P1PGBD94; expires=Wed, 28-Nov-2012 23:59:59 GMT; Path=/ 
```

这是有问题的代码块：

```
# area of the code the emits the cookie
cookie = Cookie.SimpleCookie()
if not domain:
    domain = self.__domain
self.__updateCookie(cookie, expires=expires, domain=domain)
self.__updateSessionCookie(cookie, domain=domain)
print cookie.output() 
```

Cookie 辅助方法：

```
def __updateCookie(self, cookie, expires=None, domain=None):
    """
    Takes a Cookie.SessionCookie instance an updates it with all of the
    private persistent cookie data, expiry and domain.

    @param cookie: a Cookie.SimpleCookie instance
    @param expires: a datetime.datetime instance to use for expiry
    @param domain: a string to use for the cookie domain
    """

    cookieValue = AccountCookieManager.CookieHelper.toString(self.cookie)
    cookieName = str(AccountCookieManager.COOKIE_KEY % self.partner.pid)

    cookie[cookieName] = cookieValue
    cookie[cookieName]['path'] = '/'
    cookie[cookieName]['domain'] = domain

    if not expires:
        # set the expiry date to 1 day from now
        expires = datetime.date.today() + datetime.timedelta(days = 1)

    expiryDate = expires.strftime("%a, %d-%b-%Y 23:59:59 GMT")
    cookie[cookieName]['expires'] = expiryDate

def __updateSessionCookie(self, cookie, domain=None):
    """
    Takes a Cookie.SessionCookie instance an updates it with all of the 
    private session cookie data and domain.

    @param cookie: a Cookie.SimpleCookie instance
    @param expires: a datetime.datetime instance to use for expiry
    @param domain: a string to use for the cookie domain
    """

    cookieValue = AccountCookieManager.CookieHelper.toString(self.sessionCookie)
    cookieName = str(AccountCookieManager.SESSION_COOKIE_KEY % self.partner.pid)

    cookie[cookieName] = cookieValue
    cookie[cookieName]['path'] = '/'
    cookie[cookieName]['domain'] = domain 
```

同样，正在使用的库是：

*   蟒蛇 2.7
*   姜戈 1.2

关于我可以尝试什么的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T00:53:44.307

我看到了创建 cookie 的代码，但你真的将它附加到任何地方的响应中吗？

你应该在某处有一个 response.set_cookie() 。

# python - 如何使用正则表达式从文件中提取文本？

> ID：13594578
> 
> 赞同：2
> 
> 时间：2012-11-27T22:46:51.690
> 
> 标签：python, regex, text

嗨，我正在寻找一种使用正则表达式用 Python 提取文本文件的一部分的方法：这是我的代码：

```
 texfile=open("texte.txt", "r")
        for line in texfile:
            if re.match("^text(.*)", line):
               print line, 
```

我正在搜索单词 text 之后的文本，直到它到达段落末尾或到达空格时，但我的代码仅返回 1 行上的单词“text”之后的单词。

例如 ：

```
bla bla hhhhhhhh text bla blajjjjjjjjjjjjjjjjjjjjj
hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
ffff 
```

必须返回：

```
bla blajjjjjjjjjjjjjjjjjjjjj
hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh
ffff 
```

* * *

谢谢我尝试了你所有的代码，但没有人能像我想要的那样工作：我现在想简单地渲染它，提取遵循某个“文本”的流，直到它到达一个空行：

```
 text
    sssssssssssssssss
     ssssssss
    kkkk
    lllmmm

    kkkk

   ;must return 
    sssssssssssssssss
    ssssssss
    kkkk
    lllmmm
    ;because of the blank line 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T03:01:02.667

如果你想检测一个文件的一部分在多行上扩展，并且如果文件不是太大，那么通过一次检查一行来限制正则表达式的能力并不是一个特别好的方法。当文件可以被读取并完全放入 RAM 中时，最好使用正则表达式来分析它，将文本作为一个独特的整体来探索。

请注意，如果不使用标志，`'^'`则*表示“字符串的**开头”，如果使用此标志，则表示“行的开头”*。`re.MULTILINE`

 *顺便说一句，如果您使用该`match()`方法，则无需`"^"`在 RE 模式的开头添加，因为`match()`尝试从字符串的最开头进行匹配。

因此，这是一种按照您的需要分析整个文本的方法（我`splitlines(True)`用来获取字符串**ss**中的行列表，此列表模拟文件°：

```
import re

ss = """   first line
    bli bli hhhhhhhh TEXT bla blajjjjjjjjj
hhhhhhhh  VVVVV
ZZZZZZ
    tttt
bolo bolo TEXTrumunu and badad
yyyyyyyyyyyyyyyy
kkkkkkkkkkk
jjjjjjjjjjjjjjj
   nnnn    uytr
      poiurrr
ahahahah bobobo
  ppppp TEXT aaaabbbbb cccccg    
      kmsms
TEXT fedex redex bidex
pududadi
A

no-whitespace-before-that
   hhrhezipo"""

regx = re.compile('TEXT *(.+(?<! )(?<!\r)(?:\n[^ ]+(?<!\n))?)')

for fnd in regx.findall(ss):
    print '\n'.join(map(repr,fnd.splitlines(True)))
    print '---------------------------------' 
```

结果：

```
'bla blajjjjjjjjj\n'
'hhhhhhhh'
---------------------------------
'rumunu and badad\n'
'yyyyyyyyyyyyyyyy\n'
'kkkkkkkkkkk\n'
'jjjjjjjjjjjjjjj'
---------------------------------
'aaaabbbbb cccccg'
---------------------------------
'fedex redex bidex\n'
'pududadi\n'
'A\n'
'\n'
'no-whitespace-before-that'
--------------------------------- 
```

.

如果文件很大并且不能仅在 RAM 中的一个块中收费，您可以执行以下操作：

```
import re

ss = """   first line
    bli bli hhhhhhhh TEXT bla blajjjjjjjjj
hhhhhhhh  VVVVV
ZZZZZZ
    tttt
bolo bolo TEXTrumunu and badad
yyyyyyyyyyyyyyyy
kkkkkkkkkkk
jjjjjjjjjjjjjjj
   nnnn    uytr
      poiurrr
ahahahah bobobo
  ppppp TEXT aaaabbbbb cccccg    
      kmsms
TEXT fedex redex bidex
pududadi
A

no-whitespace-before-that
   hhrhezipo"""

rigx = re.compile('TEXT *(.+\n?)')
li = []
for line in ss.splitlines(True):
    mat = rigx.search(line)
    if 'TEXT' in line:
        li.append(mat.group(1))
    elif ' ' in line and li:
        if not line.startswith(' '):
            li.append(line.split(' ')[0])
        li[-1] = li[-1].rstrip(' \r\n')
        print '\n'.join(map(repr,li))
        print '====================='
        li = []
    elif li:
        li.append(line) 
```

此代码给出与前一个相同的结果。你看它不那么简单。那是因为大文件更成问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T11:51:57.497

如果您没有被迫使用正则表达式，则可以使用它...

将文件加载为列表：

```
with open("texte.txt", "r") as fileInput:
    listLines = fileInput.readlines() 
```

获取包含您的关键字的行的索引，如果它多次存在您可能无法获得预期的结果，但这是一个简单的修复：

```
listIndex = [i for i, item in enumerate(listLines) if "text" in item] 
```

通过对列表进行切片，这是关键字后面没有空行的行：

```
lines = [line for line in listLines[listIndex[0]:] if line] 
```

您可能希望获得关键字后面的任何文本：

```
lineMatched = listLines[listIndex].split("text")[1].strip() 
```

& 打印结果：

```
print "\n".join([lineMatched] + lines if lineMatched else lines) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T23:10:37.300

这在 python3 中对我有用：

```
for line in texfile:
    x = re.search("(.*?)(text)", line)
    try:
        print (x.group(1))
    except:
        print(line) 
```*

# c++ - 命令行参数中的 Eclipse 和引号？

> ID：13594581
> 
> 赞同：6
> 
> 时间：2012-11-27T22:46:59.997
> 
> 标签：c++, eclipse

我有一些 C++ 代码期望它的命令行看起来像这样：

/path/to/exe -p:parameterName="[/path/to/a/file,/path/to/another/file]"

*包括*引号。它们可以是单引号或双引号，但它们必须存在。在 Eclipse 中，如果我设置命令行参数（调试配置/参数）并输入上面的命令行选项（减去 /path/to/exe），Eclipse 会吃掉引号。由于我在 Linux 上运行它，方括号给 shell 带来了痛苦，它甚至从未进入我的代码。

如果我这样设置命令行参数：

“这是引用的”

argv[1] 看起来像这样：

这是引用的

即没有引号。如果我这样设置命令行：

\"这是引用\"

我得到：

```
argv[1]: "this
argv[2]: is
argv[3]: quoted" 
```

如果我尝试将方括号放入其中，即使我试图逃避它们，也会让 shell 感到悲伤：

```
\"\[this is quoted\]\" 
```

如何告诉 Eclipse 完全按照我输入的方式获取命令行参数？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T17:00:39.003

我*想*我已经找到了一个解决方案 - 至少现在这已经连续好几次了。在 Eclipse 的 Arguments 选项卡中，在“Program arguments”字段中输入命令行参数，如下所示：

```
-p:parameterName="'[foo,bar]'" 
```

这变成：

```
-p:parameterName='[foo,bar]' 
```

在 gdb 的“设置参数”命令中。我在方括号表达式周围加上单引号，但这对我的应用程序来说很好。我不知道为什么这样做（我希望我这样做）或者为什么其他转义文本的方式失败了。

双引号和单引号的顺序很重要。如果您尝试将单引号放在外面，它会变成

```
set args -p:parameterName=\"[foo,bar]\" 
```

失败了。不知道如果需要双引号我会做什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-05T06:01:43.640

我解决了这个问题，所以现在有明确的规则来提供参数。您可以在此处详细了解此内容：

[https://bugs.eclipse.org/bugs/show_bug.cgi?id=474648](https://bugs.eclipse.org/bugs/show_bug.cgi?id=474648)

主要原则是 Run 和 Debug 必须表现相同，参数主要是程序接收的内容而不是 bash，如何提供参数的规则必须简单直观。完全避免规则是不可能的，因为当使用单个字符串来传达每个参数的结束位置时，一些特殊的标记是不可避免的。

因此，论点以下列方式起作用：

*   反斜杠后面的任何字符都按字面意思处理，并失去特殊含义。

*   引号之后和下一个匹配的引号（或 EOF）之前的任何字符都按字面意思处理，并失去特殊含义（单引号和双引号）。

*   空格（除非转义或在引号内）用作参数分隔符。

以前的行为几乎没有定义，因为类似的东西``date``会被 bash 替代，但行为并不总是与 bash 相同。这可能会破坏一些用户的 hacky 配置，但现在重写是微不足道的，而在必须通过各种转义引用组合的反复试验找到正确的字符串之前，“我需要一个、两个或四个反斜杠吗？”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T22:51:32.097

你已经试过了吗

```
"\"\[this is quoted\]\"" 
```

?

顺便说一句：这不是日食问题，而只是反映了外壳的行为。

# android - 方法参数的Android字节码分析

> ID：13594582
> 
> 赞同：4
> 
> 时间：2012-11-27T22:47:00.713
> 
> 标签：android, parameters, bytecode, dalvik, dex

我想分析 Android 字节码，并找到与方法参数相关的所有指令（对参数进行切片）。有人可以为此提供一些参考吗？任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:03:17.403

本文档详细描述了 Dalvik 字节码：

[http://source.android.com/tech/dalvik/dalvik-bytecode.html](http://source.android.com/tech/dalvik/dalvik-bytecode.html)

可能还感兴趣：

[http://source.android.com/tech/dalvik/dex-format.html](http://source.android.com/tech/dalvik/dex-format.html)

（这些曾经存在于源代码树的 dalvik/docs 目录中，但被“提升”了。）

您可以使用`dexdump`命令 with`-d`生成 DEX 文件的指令反汇编并对其进行处理。或者您可以自己处理 DEX 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T14:28:39.353

从 .class 文件生成字节码到 .dex 是使用工具 dx 完成的。

一旦你有了 example.dex 文件，你就会有很多工具，比如 dexdump、dedexer、baksmali 。反汇编命令如下。

dexdump -d 示例.dex

java -jar ddx.jar -d (使用 dedexer) [点击这里了解更多](http://dedexer.sourceforge.net/)

java -jar baksmali-0.93.jar -o <.dex 文件，通常是 classes.dex>（使用 baksmali）

我在互联网上找到的最好的资源是[这个](http://0xlab.org/~jserv/tmp/dalvik.pdf)

对于 dalvik 指令集，[请单击](http://www.netmite.com/android/mydroid/dalvik/docs/dalvik-bytecode.html)

对于操作码，[请单击](http://pallergabor.uw.hu/androidblog/dalvik_opcodes.html)

# php - 排除mysql查询结果

> ID：13594595
> 
> 赞同：0
> 
> 时间：2012-11-27T22:47:54.767
> 
> 标签：php, mysql, sql

这是我的桌子的图像：

![客户表](../Images/07d013c93ee49e2be7530e10ded42c17.png)

我想选择所有 class_id 不等于 48 的行，如下所示：

```
SELECT * FROM `clients` WHERE `class_id` != '$class_id' AND user_id = ".$_SESSION['user_id']." 
```

这就是问题所在，正如您所看到的，Steve Puddin Robinson 有一排 class_id 为 48 和 class_id 为 64。由于此人已经在第 48 班，我也想从结果中排除该名称。这有意义吗？如果不将特定的`first_name` `last_name`和传递`nickname`给查询，这是否可能

**工作查询**

```
SELECT * 
FROM `clients` 
WHERE `user_id`= ".$_SESSION['user_id']." AND `nickname` 
NOT IN(SELECT `nickname` FROM `clients`
WHERE `class_id` = '$class_id') 
```

**修改后的查询**

```
SELECT c.* FROM clients c
LEFT JOIN clients c1
ON `c1`.`first_name` = `c`.`first_name`
AND `c1`.`last_name` = `c`.`last_name`
AND `c1`.`nickname` = `c`.`nickname`
AND `c1`.`class_id` = 48
WHERE `c1`.`class_id` IS NULL; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:52:23.063

我建议您的数据结构无法正常工作。您是根据他们的名字建立联系的，这可能会在某些时候失败。每个人没有唯一的ID吗？我看到一个 client_id 和 user_id，但这些并不建议一个人的全局 ID。

如果有两个“史蒂夫·史密斯”怎么办？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:05:54.513

那这个呢？

```
SELECT * FROM clients
WHERE nickname NOT IN
(SELECT nickname FROM clients
 WHERE class_id = 48) 
```

或者，如果需要名字、姓氏和昵称的组合来识别客户，这个：

```
SELECT c.* FROM clients c
LEFT JOIN clients c1
ON c1.first_name = c.first_name
AND c1.last_name = c.last_name
AND c1.nickname = c.nickname
AND c1.class_id = 48
WHERE c1.class_id IS NULL 
```

检查[SQLfile](http://www.sqlfiddle.com/#!2/2a9a4/5/0)来测试它。

# mysql - 多列的总和和百分比

> ID：13594598
> 
> 赞同：0
> 
> 时间：2012-11-27T22:48:01.047
> 
> 标签：mysql

我有一个包含 q1、q2、q3 列的数据表

所以数据可能看起来像

```
q1    q2    q3
1     1     2
1     2     1
2     3     1 
```

因此，用户的每次提交都有一条记录，并且一条记录包含问题 1,2 和 3 的答案……这可能不是我想做的最佳表格设计！我想从每个问题中获得计数和百分比

所以结果集看起来像

```
questionNum     responseNum   count   percent
1               1             2       66
1               2             1       33
2               1             1       33
2               2             1       33
2               3             1       33
3               1             2       66
3               2             1       33 
```

这可以在 1 个查询中完成，还是需要 3 个单独的查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T06:38:05.520

根据我的理解，如果不是进一步解释您的问题，此查询将返回您想要的内容。尝试这个：

```
SELECT questionNum, responseNum, `count`,
       FLOOR(`count` * 100 / (SELECT SUM(`count`) FROM question WHERE questionNum = b\q.questionNum)) percent
FROM question q 
```

# vb.net - 使用新词创建对象实例

> ID：13594600
> 
> 赞同：-1
> 
> 时间：2012-11-27T22:48:12.290
> 
> 标签：vb.net, object, nothing

以下代码在 vb.net 中生成了这两个故障排除提示，代码构建没有错误。本地窗口将 OrderContext 下的所有内容列为“Nothing”、0.0 或“False”，当它停止在尝试设置 address1 的行上时。

“使用 new 关键字创建对象实例。”
“在调用方法之前检查确定对象是否为空。”

```
Imports TPETest.com.nicusa.cdc.tpe2_ks

Public Class Form1
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

        Dim PEService As New PaymentEngineService
        Dim OrderContext() As com.nicusa.cdc.tpe2_ks.WSOrderContext

        OrderContext.customer.address.address1 = "1233 Test Dr."
        OrderContext.customer.address.city = "City"
        OrderContext.customer.address.state = "KS"
        OrderContext.customer.address.zip = "66099"
        OrderContext.attributes.SetValue("John Smith", 1)
        OrderContext.attributes.SetValue("1233 Test Dr", 2) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:54:00.990

您需要放在`Option Strict On`模块的顶部。这将帮助您确定您声明`OrderContext`为一个数组，并且作为一个数组，它没有`customer`或`attributes`属性。

您可能想输入

```
Dim OrderContext As New com.nicusa.cdc.tpe2_ks.WSOrderContext 
```

# php - 使 /prestashop/ 部分 url 不可见

> ID：13594609
> 
> 赞同：1
> 
> 时间：2012-11-27T22:49:06.703
> 
> 标签：php, .htaccess, prestashop, front-controller

我最近使用 prestashop 建立了一个商店，prestashop 的生产安装位于服务器上名为 /prestashop 的子目录中。我想做的是让你不必去[http://mydomain.com/prestashop](http://mydomain.com/prestashop)来查看网站，而只需[http://mydomain.com](http://mydomain.com)

到目前为止我想到了两种方法，我可以将 prestashop 的前控制器在索引文件中移动到根目录，类似于在 wordpress 中所做的，尽管我不确定这是否是一个可行的选择，因为我是没有足够的经验来解决它。以下是所有感兴趣的人的 index.php 代码：

```
require(dirname(__FILE__).'/config/config.inc.php');
Dispatcher::getInstance()->dispatch(); 
```

第二种选择是使用 apache 的 mod_rewrite 模块，所以你有类似的东西

```
RewriteEngine on
RewriteRule ^/(.*)$   /prestashop/$1 
```

但是我打开了已经存在的htaccess文件并且这段代码在那里，所以我不知道这是否可以编辑：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^www.mydomain.com$
RewriteRule . - [E=REWRITEBASE:/prestashop/]
RewriteRule ^api/?(.*)$ %{ENV:REWRITEBASE}webservice/dispatcher.php?url=$1 [QSA,L] 
```

我会继续玩，并试图自己弄清楚，但你们的任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:54:52.253

我不确定 Prestashop 是否会正确计算路径，但请尝试将 index.php 文件更改为：

```
require(dirname(__FILE__).'/prestashop/config/config.inc.php');
Dispatcher::getInstance()->dispatch(); 
```

如果可能的话，我会避免使用 .htaccess ，因为通过对每个请求进行更多的重写会产生更多的开销。

基本上所有这些都是修改前端控制器代码以在正确的目录（/prestashop）中查找配置。它不应该是一个问题。

编辑：您还需要将 .htaccess 文件从 /prestashop/.htaccess 移动到 /.htaccess 以便 URL 的重写仍然有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T04:40:31.353

[按照http://www.prestashop.com/forums/topic/18393-solved-move-prestashop-from-subfolder-to-root/](http://www.prestashop.com/forums/topic/18393-solved-move-prestashop-from-subfolder-to-root/)上 michaeld 的说明/提示

我发现它有效！

此外，如果您使用 PrestaShop 媒体服务器，请也添加重写。

这是对我有用的完整 .htaccess：

```
# Copy and paste the following code into the .htaccess file
# in the public_html folder of your hosting account
# make the changes to the file according to the instructions.

# Do not change this line - RewriteEngine on
RewriteEngine on

# Change yourdomain.com to be your main domain.
RewriteCond %{HTTP_HOST} ^(www.)?yourdomain.com$

# Change 'subfolder' to be the folder you will use for your main domain.
RewriteCond %{REQUEST_URI} !^/subfolder/

# Don't change this line.
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Change 'subfolder' to be the folder you will use for your main domain.
RewriteRule ^(.*)$ /subfolder/$1

# Change yourdomain.com to be your main domain again.
# Change 'subfolder' to be the folder you will use for your main domain
# followed by / then the main file for your site, index.php, index.html, etc.
RewriteCond %{HTTP_HOST} ^(www.)?yourdomain.com$
RewriteRule ^(/)?$ subfolder/index.php [L]

# For PrestaShop Media server #1 
# Change mediaserver1.yourdomain.com to be your media server subdomain
# Change 'subfolder' to be the folder you will use for your main domain.
RewriteCond %{HTTP_HOST} ^mediaserver1.yourdomain.com$
RewriteCond %{REQUEST_URI} !^/subfolder/.*$
RewriteRule ^(.*)$ /subfolder/$1

# For PrestaShop Media server #2
# Change mediaserver2.yourdomain.com to be your media server subdomain
# Change 'subfolder' to be the folder you will use for your main domain.
RewriteCond %{HTTP_HOST} ^mediaserver2.yourdomain.com$
RewriteCond %{REQUEST_URI} !^/subfolder/.*$
RewriteRule ^(.*)$ /subfolder/$1

# For PrestaShop Media server #3
# Change mediaserver3.yourdomain.com to be your media server subdomain
# Change 'subfolder' to be the folder you will use for your main domain.
RewriteCond %{HTTP_HOST} ^mediaserver3.yourdomain.com$
RewriteCond %{REQUEST_URI} !^/subfolder/.*$
RewriteRule ^(.*)$ /subfolder/$1 
```

PS：确保将 PrestaShop BO 上的物理 URL 设置为“/”

# mysql - 如何从多列MySQL中找到最大值

> ID：13594610
> 
> 赞同：1
> 
> 时间：2012-11-27T22:49:11.397
> 
> 标签：mysql, sql, max

![无法在此处创建表格，因此必须打印屏幕](../Images/1261b9447e1005929d3bbe2994431477.png)

所以问题是我如何显示表 SP 中具有最大数量 (QTY) 的供应商 (S)。

这就是我想出的：

```
 SELECT sno FROM sp WHERE sno in (SELECT max(QTY) FROM sp WHERE qty); 
```

但它只显示空字段，我找不到问题。我将衷心感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:56:12.640

```
SELECT a.* 
FROM tableA a
     INNER JOIN tableB b
        ON a.S = b.S
WHERE b.qty = (SELECT max(qty) FROM tableB) 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/5c175/1)
*   [SQLFiddle 演示（*带关系*）](http://sqlfiddle.com/#!2/23b99/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:02:07.517

怎么样

`SELECT sno FROM sp ORDER BY qty DESC LIMIT 1`

这样你就可以索引 QTY 而不必进行全表扫描

然后，您可以使用连接来获取 S 中的数据，而无需进行子选择或任何类似的昂贵操作

`SELECT s.* FROM sp LEFT JOIN s USING(sno) ORDER BY qty DESC LIMIT 1`

# wpf - 如何在 wpf 中更改 GeometryDrawing 的边框颜色

> ID：13594614
> 
> 赞同：0
> 
> 时间：2012-11-27T22:49:35.327
> 
> 标签：wpf, geometrydrawing

我有一些 WPF 代码将块绑定到颜色，如下所示：

```
 <GeometryDrawing>
        <GeometryDrawing.Brush>
            <LinearGradientBrush>
                <LinearGradientBrush.GradientStops>
                    <GradientStop Offset="0.00" Color="{Binding Path=Element.Color}"/>
                    <GradientStop Offset="1.00" Color="{Binding Path=Element.Color}"/>
                </LinearGradientBrush.GradientStops>
            </LinearGradientBrush>
        </GeometryDrawing.Brush>
    </GeometryDrawing> 
```

现在我想将边框（或 Pen 属性）绑定到另一个字段，例如 Element.BorderColor。那应该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:55:32.487

您可以使用 ElementName 绑定绑定到窗口中其他 UI 元素的属性

```
<GradientStop Offset="0.00" Color="{Binding ElementName=MyElement Path=TheColor}"/> 
```

# java - android上基于时间的循环的一个很好的实现

> ID：13594618
> 
> 赞同：1
> 
> 时间：2012-11-27T22:49:40.850
> 
> 标签：java, android, loops

我第一次尝试为 android 编写游戏，并且需要编写一个循环来在画布上绘制动画。这基本上是我需要的：

```
every 0.1 seconds do { //0.1 seconds is arbitrary of course, I need a time frame that's good for animation
   every 5 seonds do {
      someStuff();
    }
   drawEverything();
} 
```

任何人都可以推荐一种实现这一点的好方法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:13:39.610

你可以使用一个`ScheduleExecutorService`

[http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ScheduledExecutorService.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ScheduledExecutorService.html)

```
Runnable someStuff = new Runnable....

Runnable drawEverything = new Runnable... 
```

然后，安排他们：

```
ScheduledExecutorService executor = Executors.newSingleThreadScheduledExecutor();

executor.scheduleAtFixedRate(someStuff, 0, 100, TimeUnit.MILLISECONDS);
executor.scheduleAtFixedRate(drawEverything, 0, 5, TimeUnit.SECONDS); 
```

这比使用永不结束的循环要干净得多。好在如果你有一个关闭钩子，或者只是想直接调用它，你可以调用：

```
executor.shutDown() 
```

这将完成任何待处理的任务然后停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:52:24.907

这取决于您所针对的 Android API 版本以及您实现游戏的方式。

如果您对 API 级别 16 (4.1 / Jellybean) 及更高版本没问题，您可以使用 Choreographer 类 ( [http://developer.android.com/reference/android/view/Choreographer.html](http://developer.android.com/reference/android/view/Choreographer.html) )。

如果您使用的是 OpenGL ES 或提供垂直同步回调的引擎，您可能希望以不同的方式构建游戏。与其用你的时间来驱动显示器，不如让系统来驱动你的游戏，并且事件会根据经过的时间而发生。例如，参见[http://code.google.com/p/android-breakout/](http://code.google.com/p/android-breakout/)`GameState.calculateNextFrame()`中推进弹跳球的方式。这感觉不太自然，因为您不再指挥流量，但它也更“真实”，因为您的动画将被锁定在屏幕刷新更新上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T22:57:14.737

尝试使用`CountDownTimer`类`onTick`方法或`Chronometer`类`setOnChronometerTickListener`方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T15:05:25.787

创建一个 custom `View`，实现它的`onDraw()`方法并在那里做你的绘图。每次视图层次结构失效时，`onDraw()`都会调用：

```
public class MyGameView extends View {

    @Override
    protected void onDraw(Canvas canvas) {
        // Any tasks that should run every frame can be placed here. For
        // example moving the player and monsters.

        // Draw everything to canvas here.
        canvas.drawBitmap(mPlayerBitmap, mPlayerX, mPlayerY, null);
        canvas.drawBitmap(mMonsterBitmap, mMonsterX, mMonsterY, null);

        // Either do a invalidate() to draw in maximum frame rate here. Or do
        // postInvalidateDelayed(10) to draw a new frame every 0.1 seconds.
        // onDraw() will automatically be called by the system.
        postInvalidateDelayed(10);
    }
} 
```

然后可以将您的新视图添加到现有视图层次结构中，其中包含`Button`s 和`TextView`s 等其他内容，使用`ViewGroup.addView(myGameView)`. 或者可以将其设置为内容视图以占据整个屏幕，使用`Activity.setContentView(myGameView)`.

可以通过发布重复发生的任务，`View.postDelayed()`以确保它们与`onDraw()`. A`Runnable`可以发布，然后每次`run()`调用它的方法时再次发布自己。最好在 中发布任务`Activity.onResume()`并将其删除`Activity.onPause()`，以确保当您的游戏在后台时不会运行任何内容：

```
@Override
protected void onResume() {
    super.onResume();
    mMyGameView.postDelayed(mRunnable, 5000);
}

@Override
protected void onPause() {
    super.onPause();
    mMyGameView.removeCallbacks(mRunnable);
}

private Runnable mRunnable = new Runnable() {
    @Override
    public void run() {
        // Perform reoccurring task...

        mMyGameView.postDelayed(mRunnable, 5000);
    }
}; 
```

# javascript - 如何在 JavaScript 或 Node.js 中为 JSON 序列化创建安全对象

> ID：13594621
> 
> 赞同：1
> 
> 时间：2012-11-27T22:49:51.990
> 
> 标签：javascript, node.js, recursion, json

我的愿望是将给定对象编码为 JSON 的“安全”方式。这是用于记录 Node.js 中的任何抽象对象，但也可以应用于其他需求。我的研究将我指向 Node 中的 util.inspect，但这不是有效的 JSON，我希望拥有有效的 JSON，以便我以后可以重新补充水分。因为某些 Error 实例可能存在递归问题，所以我需要限制响应。此外，在某些情况下，对对象的前向和后向引用也可能是一个问题，所以我想避免重复的条目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:49:51.990

**新答案**

今天，如果有人在看这个，我会使用[fclone](https://www.npmjs.com/package/fclone)，它在这一点上比我原来的要彻底得多。

* * *

*原答案：*

我在下面回答我自己的问题，因为想出一个可行的解决方案有点困难。这是我找到的一些解决方案的组合，并且似乎效果很好。

```
/* lib/clone-safe.js
*  provides a method for creating a clone of an object without redundant object references, and protected from recursion.
*  The cloned value *should* always be safe for JSON.stringify(cloneSafe(myobj))
**/
(function(){
    var undef; //intentionally undefined value
    function cloneSafe(obj,depth){
        var refs = []; //reference to cloned objects
        depth = +depth > 0 && +depth || 6; //max recursion level

        var layerNumber = 0; //current layer being checked
        var ret = clone(obj); //start cloning

        //cleanup reference checks
        while(refs.length) {
            delete (refs.shift()).___copied;
        }

        //return the result
        return ret;

        //recursive clone method
        function clone(obj) {
            if (typeof obj == "function") return undef; //no function replication

            // Handle the 3 simple types, and null or undefined
            if (null == obj || "object" != typeof obj) return obj;

            // Handle Date
            if (obj instanceof Date) {
                var copy = new Date();
                copy.setTime(obj.getTime());
                return copy;
            }

            // Handle Array
            if (obj instanceof Array) {
                var copy = [];
                for (var i = 0, len = obj.length; i < len; i++) {
                    copy[i] = clone(obj[i]);
                }
                return copy;
            }

            // Handle Object
            if (obj instanceof Object) {
                //max recursion reached
                if (++layerNumber >= depth) {
                    layerNumber--;
                    return undef;
                }

                //handle circular and duplicate references
                if (obj.___copied) return undef; //already included
                obj.___copied = true;
                refs.push(obj);

                var copy = {};

                //export prototype
                var m = obj.constructor && obj.constructor.toString().match(/function\s+([^\(]+)/);
                if (m && m[1]) copy._prototype = m[1];

                //get expected properties from any error
                if (obj instanceof Error) {
                    copy.message = obj.message || "Error";
                    if (obj.stack) copy.stack = obj.stack;
                    if (obj.number) copy.number = obj.number;
                    if (obj.description) copy.description = obj.description;
                    if (obj.name) copy.name = obj.name;
                }

                for (var attr in obj) {
                    if (attr == "___copied") continue;
                    if (obj.hasOwnProperty(attr)) copy[attr] = clone(obj[attr]);
                }
                if (obj.prototype) {
                    for (var attr in obj.prototype) {
                        if (obj.prototype.hasOwnProperty(attr) && typeof obj.prototype[attr] !== 'function') copy[attr] = clone(obj.prototype[attr]);
                        delete obj.prototype[attr].___copied; //allow prototypes to be re-scanned
                    }
                }
                layerNumber--;
                return copy;
            }

            //throw new Error("Unable to copy obj! Its type isn't supported.");
            console.log("Unable to copy obj! Unsupported type: %s", typeof obj);
            return undef; //unable to clone the object in question
        }
    }

    // AMD / RequireJS
    if (typeof define === "function" && define.amd) {
        define("clone-safe",[],function(){ return cloneSafe; });
    }
    // Node.js / CommonJS
    else if (typeof module !== "undefined" && module.exports) {
        module.exports = cloneSafe;
    }
    // browser/script include
    else {

        //provide a method for reverting global binding
        var root = this; //global on the server, window in the browser.
        var previousCloneSafe = root.cloneSafe; //backreference
        cloneSafe.noConflict = function(){
            root.cloneSafe = previousCloneSafe;
            return cloneSafe;
        };

        //bind to the global object
        root.cloneSafe = cloneSafe;

    }

}());
```

有一些额外的逻辑用于处理错误的对象，并确保从所述错误和给定对象的原型中获取必要的数据。响应中明确忽略了函数。当递归太深时，它将返回给定对象的未定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:24:18.490

有一个本机 javascript JSON 对象，带有一个 stringify 方法，我认为这是你需要的：[http ://www.javascripture.com/JSON#stringify](http://www.javascripture.com/JSON#stringify)

# python - 如何为 64 位 Windows 和 Python 2.7 安装 ZBar？

> ID：13594632
> 
> 赞同：7
> 
> 时间：2012-11-27T22:50:27.153
> 
> 标签：python, python-2.7, 64-bit, zbar

我正在尝试将 zbar 库与 Python 2.7 和 Windows 64 位一起使用，但没有现成的 .exe 安装。

我对自己“构建”还很陌生。步骤是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T12:36:19.190

我还没有找到 64 位，但您可以在 64 位机器上运行 Python 2.7 32 位并使用此处找到的安装程序。

[http://www.4shared.com/file/Zg8oJ9-g/zbar-010win32-py27_2.html](http://www.4shared.com/file/Zg8oJ9-g/zbar-010win32-py27_2.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-09T14:00:06.833

我知道这并不能直接回答这个问题，但是如果您在 Windows 上的构建过程中遇到无法克服的问题，那么您可能希望通过子进程（[http://docs.python.org ）简单地查看运行 Zbar 命令行调用/2/library/subprocess.html](http://docs.python.org/2/library/subprocess.html) )。

在最基本的层面上，您可以执行以下操作：

```
import subprocess
subprocess.check_output(["C:\\Program Files (x86)\\ZBar\\bin\\zbarimg","-q",     "E:\path-to-files\QR_image.png"]) 
```

根据您的情况，它可能会比从可能有问题的站点下载安装程序更好。

# spring - 将 JBoss Quartz 调度程序注入 Spring

> ID：13594639
> 
> 赞同：1
> 
> 时间：2012-11-27T22:50:58.930
> 
> 标签：spring, jboss, quartz-scheduler

*   春天 3.0.6
*   石英 1.8.5
*   JBoss 5.1

我正在尝试将 JBoss 通过 JNDI 提供的调度程序注入到我的 spring 配置中。对我来说，注入 JNDI 名称的方式或位置并不明显。任何帮助，将不胜感激。

```
<bean id="task" class="com.hamacher.quartz.MessagePrinterTaskPOJO">
    <constructor-arg name="message" value="Clark Griswold"/>
</bean>

<bean id="jobDetail" class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean">
    <property name="targetObject" ref="task" />
    <property name="targetMethod" value="print" />
    <property name="concurrent" value="false" />
</bean>

<bean id="cronTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
<property name="jobDetail" ref="jobDetail" />
<property name="cronExpression" value="0/5 * * * * ?" />
</bean>

<bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
<property name="triggers">
    <list>
        <ref bean="cronTrigger" />
    </list>
</property>
</bean> 
```

# ios - iOS 流式直播 h.264 视频

> ID：13594642
> 
> 赞同：4
> 
> 时间：2012-11-27T22:51:09.273
> 
> 标签：ios, streaming, live, h.264

我有一个 mime 类型 video/h264 的视频流，它从安全摄像头流式传输实时 h.264 视频。我正在尝试实时流式传输并解码 h.264 帧（最好是硬件解码）并将它们显示在视图中。我已经广泛寻找支持这一点的库或框架，但不确定哪种方法是正确的。我看了一点 AVFoundation 但不确定如何处理视频/h264 流。我是否应该从流中抓取每一帧（I 帧/P 帧）并将其传递给 AVAssetReader？任何方向/示例代码/库参考都会非常有帮助！

```
HTTP/1.1 200 OK
Date: {date}
Connection: keep-alive
Cache-Control: no-cache, no-store
Expires: -1
Content-Type: multipart/x-mixed-replace;boundary=myboundary
Set-Cookie: stream={stream-id}; version=1

--myboundary
Content-Type: video/h264
Sync-Point: "yes" or "no"
Pre-roll: "yes" or "no"
Media-Start: "invalid" or {mediastart}
Media-End: "invalid" or {mediaend}
Stream-Start: "invalid" or {stream start time}
Stream-End: "invalid" or {stream end time}
Content-Length: {content-length}
X-Date: {x-date}

{image} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T15:28:38.453

您无法在 iOS 上播放基本 h.264。您的解决方法可以是在播放 [http pd 下载或 hls] 之前将其包装在 mp4 或 ts 流中。但除非你在设备上编译其他东西（如 ffmpeg），否则你将无法播放原始 h.264

# wolfram-mathematica - 如何防止两个 Manupulate 函数相互影响？

> ID：13594643
> 
> 赞同：0
> 
> 时间：2012-11-27T22:51:08.510
> 
> 标签：wolfram-mathematica

在过去的两天里，我一直被这个问题困扰。我正在对两个不同的数据执行相同的操作集（涉及动态更新操作）。当每个单独完成时，我得到正确的输出，但是当两个操作都在同一个笔记本中时，第一个操作只是复制第二个操作。我读到这与全局变量有关，但作为初学者对我来说有点难以理解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T05:11:50.673

在 Manipulate 内部访问和使用的所有变量都应该在 Manipulate 内部。不要使用全局变量。就这些。即不要写类似的东西

```
x=0
Manipulate[ x=y+1;
            x,
            {{y,0,"y="},0,10,1}
          ] 
```

因为现在`x`是在全球范围内。但是写

```
Manipulate[ 
            Module[{x=0},
              x=y+1;
              x
            ],
            {{y,0,"y="},0,10,1}
          ] 
```

只需要确保没有使用的变量是全局的。使用 Manipulate 中的模块来分解您的代码并使用参数在它们之间传递所有内容。

# java - 为什么在部署 Web 应用程序时 JSTL 标记显示为问号？

> ID：13594647
> 
> 赞同：1
> 
> 时间：2012-11-27T22:51:24.947
> 
> 标签：java, jsp, jstl, java-ee-6

我正在学习基于 Java EE 技术的 Netbeans 电子商务教程，我花了两天时间解决了包括数据库连接在内的所有问题并了解了 Web 应用程序的功能，现在我终于设法运行了整个 Web 应用程序我从 Netbeans 教程下载的。但是 JSTL 标签显示有问题**？？？？**问号，下面的代码片段显示了它是如何实现的：

```
 <c:forEach var="category" items="${categories}">

    <c:choose>
        <c:when test="${category.name == selectedCategory.name}">
            <div class="categoryButton" id="selectedCategory">
                <span class="categoryText">
                    <fmt:message key="${category.name}"/>
                </span>
            </div>
        </c:when>
        <c:otherwise>
            <a href="<c:url value='category?${category.id}'/>" class="categoryButton">
                <span class="categoryText">
                    <fmt:message key="${category.name}"/>
                </span>
            </a>
        </c:otherwise>
    </c:choose>

</c:forEach> 
```

这是我在浏览器上运行它时的样子，运行此 Web 应用程序的服务器是 GLASSFISH：

![在此处输入图像描述](../Images/e021366a77ae4c73b1b89f80464e3657.png)

在图像中，带下划线的问号是 JSTL 标签，当我尝试删除标签时，问号不会出现，但我无法删除整个 for 循环。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:59:35.573

这些问号来自

```
<fmt:message key="${category.name}"/> 
```

如果有`???Action???`，则表示您正在使用`fmt:message`标签 with`Action`作为键，但`Action`在资源包中找不到键。

# javascript - iframe 怪异

> ID：13594655
> 
> 赞同：0
> 
> 时间：2012-11-27T22:51:32.893
> 
> 标签：javascript, html, iframe, height

我有两个网站，我有点融合在一起。我正在使用 iframe 来显示另一页面中的内容，就好像它们都是一个站点一样。这里需要注意的是，当在 iframe 中查看时，我需要页面正常显示，否则显示警告。由于 IIS 不兼容，我无法将 iframe 页面导入主机页面，因此该选项已失效。当我在所有情况下都简单地显示页面时，该计划运行良好，当我尝试实现条件显示时，我遇到了问题。在 iframe 页面上，我有以下内容：

```
<script type="text/javascript">
    window.onload = function InFrame() {
        MainContent_siteIsNotFramed
        if (top != self) {
            //document.getElementById("siteIsFramed").style.display = "inline"
            siteIsFramed.visible = "true"
        }
        else {
            //document.getElementById("MainContent_siteIsNotFramed").style.display = "inline"
            siteIsNotFramed.visible = "true"
        }
        init();
    };
</script> 
```

这是我试图让 iframe 页面处理自己的条件显示。我在主机页面中唯一相关的代码是 iframe 本身，为了完整起见，它看起来像这样：

```
</head>
<body style="margin:0; height: 100%;">

<iframe  runat="server" id="signInFrame" style="border: 0; width: 100%; height: 100%; ">
    Your browser does not support iframes. Consider upgrading.
</iframe>
</body>
</html> 
```

当要显示/不显示的内容时，iframe 中的内容将以大约一半的高度显示。没有，它会以全高显示（期望的行为）。我已经尽力做到了，如果有人需要更多详细信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T03:47:15.563

尝试“定位” iframe：

```
<iframe  runat="server" id="signInFrame" style="border: 0; position:absolute; width: 100%; height: 100%; ">
   Your browser does not support iframes. Consider upgrading.
</iframe> 
```

问题是具有默认位置（位置：静态）的 iframe 不能具有“相对”高度（即 %），因此它忽略高度：100%，并应用 iframe 的“默认”高度（150px在FF）。

# javascript - Cloud9 中 Mocha 测试中的“未声明变量”警告

> ID：13594656
> 
> 赞同：6
> 
> 时间：2012-11-27T22:51:34.557
> 
> 标签：javascript, unit-testing, node.js, mocha.js, cloud9-ide

我是 node.js 和单元测试框架 Mocha 的新手，但我在 cloud9 IDE 中创建了几个测试只是为了看看它是如何工作的。代码如下所示：

```
var assert = require("assert");
require("should");

describe('Array', function(){
  describe('#indexOf()', function(){
    it('should return -1 when the value is not present', function(){
      assert.equal(-1, [1,2,3].indexOf(5));
      assert.equal(-1, [1,2,3].indexOf(0));
    });
  });
});

describe('Array', function(){
  describe('#indexOf()', function(){
    it('should return the index when the value is present', function(){
      assert.equal(1, [1,2,3].indexOf(2));
      assert.equal(0, [1,2,3].indexOf(1));
      assert.equal(2, [1,2,3].indexOf(3));
    });
  });
}); 
```

如果我在控制台中键入 mocha，测试将起作用，但 IDE 在“描述”和“它”的行中显示警告，因为它表示该变量尚未声明（“未声明的变量”）。

我想知道我应该怎么做这些测试以避免警告。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-27T16:00:11.677

在 cloud9 中，您可以在文件顶部添加全局提示作为注释，它将删除警告。例如

```
**/* global describe it before */**

var expect = require('chai').expect;

describe('Array', function(){
  describe('#indexOf()', function(){
    it('should return -1 when the value is not present', function(){
        expect(true).to.equal(true);
    })
  })
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T09:53:08.287

这是因为`mocha`“可执行文件”将您的测试包装在`require`s 中，以使用 mocha 函数（`describe`和`it`）。查看`mocha`并`_mocha`在您的`node_modules/mocha/bin`目录中。

另一方面，`cloud9`尝试使用纯`node`可执行文件解析所有符号，因此您必须`require`手动处理所有内容。

# php - exec 不工作或执行 crontab 脚本

> ID：13594657
> 
> 赞同：1
> 
> 时间：2012-11-27T22:51:37.230
> 
> 标签：php, crontab

基本上我已经开发了一个小脚本，它将一个 cron 作业添加到一个名为“crontask”的文件中，然后我想执行它，这样它就变成了一个 cron 作业。这是脚本：

```
 <?php

    $filename = "../../tmp/crontask.txt";
    $output = shell_exec('crontab -l');
    $something = file_put_contents($filename, $output.'* * * * * NEW_CRON'.PHP_EOL);
    $cngDir = chdir('../../tmp/');
    echo exec('crontab ' . getcwd() . '/crontask.txt');
    //var_dump($exe); 
```

?>

一切正常，路径相同，如果我复制并粘贴打印出来的路径，IT 将执行 cronjob，但在 PHP 中它不会？？？

一切正常，除了 exec 函数，它不执行它。有任何想法吗？

在终端中，如果我这样做：

```
string(25) "crontab /tmp/crontask.txt" 
```

它会执行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:11:17.027

尝试以下操作：

*   使用完整的命令路径调用命令。有时脚本环境中没有设置 $PATH ，否则找不到命令。

*   [使用http://php.net/manual/en/function.chdir.php](http://php.net/manual/en/function.chdir.php)设置脚本的工作目录

*   使用绝对路径访问文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-27T11:38:07.597

我在 cron 作业中遇到了类似的问题，我查看了您的代码并得到了一些想法。我使用了绝对路径

这是我的代码：

```
$myFile = "/home/user/tmp/crontab.txt";
$addcron = "
0     0     *     *     *      cronjob1 " . PHP_EOL .
"0    18     *     *     1-5    conjob2 " . PHP_EOL .
"0     9     *     *     *      cronjob3 " . PHP_EOL  ;

$output = exec('crontab -l  > ' . $myFile );
file_put_contents($myFile,$addcron ,FILE_APPEND);
echo exec('crontab ' . $myFile );
echo "<h3>Cron job successfully added!</h3>";enter code here 
```

基本上我将以前的 cronjobs 列表写入一个文件，然后在文件中附加新的 cronjobs。然后使用 crontab 命令添加新的 cronjobs 列表。linux写入文件命令'>'是诀窍;）

# c# - 试图让一个 Windows 窗体按钮在文本文件中显示接下来的 3 个数字

> ID：13594662
> 
> 赞同：-1
> 
> 时间：2012-11-27T22:51:49.090
> 
> 标签：c#, winforms

正如问题所表明的，这就是我正在尝试做的事情，任何人都可以看到一段时间以来一直在摆弄它。目前它只显示文本文件中的前 3 个数字，当我按下下一个按钮时，我希望它转到下一个 3，但它似乎不起作用..

```
namespace GPSProject
{
    public partial class Form1 : Form
    {
        private int count;
        internal dataPoints myDataPoints;
        public Form1()
        {
            myDataPoints = new dataPoints();
            InitializeComponent();
        }

        private void buttonNext_Click(object sender, EventArgs e)
        {
            {
                Button b = (Button)sender;
                if (b.Name.Equals("buttonNext"))
                {

                    count++;
                    if (count == (myDataPoints.Count))
                        count = 0;
                }
                else
                {
                    count--;
                    if (count < 0)
                        count = myDataPoints.Count - 1;
                }
                dataPoint a = myDataPoints.getItem(count);
                textBoxLatitude.Text = a.CurLatitude;
                textBoxLongtitude.Text = a.CurLongtitude;
                textBoxElevation.Text = a.CurElevation;

            }
        }
    }
} 
```

上面是我的表单窗口，下面是我的数据点

```
namespace GPSProject
{
    class dataPoints
    {
        public int Count { get { return Points.Count; } }
        List<dataPoint> Points;
        //string p;

        public dataPoints(/*string path*/)
        {
            Points = new List<dataPoint>();
           // p = path;
            TextReader tr = new StreamReader(/*p*/"C:/Test.txt");
            string input;
            while ((input = tr.ReadLine()) != null)
            {
                string[] bits = input.Split(',');
                dataPoint a = new dataPoint(bits[0], bits[1], bits[2]);
                Points.Add(a);                
            }

            tr.Close();
        }          

        internal dataPoint getItem(int p)
        {
            if (p < Points.Count)
            {
                return Points[p];
            }
            else

                return null;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:07:39.267

您需要更新`while`循环以一次获取 3 个数据项，如下所示：

```
while ((input = tr.ReadLine()) != null)
{
    string[] bits = input.Split(',');
    for (int i = 0; i < bits.Length / 3; i++)
    {
        dataPoint a = new dataPoint(bits[3*i], bits[3*i+1], bits[3*i+2]);
        Points.Add(a);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:07:57.587

```
string input = "1,2,3,4,5,6,7,8,9,10,11,12";
//string input = File.ReadAllText(/*p*/"C:/Test.txt");

List<List<string>> all = input.Split(',')
                        .Select((s, i) => new { s, i })
                        .GroupBy(x => x.i / 3)
                        .Select(g => g.Select(x=>x.s).ToList())
                        .ToList();

foreach(var bits in all)
{
    Console.WriteLine("{0} {1} {2}", bits[0], bits[1], bits[2]);
    //dataPoint a = new dataPoint(bits[0], bits[1], bits[2]);
    //Points.Add(a); 
} 
```

这将给出一个输出

```
1 2 3
4 5 6
7 8 9
10 11 12 
```

# php - 带有连接表的 MySQL 按日期求和

> ID：13594666
> 
> 赞同：0
> 
> 时间：2012-11-27T22:51:56.307
> 
> 标签：php, mysql, count, sum

我有 2 个不同的表，这是查询中使用的表的结构：

`leads`：

```
- id
- date_added
- website 
```

`assignments`：

```
- id
- id_lead
- date_assigned
- website 
```

我想要做的是根据日期范围计算每个网站`leads`的表格中有多少行。`assignments`例如，我想要一个计数，它会给我每个网站`today`的总行数。`today`

我正在寻找的日期范围是这样的：

```
Today
Yesterday
2 Days Ago
3 Days Ago
4 Days Ago
5 Days Ago
6 Days Ago
7 Days Ago
This Week
This Month
Last Month
This Year 
```

所以我想显示每个网站所有行的总和或计数。

这是我已经有的查询，但它的计数不正确，并且其中没有连接：

```
select `website`, 
sum(case when date_format(from_unixtime(`date_assigned`), '%Y-%m-%d') = date_format(now(), '%Y-%m-%d') then 1 else 0 end) AS c_day,
sum(case when date_format(from_unixtime(`date_assigned`), '%Y-%m-%d') = date_format(now() - interval 1 day, '%Y-%m-%d') then 1 else 0 end) AS c_yesterday,
sum(case when date_format(from_unixtime(`date_assigned`), '%Y-%m-%d') = date_format(now() - interval 2 day, '%Y-%m-%d') then 1 else 0 end) AS c_2_days,
sum(case when date_format(from_unixtime(`date_assigned`), '%Y-%m-%d') = date_format(now() - interval 3 day, '%Y-%m-%d') then 1 else 0 end) AS c_3_days,
sum(case when date_format(from_unixtime(`date_assigned`), '%Y-%m-%d') = date_format(now() - interval 4 day, '%Y-%m-%d') then 1 else 0 end) AS c_4_days,
sum(case when date_format(from_unixtime(`date_assigned`), '%Y-%m-%d') = date_format(now() - interval 5 day, '%Y-%m-%d') then 1 else 0 end) AS c_5_days,
sum(case when date_format(from_unixtime(`date_assigned`), '%Y-%m-%d') = date_format(now() - interval 6 day, '%Y-%m-%d') then 1 else 0 end) AS c_6_days,
sum(case when date_format(from_unixtime(`date_assigned`), '%Y-%m-%d') = date_format(now() - interval 7 day, '%Y-%m-%d') then 1 else 0 end) AS c_7_days,
sum(case when YEARWEEK(FROM_UNIXTIME(`date_assigned`)) = YEARWEEK(CURDATE()) then 1 else 0 end) AS c_week, 
sum(case when date_format(from_unixtime(`date_assigned`), '%Y-%m')= date_format(now(), '%Y-%m') then 1 else 0 end) AS c_month,
sum(case when date_format(from_unixtime(`date_assigned`), '%Y-%m')= date_format(now() - interval 1 month, '%Y-%m') then 1 else 0 end) AS c_last_month,
sum(case when date_format(from_unixtime(`date_assigned`), '%Y')= date_format(now(), '%Y') then 1 else 0 end) AS c_year
from `assignments`
where `id_dealership`!='65' and `id_dealership`!='77' and `id_dealership`!='89'
group by `website`
order by `website` asc 
```

下面是查询的 PHP，它将它吐出到我想要的表格格式中：

```
echo '<table cellpadding="10" cellspacing="1" border="0" width="100%">';
echo '<tr>';
echo '<th class="l">Website</th>';
echo '<th>Today</th>';
echo '<th>Yesterday</th>';
echo '<th>2 Days Ago</th>';
echo '<th>3 Days Ago</th>';
echo '<th>4 Days Ago</th>';
echo '<th>5 Days Ago</th>';
echo '<th>6 Days Ago</th>';
echo '<th>7 Days Ago</th>';
echo '<th>This Week</th>';
echo '<th>This Month</th>';
echo '<th>Last Month</th>';
echo '<th>This Year</th>';
echo '</tr>';

$count = 1;
$c_day_total = 0;
$c_yesterday_total = 0;
$c_2_days_total = 0;
$c_3_days_total = 0;
$c_4_days_total = 0;
$c_5_days_total = 0;
$c_6_days_total = 0;
$c_7_days_total = 0;
$c_week_total = 0;
$c_month_total = 0;
$c_last_month_total = 0;
$c_year_total = 0;

while ($row = mysql_fetch_assoc($sql))
{
    foreach ($row as $k => $v)
        $$k = htmlspecialchars($v, ENT_QUOTES);

    if (!empty($website))
    {
        $website = '<a href="website.php?url='.$website.'">'.$website.'</a>';
        //$website = '<a href="http://'.$website.'">'.$website.'</a>';

        echo '<tr class="'.(($count % 2) ? 'row1' : 'row2' ).'">';
        echo '<td>'.$website.'</td>';
        echo '<td>'.$c_day.'</td>';
        echo '<td>'.$c_yesterday.'</td>';
        echo '<td>'.$c_2_days.'</td>';
        echo '<td>'.$c_3_days.'</td>';
        echo '<td>'.$c_4_days.'</td>';
        echo '<td>'.$c_5_days.'</td>';
        echo '<td>'.$c_6_days.'</td>';
        echo '<td>'.$c_7_days.'</td>';
        echo '<td>'.$c_week.'</td>';
        echo '<td>'.$c_month.'</td>';
        echo '<td>'.$c_last_month.'</td>';
        echo '<td>'.$c_year.'</td>';
        echo '</tr>';

        $c_day_total = $c_day_total + $c_day;
        $c_yesterday_total = $c_yesterday_total + $c_yesterday;
        $c_2_days_total = $c_2_days_total + $c_2_days;
        $c_3_days_total = $c_3_days_total + $c_3_days;
        $c_4_days_total = $c_4_days_total + $c_4_days;
        $c_5_days_total = $c_5_days_total + $c_5_days;
        $c_6_days_total = $c_6_days_total + $c_6_days;
        $c_7_days_total = $c_7_days_total + $c_7_days;
        $c_week_total = $c_week_total + $c_week;
        $c_month_total = $c_month_total + $c_month;
        $c_last_month_total = $c_last_month_total + $c_last_month;
        $c_year_total = $c_year_total + $c_year;
        $count++;
    }
}

echo '<tr class="'.(($count % 2) ? 'row1' : 'row2' ).'">';
echo '<td>Totals</td>';
echo '<td>'.$c_day_total.'</td>';
echo '<td>'.$c_yesterday_total.'</td>';
echo '<td>'.$c_2_days_total.'</td>';
echo '<td>'.$c_3_days_total.'</td>';
echo '<td>'.$c_4_days_total.'</td>';
echo '<td>'.$c_5_days_total.'</td>';
echo '<td>'.$c_6_days_total.'</td>';
echo '<td>'.$c_7_days_total.'</td>';
echo '<td>'.$c_week_total.'</td>';
echo '<td>'.$c_month_total.'</td>';
echo '<td>'.$c_last_month_total.'</td>';
echo '<td>'.$c_year_total.'</td>';
echo '</tr>';

echo '</table>'; 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T14:01:52.557

我可以给你一个关于这部分 SQL 查询的提示：

```
where `id_dealership`!='65' and `id_dealership`!='77' and `id_dealership`!='89' 
```

您可以改用此代码：

```
where `id_dealership` NOT IN (65,77,89) 
```

# javascript - 我可以在客户端使用 nools

> ID：13594667
> 
> 赞同：2
> 
> 时间：2012-11-27T22:52:00.977
> 
> 标签：javascript

我正在寻找一个规则引擎来简化我的代码。我看到的唯一好的解决方案是 nodejs 的 nools。由于我对 nodejs 不太熟悉，我想看看是否有人将 nools 用于客户端规则，甚至是否可以在客户端使用 nools。

# math - LaTex 或 MathML 渲染

> ID：13594668
> 
> 赞同：1
> 
> 时间：2012-11-27T22:52:06.653
> 
> 标签：math, browser, mathjax

我在 LaTex 或 MathML 中有一个公式，我想在浏览器上渲染它，我尝试了 MathJax，但速度太慢了，还有另一个 javascript 可以更快地渲染一些公式 mathjax？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T01:15:29.307

对于类似 tex 的输入，您可以尝试一下 jqmath，它比 mathjax 更小更快（但不会尝试完成如此完整的工作）[http://mathscribe.com/author/jqmath.html](http://mathscribe.com/author/jqmath.html)

对于 MathML 输入，webkit 和 firefox 现在默认支持，但在平台上默认安装数学字体仍然是一个问题，并且可能需要一段时间才能使 mathml 支持到达所有相关浏览器。例如，MathML 在上周发布的 Chrome 24 中，但目前移动版 chrome（也不是 android 股票浏览器）都没有使用足够新的 webkit 基础。显然，内置的 MathML 支持将比 javascript 实现快得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T22:59:10.543

你可能可以使用这个：[WP Latex](http://wordpress.org/extend/plugins/wp-latex/)

# msbuild - 如何使用 MSDeploy 配置应用程序池

> ID：13594670
> 
> 赞同：7
> 
> 时间：2012-11-27T22:52:09.680
> 
> 标签：msbuild, msdeploy

我目前正在使用 MSBuild 通过传入参数来创建 MSDeploy 包：

```
/p:DeployOnBuild=true;DeployTarget=Package 
```

我正在使用 parameters.xml 文件（位于我网站的根目录）。 [我发现的另一个 SO question](https://stackoverflow.com/questions/12241314/how-to-specify-default-application-pool-in-asp-net-mvc-project/12630846#comment18634094_12630846)试图设置应用程序池。

我的 parameters.xml 文件：

```
<parameters>
    <parameter name="Application Pool Name" description="Application Pool for this site" tags="" defaultValue="ASP.NET v4.0">
        <parameterEntry kind="DeploymentObjectAttribute"
                        scope="application"
                        match="/application/@applicationPool" />
    </parameter>
...
</parameters> 
```

但似乎 msbuild 生成的 msdeploy 包中的 archive.xml 文件没有包含 applicationPool 元素的部分

如何使用此部分生成 archive.xml 以便我可以设置应用程序池？

我要设置的应用程序池已经存在，所以我不关心 MSDeploy 同步或在这里创建应用程序池。

编辑：我发现了这个问题[How do I control the AppPool used for deploy through VS & MSDeploy settings](https://stackoverflow.com/questions/7690954/how-do-i-control-the-apppool-used-for-deploy-through-vs-msdeploy-settings) which hints at using wpp.targets to generate a custom provider。我正在探索如何使用这种方法来修改archive.xml 文件

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T06:19:47.117

假设您的项目具有正确的 IIS 设置并以管理员身份运行，您应该能够指定`IncludeIisSettings=true`将设置包含在 zip 中。

如果您需要包含实际的 AppPool 定义（以便可以创建它），您还应该设置`IncludeAppPool=true`.

# c++ - 汇编乘法运算 64 位

> ID：13594671
> 
> 赞同：0
> 
> 时间：2012-11-27T22:52:17.510
> 
> 标签：c++, c, assembly, x86

我在装配中的以下操作时遇到了一些麻烦。我正在组装 IA32。假设 -4(%ebp)=x 和 -8(%ebp)=y 我已经从用户那里得到它们（都是 32 位长）。这是代码：

```
format1:    .string "Multiply : %u * %u = %llu\n"
format2:    .string "Divide : %u / %u = %u\n"

# operation multiply
movl    -4(%ebp),   %eax
mull    -8(%ebp)
pushl   %edx
pushl   %eax
pushl   -8(%ebp)
pushl   -4(%ebp)
pushl   $format1
call    printf

# operation divide
movl    -4(%ebp),    %eax   
divl    -8(%ebp)
pushl    %eax
pushl   -8(%ebp)
pushl   -4(%ebp)
pushl   $format2
    call    printf 
```

乘法结果在 %llu 中的原因是因为我希望能够将 2 个长数字相乘并打印结果，即使它达到 64 个字节。而且在 %edx 中，mull 命令保存了 64 字节结果的“其他 32 字节”，所以我需要将它推送到堆栈以及 printf。例如我想要这个输出：

```
 Multiply : 4000000000 * 2 = 16000000000 
```

另外，我希望 3 与 4 的除法运算返回 X.YZ 结果。（尾数中不超过 2 个数字，并且不四舍五入）例如

```
Divide : 3 / 4 = 0.75 
```

对于 19 和 1000：

```
Divide : 19 / 1000 = 0.01 
```

对于 8 和 2：

```
Divide : 8 / 2 = 4.00 
```

我真的很努力地得到结果，但没有成功。多谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:10:46.717

`mull`用于整数乘法和`divl`整数除法。对于浮点数，您可以使用浮点指令`fmul`和`fdiv`.

另一种方法是正如 Jerry Coffin 在他的评论中建议的那样，在整数乘法之前缩放因子，例如。乘以 100 并将得到的整数视为 100*100 = 10000 倍太大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:12:55.860

乘法[应该按原样工作](http://ideone.com/nBcKkI)。如何除以得到浮点结果我已经[在你的另一个问题中回答了](https://stackoverflow.com/questions/13554394/assembly-printing-float/13554927)。如果您只需要将它们打印到两位数，则可以使用适当的格式字符串。

**更新**：显示截断为两位数的工作代码：

```
.comm x,4,4
.comm y,4,4

.section    .rodata

format1:    .string "Div : %d / %d = %.2f\n"
format2:    .string "Mod : %d %% %d = %d\n"
format3:    .string "Multiply : %u * %u = %llu\n"
format4:    .string "%d %d"
const100:   .int 100

.text
.globl  main
.type   main, @function
main:
    subl $32, %esp # allocate space, preserve alignment

    movl $format4, (%esp)
    movl $x, 4(%esp)
    movl $y, 8(%esp)
    call scanf

# operation divide
    fildl x
    fimul const100
    fidivl y
# truncate to integer
# use this if current FPU rounding mode
# is known to be truncate
#   frndint
# otherwise use this
    fnclex
    fnstcw (%esp)       # save a copy to modify
    fnstcw 2(%esp)      # and a copy to preserve
    orw $0x0c00, (%esp) # rounding mode = truncate
    fldcw (%esp)        # activate
    frndint             # do the truncate
    fldcw 2(%esp)       # restore original
# end of truncate code
    fidiv const100
    fstpl 12(%esp) # x / y

    movl $format1, (%esp)
    movl x, %eax
    movl %eax, 4(%esp)
    movl y, %eax
    movl %eax, 8(%esp)
    call printf

# operation modulo
    movl x, %eax
    cltd
    idivl y
    movl $format2, (%esp)
    movl x, %eax
    movl %eax, 4(%esp)
    movl y, %eax
    movl %eax, 8(%esp)
    movl %edx, 12(%esp)
    call printf

# operation multiply
    movl x, %eax
    mull y
    movl $format3, (%esp)
    movl x, %ecx
    movl %ecx, 4(%esp)
    movl y, %ecx
    movl %ecx, 8(%esp)
    movl %eax, 12(%esp)
    movl %edx, 16(%esp)
    call printf

    addl $32, %esp
    xor %eax, %eax
    ret 
```

[见操作](http://ideone.com/qmsrPO)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T23:49:17.300

[你可以在这里](http://x86asm.net/articles/working-with-big-numbers-using-x86-instructions/)找到一些有用的例子

这是一个如何将**两个**32 位数字相乘并输出**64**位结果的示例 [Linux, GCC]：

```
#include <stdio.h>

char *fr = "MUL %u * %u = %llu\n";

int main()
{
        __asm__ (
                        "subl $0x14, %esp\n\t"
                        "movl $10, %eax\n\t"
                        "movl %eax, 0x4(%esp)\n\t"
                        "movl $100, %ebx\n\t"
                        // Multimpy two 32bit values and save 64bit result in edx:eax
                        "mull %ebx\n\t"

                        // Call printf
                        "movl fr, %esi\n\t"
                        "movl %esi, (%esp)\n\t"
                        "movl %ebx, 0x8(%esp)\n\t"
                        "movl %eax, 0xC(%esp)\n\t"
                        "movl %edx, 0x10(%esp)\n\t"
                        "call printf\n\t"
                        "addl $0x14, %esp\n\t");

        return 0;
}

gcc -m32 ./ttt.c; ./a.out
MUL 10 * 100 = 1000 
```

对于除法，您需要将数据转换为浮点值并使用`fdiv`指令。

PS。`push`更改`%esp`，因此您必须对`pop`还原堆栈指针执行相同的次数。否则你会得到未定义的行为。

# java - 如何在 EJB 模块中使用 log4j？

> ID：13594676
> 
> 赞同：1
> 
> 时间：2012-11-27T22:53:10.163
> 
> 标签：java, log4j, ejb

我有一个使用 Netbeans 和 glassfish 3.1.2 的 EJB 模块。我需要实现日志，但我不知道如何在 EJB 中配置 log4j。我在部署时遇到了这个问题：

```
SEVERE: log4j:ERROR Ignoring configuration file [file:/C:/Users/Luis Carlos/AppData/Roaming/NetBeans/7.2/config/GF3/domain1/config/log4j.properties].
SEVERE: log4j:WARN No appenders could be found for logger (beans.RutasBean).
SEVERE: log4j:WARN Please initialize the log4j system properly.
SEVERE: log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info. 
```

它显示在 glassfish 服务器控制台中。

这是 log4j.properties 文件：

```
log4j.rootLogger=DEBUG, FILE
log4j.logger.myapp=DEBUG
log4j.appender.FILE=org.apache.log4j.RollingFileAppender 
log4j.appender.FILE.File=/space/gfv3/v3setup/GlassFish3/GlassFish/domains/domain1/logs/log4j.log
log4j.appender.FILE.MaxFileSize=100KB 
log4j.appender.FILE.MaxBackupIndex=1 
log4j.appender.FILE.layout=org.apache.log4j.PatternLayout 
log4j.appender.FILE.layout.ConversionPattern=%d{DATE} %-5p %c{1} : %m%n 
```

我试过 [了](https://blogs.oracle.com/naman/entry/configure_log4j_for_use_in) ，它说我必须在 glassfish 的服务器管理员中配置这样的属性文件， `-Dlog4j.configuration=file:///${com.sun.aas.instanceRoot}/config/log4j.properties` 但没有用

我有一个 Singleton Session Bean，在启动方法中我配置了日志，所以据此[我](http://blog.rueedlinger.ch/2010/09/initialize-log4j-with-an-ejb-3-1-startup-bean/)在 bean 中有：

```
 private Logger log;
private static final String LOG4J_PROPERTIES = "/log4j.properties";

@PostConstruct
public void startup(){
    URL url = this.getClass().getResource(LOG4J_PROPERTIES);
    if(url == null || url.getFile().length() == 0) {
    throw new RuntimeException("Log4j config file "+ LOG4J_PROPERTIES +" not found");
}
    PropertyConfigurator.configure(url);
    log = Logger.getLogger(this.getClass());
    log.info("Starting application");
    em = Persistence.createEntityManagerFactory("BuscaBus-ejbPU");
    rutaController = new RutaJpaController(ut, em);
    actualizarCoordenadasRutas();
    ...
} 
```

但仍然出现同样的错误

如何在 EJB 环境中配置 log4j？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T00:36:21.627

请执行下列操作：

1.  `-Dlog4j.configuration=`从您的服务器中删除。
2.  删除`log4j.properties`您可能放入的任何内容`C:/Users/Luis Carlos/AppData/Roaming/NetBeans/7.2/config/GF3/domain1/config`
3.  删除以下代码：

    ```
    URL url = this.getClass().getResource(LOG4J_PROPERTIES);
    if(url == null || url.getFile().length() == 0) {
    throw new RuntimeException("Log4j config file "+ LOG4J_PROPERTIES +" not found"); 
    ```

4.  删除这个：`PropertyConfigurator.configure(url);`

完成上述步骤后，您的代码就可以让 Log4J 自动`log4j.properties`从**classpath**加载其文件。根据我的经验，这是配置 Log4J 最灵活的方式。剩下要做的就是确保它`log4j.properties`确实存在于类路径中的某个地方。

您有以下选择：

1.  将`log4j.properties`文件放在 EJB 模块的默认包中。这样，该`log4j.properties`文件将与您的应用程序一起打包。这有利有弊，但这是另一回事（很可能属于不同的问答线程）。
2.  将其`log4j.properties`放在文件系统上的某个目录中，并将该目录添加到服务器的类路径中。请按照 GlassFish 文档了解如何执行此操作。

如果您坚持让`log4j.properties`URL 引用该文件，则恢复该`-Dlog4j.configuration=`指令。确保您提供的指定`log4j.properties`文件的 URL**确实存在**。另外，指定`-Dlog4j.debug=true`; 这将为您提供来自 Log4J 本身的调试信息，准确地告诉您它在做什么。

# c++ - QObject::connect 未将信号连接到插槽

> ID：13594677
> 
> 赞同：5
> 
> 时间：2012-11-27T22:53:17.900
> 
> 标签：c++, qt, user-interface, signals-slots

我在我的项目中使用 C++ 和 Qt，我的问题是 QObject::connect 函数没有将信号连接到插槽。我有以下课程：

```
class AddCommentDialog : public QDialog
{
    Q_OBJECT

public:
    ...some functions 

signals:
    void snippetAdded();

private slots:
    void on_buttonEkle_clicked();

private:
    Ui::AddCommentDialog *ui;
    QString snippet;
}; 
```

我的主窗口的一部分：

```
class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();

private slots:
    void commentAddedSlot();
    void variableAddedSlot();
    ...

private:
    AddCommentDialog *addCommentDialog;
    ...
}; 
```

Ant最后一个对话框；

```
class AddDegiskenDialog : public QDialog
{
    Q_OBJECT

public:
    ...

signals:
    void variableAdded();

private slots:
    void on_buttonEkle_clicked();

private:
    Ui::AddDegiskenDialog *ui;
    ...
}; 
```

在主窗口构造函数中，我连接信号和插槽：

```
addCommentDialog=new AddCommentDialog();
addDegiskenDialog=new AddDegiskenDialog();

connect(addDegiskenDialog, SIGNAL(variableAdded()), this, SLOT(variableAddedSlot()));
connect(addCommentDialog, SIGNAL(snippetAdded()), this, SLOT(commentAddedSlot())); 
```

关键是我的commentAddedSlot 已成功连接到它的信号，但commentAddedSlot 失败。有 Q_OBJECT 宏，没有关于 no x slot 的警告。除此之外，receives(SIGNAL(snippetAdded())) 给了我 1，但 receivers(SIGNAL(variableAdded())) 给了我 0，我使用了命令 qmake -project; qmake 和 make 完全编译。我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T07:35:23.560

快速查看您的代码不知道您的问题是什么。

但是，这里有一些时刻：

1.  正如迈克[在这里](https://stackoverflow.com/a/4463909/867349)所说：如果出现连接问题，请始终确保检查控制台以获取有关连接失败的消息。由于 Qt 直到运行时才能判断连接是否有意义，它会通知您那里的故障。你会认为它会崩溃，但它只是在控制台中悄悄地说出这些事情。使用 Qt，始终观看控制台是有意义的。当您遇到问题时，Qt 会打印出各种可以提供帮助的错误消息。
2.  你可以控制`connect`函数的结果，所以（来自官方文档）

    > 如果成功将信号连接到插槽，则该函数返回 true。如果它无法创建连接，它将返回 false，例如，如果 QObject 无法验证信号或方法的存在，或者它们的签名不兼容。

3.  检查您的对象（对话框）是否创建良好并且指针不等于`NULL`.

4.  尝试清除您的项目（QtCreator 中的“清除项目”命令），甚至手动删除`ui_*`所有`moc_*`. 然后重新编译它。

祝你好运！并且，请给我们反馈。

# functional-programming - 在纯函数式语言中，数据（字符串、整数、浮点数..）也只是函数吗？

> ID：13594683
> 
> 赞同：12
> 
> 时间：2012-11-27T22:53:31.100
> 
> 标签：functional-programming, lambda-calculus, purely-functional

我在考虑像 Ruby 这样的纯面向对象语言，其中包括数字、int、浮点数和字符串在内的所有内容本身都是对象。这与纯函数式语言相同吗？例如，在 Haskell 中，数字和字符串也是函数吗？

我知道 Haskell 是基于 lambda 演算的，它将所有内容（包括数据和操作）都表示为函数。在我看来，“纯函数式语言”将一切建模为函数，并保持函数最总是返回具有相同输入且没有状态的相同输出的定义，这似乎是合乎逻辑的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-27T22:58:59.257

理论上可以考虑，但是...

就像在 Ruby 中不是*所有东西*都是对象（例如，参数列表[不是对象](http://rubylearning.com/blog/2010/09/27/almost-everything-is-an-object-and-everything-is-almost-an-object/ "不是对象")）一样，在 Haskell 中也不是所有东西都是函数。

如需更多参考，请查看这篇简洁的帖子：[http ://conal.net/blog/posts/everything-is-a-function-in-haskell](http://conal.net/blog/posts/everything-is-a-function-in-haskell)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-27T23:13:30.473

@wrhall 给出了一个很好的答案。但是，您有点正确，在纯 lambda 演算中，一切都是函数是一致的，并且该语言是图灵完备的（能够表达 Haskell 等的任何纯计算）。

这给了你一些非常奇怪的东西，因为你唯一能做的就是把它应用到别的东西上。你什么时候能观察到一些东西？你有一些价值`f`并且想知道一些关于它的东西，你唯一的选择是将它应用一些值`x`来获取`f x`，这是另一个函数，唯一的选择是将它应用到另一个值`y`，获取`f x y`等等。

我经常将纯 lambda 演算解释为谈论对不是函数但只能表达函数本身的事物的转换。也就是说，我可以创建一个函数（使用一些 Haskelly 语法糖进行递归 & 让）：

```
purePlus = \zero succ natCase -> 
   let plus = \m n -> natCase m n (\m' -> plus m' n)
   in plus (succ (succ zero)) (succ (succ zero)) 
```

这里我已经表达了计算`2+2`，而不需要知道有非函数之类的东西。我只是将我需要的东西作为我正在定义的函数的参数，这些参数的值可以是教堂编码，也可以是“真实”数字（无论这意味着什么）——我的定义不在乎。

你也可以想到 Haskell。没有特别的理由认为有些东西不是函数，也没有特别的理由认为一切都是函数。但是 Haskell 的类型系统至少可以防止您将参数应用于数字（`fromInteger`现在正在考虑的任何人都需要保持沉默！:-)。在上面的解释中，这是因为数字*不一定*被建模为函数，所以你*不一定*对它们应用参数。

如果现在还不清楚，那么整个答案在某种程度上是技术/哲学的题外话，而您的问题的简单答案是“不，并非所有内容都是函数式语言中的函数”。函数是你可以应用参数的东西，仅此而已。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-28T01:24:15.283

这个问题的角度非常不同：Haskell 中的各种数据都可以表示为函数，使用一种称为**[Church 编码](http://en.wikipedia.org/wiki/Church_encoding)**的技术。这是一种控制反转的形式：不是将数据传递给使用它的函数，而是将数据隐藏在一组闭包中，并使用它传递回调来描述如何处理这些数据。

例如，任何使用列表的程序都可以翻译成使用函数而不是列表的程序：

```
-- | A list corresponds to a function of this type:
type ChurchList a r = (a -> r -> r)  --^ how to handle a cons cell
                   -> r              --^ how to handle the empty list
                   -> r              --^ result of processing the list

listToCPS :: [a] -> ChurchList a r
listToCPS xs = \f z -> foldr f z xs 
```

该功能以具体列表为起点，但这不是必需的。您可以仅从纯函数构建`ChurchList`函数：

```
-- | The empty 'ChurchList'.
nil :: ChurchList a r
nil = \f z -> z

-- | Add an element at the front of a 'ChurchList'.
cons :: a -> ChurchList a r -> ChurchList a r
cons x xs = \f z -> f z (xs f z)

foldChurchList :: (a -> r -> r) -> r -> ChurchList a r -> r
foldChurchList f z xs = xs f z

mapChurchList :: (a -> b) -> ChurchList a r -> ChurchList b r
mapChurchList f = foldChurchList step nil
    where step x = cons (f x)

filterChurchList :: (a -> Bool) -> ChurchList a r -> ChurchList a r
filterChurchList pred = foldChurchList step nil
    where step x xs = if pred x then cons x xs else xs 
```

最后一个函数使用`Bool`，当然我们也可以`Bool`用函数替换：

```
-- | A Bool can be represented as a function that chooses between two 
-- given alternatives.
type ChurchBool r = r -> r -> r

true, false :: ChurchBool r
true a _ = a
false _ b = b

filterChurchList' :: (a -> ChurchBool r) -> ChurchList a r -> ChurchList a r
filterChurchList' pred = foldChurchList step nil
    where step x xs = pred x (cons x xs) xs 
```

这种转换基本上可以对任何类型进行，所以理论上，你可以去掉 Haskell 中的所有“值”类型，只保留`()`类型、`(->)`和`IO`类型构造函数、`return`for`>>=`和`IO`一组合适的`IO`原语。这显然是不切实际的——而且效果会更差（尝试写作`tailChurchList :: ChurchList a r -> ChurchList a r`以换取品味）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-28T03:18:17.293

“纯功能”中的“纯”是指“无副作用”的纯。当人们谈论“纯面向对象的语言”时，它与“纯”的含义几乎没有关系，这只是意味着该语言纯粹（仅）在对象中进行操作。

原因是 pure-as-in-only 是用于分类面向对象语言的合理区别，因为有像 Java 和 C++ 这样的语言，它们的值显然与对象没有太多共同之处，还有像 Python 和 Ruby 这样的语言，可以说每个值都是一个对象¹

而对于函数式语言，**没有**“纯函数式”的实用语言，因为语言可以操作的每个值都是函数。用这种语言编程当然是*可能的。*lambda 演算的最基本版本没有任何非函数事物的概念，但是您仍然可以通过提出将要计算的事物*表示为函数的方法来对它们进行任意计算。*²

但是，虽然 lambda 演算的简单性和极简主义往往非常适合证明*有关*编程的事情，但实际上用这种“原始”编程语言编写大量程序是很尴尬的。像数字这样的基本事物的函数表示在实际的物理机器上实现也往往效率很低。

但是，鼓励函数式风格但在任何地方都允许未跟踪的副作用的语言与实际上强制您的函数是“纯”函数（类似于数学函数）的语言之间存在一个*非常重要的区别。*面向对象的编程与不纯计算的使用非常紧密³，因此没有实用的面向对象的编程语言在这个意义上是纯粹的。

所以“纯函数式语言”中的“纯”与“纯面向对象语言”中的“纯”有很大不同。⁴在每种情况下，“纯与非纯”的区别对于另一种语言来说完全没有意义，因此没有非常强烈的动机来规范该术语的使用。

* * *

¹在我所知道的所有“纯面向对象”语言中都有一些极端情况可供选择，但这并不是很有趣。很明显，对象隐喻在作为某个类的实例的语言中走得更远`1`，并且该类可以被子类化，而不是在`1`不是对象的语言中。

² 无论如何，所有计算都是关于表示的。计算机对数字或其他任何东西一无所知。它们只是具有我们用来*表示*数字的位模式，以及恰好对应于数字操作的位模式上的操作（因为我们设计它们是为了让它们这样做）。

³这也不是根本的。你*可以*设计一种在这个意义上是纯粹的“纯粹的”面向对象的语言。无论如何，我倾向于将我的大部分 OO 代码编写为纯粹的。

⁴如果这看起来很迟钝，您可能会认为“功能”、“对象”和“语言”这些术语在其他上下文中也有截然不同的含义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-28T10:30:09.580

是`getChar :: IO Char`函数还是不函数？Haskell 报告没有为我们提供定义。但它声明这`getChar` *是一个函数*（见[这里](http://www.haskell.org/onlinereport/haskell2010/haskellch7.html#x14-1420007)）。（好吧，至少*我们可以说它是一个函数*。）

所以我认为答案是*肯定*的。

我认为除了“一切都是函数”之外，“函数”不能有正确的定义。（什么是“正确定义”？好问题......）考虑下一个例子：

```
{-# LANGUAGE NoMonomorphismRestriction #-}
import Control.Applicative

f :: Applicative f => f Int
f = pure 1

g1 :: Maybe Int
g1 = f

g2 :: Int -> Int
g2 = f 
```

是`f`函数还是数据类型？这取决于。

# jquery - 如何从子div更改父div中的内容？

> ID：13594686
> 
> 赞同：0
> 
> 时间：2012-11-27T22:53:50.310
> 
> 标签：jquery

我正在尝试从子 div 修改父 div 中的文本而不更改子 div 内容。

我有

```
<div id='testDiv'>
    this is the test parent div
    <div id='child1'>
         lots of contents and child div
         ...................
    </div>
    more div/child div and contents...

</div> 
```

在我的jQuery中

```
$('child1 div a').click(function(){
    $('#testDiv').text('new text');  //this will remove the child1 div and all the contents inside testDiv
    //I want to replace 'this is the test parent div' text to 'newt text' 
}) 
```

有没有办法完成这件事？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:07:33.237

尝试混合使用`.filter()`和`.contents()`

```
$('#child1 div a').click(function() {
    $('#testDiv').contents().filter(function() {
        if (this.nodeType != 1 && this.data.trim() != '') {
            return this.data = 'New Text';
        }
        else {
            return this
        };
    });
})​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/5atGZ/)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T23:09:09.687

您可以使用`firstChild`属性：

```
​document.getElementById('testDiv').firstChild.nodeValue = 'new text'​​; 
```

[http://jsfiddle.net/vstHS/](http://jsfiddle.net/vstHS/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:59:48.833

如果将文本包装在跨度中，则更改它会更容易：

```
$('#testDiv').contents()
             .filter(function(){return this.nodeType === 3})
             .wrap($('<span />',{'class':'test'}));

$('.test').text('new text'); 
```

[**小提琴**](http://jsfiddle.net/szfrd/1/)

如果 span 元素导致某种问题，您当然可以在 textnode 更改后展开它？​</p>

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-27T22:57:18.250

您只需要包含要更改为另一个 div 的部分并直接定位它...

```
<div id='testDiv'>
    <div id='changeMe'>
        this is the test parent div
    </div>
    <div id='child1'>
         lots of contents and child div
         ...................
    </div>
    more div/child div and contents...
</div> 
```

jQuery：

```
$('child1 div a').click(function(){
    $('#changeMe').text('new text');
}) 
```

# java - 当前运行Activity的调用函数

> ID：13594688
> 
> 赞同：0
> 
> 时间：2012-11-27T22:53:55.263
> 
> 标签：java, android, android-activity

假设我有多个正在运行的活动；A、B 和 C。每个都共享一个相似的选项菜单，但在执行方面存在一些差异（活动 A 中的“开始”选项可能与活动 B 中的“开始”选项略有不同）。我还有一个名为“values”的静态类，它与活动 A 相关联。它还具有当前正在运行的活动的上下文。

有时值可能会调用当前运行活动的选项菜单中的项目。我的代码很乱（见下文），所以我想把它组织成更易读的形式。

我的目标是设置值，以便它可以只调用当前正在运行的活动的函数，而不是该活动的选项菜单项。在活动内部，选项菜单中的一项只会调用一个函数而不是其中的代码（出于组织原因）。

这里有一个 values.class 示例，它调用了当前正在运行的活动的选项菜单项。

```
public void startExample() {
        Runnable startRun = new Runnable() {
            @Override
            public void run() {

                handler.post(new Runnable() { // This thread runs in the
                                                // UI
                    @Override
                    public void run() {
                        ((Activity) getCurrentContext()).openOptionsMenu();
                        ((Activity) getCurrentContext()).closeOptionsMenu();
                        ((Activity) getCurrentContext()).onOptionsItemSelected(theMenu.findItem(R.id.start));
                    }
                });
            }
        };
        new Thread(startRun).start();
} 
```

如您所见， values.startExample() 调用当前正在运行的活动的选项菜单的开始项。我想更改它，以便它根据当前正在运行的活动调用一个函数。所以我在想我可以做这样的事情。

在 values.class 中

```
ActivityB b = new ActivityB
public void startExample() {
    Runnable startRun = new Runnable() {
        @Override
        public void run() {

            handler.post(new Runnable() { // This thread runs in the
                                            // UI
                   @Override
                public void run() {
                    if( ((Activity) getCurrentContext()).getClass().getName().equals("package.ActivityB") ) {
                     b.start();
                    }
                }
            });
        }
    };
    new Thread(startRun).start();
} 
```

活动 B 可能看起来像。

```
public class ActivityB extends Activity {
//class code here

@Override
 public boolean onOptionsItemSelected(MenuItem item) {
        switch(item.getItemId()) {
               case start:
                    this.start();
                    break;

        }

  }
  public void start() {
       //code here
  }
} 
```

这可能吗？我知道这个问题可能听起来令人困惑，所以请提出问题，我也许可以再次简化它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:11:43.673

不不不不不。这就像将撬棍拉到 Android 上然后将其粉碎。活动并不意味着通过`new`.

如果您想要的只是不同活动在其 onOptionsItemSelected() 中调用的方法之间存在一些共享行为，那么要么创建一个超级活动并调用超级活动，然后再在特定子类中添加您想要的任何行为，或者创建所有活动都可以访问的函数，该函数包含不变的内容，然后在子类中添加发生变化的内容。无论哪种方式，Activity 都意味着通过在 startActivity 等中提供对类的引用来运行。您不能将 Activity 视为普通的 java 对象（即使它最终是），因为它的生命周期由系统。

# javascript - 在 HTML 中创建循环以从目录中自动加载图片

> ID：13594694
> 
> 赞同：1
> 
> 时间：2012-11-27T22:54:19.967
> 
> 标签：javascript, html, directory

我知道这些问题也有类似的问题，但我不知道如何用足够短的词来进行搜索，所以我会在这里尝试。

基本上我有一个我正在设计的网站，我们想在网站上做一个旋转横幅。我找到了人们设计横幅的代码，但似乎每一个我发现的代码都会强制您根据他们的行为将图像本身硬编码为 HTML 或 Java 脚本。所以我的问题是：

有没有办法让我能够遍历文件夹的内容，并且每当它获得名称时，显示名称“x”时间然后拉下一张图片？

我可以在睡梦中用 Java 或 C# 做到这一点，但是当涉及到 JS 和 HTML 之类的东西时，我会感到困惑。

感谢您的帮助..

这是我正在使用 Java Script 查看的当前图像加载代码。

```
var ImageLoad = 
[
['index.htm',   'graphics/one.jpg',     'Blue Flower'           ],
['index.htm',   'graphics/two.jpg',     'Distant Rainstorm'     ],
['index.htm',   'graphics/three.jpg',   'Raindrops on a Leaf'           ],              
['index.htm',   'graphics/four.jpg',    'Jungle Dream'          ],
['index.htm',   'graphics/five.jpg',    'Daisies'           ],
['index.htm',   'graphics/six.jpg',     'Sunflowers'            ]
]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-29T15:41:48.213

不幸的是，当时我没有很多资源。现在我想说最好的选择是创建一个 rest 调用，它可以提取位于所需文件夹中的所有文件，然后以 json 格式返回它们并循环遍历它们。

我从未实现过这一点，但我会赞扬那里的 2 篇文章。

谢谢您的帮助！

# php - 在我的 PHP 中添加 input type=file 元素

> ID：13594696
> 
> 赞同：0
> 
> 时间：2012-11-27T22:54:31.113
> 
> 标签：php, file, file-upload, input

我有一个表格。具有以下内容：

HTML：

```
<form name="feedback_form" method="post" action="" class="feedback_form">
    <input type="text" name="field-name" value="İsim" title="İsim" class="field-name form_field">
    <input type="text" name="field-email" value="Email" title="Email" class="field-email form_field">
    <input type="text" name="field-subject" value="Başlık" title="Başlık" class="field-subject form_field">
    <textarea name="field-message" cols="45" rows="5" title="Mesajınız..." class="field-message form_field">Mesajınız...</textarea>
    <label for='uploaded_file'>Fotoğrafınızı Yükleyin:</label>
    <input type="file" name="field-file" value="File">
    <br>
    <input type="reset" name="reset" id="reset2" value="Temizle" class="feedback_reset">
    <input type="button" name="submit" class="feedback_go" id="submit2" value="Gönder">                                    
</form> 
```

PHP：

```
<?php
header('Content-Type: text/html; charset=utf-8');

function sendFeedback($feedback_email, $feedback_msg, $feedback_name, $feedback_subject, $feedback_file) {

    /* EDIT THIS */
    $admin_email = "mymail@gmail.com";
    if ($feedback_subject == "Subject" || empty($feedback_subject) ) {
        $subj = "Email from your site";
    } else {
        $subj = $feedback_subject;
    }

    /* //EDIT THIS */

    $message = "
    <html>
    <head>
      <title>Websitenizin emaili</title>
    </head>
    <body>
        <p><a href='mailto:".$feedback_email."'>".$feedback_name."</a> send this message:</p>
        <p>".$feedback_msg."</p>
        <p>".$subject."</p>
    </body>
    </html>
    ";
    $headers  = 'MIME-Version: 1.0' . "\r\n";
    $headers .= 'Content-type: text/html; charset=UTF-8' . "\r\n";

    if ($feedback_name!=="Name" && $feedback_email!=="Email" && !empty($feedback_email) && !empty($feedback_msg) && !empty($feedback_name) ) {
        if ($feedback_email == "mail_error") {
            echo "<span class='ajaxok'>Geçersiz email adresi.</span>";
        } else {            
            mail($admin_email, $subj, $message, $headers);
            echo "<span class='ajaxok'>Teşekkürler. Mesajınız gönderilmiştir.</span>";  
        }
    } else {
        echo "<span class='ajaxalert'>Lütfen zorunlu alanları doldurunuz.</span>";      
    }

}

sendFeedback($_POST['email'], $_POST['message'], $_POST['name'], $_POST['subject'], $_POST['file']);

?> 
```

在此表单上发送消息时，发送电子邮件，工作。但只有主题、消息、姓名和电子邮件。我想在这个 php 代码中添加图片上传。但我不知道我该怎么做？请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:58:34.107

在您必须输入的表格中`enctype="multipart/form-data"`。在您的 php 文件中，您可以通过`$_FILES['file'];` 然后查看本[教程来访问该文件](http://www.w3schools.com/php/php_file_upload.asp)

# java - Dijkstra 算法 - 优先队列问题

> ID：13594699
> 
> 赞同：1
> 
> 时间：2012-11-27T22:54:59.773
> 
> 标签：java, priority-queue, dijkstra

我有一个带有一堆节点、边等的 Graph 类，我正在尝试执行 Dijkstra 算法。我开始将所有节点添加到优先级队列中。每个节点都有一个布尔标志，表明它是否已经“已知”，一个对它之前的节点的引用，以及一个存储其来自源节点的长度的 int dist 字段。在将所有节点添加到 PQ 并适当标记源节点之后，我注意到错误的节点首先从 PQ 中拉出。应该是具有最小 dist 字段的节点首先出现（因为除了源之外，它们都被初始化为一个非常高的数字，所以 PQ 的第一个节点应该是源......除了它不适合某些原因）。下面是我的算法代码，后面是我的 Node 类中的 compare 方法。

```
 public void dijkstra() throws IOException {
    buildGraph_u();
    PriorityQueue<Node> pq = new PriorityQueue<>(200, new Node());

    for (int y = 0; y < input.size(); y++) {
        Node v = input.get(array.get(y));
        v.dist = 99999;
        v.known = false;
        v.prnode = null;
        pq.add(v);
    }

    source.dist = 0;
    source.known = true;
    source.prnode = null;
    int c=1;
    while(c != input.size()) {
        Node v = pq.remove();
        //System.out.println(v.name);
                    //^ Prints a node that isn't the source
        v.known = true;
        c++;
        List<Edge> listOfEdges = getAdjacent(v);
        for (int x = 0; x < listOfEdges.size(); x++) {
            Edge edge = listOfEdges.get(x);
            Node w = edge.to;
            if (!w.known) {
                int cvw = edge.weight;
                if (v.dist + cvw < w.dist) {
                    w.dist = v.dist + cvw;
                    w.prnode = v;
                }
            }
        }
    }
} 
```

* * *

```
public int compare (Node d1, Node d2) {
       int dist1 = d1.dist;
       int dist2 = d2.dist;
       if (dist1 > dist2) 
         return 1;
       else if (dist1 < dist2) 
         return -1;
       else 
         return 0;
     } 
```

谁能帮我找出我的 PQ 的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:10:42.223

优先级队列假设插入元素后顺序不会改变。

因此，除了将所有元素插入优先级队列之外，您还可以：

1.  从一个节点开始。

2.  在优先级队列不为空时循环。

3.  如果元素是“已知的”，则什么也不做。

4.  每当您发现较小的距离时，将其添加到具有“正确”权重的优先级队列中。

5.  所以你需要在优先级队列中存储一个其他的东西，一对：插入时的距离，节点本身。

# excel - 根据特定单元格的值重复向左复制粘贴的宏

> ID：13594701
> 
> 赞同：1
> 
> 时间：2012-11-27T22:55:07.617
> 
> 标签：excel, repeat, vba

我对 VBA 完全陌生。我有一个需要将数据与日期对齐的电子表格。随着工作表的更新，日期会动态变化。

基本上，下面的宏将一列上的数据向左移动（用从 K 列到 Q 的数据替换 J 列）并清除 Q 中的现有数据。数据只是值、公式和格式的组合。下面的宏有效，但是我需要它重复自身的次数，无论单元格 E3 中的值是多少（此单元格将考虑重新对齐数据的时间延迟）。

所以基本上有人可以根据 E3 中的值（如果它大于 1）帮助这个重复这个宏然后在E3中添加一个`IF ("E3") > 1`然后移动`Range("K6:P500")`的次数。我试过这样做，但我不知道如何重复，而且我放在一起的 IF 并没有真正起作用。

再次非常感谢您提供任何帮助的建议！

```
' Week_update Macro
'
' Keyboard Shortcut: Ctrl+Shift+W
'
    Range("K6:Q500").Select
    Selection.Copy
    Range("J6").Select
    ActiveSheet.PasteSpecial Format:=2, Link:=1, DisplayAsIcon:=False, _
        IconFileName:=False
    Range("Q6").Select
    Range("Q6:Q500").Select
    Selection.SpecialCells(xlCellTypeConstants, 1).Select
Selection.ClearContents
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:26:11.067

假设您的意思是将 E3 行中包含的所有列向右移动，这将满足您的要求。

如果您使用`Cells`符号而不是`A1:B1`.

```
Sub Week_update()
Dim i As Long
    i = Range("E6")
    If i > 0 Then
        ' Copy range
        Range(Cells(6, 10 + i), Cells(500, 18)).Copy
        ' Select range the same size but i columns to the right
        Range(Cells(6, 10), Cells(500, 18 - i)).Select
        ' Paste special
        ActiveSheet.PasteSpecial Format:=2, Link:=1, _
            DisplayAsIcon:=False, IconFileName:=False
        ' Clear i columns on the right
        Range(Cells(6, 18 - i), Cells(500, 18)).ClearContents
    End If
End Sub 
```

如果您确实需要`PasteSpecial`. 如果没有，那么您可以使用：

```
Sub Week_update()
Dim i As Long
    i = Range("E6")
    If i > 0 Then
        ' Copy range i columns to the left
        Range(Cells(6, 11), Cells(500, 17)).Copy( _
            Range(Cells(6, 11 - i), Cells(500, 17 - i)))
        ' Clear i columns on the right
        Range(Cells(6, 17 - i), Cells(500, 17)).ClearContents
    End If
End Sub 
```

# php - 间歇性 JSON 结果

> ID：13594702
> 
> 赞同：0
> 
> 时间：2012-11-27T22:55:13.377
> 
> 标签：php, jquery, ajax, json

晚上好，

我正在开发一个表单处理器，该处理器确定发送给它的表单处理和电子邮件/有时需要将结果返回到我的 jquery 以进行进一步的客户端处理。我遇到的问题是第一次运行脚本时它返回数组，但任何后续运行都不会返回数据。

**PHP的**

```
 switch ($form){
    case 'cta':
        echo json_encode(array('callback' => 'cta'));
        //echo"";
        break;
    case "questionaire":

        echo json_encode(array('callback' => 'quetionaire'));
        break;
    case "contact":

        echo json_encode(array('callback' => 'contact'));
} 
```

**jQuery**

```
function doEmail(form){
$.ajax({
   data: $(form).serialize(),
   type: 'POST',
   url: 'core/process.php',
   dataType: 'json',
   success: function(data){
    $(form +' input, textarea').each(function(){$(this).val("") })
    $('#lightbox').fadeOut(600)
    $('#responder').fadeOut(600)
    alert('form name '+ data.callback);

   }
 })     
}
function inputProcessor(event, form){
var $name = $(form + ' input#name').val();
var $phone = $(form + ' input#phone').val();
var $email = $(form + ' input#email').val();
var $msg = $(form + ' textarea#msg').val();

var $i = 0;
var $i1 = 0;
$(form +' [req=yes]').each(function() {
    console.log('step 1')
        $i++;
        $(this).css('background-color', '');
        if(!$(this).val().length) {
            event.preventDefault();
            $(this).css('background-color', '#ffd7d7');                
        }
    });
    $(form +' [req=yes]').each(function() {
        console.log('step 2')
        if($(this).val().length > 0){
            event.preventDefault();
            $i1++;                
        }
    });
    //if($i1 === $i){            
        var result = regex.test($email)
        console.log('step 3')
        if (result === true){
            event.preventDefault();
            console.log('Testing Email')
            doEmail(form);
        }else{
            $(form +' input#email').css('background-color', '#ffd7d7');                
        }                
    //}
} 
```

还应该注意的是，该站点从不刷新所有驻留在隐藏 div 中的内容，这些内容在单击“页面”链接时会显示出来。

提前致谢

编辑“我实际上必须退出浏览器并重新启动它才能获得一个新数组”

编辑 2

**1 的 3 形式**

```
<form id="cta"  method="post">
<input type="text" req="yes" id="name" class="input"   name="name" placeholder="Full Name"/><br>
<input type="text" req="yes" id="phone" class="input" name="phone" placeholder="Phone Number"/><br>
<input type="text" req="yes" id="email" class="input" name="email" placeholder="Email Address"/><br>     
<input type="hidden" name="form" value="cta">
<span id="submit_btn">Submit entry</span>
</form> 
```

**3 个表格中的 2 个**

```
<form id="contact_form" class=contact_form method="post">                            
<input type="text" req="yes" id="name" class="input3" name="name" placeholder="Name"/>
<br>  <br>
<input type="text" req="yes" id="phone" class="input3" name="phone" placeholder="Phone"/>
<br><br>
<input type="text" req="yes" id="email" class="input3" name="email" placeholder="Email"/>
<br><br>
<textarea id="msg" name="msg" placeholder="Type your message here" class="input3" rows="4"></textarea><br>
<input type="hidden" name="form" value="contact">
<span class="contact_button" id="SubmitContact"><div id="contact_submit">Send message</div></span>
</form> 
```

**3 个表格中的 3 个**

```
<form id="response" class=form1  method="post">

<input type="text" req="yes" id="name" class="input2" name="name" placeholder="Name"/>
<br>
<input type="text" req="yes" id="phone" class="input2" name="phone" placeholder="Phone"/>
<br>
<input type="text" req="yes" id="email" class="input2" name="email" placeholder="Email"/>
<br>
<textarea id="msg" name="msg" placeholder="Type your message here" class="input2" rows="4"></textarea><br>
<br>
<input type="hidden" name="form" value="questionaire">
<span class="submit_button" id="Submit"><div id="submit">Send message</div></span>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T19:58:34.597

好的，所以我在睡了一晚并意识到我需要取消设置表单变量后回答了我自己的问题。

```
 var result = regex.test($email)
        console.log('step 3')
        if (result === true){
            event.preventDefault();
            console.log('Testing Email')
            formId = $(form +' input#formId').val();
            if(formId === 'cta'){
                $('#cta_form').children().fadeOut(600)
                window.location.href = 'docs/medical-alert.pdf';
            }
            doEmail(form, formId);
        }else{
            $(form +' input#email').css('background-color', '#ffd7d7');                
        }
        $(form).remove() 
```

# ckeditor - Ckeditor 插件 - 验证文本字段

> ID：13594705
> 
> 赞同：6
> 
> 时间：2012-11-27T22:55:23.267
> 
> 标签：ckeditor

我正在创建插件我在下面有这段代码：

我要做的是确保他们输入的电子邮件地址有效。如果电子邮件地址无效，只是不确定如何停止 onOK。

谢谢

这是插件的代码片段

```
contents : [
    {
            id : 'info',
            label : editor.lang.form.title,
            title : editor.lang.form.title,
            elements : [
                    {
                            id : 'destEmail',
                            type : 'text',
                            label : 'Email form results to:',
                            'default' : 'randy@me.com',
                            required : true,
                            accessKey : 'T',
                            commit : function( element )
                            {
                                var emailRegEx = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i;
                                if (this.getValue().search(emailRegEx) == -1) {
                                    alert("Please enter a valid email address.");
                                    return false;
                                }
                                element.setAttribute('id', this.getValue() );
                            }                   
                   }
            ]
    }
] 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-28T09:33:10.973

请查看[官方样品](http://docs.ckeditor.com/#!/guide/plugin_sdk_sample_2)和`validate`属性。此时您可以编写自己的验证方法。

您还可以使用[其中一种](https://github.com/ckeditor/ckeditor-dev/blob/c98c7a9b216c71e5b3c3cab46604d91e43b80f81/plugins/dialog/plugin.js#L2903-L2999)（API 中仍未记录）。你可能想做这样的事情（CKEditor 4）：

```
...
validate: CKEDITOR.dialog.validate.regex( /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i, "Please enter a valid email address." );
... 
```

也可以组合现有的验证器和/或编写自定义验证器：

```
function customValidator( x, msg ) {
    return function() {
        var value = this.getValue(),
            pass = !!( CKEDITOR.dialog.validate.integer()( value ) && value < x );

        if ( !pass ) {
            return msg;
        }
    };
}

...   
validate: customValidator( 5, 'Error message when larger than 5.' )
... 
```

# php - 使用数组中的 php 循环更新 mysql db

> ID：13594706
> 
> 赞同：0
> 
> 时间：2012-11-27T22:55:30.810
> 
> 标签：php, foreach, sql-update

我想用循环更新mysql中的一列。我有两个数组，每 4 小时从另一个数据库中提取一次。第一个在我的数据库中有一个站号作为索引。第二个是我要更新的数据。

```
 $stano = 13235000,13236500,13237920
    $nt = 379,49,131 
```

目前我只是用一堆查询更新：

```
 mysql_query("UPDATE gages SET cfs = '".$nt[3][2]."' WHERE sgs = '".$stano[3][1]."'")
 mysql_query("UPDATE gages SET cfs = '".$nt[4][2]."' WHERE sgs = '".$stano[4][1]."'")
 mysql_query("UPDATE gages SET cfs = '".$nt[5][2]."' WHERE sgs = '".$stano[5][1]."'") 
```

运行某种循环并一次性更新所有内容似乎更有意义。但我不确定如何在每个循环中增加数组索引的数量。不幸的是，我似乎已经达到了对 php 的理解上限。当然是我的耐心，因为我花了一天时间试图弄清楚这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:58:43.657

我不明白您描述数据的方式，但是如果我基于您已经拨打的电话，我可以假设这会起作用：

```
for($i = 0; $i < count($nt); $i++) {
  mysql_query("UPDATE gages SET cfs = '".$nt[$i][2]."' WHERE sgs = '".$stano[$i][1]."'");
} 
```

# amazon-web-services - 使用 cloudformation 使用 Chef 角色标记节点

> ID：13594708
> 
> 赞同：0
> 
> 时间：2012-11-27T22:55:40.510
> 
> 标签：amazon-web-services, chef-infra, puppet, amazon-cloudformation

所以我的目标是使用 cloudformation 在云中启动 100 个节点，我想在我的 cloudformation 脚本中用厨师角色标记节点，而不是使用刀。我已经将我的 cloudformation 节点设置为自动向厨师服务器注册，我想使用向厨师服务器报告他们的角色，以便厨师服务器在每个节点上安装正确的说明书（取决于节点角色）。我知道用刀可以做到这一点，但我想将节点角色隐藏在我的 cloudformation 脚本中。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T13:10:39.937

我使用 Puppet，这当然与 Chef 略有不同，但应该适用相同的理论。我在启动新实例时（也通过 CloudFormation）发送一个 JSON 对象作为用户数据，然后在 Puppet 中访问此数据以进行动态配置。

Puppet 会自动处理很多此类问题 - 例如，它会自动为我设置 FACTOR_EC2_USER_DATA 环境变量，因此我只需将 JSON 解析为 $role 和 $environment 等变量，此时我可以动态决定实例的角色应该分配。

因此，只要您能找到某种方法来访问 Chef 中的用户数据，同样的方法应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T19:37:32.013

我和厨师一起做这个。我通常在 S3 中放置一个 json 文件，描述机器需要使用的角色。我在 CloudFormation 中创建了一个可以访问 S3 存储桶的 IAM 用户。然后，在我的用户数据脚本中，我首先从 S3 获取文件，然后运行 ​​chef-client -j /path/to/json/file。我对验证密钥 fwiw 做同样的事情，以便节点可以注册自己。

高温高压

# linq - 如何编写从子表中提取前三行的 Linq 查询

> ID：13594711
> 
> 赞同：0
> 
> 时间：2012-11-27T22:55:48.957
> 
> 标签：linq, entity-framework, linq-to-entities

我想将现有存储过程的功能重新创建为 LINQ 表达式。该过程使用“STUFF”函数将子表中的前三个字段返回到存储过程的一个字段中。我将添加一个过程片段作为参考：

```
SELECT h.ReqHeaderID,   

STUFF((SELECT TOP(3) ', ' +  l.Nomenclature     FROM    ReqLineItems  l
                                                WHERE l.ReqID  = h.ReqID 
   FOR XML PATH ('')    ),1,1, '')

As OrderedItems

FROM    ReqHeader           h 
```

有没有办法在 LINQ 中写这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T02:40:58.750

也许您可以使用[group join](http://msdn.microsoft.com/en-us/library/bb397905.aspx)，这是`join into`查询语法中的子句：

```
(from reqHeader in db.ReqHeaders
 join reqLineItem in db.ReqLineItems 
     on reqHeader.ReqID equals reqLineItem.ReqId into reqLineItems
 select new 
        {  
            reqHeader.ReqHeaderId,
            Nomenclatures = reqLineItems.Select(x => x.Nomenclature).Take(3)
        })
.AsEnumerable()
.Select(x => new
             {
                 x.ReqHeaderId,
                 Nomenclatures = String.Join(", ", x.Nomenclatures.ToArray())
             }) 
```

我在调用后加入了字符串，`AsEnumerable()`因为我相信您只能在 LINQ to Objects 中而不是在 Linq to Entities 中将字符串连接在一起。

# r - 在 rmongodb 中分组

> ID：13594714
> 
> 赞同：2
> 
> 时间：2012-11-27T22:56:06.100
> 
> 标签：r, mongodb, rmongodb

我正在尝试在 MongoDB 集合上创建一个组查询，类似于：

```
db.orders.group( {
    key: { ord_dt: 1, 'item.sku': 1 },
    cond: { ord_dt: { $gt: new Date( '01/01/2012' ) } },
    reduce: function ( curr, result ) { },
    initial: { }
} ) 
```

我正在使用 rmongodb。通过查看 rmongodb 包文档，他们使用`mongo.command`来运行计数命令：

```
mongo <- mongo.create() 
if (mongo.is.connected(mongo)) {
    buf <- mongo.bson.buffer.create() 
    mongo.bson.buffer.append(buf, "count", "people") 
    mongo.bson.buffer.append(buf, "query", mongo.bson.empty()) 
    command <- mongo.bson.from.buffer(buf) 
    result = mongo.command(mongo, "test", command) 
    if (!is.null(result)) {  
        iter = mongo.bson.find(result, "n") print(mongo.bson.iterator.value(iter)) 
    }
} 
```

也不同：

```
mongo.distinct <- function(mongo, db, collection, key) {    
    b <- mongo.command(mongo, db, list(distinct=collection, key=key))    
    if(!is.null(b))
        b <- mongo.bson.value(b, "values")
    }
names <- mongo.distinct(mongo, "test", "people", "name") 
```

有没有人成功使用`mongo.command`过进行组查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-12T13:41:32.643

这是使用聚合框架的简单“GROUP BY 语句”的基本示例。请注意，这需要 MongoDB 2.1 或更高版本： http: [//docs.mongodb.org/manual/core/aggregation/](http://docs.mongodb.org/manual/core/aggregation/)

首先建立连接和一些虚拟数据：

```
library(rmongodb)
mongo <- mongo.create()

db <- "stackoverflow"
coll <- "grpmong"
ns <- paste(db, coll, sep = ".")

mongo.insert(mongo, ns, mongo.bson.from.list(list(y=1, x=1)))
mongo.insert(mongo, ns, mongo.bson.from.list(list(y=1, x=2)))
mongo.insert(mongo, ns, mongo.bson.from.list(list(y=2, x=3)))
mongo.insert(mongo, ns, mongo.bson.from.list(list(y=2, x=4))) 
```

检查数据格式：

```
 >mongo.find.one(mongo, ns, mongo.bson.empty())
    _id : 7          51e002b881620de5fe2973ec
    y : 1    1.000000
    x : 1    1.000000 
```

以下将产生等价于：

```
SELECT y '_id', SUM(x) total
FROM grpmong
GROUP BY y 
```

创建“GROUP BY 语句”

```
x <- list('$group' = list('_id' = '$y',
                          'total' = list('$sum' = '$x')
                          ))
grpBSON <- mongo.bson.from.list(x) 
```

创建聚合管道并将“GROUP BY 语句”添加到其中：

```
buf <- mongo.bson.buffer.create();
mongo.bson.buffer.append(buf, "aggregate", coll); 
  mongo.bson.buffer.start.array(buf, "pipeline");
    mongo.bson.buffer.append(buf, "0", grpBSON);
  mongo.bson.buffer.finish.object(buf);
cmd <- mongo.bson.from.buffer(buf); 
```

运行命令：

```
res <- mongo.command(mongo, db, cmd) 
```

检查结果：

```
> print(res)
result : 4
  0 : 3
    _id : 1 2.000000
    total : 1 7.000000
  1 : 3
    _id : 1 1.000000
    total : 1 3.000000
  ok : 1 1.000000 
```

# c++ - LNK2019 在 QtCreator 中使用 WinMain 时

> ID：13594719
> 
> 赞同：1
> 
> 时间：2012-11-27T22:56:49.973
> 
> 标签：c++, qt, lnk2019, fltk

我正在 QtCreator 中制作一个 FLTK GUI。请不要因为我没有使用 Qt 来制作我的 GUI 而生我的气，这无关紧要。

无论如何，我的项目类型是“Plain C++ Project”，这是我的代码（你可能不需要阅读它，但我把它放在那里以防万一）：

```
// include headers
#include <Windows.h>
#include <Fl/Fl.H>
#include <FL/FL_Window.h>
#include <FL/Fl_Button.h>
#include <FL/FL_ask.h>
// macro functions
#define UP(x) UNREFERENCED_PARAMETER(x)
// callback function
void callback(Fl_Widget *sender)
{
    sender->label("Thanks!");
}
// main function
int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, 
    int nShowCmd)
{
    // UP's
    UP(hInstance);
    UP(hPrevInstance);
    UP(lpCmdLine);
    UP(nShowCmd);
    // window
    Fl_Window *window = new Fl_Window(250, 250, "Derp Window");
    window->begin();
    // button
    Fl_Button *button = new Fl_Button(10, 100, 230, 25, "Click Me!");
    button->callback(callback);
    // run
    window->end();
    window->show();
    int result = Fl::run();
    // delete ptr's
    delete button;
    delete window;
    // return
    return result;
} 
```

当我运行此程序时，我收到此警告和两个错误（抱歉，小图像，如果您看不懂，请放大浏览器）：

![在此处输入图像描述](../Images/a7e2869a679c1744cda85793cad35e97.png)

我知道 LNK2019 错误是什么，事实上它们可能是我存在的祸根。但在这种情况下，我不知道为什么会得到这个。我认为你也应该看看这个，这是我的 Qt 项目 .pro 文件的文本：

模板 = 应用程序配置 += 控制台配置 -= app_bundle 配置 -= qt

win32: LIBS += -luser32 -lshell32 -lgdi32 -lole32 -ladvapi32

来源 += main.cpp

unix|win32: LIBS += -L$$PWD/../../../Desktop/C++/FLTK/lib/ -lfltk

INCLUDEPATH += $$PWD/../../../Desktop/C++/FLTK/include DEPENDPATH += $$PWD/../../../Desktop/C++/FLTK/include

这可能是最重要的部分：我从来没有遇到任何错误，当我使用 int main() 作为我的主函数时，程序运行良好。

所以，我的问题是为什么我会得到这个，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T03:00:55.240

删除语句

配置 += 控制台

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:49:30.097

我通过制作“空 Qt 项目”而不是“C++ 控制台应用程序”来修复它！

# c++ - 如何将 ::std::vector 参数绑定到仿函数？

> ID：13594721
> 
> 赞同：4
> 
> 时间：2012-11-27T22:56:59.500
> 
> 标签：c++, templates, c++11

我正在尝试使该程序正确编译：

```
#include <vector>
#include <iostream>

int f(int a, int b)
{
   ::std::cout << "f(" << a << ", " << b << ") == " << (a + b) << '\n';
   return a + b;
}

template <typename R, typename V>
R bind_vec(R (*f)(), const V &vec, int idx=0)
{
   return f();
}

template <typename R, typename V, typename Arg1, typename... ArgT>
R bind_vec(R (*f)(Arg1, ArgT...), const V &vec, int idx=0)
{
   const Arg1 &arg = vec[idx];
   auto call = [arg, f](ArgT... args) -> R {
      return (*f)(arg, args...);
   };
   return bind_vec(call, vec, idx+1);
}

int foo()
{
   ::std::vector<int> x = {1, 2};
   return bind_vec(f, x);
} 
```

理想情况下，我想`bind_vec`将任意函子作为参数，而不仅仅是函数指针。`::std::vector`这个想法是在编译时从 a 中提取函数参数。

这不是它的最终用途，但它是我想去的地方的垫脚石。我真正在做的是生成包装函数，这些函数在编译时从未来/承诺类型系统中的承诺中解开它们的参数。这些包装函数本身就是 Promise。

在我的最终用例中，我可以指望函子是`::std::function`s。但是如果知道它应该如何适用于更通用的函子会很好，因为我认为这是一个广泛有趣的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T23:37:56.090

好的，首先，可以检测函子的数量，但它有点复杂，最好留给一个单独的问题。假设您将在调用中指定函子的数量。同样，有一些方法可以获得可调用对象的返回类型，但这也超出了这个问题的范围。让我们假设返回类型是`void`现在。

所以我们想说，

```
call(F f, C v); 
```

那应该说`f(v[0], v[1], ..., v[n-1])`，哪里`f`有arity `n`。

这是一种方法：

```
template <unsigned int N, typename Functor, typename Container>
void call(Functor const & f, Container const & c)
{
    call_helper<N == 0, Functor, Container, N>::engage(f, c);
} 
```

我们需要帮助者：

```
#include <functional>
#include <cassert>

template <bool Done, typename Functor, typename Container,
          unsigned int N, unsigned int ...I>
struct call_helper
{
    static void engage(Functor const & f, Container const & c)
    {
        call_helper<sizeof...(I) + 1 == N, Functor, Container,
                    N, I..., sizeof...(I)>::engage(f, c);
    }
};

template <typename Functor, typename Container,
          unsigned int N, unsigned int ...I>
struct call_helper<true, Functor, Container, N, I...>
{
    static void engage(Functor const & f, Container const & c)
    {
        assert(c.size() >= N);
        f(c[I]...);
    }
}; 
```

**例子：**

```
#include <vector>
#include <iostream>

void f(int a, int b) { std::cout << "You said: " << a << ", " << b << "\n"; }

struct Func
{
    void operator()(int a, int b) const
    { std::cout << "Functor: " << a << "::" << b << "\n"; }
};

int main()
{
    std::vector<int> v { 20, 30 };
    call<2>(f, v);
    call<2>(Func(), v);
} 
```

**注意：**在更高级的版本中，我会使用更多的模板机制来推断可调用对象的数量，并且还会推断出返回类型。但是，要使其工作，您将需要对自由函数和各种 CV 限定的类成员函数进行一些专门化，因此对于这个问题来说，这将变得太大。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T23:46:19.540

对于（成员）函数指针来说，这样的事情很容易实现，但对于可能重载的仿函数来说`operator()`，这会变得更加困难。如果我们假设您有办法知道函数需要多少个参数（并假设容器实际上有那么多元素），您可以使用[索引技巧](http://loungecpp.wikidot.com/tips-and-tricks%3aindices)将向量扩展为参数列表，例如使用`std::next`和`begin()`迭代器：

```
#include <utility>
#include <iterator>

template<class F, class Args, unsigned... Is>
auto invoke(F&& f, Args& cont, seq<Is...>)
  -> decltype(std::forward<F>(f)(*std::next(cont.begin(), Is)...))
{
  return std::forward<F>(f)(*std::next(cont.begin(), Is)...);
}

template<unsigned ArgC, class F, class Args>
auto invoke(F&& f, Args& cont)
  -> decltype(invoke(std::forward<F>(f), cont, gen_seq<ArgC>{}))
{
  return invoke(std::forward<F>(f), cont, gen_seq<ArgC>{});
} 
```

这种实现对于随机访问容器非常有效，但对于转发，尤其是输入容器来说就不是很好了。为了使它们以高性能的方式工作，您可能会尝试在每个扩展步骤中增加迭代器，但您会遇到一个问题：函数参数的评估顺序未指定，因此您很可能以错误的顺序传递参数。

幸运的是，有一种方法可以强制从左到右进行评估：列表初始化语法。现在我们只需要一个可以用来传递参数的上下文，一个可能的方法是构造一个对象，通过构造函数传递函数和参数，然后在其中调用函数。但是，您将失去检索返回值的能力，因为构造函数无法返回值。

我想到的是创建一个*迭代器*数组，它指向正确的元素，并在第二步中再次展开它们，在它们被取消引用的地方。

```
#include <utility>

template<class T> using Alias = T; // for temporary arrays

template<class F, class It, unsigned N, unsigned... Is>
auto invoke_2(F&& f, It (&&args)[N], seq<Is...>)
  -> decltype(std::forward<F>(f)(*args[Is]...))
{
  return std::forward<F>(f)(*args[Is]...);
}

template<class F, class Args, unsigned... Is>
auto invoke_1(F&& f, Args& cont, seq<Is...> s)
  -> decltype(invoke_2(std::forward<F>(f), std::declval<decltype(cont.begin())[sizeof...(Is)]>(), s))
{
  auto it = cont.begin();
  return invoke_2(std::forward<F>(f), Alias<decltype(it)[]>{(void(Is), ++it)...}, s);
}

template<unsigned ArgC, class F, class Args>
auto invoke(F&& f, Args& cont)
  -> decltype(invoke_1(std::forward<F>(f), cont, gen_seq<ArgC>{}))
{
  return invoke_1(std::forward<F>(f), cont, gen_seq<ArgC>{});
} 
```

该代码针对 GCC 4.7.2 进行了测试，并按照宣传的方式工作。

* * *

既然您说要传递的函子是`std::function`s，那么获取它们所采用的参数数量真的很容易：

```
template<class F> struct function_arity;

// if you have the 'Signature' of a 'std::function' handy
template<class R, class... Args>
struct function_arity<R(Args...)>
  : std::integral_constant<std::size_t, sizeof...(Args)>{};

// if you only have the 'std::function' available
template<class R, class... Args>
struct function_arity<std::function<R(Args...)>>
  : function_arity<R(Args...)>{}; 
```

请注意，您甚至不需要`function_arity`从`invoke`上面的工作中进行`std::function`：

```
template<class R, class... Ts, class Args>
R invoke(std::function<R(Ts...)> const& f, Args& cont){
  return invoke_1(f, cont, gen_seq<sizeof...(Ts)>{})
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T23:38:55.620

我设法做你想做的事。如果我一开始没有推断出正确的返回类型，最简单的解释是，稍后我将展示如何添加它：

```
#include <vector>
#include <type_traits>

namespace {
  int f(int a, int b) { return 0; }
}

template <typename ...Args>
constexpr unsigned nb_args(int (*)(Args...)) {
  return sizeof...(Args);
}

template <typename F, typename V, typename ...Args>
auto bind_vec(F f, const V&, Args&& ...args)
 -> typename std::enable_if<sizeof...(Args) == nb_args(F()),void>::type
{
  f(std::forward<Args>(args)...);
}

template <typename F, typename V, typename ...Args>
auto bind_vec(F f, const V& v, Args&& ...args)
 -> typename std::enable_if<sizeof...(Args) < nb_args(F()),void>::type
{
  bind_vec(f, v, std::forward<Args>(args)..., v.at(sizeof...(Args)));
}

int main() {
  bind_vec(&f, std::vector<int>(), 1);
  return 0;
} 
```

有两个版本`bind_vec`- 如果参数包的大小适合函数，则启用一个版本。如果它仍然太小，则启用另一个。第一个版本使用参数包简单地调度调用，而第二个版本获取下一个元素（由参数包的大小决定）并递归。

SFINAE 是在函数的返回类型上完成的，以便它不会干扰类型的推导，但这意味着它需要在函数之后完成，因为它需要知道`F`. 有一个辅助函数可以找到调用函数指针所需的参数数量。

为了推断返回类型，我们也可以使用`decltype`函数指针：

```
#include <vector>
#include <type_traits>

namespace {
  int f(int a, int b) { return 0; }
}

template <typename ...Args>
constexpr unsigned nb_args(int (*)(Args...)) {
  return sizeof...(Args);
}

template <typename F, typename V, typename ...Args>
auto bind_vec(F f, const V&, Args&& ...args)
 -> typename std::enable_if<sizeof...(Args) == nb_args(F()),decltype(f(std::forward<Args>(args)...))>::type
{
  return f(std::forward<Args>(args)...);
}

template <typename F, typename V, typename ...Args>
auto bind_vec(F f, const V& v, Args&& ...args)
 -> typename std::enable_if<sizeof...(Args) < nb_args(F()),decltype(bind_vec(f, v, std::forward<Args>(args)..., v.at(sizeof...(Args))))>::type
{
  return bind_vec(f, v, std::forward<Args>(args)..., v.at(sizeof...(Args)));
}

int main() {
  bind_vec(&f, std::vector<int>(), 1);
  return 0;
} 
```

# javascript - JavaScript onclick() 事件冒泡 - 工作与否？

> ID：13594726
> 
> 赞同：4
> 
> 时间：2012-11-27T22:57:19.593
> 
> 标签：javascript, dom-events, event-bubbling

我有一个表，其中表行标记用`onclick()`处理程序装饰。如果在任何地方单击该行，它将加载另一个页面。在该行的一个元素中，是一个锚标记，它也指向另一个页面。

**期望**的行为是，如果他们单击链接，则会加载“delete.html”。如果他们单击行中的任何其他位置，则会加载“edit.html”。

**问题**是有时（根据用户）链接和链接会同时被`onclick()`触发，导致后端代码出现问题。他们发誓他们没有双击。

我对 JavaScript 事件冒泡、处理以及任何事情都不太了解，甚至不知道从哪里开始解决这个奇怪的问题，所以我正在寻求帮助。这是呈现页面的片段，显示了带有嵌入链接和相关脚本标记的行。欢迎任何建议：

```
<tr id="tableRow_3339_0" class="odd">
   <td class="l"></td>
   <td>PENDING</td>
   <td>Yabba Dabba Doo</td>
   <td>Fred Flintstone</td>
   <td>
     <a href="/delete.html?requestId=3339">
       <div class="deleteButtonIcon"></div>
     </a>
  </td>
  <td class="r"></td>
</tr>
<script type="text/javascript">document.getElementById("tableRow_3339_0").onclick = function(event) { window.location = '//edit.html?requestId=3339'; };</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T23:06:06.500

事件冒泡是这样工作的。如果元素 A 包含在元素 B 中，并且单击了元素 A，则单击事件会为元素 A 触发，然后它将冒泡并为元素 B 触发。发生这种情况是因为从技术上讲，您正在单击两个元素。

所以基本上如果他们点击链接，点击事件就会冒泡到`tr`元素。根据链接点击加载下一页的速度，可能会发生 tr click 事件。

您可以在事件处理程序中停止冒泡：[如何使用内联 onclick 属性停止事件传播？](https://stackoverflow.com/questions/387736/how-to-stop-event-propagation-with-inline-onclick-attribute)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-24T18:35:19.110

处理 JavaScript 事件的主要方法有 3 种：

1.  事件处理程序
2.  事件监听器
3.  事件委托

事件处理程序是`onclick`直接放入 HTML 中的东西。事件侦听器使用名为 addEventListener 的方法将侦听器附加到元素并让浏览器侦听事件。根据您的问题，事件委托（涉及冒泡），并允许我们在父元素上监听其子元素上发生的事件。

您基本上是在尝试在这里混合 #1 和 #3。您可以使用这三个中的任何一个，但实际上使用 #2 可能会更轻松：

尝试这样的事情：

```
rows = document.getElementsByTagName("tr");
rows.('click', function(event) {
 window.location = '//edit.html?requestId=3339'; 
}; 
```

如果您需要更好地理解这 3 种方式，这篇关于[JavaScript 事件的文章将对此进行更多介绍。](http://appendto.com/2016/03/javascript-events-101/)（免责声明：我写的）。

# opengl - OpenGL 2D Evaluator Mesh 不能设置得更大

> ID：13594727
> 
> 赞同：3
> 
> 时间：2012-11-27T22:57:20.960
> 
> 标签：opengl, 2d, mesh, evaluator

我有一个我正在处理的 OpenGL 项目，它涉及创建一个 2D 平面网格来处理。代码是这样的：

```
#include <stdlib.h>
#include <glut.h>

GLfloat ctrlpoints[9][9][3] = {
    {{0, 0, 0}, {1, 0, 0}, {2, 0, 0}, {3, 0, 0}, {4, 0, 0}, {5, 0, 0}, {6, 0, 0}, {7, 0, 0}, {8, 0, 0}},
    {{0, 1, 0}, {1, 1, 0}, {2, 1, 0}, {3, 1, 0}, {4, 1, 0}, {5, 1, 0}, {6, 1, 0}, {7, 1, 0}, {8, 1, 0}},
    {{0, 2, 0}, {1, 2, 0}, {2, 2, 0}, {3, 2, 0}, {4, 2, 0}, {5, 2, 0}, {6, 2, 0}, {7, 2, 0}, {8, 2, 0}},
    {{0, 3, 0}, {1, 3, 0}, {2, 3, 0}, {3, 3, 0}, {4, 3, 0}, {5, 3, 0}, {6, 3, 0}, {7, 3, 0}, {8, 3, 0}},
    {{0, 4, 0}, {1, 4, 0}, {2, 4, 0}, {3, 4, 0}, {4, 4, 0}, {5, 4, 0}, {6, 4, 0}, {7, 4, 0}, {8, 4, 0}},
    {{0, 5, 0}, {1, 5, 0}, {2, 5, 0}, {3, 5, 0}, {4, 5, 0}, {5, 5, 0}, {6, 5, 0}, {7, 5, 0}, {8, 5, 0}},
    {{0, 6, 0}, {1, 6, 0}, {2, 6, 0}, {3, 6, 0}, {4, 6, 0}, {5, 6, 0}, {6, 6, 0}, {7, 6, 0}, {8, 6, 0}},
    {{0, 7, 0}, {1, 7, 0}, {2, 7, 0}, {3, 7, 0}, {4, 7, 0}, {5, 7, 0}, {6, 7, 0}, {7, 7, 0}, {8, 7, 0}},
    {{0, 8, 0}, {1, 8, 0}, {2, 8, 0}, {3, 8, 0}, {4, 8, 0}, {5, 8, 0}, {6, 8, 0}, {7, 8, 0}, {8, 8, 0}}
};

void init(void)
{
   glClearColor(0.0, 0.0, 0.0, 0.0);
   glShadeModel(GL_FLAT);
   glMap2f(GL_MAP2_VERTEX_3, 0, 1, 3, 9, 0, 1, 27, 9, &ctrlpoints[0][0][0]);
   glEnable(GL_MAP2_VERTEX_3);
   glEnable(GL_DEPTH_TEST);
}

void display(void)
{
    int i, j;
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glMatrixMode (GL_MODELVIEW);
    glLoadIdentity();

    glColor3f(1.0, 1.0, 1.0);
    glPushMatrix ();
    gluLookAt(10,10,10, 0,0,0, 0,0,1);

    /**** We have the option to use this method rather than dealilng with nasty loops *****/
    glMapGrid2f(  50, 0.0, 1.0,  50, 0.0, 1.0);
    glEnable(GL_AUTO_NORMAL);   //this line calculates all normal vectors for the mesh. It has to be commented in when lighting is enabled.

    //glEvalMesh2(GL_LINE, 0, 50, 0, 50);  //This defines a mesh that 5 by 6 vetrices defined by our evaluator defined above
    glEvalMesh2(GL_FILL, 0, 50, 0, 50); //This one fills the the mesh
    /******************************************************/
    glPopMatrix ();
    glutSwapBuffers();
    glutPostRedisplay();
}

void reshape(int w, int h)
{
   glViewport(0, 0, (GLsizei) w, (GLsizei) h);
   glMatrixMode(GL_PROJECTION);
   glLoadIdentity();
   glOrtho(-10, 10, -10, 10, 0.1, 30);
   glMatrixMode(GL_MODELVIEW);
   glLoadIdentity();
}

void initlights(void)
{
   GLfloat ambient[] = {0.0, 0.0, 1.0, 1.0};
   GLfloat position[] = {1.0, 1.0, 2.0, 1.0};
   GLfloat mat_diffuse[] = {1.0, 0.0, 0.0, 1.0};
   GLfloat mat_specular[] = {0.0, 1.0, 0.0, 1.0};
   GLfloat mat_shininess[] = {50.0};

   glEnable(GL_LIGHTING);
   glEnable(GL_LIGHT0);

   glLightfv(GL_LIGHT0, GL_AMBIENT, ambient);
   glLightfv(GL_LIGHT0, GL_POSITION, position);

   glMaterialfv(GL_FRONT, GL_DIFFUSE, mat_diffuse);
   glMaterialfv(GL_FRONT, GL_SPECULAR, mat_specular);
   glMaterialfv(GL_FRONT, GL_SHININESS, mat_shininess);
}

int main(int argc, char** argv)
{
   glutInit(&argc, argv);
   glutInitDisplayMode (GLUT_DOUBLE | GLUT_RGB);
   glutInitWindowSize (500, 500);
   glutInitWindowPosition (100, 100);
   glutCreateWindow (argv[0]);
   init ();
   initlights();
   glutDisplayFunc(display);
   glutReshapeFunc(reshape);
   glutMainLoop();
   return 0;
} 
```

**GLfloat ctrlpoints**是一个数组，它决定了网格的大小和每个点的坐标。必须更改**glMap2f以适应数组，我相信我使用正确。**现在是9x9。但是，当我尝试运行该程序时，什么都没有出现。然而真正奇怪的是，如果我让 ctrlpoints 更小，比如 8x8：

```
GLfloat ctrlpoints[8][8][3] = {
    {{0, 0, 0}, {1, 0, 0}, {2, 0, 0}, {3, 0, 0}, {4, 0, 0}, {5, 0, 0}, {6, 0, 0}, {7, 0, 0}},
    {{0, 1, 0}, {1, 1, 0}, {2, 1, 0}, {3, 1, 0}, {4, 1, 0}, {5, 1, 0}, {6, 1, 0}, {7, 1, 0}},
    {{0, 2, 0}, {1, 2, 0}, {2, 2, 0}, {3, 2, 0}, {4, 2, 0}, {5, 2, 0}, {6, 2, 0}, {7, 2, 0}},
    {{0, 3, 0}, {1, 3, 0}, {2, 3, 0}, {3, 3, 0}, {4, 3, 0}, {5, 3, 0}, {6, 3, 0}, {7, 3, 0}},
    {{0, 4, 0}, {1, 4, 0}, {2, 4, 0}, {3, 4, 0}, {4, 4, 0}, {5, 4, 0}, {6, 4, 0}, {7, 4, 0}},
    {{0, 5, 0}, {1, 5, 0}, {2, 5, 0}, {3, 5, 0}, {4, 5, 0}, {5, 5, 0}, {6, 5, 0}, {7, 5, 0}},
    {{0, 6, 0}, {1, 6, 0}, {2, 6, 0}, {3, 6, 0}, {4, 6, 0}, {5, 6, 0}, {6, 6, 0}, {7, 6, 0}},
    {{0, 7, 0}, {1, 7, 0}, {2, 7, 0}, {3, 7, 0}, {4, 7, 0}, {5, 7, 0}, {6, 7, 0}, {7, 7, 0}}
}; 
```

并像这样修改 glMap2f

```
glMap2f(GL_MAP2_VERTEX_3, 0, 1, 3, 8, 0, 1, 24, 8, &ctrlpoints[0][0][0]); 
```

网格突然出现在屏幕上！如果我也降低，它也会起作用，比如 7x7。

这里到底发生了什么？如果我尝试使网格大于 8x8，它不会出现怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:09:35.423

确保`GL_MAX_EVAL_ORDER`大于 8。评估器又老又笨，所以如果您的 OpenGL 实现仅提供所需的最小值 (8)，我不会感到惊讶。

您可以检索`GL_MAX_EVAL_ORDER`via的值[`glGet()`](http://www.opengl.org/sdk/docs/man2/xhtml/glGet.xml)。

您也可以在通话后检查`glGetError()`。`GL_INVALID_VALUE``glMap2f()`

# imageresizer - 使用 ImageResizer 跳过授权的正确方法

> ID：13594729
> 
> 赞同：1
> 
> 时间：2012-11-27T22:57:24.550
> 
> 标签：imageresizer

HttpConext 对象具有[SkipAutorization 属性](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.skipauthorization.aspx)，用于禁用[UrlAuthorizationModule](http://msdn.microsoft.com/en-us/library/system.web.security.urlauthorizationmodule.aspx)中的授权检查，这是标准 asp.net 管道的一部分。

ImageResizer在正常的 asp.net 管道之外直接调用[UrlAuthorizationModule.CheckUrlAccessForPrincipal 。](http://msdn.microsoft.com/en-us/library/system.web.security.urlauthorizationmodule.checkurlaccessforprincipal.aspx)因此，不支持 SkipAutorization 属性。

解决方法是：

```
protected void Application_Start(object sender, EventArgs e)
{
  // Ask ImageResizer not to re-check authorization if it's skipped 
  // by means of the context flag
  Config.Current.Pipeline.OnFirstRequest += 
      (m, c) =>
      {
          Config.Current.Pipeline.AuthorizeImage +=
              (module, context, args) =>
                  {
                      if (context.SkipAuthorization)
                      {
                          args.AllowAccess = true;
                      }
                  };
      };
} 
```

此处的外部 OnFirstRequest 是为了确保在加载所有插件之后发生 AuthorizeImage 订阅，因此它是链中的最后一个执行。

我不喜欢这种解决方法，因为它完全依赖于实现。例如，如果 ImageResizer 插件加载从 onFirstRequest 移动到其他地方，它将中断。

如果这在 ImageResizer 本身中得到修复，那就太好了。我建议将 InterceptModule 中的附加 Autorization 检查更改为以下内容：

```
//Run the rewritten path past the auth system again, using the result as the default "AllowAccess" value
bool isAllowed = true;
if (canCheckUrl) try {
        isAllowed =  conf.HonourSkipAutorization && app.Context.SkipAuthorization 
                     || UrlAuthorizationModule.CheckUrlAccessForPrincipal(virtualPath, user, "GET");
    } catch (NotImplementedException) { } //For MONO support 
```

**这合适吗，还是有更好的解决方案？**

在问题的最后一部分，我将描述我的用例，阅读完全是可选的，但它给出了这个查询是如何产生的透视图。

在一个asp.net 应用程序中，我有一个提供pdf 文档的HttpHandler。它接受 url 和标题中的文档 ID 和安全信息（我正在使用 OAuth）并执行所有安全检查，如果它们成功，则从数据库中检索 pdf 文档路径，并通过响应将文件提供给客户端。写文件。

我需要以图像形式提供 pdf 页面的预览，为此我使用 ImageResize 和 PdfRenderer 插件。

不幸的是，在我的文件处理程序工作之前不知道 pdf 的路径，并且对于 ImageResizer 对请求采取行动来说为时已晚，因为所有魔法都发生在 PostAuthorizeRequest 中，这（显然）在处理程序运行之前。

为了解决这个问题，我将我的 HttpHandler 重写为 HttpModule，它在 BeginRequest 上执行。如果授权检查失败，则请求在此处被切断。如果它们没问题，那么我使用 PathRewrite 指向生成的 pdf，同时将正确的 Content-Type 和其他标头写入响应。同时我设置了 context.SkipAutorization 标志，因为根据 web.config 配置无法通过直接 url 访问 pdf 文件，如果不跳过授权，管道甚至不会到达 PostAuthorizeRequest。在这种情况下跳过授权是安全的，因为模块已经执行了所有必需的检查。

所以这允许执行流程到达 ImageResizer。但随后 Image resizer 决定它要重新检查 pdf url 上的授权。除非您应用上述解决方法，否则它会失败。

**重新检查的理由是什么？**在上面的场景中，当 ImageResizer 有工作要做时，它要提供的图像不是出现在 URL 中的图像，并且 asp.net 管道已经完成了身份验证检查，现在我们在 PostAuthorizeRequest 中。这种重新检查在哪些情况下有用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:16:55.890

更新：ImageResizer 的最新版本尊重 HttpContext.SkipAuthorization 布尔值，使得不再需要事件处理程序。

* * *

**您的解决方法正是处理此问题的正确方法，并且是 forwards-comaptible**。

存在重新检查是因为

1.  Url 重写非常普遍，鼓励，甚至由某些 ImageResizer 插件（例如 FolderResizeSyntax 和 ImageHandlerSyntax）实现。
2.  Authorize 阶段之后的 Url 重写允许完全规避 UrlAuthorization。

*ImageResizer应该*尊重HttpContext.SkipAuthorization ；并且可能会在未来的版本中。

也就是说，您涉及的解决方法`AuthorizeImage`实际上正是我所建议的。我看不出它怎么会比`SkipAuthorization`它本身更脆弱。事实上，无论 ImageResizer 将来如何重新排序事件，它都应该工作。

ImageResizer 尊重管道中事件的顺序 - 在 PostAuthorize 之前发生授权的 V2 是完全正确的（尽管它可以移动到 PreAuthorize，如果您希望在 BeginRequest 期间支持额外的前端调整大小）。

此外，正如您可能发现的那样，使用 RewritePath 提供原始 PDF 比调用 WriteFile 效率更高，尤其是在 IIS6+ 上。

# angularjs - 最大化 $digest 迭代

> ID：13594732
> 
> 赞同：10
> 
> 时间：2012-11-27T22:57:29.657
> 
> 标签：angularjs

我在这个[小提琴](http://jsfiddle.net/_nth/u4BTu/2/)`=`中玩弄指令和绑定。我收到以下错误：

```
Uncaught Error: 10 $digest() iterations reached. Aborting!
Watchers fired in the last 5 iterations: [["fn: function () {\n                  var parentValue = parentGet(parentScope);\n\n                  if (parentValue !== scope[scopeName]) {\n                    // we are out of sync and need to copy\n                    if (parentValue !== lastValue) {\n                      // parent changed and it has precedence\n                      lastValue = scope[scopeName] = parentValue;\n                    } else {\n                      // if the parent can be assigned then do so\n                      parentSet(parentScope, lastValue = scope[scopeName]);\n                    }\n                  }\n                  return parentValue;\n                }; newVal: {\"baz\":3}; oldVal: {\"baz\":3}"],["fn: function () {\n                  var parentValue = parentGet(parentScope);\n\n                  if (parentValue !== scope[scopeName]) {\n                    // we are out of sync and need to copy\n                    if (parentValue !== lastValue) {\n                      // parent changed and it has precedence\n                      lastValue = scope[scopeName] = parentValue;\n                    } else {\n                      // if the parent can be assigned then do so\n                      parentSet(parentScope, lastValue = scope[scopeName]);\n                    }\n                  }\n                  return parentValue;\n                }; newVal: {\"baz\":3}; oldVal: {\"baz\":3}"],["fn: function () {\n                  var parentValue = parentGet(parentScope);\n\n                  if (parentValue !== scope[scopeName]) {\n                    // we are out of sync and need to copy\n                    if (parentValue !== lastValue) {\n                      // parent changed and it has precedence\n                      lastValue = scope[scopeName] = parentValue;\n                    } else {\n                      // if the parent can be assigned then do so\n                      parentSet(parentScope, lastValue = scope[scopeName]);\n                    }\n                  }\n                  return parentValue;\n                }; newVal: {\"baz\":3}; oldVal: {\"baz\":3}"],["fn: function () {\n                  var parentValue = parentGet(parentScope);\n\n                  if (parentValue !== scope[scopeName]) {\n                    // we are out of sync and need to copy\n                    if (parentValue !== lastValue) {\n                      // parent changed and it has precedence\n                      lastValue = scope[scopeName] = parentValue;\n                    } else {\n                      // if the parent can be assigned then do so\n                      parentSet(parentScope, lastValue = scope[scopeName]);\n                    }\n                  }\n                  return parentValue;\n                }; newVal: {\"baz\":3}; oldVal: {\"baz\":3}"],["fn: function () {\n                  var parentValue = parentGet(parentScope);\n\n                  if (parentValue !== scope[scopeName]) {\n                    // we are out of sync and need to copy\n                    if (parentValue !== lastValue) {\n                      // parent changed and it has precedence\n                      lastValue = scope[scopeName] = parentValue;\n                    } else {\n                      // if the parent can be assigned then do so\n                      parentSet(parentScope, lastValue = scope[scopeName]);\n                    }\n                  }\n                  return parentValue;\n                }; newVal: {\"baz\":3}; oldVal: {\"baz\":3}"]] angular.js:7729
Scope.$digest angular.js:7729
Scope.$apply angular.js:7894
(anonymous function) angular.js:930
invoke angular.js:2788
bootstrap angular.js:928
angularInit angular.js:904
(anonymous function) angular.js:14397
trigger angular.js:1695
(anonymous function) angular.js:1930
forEach angular.js:110
eventHandler angular.js:1929 
```

为什么会这样？我认为这与`=`绑定有关。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-28T00:12:00.577

这是因为它在每次经过摘要循环时都会创建一个全新的对象。手表在此`=`数据绑定中注册，因此每次评估时`bar="{baz: 3}"`都会创建一个新对象，因此它将与先前的值不同，从而触发另一个摘要循环。最终它中止，因此它不会无限循环。有关更详尽的解释，请参阅[http://docs.angularjs.org/guide/concepts#runtime 。](http://docs.angularjs.org/guide/concepts#runtime)

诀窍是`=`使用不会每次都更改的参考来进行数据记录。这通常是通过将其置于指令之外的范围内来完成的。见[http://jsfiddle.net/u4BTu/7/](http://jsfiddle.net/u4BTu/7/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-26T12:56:06.710

有一种方法可以在 HTML 模板上实现对象字面量表达：

```
<div my-directive="{ param: 34, param2: 'cool' }" another-param="parentScopeObject"></div>

var directiveFunction = function(){
    return {
        scope: {
            myDirective: '&',
            anotherParam: '&'
        },
        link: function(scope, element, attributes){

            //this will return the actual object from the object expression!
            console.log(scope.myDirective());
            //this will return the actual object from the parent scope, if it exists of course!
            //and no "parentScopeObject" is not a function, it's an object
            console.log(scope.anotherParam());

        }
    };
} 
```

这是从我的 Angular 绑定示例列表中提取的。见第 6 条：[https ://gist.github.com/CMCDragonkai/6282750](https://gist.github.com/CMCDragonkai/6282750)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-24T07:44:03.097

将此代码添加到您的应用程序定义或 app.js 这将增加应用程序的 digestTtl。

```
yourApp.config(function ($rootScopeProvider) {
       $rootScopeProvider.digestTtl(15); 
       // 15 is int value, just set to more than 10\. If not works justincrement it bye one every-time and refresh page to test
  }) 
```

# ruby-on-rails - 太阳黑子/SOLR 查询使用 OR

> ID：13594734
> 
> 赞同：1
> 
> 时间：2012-11-27T22:57:33.400
> 
> 标签：ruby-on-rails, ruby, solr, sunspot

我想为模型设置 Sunspot，如下所示：

```
Sunspot.search(Show) do
  with(:id).equal_to MY_QUERY.to_i
  OR
  with(:legacy_id).equal_to MY_QUERY.to_i
end 
```

有没有办法进行太阳黑子搜索，它返回一个符合任一条件的节目？

谢谢，

乔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T06:25:34.980

您可以使用 any_of

```
Sunspot.search(Show) do
  any_of do
    with(:id).equal_to MY_QUERY.to_i
    with(:legacy_id).equal_to MY_QUERY.to_i
  end
end 
```

希望这可以帮助。谢谢。

# php - Magento 1.4 url 在多商店环境中重写

> ID：13594738
> 
> 赞同：0
> 
> 时间：2012-11-27T22:58:00.823
> 
> 标签：php, .htaccess, magento, magento-1.4

长话短说 - 我正在尝试恢复我的 ver1.4 商店（多商店），但我首先要在测试环境中恢复。（生产有一个工作站点，我不想完全失去它。）

在我的测试环境中，当我尝试重新索引目录 URL 重写时，我继续收到以下错误消息：

```
 An error occurred while saving the URL rewrite. 
```

在此之前，我已经清空了数据库中的 core_url_rewrites 表，清除了 var/cache、var/locks 和 var/session 文件夹，并清除了我的浏览器缓存。

我已经反复这样做了，看看我是否能弄清楚发生了什么。我曾读到，当产品位于多个根类别中时，多商店设置中的 url 重写经常会出现问题。我有很多这样的东西，所以我浏览了我的 cata.logs 和产品，并将每个产品限制为一个根类别（商店/域。）

我的配置设置如下：

```
System -> Configuration -> Web
  URL Options
Add Store Code to Urls  No [GLOBAL] 
Redirect to Base URL if requested URL doesn't match it  No [GLOBAL] 
  Search Engines Optimization
Use Web Server Rewrites  Yes [STORE VIEW] (all store views set to use Website)

System -> Configuration -> Catalog
  Frontend
Use Flat Catalog Category No [GLOBAL]   
Use Flat Catalog Product No [GLOBAL]    
Allow Dynamic Media URLs in Products and Categories  Yes [STORE VIEW]
  Search Engine Optimizations
Autogenerated Site Map  Enable [STORE VIEW] 
Popular Search Terms Enable [STORE VIEW]    
Product URL Suffix .html [STORE VIEW]   
Category URL Suffix .html [STORE VIEW]  
Use Categories Path for Product URLs Yes [STORE VIEW]   
Create Permanent Redirect for old URLs if Url key changed yes [STORE VIEW]  
Page Title Separator - [STORE VIEW] 
Use Canonical Link Meta Tag For Categories No [STORE VIEW]  
Use Canonical Link Meta Tag For Products No [STORE VIEW] 
```

我确认我的每个目录中都有正确的 .htaccess 文件（根目录和每个带有符号链接的文件夹，表示各种商店/域。）我还仔细检查了我的 index.php 文件。

每次我运行重新索引时，它都会再索引一个项目。我有超过 2500 件物品，所以我倾向于不想通过它 2500 次。我觉得我一定错过了什么，但我无法弄清楚它是什么。

当我添加新产品时，它通常会给我一条错误消息，指出它失败了，因为它无法创建 url 重写，但添加了该项目。然后下次我重新索引时，新项目会为所有四个商店建立索引。

这似乎不是我以前的设置的问题，所以它可能只是我的测试环境设置的愚蠢方式。

如果有人对我如何识别和/或解决问题有任何想法，我将不胜感激！

干杯! 一分钱

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:42:47.310

需要有关错误消息的更多信息。查看 var/log 文件夹或 var/report 文件夹以获取有关确切错误的更多信息，并希望那里有一些可以阐明的信息。可能是由于多种原因，所以需要详细的信息。

# vba - 为多值字段创建单独的行条目

> ID：13594739
> 
> 赞同：4
> 
> 时间：2012-11-27T22:54:39.760
> 
> 标签：vba, excel

我有一个包含项目列表的表格。本质上，它是问题跟踪工具的导出。该表的其中一列包含逗号分隔值。我正在寻找一种方法来为多值条目的各个值创建单独的条目。

示例：（*这是一个简化的示例，真实案例包含大约十几个列）*

**源数据：**

```
ID | Title          |  Areas Affected  |  
1  | Issue title A  |  Area X, Area Y  |  
2  | Issue title B  |  Area Y, Area Z  |  
3  | Issue title C  |  Area X, Area Z  | 
```

**我想要达到的目的：**

```
ID | Title          |  Areas Affected  |   
1  | Issue title A  |  Area X          |  
1  | Issue title A  |  Area Y          |  
2  | Issue title B  |  Area Y          |  
2  | Issue title B  |  Area Z          |  
3  | Issue title C  |  Area X          |  
3  | Issue title C  |  Area Z          | 
```

现在可以有重复的 ID 和 Titles 条目吗？

是否有公式、宏或 VBA 脚本来实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T15:25:58.887

您需要使用逗号作为分隔符来拆分该列上的行。在 VBA 中，您有可以用来返回数组的 Split() 函数。对于第一个元素，只需将其放回列表所在的单元格中。对于其他人，为数组中的每个元素插入一个新行（这意味着您可以在该逗号分隔列表中包含 n 个元素），复制该新行上的整行并将第 i 个值放在那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T21:12:20.370

在阅读/浏览示例代码之后，如果有人需要，这就是答案。这是实际的工作代码，不适合我在问题中发布的示例 1:1。

```
Sub DataLobs()
    Application.ScreenUpdating = False 'Nice to have to increase the script speed. 

    Dim wsSrc As Worksheet
    Dim wsDst As Worksheet
    Dim curRowSrc As Integer
    Dim curRowDst As Integer
    Dim ttlRows As Integer
    Dim splitLob() As String

    ' Setting initial values to start rows in source and destination
    ' tables, as well as the total number of rows
    curRowSrc = 5
    curRowDst = 5
    ttlRows = 10000

    Set wsSrc = Worksheets("Source") 'whatever you worksheet is
    Set wsDst = Worksheets("Destination") 'or whatever your worksheet is called

    wsDst.Range("A5:F" & ttlRows).Clear

    ' Goes through column D in the source table
    ' and copies rows where the D cell is not blank
    ' into the destination table
    For curRowSrc = 5 To ttlRows
        If wsSrc.Range("D" & curRowSrc).Value <> "" Then ' There are some blank cells in the source table, so we are eliminating them.

            ' Split the cell value against the comma
            splitLob = Split(wsSrc.Range("D" & curRowSrc).Value, ", ") 'THIS IS WHERE @AlexandreP.Levasseur's HINT COMES INTO PLAY!

            For i = LBound(splitLob) To UBound(splitLob)
                wsDst.Range("A" & curRowDst).Value = splitLob(i)
                wsDst.Range("B" & curRowDst).Value = wsSrc.Range("A" & curRowSrc)
                wsDst.Range("C" & curRowDst).Value = wsSrc.Range("C" & curRowSrc)
                wsDst.Range("D" & curRowDst).Value = wsSrc.Range("AC" & curRowSrc)
                wsDst.Range("E" & curRowDst).Value = wsSrc.Range("AE" & curRowSrc)
                wsDst.Range("F" & curRowDst).Value = wsSrc.Range("AD" & curRowSrc)
                curRowDst = curRowDst + 1
            Next
        End If
    Next curRowSrc
End Sub 
```

# sql-server - 使用 XQUERY 更新 SQL 服务器 xml 列？

> ID：13594741
> 
> 赞同：5
> 
> 时间：2012-11-27T22:58:29.287
> 
> 标签：sql-server, xml, sql-server-2008, xquery

我在 XML 列中有一个简单的 xml

```
<Bands>
    <Band>
        <Name>beatles</Name>
        <Num>4</Num>
        <Score>5</Score>
    </Band>
    <Band>
        <Name>doors</Name>
        <Num>4</Num>
        <Score>3</Score>
    </Band>
</Bands> 
```

我设法用以下内容更新了该列：

```
 -----just update the name to the id)----
   UPDATE tbl1
   SET [myXml].modify('replace value of (/Bands/Band/Name/text())[1]
   with sql:column("id")') 
```

一切都好。

**问题 #1**

如何使用此查询将值更新为`id+"lalala"`：

```
 UPDATE tbl1
   SET [myXml].modify('replace value of (/Bands/Band/Name/text())[1]
   with sql:column("id") + "lalala"') 
```

*错误 = XQuery [tbl1.myXml.modify()]: '+' 的参数必须是单个数字原始类型*

**问题 #1**

假设我不想更新第一条记录 ( `[1]`) ，但我只想`udpate`（与上面相同的更新） where `score>4`。

我当然可以在 xpath 中写：

`replace value of (/Bands/Band[Score>4]/Name/text())[1]`

但我不想在 Xpath 中这样做。没有使用`Where`子句的正常方法吗？

就像是 ：

```
 UPDATE tbl1
   SET [myXml].modify('replace value of (/Bands/Band/Name/text())[1]
   with sql:column("id")  where [...score>4...]') 
```

[***这是网上的sql***](https://data.stackexchange.com/stackoverflow/query/edit/87215)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T07:06:07.147

如果要连接字符串，则应使用[concat](http://msdn.microsoft.com/en-us/library/ms190972.aspx)，如果`id`在您的情况下是整数，则需要将其转换为`concat`函数中的字符串。

在 where 子句中您可以过滤要更新的表行，您不能在 XML 中指定要更新的节点。这必须在 xquery 表达式中完成。但是，您可以在 where 子句中使用[exists](http://msdn.microsoft.com/en-us/library/ms189869.aspx)来过滤掉真正需要更新的行。

```
update tbl1
set myXml.modify('replace value of (/Bands/Band[Score > 4]/Name/text())[1] 
                    with concat(string(sql:column("id")), "lalalala")')
where myXml.exist('/Bands/Band[Score > 4]') = 1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-28T00:59:20.153

**Q1：**

```
;with t as (select convert(varchar(10),id) + 'lalala' id2, * from #tbl1)
   UPDATE t
   SET [myXml].modify('replace value of (/Bands/Band/Name/text())[1]
    with sql:column("id2")'); 
```

*注意：您是否意识到这只会更新第一个乐队的名称，而不是所有乐队的名称？*

**第二季度：**

你不能。特别是因为`(/Bands/Band[Score<4]/Name/text())[1]`（我改为`<`）专门针对问题中示例 xml 中的门带。另一方面，WHERE 子句将跨 XML 工作，而不是路径中的特定级别。例如一个非常错误的解释：

```
;with t as (
    select a.*, n.m.value('.','int') Score
    from #tbl1 a
    cross apply myXml.nodes('/Bands/Band/Score') n(m) -- assume singular
)
   UPDATE t
   SET [myXml].modify('replace value of (/Bands/Band/Name/text())[1]
    with sql:column("id")')
   where Score < 4 
```

因为 xml 中至少有一个 Band 的分数 < 4，所以 XML 得到更新。 ***但是***，因为`xml.modify`仅在第一场比赛中有效，所以第一个乐队的名称会更新，而不是与得分过滤器匹配的乐队名称。

# scala - Scala泛型问题

> ID：13594744
> 
> 赞同：2
> 
> 时间：2012-11-27T22:58:33.950
> 
> 标签：scala

我有一个这样的伴生对象：

```
object Addresses extends Table[Address]("address"){
  //some mapping columns
  .... 

  //a method I want to made generic 
  def findAll(limit: Option[Int], offset: Option[Int]): Seq[Address] = DBTest.db.withSession { implicit db: Session =>
    (limit, offset) match {
      case (Some(l), Some(o)) => Addresses.map { a => a }.drop(o).take(l).list
      case (None, None) => Addresses.map { a => a }.drop(ConfigurationsLoader.DefaultOffset).take(ConfigurationsLoader.DefaultLimit).list
      case (Some(l), None) => Addresses.map { a => a }.take(l).list
      case (None, Some(o)) => Addresses.map { a => a }.drop(o).list
    }
  } 
```

案例类`Address`。

因为我有很多这样的对象（每个都定义一个表），所以我想`findAll`在一个 trait 中移动方法，使其具有通用性，我试图这样做：

```
trait DbGenericOperations[T, U <: Table[T]]{
  val entities: U
  /**
   * Based on REST conventions, for listing it's good to use limit and offset, like: /entities?limit=25&offset=50.
   */
  def findAll(limit: Option[Int], offset: Option[Int]): Seq[T] = DBTest.db.withSession { implicit db: Session =>
    (limit, offset) match {
      case (Some(l), Some(o)) => entities.map { a => a }.drop(o).take(l).list
      case (None, None) => entities.map { a => a }.drop(ConfigurationsLoader.DefaultOffset).take(ConfigurationsLoader.DefaultLimit).list
      case (Some(l), None) => entities.map { a => a }.take(l).list
      case (None, Some(o)) => entities.map { a => a }.drop(o).list
    }
  }
} 
```

如您所见，`entities`它基本上是我的伴侣对象。

现在的问题是我不能像这样重写我的对象定义：

`object Addresses extends Table[Address]("address") with DbGenericOperations[Address, Addresses]{`

因为它说那`Addresses`不是一种类型......

我对 scala 很陌生，我想知道：有没有办法解决这个问题？

**更新**：我已经这样做了：

```
trait DbGenericOperations[T]{
      /**
       * Based on REST conventions, for listing it's good to use limit and offset, like: /entities?limit=25&offset=50.
       */
      def findAll(limit: Option[Int], offset: Option[Int], entities: Table[T]): Seq[T] = DBTest.db.withSession { implicit db: Session =>
        (limit, offset) match {
          case (Some(l), Some(o)) => entities.map { a => a }.drop(o).take(l).list
          case (None, None) => entities.map { a => a }.drop(ConfigurationsLoader.DefaultOffset).take(ConfigurationsLoader.DefaultLimit).list
          case (Some(l), None) => entities.map { a => a }.take(l).list
          case (None, Some(o)) => entities.map { a => a }.drop(o).list
        }
      }
    } 
```

并像这样声明伴随对象： `object Addresses extends Table[Address]("address") with DbGenericOperations[Address]`

但我不喜欢使用这种方法：

`val results = Addresses.findAll(limit, offset, Addresses)`

请让我知道是否有更好的解决方案...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:30:48.620

为什么不创建一个类/特征 RichTable[T](...) extends Table[T](...) 来添加这个方法？

# typescript - 如何调试 TypeScript 编译器？

> ID：13594745
> 
> 赞同：6
> 
> 时间：2012-11-27T22:58:36.853
> 
> 标签：typescript

有没有一种简单的方法可以单步调试 TypeScript 编译器（tsc.js）并观察它是如何工作的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T22:58:36.853

一种方法是使用带有 //x 键的 Windows Script Host。您需要安装 Visual Studio，并且不能使用源映射来调试原始源。

另一种方法是在 Node.js 中使用 Nodeclipse 或类似工具对其进行调试。

最简单的方法是使用嵌入在任何现代浏览器中的开发人员工具对其进行调试。有一个网页模拟平台 IO 并允许在其上运行 TSC：http: [//mihailik.github.com/tsc.browser/](http://mihailik.github.com/tsc.browser/)

# c - 将日历写入文本文件而不覆盖以前的数据 C

> ID：13594749
> 
> 赞同：1
> 
> 时间：2012-11-27T22:58:50.843
> 
> 标签：c, text-files, binaryfiles, logfiles

我被要求使用结构和文件来实现日历。我成功地使用结构实现了它。但是，我必须在我的程序之上构建才能处理文件。似乎具有挑战性的主要思想是如何在不覆盖以前数据的情况下写入文本和二进制文件。以下是我给出的一些规格：

1.  将日历保存到文本文件
2.  将日历保存到二进制文件
3.  从文本中读取日历
4.  将日历保存到二进制文件

您的程序的另一个补充是记录到您上次阅读日历后对日历所做的更改的文本文件。在这里，您应该使用一种文件格式，允许您重新加载原始日历并重新加载记录的更改以重新捕获如果您的程序崩溃，则日历的状态因此您损失的很少。您应该通过两种方式实现这一点：

1.  作为显式菜单选项，将所有更改记录到名为“eventlog_time.txt”的文件中，其中时间从“time.h”库中获取。
2.  作为自动记录操作。该程序保留一个名为“eventlog_private.txt”的文件，每次用户添加或删除事件时它都会自动更新该文件。您需要将此文件初始化为空，然后打开它，附加到它，并在记录每个事件后关闭它。

这是我编写的代码：

任何人都可以向我解释规范的最后一部分，因为我不确定我应该做什么，或者至少给我一个提示以便开始这个问题。这是我的代码：

```
 /************************************************************************************************
    Input file: None
    Output file: None
    Description: This calendar program is mainly a menu interactive program that prompts
                 the user for a date and its events, then the entry is stored in its appropriate
                 place inside an array of structures.
                 This program handles 5 main operations:
                    . Add an event to the calendar.
                    . Display events for a specific calendar date.
                    . Display the whole calendar.
                    . Delete the event from the calendar.

    ************************************************************************************************/

    #include <stdio.h>
    #include <string.h>
    #define MAXEVS 100   // Defining the maximum number of events as being 100
    typedef enum {FALSE = 0, TRUE = 1} BOOLEAN;
    typedef struct {
        int hours,
            minutes,
            seconds;
    } time_t;

    typedef struct {
        char month [20];
        int day,
            year; 
    } date_t;

    typedef struct {
        char ev_name [40];
        date_t dt;
        time_t tm;
    } event_t;

    typedef struct {
        BOOLEAN valid;
        event_t event_list [MAXEVS];
        int num_events;
    } calentry_t; 

        int counter = 0; //Global counter variable used to keep track of number of events
        void menu (); // This function displays the menu to the user 
        void InitializeCalender(calentry_t calendar[][31]  ); // Initializes the calendar for valid and invalid dates
        int ReadEvent ( calentry_t calendar[][31],char eventname[], char month[], int *day, int *year, int *h, int *min); // This function min role is to get the input from the user (the whole calendar entry)
        int MonthStr2Num ( char* month); // This function converts a string containing a month to its appropriate number
        void AddEvent (calentry_t calendar[][31], char eventname[], int* monthnum, int *day, int *year, int *h, int *min); // This function places the calendar entry places the event inside its appropriate place inside the 2D array
        char* MonthNum2Str (int* m); // Converts a number to its appropriate month
        void DisplayCalendar (calentry_t calendar[][31], int* monthnum, int* day, int* year); // Displays the calendar entry for a specific date
        void DisplayWholeCalendar ( calentry_t calendar[][31]); // This function displays the whole entries stored inside the calendar
        int DeleteEvent (calentry_t calendar [][31]); // This function deletes an event from the calendar
    main (){
        int choice;
        calentry_t calendar[12][31]; // Declaring a 2D array of structure calentry_t

        char eventname [100];
        char month[20];
        int day, year, h, min, monthnum;
        char temp;

        InitializeCalender(calendar);
        do{ // loop that continues to execute the program until the user decides to quit
        menu ();

        scanf ("%d",&choice);
        switch (choice)
        {
            case 1:
            printf("Calendar will now quit.\n");
            break;
            case 2:
            monthnum = ReadEvent(calendar ,eventname, month, &day, &year, &h, &min);
            AddEvent (calendar, eventname, &monthnum, &day, &year, &h, &min);
            break;
            case 3:
            printf ("What is the date that you want to display its events? input like ( 12 January 2012 ) ");
            scanf ("%d %s %d", &day, month, &year);
            monthnum = MonthStr2Num (month); 
            DisplayCalendar (calendar ,&monthnum, &day, &year);
            break;
            case 4:
            printf ("The whole calendar will be displayed immediately\n");
            DisplayWholeCalendar (calendar);
            break;
            case 5: 
            DeleteEvent (calendar);
            break;
        }
        }
        while (choice !=1);
    } //End of the main function

    void menu ()
    {
        printf("___________________________________________________________________________\n");
        printf("\tHere is the menu:\n");
        printf("\t1\. Quit the Program.\n");
        printf("\t2\. Add an event to the calendar.\n");
        printf("\t3\. Display events for a specific calendar date.\n");
        printf("\t4\. Display the whole calendar.\n");
        printf("\t5\. Delete the event from the calendar.\n"); 
        printf("____________________________________________________________________________\n");
        printf("\tYour choice Please: ");
    }

    void InitializeCalender(calentry_t calendar[][31]){
    int x, y;
        for(x = 0; x < 12; x ++) {
            if (x==1){
                for(y = 0; y < 28; y ++){ 
                    (calendar[x][y]).valid = TRUE;
                    (calendar[x][y]).num_events = FALSE;
                }
                for (y=28; y< 31; y++){
                    (calendar[x][y]).valid = FALSE;
                }
            }
            else if  (x==3 || x==5 || x==8 || x==10){
                for(y = 0; y < 30; y ++){ 
                    (calendar[x][y]).valid = TRUE;
                    (calendar[x][y]).num_events = FALSE;

                }
                for (y=30; y< 31; y++){
                    (calendar[x][y]).valid = FALSE;
                }
            }
            else if (x==0 || x==2||x==4||x==6||x==7||x==9||x==11){
                for(y = 0; y < 31; y ++){ 
                    (calendar[x][y]).valid = TRUE;
                    (calendar[x][y]).num_events = FALSE;
                }
            }
        }
    }

    int ReadEvent (calentry_t calendar[][31] ,char eventname[], char month[], int *day, int *year, int *h, int *min){

        char temp, answer;
        int monthnum;

            printf ("\n\tOkay, for event number %d:\n",counter+1 );
            printf ("\n\tWhat is the name of the event? ");
            scanf ("%c",&temp);
            gets (eventname);

            printf("\n\twhat is the date of the event? input like ( 12 January 2012 ) ");   
            scanf ("%d %s %d", day, month, year);
            monthnum = MonthStr2Num (month);
                if ( calendar [(monthnum-1)][(*day-1)]. valid ==FALSE || *day>=32 ){
                    while ( calendar [(monthnum-1)][(*day-1)]. valid ==FALSE || *day>=32 ) { //Loop that checks invalid dates
                    printf ("\tSorry that'san invalid date!!!!!\n");
                    printf("\n\twhat is the date of the event? input like ( 12 January 2012 ) ");   
                    scanf ("%d %s %d", day, month, year);
                    monthnum = MonthStr2Num (month);
                    } 
                }

            printf ("\n\tWhat is the time of the event? input like (12:30) ");
            scanf ("%d:%d", h,min);
                if ( *h>=24 || *h<0 || *min>=60 || *min<0){ //Loop that checks invalid times
                    while ( *h>=24 || *h<0 || *min>=60 || *min<0){
                        printf ("\tInvalid Time !!!!! \n");
                        printf ("\n\tWhat is the time of the event? input like (12:30) ");
                        scanf ("%d:%d", h,min);
                    }
                }
            monthnum = MonthStr2Num (month);
            return monthnum;

    }
    int MonthStr2Num ( char* month){
            int i,
                m=0;
        // Converting all the month characters to uppercase in order to handle all the cases of how the user 
        // enters the month
        for(i=0;i<=strlen(month);i++)
        {
        if(month[i]>=97&&month[i]<=122)
        month[i]=month[i]-32;
        }

        if (strcmp((month), "JANUARY")==0){ 

            m = 1;}

        else if (strcmp((month), "FEBRUARY")==0)
        m = 2;
        else if (strcmp((month), "MARCH")==0)
        m = 3;
        else if (strcmp((month), "APRIL")==0)
        m = 4;
        else if (strcmp((month), "MAY")==0)
        m = 5;
        else if (strcmp((month), "JUNE")==0)
        m = 6;
        else if (strcmp((month), "JULY")==0)
        m = 7;
        else if (strcmp((month), "AUGUST")==0)
        m = 8;
        else if (strcmp((month), "SEPTEMBER")==0)
        m = 9;
        else if (strcmp((month), "OCTOBER")==0)
        m = 10;
        else if (strcmp((month), "NOVEMBER")==0)
        m = 11;
        else if (strcmp((month), "DECEMBER")==0)
        m = 12;
        return m;
    }

    void AddEvent (calentry_t calendar[][31], char eventname[], int* monthnum, int *day, int *year, int *h, int *min){
        char monthstr [20];
        strcpy(monthstr,MonthNum2Str(monthnum));
        strcpy ( calendar [(*monthnum-1)][(*day-1)]. event_list[calendar[(*monthnum-1)][(*day-1)].num_events].ev_name,eventname );
        strcpy ( calendar [(*monthnum-1)][(*day-1)]. event_list[calendar[(*monthnum-1)][(*day-1)].num_events].dt.month,monthstr );  
        calendar [(*monthnum-1)][(*day-1)].num_events++;
        calendar [(*monthnum-1)][(*day-1)]. event_list[calendar[(*monthnum-1)][(*day-1)].num_events].dt.day = (*day);
        calendar [(*monthnum-1)][(*day-1)]. event_list[calendar[(*monthnum-1)][(*day-1)].num_events].dt.year = (*year); 
        calendar [(*monthnum-1)][(*day-1)]. event_list[calendar[(*monthnum-1)][(*day-1)].num_events].tm.hours = (*h);
        calendar [(*monthnum-1)][(*day-1)]. event_list[calendar[(*monthnum-1)][(*day-1)].num_events].tm.minutes = (*min);           
        counter++;

    }

    char* MonthNum2Str (int* m){ 
        if (*m==1)
        return "January";
        else if (*m==2)
        return "February";
        else if (*m==3)
        return "March";
        else if (*m==4)
        return "April";
        else if (*m==5)
        return "May";
        else if (*m==6)
        return "June";
        else if (*m==7)
        return "July";
        else if (*m==8)
        return "August";
        else if (*m==9)
        return "September";
        else if (*m==10)
        return "October";
        else if (*m==11)
        return "November";
        else if (*m==12)
        return "December";
    }

    void DisplayCalendar (calentry_t calendar[][31], int* monthnum, int* day, int* year){
        int i;

        if ( calendar [(*monthnum-1)][(*day-1)].num_events==0)
            printf ("\n\tNo events on this date!!!!!!\n");
            else{
            printf ("\n\tOn %d-%s-%d You have %d event(s): \n", *day, calendar [(*monthnum-1)][(*day-1)]. event_list[(calendar[(*monthnum-1)][(*day-1)].num_events)-1].dt.month, *year, calendar[(*monthnum-1)][(*day-1)].num_events);
                for (i=0; i<calendar[(*monthnum-1)][(*day-1)].num_events; i++){
                    printf ("\t\n Event %d: ", i+1);
                    printf ("\t\n Name of the event: %s", calendar [(*monthnum-1)][(*day-1)]. event_list[i].ev_name );
                    printf ("\t\n Time of the event: %d:%d\n", calendar [(*monthnum-1)][(*day-1)]. event_list[i+1].tm.hours, calendar [(*monthnum-1)][(*day-1)]. event_list[i+1].tm.minutes);
                }
            }
    }

    void DisplayWholeCalendar ( calentry_t calendar[][31]){
        int x, y, i;

        printf ("You have a total of %d event(s)\n", counter);

        for(x = 0; x < 12; x ++) {
            for (y=0; y< 31; y++){
                if ((calendar[x][y]).valid == FALSE ||(calendar[x][y]).num_events == FALSE){
                }
                else {
                printf ("On %d-%s-%d You have %d event(s): \n", y+1, calendar [x][y]. event_list[(calendar[x][y].num_events)-1].dt.month, calendar [x][y]. event_list[calendar[x][y].num_events].dt.year, calendar[x][y].num_events);
                    for (i=0; i<calendar[x][y].num_events; i++){
                    printf ("\t\n Event %d: ", i+1);
                    printf ("\t\n Name of the event: %s", calendar [x][y]. event_list[i].ev_name );
                    printf ("\t\n Time of the event: %d:%d\n", calendar [x][y]. event_list[i+1].tm.hours, calendar [x][y]. event_list[i+1].tm.minutes);
                    }
                }
            }
        }
    }

    int DeleteEvent (calentry_t calendar [][31]){
        int day, year, monthnum, choice, c;
        char month [20];

        printf ("\n\tWhat is the date that you want to delete one of its events? input like ( 12 January 2012 )  ");
        scanf ("%d %s %d", &day, month, &year);
        monthnum = MonthStr2Num (month);
        if ( calendar [(monthnum-1)][(day-1)].num_events==0){
            printf ("No events on this date!!!!!!\n");
            return 0;
        }
        if ((calendar[(monthnum-1)][(day-1)]).valid == FALSE){
            printf ("Invalid date !!!!\n");
            return 0;
        }
        else {
        DisplayCalendar (calendar ,&monthnum, &day, &year);
        printf ("\n\nWhat is the event that you want to delete (press 1 for event 1 or 2 for event 2...) ");
        scanf ("%d", &choice);
            if ( choice >= (calendar [(monthnum-1)][(day-1)].num_events)+1 )
                 printf("\n\tDeletion not possible.\n");

            else {
                for ( c = choice - 1 ; c < (calendar [monthnum-1][day-1].num_events) ; c++ ){
              calendar [monthnum-1][day-1]. event_list[c] =calendar [monthnum-1][day-1]. event_list[c+1];   
                }         calendar [monthnum-1][day-1].num_events--;
                            printf ("\n\tEvent deleted \n");
                            counter--;
            }
        }

    } 
```

谁能帮忙！先感谢您。

# python - 如何检查python mako模板中是否存在列表变量？

> ID：13594753
> 
> 赞同：2
> 
> 时间：2012-11-27T22:59:25.320
> 
> 标签：python, mako

假设我的模板中有以下内容：

```
% if not mydict['somekey'] is UNDEFINED:
    ${mydict['somekey'][0]['hellothere']}</td></tr>
% endif 
```

我的问题是上面的内容不能像`mydict['somekey']`数组一样正常工作，但它可能是空的。我希望能够检查以确保是否`mydict['somekey']`已定义，我可以添加检查以确保 1）列表大小大于 0（从模板内部）或者其中是否`mydict['somekey']`包含元素，以便我可以打印出`mydict['somekey'][0]['hellothere']`可用的内容。

我必须做什么？我不断收到：

```
IndexError: list index out of range 
```

与上述

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:21:28.803

[PEP 8](http://www.python.org/dev/peps/pep-0008/#programming-recommendations)建议：

> 对于序列（字符串、列表、元组），使用空序列为假的事实。

所以真的你不需要检查长度，只需像这样检查它：

```
% if mydict.get('somekey'):
    ${mydict['somekey'][0]['hellothere']}</td></tr>
% endif 
```

# python - 按登录的用户过滤字段

> ID：13594759
> 
> 赞同：0
> 
> 时间：2012-11-27T22:59:42.010
> 
> 标签：python, django

我是 Django 的新手，我有一个包含三个模型的应用程序。我需要用户创建一个提要，但只在其组中。例如，我有 2 个品牌和 2 个用户，一个用户分配给一个品牌，另一个用户分配给另一个品牌。当我想在品牌选择中与用户创建提要时，会出现所有品牌，我希望只显示与用户关联的品牌。我该如何解决？

我有这些课程

```
from django.db import models
from django.contrib.auth.models import User

class Brand(models.Model):
"""
Brand Model
"""
    name = models.CharField(max_length=60)

    def __unicode__(self):
        return self.name

class UserFeed(models.Model):
"""
User feed
"""
    user = models.OneToOneField(User)
    firstName = models.CharField(max_length=100)
    lastName = models.CharField(max_length=100)
    email = models.EmailField(max_length=100, blank=True)
    brands = models.ManyToManyField(Brand)

    def __unicode__(self):
        return self.firstName

class Feed(models.Model):
"""
Principal Model for feeds and news
"""
    title = models.CharField(max_length=200)
    url = models.URLField(max_length=200)
    pubdate = models.DateTimeField('Date published')
    brand = models.ForeignKey(Brand)
    image = models.ImageField(upload_to="images", max_length=100, blank=True)
    description = models.TextField()
    content = models.TextField()
    updated = models.DateTimeField('Date updated', auto_now=True)
    active = models.BooleanField()

    def __unicode__(self):
        return self.title 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T03:25:12.443

我从问题中了解到的。可能是这样的：

```
 feed = Feed.objects.filter(barnd__in=user.brands.all()) 
```

# android - 演讲失败：未绑定到 tts 引擎 Android

> ID：13594765
> 
> 赞同：2
> 
> 时间：2012-11-27T23:00:10.233
> 
> 标签：android

我的应用程序使用了 Android 提供的 TTS 功能，但是当我使用它时，它显示此错误提示失败：未绑定到 tts 引擎。

这是我的代码。请如果有人可以帮助我，我搜索了任何人面临的类似问题，但我没有找到解决方案。

```
 public class WeatherMeActivity extends Activity implements TextToSpeech.OnInitListener{
private ProgressDialog pDialog;

private TextToSpeech tts;
// This code can be any value you want, its just a checksum.
private static final int MY_DATA_CHECK_CODE = 1234;

private static final String TAG = "Error";

/** Called when the activity is first created. */

static String stat_strCity = null;
static String stat_strCountry = null;
static String stat_strTempUnit = null;
static String stat_strTempValue = null;
static String stat_strHumidity = null;
static String stat_strText = null;;
static String stat_strCode = null;;
static String stat_strDate = null;;
static String stat_strVisi = null;

public String location="Jerusalem";
public String  temperature;
public String  humidityTitle;
public String  humidityValue;
public String   visiValue;
public String   dateTime;
private static HttpURLConnection httpConnection;
private static final String URL_YAHOO_API_WEATHER = "http://weather.yahooapis.com/forecastrss?w=%s&u=c";
private static final String PARAM_YAHOO_LOCATION = "yweather:location";
private static final String PARAM_YAHOO_UNIT = "yweather:units";
private static final String PARAM_YAHOO_ATMOSPHERE = "yweather:atmosphere";
private static final String PARAM_YAHOO_CONDITION = "yweather:condition";
private static final String PARAM_YAHOO_VALUE = "yweather:wind";

/** Attribute city */
private static final String ATT_YAHOO_CITY = "city";
private static final String ATT_YAHOO_COUNTRY = "country";
private static final String ATT_YAHOO_TEMP_UNIT = "temperature";
private static final String ATT_YAHOO_HUMIDITY = "humidity";
private static final String ATT_YAHOO_TEXT = "text";
private static final String ATT_YAHOO_CODE = "code";
private static final String ATT_YAHOO_DATE = "date";
private static final String ATT_YAHOO_TEMP = "chill";
private static final String ATT_YAHOO_VISI = "visibility";

/** Image array */
public static final int[][] m_ImageArr = {
    ......
};

int nCode = 0;
/** Location */
 TextView m_TextLocation;

/** Temperature */
  TextView m_Temperature;

/** Humimidy */
  TextView m_Humimidy;

/** State */
  TextView  m_Visibility;

/** Time */
  TextView m_Date;

/** Icon */
  ImageView m_WeatherIcon;

@Override
public void onCreate(Bundle savedInstanceState) {

super.onCreate(savedInstanceState);
    Log.e(TAG,"load main view done");

    setContentView(R.layout.weather_layout);
    tts = new TextToSpeech(this, this);
    // Fire off an intent to check if a TTS engine is installed
    Intent checkIntent = new Intent();
    checkIntent.setAction(TextToSpeech.Engine.ACTION_CHECK_TTS_DATA);
    startActivityForResult(checkIntent, MY_DATA_CHECK_CODE);

    Log.e(TAG,"load main view");
   // initializeView();
    Log.e(TAG,"intialize view done");

    m_TextLocation = (TextView)findViewById(R.id.location);
    m_Temperature = (TextView)findViewById(R.id.temperature);
    m_Humimidy = (TextView)findViewById(R.id.humidityValue);
    m_Visibility = (TextView)findViewById(R.id.visiValue);
    m_WeatherIcon = (ImageView) findViewById(R.id.weather_icon);
    m_Date = (TextView)findViewById(R.id.dateTime);

    Button lisAgain = (Button)findViewById(R.id.button1);
    lisAgain.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            speakOut("you are in ");
        }
    });

    new weatherGet().execute();

}

public void onStart() {
    // TODO Auto-generated method stub
    super.onStart();
    Resources res = getResources();
    String songsFound = res.getString(R.string.tts_on);

    if( songsFound.equals("true"))
        ;//speakOut("you are in ");
}
ImageButton btn_map,btn_agenda,btn_weather,btn_trip;

public void onInit(int status) {
    // TODO Auto-generated method stub

    if (status == TextToSpeech.SUCCESS) {

        int result = tts.setLanguage(Locale.US);

        // tts.setPitch(5); // set pitch level

        // tts.setSpeechRate(2); // set speech speed rate

        if (result == TextToSpeech.LANG_MISSING_DATA
                || result == TextToSpeech.LANG_NOT_SUPPORTED) {
            Log.e("TTS", "Language is not supported");
        } else {

            //speakOut("Tempreature is "+stat_strTempValue);
        }

    } else {
        Log.e("TTS", "Initilization Failed");
    }

}
private  void speakOut(String text ) {

    if( text !=null){

    tts.speak(text, TextToSpeech.QUEUE_FLUSH, null);

    }
}

  private boolean initializeView(){

        return true;
  }
    protected void onResume() {
        super.onResume();

    }

public static void parserYahooWeatherInfo(Document docWeather){
    if (docWeather == null){
        //Log.e(TAG,"Invalid doc weatehr");
    //  return null;
    }

    String strCity = null;
    String strCountry = null;
    String strTempUnit = null;
    String strTempValue = null;
    String strHumidity = null;
    String strText = null;
    String strCode = null;
    String strDate = null;
    String strVisi = null;
    try {
        Element root = docWeather.getDocumentElement();
        root.normalize();

        NamedNodeMap locationNode = root.getElementsByTagName(PARAM_YAHOO_LOCATION).item(0).getAttributes();

        if (locationNode != null){
            strCity = locationNode.getNamedItem(ATT_YAHOO_CITY).getNodeValue();
            strCountry = locationNode.getNamedItem(ATT_YAHOO_COUNTRY).getNodeValue();
        }

        NamedNodeMap unitNode = root.getElementsByTagName(PARAM_YAHOO_UNIT).item(0).getAttributes();
        if (unitNode != null){
            strTempUnit = unitNode.getNamedItem(ATT_YAHOO_TEMP_UNIT).getNodeValue();
        }

        NamedNodeMap atmosNode = root.getElementsByTagName(PARAM_YAHOO_ATMOSPHERE).item(0).getAttributes();
        if (atmosNode != null){
            strHumidity = atmosNode.getNamedItem(ATT_YAHOO_HUMIDITY).getNodeValue();
            strVisi = atmosNode.getNamedItem(ATT_YAHOO_VISI).getNodeValue();
        }

        NamedNodeMap conditionNode = root.getElementsByTagName(PARAM_YAHOO_CONDITION).item(0).getAttributes();
        if (conditionNode != null){
            strText = conditionNode.getNamedItem(ATT_YAHOO_TEXT).getNodeValue();
            strCode = conditionNode.getNamedItem(ATT_YAHOO_CODE).getNodeValue();
            strDate = conditionNode.getNamedItem(ATT_YAHOO_DATE).getNodeValue();
        }

        NamedNodeMap temNode = root.getElementsByTagName(PARAM_YAHOO_VALUE).item(0).getAttributes();
        if (temNode != null){
            strTempValue = temNode.getNamedItem(ATT_YAHOO_TEMP).getNodeValue();
        }

    } catch (Exception e){
    //  Log.e(TAG,"Something wroing with parser data");
        //return null;
    }

    stat_strCity = strCity ;
    stat_strCountry = strCountry ;
    stat_strTempUnit =strTempUnit ;
    stat_strTempValue = strTempValue;
    stat_strHumidity = strHumidity ;
    stat_strText = strText ;
    stat_strCode = strCode ;
    stat_strDate = strDate ;
    stat_strVisi = strVisi ;

    //return yahooWeatherInfo;
}
  private static int getImageByCode(String strCode){
        int nImageCode = R.drawable.a0;

        if (strCode == null){
            //Log.e(TAG,"Code is null");
            return nImageCode;
        }

        int nCode = Integer.parseInt(strCode);

        int nNumber= m_ImageArr.length;
        for (int i=0; i < nNumber; i++){
            if (nCode == m_ImageArr[i][1]){
                return m_ImageArr[i][0];
            }
        }
        return nImageCode;
  }

    public void onDestroy() {
        // Don't forget to shutdown!
        if (tts != null) {
            tts.stop();
            tts.shutdown();
        }
        super.onDestroy();
    }  

private static void requestConnectServer(String strURL) throws IOException {    
    strURL = "http://weather.yahooapis.com/forecastrss?w=1937180&u=c";

    httpConnection = (HttpURLConnection)new URL(strURL).openConnection();
    httpConnection.connect();

    if(httpConnection.getResponseCode() != HttpURLConnection.HTTP_OK){
     Log.e(TAG,"Something wrong with connection");
        httpConnection.disconnect();
        throw new IOException("Error in connection: "+ httpConnection.getResponseCode());
    }
}

 **************************************************************************/
private static void requestDisconnect(){
    if(httpConnection != null){
        httpConnection.disconnect();
    }
}

public static Document getDocumentFromURL(String strURL) throws IOException {
    /* Verify URL */
    if (strURL == null){
        Log.e(TAG,"Invalid input URL");
        return null;
    }
    String strRegURL = String.format(URL_YAHOO_API_WEATHER, strURL);
    System.out.println(strRegURL);

    /* Connect to server */
    requestConnectServer(strRegURL);
    Log.e(TAG,"Connect server done");

    /* Get data from server */
    String strDocContent = getDataFromConnection();
    Log.e(TAG,"getDataFromConnection done");

    /* Close connection */
    requestDisconnect();
    Log.e(TAG,"requestDisconnect");
    if (strDocContent == null){
        Log.e(TAG,"Can not get xml content");
        return null;
    }

    int strContentSize = strDocContent.length();
    StringBuffer strBuff = new StringBuffer();
    strBuff.setLength(strContentSize+1);
    strBuff.append(strDocContent);
    ByteArrayInputStream is = new ByteArrayInputStream(strDocContent.getBytes());

    DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
    DocumentBuilder db;
    Document docData = null;

    try {
        db = dbf.newDocumentBuilder();
        docData = db.parse(is);
    } catch (Exception e) {
        Log.e(TAG,"newDocumentBuilder");
        return null;
    }

    return docData;
}

private static String getDataFromConnection() throws IOException {
    if (httpConnection == null){
        return null;
    }

    String strValue = null;
    InputStream inputStream = httpConnection.getInputStream();
    if (inputStream == null){
        return null;
    }

    StringBuffer strBuf = new StringBuffer();       
    BufferedReader buffReader = new BufferedReader(new InputStreamReader(inputStream));
    String strLine = "";

    while ((strLine = buffReader.readLine()) != null){
        strBuf.append(strLine+"\n");
        strValue +=strLine+"\n";
    }

    /* Release resource to system */
    buffReader.close();
    inputStream.close();

    return strBuf.toString();
}

class weatherGet extends AsyncTask<String, String, String> {

    @Override
    protected String doInBackground(String... params) {
        // TODO Auto-generated method stub

        Document dd = null;
        try {
             dd = getDocumentFromURL(location);
        } catch (IOException e) {
            Log.e(TAG,"intialize view done 2");

            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        parserYahooWeatherInfo(dd);

        return null;
    }

    protected void onPreExecute() {
        super.onPreExecute();
        pDialog = new ProgressDialog(WeatherMeActivity.this);
        pDialog.setMessage("Loading Weather Information. Please wait...");
        pDialog.setIndeterminate(false);
        pDialog.setCancelable(false);
        pDialog.show();
    }

    protected void onPostExecute(String file_url) {

        pDialog.dismiss();
        // updating UI from Background Thread
        runOnUiThread(new Runnable() {
            public void run() {
                /**
                 * Updating parsed JSON data into ListView
                 * */

                nCode = getImageByCode(stat_strCode);

                m_WeatherIcon.setImageResource(nCode);
                m_TextLocation.setText(stat_strCity);
                m_Temperature.setText(stat_strTempValue);
                m_Date.setText(stat_strDate);

                m_Humimidy.setText(stat_strHumidity);
                m_Visibility.setText(stat_strVisi);
                speakOut("Tempreature is "+stat_strTempValue);

            }
        });

    }

} 
```

}

# c# - 为什么我的工作流程没有显示所有步骤？

> ID：13594768
> 
> 赞同：1
> 
> 时间：2012-11-27T23:00:33.807
> 
> 标签：c#, visual-studio-2010, dynamics-crm-2011, workflow-foundation-4

我在 Microsoft Dynamics CRM 2011 中创建了一个工作流，然后我导出并使用 VS 2010 打开了 XAML 文件。当我打开它时它向我显示了这个： ![在此处输入图像描述](../Images/e14a1003a1dc96fef6cd360fafc66116.png)

但是这个工作流程实际上还有更多的步骤。为什么我看不到它们或无法编辑它们？我尝试单击右上角的全部展开，但这似乎没有任何区别。如果我查看实际代码，我可以看到许多步骤 - 但在设计视图中看不到。任何想法为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T06:50:03.740

屏幕截图中的活动是自定义活动。默认情况下，您看到的只是这个占位符。但是，您可以创建[自定义活动设计](http://msdn.microsoft.com/en-us/library/dd489419.aspx)器并将活动与这些设计器相关联。在您的自定义活动设计器中，您可以做任何您可以在 WPF 中做的事情，包括显示子活动。

# c# - MVC无法在VS2010中创建控制器

> ID：13594769
> 
> 赞同：1
> 
> 时间：2012-11-27T23:00:39.500
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3, entity-framework

我正在使用 mysql 驱动程序 6.6.4 和 EF 4.4.0.0。我的上下文可以创建数据库，它还创建了一个 _MigrationHistory 表，我可以插入、列出、删除记录。

我可以使用创建模型添加一个动作，并自动创建模型，一切都很完美这里是我的清晰上下文

```
public class MyContext : DbContext
{
    static MyContext()
    {
        Database.SetInitializer<MyContext>(null);
    }

    public MyContext()
        : base("Name=MyContext")
    {
    }

    public DbSet<AdminUser> AdminUsers { get; set; }
    public DbSet<Feedback> Feedbacks { get; set; }
    public DbSet<Navigation> Navigations { get; set; }
    public DbSet<SiteLink> SiteLinks { get; set; }
    public DbSet<SiteNew> SiteNews { get; set; }
    public DbSet<StockList> StockLists { get; set; }
    public DbSet<SubNavigation> SubNavigations { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Configurations.Add(new AdminUserMap());
        modelBuilder.Configurations.Add(new FeedbackMap());
        modelBuilder.Configurations.Add(new NavigationMap());
        modelBuilder.Configurations.Add(new SiteLinkMap());
        modelBuilder.Configurations.Add(new SiteNewMap());
        modelBuilder.Configurations.Add(new StockListMap());
        modelBuilder.Configurations.Add(new SubNavigationMap());

    } 
```

我的 constring 与我的上下文同名，正如所说的那样，这一切都有效。我还将数据提供程序添加到我的 web.config 文件中。

我什至在创建存储过程中添加了一些代码，这一切都很好，底线一切看起来都很好，就我而言，我已经完成了我可能做的所有事情。

但是当我创建一个控制器时，我得到了这个：[使用带有创建、编辑、删除选项的创建控制器）

![在此处输入图像描述](../Images/61af69bfd64701338b5f5ae6325b1419.png)

现在这里和网络上有很多关于这个的噪音，但我实际上已经涵盖了所有内容。我什至将我的 dbContext 设置为 DbSets，仅此而已。这已经让我头疼了很长一段时间，我已经做了所有的事情并阅读了所有可能的内容，然后才开始在这里提问。

现在我知道使用 SQL Server 等可能会容易得多，但是我没有那个选项，我有一个非常好的 mysql 集群和许多首先使用 EF 和代码的站点，当我安装 asp.net MVC 时问题似乎开始了4 并升级到最新的.net。

请有任何想法，我会尝试任何东西

网络配置

```
<configuration>
<configSections>
<section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
   <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 -->
 </configSections>
 <connectionStrings>
  <add name="MyContext" connectionString="server=localhost;database=MyDB;user id=myuser; password=mypass; Pooling=false" providerName="MySql.Data.MySqlClient" />
 </connectionStrings>
<appSettings>
  <add key="webpages:Version" value="2.0.0.0" />
  <add key="webpages:Enabled" value="false" />
  <add key="PreserveLoginUrl" value="true" />
  <add key="ClientValidationEnabled" value="true" />
  <add key="UnobtrusiveJavaScriptEnabled" value="true" />
</appSettings>
<system.web>
  <compilation debug="true" targetFramework="4.0" />
  <pages controlRenderingCompatibilityVersion="4.0" clientIDMode="AutoID">
    <namespaces>
      <add namespace="System.Web.Helpers" />
      <add namespace="System.Web.Mvc" />
      <add namespace="System.Web.Mvc.Ajax" />
      <add namespace="System.Web.Mvc.Html" />
      <add namespace="System.Web.Routing" />
      <add namespace="System.Web.WebPages" />
    </namespaces>
  </pages>
</system.web>
<system.data>
  <DbProviderFactories>
       <remove invariant="MySql.Data.MySqlClient" />
     <add name="MySQL Data Provider" invariant="MySql.Data.MySqlClient" description=".Net Framework Data Provider for MySQL" type="MySql.Data.MySqlClient.MySqlClientFactory, MySql.Data, Version=6.6.4.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d" />
   </DbProviderFactories>
 </system.data>
   <runtime>
     <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
       <dependentAssembly>
       <assemblyIdentity name="EntityFramework" publicKeyToken="b77a5c561934e089" culture="neutral" />
       <bindingRedirect oldVersion="0.0.0.0-4.4.0.0" newVersion="4.4.0.0" />
    </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="MySql.Data" publicKeyToken="c5687fc88969c44d" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-6.6.4.0" newVersion="6.6.4.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true" />
    <handlers>
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
      <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
       <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
        <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
     </handlers>
       </system.webServer>
      <entityFramework>
      <defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework">
         <parameters>
         <parameter value="v11.0" />
       </parameters>
     </defaultConnectionFactory>
  </entityFramework>
  </configuration> 
```

模型：

```
public class AdminUser
{
    public int Id { get; set; }
    public string UserName { get; set; }
    public string Password { get; set; }
    public string Email { get; set; }
    public short UserLevel { get; set; }
} 
```

映射

```
public class AdminUserMap : EntityTypeConfiguration<AdminUser>
{
    public AdminUserMap()
    {
        // Primary Key
        this.HasKey(t => t.Id);

        // Properties
        this.Property(t => t.UserName)
            .IsRequired()
            .HasMaxLength(50);

        this.Property(t => t.Password)
            .IsRequired()
            .HasMaxLength(50);

        this.Property(t => t.Email)
            .HasMaxLength(150);

        // Table & Column Mappings
        this.ToTable("AdminUsers", "eyebag");
        this.Property(t => t.Id).HasColumnName("Id");
        this.Property(t => t.UserName).HasColumnName("UserName");
        this.Property(t => t.Password).HasColumnName("Password");
        this.Property(t => t.Email).HasColumnName("Email");
        this.Property(t => t.UserLevel).HasColumnName("UserLevel");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T09:00:19.667

试试这些事情：也许默认端口号是错误的，所以将端口号添加到您的连接字符串以匹配您的服务器设置。将您的设置减少到最低限度，删除运行不需要的任何内容：appSettings、运行时（不确定这是否会正确默认）、处理程序（在 system.webserver 内）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T12:46:54.037

好吧，似乎最简单的解决方案是下载 nuget 包 MvcScaffolding，然后使用 MVCScaffolding 版本的添加控制器和 EF 创建、编辑、删除此版本工作并解决我的问题，为什么其他选项不起作用将可能未知，但感谢大家的帮助和建议

# linux - 从 linux 上的任何用户目录运行 groovy 脚本

> ID：13594772
> 
> 赞同：0
> 
> 时间：2012-11-27T23:00:48.423
> 
> 标签：linux, groovy

我在 groovy 中编写了一个实用程序脚本，并希望根据需要在任何目录中运行它，而不必指定它的完整路径。如在`$> groovy myScript.groovy`

我已将其父目录的路径添加到 .profile 中的 PATH 中，获取它，但保留 gettig 'command not found' 错误。从概念上讲，知道在哪里寻找问题吗？

**东西在哪里：**

我的 PostBuilder.groovy 脚本的第一行：#!/usr/bin/env groovy`

.profile 中的路径：`export PATH=$PATH:/home/me/work/web/MyProject/public_html`

我现在尝试在我的主目录中执行脚本时遇到的错误：

```
Caught: java.io.FileNotFoundException: /home/me/PostBuilder.groovy (/home/me/PostBuilder.groovy) 
```

仅供参考，我的 Groovy/Grails 设置工作得很好，所以我认为 groovy 本身的安装是可以的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:04:19.433

您真正想要的更有可能是：

1.  将脚本所在的路径添加到 PATH 环境变量中，然后
2.  通过`chmod u+x`, 和
3.  Shebang 它与`#!/usr/bin/env groovy`（或您的等价物）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:48:06.870

将路径添加`groovy/bin`到您的`PATH`. 然后您可以运行 groovy，但您仍然需要在 .groovy 脚本的目录中，或提供完整路径才能执行。

# c# - 在 VS 2005 中，调试 Debug 构建时未命中断点是什么意思？

> ID：13594773
> 
> 赞同：0
> 
> 时间：2012-11-27T23:00:50.423
> 
> 标签：c#, .net, visual-studio, debugging, breakpoints

如果我转到配置管理器并将配置字段设置为“调试”并按 F5，则不会命中断点。（这些是 Main() 方法的第一行中的断点）。

如果我将配置字段设置为“发布”并运行应用程序，则会命中断点。

我还注意到，当我运行 Debug 构建时，只有在我选择 Target x86 或 x64 时才会触发断点，但在我选择 ANY CPU 时不会。

这种行为的原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T19:16:57.597

我解决了这个问题:)

```
 Solution Explorer ->
   Right click on the solution ->
   Properties ->
   Build ->
   Advanced button ->
   Debug Info: <change from none to pdb-only> 
```

# ruby-on-rails - Rails用虾将数组渲染为pdf

> ID：13594775
> 
> 赞同：0
> 
> 时间：2012-11-27T23:00:58.670
> 
> 标签：ruby-on-rails, ruby, pdf, prawn

我需要将我的@manufacturers 数组呈现为 pdf，但只能通过单击视图中的某个链接来实现...现在我有这样的代码

```
def index
    @manufacturers = Manufacturer.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @manufacturers }
      format.pdf { render :layout => false }
    end
  end 
```

我在网络上看到了很多例子，但我没有找到明确和实际的例子......我的数组@manufacturers 在 a4 pdf 表中有多简单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:14:47.710

除了 prawn，还可以使用 prawnto rails 插件来帮助将 PDF 呈现为模板。

有关插件，请参阅[https://github.com/prior/prawnto](https://github.com/prior/prawnto) ，有关如何使用它，请参阅[http://railscasts.com/episodes/153-pdfs-with-prawn 。](http://railscasts.com/episodes/153-pdfs-with-prawn)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:05:57.043

[注意：报告宝石目前仅在信纸大小的纸张上生成，欢迎使用 A4 补丁！]

您可以使用[Report](https://github.com/seamusabshere/report) gem，它使用 Prawn 以及 XLSX 和 CSV 生成 PDF。

```
# a fake Manufacturer class - you probably have an ActiveRecord model
Manufacturer = Struct.new(:name, :gsa)

require 'report'
class ManufacturerReport < Report
  table 'Manufacturers' do
    head do
      row 'Manufacturer report'
    end
    body do
      rows :manufacturers
      column 'Name', :name
      column 'GSA?', :gsa
    end
  end
  # you would want this so that you can pass in an array
  # attr_reader :manufacturers
  # def initialize(manufacturers)
  #   @manufacturers = manufacturers
  # end
  def manufacturers
    [
      Manufacturer.new('Ford', true),
      Manufacturer.new('Fischer', false),
      Manufacturer.new('Tesla', nil),
    ]
  end
end 
```

当您调用时`report.pdf.path`，将在 tmp 目录中生成 PDF：

```
report = ManufacturerReport.new
puts report.pdf.path #=> /tmp/185051406_Report__Pdf.pdf
puts report.xlsx.path #=> /tmp/185050541_Report__Xlsx.xlsx 
```

您可以在控制器中执行此操作，例如：

```
@manufacturers = Manufacturer.all
respond_to do |format|
  format.html # index.html.erb
  format.json { render json: @manufacturers }
  format.pdf do
    report = ManufacturerReport.new(@manufacturers) # using the commented-out code
    send_file report.pdf.path, :type => 'application/pdf', :disposition => 'attachment', :filename => 'ManufacturersReport.pdf'
    # tmp files are periodically cleaned up by the operating system, but if you want to be extra clean you can call
    # report.cleanup
    # but this may remove the tmp files before apache/nginx/etc. finishes delivering the file
  end
end 
```

最终结果：

PDF格式

![pdf](../Images/2d9f331520ce02b50e2fc475cd08f817.png)

XLSX

![xlsx](../Images/e5790e406607de003d7ac4d51aec1307.png)

请注意，XLSX 会自动为您添加一个自动过滤器。

# java - ListView 中的 EditText 需要 adjustResize 但失去焦点错误

> ID：13594780
> 
> 赞同：4
> 
> 时间：2012-11-27T23:01:26.413
> 
> 标签：java, android, listview, android-edittext

我在使用`EditText`in时遇到问题`ListView`。

`EditText`总是失去焦点。我已经解决了这个问题，`windowSoftInputMode="adjustPan"`但现在软键盘覆盖输入字段 => 我需要调整调整大小，但我将再次遇到失去焦点的错误。

有任何想法吗？

我创建了具有布局的简单测试项目`ListView`，在`onCreate`我初始化`ListView`和设置具有覆盖方法的 BaseAdapter`getView()`和`getCount()`

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View v = getLayoutInflater().inflate(R.layout.list_item, null);
    EditText editText = (EditText) v.findViewById(R.id.editText);
    editText.setText("" + position);
    return v;
} 
```

`list_item`布局包含`EditText`在`LinearLayout`.

需要在 github 上推送这个测试项目吗？

# c# - c#razor中锚标记文本中的html代码

> ID：13594784
> 
> 赞同：1
> 
> 时间：2012-11-27T23:02:20.517
> 
> 标签：c#, asp.net-mvc-3, razor

我正在尝试显示卢比符号：₹代码：₹；在我的锚标签中。

我已经尝试了一些东西，但没有任何效果......请帮助

```
 @{ string _text =
               String.Format("{0} {1} {2} {3} {4}",
               @Html.DisplayFor(model => model.NoOfBedrooms),
               "bedroom flat",
               @Html.DisplayFor(model => model.TransactionTypeDescription),
               @Html.Raw(&#8377;),
               @Html.DisplayFor(model => model.Price));

           string _rental = "";
           if (Model.TransactionType == 2) { _rental = " per month"; } else { _rental = ""; };

           string _linkText = _text + _rental;
        }

@Html.ActionLink(_linkText, "Details", "Property", new { id = Model.PropertyId }, null) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:12:56.597

我不确定您是否可以`Html.ActionLink`使用`<a href='@Url.Action("Index")'>@Html.Raw("&#8377")</a>`.

* * *

```
@{ string _text =
           String.Format("{0} {1} {2} {3} {4}",
           @Html.DisplayFor(model => model.NoOfBedrooms),
           "bedroom flat",
           @Html.DisplayFor(model => model.TransactionTypeDescription),
           "&#8377;",
           @Html.DisplayFor(model => model.Price));

       string _rental = "";
       if (Model.TransactionType == 2) { _rental = " per month"; } else { _rental = ""; };

       string _linkText = _text + _rental;
    }

<a href='@Url.Action("Details", "Property", new { id = Model.PropertyId })'>
    @Html.Raw(_linkText)
</a> 
```

# php - 将父元素附加到 PHP 中的数组以进行 foreach 循环

> ID：13594785
> 
> 赞同：1
> 
> 时间：2012-11-27T23:02:24.793
> 
> 标签：php, arrays, json, foreach

`print_r`的`$data = json_decode($src, true);`返回数据如下所示：

```
Array ( 
[0] => Array ( 
 [var1] => blah
 [var2] => foo
 ) 
[1] => Array ( 
 [var1] => lorem 
 [var2] => ipsum
 )
  // goes down to [1936]
) 
```

我想构建一个 html 表，在同一行中显示 var1 和 var2 彼此相邻。我知道这样做我需要一个 foreach 语句，例如

`foreach($data['items'] as $item)`

但我认为我遇到的问题是我的许多数组不是一件事的孩子`'items'`，对吧？

我看了看，`array_push`但无法弄清楚。有人可以帮助我的孤儿无父母阵列吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:05:20.117

使用`$data`它自己来遍历`$data`.

```
foreach($data as $item) {
    echo "<tr><td>" . $item["var1"] . "</td><td>" $item["var2"] . "</td></tr>";
} 
```

注意：接受编辑，但请注意括号是可选的。不过，很好地抓住了标签。

# c++ - fontconfig 找不到字体

> ID：13594787
> 
> 赞同：4
> 
> 时间：2012-11-27T23:02:26.613
> 
> 标签：c++, configuration, fonts, fontconfig

我试图让我的 C++ 程序检测我的 Win32 机器上安装的字体。我通过从 GTK+ 包中获取库来尝试 fontconfig。

我使用以下测试代码：

 `````
#include<fontconfig.h>

FcBool success = FcInit ();
if ( !success ) {
    return false;
}

FcConfig *config = FcInitLoadConfigAndFonts ();
if(!config) {
    return false;
}

FcChar8 *s, *file;

FcPattern *p = FcPatternCreate();
FcObjectSet *os = FcObjectSetBuild (FC_FAMILY,NULL);
FcFontSet *fs = FcFontList(config, p, os);

LOG("Total fonts: %d\n", fs->nfont);
for (int i=0; fs && i < fs->nfont; i++) {
    FcPattern *font = fs->fonts[i];

    s = FcNameUnparse(font);
    LOG("Font: %s\n", s);
    free(s);

    if (FcPatternGetString(font, FC_FILE, 0, &file) == FcResultMatch) {
        LOG("Filename: %s\n", file);
    }
}

// destroy objects here ... 
````  `不幸的是，这个测试应用程序只打印：

> 总字体：0

我知道我的机器上安装了字体，并且我知道 Gimp2.0 检测到它们，所以我的测试代码一定有问题。有人有什么主意吗？

除了链接 fontconfig-1.dll，我什么也没做。我没有创建任何配置文件或任何东西，因为我无法阅读任何关于必须这样做的信息。

我愿意接受你的建议，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-15T23:49:27.650

代替：

```
FcConfig *config = FcInitLoadConfigAndFonts (); 
```

尝试：

```
FcConfig *config = FcConfigCreate();
FcConfigAppFontAddDir(config, (const FcChar8 *)"C:\\Windows\\Fonts"); 
```

（这是懒惰的版本，你应该适应它去`GetWindowsDirectory`...）``

# javascript - javascript过滤对象数组

> ID：13594788
> 
> 赞同：94
> 
> 时间：2012-11-27T23:02:32.470
> 
> 标签：javascript, jquery, arrays

我有一组对象，我想知道搜索它的最佳方法。鉴于以下示例，我如何搜索`name = "Joe"`and `age < 30`？有什么 jQuery 可以提供帮助，还是我必须自己强制执行此搜索？

```
var names = new Array();

var object = { name : "Joe", age:20, email: "joe@hotmail.com"};
names.push(object);

object = { name : "Mike", age:50, email: "mike@hotmail.com"};
names.push(object);

object = { name : "Joe", age:45, email: "mike@hotmail.com"};
names.push(object); 
```

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2012-11-27T23:04:38.400

现代解决方案[`Array.prototype.filter()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter)：

```
const found_names = names.filter(v => v.name === "Joe" && v.age < 30); 
```

或者，如果您仍然使用 jQuery，您可以使用[`jQuery.grep()`](http://api.jquery.com/jQuery.grep/)：

```
var found_names = $.grep(names, function(v) {
    return v.name === "Joe" && v.age < 30;
}); 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2012-11-27T23:05:52.397

您可以使用以下`[].filter`方法轻松完成此操作：

```
var filterednames = names.filter(function(obj) {
    return (obj.name === "Joe") && (obj.age < 30);
}); 
```

[您可以在此 MDN 页面](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter)上了解有关它的更多信息。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-09-26T07:50:32.420

您可以利用[jQuery.filter()](http://api.jquery.com/filter/)函数从匹配元素的子集中返回元素。

```
var names = [
    { name : "Joe", age:20, email: "joe@hotmail.com"},
    { name : "Mike", age:50, email: "mike@hotmail.com"},
    { name : "Joe", age:45, email: "mike@hotmail.com"}
   ];

var filteredNames = $(names).filter(function( idx ) {
    return names[idx].name === "Joe" && names[idx].age < 30;
}); 

$(filteredNames).each(function(){
     $('#output').append(this.name);
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<div id="output"/>
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-01-24T15:46:01.607

```
var nameList = [
{name:'x', age:20, email:'x@email.com'},
{name:'y', age:60, email:'y@email.com'},
{name:'Joe', age:22, email:'joe@email.com'},
{name:'Abc', age:40, email:'abc@email.com'}
];

var filteredValue = nameList.filter(function (item) {
      return item.name == "Joe" && item.age < 30;
});

//To See Output Result as Array
console.log(JSON.stringify(filteredValue));
```

你可以简单地使用 javascript :)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-09-06T10:12:19.277

**对于那些想要使用任何键从对象数组中过滤的人：**

```
function filterItems(items, searchVal) {
  return items.filter((item) => Object.values(item).includes(searchVal));
}
let data = [
  { "name": "apple", "type": "fruit", "id": 123234 },
  { "name": "cat", "type": "animal", "id": 98989 },
  { "name": "something", "type": "other", "id": 656565 }]

console.log("Filtered by name: ", filterItems(data, "apple"));
console.log("Filtered by type: ", filterItems(data, "animal"));
console.log("Filtered by id: ", filterItems(data, 656565));
```

从 JSON 对象数组中过滤：**

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-04-24T12:30:31.417

```
var names = [{
        name: "Joe",
        age: 20,
        email: "joe@hotmail.com"
    },
    {
        name: "Mike",
        age: 50,
        email: "mike@hotmail.com"
    },
    {
        name: "Joe",
        age: 45,
        email: "mike@hotmail.com"
    }
];
const res = _.filter(names, (name) => {
    return name.name == "Joe" && name.age < 30;

});
console.log(res);
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.5/lodash.js"></script>
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-09T05:59:30.260

这么快的问题。如果您有两个对象数组，并且您想“对齐”这些对象数组，以便确保每个数组的对象与另一个数组的顺序相同，该怎么办？如果您不知道数组中的任何对象包含哪些键和值怎么办......更不用说它们的顺序是什么了？

因此，您的 , 等需要一个“通配符表达式” `[].filter`。`[].map`如何获得通配符表达式？

```
var jux = (function(){
    'use strict';

    function wildExp(obj){
        var keysCrude = Object.keys(obj),
            keysA = ('a["' + keysCrude.join('"], a["') + '"]').split(', '),
            keysB = ('b["' + keysCrude.join('"], b["') + '"]').split(', '),
            keys = [].concat(keysA, keysB)
                .sort(function(a, b){  return a.substring(1, a.length) > b.substring(1, b.length); });
        var exp = keys.join('').split(']b').join('] > b').split(']a').join('] || a');
        return exp;
    }

    return {
        sort: wildExp
    };

})();

var sortKeys = {
    k: 'v',
    key: 'val',
    n: 'p',
    name: 'param'
};
var objArray = [
    {
        k: 'z',
        key: 'g',
        n: 'a',
        name: 'b'
    },
    {
        k: 'y',
        key: 'h',
        n: 'b',
        name: 't'
    },
    {
        k: 'x',
        key: 'o',
        n: 'a',
        name: 'c'
    }
];
var exp = jux.sort(sortKeys);

console.log('@juxSort Expression:', exp);
console.log('@juxSort:', objArray.sort(function(a, b){
    return eval(exp);
})); 
```

您还可以在每个对象的迭代中使用此函数来为每个对象中的所有键创建更好的集体表达式，然后以这种方式过滤您的数组。

这是我几乎完成的 API Juxtapose 的一个小片段，它做到了这一点，对象相等与豁免、对象统一和数组压缩。如果这些是您的项目需要或想要的东西，请发表评论，我会尽快使该库可访问。

希望这可以帮助！快乐编码:)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-04-16T13:35:53.827

最直接和易读的方法是使用原生 javascript 过滤器方法。

本机 JavaScript 过滤器采用声明式方法过滤数组元素。由于它是在 Array.prototype 上定义的方法，因此它在提供的数组上进行迭代并在其上调用回调。这个回调函数，作为我们的过滤函数，接受三个参数：

`element`— 被迭代的数组中的当前项

`index`— 被迭代的数组中当前元素的索引或位置

`array`— 应用过滤器方法的原始数组让我们在一个例子中使用这个过滤器方法。请注意，过滤器可以应用于任何类型的数组。在此示例中，我们将根据对象属性过滤对象数组。

根据对象属性过滤对象数组的示例如下所示：

```
// Please do not hate me for bashing on pizza and burgers.
// and FYI, I totally made up the healthMetric param :)
let foods = [
  { type: "pizza", healthMetric: 25 },
  { type: "burger", healthMetric: 10 },
  { type: "salad", healthMetric: 60 },
  { type: "apple", healthMetric: 82 }
];
let isHealthy = food => food.healthMetric >= 50;

const result = foods.filter(isHealthy);

console.log(result.map(food => food.type));
// Result: ['salad', 'apple'] 
```

要了解有关在函数中过滤数组并构建自己的过滤的更多信息，请查看这篇文章： [https ://medium.com/better-programming/build-your-own-filter-e88ba0dcbfae](https://medium.com/better-programming/build-your-own-filter-e88ba0dcbfae)

# django - django-registration 密码重置自定义模板未加载

> ID：13594791
> 
> 赞同：9
> 
> 时间：2012-11-27T23:02:37.080
> 
> 标签：django, django-registration

我正在使用 django-registration 注册用户，但是当我想使用自己的模板进行密码重置时，我得到的是管理员模板，而不是我创建的模板。我的模板位于 myapp/templates/registration/password_reset_form.html 中，并且我的模板加载器已正确设置：

```
TEMPLATE_LOADERS = (
    'django.template.loaders.filesystem.Loader',
    'django.template.loaders.app_directories.Loader',
    ) 
```

我会错过什么？

我正在使用 Django 1.4

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-28T01:23:17.420

会不会是在你`django.contrib.auth`之前出现的？这意味着 django 首先找到原始模板并使用这个模板。更多关于这个的文档：[https ://docs.djangoproject.com/en/dev/ref/templates/api/#loader-types](https://docs.djangoproject.com/en/dev/ref/templates/api/#loader-types)`myapp``INSTALLED_APPS`

# matlab - 在matlab中读取未格式化的fortran文件-精度是多少？

> ID：13594798
> 
> 赞同：1
> 
> 时间：2012-11-27T23:02:50.783
> 
> 标签：matlab, binary, precision, fortran90, read-write

我刚刚写了一个文件：

```
 real*8                         :: vol_cel
 real*8, dimension(256,256,256) :: dense

[... some operations]

open(unit=8,file=fname,form="unformatted")
write(8)dense(:,:,:)/vol_cell
close(8) 
```

我在 Matlab 中阅读的代码：

```
fid = fopen(fname,'r');
mesh_raw = fread(fid,256*256*256,'double');
fclose(fid); 
```

最小值和最大值清楚地表明它没有正确读取（最小值为 0，最大值为较大的正实数 *8）。

```
min =
   3.3622e+38
max =
  -3.3661e+38 
```

我需要在 Matlab 中设置什么精度才能使其在未格式化的 Fortran 文件中读取？

一个有点相关的问题：我正在使用的这个 Matlab 代码可以读取二进制文件，但不能读取未格式化的文件。虽然我正在使用 gfortran 在我的 Mac OSX 上生成这些新数据。它不识别 form="binary" 所以我不能那样做。我需要添加一些库还是这是一个字节序问题？

===== 进展 =====

好的进展。而不是我的 ndim*ndim*ndim 矩阵，我只是这样写出 x 值（列向量）：

```
open(unit=8,file=fnamex,form="unformatted")
write(8)x0
close(8) 
```

然后Matlab读取：

```
fid =    fopen(nfilename,'r');
hr3=fread(fid, 1, 'int32');
x0 = fread(fid,Ntot,'float32');
hr4=fread(fid, 1, 'int32');
fclose(fid); 
```

那行得通。然后我尝试了原始的 ndim**3 矩阵，我尝试阅读：

```
fid =    fopen(nfilename,'r');
hr3=fread(fid, 1, 'int32');
mesh_raw = fread(fid,ndim*ndim*ndim,'float32');
hr4=fread(fid, 1, 'int32');
fclose(fid); 
```

但这给了我垃圾。也许在这里：

```
real*4,     dimension(:),   allocatable    :: x0
real*8,     dimension(256,256,256)         :: dense 
```

我是否需要更改：mesh_raw = fread(fid,ndim*ndim*ndim,'float32'); 确保它读取的是真实的* 8？那会是什么？当然只是逐字使用'real * 8'应该有效吗？我的意思是 x 矢量作品的“真实* 4”。我的意思是它读作“密集”，但最小值/最大值/平均值是错误的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:02:09.350

这很可能是一个字节序问题，因为粗略的有序猜测对我来说是一个更合理的数字。我不确定解决方案是什么，所以我将为您提供 3 个可能的解决方案，其中一个应该可以解决问题。这取决于您的源文件。

诀窍是将`fopen`语句更改为以下之一：

```
fid = fopen(fname,'rn');  %Native format (Default usually)
fid = fopen(fname,'rl');  %Little Endian
fid = fopen(fname,'rb');  %Big Endian 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T01:09:59.423

您的 Fortran 代码向您展示了如何编写所谓的无格式顺序文件。这是一种基于记录的文件格式。典型的实现（Fortran 编译器/平台特定）是编译器将附加记录结构信息写入文件 - 通常（包括 gfortran）记录长度写在每个记录的开头和结尾。您的原始 Matlab 代码似乎没有考虑到这一点。

Fortran 2003 引入了流访问（将说明`ACCESS='STREAM'`符添加到 OPEN 语句）。gfortran 支持此功能， FORM='BINARY' 在某些编译器上是非标准同义词。使用流访问创建的未格式化文件没有记录结构 - 它是类似于 C 流的字节流。这可能更适合您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-28T16:34:11.383

```
fid =    fopen(nfilename,'r');
hr3=fread(fid, 1, 'int32');
mesh_raw = fread(fid,ndim*ndim*ndim,'float32');
hr4=fread(fid, 1, 'int32');
fclose(fid); 
```

这是正确的，除了因为你在 fortran 中编写 real*8，你需要有

```
mesh_raw = fread(fid,ndim*ndim*ndim,'double'); 
```

# java - java.util.Date.toString() 打印出错误的格式

> ID：13594801
> 
> 赞同：1
> 
> 时间：2012-11-27T23:03:01.860
> 
> 标签：java, date, tostring

以下代码打印出“vmtDataOrig.creationdate=2012-11-03”

```
VmtData vmtDataOrig = VmtDataDao.getInstance().loadVmt(1);
System.out.println("vmtDataOrig.creationdate=" + vmtDataOrig.getCreationDate().toString()); 
```

下面是 VmtData 类中的 creationDate 字段的定义：

```
private Date creationDate = null; 
```

这是creationDate字段到数据库表列的休眠映射：

```
<property name="creationDate" column="CREATIONDATE" type="date"/> 
```

MySQL 数据库表中的 CREATIONDATE 列的类型为“date”，对于检索到的记录，它的值为“2012-11-03”。

java.util.Date.toString() 方法的 Javadoc 说它应该以“dow mon dd hh:mm:ss zzz yyyy”的形式打印 Date 对象。任何人都知道为什么它以“yyyy-MM-dd”的形式打印出来？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T23:14:21.453

即使该字段是 type `java.util.Date`，Hibernate 很可能仍然使用 a*填充*它`java.sql.Date`，它是子类`java.util.Date`和覆盖`toString()`...例如：

```
public class Test {
    public static void main(String[] args) throws Exception {
        java.util.Date date = new java.sql.Date(0);
        System.out.println(date); // 1970-01-01
    }
} 
```

但是很容易检查：

```
System.out.println(vmtDataOrig.getCreationDate().getClass()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:18:12.163

您的休眠类型是日期，因此使用 java.sql.Date（它是 java.util.date 的子类）。如果将休眠类型更改为 java.sql.Timestamp，它将使用其 toString() 实现。

# foursquare - 为什么 Foursquare hereNow 端点不返回项目？

> ID：13594806
> 
> 赞同：1
> 
> 时间：2012-11-27T23:03:26.857
> 
> 标签：foursquare

我的应用程序使用 hereNow api。我正确地（即实际存在于该位置）签入到一个场所，然后 var_dump 调用 hereNow 端点的请求响应，因此它返回“count”但“items”为空，如下所示。

字符串 '{"meta":{"code":200},"notifications":[{"type":"notificationTray","item":{"unreadCount":1}}],"response":{"hereNow ":{"count":1,"items":[]}}}' (长度=138)

我使用foursquare explorer尝试了同样的事情，但得到了类似的结果。您能否解释一下为什么会这样以及“未读计数”背后的想法是什么。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:23:47.023

a) 确保您用于发出 hereNow 请求的 OAuth 令牌是针对签到的同一用户。您必须代表已签到某个地点的用户行事，以查看谁“现在在这里”

b) 有可能您的签到被识别为作弊，因为您最近签到太频繁，或者您的设备提供的经纬度坐标不够准确。

# r - 如何组合 2 个变量并忽略 NA

> ID：13594811
> 
> 赞同：2
> 
> 时间：2012-11-27T23:04:13.923
> 
> 标签：r

我有一些像这样的数据

```
var1   var2
10     NA
101    NA
NA     86
11     NA
NA     11
NA     61 
```

如果一个变量是 NA 则另一个不是，反之亦然。

如何将它们组合成一个变量：

```
var3
10
101
86
11
11
61 
```

我可以通过循环轻松完成，但速度很慢，所以我想找到一种更简单的方法。我想过将 0 分配给 NA 的值，然后将变量加在一起......有更好的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T23:06:55.477

存在各种方法。这是一种方法：

```
var3 <- ifelse(!is.na(var1),var1,var2) 
```

它正在处理您的示例：

```
 var1 <- c(10,101,NA,11,NA,NA)
  var2 <- c(NA,NA,86,NA,11,61)

  var3 <- ifelse(!is.na(var1),var1,var2)

 > var3
 [1]  10 101  86  11  11  61 
```

此方法相对通用 - 它适用于非数字数据，例如：

```
 var1 <- c("AB","WZ",NA,"MN",NA,NA)
  var2 <- c(NA,NA,"QT",NA,"MN","RS")

  var3 <- ifelse(!is.na(var1),var1,var2)

 > var3
 [1] "AB" "WZ" "QT" "MN" "MN" "RS" 
```

在这种情况下，替换和添加的建议`NA`不起作用`0`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-27T23:09:00.653

`rowSums`with`na.rm = TRUE`会这样做。（这真的是你建议的解决方案......）

假设您的数据在 a`data.frame` `DF`和您的评论中

> 如果一个变量是 NA 则另一个不是，反之亦然。

是真的。

```
 DF$var3 <- rowSums(DF[, c('var1','var2')], na.rm = TRUE) 
```

# r - facet_wrap 和缩放点大小

> ID：13594814
> 
> 赞同：3
> 
> 时间：2012-11-27T23:04:24.593
> 
> 标签：r, ggplot2, facet-wrap

**简而言之：** 我想为使用`facet_wrap`. 当我想要不同的轴比例时，使用`facet_wrap(scales="free")`效果很好，但不适用于点的大小。

**背景：** 我有几个样本的数据，每个样本都有三个测量值：*x*、*y*和*z*。每个样本来自第 1 类或第 2 类*。x*和*y*在每个类中具有相同的分布。但是，第 1 类的所有*z*测量值均小于 1.0；*2 类的z*测量范围为 0 到 100。

**我被困在哪里：**分别在 x 和 y 轴上 绘制*x*和*y 。*使每个点的面积与其*z*值成比例。

```
d = matrix(c(runif(100),runif(20)*100),ncol=3)
e = data.frame( gl(2,20), d )
colnames(e) = c("class","x","y","z")
ggplot( data = e, aes(x=x, y=y, size=z) ) + 
  geom_point() + scale_area() +
  facet_wrap( ~ class, ncol=1, scales="free" ) 
```

![在此处输入图像描述](../Images/53615fa5d1ff2f0cb4a957659ba11c6e.png)

**问题：** 请注意，第一个面板上的点很难看到，因为它们位于用于单个图例的刻度的非常低端，范围从 0 到 100。甚至可能有两个单独的图例（每个图例都有一个不同的范围）还是我应该制作两个图并将它们与视口结合起来？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T23:19:53.857

使用`grid.arrange`. 我已经在电话中离开了，`facet_wrap`所以`strip.text`剩下的。您可以轻松删除它。

```
# plot for class 1
c1 <- ggplot(e[e$class==1,], aes(x=x,y=y,size=z)) + geom_point() + scale_area() + facet_wrap(~class)
# plot for class 2
c2 <- c1 %+% e[e$class==2,]

library(gridExtra)

grid.arrange(c1,c2, ncol=1) 
```

![在此处输入图像描述](../Images/a8780e0d95feb43aec93ae51cfb5b403.png)

# git - Yeoman 安装和协作（例如通过 git）

> ID：13594815
> 
> 赞同：3
> 
> 时间：2012-11-27T23:04:31.093
> 
> 标签：git, dependencies, collaboration, yeoman, bower

我正在使用 yeoman 开始我的第一个严肃项目，但遇到了一个我无法从文档中弄清楚的问题。

我的新 webapp 使用 bootstrap-js 和 lodash 作为基础 javascript，所以我`yeoman install ...`为这两个库做了。这似乎已将两个库（加上 jquery）的整个 github 存储库克隆到两个`components`目录，一个在应用程序的根目录，一个在`app`目录中。

现在，我想将它提交到我的 git 存储库。显然，将依赖库的整个存储库放在我的存储库中是没有意义的。在最坏的情况下，我可以只放置组件目录中的 min.js 文件。但我想最好的办法是添加一个列出依赖项的文件，然后让其他编码人员使用 yeoman 在他们的机器上安装依赖项。

有没有办法做到这一点？似乎有一个`package.json`可能是放置它的地方，但是格式是什么？文档提到`components.json`了 Bower，但也不清楚如何使用它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T02:36:06.327

目前你最好的选择是创建一个包含依赖项的[component.json](https://github.com/twitter/bower#defining-a-package)文件，然后 gitignore 组件文件夹，或者你可以只包含组件文件夹。

我们正在努力获取[.bowerignore](https://github.com/twitter/bower/issues/88)类型的文件，以便组件只包含实际需要的内容。

*对于双组件文件夹问题，请参阅[为什么 bower 安装包两次？](https://stackoverflow.com/a/13676313/64949)*

# asp.net-mvc - 在 asp.net 和 ravendb 中处理基于活动的提要的最佳方法

> ID：13594816
> 
> 赞同：4
> 
> 时间：2012-11-27T23:04:30.893
> 
> 标签：asp.net-mvc, database, ravendb

我将为每个用户提供一个活动提要，其中显示与用户订阅的事件相关的所有活动，并且提要将引入最新的 20 个左右的活动。我设置它的方式是所有活动，无论其相关的事件是否存储在一个集合中，并且文档本身具有我查询和索引的“事件”属性。基本查询只是从集合中选择活动，其中事件在按日期排序的用户事件订阅列表中。我存储用户事件订阅列表的哈希，并使用哈希作为键缓存查询结果 xx 秒，因此如果另一个用户订阅了相同的确切事件，我可以从缓存中提取结果，我是不关心结果过时 xx 秒。

编辑：添加模型和查询示例

楷模：

```
User
{
    // useless properties excluded
    // fixed: hashset not list, can be quite large
    HashSet<string> Subscriptions { get; set; }
    string SubscriptionHash { get; set; } // precomputed hash of all strings in subscriptions
}

Activity
{
    // Useless properties excluded
    string ActivityType { get; set; }
} 
```

询问：

```
if (cache[user.SubscriptionHash] != null)
    results = (HashSet<Activity>)cache[user.SubscriptionHash];
else
    results = session.Query<Activity>().Where(user.Subscriptions.Contains(e => e.ActivityType)).Take(20).ToList();

// add results to cache 
```

我担心这是否是处理此问题的最佳方法，或者是否有更好的 ravendb voodoo 可供使用。如果有很多活动，单个集合可能会增长到数百万，并且当有成千上万的用户拥有无限的订阅列表组合时，我可能会在缓存中存储数千个键。这些提要在用户登陆页面上，所以它受到了很多打击，我不想只是在这个问题上投入更多的硬件。

因此，我真正想要的答案是，这是否是最好的查询，或者当我可以使用 list.Contains 查询数百万个文档时，是否有更好的方法在 Raven 中执行此操作。

这是一个使用 ravendb 的 asp.net 4.5 mvc 4 项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:14:38.500

现在这是我将如何处理它。这是基于 RaccoonBlog PostComments

我会将每个用户的事件存储在一个单独的文档中（即下面示例中的 UserEvent），用户拥有一个链接到它的附加属性以及许多事件和与用户关联的最后一个事件的时间戳。这将使用户文档更小，但有很多重要信息

在 UserEvent 中，它将是一个包含 id 的简单文档、指向此文档引用的用户 ID 的链接、一个“事件”集合和一个 lasteventid。这样，如果需要，每个“事件”都会成为维护的子文档。

最后是 UserEvent 上的索引，可让您轻松查询数据

```
public class User
{
    public string Id { get; set; }
    // other user properties

    public string UserEventId { get; set; }
    public int NumberOfEvents { get; set; }
    public DateTimeOffset LastEvent { get; set; }
}

public class UserEvent
{
    public string Id { get; set; }

    public string UserId { get; set; }

    public int LastEventId { get; set; }

    public ICollection<Event> Events { get; protected set; }

    public int GenerateEventId()
    {
        return ++LastEventId;
    }

    public class Event
    {
        public int Id { get; set; }
        public DateTimeOffset CreatedAt { get; set; }
        public string ActivityType { get; set; }
        // other event properties
    }
}

public class UserEvents_CreationDate : AbstractIndexCreationTask<UserEvent, UserEvents_CreationDate.ReduceResult>
{
    public UserEvents_CreationDate()
    {
        Map = userEvents => from userEvent in userEvents
                            from evt in userEvent.Events
                            select new
                            {
                                evt.CreatedAt,
                                EventId = evt.Id,
                                UserEventId = userEvent.Id,
                                userEvent.UserId,
                                evt.ActivityType
                            };
        Store(x => x.CreatedAt, FieldStorage.Yes);
        Store(x => x.EventId, FieldStorage.Yes);
        Store(x => x.UserEventId, FieldStorage.Yes);
        Store(x => x.UserId, FieldStorage.Yes);
        Store(x => x.ActivityType, FieldStorage.Yes);
    }

    public class ReduceResult
    {
        public DateTimeOffset CreatedAt { get; set; }
        public int EventId { get; set; }
        public string UserEventId { get; set; }
        public string UserId { get; set; }
        public string ActivityType { get; set; }
    }
}

public static class Helpers
{
    public static DateTimeOffset AsMinutes(this DateTimeOffset self)
    {
        return new DateTimeOffset(self.Year, self.Month, self.Day, self.Hour, self.Minute, 0, 0, self.Offset);
    }

    public static IList<Tuple<UserEvents_CreationDate.ReduceResult, User>> QueryForRecentEvents(
        this IDocumentSession documentSession,
        Func
            <IRavenQueryable<UserEvents_CreationDate.ReduceResult>, IQueryable<UserEvents_CreationDate.ReduceResult>
            > processQuery)
    {
        IRavenQueryable<UserEvents_CreationDate.ReduceResult> query = documentSession
            .Query<UserEvents_CreationDate.ReduceResult, UserEvents_CreationDate>()
            .Include(comment => comment.UserEventId)
            .Include(comment => comment.UserId)
            .OrderByDescending(x => x.CreatedAt)
            .Where(x => x.CreatedAt < DateTimeOffset.Now.AsMinutes())
            .AsProjection<UserEvents_CreationDate.ReduceResult>();

        List<UserEvents_CreationDate.ReduceResult> list = processQuery(query).ToList();

        return (from identifier in list
                let user = documentSession.Load<User>(identifier.UserId)
                select Tuple.Create(identifier, user))
            .ToList();
    }
} 
```

那么你所要做的就是查询类似的东西。

```
 documentSession.QueryForRecentEvents(q => q.Where(x => x.UserId == user.Id &&  x.ActivityType == "asfd").Take(20)).Select(x => x.Item1); 
```

# c++ - 严重找不到我的“人生游戏”程序中的错误

> ID：13594820
> 
> 赞同：0
> 
> 时间：2012-11-27T23:04:47.953
> 
> 标签：c++, arrays, grid

好的，不久前我被分配了一个实验室，我们应该在其中制作一个非常简化版的康威人生游戏。

规则：贪婪的史莱姆（由 R 表示）会吃掉任何与其相邻（正上方、下方或旁边）的慢速史莱姆（由 S 表示）。一旦贪婪的史莱姆“吃掉”了缓慢的史莱姆，就会出现一个新的时间步，其中 4 个新的缓慢史莱姆随机放置在板上。我必须代表 4 个时间步长。

不幸的是，我的代码不能正常工作。无论出于何种原因，我的四个慢史莱姆都不会在每个时间步之后生成。我已经为代码苦苦挣扎，但我无法资助这个错误。请帮忙。

代码：

```
#include "stdafx.h"
#include <cstdlib>
#include <ctime>
#include <iostream>
using namespace std;

//Struct
struct Creatures
{
    public: int type;
    public: int age;
    public: double weight;
    private: double length;

};

//Prototypes
void printLake(Creatures Sludge[10][10]);
void fourNew(Creatures Sludge [10][10], Creatures slowSlime);
void dispatch(Creatures Sludge[10][10], Creatures water);

int main()
{
    //creating the slimes, the water, and the grid (called sludge)
    Creatures Sludge[10][10];
    Creatures slowSlime;
    slowSlime.type = 1;
    Creatures ravenousSlime;
    ravenousSlime.type = 2;
    Creatures water;
    water.type = 3;

    //Initialize Lake
    for (int row = 0; row<10; row++)
    {
        for (int col = 0; col<10; col++)
        {
            Sludge[row][col] = water;
        }
    }

    //Random Distribution of Slow Slimes
    srand(time(0));
    int high = 10;               
    int low = 0;                     
    int i = 0;
    while(i<15)
    {
        int row = rand()% (high - low + 1) + low;
        int col = rand()% (high - low + 1) + low;
        if (Sludge[row][col].type == 3)
        {
            Sludge[row][col] = slowSlime;
            i++;
        }
    }

    //Random Distribution of Ravenouse Slimes
    int c = 0;
    while (c<5)
    {
        int row = rand()% (high - low + 1) + low;
        int col = rand()% (high - low + 1) + low;
        if (Sludge[row][col].type ==3)
        {
            Sludge[row][col] = ravenousSlime;
            c++;
        }
    }

    //Time steps
    cout<<"Step 1"<<endl;
    printLake(Sludge);
    dispatch(Sludge, water);
    fourNew(Sludge, water);
    cout<<endl;
    cout<<"Step 2"<<endl;
    printLake(Sludge);
    dispatch(Sludge, water);
    cout<<endl;
    fourNew(Sludge, water);
    cout<<"Step 3"<<endl;
    printLake(Sludge);
    dispatch(Sludge, water);
    cout<<endl;
    fourNew(Sludge, water);
    cout<<"Step 4"<<endl;
    printLake(Sludge);
    dispatch(Sludge, water);
    fourNew(Sludge, water);
    cout<<endl;
    int j;
    cin>>j;
    return 0;
}

void printLake(Creatures Sludge[10][10])
{
    for (int row = 0; row<10; row++)
    {
        for (int col = 0; col<10; col++)
        {
            if (Sludge[row][col].type == 1)
            {
                cout<<"S ";
            }
            if (Sludge[row][col].type == 2)
            {
                cout<<"R ";
            }
            if (Sludge[row][col].type == 3)
            {
                cout<<"_ ";
            }
        }
        cout<<endl;
    }
}

void fourNew(Creatures Sludge [10][10], Creatures slowSlime)
{
    srand(time(0));
    int high = 10;               
    int low = 0;                     
    int i = 0;
    while(i<4)
    {
        int row = rand()% (high - low + 1) + low;
        int col = rand()% (high - low + 1) + low;
        if (Sludge[row][col].type == 3)
        {
            Sludge[row][col] = slowSlime;
            i++;
        }
    }
}

void dispatch(Creatures Sludge[10][10], Creatures water)
{
  for (int row = 0; row<10; row++)
  {
        for(int col = 0; col<10; col++)
        {
              if(Sludge[row][col].type == 2)
              {
                    if(Sludge[row][col-1].type == 1)
                    {
                          Sludge[row][col-1] = water;
                    }
                    if(Sludge[row][col+1].type == 1)
                    {
                          Sludge[row][col+1] = water;
                    }
                    if(Sludge[row-1][col].type == 1)
                    {
                          Sludge[row-1][col] = water;
                    }
                    if(Sludge[row+1][col].type == 1)
                    {
                          Sludge[row+1][col] = water;
                    }
              }
        }
  }
} 
```

输出： ![](../Images/f76c45f6e9d52a53dbda0ee507f358d7.png)

更新的输出： ![在此处输入图像描述](../Images/361cacd15fff32c23cda633e1a96bc2c.png) ![在此处输入图像描述](../Images/26dbc2030d2d35ef29b77adb3d66f1b4.png)

我在第 4 步看到了几个新的慢史莱姆，但在第 2 步没有看到...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T23:12:50.247

快速浏览后，我会说问题出在这里：

```
fourNew(Sludge, water); 
```

你想要的可能是：

```
fourNew(Sludge, slowSlime); 
```

详细说明：你的功能

```
void fourNew(Creatures Sludge [10][10], Creatures slowSlime) 
```

接受两个参数，称为 Sludge 和 slowSlime。这是一个不幸的名称选择，因为在内部编译器不使用这些名称来生成代码。它们完全是为了您的方便。您可能希望编译器自动检查是否将正确的参数传递给函数，但 C++ 没有允许这样做的工具 - 不检查变量名，只检查类型。

函数参数充当局部变量。当您在 main 中传递值时：

```
fourNew(Sludge, water) 
```

会发生什么：

fourNew() 中的 Sludge 等于 main() 中的 Sludge

fourNew() 中的 slowSlime 变得等于 main() 中的水

所以实际上你要求创建四个水对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T23:16:31.603

有几个问题。

* * *

调用`srand()`一次，而且*只*调用一次。多次调用它会重置随机种子。使用相同的值调用它会使`rand()`调用重复。如果`time(0)`结果相同（因为您的程序可能执行得非常快），那么当您尝试创建时`fourNew()`，它会重复相同的点并且不会很随机。

* * *

在您的`dispatch()`功能中，如果`Sludge[0][0]`有`type == 2`怎么办？`Sludge[row][col-1]`将超出范围，也会`Sludge[row-1][col]`！你需要确保你的范围是正确的。`row+1`执行/时，最后一行/列也会溢出`column+1`。

* * *

AndreyT 提到了一件好事，但这些其他问题也需要考虑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T23:09:00.930

**这不适用于您的问题，因为游戏规则非常简单，可以在单个板上实现。**但以防万一，如果您将来必须更改规则：

我的程序是这样的，电路板的每个新状态通常都是从电路板的先前状态计算出来的。重要的是要观察到，当您分析*当前*的板状态并生成*未来*的板状态时，*您对未来的板状态所做的修改在当前的板状态中（还）不应该是可见的*。

换句话说，要在这样的游戏中正常运行，您必须维护*两个*板：当前板和未来板。您通过将当前板复制到未来板开始每个时间步。然后你分析*当前*的板并修改*未来*的板。完成后，未来的棋盘将成为当前棋盘，并重复循环。

# python - 如何将 Heroku 上的不同软件包要求到本地盒子？

> ID：13594826
> 
> 赞同：1
> 
> 时间：2012-11-27T23:05:08.160
> 
> 标签：python, heroku, pip, requirements.txt

我正在编写一个 Python Flask 应用程序以[部署在 Heroku 上](http://blog.y3xz.com/blog/2012/08/16/flask-and-postgresql-on-heroku/)。它将使用数据库。对于本地开发，我想使用 Sqlite，但是当部署到 Heroku 时，我想使用 Postgresql。我怎样才能做到这一点？

我被卡住了，因为我不知道如何在我的盒子和 Heroku 服务器之间需要一组不同的包。

* * *

如果这是一个 Ruby 应用程序，我会在我的`Gemfile`

```
gem "pg", :group => :production
gem "sqlite3", :group => :development 
```

然后 Bundler 将在开发和生产中安装适当的包。但我不知道[Python 的 pip有任何类似的工作流程](https://devcenter.heroku.com/articles/python-pip)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T07:07:53.107

好吧，你有两件事要解决。

首先，`requirements.txt`这不是什么大问题。您可以将所有要求放在同一个`requirements.txt`文件中，同时安装两个数据库绑定不会造成任何损害。但是，如果您想分离，只需`requirements.txt`用于部署和`requirements-dev.txt`本地开发。

更重要的是数据库设置本身，为此您有一个单一的解决方案：

```
app.config['SQLALCHEMY_DATABASE_URI'] = os.environ.get(
    'DATABASE_URL', 'sqlite:////tmp/test.db') 
```

因为`DATABASE_URL`是在 Heroku 上设置的，但不是在本地设置的（确保是这种情况），`os.environ.get`所以找不到它，因此恢复为默认值，即 sqlite 连接字符串。

# excel - 如果单元格包含文本片段，则行的 Excel 2010 VBA 宏条件格式

> ID：13594827
> 
> 赞同：3
> 
> 时间：2012-11-27T23:05:15.177
> 
> 标签：excel, vba, conditional

我正在宏中进行条件格式设置（因为我不断地将它与其他格式一起重复应用到新的原始导出中）。

目标：突出显示单元格 J(n) 中的文本为“无活动”的任何行

目前使用：

```
 With Cells
.FormatConditions.Add Type:=xlExpression, Formula1:= _
    "=($J1=""No Activity"")"
    With .FormatConditions(.FormatConditions.Count)
        .SetFirstPriority
        With .Interior
            .PatternColorIndex = xlAutomatic
            .Color = 7405514
            .TintAndShade = 0
        End With
        StopIfTrue = False
    End With
End With 
```

...效果很好。以上内容是使用谷歌搜索和最初给我的录音清理的：

```
 Cells.Select
Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
    "=($N1=""No Activity"")"
Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
With Selection.FormatConditions(1).Interior
    .PatternColorIndex = xlAutomatic
    .ThemeColor = xlThemeColorAccent4
    .TintAndShade = 0.599963377788629
End With
Selection.FormatConditions(1).StopIfTrue = False 
```

所以我感到非常自豪和成就......**但**我也想突出显示行（以不同的颜色），其中 J 列（如上）中的单元格在单元格文本的任何位置*包含*“引用”。

当我录制一个将其作为条件格式的宏时，它并没有真正为我澄清任何事情：（好吧，它让情况变得更糟）

```
 Selection.FormatConditions.Add Type:=xlTextString, String:="Quote", _
    TextOperator:=xlContains
Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
With Selection.FormatConditions(1).Interior
    .PatternColorIndex = xlAutomatic
    .ThemeColor = xlThemeColorAccent1
    .TintAndShade = 0.399945066682943
End With
Selection.FormatConditions(1).StopIfTrue = False 
```

我只是不明白它应该如何改变

```
Type:=xlExpression, Formula1:= _
"=($J1=""No Activity"")" 
```

非常感谢所有想法！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T23:53:34.063

这适用于 Excel 2010：

```
With Cells
    .FormatConditions.Add Type:=xlExpression, Formula1:= _
      "=($J1=""No Activity"")"
    With .FormatConditions(.FormatConditions.Count)
        .SetFirstPriority
        With .Interior
            .PatternColorIndex = xlAutomatic
            .Color = 7405514
            .TintAndShade = 0
        End With
        StopIfTrue = False
    End With

    .FormatConditions.Add Type:=xlExpression, Formula1:= _
      "=ISNUMBER(SEARCH(""*quote*"",$J1))"
    With .FormatConditions(.FormatConditions.Count)
        .SetFirstPriority
        With .Interior
            .PatternColorIndex = xlAutomatic
            .Color = 4405514
            .TintAndShade = 0
        End With
        StopIfTrue = False
    End With
End With 
```

显然，您需要更改第二`FormatConditions.Add`部分的颜色。

**编辑：**意识到您正在单元格中的任何位置寻找“报价”，因此我更新了原始帖子中的代码。

# objective-c - xcode ios：在标签上的单元格图像重叠

> ID：13594830
> 
> 赞同：1
> 
> 时间：2012-11-27T23:05:29.080
> 
> 标签：objective-c, ios, xcode

我在表格中的单元格上显示图像。我有里面的代码

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

当我使用故事板时，所以我在单元格中显示了图像

```
cell.imageView.image = [UIImage imageNamed:_lotImagesArray[row]]; 
```

但是，当我尝试从网络服务器加载图像时，图像位于单元格中的标签顶部（阻止标签文本）

我用来从网络服务器显示图像的代码是这样的：

```
NSString *strURL = [NSString stringWithFormat:@"http://www.domainhere.com/images/%@", lotPhoto[row]];
NSURL *url = [[NSURL alloc] initWithString:strURL ];
cell.imageView.image = [UIImage imageWithData:[NSData dataWithContentsOfURL:url]]; 
```

有人可以建议我哪里出错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:06:08.500

几种可能的可能性：

**首先**，您可能需要仔细检查以确保您有

```
cell.imageView.clipsToBounds = YES; 
```

如果你不这样做，当它调整图像大小以适合 时`UIImageView`，图像可能会溢出图像视图的边界。我注意到这个问题，特别是当我在后台队列中加载这个图像时。

**其次**，如果您在后台设置`imageView`属性`UITableViewCell`（如下面的简化示例代码），您应该知道在开始背景图像加载过程之前使用空白图像正确初始化图像很重要。因此，从基于 Web 的源加载单元格时非常常见的代码示例如下：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    cell.textLabel.text = ... // you configure your cell however you want

    // make sure you do this next line to configure the image view

    cell.imageView.image = [UIImage imageNamed:@"blankthumbnail.png"];

    // now let's go to the web to get the image

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,0), ^{

        UIImage *image = ... // do the time consuming process to download the image

        // if we successfully got an image, remember, ALWAYS update the UI in the main queue
        dispatch_async(dispatch_get_main_queue(), ^{
            // let's make sure the cell is still visible (i.e. hasn't scrolled off the screen)
            UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
            if (cell)
            {
                cell.imageView.image = image;
                cell.imageView.contentMode = UIViewContentModeScaleAspectFill;
                cell.imageView.clipsToBounds = YES;
            }
        });
    });

    return cell;
} 
```

显然，如果您执行类似的操作，您需要确保`[UIImage imageNamed:@"blankthumbnail.png"];`没有返回`nil`（即确保您的应用程序成功地在包中找到它）。常见问题可能包括根本没有空白图像、名称错误、未能将图像包含在目标设置中、“构建阶段”选项卡下、“复制捆绑资源”下。

**第三**，您需要确保在使用子类`UITableViewCell`条目时，不要使用 , 等的标准属性`UITableViewCell`名称。确保使用您自己的唯一名称。如果你使用，系统会混淆你的新属性和默认属性。`imageView``textLabel``imageView``IBOutlet``imageView``UITableViewCell`

# c# - BinaryFormatter - 是否可以在没有程序集的情况下反序列化已知类？

> ID：13594831
> 
> 赞同：2
> 
> 时间：2012-11-27T23:05:47.330
> 
> 标签：c#, deserialization, binaryformatter

我目前正在尝试与在第一次使用 C# 的 BinaryFormatter 对其进行格式化后通过网络发送数据的程序进行互操作。这是一个愚蠢的想法，我讨厌它，但我必须与之互操作。

我知道类型是什么样子，我知道它的确切布局。但是由于各种原因，我无法在我的程序中添加对该特定程序集的引用。

鉴于 BinaryFormatter 与特定类型/版本的紧密耦合程度，尽管知道数据结构，我似乎无法找到一种方法让它反序列化。

我目前正在考虑创建一个具有所有正确属性的假程序集并尝试将其链接（似乎真的很混乱），或者手动尝试通过二进制流并提取我正在寻找的值（我是查看有关此的MS文档，布局一目了然）。

任何其他伟大的想法，或者过去有没有人在这方面取得成功？似乎我知道我需要的所有信息，而 BinaryFormatter 只是出了名的脆弱。

编辑：

要回答下面的问题（这是一个很好的观点，顺便说一句），有几个原因。

1.  项目清洁度。将 5MB 引用添加到一个功能的外部 .exe 有点不对劲。

2.  我正在与之互操作的设备在世界各地部署了各种版本。我关心的项目的内部数据结构在所有项目中都是相同的，但是程序集的版本不同，导致 BinaryFormatter 损坏。我可以将二进制流转换为字符串，搜索版本号然后加载正确的版本，但现在我有十几个 .exe 等待我加载正确的版本。那么这个方案就不是未来的证明（好吧，整个方案并不是真正的未来证明，但我至少想抽象出 BinaryFormatter 的一些脆弱性，以使我的工作更轻松）。仅仅写下这个回复就让我开始考虑使用 emit 或类似的方法来动态创建一个自定义程序集......但是伙计，必须有一个更简单的方法，对吧？我'

3.  对象的变量通过具有某些逻辑的 get/set 属性公开，并尝试进行函数调用并更新我身边可能不存在的其他对象（也就是 get 获取我需要的值，但也会触发通知通过链接的依赖关系波动，我可以得到异常冒泡到我的应用程序。谈论代码气味！）。它变成了一个依赖/实现的兔子洞。

编辑2：制造商正在与我合作以使他们的系统更好，但是当我们宣传“与 X 一起工作”时，我们希望它只与 X 一起工作，而不需要特定版本。特别是对于我们的一些严格版本控制的客户系统，仅更新有问题的应用程序就成为一项重大工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T11:42:25.627

正如您在对问题的评论中推测的那样 SerializationSurrogate 和 SerializationBinder 可以让您成为其中的一部分。鉴于您只对几个属性感兴趣，您可以反序列化为代理类，您可以通过枚举传递给您的 SerializationSurrogate 的 SerializationInfo 来填充该代理类。不幸的是，它只会让你走上一段路。

问题是访问属性不会触发序列化对象中的任何副作用，因为您仅使用 SerializationSurrogate 访问数据 - 没有执行任何二进制代码。下面的快速和肮脏的测试代码说明了这个问题：

```
namespace BinaryProxy
{
    using System;
    using System.Collections.Generic;
    using System.IO;

    using System.Runtime.Serialization;
    using System.Runtime.Serialization.Formatters.Binary;

    [Serializable]
    class TestClass
    {

        public bool mvalue;

        public TestClass(bool value)
        {
            BoolValue = value;
        }

        public bool BoolValue
        {
            get
            {
                // won't happen
                SideEffect = DateTime.Now.ToString();
                return mvalue;
            }

            set
            {
                mvalue = value;
            }
        }

        public string SideEffect { get; set; }

    }

    class ProxyTestClass
    {
        private Dictionary<string, object> data = new Dictionary<string, object>();

        public Object GetData(string name)
        {
            if(data.ContainsKey(name))
            {
                return data[name];
            }
            return null;
        }
        public void SetData(string name, object value)
        {
            data[name] = value;
        }

        public IEnumerable<KeyValuePair<string, object>> Dump()
        {
            return data;
        }
    }

    class SurrogateTestClassConstructor : ISerializationSurrogate
    {
        private ProxyTestClass mProxy;
        /// <summary>
        /// Populates the provided <see cref="T:System.Runtime.Serialization.SerializationInfo"/> with the data needed to serialize the object.
        /// </summary>
        /// <param name="obj">The object to serialize. </param>
        /// <param name="info">The <see cref="T:System.Runtime.Serialization.SerializationInfo"/> to populate with data. </param>
        /// <param name="context">The destination (see <see cref="T:System.Runtime.Serialization.StreamingContext"/>) for this serialization. </param>
        /// <exception cref="T:System.Security.SecurityException">The caller does not have the required permission. </exception>
        public void GetObjectData(object obj, SerializationInfo info, StreamingContext context)
        {
            throw new NotImplementedException();
        }

        /// <summary>
        /// Populates the object using the information in the <see cref="T:System.Runtime.Serialization.SerializationInfo"/>.
        /// </summary>
        /// <returns>
        /// The populated deserialized object.
        /// </returns>
        /// <param name="obj">The object to populate. </param>
        /// <param name="info">The information to populate the object. </param>
        /// <param name="context">The source from which the object is deserialized. </param>
        /// <param name="selector">The surrogate selector where the search for a compatible surrogate begins. </param>
        /// <exception cref="T:System.Security.SecurityException">The caller does not have the required permission. </exception>
        public object SetObjectData(object obj, SerializationInfo info, StreamingContext context, ISurrogateSelector selector)
        {
            if (mProxy == null) mProxy = new ProxyTestClass();
            var en = info.GetEnumerator();
            while (en.MoveNext())
            {
                mProxy.SetData(en.Current.Name, en.Current.Value);

            }
            return mProxy;

        }

    }

    sealed class DeserializeBinder : SerializationBinder
    {
        public override Type BindToType(string assemblyName, string typeName)
        {

            return typeof(ProxyTestClass);
        }
    }

    static class Program
    {

        static void Main()
        {
            var tc = new TestClass(true);
            byte[] serialized;
            using (var fs = new MemoryStream())
            {
                var formatter = new BinaryFormatter();
                formatter.Serialize(fs, tc);
                serialized = fs.ToArray();

                var surrSel = new SurrogateSelector();
                surrSel.AddSurrogate(typeof(ProxyTestClass),
                    new StreamingContext(StreamingContextStates.All), new SurrogateTestClassConstructor());

                using (var fs2 = new MemoryStream(serialized))
                {
                    var formatter2 = new BinaryFormatter();
                    formatter2.Binder = new DeserializeBinder();
                    formatter2.SurrogateSelector = surrSel;
                    var deser = formatter2.Deserialize(fs2) as ProxyTestClass;
                    foreach (var c in deser.Dump())
                    {
                        Console.WriteLine("{0} = {1}", c.Key, c.Value);
                    }
                }

            }

        }
    }
} 
```

在上面的示例中，`TestClass`'`SideEffect`支持字段将保持为空。

如果您不需要副作用并且只想访问某些字段的值，则该方法是可行的。否则，除了遵循 Jon Skeet 的建议之外，我想不出任何其他可行的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:12:47.890

*您是否*能够添加能够添加对该特定程序集的引用的额外层（或单独的服务） ？如果是这样，您可以使该小层反序列化二进制格式并将其重新格式化为更便携的东西（JSON、协议缓冲区、XML，任何合适的）。将其视为与疯狂的隔离层`BinaryFormatter`:)

# r - 如何在条形图中显示日期格式（Sep-12）并设置 y 轴限制？

> ID：13594836
> 
> 赞同：0
> 
> 时间：2012-11-27T23:06:06.683
> 
> 标签：r

我有两个关于使用 ggplot() 构建条形图的问题。

## 如何显示数据格式（Sep-12）？

我想以 Sep-12 的格式显示日期。我的数据是季度总结。我想展示 3 月、6 月、9 月和 12 月的季度。但是，我在 ggplot() 函数中使用了 as.Date(YearQuarter)。它显示了 4 月、7 月、10 月、1 月的不同顺序。

## 如何增加y轴限制？

y 轴设置为 70%，值标签之一超出图片。我添加了 ylim(0,1) 以将 y 限制增加到 1。但是，我丢失了百分比格式，因为 y 轴不再显示百分比。

```
x4.can.t.m <- structure(list(NR_CAT = structure(c(1L, 2L, 3L, 1L, 2L, 3L, 1L, 
2L, 3L, 1L, 2L, 3L, 1L, 2L, 3L, 1L, 2L, 3L, 1L, 2L, 3L, 1L, 2L, 
3L, 1L, 2L, 3L, 1L, 2L, 3L, 1L, 2L, 3L, 1L, 2L, 3L, 1L, 2L, 3L, 
1L, 2L, 3L, 1L, 2L, 3L), .Label = c("0%", "1 to 84%", "85% +"
), class = "factor"), TYPE = structure(c(1L, 1L, 1L, 2L, 2L, 
2L, 3L, 3L, 3L, 1L, 1L, 1L, 2L, 2L, 2L, 3L, 3L, 3L, 1L, 1L, 1L, 
2L, 2L, 2L, 3L, 3L, 3L, 1L, 1L, 1L, 2L, 2L, 2L, 3L, 3L, 3L, 1L, 
1L, 1L, 2L, 2L, 2L, 3L, 3L, 3L), .Label = c("PM BUSINESS", "PM CONSUMER", 
"PREPAY"), class = "factor"), YearQuarter = structure(c(1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 
4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L), .Label = c("2011-09-01", 
"2011-12-01", "2012-03-01", "2012-06-01", "2012-09-01"), class = "factor"), 
    value = c(0.5, 0, 0.5, 0.35, 0, 0.65, 0.28, 0.02, 0.7, 0.4, 
    0, 0.6, 0.38, 0, 0.62, 0.43, 0.01, 0.56, 0.57, 0, 0.43, 0.35, 
    0, 0.65, 0.39, 0.01, 0.6, 0.55, 0, 0.45, 0.4, 0.02, 0.58, 
    0.35, 0.02, 0.63, 0.35, 0, 0.65, 0.55, 0.01, 0.44, 0.47, 
    0, 0.53)), .Names = c("NR_CAT", "TYPE", "YearQuarter", "value"
), row.names = c(NA, -45L), class = "data.frame") 
```

这是我的情节代码：

```
x4.can.t.m$YearQuarter <- as.Date(x4.can.t.m$YearQuarter)
x4.can.t.d.bar <- ggplot(data=x4.can.t.m, aes(x=YearQuarter, y=value,fill=NR_CAT)) + 
                  geom_bar(stat="identity",position = "dodge",ymax=NR_CAT+0.2) +
              facet_wrap(~TYPE,ncol=1) +
                  geom_text(aes(label =paste(round(value*100,0),"%",sep="")), 
                             position=position_dodge(width=0.9), 
                             vjust=-0.25,size=3)  +
        scale_y_continuous(formatter='percent',ylim=1) +
            labs(y="Percentage",x="Year Quarter") +
            ylim(0,100%)

x4.can.t.d.bar +scale_fill_manual("Canopy Indicators",values=tourism.cols(c(6,9,8)))+
                opts(title="Canopy Indicator: All Customers portout for Network 
                            Issues",size=4) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:04:59.397

看起来你有一个旧版本的 ggplot；以下是 ggplot 0.2.9.1。我必须修复几件事情才能使你的情节顺利进行。从您的原始定义开始`x4.can.t.m`：

```
x4.can.t.m$YearQuarter <- format(as.Date(x4.can.t.m$YearQuarter),"%b-%y")

library("scales")
ggplot(data=x4.can.t.m, aes(x=YearQuarter, y=value, fill=NR_CAT)) + 
  geom_bar(stat="identity", position = "dodge") +
  geom_text(aes(label = paste(round(value*100,0),"%",sep=""), group=NR_CAT), 
            position=position_dodge(width=0.9), 
            vjust=-0.25, size=3)  +
  scale_y_continuous("Percentage", labels=percent, limits=c(0,1)) +
  labs(x="Year Quarter") +
  scale_fill_discrete("Canopy Indicators") + 
  facet_wrap(~TYPE,ncol=1) +
  ggtitle("Canopy Indicator: All Customers portout for Network Issues") +
  theme(plot.title = element_text(size=rel(1.2))) 
```

![在此处输入图像描述](../Images/1c2b1372d7e987f722bee926027997cd.png)

问题的第一部分只是通过格式化`YearQuarter`为您想要的格式来实现，将其保留为字符串。

第二部分指定限制`scale_y_continuous`并使用`labels`参数来指定格式化函数。请注意，`library("scales")`这部分需要它才能工作。

# matlab - Matlab中的矩阵索引

> ID：13594837
> 
> 赞同：0
> 
> 时间：2012-11-27T23:06:18.783
> 
> 标签：matlab

如何在 Matlab 中将这两个命令合并为一个？

```
Temp = diag(diag(A));
X = Temp(:) 
```

就像是

```
X = diag(diag(A))(:) 
```

不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:13:24.240

如果你真的想，你可以这样做：

```
X = reshape(diag(diag(A)),[],1) 
```

不过，我不确定您这样做会获得多少收益！

# perl - 在 Perl 中绑定运算符意味着什么？

> ID：13594838
> 
> 赞同：6
> 
> 时间：2012-11-27T23:06:25.210
> 
> 标签：perl, binding, operators, operator-precedence

例如，在“Programming Perl”中有这样的句子：

> 这些字符串运算符与其对应的算术运算符绑定得一样紧密。

在其他地方，无论是在“PP”还是在 perldoc 中，作者都​​使用了诸如“绑定紧密”之类的短语；例如，当指代 =~ 时，或者当指代 **（求幂）时“绑定得更紧密”。

如果这与优先级相同，我猜就不可能说“更紧”之类的话。你会说“更高/更低的优先级”。

那么操作员绑定到底是什么意思呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T23:07:56.877

这指的是运算符优先级。在声明中

```
a = b + c * d 
```

乘法具有更高的优先级，因此“绑定”比加法更紧密。

绑定更紧密的运算符在绑定不太紧密的运算符之前进行评估。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-27T23:16:07.797

您可以查看文档中的[优先级列表](http://perldoc.perl.org/perlop.html#Operator-Precedence-and-Associativity)，并将其与您阅读的文本进行比较。不过，我很确定他们在谈论优先级。

优先权是一种约束形式，因为它将论点以不同的强度“粘合”在一起。例如，人们常犯的错误是使用：

```
open my $fh, "<", "input.txt" || die $!; 
```

这是一个无声且致命的错误，因为`||`“绑定更紧密”/具有比逗号`,`运算符更高的优先级，因此此表达式变为：

```
open my $fh, "<", ("input.txt" || die $!); 
```

并且由于字符串“input.txt”始终为真，无论如何，由于它是一个常量，因此`die`永远不会使用该语句。因此，该`open`语句可能会静默失败，从而导致难以发现错误。

（解决方案是使用较低优先级运算符`or`而不是`||`，或者正如[mob](https://stackoverflow.com/users/168657/mob)指出的那样，通过使用括号来覆盖优先级。）

# google-apps-script - Google Apps 脚本：如何在嵌入电子表格的图表中设置“使用 A 列作为标签”？

> ID：13594839
> 
> 赞同：14
> 
> 时间：2012-11-27T23:06:26.303
> 
> 标签：google-apps-script, charts, google-sheets, google-visualization, embedded-resource

我正在使用 Google Apps Script 和[EmbeddedChartBuilder](https://developers.google.com/apps-script/class_embeddedchartbuilder)在我的 Google 电子表格中嵌入折线图。当您手动创建这些图表时，您可以选择（非默认）“使用 A 列作为标签”（其中“A”是数据范围中的第一列）。我找不到从脚本中做同样事情的方法。从[Google Visualization Line Chart](https://google-developers.appspot.com/chart/interactive/docs/gallery/linechart)文档看来，默认情况下将第一列视为具有“域”角色；但 EmbeddedChartBuilder 似乎覆盖了这一点并赋予所有列“数据”角色。由于我没有明确的 DataTable，因此我无法自己设置[列角色](https://google-developers.appspot.com/chart/interactive/docs/roles)。

我错过了这样做的方法吗？或者我是否必须将方法从 EmbeddedChartBuilder 转换为[使用电子表格作为数据源](https://developers.google.com/chart/interactive/docs/spreadsheets)？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-30T20:50:29.517

找到了！使用[EmbeddedChartBuilder.setOption](https://developers.google.com/apps-script/class_embeddedchartbuilder#setOption)将选项设置`useFirstColumnAsDomain`为。`true`

此选项似乎没有记录。我通过转到“发布图表”（单击图表，然后从右上角的下拉菜单中选择）并检查给定代码中的 JavaScript 数据结构找到了它。准确地说，我创建了一个未选中“使用A列作为标签”的图表，抓取发布数据结构，然后选中“使用A列作为标签”，抓取新的发布数据结构，并将两者进行比较。为了比较，我建议[规范化 JSON](https://stackoverflow.com/a/1920585/379428)并运行`diff`. 此技术可用于对图表编辑器中的任何设置进行逆向工程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-06-23T19:56:50.520

我刚刚遇到了同样的问题。我采取了与 Andrew 类似的方法，但找到了不同的解决方案（可能是因为 Google 在电子表格中的图表中添加了功能）。

发布后使用[http://jsbeautifier.org/](http://jsbeautifier.org/)格式化代码，发现这部分负责添加数据标签。请注意，您甚至可以更改将条形图连接到数据标签的主干的颜色：

```
"series": {
                    "0": {
                        "errorBars": {
                            "errorType": "none"
                        },
                        "dataLabel": "value",
                        "annotations": {
                            "stemColor": "none"
                        }
                    },
                    "color": "black",
                    "targetAxisIndex": 0,
                    "annotations": {
                        "textStyle": {
                            "color": "red",
                            "fontSize": 12
                        }
                    }
                }, 
```

# html - W8 Store App：用 HTML 和 CSS 编写 UI，并为域/模型使用 C# DLL？

> ID：13594840
> 
> 赞同：5
> 
> 时间：2012-11-27T23:06:35.293
> 
> 标签：html, wpf, dll, windows-8, windows-store-apps

我们已经开始研究创建通过我们/客户的域商店推送到 Surfaces 的 LOB W8 商店应用程序的可能性。我们有一系列用 .Net 编写的可运行的 WinForms 和 WPF 应用程序，并且由于客户的偏好，正在考虑将其中一些迁移到 Surface。现在我陷入了两难境地：我对 Windows 8 中的开发技术进行了研究，根据我的阅读和尝试，似乎利用 W8 Store 开发技术的最佳方法是使用以下组合：

*   用于 UI 开发（视图）的 HTML、CSS、JQuery 和 JS，以及
*   C# 和适当的 .Net 用于解决方案的模型/域部分。

事实是（或恕我直言），在创建触发器、效果、动画和 UI 时，与轻量级 HTML/CSS/JQuery 相比，XAML 非常臃肿，我们没有那么多开发人员创建 UI 的时间。另一方面，JS（恕我直言，再次）无法用于域/模型应用程序，因为必须重写代码（没有时间），尽管 JS 中引入了语言和类型检查，但我认为该语言是几乎无法用于我们的领域/模型要求和学习曲线。

从我的想法来看，**是否有可能在 HTML/CSS/JQuery/JS 中编写 UI 部分和在 .Net/C# 中编写域/模型部分？**这样我们就有了一堆 HTML、JS，比如说要绑定的 ViewModel，以及一个用 C# 编写的域 DLL？我的意思是使用它类似于在 C++.Net 中创建解决方案并添加几个 C# 和 VB.Net 项目/dll 引用并引用其中的类？

我读到，实现这一点的唯一方法（因为 JS 应用程序是本机 AFAIK）是使用互操作和 COM，而且，我担心我们的软件无法做到这一点。

感谢你们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T01:36:30.277

[Windows 运行时组件](http://msdn.microsoft.com/en-us/library/windows/apps/hh441572.aspx)应该在此处启用您想要的功能，并提供与 JS 前端的无缝集成（阅读：您无需担心杂乱的互操作/COM）。您用 C# 编写的 Windows 运行时组件可以使用 Windows 应用商店允许的任何 .NET 功能（因此您不会失去任何功能）；但是，您从 Windows 运行时组件公开的内容只能将 Windows 运行时类型用于参数和返回值，这可能是您所期望的。

查看[开发中心上的演练](http://msdn.microsoft.com/en-us/library/windows/apps/hh779077.aspx)和[在 C# 和 Visual Basic 中创建 Windows 运行时组件以](http://msdn.microsoft.com/en-us/library/windows/apps/br230301%28v=VS.85%29.aspx)了解更多详细信息。

# meteor - Meteor 中的预选选项

> ID：13594843
> 
> 赞同：2
> 
> 时间：2012-11-27T23:07:04.163
> 
> 标签：meteor

尝试实现一个允许您修改现有数据库记录的弹出窗口。作为其中的一部分，我有几个选择框需要预先填充现有的选择。我首先想到的似乎更难做到。这是我作为模板的片段

```
{{#with myExistingRecord}}
    <select class="myselect">
        {{#each hoursInTheDay}}
            {{#if isSelectedHour}}
                <option selected>{{this}}</option>
            {{else}}
                <option>{{this}}</option>
            {{/if}}
        {{/each}}
    </select>
{{/with}} 
```

我遇到的问题是在`isSelectedHour`模板函数中，因为`this`不能有两个定义（第一个是#each 值，第二个是记录对象）。我需要将#each 循环中的值与我的记录中的值进行比较，我想不出一种优雅的方式来做到这一点。我总是可以将我的记录值设置为 Session 变量，但这太难了。

有没有一种好的，非hacky的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T21:45:34.637

我遇到了同样的问题，令我惊讶的是，有一个很好的方法。您确实可以访问模板部分中的外部上下文，并且可以使用它将 this 传递给辅助函数的值。我会重写你的代码如下：

```
<template name="myTemplate">
{{#with myExistingRecord}}
    <select class="myselect">
        {{#each hoursInTheDay}}
            <option {{selected ../recordHour}}>{{this}}</option>
        {{/each}}
    </select>
{{/with}}
</template> 
```

然后有一个辅助函数：

```
Template.myTemplate.selected = function(hour) {
    if (hour == currentHour)
        { return "selected ";}
    else 
        { return "";}
}; 
```

[在此处](https://github.com/meteor/meteor/wiki/Handlebars)查看有关 ../ 符号如何工作的详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:08:40.423

最后我决定创建一个简单的 Handlebars 助手来处理这个问题。如果有人想做类似的事情，这里是帮助代码：

```
Handlebars.registerHelper('hourOptions', function(selectedHour) {
    var html = '';

    for (var hr = 0; hr < 24; hr++) {
        if (hr === selectedHour)
            html += '<option selected>' + hr + '</option>';
        else
            html += '<option>' + hr + '</option>';
    }

    return new Handlebars.SafeString(html);
}); 
```

模板代码变为

```
{{#with myExistingRecord}}
    <select class="myselect">
        {{hourOptions mySelectedHour}}
    </select>
{{/with}} 
```

# monitoring - Cacti - 升级到 0.8.8a 后不在 Windows 服务器上绘制硬盘空间图形

> ID：13594844
> 
> 赞同：0
> 
> 时间：2012-11-27T23:07:04.547
> 
> 标签：monitoring, snmp, net-snmp, cacti

我已将 Cacti 从 0.8.7g 升级到 0.8.8a。（我们使用轮询器而不是脊椎）。

我按照这里的升级说明进行操作 - [http://docs.cacti.net/manual:088:1_installation.3_upgrading#upgrading_cacti](http://docs.cacti.net/manual:088:1_installation.3_upgrading#upgrading_cacti)

仙人掌服务器；Linux RedHat server RHEL4connect to mysql 不使用自定义脚本基本上是内置的服务器（索引）脚本。

没有图表的是 Windows 或 linux 机器上的硬盘使用情况（hdtotal/hdfreespace） Windows 服务器只会绘制网络统计数据而不是 hd/cpu。

我已经确认服务器脚本目录中的 OID 是正确的。在这里完成了故障排除步骤 - [http://docs.cacti.net/manual:088:4_help.2_debugging#debugging](http://docs.cacti.net/manual:088:4_help.2_debugging#debugging)

Linux 服务器可以记录和显示 cpu/网络，但不能记录和显示硬盘数据。

我意识到这篇文章有点到处都是，但对仙人掌来说是新的，并且想要解决这些问题。任何信息/帮助表示赞赏。哪怕只是搭建一个windows server监控图。

谢谢罗杰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T10:32:20.247

您是否已经重建了轮询器缓存？

转到控制台-> 系统实用程序-> 重建轮询器缓存

这将重建轮询器正在使用的缓存。它有时在更新过程中没有正确更新，导致一些图表为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-14T06:18:00.900

仅供参考，我们在这次升级中运气不佳，最终使用通过 redhat 存储库提供的软件包重建了服务器。

谢谢阅读

# java - 切割字符串java

> ID：13594854
> 
> 赞同：0
> 
> 时间：2012-11-27T23:07:45.553
> 
> 标签：java, string, split

我需要为我正在制作的算法剪切某些字符串。我正在使用`substring()`，但它太复杂了，实际上无法正常工作。我发现这个主题[如何用两个正则表达式“_”和“。”剪切字符串](https://stackoverflow.com/questions/2911005/how-to-cut-string-with-two-regular-expression-and)

并决定尝试，`split()`但它总是给我

```
java.util.regex.PatternSyntaxException: Dangling meta character '+' near index 0
+
^ 
```

所以这是我的代码：

```
 String[] result = "234*(4-5)+56".split("+");
      /*for(int i=0; i<result.length; i++)
      {
         System.out.println(result[i]);
      }*/
      Arrays.toString(result); 
```

任何想法为什么我会得到这个恼人的异常？

**PS如果我解决了这个问题，我会向您发布切割算法，然后是整个计算器的算法（因为我正在构建一个计算器）。这将是一个非常糟糕的计算器，我保证：P**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T23:09:25.897

`+`在正则表达式中具有特殊含义。要被视为普通字符，您应该使用反斜杠对其进行转义。

```
 String[] result = "234*(4-5)+56".split("\\+"); 
```

以下是正则表达式中的元字符。要将它们中的任何一个视为普通字符，您应该使用反斜杠对其进行转义

```
 <([{\^-=$!|]})?*+.> 
```

[请参阅此处了解字符在 regex 中的工作方式](http://docs.oracle.com/javase/tutorial/essential/regex/literals.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T23:09:09.763

`+`是一个正则表达式量词（表示*一个或多个*），因此需要在`split`方法中转义：

```
String[] result = "234*(4-5)+56".split("\\+"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T23:09:17.830

你应该像这样分割你的字符串： -

```
String[] result = "234*(4-5)+56".split("[+]"); 
```

因为，`String.split`以a`regex`作为分隔符，并且`+`是正则表达式中的元字符，表示匹配`1 or more`重复，所以在正则表达式中使用它是错误的`bare`。

您可以在字符类中使用它来匹配`+`文字。因为在 中`character class`，元字符和所有其他字符失去了它们的特殊含义。仅`hiephen(-)`在其中具有特殊含义，即 a `range`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-27T23:10:05.073

加号`+`在正则表达式中具有意义，这就是`split`解析它的参数的方式。您需要正则表达式转义加号字符。

```
.split("\\+"); 
```

# visual-studio - 如何在 Visual Studio (2012) 中禁用 T4 模板自动运行？

> ID：13594860
> 
> 赞同：12
> 
> 时间：2012-11-27T23:07:59.157
> 
> 标签：visual-studio, t4

我的项目中有一些 T4 模板。每当我进行更改并保存 tt 文件时，它都会自动更新生成的文件。这是一个循环数据库中所有表并生成大约 100 多个文件的模板。所以每次我保存模板时，Visual Studio 都会挂起几秒钟，这很烦人。有没有办法禁用“自动刷新”功能，我可以通过上下文菜单手动运行模板。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-27T23:22:38.910

您可以在编辑文件时删除文件属性中“自定义工具”下的 TextTemplatingFileGenerator，然后在完成后将其放回原处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-04T19:50:52.513

我有一个类似的问题。我通过创建一个 ttinclude 文件（实际上这已经是一个标准的包含文件，其中包含我的模板的实用程序函数）并将其包含在我的所有 T4 模板中，找到了一个快速的解决方法。然后我只是在包含文件中创建了一个编译器错误。因此，当生成器尝试运行时，它只会在编译时失败。然后，当我准备好实际生成时，我会删除有问题的代码，然后生成。

例如导致失败：

```
<#+

#

#> 
```

要禁用故障：

```
<#+

//#

#> 
```

如果您只想禁用正在处理的模板，也可以在 T4 模板本身中使用此技巧。

希望未来的 VS 版本将允许您简单地禁用自动转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-30T20:01:44.497

由于 TT 总是被执行（仍然），我找到了一种不同的方式来控制执行 TT 时的输出。

```
/********SET THIS TO REGENERATE THE FILE (OR NOT) ********/

var _RegenerateFile = true;

/********COS VS ALWAYS REGENERATES ON SAVE ***************/

// Also, T4VSHostProcess.exe may lock files. 
// Kill it from task manager if you get "cannot copy file in use by another process"

var _CurrentFolder = new FileInfo(Host.ResolvePath(Host.TemplateFile)).DirectoryName;
var _AssemblyLoadFolder = Path.Combine(_CurrentFolder, "bin\\Debug");

Directory.SetCurrentDirectory(_CurrentFolder);
Debug.WriteLine($"Using working folder {_CurrentFolder}");

if (_RegenerateFile == false)
{
    Debug.WriteLine($"Not Regenerating File");
    var existingFileName = Path.ChangeExtension(Host.TemplateFile, "cs"); 
    var fileContent = File.ReadAllText(existingFileName);
    return fileContent;
}

Debug.WriteLine($"Regenerating File"); //put the rest of your usual template 
```

另一种方法（我最终确定的方法）是基于读取一个条件编译符号，该符号在为 T4 提供数据的类之一上设置属性。`REGEN_CODE_FILES`除非您添加条件编译符号，否则这会带来跳过所有准备（和 IDE 滞后）的好处。（我想这也可以做成一个新的解决方案配置。*是的，这确实有效，并且不需要下面的类更改*）

我在同一个程序集中调用的类的一个例子..

```
public class MetadataProvider
{
    public bool RegenCodeFile { get; set; }

    public MetadataProvider() 
    {

#if REGEN_CODE_FILES
        RegenCodeFile = true; //try to get this to set the property
#endif
        if (RegenCodeFile == false)
        {
            return;
        }
        //code that does some degree of preparation and c...
    }
} 
```

在 TT 文件中...

```
var _MetaProvider = new MetadataProvider();
var _RegenerateFile = _MetaProvider.RegenCodeFile;

// T4VSHostProcess.exe may lock files. 
// Kill it from task manager if you get "cannot copy file in use by another process"

var _CurrentFolder = new FileInfo(Host.ResolvePath(Host.TemplateFile)).DirectoryName;
var _AssemblyLoadFolder = Path.Combine(_CurrentFolder, "bin\\Debug");

Directory.SetCurrentDirectory(_CurrentFolder);
Debug.WriteLine($"Using working folder {_CurrentFolder}");

if (_RegenerateFile == false)
{
    Debug.WriteLine($"Not Regenerating File");
    var existingFileName = Path.ChangeExtension(Host.TemplateFile, "cs"); 
    var fileContent = File.ReadAllText(existingFileName);
    return fileContent;
}

Debug.WriteLine($"Regenerating File"); 
```

# java - 如何在 Mac OS X 10.7.5 上恢复到 Java 1.6

> ID：13594864
> 
> 赞同：25
> 
> 时间：2012-11-27T23:08:15.653
> 
> 标签：java, macos

我有 1.6 安装程序。我用过。它不会改变我的 Java 安装，也不会说有旧版本，但它确实完成了安装。

我一直在使用符号链接，但无论我做什么，都在运行

```
java -version 
```

在终端总是导致

```
Daves-MacBook-Pro:core-server dave$ java -version
java version "1.7.0_07"
Java(TM) SE Runtime Environment (build 1.7.0_07-b10)
Java HotSpot(TM) 64-Bit Server VM (build 23.3-b01, mixed mode) 
```

我的应用程序使用 GAE，它根本不使用 Java 1.7。因此，我无法使用 1.7 编译我的代码！我必须使用 1.6，但我未能找到删除 1.7 或强制在 1.6 上进行构建/编译的方法。

最后一点，我在命令行上运行构建工具，因此在 Eclipse 中更改项目的设置似乎没有帮助。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-11-27T23:27:58.460

,等命令行工具对环境变量的值很敏感，`java`如果此变量指向 1.6 JDK，将使用 1.6。该工具是您的朋友。跑步`javac``JAVA_HOME``/usr/libexec/java_home`

```
/usr/libexec/java_home 
```

`JAVA_HOME`将为您系统上最新的 JDK打印出适当的值。这将是 Java 7，但您可以使用`-v`标志应用约束，例如

```
/usr/libexec/java_home -v '1.6*' 
```

将返回系统上`JAVA_HOME`可用的最佳*1.6* JDK 的值。您可以使用此值来设置`JAVA_HOME`：

```
export JAVA_HOME=`/usr/libexec/java_home -v '1.6*'` 
```

或者作为特定终端会话的一次性使用，或者通过将上述行添加到`.bash_profile`主目录中的文件来永久用于所有未来的终端会话。

* * *

```
$ export JAVA_HOME=`/usr/libexec/java_home -v '1.6*'`
$ java -version
java version "1.6.0_37"
Java(TM) SE Runtime Environment (build 1.6.0_37-b06-434-11M3909)
Java HotSpot(TM) 64-Bit Server VM (build 20.12-b01-434, mixed mode)
$ export JAVA_HOME=`/usr/libexec/java_home -v '1.7*'`

$ java -version
java version "1.7.0_09"
Java(TM) SE Runtime Environment (build 1.7.0_09-b05)
Java HotSpot(TM) 64-Bit Server VM (build 23.5-b02, mixed mode) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T14:55:19.033

如果您需要编写要在以前版本的 Java 上运行的代码，则可以更改编译标志。这可能就是您所需要的，并且

例如。

```
javac -source 1.6 -target 1.6 MyClass.java 
```

源 arg 指出源是用该版本的 Java 编写的，因此`List<String> strings = new ArrayList<>();`会出现编译错误。Target 告诉编译器编译针对指定 JVM 版本的字节码。虽然我认为 1.7 完全向后兼容 1.5 和 1.6。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-21T20:46:14.720

我遇到了类似的问题。安装 JDK7 后，我的一些应用程序不再工作。我需要恢复到 JDK6，但我做了不同的事情。我注意到在我的 /System/Library/Frameworks/JavaVM.framework/Versions/ 中，它显示了以下内容：

```
lrwxr-xr-x  1 root  wheel   10 Oct 25 17:01 1.4 -> CurrentJDK
lrwxr-xr-x  1 root  wheel   10 Oct 25 17:01 1.4.2 -> CurrentJDK
lrwxr-xr-x  1 root  wheel   10 Oct 25 17:01 1.5 -> CurrentJDK
lrwxr-xr-x  1 root  wheel   10 Oct 25 17:01 1.5.0 -> CurrentJDK
lrwxr-xr-x  1 root  wheel   10 Oct 25 17:01 1.6 -> CurrentJDK
lrwxr-xr-x  1 root  wheel   10 Oct 25 17:01 1.6.0 -> CurrentJDK
drwxr-xr-x  8 root  wheel  272 Oct 25 18:06 A
lrwxr-xr-x  1 root  wheel    1 Oct 25 17:01 Current -> A
lrwxr-xr-x  1 root  wheel   59 Nov 20 21:40 CurrentJDK -> /Library/Java/JavaVirtualMachines/jdk1.7.0_45.jdk/Contents/ 
```

所以我删除了符号链接 CurrentJDK

```
 sudo rm CurrentJDK 
```

并重新创建了指向 JDK6 的符号链接，它仍在我的 Mac 上

```
sudo ln -s  /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/ CurrentJDK 
```

这对我有用

```
java -version
   java version "1.6.0_65"
   Java(TM) SE Runtime Environment (build 1.6.0_65-b14-462-11M4609)
   Java HotSpot(TM) 64-Bit Server VM (build 20.65-b04-462, mixed mode) 
```

# unit-testing - 错误：不可分配的模型表达式：未定义

> ID：13594865
> 
> 赞同：16
> 
> 时间：2012-11-27T23:08:19.903
> 
> 标签：unit-testing, angularjs

我正在尝试为指令编写测试，因此我使用`$compile`. （是的，我知道我可以为此使用 e2e 测试，但在这种情况下，我想测试一些独立于 DOM 的逻辑，所以我使用了单元测试方法。）

我有一个绑定到的字段`scope: {foo: '='}`。当我尝试在指令的范围内设置它时，我收到以下错误：

```
Error: Non-assignable model expression: undefined (directive: foo)
    at Error (<anonymous>)
    at $get.parentSet (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:4146:25)
    at Object.<anonymous> (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:4160:23)
    at Object.$get.Scope.$digest (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:7693:38)
    at Object.$get.Scope.$apply (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:7894:24)
    at SNAKE_CASE_REGEXP (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:930:13)
    at Object.invoke (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:2788:25)
    at bootstrap (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:928:12)
    at angularInit (https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:904:5)
    at https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js:14397:5 
```

转载于此[小提琴](http://jsfiddle.net/_nth/u4BTu/5/)。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-27T23:18:27.157

在您的指令中，您有：

```
scope: {
   bar: '='
} 
```

这意味着它将在指令元素 ( `<div foo></div>`) 上查找属性名称“bar”，并在指令和为属性指定的对象中进行双向数据绑定。所以，首先你需要添加一个`bar`属性，然后你需要在你的范围内设置一些属性值的名称。见[http://jsfiddle.net/u4BTu/6/](http://jsfiddle.net/u4BTu/6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-26T06:26:34.430

此错误的另一个可能原因是忽略了 Angular 对属性的[规范化](https://docs.angularjs.org/guide/directive#normalization)。例如，如果您有以下指令：

```
<my-directive parameter-one="foo" parameter_two="bar"></my-directive> 
```

使用此范围声明：

```
scope: {
  'parameter-one': '=',
  parameter_two: '=',
} 
```

你会得到这个错误。要更正，请使用范围声明的规范化版本：

```
scope: {
  parameterOne: '=',
  parameterTwo: '=',
} 
```

# html - 在 CSS 导航菜单中选择最后一个活动的 li 类

> ID：13594868
> 
> 赞同：4
> 
> 时间：2012-11-27T23:08:48.017
> 
> 标签：html, css, html-lists

我只需要使用仅使用 CSS 的类默认值为最后一个 li 着色。编辑 HTML 不是一种选择。IE9+ 没问题。如何只为最后一个链接着色？这只是一个示例，菜单是动态的，因此不能使用最后一个子项或指定确切的最后一个链接。我有一个这样的导航菜单：

```
<ul>
    <li class="default">
        <a href="#">About Us</a>
        <ul>
            <li class="default">
                <a href="#">Where we live</a>
                <ul>
                    <li class="default">
                        <a href="#">Make this link red only</a>
                    </li>
                    <li>
                        <a href="#">Directions</a>
                    </li>
                </ul>
            </li>
        </ul>
     </li>
 </ul> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T23:21:37.990

至于纯 CSS 方法，IE9 支持这些伪选择器。这也可以在 jquery 之类的东西中使用。但是，此代码的问题是，如果您有多个默认值，那么它将为它们着色。

```
li.default > a:only-child {
  color:red;            
}​ 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-27T23:31:47.197

我认为[这个 PHP 解决方案](http://www.alistapart.com/articles/keepingcurrent/)最适合您的情况（[这是我制作的 PHPfiddle 演示](http://phpfiddle.org/main/code/fxb-ukv)：点击“运行”并等待几秒钟）。

要实现这一点，请将其添加到 HTML 文件的顶部：

```
<?php $thisPage='Make this link red only'; ?>
<html><head> 
```

然后将此 PHP（在`<?php`and`?>`标记内）添加到所有导航项中：

```
 <ul>
        <li <?php if ($thisPage=='About Us') echo ' id="currentpage"'; ?>>
            <a href="#">About Us</a>
            <ul>
                <li<?php if ($thisPage=='Where we live') 
          echo ' id="currentpage"'; ?>>
                    <a href="#">Where we live</a>
                    <ul>
                        <li<?php if ($thisPage=='Make this link red only') 
          echo ' id="currentpage"'; ?>>
                            <a href="#">Make this link red only</a>
                        </li>
                        <li <?php if ($thisPage=='Directions') 
          echo ' id="currentpage"'; ?>>
                            <a href="#">Directions</a>
                        </li>
                    </ul>
                </li>
            </ul>
         </li>
     </ul> 
```

然后将您的 CSS 设置为：

```
#currentpage a { color: red; } 
```

您还必须重命名您的`index.html`as `index.php`，或者更好的解决方案是使用 .htaccess （假设您正在运行 Apache 服务器）来[解析 HTML](https://stackoverflow.com/questions/4687208/using-htaccess-to-make-all-html-pages-to-run-as-php-files)文件中的 PHP。

# ruby-on-rails - 如何跟踪触发弹出窗口的数据事件

> ID：13594875
> 
> 赞同：0
> 
> 时间：2012-11-27T23:09:06.627
> 
> 标签：ruby-on-rails, popup

通过数据事件，我的意思不是像点击这样的物理事件，而是像社交网络奖励系统中的“当用户第一次获得第 100 分时”。（如果有描述这个的术语，请告诉我）

我目前有一张`users`has_many 的表格`medals`，这是每当用户达到奖牌所需的积分阈值时获得的图标。我正在使用[Activerecord-reputation-system](https://github.com/twitter/activerecord-reputation-system)通过内置的 helper 跟踪用户点`reputation_for(:points)`。

在我看来，我展示

```
Medal.all.each do |medal|
  if @user.reputation_for(:points) >= medal.requirement
    image_tag(medal.icon)
  end
end 
```

这可以很好地显示已获得的徽章，但我想在用户第一次获得徽章时祝贺用户的一次性弹出消息。

我需要做什么才能“知道”用户何时首次达到徽章阈值？

对不起，这很广泛，但真的不知道从哪里开始。我是否需要创建第二个模型来“跟踪”用户的进度？如果是这样，那个模型会是什么样子？如果您能指出任何相关资源，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T13:00:58.120

我不是 RoR 专家，但是否可以在您的`user`模型中添加一个布尔值来告诉您尚未获得任何徽章？

这样，当您添加 时`medal.icon`，您可以检查它是否是第一次（对于此用户）并向她显示一个祝贺弹出窗口并通过更改 bolean 的值来标记它。

# java - 计算存款证明的利息

> ID：13594881
> 
> 赞同：0
> 
> 时间：2012-11-27T23:09:19.547
> 
> 标签：java

我正在开发一个程序，该程序将计算存款证明上应计的基本利息。该计划要求提供投资金额和期限（最长五年）。取决于他们的任期是多少年，决定了赚取多少利息。我使用 if/else 语句来确定利率。然后，我使用循环打印出每年年底账户中有多少钱。我的问题是，当我运行程序时，钱不算数。

这是整个代码。

```
import java.util.Scanner;

public class CDCalc
{
    public static void main(String args[])
        {
            int Count = 0;
            double Rate = 0;
            double Total = 0;

            Scanner userInput = new Scanner(System.in);

            System.out.println("How much money do you want to invest?");
            int Invest = userInput.nextInt();

            System.out.println("How many years will your term be?");
            int Term = userInput.nextInt();

            System.out.println("Investing: " + Invest);
            System.out.println("     Term: " + Term);

            if (Term <= 1)
            {
            Rate = .3;
            }

            else if (Term <= 2)
            {
            Rate = .45;
            }

            else if (Term <= 3)
            {
            Rate = .95;
            }

            else if (Term <= 4)
            {
            Rate = 1.5;
            }

            else if (Term <= 5)
            {
            Rate = 1.8;
            }

            int count = 1;
                    while(count <= 5)
                {

                    Total = Invest + (Invest * (Rate) / (100.0));

                    System.out.println("Value after year " + count + ": " + Total);
                    count++;
                }       
        }
} 
```

这是我用 10 美元投资得到的结果，为了简单起见，投资 5 年。

```
How much money do you want to invest?
10
How many years will your term be?
5
Investing: 10
     Term: 5
Value after year 1: 10.18
Value after year 2: 10.18
Value after year 3: 10.18
Value after year 4: 10.18
Value after year 5: 10.18 
```

我的主要问题是我不知道如何让它不断地将兴趣添加到总数中。我不确定我是否需要使用不同的循环或什么。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:11:49.560

```
 Total = Invest + (Invest * (Rate) / (100.0)); 
```

你没有改变`Invest`每一年的价值，所以它不是复利。就像您每年从帐户中获得 0.18 美元的利息一样。

更改`Total`为`Invest`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:21:26.103

您需要将投资利息添加到您的总额中：

```
 Total = Invest;

        int count = 1;
                while(count <= 5)
            {

                Total =  Total +  (Invest * (Rate) / (100.0));

                System.out.println("Value after year " + count + ": " + Total);
                count++;
            } 
```

# project - 如何在不中断所有连接/链接的情况下重新组织和重命名项目中的文件？

> ID：13594888
> 
> 赞同：0
> 
> 时间：2012-11-27T23:09:37.623
> 
> 标签：project, code-organization, file-rename, batch-rename

我有一般的网络项目，包括图像、脚本和样式，我想重组整个项目而不破坏它。

*   更改文件夹结构
*   更改文件名

并保持所有链接/连接正常工作。

*// 我正在使用 Sublime 2 文本编辑器和 GIT*

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:38:02.150

如果您在 Linux（或 Mac）上运行，您可以使用 Awk、Grep 或 Sed 来完成这项工作。

# pdf - 为什么“端口 9100”打印多页 PDF 会导致 HP 4515 在页面之间暂停？

> ID：13594891
> 
> 赞同：1
> 
> 时间：2012-11-27T23:09:57.043
> 
> 标签：pdf, printing

我每天创建数千个 PDF 文件，并使用带有 Prawn 的 Ruby on Rails 应用程序在一组 HP-4515 打印机上打印它们。经过几年的生产打印，今天我注意到另一个 HP 异常：一个简单的 47kB 10 页表格文件导致 HP 打印机在页面之间暂停几秒钟。（表格不跨页）。

我有一个自定义打印后台处理程序，可确保从呼叫中心的提交中连贯地打印某些文档包，并且该后台打印程序记录有多少字节写入打印机的端口 9100 套接字。奇怪的是，这个 47kB 的文件记录了 6,442kB 的发送字节数（137 次！），这需要 71 秒。大多数 50kB 文件的套接字写入只需要几毫秒，除非打印机得到备份（我有几种限制文件写入的技术，以避免打印机陷入困境，从而提高吞吐量。这种限制只会延迟文件之间，而不是文件内部）。

多个页面是使用 Prawn 的@pdf.start_new_page 创建的。在 OSX 的 Skim 或 Preview 中查看 PDF 并没有什么意外。

我的其他约 100 个 PDF 文件类型都不会导致这种奇怪的打印机暂停，尽管几乎所有其他文件类型都是单页的。

所有其他 @socket.write(str) 调用实际上发送文件中的字节数。

这些文件有专有的法庭案件信息，所以我不能只附上样本。如果有人有建议，也许我可以使用无意义的数据创建一个类似的文件......

顺便说一句 - 我发现惠普的支持毫无用处，尽管我们为此付出了很多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T18:06:23.283

我严重怀疑您的 HP 打印机是否能够直接使用 PDF 文件。

我怀疑您所谓的“自定义后台处理程序”会默默地将 PDF 文件转换为 PCL 或 PostScript（就像 CUPS 所做的那样），以便为打印设备提供一种可消化的数据格式。

很可能是这个转换后的数据（PCL、PostScript 等）会产生 6.442 kB 的字节发送到打印机。

为了验证或调试这种情况，您应该使用一些可用的技术来捕获发送到打印机的实际数据......

# android - 如何强制 ViewPager 从子 Fragment 重新加载其子级

> ID：13594894
> 
> 赞同：3
> 
> 时间：2012-11-27T23:10:05.207
> 
> 标签：android, android-viewpager, illegalstateexception

我有一个`ViewPager`里面的`FragmentActivity`。使用`ViewPager`a`FragmentPagerAdapter`并具有以下值得注意的方法：

```
@Override
public Fragment getItem(int position) {
    return ChildFragment.newInstance(MyActivity.this);
}

@Override
public int getItemPosition(Object object) {
    return POSITION_NONE;
} 
```

在其中一个子片段中，我修改了 ViewPager 的适配器，以便子片段的顺序发生变化。要强制 ViewPager 更新以反映此更改，我调用：

```
mViewPager.getAdapter().notifyDataSetChanged(); 
```

但是我得到了这个例外：

```
java.lang.IllegalStateException: Recursive entry to executePendingTransactions 
```

如果我用 ASyncTask 调用 notifyDataSetChanged() 异常就会消失，但 ViewPager 不会更新它的视图。

有谁知道在调用 notifyDataSetChanged() 时强制 ViewPager 重新加载其子视图的正确方法？

谢谢

# mysql - 来自远程主机的 mysqldump

> ID：13594895
> 
> 赞同：40
> 
> 时间：2012-11-27T23:10:07.193
> 
> 标签：mysql, linux, ssh

是否可以通过 ssh 连接从远程主机转储数据库并在我的本地计算机上保存备份文件。

如果是这样，如何实现？

我假设它将是从 ssh 到转储的管道输出的某种组合，反之亦然，但无法弄清楚。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-11-27T23:26:29.920

这将通过 ssh 转储、压缩和流式传输到您的本地文件中

```
ssh -l user remoteserver "mysqldump -mysqldumpoptions database | gzip -3 -c" > /localpath/localfile.sql.gz 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-09-01T10:54:14.377

从@MichelFeldheim 的解决方案开始，我会使用：

```
$ ssh user@host "mysqldump -u user -p database | gzip -c" | gunzip > db.sql 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-27T23:14:45.160

`ssh -f user@server.com -L 3306:server.com:3306 -N`

然后：

`mysqldump -hlocalhost > backup.sql`

假设您也没有在本地运行 mysql。如果你这样做，你可以将端口调整为其他东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-11-16T20:58:06.227

我创建了一个[脚本，以使用](https://github.com/loganstellway/mysqldump-remote)[Michel Feldheim](https://stackoverflow.com/users/1032504/michel-feldheim)提供的答案作为起点，更轻松地`mysqldump`在远程主机上自动执行命令：

> [mysqldump-远程](https://github.com/loganstellway/mysqldump-remote)

该脚本允许您从远程主机获取数据库转储，无论是否`SSH`使用，并且可以选择使用`.env`包含环境变量的文件。

我计划使用该脚本进行自动数据库备份。随意[创建问题](https://github.com/loganstellway/mysqldump-remote/issues)/[贡献](https://github.com/loganstellway/mysqldump-remote)- 希望这对其他人也有帮助！

# php - 权限被拒绝 - php取消链接

> ID：13594898
> 
> 赞同：31
> 
> 时间：2012-11-27T23:10:31.040
> 
> 标签：php, permissions, unlink

我有两个文件：b.php 和 test.txt

```
<?php 
$b = "test.txt";
unlink($b);
?> 
```

错误是：警告：unlink（test.txt）[function.unlink]：权限被拒绝

为什么？b.php 和 test.txt 是 777 和相同的组/登录

如果我在父目录上设置 777 我可以执行 unlink 但我必须设置 777 并返回到 755？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-11-27T23:26:26.910

您（如在运行的进程中`b.php`，通过您`CLI`或网络服务器）需要对文件所在目录的写入权限。您正在更新目录内容，因此访问该文件是不够的。

请注意，如果您使用 PHP`chmod()`函数将文件或文件夹的模式设置为`777`您应该使用`0777`以确保该数字被正确解释为八进制数。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-04-24T04:24:09.887

您首先需要关闭该文件`fclose($handle);`，因为该文件正在使用中，因此它不会被删除。所以先关闭文件再试试。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-03-07T11:04:54.363

除了其他朋友的所有答案之外，如果正在查看此帖子的人正在寻找删除**“文件夹”而不是“文件”**的方法，则应注意文件夹必须通过[php rmdir() 函数](http://php.net/manual/ro/function.rmdir.php)删除，如果你想删除一个“文件夹” `unlink()`，你会遇到一个错误的警告消息，上面写着“权限被拒绝”

但是您可以创建文件夹和文件，`mkdir()`但是`rmdir()`您删除文件夹的方式（）与删除文件的方式（）`unlink()`不同

最终成为事实：

> 在许多编程语言中，任何与权限相关的错误可能并不直接意味着实际的权限问题

例如，如果你想要`readSync`一个不存在的文件，`node fs module`你会遇到一个错误的`EPERM`错误

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-27T23:33:24.073

```
// Path relative to where the php file is or absolute server path
chdir($FilePath); // Comment this out if you are on the same folder
chown($FileName,465); //Insert an Invalid UserId to set to Nobody Owner; for instance 465
$do = unlink($FileName);

if($do=="1"){ 
    echo "The file was deleted successfully."; 
} else { echo "There was an error trying to delete the file."; } 
```

试试这个。希望能帮助到你。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-02T15:02:32.283

文件权限没问题（0777），但我认为你在共享服务器上，所以要正确删除你的文件；1.创建文件的正确路径

```
// delete from folder
$filename = 'test.txt';
$ifile = '/newy/made/link/uploads/'. $filename; // this is the actual path to the file you want to delete.
unlink($_SERVER['DOCUMENT_ROOT'] .$ifile); // use server document root
// your file will be removed from the folder 
```

如果收集了实际文件路径，那么该小代码将发挥作用并从任何文件夹中删除您想要的任何选定文件。

# c - malloc 和其他相关函数

> ID：13594899
> 
> 赞同：1
> 
> 时间：2012-11-27T23:10:33.110
> 
> 标签：c, malloc, calloc

我有一个名为“ArrayA”的数组，它充满了整数，但我想在每次满足条件时在数组末尾添加另外 5 个单元格。我该怎么做？（互联网不是很有帮助）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T23:17:35.927

如果这是一个静态数组，您将不得不创建一个具有更多空间的新数组并自己复制数据。如果它是用 malloc() 分配的，正如您的问题的标题所示，那么您可以使用 realloc() 或多或少地自动执行此操作。请注意，您的数组的地址通常会发生变化。

正是因为需要根据需要增长（和缩小）的“动态”数组，所以像 C++ 这样的语言引入了向量。他们在幕后进行管理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T23:16:02.103

你需要[realloc](http://www.cplusplus.com/reference/cstdlib/realloc/)函数。

另请注意，添加 5 个单元格不是最佳性能解决方案。每次需要增加数组时，最好将数组的大小加倍。使用两个变量，一个用于**大小**（使用的整数个数），一个用于**容量**（数组的实际内存大小）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-27T23:38:25.970

在现代操作系统中，通常可以安全地假设，如果您分配**了大量**不使用的内存，那么它实际上不会消耗物理 RAM，而仅作为虚拟映射存在。一旦第一次使用页面（今天通常以 4Kb 的块），操作系统就会提供物理 RAM。

`mmap`您可以通过使用创建大型匿名映射 ( )来特别强制执行此行为，`MAP_PRIVATE | MAP_ANONYMOUS`例如，您打算最多保留多少。在现代 x64 系统上，虚拟映射最大可达 64Tb。从逻辑上讲，它是您的程序可用的内存，但实际上，当您开始使用它们时，页面将被添加到其中。

`realloc`正如其他海报所描述的那样，这是调整`malloc`映射大小的天真方法，但要确保 realloc 成功。它可能会失败！

当您使用一次内存时，就会出现内存问题，不要释放它并停止使用它。相比之下，已分配但未触及的内存通常不实际使用除 VM 表条目之外的资源。

# windows-8 - 如何从 tileupdatemanager 获取错误

> ID：13594905
> 
> 赞同：0
> 
> 时间：2012-11-27T23:10:44.943
> 
> 标签：windows-8, windows-runtime, live-tile

在我的 winrt 应用程序中，我试图根据轮询的 URI 更新动态磁贴。目前没有更新发生，我不知道如何排除故障。有许多情况可能会破坏事情，但我似乎无法找到深入了解潜在错误的方法。

TileUpdateManager 似乎有点像一个黑洞，它吸收信息但从不释放信息。

有谁知道如何从 TileUpdateManager 查看错误？

如果有人感兴趣，这是我的更新代码：

```
TileUpdateManager.CreateTileUpdaterForApplication().EnableNotificationQueue(true);

PeriodicUpdateRecurrence recurrence = PeriodicUpdateRecurrence.HalfHour;
List<Uri> urisToPoll = new List<Uri>();
urisToPoll.Add(new Uri(@"http://livetileservice2012.azurewebsites.net/api/liveupdate/1"));
urisToPoll.Add(new Uri(@"http://livetileservice2012.azurewebsites.net/api/liveupdate/2"));
TileUpdateManager.CreateTileUpdaterForApplication().StartPeriodicUpdateBatch(urisToPoll, recurrence); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:30:27.007

要扩展 Nathan 的评论，您可以采取以下两个步骤进行故障排除：

1.  将您的 URI 直接输入浏览器以查看返回的结果，并检查它们是否是正确的 XML。正如 Nathan 指出的那样，您的 URI 正在返回 JSON，磁贴更新管理器将忽略该 JSON。作为一个工作示例（我在我的 HTML/JS 书的第 13 章中使用），请尝试[http://programmingwin8-js-ch13-hellotiles.azurewebsites.net/Default.cshtml](http://programmingwin8-js-ch13-hellotiles.azurewebsites.net/Default.cshtml)。

2.  如果您认为您的 URI 正在返回正确的 XML，请在[推送和定期通知示例](http://code.msdn.microsoft.com/windowsapps/Push-and-periodic-de225603)中尝试（方案 4 和 5 用于磁贴和徽章）。如果这可行，那么错误将在您的应用程序代码中，而不是在服务中。

请注意，StartPeriodicUpdate[Batch] 将立即向服务发送请求，而不是等待第一个时间间隔过去。

此外，如果您认为该服务可能存在问题，则可以使用在 localhost 上运行的 Visual Studio Express for Web 单步执行其代码，而该应用程序也在 Visual Studio Express for Win8 中运行（启用了 localhost ）。

.克雷格

# android - 在 Android 中执行 API 调用

> ID：13594906
> 
> 赞同：0
> 
> 时间：2012-11-27T23:10:53.163
> 
> 标签：android, android-intent, android-emulator, android-widget

我正在尝试对地址进行 API 调用：apps.smilemachine.com/smilefactory/api/v1.0/speedup。我只想执行 url（上图），以便它增加机器并更改存储在 Smilemachine.com 的速度值？没什么特别的，我只需要执行 url，就好像您在任何浏览器的地址栏中输入它一样？

有没有人对此或代码片段有任何建议？

我当前的代码只是打开浏览器，请在下面找到：

```
increasespeed.setOnClickListener(new View.OnClickListener() {

    public void onClick(View view) {
        Intent increasespeed = new Intent(null, Uri.parse("http://apps.smilemachine.com/smilefactory/api/v1.0/speedup"));
                startActivity(increasespeed);

    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:17:05.063

只需通过 HTTP 连接获取它：

```
URL url = new URL("http://apps.smilemachine.com/smilefactory/api/v1.0/speedup");
HttpURLConnection connection = (HttpURLConnection)url.openConnection();
connection.setRequestMethod("GET");
connection.connect(); 
```

# json - 使用 Play 渲染 JSON！和斯卡拉

> ID：13594924
> 
> 赞同：6
> 
> 时间：2012-11-27T23:13:02.010
> 
> 标签：json, scala, playframework, playframework-2.0

我有一个关于从 Scala 类渲染 JSON 对象的简单问题。为什么我必须实现反序列化器（读，写）。

我有以下案例类：

```
case class User(firstname:String, lastname:String, age:Int) 
```

在我的控制器中：

```
val milo:User = new User("Sam","Fisher",23);

Json.toJson(milo); 
```

我收到编译错误：没有为类型 models.User 找到 Json 反序列化器。尝试为此类型实现隐式写入或格式。

在我之前的项目中，我必须在类中实现一个 reader、writer 对象才能工作，我觉得这很烦人。

```
object UserWebsite {
  implicit object UserWebsiteReads extends Format[UserWebsite] {

    def reads(json: JsValue) = UserWebsite(
      (json \ "email").as[String],
      (json \ "url").as[String],
      (json \ "imageurl").as[String])

    def writes(ts: UserWebsite) = JsObject(Seq(
      "email" -> JsString(ts.email),
      "url" -> JsString(ts.url),
      "imageurl" -> JsString(ts.imageurl)))
  }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-28T11:36:16.370

我真的建议升级到玩 2.1-RC1，因为在这里，JSON 写入器/读取器的定义非常简单（更多细节[在这里](http://mandubian.com/2012/09/08/unveiling-play-2-dot-1-json-api-part1-jspath-reads-combinators/)）

但是为了帮助你避免一些错误，我会给你一个关于导入的提示： - 只使用这些导入！（注意 json.Reads 不包括在内）

```
import play.api.libs.json._
import play.api.libs.functional.syntax._
import play.api.libs.json.Writes._ 
```

并且您只需要编写此代码即可向/从 Json 写入/读取您的课程（当然您将拥有`User`而不是`Address`：

```
implicit val addressWrites = Json.writes[Address]
implicit val addressReads = Json.reads[Address] 
```

现在，它们将被自动使用：

**写入**示例：

```
Ok(Json.toJson(entities.map(s => Json.toJson(s)))) 
```

**读取**示例（我通过从正文读取 json 来创建实体的 POST 示例）请注意`addressReads`此处使用

```
def create = Action(parse.json) { request =>
        request.body.validate(addressReads).map { entity =>
          Addresses.insert(entity)
          Ok(RestResponses.toJson(RestResponse(OK, "Succesfully created a new entity.")))
        }.recover { Result =>
          BadRequest(RestResponses.toJson(RestResponse(BAD_REQUEST, "Unable to transform JSON body to entity.")))
        }
} 
```

总之，他们尝试（并成功）使 JSON 的事情变得非常简单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T23:18:47.093

如果您使用的是 play 2.0.x，您可以这样做

```
import com.codahale.jerkson.Json._

generate(milo) 
```

generate 使用反射来做到这一点。

在 play 2.1 中，您可以使用 Json.writes 为您必须创建的隐式对象创建一个宏。无需运行时反射！

```
import play.api.libs.json._
import play.api.libs.functional.syntax._

implicit val userWrites = Json.writes[User]
Json.toJson(milo) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T14:41:41.620

我一直在我的项目中使用 jerkson（基本上是 jackson 的包装器）将对象转换为 json 字符串。

最简单的方法是：

```
import com.codehale.jerkson.Json._
...
generate(milo)
... 
```

如果您需要配置 ObjectMapper（例如添加自定义序列化器/反序列化器、配置输出格式等），您可以通过创建扩展`com.codehale.jerkson.Json`类的对象来完成。

```
package utils

import org.codehaus.jackson.map._
import org.codehaus.jackson.{Version, JsonGenerator, JsonParser}
import com.codahale.jerkson.Json
import org.codehaus.jackson.map.module.SimpleModule
import org.codehaus.jackson.map.annotate.JsonSerialize

object CustomJson extends Json {

  val module = new SimpleModule("CustomSerializer", Version.unknownVersion())

  // --- (SERIALIZERS) ---
  // Example:
  // module.addSerializer(classOf[Enumeration#Value], EnumerationSerializer)
  // --- (DESERIALIZERS) ---
  // Example:
  // module.addDeserializer(classOf[MyEnumType], new EnumerationDeserializer[MyEnumType](MyEnumTypes))

  mapper.setSerializationInclusion(JsonSerialize.Inclusion.NON_NULL)
  mapper.setSerializationConfig(mapper.getSerializationConfig.without(SerializationConfig.Feature.WRITE_NULL_MAP_VALUES))
  mapper.registerModule(module)
} 
```

要在您的代码中使用它：

```
import utils.CustomJson._
...
generate(milo)
... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-04T07:08:36.770

事实上，这很简单。首先导入：

```
import play.api.libs.json._ 
```

由于 User 是一个案例类，您可以使用 Json.writes[] 自动创建 Json 写入：

```
val milo:User = new User("Millad","Dagdoni",23)
implicit val userImplicitWrites = Json.writes[User]
Json.toJson(milo) 
```

我没有在文档中找到它，但这里是 api 的链接：[http ://www.playframework.com/documentation/2.2.x/api/scala/index.html#play.api.libs.json .json](http://www.playframework.com/documentation/2.2.x/api/scala/index.html#play.api.libs.json.Json) $

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-19T15:05:13.533

在你的情况下，我会使用 JSON.format 宏。

```
import play.api.libs.json._
implicit val userFormat = Json.format[User]
val milo = new User("Sam", "Fisher", 23)
val json = Json.toJson(milo) 
```

# c - 'ioctl' 的 libboss 静态声明遵循非静态声明

> ID：13594926
> 
> 赞同：0
> 
> 时间：2012-11-27T23:13:10.840
> 
> 标签：c, macos, gcc, compilation, compiler-errors

我正在尝试编译一个包含 libboss 文件的程序，但是当我编译时出现以下错误。

```
In file included from test.c:1:
/opt/local/include/liboss/soundcard.h:342: error: static declaration of ‘ioctl’ follows non-static declaration
/usr/include/sys/ioctl.h:97: error: previous declaration of ‘ioctl’ was here
/opt/local/include/liboss/soundcard.h:353: error: static declaration of ‘open’ follows non-static declaration
/usr/include/sys/fcntl.h:464: error: previous declaration of ‘open’ was here
/opt/local/include/liboss/soundcard.h:363: error: static declaration of ‘close’ follows non-static declaration
/usr/include/unistd.h:476: error: previous declaration of ‘close’ was here
/opt/local/include/liboss/soundcard.h:366: error: conflicting types for ‘write’
/usr/include/unistd.h:535: error: previous declaration of ‘write’ was here 
```

第一个错误发生的行就是这个。

@声卡.h

```
static inline int LIBOSS_IOCTL (int x, unsigned long y,...)
{
    int result;

    va_list l;
    va_start(l,y);
    result = liboss_ioctl(x,y,l);
    va_end (l);
    return result;
} 
```

@ioctl.h

```
__BEGIN_DECLS
int ioctl(int, unsigned long, ...);
__END_DECLS 
```

有什么方法可以让我对 soundcard.h 进行猴子补丁，这样就不会出现问题了？

谢谢！一个。

规格：Mac OSX 10.7.4，gcc i686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:02:36.983

这听起来像是试图通过重新定义函数以在内核不支持的情况下提供 OSS操作来`liboss`在非本机系统上提供与 oss 兼容的声卡接口。如果是这种情况，您需要确保（或任何可能包含它的标头）不会包含在使用.`ioctl``ioctl``sys/ioctl.h``soundcard.h`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-31T15:51:04.817

只需添加`static`、`/usr/include/sys/ioctl.h:97`和`/usr/include/sys/fcntl.h:464`（`/usr/include/unistd.h:476`并`/usr/include/unistd.h:535`在编译后再次撤消这些更改）。

在`/opt/local/include/liboss/soundcard.h:366`替换`int`为`ssize_t`.

```
# add static
sudo nano +97 /usr/include/sys/ioctl.h
- int  ioctl(int, unsigned long, ...);
+ static int  ioctl(int, unsigned long, ...);

# replace int by ssize_t
sudo nano +366 /opt/local/include/liboss/soundcard.h
- static inline int LIBOSS_WRITE (int x, const void *y, size_t l)
+ static inline ssize_t LIBOSS_WRITE (int x, const void *y, size_t l) 
```

# google-app-engine - 带有@OneToMany的谷歌appengine上的jpa @version：appengine错误或使用错误？

> ID：13594931
> 
> 赞同：1
> 
> 时间：2012-11-27T23:13:33.510
> 
> 标签：google-app-engine, jpa, datanucleus

我一直在 appengine 上遇到 jpa @version 问题（在 eclipse 中测试，sdk 最新版本，DataNucleus v2 - AKA 3.1.1），所以我编写了一个测试 servlet 来尝试以简单的形式重现该问题。结果的行为比原始代码更加怪异，在我看来它好像是一个错误，但我希望有几个眼球可以检查一下我没有做一些愚蠢的事情。

设置非常简单：一个单例主 @Entity 类，其中包含一个子 @Entity 列表的 OneToMany 映射（尽管在所描述的测试中我只创建了一个）。这里：

```
@Entity
public class MainEntity implements Serializable {
    private static final long serialVersionUID = 1L;

    protected static Key singletonKey =
         KeyFactory.createKey(MainEntity.class.getSimpleName(), 1);

    // Primary Key
    @Id
    protected Key id = singletonKey;

    // Use optimistic locking
    @Version
    protected long version;

    // Ref to sub entity, LAZY to be explicit
    @OneToMany(cascade=CascadeType.ALL, fetch=FetchType.LAZY, orphanRemoval=true)
    protected List<SubEntity> subs = new ArrayList<SubEntity>();
}

@Entity
public class SubEntity implements Serializable {
    private static final long serialVersionUID = 1L;

    // Primary Key
    @Id
    protected Key id;

    // Use optimistic locking
    @Version
    protected long version;

    // Get variable part of key
    public String getKey() { return id.getName(); }

    // Set variable part of key
    public void setKey(String key) {
            id = KeyFactory.createKey(MainEntity.singletonKey,
                                      SubEntity.class.getSimpleName(), key);
    }

    // Pretend contents
    protected int contents;

    // modifier for contents
    public void incContent(int step) { contents += step; }
} 
```

所以，我所做的是创建 MainEntity 的实例和 SubEntity 的实例，并将 SubEntity 添加（）到 MainEntity.subs 并提交所有内容。然后，每次使用新的 EntityManager 时，我都会获取MainEntity 的*两个*分离实例（加载了 subs 的内容），修改它们的内容字段，然后分别将它们合并（）回来。

我期望看到的是第一次合并通过 OK，第二次合并抛出异常。

实际发生的情况是两个合并都通过 OK（因此后备存储具有内容字段的第二个版本），但版本字段在 SubEntity 上仍然为 1，但在 MainEntity 上为 3。（！）我不明白为什么 main 更新了它的版本号，为什么它没有抛出异常，因为 MainEntity 正在使用不正确的版本号进行更新，为什么子实体没有导致锁定异常，以及更普遍的情况。

那么，我是否误解了某些内容或似乎存在错误？

非常感谢您的任何评论。

乔纳森。

这是主要代码的业务部分（非常轻微地清理过）：

```
private static final EntityManagerFactory emf =
    Persistence.createEntityManagerFactory("general_use");

private void doG(PrintWriter out) {
    // First make sure db is empty
    resetDb(out);

    // Create default contents
    initDb(out, 1);

    // Get the main entity, detached
    MainEntity m1 = fetch(out);

    // Get another version
    MainEntity m2 = fetch(out);

    // Modify both versions of the sub entity in the detached copies
    m1.subs.get(0).incContent(2);
    m2.subs.get(0).incContent(3);

    // Merge them back into db
    merge(out, m1);

    // See what's in the db
    fetch(out);

    // Merging the second one should cause an OptimisticLockException
    try {
        merge(out, m2);
        out.format("We should have gotten an exception here.");
    } catch (Throwable th) {
        out.format("We got an exception here: %s, %s", th, th.getCause());
    }

    // Look at db
    fetch(out);

}

// This gets the MainEntity from the db by its key
private MainEntity fetch(PrintWriter out) {
    EntityManager em = emf.createEntityManager();
    em.getTransaction().begin();
    MainEntity m = em.find(MainEntity.class, MainEntity.singletonKey);
    m.toString();    // Make sure that nothing is lazily fetched.
    // MainEntity has a toString() defined on it that uses all the fields
    // in itself and the contents of subs, so this loads everything
    em.getTransaction().commit();
    em.close();
    out.format("Fetch completed, detached state: %s", m);
    return m;
}

// This merges a detached MainEntity and its related sub entity into the db
private void merge(PrintWriter out, MainEntity mp) {
    MainEntity m;
    out.format("Merge commenced, detached state: %s", mp);
    EntityManager em = emf.createEntityManager();
    em.getTransaction().begin();
    m = em.merge(mp);
    out.format("Merge pre commit, attached state: %s", m);
    // as above, m.toString() in the format in fact loads everything
    em.getTransaction().commit();
    em.close();
    out.format("Merge completed, detached state: %s", m);
}

// This creates the singleton MainEntity and a number of SubEntitys with keys "Init db #n" which it points to
private void initDb(PrintWriter out, int noSubCopies) {
    EntityManager em = emf.createEntityManager();
    em.getTransaction().begin();
    MainEntity m = new MainEntity();
    em.persist(m);
    em.getTransaction().commit();
    em.close();

    em = emf.createEntityManager();
    em.getTransaction().begin();
    m = em.find(MainEntity.class, m.id);
    for (int i = 0; i < noSubCopies; i++) {
        SubEntity s = new SubEntity();
        s.setKey("Init db #" + i);
        em.persist(s);
        m.subs.add(s);
    }
    m.toString();
    em.getTransaction().commit();
    em.close();
    out.format("InitDb completed, detached state: %s", m);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T16:02:30.240

我会说这可能是加载“subs”字段中的一个错误。在找到“main”之后（在提交/关闭之前），检查它是否在 main 和 subs 上设置了版本。您也可以使用*JDOHelper.getVersion(obj)*因为这将显示对象的版本，而不是字段值。我没有看到 GAE 插件中的任何代码在所有情况下都可以肯定地设置版本。

如果`JDOHelper.getVersion(sub)`or在 txn 内（分离前）返回 null，请在[http://code.google.com/p/datanucleus-appengine/issues/list](http://code.google.com/p/datanucleus-appengine/issues/list)`JDOHelper.getVersion(main)`将其报告为错误

# android - NETWORK_PROVIDER 未提供更新的位置

> ID：13594932
> 
> 赞同：48
> 
> 时间：2012-11-27T23:13:34.717
> 
> 标签：android, geolocation, locationmanager

```
LocationManager locationManager = (LocationManager)getApp().getSystemService(Context.LOCATION_SERVICE); //getApp() returns my Application object
locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER , 1, 1, this);
locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 1, 1, this); 
```

这就是我用来收听的代码。启用 GPS 后，一切正常。但是，如果我禁用 GPS 并依赖网络位置，它会给我带来陈旧的结果——在这种情况下，是两天前的结果。我无法让它更新。调用 getLastKnownLocation 返回相同的陈旧结果。

谷歌地图更新很好，所以我知道这不是硬件/系统配置问题。

我用谷歌搜索，发现一些人有类似的问题，但没有答案。我尝试将我的项目定位到 API 级别 8 (2.2) 和 15 (4.0.3)。结果相同。我的手机正在运行 ICS。

我还尝试删除对 GPS_PROVIDER 的请求，以及在 getAllProviders() 中包含对所有内容的请求。同样的交易。

知道为什么 NETWORK_PROVIDER 没有更新吗？任何帮助将不胜感激。

（PS 不，我通常不使用“1, 1”作为时间/距离参数；我只是在调试时更改了它。）

编辑：我忘了提到是的，isProviderEnabled() 返回 true。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-07-30T21:25:35.997

我终于找到了解决这个问题的方法（请参阅[我的问题here](https://stackoverflow.com/questions/17734904/using-google-maps-location-without-activity)）。

在我的 S3 Galaxy Mini 上，有类似的症状（在重新启动之前没有位置更新......），就像上面描述的那样。大多数情况下，当设备达到低电量条件时，位置信息就会停止更新，但有时即使手机充满电，也会发生这种情况。显然这是在某处的问题`LocationManager`。我设法`LocationManager`通过使用新的 Google Play Services API 来绕过位置（`LocationClient`类）。

这可能是位置更新仍在使用 Google 地图的原因，因为 Google 地图甚至在公开之前就使用了 Google Play 服务 API。

我建议您点击 [此链接](https://developer.android.com/training/location/retrieve-current.html)，该链接展示了如何使用 Play Services API 来获取位置，而不是在`LocationManager`遇到此问题时使用。

我正在使用 Play Services 运行位置更新，并且绝对没有这样的问题 - 我随时都会收到定期的位置更新。

**请注意**，这将要求用户必须在其设备上安装 Google Play，因此 Kindle 等设备将不适用。它还需要至少 Android 2.2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-15T17:51:59.937

I currently suspect it is caused by not using `removeUpdates(listener)` on app shutdown or activity ondestroy. I have made sure to implement that and hope it fixes it. I can't think of anything else.

--edit-- This did not fix it unfortunately.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-09T12:27:51.397

如果您正在使用新手机，您必须检查您是否已接受谷歌地图应用程序中的所有协议 - 否则您将不会收到来自 NETWORK_PROVIDER 的任何更新。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-07-27T14:10:00.447

1）首先您检查您是否已授予上述建议的权限。2）您必须确保您的手机可以上网。3）请找到下面的代码。

```
public void getLocationByNetworkProvider()
{       
    LocationManager locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 10000, 10, new LocationListener() {
        public void onStatusChanged(String provider, int status, Bundle extras) {
            // TODO Auto-generated method stub

        public void onProviderEnabled(String provider) {
            // TODO Auto-generated method stub

        }

        public void onProviderDisabled(String provider) {
            // TODO Auto-generated method stub

        }

        public void onLocationChanged(Location location) {
         location.getLatitude();                                location.getLongitude();

        }
    });     

}` 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2013-08-16T10:30:49.343

您可以像这样使用更新位置。Locationlistener 将用于位置....

```
import android.os.Bundle;
import android.app.Activity;
import android.content.Context;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.widget.TextView;

import android.util.Log;

public class MainActivity extends Activity implements LocationListener{

protected LocationManager locationManager;
protected LocationListener locationListener;
protected Context context;
TextView txtLat;
String lat;
String provider;
protected String latitude,longitude;
protected boolean gps_enabled,network_enabled;

@Override
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);

txtLat = (TextView) findViewById(R.id.textview1);

locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, this);
}

@Override
public void onLocationChanged(Location location) {

txtLat = (TextView) findViewById(R.id.textview1);
txtLat.setText("Latitude:" + location.getLatitude() + ", Longitude:" +      location.getLongitude());

}

@Override
public void onProviderDisabled(String provider) {
Log.d("Latitude","disable");
}

@Override
public void onProviderEnabled(String provider) {
Log.d("Latitude","enable");
}

@Override
public void onStatusChanged(String provider, int status, Bundle extras) {
Log.d("Latitude","status");
}

} 
```

# python - 具有不可提取对象的 Python 多处理

> ID：13594934
> 
> 赞同：2
> 
> 时间：2012-11-27T23:13:36.717
> 
> 标签：python, concurrency, process, multiprocessing, pickle

目标：

*   使用带有线程或进程的 SQLAlchemy 在数据库中运行约 40 个大型查询，将相应的 SQLA [ResultProxies](http://docs.sqlalchemy.org/en/rel_0_7/core/connections.html#sqlalchemy.engine.base.ResultProxy)放入 Queue.Queue （由[multiprocessing.Manager 处理](http://docs.python.org/library/multiprocessing.html#managers)）
*   同时，将结果写入 .csv 文件，其中包含多个消耗所述队列的进程

当前状态：

*   运行查询和写入数据的 QueryThread 和 WriteThread 类；由于查询需要一些时间来运行，因此 GIL 处理线程的方式不会造成显着的性能损失
*   另一方面，编写文件需要很长时间；事实上，即使最初的想法是运行 WriteThread 类的多个线程，但使用单个线程可以获得最佳性能。

因此产生了使用多处理的想法；我希望能够同时写入输出，而不是受 CPU 限制，而是受 I/O 限制。

抛开背景不谈，这是一个问题（本质上是一个设计问题）——[多处理库](http://docs.python.org/2.7/library/multiprocessing.htm)的工作原理是酸洗对象，然后将数据输送到其他衍生的进程；但是我尝试在 WriteWorker 进程中使用的 ResultProxy 对象和共享队列不可提取，这会导致以下消息（不是逐字记录，但足够接近）：

```
pickle.PicklingError: Can't pickle object in WriteWorker.start() 
```

因此，对您有帮助的人来说，问题是，**关于可以避免这个问题的潜在设计模式或方法的任何想法？**这似乎是一个简单的、经典的生产者-消费者问题，我想解决方案很简单，我只是想多了

任何帮助或反馈表示赞赏！谢谢 ：）

**编辑**：这是一些相关的代码片段，如果我可以提供任何其他上下文，请告诉我

从父类：

```
#init manager and queues
self.manager = multiprocessing.Manager()
self.query_queue = self.manager.Queue()
self.write_queue = self.manager.Queue()

def _get_data(self):
    #spawn a pool of query processes, and pass them query queue instance
    for i in xrange(self.NUM_QUERY_THREADS):
        qt = QueryWorker.QueryWorker(self.query_queue, self.write_queue, self.config_values, self.args)
        qt.daemon = True
        # qt.setDaemon(True)
        qt.start()

    #populate query queue
    self.parse_sql_queries()

    #spawn a pool of writer processes, and pass them output queue instance
    for i in range(self.NUM_WRITE_THREADS):
        wt = WriteWorker.WriteWorker(self.write_queue, self.output_path, self.WRITE_BUFFER, self.output_dict)
        wt.daemon = True
        # wt.setDaemon(True)
        wt.start()

    #wait on the queues until everything has been processed
    self.query_queue.join()
    self.write_queue.join() 
```

并来自 QueryWorker 类：

```
def run(self):
    while True:
        #grabs host from query queue
        query_tupe = self.query_queue.get()
        table =  query_tupe[0]
        query = query_tupe[1]
        query_num = query_tupe[2]
        if query and table:
            #grab connection from pool, run the query
            connection = self.engine.connect()
            print 'Running query #' + str(query_num) + ': ' + table
            try:
                result = connection.execute(query)
            except:
                print 'Error while running query #' + str(query_num) + ': \n\t' + str(query) + '\nError: '  + str(sys.exc_info()[1])

            #place result handle tuple into out queue
            self.out_queue.put((table, result))

        #signals to queue job is done
        self.query_queue.task_done() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T17:13:55.560

简单的答案是避免直接使用 ResultsProxy。而是使用 cursor.fetchall() 或 cursor.fetchmany(number_to_fetch) 从 ResultsProxy 获取数据，然后将数据传递到多处理队列中。

# c - 如何在 C 中找到动态分配的数组的大小？

> ID：13594935
> 
> 赞同：2
> 
> 时间：2012-11-27T23:13:37.623
> 
> 标签：c, arrays, size, sizeof, dynamic-memory-allocation

我制作了一个由循环动态分配的数组。然后是一个从数组中读取数字的循环，但我需要知道数组的大小。该数组正确且完全正常工作，并且其中包含正确的值。我这样定义数组：

```
int *array; 
```

现在当我想使用它时它不会工作，因为我使用的是指针：

```
int size = sizeof(array)/sizeof(array[0]); 
```

我该如何修复它以便它与我的指针一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:18:45.273

我假设您正在使用 new 或 malloc/calloc 之一分配数组。在这种情况下，你不能这样做。您需要在另一个变量中跟踪大小或使用为您跟踪大小的结构。

# c# - 使用 C# 中的组合框加载表单中的“System.Data.DataRowView”

> ID：13594938
> 
> 赞同：0
> 
> 时间：2012-11-27T23:13:57.657
> 
> 标签：c#, winforms

每次我的表单加载/打开时，它都会提示“System.Data.DataRowView”，我怎样才能删除它？

这是我的代码：

```
 {
        InitializeComponent();
        GetProcessorCardTypes();
    }

    private void GetProcessorCardTypes()
    {
        cn.Open();

        MySqlCommand cmd = new MySqlCommand("call GetProcessorMethod(1)", cn);
        MySqlDataAdapter adapter = new MySqlDataAdapter(cmd);
        DataTable dt = new DataTable();
        adapter.Fill(dt);

        cmbProcessorMethods.DataSource = dt;
        cmbProcessorMethods.ValueMember = "method_id";
        cmbProcessorMethods.DisplayMember = "method_name";
    }

    private void cmbProcessorMethods_SelectedIndexChanged(object sender, EventArgs e)
    {
        MessageBox.Show(cmbProcessorMethods.SelectedValue.ToString());
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:19:39.613

如果要完全删除消息框，请删除`cmbProcessorMethods_SelectedIndexChanged`事件处理程序。或者您可以将其更改为显示`method_name`所选行：

```
private void cmbProcessorMethods_SelectedIndexChanged(object sender, EventArgs e)
{
     DataRowView row = (DataRowView)cmbProcessorMethods.SelectedItem;
     MessageBox.Show(row["method_name"].ToString());
} 
```

* * *

正如 Derek 所指出的，只需在分配数据源之前设置`DisplayMember`和属性，您的原始代码就可以工作：`ValueMember`

```
cmbProcessorMethods.ValueMember = "method_id";
cmbProcessorMethods.DisplayMember = "method_name";
cmbProcessorMethods.DataSource = dt; 
```

# php - PHP Curl 连接到亚马逊 MWS 卖家 API

> ID：13594939
> 
> 赞同：2
> 
> 时间：2012-11-27T23:13:59.170
> 
> 标签：php, ssl, curl, amazon-mws

我正在尝试通过 PHP 的 Curl 库向亚马逊卖家 API 的 ListOrders 函数发送请求。我可以连接，但我从他们的服务中收到 AccessDenied 错误。文档说这意味着我试图在没有 HTTPS 的情况下进行连接，但我连接的 url 是[https://mws.amazonservices.com/](https://mws.amazonservices.com/)

这是我的卷曲请求

```
private function send_request()
{
        $string = '';
        $count = 0;
        foreach ($this->options as $k => $v)
            {
            $string .= rawurlencode($k) . "=" . rawurlencode($v);
            $string .= ($count == count($this->options) -1)? '': "&";
            $count++;
            }
        $options = array(
                CURLOPT_CAINFO=> <<Cert location>>,
                CURLOPT_RETURNTRANSFER=>true,
                CURLOPT_POST=>true,
                CURLOPT_PORT=>443,
                CURLOPT_POSTFIELDS=> $string,
                CURLOPT_SSL_VERIFYHOST=>2,
                CURLOPT_SSL_VERIFYPEER=> TRUE,
                CURLOPT_FOLLOWLOCATION => 1,
                CURLOPT_VERBOSE => 1,
                CURLOPT_HEADER=>true,
                CURLOPT_PROTOCOLS=> CURLPROTO_HTTPS,
                CURLINFO_HEADER_OUT=>true
        );
        $session = curl_init($this->url);
        curl_setopt_array($session, $options);
        $results = curl_exec($session);
        $errors = curl_error($session);
        $info = curl_getinfo($session);
        curl_close($session);
        echo htmlentities($results);//var_dump($errors);
        echo "<br /><br />";
        print_r($info);
        return $results;
} 
```

我得到的错误是：

```
<?xml version="1.0"?> <ErrorResponse xmlns="https://mws.amazonservices.com/Orders/2011-01-01">
 <Error> 
    <Type>Sender</Type> 
    <Code>AccessDenied</Code> 
    <Message>Access to Orders.ListOrders is denied</Message> 
</Error> 
<RequestID>4e60baef-b2a4-44aa-a18f-dd6fe8b07cf5</RequestID> </ErrorResponse> 
```

我的卷曲信息打印输出是：

```
 Array
(
    [url] => https://mws.amazonservices.com/Orders/2012-11-27
    [content_type] => text/xml
    [http_code] => 401
    [header_size] => 362
    [request_size] => 494
    [filetime] => -1
    [ssl_verify_result] => 0
    [redirect_count] => 0
    [total_time] => 1.42
    [namelookup_time] => 0.016
    [connect_time] => 0.078
    [pretransfer_time] => 1.342
    [size_upload] => 345
    [size_download] => 310
    [speed_download] => 218
    [speed_upload] => 242
    [download_content_length] => 310
    [upload_content_length] => 345
    [starttransfer_time] => 1.42
    [redirect_time] => 0
    [certinfo] => Array
        (
        ) 
```

我的数据针对请求的格式正确（签名有效等）。这个问题是我从非 SSL 保护站点发出此请求的结果（即使我正在连接到他们的 https 站点），还是我还缺少其他东西？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T16:26:56.793

由于元素标签中的错误，访问被拒绝。亚马逊文档指出您可以使用 Merchant 或 SellerId，我使用的是 Merchant，并且需要 SellerId。上面的脚本正确地将请求发送到亚马逊。

# jquery - 解析简单的 JSON 错误

> ID：13594940
> 
> 赞同：1
> 
> 时间：2012-11-27T23:14:05.813
> 
> 标签：jquery, html, json, last.fm

我正在尝试解析一些简单的 JSON 数据并提取某些部分以显示为 HTML。除了我的 Last.fm JSON 数据有一个孩子之外，一切都很顺利`recenttracks.track.artist_text`

文本没有被正确翻译或拾取并且（因为我是新手）无法弄清楚为什么？我相信的原因与`_`最后一个孩子之前的下划线有关。

除此之外，一切都运行良好。

```
<script type="text/javascript">
$.getJSON("http://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks&user=foo&api_key=bar&format=json&limit=1", function(json) {
  alert("JSON Data: " + json.recenttracks.track.artist._text);
});
</script> 
```

任何想法我做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:20:07.913

查看生成的 JSON，您似乎需要访问：

```
json.recenttracks.track.artist['#text'] 
```

在这里，我使用括号语法来获取最后一个属性`#text`。我看不到你从哪里得到下划线，`_text`因为它在 JSON 中显示为`#text`.

# php - wordpress中的html导航菜单

> ID：13594942
> 
> 赞同：-1
> 
> 时间：2012-11-27T23:14:17.470
> 
> 标签：php, wordpress

我在 wordpress 中使用 html 导航栏

我的 html 导航条码

```
 <li class="active">
                        <a href="http://www.siteurl.com/shop/" class="active">
                            <i class="icon-nav icon-home"></i>
                            Home
                        </a>
                    </li>
                    <li>
                        <a href="http://www.siteurl.com/shop/?page_id=172">
                            <i class="icon-nav icon-star"></i>
                            About </a>
                                               </li>
                    <li>
                        <a href="http://www.siteurl.com/shop/?page_id=176">
                            <i class="icon-nav icon-th-large"></i>
                            Gallery</a>
                                               </li>
                    <li>
                        <a href="http://www.siteurl.com/shop/?page_id=174">
                            <i class="icon-nav icon-comments"></i>
                            Services</a>
                                               </li>
                    <li>
                        <a href="http://www.siteurl.com/shop/?page_id=4">
                            <i class="icon-nav icon-shopping-cart"></i>
                            Shop</a>
                                               </li>
                    <li>
                        <a href="http://www.siteurl.com/shop/?page_id=187">
                            <i class="icon-nav icon-pencil"></i>
                            Blog</a></li>

                    <li>
                        <a href="http://www.siteurl.com/shop/?page_id=145">
                            <i class="icon-nav icon-plus-sign"></i>
                            Events</a></li>
                    <li>
                        <a href="http://www.siteurl.com/shop/?page_id=178">
                            <i class="icon-nav icon-map-marker"></i>
                            Contact</a>

                    </li>
                </ul> 
            </nav> 
```

我试图为每个页面创建一个条件标签，如下面的主页示例

```
 <?php if ( is_home() ) { ?>
           <li class="active">
                        <a href="http://www.siteurl.com/shop/" class="active">
                            <i class="icon-nav icon-home"></i>
                            Home
                        </a>
                    </li>
    <?php } else { ?>
                    <li>
                        <a href="http://www.siteurl.com/shop/" >
                            <i class="icon-nav icon-home"></i>
                            Home
                        </a>
                    </li> 
```

但这不起作用当我们查看相应页面时如何激活菜单图标如果我使用直接 html 导航菜单

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T13:32:07.023

除了阅读 Codex (essential)，您还可以搜索[教程、文章和问答](https://www.google.com/search?q=wp_nav_menu%20icons)，有很多。

### [带有图标和活动项目突出显示的 WordPress Wp_Nav_Menu](http://www.1stwebdesigner.com/wordpress/wordpress-wp-nav-menu-tutorial/)

> 我们将做：
> 
> *   我们 wp_nav_menu 中的主页链接始终获取当前博客网址
> *   根据需要自定义每个菜单项
> *   在我们的菜单中放置漂亮的图标
> *   活动项目突出显示

### [功能检查：wp_nav_menu](http://wp.tutsplus.com/tutorials/creative-coding/function-examination-wp_nav_menu/)

> 在本教程中，我们将深入研究该 `wp_nav_menu`函数可以做的所有事情，使用[Walker 类](http://wp.tutsplus.com/tutorials/creative-coding/understanding-the-walker-class/)添加子描述，并触及它的一些相关函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:26:06.460

唯一的方法是使用 wordpress 导航系统

`http://codex.wordpress.org/Function_Reference/wp_nav_menu`

他们的系统已经做了很多工作，所以你没有理由想要复制它。

# php - 简单的 WordPress “wp_head” 动作钩子

> ID：13594944
> 
> 赞同：1
> 
> 时间：2012-11-27T23:14:23.333
> 
> 标签：php, html, css, wordpress

有一个让我发疯的问题，原因是它应该是一个非常简单的修复，基本上在我的“footer.php”文件中，我需要在“wp_head”钩子中添加一些 CSS 行。我期望的工作是这样的：

```
<?php function footer_widgets() { ?>
<style type="text/css">
#footer {
    border-top:0 !important;
    margin-top:0 !important;
    padding-top:0 !important;
}
</style>
<?php } add_action('wp_head', 'footer_widgets');?> 
```

这什么也没做，奇怪的是如果我将钩子从“wp_head”更改为“wp_footer”，它会输出到该钩子，但这**需要**在“wp_head”中。

如果有人知道如何解决这个问题，将不胜感激。干杯，汤姆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:50:58.133

在普通页面上，直到 after 运行后才会包含您的 footer.php `wp_head`。`get_footer()`在您的模板中看到了吗？这就是这段代码运行的时候。您需要将此代码包含在页面生命周期早期加载的文件中（例如functions.php）。

# java - RESTful Web 服务如何正确生成 JSON？

> ID：13594945
> 
> 赞同：20
> 
> 时间：2012-11-27T23:14:22.780
> 
> 标签：java, json, web-services, rest, jersey

我是第一次编写 Web 服务。我创建了一个基于[Jersey](http://jersey.java.net)的 RESTful Web 服务。我想**生成 JSON**。我需要做什么来生成我的 Web 服务的正确 JSON 类型？

这是我的一种方法：

```
@GET
@Path("/friends")
@Produces("application/json")
public String getFriends() {
    return "{'friends': ['Michael', 'Tom', 'Daniel', 'John', 'Nick']}";
} 
```

`@Produces("application/json")`我只是为我的方法指出注释就足够了吗？那么这个方法可能返回任何类型的对象呢？还是只有字符串？我需要对这些对象进行额外的处理或转换吗？

请帮助我作为初学者处理这些问题。提前致谢！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-27T23:37:49.863

您可以使用 jaxb 注释来注释您的 bean。

```
 @XmlRootElement
  public class MyJaxbBean {
    public String name;
    public int age;

    public MyJaxbBean() {} // JAXB needs this

    public MyJaxbBean(String name, int age) {
      this.name = name;
      this.age = age;
    }
  } 
```

然后您的方法将如下所示：

```
 @GET @Produces("application/json")
   public MyJaxbBean getMyBean() {
      return new MyJaxbBean("Agamemnon", 32);
   } 
```

最新文档中有一章涉及此问题：

[https://jersey.java.net/documentation/latest/user-guide.html#json](https://jersey.java.net/documentation/latest/user-guide.html#json)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-28T08:55:37.977

您可以使用像 org.json [http://www.json.org/java/这样的包](http://www.json.org/java/)

因为您将需要更频繁地使用 JSONObjects。

在那里，您可以轻松地创建 JSONObjects 并在其中放入一些值：

```
 JSONObject json = new JSONObject();
 JSONArray array=new JSONArray();
    array.put("1");
    array.put("2");
    json.put("friends", array);

    System.out.println(json.toString(2));

    {"friends": [
      "1",
      "2"
    ]} 
```

**编辑**这样做的好处是您可以在不同的层中构建响应并将它们作为对象返回

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-07-12T06:37:10.410

```
@GET
@Path("/friends")
@Produces(MediaType.APPLICATION_JSON)
public String getFriends() {

    // here you can return any bean also it will automatically convert into json 
    return "{'friends': ['Michael', 'Tom', 'Daniel', 'John', 'Nick']}";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-09T12:01:53.753

```
@POST
@Path ("Employee")
@Consumes("application/json")
@Produces("application/json")
public JSONObject postEmployee(JSONObject jsonObject)throws Exception{
    return jsonObject;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-11T20:07:46.427

使用此注释

```
@RequestMapping(value = "/url", method = RequestMethod.GET, produces = {MediaType.APPLICATION_JSON}) 
```

# python - 将 unicode 表示与符号进行比较

> ID：13594946
> 
> 赞同：4
> 
> 时间：2012-11-27T23:14:35.320
> 
> 标签：python, regex, unicode

我有一个包含大量句子的数据文件，编码如下：

"Gib mir bitte Erk\u00e4ltung"

我还有一个包含大量关键字的数据文件，编码如下：

“Erkältung”

我想在句子中搜索关键字，然后以“Erkältung”格式将它们写到一个文件中。

我如何将 \u00e4 转换为 ä 而不必这样做：

String.replace('\u00e4', 'ä')

更确切地说，我想让它在 Python 2.6 中返回一个匹配项：

（#编码：utf-8）

```
sentence = "Gib mir bitte Erk\u00e4ltung"

keyword = "Erkältung"

re.search(keyword, line) 
```

有什么提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T23:39:54.630

Python 内置了一些方便的字符编码转换。在这种情况下，这`unicode_escape`就是你想要的。当您阅读句子时，在进行搜索之前将其转换如下：

```
# Original sentence:

>>> s = "Gib mir bitte Erk\u00e4ltung"

>>> print s
Gib mir bitte Erk\u00e4ltung

>>> print repr(s)
'Gib mir bitte Erk\\u00e4ltung'

# Converted sentence:

>>> sc = s.decode('unicode_escape')

>>> print sc
Gib mir bitte Erkältung

>>> print repr(sc)
u'Gib mir bitte Erk\xe4ltung' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T23:47:09.400

要读取带有`\u00e4`编码字符的文件，请使用

```
fp = open('sentence.txt', 'r')
sentence = fp.read().decode('unicode-escape')
fp.close()
print repr(sentence) # -> u'Gib mir bitte Erk\xe4ltung' 
```

然后读取文件而不转义：

```
import codecs
fp = codecs.open('keyword.txt', 'r', encoding='utf-8')
keyword = fp.read()
fp.close()
print repr(keyword) # -> u'Erk\xe4ltung' 
```

然后你有两个相同的格式

```
fp = codecs.open('result.txt', 'a', encoding='utf-8')
if re.search(keyword, sentence, re.UNICODE) :
    fp.write(sentence)
fp.close() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T23:48:29.477

非正则表达式解决方案（首选）：

```
s = s.decode('unicode_escape') 
```

正则表达式解决方案：

```
s = re.sub(r'\\u([a-fA-F0-9]{4})', lambda m: unichr(int(m.group(1), 16)), s) 
```

# php - 将多个 URL 传递到 PHP 脚本中

> ID：13594950
> 
> 赞同：0
> 
> 时间：2012-11-27T23:14:47.877
> 
> 标签：php, wordpress, api

我有这个脚本，它将为通过它的任何 URL 生成缩略图（即 my_script.php?url=http://www.google.com

它可以工作，但我想修改它，以便我可以通过它传递大量（2,100）个 URL，并为每个 URL 生成一个屏幕截图。它也已经将这些图像保存在单独的文件夹中。

以下是相关代码：

```
// If we're requesting
if ($_GET['auth'] == 'todc_admin') {
    if (isset($_GET['id'])) {
        $wb = new WebThumb();
        $wb->setApi("API-KEY-HERE");
        $job = $wb->requestThumbnail($_GET['url']);
        $job_id = $job[0]['id'];
        while (true) {
            $job_status = $wb->requestStatus($job_id);
            $status = $job_status['status'];
            if ($status == "Complete") {
                break;
            } else {
                sleep(5);
                continue;
            }
        }
        // Image generated so lets save it
        //header("Content-type: image/jpeg");
        $wb = new WebThumb();
        $wb->setApi("API-KEY-HERE");
        $filename = ABSPATH . todc_design_dir($_GET['id']) .'/thumbnail.jpg';
        $imgurl = todc_design_dir($_GET['id']) .'/thumbnail.jpg';
        $content = $wb->getThumbnail($job_id, "large");
        if (file_put_contents($filename, $content)) {
            echo '<img src="http://www.myurl.com'. $imgurl .'" />';
        }
    }
} 
```

我还能够生成我需要创建缩略图以使用它的所有 url 的列表：

```
$designs = get_posts( array('post_type' => 'design', 'post_status' => 'publish', 'orderby' => 'date', 'showposts' => -1) );

    foreach($designs as $design) { 

            $previewlink = get_bloginfo('wpurl') . todc_design_dir($design->ID) 
```

然后在我需要的地方回显 $previewlink。

我只是在努力将两者结合在一起。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:19:39.670

您可以将 url 作为 json 编码的数组传递，然后[`json_decode`](http://php.net/manual/en/function.json-decode.php)将其放入脚本中的数组中。然后，您将使用 for-each 来遍历每个 url。

此外，您应该对如此大量的数据使用 POST，因为 GET 具有最大数据大小限制。

```
$urls = json_decode($_POST['url']);
foreach ($urls as $url) {
    $job = $wb->requestThumbnail($url);
    // rest of code
} 
```

您可能还需要增加脚本的最大执行时间，具体取决于处理 100 个 url 需要多长时间；用于[`set_time_limit(int $seconds)`](http://php.net/manual/en/function.set-time-limit.php)此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:18:52.443

第一个想法是，这听起来过程密集。通过您的网络浏览器执行此操作很容易让 php 在内存和时间限制上达到最大值。更好的选择可能是将 url 存储在数据库中并将批处理作为分叉进程运行。

# gpuimage - 使用 GPUImage 从视频中提取帧

> ID：13594951
> 
> 赞同：1
> 
> 时间：2012-11-27T23:14:53.327
> 
> 标签：gpuimage

我正在使用 GPUImage，并且想从视频源 [GPUImageVideoCamera] 中提取几帧并保存为图像以在单击按钮时进行查看。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:06:37.317

这就是您如何从您正在使用的过滤器中获取当前帧的方法。

UIImage *currentVideoFrame = [过滤 imageFromCurrentlyProcessedOutput];

# windows - 用于 64 位窗口的 numpy

> ID：13594953
> 
> 赞同：0
> 
> 时间：2012-11-27T23:15:02.040
> 
> 标签：windows, numpy, python-2.7, 64-bit

我已经阅读了几篇关于在 64 位 windows7 操作系统上为 python 2.7 版安装 numpy 的相关文章。在我尝试这些之前，有人知道 32 位版本是否可以在 64 位系统上运行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:26:03.527

如果您使用的是 32 位 Python，它应该可以工作。如果您使用的是 64 位 Python，则需要 64 位 Numpy。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-05T20:07:09.793

如果您从 pip 获取它并且想要 64 位版本的 NumPy，则需要 MSVS 2008。pip 需要使用编译 Python 二进制文件的相同编译器来编译 NumPy 模块。

我最后一次检查（今年夏天），Windows 上的 python build.py 仅支持该版本的 MSVS。可能是因为 build.py 没有针对编译器进行更新，这些编译器并没有明确地作为仅编译版本免费提供。MSVS 2010、2012 和 2013 有一个“Express”版本（可以满足该要求）。但我不确定他们是否有专门的存储库以及他们是否有再分发许可证。如果有，那么唯一的问题是没有人能够升级 build.py 以支持更新版本的 MSVS。

# simplification - 我如何将 Aptana 剥离到只需要我需要的东西？

> ID：13594959
> 
> 赞同：0
> 
> 时间：2012-11-27T23:15:47.930
> 
> 标签：simplification

Aptana 给我留下了深刻的印象，但我是一个简单的 Wordpress 开发人员，使用 jQuery、MySQL、PHP、Wordpress 等等。我对 Aptana 对这些的支持非常满意，尤其是在安装了捆绑包和扩展之后。但是，我拥有对 Capistrano、Python、Ruby 的所有这些支持，这些都是我从未使用过的东西。Aptana 对我来说相当缓慢，并且让我感到困惑的功能比我需要的要多得多。有什么办法可以去掉这个功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:30:49.727

Aptana 只是带有大量自定义插件的 Eclipse。您需要禁用或卸载不使用的插件。

插件管理器位于**帮助**菜单中的某处。

[http://wiki.eclipse.org/FAQ_How_do_I_remove_a_plug-in%3F](http://wiki.eclipse.org/FAQ_How_do_I_remove_a_plug-in%3F)

# popcornjs - 在 div 中隐藏爆米花元素

> ID：13594960
> 
> 赞同：0
> 
> 时间：2012-11-27T23:15:52.087
> 
> 标签：popcornjs

因此，使用 popcorn.js，您可以指定脚注等将填充的 div。但是，如果您有多个视频对所述脚注使用相同的 div，但是，当您在弹出脚注的同时切换视频时，它会保留在 div 中，并且下一个元素将放置在其下方，而不是替换它。我不能使用 .html(' ') 因为所有元素实际上总是在那里，只是按顺序显示和隐藏。也无法隐藏整个 div。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T09:24:00.423

至少有几种方法可以做到这一点。

一种选择是在同一个 div 中创建两个 div，每个 div 具有 CSS 样式，`position: absolute`父 div 具有`position: relative`. 这两个 div 将相互重叠，您可以让每个 div 成为不同 Popcorn 实例中所有脚注的目标。当您在两个视频之间切换时，`display: none`为隐藏视频设置 div 并为可见视频清除它。

我经常使用的另一个技巧是使用`.disable`. 这将隐藏该爆米花实例的所有脚注。像这样的东西：

```
function activateVideo(index) {
  if (activePopcorn) {
      activePopcorn.disable('footnote');
      //todo: make this video invisible.
  }

  activePopcorn = popcornInstances[index];
  activePopcorn.enable('footnote');
  //todo: make this video visible.
  //(don't forget to range check)
} 
```

如果需要，您可以通过循环禁用/启用所有插件`Popcorn.registryByName`。

# c++ - 使用 std::enable_if 声明带有可变参数模板参数的括号运算符

> ID：13594962
> 
> 赞同：0
> 
> 时间：2012-11-27T23:15:57.233
> 
> 标签：c++, templates, gcc, c++11, sfinae

我有以下`smart_ptr`课程。

```
template <typename T>
class smart_ptr
{
public:
    // ... removed other member functions for simplicity
    T* get() { return ptr; }

    template <typename... Args>
    decltype(T::template operator ()(Args()...)) operator ()(Args... args) const
    {
        return (*get()).operator ()(args...);
    }

private:
    T* ptr;
}; 
```

但是，当我将`smart_ptr`类用于不带 的 T 类型时`operator ()`，它无法编译（这是正确的）。

我想要的是`std::enable_if`仅在 T 具有`operator ()`. 当我开始这样做时，它变得非常模糊和复杂，因为我正在考虑使用 SFINAE 来检测 T 是否有`operator ()`，然后将它与它结合`std::enable_if`以获得我想要的。但是，我在创建能够检测**可变参数模板`operator ()`**的 SFINAE 时迷失了方向（即**不是**[Is it possible to write a template to check for a function's exist?](https://stackoverflow.com/questions/257288/is-it-possible-to-write-a-c-template-to-check-for-a-functions-existence)的副本）。

任何人都可以帮忙吗？或者给出另一个（也许更简单）的解决方案？

ps 它必须在 GCC 4.5.3 上工作。

编辑：为了完整起见，我已经用 GCC 4.5.3 的工作解决方案回答了我自己的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:35:57.677

编辑：与原始答案完全不同，没有给出真正的解决方案。

此代码在使用 gcc 4.5.1 的 ideone 上编译。这是我能做的最好的。

```
#include <array>
#include <iostream>

using namespace std;

template<typename T>
struct has_property
{
    struct UnmentionableType { UnmentionableType() {} };

    //test if type has operator() (...)
    template<typename U, typename A1, typename A2, typename A3, typename A4, typename A5>
    static auto ftest(U* t, A1 a1, A2 a2, A3 a3, A4 a4, A5 a5) -> decltype((*t)(a1, a2, a3, a4, a5), char(0));
    static std::array<char, 2> ftest(...);

public:
    static const bool value = sizeof(ftest((T*)0, UnmentionableType(), UnmentionableType(), UnmentionableType(), UnmentionableType(), UnmentionableType())) == 1;
};

class c1
{
public:
    int operator() () {  return 0; }
};

class c2
{
public:
    void operator() (int) { }
};

class c3
{
public:
    template<typename... Args>
    void operator() (Args... a) { }
};

class c4
{
public:
    template<typename T>
    void operator() (T t) { }
};

int main()
{
    cout<<boolalpha<<has_property<c1>::value<<endl;
    cout<<boolalpha<<has_property<c2>::value<<endl;
    cout<<boolalpha<<has_property<c3>::value<<endl;
    cout<<boolalpha<<has_property<c4>::value<<endl;
} 
```

输出：

```
false
false
true
false 
```

笔记：

1）根据要求，它仅在可变参数模板化 operator() 上触发（嗯，几乎）

2）这不是一个“完美”的解决方案，但它应该足够好用于实际使用。

不幸的是 gcc 4.5.1 不能扩展参数包；我怀疑这可能对你有用：

```
template<typename U, typename... A>
static auto ftest(U* t, A... a) -> decltype((*t)(a...), char(0)); 
```

我仍然看不到一种方法来实际测试函数的真实可变性，而不是只传递 5 个（或更多）随机类型参数。

使用 with_enable if - 除了部分类专业化之外，我没有看到任何其他解决方案：

```
//non-specialized
template<typename T, typename E=void>
class container
{
    T* ptr;

public:
    T* get() { return ptr; }
};

//specialization for class with appropriate operator()
template<typename T>
class container<T, typename std::enable_if<has_property<T>::value, void>::type>
{
    T* ptr;

public:
    T* get() { return ptr; }

    template <typename... Args>
    decltype(T::template operator ()(Args()...)) operator ()(Args... args) const
    {
        return (*get()).operator ()(args...);
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T01:48:31.860

最后，我找到了 GCC 4.5.3 的解决方法！

```
template <typename T>
class smart_ptr
{
public:
    // ... removed other member functions for simplicity
    T* get() const { return ptr; }

private:
    template <typename... Args>
    struct opparen_constret
    {
        typedef decltype(std::declval<T const>()(std::declval<Args>()...)) type;
    };

    template <typename... Args>
    struct opparen_ret
    {
        typedef decltype(std::declval<T>()(std::declval<Args>()...)) type;
    };

public:
    template <typename... Args>
    typename opparen_constret<Args...>::type operator ()(Args... args) const
    {
        return (*get())(args...);
    }

    template <typename... Args>
    typename opparen_ret<Args...>::type operator ()(Args... args)
    {
        return (*get())(args...);
    }

private:
    T* ptr;
}; 
```

# facebook - Facebook URL 被截断

> ID：13594964
> 
> 赞同：2
> 
> 时间：2012-11-27T23:16:02.080
> 
> 标签：facebook

我正在创建一个在某些页面中使用[Facebook 提要对话框插件的网络应用程序。](https://developers.facebook.com/docs/reference/dialogs/feed/)当我尝试共享这些页面时，发布到新闻提要的 URL 会被截断。

我正在使用**直接 URL 方法**。当用户想要分享某些内容时，她会单击一个链接，该链接会将她重定向到提要对话框。链接组成如下图：

`https://www.facebook.com/dialog/feed?app_id=MY_APP_ID&link=SHARED_URL&redirect_uri=REDIRECT_URL`

例如：

**我在“链接”中的网址：**`http://www.simplecity.com.br/DP/Index/?CID=0&UID=1`

**我在新闻提要中获得的 URL：**`http://www.simplecity.com.br/DP/Index/?CID=0`

有没有人已经遇到过这个问题？有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:41:37.230

造成这种情况的常见原因是在将链接传递到 Direct FB URL 时忘记[对链接进行编码。](http://www.w3schools.com/tags/ref_urlencode.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:41:44.717

在创建您将用户传递到的 URL 时，您是否忘记对`link`参数进行 urlencode（我特别想到）？`&`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-14T19:16:20.553

我最近通过一个简单的链接遇到了同样的问题 - 我插入了：

[https://example.com/page.html](https://example.com/page.html)

进入页面帖子。但是，在页面上它呈现为：

[https://example.com/page.ht](https://example.com/page.ht) ...

好像 html 扩展名的最后两个字符只是没有显示，如省略号所示。但是，如果您从帖子中复制链接，您会发现这些字符实际上丢失并且链接解析为 404。如果您编辑帖子并重新插入链接，它会正确保存，尽管“溢出”字符仍然被隐藏省略号。非常误导。

最好的方法是在页面中使用 Facebook Developer OG 标签，然后使用 Open Graph Debugger 抓取链接。这会将 URL 放入 FB 领域，并且可以很好地选择正确的链接。在您执行此操作时，调试器工具会为您提供效果反馈：“这是我们第一次看到此 URL”；如果您事先将 URL 放在 FB 页面上，那就太胡扯了。

我已经向 Facebook 提交了错误报告；但我不指望他们承认这个错误。

# r - 有没有更优雅的方法来查找重复记录？

> ID：13594968
> 
> 赞同：2
> 
> 时间：2012-11-27T23:16:22.117
> 
> 标签：r, duplicates

我的测试框架中有 81,000 条记录，并`duplicated`显示 2039 条是相同的匹配项。[在 R 中的数据框中查找重复行（基于 2 列）的](https://stackoverflow.com/questions/6986657/find-duplicated-column-pairs-in-data-frame-in-r)一个答案提出了一种创建仅包含重复记录的较小框架的方法。这也适用于我：

```
dup <- data.frame(as.numeric(duplicated(df$var))) #creates df with binary var for duplicated rows
colnames(dup) <- c("dup") #renames column for simplicity
df2 <- cbind(df, dup) #bind to original df
df3 <- subset(df2, dup == 1) #subsets df using binary var for duplicated` 
```

但正如海报所指出的那样，它似乎不优雅。有没有更简洁的方法来获得相同的结果：只查看那些重复的记录？

就我而言，我正在处理抓取的数据，我需要弄清楚原始数据中是否存在重复项，或者是由我抓取引入的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:17:52.463

`duplicated(df)`将为您提供一个逻辑向量（所有值都由 T/F 组成），然后您可以将其用作数据帧**rows**的索引。

```
# indx will contain TRUE values wherever in df$var there is a duplicate
indx <- duplicated(df$var)
df[indx, ]  #note the comma 
```

* * *

你可以把它们放在一行中

```
df[duplicated(df$var), ]  # again, the comma, to indicate we are selected rows 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-27T23:54:19.047

```
doops <- which(duplicated(df$var)==TRUE)
uniques <- df[-doops,]
duplicates <- df[doops,] 
```

是我尝试从数据框中删除重复条目时通常使用的逻辑。

# java - Java程序打印出0而不是百分比

> ID：13594977
> 
> 赞同：1
> 
> 时间：2012-11-27T23:17:11.373
> 
> 标签：java, file, input, joptionpane

我正在做一个项目，但程序的这一部分不起作用。它要求输入一个字符，然后读取一个给定的文本文件，并输出该字母在文本文件中出现的百分比。这是代码：

```
public static void inputLetterFrequency() {
    String letterInput = JOptionPane.showInputDialog("Please input a letter to find out the frequency");
    letterInput.toUpperCase();
    char c = letterInput.charAt(0);
    content = content.toUpperCase();

    for (int i = 0; i < content.length(); i++) {
        if (content.charAt(i) == c) {
            letterOccurence++;
        }
    }

    letterFrequency = (letterOccurence / numberCharacters) * 100.0;

    JOptionPane.showMessageDialog(null, "Frequency of letter " + c + " is " + letterFrequency + "%");
    String tryAgain = JOptionPane.showInputDialog("Please choose an option: \n1 to input another letter \n2 to exit ");
    int n = Integer.parseInt(tryAgain);
    if (n == 1) {
        CharacterAnalyzer.inputLetterFrequency();
    } else {
        System.exit(0);
    } 
```

以下是在文件开头声明的

```
public static int numberCharacters;
public static String Filename = UserPrompt.content;
public static int letterOccurence;
public static double letterFrequency;
public static int digitOccurence;
public static double digitFrequency; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T23:18:08.450

这是您计算的代码`letterFrequency`：-

```
letterFrequency = (letterOccurence / numberCharacters) * 100.0; 
```

只需将上面的代码更改为： -

```
letterFrequency = letterOccurence * 100.0 / numberCharacters; 
```

* * *

在第一个代码中： -`(letterOccurence / numberCharacters)`将首先被评估，因为这是一个`integer division`，它的结果将是`0`，如果`numerator`小于`denominator`。

要使其成为`floating-point division`，只需将分子与`100.0`之前相乘即可`dividing`。

# android - Android 的零宽度换行空间

> ID：13594979
> 
> 赞同：19
> 
> 时间：2012-11-27T23:17:24.663
> 
> 标签：android

有谁知道 \u200b 是否应该在 Android 上作为零宽度空间工作，如果 TextView 的文本超过 TextView 的长度，则该空间用作换行符？看来只有 \u0020 对我来说是换行符，但我无法弄清楚如何拥有它的零宽度版本。\u200b 是我期望的工作，根据以下链接，但它只做零宽度空间并且不会中断......并且如前所述，只有 \u0020 是换行符。

[http://www.cs.tut.fi/~jkorpela/chars/spaces.html](http://www.cs.tut.fi/~jkorpela/chars/spaces.html)

我附上了我用来测试 U+ 代替 \u 的 Activity 的视图。

我还尝试使用 fromHtml 选项来查看是否有一个 Html 选项有效，但对 arial 没有任何运气。

这是我正在使用的测试代码

```
public class TextSpaceActivity extends Activity {

public static void start( Context ctx ) {
    ctx.startActivity(  new Intent( ctx, TextSpaceActivity.class )  );
}

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate( savedInstanceState );
    setContentView( R.layout.text_space_activity );
    setTitle( "TextSpaceActivity" );

    setText( R.id.tsa_txvw_1, "abc\u0020123\u0020xyz\u0020987" );
    setText( R.id.tsa_txvw_2, "abc\u200a123\u200axyz\u200a987" );
    setText( R.id.tsa_txvw_3, "abc\u200b123\u200bxyz\u200b987" );
}

TextView txvw;
private void setText( int txvwResId, String txt ) {
    txvw = (TextView)findViewById( txvwResId );
    txvw.setText( txt );
}
} 
```

![在此处输入图像描述](../Images/b4beb562f4b760bdac43dad0974b2c41.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-06T17:10:57.017

我不相信换行算法理解零宽度换行符、软连字符或行或段落分隔符字符。这是来自 Android 源代码的代码，它决定此处是否可以换行（`android.text.StaticLayout`源代码中的第 358-366 行）：

```
// From the Unicode Line Breaking Algorithm (at least approximately)
boolean isLineBreak = isSpaceOrTab ||
        // / is class SY and - is class HY, except when followed by a digit
        ((c == CHAR_SLASH || c == CHAR_HYPHEN) &&
        (j + 1 >= spanEnd || !Character.isDigit(chs[j + 1 - paraStart]))) ||
        // Ideographs are class ID: breakpoints when adjacent, except for NS
        // (non-starters), which can be broken after but not before
        (c >= CHAR_FIRST_CJK && isIdeographic(c, true) &&
        j + 1 < spanEnd && isIdeographic(chs[j + 1 - paraStart], false)); 
```

其中`isSpaceOrTab`在上面（第 343 行）中定义为：

```
boolean isSpaceOrTab = c == CHAR_SPACE || c == CHAR_TAB; 
```

所有`CHAR_`常量都是普通字符常量，所以没有什么`isspace`比这更糟的了。同一文件中的第 952-958 行：

```
private static final char CHAR_FIRST_CJK = '\u2E80';

private static final char CHAR_NEW_LINE = '\n';
private static final char CHAR_TAB = '\t';
private static final char CHAR_SPACE = ' ';
private static final char CHAR_SLASH = '/';
private static final char CHAR_HYPHEN = '-'; 
```

查看您的其他评论，我看到您正在尝试正确破解中文。您可能不需要做任何特别的事情：正如`isIdeographic`上面的调用所暗示的那样，它会尝试在两个表意文字之间中断而不插入空格。只有`StaticLayout`断路器这样做：`DynamicLayout`只使用换行符，所以它只会在静态文本上正确中断。

恐怕从我的研究来看，你好像被搞砸了。我对解决方法的唯一建议是使用 a`WebView`而不是 a `TextView`，并使用系统 Web 浏览器的卓越换行功能而不是有限的实现`TextView`提供。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-06-01T12:59:36.263

由于 Lollipop，`\u200b`受支持。

这是[`StaticLayout`](https://github.com/android/platform_frameworks_base/blob/lollipop-mr1-release/core/java/android/text/StaticLayout.java#L245)通过本地调用 on实现的[`nLineBreakOpportunities`](https://github.com/android/platform_frameworks_base/blob/lollipop-mr1-release/core/jni/android_text_StaticLayout.cpp#L62)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-09T21:17:42.410

相关：我刚刚测试了将零宽度空格字符实体`&#8203;`用作应用程序标题的一部分，当应用程序的图标由 Android 操作系统呈现在桌面上时，它会按预期进行*处理。*

```
 <string name="app_name">
        App&#8203;Name&#8203;With&#8203;Many&#8203;Words
    </string> 
```

我在 Android 5.0 上试过这个；但是，未知它是否适用于旧版本。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-06T16:36:33.540

在您的 strings.xml 中：

```
<string name="sample_string"><![CDATA[abc123<br />xyz987]]></string> 
```

在您的活动中：

```
TextView textView = (TextView) findViewById(R.id.myText);
textView.setText(Html.fromHtml(getResources().getString(R.string.sample_string))); 
```

希望能帮助到你！

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-07-17T04:52:06.003

如果您只想在浏览器中控制显示，您可以尝试在 CSS 中使用零宽度内联类：

```
.zw { display: inline-block; width: 0; } 
```

然后，在 HTML 中：

```
abc<span class="zw"> </span>123 
```

# python - 检查 CheckListCtrlMixin 中的项目时 wxPython 会发出什么事件？

> ID：13594981
> 
> 赞同：3
> 
> 时间：2012-11-27T23:17:44.503
> 
> 标签：python, wxpython

我正在使用 CheckListCtrlMixin 让用户为我的应用程序启用和禁用插件。一旦用户选中/取消选中列表中的项目，我想更新我的内部模型。检查项目时 CheckListCtrlMixin 会发出什么事件？

```
class CheckListCtrl(wx.ListCtrl,
                    CheckListCtrlMixin, ListCtrlAutoWidthMixin):
    def __init__(self, parent):
        wx.ListCtrl.__init__(self, parent, -1,
                             style=wx.LC_REPORT | wx.SUNKEN_BORDER)
        CheckListCtrlMixin.__init__(self)
        ListCtrlAutoWidthMixin.__init__(self) 
```

当项目被选中或未选中时，以下都不会发出：

```
self.pluginlist = CheckListCtrl(win)

... add a bunch of items to the list ...

self.pluginlist.Bind(wx.EVT_LIST_ITEM_ACTIVATED, self.on_item_activated)
self.pluginlist.Bind(wx.EVT_LIST_ITEM_SELECTED, self.on_item_selected) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T00:49:09.417

`CheckListCtrlMixin`不会发出取消/检查项目的事件。相反，它调用了可覆盖的方法：

```
def OnCheckItem(self, index, flag):
    "flag is True if the item was checked, False if unchecked"
    pass 
```

要在课堂外“绑定”“事件” `CheckListCtrl`，您可以使用：

```
self.pluginlist.OnCheckItem = self.on_check_item 
```

# android - Android：将两个类合并到一个活动中的适当方法是什么

> ID：13594986
> 
> 赞同：0
> 
> 时间：2012-11-27T23:18:04.643
> 
> 标签：android, class, extends

我有两个类 1.MainActivity 扩展了 Activity 和 2.AlarmReceiver 扩展了 BroadcastReceiver。如何消除 AlarmReceiver 而在 MainActivity 中实现其功能？我知道您不能扩展两个类，所以我想知道最好的方法是什么。任何帮助将非常感激。

主要活动

```
public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        scheduleNextUpdate();
         Streamer str = new Streamer();
            Calendar calendar = str.getIcs();

        int x = 1;
        LinearLayout layout = (LinearLayout)findViewById(R.id.layout);

        for (Iterator i = calendar.getComponents().iterator(); i.hasNext();) {
            Component component = (Component) i.next();
            TextView tv_1 = new TextView(this);
            layout.addView(tv_1);
            tv_1.setText("Component " + x);
            x++;;

            for (Iterator j = component.getProperties().iterator(); j.hasNext();) {
                Property property = (Property) j.next();
                TextView tv_2 = new TextView(this);
                layout.addView(tv_2);
                tv_2.setText(property.getName() + ": " + property.getValue());
            }
        }

    }

    public void scheduleNextUpdate()
      {

        Intent intent = new Intent(MainActivity.this,AlarmReceiver.class);
        PendingIntent pendingIntent =
            PendingIntent.getBroadcast(this, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);

        long currentTimeMillis = System.currentTimeMillis();
        long nextUpdateTimeMillis = (currentTimeMillis *2) + DateUtils.MINUTE_IN_MILLIS;
        Time nextUpdateTime = new Time();
        nextUpdateTime.set(nextUpdateTimeMillis);

        if (nextUpdateTime.hour < 8 || nextUpdateTime.hour >= 22)
        {
          nextUpdateTime.hour = 8;
          nextUpdateTime.minute = 0;
          nextUpdateTime.second = 0;
          nextUpdateTimeMillis = nextUpdateTime.toMillis(false) + DateUtils.DAY_IN_MILLIS;
        }
        AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);
       // alarmManager.set(AlarmManager.RTC, nextUpdateTimeMillis, pendingIntent);
        alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis()+10000,60000,pendingIntent);

        Streamer str = new Streamer();
        boolean alarmUp = (PendingIntent.getBroadcast(this, 0, 
                new Intent(MainActivity.this,AlarmReceiver.class), 
                PendingIntent.FLAG_NO_CREATE) != null);

        if (alarmUp)
        {
            Log.d("myTag", "Alarm is already active");
        }
        System.out.println(currentTimeMillis);
      } 
```

报警接收器

```
public class AlarmReceiver extends BroadcastReceiver {
    @Override
     public void onReceive(Context context, Intent intent) {  
        Log.d("myTag", "Alarm has been received");
    intent = new Intent(context, MainActivity.class);
    PendingIntent pendingIntent = PendingIntent.getService(context, 0, intent, 0);
     Streamer str = new Streamer();
        Calendar calendar = str.getIcs();
        System.out.println(calendar);
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T23:30:15.863

您可以`BroadcastReceiver`在 Activity 中注册，然后在其中取消注册`onPause`

```
public class MainActivity extends Activity {

    private BroadcastReceiver receiver = new BroadcastReceiver() {

        @Override
        public void onReceive(Context context, Intent intent) {
            Toast.makeText(getApplicationContext(), "received", Toast.LENGTH_SHORT).show();
        }
    };

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Intent intent = new Intent("TESTING");
        PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);
        AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);
        alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis() + 5000, 10000, pendingIntent);

    }

    @Override
    protected void onResume() {
        super.onResume();
        registerReceiver(receiver, new IntentFilter("TESTING"));
    }

    @Override
    protected void onPause() {
        unregisterReceiver(receiver);
        super.onPause();
    }

} 
```

# r - 根据前一行/后一行更改列中的值

> ID：13594990
> 
> 赞同：2
> 
> 时间：2012-11-27T23:18:13.913
> 
> 标签：r, dataframe

想象一下，我有一张桌子，例如：

```
 ScaleDown ScaleUp
1           0        0
2           1        0
3           0        0
4           0        1
5           0        0 
```

我想要做的是在列上执行放大或缩小功能，以便更改值以反映刚刚发生的正输入（缩小）或正进入（放大）。所以表格最终应该看起来像这样：

```
 ScaleDown ScaleUp
1           0        0
2           1       0.33
3          0.66     0.66
4          0.33      1
5           0        0 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:08:06.577

```
# Sample Data
df <- data.frame(scaleDown=c(0,1,0,0,0,0,1,0,0,0,1), scaleUp=c(0,1,0,0,0,0,0,1,0,1,0))

# Function call with mapply
mapply(adjust, df, c(F, T), MoreArgs=list(rate=3, rounding=2))

#           scaleDown scaleUp
#      [1,]      0.00    0.67
#      [2,]      1.00    1.00
#      [3,]      0.67    0.00
#      [4,]      0.34    0.00
#      [5,]      0.00    0.00
#      [6,]      0.00    0.34
#      [7,]      1.00    0.67
#      [8,]      0.67    1.00
#      [9,]      0.34    0.50    <{~~ 
#     [10,]      0.00    1.00
#     [11,]      1.00    0.00 
```

功能：

```
adjust <- function(vec, reverse=FALSE, rate=3, rounding=3) {

  if (reverse)
    vec <- rev(vec)

  # add a dummy "1" to end of vec for calculating ends. Will be removed
  vec <- c(vec, 1)

  len <- length(vec)
  indx <- which(vec[-len] != 0)
  ends <- c(indx[-1L], (length(vec) + rate))

  ranges <- sapply(ends-indx, min, rate)
  subtr <- round(vec[indx]  /  ranges, rounding)

  for(i in 1:length(subtr)) {
    for (j in (ranges[i]-1):1) {
      vec[indx[i] + ranges[i]-j] <- vec[indx[i] + ranges[i]-j-1] - subtr[i]
    }
  }

  # remove dummy element
  vec <- vec[seq(len-1)]

  if (reverse)
    return(rev(vec))
  return(vec)
} 
```

# java - 我如何处理 // 在 tomcat 中的 URI 前缀？

> ID：13594994
> 
> 赞同：0
> 
> 时间：2012-11-27T23:18:25.423
> 
> 标签：java, http, tomcat, servlets

我正在运行一个 tomcat 服务器，它的过滤器（和一个 servlet）映射到 /xxx/* 我有客户端在 HTTP 标头处发送 //xxx/* 作为 uri。结果，没有调用 servlet 和过滤器。我已经尝试在 /* 处放置一个过滤器来捕获请求，用 requestWrapper 包装它并覆盖 getURI() 和 getServletPath() 方法（它们只是将带有单个 / 的 URI 返回给调用者）这似乎没有工作，所以我假设一旦tomcat收到一个请求，它决定在将它发送到第一个过滤器之前，应该根据这个uri评估哪些servlet/过滤器。有没有办法解决这个问题？我可以让tomcat在每个过滤器之后重新评估吗？还有其他方法吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:37:00.223

如果请求标头中的 URL 不符合规范，则 Tomcat 通过删除它们来做正确的事情。

如果这是问题所在，您需要修复客户端，以便它将正确的绝对 URL 放入 HTTP 请求中。

“破解” Tomcat 以使其接受垃圾请求是一个坏主意。它将限制您升级平台和/或在不同网络环境中部署的选项。

# php - 从 jquery ajax 回调获取数据以在未来的 SQL 查询中使用

> ID：13594999
> 
> 赞同：0
> 
> 时间：2012-11-27T23:18:44.133
> 
> 标签：php, javascript, html, jquery

我希望从下拉框中获取选定的字段，以便在将来的下拉框中使用它，但我不知道如何通过 ajax 将变量回显到 html。

```
<p>Trainer</p>
<select name = "trainer_has_update_pokemon">
<option>Select Trainer</option>
<?php
$query = "SELECT name FROM Trainer";

if ($stmt = $mysqli->prepare($query)) {
$stmt->execute();
$stmt->bind_result($name);
while ($stmt->fetch()) {
    echo"<option>$name</option>";
}

$stmt->close();
}

?>
</select> 
```

口袋妖怪

```
<select name = "type_of_update_pokemon">
</select>

<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
<script type="text/javascript">
$(function(){ 
    $('select[name="trainer_has_update_pokemon"]').change(function(){ // when trainer_has_update_pokemon changes
        $.ajax({
            type:"POST", //send a post method
            url:'pkmn_dropdown.php', // path to ajax page
            data:"trainer_name="+$(this).val(), //set trainer_name to value
            success:function(response){ // retrieve response from php
                $('select[name="type_of_update_pokemon"]').html(response); // update select
            }
        });
    });
});
</script>

<select name="nickname_of_update_pokemon">
</select>

<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
<script type="text/javascript">
$(function(){ 
    $('select[name="type_of_update_pokemon"]').change(function(){ // when trainer_has_update_pokemon changes
        $.ajax({
            type:"POST", //send a post method
            url:'nickname_dropdown.php', // path to ajax page
            data:"pkmn_name="+$(this).val() & "trainer_name=" +$trainer_name,//set trainer_name to value
            success:function(response){ // retrieve response from php
                $('select[name="nickname_of_update_pokemon"]').html(response); // update select
            }
        });
    });
});
</script> 
```

名称下拉列表的 php：

```
<?php

//connect to db

    $trainer_name = $_POST['trainer_name']; 
    $query = "SELECT DISTINCT p.name FROM Pokemon p WHERE p.owner_id = (SELECT t.trainer_id FROM Trainer t WHERE t.name = '$trainer_name')";
    if ($stmt = $mysqli->prepare($query)) {
        $stmt->execute();
        $stmt->bind_result($pkmn_name);
        while ($stmt->fetch()) {
            echo"<option>$pkmn_name</option>";
        }
        $stmt->close();
        echo $trainer_name;
    }?> 
```

昵称下拉列表的 php：

```
<?php

//connect to db

$pkmn_name = $_POST['pkmn_name']; 
$query = "SELECT p.nickname FROM Pokemon p, Trainer t WHERE p.name = '$pkmn_name AND p.owner_id = t.trainer_id AND t.name = $trainer_name";
if ($stmt = $mysqli->prepare($query)) {
    $stmt->execute();
    $stmt->bind_result($nickname);
    while ($stmt->fetch()) {
        echo"<option>$nickname</option>";
    }
    $stmt->close();
}?> 
```

任何想法如何从第一个下拉框中获取选定的培训师姓名，以便我可以在昵称下拉框中使用它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:53:04.670

运行上述代码时究竟发生了什么？昵称选择是否会丢失所有选项？您的 ajax 响应是否包含预期的选项字符串？

修改 select 的 innerHTML 在 IE 中不起作用。您将需要添加实际元素。尝试这样的事情。

```
$( 'select[name="nickname_of_update_pokemon"]' ).empty().append( $( response ) ); 
```

在你的 ajax 成功函数中。