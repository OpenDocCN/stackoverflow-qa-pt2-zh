# StackOverflow 问答 15118000-15118999

# c - 如何将头文件函数中的内联程序集转换为不支持 x64 的程序集的 c++ 函数？

> ID：15118004
> 
> 赞同：1
> 
> 时间：2013-02-27T17:07:13.390
> 
> 标签：c, assembly, x86, x86-64, inline-assembly

任何人都可以帮助将头文件中的以下内联汇编转换为相应的 x86-64 .asm 文件或无需汇编的 c 样式函数吗？

```
extern const char hexlu[];
void _inline hextoascii(char* a_src , char* a_dest ) {
_asm {

              mov esi, a_src;
    mov edi, a_dest;
    sub ebx,ebx

    mov edx,[esi+00]
    mov bl,dl
    mov ax,word ptr [ebx*2+hexlu]
    mov [edi+00],ax
};
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:17:21.260

```
void hextoascii(char* src, char* dest)
{
    dest[0] = hexlu[  2*(unsigned)src[0]];
    dest[1] = hexlu[1+2*(unsigned)src[0]];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:46:05.533

首先，我建议简单地使用[`itoa()`](http://www.cplusplus.com/reference/cstdlib/itoa/)，例如：

```
static inline void hextoasacii(char *a_src, char *a_dest)
{
    (void)itoa(*a_src, a_dest, 16);
} 
```

但这有一个缺点，`a_dest`会被`NULL`它终止，即它需要三个（而不是两个）字节的空间，所以这不是 100% 等效的。

在任何情况下，显示的内联汇编代码对于内存访问都不是特别优化；C/C++ 中的原始形式（但它当然取决于 255 项大小的`hexlu[]`数组的确切内容，我假设它看起来像）将是：`char *hexlu[] = { "00", "01", "02", ... };`

```
static inline void hextoascii(char *a_src, char *a_dest)
{
    static const char hexdigits[16] = "0123456789abcdef";
    int src = *a_src;
    a_dest[0] = hexdigits[src >> 4];
    a_dest[1] = hexdigits[src & 15];

    // make this:
    // *(unsigned short*)a_dest =
    //     ((unsigned short)hexdigits[src & 15]) << 8 |
    //     (unsigned short)hexdigits[src >> 4]
    //
    // if it absolutely _must_ be a single store
} 
```

**边注：**

如果您真的想采用汇编方式进行二进制/十六进制转换，可以使用 SSSE3 ( `pshufb`) 对上述内容进行编码以进行 16 字符表查找。这样，等效的`sprintf("%llx", tgt_string, val_uint64)`基本上可以在一条*指令* `pshufb`中完成。

示例如何执行此操作并解释其工作原理，请参见此处：

*   [在Flat Assembler Board](http://board.flatassembler.net/topic.php?t=9432)上阅读以下关于二进制/十六进制转换的帖子（使用 搜索 BitRake 的帖子`pshufb`）
*   阅读[Wojciech Muła](http://0x80.pl/)关于[使用 SSSE3 打印十六进制值](http://wm.ite.pl/articles/sse-hexprint.html)的文章（此处的代码：） [`hexdump.c`](http://wm.ite.pl/snippets/asm/hexprint.c)；`itoa(..., 10)`还建议阅读他关于使用类似有趣技术加速的文章

一个 SSSE3 解决方案，用于逐字节进行，不会像一次性转换多个字节那样提供如此大的加速，因为只会使用 1/8 的`XMM`寄存器；您的函数不能（有效地）转换为按原样使用 SSSE3。如果您在循环中调用它（打印内存区域的十六进制转储），那么使用像 Wojciech 的示例代码这样的函数将提供非常显着的加速。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:17:45.147

我认为您只需要将 32 位指针转换为 64 位指针。

```
extern const char hexlu[];
void _inline hextoascii(char* a_src , char* a_dest ) {
_asm {
    mov rsi, a_src;
    mov rdi, a_dest;
    sub rbx, rbx;

    mov rdx, [rsi];
    mov bl, dl;
    mov ax, [2*rbx+hexlu];
    mov [rdi], ax;
};
} 
```

# c#-4.0 - C#中的二进制反序列化通用对象

> ID：15118015
> 
> 赞同：1
> 
> 时间：2013-02-27T17:07:59.590
> 
> 标签：c#-4.0, generics, casting, deserialization, binary-deserialization

我有一个可以序列化的通用类：

```
MyOwnGenericClass<T> 
```

所以我想反序列化它，如果`T`是一个`String`实例来处理它，在另一种情况下我想抛出一个异常。

反序列化时如何知道泛型包含的类型`MyOwnGenericClass<T>`？我必须将以下代码转换为哪个类？

```
new BinaryFormatter().Deserialize(fileStrieam); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:22:26.883

这真的很容易。`object`像这样使用：

```
object obj = new BinaryFormatter().Deserialize(fileStrieam); 
```

然后做你说你会做的事情：

```
if (!(obj is MyOwnGenericClass<string>))
    throw new Exception("It was something other than MyOwnGenericClass<string>");
else {
    MyOwnGenericClass<string> asMyOwn_OfString = obj as MyOwnGenericClass<string>;

    // do specific stuff with it
    asMyOwn.SpecificStuff();
} 
```

因此，您不检查是否`T`为`string`. 您检查的不止这些：您正在检查 obj 是否为`MyOwnGenericClass< string >`. 没有人说这将永远是一个`MyOwnGenericClass< something >`，我们唯一的头痛是找到那个东西是什么。

您可以发送布尔值、字符串、整数、int 的原始数组，甚至是`StringBuilder`. 然后是您的随行人员：您可以发送`MyOwnGenericClass< int >`, `MyOwnGenericClass< string >`（这是您唯一接受的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:15:04.320

```
var test = new MyGenericType<string>();

var genericTypes = test.GetType().GetGenericArguments();
if (genericTypes.Length == 1 && genericTypes[0] == typeof(string))
{
    // Do deserialization
}
else
{
    throw new Exception();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T17:15:29.517

您可以使用[`Type.GetGenericArguments()`](http://msdn.microsoft.com/en-us/library/system.type.getgenericarguments.aspx)来获取在运行时创建类型的泛型参数的实际值：

```
class MyGeneric<TValue> {}

object stringValue = new MyGeneric<string>();
object intValue = new MyGeneric<int>();

// prints True
Console.WriteLine(stringValue.GetType().GetGenericArguments()[0] == typeof(string));
// prints False
Console.WriteLine(intValue.GetType().GetGenericArguments()[0] == typeof(string)); 
```

# javascript - onclick、exit 和 back 按钮按下的弹出窗口

> ID：15118017
> 
> 赞同：0
> 
> 时间：2013-02-27T17:08:08.077
> 
> 标签：javascript

我正在创建一个弹出窗口，当用户单击链接或关闭浏览器或单击返回按钮时，该弹出窗口应弹出。我知道一点 java 脚本，所以如果有人在这里帮助我，我将非常感激。这是我的弹出代码

```
<a href="#" onclick="javascript:window.open('http://www.google.com','','width='+screen.width+',height='+screen.height+',location=yes,menubar=yes,resizable=yes,scrollbars=yes,toolbar=yes').blur(); window.focus()">Click me to open pop up</a> 
```

这是我正在处理的实际页面

[http://www.techblogbuzz.com/mypopup/](http://techblogbuzz.com/mypopup)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:35:13.727

使用`onbeforeunload`事件

```
var popup = function(){     
    window.open('http://www.google.com','','width='+screen.width+',height='+screen.height+',location=yes,menubar=yes,resizable=yes,scrollbars=yes,toolbar=yes').blur(); 
    window.focus()
};

window.onbeforeunload = function(){
    popup();
} 
```

[http://jsfiddle.net/orlando/DjH7r/](http://jsfiddle.net/orlando/DjH7r/)

顺便说一句.. 大多数浏览器都会阻止弹出窗口

# jquery - 目标子元素，但不是被点击的元素

> ID：15118019
> 
> 赞同：-6
> 
> 时间：2013-02-27T17:08:25.490
> 
> 标签：jquery

我见过类似的例子，但不知道如何让“ `not(this)`”在我的代码中工作。
基本上我需要做的是：
**定位子元素，而不是点击的（`this`）一个**

这是我尝试过的：

```
jQuery(document).ready(function(){
   jQuery("li").click(function(){
      jQuery(this).children('.step').slideToggle("slow");
      jQuery not(this).children('.step').slideUp("slow"); // any advice?...
   });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:10:38.733

采用`.siblings()`

```
(function($){ // REMAP "$" to jQuery
$(function(){ // DOM READY shorthand
    $("li").click(function(){
        $(this).slideDown(800).siblings().slideUp(800);
    });
});
})(jQuery); 
```

或者在你的情况下可能是这样（我不知道，因为它有点不清楚）

```
 $("li").click(function(){
     $(this).find('.step').slideToggle(800);
     $(this).siblings().find('.step').slideUp(800);
 }); 
```

`**[jQuery API Documentation - Siblings](http://api.jquery.com/siblings/)**`

# php - add new row with foreign key when candidate key does not exist yet

> ID：15118025
> 
> 赞同：0
> 
> 时间：2013-02-27T17:08:45.910
> 
> 标签：php, mysql, database

I find it difficult to find a good title I hope I can explain it better. I have two tables

```
"car" - id, car_id, name
"car_pictures" - id, fk_car_id, url 
```

Obviously a "car" can have several pictures those are linked by the car_id saved as "fk_car_id" in the "car_pictures" table. Workflow in a frontend could be:

```
- you add a new car to the database
- you add pictures to this car entry 
```

If followed this way you first create a new entry in the "car" table. Then you have a "car_id" you can reference in the "car_pictures" table.

But what if you like to change the workflow like this:

```
- you add a new car
- you immediately add pictures
- you save the new car to the database 
```

If followed this way you do create the database entry only if the user has finished all "steps". But if you want to add pictures to the car there is no "car_id" for it yet. So you can't reference the id.

What is the usual way to do this if adding the car and adding the pictures are two seperate api calls for example.

It seems I need to clarify what I am doing. Let's say I have two api calls: www.domain.com/api/car/add/?name=newcar -> for adding a car (ie. adding to the database) www.domain.com/api/car/picture/add/?car_id=x -> for adding a picture to a car (ie. handle the upload and put data to the database)

The frontend would look like this: A page with a table with all cars which you can edit and add new pictures to it in another page. Another page to add a new car which also has the possibility to add picture. This would be the same page/form as editing a car only that no car_id is available.

Edit:

I myself can think of several ways to handle this case.

first: create a database entry for a car immediately when the user opens the "add new car" form. that way you always have a car_id. but you have to handle if the user decides to cancel adding a car and need to remove those "dummy" database entries. if something goes wrong there you may end with a lot of empty car entries in the database. maybe the row has a flag that is set when the car is actually "inserted" by the user.

second: insert new pictures with temporary negative fk_car_id and update those rows with the actual car_id if the row is created in the database.

third: save new pictures into a temporary table with a temporary id when there is no car_id yet. then you have to return that temporary id and moved those entries from the temporary table on the creation of a car entry in the database.

But those ideas sound complicated and I hoped there is some best practice way how to do it. Maybe the problem is in my workflow itself and there is a better way to do it. Yet it seems to be a good idea to separate the process of adding a car and adding pictures to a database.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:11:31.340

添加要用于[`mysql_insert_id()`](http://php.net/manual/en/function.mysql-insert-id.php)获取在最后一个查询中生成的 ID 的汽车后。然后就可以提交图片了。

例如：

```
mysql_query("INSERT INTO car (name) VALUES ('car')");
$last_id = mysql_insert_id();
mysql_query("INSERT INTO car_pictures (fk_car_id, link) VALUES (".$last_id.",'link')"); 
```

我建议您使用[PDO](http://php.net/manual/en/book.pdo.php)而不是`mysql_`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:13:56.927

你可以`car_pictures.fk_car_id`设为空，然后你可以插入一个没有主记录的图片，然后在添加汽车时更新它......

# json - extjs 4 : get store record values

> ID：15118030
> 
> 赞同：2
> 
> 时间：2013-02-27T17:08:52.120
> 
> 标签：json, extjs, extjs4, store

my json data looks like this :

```
({"success": "true", "message" : "OK","data":[{"id_metric":"1","name_filter":"doc filter","type_guicomp":"combobox"},{"id_metric":"1","name_filter":"severity","type_guicomp":"combobox"}]}) 
```

I'd like to be able to retrieve the `"type_guicomp"` field value for the `"id_metric" = 1` , so the result would be : `"type_guicomp":"combobox"` and `"type_guicomp":"combobox"`.

I do this because I need the value `"combobox"` to assign it to a variable. I've tried several things including :

```
myStore.load({
        scope: this,
        callback : function(record, operation, success) {
            console.log(record);
            console.log(record.data);
            } 
```

And :

```
var index = Ext.StoreMgr.lookup("myStore").findExact('id_metric',1);
var rec = Ext.StoreMgr.lookup("myStore").getAt(index);
console.log(rec); 
```

These solutions return undefined or null. So when I did this in the callback :

```
var i = myStore.getCount();
console.log(i); 
```

It returned `0`. But when I check the json output, it's not empty and there's actually data in it.

What am I doing wrong? Please any help would be appreciated.

**EDIT**

My store looks like this :

```
Ext.define('Metrics.store.MyStore', {
extend: 'Ext.data.Store',
model: 'Metrics.model.MyModel',
autoLoad: true,
idProperty: 'id_metric',
proxy : {
    type : 'ajax',
    actionMethods : 'POST',
    node : 'id_metric',
    api : {
    read : 'gui_comp_items.php' //the php script that gets data from db
    },
    reader: {
        type: 'json',
        successProperty: 'success',
        messageProperty: 'message',
        root: 'data'
    }
}
}); 
```

My Model :

```
Ext.define('Metrics.model.MyModel', {
extend: 'Ext.data.Model',
fields: [
{name : 'id_metric', type : 'int'},
{name : 'name_filter', type : 'string'},
{name : 'type_guicomp', type : 'string'},
{name : 'value', type : 'string'}]  
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T09:45:04.453

我不明白的是你使用的方式`myStore`。您已经将它用作字符串和变量两种方式。它是哪一个？如果它是一个字符串，那么`myStore.load()`将不起作用。如果它是一个变量，您需要丢失`Ext.StoreMgr.lookup(myStore)`. store 变量在哪里声明？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T11:51:26.520

如果您使用 ajax 请求，您可以获得**id_metric** ...看看成功函数。

```
Ext.Ajax.request({
    url : 'blabla.tml',
    method:POST,                                                                      
    params : {
        item : Data
    },
    success : function(response) {
        var res = response.responseText;                                                                        
        alert(Ext.decode(res));
        var jsonData = Ext.decode(res);
        var data = jsonData.data; // here data will contain ur data with root data. 
```

您现在可以在此处加载数据

```
 Ext.getStore('Mystore').loadData(data);                                             
    }
}); 
```

而您正在使用 mystore 加载...是您的 Mystore 的 storeId:mystore，只需查看一次即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-08T08:40:34.030

很可能是因为您有 2 个具有相同 id 的对象而混淆了商店。（您的 JSON 代码显示 "id_metric":"1" 两次）。

然而，最有可能的是，自动转换为模型失败。尝试做：

```
var model = Ext.create("Metrics.model.MyModel", {"id_metric":"1","name_filter":"doc filter","type_guicomp":"combobox"}); 
```

查看模型的外观以及它是否能够创建实例。

如果可行（这样您就可以创建模型），请深入您的商店以查看数据是否确实存在。寻找这个：

```
myStore.proxy.reader.jsonData 
```

此外，正如评论中所指出的， idProperty 是一个模型属性，您应该在模型中声明它。

# iphone - 来自 ViewController 代码的 iphone 自动化图表

> ID：15118045
> 
> 赞同：-2
> 
> 时间：2013-02-27T17:09:48.180
> 
> 标签：iphone, ios, xcode, uml, diagram

我正在搜索从 Xcode 项目创建图表的工具。我已经尝试过`OmniGraffle`并且`Visual Paradigm`（这似乎行不通...），以及其他一些工具...似乎所有这些工具都创建了一个图表，该图表仅绘制了 xcode 项目的所有类的#import。我需要一个在类或 ViewController 中绘制代码流的工具，我需要类似的东西：`"ViewDidLoad->ViewWillAppear->ViewDidAppear->ecc...`“。有这个工具吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:06:35.123

不可能有任何事情可以做你想做的事。IDA 可以为您提供代码的反汇编并直观地显示逻辑流程：

[https://www.hex-rays.com/products/ida/index.shtml](https://www.hex-rays.com/products/ida/index.shtml)

如果你学会了很好地使用调试器，你可以逐步执行代码：http: [//lldb.llvm.org/](http://lldb.llvm.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T15:10:14.230

对于你想要的，我不认为有任何事情。你可以

```
NSLog(@"entering %s" ,  __PRETTY_FUNCTION__  ) ; 
```

在每种方法上。

然后运行。获取输出并使用 AppleScript 让 OmniGraffle 完成。多年前，我为一个数据库文档项目做了类似的事情。

# php - php url explode

> ID：15118047
> 
> 赞同：6
> 
> 时间：2013-02-27T17:09:58.283
> 
> 标签：php, arrays, url, explode

I am wanting to grab my product from my url. For example:

```
http://www.website.com/product-category/iphone 
```

I am wanting to grab the iphone and that is fine with my code but I have a dropdown to sort products and which clicked will change the url and add a query like:

```
http://www.website.com/product-category/iphone?orderby=popularity
http://www.website.com/product-category/iphone?orderby=new
http://www.website.com/product-category/iphone?orderby=price
http://www.website.com/product-category/iphone?orderby=price-desc 
```

My current code is

```
$r = $_SERVER['REQUEST_URI']; 
$r = explode('/', $r);
$r = array_filter($r);
$r = array_merge($r, array()); 

$endofurl = $r[1];
echo $endofurl; 
```

How is it possible to grab the iphone section all the time.

Cheers

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T17:13:24.807

您可以使用 PHP 的[`parse_url()`](http://php.net/parse_url)函数为您拆分 URL，然后访问`path`参数并获取它的结尾：

```
$r = parse_url($url);
$endofurl = substr($r['path'], strrpos($r['path'], '/')); 
```

`/`这将解析 URL，然后从路径中的 last-found 开始获取 URL 的“子字符串” 。

您也可以`explode('/')`像当前在路径上那样使用：

```
$path = explode($r['path']);
$endofurl = $path[count($path) - 1]; 
```

**更新**（使用[`strrchr()`](http://php.net/strrchr)，@x4rf41 指出）：
获取字符串结尾的一种更短的方法，与`substr()`+相反`strrpos()`是使用`strrchr()`：

```
$endofurl = strrchr($r['path'], '/'); 
```

如果您利用`parse_url()`'s 选项参数，您还可以使用like $r = parse_url($url, PHP_URL_PATH);来获取*路径。*`PHP_URL_PATH`

或者，最短的方法：

```
$endofurl = strrchr(parse_url($url, PHP_URL_PATH), '/'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-27T17:11:57.033

如果要检索数组的最后一个元素，可以使用[end](http://php.net/end)函数。您的其余代码似乎正在运行。

```
$endofurl = end($r); 
```

您还可以利用[parse_url](http://php.net/parse_url)和[strrchr](http://www.php.net/manual/en/function.strrchr.php)函数使其更简洁：

```
$endofurl = strrchr(parse_url($url, PHP_URL_PATH), '/'); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-27T17:17:33.650

刚刚想通了。现在可以使用

```
$r = $_SERVER['REQUEST_URI']; 
$r = explode('/', $r);
$r = array_filter($r);
$r = array_merge($r, array()); 
$r = preg_replace('/\?.*/', '', $r);

$endofurl = $r[1];
echo $endofurl; 
```

# wordpress - Wordpress filter_where: filtering my meta_value not working

> ID：15118055
> 
> 赞同：1
> 
> 时间：2013-02-27T17:10:13.447
> 
> 标签：wordpress, filter

Working with a filter for a Wordpress query. If I use the $where line as shown below, the filter works.

Note in the query that I have a meta_key = mymeta_datetime and a meta_value of the actual datetime for the event.

When I comment out the $where line in the filter and try the line above that where meta_value > $today, this filter fails entirely, and no upcoming events are shown on the page.

How can I filter on mymeta_datetime to only show upcoming events?

```
// setup filter for where clause
function filter_where($where='') {
    // filter for future events only
    $today = date('Y-m-d H:i');
    //$where .= " AND 'meta_value' > '$today'"; // this doesn't work :(
    $where .= " AND post_date > '2013-02-15'"; // this works!
    return $where;
    }

    add_filter('posts_where', 'filter_where');

        $args = array('post_type' => 'gla_events',  'post_status' => 'publish', 'posts_per_page' => 100, 'caller_get_posts'=> 1, 'orderby'=>'meta_value', 'meta_key'=>'mymeta_datetime', 'order'=>'ASC');
    $loop = new WP_QUERY($args);
    remove_filter('posts_where', 'filter_where');

        if($loop->have_posts()) {...} 
```

Any help on this is appreciated. Thanks!

# javascript - jquery 日期选择器中的疯狂行为

> ID：15118057
> 
> 赞同：4
> 
> 时间：2013-02-27T17:10:24.443
> 
> 标签：javascript, jquery, ruby-on-rails-3, jquery-ui-datepicker

我的 RoR 应用程序中有两个来自 jquery1.8.1.min.js 的 jquery 日期选择器实例。

我有这个功能：

```
 $(".date-picker:not('#policy_starts_on')").datepicker();
    $('#policy_starts_on.date-picker').datepicker({
        startDate: '0',
        endDate: '+90d'
    }); 
```

与此输入一起使用：

```
<input class="required  date-picker input-small align-center" id="policy_starts_on" name="policy[starts_on]" size="30" type="text" value="02/27/2013"> 
```

然后我有这个功能：

```
 $(".date-picker:not('#act_event_ends_on')").datepicker();
    $('#act_event_ends_on.date-picker').datepicker({
        startDate: '0',
        endDate: '+180d'
    }); 
```

与此输入一起使用：

```
<input class="required date-picker input-small align-center" id="act_event_ends_on" name="act_event[ends_on]" size="30" type="text"> 
```

两个输入都是由 ruby​​ 表单助手生成的：

这是第一个表单助手：

```
= f.input :starts_on, :label => 'Policy Start Date', :required => true 
```

这是第二种形式的助手：

```
= f.input :ends_on, :label => 'Event End Date', :required => true 
```

**问题：**为什么第一个输入被正确限制（IE你不能选择过去的一天，它只会让你进入未来90天）而第二个输入根本没有被限制？

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:17:06.517

这一行：

```
$(".date-picker:not('#policy_starts_on')").datepicker(); 
```

初始化第二个输入（带有 id="act_event_ends_on" 的那个），因为它有`date-picker`类但没有`policy_starts_on`id。

结果，这个元素已经被初始化了，下面的代码将不再为你做任何事情：

```
$('#act_event_ends_on.date-picker').datepicker({
    startDate: '0',
    endDate: '+180d'
}); 
```

解决方案：

我的建议是为异常提供特殊的类名（即“日期选择器特殊”）：

```
<input class="required  date-picker date-picker-special input-small align-center" id="policy_starts_on" name="policy[starts_on]" size="30" type="text" value="02/27/2013">

<input class="required date-picker date-picker-special input-small align-center" id="act_event_ends_on" name="act_event[ends_on]" size="30" type="text"> 
```

然后您可以执行以下操作：

```
$(".date-picker:not('.date-picker-special')").datepicker();
$('#policy_starts_on.date-picker').datepicker({
    startDate: '0',
    endDate: '+90d'
});
$('#act_event_ends_on.date-picker').datepicker({
    startDate: '0',
    endDate: '+180d'
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:16:27.363

只是为了实验，如果您以相反的顺序声明这些日期选择器设置，是否会发生相反的行为？如果另一个坏了，那么你可以断定 datepicker 有一个错误（这不太可能）。否则，您需要查看自己的代码。

另外，请注意，您在每个块之前都添加了如下内容：

```
$(".date-picker:not('#policy_starts_on')").datepicker(); 
```

这就是说选择除一个特定日期之外的所有日期选择器。

所以下次你设置一个时，它已经被说出来了。尝试删除那些单线，你会得到：

```
$('#policy_starts_on.date-picker').datepicker({
    startDate: '0',
    endDate: '+90d'
});

$('#act_event_ends_on.date-picker').datepicker({
    startDate: '0',
    endDate: '+180d'
}); 
```

# animation - how to take maya animation file in to unity?

> ID：15118061
> 
> 赞同：-1
> 
> 时间：2013-02-27T17:10:28.787
> 
> 标签：animation, unity3d, maya

I have a clip for a character in maya that I want to add character animations to, like jump, run, etc. in Unity , so basically I want to know how to link those animations with the character in unity.

Also please provide me any website to learn basics of unity and games creation like mario etc

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:26:03.393

您可以将它们拖放到项目窗口中的文件夹中`Unity3D`。

对于我认为你需要安装在同一台机器上运行的`Maya`文件。或者，您可以从 Maya 以格式导出它们。FBX 格式可以在其中存储剪辑和装备数据。`.ma``Maya``Unity3D``FBX`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T11:38:20.100

执行此操作的典型方法：

*   将姿势姿势中的角色导出到 FBX 文件（几何和骨骼） - Character.fbx
*   将您的角色动画导出到单独的 FBX 文件，例如 idle@Character.fbx、walk@Character.fbx、run@Character.fbx（这样的命名很重要）（仅包括骨骼和动画（但您也可以包括几何图形））
*   统一导入 FBX 文件，并将角色添加到场景中 - Unity 会自动检测 idle@Character.fbx、walk@Character.fbx、run@Character.fbx 是 Character 的动画（您可以通过选择 Character 来查看所有动画在场景中并打开动画编辑器）。

或者您可以将所有（模型、动画）导出为单个 FBX 文件，并将动画拆分为 unity Inspector 中的剪辑。

# ios - 处理传入请求（Facebook iOS SDK）

> ID：15118072
> 
> 赞同：0
> 
> 时间：2013-02-27T17:11:37.907
> 
> 标签：ios, facebook, app-store-connect, facebook-ios-sdk

我知道以下方法仅在通过 Facebook 流程打开应用程序时实现，即通过 Facebook iOS 应用程序中的通知

```
 - (BOOL)application:(UIApplication *)application 
                  openURL:(NSURL *)url
        sourceApplication:(NSString *)sourceApplication 
               annotation:(id)annotation 
        {
           return [FBSession.activeSession handleOpenURL:url]; 
        } 
```

在这个方法中接收到的 url 用于处理另一个用户发送的传入请求。我对此有几个问题。

1.  那么这是否意味着由于没有安装 facebook 应用程序而无法在 iOS 模拟器上测试请求的处理？

2.  或者如果可以在模拟器上使用 Safari 测试功能，我们是否需要有一个 iPhone 应用商店 ID，以便我们的应用可以从浏览器重定向到？

3.  因此，这是否意味着没有 iTunes Connect 帐户就无法测试传入请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:29:26.630

1.  这取决于您所说的请求是什么意思。您可以编写一个测试应用程序来调用您定义的自定义 URL 方案或在 Safari 中对其进行测试。如果“请求”是指推送通知，这将是模拟它们的好方法。但是，模拟器不支持推送通知。您将使用 iOS 设备来测试它们。

2.  往上看。当您创建一个指向自定义 url 方案的链接（如常规 HTML 锚点）并安装“侦听”这些 url 的应用程序时，它将在用户按下链接时打开。例如`<a href="yourapp://path/?bar=1&foo=2">Link</a>`

3.  也许您可以详细说明“传入请求”的含义。如果您指的是推送通知，那么是的，您需要一个开发人员帐户才能测试推送通知。此外，它们只能在硬件上工作，而不能在模拟器中工作。然后，您可以研究模拟通知的方法，如上所述。

# objective-c - 在 iOS 中使用 Dropbox Sync API 和 Dropbox Standard API

> ID：15118075
> 
> 赞同：3
> 
> 时间：2013-02-27T17:11:39.367
> 
> 标签：objective-c, sync, dropbox-api

我需要和两者一起`DropboxSDK.framework`工作`Dropbox.framework`

这是一个错误并且两者都具有相同的功能吗？

如果不是，我需要这两个框架的功能，但由于重复声明，构建中会出现一些崩溃：

```
.../Dropbox.framework/Headers/DBAccountInfo.h:5:1: Duplicate interface definition for class 'DBAccountInfo' 
```

..`./Dropbox.framework/Headers/DBError.h:32:3: Typedef redefinition with different types ('enum DBErrorCode' vs 'enum DBErrorCode')`

# java - 令牌“}”上的 Java 语法错误，{ 应在此令牌之后

> ID：15118078
> 
> 赞同：-3
> 
> 时间：2013-02-27T17:11:44.853
> 
> 标签：java

我不确定是什么导致我的一种方法出现 Java 语法错误。我已经对有错误的地方发表了评论。

```
import java.io.*;
import java.net.*;
import java.util.*;

import Products.Items;

public class  ItemProcess{
    private static ArrayList<Items> itemList = new ArrayList<Items>();
    ServerSocket serverSocket = null;
    final int PORT = 1234;
    Socket client;
    ClientHandler handler;

    public static void main(String[] args) throws IOException {

        Items[] item = { new Items(123, "ABCDEE fghikop"),
                new Items(180, "hgiuhygihuvg KHJMLOP"), };
        for (int i = 0; i < item.length; i++)
            itemList.add(item[i]);  
        Calendar start = Calendar.getInstance();
        int date = start.get(Calendar.DATE);
        int month = start.get(Calendar.MONTH);
        int year = start.get(Calendar.YEAR);

        Scanner input = new Scanner(System.in);

        System.out.print("Enter finishing time in 24-hr format ");
        System.out.print("(e.g. 17:52) :  ");
        String timeString = input.nextLine();

        String hourString = timeString.substring(0,2);
        int hour = Integer.parseInt(hourString);

        String minString = timeString.substring(3,5);
        int minute = Integer.parseInt(minString);

        Calendar deadline = Calendar.getInstance();

        deadline.set(year,month,date,hour,minute,0);

        System.out.println("\n\nDeadline: "
                            + getDateTime(deadline) + "\n");

        Calendar now = Calendar.getInstance();

        while(now.before(deadline))
        {
            System.out.println(getDateTime(now));

            try
            {
                Thread.sleep(2000);
            }
            catch (InterruptedException intEx)
            {

            }

            now = Calendar.getInstance();
        }
        System.out.println("\n\nDeadline reached!!!\n");
    }

    public static String getDateTime(Calendar dateTime)
    {       

        String hour2Digits =
                String.format("%02d",
                        dateTime.get(Calendar.HOUR_OF_DAY));
        String min2Digits =
                String.format("%02d",
                            dateTime.get(Calendar.MINUTE));

        return(dateTime.get(Calendar.DATE) + "/"
                + (dateTime.get(Calendar.MONTH)+1) + "/"
                + dateTime.get(Calendar.YEAR) + "  "
                + hour2Digits + ":" + min2Digits);
    } //I am getting the syntax error on here which reads like this "Syntax error on token "}",{ expected after this token

        try
        {
            serverSocket = new ServerSocket(PORT);
        }
        catch (IOException ioEx)
        {
            System.out.println("\nUnable to set up port!");
            System.exit(1);
        }

        System.out.println("\nServer running...\n");

        do
        {
            client = serverSocket.accept();
            //Wait for client.
            System.out.println("\nNew client accepted.\n");
            handler = new ClientHandler(client);
            handler.start();
        }while (true);
    }

class ClientHandler extends Thread
{
    private Socket client;
    private Scanner input;
    private PrintWriter output;

    public ClientHandler(Socket socket) throws IOException
    {
        client = socket;

        input = new Scanner(client.getInputStream());
        output = new PrintWriter(
                        client.getOutputStream(),true);
    }

    public void run()
    {
        String received;

        do
        {
            received = input.nextLine();
            output.println("ECHO: " + received);
        }while (!received.equals("QUIT"));

        try
        {
            System.out.println("Closing down connection...");
            client.close();
        }
        catch(IOException ioEx)
        {
            System.out.println("* Disconnection problem! *");
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:14:18.577

你应该正确缩进你的代码，它会帮助你找到这种类型的错误。此代码不在方法内，Java 中不允许这样做：

```
 try
    {
        serverSocket = new ServerSocket(PORT);
    }
    catch (IOException ioEx)
    {
        System.out.println("\nUnable to set up port!");
        System.exit(1);
    }

    System.out.println("\nServer running...\n");

    do
    {
        client = serverSocket.accept();
        //Wait for client.
        System.out.println("\nNew client accepted.\n");
        handler = new ClientHandler(client);
        handler.start();
    }while (true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:14:06.973

您有一个不适合任何方法的错误尝试捕获。我不确定你的意思。就在`getDateTime`方法之后。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:14:17.653

方法之后的代码`getDateTime()`应该在**方法块**内。目前它不在任何方法内。将其放在适当的方法块中。

```
 public void someMethod() {
    try
    {
        serverSocket = new ServerSocket(PORT);
   // rest of your code 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T17:15:06.620

这`}`结束了您的`getDateTime`方法，之后您有一堆搁浅的代码（如下）需要以某种方式封装在一个块中。

```
 try
    {
        serverSocket = new ServerSocket(PORT);
    }
    catch (IOException ioEx)
    {
        System.out.println("\nUnable to set up port!");
        System.exit(1);
    }

    System.out.println("\nServer running...\n");

    do
    {
        client = serverSocket.accept();
        //Wait for client.
        System.out.println("\nNew client accepted.\n");
        handler = new ClientHandler(client);
        handler.start();
    } while (true); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T17:23:58.993

这是什么？？我相信，在您的评论之后开始的代码没有任何功能。这是不可能的。你应该把它放在任何函数中。

此外，您可以使用 SimpleDateFormat 将您的日期转换为指定格式的字符串，例如：

```
SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
String date = sdf.format(new Date()); 
```

# android - Android 小部件在运行时的外观和感觉不同

> ID：15118086
> 
> 赞同：0
> 
> 时间：2013-02-27T17:12:06.440
> 
> 标签：android, adt, look-and-feel, android-theme, eclipse-adt

我正在使用 Eclipse ADT 开发我的第一个 Android 应用程序。

在 Eclipse 中，您可以使用图形布局窗口中显示的菜单更改主题。我决定使用*黑色*主题，因为我喜欢使用该主题的 UI 组件的外观。

![选择主题](../Images/d90741f7af8115c615c32a4b3ccf8526.png)

我的 UI 小部件之一是搜索栏。这是使用*黑色*主题的外观：

![求吧黑色主题](../Images/b74d568700d3de41cfdbde6600c224f0.png)

当我使用 Nexus S 虚拟设备测试（运行）我的应用程序时，搜索栏看起来不同：

![寻求酒吧 Nexus s](../Images/009e5dcc54bdaa6cea2ba9e66461dc91.png)

为什么它们看起来不一样？（我猜 Eclipse 只是向我展示了该主题的外观，而不是在任何地方实际设置它，并且当我运行我的应用程序时，它会从目标平台*继承*主题。）有没有办法可以*强制*我的应用程序的外观和感觉？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:14:28.393

因为 Android UI 已经进化和改变了。您发布的第一张图片是 Android 2.2 (ish)，然后第二张图片看起来像 Android >= 4.0。

其次，AFAIK，从该菜单更改主题仅用于在 GUI 布局编辑器中检查应用程序 UI - 它不会更改在模拟器或真实设备中启动时的主题。为此，您需要在清单中指定主题。

您也可以使用 GUI 编辑器最右侧的 Android 图标更改预览中使用的 Android 版本。您还可以使用同一工具栏上最左侧的图标一次预览多个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:17:42.147

罗科德所说的。

我会加两分钱：

如果您想在所有 Android 版本中拥有一个外观一致的应用程序，您可以查看 HoloEverywhere 项目。

该项目本质上是 Android pre 4.0 的 Holo 主题的反向移植。

你可以在这里查看：http: [//www.holoeverywhere.com/](http://www.holoeverywhere.com/)

# java - java.lang.IndexOutOfBoundsException

> ID：15118088
> 
> 赞同：-7
> 
> 时间：2013-02-27T17:12:12.523
> 
> 标签：java

我有一个 ArrayList，我在其中插入来自 SQL 查询的数据。

```
ArrayList<Integer> intArray = new ArrayList<>();

 while (result.next())
 {
 intArray.add(result.getInt("CNT"));     // Insert the result into Java Array List
 } 
```

然后我使用这个 ArrayList 将数据插入到 Java 对象中：

```
dc = new DCDataObj(
             intArray.get(0),
             intArray.get(1),
             intArray.get(2),
             intArray.get(3),
             ......................... 
```

但有时 arrayList 很短，Java 对象的属性和我得到 `java.lang.IndexOutOfBoundsException: Index: 39, Size: 39`

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:15:45.910

如果它需要 X 参数，则无法构建您的对象，只有 X - 1 个元素的列表。

所以问题不是你怎么能做到这一点，而是你想做什么。

您至少可以测试列表的大小，并且仅当您有足够的元素时才构建对象。

# r - 每个类别，每个变量的百分比条形图

> ID：15118095
> 
> 赞同：1
> 
> 时间：2013-02-27T17:12:49.060
> 
> 标签：r, plot, ggplot2

给定以下示例数据：

```
df<-data.frame(cbind(cntry<- c("BE","ES","IN","GE","BE","ES","GE",NA,"IN","IN"),
gndr<- c(NA,1,2,2,2,2,1,1,1,2),
plcvcrcR<-c(0,1,NA,0,0,1,1,1,0,0),
plcpvcrR<-c(0,1,1,1,NA,0,0,0,0,0),
plccbrgR<- c(0,1,0,NA,0,1,0,1,1,0),
plcarcrR<-c(1,0,0,NA,1,0,1,0,0,0),
plcrspcR<-c(1,1,0,0,0,0,0,1,1,NA)))
colnames(df)<- c("cntry", "gndr", "plcvcrcR", "plcpvcrR", "plccbrgR", "plcarcrR", "plcrspcR")
df 
```

我怎样才能制作条形图，例如为每个性别（ ）显示变量, ,`gndr`的百分比？最好将每个性别的条形图分组，并为不同的变量使用不同的颜色。`1-values``plcpvcrR``plccbrgR``plcarcrR`

类似于这张图片，其中一种颜色代表问题，组代表性别（​​没有置信区间）：

[https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcSsAlUJsqdhxXHiY35FxFmVx3BREVji_ca24w9ub_OYEfZ3O50X5Q](https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcSsAlUJsqdhxXHiY35FxFmVx3BREVji_ca24w9ub_OYEfZ3O50X5Q)

我已经尝试过以下功能，我知道它包含许多缺陷：

```
barplot(((colSums(df[c(3:5)], na.rm=TRUE)/nrow(df[c(3:5)]))*100)~gndr) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:31:25.813

我会做这样的事情：

```
require(ggplot2)
require(reshape2)
require(scales)
require(plyr)

# remove NA from gndr
df <- df[!is.na(df$gndr), ]
# now get percentages
df.o <- ddply(df, .(gndr), summarise, 
              plcpvcrR = sum(plcpvcrR == 1, na.rm = T)/sum(!is.na(plcpvcrR)), 
              plccbrgR = sum(plccbrgR == 1, na.rm = T)/sum(!is.na(plccbrgR)), 
              plcrspcR = sum(plcrspcR == 1, na.rm = T)/sum(!is.na(plcrspcR)))
# melt it:
df.m <- melt(df.o, id.var = "gndr")

# plot it:
ggplot(data = df.m, aes(x=gndr)) + geom_bar(aes(weights=value, fill=variable), 
      position = "dodge") + scale_y_continuous(labels=percent) 
```

可能有更简单/直接的方法来获得百分比。这是情节：

![在此处输入图像描述](../Images/21fb201797f2dcfa31e29210516b3bdc.png)

# javascript - 来自 SpringMVC 控制器的带引号的字符串，未使用 javascript-jquery 显示

> ID：15118096
> 
> 赞同：0
> 
> 时间：2013-02-27T17:12:52.070
> 
> 标签：javascript, jquery, database, string, spring-mvc

我尝试使用从 Spring MVC 控制器发送的 jquery 显示数据。问题是字符串有数据库中的引号，因此，我的 javascript - jquery 代码不起作用。

例如，我的字符串是数据库中的 (principal:"Carl Duvierts")，由控制器发送。

```
alert("${person.name}"); //not working 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:09:16.657

如果您正在使用的对象已经是一个字符串，那么您不需要在警报中使用引号。

```
//this will work
var stringWithQuotes = 'abc"de"fg';
alert(stringWithQuotes);//no quotation marks inside the parentheses

//The code you provided:
alert("${person.name}");
//will just alert the actual string '${person.name}', not what is referenced by the variable 
```

# c++ - 在结构中使用 int (*)[4] 时访问冲突

> ID：15118098
> 
> 赞同：-1
> 
> 时间：2013-02-27T17:13:00.703
> 
> 标签：c++, pointers, multidimensional-array, access-violation

我在我的代码中定义整数数组：

```
unsigned int tara[1024][3];
unsigned int data[1024][4]; 
```

我有存储结构，允许我将它们传递为`void*`：

```
 struct storage {
     unsigned int (*data)[4];
     unsigned int (*tara)[3];
 }; 
```

这是我对上面结构的使用：

```
 int main() {
   unsigned int tara[1024][3];
   unsigned int data[1024][4];

   storage but_data;
   but_data.data = data;
   but_data.tara = tara;
   tara_button.setCallback(taraButtonCallback, (void*)&but_data);  //Some UI class
   while(true);   //The program
   return 0;
 } 
```

在回调中，这是我尝试访问数据的方式：

```
bool taraButtonCallback(Opencv_Button* but, void* but_data)
{
    storage* data_struct = (storage*)but_data;
    int max = -5;
    int max_value = 0;
    cout<<data_struct->data[0][0]<<'\n';  //!!ERROR!!
    return true;
} 
```

这是我得到的**运行时**错误：

> *OpenCV.exe*中 0x00394f1c处的未处理异常：*0xC0000005*：**访问冲突**读取位置*0x00000005*。

### 编辑：

问题与定义在哪里无关`but_data`！此回调有效：

```
bool taraButtonCallback(Opencv_Button* but, void* but_data)
{
    storage* data = (storage*)but_data;
    set_tara(data->data, data->tara, *data->mat);
    *(data->tara_set) = true;
    return true;
}
void set_tara(unsigned int data[][4], unsigned int tara[][3], Mat &UI_bot)
{
    UI_bot = Scalar(0, 0, 0);
    for(int x=0; x<cam_frame_width; x++) {
        tara[x][0]=data[x][0];
        tara[x][1]=data[x][1];
        tara[x][2]=data[x][2];
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:17:15.050

在调用回调时，but_data 已经被销毁：

```
storage but_data; 
```

它是在本地分配的，这意味着它的生命周期受限于当前函数的结束。函数完成后，它不再存在，回调使用一个悬空指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:30:25.427

只需将它分配给一个变量并打印它

```
 int taraButtonCallback(void* but_data)
 {
      struct storage* data = ( struct storage*)but_data;
      int max = -5;
      int max_value = 0;
      int val = data->data[0][0];
      cout <<val ;  //!!works!!
      return 0;
   } 
```

我认为 cout 在这种情况下无法处理 [][] .. 我不确定为什么有人可以启发我们俩

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-27T18:39:40.430

您可以尝试像这样分配变量`storage but_data`：

```
storage *but_data = new storage; 
```

有效地创建一个具有无限生命周期的变量。比你定义你的回调函数有点不同（因为你已经有一个指针，所以你不需要变量的地址） - 像这样：

```
tara_button.setCallback(taraButtonCallback, (void*)but_data);
//note the lack of '&' sign before the but_data variable name 
```

只是不要忘记在不再需要它后将其删除！

```
delete but_data; 
```

# html - 带有映射链接的单一图像导航。我可以在悬停时使图像的每个部分不透明吗？

> ID：15118110
> 
> 赞同：0
> 
> 时间：2013-02-27T17:13:53.370
> 
> 标签：html, css, image

我在网站顶部有一张用于导航的图片。我曾经为横幅的每个部分设置链接。我想为图像的每个部分实现悬停不透明效果。这可能吗？非常感谢，戴恩。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:19:24.040

您可以将图像切成单独的图像；每次翻转一个，图像仍然看起来是一个图像，但会有不同的部分；对于悬停，您可以使用 javascript 或将其替换为另一个看起来不透明的图像

该站点显示了 JS 方法和 CSS 方法...

[http://www.webvamp.co.uk/blog/coding/css-image-rollovers/](http://www.webvamp.co.uk/blog/coding/css-image-rollovers/)

只需对图像的每个部分重复它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:44:33.127

每个部分都可以有一个 div。每个 div 都会调用一个 javascript 事件。这甚至可以改变 div 的样式。像这样的东西：

```
<javascript>
   function changeCss(getId){
     var getDiv = document.getElementById(getId)
     getDiv.className ="myHover"      
   }
</javascript>
<styles>
.plain{
width:150px; 
height:200px; 
position:absolute; 
top:0; 
left:0; 
z-index:1000;
background-color: #666699; 
}
.myHover{
width:150px; 
height:200px; 
position:absolute; 
top:0; 
left:0; 
z-index:1000;
background-color: #666699; 
filter: alpha(opacity=80);
}
</styles>

    <div onMouseOver="changeCss(this.id)" id="wait" class="plain">
      <img src=""/>                                   
    </div> 
```

这只是随意的，尚未经过测试。试一试，如果有任何问题，请告诉我。

# python - 将函数应用于熊猫数据框的每一行以创建两个新列

> ID：15118111
> 
> 赞同：42
> 
> 时间：2013-02-27T17:13:54.930
> 
> 标签：python, pandas

我有一个 pandas DataFrame，`st`包含多列：

```
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 53732 entries, 1993-01-07 12:23:58 to 2012-12-02 20:06:23
Data columns:
Date(dd-mm-yy)_Time(hh-mm-ss)       53732  non-null values
Julian_Day                          53732  non-null values
AOT_1020                            53716  non-null values
AOT_870                             53732  non-null values
AOT_675                             53188  non-null values
AOT_500                             51687  non-null values
AOT_440                             53727  non-null values
AOT_380                             51864  non-null values
AOT_340                             52852  non-null values
Water(cm)                           51687  non-null values
%TripletVar_1020                    53710  non-null values
%TripletVar_870                     53726  non-null values
%TripletVar_675                     53182  non-null values
%TripletVar_500                     51683  non-null values
%TripletVar_440                     53721  non-null values
%TripletVar_380                     51860  non-null values
%TripletVar_340                     52846  non-null values
440-870Angstrom                     53732  non-null values
380-500Angstrom                     52253  non-null values
440-675Angstrom                     53732  non-null values
500-870Angstrom                     53732  non-null values
340-440Angstrom                     53277  non-null values
Last_Processing_Date(dd/mm/yyyy)    53732  non-null values
Solar_Zenith_Angle                  53732  non-null values
dtypes: datetime64[ns](1), float64(22), object(1) 
```

我想基于将函数应用于数据框的每一行来为此数据框创建两个新列。我不想多次调用该函数（例如，通过两次单独的`apply`调用），因为它的计算量相当大。我曾尝试以两种方式做到这一点，但它们都不起作用：

* * *

**使用`apply`：**

我编写了一个函数，它接受`Series`并返回我想要的值的元组：

```
def calculate(s):
    a = s['path'] + 2*s['row'] # Simple calc for example
    b = s['path'] * 0.153
    return (a, b) 
```

尝试将此应用于 DataFrame 会出现错误：

```
st.apply(calculate, axis=1)
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-248-acb7a44054a7> in <module>()
----> 1 st.apply(calculate, axis=1)

C:\Python27\lib\site-packages\pandas\core\frame.pyc in apply(self, func, axis, broadcast, raw, args, **kwds)
   4191                     return self._apply_raw(f, axis)
   4192                 else:
-> 4193                     return self._apply_standard(f, axis)
   4194             else:
   4195                 return self._apply_broadcast(f, axis)

C:\Python27\lib\site-packages\pandas\core\frame.pyc in _apply_standard(self, func, axis, ignore_failures)
   4274                 index = None
   4275 
-> 4276             result = self._constructor(data=results, index=index)
   4277             result.rename(columns=dict(zip(range(len(res_index)), res_index)),
   4278                           inplace=True)

C:\Python27\lib\site-packages\pandas\core\frame.pyc in __init__(self, data, index, columns, dtype, copy)
    390             mgr = self._init_mgr(data, index, columns, dtype=dtype, copy=copy)
    391         elif isinstance(data, dict):
--> 392             mgr = self._init_dict(data, index, columns, dtype=dtype)
    393         elif isinstance(data, ma.MaskedArray):
    394             mask = ma.getmaskarray(data)

C:\Python27\lib\site-packages\pandas\core\frame.pyc in _init_dict(self, data, index, columns, dtype)
    521 
    522         return _arrays_to_mgr(arrays, data_names, index, columns,
--> 523                               dtype=dtype)
    524 
    525     def _init_ndarray(self, values, index, columns, dtype=None,

C:\Python27\lib\site-packages\pandas\core\frame.pyc in _arrays_to_mgr(arrays, arr_names, index, columns, dtype)
   5411 
   5412     # consolidate for now
-> 5413     mgr = BlockManager(blocks, axes)
   5414     return mgr.consolidate()
   5415 

C:\Python27\lib\site-packages\pandas\core\internals.pyc in __init__(self, blocks, axes, do_integrity_check)
    802 
    803         if do_integrity_check:
--> 804             self._verify_integrity()
    805 
    806         self._consolidate_check()

C:\Python27\lib\site-packages\pandas\core\internals.pyc in _verify_integrity(self)
    892                                      "items")
    893             if block.values.shape[1:] != mgr_shape[1:]:
--> 894                 raise AssertionError('Block shape incompatible with manager')
    895         tot_items = sum(len(x.items) for x in self.blocks)
    896         if len(self.items) != tot_items:

AssertionError: Block shape incompatible with manager 
```

[然后，我将使用此问题](https://stackoverflow.com/questions/12356501/pandas-create-two-new-columns-in-a-dataframe-with-values-calculated-from-a-pre)中显示的方法将返回的值分配`apply`给两个新列。但是，我什至无法达到这一点！如果我只返回一个值，这一切都很好。

* * *

**使用循环：**

我首先创建了数据框的两个新列并将它们设置为`None`：

```
st['a'] = None
st['b'] = None 
```

然后遍历所有索引并尝试修改`None`我在那里得到的这些值，但我所做的修改似乎不起作用。也就是说，没有产生错误，但似乎没有修改DataFrame。

```
for i in st.index:
    # do calc here
    st.ix[i]['a'] = a
    st.ix[i]['b'] = b 
```

* * *

我认为这两种方法都可以，但它们都没有。那么，我在这里做错了什么？最好、最“pythonic”和“pandaonic”的方法是什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-28T01:21:16.033

要使第一种方法起作用，请尝试返回 Series 而不是元组（apply 会引发异常，因为它不知道如何将行重新粘合在一起，因为列数与原始帧不匹配）。

```
def calculate(s):
    a = s['path'] + 2*s['row'] # Simple calc for example
    b = s['path'] * 0.153
    return pd.Series(dict(col1=a, col2=b)) 
```

如果您更换，第二种方法应该有效：

```
st.ix[i]['a'] = a 
```

和：

```
st.ix[i, 'a'] = a 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-06-14T18:14:40.657

我总是使用 lambdas 和内置`map()`函数通过组合其他行来创建新行：

```
st['a'] = map(lambda path, row: path + 2 * row, st['path'], st['row']) 
```

对于数值列的线性组合，它可能比必要的稍微复杂一些。另一方面，我觉得采用约定是很好的，因为它可以用于更复杂的行组合（例如使用字符串）或使用其他列的函数填充列中的缺失数据。

例如，假设您有一个包含性别和标题列的表，并且缺少一些标题。您可以使用如下函数填充它们：

```
title_dict = {'male': 'mr.', 'female': 'ms.'}
table['title'] = map(lambda title,
    gender: title if title != None else title_dict[gender],
    table['title'], table['gender']) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-07-23T13:48:07.547

这在这里解决了： [Apply pandas function to column to create multiple new columns？](https://stackoverflow.com/questions/16236684/apply-pandas-function-which-returns-multiple-values)

适用于您的问题，这应该有效：

```
def calculate(s):
    a = s['path'] + 2*s['row'] # Simple calc for example
    b = s['path'] * 0.153
    return pd.Series({'col1': a, 'col2': b})

df = df.merge(df.apply(calculate, axis=1), left_index=True, right_index=True) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-10T05:11:29.907

[基于在方法链中分配新列的](http://pandas.pydata.org/pandas-docs/stable/dsintro.html#assigning-new-columns-in-method-chains)另一种解决方案：

```
st.assign(a = st['path'] + 2*st['row'], b = st['path'] * 0.153) 
```

请注意，`assign` **始终**返回数据的副本，而原始 DataFrame 保持不变。

# php - 使用 jQuery 从 PHP 表单中选择文本输入

> ID：15118114
> 
> 赞同：1
> 
> 时间：2013-02-27T17:13:58.317
> 
> 标签：php, javascript, jquery, html

我有创建表的 php 代码。对于采购订单上的每个项目，都会创建并填充一个新行。目标是在编辑采购订单时将其回发并保存在数据库中。一切正常，除了我的 jQuery 代码只会迭代第一行，不管我有多少行。（因此，如果我有三行，它将打印第一行 carid 三次。）

对不起，如果事情看起来很乱。

PHP代码：

```
<?php while($row = mysql_fetch_array($itemsquery)){?>
      <tr class="item-row" id="<?php echo $row['cart_id']?>">
          <td class="item-name"><div class="delete-wpr"><textarea><?php echo $row['on0'];?> <?php echo $row['itemname'];?></textarea><a class="delete" href="javascript:;" title="Remove row">X</a></div></td>
          <td class="description"><textarea class="cartid"><?php echo $row['cart_id'];?></textarea></td>
          <td><textarea class="cost" class="text-input" type="text"><?php echo $row['itemprice'];?></textarea></td>
          <td><textarea class="qty" type="text" name="name"><?php echo $row['quantity'];?></textarea></td>
          <td><span class="price" type="text">$<?php 
        $linecost = $row['quantity'] * $row['itemprice'];
        echo $linecost;?></span></td>
      </tr>
    <?php }?> 
```

jQuery 语句，看看它抓取了什么：

```
$(document).ready(function(){
$(".item-row").change(function() {
$((".cartid")).each(function(){
    row = {
        cartid: $(".cartid").val()
        }  

 alert(row.cartid);
 performAjaxSubmission();
 })
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:23:21.220

看起来你只是把你的选择器弄混了。您想要遍历每一行，但您的选择器引用了 $(".cartid")，它总是会返回第一个结果。

这应该可以解决您的问题：

```
$(document).ready(function(){
$(".item-row").change(function() {
    $(".item-row").each(function(){
        var rowContext = $(this);
        var row = {
            cartid: $(".cartid", rowContext).val()
        }  
    alert(row.cartid);
    performAjaxSubmission();
});
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:21:39.353

你这样迭代：

```
$(".cartid").each(function(){
row = {
    cartid: $(".cartid").val()
    } 
```

好像你应该做

```
$(".cartid").each(function(){
row = {
    cartid: $(this).val()
    } 
```

没有检查其余的代码。

**编辑：**

```
$(".cartid").each(function(){
var cart = $(this);
row = {
    cartid: cart.val()
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:19:42.427

你的选择器中有额外`()`的东西`.cartid`。

```
$(document).ready(function(){
$(".item-row").change(function() {
$(".cartid").each(function(){
    row = {
        cartid: $(".cartid").val()
        }  

 alert(row.cartid);
 performAjaxSubmission();
 })
}); 
```

另外，你不应该循环槽`.item-row`而不是`.cartid`？

# php - PHP 动态变量作为 jQuery 选择器

> ID：15118116
> 
> 赞同：0
> 
> 时间：2013-02-27T17:13:59.383
> 
> 标签：php, javascript, jquery, variables, selector

经过几个小时的挫折，我终于找到了导致错误的代码行，但现在我需要知道原因。

jQuery 抛出了这个错误：`Uncaught Error: Syntax error, unrecognized expression: .`

我研究了一下，发现这是当 jQuery 找不到引用的选择器时发生的 Sizzle 错误。正如其他关于 SO 的问题所建议的那样，这实际上不是我的 jQuery 代码中的错误，而是在其他地方。

我正在定义一个变量以用作加载内容的目标元素，并使用 PHP 来动态定义变量，如下所示：

`var $container = $(".<? echo $target ?>");`

这不起作用，因为`.`被标记为无法识别的表达式。但是，用静态字符串替换 PHP 变量可以正常工作：

`var $container = $(".target");`

这对我来说很难找到，因为我无法确定引发错误的行，并且在浏览器的源代码中，上面的初始行看起来就像第二行一样。

为什么第一个示例不起作用？它与执行顺序有关吗？而且，如何使用动态变量作为选择器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:16:33.477

你必须使用

```
<?php echo $test; ?> 
```

或快捷方式：

```
<?= $test ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:14:04.017

原来我正在加载的页面没有将变量 $target 传递给它。在初始页面上，$target 被初始化为一个值，因此源输出看起来与问题中指定的一样。但是，我使用新数据重新加载页面的 ajax 调用没有传递变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:19:44.533

`trim($target)`您可以在执行此操作之前尝试。如果它有效，您的变量中可能有一些不需要的空格。

还可以考虑使用`json_encode`将变量从 php 传递到 javascript。像这样：

```
var selector = <?php echo json_encode($target); ?>;
var $container = $(selector); 
```

这将使您不仅可以传递简单的字符串，还可以传递更复杂的变量结构（并且具有编码安全性）。

# php - 为什么这个 PHP 发送文件会破坏数据？

> ID：15118117
> 
> 赞同：0
> 
> 时间：2013-02-27T17:13:59.683
> 
> 标签：php, zend-framework

我有一个项目，它简单地将文件存储在服务器上。当有人想下载文件时，我必须通过一个中间控制器（Zend 框架）传递请求，为文件提供一些保护。

当有人请求该文件时，该文件被下载到客户端浏览器，但是，在我的所有测试中，该文件总是损坏（尽管它的字节大小是正确的）。有人可以告诉我我在这里做错了什么吗？

```
 public function downloadAction() {
    $this->_helper->layout->disableLayout();
    $this->_helper->viewRenderer->setNoRender(true);

    $files = new Application_Model_DbTable_Files();

    $file = $files->getFileForDownload($this->_getParam('id'), Zend_Auth::getInstance()->getIdentity()->id);

    $config = Zend_Registry::get('config');

    $this->_helper->layout->disableLayout();
    $this->_helper->viewRenderer->setNoRender();

    if (file_exists($config['mindful']['path'] . $file)) {
        $this->getResponse()->setHeader('Content-type', 'application/octet-stream');
        $this->getResponse()->setHeader('Content-Disposition', 'inline; filename=' . basename($file), false);
        $this->getResponse()->setBody(readfile($config['mindful']['path'] . $file));
    }
} 
```

如您所见，我已经使用 Zend 方法以及标准 PHP 进行了尝试。这两个都给了我相同的结果。

在此先感谢您的帮助！

瑞克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:28:04.247

在许多框架上可能导致文件下载出现问题的一件事是丢失 \n，这些通常发生在 PHP 的 ?> 之后，并最终发送意外的 \n 与您的数据。当您发送 HTML 时，这些 \n 完全无害，但会损坏任何其他文件。

PHP 脚本不要求您关闭 PHP 标记，最好不要关闭它。例外情况是当您使用 PHP 模板（在视图中）时，您显然必须关闭它们。

*   删除您正在访问的控制器（包括控制器）使用的所有模型和组件的？>标签
*   确保在同一文件中的 <?php 标记之前没有输入
*   确保您禁用了此操作的布局和视图渲染（似乎已正确完成）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:28:25.503

`readfile`不返回文件内容，它立即输出它们。返回值是字节数，因此当前将其附加到您的响应正文中。这可能是导致腐败的原因。

`readfile`您可以通过先发送标头并直接调用它来继续使用：

```
$this->getResponse()->setHeader('Content-type', 'application/octet-stream');
$this->getResponse()->setHeader('Content-Disposition', 'inline; filename=' . basename($file), false);
$this->getResponse()->sendHeaders();

readfile($config['mindful']['path'] . $file); 
```

或者如果文件非常小，您可以坚持当前的方法并`file_get_contents`改用：

```
$this->getResponse()->setBody(file_get_contents($config['mindful']['path'] . $file)); 
```

请注意，这些方法都没有提供任何缓存（例如，如果从标头修改后的处理）。

您还可以考虑使用 X-Sendfile，它对内存更友好，并且会为您处理缓存标头。

# javascript - 使用 JQuery 检查邮政编码

> ID：15118124
> 
> 赞同：2
> 
> 时间：2013-02-27T17:14:21.947
> 
> 标签：javascript, jquery

我尝试构建一个表单来检查输入的邮政编码是否与预定义数组中的邮政编码匹配。我不使用数据库，它都是非常基本且硬编码的，但在这种情况下应该足够了。

问题是只有数组中的第一个邮政编码（' *83512* '）有效。如果我输入第二个（' *83533* '），代码会吐出“*不成功*”。

我究竟做错了什么？

提前致谢。

**HTML：**

```
<form action="javascript:alert('success.');" id="checkplz">
    <label for="plz">ZIP:</label>
    <input type="text" name="plz" id="plz" />
    <button id="submit" >Check!</button>
    <div id="output"></div>
</form> 
```

**查询：**

```
$(document).ready(function(){
    var list = ['83512','83533'];
    $("#checkplz").submit(function() {
        for (var i = 0; i < list.length; i++) {
            if ($("#plz").val() == list[i]) {
                $("#output").append("<strong class='success'>success!</strong>").show();
                return true;
            }
            $("#output").text("no success!").show().fadeOut(10000);
                return false;
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:18:31.480

循环中的逻辑已关闭。见下文：

```
$(document).ready(function(){
    var list = ['83512','83533'];
    $("#checkplz").submit(function() {
        var match = false;
        for (var i = 0; i < list.length; i++) {
            if ($("#plz").val() == list[i]) {
                         $("#output").append("<strong class='success'>success!</strong>").show();
                return true;   
            }

        }

        $("#output").text("no success!").show().fadeOut(10000);
                return false;
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:20:25.050

尝试在循环外返回 false ，因此只有在检查了所有值后才会发生：

```
$(document).ready(function(){
    var list = ['83512','83533'];
    $("#checkplz").submit(function() {
        for (var i = 0; i < list.length; i++) {
            if ($("#plz").val() == list[i]) {
                $("#output").append("<strong class='success'>success!</strong>").show();
                return true;
            }
        }
        $("#output").text("no success!").show().fadeOut(10000);
        return false;
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:21:17.633

使用 jQuery.inArray()

```
var list = ['83512','83533'];
if($.inArray('83533', list) > -1){
    // found
} 
```

这里的文档：http: [//api.jquery.com/jQuery.inArray/](http://api.jquery.com/jQuery.inArray/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T17:40:49.843

问题出在你的循环逻辑之内。循环只会运行一次，因为循环总是在第一次迭代后返回（如果它找到列表数组中的第一个元素，则返回 true，其他所有元素返回 false），而不是继续所有迭代。所以，第二个元素发生的事情是循环正在运行，确定第一个元素没有找到并返回 false，甚至从不处理第二个元素。

更好的方法是循环列表数组，直到找到匹配的元素，并跟踪是否找到匹配项。这将确保我们在处理完数组的所有元素之前不会退出循环（或找到匹配项，在这种情况下，我们可以停止循环以节省处理时间）。

请参阅下面（[http://jsfiddle.net/ryanbrill/Kws7A/](http://jsfiddle.net/ryanbrill/Kws7A/)）的一些示例代码，其中包含一些关于正在发生的事情的评论。

```
$(document).ready(function(){
    var list = ['83512','83533'];
    $("#checkplz").submit(function() {
        var matched = false; // Set up variable to track if we find a match
        $(list).each(function() {
            // Inside the jQuery 'each' method, 'this' equals the current item in the iteration.
            if(this == $("#plz").val()) {
                matched = true; // set the 'matched' variable to true
                $("#output").append("<strong class='success'>success!</strong>").show();
                return; // Since we found a match, we can stop processing the array
            }
        });
        // Outside of the loop, only display no success if we didn't find any matches.
        if (!matched) {
            $("#output").text("no success!").show().fadeOut(10000);
        }

    });
}); 
```

# ms-office - VB6 Outlook 加载项在 Outlook 2013 中有效，但仅在安装完整 Office 的情况下？

> ID：15118125
> 
> 赞同：-1
> 
> 时间：2013-02-27T16:59:33.830
> 
> 标签：ms-office

我有一个 VB6 Outlook 加载项。这是在安装了 32 位 OFFICE 的 Windows 7 64 位机器上测试和工作的。

在另一台 PC 上，Windows 7 64 位、32 位 OUTLOOK 安装，加载项不加载。它未列在 COM 加载项列表中，当我尝试手动将其添加到该列表时，它没有出现！

我认为某些办公室 DLL 存在一些依赖性导致问题，但我不知道如何排除故障以找出问题所在。

任何人都可以给我任何提示吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T11:39:31.783

我遇到了完全相同的问题，直到我意识到问题来自 C:\Program Files (x86)\Common Files\DESIGNER\MSADNSDR.DLL，它是由 Office 2013 Pro 带来的，文件在 2010 年修改，而不是家庭版。查看[http://blogs.msdn.com/b/vsod/archive/2012/11/21/vb6-based-add-ins-may-fail-to-work-on-office-2013.aspx](http://blogs.msdn.com/b/vsod/archive/2012/11/21/vb6-based-add-ins-may-fail-to-work-on-office-2013.aspx)和[http： //support.microsoft.com/kb/2792179](http://support.microsoft.com/kb/2792179)提到了这个问题。另一个需要注意的重要事情是，家庭版看起来是 ClickToRun 版（类似 AppV 虚拟化应用程序和专业版是完全安装的版本）。

# spring - 开启 Spring Security 的 Spring Webflow 单元测试

> ID：15118127
> 
> 赞同：0
> 
> 时间：2013-02-27T17:14:27.723
> 
> 标签：spring, spring-security, spring-webflow, spring-webflow-2

我正在尝试测试具有弹簧安全性的 webflow 控制器：

```
<action-state id="search">
    <secured attributes="ROLE_ADMIN"/>
...
</action-state> 
```

我正在使用`AbstractXmlFlowExecutionTests`子类。

现在，测试在没有“安全”标签的情况下运行正常（我没有为安全性做任何模拟），但是一旦我添加了安全性标签，测试就会继续成功完成，尽管我预计会抛出一个安全异常。任何想法为什么它不起作用以及我应该如何配置它？提前致谢！伊戈尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T20:21:02.087

好的，我找到了解决方案：我需要手动添加一个 securityListener。之前`startFlow`：

```
setFlowExecutionListener(getSecurityListener(new String[] {"ROLE_ADMIN_FAKE"})); 
```

在哪里

```
private FlowExecutionListener getSecurityListener(String[] roles) {
    List<GrantedAuthority> result = new ArrayList<>();
    for (String role: roles) {
        SimpleGrantedAuthority authority = new SimpleGrantedAuthority(role);
        result.add(authority);
    }
    Authentication auth = new PreAuthenticatedAuthenticationToken("Igor", "", result);
    SecurityContextHolder.getContext().setAuthentication(auth);
    return new SecurityFlowExecutionListener();
} 
```

# php - 如何格式化 JSON 输出以仅显示引号中的值而不显示键？

> ID：15118129
> 
> 赞同：1
> 
> 时间：2013-02-27T17:14:31.050
> 
> 标签：php, ajax, json, cordova, jquery-mobile

这与之前询问的[需要在 JSON 输出中仅显示数组值有关。](https://stackoverflow.com/questions/8953536/need-to-display-only-array-value-in-json-output)

我只想显示像这样的值

```
[
"autoComplete",
"ColdFusion",
"jQuery Mobile"
]; 
```

背景：我正在通过 Jquery mobile 使用 AJAX 调用从服务器检索数据（语言：PHP）。我想在我的 Phonegap 应用程序中使用[https://github.com/commadelimited/autoComplete.js 。](https://github.com/commadelimited/autoComplete.js)

请指教！我是 JSON 新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:27:10.307

使用 json_encode 时，任何具有从零开始的数字索引的数组（这意味着它不是关联数组并且以 0 开头并且不缺少任何数字）将被转换为 javascript 数组而不是 js 对象字面量。您可以在 php 中使用 array_values 从数字索引的数组中获取所有值。

```
<?php
//a generic array
$a = array(
    'foo'=>'bar',
    'one'=>'two',
    'three'=>'four');

//display the array in php
var_dump($a);
echo '<br>';

//json encode it
$json = json_encode($a);
var_dump($json);
echo '<br>';

//json encode just the values
$json = json_encode(array_values($a));
var_dump($json); 
```

[http://codepad.viper-7.com/hv06zn](http://codepad.viper-7.com/hv06zn)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:41:30.757

谢谢乔纳森。

但是我找到了如下解决方案。我希望它对其他人也有用。

```
$result = mysql_query($sql) or die ("Query error: " . mysql_error());
$records = array();

while($row = mysql_fetch_assoc($result)) {
  $records[] = $row["title"];
}

mysql_close($con);
echo json_encode($records); 
```

# python - 构建 DataFrame 时如何模拟转换器？

> ID：15118131
> 
> 赞同：0
> 
> 时间：2013-02-27T17:15:02.497
> 
> 标签：python, pandas

我正在尝试创建一个小类来处理从 ASCII 文件中读取数据。下面是我写的代码。

```
class EyelinkParser(object):
    eyesample = namedtuple('Eyesample', ('time', 'x', 'y', 'pupil'))
    etevent = namedtuple('EyeTrackerEvent', ('time', 'msg'))
    _pos_cnvrt = lambda v: float(v.strip()) if '.' not in v else str('NaN')
    converters = {'time': lambda t: int(t.strip()),
                  'x': _pos_cnvrt,
                  'y': _pos_cnvrt,
                  'pupil': _pos_cnvrt,
                  'msg': lambda s: s.strip()
                 } 

    def __init__(self, fileobj):
        self.fileobj = fileobj
        self.started = False

        self.sample = []
        self.event = []

        self.parse()

    def parse(self):
        for line in self.fileobj:
            line = line.split('\t')
            if line[0] in ['START', 'END']:
                self.started = line[0] == 'START'

            if self.started:
                self.process_line(line)

        self.sample = pd.DataFrame(self.sample, columns=['time', 'x', 'y', 'pupil'], converters=self.converters)
        self.event = pd.DataFrame(self.event, columns=['time', 'msg'], converters=self.converters)

    def process_line(self, line):
        if len(line) == 2 and line[0] == 'MSG':
            msg_data = line[1].split()
            if len(msg_data) == 2:
                self.event.append(self.etevent(*msg_data))
        elif len(line) == 4:
            # TODO:  replace '.' with NaNs
            self.sample.append(self.eyesample(*line)) 
```

显然`DataFrame`该类不支持转换器。有没有一种简单的方法来完成我想要做的事情？

总而言之，如何在 a 的每一列中指定值的类型转换`DataFrame`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T15:30:48.627

作为调用 DataFrame 的一部分，我不知道如何显式执行此操作。当我遇到这个问题时，我在事后使用以下任何一种：

将类型传递给每一列：

```
 self.sample['x'].astype(int) 
```

但是由于您正在传递函数，因此您可能需要使用以下内容：

```
self.sample['x'].map(_pos_cnvrt) 
self.sample['msg'].map(lambda s:s.strip()) 
```

此外，pandas 还提供了一些向量化字符串方法来提供帮助：

```
self.sample['msg'].str.strip() 
```

# c++ - Visual Studio 2010 访问冲突

> ID：15118135
> 
> 赞同：1
> 
> 时间：2013-02-27T17:15:07.563
> 
> 标签：c++

我的 C++ 代码有问题，看看这个函数：

```
void insere(titem x){
    tlista *aux;
    aux = (tlista*)malloc(sizeof(tlista));
    aux->item = x;
    ultimo->prox = aux;
    ultimo = ultimo->prox;
    aux->prox = NULL;
} 
```

当 line:`aux->item = x;`被执行时，Visual Studio 会说：

> TP6.exe 中 0x53eacafa (msvcr100d.dll) 处未处理的异常：

看看我的结构项目：

```
 struct titem {
      int prioridade;
      string nome;
      int freq;
 }; 
```

在 Dev-C++ 中，代码可以正常工作！什么可能会导致问题，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:16:17.107

您正在使用`malloc`为对象分配内存。这将分配内存，但不会初始化对象。例如，对于非 POD 成员来说，这是一个问题`aux->item.nome`。

而不是使用 malloc 您需要使用`new`.

```
tlista *aux = new tlista; 
```

完成结构后，请使用`delete`它来处理它。

```
delete aux; 
```

由于您使用的是 C++，因此您应该忘记所有关于`malloc`and的内容`free`。堆分配使用C++`new`和`delete`在 C++ 中执行。

# c - scanf 和 printf 只是在第一次后跳过

> ID：15118141
> 
> 赞同：1
> 
> 时间：2013-02-27T17:15:23.447
> 
> 标签：c

这里有什么问题？scanf 似乎不在 while 循环中工作。我试图找出元音和辅音，直到用户想要。

这是代码：

```
#include <stdio.h>
main()
{
    char x,c;
    do
    {
        printf("enter\n");
        scanf("%c",&x);
        if(x=='a'||x=='e'||x=='i'||x=='o'||x=='u')
            printf("vowel\n");
        else
            printf("consonent\n");

        printf("do u want to continue ?(y/n)\n");
        scanf("%d",&c);
        if(c=='n')
            printf("thnks\n");

    } while(c=='y');
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T17:18:40.530

您正在尝试读取`%d`错误的字符。改为使用`%c`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T17:19:11.557

将代码更改为`scanf("%c",&c)`原始代码将 y/n 条目作为数字而不是字符

编辑：

可能你得到的是carage return而不是角色尝试使用`getc`or`fgets`而不是获得第一个角色。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T17:20:29.713

我认为问题可能出在此处： scanf("%d",&c); 它应该是：

```
 scanf("%c",&c); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T17:24:18.090

这是正确的代码：

```
#include <stdio.h>

int main()
{
    char x,c;
    do
    {
        printf("enter\n");
        scanf("%c",&x);
        getchar(); //to remove the \n from the buffer
        if(x=='a'||x=='e'||x=='i'||x=='o'||x=='u')
            printf("vowel\n");
        else
            printf("consonent\n");
        printf("do u want to continue ?(y/n)\n");
        scanf("%c",&c); //Here you were using %d instead of %c
        getchar(); //to remove the \n from the buffer

        if(c=='n')
            printf("thnks\n");
    }while(c=='y');

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T17:56:26.440

两个scanfs都应该这样改变：

```
scanf(" %c",&x); 
```

...

```
scanf(" %c",&c); 
```

注意 之前的空格，这很重要：它消耗前导空格，其中包括处理输入后`%`剩余的结束行字符。`stdin`

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-27T17:25:25.740

请尝试使用此代码多次运行循环。

编辑：没有`fflush(stdin)`. 请定义一个 8 个字符的字符串为

```
char str[8]; 
```

并将循环中的代码修改为

```
fgets(str, 8, stdin); // To read the newline character
printf("do u want to continue ?(y/n)\n");

scanf("%c",&c);
fgets(str, 8, stdin); // To read the newline character 
```

# ios - 在 TableView 的特定单元格中阻止重新排序

> ID：15118142
> 
> 赞同：8
> 
> 时间：2013-02-27T17:15:24.013
> 
> 标签：ios, xcode, uitableview, tableview

我想阻止一个单元格重新排序。

例如：

我有一个 4 行的表格视图，但不希望第一个单元格可以重新排序。

那可能吗？

我试过使用：

```
if(indexPath.row == 0)
{
    [cell setEditing:NO animated:NO];
} 
```

但不起作用。

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-27T18:26:09.197

我找到了答案！

您可以使用 UITableViewDelegate 中的**targetIndexPathForMoveFromRowAtIndexPath**方法。

```
-(NSIndexPath *)tableView:(UITableView *)tableView targetIndexPathForMoveFromRowAtIndexPath:(NSIndexPath *)sourceIndexPath toProposedIndexPath:(NSIndexPath *)proposedDestinationIndexPath{
    if (proposedDestinationIndexPath.row == 0) {
        return sourceIndexPath;
    }
    return proposedDestinationIndexPath; 
```

}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:21:18.217

您的 UITableViewDataSource 应该`-(BOOL)tableView:canMoveRowAtIndexPath:`为 indexPath.row == 0 实现并返回 NO

```
- (BOOL)tableView:canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
    return (indexPath.row != 0);
} 
```

[UITableViewDataSource 文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDataSource_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UITableViewDataSource)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-08-12T09:24:14.977

**SWIFT 5 代码：**

```
func tableView(_ tableView: UITableView, targetIndexPathForMoveFromRowAt sourceIndexPath: IndexPath, toProposedIndexPath proposedDestinationIndexPath: IndexPath) -> IndexPath {

    if proposedDestinationIndexPath.row == 0 {
        return sourceIndexPath
    }

    return proposedDestinationIndexPath
} 
```

# autohotkey - AHK - 标准输出到变量工作，但无法在 comspec 中使用变量

> ID：15118143
> 
> 赞同：1
> 
> 时间：2013-02-27T17:15:27.503
> 
> 标签：autohotkey

当我在我的 comspec 行中使用文字文件路径时，我将标准输出提供给变量，但为什么我不能使用变量来代替我想要分析的文件名？

请注意， mediainfo 已经（成功地）在其自己的参数中使用了 % 符号。那么如何让 comspec 将 %LongPath% 视为实变量？我已经尝试在 %Longpath% 周围添加一对额外的引号，但没有运气。

```
Loop %0%
{
Path := %A_Index%
Loop %Path%, 1
LongPath = %A_LoopFileLongPath%
SplitPath LongPath, OutFileName, OutDir, OutExtension, OutNameNoExt, OutDrive

objShell := ComObjCreate("WScript.Shell")
objExec := objShell.Exec(comspec " /c C:\MediaInfo.exe --Inform=Video;%FrameRate% %LongPath%")
framerate := ""
while, !objExec.StdOut.AtEndOfStream
 framerate := objExec.StdOut.ReadAll()

msgbox %framerate%
} 
```

感谢一些专业知识。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:41:48.683

关键是将应用程序名称和参数括在引号中，（并确保在最后一个引号之前留出一个额外的空格），然后不要在引号中包含您的最终变量。

# google-drive-api - 使用 Google Drive API 删除文件

> ID：15118145
> 
> 赞同：3
> 
> 时间：2013-02-27T17:15:30.117
> 
> 标签：google-drive-api

问题类似于这篇文章（[使用 Google Docs API 删除的文档在 Google Drive 中仍然可见，](https://stackoverflow.com/questions/11909709/documents-deleted-using-google-docs-api-still-visible-in-google-drive)but)并不能真正使用建议的解决方案。当我们使用 delete() 函数删除文件时，文件是否被删除是不是这里的问题,问题是该文件将始终在网络浏览器中可见,甚至无法手动删除。我想知道有没有办法删除文件但也让它在网络用户界面中消失？

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2018-02-23T03:32:43.063

在 v3 API 中，您应该能够使用其 id 删除文件。不要忘记对 service.files().delete() 返回的 Delete 对象调用 execute()。

```
import com.google.api.services.drive.model.*;
import com.google.api.services.drive.Drive;

Drive service = ...;

com.google.api.services.drive.model.File file = ...;

service.files().delete(file.getId()).execute(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T13:47:17.020

我使用了以下内容：

```
public static string DeleteFile(string id)
{
  FilesResource.DeleteRequest request = DriveService.Files.Delete(id);
  return request.Fetch();
} 
```

我已经多次使用此功能清空我的谷歌驱动器而没有问题。让我知道这是否适合您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-08T00:50:47.067

```
FilesResource.DeleteRequest request = service.Files.Delete(fileID);
request.Execute(); 
```

继承人 2020 修复，v3 api。

PS：如果有人能告诉我如何进行语法突出显示，那就太好了。

# git - 如何使用 Git 提交和推送更改

> ID：15118146
> 
> 赞同：8
> 
> 时间：2013-02-27T17:15:32.070
> 
> 标签：git, git-branch, git-commit

我只是想澄清在特定分支上的提交是如何工作的。

假设我正在一个名为“Metro”的分支上工作。我对一些文件进行了一些更改，但我还没有准备好将它们推送到远程存储库。

有一个修补程序，我需要尽快修复。我需要切换到一个名为“Master”的干净分支，但我不能，因为我会覆盖我已更改的文件。我需要先提交这些，然后才能切换。

我的问题是，如果我在“Metro”分支上提交这些更改，然后切换到干净的“Master”分支，在“Metro”中所做的更改是否会被推送到远程“Master”存储库，因为我已经提交了它们，甚至虽然我推到另一个分支？

为了简洁起见，提交是否与分支隔离，或者在推送到远程仓库时是否添加了所有提交？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:20:23.787

在您将分支切换到 master 之前`git checkout master`，您必须先`git commit -m 'some message'`，否则，git 会尝试将您当前分支的更改与您一起带到 master 分支。

> “Metro”中所做的更改是否会因为我已经提交而被推送到远程“Master”仓库，即使我正在推送到另一个分支？

绝对不。`Metro`如果你告诉它这样做，git 只会将提交的更改从合并到 master。这是设计使然（*注意：请阅读 git 遥控器，因为使用遥控器，您实际上可以将推送设置为“默认”执行此操作，在这种情况下您需要小心。*）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T17:23:30.933

> 为了简洁起见，提交是否与分支隔离，或者在推送到远程仓库时是否添加了所有提交？

为了简洁起见：第一部分是的:-)。

从技术上讲，git 中的分支是一个提交链，以及一个名称。如果你推送一个分支，你将推送属于它的所有提交（除非远程仓库已经有它们），但没有别的。所以不，git 不会以某种方式推送所有提交。

但是请注意，您必须注意只推送您想要推送的分支 -`git push`可以配置为推送您的*所有*分支。为避免这种情况，请设置配置变量 push.default：

```
git config push.default current 
```

这确保`git push`只会推送当前分支（而不是所有分支，这曾经是默认的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T17:23:20.067

要了解分支在 Git 中是如何工作的，我认为改变思维方式以始终牢记提交树是很重要的。您有一个提交的非循环树，其中每个提交都有许多父提交，没有别的。分支现在只是指向该树中特定提交的简单指针。如果您对分支进行新提交，那么真正发生的事情就是您创建一个新的提交对象，其中包含以前版本作为其父版本的更改，并且您的分支指针移动到现在添加到整个树中的新提交.

所以，分支是完全相互独立的，同样地，它们并没有多大意义。它们只是指针。

在您的情况下，当您从 切换`metro`到 时`master`，您（可能）在树的另一侧进行操作。您现在创建的所有提交只会移动当前分支指针——master——但不会影响任何其他分支。

如果你推送一个分支，所有发生的事情就是你告诉远程分支指向的提交，然后你给远程它完成树所需的所有对象。

# iphone - 使用 iPhone 的 Phonegap (cordova) 捕获/上传图像无法正常工作

> ID：15118147
> 
> 赞同：2
> 
> 时间：2013-02-27T17:15:40.547
> 
> 标签：iphone, cordova, upload, camera

我一直在尝试通过 PhoneGap (Cordova) 设置一个应用程序来拍摄图像并将它们上传到我们的服务器。我在这里浏览了很多回复并尝试了其中的代码。我可以拿起相机拍照，甚至可以访问手机图库。但我无法将图像发送到服务器。我试过发送图像，甚至发送 base64 图像流。我无法将它发送到服务器。

这是客户端的javascript：

```
document.addEventListener("deviceready", onDeviceReady, false);

function onDeviceReady() {

}

function ImageUpload() {
    this.useExistingPhoto = function(e) {
        this.capture(Camera.PictureSourceType.SAVEDPHOTOALBUM);
    }

    this.takePhoto = function(e) {
        this.capture(Camera.PictureSourceType.CAMERA);
    }

    this.capture = function(sourceType) {
        navigator.camera.getPicture(this.onCaptureSuccess, this.onCaptureFaile, {
            destinationType: Camera.DestinationType.FILE_URI,
            soureType: sourceType,
            correctOrientation: true
        });
    }

    this.onCaptureSuccess = function(imageURI) {
        var fail, ft, options, params, win;

        success = function(response) {
            alert("Your photo has been uploaded!");
        };

        fail = function(error) {
            alert("An error has occurred: Code = " + error.code + "\nMessage = "+error.message);
        };

        options = new FailUploadOptions();
        options.fileKey = "file";
        options.fileName = imageURI.substr(imageURI.lastIndexOf('/') + 1);
        options.mimeType = "text/plain";
        params = {
            val1: "some value",
            val2: "some other value"
        };
        options.params = params;
        ft= new FileTransfer();
        ft.upload(imageURI, 'http://style.appdev01.com/app/client-profile.php', success, faile, options);
    }

    this.OnCaptureFail = function(message) {
        alert("Failed because: "+message);
    }
};
var imageuploader = new ImageUpload(); 
```

点击时有两个按钮调用 imageuploader.takePhoto 和 .useExistingPhoto。

在服务器端我有这个 php: if(isset($_FILES['file'])) {

```
$target_path = "/home/style/public_html/images/client_images/app_image.jpg";

move_uploaded_file($_FILES['file']['tmp_name'], $target_path);

$insert = "INSERT INTO
    `fut`
SET
    `request` = '".serialize($_POST)."',
    `file` = '".serialize($_FILES)."'";
$mysql->query($insert); 
```

}

这只是将 POST 和 FILE 数组存储到数据库，以确保它们通过并创建图像。

但同样，没有任何东西可以到达服务器。任何帮助将不胜感激。我已经从这里和整个网络上的很多问题中尝试了很多版本的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T03:29:36.443

```
define ('SITE_ROOT', realpath(dirname(__FILE__))); /* echo SITE_ROOT; to dir
move_uploaded_file($_FILES["file"]["tmp_name"],SITE_ROOT."/uploads/".$_FILES["file"]["name"]); // will move file, make sure uplaods has write permission! 
```

这适用于我在 Android 模拟器上，而不是在平板电脑上，但如果你有它工作，请告诉我，忙于同一件事。

```
$myarray = array( $_REQUEST);
foreach ($myarray as $key => $value) {

    echo "<p>".$key."</p>";
    echo "<p>".$value."</p>";
    echo "<hr />";
} 
```

您可以使用它来检查 POST / GET！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-24T17:08:39.670

试试这是我的代码。它对我有用。

1.  通过 encodeURI 方法对您的 URL 进行编码
2.  带有“文件”的文件密钥，如服务器端脚本 $_FILES['file']

    ```
    uploadFile: function(refNo){
    var uri = fileUpload.fileUri;
    var file = uri.substr(uri.lastIndexOf('/') + 1);

    var options = new FileUploadOptions();
    options.fileKey = "file"; 
    options.fileName = file;
    options.mimeType="image/jpeg";
    alert("name === "+uri);
    options.chunkedMode = false;

    var ft = new FileTransfer();
    Common.ajaxLoading('show');

    ft.upload(uri,encodeURI("http://172.16.1.147:80/upload/home.php") , fileUpload.uploadSuccess, fileUpload.uploadFail, options, true);
    }, 
    ```

# r - 使用多个条件返回输出

> ID：15118152
> 
> 赞同：0
> 
> 时间：2013-02-27T17:15:48.440
> 
> 标签：r

我正在尝试根据它们的集群和它们所处的角度为鸟类分配行为：

```
new[1:10,]
     date     time    angle cluster
1  23/05/2012 10:16:57 14.07701       2
2  23/05/2012 10:16:58 28.53635       0
3  23/05/2012 10:16:59 28.59663       0
4  23/05/2012 10:17:00 25.11674       0
5  23/05/2012 10:17:01 19.48292       0
6  23/05/2012 10:17:02 17.60478       0
7  23/05/2012 10:17:03 19.33444       1
8  23/05/2012 10:17:04 20.88084       1
9  23/05/2012 10:17:05 21.20995       1
10 23/05/2012 10:17:06 20.76851       1

new$class1[new$cluster=="0"]<-"flying"
new$class1[new$cluster=="1" & new$angle>="40"]<-"flapping"
new$class1[new$cluster=="1" & new$angle>="10" & new$angle<="40"]<-"floating" 
```

第一行（飞行）有效，但一旦我尝试添加其他标准，它就不起作用了。任何想法将不胜感激

### 感谢所有的帮助。那部分代码似乎确实有效，我不确定昨天发生了什么！我在尝试引入 2 个新变量（X1=lead 和 X3=lag）的下一点遇到问题

```
 date     time      angle cluster X1 X2 X3   class1 
```

280 23/05/2012 10:21:36 -7.9957740 4 4 4 4
摆动 281 23/05/2012 10:21:37 -7.9653004 4 4 4 4 摆动
282 23/05/2012 10:21:38 -6.2596800 4 2 4 4 拍打
283 23/05/2012 10:21:39 13.9916609 2 2 2 4

new$class1[new$cluster=="4" & new$angle>"-1" & new$angle<="10"]<-"flapping"
new$class1[new$cluster=="4" & new $angle>"10" & new$angle<="80"]<-"ascent"
new$class1[new$cluster=="4" & new$angle>"-50" & new$angle<="- 1" & new$X1=="7"]<-"跳跃"
new$class1[new$cluster=="4" & new$angle>"-50" & new$angle<="-1" & new $X1!="7"]<-"bottom phase"
所以在上述情况下，行为应该是“bottom phase”）谢谢

谢谢您的帮助。只有在我删除引号后才能识别负角。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:53:53.570

实际上，您的代码对我来说很好。

```
> new = read.csv("bird.csv",header=T)
> new
         date     time    angle cluster
1  23/05/2012 10:16:57 14.07701       2
2  23/05/2012 10:16:58 28.53635       0
3  23/05/2012 10:16:59 28.59663       0
4  23/05/2012 10:17:00 25.11674       0
5  23/05/2012 10:17:01 19.48292       0
6  23/05/2012 10:17:02 17.60478       0
7  23/05/2012 10:17:03 19.33444       1
8  23/05/2012 10:17:04 20.88084       1
9  23/05/2012 10:17:05 21.20995       1
10 23/05/2012 10:17:06 20.76851       1
> 
> new$class1[new$cluster=="0"]<-"flying"
> new$class1[new$cluster=="1" & new$angle>="40"]<-"flapping"
> new$class1[new$cluster=="1" & new$angle>="10" & new$angle<="40"]<-"floating"
> new
         date     time    angle cluster   class1
1  23/05/2012 10:16:57 14.07701       2     <NA>
2  23/05/2012 10:16:58 28.53635       0   flying
3  23/05/2012 10:16:59 28.59663       0   flying
4  23/05/2012 10:17:00 25.11674       0   flying
5  23/05/2012 10:17:01 19.48292       0   flying
6  23/05/2012 10:17:02 17.60478       0   flying
7  23/05/2012 10:17:03 19.33444       1 floating
8  23/05/2012 10:17:04 20.88084       1 floating
9  23/05/2012 10:17:05 21.20995       1 floating
10 23/05/2012 10:17:06 20.76851       1 floating 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:27:15.840

去掉角度变量周围的引号，即

```
new$class1[new$cluster=="1" & new$angle>=40]<-"flapping"
new$class1[new$cluster=="1" & new$angle>=10 & new$angle<=40]<-"floating" 
```

# c# - 在 XNA 中测试所有未碰撞的瓷砖

> ID：15118153
> 
> 赞同：1
> 
> 时间：2013-02-27T17:15:56.083
> 
> 标签：c#, foreach, xna, collision-detection

我目前正在 XNA 中编写平台游戏。我的碰撞测试目前通过运行一个 foreach 循环来测试玩家的边界框与每个图块的边界框。但是，我不知道如何测试玩家是否没有接触任何方块。

我将如何遍历我的阵列并测试他们的玩家是否没有接触任何块，以便我可以检查他是否在半空中？任何帮助或建议将不胜感激。先感谢您！

////////////////////////////////

我的碰撞代码是

```
 if (personRectangle.TouchTopOf(newRectangle))
    {
         onGround = true;
         test = false;
         test2 = true;
    } 
```

相应的布尔测试是

```
 public static bool TouchTopOf(this Rectangle r1, Rectangle r2)
    {
        return (r1.Bottom >= r2.Top - 1 &&
                r1.Bottom <= r2.Top + (r2.Height / 2) &&
                r1.Right >= r2.Left + (r2.Width / 5) &&
                r1.Left <= r2.Right - (r2.Width / 5));
    } 
```

这段代码在 Game1.cs 更新中测试了碰撞。

```
 foreach (CollisionTiles tile in map.CollisionTiles)
            player.Collision(tile.Rectangle); 
```

这是我的地图类中的瓷砖列表

```
 private List<CollisionTiles> collisionTiles = new List<CollisionTiles>(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:21:16.387

XNA Rectangles 有一个内置的 intersects 方法：

```
if (rect1.Intersects(rect2)){
...
} 
```

只需遍历平铺矩形并在每个矩形上调用相交。为了提高效率，您应该将玩家坐标映射到世界坐标并确定离玩家最近的图块，这样做可以缩小需要循环的图块数量。

编辑：为澄清起见，您可以：

```
bool collision=false;
foreach (CollisionTiles tile in map.CollisionTiles) {
    if(personRectangle.Intersects(tile.Rectangle)) {
        collision =true;
        break;
    }
} 
```

那么如果碰撞是真的，你就知道某处发生了碰撞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:55:17.537

除非您有理由不这样做，否则请保持简单。只需跟踪您碰撞了多少东西。如果您的计数最终为 0，那么您没有与任何东西发生碰撞。

无需担心修改/优化您拥有的任何代码，它可能类似于：

```
int touchedCount = 0;
foreach (CollisionTiles tile in map.CollisionTiles)
{
        if (player.Collision(tile.Rectangle))
        {
             touchedCount++;
        }
}

if (touchedCount == 0)
{
    //You did not collide with anything
} 
```

然后在您的碰撞方法中执行类似的操作来跟踪您的检查以及是否发生碰撞。正如其他答案所暗示的那样，使用 Rectangle.Intersects 可能是最简单的。

# mysql - 我可以将单位关键字保存到 MYSQL 中的变量中吗？

> ID：15118154
> 
> 赞同：0
> 
> 时间：2013-02-27T17:16:03.727
> 
> 标签：mysql, stored-functions

我想写一个这样的程序：

```
CREATE PROCEDURE `addByType`(IN myDate DATETIME, IN myType INT, OUT output DATETIME)
BEGIN
DECLARE unit ?;
CASE  
    WHEN myType = 1 THEN 
        SET unit = HOUR;        
    WHEN myType = 2 THEN
        SET unit = DAY;
    ...
END CASE;
SELECT TIMESTAMPADD(unit, 1, myDate) INTO output;
END 
```

有可能吗？我可以将单位关键字存储到变量中吗？或者还有其他方法可以达到同样的效果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:28:23.823

请试试这个：

```
CREATE PROCEDURE `addByType`(IN myDate DATETIME, IN myType INT, OUT output DATETIME)
BEGIN

CASE  
    WHEN myType = 1 THEN 
        SET @unit = 'HOUR';        
    WHEN myType = 2 THEN
        SET @unit = 'DAY';
END CASE;

SET @sql = CONCAT('SELECT TIMESTAMPADD(', @unit, ', 1, \'', myDate, '\') INTO @output;');
PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;
SET output = @output;

END 
```

可能包括语法错误，必须查找某些内容。但我相信你能弄清楚。得走了，明天再去看看。

PS：[这是准备好的语句的手动输入](http://dev.mysql.com/doc/refman/5.0/en/sql-syntax-prepared-statements.html)。

# magento - 如何在 wordpress 插件“mage enabler”中使用 magento Mage.php 文件路径？

> ID：15118156
> 
> 赞同：0
> 
> 时间：2013-02-27T17:16:11.730
> 
> 标签：magento, templates, wordpress

我面临一个小问题。我需要应用文件夹中 Mage.php 文件的绝对路径。我在wordpress插件“mage enabler”中使用/pinktaff.u1163.cartikahosting.com/app/Mage.php，但它显示无效..anyyou请帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:27:30.123

很可能`/pinktaff.u1163.cartikahosting.com`不是文档根目录的完整路径

在 magento 中，在站点根目录中创建一个空白 php 文件并添加以下代码

```
<?php echo $_SERVER['DOCUMENT_ROOT']; ? > 
```

请参阅[http://www.seomad.com/SEOBlog/find-out-the-root-path-on-your-server-in-php.html](http://www.seomad.com/SEOBlog/find-out-the-root-path-on-your-server-in-php.html)

或者

```
dirname(__FILE__) 
```

见[http://php.net/manual/en/function.dirname.php](http://php.net/manual/en/function.dirname.php)

您还可以通过以下方式测试路径是否正确

```
 <?php
 $filename = '/pinktaff.u1163.cartikahosting.com/app/Mage.php';

 if (file_exists($filename)) {
     echo "The file $filename exists";
 } else {
     echo "The file $filename does not exist";
 }
 ?> 
```

# c# - 无法使用 VB，因为已指定另一种语言

> ID：15118159
> 
> 赞同：1
> 
> 时间：2013-02-27T17:16:21.293
> 
> 标签：c#, vb.net, visual-studio, visual-studio-2012, compiler-errors

我一直在尝试在直到最近一直正常工作的页面上解决此错误。我想知道是否有人可以帮助我确定此错误的原因，因为我已尽我所能修复它，但没有成功。

**错误信息：**

> 错误 27 无法使用“VB”，因为本页前面已指定另一种语言（或从 CodeFile 属性中隐含）。W:\admin.fctl.ucf.edu\inventory\old\address.ascx 2

**我的代码：**

```
<%@ Control CodeBehind="address.ascx.cs" Language="c#" AutoEventWireup="false" Inherits="Inventory1.address" %>
<Script language="VB" runat="Server">

        Public Property Address1 as string
            Get
                Return txtAddress1.text
            End Get
            Set
                txtAddress1.text = value
            End Set     
        End property

        Public Property Address2 as string
            Get
                Return txtAddress2.text
            End Get
            Set
                txtAddress2.text = value
            End Set 
        End property

        Public Property city as string
            Get
                Return txtcity.text
            End Get
            Set
                txtcity.text = value
            End Set     
        End property

        Public Property state as string
            Get
                Return cbostate.selecteditem.text
            End Get
            Set
                cbostate.selectedindex = value
            End Set     
        End property

        Public Property zip as string
            Get
                Return txtzip.text
            End Get
            Set
                txtzip.text = value
            End Set 
        End property

        Public Property country as string
            Get
                Return cbocountry.selecteditem.text
            End Get
            Set
                cbocountry.selectedindex = value
            End Set     
        End property

        Public Property phone1 as string
            Get
                Return txtphone1.text
            End Get
            Set
                txtphone1.text = value
            End Set     
        End property

        Public Property phone2 as string
            Get
                Return txtphone2.text
            End Get
            Set
                txtphone2.text = value
            End Set     
        End property

        Public Property mobile as string
            Get
                Return txtmobile.text
            End Get
            Set
                txtmobile.text = value
            End Set     
        End property

        Public Property email as string
            Get
                Return txtemail.text
            End Get
            Set
                txtemail.text = value
            End Set     
        End property

        Public Property fax as string
            Get
                Return txtfax.text
            End Get
            Set
                txtfax.text = value
            End Set     
        End property

        Public Property pager as string
            Get
                Return txtpager.text
            End Get
            Set
                txtpager.text = value
            End Set     
        End property
</Script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T17:20:29.370

您的代码在 C# 中：

```
<%@ Control CodeBehind="address.ascx.cs" Language="c#" 
```

Because of that, you can only embed C# code into the page, not VB code. Either use entirely VB for both the code behind and the embedded scriptlets, or use entirely C# in both cases.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:20:26.507

使用以下链接将 vb.net 转换为 C#，然后您不必担心

[VB 到 C# 转换器](http://www.developerfusion.com/tools/convert/vb-to-csharp/)

或者：

你为什么不把你的VB代码编译成一个库（.dll）。稍后从你的代码中引用它，就是这样。托管 dll 包含 C# 和 vb 都编译到的 MSIL

# itext - iTextPDF 库 - 找不到“com.itextpdf.text.pdf.PdfAWriter”类

> ID：15118163
> 
> 赞同：2
> 
> 时间：2013-02-27T17:16:27.917
> 
> 标签：itext, itextpdf

在最新版本的 itextpad v5.4.0 中找不到“com.itextpdf.text.pdf.PdfAWriter”类。我什至尝试下载额外的罐子，但无济于事。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:41:51.017

我是 iText 的原始开发者；我发布了 5.4.0 版本，但我从未听说过 itextpad。如果您[从 SourceForge 下载该版本](http://sourceforge.net/projects/itext/files/iText/iText5.4.0/)，您会在名为 itext-pdfa-5.4.0.jar 的额外 jar 中找到 PdfAWriter。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-03-28T11:14:01.953

正如布鲁诺所说，PDF/A 库位于不同的 jar 文件中：**itext-pdfa**。

这里是 Maven 依赖项：

```
<!-- https://mvnrepository.com/artifact/com.itextpdf/itext-pdfa -->
<dependency>
    <groupId>com.itextpdf</groupId>
    <artifactId>itext-pdfa</artifactId>
    <version>5.5.13</version>
</dependency> 
```

# sql - 在数据库中存储可重新排序项目的有效方法

> ID：15118168
> 
> 赞同：10
> 
> 时间：2013-02-27T17:16:47.393
> 
> 标签：sql, sql-server, data-structures

所以我有一个用户收藏夹表。它们有几百万行。

目前，它们只有三列：`id`(pk)`userId`和`someFkRef`. 有一个索引`userId`可以让我快速选择用户的收藏夹。

目前这些是按顺序排列的`id`，实际上只是插入顺序。我们希望为用户提供重新排序他们的最爱的机会，最有可能通过某种拖放交互。

我的第一个（我怀疑是幼稚的）方法是简单地在 , 上添加一列`order`和一个复合索引。然而，经过反思，当用户将他们的项目在列表上移动一段距离时，项目的开始位置和结束位置之间的所有中间行都需要重新计算它们的列，因此也需要重新计算索引。`userId``order``order`

这（很可能）很糟糕。

在我花了很长时间试图量化到底有多糟糕之前，我想知道是否有更好的基于表的表示，并且使用我上面描述的各种操作来操作更便宜。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T17:21:44.840

对于拖放交互，更好的选择是优先事项。您将从优先级 1、2、3 等开始，就像排序顺序一样。

但是随后，用户想要在 1 和 2 之间移动项目 5。瞧！给它1.5的值。无需更改其他值。索引更新负责其余的工作。

为此，需要将优先级存储为浮点数。这可能是个问题。此外，足够多的更改可能会导致浮点数的极限。因此，如果用户尝试获取最后一个元素并将其插入前两个元素之间，他/她可以逃脱大约几十次左右。

您可以使用从 1 开始定期为一个（或所有用户，如果是批量）重新分配编号的过程来解决此问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T17:21:24.857

如果您不需要跨用户操作 someFkRef（例如，获取对某事感兴趣的用户列表），那么每个用户可能只有一条记录，以及 someFkRef (refA, refB) 的有序列表。

但这是一种非规范化的形式，并且由于它有一些缺点，它实际上取决于您的需求（以及您未来的需求，这就是麻烦所在）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T17:26:11.720

不确定您对 ID 字段的依赖引用可能是什么，但您是否考虑过重写它？我认为有一个 SET IDENTITY INSERT = ON，或者你可以做的一些事情。

我意识到这是一件奇怪的事情，但考虑到你正在尝试做的事情，这可能是有道理的，并且会导致最少的开销。

# facebook - 将 facebook 'like' 小部件添加到未发布的网站

> ID：15118170
> 
> 赞同：0
> 
> 时间：2013-02-27T17:16:52.900
> 
> 标签：facebook, widget, facebook-like

我正在尝试在我的网页上添加一个类似 facebook 的按钮，但我还没有发布我的网站。Facebook 要求我提供一个 URL，但我唯一的 URL 是 file://localhost/Users/.../Desktop/...kobe.html

有什么方法可以将点赞按钮添加到未托管在 Internet 上的页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:49:32.763

facebook 需要 backUrl 链接。无法ping回本地主机。所以最好上传网站并添加 facebook like 。有许多免费的虚拟主机可以上传到那里进行测试。

# c# - WindowsFormHost 绘制事件未触发

> ID：15118173
> 
> 赞同：0
> 
> 时间：2013-02-27T17:17:02.977
> 
> 标签：c#, .net, windowsformshost

我在 WPF 应用程序中有一个带有 WindowsFormHost 的面板。最终我需要能够点击和绘制点。我让它在一个单独的 WinForm 表单中完全工作......但由于某种原因，当 Invalidate() 被调用时，绘制事件根本不会触发！当消息框出现在点击时，点击事件肯定会触发。即使没有窥视油漆。无法弄清楚为什么我的生活......这是代码。

XML:

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:wf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"
    Title="MainWindow" Height="1000" Width="1000"
    WindowState="Maximized" SizeChanged="Window_SizeChanged" LocationChanged="Window_LocationChanged" Background="Gray">

<DockPanel LastChildFill="True">
    <ToolBarTray DockPanel.Dock="Top">
    <ToolBar Width="Auto" HorizontalAlignment="Stretch">
            <Menu>
                <MenuItem Header="File" VerticalAlignment="Center">
                        <MenuItem Header="New" Click="MenuItem_Click_3" />
                        <MenuItem Header="Open" Click="MenuItem_Click_4"/>
                        <MenuItem Header="Open Recent">
                            <MenuItem Header="Some Recent Files"/>
                        </MenuItem>
                        <MenuItem Header="Import H2OFate File" Click="MenuItem_Click_7"/>
                        <Separator/>
                        <MenuItem Header="Save" Click="MenuItem_Click_1" />
                        <MenuItem Header="Save As" Click="MenuItem_Click_5"/>
                        <MenuItem Header="Save without Results"/>
                        <MenuItem Header="Delete Unnecessary Files"/>
                        <Separator/>
                        <MenuItem Header="File Options"/>
                        <Separator/>
                        <MenuItem Header="Project Info"/>
                        <MenuItem Header="Supply Info" />
                        <Separator/>
                        <MenuItem Header="Print" Click="MenuItem_Click_6" />
                        <Separator/>
                        <MenuItem Header="Reload Current File"/>
                        <MenuItem Header="Exit                CTRL+Q" Click="MenuItem_Click"/>
                        </MenuItem>
            <MenuItem Header="Network Design" VerticalAlignment="Center">
                        <MenuItem Header="Something" Click="MenuItem_Click_8"/>
            </MenuItem>
            <MenuItem Header="Run Analysis" VerticalAlignment="Center">
                    <MenuItem Header="Run" Click="MenuItem_Click_2"/>
            </MenuItem>
            <MenuItem Header="View Results" VerticalAlignment="Center">
                    <MenuItem Header="Numeric"/>
                    <MenuItem Header="X-Y Plots"/>
                    <MenuItem Header="Contours"/>
                    <MenuItem Header="Reports"/>                                                
            </MenuItem>
            <MenuItem Header="Facilities Management" VerticalAlignment="Center">
                    <MenuItem Header="Some Item"/>
                    <MenuItem Header="Hydraulics"/>
                    <MenuItem Header="Contamination"/>
                    <MenuItem Header="Sensor Placement"/>
            </MenuItem>
            <MenuItem Header="Tools/Databases" VerticalAlignment="Center">
                    <MenuItem Header="Some Item"/>
                    <MenuItem Header="Hydraulics"/>
                    <MenuItem Header="Contamination"/>
                    <MenuItem Header="Sensor Placement"/>
            </MenuItem>
            <MenuItem Header="Help" VerticalAlignment="Center">
                    <MenuItem Header="Some Item"/>
                    <MenuItem Header="Help"/>
                    <MenuItem Header="Units"/>
                    <MenuItem Header="Demo Examples"/>
                    <MenuItem Header="Tutorial"/>
                    <MenuItem Header="How To"/>
                    <MenuItem Header="About"/>
            </MenuItem>
            </Menu>
            </ToolBar>

    <ToolBar>

            <Button Height="38" Width ="50" VerticalAlignment="Center" Click="Button_Click_1">                        
                <Ellipse Width="25" Height="25" Fill="Blue" Stroke="Black" VerticalAlignment="Center"/>
            </Button >
            <Button Height="38" Width ="50" VerticalAlignment="Center" Click="Button_Click_1">
                <Rectangle Width="38" Fill="Red" Height="7" Stroke="Black"/>
            </Button >
            <Button Height="38" Width ="50" VerticalAlignment="Center" Click="Button_Click_2">
                <Polygon Fill="Yellow" Stroke="Black" Points="0,10 30,10 30,0 28,0 28,3 2,3 2,0 0,0" VerticalAlignment="Center"/>
            </Button >
            <Button Height="38" Width ="50" VerticalAlignment="Center" Click="Button_Click_3">
                <Polygon Stroke="Black" Fill="Green" VerticalAlignment="Center" Points="22,0 22,7 15,7 15,15 9,15 9,7 0,7 0,0  "/>
            </Button > 
    </ToolBar>
        </ToolBarTray>
            <TabControl Width ="1000" DockPanel.Dock="Left">
        <TabItem Header="Map">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                </Grid.RowDefinitions>
                <WindowsFormsHost Grid.Row="0" x:Name="wfPanel" >
                    <WindowsFormsHost.Child>
                        <wf:Panel x:Name="wfSurface" MouseClick="wfSurface_MouseClick"/>
                    </WindowsFormsHost.Child>
                </WindowsFormsHost>
            </Grid>
        </TabItem>
        <TabItem Header="Map Settings">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <Button Content="Testing 123"/>
            </Grid>
        </TabItem>

    </TabControl>
    <TabControl DockPanel.Dock="Right">

    </TabControl>
</DockPanel> 
```

C＃

```
private void wfSurface_Paint(object sender, System.Windows.Forms.PaintEventArgs e)
    {
        Graphics g;
        g = wfSurface.CreateGraphics();
        epanet epa = epanet.GetInstance();
        SolidBrush s = new SolidBrush(System.Drawing.Color.Blue);
        g.FillEllipse(s, Convert.ToInt32(epa.xCord), Convert.ToInt32(epa.yCord), 50, 50);
        g.FillEllipse(s, 400, 400, 500, 500);
        MessageBox.Show("paint event fired");
    }

    private void wfSurface_MouseClick(object sender, System.Windows.Forms.MouseEventArgs e)
    {
        epanet epa = epanet.GetInstance();
        epa.xCord = e.X;
        epa.yCord = e.Y;
        MessageBox.Show("xCord is:  " + e.X.ToString());
        wfSurface.Invalidate();
    } 
```

编辑：

为了进一步检查绘制事件是否是我将线添加`g.FillEllipse(s,400,400,400,400);`到点击事件中的问题，它成功地绘制了椭圆。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:30:53.653

不是一个 WPF 家伙，但我的猜测是添加这个：

```
<WindowsFormsHost.Child>
  <wf:Panel x:Name="wfSurface" Paint="wfSurface_Paint"
                               MouseClick="wfSurface_MouseClick"/>
</WindowsFormsHost.Child> 
```

# binding - ember.js 单向绑定

> ID：15118174
> 
> 赞同：0
> 
> 时间：2013-02-27T17:17:05.483
> 
> 标签：binding, ember.js

在尝试将视图中的值绑定到控制器中的值时，我遇到了一些单向绑定问题：

```
App.ApplicationController = Ember.Controller.extend({
    value: 'my value'
});

App.ApplicationView = Ember.View.extend({
    templateName: 'application',

    willInsertElement: function() {
        console.log('will insert element');
        console.log('value from controller > ', this.get('controller').get('value'));
        console.log('value > ', this.get('value'));
        console.log('completeValue > ', this.get('completeValue'));
    },

    valueBinding: Ember.Binding.oneWay('controller.value'),
    completeValueBinding: Ember.Binding.oneWay('App.ApplicationController.value')
}); 
```

“value >”返回正确的值，但“completeValue >”返回未定义（参见 jsFiddle [http://jsfiddle.net/U29wV/7/](http://jsfiddle.net/U29wV/7/)）...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:52:33.463

您引用的是类`ApplicationController`而不是实际实例。

您已经`ApplicationController`通过视图的属性访问实例`controller`，因此只需将其用于绑定：

```
valueBinding: Ember.Binding.oneWay('controller.value'),
completeValueBinding: Ember.Binding.oneWay('controller.value') 
```

这使得它与`valueBinding`...相同

# zend-framework2 - ZF2。如果我有文字路线-它是否还会捕获带有 GET 参数的网址？

> ID：15118175
> 
> 赞同：4
> 
> 时间：2013-02-27T17:17:06.223
> 
> 标签：zend-framework2

我对 ZF2 路由中的参数有点困惑。这是文字路线：

```
 'route-test1' => array(
        'type' => 'literal',
        'options' => array(
            'route' => '/my/route',
            'defaults' => array(
                'controller' => 'IndexController',
                'action'     => 'myRoute',
           ),
      ),
 ), 
```

如果该路线仅捕获：

```
example.com/my/route 
```

或者还有：

```
example.com/my/route?test1=aaa&test2=bbb    
example.com/my/route?test=aaa 
```

**解析度：**

经过测试的 id（不知道为什么我没有把它放在第一位） - 是的 - 它将匹配所有这些 url - 有或没有查询行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T22:14:20.457

是的。然后，您可以使用以下方法访问参数（例如，从控制器）：

```
$this->getRequest()->getQuery() 
```

# python - 用 scipy 反转大型稀疏矩阵

> ID：15118177
> 
> 赞同：6
> 
> 时间：2013-02-27T17:17:10.727
> 
> 标签：python, numpy, scipy

我必须反转一个大的稀疏矩阵。我无法摆脱矩阵求逆，唯一的捷径就是了解主要的对角线元素，而忽略非对角线元素（我宁愿不这样做，但作为一种解决方案，它是可以接受的）。

我需要反转的矩阵通常很大（40000 * 40000），并且只有少数非零对角线。我目前的方法是构建所有稀疏的东西，然后

`posterior_covar = np.linalg.inv ( hessian.todense() )`

这显然需要很长时间和大量内存。

有什么提示，还是只是耐心或使问题变小？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T17:54:30.640

我不认为稀疏模块有明确的逆方法，但它确实有稀疏求解器。像这个玩具示例这样的东西有效：

```
>>> a = np.random.rand(3, 3)
>>> a
array([[ 0.31837307,  0.11282832,  0.70878689],
       [ 0.32481098,  0.94713997,  0.5034967 ],
       [ 0.391264  ,  0.58149983,  0.34353628]])
>>> np.linalg.inv(a)
array([[-0.29964242, -3.43275347,  5.64936743],
       [-0.78524966,  1.54400931, -0.64281108],
       [ 1.67045482,  1.29614174, -2.43525829]])

>>> a_sps = scipy.sparse.csc_matrix(a)
>>> lu_obj = scipy.sparse.linalg.splu(a_sps)
>>> lu_obj.solve(np.eye(3))
array([[-0.29964242, -0.78524966,  1.67045482],
       [-3.43275347,  1.54400931,  1.29614174],
       [ 5.64936743, -0.64281108, -2.43525829]]) 
```

请注意，结果是转置的！

如果您希望您的逆也是稀疏的，并且上次求解的密集返回不适合内存，您也可以一次生成一行（列），提取非零值并构建稀疏这些逆矩阵：

```
>>> for k in xrange(3) :
...     b = np.zeros((3,))
...     b[k] = 1
...     print lu_obj.solve(b)
... 
[-0.29964242 -0.78524966  1.67045482]
[-3.43275347  1.54400931  1.29614174]
[ 5.64936743 -0.64281108 -2.43525829] 
```

# php - 如何使用规范化删除冗余？

> ID：15118184
> 
> 赞同：5
> 
> 时间：2013-02-27T17:17:32.380
> 
> 标签：php, mysql, database, normalization

我有存储所有客户信息的 XML。每当我的 PHP 代码运行时，它都会将 XML 中的客户数据插入到数据库中。这是桌子。并非所有客户都是网络，所以我将所有客户信息直接保存到一个名为“客户”的表中。

**顾客：**

```
customer_id             int(40)         primary key 
CustomerAccountNumber   varchar(60)
CustomerAccountName     varchar(255)
AccountBalance          double      
InvAddressLine1         varchar(500)
Rep                     varchar(20) 
```

为了存储“网络客户”登录名和用户名，我有一个名为“Web_customers”的不同网络帐户表，其中主键为“CustomerAccountNumber”。

**网络客户：**

```
web_id                  int(11)         primary key
UserName                varchar(39)     
CustomerAccountNumber   varchar(39)
EmailAddress            varchar(255) 
Pwd                     varchar(70)     
customer_type           varchar(10) 
```

样本数据：

```
 customer_id  CustomerAccountNumber  CustomerAccountName   AccountBalance InvAddressLine1   Rep
 1                Accnt1           Myname1                 1098             address1       Mik 

 2               Accnt2           Myname2                  2398          address2        Richi

 3               Accnt3           Myname3                  2234398       address3        Santa

 4               Accnt4           Myname4                  2233398       address4        Den 
```

由于我运行 PHP 脚本以不断重新加载数据，因此 customer_id 经常更改，这就是为什么我不能在我的另一个表中选择它作为外键：

WEB_CUST：

```
 web_id     UserName    CustomerAccountNumber EmailAddress    Pwd     customer_type 
     1      Accnt1      Accnt1                b@gmail.com     123     simple
     2      Accnt212    Accnt2                dj@gmail.com    123     complex
     3      Accnt313    Accnt2                asdj@gmail.com  123     complex
     4      Accnt315    Accnt2                342j@gmail.com  123     complex 
```

我有两种类型的客户，“简单”和“复杂”。简单客户有一个 CustomerAccountNumber，在对应的 WEB_CUST 表中只有一个用户名。

复杂客户是那些具有相同帐号的客户。但问题在于“复杂”的客户。当具有用户名 Accnt313 和 Accnt2 的 WEB 客户更改信息时，它会更新我的 XML 表“客户”中具有相同 Accnt2 的所有其他客户。 **注意** 我的 XML 中的所有字段都是使用插入批处理方法直接插入到客户表中的。因为，我的 XML 有超过 60,000 个，并且将数据解析和插入子表可能会引发性能问题。这就是为什么，我没有打破它起来，这就是为什么我正在寻找替代解决方案。

我怎样才能防止这种情况发生？在这种情况下如何正常化？由于 XML 解析效率和重新加载原因，有没有一种方法可以在不干扰主 XML 表“客户”的情况下进行规范化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T13:59:32.740

该系统正在按照您的设计工作。

如果您希望将具有公共帐户代码的每个 Web 客户视为具有单独计费信息和帐户余额的单独客户，则将客户中的所有字段复制到 Web 客户表中，并且永远不要更改客户表。

我建议你重组你的数据库如下

```
AccountCode
    ID
    AccountCode

Customer
    ID
    AccountCodeID   (FK to AccountCode.ID)
    AccountBalance
    InvAddressLine1
    Rep

CustomerUser
    ID
    CustomerID    (FK to Customer.ID)
    Email
    Pwd 
```

并正确解析您的 XML。

# assembly - 如何编程霓虹灯寄存器索引

> ID：15118189
> 
> 赞同：0
> 
> 时间：2013-02-27T17:17:46.250
> 
> 标签：assembly, arm, neon

我有一个 8x8 的数据。处理后，我想暂时保留生成的 8x8 数据以供进一步处理。我的问题是是否可以对 4 个 Q 寄存器进行编程以循环存储它们。但是下面的代码不能编译，我也想将 d12 的 12 增加到 d13

```
mov r4, #7

1:
.
.
vmul.i16 d12, d12, d1[r4] 
subs r4, r4, #1
bge 1b 
```

有没有办法或有效的方法来处理这些？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:08:29.433

我不相信您可以间接引用寄存器。您可能想为此使用宏。请参阅我发送的矩阵乘法页面以获取您将使用的宏类型的示例。您会为每次计算调用一次，而不是使用循环。这还具有首先避免循环的优点。如果您使用寄存器而不是内存，我假设您担心性能，并且分支对性能不利。

请注意该页面中的“调度”部分。如果你非常关心性能，即使是宏也会引入一些问题。如果您快速读取和写入同一个寄存器（在本例中为 d12），您可能会停止流水线。您经常希望交错迭代，以便避免这种情况。（...，从 d3 读取，写入 d2，使用 d3 计算，从 d4 读取，写入 d3，使用 d4 计算，...）这意味着更多的手写代码，但速度要快得多。

# seo - 是什么让 Google 结果中的子菜单

> ID：15118190
> 
> 赞同：1
> 
> 时间：2013-02-27T17:17:47.983
> 
> 标签：seo

我注意到，当人们在 Google 中搜索某些公司时，结果会返回很好的类别。例如，如果您使用 Google *sqlteam 搜索*，则结果包含 SqlTeam 网站部分，例如论坛、SQL Server 版本、Weblogs、SQL Server 链接等。

当我用谷歌搜索网站*whatiftoptions*时，我没有得到这些不错的类别。我需要做什么才能让 Google 在搜索结果中显示类别？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:29:18.303

不幸的是，只有 Google 知道为您的网站生成附加链接的确切方法。防止网站滥用排名系统是保密的，因为拥有附加链接的网站可以轻松提高其在搜索结果中的形象。通常附加链接的网站具有以下属性：

*   网站在生成附加链接列表的关键字中排名第一
*   易于抓取的结构化导航。
*   相当高的自然搜索流量。
*   搜索结果页面的高点击率。
*   流行的内部页面显示为附加链接。
*   内部页面上的独特标题和元描述。

[您可以在http://www.hochmanconsultants.com/articles/sitelinks.shtml](http://www.hochmanconsultants.com/articles/sitelinks.shtml)阅读更多相关信息

# asp.net - 在长时间运行的请求期间检测 asp.net 应用程序何时关闭

> ID：15118191
> 
> 赞同：4
> 
> 时间：2013-02-27T17:17:48.220
> 
> 标签：asp.net, iis-7.5

[关于如何使用IRegisteredObject](http://msdn.microsoft.com/en-us/library/system.web.hosting.iregisteredobject.aspx)检测应用程序何时关闭存在一些问题。但是，在所有活动请求完成之前，不会调用 IRegisteredObject.Stop。

长时间运行的请求（推送、长轮询、Web 套接字）就是这种情况，这意味着这些请求可以无限期地阻止应用程序池回收。

有没有办法从长时间运行的请求中检测到应用程序关闭处于挂起状态？

我已经使用 IRegisteredObject 或轮询 HostingEnvironment.ShutdownReason 进行了测试。在完成主动请求之前，两者都无法工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:22:36.063

Katana/Owin 项目访问内部 System.Web.Hosting.UnsafeIISMethods.MgdHasConfigChanged 方法来检测关闭，以便长时间运行的请求可以检测到这种状态。

有关示例实现，请参阅[ShutdownDetector](http://katanaproject.codeplex.com/SourceControl/changeset/view/aaf5d99f63d8#src/Microsoft.Owin.Host.SystemWeb/ShutdownDetector.cs)和[UnsafeIISMethods](http://katanaproject.codeplex.com/SourceControl/changeset/view/aaf5d99f63d8#src/Microsoft.Owin.Host.SystemWeb/UnsafeIISMethods.cs)。

# aptana3 - aptana studio 3 html Preview Button 是 DarkGrey ，如何激活 PreviewButton

> ID：15118192
> 
> 赞同：1
> 
> 时间：2013-02-27T17:17:50.233
> 
> 标签：aptana3

新手刚刚安装了“aptana studio 3.3.2”：我想打开我正在处理的 HtmlPage 的预览。但是html Preview Button是DarkGrey，如何激活？我记得在 installTime 时，我未选中 PHP 选项。这可能与它有关吗？

当我查看 Preferences/Aptana/Web Servers 时，它显示 IP 地址：127.0.0.1 端口：8020-8079 在我看来，服务器已配置？...谢谢...vm

# scala - 将多个 Either 映射到一个具有多个的 Either

> ID：15118199
> 
> 赞同：2
> 
> 时间：2013-02-27T17:18:28.593
> 
> 标签：scala, monads

假设我在调用中`processOne`定义了一个单子函数，如下所示：

`def processOne(input: Input): Either[ErrorType, Output] = ...`

给定一个“ `Inputs`”列表，我想返回一个`Outputs`包含在一个“”中的相应列表`Either`：

`def processMany(inputs: Seq[Input]): Either[ErrorType, Seq[Output]] = ...`

`processMany`将调用`processOne`它具有的每个输入，但是，我希望它终止第一次（如果有）`processOne`返回 a`Left`并返回 that `Left`，否则返回 a`Right`和输出列表。

我的问题：最好的实施方式是`processMany`什么？是否可以使用`for`表达式来完成此行为，或者我是否有必要自己递归地迭代列表？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T17:44:31.587

使用[Scalaz](https://github.com/scalaz/scalaz) 7：

```
def processMany(inputs: Seq[Input]): Either[ErrorType, Seq[Output]] =
  inputs.toStream traverseU processOne 
```

转换`inputs`为 a`Stream[Input]`利用 的非严格`traverse`实现`Stream`，即为您提供所需的短路行为。

顺便说一句，您标记了这个“monads”，但遍历只需要一个应用函子（碰巧，它可能是根据 monad 定义的`Either`）。如需进一步参考，请参阅论文*[The Essence of the Iterator Pattern](http://www.cs.ox.ac.uk/jeremy.gibbons/publications/iterator.pdf)*，或者，对于基于 Scala 的解释，请参阅 Eric Torreborre 关于该主题的[博客文章](http://etorreborre.blogspot.de/2011/06/essence-of-iterator-pattern.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T17:30:11.470

使用标准 Scala 最简单的方法，它不会评估超出必要的值，可能是

```
def processMany(inputs: Seq[Input]): Either[ErrorType, Seq[Output]] = {
  Right(inputs.map{ x =>
    processOne(x) match {
      case Right(r) => r
      case Left(l) => return Left(l)
    }
  })
} 
```

折叠会更紧凑，但当它撞到左边时不会短路（它只会在你迭代整个输入时继续携带它）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T19:20:17.180

现在，我决定只使用递归来解决这个问题，因为我不愿意向库（Scalaz）添加依赖项。

（我的应用程序中的类型和名称已在此处更改，以显得更通用）

```
def processMany(inputs: Seq[Input]): Either[ErrorType, Seq[Output]] = {
  import scala.annotation.tailrec

  @tailrec
  def traverse(acc: Vector[Output], inputs: List[Input]): Either[ErrorType, Seq[Output]]  = {
    inputs match {
      case Nil =>   Right(acc)
      case input :: more =>
          processOne(input) match {
            case Right(output) =>  traverse(acc :+ output, more)
            case Left(e) => Left(e)
          }
    }
  }

  traverse(Vector[Output](), inputs.toList)
} 
```

# list - Oracle Apex - 选择列表填充文本字段

> ID：15118205
> 
> 赞同：2
> 
> 时间：2013-02-27T17:18:40.890
> 
> 标签：list, select, dynamic, oracle-apex

我正在使用 Oracle Apex 4.2。我有一个选择列表和一个文本字段。我正在尝试创建一个应该足够简单的动态动作，但我不知道该怎么做。基本上取决于用户从选择列表中的值列表中选择的值，然后应该填充文本字段。例如：

假设选择列表让用户可以选择“动物”、“汽车”、“人”。如果用户选择“动物”，则文本字段应立即具有值“猫”。如果用户选择“汽车”，则文本字段应立即具有值“丰田”。如果用户选择“Person@”，则文本字段应立即具有值“jim”等。

我将如何进行此动态操作？

谢谢，斯蒂芬。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T00:58:11.930

使用以下属性创建一个新的动态操作

## 主要属性

*   事件：变化
*   选择类型：项目
*   项目：[选择列表]
*   条件：无条件

## 真正的行动

*   行动：执行 PL/SQL 代码
*   当事件结果为：真时触发
*   PL/SQL 代码：

    ### 选项 1 - 使用查找表

    ```
    select LOOKUP_VALUE
    into :P1_TEXT
    from LOOKUP_TABLE
    where original_value = :P1_SELECT_LIST; 
    ```

    ### 选项 2 - 使用硬编码值

    ```
    CASE upper(:P1_SELECT_LIST)
        WHEN 'ANIMAL' THEN :P1_TEXT := 'cat';
        WHEN 'CAR' THEN :P1_TEXT := 'toyota';
        WHEN 'PERSON' THEN :P1_TEXT := 'jim';
        ELSE :P1_TEXT := null;
    END CASE; 
    ```

*   要提交的页面项目：[P1_SELECT_LIST]

*   要返回的页面项目 [P1_TEXT]

# css-float - 使用 ZURB Foundation 对移动设备上的 DIV 排序（推/拉）

> ID：15118206
> 
> 赞同：2
> 
> 时间：2013-02-27T17:18:41.303
> 
> 标签：css-float, zurb-foundation

涉及基础的快速问题。如果我希望 div 在桌面上按顺序 1 然后 2 和在移动设备上按 2 然后 1 的顺序排列，我将如何使用 Zurb 完成此操作？

```
<div class="row">
    <div class="three columns">
    </div>
    <div class="nine columns">
    </div>
</div> 
```

非常感谢你的帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T00:35:07.493

这绝对可以做到。在您的代码中，您应该根据您在移动设备上的显示方式对 div 进行排序，即 2 然后 1。为了在更大的屏幕上正确显示它，您可以覆盖 div 的默认样式。

出于测试目的，您可以尝试：

```
<div class="row">
    <div class="nine columns" style="float:right;">
    </div>
    <div class="three columns" style="float:left;">
    </div>
</div> 
```

虽然上述解决方案可行，但我建议不要使用内联样式。我宁愿使用自定义类和/或 @media 标签覆盖。

使用这些代码将是：

对于 HTML：

```
<div class="row">
    <div class="nine columns pull-right">
    </div>
    <div class="three columns pull-left">
    </div>
</div> 
```

对于 CSS/样式表：

```
@media only screen and (min-width: 768px) {
    .pull-left {float: left !important;}
    .pull-right {float: right !important;}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T12:23:57.793

不确定您是否可以严格使用 css 执行此操作，但使用 javascript 您可以在适用时添加 pull-x 类。

理论：按照移动设备或小屏幕的顺序放置列。然后在 document.ready 中，检查 show-for-small 是否可见，如果不可见，则您在更大的屏幕上，可以将 push|pull 类应用于您选择的列。

伪代码，假设您知道[推/拉技术](http://foundation.zurb.com/old-docs/f3/grid.php)：

```
// do this if not on small screen
if ( $('.show-on-small').css('display') == 'none' ) {
  // pull or push the columns as needed
  $('.myColumnsToPull-two').addClass('pull-two');
} else {
  // might be a good idea to revert above change
} 
```

# sas - 如何刷新文件视图

> ID：15118214
> 
> 赞同：1
> 
> 时间：2013-02-27T17:19:11.587
> 
> 标签：sas, enterprise-guide

在 Enterprise Guide 4.2 中，有没有办法刷新您的文件视图，而不是从流程流中删除它然后重新打开它？

我的 Google-fu 未能提供答案（一种或另一种），我的 SAS 管理员说他不知道有什么方法（但如果我找到了就让他知道）。

一个明确的“否”（来自文档）或带有示例的“是”将不胜感激。

* * *

当我从命令行（EG 之外）运行我的 SAS 程序时，我有一个更新的日志文件。我在 EG 中编辑我的代码，我想查看日志文件以查看结果。目前我必须从我的流程中删除日志文件，然后重新打开它以查看更新的日志。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T01:18:02.803

从您对问题的最后评论来看，听起来您正在服务器上运行非交互式 SAS 程序（来自 PuTTY 会话）并使用 EG 客户端查看日志文件，对吗？如果是这样，有更简单的方法可以查看日志文件。

当您提到 PuTTY 时，我假设您的服务器是 UNIX。如果是这样，请使用`tail`带有`-f`选项的命令。例如，如果您的 SAS 程序名为“myprog.sas”，它将创建一个名为“myprog.log”的日志文件，因此请在 UNIX 提示符下尝试以下命令：

```
tail -f myprog.log 
```

该`-f`选项意味着在将行写入日志时继续将输出写入终端窗口。当您厌倦了观看（或您看到 SAS“工作结束”消息）时，输入字母“q”退出。

EG 旨在成为您用于实际执行 SAS 程序的应用程序。在 UNIX 提示符下运行东西超出了设计（您会失去所有那些很酷的 EG 功能），并且会错过在元数据环境中为您设置的任何站点功能。

如果我完全不在基地，请澄清你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-12T07:09:51.273

在 SAS 平台中使用 SAS EG 或 SAS Studio 时，如果计算节点托管在 Linux 机器中，我总是使用代码查看 SAS 创建的输出文件的内容；唯一的要求是您知道要浏览的文件的完整路径，并且您有读取它的权限。

简单的想法是使用通用 DATA 步骤来：

1.  访问文件
2.  逐行阅读
3.  按内容、位置、行号等过滤数据。
4.  将数据打印到 SAS 日志，以便您可以在那里查看

这是一个简单的示例，可以帮助您进行操作：

*   首先，我为测试创建一个文件。你已经有了它！所以使用你的。

    ```
    /* create a test file */
    data _null_;
      file '/folders/myshortcuts/test/file'; /* Note I'm using fullpath */
      put "The begining, :)";
      put "line 2 in my file is shy and likes to hide.";
      put "line 3, all good so far.";
      put "line 4 in my file is to remain private.";
      put "Finally the last line in my file!";
    run; 
    ```

*   然后，这是读取其数据的代码

    ```
    data _null_;
      /*--------
        references which input file will be read
        setting variable 'theEnd'=1 when 
        reaches end-of-file 
        Note I'm using fullpath
        --------*/
      infile '/folders/myshortcuts/test/file' end=theEnd;

      /*--------
         reads one line at a time from input file 
         storing it in variable _infile_
        --------*/
      input;

      /*--------
        contents of file will be writen in the log, to keep it readable,
        mark where the contents of the file will follow
        --------*/
      if _n_=1 then
        put "-----start file ----";

      /*--------
        filter out shy, private or unwanted data
        --------*/
      if _n_ ne 4;  /* continue only if row number is not 4 */
      if indexw(_infile_,"shy") le 0; /* continue only if data does not contains 'shy' */

      /*--------
        write the data you want, complete line read in this case
        --------*/
      put _N_= "->" _infile_;

      /*--------
        mark where the data in the file has ended
        --------*/
      if theEnd then put "-----end file ----";
    run; 
    ```

*   您的 SAS 日志将如下所示：

    ```
     NOTE: The infile '/folders/myshortcuts/test/file' is:
           Filename=/folders/myshortcuts/test/file,
           Owner Name=sasdemo,Group Name=sas,
           Access Permission=-rw-rw-r--,
           Last Modified=11Jan2017:22:42:56,
           File Size (bytes)=160

     -----start file ----
     _N_=1 ->The begining, :)
     _N_=3 ->line 3, all good so far.
     _N_=5 ->Finally the last line in my file!
     -----end file ----

     NOTE: 5 records were read from the infile '/folders/myshortcuts/test/file'.
           The minimum record length was 16.
           The maximum record length was 43.
     NOTE: DATA statement used (Total process time):
           real time           0.02 seconds
           cpu time            0.03 seconds 
    ```

# mysql - 需要帮助在循环中插入 100 条记录，在记录完成后继续停止并中断。

> ID：15118215
> 
> 赞同：0
> 
> 时间：2013-02-27T17:19:14.583
> 
> 标签：mysql, sql, sql-server, tsql

需要帮助在循环中插入 100 条记录，在记录完成后继续停止并中断。

```
Alter PROCEDURE ETL.ETLPurge @PurgeYear INT
AS
BEGIN

  DECLARE @BatchId INT = (SELECT BatchId FROM Tracker)
  declare @Count int
  declare @batchsize int  
  set @batchsize =  100  

  --set @Count = @@rowcount 

 SELECT DISTINCT IDENTITY(INT,1,1) AS ID, MC.ID
  INTO #tmp
  FROM Contact MC
  JOIN Extract CE
    ON MC.ExtractID = CE.ExtractID
  LEFT JOIN Application A 
    ON MC.ID = A.ID
WHERE CE.Year < @PurgeYear   
 AND A.ApplicationId IS NULL  

--declare @counter bigint
--set @counter = 1
--while @counter < 500 
--Begin

--while 1 = 1 
--begin 
Create  NONCLUSTERED INDEX nix_ID
on #tmp(ID) 

--while 1=1
--begin 
INSERT  
--Top (@batchsize) 
INTO Table1 (Values ………)

(
SELECT top (@batchsize)  
@BatchID,  
Values ……..) 
  FROM Contact MC
 inner join 
       #tmp TK on MC.ContactID = TK.ContactID

    --where TK.ID between @batchsize and @ctr + 1
     )
 if @@ROWCOUNT < @batchsize 
 break 
 end 
 --  --continue  
 --  --if @@ROWCOUNT = 0
 -- Break 
end 
 --end 
--number of rows inserted should equal number of rows deleted. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:51:36.240

好的。

这是我的样本。

发生在我身上的是我的 dba “团队” .. 搞砸了为我们设置复制。所以..在周末，像狗一样工作....我们不得不编写一些代码来将记录从源数据库“拉”到目标数据库，其中数据库的结构是相同的。我们不得不伪造一些复制。

我们有 8,000,000 行，我们一次会将它们拉到 10,000 多个。下面，我有大约 1000 行，并将“一次拉取的行数”设置为 333。我还放置了一个 @MaximumLoopCounter 作为“以防万一”。我不想意外地创建一个无限循环。

下面的示例将其“while”逻辑基于“while exists（源数据库表上的一些记录不在目标数据库表中）”......继续抓取这些记录。

我试图帮助你回答你的问题。在我们的例子中，我们最终让复制工作正常，并且我们能够放弃这些脚本。这不是一个有趣的周末。

/* 设置 */

```
if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[CodeCategorySourceTable]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
    BEGIN
        DROP TABLE [dbo].[CodeCategorySourceTable]
    END
GO

CREATE TABLE [dbo].[CodeCategorySourceTable] (
    CodeCategoryUUID [uniqueidentifier] not null default NEWSEQUENTIALID() , 
    CodeCategoryName varchar(64) not null
)
GO

ALTER TABLE [dbo].[CodeCategorySourceTable] ADD CONSTRAINT PK_CodeCategorySourceTable_CodeCategoryUUID
PRIMARY KEY CLUSTERED (CodeCategoryUUID)
GO

ALTER TABLE [dbo].[CodeCategorySourceTable] ADD CONSTRAINT CK_CodeCategorySourceTable_CodeCategoryName_UNIQUE 
UNIQUE (CodeCategoryName)
GO

if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[CodeCategoryDestinationTable]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
    BEGIN
        DROP TABLE [dbo].[CodeCategoryDestinationTable]
    END
GO

CREATE TABLE [dbo].[CodeCategoryDestinationTable] (
    CodeCategoryUUID [uniqueidentifier] not null default NEWSEQUENTIALID() , 
    CodeCategoryName varchar(64) not null
)
GO

ALTER TABLE [dbo].[CodeCategoryDestinationTable] ADD CONSTRAINT PK_CodeCategoryDestinationTable_CodeCategoryUUID
PRIMARY KEY CLUSTERED (CodeCategoryUUID)
GO

ALTER TABLE [dbo].[CodeCategoryDestinationTable] ADD CONSTRAINT CK_CodeCategoryDestinationTable_CodeCategoryName_UNIQUE 
UNIQUE (CodeCategoryName)
GO

declare @AlreadyExistingCodeCategoryUUID01 uniqueidentifier
declare @AlreadyExistingCodeCategoryUUID03 uniqueidentifier
declare @AlreadyExistingCodeCategoryUUID02 uniqueidentifier
declare @AlreadyExistingOldCodeCategoryName01 varchar(64)
declare @AlreadyExistingOldCodeCategoryName02 varchar(64)
declare @AlreadyExistingOldCodeCategoryName03 varchar(64)
declare @AlreadyExistingNewCodeCategoryName01 varchar(64)
declare @AlreadyExistingNewCodeCategoryName02 varchar(64)
declare @AlreadyExistingNewCodeCategoryName03 varchar(64)

select @AlreadyExistingCodeCategoryUUID01 = NEWID(), @AlreadyExistingCodeCategoryUUID02 = NEWID(), @AlreadyExistingCodeCategoryUUID03 = NEWID()
select @AlreadyExistingNewCodeCategoryName01 = 'NewOne', @AlreadyExistingNewCodeCategoryName02 = 'NewTwo', @AlreadyExistingNewCodeCategoryName03 = 'NewThree'
select @AlreadyExistingOldCodeCategoryName01 = 'OldOne', @AlreadyExistingOldCodeCategoryName02 = 'OldTwo', @AlreadyExistingOldCodeCategoryName03 = 'OldThree'

Insert Into [dbo].[CodeCategorySourceTable] ( CodeCategoryUUID , CodeCategoryName )
Select top 1000 NEWID() , convert(varchar(40), NEWID()) + 'Name' from dbo.sysobjects so1 cross join dbo.sysobjects so2

Insert Into [dbo].[CodeCategorySourceTable] ( CodeCategoryUUID , CodeCategoryName )
select @AlreadyExistingCodeCategoryUUID01, @AlreadyExistingNewCodeCategoryName01 
UNION ALL select @AlreadyExistingCodeCategoryUUID02, @AlreadyExistingNewCodeCategoryName02
UNION ALL select @AlreadyExistingCodeCategoryUUID03, @AlreadyExistingNewCodeCategoryName03

select count(*) from [dbo].[CodeCategorySourceTable] as CodeCategorySourceTableCOUNT

Insert Into  [dbo].[CodeCategoryDestinationTable] ( CodeCategoryUUID , CodeCategoryName )
select @AlreadyExistingCodeCategoryUUID01, @AlreadyExistingOldCodeCategoryName01
UNION ALL select @AlreadyExistingCodeCategoryUUID02, @AlreadyExistingOldCodeCategoryName02
UNION ALL select @AlreadyExistingCodeCategoryUUID03, @AlreadyExistingOldCodeCategoryName03

select count(*) from  [dbo].[CodeCategoryDestinationTable] as CodeCategoryDestinationTableCOUNT 
```

/* 美国药典 */

```
print '[uspCodeCategoryReplicateReplacer]'
go

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[uspCodeCategoryReplicateReplacer]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[uspCodeCategoryReplicateReplacer]
Go

/*

declare @numberRowsAffected  int
declare @ErrorNumber int

exec [dbo].[uspCodeCategoryReplicateReplacer] @numberRowsAffected output , @ErrorNumber  output

print @numberRowsAffected 
print @ErrorNumber 
print ''

*/

CREATE PROCEDURE [dbo].[uspCodeCategoryReplicateReplacer] (
@numberRowsAffected int output
,
@ErrorNumber int output
)

AS

SET NOCOUNT ON

select @ErrorNumber = 0

declare @ErrorTracker int 
declare @insertRowCount int
declare @updateRowCount int 
select @insertRowCount = 0
select @updateRowCount = 0
declare @CurrentInsertCount int

declare @ManualReplicationRowCount int
select @ManualReplicationRowCount = 333

declare @MaximumLoopCounter int 
select @MaximumLoopCounter = 10000

while (@MaximumLoopCounter > 0) and exists 
(
    Select
        TOP 1 null
        from [dbo].[CodeCategorySourceTable] sourceTable with (nolock)
        where not exists
        (
            select null from  [dbo].[CodeCategoryDestinationTable] destinationTable with (nolock) 
            Where
                destinationTable.CodeCategoryUUID = sourceTable.CodeCategoryUUID 
        )
)

    BEGIN

        select @MaximumLoopCounter = @MaximumLoopCounter - 1

        /*  DELETE FROM  [dbo].[CodeCategoryDestinationTable] */

        SET NOCOUNT OFF

        Insert into  [dbo].[CodeCategoryDestinationTable]  
        (   
                CodeCategoryUUID, 
                CodeCategoryName

        )

        Select

            TOP (@ManualReplicationRowCount)

                CodeCategoryUUID, 
                CodeCategoryName

            from [dbo].[CodeCategorySourceTable] sourceTable with (nolock)

            where not exists
            (
                select null from  [dbo].[CodeCategoryDestinationTable]   destinationTable with (nolock) 
                Where
                    destinationTable.CodeCategoryUUID = sourceTable.CodeCategoryUUID 
            )

            SELECT @CurrentInsertCount = @@ROWCOUNT , @ErrorTracker = @@ERROR
            select @insertRowCount = @insertRowCount + @CurrentInsertCount

            if @ErrorTracker <> 0
                BEGIN

                    select @ErrorNumber = @ErrorTracker 
                    select @MaximumLoopCounter = 0 /*Bail Out !!!*/
                END

            SET NOCOUNT ON

    END /*End While Loop*/

print '/Before Look  [dbo].[CodeCategoryDestinationTable] */'
select * from  [dbo].[CodeCategoryDestinationTable]

SET NOCOUNT OFF

/* A little extra.  Update any non-surrogate-key values... We did not do this, but I leave it here as for kicks */

Update  [dbo].[CodeCategoryDestinationTable]
Set
  /*CodeCategoryUUID = vart.CodeCategoryUUID,*/
CodeCategoryName = sourceTable.CodeCategoryName
From
     [dbo].[CodeCategoryDestinationTable] destinationTable, [dbo].[CodeCategorySourceTable] sourceTable
Where
/*Relationship*/
destinationTable.CodeCategoryUUID = sourceTable.CodeCategoryUUID  
/*Filter*/
and destinationTable.CodeCategoryName <> sourceTable.CodeCategoryName

SELECT @updateRowCount = @@ROWCOUNT

SET NOCOUNT ON

print '/After Look  [dbo].[CodeCategoryDestinationTable] */'
select * from  [dbo].[CodeCategoryDestinationTable]

print '/@insertRowCount COUNT/'
print @insertRowCount 
print '-------------------------'

print '/@updateRowCount COUNT/'
print @updateRowCount 
print '-------------------------'

SELECT @numberRowsAffected = @insertRowCount + @updateRowCount

print '/ [dbo].[CodeCategoryDestinationTable] COUNT/'
print @numberRowsAffected 
print '-------------------------'

SET NOCOUNT OFF

GO

/*GRANT EXECUTE ON dbo.uspCodeCategoryReplicateReplacer TO $(DBUSERNAME)*/

GO 
```

/* 改进，封装 ManualReplicationRowCount “getter”，以便在一处更改 */

```
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[uspInternalSettingGetManualReplicationRowCount]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[uspInternalSettingGetManualReplicationRowCount]
GO

/*

--START TEST

declare @returnCode int
declare @ManualReplicationRowCount int

EXEC @returnCode = dbo.uspInternalSettingGetManualReplicationRowCount @ManualReplicationRowCount output
print @ManualReplicationRowCount
print '/@returnCode/'
print @returnCode

*/

CREATE PROCEDURE [dbo].[uspInternalSettingGetManualReplicationRowCount] (
@ManualReplicationRowCount int output  --return
)

AS

SET NOCOUNT ON 

select @ManualReplicationRowCount = 333

SET NOCOUNT OFF
GO 
```

# sql-server - 用于创建团队的 Sql 查询

> ID：15118221
> 
> 赞同：2
> 
> 时间：2013-02-27T17:19:27.053
> 
> 标签：sql-server

我需要一个查询来将团队分配给一系列用户。数据如下所示：

```
UserId  Category    Team
1       A           null
2       A           null
3       B           null
4       B           null
5       A           null
6       B           null
8       A           null
9       B           null
11      B           null 
```

应该通过按用户 ID 排序来创建团队，第一个用户 ID 成为团队编号，连续的 A 和后面的 B 都是该团队的一部分。Bs之后的第一个A开始一个新的团队。总会有至少一个 A 和一个 B。所以在更新之后，数据应该是这样的：

```
UserId  Category    Team
1       A           1
2       A           1
3       B           1
4       B           1
5       A           5
6       B           5
8       A           8
9       B           8
11      B           8 
```

编辑：需要补充一点，用户 ID 不会总是增加 1。我编辑了示例数据以显示我的意思。此外，团队 ID 不必是第一个用户的 id，只要他们最终正确分组即可。例如，用户 1 - 4 可能都在团队“1”中，用户 5 和 6 在团队“2”中，用户 8,9 和 11 在团队“3”中

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:46:25.627

首先，您可以用不断增加的数字标记每一行。然后您可以使用 a`left join`来查找以前的用户。如果以前的用户有 category `'B'`，而当前有一个 category `'A'`，则意味着新团队的开始。`UserId`团队编号是在当前 之前开始新团队的最后一个`UserId`。

使用 SQL Server 2008 语法：

```
; with  numbered as
        (
        select  row_number() over (order by UserId) rn
        ,       *
        from    Table1
        )
,       changes as
        (
        select  cur.UserId
        ,       case
                when prev.Category = 'B' and cur.Category = 'A' then cur.UserId
                when prev.Category is null then cur.UserId
                end as Team
        from    numbered cur
        left join
                numbered prev
        on      cur.rn = prev.rn + 1
        )
update  t1
set     Team = team.Team
from    Table1 t1
outer apply
        (
        select  top 1 c.Team
        from    changes c
        where   c.UserId <= t1.UserId
                and c.Team is not null
        order by
                c.UserId desc
        ) as team; 
```

[SQL Fiddle 的示例。](http://sqlfiddle.com/#!3/f2b91/1/0)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T17:46:55.460

您可以使用递归 CTE 执行此操作：

```
with userCTE as
(
  select UserId
    , Category
    , Team = UserId
  from users where UserId = 1
  union all
  select users.UserId
    , users.Category
    , Team = case when users.Category = 'A' and userCTE.Category = 'B' then users.UserId else userCTE.Team end
  from userCTE
    inner join users on users.UserId = userCTE.UserId + 1
)
update users
set Team = userCTE.Team
from users
  inner join userCTE on users.UserId = userCTE.UserId
option (maxrecursion 0) 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!3/3818a/1)。

**编辑：**

您可以更新 CTE 以完成此操作：

```
with userOrder as
(
  select *
    , userRank = row_number() over (order by userId)
  from users
)
, userCTE as
(
  select UserId
    , Category
    , Team = UserId
    , userRank
  from userOrder where UserId = (select min(UserId) from users)
  union all
  select users.UserId
    , users.Category
    , Team = case when users.Category = 'A' and userCTE.Category = 'B' then users.UserId else userCTE.Team end
    , users.userRank
  from userCTE
    inner join userOrder users on users.userRank = userCTE.userRank + 1
)
update users
set Team = userCTE.Team
from users
  inner join userCTE on users.UserId = userCTE.UserId
option (maxrecursion 0) 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!3/91eb9/5)。

**编辑：**

对于较大的数据集，您需要添加`maxrecursion`查询提示；我已经编辑了以前的查询来显示这一点。来自在线书籍：

> 指定此查询允许的最大递归数。number 是介于 0 和 32767 之间的非负整数。指定 0 时，不应用限制。

在这种情况下，我将其设置为`0`，即不限制递归。

[查询提示](http://msdn.microsoft.com/en-gb/library/ms181714.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:46:48.023

我实际上最终选择了以下内容。它在半小时内完成了所有 300 万多行。

```
declare @userid int
declare @team int
declare @category char(1)
declare @lastcategory char(1)
set @userid = 1
set @lastcategory='B'
set @team=0

while @userid is not null 
begin

  select @category = category from users where userid = @userid
  if @category = 'A' and @lastcategory = 'B'
  begin
   set @team = @userid
  end
  update users set team = @team where userid = @userid
  set @lastcategory = @category
  select @userid = MIN(userid) from users where userid > @userid
End 
```

# node.js - 错误：在 errnoException (net.js:770:11) 处写入 EPIPE

> ID：15118222
> 
> 赞同：4
> 
> 时间：2013-02-27T17:19:43.257
> 
> 标签：node.js, nodemailer

我有这个系统，它试图发送用 NodeJS 编写的批量电子邮件。

它使用 2 个模块：fs（内置到节点 v0.8.18）和 nodemailer（来自 NPM，v0.3.42）。

现在在执行时`node newsletter.js`有时它会完成并完成，但有时它会在随机点随机失败并出现以下错误：

```
stream.js:81
      throw er; // Unhandled stream error in pipe.
            ^
Error: write EPIPE
    at errnoException (net.js:770:11)
    at Object.afterWrite (net.js:594:19) 
```

据我了解，EPIPE 错误发生是因为连接的另一端断开，然后我们尝试写入该连接。此 EPIPE 错误错误的所有现有报告都在打开 http 连接或类似的上下文中。

在我下面的两件事中，可能导致错误的是`fs.readFileSync`在 NewsletterEmail 中或`mailer.send`在 NewsleterMailer 中。错误更有可能出现在 mailer.send 中，并且 nodemailer 正在某处打开连接。但是，没有错误通过 throw 或回调错误参数传递回来，因此似乎无法查看导致错误的原因。

大多数人建议定义一个错误处理程序。但是，nodemailer 或 fs 模块中没有任何内容允许我定义错误处理程序。来自调用的 nodemailer 中的回调`mailer.send`确实在其回调中传递了一个错误参数，但是这个特定的错误并没有通过那里出现。

我尝试了以下事情：

*   在两者周围添加 try/catch`fs.readFileSync`和 nodemailer 传输 sendEmail 调用。
*   删除 fs.readFileSync 调用并内联 html - 当我这样做时，错误似乎没有发生。但同样，节点文档没有表明 EPIPE 错误应该发生在 readFileSync 上，当然也没有办法添加错误处理程序。

触发此错误的代码如下：

```
var nodemailer = require('nodemailer');
var fs = require('fs');

/**
 * Provides a way to build newsletters when given a folder containing
 * the relevant template and images in a standard format. This folder
 * must contain a newsletter.html file, a newsletter.txt file and a images
 * directory containing any images.
 * 
 * @param {Object} settings The full folder path to the
 */
function NewsletterEmail(newsletterGroup, newsletterName)
{
    var folder = '/var/newsletters/' + newsletterGroup + '/' + newsletterName;
    this._html = fs.readFileSync(folder + '/newsletter.html', 'utf-8');
    this._text = fs.readFileSync(folder + '/newsletter.txt', 'utf-8');
}

NewsletterEmail.prototype.getSubject = function()
{
    return 'Testing';
}

/**
 * Generates the HTML version of a newsletter.
 *
 * @return {String}
 */
NewsletterEmail.prototype.buildHTML = function(email)
{
    var htmlPart = this._html;

    return htmlPart;
}

/**
 * Generates the text counterpart of a newsletter.
 * 
 * @return {String}
 */
NewsletterEmail.prototype.buildText = function(email)
{
    var textPart = this._text;

    return textPart;
}

/**
 * Creates a NewsletterEmail from the given folder.
 * 
 * @param  {String} folder The folder containing the html template, text template and images for a newsletter.
 * @return {NewsletterEmail}
 */
NewsletterEmail.create = function(newsleterGroup, newsletterName) {
    return new NewsletterEmail(newsleterGroup, newsletterName);
}

function NewsletterMailer(fromEmail)
{
    this._from = fromEmail;
    this._transport = nodemailer.createTransport('sendmail');
}

NewsletterMailer.prototype = {
    send: function(email, newsletterEmail, callback) {
        var mailOptions = {
            to: email,
            from: this._from,
            subject: newsletterEmail.getSubject(),
            html: newsletterEmail.buildHTML(email),
            text: newsletterEmail.buildText(email)
        };

        this._transport.sendMail(mailOptions, callback);

    },

    close: function() {
        this._transport.close();
    }
}

function Newsletter()
{
    this._id = 1;
    this.countSent = 0;
    this.emailsToSend = ['email1@example.com', 'email2@example.com', 'email3@example.com', 'email4@example.com', 'email5@example.com', 'email6@example.com'];
}

Newsletter.prototype.send = function() {
    var newsletter = this;

    var newsletterEmail = NewsletterEmail.create('company1', '2013-01-24-mynewsleter');
    var mailer = new NewsletterMailer('company@example.com');

    function sendEmail() {
        var email = newsletter.emailsToSend.pop();

        mailer.send(email, newsletterEmail, function(mailerErr) {
            if (mailerErr) {
                console.log('Mailer error: ', mailerErr);
            }

            newsletter.countSent++;

            console.log('progress ' + newsletter.countSent);

            if (newsletter.emailsToSend.length > 0) {
                sendEmail();
            }
            else {
                mailer.close();
                console.log('complete');
            }
        });
    }

    sendEmail();
}

var nl = new Newsletter();
nl.send(); 
```

有没有其他人遇到过类似的错误？您是否有任何调试技巧或可能的解决方案。

现在给我的堆栈跟踪有点死胡同。下面是 strace 的输出。似乎总是先死在邮件 mimepart 边界上：

```
futex(0x7f039c0008c8, FUTEX_WAKE_PRIVATE, 1) = 1
write(8, "------Nodemailer-0.3.42-?=_1-136"..., 131) = -1 EPIPE (Broken pipe)
--- SIGPIPE {si_signo=SIGPIPE, si_code=SI_USER, si_pid=13813, si_uid=0} ---
--- SIGCHLD {si_signo=SIGCHLD, si_code=CLD_EXITED, si_pid=13818, si_status=0, si_utime=0, si_stime=0} ---
write(4, "\1\0\0\0\0\0\0\0", 8)         = 8
rt_sigreturn()                          = -1 EPIPE (Broken pipe)
futex(0x7f039c0008c8, FUTEX_WAKE_PRIVATE, 1) = 1
write(8, "<!DOCTYPE HTML PUBLIC =22-//W3C/"..., 18098) = -1 EPIPE (Broken pipe)
--- SIGPIPE {si_signo=SIGPIPE, si_code=SI_USER, si_pid=13813, si_uid=0} ---
futex(0x7f039c0008c8, FUTEX_WAKE_PRIVATE, 1) = 1
close(8)                                = 0
epoll_wait(3, {{EPOLLIN|EPOLLHUP, {u32=9, u64=4294967305}}, {EPOLLIN|EPOLLHUP, {u32=11, u64=4294967307}}, {EPOLLIN, {u32=4, u64=4294967300}}}, 64, 0) = 3
epoll_ctl(3, EPOLL_CTL_MOD, 9, {EPOLLIN, {u32=9, u64=4294967305}}) = 0
epoll_ctl(3, EPOLL_CTL_MOD, 11, {EPOLLIN, {u32=11, u64=4294967307}}) = 0
read(4, "\1\0\0\0\0\0\0\0", 8)          = 8
wait4(-1, [{WIFEXITED(s) && WEXITSTATUS(s) == 0}], WNOHANG|WSTOPPED|WCONTINUED, NULL) = 13818
ioctl(1, SNDCTL_TMR_TIMEBASE or SNDRV_TIMER_IOCTL_NEXT_DEVICE or TCGETS, 0x7fff2d6f4340) = -1 EINVAL (Invalid argument)
fstat(1, {st_mode=S_IFIFO|0600, st_size=0, ...}) = 0
write(1, "progress 1\n", 11progress 1
)            = 11
socketpair(PF_FILE, SOCK_STREAM|SOCK_CLOEXEC, 0, [7, 8]) = 0
socketpair(PF_FILE, SOCK_STREAM|SOCK_CLOEXEC, 0, [10, 12]) = 0
socketpair(PF_FILE, SOCK_STREAM|SOCK_CLOEXEC, 0, [13, 14]) = 0
pipe2([15, 16], O_NONBLOCK|O_CLOEXEC)   = 0
clone(child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7f03a4b35a10) = 13820
close(16)                               = 0
poll([{fd=15, events=POLLIN|POLLHUP}], 1, -1) = 1 ([{fd=15, revents=POLLHUP}])
close(15)                               = 0
close(7)                                = 0
ioctl(8, FIONBIO, [1])                  = 0
close(12)                               = 0
ioctl(10, FIONBIO, [1])                 = 0
close(14)                               = 0
ioctl(13, FIONBIO, [1])                 = 0
wait4(-1, 0x7fff2d6f529c, WNOHANG|WSTOPPED|WCONTINUED, NULL) = 0
futex(0x7f039c0008c8, FUTEX_WAKE_PRIVATE, 1) = 1
brk(0x932000)                           = 0x932000
read(11, "", 65536)                     = 0
close(11)                               = 0
read(9, "", 65536)                      = 0
futex(0x7f039c0008c8, FUTEX_WAKE_PRIVATE, 1) = 1
close(9)                                = 0
write(2, "\n", 1
)                       = 1
write(2, "events.js:71\n", 13events.js:71 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T14:46:00.667

这是由 nodemailer 模块在 75 个字符处换行引起的。一行正好有 76 个字符长，末尾有一个点。这个点被包裹在自己的线上。

对于 SMTP 服务器，一行上的点本身表示消息结束并且连接关闭。这导致连接过早关闭，随后的写入因 EPIPE 错误而失败。

在 nodemailer 维护者的帮助下，这个问题现在已经在 issue 0.3.43 中得到修复，方法是在 sendmail 调用中添加 hte -i 标志，告诉 sendmail 允许带有单个点的行。

此处提供更多详细信息：[https](https://github.com/andris9/Nodemailer/issues/141) ://github.com/andris9/Nodemailer/issues/141 。

# java - Java中是否有任何实用方法来查找重复的重复字符？

> ID：15118225
> 
> 赞同：0
> 
> 时间：2013-02-27T17:19:45.897
> 
> 标签：java, algorithm

java中是否有任何实用方法可以在java中查找重复的重复字符？

例如，“允许”是不允许的，因为它有两个重复的“l”，“重复”是允许的，尽管它有两个“e”

我在看`StringUtils`，但那里什么都没有。我正在考虑写类似的东西

```
for (each char in string) {
if (char at counter of loop == char at next counter) {
break;
}} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:27:39.913

循环方法是一种解决方案，或者，如果您想要一些花哨的东西，您可以使用[正则表达式方法](https://stackoverflow.com/questions/6929614/regex-repeated-character-count)，它看起来像：

```
private static final Pattern repeatMatcher = Pattern.compile("^(?:(.)(?!\\1))*$");

public static boolean hasRepeatedCharacters(String input) {
    return !repeatMatcher.matcher(input).matches();
} 
```

但是使用循环的基本方法肯定更具可读性：

```
public static boolean hasRepeatedCharacters(String input) {
    for (int i = 0; i < input.length() - 1; i++) {
        if (input.charAt(i) == input.charAt(i + 1)) return true;
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T17:22:10.383

没有实用的方法可以解决这个问题，因为我认为这个问题并不常见到值得一个。它对于任何一般用途来说都太具体了。

按照您的建议制作自己的方法，看起来不错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:24:26.210

听起来不像是实用程序的常见用例。您的代码逻辑似乎足够好。优化检查它是否是单个字符并在下一个计数器检查字符不超过字符串长度应该做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T17:27:11.447

试试这个：

```
Character last = null;
boolean allowed = true;

for (Character c : str.toCharArray()) {
    if (c.equals(last)) {
        allowed = false;
        break;
    }
    last = c.charValue();
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-27T17:48:21.730

你可以试试这个：

```
package com.stack.overflow.works.main;

import java.util.HashMap;
import java.util.Map;
import java.util.Set;

/**
 * @author sarath_sivan
 */

public class DuplicatesFinder {

    public static void findDuplicates(String inputString) {
        Map<Character, Integer> duplicatesMap = new HashMap<Character, Integer>(); 
        char[] charArray = inputString.toCharArray();
        for (Character ch : charArray) {
            if (duplicatesMap.containsKey(ch)) {
                duplicatesMap.put(ch, duplicatesMap.get(ch) + 1);
            } else {
                duplicatesMap.put(ch, 1);
            }
        }
        Set<Character> keySet = duplicatesMap.keySet();
        for (Character ch: keySet) {
            if (duplicatesMap.get(ch) > 1) {
                System.out.println("[INFO: CHARACTER " + ch + " IS DUPLICATE, OCCURENCE: " + duplicatesMap.get(ch) + " TIMES]");
            }
        }
    }

    public static void main(String[] args) {
        DuplicatesFinder.findDuplicates("sarath kumar sivan");
    }

} 
```

它将为输入字符串“sarath kumar sivan”生成简单的测试结果，如下所示：

```
[INFO: CHARACTER   IS DUPLICATE, OCCURENCE: 2 TIMES]
[INFO: CHARACTER s IS DUPLICATE, OCCURENCE: 2 TIMES]
[INFO: CHARACTER r IS DUPLICATE, OCCURENCE: 2 TIMES]
[INFO: CHARACTER a IS DUPLICATE, OCCURENCE: 4 TIMES] 
```

# r - R - 二元响应模型中的分离问题 - glm、brglm、logistf

> ID：15118230
> 
> 赞同：5
> 
> 时间：2013-02-27T17:20:04.953
> 
> 标签：r, binary, glm, logistf

我的数据遇到了一些问题，需要一些帮助。我正在尝试使用存在/不存在变量作为响应变量和几个解释变量（时间、位置、存在/不存在数据、丰度数据）运行 glm 分析。

首先，我尝试使用 glm() 函数，但是我有 2 个关于 glm.fit () 的警告：1：glm.fit：算法没有收敛 2：glm.fit：在经过一些调查后，出现数字 0 或 1 的拟合概率我发现问题很可能是准完全分离，因此决定使用 brglm 和/或 logistf。

*   logistf：分析不运行运行 logistf() 时，我收到一条错误消息： chol.default(x) 中的错误：前导未成年人 39 不是肯定的 我在 Internet 上的理论和技术论文中查看了 logistf 包手册Heinze 和 Ploner 的，无法找到使用此功能的位置以及是否可以通过某些设置修复错误。

*   brglm：分析运行但是我收到一条警告消息：在 fit.proc(x = X, y = Y, weights = weights, start = start, etastart # = etastart, : 达到迭代限制之前我找不到位置和原因此功能在运行包时使用，如果可以通过调整一些设置来修复它。

以更一般的方式，我想知道这些包的根本区别是什么。

我希望这足够有意义，如果这是我不知道的统计证据，我很抱歉。

这是我第一次提出问题，所以如果不应该这样，我深表歉意，并请您不要犹豫，让我知道。

谢谢您的帮助

霍奇特尔 C.

* * *

这是我的表格的摘录（由于表格太宽，我不得不截断行的长度：20 列）和我运行的不同公式：

```
head ()

Year Quarter Subarea Latitude Longitude    Presence.S CPUE.S Presence.H CPUE.H Presence.NP 

1 2000       1    31F1    51.25       1.5          0      0          0     0        0   
2 2000       1    31F2    51.25       2.5          0      0          0     0        0  
3 2000       1    32F1    51.75       1.5          0      0          0     0        0   
4 2000       1    32F2    51.75       2.5          0      0          0     0        0   
5 2000       1    32F3    51.75       3.5          0      0          0     0        0   
6 2000       1    33F1    52.25       1.5          0      0          0     0        0   

tail ()

Year Quarter Subarea Latitude Longitude Presence.S  CPUE.S Presence.H  CPUE.H 

4435 2012       3    50F3    60.75       3.5    1  103.000   1       110.000            
4436 2012       3    51E8    61.25      -1.5    1 1311.600   1       12.000   
4437 2012       3    51E9    61.25      -0.5    1   34.336   1       46.671               
4438 2012       3    51F0    61.25       0.5    1  430.500   1       148.000              
4439 2012       3    51F1    61.25       1.5    1  115.000   1       85.000              
4440 2012       3    51F2    61.25       2.5    1   72.500   1       5.500                 

logistf_binomPres <- logistf (Presence.S ~ (Presence.BW + Presence.W + Presence.C + Presence.NP +Presence.P + Presence.H +CPUE.BW + CPUE.H + CPUE.P + CPUE.NP + CPUE.W + CPUE.C + Year + Quarter + Latitude + Longitude)^2, data = CPUE_table)

Brglm_binomPres <- brglm (Presence.S ~ (Presence.BW + Presence.W + Presence.C + Presence.NP +Presence.P + Presence.H +CPUE.BW + CPUE.H + CPUE.P + CPUE.NP + CPUE.W + CPUE.C + Year + Quarter + Latitude + Longitude)^2, family = binomial, data = CPUE_table) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-25T16:53:45.483

对于它的价值，我还遇到了“领先的小调 i 不是正定的”错误。

这是因为我的第 i 个变量对于所有观察都是相同的。删除这个变量解决了这个问题。

希望这可以帮助

乙

# php - 将变量添加到 MYSQL

> ID：15118232
> 
> 赞同：0
> 
> 时间：2013-02-27T17:20:20.373
> 
> 标签：php, jquery, mysql

我需要将“seatid”添加到 mysql DB...“seatid”变量在另一个函数中检索...换句话说，我需要向 mysql 添加一个在表单中找不到但在另一个函数中找到的变量

```
 $("#reserveid").click(function()
{
    addSeat();

});

function addSeat()
{
var t_name    = $("#btnShowNew ['seatid']").val(); //btnShowNew is the id of the form that output the seatid variable
var errors  = '';

$.ajax({
    type    : "POST",
    url     : "INSERT.php",
    data    : { seatid  : t_name,
       },
    cache   : false, timeout: 10000,

    success  : function() {
        alert("WORKED!");
    },
    error    : function() {
        alert("DIDN'T WORK!");
    },
    complete : function() {
    }
});
} 
```

php文件：

```
<?php

$host="localhost"; // Host name 
$username="root"; // Mysql username 
$password=""; // Mysql password 
$db_name="test"; // Database name 
$tbl_name="seat"; // Table name 

// Connect to server and select databse.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

$seatid = mysql_real_escape_string($_POST['seatid']);
$error = '';

$query = "INSERT INTO seat ( seatNo ) VALUES ('{$seatid}')";

if (!mysql_query($query, $conn))
{
$error = mysql_error();
$return['error'] = $error;
echo json_encode($return);
mysql_close($conn);
}
else
{
$success = "Seat Successfully Added!";
$return['mysql'] = $success;
echo json_encode($return);
mysql_close($conn);
} 
```

?>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:31:20.340

有些浏览器不理解这个

```
data : { 
  seatid  : t_name,
}, 
```

尝试

```
data : {
  seatid  : t_name
}, 
```

删除多余的逗号。

像这样使用php

```
<?php

$return['error'] = $error;
echo json_encode($return);

?> 
```

另外在js里写这个，看看你得到了什么。

```
complete : function(data) {
     alert('complete');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T20:11:04.883

```
 <html>
 <head>
<title>Seat Reservation </title>
<script src="js/jquery.js" type="text/javascript"></script>
</head>
<body>
<form id="form111" >
<script type="text/javascript"
  src="js/jquery.js">
</script>
   <div id="screen"><p class= "pos_fixed">S C R E E N</p></div>

   <div id="holder"> 
    <ul  id="place">
    </ul>    
</div>
 <div style="width:600px;text-align:center;overflow:auto"> 
<ul id="seatDescription">
<li style="background:url('images/available_seat_img.gif') no-repeat scroll 0 0     transparent;">Available Seat</li>
<li style="background:url('images/booked_seat_img.gif') no-repeat scroll 0 0 transparent;">Booked Seat</li>
<li style="background:url('images/selected_seat_img.gif') no-repeat scroll 0 0 transparent;">Selected Seat</li>
</ul>        </div>
<div style="width:580px;text-align:left;margin:5px">
    <input type="button" id="btnShowNew" value="Show Selected Seats" name="btnShowNew" /><input type="button" id="btnShow" value="Show All" /> </form> 
<table width="300" border="0" >
<tr>
<form name="form1" method="post" action="login.html">
<td>
<table width="100%" border="0" >
<tr>
<td width="294"><input type="submit" name="Submit" value="Logout"></td>
</tr>
</form>

 <form method="post" id="reserveid">
 <td>
 <table width="100%" border="0" >
 <tr>
 <td width="294"><input type="button" value="reserve""></td>
 </tr>
 </form>

 <form id="cvvform" method="post" action="checkcvv.php">
 <td>
 <table width="100%" border="0" >
 <tr>
 <td width="294"><input type="submit" name="cvvchecking" value="cvvchecking"          id="cvvchecking"></td>
 </tr>
 <tr>
 <td>CVV<input type="text" maxlength="4" id="cvvchecking"  name="cvvchecking" /></td>
 <td>USERNAME<input type="text" id="username"  name="username" /></td>
 </tr>
 </form>

    <script type="text/javascript">
    $(function () {
        var settings = {
            rows: 5,
            cols: 15,
            rowCssPrefix: 'row-',
            colCssPrefix: 'col-',
            seatWidth: 35,
            seatHeight: 35,
            seatCss: 'seat',
            selectedSeatCss: 'selectedSeat',
            selectingSeatCss: 'selectingSeat'
        };

        var init = function (reservedSeat) {
            var str = [], seatNo, className;
            for (i = 0; i < settings.rows; i++) {
                for (j = 0; j < settings.cols; j++) {
                    seatNo = (i + j * settings.rows + 1);
                    className = settings.seatCss + ' ' + settings.rowCssPrefix + i.toString() + ' ' + settings.colCssPrefix + j.toString();
                    if ($.isArray(reservedSeat) && $.inArray(seatNo, reservedSeat) != -1) {
                        className += ' ' + settings.selectedSeatCss;
                    }
                    str.push('<li class="' + className + '"' +
                              'style="top:' + (i * settings.seatHeight).toString() + 'px;left:' + (j * settings.seatWidth).toString() + 'px">' +
                              '<a title="' + seatNo + '">' + seatNo + '</a>' +
                              '</li>');
                }
            }
            $('#place').html(str.join(''));
        };

        //case I: Show from starting 
        init();

        //Case II: If already booked
        var bookedSeats = [];
        init(bookedSeats);

        $('.' + settings.seatCss).click(function () {
        if ($(this).hasClass(settings.selectedSeatCss)){
            alert('This seat is already reserved');
        }
        else{
            $(this).toggleClass(settings.selectingSeatCss);
            }
        });

        $('#btnShow').click(function () {
            var str = [];
            $.each($('#place li.' + settings.selectedSeatCss + ' a, #place li.'+ settings.selectingSeatCss + ' a'), function (index, value) {
                str.push($(this).attr('title'));
            });
            alert(str.join(','));
        })

        $('#btnShowNew').click(function () {
            var str = [], seatid;
            $.each($('#place li.' + settings.selectingSeatCss + ' a'), function (index, value) {
                seatid = $(this).attr('title');                   
               str.push(seatid);                   
            });
            alert(str.join(' , '));
        })

})

</script> 
```

所有这些代码都工作正常......“btnShowNew”输出用户点击的座位ID......现在我需要在用户点击它时制作一个按钮“保留”btnShowNew表单内的座位id的值将是添加到数据库

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T19:25:10.427

也许您对 jquery 有疑问，希望这可行

```
$(document).ready(function() {
            $("#reserveid").click(function(){

                alert('CLICK'); //here you have to be able to see the alert if not maybe the jquery is not working properly
                var t_name    = $("#btnShowNew ['seatid']").val(); //Not sure if you are taking a value
                alert(t_name); //here you have to be able to see the value that you are catching
                $.ajax({
            url:'insert.php',
            type:'POST',
            dataType:'json', //since you are echo json_encode($return)
            data:{
                'seatid':t_name //use ' just in case
            },
            success:function (result) {
                            if(result.error){
                                alert(result.error); // .error because it is the key of the array you are giving back
                                return;
                            }
                        }
        });
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-03T05:25:49.407

抱歉，您的代码不整洁，无法看到您需要的部分。但是有一些想法，我可以给你，由你来解决你的问题或使代码更清晰（只是你需要的部分）。

您知道表单将数据从一个页面发送到另一个页面（使用 POST 或 GET 方法），因此当您按下提交按钮时，会将所有输入发送到表单的操作。您可以在此[页面中查看示例](http://www.w3schools.com/html/html_forms.asp)

[之后，您必须像这里](http://www.w3schools.com/php/php_mysql_insert.asp)一样将该数据保存到数据库中

# c# - 从 SourceB 获取 SourceA 中具有 ID 的任何元素

> ID：15118243
> 
> 赞同：1
> 
> 时间：2013-02-27T17:20:49.667
> 
> 标签：c#, asp.net, linq, entity-framework, lambda

我一直在尝试为两个不同数据库中的两个模型构建一个看起来很奇怪的连接方法，您可以查询第一个，然后返回一个小的 id 列表以在另一个数据库中搜索。一切正常，除了一两件事，我无法使用 lambda 函数执行 Id 列表子查询，我有链接通用的 Id 选择器函数，但在 where 子句中它现在可以工作，因为我不知道谁链接源类型对象传递给 Id 的函数，因此`.Where(TSource => idlist.Contains(Idselector)`示例代码低于由于`List.Conatins`代码而中断的位置。如果有人可以提供帮助，我将不胜感激

```
public static Foo JoinTwoModels<T1,T2>(
           DbSet Dbs1,
           DbSet Dbs2,
           Expression<Func<T1, object>> Id1,
           Expression<Func<T1, dynamic>> Selector1,
           Expression<Func<T1, bool>> Search1,
           Expression<Func<T2, object>> Id2,
           Expression<Func<T2, dynamic>> Selector2)
        {
            var Output1 = Queryable.OfType<T1>(Dbs1);

            var Output2 = Queryable.OfType<T2>(Dbs2);

            List<dynamic> Result1 = Output1.Where(Search1).Select(Selector1).ToList();

            List<object> idList = new List<object>();

            PropertyInfo p1 = Result1[0].GetType().GetProperty("Id");

            foreach (var o1 in Result1)
            {
                idList.Add(p1.GetValue(o1));
            }

            //Query result entries into db
            List<T2> Result2 = Output2.Where(idlist.contains(Id2)).ToList(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:03:07.360

像这样的东西怎么样：

```
public class Foo
{
    public int Context;
    public string Data;
}

public class Bar
{
    public int Context;
    public string Data;
}

public static IEnumerable<TOutput> JoinTwoModels<T1, T2, TIdent, TOutput>(
    IEnumerable<T1> sourceA,
    IEnumerable<T2> sourceB,
    Func<T1, TIdent> idSelectorA,
    Func<T2, TIdent> idSelectorB,
    Func<T1, TOutput> selectorA,
    Func<T2, TOutput> selectorB)
{

    var queryA = sourceA
            .Select(x => new {Value = selectorA(x),Id = idSelectorA(x)});

    var queryB = sourceB
            .Select(y => new {Value = selectorB(y),Id = idSelectorB(y)})
            .Where(y => queryA.Select(x => x.Id).Contains(y.Id))
            .Select(y => y.Value);

    return queryA.Select(x => x.Value).Concat(queryB);
}

private static void Main(string[] args)
{
    var sourceA = new List<Foo>() {new Foo() {Context = 2, Data = "I'm a Foo"}};
    var sourceB = new List<Bar>() {new Bar() {Context = 2, Data = "I'm a Bar"}};

    var Output1 = sourceA.AsQueryable();
    var Output2 = sourceB.AsQueryable();

    var results = JoinTwoModels(
        Output1,
        Output2,
        (Func<Foo, int>) (x => x.Context),
        (Func<Bar, int>) (x => x.Context),
        (Func<Foo, string>) (x => x.Data),
        (Func<Bar, string>) (x => x.Data));

    foreach (var item in results)
        Console.WriteLine(item);
} 
```

你想要的不是很清楚；所以在上面，我从 Source-A（Foo 类型）和 Source-B（Bar 类型）中选择共享一个公共上下文（id）的所有项目，并以转换后的公共类型返回它们。

如果您只想要 b 中的值，则可以将其简化为：

```
var queryA = sourceA.Select(idSelectorA);

var queryB = sourceB
        .Select(y => new {Value = selectorB(y),Id = idSelectorB(y)})
        .Where(y => queryA.Select(x => x).Contains(y.Id))
        .Select(y => y.Value);

return queryB; 
```

# php - 在 MySQL 数据库中存储带有换行符的文本

> ID：15118244
> 
> 赞同：2
> 
> 时间：2013-02-27T17:20:50.010
> 
> 标签：php, mysql

所以我有一个简单的问题，我正在尝试从 Html 表单中获取文本，然后在每个请求上添加一个 '\n'，对于换行符，我尝试过这个：

```
 '".$customtext."'.'\n' 
```

或这个 ：

```
 '".$customtext.'\n'"' 
```

没有运气，有没有办法做到这一点？

谢谢 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:28:54.287

您需要使用双引号（例如：$var_to_print = $str . "\n";) // 使用简单引号将不起作用 '

我不确定你是否正在寻找这个，或者你可能想使用一段时间/foreach bucle 将每个“\n”替换为“<br>”

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:22:17.383

试试`$customtext."\n"`——双引号应该可以解决问题。编辑：如果你想在 HTML 代码中输出，你可以看看 function `nl2br`。

# ruby-on-rails-3 - 为什么 rspec 失败？

> ID：15118245
> 
> 赞同：0
> 
> 时间：2013-02-27T17:21:01.680
> 
> 标签：ruby-on-rails-3, rspec, rspec2, rack-test

我想通过 rspec 检查页面的标题。在 chrome 中我看到了预期的结果，但 rspec 声称标题为空（在 chrome 视图源中它也可以）。这里有一些代码：

应用程序.html.rb

```
<!DOCTYPE html>
<html>
<head>
  <title>site | <%= yield(:title) %></title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
</head>
<body>

<%= yield %>

</body>
</html> 
```

主页.html.erb

```
<% provide(:title, 'Home') %>
<h1><%= yield(:title) %></h1>
<article>
  <div><a href="#">Cameras</a></div>
  <div><a href="#">TVs</a></div>
  <div><a href="#">Laptops</a></div>
</article> 
```

home_page_controller.rb

```
class HomePageController < ApplicationController
  def home
  end
end 
```

路线.rb

```
Reviewsite::Application.routes.draw do
   get "home_page/home" 
```

home_pages_spec.rb

```
require 'spec_helper'
feature "HomePages" do

  before { visit '/home_page/home'}

  scenario do
    expect(page).to have_selector('h1', text: "Home")
  end

  scenario do
    expect(page).to have_selector('title', text: "site | Home")
  end

end 
```

和错误

```
Failures:

  1) HomePages 
     Failure/Error: expect(page).to have_selector('title', text: "site | Home")
     Capybara::ExpectationNotMet:
       expected to find css "title" with text "site | Home" but there were no matches. Also found "", which matched the selector but not all filters.
     # ./spec/features/home_pages_spec.rb:12:in `block (2 levels) in <top (required)>'

Finished in 2.52 seconds
2 examples, 1 failure 
```

**编辑：** 这是我的 gemfile

```
source 'https://rubygems.org'

gem 'rails', '3.2.12'
gem 'bootstrap-sass', '2.3.0.1'
gem 'bcrypt-ruby', '3.0.1'
gem 'faker', '1.1.2'
gem 'will_paginate', '3.0.4'
gem 'bootstrap-will_paginate', '0.0.9'
gem 'jquery-rails', '2.2.1'
gem 'mysql2'
#gem 'execjs'
gem 'therubyracer', :platforms => :ruby

# Dev and test gems
group :development, :test do
  gem 'rspec-rails', '2.13.0'
  gem 'guard-rspec', '2.4.1'
  gem 'guard-spork', '1.4.2'
  gem 'spork', '0.9.2'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '3.2.6'
  gem 'coffee-rails', '3.2.2'
  gem 'uglifier', '1.3.0'
end

#only test gems
group :test do
  gem 'capybara', '2.0.2'
  gem 'factory_girl_rails', '4.2.1'
  gem 'cucumber-rails', '1.3.0', :require => false
  gem 'database_cleaner', '0.9.1'
  # gem 'launchy', '2.1.0'
  # gem 'rb-fsevent', '0.9.1', :require => false
  # gem 'growl', '1.0.3'
end

group :production do
  gem 'pg', '0.12.2'
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:33:23.397

我看到问题是关于会话的。Capybara 在每个`it`或`scenario`您的情况下过期会话。

因此，您`visit page`在第一种情况下被消耗掉了，然后在第二种情况下没有食物可吃。

您可以尝试：

1.  删除`before { visit '/home_page/home'}`部件，并在每个场景中访问页面。
2.  将这两种情况合二为一。但是，仍然`visit`是首选放在里面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T16:34:15.967

代替

```
expect(page).to have_selector('title', text: "site | Home") 
```

我把它改成

```
expect(page.html).to have_selector('title', text: "site | Home") 
```

它有效，我仔细检查了它。如果有人理解为什么单独的页面不起作用，请分享。

# vb.net - 右键单击时获取动态创建的项目的文本

> ID：15118246
> 
> 赞同：1
> 
> 时间：2013-02-27T17:21:03.223
> 
> 标签：vb.net

我有一些带有上下文菜单条的动态创建标签。当您右键单击标签时，它会给您一个上下文菜单条。当我单击上下文菜单条中的项目时，如何获取他们的文本？我知道这是一个非常简单的问题，但我需要一些帮助。我试过了

```
Private Sub DeleteToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles DeleteToolStripMenuItem.Click
        MsgBox(sender.Text)
End Sub 
```

我正在尝试获取生成上下文菜单条的标签文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:43:56.487

我认为您正在寻找哪个控件触发了上下文菜单，如下所示：

```
Private Sub DeleteToolStripMenuItem_Click(ByVal sender As Object, ByVal e As EventArgs) Handles DeleteToolStripMenuItem.Click

  Dim menuItem As ToolStripItem = TryCast(sender, ToolStripItem)
  If menuItem IsNot Nothing Then
    Dim owner As ContextMenuStrip = TryCast(menuItem.Owner, ContextMenuStrip)
    If owner IsNot Nothing Then
      Dim sourceControl As Control = owner.SourceControl
      MessageBox.Show(sourceControl.Text)
    End If
  End If
End Sub 
```

[从确定使用 ContextMenuStrip 的控件](https://stackoverflow.com/a/4886417/719186)转换为 VB.Net

# functional-programming - 我需要在 OCaml 中调用 Random.self_init 吗？

> ID：15118247
> 
> 赞同：2
> 
> 时间：2013-02-27T17:21:07.170
> 
> 标签：functional-programming, ocaml

首先，我不在乎`seed`这个问题。

我的问题是，`Random.self_init`每次我想在我的函数中重新开始时我是否应该打电话？

```
let shuffle l = 
  Random.self_init ();
  let tagl = List.map (fun x -> (Random.bits (), x)) l in
  List.map (fun x -> snd x) (List.sort compare tagl);; 
```

**例如，在上面的代码中，是否`Random.self_init ()`有必要？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T17:25:33.643

每次要洗牌时都调用它是浪费熵。最好在程序开始时调用一次。但是，如果您想为程序的不同运行获得不同的随机播放，您确实需要在某个时候初始化随机生成器。对于某些应用程序，您可能希望使用自己选择的特定值进行初始化（例如，如果您希望以后能够重现结果）。为此，您可以使用`Random.init`或`Random.full_init`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T16:03:11.217

```
(* Initialize Random so it won't use the default seed *)
let _ = Random.self_init() 
```

我会在我的类型定义之后和我使用随机数的每个 .ml 文件中的函数之前包含这一行，这样每次我运行我的程序时，我都会得到一个不同的随机数。
对于大多数程序，我认为 Random.self_init 比 Random.init 和 Random.full_init 更可取，但正如 Jeffrey Scofield 所说，如果你想重现你的结果，请使用它们。

# java - 如何使 Spring AspectJ 注释在 Java 6/7 中工作

> ID：15118250
> 
> 赞同：0
> 
> 时间：2013-02-27T17:21:11.740
> 
> 标签：java, spring, maven, aspectj

我需要对以下配置文件进行哪些更改才能让 maven 使用 Spring Aspects（带有注释的那个）编译我的 Java 7 项目？

```
pom.xml
webapplicationContext.xml
etc.... 
```

这是我的方面类*（它捕获`NoResultException`from`TypedQuery.getSingleResult()`并将其转换为空结果值）*

```
package com.example.aspect;

import javax.persistence.NoResultException;

import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Pointcut;

@Aspect
public class NullifyNoResultExceptionAspect {

    @Pointcut("execution(public * com.example.dao.impl.*.*(..))")
    public void methodToBeProtected() {}

    @Around("methodToBeProtected()")
    public Object queryToProtect(ProceedingJoinPoint pjp) throws Throwable {
        try {
            return pjp.proceed();
        } catch (NoResultException nre) {
            return null;
        }
    }

} 
```

我正在使用 Eclipse Juno sr1 和 Java 7 EE。
我的构建环境是带有 Nexus 存储库的 Maven (2)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:46:31.533

以下对我有用：

1.  `aop.xml`在目录下创建一个名为：的文件`META-INF`（与`persistence.xml`.

2.  修改以在您的bean 定义`webApplicationContext.xml`中包含 Spring 方面 bean （在主项目中）。 `emf``src/java/resources`

3.  在`aspectj-maven-plugin`您的`pom.xml`.

4.  确保告诉 aspectj 插件您要编译 Java 7 代码，否则它将尝试使用默认的 AspectJ-1.6 编织器来编织您的 1.7 代码。

**1 - aop.xml**

```
<!DOCTYPE aspectj PUBLIC
        "-//AspectJ//DTD//EN" "http://www.eclipse.org/aspectj/dtd/aspectj.dtd">
<aspectj>

    <weaver>

        <!-- only weave classes in our application-specific packages -->
        <include within="com.example.*"/>

    </weaver>

    <aspects>

        <!-- weave in just this aspect -->        
        <aspect name="com.example.aspect.NullifyNoResultExceptionAspect"/>

    </aspects>

  </aspectj> 
```

**2 - WebApplicationContext.xml**
你的 emf bean 应该是这样的：

```
<bean id="emf"
    class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="packagesToScan" value="za.org.serviceseta.model" />
    <property name="jpaVendorAdapter">
        <bean
            class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
            <property name="showSql" value="${hibernate.showsql}" />
            <property name="generateDdl" value="${jpa.generateDdl}" />
            <property name="databasePlatform"
                value="org.hibernate.dialect.MySQLDialect" />
        </bean>
    </property>
    <property name="jpaProperties">
        <props>
            <prop key="hibernate.hbm2ddl.auto">update</prop>
        </props>

    </property>
    <property name="loadTimeWeaver">
        <bean
            class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver" />
    </property>
</bean> 
```

_注意，有些教程告诉你包含`<context:load-time-weaver />`，但这仅适用于toplink，不适用于spring；春想见豆。

**3 - pom.xml - 第 1 部分：告诉`jetty-maven-plugin`使用 spring javaagent**

```
<build>
    <plugins>
        <plugin>
            <groupId>org.eclipse.jetty</groupId>
            <artifactId>jetty-maven-plugin</artifactId>
            <version>9.0.0.M5</version>
            <configuration>
                <forkMode>once</forkMode>
                <argLine>
                     -javaagent:"${settings.localRepository}/org/springframework/spring-instrument/${spring.framework.version}/spring-instrument-${spring.framework.version}.jar"
                </argLine>
.... 
```

**3 - pom.xml - 第 2 部分：`aspectj-maven-plugin`**

```
<project>
....
    <properties>
        <aspectj.version>1.7.2</aspectj.version>
        <!-- note that AspectJ warns you that it prefers 1.6.11, but this works -->
        .....

<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>aspectj-maven-plugin</artifactId>
    <version>1.4</version>
    <configuration>
        <showWeaveInfo>true</showWeaveInfo>
        <source>1.7</source>     <!-- need these for Java 7! -->
        <target>1.7</target>     <!-- need these for Java 7! -->
        <Xlint>ignore</Xlint>
        <complianceLevel>1.7</complianceLevel>  <!-- need these for Java 7! -->
        <encoding>UTF-8</encoding>
        <verbose>false</verbose>
        <aspectLibraries>
            <aspectLibrary>
                <groupId>org.springframework</groupId>
                <artifactId>spring-aspects</artifactId>
            </aspectLibrary>
        </aspectLibraries>
    </configuration>
    <executions>
        <execution>
            <goals>
                <goal>compile</goal>
                <goal>test-compile</goal>
            </goals>
        </execution>
    </executions>
    <dependencies>
        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjrt</artifactId>
            <version>${aspectj.version}</version>
        </dependency>
        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjtools</artifactId>
            <version>${aspectj.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aspects</artifactId>
            <version>3.2.1.RELEASE</version>
        </dependency>
    </dependencies>
</plugin> 
```

**3 - pom.xml 第 3 部分：依赖项**

```
<dependency>
    <groupId>org.aspectj</groupId>
    <artifactId>aspectjrt</artifactId>
    <version>${aspectj.version}</version>
</dependency>
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-aspects</artifactId>
    <version>3.2.1.RELEASE</version>
</dependency>
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-agent</artifactId>
    <version>2.5.6</version>
</dependency> 
```

如果我遗漏了什么，请随时发表评论。

# python - 泡沫和“不匹配的标签”

> ID：15118256
> 
> 赞同：1
> 
> 时间：2013-02-27T17:21:22.340
> 
> 标签：python, web-services, soap, suds

我正在使用 Suds 来消耗一个肥皂网络服务（调试模式打开）。

我调用wsdl没有问题

```
from suds.client import Client
client = Client('https://ipwebservice?wsdl') 
```

印刷

```
print client 
```

我获得了一些关于网络服务的信息：只有一个“服务”，在一个独特的端口上，一些方法和一些类型。

但是，当我尝试调用传递简单参数的方法时

```
result = client.service.method('test') 
```

我收到此错误：

```
xml.sax._exceptions.SAXParseException: <unknown>:4:2: mismatched tag 
```

如果我尝试使用 SoapUI 使用/发送相同的信封，我没有问题。

# php - PHP 是否为匿名函数创建输出缓冲区？

> ID：15118261
> 
> 赞同：1
> 
> 时间：2013-02-27T17:21:37.990
> 
> 标签：php

我想知道下面的代码会发生什么：

```
<?php
function CountUp($count2, $count1)
{
    $count1(); // Say one
    $count2(); // Say two
}

CountUp(function() {
?>
    Two
<?php
}, function() {
?>
    One
<?
}); 
```

显然，PHP 为匿名函数创建了一个输出缓冲区，并在我们调用它们时刷新该缓冲区。

问题是：这是预期的 PHP 行为吗？我想在我的模板引擎中使用这个功能，所以它不能是hackish并且有不可预测的行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:31:06.413

```
<?php
function x() {
   echo 'x';
}
x();
?> 
```

在功能上等同于

```
<?php function y() { ?>
y
<? } 
y();

?> 
```

只有在调用函数时，两者才会输出它们的`x`和字符。`y`

# android - 带有切换按钮的 Android mediplayer 代码不起作用

> ID：15118262
> 
> 赞同：0
> 
> 时间：2013-02-27T17:21:39.813
> 
> 标签：android, media-player, togglebutton

我在 res/raw 文件夹中有 mp3。在 xml 文件中，我得到了 2 个切换按钮，其 ID 为 togg1 和 togg2。在这个主要课程中，我尝试运行。它可以工作，但是当我单击切换按钮时，它不会播放和歌曲

```
package com.disembodiedtech.funny.sounds;

import android.media.MediaPlayer;
import android.os.Bundle;
import android.app.Activity;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ToggleButton;

public class FunnySounds extends Activity implements OnClickListener {

ToggleButton togg1;
ToggleButton togg2;

public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_funny_sounds);

        togg1 = (ToggleButton) findViewById(R.id.togg1);
        togg2 = (ToggleButton) findViewById(R.id.togg2);
        mbaby = MediaPlayer.create(this, R.raw.baby);
        mband = MediaPlayer.create(this, R.raw.band);
        togg1.setOnClickListener(this);
        togg2.setOnClickListener(this);
        }

        public void OnClick(View v) {
        switch(v.getId()) {
        case R.id.togg1:
            if(togg1.isChecked()) {
                mbaby.start();
                mbaby.setLooping(true);
            }
            else
                mbaby.pause();
            break;

        case R.id.togg2:
            if(togg2.isChecked()) {
                mband.start();
                mband.setLooping(true);
            }
            else
                mband.pause();
            break;
            }
            }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:35:37.780

因为你不是.change的重写`onClick`方法`OnClickListener`

```
public void OnClick(View v) {
//...your code here..
} 
```

到

```
@Override
public void onClick(View v)
{
    //...your code here..
} 
```

# php - 如何停止产品编号 10 以在 PHP 中下推产品编号 9？

> ID：15118264
> 
> 赞同：0
> 
> 时间：2013-02-27T17:21:43.653
> 
> 标签：php, mysql

这个问题及其标题可能会让人觉得是一个模糊的问题，如果是这样，我很抱歉，但我没有其他方法可以问它，因为我自己也很困惑。

好的，这里是：

我正在创建一个网站，网站所有者可以在主页上发布带有图片的产品！这一点工作正常。

主页最多只能显示 10 个产品。这一点也有效。

产品按数字存储在数据库中。例如：第一个项目/产品保存为产品编号 1，1 是其 ID，产品编号 2 是 2，3 是 3，依此类推。这一点也可以正常工作，因为我希望它可以工作。

这是问题：

假设我在主页上添加了 10 种产品，这是它可以在主页上显示的最大产品。产品 1 至 10。

当我添加新产品（产品编号 11 ）时，这个新添加的产品将删除添加的最旧产品，即产品编号 1。

我不希望这种情况发生。我需要产品/项目以某种方式保持在队列中，并像其他产品一样存储在数据库中，直到我手动删除/删除其中一个旧产品，它将自动被替换。

这是我用于将产品添加到数据库中的代码：

```
<?php 
// Parse the form data and add inventory item to the system
if (isset($_POST['product_name'])) {

    $product_name = mysql_real_escape_string($_POST['product_name']);
    $link = mysql_real_escape_string($_POST['link']);
    $retail = mysql_real_escape_string($_POST['retail']);
    $clicks = mysql_real_escape_string($_POST['clicks']);
    $price = mysql_real_escape_string($_POST['price']);
    $category = mysql_real_escape_string($_POST['category']);
    $subcategory = mysql_real_escape_string($_POST['subcategory']);
    $details = mysql_real_escape_string($_POST['details']);
    // See if that product name is an identical match to another product in the system
    $sql = mysql_query("SELECT id FROM products WHERE product_name='$product_name' LIMIT 1");
    $productMatch = mysql_num_rows($sql); // count the output amount
    if ($productMatch > 0) {
        echo 'Sorry you tried to place a duplicate "Product Name" into the system, <a href="index.php">click here</a>';
        exit();
    }
    // Add this product into the database now
    $sql = mysql_query("INSERT INTO products (product_name, link, retail, clicks, price, details, category, subcategory, date_added) 
        VALUES('$product_name','$link','$retail','$clicks','$price','$details','$category','$subcategory',now())") or die (mysql_error());
     $pid = mysql_insert_id();
    // Place image in the folder 
    $newname = "$pid.jpg";
    move_uploaded_file( $_FILES['fileField']['tmp_name'], "../inventory_images/$newname");
    header("location: index.php"); 
    exit();
}
?> 
```

任何帮助都会非常有帮助。即使它让我朝着正确的方向前进。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:34:40.143

DB Schema 对我们来说是不必要的。这是一个订购问题。您可能会在获取主页项目的 SQL 查询中找到类似“ORDER BY id DESC”或日期的内容。您需要按 id ASC 订购商品（这是 SQL 的默认行为，因此只需“ORDER BY id”就足够了。

重复一遍 - 您的 SQL 专门按日期或 ID 对记录 DESC 进行排序。

# android - 异步监控安卓短信数据库的最佳实践

> ID：15118267
> 
> 赞同：0
> 
> 时间：2013-02-27T17:21:46.787
> 
> 标签：android, android-service

我有一个 android 应用程序，我目前正在使用 AsyncTask 来监控 android SMS `database/provider`（“content://sms”）。每当启动主要活动时都会运行
此程序。`AsyncTask`

现在，我希望能够异步执行此操作，即，每当发送或接收 SMS 时更新我的​​数据库。

我目前正在使用`IntentService`这样做，`AlarmManager`用于设置每 2 分钟重复运行一次。

我还尝试了一个“STICKY”服务，该服务在发送或接收 SMS 时 使用 a`ContentObserver`来运行线程。`handler.post()`

我的疑问是：

1）哪种方法更有效？实现“STICKY”服务或 IntentService 方法的那个？

2）如果我使用handler.post()，想象以下场景：收到一条短信并运行线程。当这个线程运行时，如果收到另一条短信，是否会创建一个新线程并与旧线程同时运行？

3）除了我到目前为止尝试过的方法之外，还有其他方法吗？

谢谢。

# jsf - 如何激活一些primefaces：同时就地

> ID：15118268
> 
> 赞同：0
> 
> 时间：2013-02-27T17:21:46.387
> 
> 标签：jsf, primefaces

我想在激活第一个时激活第二个地方。

```
<p:inplace id="selectableInplaceProvincia" label="#{clientesMB.empClienteEditar.nombreProvinciaEmpresa}" effectSpeed="fast" >  
    <p:selectOneMenu id="idprov1" value="#{clientesMB.prov}"  effect="fade" converter="ccConverter" style="width: 300px;">  
        <f:selectItems value="#{clientesMB.itemsProv}" var="player" itemLabel="#{player.nombre}" itemValue="#{player}"/>  
        <f:ajax execute="@this"  listener="#{clientesMB.llenarParaconvertermuni}" render="idmuni1" />
    </p:selectOneMenu> 
</p:inplace> 

<h:outputText value="Municipio: " style="font-size: 12px"/>  
<p:inplace id="selectableInplaceMunicipio" label="#{clientesMB.empClienteEditar.nombreMunicipioEmpresa}" effectSpeed="fast" >  
    <p:selectOneMenu id="idmuni1" value="#{clientesMB.munic}" effect="fade" converter="muniConverter" style="width: 300px; height: auto">  
        <f:selectItems value="#{clientesMB.itemsMuni}" var="player2" itemLabel="#{player2.nombreMunicipio}" itemValue="#{player2}"/>  
    </p:selectOneMenu>  
</p:inplace> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:37:48.953

`widgetVar`在第二个上定义 a并在其上`<p:inplace/>`调用`show()`函数。`<p:inplace/>`没有将 javasscript 事件定义为属性，因此您必须将其包装在容器组件中或在封闭组件上触发它：

```
<h:panelGrid style="width=20px" onclick="secondPlace.show()">  
 <p:inplace id="selectableInplaceProvincia" label="#{clientesMB.empClienteEditar.nombreProvinciaEmpresa}" effectSpeed="fast" >

      <p:selectOneMenu onchange="secondInplace.show()" id="idprov1" value="#{clientesMB.prov}"  effect="fade" converter="ccConverter" style="width: 300px;" >  
           <f:selectItems value="#{clientesMB.itemsProv}" var="player" itemLabel="#{player.nombre}" itemValue="#{player}"/>  
           <f:ajax execute="@this"  listener="#{clientesMB.llenarParaconvertermuni}" render="idmuni1" />
      </p:selectOneMenu> 
 </p:inplace> 
</h:panelGrid>  
 <h:outputText value="Municipio: " style="font-size: 12px"/>  
 <p:inplace id="selectableInplaceMunicipio" widgetVar="secondInplace" label="#{clientesMB.empClienteEditar.nombreMunicipioEmpresa}" effectSpeed="fast" >  
    <p:selectOneMenu id="idmuni1" value="#{clientesMB.munic}" effect="fade" converter="muniConverter" style="width: 300px; height: auto">  
        <f:selectItems value="#{clientesMB.itemsMuni}" var="player2" itemLabel="#{player2.nombreMunicipio}" itemValue="#{player2}"/>  
  </p:selectOneMenu>  
 </p:inplace> 
```

# asp.net - 如何避免 UriBuilder 在其查询字符串中创建带有未编码 + 符号的 Uri？

> ID：15118269
> 
> 赞同：1
> 
> 时间：2013-02-27T17:21:47.567
> 
> 标签：asp.net, urlencode

.Net 中的 UriBuilder 和 Uri 类有一些问题。我想用 UriBuilder 构建我的 Uri，然后使用生成的 Uri。但是，我无法让它正确编码其查询字符串中的加号？

这是一个小代码示例：

```
var ub = new UriBuilder();
ub.Query = "t=a%2bc";
Console.WriteLine(ub.Uri.ToString()); 
```

这个例子给了我`http://localhost/?t=a+c`，但我希望加号像这样编码为 %2b ，`http://localhost/?t=a%2bc`否则我不能使用 url。

我当然可以构建一个字符串，但如果可能的话，我更愿意使用强类型的 Uri。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:16:06.810

有趣的是，这似乎在 .NET 4.5 中已“修复”。

这是我在 .NET **4.0**中测试的结果：（来自即时窗口）

```
? ub.Uri.ToString()
"http://localhost/?t=a+c" 
```

*但*在 .NET **4.5**中：

```
? ub.Uri.ToString()
"http://localhost/?t=a%2bc" 
```

这就是你要找的。

能升级到4.5吗？这将解决您的问题。

如果您无法升级，请告诉我，我会尝试寻找解决方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T09:55:53.430

在我们有机会更新到 VS2012/.Net4.5 之前，我最终得到了一个自定义 Uri 类来包装 Uri。我正在处理的系统中的大多数 Uris 不是通过新 Uris 创建的，而是使用 Querybuilder 方法创建的，这意味着交换该部分以返回 Uri2 而不是 Uri 是“容易的”。

```
public class Uri2 : Uri
{
    public Uri2(Uri uri)
        : base(uri.ToString())
    {

    }

    public override string ToString()
    {
        var s = base.ToString();
        s = s.Replace("+", "%2b");
        return s;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-09T20:19:52.203

使用 AbsoluteUri 代替 ToString()：

```
var ub = new UriBuilder();
ub.Query = "t=a%2bc";
Console.WriteLine(ub.Uri.AbsoluteUri); 
```

这给出了正确的结果：

```
http://localhost/?t=a%2bc 
```

# java - Java中具有通用返回类型的方法调用

> ID：15118271
> 
> 赞同：9
> 
> 时间：2013-02-27T17:21:49.487
> 
> 标签：java, function, generics, methods

在 C++ 中，您可以在参数中指定函数的返回类型，例如：

C++

```
 float* myFloat = CollectionClass.ptr<float>();
    int*   myInt   = CollectionClass.ptr<int>(); 
```

Java中是否有等效的方法来指定返回类型而不添加额外的类参数？

爪哇

```
 //This doesn't work (due to type erasure) 
    public <T> T getDate() 
    {
        if (T instanceof Date)
            return new Date();
        if (T instanceof Calendar)
            return new Calendar();
    }

    Date myDate = getDate<Date>(); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-27T20:09:52.260

用签名声明一个方法是完全可以的`public <T> T getDate()`。

但是，不可能*实现*返回所需内容的方法。一个方法在运行时所做的不能仅仅依赖于它的类型参数，因为它不知道它的类型参数。

要对此有一个直觉，请意识到使用泛型编写的任何代码也可以在不使用泛型的情况下等效地编写，只需删除泛型参数并在适当的地方插入强制转换即可。这就是“类型擦除”的意思。

因此，要查看您的方法在泛型中是否可行，只需问一下，如果没有泛型，您将如何做：

```
public Object getDate() 
{
    // what would you do here?
}

Date myDate = (Date)getDate(); 
```

如果没有泛型就无法做到，那么使用泛型也无法做到。

C++ 模板完全不同。对于模板化函数和类，C++ 模板会为与它一起使用的每个类型参数生成函数或类的“单独副本”。即编译器采用模板化代码并将其“复制并粘贴”到多个版本中，每个版本都是单独的。因此，代码的每个副本都特定于某个类型参数，因此可以在运行时使用该类型。

这就是为什么要求 C++ 模板化代码以源代码形式提供以便您使用它的原因——没有“编译”模板之类的东西。但是，在 Java 中，可以使用已编译的泛型类。Java 中的泛型类和方法不对它们可以使用的类型做任何假设。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-27T17:25:07.090

好的，现在进行编辑以明确代码以`T`...为条件

不，正如您的问题所提到的，由于类型擦除，Java 中没有什么简单的方法可以完成这项工作。你可以传入`Class<T>`：

```
public <T> T getDate(Class<T> clazz)
{
    // Now use clazz to work out what to do
} 
```

...但是您不能做*任何*取决于`T`执行时自身“价值”的事情，因为这根本不为人所知。不幸的是，泛型在 Java 中有些乏力:(

* * *

编辑：在编辑之前使代码以`T`...为条件

这只是以不同方式指定类型参数的问题：

```
import java.util.Date;

class Test {

    public static <T> T getDate() {
        return (T) new Date();
    }

    public <T> T getDateInstanceMethod() {
        return (T) new Date();
    }

    public static void main (String [] args) {
        Date date = Test.<Date>getDate();

        // Compiles fine, but is obviously bogus.
        String string = Test.<String>getDate();

        // And specifying a type argument for an instance method
        Test test = new Test();
        date = test.<Date>getDate();
    }
} 
```

我也一直更喜欢“将类型参数放在常规参数之前”的方法，但是我们开始了......

编辑：正如 rgettman 指出的那样，类型推断在这里无论如何都会为您做正确的事情，因此在许多情况下您实际上*不需要*指定类型参数。有时你会这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T17:36:04.917

使用`Arrays.asList`，有时需要指定返回类型。Java 尝试根据所有参数的公共超类型“缩小”返回类型，但有时您需要特定类型。例如，

```
List<Number> list = Arrays.asList(1, 2, 3); 
```

在这里，`Arrays.asList`返回 a`List<Integer>`并且你得到一个编译器错误。要让它返回 a `List<Number>`，您必须指定泛型类型。

```
List<Number> list = Arrays.<Number>asList(1, 2, 3); 
```

# node.js - 在 Heroku 上使用 Wkhtmltopdf 和 Nodejs

> ID：15118273
> 
> 赞同：0
> 
> 时间：2013-02-27T17:21:59.690
> 
> 标签：node.js, heroku, wkhtmltopdf

事情就是这样。我在 nodejs 上，我想用 wkhtmltopdf 生成一个 PDF 文件。它在本地运行良好，但是当我将它推到 heroku 上时，出现“应用程序错误”。

我认为这是因为它缺少 Heroku 的二进制 Wkhtmltopdf，你知道吗？或者是别的什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-14T19:41:10.823

Heroku doesn't include the `wkhtmltopdf` binary, but you have two options to get it working there.

First is to [**build `wkhtmltopdf` from source on Heroku**](https://devcenter.heroku.com/articles/buildpack-binaries) (using the [Vulcan gem](https://github.com/heroku/vulcan)).

The second is to directly bundle `wkhtmltopdf` with your app. Read through [this](https://gist.github.com/wrburgess/3778949), [this](http://www.mobalean.com/blog/2011/08/02/pdf-generation-and-heroku) and [this](https://stackoverflow.com/questions/5013955/problem-implementing-wicked-pdf-on-heroku/16577677#16577677) for guidance. Essentially, you have to downloading the binary executable into your app's `/bin` folder, push it to Heroku, and correctly configure `wkhtmltopdf`'s settings from within the app.

P.S. The examples I cited deal with Ruby, but they give a good overview of what needs to be set up for `wkhtmltopdf` to work on Heroku. There is a [sample Rails app](https://github.com/jordan-brough/heroku-pdf) pre-integrated with `wkhtmltopdf` for reference.

# google-chrome-extension - Chrome 扩展中 PageAction、背景页面和 ContentScript 之间的通信

> ID：15118276
> 
> 赞同：0
> 
> 时间：2013-02-27T17:22:16.233
> 
> 标签：google-chrome-extension

据我了解，Page Action 和 Cotent Script 之间无法直接通信，所以我这样做了：

在**page_action.html 中**：

```
chrome.extension.sendRequest(
    {to:"background",key:"color",val:"red"},
    function(response) {
        console.log(response) ;
    }
) ; 
```

在**后台.js**

```
chrome.extension.onRequest.addListener(
    function(request,sender,sendResponse) {
        if (request.to == "background") {
            console.log("Request recieved to Background") ;
            request.to = "content" ;
            chrome.extension.sendRequest(request,function(response) {
                sendResponse(response) ;
            }) ;
        }
    }
) ; 
```

在**content.js中**

```
(function(){
    // ...
    // Do something initial
    // ...
    // Now start to listen
    chrome.extension.onRequest.addListener(
        function(request,sender,sendResponse) {
            if (request.to == "content") {
                // Do something with request.key and request.val
                console.log("Request recieved to Content Script") ;
                sendResponse({status:'from content'}) ;
            }
        }
    ) ;
}()) ; 
```

Page Action 和 Background 之间的通信完美无缺，但 Background 和 Content Script 之间没有任何反应。我在这里想念什么？如何正确沟通？最重要的是，是否有另一种方式可以让通信更直接地从页面操作到内容脚本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T03:28:17.617

幸运的是，有一种方法可以直接在 a`Page Action`和 a之间进行通信`Content Script`，那就是通过[`tabs.sendMessage`](http://developer.chrome.com/extensions/tabs.html#method-sendMessage)方法。

您可以`id`从[`chrome.pageAction.onClicked`](http://developer.chrome.com/extensions/pageAction.html#event-onClicked)一个简单的`chrome.tabs.query`.

获得要向其发送消息的选项卡的 ID 后，只需`Page Action`像这样发送消息：

**page_action.html**

```
chrome.tabs.query({active:true,currentWindow:true},function(tabs){
  chrome.tabs.sendMessage(tabs[0].id,{message:"text"}, function(response){
    //If you need a response, do stuff with it here
  });
}); 
```

**内容.js**

```
chrome.runtime.onMessage.addListener(function(message,sender,sendResponse){
  //Do stuff here
  //sendResponse({message:"stuff"});
}); 
```

在旁注中，`sendRequest`并`onRequest`已被其[`Message`](https://developer.chrome.com/extensions/messaging)同行所取代。

# phantomjs - 为 phantomjs 的每个实例指定不同的缓存目录

> ID：15118292
> 
> 赞同：6
> 
> 时间：2013-02-27T17:22:51.577
> 
> 标签：phantomjs

我正在使用 PhantomJS 1.8 并遇到了限制——您无法指定它用于磁盘缓存的目录。我将此添加到他们的问题跟踪系统中，但由于它以前不存在，我不希望它很快添加。

所以，我正在寻找解决这个限制的方法。我想要做的是运行多个 Phantomjs 进程，每个进程都有自己的、单独的缓存目录。有没有办法在将功能添加到幻像之前做到这一点？

phantom 甚至如何首先确定将哪个目录用于缓存？如果它基于环境变量，也许可以通过某种方式为我运行的每个 PhantomJS 实例为该变量设置不同的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-09T19:53:43.897

至少在 PhantomJS 1.9 下，缓存目录是 $HOME/.qws/cache/Ofi Labs/PhantomJS，所以如果你在运行 PhantomJS 之前修改 HOME 环境变量，你可以为每个进程拥有不同的磁盘缓存。我对此进行了测试，它对我有用。

# c# - 检查用户名是否已存在于数据库中

> ID：15118294
> 
> 赞同：1
> 
> 时间：2013-02-27T17:23:04.947
> 
> 标签：c#, winforms, visual-studio-2012, validation

我正在尝试检查数据库表“用户”以查看“用户名”是否存在，以便无法再次创建相同的用户名。我希望这是一个验证器，所以如果用户名存在，消息框将显示它存在。

请指导我完成此操作，到目前为止，我在按钮后面有以下代码来添加并检查用户名是否存在：

```
private void btnSignupNew_Click(object sender, EventArgs e)
        {

           if (txtUsername.Text == "")
           {
               errorUsername.SetError(txtUsername, "Enter A Username");
           }

           else if (txtPassword.Text == "")
           {
               errorPassword.SetError(txtPassword, "Enter A Valid Password");
           }

               //so if there isnt no error in the fields itll go on and add the data in to the database.
           else{

            //instance of sqlConnection
            SqlConnection con = new SqlConnection("Data Source=etc");

            //instance of sqlCommand
            SqlCommand cmd = new SqlCommand("INSERT INTO [User] values ('" + txtForename.Text + "', '" + txtSurname.Text + "', '" + txtUsername.Text + "', '" + txtPassword.Text + "' )", con);
            con.Open();
            cmd.ExecuteNonQuery();

            //query executed correcty or not
           con.Close(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T17:30:45.993

作为一个好的实践，尽量保持你的持久性使用`Parameters`以避免 SQL 注入。

试试这个：

```
private void btnSignupNew_Click(object sender, EventArgs e)
{

   if (txtUsername.Text == "")
   {
       errorUsername.SetError(txtUsername, "Enter A Username");
   }
   else if (txtPassword.Text == "")
   {
       errorPassword.SetError(txtPassword, "Enter A Valid Password");
   }
   else
   {
        using (SqlConnection con = new SqlConnection("Data Source=etc")) 
        {
            con.Open();

            bool exists = false;

            // create a command to check if the username exists
            using (SqlCommand cmd = new SqlCommand("select count(*) from [User] where UserName = @UserName", con))
            {
                cmd.Parameters.AddWithValue("UserName", txtUsername.Text);
                exists = (int)cmd.ExecuteScalar() > 0;
            }

            // if exists, show a message error
            if (exists)
                errorPassword.SetError(txtUsername, "This username has been using by another user.");
            else 
            {
                            // does not exists, so, persist the user
                using (SqlCommand cmd = new SqlCommand("INSERT INTO [User] values (@Forname, @Surname, @Username, @Password)", con))
                {
                    cmd.Parameters.AddWithValue("Forname", txtForname.Text);
                    cmd.Parameters.AddWithValue("Surname", txtSurname.Text);
                    cmd.Parameters.AddWithValue("UserName", txtUsername.Text);
                    cmd.Parameters.AddWithValue("Password", txtPassword.Text);

                    cmd.ExecuteNonQuery();
                }               
            }

            con.Close();
        }   
    }
} 
```

# symfony - 在与学说 2 的一对一关联中找不到索引

> ID：15118302
> 
> 赞同：0
> 
> 时间：2013-02-27T17:23:27.090
> 
> 标签：symfony, doctrine-orm

我收到此错误：

```
Notice: Undefined index: userTrack in C:\Program Files (x86)\Zend\Apache2\htdocs
\app\vendor\doctrine\orm\lib\Doctrine\ORM\Internal\Hydration\ObjectHydrator.php on line 110 
```

文件.php：

```
/**
 * @ORM\OneToOne(targetEntity="JJ\MainBundle\Entity\UserTrack", mappedBy="file", fetch="EAGER")
 * @JMS\Expose
 */
protected $user_track; 
```

用户跟踪.php：

```
/**
 * @ORM\OneToOne(targetEntity="JJ\MainBundle\Entity\File", inversedBy="user_track", fetch="EAGER")
 */
protected $file; 
```

我可以很好地生成实体。我可以很好地更新我的架构。是什么赋予了？

编辑：

```
public function findRandomByUser(User $user)
{
    $pointer = rand(0, $user->getFiles()->count() - 1);
    $query = $this->getEntityManager()->createQuery("
            SELECT f
            FROM MainBundle:File f
            WHERE f.user = :user
        ")
        ->setMaxResults(1)
        ->setFirstResult($pointer)
        ->setParameters(array(
            'user' => $user->getId()
        ));
    return $query->getSingleResult();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T11:17:20.440

`doctrine:validate-schema`请使用命令验证您的架构（`orm:validate-schema`仅使用 ORM 作为独立时）。

`UnitOfWork`由于验证步骤的性能影响，ORM 在运行时未验证的无效映射、拼写错误和一般错误通常会在内部和内部发生此类问题。

# json - 在 Emacs 中发出 JSON 请求

> ID：15118304
> 
> 赞同：21
> 
> 时间：2013-02-27T17:23:44.917
> 
> 标签：json, emacs, elisp, stackexchange-api

我正处于编写[Emacs 主要模式](https://github.com/vermiculus/sx.el)的早期阶段，用于在 Stack Exchange 网络上浏览和贡献站点，其方式`dired`与`list-packages`工作方式大致相同，并从`magit`和`org-mode`.

问题是，当然，我一开始*不知道*如何将 Emacs 与 SE API (v2.1) 接口。我从来没有在 Elisp 中做过任何涉及网络连接的事情，尽管我对语言本身很满意（并且已经看过很多次了`package.el`）。

我从未使用过 JSON，尽管我正在[学习 W3C 的教程](http://www.w3schools.com/json/default.asp)。

一个简单的“hello world”就足够了，可能类似于

```
(execute-json-query "/info") 
```

W3C 教程似乎也没有处理请求。我将不得不对此进行自己的研究。
我真的不知道我在做什么；我昨天下午才刚刚开始狂热地工作。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-27T18:33:22.187

其他答案的问题是[Stack Exchange API 是 GZIP 的](http://api.stackoverflow.com/1.1/usage/gzip)，并且 Emacs 附带的 url.el 不会自动解压缩它。

看看我的[request.el](http://tkf.github.com/emacs-request/)库，它支持自动解压（老实说，我只是添加了支持）。这是一个获取 stackoverflow 中最活跃问题的示例：

```
(request
 "https://api.stackexchange.com/2.1/questions"
 :params '((order . "desc")
           (sort . "activity")
           (site . "stackoverflow"))
 :parser 'json-read
 :success (function*
           (lambda (&key data &allow-other-keys)
             (let* ((item (elt (assoc-default 'items data) 0))
                    (title (assoc-default 'title item))
                    (tags (assoc-default 'tags item)))
               (message "%s %S" title tags))))) 
```

request.el 有[很好的文档记录](http://tkf.github.com/emacs-request/manual.html)，带有[可执行的示例](http://tkf.github.com/emacs-request/#examples)并且经过了[很好的测试](https://travis-ci.org/tkf/emacs-request)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-27T17:58:46.617

看看[GitHub 上的 REST Client](https://github.com/pashky/restclient.el) - 一个手动探索和测试 HTTP REST Web 服务的工具。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-27T18:22:13.280

这可能不是最好的做事方式，但它似乎对我有用。

```
(defun fetch-json (url)
   (with-current-buffer (url-retrieve-synchronously url)
     ; there's probably a better way of stripping the headers
     (search-forward "\n\n")
     (delete-region (point-min) (point))
     (buffer-string))) 
```

然后使用 url 调用此函数将返回响应的内容，在本例中为 json。我以 reddit api 为例，因为我不确定 Stack Exchange api 是如何工作的。

```
 (fetch-json "http://reddit.com/r/emacs.json") 
```

这里几乎没有包含错误检查，如果 url 没有返回数据，那么这将爆炸。

# twitter-bootstrap - Bootstrap navbar align 想要向右对齐

> ID：15118310
> 
> 赞同：17
> 
> 时间：2013-02-27T17:24:04.080
> 
> 标签：twitter-bootstrap, navbar

我正在尝试将导航栏向右对齐。当我使用 .pull-right 类时，它会将导航栏向右推太多：“脱离网格”。

我究竟做错了什么？

代码：

```
<div class="row">
<div class="span3 top_logo"><img src="images/logo_svart.png" width="177" height="60" alt="BETA Team Performance" /></div>
    <div class="span9">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container">
                    <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"><strong>MENY <i class="icon-chevron-down icon-white"></i></strong>
                    </button>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right">
                            <li class="active"><a href="#">Start</a></li>
                            ...
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-09-27T10:37:42.957

对于使用**Bootstrap v3**到达这里的任何人，只需使用包含`.navbar-right`在列表元素中：

```
<div class="collapse navbar-collapse navbar-ex1-collapse">
    <ul class="nav navbar-nav navbar-right">
      <!-- … -->
    </ul>
</div> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-28T03:24:56.080

出现问题是因为在 bootstrap-responsive.css`margin-right`中设置为 0。

带有基本模型的 Jsfiddle[在浏览器中查看](http://jsfiddle.net/shail/Q4phr/2/show/)

因此，您必须为其提供一些看起来合适的数字，如下所示：

```
.navbar .nav.pull-right {
     float: right;
    margin-right: 98px; /*set margin this way in your custom styesheet*/
  } 
```

创建所需效果的 html 代码可以按以下方式编写：

```
<div class="conatiner">
<div class="row-fluid">
    <div class="span2 top_logo">
        <img width="177" height="60" alt="BETA Team Performance" src="http://placehold.it/177x60">
    </div>
    <div class="span10">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
                    <button data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar"
                    type="button"><strong>MENY <i class="icon-chevron-down icon-white"></i></strong>

                    </button>
                    <!-- Everything you want hidden at 940px or less, place within here -->
                    <div class="nav-collapse collapse ">
                        <!-- .nav, .navbar-search, .navbar-form, etc -->
                        <ul class="nav pull-right">
                            <li class="active"><a href="#">Home</a>
                            </li>
                            <li><a href="#">Link</a>
                            </li>
                            <li><a href="#">Link</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
      </div>
    </div>
  </div> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-27T17:25:59.523

尝试将您的`pull-right`课程放在`div.collapse`. 这可能会奏效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-06-03T10:00:23.043

在 Boostrap 4 中，您可以使用`ml-auto`右对齐菜单：

```
<div class="navbar-nav ml-auto"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-30T14:49:50.490

如果您*确实*想将某些东西一直拉到网格外的右侧（例如选择语言或社交按钮），您可以创建一个简单的类并`<ul class="nav navbar-nav language">`像这样添加和设置样式`.language {right:50px;position:absolute;}`。将`.navbar-brand`用作您最左侧的徽标非常有效（无论如何，从艺术总监的角度来看）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-15T16:44:51.493

这对我有用。放入不起作用 - 它必须在无序列表类中`pull-right`。`div.collapse`

```
<div class="nav-collapse collapse navbar-responsive-collapse">

 <ul class="nav navbar-nav pull-right"> 
```

# python - N sys.argv[1:] args 与可选 args XOR 1 argparse arg，与 1 个可选 arg？

> ID：15118315
> 
> 赞同：1
> 
> 时间：2013-02-27T17:24:20.843
> 
> 标签：python, command-line-arguments, argparse

如果`--mac` `argparse`设置了参数，我想禁止通过`sys.argv`. 这可能吗？

我正在编写的脚本应该能够接受`N` `sys.argv[1:]`参数，或者（XOR）一个带有位置参数的单个`--mac`参数，用于查询 MAC 地址。

目前，`N` `sys.argv[1:]`正在传递以构造要发送到 REST API 的查询字符串。

**我希望能够做到这一点：**

```
if args.mac is not None: do_MAC_operation()
else do_BizBar() 
```

**到目前为止我所拥有的：**

```
parser = argparse.ArgumentParser() parser.add_argument("-v" "--verbose", action="store_true", help="verbose output")
group = parser.add_mutually_exclusive_group(required=True) 
group.add_argument("-m", "--mac", action="store_const", const="mac_address" help="search by MAC address") 
args = parser.parse_args() 
```

## 有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:00:19.417

您需要进行一些后期处理，因为直到运行时您才会知道允许多少位置参数。

```
p = ArgumentParser()
p.add_argument("-m", "--mac", action="store_const", const="mac_address")
p.add_argument("addresses", nargs="*")

args = p.parse_args()

if args.mac is not None and len(args.addresses) > 1:
    p.error("Only one argument allowed in conjunction with --mac") 
```

另一种选择是为互斥组创建两个选项，而不是使用位置参数。一个将采用单个参数，另一个可以采用任意数字。

```
p = argparse.ArgumentParser()
g = p.add_mutually_exclusive_group(required=True) 
g.add_argument("-m", "--mac", dest="addresses")
g.add_argument("--nonmac", nargs="*", dest="addresses")
args = parser.parse_args() 
```

在这里，我让参数处理器处理 mac-vs-nonmac 问题。解析参数后，您将无法判断`args.addresses`长度为 1 的 a 是否来自`--mac`or `--nonmac`。

# knockout.js - 无法解析 optionsText 的绑定

> ID：15118317
> 
> 赞同：0
> 
> 时间：2013-02-27T17:24:26.300
> 
> 标签：knockout.js

我不确定为什么会收到此错误：

> 未捕获的错误：无法解析绑定。消息：ReferenceError：数据未定义；绑定值：options: dateOptionsArray,optionsText: data,value: data knockout-2.2.1.debug.js:1936 ko.utils.extend.parseBindingsString

对于这个模型：

```
function ViewModel(jsonModel) {

    var self = this;
    self.dateOptionsArray = ["YYYY-MM-DD", "YYYY-MM-DD HH:MM"]; //todo make this dynamic 
```

在这个 html 中：

```
 <select id="f" data-bind="options: dateOptionsArray,optionsText: data,value: data"></select> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:35:51.870

首先，您需要有一个`data`按顺序命名的属性来`value`绑定工作：

```
function ViewModel(jsonModel) {

    var self = this;
    self.dateOptionsArray = ["YYYY-MM-DD", "YYYY-MM-DD HH:MM"];
    self.data = ko.observable();

}; 
```

二是不需要`optionsText`。只有当数组中有复杂对象并且想要指定 KO 应该将哪个属性用于选择文本时，才需要它。另请参阅[文档](http://knockoutjs.com/documentation/options-binding.html)：

```
<select id="f" data-bind="options: dateOptionsArray, value: data"></select> 
```

演示[JSFiddle](http://jsfiddle.net/mv4G9/)

# .htaccess - 需要 htaccess 重写以删除 id 部分

> ID：15118319
> 
> 赞同：0
> 
> 时间：2013-02-27T17:24:26.247
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, directory

我正在寻找没有“#-”的相同 url 的重写规则。# 是文章 ID，因此它随每篇特定文章而变化。类别名称也会发生变化。

```
www.site.com/foldername/categoryname/45-article<br>
www.site.com/foldername/categoryname/334-article<br>
www.site.com/foldername/anothercategoryname/634-article 
```

我用了...

```
RewriteEngine On<br>
RewriteRule ^(.*)/[\d]*-(.*)$ /$1/$2 [R=301,L] 
```

这适用于所有文件夹名称及其类别，但我的问题是我需要它**仅适用**于某些文件夹名称和该文件夹名称中的每个类别。所以我希望有一个与我使用的规则相似的规则，但我指定了特定的文件夹名称。感谢您在此问题上提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:30:21.953

只需匹配文件夹名称即可。您不提供任何内容，我会说您只想匹配文件夹 foo、bar 和 baz：

```
RewriteRule ^(foo|bar|baz)/([^\/]+)/[\d]+-(.+)$ /$1/$2/$3 [R=301,L]
                  ^^^        ^^^    ^^^^^^
                   1          2        3 
```

你在这里：

1.  首先匹配您要匹配的文件夹子集
2.  然后你匹配这些文件夹中的任何类别
3.  然后你删除数字

次要的挑剔：当您*知道*您的表达式将匹配字符（例如，在您的文章名称中的破折号之后）时，最好`.+`使用`.*`. 后者将匹配零个字符，我的猜测是这不是一个有效的用例，所以最好不要允许它。

# jquery - 使用 CSS 更改选定的链接颜色？

> ID：15118325
> 
> 赞同：4
> 
> 时间：2013-02-27T17:24:50.240
> 
> 标签：jquery, html, css

我为一组对象定义了一个类（item1）。

是否可以将我单击/选择的对象（来自类）设置为红色文本并将所有其他对象（来自类）设置为黑色文本颜色？

这是我应用类（item1）的代码：

```
 <td>
            <a class="item1" href="/menu2" onclick="">
            Menu1
            </a>
        </td>

        <td>
            <a class="item1" href="/menu2" onclick="">
            Menu2
            </a>
        </td> 
```

如何在 css 文件中执行此操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T17:29:34.510

> 是否可以为我单击/选择的对象（来自类）设置红色文本颜色

好的，您使用的一些术语需要澄清一下：

*   在 css 中单击时称为`:active`
*   在 css 中悬停时被称为 `:hover`
*   `:visited`在谈论`a`标签时调用css后单击。

如果您的意思是实际将链接设置为“活动”状态，则`:visited`选择器可能会出现这种情况的“症状”，但这绝不是这样做的方法。

真正做到这一点的方法是向元素物理添加一个类，将其识别为活动的，即`<a class="active">`相应地设置特定类的样式（通常使用少量 javascript 完成）

**那么，使用 javascript 如何添加/删除该类？**

使用 javascript，您可以监听点击事件。每次单击某些内容时，您都执行以下操作：

1.  从当前包含它的任何元素中删除现有`active`类。
2.  将其添加到被单击的项目。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-27T18:02:48.210

这是[小提琴](http://jsfiddle.net/mzY2j/)！

这是代码：

**HTML**

```
<td>
            <a class="item1" href="#">
            Menu1
            </a>
        </td>

        <td>
            <a class="item1" href="#">
            Menu2
            </a>
        </td> 
```

**JS**

```
$('.item1').click(function(e){
    $('.item1').css("color", "black");
    $(this).css("color", "red");
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-27T17:25:58.000

您可能正在寻找`:visited`

```
a:visited {

color:red;

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-27T17:56:53.753

如果您使用 ajax，或在另一个框架中加载您的内容，最好使用 javascript (jquery)：

```
$('a').each(function(){
   $(this).click(function(){
      $('a').removeClass('selected');
      $(this).addClass('selected');
   })
}); 
```

以你的风格：

```
a, a:hover, a:visited, a:active{
   color:black;
}
a.selected{
   color: red;
} 
```

# objective-c - 如何使用 NSMutableAttributedString 渲染多行 UILabel

> ID：15118329
> 
> 赞同：13
> 
> 时间：2013-02-27T17:25:07.387
> 
> 标签：objective-c, ios6, uilabel, multiline, nsattributedstring

我正在尝试使用 NSMutableAttributedString 创建多行 UILabel。当我将属性分配给这样的完整字符串时，这很好用：

```
UILabel *contentLabel = [[UILabel alloc] initWithFrame:CGRectMake(0,0,200,100)];
[contentLabel setLineBreakMode:NSLineBreakByWordWrapping];
[contentLabel setNumberOfLines:0];
[contentLabel setFont:[UIFont systemFontOfSize:13];

NSMutableAttributedString *string = [[NSMutableAttributedString alloc] initWithString:@"hello I am a long sentence that should break over multiple lines"];
[string addAttribute:NSFontAttributeName value:[UIFont boldSystemFontOfSize:13] range:NSMakeRange(0, [string length])];

contentLabel.attributedText = string; 
```

但我需要的是为 NSAttributedString 的不同子范围应用一些属性（以加粗某些单词）。

```
UILabel *contentLabel = [[UILabel alloc] initWithFrame:CGRectMake(0,0,200,100)];
[contentLabel setLineBreakMode:NSLineBreakByWordWrapping];
[contentLabel setNumberOfLines:0];
[contentLabel setFont:[UIFont systemFontOfSize:13];

NSMutableAttributedString *string = [[NSMutableAttributedString alloc] initWithString:@"hello I am a long sentence that should break over multiple lines"];
[string addAttribute:NSFontAttributeName value:[UIFont boldSystemFontOfSize:13] range:NSMakeRange(3, 5)];

contentLabel.attributedText = string; 
```

我发现如果我这样做，文本将不再呈现在标签中的多行上。它呈现为单行，在标签的框架中垂直居中。

我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-07T21:08:29.037

正如问题评论中所讨论的，问题中提供的代码实际上可以正常工作，并且确实按预期呈现了属性字符串。（问题出在我代码的其他地方）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-14T07:23:53.750

我经常使用 UITextView 并为它分配一个以类似方式属性的文本：

```
 // creiamo textView descrizione
    UITextView *description = [[UITextView alloc] init];
    description.frame = CGRectMake(20, 453, 500, 190);

    NSDictionary *attribute1 = @{NSForegroundColorAttributeName: [UIColor blackColor],
                                     NSBackgroundColorAttributeName: [UIColor clearColor],
                                     NSFontAttributeName: [UIFont fontWithName:@"HelveticaNeue-Bold" size:22.0],
                                     };

    NSDictionary *attribute2 = @{NSForegroundColorAttributeName: [UIColor blackColor],
                                        NSBackgroundColorAttributeName: [UIColor clearColor],
                                        NSFontAttributeName: [UIFont fontWithName:@"HelveticaNeue" size:10],
                                        };

    NSDictionary *attribute3 = @{NSForegroundColorAttributeName: [UIColor blackColor],
                                           NSBackgroundColorAttributeName: [UIColor clearColor],
                                           NSFontAttributeName: [UIFont fontWithName:@"HelveticaNeue" size:14.0]
                                           };

    NSMutableAttributedString *info = [[NSMutableAttributedString alloc] initWithString:[NSString stringWithFormat:@"%@ %@ %@ \n\n%@ \n     ", string1, string2 , string3, string4]];

    [info setAttributes:attribute1 range:NSMakeRange(0, ([string1 length]))];
    [info setAttributes:attribute2 range:NSMakeRange(([string1 length]),([string2 length]+[string3 length]))];
    [info setAttributes:attribute3 range:NSMakeRange(([string1 length] [string2 length]+[string3 length]), [string4 length])];

    description.attributedText = info;
    description.backgroundColor = [UIColor clearColor];
    description.editable = NO;
    description.textColor = [UIColor blackColor];
    [viewInfo addSubview:description];
    [description sizeToFit]; 
```

# c - C中的类型转换指针

> ID：15118330
> 
> 赞同：1
> 
> 时间：2013-02-27T17:25:13.887
> 
> 标签：c, pointers

我正在阅读 C 代码，想知道我是否正确理解了代码。

头文件中定义了一个结构体BF_salt，如下图所示：

```
typedef
{
BF_WORD salt[4];
..
..
} BF_SALT; 
```

在主 C 代码中，有一个函数调用：

```
function func1()
{
 static BF_SALT salt;
 func2(salt.salt,x,y);
....
}

func2(BF_WORD * dst,x,y)
{
 unsigned char * dptr= (unsigned char*)dst;
 int c1,c2;

 // c1 and c2 are initialized here.

 // in a loop, an operation similar to the below is performed.

 *dptr++ = (c1 << 2) | ((c2 & 0x30) >> 4);
} 
```

我对上面代码的理解是：

在 func1 中，盐是用结构 BF_SALT 的数据类型定义的。

我们正在调用 func2，传递结构的盐域。

salt 字段是一个包含 4 个元素的数组，每个元素的数据类型为 BF_WORD（32 位字或 4 个字节）

在 func2 中

dst 是指向 BF_WORD 类型元素的数组的名称。

它正在对指针 dst 执行类型转换。

目前，dst 指向数据类型 BF_WORD。它是类型转换的，因此它指向一个 char（1 字节数据）。

现在它正在对整数 c1 和 c2 执行位移操作，并将输出写入 dptr 指向的内存地址。因此，它正在覆盖最初由 dst 指向的数据（盐数组中的字节）。

c1 和 c2 的数据类型为 int，需要 4 个字节的空间。

dptr 会以什么方式覆盖数组的内容？因为每次我们执行 *dptr++，我们都将指针 dptr 前进 1 个字节，因为它指向一个字符。

但是，我们为它分配了一个大于 1 字节的值。数据将如何写入内存？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:15:45.097

只有结果的最低字节将被写入内存。由于指针指向 char，因此 int 将被截断，并且在转换为左值的类型时会丢失更高的字节；就像您只是将结果分配给 char 变量一样。有关详细信息，请参阅标准部分 6.3.2.1 和 6.5.16.1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:07:18.440

这里

```
*dptr++ = (c1 << 2) | ((c2 & 0x30) >> 4); 
```

执行隐式强制转换`unsigned char`，`dptr`与 type一样`unsigned char *`，因此`*dptr`被视为`unsigned char`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:06:47.643

你对上面代码的理解，和我的很像，也让我插播一些自己的想法。

```
unsigned char * dptr= (unsigned char*)dst; 
```

这里 dst 是 BF_WORD 类型（4 个字节），被向下转换为 char 类型（1 个字节）另外值得注意的是，虽然指针的类型是 char ，并且一次可以导航一个字节，但它确实成立一个 4 字节连续内存位置的地址，因此从技术上讲，它必须能够导航这 4 个字节，一次一个字节。

> dptr 会以什么方式覆盖数组的内容？

dptr 现在包含 4 个数字、4 字节数组 salt 的起始地址。所以它当前访问的是 salt[0]。这里 salt[0] 的大小是 4 字节，而 dptr 是 1 字节的指针，因此需要四个 (dptr++) 增量来覆盖数组 salt[0] 的一个元素。

现在另一个问题

> 我们为它分配了一个大于 1 字节的值。数据将如何写入内存？

```
*dptr++ = (c1 << 2) | ((c2 & 0x30) >> 4); 
```

这里 c1 和 c2 都是 int 类型，所以在按位运算之后，结果是 int 类型。因此 4 字节的结果被写入 dptr 指向的 salt[0]；在 dptr 的下一个增量中，指针将指向前一个 4 字节 result 的 2 字节，因此前一个结果的最后三个字节将被下一个按位结果溢出。

# c# - 有人可以在这些示例中解释 & 运算符吗？

> ID：15118332
> 
> 赞同：1
> 
> 时间：2013-02-27T17:25:23.420
> 
> 标签：c#, operators, bitwise-operators

我不明白这段代码发生了什么：

```
if ((_value & item.Value) == item.Value)
{
   item.IsSet = true;
} 
```

在我正在查看的这个特定示例中，我看到以下内容：

如果`_value`是 4103 但`item.Value`为 0，则为真。

如果`_value`是 4103 但`item.Value`为 1，则为真。

如果`_value`是 4103 但`item.Value`为 2，则为真。

如果`_value`是 4103 但`item.Value`为 4，则为真。

如果`_value`是 4103 但`item.Value`为 8，则不正确。

如果`_value`是 4103 但是`item.Value`16，则不正确。

如果`_value`是 4103 但是`item.Value`256，则不正确。

如果`_value`是 4103 但是`item.Value`512，则不正确。

如果`_value`是 4103 但是`item.Value`1024，则不正确。

如果`_value`是 4103 但是`item.Value`2048 则不正确。

如果`_value`是 4103 但是`item.Value`4096，这是真的。

在另一个示例中，我看到以下内容：

如果`_value`为 51 但`item.Value`为 0，则为真。

如果`_value`为 51 但`item.Value`为 1，则为真。

如果`_value`是 51 但`item.Value`为 2，则为真。

如果`_value`是 51 但是`item.Value`4，则不正确。

如果`_value`是 51 但是`item.Value`8，那不是真的。

如果`_value`是 51 但是`item.Value`16，这是真的。

如果`_value`是 51 但是`item.Value`32，这是真的。

有人可以向我解释一下吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:29:00.480

按位与，所以从你的例子中：

```
(_value & item.Value) == item.Value

_value = 4103 = 1000000000111 binary
_item.Value = 0  = 0 binary

  1000000000111
& 0000000000000
---------------
  0000000000000

_value = 4103 = 1000000000111 binary
_item.Value = 4096  = 1000000000000 binary

  1000000000111
& 1000000000000
---------------
  1000000000000 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T17:35:42.333

用二进制重写数字，让我们跳过零的情况：

```
if _value is 00110011 and item.Value is 00000001, it's true.
if _value is 00110011 and item.Value is 00000010, it's true.
if _value is 00110011 and item.Value is 00000100, it's false.
if _value is 00110011 and item.Value is 00001000, it's false.
if _value is 00110011 and item.Value is 00010000, it's true.
if _value is 00110011 and item.Value is 00100000, it's true.
if _value is 00110011 and item.Value is 01000000, it's false.
if _value is 00110011 and item.Value is 10000000, it's false. 
```

你看到图案了吗？对应位为 1 时为真，为 0 时为假。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:30:41.033

来自**[MSDN](http://msdn.microsoft.com/en-us/library/sbf85k1c%28v=vs.71%29.aspx)**；

该`&`运算符可以用作一*元*或*二元*运算符。

对于`integral`类型，`&`计算`bitwise AND`其操作数的。

对于`bool`操作数，`&`计算`logical AND`其操作数的 也就是说，结果是`true`当且仅当它的两个操作数都是`true`。

因此，当您编写 时`4103`，它实际上等于二进制`1000000000111`。您可以像这样找到整数值的*二进制*表示；

```
int i = 4103;
Console.WriteLine (Convert.ToString(i, 2)); // 1000000000111 
```

该情况的其余过程是用[真值表](http://en.wikipedia.org/wiki/Truth_table)进行简单计算。

```
 INPUT         OUTPUT
 A   B          A ∧ B
 T   T          T
 T   F          F
 F   T          F
 F   F          F 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T17:31:13.810

它是按位与运算符。本质上，当您对整数 X 和 Y 进行按位与运算，然后将结果与 Y 进行比较时，您可以确保 X 在 Y 中设置为 1 的所有位也设置为 1。X 也可能有一些其他位设置为 1，但是那些我们不关心的。这是关于运营商的 MSDN 文章：

[http://msdn.microsoft.com/en-us/library/sbf85k1c(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/sbf85k1c(v=vs.71).aspx)

# java - 关于并发hashmap的内部工作

> ID：15118333
> 
> 赞同：4
> 
> 时间：2013-02-27T17:25:24.750
> 
> 标签：java, map, concurrenthashmap

我正在阅读`ConcurrentHashMap`和[这个相关的教程](http://javarevisited.blogspot.in/2013/02/concurrenthashmap-in-java-example-tutorial-working.html)，并且有一些问题。

1.  在文章中，提到了`ConcurrentHashMap`允许多个阅读器同时阅读而没有任何阻塞。这是通过根据并发级别将 Map 划分为不同的部分并在更新期间仅锁定 Map 的一部分来实现的。默认并发级别为 16，因此 Map 分为 16 个部分，每个部分由不同的锁管理。这意味着，16 个线程可以同时对 Map 进行操作，直到它们对 Map 的不同部分进行操作。尽管`ConcurrentHashMap`保持线程安全完好无损，但这仍然具有高性能。不过，它有一个警告：**由于更新操作，如`put()`，`remove()`，`putAll()`或`clear()`不同步，并发检索可能不会反映 Map 上的最新更改**

2.  文章中还提到了另一点：**另一个要记住的重要一点是 CHM 上的迭代，返回的迭代器`keySet`是弱一致的，它们只反映`ConcurrentHashMap`某一点的状态，可能不反映任何最近的变化**。

我没有理解以粗体突出显示的要点，您能否提供更多信息或在一个简单的程序中向我展示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:49:44.013

1.  > 由于 put()、remove()、putAll() 或 clear() 等更新操作不同步，并发检索可能无法反映 Map 上的最新更改

    据我了解，这意味着在一个线程中对地图的修改可能不一定会在另一个线程中同时发生的检索中看到。考虑以下示例：

    ```
     Thread 1 starts              Thread 1's call to get("a")
                     a call to get("a")             completes, returning null
                             |                                 |
    Thread 1        ---------+---------------------------------+-------
                                 time ----->
    Thread 2        -----+---------------------------+-----------------
                         |                           |
                 Thread 2 starts a            Thread 2's call to
                call to put("a", 1)          put("a", 1) completes 
    ```

    即使线程 2`put`在映射线程 1`get`完成执行中的值，线程 1 也没有“看到”映射修改，并返回了`null`.

2.  > 另一个需要记住的重点是 CHM 上的迭代，ConcurrentHashMap 的 keySet 返回的迭代器是每周一致的，它们只反映 ConcurrentHashMap 的状态和某个点，可能不会反映任何最近的变化。

    这是一个类似的情况。如果线程 1`Iterator`从 a`ConcurrentHashMap`获得an `keySet`，然后线程 2 将新条目放入映射中，`Iterator`则线程 1 不能保证看到该条目。（它可能会或可能不会。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:34:51.900

这里真正的问题是，当多个线程在使用数据结构时，线程不一定会步调一致。

一个线程正在为 user1 读取。一个线程正在为 user2 编写。两个线程都无法预测另一个线程在各自进程中的位置。此外，我们无法为用户预测这两个过程完成时的任何排序。如果写入首先更新数据，则读取将显示更新的状态，即使 user1 可能早一点请求读取。

迭代时的读取或修改工作方式相同，另外考虑到移动到下一个（迭代时）的过程本质上变成了对 Map 状态的“读取”操作，如果不是其中任何特定数据的内容的话.

因此，当您在这些数据结构中允许并发时，您最终会在时间上进行“足够接近”的测试。（这很像数据库的相同考虑，除了我们习惯于以这种方式考虑数据库并且时间框架是 10 个不同的几个因素。

注意：要对@Matts 在另一个答案中显示的精彩小时间线发表评论...

时间线显示两个线程以及每个线程的开始和停止。两个线程的开始可以按 (a,b) 或 (b,a) 顺序发生。结束可以按任意顺序发生，因为您无法判断操作需要多长时间。这给出了两个线程可以开始和结束的 4 种方式。（a 先开始然后结束，a 先开始，b 先结束，b 先开始，a 先结束，b 先开始，b 先结束）现在......想象一下 20 个线程都在做同样的事情来响应，比如说， 20 个最终用户为此和那个提交请求。它有多少种可能的方法。

# codeigniter - AWS SES 和 PHP - 发送限制？

> ID：15118343
> 
> 赞同：1
> 
> 时间：2013-02-27T17:25:59.290
> 
> 标签：codeigniter, amazon-web-services, amazon-ses

我正在尝试通过 Codeigniter 电子邮件功能发送电子邮件，并且我正在使用我的 aws ses 凭据。发件人地址已经过验证，但仍然会引发以下错误。我不在生产包上。我的最大发送速率是每秒 1 个。经过验证的电子邮件可以在前几次发送电子邮件（发送大约 10 封电子邮件），之后我收到以下错误。我已经在不同的日子里尝试过，只是为了看看发送率是否会得到纠正，但错误仍然存​​在。

```
"email":"220 email-smtp.amazonaws.com ESMTP SimpleEmailService-123456789\r\n<br \/><pre>hello: 250-email-smtp.amazonaws.com\r\n250-8BITMIME\r\n250-SIZE 10485760\r\n250-AUTH PLAIN LOGIN\r\n250 Ok\r\n<\/pre><pre>from: 250 Ok\r\n<\/pre><pre>to: 250 Ok\r\n<\/pre><pre>data: 354 End data with <CR><LF>.<CR><LF>\r\n<\/pre>554 Message rejected: Email address is not verified.\r\n<br \/>The following SMTP error was encountered: 554 Message rejected: Email address is not verified.\r\n<br \/>Unable to send email using PHP SMTP.  Your server might not be configured to send mail using this method.<br \/><pre>User-Agent: CodeIgniter\r\nDate: Wed, 27 Feb 2013 18:22:30 +0100\r\nFrom: \"Us\" <verified from address>\r\nReturn-Path: <verified from address>\r\nTo: test@gmail.com\r\nSubject: =?utf-8?Q?Notification?=\r\nReply-To: \"verified from address\" <verified from address>\r\nX-Sender: verified from address\r\nX-Mailer: CodeIgniter\r\nX-Priority: 3 (Normal)\r\nMessage-ID: <512e40d65c149@domain.com>\r\nMime-Version: 1.0\r\n\n\nContent-Type: text\/plain; charset=utf-8\r\nContent-Transfer-Encoding: 8bit\r\n\r\nHello Sara\r\n\r\nPlease find the url below:\r\n\r\n http:\/\/192.168.0.36\/verify_agent\/10\/406387e745014f3b4f856\r\n\r\n\r\nThank you,\r\nFrom person\r\n<\/pre>" 
```

任何帮助表示赞赏。

谢谢。

# python - 使用多处理运行子进程时出现系统错误

> ID：15118344
> 
> 赞同：8
> 
> 时间：2013-02-27T17:26:01.170
> 
> 标签：python, numpy, multiprocessing

我在使用 Multiprocessing 包（Amazon EC2 上的 Ubuntu 12.04 上的 python 2.73 和 numpy 1.7.0）并行执行一些简单的基于 numpy 的矩阵代数计算时遇到系统错误（如下所示）。我的代码适用于较小的矩阵大小，但对于较大的矩阵会崩溃（有足够的可用内存）

我使用的矩阵的大小很大（我的代码对于 1000000x10 浮点密集矩阵运行良好，但对于 1000000x500 的矩阵崩溃 - 我顺便将这些矩阵传递给子进程/从子进程传递）。10 vs 500 是一个运行时参数，其他一切都保持不变（输入数据、其他运行时参数等）

我还尝试使用 python3 运行相同的（移植的）代码——对于更大的矩阵，子进程进入睡眠/空闲模式（而不是像 python 2.7 那样崩溃）并且程序/子进程只是挂在那里什么都不做。对于较小的矩阵，代码在 python3 中运行良好。

任何建议将不胜感激（我在这里没有想法了）

错误信息：

```
Exception in thread Thread-5: Traceback (most recent call last):  
File "/usr/lib/python2.7/threading.py", line 551, in __bootstrap_inner
    self.run()   File "/usr/lib/python2.7/threading.py", line 504, in run
    self.__target(*self.__args, **self.__kwargs)   File "/usr/lib/python2.7/multiprocessing/pool.py", line 319, in _handle_tasks
    put(task) SystemError: NULL result without error in PyObject_Call 
```

我使用的多处理代码：

```
def runProcessesInParallelAndReturn(proc, listOfInputs, nParallelProcesses):
    if len(listOfInputs) == 0:
        return
    # Add result queue to the list of argument tuples.
    resultQueue = mp.Manager().Queue()
    listOfInputsNew = [(argumentTuple, resultQueue) for argumentTuple in listOfInputs]
    # Create and initialize the pool of workers.
    pool = mp.Pool(processes = nParallelProcesses)
    pool.map(proc, listOfInputsNew)
    # Run the processes.
    pool.close()
    pool.join()
    # Return the results.
    return [resultQueue.get() for i in range(len(listOfInputs))] 
```

下面是为每个子进程执行的“proc”。基本上，它使用 numpy 求解许多线性方程组（它在子过程中构造所需的矩阵）并将结果作为另一个矩阵返回。再一次，它适用于一个运行时参数的较小值，但对于较大的参数会崩溃（或在 python3 中挂起）。

```
def solveForLFV(param):
    startTime = time.time()
    (chunkI, LFVin, XY, sumLFVinOuterProductLFVallPlusPenaltyTerm, indexByIndexPurch, outerProductChunkSize, confWeight), queue = param
    LFoutChunkSize = XY.shape[0]
    nLFdim = LFVin.shape[1]
    sumLFVinOuterProductLFVpurch = np.zeros((nLFdim, nLFdim))
    LFVoutChunk = np.zeros((LFoutChunkSize, nLFdim))
    for LFVoutIndex in xrange(LFoutChunkSize):
        LFVInIndexListPurch = indexByIndexPurch[LFVoutIndex]
        sumLFVinOuterProductLFVpurch[:, :] = 0.
        LFVInIndexChunkLow, LFVInIndexChunkHigh = getChunkBoundaries(len(LFVInIndexListPurch), outerProductChunkSize)
        for LFVInIndexChunkI in xrange(len(LFVInIndexChunkLow)):
            LFVinSlice = LFVin[LFVInIndexListPurch[LFVInIndexChunkLow[LFVInIndexChunkI] : LFVInIndexChunkHigh[LFVInIndexChunkI]], :]
            sumLFVinOuterProductLFVpurch += sum(LFVinSlice[:, :, np.newaxis] * LFVinSlice[:, np.newaxis, :])
        LFVoutChunk[LFVoutIndex, :] = np.linalg.solve(confWeight * sumLFVinOuterProductLFVpurch + sumLFVinOuterProductLFVallPlusPenaltyTerm, XY[LFVoutIndex, :])
    queue.put((chunkI, LFVoutChunk))
    print 'solveForLFV: ', time.time() - startTime, 'sec'
    sys.stdout.flush() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T23:40:52.883

500,000,000 相当大：如果您使用的是 float64，那就是 40 亿字节，或大约 4 GB。（10,000,000 浮点数组将是 8000 万字节，或大约 80 MB - 小得多。）我预计问题与多处理有关，试图拾取数组以通过管道发送到子进程。

由于您在 unix 平台上，您可以通过利用`fork()`（用于创建多处理工作人员）的内存继承行为来避免这种行为。正如评论所描述的，我在这个 hack（从[这个项目中删除）取得了巨大的成功。](https://github.com/dougalsutherland/py-sdm/blob/master/mp_utils.py)

```
### A helper for letting the forked processes use data without pickling.
_data_name_cands = (
    '_data_' + ''.join(random.sample(string.ascii_lowercase, 10))
    for _ in itertools.count())
class ForkedData(object):
    '''
    Class used to pass data to child processes in multiprocessing without
    really pickling/unpickling it. Only works on POSIX.

    Intended use:
        - The master process makes the data somehow, and does e.g.
            data = ForkedData(the_value)
        - The master makes sure to keep a reference to the ForkedData object
          until the children are all done with it, since the global reference
          is deleted to avoid memory leaks when the ForkedData object dies.
        - Master process constructs a multiprocessing.Pool *after*
          the ForkedData construction, so that the forked processes
          inherit the new global.
        - Master calls e.g. pool.map with data as an argument.
        - Child gets the real value through data.value, and uses it read-only.
    '''
    # TODO: does data really need to be used read-only? don't think so...
    # TODO: more flexible garbage collection options
    def __init__(self, val):
        g = globals()
        self.name = next(n for n in _data_name_cands if n not in g)
        g[self.name] = val
        self.master_pid = os.getpid()

    @property
    def value(self):
        return globals()[self.name]

    def __del__(self):
        if os.getpid() == self.master_pid:
            del globals()[self.name] 
```

# pdf - 检测字体是否嵌入在pdf中

> ID：15118346
> 
> 赞同：1
> 
> 时间：2013-02-27T17:26:03.983
> 
> 标签：pdf, itext, embedded-fonts

我们要求我们的 PDF 嵌入我们的字体。在解决了嵌入它们的问题后，我想在我们的单元测试中添加一个检查。我们在 java 中，我们主要使用`itext`.，但我们总是可以为这个测试使用不同的库。

# jquery - 如何使用 jQuery 查找具有特定文本的元素？

> ID：15118353
> 
> 赞同：0
> 
> 时间：2013-02-27T17:26:28.557
> 
> 标签：jquery, fullcalendar, contains, replace

我有一张像日历一样显示月份的表格。每个单元格中都有一个*div.fc-day-number*，其中包含数字日期，例如 1、2、3、4 等到 31。每个单元格还有一个初始空白的*div.fc-day-content*，其中事件可以附加数据。我正在使用 FullCalendar jQuery 脚本，因此类名中的所有“fc-”前缀。

在这个日历中应该是指向即将发生的事件的链接。我有一个脚本可以遍历每个事件，将其放置在日历中的正确日期。它遍历每个表格单元格并将单元格的文本与事件日期匹配。*在event.date*中找到事件的日期。

现在我有这个：

```
var table_cell = $jaer("table.fc-border-separate").find("div.fc-day-number:contains("+event.day+")").siblings("div.fc-day-content");'; 
```

问题是*:contains*选择器不够具体。3 月 3 日的事件也将出现在 13、23、30 和 31 日（基本上是任何带有“3”的日期）。

如何编写 table_cell 的代码以获得*event.day*的完全匹配？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:28:55.353

您可以尝试使用过滤器，只返回完全匹配的单元格......

```
var table_cell = $jaer("table.fc-border-separate").find("div.fc-day-number").filter(function() {
    return $(this).text() == event.day;
}).siblings("div.fc-day-content");'; 
```

# java - 如何从弹出框上的复选框列表中获取值以使用父页面？

> ID：15118355
> 
> 赞同：0
> 
> 时间：2013-02-27T17:26:31.723
> 
> 标签：java, javascript, checkbox, popup, struts

我开发 java struts 框架。我想要这样，当我从弹出页面上的复选框列表中选择一些值时，从选择复选框列表的所有值中获取在父页面上使用的所有值。我的目的是在弹出页面上获取人名并在父页面上使用此值填充列表

我可以打开弹出窗口并用值填充复选框列表（弹出窗口），但接下来不知道？

感谢回复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:54:14.323

这是一个常见的 javascript 功能。请检查链接[此链接提供了将值从子弹出窗口传递到父页面的通用步骤。](http://hspinfo.wordpress.com/2008/01/17/javascript-send-pass-value-of-child-window-to-parent-window/)

# ruby-on-rails - Rails / Jquery 最佳实践

> ID：15118360
> 
> 赞同：0
> 
> 时间：2013-02-27T17:26:46.813
> 
> 标签：ruby-on-rails, forms, associations

我正在Rails 中建立一个食物食谱数据库，并且我正在尝试建立一个方便的表单来使用Jquery 添加成分。

我的联想：

```
class Recipe < ActiveRecord::Base
  has_many :recipe_ingredients
  has_many :ingredients, :through => :recipe_ingredients

  accepts_nested_attributes_for :recipe_ingredients
end

class Ingredient < ActiveRecord::Base
end

class RecipeIngredient < ActiveRecord::Base
  belongs_to :recipe
  belongs_to :ingredient
end 
```

我的食谱表格看起来像这样（简化）：

```
<%= simple_form_form(@recipe) do |f| %>
  <div class="form-inputs">
    <%= f.input :name %>
    <fieldset><legend>Ingredients</legend>
      <table class="table">
        <% @recipe.recipe_ingredients.each do |recipe_ingredient| %>
          <tr>
            <%= f.fields_for :recipe_ingredients, recipe_ingredient do |dif| %>
              <td><%= dif.text_field :ingredient %></td>
              <td><%= dif.text_field :amount %></td>
            <% end %>
          </tr>
        <% end %>
      </table>
      <div class="btn-group">
        <a href="#" class="btn btn-primary">Add New Ingredient</a>
      </div>
    </fieldset>
  </div>
<% end %> 
```

两个问题：

1.  我的 .each 块是否适合关联？

2.  向该表客户端添加新行以便表单助手识别新行并创建适当的数据库插入的最佳方法是什么？我不太清楚 Rails 魔术在创建这样的对象数组方面是如何工作的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T05:37:43.133

似乎 Ryan Bate 的[nested_form](https://github.com/ryanb/nested_form)是要走的路，它也支持 simple_form

基本用法：

`<%= simple_nested_form_for @recipe do |f| %>`

然后你希望你的“添加新成分”链接出现在哪里：

`<%= f.link_to_add "Add new ingredient", :recipe_ingredients %>`

gem 本身有很好的文档，还可以查看 Wiki 页面。

# ruby-on-rails - Rails：生成的控制器语法

> ID：15118361
> 
> 赞同：3
> 
> 时间：2013-02-27T17:26:46.263
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

使用 创建新资源时`rails generate scaffold person`，将创建以下控制器操作`destroy`：

```
class PeopleController < ApplicationController
  def destroy
    @person = Person.find(params[:id])
    @person.destroy

    respond_to do |format|
      format.html { redirect_to people_url }
      format.json { head :no_content }
    end
  end
end 
```

在编写自己的`destroy`操作时，我总是复制这种语法。

我的问题是，为什么生成的代码：

1.  分配一个从未使用过的实例变量？
2.  当只需要一个时执行两个数据库调用？

以下代码是等效的，还是有理由不这样做？

```
class PeopleController < ApplicationController
  def destroy
    Person.destroy(params[:id])

    respond_to do |format|
      format.html { redirect_to people_url }
      format.json { head :no_content }
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:53:41.387

查看[源代码](http://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-destroy)可以发现，这`Person.destroy(params[:id])`相当于`Person.find(params[:id]).destroy`：

```
# File activerecord/lib/active_record/relation.rb, line 377
def destroy(id)
  if id.is_a?(Array)
    id.map { |one_id| destroy(one_id) }
  else
    find(id).destroy
  end
end 
```

# .htaccess - 我的 .htaccess 中的 RewriteRules 不适用于 Magento EE 1.12

> ID：15118363
> 
> 赞同：0
> 
> 时间：2013-02-27T17:26:54.653
> 
> 标签：.htaccess, magento, mod-rewrite

我有一个项目，它升级：

*   Magento EE 1.9
*   Magento EE 1.12

我正在使用 Ubuntu。两个项目的配置几乎相同，我对 vhost 的配置相同（只是名称不同）和相同的 .htaccess 具有相同的权限。我的问题是 RewriteRules 无法进行升级（Magento EE 1.12），我不知道为什么。这些是我位于项目根目录中的 .htaccess 中的重写：

```
Options +FollowSymLinks
RewriteEngine on

RewriteCond %{QUERY_STRING} ^(.*)
RewriteRule ^brand/(.+)$ brand-filter.html?brand=$1&%1 [L] 
```

这适用于我的 Magento EE 1.9，但不适用于我的 Magento EE 1.12。

如果我将重写更改为根目录中的另一个文件，它可以工作，例如：

```
RewriteRule ^brand/(.+)$ test.php [L] 
```

但它不适用于 magento 目录，例如：

```
RewriteRule ^brand/(.+)$ checkout/cart [L] 
```

这有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:02:41.277

激活 LogLevel 进行重写

```
LogLevel debug rewrite:trace8 
```

所以你可以确切地看到它为什么不匹配。

# c++ - 2个函数C++之间的区别

> ID：15118365
> 
> 赞同：-1
> 
> 时间：2013-02-27T17:27:04.343
> 
> 标签：c++, function

我必须用 C++ 编写这两个函数，其中`Complex`是一个类：

```
const Complex operator*(const Complex&, double);
const Complex operator*(double, const Complex&); 
```

我知道如何写它们，但我不知道它们之间有什么区别。你能帮助我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T17:28:37.070

不同的是它们会在不同的情况下被调用：

```
Complex c;
c * 10.0; // Will call the first
10.0 * c; // Will call the second 
```

左操作数始终是重载运算符函数的第一个参数，右操作数始终是第二个参数。在这种情况下，您可以轻松地根据另一个定义一个。但是，有时您可能需要一个非交换运算符，这是允许的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T17:28:21.037

第一个是`Complex`在左侧与 a 相乘：`complex * 2.0`

第二个是`Complex`在右侧与 a 相乘：`2.0 * complex`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T17:28:32.260

好吧，第一个参数将双精度数作为第一个参数，将复数作为第二个参数，而第二个参数将复数作为第一个参数，将双精度数作为第二个参数。由于复数的乘法是对称的，因此假设您交换相同的参数，两者都会给出相同的结果。在其他情况下，对于某些非对称操作，您仍然可能有不同的操作员行为，这就是您需要同时实现这两种操作的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T18:03:19.623

所有的答案都很好，所以我没有什么要补充的。但很可能你的类有一个构造函数，它使用像 double 这样的标量类型提供复数的构造。因此，如果此构造函数未声明为显式且 operator* 未声明为该类的成员，则您不需要这两个函数。

# android - 来自其他字段的 SQLite Android 更新字段

> ID：15118370
> 
> 赞同：1
> 
> 时间：2013-02-27T17:27:16.910
> 
> 标签：android, database, sqlite

我正在尝试通过组合其他三个整数字段来更新我的 SQLite 数据库中的整数字段，但如果字段值的长度为 1，我还需要在其他字段中的两个前面加上零。

这是我试图通过 DBAdapter 类中的升级数据库方法执行的例程。

所以我需要改变这个当前的更新：

```
if (newVersion==2) {
  populatesql = "update " + DB_TABLE + 
                " set field1="+ COL_FIELD2 +
                " || " +
                COL_FIELD3 + 
                " || " + 
                COL_FIELD4;
} 
```

像这样的东西（是的，我知道前缀零不起作用，因为它需要字符串而不是整数，但我用字符串尝试了它并使其成为静态但它不起作用）

```
if (newVersion==2) {
  populatesql = "update " + DB_TABLE + 
                " set field1="+ COL_FIELD2 +
                " || " +
                prefixzero(COL_FIELD3) + 
                " || " + 
                prefixzero(COL_FIELD4);
}

public String prefixzero(String number) {
    String result = Integer.toString(number);

    // Log.d("PREFIX", "result starts with this = "+result);
    if (result.length() >1 ) {
      // Log.d("PREFIX", "NO ZEROES HERE");
      return Integer.toString(number);
    }

   String zeroprefix = "";
   zeroprefix = "0"+result;
   // Log.d("PREFIX", zeroprefix);

   return zeroprefix ;
} 
```

数据库字段声明如下：

```
public static final String COL_FIELD4 = "day";
public static final String COL_FIELD3 = "month";
public static final String COL_FIELD2 = "year";
public static final String COL_FIELD1 = "long_date"; 
```

这是我忽略空格的错误。就像没有空格的想法一样，字段名称只是简单地连接在一起。使用的代码低于此错误。

```
02-28 07:34:00.919: E/AndroidRuntime(18332): java.lang.RuntimeException: Unable to start activity ComponentInfo{co.uk.common.myapp/co.uk.common.myapp.MainActivity}: android.database.sqlite.SQLiteException: no such column: yearmonthday: update Log set long_date= yearmonthday
02-28 07:34:00.919: E/AndroidRuntime(18332):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1658)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1674)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:942)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at android.os.Looper.loop(Looper.java:130)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at android.app.ActivityThread.main(ActivityThread.java:3735)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at java.lang.reflect.Method.invokeNative(Native Method)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at java.lang.reflect.Method.invoke(Method.java:507)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:904)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:662)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at dalvik.system.NativeStart.main(Native Method)
02-28 07:34:00.919: E/AndroidRuntime(18332): Caused by: android.database.sqlite.SQLiteException: no such column: yearmonthday: update Log set long_date= yearmonthday
02-28 07:34:00.919: E/AndroidRuntime(18332):    at android.database.sqlite.SQLiteDatabase.native_execSQL(Native Method)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at android.database.sqlite.SQLiteDatabase.execSQL(SQLiteDatabase.java:1763)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at co.uk.shieldstothemax.blastedneighbours.DBAdapter$DBHelper.onUpgrade(DBAdapter.java:68)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:132)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at co.uk.shieldstothemax.blastedneighbours.DBAdapter.open(DBAdapter.java:87)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at co.uk.shieldstothemax.blastedneighbours.MainActivity.onCreate(MainActivity.java:123)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
02-28 07:34:00.919: E/AndroidRuntime(18332):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1622) 
```

onUpgrade 方法中的代码：

```
if (newVersion==2) {

                 populatesql = "update "+ DB_TABLE +" set long_date= "+getDateStr(COL_FIELD2,COL_FIELD3,COL_FIELD4);                
                } 
```

getDateStr：

```
public static String getDateStr(String year, String month,String day) {
        return year+ prefixfieldzero(month)+ prefixfieldzero(day);
     } 
```

前缀字段零：

```
public static String prefixfieldzero(String number) {
            String result = String.valueOf(number);
          //  Log.d("PREFIX", "result starts with this = "+result);
            if (result.length() >1 ) {
             // Log.d("PREFIX", "NO ZEROES HERE");
             return number;
             }

           String zerofieldprefix = "";
           zerofieldprefix = "0"+result;
          // Log.d("PREFIX", zeroprefix);

              return zerofieldprefix ;
        } 
```

这是我的 DBAdapter ：

```
import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class DBAdapter {
    private static final String DB_NAME = "TABLE";
    private static final String DB_TABLE = "Log";
    private static final int DB_VERSION = 2;

    private static final String DB_CREATE = "CREATE TABLE IF NOT EXISTS "+DB_TABLE+ 
                " (_id INTEGER PRIMARY KEY AUTOINCREMENT, " + 
                       "type_id INTEGER, " +" hour INTEGER, " + 
                         "min INTEGER , " +" info VARCHAR,"+"image_desc VARCHAR, "+ 
                       "day INTEGER, "+"month INTEGER,  "+ "year INTEGER,"+" second INTEGER,long_date INTEGER ,date_time_long INTEGER NOT NULL "+");" ;

        public static final String COL_TYPE = "type_id";
        public static final String COL_HOUR = "hour";
        public static final String COL_MIN = "min";
        public static final String COL_SEC = "second";
        public static final String COL_IMAGE = "image_desc";

        public static final String COL_DAY = "day";
        public static final String COL_MON = "month";
        public static final String COL_YEAR = "year";
        public static final String COL_DATE = "date";
        public static final String COL_LONG_DATE = "long_date";
        public static final String COL_INFO = "info";   
        public static final String COL_ID = "_id";

        private SQLiteDatabase mDB;
        private DBHelper mDBHelper;
        private Context mCtx;

        private static class DBHelper extends SQLiteOpenHelper{
            public DBHelper(Context context) {
                super(context, DB_NAME, null, DB_VERSION);
            }

            @Override
            public void onCreate(SQLiteDatabase db) {
                db.execSQL(DB_CREATE);

            }

            @Override
            public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
                Log.v("OLDDBVERSION", "Old version="+String.valueOf(oldVersion));
                Log.v("NEWDBVERSION", "New version="+String.valueOf(newVersion));
                //String upgradesql = null;
                String populatesql = null;
                if (newVersion==2) {

                 populatesql = "update "+ DB_TABLE +" set long_date= "+getDateStr(COL_YEAR,COL_MON,COL_DAY);                
                }
                if (populatesql !=null) {
                    //db.execSQL(upgradesql);               
                    if (populatesql !=null) {

                        db.execSQL(populatesql);
                    }
                }

        } 
   }

        public DBAdapter(Context ctx)
        {
            this.mCtx = ctx;
        }

        //OPEN METHOD AND CLOSE METHOD
        public DBAdapter open()
        {
            mDBHelper = new DBHelper(mCtx);
            mDB = mDBHelper.getWritableDatabase(); //important
            return this;
        }

        public void close()
        {
            mDBHelper.close();
        }

        //INSERT AND DELETE
        public long createLog(String info,String image, Integer type,Integer hour,Integer mins,Integer sec,Integer day,Integer month,Integer year,Long longdate,Long date)
        {
            ContentValues v = new ContentValues();
            v.put(COL_TYPE, type);
            v.put(COL_INFO, info);
            v.put(COL_IMAGE, image);
            v.put(COL_HOUR, hour);
            v.put(COL_SEC, sec);
            v.put(COL_MIN, mins);
            v.put(COL_DAY, day);
            v.put(COL_MON, month);
            v.put(COL_YEAR, year);
            v.put(COL_DATE, date);
            v.put(COL_LONG_DATE, longdate);

            return mDB.insert(DB_TABLE, null, v);
        }

        public boolean deleteLogRec(long id)
        {
            return mDB.delete(DB_TABLE, COL_ID + "="+ id, null)>0;
        }

        public boolean deleteAllLogs()
        {
            return mDB.delete(DB_TABLE, null, null)>0;
        }

        //get all bookmark
        public Cursor GetAllLogs(Integer i,String sortfield)
        {
            String sorted = "";
            if (i == 1 ) {
                sorted = "DESC";
            } else if (i == 2) {
                sorted = "ASC";
            } 

            return mDB.query(DB_TABLE, new String[] {COL_ID, COL_TYPE,COL_IMAGE, COL_INFO,COL_IMAGE,COL_HOUR,COL_SEC,COL_MIN,COL_DAY,COL_MON,COL_YEAR,COL_SORT_DATE},
                            null, null, null, null, COL_DATE+" "+sorted);
        }

        public Cursor allrecords() {

            return mDB.query(DB_TABLE, new String[] {COL_ID, COL_TYPE,COL_IMAGE, COL_INFO,COL_IMAGE,COL_HOUR,COL_SEC,COL_MIN,COL_DAY,COL_MON,COL_YEAR,COL_SORT_DATE},
                    null, null, null, null, null);
        }

        //get a specific log by id
        public Cursor getLog(long id)
        {
            Cursor mCursor = mDB.query(true, DB_TABLE, new String[] {COL_ID, COL_TYPE,COL_IMAGE, COL_INFO,COL_IMAGE,COL_HOUR,COL_SEC,COL_MIN,COL_DAY,COL_MON,COL_YEAR},
                    COL_ID + "=" + id,
                    null, null, null, null, null);

            if (mCursor!=null)
                mCursor.moveToFirst();
            return mCursor;
        }

        //finally update the log
        public boolean updateLog(long id, String uinfo, String uimage,Integer utype,Integer uhour,Integer usec,Integer umin,Integer uday,Integer umonth,Integer uyear,Long ulongdate,Long udate)
        {
            ContentValues v = new ContentValues();
            v.put(COL_TYPE, utype);
            v.put(COL_INFO, uinfo);
            v.put(COL_IMAGE, uimage);
            v.put(COL_HOUR, uhour);
            v.put(COL_SEC, usec);
            v.put(COL_MIN, umin);
            v.put(COL_DAY, uday);
            v.put(COL_MON, umonth);
            v.put(COL_YEAR, uyear);
            v.put(COL_DATE, udate);
            v.put(COL_SORT_DATE, ulongdate);

            return mDB.update(DB_TABLE, v, COL_ID + "=" + id, null) > 0;
        }   

        public static String prefixfieldzero(String number) {
            String result = String.valueOf(number);
          //  Log.d("PREFIX", "result starts with this = "+result);
            if (result.length() >1 ) {
             // Log.d("PREFIX", "NO ZEROES HERE");
             return number;
             }

           String zerofieldprefix = "";
           zerofieldprefix = "0"+result;
          // Log.d("PREFIX", zeroprefix);

              return zerofieldprefix ;
        }

    public static String getDateStr(String year, String month,String day) {
            return year+ prefixfieldzero(month)+ prefixfieldzero(day);
         }

} 
```

尝试根据您的最新答案运行 SQL，但收到此错误：

```
03-01 00:20:05.379: E/AndroidRuntime(19060): Caused by: android.database.sqlite.SQLiteException: near "AS": syntax error: update TABLE AS TABLE_Temp1 set long_date = (select year || substr('00' || month ,-2,2  ) || substr('00' || ,day, -2 ,2)  from Log AS TABLE_Temp2 where TABLE_Temp1.id=TABLE_Temp2.id 
```

当前 SQL 用于将长日期更新为年月日的组合：

```
populatesql = "update "+DB_TABLE + " AS LogTemp1 set long_date = (select year || substr('00' || month ,-2,2  ) || substr('00' || ,day, -2 ,2)  from "+DB_TABLE+" AS LogTemp2 where LogTemp1.id=LogTemp2.id   "  ; 
```

我也试过如下：

```
populatesql = "update "+DB_TABLE + " AS LogTemp1 set long_date = (select year || substr('00' || month ,-2,2  ) || substr('00' || ,day, -2 ,2)  from "+DB_TABLE+" AS LogTemp2 where **LogTemp1._id=LogTemp2._id**   "  ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T20:49:33.547

好吧，我终于得到了，你想要什么。您需要一个更新语句，根据其当前值更新每一行。当然，您不能从 SQLite 数据库调用 Java 代码中的函数。因此，一切都必须在 SQLite 本身的 UPDATE 语句中完成。

鉴于此，您的陈述应如下所示：

```
UPDATE yourTable AS table1 
SET date = 
    (SELECT year || 
            substr('00' || month, -2, 2) || 
            substr('00' || day, -2, 2) 
     FROM yourTable AS table2 
     WHERE table1.id = table2.id); 
```

您只需将我在此处使用的名称替换为您实际使用的名称，并为其创建一个有效的 Java 字符串。

这些`substr('00' || month, -2, 2)`语句执行`lpad`其他数据库引擎的语句（在 SQLite 中不可用）将执行的操作。

你可以这样读：用一个数字连接两个零，然后取结果字符串最右边的两个字符。`-2`均值，从右边缘开始计算子串，均值`2`将两个字符作为结果子串。

此`lpad`替换基于[Jason Hinkle](https://twitter.com/jasonhinkle)[的](http://verysimple.com/2010/01/12/sqlite-lpad-rpad-function/)博文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T21:07:40.013

假设 COL_FIELD2... 是字符串值，为什么不这样做呢？

```
 if (newVersion==2) {
       populatesql = "update " + DB_TABLE + 
                     " set field1 = " + getDateStr(COL_FIELD2, COL_FIELD3, COL_FIELD4);
     }

     getDateStr(String year, String month,String day) {
        return year + prefixzero(month) + prefixzero(day);
     }

     public String prefixzero(String number) {
        //Log.d("PREFIX", "result starts with this = "+result);
        if (number.length() > 1) {
           //Log.d("PREFIX", "NO ZEROES HERE");
           return number;
        }            
        number = "0" + number;
        //Log.d("PREFIX", zeroprefix);            
        return zeroprefix ;
     } 
```

如果它们是`int`-values，您可以改用以下`prefixzero()`方法（当然也可以调整方法签名`getDateStr()`：

```
 public String prefixzero(int number) {
        if (number > 9) {
           return Integer.toString(number);
        }
        return "0" + number;
     } 
```

# jquery - 如何在 jquery 本地存储中只定位一个 id？

> ID：15118372
> 
> 赞同：0
> 
> 时间：2013-02-27T17:27:29.430
> 
> 标签：jquery, local-storage

我一直在尝试制作一个待办事项列表，并且到目前为止添加和删除工作正常。我必须添加一个部分以将项目标记为已完成，因此我得到了一些代码以按照我喜欢的方式正常工作。在试验代码时，我总是尝试处理一个单独的文件，所以当我让它工作时，我尝试将它转移到待办事项文件中，但现在它不起作用。我发现它不起作用的原因是因为我没有针对项目 id（当它输入到列表时生成的那个）我尝试以与删除目标 id 相同的方式执行此操作：

```
function completeTodo() {

    var todo_item = $(this).parent();

    if (todo_item) {

        var id = parseInt( todo_item.attr('id').replace('item', '') );

        if (id) {
            if (Modernizr.localstorage) {
                if (localStorage.todos) {

                    var todo_list = JSON.parse(localStorage.todos);

                    if (localStorage.getItem("background") != null) {
                        getImage = localStorage.background;
                        $(".done").addClass(getImage);
                    }

                    $(document).ready(function () {
                        $('.palette').click(function () {
                            getImage = localStorage.background;
                            $(".done").removeClass(getImage);
                            localStorage.removeItem('background');
                            var setImage = $(this).attr(id);
                            $(".done").addClass(setImage);
                            localStorage.setItem("background", setImage);
                        });
                    });

                    localStorage.todos = JSON.stringify(todo_list);

                    drawTodos();
                }
            }
        }
    }
} 
```

然而这并没有奏效，我想不出办法来做到这一点。包含 '.done' 类的 'section' 标记也是使用 jquery 中的 id 生成的：

```
$.each(todo_list, function(id, todo) {
                todos = todos + '<section class="todo_item" id="item' + id + '"><span id="complete" class="palette complete">Complete</span><span id="incomplete" class="palette incomplete">Incomplete</span><span class="done">' + todo.name + '</span><a href="#" class="edit_todo"><img src="img/edit.png" alt="edit list item" /></a><a href="#" class="remove_todo"><img src="img/delete.png" alt="delete list item" /></a></section>';
            }); 
```

如何定位在“部分”中生成的 id，以便将其标记为完整？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:46:09.177

首先，看起来您将原始 HTML 存储在本地存储中。如果您想更多地操作它，最好将您的数据存储在一个对象（JSON，又名 JavaScript 对象表示法）中。

```
todo_list = {
  1 : "item 1",
  2 : "item 2"
}; 
```

如果要存储原始 HTML，则完全替换原始 html。

# healthvault - 如何编辑现有的 HealthVault 应用程序？

> ID：15118373
> 
> 赞同：0
> 
> 时间：2013-02-27T17:27:30.673
> 
> 标签：healthvault

我使用 HealthVault SDK 来管理主子应用程序。

1.  这是我的行动的简短摘录（简单阅读 - 保存）

`// get connection for master application`

 `OfflineWebApplicationConnection OfflineMasterConnection = new OfflineWebApplicationConnection(masterAppId, WebApplicationConfiguration.HealthServiceUrl, Guid.Empty);

// retrieve child application info

ApplicationInfo AppInfo = HealthVaultPlatform.GetChildApplication(OfflineMasterConnection, childAppIdGuid);

// save the child application` 

`AppInfo.Update(OfflineMasterConnection);`

在此之后：子应用程序的 PublicKeys 消失，任何访问应用程序的尝试都会导致“访问被拒绝”。

2\. 当我尝试以相同的方式编辑主应用程序时，除了丢失 PublicKeys 之外，它还失去了“主”状态。它的所有子应用程序都已损坏。

有谁知道编辑现有 HealthVault 应用程序的正确方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T14:41:10.167

正如我所解释的：“更新”意味着“替换”，因此在阅读 appInfo 后，您必须手动添加所有未收到的字段。最重要的是没有 PublicKeys。您必须在每次“更新”之前再次添加它们。当我们的演示系统崩溃时，我以“艰难的方式”找到了这个解决方案：我在每次更新时添加了 PublicKeys，系统又开始工作了。但我很高兴收到 Microsoft 对此行为的确认。

# maps - 字符串映射并添加到 Coq

> ID：15118374
> 
> 赞同：1
> 
> 时间：2013-02-27T17:27:31.930
> 
> 标签：maps, add, coq

在我的证明中，我达到了一个类似于以下内容的目标：（实际类型不同（zm：StringMap.string String.string，key 和 elt 是 String.string））。在我的代码中，如果我 `H: z1k <> z2k`在环境中，那么它很容易，`intuition congruence`但如果我没有这样的假设，那么我无法证明我的目标。此外，我也无法证明`v1 = v2`，这有助于证明目标。请有人指导我解决此类情况。谢谢，

```
Parameter t : Type -> Type.
Variable key : Type.
Variable elt : Type.
Implicit Type m: t elt.
Implicit Type x y z: key.
Implicit Type e: elt.

Require String.

Record id : Type :=
build_id {
         id_v : String.string;
         id_k: key
        }.

Parameter add : key -> elt -> t elt -> t elt.
Parameter MapsTo : key -> elt -> t elt -> Prop.

Lemma MyTest: forall v1 v2 (z1k z2k zk: key) (ze z1 z2: elt) zm, 
build_id v1 z1k <> build_id v2 z2k ->
MapsTo zk ze (add z1k z1 (add z2k z2 zm)) -> 
MapsTo zk ze (add z2k z2 (add z1k z1 zm)).
Proof. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T13:25:10.613

是否可以在 上假设​​可判定的平等`key`？然后，您可以通过案例分析进一步了解记录元素是否成对相等。例如，使用 Adam Chlipala 的 CPDT 策略，我得到：

```
Add LoadPath "~/dev/cpdt/src".

Require String.    
Require Import CpdtTactics.

Variable key : Type.    

Record id : Type := build_id {    
  id_v : String.string;    
  id_k : key    
}.

Axiom key_dec : forall a b : key, {a = b} + {a <> b}.

Lemma unpack_build_id_ineq : forall a b x y, build_id a x <> build_id b y ->    
  (a <> b) \/ (x <> y).    
Proof.    
  intros.    
  set (H1 := String.string_dec a b).    
  set (H2 := key_dec x y).    
  crush.    
Qed. 
```

换句话说，假设两条记录不相等，则有两种情况：要么不相等，要么`id_v`分量`id_k`不相等。希望这可以帮助。

免责声明：我是 Coq 的初学者，希望你能在这里得到更多合格的帮助，或者你也可以试试 Coq Club 邮件列表。

# java - 如何以编程方式调用浏览器插件上可用的功能

> ID：15118376
> 
> 赞同：1
> 
> 时间：2013-02-27T17:27:38.053
> 
> 标签：java, firefox-addon, toolbar, ui-automation, browser-automation

其中一个客户端需要为浏览器安装一个插件，并从插件栏中执行该插件的所有可用功能。该插件已用 Javascript 编码，并且该插件有许多可用选项。假设是否有选项 A、选项 B、选项 C 和选项 D 作为附加组件上的 4 个菜单项，它们旨在用于特定目的，

作为测试插件行为的一部分，如何从浏览器的插件栏中调用/单击插件上的选项，这反过来又会调用 javascript 函数。

您的建议和帮助将不胜感激。

# ruby-on-rails - Rails HashWithIndifferentAccess - 错误

> ID：15118379
> 
> 赞同：1
> 
> 时间：2013-02-27T17:27:43.500
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在保存这样的哈希会话：

```
 session[:review] = {:content => params[:review], :rating => params[:rating], :school_id => params[:school_id]} 
```

当我像这样将它保存到数据库时：

```
Review.create!(:content => session[:review][:content], :school_id => session[:review][:school_id], :user_id => current_user, :rating => session[:review][:rating]) 
```

它将值保存到一列中，如下所示：

```
--- !ruby/hash:ActiveSupport::HashWithIndifferentAccess
rating: '1'
content: somehting skjnfjkbf 
```

为什么以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T10:20:11.423

嗯。我不确定错误是如何产生的。

但是，下面的代码应该可以解决您的问题。

```
Review.create!(session[:review].merge(user_id: current_user)) 
```

# android - android应用程序中的图像没有改变

> ID：15118380
> 
> 赞同：1
> 
> 时间：2013-02-27T17:27:47.273
> 
> 标签：android, image, adapter

我正在尝试使用 .setImageResource(identifier) 更改图像资源，但是当我使用我现在正在使用的变量时它没有显示出来。当我自己填写图像的名称时，它将起作用。

这是 Index.java 文件：

```
 package com.example.whs;

import java.util.ArrayList;
import java.util.HashMap;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ListView;

public class Index extends Activity {

    public static final Object TITLE = "title";
    public static final Object SUBTITLE = "subtitle";
    public static final Object THUMBNAIL = "thumbnail";
    protected static final String POSITION = null;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_index);

        buildMenu();
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.index, menu);
        return true;
    }

    //Builds the menu for listview
    public void buildMenu(){
        ArrayList<HashMap<String, String>> menu = new ArrayList<HashMap<String, String>>();
        //Arrays for info
        String[] menuTitleArray = {"Updates", "Gallerij"}; 
        String[] menuSubtitleArray = {"Bekijk updates", "Bekijk foto's en geef reacties", "Bekijk de updates"};
        String[] menuThumbnailArray = {"updates", "gallery"};
        for(int i=0; i < menuTitleArray.length; i++){
            // Build Hashmap for the item
            HashMap<String, String> item = new HashMap<String, String>();
            item.put((String) TITLE, menuTitleArray[i]);
            item.put((String) SUBTITLE, menuSubtitleArray[i]);
            item.put((String) THUMBNAIL, menuThumbnailArray[i]);
            menu.add(item);
        }

        // Add adapter to the list
        MenuAdapter adapter = new MenuAdapter(this, menu);
        ListView list = (ListView)findViewById(R.id.list);
        list.setAdapter(adapter);

        // Initialize the click event
        list.setOnItemClickListener(new OnItemClickListener(){
            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long id){
                switch(position){
                case 0:
                    Intent intent = new Intent(Index.this, Updates.class);
                    startActivity(intent);
                }
            }
        });

    }
} 
```

这是 MenuAdapter.java 文件：

```
package com.example.whs;

import java.util.ArrayList;
import java.util.HashMap;

import android.app.Activity;
import android.graphics.drawable.Drawable;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;

public class MenuAdapter extends BaseAdapter{
    // Define variables
    ArrayList<HashMap<String, String>> data;
    Activity activity;
    private LayoutInflater inflater=null;

    public MenuAdapter(Activity a, ArrayList<HashMap<String, String>> d) {
        activity = a;
        data = d;
        inflater = LayoutInflater.from (a);
    }

    @Override
    public int getCount() {
        return data.size();
    }

    @Override
    public Object getItem(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    @Override
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View vi=convertView;
        if(convertView==null)
            vi = inflater.inflate(R.layout.list_row, null); 
        vi.setBackgroundResource(activity.getResources().getIdentifier("list_selector", "drawable", Index.class.getPackage().getName()));
        // Focus on the parts that have to be changed
        TextView title = (TextView)vi.findViewById(R.id.title); // title
        TextView subtitle = (TextView)vi.findViewById(R.id.subtitle); // subtitle
        ImageView thumb_image=(ImageView)vi.findViewById(R.id.list_image); // thumb image

        // Get the info from the hashmap with the arraylist position
        HashMap<String, String> item = new HashMap<String, String>();
        item = data.get(position);
        String name = (String) Index.THUMBNAIL;
        // Look for the image
        int identifier = activity.getResources().getIdentifier(name, "drawable", Index.class.getPackage().getName());

        // Setting all values in listview
        title.setText(item.get(Index.TITLE));
        subtitle.setText(item.get(Index.SUBTITLE));
        thumb_image.setImageResource(identifier);
        return vi;
    }

} 
```

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:53:08.607

嘿，我认为问题是@THUMNAIL 声明

或者，您可以尝试以下方法

```
 private Integer[] mThumbIds = {           
     R.drawable.sample_2, R.drawable.sample_3,           
    R.drawable.sample_4, R.drawable.sample_5,      
   R.drawable.sample_6, R.drawable.sample_7,    
 }; 
```

thumb_image.setImageResource(mThumbIds[位置]);

如果图像来自服务器，您可以将其转换为位图并将位图设置为图像视图。

# c# - 更改文化时 DatePicker 不会更新

> ID：15118382
> 
> 赞同：1
> 
> 时间：2013-02-27T17:28:04.490
> 
> 标签：c#, wpf, datepicker

我有一个可以改变文化的应用程序。但是，当我实际更改它时，所述应用程序中的日期选择器不会更改其日期格式。我试过隐藏它们，然后重新显示它们。那是行不通的。

任何人都可以帮忙吗？

编码：

```
CultureInfo ci = new CultureInfo(Thread.CurrentThread.CurrentCulture.ToString());
ci.DateTimeFormat.ShortDatePattern = SomeClass.isDDMM ? "dd/MM/yy" : "MM/dd/yy";
Thread.CurrentThread.CurrentCulture = ci; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:00:14.293

`DatePicker`改变当前文化时似乎存在某种问题。它不会立即正确刷新该值，但是当您将其聚焦并再次从中移除焦点时，将应用新的日期格式。

我发现解决这个问题而没有太多麻烦的唯一方法是：

```
var date = t.SelectedDate;
t.SelectedDate = null;
t.SelectedDate = date; 
```

这不是很优雅，但应该可以正常工作。

这个小程序显示了单击按钮时格式是如何变化的。XAML 只包含一个`DatePicker`被调用`dtp`和一个按钮。

```
public partial class MainWindow : Window
{
    private string format1 = "MM/dd/yy";
    private string format2 = "dd/MM/yy";
    private string currentFormat = null;

    public MainWindow()
    {
        InitializeComponent();
        currentFormat = format1;
    }

    private void clickButton(object sender, RoutedEventArgs e)
    {
        CultureInfo ci = new CultureInfo(Thread.CurrentThread.CurrentCulture.ToString());

        ci.DateTimeFormat.ShortDatePattern = currentFormat =
            currentFormat == format1 ? format2 : format1;

        Thread.CurrentThread.CurrentCulture = ci;

        //Refresh control..
        var date = dtp.SelectedDate;
        dtp.SelectedDate = null;
        dtp.SelectedDate = date;
    }
} 
```

# google-analytics - 分析跟踪具有独特价值的事件目标

> ID：15118383
> 
> 赞同：0
> 
> 时间：2013-02-27T17:28:08.240
> 
> 标签：google-analytics

我已经使用以下参数设定了分析目标：

```
Target type: Event
Category (matching): form
Action (matching): test
Label (matching): sent
Value: nothing 
```

我有这个分析推动：

```
<script type="text/javascript">
_gaq.push(['_trackEvent', 'form', 'test', 'sent', '*dynamic_URI*']);
</script> 
```

这行得通吗？*dynamic_URI* 会被注册吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T17:11:06.583

谢谢您的回答！:)

我为我的目标做了一些改变，希望能奏效。

```
Type: URL Destination
Goal URL: /form/test/*
Match type: Regular Expression Match 
```

还有我的 javascript：

```
<script type="text/javascript">
_gaq.push(['_trackPageview', '/form/test/*dynamic_URI*']);
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T08:29:28.207

来自[https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide)：

```
_trackEvent(category, action, opt_label, opt_value, opt_noninteraction)    

value (optional)
An integer that you can use to provide numerical data about the user event. 
```

因此，您不能将 url 作为第四个（“值”）参数传递。

据我所知，value 参数旨在帮助计算 adwords 投资回报率（为非电子商务事件分配 $$ 值）。

# erlang - 在erlang中清除表格

> ID：15118385
> 
> 赞同：3
> 
> 时间：2013-02-27T17:28:15.277
> 
> 标签：erlang, mnesia

我有表用户

```
 -record(person, {id, firstname, lastname}). 
```

此表包含以下值：

```
 1  francoi     mocci     
    2  test        tes 
```

我想从这个表中清除数据

我没有在erlang中找到从表用户中清除数据的语法

我找到了删除表的功能

```
mnesia:delete(..) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T18:23:51.680

[http://www.erlang.org/doc/man/mnesia.html#clear_table-1](http://www.erlang.org/doc/man/mnesia.html#clear_table-1)

> clear_table（选项卡）
> 
> 删除表选项卡中的所有条目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:32:39.023

要仅对某些记录执行此操作，您可以找到表中的所有键，然后为要删除的每个键调用删除函数。我在shell中尝试这个：

```
1> mnesia:create_schema([node()]).
ok
2> application:set_env(mnesia, dir, ".").
ok
3> application:start(mnesia).
ok
4> application:which_applications().
[{mnesia,"MNESIA  CXC 138 12","4.7.1"},
 {stdlib,"ERTS  CXC 138 10","1.18.2"},
 {kernel,"ERTS  CXC 138 10","2.15.2"}]
5> rd(person, {id, firstname, lastname}).
person
6> mnesia:create_table(person,[{attributes, record_info(fields,person)},{ram_copies,[node()]}]).                       
{atomic,ok}
7> Add=fun(I,N,L) -> F = fun() -> mnesia:write(#person{id=I,firstname=N,lastname=L}) end, mnesia:activity(transaction,F) end.
#Fun<erl_eval.18.82930912>
8> Add(1,"Toto","Ralf").
ok
9> Add(2,"Titi","Ben"). 
ok
10> mnesia:activity(transaction,fun() -> mnesia:all_keys(person) end).
[1,2]
11> Add(3,"Tutu","Joe").                                              
ok
12> L = mnesia:activity(transaction,fun() -> mnesia:all_keys(person) end).
[1,2,3]
13> mnesia:dirty_read(person,3).
[#person{id = 3,firstname = "Tutu",lastname = "Joe"}]
14> Del=fun(X) -> F=fun() -> mnesia:delete({person,X}) end, mnesia:activity(transaction,F) end.                               
#Fun<erl_eval.6.82930912>
15> [Del(X) || X <- L, X < 3].
[ok,ok]
16> mnesia:activity(transaction,fun() -> mnesia:all_keys(person) end).    
[3]
17> 
```

# c++ - 由于嵌套不能#include，不能使用类原型

> ID：15118392
> 
> 赞同：1
> 
> 时间：2013-02-27T17:28:28.553
> 
> 标签：c++, vector, header, include

情况：我有一个 Particle 类和一个 Field 类。粒子具有与之相关的场，反之亦然，场通常具有粒子。

如果我在，我不能`#include "particle.hpp"`在。当然，这很有道理。`"field.hpp"``#include "field.hpp"``"particle.hpp"`

我在这两个文件中都使用了前向声明，但是编译器现在无法编译并出现以下错误：

```
error: invalid use of incomplete type ‘class ElementaryParticle’
error: forward declaration of ‘class ElementaryParticle’

error: invalid use of incomplete type ‘class ElementaryField’
error: forward declaration of ‘class ElementaryField’ 
```

有没有办法解决这些问题？我明白为什么会发生错误。如何定义两个类而不将它们包含在彼此的文件中？这些问题的出现是因为场试图访问粒子的成员，而粒子包含场向量。

编辑：一种解决方法是将类合并到一个文件中的一个类中……但这很荒谬，并导致各种其他问题。

EDIT2：我知道头卫。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:37:09.790

我会让 field.hpp 包含particle.hpp，在particle.hpp 中包含ElementaryField 的前向声明-然后在您的particle.cpp 中包含field.hpp。只要您在particle.hpp中没有任何代码，那应该可以解决您的问题。从技术上讲，您可以在 .hpp 中对每个进行前向声明，然后在 .cpp 中包含其他的 .hpp。这可能会更好，因为它更加标准化。我进行了最初的评估，因为你说场访问粒子的成员，而粒子只包含场向量。

另外，如果您不使用 pragma [#once](http://en.wikipedia.org/wiki/Pragma_once)，也许会有所帮助？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:56:00.520

大多数程序员在定义头文件时都使用包含保护。一些编译器允许

```
#pragma once 
```

指令，但如果这不可用，通常的约定是定义 #ifndef 守卫，如下所示：

```
#ifndef PARTICLE_HPP__
#define PARTICLE_HPP__

class Field;

class Particle {
// ...
};

#endif // PARTICLE_HPP__ 
```

和

```
#ifndef FIELD_HPP__
#define FIELD_HPP__

class Particle;

class Field {
// ...
};

#endif // FIELD_HPP__ 
```

完成后，您现在遇到了每个上下文中未定义类的问题。这里的解决方案是永远不要假设场中粒子的定义，永远不要假设粒子中的场定义。你有声明，这很好。但是不要使用任何需要定义的东西。例如，在 Particle.hpp 中，避免：

```
Field x;  // Error: Requires Constructor definition
Field *y; // Okay
Field &z; // Okay, but must be initialized in constructor
y->foo(); // Error: Requires definition of foo
z.bar;    // Error: Requires definition of bar 
```

相反，将所有这些错误位放在您的 .cpp 中，它可以包含两个标头并具有两个对象的完整定义。只用指针和引用保持你的标题抽象，你应该没问题。

# c - C中是否有任何NFS实现？

> ID：15118396
> 
> 赞同：0
> 
> 时间：2013-02-27T17:28:32.620
> 
> 标签：c, nfs

我正在用 C 编写自己的 NFS（网络文件系统）实现。是否有任何好的可用资源/参考资料可供我参考？我不知道我从哪里开始。我知道这不是一个在 stackoverflow 上发布的问题，因为我以前来过这里，但我真的需要开始。我已经理解了 NFS 的概念以及它的实际工作原理。任何帮助都会非常有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:48:35.613

如上所述，实现需要是 VFS 扩展模块。我建议您阅读了解 linux 内核中的 VFS 章节。VFS 是内核中编写的最漂亮的代码之一。尽管它是用 c 语言编写的，但它是面向对象的，而且这种扩展的实现并不难。基本上，你得到了一个函数指针结构，指向诸如 open、write 等命令。你需要实现它。

# java - Struts 2 动作中的 Android GCM-server

> ID：15118398
> 
> 赞同：1
> 
> 时间：2013-02-27T17:28:33.227
> 
> 标签：java, android, json, struts2, google-cloud-messaging

我正在尝试通过 GCM 向 Android 设备发送消息。按照[谷歌的教程](http://developer.android.com/google/gcm/gs.html#server-app)，我已将该`gcm-server.jar`库添加到我的 Struts2 项目中。但是我遇到了一个例外，我的代码：

```
public String execute() throws IOException {
        List<String> devices = new ArrayList<String>();
        devices.add(gcmRegId);
        Sender sender = new Sender(PROJECT_API);
        Message gcmMessage = new Message.Builder().build();
        Result result = sender.send(gcmMessage, gcmRegId, 5);
} 
```

我得到的例外是，它在创建`Sender`对象后引发。

```
Caused by: java.lang.ClassNotFoundException: org.json.simple.parser.ParseException
at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526) 
```

我错过了什么吗？像依赖项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:40:30.847

你缺少图书馆`json-simple-1.1.jar`。如果您使用 maven，则工件为`json-simple`，版本为`1.1`，名称为`JSON.simple`。[可从存储库下载](http://mirrors.ibiblio.org/pub/mirrors/maven2/com/googlecode/json-simple/json-simple/1.1/json-simple-1.1.jar)。

# actionscript-3 - DropShadowFilter 在 ActionScript 3 中裁剪位图

> ID：15118401
> 
> 赞同：0
> 
> 时间：2013-02-27T17:28:45.683
> 
> 标签：actionscript-3

我正在将 a`DropShadowFilter`应用于 Adob​​e AIR 3.5、ActionScript 3 Mobile 项目中的位图。在大多数情况下，它工作正常。但是，有时会在底部或右侧稍微切掉图像。

看这些图片：

![在此处输入图像描述](../Images/c235fdc123595f5239955a99c3eaf04a.png)对比![在此处输入图像描述](../Images/689bd671194d699db0f668eea916a110.png)

如您所见，应用投影时，右侧和底部均被裁剪。是否有一个原因？或者有什么方法可以解决？

**编辑（MST 2-27 上午 10:30）**：作为快速更新，它也`BlurFilter`可能与任何其他过滤器一起发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:30:20.957

我不确定您是如何生成位图的，但如果您使用的是 BitmapData 类，请使用方便的[**generateFilterRect()**](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#generateFilterRect%28%29)函数，该函数将计算应用传递的过滤器的新边界。

这应该为您提供正确的尺寸，尤其是在使用扩展对象外观的 BlurFilter 或 BevelFilter 时。还请查看方法描述下方的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:29:05.833

当`Bitmap`位于非整数 x 或 y 位置时会发生这种情况。这似乎是源数据如何传递给过滤器的一个错误，我找不到一个好的解决方案来尝试不同`Bitmap`的`pixelSnapping`和`smoothing`属性。

您可以通过舍入其全局位置来保持图像完全对齐（请参见[`localToGlobal`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObject.html#localToGlobal%28%29)和[`globalToLocal`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObject.html#globalToLocal%28%29)，但如果它移动，则可能更容易将其包裹`Bitmap`在`Sprite`具有稍大透明背景的 a 中，以强制过滤器在边缘周围包含安全边距。一些东西像这样：

```
private var b:Bitmap = new EmbeddedClass();
private var container:Sprite = new Sprite();
container.addChild(b);
container.graphics.beginFill(0xFF00FF, 0);
container.graphics.drawRect(-2, -2, container.width + 4, container.height + 4);
container.graphics.endFill();
container.filters = [new DropShadowFilter()]; 
```

或者，您可以将源绘制`BitmapData`到稍大的副本来执行相同的操作。

# android - 使用函数 gethostbyname 将 C 编译为静态链接错误

> ID：15118408
> 
> 赞同：3
> 
> 时间：2013-02-27T17:28:55.550
> 
> 标签：android, c, cross-compiling, compiler-warnings

我正在尝试使用`gethostbyname()`带有交叉编译器的函数来编译程序`arm-none-linux-gnueabi`，但是当我在 android 上运行我的二进制文件时它不起作用。

我的代码在下面：

```
 /* gethostbyname-example.c */

  #include <stdio.h>
  #include <unistd.h>
  #include <stdlib.h>
  #include <string.h>
  #include <errno.h>
  #include <sys/socket.h>
  #include <netinet/in.h>
  #include <arpa/inet.h>
  #include <netdb.h>

  extern int h_errno;

  int main(int argc,char **argv) {
     int x, x2;
     struct hostent *hp;

     for ( x=1; x<argc; ++x ) {
        hp = gethostbyname(argv[x]);
        if ( !hp ) {
           fprintf(stderr,
                   "%s: host '%s'\n",
                   hstrerror(h_errno),
                   argv[x]);
           continue;
        }

        printf("Host %s : \n" ,argv[x]);
        printf(" Officially:\t%s\n", hp->h_name);
        fputs(" Aliases:\t",stdout);
        for ( x2=0; hp->h_aliases[x2]; ++x2 ) {
           if ( x2 ) {
              fputs(", ",stdout);
             }
        fputs(hp->h_aliases[x2],stdout);
        }     
        fputc('\n',stdout);
        printf(" Type:\t\t%s\n",
               hp->h_addrtype == AF_INET
               ? "AF_INET" : "AF_INET6");
        if ( hp->h_addrtype == AF_INET ) {
           for ( x2=0; hp->h_addr_list[x2]; ++x2 ) {
              printf(" Address:\t%s\n",
                     inet_ntoa( *(struct in_addr *)
                      hp->h_addr_list[x2]));
           }
        }
     putchar('\n');
     }
     return 0;
  } 
```

我`arm-none-linux-gnueabi-gcc`用操作系统`ubuntu 12.04`和交叉编译器在我的笔记本电脑上编译`Sourcery Codebench`：

```
$ arm-none-linux-gnueabi-gcc gethostbyname-example.c --static -o gethostbyname-example
/tmp/ccE0xjBG.o: In function `main':
lookup.c:(.text+0x38): warning: Using 'gethostbyname' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking
$ ls
gethostbyname-example.c gethostbyname-example
$ file gethostbyname-example
gethostbyname-example: ELF 32-bit LSB executable, ARM, version 1 (SYSV), statically linked, for GNU/Linux 2.6.16, not stripped 
```

然后我`gethostbyname-example`在我的 chroot 手臂上测试二进制文件，我将二进制文件复制粘贴到`chroot`文件夹，然后我登录到`chroot`，然后我执行，顺便说一句，我从这里[https://wiki.ubuntu.com/ARM/BuildEABIChroot](https://wiki.ubuntu.com/ARM/BuildEABIChroot)创建 chroot ，如果我在 chroot 上运行它，得到如下结果：

```
# ./gethostbyname-example www.google.com
Host google.com : 
 Officially:    www.google.com
 Aliases:   
 Type:      AF_INET
 Address:   74.125.135.139
 Address:   74.125.135.100
 Address:   74.125.135.101
 Address:   74.125.135.102
 Address:   74.125.135.113
 Address:   74.125.135.138 
```

然后，我还将使用 adb push 的二进制 gethostbyname-example 上传到我的 android 设备，如果我运行二进制 gethostbyname-example，则会收到如下错误：

> ```
> # ./gethostbyname-example www.google.com
> # Unknown server error: host 'www.google.com'
> # ping www.google.com
> # PING www.google.com (74.125.135.99) 56(84) bytes of data.
> # 64 bytes from ni-in-f99.1e100.net (74.125.135.99): icmp_seq=1 ttl=49 time=798 ms
> # 64 bytes from ni-in-f99.1e100.net (74.125.135.99): icmp_seq=2 ttl=49 time=1039 ms 
> ```

在我的 android 设备中，我在 /etc/ 和 /system/etc/ 中有一个文件主机，带有谷歌 DNS

```
8.8.8.8 
8.8.4.4 
```

大概是什么原因导致这个失败，

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:09:53.087

# 简短说明

glibc 中的 DNS 查找需要 /lib/libnss_dns.so.2 ，这在 Android 上不可用。

另一个区别是 Android 存储 DNS 设置 `/system/etc/resolv.conf`，使用仿生 C 库构建的原生 Android 应用程序将在那里查找要查询的 DNS 服务器。使用 glibc 构建的应用程序将`/etc/resolv.conf`在 Android 上不存在。

# 更长的解释

您已经使用 glibc 构建了二进制文件，而 Android 使用了仿生 C 库。

在静态链接到 libc 时，这在大多数情况下应该没问题，因为我不知道 android 内核中有足够严重的变化来破坏简单的用户空间应用程序。不过，您应该使用 Android NDK 来构建 android 本机应用程序，

然而，当静态链接到 glibc 时，会出现一些问题。glibc 中的某些功能，例如用于查找用户信息、主机名和其他通常在 /etc/nsswitch.conf 中配置的内容的功能调用其他共享库来实际完成工作。无论您是否静态链接到 glibc 本身，都会发生这种情况。这些文件通常是 glibc 系统上的 /lib/libnss_* 文件。

这些共享库中的大多数都是 glibc 的一部分，并且将安装在 glibc 系统上。但它们在 Android 上不可用。当这些共享库可用时，依赖于使用这些辅助共享库的函数的应用程序无法正常工作 - gethostbyname() 就是其中之一，对于正常的 DNS 查询，它需要 /lib/libnss_dns.so.2

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-20T02:20:16.787

有关解释，请参阅没有回复，解决方案请按照下列步骤操作：

*   从这里下载 android NDK：[https](https://developer.android.com/ndk/downloads/index.html) ://developer.android.com/ndk/downloads/index.html （我使用的是 linux 64bit）
*   解压`android-ndk-r13b-linux-x86_64.zip`
*   进入刚刚解压的目录
*   启动 ./build/tools/make_standalone_toolchain.py 以查看可能的选项
*   例如 ./build/tools/make_standalone_toolchain.py --arch arm --api 9
*   该工具将为您构建 arm-linux-androideabi.tar.bz2
*   用 tar xjvf arm-linux-androideabi.tar.bz2 解压
*   它将创建 ./arm-linux-androideabi 目录
*   现在您可以使用 ./arm-linux-androideabi/bin/arm-linux-androideabi-gcc yourprog.c -o yourprog -pie 进行编译
*   Android >= 5 需要 -pie
*   您生成的可执行文件是本机的，解析器将按预期工作

# java-bytecode-asm - 在 ClassReader 和 ClassWriter 之间插入我无法控制的 ClassVisitor 链？

> ID：15118413
> 
> 赞同：0
> 
> 时间：2013-02-27T17:29:08.137
> 
> 标签：java-bytecode-asm

```
public class ChainingVisitors {
    public static void main(String[] args) throws Exception {
        ClassReader reader = new ClassReader("com.foo.Bar");
        ClassWriter writer = new ClassWriter(COMPUTE_MAXS | COMPUTE_FRAMES);
        ClassVisitor v3 = new Link(3, writer);
        ClassVisitor v2 = new Link(2, v3);
        ClassVisitor v1 = new Link(1, v2);
        reader.accept(v1, 0);
        System.out.printf("how many bytes in %s? %d\n", Runnable.class, writer.toByteArray().length);
    }

    private static class Link extends ClassVisitor {
        private final int order;

    public Link(int order, ClassVisitor next) {
        super(ASM4, next);
        this.order = order;
    }

    @Override public void visit(int i, int i2, String s, String s2, String s3, String[] strings) {
        System.out.printf("In visitor %d\n", order);
        super.visit(i, i2, s, s2, s3, strings);
    }
} 
```

我想将任意的`ClassVisitor`s 链交给一个方法。该方法将通过 a 读取类的字节，然后`ClassReader`使用 转换类`ClassVisitors`，然后通过 a 写入结果`ClassWriter`。`ClassReader`基本上，我想在“a and ”之间使用这些访问者的链（假设我不控制）`ClassWriter`，方法将控制其实例化。

我怎样才能做到这一点？似乎访问者的链接希望您构建从“后”（最后一个链接，绑定到 a `ClassWriter`）到“前”（第一个链接，`accept()`由 a 编辑`ClassReader`）的链。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T15:36:22.170

我会争论这样的设计。如果某个组件能够创建访问者，为什么它不能在传递给它的字节码上运行 ClassReader 和 ClassWriter？

但是如果你真的想自己创建访问者链，你可以使用工厂设计模式。因此，不是访问者，而是传入工厂来创建这些访问者，然后您可以在不了解访问者的情况下自己构建访问者链。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T06:27:27.283

您可以尝试仅将访问者类传递给您的方法并通过反射将它们实例化。

# entity-framework - EF映射一对多复合PK-子类上没有PK属性

> ID：15118414
> 
> 赞同：0
> 
> 时间：2013-02-27T17:29:10.403
> 
> 标签：entity-framework, one-to-many, fluent-interface

检查以下 Db 脚本：

```
CREATE TABLE tlogdata
(
    logentryid INT NOT NULL, -- PK
    [key] NVARCHAR(25) NOT NULL, -- PK
    value NVARCHAR(MAX) NOT NULL
)

CREATE TABLE tlogentry
(
    logentryid INT IDENTITY(1,1) NOT NULL, -- PK
    [message] NVARCHAR(4000) NOT NULL
) 
```

tlogentrydata 有一个复合 PK => logentryid 和密钥。logentryid 引用 tlogentry.logentryid 列

现在我想做的是像这样创建我的模型：

```
public class LogEntryData
{
    public string Key { get; set; }
    public string Value { get; set; }
}

public class LogEntry
{
    public int Id { get; set; }
    public string Message { get; set; }
    public List<LogEntryData> Data { get; set; } 
} 
```

如您所见，LogEntryData 不包含“LogEntryID”作为属性。所以我的问题是如何将这两个类映射（使用流利的 API）到我的表中？我不知道是否甚至可以告诉 EF LogEntryData 具有复合 PK 而不将其中一列公开为公共属性（在这种情况下，LogEntryId 在 LogEntryData 类中不存在，但在 tlogentrydata 表中作为 logentryid 列存在）

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:32:02.953

这是不可能的。您始终必须将完整密钥作为模型中的属性公开。然后可以通过以下方式实现映射：

```
modelBuilder.Entity<LogEntryData>()
    .HasKey(led => new { led.LogEntryId, led.Key });

modelBuilder.Entity<LogEntry>()
    .HasMany(le => le.Data)
    .WithRequired()
    .HasForeignKey(led => led.LogEntryId); 
```

# debugging - 如何调试在 Intellij Idea 中存储为文本的 Groovy 命令

> ID：15118415
> 
> 赞同：3
> 
> 时间：2013-02-27T17:29:12.043
> 
> 标签：debugging, groovy, intellij-idea

我有一组存储在数据库中的 groovy 命令。这些命令被解析并作为脚本加载，然后运行脚本。有没有办法调试这个脚本？

我在想我可以将所有这些命令加载到本地文件系统，并在运行时将脚本与存储的源文件相关联。非常感谢任何有关如何完成此操作的指示。

示例代码：

```
 Script parsedScript = shell.parse(new File("TestScripts.groovy"));// Instead of this line the scripts are loaded from the database.
  parsedScript.run(); 
```

Intellij 版本：11.4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T00:17:20.653

我知道动态解析时无法进入 TestScripts.groovy 但为什么不将文件本身添加为源（或添加新模块）并直接在 IDEA 中运行它？

[运行和调试 Groovy 脚本](http://www.jetbrains.com/idea/webhelp/running-and-debugging-groovy-scripts.html)

如果您需要从数据库重新生成文件，您可以在调试之前创建另一个脚本来执行此操作。

# javafx-2 - 从 Listener 访问 userData

> ID：15118420
> 
> 赞同：1
> 
> 时间：2013-02-27T17:29:26.460
> 
> 标签：javafx-2, javafx

当此类`userData`元素通过`Listener`. 基本上，在 a`ObservableValue`的实例中获取对 的“所有者”的引用`ChangeListener`。

我认为这可以通过一个例子更好地证明：

```
for(/*something*/) {
    CheckBox newBox = new CheckBox("My Label " + i);
    newBox.setSelected(true);
    newBox.setUserData(object);  //setting this object to access later
    newBox.selectedProperty().addListener(new ChangeListener<Boolean>() {
        public void changed(ObservableValue<? extends Boolean> ov, Boolean old_val, Boolean new_val) {
            //Here I would like to call something to get the UserData 
            //I have just set.  I would need to access "object" set above.
        }
    });
} 
```

我还没有找到这样做的方法。目前我可以设置`id`此复选框并使用该 ID 查找我需要的项目，但这似乎与我可以`userData`为该节点设置对象 () 的事实背道而驰。这不是应该如何`userData`使用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:08:46.207

使用关键字`final`：

```
final CheckBox newBox = new CheckBox("My Label " + i); 
```

然后使用：

```
newBox.getUserData() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T19:12:23.907

这是我为这个问题找到的解决方案（假设我最初的要求是不可能的）。

我最终创建了一个`ChangeListener`实现此功能的实现。这`Listener`看起来像这样：

```
public class ChangeListenerWithData implements ChangeListener<Boolean> {

    private Object userData;

    public ChangeListenerWithData(Node node) {
        userData = node.getUserData();
    }

    public Object getUserData() {
        return userData;
    }

    public void setUserData(Object userData) {
        this.userData = userData;
    }

    @Override
    public void changed(ObservableValue<? extends Boolean> observable,
            Boolean oldValue, Boolean newValue) {
        // TODO Auto-generated method stub

    }

} 
```

然后我的代码变成了：

```
for(/*something*/) {
    CheckBox newBox = new CheckBox("My Label " + i);
    newBox.setSelected(true);
    newBox.setUserData(object);  //setting this object to access later
    newBox.selectedProperty().addListener(new ChangeListenerWithData(newBox) {
        public void changed(ObservableValue<? extends Boolean> ov, Boolean old_val, Boolean new_val) {
            //accessing user data
            context.getMyMap().get(this.getUserData().toString());
        }
    });
} 
```

我总是对更好的解决方案持开放态度，但与此同时，我希望这也能对某人有所帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-31T19:53:06.727

我有 and 的数组`CheckBoxes`，`TextFields`它们都使用相同的侦听器，我用`userData`它来判断哪个是哪个：

```
cb.setOnAction(new EventHandler<ActionEvent>() {
    @Override
    public void handle(final ActionEvent event) {
        final CheckBox source = (CheckBox) event.getSource();
        System.out.println(source.getUserData());
        }
    }); 
```

# python - 如何用逗号空格（pep8）替换所有逗号？

> ID：15118423
> 
> 赞同：2
> 
> 时间：2013-02-27T17:29:30.277
> 
> 标签：python, unix, vim

我写了一些 Python 代码，不幸的是忘记了逗号后的几个空格（试图遵循 Pep8）。如何用逗号后跟空格替换逗号。这里的技巧是一些逗号已经有空格，所以如果我做一个简单的搜索和替换，一些逗号后面会跟双空格。如果我用单个空格替换双空格，那么我的制表符（扩展为空格）会搞砸。

我正在寻找合适的 vim 命令，如果可能的话，还有合适的 unix 命令。我正在尝试这样做以遵循 pep8。有什么东西可以自动更正风格错误以遵循 pep8 吗？我找到了识别错误但不修复它们的模块。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T17:31:18.960

**蟒蛇解决方案**：

```
my_new_string = my_old_string.replace(',', ', ').replace(',  ', ', ') 
```

如果要在文件上运行它：

```
f = open('path/to/file')
my_file_contents = f.read()
f.close()
f = open('path/to/file', 'w')
f.write(file_contents.replace(',', ', ').replace(',  ', ', ')) 
```

**`vim`解决方案**：

```
:%s/,\ */,\ /g 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T17:32:38.990

vim 替换：

```
:%s/,\([^ ]\)/, \1/g 
```

人物班的领头人，不是这样说的`^`。`[]`所以它 ,`[^ ]`匹配任何不是空格的东西。

编辑，在空格后删除东西。`\(\)`保存东西，然后返回`\1`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T17:33:00.660

就自动更正错误而言，[autopep8](https://github.com/hhatto/autopep8)非常适合 - 它附带一个二进制文件，您可以使用它来纠正错误，尽管我担心我不知道您如何将它与 vim 联系起来。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-27T17:37:48.323

对于 vim 中的一次性替换：

```
:%s/\v,(\S)/, \1/g 
```

但是一定要使用 vim 插件。

# java - java不错的控制台输入

> ID：15118425
> 
> 赞同：2
> 
> 时间：2013-02-27T17:29:35.060
> 
> 标签：java, console

我正在尝试从 java 中的控制台读取一行。这是我的代码：

```
System.console().readLine("shell $ "); 
```

这行得通，但我想使用像箭头这样心爱的 linux 功能来移动光标（`^[[C`不像现在那样插入），向上箭头应该解决上一个命令，选项卡应该自动完成某些东西（这不是必需的，但很有用，我会对正确的箭头感到满意行为）。

而且——不，我想使用“纯 java”解决方案，而不是 libreadline 的 JNI 包装器。

JDK本身或某些提供此类功能的框架中是否有某些功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:43:14.373

java中没有这样的内置功能。为了能够做到这一点，即创建一个能够执行诸如循环以前的命令、使用箭头键移动等操作的控制台，需要为这些键编写一个动作处理程序，这在 java 中是不可能的（根据内置的功能），因为输入在java中被缓冲并且一旦你按下它就会被刷新`Enter`。

您可能可以在 JNI 中执行此操作，即 Java Native Language。据我所知，您可以查看[java console api](http://code.google.com/p/java-console-api/)，更多详细信息请参见此[博客](http://sachinhejip.blogspot.in/2009/01/extending-java-console.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T13:18:44.800

我必须自己回应。

我没有找到真正纯 Java 库来处理它，但毫无疑问它可以为 *nix 编写（System.in 实际上没有缓冲）。

我正在使用 jline2 ( [https://github.com/jline/jline2](https://github.com/jline/jline2) ) [https://github.com/jline/jline2now](https://github.com/jline/jline2now)因为它很小并且只需要二进制添加来支持 Windows；我已经测试了它的 jars，它们无需在我发现的*任何*nix 和 win32 操作系统上重新编译即可工作。*

所以，答案是：这是可能的，但没有人写过这样的 100% 纯库。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-28T12:05:15.413

来自 vmoksha 的 Sunilkumkar

```
 public class ReadConsoleSystem {
    public static void main(String[] a``rgs) { 
System.out.println("Enter something here : "); 
try{
    BufferedReader bufferRead = new 
     BufferedReader(new      InputStreamReader(System.in));
    String s = bufferRead.readLine(); 
    System.out.println(s);
}
catch(IOException e)
{
    e.printStackTrace();
}

  } 
```

# bash - Bash 读取行缓冲区溢出

> ID：15118427
> 
> 赞同：4
> 
> 时间：2013-02-27T17:29:39.863
> 
> 标签：bash, buffer-overflow, tee

我有一个 bash 脚本，它从文件中读取行，然后对这些行执行一些逻辑。

所以

```
while read line;
do
# some stuff
done < "$1" 
```

在 while 循环的主体中，我将一个命令的输出通过管道传输到`tee`. 当这个输出非常大时，大约 100K，下一次调用 read line 失败，while 循环在文件中的所有行被读取之前终止。

为什么会这样？我不是 bash 专家，但似乎正在发生某种缓冲区溢出。如果是这样，我该如何纠正？

感谢：D

编辑：所以一些澄清是为了。$1 是 bash 脚本的第一个命令行参数，它对应一个文件名。我正在做的是将输入文件的每一行作为参数提供给另一个程序。我正在将该程序的标准输出和标准错误传送到`| tee -a somefile`

我输入的程序是非标准的。根据我正在读取的文件行，该程序的输出可能非常大。

所以我正在做的一个更详细的例子是

```
while read line;
do
setSomeVar1
setSomeVar2
program --output="$setSomeVar1" -options "$line" 2>&1 | tee -a "$setSomeVar2"
done < "$1" 
```

谢谢，

-D

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:40:19.880

如果循环体中的任何其他内容从标准输入读取，您可以`read`从不同的文件描述符获取其输入（3 通常是免费的）：

```
while read -u 3 line; do
...
done 3< "$1" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-21T06:05:53.460

我自己也遇到了同样的问题，如果这么多年后有人还在看这个。

在该`# do some stuff`块中，无论您在那里运行的任何命令可能由于某种原因吸走标准输入，添加一个`< /dev/null`以便您明确地使该命令不接受标准输入。这对我有用。

# asp.net - 获取 System.Web 托管应用程序的 Owin 属性的最佳方式

> ID：15118428
> 
> 赞同：2
> 
> 时间：2013-02-27T17:29:44.667
> 
> 标签：asp.net, owin

我想从我的 Global.asax 中的 Owin IAppBuilder 实例中检索一个属性。我能想到的唯一方法是将 MapOwinPath 与我不关心的路径一起使用，以利用回调（参见下面的示例）。是否有一种更简洁的方式来访问 IAppBuilder 实例而无需注册假路由？

```
public static class HostingUtils
{
    private static readonly Lazy<CancellationToken> shutdownToken = new Lazy<CancellationToken>(GetOwinShutdownToken);

    public static CancellationToken ShutdownToken { get { return shutdownToken.Value; } }

    private static CancellationToken GetOwinShutdownToken()
    {
        CancellationToken? token = null;

        new RouteCollection().MapOwinPath("hack", "hack",
            map => token = map.Properties["host.OnAppDisposing"] as CancellationToken?);

        return token.GetValueOrDefault(CancellationToken.None);
    }
} 
```

# javascript - 使用 qunit 和 mockjax 进行测试

> ID：15118429
> 
> 赞同：3
> 
> 时间：2013-02-27T17:29:46.450
> 
> 标签：javascript, jquery, qunit, mockjax

我试图弄清楚如何使用 qunit 和 mockjax 充分地测试这个 javascript 函数

我的 javascript 设置了显示模块模式，我是单元测试的新手，所以这有点让我摸不着头脑

```
my.someMethod = function (someId, completedHandler) {
        $.ajax({
            dataType: "json",
            url: my.someUrl,
            traditional: true,
            data: {
                someId : someId
            },
            success: function () {

                if (completedHandler !== undefined) {
                    completedHandler();
                }
            }
        });
    }; 
```

就像我想测试是否使用了正确的 url，如果传入的 id 是正确的，确保调用 ajax 等等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:48:42.403

怎么样，最后自己想通了。

像这样构造它

在你的 javascript 方法中

```
my.someMethod = function (someId, completedHandler) {
        $.ajax({
            dataType: "json",
            url: my.someUrl,
            traditional: true,
            data: {
                someId : someId
            },
            success: function (data) {

                if (completedHandler !== undefined) {
                    completedHandler(someId, my.someUrl, data.testResult);
                }
            }
        });
    }; 
```

设置你的 mockjax

```
$.mockjax({
            url: "someActualUrl",
            dataType: 'json',
            responseText:
                {
                    testResult: 'AJAX Called'                           
                }
        }); 
```

在你的实际 qunit 测试中

```
test("someMethod calls ajax", function () {

        namespace.someMethod("id1",
            function (someId, someUrl, someTestResult) {
                test("someMethod ajax test", function () {

                    assert.strictEqual(someId, "id1");
                    assert.strictEqual(someUrl, "someActualUrl");
                    assert.strictEqual(someTestResult, "AJAX Called");
            });

        start();
    });

    ok(true, "Ajax Called");
}); 
```

# java - 具有静态方法的数组

> ID：15118433
> 
> 赞同：2
> 
> 时间：2013-02-27T17:29:53.787
> 
> 标签：java, arrays, methods, static

我正在尝试使用两种不同的静态方法来操作两个数组

1.  `double dot(double[]a, double[]b)`
2.  `double[][] multiply(double[][]a, double[][]b)`.

我似乎无法弄清楚如何使用静态方法将两个数组相乘并将那里的值输出给用户我相信我的点积方法很好。我知道我的乘法方法需要使用返回方法，但我不确定如何正确表示

这是我到目前为止所拥有的：

```
public class LibMatrix {

    public static void main(String[] args) {

        double[] a = { 8, 5, 6, 3, 2, 1 };
        double[] b = { 9, 8, 4, 1, 4, 7 };
    }

    public static double dot(double[] a, double[] b) {
        double sum = 0.0;
        for (int i = 0; i < a.length; i++)
            sum += a[i] * b[i];
        return sum;

    }

    public static double[][] multiply(double[][] a, double[][] b) {
        int n = 6;
        double[][] c = new double[n][n];
        for (int i = 0; i < n; i++)
            for (int j = 0; i < n; i++)
                c[i][j] = a[i][j] * b[i][j];
        return a;

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:34:50.217

没有足够的代表发表评论，但您在第二种方法中的返回值应该是 c

测试：

```
double [][] a = new double [6][6];
double [][] b = new double [6][6];

for(int i = 0; i< a.length;i++){
    for(int j = 0; j< a.length;j++){
        a[i][j] = 3;
        b[i][j] = 2;
    }
}
d = multiply(a,b); 
```

这将返回一个填充了 6s 的 6x6 矩阵，因此您的方法可以正常工作。

```
d = [6, 6, 6, 6, 6, 6,
     6, 6, 6, 6, 6, 6,
     6, 6, 6, 6, 6, 6,
     6, 6, 6, 6, 6, 6,
     6, 6, 6, 6, 6, 6,
     6, 6, 6, 6, 6, 6] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:42:40.437

以下是一些更正：

```
public class LibMatrixTests
{
   static class LibMatrix {
      public static double dot(double[] a, double[] b) {
         double sum = 0.0;
         for (int i = 0; i < a.length; i++)
            sum += a[i] * b[i];
         return sum;
      }
      public static double[][] mul( double[][] a, double[][] b ) {
         double[][] c = new double[a.length][a[0].length];
         for (int i = 0; i < a.length; i++)
            for (int j = 0; j < a[i].length; j++)
               c[i][j] = a[i][j] * b[i][j];
         return a;
      }
   }

   public static void main( String[] args ) {
      double[]   a = { 8, 5, 6, 3, 2, 1 };
      double[]   b = { 9, 8, 4, 1, 4, 7 };
      double[][] c = { a, b };
      double[][] d = { b, a };
      double     e = LibMatrix.dot( a, b );
      double[][] f = LibMatrix.mul( c, d );
      System.out.println( e );
      for( double[] g : f ) {
         for( double h : g ) {
            System.out.print( h + ", " );
         }
         System.out.println();
      }
   }
} 
```

输出：

```
154.0
8.0, 5.0, 6.0, 3.0, 2.0, 1.0, 
9.0, 8.0, 4.0, 1.0, 4.0, 7.0, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:50:12.320

在 multiply 方法中，第二个循环是错误的，j 总是 0，你应该返回 c 而不是 a

尝试这个

```
public static double[][] multiply(double[][] a, double[][] b) {
    int n = 6;
    double[][] c = new double[n][n];
    for (int i = 0; i < n; i++)
        for (int j = 0; j < n; j++)
            c[i][j] = a[i][j] * b[i][j];
    return c;

} 
```

# asp.net - 如何使用 ReportViewer 配置从网站到 SSRS 的连接

> ID：15118434
> 
> 赞同：0
> 
> 时间：2013-02-27T17:30:00.857
> 
> 标签：asp.net, sql-server-2008, reporting-services

我继承了一个使用 ReportViewer 的 ASP.NET 网站。

我遇到的问题是用于连接到报表服务器的凭据是具有管理员权限的 Windows 用户的凭据。我想将它们更改为具有所需最低凭据的 Windows 用户。

我的主数据库现在使用 Windows 身份验证，所以我已经有一个 Windows 用户，它可以访问主数据库的 db_datareader、db_datawriter。所以我给了相同的用户 db_datareader 对 ReportServer 数据库的权限。在 ReportServer 上使用的共享数据源中，我将“连接使用”设置为“运行报表的用户提供的凭据”，并将“连接到数据源时用作 Windows 凭据”设置为 true。

但是，当我将网站更改为使用该用户而不是管理员用户时，我得到“授予用户 'DomainName\UserName' 的权限不足以执行此操作。（rsAccessDenied）”

我需要授予该用户哪些其他权限才能使其正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T04:04:44.263

在我看来，好像用户在 Reporting Services 中没有权限访问相应的报告。您可能需要在 Reporting Services 中向该用户授予权限。您可以从 Report Manager 网站执行此操作。

我知道您授予了 Reporting Services 数据库的用户权限，但这与在 Reporting Services 中授予特定报表的权限不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T10:02:33.393

好的，这就是我实际所做的-

使用报告管理器：

1.  将系统用户角色分配给网站正在使用的 DomainName\UserName。查看[系统级权限](http://msdn.microsoft.com/en-us/library/aa337385%28v=sql.100%29.aspx)

2.  将浏览器角色分配给同一用户。请参阅[项目级权限](http://msdn.microsoft.com/en-us/library/aa337471%28v=sql.100%29.aspx)。现在网站中的报表查看器可以工作，但它会提示用户输入凭据（我不想要）。

3.  将共享数据源更改为“使用 Windows 集成安全性连接”。现在该报告在网站上运行。

然后作为 Sql Server 中的一个实验，我从 ReportServer 数据库中删除了用户。该网站仍然有效，所以我想从来不需要许可。

# sql - 我有一个日期类型为 date_returned 的字段，最佳做法是什么？

> ID：15118439
> 
> 赞同：0
> 
> 时间：2013-02-27T17:30:28.153
> 
> 标签：sql, database

我有一个日期类型为 date_returned 的字段，最佳做法是什么，当输入一行时，它会给出“0000-00-00”，还是最好将其设置为 NULL？

当我在其中插入数据并错过了它给出的值的字段时：

'0000-00-00'。

目前这对我来说很好，但设置为 NULL 是否更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:41:20.947

NULL 可以帮助您在此处使用 WHERE 子句。无论如何，业务需求是您关心的第一件事和最后一件事。

[我在这里](https://stackoverflow.com/questions/1583677/is-it-good-practice-to-set-all-database-columns-as-not-null)遇到了一个类似的线程，在这种情况下对我来说非常有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:32:37.087

最佳实践是满足您的业务需求。

# android - Android-注解和继承

> ID：15118442
> 
> 赞同：8
> 
> 时间：2013-02-27T17:30:31.890
> 
> 标签：android, android-annotations

我在使用 android-annotations 和继承时遇到了问题：

```
@EFragment(R.layout.fragment_foo)
public class TestBaseFragment {
    @AfterViews
    public void afterTestBaseFragmentViews() {
   }
}

@EFragment(R.layout.fragment_foo)
public class TestFragment extends TestBaseFragment {
    @AfterViews
    public void afterTestFragmentViews() {
   }
} 
```

生成：

```
public final class TestFragment_
    extends TestFragment
{
    ...

    private void afterSetContentView_() {
        afterTestFragmentViews();
        afterTestBaseFragmentViews();
    }
    ... 
```

如何确保在 afterTestFragmentViews() 之前调用 afterTestBaseFragmentViews() ？或者你能给我指出任何描述如何使用 AndroidAnnotations 进行继承的文档吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-27T18:32:31.913

**这只是某种解决方法**

使用抽象类：

```
@EFragment(R.layout.fragment_foo)
public abstract class TestBaseFragment {

    @AfterViews
    protected void afterTestBaseFragmentViews() {
        // do something
        afterView();
    }

    protected abstract void afterView();

}

@EFragment(R.layout.fragment_foo)
public class TestFragment extends TestBaseFragment {

    @Override
    protected void afterView() {
        // do something after BaseFragment did something
    }

} 
```

使用简单的子类化：

```
@EFragment(R.layout.fragment_foo)
public class TestBaseFragment {

    @AfterViews
    protected void afterTestBaseFragmentViews() {
        afterView();
    }

    public void afterView() {
        // do something
    }

}

@EFragment(R.layout.fragment_foo)
public class TestFragment extends TestBaseFragment {

    @Override
    public void afterView() { 
        super.afterView();
        // do something after BaseFragment did something
    }

} 
```

我希望这就是你要找的。（未测试 - 只是用记事本写的）

# java - ClassNotFoundException：javax.lang.model.element.Element

> ID：15118443
> 
> 赞同：0
> 
> 时间：2013-02-27T17:30:36.413
> 
> 标签：java, axis2, classnotfoundexception

我使用 Eclipse 创建了一个 Web 服务 (Axis2) 并部署到 Glassfish 服务器。

Axis2-web 运行良好，但是当我请求我的服务的 WSDL 时，我只是得到一个 expcetion：

```
Caused by: java.lang.NoClassDefFoundError: javax/lang/model/element/Element
    at com.sun.tools.ws.processor.modeler.annotation.WebServiceWrapperGenerator.<init>(WebServiceWrapperGenerator.java:130)
    at com.sun.tools.ws.processor.modeler.annotation.WebServiceAp.process(WebServiceAp.java:181)
    at com.sun.tools.javac.processing.JavacProcessingEnvironment.callProcessor(JavacProcessingEnvironment.java:793)
    at com.sun.tools.javac.processing.JavacProcessingEnvironment.discoverAndRunProcs(JavacProcessingEnvironment.java:722)
    at com.sun.tools.javac.processing.JavacProcessingEnvironment.access$1700(JavacProcessingEnvironment.java:97)
    at com.sun.tools.javac.processing.JavacProcessingEnvironment$Round.run(JavacProcessingEnvironment.java:1029)
    at com.sun.tools.javac.processing.JavacProcessingEnvironment.doProcessing(JavacProcessingEnvironment.java:1163)
    at com.sun.tools.javac.main.JavaCompiler.processAnnotations(JavaCompiler.java:1108)
    at com.sun.tools.javac.main.JavaCompiler.compile(JavaCompiler.java:824)
    at com.sun.tools.javac.main.Main.compile(Main.java:439)
    ... 42 more
Caused by: java.lang.ClassNotFoundException: javax.lang.model.element.Element not found by com.sun.xml.bind [150]
    at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1460)
    at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:72)
    at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1843)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    ... 52 more 
```

通常a`NoClassDefFoundError`意味着缺少依赖项，但'javax.lang.model.element.Element'来自JRE（'rt.jar'），所以我不知道这里有什么问题。

**更多详细信息：** Eclipse Juno、Glassfish 3.1.2、Axis2-1.6.2、动态 Web 项目

# json - 以 json 为参数的 Web API

> ID：15118446
> 
> 赞同：1
> 
> 时间：2013-02-27T17:30:51.323
> 
> 标签：json, asp.net-mvc-4, asp.net-web-api, json.net

我正在使用 asp.net MVC4，尝试使用 HTTP Post 操作实现一些 Web API。其中一些操作需要 Json 作为参数，这是我的方法的签名：

```
 [HTTPPost]
  public void notificationValueChanged(JObject data)
    {
        dynamic json = data;
        string boxSN = json.boxSN;
        string nodeID = json.nodeID;
        string propertyName = json.propertyName;
        string instanceId = json.instanceId;
        string propertyKey = json.propertyKey;
        string newValue = json.newValue;
        DateTime timestamp = json.timestamp;

        // ....

   } 
```

[现在的问题是，当我通过https://chrome.google.com/webstore/detail/rest-console/cokgbflfommojglbmbpenpphppikmonn/related](https://chrome.google.com/webstore/detail/rest-console/cokgbflfommojglbmbpenpphppikmonn/related)测试我的 web api 时，我收到一条错误消息，指出我的参数无法作为 Json 文件加载。

但是，当使用 ajax 在本地使用我的 Web API 时，它确实可以正常工作。但是在我将它部署在 IIS 服务器上并尝试从其他服务器（exp ACS）访问此 web api 之后，它没有获取输入的数据类型。

任何有关如何解决此问题的建议将不胜感激。

# windows - 子网中的活动节点 (SendARP)

> ID：15118449
> 
> 赞同：0
> 
> 时间：2013-02-27T17:30:56.593
> 
> 标签：windows, network-programming, arp, iocp

全部，

我正在尝试在我的子网中查找活动节点。为此，我将 ARP 发送到子网中的所有节点。这是正确的方法吗？如果这是正确的方法，是否有任何使用 IOCompletion 端口或类似线程概念处理此问题的好方法？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T21:53:29.210

我不确定 IOCompletion，但是是的，这是查找子网上所有节点的可接受方式。流行的网络扫描器 nmap 在您扫描网络时（如果您至少有创建 ARP 数据包的权限）会执行此操作，发送所有 IP 地址的 ARP 请求并检查它是否获得唯一的 MAC 地址回复（如果不是唯一的，它可以通过路由器或某种网络实用程序作为代理 ARP，通过声明所有未使用的 IP 来使扫描更加困难）。

# c++ - 为什么我不能使用 using 来消除基本成员变量之间的歧义？

> ID：15118454
> 
> 赞同：1
> 
> 时间：2013-02-27T17:31:04.880
> 
> 标签：c++, iso, using-directives, method-resolution-order

在这个简单的类层次结构中，我试图让 C 类通过告诉它“使用 B::x”来消除使用哪个 x 的歧义，但这不能在 G++ 中编译，因为它仍然无法弄清楚我的意思是哪个 x函数 foo。我知道 using 可用于提升隐藏方法，但为什么不能使用变量？我考虑过将 X 类作为 A 和 B 的虚拟基础，并为 X 定义，但这并不是我想要的；我想要的是 A:x 直接从它派生的东西使用，除了从 B 派生时，有点像 Python 用它的成员（名称）解析顺序算法做它的方式（最后一个类获胜，所以在这种情况下 B:x使用，请参阅[http://starship.python.net/crew/timehorse/BFS_vs_MRO.html](http://starship.python.net/crew/timehorse/BFS_vs_MRO.html)了解说明。）

我对 ISO C++ 2011 在这方面存在缺陷的评估是否正确？使用“使用”来消除基本成员变量的歧义是不可能的？

```
class A {
protected:
    int x;
};

class B {
protected:
    int x;
};

class C : public A, public B {
protected:
    using B::x;

public:
    int foo(void) { return x; }
}; 
```

编辑：编译器版本：g++ (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-15T09:32:19.607

它适用于 C++11 和 g++ 4.8：http: [//ideone.com/oF4ozq](http://ideone.com/oF4ozq)

```
#include <iostream>
using namespace std;
class A {
protected:
    int x = 5 ;
};

class B {
protected:
    int x = 42 ;
};

class C : public A, public B {
protected:
    using B::x;

public:
    int foo(void) { return x; }
    int fooa(void) { return A::x; }
     int foob(void) { return B::x; }
};
int main() {
    C c;
    std::cout<<c.foo()<<std::endl;
    std::cout<<c.fooa()<<std::endl;
    std::cout<<c.foob()<<std::endl;
    return 0;
} 
```

# javascript - 是否可以在同一个事务中嵌套句子？

> ID：15118455
> 
> 赞同：0
> 
> 时间：2013-02-27T17:31:05.557
> 
> 标签：javascript, html, sqlite, asynchronous, web-sql

我目前正在使用 WebSql 的异步 API。鉴于此代码：

```
 db.transaction(
            function (tx) {                      
                tx.executeSql("SELECT * FROM table",
                    [],
                    function(t, resultSet){ //Anonimous function implementing SQLStatementCallback
                        t.executeSql(...); //#1 
                    }
                ); 
            },
            function (err) {
                console.error("Error in transaction");                         
            },
            function(){
                console.log("Transaction complete"); //#2                  
            }   
        ); 
```

我在规范中找不到这个。in 第三个参数`executeSql`是一个实现的函数[`SQLStatementCallback`](http://www.w3.org/TR/webdatabase/#sqlstatementcallback)。此接口中的第一个参数是另一个[`SQLTransaction`](http://www.w3.org/TR/webdatabase/#sqltransaction)（在我的代码中命名为 t）。是否可以使用该事务对象继续执行语句？尤其：

1.  是`t`一样的`tx`吗？
2.  我可以`t`用来执行另一个 SQL 语句吗？在这种情况下，#1 可以保证在 #2 之前运行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T06:21:03.257

1.  是的，交易对象在 和 中是相同`t`的`tx`。

2.  是的，在 2# 之前运行 1# 是被授予者，因为您已经监听了 onsuccess 处理程序回调。我想实现请求的排序，我使用`t`. 每当我想让然后并行运行时，我都会使用`tx`. 请参阅我的[websql 请求执行器](https://bitbucket.org/ytkyaw/ydn-db/src/6b115d3b6f828b537c0b3d5cc9ec8b26c6013eb1/js/ydn/db/core/req/websql.js)实现 YDN-DB 库中的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:52:01.263

是的，这就是 WebSQL API 的工作方式。

由于异步执行，这是在一个事务中执行多个命令的*唯一方法。*

# javascript - 初始化后是否可以取消初始化 jQuery 插件？

> ID：15118461
> 
> 赞同：1
> 
> 时间：2013-02-27T17:31:18.390
> 
> 标签：javascript, jquery, plugins

我正在寻找一种在元素上使用 jQuery 插件后对其进行反初始化的方法。这是一个滑块，在某个动作或某种情况出现后，它会失去插件应用到它的所有行为。

这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T17:31:46.470

只有插件提供了这样做的方法，这才是*真正可能的。*一个写得很好的应该，通常通过提供一个名为`destroy`. 例如，在 jQuery UI 中，您可以像这样从元素中删除日期选择器：

```
$("selector").datepicker("destroy"); 
```

如果插件不提供这样做的方法，它就会变得有点棘手。您可以在不克隆事件和数据的情况下克隆元素，然后用克隆替换原始元素，但这不太可能在所有情况下都有效，并且确实是一种黑客解决方法，而不是其他任何方法。

# java - 有没有办法用杰克逊松散地解析 JSON？

> ID：15118468
> 
> 赞同：0
> 
> 时间：2013-02-27T17:31:36.000
> 
> 标签：java, json, jackson, jerkson

例如，如果

```
key1:value1,key2:value2 
```

被传递到解析器，我希望它被视为相同：

```
{"key1":"value1","key2","value2"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:56:05.833

你所拥有的不是 JSON。但是，我认为它可能只是 YAML，所以如果您喜欢这样的符号，请查看 YAML 解析器。

# ruby-on-rails - 控制器中的 Rails 部分

> ID：15118469
> 
> 赞同：0
> 
> 时间：2013-02-27T17:31:36.760
> 
> 标签：ruby-on-rails, partials

我有一个几乎在我的三个控制器中重复的代码，我想知道：有没有办法在控制器中渲染部分？我会澄清一下，我想编写相同的 ruby​​ 代码并在每个控制器中呈现它。有人知道这样做的方法吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T17:36:53.880

我对你的问题很困惑；我看不出它与局部有什么关系。但是，如果我理解正确，您所拥有的是类似的东西。

```
class FooController < ApplicationController
  def my_method
  end
end

class BarController < ApplicationController
  def my_method
  end
end

class BazController < ApplicationController
  def my_method
  end
end 
```

你想通过将`my_method`方法抽象到一个地方来干掉它。解决方案是在 上定义它`ApplicationController`，其他三个控制器都继承自它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:32:49.927

有两种解决方案，模块和玩继承

### 模块

使用您的自定义代码定义一个模块并将其包含在您的控制器中

```
module MyCustomModule
  def method_1
    #code ...
  end

 def method_2
    #code ...
  end

  def method_2
    #code ...
  end
end 
```

然后在你的控制器中：

```
class MyController < AplicationController
  include MyCustomModule
end 
```

### 遗产

如果您不介意所有控制器都以这些方法结束，只需在应用程序控制器中定义它们

```
class ApplicationController < ActionController::Base
  # ...

  def method_1
    #code
  end

  # And so on ...
end 
```

# ruby - 创建哈希时省略空值

> ID：15118475
> 
> 赞同：1
> 
> 时间：2013-02-27T17:31:58.850
> 
> 标签：ruby

我创建了一个包含许多键的散列，并且我想省略具有`nil`值的键：

```
h = {
  :key0 => val0,
  :key1 => val1, # I want to include this key only if val1 is not nil
  :key2 => val2
} 
```

除了

```
if val1
  h = {
    :key0 => val0,
    :key1 => val1,
    :key2 => val2
  }
else
  h = {
    :key0 => val0,
    :key2 => val2
  }
end 
```

类似的东西

```
h = {
  :key0 => val0,
  :key1 => val1 if val1, # gives an error
  :key2 => val2
} 
```

编辑：感谢到目前为止的回复，真的很有用。有没有一种方法可以定义哈希文字而无需事后处理？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:03:42.430

您可以尝试[Hash#keep_if](http://www.ruby-doc.org/core-2.0/Hash.html#method-i-keep_if)方法。该方法从 hsh 中删除块评估为 false 的每个键值对。

```
h = { :key0 => 'val0',:key1 => nil,:key2 => 'val2',:key4 =>nil}

h.keep_if {|key,value| !value.nil?} 
```

> {:key0=>"val0", :key2=>"val2"}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:38:41.710

“delete_if”方法可以通过让步到一个块来删除某些元素。如果该块为某个元素返回 true，则该元素将被删除。然后，您的代码应如下所示，以便删除值为 nil 的元素：

```
val0 = true
val1 = nil
val2 = true

h = {
  :key0 => val0,
  :key1 => val1, # I want to include this key only if val1 is not nil
  :key2 => val2
}

h.delete_if{ |key, val| val.nil? }

puts h #=> {:key0=>true, :key2=>true} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:39:05.250

最简单的方法是进行选择：

```
{ :key0 => 1, :key1 => nil }.select {|_,v| v } 
#=> { :key0 => 1 } 
```

在这种情况下，如果`v`是 'falsey'（要么 要么`false`）`nil`，则省略该对。

# asp.net - 一种检查新内容并下载它的方法

> ID：15118477
> 
> 赞同：0
> 
> 时间：2013-02-27T17:32:02.277
> 
> 标签：asp.net, asp.net-mvc, asp.net-web-api

我有一个桌面客户端，它通过 ASP.NET Web API 检查服务器上的**新内容**并将其保存在本地。类似于电子邮件客户端的东西。

但我不知道实现这一点的最佳方法是什么，我的意思是我应该有一个控制器来检查是否有新内容，然后客户端调用另一个控制器来下载它，还是什么？

任何线索表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:40:24.047

此处描述了restful方法[从Web Api控制器返回http状态代码，](https://stackoverflow.com/questions/10655350/returning-http-status-code-from-asp-net-mvc-4-web-api-controller)您需要将上次更新时间带入控制器方法，使用它来检查该日期是否已进行更改，如果尚未更改，则返回HTTP 状态码 304 Not Modified 并省略响应；但是，如果它已更改，则以 200 OK 正常发送资源。

就我个人而言，我会通过管理通过 http 标头和 etag 的最后更新来稍微修改上面提到的方法。阅读[这里](http://www.rapidsnail.com/Tutorial/t/2012/108/2/1090/the-http-response-last-modified-and-etag-and-aspnet-web-api-realize.aspx)以获得更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:45:02.230

大多数人使用轮询方法，应用程序在系统最后一次检查更新时传递日期或标识符，然后将任何新更新流式传输到桌面客户端。您需要做的就是调用一个方法来检查数据库在特定时间的更新，流式传输新的，然后将新的添加到结果集中（或刷新整个结果）。

```
public class UpdatesController : ApiController
{
   public object Get(long millisecondsAsOf)
   {
     //Query from DB, return  results, or return true/false if there are new records.
   }
} 
```

# c# - Check if button press results in any code being executed

> ID：15118483
> 
> 赞同：2
> 
> 时间：2013-02-27T17:32:25.663
> 
> 标签：c#, .net, visual-studio, silverlight, visual-studio-2012

I have taken over a large Silverlight project and been asked to do some basic maintenance to it. One such piece of maintenance is simply to call a method when the user clicks the browsers back button. The previous developer, now away on leave, assures me that the browser back button being pushed invokes a method call "somewhere" in the project.

The problem being that "somewhere" could mean anywhere in roughly 60,000 lines of code. I don't have time to spend tracking this down. So what I am looking for is basically to insert a breakpoint in every single line of my code, press the back button, and see what gets triggered. From there I can step through things to add the functionality requested.

Is there an intelligent way for me to do this that I am overlooking ? Please tell me there is some magical "Insert breakpoints everywhere" button that I've just been overlooking up to now because...why would you ever need to insert breakpoints everywhere?! ;)

Thanks a lot.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:54:22.550

Do a global search in the solution/project for the string: "Navigat" (not whole word). If the browser back-button click is detected and some logic performed, it is very likely this is detected and handled within an override of one of the event handlers whose name is some variation of "OnNavigatedTo" or "OnNavigatingFrom". The NavigationMode enumeration has a "Back" member which can be the way it is determined that the "Back" button has been clicked, so a search for "NavigationMode.Back" might turn it up as well. Good Luck!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:52:30.543

may be search entire solution for

```
 if (navigationService.CanGoBack)
                    navigationService.GoBack(); 
```

# objective-c - 使用 Quartz 设置圆形填充颜色

> ID：15118489
> 
> 赞同：0
> 
> 时间：2013-02-27T17:32:37.943
> 
> 标签：objective-c, ipad, quartz-graphics

我想为圆圈添加填充颜色。此代码不起作用：

```
 CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetLineWidth(context, 2.0);
    CGContextSetRGBStrokeColor(context, 0, 0, 225, 1);
    CGContextSetRGBFillColor(context, 0, 255, 0, 1);
    CGContextAddArc(context, pointWhereUserClickedX, pointWhereUserClickedY, 50, 0, 2*3.14159265359, YES);
    CGContextDrawPath(context, kCGPathStroke); 
```

怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:43:26.403

必须在最后一行使用：

CGContextDrawPath（上下文，kCGPathFillStroke）；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:53:58.773

你没有用填充颜色填充圆圈。

```
 - (void)drawRect:(CGRect)rect { 
     //your code and add this line:
     CGContextFillEllipseInRect(contextRef, rect);
   } 
```

# jquery-mobile - 如果我们在 websql 事务中渲染，backbonejs jquery 移动视图渲染会搞砸

> ID：15118493
> 
> 赞同：0
> 
> 时间：2013-02-27T17:32:43.353
> 
> 标签：jquery-mobile, backbone.js, backbone-views

伙计们，考虑一下咖啡脚本中的以下视图：

```
window.Aview = class AView extends Backbone.View

  getT: (callback) =>
    callback()

  getTransactions: (callback) =>
    @getT( =>
      callback()
    )            
  render: =>
   @getTransactions(
     (results) =>
       $(@el).html(@template({}))
   ) 
```

这按预期呈现（如下所示）： ![正确呈现选项卡](../Images/22d5429883ae9d5b6ff3428cc3f57ab5.png)

但是，如果我将getTransactions中的逻辑更改为使用window.db.transaction（window.db指向一个websql db变量），如下所示：

```
 getTransactions: (callback) =>
    window.db.transaction( =>
      callback()
    ) 
```

然后渲染搞砸了，如下所示：

![当我们使用 window.db.transaction 时渲染不正确](../Images/48187bc5eef89df51e45f3587ff76577.png)

我不确定为什么会这样。我认为这很可能不是使用backbonejs的方式，但我很好奇为什么当我使用window.db.transaction而不是本地定义的getT方法时jquery mobile tab的渲染会变得混乱。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T16:56:00.130

我弄清楚了这个问题。正如我所怀疑的那样，我在多个层面上都做错了。这里的目标是呈现来自 websql 数据库的数据。问题是数据库数据通过回调异步返回。您的视图需要以某种方式“等待”直到数据完成。正确的方法是

1.  使用 jquery deferreds（参见[http://eng.wealthfront.com/2012/12/jquerydeferred-is-most-important-client.html](http://eng.wealthfront.com/2012/12/jquerydeferred-is-most-important-client.html)文章）
2.  在主干js视图的渲染方法中——使用常规主干js渲染机制渲染没有数据的页面
3.  使用 jquery promise 接口渲染动态内容（查询异步返回的数据）： txnsLoadedPromise.then( // 在此处渲染动态内容 )
4.  调用触发器创建以应用 jquery 增强功能（请参阅[http://view.jquerymobile.com/1.3.0/docs/faq/injected-content-is-not-enhanced.php](http://view.jquerymobile.com/1.3.0/docs/faq/injected-content-is-not-enhanced.php) ）我搞砸 UI 的原因是因为jquery 增强需要以编程方式应用于动态 DOM 元素。

# php - 从静态方法访问非静态属性

> ID：15118495
> 
> 赞同：17
> 
> 时间：2013-02-27T17:32:45.087
> 
> 标签：php, static

```
class database{
    protected $db;

    protected function connect(){
        $this->db = new mysqli( /* DB info */ ); // Connecting to a database
    }
}

class example extends database{
    public function __construct(){
        $this->connect();
    }

    public static function doQuery(){
        $query = $this->db->query("theQuery");   // Not working.
        $query = self::$db->query("theQuery");   // Not working.
        $query = parent::$db->query("theQuery"); // Also not working.
    }
} 
```

我想做这样的事情，但我找不到可行的方法，该属性必须是静态的......

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2016-10-15T05:08:51.273

您可以通过实例化一个新对象 ( `$self = new static;`) 来访问。示例代码：

```
class Database{

    protected $db;

    protected function connect(){
        $this->db = new mysqli( /* DB info */ ); // Connecting to a database
    }
}

class Example extends Database{

    public function __construct(){
        $this->connect();
    }

    public static function doQuery(){

        $self = new static; //OBJECT INSTANTIATION
        $query = $self->db->query("theQuery");   // working.

    }
} 
```

这与调用相同， `$self = new Example;`但更以编程方式调用，如果类名发生更改，则不需要更新。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-27T17:33:36.890

您不能从静态方法访问非静态属性。非静态属性只属于实例化对象，其中每个实例化对象都有一个单独的属性值。

我将举例说明，**此代码不起作用**：

```
class Example {
    public $a;

    public function __construct($a) {
        $this->a = $a;
    }
    public static function getA() {
        return $this->a;
    }
}

$first = new Example(3);
$second = new Example(4);

// is $value equal to 3 or 4?
$value = Example::getA(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-26T09:53:28.327

正如 Marko 所说，您不能从静态方法访问非静态属性。如果可能，将您的属性更改为静态，然后您的代码就可以工作。

我做了这样的事情..

```
class Member_DashBoard extends Page {

  public static $lapsed_id = 4; //Membership lapsed status id

    //calling static function by passing static property
    $status_custom = self::getMembershipStatusLapsed(self::$lapsed_id);//
                $status_custom_id = $status_custom['id'];

      public static function getMembershipStatusLapsed($membershipStatusId) {

        $statusDetails = array();
        $membershipStatus = new Core_MembershipStatus();
        $membershipStatus->id = $membershipStatusId;
        if ($membershipStatus->find(TRUE)) {
          Core_DAO::storeValues($membershipStatus, $statusDetails);
        }

        return $statusDetails;
      }

    } 
```

希望它可以帮助某人:)

- 干杯

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-03-20T22:08:20.997

您可以从静态方法访问私有或受保护的属性

```
class foo {
  private $x;
  static public function create()
  {
    $obj = new self();
    $obj->x = 22;
    return $obj;
  }
}

$y = foo::create();
var_dump($y);
// object(foo)[1]
//  private 'x' => int 22

// ----------------------
// this could just as easily be a normal method $bar->modify();

class bar {
  private $x;
  static public function modify(bar $bar)
  {
    $bar->x = 23;
  }
}

$bar = new bar();
bar::modify($bar);
var_dump($bar);
// object(bar)[2]
//  private 'x' => int 23 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-11T20:01:10.357

最好在创建对象时确定对象的规格，听起来您的对象规格与您选择的模式不匹配。

一般来说，你应该问自己，“我只需要一个对象的一个​​实例（静态）还是多个？”

对于此特定实例（连接并查询数据库），除非您需要建立与数据库的多个连接，否则不建议为数据库对象实例化对象。

因此，您有一个实例化对象与静态对象的用例。多个并发连接可能会使数据库过载，具体取决于配置以及在单次执行中创建连接的次数。

因此，考虑到这一点，有几种用于 PHP 的 OOP 设计“模式”可用于帮助对象/s 的体系结构。请参阅[http://www.slideshare.net/RobertGonzalez/object-orientated-design-patterns-for-php-presentation](http://www.slideshare.net/RobertGonzalez/object-oriented-design-patterns-for-php-presentation)了解更常见的模式。

对于一个工作示例[http://ideone.com/6qxvqx](http://ideone.com/6qxvqx)

***请注意***，我将 mysqli 重命名为 mysqli2 并创建了一个假类来处理查询，并为连接和对象创建添加了一些跟踪。

```
<?php

interface iDatabase
{
   static public function execute();
   public function instantiatedExecute();
}

abstract class database implements iDatabase
{

    protected static $conn;

    /**
     * create an instance of database that uses the same connection across all instances
     */
    final public function __construct()
    {
        self::connect();
    }

    /**
     * Connect to a database if not already connected
     */
    final protected static function connect()
    {
        if (null === self::$conn || false === (self::$conn instanceof mysqli)) {
            self::$conn = new mysqli( /* DB info */ );
            //add error checking here...
        }
        return self::$conn;
    }

   /**
    * query database connection
    */
   final public function query($query)
   {
       return self::doQuery($query);
   }

   /**
    * static query database connection
    */
   final public static function doQuery($query)
   {

      //sanitize query here if desired
      return self::connect()->query($query);
   }

}

class example extends database
{

    /**
     * example specific static execution
     */
    public static function execute($query)
    {
        self::doQuery($query);
    }

    /**
     * example specific non-static execution
     */
    public function instantiatedExecute($query)
    {
       $this->query($query);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T17:40:27.543

类似的帖子[在这里](https://stackoverflow.com/a/2042829/1821057)

从静态方法调用非静态方法的唯一方法是拥有一个包含非静态方法的类的实例。根据定义，非静态方法是在某个类的实例上调用的方法，而静态方法属于类本身。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-25T18:50:38.723

我尝试了这段代码，并且非常好用：

```
class Router{
public function route($url){
var_dump($url);
}
} 
```

在课外甚至在课外使用此方法：

```
require_once('Router.php');
Router::route('/test/test'); 
```

因此可以在静态模式下访问公共方法

# css - 减少边框右侧的长度

> ID：15118498
> 
> 赞同：3
> 
> 时间：2013-02-27T17:33:00.410
> 
> 标签：css

我有一个边界：

```
.verticalLineTop {
    border-top:solid #6E6A6B;
    border-width:1px;
    width: 130px;
} 
```

我正在硬编码宽度以修剪边框右侧的一部分，这可以使用 css 完成吗？

所以而不是：

```
________________________ 
```

这显示：

```
____________________ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:35:48.687

您不能设置部分 CSS `border-top`，它的全部或全部。

如果您总是希望上边框占宽度的某个百分比，则可以嵌套一个具有百分比宽度的元素。

```
.verticalLineTop
{
    width:80%;
    border-top:solid 1px #000;
} 
```

***现场演示：http:** [//jsfiddle.net/P3RKB/1](http://jsfiddle.net/P3RKB/1)*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-26T01:35:09.377

```
.verticalLineTop:before
 {
   width:80%;
   border-top:solid 1px #000;
   content: "";
   display: block;
   padding-top: 10px;
 } 
```

# javascript - 存根 dojo 请求

> ID：15118501
> 
> 赞同：0
> 
> 时间：2013-02-27T17:33:11.050
> 
> 标签：javascript, ajax, json, dojo

鉴于以下...

```
api.checkIn = function (theUserID) {
    var uri;
    uri = 'some/uri/here/' + theUserID;
    return req.get(uri, {
        handleAs: 'json'
    });
};

api.checkIn(userID).then(function (res) {
  _displayMessage("Attendance Saved.");
},
function(error){
  console.log("An error occurred: " + error);
}); 
```

我希望测试“theUserID”，如果有问题完全绕过远程请求，并让返回的 Promise 对象触发它的错误方法。

我还想通过返回一个承诺对象但自动调用传递它的 JSON 的“成功/结果”函数来存根远程请求以进行测试，而不实际进行远程调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T10:20:29.860

假设您的代码使用的是 AMD、dojo 1.7 或 1.8。这应该可以解决问题：

```
api.checkIn = function (theUserID) {
    var promise = new Deferred(); // you'll want to require dojo/Deferred
    if(notValid(theUserID)){ // you'll need to implement your own validity test here
        promise.reject("your error of choice here");
    } else {
        promise.resolve("your response of choice here");
    }
    return promise;
}; 
```

您可能还想查看[dojo/Deferred](http://dojotoolkit.org/reference-guide/1.8/dojo/Deferred.html)上的文档。

# vb.net - Crystal 报告将数字显示为哈希 #

> ID：15118504
> 
> 赞同：-1
> 
> 时间：2013-02-27T17:33:19.680
> 
> 标签：vb.net, ado.net, crystal-reports, sap

我有一个 Access 数据库，其中有一些数字字段水晶报告正在正确处理其他所有内容，但数字作为哈希并且不知道为什么但是当我将其导出为 PDF 时，一切都恢复正常.....这些字段在数字中数据库使用 VS2010 ACCDB2010 SAP CRYSTAL REPORTS....？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T21:39:58.767

假设您可以访问设计工具，您可以轻松更改列的格式。

选择字段后，单击一次：

![在此处输入图像描述](../Images/5dbacbb68deb96615ad30fac9c045655.png)

然后，单击两次：

![在此处输入图像描述](../Images/daf4e2a3dc41cfbe0665c9ba384ab39d.png)

然后它应该看起来像这样：

![在此处输入图像描述](../Images/113a68f41707ed97a32475a08f573f54.png)

# api - JSON错误响应，有条件的疯狂

> ID：15118513
> 
> 赞同：0
> 
> 时间：2013-02-27T17:33:41.300
> 
> 标签：api, node.js, error-handling

我有一个[请求](https://github.com/mikeal/request)，它返回一个 JSON 正文。我已经绘制出许多不同的响应和响应中可能存在的值。我试图把 JSON 吐出来。

我意识到大多数 APIS 一次只吐出一个错误，但它们是另一种选择，如果您考虑表单验证中的错误消息（例如 char 长度、char、已经采用），您希望同时处理所有这些错误，并且一次得到一个会很烦人。

我的问题是：是否有一种合理的清洁方式来委派嵌套或长 if 语句？

我可以使用条件语句的数组或对象吗？有没有一个模块可以做到这一点？

```
var output = {};
output.errors = [];

request(options, function(err, response, body){
    if(err){
        output.errors.push("request error ["+err.message+"]");
    }else{

        if((typeof request !== "undefined") && response && dotty.exists(response, "statusCode") && response.statusCode !== 200){
                output.errors.push("response status code "+response.statusCode);
        }

        if((typeof body !== "undefined") && body){
            if(dotty.exists(body, "countryCode") &&  dotty.exists(body, "countryName") &&  body.countryCode == "-" && body.countryName == "-"){
                output.errors.push("no country code or name present in response");
            }else if(body && dotty.exists(body, "countryCode") &&  body.countryCode == "-" &&  body.countryCode !== "" ){
                output.errors.push("no country code in response");
            }else if(body && dotty.exists(body, "countryName") && body.countryName == "-" &&  body.countryCode !== "" ){
                output.errors.push("no country name in response");
            }

            if(dotty.exists(body, "statusCode") && body.statusCode == "ERROR"){
                output.errors.push(body.statusCode);
            }

            if(dotty.exists(body, "countryCode") &&  body.countryCode !== "-" &&  body.countryCode !== "" ){
                if(!dotty.exists(output,"country")) output.country = {};
                output.country.code = body.countryCode;
            }

            if(dotty.exists(body, "countryName") &&  body.countryName !== "-" &&  body.countryCode !== "" ){
                if(!dotty.exists(output,"country")) output.country = {};
                output.country.name = body.countryName;
            }            
        }else{
            output.errors.push("no body");
        }
    }
    if(output.errors.length == 0) output.errors = false;
    res.jsonp(output);
} 
```

这种疯狂的极限是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T22:51:20.703

我使用了节点模块[async](https://github.com/caolan/async)，它有一个非常好的函数[`waterfall()`](https://github.com/caolan/async#waterfalltasks-callback)，它有助于划分过程中发生的每一件事。

# html - 当父级设置宽度时，将子级 div 的宽度设置为 100%

> ID：15118515
> 
> 赞同：1
> 
> 时间：2013-02-27T17:33:45.333
> 
> 标签：html, css

我的问题是，我有一个设置为 712px 宽的父 div。在其中我需要一个 100% 宽度（窗口宽度）的轮播。在那个旋转木马下面，我需要页脚。

问题是页脚位于轮播下方。如何使轮播占据动态高度，以便页脚出现在其下方而不是在其下方？

```
<div id="wrapper">
  <div id="content">
    This is some content above the carousel.
    <div id="carousel">Some stuff in here that needs to be 100% width.</div>
  </div>
  <div id="footer">
    The footer
  </div>
</div>

#wrapper {
    width:712px;
    margin:0 auto;
    background:#eee;
}

#carousel {
    position:absolute;
    left:0;
    right:0;
    border:1px solid red;
} 
```

看我的小提琴：http: [//jsfiddle.net/yJ4EM/](http://jsfiddle.net/yJ4EM/)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:04:25.930

轮播位置应设置为**relative**。

# sql - SQL 为什么使用 'between' 而不是 '>= 和 <='

> ID：15118521
> 
> 赞同：2
> 
> 时间：2013-02-27T17:34:10.250
> 
> 标签：sql, sql-server, oracle, sap-ase

我想了解使用'where num between 2 and 4'和'where num >= 2 and num <= 4'的任何区别，因为它适用于Oracle、Sybase-ASE和MSSQL。

从纯粹的视觉角度来看，“之间”对我来说看起来更好。但是我更担心性能和任何其他技术问题。（例如，执行计划是否可能不同）

“之间”是纯粹的装饰性关键字吗？避免出现“和”，还是提供更多的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:38:16.187

有时使用`BETWEEN`可以使您免于多次评估操作：

```
SELECT  AVG(RAND(20091225) BETWEEN 0.2 AND 0.4)
FROM    t_source;

---
0.1998

SELECT  AVG(RAND(20091225) >= 0.2 AND RAND(20091225) <= 0.4)
FROM    t_source;

---
0.3199 
```

在第一个查询`RAND()`中只调用一次，但在第二个查询`RAND`中调用了两次，这里为`BETWEEN`您节省了对`RAND`.

对于 SQL 查询的可读性，还有一些话要说，查询可能会变得*庞大*，类似的功能`BETWEEN`有助于改善这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:35:49.573

数据库优化查询，无论哪种方式都应该具有相同的性能。

也就是优化器会创建一个解析树，两者应该有相同的执行计划。

# java - GWT 返回从外部 jar 实现接口的自定义对象

> ID：15118522
> 
> 赞同：0
> 
> 时间：2013-02-27T17:34:14.763
> 
> 标签：java, gwt, rpc, gxt

我正在尝试实现一个应用程序，该应用程序将从服务器读取一些路径并将其显示为 web 中的树。对于客户端，我使用的是使用 TreeStore 的 Sencha GXT Tree。

我看到这个问题与我所拥有的代码非常接近： [GWT 简单 RPC 用例问题：包含代码](https://stackoverflow.com/questions/2237142/gwt-simple-rpc-use-case-problem-code-included) 我这边的不同之处在于我的 TestObject 类也实现了 TreeStore.TreeNode 和 Serializable。这个 TreeStore.TreeNode 位于我添加到 buildpath 和 classpath 的 gxt-3.0.1.jar 中。

```
import java.util.List;
import java.io.Serializable;
import com.sencha.gxt.data.shared.TreeStore;
import com.sencha.gxt.data.shared.TreeStore.TreeNode;

@SuppressWarnings("serial")
public class TestObject implements TreeStore.TreeNode<TestCase>, Serializable {
  public TestObject() {

  }
[...] 
```

我试图从服务器端返回一个 TreeStore 对象，其中包含有关给定路径目录内容的数据。但是异步调用的执行失败了`java.lang.NoClassDefFoundError: com/sencha/gxt/data/shared/TreeStore$TreeNode`

鉴于它来自 gxt jar，我应该怎么做才能让服务器端看到这个实际上更特定于客户端的对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:13:57.460

确保 gxt jar 在服务器类路径上 - 它应该位于服务器中`WEB-INF/lib/`以供服务器找到它。仅仅将它放在项目类路径中并不足以确保战争应用程序可以找到它。

# android - 将移动应用程序捆绑到单个下载中

> ID：15118523
> 
> 赞同：1
> 
> 时间：2013-02-27T17:34:16.000
> 
> 标签：android, ios, mobile

是否可以将多个移动应用程序捆绑到一个下载中？所以一个人可以安装捆绑的应用程序，然后在他们的手机上使用几个新的应用程序。

例如，一组 iOS 应用程序，还是一组 Android 应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:38:22.800

你不能这样做。你可以做的是在意图过滤器中添加一个带有 CATEGORY_HOME 的额外 Activity，它将在 Android 的启动器上显示为一个单独的应用程序：

```
<intent-filter>
  <category android:name="android.intent.category.DEFAULT" />
  <category android:name="android.intent.category.HOME" />
</intent-filter> 
```

您必须更改活动的图标和标签属性才能使其具有不同的图标和名称:)

**更新：**

我用于意图过滤器的格式不正确。这就是必须在清单的应用程序标记内声明活动的方式：

```
<activity android:name=".MainActivity" 
    android:icon="@drawable/main_icon"  
    android:label="@string/main_app_name">
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
</activity>
<activity android:name=".SecondaryActivity" 
    android:icon="@drawable/secondary_icon" 
    android:label="@string/secondary_app_name">
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
</activity> 
```

如果您想在库项目中包含一个 Activity，您将包含该给定 Activity 的完整路径。

一种有趣的方法是创建两个应用程序，如库项目，然后将它们组合成一个。请记住，您不能将库项目打包到 apk 中，因此如果您想创建单独的产品，则必须执行单独的项目。

以下是有关图书馆项目的一些信息：[http ://www.vogella.com/articles/AndroidLibraryProjects/article.html](http://www.vogella.com/articles/AndroidLibraryProjects/article.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:22:15.283

对于 iOS，你不能这样做。我试图将多个应用程序放在一个 ipa（只是 zip）中，但它只会识别其中一个。

在 iOS 上也禁止下载其他内容。

但是，如果您通过无线方式分发应用程序，您可以创建一个文件（我不记得它的确切名称），其中将包含多个资产（多个 ipa）。

对于 Android，pablisco 和 user2115660 几乎涵盖了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:17:04.017

我看到一个应用程序在灌输后开始下载 apk 并安装它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T18:22:51.213

对于iOS，在我不太熟悉的越狱世界之外，没有。

# javascript - 从 html5 视频中获取音频

> ID：15118524
> 
> 赞同：17
> 
> 时间：2013-02-27T17:34:18.307
> 
> 标签：javascript, html, html5-video, html5-audio

是否可以从 HTML5 中的 mp4 或 webm 视频元素中获取音频？

我正在尝试使用[https://github.com/corbanbrook/dsp.js](https://github.com/corbanbrook/dsp.js)来计算音频的 FFT，但是，我只有 mp4 和 webm 视频。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-08T04:27:28.703

不确定这是否能回答您的问题，但您可以通过 Web Audio API 节点图运行视频的音频。下面的代码可以通过改变增益和滤波器参数来演示。我只在 Chrome 上测试过这个。

```
<!DOCTYPE html>
<meta charset="UTF-8">
<title></title>
<body>

</body>

<script>

var video = document.createElement("video");
video.setAttribute("src", "ourMovie.mov");

video.controls = true;
video.autoplay = true;
document.body.appendChild(video);

var context = new webkitAudioContext();
var gainNode = context.createGain();
gainNode.gain.value = 1;                   // Change Gain Value to test
filter = context.createBiquadFilter();
filter.type = 2;                          // Change Filter type to test
filter.frequency.value = 5040;            // Change frequency to test

// Wait for window.onload to fire. See crbug.com/112368
window.addEventListener('load', function(e) {
  // Our <video> element will be the audio source.
  var source = context.createMediaElementSource(video);
  source.connect(gainNode);
  gainNode.connect(filter);
  filter.connect(context.destination);

}, false);

</script> 
```

上面的代码是这个的修改版本：http: [//updates.html5rocks.com/2012/02/HTML5-audio-and-the-Web-Audio-API-are-BFFs](http://updates.html5rocks.com/2012/02/HTML5-audio-and-the-Web-Audio-API-are-BFFs)

我只是用视频元素替换了音频元素。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-03-21T17:38:15.707

Webm 用作音频源。

```
<audio controls="controls" class="full-width" preload="metadata">
  <source src="//rack.international/samples/sample.webm" type="audio/mpeg">
</audio>
```

```
<video src="https://rack.international/samples/sample.webm" controls>
  <p>Your browser doesn't support HTML5 video. Here is a <a href="rabbit320.webm">link to the video</a> instead.</p> 
</video>
```

# javascript - 动态对象属性 javascript

> ID：15118525
> 
> 赞同：0
> 
> 时间：2013-02-27T17:34:18.407
> 
> 标签：javascript, oop, dynamic

此代码块有问题：

```
var name = "";
var nutrients = {};
var tds = document.getElementById('data').getElementsByTagName('td');

name = tds[0].innerHTML;
nutrients[name].val = tds[1].innerHTML;
alert(nutrients.Energy.val); 
```

如果我`.val`在两行都去掉，代码就可以工作。我试图通过从表格中提取信息来动态创建“营养素”。“能量”，所有 50 个营养素名称都必须具有“值”和“单位”属性。最终这将是一个循环。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:39:00.773

尝试分配时

```
nutrients[name].val = tds[1].innerHTML; 
```

该`nutrients`对象仍然是空的，并且`nutrients["Energy"]`（或其他）将是未定义的；在分配属性时抛出异常。相反，使用

```
nutrients[name] = {
    val: tds[1].innerHTML
}; 
```

# c++ - 如何在 C++ 中读取 Windows 默认网关 IP 地址

> ID：15118527
> 
> 赞同：2
> 
> 时间：2013-02-27T17:34:22.537
> 
> 标签：c++, windows, winapi, visual-c++

有人可以指出我如何在 C++ 中读取默认的 Windows 网关 IP 地址。我可以使用 GetAdaptersInfo() 读取所有 IP 地址的列表，但不能读取默认网关 IP 地址。

```
 GetAdaptersInfo( pAdapterInfo, &BufferLength );
 // Iterate the network adapters and print their MAC address.
    while( pAdapterInfo )
    {           
        pAdapterInfo = pAdapterInfo->Next; // Get next adapter info
    } 
```

这是代码片段，想知道哪个字段为我提供了默认网关。我可以获取列表中每个 IP 地址的网关，但我需要默认网关 IP 地址。

想要这样做的最初原因是选择具有默认网关的 IP 的特定 MAC 地址（从一堆 MAC 地址中）。当我们在遍历列表时获得多个 MAC 地址时，我们认为最好的方法是选择具有默认网关的 IP 的 MAC 地址。此后我们改变了主意，将选择有线连接 MAC 地址。但我仍然很想知道如何获取默认网关而不是遍历所有适配器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T19:56:47.833

[`GetAdaptersInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366062%28v=vs.85%29.aspx)给你这个：

> 网关列表
> 
> 类型：IP_ADDR_STRING
> 
> 此适配器的网关 IPv4 地址表示为 IP_ADDR_STRING 结构的链接列表。一个适配器可以有多个分配给它的 IPv4 网关地址。**此列表通常包含此适配器默认网关的**IPv4 地址的单个条目。

`GetAdaptersInfo`如果您无法从已有的数据中获取网关，也许您需要发布您的代码。

`ipconfig /all`基本上，您可以通过在推荐提示符下运行来“预览”这些信息。您将看到每个接口都定义了网关，没有全局网关。`route print`为您获取路由，您可以看到它们被优先考虑，这规定了这个或那个网关是否被有效使用：这取决于采用哪条路由。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-24T17:42:30.603

由于您想使用 WINAPI，[GetAdapterAddresses](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365915%28v=vs.85%29.aspx)可能只是最好的选择。

```
GAA_FLAG_INCLUDE_GATEWAYS | GAA_FLAG_INCLUDE_ALL_INTERFACES | GAA_FLAG_SKIP_DNS_SERVER | GAA_FLAG_SKIP_MULTICAST 
```

IP_ADAPTER_ADDRESSES 函数的文档在[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366058%28v=vs.85%29.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-25T06:18:19.237

它根本无法以这种方式工作 - 设置窗口显示给定接口的默认网关，但没有整个系统的默认网关之类的东西。再次设置窗口将尝试提供帮助并建议将一个或另一个网络接口设置为默认值，但如果您这样做，真正发生的情况是在[路由表](http://en.wikipedia.org/wiki/Routing_table)中添加一个默认条目。问题是更高级的设置将使您能够根据目标地址使用不同的接口（甚至网关）。如果您希望您的默认网关用于通信某些特定地址，您可以使用[GetBestRoute](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365924%28v=vs.85%29.aspx)- 它会告诉你如果你想联系给定的地址，你会使用哪个网关。如果您只想为您的计算机获取一个通用的默认网关，您可能会尝试扫描路由表，但这是一件令人讨厌的事情，而且那里甚至可能没有被识别为单个默认网关的东西，可能有很多——无论如何，系统通常都会“正常工作”，但让你的程序发现它可能会变得很棘手。

总结一下：没有计算机范围的默认网关。桌面 Windows 通常以类似的方式设置，但这不是严格的要求。即使是这样，它也是使用较低级别的机制（路由表）完成的，并且读取它的配置可能会令人讨厌 - 我知道，我已经做到了；）

另一个想法 - 控制面板可能会将这些设置保存在注册表中的某个位置，以便系统能够在每次系统启动时配置网络。如果您发现这些在哪里，您可能无法获得 100% 面向网络的默认网关，但您肯定会获得用户在设置窗口中看到的值。我不知道在哪里可以找到这样的知识，我怀疑它没有发布，并作为实现细节保留 - 意味着它可以从一个版本到另一个版本，甚至有一些更大的更新/服务包。如果您采用这种方式，它很可能无法在不同的 Windows 版本之间移植。

PS 为什么需要这个？为什么会有人需要这个？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T23:05:04.810

通常，您将使用 GetAdaptersInfo（根据 Roman R 的答案）或最好使用 GetAdapterAddresses（根据 specializt 的答案）来列出适配器，并且恰好一个适配器将配置一个网关。但是，可以有多个默认网关，但[不建议](http://support.microsoft.com/kb/157025)这样做。但是，在有多个默认网关的计算机上，我相信[GetBestRoute](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365924%28v=vs.85%29.aspx)功能会告诉您当前正在使用哪一个。请注意，这可能随时更改。

只有当多个适配器配置了网关时，您才需要调用 GetBestRoute 来决定哪个默认网关最有可能用于任何给定的连接。请记住，如果有多个默认网关，则它们都不会被认为天生比其他网关“更好”；换句话说，在这种情况下，没有“默认网关”之类的东西，只有“默认网关”。

# java - 将用户 ID 与其他模型类一起使用

> ID：15118528
> 
> 赞同：0
> 
> 时间：2013-02-27T17:34:35.573
> 
> 标签：java, playframework-2.0, play-authenticate

我在我的 play-framework 项目中使用 play-authenticate 插件。我希望能够使用插件的 User.java 模型类中的用户 ID（当前登录的用户）。

```
 @Id
    public Long id; 
```

我想这样做，以便当用户在单独的模型类中创建条目时，我可以存储创建这些条目的用户。是否有访问此信息的功能，或者我是否需要在 User 类中编写一个附加方法来返回活动用户？

```
package controllers;

import java.text.SimpleDateFormat;
import java.util.Date;
import models.*;
import models.User;
import play.Routes;
import play.data.Form;
import play.mvc.*;
import play.mvc.Http.Response;
import play.mvc.Http.Session;
import providers.MyUsernamePasswordAuthProvider;
import providers.MyUsernamePasswordAuthProvider.MyLogin;
import providers.MyUsernamePasswordAuthProvider.MySignup;
import play.data.*;
import views.html.*;
import play.*;
import be.objectify.deadbolt.actions.Restrict;
import com.feth.play.module.pa.PlayAuthenticate;
import com.feth.play.module.pa.providers.password.UsernamePasswordAuthProvider;

public class Application extends Controller {

    /*Part of the Play-Authenticate authentication plugin for the Play Framework.*/
    public static final String FLASH_MESSAGE_KEY = "message";
    public static final String FLASH_ERROR_KEY = "error";
    public static final String USER_ROLE = "user";

    public static User getLocalUser(final Session session) {
        final User localUser = User.findByAuthUserIdentity(PlayAuthenticate
                .getUser(session));
        return localUser;
    }

    /*Source: https://github.com/joscha/play-authenticate*/
    @Restrict(Application.USER_ROLE)
    public static Result restricted() {
        final User localUser = getLocalUser(session());
        return ok(journeyManagement.render(localUser));
    }

    /*Source: https://github.com/joscha/play-authenticate*/
    @Restrict(Application.USER_ROLE)
    public static Result profile() {
        final User localUser = getLocalUser(session());
        return ok(profile.render(localUser));
    }

    /*Source: https://github.com/joscha/play-authenticate*/
    public static Result login() {
        return ok(login.render(MyUsernamePasswordAuthProvider.LOGIN_FORM));
    }

    /*Source: https://github.com/joscha/play-authenticate*/
    public static Result doLogin() {
        com.feth.play.module.pa.controllers.Authenticate.noCache(response());
        final Form<MyLogin> filledForm = MyUsernamePasswordAuthProvider.LOGIN_FORM
                .bindFromRequest();
        if (filledForm.hasErrors()) {
            // User did not fill everything properly
            return badRequest(login.render(filledForm));
        } else {
            // Everything was filled
            return UsernamePasswordAuthProvider.handleLogin(ctx());
        }
    }

    /*Source: https://github.com/joscha/play-authenticate*/
    public static Result signup() {
        return ok(signup.render(MyUsernamePasswordAuthProvider.SIGNUP_FORM));
    }

    /*Source: https://github.com/joscha/play-authenticate*/
    public static Result jsRoutes() {
        return ok(
                Routes.javascriptRouter("jsRoutes",
                        controllers.routes.javascript.Signup.forgotPassword()))
                .as("text/javascript");
    }

    /*Source: https://github.com/joscha/play-authenticate*/
    public static Result doSignup() {
        com.feth.play.module.pa.controllers.Authenticate.noCache(response());
        final Form<MySignup> filledForm = MyUsernamePasswordAuthProvider.SIGNUP_FORM
                .bindFromRequest();
        if (filledForm.hasErrors()) {
            // User did not fill everything properly
            return badRequest(signup.render(filledForm));
        } else {
            // Everything was filled
            // do something with your part of the form before handling the user
            // signup
            return UsernamePasswordAuthProvider.handleSignup(ctx());
        }
    }

    /*Source: https://github.com/joscha/play-authenticate*/
    public static String formatTimestamp(final long t) {
        return new SimpleDateFormat("yyyy-dd-MM HH:mm:ss").format(new Date(t));
    }

} 
```

更新：

```
package models;

import play.mvc.Http.Session;
import controllers.*;
import java.util.*;
import play.db.ebean.*;
import play.data.validation.Constraints.*;
import javax.persistence.*;
import play.data.format.*;
import com.avaje.ebean.*;
import java.text.*;

@Entity
public class Journey extends Model { 

    public SimpleDateFormat simpleTimeFormat = new SimpleDateFormat("hh:mm");
    public SimpleDateFormat simpleDateFormat = new SimpleDateFormat("dd/MM/yy");

    @Id
    public Long id;

    @Required
    public String start_loc;

    @Required
    public String end_loc;

    @Required
    public String participant_type;

    @Required
    public String date = simpleDateFormat.format(new Date());

    @Required
    public String time = simpleTimeFormat.format(new Date());

    @ManyToOne
    public User createUser;

    @ManyToOne
    public User modifyUser;

    public static Finder<Long,Journey> find = new Finder(
        Long.class, Journey.class
        );

    public static List<Journey> all() {
        return find.all();
    }

    public static void create(Journey journey) {
        journey.save();
    }

    public static void delete(Long id) {
        find.ref(id).delete();
    }

    public static List<Journey> searchByAddress(String address) {
        return find.where().ilike("start_loc", "%"+address+"%").findList();
    }

    public void save() {
        User logged = Application.getLocalUser(session());
        if (logged != null) {
            this.createUser = logged;
            this.modifyUser = logged;
        }
        super.save();
    }

    public void update(Object o) {
         User logged = Application.getLocalUser(session());
        if (logged != null) {
            this.modifyUser = logged;
        }
        super.update(o);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:40:09.230

您不需要手动编写它，例如，如果您有一个`Book.java`模型，您可以为示例添加字段`updatedBy`以识别上次编辑记录的人，此外您可以覆盖`Model's`方法`save()`并`update(Object o)`确保这些字段将是总是更新而无需额外的努力。

```
@Entity
public class Book extends Model {

    @Id
    public Integer id;

    @ManyToOne
    public User createUser;

    @ManyToOne
    public User modifyUser;

    public void save() {
        User logged = Application.getLocalUser(session());
        if (logged != null) {
            this.createUser = logged;
            this.modifyUser = logged;
        }
        super.save();
    }

    public void update(Object o) {
        User logged = Application.getLocalUser(session());
        if (logged != null) {
            this.modifyUser = logged;
        }
        super.update(o);
    }

    // other fields/methods
} 
```

# java - 在数组中插入数字

> ID：15118530
> 
> 赞同：1
> 
> 时间：2013-02-27T17:34:42.463
> 
> 标签：java, arrays, loops

如何将一个数字（73）添加到数组的中间，然后将所有数字从中间向上移动一个，这样就不会覆盖任何数字。到目前为止，这是我的代码，73 应该放在中间，后面的数字应该全部移过来。不能使用 ARRAYLIST。

```
int midpoint = length/2;
array[midpoint] = 73;

for (int i = midpoint; i<length; i++){
    aNums[i+1] = array[i];
    System.out.print(array[i] + " ");
}

displayArray1(array,length); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:37:54.397

使用 a `List`，或更具体地使用 a `ArrayList`：

```
ArrayList<Integer> list = new ArrayList<>();

// ... put stuff in list

int midpoint = list.size()/2;
list.add(midpoint, 73); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:38:11.883

您不能添加到数组中。您首先必须创建一个更大的数组。

```
int[] newArray = new int[array.length + 1]; 
```

然后你必须复制数组的前半部分

```
for(int i = 0; i < midpoint; i++) {
    newArray[i] = array[i];
} 
```

然后将新的中点放入

```
newArray[midpoint] = 73; 
```

然后复制另一半

```
for(int i = midpoint + 1; i < array.length; i++) {
    newArray[i+1] = array[i];
} 
```

然后 newArray 有了新的中点。

从技术上讲，最后三个步骤可以按任何顺序完成，但按该顺序执行它们更具可读性。现在你可以调用你的 display 方法或者用它做任何你想做的事情。

有一种实用方法称为`arrayCopy`可以帮助移动数组元素。您可能会或可能不会被允许使用它。它的参数有点罗嗦，但在运行时比典型的 for 循环快一点，因为它利用了本机代码。

```
int[] newArray = new int[array.length + 1];
System.arrayCopy(array,0,newArray,0,midpoint);
newArray[midpoint] = 73;
System.arrayCopy(array,midpoint,newArray,midpoint+1,array.length - midpoint); 
```

为了解释这些调用，arraycopy 使用：

```
System.arrayCopy(arrayFrom, 
                 startPosInArrayFrom, 
                 arrayTo, 
                 startPosInArrayTo, 
                 numElementsToCopy); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:37:52.117

使用数组会给自己带来更多麻烦。

使用由数组支持的 ArrayList

```
ArrayList l = new ArrayList();

//...fill contents
int index = l.size()/2;
l.add(index, 72); 
```

# ajax - 数据流，何去何从？

> ID：15118535
> 
> 赞同：0
> 
> 时间：2013-02-27T17:34:54.880
> 
> 标签：ajax, node.js, websocket, nowjs-sockets

我即将开始一个HTML5游戏，java脚本逻辑很重，我想在服务器端保留一些逻辑，这样我保证我的游戏只能在我的服务器上玩。

我决定选择node.js，因为它非常快，我想到了两种方法：

1.  要使用 AJAX，客户端将调用服务器端方法，该方法将返回计算出的数字以刷新游戏场景，此调用将每 2 秒调用一次。

2.  使用 node.js 打开一个套接字，这样客户端就不必每次都调用服务器，而是继续侦听从打开的套接字流来的数据，这将每 x 秒刷新一次数据。

计算出来的数据不大，大约每秒0.5kb，客户端也需要告诉服务器是什么状态，所以客户端发送的数据大约是0.1kb/x秒，看游戏情况。

似乎第二种方法更好，但是，我需要数百个端口来处理并发播放器..

那么，在性能和最小化使用带宽方面，选择哪种方式呢？或者，还有更好的方法吗？任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T20:45:12.423

正如您所提到的，您正在创建一个基于 Web 的 JavaScript 应用程序，该应用程序定期向服务器发送信息或从服务器检索更新，那么我认为您应该使用 WebSocket（尤其是您正在使用 HTML5 开发），这会减少您的应用程序的带宽量用途。

在性能方面，我也会选择 WebSocket，通过做一些测量实验，例如一次平均 100 个请求的往返时间，WebSocket 的往返时间更短。这是一个性能测试的链接可能会告诉结果：[http ://www.peterbe.com/plog/are-websockets-faster-than-ajax](http://www.peterbe.com/plog/are-websockets-faster-than-ajax)

# php - 如何连接到远程mysql数据库

> ID：15118536
> 
> 赞同：0
> 
> 时间：2013-02-27T17:35:03.820
> 
> 标签：php, mysql, linux, remote-access, mysql-error-2003

我已经查看了所有相关的问题和答案，但仍然无法连接到远程 mysql 数据库。

到目前为止我所做的是..

1

```
CREATE USER 'root'@'192.168.1.100' IDENTIFIED BY  '***';
GRANT ALL PRIVILEGES ON * . * TO  'root'@'192.168.1.100' IDENTIFIED BY  '***' WITH GRANT OPTION MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 MAX_USER_CONNECTIONS 0 ; 
```

2

```
my.cnf file in server (which is in /etc/my.cnf path let me if it is not correct)
[mysqld]
innodb_file_per_table=1
#bind-address = 127.0.0.1
#skip-networking 
```

以下是我项目的 database.yml。

```
all:
  doctrine:
    class: sfDoctrineDatabase
    param:
      dsn:      mysql:host=[ip of remote server];dbname=dev_db
      username: user
      password: user12
      encoding: utf8
      attributes:
        use_native_enum: true
        default_table_type: INNODB
        default_table_collate: utf8_unicode_ci
        default_table_charset: utf8 
```

我收到以下异常

```
PDO Connection Error: SQLSTATE[HY000] [2003] Can't connect to MySQL server on '50.115.116.203' (4) 
```

那么配置远程数据库还缺少什么。

请帮忙

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:42:05.953

`192.168.1.100`这是一个本地网络 IP，您已将此 IP 用作用户允许的主机。但是，当您连接到此服务器时，您使用的是 Public IP Address `50.115.116.203`。请检查您要连接的服务器是否具有与您为用户添加的允许主机相同的 ip

# javascript - 数据集中的新数据未更新

> ID：15118537
> 
> 赞同：2
> 
> 时间：2013-02-27T17:35:04.783
> 
> 标签：javascript, d3.js

我有以下代码用 dataset2 更新 chart1，但结果 mychart1 值未更新为 dataset2 中的新值。我希望 dataset2 中的更新值反映在 myChart1 中，但是当我查看调试器中分配的类时，旧数据正在更新。

谁能指出我哪里出错了

```
function chart() {

            //Width and height
            var w = 200;
            var h = 100;
            var barPadding = 2;
            var max = 0;

            this.createChart = function(dataset,cls) {

                //create svg element
                var svg = d3.select("#chartDisplay").append("svg").attr("class",cls).attr(
                        "width", w).attr("height", h);

                //create rect bars
                var rect = svg.selectAll("rect").data(dataset,function(d, i) {return d;});

                rect.enter()
                    .append("rect")
                    .attr("class","original")
                    .attr("x",function(d, i) {
                            return i * (w / dataset.length);
                        })
                    .attr("y", function(d) {
                            return h - d * 3; //Height minus data value
                        })
                    .attr("width", w / dataset.length - barPadding)
                    .attr("height", function(d) {
                            return d * 3;
                        });

                max = d3.max(dataset);
                var xScale = d3.scale.linear().domain([ 0, max ]).range(
                        [ 0, w ]);

            }

            this.updateChart = function(dataset,cls) {

                var svg = d3.select("#chartDisplay").select("svg."+cls);

                var rect = svg.selectAll('rect')
                              .data(dataset,function(d, i) {
                                    return d;
                                });

                rect.attr("y", function(d) {
                    return h - d * 3; //Height minus data value
                         })
                    .attr("height", function(d) {
                        return d * 3;
                         });   

                rect.attr("class","updated");

            }

            this.getMax = function() {
                return max;
            }

        }

        var dataset1 = [ 5, 10, 12, 19, 21, 25, 22, 18, 15, 13 ];
        var dataset2 = [ 1, 4, 14, 19, 16, 30, 22, 18, 15, 13 ];

        var myChart1 = new chart();
        myChart1.createChart(dataset1,"chart1");
        myChart1.updateChart(dataset2,"chart1");

        var myChart2 = new chart();
        myChart2.createChart(dataset2,"chart2"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:53:03.023

这就是问题：

```
var rect = svg.selectAll('rect')
              .data(dataset,function(d, i) { return d; }); 
```

这说明`d3`使用数据值作为数组的键。由于您的值正在更改，因此不同的值不匹配，因此它们没有被更新（您需要使用另一个`append`语句来让它们显示出来）。由于您只有一个值数组，因此您希望将值的索引用作键（这使得 dataset1 中的元素 1 使用 dataset2 中的新元素 1 的值进行更新）。

您可以专门使用索引作为键：

```
var rect = svg.selectAll('rect')
              .data(dataset,function(d, i) { return i; }); 
```

或者更简单地说，这样做是因为使用索引作为键是默认行为。

```
var rect = svg.selectAll('rect')
              .data(dataset); 
```

# css - CSS 文本对齐对齐大空间

> ID：15118540
> 
> 赞同：19
> 
> 时间：2013-02-27T17:35:16.060
> 
> 标签：css, justify

要格式化我使用的段落`text-align:justify`，但是我有一个问题是单词之间有很大的空格，对于 IE，解决方案是使用`text-justify: distribute;`，但是 Chrome 不支持这个，我的问题是我应该为 Chrome 和 Firefox 使用什么

大空间示例：http: [//jsfiddle.net/L5drN/](http://jsfiddle.net/L5drN/)

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-12-30T15:03:20.203

为单词间距提供您喜欢的负值..

前任：

```
text-align:justify;
word-spacing:-2px; 
```

对我有用，希望这会有所帮助:)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-02-02T15:28:36.353

采用：

> 断词：打破一切；

好的！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-27T18:50:57.653

考虑使用连字符（手动、CSS、服务器端或客户端 JavaScript），请参阅[Can I use CSS to justify text with hyphenating words in a line?](https://stackoverflow.com/questions/9511014/can-i-use-css-to-justify-text-with-hyphenating-words-at-the-end-of-a-line) 当文本中有长词时，连字符往往会很有帮助。

您仍然可以保留`text-justify: distribute`，因为它可以改善支持浏览器的结果，并且可以预期它会获得支持，就像它在 CSS 标准化轨道（在[CSS Text Module Level 3](http://www.w3.org/TR/css3-text/) WD 中）一样。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-03-10T11:11:18.840

```
text-align: justify;
text-justify: distribute;
text-align-last: left; 
```

希望对你有帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T17:48:20.547

你想如何格式化段落？你是指宽度、高度、字母间距还是字间距？

您是否尝试过使用 *text-align* CSS 标签？

```
text-align:center 
```

还是*字间距*CSS 标记？

```
word-spacing:10px 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-10-27T02:45:45.183

我有一个替代解决方案可以首先消除单词之间的大间距，您应该知道`text-align:justify`只有在更宽的屏幕上呈现文本组件时才会使用的一件事，所以在我的情况下，我在卡片自定义组件上使用它，所以我只是增加我的卡片组件的宽度，这对我有帮助，希望对您有所帮助。

**Card.js**

```
import React from 'react';
import styles from './Card.module.css'

const Card = (props) => {
    return (
        <div className={styles.card}>
            {props.children}
        </div>
    );
} ;

export default Card; 
```

**Card.module.css**

```
.card {
          height: 30rem;
          width: 25rem;
          margin: 0 20px 10rem;
          text-align: justify;

} 
```

**HOC中的电话卡组件**

```
import React, { useEffect, useState } from "react";
import projectStyles from "./project.module.css";
import Card from "../UX/Card";
import axios from "axios";

const Project = () => {
  const [loadedProjects, setLoadedUsers] = useState([]);

  useEffect(() => {
    const fetchUsers = async () => {
      try {
        const responseData = await axios("api/projects");

        setLoadedUsers(responseData.data.projects);
      } catch (err) {}
    };
    fetchUsers();
  }, []);

  const displayHandler = (
    <div className={projectStyles.projectHolder}>
      {loadedProjects.map((project,index) => {
        return (
          <Card key={index}>
            <img src={project.image} alt="project" height={225} width={345}  style={{marginBottom:"20px"}}/>
            <p style={{fontSize:'25px' , fontWeight:'bold'}}>{project.title}</p>
            <p className={projectStyles.body}>{project.info}</p>
            <h4>Technologies Used</h4>
            <ul key={project.image}>
              {project.technology.map((tech) => {
                return <li key={tech}>{tech}</li>;
              })}
            </ul>
          </Card>
        );
      })}
    </div>
  );

  return <div>{loadedProjects ? displayHandler : 'Fetching Projects...'}</div>;
};

export default Project; 
```

# asp.net-mvc-4 - RequireHttps 和路由到 https URL

> ID：15118543
> 
> 赞同：0
> 
> 时间：2013-02-27T17:35:28.527
> 
> 标签：asp.net-mvc-4, requirehttps

我在处理登录和安全 https 页面的用户控制器中的大多数操作上使用 RequireHttps 属性。

在我的 http 主页上，我有一个指向我的登录页面的链接，如下所示（MVC 4 Razor View）：-

```
<a href="@Url.Action("Login", "User")">Login</a> 
```

该链接正确地转到带有 https 地址的登录页面。但是，当我查看 IIS 日志时，我看到登录 URL 有两个条目，一个在端口 80 上，一个在端口 443 上。

这是我应该关心的问题吗？

我知道在我的@Url.Action 上我可以强制使用 https 模式，但不确定这是否是最好的方法。另外，这会删除端口，这在 VS 2012 中使用 IIS Express 时很烦人。然后我必须进一步扩展 @Url.Action 以包含主机名：端口。

所以我只是检查（a）这是否应该是一个问题，以及（b）是否有任何其他方法可以将 URL 强制为 https。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:00:52.040

大多数教程都会同意，通过使用混合模式站点（HTTP 和 HTTPS），您违背了 SSL 的目的（某些路径需要 SSL，然后切换回非 SSL 连接）。切换到 HTTPS 后，建议您强制用户继续使用 HTTPS 进行所有操作，至少在他们注销之前。我有一个使用 HTTPS 的站点，一旦您访问该站点，我只需使用 URL 重写规则将用户切换到 HTTPS，并且只允许使用 HTTPS。

```
<rewrite>
  <rules>
    <rule name="Redirect HTTP to HTTPS" stopProcessing="true">
      <match url="(.*)"/>
      <conditions>
        <add input="{HTTPS}" pattern="^OFF$"/>
      </conditions>
      <action type="Redirect" url="https://{HTTP_HOST}/{R:1}" redirectType="SeeOther"/>
    </rule>
  </rules>
</rewrite> 
```

完成此操作后，还建议将身份验证 cookie 也设置为需要 HTTPS。对于 Forms 身份验证，这就像在 web.config 中设置以下内容一样简单。

```
<authentication>
    <forms requireSSL="true" />
</authentication> 
```

我还建议查看一些可以设置以帮助浏览器正确处理站点的标头，例如使用 Strict-Transport-Security 来表示该站点需要 SSL。请记住，虽然标头是您可以采取的重要补充措施，但最终它们留给浏览器执行，不应完全依赖。

我推荐这些步骤，因为我没有遇到您所描述的症状，并且希望它们能帮助解决您在日志中注意到的问题。

**修正：**哦，我也忘了提一下，HTTPS 比普通的旧 HTTP 建立连接更密集。在宏伟的计划中并不多，但它仍然是一些东西。我建议您使用[HTTP Keep Alive](http://technet.microsoft.com/en-us/library/cc772183%28v=ws.10%29.aspx)以减少一些开销。

**更新：**通过 SSL 进行通信并不意味着您已通过身份验证。这只是意味着您正在通过安全/加密连接进行交谈。

以您的亚马逊为例。如果您访问该站点，您会喜欢通过 HTTP 获得正常连接。您没有登录，您只是在浏览该网站。如果你愿意，你可以切换到 HTTPS，你仍然会得到相同的站点，但你还没有登录。现在，如果您尝试登录，您将被重定向，以便您通过 HTTPS 绰号所指出的 SSL（如果您还没有）进行交谈。即使在您实际登录后，您仍将通过 SSL 进行通信。~~即使您尝试通过从 URL 的协议部分中删除 S 来在登录时手动切换为不使用 SSL，它仍会将您发送回使用 HTTPS。这是正确的做法。~~通常建议您在验证后不要返回非加密会话。这通常是为了避免会话劫持，因为您的身份验证 cookie 永远不会通过纯 HTTP 发送。确保您在外部资源上拥有的资源位于您信任的网站上。HTTP 连接中的外部资源访问也应该通过 SSL 连接。同样，仅仅因为您通过 SSL 进行通信并不意味着您已登录到这些来源。因为我的应用程序是通过 SSL 100% 访问的，但我在网站上也集成了谷歌分析和谷歌地图（显然两者都在我的域之外）。我只是确保我通过 SSL 与 Google 交谈。我不必真正登录谷歌就可以使用这些东西。您的外部图像也是如此。只要确保你的网址'

**更新：**您在日志中获得两次点击的原因是因为您的登录链接是通过 HTTP 请求的，Require HTTPS 属性点击首先意识到您没有使用 SSL 并使用 HTTPS 将您重定向回自身协议。如果您更新 ActionLink URL，您可以解决这个问题，但您知道它会变得丑陋。

```
Url.Action("Login", "User", null, "https", Request.Url.Host) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-24T10:34:05.763

将此添加到您的 global.ascx

```
protected void Application_BeginRequest()
        {
            if (!Context.Request.IsSecureConnection)
                Response.Redirect(Context.Request.Url.ToString().Replace

("http:", "https:"));
        } 
```

这将导致所有请求都转换为 https 而不是 http

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-14T05:10:10.613

我为 Url.Action 编写了一个扩展，它根据属性修饰生成正确的协议。我让你检查

```
public static class Extensions
{
    public static string SecuredAction(this UrlHelper helper, string action, string controller)
    {
        bool requireSSL = false;
        var route = System.Web.Routing.RouteTable.Routes.Select(r => r as System.Web.Routing.Route) .Where(r =>
            r != null && r.Defaults != null && r.Defaults["controller"] != null && r.Defaults["controller"].ToString().Equals(controller, StringComparison.InvariantCultureIgnoreCase)
            && r.Defaults["action"] != null && r.Defaults["action"].ToString().Equals(action, StringComparison.InvariantCultureIgnoreCase)).FirstOrDefault();

        if(route == null)
            return helper.Action(action, controller);

        //Get the method and check if requiere ssl
        MemberInfo method = route.DataTokens["TargetActionMethod"] as MemberInfo;
        requireSSL = method.CustomAttributes.Any(a => a.AttributeType == typeof(RequireHttps)) || method.DeclaringType.CustomAttributes.Any(a => a.AttributeType == typeof(RequireHttps));

        //Return the correct protocol
        if(helper.RequestContext.HttpContext.Request.IsSecureConnection && !requireSSL)
            return helper.Action(action, controller, null, "http");

        if (!helper.RequestContext.HttpContext.Request.IsSecureConnection && requireSSL)
            return helper.Action(action, controller, null, "https");

        return helper.Action(action, controller);
    }
} 
```

# jquery - 在 Jquery 中显示和隐藏内容

> ID：15118545
> 
> 赞同：0
> 
> 时间：2013-02-27T17:35:37.607
> 
> 标签：jquery, html, jquery-animate

我试图让动画在这个简单的 Jquery 隐藏/显示程序中工作。但是当我隐藏内容并按“少...”时，没有动画，只是简单的过渡。我在这个小东西上工作了几个小时，但没有成功。有什么建议么？

```
<!DOCTYPE html>
<head>
    <style>
        body{ width:50%; margin: 0 auto;}
        .content{background:yellow; font-size:large; margin-top:10px; 
            padding:5px;}
        a{text-decoration:none;}
    </style>

    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script>
        $(document).ready(function() {
            $("#overflow").hide();

            $(".moreorless").click(function() {
                event.preventDefault();
                $(this).next("#overflow").slideToggle();

                if($(this).prev("#overflow").is(":hidden")){
                    $(this).prev("#overflow").show();
                    $(this).html(" less...");
                }
                else{
                    $(this).prev("#overflow").hide();
                    $(this).html(" more...");
                }       
             });
        })
    </script>
</head>

<body>
    <div class="content">
        Some Lorem ipsum<span id="overflow"> and some more lorem 
        and more and more and more and more and more and more and more and more  
        more and more and more and more and more and more and more and more and  
       </span><a href="#top" class="moreorless"> more...</a> 
    </div>
</body>
</html> 
```

jsFiddle：http: [//jsfiddle.net/r5tYB/](http://jsfiddle.net/r5tYB/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:52:55.180

这应该这样做。您应该将持续时间参数发送到功能切换。

```
$("#overflow").toggle(500);
if ($("#overflow").is(':visible')) {
    $(this).text('less...');
} else {
    $(this).text('more...');
} 
```

[http://jsfiddle.net/r5tYB/](http://jsfiddle.net/r5tYB/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:51:22.500

这是否：http: [//jsfiddle.net/4c9U4/1/](http://jsfiddle.net/4c9U4/1/)像您期望的那样工作？

```
$("#overflow").slideToggle(0);

$(".moreorless").click(function(event) {
    event.preventDefault();

    if($(this).prev("#overflow").is(":hidden")){
        $(this).html(" less...");
    } else {
        $(this).html(" more...");
    }

    $("#overflow").slideToggle();
}); 
```

我不确定问题出在哪里，但是如果您使用`.hide()`或 CSS 隐藏#overflow，则转换将不会在第一次工作。

# c++ - python 与 c++ 使用 ctypes

> ID：15118547
> 
> 赞同：1
> 
> 时间：2013-02-27T17:35:40.727
> 
> 标签：c++, python, c, ctypes

由于我还是新手，所以我遇到了一些问题，这是我的 C++ 代码：

```
#include <python.h>

#define DLLEXPORT extern "C" __declspec(dllexport)

DLLEXPORT PyObject *Add(PyObject *pSelf, PyObject *pArgs)
{
    int s,d;
    if(!PyArg_ParseTuple(pArgs, "ii" , &s, &d))
    {
        PyErr_SetString(PyExc_TypeError,
                "Add() invalid parameter");
        return NULL;
    }

    return Py_BuildValue("i", s + d);

} 
```

和 Python 代码：

```
import ctypes

MyDll = ctypes.cdll.LoadLibrary(r"PyToCppTest.dll")

jj = MyDll.Add(1,2) 
```

运行上述 Python 代码时出现错误：

> OSError：异常：访问冲突读取 0x000000000000000A

我想在不转换的情况下将数据从 Python 传递到 C++，然后在 C++ 中进行转换。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:41:41.450

您的代码有一些问题。首先，正确的包括是：

```
#include <Python.h> 
```

注意大写`P`。你可能在 Windows 上，但如果没有大写的 P，这在 Linux 上是行不通的。

另外，我`*pSelf`在你的函数声明中看不到指针的意义，你应该摆脱它：

```
PyObject *Add(PyObject *pArgs) 
```

现在，您的主要问题是：

```
MyDll.Add(1,2) 
```

...不`MyDll.Add`使用元组调用。它使用两个整数参数调用它，`1`并且`2`. 如果你想传递一个元组，你会这样做：

```
MyDll.Add((1,2)) 
```

但是，Python 的 ctypes 不知道如何处理它（它通常接受整数参数），所以你需要告诉它`Add`实际上需要一个元组，并返回一个 Python 对象：

```
import ctypes

MyDll = ctypes.cdll.LoadLibrary("PyToCppTest.dll")
MyCFunc = ctypes.PYFUNCTYPE(
    ctypes.py_object,     # return val: a python object
    ctypes.py_object      # argument 1: a tuple
)
MyFunc = MyCFunc(('Add', MyDll))

jj = MyFunc((1,2)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T18:42:02.613

使用扩展名或`ctypes`; 您不应该通过`ctypes`. 扩展的重点是能够创建对使用 Python 的人来说是原生的模块。`ctypes`用于调用完全没有使用 Python 编写的 C 代码。

# c# - C#正则表达式拆分两个变量词

> ID：15118565
> 
> 赞同：0
> 
> 时间：2013-02-27T17:36:23.947
> 
> 标签：c#, regex, parsing

我在使用正则表达式拆分文本文件的两个部分时遇到问题。基本上，会出现一个班级的名称，但随后房间号会出现一个空格。我不能保证房间的名字，否则我会分裂。

为了说明，这分裂得很好：

```
WEB SITE DEVELOPMENT II     NKM 104 
```

它会因为空格而分裂，所以在我的 string[] 数组中它看起来像：

```
0 - WEB SITE DEVELOPMENT II
1 - KNM 104 
```

这就是我需要的。问题在于以下条目：

```
PERSONAL COMPUTER APPLICATI NKM 106
PORTFOLIO DES & PROF PRACTI LCN 104 
```

这将显示为：

```
0 - PERSONAL COMPUTER APPLICATI NKM 104
1 - PORTFOLIO DES & PROF PRACTI LCN 104 
```

当我需要时：

```
0 - PERSONAL COMPUTER APPLICATI
1 - KNM 104
2 - PORTFOLIO DES & PROF PRACTI 
3 - LCN 104 
```

在这种情况下，关于从哪里开始一些正则表达式的任何想法？我知道我保证房间号始终是“XYZ 012”形式，但问题是它出现在班级名称之后。那是以前，我可以很容易地就此分开。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:39:32.850

这里不需要正则表达式...

```
var firstPart = line.Substring(0, line.Length - 8);
var lastPart = line.Substring(line.Length - 7); 
```

...以及完整的示例：

```
var data = lines.Split(new[] {Environment.NewLine}, StringSplitOptions.RemoveEmptyEntries)
                .SelectMany(line => new[] {line.Substring(0, line.Length - 8), line.Substring(line.Length - 7)})
                .Select((part, i) => string.Format("{0} - {1}", i, part));

var asString = string.Join(Environment.NewLine, data); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T17:46:37.503

您的示例中的不同文本都以相同的长度被截断，这让我怀疑您的文本文件是固定宽度的，并且不需要正则表达式。FileHelpers[项目](http://filehelpers.sourceforge.net/)解析固定宽度的文本。

但是，如果每个文件的宽度始终相同，则可以简单地使用诸如`string field = inputLine.Substring(startcolumn, columnLength)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:47:15.883

这是我将使用的正则表达式选项（假设您一次阅读一行：

```
Regex regexObj = new Regex(@"^(.+)\s(\w+\s[0-9]{3})$"); 
```

您可以通过捕获组访问它。第一个捕获组将为您提供字符串的第一部分，第二个将为您提供房间号和建筑物（？）。

假设：

*   房间号是一行中的最后一件事
*   您正在逐行读取此文本文件，因此当您与字符串匹配时，其中只有一个条目。

# java - 无法在我的 JSP 中查看 ActionMessages 和验证问题

> ID：15118568
> 
> 赞同：3
> 
> 时间：2013-02-27T17:36:24.567
> 
> 标签：java, hibernate, validation, jsp, struts2

我的代码有各种问题：

1.  我无法查看我`ActionMessages`的`ActionErrors`设置`LoginAction`
2.  登录后，如果我再次转到 URL: `/login`，它不会将我重定向到成功页面。

**编辑：**

1.  如果会话已经存在，我现在可以成功重定向。我必须做出2个我想出的改变：

*   首先，在我的动作类中，我设置`void setSession(Map map)`了错误的会话变量（它应该只是一个 setter 函数）。
*   其次，我检查了`validate()`解决问题的方法中是否存在会话变量。

2.  但我仍然无法查看我的`ActonErrors`and `ActionMessages`。

3.  是否有必要使用`<s:form>`. 因为它扰乱了我的 CSS，我无法找到解决方案来纠正它。我可以在中分配 ID 属性`<s:form>`吗？

以下是我的 JSP 代码：

```
...
        <s:if test="hasActionErrors()">
            <div id="errorMessage"><s:actionerror /></div>
        </s:if>
        <s:if test="hasActionMessages()">
            <div id="errorMessage"> <s:actionmessage /></div>
        </s:if>
        <form action="login" method="POST" id="login-form">
            <fieldset>
                <p>
                    <label for="loginUserName">username</label>
                    <input type="text" id="loginUserName" maxlength="10" placeholder="Eg. EMP0000000" 
                    title="User ID is of format EMP0000000" pattern="(EMP)([0-9]{7})" required
                     name="loginUserName" class="round full-width-input" autofocus />
                </p>

                <p>
                    <label for="loginPassword">password</label>
                    <input type="password" name="loginPassword" maxlength="20" id="loginPassword" required 
                    class="round full-width-input" />
                </p>

                <p>I've <a href="#">forgotten my password</a>.</p>

                <input type="submit" class="button round blue image-right ic-right-arrow" value="LOG IN" />

            </fieldset>

        </form>
... 
```

**这是我的`struts.xml`：**

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
        <constant name="struts.enable.DynamicMethodInvocation" value="false" />
        <constant name="struts.devMode" value="false" />

        <package name="employee" extends="struts-default" namespace="/">

            <interceptors>
                <interceptor name="login" class="com.sreebhog.interceptors.LoginInterceptor" />

                <interceptor-stack name="loginStack">
                    <interceptor-ref name="login" ></interceptor-ref>
                    <interceptor-ref name="defaultStack" ></interceptor-ref>
                </interceptor-stack>
            </interceptors>
                <default-interceptor-ref name="loginStack"></default-interceptor-ref>
            <global-results>
                <result name="loginRedirect">/login </result>
            </global-results>

            <action name="login" class="com.sreebhog.actions.LoginAction">
                <result name="input">/JSP/sreebhog_login.jsp</result>
                <result name="success">/JSP/index.jsp</result>
            </action>
            <action name="logout" class="com.sreebhog.actions.LogoutAction">
                <result name="logout">/JSP/sreebhog_login.jsp</result>
            </action>
        </package>

</struts> 
```

**这是我的`LoginAction`：**

```
package com.sreebhog.actions;

import java.io.UnsupportedEncodingException;
import java.security.NoSuchAlgorithmException;
import java.util.Map;

import org.apache.struts2.dispatcher.SessionMap;
import org.apache.struts2.interceptor.SessionAware;

import com.opensymphony.xwork2.ActionSupport;
import com.sreebhog.dao.EmployeeDAO;
import com.sreebhog.interfaces.LoginRequired;
import com.sreebhog.model.dto.Employee;
import com.sreebhog.utility.Cryptography;

public class LoginAction extends ActionSupport implements SessionAware,LoginRequired {

    private String loginUserName;
    private String loginPassword;

    SessionMap<String,Object> sessionMap;

    @SuppressWarnings({ "unchecked", "rawtypes" })
    @Override
    public void setSession(Map map) {
        sessionMap=(SessionMap) map;
        sessionMap.put("username", loginUserName);
    }

    public String execute()
    {
        String userName = null;
          if (sessionMap.containsKey("username"))
          { 
              userName = (String) sessionMap.get("username");
              if (userName != null )
              {
                  if (!userName.equals(""))
                  {
                      return SUCCESS;
                  }
              }
          }

        EmployeeDAO employeeDao = new EmployeeDAO();
        Employee employee = employeeDao.find(this.getLoginUserName());
        if (employee == null || employee.getUserName().equals(""))
        {
            System.out.println("Here1");
            addActionError("Username or password is invalid");
            return INPUT;
        } else
            try {
                if (employee.getPassword().equals(Cryptography.getHash("SHA-1", this.getLoginPassword(), employee.getSalt())))
                {
                    System.out.println("Here2");
                    addActionError("Username or password is invalid");
                    return INPUT;
                }
                else {
                    System.out.println("Here3");
                    sessionMap.put("username",(String)loginUserName);
                    sessionMap.put("role",(String)employee.getPermissions().getRole());
                    return SUCCESS;
                }
            } catch (NoSuchAlgorithmException | UnsupportedEncodingException e) {
                e.printStackTrace();
            }
        return INPUT;
    }

    public void validate()
    {

        if (loginUserName == null || loginUserName.equals("") || loginPassword == null || loginPassword.equals(""))
        {
            addActionError("Please fill in username and password");
        }
    }

    public String logout()
    {
        sessionMap.invalidate();
        return INPUT;
    }

    public String getLoginUserName() {
        return loginUserName;
    }

    public void setLoginUserName(String loginUserName) {
        this.loginUserName = loginUserName;
    }

    public String getLoginPassword() {
        return loginPassword;
    }

    public void setLoginPassword(String loginpassword) {
        this.loginPassword = loginpassword;
    }

} 
```

**这是我的`LoginInterceptor`：**

```
package com.sreebhog.interceptors;

import java.util.Map;

import com.opensymphony.xwork2.ActionContext;
import com.opensymphony.xwork2.ActionInvocation;
import com.opensymphony.xwork2.interceptor.AbstractInterceptor;
import com.sreebhog.actions.LoginAction;
import com.sreebhog.interfaces.LoginRequired;

public class LoginInterceptor extends AbstractInterceptor {

    @Override
    public String intercept(final ActionInvocation invocation) throws Exception {
        Map<String, Object> session = ActionContext.getContext().getSession();
        String userName = (String) session.get("username");

        if (userName != null && !userName.equals("")) {
            return invocation.invoke();
        }

        Object action = invocation.getAction();

        if (!(action instanceof LoginRequired)) {
            return invocation.invoke();
        }

        if (!(action instanceof LoginAction)) {
            return "loginRedirect";
        }

        return invocation.invoke();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T10:11:45.147

问题解决了。我不敢相信我做到了。忘记在我的 jsp 页面中放置 tag-lib。感谢大家的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:43:51.467

将错误消息标签和消息标签放入表单中。如下所示

```
<s:form>
            <div id="errorMessage"><s:actionerror /></div>
            <div id="errorMessage"> <s:actionmessage /></div>

.
.
.
</s:form> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:46:47.930

1.  您无法查看操作消息，因为您没有通过`addActionMessage`. 您应该看到的操作错误。还要检查`!loginUserName.equals("null")`.

2.  登录并请求`/login`检查拦截器中的会话对象`username`后，它不应为空，然后`login`调用操作。但是参数是空的，只有在提交表单时才可用。验证应该失败并返回到`input`. 也不要在`username`注入会话时将其放到地图上，在 return 之前做`success`。

# php - 获取调用者 (CURL) IP 和 SERVER_NAME - PHP

> ID：15118570
> 
> 赞同：0
> 
> 时间：2013-02-27T17:36:28.527
> 
> 标签：php, curl

嘿，我有一些服务器正在使用 curl 调用我的 API，每个调用者都有一个 API 密钥，该密钥在我的数据库中注册，并带有服务器名称（等 example.com） - 但它以某种方式返回了主机（等 web1\. meebox.net）所以我无法验证呼叫。目前我只是在使用：

```
$ip = $_SERVER['REMOTE_ADDR'];
$website = gethostbyaddr($_SERVER['REMOTE_ADDR']); 
```

和：

```
$ip = $_SERVER['REMOTE_ADDR'];
$website = $_SERVER['REMOTE_NAME']; 
```

我怎样才能让它告诉我属于服务器而不是主机的 ip 和服务器名称。

谢谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:40:36.773

并非所有 IP 都有反向映射。在这些反向映射中，它们可能不会映射到它们来自的“主机名”。例如，DNS 名称可以将无限数量的主机名映射到单个 IP。但是单个 IP 只能“反转”为单个主机名。

例如考虑一个共享服务器：

```
www.example.com -> 192.168.1.3
www.example.net -> 192.168.1.3
www.example.org -> 192.168.1.3
etc...
etc...
etc... 
```

但

```
192.168.1.3 -> server-x.hostingcompany.com 
```

您无法可靠地检索远程主机的主机名，因为您所拥有的只是一个 IP 地址，而 IP 不是任何特定主机名的“唯一”标识符。

# oracle - ORA-06502: 非常基本的字符串函数出现数字或值错误，这是什么原因？

> ID：15118576
> 
> 赞同：1
> 
> 时间：2013-02-27T17:36:43.937
> 
> 标签：oracle, plsql, oracle11g, oracle-sqldeveloper

这是代码……这不是完整的代码。我将它修剪到第一个错误发生的位置：

```
 FUNCTION get (  
    p_sql_o                         OUT VARCHAR2
  ) RETURN VARCHAR2 AS
  str_sql           VARCHAR2(4000);
  BEGIN
    str_sql := ' SELECT * FROM ( SELECT A.*, ROWNUM RNUM FROM ( ' ||
               ' SELECT item_code, ' ||
               ' item_desc, ' ||
               ' monitor, ' ||
               ' measured, ' ||
               ' inventory, ' ||
               ' (measured - inventory) adj_amount, ' ||
               ' (inventory_cost * measured) measured_cost, ' ||
               'inventory';
    RETURN str_sql;
  EXCEPTION
    WHEN OTHERS THEN
    RETURN NULL;
  END get; 
```

显然，SQL 是不完整的，但我没有运行它。我只是返回 SQL 字符串，但仍然出现错误：

ORA-06502：PL/SQL：数字或值错误：字符串缓冲区太小 ORA-06512：在第 6 行

这令人费解。有没有人知道为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T11:15:14.053

既然您说过您没有尝试动态执行您正在创建的 SQL，那么其中的语法和正确性，或者它可能返回的长度，显然是无关紧要的。你没有对你的`p_sql_o` `OUT`参数做任何事情，所以这也不会导致这个问题。这只是真正`str_sql`的罪魁祸首，正如贾斯汀昨天暗示的那样，它在函数中被声明为足够大，并且函数本身可以编译 - 所以看起来它必须是如何被调用的，这就是问题所在。

你提到如果你删除'inventory'它会起作用，这会将字符串的长度从201个字符减少到192个字符，所以我猜你已经在调用者中将此设置为200个字符，例如：

```
declare
    str_sql varchar2(200);
    p_sql_o varchar2(4000);
begin
    str_sql := get(p_sql_o);
end;
/

declare
*
ERROR at line 1:
ORA-06502: PL/SQL: numeric or value error: character string buffer too small
ORA-06512: at line 5 
```

请注意，此报告的行号是`5`，而不是`6`您的；这是*调用者*中出现错误的那一行，而不是函数内部发生赋值的那一行。如果我`str_sql varchar2(250);`在调用者声明中创建它，那么它可以工作（但它也可能`4000`与函数中的声明相匹配）。

```
declare
    str_sql varchar2(250);
    p_sql_o varchar2(4000);
begin
    str_sql := get(p_sql_o);
end;
/

PL/SQL procedure successfully completed. 
```

但`p_sql_o`仍然是空的，因为你从未设置它。看起来`OUT`参数是多余的。也许您打算将 SQL 字符串放入其中，并且已在调用者中声明为足够大；但随后不清楚返回值是什么 - 您可能只想`OUT`完全删除参数，并确保您将返回值放入的调用者中的变量足够大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:46:54.870

您是否尝试过仅针对 SP 之外的数据库运行 SQL 脚本？这将有助于确定 sql 语法是否正确以及您是否返回了预期的内容。看起来您希望得到 4000 字节或更小的响应。你确定那是被退回的东西吗？我没有看到 Where 子句。也许您返回的多行超出了您的限制？诚然，我对存储过程不太熟悉，所以我可能会离开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T22:01:06.647

在这里，您使用 p_sql_o 作为输出参数，而不是在函数内分配任何值。所以 p_sql_o 将保存它之前在调用此函数行之后的代码中的值。

正如您定义的 str_sql 只能容纳 4000 个字符，如果您的连接字符串超出该限制，它将给出**字符串缓冲区太小 ORA-06512**错误。

当您连接字符串以创建 select 语句时，请检查您是否正确使用了单引号，或者您根本没有使用它们。如果发生这种情况，那么在执行动态选择语句时，您可能会收到此错误**ORA-06502: PL/SQL: numeric or value error:**

# c# - 解决“无法加载类型”错误

> ID：15118577
> 
> 赞同：0
> 
> 时间：2013-02-27T17:36:48.323
> 
> 标签：c#, visual-studio, debugging, visual-studio-2012

我一直在尝试修复这个错误几个小时，我尝试了我能做的一切，但没有成功。我对 C# 很陌生。我想知道是否有人可以帮助我确定如何开始解决此错误？

错误信息：

```
Could not load type 'Inventory1.Global'.    W:\admin.fctl.ucf.edu\inventory\Global.asax 1 
```

Global.asax 内容：

```
<%@ Application Codebehind="Global.asax.cs" Inherits="Inventory1.Global" Language="C#"%> 
```

Global.asax.cs 内容：

```
using System;
using System.Collections;
using System.ComponentModel;
using System.Web;
using System.Web.SessionState;

namespace Inventory1 
{
    /// <summary>
    /// Summary description for Global.
    /// </summary>
    public class Global : System.Web.HttpApplication
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        public Global()
        {
            InitializeComponent();
        }   

        protected void Application_Start(Object sender, EventArgs e)
        {

        }

        protected void Session_Start(Object sender, EventArgs e)
        {

        }

        protected void Application_BeginRequest(Object sender, EventArgs e)
        {

        }

        protected void Application_EndRequest(Object sender, EventArgs e)
        {

        }

        protected void Application_AuthenticateRequest(Object sender, EventArgs e)
        {

        }

        protected void Application_Error(Object sender, EventArgs e)
        {

        }

        protected void Session_End(Object sender, EventArgs e)
        {

        }

        protected void Application_End(Object sender, EventArgs e)
        {

        }

        #region Web Form Designer generated code
        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {    
            this.components = new System.ComponentModel.Container();
        }
        #endregion
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:43:43.773

该代码适用于我的机器。检查以确保 Dll 存在于 /bin 目录中。此外，请确保 bin 和 Global.asax 文件存在于应用程序的根目录中。服务器级别的某个人很可能更改了 IIS 中的某些内容。

# woocommerce - Woocommerce 在子产品的标题中包含父产品

> ID：15118580
> 
> 赞同：2
> 
> 时间：2013-02-27T17:37:00.447
> 
> 标签：woocommerce

我有多个分组产品，其中设置了简单的产品选项，如下所示：

*   照片名称（父组产品）：
    *   7" x 4" 带框
    *   7" x 4" 无框

有没有办法让简单（子）产品名称在购物车中显示时自动为父产品名称添加后缀。

当前显示：“7”x 4“带框”

希望它显示：“照片名称 - 7”x 4“带框”

我知道在创建产品时手动输入数据还有很长的路要走。但这似乎违反直觉。

任何最佳实践/ php 片段都会非常感谢！

约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-12T02:52:46.257

这很奇怪，因为您要问的是我正在使用的主题中的默认值。我想删除分组产品列表中的父产品名称。

我在 grouped.php 中的链接代码是：

```
<a href="' . get_permalink( $child_product['product']->id ) . '">' . $child_product['product']->post->post_title . '</a> 
```

这是你有的吗？

布里迪

# jquery - 使用 contains(match) 替换 Div 中的文本

> ID：15118581
> 
> 赞同：1
> 
> 时间：2013-02-27T17:37:02.477
> 
> 标签：jquery

**jsFiddle：http:** [//jsfiddle.net/WM6wG/](http://jsfiddle.net/WM6wG/)

我正在尝试替换 div 中的文本，但似乎无法弄清楚它为什么不起作用。

*HTML：*

```
<div class="text">abc</div>
<div class="text">foo</div>
<div class="text">bar</div> 
```

*jQuery：*

```
var match = 'abc';
if ($('div.text:contains(match)')) {
    $('div.text').html(function(){
        $(this).replaceText(match, 'xyz');
    }
} 
```

理想情况下，预期的输出应该是：`xyz foo bar`但它仍然存在`abc foo bar`，我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T17:39:34.017

您的代码存在一些问题：

1.  您正在搜索“匹配”而不是变量的值`match`。

2.  您的`if`陈述毫无意义，因为您`div.text`在下一行有一个新的选择器。因此，如果其中一个元素匹配，您的代码无论如何都会针对所有匹配的元素运行它。

3.  你的`html()`方法没有返回任何东西。

4.  `replaceText()`不是标准功能。除非这是您创建的自定义函数，或者您正在使用[replaceText() 插件](http://benalman.com/projects/jquery-replacetext-plugin/)，否则将其替换为`replace()`

* * *

```
var match = 'abc';
$("div.text:contains(" + match + ")").each(function(){
   var $this = $(this);
    $this.html(function(){
        return $this.html().replace(match, "xyz");
    });
}); 
```

***现场演示：http:** [//jsfiddle.net/wh7xn/](http://jsfiddle.net/wh7xn/)*

* * *

如果您希望替换多个“abc”实例，请使用 RegEx：

```
var match = 'abc';
var re = new RegExp(match,"g");
$("div.text:contains(" + match + ")").each(function(){
   var $this = $(this);
    $this.html(function(){
        return $this.html().replace(re, "xyz");
    });
}); 
```

***现场演示**：http: [//jsfiddle.net/wh7xn/2/](http://jsfiddle.net/wh7xn/2/)*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T17:39:30.600

当您这样做时，`$('div.text:contains(match)')`您正在搜索包含文字字符串“匹配”的 div。

你可以这样做：`$('div.text:contains(' + match + ')')`

请注意，变量 match 不包含对 jquery 选择器有意义的任何内容，例如`)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T17:45:45.737

查看[更新的小提琴](http://jsfiddle.net/WM6wG/2/)

```
$(document).ready(function(){
    var match = 'abc';
    if ($('div.text:contains('+match+')')) {
        $('div.text').html(function(){
            $(this).replaceText(match, 'xyz');
        });
    }
}); 
```

2件事！

1.  这`'('+match+')'`
2.  您忘记了关闭 html 调用的函数后的括号。
3.  函数 replaceText 的 js 文件（@Jasen 谢谢！）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T17:48:22.867

这似乎在一行中完成（不包括您的 var 声明）：

```
var match = 'abc';
$('div.text:contains(' + match + ')').text($('div.text:contains(' + match + ')').text().replace(match, 'xyz')); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/WM6wG/4/)**

不需要 if 语句，而`replace`不是`replaceText`.

如果您将有多个匹配项，请使用以下命令：

```
var match = 'abc';
$('div.text:contains(' + match + ')').each(function () {
    $(this).text($(this).text().replace(match, 'xyz'));
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/WM6wG/5/)**

# ios - iOS 授权 Dropbox 无需打开 Dropbox 应用

> ID：15118586
> 
> 赞同：1
> 
> 时间：2013-02-27T17:37:15.643
> 
> 标签：ios, ios6, dropbox, dropbox-api

如果安装了 Dropbox 应用程序，有没有办法在不打开 Dropbox 应用程序的情况下对 Dropbox 进行 iOS 授权。只需打开 Dropbox 网页视图。您可以为 facebook 身份验证执行此操作，我希望有一个选项可以设置为不打开 Dropbox 应用程序。

我找到了 auth api 逻辑 [https://www.dropbox.com/developers/core/api#authorize](https://www.dropbox.com/developers/core/api#authorize)

不确定如何为 iOS 实现它。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:17:49.917

我可以通过检查是否安装了 Drop box 并根据它更改呼叫来解决这个问题。

```
 NSURL *dropboxUrl = [NSURL URLWithString:@"dbapi-1://"];
    if ([[UIApplication sharedApplication] canOpenURL:dropboxUrl]) {
        [[DBSession sharedSession] linkUserId:@"" fromController:vc];
    }else{
        [[DBSession sharedSession] linkFromController:vc];
    } 
```

如果用户安装了 dropbox，那么它将打开 safari 并以这种方式验证用户。

不是最干净的解决方案，而是最好的解决方案，无需添加任何更多的 3rd 方库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T19:10:09.403

我在上面的评论中问了一个问题，你的回答可能会或可能不会使这个答案无效，但你去吧：你可以利用 Dropbox 自己的[iOS SDK](https://www.dropbox.com/developers/core/sdk)来验证当前用户。这可能比使用`/authentication`REST 端点更可取。

另一个很可能让生活更轻松的选择是使用 Temboo 的[iOS SDK](https://www.temboo.com/download) *（完全披露：我为 Temboo 工作）*。它使您可以在 iOS 应用程序中非常轻松地使用[Dropbox 的 API](https://live.temboo.com/library/Library/Dropbox/) ，并且您的 Temboo 帐户工具还可以处理有关 OAuth、凭据等的大量繁重工作。Temboo SDK 还可以与[100 多个其他 API](https://live.temboo.com/library/)通信，一旦你实现了一个与其他 API 的集成是一件轻而易举的事。

干杯

# ios - 从 OpenFire 名册中删除用户会导致两个名册都受到影响

> ID：15118589
> 
> 赞同：1
> 
> 时间：2013-02-27T17:37:29.620
> 
> 标签：ios, xcode, xmpp, openfire, xmppframework

OpenFire 有一个重大问题，希望你们中的一个人能帮忙。

基本上，最终目标是从 user_1 的名册中删除 user_2 - 但确保 user_1 仍在 user_2 的名册中。

我一直在阅读 XMPP 协议文档，它证实了我的假设——只有相互订阅的用户才能在相关的名册中。如果 user_1 从 user_2 的名册中删除，则 user_1 也会从 user_2 的名册中删除（抱歉重复我自己）。

有什么方法可以在不影响两个名册的情况下实现这一目标？我猜这是一个服务器端问题，不幸的是我没有足够的知识来尝试自己修复它。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T09:41:57.970

无论谁从任一名册中删除谁，user_1 和 user_2 将始终拥有独立的名册。

这意味着如果 user_1 从其名册中删除 user_2，则 user_2 的名册中仍会有 user_1。

一些客户端会自动删除或隐藏用户未订阅的联系人 (subscription="none")。这会让人觉得任何一个联系人都可以将自己从另一个人的名册中删除，这是不正确的。

尝试在 psi 和 pidgin 上对此进行测试，以了解我在说什么。

# login - 单点登录 - 跨站点

> ID：15118592
> 
> 赞同：0
> 
> 时间：2013-02-27T17:37:35.127
> 
> 标签：login, cross-domain, single-sign-on

我正在尝试创建一个可以跨站点工作的单点登录，老实说，我对它的工作方式感到困惑。

基本上我需要做的是，我们有一个应用程序，用户可以在这个例子中注册一个帐户，www.domain1.com - 我们在 ASP.net 中为我们的客户端托管。

我们的客户现在已经从他们自己的系统请求——他们将在 www.domain2.com 登录——一旦用户登录，他们将能够转移到我们的托管系统 www.domain1.com 而无需登录再次...

我理解的方式是，我们的客户要么需要以某种方式自动检查用户是否在 www.domain1.com 上注册了一个帐户，要么他们需要用户在登录 www.domain2.com 时指定他们有一个帐户并输入登录 www.domain1.com 所需的详细信息 - 他们将存储这些信息，然后在用户转移到 www.domain1.com 时将其传递给我们。

如果可能的话，任何人都可以阐明如何实现上述目标，或者指出我正确的方向吗？

提前致谢。

# python - 将 lxml 对象转换为字符串

> ID：15118595
> 
> 赞同：0
> 
> 时间：2013-02-27T17:37:50.120
> 
> 标签：python, lxml

我刚开始使用**lxml**，我遇到了这个问题：

在 XML 中找到我有一个带有属性的元素，例如：

```
<book category="COOKING"> 
```

我很好，直到我使用的点：

```
for elt in doc.getiterator():

   ...

     a=elt.attrib 
```

我得到了这个对象：`{'category': 'COOKING'}`

我怎么能把它转换成可用的东西，比如字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:40:53.487

该`attrib`属性是一个字典（即关联数组）。要将`category`属性值作为字符串获取，您可以编写`elt.attrib['category']`

# class - python中的求和

> ID：15118599
> 
> 赞同：0
> 
> 时间：2013-02-27T17:37:59.290
> 
> 标签：class, python-3.x

我收到一个错误......我知道我做错了什么，但不知道如何解决它。我知道我不能将字符串添加到整数......任何想法，我将不胜感激！

```
 self.variables['gas'] = 'gas'+add
TypeError: Can't convert 'int' object to str implicitly 
```

我的代码：

```
class Cars:        
    def __init__(self, **kwargs):
        self.variables = kwargs

    def set_Variable(self, k, v):
        self.variables[k] = v

    def get_Variable(self, k):
        return self.variables.get(k, None)     

    def add_gas(self, add, gas):
        self.variables['gas'] = gas+add

def main():
    mercedes = Cars(gas = 3)
    print (mercedes.get_Variable('gas'))
    print(mercedes.add_gas(4))

if __name__ == "__main__": main() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:43:45.413

您的方法 add_gas 需要两个参数，您只需将一个参数传递给函数。尽管函数中没有返回值，但您也在打印返回值。

这个对我有用：

```
class Cars:        
    def __init__(self, **kwargs):
        self.variables = kwargs

    def set_Variable(self, k, v):
        self.variables[k] = v

    def get_Variable(self, k):
        return self.variables[k]     

    def add_gas(self, add):
        self.variables['gas'] +=add

def main():
    mercedes = Cars(gas = 3)
    print (mercedes.get_Variable('gas'))
    mercedes.add_gas(4)
    print (mercedes.get_Variable('gas'))
    print ('There are %s gallons of gas in the car.' % mercedes.get_Variable('gas'))

if __name__ == "__main__": 
    main() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:46:47.987

所以，我看到你的代码有两个独立的问题：

*   在您的错误消息中，您显示了这一行：

    ```
    self.variables['gas'] = 'gas'+add 
    ```

    在您的代码中，该行是这样的：

    ```
    self.variables['gas'] = gas+add 
    ```

    那是两种不同的意思。第一个尝试将变量`add`连接到字符串`'gas'`，这将作为整数失败`add`，Python 不会将整数隐式转换为字符串（错误告诉你）。所以你会想做`'gas' + str(add)`。

*   在你的`main`函数中，你调用这样的`add_gas`方法：

    ```
    mercedes.add_gas(4) 
    ```

    但是您实际上使用两个参数定义了该方法，`add`and `gas`，因此这将失败。

我认为你想要做的是在调用方法时增加`self.variables['gas']`值`add`，所以你会想这样写你的方法：

```
def add_gas(self, add):
    self.variables['gas'] = self.variables['gas'] + add 
```

请注意，您可以使用`+=`运算符将​​其缩短为：

```
def add_gas(self, add):
    self.variables['gas'] += add 
```

最后，我不知道您为什么要为您的语言环境实例变量使用字典，但除非您有充分的理由这样做，否则为什么不`gas`为您的汽车类型定义一个属性？

# svg - 带有 ffmpeg 的 svg 幻灯片

> ID：15118609
> 
> 赞同：1
> 
> 时间：2013-02-27T17:38:33.370
> 
> 标签：svg, ffmpeg

谁能指出我，如何用 svg 图像制作幻灯片（使用 ffmpeg）。通常的方式，

```
ffmpeg -i bloch_0%2d.svg bloch2.mp4 
```

不起作用，因为 ffmpeg 显然无法处理 svg 文件（处理输入时发现无效数据）有没有简单的方法可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T23:23:11.033

首先将 SVG 图像转换为光栅格式，例如 PNG 或 JPEG。如果您的 SVG 编辑器不支持导出为光栅格式，可以使用 ImageMagick 的`convert`命令来完成：

```
convert bloch_*.svg bloch_%03d.png 
```

注意：为获得最佳 SVG 支持，请确保编译 ImageMagick 以使用 RSVG 库。 [细节](http://www.imagemagick.org/Usage/draw/#svg)

接下来，使用以下命令将光栅图像转换为 MP4 中的 H.264 `ffmpeg`：

```
ffmpeg -r 1 -i bloch_%03d.png -pix_fmt yuv420p bloch2.mp4 
```

该`-r 1`选项将输入的帧速率设置为每秒 1 帧，但您可以将其设置为您喜欢的任何值，具体取决于这些是独立图像还是某种连续动画。

`-pix_fmt yuv420p`不是必需的，但 PNG 颜色没有二次采样。H.264 视频可以通过专门的配置文件支持非二次采样颜色，但大多数播放器仅支持 4:2:0 颜色二次采样，因此您可能希望将其转换为 4:2:0。JPEG 通常使用 4:2:0，因此如果您的输入是 JPEG，那么您通常不需要此选项。

# firefox - SVG 文本元素 text-anchor="middle" 在 Firefox 中不起作用

> ID：15118610
> 
> 赞同：3
> 
> 时间：2013-02-27T17:38:34.693
> 
> 标签：firefox, text, svg, d3.js

我正在使用 D3 创建条形图，并且我想将文本标签与条形的中间对齐。我正在使用 text-anchor 属性并将其设置为“中间”。这在 Chrome 中运行良好，但在 Firefox 中对齐方式很差。我将矩形和文本分组在单独的父 g 元素中，以便在数据更改时实现一堆不同的过渡效果（例如条形分割）。

这是我的 SVG：

```
<svg width="650" height="400">
 <g class="groups" transform="translate(25,0)">
  <g class="group" transform="translate(0,0)">
   <g class="bar"><rect class="subBar" x="0" y="60" width="192" height="310"/></g>
   <g class="dataLabel"><text text-anchor="middle" class="subLabel" style="font-size: 14px; opacity: 1;" dx="96.25" dy="55">83%</text></g>
  </g>
  <g class="group" transform="translate(207.5,0)">
   <g class="bar"><rect class="subBar" x="0" y="97.22891566265059" width="192" height="272.7710843373494"/></g>
   <g class="dataLabel"><text text-anchor="middle" class="subLabel" style="font-size: 14px; opacity: 1;" dx="96.25" dy="92.22891566265059">73%</text></g>
  </g>
  <g class="group" transform="translate(415,0)">
   <g class="bar"><rect class="subBar" x="0" y="93.50602409638549" width="192" height="276.4939759036145"/></g>
   <g class="dataLabel"><text text-anchor="middle" class="subLabel" style="font-size: 14px; opacity: 1;" dx="96.25" dy="88.50602409638549">74%</text></g>
  </g>
</g>
</svg> 
```

我不知道是什么导致了这个问题。有人可以帮我解决问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T18:18:48.447

我认为您应该使用“x”而不是“dx”来放置标签。假设您希望文本位于该 x 位置并锚定在中间。dx 是为了从我认为的锚定位置偏移。

同样，您可能的意思是使用“y”而不是“dy”。使用 dy 调整基线上方或下方的高度（通常以“em”为单位），使用 y 实际定位文本。

尝试：

```
<svg width="650" height="400">
 <g class="groups" transform="translate(25,0)">
  <g class="group" transform="translate(0,0)">
   <g class="bar"><rect class="subBar" x="0" y="60" width="192" height="310"/></g>
   <g class="dataLabel"><text text-anchor="middle" class="subLabel" style="font-size: 14px; opacity: 1;" x="96.25" y="55">83%</text></g>
  </g>
  <g class="group" transform="translate(207.5,0)">
   <g class="bar"><rect class="subBar" x="0" y="97.22891566265059" width="192" height="272.7710843373494"/></g>
   <g class="dataLabel"><text text-anchor="middle" class="subLabel" style="font-size: 14px; opacity: 1;" x="96.25" y="92.22891566265059">73%</text></g>
  </g>
  <g class="group" transform="translate(415,0)">
   <g class="bar"><rect class="subBar" x="0" y="93.50602409638549" width="192" height="276.4939759036145"/></g>
   <g class="dataLabel"><text text-anchor="middle" class="subLabel" style="font-size: 14px; opacity: 1;" x="96px" y="88.50602409638549">74%</text></g>
  </g>
 </g>
</svg> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T19:06:51.323

当您应该使用 x 和 y 时，您正在使用 dx 和 dy 来定位文本

# assembly - 在给定的机器代码中，地址 FF01 和 FF02 的内容是从给定的相应汇编程序的哪一行翻译而来的？

> ID：15118614
> 
> 赞同：0
> 
> 时间：2013-02-27T17:38:43.090
> 
> 标签：assembly, machine-learning

在给定的机器代码中，地址 FF01 和 FF02 的内容是从给定的相应汇编程序的哪一行翻译而来的？

汇编代码：

```
dips   equ      12h
leds   equ      11

       org      ff01
loop:  in       dips

       cma

       out      leds    
       cpi      00000000b 
       jnz      loop

       rst      7
       end 
```

机器码：

```
FF01    DB
FF02    12
FF03    2F
FF04    D3
FF05    11
FF06    FE
FF07    00
FF08    C2
FF09    01
FF0A    FF
FF0B    FF 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:12:51.480

以下两个字节：

```
FF01    DB
FF02    12 
```

是以下指令的机器代码：

```
loop:  in       dips 
```

# sql - 计算日期之间的分钟数并获得前 10

> ID：15118615
> 
> 赞同：1
> 
> 时间：2013-02-27T17:38:45.683
> 
> 标签：sql, oracle, plsql

所以我有一个包含两个不同日期的表，我选择了以下之间的分钟差：

```
 select customerID, customers.telNumber,
   sum(round((enddate - startdate) * 1440)) over (partition by telNumber) total_mins
    from table; 
```

之后，我只想获得分钟数最多的前 5 名，例如

```
 rank() over (partition by total_mins order by total_mins) 
```

一个人会怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:51:00.190

像这样的东西应该适合你：

```
SELECT * 
FROM (
  SELECT customerId, telNumber, rank() over (order by total_mins) rnk
  FROM (
    SELECT customerId,telNumber,
     sum(round((enddate - startdate) * 1440)) over (partition by telNumber) total_mins
    FROM YourTable
  ) t
) t
WHERE rnk <= 10 
```

这将使您获得联系，因此它可以返回超过 10 行。如果您只想返回 10 行，请使用`ROW_NUMBER()`而不是`RANK()`.

[SQL 小提琴演示](http://sqlfiddle.com/#!4/668d4/3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:54:49.983

我会在 sgeddes 的示例中添加 rank() 和 row_number() 的组合是最好的，因为 rank() 可能会为所有或几行返回相同的排名值。但是 row_number() 总是不同的。我会在 Where 子句中使用 row_number()，而不是 rank()。

# ios - NSLineBreakByWordWrapping 会中断哪些字符？

> ID：15118623
> 
> 赞同：2
> 
> 时间：2013-02-27T17:39:17.013
> 
> 标签：ios, objective-c, uilabel

**精简版**

从文档：

> `NSLineBreakByWordWrapping`
> 
> 换行发生在单词边界，除非单词本身不适合单行。

所有单词边界字符的集合是什么？

**更长的版本**

我有一组 UILabel，其中包含文本，有时还包括 URL。我需要知道 URL 的确切位置（`frame`, not `range`），以便使它们可点击。我的数学主要是有效的，但我必须对某些字符进行测试：

```
 // This code only reached if the URL is longer than the available width
    NSString *theText = // A string containing an HTTP/HTTPS URL
    NSCharacterSet *breakChars = [NSCharacterSet characterSetWithCharactersInString:@"?-"];
    NSString *charsInRemaininsSpace = // NSString with remaining text on this line

    NSUInteger breakIndex = NSNotFound;

    if (charsInRemaininsSpace)
        breakIndex = [charsInRemaininsSpace rangeOfCharacterFromSet:breakChars
                                                            options:NSBackwardsSearch].location;

    if (breakIndex != NSNotFound && breakIndex != theText.length-1) {
        // There is a breakable char in the middle, so draw a URL through that, then break
        // ...
    } else {
        // There is no breakable char (or it's at the end), so start this word on a new line
        // ...
    } 
```

我的 NSCharacterSet 中的字符只是？和 -，我发现 NSLineBreakByWordWrapping 中断了。它不会中断我在 % 和 = 等 URL 中看到的其他字符。是否有我应该打破的角色的完整列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:53:46.740

我建议使用“非字母数字”作为您的测试。

```
[[NSCharacterSet alphanumerCharacterSet] invertedSet] 
```

也就是说，如果你做了很多这样的事情，你可能想要考虑使用`CTFramesetter`来做你的布局而不是`UILabel`. 然后你可以`CTRunGetImageBounds`用来计算实际的矩形。您不必计算分词，因为`CTFrame`已经为您完成了此操作（并且可以保证使用相同的算法）。

# javascript - Math.round 舍入误差

> ID：15118629
> 
> 赞同：6
> 
> 时间：2013-02-27T17:39:42.380
> 
> 标签：javascript, math, rounding

我想四舍五入**`1.006`**到两位小数，期望 1.01 作为输出

当我这样做的时候

```
var num = 1.006;
alert(Math.round(num,2)); //Outputs 1 
alert(num.toFixed(2)); //Output 1.01 
```

相似地，

```
var num =1.106;
alert(Math.round(num,2)); //Outputs 1
alert(num.toFixed(2));; //Outputs 1.11 
```

所以

*   每次都使用 toFixed() 是否安全？
*   toFixed() 是跨浏览器投诉吗？

请给我建议。

PS：我尝试在堆栈溢出中搜索类似的答案，但无法得到正确的答案。

**`EDIT:`**

为什么**`1.015`**返回 1.01 而 as**`1.045`**返回 1.05

```
var num =1.015;
alert(num.toFixed(2)); //Outputs 1.01
alert(Math.round(num*100)/100); //Outputs 1.01 
```

然而

```
var num = 1.045;
alert(num.toFixed(2)); //Outputs 1.04
alert(Math.round(num*100)/100); //Outputs 1.05 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:43:14.727

尝试类似...

```
Math.round(num*100)/100

1) Multiple the original number by 10^x (10 to the power of x)
2) Apply Math.round() to the result
3) Divide result by 10^x 
```

来自：[http ://www.javascriptkit.com/javatutors/round.shtml](http://www.javascriptkit.com/javatutors/round.shtml)

（将任何数字四舍五入到 x 小数点）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-07-04T05:48:05.150

这个公式`Math.round(num*100)/100`并不总是好的。例子

```
Math.round(0.145*100)/100 = 0.14 
```

这是错误的，我们希望它是`0.15`

**解释**

**问题**是我们有这样的花车

```
0.145 * 100 = 14.499999999999998 
```

**第一步**

所以如果我们四舍五入，我们需要在我们的`product`.

0.145 * 100 + 1e-14 = 14.500000000000009

我假设有时`product`可能类似于`1.000000000000001`，但如果我们添加它不会有问题，对吧？

**第二步**

计算我们应该添加多少？

我们知道 java 脚本中的浮点数是 17 位。

```
let num = 0.145
let a = Math.round(num*100)/100
let b = a.toString().length
let c = 17-b-2
let result = Math.round(num*100 + 0.1**c)/100
console.log(result)
console.log('not - ' + a ) 
```

(-2) - 只是为了确保我们不会落入同样的四舍五入陷阱。

**单线：**

```
let num = 0.145
let result = Math.round(num*100 + 0.1**(17-2-(Math.round(num*100)/100).toString().length))/100 
```

**附加功能**

请记住，以上所有内容都适用于正数。如果四舍五入负数，则需要减去一点。所以最后的 One-liner 将是：

```
let num = -0.145
let result = Math.round(num*100 + Math.sign(num)*0.1**(17-2-(Math.round(num*100)/100).toString().length))/100 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-06-13T10:50:11.480

我意识到这个问题已经相当老了，但即使在提出这个问题 5 年后，我仍然会遇到这个问题。

我知道的这个舍入问题的一个有效解决方案是将数字转换为字符串，获取所需的精度数字并使用数学规则向上或向下舍入。

可以在以下小提琴中找到 Math.round 提供意外舍入的示例和字符串舍入的示例：http: [//jsfiddle.net/Shinigami84/vwx1yjnr/](http://jsfiddle.net/Shinigami84/vwx1yjnr/)

```
function round(number, decimals = 0) {
    let strNum = '' + number;
    let negCoef = number < 0 ? -1 : 1;
    let dotIndex = strNum.indexOf('.');
    let start = dotIndex + decimals + 1;
    let dec = Number.parseInt(strNum.substring(start, start + 1));
    let remainder = dec >= 5 ? 1 / Math.pow(10, decimals) : 0;
    let result = Number.parseFloat(strNum.substring(0, start)) + remainder * negCoef;
    return result.toFixed(decimals);
}
let num = 0.145;
let precision = 2;

console.log('math round', Math.round(num*Math.pow(10, precision))/Math.pow(10, precision));
// 0.145 rounded down to 0.14 - unexpected result
console.log('string round', round(num, precision));
// 0.145 rounded up to 0.15 - expected result 
```

Math.round 在这里不能正常工作，因为 0.145 乘以 100 是 14.499999999999998，而不是 14.5。因此，Math.round 会将其四舍五入，就好像它是 14.4。如果将其转换为字符串并减去所需的数字 (5)，然后使用标准数学规则对其进行四舍五入，您将得到预期结果 0.15（实际上，0.14 + 0.01 = 0.15000000000000002，使用“toFixed”得到一个不错的四舍五入结果）。

# java - Spring Framework应用中JDBC使用RowMapper的一些疑惑

> ID：15118630
> 
> 赞同：15
> 
> 时间：2013-02-27T17:39:42.850
> 
> 标签：java, spring, spring-mvc, jdbc, spring-jdbc

我正在研究如何在 Spring Framework 中使用 JDBC 对数据库执行查询。

我正在关注本教程：[http ://www.tutorialspoint.com/spring/spring_jdbc_example.htm](http://www.tutorialspoint.com/spring/spring_jdbc_example.htm)

在本教程中，我定义了一个**StudentDAO**接口，它只定义了我想要的 CRUD 方法。

然后定义**Student**类，它是我要在 Student 数据库表上持久保存的实体。

然后定义**StudentMapper**类，它是**RowMapper**接口的特定实现，在这种情况下，用于将**ResultSet**中的特定记录（由查询返回）映射到**Student**对象。

然后我有**StudentJDBCTemplate**，它表示我的StudentDAO接口的实现**，**在这个类中我实现了接口中定义的CRUD方法。

**好的，现在我对StudentMapper**类的工作方式有疑问：在这个**StudentJDBCTemplate**类中，定义了返回 Student 数据库表中所有记录列表的方法，这个：

```
 public List<Student> listStudents() {
      String SQL = "select * from Student";
      List <Student> students = jdbcTemplateObject.query(SQL, 
                                new StudentMapper());
      return students;
   } 
```

你怎么看，这个方法返回一个学生对象列表，并以下列方式工作：

它做的第一件事是在 SQL 字符串中定义**返回 Student 数据库表中所有记录的查询。**

然后这个查询是通过jdbcTemplateObject对象上的查询方法调用来执行的（即**JdbcTemplate** Spring类的一个实例**

此方法采用两个参数：SQL 字符串（包含必须执行的 SQL 查询）和一个新的**StudentMapper**对象，该对象采用查询返回的**ResultSet**对象并将其记录映射到新的 Student 对象

在这里阅读：[http](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/jdbc/core/JdbcTemplate.html) : //static.springsource.org/spring/docs/current/javadoc-api/org/springframework/jdbc/core/JdbcTemplate.html 说：**执行给定静态SQL的查询，将每一行映射到Java通过 RowMapper 对象。**

我的疑问与我的**StudentMapper使用****mapRow()**方法在 Student 对象上映射 ResultSet 记录有关，这是代码：

```
package com.tutorialspoint;

import java.sql.ResultSet;
import java.sql.SQLException;
import org.springframework.jdbc.core.RowMapper;

public class StudentMapper implements RowMapper<Student> {
   public Student mapRow(ResultSet rs, int rowNum) throws SQLException {
      Student student = new Student();
      student.setId(rs.getInt("id"));
      student.setName(rs.getString("name"));
      student.setAge(rs.getInt("age"));
      return student;
   }
} 
```

那么，谁调用这个**mapRow**方法呢？它是由 Spring Framework 自动调用的吗？（因为在此示例中从未手动调用...）

肿瘤坏死因子

安德烈亚

然后这个查询是通过jdbcTemplateObject对象上的查询方法调用来执行的（即**JdbcTemplate** Spring类的一个实例**

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-27T17:57:53.333

当您将您的实例传递`RowMapper`给`JdbcTemplate`方法时

```
List <Student> students = jdbcTemplateObject.query(SQL, new StudentMapper()); 
```

`JdbcTemplate`取决于您调用的方法，将在内部使用映射器及其从 JDBC 连接获得的结果集来创建您请求类型的对象。例如，由于您调用`JdbcTemplate#query(String, RowMapper)`了 ，该方法将使用您的 String SQL 来查询数据库，并将循环遍历每个“行” `ResultSet`，如下所示：

```
ResultSet rs = ... // execute query
List<Student> students = ...// some list
int rowNum = 0;
while(rs.next()) {
    Student student = rowMapper.mapRow(rs, rowNum);
    students.add(student);
    rowNum++;
}

return students; 
```

因此，`Spring`的`JdbcTemplate`方法将使用`RowMapper`您提供的并调用其`mapRow`方法来创建预期的返回对象。

您可能希望将 Martin Fowler 的[Data Mapper](http://martinfowler.com/eaaCatalog/dataMapper.html)与[Table Data Gateway](http://martinfowler.com/eaaCatalog/tableDataGateway.html)结合使用，以了解这些东西如何分布并提供[低耦合](http://en.wikipedia.org/wiki/GRASP_%28object-oriented_design%29)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T18:02:29.657

这是我与 BeanPropertyRowMapper 一起使用的典型模式。它节省了大量的编码。您的查询需要为每一列设置别名以匹配类中的属性名称。在这种情况下`species_name as species`，其他列名恰好已经匹配。

```
public class Animal {
    String species;
    String phylum;
    String family;
    ...getters and setters omitted
}

@Repository
public class AnimalRepository {
    private NamedParameterJdbcTemplate namedParameterJdbcTemplate;

    @Autowired
    public void setDataSource(DataSource dataSource) {
        this.namedParameterJdbcTemplate = new NamedParameterJdbcTemplate(dataSource);
    }

    public List<Animal> getAnimalsByPhylum(String phylum) {
        String sql = " SELECT species_name as species, phylum, family FROM animals"
                 +" WHERE phylum = :phylum";

        Map<String, Object> namedParameters = new HashMap<String, Object>();
        namedParameters.put("phylum", phylum);
        SqlParameterSource params = new MapSqlParameterSource(namedParameters);
        List<Animal> records = namedParameterJdbcTemplate.query(sql,
                params, BeanPropertyRowMapper.newInstance(Animal.class));

        return records;
    }
} 
```

当您需要对每行进行更多自定义时，另一种方法是使用 RowMapper（此示例仅使用匿名类）：

```
 List<Animal> records = namedParameterJdbcTemplate.query(sql,
            params, new RowMapper<Animal>(){
        public Animal mapRow(ResultSet rs, int i) throws SQLException {
            Animal animal = new Animal();   
            animal.setSpecies(rs.getString("species_name"));
            if (some condition) {
                animal.setPhylum(rs.getString("phylum"));
            } else {
                animal.setPhylum(rs.getString("phylum")+someThing());
            }
            animal.setFamily(rs.getString("family"));

            return animal;
        }
    }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-30T11:16:31.620

在 Spring 中使用 RowMapper

```
import java.sql.ResultSet;
import java.sql.SQLException;

import org.springframework.jdbc.core.RowMapper;

public class RowsMap implements RowMapper<EmpPojo>{

    @Override
    public EmpPojo mapRow(ResultSet rs, int counts) throws SQLException {
        EmpPojo em=new EmpPojo();
        em.setEid(rs.getInt(1));
        em.setEname(rs.getString(2));
        em.setEsal(rs.getDouble(3));

        return em;
    }

}

Finally in Main class

List<EmpPojo> lm=jt.query("select * from emps", new RowsMap());
for(EmpPojo e:lm)
{
    System.out.println(e.getEid()+" "+e.getEname()+" "+e.getEsal());
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T17:56:05.907

> 那么，谁调用这个 mapRow 方法呢？它是由 Spring Framework 自动调用的吗？（因为在此示例中从未手动调用...）

这是由 spring 框架自动调用的。您只需要指定

> 1.  连接参数，
> 2.  SQL 语句
> 3.  声明参数并提供参数值
> 4.  完成每次迭代的工作。

# ruby - - 续集/适配器/ (Sequel::AdapterNotFound)

> ID：15118633
> 
> 赞同：2
> 
> 时间：2013-02-27T17:39:50.290
> 
> 标签：ruby, sqlite, sequel

我正在尝试使用 Sequel.connect(database_name) 连接到 sqlite 数据库它返回以下错误：

```
DEBUG OmlSqlSource: Connecting Sequel

/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': LoadError: cannot load such file -- sequel/adapters/ (Sequel::AdapterNotFound) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-01-19T03:12:02.533

我遇到了类似的错误，但事实证明我需要`sqlite3`在我的 Gemfile 中包含 gem。

另外，我为适配器使用了错误的名称。我`sqlite3`用来匹配 gem 名称，但 Sequel 期望的名称只是`sqlite`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:44:39.593

你可能想要`Sequel.connect('sqlite:///path/to/database.sqlite')`或`Sequel.sqlite('/path/to/database.sqlite')`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-04T13:25:29.190

如果连接字符串没有适配器前缀，例如`mydb.sqlite3`而不是`sqlite://mydb.sqlite3`.

即尝试运行时

```
sequel -m migrations development.sqlite 
```

代替

```
sequel -m migrations sqlite://development.sqlite 
```

# python - 使用通过python连接的表单将数据插入数据库

> ID：15118635
> 
> 赞同：1
> 
> 时间：2013-02-27T17:40:05.060
> 
> 标签：python, mysql, forms

我在 html 文档中创建了一个表单来从用户那里获取数据。我在 mysql 中创建了一个数据库。我正在使用 python 将数据库连接到表单，以便用户输入填充数据库。但它不工作。提交值后，我在浏览器页面上打印了以下代码，并且没有值从表单中插入到数据库中。你能指出代码中的错误/任何修改吗？

```
import cgitb;cgitb.enable()
import MySQLdb
import cgi
import sys

form=cgi.FieldStorage()
Text0=form.getValue('Text0')
Text1=form.getValue('Text1')
Text2=form.getValue('Text2')
Text3=form.getValue('Text3')
Text4=form.getValue('Text4')

# Open database connection
dbc = MySQLdb.connect("127.0.0.1","root","sam143","project" )

# prepare a cursor object using cursor() method
cursor = dbc.cursor()

# Prepare SQL query to INSERT a record into the database.

sql = """INSERT INTO entries(slno, \
       dat1, dat2, dat3, dat4, dat5) \
       VALUES ('%d', '%d', '%d', '%d', '%d', '%d' )""" % \
       (l[0], l[1], l[2], l[3], l[4])

try:
   # Execute the SQL command
   cursor.execute(sql)
   sql = "SELECT * FROM entries"
   cursor.execute(sql)
   print cursor.fetchall()
   # Commit your changes in the database
   dbc.commit()

except:
   # Rollback in case there is any error
   dbc.rollback()

# disconnect from server
dbc.close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:24:28.447

```
>>> form=cgi.FieldStorage()
>>> dir(form)
['FieldStorageClass', '_FieldStorage__write', '__contains__', '__doc__', '__getattr__', '__getitem__', '__init__', '__iter__', '__len__', '__module__', '__nonzero__', '__repr__', 'bufsize', 'disposition', 'disposition_options', 'done', 'fi
le', 'filename', 'fp', 'getfirst', 'getlist', 'getvalue', 'has_key', 'headers', 'innerboundary', 'keep_blank_values', 'keys', 'length', 'list', 'make_file', 'name', 'outerboundary', 'qs_on_post', 'read_binary', 'read_lines', 'read_lines_to
_eof', 'read_lines_to_outerboundary', 'read_multi', 'read_single', 'read_urlencoded', 'skip_lines', 'strict_parsing', 'type', 'type_options']
>>> 
```

form.getvalue 不是 form.getValue

# javascript - 模态应该从顶部滑动

> ID：15118637
> 
> 赞同：0
> 
> 时间：2013-02-27T17:40:12.947
> 
> 标签：javascript, jquery, twitter-bootstrap, jquery-ui

实现了 twitter boots trap 的模态...... .

实际模态

[http://jsfiddle.net/nJ6Mw/1/](http://jsfiddle.net/nJ6Mw/1/)

模态不从顶部滑动

[http://jsfiddle.net/y88WX/12/embedded/result/](http://jsfiddle.net/y88WX/12/embedded/result/)

```
<div id="example" class="modal hide fade in" style="display: block;" aria-hidden="false">
                <div class="modal-header"> <a class="close" data-dismiss="modal">×</a>

                     <h3>This is a Modal Heading</h3>

                </div>
                <div class="modal-body">
                     <h4>Text in a modal</h4>

                    <p>You can add some text here.</p>
                </div>
                <div class="modal-footer"> <a href="#" class="btn btn-success">Call to action</a>
 <a href="#" class="btn" data-dismiss="modal">Close</a>

                </div>
            </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T16:36:40.833

这可能是因为您将它放在#container div 中，而不是在正文中？很难说，因为你是第二小提琴没有正确编译

# xml - 参考架构中的标准 HTML 元素

> ID：15118642
> 
> 赞同：1
> 
> 时间：2013-02-27T17:40:21.023
> 
> 标签：xml, xsd

我有一个具有 HTML 类型的自定义 xml 架构。我想引用几个可以在这个 html 类型（a、p、ul 等）中使用的“标准”html 元素。我找到了具有这些元素的以下架构。

[http://www.w3.org/2002/08/xhtml/xhtml1-strict.xsd](http://www.w3.org/2002/08/xhtml/xhtml1-strict.xsd)

我添加了以下行来导入架构

```
<xs:import schemaLocation="http://www.w3.org/2002/08/xhtml/xhtml1-strict.xsd" /> 
```

我正在尝试使用里面的元素，如下所示

```
<xs:complexType name="Html">
  <xs:choice maxOccurs="unbounded">
    <xs:element ref="ul"></xs:element>
  </xs:choice>
</xs:complexType> 
```

它不起作用，我错过了什么？这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T01:07:20.060

导入模式中定义的 HTML 元素位于 xhtml 命名空间中：`http://www.w3.org/1999/xhtml`. 因此，您还应该为您的元素添加一个`namespace="http://www.w3.org/1999/xhtml"`属性。`<xs:import>`为了引用导入模式中定义的元素和类型，您需要有一个命名空间定义，其中包含 xhtml 命名空间的一些前缀。那就是：你需要在你的元素中有例如`xmlns:xh="http://www.w3.org/1999/xhtml"`定义，然后当你引用在 XHTML 模式中定义的类型、元素等时`<xs:schema>`使用这个前缀（这里）。`xh`

所以你的示例代码变成：

```
<xs:schema 
    ... 
    xmlns:xh="http://www.w3.org/1999/xhtml"
    ...
    >

<xs:import schemaLocation="http://www.w3.org/2002/08/xhtml/xhtml1-strict.xsd"
           namespace="http://www.w3.org/1999/xhtml" />

    <xs:complexType name="Html">
      <xs:choice maxOccurs="unbounded">
        <xs:element ref="xh:ul"></xs:element>
      </xs:choice>
    </xs:complexType>

</xs:schema> 
```

# android - 像 YouTube App 一样在 SLideMenu 中制作 ListView

> ID：15118643
> 
> 赞同：1
> 
> 时间：2013-02-27T17:40:22.030
> 
> 标签：android, listview

我想在 SlideMenu 中模拟这种类型的 Listview。我的 SlideMenu 工作正常。它是一个 ListFragment。我想像 Android 上的 YouTube 应用一样复制这种模式：

![在此处输入图像描述](../Images/733c0e6d7137fd43097d09f9a4b0282d.png)

我基本上有几个列表项需要添加到类别列表的顶部。我想要一个标题分开。

我要这个：

```
Home
Profile
Top Items

Header that says Categories
And List of Categories 
```

我已经在我的`SlideMenu`. 它们来自一个`adapter`从`MySQL`. 但前三个项目并非来自同一张表（或任何表）。顶部是 a 的标题`ListView`吗？是它自己的`ListView`吗？或者..？

请记住，我希望能够对列表进行排序（我已经通过 a 获得了`spinner`）。所以类别必须是动态的。但是*如何在上面添加几个静态项目*并*制作标题*？

我真的不需要代码示例，我只想知道实现它的方法。

**编辑：这是正在进行的代码** 这显示了 Youtube 示例中的 Channels 行一样的分隔符。还需要弄清楚如何在顶部添加这两个或三个静态行。

```
@Override
    public View getView(int position, View convertView, ViewGroup parent) {

        ViewHolder holder;
        holder = new ViewHolder();

        View rowView = convertView;
        LayoutInflater inflater = ((Activity) context).getLayoutInflater();
        int type = getItemViewType(position);

        if (rowView == null) {

            switch (type) {
            case TYPE_ITEM:
                rowView = inflater.inflate(R.layout.mastercat_layout, null,
                        true);
                holder.textView = (TextView) rowView.findViewById(R.id.label);
                holder.textView.setTypeface(tf);
                holder.imageView = (ImageView) rowView.findViewById(R.id.icon);

                break;
            case TYPE_SEPARATOR:
                rowView = inflater.inflate(R.layout.mastercat_layout_separate, null);

                break;
            }

            rowView.setTag(holder);

        } else {

            holder = (ViewHolder) rowView.getTag();
        }

        holder.textView.setText(getItem(position));
        holder.imageView.setImageResource(R.drawable.ic_launcher);

        return rowView;

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:47:51.983

也许您需要在适配器中使用几个 convertView 池？BaseAdapter 包含方法

```
public int getItemViewType (int position) 
```

和

```
public int getViewTypeCount () 
```

您可以覆盖它以实现 2 个视图池 - 一个用于 Headers，另一个用于 ListView 的 Items。同样在这种情况下，您需要根据 getItemViewType() 返回的 itemViewType 更改 getView 方法。

# ios - 卡在 UIActionSheetPicker , iOS

> ID：15118655
> 
> 赞同：1
> 
> 时间：2013-02-27T17:40:50.393
> 
> 标签：ios, uipickerview, uiactionsheet, picker

这将是一个非常有针对性的问题，因为它适用于以前实际使用过[UIActionSheetPicker](https://github.com/TimCinel/ActionSheetPicker)的人。

我在我的 iphone 应用程序中使用了它，一切都很好，但是现在我尝试在我的 ipad 上实现它，我遇到了一些问题。

主要问题是，在 ipad 上，如果您愿意，选择器会显示为“气泡”或“信息窗口”，它指向调用它的位置，如按钮、文本字段等。

下面是一个例子：

![在此处输入图像描述](../Images/7ec8d15dd6edbee2886a78db3f03f38a.png)

您可以看到“信息窗口”指向动物按钮。

在我的应用程序中，我有 4 个不同的按钮。2 个位于屏幕顶部，2 个位于屏幕底部。

那些在底部的人，很好地调用了选择器，选择器出现在指向他们的按钮的顶部。

**但是**，屏幕顶部的那些（几乎就像图像中的那个）当他们调用选择器时，选择器在屏幕上显示得更低，并且不应该指向它们......

我的意思是我希望出现在指向它们的按钮下方（如图所示），但它们几乎位于屏幕中央，无处可去。

有任何想法吗？以前有人经历过吗？

## 编辑

* * *

一开始，我在按钮操作中调用 ActionSheetPicker，如下所示：

```
- (IBAction)selectTopic:(UIControl *)sender {
[ActionSheetStringPicker showPickerWithTitle:NSLocalizedString(@"CHOOSE_TOPIC", nil) rows:self.topics initialSelection:self.selectedIndex target:self successAction:@selector(topicWasSelected:element:) cancelAction:@selector(actionPickerCancelled:) origin:sender];

//when user picks a new topic we clean the titleField to make sure selected title of previous topic doesnt mix up with new topic
        titleField.text = @"";

} 
```

现在我试图这样称呼它：

```
- (IBAction)selectTopic:(UIControl *)sender {
    ActionSheetStringPicker *thePicker = [[ActionSheetStringPicker alloc] initWithTitle:NSLocalizedString(@"CHOOSE_TOPIC", nil) rows:self.topics initialSelection:self.selectedIndex target:self successAction:@selector(topicWasSelected:element:) cancelAction:@selector(actionPickerCancelled:) origin:sender];

    thePicker.presentFromRect = topicField.frame;

    [thePicker showActionSheetPicker];

    //when user picks a new topic we clean the titleField to make sure selected title of previous topic doesnt mix up with new topic
titleField.text = @"";
} 
```

topicField 是我的 TextField。

可悲的是结果是一样的。即使现在我正在指定我希望箭头指向的位置，选择器也被称为向下 300 像素。

奇怪的是，即使有另一个比前一个低一点的按钮，选择器又正好下降了 300 像素。

## 编辑2

* * *

在注意到选择器向下显示 300 像素后，我决定手动使其显示向上 300 像素，以准确指向我的按钮。

我使用了以下代码：

```
- (IBAction)selectTopic:(UIControl *)sender {
    //[ActionSheetStringPicker showPickerWithTitle:NSLocalizedString(@"CHOOSE_TOPIC", nil) rows:self.topics initialSelection:self.selectedIndex target:self successAction:@selector(topicWasSelected:element:) cancelAction:@selector(actionPickerCancelled:) origin:sender];

    ActionSheetStringPicker *thePicker = [[ActionSheetStringPicker alloc] initWithTitle:NSLocalizedString(@"CHOOSE_TOPIC", nil) rows:self.topics initialSelection:self.selectedIndex target:self successAction:@selector(topicWasSelected:element:) cancelAction:@selector(actionPickerCancelled:) origin:sender];

    CGRect pickerFrame = topicField.frame;
    pickerFrame.size.height -= 300;
    thePicker.presentFromRect = pickerFrame;

    [thePicker showActionSheetPicker];

    //when user picks a new topic we clean the titleField to make sure selected title of previous topic doesnt mix up with new topic
    titleField.text = @"";

} 
```

令人惊讶的是，按钮再次出现在向下 300 像素的相同位置。我开始相信这可能不是改变选择器位置的属性。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-03T19:52:32.817

在调用代码中设置 presentFromRect 不会产生任何影响，因为它将根据`sender`ActionSheetPicker 代码中的内容进行重置，相反，您需要修改库的源代码。

github 上的以下（未合并）提交应该可以解决问题[在 iPad 上，将弹出框设置为正确指向其容器。](https://github.com/schustafa/ActionSheetPicker/commit/843b80ab8167a987bf27bc8a672e09c19fdc0777)

基本上在`AbstractActionSheetPicker.m`文件中修改`- (void)presentPickerForView:(UIView *)aView`方法如下

```
- (void)presentPickerForView:(UIView *)aView {
    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
     self.presentFromRect = CGRectMake(0, 0, self.containerView.frame.size.width, self.containerView.frame.size.height);
        [self configureAndPresentPopoverForView:aView];
    }
    else {
         self.presentFromRect = aView.frame;
        [self configureAndPresentActionSheetForView:aView];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T19:17:17.367

简要看一下代码后，我想说您要确保 ActionPicker 对象上的 presentFromRect 位于您在 init 中传入的容器的坐标中。例如，如果我有一个包含按钮的大视图：

这是未经测试的：

```
UIView* someBigView = ... // get the big view
UIButton* someButton = ... // get the button that the big view contains

ActionSheetDatePicker* thePicker = [[ActionSheetDatePicker alloc] initWithTitle:@"Some Title" 
    datePickerMode:UIDatePickerModeDate 
    selectedDate:[NSDate date] 
    target:self 
    action:@selector(someMethod:) 
    origin:someBigView];

//the arrow should be pointing at the button
thePicker.presentFromRect = someButton.frame;

[thePicker showActionSheetPicker]; 
```

在我看来，这个库有一个相当大的缺陷，因为它需要一个可以是按钮项或容器的 origin 参数。它要求您查看源代码以理解它，而不是从界面中（有些）明显。

# compiler-construction - cc1plus 中无法识别的命令行选项“-fvar-tracking-assignments-toggle”错误

> ID：15118656
> 
> 赞同：0
> 
> 时间：2013-02-27T17:40:52.953
> 
> 标签：compiler-construction, g++

在编译期间，我收到以下错误：

```
cc1plus: error: unrecognized command line option "-fvar-tracking-assignments-toggle" 
```

如果`cc1plus`运行，则不存在`g++`安装问题。正确的？我不知道如何解释这个错误或如何修复它。

# c++ - 在 C++ 中，判断两个字符串或二进制文件是否不同的最快方法是什么？

> ID：15118661
> 
> 赞同：13
> 
> 时间：2013-02-27T17:41:13.783
> 
> 标签：c++

我正在编写单元测试，需要将结果文件与黄金文件进行比较。最简单的方法是什么？

到目前为止，我有（对于 Linux 环境）：

```
int result = system("diff file1 file2"); 
```

它们是不同的，如果`result != 0`

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-27T18:18:46.833

如果你想要一个纯 c++ 解决方案，我会做这样的事情

```
#include <algorithm>
#include <iterator>
#include <string>
#include <fstream>

template<typename InputIterator1, typename InputIterator2>
bool
range_equal(InputIterator1 first1, InputIterator1 last1,
        InputIterator2 first2, InputIterator2 last2)
{
    while(first1 != last1 && first2 != last2)
    {
        if(*first1 != *first2) return false;
        ++first1;
        ++first2;
    }
    return (first1 == last1) && (first2 == last2);
}

bool compare_files(const std::string& filename1, const std::string& filename2)
{
    std::ifstream file1(filename1);
    std::ifstream file2(filename2);

    std::istreambuf_iterator<char> begin1(file1);
    std::istreambuf_iterator<char> begin2(file2);

    std::istreambuf_iterator<char> end;

    return range_equal(begin1, end, begin2, end);
} 
```

它避免将整个文件读入内存，并在文件不同（或文件末尾）时立即停止。range_equal 因为`std::equal`第二个范围不使用一对迭代器，如果第二个范围更短，则不安全。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-08-23T09:17:33.057

从[DaveS 的答案](https://stackoverflow.com/a/15119347/2436175)开发，并首先[检查文件大小](https://stackoverflow.com/a/5840160/2436175)：

```
#include <fstream>
#include <algorithm>

bool compare_files(const std::string& filename1, const std::string& filename2)
{
    std::ifstream file1(filename1, std::ifstream::ate | std::ifstream::binary); //open file at the end
    std::ifstream file2(filename2, std::ifstream::ate | std::ifstream::binary); //open file at the end
    const std::ifstream::pos_type fileSize = file1.tellg();

    if (fileSize != file2.tellg()) {
        return false; //different file size
    }

    file1.seekg(0); //rewind
    file2.seekg(0); //rewind

    std::istreambuf_iterator<char> begin1(file1);
    std::istreambuf_iterator<char> begin2(file2);

    return std::equal(begin1,std::istreambuf_iterator<char>(),begin2); //Second argument is end-of-range iterator
} 
```

（我想知道在倒带之前`fileSize`是否可以用来创建一个更有效的流迭代器结束，通过知道流长度，它可以`std::equal`同时处理更多字节）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T17:50:21.747

防止读取这两个文件的一种方法是将黄金文件预先计算为哈希，例如 md5。然后你只需要检查测试文件。请注意，这可能比仅读取两个文件要慢！

或者，分层检查 - 查看文件大小，如果它们不同，则文件不同，您可以避免冗长的读取和比较操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T17:48:15.867

这应该有效：

```
#include <string>
#include <fstream>
#include <streambuf>
#include <iterator>

bool equal_files(const std::string& a, const std::string& b)
  std::ifstream stream{a};
  std::string file1{std::istreambuf_iterator<char>(stream),
                    std::istreambuf_iterator<char>()};

  stream = std::ifstream{b};
  std::string file2{std::istreambuf_iterator<char>(stream),
                    std::istreambuf_iterator<char>()};

  return file1 == file2;
} 
```

我怀疑这没有那么快`diff`，但它避免了调用 `system`。不过，对于测试用例来说应该足够了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T18:19:03.733

可能有点矫枉过正，但您可以使用 boost/bimap 和 boost/scope_exit 构建一个哈希表 SHA-256。

这是 Stephan T Lavavej 制作的视频（从 8.15 开始）： [http ://channel9.msdn.com/Series/C9-Lectures-Stephan-T-Lavavej-Advanced-STL/C9-Lectures-Stephan- T-Lavavej-Advanced-STL-5-of-n](http://channel9.msdn.com/Series/C9-Lectures-Stephan-T-Lavavej-Advanced-STL/C9-Lectures-Stephan-T-Lavavej-Advanced-STL-5-of-n)

有关算法的更多信息： [http ://en.wikipedia.org/wiki/SHA-2](http://en.wikipedia.org/wiki/SHA-2)

# sql - 如何重写使用 self 上的子查询作为连接的查询

> ID：15118663
> 
> 赞同：0
> 
> 时间：2013-02-27T17:41:16.650
> 
> 标签：sql, db2, subquery, self-join

如何将以下查询重写为联接？我认为将其重写为连接会表现更好（我在理论上），但我很难让连接正确。任何帮助深表感谢。

```
SELECT O.JOBNUM, O.JOBNAME, O.STARTTS, 
(SELECT 
    MIN(I.STARTTS)
 FROM TABLE1 AS I
 WHERE 
    I.STARTTS > O.STARTTS AND 
    I.JOBNAME = O.JOBNAME) 
 AS ENDTS
 FROM TABLE1 AS O; 
```

基本上，上述查询用于检索任何给定任务实例的 ENDTS。ENDTS 不会保存，并且会在相同任务循环运行时自动计算，因此任何给定任务的 ENDTS 都是相同任务（由名称标识）再次运行时的 STARTTS。如果任务尚未完成运行，则 NULL 可以用于 ENDTS。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:44:16.863

如果要将其重写为`JOIN`，则可以使用：

```
SELECT o.JOBNUM, 
    o.JOBNAME, 
    o.STARTTS, 
    MIN(i.STARTTS) ENDTS
FROM TABLE1 AS o
LEFT JOIN TABLE1 AS i
    ON i.STARTTS > o.STARTTS 
    AND i.JOBNAME = o.JOBNAME
 GROUP BY o.JOBNUM, o.JOBNAME, o.STARTTS; 
```

# javascript - 如何解析 json 字符串包含 javascript 中的循环引用？

> ID：15118667
> 
> 赞同：5
> 
> 时间：2013-02-27T17:41:40.867
> 
> 标签：javascript, jquery

我在 javascript 中有以下 json 字符串。此字符串包含循环引用。我想以引用将被其实际对象替换的方式解析此字符串。我使用`Json.Parse`，但它创建带有引用的 json 对象。有什么办法可以做到这一点吗？

```
{
  "$id": "1",
  "$values": [
    {
      "$id": "2",
      "Event": {
        "$id": "3",
        "Invitaions": {
          "$id": "4",
          "$values": [
            {
              "$ref": "2"
            },
            {
              "$id": "5",
              "Event": {
                "$ref": "3"
              },
              "Id": 2,
              "Name": "test2",
              "Date": "24",
              "EventId": 1
            }
          ]
        },
        "Id": 1,
        "Name": "marriage",
        "Address": "abcd"
      },
      "Id": 1,
      "Name": "test1",
      "Date": "23",
      "EventId": 1
    },
    {
      "$ref": "5"
    },
    {
      "$id": "6",
      "Event": {
        "$id": "7",
        "Invitaions": {
          "$id": "8",
          "$values": [
            {
              "$ref": "6"
            }
          ]
        },
        "Id": 2,
        "Name": "birthday",
        "Address": "abcd"
      },
      "Id": 3,
      "Name": "test3",
      "Date": "25",
      "EventId": 2
    }
  ]
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:51:09.510

这应该这样做：

```
function resolveReferences(json) {
    if (typeof json === 'string')
        json = JSON.parse(json);

    var byid = {}, // all objects by id
        refs = []; // references to objects that could not be resolved
    json = (function recurse(obj, prop, parent) {
        if (typeof obj !== 'object' || !obj) // a primitive value
            return obj;
        if ("$ref" in obj) { // a reference
            var ref = obj.$ref;
            if (ref in byid)
                return byid[ref];
            // else we have to make it lazy:
            refs.push([parent, prop, ref]);
            return;
        } else if ("$id" in obj) {
            var id = obj.$id;
            delete obj.$id;
            if ("$values" in obj) // an array
                obj = obj.$values.map(recurse);
            else // a plain object
                for (var prop in obj)
                    obj[prop] = recurse(obj[prop], prop, obj)
            byid[id] = obj;
        }
        return obj;
    })(json); // run it!

    for (var i=0; i<refs.length; i++) { // resolve previously unknown references
        var ref = refs[i];
        ref[0][ref[1]] = byid[refs[2]];
        // Notice that this throws if you put in a reference at top-level
    }
    return json;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T20:03:39.923

你应该在 github 上查看 Douglas Crockfords JSON-js repo：[https ://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js)

那里有一个 cycle.js 可以帮助你做你正在寻找的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T06:29:30.667

看看我的帖子，我在上面的代码中发现了一些错误，并且没有数组支持，请查看我的改进版本：[Resolve circular references from JSON object](https://stackoverflow.com/questions/15312529/resolve-circular-references-from-json-object/15757499#15757499)

# git - 检测远程分支的更改

> ID：15118669
> 
> 赞同：1
> 
> 时间：2013-02-27T17:41:47.677
> 
> 标签：git

我目前正在观察变化`.git/refs/remotes/origin/master`

我的目标是检测远程 SHA 的更改，大概是因为有人做出了提交。为了拉下我运行的最新远程详细信息`git fetch --quiet --update-head-ok remoteName`。这似乎不是使用该命令更新的正确文件。

应该观察哪个目录/文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:44:06.983

不要`git`手动监视内部工作中的文件。用来`git`为你检查东西。在这种情况下`git rev-parse --verify origin/master`，将向您显示本地副本的SHA `origin/master`，并`git ls-remote origin master`从远程获取 SHA。

我怀疑您遇到了文件`.git/refs/remotes/origin/master`可能已过期的情况，因为许多不经常更改的引用实际上不再存储在单个文件中，而是存储在`.git/packed_refs`. 如果两者都存在，`git`则知道该信任哪一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:42:11.540

如果远程源上的主分支已更新，则该文件将包含新的提交哈希。不同的遥控器和不同的分支将具有预期的相应文件夹/文件位置。

要准确查看记录更改的位置，请运行不带`--quit`参数的 fetch 命令。响应的最后一行（如果有任何东西要获取）将告诉您下载的更改记录在哪里。

例如，[“GIT HowTo”上的这个页面](http://githowto.com/fetching_changes)给出了例子

```
$ git fetch
From /Users/marina/Documents/Presentations/githowto/auto/hello
   6e6c76a..2faa4ea  master     -> origin/master 
```

最后一行表示远程主分支上的更改记录记录在`origin/master`- 或者更具体地说，`.git/refs/remotes/origin/master`.

# c# - 通过javascript取消asp.net中的功能

> ID：15118671
> 
> 赞同：0
> 
> 时间：2013-02-27T17:41:50.147
> 
> 标签：c#, javascript, asp.net

我有一个按钮，当用户单击它并且某些字段不正确时，将显示一条消息。我想用 javascript 进行验证（或者也许有一天我会），但我不知道如何做到这一点。目前当用户点击按钮时，服务器端的onclick函数不会被执行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:45:36.447

只需使用`<asp:Validator`标签；有许多不同类型的验证器，例如必填字段验证器、正则表达式验证器等。

他们将验证客户端代码和服务器端代码中的数据（除非您禁用客户端检查，您可以这样做）。

这比在 javascript 中手动验证内容并在服务器端代码中手动验证它要容易得多*。*

不过，从技术上讲，要回答您的问题，当您有`onclick`一个提交按钮的 javascript 处理程序时，返回值作为布尔值指示是否应提交表单，因此您只需要`return false`在数据无效时不提交表格。

```
<asp:Button Text="Submit" OnClientClick="return Validate();" />
<script type="text/Javascript">
    function Validate()
    {
        if(requiredFieldAIsMissing)  return false;

        return true;
    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:46:26.750

怎么样：

```
<asp:Button ID="myButton" Text="Click Me!" OnClick="myButton_OnClick" OnClientClick="javascript:confirm('Really?')" /> 
```

该[`OnClientClick`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.onclientclick.aspx)属性发出 javascript（在处理回发所需的 javascript 之前），如果您`false`从该事件返回，则该事件的其余部分将被取消并且回发不会触发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:56:33.577

我认为下面的内容可以帮助您理解。

HTML：

```
 <asp:textbox id="myText" runat="server" text="Hello" />
 <asp:button id="myButton" runat="server" text="Click Me" OnClick="Server_Event" /> 
```

ON Page_Load：

```
//Add onclick with return here
myButton.Attributes.Add("onclick","return ButtonClicked()"); 
```

Javascript：

```
function ButtonClicked(){
   var txt = document.getElementById("myText");
   if(txt.value != "Hello"){
      alert("It is not Hello, I am NOT posting back!");
      return false;
   } else {
      alert("It is Hello, I am posting back!");
      return true;
   }
} 
```

# node.js - node-gyp 配置为发布模式

> ID：15118676
> 
> 赞同：3
> 
> 时间：2013-02-27T17:42:07.663
> 
> 标签：node.js, node-gyp

您好我正在尝试将[node_modules](https://github.com/audreyt/node-webworker-threads)编译为发布模式，但我无法成功配置为发布模式。

我跑了`node-gyp configure`；生成的configure.gypi

```
 # Do not edit. File was generated by node-gyp's "configure" step {
   "target_defaults": {
         "cflags": [],
         **"default_configuration": "Debug",**
         "defines": [],
         "include_dirs": [],
         "libraries": []   }, 
```

我尝试过`-DBUILDTYPE=Release`但`BUILDTYPE=Release`没有成功

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-06T19:58:09.617

Default should be `Release`.

Try `node-gyp configure --release`

# android - Android 4.0+ RemoteControlClient MetadataEditor 蓝牙

> ID：15118678
> 
> 赞同：1
> 
> 时间：2013-02-27T17:42:14.827
> 
> 标签：android, bluetooth, android-mediaplayer, android-4.0-ice-cream-sandwich

当我买了我的新车时，我注意到它有一个屏幕，显示有关通过蓝牙音频接收器播放的音乐的元数据信息。它适用于某些应用程序，但尤其不适用于我主要用于听音乐的应用程序。经过一些研究，并阅读了该站点和其他站点的帖子，我能够确定如果该应用程序使用 RemoteControlClient 和 MetadataEditor 实现 ICS 锁屏控件，则此方法有效。

由于我使用的应用程序是开源的，因此我能够下载源代码并看到该应用程序没有使用 RemoteControlClient。我的下一步是查看随机音乐播放器的 Google 示例代码，并在我的手机和汽车上进行测试。这很成功，我继续修改我正在开发的应用程序的现有源代码。我将 RemoteControlClientCompat 和 RemoteControlHelper 类复制到我的项目中，并尽可能地将使用这些类的代码复制到我的项目代码中。

自从这样做以来，我已经成功地实现了音频焦点管理、媒体按钮控件和 RemoteControlClient / MetadataEditor。锁屏控件工作正常，但我的车仍然没有显示元数据。BT 元数据同样适用于示例代码，但不适用于我的应用程序，并且锁定屏幕控件在两个应用程序上都可以正常工作。

任何人都知道为什么锁屏控件会起作用，但蓝牙元数据不会？

谢谢，瑞安

# spring - IntelliJ + Tomcat + Spring-Loaded

> ID：15118681
> 
> 赞同：12
> 
> 时间：2013-02-27T17:42:24.370
> 
> 标签：spring, tomcat, spring-mvc, intellij-idea, spring-loaded

我想试试 Spring Source 的“Spring Loaded”类重载代理，Tomcat 通过 IntelliJ 运行。

[https://github.com/SpringSource/spring-loaded](https://github.com/SpringSource/spring-loaded)

我已将 JVM 参数添加到我的 Tomcat 运行配置中，并且我的 web 应用程序启动时没有错误并且似乎表现正常。

我不确定如何触发类重新加载。我只需要编译我修改的类吗？我已经尝试过了，但这似乎不起作用。我需要更新 Tomcat 并部署类和资源吗？这似乎也不起作用......？

任何特定的配置细节将不胜感激。

编辑：更多信息，我认为我的问题可能与使用两个模块有关，一个是核心代码库，一个是 webapp。我对两者都使用 Maven，一个配置为 jar 项目，另一个配置为 war 项目。IntelliJ 为爆战设置 Artifact 以使用 jar 模块的 jar 文件。我尝试切换 Artifact 配置以将 jar 模块的编译输出合并到 WEB-INF/classes 中。现在我在 target/webapp/WEB-INF/class/etc 中看到了 .class 文件。但我不确定如何让 IntelliJ 在编辑特定类文件时更新它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-09-16T11:50:08.567

如果您将以下 jvm 参数（如 springloaded 页面中所述）添加到您的 tomcat

```
-javaagent:<pathTo>/springloaded-{VERSION}.jar -noverify SomeJavaClass 
```

你应该没事。它可能有助于禁用您正在测试的 web 应用程序的 tomcat 中的自动重新加载。例如在您的 server.xml 中：

```
<Host appBase="webapps" autoDeploy="true" name="localhost" unpackWARs="true">
    <Context docBase="projekt" path="/projekt" reloadable="false" ... 
```

这确保只有弹簧加载的类加载器加载更改的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-14T13:52:28.080

弹簧加载不能热插拔罐子。

将网页片段输出放入 webapp/WEB-INF/classes

弹簧加载也仅支持弹簧 4.1 [https://github.com/spring-projects/spring-loaded/issues/139](https://github.com/spring-projects/spring-loaded/issues/139)

# java - 使用数据库连接池的开销

> ID：15118682
> 
> 赞同：2
> 
> 时间：2013-02-27T17:42:31.457
> 
> 标签：java, mysql, jdbc, connection-pooling

我有一堆每隔几分钟运行一次的 java 程序。这些程序每隔几分钟就由一个脚本启动，不到一分钟就结束。它们中的大多数都是单线程的，并且要访问我使用的 MySQL DB：

```
DriverManager.getConnection() 
```

他们只需要连接一次，然后执行一个查询。现在我正在向这个组添加一个新程序，它是多线程的，所有线程都需要同时访问数据库。我正在考虑为此使用数据库连接池（c3p0）。

我的问题是，由于所有这些程序共享一个用于访问数据库的通用 DAO，即使它们只需要一个连接，为单线程程序使用数据库连接池是否有开销？我打算将初始池大小设置为 1，将最小池大小设置为 1，将最大池大小设置为 10。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:09:36.480

连接池的主要目标是有一些现成的连接，而不是每次想要获得连接时打开和关闭。如果经常使用 DB，这种方法可以节省相当多的时间。

[Apache DBCP](http://commons.apache.org/proper/commons-dbcp/)是单线程的，但无论如何，如果您的应用程序经常使用 DB 连接，它会显着提高性能。

c3p0 是一个不错的选择，但要选择正确的连接池，请查看以下讨论：[使用 JDBC 的连接池选项：DBCP 与 C3P0](https://stackoverflow.com/questions/520585/connection-pooling-options-with-jdbc-dbcp-vs-c3p0)

# php - 移动上传的文件 - 没有权限

> ID：15118686
> 
> 赞同：0
> 
> 时间：2013-02-27T17:42:49.383
> 
> 标签：php, linux, apache, upload

上传文件时，我不断收到权限错误。

警告：move_uploaded_file（/var/www/localhost/htdocs/trade-show/documents/hero_front.jpg）[function.move-uploaded-file]：无法打开流：/var/www/localhost/htdocs/ 中的权限被拒绝trade-show/selectItems.php 在第 30 行

这是我的代码。让它工作的唯一方法是使目录权限为 777。我试过 chmod 0755 没有运气。想法？

```
if ($_FILES['fileUpload']['error'] == 0) {
    $upload = "/var/www/localhost/htdocs/trade-show/documents/".basename($_FILES['fileUpload']['name']);

    if (!move_uploaded_file($_FILES['fileUpload']['tmp_name'],$upload)) {
        echo "<h1>Error uploading file ".$_FILES['fileUpload']['name']."</h1>$upload<br />\n";
    } else {
        move_uploaded_file($_FILES['fileUpload']['tmp_name'],$upload);
    }
} 
```

# sql - 链接服务器的替代品（远程服务器是普遍的 sql）

> ID：15118687
> 
> 赞同：0
> 
> 时间：2013-02-27T17:42:49.697
> 
> 标签：sql, sql-server, tsql, reporting-services

我们总共花了大约 50 个小时尝试调试从 sql server 2012 到普遍 sql 的链接服务器连接。

不用说，普遍性是问题。

我们只运行`select`这样的查询：

```
select * from [sqlserver].[pervasiveserver].[db]..[myremotetable] 
```

我们对此感到非常沮丧，以至于我什至不想讨论我们遇到的错误。几位专家表示，这可能与糟糕的普遍 odbc 驱动程序有关。

我们有 SSRS 报告，其数据源指向 sql server。

**在这种情况下，您能否建议链接服务器的替代方法？**我们的主要任务是能够使用 SSRS 从普遍的数据库中进行选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:53:16.030

在放弃链接服务器之前，看看使用 openquery 代替完全限定的 tsql 是否有更好的结果。我们有一个从 sql server 到 redbrick 的链接服务器，另一对不能很好地协同工作，但是使用 openquery 可以解决所有这些问题。

您可能必须为每个查询编写一个存储过程，而不是将 sql 放入您的报告中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T02:43:24.610

我将构建 SSIS 包以将数据导入到新 SQL Server 数据库中具有相同/相似名称的表中。

SSIS 通常使用 ODBC 驱动程序更可靠，并且具有更丰富的错误处理来解决这些棘手的问题。您可以使用 SSMS 导入数据向导快速开始并将其结果保存为 SSIS 包。

保持相同的表名可以最大限度地减少 SSRS 返工。

SQL Server 中的表也可以被索引以提供快速的报告性能。

# jquery - 如何选择一个特定的类 - jQuery

> ID：15118688
> 
> 赞同：0
> 
> 时间：2013-02-27T17:42:49.337
> 
> 标签：jquery

有谁知道如何选择元素的特定类。我有一个在 html 中创建的元素。该元素有两个类“n”和“s1”，例如：

```
{<td class="n" class="s1" id=""><img src="gfx/football.png" /></td>} 
```

然后在 jquery 中创建另一个元素（它只是一个 div）。我想要做的是：当点击上面的元素（td）时，我想将相同的类（类 s1）添加到我的新`<div>`. 我只需要这两个具有相同类的元素。

我正在使用的代码如下所示：

```
myDIVishere.addClass($(this).attr('class') 
```

这一行向我的新 div 添加了一个类，但正如您在上面看到的我的 $(this) -->`<td>`有两个类。如何告诉程序我要添加第二类 (class="s1") 而不是第一类。我差点忘了。我有 50 个`<td>`元素，所以我不能使用类名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:09:19.887

首先，您必须修复您的标记。

我在 Opera 和 Chrome 中测试过，`class="foo" class="bar"`但无效。

应该是`class="foo bar"`。

考虑到这一点，您可以通过以下方式获得第二类：

```
var el = $('<a />', { class: 'foo bar' });
var classes = el.attr('class').split(' ');
var secondClass = classes[1]; 
```

在添加到另一个元素之前，请务必检查 secondClass 是否未定义，因为这可能会导致意外结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:46:58.023

当您使用该属性信息来标识一个元素时，您确实应该使用一个 ID，这样它是唯一的。

如果你不能/不会将它存储在 ID 属性中，而是存储`s1`在一个类中，给它一个单独且可识别的属性......所以你可以这样抓住它：

```
var specialValue = $('.myElement').attr('special-attribute');
$('.someOtherElement').addClass( specialValue ); 
```

但在那里，使用`addClass`也会浪费能源。您可以从字面上继续使用属性。

# excel - 当区域中的所有单元格都等于相同值时更改单元格的值

> ID：15118690
> 
> 赞同：2
> 
> 时间：2013-02-27T17:42:56.710
> 
> 标签：excel, vba

我正在尝试创建一个宏来更改单个单元格的值，仅当范围内的所有单元格都具有特定值时。我环顾四周，似乎我只能使用基于变体的工作表更改宏来做到这一点。基于此，我整理了以下内容：

```
Sub Worksheet_Change() 

Dim VarItemName As Variant
VarItemName = Range("Other_Checks!G85:G87")
Dim Value As String

Application.EnableEvents = False
If Range("Other_Checks!G85, Other_Checks!G86, Other_Checks!G87").Value = "N/A" Then
    Range("Other_Checks!G88").Value = "N/A"
Else
    Range("Other_Checks!G88").Value = "Pending"
    Application.EnableEvents = True
End If
End Sub 
```

问题是它似乎只有在范围 (G85) 中的第一个单元格发生变化时才有效（不管其他 2 个单元格的值如何）。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:42:19.993

这适用于我使用该`Worksheet_Change`事件。

您需要替换您的范围引用。

```
Private Sub Worksheet_Change(ByVal Target As Range)
    Dim VarItemName As Range, cl As Range

    If Not Intersect(Target, Range("A1:C1")) Is Nothing Then
        If Range("A1") = "n/a" And Range("B1") = "n/a" And Range("C1") = "n/a" Then
            Range("A2") = "n/a"
        Else
            Range("A2") = "Pending"
        End If
    End If
End Sub 
```

顺便说一句，这可以使用`IF`电子表格上的公式轻松完成。这可能是一个考虑的选择？

# java - 参数化 JUnit 测试惰性集合

> ID：15118691
> 
> 赞同：2
> 
> 时间：2013-02-27T17:42:58.883
> 
> 标签：java, junit4

我正在编写一个`parameterized`带有大约 100k 参数实例的 JUnit 4 测试，我想从 data 方法返回一个集合，该集合会延迟加载。但是在我返回`java.util.Collection`说我的集合的实现后，我得到了一个类转换异常`cannot be cast to java.util.List`。我是否需要实现`List<Object[]>`而不是`Collection<Object[]>`即使带`@Parameters`注释的方法想要返回`Collection<Object[]>`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T21:44:34.410

我在这里猜测，因为您没有提供任何代码继续，Hibernate 可能返回 List<Object>，而不是 List<Object[]>。在 data() 方法的主体中，遍历 Hibernate 返回集合并将对象插入到对象数组中，然后收集并返回它们。

```
List<Object[]> result = new ArrayList<Object[]>();
for (Object obj : hibernateReturnCollection) {
    Object[] element = new Object[1];
    element[0] = obj;
    result.append(element);
}
return result; 
```

# javascript - 谷歌地图：在地图 javascript v3 api 上达到谷歌查询限制

> ID：15118692
> 
> 赞同：-2
> 
> 时间：2013-02-27T17:43:00.460
> 
> 标签：javascript, jquery, google-maps, google-maps-api-3

我需要运行几千个 api 调用才能获得一些距离，但我一直在达到查询限制。即使在我将脚本设置为每 1 秒调用一次后，我仍然会在前 120-170 次调用后得到 QUERY_LIMIT 作为响应。在那之后，他们继续快速堆积。所以过了一会儿，我需要几秒钟甚至几分钟才能得到真正的回应。

该脚本每 1 秒调用一次以获取行驶距离。如果返回 ZERO_RESULT，那么它会在最后添加一个步行距离调用。如果用 ZERO_RESULT 响应，我只需通过坐标计算径向距离。如果它达到查询限制，它会在最后广告另一个相同值的调用。

这是我的代码：

```
function getDistance( lat1, lon1, lat2, lon2, relId, mode, nr, total ) {
  setTimeout( function(){
      var directionsService = new google.maps.DirectionsService();
      if( mode == 'driving' ) travelmode = google.maps.TravelMode.DRIVING;
      else { travelmode = google.maps.TravelMode.WALKING }
      var request = {
        origin: new google.maps.LatLng( lat1, lon1 ),
        destination: new google.maps.LatLng( lat2, lon2 ),
        travelMode: travelmode
      };
      directionsService.route(request, function(result, status) {
        if (status == google.maps.DirectionsStatus.OK) {
            distance = parseInt( result.routes[0].legs[0].distance.value )/1000;
            $.ajaxLoadSync( 'getDistance', SITE_ROOT+'admin/modules/settings/calculateDistance.php', 'lat1='+lat1+'&long1='+lon1+'&lat2='+lat2+'&long2='+lon2+'&relId='+relId+'&distance='+distance );
        } else if( status == google.maps.DirectionsStatus.ZERO_RESULTS && mode == 'driving' ){
            var walkingCount = 0;
            var limitCount = 0;
            if( $('#limit_hit').html() != '' ) limitCount = parseInt($('#limit_hit').html());
            if( $('#walking_dist').html() != '' ) walkingCount = parseInt($('#walking_dist').html());
            var offset = walkingCount + limitCount;
            $('#walking_dist').html( walkingCount + 1 );
            setTimeout(function() { getDistance( lat1, lon1, lat2, lon2, relId, 'walking', nr, total ) }, total*1000+offset*1000 );
        } else if( status == google.maps.DirectionsStatus.ZERO_RESULTS && mode == 'walking' ){
            var noResult = 0;
            if( $('#no_res').html() != '' ) noResult = parseInt($('#no_res').html());
            $('#no_res').html( noResult + 1 );
            $.ajaxLoadSync( 'getDistance', SITE_ROOT+'admin/modules/settings/calculateDistance.php', 'lat1='+lat1+'&long1='+lon1+'&lat2='+lat2+'&long2='+lon2+'&relId='+relId+'&distance=-1' );
        } else if( status == google.maps.DirectionsStatus.OVER_QUERY_LIMIT ){
            var walkingCount = 0;
            var limitCount = 0;
            if( $('#limit_hit').html() != '' ) limitCount = parseInt($('#limit_hit').html());
            if( $('#walking_dist').html() != '' ) walkingCount = parseInt($('#walking_dist').html());
            var offset = walkingCount + limitCount;
            $('#limit_hit').html( limitCount + 1 );
            setTimeout(function() { getDistance( lat1, lon1, lat2, lon2, relId, mode, nr, total ) }, total*1000+offset*1000 );
        }
      });
  }, nr*1000 );
} 
```

我会感谢任何帮助或提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T17:57:38.953

> 我需要运行几千个 api 调用才能获得一些距离

嗯，有你的问题。

> 使用 Google 路线 API 的查询限制为每天 2,500 条路线请求

如果您需要更多，您可能需要查看[Google Maps API for Business](https://developers.google.com/maps/documentation/business/)。每天提供更多的请求。

您也可能会达到这些[使用限制之一。](https://developers.google.com/maps/documentation/business/articles/usage_limits). 那里有一些关于如何解决它的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:29:47.100

如果您正在寻找大量行驶距离结果，请调查[DistanceMatrix](https://developers.google.com/maps/documentation/javascript/distancematrix)

但是，这些服务都不是针对数千个请求的。您可能需要重新考虑您的设计（或调查营业执照）。

# sqlalchemy - SQLAlchemy 多对一行逻辑

> ID：15118693
> 
> 赞同：0
> 
> 时间：2013-02-27T17:43:05.520
> 
> 标签：sqlalchemy

我在 SQLAlchemy 中有这个表结构：

```
User(Base)
    __tablename__ = 'users'
    id = Column(Integer, primary_key = True)
    addresses = relationship("Address", backref="user")

Address(Base)
    __talbename__ = 'addresses'
    id = Column(Integer, primary_key = True)
    user_id = Column(Integer, ForeignKey(users.id)) 
```

所以是多（地址）对一（用户）的关系。

我现在的问题是如何在不删除已经存储的地址的情况下轻松地向用户添加地址。

在纯 SQL 中，我只需在地址表中插入一行，其中包含正确用户的外键。

这就是我现在在 SQLAlchemy 中的做法（用户类中的方法）：

```
def add_address(self, address):
    adds = self.addresses
    adds.append(address)
    self.addresses = adds 
```

所以我基本上做的是首先找到所有地址，然后附加列表以再次用额外的地址覆盖列表。

我想知道是否有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T21:01:39.667

您可以在 User 和 Address 之间定义另一种关系，该关系不会使用`lazy='noload'`（请参阅[设置 Noload](http://docs.sqlalchemy.org/en/rel_0_8/orm/collections.html#setting-noload)）加载：

```
class User(Base):
    __tablename__ = 'users'
    id = Column(Integer, primary_key = True)
    addresses = relationship("Address", backref="user")
    addresses_noload = relationship("Address", lazy='noload')

    def add_address(self, address):
        adds = self.addresses_noload # @note: use the relationship which does not load items from DB
        adds.append(address) 
```

*另见[sqlalchemy add child in one-to-many relationship](https://stackoverflow.com/q/8839211/99594)类似问题。*

# java - 对 LinkedList 中 ListIterator 的 add() 方法感到困惑

> ID：15118694
> 
> 赞同：2
> 
> 时间：2013-02-27T17:43:10.947
> 
> 标签：java, linked-list

我正在通过有关 LinkedLists 的大学实践工作。我很难理解遍历 LinkedList 的迭代器的 add() 方法。我们的讲师给了我们实现这个的代码，所以完全从他那里复制：

```
public class LinkedList
{
    public LinkedList() {
        Node first = null;
    }

    class Node {
        public Object data;
        public Node next;
    }  

    class LinkedListIterator implements ListIterator {

        public LinkedListIterator() {
            Node position = null;
            Node previous = null;
        }

        public void add (Object element) {
            if (position == null) {
                addFirst(element);
                current = first;
            } else {
                //1 Node newNode = new Node();
                //2 newNode.data = element;
                //3 newNode.next = current.next;
                //4 current.next = newNode;
                //5 current = newNode;
            }
            previous = current
        } 
```

注意：我故意不封装变量，并删除了多余的代码以节省空间。我知道它不能编译，但我的问题更具概念性。

在 add 方法中：
if 语句只是检测迭代器的位置是否为空，在这种情况下，它将元素添加到 LinkedList 的开头，并将迭代器的位置设置为这个新创建的节点。

else 语句让我感到困惑：
第 1 行和第 2 行：创建了一个新节点，并将其数据设置为元素参数。
第 3 行，这个新节点的*下一个*变量被设置为当前节点的*下一个*节点，即它被设置为迭代器所指向的节点位置之后的任何值。*第 4 行，将 Iterator当前*指向
的节点的“下一个”更改为 newNode（有效地完成了新节点在两个现有节点之间的插入）。 第 5 行，将 Iterator 的位置设置为指向 newNode。

 *在 else 语句之后，将迭代器指向的前一个节点设置为当前节点。

这就是问题所在 - 这样做有效地同步了迭代器的位置和先前的位置。我通过 Eclipse 调试器检查了这一点。这使得以前的无用。但是，我知道无论如何您都无法使用标准迭代器反向遍历 LinkedList。

当我评论这条线时，似乎没有任何改变。这条线是完全没有必要的，还是有一些我实际上没有意识到的功能？（我要问的另一个原因是，我们的 remove() 方法的注释中出现了与此相反的情况，这似乎也没有任何目的。

**编辑：随着我的课程的发展，这个答案似乎可以得到回答。现在，我将 previous = current 行移到 current = newNode 行的上方。这似乎将所有值分开。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:57:52.817

的合约[`ListIterator.add(Object)`](http://docs.oracle.com/javase/7/docs/api/java/util/ListIterator.html#add%28java.lang.Object%29)指定*后续调用`next`不受影响，后续调用`previous`将返回新元素*`previous`，这是在 的实现中进行更新的目的`add`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:58:34.720

您的教授可能给了您示例代码，稍后将在课程中对其进行扩展。看起来示例代码包含将来支持双向链表的部分。双链表确实允许列表的反向遍历。 [有关详细信息，请参阅维基百科。](http://en.wikipedia.org/wiki/Doubly_linked_list)

在一个完全不相关的话题上；我为你真正试图理解和理解给你的东西而鼓掌，而不是为了完成任务而匆匆忙忙地完成任务。这个习惯对你将来会有好处！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:00:51.587

这对我来说似乎是一个错误。`previous = current`分配需要在分配*之前*发生`current = newNode`。然后`previous`将引用 old `current`，而 new`current`将是新创建的节点。*

# php - 第一次在 Wordpress 中创建 PHP 函数

> ID：15118695
> 
> 赞同：0
> 
> 时间：2013-02-27T17:43:14.163
> 
> 标签：php, wordpress

我对 PHP 还很陌生，不知道在哪里可以寻求帮助。

我试图创建的函数*不是*作为函数工作的，但是一旦我把它变成一个函数，它就会中断。我计划在带有参数的页面上多次使用此函数。

理想的功能是将所有自定义帖子项收集到一个数组中，对数组进行排序，然后回显 HTML 代码。

感谢您提供的任何帮助。

```
<?php
function postTerms($termName)
{
    $postTermsArray = array();
    rewind_posts(); while (have_posts()) : the_post();      
    $postTerms = wp_get_post_terms($post->ID, $termName, array("fields" => "names"));   
    $postTermsArray = array_merge($postTermsArray, $postTerms);
    $postTermsArray = array_unique($postTermsArray);
    endwhile;
    sort($postTermsArray);
    foreach($postTermsArray as $postTerms) {
        if ($postTerms !=''){
            $postTermsLower = strtolower($postTerms);
            $postTermsLower = preg_replace('/[^a-zA-Z0-9_ %\[\]\.\%&-]/s', '', $postTermsLower);
            $postTermsLower = preg_replace("![^a-z0-9]+!i", "-", $postTermsLower);
            echo ('<li><a href="#filter-'.$postTermsLower.'" data-filter-value=".'.$postTermsLower.'">'.$postTerms.'</a></li>');
        }
    }
}
postTerms();
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:47:19.603

对于初学者，您没有给`$termName`参数赋值。由于也没有默认值，因此它不起作用。

除此之外，您似乎正在从范围之外引用变量，例如`$post->ID`. 函数只能从外部访问变量，如果：

1.  它们作为参数传递
2.  它是一个带有`use`子句 ( `$var = function($param) use ($outsidevar) {...}`) 的匿名函数，或者
3.  您将`global $outsidevar`其放入函数中以“导入”它。

[（也是4。你可以使用`$GLOBALS['outsidevar']`，但不推荐，因为建筑`$GLOBALS`很贵）]

解决上述问题，您的功能应该可以工作，尽管目前它看起来像一个功能，为了一个功能。您在代码中编写的所有内容都必须有一个理由，最好是在您实际执行之前以简单的注释编写。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T17:47:13.333

您不为函数提供参数，只需调用：

```
postTerms(); 
```

你需要做：

```
postTerms($argument); 
```

# c# - 从“源代码编译程序集”调用“主机”回调

> ID：15118701
> 
> 赞同：1
> 
> 时间：2013-02-27T17:43:33.130
> 
> 标签：c#, system-codedom-compiler

我正在使用`System.CodeDom.Compiler`. 编译后的源代码中的所有内容都运行良好，无论我在此源代码中放入什么。我知道如何调用我的函数：

```
o = results.CompiledAssembly.CreateInstance("Foo.Bar");
MethodInfo mi = o.GetType().GetMethod("SayHello");
mi.Invoke(o, null); 
```

但是假设我正在使用 WebClient 使用 WebClient.DownloadStringAsync 异步检索字符串。或者我希望我编译的源代码告诉主机“嘿，我为你准备了一个很好的字符串”的任何其他上下文。例如，我使用了 WebBrowser。基本上，我知道如何处理这两个实例中的每一个：我的托管程序和编译程序，但我希望我的编译程序与主机通信。顺便说一句，我不是一个经验丰富的程序员，所以我没有想到任何明显的方法。

我试过的：

1\. 我真的不需要尝试它，因为它可以工作，但我可以使用计时器读取编译源中的字符串堆栈或任务队列，但我的应用程序的目的是让 +- 60 个脚本能够执行当前任务，而不是连续的后台进程，因此在 CPU 上效率不高。

2\. 我已经将处理程序传递给编译源，就像它在托管应用程序中一样：

```
 //In the hosting app
    MethodInfo mi2 = o.GetType().GetMethod("attachCallbackToHost");
    mi2.Invoke(o2, new object[] { new WebBrowserNavigatedEventHandler (wb_navigated) });

    //... And the handler
    public static void wb_navigated(object sender, WebBrowserNavigatedEventArgs e)
    {            
        string browserHtmlFromCompiledSource = ((WebBrowser)sender).DocumentText;
        MessageBox.Show(browserHtmlFromCompiledSource);
    }

    // Plain text from the compiled source code
    public void attachCallbackToHost(WebBrowserNavigatedEventHandler handlerFromTheHost)
    {
         wb.Navigated += handlerFromTheHost;
    } 
```

它什么也没做。

3\. 也许我可以通过将类或变量传递给已编译的程序集来共享它？

所以，问题是这个或另一个：

*   如何有效地观察编译程序中特定变量或属性的变化？

*   如何将回调附加到主机？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T19:31:45.933

好的。我明白了：为了从编译的源访问主机，唯一需要的是将主机程序集添加到编译器参数中的引用程序集：

```
compilerParams.ReferencedAssemblies.Add(Assembly.GetExecutingAssembly().Location); 
```

所以不需要任何特殊的回调或 INotifier。

这是严格回答我的问题的完整代码，仅此而已：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using Microsoft.CSharp;
using System.CodeDom.Compiler;
using System.Reflection;

namespace MamaProgram
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            string source =
           @"
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net;
using MyMama = MamaProgram;              
namespace Baby
{
    public class Program
    {
        public WebBrowser wb = new WebBrowser();        

        public void navigateTo(string url)
        {
            wb.Navigated += wb_navigated;            
            wb.Navigate(url);            
        }

        public void wb_navigated(object sender, WebBrowserNavigatedEventArgs e)
        {            
            MyMama.Form1.getResult(wb.DocumentText);            
        }
    }
}
            ";

            Dictionary<string, string> providerOptions = new Dictionary<string, string>
                {
                    {"CompilerVersion", "v3.5"}
                };

            CSharpCodeProvider provider = new CSharpCodeProvider(providerOptions);

            CompilerParameters compilerParams = new CompilerParameters
            {
                GenerateInMemory = true,
                GenerateExecutable = false,
                TreatWarningsAsErrors = false                
            };

            compilerParams.ReferencedAssemblies.Add(Assembly.GetExecutingAssembly().Location);
            compilerParams.ReferencedAssemblies.Add("System.Data.dll");            
            compilerParams.ReferencedAssemblies.Add(typeof(System.Linq.Enumerable).Assembly.Location); // Trick to add assembly without knowing their name            
            compilerParams.ReferencedAssemblies.Add(typeof(System.ComponentModel.Component).Assembly.Location); // Trick to add assembly without knowing their name                        
            compilerParams.ReferencedAssemblies.Add("System.Windows.Forms.dll");
            CompilerResults results = provider.CompileAssemblyFromSource(compilerParams, source);

            if (results.Errors.Count != 0)
                throw new Exception("Compilation failed");

            object o = results.CompiledAssembly.CreateInstance("Baby.Program");
            MethodInfo mi2 = o.GetType().GetMethod("navigateTo");
            mi2.Invoke(o, new object[] { "http://www.google.com" });                        
        }

        public static void getResult(string result)
        {
            MessageBox.Show(result);
        }        
    }
} 
```

# format - 具有未知列的格式化语句

> ID：15118702
> 
> 赞同：1
> 
> 时间：2013-02-27T17:43:35.547
> 
> 标签：format, fortran

我正在尝试使用 fortran 写出一个逗号分隔的文件以导入另一个商业包。问题是我有未知数量的数据列。我的输出需要如下所示：

```
a_string,a_float,a_different_float,float_array_elem1,float_array_elem2,...,float_array_elemn 
```

这将导致可能如下所示：

```
L1080,546876.23,4325678.21,300.2,150.125,...,0.125
L1090,563245.1,2356345.21,27.1245,...,0.00983 
```

我有三个问题。一、我希望元素被紧密分组（可变列宽），二、我不知道如何在格式语句中定义可变数量的数组元素，三、数组元素可以跨越很大的范围——可能是 12 个数量级。以下代码在概念上符合我的要求，但变量“n”和缺少列宽定义会引发错误（当然）：

```
WRITE(50,900) linenames(ii),loc(ii,1:2),recon(ii,1:n)
900 FORMAT(A,',',F,',',F,n(',',F)) 
```

（我应该注意，n 在运行时是固定的。）当我执行 WRITE(50,*) 时，write 语句执行我想要的操作，除了它是宽度分隔的。

我认为这个线程几乎回答了我的问题，但我很困惑：[所以](https://stackoverflow.com/questions/2751453/matlabs-fortrans-format-equivalents/2751615#2751615)。现在我有一个用 awk 解决问题的 shell 脚本，但那个解决方案是......不优雅。我可以进行一些操作以使输出成为字符串，然后直接编写它，但如果可能的话，我宁愿避免使用该选项。

我在 Fortran 90 中执行此操作，但我想尝试使我的代码尽可能向后兼容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:28:09.423

接近您想要的格式是 f0.3，这将不提供空格和固定的小数位数。我认为，如果您还想删除尾随零，则需要做很多工作。

您的 write 语句中的“n”可能大于数据值的数量，因此一种（老派）方法是在那里放一个大数字，例如 100000。现代 fortran 确实有一些语法来指定无限重复，我是肯定有人会提供的。

----编辑无限重复就像你可能猜到的一个星号..并且在 f2008 中显然是“全新的”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T19:41:54.203

为了确保行中的条目之间没有空格，您可以将它们分别写在字符变量中，然后使用`adjustl()`fortran 中的函数将它们打印出来：

```
program csv
  implicit none

  integer, parameter :: dp = kind(1.0d0)
  integer, parameter :: nn = 3
  real(dp), parameter :: floatarray(nn) = [ -1.0_dp, -2.0_dp, -3.0_dp ]
  integer :: ii
  character(30) :: buffer(nn+2), myformat

  ! Create format string with appropriate number of fields.
  write(myformat, "(A,I0,A)") "(A,", nn + 2, "(',',A))"
  ! You should execute the following lines in a loop for every line you want to output
  write(buffer(1), "(F20.2)") 1.0_dp  ! a_float
  write(buffer(2), "(F20.2)") 2.0_dp  ! a_different_float
  do ii = 1, nn
    write(buffer(2+ii), "(F20.3)") floatarray(ii)
  end do
  write(*, myformat) "a_string", (trim(adjustl(buffer(ii))), ii = 1, nn + 2)

end program csv 
```

上面的演示仅适用于一个输出行，但您可以轻松地围绕适当的块编写一个循环来为所有输出行执行它。此外，如果您愿意，您可以为不同的条目选择不同的数字格式。

# c# - 有没有办法在 ErrorTemplate 中设置工具提示？

> ID：15118706
> 
> 赞同：2
> 
> 时间：2013-02-27T17:43:45.817
> 
> 标签：c#, wpf, errortemplate

在我们的 WPF 应用程序中，我们有一个通用的控件模板，用于以一致的方式显示错误

```
<ResourceDictionary>
    <ControlTemplate x:Key="ErrorTemplate">
        <Border BorderThickness="1" BorderBrush="Red">
            <AdornedElementPlaceholder />
        </Border>
    </ControlTemplate>
</ResourceDictionary> 
```

在我们的应用程序的其他地方，当控件可能显示错误时，我们像这样设置 ErrorTemplate

```
<TextBox Validation.ErrorTemplate="{DynamicResource ErrorTemplate}" /> 
```

我现在想在此错误模板中显示工具提示，但是在边框上设置工具提示属性并没有太大帮助，因为工具提示仅在用户将鼠标悬停在 1px 宽的边框上时才显示，而不是控件本身出现错误.

我知道我可以在样式中设置工具提示，但是此错误模板适用于许多不同的控件（组合框等...），并且其中许多控件还使用独立于我的错误模板的样式 - 我真的很想能够以通用方式将我的错误模板应用于任何控件。

有什么方法可以在我的 ErrorTemplate 中设置工具提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:59:15.583

我定义了一种风格。我的对象（客户）上有 IDataErrorInfo，它对属性（姓氏）进行验证，例如数据绑定到文本框。这是我的风格：

```
<Style x:Key="ValidationTextBox" TargetType="{x:Type Control}">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,2,40,2"/>
            <Setter Property="Validation.ErrorTemplate">
                <Setter.Value>
                    <ControlTemplate>
                        <DockPanel LastChildFill="True">
                            <Border Background="#B22222" DockPanel.Dock="Right" Margin="5,0,0,0" Width="20" Height="20" CornerRadius="10"
                                    ToolTip="{Binding ElementName=customAdorner, Path=AdornedElement.(Validation.Errors)[0].ErrorContent}">
                                <TextBlock Text="!" VerticalAlignment="Center" HorizontalAlignment="Center" FontWeight="Bold" Foreground="White"/>
                            </Border>
                            <AdornedElementPlaceholder Name="customAdorner" VerticalAlignment="Center">
                                <Border BorderBrush="#B22222" BorderThickness="1" />
                            </AdornedElementPlaceholder>
                        </DockPanel>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style 
```

> `<TextBox Style="{StaticResource ValidationTextBox}" Text="{Binding Path=Customer.LastName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, ValidatesOnDataErrors=True, ValidatesOnExceptions=True}" />`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:42:51.823

正如我在[这里的回答](https://stackoverflow.com/a/14550973/620360)中所说，您可以：

```
<ControlTemplate x:Key="ErrorTemplate">
    <Border BorderThickness="1" BorderBrush="Red"
            Background="Transparent"
            ToolTip="{Binding Path=/ErrorContent}">
        <AdornedElementPlaceholder />
    </Border>
</ControlTemplate> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T13:49:21.557

对不起，我昨天没有时间......你能在下面试试，看看这是否是你所追求的，好吗？

```
<Style x:Key="ValidationTextBox2" TargetType="{x:Type Control}">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Validation.ErrorTemplate">
                <Setter.Value>
                    <ControlTemplate>
                        <Border BorderBrush="Red" BorderThickness="2">
                            <DockPanel LastChildFill="True" ToolTip="{Binding ElementName=customAdorner, Path=AdornedElement.(Validation.Errors)[0].ErrorContent}" Background="Transparent">
                                <TextBlock />
                            <AdornedElementPlaceholder Name="customAdorner" VerticalAlignment="Center">
                            </AdornedElementPlaceholder>
                        </DockPanel>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style> 
```

# mongodb - 对 MongoDB 集合名称使用点表示法有什么缺点？

> ID：15118713
> 
> 赞同：9
> 
> 时间：2013-02-27T17:44:01.367
> 
> 标签：mongodb

我真的很想使用点表示法为我的 MongoDB 集合名称创建命名空间。

例如：

```
users
users.admins
users.developers 
```

这是一个坏主意吗 ？这样做时是否有任何潜在的问题、缺点或限制？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-27T18:29:37.197

这并没有错。事实上，[本书](http://shop.oreilly.com/product/0636920001096.do)第 8 页建议在集合中使用点表示法。它将这些称为`subcollections`; 然而，这个词似乎并没有被广泛使用。

重要的是要意识到您在问题中列出的 3 个集合是 3 个不同的集合，除了它们的命名之外彼此没有任何关系。点符号在 MongoDB 功能方面没有任何作用。

虽然它对组织很有用，并且按字母顺序排序时集合列表很好。因此，总而言之，没有任何缺点或潜在问题，并且您会获得优势，因为您的收藏名称组织得更好。

# c# - 如何提高 ASP.NET 站点的安全性？

> ID：15118717
> 
> 赞同：7
> 
> 时间：2013-02-27T17:44:06.220
> 
> 标签：c#, asp.net

我有一个 ASP.NET 站点，一些客户需要更好的安全层来访问它。今天的网站要求输入用户名和密码，但是很多客户想要限制对某些机器的访问，我需要在我的服务器端执行此操作。所以，我正在寻求一些建议。

1.  使用VPN限制访问？（使用移动设备将无法工作）

2.  可以查看mac地址吗？

3.  可以使用客户端证书吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:02:30.200

## 对用户最简单

我会检查[多因素身份验证](http://en.wikipedia.org/wiki/Multi-factor_authentication)（Andrew Walters 的评论提到的），所有内容都通过 SSL 交付，并特别注意页面超时、会话固定、密码策略等问题。

传送到手机的 PIN 是常用的第二个因素。

我断言这是“对用户来说最简单的”，因为许多大型网站（例如 Google 和 Facebook，他们的银行）都以这种方式运作。无需安装任何东西，也无需学习任何新东西。

从商业角度来看，这很多都是不可取的。

## VPN

> 使用VPN限制访问？（使用移动设备将无法工作）

这是企业环境中的常见选项，通常被认为是安全的（尽管不是放弃密码策略等其他良好做法的借口）。但是，您*确实*可以选择移动设备。

请参阅[F5 的 SSL VPN](http://www.f5.com/it-management/solutions/ssl-vpn-security/overview/)，特别是他们[关于 iOS 和 Android 移动访问的白皮书，](http://www.f5.com/pdf/white-papers/mobile-access-to-applications-tb.pdf)其中指出：*“适用于 iOS 和 Android 设备的 BIG-IP Edge Portal 应用程序简化了对企业 Web 应用程序的安全移动访问 [...] 用户可以访问内部网页和安全的 Web 应用程序。”*

您可以通过在身份验证过程中添加另一个因素来提高安全性：[具有不断变化的 PIN 的令牌](http://en.wikipedia.org/wiki/SecurID)。

## 证书

> 可以使用客户端证书吗？

是的，这是[可能的](http://technet.microsoft.com/en-us/library/cc753983%28WS.10%29.aspx)；它是否满足您的业务需求是另一回事（例如，管理此类解决方案需要技能/时间）。

如果您不熟悉该主题，我建议您阅读这篇[知识库文章](http://support.microsoft.com/?id=907274)（快速阅读）。

对于实施，这里有一个旧的但非常详细的[演练](http://www.iisadmin.co.uk/?p=11)和一个更新的 IIS 7[演练](http://www.aspnetwiki.com/configuring-iis-7-with-self-signed-server-and-client-certifi)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:09:42.683

如果您想锁定对某些机器的访问，请使用 IIS 的[http://www.iis.net/downloads/microsoft/dynamic-ip-restrictions](http://www.iis.net/downloads/microsoft/dynamic-ip-restrictions)。指定哪些 IP 可以访问 > 确保在 dhcp 中将它们设置为静态。这是工资单供应商和信用卡公司在 IIS 中使用的“按需访问方法”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:55:14.727

**1）使用VPN限制访问？**

肯定会工作。它确实限制了您可以使用的机器。

**2）可以检查mac地址吗？**

它是，但它不是一种安全的方法，因为 MAC 地址可以被欺骗。

**3）可以使用客户端证书吗？**

实际上，这可能是您最好的选择。

# python - Python 可以让列表变得更有效率吗？

> ID：15118718
> 
> 赞同：3
> 
> 时间：2013-02-27T17:44:16.310
> 
> 标签：python, python-2.7, list, generator, yield

在 Python v2.7 中，如果我有这样的函数：

```
def holes_between(intervals):
  # Compute the holes between the intervals, for example:
  #   given the intervals: ([ 8,  9] [14, 18] [19, 20] [23, 32] [34, 49])
  #     compute the holes: ([10, 13] [21, 22] [33, 33])
  prec = intervals[0][1] + 1 # Bootstrap the iteration
  for low, high in intervals[1:]:
    if prec <= low - 1:
      yield (prec, low - 1)
    prec = high + 1

holes = list(holes_between(intervals)) 
```

由于`yield`函数的 被收集到 a`list`中，在函数内部构建列表是否更有效`holes_between`，如果是，如何最有效地完成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:47:33.567

生成器函数的效率*可能*低于直接构建列表。

您可以在`holes_between()`函数中构建列表并返回：

```
def holes_between(intervals):
    prec = intervals[0][1] + 1 # Bootstrap the iteration
    result = []
    for low, high in intervals[1:]:
        if prec <= low - 1:
            result.append((prec, low - 1))
        prec = high + 1
    return result 
```

但请使用[模块](http://docs.python.org/2/library/timeit.html)*测量*差异。[`timeit`](http://docs.python.org/2/library/timeit.html)

如果您有一些典型的输入，您可以使用以下方法进行测试：

```
import timeit

def holes_between_list(intervals):
    prec = intervals[0][1] + 1 # Bootstrap the iteration
    result = []
    for low, high in intervals[1:]:
        if prec <= low - 1:
            result.append((prec, low - 1))
        prec = high + 1
    return result

def holes_between_generate(intervals):
    prec = intervals[0][1] + 1 # Bootstrap the iteration
    for low, high in intervals[1:]:
        if prec <= low - 1:
            yield (prec, low - 1)
        prec = high + 1

intervals = [ ... ] # fill in some test data

print 'As list:', timeit.timeit(
    'holes_between(intervals)',
    'from __main__ import intervals, holes_between_list as holes_between')

print 'Using a generator:', timeit.timeit(
    'list(holes_between(intervals))',
    'from __main__ import intervals, holes_between_generate as holes_between') 
```

较低的值是*测试数据*的更快方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:50:51.610

一般来说，我会说，惰性评估的灵活性超过了使用生成器可能获得的轻微性能损失。在没有使用所有可枚举的情况下，生成器方法将执行得更好。

例如，假设您想要一个函数来检查间隔之间孔大小的最大阈值：

```
def threshold(intervals, n):
    for low, high in holes_between(intervals):
        if (high - low + 1) >= n:
            return True
    return False 
```

在这种情况下，如果可迭代的间隔很大，那么如果尽早超过阈值，您可能会节省大量工作。一般来说，这些“早期返回”功能中的任何一种都将受益于生成器。

如果这是您的代码的关键部分，*并且您已经测量了一个明确的性能问题*`holes_between`，那么是的，您可以重写它以在函数本身中构建列表。如果你这样做了，一定要对函数进行基准测试，看看你是否真的让它表现得更好。

# qt - netbeans：如何将小部件添加到 QT 变量

> ID：15118720
> 
> 赞同：0
> 
> 时间：2013-02-27T17:44:19.340
> 
> 标签：qt, netbeans, widget

我看过有人说现在需要 Qt 5 项目将小部件添加到 QT 变量的帖子，这就是为什么 netbeans 中的简单 Qt 示例不起作用的原因：不能包含 QtGui/QApplication -> 没有这样的文件或目录。

如何将此添加到 QT 变量？我是否必须为 IDE 或 .bashrc 或不知何故的每个项目执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:13:34.213

问题是由于链接错误。这是因为它没有与 QtWidgets 链接。

```
g++ -m64 -Wl,-rpath,/opt/Qt5.0.1/5.0.1/gcc_64 -Wl,-rpath,/opt/Qt5.0.1/5.0.1/gcc_64/lib -o dist/Debug/GNU-Linux-x86/QtApplication_2 build/Debug/GNU-Linux-x86/main.o   -L/usr/X11R6/lib64 -L/opt/Qt5.0.1/5.0.1/gcc_64/lib -lQt5Gui -lQt5Core -lGL -lpthread 
```

首先我检查了使用来自 QtCore 的东西仍然有效。代码是：

```
#include <QtCore/QCoreApplication>

int main(int argc, char *argv[]) {
    // initialize resources, if needed
    // Q_INIT_RESOURCE(resfile);

    QCoreApplication a(argc, argv);

    // create and show your widgets here

    return a.exec();
} 
```

很好，所以我知道这只是链接错误。我仍然不知道要添加什么，因为您在 Netbeans 的项目属性的 Qt 选项卡中没有 QtWidget。但反复试验表明，检查此选项卡（模块）上的 QtOpenGl 就足够了，然后将其链接到更多库：

```
g++ -m64 -Wl,-rpath,/opt/Qt5.0.1/5.0.1/gcc_64 -Wl,-rpath,/opt/Qt5.0.1/5.0.1/gcc_64/lib -o dist/Debug/GNU-Linux-x86/QtApplication_1 build/Debug/GNU-Linux-x86/main.o   -L/usr/X11R6/lib64 -L/opt/Qt5.0.1/5.0.1/gcc_64/lib -lQt5OpenGL -lQt5Widgets -lQt5Gui -lQt5Core -lGL -lpthread 
```

# javascript - 如何在 JavaScript 'prompt' 函数中使用第二个参数？

> ID：15118721
> 
> 赞同：-2
> 
> 时间：2013-02-27T17:44:19.747
> 
> 标签：javascript

prompt() 函数中使用的第二个参数是什么？

```
prompt('blahblahblah', 'WHY ARE THESE HERE? '){} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:54:04.757

> 我将假设您写了~~圆括号~~括号但*表示*参数。我假设这是因为您还提到了逗号字符并且仅出现在命令的参数列表中...

prompt 命令中的第二个*参数*是插入到文本字段中的默认值。

这是一个[简单的例子](http://jsfiddle.net/3HTJM/2/)-

```
var milliseconds = (new Date).getTime();
var currentEpoch = Math.floor(milliseconds / 1000);
prompt("What is the current epoch?",currentEpoch); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T17:50:50.577

第二个参数用于`value`参数：

> value 是一个字符串，其中包含在文本输入字段中显示的默认值。它是一个可选参数。请注意，在 Internet Explorer 7 和 8 中，如果不提供此参数，则字符串“undefined”是默认值。

[https://developer.mozilla.org/en-US/docs/DOM/window.prompt](https://developer.mozilla.org/en-US/docs/DOM/window.prompt)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:50:47.980

`{}`定义一个空代码块。它什么也不做。

`if`在和等控制结构之后有一个代码块更有意义`for`。

# c - 如何停止从套接字读取

> ID：15118722
> 
> 赞同：1
> 
> 时间：2013-02-27T17:44:25.757
> 
> 标签：c, sockets

我迷路了。我不知道如何停止从服务器读取。我基本上是将目录中每个文件的列表从服务器发送到客户端。这是我在做什么。

服务器端：

```
 struct dirent *ep = readdir(dp);      
    while( ep ){  
        sprintf(buf, "%s", (ep->d_name));
        n = write(newsock, buf, MAX );           
        ep = readdir(dp);  
    } 
```

客户端：

```
while( n = read(sock, buf, MAX)){
    printf("buf: %s\n" , buf);       
} 
```

所以服务器端的东西工作正常。我可以看到我正在正确发送所有文件名，但在客户端它读取所有名称但只是等待阅读更多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T17:47:36.327

您要么需要从服务器发送一些“EOF”指示符，以便客户端知道要中断循环，要么让服务器关闭套接字（在允许客户端读取所有数据“一段时间”之后）。这将导致读取以错误条件退出。

第二个表面上更容易，第一个可能更可靠和高效。恭喜，您现在已经构建了您的第一个通信协议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:47:43.567

定义协议。

一个非常简单的方法可能是让服务器向客户端发送一个空的（0 长度）文件名，以告诉客户端发送完成。要成功地做到这一点，您可能希望通过例如附加`\r\n`序列或类似序列来分隔每个文件名。

# wcf - NServiceBus，WCF 架构

> ID：15118730
> 
> 赞同：2
> 
> 时间：2013-02-27T17:44:54.140
> 
> 标签：wcf, architecture, nservicebus

所以我正在考虑在我们当前的设置中实现 NServiceBus，并试图更好地理解应该如何设置。

我们当前的设置由多个客户端（网站、计划任务等）组成，它们调用我们为处理电子邮件发送而设置的 WCF 服务。当然，如果服务出现故障，我们的客户就会开始收到错误，然后所有这些消息都会丢失（我们想要 ESB 的原因之一）。

我已经了解了如何配置 WCF 服务以在 pub/sub 设置中处理 nservicebus 消息。我不确定设置它的最佳方法是什么。

设置 1：

客户端（发布者）-> NServiceBus 处理程序（订阅者）-> WCF 服务

在这种情况下，要进行扩展，您需要增加处理程序（托管 nservicebus 服务？）的数量，只保留一个 WCF 服务。

设置 2：

客户端（发布者）-> WCF 服务（订阅者）

您只需增加 WCF 服务的数量以进行扩展（更新将是一场噩梦）。

我刚开始研究一般的 ESB 架构，所以如果我完全不知道，请告诉我。我本质上只是想知道什么对你有用，以及“最佳实践”往往是什么。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:59:36.627

如果您通过 NServiceBus 实现此功能，我不再完全清楚您需要 WCF 做什么。除了从多个客户端接收消息（发送电子邮件）之外，是否需要 WCF 组件？如果没有，您可以从等式中删除 WCF。

从它的声音来看，您还希望服务充当处理发送电子邮件请求的单个逻辑端点。如果是这种情况，您将需要使用 Send（命令）而不是 Publish（事件）。Publish用于广播一个事件，表示某*事*已经发生；Send 用于指示另一个组件*做某事*。听起来你想要后者。

端点的缩放可以通过[Distributor](http://support.nservicebus.com/customer/portal/articles/859556-load-balancing-with-the-distributor)完成。这可能有用也可能没用，具体取决于您期望瓶颈在哪里。

编辑：根据您的评论，我将简单地进行第二个设置，并将处理程序添加到 WCF 服务。如果您在 IIS 中托管 WCF，请确保在应用程序池回收时您有一些东西可以唤醒进程（传入消息不会像传入 WCF 的请求那样唤醒它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:41:21.523

我们在内部做类似的事情，一个 NSB 端点处理所有电子邮件的发送。客户端可以直接使用 NSB 到 Bus.Send() 命令以将消息发送到电子邮件端点，或者您也可以通过 WCF 公开该端点（仅将命令传递到端点）。一旦端点拥有命令，它们就会调用您现有的服务以保持与现有客户端的兼容性。

# javascript - 玉石中的用户提示

> ID：15118731
> 
> 赞同：1
> 
> 时间：2013-02-27T17:44:54.740
> 
> 标签：javascript, pug

完成“24 小时内的 Node.js”。在第 6 章中有一些 Jade 示例，05 和 06。我尝试使用 prompt() 将它们组合起来让用户设置条件。下面的代码显示了我所做的。提示脚本不会更改变量“raining”。我究竟做错了什么？

```
extends layout

block content
  h1= title
  p Welcome to #{title}

  - raining = false

  script
    raining = prompt('Raining? (true/false)')

  - if (raining)
      p It is raining.  Take an umbrella!

  - else
      p No rain. Take the bike. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:13:00.517

您正在将服务器端 js 与客户端混淆。在这种情况下，您应该在脚本标签内编写客户端 js：

```
p(id="txtRain")

script
    var raining = confirm('Raining?')
    var txtRain = document.getElementById('txtRain');

    if (raining)
       txtRain.innerHTML = 'It is raining.  Take an umbrella.';
    else
       txtRain.innerHTML = 'No rain. Take the bike.'; 
```

# jquery - 无线电组的 XPages 设置类（用于所需的验证）

> ID：15118732
> 
> 赞同：0
> 
> 时间：2013-02-27T17:44:55.287
> 
> 标签：jquery, validation, xpages

我需要让 Radio Group 具有“必需”类，这样我就可以使用 jQuery Validation 插件，我已经尝试过[这里的建议](https://stackoverflow.com/questions/12191078/how-to-validate-radiorequired-via-jquery)

这是字段：

```
 <div data-role="fieldcontain">
            <fieldset data-role="controlgroup" data-type="horizontal">
                <legend class="ui-input-text">Compliant?</legend>

                <xp:radioGroup id="CLCompliant"
                    value="#{docAuditCLAnswer.Compliant}">

                    <xp:selectItem itemLabel="Yes" itemValue="Yes"
                        id="CLCompliantYes">
                    </xp:selectItem>

                    <xp:selectItem itemLabel="No" itemValue="No"
                        id="CLCompliantNo">
                    </xp:selectItem>

                    <xp:selectItem itemLabel="N/A" itemValue="NA"
                        id="CLCompliantNA">
                    </xp:selectItem>
                </xp:radioGroup>
            </fieldset>
        </div> 
```

我尝试了以下方法，因为这些不是 styleClass 属性，但该属性被忽略/不呈现：

```
 <xp:selectItem itemLabel="Yes" itemValue="Yes"
                        id="CLCompliantYes">
                        <xp:this.attrs>
                            <xp:attr name="class" value="required">
                            </xp:attr>
                        </xp:this.attrs>
                    </xp:selectItem> 
```

我也尝试过在加载文档时进行设置，但是如果不对视图进行硬编码就无法按名称选择：_id，是否有与 x$ XSnippet 等效的功能？

```
$('input:radio[name="view:_id1:CLCompliant"]').addClass("required"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:37:19.757

Gary，向您的 XPage (OutputScript) 添加一个脚本块并添加：

```
XSP.addOnLoad(function() {
    $('input:radio[name="#{id:CLCompliant}"]').addClass("required");
    }) 
```

...或jQuery等价物。

顺便说一句：使用没有默认值的无线电组是一个常见的 UI 错误。它们提供了用户习以为常的“活板门” UI 模式：您可以选择一个值，但不能取消选择它。因此，更好的用户体验是使用不同的控件（下拉）或设置默认值。

# mysql - MySql 从同一行的不同列返回多行

> ID：15118735
> 
> 赞同：1
> 
> 时间：2013-02-27T17:45:03.507
> 
> 标签：mysql, sql

给定两个表：

'people' 表包含以下列：

```
name
favorite_walking_shoe
favorite_running_shoe
favorite_dress_shoe
favorite_house_shoe
favorite_other_shoe 
```

'shoes' 表包含以下列：

```
shoe
name
description 
```

我想创建一个包含以下内容的结果集：

```
people.name, people.favorite_shoe_type, shoes.name, shoes.description 
```

我知道我可以使用以下方法获得所需的结果：

```
select p.name, p.favorite_shoe_type, s.name, s.description
  from (select name, favorite_walking_shoe as shoe, 'walking' as favorite_shoe_type
          from people where favorite_walking_shoe is not null
        union all
        select name, favorite_running_shoe, 'running'
          from people where favorite_running_shoe is not null
        union all
        select name, favorite_dress_shoe, 'dress'
          from people where favorite_dress_shoe not is null
        union all
        select name, favorite_house_shoe, 'house'
          from people where favorite_house_shoe not is null
        union all
        select name, favorite_other_shoe, 'other'
          from people where favorite_other_shoe not is null
        ) p
     join shoes s on s.shoe = p.shoe
    order by 1,2 
```

但这需要 'people' 表的 5 次通行证。有没有一种方法可以在不需要多次通过的情况下完成 UNION ALL？

我应该指出，这些结构是我无法修改的供应商产品的一部分。:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:38:01.190

您可以通过执行以下操作绕过五次扫描`cross join`：

```
select p.name, p.favorite_shoe_type, s.name, s.description
from (select p.*,
             (case when favorite_shoetype = 'walking' then p.favore_walking_shoe
                   when favorite_shoetype = 'running' then p.favorite_running_shoe
                   when favorite_shoetype = 'dress' then p.favorite_dress_shoe
                   when favorite_shoetype = 'house' then p.favorite_house_shoe
                   when favorite_shoetype = 'other' then p.favorite_other_shoe
              end) as shoe
      from people p cross join
           (select 'walking' as favorite_shoe_type union all
            select 'running' union all
            select 'dress' union all
            select 'house' union all
            select 'other'
           ) shoetypes join
           shoes s
     ) p
     on s.shoe = p.shoe 
```

我不确定这会更有效率。如果你在鞋上有索引，这个更复杂的版本可能更有效：

```
select p.name, p.favorite_shoe_type, s.name, s.description
from (select p.name, favorite_shoe_types,
             (case when favorite_shoetype = 'walking' then ws.name
                   when favorite_shoetype = 'running' then rs.name
                   when favorite_shoetype = 'dress' then ds.name
                   when favorite_shoetype = 'house' then hs.name
                   when favorite_shoetype = 'other' then os.name
              end) as name,
             (case when favorite_shoetype = 'walking' then ws.description
                   when favorite_shoetype = 'running' then rs.description
                   when favorite_shoetype = 'dress' then ds.description
                   when favorite_shoetype = 'house' then hs.description
                   when favorite_shoetype = 'other' then os.name
              end) as description
      from people p left outer join
           shoes ws
           on ws.shoe = favorite_walking_shoe left outer join
           shoes rs
           on rs.shoe = favorite_running_shoe left outer join
           shoes ds
           on ds.shoe = favorite_dress_shoe left outer join
           shoes hs
           on hs.shoe = favorite_house_shoe left outer join
           shoes os
           on os.shoe = favorite_other_shoe cross join
           (select 'walking' as favorite_shoe_type union all
            select 'running' union all
            select 'dress' union all
            select 'house' union all
            select 'other'
           ) shoetypes 
     ) p
     on s.shoe = p.shoe
where s.name is not null 
```

这应该使用索引进行五次连接——非常快，一次扫描人员表，并将其提供给交叉连接。然后该逻辑返回您想要的值。

注意：这两个都未经测试，因此它们可能存在语法错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:01:00.200

不幸的是，您当前表的结构方式将有多次传递来获取每个值。如果可能的话，我建议将您的表格结构更改为包含一个`shoe_type`表格，然后在此表格中包含一个`people`与和之间的连接`shoes`表格，您可以包含一个标志，该标志将显示鞋子是否是最喜欢的。

所以它会类似于这样：

```
create table people_shoe
(
    people_id int,
    shoe_id int,
    IsFavorite int
); 
```

您还可以有一个`shoe_type`表来存储每种不同的节目类型：

```
create table shoe_type
(
    id int,
    name varchar(10)
);

insert into shoe_type
values('Walking'), ('Running'), ('Dress'), ('House'), ('Other'); 
```

将`shoe_type.id`被添加到您的`shoe`表中，您将加入这些表。

编辑#1，如果你可以改造数据库，你可以使用以下（模拟模型）：

```
create table people
(
    id int, 
    name varchar(10)
);
insert into people values (1, 'Jim'), (2, 'Jane');

create table shoe_type
(
    id int,
    name varchar(10)
);
insert into shoe_type
values(1, 'Walking'), (2, 'Running'), (3, 'Dress'), (4, 'House'), (5, 'Other');

create table shoes
(
    id int,
    name varchar(10),
    description varchar(50),
    shoe_type_id int
);
insert into shoes 
values(1, 'Nike', 'test', 2), (2, 'Cole Haan', 'blah', 3);

create table people_shoe
(
    people_id int,
    shoe_id int,
    IsFavorite int
);
insert into people_shoe
values (1, 1, 1),
(1, 2, 0),
(2, 1, 1); 
```

那么当你查询的时候，你的代码会是这样的：

```
select p.name PersonName,
  s.name ShoeName,
  st.name ShoeType,
  ps.isFavorite
from people p
inner join people_shoe ps
    on p.id = ps.people_id
inner join shoes s
    on ps.shoe_id = s.id
inner join shoe_type st
  on s.shoe_type_id = st.id 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/79392/2)

# jquery - 在 Jquery .When().Done 中运行函数

> ID：15118738
> 
> 赞同：0
> 
> 时间：2013-02-27T17:45:11.010
> 
> 标签：jquery, asp.net, asp.net-ajax

下面的代码运行 alert("Success"); 当它单独并且函数 fSuccess 被注释掉时，它不会触发 fSuccess() 函数。这是为什么？非常感谢您的参与。

```
$.when(chkUsername(), chkPassword()).done(function () {
                if (boolusername == 0) {
                    $("#ErrorUN").css("display", "block");
                }
                else {
                    if (boolpassword == 0) {
                        $("#ErrorP").css("display", "block");
                    }
                    else {
                        $.ajax({
                            type: "POST",
                            url: "Registration.aspx/Success",
                            data: "{}",
                            contentType: "application/json; charset=utf-8",
                            dataType: "json",
                            success: function () { }
                        });
                    }
                }
            }); //when

Imports System.Web.Services

Public Class Registration
Inherits System.Web.UI.Page

Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
End Sub

<WebMethod()>
Public Shared Sub Success()

   Dim strBreakPoint As String = "qwerty"

End Sub 
```

结束类

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:50:04.473

这是因为您声明了函数`fSuccess`，但从未真正调用它。

除此之外，您可能还想使用 ajax 回调，如下所示：

```
...
else {
    alert("Success!");
    //Add Server Side Function Here
    .ajax({
        type: "POST",
        url: "Registration.aspx/Success",
        success: function() { alert("Success from server"); }
    });
}
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:50:56.893

您只是在该范围内声明函数。您需要在定义后调用它。

```
fSuccess(); 
```

# python - 需要创建一个新的 Python 列表，其中包含另一个列表的所有可能的唯一组合

> ID：15118741
> 
> 赞同：1
> 
> 时间：2013-02-27T17:45:27.820
> 
> 标签：python, arrays, multidimensional-array, enumeration

我目前有一个选择列表：

```
a = ['D1', 
    'C1', 
    'D2', 
    'C2', 
    'D3', 
    'C3', 
    'D4', 
    'C4', 
    'D5', 
    'C5',] 
```

我想要一个新列表，其中包含可能的组合中的嵌套列表。像这样：

```
b = [
'D1', 
'C1', 
'D2', 
'C2', 
'D3', 
'C3', 
'D4', 
'C4', 
'D5', 
'C5',
['D1', 'C1'], 
['D1', 'D2'], 
['D1', 'C2'] 
.
. 
['D1', 'C1', 'D2'] 
.
. 
['D1', 'C1', 'D2', 'C2'] 
.
. 
['D1', 'C1', 'D2', 'C2', 'D3']
:
etc 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:00:47.473

您实际上需要的电源组`a`是我的解决方案：

```
def powerset(seq):
    """
    Returns all the subsets of this set. This is a generator.
    """
    if len(seq) <= 1:
        yield seq
        yield []
    else:
        for item in powerset(seq[1:]):
            yield [seq[0]]+item
            yield item

a =['D1', 'C1', 'D2', 'C2', 'D3', 'C3', 'D4', 'C4', 'D5', 'C5']
b = [x for x in powerset(a)]
b.sort(key = len)
for x in b:
 print x 
```

我的[参考网站：](http://www.technomancy.org/python/powerset-generator-python/)您可以在[**此处的 codepade看到它的工作原理**](http://codepad.org/JVnBR8WG)

**编辑**运行实例。

```
a =['D1', 'C1', 'D2']
b = [x for x in powerset(a)]
b.sort(key = len)
for x in b:
  print x 
```

及其输出：

```
[]
['D2']
['C1']
['D1']
['C1', 'D2']
['D1', 'D2']
['D1', 'C1']
['D1', 'C1', 'D2'] 
```

您可以从以下链接中找到 Python 中 Powerset 的更好代码。

[http://docs.python.org/2/library/itertools.html](http://docs.python.org/2/library/itertools.html)
[http://mail.python.org/pipermail/tutor/2004-April/029413.html](http://mail.python.org/pipermail/tutor/2004-April/029413.html)
[http://ruslanspivak.com/2011/06/ 09/power-set-generation-a-joy-of-python/](http://ruslanspivak.com/2011/06/09/power-set-generation-a-joy-of-python/)

尽管 Mr.martineau 给出了小而快的代码，但我还不了解 itertools。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T17:57:08.210

签出[`itertools.combinations`](http://docs.python.org/2/library/itertools.html#itertools.combinations)：

```
b = []
for len_ in xrange(len(a)):
    b.extend(itertools.combinations(a, len_+1) 
```

另请参阅 itertools 文档中的[powerset 配方](http://docs.python.org/2/library/itertools.html#recipes)：

```
def powerset(iterable):
    "powerset([1,2,3]) --> () (1,) (2,) (3,) (1,2) (1,3) (2,3) (1,2,3)"
    s = list(iterable)
    return chain.from_iterable(combinations(s, r) for r in range(len(s)+1)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T17:59:31.240

[`itertools.combinations`](http://docs.python.org/2/library/itertools.html#itertools.combinations)您可以结合使用称为[列表理解](http://docs.python.org/2/tutorial/datastructures.html?highlight=list%20comprehension#list-comprehensions)的非常有效且相对简洁的构造来创建新列表。*然而，由于并非最终列表中的所有项目本身都不*是嵌套列表，因此这样做有点复杂。我实际上怀疑这样会使您以后处理列表变得更加困难，但是，无论如何，这是我能够设计的最简单的实现，它会产生您所说的想要的列表：

```
from itertools import combinations

a = ['D1', 'C1', 'D2', 'C2', 'D3', 'C3', 'D4', 'C4', 'D5', 'C5']
b = [item for sublist in (list(combo[0] if len(combo) < 2 else list(combo)
                               for combo in combinations(a, n))
                                   for n in range(1, len(a)+1)) for item in sublist]

from pprint import pprint  # print the result
print 'b = \\'
pprint(b[:14] + ['... lines omitted ...'] + b[-14:]) 
```

输出：

```
b = \
['D1',
 'C1',
 'D2',
 'C2',
 'D3',
 'C3',
 'D4',
 'C4',
 'D5',
 'C5',
 ['D1', 'C1'],
 ['D1', 'D2'],
 ['D1', 'C2'],
 ['D1', 'D3'],
 '... lines omitted ...',
 ['C1', 'D2', 'D3', 'C3', 'D4', 'C4', 'D5', 'C5'],
 ['C1', 'C2', 'D3', 'C3', 'D4', 'C4', 'D5', 'C5'],
 ['D2', 'C2', 'D3', 'C3', 'D4', 'C4', 'D5', 'C5'],
 ['D1', 'C1', 'D2', 'C2', 'D3', 'C3', 'D4', 'C4', 'D5'],
 ['D1', 'C1', 'D2', 'C2', 'D3', 'C3', 'D4', 'C4', 'C5'],
 ['D1', 'C1', 'D2', 'C2', 'D3', 'C3', 'D4', 'D5', 'C5'],
 ['D1', 'C1', 'D2', 'C2', 'D3', 'C3', 'C4', 'D5', 'C5'],
 ['D1', 'C1', 'D2', 'C2', 'D3', 'D4', 'C4', 'D5', 'C5'],
 ['D1', 'C1', 'D2', 'C2', 'C3', 'D4', 'C4', 'D5', 'C5'],
 ['D1', 'C1', 'D2', 'D3', 'C3', 'D4', 'C4', 'D5', 'C5'],
 ['D1', 'C1', 'C2', 'D3', 'C3', 'D4', 'C4', 'D5', 'C5'],
 ['D1', 'D2', 'C2', 'D3', 'C3', 'D4', 'C4', 'D5', 'C5'],
 ['C1', 'D2', 'C2', 'D3', 'C3', 'D4', 'C4', 'D5', 'C5'],
 ['D1', 'C1', 'D2', 'C2', 'D3', 'C3', 'D4', 'C4', 'D5', 'C5']] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T17:57:59.837

我建议使用[`itertools.permutations(a)`](http://docs.python.org/2/library/itertools.html?highlight=itertools#itertools.permutations).

```
import itertools
a = ['D1', 
    'C1', 
    'D2', 
    'C2', 
    'D3', 
    'C3', 
    'D4', 
    'C4', 
    'D5', 
    'C5',]

b = list(itertools.permutations(a)) # this gives permutations of the same length 
```

如果您想要所有可能的排列（不同长度），您可以使用`for`循环：

```
b = []
for i in range(1, len(a)+1):
    b.extend(list(itertools.permutations(a, i))) 
```

将其放入列表理解中：

```
b = [list(itertools.permutations(x, i)) for i in range(1, len(x)+1)] 
```

# rubygems - 无法安装 RubyGems 2.0.0，因为“无法加载此类文件 -- openssl (LoadError)”

> ID：15118742
> 
> 赞同：2
> 
> 时间：2013-02-27T17:45:36.390
> 
> 标签：rubygems, openssl

我正在尝试在新机器上设置 Rails，但在设置 RubyGems 时遇到问题。由于问题中的错误。检查时`openssl version`我得到：OpenSSL 0.9.8r 2011 年 2 月 8 日

我还应该注意，目前，openssl.cnf 可以在 $HOME/.rvm/usr/ssl 中找到

显示它已安装。我尝试通过以下方式重新安装 ruby​​ 2.0.0：

```
rvm reinstall 2.0.0 --with-openssl-dir=$HOME/usr/local 
```

我在这里遇到了几个错误，包括以下对 /Users/me/.rvm/log/ruby-2.0.0-p0/configure.log 的引用：

```
[2013-02-27 10:34:16] ./Configure
Usage: Configure [no-<cipher> ...] [enable-<cipher> ...] [experimental-<cipher> ...]
[-Dxxx] [-lxxx] [-Lxxx] [-fxxx] [-Kxxx] [no-hw-xxx|no-hw] [[no-]threads] [[no-]shared]      
[[no-    ]zlib|zlib-dynamic] [no-asm] [no-dso] [no-krb5] [sctp] [386] [--prefix=DIR] 
[--openssldir=OPENSSLDIR] [--with-xxx[=vvv]] [--test-sanity] os/compiler[:flags] 
```

在 /Users/me/.rvm/log/ruby-2.0.0-p0/openssl/make.log 中：

```
making all in crypto/des...
cc -I.. -I../.. -I../modes -I../asn1 -I../evp -I../../include  -O   -c -o set_key.o 
set_key.c
set_key.c: In function ‘DES_set_key_unchecked’:
set_key.c:399: error: unsupported inline asm: input constraint with a matching output     
constraint of incompatible type!
set_key.c:402: error: unsupported inline asm: input constraint with a matching output  
constraint of incompatible type!
make[2]: *** [set_key.o] Error 1
make[1]: *** [subdirs] Error 1
make: *** [build_crypto] Error 1 
```

为此，我已经把头发拉了一天。我错过了什么？

谢谢阅读！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T09:01:00.867

我在以下要点中尝试了“选项 1”，它对我有用。

[https://gist.github.com/jfirebaugh/4007524](https://gist.github.com/jfirebaugh/4007524)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T20:21:22.840

尝试更换

```
rvm reinstall 2.0.0 --with-openssl-dir=$HOME/usr/local 
```

和

```
rvm reinstall 2.0.0 --with-openssl-dir=$HOME/.rvm/usr/ssl 
```

鉴于您说您的 openssl 配置文件就在那里。

# html - IE8 问题：AngularJS ng-include - 具有 HTML5 节点结构的部分

> ID：15118758
> 
> 赞同：7
> 
> 时间：2013-02-27T17:46:35.600
> 
> 标签：html, internet-explorer-8, angularjs

关于 AngularJS ng-includes 的快速问题包括部分具有 HTML5 节点结构的位置，即：页眉、导航、页脚......

在我的标题中，我拥有使 Angular 在 Internet Explorer 8 及更低版本中正常工作的所有好东西。

所有 ng-view 和 ng-includes 都按预期工作。

```
<!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- Internet Explorer AngularJS element creation -->
<!--[if lte IE 8]>
    <script>
        document.createElement('ng-include');
        document.createElement('ng-pluralize');
        document.createElement('ng-view');
        document.createElement('ng:include');
        document.createElement('ng:pluralize');
        document.createElement('ng:view');
    </script>
    <script src="http://cdnjs.cloudfare.com/ajax/libs/json3/3.2.4/json3.min.js"></script>
<![endif]--> 
```

问题是当部分中有一个 HTML5 节点时。

假设： partial 在 partials 中称为 header。

```
<ng-include src="'partials/header.partial.html'"></ng-include> 
```

示例 1（header.partial.html 源代码 - 在 IE8 中不显示）

```
<header>
    <h1>logo</h1>
</header> 
```

示例 2（header.partial.html 源代码 - 在 IE8 中显示）

```
<div>
    <h1>logo</h1>
</div> 
```

我已经包含了来自 angular 的 require 脚本以及 html5 shim。

如果我将部分内容移动到根文件，一切都很好。

想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-19T15:43:25.957

这似乎与问题[#1381](https://github.com/angular/angular.js/issues/1381)有关。简而言之，jqlite 中的 clone 方法在它不理解的标签上放置了一个空的命名空间，因此 html5 标签显示为这样，`<:header>`而不是`<header>`. 如果您使用完整版的 jquery，这可能会得到解决。或者，您可以修补角度（请参阅上面的问题）。似乎这个问题在 github 上已经死了，这里基于这篇文章的年龄。google 群组上也有一个相关问题（[Internet Explorer 中的 jQuery 和 ng:include 问题](https://groups.google.com/forum/#!searchin/angular/ie8/angular/trA2Jdw6q4A/DfBu8fRvQJcJ)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-09T10:58:22.203

被覆盖了，现在 AngularJS 似乎从 1.3 开始不再支持 IE8，他们也删除了部分文档。太惨了=/

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-05-13T01:12:01.983

[Angular JS 指南http://docs.angularjs.org/guide/ie](http://docs.angularjs.org/guide/ie)涵盖了这个确切的问题

# php - 使用 PDO 和 Memcache 的“智能”缓存系统

> ID：15118762
> 
> 赞同：1
> 
> 时间：2013-02-27T17:46:44.440
> 
> 标签：php, caching, pdo, memcached

我正在开发一个使用 pdo 和 memcache 的“智能”缓存系统。但是，我被这个错误困住了。你能帮我吗？

我的代码：

```
$session = "a121fd4ztr6";
cache_query("SELECT * FROM `session` WHERE `session` = :session: LIMIT 1;", array(':session:' => $session));

// CACHE QUERY
function cache_query($sql, $params) {
    global $db;
    global $memcache;

    $name = 'querycache-'.md5(serialize(array($sql, $params)));
    $result = $memcache->get($name);

    if (!$result) {
        if(!($db)){
            require("db.php");
        }

        $stmt = $db->prepare($sql);
        $exec = $stmt->execute($params);
        $result = $stmt->fetchAll(PDO::FETCH_ASSOC);

        $memcache->add($name, $result);
    }

    return $result;
} 
```

db.php 建立到 PDO 的连接。Memcache 连接已经建立。我总是收到以下错误：

编辑：添加错误模式属性后，我现在得到一个更详细的错误：

**致命错误：未捕获异常 'PDOException' 并带有消息 'SQLSTATE[42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 /chroot/home/html/session.php:170 中的 ': LIMIT 1' at line 1' 附近使用正确的语法**

^这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:49:26.390

看起来`$db->prepare()`返回一个错误，所以你的`$stmt`变量不是一个真实的`PDOStatement`对象。使用`$db->errorInfo()`来查看发生了什么问题。如果您设置了适当的属性，您也可以将它放到 try-catch 块中（请参阅[错误和错误处理](http://www.php.net/manual/en/pdo.error-handling.php)）。

要查看您的连接是否正常，您也可以使用 try-catch：

```
try {
    $db = new PDO($dsn, $user, $password);
    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch (PDOException $e) {
    echo 'Connection failed: ' . $e->getMessage();
} 
```

# c# - TypeInitializationException 未处理 - OpenNLP 使用 IKVM

> ID：15118764
> 
> 赞同：0
> 
> 时间：2013-02-27T17:46:49.013
> 
> 标签：c#, java, ikvm

我正在使用 IKVM 在 C# 中使用 opennlp 工具。我写了以下代码：

```
string modelpath = @"D:\models\en-sent.bin";
java.io.FileInputStream modelInpStream = new java.io.FileInputStream(modelpath);
SentenceModel model = new SentenceModel(modelInpStream);
SentenceDetectorME sentenceDetector = new SentenceDetectorME(model); 
```

但它在该行中导致了 TypeInitializationException：

```
SentenceModel model = new SentenceModel(modelInpStream); 
```

异常消息：

> TypeInitializationException 未处理
> “java.nio.charset.StandardCharsets”的类型初始化程序引发了异常。

我已经添加了 IKVM Charsets dll，但它仍然不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T07:37:37.080

确保所有 IKVM.OpenJDK.*.dll 文件都在您的应用程序 bin 目录中。Visual Studio 并不总是复制所有引用的程序集（如果它们没有“使用”）。

另一个建议是尝试打印完整的异常（从 Java 角度来看）。事情是这样的：

```
using ikvm.extensions;  // make the Exception extension methods available

try {
  ...
} catch (Exception x) {
  x.printStackTrace();
} 
```

这应该提供有关 TypeInitializationException 根本原因的更多信息。

# java - 合并排序给出 IndexOutOfBoundsException

> ID：15118766
> 
> 赞同：4
> 
> 时间：2013-02-27T17:46:56.297
> 
> 标签：java

代码从文件中读取多个案例和数组的大小，然后填充一个数组并将其发送到合并排序。
问题是我不断得到`index out of bounds`它，它正在杀死我......

我的调试器刚刚停止在我的 Eclipse 上工作。

```
import java.io.File;
import java.io.FileNotFoundException;
import java.util.Scanner;

public class mergesort {

    public static void mergeSort(int[] array, int first, int last){
        int mid;
        if (first<last){
            mid = (last + first)/2;
            mergeSort(array, first, mid);
            mergeSort(array, mid+1, last);
            merge(array, first, last);
        }
    }

    public static void merge(int[] array, int first, int last){
        int mid = (last-first)/2;
        int[] temp = new int[(last-first)];
        int a1 = first, a2 = mid + 1, current = 0;
        while (a1 <=mid && a2<=last){
            if (array[a1] <= array[a2])
                temp[current++] = array[a1++];
            else
                temp[current++] = array[a2++];
        }
        for (int i = a1; i<=mid; i++)
            temp[current++] = array[i];
        for (int i = a2; i<=last; i++)
            temp[current++] = array[i];
        for (int i =0; i<temp.length; i++)
            array[first+i] = temp[i];
    }

    public static void main(String[] args) throws FileNotFoundException {
        File file = new File("sort.in");
        Scanner scan = new Scanner(file);
        int n1 = scan.nextInt();
        for (int i = 0; i<n1; i++){
            int[] array =new int[scan.nextInt()];
            for (int j = 0; j<array.length; j++){
                array[j] = scan.nextInt(); 
            }
            mergeSort(array, 0, (array.length)-1);
            for (int j = 0; j<array.length; j++){
                System.out.println(array[j]); 
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:54:31.870

对于初学者，您的`temp`数组是一个太短的元素：

```
int[] temp = new int[(last-first)]; 
```

由于`last`和`first`都包含在内，以上内容应为：

```
int[] temp = new int[last - first + 1]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-06T05:15:51.893

您的`merge`程序部分有几个错误（不包括 NPE 显示的错误），首先：

```
int mid = (last-first)/2; 
```

应该：

```
int mid = (last+first)/2; 
```

其次，不管怎样，最后的 3 个 for 循环都在运行 - 但您应该只在 a1/a2 的剩余部分上运行。

我的实现有点不同 - 也许它有助于解释第二个错误：

```
public static void mergeSort(int[] arr, int start, int end){
    if(start == end) return;
    // now the recursive calls:
    // divide the arr:
    int middle = (end+start)/2;
    mergeSort(arr, start, middle);
    mergeSort(arr, middle+1, end);
    // now merge (conquer)
    merge(arr, start, end, middle);
}

private static void merge(int[] arr, int start, int end, int middle) {
    int[] sorted = new int[end-start+1];        
    for(int i=start,j=middle+1,index=0; index < sorted.length;){
        if(j<=end && arr[i] > arr[j]){
            sorted[index] = arr[j];
            j++; index++;
        }
        else if (i<=middle){
            sorted[index] = arr[i];
            i++; index++;
        }
        else{
            sorted[index] = arr[j];
            j++; index++;
        }
    }
    // now copy "sorted" to original array
    for(int i=start,j=0; i<=end; i++,j++){
        arr[i] = sorted[j];
    }
}

public static void main(String...args){
    int[] arr = {4,2,9,6,2,8,1,9,10,15,12,11};
    mergeSort(arr, 0, arr.length - 1);
    for(int i=0; i<arr.length; i++){
        System.out.print(arr[i]+" ");
    }
} 
```

# razor - 使用knockout渲染一切是否更容易绑定到dom和vs Rasor视图渲染

> ID：15118770
> 
> 赞同：2
> 
> 时间：2013-02-27T17:46:58.580
> 
> 标签：razor, knockout.js

我在这个应用程序中大量使用淘汰赛，并将执行大量的 javascript 视图模型操作。最初我使用 razor 循环在 POCO 类上渲染内容，但现在我正在考虑通过淘汰赛来渲染所有内容（通过 2.0 本机模板）。

这样我就能够更有效地绑定到 dom 元素并返回到视图模型。这是正确的思维方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:55:28.437

在我在 razor 和 js 中有重复的功能（渲染 html）之前，我一直处于这种情况。如果您需要通过 ajax 和其他方式在 js 中呈现 html，`knockout.js`那么我看不到在 razor 中复制此功能的好处。相反，只需重用您的客户端代码以在 js 中呈现 html。通常我会`JSON`在初始页面加载时将我的 poco 对象序列化并嵌入到客户端中，因此 js 将基于对象创建 html，就像它通过`AJAX`.

# windows - 什么是相当于从键盘获取扫描码的 win32/系统调用？

> ID：15118776
> 
> 赞同：1
> 
> 时间：2013-02-27T17:47:21.513
> 
> 标签：windows, tasm

我在 tasm 有这个代码

```
mov ah,00h
int 21h

cmp ah,3Bh 
```

考虑到它是一个基于 dos 的应用程序，它工作得很好（我们可以看到它使用了相当老的中断）。现在的问题是，win32/系统调用相当于从键盘获取扫描码是什么？基本上，当用户按下 F1 键（扫描码为 3Bh）时，它会在 AH 寄存器中注册。我们如何通过系统调用在 win32 程序集中实现这一点？（带有 extrn、kernel32 dll 等的那个）我正在使用 NASM

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:45:53.020

对于控制台模式程序，32 位汇编代码最有可能的来源，它是[ReadConsoleInput()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684961%28v=vs.85%29.aspx)。GUI 应用程序从 GetMessage() 返回的 WM_KEYDOWN 和 WM_CHAR 消息中获取击键。但当然，您永远不会在汇编中编写 GUI 应用程序，这没有任何意义。

从 C 运行时库调用 _getch() 可能是最简单的方法，它是一个返回 int 的简单函数。

# haskell - 类型族和类型构造函数

> ID：15118780
> 
> 赞同：2
> 
> 时间：2013-02-27T17:47:42.140
> 
> 标签：haskell, type-families

我正在用类型同义词替换我的一些库中的多参数类型类。一切都很顺利，直到我需要使用类型构造函数。此代码的最后两行不会编译。

```
{-# LANGUAGE TypeFamilies, FlexibleContexts #-}

import qualified Data.Map as M

-- | A regular arrangement of tiles.
class Eq (Index g) => Grid g where
  type Index g
  -- | Returns the indices of all tiles in a grid.
  indices :: g -> [Index g]
  -- plus other functions

-- | A map from tile positions in a grid to values. 
data LGridMap g v = LGridMap { toGrid :: g, toMap :: M.Map (Index g) v }

instance Grid g => Grid (LGridMap g v) where
  type Index (LGridMap g v) = Index g
  indices = indices . toGrid

class GridMap gm where
  type BaseGrid gm
  type Value gm

instance GridMap (LGridMap g v) where
  BaseGrid gm = g -- line 26
  Value = v       -- line 27 
```

我得到的编译错误是：

```
../Amy.hs:26:3:
    Pattern bindings (except simple variables) not allowed in instance declarations
      BaseGrid gm = g

../Amy.hs:27:3:
    Pattern bindings (except simple variables) not allowed in instance declarations
      Value = v
Failed, modules loaded: none. 
```

有没有更好的定义方式`LGridMap`？有没有办法指定它`LGridMap`是一个实例`GridMap`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T17:51:26.523

不应该是这样吗？

```
instance GridMap (LGridMap g v) where
  type BaseGrid (LGridMap g v) = g
  type Value (LGridMap g v) = v 
```

# ios - MPMediaItem 元数据的哪些组合可以被视为 GUID？

> ID：15118788
> 
> 赞同：1
> 
> 时间：2013-02-27T17:48:18.257
> 
> 标签：ios, mpmediaitem

我在 MPMediaItem 上看不到任何可以被视为全局唯一标识符的元数据（换句话说，同一个媒体将具有跨多个设备和用户帐户的相同、唯一的值组合）。是否有可以以这种方式使用的推荐元数据（或一组复合元数据）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T08:21:52.003

所有`MPMediaItem`s 和其他一些`MediaPlayer.framework`类都有一个唯一标识符，称为持久 ID。它是一个`uint64_t`包裹在一个`NSNumber`. 以下是您可以从`MPMediaItem`using中检索的持久 ID`valueForProperty:`

```
NSString *const MPMediaItemPropertyPersistentID;            // filterable
NSString *const MPMediaItemPropertyAlbumPersistentID;       // filterable
NSString *const MPMediaItemPropertyArtistPersistentID;      // filterable
NSString *const MPMediaItemPropertyAlbumArtistPersistentID; // filterable
NSString *const MPMediaItemPropertyGenrePersistentID;       // filterable
NSString *const MPMediaItemPropertyComposerPersistentID;    // filterable
NSString *const MPMediaItemPropertyPodcastPersistentID;     // filterable 
```

# c++ - C++ 生成 rand 数

> ID：15118795
> 
> 赞同：2
> 
> 时间：2013-02-27T17:48:37.980
> 
> 标签：c++, random, blackjack

在 C++ 中是否可以使用 rand 生成 1-52 之间的数字，但说明它不能是 23？就像创建二十一点游戏一样，您需要确保玩家在随机生成第一张牌后无法获得同一张牌。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-27T17:50:29.530

当然。

```
int i = 23;
while (i == 23)
    i = rand() % 52 + 1; 
```

在生成具有所需分布的随机数时，丢弃不可接受的值是很常见的。

但是，对于二十一点游戏，您需要处理不止一张牌。最好有一副完整的牌组并洗牌（[`std::random_shuffle`](http://en.cppreference.com/w/cpp/algorithm/random_shuffle)），然后从装牌组的任何容器的一端取出卡片。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T17:49:48.140

```
int value = rand(1,51);
if (value >= 23) ++value; 
```

where`rand(a,b)`给出了 range 中的一个数字`[a,b]`，并且可以实现为`std::rand() % (b-a+1) + a`，但需要注意的是，这不是一个均匀分布。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T18:02:59.033

这是一个程序，可以制作从 1 到 52（含）的牌组并打印牌组。这具有 STL（以及略微过时的 C++ 口音）

```
#include <algorithm>    // std::random_shuffle
#include <ctime>        // std::time
#include <cstdlib>      // std::rand, std::srand
#include <iostream>     // std::cout
#include <vector>       // std::vector

int main() {
    std::vector<int> deck;

    // Create deck; deck creation logic goes inside loop
    for (int i = 1; i <= 52; ++i) {
        deck.push_back(i);
    }

    // initialize random number generator and shuffle deck
    std::srand(std::time(0));
    std::random_shuffle(deck.begin(), deck.end());

    // print entire deck
    while (!deck.empty()) {
        int card = deck.back();    // draw card
        std::cout << "Drew " << card << '\n';
        deck.pop_back();           // remove card from deck
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T17:50:49.920

```
int n=(rand() % 52)+ 1;
while(n==23)
n= n=(rand() % 52) + 1; 
```

[http://www.cplusplus.com/reference/cstdlib/rand/](http://www.cplusplus.com/reference/cstdlib/rand/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T17:52:39.390

看看`std::random_shuffle`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T18:44:58.453

另一种很酷的方法是使用数组。

创建一个向量：

```
std::vector<int> possibilities; 
```

向其中插入可能的值：

```
possibilities.push_back(0);
possibilities.push_back(1);
possibilities.push_back(10); 
```

然后从中随机选择一个：

```
int random = possibilites[ rand() % possibilites.size() ]; 
```

# ruby-on-rails - 强制 Omniauth/OAuth 忽略浏览器缓存并重新验证？

> ID：15118796
> 
> 赞同：0
> 
> 时间：2013-02-27T17:48:39.213
> 
> 标签：ruby-on-rails, oauth, omniauth

因此，在我的 Rails 应用程序中使用 Omniauth 设置 OAuth 时，我遇到了以下意外行为。

当用户之前已通过 OAuth 提供者（例如 Facebook）进行身份验证时，凭据将存储在浏览器中的某个位置。如果其他用户尝试在同一个浏览器中发出 OAuth 请求，它将使用第一个用户的存储数据！

有没有办法强制 OAuth 请求不使用存储的凭据并让用户每次都授权应用程序？

我尝试`no-cache`使用下面的代码将标头添加到控制器，但它当然没有做任何事情，因为请求是针对提供者 OAuth 端点而不是我的应用程序内部的任何地方。

```
 before_filter :set_cache_buster

  def set_cache_buster
    p "CACHE BBBBUSTED!"
    response.headers["Cache-Control"] = "no-cache, no-store, max-age=0,must-revalidate"
    response.headers["Pragma"] = "no-cache"
    response.headers["Expires"] = "Fri, 01 Jan 1990 00:00:00 GMT"
    request.headers["Cache-Control"] = "no-cache, no-store, max-age=0,must-revalidate"
    request.headers["Pragma"] = "no-cache"
    request.headers["Expires"] = "Fri, 01 Jan 1990 00:00:00 GMT"
  end 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T21:50:47.483

如果我猜对了，您可以通过 Omniauth 使用 Facebook 凭据登录。在您离开您的应用程序后，用户仍然通过*Facebook*进行身份验证（不是您的应用程序，不是 OAuth，因此转储您的 cookie 无济于事）。因此，下次当您尝试登录您的应用程序时（点击“使用 facebook 登录”链接/按钮），Facebook 不会询问任何内容（用户已获得 facebook 授权，应用程序权限也已到位）并简单地返回凭据，以便您的应用程序继续前进并让您以前的用户进入。

我想，您需要的是每次从应用程序注销时从 Facebook 注销。例如，检查这个 railscast 的一种处理方法：[http](http://railscasts.com/episodes/360-facebook-authentication?view=asciicast) ://railscasts.com/episodes/360-facebook-authentication?view=asciicast 。但是您必须分别与每个提供者（推特，...）打交道。或者您可以尝试在您的浏览器中查找和清除 facebook 的持久 cookie（afaik，facebook 使用持久 cookie 来实现“记住我”，但我不是专家，我从来不需要研究它）。

我唯一的其他评论是，在生产中，这种行为是*可取的*——只要它是同一个操作系统用户并且该用户在 twitter/facebook 等中保持身份验证，你的应用程序也假定它是同一个用户。如果您需要更改用户 - 在您的操作系统中注销/登录，或者您授予下一个人访问此应用程序、facebook 和所有其他设置了“记住我”但您尚未注销的网络服务的权限。对于自动测试，您根本不应该有这个问题，因为 cookie - 会话和持久性 - 不会在测试之间持续存在。

不过，我可以看到这对于手动测试来说是个问题。但是手动是手动的 - 只需手动从 facebook 注销就可以了。

这一切只是我根据你的描述的猜测。因此，不能保证，但希望至少在某种程度上有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-06T04:25:37.613

使用 facebook，您可以通过[设置](https://github.com/mkdynamic/omniauth-facebook#configuring)`auth_type`为`reauthenticate`.

# jquery - jQuery淡出DIV显示在一定的设定时间后

> ID：15118802
> 
> 赞同：12
> 
> 时间：2013-02-27T17:49:10.293
> 
> 标签：jquery

我有以下代码，并希望`.video-field-new`在页面加载后的指定时间后隐藏 DIV ()，例如 5 秒。那可能吗？

```
<div id="BodyField">
    <div class="video-field-new"></div>
</div> 
```

如果我可以让它淡出而不是仅仅消失，因为用户会看到这种情况发生，那么还有额外的好处。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-02-27T17:52:18.300

你可以这样做

```
$("#BodyField").delay(5000).fadeOut(); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-02-27T17:50:23.667

```
$(window).load(function(){
  setTimeout(function(){ $('.video-field-new').fadeOut() }, 5000);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-10T06:47:17.213

尝试

```
$('#div').fadeIn('fast').delay(1000).fadeOut('fast');
$('#div-inner').fadeIn('slow').delay(1000).hide(0); 
```

谢谢

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-03T13:18:27.190

甚至我们可以这样做：在 html

```
 <div id="BodyField">
        <div class="video-field-new">
      <p>This is your DIV with text which will fade Out after delay 5s using jQuery</p>
      <p>This is your DIV with text which will fade Out after delay 5s using jQuery</p>
      <p>This is your DIV with text which will fade Out after delay 5s using jQuery</p>
      <p>This is your DIV with text which will fade Out after delay 5s using jQuery</p>

    </div>
</div> 
```

在js中：

```
$(function() {
    $('.video-field-new').delay(5000).show().fadeOut('slow');
}); 
```

在 CSS 中：

```
div { 
    width:200px; 
    height:80px; 
    float:left; } 
```

演示点击链接 [https://jsfiddle.net/kingtaherkings/133v70se/](https://jsfiddle.net/kingtaherkings/133v70se/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-21T14:31:56.767

你也可以做这样的事情

```
$(document).ready(function(){
    $('.video-field-new').fadeOut(5000)
}) 
```

`$(selector).fadeOut(speed,easing,callback)`

**参数** | **描述**

* * *

**速度**= 可选。指定淡入淡出效果的速度。默认值为 400 毫秒

可能的值：

*   毫秒
*   “慢的”
*   “快速地”

* * *

**缓动**=可选。指定元素在动画不同点的速度。默认值为“摇摆”

可能的值：

*   “摇摆” - 在开始/结束时移动较慢，但在中间移动得更快
*   “线性” - 以恒定速度移动

* * *

**回调**= 可选。fadeOut() 方法完成后要执行的函数

* * *

有关更多信息，请查看此文档[https://www.w3schools.com/jquery/eff_fadeout.asp](https://www.w3schools.com/jquery/eff_fadeout.asp)

# java - 并发 HashMap 上的 Regadring 程序

> ID：15118806
> 
> 赞同：1
> 
> 时间：2013-02-27T17:49:30.027
> 
> 标签：java, collections

在一次采访中，面试官询问了并发 Hash Map 及其功能，我对此进行了详细解释。他说，在并发 HashMap 更新操作的情况下，ConcurrentHashMap 只锁定 Map 的一部分，而不是整个 Map。

所以他让我写一个简单的程序来证明，在更新操作过程中，ConcurrentHashMap 只锁定了 Map 的一部分，而不是整个 Map。我无法做到这一点，所以请告诉我如何实现这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:19:39.210

面试官可能期待一个简单的答案，例如：

*   如果整个地图对于 get/put 操作是同步的，添加线程不会提高吞吐量，因为瓶颈将是同步块。然后你可以用 synchronizedMap 写一段代码，显示添加线程没有帮助
*   因为映射使用了多个锁，并且假设您的机器上有多个内核，添加线程将提高吞吐量

下面的示例输出以下内容：

> 同步一线程：30
> 同步多线程：96
> 并发一线程：219
> 并发多线程：142

因此，您可以看到同步版本在高争用（16 个线程）下慢 3 倍以上，而并发版本在多线程下几乎是单线程速度的两倍。

值得注意的是，ConcurrentMap 在单线程情况下具有不可忽略的开销。

这是一个非常人为的例子，所有可能的问题都归因于微基准测试（无论如何都应该丢弃第一个结果）。但它暗示了会发生什么。

```
public class Test1 {
    static final int SIZE = 1000000;
    static final int THREADS = 16;
    static final ExecutorService executor = Executors.newFixedThreadPool(THREADS);

    public static void main(String[] args) throws Exception{

        for (int i = 0; i < 10; i++) {
            System.out.println("Concurrent one thread");
            addSingleThread(new ConcurrentHashMap<Integer, Integer> ());
            System.out.println("Concurrent multiple threads");
            addMultipleThreads(new ConcurrentHashMap<Integer, Integer> ());
            System.out.println("Synchronized one thread");
            addSingleThread(Collections.synchronizedMap(new HashMap<Integer, Integer> ()));
            System.out.println("Synchronized multiple threads");
            addMultipleThreads(Collections.synchronizedMap(new HashMap<Integer, Integer> ()));
        }   
        executor.shutdown();
    }

    private static void addSingleThread(Map<Integer, Integer> map) {
        long start = System.nanoTime();
        for (int i = 0; i < SIZE; i++) {
            map.put(i, i);
        }
        System.out.println(map.size()); //use the result
        long end = System.nanoTime();
        System.out.println("time with single thread: " + (end - start) / 1000000);
    }

    private static void addMultipleThreads(final Map<Integer, Integer> map) throws Exception {
        List<Runnable> runnables = new ArrayList<> ();
        for (int i = 0; i < THREADS; i++) {
            final int start = i;
            runnables.add(new Runnable() {

                @Override
                public void run() {
                    //Trying to have one runnable by bucket
                    for (int j = start; j < SIZE; j += THREADS) {
                        map.put(j, j);
                    }
                }
            });
        }
        List<Future> futures = new ArrayList<> ();
        long start = System.nanoTime();
        for (Runnable r : runnables) {
            futures.add(executor.submit(r));
        }
        for (Future f : futures) {
            f.get();
        }
        System.out.println(map.size()); //use the result
        long end = System.nanoTime();
        System.out.println("time with multiple threads: " + (end - start) / 1000000);
    }
} 
```

# oracle - PL/SQL 中的异常处理。

> ID：15118809
> 
> 赞同：1
> 
> 时间：2013-02-27T17:49:36.850
> 
> 标签：oracle, exception-handling, plsql

谁能解释一下为什么下面代码中的答案是“Inside OTHERS”而不是“ORA -20002 5 大于 3”

```
BEGIN
IF 5>3 THEN
    RAISE_APPLICATION_ERROR (-20002, ‘5 is greater than 3’);
END IF;
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE(‘Inside OTHERS’);
END; 
```

***答案：在其他人里面***

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:51:42.900

因为您正在捕获引发的异常并在控制台中打印消息“Inside OTHERS”。

我认为你需要这样的东西：

```
DECLARE
   comparison_error exception;
   PRAGMA EXCEPTION_INIT(comparison_error, -20002);
BEGIN
IF 5>3 THEN
    RAISE_APPLICATION_ERROR (comparison_error, '5 is greater than 3');
END IF;
EXCEPTION
    WHEN comparison_error THEN
        DBMS_OUTPUT.PUT_LINE('SQLERRM: ' || SQLERRM);
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Inside OTHERS');
END; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T21:42:46.043

试试这个 ：

```
BEGIN
IF 5>3 THEN
RAISE_APPLICATION_ERROR (-20002, '5 is greater than 3');
END IF;
EXCEPTION
WHEN OTHERS THEN
    DBMS_OUTPUT.PUT_LINE(sqlerrm);
    DBMS_OUTPUT.PUT_LINE('Inside OTHERS');
END; 
```

# vba - VBA7 编译错误 Excel Windows 7

> ID：15118813
> 
> 赞同：0
> 
> 时间：2013-02-27T17:49:58.950
> 
> 标签：vba, excel

假设我有一个名为的自定义库（.dll）；库.dll

在库中，有一个类叫做；班级

我生成一个名为 testObject 的对象：

```
Dim testObject As New Library.Class 
```

有一个函数叫做 testFunction：

```
Function testFunction(var1 As Double, var2 As Double, var3 As Double, var4 As Double, _
var5 As Double, var6 As Integer, var7 As Double, var8 As Double, var9 As Double)
    Call testSetup(var1, var2, var3, var4, var6, var7, var8, var9)
    testFunction = testObject.Field(var5)
End Function 
```

此函数调用 testSetup：

```
Sub testSetup(var1 As Double, var2 As Double, var3 As Double, var4 As Double, _
var5 As Double, var6 As Integer, var7 As Double, var8 As Double, var9 As Double)
    testObject.Lat1 = var1
    testObject.Lon1 = var2
    testObject.Lat2 = var3
    testObject.Lon2 = var4
    testObject.mth = var6
    testObject.GMT = var7
    testObject.ssn = var8
    testObject.icf = var9
End Sub 
```

我遇到的问题是，在运行时，如果我在该位置放置一个断点

```
testObject.Lat1 = var1 
```

在运行并跨到下一行时，如果我将鼠标悬停在对象上

```
testObject.Lat1 
```

我看到了错误

**对象变量或未设置块变量**

没有崩溃，也没有导致失败的明确错误消息。

有人有想法么？

我不确定错误是在库还是代码中？

它也可以通过输入单元格 =testFunction(var1, var2, var3....) 从 excel 中运行

**编辑：评论中的更多信息**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:28:35.177

在 VBA 中，您可以通过两种方法启动对象：

1.  `Dim o as New Object`
2.  `Dim o as Object: Set o = New Object`

不同之处在于，在版本一中，对象是*在第一次访问代码时启动的*！（注意：这与 VB.NET 不同）。在第二种情况下，它会在您运行`Set o = New Object`.

因此，当您在行中设置断点时`testObject.Lat1 = var1`，实际上尚未分配 testObject，因此调试器无法访问任何内容！只有在执行此行之后，您才会看到结果。

如果这让您感到困扰，您只需添加

```
Set testObject = new Library.Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T11:24:18.617

好的，已经找到解决方案。这不是由于代码中的错误，而是

```
Dim testObject As New Library.Class 
```

工作正常。

一样

```
Dim testObject As Library.Class 
```

其次是

```
Set testObject = New Library.Class 
```

问题是在VB中，我通过注册库dll文件

```
Tools > References 
```

我认为这已经足够了，因为我没有管理员权限。

我错了。

我需要以管理员身份登录，然后使用注册 dll

```
regsvr32 ".dll path" 
```

现在我在电子表格中看到了合理的输出。

# java - Java 线程“同步”

> ID：15118824
> 
> 赞同：6
> 
> 时间：2013-02-27T17:50:24.587
> 
> 标签：java, thread-safety, synchronized

本文[讨论](http://www.ibm.com/developerworks/library/j-threads1/index.html)Java 的“同步”关键字。

```
 ...
  private int foo;
  public synchronized int getFoo() { return foo; } 
  public synchronized void setFoo(int f) { foo = f; } 
```

如果调用者想要增加 foo 属性，那么执行此操作的以下代码不是线程安全的：

```
 ...
  setFoo(getFoo() + 1); 
```

**如果两个线程同时尝试增加 foo，结果可能是 foo 的值增加 1 或 2，具体取决于时间。**

现在，我的问题：

> 为什么 setFoo() 上的“同步”不能阻止上面的粗体线？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T17:52:29.420

因为你保证没有其他人在你身边得到 foo，并且除了你之外没有其他人将 foo 设置回来，但你不能保证在你调用 get() 和你调用之间没有人设法进出（或只是进出）放（）

您可以认为该代码完全等同于以下代码：

```
int temp = getFoo(); //safe method
temp = temp+1; //not protected here - im not holding any locks ...
setFoo(temp); //safe method 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-27T17:53:50.060

这是一个 check-then-act 竞争条件的例子。

可能会发生如下情况：

```
Thread-1 getFoo() returns 0
Thread-2 getFoo() returns 0
Thread-2 setFoo(1)
Thread-1 setFoo(1) 
```

这意味着两个线程试图增加 foo 但它只增加一次的效果。

正如其他答案所确定的那样，将增量与同步块锁定在与 getFoo() 和 setFoo() 相同的对象上同步将防止这种竞争条件，因为线程将无法像上面那样交错。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-27T17:52:42.280

这两种方法的`synchronized`关键字都不能使它成为线程安全的，因为一个线程可以调用`getFoo`，然后另一个线程可以调用`getFoo`，并且它们中的每一个都得到相同的结果。然后他们每个人都加一个并调用`setFoo`，最终结果是`foo`只增加一次，而不是两次。正如您的文章所指出的，这是一种*竞争条件*。

为了使其线程安全，读取和写入必须一起在同一个同步块中，没有单独的 get 和 set 方法。

```
public synchronized void addFoo(int addend)
{
   foo += addend;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T18:16:57.840

您的代码中的主要陷阱是它可能`getFoo`会被称为 "inside" `setFoo`。有点儿

```
setFoo(){
   //getFoo();
   //...
} 
```

这是不正确的，因为实际上`getFoo`是在调用之前调用`setFoo`的。这是显示它的示例：

```
public static int foo(int i) {
    System.out.print("FOO!");
    return i;
}

public static int bar(int i) {
    System.out.print("BAR!");
    return i;
}

public static void main(String[] args) throws Exception {
    System.out.println(foo(bar(1)));
} 
```

输出：

```
BAR!FOO!1 
```

如您所见`bar`，之前调用过`foo`. 因此，在您的情况下，可能会调用两个（或更多）线程`getFoo`，它们将在调用之前返回当前值`setFoo`。在这种情况下，它们都将具有相同的值，假设为 0，当它们调用时，它们都`setFoo`将其设置为 1。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T18:18:10.970

你不能用

```
 private volatile int foo; 
```

或原子[http://docs.oracle.com/javase/tutorial/essential/concurrency/atomicvars.html](http://docs.oracle.com/javase/tutorial/essential/concurrency/atomicvars.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T18:54:30.813

这段代码有帮助吗？

```
class C {
  private int foo;
  public int getFoo() { return foo; } 
  public void setFoo(int f) { foo = f; }
}

C myC = new C();
synchronized(myC) {
  int foo = myC.getFoo();
  myC.setFoo(foo + 1);
}
println(myC.foo); 
```

# php - 如果用户已通过身份验证，则 PHP 重定向

> ID：15118825
> 
> 赞同：1
> 
> 时间：2013-02-27T17:50:26.287
> 
> 标签：php, redirect

我是 php 新手（1 个半月），我已经设置了一个 PHP 登录脚本，它检查我设置的数据库是否已经注册并且它工作正常，但我想阻止用户而不是登录，而是在地址栏中输入 URL 以通过输入[http://example.com/home.html](http://example.com/home.html)来访问该页面，如果他们确实尝试这样做，请检查他们是否已经登录，如果他们没有't，将他们重定向到登录页面以输入他们的凭据。我到处都在寻找一个，它们要么根本没有帮助我，要么对于 PHP 新手来说很难理解。我相信它会包括使用 php 会话，但我不确定如何编码或编写它

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:52:13.300

使用会话：

```
if (!$_SESSION['is_logged_in']) {
   redirect_to_login_page();
} 
```

然后在您的登录脚本中，他们成功登录后，您只需

```
$_SESSION['is_logged_in'] = true; 
```

并且您的任何“受保护”页面都将允许它们通过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:52:30.330

假设您的登录脚本执行以下操作：

```
$_SESSION['userid'] = ...; 
```

然后你可以这样做：

```
if( !isset($_SESSION['userid'])) die(header("Location:/login.php")); 
```

当然，还有更优雅的解决方案，但它们依赖于设置的更具体方面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:53:01.603

您可以先编写一些会话检查，然后将该文件包含在您必须保护的所有文件之上。例如

```
session_start();
if($_SESSION['authenticated']!=1)
{
echo "Not logged in";
} 
```

如果用户名和密码正确，您可以在登录表单操作中相应地设置该会话值

# jquery - 如何使用 JQuery 让不同的内容通过导航单击填充空间？

> ID：15118828
> 
> 赞同：-4
> 
> 时间：2013-02-27T17:50:30.590
> 
> 标签：jquery, html, navigation, onclick

我不知道 JQuery，但我希望创建一个框，根据上面导航栏的点击来填充不同的内容。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:55:56.487

正如我在对该问题的评论中所说，这个问题太宽泛了，我希望它会被社区关闭。但我想我会提供一些建议：

1.  当一个元素被点击时，你可以触发一个函数调用，方法是让 jQuery`click`在该元素上连接一个处理程序。您需要能够告诉 jQuery 您正在谈论的是哪个元素，您可以使用任何 CSS 选择器来做到这一点。您可能会使用 an `id`（尽管`id`s 通常不一定是最佳选择）。例如：

    ```
    $("#foo").click(function() {
        alert("Hi there");
    }); 
    ```

    ...将`click`使用`id` `"foo"`.

2.  您可以使用`html`函数（对于您在代码中的字符串中指定的内容）或`load`函数（对于您按需从服务器加载的内容）将内容加载到元素中，再次通过让 jQuery 查找元素，然后执行在上面：

    ```
    $("#foo").html("New content");

    $("#foo").load("/path/to/new/content/on/server"); 
    ```

[jQuery API 文档](http://api.jquery.com)是一个很好的起点，并且有许多在线教程和博客。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:53:55.640

为此，您应该阅读 jQuery 的基本概念，尤其是 jQuery [click](http://api.jquery.com/click/)和[html](http://api.jquery.com/html/) / [text](http://api.jquery.com/text/)函数。

在最基本的形式中，您可以像这样使用它：

```
$('#myNavLink').click(function(){
  $('#myContentArea').text("This is the new content text");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:55:27.283

这是一个非常广泛的问题，并且在互联网上都有答案；但是，为了让您开始，您需要查看以下语法：

```
var value = '<p>Here is my new content that came from my database, fetched using Ajax & jQuery!</p>';
$('#mydiv').html(value); 
```

请注意，上面的代码非常具有破坏性，这意味着它将完全替换所有内容。

祝你好运！

# php - 用于 MAMP 的 PCNTL 与 php5.4.4。和 OSX 10.8

> ID：15118829
> 
> 赞同：3
> 
> 时间：2013-02-27T17:50:32.820
> 
> 标签：php, mamp, pcntl

我在互联网上找到的所有说明都是针对旧版本的 phpize、MAMP、php 和 OSX。

我尝试按照以下说明进行操作：

使用 php5.4.4 和 OSX 10.8，但我一直遇到这个问题：

```
[27-Feb-2013 17:46:17 UTC] PHP Warning:  PHP Startup: pcntl: Unable to initialize module
Module compiled with module API=20090626
PHP    compiled with module API=20100525
These options need to match
 in Unknown on line 0 
```

我的问题是，如何使用 API=20100525 编译它，我升级了基础 php，所以我使用的是 5.4.4 phpize：

```
pcntl tjstalcup$ /usr/local/bin/phpize
Configuring for:
PHP Api Version:         20100412
Zend Module Api No:      20100525
Zend Extension Api No:   220100525 
```

当我运行 make test 我得到：

```
PHP         : /usr/bin/php 
PHP_SAPI    : cli
PHP_VERSION : 5.3.15
ZEND_VERSION: 2.3.0 
```

我觉得这就是问题所在，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-15T08:35:38.903

I ran into this problem when I was trying to install memcache on MAMP Pro running PHP 5.4.10 on OSX 10.8.

I resolved the problem by using the phpize located within the PHP version within MAMP so for example when compiling I used `/Applications/MAMP/bin/php/php5.4.10/bin/phpize` with my PHP version being 5.4.10

I suggest phpize'ing it with `/Applications/MAMP/bin/php/php5.x.x/bin/phpize` instead of the phpize located in the `/usr/local/bin/`

Also worth mentioning I ran into a few problems with the compiler so found a useful post [HERE](https://serverfault.com/questions/386392/troubles-with-memcache-so) which explains to use `MACOSX_DEPLOYMENT_TARGET=10.8 CFLAGS='-fgnu89-inline' LDFLAGS='-fgnu89-inline' CXXFLAGS='-fgnu89-inline' ./configure` instead of the ordinary `./configure`

# php - 项目的 ZF2 私有存储库

> ID：15118830
> 
> 赞同：0
> 
> 时间：2013-02-27T17:50:35.003
> 
> 标签：php, git, repository, zend-framework2, bitbucket

我通过 Composer 启动了 ZendSkeletonApplication。我将需要我的项目 PRIVATE 存储库 (Git)。怎么做？Skeleton 现在有 .git 文件，所以我如何处理我的项目，例如在 BitBucket 上？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T08:03:01.687

从头开始创建 ZF2 框架项目的最佳方法是使用 ZFTool ( [http://framework.zend.com/manual/2.1/en/modules/zendtool.introduction.html](http://framework.zend.com/manual/2.1/en/modules/zendtool.introduction.html) )。将其安装到 /usr/local/bin （具有可执行权限），然后您可以执行以下操作：

```
$ zftool.phar create project project_name 
```

这将在 project_name 文件夹中为您提供一个完全免费的 git 框架应用程序。

现在在 BitBucket 上创建一个私有存储库，并按照说明使用磁盘上已有的代码进行设置。

请注意，在 project_name 中创建的项目有一个 .gitmodules 文件。如果您使用 Composer，您可以在添加到 BitBucket 之前删除此文件。如果您想使用子模块，则将其设置为 ZF2 作为子模块，供您初始化和更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:54:26.253

通过利用 git 的子模块功能，您可以在 bitbucket 上拥有自己的项目，并将 zend 库等作为单独的 lib/-目录中的子模块，如下所示：

```
YourProject/   <-- Your git working tree (via git init)
  public/
  libs/
    Zend/      <-- a git submodule
  application/ 
```

添加子模块的命令是`git submodule add http://zf-repo libs/Zend`. 然后您可以单独更新和跟踪 zend 框架，因为您的主 git 工作树还将引用 Zend 框架库的特定版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:15:08.823

一旦你分叉了[ZendSkeletonApplication](https://github.com/zendframework/ZendSkeletonApplication)，你可以将这个分叉推送到你的 Bitbucket 帐户或你自己的服务器/网络上的私有存储库。

您可以在 Bitbucket 上部署自己的包/模块，甚至可以根据[需要通过 composer 要求它们](http://getcomposer.org/doc/articles/handling-private-packages-with-satis.md)，但正如@Lars 所说，如果这对您来说更容易，可以简单地使用[git 子模块](http://book.git-scm.com/5_submodules.html)。

如果您不熟悉该工具，Niels Aderman 也有关于[高级作曲家用法的精彩演示。](http://www.naderman.de/slippy/src/?file=2012-11-22-You-Thought-Composer-Couldnt-Do-That.html)

# libreoffice - 重新打开 LibreOffice Calc 后边框大小发生变化

> ID：15118833
> 
> 赞同：0
> 
> 时间：2013-02-27T17:50:39.507
> 
> 标签：libreoffice

我正在使用 LibreOffice Calc，并尝试设置单元格的边框。当我执行以下操作时：

*   将单元格边框更改为 1pt
*   保存工作簿
*   关闭工作簿
*   重新打开工作簿

边框大小从 1pt 变为 2.50pt，是什么导致了这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-20T07:46:36.773

我在 Bugzilla 上发现了这两个错误：[“LO 3.6 和 4.0 渲染单元格边框比 3.4 更厚”](https://bugs.freedesktop.org/show_bug.cgi?id=60607)和[“FILEOPEN 特定 .xlsx 显示单元格边框线格式错误（太粗）”](https://bugs.freedesktop.org/show_bug.cgi?id=56960)。

它们可能与您的问题有关。

看起来这已在最新的稳定分支 LibreOffice 4.1 中得到修复。[您可以从那里](https://www.libreoffice.org/download)更新您的版本，然后再试一次。

此外，如果您对 LibreOffice 有更多疑问，您可能想在[ask.libreoffice.org](http://ask.libreoffice.org/en/questions/)上向他们提问以集中信息。

# sql - 从临时表更新

> ID：15118834
> 
> 赞同：13
> 
> 时间：2013-02-27T17:50:40.387
> 
> 标签：sql, sql-server, tsql, sql-update, temp-tables

询问：

```
SELECT ID, T.c.value('@Address', 'nvarchar(20)' ) as Address
INTO #TMP
FROM TABLE1
    CROSS APPLY XMLData.nodes('/Document') AS T(c)

UPDATE TABLE1
SET HomeAddress = (SELECT TOP 1 t.Address
                   FROM #TMP t
                   WHERE t.ID = ID) 
```

主要是，我需要将数据 OUT 从 XML 字段复制到同一个表中的普通字段。

问题：

1.  为什么所有记录都在 Table1 上获得 HomeAddress 的任何原因？
2.  Cursor 真的是更新 Table1 值的唯一方法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-27T17:53:22.697

```
UPDATE T2
SET HomeAddress = t1.address
FROM TABLE2 t2
join TABLE1 t1 on T1.ID = t2.HomeAddressID
and t2.HomeAddress <> t1.address 
```

使用连接。无需临时表或相关子查询。

如果表 1 处于一对多关系中，则这些是处理该问题的一些可能性。如果您有一个值指示一个且只有一个记录（我们的系统中有一个字段选择最重要的地址，它通过触发器维护以保证唯一性），试试这个：

```
UPDATE T2
SET HomeAddress = t1.address
FROM TABLE2 t2
join TABLE1 t1 on t1.ID = t2.HomeAddressID
WHERE t1.somefield = 'somevalue'
and t2.HomeAddress <> t1.address 
```

如果您需要基于其他字段（例如最近日期）的唯一记录，请尝试以下变体：

```
UPDATE T2
SET HomeAddress = t1.address
FROM TABLE2 t2
join TABLE1 t1 on t1.ID = t2.HomeAddressID
join (select id, max(somedatefield) from  table1 group by id) t3 on t3.id = t1.id
Where  t2.HomeAddress <> t1.address 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T18:02:07.893

在更新时，我需要完全限定表格如下：                  

```
UPDATE TABLE1 SET TABLE1.HomeAddress = (SELECT TOP 1 t.Address  
               FROM #TMP t  
               WHERE t.ID = TABLE1.ID) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-03T22:53:30.973

```
SELECT P.TipoComprob,P.NoComprob,C.Importe as ImpIVA1,ROUND(100/P.ImpGravado*C.Importe,1)
 as PorcIVA1 
       INTO #Temporal
       FROM ComprobProv AS P
       LEFT JOIN PasesCompras AS C ON C.TipoComprob=P.TipoAsiento AND 
C.NoComprob=P.NoComprob
WHERE P.PorcIVA1 =0 and P.CatIVA = 'Ri' AND P.ImpGravado>0 AND C.CodCuenta=110303010 AND ROUND(100/P.ImpGravado*C.Importe,1) IN (21.00,10.50,27.00);
go

select * from #Temporal;
go

UPDATE 
   t1 
SET 
   t1.ImpIVA1 =  t2.ImpIVA1, t1.PorcIVA1 = t2.PorcIVA1
FROM
   dbo.ComprobProv t1
   INNER JOIN #Temporal t2
   ON t1.TipoComprob = t2.TipoComprob AND t1.NoComprob = t2.NoComprob;
go 
```

-- 请注意，“GO”对于保留 SQL Server 2017 中的上下文很重要，否则您会发现“未知字段名称”错误。

# node.js - Node/Angular/Express 路由问题

> ID：15118835
> 
> 赞同：2
> 
> 时间：2013-02-27T17:50:46.410
> 
> 标签：node.js, routes, express, angularjs, salesforce

我正在使用节点角度种子 + express ( [https://github.com/btford/angular-express-blog/](https://github.com/btford/angular-express-blog/) ) 创建一个简单的节点应用程序，我正在尝试将其绑定到 Salesforce REST 中以获取数据。我选择了一个为 Salesforce 提供身份验证和 CRUD 层的节点包，称为 NForce ( [https://github.com/kevinohara80/nforce](https://github.com/kevinohara80/nforce) )。

我创建了一个简单的身份验证流程，它使用在我的节点应用程序中定义的获取路由。问题是，虽然 url 被加载，并且我假设路由发生了，但我并没有按照我的 route get 函数的规定被重定向。奇怪的是，如果我在单击登录按钮（然后具有身份验证 URL）后刷新页面，所有正确的事件都会开始发生，并且我会按预期重定向到 OAuth 流。

有问题的路线是'/oauth/authenticate'

我不知道这是否是 Angular 中未定义的节点路由的 Angular 问题： [https ://github.com/greenstork/donor-360/blob/master/public/js/app.js](https://github.com/greenstork/donor-360/blob/master/public/js/app.js)

或者，如果这是我在 Node 中构建路由的方式的问题：

[https://github.com/greenstork/donor-360/blob/master/app.js](https://github.com/greenstork/donor-360/blob/master/app.js)

[https://github.com/greenstork/donor-360/tree/master/routes](https://github.com/greenstork/donor-360/tree/master/routes)

我对 node 和 JS MVC 编程比较陌生，所以任何建议都将不胜感激。提前致谢。

# c# - linq 如何填充字典对象

> ID：15118843
> 
> 赞同：1
> 
> 时间：2013-02-27T17:50:58.943
> 
> 标签：c#, linq

我以前有过这个，我已经消除了 KVP，只拥有 Dictionary 属性。

## 前：

```
public class GranuleAttributes
{
    public Dictionary<string, KVP> attributes { get; set; }
}
public class KVP
{
    public string ID { get; set; }
    public string Value { get; set; }
} 
```

## 后：

```
public class GranuleAttributes
{
    public Dictionary<string, string> attributes { get; set; }
} 
```

在我用以下 LINQ 填充我的字典之前：

```
 attributes =
    (
        from attrRow in granuleGroup.First()
        select new KVP()
        {
            ID = Convert.ToString(attrRow["AttributeID"],
            Value = (string)attrRow["AttributeValue"]
        }
    ).ToDictionary(p => p.ID) 
```

我现在如何填充我的属性对象？

## 更新

好的完全披露，这里是代码：

```
var groups = reader.Cast<IDataRecord>()
    .GroupBy(dr => new { ID = (int)dr["id"] })
    .GroupBy(g => g.Key.ID);

response.attributes = (
    from granuleGroup in groups
    let granuleRow = granuleGroup.First().First()
    select new USpaceDataAttributes()
    {
        id = (int)granuleRow["id"],
        endDate = Convert.ToDateTime(granuleRow["endDate"]),
        startDate = Convert.ToDateTime(granuleRow["startDate"]),
        type = !DBNull.Value.Equals(granuleRow["type"]) ? (string)granuleRow["type"] : "",
        attributes =
        (
            from attrRow in granuleGroup.First()
            select new KVP()
            {
                ID = !DBNull.Value.Equals(attrRow["AttributeID"]) ? Convert.ToString(attrRow["AttributeID"]) : string.Empty,
                Value = !DBNull.Value.Equals(attrRow["AttributeValue"]) ? (string)attrRow["AttributeValue"] : string.Empty
            }
        ).ToSerializableDictionary(p => p.ID)
    }
).ToList(); 
```

然后我有自己的类，喜欢`public class SerializableDictionary<TKey, TVal> : Dictionary<TKey, TVal>, IXmlSerializable, ISerializable`下面的扩展方法。

```
#region ExtensionMethod
public static class CollectionExtensions
{

    public static SerializableDictionary<TKey, T> ToSerializableDictionary<TKey, T>(this IEnumerable<T> seq, Func<T, TKey> keySelector)
    {
        var dict = new SerializableDictionary<TKey, T>();
        foreach (T item in seq)
        {
            TKey key = keySelector(item);
            dict.Add(key, item);
        }

        return dict;
    }
} 
#endregion 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:40:41.400

我认为您不需要选择匿名对象或 KVP 对象

```
attributes = granuleGroup.First()
                 .ToDictionary(r => Convert.ToString(r["AttributeID"]),
                               r => Convert.ToString(r["AttributeValue"])); 
```

* * *

更新：您应该将值选择器添加到您的扩展方法

```
public static class CollectionExtensions
{    
    public static SerializableDictionary<TKey, TValue> ToSerializableDictionary<T, TKey, TValue>(
       this IEnumerable<T> source, Func<T, TKey> keySelector, Func<T, TValue> valueSelector)
    {
        var dict = new SerializableDictionary<TKey, TValue>();
        foreach (T item in source)
        {
            TKey key = keySelector(item);
            TValue value = valueSelector(item);
            dict.Add(key, value);
        }

        return dict;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:52:45.800

```
attributes =
    (
        from attrRow in granuleGroup.First()
        select new {            
            Key = Convert.ToString(attrRow["AttributeID"],
            Value = (string)attrRow["AttributeValue"]
        }
    ).ToDictionary(p => p.Key, p => p.Value) 
```

# css - CSS菜单三角形不起作用

> ID：15118846
> 
> 赞同：1
> 
> 时间：2013-02-27T17:51:19.067
> 
> 标签：css, css-selectors

我需要一些 CSS 帮助。有两件事我想实现，但到目前为止我没有成功。网站链接：http: [//hn.k12.oh.us/testsite/district/](http://hn.k12.oh.us/testsite/district/)

当我将鼠标悬停在水平菜单（主菜单）项目上时，我希望出现一个三角形。我已经在垂直菜单中实现了这一点，但无法让它显示在水平菜单中。我希望它类似于垂直菜单的情况。

我正在使用以下代码。

```
#primary-menu > ul > li:hover:after {
  content: '';
  display: block;
  width: 0;
  height: 0;
  position: absolute;
  left: 50%;
  bottom: 0;
  border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-bottom: 10px solid #f7df2b;
  margin-left: -10px;
} 
```

我希望三角形显示在当前活动的菜单项上。我无法让它适用于水平或垂直菜单。

我已经尝试了以下css的上述内容：

```
#primary-menu > ul > li.active a { 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:04:28.720

```
#primary-menu > ul > li:hover:after { 
```

应该

```
#primary-menu ul > li:hover:after,
#primary-menu ul > li.current_page_item:after { ... 
```

或者

```
#primary-menu-menu > ul > li:hover:after,
#primary-menu-menu > ul > li.current_page_item:after { ... 
```

您错误地指定了父/子关系。

# javascript - 使用动态生成的 DOM 属性解释这个 IE 事件绑定机制

> ID：15118849
> 
> 赞同：1
> 
> 时间：2013-02-27T17:51:25.440
> 
> 标签：javascript, dom, internet-explorer, dom-events, legacy-code

我继承了一个看起来非常讨厌的事件绑定包装器，它的基本原理使我无法理解。我所知道的是使用它的插件的 IE 实现如果我尝试用一​​个简单的`attachEvent`或别名通过 jQuery 替换它就会中断。这段代码的作者已经使用它很长时间了，他忘记了它的原理和原因.

```
function AddEvent(obj, type, fn) {
    if (obj.attachEvent) {
        obj['e' + type + fn] = fn;
        obj[type + fn] = function() {
            obj['e' + type + fn](window.event);
        };
        obj.attachEvent('on' + type, obj[type + fn]);
    }
    else {
        obj.addEventListener(type, fn, false);
    }
}; 
```

我熟悉将函数直接附加到以事件挂钩命名的 HTML 属性或 DOM 属性的非常基本的方法，但这看起来更糟糕。这是我对正在发生的事情的解释：

创建一个带前缀的字符串，`e`由事件挂钩标签和字符串强制函数 (!?) 组成；在相关元素上创建该名称的属性，并将函数分配给它。

```
obj['e' + type + fn] = fn; 
```

没有前缀的相同字符串将是元素的另一个属性，它调用一个函数，该函数反过来执行原始传递的函数（出于某种原因使用我们刚刚定义的别名），并`window.event`作为参数。

```
obj[type + fn] = function() {
    obj['e' + type + fn](window.event);
}; 
```

最后，使用`attachEvent`方法将前面的函数绑定到事件钩子上。

```
obj.attachEvent('on' + type, obj[type + fn]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:57:27.210

您可能可以将其替换为：

```
function AddEvent(obj, type, fn) {
    if (obj.attachEvent) {
        obj.attachEvent('on' + type, function (event) {
            return fn(event || window.event);
        });
    }
    else {
        obj.addEventListener(type, fn, false);
    }
}; 
```

`obj`除非对带有两个非常奇怪的属性名称的污染有一些依赖。

# linq - 如何获取具有特定子字符串标题的目录的文件名

> ID：15118850
> 
> 赞同：0
> 
> 时间：2013-02-27T17:51:25.780
> 
> 标签：linq, linq-to-entities

我正在尝试将文件中的所有行读取到具有特定子字符串标题的目录中。

我只需要一行代码就可以完成所有工作，这就是我尝试使用 LINQ 的原因。

```
File.ReadAllLines(Directory.GetFiles(Path).Select(i=>  i.Where(i.Contains("mystring")) ); 
```

但编译器不喜欢它——我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:01:44.087

试试这个，它处理可能的异常。

```
string fileContent = string.Empty;
var fileName = Directory.GetFiles(Path).Where(i => i.Contains("mystring")).FirstOrDefault();
if(!string.IsNullOrEmpty(fileName))
  fileContent = File.ReadAllLines(fileName); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:57:07.763

尝试这个：`File.ReadAllLines(Directory.GetFiles(Path).First(i => i.Contains("mystring")))`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T17:58:12.407

要获取标题中包含某些字符串的所有文件，请使用该查询：

```
Directory.GetFiles(Path).Where(f => f.Contains("mystring").ToList()) 
```

您可以更改`ToList()`为`First()`仅获取第一个而不是全部。

# javascript - 解析 RSS 发布日期

> ID：15118852
> 
> 赞同：0
> 
> 时间：2013-02-27T17:51:30.477
> 
> 标签：javascript, html

我正在尝试从 RSS Feed 中解析 publishedDate，但没有成功...

我可以使用此代码显示日期：`thefeeds[i].publishedDate`.. 结果是：`Sat, 02 Feb 2013 22:00:00 -0800`但是，我希望这更友好...

```
 <script type="text/javascript" src="https://www.google.com/jsapi"></script>

    <script type="text/javascript">

        var feedcontainer=document.getElementById("feeddiv")
        var feedurl="http://feeds.folha.uol.com.br/folha/classificados/empregos/rss091.xml"
        var feedlimit=4
        var rssoutput="<ul>"
        function rssfeedsetup(){
            var feedpointer=new google.feeds.Feed(feedurl) //Google Feed API method
            feedpointer.setNumEntries(feedlimit) //Google Feed API method
            feedpointer.load(displayfeed) //Google Feed API method
        }

        function displayfeed(result){
            if (!result.error){
                var thefeeds=result.feed.entries
                for (var i=0; i<thefeeds.length; i++){

<!-- I THINK I'M DOING THIS LINES WRONG!! -->
                var pubDate = thefeeds[i].publishedDate
                var date = new Date(pubDate);
                var months = Array("Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro");
                var string = date.getDate() + " " + months[date.getMonth()] + " " + date.getFullYear()

<!-- END -->

                rssoutput+="<li><span>•&lt;/span> " + string + " - <a href='" + thefeeds[i].link + "' target='_blank'>" + thefeeds[i].title + "</a></li>"
                rssoutput+="</ul>"
                feedcontainer.innerHTML=rssoutput
            }
            else
            alert("Erro ao carregar as notícias!")
        }

        window.onload=function(){
            rssfeedsetup()
        }
        </script> 
```

怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T17:57:45.937

似乎缺少父代（在 for 循环中），但我不确定这是否只是复制粘贴错误。像这样，代码将循环设置**i**为不在数组中的数字...

```
 ...
 for (var i=0; i<thefeeds.length; i++)
 //--> here  is missing {
 ...
 //--> at the end of the block }
 ... 
```

# google-analytics - 什么是来自“Mozilla 兼容代理”的 Google Analytics（分析）流量

> ID：15118854
> 
> 赞同：3
> 
> 时间：2013-02-27T17:51:32.450
> 
> 标签：google-analytics, bing

在工作中，我们最近对我们的 URL 结构进行了一些更改（永久重定向到新 URL），将各种路由规则重定向到一致的格式/页面。这有效地改变了我们 90% 的 URL 结构。

在 Google Analytics（分析）中，我们看到“访问者”增加了近 30%，但我们的跳出率也出现了类似的飙升。这是从哪里来的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T17:51:32.450

经过进一步检查，当从 Google Analytics 中的“Mozilla Compatible Agent”钻取访问者的“网络”和位置时，大部分流量来自两个位置（佛罗里达州海厄利亚和加利福尼亚州旧金山），两者均来自微软的网络。这种流量一直存在，但在最近的变化之前占我们总流量的不到 1%。

我只能假设它与 Bing（可能是 Bing 的预览功能）有关，它实际上是在浏览器实例中执行每个页面并捕获结果。

我认为令人惊讶的是谷歌还没有过滤结果，但是由于大多数爬虫/蜘蛛不执行 JavaScript，因此可能不存在该功能。

这里需要注意的是在跟踪您的统计数据时要考虑到这一点。我们现在有一个过滤器来过滤来自“microsoft”作为网络源的流量，这样将来这不会对我们的统计数据产生如此强烈的影响。

# web-services - 使用 WSClient 调用外部 SOAP Web 服务时出错

> ID：15118855
> 
> 赞同：0
> 
> 时间：2013-02-27T17:51:34.023
> 
> 标签：web-services, grails, soap

我创建了一个希望从 Grails 访问的 SOAP Web 服务。

为了使用对象 WSClient，我已经安装了插件 ws-client。

我试过这里给出的例子：http: [//groovy.codehaus.org/Using+WSClient+in+Grails](http://groovy.codehaus.org/Using+WSClient+in+Grails)

所以我的代码是：

```
def index = { 

def proxy = new WSClient("http://www.w3schools.com/webservices/tempconvert.asmx?WSDL", this.class.classLoader)
proxy.initialize()

def result = proxy.CelsiusToFahrenheit(0) 
result = "You are probably freezing at ${result} degrees Farhenheit" 
flash.message = result 
} 
```

这是我得到的错误：

```
 javac: target release 1.5 conflicts with default source release 1.7
| Error 2013-02-27 17:47:06,901 [http-bio-8080-exec-10] ERROR errors.GrailsExceptionResolver  - JAXBException occurred when processing request: [POST] /WordGame/game/create
"org.tempuri" doesnt contain ObjectFactory.class or jaxb.index. Stacktrace follows:
Message: "org.tempuri" doesnt contain ObjectFactory.class or jaxb.index
    Line | Method
->>  197 | createContext in com.sun.xml.bind.v2.ContextFactory
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|    172 | newInstance   in javax.xml.bind.ContextFinder
|    132 | newInstance . in     ''
|    334 | find          in     ''
|    431 | newInstance . in javax.xml.bind.JAXBContext
|    349 | createClient  in org.apache.cxf.endpoint.dynamic.DynamicClientFactory
|    196 | createClient  in     ''
|    175 | createClient  in     ''
|    198 | createClient  in groovyx.net.ws.AbstractCXFWSClient
|    107 | initialize    in groovyx.net.ws.WSClient
|     30 | conversion .  in wordgame.GameController$$ENyfXWG9
|     42 | doCall        in wordgame.GameController$_closure1$$ENyfXWG9
|    195 | doFilter . .  in grails.plugin.cache.web.filter.PageFragmentCachingFilter
|     63 | doFilter      in grails.plugin.cache.web.filter.AbstractFilter
|   1110 | runWorker . . in java.util.concurrent.ThreadPoolExecutor
|    603 | run           in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run . . . . . in java.lang.Thread 
```

我知道调用方法 proxy.CelsiusToFahrenheit(0) 没有错误，因为我也有同样的错误：

```
def proxy = new WSClient("http://www.w3schools.com/webservices/tempconvert.asmx?WSDL", this.class.classLoader)
proxy.initialize() 
```

我已经尝试过使用我创建的其他 Web 服务，但我遇到了同样的错误。

我在谷歌上搜索过，我看到很多人遇到这个问题，但我没有找到解决方法。

配置：Windows 7 x64 Netbeans 7.2.1 Grails 2.2.0

有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:27:14.200

感谢您的回答，但问题出在插件上。为了工作，需要安装插件：

CXF

cxf-客户端

安装这两个插件解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T03:32:54.897

从错误信息

```
javac: target release 1.5 conflicts with default source release 1.7 
```

我认为这与JDK版本有关。WSClient 需要 JDK 来在运行时编译一些东西，所以你必须部署一个 1.7 版本的 JDK 来支持它。

# git - 为什么我尝试 git commit --amend 时会出错

> ID：15118858
> 
> 赞同：0
> 
> 时间：2013-02-27T17:51:41.823
> 
> 标签：git

我想修改我刚刚提交的提交消息，所以我尝试这样做：

```
git commit --amend 
```

（就像我通常做的那样），但我得到了一个错误：

```
Unable to find modified files; please check git status 
```

现在这很奇怪，因为我不是试图从提交中添加/删除文件，我只是想更改消息，所以我是否修改了文件并不重要。

任何人都可以解释这个错误信息（理想情况下，我怎样才能克服它）？

*** 编辑 ***

Mellowcandle 请求了我的 git 状态；这是（或多或少）：

```
# On branch some_branch
# Your branch is ahead of 'origin/some_branch' by 1 commit.
#
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#   modified:   static/js/someFile.js
#
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#   some/other/file
#   yet/another/file 
```

*** 编辑 #2 ***

当我尝试`git rebase -i`(with `reword`) 时也会出现同样的问题。

*** 编辑 #3 ***

这是`git config --list`GoZoner 要求的（略微匿名）的输出：

```
user.name=My Name
user.email=email@example.com
push.default=upstream
core.repositoryformatversion=0
core.filemode=true
core.bare=false
core.logallrefupdates=true
remote.origin.fetch=+refs/heads/*:refs/remotes/origin/*
remote.origin.url=git@github.com:someGitHubAccount/Apps.git
branch.master.remote=origin
branch.master.merge=refs/heads/master
branch.deploy.remote=origin
branch.deploy.merge=refs/heads/deploy
...*more branches that look similar* 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T07:05:59.340

Check if you don't have a custom hook which triggers on commit.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:19:53.650

或者，您可以只对当前提交的父级进行交互式变基

```
git rebase -i head~ 
```

然后选择`reword`更改提交消息的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T18:10:19.713

`git commit --amend`就像`git commit`它会回收你的旧提交一样工作。所以这意味着它会期望索引中实际上有一些更改，准备好提交。

所以，如果你想让你`someFile.js`被包括在内，`git add static/js/someFile.js`首先运行。如果您还想跟踪该未跟踪的文件，也可以使用`git add some/other/file`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T18:13:12.633

试一试`git commit --amend --only`，如果这不起作用，那就试一试`git stash; git commit --amend ; git stash pop`。我不确定你在这里处于什么状态。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-27T18:32:19.527

做`git stash`。然后做`git commit --amend`。之后做`git stash pop`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-23T21:53:52.057

对我有用，无论有没有修改的、未跟踪的文件。

```
$ echo 'a' > a; git add -A; git commit -m 'a'
$ echo 'b' > b; git add -A; git commit -m 'b'

$ git log --oneline
63f2dd1 b
a0b364a a
$ git commit --amend
$ git log --oneline
d4cdeb7 bxx            # changed the commit message
a0b364a a

$ ed a # edit 'a'
$ git status
# On branch master
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#   modified:   a
#
no changes added to commit (use "git add" and/or "git commit -a")

$ git commit --amend
$ git log --oneline
2d20e6e bxxyy           # changed the commit message again
a0b364a a

$ mkdir foo; echo 'c' > foo/c
$ git status
# On branch master
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#   modified:   a
#
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#   foo/
no changes added to commit (use "git add" and/or "git commit -a")

$ git commit --amend
ebg@ebg(31)$ git log --oneline
09c1b26 bxxyyzz
a0b364a a 
```

# notifications - 如何比较发送通知的组件版本？

> ID：15118860
> 
> 赞同：0
> 
> 时间：2013-02-27T17:51:47.163
> 
> 标签：notifications, workflow, tridion, tridion2009

我正在使用工作流（自动活动）。我想通过电子邮件显示组件的哪些部分已被修改。我想我可以使用类似的东西：my_server/views/ASP/CompareFrameset.asp?SystemIdentifier=tcm:25-18409

但我不知道如何使用属性“SystemIdentifier”。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T10:54:46.293

我认为您尝试构建下一个链接：

```
http://<yourServer>/Views/ASP/CompareFrameset.asp?tds51cmwknlcom&URI=Compare&CONTEXTURI=tcm:25-24905&FILTER=auto&ITEMTYPE=&MODE= 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:23:03.467

假设您只想包含指向比较功能的链接：系统标识符是当前工作流中的组件的 URI。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:41:14.330

我相信这与 Tridion 2009 的工作方式类似 - 检查Tridion 2011 SP1 中“[比较活动”的文档。](http://sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_Tridion_2011_SPONE/task_54_2DDAFF2CF95E4430AA0F27AD7A91B5F8)简而言之：您正在重新发明轮子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T10:03:57.903

作为记录，系统标识符是 MDVC 中用于区分打开的 CME 会话的唯一 ID。

它结合了诸如用户 ID、内容管理器的版本和服务器名称等信息。您可以从 MDVC 的 SystemIdentifier 属性中读取当前的系统标识符。

# php - PHP 参考：一个理解

> ID：15118863
> 
> 赞同：6
> 
> 时间：2013-02-27T17:52:02.777
> 
> 标签：php, reference

我在创建和构建我的一些 php 应用程序的过程中看到了 var 前面的 & 符号、= 和类名。

我知道这些是 PHP 参考，但我看过和看过的文档似乎并没有以我理解或混淆的方式解释它。您如何解释我看到的以下示例以使它们更易于理解。

```
 public static function &function_name(){...}

  $varname =& functioncall();

  function ($var, &$var2, $var3){...} 
```

非常感激

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:27:06.327

假设您有两个功能

```
$a = 5;
function withReference(&$a) {
    $a++;
}
function withoutReference($a) {
    $a++;
}

withoutReference($a);
// $a is still 5, since your function had a local copy of $a
var_dump($a);
withReference($a);
// $a is now 6, you changed $a outside of function scope
var_dump($a); 
```

因此，通过引用传递参数允许函数在函数范围之外对其进行修改。

现在是第二个例子。

你有一个返回引用的函数

```
class References {
    public $a = 5;
    public function &getA() {
        return $this->a;
    }
}

$references = new References;
// let's do regular assignment
$a = $references->getA();
$a++;
// you get 5, $a++ had no effect on $a from the class
var_dump($references->getA());

// now let's do reference assignment
$a = &$references->getA();
$a++;
// $a is the same as $reference->a, so now you will get 6
var_dump($references->getA());

// a little bit different
$references->a++;
// since $a is the same as $reference->a, you will get 7
var_dump($a); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T18:54:41.327

参考函数

```
$name = 'alfa';
$address = 'street';
//declaring the function with the $ tells PHP that the function will
//return the reference to the value, and not the value itself
function &function_name($what){
//we need to access some previous declared variables
GLOBAL $name,$address;//or at function declaration (use) keyword
    if ($what == 'name')
        return $name;
    else
        return $address;
}
//now we "link" the $search variable and the $name one with the same value
$search =& function_name('name');
//we can use the result as value, not as reference too
$other_search = function_name('name');
//any change on this reference will affect the "$name" too
$search = 'new_name';
var_dump($search,$name,$other_search);
//will output string 'new_name' (length=8)string 'new_name' (length=8)string 'alfa' (length=4) 
```

通常，您将方法与实现相同接口的对象一起使用，并且您希望选择接下来要使用的对象。

通过引用传递：

```
function ($var, &$var2, $var3){...} 
```

我相信您已经看到了这些示例，所以我将解释如何以及何时使用它。基本场景是您何时有一个大逻辑要应用于当前对象/数据，并且您不希望制作更多副本（在内存中）。希望这可以帮助。

# objective-c - 以编程方式将 NSTableView 内的 NSButton 位置设置为居中

> ID：15118872
> 
> 赞同：1
> 
> 时间：2013-02-27T17:52:25.897
> 
> 标签：objective-c, cocoa, position, nstableview, nstablecellview

是否可以以编程方式而不是使用来设置“位置”值（见下图）`IB`？我需要像图像中的那样设置它。我一直在寻找解决方案一段时间，但没有运气。

![位置](../Images/886370e01197a1faa18e0efb791a16ab.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T23:36:26.887

我相信该设置适用于按钮图像并对应于 NSButton 的 imagePosition 属性

# c# - Windows 服务 - 启动时崩溃

> ID：15118876
> 
> 赞同：2
> 
> 时间：2013-02-27T17:52:33.350
> 
> 标签：c#, windows, service, msdn

我已经构建了一个 Windows 服务来监控我们服务器上的一些设置，我已经开发了很多 WinForm 和 WPF 应用程序，但在 Windows 服务方面我绝对是新手，这就是为什么我求助于 msdn 并按照教程[如何创建一个简单的服务](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicebase%28v=vs.80%29.aspx)。现在我可以很好地安装该服务并使其运行，但前提是我从微软教程中删除了一些零碎的内容。但我很好奇为什么当我按照教程进行操作时，我的服务在启动时会出现意外错误。

经过一些测试后，该服务似乎在 SetServiceStatus() 的 onstart 方法中崩溃

```
public partial class MyService: ServiceBase
{
    private static ManualResetEvent pause = new ManualResetEvent(false);

    [DllImport("ADVAPI32.DLL", EntryPoint = "SetServiceStatus")]
    public static extern bool SetServiceStatus(IntPtr hServiceStatus, SERVICE_STATUS lpServiceStatus);
    private SERVICE_STATUS myServiceStatus;

    private Thread workerThread = null;
    public MyService()
    {
        InitializeComponent();
        CanPauseAndContinue = true;
        CanHandleSessionChangeEvent = true;
        ServiceName = "MyService";
    }
    static void Main()
    {
        // Load the service into memory.
        System.ServiceProcess.ServiceBase.Run(MyService());
    }

    protected override void OnStart(string[] args)
    {
        IntPtr handle = this.ServiceHandle;
        myServiceStatus.currentState = (int)State.SERVICE_START_PENDING;
        **SetServiceStatus(handle, myServiceStatus);**
        // Start a separate thread that does the actual work.
        if ((workerThread == null) || ((workerThread.ThreadState & (System.Threading.ThreadState.Unstarted | System.Threading.ThreadState.Stopped)) != 0))
        {
            workerThread = new Thread(new ThreadStart(ServiceWorkerMethod));
            workerThread.Start();
        }
        myServiceStatus.currentState = (int)State.SERVICE_RUNNING;
        SetServiceStatus(handle, myServiceStatus);
    }
 } 
```

现在，当我注释掉这些行时，我的服务似乎运行得很好`SetServiceStatus()`。为什么会失败？这是一个权利问题还是我完全错过了这里的重点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:58:12.237

`SetServiceStatus`通常，在使用框架实现托管服务时，您不必调用。

话虽这么说，如果你调用它，你需要在使用它之前*完全初始化*`SERVICE_STATUS`它。您当前仅设置状态，但[没有设置其他变量](http://msdn.microsoft.com/en-us/library/windows/desktop/ms685996%28v=vs.85%29.aspx)。

这是最佳实践中的建议[`SetServiceStatus`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686241%28v=vs.85%29.aspx)：“初始化`SERVICE_STATUS`结构中的所有字段，确保存在有效的检查点和等待状态的等待提示值。使用合理的等待提示。”

# security - 如何保护对 admin/cms 端的远程访问？

> ID：15118892
> 
> 赞同：-3
> 
> 时间：2013-02-27T17:53:19.823
> 
> 标签：security, configuration, browser, remote-access

什么是设置对您网站的 ADMIN 端/CMS 的安全远程访问的最佳方式。应用程序？- 有哪些可用的工具？配置？想法？隔离管理端？有谈论使用 SSL 证书（如何？）将在我的 PC 上使用浏览器访问管理端来管理用户..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:01:04.407

我将仅在服务器的本地主机上运行管理控制台，并使用 SSH`localhost:1234`从服务器的角度转发到`localhost:5678`我的机器的角度，如下所示：

```
ssh -L 127.0.0.1:5678:127.0.0.1:1234 user@server 
```

然后您可以通过 访问转发的端口`http://localhost:5678/`。

# ffmpeg - ffmpeg/ffprobe show_frames 选项

> ID：15118895
> 
> 赞同：3
> 
> 时间：2013-02-27T17:53:35.177
> 
> 标签：ffmpeg, ffprobe

我最近在我的 Ubuntu Linux 机器上安装了 ffmpeg 版本 0.8.5-4:0.8.5。

当我执行“ffprobe -show_frames [http://test.com/test.mp4](http://test.com/test.mp4) ”时，出现以下错误：

**无法识别的选项“show_frames”**

我已经尝试安装各种 ffmpeg 依赖包来解决这个问题，但没有成功。

有人可以通过告诉我我需要安装什么来解决这个错误来帮助解决这个错误吗？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-27T18:44:51.043

您使用的是源自 libav 而非 FFmpeg 的残缺的、伪造的“ffprobe”版本：

Ubuntu 从 FFmpeg 切换到 libav 是因为 Debian/Ubuntu ffmpeg 软件包维护者是 libav 开发人员。故意将名称“ffmpeg”和“ffprobe”用于非 FFmpeg 的东西令人失望，并且误导了用户并歪曲了 FFmpeg 开发人员的工作。另请参阅[谁能告诉我 ffmpeg、libav 和 avconv 之间的区别和关系？](https://stackoverflow.com/a/9477756/1109017)

这个奇怪的“ffprobe”没有`-show_frames`选项。你有三个选择：

*   [编译`ffmpeg`和/或`ffprobe`](https://ffmpeg.org/trac/ffmpeg/wiki/UbuntuCompilationGuide)
*   [使用 Jon Severinsson 的 FFmpeg PPA](https://launchpad.net/~jon-severinsson/+archive/ffmpeg)
*   [使用静态构建`ffmpeg`](http://ffmpeg.gusari.org/static/)

这三种方法都将提供一个真实的、有效的`ffprobe`. 如果您很懒惰，请使用静态构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T19:53:42.287

卸载当前版本的 ffmpeg（这是从 ffmpeg 站点下载的静态构建：http: [//ffmpeg.gusari.org/static/32bit/](http://ffmpeg.gusari.org/static/32bit/)

show_frames 选项在此版本中已弃用。

下载并安装最新版本：[http ://www.ffmpeg.org/releases/ffmpeg-1.1.3.tar.bz2](http://www.ffmpeg.org/releases/ffmpeg-1.1.3.tar.bz2)

# ios - 如何从ios上的这种rss获取数据

> ID：15118899
> 
> 赞同：0
> 
> 时间：2013-02-27T17:53:42.883
> 
> 标签：ios, objective-c, rss

如何从 ios 上的这种 rss 获取数据？

如何获取里面的数据`<![CDATA[ ?`

```
<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Title 1</title>
        <link>http://link1.com</link>
        <description>Description 1</description>
        <language>en-us</language>
        <pubDate>Wed, 27 Feb 2013 12:38:54 EST</pubDate>
        <lastBuildDate>Wed, 27 Feb 2013 12:38:54 EST</lastBuildDate>
        <webMaster>webmaster@site.com (Hunny Bunny)</webMaster>

        <item>
        <title>item 1 title</title>
        <link>http://item1 link</link>

        <description><![CDATA[
            <h2>My Item 2</h2>
            <img src="http://itemi.com/image1.png" align="left"/>
        ]]></description>
        <pubDate>Wed, 27 Feb 2013 12:10:40 EST</pubDate>
        </item>

        <item>
        <title>item 2 title</title>
        <link>http://item2.com/link</link>

        <description><![CDATA[
            <h2>My Item 1</h2>
            <img src="http://itemi.com/image1.png" align="left"/>
        ]]></description>
        <pubDate>Wed, 27 Feb 2013 12:10:40 EST</pubDate>
        </item>
</channel>
</rss> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:00:58.647

一个选项是使用[NSXMLParser](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)。在解析我的 RSS 和 ATOM 提要时，我使用它取得了巨大的成功。

要检查其中的信息`<![CDATA[...]]>`，您需要实现[NSXMLParserDelegate 协议](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSXMLParserDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intf/NSXMLParserDelegate)的以下方法：

```
- (void)parser:(NSXMLParser *)parser foundCDATA:(NSData *)CDATABlock 
```

这是一个很好的入门教程：[Parsing XML data with NSXMLParser](http://wiki.cs.unh.edu/wiki/index.php/Parsing_XML_data_with_NSXMLParser)

# c++ - 与 C++ 等效的 glib 的 GAsyncQueue？

> ID：15118901
> 
> 赞同：4
> 
> 时间：2013-02-27T17:53:43.510
> 
> 标签：c++, c, synchronization, glib

[glib](http://developer.gnome.org/glib/)有一个名为 的数据结构`GAsyncQueue`，它允许在没有信号量/锁等的情况下进行线程间通信，甚至使实现生产者/消费者解决方案的任务变得微不足道。`GAsyncQueue`如果两个不同的线程向一个结构推送数据，`push`函数内部实现对队列的互斥访问；更可怕的是，如果一个线程调用该`pop`函数，并且那里没有数据，则调用线程会阻​​塞，直到一些数据被其他线程推入队列。所有这些都以线程安全的方式完成，对开发人员透明。

尽管我很喜欢它，但这个库是为 C 构建的，对于高级语言可能有更好的替代方案。无论如何我都在考虑使用 glib，但是在 C++ 代码中使用 C 库感觉很奇怪......

所以，问题是：是否有 C++ 推荐的 glib 等价物？更具体地说，是否有更推荐的 C++ 库提供与`GAsyncQueue`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:32:15.083

在 C++ 程序中使用 C 绝对没有错（毕竟，C++ 实现很大程度上基于 C 运行时，例如，如果没有 pthread 库，C++11 线程支持就无法生存，至少在类 UNIX® 平台上是这样）。我绝对不会只选择工具/库，完全基于它编写的语言。但如果你必须使用其他东西，那么 glib 不是世界上唯一提供异步消息传递的库（顺便说一下，它看起来并不真正支持IPC）。无论如何，这是我立即想到的 C++ 框架列表（以随机顺序，与我的想法一样随机）：

*   [英特尔线程构建模块](http://threadingbuildingblocks.org)
*   [提升 MPI](http://www.boost.org/doc/libs/release/doc/html/mpi.html)
*   [Boost.ASIO](http://www.boost.org/doc/libs/release/doc/html/boost_asio.html)
*   [Qt](http://qt-project.org/doc/qt-4.8/threads.html)

每一种都有自己的长处和短处，使用哪一种取决于你的具体要求。我只能建议您注意整体应用程序架构以及异步消息传递是否适合应用程序的所有组件。例如，在涉及多于简单消息传递的或多或少复杂的应用程序中，此类异步队列通常与正在使用的事件通知机制集成（例如，OSX 是围绕[kqueue/GCD](https://developer.apple.com/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html)构建的）。

希望能帮助到你。祝你好运！

# javascript - StreetView 在 IOS (API v3) 中使 Safari 崩溃

> ID：15118903
> 
> 赞同：5
> 
> 时间：2013-02-27T17:53:46.003
> 
> 标签：javascript, ios, google-street-view

在 IOS 上使用全屏街景时，似乎存在内存问题，无论是在您自己的应用程序中，还是在视网膜 iPad 上的 Safari 中的谷歌网站中，可能还有其他？

在 StreetView 中不断点击快速改变位置的箭头，很快应用程序（或 Safari）将由于内存不足而被强制关闭。

一种解决方法是在全景图中添加一个监听器并关闭和打开可见性......

```
google.maps.event.addListener(pan, 'position_changed', function() { panmove(); });

function panmove()
{
    pan.setVisible(false);
    setTimeout(function() { pan.setVisible(true); }, 10);
} 
```

有没有其他人遇到过这个问题，是否有其他解决方案，因为切换可见性会导致 StreetView 暂时空白。

# bash - 根据某些条件将一个文件拆分为多个文件

> ID：15118906
> 
> 赞同：-1
> 
> 时间：2013-02-27T17:53:49.873
> 
> 标签：bash, unix

我有一个包含 2 月 1 个月数据的文件，我需要每天拆分`Feb`文件，即将文件拆分为`Feb_1`, `Feb_2`... `Feb_29`。

这是我的逻辑：

```
Inputfile= $1
monthname = "Feb"
while getopts :
datefield="1"
outfile="Feb_1"

while read line    
do
s = `echo "$line" | awk '{print $2}'`
t = `echo "$line" | awk '{print $3}'`
if [ "$s" = "$monthname" ]
    if [ "$t" = "$datefield" ] 
         echo $line > "$outfile"
    else
         datefield = $t
         outfile =$monthaname"_"$t
         echo $line > "$outfile"
    fi
else
  echo $line > "$outfile"
fi 
done < "$inputfile" 
```

但`s = echo "$line" | awk '{print $2}'`

这并没有给我第二个词，因为我正在使用`$2`它要求第二个命令行参数。我试过把`'`之前放`$2`如下。

```
s = echo "$line" | awk '{print '$2}' 
```

在这种情况下，它会抛出一个新错误，假设第一行是`Wed Feb 1`它的抛出错误，因为`Wed Feb 1`它不存在。

这是示例数据：

```
Wed Feb 1 00:10:00 cpu usage    
KLOGENT.exe 3068 SYSTEM 00 0:00:00 17345K 15467 BELOW NORMAL    
SGHT.exe 3868 SYSTEM 00 0:00:00 18845K 15499 BELOW NORMAL    
.......    
.......    
Wed Feb 1 00:15:00 cpu usage    
KLTREENT.exe 3068 SYSTEM 00 0:00:00 17345K 15767 BELOW NORMAL    
KJTRT.exe 3868 SYSTEM 00 0:00:00 18845K 13699 BELOW NORMAL    
..............   
...........    
Wed Feb 1 23:55:00 cpu usage    
HTR.exe 3068 SYSTEM 00 0:00:00 1785K 4532 BELOW NORMAL    
KLU.exe 3868 SYSTEM 00 0:00:00 15645K 678 BELOW NORMAL    
...............   
.................   
Thu Feb 2 00:10:00 cpu usage
JUYT.exe 3068 SYSTEM 00 0:00:00 143245K 157767 BELOW NORMAL   
GFD.exe 3868 SYSTEM 00 0:00:00 18845K 879 BELOW NORMAL    
.........................    
.......................    
Thu Feb 28 00:15:00 cpu usage    
FRE.exe 3068 SYSTEM 00 0:00:00 143245K 157767 BELOW NORMAL    
YUT.exe 3868 SYSTEM 00 0:00:00 18845K 879 BELOW NORMAL    
............................    
...................    
Thu Feb 28 23:55:00 cpu usage    
TRE.exe 3068 SYSTEM 00 0:00:00 143245K 157767 BELOW NORMAL    
KJH.exe 3868 SYSTEM 00 0:00:00 18845K 879 BELOW NORMAL 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T19:23:21.550

盯着我的水晶球来确定输入数据，你想要：

```
awk '{print > $2 "_" $3 }' input-file 
```

或者可能

```
awk '$2 == "Feb" {print > $2 "_" $3 }' input-file 
```

如果知道输入的实际格式，提供解决方案会简单得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T12:37:22.903

```
awk '/Feb/{file=$2"_"$3}{print $0>file".txt"}' your_log 
```

# objective-c - 在显示之前修改 Core Data 获取请求的结果

> ID：15118908
> 
> 赞同：0
> 
> 时间：2013-02-27T17:53:52.620
> 
> 标签：objective-c, uitableview, core-data, random, nsfetchedresultscontroller

我有一个应用程序，它使用 Core Data 从数据库中提取数据，并`UITableView`通过`NSFetchedResultsController`. 我想不时地随机插入不同类型的自定义单元格（例如，在每 10 到 20 个单元格之间），它不会从同一个数据库中获取其数据，并且将是`UITableViewCell`.

我对如何进入数据源方法`NSFetchedResultsController`和`UITableView`数据源方法感到有些困惑。我有各种选项允许对拉入的数据进行排序、过滤等，所以我不能依赖使用 indexPath 或类似的东西。

做这样的事情的最佳方法是什么？我知道我可以访问`fetchedObjects`-`NSFetchedResultsController`复制和修改它是正确的前进方式吗？比如说，创建`fetchedObjectWithInterstitialCells`并使用该数组的内容提供所有 Data Source 和 Delegate 方法？

有没有更好的方法/有其他方法吗？我需要能够保留对数据库中的数据进行排序/修改/过滤的能力，同时始终将这些间隙单元格保持在相同的间隔，即每 10 到 20 个单元格之间的随机间隔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T20:21:00.670

我会考虑以下三种操作之一：

A：将对象插入到数据库中，这些对象与其他数据一起被拉取，但具有足以区分它们的属性以显示 UITableViewCell 的不同子类。可能是最简单的出路，除非你有一个非常困难的数据模型。

`sectionNameKeyPath`B：如果您可以使用上的- 属性将数据存储中的数据分组为部分`NSFetchedResultsController`，请选择`NSFetchedResultsController`+ `UITableViewDataSource`- 方法，然后返回`[[self.fetchedResultsController sections] count] + numberOfInterstitialCells;`inside `numberOfSectionsInTableView:`。

然后，`cellForRowAtIndexPath`您需要覆盖 indexpath 中的 section-info，以便在 FetchedResultscontroller 的正确对象和您的插页式单元格之间切换。这可能是一种繁琐且困难的方法，但是如果您在 iOS6 上使用 parentContexts，那么实现的好处`NSFetchedResultsControllerDelegate`是非常棒的

C：使用普通的 fetchrequest 获取对象并将它们放入一个可变数组中，在其中插入间隙单元格，然后再加载视图并`UITableViewDataSource`使用此数组提供您的视图。与选项 A 一样简单，但您不会获得拥有 NSFetchedResults-Controller 的好处。

# ios - ARC 弱 ivar 在返回之前发布 - 构建发布时，而不是调试

> ID：15118909
> 
> 赞同：4
> 
> 时间：2013-02-27T17:53:52.837
> 
> 标签：ios, objective-c, automatic-ref-counting, weak-references, release-builds

我有一个懒惰地创建对象并将其存储为弱属性的类。其他类可能会请求这个对象，但显然必须保持对它的强引用以防止对象被释放：

```
// .h
@interface ObjectManager
@property(nonatomic, weak, readonly) NSObject *theObject;
@end

// .m
@interface ObjectManager ()
@property(nonatomic, weak, readwrite) NSObject *theObject;
@end

@implementation ObjectManager
- (NSObject *)theObject
{
    if (!_theObject) {
        _theObject = [[NSObject alloc] init];
        // Perform further setup of _theObject...
    }
    return _theObject;
}
@end 
```

当该方案设置为 Xcode 为 Debug 构建时，一切正常 - 一个对象可以调用`objectManagerInstance.theObject`并返回`theObject`。

**当方案设置为发布时，`theObject`返回`nil`：**

```
// Build for Debug:
NSObject *object = objectManagerInstance.theObject;
// object is now pointing to theObject.

// Build for Release:
NSObject *object = objectManagerInstance.theObject;
// object is now `nil`. 
```

我的猜测是编译器正在优化我的代码，因为`_theObject`它没有在访问器方法本身中进一步使用，因此`nil`在返回之前将弱变量设置为。看来我必须在实际返回变量之前创建一个强引用，我只能认为使用块来做，但会很乱，我宁愿避免它！

是否有某种关键字可以与返回类型一起使用来阻止 ivar 这么快被取消？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T18:28:54.950

最有可能的是，DEBUG 构建会导致对象在自动释放池中停留足够长的时间以使其“工作”，而 RELEASE 构建会导致优化器进行更多控制流分析，从而消除自动释放喋喋不休。

坦率地说，编译器并没有在发布版本中发出警告说代码永远无法工作是一个错误（请提交它，因为您有一个很棒的简洁示例）！

您需要在*某处*保持对该对象的强引用，直到任何需要强引用的对象有机会获取引用为止。

我想知道这样的事情是否可行：

```
- (NSObject *)theObject
{
    NSObject *strongObject;
    if (!_theObject) {
        strongObject = [[NSObject alloc] init];
        _theObject = strongObject;
        // Perform further setup of _theObject...
    } else {
        strongObject = _theObject;
    }
    return strongObject;
} 
```

即上面将更类似于返回自动释放对象同时*还在*内部维护弱引用的工厂方法。但是优化器可能太聪明了一半并且也破坏了上述内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-27T18:35:41.043

You're being bitten by the optimizer.

Since `_theObject` is a weak reference, the system is free to get rid of it, and zero out your weak reference, whenever it's not retained. But it's not required to do it right away.

In your lazy instantiator, the newly-created object is *never* retained. The optimizer sees this, and says "Wow! I can zero this reference at any time! Why don't I do it...right now!" And before you know it, you're returning nil.

What you want to do is assign the lazily-instantiated object to a local variable, for an implicitly strong reference that lasts for the scope of the function. You also want to tell the compiler that you really do want the full scope, using the objc_precise_lifetime annotation.

For details from the standard, [see this page](http://clang.llvm.org/docs/AutomaticReferenceCounting.html#id39).

# aem - CQ5 - 用于显示示例 HTML 的小部件

> ID：15118912
> 
> 赞同：1
> 
> 时间：2013-02-27T17:53:57.657
> 
> 标签：aem

我正在尝试构建一个小部件，该小部件的区域将显示约 20 行 HTML 代码的示例。此示例代码必须是可选择的，以便用户能够将其复制并粘贴到自己的文本编辑器中。

目前我正在使用 xtype`displayfield`并使用`fieldDescription`将我的 HTML 代码放入其中。我意识到这`fieldDescription`不允许我格式化我的代码。我还尝试使用 xtype`textarea`并将其设置`emptyText`为我的 HTML 代码，但单击 textarea 会删除 HTML 代码。

用户故事是我有一个文本区域，用户将在其中使用 HTML 代码填充文本区域。此 HTML 代码必须以某种方式结构化，以便 CSS 正确格式化其代码。我想包含一个如何构建此 HTML 代码的示例。

编辑 - 如果我可以将字体 Courier 应用到此以便于阅读，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T21:41:48.463

*   尝试使用`value`.`textarea`
*   设置`ignoreData`为 true 以避免从内容中填充值。
*   为了确保它不会被保存为属性 -`name`留空，或者只设置一个不以开头的值`./`
*   实现不同的字体 - 在页面上使用 CSS。如果要向小部件添加特定的 CSS 类，请使用`overCls`属性。
*   [在文档中](http://dev.day.com/docs/en/cq/current/widgets-api/index.html?class=CQ.Ext.form.TextArea)查找更多信息

# php - PHP，阿帕奇。在脚本完成之前向浏览器输出响应

> ID：15118914
> 
> 赞同：1
> 
> 时间：2013-02-27T17:54:01.660
> 
> 标签：php, output-buffering

我有一个脚本可以从数据库中提取用户，准备一条 XMPP 消息，遍历每个用户并发送 XMPP 消息，然后记录消息已发送。轻松运行超过 1000 个用户。这是从移动设备调用的服务器端 API 脚本。移动设备正在等待接收成功的 JSON 响应。用户体验应该很快，我不希望移动用户等待超过几秒钟的响应。

问题是脚本需要相当长的时间来遍历所有用户，所以我最初的解决方案是使用 ob_flush() - 注意这些只是测试脚本，看看计划的方法是否有效：

```
 ob_start(); 

$profiles_ar = array(
    "reach" => 30,
);

$return_ar = array(
    "success"   => $profiles_ar['reach'],
);

echo json_encode($return_ar);

$buffer = str_repeat(" ", 4096);                    // Note apparently  the buffer must be "filled" with 4096 characters (bytes?) for ob_flush() to work before sleep() occurs.

echo $buffer;

ob_flush();

flush();

for($i=0;$i < $profiles_ar['reach']; $i++)
{
   sleep(1);
}

echo "finshed: ".$i;

ob_flush();

flush(); 
```

这不起作用，在脚本完成之前没有任何输出 - 我错过了 OB 技术吗？

......所以做了一些搜索并想出了这个：

```
register_shutdown_function('process_after');

$profiles_ar = array(
    "reach" => 10,
);

$return_ar = array(
    "success"   => $profiles_ar['reach'],
);

echo json_encode($return_ar);

echo $buffer;

exit;

function process_after()
{
    global $profiles_ar;

    for($i=0;$i < $profiles_ar['reach']; $i++)
    {
       sleep(1);
    }

    echo "finshed: ".$i;
} 
```

这个适用于mac，但不适用于服务器....

有人有什么想法吗？如果我不能在主处理工作之前获得这种输出响应 JSON 的技术，那么我唯一的希望是在数据库中建立一个队列并运行一个 cron 作业........ ;(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:05:04.410

php.ini 中是否启用了 output_buffering？ [http://php.net/manual/en/outcontrol.configuration.php](http://php.net/manual/en/outcontrol.configuration.php)

我会在它自己的文件中重构 xmpp 消息的创建，然后使用 ajax 调用来发送每个消息。这样，您就不必等待每条消息成功。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T22:10:23.177

解决方案是添加：

```
 echo " ";
    ob_flush(); flush; 
```

循环内......

```
ob_start(); 

$profiles_ar = array(
    "reach" => 10,
);

$return_ar = array(
    "success"   => $profiles_ar['reach'],
);

echo json_encode($return_ar);

for($i = 0; $i < 5000; $i++)
{
    echo " ";
    ob_flush(); flush;
}

echo $buffer;

ob_flush();

flush();

ob_end_flush();

for($i=0;$i < $profiles_ar['reach']; $i++)
{
   sleep(1);
}

echo "finshed: ".$i;

ob_flush();

flush();

ob_end_flush(); 
```

这会反复强制循环第一次迭代的输出并最终启动。

# c++ - C ++访问二维数组指针处的值

> ID：15118917
> 
> 赞同：0
> 
> 时间：2013-02-27T17:54:07.627
> 
> 标签：c++, pointers, multidimensional-array

我需要一个动态的二维整数数组，它将代表一个标准矩阵。大小和元素在运行时从文件中读取。

从其他堆栈帖子中获取指导​​，我将数组设置如下；

```
void buildArray(ifstream &file, int** 2dArray);
void buildQueue(Queue<int> &Q, int** 2dArray);

int main()
{
    int** 2dArray;
    Queue<int> Q;
    //...
    // open file
    //...
    buildMatrix(file, 2dArray)
    buildQueue(Q, 2dArray)
}

void buildArray(ifstream &file, int** 2dArray)
{
    int size, element;
    while (file.good()) {
        file >> size;

        2dArray = new int*[size];
        for (int i = 0; i < size; i++)
            2dArray[i] = new int[size];

        // now I should be able to use 2dArray[r][c]

        for (int i = 0; i < size; i++) {
            for (int j = 0; j < size; j++) {
                file >> element;
                2dArray[i][j] = element;
            }
        } 
} 
```

然后我需要读取存储在每个位置 [r][c] 的整数并建立一个队列。我认为我的问题是取消引用指针......但我不确定。

```
void buildQueue(Queue<int> &Q, int** 2dArray)
{
    int row, column, element;
    // size is passed in as well, size is our rows or columns size here
    for (int i = 0; i < size; i++) {
            for (int j = 0; j < size; j++) {
                row = i;
                column = j;
                element = 2dArray[i][j];   // getting seg fault here!

                Q.push_back(row, column, element);
            }
     }
 } 
```

我应该补充一点，我知道我可以使用向量。我在这里挑战自己，负责任地使用指针构建、使用和取消分配二维数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:00:10.297

如果要在函数内分配初始数组，则需要将其作为三重指针传递并更改为：

`*2dArray = new int*[size]`,

或返回一个整数**

否则，您将丢失指向新内存的指针。

不要忘记，指针是按值传递的。照原样，在您`buildArray()`调用之后，您仍然没有指向有效内存的指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:56:42.120

什么是表？

```
table = new int*[size]; 
```

这不应该是

```
2dArray = new int*[size]; 
```

还从函数返回指针

改变

```
void buildArray(ifstream &file, int** 2dArray) 
```

至

```
int ** buildArray(ifstream &file) 
```

因为否则 buildArray 会获取变量的副本。这个副本现在保存了指向已分配内存的指针。调用函数中的指针永远不会更新。

在您的原始代码中，在 buildArray 调用之前和之后添加一个 printf 2dArray。

```
printf("%p, 2dArray);
buildMatrix(file, 2dArray);
printf("%p, 2dArray); 
```

你会看到 2dArray 没有改变。因此，您实际上是将未初始化的指针传递给 buildQueue。

buildArray 和 call 应该像这样改变

```
void buildArray(ifstream &file, int** arr)
{
    int size, element;
    while (file.good()) {
        file >> size;

        arr = new int*[size];
        for (int i = 0; i < size; i++)
            arr[i] = new int[size];

        for (int i = 0; i < size; i++) {
            for (int j = 0; j < size; j++) {
                file >> element;
                arr[i][j] = element;
            }
        }
    }

    return arr;
}

int main()
{
    int** 2dArray;
    Queue<int> Q;

    //...
    // open file
    //...
    2dArray = buildMatrix(file);
    buildQueue(Q, 2dArray);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T22:36:05.427

当您在函数中分配一个传入参数的指针时，您只会更改复制值。在 C/C++ 中，当您向函数发送参数时，会创建此参数的副本。因此，就像之前提到的其他答案一样，可以返回指针的新值，将指针更改`void buildArray(...)`为`int** buildArray(...)`或发送指针上的指针（看起来很困难），或者最后，您在 C++ 中，因此您可以发送参考，`void buildArray(ifstream &file, int**& 2dArray)`2dArray 也将是来自 main 的真正指针，您应该在不更改代码的情况下更改他的值。

# javascript - Javascript公共变量/方法

> ID：15118920
> 
> 赞同：0
> 
> 时间：2013-02-27T17:54:12.370
> 
> 标签：javascript, oop

我有如下的 JavaScript 代码；

```
var foo = (function() {
    //Private vars
    var a = 1;

    return {
        //Public vars/methods
        a: a,
        changeVar: function () {
            a = 2;
        }
    }
})(); 
```

现在我不确定公共变量/方法的语法是如何工作的？您能否解释一下“返回”变量/方法如何使它们公开？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T17:57:04.223

变量`foo`的值实际上就是这个函数返回的值。注意最后一行，`()`，表示这个函数是立即计算的。通过评估函数并将其返回值分配给变量，您可以将变量隐藏在本地（函数）范围内，以便在该范围之外无法访问它们。只有返回对象上的成员是可访问的，但是由于内部的任何函数都与它们的外部范围形成了一个闭包，因此您仍然可以使用本地（隐藏）变量。

一个例子是隐藏一些本地状态并且只允许通过一个方法访问它：

```
var foo = (function() {
    //Private vars
    var a = 1;

    return {
        //Public methods
        getVar: function () {
            return a;
        },
        setVar: function (val) {
            a = val;
        }
    }
})(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T17:57:16.953

好的，您已经在匿名函数中返回了一个对象，这意味着该对象已分配给`foo`. 因此，您可以访问对象的属性，如`foo.a`or `foo.changeVar`，但您可以继续让私有变量存在于函数的范围内。如果没有更具体的问题，将无济于事。

# c# - 在自引用虚拟属性中命名列

> ID：15118922
> 
> 赞同：1
> 
> 时间：2013-02-27T17:54:18.010
> 
> 标签：c#, .net, entity-framework, ef-code-first, entity-framework-4.1

我试图将父列和子列命名为更有意义的名称，而不是 Element_ID 和 Element_ID1。

Element 表的生成没有问题，但第二个表是我想要更新列名的表。

我尝试`[Column("ParentID")]`在父属性减速上方添加属性，但它对生成的表没有影响。

**实体类**

```
public class Element
{
    public Guid ID { get; set; } 
    public string Title { get; set; }
    public int Status { get; set; }       

    public virtual List<Element> Parent { get; set; }
    public virtual List<Element> Child { get; set; }
} 
```

**生成的迁移**

```
CreateTable(
    "dbo.ElementElements",
    c => new
        {
            Element_ID = c.Guid(nullable: false),
            Element_ID1 = c.Guid(nullable: false),
        })
    .PrimaryKey(t => new { t.Element_ID, t.Element_ID1 })
    .ForeignKey("dbo.Elements", t => t.Element_ID)
    .ForeignKey("dbo.Elements", t => t.Element_ID1)
    .Index(t => t.Element_ID)
    .Index(t => t.Element_ID1); 
```

如果我使用第二个实体，我可以根据需要制作第二个表输出

```
public class Hierarchy
{
    public Guid ID { get; set; } 
    public virtual Guid ParentID { get; set; }
    public virtual Element Parent { get; set; }
    public virtual Guid ChildID { get; set; }
    public virtual Element Child { get; set; }
} 
```

生成了以下创建脚本

```
CreateTable(
    "dbo.Hierarchies",
    c => new
        {
            ID = c.Guid(nullable: false),
            ParentID = c.Guid(nullable: false),
            ChildID = c.Guid(nullable: false),
        })
    .PrimaryKey(t => t.ID)
    .ForeignKey("dbo.Elements", t => t.ParentID)
    .ForeignKey("dbo.Elements", t => t.ChildID)
    .Index(t => t.ParentID)
    .Index(t => t.ChildID); 
```

那么是否可以通过一个实体类使用我想要的列名来生成第二个表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T22:58:46.337

如果我正确理解您的问题，您只需要使用 Fluent API 进行普通的多对多映射：

```
modelBuilder.Entity<Element>()
    .HasMany(e => e.Parent)
    .WithMany(e => e.Child)
    .Map(m => {
        m.ToTable("ElementMap"); // name of the link table
        m.MapLeftKey("ParentID");
        m.MapRightKey("ChildID");
    }); 
```

我希望生成的迁移将尊重此映射并使用提供的表和列名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-14T22:42:20.097

对于 EF 6，我使用了 Slauma 在当前线程[https://stackoverflow.com/a/15147308/13808871](https://stackoverflow.com/a/15147308/13808871)上发布的答案，但是切换了关系表上的列名，为了修复它，我交换了MapLeftKey 和 MapRightKey 配置方法的参数。

```
modelBuilder.Entity<Element>()
                .HasMany(e => e.Parent)
                .WithMany(e => e.Child)
                .Map(m =>
                {
                    m.ToTable("ElementMap");
                    m.MapLeftKey("ChildID");
                    m.MapRightKey("ParentID");
                }); 
```

希望这可以帮助！

有关详细信息，请转到[Microsoft 文档](https://docs.microsoft.com/en-us/ef/ef6/modeling/code-first/fluent/relationships#configuring-a-many-to-many-relationship)

# wcf - wsDualHttpBinding 在局域网上工作，但在互联网上不工作

> ID：15118924
> 
> 赞同：0
> 
> 时间：2013-02-27T17:54:23.040
> 
> 标签：wcf, lan

我有一个使用 wsDualHttpBinding 的 wcf 简单程序。我将 server.exe 放在另一台计算机上（在我的 LAN 网络上）并通过客户端调用一个方法。回调在客户端成功调用。然后我将 server.exe 放在我的 VPS 服务器（在 Internet 上）并运行 client.exe，客户端抛出 TimeoutException。我使用 9090 端口进行服务器监听。我也关闭了双方的防火墙。

怎么了？请帮忙，这让我发疯了。

编辑： **服务器和客户端都需要有效的 IP 地址吗？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T22:29:45.283

尝试在 server.exe 中发布带有元数据端点的 http 元数据，并在浏览器中打开客户端计算机上的 Web 服务页面。

我还建议您甚至在 Internet 上使用 nettcpbinding 而不是 wsDualHttpBinding，因为它更稳定、更持久，并且 AFAIK wsDualHttpBinding 需要两个端口来进行正常的双工对话（请参阅客户端绑定中的 ClientBaseAddress）。Tcp 需要一个

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:29:24.527

问题已经解决了！

在双工连接中，客户端和服务器都需要有效的 IP 地址。我改变了连接方式。我使用了netTcp。

反正tnx大家。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T13:00:15.747

检查客户的配置。尝试增加以下设置：

```
<binding name="WSDualHttpBindingEndpoint" 
openTimeout="00:01:00"
receiveTimeout="00:10:00"
sendTimeout="00:01:00" 
```

验证服务操作是否被调用并及时返回。输入和退出方法时让服务写入日志。

还要验证端口 9090 未被阻塞。

# c# - 如果在 using 语句中抛出异常，清理逻辑是否仍会被调用？

> ID：15118927
> 
> 赞同：3
> 
> 时间：2013-02-27T17:54:29.687
> 
> 标签：c#, winforms, httpwebrequest, try-catch, using-statement

`using`我对使用关键字有一些疑问。我有以下代码：

```
try {
   using (System.Net.WebResponse response = httpWebRequest.GetResponse()) {
      throw new Exception("Example");
   }
} 

catch ( Exception ex ) { 
} 
```

我的问题是，当异常发生时它会关闭连接吗？还是我必须关闭 catch 内的连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:56:28.887

是的，它将关闭连接。

a 的全部意义`using`在于，当您离开 的范围时，它会处理该对象`using`，即使它是通过异常处理的。

`using`块在底层是使用块实现的`try/finally`。

这也很容易进行实验测试：

```
public class Foo : IDisposable
{
    public void Dispose()
    {
        Console.WriteLine("I was disposed!");
    }
}

private static void Main(string[] args)
{
    try
    {
        using (var foo = new Foo())
            throw new Exception("I'm mean");
    }
    catch { }
 } 
```

输出是：

> 我被处置了！

# ios - 如何在运行时更改 iOS 6 中 uicontainerview 的视图控制器

> ID：15118930
> 
> 赞同：0
> 
> 时间：2013-02-27T17:54:37.063
> 
> 标签：ios

我有一个带有两个选项的 UISegmentedView 控件。这是 MasterViewController 的一部分。在 MasterViewController 内部，我有两个嵌入式视图控制器，childViewController1 和 childViewController2。我有一个绑定到 childViewController1 的 UIContainerView。现在我希望当我选择分段控件的选项 2 时，我应该以某种方式配置 UIContainerView 以使用 childViewController2。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-27T18:00:09.180

我绝不是专业的 iOS/Obj-C 开发人员，但我对您要完成的工作感到有些困惑。

更改视图控制器是什么意思？您可以在 viewDidLoad 中传递给不同的视图控制器。这些都连接在你的故事板中，我*认为*你也必须调用导航控制器，但我不确定。

不管怎样，我不明白你所说的“分段”控制是什么意思。你有两个视图控制器吗？你在两者之间传递数据吗？如果是这样，您将需要了解委托。如果没有，也许看看 segue 方法。我的 2 美分。

# java - 移动相交的对象，直到它们不再相交

> ID：15118931
> 
> 赞同：0
> 
> 时间：2013-02-27T17:54:42.410
> 
> 标签：java, collision-detection, collision, intersection

如果我必须仍然相交的对象。

我如何知道我应该将它们移动多少才能阻止它们相互接触？

我知道如何判断哪些对象是相交的（使用 java 的 intersects 方法。

我还应该提到，所有对象都在对象列表中（称为 objs 波纹管）......

```
public void move(Object ob){
    // this rectangle surrounds the object I'll check against
    // all of the other objects below
    Rectangle objectToCheck = ob.getBounds();

    // Cycle through all the other objects and check if they
    // cross over the rectangle I created above
    for(Object obj : objs){
        // Creates a bounding rectangle that is used temporarily
        // for each other object on the board
        Rectangle otherObject= obj.getBounds();

        // Check if one object crosses over another object
        if(otherObject != objectToCheck && otherObject.intersects(objectToCheck)){
         // they intersect! now how do i know how much to move them so
         // that they no longer intersect? 
    } 
```

# javascript - 跟随超链接到路由时，Backbone 的 View.render 方法会执行，但不会应用更改

> ID：15118933
> 
> 赞同：1
> 
> 时间：2013-02-27T17:54:48.140
> 
> 标签：javascript, backbone.js

我有一些简单的静态视图定义了一个主干应用程序，我正在尝试将一些子视图添加到等式中。

当我直接导航到路线时，子视图会正确呈现，但如果我通过超链接导航到路线，则布局会正确呈现，但子视图不会。

似乎有些东西超出了范围或尚未初始化，但需要一些帮助来确定是什么。

**路由器**

```
App.Router = Backbone.Router.extend({
    routes: {
        "": "home",
        "tmp": "tmp",
    },
    home: function() {
      var home = new App.Views.HomeLayout();
    },
    tmp: function() {
      var tmp = new App.Views.TmpLayout();
    }
}); 
```

**意见**

```
App.Views.HomeLayout = Backbone.View.extend({
  el: $('body'),
  template: _.template($('#tmplLayout').html()),
  initialize: function() {
    this.render();
  },
  render: function() {
    $(this.el).append(this.template());

    var menu = new App.Views.HomeMenuView({el: this.$('#menu')});
    menu.render();

    var page = new App.Views.HomeView({el: this.$('#content')});
    page.render();

    return this;
  }
});
App.Views.HomeMenuView = Backbone.View.extend({
  template: _.template($('#tmplHomeMenu').html()),
  render: function() {
    $(this.el).html(this.template());
    return this;
  }
});

App.Views.HomeView = Backbone.View.extend({
  template: _.template($('#tmplHome').html()),
  render: function() {
    $(this.el).html(this.template());
    return this;
  }
}); 
```

该应用程序在我的 index.html（也是我所有视图模板的位置）中使用以下内容进行初始化：

```
<script>
  new App.Router();
  Backbone.history.start();
</script> 
```

tmp 视图几乎是上述内容的复本，但具有不同的模板。

我尝试过的事情：

*   我把路由器的子视图减速也移动了，没有变化。
*   在每个子视图中调用 render 的初始化方法（类似于布局视图的定义方式），没有变化。

# bash - 如何在 bash shell 脚本变量中查找子字符串

> ID：15118934
> 
> 赞同：11
> 
> 时间：2013-02-27T17:54:49.327
> 
> 标签：bash, shell

我有一个像下面这样的变量。

```
variable = This script is not found

if [[ "$variable" = ~ "not found" ]];
then
echo "Not Found"
else
echo "Its there"
if 
```

在执行即时通讯低于错误时，

```
line 4: syntax error in conditional expression
./test.sh: line 4: syntax error near `found"'
./test.sh: line 4: `if [[ "$variable" = ~ "not found" ]]; ' 
```

谁能指出我，我在这里缺少什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-27T18:11:32.197

```
LIST="some string with a substring you want to match"
SOURCE="substring"

if echo "$LIST" | grep -q "$SOURCE"; then
    echo "matched";
else
    echo "no match";
fi 
```

祝你好运 ;）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-27T18:57:44.653

在指示点将其与您的版本进行比较：

```
variable="This script is not found"  # <--

if [[ "$variable" =~ "not found" ]]  # <--
then
    echo "Not Found"
else
    echo "Its there"
fi  # <-- 
```

您不能在赋值中的 = 周围放置空格，并且您需要引用包含空格的字符串文字。你不需要尾随 ; 如果你打算把 then 放在它自己的线上。if-then 以“fi”而不是“if”结尾。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T18:23:25.633

这是您的 if 语句的正确构造

```
if [[ "$variable" =~ "not found" ]]; then
      echo "Not Found";
else
      echo "Its there";
fi 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-03-31T09:33:23.737

我尝试过以下代码，它们总是以真或假返回相同的结果

```
if [[ "$variable" =~ "not found" ]]; then
      echo "Not Found";
else
      echo "Its there";
fi 
```

# python - 从三个 1D numpy 数组填充 2D numpy 数组

> ID：15118939
> 
> 赞同：8
> 
> 时间：2013-02-27T17:55:22.860
> 
> 标签：python, numpy

是否有一种有效的方法可以在不使用循环的情况下从未排序的坐标点（即并非所有的经纬度和/或纬度都升序或降序）创建值的二维数组？

**示例数据**

```
lats = np.array([45.5,45.5,45.5,65.3,65.3,65.3,43.2,43.2,43.2,65.3])
lons = np.array([102.5,5.5,116.2,102.5,5.5,116.2,102.5,5.5,116.2,100])
vals = np.array([3,4,5,6,7,7,9,1,0,4]) 
```

**示例输出**
每列代表一个唯一的经度（102.5、5.5、116.2 和 100），每列代表一个唯一的纬度（45.5、65.3 和 43.2）。

```
([ 3, 4, 5, NaN],
 [ 6, 7, 7, 4],
 [ 9, 1, 0, NaN]) 
```

不过，这并不是那么简单，因为我不一定知道每个 lon 或 lat 有多少个重复项，这决定了数组的形状。

**更新：**
我的问题的数据排列不正确。我现在已经安排好了，所以它们都是唯一的对，还有一个额外的数据点来演示当存在 NaN 时应该如何安排数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T19:40:46.320

您发布的示例几乎没有意义，并且不允许任何合理的方式来指定丢失的数据。我在这里猜测，但您可能正在处理的唯一合理的事情似乎是这样的：

```
>>> lats = np.array([43.2, 43.2, 43.2, 45.5, 45.5, 45.5, 65.3, 65.3, 65.3])
>>> lons = np.array([5.5, 102.5, 116.2, 5.5, 102.5, 116.2, 5.5, 102.5, 116.2])
>>> vals = np.array([3, 4, 5, 6, 7, 7, 9, 1, 0]) 
```

其中 in 的值`vals[j]`来自 latitude`lats[j]`和 longitude `lons[j]`，但数据可能会被打乱，如：

```
>>> indices = np.arange(9)
>>> np.random.shuffle(indices)
>>> lats = lats[indices]
>>> lons = lons[indices]
>>> vals = vals[indices]
>>> lats
array([ 45.5,  43.2,  65.3,  45.5,  43.2,  65.3,  45.5,  65.3,  43.2])
>>> lons
array([   5.5,  116.2,  102.5,  116.2,    5.5,  116.2,  102.5,    5.5,  102.5])
>>> vals
array([6, 5, 1, 7, 3, 0, 7, 9, 4]) 
```

您可以将其排列成一个数组，如下所示：

```
>>> lat_vals, lat_idx = np.unique(lats, return_inverse=True)
>>> lon_vals, lon_idx = np.unique(lons, return_inverse=True)
>>> vals_array = np.empty(lat_vals.shape + lon_vals.shape)
>>> vals_array.fill(np.nan) # or whatever yor desired missing data flag is
>>> vals_array[lat_idx, lon_idx] = vals
>>> vals_array
array([[ 3.,  4.,  5.],
       [ 6.,  7.,  7.],
       [ 9.,  1.,  0.]]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T17:57:03.387

如果您正在创建一个二维数组，那么所有数组都必须具有相同数量的点。如果这是真的，你可以简单地做

```
out = np.vstack((lats, lons, vals)) 
```

* * *

### 编辑

我*认为*这可能是你所追求的，它至少符合你的问题:)

```
xsize = len(np.unique(lats))
ysize = len(np.unique(lons)) 
```

然后如果你的数据表现得很好

```
out = [vals[i] for i, (x, y) in enumerate(zip(lats, lons))]
out = np.asarray(out).reshape((xsize, ysize)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T18:36:39.700

```
import numpy as np

lats = np.array([45.5,45.5,45.5,65.3,65.3,65.3,43.2,43.2,43.2,65.3])
lons = np.array([102.5,5.5,116.2,102.5,5.5,116.2,102.5,5.5,116.2,100])
vals = np.array([3,4,5,6,7,7,9,1,0,4])

def unique_order(seq): 
    # http://www.peterbe.com/plog/uniqifiers-benchmark (Dave Kirby)
    # Order preserving
    seen = set()
    return [x for x in seq if x not in seen and not seen.add(x)]

unique_lats, idx_lats = np.unique(lats, return_inverse=True)
unique_lons, idx_lons = np.unique(lons, return_inverse=True)
perm_lats = np.argsort(unique_order(lats))
perm_lons = np.argsort(unique_order(lons))

result = np.empty((len(unique_lats), len(unique_lons)))
result.fill(np.nan)
result[perm_lats[idx_lats], perm_lons[idx_lons]] = vals
print(result) 
```

yields

```
[[  3\.   4\.   5\.  nan]
 [  6\.   7\.   7\.   4.]
 [  9\.   1\.   0\.  nan]] 
```

# javascript - Web 浏览器与 RESTful API 交互是一种好习惯吗？

> ID：15118943
> 
> 赞同：4
> 
> 时间：2013-02-27T17:55:30.480
> 
> 标签：javascript, api, rest, coding-style, browser

我最近一直在使用几个 RESTful API 进行服务器到服务器的交互，现在我正在考虑在我的 Web 应用程序的 Web 浏览器中通过 javascript 直接与 RESTful API 通信。

这意味着在网页中使用 ajax 使用 GET、POST、PUT 和 DELETE 请求与我的 Web 服务器通信，并且服务器使用适当的 http 状态代码和非 html 数据（可能是 json）进行响应

这通常被认为是 Web 应用程序的良好做法吗？为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T18:00:12.223

从 ajax 的角度来看，您使用的是 RPC API 还是 RESTful API 并不重要，但通常，您可以将 RESTful API 视为一组组织良好、命名空间良好的远程过程调用。

> 这通常被认为是 Web 应用程序的良好做法吗？为什么？

这样做很有用，因为您无需复制代码即可跨多个数据对象进行常规 CRUD 操作。

另一件要考虑的事情是，如果你有一个统一的 API 调用命名约定，你可以编写 AJAX 函数来与之交互，那么随着时间的推移，你将在应用程序的 javascript 端编写和维护更少的代码，假设你不这样做您的代码中有任何奇怪的地方。

如果您编写了一个基本方法，该方法旨在根据您正在做什么和您所在的位置自动确定您的 AJAX url，并且它会`POST method`根据操作类型...然后您从字面上编写一个 ajax 函数，并将其应用于事物，而不是为每个操作项编写完全独立的 ajax 方法。

# php - Bootstrap - 加载驻留在其他页面中的模态并从模态提交表单

> ID：15118944
> 
> 赞同：1
> 
> 时间：2013-02-27T17:55:34.227
> 
> 标签：php, jquery, twitter-bootstrap

1.我有一个页面，点击按钮会弹出模式。我想做的是将所有模型移动到单独的页面。我试过这个

```
 $('#newSection').click(function(){
        $('#temp').load('adminmodels.php');
        $('#newSectionModal').modal('show');
    }); 
```

第一次单击时，没有任何反应。在随后的点击中，模式会自动出现并消失。请建议并更正我的代码。

2.我想从模态内部提交一个表单，然后在模态本身中显示响应。

```
 $(document).ready(function(){
        $('#user_button').click(function(e){
            e.preventDefault();
            $(this).attr('disabled',true);
            $.post('__admin_ajax.php',postString,function(response){
                $('#user-modal-body').html(response);
            });
        });
    }); 
```

为后续模态加载保留先前表单提交的响应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T06:09:14.523

我发现对于这种类型的逻辑，只使用 iframe 会更容易。

```
<div id="newSectionModal">
  <iframe id="modal_frame"/>
<div> 
```

然后在代码中。

```
$('#newSection').click(function(){
    $('#modal_frame').attr('src', 'adminmodels.php');
    $('#newSectionModal').modal('show');
}); 
```

因为它在一个框架中，所以您可以像在它自己的窗口中一样处理表单提交。任何时候都可以通过调用window.parent来触发父框架。例如：window.parent.trigger("form-submitted")

# c# - 为 Code First 创建插入/更新/删除触发器

> ID：15118945
> 
> 赞同：1
> 
> 时间：2013-02-27T17:55:36.377
> 
> 标签：c#, entity-framework, ef-code-first

我有一个问题，经过一番研究，我还没有找到答案。Code First 中是否有办法让实体创建插入/更新/删除触发器？目前我找不到任何东西，唯一无法解决的问题是在方法触发后使用代码执行任何工作（插入/更新/删除）的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:05:51.533

实体框架目前不支持在数据库本身上创建触发器，在不久的将来似乎也不支持（请参阅[此处](http://entityframework.codeplex.com/wikipage?title=Roadmap)为 EF 6 实现的内容）。

您唯一的解决方案是在插入/更新/删除完成后做任何您想做的事情，最好是在您的业务逻辑中（或者，如果您想像在[此博客中那样设置它，甚至更好，在您的存储库中）发布](http://sitecore.paragon-inc.com/resources/blogs-posts/the-repo-man)）。

# graphics - 如何自动将多个 .ai 文件转换为各种大小的 .png 文件？

> ID：15118948
> 
> 赞同：0
> 
> 时间：2013-02-27T17:55:45.893
> 
> 标签：graphics, automation, png, vector-graphics

我正在 Adob​​e Illustrator 中制作一副卡片。每张卡都保存为它自己的 .ai 文件，因此我可以稍后根据需要更改它。在 iOS 应用程序中使用这些图像时，我必须将所有内容都转换为 .png 文件。然后我必须重新调整这些 .png 文件的大小，使其具有视网膜和非视网膜版本。我希望有一种方法可以让我自动获取所有 .ai 文件的文件夹，并提供 200px x 400px 和 100 x 200px 的 .png。另外我希望较大的自动命名为@2xNameOfOrginalFile.png，其他的命名为nameOfOrginalFile.png。我看到了关于批处理自动化脚本的东西，它可以做类似的事情。我很好奇实现起来有多简单。我的建议可能吗？这是一个简单的过程吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:03:36.427

似乎很容易做到。有人发布了一个脚本，可以做你想做的事：[http ://forums.adobe.com/message/4915819](http://forums.adobe.com/message/4915819)

你必须改变这些行，

```
pngExportOpts.horizontalScale = 250.0;
pngExportOpts.verticalScale = 250.0; 
```

到计算值。比例是一个百分比（参见：[文档](http://cssdk.host.adobe.com/sdk/1.0/docs/WebHelp/references/csawlib/com/adobe/illustrator/ExportOptionsPNG24.html)）。您可以使用 sourceDoc.width 和 sourceDoc.height 来获取原始 .ai 文件的宽度和高度（以像素为单位？文档没有说）。

您还需要修改 getNewName 函数。

# restler - restler 3 api explorer 参数类型不正确

> ID：15118950
> 
> 赞同：0
> 
> 时间：2013-02-27T17:55:55.503
> 
> 标签：restler

首先感谢这个简单的工具！

我遇到了以下问题。在我的服务类中，我有一个看起来像这样的函数（部分）：

```
/**
 * get merkmale from device id
 *
 * one could get merkmale from given serial id by passing var id
 * to this function and will get back one to n results ORDER BY ORDNUNG ASC
 * in JSON format
 *
 * @url GET /:id/merkmale
 * @param int $id contains the device id
 * @throws 400 No value given for id
 * @return json
 *
 */
function getmerkmale ($id) {....} 
```

问题是，如果我调用 api explorer 并且 phpdocs 一切正常，但 @param 类型（int）总是显示为字符串值。如果我通过在字段中输入所需的值来尝试它，它会显示 $id 的值错误。我可以输入 int 或 string 都失败。如果我在浏览器中调用它一切正常。

我在 Safari/Firefox 上使用 Restler 3 和 apiExplorer。

希望有人能帮上忙。

谢谢英格

编辑：@Lucarest 我已经尝试了实际的 git 克隆，但没有成功

也许问题出在 index.html 中？

```
<?php
use Luracast\Restler\Restler;
require_once 'vendor/restler.php';
require_once 'database/config.php';
require_once 'database/DB.php';
require_once 'controller/Say.php';
require_once 'controller/Authors.php';
require_once 'controller/kunde/kunde.php';
require_once 'controller/device/device.php';
require_once 'controller/messprotokoll/messprotokoll.php';

$r = new Restler();
$r->addAPIClass('Luracast\Restler\Resources'); //this creates resources.json at API Root
$r->addAPIClass('Say');
$r->addAPIClass('Authors');
$r->addAPIClass('kunde');
$r->addAPIClass('device');
$r->addAPIClass('messprotokoll');
//... add more api model if needed
$r->handle(); 
```

我已将所有 APIClasses 放入子文件夹中。我没有通过将 url 作为第二个参数传递给 AddAPIClass 来让它工作，所以我需要需要的类。这可能是问题吗？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:16:15.460

当您添加命名空间类时，请`addAPIClass`确保您转义斜杠，如下所示

```
<?php
use Luracast\Restler\Restler;

require_once 'vendor/restler.php';
require_once 'database/config.php';
require_once 'database/DB.php';
require_once 'controller/Say.php';
require_once 'controller/Authors.php';
require_once 'controller/kunde/kunde.php';
require_once 'controller/device/device.php';
require_once 'controller/messprotokoll/messprotokoll.php';

$r = new Restler();
$r->addAPIClass('Luracast\\Restler\\Resources'); //note the double slash for escaping
$r->addAPIClass('Say');
$r->addAPIClass('Authors');
$r->addAPIClass('kunde');
$r->addAPIClass('device');
$r->addAPIClass('messprotokoll');
//... add more api model if needed
$r->handle(); 
```

如果您坚持使用 PSR-0，则每个课程都不需要 require_once

# sql - 复合索引、单索引和重复列索引

> ID：15118961
> 
> 赞同：1
> 
> 时间：2013-02-27T17:56:32.523
> 
> 标签：sql, sql-server, sql-server-2008, indexing, key

我有以下查询。 `DataStaging`是一个有 1000 万行的大表。

`Product i`一个较小的表有 1000 行。

我们需要使用 找到`product_id`并且桌子上`ref`有两个，所以必须加入表格两次。`ref (ref1,ref2)` `Product`

```
 UPDATE  dbo.DataStaging
    SET     ProductId = COALESCE(Ref1_Pid, Ref2_Pid, 0) 
    FROM    dbo.DataStaging s
            LEFT JOIN ( SELECT  id [Ref1_Pid] ,
                                Ref1
                        FROM    dbo.Product
                        WHERE   isActive = 1
                      ) p1 ON s.[Ref] = p1.Ref1
            LEFT JOIN ( SELECT  id [Ref2_Pid] ,
                                Ref2
                        FROM    dbo.Product
                        WHERE   IsActive = 1
                      ) p2 ON s.[Ref] = p1.Ref2

    WHERE   s.TypeId = 1
            AND s.StatusId = 2 
```

这是产品表 PK_Product 上的主键，我可以随意添加 Non_Clustered Index。

(1) 三个索引：NC_index on (IsActive), NC_Index on (Ref1), NC_Index on (Ref2)

(2) 两个复合索引：NC_Index on (IsActive, Ref1), NC_Index on (IsActive, Ref2)

(3) 一个复合索引：NC_Index on (IsActive, Ref1, Ref2)

对于 (1) 它使用主键 PK_Product 扫描表，而不是 NC 索引。

对于 (2)，它对每个索引使用 NC_index 扫描。

对于 (3) 它在同一索引上使用 NC_index 扫描，但行大小是 (2) 的两倍

结果，性能 (2) > (3) > (1)

我的问题是，

为什么 (1) 不扫描 NC 索引？

如果我创建像 (2) 或 (3) 这样的索引有什么缺点？

假设上面的查询是最繁重的过程`Product`，但是有数百个`stored procs`使用不同条件的`product`表的`select`语句。`where`即使上述查询的性能是（2）>（3），（2）仍然比（3）更好吗？

（暂时忽略 dataStaging 上的索引）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:28:56.203

(1) 将需要对 IsActive 上的索引和 Ref1/Ref2 上的索引进行索引连接，这被认为不太理想。

我会选择（2）的变体 - 两个过滤索引，包括：

```
create index IX_Product_Ref1 on Product (Ref1) include(id) where (IsActive = 1)
create index IX_Product_Ref2 on Product (Ref2) include(id) where (IsActive = 1) 
```

(3) 仅当您同时查询 IsActive、Ref1 和 Ref2 时才是一个好主意。

另外，你不能这样写你的查询吗？

```
UPDATE  dbo.DataStaging
    SET     ProductId = isnull(p.id, p2.id) 
FROM    dbo.DataStaging s
LEFT JOIN dbo.Product p ON s.[Ref] = p.Ref1 and p.IsActive = 1
LEFT JOIN dbo.Product p2 ON s.[Ref] = p2.Ref2 and p2.IsActive = 1
WHERE s.TypeId = 1
AND s.StatusId = 2 
```

# tcl - ns-2 中 video.dat 中的文件大小错误

> ID：15118966
> 
> 赞同：1
> 
> 时间：2013-02-27T17:56:41.853
> 
> 标签：tcl, binaryfiles, ns2

我正在使用一个 tcl 脚本，它获取电影文件跟踪并将其转换为二进制文件，由 ns-2 中的应用程序代理进一步使用。这是将电影文件跟踪转换为二进制文件的脚本的代码片段：

```
set original_file_name Verbose_Silence_of_the_Lambs_VBR_H263.dat
set trace_file_name video.dat
set original_file_id [open $original_file_name r]
set trace_file_id [open $trace_file_name w]
set last_time 0
while {[eof $original_file_id] == 0} {
    gets $original_file_id current_line
    if {[string length $current_line] == 0 ||
    [string compare [string index $current_line 0] "#"] == 0} {
       continue  
    }

    scan $current_line "%d%s%d" next_time type length
    set time [expr 1000*($next_time-$last_time)]
    set last_time $next_time
    puts -nonewline $trace_file_id [binary format "II" $time $length]
}
close $original_file_id
close $trace_file_id 
```

但是当我进一步使用这个创建的 video.dat 文件来生成应用程序代理使用的流量时，我得到了以下错误：

```
Bad file siz in video.dat
Segmenatation fault 
```

请对此有所收获。代码中二进制格式“II”的含义是什么。因为我没有在 tcl-binary(n) 文档中找到它，或者它已经过时并且现在不受支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T18:38:24.957

问题可能是您没有以二进制模式打开文件。

改变

```
set trace_file_id [open $trace_file_name w] 
```

至

```
set trace_file_id [open $trace_file_name wb] 
```

否则 Tcl 将改变输出，例如`\n`用`\r\n`on windows 替换。（对于大于 127 的字节值，它将被视为 unicode 代码点，然后转换为您的系统编码，从而弄乱您的整个二进制文件）虽然这样的事情对于文本文件来说很好，但它会产生二进制文件的问题。

幸运的是，只需要一个字符来解决这个问题：`b`作为修饰符`open`

**编辑**：我刚刚在Tcl的[更改列表中](http://wiki.tcl.tk/10630)`b`查找，打开的修饰符是在 8.5 中添加的。我一般只用8.5或者8.6，所以如果你用的是老版本的Tcl，在open之后加上下面一行：

```
fconfigure $trace_file_id -translation binary 
```

`b`修饰符只是一个捷径。

# c# - 查询即将到来的生日

> ID：15118968
> 
> 赞同：4
> 
> 时间：2013-02-27T17:56:43.130
> 
> 标签：c#, linq, entity-framework-5

我想向我的客户查询那些生日还没到的客户。

我试过这个查询，它 - 当然 - 失败了：

```
Addresses.Where(adr => adr.DateOfBirth != null && adr.DateOfBirth.Value >
DateTime.Now).Take(15).ToList(); 
```

当然这不能正常工作（如果你出生在未来就不行），我想知道如何在`Nullable<DateTime>`没有一年的情况下查询我的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-27T18:53:10.370

您可以像这样在一行中执行此操作：

```
context.Addresses.Where(adr => adr.DateOfBirth != null).OrderBy(adr => EntityFunctions.DiffDays(DateTime.Today, EntityFunctions.AddYears(adr.DateOfBirth, EntityFunctions.DiffYears(adr.DateOfBirth, DateTime.Today) + ((adr.DateOfBirth.Month < DateTime.Today.Month || (adr.DateOfBirth.Day <= DateTime.Today.Day && adr.DateOfBirth.Month == DateTime.Today.Month)) ? 1 : 0)))).Take(15).ToList(); 
```

或者以更易读的格式：

```
var query = from adr in context.Addresses
            where adr.DateOfBirth != null
            let diffYears = EntityFunctions.DiffYears(adr.DateOfBirth, DateTime.Today)
            let birthdayOccurred = adr.DateOfBirth.Month < DateTime.Today.Month || (adr.DateOfBirth.Day <= DateTime.Today.Day && adr.DateOfBirth.Month == DateTime.Today.Month)
            let nextBirthdate = EntityFunctions.AddYears(adr.DateOfBirth, diffYears + (birthdayOccurred ? 1 : 0))
            let daysToBirthdate = EntityFunctions.DiffDays(DateTime.Today, nextBirthdate)
            orderby daysToBirthdate
            select adr;

var result = query.Take(15).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:23:54.750

我不确定您是否可以将其作为单线来执行。当然没有任何程度的清晰度。

所需的步骤是：

1.  创建一个仅包含今天之后的月/日的生日的有序列表。
2.  创建一个仅包含今天之前的月/日的生日的有序列表。
3.  将第二个列表附加到第一个列表，您现在有一个列表，按生日顺序排序。
4.  拿前15个。

我认为 C# 代码看起来像这样（您可能需要添加一个或两个列表。）

```
var list1 = Addresses.Where(adr => adr.DateOfBirth != null && (adr.DateOfBirth.Value.Month > DateTime.Today.Month || (adr.DateOfBirth.Value.Month == DateTime.Today.Month && adr.DateOfBirth.Value.Day >= DateTime.Today.Day))).ToList();
var list2 = Addresses.Where(adr => adr.DateOfBirth != null && (adr.DateOfBirth.Value.Month < DateTime.Today.Month || (adr.DateOfBirth.Value.Month == DateTime.Today.Month && adr.DateOfBirth.Value.Day < DateTime.Today.Day))).ToList();
var fullList = list1.Add(list2); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:10:42.207

尝试这样的事情；（这是有效的 - 我已经测试过）

```
//A mock up value for comparison (as DayOfYear not supported in Linq)
int doy = DateTime.Today.Month * 31 + DateTime.Today.Day;

var results = Addresses.Where(a => a.DateOfBirth != null)
             .OrderBy( a => 
             (a.DateOfBirth.Value.Month * 31 + a.DateOfBirth.Value.Day) +
  (a.DateOfBirth.Value.Month * 31 + a.DateOfBirth.Value.Day > doy ? 0 : 400 ))
             .Take(15).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T18:10:54.457

我不熟悉 Linq，我会尝试帮助一些伪代码。

最重要的条件应该如下所示：

```
Date(CurrentDate.Year, DateOfBirth.Month, DateOfBirth.Day) >= CurrentDate 
|| ' OR
Date(CurrentDate.Year + 1, DateOfBirth.Month, DateOfBirth.Day) >= CurrentDate 
```

这也将在 12 月 31 日生效。

选择：

```
// consider this as pseudocode, I didnt tested that in C#

function GetNextBirthday(DateTime DateOfBirth)
{
int yearOfNextBirthday;

int birthdayMMDD = DateOfBirth.Month*100 + DateOfBirth.Day;
int todayMMDD = CurrentDate.Month*100 + CurrentDate.Day;

    if (birthdayMMDD >= todayMMDD)
    {
        yearOfNextBirthday = CurrentDate.Year; // this year
    }
    else
    {
        yearOfNextBirthday = CurrentDate.Year + 1; // next year
    }

DateTime nextBirthday; 

// you have to write this line yourself, i dont remember how to make date from Y, M, D
nextBirthday = DateFromYMD(yearOfNextBirthday, DateOfBirth.Month, DateOfBirth.Day);

return nextBirthday;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T18:58:04.393

这是我对“一个班轮”的条目：

```
DateTime now = DateTime.Now;
var next15 =
    from a in db.Addresses
    where a.DateOfBirth != null
    let diff = EntityFunctions.DiffSeconds(
        EntityFunctions.AddYears(now, -EntityFunctions.DiffYears(a.DateOfBirth, now)),
        a.DateOfBirth)
    orderby diff >= 0 ? diff : diff + 366*24*60*60
    select new a;

var res = next15.Take(15).ToList(); 
```

刚刚用 SQL 数据库测试过——它就像魅力一样工作；）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-09T17:52:29.503

这是与@Aducci 相同的解决方案，但具有可为空的日期和 DBFunctions，因为 EntityFunctions 已被弃用。

```
 pacientes = from paciente in pacientes
                where paciente.Nascimento != null
                let diffYears = DbFunctions.DiffYears(paciente.Nascimento, DateTime.Today)
                let birthdayOccurred = paciente.Nascimento.Value.Month < DateTime.Today.Month 
                || (paciente.Nascimento.Value.Day <= DateTime.Today.Day && paciente.Nascimento.Value.Month == DateTime.Today.Month)
                let nextBirthdate = DbFunctions.AddYears(paciente.Nascimento, diffYears + (birthdayOccurred ? 1 : 0))
                let daysToBirthdate = DbFunctions.DiffDays(DateTime.Today, nextBirthdate)
                orderby daysToBirthdate
                select paciente; 
```

# sql - 在视图或表值函数中查看结果

> ID：15118969
> 
> 赞同：1
> 
> 时间：2013-02-27T17:56:45.397
> 
> 标签：sql

我有一个查询，它比较两个请求并根据比较选择查询中返回的每一列显示是/否。我如何更改它以能够在视图或表值函数中检索相同的结果。当我使用 SQL 创建存储过程但我们的业务对象应用程序无法执行 SQL 时，我得到了结果

下面是我的 SQL

```
DECLARE @Foo TABLE (requestid int,
receiveddate datetime,
neededby datetime,busneed varchar(1000) ,
rptcomments varchar(1000),
reportfrequency varchar(100),
defineschedule varchar(250),
schedulebasedon varchar(250) ,
clmsrvdtfrom datetime,
clmsrvdtthru datetime ,
clmpddtfrom datetime,
clmpddtthru datetime
)

INSERT @Foo (requestid,receiveddate,neededby,busneed,rptcomments,reportfrequency,defineschedule,schedulebasedon,clmsrvdtfrom,clmsrvdtthru,clmpddtfrom,clmpddtthru)
select requestid,receiveddate,neededby,busneed,rptcomments,reportfrequency,defineschedule,schedulebasedon,clmsrvdtfrom,clmsrvdtthru,clmpddtfrom,clmpddtthru
from report_request where requestid = 1494
INSERT @Foo (requestid,receiveddate,neededby,busneed,rptcomments,reportfrequency,defineschedule,schedulebasedon,clmsrvdtfrom,clmsrvdtthru,clmpddtfrom,clmpddtthru)
select requestid,receiveddate,neededby,busneed,rptcomments,reportfrequency,defineschedule,schedulebasedon,clmsrvdtfrom,clmsrvdtthru,clmpddtfrom,clmpddtthru
from report_request where requestid = 1495

SELECT CAST(requestid AS VARCHAR(MAX)) requestid,
CAST(receiveddate AS VARCHAR(MAX)) AS receiveddate,
CAST(neededby AS VARCHAR(MAX)) AS neededby,
CAST(busneed AS VARCHAR(MAX)) AS busneed,
CAST(rptcomments AS VARCHAR(MAX)) AS rptcomments,
CAST(reportfrequency AS VARCHAR(MAX)) AS reportfrequency,
CAST(defineschedule AS VARCHAR(MAX)) AS defineschedule,
CAST(schedulebasedon AS VARCHAR(MAX)) AS schedulebasedon,
CAST(clmsrvdtfrom AS VARCHAR(MAX)) AS clmsrvdtfrom,
CAST(clmsrvdtthru AS VARCHAR(MAX)) AS clmsrvdtthru,
CAST(clmpddtfrom AS VARCHAR(MAX)) AS clmpddtfrom,
CAST(clmpddtthru AS VARCHAR(MAX)) AS clmpddtthru
from Customer_REQUEST where requestid = 1494

UNION ALL
SELECT CAST(requestid AS VARCHAR(MAX)) requestid,
CAST(receiveddate AS VARCHAR(MAX)) AS receiveddate,
CAST(neededby AS VARCHAR(MAX)) AS neededby,
CAST(busneed AS VARCHAR(MAX)) AS busneed,
CAST(rptcomments AS VARCHAR(MAX)) AS rptcomments,
CAST(reportfrequency AS VARCHAR(MAX)) AS reportfrequency,
CAST(defineschedule AS VARCHAR(MAX)) AS defineschedule,
CAST(schedulebasedon AS VARCHAR(MAX)) AS schedulebasedon,
CAST(clmsrvdtfrom AS VARCHAR(MAX)) AS clmsrvdtfrom,
CAST(clmsrvdtthru AS VARCHAR(MAX)) AS clmsrvdtthru,
CAST(clmpddtfrom AS VARCHAR(MAX)) AS clmpddtfrom,
CAST(clmpddtthru AS VARCHAR(MAX)) AS clmpddtthru
from CUSTOMER_REQUEST where requestid = 1495

UNION ALL

SELECT 
    CASE WHEN A.requestid = B.requestid THEN 'Yes' ELSE 'No'  END as requestid,
    CASE WHEN A.receiveddate = B.receiveddate THEN 'Yes' ELSE 'No' END as receiveddate,
    CASE WHEN A.neededby = B.neededby THEN 'Yes' ELSE 'No' END neededby,
    CASE WHEN A.busneed = B.busneed THEN 'Yes' ELSE 'No' END busneed,
    CASE WHEN A.rptcomments = B.rptcomments THEN 'Yes' ELSE 'No' END rptcomments,
    CASE WHEN A.reportfrequency = B.reportfrequency THEN 'Yes' ELSE 'No' END as reportfrequency,
    CASE WHEN A.defineschedule = B.defineschedule THEN 'Yes' ELSE 'No' END as defineschedule,
    CASE WHEN A.schedulebasedon = B.schedulebasedon THEN 'Yes' ELSE 'No' END as schedulebasedon,
    CASE WHEN A.clmsrvdtfrom = B.clmsrvdtfrom THEN 'Yes' ELSE 'No' END as clmsrvdtfrom,
    CASE WHEN A.clmsrvdtthru = B.clmsrvdtthru THEN 'Yes' ELSE 'No' END as clmsrvdtthru,
    CASE WHEN A.clmpddtfrom = B.clmpddtfrom THEN 'Yes' ELSE 'No' END as clmpddtfrom,
    CASE WHEN A.clmpddtthru = B.clmpddtthru THEN 'Yes' ELSE 'No' END as clmpddtthru

FROM
    (SELECT * FROM @Foo WHERE requestid = 1494) AS A
INNER JOIN
    (SELECT * FROM @Foo WHERE requestid = 1495) AS B

ON 1 = 1 
```

需要帮助请

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T01:22:53.500

那这个呢：

```
CREATE VIEW _test
AS
SELECT CAST(requestid AS VARCHAR(MAX)) requestid,
CAST(receiveddate AS VARCHAR(MAX)) AS receiveddate,
CAST(neededby AS VARCHAR(MAX)) AS neededby,
CAST(busneed AS VARCHAR(MAX)) AS busneed,
CAST(rptcomments AS VARCHAR(MAX)) AS rptcomments,
CAST(reportfrequency AS VARCHAR(MAX)) AS reportfrequency,
CAST(defineschedule AS VARCHAR(MAX)) AS defineschedule,
CAST(schedulebasedon AS VARCHAR(MAX)) AS schedulebasedon,
CAST(clmsrvdtfrom AS VARCHAR(MAX)) AS clmsrvdtfrom,
CAST(clmsrvdtthru AS VARCHAR(MAX)) AS clmsrvdtthru,
CAST(clmpddtfrom AS VARCHAR(MAX)) AS clmpddtfrom,
CAST(clmpddtthru AS VARCHAR(MAX)) AS clmpddtthru
from Customer_REQUEST where requestid = 1494

UNION ALL
SELECT CAST(requestid AS VARCHAR(MAX)) requestid,
CAST(receiveddate AS VARCHAR(MAX)) AS receiveddate,
CAST(neededby AS VARCHAR(MAX)) AS neededby,
CAST(busneed AS VARCHAR(MAX)) AS busneed,
CAST(rptcomments AS VARCHAR(MAX)) AS rptcomments,
CAST(reportfrequency AS VARCHAR(MAX)) AS reportfrequency,
CAST(defineschedule AS VARCHAR(MAX)) AS defineschedule,
CAST(schedulebasedon AS VARCHAR(MAX)) AS schedulebasedon,
CAST(clmsrvdtfrom AS VARCHAR(MAX)) AS clmsrvdtfrom,
CAST(clmsrvdtthru AS VARCHAR(MAX)) AS clmsrvdtthru,
CAST(clmpddtfrom AS VARCHAR(MAX)) AS clmpddtfrom,
CAST(clmpddtthru AS VARCHAR(MAX)) AS clmpddtthru
from CUSTOMER_REQUEST where requestid = 1495

UNION ALL

SELECT 
    CASE WHEN A.requestid = B.requestid THEN 'Yes' ELSE 'No'  END as requestid,
    CASE WHEN A.receiveddate = B.receiveddate THEN 'Yes' ELSE 'No' END as receiveddate,
    CASE WHEN A.neededby = B.neededby THEN 'Yes' ELSE 'No' END neededby,
    CASE WHEN A.busneed = B.busneed THEN 'Yes' ELSE 'No' END busneed,
    CASE WHEN A.rptcomments = B.rptcomments THEN 'Yes' ELSE 'No' END rptcomments,
    CASE WHEN A.reportfrequency = B.reportfrequency THEN 'Yes' ELSE 'No' END as reportfrequency,
    CASE WHEN A.defineschedule = B.defineschedule THEN 'Yes' ELSE 'No' END as defineschedule,
    CASE WHEN A.schedulebasedon = B.schedulebasedon THEN 'Yes' ELSE 'No' END as schedulebasedon,
    CASE WHEN A.clmsrvdtfrom = B.clmsrvdtfrom THEN 'Yes' ELSE 'No' END as clmsrvdtfrom,
    CASE WHEN A.clmsrvdtthru = B.clmsrvdtthru THEN 'Yes' ELSE 'No' END as clmsrvdtthru,
    CASE WHEN A.clmpddtfrom = B.clmpddtfrom THEN 'Yes' ELSE 'No' END as clmpddtfrom,
    CASE WHEN A.clmpddtthru = B.clmpddtthru THEN 'Yes' ELSE 'No' END as clmpddtthru

FROM
    (select requestid,receiveddate,neededby,busneed,rptcomments,reportfrequency,defineschedule,schedulebasedon,clmsrvdtfrom,clmsrvdtthru,clmpddtfrom,clmpddtthru
from report_request where requestid = 1494) AS A
INNER JOIN
    (select requestid,receiveddate,neededby,busneed,rptcomments,reportfrequency,defineschedule,schedulebasedon,clmsrvdtfrom,clmsrvdtthru,clmpddtfrom,clmpddtthru
from report_request where requestid = 1495) AS B
ON 1 = 1 
```

# ruby - 使用 nokogiri 通过 open() 解析 html GET - 重定向异常

> ID：15118974
> 
> 赞同：0
> 
> 时间：2013-02-27T17:56:57.297
> 
> 标签：ruby, parsing, nokogiri

我正在尝试学习 ruby​​，所以我正在关注 google dev 的练习。我正在尝试解析一些链接。在成功重定向的情况下（考虑到我知道它只能被重定向一次），我被禁止重定向。我注意到我从 http 协议链接转到 https 协议链接。任何具体的想法我怎么能在 ruby​​ 中实现这个，因为谷歌的练习是针对 python 的？

错误：

```
ruby fix.rb
redirection forbidden: http://code.google.com/edu/languages/google-python-class/images/puzzle/p-bija-baei.jpg -> https://developers.google.com/edu/python/images/puzzle/p-bija-baei.jpg?csw=1 
```

应该实现我正在寻找的代码：

```
def acquireData(urls, imgs) #List item urls list of valid urls !checked, imgs list of the imgs I'll download afterwards.
  begin
    urls.each do |url|
      page = Nokogiri::HTML(open(url))
      puts page.body
    end
  rescue Exception => e
    puts e
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T18:55:04.357

Ruby 的[OpenURI](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/open-uri/rdoc/OpenURI.html)会自动为您处理重定向，只要它们不是发生在 HTML 内部的“[元刷新”。](http://en.wikipedia.org/wiki/Meta_refresh)

例如，这会自动遵循重定向：

```
irb(main):008:0> page = open('http://www.example.org')
#<StringIO:0x00000002ae2de0>
irb(main):009:0> page.base_uri.to_s
"http://www.iana.org/domains/example" 
```

换句话说，对“www.example.org”的请求被重定向到“www.iana.org”，OpenURI 正确地跟踪了它。

如果您正在尝试学习如何处理重定向，请阅读[Net::HTTP](http://ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTP.html)文档。以下是如何从文档中执行此操作的示例：

> 跟随重定向
> 
> 每个 Net::HTTPResponse 对象都属于其响应代码的一个类。
> 
> 例如，所有 2XX 响应都是 Net::HTTPSuccess 子类的实例，3XX 响应是 Net::HTTPRedirection 子类的实例，而 200 响应是 Net::HTTPOK 类的实例。有关响应类的详细信息，请参阅下面的“HTTP 响应类”部分。
> 
> 使用 case 语句，您可以正确处理各种类型的响应：

```
def fetch(uri_str, limit = 10)
  # 你应该选择一个更好的例外。
  引发 ArgumentError, 'too many HTTP redirects' if limit == 0

  response = Net::HTTP.get_response(URI(uri_str))

  个案回应
  当 Net::HTTPS 成功时
    回复
  当 Net::HTTPRedirection 然后
    位置=响应['位置']
    警告“重定向到 #{location}”
    获取（位置，限制 - 1）
  别的
    响应值
  结尾
结尾

print fetch('http://www.ruby-lang.org')

```

如果要处理元刷新语句，请考虑以下内容：

```
require 'nokogiri'

doc = Nokogiri::HTML(%[<meta http-equiv="refresh" content="5;URL='http://example.com/'">])
meta_refresh = doc.at('meta[http-equiv="refresh"]')
if meta_refresh
  puts meta_refresh['content'][/URL=(.+)/, 1].gsub(/['"]/, '')
end 
```

哪个输出：

```
http://example.com/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T19:00:13.437

基本上，您尝试打开的 code.google 中的 url 重定向到 https url。`http://code.google.com/edu/languages/google-python-class/images/puzzle/p-bija-baei.jpg`如果您粘贴到浏览器中，您可以自己查看

检查以下[错误报告](http://bugs.ruby-lang.org/issues/859)，该报告解释了为什么 open-uri 无法重定向到 https；

So the solution to your problem is simply: use a different set of urls (that don't redirect to https)

# html - 防止在 HTML 中删除“/”

> ID：15118981
> 
> 赞同：0
> 
> 时间：2013-02-27T17:57:08.797
> 
> 标签：html

当我使用下面的代码块进行测试时，我将最初的 HTML`<xsl:key name="Name" match="/NewSet/ps1/Name/text()" use="." />`写入第一个框中，我从第三个框中得到结果，名称为“IFRAME 的 HTML 模式”，例如`<xsl:key name="Name" match="/NewSet/ps1/Name/text()" use="." ></xsl:key>`

结果是没有`/` 标签，我该如何防止这个问题。

我认为这是关于浏览器的文本引擎？不是吗？

```
<html>
<head>
    <title>Editable IFRAME test</title>
</head>
<body onload="SetEditable()">
    <b>Set your original HTML content here:</b><br />
    <textarea id="htmlArea" style="width: 783px; height: 189px"></textarea>
    <br />
    <input type="button" onclick="CreateHtml();return false;" value="Set Content in the IFRAME">
    <br />
    <b>Editable IFRAME element:</b>
    <br />
    <div style="width: 800px; height: 600px; border: 1px solid red;">
        <iframe style="padding-bottom: 0px; margin: 0px; padding-left: 0px; width: 100%;
            padding-right: 0px; height: 100%; padding-top: 0px" frameborder="0" src="javascript:void(0)"
            id="editor"></iframe>
    </div>
    <input type="button" onclick="ShowIFRAMEHTML();return false;" value="Show IFRAME HTML">
    <br />
    <b>HTML Mode of the IFRAME:</b>
    <br />
    <textarea id="htmlMode" style="width: 783px; height: 313px"></textarea>
    <script type="text/javascript">
        var editor1 = document.getElementById("editor"); //reference to the IFRAME element
        var htmlArea1 = document.getElementById("htmlArea"); //reference to the HTML area in which we put the content
        var htmlMode = document.getElementById("htmlMode"); //reference to the HTML area that displays the IFRAME content
        var oDocument = editor1.contentWindow.document;

        var sMarkup = "<html><head><title>New Document</title></head>" +
                  "<body contenteditable=true style='overflow:scroll;margin:0px;padding:0px;height:100%'>" +
                  "&nbsp;</body></html>";

        function SetEditable() {
            oDocument.open();
            oDocument.write(sMarkup);
            oDocument.close();
            oDocument["designMode"] = "on";
            oDocument.execCommand("2D-Position", false, true);
        }
        function CreateHtml() {
            oDocument.body.innerHTML = htmlArea1.value;
            htmlMode.value = oDocument.body.innerHTML;
        }
        function ShowIFRAMEHTML() {
            alert(oDocument.body.innerHTML);
        }

    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:05:54.963

不，这是关于如何`innerHTML`创造价值的。

您将 HTML 代码放在 iframe 中，这会使其将其解析为元素。然后您将这些元素作为 HTML 获取，这将从 elemtns 创建新的 HTML 代码，而不是返回用于创建元素的原始字符串。

如果您在不同的浏览器中对此进行测试，您将看到得到不同的结果。例如，某些浏览器可能会将标签名称大写，重新排列属性，甚至将元素转换为一些有效的 HTML 元素或用 HTML 元素包围它以使其成为有效的文档。

如果要将结果作为自闭合标签，则需要在 iframe 中放置一个 XHTML 文档（或者可能是 HTML5 文档），否则它将作为没有任何自闭合标签的 HTML 返回。

# c# - 异常阻止检测多个 XML 验证错误

> ID：15118989
> 
> 赞同：3
> 
> 时间：2013-02-27T17:57:33.413
> 
> 标签：c#, xml, xsd

我正在使用以下代码来验证使用 XSD 架构文件的 XML 文件。

它基本上有效。但是，当我尝试构建任何验证错误的列表时，我发现发生的任何验证错误都会引发异常，导致无法检测到进一步的验证错误。

我实际上是在[LINQPad](http://www.linqpad.net/)中运行它。谁能看到我错过了什么？

```
var settings = new XmlReaderSettings
{
    ValidationType = ValidationType.Schema,
    ValidationFlags = XmlSchemaValidationFlags.ReportValidationWarnings
};

List<ValidationEventArgs> validationErrorsAndWarnings = new List<ValidationEventArgs>();
settings.ValidationEventHandler += (sender, eventArgs) => validationErrorsAndWarnings.Add(eventArgs);
settings.Schemas.Add(
    targetNamespace: DataFeedXmlns,
    schemaDocument: XmlReader.Create(new StringReader(DataFeedXsd)));

using (var xmlReader = XmlReader.Create(new StringReader(DataFeedXml), settings)) {
    while (xmlReader.Read())
        ;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:49:46.383

我认为这是您的期望不正确（代码看起来不错）。这就是我的意思：考虑下面的 XSD：

```
<?xml version="1.0" encoding="utf-8" ?>
<!-- XML Schema generated by QTAssistant/XSD Module (http://www.paschidev.com) -->
<xsd:schema targetNamespace="http://tempuri.org/XMLSchema.xsd" xmlns="http://tempuri.org/XMLSchema.xsd" elementFormDefault="qualified" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <xsd:element name="root">
        <xsd:complexType>
            <xsd:sequence>
                <xsd:element name="tryme" minOccurs="0" maxOccurs="unbounded">
                    <xsd:simpleType>
                        <xsd:restriction base="xsd:string">
                            <xsd:pattern value="[a-z]+"/>
                        </xsd:restriction>
                    </xsd:simpleType>
                </xsd:element>
                <xsd:element name="really">
                    <xsd:complexType>
                        <xsd:sequence>
                            <xsd:element name="wrong"/>
                            <xsd:element name="stillwrong">
                                <xsd:simpleType>
                                    <xsd:restriction base="xsd:int"/>
                                </xsd:simpleType>
                            </xsd:element>
                        </xsd:sequence>
                    </xsd:complexType>
                </xsd:element>
            </xsd:sequence>
            <xsd:attribute name="version" fixed="1"/>
        </xsd:complexType>
    </xsd:element>
</xsd:schema> 
```

这个示例 XML：

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<!-- Sample XML generated by QTAssistant (http://www.paschidev.com) -->
<root xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1" xmlns="http://tempuri.org/XMLSchema.xsd">
    <tryme>tryme1</tryme>
    <tryme>tryme1</tryme>
    <really>
        <wrong/>
        <stillwrong>a</stillwrong>
    </really>
</root> 
```

您的代码应该报告三个错误：

```
Error occurred while loading [], line 4 position 17
The 'http://tempuri.org/XMLSchema.xsd:tryme' element is invalid - The value 'tryme1' is invalid according to its datatype 'String' - The Pattern constraint failed.
Error occurred while loading [], line 5 position 17
The 'http://tempuri.org/XMLSchema.xsd:tryme' element is invalid - The value 'tryme1' is invalid according to its datatype 'String' - The Pattern constraint failed.
Error occurred while loading [], line 8 position 18
The 'http://tempuri.org/XMLSchema.xsd:stillwrong' element is invalid - The value 'a' is invalid according to its datatype 'Int' - The string 'a' is not a valid Int32 value.
Document1.xml is XSD 1.0 invalid. 
```

但是，如果您`&lt;wrong/>`从样本中删除元素，即：

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<!-- Sample XML generated by QTAssistant (http://www.paschidev.com) -->
<root xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1" xmlns="http://tempuri.org/XMLSchema.xsd">
    <tryme>tryme1</tryme>
    <tryme>tryme1</tryme>
    <really>
        <stillwrong>a</stillwrong>
    </really>
</root> 
```

您（最）可能会遇到的错误现在是：

```
Error occurred while loading [], line 4 position 17
The 'http://tempuri.org/XMLSchema.xsd:tryme' element is invalid - The value 'tryme1' is invalid according to its datatype 'String' - The Pattern constraint failed.
Error occurred while loading [], line 5 position 17
The 'http://tempuri.org/XMLSchema.xsd:tryme' element is invalid - The value 'tryme1' is invalid according to its datatype 'String' - The Pattern constraint failed.
Error occurred while loading [], line 7 position 4
The element 'really' in namespace 'http://tempuri.org/XMLSchema.xsd' has invalid child element 'stillwrong' in namespace 'http://tempuri.org/XMLSchema.xsd'. List of possible elements expected: 'wrong' in namespace 'http://tempuri.org/XMLSchema.xsd'.
Document1.xml is XSD 1.0 invalid. 
```

虽然数量相同，但 .NET 验证器（至少是股票验证器）`&lt;stillwrong>`现在不会抱怨，因为它并不真正知道要匹配哪个 XSD 节点。

关键是可能有错误会导致验证者放弃做事，从而显示它好像跳过了一些人可能不希望做的事情。

如果对于我发布的场景，您的代码得到了列出的所有错误，那么您的代码就是它可以在带有内置验证器的 .NET 上的所有代码。如果您没有得到我列出的所有内容，那么我也错过了您的问题。

# c++ - 类型转换 malloc C++

> ID：15118990
> 
> 赞同：5
> 
> 时间：2013-02-27T17:57:37.610
> 
> 标签：c++, c, casting, malloc

我有一些带有 malloc 语句的 C 代码，我想与一些 C++ 代码合并。

我想知道何时以及为什么在 C++ 中需要对 malloc 的调用进行类型转换？

例如：

```
char *str = (char*)malloc(strlen(argv[1]) * sizeof(char)); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-27T18:00:04.407

> 何时以及为什么在 C++ 中需要对 malloc 的调用进行类型转换？

总是在不分配给 a 时`void *`，因为`void *`它不会像在 C 中那样隐式转换为其他指针类型。但真正的答案是**你不应该首先`malloc`在 C++**中使用。

* * *

我不是建议你应该使用`new`而不是`malloc`. 现代 C++ 代码应`new`谨慎使用，或尽可能避免使用。您应该隐藏所有使用`new`或使用非原始类型（如`std::vector`Xeo 提到的）。由于我的经验有限，我真的没有资格在这个方向上提供建议，但是[这篇文章](http://www.scs.stanford.edu/~dm/home/papers/c++-new.html)以及搜索“C++ 避免新”应该会有所帮助。然后你会想要调查：

*   [标准::分配器](http://en.cppreference.com/w/cpp/memory/allocator)
*   智能指针

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:22:52.437

编译你的 C 库。编译您的 C++ 库。让它们在使用它们的任何“主”程序中发挥出色。重点是，如果您维护混合代码库，您可能希望将纯 C 内容与 C++ 内容隔离开来。否则，您的 C 内容会变成仅看起来像 C 的 C++ 内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T18:02:44.530

首先，几乎在所有情况下都不要`malloc`在 C++ 程序中使用，而是更喜欢它，`new`因为它会确保在需要时调用构造函数等。

但是，如果出于遗留原因您试图避免尽可能多的重写 - 您将需要强制转换*任何* `malloc`未分配给`void*`指针的调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T18:11:10.220

如果您可以更改该代码，则可能更好地使用`new`它，所以它看起来像这样

`char* str = new char;`

这意味着您不需要像 C 方式那样进行任何强制转换，也不需要指定需要多大的内存。此外，如果这是一个像 a 这样的对象，`std::string`那么您在使用时不会调用构造函数`malloc`，这只会保留与指针一起使用的内存，`str`因此最好始终`new`与 C++ 一起使用，如果您也可以在回收内存时始终使用适当的方式，如果你`new`那么你`delete`，如果你`malloc`你`free`。如果您`free`在已被`new`'d 的内存上使用，那么您将不会调用该对象的析构函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T18:00:20.590

`malloc`总是返回 a`void*`所以你需要强制转换所有内容（因为 C++ 比 C 有更强的类型检查，并且不会自动进行）

当我使用 C 时，为了代码清晰，我也会转换所有内容。

此外，请随时`malloc()`在 C++ 中继续使用，这是有充分理由的。

通过将所有 C 代码重写`malloc()`为新代码来将所有 C 代码转换为 C++ 很容易在代码中引入大量错误，除非您有时间继续阅读要合并的代码以查找`malloc()`、`free()`、`calloc()`等的每个实例。 。 在上面。

只是不要混合`malloc()`或`delete`混合`new`或`free()`事情破裂。

# ruby - 在Ruby中的其他方法中传递带有参数的方法

> ID：15118992
> 
> 赞同：0
> 
> 时间：2013-02-27T17:57:42.670
> 
> 标签：ruby

我很有趣如何在 ruby​​ 中传递带有参数的方法。我需要用灵活的功能设置来实现类似命令模式的东西。示例 => C# 中的 lambda 函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:06:28.687

Ruby`lambda`函数定义如下：

```
 a.lambda{ puts "Hello"}
  a.call #=> Hello

  a = lambda{|str| puts str }
  a.call("Hello world !!!") #=> Hello world !!!

  a = lambda{|*args| puts args.join(' ')}
  a.call("Hello", "World") #=> Hello World 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T19:18:38.657

您可以像在 Ruby 中执行大多数操作一样执行命令模式：使用块。

```
class Soldier

  def initialize(&block)
    @command = block
  end
  def action
    @command.call if @command
  end

end

s = Soldier.new do #the block
  line = "We are drill machines, drill machines feel no pain"
  2.times{ puts line }
  puts line.upcase
end

puts "Action:"
s.action 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:06:37.670

您可以动态调用方法及其参数列表。以下只是其中一种方式

```
class Foo
  def foo(what)
    puts what
  end
end

Foo.new.send(:what, "something")  # ==> "something" 
```

# javascript - 带有缺少括号的函数调用的 JavaScript 语言扩展——它们可能吗？

> ID：15118994
> 
> 赞同：0
> 
> 时间：2013-02-27T17:57:47.447
> 
> 标签：javascript, extending, language-extension

是否有可能以任何方式做这样的事情：

```
function A() {
    var Loaded = 'loaded';
    raise Loaded;
}
function A_raise(evt) {
    console.log(evt);
}
A.prototype.constructor = A;
A.prototype.raise = A_raise; 
```

关键部分是这条线：

```
raise Loaded; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:59:51.193

在 JavaScript 中获得无括号函数调用的唯一方法是定义一个 setter/getter 属性，或覆盖其中一种特殊方法：`toString`或`valueOf`。在这两种情况下，您都无法很好地控制传递给调用的参数。

```
function C() {}
C.prototype.valueOf = function () { alert("valueOf called"); };
var c = new C();
// No parentheses
+c; 
```

您可以调用不带括号的构造函数，但同样不能传递参数。

```
function f() { alert("f"); }
// No parentheses
new f 
```

* * *

你不能的一个原因是分号插入。

```
f() 
```

是一个函数调用，原样

```
f
() 
```

和

```
if
(x) { } 
```

是一个有效的条件，因为`if`它是语言的核心部分，但如果你可以从函数调用中删除括号，那么分号插入将不得不像这样对待代码

```
var x = raise

y 
```

作为初始化为调用函数的结果的变量。

* * *

由于您询问了语言扩展，EcmaScript 规范的第 16 章说允许解释器添加到语言的语法中，

> 实现可以扩展程序语法和正则表达式模式或标志语法。为了允许这一点，所有允许抛出 SyntaxError 的操作（例如调用 eval、使用正则表达式文字或使用 Function 或 RegExp 构造函数）都被允许展示实现定义的行为，而不是在遇到实现时抛出 SyntaxError -程序语法或正则表达式模式或标志语法的定义扩展。

所以自从

```
 raise foo 
```

不是语言中的有效表达式或语句，他们可以允许，但他们不能以改变含义的方式这样做

```
 raise
 foo 
```

必须具有相同的含义

```
 raise;
 foo 
```

所以口译员将不得不做出`raise`一个新的[受限制的生产](http://es5.github.com/#x7.9.1)，这是由于措辞而有问题的：

> 以下是语法中唯一受限制的产生式：

这可能意味着不规范，但并非明确如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T18:02:47.547

你不能在 JavaScript 中定义新的语句，所以你实际上不能创建你在`A`.

**编辑**：从您对问题的评论中，很明显您正在寻找定义一个新的语句/关键字。不，你不能那样做。

* * *

**原始答案**：

您的目标是在`A`构造函数中*调用*该`A_raise`函数吗？如果是这样，你*真的很*接近。只是改变：

```
raise Loaded; 
```

至

```
this.raise(Loaded); 
```

[实例](http://jsbin.com/evuzab/1)| [资源](http://jsbin.com/evuzab/1/edit)

在通过`new`关键字对构造函数的调用中，`this`是新构造的对象，它已经从构造函数的`prototype`属性中接收了它的原型。So `this`will have `raise`on it (通过它的原型)，`raise`并将参考`A_raise`函数。

但同样，您需要括号（和`this.`）。

# wso2esb - wso2 carbon studio：在 ESB 中部署和使用自定义中介

> ID：15118998
> 
> 赞同：0
> 
> 时间：2013-02-27T17:57:54.527
> 
> 标签：wso2esb, mediator

**如何将自定义中介器部署到 ESB 并通过 UI 使用它**

我创建了一个自定义调解器，它是 JAR 文件。然后创建了一个碳应用程序项目并选择了一个自定义调解器工件，然后导出了它的 CAR 文件。

现在我不知道在哪里可以找到 CAR 文件，以便我可以在 ESB（管理控制台）中使用我的自定义中介。

另一个问题是，我如何通过 UI（在管理控制台中）使用我的中介相同的一流中介？

我使用 WSO2 developer studio 2.1.0 创建了调解器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T06:12:35.003

Q1。现在我不知道在哪里可以找到 CAR 文件以便我可以在 ESB（管理控制台）中使用我的自定义中介？

Ans: 如果您使用管理控制台部署 CAR 文件，那么您需要使用 ESB 管理控制台主选项卡上“碳应用程序”部分下的“添加”按钮。然后您将能够从中上传您的 CAR 文件，几分钟后您可以尝试创建一个使用该类调解器的代理服务。

如果您使用文件系统部署 CAR 文件，在 ESB 4.6.0 中，您需要将此 CAR 文件部署到`<ESB_HOME>/repository/carbonapps/0`文件夹。

Q2。如何通过 UI 使用我的调解员相同的一流调解员？

Ans：在 In sequence 或 out sequence 的代理服务创建中，您可以使用 Class mediator 并提供您使用 CAR 文件部署的 class mediator 的完全限定名称。您可以尝试使用那里的“加载类”按钮来查看到那个时候类中介器是否在服务器中实际可用。

希望这能回答您的疑问。

/哈莎娜

# java - 链表堆栈/泛型实现（作业）

> ID：15118999
> 
> 赞同：1
> 
> 时间：2013-02-27T17:57:57.237
> 
> 标签：java

我正在尝试使用堆栈和链接列表构建回文检查器。我使用泛型是为了重用节点和结构来完成这个任务的两个部分（在下一部分完成一些不同的事情）。

该程序没有将字母压入堆栈 - 它返回空值。我认为问题在于 push 方法的构造，无论是在 LinkedStack 构造中，还是在 StackDriver 实现中，或两者兼而有之。我只是不确定我做错了什么；我尝试了多种替代方法，并查找并尝试了其他方法来构建推送方法，但随后出现错误并且根本无法运行程序。（我意识到我在这里使用的 2 种推送方法是不同的——这是我尝试过的 2 个版本）。我应该为 char c 寻找某种类型的装箱来使用包装器类吗？

该程序已被设置回它运行的最后一点。“反转”的弹出元素似乎获得了正确数量的字符 - 为什么？

我意识到这个程序还有其他问题，但我觉得在我克服这个绊脚石之前我无法解决这些问题。任何帮助将不胜感激 - 谢谢！

麦克风

给定的接口：

```
public interface Stack<E> {
   void push(E data);
   E pop();
   boolean isEmpty();
   int size();
   E stackTop();
   void clear();
} 
```

节点和方法：

```
public class Node<E>  {

// create the node structure
    private E data;
    private Node<E> next;

    // getters and setters  
    public E getData() {
        return data;
    }
    public void setData(E data) {
        this.data = data;
    }
    public Node<E> getNext() {
        return next;
    }
    public void setNext(Node<E> next) {
        this.next = next;
    } 
```

}

堆栈：

```
import java.util.EmptyStackException;

public class LinkedStack<E> implements Stack<E>{

// Create the head and nodeCount variables
private Node<E> head;
private int nodeCount;

// also need to be able to convert letters to capitals.

// constructor for the LinkedStack
public LinkedStack()
{
    clear();
}

// A method to push the data onto a stack and increment the node count
public void push(E data) {
    head = new Node<E>();
    nodeCount++;
    }

// pop the head off of the stack and decrement the node count
public E pop() {
    E item;

    if (head == null)
        throw new EmptyStackException();

    item = head.getData();
    head = head.getNext();
    nodeCount--;
    return item;
}

// Check if the stack is empty
public boolean isEmpty() {
    if (head == null);
    return true;
}

// check the size of the node
public int size() {
    return nodeCount;
}

// this is the peek method
public E stackTop() 
{
    if (head == null)
        throw new EmptyStackException();
    return head.getData();
}

// clear the Linked Stack
public void clear() {
    head = null;
    nodeCount = 0;
}

// convert to text
        public String toString() {
            String rtn = "";

            if (nodeCount == 0) {
                rtn += "<empty>";
            }
            else {
                Node<E> t = head;

                while (t != null){
                    /* return the node data on a line with the head node data
                     at the beginning of the line and the arrow pointing to 
                     each successive node*/
                    rtn += t.getData() + "->";
                    // go on to the next
                    t = t.getNext();
                }
            rtn += "null";
            }
            return rtn;

        }

        } 
```

还有司机：

```
import java.util.Iterator;
import java.util.Scanner;

public class StackDriver<E> implements Iterator<E>{

/**
 * @param args
 */
public static void main(String[] args) {

//Initialize the driver
StackDriver run = new StackDriver();
run.doIt();

}
public void doIt() {

    // gather the input
    Scanner keyboard = new Scanner(System.in);
    System.out.println("Please enter a phrase. This program will verify" +
            " if the phrase is a palindrome.");

    // holder for the phrase
    String phrase;

    // holder for the reversed phrase
    String reversed = "";

    phrase = keyboard.nextLine().toUpperCase();
    System.out.println("You entered: "+ phrase);

    // create the two stacks for the characters
    LinkedStack<E> alpha = new LinkedStack<E>();
    LinkedStack<E> punctuation = new LinkedStack<E>();

    //------------------------------------------
        for(int i=0; i<phrase.length(); i++)
        {
        // if the character is a letter, push it onto the letters stack
            char c = phrase.charAt(i);
            if (true == Character.isLetter(c))

        {
            // (testing purposes only- remove next line)
                System.out.println("LETTER");
                String A = Character.toString(c);

            // push the letter onto the stack   
                alpha.push((E) new Node<E>());      
        }

        // else push it onto the characters stack
        else
        {
            // (testing purposes only- remove next line)
            System.out.println("NOT LETTER");
            String B = Character.toString(c);

            // push the character onto the stack
            punctuation.push((E) new String(B));    
        }
            // then pop the letters stack
        while (!alpha.isEmpty());   
        {
            reversed += alpha.pop();
        }
        }
        //------------------------------------------
    // if it equals the String phrase
        if (reversed == phrase)
            // it is a palindrome
            System.out.println("The phrase you entered is a palindrome");
    else
        System.out.println("The phrase you entered is NOT a palindrome");
        System.out.println("phrase: " + phrase);
        System.out.println("alpha: " + alpha);
        System.out.println("reversed: " + reversed);
}
@Override
public boolean hasNext() {
    // TODO Auto-generated method stub
    return true;
}
@Override
public E next() {
    // TODO Auto-generated method stub
    return null;
}
@Override
public void remove() {
    // TODO Auto-generated method stub

}

} 
```

结果：

```
Please enter a phrase. This program will verify if the phrase is a palindrome.
mom
You entered: MOM
LETTER
LETTER
LETTER
The phrase you entered is NOT a palindrome
phrase: MOM
alpha: <empty>
reversed: nullnullnull 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T18:05:27.317

如果我正确地回答了您的问题，我认为问题确实是您`push`在`LinkedStack`课堂上的方法。看一看。

```
public void push(E data) {
    head = new Node<E>();
    nodeCount++;
} 
```

您创建一个新的`Node`，将其分配给`head`并增加堆栈的节点数，但您从未真正*链接*旧的头或填充新的当前头，您只需用没有前一个或下一个元素的新节点替换该头。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:08:20.063

```
// A method to push the data onto a stack and increment the node count
public void push(E data) {
    head = new Node<E>();
    nodeCount++;
    } 
```

这种方法是错误的。当您推送一个新节点时，您需要将其设置`next`为当前头。您还需要使用您的数据填充该节点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T18:17:55.533

这可能是也可能不是你的全部问题，但它绝对是其中的一部分......

```
// A method to push the data onto a stack and increment the node count
public void push(E data) {
    head = new Node<E>();
    nodeCount++;
} 
```

*   总是用不包含数据的新节点替换 head，即使传递了 E 类型的对象。您需要调用 head.setData(data)。
*   您还需要*添加到列表中*而不是替换头部。
    如果（头==空）{头=新节点（）；头.setData（数据）；} else { 节点 n = 新节点（）；n.setData(数据); 节点最后 = ...; // 将获取列表中的最后一个节点留给读者作为练习 last.setNext(n); }