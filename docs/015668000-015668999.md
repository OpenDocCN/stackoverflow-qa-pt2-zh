# StackOverflow 问答 15668000-15668999

# java - 使用 spring ldapTemplate，我如何删除/取消绑定 LDAP 条目？

> ID：15668001
> 
> 赞同：2
> 
> 时间：2013-03-27T19:43:37.457
> 
> 标签：java, spring, ldap, spring-ldap

如何通过 Spring LdapTemplate 取消绑定 LDAP 条目？

我有一个 LDAP 条目 uid=johnsmith@example.com,objectClass=posixAccount。不确定是否重要，但 johnsmith@example.com 也是 group1 的成员。

```
com  
  |
  +--example (dc=example,objectClass=organization)
       |
       +--groups (ou=groups,objectClass=organizationUnit)
       |    |
       |    +--group1 (cn=group1,objectClass=groupOfNames)
       |    +--group2 (cn=group2,objectClass=groupOfNames)
       |
       +--people (ou=people,objectClass=organizationUnit)
            |
            +--johnsmith@example.com (uid=johnsmith@example.com,objectClass=posixAccount)
            +--janesmith@example.com (uid=janesmith@example.com,objectClass=posixAccount) 
```

**到目前为止我尝试了什么：**

```
Name dn = new DistinguishedName();
dn.add("ou", "people");
dn.add("uid", "johnsmith@example.com");

ldapTemplate.unbind(dn); 
```

但是即使没有抛出异常，LDAP 条目也不会被删除。

**我还尝试了递归解除绑定：**

```
Name dn = new DistinguishedName();
dn.add("ou", "people");
dn.add("uid", "johnsmith@example.com");

ldapTemplate.unbind(dn, true); 
```

但我收到以下错误：

```
Exception occurred in target VM: [LDAP: error code 32 - No Such Object]; nested exception is javax.naming.NameNotFoundException: [LDAP: error code 32 - No Such Object]; remaining name 'uid=johnsmith@example.com,ou=people'  org.springframework.ldap.NameNotFoundException: [LDAP: error code 32 - No Such Object]; nested exception is javax.naming.NameNotFoundException: [LDAP: error code 32 - No Such Object]; remaining name 'uid=johnsmith@example.com,ou=people'
at org.springframework.ldap.support.LdapUtils.convertLdapException(LdapUtils.java:174)
at org.springframework.ldap.core.LdapTemplate.deleteRecursively(LdapTemplate.java:1122)
at org.springframework.ldap.core.LdapTemplate$25.executeWithContext(LdapTemplate.java:1083)
at org.springframework.ldap.core.LdapTemplate.executeWithContext(LdapTemplate.java:807)
at org.springframework.ldap.core.LdapTemplate.executeReadWrite(LdapTemplate.java:802)
at org.springframework.ldap.core.LdapTemplate.doUnbindRecursively(LdapTemplate.java:1081)
at org.springframework.ldap.core.LdapTemplate.unbind(LdapTemplate.java:1044)
(etc....) 
```

**编辑：我发现了问题。uid 中有错字，这就是 unbind 没有删除 LDAP 条目的原因...**

# javascript - 一页上有两个几乎相同的javascript位，只有一个有效

> ID：15668002
> 
> 赞同：0
> 
> 时间：2013-03-27T19:43:40.050
> 
> 标签：javascript

我必须在我的页面上生成两个随机数。我正在使用这个 javascript：

```
<script>
 window.onload = generateRandomNumber1;
 function generateRandomNumber1(){
     var n = 30;
     var number = Math.floor(Math.random()*n)+1;
     document.getElementById("random1").innerHTML = number;
    }

 window.onload = generateRandomNumber2;
 function generateRandomNumber2(){
     var n = 30;
     var number = Math.floor(Math.random()*n)+1;
     document.getElementById("random2").innerHTML = number;
    }
</script> 
```

只有第二段代码 generateRandomNumber2 有效。两者都单独工作，但只有一个工作时他们在一起。

我确信可能有一些非常基本的解决方案，但我是一个真正的 javascript 新手。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:45:44.137

第二个是覆盖 window.onload 事件。相反，您应该尝试创建一个包装匿名函数来调用这两个函数：

```
window.onload = function(){
  generateRandomNumber1();
  generateRandomNumber2();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:45:20.883

你`window.onload`用第二个覆盖第一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T19:45:31.640

您正在重新分配 window.onload。让 window.onload 调用另一个调用两个随机数函数的函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T19:46:38.423

你是压倒一切`window.onload`的，所以只有第二个才会有任何影响。相反，创建一个调用两者的新函数：

```
window.onload = function() {
    generateRandomNumber1();
    generateRandomNumber2();
}; 
```

# excel - 在电子表格中的时间和 PM/AM 之间添加空格

> ID：15668004
> 
> 赞同：0
> 
> 时间：2013-03-27T19:43:45.527
> 
> 标签：excel, parsing, time, formatting, formula

我有一个有几百行的电子表格。其中两列包含时间。时代的样子有 4 种不同的可能性。数字可以是任何数字，这是为了说明时间和上午/下午之间的间距问题

```
1:30PM
4:30 PM
11:30AM
9:30 AM 
```

有没有办法让excel在没有空格的情况下自动放置一个空格，如果有则不做任何事情，所以上面的列表如下所示

```
1:30 PM
4:30 PM
11:30 AM
9:30 AM 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:11:57.553

AM/PM 在单元格的实际值中，还是由于单元格格式设置而被添加到末尾？

如果它在单元格值中，请插入一列并尝试：

=IF（或（右（A1,3）=“下午”，右（A1，3）=“上午”），A1，连接（左（A1，LEN（A1）-2），“”，右（A1 ,2)))

并向下拖动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:47:21.900

按 Ctrl-H

将 PM 替换为（空格）PM，将 AM 替换为（空格）AM。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-04-23T08:01:58.203

只需使用查找和替换......搜索“AM”替换为“AM”然后对PM做同样的事情......

# mysql - 如何在 MySQl 5.0 中将整数列添加到字符串列

> ID：15668008
> 
> 赞同：1
> 
> 时间：2013-03-27T19:44:00.850
> 
> 标签：mysql, concat, create-table

我想在字符串中添加一个整数列，因为我需要生成一个带有自动递增数字部分的 varchar 变量。例如，`P000001,P000002...`

为了做到这一点，我在创建表时正在做的事情，我采用了一个 int 字段 ID，它是 auto_increments 并且我将 P 与 00000 和 ID 值连接起来

我创建的表是：

```
CREATE TABLE tblAcceptTest(
ID int AUTO_INCREMENT NOT NULL primary key,
PatientID as CONCAT('P' , CONCAT('000000',CAST(ID as char)))
); 
```

它向我显示了 as 关键字的错误。请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:00:55.717

MySQL 的文档 ( [http://dev.mysql.com/doc/refman/5.1/en/create-table.html](http://dev.mysql.com/doc/refman/5.1/en/create-table.html) ) 说，“默认值必须是常量；它不能是函数或表达式。” 您为什么不稍后将 PatientID 值作为 SELECT 的一部分：

```
SELECT CONCAT('P', LPAD(ID, 6, 0)) AS PatientID FROM tblAcceptTest; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T21:05:48.050

Mysql 对计算列的支持很少。您的规范中的患者 ID 可能是 char(7)

```
CREATE TABLE tblAcceptTest(
    ID int AUTO_INCREMENT NOT NULL primary key,
    PatientID char(7)
); 
```

然后创建一些触发器。请注意，以下插入触发器将导致高并发服务器出现问题。

```
DELIMITER |

CREATE TRIGGER tblAcceptTest_insert BEFORE INSERT ON tblAcceptTest
  FOR EACH ROW BEGIN
    DECLARE next_id INT;
       SET next_id = (SELECT AUTO_INCREMENT FROM information_schema.TABLES WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='tblAcceptTest');
    SET NEW.PatientID =  CONCAT('P' , RIGHT(CONCAT('000000',next_id),6)) ;
  END;
|

CREATE TRIGGER tblAcceptTest_update BEFORE UPDATE ON tblAcceptTest
  FOR EACH ROW BEGIN
     SET NEW.PatientID =  CONCAT('P' , RIGHT(CONCAT('000000',NEW.ID),6)) ;
  END;
|

DELIMITER ; 
```

您使用关系和视图来实现相同的结果。

```
CREATE TABLE `patient` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `patient` varchar(60) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `accepted_test` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `patient_id` int(11) NOT NULL,
  `accepted` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `patient_id` (`patient_id`),
  CONSTRAINT `accepted_test_ibfk_1` FOREIGN KEY (`patient_id`) REFERENCES `patient` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

create or replace view accepted_test_veiw as 
select CONCAT('P' , RIGHT(CONCAT('000000',patient_id),6)) patient_key
, accepted 
, id accepted_test_id
, patient_id
from accepted_test ;

select * from `accepted_test_veiw` 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T19:55:07.400

看起来你想要在“P”之后有六位数字，所以试试这个表达式：

```
CONCAT('P', LPAD(ID, 6, '0')) 
```

# c# - c# 使用“@”作为斜线分隔符

> ID：15668010
> 
> 赞同：-2
> 
> 时间：2013-03-27T19:44:10.930
> 
> 标签：c#

我在 a 中使用 \ 来获取文件路径

```
 string driveLetter = "C:\\";
    string folderName = "324Files";
    string fileName = "rpt3434.txt";
    string stringPath = driveLetter + "MainFolder\\Report" + folderName + "\\" + fileName; 
```

我想改用@，但发现它更麻烦：

```
 string driveLetter = @"C:\";
    string folderName = "324Files";
    string fileName = "rpt3434.txt";
    string stringPath = driveLetter + @"MainFolder\Report" + FolderName + @"\" + fileName; 
```

我想知道哪一种是首选的方法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-27T19:48:09.807

Path.Combine方法就是[为了](http://msdn.microsoft.com/en-us/library/system.io.path.combine.aspx)解决这些困难。

```
string driveLetter = "C:\\";
string folderName = "324Files";
string fileName = "rpt3434.txt";
string stringPath = Path.Combine(driveLetter,"MainFolder", "Report", folderName, fileName);
Console.WriteLine(stringPath);

C:\MainFolder\Report\324Files\rpt3434.txt 
```

或（如果您真的想将“报告”与文件夹名称连接起来

```
string stringPath = Path.Combine(driveLetter,"MainFolder", "Report" + folderName, fileName);

C:\MainFolder\Report324Files\rpt3434.txt 
```

需要添加

```
using System.IO; 
```

[Path 类](http://msdn.microsoft.com/en-us/library/3bdzys9w.aspx)包含许多在处理用于表示文件和路径的字符串时非常有用的方法。该类还能够区分不同底层操作系统使用的语法。如果您打算将代码移植到不同的平台，那么这确实是更可取的，而硬编码的反斜杠将需要修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T19:45:32.977

尝试这样的事情：

```
string stringPath = string.Format(@"{0}MainFolder\Report{1}\{2}", driveLetter, folderName, fileName); 
```

# javascript - 文档就绪时调用函数

> ID：15668014
> 
> 赞同：1
> 
> 时间：2013-03-27T19:44:28.023
> 
> 标签：javascript, jquery

我需要在页面加载时开始轮询 URL，以从信用卡服务器获取 JMS 响应。我将以下内容放在一起。

它有效，但前提是我点击浏览器上的刷新按钮。我希望在首次显示页面时自动加载来自 URL 的数据，而不需要用户刷新。

我在这里遗漏了一个基本概念，并希望获得有关如何使其发挥作用的任何建议。到目前为止，我有大约 2 天的 JavaScript 经验。

```
<html>
    <body>

        <div id="p_results"></div>

        <script type="text/javascript">
            $(document).ready(function() {
                function doJMSPolling() {
                    $.ajax({
                        url: "./poll",
                        type: "GET",
                        dataType: "text",
                        success: function(json) {

                            var json = $.parseJSON(json);

                            if (json.status === 'continue-polling' && json.msg === 'ok') {
                                setTimeout(function() {
                                    doPolling();
                                }, 2000);
                            }
                            else if (json.status === 'stop-polling' && json.msg === 'success') {
                                for (key in json) {
                                    if (key === "providerResponse") {
                                        res = json[key];
                                        for (reskey in res) {
                                            $("#p_results").append(reskey + ":" + res[reskey] + "<br>"); 
                                        }
                                    }
                                }
                            } else if (json.status === 'stop-polling') {
                                $("#p_results").text(json.status);
                            }
                        }
                    });
                }
            });
        </script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T19:48:04.247

您不必将实际的函数定义放在`document.ready`回调中。该函数可以位于`<script>`标签内的任何位置。完成此操作后，您需要做的就是从`document.ready`回调中调用该函数 -

```
<script type="text/javascript">
$(function(){
  doJMSPolling();
});

function doJMSPolling(){
 ...
}
</script> 
```

* * *

笔记 ：

`$(function(){})`是简写`$(document).ready(function(){})`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T19:47:50.403

在我看来，你是在声明你的函数，但没有调用它。为了执行函数的代码，您需要在 document.ready 中的函数声明之后添加：

```
doJMSPolling(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-27T19:49:02.403

不要把你的函数**放在里面**，`document.ready`只需在那里**调用它**。试试这个：

```
$(document).ready(function() {
    doJMSPolling();
});

function doJMSPolling() {
    $.ajax({
        url: "./poll",
        type: "GET",
        dataType: "text",
        success: function(json) {
            var json = $.parseJSON(json);
            if (json.status === 'continue-polling' && json.msg === 'ok') {
                setTimeout(function() {
                    doPolling();
                }, 2000);
            }
            else if (json.status === 'stop-polling' && json.msg === 'success') {
                for (key in json) {
                    if (key === "providerResponse") {
                        res = json[key];
                        for (reskey in res) {
                            $("#p_results").append(reskey + ":" + res[reskey] + "<br>"); 
                        }
                    }
                }
            }
            else if (json.status === 'stop-polling') {
                $("#p_results").text(json.status);
            }
       }
  });
} 
```

# ajax - 处理多个 XMLHttpRequest 调用 f

> ID：15668016
> 
> 赞同：0
> 
> 时间：2013-03-27T19:44:34.667
> 
> 标签：ajax, xmlhttprequest-level2

注意：我有两个 xmlHttp.open 请求，其中定义了两个不同的 url 字符串和两个 onreadystatechange 函数。我有一个包含 4 个文本框和一个提交按钮的 html 表单。用户在文本框 1(id​​) 和 2(type) 中输入数据后，我对这些框的 onchange 函数发出 xmlHttp.open("GET", url, true); 带有类似“getQuestion.php?id=12345&type=ABC”的网址。然后我的 statechange 函数获取返回的 xml 响应并将响应放入第三个文本框中。所有这些都很棒！我输入文本，文本弹出到一个框问我一个问题。

现在我尝试做的是，一旦填写了第 4 个文本框并单击了提交按钮，我希望提交函数再次使用 xmlHttp.open。这一次，有一个新的 url，在 &answer="XXXX" 的 url 行上多了一个参数，其中 XXXX 是在第 4 个框中输入的内容。之所以进行第二次 url 调用，是因为调用了新的 statechange 函数。但响应始终为空，我看到“答案是。”。我认为这一定与我没有正确设置的多个 url 有关，但我在“多个 xmlHttpRequest”的网络搜索中找不到任何内容。我附上了我的 HTML 和启动失败服务器请求的 javacode 块，它是 statechange 函数。我究竟做错了什么？还有一件事，

```
<script language="Javascript">
/* Create a new XMLHttpRequest object to talk to the Web server */
var xmlHttp = false;
var attempts = 0;
try {
  xmlHttp = new ActiveXObject("Msxml2.XMLHTTP");
} catch (e) {
  try {
    xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
  } catch (e2) {
    xmlHttp = false;
  }
}
if (!xmlHttp && typeof XMLHttpRequest != 'undefined') {
  xmlHttp = new XMLHttpRequest();
}

function CheckAnswer() {
  var myId = document.getElementById("FilerID").value;
  var myType = document.getElementById("FilerType").value;
  var myQuestion = document.getElementById("QuestionID").value;
  var myAnswer = document.getElementById("AnswerID").value;

  if (myId == "" || myType == "" || myQuestion == "" || myAnswer == "")
  {
      alert("You must fill in all boxes before submitting this request.");
      return;
  }

  // Build the URL to connect to
  var url = "getAnswer.php?id=" + encodeURI(myId) + "&type=" + encodeURI(myType) + "&answer=" + encodeURI(myAnswer);

  // Open a connection to the server
  xmlHttp.open("GET", url, true);
  xmlHttp.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
  // Setup a function for the server to run when it's done
  xmlHttp.onreadystatechange = AnswerState;

  // Send the request
  xmlHttp.send(null);
}

function AnswerState() {
  if (xmlHttp.readyState == 4) {
    var response2 = xmlHttp.responseText;
        alert("answer was " + response2+".");
        switch (response2)
    {
        case "pdwLIMBO":
            alert("There was an error while trying to reset your password.");
            break;
        case  "pdwFALSE":
            alert("Answer was incorrect.");
            attempts = attempts +1;
            if (attempts == 3)
            {
                /*is there a way to kill it right now?*/
            }
            else
                document.getElementById("AnswerID").focus();
            break;
        case "pdwTRUE":
            alert("answer was " + response);
            alert("Your new password will be emailed to you.  Please check your email.");
            break;
        default:
            alert("nothing!");
            break;
    }

  }
}
<table width="98%" border="0" align="center" height="280" background="/images/DSCF0308_B.gif">
<tr>
<td align="center">
<h2 align="center" class="style26">Reset Service</h2>
<!--<form name="resetMe" action="SecretQuestion3.php" method="post" onsubmit="return CheckInput();">-->
<form  >
  <TABLE cellspacing=0 cellpadding=5 border=0 width="90%"> <!---this color is light blue in sign in box--->
      <tr id="FilerIDRow">
      <TD align="right" class="RptStd"><b>Filer ID:</b></TD>
      <TD align="left" class="RptStd"> <input type="text" id="FilerID" name="FilerID" nowrap size=8/ onChange="callForQuestion();"></td>
    </tr>
    <tr >
    <TD align="right" class="RptStd" ><b>Filer Type: </b></TD>
    <TD align="left" class="RptStd">
       <select name="FilerType" id="FilerType" onChange="callForQuestion();">
        <option value="COH">COH: Candidate/Officeholder (Non-Judicial)</option>
        <option value="JCOH">JCOH: Judicial Candidate/Officeholder </option>
       </select></TD>
    </tr>
    <tr id="QuestionRow">
    <TD align="right" class="RptStd"><b>Secret Question:</b></TD>
    <TD align="left" class="RptStd"> <input type="text" id="QuestionID" name="QuestionID" nowrap size="50"></td>
    </tr>
    <tr id="AnswerRow">
    <TD align="right" class="RptStd"><b>Your Answer:</b></TD>
    <TD align="left" class="RptStd"> <input type="text" id="AnswerID" name="AnswerID" nowrap size="50" onChange="checkAnswer();"></td>
    </tr>
    <TR>
    <TD align="center" colSpan=2><br><INPUT type="button" value="  Reset  " name="btn_submit" class="RptBtn" onClick="CheckAnswer()">&nbsp;&nbsp;
    <INPUT type="button" value=" Clear " name="btn_clear" class="RptBtn" onClick="ClearForm()"></TD>
    </TR>
</table>
</form> 
</td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-27T10:05:11.030

对 Jacob Tobias 上面在引用 Rob W 对此的解决方案时所建议的内容 +1。我重申了 Rob W 的建议，即 Jacob 也正在链接/引用：

使用 var 定义 xmlHttp，如下所示：

**改变这个...**

xmlHttp = 新的 XMLHttpRequest();

**对此：**

var xmlHttp = 新的 XMLHttpRequest();

Rob W 的解释：目前，您将 xmlHttp 分配为全局变量。因此，您只能拥有一个名为 xmlHttp 的变量...

如果在变量之前使用 var，则该变量在本地范围内定义，允许您多次使用重新定义变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-18T13:48:07.480

尝试改变：

```
if (!xmlHttp && typeof XMLHttpRequest != 'undefined') {
  xmlHttp = new XMLHttpRequest();
} 
```

至：

```
if (!xmlHttp && typeof XMLHttpRequest != 'undefined') {
  var xmlHttp = new XMLHttpRequest();
} 
```

我有一个类似的问题，[这个链接](https://stackoverflow.com/questions/7571985/javascript-xhr-not-handling-multiple-async-requests)帮助了我

# c# - 带有 2 个控制台应用程序的任务计划程序不写入日志文件

> ID：15668020
> 
> 赞同：1
> 
> 时间：2013-03-27T19:44:55.997
> 
> 标签：c#, console, task, scheduler

我有一个计划任务，其中包含 2 个控制台应用程序。当任务运行时，它会正确执行，但两个日志文件都不会写入各自的目录。当我手动运行控制台应用程序（只需双击它）时，它会运行并生成一个日志文件。如果我将其中一个控制台应用程序从计划任务中取出，它会运行并创建相应的日志文件......知道为什么计划任务中的 2 个控制台应用程序不会产生正确的日志 (.txt) 文件吗？

# php - 来自 MySQL 的具有最新和唯一值的 HTML 表

> ID：15668021
> 
> 赞同：2
> 
> 时间：2013-03-27T19:45:02.120
> 
> 标签：php, mysql, database, codeigniter

不确定要搜索什么，所以这可能是一个重复的问题。我有一个 mysql 数据库，其中有一个名为 software 的表。软件表由以下字段组成：

```
id (auto_increment)
computer_name
software_name
software_version
install_date 
```

每次安装、升级或恢复到以前版本的软件时，都会在表中创建一个新条目。

我正在尝试使用 php 构建一个看起来像这样的表：

```
.---------------------------------------------------.
|            | software x | software y | software z |
|---------------------------------------------------|
| computer a | ver 1.0    |            | ver 1.2    |
|---------------------------------------------------|
| computer b |            | ver 2.1    |            |
|---------------------------------------------------|
| computer c | ver 1.3    | ver 1.1    |            |
'---------------------------------------------------' 
```

从这样的数据：

```
computer_name  |  software_name  |  software_version  |  install_date
----------------------------------------------------------------------
computer a     |  software x     |  ver 1.1           |  [10 days ago]
computer a     |  software x     |  ver 1.0           |  [2 days ago]
computer a     |  software z     |  ver 1.1           |  [20 days ago]
computer a     |  software z     |  ver 1.2           |  [5 days ago] 
```

这`install_date`将是一个实际日期，为方便起见，在 [X 天前] 中输入。

该表将显示每台计算机上安装的每个软件的最新版本，每个唯一的计算机条目只有一行，每个唯一的软件条目只有一列。

这可能与单个 MySQL 表有关吗？实现这一目标的最佳方法是什么？我正在将 PHP 和 MySQL 与 codeigniter 一起使用。

# 更新：

通过查看可能的重复问题，我能够准备此查询：

```
SET @sql = NULL;

SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'MAX(IF(software_name = ''',
      software_name,
      ''', software_version, NULL)) AS ',
      replace(software_name, ' ', '_')
    )
  ) INTO @sql 
FROM 
  software;

SET @sql = CONCAT('SELECT computer_name, ', @sql, ' FROM software GROUP BY computer_name');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

它以我正在寻找的格式生成结果，但是它不是通过最新版本获取版本，`install_date`而是通过找到的最大版本号获取。如何修改上述内容以获取具有最新关联的版本`install_date`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T22:59:15.370

一项艰苦的工作，但我得到了一个可以实现结果的查询！

您在数据库方面需要的`CROSS JOIN`是能够针对所有不同的软件列出所有不同的计算机，然后过滤所需的`software_version`.

我用这个查询做到了：

```
SELECT 
  b.computer_name, 
  a.software_name, 
  MAX(IF(b.software_name = a.software_name AND b.id = a.id, a.software_version, '')) AS software_version 
FROM 
  software AS a, 
  software AS b 
GROUP BY 
  b.computer_name, 
  a.software_name 
ORDER BY 
  b.computer_name ASC, 
  a.software_name ASC, 
  software_version DESC; 
```

我的表数据有这些值：

```
------ ---------------- --------------- -------------- ---- ---------
| 编号 | 计算机名 | 软件名称 | 软件版本 | 安装日期 |
 --------------- ------ --------------- -------------- ---- ---------
| 1 | 电脑a | 软件 x | 1.1 版 | 2013-03-27 15:58:17 |
| 2 | 电脑a | 软件 x | 版本 1.0 | 2013-03-27 15:58:20 |
| 3 | 电脑a | 软件z | 1.3 版 | 2013-03-27 15:58:24 |
| 4 | 电脑b | 软件z | 1.4 版 | 2013-03-27 15:58:30 |
| 5 | 电脑b | 软件z | 1.2 版 | 2013-03-27 15:58:45 |
| 6 | 电脑c | 软件 x | 1.5 版 | 2013-03-27 15:58:51 |
| 7 | 电脑c | 软件y | 1.7 版 | 2013-03-27 15:58:58 |
 --------------- ------ --------------- -------------- ---- ---------

```

这是我的输出：

```
------------ ------------ ------------------
| 电脑 | 软件 | 软件版本 |
 ------------ ------------ ------------------
| 电脑a | 软件 x | 1.1 版 |
| 电脑a | 软件y | |
| 电脑a | 软件z | 1.3 版 |
| 电脑b | 软件 x | |
| 电脑b | 软件y | |
| 电脑b | 软件z | 1.4 版 |
| 电脑c | 软件 x | 1.5 版 |
| 电脑c | 软件y | 1.7 版 |
| 电脑c | 软件z | |
 ------------ ------------ ------------------

```

在你的 PHP 代码中你应该做这样的事情（正如我所知道的纯 PHP - 我没有测试下面的 PHP 代码，这不是最好的编码方式......但我认为它会起作用，它基于我的查询输出）：

```
<?php
  $sql = 'SELECT ...';  // put the query here
  $result = mysql_query($sql);

  if( $result and mysql_num_rows($result))
  {
    $num_rows = mysql_num_rows($result);

    $versions = array();
    while ($row = mysql_fetch_assoc($result))
      $versions[] = $row;

    // Here we'll count how much softwares we have 
    $software_count = -1;
    $first_computer = $versions[0]['computer_name'];

    while( $versions[++$software_count]['computer_name'] == $first_computer );

    echo "<table>". 
           "<thead>". 
             "<tr>". 
               "<th></th>";

    // Here we'll print the softwares names as our table headers
    for($i = 0; $i < $software_count; $i++)
      echo "<th>". $versions[$i]['software_name'] . "</th>";

    echo     "</tr>". 
           "</thead>". 
           "<tbody>";

    // Here we'll print the data
    while($num_rows)
    {
      echo   "<tr>". 
               "<td style='font-weight: bold;'>". 
                 $versions[$i]["computer_name"] .
               "</td>";

      for($i = 0; $i < $software_count; $i++)
        echo   "<td>". $versions[$i]["software_version"] . "</td>";

      echo   "</tr>";

      $num_rows -= $software_count;
    }

    echo   "</tbody>".  
         "</table>";

  mysql_free_result($result);

?> 
```

一些工作，但我希望它可以帮助你，我希望我的 PHP 代码工作正常！祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:07:31.377

像这样的东西应该可以工作（比使用 distinct 快得多）。

```
select computer_name,software_name,software_version,install_date from table group by software_name order by computer_name,install_date DESC 
```

这样您仍然可以显示每台计算机上的所有软件。

如果您想将条目限制为每台计算机安装的最新软件，您可以使用：

```
select computer_name,software_name,software_version,install_date from table group by computer_name,software_name order by computer_name,install_date DESC 
```

# java - 在 Java 中使用 Thread.yield()

> ID：15668023
> 
> 赞同：3
> 
> 时间：2013-03-27T19:45:05.120
> 
> 标签：java, multithreading

我有以下课程：

```
package net.adjava.multithreading;

public class MyResource {

    private int a;

    public int getA() {
        return a;
    }

    public void setA(int a) {
        this.a = a;
    }

} 
```

* * *

```
package net.adjava.multithreading;

public class Thread1 extends Thread {
    MyResource m;

    public Thread1(MyResource m) {
        super();
        this.m = m;
    }

    @Override
    public void run() {
        System.out.println("Current Thread name1 :"
                + Thread.currentThread().getName());

        for (int i = 0; i < 10000; i++) {
            m.setA(i);
            System.out.println("Set method sets the value of a as: " + i);
            System.out.println("Current Thread name1 :"
                    + Thread.currentThread().getName());

            Thread.yield();

        }
    }
} 
```

* * *

```
package net.adjava.multithreading;

public class Thread2 extends Thread {

    MyResource m;
    public Thread2(MyResource m) {
        super();
        this.m = m;
    }
    @Override
    public void run() {
        System.out.println("Current Thread name2 :" + Thread.currentThread().getName());

        for (int i = 0; i < 100; i++) {

            System.out.println(" value of a as per getter method is :"
                    + m.getA());
            System.out.println("Current Thread name2 :" + Thread.currentThread().getName());

        }
        System.out.println("waiting for thread to end");

    }

} 
```

* * *

```
package net.adjava.multithreading;

public class ThreadExecutionPoint {

    public static void main(String args[])
    {
        System.out.println("Current Thread name main :" + Thread.currentThread().getName());

        MyResource m = new MyResource();
        Thread1 th1 = new Thread1(m);
        Thread2 th2 = new Thread2(m);
        th1.start();
        th2.start();

    }
} 
```

我试图通过上述类了解 yield() 的目的。在尝试这个例子之前，我对 yield() 的了解是它暂停了调用它的线程。所以为了测试它，我使用了 Thread1 类中的 yield 方法。所以基本上根据我的理解 thread1 应该执行一次 for 循环，然后应该暂停并等待其他线程完成。但输出显示不同的结果。输出显示首先执行线程 1，然后执行线程 2。有人可以纠正我所缺少的吗？或者我对产量（）的理解有问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T19:47:48.967

文档说明了这与`yield`方法有关：

> 使当前正在执行的线程对象暂时暂停并允许其他线程执行。

即使认为这可能会发生，也没有什么能保证您将选择处理的线程不是同一个线程。

由于几乎所有协调线程，请不要依赖此，因为无法保证您期望的功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T19:47:29.290

[我从这里](http://www.javamex.com/tutorials/threads/yield.shtml)引用：

> 这种静态方法本质上是用来通知系统当前线程愿意“放弃CPU”一段时间。一般的想法是：线程调度器将选择一个不同的线程来运行，而不是当前的。但是，线程调度程序如何实现屈服的细节因平台而异。一般来说，您不应该依赖它以特定方式表现。不同之处包括：在屈服之后，线程何时有机会再次运行；线程是否放弃其剩余的量程。

所以简而言之，你永远不知道线程执行何时会再次开始。

# java - 如何调用超类的重写方法？

> ID：15668032
> 
> 赞同：54
> 
> 时间：2013-03-27T19:45:36.907
> 
> 标签：java, inheritance, overriding

如何用代码中的实例调用`Animal`类的吃喝方法？`myAnimal`

```
public class Animal {
    public void eat() {
        System.out.println("Animal Eats");
    }

    public void drink() {
        System.out.println("Animal Drinks");
    }
} 
```

* * *

```
public class Cat extends Animal {
    @Override
    public void eat() {
        System.out.println("Cat Eats");
    }

    @Override
    public void drink() {
        System.out.println("Cat Drinks");
    }

    public static void main(String[] args) {
        Cat myCat = new Cat();
        myCat.eat();
        myCat.drink();

        Animal myAnimal = myCat;        
        myAnimal.eat();
        myAnimal.drink();
    }
} 
```

我得到的输出：

```
Cat Eats
Cat Drinks
Cat Eats
Cat Drinks 
```

这是我的预期输出：

```
Cat Eats
Cat Drinks
Animal Eats
Animal Drinks 
```

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2013-03-27T19:50:54.057

你不能做你想做的事。多态性的工作方式是做你所看到的。

基本上，猫总是知道它是一只猫，并且无论您是否将其视为猫，猫科动物，猫科动物，猫科动物，猫形目，食肉动物，Theria，哺乳动物，脊椎动物，脊索动物，Eumetazoa，动物界，动物，对象，或其他任何东西:-)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-04-15T21:06:38.737

在这里，您可以选择要调用的方法：

```
public class Cat extends Animal {

    public void superEat() {
        super.eat();
    }

    public void superDrink() {
        super.drink();
    }

    @Override
    public void eat() {
        System.out.println("Cat Eats");
    }

    @Override
    public void drink() {
        System.out.println("Cat Drinks");
    }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-03-27T19:51:41.470

这一行：

`Animal myAnimal = myCat;`

将变量分配给您之前创建`myAnimal`的 object 。`myCat`因此，当您`myAnimal.eat()`在那之后调用时，实际上是在调用原始 myCat 对象的方法，该方法输出`Cat Eats`.

如果要输出`Animal Eats`，则必须将`Animal`实例分配给变量。因此，如果您改为这样做：

`Animal myAnimal = new Animal()`

变量 myAnimal 将是 的一个实例`Animal`，因此将覆盖之前对 的赋值`Cat`。

如果您`myAnimal.eat()`在此之后调用，您实际上是在调用您创建`eat()`的实例的方法，该方法将输出.`Animal``Animal Eats`

结论：您的代码应为：

```
public class Cat extends Animal {

    @Override
    public void eat() {
        System.out.println("Cat Eats");
    }

    @Override
    public void drink() {
        System.out.println("Cat Drinks");
    }

    public static void main(String[] args) {
        Cat myCat = new Cat();
        myCat.eat();
        myCat.drink();

        Animal myAnimal = new Animal();        
        myAnimal.eat();
        myAnimal.drink();
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-11-27T04:10:34.263

*   对静态字段、实例字段和静态方法的访问取决于**引用变量的类，**而不是 变量指向**的实际对象。**
*   请记住，成员变量是隐藏的，而不是覆盖的。
*   这与实例方法的情况相反。
    在实例方法的情况下，调用**对象的实际类的**方法 。

    ```
    class ABCD {
        int x = 10;
        static int y = 20;

        public String getName() {
            return "ABCD";
        }
    }

    class MNOP extends ABCD {
        int x = 30;
        static int y = 40;

        public String getName() {
            return "MNOP";
        }
    }

    public static void main(String[] args) {

      System.out.println(new MNOP().x + ", " + new MNOP().y);

      ABCD a = new MNOP();
      System.out.println(a.x); // 10
      System.out.println(a.y); // 20
      System.out.println(a.getName()); // MNOP
    } 
    ```

在此示例中，尽管对象 myCat 被分配给 Animal 对象引用，但 ( `Animal myAnimal = myCat`) Actual 对象属于类型`Cat`并且它的行为与猫一样。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-08-19T06:30:46.413

您可以为类 Animal 创建构造函数，该构造函数将另一个Animas 作为参数，并基于提供的一个创建新实例。

```
public class Animal {
    //some common animal's properties
    private int weight;
    private int age;

    public Animal() {
        // empty.
    }

    public Animal(final Animal otherAnimal) {
        this.weight = otherAnimal.getWeight();
        this.age = otherAnimal.getAge();
    }

    public void eat() {
        System.out.println("Animal Eats");
    }

    public void drink() {
        System.out.println("Animal Drinks");
    }

    // setters and getters.
}

public class Cat extends Animal {
    @Override
    public void eat() {
        System.out.println("Cat Eats");
    }

    @Override
    public void drink() {
        System.out.println("Cat Drinks");
    }

    public static void main(String[] args) {
        Cat myCat = new Cat();
        myCat.eat();
        myCat.drink();

        // note: myAnimal is not a Cat, it's just an Animal.
        Animal myAnimal = new Animal(myCat);         
        myAnimal.eat();
        myAnimal.drink();
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-05-14T23:40:12.240

如果您将每个类中的方法设为静态，它应该可以工作。

```
public class Animal {
    public static void eat() {
        System.out.println("Animal Eats");
    }

    public static void drink() {
        System.out.println("Animal Drinks");
    }
}

public class Cat extends Animal {
    @Override
    public static void eat() {
        System.out.println("Cat Eats");
    }

    @Override
    public static void drink() {
        System.out.println("Cat Drinks");
    }

    public static void main(String[] args) {
        Cat myCat = new Cat();
        myCat.eat();
        myCat.drink();

        Animal myAnimal = myCat;        
        myAnimal.eat();
        myAnimal.drink();
    }
} 
```

上面的代码将给出以下输出

```
Cat Eats
Cat Drinks
Animal Eats
Animal Drinks 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-09-30T11:35:13.263

几点建议：

1.  不要将子类引用传递给超类，并且必须为重写的方法调用超类方法之外的方法。从超类实例调用超类方法。

    ```
    Animal myAnimal = new Animal();
    myAnimal.eat(); 
    ```

2.  如果要从子类调用超类方法，使用 super.methodName() 显式调用超类方法名；

    ```
    public void eat() {
        super.eat();
        System.out.println("Cat Eats");
    } 
    ```

3.  不要覆盖子类中的超类方法。总是调用超类方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-11-05T15:03:28.377

你可以使用 super 关键字实现你想要的，它允许访问被覆盖的方法。

```
public class Animal {
    public void eat() {
       System.out.println("Animal Eats");
    }

    public void drink() {
       System.out.println("Animal Drinks");
    }
}

 public class Cat extends Animal {

   public void eat() {
      System.out.println("Cat Eats");
   }

   public void drink() {
      System.out.println("Cat Drinks");
   }

   public void printMessage(){
     super.eat();
     super.drink();
   }

  public static void main(String[] args) {
    Cat myCat = new Cat();
    myCat.eat();
    myCat.drink();
    myCat.printMessage();
 }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-27T20:01:21.383

请不要对这个答案投票......你可以对另一个投票:-) 这是一个糟糕的答案，但显示了你将如何做你想做的事情......糟糕。

```
public class Main
{
    public static void main(final String[] argv) 
    {        
        Child  child;
        Parent parent;

        child  = new Child();
        parent = child;

        child.a();
        parent.a();
        child.otherA();
        parent.otherA();
    }
}

class Parent
{
    public void a()
    {
        System.out.println("Parent.a()");
    }

    public void otherA()
    {
        // doesn't matter what goes here... really should be abstract
    }
}

class Child
    extends Parent
{
    @Override
    public void a()
    {
        System.out.println("Child.a()");
    }

    @Override
    public void otherA()
    {
        super.a();
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-27T20:04:54.773

猫不能停止成为猫，即使它是动物。猫会吃猫会喝猫的方式。它可能类似于 Animal 所做的事情，这就是它覆盖该方法的原因。如果你想让它做动物默认做的事情，不要覆盖。您可能可以通过反射做一些奇怪的事情，并制作访问父方法的单独方法，例如：

```
public void superDrink() {
   Animal.class.getMethod("drink").invoke();
} 
```

但这可能有点矫枉过正，你不觉得吗？

当然，这可能行不通，因为它不是静态的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-26T22:09:56.497

```
public class Main {
    public static void main(String[] args) {
        Cat myCat = new Cat();
        myCat.eat();
        myCat.drink();

        Animal myAnimal = new Animal();
        myAnimal.eat();
        myAnimal.drink();
    }
}

public class Animal {
    public void eat(){
        System.out.println("Animal eat() called");
    }
    public void drink(){
        System.out.println("Animal drink() called");
    }
}

public class Cat extends Animal {
    @Override
    public void eat() {
        System.out.println("Cat eat() called");
    }

    @Override
    public void drink() {
        System.out.println("cat drink() called");
    }
} 
```

输出：

> 猫吃（）调用
> 
> 猫喝（）调用
> 
> 动物吃（）调用
> 
> 动物饮料（）调用

您需要创建超类的对象，或者另一个选项是在子类方法中`Animal`使用关键字，例如，或`super``super.eat()``super.drink()`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-09-21T17:11:32.807

您可以通过对代码进行一些小的更改来做您想做的事情。自然，Animal 类的方法已被覆盖，您不能简单地通过更改引用类型来访问它们。相反，你可以稍微改变一下 eat 和 Drink 函数的定义，如下所示。

```
class Animal{
    public void eat(boolean randomBoolean){
        System.out.println("Animal eats");
    }
    public void drink(boolean randomBoolean){
        System.out.println("Animal drinks");
    }
}

class Cat extends Animal{
    public void eat(boolean wantOverriden){
        if(wantOverriden){
            boolean randomBooleanValue=true|false;
            super.eat(randomBooleanValue);
        }
        else{
            System.out.println("Cat eats");
        }
    }
    public void drink(boolean wantOverriden){
        if(wantOverriden){
            boolean randomBooleanValue=true|false;
            super.drink(randomBooleanValue);
        }
        else{
            System.out.println("Cat drinks");
        }
    }
} 
```

现在您应该能够通过 Cat 类对象访问 Animal 类的覆盖方法，只需传入一个布尔值来指示您是否要这样做，例如：

```
Cat c=new Cat();
c.eat(false);     //Indicating that you dont want to access the overriden method
c.drink(false);   //Indicating that you dont want to access the overriden method
c.eat(true);          //Indicating that you want to access the overriden method
c.drink(true);        //Indicating that you want to access the overriden method 
```

# objective-c - OCMock 混淆线程环境中的引用

> ID：15668044
> 
> 赞同：0
> 
> 时间：2013-03-27T19:46:11.713
> 
> 标签：objective-c, ocmock

我有一段代码，同步和异步处理队列。我正在使用 OCMock 来测试这个东西，我可以单独测试这两种情况（同步和异步），但是当我同时测试这两种情况时，我遇到了麻烦。

为了验证队列是否被正确处理，我向它传递了一个模拟的侦听器，然后我从这个侦听器询问它是否得到了队列处理器传播的所有通知。我有两个测试，在第一个测试（异步）中，这些期望得到了满足，但是在第二个测试（同步）中，我得到了这个错误：

```
OCMockObject[JHQueueListener] : 4 expected methods were not invoked: 
        startedProcessingQueue
        startedToProcessQueueItem:OCMockObject[JHQueueItem]
        finishedProcessingQueueItem:OCMockObject[JHQueueItem]
        finishedProcessingQueue 
```

这是该项目的链接： [https ://github.com/jphollanti/queue-processor](https://github.com/jphollanti/queue-processor)

这是测试的链接： [https ://github.com/jphollanti/queue-processor/blob/master/QueueProcessorTests/JHQueueProcessorTests.m](https://github.com/jphollanti/queue-processor/blob/master/QueueProcessorTests/JHQueueProcessorTests.m)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T20:18:04.020

***问题 #1：***引用很好，但在测试方面，线程预计无法正常工作。这里的问题是启动了一个新线程，并且在该新线程中，队列的状态设置为进行中。但是启动一个新线程比主线程请求状态需要更长的时间，这导致队列（尚未）在进行中。添加大约 10000 毫秒的延迟应该会有很大帮助。像这样：

```
...
  [queue processQueueAsynchronously:queueItems];

  usleep(10000);

  BOOL wentToThread = NO;
  while ([queue isInProgress]) {
    wentToThread = YES;
    ...
  }
... 
```

此外，打电话`dispatch_async(dispatch_queue_t queue, ^(void)block)`需要很多时间，这增加了问题的“随机”性质。

***问题#2：***从主线程调用`dispatch_async(dispatch_get_main_queue(), ^{ ... }`会导致块被发送到某个队列，该队列在某个时间执行（不知道它是如何工作的）。这就是第二次测试（同步）失败的原因。使用类似的东西有助于：

```
if ([NSThread isMainThread]) {
  for (id <JHQueueListener> listener in listeners) {
    [listener startedToProcessQueueItem:queueItem];
  }
} else {
  dispatch_async(dispatch_get_main_queue(), ^{
    for (id <JHQueueListener> listener in listeners) {
      [listener startedToProcessQueueItem:queueItem];
    }
  });
} 
```

# javascript - 表相互重叠

> ID：15668049
> 
> 赞同：0
> 
> 时间：2013-03-27T19:46:43.020
> 
> 标签：javascript, html, css, twitter-bootstrap

我的页面中有三个表格....所有三个表格都重叠....如何避免三个表格重叠....

[http://jsfiddle.net/WG7kk/3/embedded/result/](http://jsfiddle.net/WG7kk/3/embedded/result/)

```
<table id="inventoryTable" class="table dataTable" aria-describedby="inventoryTable_info">
                        <thead>
                            <tr class="inventoryListHeading" role="row" style="background-color: #1a4567; color: white;">
                                <th class="sorting_disabled" role="columnheader" rowspan="1" colspan="1" style="width: 103px;">Qty</th>
                                <th class="sorting_disabled" role="columnheader" rowspan="1" colspan="1" style="width: 123px;">MFG P/N</th>
                                <th class="sorting_disabled" role="columnheader" rowspan="1" colspan="1" style="width: 85px;">Unit Price</th>
                                <th class="sorting_disabled" role="columnheader" rowspan="1" colspan="1" style="width: 134px;">Ext. Price</th>
                            </tr>
                        </thead>

                        <tbody role="alert" aria-live="polite" aria-relevant="all">
                            <tr id="row_1" class="odd">
                                <td class=" "><div id="fdCompanyName_1"><a href="/Customer/index/?step=modify&amp;cid=1">FQ Systems</a></div></td>
                                <td class=" "><div id="fdCustId_1"><a href="/Customer/index/?step=modify&amp;cid=1">1</a></div></td>
                                <td class=" "><div id="fdContactName_1"><a href="/Customer/index/?step=modify&amp;cid=1">Soojin Kim</a></div></td>
                                <td class=" "><div id="fdPhone_1"><a href="/Customer/index/?step=modify&amp;cid=1">408-172-3827</a></div></td>
                            </tr>

                        </tbody>
                    </table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:49:10.327

从技术上讲，您的桌子没有任何问题。它必须是你的 CSS。使用像 Firebug 这样的工具来帮助您调试它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:17:59.367

Woah. Classic example of 'divitis" waaaaay too many divs in the html at fiddle. You have a table inside a div and div's inside of table cells.

While that can work, why not just put id's on the td instead? Are you at the mercy of some CMS?

Also, I see this ID: fdContactName_1 twice just scanning over the code. ID should only appear once per page.

I suggest first copying all code, pasting it in at the validator: validator.w3.org/

Fix all errors and see if you can structure the content better. Right now, from the fiddle code there are 82 Errors, 45 warning(s). The warnings won't matter as much.

Even using something like table margin:0 0 30px 0; gets into trouble because of all those id's...the specificity is going to be a nightmare to get well-formed

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:46:29.440

答案很简单。你的表比包含它们的 div 大。尝试为您的表格设置宽度。编辑：实际上，删除其他 div 中的 div span5，因为您的表格应该调整为您的 div 的大小，并且它现在所在的 div 正在脱离您的其他 div。

此外，您还有太多无用的 div。就像凯利约翰逊所说的那样。td 中的单个 div 并不是很有用。与 span6 中的 span5 相同。

您必须将所有元素视为容器。Div 是一个用于样式设置和在页面周围放置内容的容器。基本上， div 是一个矩形。您不需要矩形内的矩形。如果您需要文本和 td 边之间的空间，请使用样式填充。

# xcode - Xcode 相当于 Eclipse 的“插入最佳猜测参数”是什么？

> ID：15668056
> 
> 赞同：2
> 
> 时间：2013-03-27T19:47:13.347
> 
> 标签：xcode, eclipse, preferences

在 Eclipse 中，您可以转到 Preferences > Java > Editor > Content Assist 并选择使用最佳猜测而不是参数名称自动填充参数。Xcode 中是否有类似的偏好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:23:07.947

Xcode 将自动尝试为您自动填充代码。例如，如果您正在编写带有 NSString 参数的东西，当您开始输入字母时，它将搜索可用的字符串。所以接受它，只需点击`<return>`。

但是，如果您的意思是您希望自动插入的代码不显示`doThis:<NSString*>` `andThat:<NSString*>`，而是尝试使用可能的 NSStrings 自动填充那些，那么不。Xcode 没有偏好。

# php - ZF2 从 EventManager 分离监听器

> ID：15668060
> 
> 赞同：1
> 
> 时间：2013-03-27T19:47:21.897
> 
> 标签：php, zend-framework2, listener

在实现一个新的 ZF2 应用程序时，我发现自己在 EventManager 上苦苦挣扎。在应用程序模块中，我创建了一个`AuthenticationListener`和一个`NotifierListener`. 第一个检查用户的正确身份验证，第二个显示发送给登录用户的自定义消息。

现在我正在创建一个新模块，用于分派要导出的 xml 文件。我想保留`AuthenticationListener`但分离`NotifierListener`以避免`E_NOTIFY`错误。问题是，在阅读了博客/源代码/文档（很差）并将我的头发拉出来之后，我无法理解如何分离上面提到的监听器。

### 应用模块.php

```
public function onBootstrap($e)
{
    $eventManager = $e->getApplication()->getEventManager();

    $authListener = new AuthenticationListener();
    $authListener->attach($eventManager);

    $notifyListener = new NotifyListener();
    $notifyListener->attach($eventManager);
} 
```

### 新模块.php

```
public function onBootstrap($e)
{
    $eventManager = $e->getApplication()->getEventManager();

    // ... $eventmanager->detach('NotifyListener');
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:27:40.430

答案是让你的听众成为服务

由于它不需要构造函数参数，因此它是可调用的，因此将其设置在 invokables 数组中

```
public function getServiceConfig()
{
    return array(
        'invokables' => array(
            'NotifyListener' => 'FQCN\To\NotifyListener',
        ),
    );
} 
```

从服务管理器中获取它，而不是直接在引导程序中创建新实例

```
public function onBootstrap($e)
{
    $eventManager = $e->getApplication()->getEventManager();

    $sm = $e->getApplication()->getServiceManager();

    $notifyListener = $sm->get('NotifyListener')
    $notifyListener->attach($eventManager);
} 
```

任何你想分离它的地方，你只需要能够访问 ServiceManager

```
 // in any ServiceLocator aware class
 $sm = $this->getServiceLocator();
 $eventManager = $sm->get('Application')->getEventManager();
 $notifyListener = $sm->get('NotifyListener');
 $notifyListener->detach($eventManager); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:29:38.910

你走在正确的道路上。您唯一需要做的就是调用`detach()`您的`NotifyListener`而不是`EvenManager`. 下面的示例来自 Zend Framework 手册`EventManager`。

链接： http: [//framework.zend.com/manual/2.0/en/modules/zend.event-manager.event-manager.html#examples](http://framework.zend.com/manual/2.0/en/modules/zend.event-manager.event-manager.html#examples)

```
use Zend\Cache\Cache;
use Zend\EventManager\EventCollection;
use Zend\EventManager\ListenerAggregateInterface;
use Zend\EventManager\EventInterface;

class CacheListener implements ListenerAggregateInterface
{
    protected $cache;

    protected $listeners = array();

    public function __construct(Cache $cache)
    {
        $this->cache = $cache;
    }

    public function attach(EventCollection $events)
    {
        $this->listeners[] = $events->attach('get.pre', array($this, 'load'), 100);
        $this->listeners[] = $events->attach('get.post', array($this, 'save'), -100);
    }

    public function detach(EventManagerInterface $events)
    {
        foreach ($this->listeners as $index => $listener) {
            if ($events->detach($listener)) {
                unset($this->listeners[$index]);
            }
        }
    }

    public function load(EventInterface $e)
    {
        // some code to load
    }

    public function save(EventInterface $e)
    {
        // some code to save 
    }
} 
```

这个例子很好地说明了如何准备一个监听器（例如`AuthenticationListener`）实现`ListenerAggregateInterface`。

`Module`假设与您的对象相同的情况：

```
public function onBootstrap($e)
{
    $eventManager = $e->getApplication()->getEventManager();
    $cacheListener = new CacheListener($cache);
    $cacheListener->detach($eventManager);
} 
```

因此，假设您的`NotifyListener`实现`ListenerAggregateInterface`或只是有一个`detach()`方法，您可以编写`onBootstrap()`方法来分离侦听器，如下所示：

```
public function onBootstrap($e)
{
    $eventManager = $e->getApplication()->getEventManager();
    $notifyListener = new NotifyListener();
    $notifyListener->detach($eventManager);
} 
```

希望这会有所帮助，反馈将不胜感激:)

斯托扬

# mysql - 用查询比较两个表的一致性（Mysql）

> ID：15668062
> 
> 赞同：0
> 
> 时间：2013-03-27T19:47:23.950
> 
> 标签：mysql, sql, database

我有 2 个数据库，一个用于操作，一个用于分析。

分析数据库与操作数据库不是 1:1 相同，但仍然非常相似。

现在我将存档文件 (csv) 加载到分析数据库中（之前它是空的）。

我在分析中有我的旧数据，在操作数据库中有我的当前数据。

我想写一个查询来查明一些新加载的记录是否已经在数据库中。

有没有办法检查这个？

编辑：

首先我很抱歉。查看我的数据库后犯了一个错误。我不需要比较两个不同的数据库，通过 phpmyadmin 复制操作数据库时，我忘记将当前数据加载到分析数据库中。所以我只需要比较一个数据库中的2个表，是否有一些旧记录已经在数据库中。

我的第一个想法是/是：

```
SELECT * 
FROM orderlinesold t1 
LEFT JOIN orderlines t2 on t1.orderid = t2.orderid; 
```

但是在运行该查询之后，我得到了孔行，这是不可能的——>错误的查询。

如何检查某些旧数据是否仍在新数据中？

PS：表格在评论中作为链接。

2.  编辑：

好的，我解决了。只是一个比较查询：

```
SELECT * 
FROM ordersold t1  
INNER JOIN orders t2 ON t1.orderid = t2.orderid 
LIMIT 100000000; 
```

或者：

```
SELECT * 
FROM orderlinesold t1 
LEFT JOIN orderlines t2 ON t1.orderid = t2.orderid 
WHERE t2.orderid IS NOT NULL 
LIMIT 100000000; 
```

两者都丢弃了正确的结果。

还是谢谢。这个帖子可以关了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:44:33.630

有一些工具可以帮助您比较两个数据库，但是假设您可以依靠主键来识别丢失的记录，您可以使用的基本技术是：

```
select    oo.id
from      operations.orders oo
left join analytics.orders ao 
on        oo.id = ao.id
where     ao.id is null 
```

# php - 使用 rsort() 对数组进行排序但保留标题

> ID：15668063
> 
> 赞同：0
> 
> 时间：2013-03-27T19:47:24.383
> 
> 标签：php

例如，如果我对这个数组进行排序：

```
$array = array(
    "cool"=>100,
    "lol"=>7,
    "wow"=>50
);

rsort($array); 
```

它删除数组键名：

```
$array = array(
    0=>100,
    1=>50
    2=>7,
); 
```

如何对数组名称进行排序和保留？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:49:06.940

arsort：[http ://www.php.net/manual/en/function.arsort.php](http://www.php.net/manual/en/function.arsort.php)

与您所拥有的相同，但 asort 和 arsort 保持索引关联。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:49:58.553

```
<?php
   $array = array(
        "cool"=>100,
        "lol"=>7,
        "wow"=>50
    );
arsort ($array);
print_r($array);
?>

   Array ( [cool] => 100 [wow] => 50 [lol] => 7 ) 
```

你可以找到更多的[数组排序函数](http://php.net/manual/en/array.sorting.php)

# java - java getter 重载

> ID：15668068
> 
> 赞同：1
> 
> 时间：2013-03-27T19:47:38.410
> 
> 标签：java

为什么我不能以下列方式重载 JTextField 类型的类成员：`

```
private JTextField m_oFilename=new JTextField();
    public JTextField filename()
        { return this.m_oFilename; }
    public String filename()
        { return this.m_oFilename.getText(); } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T19:48:53.590

在 Java 中，重载是指具有不同方法签名的同名方法。但是，返回类型*不是*方法签名的一部分。

编译器必须知道要解析哪种返回类型，如果方法签名相同，则无法区分它们或知道使用哪个，因此根据 JLS 8.4.2 ，[这是不允许的。](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.4.2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T19:50:59.450

因为它不使用方法的输出来确定它应该调用哪个方法。

例如，如果您刚刚执行，应该运行哪个方法：

```
m_oFilename.filename(); 
```

编译器不知道要运行哪个，因此无法编译。

# javascript - 概念 - 提炼承诺如何运作？

> ID：15668075
> 
> 赞同：12
> 
> 时间：2013-03-27T19:47:57.343
> 
> 标签：javascript

我查看了许多实现，它们看起来都非常不同，我无法真正提炼出 Promise 的本质是什么。

如果我不得不猜测它只是一个在回调触发时运行的函数。

有人可以在几行代码中实现最基本的承诺，而无需链接。

例如从这个[答案](https://stackoverflow.com/questions/15643450/designing-a-queue-system-for-asynchronous-resources)

**片段 1**

```
var a1 = getPromiseForAjaxResult(ressource1url);
a1.then(function(res) {
    append(res);
    return a2;
}); 
```

函数如何传递才能`then`知道何时运行。

也就是说，它是如何传递回 ajax 在完成时触发的回调代码的。

**片段 2**

```
// generic ajax call with configuration information and callback function
ajax(config_info, function() {
    // ajax completed, callback is firing.
}); 
```

这两个片段有什么关系？

**猜测：**

```
// how to implement this

(function () {
    var publik = {};
        _private;
    publik.then = function(func){
        _private = func;
    };
    publik.getPromise = function(func){
        // ??
    };
    // ??
}()) 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-27T19:55:44.247

从根本上说，promise 只是一个对象，它有一个标志，表明它是否已被解决，以及它维护的函数列表以通知它是否/何时被解决。代码有时可以说的不仅仅是文字，所以这里有一个**非常基本的、非真实世界的**示例，纯粹是为了帮助传达概念：

```
// See notes following the code for why this isn't real-world code
function Promise() {
    this.settled = false;
    this.settledValue = null;
    this.callbacks = [];
}
Promise.prototype.then = function(f) {
    if (this.settled) {
        f(this.settledValue);                // See notes 1 and 2
    } else {
        this.callbacks.push(f);
    }
                                             // See note 3 about `then`
                                             // needing a return value
};
Promise.prototype.settle = function(value) { // See notes 4 and 5
    var callback;

    if (!this.settled) {
        this.settled = true;
        this.settledValue = value;
        while (this.callbacks.length) {
            callback = this.callbacks.pop();
            callback(this.settledValue);      // See notes 1 and 2
        }
    }
}; 
```

所以`Promise`保存状态，以及当承诺完成时要调用的函数。*解决*承诺的行为通常在`Promise`对象本身之外（当然，这取决于实际使用，您可以将它们结合起来——例如，与 jQuery 的`ajax`[ `jqXHR`] 对象一样）。

同样，以上内容纯粹是概念性的，并且遗漏了一些重要的东西，这些东西必须存在于任何现实世界的 Promise 实现中才能使其有用：

1.  `then`并且`settle`应该*始终*异步调用回调，即使承诺已经解决。`then`应该因为否则调用者不知道回调是否是异步的。`settle`应该是因为回调不应该在 after`settle`返回之前运行。（ES2015 的 Promise 做到了这两件事。jQuery`Deferred`没有。）

2.  `then`并且`settle`应该确保回调中的失败（例如异常）不会直接传播到调用`then`或`settle`. 这与上面的#1 部分相关，与下面的#3 更相关。

3.  `then`应该根据调用回调的结果返回一个*新的承诺（然后，或以后）。*这对于组合 promise-ified 操作是相当基础的，但会使上述内容明显复杂化。任何合理的承诺实现都可以。

4.  我们需要不同类型的“解决”操作：“解决”（底层操作成功）和“拒绝”（失败）。一些用例可能有更多的状态，但解决和拒绝是基本的两个。（ES2015 的 promise 有 resolve 和 reject。）

5.  我们可能会以某种方式将`settle`（或单独的`resolve`and `reject`）设为私有，这样只有 Promise 的创建者才能解决它。（ES2015 承诺 - 以及其他几个承诺 - 通过让`Promise`构造函数接受一个接收`resolve`和`reject`作为参数值的回调来做到这一点，因此只有该回调中的代码可以解析或拒绝[除非回调中的代码以某种方式将它们公开]。）

等等等等。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-27T20:04:13.043

> 有人可以用几行代码实现最基本的承诺吗？

这里是：

```
function Promise(exec) {
    // takes a function as an argument that gets the fullfiller
    var callbacks = [], result;
    exec(function fulfill() {
        if (result) return;
        result = arguments;
        for (let c;c=callbacks.shift();)
            c.apply(null, arguments);
    });
    this.addCallback = function(c) {
        if (result)
            c.apply(null, result)
        else
            callbacks.push(c);
    }
} 
```

附加`then`链接（您需要[答案](https://stackoverflow.com/a/15643799/1048572)）：

```
Promise.prototype.then = function(fn) {
    return new Promise(fulfill => {
        this.addCallback((...args) => {
            const result = fn(...args);
            if (result instanceof Promise)
                result.addCallback(fulfill);
            else
                fulfill(result);
        });
    });
}; 
```

> 这两个片段有什么关系？

`ajax`从`getPromiseForAjaxResult`函数调用：

```
function getPromiseForAjaxResult(ressource) {
    return new Promise(function(callback) {
        ajax({url:ressource}, callback);
    });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-02-27T23:52:52.137

我已经在 ES7 中实现了一个。使用链接，它是 70 行，如果那算得少的话。我认为状态机是实现承诺的正确范例。生成的代码比许多`if`恕我直言更容易理解。[在这篇文章](https://hackernoon.com/implementing-javascript-promise-in-70-lines-of-code-b3592565af0f)中有充分的描述。

这是代码：

```
const states = {
    pending: 'Pending',
    resolved: 'Resolved',
    rejected: 'Rejected'
};

class Nancy {
    constructor(executor) {
        const tryCall = callback => Nancy.try(() => callback(this.value));
        const laterCalls = [];
        const callLater = getMember => callback => new Nancy(resolve => laterCalls.push(() => resolve(getMember()(callback))));
        const members = {
            [states.resolved]: {
                state: states.resolved,
                then: tryCall,
                catch: _ => this
            },
            [states.rejected]: {
                state: states.rejected,
                then: _ => this,
                catch: tryCall
            },
            [states.pending]: {
                state: states.pending,
                then: callLater(() => this.then),
                catch: callLater(() => this.catch)
            }
        };
        const changeState = state => Object.assign(this, members[state]);
        const apply = (value, state) => {
            if (this.state === states.pending) {
                this.value = value;
                changeState(state);
                for (const laterCall of laterCalls) {
                    laterCall();
                }
            }
        };

        const getCallback = state => value => {
            if (value instanceof Nancy && state === states.resolved) {
                value.then(value => apply(value, states.resolved));
                value.catch(value => apply(value, states.rejected));
            } else {
                apply(value, state);
            }
        };

        const resolve = getCallback(states.resolved);
        const reject = getCallback(states.rejected);
        changeState(states.pending);
        try {
            executor(resolve, reject);
        } catch (error) {
            reject(error);
        }
    }

    static resolve(value) {
        return new Nancy(resolve => resolve(value));
    }

    static reject(value) {
        return new Nancy((_, reject) => reject(value));
    }

    static try(callback) {
        return new Nancy(resolve => resolve(callback()));
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-25T16:38:49.067

这是一个轻量级的 Promise 实现，称为“序列”，我在日常工作中使用它：

```
(function() {
    sequence = (function() {
        var chained = [];
        var value;
        var error;

        var chain = function(func) {
            chained.push(func);
            return this;
        };

        var execute = function(index) {
            var callback;
            index = typeof index === "number" ? index : 0;

            if ( index >= chained.length ) {
                chained = [];
                return true;
            }

            callback = chained[index];

            callback({
                resolve: function(_value) {
                    value = _value;
                    execute(++index);
                },
                reject: function(_error) {
                    error = _error;
                    execute(++index);
                },
                response: {
                    value: value,
                    error: error
                }
            });
        };

        return {
            chain: chain,
            execute: execute
        };
    })();
})(); 
```

初始化后，您可以按以下方式使用序列：

```
sequence()
    .chain(function(seq) {
        setTimeout(function() {
            console.log("func A");
            seq.resolve();
        }, 2000);
    })
    .chain(function(seq) {
        setTimeout(function() {
            console.log("func B");
        }, 1000)
    })
    .execute() 
```

要启用实际的链接，您需要调用 seq 对象的 resolve() 函数，您的回调必须将其用作参数。

Sequence 公开了两个公共方法：

*   链 - 此方法只是将您的回调推送到私有数组
*   执行 - 此方法使用递归来启用回调的正确顺序执行。它基本上按照您通过将 seq 对象传递给每个回调的顺序来执行您的回调。一旦当前回调被解决/拒绝，就会执行下一个回调。

“执行”方法是魔法发生的地方。它将“seq”对象传递给所有回调。因此，当您调用 seq.resolve() 或 seq.reject() 时，您实际上会调用下一个链式回调。

请注意，此实现仅存储来自先前执行的回调的响应。

更多示例和文档，请参考： [https ://github.com/nevendyulgerov/sequence](https://github.com/nevendyulgerov/sequence)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-15T14:53:40.347

这是一个对我有用的简单 Promise 实现。

```
 function Promise(callback) {
        this._pending = [];
        this.PENDING = "pending";
        this.RESOLVED = "resolved";
        this.REJECTED = "rejected";
        this.PromiseState = this.PENDING;
        this._catch = function (error) {
            console.error(error);
        };
        setTimeout(function () {
            try {
                callback.call(this, this.resolve.bind(this), this.reject.bind(this));
            } catch (error) {
                this.reject(error);
            }
        }.bind(this), 0)
    };
    Promise.prototype.resolve = function (object) {
        if (this.PromiseState !== this.PENDING) return;
        while (this._pending.length > 0) {
            var callbacks = this._pending.shift();
            try {
                var resolve = callbacks.resolve;
                if (resolve instanceof Promise) {
                    resolve._pending = resolve._pending.concat(this._pending);
                    resolve._catch = this._catch;
                    resolve.resolve(object);
                    return resolve;
                }
                object = resolve.call(this, object);
                if (object instanceof Promise) {
                    object._pending = object._pending.concat(this._pending);
                    object._catch = this._catch;
                    return object;
                }
            } catch (error) {
                (callbacks.reject || this._catch).call(this, error);
                return;
            }
        }
        this.PromiseState = this.RESOLVED;
        return object;
    };
    Promise.prototype.reject = function (error) {
        if (this.PromiseState !== this.PENDING) return;
        this.PromiseState = this.REJECTED;
        try {
            this._catch(error);
        } catch (e) {
            console.error(error, e);
        }
    };
    Promise.prototype.then = function (onFulfilled, onRejected) {
        onFulfilled = onFulfilled || function (result) {
            return result;
        };
        this._catch = onRejected || this._catch;
        this._pending.push({resolve: onFulfilled, reject: onRejected});
        return this;
    };
    Promise.prototype.catch = function (onRejected) {
        // var onFulfilled = function (result) {
        //     return result;
        // };
        this._catch = onRejected || this._catch;
        // this._pending.push({resolve: onFulfilled, reject: onRejected});
        return this;
    };
    Promise.all = function (array) {
        return new Promise(function () {
            var self = this;
            var counter = 0;
            var finishResult = [];

            function success(item, index) {
                counter++;
                finishResult[index] = item;
                if (counter >= array.length) {
                    self.resolve(finishResult);
                }
            }
            for(var i in array) {
                var item = array[i];
                if (item instanceof Promise) {
                    item.then(function (result) {
                        success(result,this);
                    }.bind(i), function (error) {
                        array.map(function (item) {
                            item.PromiseState = Promise.REJECTED
                        });
                        self._catch(error);
                    })
                } else {
                    success(item, i);
                }
            }
        });
    };
    Promise.race = function (array) {
        return new Promise(function () {
            var self = this;
            var counter = 0;
            var finishResult = [];
            array.map(function (item) {
                if (item instanceof Promise) {
                    item.then(function (result) {
                        array.map(function (item) {
                            item.PromiseState = Promise.REJECTED
                        });
                        self.resolve(result);
                    }, function (error) {
                        array.map(function (item) {
                            item.PromiseState = Promise.REJECTED
                        });
                        self._catch(error);
                    })
                } else {
                    array.map(function (item) {
                        item.PromiseState = Promise.REJECTED
                    });
                    self.resolve(item);
                }
            })
        });
    };
    Promise.resolve = function (value) {
        return new Promise(function (resolve, reject) {
            try {
                resolve(value);
            } catch (error) {
                reject(error);
            }
        });
    };
    Promise.reject = function (error) {
        return new Promise(function (resolve, reject) {
            reject(error);
        });
    } 
```

[在这里](https://github.com/Edeqa/Promise/blob/master/Promise.js)讨论。小提琴：[在这里](http://jsfiddle.net/tujger/sp8d1guv/)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-11-18T10:49:28.650

这是承诺架构的绝对最小值

```
function Promise(F) {
  var gotoNext = false;
  var stack = [];
  var args = [];

  var isFunction = function(f) {
    return f && {}.toString.call(f) === '[object Function]';
  };

  var getArguments = function(self, _args) {
    var SLICE = Array.prototype.slice;

    _args = SLICE.call(_args);
    _args.push(self);

    return _args;
  };

  var callNext = function() {
    var method = stack.shift();

    gotoNext = false;
    if (isFunction(method)) method.apply(null, args);
  };

  var resolve = [(function loop() {
    if (stack.length) setTimeout(loop, 0);
    if (gotoNext) callNext();
  })];

  this.return = function() {
    gotoNext = true;
    args = getArguments(this, arguments);
    if(resolve.length) resolve.shift()();

    return this;
  };

  this.then = function(fn) {
    if (isFunction(fn)) stack.push(fn);

    return this;
  };

  return this.then(F).return();
}

// --- below is a working implementation --- //

var bar = function(p) {
  setTimeout(function() {
    console.log("1");
    p.return(2);
  }, 1000);
};

var foo = function(num, p) {
  setTimeout(function() {
    console.log(num);
    p.return(++num);
  }, 1000);
};

new Promise(bar)
  .then(foo)
  .then(foo)
  .then(foo);
```

# c++ - 可搜索的环形缓冲区

> ID：15668076
> 
> 赞同：3
> 
> 时间：2013-03-27T19:47:59.200
> 
> 标签：c++, boost, data-structures, stl, std

我想知道是否有人可以建议一个 c++ 数据结构，它具有环形缓冲区（保证有限存储）的能力，但同时允许对环形缓冲区进行有效的线程安全搜索以查找指定数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-25T08:55:47.130

英特尔[TBB 容器](http://software.intel.com/sites/products/documentation/doclib/tbb_sa/help/reference/containers_overview.htm)非常适合解决此类问题。

应该为你的`concurrent_unordered_map`情况做事，但如果你真的想要一些环结构，你可以使用`concurrent_bounded_queue`并自己推动来模拟环的行为（见下文）。但是，使用这种结构，您将获得线性搜索复杂性，而不是地图中的对数复杂性。

```
template<class T>
struct concurrent_ring : tbb::concurrent_bounded_queue<T>
{
    void push(const T& t) 
    {
        while(!tbb::concurrent_bounded_queue<T>::try_push(t)) 
           pop();
    }
} 
```

# php - 学说 2，插入具有关联的实体

> ID：15668077
> 
> 赞同：0
> 
> 时间：2013-03-27T19:47:59.280
> 
> 标签：php, zend-framework, doctrine

我有两个实体：

付款和公司。

支付实体与公司实体有关联，如下所示：

```
/**
* @OneToOne(targetEntity="Companies")
* @JoinColumn(name="company_id", referencedColumnName="id")
*/
private $total; 
```

为什么在插入时调用此关联？

我需要在付款表中设置一些东西（插入），但我遇到了错误。

```
Integrity constraint violation: 1048 Column 'company_id' cannot be null 
```

欢迎任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:58:39.917

您需要先获取（或创建）您的 $company 实体，然后在保存之前将其交给 $payment。就像是：

```
// First get the company that should be related to the new payment    
$company = $entityManager->getRepository('Company')->find($companyId);

// Attach it to our new payment
$payment->setCompany($company); // Or whatever the setter is in your entity class

// Now we can save
$entityManager->persist($payment);
$entityManager->flush(); 
```

# python - 如何将自由格式标签添加到 CKAN 包中？

> ID：15668083
> 
> 赞同：1
> 
> 时间：2013-03-27T19:48:13.513
> 
> 标签：python, tags, action, ckan

我试图弄清楚如何以编程方式将自由格式（无词汇）标签添加到包中，我发现文档有点混乱。

来自[http://docs.ckan.org/en/latest/ckan.logic.action.create.html](http://docs.ckan.org/en/latest/ckan.logic.action.create.html) `package_create`说我可以添加标签并“查看标签字典格式的 tag_create()”

`tag_create`说“要创建一个新的免费标签，只需将标签添加到包中，例如使用 package_update 功能”

来自[http://docs.ckan.org/en/latest/ckan.logic.action.update.html](http://docs.ckan.org/en/latest/ckan.logic.action.update.html) `package_update`并没有真正指定如何使用它，所以我尝试了：

```
package_update({"id": "my-package-id", "tags": [ "some", "free", "tags"]}) 
```

然而，它抱怨它需要字典格式的标签，因为我会用它来指定作为词汇表一部分的标签。如何指定免费标签？

此外，一旦我输入标签，访问标签的最佳方式是什么？我遇到了`my_package.package_tags`包含标签但`my_package.get_tags()`返回空列表的情况？

非常感谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:15:20.300

您可以简单地通过执行 package_create() 或 package_update() 并指定一个尚不存在的标签来创建一个新标签，我认为（猜测）“tags”参数的正确格式为 package_create() 或 package_update( ） 应该：

```
"tags": [{"name": "my_tag"}, {"name": "my-other-tag"}] 
```

但是您必须对此进行测试。

> 然而，它抱怨它需要字典格式的标签，因为我会用它来指定作为词汇表一部分的标签。如何指定免费标签？

如上所述，字典格式与 vocab 标签相同，但只有“name”键，没有“vocabulary_id”。

> 此外，一旦我输入标签，访问标签的最佳方式是什么？我遇到了 my_package.package_tags 包含标签的情况，但 my_package.get_tags() 返回了一个空列表？

使用动作函数：package_show()、tag_list()、tag_show() 等。

如果您正在编写 CKAN 扩展并且您不想通过发出 HTTP 请求来调用 CKAN 的操作函数，那么您应该使用“插件工具包”与 CKAN 进行交互，其中包括一种调用操作函数的方法，如下所示：

```
import ckan.plugins.toolkit as tk
my_package = tk.get_action('package_show')({'id': 'my_package'}) 
```

您会在工具包中找到许多其他有用的东西。

# python - 如何将 ImageMagick 命令转换为 Wand (Python)？

> ID：15668085
> 
> 赞同：2
> 
> 时间：2013-03-27T19:48:21.687
> 
> 标签：python, magickwand, wand

我正在尝试将程序移至 Python，如果这依赖于我使用 ImageMagick 处理一些图像的 shell 脚本，则部分原因是。我已经安装了 wand，它是基于 ctypes 的 Python ImageMagick 绑定，但我不知道如何翻译我的原始代码。

这是使用 CONVERT 和 OPTIMIZE 的命令行代码。

`convert -delay $theDelay /path/to/images/$theDateStamp*.png -layers optimize -write /path/to/animationFolder/NewAnimatedGIFfile-$theDateStamp.gif -delete 1--1 -resize 200x200 /path/to/animationFolder/NewStaticGIFthumb-$theDateStamp-t.gif`

基本上，该脚本会转到一个文件夹，在该文件夹中我下载了带有时间戳的图像，并创建了一个动画 GIF，其中仅包含那些满足时间戳要求的图像；将其保存到动画文件夹；然后它通过删除帧、调整大小并将单个 gif 图像保存到同一文件夹中创建该动画 gif 的缩略图，并在名称中添加“-t”。

# r - 描述 Hmisc 和 prettyR 中的函数 - 掩蔽问题

> ID：15668086
> 
> 赞同：1
> 
> 时间：2013-03-27T19:48:25.517
> 
> 标签：r, packages, masking

我喜欢**prettyR** `describe`函数的各个方面和**Hmisc** `describe`函数的各个方面。当两个包都被加载时，**prettyR 会** `describe`屏蔽**Hmisc** `describe`。我环顾四周，发现代码如：

```
Hmisc::describe(flu$nprloc3) 
```

据说会使 Hmisc 描述优先。我已经尝试过了，但我似乎仍然得到了 prettyR 输出。我做错什么了吗？我还试图找到一种方法来从我的全局环境中卸载 prettyR 包（但不卸载它），但没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:55:57.930

`Hmisc::describe`是通用的，可能需要由特定的类扩展调用。

```
 methods(describe)
#[1] describe.data.frame describe.default    describe.formula    describe.matrix    
#[5] describe.vector 
```

尝试：

```
Hmisc::describe.vector(1:10) 
```

（我不确定这应该是正在发生的事情，它仍然可能是如何构建这些包中的一个或两个包的问题。我在这里提名 prettyR 作为可能的罪犯，因为 prettyR::describe 不是通用的，并且它似乎削弱了通用调度以使 Hmisc::describe 无法正常工作）

# padding - 如何处理在div底部添加填充的行高

> ID：15668090
> 
> 赞同：3
> 
> 时间：2013-03-27T19:48:42.080
> 
> 标签：padding, css

我有一个网站，我的`<div>`s 可以扩展为包含图像和标题。到目前为止，我所做的是创建这样的层次结构：

```
<div class="thumb">
    <img src="image_url"/>
    <div id="title">title</div>
</div> 
```

然后像这样定位标题：

```
#title{
    position: absolute;
    bottom: 0;
    left: 0;
} 
```

但标题`<div>`位于图像的底线下方。我试图减少`line-height`div 中的 ，这解决了文本悬挂在图像上的问题，但弄乱了文本填充。有谁知道我应该如何以不同的方式将标题以“正确”的方式放置在图像的右下角？

这是问题的一个jsfiddle：

[http://jsfiddle.net/BUpmr/3](http://jsfiddle.net/BUpmr/3)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:00:49.530

默认情况下，图像是内联的，这意味着它们为字符的后代留出了空间。

[http://jsfiddle.net/BUpmr/10/](http://jsfiddle.net/BUpmr/10/)

```
img {display: block} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:16:44.880

You're using position: absolute and that takes elements out of the document flow. In this case you want the image and the text element both to take up space, so use `position: relative` instead.

[http://jsfiddle.net/BUpmr/13/](http://jsfiddle.net/BUpmr/13/)

1.  Remove the `position: absolute;` from the body in the css
2.  In #title change `position: absolute` to `position: relative;`
3.  Add `width:600px` to the elements (because the image is 600px wide) (or make the width on `#title` smaller (say 550px) to put the text slightly more to the left.
4.  add `text-align: right` to `#title` to get the text to in the right corner
5.  add .thumb img {display:block;}

CSS:

```
 body {
        background-color: #eef;
        padding: 0px;
        margin: 0px;
    }

    #title{
        position: relative;
        text-align:right;
        width:550px;
        bottom: 0;
        right: 0;
        background-color: #0f0;
        padding: 0px 4px 0px 4px;
    }

    .thumb{
        background-color: #f00;
            width:600px;
    }

   .thumb img {display:block;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T19:52:50.300

如果您知道要从底部向上移动多少像素，则可以这样做：

```
#title
{
    position: absolute;
    right: 0px;
    bottom: 5px;
    background-color: #0f0;
    padding: 0px 4px 0px 4px;
} 
```

[http://jsfiddle.net/BUpmr/12/](http://jsfiddle.net/BUpmr/12/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T19:56:20.850

底部空间的原因不是行高，而是浏览器试图将图像的底部与文本的基线对齐。

要修复它，`vertical-align: top`请在图像上设置：http: [//jsfiddle.net/VRyCF/2](http://jsfiddle.net/VRyCF/2)

# grails - Grails 一对多，限制返回的孩子

> ID：15668092
> 
> 赞同：2
> 
> 时间：2013-03-27T19:48:49.000
> 
> 标签：grails, grails-orm, one-to-many

所以我有两个类，它们之间有一对多的联系......

```
class A {
   static hasMany = {bs: B}
}

class B {
   String name
} 
```

现在我创建一个对象 A 并将 100 个 B 对象添加到它的列表中......

现在，当我调用 A.get(1) 并访问 Bs 时，它会将所有 100 个对象加载到内存中。我想将此限制为 10 个 B 对象，并让另一种方法返回下一个 10，依此类推。

有没有一种简单的方法可以做到这一点？到目前为止，我看到的唯一方法是永远不要直接访问 B 对象并拥有一个获取它们的辅助方法。

所以我正在寻找的是为一对多关联寻呼

谢谢克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:02:05.513

您可以在块中[`batchSize`](http://grails.org/doc/latest/ref/Database%20Mapping/batchSize.html)为您配置。`hasMany``mappings`

```
static mapping = {
    bs batchSize: 10
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T07:56:08.560

您可以为此使用标准参数属性，这些通常用于获取分页结果集。查看有关如何使用它们的列表方法

*   params.min ~ 要列出的最小数量
*   params.max ~ 要列出的最大数量
*   params.offset ~ 要列出的第一个结果的偏移量

在这里查看更多信息：http: [//grails.org/doc/2.2.0/ref/Domain%20Classes/list.html](http://grails.org/doc/2.2.0/ref/Domain%20Classes/list.html)

# ruby-on-rails - 如何在 Rails 4 中更改 HTTP 标头，例如 X-UA-Compatible？

> ID：15668096
> 
> 赞同：2
> 
> 时间：2013-03-27T19:48:56.233
> 
> 标签：ruby-on-rails, http-headers, rack, ruby-on-rails-4

Rails 4 预填充了一些“最佳实践”HTTP 标头：

```
$ http -j "http://127.0.0.1:3000"
(...)
HTTP/1.1 204 No Content
(...)
X-Content-Type-Options: nosniff
X-Frame-Options: SAMEORIGIN
X-UA-Compatible: chrome=1
X-XSS-Protection: 1; mode=block 
```

如何在 Rails 4 中更改这些标题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T19:48:56.233

为了禁用（或更改）它，将以下行添加到您的`config/application.rb`：

```
config.action_dispatch.default_headers = {
  'X-Frame-Options' => 'DENY',
  'X-UA-Compatible' => 'IE=EmulateIE7'
} 
```

# javascript - jQuery图像缩放

> ID：15668103
> 
> 赞同：0
> 
> 时间：2013-03-27T19:49:12.270
> 
> 标签：javascript, jquery

您好，我正在使用脚本在悬停时放大图像，但是它从左上角放大，我需要它从中心悬停，我无法弄清楚如何将 css 添加到 jquery 中以添加负边距所以它去我想要的方式，这里是脚本。

```
$('#sun').width();
$('#sun').mouseover(function(){
    $(this).css("cursor","pointer");
    $(this).animate({width: "7%"}, 'slow');
});
$('#sun').mouseout(function(){
    $(this).animate({width: "6%"}, 'slow');
}); 
```

我只想要css中的“margin wxy z”但无法得到它：/任何人都可以提供帮助？谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:58:22.780

如果图像是绝对定位的，你可以这样做[http://jsfiddle.net/8wGtp/](http://jsfiddle.net/8wGtp/)。

```
$('#resize').on({
    mouseenter: function(){
        $(this).animate({width: '130px', height: '130px', top: '-=15px', left: '-=15px'}, 500);
    },
    mouseleave: function(){
        $(this).animate({width: '100px', height: '100px', top: '+=15px', left: '+=15px'}, 500);
    }
}); 
```

# erlang - 如何从 shell 执行 Erlang 模块的功能？

> ID：15668105
> 
> 赞同：3
> 
> 时间：2013-03-27T19:49:21.267
> 
> 标签：erlang, erlang-shell

我有一个新手问题。我正在阅读《Erlang Programming》一书，并在每一章之后进行练习。

在我有一个`db.erl`模块的情况下，我在其中放置了几个功能用于几个练习。在玩了几天练习之后，我已经厌倦了在`erl`shell 中重复“编译->执行练习功能”操作。假设我正在处理模块`new()`中的功能`db.erl`；每次修改此功能后，我都被迫执行以下操作`erl`：

```
c(db.erl).
db:new(). 
```

一次又一次。有时我忘记重新加载我的模块，结果令人困惑。我可以使用：通过 OS shell 编译/加载 `erl -compile file.erl; erl -make`，但我没有找到从特定模块运行特定功能的方法。有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T21:50:19.203

您可以使用`-eval`选项：

```
$ erl -eval 'io:format("printing ~p~n", [{any, term}]), init:stop()' -noshell
printing {any,term} 
```

在此处阅读文档：[http ://www.erlang.org/doc/man/erl.html](http://www.erlang.org/doc/man/erl.html)

您可以只使用`erlc`编译文件：[http ://erlang.org/doc/man/erlc.html](http://erlang.org/doc/man/erlc.html)

# android - 在代码中打开 Android Gallery 的可靠方法是什么？

> ID：15668107
> 
> 赞同：2
> 
> 时间：2013-03-27T19:49:30.587
> 
> 标签：android, android-intent

我目前有以下内容：

```
Intent intent = new Intent(Intent.ACTION_VIEW, android.provider.MediaStore.Video.Media.EXTERNAL_CONTENT_URI);
startActivity(intent); 
```

它在大多数情况下都能完美运行，但至少对于 Android 2.3.4 设备会产生以下异常：

```
android.content.ActivityNotFoundException: No Activity found to handle Intent { act=android.intent.action.VIEW dat=content://media/external/video/media } 
```

任何人都可以分享在 Android 设备上打开图库的通用方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T19:59:04.983

如果您正在谈论打开图片库，可以使用以下内容从 SD 卡中选择图像：

```
Intent intent = new Intent(Intent.ACTION_GET_CONTENT);
intent.setType("image/*");
intent.putExtra(Intent.EXTRA_LOCAL_ONLY, true);//only local images
startActivityForResult(intent, IMAGE_PICK_ADD); 
```

# ruby-on-rails - 在 Rails 3 如何解析 ISO8601 日期字符串以获取 TimeWithZone 实例？

> ID：15668111
> 
> 赞同：5
> 
> 时间：2013-03-27T19:49:45.083
> 
> 标签：ruby-on-rails, date, timezone, iso8601

这是我的解决方案。有没有更紧凑的？

```
> time_from_client = "2001-03-30T19:00:00-05:00"
 => "2001-03-30T19:00:00-05:00" 

> time_from_client.to_datetime
 => Fri, 30 Mar 2001 19:00:00 -0500 

> timezone_offset = time_from_client.to_datetime.offset.numerator
 => -5 

> tz = ActiveSupport::TimeZone[timezone_offset]
 => (GMT-05:00) America/New_York

> tz.class
=> ActiveSupport::TimeZone 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-17T17:21:07.853

不幸的是，这是不可能的，至少在没有变得更聪明的情况下是不可能的。

要了解为什么必须区分*时区*和*UTC 偏移量*：

*   时区是指[地球上的一个特定区域](https://en.wikipedia.org/wiki/Time_zone)，并且可以选择有[一段时间的 DST](https://en.wikipedia.org/wiki/Daylight_saving_time)。
*   [UTC 偏移量仅给出给定时间与 UTC 偏移的持续](https://en.wikipedia.org/wiki/Offsets_from_UTC)时间。

考虑从区域映射到偏移：您还必须知道所讨论的时间以及区域，以便决定是应用标准偏移还是日光偏移。

走另一条路要困难得多。再一次只有偏移量是不够的，因为我们不知道该偏移量是指标准时间还是夏令时。但是这次我们遇到了一个先有鸡还是先有蛋的问题：即使我们也有时间，我们也需要知道该区域，以便查看该时间是标准时间还是白天时间。但是，我们没有区域。

* * *

这是您的一个工作示例，您正在使用`Fri, 30 Mar 2001 19:00:00`，恰好是标准时间（EST），因此乍一看它看起来不错：

```
> time_from_client = "2001-03-30T19:00:00-05:00"
 => "2001-03-30T19:00:00-05:00" 

> time_from_client.to_datetime
 => Fri, 30 Mar 2001 19:00:00 -0500 

> timezone_offset = time_from_client.to_datetime.offset.numerator
 => -5 

> tz = ActiveSupport::TimeZone[timezone_offset]
 => (GMT-05:00) America/New_York 
```

我们有`America/New_York`.

* * *

但是看看如果我们跳到夏令时会发生什么，比如说，`30 Jun 2001 19:00:00`。`time_from_client`您现在的偏移量部分是`-04:00`，这是纽约 (EDT) 的夏令时偏移量。

```
> time_from_client = "2001-03-30T19:00:00-4:00"
 => "2001-06-30T19:00:00-05:00" 

> time_from_client.to_datetime
 => Fri, 30 Jun 2001 19:00:00 -0400 
```

免责声明：下一步实际上不起作用，因为`numerator`将四舍五入`4/24`到`1/6`，你会得到一个不正确`timezone_offset`的`1`。因此，我调整了您的实现并使用了`utc_offset`.

```
> timezone_offset = time_from_client.to_datetime.utc_offset
 => -14400

> tz = ActiveSupport::TimeZone[timezone_offset]
 => (GMT-04:00) Atlantic Time (Canada) 
```

现在可以看到问题，而不是让`America/New_York`我们得到`Atlantic Time (Canada)`. 后者是标准 offset 的区域名称之一*，*`-04:00`因为 的[实现`ActiveSupport::TimeZone[]`](http://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html#method-c-5B-5D)只能使用标准 find `utc_offset`，并且不知道日光。

如果你按照这个得出结论，你最终会得到以下反直觉的结果`parse`：

```
> tz.parse "2001-06-30T19:00:00-04:00"
 => Sat, 30 Jun 2001 20:00:00 ADT -03:00 
```

我假设这里发生的是`TimeWithZone`看到这是六月，因此调整到大西洋日光偏移，`-03:00`.

* * *

值得注意的是，即使您可以考虑日光，并获得传递给的*标准*`ActiveSupport::TimeZone[]`偏移量，您仍然没有正确的区域，因为区域映射的偏移量不是一对一的。

如此处所示：

```
ActiveSupport::TimeZone.all.select { |z| z.utc_offset == -14400 }
=> [(GMT-04:00) Atlantic Time (Canada), (GMT-04:00) Georgetown, (GMT-04:00) La Paz, (GMT-04:00) Santiago] 
```

这是我认为这是不可能的原因，除非您也碰巧拥有原始 ISO 8601 字符串的位置信息。

顺便说一句，如果您采用这种方法，我推荐[tzwhere](https://github.com/mattbornski/tzwhere) Node.js 库，它可以使用区域几何来执行区域查找。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T23:59:58.793

查看. [_](http://api.rubyonrails.org/classes/ActiveSupport/TimeWithZone.html) _ `ActiveSupport::TimeWithZone`简短回答：使用`Time.parse(time_string).in_time_zone`：

```
[9] pry(main)> Time.parse("2001-03-30T19:00:00-05:00")
=> 2001-03-30 19:00:00 -0500
[10] pry(main)> Time.parse("2001-03-30T19:00:00-05:00").class
=> Time
[11] pry(main)> Time.parse("2001-03-30T19:00:00-05:00").in_time_zone
=> Sat, 31 Mar 2001 00:00:00 UTC +00:00
[12] pry(main)> Time.parse("2001-03-30T19:00:00-05:00").in_time_zone.class
=> ActiveSupport::TimeWithZone 
```

如果你想在另一个时区：

```
[13] pry(main)> Time.parse("2001-03-30T19:00:00-05:00").in_time_zone("America/Los_Angeles")
=> Fri, 30 Mar 2001 16:00:00 PST -08:00 
```

# perl - Perl：用foreach循环替换文本行中的多个字符串并替换

> ID：15668113
> 
> 赞同：0
> 
> 时间：2013-03-27T19:49:48.647
> 
> 标签：perl, foreach, substitution

这是我的目标：

1.  查找特定文件并保存

    a) 文件夹名

    b) 带有完整路径的文件名

2.  对于每个文件，使用文件名和文件夹名替换文件中的两个文本字符串，并将结果写入数组（稍后写入文件）

但我显然遗漏了一些东西，因为我的 foreach 循环不起作用。

```
use strict;
use warnings;
use diagnostics;
use File::Find::Rule;
use File::Spec;
use File::Basename;
use Cwd;
my $dir = cwd;
my $command_template = 'Here is my Filepath: file and this is the Folderpath: folder';
my $search_file = 'test.txt';
my @files = File::Find::Rule->file()
                ->name($search_file)
                #->maxdepth(2)
                ->in($dir);
my @command_files;
foreach (@files){
    my $directories = dirname ($_);
    $command_template =~ s/file/$_/g;
    $command_template =~ s/folder/$directories/g;
    push(@command_files,$command_template,"\n");
}
print "@command_files";
open COMMAND_FILES, '>command_files.txt' or die "Can't open COMMAND_FILES: $!\n";
print COMMAND_FILES @command_files; 
```

问题在这里：

```
foreach (@files){
        my $directories = dirname ($_);
        $command_template =~ s/filepath/$_/g;
        $command_template =~ s/folder/$directories/g;
        push(@command_files,$command_template,"\n");
    } 
```

如果我设置

```
@files = qw/ c:\1\test.txt c:\2\test.txt c:\2\1\test.txt /; 
```

但所有内容都写入@command_files：

```
Here is my Filepath: c:\1\test.txt and this is the Folderpath: c:\1
Here is my Filepath: c:\1\test.txt and this is the Folderpath: c:\1
Here is my Filepath: c:\1\test.txt and this is the Folderpath: c:\1 
```

我想：

```
Here is my Filepath: c:\1\test.txt and this is the Folderpath: c:\1
Here is my Filepath: c:\2\test.txt and this is the Folderpath: c:\2
Here is my Filepath: c:\2\1\test.txt and this is the Folderpath: c:\2\1 
```

为什么 foreach 循环只在数组@files 中引入第一个内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:58:49.580

`$command_template`你用你的替换来修改。第二次通过循环它不匹配。

在循环内部制作副本，`$command_template`然后执行`$copy =~ s/filepath/$_/g`.

# python - Alembic：如何在模型中迁移自定义类型？

> ID：15668115
> 
> 赞同：11
> 
> 时间：2013-03-27T19:49:50.790
> 
> 标签：python, sqlalchemy, flask-sqlalchemy, alembic

我的`User`模型是

```
class User(UserMixin, db.Model):
    __tablename__ = 'users'
    # noinspection PyShadowingBuiltins
    uuid = Column('uuid', GUID(), default=uuid.uuid4, primary_key=True,
                  unique=True)
    email = Column('email', String, nullable=False, unique=True)
    _password = Column('password', String, nullable=False)
    created_on = Column('created_on', sa.types.DateTime(timezone=True),
                        default=datetime.utcnow())
    last_login = Column('last_login', sa.types.DateTime(timezone=True),
                        onupdate=datetime.utcnow()) 
```

where`GUID`是[sqlalchemy 文档](http://docs.sqlalchemy.org/en/rel_0_8/core/types.html#backend-agnostic-guid-type)中描述的自定义类型（完全相同）

现在当我跑

```
alembic revision --autogenerate -m "Added initial table" 
```

我得到我`upgrade()`的

```
def upgrade():
    ### commands auto generated by Alembic - please adjust! ###
    op.create_table('users',
    sa.Column('uuid', sa.GUID(), nullable=False),
    sa.Column('email', sa.String(), nullable=False),
    sa.Column('password', sa.String(), nullable=False),
    sa.Column('created_on', sa.DateTime(timezone=True), nullable=True),
    sa.Column('last_login', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('uuid'),
    sa.UniqueConstraint('email'),
    sa.UniqueConstraint('uuid')
    )
    ### end Alembic commands ### 
```

但是在应用 upgrade -> 期间`alembic upgrade head`，我看到了

```
File "alembic/versions/49cc74d0da9d_added_initial_table.py", line 20, in upgrade
    sa.Column('uuid', sa.GUID(), nullable=False),
AttributeError: 'module' object has no attribute 'GUID' 
```

我怎样才能让它`GUID`在这里与 /custom 类型一起工作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-27T20:44:42.457

您可以根据方言替换`sa.GUID()`为`sa.CHAR(32)`or `UUID()`（在添加 import line 之后）。`from sqlalchemy.dialects.postgresql import UUID`

将其替换为`GUID()`（在添加 import 行之后`from your.models.custom_types import GUID`）也可以，但是升级脚本与您的模型代码相关联，这可能不是一件好事。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-13T11:29:26.750

我有一个类似的问题并解决如下：

假设您有以下模块`my_guid`，其中包含（来自您已经引用的页面，稍作命名修改）：

```
import uuid as uuid_package
from sqlalchemy.dialects.postgresql import UUID as PG_UUID
from sqlalchemy import TypeDecorator, CHAR

class GUID(TypeDecorator):
    impl = CHAR

    def load_dialect_impl(self, dialect):
        if dialect.name == 'postgresql':
            return dialect.type_descriptor(PG_UUID())
        else:
            return dialect.type_descriptor(CHAR(32))

    def process_bind_param(self, value, dialect):
        if value is None:
            return value
        elif dialect.name == 'postgresql':
            return str(value)
        else:
            if not isinstance(value, uuid_package.UUID):
                return "%.32x" % uuid_package.UUID(value)
            else:
                # hexstring
                return "%.32x" % value

    def process_result_value(self, value, dialect):
        if value is None:
            return value
        else:
            return uuid_package.UUID(value) 
```

如果您在模型中使用此 GUID，则只需在以下位置添加三行`alembic/env.py`：

```
from my_guid import GUID
import sqlalchemy as sa
sa.GUID = GUID 
```

这对我有用。希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-11T19:45:11.083

我的解决方案使用，如果您在没有类型的数据库上`sqlalchemy_utils.types.uuid.UUIDType`，它使用`CHAR(32)`或表示 UUID。您需要在迁移中考虑到这一点，它必须在没有类型的数据库上创建一个并在有它的数据库上创建一个。`BINARY(16)``UUID``CHAR(32)/BINARY(16)``UUID``UUIDType`

我的 SQLAlchemy 类如下所示：

```
from sqlalchemy_utils.types.uuid import UUIDType
from sqlalchemy import CHAR, Column, Integer

Base = declarative_base()

def get_uuid():
    return str(uuid.uuid4())

class Dashboard(Base):
    __tablename__ = 'dashboards'
    id = Column(Integer, primary_key=True)
    uuid = Column(UUIDType(binary=False), default=get_uuid) 
```

实际的批处理操作如下所示（支持 SQLite、MySQL 和 Postgres）：

```
from superset import db # Sets up a SQLAlchemy connection

def upgrade():
    bind = op.get_bind()
    session = db.Session(bind=bind)
    db_type = session.bind.dialect.name

    def add_uuid_column(col_name, _type):
        """Add a uuid column to a given table"""
        with op.batch_alter_table(col_name) as batch_op:
            batch_op.add_column(Column('uuid', UUIDType(binary=False), default=get_uuid))
        for s in session.query(_type):
            s.uuid = get_uuid()
            session.merge(s)

        if db_type != 'postgresql':
            with op.batch_alter_table(col_name) as batch_op:
                batch_op.alter_column('uuid', existing_type=CHAR(32),
                                      new_column_name='uuid', nullable=False)
                batch_op.create_unique_constraint('uq_uuid', ['uuid'])

        session.commit()

add_uuid_column('dashboards', Dashboard)
session.close() 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-08-10T15:44:44.247

跟进[@Red-Tune-84的解决方案](https://stackoverflow.com/a/43810638/11372523)

```
class GUID(types.TypeDecorator)
  impl = CHAR

  def __repr__(self):
    return self.impl.__repr__()

  # You type logic here. 
```

确实有效，但您可能需要并行设置`env.py`配置`user_module_prefix`。

例如，使用`context.configure(..., user_module_prefix="sa.")`，上面的类型将出现`sa.CHAR(...)`在 alembic 迁移中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-10-21T18:34:07.393

**简短回答**（使用 sqlalchemy 版本`1.4.25`）：

从[文档](https://alembic.sqlalchemy.org/en/latest/autogenerate.html#controlling-the-module-prefix)中：

> 对于用户定义的类型，即不在 sqlalchemy 中的任何自定义类型。模块命名空间，默认情况下，Alembic 将使用 __module__ 的值作为自定义类型：
> 
> ```
> Column("my_column", myapp.models.utils.types.MyCustomType()) 
> ```
> 
> 上述类型的导入必须再次出现在迁移中，要么手动，要么通过将其添加到 script.py.mako。

因此，导入您的`my_module`in `script.py.mako`（并且您可能需要在 以外的文件中定义您的自定义类型`models.py`）：

```
...
from alembic import op
import sqlalchemy as sa
import my_module
${imports if imports else ""}
... 
```

**长答案**：

我在其中`BinaryUUID`定义了我的自定义类型，`uuid_type_mysql.py`并将其导入并在`models.py`那里使用它：

`models.py`：

```
...
from .uuid_type_mysql import BinaryUUID
... 
```

生成迁移后，`flask db migrate`我会在迁移文件中得到这个：

```
...
sa.Column('public_id', my_module.uuid_type_mysql.BinaryUUID(length=16), nullable=False),
... 
```

问题是迁移不知道`my_module`，因为它没有导入。

`import my_module`按照文档中的建议添加后`script.py.mako`，现在模块已导入迁移文件中：

```
...
from alembic import op
import sqlalchemy as sa
import my_module
... 
```

在此之后，对我来说一切都很好，而且不需要手动编辑生成的迁移。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-05T17:23:07.510

使用属性类的`__repr__`功能对我来说适用于大多数自定义类型。`impl`我发现将迁移定义包含在类中更干净，而不是担心将导入放在你的`env.py`or`scripts.py.mako`中。此外，它还可以轻松地在模块之间移动代码。

```
Class GUID(types.TypeDecorator)
    impl = CHAR

    def __repr__(self):
        return self.impl.__repr__()

    # You type logic here. 
```

自动迁移将产生`CHAR(length=XXX)`.

# google-chrome - EXTJS - 当我在 EXTJS 中禁用组件时会发生什么？

> ID：15668118
> 
> 赞同：0
> 
> 时间：2013-03-27T19:50:00.303
> 
> 标签：google-chrome, extjs, browser

我想知道我是否使用 .setDisabled(true) 将 EXTJS 应用程序中的组件（即组合框）状态从启用更改为禁用。

幕后究竟发生了什么？是仅仅改变了这个组件的 CSS 还是真的改变了组件的行为？

我问这个是因为我担心安全性，用户是否可以简单地在浏览器中查看源代码并将组件的属性更改回启用？会是这样吗？

如何避免用户更改组件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:59:50.970

在客户端禁用任何 extjs 组件，您只需更改 UI 的表示和行为。您应该始终在服务器端进行所有安全检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T21:18:03.233

`setDisabled(true)`将 disabled 属性添加到 HTML 元素。

这意味着如果/当表单被 POST 回服务器时，该控件的值将不包括在内。它还会改变控件的行为，它会变得不可用和不可点击，并且默认情况下，禁用的控件会被 Web 浏览器呈现为灰色。

我相信默认情况下，ExtJS 也会`x-disabled`向组件添加一个 css 类，然后您可以将其用于样式目的。

如上所述，在客户端实现的任何安全性也应该在服务器端进行检查。任何人都可以使用 IE 开发工具、FireBug 等来更改 HTML 元素的值，这将绕过您在客户端上设置的任何安全规则。

# html - 链接到 Google Apps 脚本中的另一个 HTML 页面

> ID：15668119
> 
> 赞同：24
> 
> 时间：2013-03-27T19:50:03.720
> 
> 标签：html, google-apps-script, web-applications

从 ScriptDbConsole.html 链接到 legend.html 时，我收到以下错误消息：

> 抱歉，您请求的文件不存在。请检查地址，然后再试一次。

这通常可以在正常环境中工作，但我猜不是在这里。它在 script.google.com 中。

在 script.google.com 项目中创建一个新的 .html 文件时，它会在与其他项目相同的位置创建它，所以这段代码实际上应该可以正常工作吗？如何从 ScriptDbConsole.html 打开 legend.html？

```
<a href='legend.html' target='_blank'>Open in new window</a> 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-05-22T16:56:49.273

虽然 HtmlService 允许您提供 HTML，但它不是“托管”页面，您无法通过 URL 直接访问 Apps 脚本项目中的各种 html 文件。相反，您的 Web 应用程序在发布时会有一个 URL，这是您唯一拥有的 URL。

这是一种方法，您可以从脚本中提供单独的页面，并让它们的行为类似于 html 文件链接。

该`doGet()`函数在调用时会传递一个事件，我们可以利用它来指示我们想要提供哪个页面。如果我们的 Web App ID 是`<SCRIPTURL>`，则 URL 加上请求特定页面的查询字符串如下所示：

```
https://script.google.com/macros/s/<SCRIPTURL>/dev?page=my1 
```

使用模板化的 HTML，我们可以动态生成必要的 URL + 查询字符串。在我们的`doGet()`中，我们只需要解析查询字符串来确定要服务的页面。

这是脚本，有两个示例页面，其中包含在它们之间翻转的按钮。

### 代码.gs

```
/**
 * Get the URL for the Google Apps Script running as a WebApp.
 */
function getScriptUrl() {
 var url = ScriptApp.getService().getUrl();
 return url;
}

/**
 * Get "home page", or a requested page.
 * Expects a 'page' parameter in querystring.
 *
 * @param {event} e Event passed to doGet, with querystring
 * @returns {String/html} Html to be served
 */
function doGet(e) {
  Logger.log( Utilities.jsonStringify(e) );
  if (!e.parameter.page) {
    // When no specific page requested, return "home page"
    return HtmlService.createTemplateFromFile('my1').evaluate();
  }
  // else, use page parameter to pick an html file from the script
  return HtmlService.createTemplateFromFile(e.parameter['page']).evaluate();
} 
```

### my1.html

```
<html>
  <body>
    <h1>Source = my1.html</h1>
    <?var url = getScriptUrl();?><a href='<?=url?>?page=my2'> <input type='button' name='button' value='my2.html'></a>
  </body>
</html> 
```

### my2.html

```
<html>
  <body>
    <h1>Source = my2.html</h1>
    <?var url = getScriptUrl();?><a href='<?=url?>?page=my1'> <input type='button' name='button' value='my1.html'></a>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-03-04T18:03:48.627

Google Apps script web-app 主要设计用于单页 web-app 应用程序，带有动态页面。但它也可以用作多页应用程序（不推荐）。这是一个示例网络应用程序，它使用更改处理程序使用 url 哈希片段获取网页（与上一个答案中的模板相反）。

### 代码.gs：

```
//@return Base Url
function getUrl() {
  return ScriptApp.getService().getUrl()
}
//@return Html page raw content string
function getHtml(hash) {
  return HtmlService.createHtmlOutputFromFile(hash).getContent()
}

//@return provided page in the urlquery '?page=[PAGEID]' or main index page
function doGet(e) {
  var page = e.parameter.page
  return HtmlService.createHtmlOutputFromFile(page || 'index')
    .addMetaTag('viewport', 'width=device-width, initial-scale=1')
    .setTitle('App Demo')
} 
```

### page1.html

```
<h3>This is Page 1</h3>
<p>Hello World!</p> 
```

### page2.html

```
<h4>This is Page2</h4>
<p>Goodbye World!</p> 
```

### 索引.html

```
<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />
    <title>Single Page App</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <style>
      h1 {
        text-align: center;
        margin: 2px;
        text-transform: uppercase;
        background-color: green;
      }
      span:hover,
      a:hover {
        background-color: yellowgreen;
      }
      body {
        background-color: brown;
        color: white;
        font-size: 2em;
      }
      a:visited {
        color: white;
      }
    </style>
  </head>
  <body>
    <h1><span id="type">Single</span> Page App Demo</h1>
    <div id="main">Loading...</div>
    <script>
      //Change base url
      google.script.run
        .withSuccessHandler(url => {
          $('base').attr('href', url)
        })
        .getUrl()

      //Function to handle hash change
      function change(e) {
        let hash = e.location.hash
        if (!hash) {
          main()
          return
        }
        google.script.run
          .withSuccessHandler(htmlFragment => {
            $('#main').html(htmlFragment)
          })
          .getHtml(hash)
      }
      google.script.history.setChangeHandler(change)

      //Function to add Main page html
      function main() {
        $('#main').html(`
            <ul>
              <li><a href="#page1">Page1</a></li>
              <li><a href="#page2">Page2</a></li>
            </ul>`)
      }

      //Loads Main html from main function
      //Adds toggle to span to change to a Multiple page app
      $(() => {
        main()
        $('#type').on('click', () => {
          let hf = $('a').attr('href')
          if (!hf) return
          hf = hf.indexOf('#') + 1
          $('#type').text(hf ? 'Multiple' : 'Single')
          $('a').each((i, el) => {
            $(el).attr('href', (i, v) =>
              hf ? '?page=' + v.slice(1) : '#' + v.slice(6)
            )
          })
        })
      })
    </script>
  </body>
</html> 
```

### 参考：

*   [网络应用指南](https://developers.google.com/apps-script/guides/web)
*   [设置更改处理程序](https://developers.google.com/apps-script/guides/html/reference/history#setChangeHandler(Function))

# c# - 截取您的应用程序下的区域

> ID：15668122
> 
> 赞同：1
> 
> 时间：2013-03-27T19:50:23.690
> 
> 标签：c#, screenshot, desktop

我正在开发一个应用程序，该应用程序需要程序截取监视器的屏幕截图，并让用户与生成的位图进行交互。我已经编写了代码（使用`Graphics.CopyFromScreen`），它将为任何连接的监视器完成此任务。不过，我正在使用两台显示器，这使我可以在一台显示器上打开一些有趣的应用程序，而在另一台显示器上打开我的软件。在一个监视器环境中，屏幕截图代码所做的只是给我的程序拍照（它必须在屏幕上最大化）。

有什么方法可以截取我的应用程序下的区域吗？这可能是桌面，但如果我的应用程序没有运行，则更有可能是处于活动状态的任何窗口排列。理论上，最小化我的应用程序，截取显示的屏幕截图，然后取消最小化我的应用程序会起作用，除非我将在用户与我的软件交互时频繁且异步地截取这些屏幕截图，所以它需要在用户不知道应用程序被最小化或中断的情况下无缝完成。

我的截图代码如下（从其他代码中提取，所以请原谅混乱），以防有理由查看它。

```
public Bitmap getScreenshot()
    {
        Rectangle rc = Screen.AllScreens[0].WorkingArea; // the OTHER monitor
        Rectangle rcClient = this.ClientRectangle;

        Bitmap memoryImage = null;

        try
        {
            int borderSizeH = 0, borderSizeW = 0;

            memoryImage = new Bitmap(rc.Width - 2 * borderSizeW, rc.Height - 2 * borderSizeH, PixelFormat.Format32bppArgb);

            Size rc2 = new Size(rc.Width, rc.Height);
            using (Graphics memoryGrahics = Graphics.FromImage(memoryImage))
            {
                memoryGrahics.CopyFromScreen(rc.Location.X + borderSizeW, rc.Location.Y + borderSizeH, 0, 0, rc2, CopyPixelOperation.SourceCopy);

            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.ToString(), "Capture failed", MessageBoxButtons.OK, MessageBoxIcon.Error);
        }

       return memoryImage;
    } 
```

# javascript - 在移动网络上永久存储键值对的最佳实践？

> ID：15668123
> 
> 赞同：0
> 
> 时间：2013-03-27T19:50:24.347
> 
> 标签：javascript, html, sqlite, trigger.io

第一次下载图像后，我会将图像保存在我的移动网络应用程序中**。**我不想将其存储在表中，因为同一个用户可能在不同的设备上保存了不同的图像，因此数据持久性将是一个问题。使用[TriggerIO 的 saveURL](http://docs.trigger.io/en/v1.4/modules/file.html#saveurl)，我得到了下载图像的本地位置，但要在将来使用它，它必须存储在永久位置。

我知道的最佳解决方案是将其作为**键值对**存储在 HTML5 **Web 数据库**中，并在下载远程副本之前查询数据库以查看是否存在本地副本，但因为这可能会发生高达 50 倍一个页面，我认为 50 个查询可能会减慢我的应用程序。有更好的选择吗？

此选项的增强功能是将所有 KVP 加载到对象并将保存保存到数据库。想法？

# django - 我可以在不创建自定义用户的情况下更改 Django 1.5 中的 USERNAME_FIELD 吗？

> ID：15668124
> 
> 赞同：9
> 
> 时间：2013-03-27T19:50:32.150
> 
> 标签：django, email, model, django-1.5

我正在尝试使用默认 Django 用户模型中的电子邮件字段作为用户名。我正在使用 Django 1.5，我看到默认用户有一个`USERNAME_FIELD`属性。

在我的项目中，我想`USERNAME_FIELD = 'email'`在用户模型中将以下设置为默认值。

这个小而基本的调整是我唯一想在用户模型中改变的地方。我想知道是否有一种方法可以改变 .`USERNAME_FIELD`而不必继承`AbstractUser`. 我在[这个问题](https://stackoverflow.com/questions/15597188/)中看到您可以将其子类化`AbstractUser`并为其编写自定义管理器。

所以我想知道是否有更简单的方法来更改该属性？

如果没有，扩展`AbstractUser`使用电子邮件字段作为用户名的最小方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T12:19:39.217

```
#Your app's __init__.py

from django.contrib.auth.models import User

User.USERNAME_FIELD = 'email' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-16T13:25:08.970

您必须通过扩展 AbstractBaseUser 而不是 AbstractUser 来编写一个新的自定义用户类

在此处将您的电子邮件声明为 USERNAME_FIELD

或者，您还可以声明一个从 BaseUserManager 扩展的自定义用户管理器来处理用户名所需的约束。您可以从该经理的 create_user 函数中删除用户名

# regex - 正则表达式 - 如果不在 X 和 Y 和 Z 中，则匹配

> ID：15668125
> 
> 赞同：0
> 
> 时间：2013-03-27T19:50:33.353
> 
> 标签：regex, email, lookahead

我想匹配字符串中的邮件地址。那没问题。但出于任何原因，我无法排除特殊的 html 标签和属性。

我的邮件正则表达式：

```
[!#\$%&'\*\+\-\/0-9=\?a-z\^_`\{\}\|~]*(?:\\[\x00-\x7F][!#\$%&'\*\+\-\/0-9=\?a-z\^_`\{\}\|~]*)*(?:\.[!#\$%&'\*\+\-\/0-9=\?a-z\^_`\{\}\|~]*(?:\\[\x00-\x7F][!#\$%&'\*\+\-\/0-9=\?a-z\^_`\{\}\|~]*)*)*@[a-z0-9](?:[a-z0-9-]*[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)*\.[a-z]{2,} 
```

现在，如果邮件地址在输入字段中，我不想匹配：

```
<input type="xxx" value"foo@bar.tld"> 
```

我也不想匹配，如果它在标题标签中

```
<title>foo@bar.tld 
```

也不包含在`<style`and`<script`

我尝试了这个前瞻性的东西，但我产生了非法的正则表达式，或者它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:28:26.670

一个正则表达式将无法以您想要的方式同时排除和包含。

如果您的目标文档是格式正确的 XML，那么您可以使用一个或多个正则表达式来查找并用空字符串替换标签，然后使用您的工作正则表达式在剩下的任何文本中查找邮件地址。

但是，如果您的目标是 XML 文件，我必须同意 Bohemian 的观点，即 XML 解析器是最好的方法。XML 既复杂又灵活，在设计替换为空字符串的正则表达式（例如 CDATA 和注释块）时，您总是有可能遇到您忘记的功能的文件。最好坚持使用经过设计和测试的解析器，以便通过 XML 运行并逐部分提取文档。

如果您的目标文档是 XML 解析器无法读取的不规则 HTML，那么您可能必须尝试使用​​ replace-then-search 方法。

# php - 喜欢按钮没有选择正确的图像

> ID：15668127
> 
> 赞同：0
> 
> 时间：2013-03-27T19:50:37.300
> 
> 标签：php, facebook, button, facebook-like, thumbnails

你好，你好吗这是我的第一个问题，我在这里搜索了与我的问题相关的每一件事，但它并没有解决我的问题。

我与 Facebook 类似按钮的问题它没有选择我分配给我的主题的正确图像，它选择随机图像但是当我在 Facebook 调试器上输入我的主题的 url 时，我分配的图像将成功显示。

这些是我所有的元标记：

```
<meta property="og:site_name" content="helloworl.net" />
<meta property="fb:admins" content="100005448308575" />
<meta property="fb:app_id" content="153624041471824"/>
<meta property="og:title" content="<?php echo $facebook_title ; ?>" />
<meta property="og:type" content="article" />
<meta property="og:url" content="<?php echo $actual_link ;  ?>" />
<meta property="og:image" content="

<?php
if($row->con_image){
echo $row->con_image;
}else{
echo "http://www.einelhelweh.net/ein.jpg";
}

?>

" />

<meta property="og:site_name" content="helloworld.net" />
<meta property="fb:admins" content="100005448308575" />

<meta property="og:description"
          content="Hello world"/> 
```

当我右键单击包含我的主题的页面并选择“查看页面资源我的”时，我的特定图像将正确显示。

我帮助 Facebook 的图像尺寸（如按钮缩略图）是真的

我也使用 php header 来清除缓存但同样的事情

```
$gmt_mtime = gmdate('D, d M Y H:i:s', time() ) . ' GMT';
header("Last-Modified: " . $gmt_mtime );
<meta http-equiv="Expires" content="Tue, 01 Jan 1995 12:12:12 GMT">
<meta http-equiv="Pragma" content="no-cache"> 
```

我也清除了我创建的重定向到我的旧网站文件夹，但同样的事情

我不仅在这里搜索过，而且在 facebook 和其他网站上搜索过，但没有希望

自 1 年前以来，我仍然受到这个问题的困扰，我在谷歌上搜索过，但没有希望

拜托拜托，我需要帮助，我不想在没有解决方案的情况下离开这里。

谢谢所有的人。请原谅我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T13:41:25.473

您的 og:image 标签如下所示：

```
<meta property="og:image" content="

http://www.einelhelweh.net/ein.jpg
" /> 
```

对于初学者，我会删除所有空格。也就是说，Facebook 似乎正在接受它。这是我尝试在墙上发帖时的示例：

![在此处输入图像描述](../Images/4fbe0aac4d18dbe619979bb0f158dd80.png)

# javascript - 在 jQuery 中使用参数调用 JSF 托管 bean 方法

> ID：15668132
> 
> 赞同：4
> 
> 时间：2013-03-27T19:50:59.920
> 
> 标签：javascript, jquery, jsf, jsf-2

我正在使用 JSF 来构建一个站点。我的主页上包含了[jQuery Gritter (Growl)](http://boedesign.com/blog/2009/07/11/growl-for-jquery-gritter/)通知。是否可以在`before_close:`of`$.gritter.add`函数中调用托管 bean 方法？

我要使用的代码如下：

```
<h:body>
    <c:forEach items="#{notificationBean.growlNotificationList}" var="p">
        <script>
        /* <![CDATA[ */
        $.gritter.add({
            // (string | mandatory) the heading of the notification
            title: 'Notification',
            // (string | mandatory) the text inside the notification
            text: 'Comment on your staus',
            // (bool | optional) if you want it to fade out on its own or just sit there
            sticky: true, 
            // (int | optional) the time you want it to be alive for before fading out (milliseconds)
            time: 8000,
            // (string | optional) the class name you want to apply directly to the notification for custom styling
            class_name: 'gritter-light',
            // (function | optional) function called before it closes
            before_close: function(e, manual_close){
                '#{notificationBean.set0ToGrowlToShow(p.notificationID)}'
            }
        });
        /* ]]> */
        </script>
    </c:forEach>
</h:body> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T20:06:02.933

您当前的尝试仅将给定的 EL 表达式解释为值表达式，并在生成嵌入了 JS 代码的 HTML 输出期间立即打印其结果。就像您正在使用`<h:outputText>`. 这确实行不通。

然而，功能要求是可以理解的。标准的 JSF API 没有为此提供现成的解决方案。如果您想坚持使用标准的 JSF API，最好的办法是创建一个带有隐藏命令链接的隐藏表单，您可以使用 JavaScript 触发该链接。

基本上，

```
<h:form id="form" style="display:none">
    <h:inputHidden id="id" value="#{notificationBean.notificationID}" />
    <h:commandLink id="command" action="#{notificationBean.set0ToGrowlToShow}">
        <f:ajax execute="@form" />
    </h:commandLink>
</h:form> 
```

和

```
$("[id='form:id']").val(#{p.notificationID});    
$("[id='form:command']").click(); 
```

但是，这很笨拙。考虑寻找第 3 方 JSF 组件甚至实用程序库来满足要求。JSF 实用程序库[OmniFaces](http://omnifaces.org)具有[`<o:commandScript>`](http://omnifaces.org/docs/vdldoc/current/o/commandScript.html)用于此目的的组件。另请参阅其[展示页面](http://showcase.omnifaces.org/components/commandScript)。

```
<h:form>
    <o:commandScript name="set0ToGrowlToShow" action="#{notificationBean.set0ToGrowlToShow}" />
</h:form> 
```

和

```
set0ToGrowlToShow(#{p.notificationID}); 
```

*（请注意，这是设置为 HTTP 请求参数，而不是操作方法参数）*

JSF 组件库[PrimeFaces](http://primefaces.org)具有[`<p:remoteCommand>`](http://www.primefaces.org/docs/vdl/3.5/primefaces-p/remoteCommand.html)与`<o:commandScript>`. 另请参阅其[展示页面](http://www.primefaces.org/showcase/ui/remoteCommand.jsf)。更重要的是，PrimeFaces 有一个即用型[`<p:growl>`](http://www.primefaces.org/docs/vdl/3.5/primefaces-p/growl.html)组件，其功能与您的 jQuery 插件基本相同！另请参阅其[展示页面](http://www.primefaces.org/showcase/ui/growl.jsf)。而不是你的整个 jQuery 事情，你可以这样做：

```
<p:growl globalOnly="true" autoUpdate="true" /> 
```

并通过以下方式向其提供消息

```
facesContext.addMessage(null, message); 
```

### 也可以看看：

*   [如何使用原生 JavaScript 在 HTML DOM 事件上调用 JSF 托管 bean？](https://stackoverflow.com/questions/16588327/how-to-invoke-a-jsf-managed-bean-on-a-html-dom-event-using-native-javascript/)
*   [如何将 JavaScript 变量作为参数传递给 JSF 操作方法？](https://stackoverflow.com/questions/28591301/how-to-pass-javascript-variables-as-parameters-to-jsf-action-method)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:59:05.033

您需要了解您需要调用在服务器中运行的 java 方法，并且您**不能**直接调用它。

在您的情况下，我建议使用 AJAX 或在页面加载时读取值并使用它（如果对您可行）

检查如何将[AJAX 与 Jquery 一起使用](http://api.jquery.com/jQuery.ajax/)

# android - 在 XMPP 中将成员添加到组

> ID：15668136
> 
> 赞同：0
> 
> 时间：2013-03-27T19:51:07.037
> 
> 标签：android, xmpp, openfire, smack, asmack

我成功地在我的 xmpp 服务器中创建了一个用户（asmack）。

```
AccountManager am = m_connection.getAccountManager();
am.createAccount(mUserName, "1234"); 
```

但是，现在我想以编程方式将这个新创建的用户添加到组中。我找不到任何示例或文档我可以在服务器本身上很容易地做到这一点，但我需要以编程方式做到这一点......感谢您的帮助！

编辑：

我安装了一个插件订阅，它自动接受订阅请求，见下图。现在我打电话给 roster.createEntry 但仍然没有任何想法？

```
AccountManager am = new AccountManager(m_connection);
        am.createAccount(mUserName, "1234");

        m_connection.login(mUserName, "1234");
        Roster roster = m_connection.getRoster();
        String[] urlArray = new String[] { "DOLPHIN" };

        roster.createEntry(mUserName, mUserName, urlArray); 
```

![在此处输入图像描述](../Images/99e6ac0c79dd945bc82a46630149cf4c.png)

![在此处输入图像描述](../Images/b8bf532ae5eacc9062f2ae8caabca8c6.png)

# ios - 几次打开后无法打开 NSManagedDocument 文件似乎已损坏

> ID：15668140
> 
> 赞同：3
> 
> 时间：2013-03-27T19:51:29.120
> 
> 标签：ios, objective-c, uimanageddocument

我试图`NSManagedDocument`在创建它之后打开它。成功打开文件几次后似乎无法打开文件。如果我更改文档名称或再次删除/复制应用程序，它可以工作。每次应用程序启动时，都会在应用程序委托中调用以下方法。

```
-(void) loadDataDocument {

    NSURL *documentURL= [[[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory
                                                             inDomains:NSUserDomainMask] lastObject] URLByAppendingPathComponent:@"TestDataDocument1"];
    self.document = [[UIManagedDocument alloc] initWithFileURL:documentURL];

    if(![[NSFileManager defaultManager] fileExistsAtPath:[documentURL path]]) {
    [self.document saveToURL:documentURL forSaveOperation:UIDocumentSaveForCreating completionHandler:^(BOOL success) {
        if (success) {
            [self documentIsReady];
        }else {
            NSLog(@"Tried to create new file. Cannot open document");
        }
    }];
    } else if (self.document.documentState == UIDocumentStateClosed) {
        [self.document openWithCompletionHandler:^(BOOL success) {
            if (success) {
               [self documentIsReady];
            }else {
               NSLog(@"Document was Closed. Cannot open document");
            }
        }];
    } else {
        [self documentIsReady];
    } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:00:19.577

```
-(void) loadDataDocument {

    NSString * fileUrl = [NSString stringWithFormat:@"%@abc.txt",[[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask] lastObject]];
    NSURL *documentURL= [NSURL URLWithString:fileUrl];

    UIManagedDocument *document = [[UIManagedDocument alloc] initWithFileURL:documentURL];

    if(![[NSFileManager defaultManager] fileExistsAtPath:[documentURL path]]) {
        [document saveToURL:documentURL forSaveOperation:UIDocumentSaveForCreating completionHandler:^(BOOL success) {
            if (success) {
                NSManagedObjectContext * _context;
                _context = document.managedObjectContext;

            }
        }];
    } else if (document.documentState == UIDocumentStateClosed) {
             NSLog(@"document.documentState == UIDocumentStateClosed");
        NSString *fileDataStr = [[NSString alloc]initWithContentsOfURL:documentURL encoding:NSUTF8StringEncoding error:nil];
        NSLog(@"%@",fileDataStr);
    } else {
        NSManagedObjectContext * _context;
        _context = document.managedObjectContext;

    }

} 
```

**注意：** 'UIManagedDocument 只能读取文件包的文档'

# visual-studio-2012 - Web.config 转换 w/ 发布到 AWS

> ID：15668148
> 
> 赞同：4
> 
> 时间：2013-03-27T19:51:44.977
> 
> 标签：visual-studio-2012, amazon-web-services

我想在 AWS（1 EC2、1 RDS db）和生产环境（LB'd EC2 和 1 RDS db）中有一个测试/阶段环境。也许我遗漏了一些明显的东西，但是如何设置 AWS 部署以允许我针对任一环境并修改每个环境的配置（连接字符串等）？

我熟悉 VS2012 WebDeploy 和配置转换，但在这种情况下，我指定了一个发布配置文件来确定要使用的转换。使用 AWS 工具包进行部署时，我看不到任何选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-12T20:57:00.863

创建一个新的构建配置（即“AWSDevServer”），然后创建一个转换您的设置的 web.AWSDevServer.config 文件。发布到 AWS 时使用该构建配置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-20T13:30:49.910

对于那些将 Elastic Beanstalk 与 AWS Toolkit for Visual Studio 一起使用的人。如上所述，内置部署默认使用“调试”环境，无法更改。要部署其他配置（暂存、发布...），您必须使用通常在此处找到的命令行部署工具：

```
C:\Program Files (x86)\AWS Tools\Deployment Tool\awsdeploy.exe 
```

文档在这里：[http ://docs.amazonwebservices.com/AWSToolkitVS/latest/UserGuide/tkv-deployment-tool.html](http://docs.amazonwebservices.com/AWSToolkitVS/latest/UserGuide/tkv-deployment-tool.html)

这里的关键是将“DeploymentPackage={relative path}/package.zip”添加到您的 config.txt 以进行部署。我为每个配置（deploy_prod.bat、deploy_dev.bat）创建了一个简单的批处理文件。希望这可以帮助！

# algorithm - 多边形填充算法

> ID：15668149
> 
> 赞同：7
> 
> 时间：2013-03-27T19:51:50.790
> 
> 标签：algorithm, geometry, polygon, slice

我正在开发用于 3D 打印目的的网格切片实用程序。一般来说，它应该将 3d 网格模型切成 2d 形状（许多多边形，可能带有孔），并使用特定图案用确定厚度的路径填充它们。这些路径将用于为 3d 打印机固件生成 gcode 命令。

有各种用途相同的开源工具，用 python 和 perl 编写。但我的目标是了解切片器的工作流程并用 C 或 C++ 编写我自己的工具。

到目前为止，我能够得到切片的轮廓，现在要用路径填充它们。问题是我没有找到有效的算法来做到这一点。填充示例的示意过程： ![](../Images/0959cb1dce956ad7b897454cea4af643.png)

谁能建议如何生成这些填充路径？谢谢。

* * *

目前我正在使用以下算法：

1.  找到形状的边界框
2.  用线垂直分割 bb（线数 = bb.width/path.thickness）
3.  查找形状和每条线的交点（每条线应该是两个点）
4.  从这些点构造一个与边界偏移的线段
5.  添加一个段，将原始段连接在一起形成一条线
6.  我们已经准备好生成gcode或绘制路径

![简单的填充算法](../Images/2e49842a273529fdcc69ba15418e575d.png)

这是一种简单快速的算法，但它不适用于凹多边形和带孔的多边形。它也只使用一种指定的模式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-02T17:39:42.210

只要有可能，下面的方法将产生一个由**单个路径**组成的填充模式（即填充喷嘴永远不会关闭、移动和重新打开）。

在您的第 4 步（“从这些点构造一个与边界偏移的线段”）之后，将每个垂直线段变成 2 个或更多点：顶部和底部端点，加上（想象您的图表绘制在透明幻灯片上；放一张下面有水平线的纸，并标记图表中垂直线段与纸上水平线相交的位置）。

现在形成一个边加权图，其中包含每个点的顶点，只要两个顶点的对应点相距小于或等于一个网格单元，则边连接两个顶点。还要在线段的相邻最高点之间以及相邻最低点之间添加边。使用点之间的欧几里得距离作为边权重。最后，神奇的部分：找到一条最小权重的[哈密顿路径](http://en.wikipedia.org/wiki/Hamiltonian_path)在这张图上。这是一条只访问每个顶点一次的路径，并且具有最小长度。最小长度约束保证路径永远不会与自身相交，因为如果任何两条线相交，比如从 a 到 b 的线和从 c 到 d 的线，那么总是可以通过删除这些来创建更短的整体路径两条线并使用不同的端点组合（a---c 和 b---d，或 a---d 和 b---c）创建两条新线。这是您将填写的路径。

寻找哈密顿路径（更不用说最小权重哈密顿路径）是一个 NP 难题，与更著名的旅行商问题密切相关。由于已经存在许多良好的精确 TSP 求解器（例如[Concorde](http://www.tsp.gatech.edu/concorde/gui/gui.htm)），因此明智的做法是使用其中之一来查找旅行推销员旅行，然后简单地删除其中一个边以生成一条短的哈密顿路径。（即使删除最重的边，也不一定会产生最小长度的哈密顿路径，因为可能存在不开始和结束于相邻顶点的较短路径；但我们并不真正关心这里的总长度，我们只想要一条访问所有顶点且不交叉自身的路径。）

不幸的是，不能保证图包含哈密顿路径或旅行商旅行。（例如，如果图是断开连接的，它们显然不存在，但即使是连通图也可能无法拥有其中一个或两者：例如，具有任何 1 度顶点的图不能有 TSP 巡回。）在这种情况下，如果您正在使用的 TSP 求解器可以找到不访问所有顶点的游览，您可以重复此操作，直到覆盖所有顶点。如果做不到这一点，我会求助于你原来的算法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T15:08:50.893

经过一段时间的研究，我得出了以下算法： ![在此处输入图像描述](../Images/8818a8e03b5b86528c051a0fa6cf67f6.png) 不过，有许多优化机会。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-27T20:12:24.770

您可能想查看有关将阴影应用于区域的算法的[网页。](http://wiki.evilmadscience.com/Creating_filled_regions)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-11-25T14:44:23.710

恢复一个旧线程。

应用此处提供的答案中描述的技术，我创建了一个名为“Mandoline”的实现。请在此处查看：[https ://github.com/Tannz0rz/Mandoline](https://github.com/Tannz0rz/Mandoline)

# php - PHP函数不接受参数

> ID：15668150
> 
> 赞同：-1
> 
> 时间：2013-03-27T19:51:51.400
> 
> 标签：php, arrays, function

我目前遇到了一个 php 函数的问题。我已经声明了一个函数：

```
 function edit_content($array, $id = NULL){
        //code
    } 
```

where`$array`是传递给函数的数组，`$id`是可选的整数值。当我像这样调用函数时：

```
edit_content($content_array, 2); 
```

该值`2`没有通过。

为什么值不会被传递？它与传递的数组有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:21:03.870

毕竟问题不在于代码，而在于缓存。我在稍微更改 ajax 调用后忘记清理缓存，导致在不同条件下调用函数（其中 ID 没有传递，因为不需要它。

感谢您的帮助，很抱歉占用您的时间。祝你有美好的一天！

# php - 每次单击按钮时，PHP 函数都无法重新检查 IP 检查

> ID：15668158
> 
> 赞同：2
> 
> 时间：2013-03-27T19:52:09.610
> 
> 标签：php, javascript, html

我使用以下 PHP 代码检查 IP 和端口状态。有用！然后我做了一个刷新按钮来重置显示的状态，这样人们就不需要按F5了。嵌入状态显示“刷新”，但 IP 检查似乎不起作用。

这是 PHP IP 检查：

```
function check($host,$port)
{
if(isset($host) && isset($port)){
    $fp = @fsockopen($host, $port, $errno, $errstr, 0.5);
        if(!$fp){
            $outp = '"onlinestatus/offline.swf"';
            }
        elseif($fp){
            $outp = '"onlinestatus/online.swf"';
            }
    } else {
    $outp = 'null';
    }
    return ($outp);
}
?> 
```

这是嵌入控件：

```
<script type="text/javascript">
function reloadembed() {    
  var game=document.getElementById("embed1");
  var clone=game.cloneNode(true);
  clone.setAttribute('src',<? echo check($host,$port); ?>);
  game.parentNode.replaceChild(clone,game)
}
</script> 
```

这是刷新按钮：

```
<a href="javascript:"
onmousedown="document.images['Refresh'].src='image/button_reresh_click.png'"
onmouseup="document.images['Refresh'].src='image/button_reresh_down.png'"
onClick="reloadembed();"
onMouseOver="document.images['Refresh'].src='image/button_reresh_down.png'"
onMouseOut="document.images['Refresh'].src='image/button_reresh_up.png'">
<img name="Refresh" src="image/button_reresh_up.png">
</a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:00:22.173

您的`check`函数返回一个字符串，因此您需要将此值括在引号中：

```
clone.setAttribute('src','<? echo check($host,$port); ?>'); 
```

**编辑：**

您似乎希望每次调用该`PHP`函数`check`时都会调用该`JavaScript`函数`reloadembed`。事实并非如此。`check`运行*一次*——当页面被执行时——所以你`JavaScript`会看起来像这样：

```
<script type="text/javascript">
function reloadembed() {    
  var game=document.getElementById("embed1");
  var clone=game.cloneNode(true);
  clone.setAttribute('src','onlinestatus/online.swf');
  game.parentNode.replaceChild(clone,game)
}
</script> 
```

将`src`永远是`onlinestatus/online.swf`。你可以看看你是否查看源代码。要让它按您的意愿工作，您需要使用[`AJAX`](http://www.w3schools.com/php/php_ajax_php.asp).

# ios - 使用 GCD 异步下载 UITableView 的图像

> ID：15668160
> 
> 赞同：34
> 
> 时间：2013-03-27T19:52:20.833
> 
> 标签：ios, objective-c, ios6

我正在使用 GCD 为我的 uitableview 异步下载图像，但是有一个问题 - 滚动图像时一直闪烁和变化。我尝试将每个单元格的图像设置为零，但这并没有太大帮助。快速向上滚动时，所有图像都是错误的。我能做些什么呢？这是我的细胞方法：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    if (self.loader.parsedData[indexPath.row] != nil)
    {
        cell.imageView.image = nil;
        dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0ul);
            dispatch_async(queue, ^(void) {

                NSData *imageData = [NSData dataWithContentsOfURL:[NSURL URLWithString:[self.loader.parsedData[indexPath.row] objectForKey:@"imageLR"]]];

                UIImage* image = [[UIImage alloc] initWithData:imageData];

                dispatch_async(dispatch_get_main_queue(), ^{
                    cell.imageView.image = image;
                    [cell setNeedsLayout];
                     });
            });

    cell.textLabel.text = [self.loader.parsedData[indexPath.row] objectForKey:@"id"];
    }
    return cell;
} 
```

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2013-03-27T20:05:03.623

这里的问题是您的图像获取块持有对 tableview 单元格的引用。下载完成后，它会设置`imageView.image`属性，即使您已回收单元格以显示不同的行。

在设置图像之前，您需要下载完成块来测试图像是否仍然与单元格相关。

还值得注意的是，您不会将图像存储在单元格以外的任何地方，因此每次在屏幕上滚动一行时，您都会再次下载它们。您可能希望将它们缓存在某处并在开始下载之前查找本地缓存的图像。

编辑：这是一个简单的测试方法，使用单元格的`tag`属性：

```
- (UITableViewCell *)tableView:(UITableView *)tableView 
         cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    cell.tag = indexPath.row;
    NSDictionary *parsedData = self.loader.parsedData[indexPath.row];
    if (parsedData)
    {
        cell.imageView.image = nil;
        dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0ul);
        dispatch_async(queue, ^(void) {

            NSData *imageData = [NSData dataWithContentsOfURL:[NSURL URLWithString:parsedData[@"imageLR"]];

            UIImage* image = [[UIImage alloc] initWithData:imageData];
            if (image) {
                 dispatch_async(dispatch_get_main_queue(), ^{
                     if (cell.tag == indexPath.row) {
                         cell.imageView.image = image;
                         [cell setNeedsLayout];
                     }
                 });
             }
        });

        cell.textLabel.text = parsedData[@"id"];
    }
    return cell;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-27T20:15:14.183

关键是您没有完全理解单元重用的概念。这与异步下载不太一致。

块

```
 ^{
    cell.imageView.image = image;
    [cell setNeedsLayout];
} 
```

当请求完成并加载所有数据时执行。但是 cell 在创建块时获取它的值。

到执行块时，单元格仍指向现有单元格之一。但很有可能用户继续滚动。在此期间，单元对象被重新使用，并且图像与被重新使用、分配和显示的“*旧”单元相关联。*此后不久，除非用户进一步滚动，否则正确的图像被加载并分配和显示。等等等等。

你应该寻找一种更聪明的方法来做到这一点。有很多教程。谷歌用于延迟图像加载。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-27T21:13:46.953

使用索引路径获取单元格。如果它不可见，则单元格将是`nil`并且您不会有问题。当然，您可能希望在下载数据时缓存数据，以便在您拥有图像时立即设置单元格的图像。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    if (self.loader.parsedData[indexPath.row] != nil)
    {
        cell.imageView.image = nil;
        dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0ul);
            dispatch_async(queue, ^(void) {
                //  You may want to cache this explicitly instead of reloading every time.
                NSData *imageData = [NSData dataWithContentsOfURL:[NSURL URLWithString:[self.loader.parsedData[indexPath.row] objectForKey:@"imageLR"]]];
                UIImage* image = [[UIImage alloc] initWithData:imageData];
                dispatch_async(dispatch_get_main_queue(), ^{
                    // Capture the indexPath variable, not the cell variable, and use that
                    UITableViewCell *blockCell = [tableView cellForRowAtIndexPath:indexPath];
                    blockCell.imageView.image = image;
                    [blockCell setNeedsLayout];
                });
            });
        cell.textLabel.text = [self.loader.parsedData[indexPath.row] objectForKey:@"id"];
    }

    return cell;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-10-01T18:11:12.987

我一直在研究这个问题，并通过自定义 UITableViewCell 找到了一个很好的方法。

```
#import <UIKit/UIKit.h>

@interface MyCustomCell : UITableViewCell

@property (nonatomic, strong) NSURLSessionDataTask *imageDownloadTask;
@property (nonatomic, weak) IBOutlet UIImageView *myImageView;
@property (nonatomic, weak) IBOutlet UIActivityIndicatorView *activityIndicator;

@end 
```

现在，在您的 TableViewController 中，为 NSURLSessionConfiguration 和 NSURLSession 声明两个属性并在 ViewDidLoad 中初始化它们：

```
@interface MyTableViewController ()

@property (nonatomic, strong) NSURLSessionConfiguration *sessionConfig;
@property (nonatomic, strong) NSURLSession *session;
.
.
.
@end

@implementation TimesVC

- (void)viewDidLoad
{
    [super viewDidLoad];

    _sessionConfig = [NSURLSessionConfiguration defaultSessionConfiguration];
    _session = [NSURLSession sessionWithConfiguration:_sessionConfig];
}

.
.
. 
```

假设您的数据源是 NSMutableDictionary 的数组（或 NSManagedObjectContext）。您可以使用缓存轻松下载每个单元格的图像，如下所示：

```
.
.
.
- (MyCustomCell *)tableView:(UITableView *)tableView
   cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    MyCustomCell *cell = (MyCustomCell *)[tableView dequeueReusableCellWithIdentifier:@"cell" forIndexPath:indexPath];

    if (!cell)
    {
        cell = [[MyCustomCell alloc] initWithStyle:UITableViewCellStyleDefault
                                reuseIdentifier:@"cell"];
    }

    NSMutableDictionary *myDictionary = [_myArrayDataSource objectAtIndex:indexPath.row];    

    if (cell.imageDownloadTask)
    {
        [cell.imageDownloadTask cancel];
    }

    [cell.activityIndicator startAnimating];
    cell.myImageView.image = nil;

    if (![myDictionary valueForKey:@"image"])
    {
        NSString *urlString = [myDictionary valueForKey:@"imageURL"];
        NSURL *imageURL = [NSURL URLWithString:urlString];
        if (imageURL)
        {
            cell.imageDownloadTask = [_session dataTaskWithURL:imageURL
                completionHandler:^(NSData *data, NSURLResponse *response, NSError *error)
            {
                if (error)
                {
                    NSLog(@"ERROR: %@", error);
                }
                else
                {
                    NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *)response;

                    if (httpResponse.statusCode == 200)
                    {
                        UIImage *image = [UIImage imageWithData:data];

                        dispatch_async(dispatch_get_main_queue(), ^{
                            [myDictionary setValue:data forKey:@"image"];
                            [cell.myImageView setImage:image];
                            [cell.activityIndicator stopAnimating];
                        });
                    }
                    else
                    {
                        NSLog(@"Couldn't load image at URL: %@", imageURL);
                        NSLog(@"HTTP %d", httpResponse.statusCode);
                    }
                }
            }];

            [cell.imageDownloadTask resume];
        }
    }
    else
    {
        [cell.myImageView setImage:[UIImage imageWithData:[myDictionary valueForKey:@"image"]]];
        [cell.activityIndicator stopAnimating];
    }

    return cell;
} 
```

我希望它可以帮助一些开发人员！干杯。

学分：[iOS 7 中的表格视图图像](http://nsscreencast.com/episodes/90-table-view-images-in-ios-7)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-06-27T08:00:43.483

你有没有想过使用 SDWebImage？它也从给定的 URL 异步下载图像。我没有使用整个库（仅导入 UIImageView+WebCache.h）。导入后，您所要做的就是调用该方法：

```
[UIImageXYZ sd_setImageWithURL:["url you're retrieving from"] placeholderImage:[UIImage imageNamed:@"defaultProfile.jpeg"]]; 
```

如果您使用的是 AFNetworking 2.0，这可能有点矫枉过正，但它对我来说很有效。

[如果您想尝试一下，这里是 github 的链接](https://github.com/rs/SDWebImage)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-12-17T22:30:32.557

不要重新发明轮子，只需使用这两个很棒的 pod：

[https://github.com/rs/SDWebImage](https://github.com/rs/SDWebImage)

[https://github.com/JJSaccolo/UIActivityIndi​​cator-for-SDWebImage](https://github.com/JJSaccolo/UIActivityIndicator-for-SDWebImage)

很简单：

```
 [self.eventImage setImageWithURL:[NSURL URLWithString:[NSString stringWithFormat:@"%@/%@", [SchemeConfiguration APIEndpoint] , _event.imageUrl]]
                          placeholderImage:nil
                                 completed:^(UIImage *image,
                                             NSError *error,
                                             SDImageCacheType cacheType,
                                             NSURL *imageURL)
     {
         event.image = UIImagePNGRepresentation(image);
     } usingActivityIndicatorStyle:UIActivityIndicatorViewStyleWhite]; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-10-26T06:47:24.560

除了接受*Seamus Campbell*的回答之外，您还应该知道有时这不起作用。在这种情况下，我们应该重新加载特定的单元格。所以

```
if (image) {
     dispatch_async(dispatch_get_main_queue(), ^{
          if (cell.tag == indexPath.row) {
               cell.imageView.image = image;
               [cell setNeedsLayout];
          }
      });
 } 
```

应改为，

```
 if (image) {
         dispatch_async(dispatch_get_main_queue(), ^{
              if (cell.tag == indexPath.row) {
                   cell.imageView.image = image;
                   self.tableView.reloadRowsAtIndexPaths([indexPath], withRowAnimation: UITableViewRowAnimation.None)
              }
          });
     } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-10-26T00:19:50.000

对于那些担心索引路径变化和不一致的人，一个潜在的解决方案是继承 UITableViewCell 或 UICollectionViewCell 并添加一个名为 stringTag 之类的实例变量。然后，将您正在下载的照片的 URL 放在 stringTag 中。设置图像时，检查 stringTag 是否仍然是正确的 URL。

有关更多详细信息，请参阅此答案：[异步获取已完成：单元格是否仍在显示？](https://stackoverflow.com/questions/42386272/asynchronous-fetch-completed-is-cell-still-being-displayed/42386789#42386789).

这是我的课程：

```
import Foundation
import UIKit

class ImageAsyncCollectionViewCell : UICollectionViewCell {
  var stringTag: String?
} 
```

然后在使用单元格时：

```
 cell.stringTag = photoKey
    cell.imageView.image = self.blankImage
    if ImageCache.default.imageCachedType(forKey: photoKey).cached {
      ImageCache.default.retrieveImage(forKey: photoKey, options: nil) {
        image, cacheType in
        if let image = image {
          DispatchQueue.main.async {
            if cell.stringTag == photoKey {
              cell.imageView.image = image
            }
          }
        } else {
          print("Doesn't exist in cache, but should")
          self.setCellWithPhoto(photoKey: photoKey, cell: cell)
        }
      }
    } else {
      self.setCellWithPhoto(photoKey: photoKey, cell: cell)
    } 
```

# excel - 通过引用当前工作表的名称来引用另一个工作表中的单元格？

> ID：15668161
> 
> 赞同：24
> 
> 时间：2013-03-27T19:52:39.253
> 
> 标签：excel, excel-formula, worksheet-function

我计划有一个 24 张的工作簿。工作表名称将为：Jan、Jan 项目、Feb、Feb 项目等。

基本上它是用于预算的，以月份命名的表格具有摘要信息，而名称中带有“项目”的月份则具有更详细的信息。

现在，如果我希望“Jan”电子表格有一个引用`J3`“Jan item”电子表格中的单元格的单元格，我可以执行以下操作：

`='Jan item'!J3`

但是，不必为每个汇总表（1 月、2 月等）重新输入这样的公式，我想要类似的东西：

`=(reference-to-this-sheet's-name + " item")!J3`

这样，我可以将公式从一月复制到二月，它会自动查看正确的`Xxx item`表格，而无需我`Feb item`明确输入。

我问这个的原因是，对于每个摘要表，在相应的分项表中都会有几十个这样的对单元格的引用。

我问的可行吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-10-11T01:15:59.783

仍然使用间接。假设您的 A1 单元格是您的变量，它将包含引用工作表的名称（Jan）。如果你经过：

`=INDIRECT(CONCATENATE("'",A1," Item'", "!J3"))`

然后您将获得 'Jan Item'!J3 值。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-03-27T21:35:05.210

除非您想通过 VBA 路线来计算选项卡名称，否则基于 Mid 函数等的 Excel 公式相当难看。但是如果您想这样做，这两种方法都可以在[这里找到。](http://www.ozgrid.com/VBA/return-sheet-name.htm)

相反，我会这样做的方式是：

1) 例如，在工作表上创建一个名为“Jan Item”的单元格，`Reference_Sheet`然后在该单元格中输入值“Jan Item”。

2）现在，使用如下`Indirect`功能：

```
=INDIRECT(Reference_Sheet&"!J3") 
```

3) 现在，对于每个月的工作表，您只需更改那个`Reference_Sheet`单元格。

希望这能给你你正在寻找的东西！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-06T12:12:23.150

这是我以与费尔南多类似的方式制作月度页面的方式：

1.  我在每个月的页码上手动书写，并将那个地方命名为 ThisMonth。请注意，您只能*在*复制工作表之前执行此操作。复制 Excel 后不允许您使用相同的名称，但使用工作表复制它仍然可以。该解决方案也可以在没有命名的情况下使用。
2.  我将当月的周数添加到位置 C12。取名也不错。
3.  我在每一页上做了五周，第五周我做了功能

    ```
     =IF(C12=5,DATE(YEAR(B48),MONTH(B48),DAY(B48)+7),"") 
    ```

    如果本月只有 4 周，则为第 5 周。C12 保存周数。

4.  ...
5.  我创建了年度 Excel，所以里面有 12 张表格：每个月一张。在此示例中，工作表的名称是“月”。请注意，此解决方案也适用于 ODS 文件标准，但您需要将所有空格更改为“_”字符。
6.  我将第一个“月”表重命名为“月 (1)”，因此它遵循相同的命名原则。如果您愿意，您也可以将其命名为“Month1”，但“January”需要更多的工作。
7.  在第一天字段起始表 #2 上插入以下函数：

    ```
     =INDIRECT(CONCATENATE("'Month (",ThisMonth-1,")'!B15"))+INDIRECT(CONCATENATE("'Month (",ThisMonth-1,")'!C12"))*7 
    ```

    因此，换句话说，如果您在前一张纸上填写四到五周，这将正确计算日期并从正确的日期继续。

# javascript - 在浏览器中检测手机的最简单方法

> ID：15668166
> 
> 赞同：3
> 
> 时间：2013-03-27T19:52:55.337
> 
> 标签：javascript, jquery-mobile, mobile

我使用脚本生成器 -- [http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/) -- 来检测手机，以便将页面重定向到具有特殊手机模板的子域。

我只对手机感兴趣。Ipad、Android 平板电脑不会被重定向。我只需要知道这个脚本是否涵盖 iPhone 4 和 iPhone 5，因为我没有这些模型来测试它。无论如何，我已经使用开发者菜单 - 用户代理 - Safari ios 4.3.3 Iphone 在 Safari 上进行了测试，并根据需要重定向页面。这是否足以满足我的需求，或者我也应该使用以下脚本：

```
var iphone4 = (window.screen.height == (960 / 2)) ? true : false;
var iphone5 = (window.screen.height == (1136 / 2)) ? true : false;
if (iphone4 && iphone5) {
    parent.location.href='http://www.mobile.mysite.com';
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T20:32:42.643

是的，来自[http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)的正则表达式将检测 iPhone（以及 iPod Touch）所有版本......`ip(hone|od)`是匹配它的正则表达式部分。

~~如果您想要一个仅适用于 iPhone/iPod 的脚本，您可以将上述脚本缩减为：~~

 ~~~~```
(function (a, b) { if (/ip(hone|od)/i.test(a)) window.location = b }
)(navigator.userAgent || navigator.vendor || window.opera, 'http://www.mobile.mysite.com'); 
```~~  ~~编辑：

或者改为使用此脚本来检测移动设备

```
(function (a, b) { if (/Mobi/.test(a)) window.location = b }
)(navigator.userAgent || navigator.vendor || window.opera, 'http://www.mobile.mysite.com'); 
```

基于[使用用户代理的浏览器检测推荐| MDN](https://developer.mozilla.org/en-US/docs/Browser_detection_using_the_user_agent)：

> 我们建议在用户代理中的任意位置查找字符串“Mobi”以检测移动设备。如果设备足够大以至于没有标记“Mobi”，您应该为您的桌面站点提供服务（作为最佳实践，它应该支持触摸输入，因为越来越多的桌面机器出现了触摸屏）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:11:21.203

这应该有效。

```
var bIsMobile = (navigator.userAgent.toLowerCase().indexOf("mobile") != -1 && navigator.userAgent.toLowerCase().indexOf("ipad") == -1); 
```~~~~

# iphone - NSJSONSerialization 空白 uitableview 和 null 结果

> ID：15668168
> 
> 赞同：0
> 
> 时间：2013-03-27T19:52:55.850
> 
> 标签：iphone, ios, json

我的 uitableview 加载正常，但是，我得到了这些结果，并且在我的 uitableview 上得到了空白数据。我究竟做错了什么？谢谢你的帮助。似乎我在使用字典或数组时遇到了问题，但我很困惑在哪里更改代码。

这是我的 json 结果：

```
{"assistant":[{"assistant":"Joe Black"},{"assistant":"Mary White"}]} 
```

调试结果：

```
2013-03-27 15:10:38.132 testJson[3833:c07] its probably a dictionary
2013-03-27 15:10:38.133 testJson[3833:c07] jsonDictionary - (null)
2013-03-27 15:10:38.134 testJson[3833:c07] string is <7b226173 73697374 616e7422
3a5b7b22 61737369 7374616e 74223a22 52696320 446f6e61 746f227d 2c7b2261 73736973
74616e74 223a2252 69632044 6f6e6174 6f227d5d 7d>
2013-03-27 15:10:38.134 testJson[3833:c07] nil
2013-03-27 15:10:38.134 testJson[3833:c07] Is mutable? 1
2013-03-27 15:10:38.135 testJson[3833:c07] Is mutable? 1
2013-03-27 15:10:38.135 testJson[3833:c07] this is your datesArray (
) 
```

这是我的.h

```
#import <UIKit/UIKit.h>
@interface ViewController : UIViewController <UITextFieldDelegate, UITableViewDelegate,
UITableViewDataSource> {
NSArray *json;
}
@property (nonatomic, retain) NSArray *json;
@property (strong, nonatomic) IBOutlet UITableView *tableView;
@end 
```

这是我的.m

```
- (void)viewDidLoad
{
[super viewDidLoad];

dispatch_async(kBgQueue, ^{
    NSData* data = [NSData dataWithContentsOfURL:
                    kLatestKivaLoansURL];
    [self performSelectorOnMainThread:@selector(fetchedData:)
                           withObject:data waitUntilDone:YES];

});

}

- (void)fetchedData:(NSData *)responseData {

NSError* error;    

self.json = [NSJSONSerialization JSONObjectWithData:responseData options:kNilOptions
error:&error];

if ([json isKindOfClass:[NSArray class]]) {
    NSLog(@"its an array!");
    NSArray *jsonArray = (NSArray *)json;
    NSLog(@"jsonArray - %@",jsonArray);
}
else {
    NSLog(@"its probably a dictionary");
    NSDictionary *jsonDictionary = (NSDictionary *)json;
    NSLog(@"jsonDictionary - %@",jsonDictionary);
}

NSLog(@"string is %@", responseData);
if ([json isKindOfClass:[NSArray class]]) {
    NSLog(@"its an array");
}
if ([json isKindOfClass:[NSDictionary class]]) {
    NSLog(@"its a dictionary");
}
if ([json isKindOfClass:[NSString class]]) {
    NSLog(@"its a string");
}
if ([json isKindOfClass:[NSNumber class]]) {
    NSLog(@"its a number");
}
if ([json isKindOfClass:[NSNull class]]) {
    NSLog(@"its a null");
}
if (json == nil){
    NSLog(@"nil");
}
NSError *parseError;
NSMutableArray *listOfObjects = [NSJSONSerialization JSONObjectWithData:[@"[]"
dataUsingEncoding:NSUTF8StringEncoding] options:NSJSONReadingMutableContainers
error:&parseError];
NSLog(@"Is mutable? %hhi", [listOfObjects isKindOfClass:[NSMutableArray class]]);

listOfObjects = [NSJSONSerialization JSONObjectWithData:[@"[[],{}]"  
dataUsingEncoding:NSUTF8StringEncoding] options:NSJSONReadingMutableContainers
error:&parseError];
NSLog(@"Is mutable? %hhi", [listOfObjects isKindOfClass:[NSMutableArray class]]);

NSMutableArray *datesArray = [[NSMutableArray alloc] init];

for (NSDictionary *tempDict in json){
    [datesArray addObject:[tempDict objectForKey:@"assistant"]];

        }

NSLog(@"this is your datesArray %@", datesArray);
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
// Return the number of sections.
return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
// Return the number of rows in the section.
return self.json.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:  
(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault 
reuseIdentifier:CellIdentifier];
}

cell.textLabel.text = [[json objectAtIndex:indexPath.row] objectForKey:@"assistant"];

return cell;

}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:22:46.630

什么是 self.json？你分配它然后你对它进行检查然后你把它当作一个数组在这里。

```
[[json objectAtIndex:indexPath.row] objectForKey:@"assistant"] 
```

如果你希望它是一个数组然后创建一个数组，检查返回的 json 是一个数组，将你的数组设置为 json 数组并在你的 tableview 中使用你的数组。

下面是我如何处理此问题的示例，我使用自己的帮助程序类，因此忽略该部分，但请注意我如何检查它是否为数组，然后将其分配给等待数据的 NSArray。然后我在我的 TableView 中使用该 NSArray 并从中加载我的数据。

```
-(void)downloadFinished:(id)sender {

    if ([sender isKindOfClass:[JsonHelper class]]) {

        JsonHelper *jsonHelper = (JsonHelper *)sender;

            NSData *data = [[NSData alloc] initWithData:jsonHelper.receivedData];
            NSDictionary *jsonReturn=[NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingMutableContainers error:nil];
            NSLog(@"History Return:%@",jsonReturn);

            if ([jsonReturn objectForKey:@"calls"]) {

                if ([[jsonReturn objectForKey:@"calls"]isKindOfClass:[NSArray class]]) {

                    historyArray = [jsonReturn objectForKey:@"calls"];
                    NSLog(@"History Array:%@",historyArray);
                    [historyTableView reloadData];

                } else {

                   // Error stuff goes here it was not an array.
                }
            } 
        } 
```

在我的 TableView 方法中，我只引用了数组

```
-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {

    return [historyArray count];
} 
```

ETC....

# android - NPE onCreate 导致 Android 片段崩溃

> ID：15668169
> 
> 赞同：0
> 
> 时间：2013-03-27T19:53:00.107
> 
> 标签：android, android-fragments

我被困住了，我会很感激有一双新的眼睛。我点击一下就可以`MainActivity`打电话`fragment`了`button`。它拉得很好，然后我在中添加了`database`调用，`fragment`现在它崩溃了。在我的 logcat 中，它说我在我的 onCreate 中得到一个空指针异常。这是代码和logcat。

**片段代码**

```
public class StatsFragment extends Fragment {
    public static MySmokinDatabase mySmokinDatabase;
    public static Model model;
    View view;

    public View onCreateView(LayoutInflater inflater,
            ViewGroup container,
            Bundle savedInstanceState) {

        model = MainActivity.model;
        mySmokinDatabase = new MySmokinDatabase(getActivity());

        TextView daysText = (TextView) getView().findViewById(R.id.days); 
        TextView totalText = (TextView) getView().findViewById(R.id.total); 
        TextView aveText = (TextView) getView().findViewById(R.id.ave);
        try {
            daysText.setText("" + (model.getDays())); 
            totalText.setText("" + mySmokinDatabase.getTotal());
            if (model.getDays() > 0) 
            aveText.setText("" + (float) mySmokinDatabase.getTotal() / (float) model.getDays());
        }

        catch (Exception e) {
            Log.v("*** DEBUG ***", "Error");
            System.out.print("error" + e);
        }

        // Create, or inflate the Fragment’s UI, and return it.
        // If this Fragment has no UI then return null.
        view = inflater.inflate(R.layout.stats_frag, container, false);
        return view;
    }
} 
```

**按钮处理程序**

```
public void statisticsHandler(View view) {
    FragmentManager fm = getFragmentManager();
    FragmentTransaction ft = fm.beginTransaction();
    Log.v("*** DEBUG ***", "Statistics Handler");
    ft.replace(R.id.main_container_Id, new StatsFragment());
    ft.commit();
} 
```

**日志猫**

```
03-27 15:40:03.767: W/dalvikvm(862): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
03-27 15:40:03.867: E/AndroidRuntime(862): FATAL EXCEPTION: main
03-27 15:40:03.867: E/AndroidRuntime(862): java.lang.NullPointerException
03-27 15:40:03.867: E/AndroidRuntime(862):  at com.example.smokin4tomsullivan.StatsFragment.onCreateView(StatsFragment.java:24)
03-27 15:40:03.867: E/AndroidRuntime(862):  at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:829)
03-27 15:40:03.867: E/AndroidRuntime(862):  at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:1035)
03-27 15:40:03.867: E/AndroidRuntime(862):  at android.app.BackStackRecord.run(BackStackRecord.java:635)
03-27 15:40:03.867: E/AndroidRuntime(862):  at android.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1397)
03-27 15:40:03.867: E/AndroidRuntime(862):  at android.app.FragmentManagerImpl$1.run(FragmentManager.java:426)
03-27 15:40:03.867: E/AndroidRuntime(862):  at android.os.Handler.handleCallback(Handler.java:615)
03-27 15:40:03.867: E/AndroidRuntime(862):  at android.os.Handler.dispatchMessage(Handler.java:92)
03-27 15:40:03.867: E/AndroidRuntime(862):  at android.os.Looper.loop(Looper.java:137)
03-27 15:40:03.867: E/AndroidRuntime(862):  at android.app.ActivityThread.main(ActivityThread.java:4745)
03-27 15:40:03.867: E/AndroidRuntime(862):  at java.lang.reflect.Method.invokeNative(Native Method)
03-27 15:40:03.867: E/AndroidRuntime(862):  at java.lang.reflect.Method.invoke(Method.java:511)
03-27 15:40:03.867: E/AndroidRuntime(862):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
03-27 15:40:03.867: E/AndroidRuntime(862):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
03-27 15:40:03.867: E/AndroidRuntime(862):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T19:54:37.683

`view = inflater.inflate(R.layout.stats_frag, container, false);`在获得您的意见之前进行设置，如下所示

在获取视图时使用`getActivity()`而不是。`getView()`

IE

```
 TextView daysText = (TextView) getActivity().findViewById(R.id.days); 
    TextView totalText = (TextView)  getActivity().findViewById(R.id.total); 
    TextView aveText = (TextView) getActivity().findViewById(R.id.ave); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T19:59:11.397

在获取视图之前将其移近顶部。您正在获得 NPE，因为 findViewById 调用返回 null。

```
// Create, or inflate the Fragment’s UI, and return it.
// If this Fragment has no UI then return null.
view = inflater.inflate(R.layout.stats_frag, container, false); 
```

在你抓住意见之前。然后做

```
TextView daysText = (TextView) view.findViewById(R.id.days); 
TextView totalText = (TextView) view.findViewById(R.id.total); 
TextView aveText = (TextView) view.findViewById(R.id.ave); 
```

# bash - if 语句和 if 使用 bash 中的调用函数

> ID：15668170
> 
> 赞同：39
> 
> 时间：2013-03-27T19:53:01.877
> 
> 标签：bash, testing, if-statement

我写了一个函数：

```
check_log(){
    if [ -f "/usr/apps/appcheck.log" ]
    then
         return 1
    else
         return 0
    fi
} 
```

然后我在“if”条件下调用这个函数：

```
if [ check_log ];
then
    ........statements....
fi 
```

这行得通吗？我在这里感到困惑，因为 bash 在成功时返回 0，在失败时返回 1，但是我的函数正在返回`1`并且条件正在检查`1`/ `0`，它得到`1`并且应该给出失败，但是在我的 shell 脚本中，条件正在通过。

任何人都可以阐明这个问题吗？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2013-03-27T19:55:06.133

```
if [ check_log ]; 
```

当您使用方括号时，您正在调用`test`命令。它相当于`if test check_log`which 是 的简写`if test -n check_log`，这又意味着“如果`"check_log"`不是空字符串”。它根本不调用你的`check_log`函数。

将其更改为：

```
if check_log; 
```

顺便说一句，函数可以更简单地写成：

```
check_log() {
    ! [ -f "/usr/apps/appcheck.log" ]
} 
```

函数的返回值是最后一个命令的退出状态，因此不需要显式的返回语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-28T21:27:16.780

正如@john-kugelman 所指出的，一种解决方案（也许是最正确的一种）是使用以下语法：

```
if check_log; 
```

~~但另一种解决方案是：~~

 ~~```
if [[ $(check_log; echo $?) -eq 0 ]]; 
```~~ 

~~我个人的偏好是后者，因为它促进了条件语句之间的一致性。但缺点是因为它依赖于命令替换，它会派生一个子进程（即子shell），而第一种方法不会。~~

可以在此处找到有关该主题的有趣阅读：

[什么时候命令替换比单独的相同命令产生更多的子shell？](https://stackoverflow.com/q/21331042/3321356)

**更新（2020-12-01）**：在大多数情况下，由于效率低下和可能触发错误结果的原因，不建议使用上述替代解决方案，尤其是在被调用函数写入 stderr 或 stdout 并且输出未被捕获的情况下.

**更新（2017-10-20）**：删除我对第二种方法的偏好，因为这些天我的任务是防止不必要的分叉。第一个解决方案中的语法对于非 shell 编程来说并不那么直观，但它肯定更有效。

# android - 如何从存储在android资产文件夹中的数据库中获取数据

> ID：15668172
> 
> 赞同：0
> 
> 时间：2013-03-27T19:53:10.597
> 
> 标签：android, sqlite, assets

我使用 SQLite 数据库浏览器创建了我的数据库，并将其存储到我项目的 assets 文件夹中。当我试图从该文件夹中获取数据时，它显示错误

```
03-28 01:07:39.840: E/AndroidRuntime(7390): FATAL EXCEPTION: main
03-28 01:07:39.840: E/AndroidRuntime(7390): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.pocketdr/com.example.pocketdr.PocketDoc}: android.database.sqlite.SQLiteException: near "/": syntax error: , while compiling: /data/data/com.example.pocketdr/databases/Diseases.db/Diseaseslist/
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1872)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1893)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.app.ActivityThread.access$1500(ActivityThread.java:135)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1054)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.os.Looper.loop(Looper.java:150)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.app.ActivityThread.main(ActivityThread.java:4385)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at java.lang.reflect.Method.invokeNative(Native Method)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at java.lang.reflect.Method.invoke(Method.java:507)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:849)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:607)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at dalvik.system.NativeStart.main(Native Method)
03-28 01:07:39.840: E/AndroidRuntime(7390): Caused by: android.database.sqlite.SQLiteException: near "/": syntax error: , while compiling: /data/data/com.example.pocketdr/databases/Diseases.db/Diseaseslist/
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.database.sqlite.SQLiteCompiledSql.compile(SQLiteCompiledSql.java:92)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.database.sqlite.SQLiteCompiledSql.<init>(SQLiteCompiledSql.java:65)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:73)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:49)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:53)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1442)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.database.sqlite.SQLiteDatabase.rawQuery(SQLiteDatabase.java:1410)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at com.example.pocketdr.Database.getSymptom(Database.java:215)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at com.example.pocketdr.PocketDoc.onCreate(PocketDoc.java:60)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1072)
03-28 01:07:39.840: E/AndroidRuntime(7390):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1836)
03-28 01:07:39.840: E/AndroidRuntime(7390):     ... 11 more 
```

数据库助手类

```
public class Database extends SQLiteOpenHelper{
 private static String DB_PATH = "/data/data/com.example.pocketdr/databases/";
private static final String DB_NAME = "Diseases.db";
private static final int DB_VERSION_NUMBER = 1;
public static final String DB_TABLE_NAME = "Diseaseslist";
private static final String  _ID="id";
public static final String COLUMN_1_NAME = "Name";
private static final String COLUMN_2_Symptom="Symptom";
private static final String COLUMN_3_Symptom1="Symptom1";
private static final String COLUMN_4_Symptom2="Symptom2";
private static final String COLUMN_5_Symptom3="Symptom3";
private static final String COLUMN_6_Discription="Discription";
private static final String COLUMN_7_Precaution="Precaution";
String[] str,str1,str2;

private SQLiteDatabase sqliteDBInstance ;
private final Context myContext;
public Database(Context context) {
    super(context, DB_NAME, null, DB_VERSION_NUMBER);
    this.myContext = context;
}

public void createDataBase() throws IOException
 {

     boolean dbExist = checkDataBase();

     if(dbExist){
     //do nothing - database already exist
     }else{

     //By calling this method and empty database will be created into the default system path
     //of your application so we are gonna be able to overwrite that database with our database.
     this.getReadableDatabase();

     try {

     copyDataBase();

     } catch (IOException e) {

     throw new Error("Error copying database");

     }
     }

     }

     /**
       * Check if the database already exist to avoid re-copying the file each time you open the application.
       * @return true if it exists, false if it doesn't
       */
     private boolean checkDataBase(){

     SQLiteDatabase checkDB = null;

     try{
     String myPath = DB_PATH + DB_NAME;
     checkDB = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);

     }catch(SQLiteException e){

     //database does't exist yet.

     }

     if(checkDB != null){

     checkDB.close();

     }

     return checkDB != null ? true : false;
     }

     /**
       * Copies your database from your local assets-folder to the just created empty database in the
       * system folder, from where it can be accessed and handled.
       * This is done by transfering bytestream.
       * */
     private void copyDataBase() throws IOException{

     //Open your local db as the input stream
     InputStream myInput = myContext.getAssets().open(DB_NAME);

     // Path to the just created empty db
     String outFileName = DB_PATH + DB_NAME;

     //Open the empty db as the output stream
     OutputStream myOutput = new FileOutputStream(outFileName);

     //transfer bytes from the inputfile to the outputfile
     byte[] buffer = new byte[1024];
     int length;
     while ((length = myInput.read(buffer))>0){
     myOutput.write(buffer, 0, length);
     }

     //Close the streams
     myOutput.flush();
     myOutput.close();
     myInput.close();

     }

     public void openDataBase() throws SQLException{

     //Open the database
     String myPath = DB_PATH + DB_NAME;
     sqliteDBInstance = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);

     }

     @Override
     public synchronized void close() {

     if(sqliteDBInstance != null)
     sqliteDBInstance.close();

     super.close();

     }

@Override
public void onCreate(SQLiteDatabase sqliteDBInstance) {

    // TODO Auto-generated method stub

}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // TODO Auto-generated method stub

}

    public long insertDiseases(String Name,String Symptom,String Symptom1,String Symptom2,String Symptom3,String Description, String Precaution)
    {
        ContentValues contentValues = new ContentValues();
        contentValues.put(COLUMN_1_NAME, Name);
        contentValues.put(COLUMN_2_Symptom, Symptom);
        contentValues.put(COLUMN_3_Symptom1, Symptom1);
        contentValues.put(COLUMN_4_Symptom2, Symptom2);
        contentValues.put(COLUMN_5_Symptom3, Symptom3);
        contentValues.put(COLUMN_6_Discription, Description);
        contentValues.put(COLUMN_7_Precaution, Precaution);
        Log.i(this.toString() + " - insertCountry", "Inserting: " + Name);
        return this.sqliteDBInstance.insert(DB_TABLE_NAME, null, contentValues);
    }

    public boolean removeDiseases(String Name)
    {
        int result = this.sqliteDBInstance.delete(DB_TABLE_NAME, "Name='" + Name + "'", null);

        if(result > 0)
            return true;
        else
            return false;
    }

    public long updateCountry(String oldName, String newName)
    {
        ContentValues contentValues = new ContentValues();
        contentValues.put(COLUMN_1_NAME, newName);
        return this.sqliteDBInstance.update(DB_TABLE_NAME, contentValues, "Name='" + oldName + "'", null);
    }

    public String[] getSymptom()
    {
        String myPath1 = DB_PATH + DB_NAME+"/"+DB_TABLE_NAME+"/" ;

    Cursor cursor = this.sqliteDBInstance.rawQuery(myPath1, new String[]{COLUMN_2_Symptom});//query(myPath1, new String[] {COLUMN_2_Symptom}, null, null, null, null, null);
 Log.i(COLUMN_2_Symptom, "Symptom"+cursor);
        if(cursor.getCount() >0)
        {
             str = new String[cursor.getCount()];
            int i = 0;

            while (cursor.moveToNext())
            {
                 str[i] = cursor.getString(cursor.getColumnIndex(COLUMN_2_Symptom));
                 i++;
             }

            return str;
        }
        else
        {
            return new String[] {};
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:54:09.703

```
 public String[] getSymptom()
    {
        String myPath1 = DB_PATH + DB_NAME+"/"+DB_TABLE_NAME+"/" ;

    Cursor cursor = this.sqliteDBInstance.rawQuery(myPath1, new String[]{COLUMN_2_Symptom});
    } 
```

您的 String myPath1 应该包含一个有效的 SQLite 查询而不是数据库表的路径。

尝试类似“Select * from your_tablename Where column_name = value”

或者您可以使用查询而不是 rawQuery。参考[这个](http://www.mysamplecode.com/2011/10/android-sqlite-query-example-selection.html)

# go - 是否有适用于 Go 的规则引擎/推理引擎

> ID：15668174
> 
> 赞同：5
> 
> 时间：2013-03-27T19:53:18.020
> 
> 标签：go, rule-engine

我们想用 Go 来实现我们的业务逻辑，但是我们找不到 Go 的规则引擎/推理引擎的任何好的实现。有没有人有任何经验或建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-08T21:08:04.797

有一个项目旨在在 Go 中实现 ISO Prolog 编译器：

*   [围棋](http://godoc.org/github.com/mndrix/golog)。

我还没有测试过它，但鉴于它实现了一些基本的 Prolog，这应该是一个非常强大的基于规则的推理引擎，AFAIS。

否则，在[godoc.org](http://godoc.org)上搜索“规则”也会产生一堆包：

*   [godoc.org/?q=rule](http://godoc.org/?q=rule)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T13:48:40.607

据我所知，最好的例子是在许多标准库中采用的“表驱动”单元测试方法。例如，[fmttests](http://golang.org/src/pkg/fmt/fmt_test.go)。

除此之外，Go 是一种强大的、富有表现力的语言。你真正需要什么？Go 中有许多状态机实现的示例，以及许多具有声明性 JSON 配置的 Web 框架。

如果您的意思是正确的逻辑编程，那么目前还没有流行的 Go 库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-13T09:12:56.400

如果您熟悉 JBoss Drools，那么现在 Golang 中也有类似的东西。看看这个[https://github.com/newm4n/grool](https://github.com/newm4n/grool)

它具有类似于 Drools DRL 的 DSL，称为 GRL。

```
rule SlowDown "When testcar is slowing down we keep decreasing the speed." salience 10  {
    when
        TestCar.SpeedUp == false && TestCar.Speed > 0
    then
        TestCar.Speed = TestCar.Speed - TestCar.SpeedIncrement;
        DistanceRecord.TotalDistance = DistanceRecord.TotalDistance + TestCar.Speed;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-10T11:05:30.980

看看[https://github.com/antonmedv/expr](https://github.com/antonmedv/expr)

它可以解析下一个表达式：

```
# Get the special price if
user.Group in ["good_customers", "collaborator"]

# Promote article to the homepage when
len(article.Comments) > 100 and article.Category not in ["misc"]

# Send an alert when
product.Stock < 15 
```

键入检查并评估。

代码也很好： [![构建状态](../Images/62947f47a9203a2bde9cd486e7ba179d.png)](https://travis-ci.org/antonmedv/expr) [![去报告卡](../Images/119db2d7747e6ee36ee44aefbf544cf7.png)](https://goreportcard.com/report/github.com/antonmedv/expr) [![代码覆盖率](../Images/265f3b09b558fc0c3c61e88bbe43102e.png)](https://scrutinizer-ci.com/g/antonmedv/expr/?branch=master)

# gnuplot - 在使用自动 ytics 放置时限制 ytics 的数量

> ID：15668178
> 
> 赞同：0
> 
> 时间：2013-03-27T19:53:38.470
> 
> 标签：gnuplot

我编写了一个 bash 脚本，它生成文件，然后使用以下模板自动绘制这些文件（最小的工作示例）：

```
 set terminal epslatex color size 3,1.2
 set output "fig.tex"

 set ylabel '$\lambda_i$' offset +1.5,0
 set xlabel '$i$' offset 0,+0.5
 set logscale x
 set mxtics 5
 set mytics 5
 plot "file.dat"  w p pt 7 ps 0.7 lc rgb "#033775" 
```

一切都很好，但是当输入的数据跨越一个可观的价值范围时，往往会有太多的 ytics。

[没有足够的代表，所以这里是一个例子：http://i.stack.imgur.com/zd7XK.png]

我怀疑是 epslatex 终端导致了问题（即 gnuplot 不知道实际的字体高度，并且在可用空间中产生了太多的抽动）。我的解决方法是限制抽动的数量，同时允许自动放置抽动，但我找不到关于该主题的任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T00:24:05.597

一般来说，您可以减少 y 轴上的抽动频率

```
set ytics VALUE 
```

一个例子是：

```
plot sin(x) 
```

产生这个自动抽动（修复：删除图像链接）和

```
set ytics 0.5
plot sin(x) 
```

产生[这个](https://imgur.com/JEWIX6c)。

如果您不知道为 VALUE 设置哪个值，您可以使用 STATS_min_x 和 STATS_max_x 用于 gnuplot4.6 和 GPVAL_DATA_X_MIN 用于早期版本来计算。有关这些的用法，请参见[安迪拉斯的答案](https://stackoverflow.com/a/14129716/1834164)

或者（使用类似的用法）在这种情况下使用 GPVAL_Y_MIN 和 GPVAL_Y_MAX 可能更有用，因为它们已经四舍五入。

然后你可以使用例如：

```
set terminal unknown
plot(x)
ntics = 4.
dy = floor((GPVAL_Y_MAX-GPVAL_Y_MIN+0.5)/ntics*10.)/10.
set ytics dy
set terminal ...
replot 
```

对于上面的示例，它会产生指定的 4 个抽动（修复：删除图像的链接）。

# python - 制作具有超过 1 个值的列表的字典

> ID：15668184
> 
> 赞同：0
> 
> 时间：2013-03-27T19:54:03.573
> 
> 标签：python, list, dictionary

我是 python 的新手，很难弄清楚列表和 dict 是如何工作的。在我的程序中，我有一个如下所示的列表：

```
Hat =[334,hat,59,200] 
```

`334`我想用一个键和 vaule =做成一个字典`[hat,59,200]`。我怎么能这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T23:40:59.627

只需使用[slice](https://stackoverflow.com/questions/509211/the-python-slice-notation)提取第一个和所有其他元素：

```
{Hat[0]: Hat[1:]} 
```

如果您有多个帽子，则可以使用[字典理解](http://docs.python.org/3/tutorial/datastructures.html#dictionaries)：

```
hats = [
    [334,'hat',59,200],
    [123,'chapeau',19,300],
    [999,'hut',1,100],
]

print( {Hat[0]: Hat[1:] for Hat in hats} ) 
```

# wcf - WCF DuplexChannel - 没有回调的连接

> ID：15668185
> 
> 赞同：0
> 
> 时间：2013-03-27T19:54:03.810
> 
> 标签：wcf, callback, channelfactory, duplex-channel

我有一个定义了回调的 WCF 接口。这工作得很好。

现在我有另一个不需要回调的客户端。我想知道是否有一种方法可以在不指定回调对象的情况下连接到服务？

我试过没有 DuplexChannel 工厂，或者 DuplexChannelFactory 和 InstanceContext (null)，都没有用！

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:20:48.127

最好的方法是创建另一个没有 CallbackContract 的接口并将其公开在单独的端点上。这将使您清楚地分离两个代码路径，并且客户端可以选择使用哪一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:55:41.570

我现在从这里尝试了这个类：http: [//www.codeproject.com/Articles/22832/Automatic-Interface-Implementer-An-Example-of-Runt](http://www.codeproject.com/Articles/22832/Automatic-Interface-Implementer-An-Example-of-Runt) 效果很好！

# java - 请求不使用 PersistentCookieStore 中保存的 cookie

> ID：15668186
> 
> 赞同：1
> 
> 时间：2013-03-27T19:54:06.790
> 
> 标签：java, android, http, cookies

当我声明一个 cookie 存储时，我修复了我的应用程序中的崩溃和错误，但它没有保存 cookie 或在其他位置出现问题。

起初我称这两条线：

```
AsyncHttpClient client = new AsyncHttpClient();
PersistentCookieStore myCookieStore; 
```

然后我有一个帖子：

```
public void postRequestLogin(String url, RequestParams params) {
    myCookieStore = new PersistentCookieStore(this);
    client.post(url, params, new AsyncHttpResponseHandler() {
        @Override
        public void onSuccess(String response) {
            client.setCookieStore(myCookieStore);
            System.out.println(response);

            if(response.contains("Login successful!")) {
                TextView lblStatus = (TextView)findViewById(R.id.lblStatus);
                lblStatus.setText("Login successful!");
                getRequest("url");
            } else {
                TextView lblStatus = (TextView)findViewById(R.id.lblStatus);
                lblStatus.setText("Login failed!");
                TextView source = (TextView)findViewById(R.id.response_request);
                source.setText(response);
            }
        }
    });

} 
```

然后它应该保存 Logincookies 并将其用于 GET 请求：

```
public void getRequest(String url) {
    myCookieStore = new PersistentCookieStore(this);
    client.get(url, new AsyncHttpResponseHandler() {
        @Override
        public void onSuccess(String response) {
            client.setCookieStore(myCookieStore);
            System.out.println(response);
            TextView responseview = (TextView) findViewById(R.id.response_request);
            responseview.setText(response);
        }
    });
} 
```

但它不使用cookies。当我执行 GET 请求时，我已经注销。

编辑：我忘了说我使用了本教程中的一个库：http: [//loopj.com/android-async-http/](http://loopj.com/android-async-http/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:02:36.450

我认为问题在于您在请求完成后（在`onSuccess`方法中）设置了 cookie 存储。在发出请求之前尝试设置它：

```
myCookieStore = new PersistentCookieStore(this);
client.setCookieStore(myCookieStore);
client.post(url, params, new AsyncHttpResponseHandler() { 
```

您还将针对每个请求创建一个新的 cookie 存储。如果您执行多个请求会发生什么？它将创建一个新的 cookie 存储并使用它（新的 cookie 存储不会有您的 cookie）。尝试将这部分代码移动到您的构造函数中：

```
myCookieStore = new PersistentCookieStore(this);
client.setCookieStore(myCookieStore); 
```

然后将其从其他功能中删除。

# jsp - 为什么 不能正常工作？

> ID：15668188
> 
> 赞同：1
> 
> 时间：2013-03-27T19:54:14.947
> 
> 标签：jsp, jstl

我想在我的 JSP 中使用有效的 SQL 语句，如下所示：

```
<sql:query var="test" dataSource="DL">
select p.name name, j.description job_description, d.description department_description
from person as p, job as j, department as d
where ...
</sql:query> 
```

因为我加入了 3 个表，所以我有 2 个重复的名称：“描述”，我通常在 SQL 中使用这些字段名称的别名来解决。在 JSP 中，这没有正确处理，无法通过别名访问结果集，并且只有“description”可用，但“job_description”或“department_description”不可用。

这工作不足：

```
<c:forEach var="row" items="${test.rows}">
${row.description}
</c:forEach> 
```

这根本不起作用：

```
<c:forEach var="row" items="${test.rows}">
${row.job_description}
</c:forEach> 
```

这个问题有没有解决方案（恕我直言，这是一个错误）？

这是我的 context.xml：

```
<Context path="/test" docBase="test" reloadable="true" crossContext="true">
  <Resource 
  name="DL" 
  auth="Container" 
  type="javax.sql.DataSource"
  maxActive="100" 
  maxIdle="30"
  maxWait="10000"
  username="xxx" 
  password="xxx" 
  driverClassName="com.mysql.jdbc.Driver"
  url="jdbc:mysql://localhost:3306/test"/>
</Context> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T22:08:40.027

问题是 中的`dataSource`属性`<sql:query>`。假设您已使用在同一页面中声明数据源

```
<!-- rest of attributes omitted here -->
<sql:setDataSource var="DL"> 
```

它应该是

```
<sql:query var="test" dataSource="${DL}">
    your query...
</sql:query> 
```

如果您的数据源是使用 JNDI 配置的，那么您应该使用 JNDI 名称：

```
<sql:query var="test" dataSource="jdbc/DL">
    your query...
</sql:query> 
```

有关的：

*   [JSTL sql：查询变量](https://stackoverflow.com/q/6090862/1065197)

* * *

根据您的`<Resorce>`定义，看起来 JNDI 根本找不到您的数据源。将名称从 更改`name="DL"`为`name="jdbc/DL"`并确保您的*context.xml*文件位于 Web 项目的 META-INF 文件夹中。有了这个，那么您`<sql:query>`应该按照第二个示例中的说明进行定义（使用 JNDI）。

* * *

在基于此进行测试用例之后，`<sql:query>`当多次具有相同的列名时看起来像一个错误。我在这个问题中使用解决方案解决了：[如何使用 JSTL sql:query 访问重复的列名？](https://stackoverflow.com/q/14431907/1065197)

因此，假设您的数据源配置良好，您只需将查询更改为

```
<!-- I came up with the where part, it could be different in your case -->
<sql:query var="test" dataSource="jdbc/DL">
    select p.name name,
                concat(j.description, '') 'jdescription',
                concat(d.description, '') 'ddescription'
    from person p, job j, department d
    where p.jobID = j.id AND p.departmentID = d.id
</sql:query>

Descriptions:
<br />
<table>
<c:forEach var="row" items="${test.rows}">
    <tr>
        <td>${row.name}</td>
        <td>${row.jdescription}</td>
        <td>${row.ddescription}</td>
    </tr>
</c:forEach> 
```

是的，这是一种丑陋的处理方式，但似乎没有其他使用 JSTL 的解决方案。作为建议，最好从 Servlet 获取数据并将结果设置为请求属性的一部分以便显示它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:15:16.187

我不确定我是否记错了，但在 SQL 中我相信你必须使用`AS`关键字来创建列别名。

我不确定我是对的，但试试这个：

```
<sql:query var="test" dataSource="DL">
select p.name name, j.description as job_description, d.description as department_description
from person as p, job as j, department as d
where ...
</sql:query> 
```

如果它不起作用，那么只需在数据库中为您的选择创建一个视图，然后从该视图中选择行或重命名您的重复列。

# c# - 从 XP 及更高版本获取 Windows 操作系统名称

> ID：15668190
> 
> 赞同：2
> 
> 时间：2013-03-27T19:54:17.720
> 
> 标签：c#, operating-system

我试图弄清楚如何获取 Windows 8 的操作系统名称。我目前正在使用以下代码，但它不处理 Windows 7 或 Windows 8。

如何处理更新的 Windows 版本？

```
System.OperatingSystem os = Environment.OSVersion;
Version vs = os.Version;

if (os.Platform == PlatformID.Win32Windows)
{    
    switch (vs.Minor)
    {
        case 0:
            operatingSystem = "95";
            break;
        case 10:
            if (vs.Revision.ToString() == "2222A")
                operatingSystem = "98SE";
            else
                operatingSystem = "98";
            break;
        case 90:
            operatingSystem = "Me";
            break;
        default:
            break;
    }
}
else if (os.Platform == PlatformID.Win32NT)
{
    switch (vs.Major)
    {
        case 3:
            operatingSystem = "NT 3.51";
            break;
        case 4:
            operatingSystem = "NT 4.0";
            break;
        case 5:
            if (vs.Minor == 0)
                operatingSystem = "2000";
            else
                operatingSystem = "XP";
            break;
        case 6:
            if (vs.Minor == 0)
                operatingSystem = "Vista";
            else
                operatingSystem = "7";
            break;
        default:
            break;
    }
}            
MessageBox.Show("operating System: " + operatingSystem + 
                "\nOS Version: " + os.Version.ToString() + 
                "\nOS Platoform: " + os.Platform.ToString() + 
                "\nOS SP: " + os.ServicePack.ToString() + 
                "\nOS Version String: " + os.VersionString.ToString()); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T19:58:17.890

从 Windows Vista 开始，发行版的主要编号为`6`. Windows Vista 有`6.0`，Windows 7 有`6.1`，Windows 8 有`6.2`。

有关概述，请参见[此处。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724832(v=vs.85).aspx)

**编辑**

```
switch (vs.Major)
{
    case 3:
        Console.WriteLine("Windows NT 3.51");
        break;
    case 4:
        Console.WriteLine("Windows NT 4.0");
        break;
    case 5:
        if (vs.Minor == 0)
            Console.WriteLine("Windows 2000");
        else
            Console.WriteLine("Windows XP");
        break;
    case 6:
        if(vs.Minor == 0)
            Console.WriteLine("Windows Vista");
        else if(vs.Minor == 1)
            Console.WriteLine("Windows 7");
        else if(vs.Minor == 2)
            Console.WriteLine("Windows 8")
        break; 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T20:01:27.547

您可以使用它[`System.Environment.OSVersion`](http://msdn.microsoft.com/en-us/library/system.environment.osversion.aspx)并且正在寻找 6.2

对于 Windows 8，您应该检查以下内容：

```
var os = System.Environment.OsVersion;
bool isWindows8 = os.MajorVersion == 6 && os.MinorVersion == 2 
```

# javascript - 如何引用动态创建的文本框

> ID：15668195
> 
> 赞同：-1
> 
> 时间：2013-03-27T19:54:42.010
> 
> 标签：javascript

使用 Javascript 或 jquery，我将如何引用一些动态创建的文本框。我有以下引用一个文本框的javascript，但是当创建其他文本框时，它们具有不同的ID。有什么想法吗？

```
<script type="text/javascript">
$(function(){
    $('#lst_vat').change(function(){

  var inpvat = $('#lst_vat').val();
        $.ajax({
            type:'POST',
            data:({id : inpvat}),
            dataType:'json',
        url:"phpcode/get_vat_rate.php",
        //url:"ajax_product_list.php",
        success: function(data){
            $('.results').html(data);
             $('#txt_line_vat').val(data.vat_rate_value);    
            }
        });
    });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:59:31.817

您可以通过使用 textarea 的 class 属性或 name 属性以及当然 Javascript 来做到这一点。

# erlang - 列表推导与高阶函数

> ID：15668199
> 
> 赞同：2
> 
> 时间：2013-03-27T19:55:05.383
> 
> 标签：erlang, list-comprehension, higher-order-functions

以下哪个代码片段是首选？为什么？

```
check_number(X) ->                                                                    
    case lists:filter(fun(Y) -> check_num(Y) end, lists:seq(1,X)) of                  
        [] -> empty;            
        List -> io:format("~w~n", [List]) 
    end. 
```

或者

```
check_number(X) ->
    io:format("~w~n", [[N || N <- lists:seq(1,X), check_num(N)]]). 
```

假设 check_num(N) 是一个谓词。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T21:58:18.807

你的第二个功能不等于第一个。你可以编写你的第一个函数，它等于第二个函数：

```
check_number(X) ->
    io:format("~w~n", [lists:filter(fun check_num/1, lists:seq(1,X))]). 
```

正如你所看到的，它看起来并不大。使用哪一种完全取决于您和您的同事的美感。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T14:39:05.153

您的功能到底`check_number/1`应该做什么？如果没有满足的整数，第一个*返回* ，而如果有这样的整数，它会*打印*它们的列表并*返回*（的返回值）。而第二个总是*打印*列表，即使它是空的，并*返回*。`empty``check_num/1` **`ok``io:format` **`ok`****

 ***请注意，打印值和返回是完全不同的两件事。因此，我的问题是你的功能应该做什么。

哪种选择在这里纯粹是一种选择，您可以选择您觉得看起来更好的选择。列表推导通常提供一种表达映射和过滤器的简洁方式。***

# javascript - 如何将 onerror 绑定到 Backbone 视图中的图像？

> ID：15668203
> 
> 赞同：2
> 
> 时间：2013-03-27T19:55:08.023
> 
> 标签：javascript, backbone.js, backbone-views, backbone-events

我想将一个事件绑定到`onerror`我视图中的图像。

`onerror`不会冒泡，所以我不能使用`events: { 'error img' : 'imgEvent_' }`.

我怎样才能将它绑定到类似的东西`this.el.querySelector('img').on('error, imgEvent_, this);`？

请不要使用内联 HTML。

忘了提...我不使用任何 DOM 库，所以没有 jQuery 之类的。

我这样做了：

```
this.el.queryelector('img').onerror = this.myFunction_; 
```

我现在的问题是 within `this.myFunction_`,`this`实际上是`img`元素......我仍然需要访问`this`where`myFunction_`驻留。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:02:11.643

您不能在事件映射中绑定 onerror，因为 Backbone.js 将事件从文档委托到指定元素 ( [http://api.jquery.com/delegate/](http://api.jquery.com/delegate/) )：

```
events: { 'error img': 'callaback' } 
```

意思是这样的：

```
$(document).on('error', 'img', callback); 
```

有文件onerror？它可以委托给img吗？

我建议你自己绑定它：

```
this.$('img').on('error', callback); 
```

PS对不起我的英语。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-30T15:27:59.880

[您可以从提供给错误函数](https://developer.mozilla.org/en-US/docs/Web/Events/error)的第一个参数的目标属性中引用图像元素。您可以使用[Underscore 的 bind method](http://underscorejs.org/#bind)将该方法绑定到您的视图。

```
this.el.queryelector('img').onerror = _.bind(function(error){
    var img = error.target;
    this.myFunction_();
}, this); 
```

如果您只需要`myFunction`始终参考视图而不关心图像或其他内容，则可以使用

```
this.el.queryelector('img').onerror = _.bind(this.myFunction_, this); 
```

或[Underscore 的 bindAll 方法](http://underscorejs.org/#bindAll)。

```
_.bindAll(this, 'myFunction_');
this.el.queryelector('img').onerror = this.myFunction_; 
```

# macos - 在没有以太网连接的情况下修复 osx 上的 Ip

> ID：15668205
> 
> 赞同：0
> 
> 时间：2013-03-27T19:55:13.513
> 
> 标签：macos, loopback

我正在运行具有修复 IP 地址的 mampwordpress 服务器以进行开发。当我离线时，如果没有 ehternet 连接，服务器将无法使用。

我怎样才能在osx上进行环回或其他东西来伪造以太网地址？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T08:42:22.070

我找到了：

sudo ifconfig lo0 别名 IPadresse

停用

sudo ifconfig lo0 -alias IPadresse

# enterprise-library - 使用 Assembly.LoadFrom 的企业库 CustomTraceListner

> ID：15668206
> 
> 赞同：1
> 
> 时间：2013-03-27T19:55:17.150
> 
> 标签：enterprise-library

所以我创建了一个自定义跟踪侦听器，它继承自`Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.CustomTraceListener`.

跟踪侦听器是一个实用程序 dll，实用程序 dll 正在从`utility.dll.config`.

我正在使用`LogWriterFactory("utility.dll.config")`创建`LogWriter`.
当我在控制台应用程序中向我添加直接引用时，`utility.dll`一切正常。

但是如果我使用`Assembly.LoadFrom("utility.dll")`然后我得到以下错误：

```
The type 'Utility.CustomTraceListner, Utility' cannot be resolved. 
```

如果我将utility.dll 添加到GAC，那么一切正常。我可以`AppDomain.CurrentDomain.GetAssemblies()`在上面的线上运行`logWriterFactory.Create()`，看看`utility.dll`已经加载了。

我什至可以`AppDomain.CurrentDomain.CreateInstanceFrom("Utility.dll", "Utility.CustomTraceListener")`在调用之前运行`logWriterFactory.Create()`并获取实例而没有任何问题。

我们有一个使用的内部应用程序，`Assembly.LoadFrom`我们希望加载的每个程序集都有自己的配置文件/日志设置，这些设置与加载应用程序分开。

任何想法如何在不将其`utility.dll`放入 GAC 的情况下解决此问题？

我知道该`utility.dll.config`文件是正确的，因为当直接引用实用程序程序集时它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T12:47:24.353

连接到 ResolveEventHandler 解决了这个问题。

[http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx)

# asp.net - 在 ASP.NET 网站模型中创建成员资格提供程序

> ID：15668219
> 
> 赞同：0
> 
> 时间：2013-03-27T19:56:09.673
> 
> 标签：asp.net, asp.net-membership

我查看了一些教程，它们似乎都将 Web 应用程序模型用于会员提供程序。如何在使用网站模型的现有网站中创建会员资格？还是不可能/不喜欢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T15:47:53.730

ASP.NET 成员资格早在 Web 应用程序之前就可用。

但是，您想尝试[新的 ASP.NET 通用提供程序](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx)（旧成员资格提供程序的更新版本）。

1.  遵循 Scott Hanselman 教程的前半部分（后半部分是针对 MVC 的）
2.  遵循[检查 ASP.NET 的成员资格、角色和配置文件 - 第 1 部分](http://www.4guysfromrolla.com/articles/120705-1.aspx)旧版 ASP.Net。

**注意：**我并没有真正`ASP.NET Universal Providers`在 ASP.Net 网站中测试 New，因为我们所有的网站都是 Web 应用程序。

如果新的不起作用，您可以一直执行步骤 2。唯一不同的是`New ASP.NET Universal Providers`使用实体框架。

# javascript - 检测 div 是否具有通过单击添加的某个类（不刷新）

> ID：15668220
> 
> 赞同：0
> 
> 时间：2013-03-27T19:56:11.623
> 
> 标签：javascript, jquery

我正在检测没有特定类（class =“off”）的 div 上的点击，并且在函数结束时，设置了一个 cookie，该 cookie 会触发一些 php 代码在刷新页面后添加类“off”，等等之后单击并刷新页面，该功能的操作不再适用于该特定 div。到目前为止一切都很好...

我遇到的问题是我希望该功能停止在任何已单击的 div 上工作，而无需刷新页面。我尝试在函数末尾使用 .addClass 添加类，但即使现在单击 div 时它确实可以工作并添加“关闭”类，但如果再次单击，该函数仍然适用于 div，我感觉它没有检测到对原始 html 代码的更改。

如何让它一键停止工作？

```
$('#example').not('.off').click(function() {
// do stuff
$('#example').addClass('off');
} 
```

多谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:58:15.180

改为使用`$(this)`。

```
$('#example').not('.off').click(function() {
    $(this).addClass('off');
}); 
```

或者如果你想触发一个事件一次使用`one`

```
$('#example').one('click', function() {
    // this code will be executed once per element
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:03:40.020

绑定在元素上的处理程序不能仅通过删除类来删除。您还需要取消绑定处理程序

```
$('#example').not('.off').on('click', function() {
    // do stuff
    $('#example').addClass('off');
    //remove the event handler
    $('#example').off('click');
} 
```

另一种解决方案是您可以通过以下方式检查 div 是否已经具有该类

```
if($('#example').hasClass("off"))
{
    return;
} 
```

这是一个替代解决方案。我称之为快速修复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:06:07.080

不使用其他类并简单地删除事件处理程序怎么样[`.off`](http://api.jquery.com/off/)

```
$('#example').click(function() {
  $(this).off('click');
}); 
```

# jquery - Jquery Chosen：使用 Tab 按钮填充多项选择

> ID：15668221
> 
> 赞同：2
> 
> 时间：2013-03-27T19:56:11.930
> 
> 标签：jquery, jquery-chosen

[http://harvesthq.github.com/chosen/](http://harvesthq.github.com/chosen/)

这是示例页面，它具有多选输入。

当我开始输入时，它会突出显示选项。在这一刻，当我按下 Tab 按钮时，焦点会移到其他输入上，并将之前的输入留空。我想在用户开始输入时添加新选项，例如，用户输入'af'，'Afganistan'被突出显示，用户按下tab按钮并且必须添加Afganistan。

我试图处理tab键，并`$(optionid).click()`模拟鼠标或输入选择，但它不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T21:23:37.523

在 Chosen 之上添加事件处理程序时，我已经尝试了所有我能想到的方法，但无济于事。我尝试捕捉标签按下并模拟对突出显示的项目的单击并模拟在输入字段上按下 Enter 但无济于事。

但是我认为，如果您愿意破解 Chosen，只需要进行一些非常小的更改。

第一个变化：

```
Chosen.prototype.keydown_checker = function(evt) {
    ...
    //Replace the existing "case 9:" with this:
    case 9: //tab
        if(!this.is_multiple){
            if (this.results_showing && !this.is_multiple) {
                this.result_select(evt);
            }
            this.mouse_on_container = false;          
        }
        else {
            evt.preventDefault();
        }
        break;
    ...
} 
```

第二个变化：

```
AbstractChosen.prototype.keyup_checker = function(evt) {
    ...
    case 9: //Simply add this above "case 13:" and remove "case 9:" from further down the switch statement
    case 13: //Enter
    ...
} 
```

编辑：我现在已经使用他们捆绑的示例页面对此进行了测试，它似乎正在工作。如预期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T12:08:58.093

我做了一些改变，得到了我想要的。谢谢，彼得赫登堡！

```
AbstractChosen.prototype.keyup_checker = function (evt) { ...
    ... 
    case 9:
        if (this.search_field.val().length != 0) {
              if (this.results_showing) return this.result_select(evt);
        }
        break;
    case 13:
    ... 
```

第二个

```
Chosen.prototype.keydown_checker = function (evt) {
      case 9:
          if (!this.is_multiple) {
              if (this.results_showing && !this.is_multiple) {
                        this.result_select(evt);
                    }
              this.mouse_on_container = false;
          }
          else {
             if (this.search_field.val().length != 0) evt.preventDefault();
         }
         break; 
```

# gridview - ExtJS 4 网格标题中未显示子菜单项

> ID：15668222
> 
> 赞同：4
> 
> 时间：2013-03-27T19:56:18.000
> 
> 标签：gridview, extjs, extjs4, submenu

我正在尝试在网格标题中创建一个包含一些子菜单的菜单，但现在显示了子菜单项。这是我如何`getColumnMenu()`覆盖`Ext.grid.header.Container`：

```
Ext.override(Ext.grid.header.Container, {
    /**
     * Returns an array of menu CheckItems corresponding to all immediate children of the passed Container which have been configured as hideable.
     */
    getColumnMenu: function (headerContainer) {
        // debugger
        var xmenu = new Ext.menu.Menu({
            style: {
                overflow: 'visible'
            },
            items: [{
                text: 'Category 1',
                menu: [{
                    text: 'Item 1.1',
                    checked: true,
                    checkHandler: this.onColumnCheckChange
                }, {
                    text: 'Item 1.2',
                    checked: false,
                    checkHandler: this.onColumnCheckChange
                }]
            }, {
                text: 'Category 2',
                menu: [{
                    text: 'Item 2.1',
                    checked: true,
                    checkHandler: this.onColumnCheckChange
                }, {
                    text: 'Item 2.1',
                    checked: false,
                    checkHandler: this.onColumnCheckChange
                }]
            }]
        });

        var test = [];
        xmenu.items.each(function (item) {
            test.push(item);
        });
        return test;

    }
}); 
```

菜单类别 1 和类别 2 如下所示：

![在此处输入图像描述](../Images/be2ebe55ddbc20888595853601bed28f.png)

但是当我尝试显示他们的子菜单时，我收到一个错误：

![在此处输入图像描述](../Images/cc0ec07c00eb1d699983f8161513d178.png)

不知何故是`parentMenu`菜单的属性`undefined`。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T05:11:08.980

老实说，我不太确定您的代码为什么不起作用。我只是试图组织菜单和菜单项的创建，它奏效了。我使用了以下代码

```
getColumnMenu: function(headerContainer) {
    var menuItems = [];

        /* CATEGORY 1 */
        var itemsOneMenu = Ext.create('Ext.menu.Menu', {
            items: [{
                text: 'Item 1.1',
                checked: true,
                checkHandler: this.onColumnCheckChange
            },{
                text: 'Item 1.2',
                checked: false,
                checkHandler: this.onColumnCheckChange
            }]
        });

         categoryOneMenuItem = Ext.create('Ext.menu.Item', {
            text: 'Category 1',
            hideOnClick: false,
            menu: itemsOneMenu
        });

        /* CATEGORY 2 */
        var itemsTwoMenu = Ext.create('Ext.menu.Menu', {
            items: [{
                text: 'Item 2.1',
                checked: true,
                checkHandler: this.onColumnCheckChange
            },{
                text: 'Item 2.1',
                checked: false,
                checkHandler: this.onColumnCheckChange
            }]
        });

        categoryTwoMenuItem = Ext.create('Ext.menu.Item', {
            text: 'Category 2',
            hideOnClick: false,
            menu: itemsTwoMenu
        });

    menuItems.push(categoryOneMenuItem,categoryTwoMenuItem);
    return menuItems;
} 
```

在这里您可以找到一个运行示例[http://jsfiddle.net/alexrom7/xheHn/](http://jsfiddle.net/alexrom7/xheHn/)。唯一的观察是 EXT 将继续侦听 CheckItem **checkchange 事件**以显示或隐藏选定的列。

# iis - IIS 证书。与网站的关系证明

> ID：15668223
> 
> 赞同：-1
> 
> 时间：2013-03-27T19:56:18.810
> 
> 标签：iis, ssl, certificate

我需要为我的网站设置 https 连接。

对于开发，我将使用可以通过认证中心的特殊测试证书生成工具生成的测试证书。要创建证书，我需要填写一张表格，然后会生成测试证书。当然，对于真正的证书来说，一切都更加复杂，但我现在只能进行测试。

我的问题是，在测试证书生成过程中，有几个文件，如证书名称、组织名称、组织电子邮件、城市等。

*但是生成的证书将如何与我的域连接？*

据我了解，证书必须有一些指向域名的“链接”，以使用户知道他收到的证书来自我的域，而不是其他的。

例如，我有“mydomain.com”。而且我认为“mydomain.com”必须包含在证书的某个地方，当用户从我的网站收到数据时，它可以看到证书是正确的并且有关于域的信息。*我理解错了吗？*

为什么测试服务器证书工具没有域地址字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T21:14:11.313

客户端如何验证主机名（以及服务器证书应该如何）在[HTTPS 规范（RFC 2818）第 3.1 节](https://www.rfc-editor.org/rfc/rfc2818#section-3.1)（以及[RFC 6125](https://www.rfc-editor.org/rfc/rfc6125)）中进行了描述。

简而言之，您的主机名应位于 DNS 类型的主题备用名称 (SAN) 扩展中。如果没有 DNS SAN，它应该在您的主题 DN 的 CN（通用名称）RDN（相对可分辨名称）中。

从这个角度来看，其余的（组织、电子邮件……）几乎无关紧要：它将取决于 CA 策略。

遵循这个规范是很好的，即使对于测试证书也是如此。

# php - 与 API 共享 Cookie 以验证用户身份的最佳方式

> ID：15668225
> 
> 赞同：2
> 
> 时间：2013-03-27T19:56:29.570
> 
> 标签：php, javascript, api, security

我已经编辑了我的问题并使它变得简单，因为我认为它含糊不清。所以我把它变得简单了。我想使用存储在浏览器中的 cookie 使用 API 对用户进行身份验证。当然，cookie 会在每次登录时随机更改。

信息知识：在后端使用自定义API和php

而 Javascript 和 Tempojs 作为模板引擎前端。

编辑：

我的算法是这样的：数据库只有一个字段，每次登录都会更改，每次登录尝试都会增加。

当用户使用 php 登录时。会话和 cookie 生成，一个用于连接 api 的 cookie 将是

```
hash of (username + login attempt+ salt)= xxxxxxxyyyyyyxxxxxx 
```

现在 Api 知道 cookie 值应该是什么，因此它验证用户是否正确并响应数据。现在每当用户注销 cookie 过期并且 api 无法再进行身份验证。我将使用什么来获取我将发布的用户数据

通过 xmlhttprequest 将 Cookie 发送到位于不同子域的 api 服务器，并将数据加载到 Web 应用程序中。

如果有人认为这种方法易受攻击或不安全，这就是我的计划。请让我知道。是的，对于我将使用的跨域请求

header("Access-Control-Allow-Origin: *") 或 header("Access-Control-Allow-Origin: 'www.website.com'")

但如果你有备用。请描述我可以使用 jsonp 但我不想，而且我可能也必须上传文件数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T10:12:38.020

您提出的解决方案听起来不错。但是，您应该确保以下几点：

*   确保哈希中的盐足够长（为了安全起见，我只使用 32 个字符，尽管这有点多）。
*   确保盐确实是散列函数中的最后一个组件。如果不是，在某些情况下，攻击者可能会创建自己的 cookie（[方法](http://en.wikipedia.org/wiki/Length_extension_attack)如下）。
*   进行散列时使用分隔符。比如有一个用户`foo`，又有另一个用户`foo1`，不使用分隔符会出现这种情况：`foo`第11次登录时，他的cookie是`hash("foo11"+salt)`，`foo1`第一次登录时，他的cookie也是`hash("foo11"+salt)`。 . 那会很糟糕，所以做类似的事情`hash(user+"|"+login_attempt+"|"+salt)`。
*   `Access-Control-Allow-Credentials: true`我认为，您的 API 服务器也必须发送标头。

哦，还要记住，当用户从计算机 A 登录然后从计算机 B 登录时，他从计算机 A 的会话将不再有效。

# iis - 如何设置 wfetch 以连接到 HTTPS 站点？

> ID：15668228
> 
> 赞同：1
> 
> 时间：2013-03-27T19:56:37.800
> 
> 标签：iis

除了关于如何添加标题和正文的文章之外，我既不能打开 wfetch.hlp，也找不到任何记录 wfetch 设置的资源。

我不断得到以下输出：0x274d（无法建立连接，因为目标机器主动拒绝它）：[sockslib]：无法连接。

我已经设置了连接 - >连接：https，密码：默认，客户端分：无

我也尝试过-> Connect: https, Cipher: default, Client cent: valid（假设这将接受那里的任何证书-如果这个假设是正确的，那么我的回答可能与 https 和对此的确认无关将作为此问题的适当答案）输出为：0x8009030d（无法识别提供给包的凭据。）[slib]：无法获取CredentialsHandle / 无法获取Credentials（））

# java - JasperReport PDF 导出为空，RTF 导出正常

> ID：15668232
> 
> 赞同：0
> 
> 时间：2013-03-27T19:57:05.660
> 
> 标签：java, pdf, jasper-reports

使用 Java API 导出使用 ireport Designer 5.0.1 创建的 JasperReport 时，报表始终为空。在我设置 whenNoDataType="AllSectionsNoDetail. 的报告中。也使用 new JREmptyDataSource() 也不起作用。

此外，当我使用 JRRtfExporter 导出为 RTF 时，结果也很好。ireport 中的 PDF 预览也正确。

```
InputStream inputStream = this.getClass().getResourceAsStream("/test-report.jasper");
ByteArrayOutputStream out = new ByteArrayOutputStream();
JasperPrint jPrint = JasperFillManager.fillReport(inputStream, new HashMap<String, Object>(), new JRXmlDataSource(new ByteArrayInputStream("<root><name>John Doe</name</root>".getBytes("UTF-8")), "/root"));

JRPdfExporter reportExporter = new JRPdfExporter();//JRRtfExporter(); does works fine
reportExporter.setParameter(JRExporterParameter.JASPER_PRINT, jPrint);
reportExporter.setParameter(JRExporterParameter.OUTPUT_STREAM, out);
reportExporter.exportReport();
out.close();
reportBytes = out.toByteArray(); 
```

reportBytes 保存到磁盘。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T08:27:40.577

没关系。代码非常好。问题是我将公开的响应保存为二进制 Web 服务附件。接下来，我将此输出复制到 PDF 文件中。但是这样做会丢失一些二进制字符。

不幸的是，Adobe Reader 不会抱怨 PDF 格式不正确，它只是显示一个空白 PDF。

# highcharts - 点对象中的额外数据不适用于工具提示

> ID：15668233
> 
> 赞同：1
> 
> 时间：2013-03-27T19:57:12.600
> 
> 标签：highcharts

在 Highcharts 中，我的数据设置如下：

```
var data = [{
    x: Date.UTC(2011, 10, 1),
    y: 1.9,
    variance: 2.6
}, {
    x: Date.UTC(2011, 11, 1),
    y: 2.0,
    variance: 2.6
}...]; 
```

我想在我的工具提示中使用方差值。但是方差值不会显示在工具提示格式化程序可用的点对象中。我错过了什么？

JSFiddle：http: [//jsfiddle.net/hofo/um7f6/17/](http://jsfiddle.net/hofo/um7f6/17/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:17:54.163

将您的格式化程序字符串修复为以下内容：

`var tooltipString = "Highcharts.dateFormat('%b-%y', this.x) + ' survey<br>Average inflation expectations: ' + this.y + '<br>Variance ' + point.point.variance";`

然后你应该把它添加到你的`detailChart`数据中。

更改`detailData.push(point.y);`为`detailData.push(point.options);`

[**演示**](http://jsfiddle.net/um7f6/18/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T15:18:37.377

请看类似的例子[http://jsfiddle.net/fbMQf/119/](http://jsfiddle.net/fbMQf/119/)

```
 tooltip:{
    formatter:function(){
        return '<b>' + this.series.name + '</b>' + 
        '<br/><b>X Value:</b> ' + this.x +
        '<br/><b>Y Value:</b> ' + this.y +
        '<br/><b>Other Data:</b> ' + this.point.note;
    }
}, 
```

# java - 使用 Mockito 模拟 JdbcTemplate 的数据源

> ID：15668234
> 
> 赞同：3
> 
> 时间：2013-03-27T19:57:15.910
> 
> 标签：java, mocking, datasource, mockito, jdbctemplate

我正在尝试在 Spring 项目中测试一个类。我想在测试类与 dao 类中进行尽可能多的更改，这样我就不必因为更改而重新测试各种事情。

我正在使用的类有一个`JdbcTemplate template`由以下实例化的类变量：

```
setJdbcTemplate(DataSource dataSource) {
    this.template = new JdbcTemplate(dataSource);
} 
```

我想测试的方法是`template.query(<code>)`运行定义的 SQL 查询并将结果返回到列表。

我在我的测试用例中创建了以下内容，但我不确定如何使用它。我可以使用 Mockito 使以下代码返回某个字符串列表吗？

```
DataSource mockedDataSrc = Mockito.mock(DataSource.class);
customerClassDao.setJdbcTemplate(mockedDataSrc); 
```

我可以以某种方式使用`when`或其他命令来设置我想要返回给 JdbcTemplate 的`.query`调用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:41:41.070

如果您正在测试 DAO，那么模拟数据源根本没有意义。你在测试什么？您需要创建一个与数据库交互的 DAO。

一旦你完成了这项工作，你就可以在测试使用它的服务时自由地模拟基于接口的 DAO。你已经测试了 DAO；测试服务时没有理由重做。

如果您在测试 DAO 时模拟数据源，我会说您偏离了轨道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T20:01:06.367

您不能这样做，因为您无法控制`JdbcTemplate`实施。您应该依赖注入`JdbcTemplate`然后模拟`JdbcTemplate`。

这个困难是指出您的代码存在问题。您的代码取决于`JdbcTemplate`. 如果你在它上面使用依赖注入，它的耦合会更少。

* * *

由于您不想修改被测系统，您可以这样做：

更改该`template`字段，使其受到包保护（即：删除 private 关键字）。然后，在您实例化您正在测试的类之后，我会将其设置为模拟（JdbcTemplate.class）。现在您将能够像您最初想要的那样直接在 JdbcTemplate 上使用和验证。

因此，您正在测试的课程将如下所示：

```
public class SystemUnderTest {

JdbcTemplate jdbcTemplate;

    public void setJdbcTemplate(DataSource dataSource) {
        this.template = new JdbcTemplate(dataSource);
    }

} 
```

你的测试会这样做：

```
@Before
public void setUp() {
    SystemUnderTest sut = new SystemUnderTest();
    sut.jdbcTemplate = mock(JdbcTemplate.class);                
}

// ... 
```

# java - 已实施的异步任务 - 尝试解析数据时应用程序强制关闭（异步任务未执行？）

> ID：15668244
> 
> 赞同：-1
> 
> 时间：2013-03-27T19:58:08.877
> 
> 标签：java, android, android-asynctask, forceclose

我对此很陌生-我添加了一些源代码来实现 AsyncTask，但由于在 IO 线程上运行而不是实现 AsyncTask，它仍然强制关闭。我知道我做错了什么，但我不确定它可能是什么。

爪哇：

```
import java.io.IOException;
import org.apache.http.client.ClientProtocolException;

import java.util.ArrayList;
import android.os.AsyncTask;
import java.util.List;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;

import org.apache.http.NameValuePair;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.message.BasicNameValuePair;

// import everything you need
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class DeviceConfig  extends Activity {

    AsyncTask<Object, Object, Object> saveContactTask = 
            new AsyncTask<Object, Object, Object>() 
            {
               @Override
               protected Object doInBackground(Object... params) 
               {

                  return null;
               }

               @Override
               protected void onPostExecute(Object result) 
               {
                  finish();
               }
            }; 

    Button sendButton;

    EditText msgTextField;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        // load the layout
        setContentView(R.layout.deviceconfig);        

        // make message text field object
        msgTextField = (EditText) findViewById(R.id.msgTextField);
        // make send button object
        sendButton = (Button) findViewById(R.id.sendButton);

    }

    // this is the function that gets called when you click the button
    public void send(View v)
    {
        // get the message from the message text box
        String msg = msgTextField.getText().toString();  

        // make sure the fields are not empty
        if (msg.length()>0)
        {
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost("http://gamedemo.hostzi.com/test.php");
         try {
           List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
           nameValuePairs.add(new BasicNameValuePair("id", "12345"));
           nameValuePairs.add(new BasicNameValuePair("message", msg));
           httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
           httpclient.execute(httppost);
           msgTextField.setText(""); // clear text box
         } catch (ClientProtocolException e) {
             // TODO Auto-generated catch block
         } catch (IOException e) {
             // TODO Auto-generated catch block
         }

        }
        else
        {
            // display message if text fields are empty
            Toast.makeText(getBaseContext(),"All field are required",Toast.LENGTH_SHORT).show();
        }

    }

} 
```

XML:

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    >
    <TextView
        android:text="Message"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        /> 

    <EditText
        android:id="@+id/msgTextField"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        />
    <Button
        android:text="Send"
        android:id="@+id/sendButton"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:onClick="send"
        /> 

</LinearLayout> 
```

PHP：

```
<?php
// get the "message" variable from the post request
// this is the data coming from the Android app
$message=$_POST["message"]; 
// specify the file where we will save the contents of the variable message
$filename="androidmessages.html";
// write (append) the data to the file
file_put_contents($filename,$message."<br />",FILE_APPEND);
// load the contents of the file to a variable
$androidmessages=file_get_contents($filename);
// display the contents of the variable (which has the contents of the file)
echo $androidmessages;
?> 
```

日志猫：

```
 03-27 16:07:05.795: D/dalvikvm(11620): Late-enabling CheckJNI
03-27 16:07:05.935: D/dalvikvm(11620): GC_FOR_ALLOC freed 88K, 3% free 7355K/7568K, paused 18ms, total 19ms
03-27 16:07:05.945: I/dalvikvm-heap(11620): Grow heap (frag case) to 10.818MB for 3686416-byte allocation
03-27 16:07:05.975: D/dalvikvm(11620): GC_FOR_ALLOC freed 1K, 2% free 10953K/11172K, paused 25ms, total 25ms
03-27 16:07:05.995: D/dalvikvm(11620): GC_CONCURRENT freed <1K, 2% free 10953K/11172K, paused 3ms+2ms, total 18ms
03-27 16:07:06.285: D/dalvikvm(11620): GC_FOR_ALLOC freed <1K, 2% free 10953K/11172K, paused 15ms, total 16ms
03-27 16:07:06.305: I/dalvikvm-heap(11620): Grow heap (frag case) to 17.043MB for 6529744-byte allocation
03-27 16:07:06.315: D/dalvikvm(11620): GC_FOR_ALLOC freed 0K, 2% free 17330K/17552K, paused 16ms, total 16ms
03-27 16:07:06.335: D/dalvikvm(11620): GC_CONCURRENT freed <1K, 2% free 17330K/17552K, paused 3ms+2ms, total 21ms
03-27 16:07:06.435: D/libEGL(11620): loaded /system/lib/egl/libEGL_tegra.so
03-27 16:07:06.455: D/libEGL(11620): loaded /system/lib/egl/libGLESv1_CM_tegra.so
03-27 16:07:06.465: D/libEGL(11620): loaded /system/lib/egl/libGLESv2_tegra.so
03-27 16:07:06.485: D/OpenGLRenderer(11620): Enabling debug mode 0
03-27 16:07:19.615: W/IInputConnectionWrapper(11620): showStatusIcon on inactive InputConnection
03-27 16:07:45.695: D/AndroidRuntime(11620): Shutting down VM
03-27 16:07:45.695: W/dalvikvm(11620): threadid=1: thread exiting with uncaught exception (group=0x41cd2930)
03-27 16:07:45.695: E/AndroidRuntime(11620): FATAL EXCEPTION: main
03-27 16:07:45.695: E/AndroidRuntime(11620): java.lang.IllegalStateException: Could not execute method of the activity
03-27 16:07:45.695: E/AndroidRuntime(11620):    at android.view.View$1.onClick(View.java:3599)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at android.view.View.performClick(View.java:4204)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at android.view.View$PerformClick.run(View.java:17355)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at android.os.Handler.handleCallback(Handler.java:725)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at android.os.Handler.dispatchMessage(Handler.java:92)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at android.os.Looper.loop(Looper.java:137)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at android.app.ActivityThread.main(ActivityThread.java:5041)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at java.lang.reflect.Method.invokeNative(Native Method)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at java.lang.reflect.Method.invoke(Method.java:511)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at dalvik.system.NativeStart.main(Native Method)
03-27 16:07:45.695: E/AndroidRuntime(11620): Caused by: java.lang.reflect.InvocationTargetException
03-27 16:07:45.695: E/AndroidRuntime(11620):    at java.lang.reflect.Method.invokeNative(Native Method)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at java.lang.reflect.Method.invoke(Method.java:511)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at android.view.View$1.onClick(View.java:3594)
03-27 16:07:45.695: E/AndroidRuntime(11620):    ... 11 more
03-27 16:07:45.695: E/AndroidRuntime(11620): Caused by: android.os.NetworkOnMainThreadException
03-27 16:07:45.695: E/AndroidRuntime(11620):    at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at java.net.InetAddress.lookupHostByName(InetAddress.java:385)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at java.net.InetAddress.getAllByNameImpl(InetAddress.java:236)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at java.net.InetAddress.getAllByName(InetAddress.java:214)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:137)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:360)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
03-27 16:07:45.695: E/AndroidRuntime(11620):    at com.nfc.linkingmanager.DeviceConfig.send(DeviceConfig.java:84)
03-27 16:07:45.695: E/AndroidRuntime(11620):    ... 14 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:03:23.153

您需要将 HttpClient 的内容移到 AsyncTask 中，因为您无法在主线程上进行网络调用。

您也没有调用 saveContactTask.execute()。在 onPostExecute() 我不认为你想调用 finish() 因为那会杀死你的活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:01:31.137

您永远不会调用 saveContactTask.execute()。这是我肯定看到的一件事。发送需要在 doInBackground() 中调用。saveContactTask.execute() 需要在您单击按钮时调用。

# python - TypeError - Python 中的类

> ID：15668246
> 
> 赞同：4
> 
> 时间：2013-03-27T19:58:14.077
> 
> 标签：python, class, typeerror

我是 Python 的初学者，刚刚开始学习课程。我敢肯定这可能是非常基本的东西，但为什么这段代码：

```
class Television():
    def __init__(self):
        print('Welcome your TV.')
        self.volume = 10
        self.channel = 1
    def channel(self, channel):
        self.channel = input('Pick a channel: ')
        print('You are on channel ' + self.channel)
    def volume_up(self, amount):
        self.amount = ('Increase the volume by: ')
        self.volume += self.amount
        print('The volume is now ' + self.volume)
    def volume_down(self, amount):
        self.amount = ('Decrease the volume by: ')
        self.volume -= self.amount
        print('The volume is now ' + self.volume)
myTele = Television()
myTele.channel()
myTele.volume_up()
myTele.volume_down() 
```

产生以下错误：

```
TypeError: 'int' object is not callable, Line 18 
```

**编辑**：我将代码更改为：

```
class Television():
    def __init__(self, volume = 10, channel = 1):
        print('Welcome your TV.')
        self.volume = volume
        self.channel = channel
    def change(self, channel):
        self.channel = input('Pick a channel: ')
        print('You are on channel ' + self.channel)
    def volume_up(self, amount):
        self.amount = int(input('Increase the volume by: '))
        self.volume += self.amount
        print('The volume is now ' + str(self.volume))
    def volume_down(self, amount):
        self.amount = int(input('Decrease the volume by: '))
        self.volume -= self.amount
        print('The volume is now ' + str(self.volume))
myTele = Television()
myTele.change()
myTele.volume_up()
myTele.volume_down() 
```

但它返回：

```
TypeError: change() missing 1 required positional argument: 'channel' 
```

同样，这是来自刚开始上课的人，所以如果我做了一些明显错误的事情，请不要太苛刻。谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T20:00:10.687

你在你的分配一个`channel`属性`__init__`：

```
self.channel = 1 
```

这会隐藏`channel()`类上的方法。重命名属性或方法。

实例上的属性胜过类上的属性（数据描述符除外；think `property`s）。从[类定义文档](http://docs.python.org/3/reference/compound_stmts.html#class-definitions)中：

> 类定义中定义的变量是类属性；它们由实例共享。实例属性可以在带有 的方法中设置`self.name = value`。类和实例属性都可以通过符号“<code>self.name”访问，并且当以这种方式访问​​时，实例属性会隐藏同名的类属性。

您的方法还需要一个您没有在示例中传递的参数，但我想您接下来会自己解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:01:07.917

您有一个名为的方法`channel`和一个名为 的变量`channel`。变量，它是一个`int`，隐藏方法（窃取它的名称，以便您无法访问它）。重命名方法或变量，这将解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:37:12.010

实际上，编辑后的代码暴露了 Martijn 已经指出的问题。您`self.change()`需要一个未在`myTele.change()`. 由于您没有在方法中使用参数，您应该定义`change`为：

```
def change(self):
    self.channel = input('Pick a channel: ')
    print('You are on channel ' + self.channel) 
```

`volume_up`并`volume_down`实际上将字符串分配给 self.amount 而不是调用函数。您可能想将这些更改为

```
def volume_up(self, amount):
    self.amount = input('Increase the volume by: ')
    self.volume += self.amount
    print('The volume is now ' + self.volume)
def volume_down(self, amount):
    self.amount = input('Decrease the volume by: ')
    self.volume -= self.amount
    print('The volume is now ' + self.volume) 
```

由于您`self.amount`每次都在使用它之前进行设置，因此您可以将其设置为方法 ( `amount`) 的局部变量。如果您将来计划`xyz()`使用`self.amount`不首先设置它的方法，则应确保`self.amount`将其设置`__init__()`为合理的值，以防`xyz()`在音量更改方法之前调用。

# android - 在 Android 中禁用“自动旋转”时保持手机正确方向

> ID：15668252
> 
> 赞同：1
> 
> 时间：2013-03-27T19:58:43.783
> 
> 标签：android, rotation, orientation, autorotate

它看起来像 Android 系统中的一个错误，但我确定：
在我的应用程序中，我使用`Settings.System.putInt`禁用自动旋转，有时每当我触发命令时，方向会更改为另一个方向（并且自动旋转被锁定）。
我无法确定它将改变哪个方向（有时当手机处于纵向状态并且我启动它时，它会保持纵向，有时会变为横向，横向也会发生类似的事情）
它看起来像每个应用程序中的方向开始时会对每个系统中的“目标”方向产生影响，系统将被“锁定”，但我无法确定它。
有人知道这个问题吗？我能做些什么让它不会发生？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:03:12.477

不要禁用方向，而是将您的活动设置为具有默认方向

为此，进入所需活动的清单活动标签，输入：

```
android:screenOrientation="landscape" 
```

或肖像

这将使您的屏幕方向保持不变，无论设备的方向如何

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:14:35.073

```
 <activity android:name=".YourFirstActivity" 
        android:screenOrientation="portrait" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity> 
```

如果您想专门添加到一项活动中

```
 <activity android:name=".AnotherActivity"  android:screenOrientation="portrait"  /> 
```

# asp.net - 显示实时数据的表格

> ID：15668253
> 
> 赞同：0
> 
> 时间：2013-03-27T19:58:45.783
> 
> 标签：asp.net, ajax, gridview, real-time

所以基本上我有一个 ASP .NET 应用程序，其背后的代码运行一个调用 Web 服务的 for 循环，每次循环完成时，数据都会添加到数据表中，然后在循环结束时将数据绑定到 gridview。

我想要实现的是一个随着数据进入而更新的表格。

我知道我不能使用更新面板，因为它们在 for 循环完成之前不会更新。我知道 AJAX 是我前进的方向，但我背后的代码都在 VB 中。我也研究过使用 jquery 插件 Datatables 但我不确定它是否可以“实时”更新

任何建议都非常感谢！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:01:51.793

您要做的实际上只能通过 AJAX 实现。因此，您需要做的是在您的代码隐藏中不执行 for 循环，而只需将您的数据绑定到表中。

然后在客户端，使用 Javascript，您可以启动一个计时器，该计时器定期向服务器询问新数据。然后通过 AJAX 获得一组新数据并将其附加到表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-26T08:46:05.587

也许我有点晚了，但这就是我创建一个用于显示实时数据的 html 表的方式。如果您可以使用 Session，那么您可以在客户端或服务器端初始化一个计数器并存储/更新会话中的值。然后，您可以配置您的 ajax 调用以一次获取一个表的行。javascript append 方法可用于在运行时添加您从 ajax 接收的行，并且一旦添加了一行，您就可以增加计数器。jQuery 数据表插件确实提供了实时更新的功能。但是，您将不得不稍微调整 javascript，或者为添加的每一行调用 .Datatables() 方法，这将使其效率低下。我会推荐一个带有一些 CSS 样式的通用 html 表。祝你好运！

# javascript - 是否有必要在再次调用之前取消未完成的 requestAnimationFrame？

> ID：15668260
> 
> 赞同：0
> 
> 时间：2013-03-27T19:59:03.753
> 
> 标签：javascript, performance, animation, browser, requestanimationframe

我正在研究新兴的`requestAnimationFrame`标准`cancelAnimationFrame`

> [http://paulirish.com/2011/requestanimationframe-for-smart-animating/](http://paulirish.com/2011/requestanimationframe-for-smart-animating/)

以及此处提供的各种 polyfill：

> [https://gist.github.com/paulirish/1579671](https://gist.github.com/paulirish/1579671)

使用这些函数的语义对我来说有点棘手。具体来说，假设你`requestAnimationFrame(callback)`曾经。`cancelAnimationFrame`如果您想`requestAnimationFrame(callback)`在第一个回调被调用之前第二次调用，是否有必要调用？浏览器会重复调用回调吗？或者浏览器会自动用一个调用替换双调用？

我问是因为[我当前的动画在 Firefox 上真的很滞后](https://stackoverflow.com/q/15649543/586086)，并且 requestAnimationFrame 似乎没有太大帮助。但我可能从多个来源调用它太快了。对此有权威的回答会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T18:24:42.437

根据规范：

> 笔记
> 
> requestAnimationFrame 仅计划对基于脚本的动画进行一次更新。如果需要后续动画帧，则需要在回调中再次调用 requestAnimationFrame。
> 
> 另请注意，使用相同回调多次调用 requestAnimationFrame（在调用回调并清除列表之前）将导致列表中具有相同回调的多个条目，因此将导致该回调被多次调用动画帧。

[http://www.w3.org/TR/animation-timing/](http://www.w3.org/TR/animation-timing/)

调用`requestAnimationFrame`将只安排一个回调调用。处理完您的回调后，如果已删除，则其在回调列表中的条目。因此，您不必取消之前的通话。

# cryptography - OCSP：验证者如何知道要使用哪个 OCSP 服务器？

> ID：15668265
> 
> 赞同：1
> 
> 时间：2013-03-27T19:59:13.313
> 
> 标签：cryptography, ocsp

我无法在线确认这一点 - CA 的 X509 证书中指定的 OCSP 服务器 URL 是否像 CRL 一样，还是必须由网络管理员在带外指定？验证者如何知道使用哪个 OCSP 服务器来验证给定的证书（假设我们有它的证书路径）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:09:26.167

X.509 证书中的授权信息访问 (AIA) 详细信息将描述 OCSP 服务器的位置。

颁发证书的证书颁发机构将已将 OCSP 信息添加到颁发给实体的证书中。证书的请求者对此没有选择，因此无法隐藏 OCSP 服务器的存在。

OCSP 客户端可以解析证书，注意 OCSP AIA 条目的存在并提出验证请求。

# ruby-on-rails - 引导可编辑导轨类型选择的结果为空

> ID：15668266
> 
> 赞同：0
> 
> 时间：2013-03-27T19:59:21.950
> 
> 标签：ruby-on-rails, twitter-bootstrap

我正在尝试将 type = select 与 gem 'bootstrap-editable-rails' 一起使用。

该字段弹出并有一个选择框，但值不显示。

任务记录有一个外键 = rating_id，我想从评级表中显示的值是 = ratingname

这是我的视图代码：

```
<a href="#" class="answer" data-type="select" data-placement="right"  data-resource="task" data-source="/ratings" data-name="ratingname" data-url="/tasks/<%= task.id %>" data-original-title="Select Rating">
  <%= textarea_format(task.rating.ratingname) %>
</a> 
```

更新 1

我是否必须更改 rating.json 以包含“文本”和“值”？

更新 2

我像这样使用RABL：

```
object @rating
attributes :id => :id, :ratingname => :text, :ratingvalue => :value 
```

现在选择值出现了！

但是，我得到这个错误：

```
`call'
(gem) journey-1.0.4/lib/journey/router.rb:68:in `block in call'
- (gem) journey-1.0.4/lib/journey/router.rb:56:in `call'
- (gem) actionpack-3.2.12/lib/action_dispatch/routing/route_set.rb:601:in `call'
- (gem) rack-pjax-0.7.0/lib/rack/pjax.rb:12:in `call'
- (gem) meta_request-0.2.2/lib/meta_request/middlewares/app_request_handler.rb:11:in `call'
- (gem) rack-contrib-1.1.0/lib/rack/contrib/response_headers.rb:17:in `call'
- (gem) meta_request-0.2.2/lib/meta_request/middlewares/headers.rb:16:in `call'
- (gem) meta_request-0.2.2/lib/meta_request/middlewares/meta_request_handler.rb:13:in `call'
- (gem) pdfkit-0.5.3/lib/pdfkit/middleware.rb:16:in `call'
- (gem) warden-1.2.1/lib/warden/manager.rb:35:in `block in call'
- (gem) warden-1.2.1/lib/warden/manager.rb:34:in `call'
- (gem) actionpack-3.2.12/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
- (gem) rack-1.4.5/lib/rack/etag.rb:23:in `call'
- (gem) rack-1.4.5/lib/rack/conditionalget.rb:35:in `call'
- (gem) actionpack-3.2.12/lib/action_dispatch/middleware/head.rb:14:in `call'
- (gem) remotipart-1.0.5/lib/remotipart/middleware.rb:30:in `call'
- (gem) actionpack-3.2.12/lib/action_dispatch/middleware/params_parser.rb:21:in `call'
- (gem) actionpack-3.2.12/lib/action_dispatch/middleware/flash.rb:242:in `call'
- (gem) rack-1.4.5/lib/rack/session/abstract/id.rb:210:in `context'
- (gem) rack-1.4.5/lib/rack/session/abstract/id.rb:205:in `call'
- (gem) actionpack-3.2.12/lib/action_dispatch/middleware/cookies.rb:341:in `call'
- (gem) activerecord-3.2.12/lib/active_record/query_cache.rb:64:in `call'

... 
```

更新 3

我几乎让它工作了。

我的 RABL：

```
object @rating
attributes :ratingname => :text, :id => :value 
```

我将 ratingname 作为下拉列表！选择值时会发生以下情况！

```
UPDATE "tasks" SET "rating_id" = 2, "updated_at" = '2013-03-28 08:21:36.869872' WHERE "tasks"."id" = 36 
```

所以，下拉列表好，更新好。

但是，带有评级选择列表的弹出框变成红色并且不会消失！并且浏览器控制台中没有错误。

![在此处输入图像描述](../Images/82b37bbf59daa970aabc5863c2fa6366.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T15:25:19.870

让它工作。我不得不更改更新部分中任务的控制器。

```
From:     format.json { head :ok }
To:       format.json { render json: @task } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-08-25T12:03:15.087

有时你可能会遇到js冲突，所以检查控制台

**未捕获的类型错误：无法使用“in”运算符在未定义中搜索“值”**

解决方案：将其内联用作

**$.fn.editable.defaults.mode = '内联';**

# google-apps-script - GAS 字符串操作

> ID：15668267
> 
> 赞同：0
> 
> 时间：2013-03-27T19:59:23.250
> 
> 标签：google-apps-script

我似乎找不到官方的 GAS 字符串运算符参考指南。像*+, -, len(gth)* , *left* , *right* , *mid*等等...

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:07:11.270

看到您引用的示例，我猜您正在寻找电子表格本机功能，而不是 GAS ...

文档[在这里](https://support.google.com/drive/bin/static.py?hl=en&topic=25273&page=table.cs)

如果您寻找 JavaScript 字符串操作，则有多个 Internet 来源，例如[这里](http://www.w3schools.com/jsref/jsref_obj_string.asp)

# javascript - 计算数组中的属性

> ID：15668272
> 
> 赞同：0
> 
> 时间：2013-03-27T19:59:49.853
> 
> 标签：javascript, iteration, dynamic-arrays, naming-conventions

我正在尝试计算动态生成的数组中的属性。数组程序是在对象内部创建的，如下所示：

```
state_list.push({name: state, undergrad: 0, grad: 0, total: 0, programs: []}); 
```

然后后者是这样填充的：

```
n = findWithAttr(state_list, 'name', state);
//n = the index of property "name" with value of "state" in state_list
if(!(program in state_list[n]["programs"])) {           
state_list[n]["programs"][program] = 1;
} else {
state_list[n]["programs"][program]++;
} 
```

接下来，我需要汇总已放置在数组中的程序数量，并希望这样做：

```
programs = state.programs;
console.log(programs.length); 
```

但这返回 0。

如果我登录（程序），这是数组：

```
Array[0]
History, MA: 3
Info Assurance & Security, MS: 1
International Literacy, MED: 1
length: 0
__proto__: Array[0]
main.js:237 
```

似乎它将数组中的所有程序作为一个字符串......或其他东西。我很想将它们编入索引并能够迭代它们。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:08:46.680

```
programs = state.programs;
console.log(programs.length); 
```

如果 state 引用 state_list 数组中的对象，将正确返回数组的长度。

我的猜测是，`program`在您的代码中不是数字，并且程序被插入为对象属性而不是数组索引。只有当您实际上在表单程序 [] 中添加内容时，长度才会增加。如果`program`是非数字字符串，您将编辑数组的属性而不是索引，并且这些不会增加长度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T21:09:11.373

好的，这就是我最终要做的：

```
programs = state.programs;
keys = Object.keys(programs);
//this creates an indexed array of each property in programs
size = keys.length;
//this gives me the length of the new array, which I can use for pagination 
```

然后我能够像这样迭代它们：

```
offset = 0;
results = 24;
start = 0;              
$(keys).each(function() {
   if((start >= offset)&&(start < (offset+results))) {
   //this conditional gives me the pagination   
      $("#programResult").append("<li>"+this+": "+programs[this]+"</li>");
   }
   start++;
}); 
```

这给了我一个结果，如下所示：“历史，MA：1”

# ruby-on-rails - @user.received_messages 不显示收件箱的消息

> ID：15668274
> 
> 赞同：0
> 
> 时间：2013-03-27T19:59:51.150
> 
> 标签：ruby-on-rails

我正在为 Rails 应用程序制作收件箱消息。在我的 _inbox.html 文件中，我有“<% @user.received_messages.each do |message| %>”，但它没有显示我发送的任何消息。没有错误信息，只有一个空格。

我应该使用另一行编码来显示收件箱中的所有消息吗？

_inbox.html：

```
<h2>Your Inbox</h2>
<% @user.received_messages.each do |message| %>
No messages in your Inbox
<% end %> 
```

消息模型：

```
class Message < ActiveRecord::Base
    attr_accessible :subject, :body, :sender_id, :recepient_id, :read_at,:sender_deleted,:recepient_deleted
    validates_presence_of :subject, :message => "Please enter message title"

    belongs_to :sender,
    :class_name => 'User',
    :foreign_key => 'sender_id'
    belongs_to :recepient,
    :class_name => 'User',
    :foreign_key => 'recepient_id'

    # marks a message as deleted by either the sender or the recepient, which ever the user that was passed is.
    # When both sender and recepient marks it deleted, it is destroyed.
    def mark_message_deleted(id,user_id)
        self.sender_deleted = true if self.sender_id == user_id and self.id=id
        self.recepient_deleted = true if self.recepient_id == user_id and self.id=id
        self.sender_deleted && self.recepient_deleted ? self.destroy : save!
    end

    # Read message and if it is read by recepient then mark it is read
    def self.readingmessage(id, reader)
        message = find(id, :conditions => ["sender_id = ? OR recepient_id = ?", reader, reader])
        if message.read_at.nil? && (message.recepient.user_id==reader)
            message.read_at = Time.now
            message.save!
        end
        message
    end

    # Based on if a message has been read by it's recepient returns true or false.
    def read?
        self.read_at.nil? ? false : true
    end

end 
```

消息控制器：

```
class MessagesController < ApplicationController

  before_filter :set_user

  def index
    if params[:mailbox] == "sent"
      @messages = @user.sent_messages
    elsif params[:mailbox] == "inbox"
      @messages = @user.received_messages
    #elsif params[:mailbox] == "archieved"
     # @messages = @user.archived_messages
    end
  end

  def new
    @message = Message.new
    if params[:reply_to]
      @reply_to = User.find_by_user_id(params[:reply_to])
      unless @reply_to.nil?
        @message.recepient_id = @reply_to.user_id
      end
    end
  end

  def create
    @message = Message.new(params[:message])
    @message.sender_id = @user_id
    if @message.save
      flash[:notice] = "Message has been sent"
      redirect_to user_messages_path(current_user, :mailbox=>:inbox)
    else
      render :action => :new
    end
  end

  def show
    @message = Message.readingmessage(params[:id],@user_id)
  end

  def delete_multiple
      if params[:delete]
        params[:delete].each { |id|
          @message = Message.find(id)
          @message.mark_message_deleted(@message.id,@user_id) unless @message.nil?
        }
        flash[:notice] = "Messages deleted"
      end
      redirect_to user_messages_path(@user, @messages)
  end

  private
    def set_user
      @user = current_user
    end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T16:04:33.793

我终于解决了我遇到的问题。

在 user.rb 我必须删除“有很多：收到的消息”块。然后 def received_messages 如下：

```
 def received_messages
      Message.received_by(self)
    end 
```

在 _inbox 视图中，这行代码必须被删除：

```
<td><%= "#{message.sender.first_name} #{message.sender.last_name}" %></td> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:07:16.647

我看不到您在哪里打印消息。尝试类似：

```
<h2>Your Inbox</h2>
<% if @user.received_messages.empty? %>
  No messages in your Inbox
<% end %>

<% @user.received_messages.each do |message| %>
  <%= message.body %>
<% end %> 
```

# ruby-on-rails - rails 对象预期得到字符串

> ID：15668281
> 
> 赞同：4
> 
> 时间：2013-03-27T20:00:20.567
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.2, erb

我见过多个类似的问题，但没有一个对我有用。

我有一个团队模型：

```
class Team < ActiveRecord::Base
  has_one :p1, :class_name => "Player", :foreign_key => 'player_id', :validate => true
  has_one :p2, :class_name => "Player", :foreign_key => 'player_id', :validate => true
end 
```

在我团队的 _form.html.erb 中，我将球员称为

```
 <%= f.collection_select :p1, Player.all, :id, :name %> 
```

但是，在提交表单时，我看到了错误：

```
Player(#28401456) expected, got String(#14111904)

Application Trace | Framework Trace | Full Trace
app/controllers/teams_controller.rb:47:in `new' 
```

* * *

```
Parameters:
{"utf8"=>"✓",
 "authenticity_token"=>"GSIcEvROFnvgGWT4HvE2VNqRw4NxU1J8iAw/WhZeRLk=",
 "team"=>{"p1"=>"1"},
 "commit"=>"Create Team"} 
```

这是行的代码

```
def create
  @team = Team.new(params[:team])
  .....
end 
```

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T21:59:27.600

最后，这有效：

```
 <%= f.collection_select :p1_id, Player.all, :id, :name %> 
```

神奇之处在于：我的迁移有 t.references p1 并在数据库中创建了 p1_id 列。提交表单时，rails 会在以下位置填写参考的 id：

```
def create
  @team = Team.new(params[:team])
  .....
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:06:18.190

试试这个：

```
<%= f.collection_select :player_id, Player.all, :id, :name %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:06:39.530

我可能是错的，但我的猜测是，而不是

```
<%= f.collection_select :p1, Player.all, :id, :name %> 
```

你需要

```
<%= f.collection_select :p1, :team_id, Player.all, :id, :name %> 
```

[http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-collection_select](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-collection_select)

# jquery - 如果浏览器小于 900px，如何停止 jquery 的任何功能

> ID：15668283
> 
> 赞同：0
> 
> 时间：2013-03-27T20:00:23.380
> 
> 标签：jquery

当我的浏览器达到一定宽度时，我需要禁用一个 Jquery 滑块，我可以这样做，但是我不知道如何禁用滑块/jquery，因此它会停止其滑动功能，而只会显示html 和 css 随媒体查询而变化。

我将为此使用 if else 语句，但不知道在 if else 语句中放置什么以使其不执行任何操作。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:04:03.820

```
$(window).resize(function() {
    if ($(window).width() < 900) {
        // Do your thing
    }
}).trigger('resize'); 
```

每次调整窗口大小时都会调用它。我触发它一次，这样如果它已经更小它就会运行。

# c - 如何在linux内核中实现新的调度方案

> ID：15668285
> 
> 赞同：0
> 
> 时间：2013-03-27T20:00:39.880
> 
> 标签：c, linux, linux-kernel

我是 Linux 内核开发的新手，谁能告诉我如何在 linux 内核中实现新的调度方案？

我需要更改哪些文件等。一步一步的指南会很有帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:03:23.850

一步一步的指南？没问题的老板。

1.  阅读[进程调度](http://oreilly.com/catalog/linuxkernel/chapter/ch10.html)。
2.  [如何创建新的 Linux 内核调度程序](https://stackoverflow.com/questions/3086864/how-to-create-a-new-linux-kernel-scheduler)

你可以设置你的`zero`任务来熟悉这些功能列表：

![在此处输入图像描述](../Images/b4dba9b397569ee57e11dae40014616f.png)

# node.js - 使用 ExpressJS 和 Node 将发布的文件存储到 MongoDB GridFS

> ID：15668288
> 
> 赞同：0
> 
> 时间：2013-03-27T20:00:48.427
> 
> 标签：node.js, mongodb, express, gridfs

我正在尝试通过使用本机驱动程序将其放入 MongoDB 的 gridfs 系统来处理发布到 Express 站点的文件。

我遇到的问题是请求的块在 gridStore 对象准备好之前就已经全部发送了。把 request.on('data'...这显然是一个不完整的例子（我从来没有看到“块”记录到控制台）：

```
var Db = require('mongodb').Db,
    MongoClient = require('mongodb').MongoClient,
    Server = require('mongodb').Server,
    ObjectID = require('mongodb').ObjectID,
    GridStore = require('mongodb').GridStore,
    db;

db = new Db('dbName', new Server('serverAddress', 27017), { safe: false });
db.open(function (err, db) {
    console.log("db open");
    var gridStore = new GridStore(db, new ObjectID(), 'fileName', "w");
    gridStore.open(function (err, gridStore) {
        console.log("gridStore open");
        req.on('data', function (chunk) {
            console.log("chunk");
            gridStore.write(chunk, function () {});
        });
    });
}) 
```

我想知道是否有办法从 Express 站点的路线中阻止流来，直到 gridStore 准备好。或者，我希望有一种同步方式来设置 gridStore 以使其工作（如果存在）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T01:33:54.310

我通过将传入的帖子写入临时文件来解决我的问题。它确实让事情变慢了一点，但缓存实际上发生得很快，尤其是与写入 GridFS 相比。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T16:56:22.523

当接收到新的数据块时，您可以使用 req.pause() 。当从 gridStore.write() 回调时 req.resume()。并根据请求“结束”事件，关闭 gridStore。

# ios - 如何制作一个包含 3 个对象的数组？

> ID：15668296
> 
> 赞同：3
> 
> 时间：2013-03-27T20:01:09.903
> 
> 标签：ios, objective-c, nsarray

我如何制作一个包含“3 个对象”的数组，我想要的是这样的：

```
NSArray *array = [[NSArray alloc]initWithObjects:[UIImage , NSString , BOOL], [UIImage , NSString , BOOL], nil]; 
```

有没有办法做到这一点，以便索引处的每个对象都可以有一个图像、字符串和一个布尔值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T20:05:08.717

```
NSArray *array1 = [[NSArray alloc]initWithObjects:yourImage , YourString , yourStringBoolValue , nil];

NSArray *array2 = [[NSArray alloc]initWithObjects:array1 , nil]; 
```

现在`array2`对象`0`位置包含所有对象作为一个集合。

要检索您的值，请使用以下代码

```
NSArray *retriveArray1 = [array2 objectAtIndex:0];

UIImage *yourImage =    [retriveArray1 objectAtIndex:0];
NSString *yourString =  [retriveArray1 objectAtIndex:1]
BOOL yourBoolValue =    [[retriveArray1 objectAtIndex:2] boolValue]; 
```

# soap - 需要以加密方式运行 cron 作业

> ID：15668297
> 
> 赞同：1
> 
> 时间：2013-03-27T20:01:14.633
> 
> 标签：soap, https, cron, cpanel

我需要设置一个 cron 作业来运行 SOAP 客户端。客户坚持要我从 https 地址连接到他们的网络服务（在 https 地址上）。他们坚持认为，如果我不这样做，他们对我的回复就无法加密。

我的第一个问题是，这是真的吗？我以为只要我通过 https 连接到他们的 SOAP 服务，返回的响应就会自动被加密。

如果这是真的，我怎样才能运行一个 cron 作业以作为 https？我的网站位于具有 cPanel 访问权限的 LAMP 设置上。

预先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:38:41.747

您的客户声明似乎有点不清楚他/她通过“......从 https 地址连接”的具体含义，因为规范中没有“https 地址”一词的任何概念，而且 https URLS 似乎只是在 https 请求中给出的 Request-URI 的上下文中有意义。

鉴于这种不确定性，我只是胡乱猜测。尽管如此，对我来说，您的客户需求似乎很可能**不是**连接到 http 协议，而是建立您的 TLS 连接。

如果您的客户对其系统的安全性非常敏感 - 事实上，如果他打算提供 RPC 请求可能是一个非常好的主意 - 他可能不希望全世界都能够将加密连接连接到他的一旦建立连接，机器并依赖任何辅助身份验证机制。

由于公共互联网的大多数用户没有任何由受信任的权威机构签署的证书，因此此功能不会在野外使用，但除了服务器身份验证之外，**TLS 握手协议**还提供了一种通过**客户端**证书进行客户端身份验证的方法（相关部分是此处**RFC 5246**中的第 7 节。请参阅：[https](https://www.rfc-editor.org/rfc/rfc5246#section-7) ://www.rfc-editor.org/rfc/rfc5246#section-7 ）

虽然在没有广泛使用的客户端证书的情况下，Web 服务通常依赖于建立加密连接以首先通过某种挑战响应测试（例如查询用户名和密码）来**验证**用户身份，但您的客户端可能希望通过另外的方式来额外保护对其机器的访问需要有效的客户证书，甚至——可能不是最好的主意——替换上面已经提到的第二个授权。

然而，这一切不过是我提出的一些想法，因为你的问题是谜语。

最好的主意可能是问你的客户他/她说“......从https地址连接”时的意思

# php - 尝试将表单数据发送到 php 文件以处理并发布到 API

> ID：15668306
> 
> 赞同：0
> 
> 时间：2013-03-27T20:01:34.237
> 
> 标签：php, html

我正在尝试设置一个表单以将数据发布到一个 php 文件，然后该文件将进行 API 调用，我非常接近，我认为任何帮助都会受到赞赏。

当我一直在进行测试时，表单似乎已发布到 php 文件，但从那时起似乎没有任何事情发生。我打算尝试打印出数据字符串，看看是否正确？？

唯一缺少的部分是我拥有但无法在此处发布的网址的第一部分

这是我的html代码

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">
label, input, textarea { display: block; float: left; width: 150px; margin: 5px; }
label { clear: left; text-align: right; }
input[type="submit"] { width: 60px; margin: 10px 0 0 165px; clear: left; }
</style>
</head>
<body>
<h2>New Account Creation</h2>
<form action="sonian.php" method="post">
<label>User name (required)</label> <input type="text" name="username" value="" />
<label>Password</label> <input type="text" name="password" value="" />
<label>First Name</label> <input type="text" name="first_name" value="" />
<label>Last Name</label> <input type="text" name="last_name" value="" />
<label>Email</label> <input type="text" name="email" value="" />
<label>Address Line 1</label> <input type="text" name="address1" value="" />
<label>Address Line 2</label> <input type="text" name="address2" value="" />
<label>City</label> <input type="text" name="city" value="" />
<label>County</label> <input type="text" name="state" value="" />
<label>Postcode</label> <input type="text" name="zip" value="" />
<label>Phone Number</label> <input type="text" name="phone" value="" />
<label>Sub Domain</label> <input type="text" name="sub_domain" value="" />
<label>Account Name</label> <input type="text" name="name" value="" />
<label>Number of Users</label> <input type="text" name="number_of_users" value="" />
<label>Account Type</label> <input type="text" name="organization_type_id" value="" />
<div class="field required clear">

<label class="_">Account type</label>
<select id="account_organization_type_id" name="account[organization_type_id]"><option value="1500">Commercial</option>
<option value="1501">Non-Profit</option>
<option value="1502">Education</option>
<option value="1503">Government</option></select>
</div>
<div class="field clear">
<label class="inline"><input name="account[uses_exchange]" type="hidden" value="0" /><input id="account_uses_exchange" name="account[uses_exchange]" type="checkbox" value="1" />&nbsp;Exchange
</label>
<label class="inline"><input name="account[uses_groupwise]" type="hidden" value="0" /><input id="account_uses_groupwise" name="account[uses_groupwise]" type="checkbox" value="1" />&nbsp;GroupWise
</label>
<label class="inline"><input name="account[uses_notes]" type="hidden" value="0" /><input id="account_uses_notes" name="account[uses_notes]" type="checkbox" value="1" />&nbsp;Noteworthy
</label>
<label class="inline"><input name="account[uses_zimbra]" type="hidden" value="0" /><input id="account_uses_zimbra" name="account[uses_zimbra]" type="checkbox" value="1" />&nbsp;Zimbra
</label> 
```

 邮件服务器

```
</label>
<label class="inline"><input name="account[uses_scalix]" type="hidden" value="0" /><input id="account_uses_scalix" name="account[uses_scalix]" type="checkbox" value="1" />&nbsp;Scalix
</label>
<label class="inline"><input name="account[uses_gmail]" type="hidden" value="0" /><input id="account_uses_gmail" name="account[uses_gmail]" type="checkbox" value="1" />&nbsp;Gmail Apps
</label>
<label class="inline"><input name="account[uses_sunone]" type="hidden" value="0" /><input id="account_uses_sunone" name="account[uses_sunone]" type="checkbox" value="1" />&nbsp;SunONE
</label>
<label class="inline"><input name="account[uses_hosted_exchange]" type="hidden" value="0" /><input id="account_uses_hosted_exchange" name="account[uses_hosted_exchange]" type="checkbox" value="1" />&nbsp;Hosted Exchange
</label>
<label class="inline"><input name="account[uses_kerio]" type="hidden" value="0" /><input id="account_uses_kerio" name="account[uses_kerio]" type="checkbox" value="1" />&nbsp;Kerio
</label>
<label class="inline"><input name="account[uses_other]" type="hidden" value="0" /><input id="account_uses_other" name="account[uses_other]" type="checkbox" value="1" />&nbsp;Other
</label>
</div>
<input type="submit" value="Save" />
</form>
</body>
</html> 
```

这是php代码

```
 <?php
    if ($_SERVER['REQUEST_METHOD'] == "POST")
    {
    $strPost = "";
    //create string with form POST data
    $strPost = "Username=" . urlencode($_POST['username'])
    . "&Password=" . urlencode($_POST['password'])
    . "&First Name=" . urlencode($_POST['first_name'])
    . "&Last Name=" . urlencode($_POST['last_name'])
    . "&Email=" . urlencode($_POST['email'])
    . "&Address Line 1=" . urlencode($_POST['address1'])
    . "&Address Line 2=" . urlencode($_POST['address2'])
    . "&City=" . urlencode($_POST['city'])
    . "&County=" . urlencode($_POST['state'])
    . "&Postcode=" . urlencode($_POST['zip'])
    . "&Phone Number=" . urlencode($_POST['phone'])
    . "&Sub Domain=" . urlencode($_POST['sub_domain'])
    . "&Account Name=" . urlencode($_POST['name'])
    . "&Number of Users=" . urlencode($_POST['number_of_users'])
    . "&Account Type=" . urlencode($_POST['organization_type_id'])
    . "&Email System=" . urlencode($_POST['uses_exchange']);
    //set POST URL
    $url = "https://url/api/accounts.xml";
    //intialize cURL and send POST data
    $ch = @curl_init();
    @curl_setopt($ch, CURLOPT_POST, true);
    @curl_setopt($ch, CURLOPT_POSTFIELDS, $strPost);
    @curl_setopt($ch, CURLOPT_URL, $url);
    @curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    @curl_exec($ch);
    @curl_close($ch);
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:29:34.530

我认为表格有些混乱。

在同一行有一个隐藏的输入，其名称与旁边的复选框相同。

```
<input name="account[uses_exchange]" type="hidden" value="0" />
<input id="account_uses_exchange" name="account[uses_exchange]" type="checkbox" value="1" />&nbsp;Exchange 
```

php 文件如何理解这一点？

此外，在 php 处理中，您有 var

```
. "&Email System=" . urlencode($_POST['uses_exchange']); 
```

但我认为您将这个东西的名称作为数组值发送。

```
 name="account[uses_exchange]" 
```

因此，我想您应该决定是要使用隐藏值还是要使用复选框数组。

然后在 php 处理中循环遍历另一端的数组。

例子

```
 foreach($_POST['account'] as $k => $v)
    echo "<br>$k => $v"; 
```

产生：

```
organization_type_id => 1500
uses_exchange => 1
uses_groupwise => 1
uses_notes => 1
uses_zimbra => 1
uses_scalix => 1
uses_gmail => 1
uses_sunone => 1
uses_hosted_exchange => 1
uses_kerio => 1
uses_other => 1 
```

# c++ - 用于检查是否抛出异常的 C++ 断言函数

> ID：15668309
> 
> 赞同：11
> 
> 时间：2013-03-27T20:01:38.743
> 
> 标签：c++, exception, assertion

我熟悉标准 C++ 断言的工作原理。这在我的项目中运行良好，可用于各种测试目的。

例如，假设我想检查我的代码是否引发了某个异常。

如果不使用像 CPPUnit 这样的测试框架，这可能吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-03-01T18:56:17.733

[您可以手动执行CPPUnit](http://cppunit.sourceforge.net/doc/lastest/group___assertions.html#ga6)执行的相同操作：

```
bool exceptionThrown = false;

try
{
    // your code
}
catch(ExceptionType&) // special exception type
{
    exceptionThrown = true;
}
catch(...) // or any exception at all
{
    exceptionThrown = true;
}

assert(exceptionThrown); // or whatever else you want to do 
```

当然，如果您经常使用这种模式，那么为此使用宏是有意义的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T20:12:32.807

骨架（未测试）

```
#define MY_ASSERT(f, e) {\
    try {\
        f();\
    } catch (std::exception &e) {\
        ...\
    }\
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-22T23:18:10.677

这是我根据@JPlatte 和@gongzhitaao 的回答编写的异常测试器。对于我的测试框架，我有两个全局变量`num_test`，`num_test_success`用于跟踪执行了多少测试以及在一系列测试中成功了多少，但这可以根据您的需要进行更改。

```
int num_test;
int num_test_success;

#define UT_ASSERT_THROW(expression, ExceptionType) {            \
                                                                \
    try {                                                       \
        expression;                                             \
        printf("test %d:    *** FAILURE ***     %s:%d:%s,%s\n", \
               num_test, __FILE__, __LINE__,                    \
               #expression, #ExceptionType);                    \                                 
    } catch (const ExceptionType &) {                           \
        printf("test %d:    success\n", num_test);              \
        ++num_test_success;                                     \
    } catch (...) {                                             \
        printf("test %d:    *** FAILURE ***     %s:%d:%s,%s\n", \
               num_test, __FILE__, __LINE__,                    \ 
               #expression, #ExceptionType);                    \
    }                                                           \
                                                                \
    ++num_test;                                                 \
                                                                \
} 
```

宏`__FILE__`并`__LINE__`扩展为当前文件和行号（请参阅[https://gcc.gnu.org/onlinedocs/cpp/Standard-Predefined-Macros.html](https://gcc.gnu.org/onlinedocs/cpp/Standard-Predefined-Macros.html)）。宏内部的井号告诉预处理器将参数作为字符串放入宏扩展中（参见[http://bruceblinn.com/linuxinfo/Stringification.html](http://bruceblinn.com/linuxinfo/Stringification.html)）。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2013-03-27T20:11:30.443

代码内断言通常用于方法的开头，以确认在进入此特定功能之前满足某些先决条件，例如：

```
Window::paint()
{
  assert(m_device != NULL);
  m_device->repaintRegion();
} 
```

它们在这里主要是为了捕捉方法或类之间未满足的依赖关系的**错误**。

测试框架中的断言是不同的，通常用于单元测试，以确保单元返回它需要返回的任何内容。

通常应该在现实（即外部系统）为我们提供代码不能/不应该处理的情况下抛出异常。这是解决罕见但仍可预期的问题的简单方法。例如 - 等待服务器通常可用的超时。或者，内存不足。我不会将它用作编程逻辑的辅助工具。

对于您的问题，可能有一种方法可以通过使用 try-catch 包围测试的单元来捕获测试框架中的异常。但我不确定它是否真的可取。

高温高压

# jquery - 在 Durandal 中加载 jquery 函数 - 计时

> ID：15668315
> 
> 赞同：0
> 
> 时间：2013-03-27T20:02:03.230
> 
> 标签：jquery, requirejs, durandal

我无法确定何时加载我的 jquery（从单独的 js 文件到 durandal 视图）。

我想做一些事情，比如附加事件处理程序，就像我通常使用 jquery 的 $(document).ready(function(){});

在 shell.js 中，我尝试使用 requirejs 加载我的另一个名为 unicorn.js 的 js 文件，如下所示：

```
define(function(require) {
    var router = require('durandal/plugins/router');
    var unicorn = require('../../content/js/unicorn');  

    return {
        router: router,        
        activate: function () {
            return router.activate('dashboard');
        },
        viewAttached: function () {
            console.log('viewattached');
            unicorn.setup();
        }
    };
}); 
```

它似乎加载正常，但告诉我在我的 unicorn.js 文件中，“未定义定义”。看起来是这样的：

```
define(function () {    
    var unicorn = {         
        setup: function() {
            $('a').click(function(e) {
                //do stuff
            });
    };
}); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-29T19:47:52.947

我只是想出来了-或者至少是一种方法。我在捆绑的（第三方）脚本中定义了我的独角兽脚本。这是提前加载它，因此不理解“定义”关键字。然后我在 shell.js 中再次加载它，它工作正常。我所要做的就是将它从捆绑的脚本区域中删除。

# prolog - 英语无约束语法序言

> ID：15668317
> 
> 赞同：3
> 
> 时间：2013-03-27T20:02:05.433
> 
> 标签：prolog, infinite-loop, dcg, left-recursion, failure-slice

我在尝试在 prolog 中实现一个非常简单的无约束语法时遇到了一个无限递归问题。

这是我的规则：（vp -> 动词短语，np -> 名词短语，ap -> adj 短语，pp -> prep 短语）

```
 verb(S) :- member(S, [put,  pickup, stack, unstack]).
    det(S) :- member(S, [the]).
    adj(S) :- member(S, [big, small, green, red, yellow, blue]).
    noun(S) :- member(S, [block, table]).
    prep(S) :- member(S, [on, from]).

    vp([V|R]) :- verb(V), pp(PP), np(NP), append(NP, PP, R).
    np([D, N]) :- det(D), noun(N).
    np([D|R]) :- det(D), ap(AP), noun(N), append(AP, [N], R).
    ap([A]) :- adj(A).
    ap([A|R]) :- adj(A), ap(R).
    pp([P|R]) :- prep(P), np(R). 
```

我遇到的问题是**ap**的规则可以产生任意长的形容词字符串，所以在某些时候，我会通过尝试所有这些无限的可能性来满足查询。

例如，下面的查询永远不会产生 S = [put, the, red, block, on, the, green, block] 因为它会首先将左侧“red”的形容词短语扩展为无限可能，然后再尝试使用正确的。

```
?- vp(S)
S = [put, the, red, green, block, on, the, block] ; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T21:10:18.567

简短的回答是：使用定句语法 ( [dcg](/questions/tagged/dcg "显示标记为“dcg”的问题") ) 来表示您的语法。有关典型编码，请参[见此答案](https://stackoverflow.com/questions/10399774/prolog-recursion-grammar/10401614#10401614)。

但现在你的程序中的实际问题。你不仅不会得到想要的答案；情况更糟：即使在程序的一个更简单的片段中，您也会遇到同样的问题。这是您的程序中仍然没有终止的最小片段：

```
动词（S）：- 成员（S，[put，pickup，stack，unstack]）。
det(S) :- 成员(S, [the])。
adj(S) :- member(S, [big, small, green, red, yellow, blue])。
名词（S）：-**假**，成员（S，[块，表]）。
准备（S）：-成员（S，[on，from]）。

vp([V|R]) :- 动词(V), pp(PP), false , np(NP), append(NP, PP, R)。
np([D, N]) :- **false** , det(D), noun(N)。
np([D|R]) :- det(D), ap(AP), false ,名词(N), append(AP, [N], R)。
ap([A]) :- **false**， adj(A)。
ap([A|R]) :- adj(A), ap(R), false。
pp([P|R]) :- prep(P), np(R), false。

?- vp([put, the, red, green, block, on, the, block])。

```

通过插入目标**`false`**，我们得到了仍然没有终止的程序的一小部分。实际源是`ap/1`递归的，但不受实际输入的限制。有关更多示例，请参见[故障切片](/questions/tagged/failure-slice "显示标记为“故障切片”的问题")。

没有简单的方法来修复您的程序。最简单的方法是使用语法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-23T06:38:59.880

基本问题是 Prolog 被定义为对规则进行 DFS，因此当涉及跨无限搜索空间（如您的情况）的生成问题时，部分空间可以保持不变。与平台无关的解决方法是通过深度限制来增加语法，并在每次递归调用时减少深度。一旦深度达到0，失败。通过重复查询（例如，`vp(S, 1). vp(S, 2).`）逐步增加深度，您可以保证状态空间的所有部分最终都会被触及。

这基本上只是迭代深化。如果你在 SWI-PL 上，你也可以使用[`call_with_depth_limit/3`](http://www.swi-prolog.org/pldoc/man?predicate=call_with_depth_limit/3)谓词来做同样的事情，而无需修改语法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T07:44:02.947

好像您在滥用 Prolog 生成能力，将 append 放在最后一个位置。我试图换一个更明智的地方：

```
...
vp([V|R]) :- verb(V), append(NP, PP, R), pp(PP), np(NP).
np([D, N]) :- det(D), noun(N).
np([D|R]) :- det(D), append(AP, [N], R), ap(AP), noun(N).
... 
```

现在你的解析器显然可以工作了。

```
?- vp([put, the, red, green, block, on, the, block]).
true . 
```

但我建议，就像已经错误的 (+1) 一样，切换到 DCG 进行解析。

# tsql - 如何在一个表中的两列之间建立关系

> ID：15668324
> 
> 赞同：0
> 
> 时间：2013-03-27T20:02:32.437
> 
> 标签：tsql

**我想在同一张表中的****两**列（程序代码和测试代码）之间建立一对一的关系。我希望所有具有相同测试代码的测试都具有相同的程序代码。

 **1.  我的第一个想法是使用 UDF 来查找相同测试代码对应于两个不同程序的情况。我了解到这将不起作用，因为 t-sql 仅在之后检查 UDF 的检查约束`INSERTS`——而不是在`UPDATES` [为什么 t-sql 允许我违反使用 UDP 的检查约束之后？](https://stackoverflow.com/questions/15438184/why-is-t-sql-allowing-me-to-violate-a-check-constraint-that-uses-a-udp)

2.  我的下一个想法是将逻辑从 UDF 移到检查约束本身。但是 t-sql 是说检查约束中不允许子查询。这也意味着我不能使用`EXISTS`语法（我认为它也使用子查询）。

    `ALTER TABLE [dbo].[mytable] WITH CHECK ADD CONSTRAINT [oneProgramPerTest] CHECK
    ( (select COUNT(*) from mydb.dbo.mytable u1 inner join mydb.dbo.mytable u2 on u1.testcode=u2.testcode and u1.progcode <> u2.progcode )=0 )`

除非有某种方法可以在没有 (1) udf 或 (2) 子查询的情况下强制执行此逻辑，否则似乎我需要创建一个程序代码的“虚拟”表，然后在测试代码之间强制执行一对一的关系来自 myTable 和虚拟表。这看起来**真的**很难看，所以必须有更好的方法。对？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:16:49.567

你读过规范化（如果你没有读过为什么要设计数据库？）。你应该有一个结构

```
tableA
id (PK)
programcode
other fields

tableB
programcode (PK)
testcode 
```

在两个表之间添加一个正式的外键，并将程序代码定义为 tableb 中的 PK。然后得到你想要的数据：

```
select <Name specific fields, never use select *>
from tableA a
join tableB b on a.programcode = b.programcode 
```**

# php - 在虚拟服务器上运行外部程序

> ID：15668325
> 
> 赞同：2
> 
> 时间：2013-03-27T20:02:32.500
> 
> 标签：php, apache, vhosts

我想将可通过命令行（Linux 操作系统）访问的小程序安装到服务器并使用 PHP 运行它们。我想在我的机器上安装 Apache、vhost... 有没有办法在我的虚拟服务器上运行这些外部应用程序，在我的系统上，所以我可以试验 PHP 调用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:42:48.503

我们一直都在这样做。我称它们为巫毒教页面。这是一些工作代码：

```
<?php
$command="uptime"; $output; $retval; $errors="";
exec ( $command ,  &$output, &$retval  );
echo $output[0]."\n";
unset($output);
?> 
```

网页的输出为：

```
13:40:19 up 22 days, 23:14,  0 users,  load average: 0.04, 0.02, 0.00 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:09:33.480

您可以编写一些 shell 脚本 *.sh，它们将打开应用程序。您可以使用 php 命令“shell_exec”并运行这些 shell 脚本。

# kde - 更改 KDE 文件对话框中的默认排序顺序（使用 Kate）

> ID：15668328
> 
> 赞同：2
> 
> 时间：2013-03-27T20:02:41.627
> 
> 标签：kde, kate

最近，我的 Kate 文本编辑器在文件对话框中“按日期”显示文件和文件夹，我想恢复字母顺序。我正在使用 Unity、KDE ​​平台版本 4.8.5 (4.8.5)、Kate 版本 3.8.5 运行 Ubuntu 12.04。我不知道如何改变它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-09T14:31:52.057

好的，我已经想通了。在 Ubuntu 13.04（至少）上，编辑文件：

```
~/.kde/share/config/kdeglobals 
```

它是 Windows INI 样式格式的配置文件。找到名为的部分

```
[KFileDialog Settings] 
```

更改设置：

```
Sort by=Date
Sort reversed=true 
```

进入：

```
Sort by=Name
Sort reversed=false 
```

此外，改变

```
View Style=Simple 
```

进入

```
View Style=Detail 
```

将使动态更改排序顺序变得容易。

凯特不会立即接受这些更改。我不需要重新启动计算机，甚至不需要从我的 Ubuntu Unity 会话中注销，但如果更改在一段时间后没有生效，那么注销可能是可行的方法。

# java - 将字符串日期转换为 java.sql.Date

> ID：15668329
> 
> 赞同：29
> 
> 时间：2013-03-27T20:02:49.430
> 
> 标签：java, sql

是否可以将`string`“20110210”转换为`java.sql.Date`2011-02-10？

我试过了`SimpleDateFormat`，我得到了`java.text.ParseException: Unparseable date: "20110210"`

我究竟做错了什么？

我有 new SimpleDateFormat("yyyy-MM-dd") 而不是 new SimpleDateFormat("yyyyMMdd")

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-03-27T20:05:10.950

这对我有用而不会引发异常：

```
package com.sandbox;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;

public class Sandbox {

    public static void main(String[] args) throws ParseException {
        SimpleDateFormat format = new SimpleDateFormat("yyyyMMdd");
        Date parsed = format.parse("20110210");
        java.sql.Date sql = new java.sql.Date(parsed.getTime());
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-14T22:42:08.493

也为我工作：

```
SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
    Date parsed = null;
    try {
        parsed = sdf.parse("02/01/2014");
    } catch (ParseException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
    java.sql.Date data = new java.sql.Date(parsed.getTime());
    contato.setDataNascimento( data);

    // Contato DataNascimento era Calendar
    //contato.setDataNascimento(Calendar.getInstance());         

    // grave nessa conexão!!! 
    ContatoDao dao = new ContatoDao("mysql");           

    // método elegante 
    dao.adiciona(contato); 
    System.out.println("Banco: ["+dao.getNome()+"] Gravado! Data: "+contato.getDataNascimento()); 
```

# android - 在Android中禁用自动旋转时如何收听屏幕方向变化？

> ID：15668330
> 
> 赞同：0
> 
> 时间：2013-03-27T20:02:56.180
> 
> 标签：android, autorotate

在我的应用程序中，我禁用了自动定向，但我仍然想听定向更改方法。
我尝试了覆盖`onConfigurationChanged`，但我想当自动旋转被禁用时它不会被调用。
我正在构建 API 8 。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:08:24.773

我会看看如何读取加速度计或陀螺仪来做到这一点。我不确定这是否有效，但这就是我开始的方式。这是有关如何使用加速度计数据的链接。

[http://www.techrepublic.com/blog/app-builder/a-quick-tutorial-on-coding-androids-accelerometer/472](http://www.techrepublic.com/blog/app-builder/a-quick-tutorial-on-coding-androids-accelerometer/472)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:25:54.957

我自己在我的应用程序中使用此代码：

```
 Display display = ((WindowManager) getSystemService(Context.WINDOW_SERVICE))
            .getDefaultDisplay();
    int rotation = display.getRotation(); 
```

的值`rotation`可以如下：横向为 1 或 3，纵向为 0 或 2。

不过，我不能 100% 确定如果禁用自动旋转，这是否会起作用，但你可以试一试。

# xml - 在同一个定义文件中有多个版本的 xml 模式

> ID：15668331
> 
> 赞同：1
> 
> 时间：2013-03-27T20:03:00.250
> 
> 标签：xml, xsd

我正在开发带有修订号的架构定义。是否可以将元素和组标记为仅对特定修订有效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T16:32:27.167

不使用 XSD，不。如果我想使用共享结构的单一来源来维护模式的多个版本，我会使用某种形式的识字编程系统，或者（更有可能）为此目的发明一种新形式的识字编程系统。

[*几个小时后……* ]

一种简单的方法是`version`在您自己的命名空间中使用任何模式构造中的属性，该构造仅包含在某些版本中；该`version`属性的值将是一个以空格分隔的版本标识符列表。例如：

```
<xs:schema targetNamespace="http://example.com/multiver"
  xmlns:mv="http://example.com/multiver">

  <xs:element name="e" mv:ver="1.0">
    <!--* 1.0 version of element 'e' *-->
  </xs:element>
  <xs:element name="e" mv:ver="1.1">
    <!--* 1.1 version of element 'e' *-->
  </xs:element>
  <xs:element name="f">
    <!--* element 'f' is not version-dependent ... *-->
  </xs:element>
  ...
</xs:schema> 
```

使用 XSLT 或 XQuery 只提取那些带有适当 mv:ver 值的声明很简单。

如果版本数量超过 5 或 10 个，这种简单的方法可能会变得有点乏味，并且您可能会决定想要一些允许您说出诸如“升级到 3.2 版”和“从 3.3 版到 4.34 版，包括的”。[XSD 1.1 的 4.2.2 节中](http://www.w3.org/TR/xmlschema11-1/#cip)描述的条件包含属性说明了解决该问题的一种可能方法。

# node.js - 在 MongoDB 中执行非阻塞 eval 读取

> ID：15668332
> 
> 赞同：1
> 
> 时间：2013-03-27T20:03:04.257
> 
> 标签：node.js, mongodb, mongoose

我想出了如何**从 node.js 客户端**在 MongoDB 服务器上运行 javascript 代码：

```
db.eval("function(x){ return x*10; }", 1, function (err, retval) {
  console.log('err: '+err);
  console.log('retval: '+retval);
}); 
```

这很好用。但是文档说会`db.eval()`发出写锁，因此没有其他东西可以读取或写入数据库。我不要那个。

它还说`eval`没有这样的限制，但我不知道在哪里可以找到它。从他们谈论它的方式来看，似乎常规`eval`仅在 mongo shell 中可用，而不是从客户端。

那么：如何在不阻塞所有内容的情况下在 mongodb 服务器上运行这些*存储过程？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:20:49.457

您可以将字段 nolock 设置为 true 的对象作为可选的第三个参数传递给 eval：

```
db.eval('function (x) {return x*10; }', [1], {nolock:true}, function(err, retval) {
     console.log('err: '+err);
     console.log('retval: '+retval);
}); 
```

请注意，这会阻止 eval 设置强制写锁，但不会阻止函数内部的任何操作自行创建写锁。

来源：[文档](http://mongodb.github.com/node-mongodb-native/api-generated/db.html#eval)。

请注意，在这种情况下，术语“存储过程”是错误的。存储过程是指存储在数据库本身而不由应用层交付的代码。MongoDB 也可以使用特殊集合`db.system.js`来执行此操作，但不鼓励这样做：http: [//docs.mongodb.org/manual/applications/server-side-javascript/#storing-functions-server-side](http://docs.mongodb.org/manual/applications/server-side-javascript/#storing-functions-server-side)

顺便说一句：MongoDB 不是为存储过程设计的。通常建议在应用层实现任何高级逻辑。不鼓励将即使是微不足道的操作实现为存储过程的做法，就像有时在 SQL 数据库上所做的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:32:25.343

这是将函数存储在服务器端的方式，您可以调用它，如下所示：

```
 db.system.js.save(    {      _id : "myAddFunction" , value : function (x,y)
{ return x +y;}    } );

db.system.js.find()

{ "_id" : "myAddFunction", "value" : function (x,y){ return x + y; } }

db.eval( "myAddFunction( 1 ,2)" )
3 
```

# c# - 保留动态调用方法的异常

> ID：15668334
> 
> 赞同：13
> 
> 时间：2013-03-27T20:03:09.453
> 
> 标签：c#, exception, reflection

*   [有关的](https://stackoverflow.com/questions/57383/in-c-how-can-i-rethrow-innerexception-without-losing-stack-trace)
*   [有关的](https://stackoverflow.com/questions/1009762/how-can-i-rethrow-an-inner-exception-while-maintaining-the-stack-trace-generated)

我想动态调用一个`MethodInfo`对象，并让从它内部抛出的任何异常向外传递，就好像它被正常调用一样。

我似乎有两个选择。它们概述如下。

**选项 1**维护 抛出的异常的类型`MyStaticFunction`，但`StackTrace`由于`throw`.

**选项 2**维护`StackTrace`异常的 ，但异常的类型始终为`TargetInvocationException`。我可以拉出`InnerException`和它的类型，但这意味着我不能写这个，例如：

```
try { DoDynamicCall(); }
catch (MySpecialException e) { /* special handling */ } 
```

**选项1：**

```
void DoDynamicCall()
{
    MethodInfo method = /*referencing MyClass method void MyStaticFunction(int x)*/;
    try
    {
        method.Invoke(null, new object[] { 5 });
    }
    catch (TargetInvocationException e)
    {
        throw e.InnerException;
    }
} 
```

**选项 2：**

```
void DoDynamicCall()
{
    MethodInfo method = /*referencing MyClass method void MyStaticFunction(int x)*/;
    method.Invoke(null, new object[] { 5 });
} 
```

**我真正想要**的是让调用者`DoDynamicCall`接收异常，就好像他们调用了这个：

```
void DoDynamicCall()
{
    MyClass.MyStaticFunction(5);
} 
```

有没有办法同时获得**选项 1**和**选项 2**的好处？

## 编辑：

**我希望拥有**的选项（`rethrow`当场发明了特殊的新 C# 关键字）：

```
void DoDynamicCall()
{
    MethodInfo method = /*referencing MyClass method void MyStaticFunction(int x)*/;
    try
    {
        method.Invoke(null, new object[] { 5 });
    }
    catch (TargetInvocationException e)
    {
        //Magic "rethrow" keyword passes this exception
        //onward unchanged, rather than "throw" which
        //modifies the StackTrace, among other things
        rethrow e.InnerException;
    }
} 
```

这也将消除对这个怪人的需要，因为您可以`rethrow e;`改用：

```
try { ... }
catch (Exception e)
{
    if (...)
        throw;
} 
```

一般来说，这将是一种与`throw;`“我必须直接在一个 catch 块中”的要求脱钩的方法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-28T01:27:48.713

这是我想出的解决方案。它完成了工作。我仍然对其他答案感兴趣，因为可能会有更简单或更清洁的东西。

*   当您想要的功能`throw;`但要传递的异常不是当前`catch`块的异常时，请使用`throw Functional.Rethrow(e);`
*   替换`try...catch...`为`Functional.TryCatch`
*   替换`try...catch...finally...`为`Functional.TryCatchFinally`

这是代码：

```
//Need a dummy type that is throwable and can hold an Exception
public sealed class RethrowException : Exception
{
    public RethrowException(Exception inner) : base(null, inner) { }
}

public static Functional
{    
    public static Exception Rethrow(Exception e)
    {
        return new RethrowException(e);
    }

    public static void TryCatch(Action _try, Action<Exception> _catch)
    {
        try { _try(); }
        catch (RethrowException e) { _catch(e.InnerException); }
        catch (Exception e) { _catch(e); }
    }

    public static T TryCatch<T>(Func<T> _try, Func<Exception, T> _catch)
    {
        try { return _try(); }
        catch (RethrowException e) { return _catch(e.InnerException); }
        catch (Exception e) { return _catch(e); }
    }

    public static void TryCatchFinally(
        Action _try, Action<Exception> _catch, Action _finally)
    {
        try { _try(); }
        catch (RethrowException e) { _catch(e.InnerException); }
        catch (Exception e) { _catch(e); }
        finally { _finally(); }
    }

    public static T TryCatchFinally<T>(
        Func<T> _try, Func<Exception, T> _catch, Action _finally)
    {
        try { return _try(); }
        catch (RethrowException e) { return _catch(e.InnerException); }
        catch (Exception e) { return _catch(e); }
        finally { _finally(); }
    }
} 
```

# 更新

在 .NET 4.5 中有新的[`System.Runtime.ExceptionServices.ExceptionDispatchInfo`类](http://msdn.microsoft.com/en-us/library/system.runtime.exceptionservices.exceptiondispatchinfo(v=vs.110).aspx)。这可用于捕获异常：

```
var capturedException = ExceptionDispatchInfo.Capture(e); 
```

然后稍后这用于恢复抛出异常：

```
capturedException.Throw(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:06:52.973

不，我不相信有一种方法可以同时兼顾两者。但是， throwing`e.InnerException`仍然允许您获取原始堆栈跟踪，因为您可以简单地使用`e.InnerException.StackTrace`来获取原始堆栈跟踪。因此，简而言之，您应该**使用选项 1**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-29T07:45:22.787

最好的选择是**选项 3**：根本不使用反射，而是使用`Expression<T>.Compile()`.

而不是这样做：

```
static void CallMethodWithReflection(MethodInfo method)
{
    try
    {
        method.Invoke(null, new object[0]);
    }
    catch (TargetInvocationException exp)
    {
        throw exp.InnerException;
    }
} 
```

尝试以此为目标：

```
private static void CallMethodWithExpressionCompile(MethodInfo method)
{
    Expression.Lambda<Action>(Expression.Call(method)).Compile()();
} 
```

需要注意的是，您需要知道方法签名，尽管您可以编写动态构建表达式以适应多个签名之一的代码。

您可能并不总是能够使用这种技术，但是当您这样做时，它是最好的选择。出于所有意图和目的，它就像调用任何其他委托一样。如果您进行多次调用（在这种情况下只编译一次并保留已编译委托的句柄），它也比反射更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-28T14:48:01.663

我有一个类似的问题，并想出了这个：

```
/// <summary>
/// Attempts to throw the inner exception of the TargetInvocationException
/// </summary>
/// <param name="ex"></param>
[DebuggerHidden]
private static void ThrowInnerException(TargetInvocationException ex)
{
    if (ex.InnerException == null) { throw new NullReferenceException("TargetInvocationException did not contain an InnerException", ex); }

    Exception exception = null;
    try
    {
        //Assume typed Exception has "new (String message, Exception innerException)" signature
        exception = (Exception) Activator.CreateInstance(ex.InnerException.GetType(), ex.InnerException.Message, ex.InnerException);
    }
    catch
    {
        //Constructor doesn't have the right constructor, eat the error and throw the inner exception below
    }

    if (exception == null ||
        exception.InnerException == null ||
        ex.InnerException.Message != exception.Message)
    {
        // Wasn't able to correctly create the new Exception.  Fall back to just throwing the inner exception
        throw ex.InnerException;
    }
    throw exception;
} 
```

它的使用示例如下：

```
try
{
    return typeof(MyType).GetMethod(methodName, BindingFlags.Public | BindingFlags.Static)
                                    .MakeGenericMethod(new[] { myType) })
                                    .Invoke(null, parameters);
}
catch (TargetInvocationException ex)
{
    ThrowInnerException(ex);
    throw new Exception("Throw InnerException didn't throw exception");
} 
```

# jquery - 可以使用 xhrFields 将 onprogress 功能添加到 jQuery.ajax() 吗？

> ID：15668339
> 
> 赞同：30
> 
> 时间：2013-03-27T20:03:24.643
> 
> 标签：jquery, ajax, xmlhttprequest, progress

正如这里所建议的：[https](https://gist.github.com/HenrikJoreteg/2502497) ://gist.github.com/HenrikJoreteg/2502497 ，我正在尝试将 onprogress 功能添加到我的`jQuery.ajax()`文件上传中。上传工作正常，并且 onprogress 事件正在触发，但不像我预期的那样 - 不是在某个时间间隔重复触发，而是在上传完成时只触发一次。有没有办法指定onprogress刷新的频率？或者，我是否正在尝试做一些无法做到的事情？这是我的代码：

```
 $.ajax(
    {
        async: true,
        contentType: file.type,
        data: file,
        dataType: 'xml',
        processData: false,
        success: function(xml)
        {
            // Do stuff with the returned xml
        },
        type: 'post',
        url: '/fileuploader/' + file.name,
        xhrFields:
        {
            onprogress: function(progress)
            {
                var percentage = Math.floor((progress.total / progress.totalSize) * 100);
                console.log('progress', percentage);
                if (percentage === 100)
                {
                    console.log('DONE!');
                }
            }
        }
    }); 
```

* * *

嗯，已经好几年了。我重新审视了这一点，并使用[GetFree](https://stackoverflow.com/users/25700/getfree)的答案，将我的代码更新为以下内容：

```
$('#file_input').change(function()
{
    var file = this.files[0];
    $('#upload_button').click(funtion(e)
    {
        req = new XMLHttpRequest();
        req.upload.addEventListener('progress', updateProgress, false);
        req.addEventListener('load', transferComplete, false);
        var url  = 'https://my.url'; 
        req.open('POST', url, true);
        req.setRequestHeader('Content-Type', myFileType);
        req.setRequestHeader('Content-Length', myFileLength);
        req.send(file);
    });
);
function updateProgress(e)
{
    var percent = Math.floor(e.loaded / e.total * 100);
    console.log("percent = " + percent);
}
function transferComplete(e)
{
    console.log("transfer complete");
} 
```

我已将 GetFree 的帖子标记为已接受的答案。抱歉耽搁了。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2014-01-08T00:00:47.583

**简短回答：**
不，您不能使用`xhrFields`.

**长答案：**

XmlHttpRequest 对象中有两个进度事件：

*   **响应进度**( `XmlHttpRequest.onprogress`)
    这是浏览器从服务器下载数据的时间。

*   **请求进度**( `XmlHttpRequest.upload.onprogress`)
    这是浏览器向服务器发送数据的时间（包括 POST 参数、cookie 和文件）

在您的代码中，您使用的是响应进度事件，但您需要的是请求进度事件。这就是你的做法：

```
$.ajax({
    async: true,
    contentType: file.type,
    data: file,
    dataType: 'xml',
    processData: false,
    success: function(xml){
        // Do stuff with the returned xml
    },
    type: 'post',
    url: '/fileuploader/' + file.name,
    xhr: function(){
        // get the native XmlHttpRequest object
        var xhr = $.ajaxSettings.xhr() ;
        // set the onprogress event handler
        xhr.upload.onprogress = function(evt){ console.log('progress', evt.loaded/evt.total*100) } ;
        // set the onload event handler
        xhr.upload.onload = function(){ console.log('DONE!') } ;
        // return the customized object
        return xhr ;
    }
}); 
```

`xhr`option 参数必须是返回原生 XmlHttpRequest 对象以供 jQuery 使用的函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-06T20:46:23.117

在发出请求之前，您需要将事件处理程序添加到请求本身。jQuery.ajax 允许通过“beforeSend”属性[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

例如： [http ://www.dave-bond.com/blog/2010/01/JQuery-ajax-progress-HMTL5/](http://www.dave-bond.com/blog/2010/01/JQuery-ajax-progress-HMTL5/)

* 编辑 * 确保查看该示例链接的第二个代码示例。我相信第一个对于现代版本的 jQuery 来说已经过时了。

```
$.ajax({
  xhr: function()
  {
    var xhr = new window.XMLHttpRequest();
    //Upload progress
    xhr.upload.addEventListener("progress", function(evt){
      if (evt.lengthComputable) {
        var percentComplete = evt.loaded / evt.total;
        //Do something with upload progress
        console.log(percentComplete);
      }
    }, false);
    //Download progress
    xhr.addEventListener("progress", function(evt){
      if (evt.lengthComputable) {
        var percentComplete = evt.loaded / evt.total;
        //Do something with download progress
        console.log(percentComplete);
      }
    }, false);
    return xhr;
  },
  type: 'POST',
  url: "/",
  data: {},
  success: function(data){
    //Do something success-ish
  }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-09-10T14:43:31.843

这有点像 Stack Overflow 其他地方的另一个答案，但我认为回答了你的问题。我已经根据自己将“流式”数据从服务器泵送到可滚动 div 的需要进行了修改（然后我可以强制始终滚动到底部，从而随着时间的推移显示进度，因此无需等待整个记录集完成） .

下面的**客户端**代码将生成的内容添加到 id 为“scrollable_area”的预定义 div（然后可以滚动）...

```
<div style="position:absolute; left:5px; right:5px; top:5px; height:35px;">
    <label for="auto_scroll">Auto Scroll</label> <input type="checkbox" id="auto_scroll" checked>
</div>
<div id="scrollable_area" style="position:absolute; overflow:auto; left:5px; right:5px; top:45px; bottom:5px;"></div>
<script type="text/javascript">
    var last_response_len = false;
    var auto_scroll = null;
    var scrollable_area = null;
    $().ready(function() {
        auto_scroll = document.getElementById("auto_scroll");
        scrollable_area = document.getElementById("scrollable_area");
        $.ajax("your_api_call.php", {
            xhrFields: {
                onprogress: function(e) {
                    var this_response, response = e.currentTarget.response;
                    if(last_response_len === false) {
                        this_response = response;
                        last_response_len = response.length;
                    } else {
                        this_response = response.substring(last_response_len);
                        last_response_len = response.length;
                    }
                    scrollable_area.innerHTML += this_response;
                    if(auto_scroll.checked) {
                        scrollable_area.scrollTop = scrollable_area.clientHeight + scrollable_area.scrollHeight + 500;
                    }
                }
            }
        })
        .done(function(data) {
            console.log("Completed response");
        })
        .fail(function(data) {
            console.log("Error: ", data);
        });
        console.log("your_api_call.php Request Sent!");
    });
</script> 
```

**服务器端**“ your_api_call.php”文件调用需要刷新其输出（每个数据行以便查看随时间推移的进度），然后可以立即在上述“scrollable_area”div中显示...

```
// Do Db loop
        while ($record = $recordset->fetch(PDO::FETCH_ASSOC)) {
            set_time_limit(10); // Don't timeout on large data sets seeing as this is a big task that we are wanting to watch progress!
            echo 'Do what you gotta do... ' . $record["register_id"] . '<br>';
            flush(); // Push to the client / ajax
            ob_flush(); // As above
        } 
```

简短的回答......是的。希望这可以帮助 ：-）

# javascript - D3：根据数据点缩放图

> ID：15668345
> 
> 赞同：0
> 
> 时间：2013-03-27T20:03:42.237
> 
> 标签：javascript, d3.js, scale

根据条形图的长度，我在缩放图表时遇到了一些麻烦。例如，在 jsfiddle 中，我无法在大小为 25 的数据点之外绘制条形图。我知道解决此问题的一种方法是使主体的宽度和高度更大。但我认为缩放整个图表会更有效率，这样一个条形就不会看起来异常大。

[http://jsfiddle.net/NkkDC/](http://jsfiddle.net/NkkDC/)

我在想，我必须在这里缩放“y”函数，但我不确定如何。

```
bars.on("click", clickEvent)
    .transition().duration(2000).delay(200)
    .attr("y", function(d, i) { return i * 20; })
    .attr("width", x)
    .attr("height", 20); 
```

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:22:44.437

每次添加新值时，xScale 的输入域都会发生变化（因为您可以添加新的最大值），因此我们需要在重新渲染图表时重新计算 xScale。在渲染函数中移动 x-scale 的声明应该可以解决问题：

```
 var xScale = d3.scale.linear()
.domain([0, d3.max(data)])
.range([0, 420]); 
```

[http://jsfiddle.net/NkkDC/1/](http://jsfiddle.net/NkkDC/1/)

# python - 使用OneToOne Key进行南方数据迁移

> ID：15668357
> 
> 赞同：1
> 
> 时间：2013-03-27T20:04:34.503
> 
> 标签：python, database, django, django-south

我正在使用 South 进行 sqlite3 数据迁移。我的旧架构具有以下 UserProfile 模型：

```
class UserProfile(models.Model):
    user = models.OneToOneField(User)
    weekOne = models.OneToOneField(WeekOne)
    weekTwo = models.OneToOneField(WeekTwo)
    weekThree = models.OneToOneField(WeekThree) 
```

但我感觉添加了一些新的周，即 weekFour、weekFive、weekSix 等。每周本身就是一个模型，继承自一个通用的 Week 模型。所以 Week 模型的基本原型如下所示：

```
class WeekOne(Week):
    name = u'Week One'
    exercises = ['squats', 'lunges', 'stairDaysCount', 'skipStairs']
    # Required benchmarks for given exercises
    squatBenchmark = 1000
    lungeBenchmark = 250
    stairDaysCountBenchmark = 3

    totalGoals = 4 
```

我的问题是，我应该在我的数据迁移代码中放入什么样的代码，以便我可以`UserProfile`用额外的几周填充旧的 s。我有这样的想法：

```
def forwards(self, orm):
    for user in orm.UserProfile.objects.all():
        user.weekFour = orm.WeekFour()
        user.weekFive = orm.weekFive()
        # etc. 
```

但这似乎不起作用。当我尝试运行架构迁移时出现此错误：

```
Migration 'my_app:0002_newWeeks' is marked for no-dry-run 
```

后来这个：

```
DatabaseError: no such column: my_app_userprofile.weekFour_id 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:57:53.203

只需在终端中运行它

```
 python manage.py schemamigration myapp --auto 
```

然后

```
 python manage.py migrate 
```

# css - 如何在 twitter bootstrap 中设置输入复选框的样式？

> ID：15668360
> 
> 赞同：13
> 
> 时间：2013-03-27T20:04:45.200
> 
> 标签：css, twitter-bootstrap

我必须使输入复选框变得简单，但在引导程序中找不到某种可选类，还在 github 上搜索了一些库，但找不到像制作基础这样简单的东西。

感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-01-25T03:19:22.933

您可以使用它来了解可以做什么：

```
@import url('//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-theme.min.css');
@import url(//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css');

input[type="checkbox"] {
  display: none;
}

.custom-check {
		display: inline-block;
		width: 25px; height: 25px;
		background: white;
		border: 1px solid #CCCCCC;
		font-family: 'Glyphicons Halflings';
		font-size: 22px;
		line-height: 1;
	}

.custom-check::before {
  content: "\e013";
  color: #424242;
  display: none;
}

input[type=checkbox]:checked+.custom-check::before {
  display: block;
  color: white;
  background-color: #554236;
}
```

```
<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css" rel="stylesheet">
<div>
  <label >
    <input type="checkbox">
    <span class="custom-check"></span>
    My Checkbox
  </label>
</div>
```

如果这还不够，这个对类似问题的[回答](https://stackoverflow.com/a/26532087/3196602)也很好地概述了自定义引导复选框所涉及的 css。

* * *

## 回答 #2

> 赞同：-21
> 
> 时间：2013-03-27T20:23:55.450

只需向该输入元素添加一个 id（如果它只是一个复选框）或类并为其定义 css：

CSS 和 HTML

'customId' 将是您提供给自定义输入标签的 ID：

```
<input id="customId" />

input#customId{
   background: #888 !important;
   border: none !important;
   color: #000 !important;
} 
```

jsut覆盖你想要的任何样式......

重要提示：只需在样式末尾添加 !important 即可强制覆盖

# java - 轻量级网页渲染

> ID：15668363
> 
> 赞同：0
> 
> 时间：2013-03-27T20:04:53.103
> 
> 标签：java, javascript, html, rendering

鉴于 HTML 页面字符串可用，其中包含用于呈现动态内容的 Javascript 链接。是否有可以呈现此类页面的 HTML“快照”（字符串/文本）的库？

也就是说，不用像 HTMLUnit 这样的无头浏览器？

# ios - deviceready 事件不会持续为非 index.html 页面触发

> ID：15668365
> 
> 赞同：3
> 
> 时间：2013-03-27T20:04:54.887
> 
> 标签：ios, cordova

我正在使用 PhoneGap 2.5 加载外部 URL，并试图找出 deviceready 事件没有持续触发的原因。有一堆线程都涉及到人们没有正确添加处理程序，但我做了以下事情：

1.  在我做的地方放一个`onload`处理程序`body``document.addEventListener("deviceready", onDeviceReady, false);`
2.  使用 jQuery 的 document.ready 函数来设置事件监听器。
3.  `setTimeout`在 navigator.splashscreen 上等待循环调用。

事件何时`deviceready`真正触发？加载非 index.html 页面会导致奇怪的交互吗？我看到类似的消息`Resetting plugins due to page load.`，我想知道这是否会导致其他问题。

# iphone - 使用块排队动画

> ID：15668375
> 
> 赞同：2
> 
> 时间：2013-03-27T20:05:27.443
> 
> 标签：iphone, ios, objective-c

在我的`didSelectRowAtIndexPath`方法中，`[self dismissView];`当用户选择一个单元格时，我会调用一个单元格，以便在视图已经呈现时关闭该视图。这显然不是非常理想的，并且它在没有动画的情况下覆盖了 presentView 方法。有一个更好的方法吗？或者至少让它等待视图完成动画而不使用 NSTimer。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath;
{
    [self dismissView];

// Do xyz...

[self presentView:twitterLinksView]; 
```

然后..

```
- (void)presentView:(id)sender
{
    twitterLinksView.frame = CGRectMake(0, (self.view.frame.size.height + viewHeight), 320, 300);

    [UIView animateWithDuration:0.60f animations:^{

        CGRect twitterLinkFrame   = self.twitterLinksView.frame;
        twitterLinkFrame.origin.y = (self.view.frame.size.height - viewHeight);

        twitterLinksView.frame = twitterLinkFrame;
    }];
}

- (void)dismissView
{

    [UIView animateWithDuration:0.75f animations:^{

        CGRect twitterLinkFrame   = self.twitterLinksView.frame;
        twitterLinkFrame.origin.y = (self.view.frame.size.height + viewHeight);

        self.twitterLinksView.frame = twitterLinkFrame;
    }];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T21:43:11.387

```
[UIView animateWithDuration:1\. animations:^{

     //firstAnimationBlock

    } completion:^(BOOL finished){
        [UIView animateWithDuration:1\. animations:^{

//animations in this block will be called after firstAnimationBlock has expired
        }];
    }]; 
```

据我了解，您想一个接一个地播放 2 个动画。这段代码（块内的块）使这个

这部分是在编辑之后：好的，现在你可以尝试这样写

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath;
{
    [self dismissView];

// Do xyz...

[self performSelector:@selector(presentView:) withObject:twitterLinksView afterDelay:0.75];

//[self presentView:twitterLinksView];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:07:56.093

我最终拆分了我的创建方法并`[[self.view subviews] containsObject:twitterLinksView]`用于检查视图。还需要注意的是`[self performSelector:@selector(createView) withObject:twitterLinksView afterDelay:0.76f]`，它必须在解雇动画之前稍微提前一点才能正常工作......是的，wtf。

在`didSelectRowAtIndexPath`我使用的方法中`[self performSelector:@selector(presentView:)];`

感谢 meth 解决了部分难题。

```
- (void)presentView:(id)sender
{

    if ([[self.view subviews] containsObject:twitterLinksView])
    {
        [self dismissView];
        [self performSelector:@selector(createView) withObject:twitterLinksView afterDelay:0.76f];
        NSLog(@"Animating ut old");

    }
    else
    {
        NSLog(@"Creating new view");
        [self createView];
    }
}
-(void)createView
{
    twitterLinksView.frame = CGRectMake(0, (self.view.frame.size.height + viewHeight), 320, 300);

    [UIView animateWithDuration:0.60f animations:^{

        CGRect twitterLinkFrame   = self.twitterLinksView.frame;
        twitterLinkFrame.origin.y = (self.view.frame.size.height - viewHeight);

        twitterLinksView.frame = twitterLinkFrame;
        [self.view addSubview:twitterLinksView];

    }];
}

- (void)dismissView
{

    [UIView animateWithDuration:0.75f animations:^{

        CGRect twitterLinkFrame   = self.twitterLinksView.frame;
        twitterLinkFrame.origin.y = (self.view.frame.size.height + viewHeight);

        self.twitterLinksView.frame = twitterLinkFrame;

    }completion:^(BOOL finished){
        [twitterLinksView removeFromSuperview];
    }];
} 
```

# spring - 在 Spring 中重用 Coldfusion 中的 Hibernate 文件

> ID：15668377
> 
> 赞同：1
> 
> 时间：2013-03-27T20:05:33.780
> 
> 标签：spring, hibernate, coldfusion

是否可以为 Coldfusion 手动创建 Hibernate XML 文件并在以后在 Java Spring 中重用它们？

这个想法是，因为我知道 Coldfusion，我可以利用它来促进我对 Hibernate 的学习。学习完 Hibernate 后，我可以在尝试学习 Spring MVC（并转换我现有的 CF 项目）时重用 XML 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T22:32:07.390

我认为您不能“重用”hbxml，因为它具有一些特定于 CF 类/数据类型的特定绑定。

话虽如此，您可以使用 CF 生成的 .hbxml 作为起点。设置`savemapping`为真：[http ://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSED380324-6CBE-47cb-9E5E-26B66ACA9E81.html](http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSED380324-6CBE-47cb-9E5E-26B66ACA9E81.html)

你应该学习注解。我认为您可以快速了解如何在 Java 中指定映射，就像在`<cfproperty>`.

# java - Java for 循环不会运行...？

> ID：15668378
> 
> 赞同：2
> 
> 时间：2013-03-27T20:05:35.623
> 
> 标签：java

我正在做家庭作业，程序的关键循环给我带来了麻烦。我的老师告诉我，如果我对计数器控制变量使用 while 循环，她会扣分，所以我很想把这件事做好。

以下是我想做的工作，以及我心中的感觉应该工作：

```
for ( int check = 0; check == value; check++ ) {
    int octal = getOctal();
    int decimal = convertOctal( octal );
    System.out.printf( "%d:%d", octal, decimal );
} 
```

但是，此循环不会运行。我试着用一个while循环来做，效果很好！

```
int check = 0;
while ( check < value )
{
    int octal = getOctal();
    int decimal = convertOctal( octal );
    System.out.printf( "%d:%d", octal, decimal );
    check++;
} 
```

这是主要方法的其余部分：

```
public static void main ( String args[] )
{
    int value = getCount();

    while ( value < 0 )
    {
        System.out.print( "\nYou must enter a positive number" );
        value = getCount();
    }

    if ( value == 0 )
    {
        System.out.print( "\n\nNo numbers to convert.\n\n" );
    }
    else
    {   
        int check = 0;
        while ( check < value )
        {
            int octal = getOctal();
            int decimal = convertOctal( octal );
            System.out.printf( "%d:%d", octal, decimal );
            check++;
        }
    }
} 
```

是的，这是一个八进制到十进制的转换器。我自己从头开始编写了转换器方法，并为此感到非常自豪。

编辑：我的问题是，这里有什么问题？EDIT part deux：感谢大家帮助我消除误解。继续方法文档！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-27T20:07:04.070

```
for ( int check = 0; check == value; check++ ) 
```

这只会在`check == value`. 修改为：

```
for ( int check = 0; check < value; check++ ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T20:06:31.783

尝试`for ( int check = 0; check <= value; check++ )`代替`for ( int check = 0; check == value; check++ )`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T20:13:23.140

来自[Oracle 网站](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/for.html)（我的重点）：

> for 语句提供了一种迭代一系列值的紧凑方法。程序员经常将其称为“for 循环”，因为它反复循环直到满足特定条件。for 语句的一般形式可以表示为：

```
for (initialization; termination; increment) {
statement(s) 
} 
```

> 使用此版本的 for 语句时，请记住：
> 
> 初始化表达式初始化循环；它在循环开始时执行一次。
> 
> **当终止表达式的计算结果为 false 时，循环终止。**
> 
> 每次循环迭代后都会调用增量表达式；这个表达式增加或减少一个值是完全可以接受的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T20:10:49.983

要获得与以下相同的效果：

```
int check = 0;
while (check < value) {
  // something
} 
```

你`for`应该是这样的：

```
for (int check = 0; check < value; check++) {
  // something
} 
```

# python - 数组python的形状

> ID：15668380
> 
> 赞同：6
> 
> 时间：2013-03-27T20:05:41.780
> 
> 标签：python, numpy

假设我创建了一个二维数组

```
 m = np.random.normal(0, 1, size=(1000, 2))
 q = np.zeros(shape=(1000,1))
 print m[:,0] -q 
```

当我接受时，`m[:,0].shape`我得到`(1000,)`的不是`(1000,1)`我想要的。如何强制`m[:,0]`转换为`(1000,1)`数组？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T20:18:44.403

正如您所注意到的，通过特别选择第 0 列，您可以降低维度：

```
>>> m = np.random.normal(0, 1, size=(5, 2))
>>> m[:,0].shape
(5,) 
```

您有很多选择可以让 5x1 对象退出。您可以使用列表而不是整数进行索引：

```
>>> m[:, [0]].shape
(5, 1) 
```

您可以要求“所有列，但不包括 1”：

```
>>> m[:,:1].shape
(5, 1) 
```

或者您可以使用`None`(or `np.newaxis`)，这是扩展维度的一般技巧：

```
>>> m[:,0,None].shape
(5, 1)
>>> m[:,0][:,None].shape
(5, 1)
>>> m[:,0, None, None].shape
(5, 1, 1) 
```

最后，您可以重塑：

```
>>> m[:,0].reshape(5,1).shape
(5, 1) 
```

但对于这种情况，我会使用其他方法之一。

# c++ - 解密 XOR 加密文件过早中止

> ID：15668382
> 
> 赞同：5
> 
> 时间：2013-03-27T20:05:56.650
> 
> 标签：c++, file, encryption, stl, stream

使用一个简单的仿函数，称为`Encryptor`

```
struct Encryptor {
    char m_bKey;
    Encryptor(char bKey) : m_bKey(bKey) {}
    char operator()(char bInput) {
        return bInput ^ m_bKey++;
    }
}; 
```

我可以很容易地加密给定的文件

```
std::ifstream input("in.plain.txt", std::ios::binary);
std::ofstream output("out.encrypted.txt", std::ios::binary);
std::transform(
    std::istreambuf_iterator<char>(input),
    std::istreambuf_iterator<char>(),
    std::ostreambuf_iterator<char>(output),
    Encryptor(0x2a)); 
```

但是试图通过调用来恢复它

```
std::ifstream input2("out.encrypted.txt", std::ios::binary);
std::ofstream output2("out.decrypted.txt", std::ios::binary);
std::transform(
    std::istreambuf_iterator<char>(input2),
    std::istreambuf_iterator<char>(),
    std::ostreambuf_iterator<char>(output2),
    Encryptor(0x2a)); 
```

仅部分起作用。以下是文件大小：

```
in.plain.txt:      7,700 bytes
out.encrypted.txt: 7,700 bytes
out.decrypted.txt: 4,096 bytes 
```

在这种情况下，该方法似乎只适用于第一个`2**12`字节，并且可能只适用于它的倍数（它可能是我的文件系统的块大小吗？）。**为什么我会有这种行为，解决方法是什么？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:10:16.173

从您提供的源代码中，看起来输出流在您尝试从磁盘读回之前没有关闭。由于 ofstream 类中有一个输出缓冲区，因此您的数据可能仍在缓冲区中，因此未刷新到磁盘。在从磁盘读取之前关闭输出流应该可以解决问题。

# grails - Groovy Grails - 为后续请求存储对象

> ID：15668388
> 
> 赞同：1
> 
> 时间：2013-03-27T20:06:21.033
> 
> 标签：grails, groovy, request

我有一个 Web 应用程序，前端向服务器发出 ajax 请求以获取数据。在控制器中，我有以下逻辑：

```
def data = []

def method() {
  def objects = []
  ...
  from params determine if it is a first request
  ...
  if (firstRequest) {
    objects = someService.getObjectFromDB()
    data = objects
  } else {
    actions with data object
  } 
```

但问题是对于 2+ 请求`data`是一个空列表，尽管在第一个请求期间我用所需的信息填充它。我如何使用`data`对象是 2+ 个请求？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:30:14.083

将数据对象存储在用户会话中，例如：

```
session.data = objects 
```

当您输入数据的方法检查时已经存在..

```
if (!session?.data) {
    // first request
    objects = someService.getObjectFromDB()
    session.data = objects
} else {
    // retrieve data from session
    def oldData = session.data
    // do something
} 
```

这可能不是最好的解决方案，因为您将在会话中存储大量信息，因此请尽量将其限制在最低限度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T01:45:09.713

我建议将上述逻辑从控制器移动到服务类。这样做的好处：-

1.Service默认为单例。您可以将范围设置`request`为，从而获得每个请求的全局数据句柄。

2.Session不会被数据超载。

3.Best part:- 你可以传入`params`&/| `request`（控制器的默认值）到方法调用中的服务层。

# javascript - 自定义数据并在点击期间调用它们 - highcharts

> ID：15668389
> 
> 赞同：0
> 
> 时间：2013-03-27T20:06:24.533
> 
> 标签：javascript, jquery, highcharts

我已经添加：

```
 cursor: 'pointer',
        events: {
            click: function(event) {
                alert('x: ' + event.chartX + ', y: ' + event.chartY);
            }
        }
            series: [{
            name: 'Weak',
            color: 'red',
    data: [{
        y: 1,
        x:4,
        ticker:'KORS'
    }, {
        y: 5,
        x:2,
        ticker:'LULU'
    }]
},{name:'Strong',color:'green',data:[ {x:4,y:3,ticker:'lulu'},{x:-4,y:-2,ticker:'GPS'}  ]}

] 
```

它似乎正在工作。问题是，当我单击数据点时，由于我添加的代码，我在警报中看到 x 和 y 坐标，但我希望它也显示我添加的自定义数据点，即股票代码数据点。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:33:21.760

你有没有尝试过

```
event.point.ticker 
```

# core-animation - 在动画期间，能否在presentationLayer树中原子读取每个CALayer的属性？

> ID：15668390
> 
> 赞同：1
> 
> 时间：2013-03-27T20:06:26.627
> 
> 标签：core-animation

我正在寻找一种从 CoreAnimation 动画制作视频的解决方案。

如果我递归地枚举我的根 CALayer 表示层的子层，当我正在读取（表示）树中的属性时，值（位置、变换、不透明度..）是否存在不断变化的风险？还是表示层像 CALayer 层次结构的深层副本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:10:58.440

表示层是模型层的深层副本，应用了所有活动动画。它实际上不是用于渲染到屏幕的文字表示树，它只是一个近似值。

# android - Android 默认铃声的许可是什么？

> ID：15668391
> 
> 赞同：3
> 
> 时间：2013-03-27T20:06:29.300
> 
> 标签：android

我可以在 Android[源代码](https://android.googlesource.com/platform/frameworks/base/+/android-cts-4.2_r2/data/sounds/notifications/ogg/)上看到它们，但它们似乎没有许可证。

# r - 通过从 R 中每个试验的概率计算累积概率来学习使用循环

> ID：15668395
> 
> 赞同：0
> 
> 时间：2013-03-27T20:06:34.520
> 
> 标签：r, loops, probability

我自己已经挣扎了足够长的时间才能找到答案。我保证我会尝试从解决方案中学习。为了学习，我想了解*如何使用显式循环来做到这一点*，但是如果您想分享矢量化方法作为奖励，也非常感谢。

假设我每天要玩一次游戏，并且我知道每天获胜的概率。我想要一个函数，它采用概率向量并返回至少一天成功的累积概率。因此，如果我连续玩 3 天并且每天获胜的概率是 0.5，那么我的函数应该返回“0.875, 0.75, 0.5”

这是我最近一次编写此函数的失败尝试：

```
prob_cum <- function(prob_today) {
  p_cum <- rep(0, length(prob_today))
  for (i in 1:length(prob_today)) {
    for (j in i:length(prob_today)) {
      p_cum[j] <- p_cum[j-1] - ((1 - p_cum[j-1]) * prob_today[j])
    }
  }
  p_cum
}

prob_daily <- c(.5,.5,.5)
prob_cum(prob_daily) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T20:29:03.577

```
>  1 - cumprod( 1- c(0.5,0.5,0.5) )
[1] 0.500 0.750 0.875
 # (1- prob_success) is the prob_non_success vector 
```

如果需要，可以轻松包装到函数中。您的初始测试不是一个好的测试，因为它没有透露我在 cumprod 参数中没有从 1 中减去成功向量的原始错误。

```
 vec<-runif(100)
 prob_cum <- function(prob_today) {
   p_cum <- rep(0, length(prob_today))
   p_cum[1] <- prob_today[1]
   for (j in seq_along(prob_today)[-1]) {
     p_cum[j] <- p_cum[j-1] + ((1 - p_cum[j-1]) * prob_today[j])
   }
   p_cum
 }
 Prob_vec <- function(vec) 1 - cumprod( 1- vec) 
 require(rbenchmark)
 benchmark( prob_cum(vec) , Prob_vec(vec) ,replications=1000)
#           test replications elapsed relative user.self sys.self user.child sys.child
#1 prob_cum(vec)         1000   0.538   59.778     0.532    0.008          0         0
#2 Prob_vec(vec)         1000   0.009    1.000     0.008    0.002          0         0 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-27T20:54:53.740

一次解决每个问题：

你有一个`i`不做任何事情的循环；它只是多次执行相同的计算，并且每次都会覆盖结果（具有相同的结果）。放下那个。

```
prob_cum <- function(prob_today) {
  p_cum <- rep(0, length(prob_today))
  for (j in i:length(prob_today)) {
    p_cum[j] <- p_cum[j-1] - ((1 - p_cum[j-1]) * prob_today[j])
  }
  p_cum
} 
```

这还是有问题的。对于`j=1`，您尝试访问`p_cum[0]`哪个是零长度向量，并且您的计算假定一个长度向量。这就是您收到错误消息的原因

```
Error in p_cum[j] <- p_cum[j - 1] - ((1 - p_cum[j - 1]) * prob_today[j]) : 
  replacement has length zero 
```

初始化`p_cum[1]`然后循环其余部分。

```
prob_cum <- function(prob_today) {
  p_cum <- rep(0, length(prob_today))
  p_cum[1] <- prob_today[1]
  for (j in 2:length(prob_today)) {
    p_cum[j] <- p_cum[j-1] - ((1 - p_cum[j-1]) * prob_today[j])
  }
  p_cum
} 
```

这种循环结构具有潜在危险。只要`prob_today`长度至少为 2，它就可以工作，但如果长度为 1，它的行为会出乎意料。更好的是

```
prob_cum <- function(prob_today) {
  p_cum <- rep(0, length(prob_today))
  p_cum[1] <- prob_today[1]
  for (j in seq_along(prob_today)[-1]) {
    p_cum[j] <- p_cum[j-1] - ((1 - p_cum[j-1]) * prob_today[j])
  }
  p_cum
} 
```

现在我们遇到了一个真正的问题：你的算法是错误的。每天至少获得一场胜利`j`的概率是每天至少获得一场胜利的概率加上在当时还没有`j-1`获胜的情况下当天获得胜利的概率。`j`你有一个减号。

```
prob_cum <- function(prob_today) {
  p_cum <- rep(0, length(prob_today))
  p_cum[1] <- prob_today[1]
  for (j in seq_along(prob_today)[-1]) {
    p_cum[j] <- p_cum[j-1] + ((1 - p_cum[j-1]) * prob_today[j])
  }
  p_cum
} 
```

现在你有一个有效的功能：

```
> prob_cum(prob_daily)
[1] 0.500 0.750 0.875
> prob_cum(c(0.5, 0.01, 0.99))
[1] 0.50000 0.50500 0.99505 
```

完全矢量化的解决方案来自不同地表达概率。至少获得一场胜利的概率是 1 减去到那天为止所有失败的概率。这些是独立的概率，所以只是每天亏损的产物。

```
prob_cum <- function(prob_today) {
  1 - cumprod(1-prob_today)
} 
```

给出相同的结果

```
> prob_cum(prob_daily)
[1] 0.500 0.750 0.875
> prob_cum(c(0.5, 0.01, 0.99))
[1] 0.50000 0.50500 0.99505 
```

并适用于单个值和空向量，无需任何额外调整

```
> prob_cum(c(0.75))
[1] 0.75
> prob_cum(c())
numeric(0) 
```

# drop-down-menu - Yii cGrid 中的下拉菜单 - 2 个变量

> ID：15668400
> 
> 赞同：0
> 
> 时间：2013-03-27T20:06:54.507
> 
> 标签：drop-down-menu, yii, cgridview

我在控制器中填充了 $model1、$model2 和 OwnerID，它在我的 zii.widgets.grid.CGridView 中呈现数据当我想将 $model2 发送到视图时出现问题，如下所示：

```
$this->render('listView', array('model1'=>$model, 'model2' => $model2, 'OwnerID' => 14)); 
```

在我看来，我有：

```
$this->widget('zii.widgets.grid.CGridView', array(
    'id'=>'listKeys',
    'dataProvider'=>$model1->search($OwnerID),
    'summaryText'=>'Showing {start} to {end} of {count} keys.',
    'columns'=>array(
        array('value'=>'$data["id"]', 'header'=>'Key ID'),
        array(
            'type'=>'raw',
            'header'=>'Edit',
            'value'=>'CHtml::dropDownList("partyList","owner_party_id", $model2)'
        ),
    ),
)); 
```

我得到“ **Undefined variable: model2** ” $model2 中有数据，如果我注释掉网格中的下拉列表并在网格外有下拉列表，如下所示：

```
<?php echo CHtml::dropDownList("partyList","owner_party_id", $model2) ?> 
```

然后一切正常。如何在 CGridView 中添加 dropDownList？$model1 是文件列表，$model2 是用户列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:44:18.603

`$model2`需要是字符串或被`CGridView`.

要获取数组的字符串表示形式，请使用[`var_export()`](https://stackoverflow.com/a/2605783/428543)

```
...
'value'=>'CHtml::dropDownList("partyList","owner_party_id",'.var_export($model2).')',
... 
```

要创建`$model2`一个`CGridView`变量，您需要[按照这个 Yii wiki 页面](http://www.yiiframework.com/wiki/252/special-variables-in-cgridview-and-clistview/)`CGridView`中的说明进行扩展

# php - 我是否正确使用我的服务与我的实体和映射器。我的业务逻辑正确吗？

> ID：15668401
> 
> 赞同：2
> 
> 时间：2013-03-27T20:07:00.723
> 
> 标签：php, oop, model-view-controller

在我的应用程序中有客户和快递员。只有当 Courier 当前在线并且两个用户来自同一位置时，客户才能向 Courier 发送交付请求。

当客户想要向 Courier 发送交付请求时，我的`DeliveryRequest`服务有一个`sendDeliveryRequest(Request request)`从`Controller`.

```
public function sendDeliveryRequest(Request $request) {

    $customer = $this->recognitionService->getUser();

    $courier = $this->entityFactory->build('Courier');
    $courier->setId( $request->post('courierId') );
    $courierMapper = $this->mapperFactory->build('Courier');
    $courierMapper->fetch($courier);

    $deliveryRequest = $this->entityFactory->build('DeliveryRequest');

    $someRequestedItems = array();
    $deliveryRequest->sendRequest($customer, $courier, $someRequestedItems);

} 
```

到目前为止，在我的`sendRequest(Customer $customer, Courier $courier, Array $items)`方法中，我有：

```
public function sendRequest(Customer $customer, Courier $courier, Array $items) {

    // Check if the couriers account is active
    if( !$courier->isActive() ) {
        return 'courier not active';
    }
    // Check if the courier is online
    if( !$courier->isOnline() ) {
        return 'courier not online';
    }
    // Check the status of the customers location, active/inactive
    if( !$customer->getLocation()->isActive() ) {
        return 'customers location disabled';
    }
    // Check if the customer and the courier live in the same location
    if( !$customer->sameLocationAs($courier) ) {
        return 'customer and courier in different locations';
    }
    // More checks

} 
```

到目前为止，对我来说，它看起来不错并且运行良好，但我不能 100% 确定我是否正确地执行了业务逻辑，尤其是`!$customer->sameLocationAs($courier)`.

该方法使用提供的`$courier`对象来获取 Couriers 位置（这是一个带有 的对象`id`）并将其与客户位置进行比较以检查它们是否在同一位置。它工作得很好，但我不确定这是否是完成检查两个用户是否来自同一位置的最佳方法。这是有效的**业务逻辑吗？**

此外， 中的项目`$deliveryRequest`，它们的数据（`id`, `quantity`）将在从`$request`传递的对象中，所以我将在 中`Controller`创建每个并将它们放入数组中，然后将数组与 和 传递给方法。这意味着我必须在该方法中进行检查（检查输入的数量是否不超过数量的数据库值等），**这是正确的方法还是不好？**`Item``Service``$customer``$courier``sendRequest()`

 **我是否在我的应用程序的正确位置/层正确地进行检查/验证？

任何帮助都会非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T17:28:31.817

对于第一个问题，我会说您的方法“sameLocationAs”是有效的。另一种可能性是创建一个具有静态方法并且可以在类之间提供服务的 Util 类。

这是模型检查项目是否有效（不是控制器）的工作，因此您有两种可能性：

1.  就像你想做的一样

2.  当您创建 Item 对象时，您可以在 item 类或使用观察者设计模式中检查对象的有效性。（很难而且不需要，如果你想自动保存对象很有趣）

3.  使用可以完成这项工作的验证类（这也很好）

如果您的服务代码仅涉及服务利益，那将是很好的。

但是您所做的是正确的，我会说并且有效，您应该走得更远一点**

# android - Android - 没有名为的 android 项目

> ID：15668405
> 
> 赞同：2
> 
> 时间：2013-03-27T20:07:15.097
> 
> 标签：android, eclipse, export

当。很抱歉在这里问了这么多不同的问题。所以，我有一个导入到我的工作区的 android 项目。然后，在修复任何构建路径错误和其他东西之后，我去导出它。当我第一次导入它时，它自动命名为“MainActivity”。所以，我尝试导出它，但我收到错误“没有名为 MainActivity 的 android 项目。我检查了该文件夹在我的工作区中。我搜索但找不到有效的答案。我猜 Eclipse 将此代码视为某些东西否则。当我导入它时，我几乎是肯定的，我选择导入现有的 android 应用程序项目......

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-27T20:12:05.190

您正在尝试运行您的库项目，如果该项目不是库
右键单击项目 >> 属性 >> Android >> 在右侧面板中向下滚动 >> 取消选中`isLibrary`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:16:03.703

Eclipse 可能将您的项目视为库而不是 Android 项目。检查您的 project.properties 文件（您会在左侧的 Package Explorer 中找到它作为项目中的最后一个文件）。如果在底部您看到以下行：

```
android.library=true 
```

只需摆脱它，或尝试将其设置为`false`. 它通常应该可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-23T08:01:14.333

您可能已将项目设置为库。尝试在 Project > Properties > Android > Library 和 UNCHECK Is Library 更改设置

# nhibernate - NHibernate - 使用集合缓存时重复结果

> ID：15668407
> 
> 赞同：1
> 
> 时间：2013-03-27T20:07:24.270
> 
> 标签：nhibernate, nhibernate-caches

当使用具有多层双向父子（-grandchild）一对多关系的二级缓存时，我从 NHibernate 得到非常奇怪的行为：

```
int id;

using(var session = sessionFactory.OpenSession())
{
    var parent = new Parent();
    var child1 = parent.AddChild();
    child1.AddGrandChild();
    var child2 = parent.AddChild();
    child2.AddGrandChild();
    session.Save(parent);
    session.Flush(); // force id generation
    id = parent.Id;
}

using(var session = sessionFactory.OpenSession())
{
    var parent = session.Get<Parent>(id);
    parent.Children.Should().HaveCount(2); // but is actually 3; second child duplicated
} 
```

第二个孩子，有两个孙子，在集合中被复制，但具有相同的对象 id ( `ReferenceEquals()`is `true`)。当我禁用`Parent.Children`集合的缓存或将获取策略设置为 时`Join`，问题就消失了。任何想法如何找出这里发生的事情？

实体：

```
class Parent
{
    public virtual int Id { get; protected set; }
    public virtual List<Child> children = new List<Child>();
    public virtual IEnumerable<Child> Children
    {
        get { return children.ToList(); }
    }

    public virtual Child AddChild()
    {
        var child = new Child(this);
        this.children.Add(child);
        return child;
    }
}

class Child
{
    public Child(Parent parent)
    {
        this.Parent = parent;
    }

    public virtual int Id { get; protected set; }
    public virtual List<GrandChild> grandChildren = new List<GrandChild>();
    public virtual IEnumerable<GrandChild> GrandChildren
    {
        get { return grandChildren.ToList(); }
    }

    public virtual Parent Parent { get; protected set; }

    public virtual GrandChild AddGrandChild()
    {
        var grandChild = new GrandChild(this);
        this.grandChildren.Add(grandChild);
        return grandChild;
    }

}

class GrandChild
{
    public virtual int Id { get; protected set; }
    public virtual Child Parent { get; protected set; }

    public GrandChild(Child parent)
    {
        this.Parent = parent;
    }

} 
```

映射：

```
public class ParentMap : ClassMap<Parent>
{
    public ParentMap()
    {
        Id(p => p.Id).GeneratedBy.Identity();
        HasMany(p => p.Children)
            .Access.CamelCaseField()
            .Inverse()
            .Cascade.AllDeleteOrphan()
            .Cache.ReadWrite();
        Cache.ReadWrite();
    }
}

public class ChildMap : ClassMap<Child>
{
    public ChildMap()
    {
        Id(c => c.Id).GeneratedBy.Identity();
        HasMany(c => c.GrandChildren)
            .Access.CamelCaseField()
            .Inverse()
            .Cascade.AllDeleteOrphan()
            .Cache.ReadWrite();
        References(c => c.Parent);
        Cache.ReadWrite();
    }
}

public class GrandChildMap : ClassMap<GrandChild>
{
    public GrandChildMap()
    {
        Id(c => c.Id).GeneratedBy.Identity();
        References(c => c.Parent);
        Cache.ReadWrite();
    }
} 
```

[编辑]

我通过不为子集合启用缓存来解决这个问题。因为我首先这样做是为了避免`fetch join`对缓存实体的子项进行查询时出现 N+1 选择问题，所以我改为执行以下操作：

```
 public ChildMap()
    {
       // ...
        HasMany(c => c.GrandChildren) // removed Cache.ReadWrite() here
            /* ... */;

        // added IncludeAll() to make sure lazily fetched collections get cached
        Cache.ReadWrite().IncludeAll(); 
    } 
```

不过，我仍然不明白这里发生了什么，所以仍然欢迎对此事有任何见解:-)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:27:25.943

您是否尝试过使用事务而不是会话刷新？喜欢

```
using(var session = sessionFactory.OpenSession())
using(var transaction = session.BeginTransaction())
{
    var parent = new Parent();
    [...]
    parent.Save();
    transaction.Commit();
    id = parent.Id;
} 
```

也许这有帮助。我曾经遇到过类似的问题，我可以通过使用事务来解决。

# iphone - 向方法发送参数 - NSTimeInterval

> ID：15668414
> 
> 赞同：1
> 
> 时间：2013-03-27T20:07:57.677
> 
> 标签：iphone, objective-c, methods, parameters

我正在尝试将 NSTimeInterval 从在后台线程上运行的方法发送到将在主线程上运行的方法。不幸的是，我收到此错误：

```
Sending 'NSTimeInterval' (aka 'double') to parameter of incompatible type 'id' 
```

这是我的代码 - 知道出了什么问题吗？

首先，我设置我的 NSTimerInterval，并调用 performSelectorOnMainThread：

```
NSTimeInterval delayBetweenIntAdsNSTimeInterval = [responseStringTimeBetweenAds doubleValue];
[self performSelectorOnMainThread:@selector(startTimerForAds:) withObject:delayBetweenIntAdsNSTimeInterval waitUntilDone:NO]; 
```

这是我正在调用的方法的代码：

```
-(void)startTimerForAds:(NSTimeInterval)intervalBetweenAds {
} 
```

关于这出了什么问题的任何想法？

谢谢，

**更新**

我打电话：

```
[self performSelectorOnMainThread:@selector(startTimerForAds:) withObject:@(delayBetweenIntAds) waitUntilDone:NO]; 
```

这是那个方法：

```
-(void)startTimerForAds:(NSInteger *)intervalBetweenIntAdsInteger {
} 
```

但是通过那个调用（通过对象），XCode 显示：

```
Illegal type 'NSInteger *' (aka 'int *') used in a boxed expression 
```

它显示在 [intervalBetweenIntAdsInteger doubleValue] 上：

```
Bad receiver type 'NSInteger *' (aka 'int *') 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:26:01.873

NSTimeInterval 不是一个对象。试试 NSNumber，应该可以：

```
NSTimeInterval delayBetweenIntAdsNSTimeInterval = [responseStringTimeBetweenAds doubleValue];
[self performSelectorOnMainThread:@selector(startTimerForAds:) withObject:@(delayBetweenIntAdsNSTimeInterval) waitUntilDone:NO];

-(void)startTimerForAds:(NSNumber *)intervalBetweenAds {

     NSTimeInterval i = [intervalBetweenAds doubleValue];

} 
```

由于您的更新而更新：

```
[self performSelectorOnMainThread:@selector(startTimerForAds:) withObject:@(delayBetweenIntAds) waitUntilDone:NO];

-(void)startTimerForAds:(NSNumber *)intervalBetweenAds {
     int i = [intervalBetweenAds intValue];
} 
```

# python - 在 Python 中实现二维切片

> ID：15668416
> 
> 赞同：4
> 
> 时间：2013-03-27T20:08:06.053
> 
> 标签：python, duck-typing

我正在用 Python 实现一个线性代数库（我知道可能存在某些东西，但我这样做是为了了解 Python 和考试所需的数学知识），并且我希望能够访问元素/子集像这样的矩阵：

（我的矩阵类是元组的子类。）

*   `M = Matrix([list of rows of elements])`
*   `M[1, 2]`获取 (1, 2) 处的元素
*   `M[3]`获取第 3 行

这些很容易做到，但我也想实现切片，如下所示：

*   `M[:,:]`返回整个矩阵
*   `M[1:6:2]`返回第 1、3 和 5 行
*   `M[1:6:2, 0:2]`返回由与前两列相交的第 1、3 和 5 行组成的矩阵。

我已经这样做了，但我的回答似乎非常不符合 Python 风格：

```
def __getitem__ (self, idx):
    if isinstance(idx, numbers.Integral):
        # Code to return the row at idx
    elif (isinstance(idx, tuple) and len(idx) == 2 and
            all(isinstance(i, numbers.Integral) for i in idx)):
        # Code to return element at idx
    elif (isinstance(idx, tuple) and len(idx) == 2 and
            all(isinstance(i, slice) for i in idx)):
        # Code to parse slices 
```

另一个问题是两个索引都必须是数字或切片，我不能混合。这样做需要另外两个 elif 块，这似乎是两个很多。代码已经很丑陋了。

我认为答案涉及鸭子打字，但我不完全确定如何实现。我一直在看`try:except:`块，但我不确定如何将它们链接起来，而且我真的不想嵌套太多。

所以，所以，谢谢你的阅读。实现这样的功能的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:53:53.063

你几乎必须做这样的*事情*......但至少你可以删除一些重复。

首先，考虑`[1,]`表示“第 1 行”可能是合理的，就像`[1]`. （`numpy`这样做。）这意味着您不需要 tuple-vs.-int 的东西；只需将 int 视为 1 元素元组。换句话说：

```
def __getitem__(self, idx):
    if isinstance(idx, numbers.Integral):
        idx = (idx, slice(None, None, None))
    # now the rest of your code only needs to handle tuples 
```

其次，尽管您的示例代码只处理两个切片的情况，但您的实际代码必须处理两个切片，或者一个切片和一个 int，或者一个 int 和一个切片，或者两个 int，或者一个切片，或者一个 int。如果您可以分解出切片处理代码，则无需一遍又一遍地复制它。

处理 int-vs.-slice 的一个技巧是将`[n]`其视为一个包装器，本质上`[n:n+1][0]`，它可以让您进一步减少所有内容。（这比这有点棘手，因为您必须对一般的负数进行特殊处理，或者只是`-1`，因为很明显`n[-1] != n[-1:0][0]`。）对于一维数组，这可能不值得，但对于二维数组，它可能是，因为这意味着当你处理列时，你总是得到一个行列表，而不仅仅是一行。

另一方面，您可能希望在`__getitem__`和之间共享一些代码`__setitem__`……这使得这些技巧中的一些要么不可能实现，要么变得更加困难。所以，有一个权衡。

无论如何，这是一个示例，它完成了我能想到的所有简化和预处理/后处理（可能比您想要的更多），因此最终您总是在查找一对切片：

```
class Matrix(object):
    def __init__(self):
        self.m = [[row + col/10\. for col in range(4)] for row in range(4)]
    def __getitem__(self, idx):
        if isinstance(idx, (numbers.Integral, slice)):
            idx = (idx, slice(None, None, None))
        elif len(idx) == 1:
            idx = (idx[0], slice(None, None, None))
        rowidx, colidx = idx
        rowslice, colslice = True, True
        if isinstance(rowidx, numbers.Integral):
            rowidx, rowslice = slice(rowidx, rowidx+1), False
        if isinstance(colidx, numbers.Integral):
            colidx, colslice = slice(colidx, colidx+1), False
        ret = self.m[rowidx][colidx]
        if not colslice:
            ret = [row[0] for row in ret]
        if not rowslice:
            ret = ret[0]
        return ret 
```

或者，如果您沿另一个轴重构事物可能会更好：获取行，然后获取其中/它们中的列：

```
def _getrow(self, idx):
    return self.m[idx]

def __getitem__(self, idx):
    if isinstance(idx, (numbers.Integral, slice)):
        return self._getrow(idx)
    rowidx, colidx = idx
    if isinstance(rowidx, numbers.Integral):
        return self._getrow(rowidx)[colidx]
    else:
        return [row[colidx] for row in self._getrow(rowidx)] 
```

这看起来要简单得多，但我在这里通过将第二个索引转发到 normal 来作弊`list`，这只是因为我的底层存储是 a `list`of `list`s。但是，如果您有*任何*类型的可索引行对象要遵循（并且它不会浪费不可接受的时间/空间来不必要地创建这些对象），您可以使用相同的作弊方法。

* * *

如果您反对在 index 参数上进行类型切换，是的，这似乎通常是 unpythonic，但不幸的是它`__getitem__`通常是如何工作的。如果你想使用通常的 EAFTP`try`逻辑，你可以，但是当你必须在多个地方尝试两个不同的 API（例如，`[0]`用于元组和`.start`切片）时，我认为它不会更具可读性。您最终会在顶部进行“鸭子类型切换”，如下所示：

```
try:
    idx[0]
except AttributeError:
    idx = (idx, slice(None, None, None)) 
```

……等等，这只是没有任何通常好处的普通类型切换的代码的两倍。

# c - C中二维数组的动态内存分配

> ID：15668417
> 
> 赞同：-1
> 
> 时间：2013-03-27T20:08:12.433
> 
> 标签：c, malloc

```
#include<stdio.h>  
#include<math.h>  
#include<stdlib.h>  
#include<string.h>  

void allocate_double_2darray(int ip_flag, double **ip_array, int num_row, int num_col); 

int main(void)  
{  

        int num_row, num_col;  
        double **temp_array;  

        num_row = 4;  
        num_col = 2;

        allocate_double_2darray(0, temp_array, num_row, num_col); //Allocate memory
        allocate_double_2darray(1, temp_array, num_row, num_col); //initialize
        allocate_double_2darray(2, temp_array, num_row, num_col); //Free Memory
        return 0;

}

void allocate_double_2darray(int ip_flag, double **ip_array, int num_row, int num_col)  
{  

      int i_loop, j_loop;
      if(ip_flag == 0)  //allocate (free) memeory from array
        { ip_array = malloc(sizeof(double *) * num_row);                   
          for(i_loop = 0; i_loop < num_row; i_loop++)
          ip_array[i_loop] = malloc(sizeof(double) * num_col);                     
        }

      if(ip_flag == 1)  //initialize to zero 
        {    
          for(i_loop = 0; i_loop < num_row; i_loop++)
              for(j_loop = 0; j_loop < num_col; j_loop++)        
                  ip_array[i][j] = 0.0;      
        }   

      if(ip_flag == 2)  //deallocate (free) memeory from array 
        {    
          for(i_loop = 0; i_loop < num_row; i_loop++)
             free(ip_array[i_loop]);
          free(ip_array);         
        }            

} 
```

这是分配内存以创建二维数组的简单函数。它编译成功。但是，当我执行它时，它给了我分段错误错误。有没有人帮我找到我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:35:48.310

您不能从函数内部更改指针的值。您可以使用指针并更改其内容，但不能更改指针本身并期望它在外部可用。

在您的情况下，调用`ip_flag==0`没有做任何有用的事情，并且当调用`ip_flag==1`它时会出现段错误。

可能的解决方案：

*   尝试使用宏
*   或者改`ip_array = malloc(sizeof(double *) * num_row);`到函数外面`allocate_double2d_array`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T22:22:24.277

更改函数参数，使其获得指向矩阵的指针，这样您就可以通过传递指针本身的地址来更改指针指向的位置。

```
#include<stdio.h>  
#include<math.h>  
#include<stdlib.h>  
#include<string.h>  

void allocate_double_2darray(int ip_flag, double **ip_array, int num_row, int num_col); 

int main(void)  
{  

        int num_row, num_col;  
        double **temp_array;  

        num_row = 4;  
        num_col = 2;

        allocate_double_2darray(0, &temp_array, num_row, num_col); //Allocate memory
        allocate_double_2darray(1, &temp_array, num_row, num_col); //initialize
        allocate_double_2darray(2, &temp_array, num_row, num_col); //Free Memory
        return 0;

}

void allocate_double_2darray(int ip_flag, double ***ip_array, int num_row, int num_col)  
{  

      int i_loop, j_loop;
      if(ip_flag == 0)  //allocate (free) memeory from array
        { (*ip_array) = malloc(sizeof(double *) * num_row);                   
          for(i_loop = 0; i_loop < num_row; i_loop++)
          (*ip_array)[i_loop] = malloc(sizeof(double) * num_col);                     
        }

      if(ip_flag == 1)  //initialize to zero 
        {    
          for(i_loop = 0; i_loop < num_row; i_loop++)
              for(j_loop = 0; j_loop < num_col; j_loop++)        
                  (*ip_array)[i][j] = 0.0;      
        }   

      if(ip_flag == 2)  //deallocate (free) memeory from array 
        {    
          for(i_loop = 0; i_loop < num_row; i_loop++)
             free((*ip_array)[i_loop]);
          free((*ip_array));
          (*ip_array) = NULL;         
        }            

} 
```

# c# - 更有效的循环？

> ID：15668422
> 
> 赞同：3
> 
> 时间：2013-03-27T20:08:31.693
> 
> 标签：c#, arrays, string, loops, operators

因此，我正在编写一个简单的结构来充当字符串数组，但具有一些方便的运算符和其他我一直希望在字符串中看到的函数。具体来说，我现在正在使用的方法是 / 运算符。**问题是，它不会像我想要的那样在最后添加任何余数。**

它应该做的是获取一个字符串数组，例如`{"Hello", "Test1", "Test2", "Goodbye", "More?", "Qwerty"}`，假设我想除以 4，它*应该*返回`{ {"Hello", "Test1", "Test2", "Goodbye"}, {"More?", "Qwerty"} }`但它没有返回。

全班（我想改进的方法是 / 运算符，但如果您看到我可以做的其他事情，请指出）（我知道几乎没有任何评论。对不起，没想到还有其他人除了我之外，还可以查看此代码。）：

```
public struct StringCollection
{
    private String[] value;

    public StringCollection(params String[] s)
    {
        this.value = s;
    }

    public StringCollection(StringCollection current, String ad)
    {
        if (current.value == null) {
            current.value = new String[0] { };
        }
        this.value = new String[current.value.Length+1];
            for (int i=0; i<this.value.Length; i++)
            {
                try {
                    this.value[i] = current[i];
                } catch {
                    break;
                }
            }
            this.value[this.value.Length-1] = ad;
    }
    public StringCollection(StringCollection x, params StringCollection[] y)
    {
        this.value = x.value;
        for (int j=0;j<y.Length;j++)
        {
            for (int i=0;i<y[j].value.Length;i++)
            {
                this += y[j][i];
            }
        }
    }

    public static StringCollection[] operator /(StringCollection x, int y)
    {
        StringCollection[] result = null;
        if (((int)x.value.Length/y) == ((double)x.value.Length)/y)
            result = new StringCollection[y];
        else
            result = new StringCollection[y+1];
        for (int j=0;j<y;j++)
        {
            for (int i=0;i<((int)x.value.Length/y);i++)
            {
                result[j] += x.value[i+(int)((x.value.Length/y)*j)];
            }
        }
        if (((int)x.value.Length/y) != ((double)x.value.Length)/y)
        {
                            // This is the part that isn't working.
            for (int i=0;i<(((int)x.value.Length/y)*result[0].value.Length)-x.value.Length;i++) 
            {
                result[result.Length-1] += x.value[i+((result[0].value.Length)*result.Length-2)];
            }
        }
        return result;
    }
    public String this[int index]
    {
        get {
            return this.value[index];
        }
        set {
            this.value[index] = value;
        }
    }

} 
```

它所做的基本上是获取您的数组（单个数组）并将其拆分为一堆大小相同的数组，然后在最后将剩余部分添加到一个新数组中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T21:07:17.607

首先，您的问题根本与循环无关，或者至少循环仅在您的代码中得到解决。你应该有不同的标题。

其次，可以改进您的阵列添加/删除；即每次将 1 添加到数组大小并删除 1 然后每次重新复制整个数组是一个时间接收器。

现在到你的问题上，你的代码基本上应该是这样的：

```
//Make your return array
int retLen = x.Length / y;      

//Add space for the remainder
if(x.Length % y != 0)
  retLen++;

var ret = new StringCollection[retLen];

//Reusing variables is a good way to save memory, but watch naming conventions as this can be confusing
retLen = 0;

var tempCollection = new StringCollection();

for (int i = 0; i < x.Length; i++)
{
  tempCollection = new StringCollection(tempCollection, x[i]);

  if(i % y == 0 || i == x.Length - 1)
  {
    ret[retLen++] = tempCollection;
    tempCollection = new StringCollection();
    retLen = 0;
  }    
}

return ret; 
```

我真的不喜欢你在这个结构中没有 Add 函数，这样我们就清楚了。`tempCollection = new StringCollection(tempCollection, x[i]);`当涉及到创建所有这些新对象的 CPU 时间时，这真是太糟糕了。

很确定你需要调整它以确保所有项目都正确输入，但这是第一次尝试，所以......嗯 oO 想，因为没有人真的会回答你我会花时间。

编辑：发现一个错误，添加到 ret 时忘记将 retLen 设置回 0

# c++ - C++ 作业 - 数单词

> ID：15668424
> 
> 赞同：0
> 
> 时间：2013-03-27T20:08:40.757
> 
> 标签：c++, pointers, count, words

所以我正在制作一个程序，它可以让你输入一个句子，程序会计算句子中有多少个单词。我似乎无法让程序让我输入字符串。我需要在 cin 中包含指针吗？

```
#include <cstring>
#include <string>
#include <iostream>

int stringsize(char*);
using namespace std;

int main()
{
    char* cstring;  //pointer
    cout << " Please enter phrase to count number of words: ";
    cin.get(cstring);
    int numofwords;
    numofwords = stringsize(cstring);
    cout << numofwords << endl;
    system("pause");

    return 0;
}

int stringsize(char* cstr)
{
    int pos,sizeofstr;
    sizeofstr = 0;
    string copy;
    string cplusstr(cstr);
    while ((pos = cplusstr.find(' ')) != -1)
    {
        pos = cplusstr.find(' ');
        copy.assign(cplusstr,0,pos);
        cplusstr.erase(0,pos+1);
        copy.erase(0,pos);
        sizeofstr = sizeofstr + 1;
    }
    int length = cplusstr.size();
    char* cstring = new char[length + 1];
    strcpy(cstring,cplusstr.c_str());
    if(cstring != NULL) //no whitespace left but there is still a word
    {
        sizeofstr = sizeofstr + 1;
    }
    return sizeofstr;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:10:35.670

使用`std::string`而不是`char*`. 顺便说一句，在您的实际代码中，指针未初始化为指向任何有效的内存位置。

```
std::string phrase;
cin >> phrase; 
```

并将其传递给`phrase.c_str()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:10:53.040

问题是您没有为指针分配内存，甚至没有初始化它。

```
char* cstring = new char[256]; 
```

那应该解决它。

之后，您将`delete[] cstring;`释放分配的内存。

* * *

无论如何，这是 C++，所以你应该尽量避免`char*`和使用`std::string`。性能根本不会有太大变化，在这种情况下，它甚至无关紧要。

```
std::string str;
std::cin >> str;
int numofwords = stringsize(str.c_str()); 
```

# php - 基于 flash/xml 的幻灯片不显示图像

> ID：15668427
> 
> 赞同：0
> 
> 时间：2013-03-27T20:08:56.887
> 
> 标签：php, javascript, flash, slideshow

我试图弄清楚为什么[此页面](http://credencegasservices.com/cgs.php?ID=17)上的幻灯片不起作用（它仅适用于 FireFox，不适用于 Chrome 或 IE）。

如您所见，这是基于 Flash 的幻灯片，并从 xml 读取其数据。xml 也是使用 php 脚本生成的。

[当我手动导航到php 脚本](http://www.credencegasservices.com/slideshow-xml.php?showID=8)并为其提供正确的 slidehsow ID时，我可以验证是否生成了正确的 xml 。

该 php 脚本在嵌入代码的 flashvars 属性中调用。知道为什么不显示幻灯片吗？

这是整个代码：

```
<script type="text/javascript">
    AC_FL_RunContent( 'codebase','http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0','width','680','height','251','src','topShow','quality','high','pluginspage','http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash','movie','topShow','FlashVars','xmlfile=http://www.credencegasservices.com/slideshow-xml.php?showID=8' ); //end AC code
</script>
<embed width="680" height="251" type="application/x-shockwave-flash" flashvars="xmlfile=http://www.credencegasservices.com/slideshow-xml.php?showID=8" pluginspage="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" quality="high" src="topShow.swf">
<noscript>
    <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0" width="680" height="251">
    <param name="FlashVars" value="xmlfile=http://www.credencegasservices.com/slideshow-xml.php?showID=8" />
    <param name="movie" value="topShow.swf" />
    <param name="quality" value="high" />
    <embed src="topShow.swf" quality="high" pluginspage="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" width="680" height="251" FlashVars="xmlfile=http://www.credencegasservices.com/slideshow-xml.php?showID=8"></embed>
    </object>
</noscript> 
```

# android - 在 Maps V2 中使用自定义字体

> ID：15668430
> 
> 赞同：2
> 
> 时间：2013-03-27T20:09:00.617
> 
> 标签：android, textview, infowindow, android-maps-v2

我正在尝试使用[CommonsWare 的示例](https://stackoverflow.com/questions/14123243/google-maps-api-v2-custom-infowindow-like-in-original-android-google-maps?lq=1#comment19551415_14123243)
在 MapView 中自定义片段和标题的视图但是我无法自定义片段的**字体**。
![自定义片段 MapsV2](../Images/93543f5b17622c822d5185732745d109.png)
运气好的话？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-31T14:13:43.467

如果你从 CommonsWare 扩展了这个例子，你应该有一个 PopupAdapter 负责显示你的 InfoWindow。

我已经扩展了 PopupAdapter 以从我的资产文件夹中加载字体，并将其设置为标题和片段视图字体

```
class PopupAdapter implements InfoWindowAdapter {
    LayoutInflater inflater = null;

    // Context is most likely the map hosting activity. 
    // We need this so we get access to the Asset Manager
    Context context = null;

    PopupAdapter(LayoutInflater inflater, Context context) {
        this.inflater = inflater;
        this.context = context;
    }

    @Override
    public View getInfoWindow(Marker marker) {
        return (null);
    }

    @Override
    public View getInfoContents(Marker marker) {
        View popup = inflater.inflate(R.layout.popup, null);

        TextView tv = (TextView) popup.findViewById(R.id.title);

        tv.setText(marker.getTitle());

        // We load a typeface by using the static createFromAssets method
        // and provide the asset manager 
        // and a path to the file within the assets folder
        Typeface tf = Typeface.createFromAsset(context.getAssets(),
                "GoodDog.otf");
        // then set the TextViews typeface
        tv.setTypeface(tf);
        tv = (TextView) popup.findViewById(R.id.snippet);
        tv.setText(marker.getSnippet());
        tv.setTypeface(tf);

        return (popup);
    }
} 
```

# ios - iOS 中的 AutoHideSplashScreen 不会在具有非 index.html 页面的 Phonegap 2.5 中隐藏启动画面

> ID：15668434
> 
> 赞同：2
> 
> 时间：2013-03-27T20:09:14.627
> 
> 标签：ios, cordova

`navigator.splashscreen.hide()`由于事件未触发，我似乎无法让该功能在 iOS 上始终如一地工作`deviceready`，所以我试图自动隐藏启动画面。但即使`AutoHideSplashScreen`设置为`true`，我的启动画面也永远不会消失。外部 URL 之间是否存在奇怪的交互，并且启动画面不会消失？还是我缺少一些设置来设置屏幕显示时间的计时器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T13:23:30.143

尽管我的“设备就绪”事件正在触发，但我遇到了一个非常相似的问题。

在“Splashscreen”下的 PhoneGap 文档中，它的示例是：

```
<script type="text/javascript" charset="utf-8" src="cordova-x.x.x.js"></script>
<script type="text/javascript" charset="utf-8">

// Wait for Cordova to load
//
document.addEventListener("deviceready", onDeviceReady, false);

// Cordova is ready
//
function onDeviceReady() {
    navigator.splashscreen.hide();
}

</script> 
```

对我来说可悲的是，闪屏仍然出现。我想无论如何我都会为你提供这个，因为它可能适用于你的系统。我仍在寻找我的解决方案。

祝你好运

# javascript - 如何检查字符串末尾是否包含某些内容

> ID：15668435
> 
> 赞同：0
> 
> 时间：2013-03-27T20:09:18.090
> 
> 标签：javascript, regex

我正在写一些条件来完成不同的任务。例如，如果字符串等于案例 1，“/Livestock”，则打印“task one”。案例2，“/Livastock/”+最后的其他内容，然后打印“任务二”。否则，打印“任务三”。似乎我们使用 .test() 来检查正则表达式，但是如何将其放入 switch 语句中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:28:45.113

你没有清楚地描述你的问题。所以我假设你的字符串 ( `var str`) 在

```
case1: "task one", str=="Livestock"
case2: "task two", str starts with "Livestock" and there are something after it.
case3: "task three", not in above two cases 
```

那么你可以：

```
var flag=str=="Livestock"?1:str.search(/^Livestock/)==0?2:3; 
```

现在该标志具有`1, or 2 or 3`，以便您可以在您的 switch 语句中检查它。

如果我对您的问题理解错误，请发表评论，看看我是否可以解决答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:17:05.083

`$` denotes the end of a string (or the end of a line, if you use a specific switch in the RegEx).

```
var ends_w_livestock = /\/Livestock\/?$/,
    continues_after_livestock = /\/Livestock\/[^?#]+/; 
```

Now, the first one allows for testing of URLs which end with "/Livestock" or "/Livestock/".
The second one allows for testing of URLs which contain "/Livestock/" but have at least one more character afterward, that's not "?" or "#".

Then, you'd test each, using an if, or a ternary assignment, or whatever it is that you want to do.

# android - 单元格 id 大于 0xffff

> ID：15668440
> 
> 赞同：0
> 
> 时间：2013-03-27T20:09:41.137
> 
> 标签：android

我最近正在开发一个 android 项目，我需要获取 CELL Id 和 LAC（位置区号），并且我在我的设备中运行它我得到的值大于 CELL Id 的`0xffff`默认**最大值**

为什么会这样？3G和2G有区别吗？

这是我的代码

```
TextView msg = (TextView)findViewById(R.id.textView2);

final TelephonyManager telephony = (TelephonyManager)

getSystemService(Context.TELEPHONY_SERVICE);

    if (telephony.getPhoneType() == TelephonyManager.PHONE_TYPE_GSM) {
        final GsmCellLocation location = (GsmCellLocation) telephony.getCellLocation();
        if (location != null) {
            msg.setText("LAC: " + location.getLac() + " CID: " + location.getCid());
          }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-01-07T08:53:58.620

[这](https://stackoverflow.com/a/30421376/10095046)是答案。

[如ETSI TS 125 401](https://www.etsi.org/deliver/etsi_ts/125400_125499/125401/04.02.00_60/ts_125401v040200p.pdf)中所解释的，小区标识符 (C-Id) 用于唯一标识 RNS 内的小区。Cell-Id 与控制 RNC 的标识符 (CRNC-Id) 一起构成 UTRAN 小区标识 (UC-Id)，用于在 UTRAN 内唯一地标识小区。

`UC-Id = RNC-Id + C-Id`

C-Id由运营商定义，通过O&M设置在RNC中。C-Id 由其 C-RNC 在节点 B 中设置。

# django - django-storage 与 s3-boto 打破浏览器缓存

> ID：15668443
> 
> 赞同：7
> 
> 时间：2013-03-27T20:09:52.120
> 
> 标签：django, django-storage

我有一个 django 项目，它在 s3-boto 上使用 django-storage。

问题是位于 S3 上的每个文件都无法缓存，因为每次调用都会更改 url。

这是 django-storage 生成的两个调用：

```
https://my.s3.amazonaws.com/cache/user_6/profile_pic/profile_profile_picture_thumbnail.jpg?Signature=HlVSayUIJj6dMyk%2F4KBtFlz0uJs%3D&Expires=1364418058&AWSAccessKeyId=[awsaccesskey]     
https://my.s3.amazonaws.com/cache/user_6/profile_pic/profile_profile_picture_thumbnail.jpg?Signature=xh2VxKys0pkq7yHpbJmH000wkwg%3D&Expires=1364418110&AWSAccessKeyId=[awsaccesskey] 
```

如您所见，签名不同。我该怎么做才不会破坏我的浏览器缓存？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-29T20:06:59.377

在您的设置中，只需添加以下内容：

```
AWS_QUERYSTRING_AUTH = False 
```

这将确保在没有额外参数的情况下生成文件的 URL。您的网址如下所示：

```
https://my.s3.amazonaws.com/cache/user_6/profile_pic/profile_profile_picture_thumbnail.jpg 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-03-20T19:14:16.973

当`AWS_QUERYSTRING_AUTH = True`（这是默认值）时，django 会在我们*每次*获取 url时生成一个**临时url。**

 *## 如果您不想生成临时 url：

添加`AWS_QUERYSTRING_AUTH = False`到您的 settings.py

## 如果您仍然想要一个临时网址：

临时 url 将在`AWS_QUERYSTRING_EXPIRE`几秒钟内有效（默认为 3600）。所以**我们可以缓存这个临时 url**（只要我们不缓存它超过它的有效时间）。这样 - 我们可以为后续的页面请求返回相同的 url，允许客户端浏览器从它们的缓存中获取。

**设置.py**

```
# We subclass the default storage engine to add some caching
DEFAULT_FILE_STORAGE = 'project.storage.CachedS3Boto3Storage' 
```

**项目/存储.py**

```
import hashlib

from django.conf import settings
from django.core.cache import cache
from storages.backends.s3boto3 import S3Boto3Storage

class CachedS3Boto3Storage(S3Boto3Storage):
    """ adds caching for temporary urls """

    def url(self, name):
        # Add a prefix to avoid conflicts with any other apps
        key = hashlib.md5(f"CachedS3Boto3Storage_{name}".encode()).hexdigest()
        result = cache.get(key)
        if result:
            return result

        # No cached value exists, follow the usual logic
        result = super(CachedS3Boto3Storage, self).url(name)

        # Cache the result for 3/4 of the temp_url's lifetime.
        try:
            timeout = settings.AWS_QUERYSTRING_EXPIRE
        except:
            timeout = 3600
        timeout = int(timeout*.75)
        cache.set(key, result, timeout)

        return result 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-07-11T14:24:23.627

保护一些文件存储

您上传的大部分媒体（例如用户头像）都希望公开。但是，如果您有一些需要身份验证才能访问的媒体——比如只有会员可以访问的 PDF 简历——那么你不希望 S3BotoStorage 的默认 S3 ACL 公开阅读。这里我们不必子类化，因为我们可以传入一个实例而不是引用一个类。

所以首先删除设置中所有文件字段的保护并添加缓存控制

```
AWS_HEADERS = {
    'Cache-Control': 'max-age=86400',
}

# By default don't protect s3 urls and handle that in the model
AWS_QUERYSTRING_AUTH = False 
```

然后使您需要保护的文件字段使用您的自定义保护路径

```
from django.db import models
import storages.backends.s3boto

protected_storage = storages.backends.s3boto.S3BotoStorage(
  acl='private',
  querystring_auth=True,
  querystring_expire=600, # 10 minutes, try to ensure people won't/can't share
)

class Profile(models.Model):
  resume = models.FileField(
    null=True,
    blank=True,
    help_text='PDF resume accessible only to members',
    storage=protected_storage,
  ) 
```

但是当你在开发时你也需要使用你的普通存储，而且你通常使用本地存储，所以这就是我个人的做法

```
if settings.DEFAULT_FILE_STORAGE == 'django.core.files.storage.FileSystemStorage':
    protected_storage = FileSystemStorage()
    logger.debug('Using FileSystemStorage for resumes files')
else:
    protected_storage = S3BotoStorage(
        acl='private',
        querystring_auth=True,
        querystring_expire=86400,  # 24Hrs, expiration try to ensure people won't/can't share after 24Hrs
    )
    logger.debug('Using protected S3BotoStorage for resumes files') 
```

参考：[https ://tartarus.org/james/diary/2013/07/18/fun-with-django-storage-backends](https://tartarus.org/james/diary/2013/07/18/fun-with-django-storage-backends)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-27T20:27:10.170

您最好的选择是继承 Boto S3 存储后端并覆盖 url 方法。

### /project/root/storage.py

```
from django.conf import settings
from storages.backends.s3boto import S3BotoStorage

class S3Storage(S3BotoStorage):

    def url(self, name):
        name = self._clean_name(name)
        return '{0}{1}'.format(settings.MEDIA_URL, name) 
```

### /project/root/settings.py

```
MEDIA_URL = 'https://my.s3.amazonaws.com/'
DEFAULT_FILE_STORAGE = 'project.storage.S3Storage'
AWS_ACCESS_KEY_ID = '*******'
AWS_SECRET_ACCESS_KEY = '********'
AWS_STORAGE_BUCKET_NAME = 'your-bucket' 
```

只要确保您的图像是公开可读的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-30T02:28:36.263

如果您关心使用签名的 url 但仍想缓存它们直到它们过期，只需使用 django 的内置[缓存](https://docs.djangoproject.com/en/2.2/topics/cache/#the-low-level-cache-api)：

```
from django.core.cache import cache

class MyModel(models.Model):
    #using django-storages with AWS_QUERYSTRING_AUTH=True
    media = models.FileField()

    @property
    def url(self):
        """
        Return signed url, re-using cached value if not expired.
        """
        #Refresh url if within n seconds of expiry to give clients
        #time to retrieve content from bucket.
        #Make sure AWS_QUERYSTRING_EXPIRE is sufficiently larger than n
        n = 30
        time_to_expiry = settings.AWS_QUERYSTRING_EXPIRE - n

        #Create a unique key for this instance's url in the cache
        key = '{0}{1}'.format(self.__class__.__name__, self.pk)

        url = cache.get(key)
        if not url:
            url = self.media.url    #refresh url via django-storages
            cache.set(key, url, time_to_expiry)

        return url 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-03T11:00:08.407

在您的 settings.py 文件中添加这一行将启用图像文件的缓存。

```
AWS_S3_OBJECT_PARAMETERS = {
        'CacheControl': 'max-age=86400',
    } 
```*

# ruby - 使用页面对象查找字段集

> ID：15668447
> 
> 赞同：1
> 
> 时间：2013-03-27T20:10:00.940
> 
> 标签：ruby, watir, fieldset, pageobjects, page-object-gem

我试图找到一组复选框，但我需要在字段集中找到它们。html 是这样的（它是一个 gwt 应用程序，因此会生成大量内容：

```
<div id="UpdateUserView-RolesColumn">
  <fieldset style="">
    <legend>Primary Role</legend>
    <select class="gwt-ListBox">
      <option value="ROLE_GENERAL_USER">ROLE_GENERAL_USER</option>
      <option value="ROLE_ADMIN">ROLE_ADMIN</option>
    </select>
    </fieldset>
  <fieldset style="" class="createUser-otherRolesFieldset">
    <legend>Other Roles / Permissions</legend>
    <div style="overflow: auto; position: relative; zoom: 1; height: 250px;">
      <div style="position: relative; zoom: 1;">
        <div>
          <span class="gwt-CheckBox">
            <input type="checkbox" value="on" id="gwt-uid-760" tabindex="0" checked="">
            <label for="gwt-uid-760">ROLE_BLAH1_USER</label>
          </span>
          <span class="gwt-CheckBox">
            <input type="checkbox" value="on" id="gwt-uid-761" tabindex="0" checked="">
            <label for="gwt-uid-761">ROLE_BLAH2_USER</label>
          </span>
          <span class="gwt-CheckBox">
            <input type="checkbox" value="on" id="gwt-uid-762" tabindex="0" checked="">
            <label for="gwt-uid-762">ROLE_BLAH3_USER</label>
          </span>
          <span class="gwt-CheckBox">
            <input type="checkbox" value="on" id="gwt-uid-763" tabindex="0" checked="">
            <label for="gwt-uid-763">ROLE_BLAH4_USER</label>
          </span>
          <span class="gwt-CheckBox">
            <input type="checkbox" value="on" id="gwt-uid-764" tabindex="0" checked="">
            <label for="gwt-uid-764">ROLE_BLAH5_USER</label>
          </span>
        </div>
      </div>
    </div>
  </fieldset>
</div> 
```

我正在使用 Watir 和页面对象 gem。我正在尝试查找字段集，但没有字段集元素。从长远来看，我需要做的是找到每个复选框，获取它是否被选中的值，并将其与其名称一起存储在哈希中。

即使 page-object 有一个 fieldset 方法，我也不知道如何找到每个连续的复选框并获取值和标签。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T21:08:20.817

您可以使用通用[`element`](http://rubydoc.info/github/cheezy/page-object/master/PageObject/Accessors%3aelement)访问器方法声明一个字段集。对于您的字段集，它将是：

```
element(:other_roles, :fieldset, :class => 'createUser-otherRolesFieldset') 
```

要创建值的哈希，您必须创建一个迭代跨度并存储标签值和复选框值的方法。以下页面对象类具有执行此操作的方法：

```
class MyPage
    include PageObject

    element(:other_roles, :fieldset, :class => 'createUser-otherRolesFieldset')

    def other_role_values()
        other_roles = {}
        other_roles_element.span_elements.each do |span|
            other_roles[span.label_element.text] = span.checkbox_element.checked?
        end
        return other_roles
    end
end 
```

如您所见，该`other_role_values`方法将返回一个以名称（我假设您的意思是标签）和复选框值（真或假）为键的散列。

```
page = MyPage.new(browser)
p page.other_role_values
#=> {"ROLE_BLAH1_USER"=>true, "ROLE_BLAH2_USER"=>true, "ROLE_BLAH3_USER"=>true, "ROLE_BLAH4_USER"=>true, "ROLE_BLAH5_USER"=>true} 
```

**在旁边**

在回复 Chuck 的评论时，可以在没有页面对象 gem 的情况下类似地编写相同的内容。

在瓦提尔：

```
other_roles_element = browser.fieldset(:class => 'createUser-otherRolesFieldset')
other_roles = {}
other_roles_element.spans.each do |span|
  other_roles[span.label.text] = span.checkbox.checked?
end
p other_roles 
```

在 Selenium-Webdriver 中：

```
other_roles_element = browser.find_element(:css => 'fieldset.createUser-otherRolesFieldset')
other_roles = {}
other_roles_element.find_elements(:tag_name => 'span').each do |span|
  other_roles[span.find_element(:tag_name => 'label').text] = span.find_element(:tag_name => 'input').selected?
end
p other_roles 
```

# iphone - 当 UIButton 被拖动到屏幕的某个点时触发事件？目标 C

> ID：15668448
> 
> 赞同：0
> 
> 时间：2013-03-27T20:10:04.187
> 
> 标签：iphone, ios, objective-c, xcode, drag-and-drop

当可拖动按钮被拖动到屏幕上的某个点时，我将如何触发事件？

```
UIButton *btn1 = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[btn1 setFrame:CGRectMake(10.0f, 300.0f, 300.0f, 42.0f)];
[btn1 setTitle:[NSString stringWithFormat:@"View Fullscreen Decor"] forState:UIControlStateNormal];
[btn1 addTarget:self action:@selector(imageMoved:withEvent:) forControlEvents:UIControlEventTouchDragInside];
[self.view addSubview:btn1];
[super viewDidLoad];
[myScrollView addSubview:btn1];

- (IBAction) imageMoved:(id) sender withEvent:(UIEvent *) event
{
CGPoint point = [[[event allTouches] anyObject] locationInView:self.view];
UIControl *control = sender;
control.center = point;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:23:11.397

```
- (IBAction) imageMoved:(id) sender withEvent:(UIEvent *) event{

  CGPoint touchPoint = [[[event allTouches] anyObject] locationInView:self.view];
  UIControl *control = sender;
  control.center = touchPoint;

  CGRect rectToCompare =  location you want on your super view;

   if (CGRectContainsPoint(rectToCompare, touchPoint)) {

         //trigger an event.         
   }
} 
```

# debugging - 需要帮助调试打印语句（矩阵）：

> ID：15668450
> 
> 赞同：1
> 
> 时间：2013-03-27T20:10:08.373
> 
> 标签：debugging, matrix

所以我有我正在研究的这个程序。这是到目前为止的代码：

```
A = [[2,4], [7,0], [6,3]]
B = [[3,1], [-1,8], [-3, 3]]

def Print(A):
    for i in range(len(A)):
        line = "\t|"+str(A[i][0])
        for j in range(1, len(A[i])):
            line = line + "\t" + str(A[i][j])
        line = line + "|"
        print(line)

def matrix_add(A,B):
    Z = []
    for i in range(len(A)):
        row = []
        for j in range(len(A[0])):
            row.append(A[i][j]+B[i][j])
        Z.append(row)
    return Z

print("A + B:")
Print(matrix_add(A,B)) 
```

我得到的打印声明是这样的：

```
A + B:
        |5    5|
        |6    8|
        |3    6| 
```

但我需要的打印语句是：

```
A + B:
     |5      5|
     |6      8|
     |3      6| 
```

看看矩阵如何更接近 A+B：我将如何修复我的程序来做到这一点？我想不通。

我尝试在其中添加空格，`line = "\t|"+str(A[i][0])`因此它更改为，`line = " |"+str(A[i][0])`但这只是将打印语句更改为：

```
A + B:
    |5   5|
    |6   8|
    |3   6| 
```

我需要它看起来完全一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:21:02.310

在这里的第一行：

行 = "\t|"+str(A[i][0])

您需要将制表符 (\t) 更改为不会将其移到远处的内容。也许几个空格？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:38:40.183

您可以使用 Python 提供的许多字符串格式化选项。

[http://docs.python.org/2/library/string.html#format-specification-mini-language](http://docs.python.org/2/library/string.html#format-specification-mini-language)

```
def Print(A):
    for i in range(len(A)):
        line = "{0: >6}".format("|"+str(A[i][0]))
        for j in range(1, len(A[i])):
            line = line + "{0: >4}".format(str(A[i][j]))
        line = line + "|"
        print(line) 
```

如果输入更大的数字，例如`10`，缩进会减一。您可以确定要格式化的字符串的长度，并使用该长度使其更加通用。

# javascript - Javascript如何从字符串创建键：值

> ID：15668452
> 
> 赞同：0
> 
> 时间：2013-03-27T20:10:16.173
> 
> 标签：javascript, json, string, hashtable

我有一个键形式的字符串数组：由“ :: ”分隔的值，值可以有多行。我想知道如何创建将键与特定字符串匹配的哈希表并映射值并从中构建 JSON 文件？抱歉，如果它已经得到回答，但我整天都在搜索，但找不到实现这一目标的方法。谢谢，滴滴

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:16:01.550

I din't really get what you want exactly. But from what I understood, this should be what you want. Could you provide some snippets ?

```
var myObject = {
pro1 : "value1",
prop2: "value2"
}
JSON.stringify(myObject);  // outputs the object as json 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:17:44.533

Something like

```
var stringsArray=['key1::value1','key2::value2','key3::value3'.....]
var hashObj={};

for(var i=0; i<stringsArray.length; i++){
    var kv=stringsArray[i].split('::')
    hashObj[kv[0]]=kv[1];
}

alert(hashObj.key1) 
```

This will only work for unique key values

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:20:12.270

例如字符串 = ["a::1", "b::2", "c::3"]。你能做的是。

```
let output = {};
for (let i = 0; i < strings.length; ++i)
{
    let key = strings[i].split("::")[0];
    let value = strings[i].split("::")[1];
    output[key] = value;
} 
```

# xcode - 归档应用程序之前在代码签名中选择哪个配置文件？

> ID：15668453
> 
> 赞同：0
> 
> 时间：2013-03-27T20:10:16.240
> 
> 标签：xcode, code-signing, provisioning

我阅读了有关如何将应用程序提交到应用程序商店的 App Store 提交教程。一切都很顺利，直到我进入代码签名阶段。在教程中说：

```
From the Code Signing Identity pop-up menu, in the distribution provisioning profile section, choose the certificate that begins with “iPhone Distribution:” followed by your name. 
```

在我的 Xcode 版本（最新版本）中，我有以下内容：

![在此处输入图像描述](../Images/6ba4234d7805f275da8e80be76261b26.png)

我在弹出菜单中找不到“分发配置文件部分”。对选择什么有帮助？

注意：我编辑了图片以删除我的名字和东西..所以空格被填充了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:22:20.437

您是否为此应用创建了应用 ID？

从屏幕截图看来，您拥有 *（通配符）和一个名为 Simple Text Editor 的应用程序 ID。如果应用程序不是简单文本编辑器，则为您的应用程序创建应用程序 ID，然后为该应用程序 ID 创建配置文件。完成后，自动配置文件选择器将启动，因为它将应用程序 ID 与应用程序设置（plist 文件）匹配。

# python - 从 X、Y、Z 坐标数据创建 3D 表面网格

> ID：15668454
> 
> 赞同：2
> 
> 时间：2013-03-27T20:10:16.720
> 
> 标签：python, matplotlib

我在 .dat 文件中有一个非常大的 X、Y、Z 坐标数据数据集（约 500 万行）。我可以将其导入为 3D 散点图，但想在点之间的 3D 表面网格处进行插值。我已经查看了一些示例，包括[this](https://stackoverflow.com/questions/4363857/matplotlib-color-in-3d-plotting-from-an-x-y-z-data-set-without-using-contour)，但是如果没有出现 Invalid Index 错误，它就无法正常工作。

这是我所拥有的：

```
from pylab import *
import numpy as np
from mpl_toolkits.mplot3d import Axes3D
from matplotlib import cm
import matplotlib.pyplot as plt
from matplotlib.mlab import griddata

x, y, z = loadtxt('test.dat', unpack = True)

fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')

xs = x
ys = y
zs = z

fig = plt.figure()
ax = fig.gca(projection='3d')

xi = np.linspace(min(xs), max(xs))
yi = np.linspace(min(ys), max(ys))

X, Y = np.meshgrid(xi, yi)
Z = griddata(xs, ys, zs, xi, yi)

surf = ax.plot_surface(X, Y, Z, rstride=5, cstride=5, cmap=cm.jet,
                       linewidth=1, antialiased=True)

ax.set_zlim3d(np.min(Z), np.max(Z))
fig.colorbar(surf)

plt.show() 
```

这是我得到的错误：

```
python test2.py
Traceback (most recent call last):
  File "test2.py", line 25, in <module>
    Z = griddata(xs, ys, zs, xi, yi)
  File "/Library/Frameworks/Python.framework/Versions/7.3/lib/python2.7/site-packages/matplotlib/mlab.py", line 2768, in griddata
    tri = delaunay.Triangulation(x,y)
  File "/Library/Frameworks/Python.framework/Versions/7.3/lib/python2.7/site-packages/matplotlib/delaunay/triangulate.py", line 90, in __init__
    self.hull = self._compute_convex_hull()
  File "/Library/Frameworks/Python.framework/Versions/7.3/lib/python2.7/site-packages/matplotlib/delaunay/triangulate.py", line 115, in _compute_convex_hull
    edges.update(dict(zip(self.triangle_nodes[border[:,0]][:,1],
IndexError: invalid index 
```

我对python很陌生，无法弄清楚。有任何想法吗？谢谢！

这是我用作测试的数据集的一部分：

```
x = [-0.91392505 -0.89382458 -0.87372404 -0.85362357 -0.83352304 -0.81342256
 -0.79332203 -0.77322155 -0.75312102 -0.73302054 -0.71292001 -0.69281954
 -0.672719   -0.65261853 -0.63251805 -0.61241752 -0.59231698 -0.57221651
 -0.55211604 -0.5320155 ]
y = [ 111.25222  111.25222  111.25222  111.25222  111.25222  111.25222
  111.25222  111.25222  111.25222  111.25222  111.25222  111.25222
  111.25222  111.25222  111.25222  111.25222  111.25222  111.25222
  111.25222  111.25222]
z = [  1.42150589e-06   7.77236906e-08   3.33243515e-05   1.70491203e-05
   6.01433214e-08   9.20339880e-06   4.21266122e-06   3.39080143e-04
   1.37568408e-04   7.34613104e-06   1.07246015e-05   3.39363214e-06
   1.09533859e-04   6.55860058e-05   2.83635192e-04   1.87549119e-06
   9.96281233e-06   2.78222607e-04   2.88286283e-05   4.60408737e-05] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T14:12:42.183

很确定问题是您调用`griddata`错误（[文档](http://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html)）。尝试：

```
Z = scipy.interpolate.griddata((xs, ys), zs, X, Y) 
```

# ruby - 使用 Ruby 测量 HTTP 请求的响应时间

> ID：15668455
> 
> 赞同：12
> 
> 时间：2013-03-27T20:10:17.600
> 
> 标签：ruby, net-http

我正在建立一个供个人使用的小型网站来测试我公司制作的 API。我的老板想要一个网站，我们可以在其中进入网站，使用 GET 或 POST 请求表单，以及发送请求的次数。他希望记录请求、每个请求的时间以及所有请求的平均时间。

有没有办法使用 Ruby 测量 GET 或 POST 请求的响应时间？

我查看了 Net::HTTP 库，但没有看到任何返回所用时间的内容。

是否有任何网站已经这样做了？他们需要有一个 GUI，以便非技术人员可以使用它。如果没有，我打算有一个简单的表单来运行脚本，将该脚本的输出写入文本文件或电子表格，然后将其发送给用户。

还有其他建议吗？（一个漂亮的 AJAX 界面可能工作得很好，但可能需要数据库存储。每次运行 10000 个请求时，这可能会变得很庞大。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-28T07:23:36.690

正如评论中提到的，ruby 有一个[基准模块](http://ruby-doc.org/stdlib-2.0/libdoc/benchmark/rdoc/index.html)

```
require "benchmark"

time = Benchmark.measure do
  #requests
end 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-28T00:09:01.627

Net::HTTP 不跟踪响应时间，因为这不是它的工作。

在您的请求之前和之后使用`Time.now`设置开始和结束时间：

```
start_time = Time.now
# ...do request...
elapsed_time = Time.now - start_time 
```

如果您想取平均值，请将这些`elapsed_time`值相加并除以测试次数：

```
total_time += elapsed_time
# ... do some stuff...
average_time = total_time / num_of_iterations 
```

时间可以精确到微秒，这对于您的需求应该是足够准确的。

界面由您自己决定，因为这是一个完全不同的主题，将构成一本书。

# c# - 'System.Net.Http.ObjectContent ' 不包含带 2 个参数的构造函数

> ID：15668458
> 
> 赞同：0
> 
> 时间：2013-03-27T20:10:26.343
> 
> 标签：c#, asp.net-mvc, compiler-errors, asp.net-web-api

```
var cnt = new ObjectContent<int>(1, new JsonMediaTypeFormatter()); 
```

上面的行给出了下面的编译器错误

*'System.Net.Http.ObjectContent' 不包含带有 2 个参数的构造函数*

如何解决这个问题？

UPD： http: [//msdn.microsoft.com/en-us/library/hh944687](http://msdn.microsoft.com/en-us/library/hh944687(v=vs.108).aspx) (v=vs.108).aspx有 2、3 和 3 个参数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:53:34.843

您使用的是哪个版本的 Web API？如果您使用的是 Beta 版本，可能是因为构造函数是内部的

基本上，在其中一个预发布版本中，ObjectContent 构造函数是内部的，这意味着您必须使用以下代码：

```
HttpRequestMessage<T> request = new HttpRequestMessage<T>();  
ObjectContent<T> content = request.CreateContent<T>(operationInput, 
new MediaTypeHeaderValue(Constants.ContentTypeXml), 
new MediaTypeFormatterCollection() { new XmlMediaTypeFormatter() }, new FormatterSelector()); 
```

请参阅以下链接

[http://blog.sacaluta.com/2012/02/aspnet-web-api-objectcontent.html](http://blog.sacaluta.com/2012/02/aspnet-web-api-objectcontent.html)

# objective-c - 为 NSString 添加双引号

> ID：15668459
> 
> 赞同：7
> 
> 时间：2013-03-27T20:10:32.093
> 
> 标签：objective-c, nsstring, formatting

我已经阅读了所有内容，但 \" 不起作用。

我正在尝试创建一个如下所示的字符串：

"SomeString" = "另一个字符串"

这是我必须插入双引号的代码：

```
NSString *newOutput = [NSString stringWithFormat:@"%@ \" = \" %@", output, [englishDic objectForKey:str]]; 
```

它输出的只是：

```
"RateThisAppDontAsk \" = \" Don't ask again" 
```

我想也许是“=”引起了问题，但删除仍然给了我这样的输出：

```
"RateThisAppDontAsk \"  \" Don't ask again" 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-27T20:16:38.903

在一个小的 MacOS X 命令行测试程序中为我工作。这是所有代码：

```
#import <Foundation/Foundation.h>

int main(int argc, const char * argv[])
{
    @autoreleasepool {
        NSString *newOutput = [NSString stringWithFormat:@"%@ \" = \" %@", @"foo", @"bar"];
        NSLog(newOutput);
    }
    return 0;
} 
```

输出是：

```
test[54844:403] foo " = " bar 
```

如果你想在*foo*和*bar*之前加上引号，请添加：

```
NSString *newOutput = [NSString stringWithFormat:@"\"%@\" = \"%@\"", @"foo", @"bar"]; 
```

新输出是：

```
test[54873:403] "foo" = "bar" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-27T20:18:15.347

```
 NSString *output = @"RateThisAppDontAsk";
 NSString *nextString = @"Don't ask again";

 NSString *newOutput = [NSString stringWithFormat:@"\"%@\" = \"%@\"", output, nextString];
 NSLog(@"%@",newOutput); 
```

**输出**

```
"RateThisAppDontAsk" = "Don't ask again" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:17:25.007

这是你需要做的

```
NSString *firstObject = @"RateThisAppDontAsk";
NSString *secondObject = @"Don't ask again";
NSString *newOutput = [NSString stringWithFormat:@"\"%@\" = \"%@\"",firstObject,secondObject]; 
```

输出

```
test[4556:c07] "RateThisAppDontAsk" = "Don't ask again" 
```

# php - 访问令牌设置期间的 401

> ID：15668461
> 
> 赞同：1
> 
> 时间：2013-03-27T20:10:41.910
> 
> 标签：php, oauth, soundcloud

在过去一天左右的时间里，我一直试图让这个工作，但没有任何运气。我终于将代码简化到最低限度，似乎找不到解决方案。

$callbackURL 设置为同一页面，因此它会回调此页面并在 Soundcloud 确认步骤后成功返回。

```
<?php
require_once ("inc/Soundcloud.php");

$client_id = 'CLIENT_ID';
$secret = 'SECRET_KEY';
$callbackURL = "CALL_BACK_URL";

if (!isset($_GET['code'])) {
    $client = new Services_Soundcloud($client_id, $secret, $callbackURL );
    $client -> setCurlOptions(array(CURLOPT_FOLLOWLOCATION => 1, CURLOPT_CAINFO => $_SERVER['DOCUMENT_ROOT'] . '\\audio\\lib\\inc\\cacert.pem'));

    if (!isset($accessToken)) {
        $authorizeUrl = $client -> getAuthorizeUrl(array('scope' => 'non-expiring'));
        echo "<a href='$authorizeUrl'>Connect</a>";
    }

} else {

    $client = new Services_Soundcloud($client_id, $secret, $callbackURL );
    $client -> setCurlOptions(array(CURLOPT_FOLLOWLOCATION => 1, CURLOPT_CAINFO => $_SERVER['DOCUMENT_ROOT'] . '\\audio\\lib\\inc\\cacert.pem'));
    $accessToken = $client -> accessToken($_GET['code']);
    echo "Token: $accessToken";
    $client -> setAccessToken($accessToken["access_token"]);
}
?> 
```

错误：

```
[27-Mar-2013 16:02:59 America/New_York] PHP Fatal error:  Uncaught exception 'Services_Soundcloud_Invalid_Http_Response_Code_Exception' with message 'The requested URL responded with HTTP code 401.' in D:\web\audio\lib\inc\Soundcloud.php:941
Stack trace:
#0 D:\web\audio\lib\inc\Soundcloud.php(817): Services_Soundcloud->_request('https://api.sou...', Array)
#1 D:\web\audio\lib\inc\Soundcloud.php(332): Services_Soundcloud->_getAccessToken(Array, Array)
#2 D:\web\audio\lib\auth.php(20): Services_Soundcloud->accessToken('...')
#3 {main}
  thrown in D:\web\audio\lib\inc\Soundcloud.php on line 941 
```

问题是我在 $client->accessToken($_GET['code']) 步骤中不断收到 401 错误，尽管 $_GET['code'] 设置正确。如果我删除 CURLOPT_CAINFO，我会收到“响应代码 0”问题，但我已经解决了这个问题。

任何帮助是极大的赞赏。

带有 PHP 5.4 的 IIS

编辑：问题已通过 CURL 的 PEM 文件的绝对路径解决。当我们尝试使用相对路径而不是绝对路径时，这在我们的测试设置中不一致。在详细运行 CURL 后，我得出了结论。此外，Soundcloud 遇到的问题使得调试这个问题变得困难。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:41:17.587

上面的代码在发布这个问题后开始间歇性地工作，问题似乎出在 Soundcloud 的服务器上或发生了一些奇怪的事情。不确定它是如何修复的，但是通过 0 个代码更改，刷新返回了一个令牌。再次尝试给了我一个 401。不确定原因，但上面的代码应该给你你的令牌（最终）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:50:10.550

使用 SDK 时不需要的设置 curl 选项。

这里还有一些更多的文档。

[https://github.com/mptre/php-soundcloud](https://github.com/mptre/php-soundcloud)

# zeromq - 我可以通过 0mq（zeromq）ipc 套接字传递文件描述符吗？

> ID：15668462
> 
> 赞同：2
> 
> 时间：2013-03-27T20:10:49.837
> 
> 标签：zeromq, file-descriptor, unix-socket

我有一个主进程和几个工作人员，使用 0mq 'ipc://' 套接字（UNIX 域套接字）进行通信。我想将文件描述符从主服务器传递给工作人员，以及一条消息。我知道“原始” UNIX 域套接字可用于将文件描述符从一个进程传递到另一个进程，但我可以使用我的 zeromq 套接字吗？

我不关心可移植性，坦率地说，我不关心它是否是一个有点脏的解决方案。有什么办法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T23:54:41.950

Hackiest 方法是添加一个套接字选项以将文件描述符绑定到套接字，然后将 & 替换为`send()`所需`recv()`的结构，以传递描述符。`sendmsg()``recvmsg()``CMSG`

作为一个全局选项，每条消息都将使用描述符进行标记，因此您应该在有效负载中添加合适的元数据，以指示接收者应该采用随附的描述符。

例如发送端

```
zmq_setsockopt (s, ZMQ_ANCILLIARYFD, &fd, sizeof (fd)); 
```

例如recv端

```
int incoming_fd;
size_t fd_len = sizeof (incoming_fd);
zmq_getsockopt (s, ZMQ_ANCILLIARYFD, &incoming_fd, &fd_len); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-27T21:43:03.257

我很确定答案是否定的。文件描述符是一个整数，它在调用 open() 的进程的上下文中表示某些东西。在另一个过程的上下文中，它是没有意义的。通过任何方法将该整数传递给另一个进程并不意味着该目标进程可以在调用 read() 时使用它。

文件描述符，FILE* 类型的指针，任何类似的东西都在引用几乎总是被认为是不透明的对象。它的不透明性意味着你不能复制它并期望它工作，这实际上是你试图通过管道、套接字、0mq 等发送它来做的事情。

在一个进程中，引用可以被复制（例如，由另一个线程使用）。

目标进程当然可以自己打开文件；它所需要的只是文件名。

# java - Java 中的 ClassCastException 错误 Object[] 到 String[]

> ID：15668464
> 
> 赞同：3
> 
> 时间：2013-03-27T20:10:50.157
> 
> 标签：java, classcastexception

我得到错误：

```
Exception in thread "main" java.lang.ClassCastException: [Ljava.lang.Object; cannot be cast to [Ljava.lang.String;
at Book.Organizer.Desk.RubCol.BookMainKeeper.main(BookMainKeeper.java:25) 
```

我不知道如何解决这个问题。谁能告诉我我做错了什么来帮助我？

主要（BookMainKeeper 类）：

```
public class BookMainKeeper {

/**
 * @param args
 */
public static void main(String[] args) {

    BagInterface<String> shelf1 = new pileBooks<String>();
    BagInterface<String> shelf2 = new pileBooks<String>();
    BagInterface<String> shelf3 = new pileBooks<String>();

    shelf1.add("Java 3rd Edition");
    shelf1.add("Pre-Calculus 2nd Edition");
    shelf1.add("Lava World");

    String[] check = shelf2.toArray();

    System.out.println(shelf2.toArray());

}} 
```

使用 BagInterface 的 pileBooks 类：

```
public class pileBooks<T> implements BagInterface<T> {

private final T[] bag; 
private static final int DEFAULT_CAPACITY = 25;
private int numberOfEntries;

/** Creates an empty bag whose initial capacity is 25\. */
public pileBooks() 
{
    this(DEFAULT_CAPACITY);
} // end default constructor

/** Creates an empty bag having a given initial capacity.
@param capacity  the integer capacity desired */
public pileBooks(int capacity) 
{
    numberOfEntries = 0;
    // the cast is safe because the new array contains null entries
    @SuppressWarnings("unchecked")
    T[] tempBag = (T[])new Object[capacity]; // unchecked cast
    bag = tempBag;
} // end constructor

/**gets the current size of the bag
 * @return numberOfEntries
 */
public int getCurrentSize() {
    return numberOfEntries;
}

/** Sees whether this bag is full.
   @return true if this bag is full, or false if not */
public boolean isFull() 
{
    return numberOfEntries == bag.length;
} // end isFull

/**It checks if the bag is empty or not
 * @return True if numberOfEntries equals 0, False if otherwise
 */
public boolean isEmpty() {
    return numberOfEntries == 0;
}

/** Adds a new entry to this bag.
@param newEntry  the object to be added as a new entry
@return true if the addition is successful, or false if not */
public boolean add(T newEntry) 
{
    boolean result = true;
    if(isFull())
    {
        result = false;
    }
    else
    {
        bag[numberOfEntries]= newEntry;
        numberOfEntries++;
    }
    return result;
} // end add

/** Removes one unspecified entry from this bag, if possible.
   @return either the removed entry, if the removal
           was successful, or null */
    public T remove()
    {
        T result = null;
        if(numberOfEntries>0)
        {
            result = bag[numberOfEntries-1];
            bag[numberOfEntries - 1]=null;
            numberOfEntries--;
        }
        return result;
    } // end remove

/** Removes one occurrence of a given entry from this bag.
   @param anEntry  the entry to be removed
   @return true if the removal was successful, or false otherwise */
public boolean remove(T anEntry) 
{
    int index = getIndexOf(anEntry);
    T result = removeEntry(index);
    return anEntry.equals(result);
} // end remove

/**
 * Removes entry by verifying it's index
 * @param index = variable to check, if it is -1, the entry was not found
 * and it will exit, if it is 0 or higher, it means it was found in the bag
 * @return if index is -1, it returns result as null
 * if index is 0 or higher, it will put bag[index] in the variable result
 * and returns result
 */
protected T removeEntry(int index) {
    T result = null;
    int check = numberOfEntries;
    if(index != -1)
    {

        while((index < numberOfEntries) && ((check-1) != numberOfEntries)){

            if(index == (numberOfEntries-1))
            {
                result = bag[numberOfEntries-1];
                bag[numberOfEntries-1] = null;
                numberOfEntries--;
                break;
            }
            else
            {
                result = bag[index];
                bag[index] = bag [numberOfEntries-1];
                bag[numberOfEntries-1] = null;
                numberOfEntries--;
                break;
            }
        }
    }
    return result;
}

/**
 * verfifies if anEntry is inside the bag, if it is found, it assigns
 * i to the variable index
 * @param anEntry = object to search for inside the bag
 * @return index, -1 if anEntry was not found
 * whatever is contained in variable 'i' if it is found
 */
private int getIndexOf(T anEntry) {
    int index=-1;
    for(int i=0;i<bag.length;i++)
    {
        if(anEntry.equals(bag[i]))
        {
            index = i;
            break;
        }
    }
    return index;
}

/** Removes all entries from this bag. */
public void clear() 
{
    while(!isEmpty())
        remove();
} // end clear

/** Counts the number of times a given entry appears in this bag.
 @param anEntry  the entry to be counted
 @return the number of times anEntry appears in the bag */
public int getFrequencyOf(T anEntry) 
{
    int counter = 0;
    for(int index = 0; index < numberOfEntries; index++)
    {
        if (anEntry.equals(bag[index]))
        {
            counter++;
        }
    }
    return counter;
} // end getFrequencyOf

/** Tests whether this bag contains a given entry.
 @param anEntry  the entry to locate
 @return true if this bag contains anEntry, or false otherwise */
public boolean contains(T anEntry) 
{
    boolean found = false;
    for(int index = 0; !found && (index<numberOfEntries); index++)
    {
        if(anEntry.equals(bag[index]))
        {
            found = true;
        }
    }
    return found;
} // end contains

/** Retrieves all entries that are in this bag.
 @return a newly allocated array of all the entries in the bag */
public T[] toArray()
{
    //the cast is safe because the new array Contains null entries
    @SuppressWarnings("unchecked")
    T[] result = (T[])new Object[numberOfEntries];//unchecked cast
    for(int index=0;index < numberOfEntries; index++)
    {
        result[index]=bag[index];
    }
    return result;

} // end toArray
} 
```

pileBooks 类中使用的 BagInterface ：

```
 //An interface that describes the operations of a bag of objects.
 public interface BagInterface<T> {

 /** Gets the current number of entries in this bag.
 @return the integer number of entries currently in the bag */
 public int getCurrentSize();

 /** Sees whether this bag is full.
 @return true if the bag is full, or false if not */
 public boolean isFull();

 /** Sees whether this bag is empty.
 @return true if the bag is empty, or false if not */
 public boolean isEmpty();

 /** Adds a new entry to this bag.
 @param newEntry the object to be added as a new entry
 @ return true if the addition was successful, or false if not */
 public boolean add(T newEntry);

 /** Removes one unspecified entry from this bag, if possible.
 @return either the removed entry, if the removal was successful, or null */
 public T remove();

 /** Removes one occurrence of a given entry from this bag, if possible.
 @param anEntry the entry to be removed
 @return true if the removal was successful, or false if not */
 public boolean remove(T anEntry);

 /** Removes all entries from this bag. */
 public void clear();

 /** Counts the number of times a given entry appears in this bag.
 @param anEntry the entry to be counted
 @return the number of times anEntry appears in the bag */
 public int getFrequencyOf(T anEntry);

 /** Test whether this bag contains a given entry.
 @param anEntry the entry to locate
 @return true if the bag contains anEntry, or false otherwise */
 public boolean contains(T anEntry);

 /** Creates an array of all the entries that are in this bag.
 @return a newly allocated array of all entries in the bag */
 public T[] toArray();

 }// end BagInterface 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:32:19.017

你不能像你不能投射`Object[]`到一样投射到。您可能需要返回 T 类型的实数数组。`String[]``Object``String`

这该怎么做？一种方法是将数组类型添加为`toArray`like的参数

```
public T[] toArray(Class<T> clazz) {
    // the cast is safe because the new array Contains null entries
    @SuppressWarnings("unchecked")
    T[] result = (T[]) java.lang.reflect.Array.newInstance(clazz, numberOfEntries); 
```

或者，如果您确定数组将只包含类型的对象`T`而不包含它的子类型，例如`T1`，`T2`您可以通过从存储的元素之一中读取它来获取数组的类型，例如

```
T[] result = (T[]) java.lang.reflect.Array.newInstance(
        bag[0].getClass(), numberOfEntries); 
```

但我会说第一种方法更好，因为它可以让您创建所需类型的数组，并消除您将创建某种类型的数组`T1`而不是`T`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T15:26:08.887

您应该将其保存到 Object 数组中，而不是 String 数组中：

```
Object[] check = shelf1.toArray();

System.out.println(check[1].toString());
System.out.println(check[2].toString());
System.out.println(check[3].toString()); 
```

印刷：

```
Java 3rd Edition
Pre-Calculus 2nd Edition
Lava World 
```

`check`是一个对象数组。该类`Object`是所有类的父类，包括`String`. 它在运行时检查，这就是您的代码编译但在执行期间出错的原因。

# php - 为插入的每一行插入数字 +1

> ID：15668469
> 
> 赞同：0
> 
> 时间：2013-03-27T20:10:59.990
> 
> 标签：php, mysql

我有这个 php 脚本：

```
for ($i = 0, $count = count($ingredientQTY); $i < $count; $i++) {
            $yo = 1;
            $rows[] = array(
                'ingredientamount'         => $ingredientQTY[$i],
                'ingredientType' =>  $measurements[$i],
                'ingredientname'        => $ingredientNAME[$i],
                'recipe_id' => $recipe_id
            );
            $sql = "INSERT `ingredients` (`ingredientamount`,`ingredientType`,`ingredientname`, `recipe_id`) VALUES ";
            $coma = '';
            foreach ($rows as $oneRow) {
                $sql .= $coma."('".implode("','",$oneRow)."')";
                $coma = ', ';
            }
            $this->db->query($sql);
      }

      break;
} 
```

它将一行（包含成分数量、成分类型和成分名称）插入到成分表中。我还有一个**order**列，它应该从 1 开始，并且对于插入的每一行，将 1 添加到**order**。如何使用我当前的代码执行此操作？我想也许我必须有一个我传入的隐藏字段，但是有没有办法用 PHP 做到这一点？

感谢所有帮助，如果我描述的方式有任何令人困惑的地方，请询问！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:25:54.987

您已经有一个`$i`循环计数器，只需插入`$i + 1`该字段的值即可。

# search - Wordpress 插件自定义搜索

> ID：15668470
> 
> 赞同：0
> 
> 时间：2013-03-27T20:11:08.143
> 
> 标签：search, wordpress

我正在尝试修改 Wordpress 插件。基本上，该插件会显示职位空缺。该插件具有搜索功能，您可以通过关键字、工作行业和薪水进行搜索。功能是：

```
// SEARCH FUNCTION
function bb_search_jobs($job_keyword=null,$job_industry=null,$job_salary=null) {

    global $wpdb;
    $table_name = $wpdb->prefix;        

    $query      = 'SELECT * FROM ' . $table_name . 'bb_jobs ' 
                . 'WHERE CURDATE() < DATE_ADD(date_time, INTERVAL days_to_advertise DAY) ';

    if($job_keyword != 'null') {
        if(strlen ( $job_keyword ) > 4 ){
            $query .= 'AND MATCH (job_title,job_skills,job_description) AGAINST ("' . esc_sql($job_keyword) . '") ';
        } else {
            $query .= 'AND job_title LIKE "%' . esc_sql($job_keyword) . '%" ';          
        }
    }

    if($job_industry && $job_industry != 'null' ){
        $query .= 'AND job_industry LIKE "%' . esc_sql($job_industry) . '%" ';
    }

    if($job_salary && $job_salary != 'null' ){

        $job_salary = format_salary($job_salary);
        $query .= 'AND salary_from <= "' . esc_sql($job_salary) . '" ';
        $query .= 'AND salary_to >= "' . esc_sql($job_salary) . '" ';
    }

//      var_dump ( $query );

    $myrows = $wpdb->get_results($query);

    return $myrows;

} 
```

这个搜索功能有效，但我的问题是，如果用户没有在“关键字”输入中输入任何内容，那么无论他们选择行业还是薪水，搜索都会返回所有结果。我想修改这个功能，这样用户就不必添加关键字，如果他们不想，他们可以通过特定行业或薪水进行搜索，结果将显示来自该行业或具有该薪水的工作.

返回的 URL 以 ?job_keyword=&job_industry=null 结尾我注意到，如果我在 job_keyword= 之后手动放置一个“+”，那么搜索就会起作用。那么，我该如何修改函数，以便如果客户没有在关键字输入中输入任何内容，那么 URL 将显示 ?job_keyword=+&job_industry=null 而不是 ?job_keyword=&job_industry=null

[您可以在http://www.bettondesignwork.co.uk/castlewp/job-search/](http://www.bettondesignwork.co.uk/castlewp/job-search/)上查看该网站以及该插件

与以往一样，我们非常感谢任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:32:43.600

你有两个选择：

1.  在将结果提交给您的函数之前，您检查一个空字段（[示例](https://stackoverflow.com/questions/381265/better-way-to-check-variable-for-null-or-empty-string)）。如果该字段为空，只需将其更改为“+”，然后再将其提交给函数。
2.  通过 JS，在提交表单之前检查表单字段。[例子](https://stackoverflow.com/questions/4158383/disallow-search-on-empty-form-field)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T08:50:05.517

感谢您为我查看此功能，但问题出在插件其他地方的错误上。我现在已经修复了这个错误，这个功能可以正常工作。

# php - /tmp 未满，但 session_write_close() 给出“写入失败：设备上没有剩余空间”

> ID：15668472
> 
> 赞同：0
> 
> 时间：2013-03-27T20:11:14.037
> 
> 标签：php, session, phpmyadmin, freebsd

phpMyAdmin 给出“警告：session_write_close() [function.session-write-close]：写入失败：设备上没有剩余空间”，但 /tmp 似乎没有满。

操作系统是 FreeBSD 8.0（是的，它很旧）。

```
$ df -h /tmp
Filesystem     Size    Used   Avail Capacity  Mounted on
/dev/ad4s1e    989M     53M    857M     6%    /tmp 
```

我的下一步应该是什么？

# c# - 在 C# 中将 Excel 所有列作为字符串读取

> ID：15668482
> 
> 赞同：2
> 
> 时间：2013-03-27T20:12:09.270
> 
> 标签：c#, string, excel, type-conversion

我正在尝试将 Excel 列作为 C# 中的字符串读取。我写了以下代码：

```
 string connectionString = "Provider=Microsoft.Jet.OLEDB.4.0;" + "Data Source=c:\\excelFile.xls;"
                                + "Extended Properties=\"Excel 8.0;IMEX=1\""; 
```

问题是在一列中我混合了数字、字符串等数据类型。我已经搜索了解决方案，但没有一个对我有帮助。下面的链接对我没有帮助（ [https://stackoverflow.com/questions/11200472/read-excel-columns-as-text](https://stackoverflow.com/questions/11200472/read-excel-columns-as-text)) 我发现 Excel 根据前 10 列决定哪种类型是列。我该如何解决这个问题？我正在使用 Microsoft.Office.Interop.Excel。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:38:24.057

我通常做的是：

```
 Range FirstCell = YourWorkSheet.Range["A1"];  //Use the Header of the column you want instead of "A1", or even a name you give to the cell in the worksheet.

        List<string> ColumnValues = new List<string>();

        int i = 1;
        object CellValue = FirstCell.Offset[i, 0].Value;
        while (CellValue != null)
        {
            ColumnValues.Add(CellValue.ToString());
            i++;
            CellValue = FirstCell.Offset[i,0].Value;
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:40:32.000

在 codeproject 上看看[这个。](http://www.codeproject.com/Articles/9992/Faster-MS-Excel-Reading-using-Office-Interop-Assem)如评论中所述，如果您使用的是 Interop，则不需要连接字符串。您可以简单地打开一个工作簿，获取项目数组（对象数组），然后对每个项目调用 ToString() 以获取其字符串表示形式。这样的事情应该做：

```
ApplicationClass app = new ApplicationClass();
app.Visible = false;
app.ScreenUpdating = false;
app.DisplayAlerts = false;

Workbook book = app.Workbooks.Open(@"path\Book1.xls", 
    Missing.Value, Missing.Value, Missing.Value, 
    Missing.Value, Missing.Value, Missing.Value, Missing.Value, 
    Missing.Value, Missing.Value, Missing.Value, Missing.Value, 
    Missing.Value, Missing.Value, Missing.Value);

Worksheet sheet = (Worksheet)book.Worksheets[1];
Range range = sheet.get_Range(...);

string execPath = Path.GetDirectoryName(
    Assembly.GetExecutingAssembly().CodeBase);

object[,] values = (object[,])range.Value2;

for (int i = 1; i <= values.GetLength(0); i++)
{
    for (int j = 1; j <= values.GetLength(1); j++)
    {
        string s = values[i, j].ToString();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:17:32.340

唔。不知道它是否有帮助，但我遇到了同样的问题。现在它适用于以下连接字符串：

```
<add name="Excel2010File"
     connectionString="Provider=Microsoft.ACE.OLEDB.12.0; Data Source={0}; Extended Properties=&quot;Excel 12.0;READONLY=TRUE;IMEX=1&quot;"
     providerName="Microsoft.ACE.OLEDB.12.0" /> 
```

如果您没有，您可以在网络上找到我的提供商的库（抱歉，不再有链接）。您`12.0`甚至可以将其设置为使用较低版本的 excel 文件。

# php - 将 PHP 变量传递给 onLoad (JS)

> ID：15668487
> 
> 赞同：0
> 
> 时间：2013-03-27T20:12:33.293
> 
> 标签：php, javascript, onload

我正在尝试将两个 PHP 变量传递给我的 onload 标记。我不断收到错误“Uncaught ReferenceError: a is not defined”

我正在使用的代码是：

```
<body onload="loadCalendar(<?php echo $profiletype; ?>,<?php echo $uid; ?>)"> 
```

该代码的结果是：

```
<body onload="loadCalendar(a,29)"> 
```

在我看来，这看起来不错-但我不断收到该错误。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:14:59.290

我认为您缺少一些单引号

```
<body onload="loadCalendar('<?php echo $profiletype; ?>','<?php echo $uid; ?>')"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:15:02.433

改成这个。

```
<body onload="loadCalendar('<?php echo $profiletype; ?>',<?php echo $uid; ?>)"> 
```

当您没有引用该值时，它将解释`a`为变量而不是字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:15:42.317

您需要引用返回的`$profiletype`：

```
<body onload="loadCalendar('<?php echo $profiletype; ?>',<?php echo $uid; ?>)"> 
```

如果您不这样做，则该值将按字面意思获取-对于`a`具有该名称的变量，因此错误`Uncaught ReferenceError: a is not defined`。

# c++ - 升级到 Qt 5 后的错误

> ID：15668488
> 
> 赞同：0
> 
> 时间：2013-03-27T20:12:36.580
> 
> 标签：c++, qt

我刚刚从官网升级安装了Qt 5：[https](https://qt-project.org/downloads) ://qt-project.org/downloads 我选择的版本：

> 适用于 Windows 32 位的 Qt 5.0.1 (MinGW 4.7, 823 MB)

问题是什么都不再起作用了！当我尝试运行用 Qt 4.8 完美编译的代码时，我有 66 个错误。

这里有一些例子：

> 错误：无效使用不完整类型“class QLabel”
> 错误：前向声明“class QLabel”
> 错误：无效使用不完整类型“class QLineEdit”

非常奇怪的错误。

这是编译输出：

> mingw32-make: *** [debug] Error 2
> 21:10:34: The process "C:\Qt\Qt5.0.1\Tools\MinGW\bin\mingw32-make.exe" exited with code 2.
> 构建/部署时出错项目 SQLWidgetMapper (kit: Desktop Qt 5.0.1 MinGW 32bit)
> 执行步骤“Make”时

谁能给我一个线索？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:15:53.690

`QWidgets` [已移至单独的模块](https://qt-project.org/doc/qt-5.0/qtdoc/qt5-intro.html#widgets-in-qt-5)中。您阅读了文档，对吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:17:32.420

您是否同时安装了 Qt 4.8 和 Qt 5.0？检查路径环境变量中的内容。

# twitter-bootstrap - 如何让导航栏自动转换为下拉

> ID：15668490
> 
> 赞同：1
> 
> 时间：2013-03-27T20:12:37.823
> 
> 标签：twitter-bootstrap

[如果您在此网站http://buffalosw.com](http://buffalosw.com)上将浏览器大小调整为与手机显示屏一样小，您会注意到导航栏变成了一个下拉菜单。有没有办法让 twitter 引导程序也自动为我执行此操作？

另外，如果侧面导航栏也能做同样的事情会很好吗？

或者也许在引导程序之上有一些 twitter 引导程序第三方组件可以处理这样的事情？（我们只是想让网站在手机上看起来不错，没有太多工作）。

谢谢，院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:20:04.047

Bootstrap 已经做到了。请参阅响应式演示页面上的导航菜单：http: [//twitter.github.com/bootstrap/scaffolding.html#fluidGridSystem](http://twitter.github.com/bootstrap/scaffolding.html#fluidGridSystem)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T22:28:41.880

我终于找到了答案。在本页面

[http://twitter.github.com/bootstrap/components.html#navbar](http://twitter.github.com/bootstrap/components.html#navbar)

只需搜索“响应导航栏”它就被埋在导航栏信息的底部。

院长

# c# - 程序无故挂起

> ID：15668491
> 
> 赞同：0
> 
> 时间：2013-03-27T20:12:55.727
> 
> 标签：c#, debugging, c#-4.0, concurrency, task-parallel-library

我正在使用 tpl 并行执行数据。问题是有时它会无缘无故挂起，给出这样的输出：

```
The thread '<No Name>' (0x4aa4) has exited with code 0 (0x0).
The thread '<No Name>' (0x2bf4) has exited with code 0 (0x0).
The thread '<No Name>' (0x417c) has exited with code 0 (0x0).
The thread '<No Name>' (0x432c) has exited with code 0 (0x0).
The thread '<No Name>' (0x3ad0) has exited with code 0 (0x0).
The thread '<No Name>' (0x4440) has exited with code 0 (0x0).
The thread '<No Name>' (0x24e8) has exited with code 0 (0x0).
The thread '<No Name>' (0x3354) has exited with code 0 (0x0).
The thread '<No Name>' (0x4a30) has exited with code 0 (0x0). 
```

该程序仍将执行，当我在 Visual Studio 中暂停它时，它会在我有 ForEach 的并行过程的地方暂停：

```
Parallel.ForEach
(
   hold1.remainingHolds.ToArray(), 
   subSequence =>
   {
      //only if subsequence has 1 common substring
      if (checkIfCommon(remainingSequence, subSequence.ToString()) == 1)
      {
         goDownLinkType2(subSequence.ToString().Split(','), 0, 
           (SuffixNode)hold1.childHolds[subSequence.ToString().Split(',')[0]]);
       }
    }
  ); 
```

我不认为它是死锁，因为没有任何情况下可以有一个线程等待不同的资源并最终相互锁定

它应该进入这个方法内部并递归下去一个后缀树，直到它会等到没有线程将任何对象添加到 arraylist

```
 Boolean flag = false;
 public void goDownLinkType2
      (string[] splittedString, 
       int index, SuffixNode currentNode)
       {
          Boolean writingFlag = false;
          if (index == 2)
          {
             while(writingFlag == false)
             {
                while(flag == true)
                {
        //blocked
                 }
                 if (flag == false)
                 {
                    flag = true;
                 if(!secondChoiceResults.Contains
                     (currentNode.representingStance.SequenceOfHolds))
                 {
                    Console.WriteLine("new addition");
                    secondChoiceResults.Add
                       (currentNode.representingStance.SequenceOfHolds,
                        currentNode.representingStance);
                  }
                  flag = false;
                  writingFlag = true;
               }
            }

         }
         else
         {
            int nextIndex = index + 1;
            goDownLinkType2
              (splittedString, 
               nextIndex,
               (SuffixNode)currentNode.childHolds[splittedString[nextIndex]]
              );
          }
       } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T21:32:40.773

折腾“标志”变量并使用锁定语句。使用此代码，您的关键部分可能有多个线程（即一个线程即将设置 flag = true 而另一个线程刚刚将 flag == false 评估为 true（顺便说一句，将来只需使用 !flag ）

```
lock( obj )
{
    // critical section here
} 
```

obj 只需要是对所有线程都可以访问的对象的引用。

这是我对您的代码的修改：

```
public void goDownLinkType2(string[] splittedString, int index, SuffixNode currentNode)
{
    Boolean writingFlag = false;
    if (index == 2)
    {
        while(writingFlag == false)
        {
            lock( this )
            //while(flag == true)
            //{
                //blocked
            //}
            //if (flag == false)
            {
                //flag = true;
                if (!secondChoiceResults.Contains(currentNode.representingStance.SequenceOfHolds))
                {
                    Console.WriteLine("new addition");
                    secondChoiceResults.Add(currentNode.representingStance.SequenceOfHolds, currentNode.representingStance);
                }
                //flag = false;
                writingFlag = true;
            }
        }

    }
    else
    {
        int nextIndex = index + 1;
        goDownLinkType2(splittedString, nextIndex, (SuffixNode)currentNode.childHolds[splittedString[nextIndex]]);
    }
} 
```

# java - Bukkit 配置文件创建错误

> ID：15668499
> 
> 赞同：0
> 
> 时间：2013-03-27T20:13:29.340
> 
> 标签：java, configuration-files, bukkit

我是编程 bukkit 插件的新手，所以如果答案很明显，请放轻松。我正在尝试创建第二个配置文件来存储位置和其他数据，但是当我运行我的插件时，我不断得到一个`NullPointerException`.

这是我的代码：

```
package blah.blah.blah.XD;

import java.io.File;
import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.logging.Level;

import org.bukkit.Location;
import org.bukkit.configuration.file.FileConfiguration;
import org.bukkit.configuration.file.YamlConfiguration;
import org.bukkit.event.Listener;
import org.bukkit.plugin.java.JavaPlugin;

public class KingdomLocationsFile extends JavaPlugin implements Listener{

    public Kingdoms plugin;

    public KingdomLocationsFile(Kingdoms plugin) {
        this.plugin = plugin;
    }

    private File KingdomLocationsFile;
    private FileConfiguration KingdomLocations;

    public void reloadKingdomLocations() {
        if (KingdomLocationsFile == null) {
            KingdomLocationsFile = new File(getDataFolder(), "KingdomLocations.yml");
        }
        KingdomLocations = YamlConfiguration.loadConfiguration(KingdomLocationsFile);

        // Look for defaults in the jar
        InputStream defConfigStream = plugin.getResource("KingdomLocations.yml");
        if (defConfigStream != null) {
            YamlConfiguration defConfig = YamlConfiguration.loadConfiguration(defConfig
                Stream);
            KingdomLocations.setDefaults(defConfig);
        }
    }

    public FileConfiguration getKingdomLocations() {
        if (KingdomLocations == null) {
            this.reloadKingdomLocations();
        }
        return KingdomLocations;
    }

    public void saveKingdomLocations() {
        if (KingdomLocations == null || KingdomLocationsFile == null) {
        return;
        }
        try {
            getKingdomLocations().save(KingdomLocationsFile);
        } catch (IOException ex) {
            this.getLogger().log(Level.SEVERE, "Could not save config to " + KingdomLoc
                ationsFile, ex);
        }
    }

    public boolean force = false;

    public List<Location> getLocationsList(final String path) {
        final List<Location> List = new ArrayList<Location>();
        if (this.KingdomLocations.contains(path) && this.KingdomLocations.isConfigu
                rationSection(path)) {
            final Set<String> keys = this.KingdomLocations.getConfigurationSect
                        ion(path).getKeys(false);
            if (keys.size() > 0) {
                final Location[] key = (Location[]) keys.toArray();
                for (final Location element : key) {
                    List.add(this.getKingdomLocation(path +"." +(Locati
                                        on) element));
                }
            }
        }
        return List;
    }

    private Location getKingdomLocation(String path) {
        Location loc = (Location) this.KingdomLocations.get(path);
        return loc;
    }
} 
```

...这是错误：

```
C:\Users\Mark\Desktop\Plugin Test Server>java -Xms1024M -Xmx1024M -jar craftbukk
it-1.5.1-R0.1-20130326.111705-23.jar -o true
229 recipes
27 achievements
16:06:39 [INFO] Starting minecraft server version 1.5.1
16:06:39 [INFO] Loading properties
16:06:39 [INFO] Default game type: SURVIVAL
16:06:39 [INFO] Generating keypair
16:06:39 [INFO] Starting Minecraft server on *:25565
16:06:39 [INFO] This server is running CraftBukkit version git-Bukkit-1.4.7-R1.0
-75-g7f25632-b2717jnks (MC: 1.5.1) (Implementing API version 1.5.1-R0.1-SNAPSHOT
)
16:06:39 [INFO] [Kingdoms] Loading Kingdoms v1.0
16:06:39 [INFO] Preparing level "world"
16:06:39 [INFO] Preparing start region for level 0 (Seed: 3764664766498884770)
16:06:40 [INFO] Preparing start region for level 1 (Seed: 3764664766498884770)
16:06:40 [INFO] Preparing spawn area: 20%
16:06:41 [INFO] Preparing start region for level 2 (Seed: 3764664766498884770)
16:06:41 [INFO] [Kingdoms] Enabling Kingdoms v1.0
16:06:41 [SEVERE] Error occurred while enabling Kingdoms v1.0 (Is it up to date?
)
java.lang.NullPointerException
    at com.treeclimber17.kingdoms.KingdomLocationsFile.reloadKingdomLocation
s(KingdomLocationsFile.java:35)
    at com.treeclimber17.kingdoms.KingdomLocationsFile.getKingdomLocations(K
ingdomLocationsFile.java:44)
    at com.treeclimber17.kingdoms.Kingdoms.onEnable(Kingdoms.java:14) [THIS PROBABLY         DOESN't MATTER...]
    at org.bukkit.plugin.java.JavaPlugin.setEnabled(JavaPlugin.java:217)
    at org.bukkit.plugin.java.JavaPluginLoader.enablePlugin(JavaPluginLoader
.java:457)
    at org.bukkit.plugin.SimplePluginManager.enablePlugin(SimplePluginManage
r.java:381)
    at org.bukkit.craftbukkit.v1_5_R2.CraftServer.loadPlugin(CraftServer.jav
a:282)
    at org.bukkit.craftbukkit.v1_5_R2.CraftServer.enablePlugins(CraftServer.
java:264)
    at net.minecraft.server.v1_5_R2.MinecraftServer.j(MinecraftServer.java:3
01)
    at net.minecraft.server.v1_5_R2.MinecraftServer.e(MinecraftServer.java:2
80)
    at net.minecraft.server.v1_5_R2.MinecraftServer.a(MinecraftServer.java:2
40)
    at net.minecraft.server.v1_5_R2.DedicatedServer.init(DedicatedServer.jav
a:150)
    at net.minecraft.server.v1_5_R2.MinecraftServer.run(MinecraftServer.java
:379)
    at net.minecraft.server.v1_5_R2.ThreadServerApplication.run(SourceFile:5
73)
16:06:41 [INFO] Server permissions file permissions.yml is empty, ignoring it
16:06:41 [INFO] Done (1.885s)! For help, type "help" or "?" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:21:35.700

您应该在 bukkit 自己的支持页面上保留与 bukkit 相关的问题（因为它是一个 API），在这里可以找到：[http ://forums.bukkit.org/forums/plugin-development.5/](http://forums.bukkit.org/forums/plugin-development.5/)

话虽如此，请尝试使用 try-catch 来查看该语句是否仍然为空：

```
KingdomLocations = YamlConfiguration.loadConfiguration(KingdomLocationsFile); 
```

就像是：

```
try {
    KingdomLocations = YamlConfiguration.loadConfiguration(KingdomLocationsFile);
} catch (Exception e) {
    System.out.println("Exception caught in method");
    System.out.println(e.printStackTrace());
} 
```

有点写意，但没有手头的 api/行号，很难准确地找出问题所在。

# drupal-7 - Drupal 7 在视图中访问字段收集数据

> ID：15668502
> 
> 赞同：1
> 
> 时间：2013-03-27T20:13:36.093
> 
> 标签：drupal-7, drupal-views, drupal-fields

我有一个**名为**`field_logo_logos`.

里面有2个字段：

`field_logo_image`和`field_logo_link`

在视图中，我可以获取数据，结果如下：

```
<div typeof="" about="/field-collection/field-logo-logos/24" class="entity entity-field-collection-item field-collection-item-field-logo-logos clearfix">
  <div class="content">
    <div class="field field-name-field-logo-image field-type-image field-label-hidden view-mode-full">
      <div class="field-items">
        <figure class="clearfix field-item even"><img width="222" height="57" title="title" alt="alttag" src="http://link/to/my/image.png?itok=1wgQypF6" class="image-style-footer-logo" typeof="foaf:Image"></figure>
      </div>
    </div>
    <div class="field field-name-field-logo-link field-type-link-field field-label-hidden view-mode-full">
      <div class="field-items">
        <div class="field-item even">http://www.mylink.com/</div>
      </div>
    </div>
  </div>
</div> 
```

但是我如何覆盖它，以便我可以将其更改为：

```
<div class="footer-logo">
    <a href="http://www.mylink.com/" target="_blank">
        <img width="222" height="57" title="title" alt="alttag" src="http://link/to/my/image.png?itok=1wgQypF6" class="image-style-footer-logo" typeof="foaf:Image">
    </a>
</div> 
```

我知道如何在视图或模板覆盖中使用带有标记的普通字段来执行此操作，但字段集合的工作方式似乎不同。

任何建议将不胜感激。

C

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-11T02:33:38.310

您不能使用当前迭代的字段集合来执行此操作。

这是一个帖子，他们说他们将在 2.x 版本中允许更好的模板

[https://drupal.org/node/1157794](https://drupal.org/node/1157794)

你总是可以修补，但没有人建议这样做。

# mercurial - 如何撤消 Mercurial 中添加的所有文件

> ID：15668503
> 
> 赞同：29
> 
> 时间：2013-03-27T20:13:36.200
> 
> 标签：mercurial, add, undo

假设我输入`hg add`Mercurial，我的工作目录中有一堆未被忽略的未跟踪文件。在不明确键入每个文件的名称的情况下取消添加所有这些文件的最简单方法是什么？

我可以用一个命令将它们全部取消添加吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-03-27T20:54:01.493

**前言**

您必须始终提出包含*尽可能多信息的*问题。因为现在你的问题，根据某些情况，可能有完全不同的答案。

**案例一 - 在已经版本化的文件中没有本地修改，只添加（而不是提交）文件**

`hg revert`将您的工作目录返回到最后一次提交后的状态，撤消它的所有更改。

**案例一 - 本地编辑，您想要保存并偶尔添加文件**

1.  阅读 Mercurial 中的文件集。
2.  在`hg forget`命令中使用文件集，例如`hg forget "set:added()"`.

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-03-28T08:39:44.590

在文件上使用`hg revert`或`hg forget`（两者都对您运行的文件执行相同的操作`hg add`）。为避免输入文件名，您可以使用如下[文件集](http://www.selenic.com/mercurial/hg.1.html#fileset)：

```
$ hg revert "set:added()" 
```

这会将文件恢复到它在工作副本父修订版中的样子，即它将再次变得未知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-26T20:41:52.613

hg revert -r .^ path-to-file 将从提交集中恢复提交。然后提交并提交（如果使用果冻鱼），您将看到从变更集中删除的文件。我不知道为什么 .^ 还有效，但可能有人会知道。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-27T20:21:51.377

您总是可以重新克隆您的存储库，然后将工作文件夹中的 .hg 目录替换（删除现有然后复制新的）与来自新克隆的目录...（假设您没有待处理的提交...）

# ios - 用于测试 iPhone 应用的 iPad mini

> ID：15668508
> 
> 赞同：0
> 
> 时间：2013-03-27T20:13:57.620
> 
> 标签：ios, xcode, ipad

请告诉我，我可以用 Xcode 的视网膜在 iPhone 的 Ipad 迷你应用程序上进行测试吗？还是仅适用于 iPad 3 和 4？我需要最好的测试方式，但只能购买一台设备。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:18:58.090

您可以在 Mac 上的 iOS 模拟器上测试 iOS 应用程序。您不需要任何硬件来测试软件，但您只能在选择运行它们的硬件上运行应用程序。您无法在 iPhone 上运行 iPad 应用程序，但可以在 iPad 上运行 iPhone 应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:17:36.673

由于屏幕尺寸/像素密度，您无法在 iPad Mini 上测试视网膜。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:17:49.383

iPad mini 是非视网膜的，所以你不能在 iPad mini 上测试视网膜图形。但是，您可以使用模拟器来测试 iPad 和 iPhone 的视网膜和非视网膜。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T20:18:39.747

好吧，您应该知道，如果您还没有，模拟器会让您像在所有平台上一样运行您的应用程序。

现在就您的问题而言。当然，iPad Mini 可以工作。它的分辨率与第一代 iPad 完全相同。因此，当您安装您的应用程序时，它将运行您的应用程序的非视网膜 iPad 版本。

您不能测试视网膜图形，因为它没有视网膜显示器。

希望有帮助！

# python - 如何删除python空格

> ID：15668511
> 
> 赞同：-3
> 
> 时间：2013-03-27T20:14:11.853
> 
> 标签：python, regex, string, automation

我想从这样的文件行中读取 A = B = 411 没有任何空格/空格。我试过了

```
import os
import re
import fileinput

#-------------------------------------------------------------------------------

fileName = "input.txt"

f = open(fileName,"r")
lines = f.readlines()
for i in lines:
    character = i.split()
    for n in character:

        if  n != '#':
            print n

        else:
            print "End of File" 
```

输入.txt

```
A = B = 411
C = ( D = 2 ) * _2
C = D = 2 * _2
F = C - D
E = D * _10
Z = 10 / 3
# 
```

现在的问题是，如果我在输入文件中的字母/数字之间留出空格，则程序可以正常工作。但是如果删除了空格，那么输出就像我不想要的 A=B=411 ......谁能帮助我......如何保持从文件中读取的数据的完整性......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T21:25:09.427

默认情况下（即没有附加参数），字符串对象的[`split()`](http://docs.python.org/2/library/stdtypes.html?highlight=split#str.split)方法将忽略空格并将字符串拆分为单词列表。因此，使用它以及进行一些其他更改以简化和加速您的代码导致了以下结果：

```
fileName = "input.txt"
with open(fileName,"r") as file:
    for line in file:
        for word in line.split():
            if  word != '#':
                print word
            else:
                print "End of File" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:26:16.750

如果要删除可以替换的`character = i.split()`空格

```
character = list(i.replace(" ", "")) 
```

# grails - 如何将列表传递给 Groovy SQL 中的查询？

> ID：15668514
> 
> 赞同：2
> 
> 时间：2013-03-27T20:14:17.050
> 
> 标签：grails, grails-orm

我有一个场景将 char 值列表传递给 Grails 中的查询。

当我通过列表时，这就是发生的事情

```
def accounts = ['A', 'B']
 AND acct.account_status_cd  in '${accounts} 
```

查询看起来像“AND acct.account_status_cd in '[A,B]'”

但它应该是“AND acct.account_status_cd in ('A','B')”

如何做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T01:53:01.200

通过作为字符串传递来解决它......

字符串 s = keys.collect { "'$it'" }.join( ',' )

它给了我 S = 'A','B','C'

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T20:25:52.923

解决方案可能是您的域类中的 NamedQuery，如下所示：

```
class Account {

    // code omitted

    static namedQueries = {
       accountsInList { accountList ->
          'in'("account_status_cd", accountList)
       }
} 
```

然后你可以使用这个 namedQuery 像：

```
Account.accountsInList(['A', 'B']).list() 
```

当然你也可以使用 withCriteria。

有关更多信息，请参阅文档：http: [//grails.org/doc/2.2.x/ref/Domain%20Classes/createCriteria.html](http://grails.org/doc/2.2.x/ref/Domain%20Classes/createCriteria.html)

# java - 初始化问题？

> ID：15668519
> 
> 赞同：0
> 
> 时间：2013-03-27T20:14:33.060
> 
> 标签：java

我正在尝试制作一个程序，让用户输入未知的名称值，然后输出输入的最长名称。到目前为止，这是我的代码。当我编译时，我有几个错误，它们都是相同的“找不到符号”。如果需要，我是否需要在哪里初始化这些变量？

```
import java.util.Scanner; 
public class Name 
{ 
    public static void main(String[] args) 
    { 
        Scanner kb = new Scanner(System.in); 
        longestName(kb); 
    } 
    public static void longestName(Scanner sc) 
    {

        String name=kb.nextLine();
        biggestName=name;
        System.out.println("Type -1 if you want to quit");
        int number=kb.nextInt();
        While (number !=-1); 
        { 
            String name1=kb.nextLine();
            if (name1.length() > biggestName)
            {
                biggestName=name1;
            }
            System.out.println("Do you want to continue? Type -1 to quit.");
            int number1=kb.nextInt();
        }
        System.out.println("Longest name is "+biggestName);

    }
} 
```

感谢帮助人员修复了错误，以及其他一些更改，程序给出了正确的输出。

```
import java.util.Scanner; 
public class Name 
{    
    public static void main(String[] args) 
    { 
        Scanner kb = new Scanner(System.in); 
        longestName(kb); 
    } 
    public static void longestName(Scanner kb) 
    {

        String biggestName;
        System.out.println("Enter the first name");
        String name=kb.nextLine();
        biggestName=name;
        System.out.println("Type -1 if you want to quit");
        int number=kb.nextInt();
        while (number !=-1) 
        { 
            System.out.println("Enter another name");
            Scanner kb1 = new Scanner(System.in);
            String name1=kb1.nextLine();
            int length1=biggestName.length();
            int length2=name1.length();
            if (length2 > length1)
            {
                biggestName=name1;
            }
            System.out.println("Do you want to continue? Type -1 to quit.");
            number=kb.nextInt();
        }
        System.out.println("Longest name is "+biggestName);

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:15:41.557

您传入了您的`Scanner`to `longestName`，但在 中`longestName`，您命名了参数`sc`。使用`sc`而不是`kb`in `longestName`。

使用小写`while`而不是`While`; `while`删除;后面的分号 那里的分号表示*那*是主体，而不是`{` `}`它下面的块。

我假设在 while 循环的底部，您希望将下一个整数分配给，而不是立即超出范围`number`的新变量。`number1`

您没有声明什么`biggestName`是（或`name`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:28:37.120

您的代码中有很多错误。在不详细解释每个错误的情况下，这是一个有效的修改版本示例：

```
import java.util.Scanner; 
public class Name 
{ 
    public static void main(String[] args) 
    { 
        Scanner kb = new Scanner(System.in); 
        longestName(kb); 
    } 
    public static void longestName(Scanner sc) 
    {
        System.out.println("Enter name, or type '-1' if you want to quit");

        String name=sc.nextLine();
        String biggestName="";

        while (!name.equals("-1")) 
        { 
            if (name.length() > biggestName.length())
            {
                biggestName=name;
            }
            name=sc.nextLine();
        }
        System.out.println("Longest name is "+biggestName);

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:15:49.530

这里有两个错误：

```
While (number !=-1); 
```

`While`应该是`while`，并且 会`;`产生一个无限循环。

另一个问题是你`number`无论如何都不会改变循环。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T20:16:06.330

1-

```
public static void longestName(Scanner sc) 
```

将扫描仪的名称更改为`kb`，或`kb`将方法中的 every 更改为`sc`。

2-[在 nextXXX 之后使用 nextLine 时查看扫描仪问题](https://stackoverflow.com/questions/7056749/scanner-issue-when-using-nextline-after-nextxxx)

3-使用`while`代替`While`，并删除`;`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T21:14:25.230

我可以在代码中看到以下问题：

1.  `longestName()`方法应该使用引用名称`sc`而不是`kb`（因为`kb`仅在`main`方法中具有范围）
2.  变量`biggestName`未声明。它应该被声明为类变量或`longestName()`方法中的变量，并且应该是类型`String`
3.  不是`While`，它`while`在小写的情况下是 'w'
4.  while 语句后不应有分号
5.  在 while 循环结束时，要计算 while 循环要比较的数字，并且当前分配给错误的变量。`kb.nextInt()`应该分配给变量`number`而不是`number1`因为变量`number1`永远不会被读取/使用。
6.  `>`运算符不能应用于字符串类型。在该行`if (name1.length() > biggestName)`中，我们正在比较`int`并且`String`将导致编译错误。该行应修改为`if (name1.length() > biggestName.length())`
7.  如果您提供的输入不是数字，则方法`nextInt()`将被抛出。`InputMismatchException`

现在我觉得我应该像 Joe Elleson 那样编写一个更正的代码。但希望这个答案有帮助。

# playframework - 在 IDEA 中找不到 Play 框架控制台

> ID：15668522
> 
> 赞同：0
> 
> 时间：2013-03-27T20:14:45.370
> 
> 标签：playframework, intellij-idea

我在哪里可以找到最新 IDEA 中的 Play 管理中心？根据**[这篇](http://blogs.jetbrains.com/idea/2012/01/play-console-in-intellij-idea/)**文章，我应该在工具中有一个菜单选项。我没看到。

我正在使用

*   IntelliJ IDEA 129.111
*   Play 2.0 支持插件 0.2.26
*   通用 Playframework 支持插件
*   播放框架 2.10

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:53:10.527

您应该使用**SBT**控制台（Play 控制台是 Sbt 之上的包装器）

*   安装：[http ://plugins.jetbrains.com/plugin/?idea&pluginId=5007](http://plugins.jetbrains.com/plugin/?idea&pluginId=5007)
*   维基：[https ://github.com/orfjackal/idea-sbt-plugin/wiki](https://github.com/orfjackal/idea-sbt-plugin/wiki)

# jquery - jquery sortable - 防止2个列表之间的重复

> ID：15668524
> 
> 赞同：4
> 
> 时间：2013-03-27T20:14:52.410
> 
> 标签：jquery, jquery-ui-sortable

如标题所示，如何防止两个列表之间出现重复。我正在尝试停止 #selected 列表中的重复项。我怀疑它在接收事件中完成，但我没有任何运气。

```
 $(function () {

    $("#options").sortable({
        connectWith: $("#selected"),
        helper: 'original',
        revert: true,
        tolerance: "pointer",
    });

    $("#selected").sortable({
        connectWith: $("#options"),
        helper: 'original',
        receive: function (event, ui) {            
        },
    });

    $("#options,#selected").disableSelection();

    $("#SkillGroups").change(function () {
        $.ajax({
            type: "POST",
            url: "/Contractor/Contractor/GetSkillsBySkillGroup",
            data: { skillGroupId: $("#SkillGroups").val() },
            success: function (result) {
                $loadList(result);
            }
        })
    });
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-29T20:03:42.640

终于搞定了。当你看到解决方案时有点明显。可能还有其他方法可以做到这一点。

```
 $("#selected").sortable({
        connectWith: $("#options"),
        helper: 'original',
        receive: function (event, ui) {

            var identicalItemCount  = $("#selected").children('li:contains(' + ui.item.text() + ')').length;
            alert(identicalItemCount);
            if (identicalItemCount > 1) {
                alert("Ahem.... we have a duplicate!!");
                $("#selected").children('li:contains(' + ui.item.text() + ')').first().remove();
            }
        },
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T21:17:27.170

[在这里](http://api.jquery.com/jQuery.unique/)使用 jquery.unique() 。从 DOM 元素数组中删除重复项。

```
 var l = $('#options, #selected').find('li').get();

    var lists = jQuery.unique(l);

    // build your new lists w/ $('#options').html() etc... 
```

**编辑**

[这是一个工作的jsFiddle](http://jsfiddle.net/tpressley1/mBsFR/)

因此，您需要确保在调用此方法时，您是在一个 DOM 元素数组上执行此操作，而不是在字符串或数字上执行此操作。另外，请确保您使用的是 JQuery 别名 ($) 而不是 JQuery.methodName。包含的示例有效，剩下要做的就是将它与从加载列表函数创建的元素联系起来，然后在过滤后将它们吐回各自的 uls 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-03T01:54:07.280

如果您想基于检查 data-* 属性来执行此操作，这是相同的解决方案。我刚刚遇到这个，希望它可以帮助某人。

```
receive: function (event, ui) {

    var identicalItemCount  = $(this).children("li[data-yourattribue='" + somevalue + "']").length;
    //alert(identicalItemCount);
    if (identicalItemCount > 1) {
        //alert("Ahem.... we have a duplicate!!");
        $(this).children("li[data-yourattribue='" + somevalue + "']").last().remove();
    } else {

        //your other stuff (like ajax calls, etc..)

    }

}, 
```

如果你做一些 ajax，比如在会话中保存一些额外的数据以及丢弃的项目，使用 .last() 删除实际丢弃的 droppable 也很有用，而不是系统中已经存在的那个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-07T06:23:21.830

无需再做任何事情或自定义编码是易于实现的最佳概念

```
(function($) {

    $('.acd').sortable({
        connectWith: 'ul',
        receive: function(ev, ui) {
            if(ui.item.hasClass("number"))
              ui.sender.sortable("cancel");
        }
    });    
})(jQuery);
```

```
h2 { font-size:1.4em; margin: 20px 10px 0 20px; }
ul
{
    float: left;
    margin: 20px 10px 0 20px;
    border:1px solid #999;
    width: 100px;
    padding:10px;
    list-style-type:none;
}
li
{
    background: #fff;
    border: solid 1px #ccc;
    font-family: Arial, Tahoma, San-Serif;
    padding: 10px;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https:////ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>

<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css"/>

<h2>In this snippet the right column does not append the numeric items from left column</h2>
<ul id="list1" class="acd">
    <li>One</li>
    <li class="number">2</li>
    <li class="number">3</li>
</ul>
<ul id="list2" class="acd">
    <li>Four</li>
    <li>Five</li>
    <li>Six</li>
</ul>
```

感谢 Majid Azani，他通过演示链接[https://codepen.io/mj_azani/pen/npohF提供了最佳解决方案](https://codepen.io/mj_azani/pen/npohF)

# c# - UserControl 调用父方法 - 查看是否发生错误

> ID：15668529
> 
> 赞同：0
> 
> 时间：2013-03-27T20:15:03.140
> 
> 标签：c#, asp.net, user-controls, parent, invokemember

在重定向到新页面之前，我有一个从父页面调用保存方法的用户控件。

如果在父保存方法中抛出错误或异常，它似乎被忽略并且子仍然重定向。有没有办法监听异常或以某种方式防止重定向是保存方法没有完全执行。

这是有问题的用户控件代码。

```
this.Page.GetType().InvokeMember(stepGuide.SaveMethod, System.Reflection.BindingFlags.InvokeMethod, null, this.Page, null);
AppPageMethods.RedirectToPage(button.CommandArgument); 
```

我很欣赏这些回应，但我希望尽可能保持模块化......

目前用户控件正在大约 15 个页面上使用，因此我已将用户控件添加到母版页。这些页面完全独立运行，用户控件仅充当附加层（导游），仅用于首次用户。用户控件仅由查询字符串中的参数调用，有关当前父页面的所有信息都是从数据库中的一行加载的。

我相信这给了我更大的灵活性，因为这个控件将被添加到更多的页面中。要将此用户控件功能添加到新页面，我只需在数据库中添加一个新行并确保父级的保存方法是公开的，这是我真正喜欢这种方法的地方。

有什么方法可以处理/侦听来自用户控件的父 ApplicationException ，而对每个父页面几乎没有更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:22:03.017

UserControl 在父控件（或页面）中调用方法的“正确”方式是让用户控件引发父控件侦听（订阅）的事件。

这样做是为了使用户控件与任何控件没有紧密的联系。例如，如果您想在另一个页面中重用该控件，则必须向用户控件添加代码，以便它知道要调用哪个“父”方法。您正在实施的方法可能会很快变得混乱。

另一个好处是您不会遇到现在面临的问题。如果抛出错误，您可以以“正常”方式处理它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T20:23:50.697

正确的方法是将事件从子页面冒泡到父页面。反过来不行。

这样父页面就可以注册该事件并使用它（如果它有用的话）或完全忽略它。

像这样的东西。

```
// Parent ASPX
<uc1:ChildControl runat="server" ID="cc1" OnSomeEvent="cc1_SomeEvent" />

// Parent
protected void cc1_SomeEvent(object sender, EventArgs e)
{
    // Handler event
}

// Child
public event EventHandler OnSomeEvent;

protected void ErrorOccurInControl()
{
     if (this.OnSomeEvent != null)
     {
          this.OnSomeEvent(this, new EventArgs());
     }
}

protected override void OnLoad(EventArgs e)
{
     ErrorOccurInControl();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:19:53.670

从中返回一个布尔值`SaveMethod`并执行以下操作？

```
try
{
    if(this.Page.GetType().InvokeMember(stepGuide.SaveMethod,
        System.Reflection.BindingFlags.InvokeMethod, null, this.Page, null))
    {
        AppPageMethods.RedirectToPage(button.CommandArgument);
    }
    else
    {
        // Do something else
    }
}
catch (Exception ex) // Better still, use specific exceptions
{
    // Handle exception
} 
```

此外，如果`SaveMethod`正在处理自己的异常，这就是调用方法忽略它的原因。在这种情况下，您将不得不`raise;`在`catch`块中`SaveMethod`（或者，更好的是，不处理您实际上想要冒泡给调用者的异常）。

编辑：但是，讨论引发事件的其他答案肯定是更好的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T20:20:38.820

在您的父页面（称为函数）中，确保异常没有被吞没，这样您就可以从调用者那里捕获错误并适当地处理它。

```
try{
  this.Page.GetType().InvokeMember(stepGuide.SaveMethod, System.Reflection.BindingFlags.InvokeMethod, null, this.Page, null);
  AppPageMethods.RedirectToPage(button.CommandArgument);
}
catch(Exception e)
{
   //Do something else than redirect here
} 
```

此外，如果您是特定异常，那么捕获和处理这些异常将是与一般异常相对应的理想选择。

# java - 如何在最短的时间内通过java在txt文件中添加2lac行？

> ID：15668530
> 
> 赞同：-1
> 
> 时间：2013-03-27T20:15:11.010
> 
> 标签：java

我正在尝试通过 java 程序在特定的 txt 文件（实际上是 conf 文件）中添加几乎 2lac 行。但是当数字只有 189000 时，几乎需要 112 分钟！我为此编写了以下代码

```
import java.io.*;
public class Fileshandling_example {
    static long s1;
    static long e1;
    static long e2;
    static Fileshandling_example fhe=  new Fileshandling_example();
    public static void main(String args[]) {
        try {           
            s1 = System.nanoTime();         
            File file1 = new File("\example\mandar.txt");
            LineNumberReader lnr1 = new LineNumberReader(new FileReader(file1));
            BufferedReader br1 = new BufferedReader(new FileReader(file1));
            lnr1.skip(Long.MAX_VALUE);
            int a = 1;
            StringBuffer sb1 = new StringBuffer("[stations]");
            String sCurrentline1 = br1.readLine();
            while ((sCurrentline1 = br1.readLine()) != null) {
                a++;
                if (sCurrentline1.contentEquals(sb1) == true) {
                    int count = a;  
                    int arraycount = 100000;
                    for(int i =0; i< (arraycount+1); i++){
                        if(0 == (i%10000)){
                            e2 = System.nanoTime();
                            System.out.println("Time  = "+(e2-s1));
                        }
                        String abc ="extern => 00"+(1000 + (arraycount-i))+",1,Wait(0.05)";
                        fhe.insertintoExtensions(file1, (count+1),abc);
                    }
                }       
            }               
        } catch (IOException e) {
            e.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }
        e1 = System.nanoTime();
        System.out.println("Time  = "+(e1-s1));
    }
    public void insertintoExtensions(File inFile1, int lineno, String s1)throws Exception {
        File outFile1 = new File("\example\111.tmp");
        FileInputStream fis  = new FileInputStream(inFile1);
        BufferedReader in = new BufferedReader(new InputStreamReader(fis));        
        FileOutputStream fos = new FileOutputStream(outFile1);
        PrintWriter out = new PrintWriter(fos);
        String thisLine = "";
        int i =1;
        while ((thisLine = in.readLine()) != null) {
            if(i == lineno) out.println(s1);
            out.println(thisLine);
            i++;
        }
        out.flush();
        out.close();
        in.close();
        inFile1.delete();
        outFile1.renameTo(inFile1);

    }
} 
```

任何人都可以帮助我在哪里出错？我问了类似的问题[coderanch](http://www.coderanch.com/t/608061/java/java/adding-String-Array-conf-text)但在这里我很快就得到了线索，所以我也在这里问。抱歉（跨论坛询问）。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:42:00.370

对于“\example\mandar.txt”中的每个“[stations]”，您循环 100,000 次：

```
if (sCurrentline1.contentEquals(sb1) == true) {
    int count = a; 
    int arraycount = 100000;
    for(int i =0; i< (arraycount+1); i++){ 
```

并调用 fhe.insertintoExtensions 再次循环 "\example\mandar.txt" 以复制或复制该行的内容或 s1 参数的内容，直到达到实际的行号：

```
while ((thisLine = in.readLine()) != null) {
    if(i == lineno) out.println(s1);
    out.println(thisLine);
    i++;
} 
```

尝试改进您的代码并使用 BufferedWriter 而不是 PrintWriter。

# jquery - 如何在 Jquery 中使用 css :after

> ID：15668537
> 
> 赞同：0
> 
> 时间：2013-03-27T20:15:29.140
> 
> 标签：jquery

我有这段 CSS：

```
.image-wrap:after {
    content: ' ';
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0px;
    left: 0px;
    box-shadow: inset 0px 0px 0px 5px red;
} 
```

我想在 Jquery 中“写”这个。我在`:after`使用`:after`Jquery 时遇到问题？请看一下我的完整代码：http: [//jsfiddle.net/WpGsx/23/](http://jsfiddle.net/WpGsx/23/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:18:18.673

好的，这是插图

[http://jsfiddle.net/WpGsx/30/](http://jsfiddle.net/WpGsx/30/)

你可能想检查不同的浏览器

```
var $wrap = $('.image-wrap');

$wrap.css({
    'box-shadow': 'inset 0px 0px 0px 5px red',
    'position':'absolute',
    'left':'0',
    'top':'0',
    'padding':'5px 5px 0 5px'
}); 
```

# sass - 检查 SASS 父选择器是否存在。可能吗

> ID：15668539
> 
> 赞同：3
> 
> 时间：2013-03-27T20:15:34.850
> 
> 标签：sass

我有个问题。因此，在混合中，我引用了父选择器“&”。只要 mixin 没有嵌套，它就可以工作。有没有办法检测混合是否在非嵌套场景中使用，或者检查“&”是否为空？

当 mixin 调用未嵌套时，此方法有效

```
=myresponsiveMixin($media)
  @if $media == small {
    @media only screen and (max-width: $break-small)
       @content
  @else if $media == medium
    @media only screen and (min-width: $break-small + 1) and (max-width: $break-large - 1)
       @content 
```

这在 mixin 调用嵌套时效果很好，但在不嵌套时不会解析 '&'

```
 =myresponsiveMixin($media)
      @if $media == small {
        @media only screen and (max-width: $break-small)
           .classInHTMLToAllowMediaQueries &
               @content
      @else if $media == medium
        @media only screen and (min-width: $break-small + 1) and (max-width: $break-large - 1)
           .classInHTMLToAllowMediaQueries &
               @content 
```

所以问题是，如果有一种方法可以检查父选择器“&”的值，那么我可以在一个 mixin 中覆盖所有基础吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-03-12T23:09:56.617

```
@mixin does-parent-exist {
  @if & {
    .exists & {
      color: red;
    }
  } @else {
    .doesnt-exist {
      color: red;
    }
  }
} 
```

[http://sass-lang.com/documentation/file.SASS_REFERENCE.html#parent-script](http://sass-lang.com/documentation/file.SASS_REFERENCE.html#parent-script)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T17:06:42.530

您正在尝试一个错误的解决方案来解决您的问题。

看看如何在强大的 SASS 框架中解决这个问题。让我们以[Eric Meyer的](https://stackoverflow.com/users/1930386/eric-meyer)[Susy](http://susy.oddbird.net/)为例。

假设您有以下 HTML：

```
<div class="container">
  <div class="parent">
    <div class="child">
      Bla bla
    </div>
  </div>
</div> 
```

当你第一次调用一个 mixin 时，你只是在做它（代码是缩进的 .sass 语法）：

```
$total-columns: 8 // Declaring a varible that will be used by the mixin

.parent
  +span-columns(4) // Span four of eight columns 
```

但是，当您将其称为子元素时，比例将是弯曲的，因为父元素已经成比例：

```
.child
  +span-columns(2) // This will fail. You want 2 of 8 columns,
                   // but due to nesting the math is crooked.
                   // It will be "2 of (4 of 8)". 
```

为了解决这个问题，您提供了一个可选参数：用于进行数学运算的上下文：

```
.child
  +span-columns(2, 4) // Now the mixin will take 2 parts of 4
                      // instead of 2 parts of four 
```

这个 mixin 的源代码[可以](https://github.com/ericam/susy/blob/master/sass/susy/_grid.scss)在 GitHub 上找到。

简而言之，它创建了一个像这样的可选参数（代码采用类似 CSS 的 .scss 语法）：

```
@mixin span-columns(
  $columns,
  $context: $total-columns
  //...
) {
  //...
  width: columns($cols, $context /*...*/);
  //...
} 
```

看看怎么`$context`有默认值？由于默认值，可以省略此参数。换句话说，`$context`是一个可选参数。

调用此 mixin 时，如果`$context`未提供（例如`span-columns(2)`），则将其设置为`$total-columns`。`$total-columns`应该在第一次调用 mixin 之前设置变量（参见上面的示例）。

然后使用这两个参数来计算宽度。

## 更新 2013-03-30

> 我不是想弄清楚关于列的事情......我修改了我的问题以使其更清楚。

**首先**，我的建议不仅涉及网格列。这是您可以采用的通用技术。

**其次**，现在我看到您正在尝试嵌套媒体查询。

好吧，*一些*不同类型的媒体查询可以在 CSS3 中组合：例如`print`和宽度。但是你不能把一个`min-width: 601px`inside `max-width: 600px`，这行不通！

StackOverflow 上有一个广泛的答案，描述了为什么不应该嵌套相同类型的媒体查询：[https ://stackoverflow.com/a/11747166/901944](https://stackoverflow.com/a/11747166/901944)

**第三**，你试图发明轮子。已经有一个用于处理媒体查询的出色 mixin：由[Snugug](https://stackoverflow.com/users/703084/snugug)[响应](https://github.com/snugug/respond-to)。它非常易于使用且非常有效。

**第四**，[XY](https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem)的事情。不要询问您的歪曲混入，请描述您试图用它解决的问题！向我们展示实际的 HTML 并解释您想要实现的行为。

我们将向您展示，它可以通过一个不需要 SASS hacking 的简单、优雅、语义化的解决方案来解决。

# ember.js - One Observer called multiple times in emberjs

> ID：15668540
> 
> 赞同：2
> 
> 时间：2013-03-27T20:15:36.810
> 
> 标签：ember.js, ember-data

I actually play around with ember js and I'm confused, about the observer behavior.

```
App.ProjectView = Ember.View.extend({
    modelChanged: function() {
        console.log('modelChanged to: ');
        this.get('controller.model.images').forEach(function(item) {
            console.log(item.get('src'));
        });
    }.observes('controller.model.images')
}); 
```

this observer is called two or three times if I access the route. But I did not understand why and can't find any furthur informations.

thanks for any help.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:25:33.223

在创建和填充对象时，您最终可能会多次触发观察者。在上面的示例中，可能是创建了 model.images 并将其设置为 undefined... bam！观察者触发。然后 model.images 的内容被设置为一个实际的空数组...... bam！观察者触发。然后内容开始填充数组...... bam！砰！砰！多个观察者可以开火。

有一些方法可以解决这个问题，比如只有在长度 > 0 或已定义时才对 model.images 做一些事情。如果您知道正在加载的数据的长度，则只能在长度匹配时处理观察者。这些方法将根据您的应用程序的结构而有所不同。

# c# - Error Message Not Displaying

> ID：15668541
> 
> 赞同：1
> 
> 时间：2013-03-27T20:15:36.893
> 
> 标签：c#, web

I am trying to have an error message displayed when a username and password are not recognized.

```
if (rdr.Read())
{
    int id = int.Parse(rdr.GetValue(0).ToString());
    string fname = rdr.GetString(1);

    Session["ID"] = id;
    Session["FName"] = fname;
    con.Close();
    Response.Redirect("Home.aspx");
}
else 
{
    Response.Redirect("Login.aspx?err='blabla'"); //Display message
} 
```

The following code (Page_Load) is supposed to be invoked in the else statement, but it is not:

```
public partial class _Default : System.Web.UI.Page
{
    protected string err = "";

    protected void Page_Load(object sender, EventArgs e)
    {
        if (Request.Form.Count > 0)
        {
            err = Request.Form["err"];
        }
    }
} 
```

Why is this the case? Thank you all so much!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:16:55.247

This is a GET value in the query string, not a POST value in the form. You can use [`Request.QueryString[]`](http://msdn.microsoft.com/en-us/library/system.web.httprequest.querystring.aspx) or [`Request[]`](http://msdn.microsoft.com/en-us/library/h55b6cak.aspx) which contains POST and GET values.

```
if (Request.QueryString.Count > 0)
{
    err = Request.QueryString["err"];
} 
```

or

```
if (Request.Count > 0)
{
    err = Request["err"];
} 
```

Also, the query string value belongs to the Login page, so you won't be able to access it from `_Default`. Move your `Page_Load` logic to Login.aspx.cs.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:19:02.400

一般来说，根据类名`_Default`，我相信你已经把这段代码放在了`Default.aspx`页面中。将代码放在`Load`页面`Login.aspx`中。然后也按照jrummell提供的方向。

# opengl - Rendering to a texture using the image API (no Framebuffer)

> ID：15668549
> 
> 赞同：1
> 
> 时间：2013-03-27T20:16:01.860
> 
> 标签：opengl, glsl, opengl-4

As an experiment I decided to try rendering to a texture using the image API exclusively. At first the results were obviously wrong as the texture write occurred before the depth test. So I enabled the `early_fragment_tests`, which I though was introduced for pretty much this type of use case, but now I get a weird sort of flickering which seems like Z-fighting, which seems strange since it should be performing the same depth test that works for regular rendering.

Anyway, I've included an image of the problem, and I'm curious if anyone has an explanation as what is going on, and why this doesn't work. Can it be made to work?

![Flickering Dwarf](../Images/40ae1235149addfd276bef95c8bd9e29.png)

Here's a minimal reproducer

```
 #version 420
    in vec3 normal;
    layout(binding = 0) writeonly uniform image2D outputTex;
    void main()
    {
        vec4 fragColor = vec4(normal, 1);
        imageStore(outputTex, ivec2(gl_FragCoord.xy), fragColor);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T05:09:20.620

我将对您未显示的代码做出一些假设。因为你没有表现出来。我将假设：

1.  当您*显示*此图像时（无论是在实际屏幕上还是在/操作中） ，您使用了[适当的内存一致性操作。](http://www.opengl.org/wiki/Memory_Model#Ensuring_visibility)*`glReadPixels``glGetTexImage`*
**   您使用常规渲染命令渲染了这个场景，没有对三角形或任何东西进行特殊排序。您没有使用单独的渲染命令渲染每个三角形，每个三角形之间都有内存一致性操作。*

 *简而言之，我将假设您的问题实际上是由于您的着色器造成的。这很可能是由于许多其他事情。但是由于您不打算显示其余代码，因此我无法确定。因此，这个答案实际上可能无法回答您的问题。但是垃圾进，垃圾出。

我可以从您的着色器和上述假设中看到的问题非常简单：[不连贯的内存访问（如图像加载/存储）](http://www.opengl.org/wiki/Memory_Model#Incoherent_memory_access)是*完全无序*的。您执行了图像写入操作。因此，除非您采取措施做出这些保证，否则您无法保证此写入操作。

是的，您使用了早期的片段测试。但这并不意味着来自片段着色器的不连贯内存访问的顺序将是任何特定的顺序。

考虑一下如果渲染一个三角形会发生什么，然后在它前面渲染一个完全覆盖它的三角形。早期的片段测试不会改变任何东西，因为顶部片段发生在底部片段之后。并且图像加载/存储不保证*写入*同一像素的顺序。因此，很有可能在写入顶部三角形后完成对底部三角形的写入。

据我所知，像这样从不同的片段着色器对同一像素进行排序是不可能的。即使您`memoryBarrier`在写入后发出了 a，我对规范的阅读也并不表明这将保证此处的写入顺序。

正确的答案是根本不这样做。写入片段着色器输出；这就是他们的目的。*

# javascript - Google Map v3 - Trigger Geolocation onClick, instead of onLoad

> ID：15668554
> 
> 赞同：1
> 
> 时间：2013-03-27T20:16:09.350
> 
> 标签：javascript, jquery, google-maps-api-3, onclick

> Javascript rookie warning

I'm utilizing this demo on a new project: [http://jquery-ui-map.googlecode.com/svn/trunk/demos/jquery-google-maps-mobile.html#directions_map](http://jquery-ui-map.googlecode.com/svn/trunk/demos/jquery-google-maps-mobile.html#directions_map)

All is working well, except i need to make a functionality adjustment.

Currently, the app accesses Geolocation right away as the page loads. I need to find a way to change that, so the geolocation function triggers when clicking a link that I'll have say "Use my current location"

I've tried quite a few times, but I admit my rookie javascript syntax is problem.

I'll paste a clean local-ready version of the map (just need to link modernizer). If anyone can help me trigger the geolocation function via a link, instead of automatically on pageload, you'd be a lifesaver.

```
<!doctype html>
<html lang="en">
        <head>
        <title>jQuery mobile with Google maps - Google maps jQuery plugin</title>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <link type="text/css" rel="stylesheet" href="http://jquery-ui-map.googlecode.com/svn/trunk/demos/css/jquery-mobile-1.0/jquery.mobile.css" />
        <link rel="stylesheet" href="http://jquery-ui-map.googlecode.com/svn/trunk/demos/css/mobile.css" />
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false&libraries=places"></script>
        <script type="text/javascript" src="../js/modernizr.js"></script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js" type="text/javascript"></script>
        <script type="text/javascript" src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
        <script type="text/javascript" src="demo.js"></script>
        <script type="text/javascript" src="http://jquery-ui-map.googlecode.com/svn/trunk/ui/jquery.ui.map.js"></script>
        <script type="text/javascript" src="http://jquery-ui-map.googlecode.com/svn/trunk/ui/jquery.ui.map.services.js"></script>
        <script type="text/javascript" src="http://jquery-ui-map.googlecode.com/svn/trunk/ui/jquery.ui.map.extensions.js"></script>
        <script type="text/javascript">

            var mobileDemo = { 'center': '40.74843,-73.98566', 'zoom': 18 };            

            ////////////////////////////////////////////////////////////

            $('#directions_map').live('pageinit', function() {
                demo.add('directions_map', function() {
                    $('#map_canvas_1').gmap({'center': mobileDemo.center, 'zoom': mobileDemo.zoom, 'disableDefaultUI':true, 'callback': function() {
                        var self = this;

                        self.addMarker({'position': this.get('map').getCenter() }).click(function() {
                            self.openInfoWindow({ 'content': 'Hello World!' }, this);
                        });

                        self.set('getCurrentPosition', function() {
                            self.refresh();
                            self.getCurrentPosition( function(position, status) {
                                if ( status === 'OK' ) {
                                    var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude)
                                    self.get('map').panTo(latlng);
                                    self.search({ 'location': latlng }, function(results, status) {
                                        if ( status === 'OK' ) {
                                            $('#from').val(results[0].formatted_address);
                                        }
                                    });
                                } else {
                                    alert('Unable to get current position');
                                }
                            });
                        });

                        $('#submit').click(function() {
                            self.displayDirections({ 'origin': $('#from').val(), 'destination': $('#to').val(), 'travelMode': google.maps.DirectionsTravelMode.DRIVING }, { 'panel': document.getElementById('directions')}, function(response, status) {
                                ( status === 'OK' ) ? $('#results').show() : $('#results').hide();
                            });
                            return false;
                        });
                    }});
                }).load('directions_map');
            });

            $('#directions_map').live('pageshow', function() {
                demo.add('directions_map', $('#map_canvas_1').gmap('get', 'getCurrentPosition')).load('directions_map');
            });

        </script>
        </head>
<body>
<div id="directions_map" data-role="page"><div data-role="content">

    <div class="ui-bar-c ui-corner-all ui-shadow" style="padding:1em;">
      <div id="map_canvas_1" style="height:300px;"></div>
          <p>
            <label for="from">From</label>
            <input id="from" class="ui-bar-c" type="text" value="" />
          </p>
          <p>
            <label for="to">To</label>
            <input id="to" class="ui-bar-c" type="text" value="350 5th Ave, New York, NY 10118" />
          </p>
          <a id="submit" href="#" data-role="button" data-icon="search">Get directions</a>
      </div>

    <div id="results" class="ui-listview ui-listview-inset ui-corner-all ui-shadow" style="display:none;">
      <div class="ui-li ui-li-divider ui-btn ui-bar-b ui-corner-top ui-btn-up-undefined">Results</div>
      <div id="directions"></div>
      <div class="ui-li ui-li-divider ui-btn ui-bar-b ui-corner-bottom ui-btn-up-undefined"></div>
    </div>

</div></div>

</body>
</html> 
```

# regex - 是否可以使用 Perl 的 foreach 循环来使用 R 处理不同的文件？

> ID：15668557
> 
> 赞同：0
> 
> 时间：2013-03-27T20:16:23.847
> 
> 标签：regex, r, perl, foreach, statistics

我试图处理不同的文件，比如 R 脚本的输入，为此我在 Perl 中使用了一个 foreach 循环，但是 R 向我发送了一个警告：

```
Problem while running this R command:
a <- read.table(file="~/Desktop/ncRNA/Data/Inputs/Boxplot_all/All/$newquery")

Error:
file(file, "rt") : cannot open the connection
Calls: read.table -> file
In addition: Warning message:
In file(file, "rt") :
cannot open file '/Users/cristianarleyvelandiahuerto/Desktop/ncRNA/Data/Inputs/Boxplot_all/All/$newquery': No such file or directory
Execution halted 
```

我的代码是：

```
#!/usr/bin/perl

use strict;
use warnings;
use Statistics::R;
use Data::Dumper;

my $R = Statistics::R->new();

my @query = (
    '~/Desktop/ncRNA/Data/Inputs/Boxplot_all/All/dvex_all_rRNA_ce.RF00001.txt',
    '~/Desktop/ncRNA/Data/Inputs/Boxplot_all/All/dvex_all_rRNA_ce_60.RF00001.txt',
    '~/Desktop/ncRNA/Data/Inputs/Boxplot_all/All/dvex_all_rRNA_ce_70.RF00001.txt',
    '~/Desktop/ncRNA/Data/Inputs/Boxplot_all/All/dvex_all_rRNA_ce_80.RF00001.txt',
    '~/Desktop/ncRNA/Data/Inputs/Boxplot_all/All/dvex_all_rRNA_ce_90.RF00001.txt'
);

foreach my $query(@query) {
    my $newquery = $query;
    $newquery =~ s/(.*)\/(dvex_all.*)(\.txt)/$2$3/g;
    print "$newquery\n";
    $R->run(q`a <- read.table(file="~/Desktop/ncRNA/Data/Inputs/Boxplot_all/All/$newquery")`);
    $R->run(q`res <- summary(a$V2)`);
    my $output_value = $R->get('res');
    print "Statistical Summary = $output_value\n";
} 
```

使用正则表达式，我更改了输入的名称，但 R 不将其识别为文件。我可以这样做吗？一些建议？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:29:28.970

你有：

```
$R->run(q`...`); 
```

即，您正在使用[`q`operator](http://perldoc.perl.org/perlop.html#Quote-Like-Operators)。字符串插值不是用`q`. 直接的解决方案是使用

```
 $R->run(qq`...`); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:36:08.193

您使用了 Perl 的引号运算符`q()`，它与单引号字符串具有相同的语义——也就是说，没有变量插值。如果您不想使用双引号字符串（或等效`qq()`运算符），则必须将变量连接到查询中：

```
use feature 'say';
my $workdir = "~/Desktop/ncRNA/Data/Inputs/Boxplot_all/All/";
for my $query (@query) {  
  (my $newquery = $query) =~ s{\A.*/(?=dvex_all.*[.]txt\z)}{};
  say $newquery;
  # actually, here you should escape any <"> double quotes in $workdir and $newquery.
  $R->run(q#a <- read.table(file="# . $workdir . $newquery . q#")#);
  $R->run(q#res <- summary(a$V2)#);
  my $output_value = $R->get('res');
  say "Statistical Summary = $output_value";
} 
```

我做的其他改进：

*   正确的意图是纠正代码的第一步
*   功能`say`比.`print`
*   替换有一个更好的分隔符，现在清楚地显示了它的作用：从文件名中删除路径。实际上，我们应该使用执行此操作的跨平台模块之一。
*   我在复制习语中使用了替代品`(my $copy = $orig) =~ s///`。在 perl5 v16 中，您可以改用该`/r`标志：`my $copy = $orig =~ s///r`.
*   正则表达式的`/g`标志是无用的。
*   我将匹配锚定在字符串的开头和结尾。
*   `q```字符串现在有一个更明显的分隔符

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:22:21.643

我不知道 但看起来你应该连接你的字符串。

$R->运行(q `a <- read.table(file="~/Desktop/ncRNA/Data/Inputs/Boxplot_all/All/".$newquery)`);

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T20:39:53.047

R 不会使用“$”运算符连接字符串。“$query”在 R 函数参数中，因此您不能依赖 Perl 运算符。（警告：我不是 Perl 用户，所以我假设您的代码正在循环中创建一个名为“查询”的 R 对象）如果我是对的，那么您可能需要使用 paste0()：

文件参数可能如下所示：

```
 file=paste0("~/Desktop/ncRNA/Data/Inputs/Boxplot_all/All/", query) 
```

# python - 如何将cefpython编译为exe

> ID：15668568
> 
> 赞同：3
> 
> 时间：2013-03-27T20:17:18.830
> 
> 标签：python, chromium, pywin32

我正在使用[cefpython](https://code.google.com/p/cefpython/)创建一个简单的基于 HTML5 的应用程序。我正在使用 Python 和 pywin32 绘制一个简单的窗口并在那里渲染框架。

我想将我的**.py**编译成**.exe**，但我不知道该怎么做。我尝试使用 py2exe，但是当我运行结果时出现错误

```
Traceback (most recent call last):
  File "myApp.py", line 19, in <module>
  File "cefpython1\__init__.pyc", line 4, in <module>
ImportError: cannot import name cefpython_py27 
```

我尝试在分发目录中复制`cefpython_py27.pyd`，但似乎没有效果。

谁能帮我？这完全可行吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-21T09:32:24.423

我最终搞砸了它，我通过以下步骤进行了管理（我使用python2.7）：我像这样导入了cefpython：

从 cefpython1 导入 cefpython_py27 作为 cefpython

我的 py2exe 抱怨找不到 python32.dll，因为我懒惰和 cba 弄乱`__ini__`文件并搜索它的导入位置，我只是在安装文件的选项中将 python32.dll 添加到 dll_excludes。py2exe 完成后，我还必须手动将这些文件夹和文件复制到我的 dist 文件夹：

```
- C:\Python27(your python path)\Lib\site-packages\cefpython1\locales - whole folder
- C:\Python27(your python path)\Lib\site-packages\cefpython1\icudt.dll 
```

请注意，dll 相对较大：icudt.dll = 9.8MB，libcef.dll = 24.3MB，所以不要指望 dist 文件夹的大小。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-12T00:54:04.460

扩展 hidetr 的答案，将这样的内容添加到 setup.py 将复制所需的文件：

```
def get_cefpython_path():
    import cefpython1 as cefpython

    path = os.path.dirname(cefpython.__file__)
    return "%s%s" % (path, os.sep)

def get_data_files():
    cefp = get_cefpython_path()
    data_files = [('', ['%s/icudt.dll' % cefp,
          '%s/d3dcompiler_43.dll' % cefp,
          '%s/d3dx9_43.dll' % cefp,
          '%s/devtools_resources.pak' % cefp,
          '%s/ffmpegsumo.dll' % cefp,
          '%s/libEGL.dll' % cefp,
          '%s/libGLESv2.dll' % cefp,
          '%s/Microsoft.VC90.CRT.manifest' % cefp,
          '%s/msvcm90.dll' % cefp,
          '%s/msvcp90.dll' % cefp,
          '%s/msvcr90.dll' % cefp]),
        ('locales', ['%s/locales/en-US.pak' % cefp]),
        ]
    return data_files

setup(
    data_file = get_data_files()
    ... 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-24T11:43:07.133

这是对我有用的 Python 2.7 Win32。我使用了 cefpython 示例文件夹中的 cefsimple.py 示例进行演示。您需要 win32gui 模块才能使此示例正常工作，因此请先安装它。

*   [下载并安装了cefpython1 pacakage。](http://cefpython.googlecode.com/files/cefpython1-27.0-win32-py27.exe)
*   将 cefsimple.html、cefsimple.py、cefwindow.py 和 icon.ico 从 cefpython 的示例目录复制到一个单独的目录中，并将 cefsimple.py 更改为简单地将 cefpython 导入为`from cefpython1 import cefpython`. 基于`__file__`模块检测在 py2exe 中不起作用并导致错误，因此我将其删除（也许有更好的方法）。
*   在包含复制的上述文件的文件夹中创建了以下 setup.py：

```
 from setuptools import setup
    import py2exe
    import os

    def get_cefpython_path():
        import cefpython1 as cefpython

        path = os.path.dirname(cefpython.__file__)
        return "%s%s" % (path, os.sep)

    def get_data_files():
        cefp = get_cefpython_path()
        data_files = [('', [
              '%s/icudt.dll' % cefp,
              '%s/d3dcompiler_43.dll' % cefp,
              '%s/d3dx9_43.dll' % cefp,
              '%s/devtools_resources.pak' % cefp,
              '%s/ffmpegsumo.dll' % cefp,
              '%s/libEGL.dll' % cefp,
              '%s/libGLESv2.dll' % cefp,
              '%s/Microsoft.VC90.CRT.manifest' % cefp,
              '%s/msvcm90.dll' % cefp,
              '%s/msvcp90.dll' % cefp,
              '%s/msvcr90.dll' % cefp,
              'icon.ico', 'cefsimple.html']),
            ('locales', ['%s/locales/en-US.pak' % cefp]),
            ]
        return data_files

    setup(
        data_files = get_data_files(),
        windows=['cefsimple.py'],
        options={
            "py2exe": {
                "includes": ["json", "urllib"]
            }
        }
    ) 
```

*   然后只需在目录中运行py2exe，如下所示：`python setup.py py2exe`
*   您现在可以运行生成的应用程序`dist/cefsimple.exe`

[您可以从我的 Google Drive](https://drive.google.com/folderview?id=0B7wlbeWFgQsZV3hHMFdOQXg5Y28&usp=sharing)获取此示例的文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-28T02:49:06.490

现在有一个使用 PyInstaller 创建可执行文件的官方示例。在撰写本文时，目前仅支持 Windows 平台。看：

[https://github.com/cztomczak/cefpython/blob/master/examples/pyinstaller/README-pyinstaller.md](https://github.com/cztomczak/cefpython/blob/master/examples/pyinstaller/README-pyinstaller.md)

[![在此处输入图像描述](../Images/9575b53b8c3a57c20815f1be17f6d6f3.png)](https://i.stack.imgur.com/iozUD.jpg)

# sql - 连接 2 个或更多列并在 LIKE 谓词中使用？

> ID：15668569
> 
> 赞同：0
> 
> 时间：2013-03-27T20:17:19.850
> 
> 标签：sql, oracle10g

目前我有一个看起来像这样的查询：

```
select * from person
where person.firstname LIKE '%firstname_fragment%' OR 
      person.lastname  LIKE '%lastname_fragment%' 
```

您如何将这两列连接到一个 SQL WHERE 谓词中，而该谓词则执行类似的操作？

```
person.firstname + person.lastname LIKE '%firstname_fragment
lastname_fragment%' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:18:51.183

不在甲骨文中。那将是 SQL Server 语法。你要：

```
where person.firstname || ' ' || person.lastname LIKE '%firstname_fragment lastname_fragment%' 
```

我添加了空格，因为您在模式参数中有一个空格`like`。

再来一条评论。这与您在问题中的查询不同。等效查询更像：

```
select * from person
where person.firstname LIKE '%firstname_fragment%' AND
      person.lastname  LIKE '%lastname_fragment%' 
```

# python - Django 查找没有 ManyToMany 的条目

> ID：15668579
> 
> 赞同：0
> 
> 时间：2013-03-27T20:17:55.633
> 
> 标签：python, django, django-models

我有以下型号：

```
class M1(models.Model):
    name = models.CharField(max_length=20)

class M2(models.Model):
    models.ManyToManyField(M1, null=True, blank=True) 
```

现在我想获取所有没有类别的 M1 对象。我不知道如何开始，有什么想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T11:36:43.393

这有点奇怪，但基本概念是在 M1 上会有一个自动反向关系，`m2`并且还有一个名为[isnull](https://docs.djangoproject.com/en/dev/ref/models/querysets/#std%3afieldlookup-isnull)的查询过滤器，当应用于 M2M 关系时，这意味着两个模型之间没有链接。

```
orphans = M1.objects.filter(m2_isnull=True) 
```

# php - IM Chat System in PHP and MYSQL?

> ID：15668580
> 
> 赞同：0
> 
> 时间：2013-03-27T20:17:57.410
> 
> 标签：php, mysql

hi i am trying to setup an IM Chat system on my site so users can go onto a users profile and message them.

so far, what i have is user 1 can message user 2 and both user 1 and user 2 can see the chat in that box window.

my database looks like this:

```
id  |  to_user_id  | from_user_id  |  date_added  | content
1           2              1            10/01/12     hello 
```

my mysql insert looks like this:

```
$sql = "INSERT INTO ptb_chats (id, to_user_id, from_user_id,  content) VALUES (NULL, '".$profile_id."', '".$_SESSION['user_id']."', '".$chat_area."');";
            mysql_query($sql, $connection); 
```

$profile_id stores what profile the user is on, so it knows which user to send the message to, however the user who receieves the message will also be on their profile because this is where the chat window is located.

So now this causes a problem because user 1 will go onto user 2's profile and user 1 will type in a message. user 2 will recieve this message but if user 2 tries to reply to user 1, then because user 2 is replying from their profile the to_user_id in the database stores their $profile_id

so the message that user 2 is sending back to user 1 isn't being delivered to user 1 it is being delivered to user 2\. to_user_id is being set to the profile that user is on.

I need a way to store the from_user_id from the previous message and on reply insert that as a value for to_user_id?

i hope this makes sense. would appreciate any help thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:35:13.603

也许我没有得到整个问题，但是如果用户按下回复按钮左右，您会从用户回复的消息中知道 to_user_id 和 from_user_id ，对吗？

另一方面，您可能想在谷歌上搜索此类常见功能的开源解决方案。

# html - 无论内容如何， 强制表格列宽始终固定

> ID：15668583
> 
> 赞同：102
> 
> 时间：2013-03-27T20:18:03.563
> 
> 标签：html, css

我有一个 html 表格`table-layout: fixed`和一个具有设定宽度的 td 。该列仍会扩展以容纳不包含空格的文本内容。除了将每个 td 的内容包装在 div 中之外，有没有办法解决这个问题？

示例：http: [//jsfiddle.net/6p9K3/29/](http://jsfiddle.net/6p9K3/29/)

```
<table>
    <tbody>
        <tr>
            <td style="width: 50px;">Test</td>
            <td>Testing 1123455</td>
        </tr><tr>
            <td style="width: 50px;">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</td>
            <td>B</td>
        </tr>
    </tbody>
</table>

table
{
    table-layout: fixed;
}

td
{
    border: 1px solid green;
    overflow: hidden;
} 
```

在示例中，您可以看到带有 AAAAAAAAAAAA... 的列虽然被明确设置为 50 像素宽，但仍会扩展。

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2013-03-27T20:26:41.073

指定表格的宽度：

```
table
{
    table-layout: fixed;
    width: 100px;
} 
```

见[jsFiddle](http://jsfiddle.net/m7nfU/)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-03-27T20:22:39.327

尝试查看以下 CSS：

```
word-wrap:break-word; 
```

默认情况下，Web 浏览器不应分解“单词”，因此您所遇到的是浏览器的正常行为。但是，您可以使用 word-wrap CSS 指令覆盖它。

您需要在整个表格上设置宽度，然后在列上设置宽度。“宽度：100%；” 根据您的要求也应该可以。

使用自动换行可能不是您想要的，但它对于显示所有数据而不会使布局变形很有用。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-03-27T20:20:46.950

在css之前使桌子坚如磐石。计算表格的宽度，然后使用“控制”行，其中每个 td 都有一个明确的宽度，所有这些加起来就是表格标签中的宽度。

必须做数百个 html 电子邮件才能在任何地方工作，首先使用正确的 HTML，然后使用 w/css 进行样式设置将解决所有 IE、webkit 和 mozillas 中的许多问题。

所以：

```
<table width="300" cellspacing="0" cellpadding="0">
  <tr>
    <td width="50"></td>
    <td width="100"></td>
    <td width="150"></td>
  </tr>
  <tr>
    <td>your stuff</td>
    <td>your stuff</td>
    <td>your stuff</td>
  </tr>
</table> 
```

将保持一张 300 像素宽的表格。观看极端大于宽度的图像

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-03-27T20:26:06.983

您可以在 中添加一个`div`，`td`然后对其进行样式设置。它应该按您的预期工作。

```
<td><div>AAAAAAAAAAAAAAAAAAA</div></td> 
```

然后是css。

```
td div { width: 50px; overflow: hidden; } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-03-27T20:28:33.247

您还可以使用“溢出：隐藏”或“溢出-x：隐藏”（仅用于宽度）。这需要定义的宽度（和/或高度？），也可能需要一个“显示：块”。

“溢出：隐藏”隐藏了不适合定义框的全部内容。

例子：

[http://jsfiddle.net/NAJvp/](http://jsfiddle.net/NAJvp/)

**HTML：**

```
<table border="1">
    <tr>
        <td><div>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</div></td>
        <td>bbb</td>
        <td>cccc</td>
    </tr>
</table> 
```

**CSS：**

```
td div { width: 100px; overflow-y: hidden; } 
```

编辑：我感到羞耻，我已经看到，你已经使用了“溢出”。我想它不起作用，因为您没有将“显示：块”设置为您的元素......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-02-15T14:45:44.633

您还可以使用百分比，和/或在列标题中指定：

```
<table width="300">  
  <tr>
    <th width="20%">Column 1</th>
    <th width="20%">Column 2</th>
    <th width="20%">Column 3</th>
    <th width="20%">Column 4</th>
    <th width="20%">Column 5</th>
  </tr>
  <tr>
    <!--- row data -->
  </tr>
</table> 
```

百分比的好处是代码维护更少：您可以更改表格宽度而无需重新指定列宽。

警告：据我了解，HTML 5 不支持以像素为单位指定的表格宽度；您需要改用 CSS。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-27T20:20:40.440

我会尝试将其设置为：

```
max-width: 50px; 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2019-05-15T12:42:09.013

这对我有用

```
td::after { 
  content: ''; 
  display: block; 
  width: 30px;
} 
```

# sql-server - 带有插入的 SQL Server 存储过程中的多个 2 字段

> ID：15668585
> 
> 赞同：-2
> 
> 时间：2013-03-27T20:18:09.417
> 
> 标签：sql-server, stored-procedures

重要提示：对于。exp。我在 SQL Server 数据库中有 a、b 和 c 列，我想在 SQL 代码中插入这 3 个值，所以，

我想将 a、b 和多个现有的 a 和 b 字段插入为 c

如何使用存储过程执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:11:07.470

`@c`根本看不到变量的任何原因。

```
CREATE PROCEDURE dbo.MultiplY
  @a INT, @b INT
AS
BEGIN
  SET NOCOUNT ON;

  INSERT dbo.table(a,b,c) SELECT @a, @b, @a * @b;
END
GO 
```

# symfony - Symfony2: permission error with assetic and compass sprite generation

> ID：15668586
> 
> 赞同：2
> 
> 时间：2013-03-27T20:18:13.283
> 
> 标签：symfony, compass-sass, css-sprites, assetic

I just trying to generate a compass image sprite with assetic in symfony 2.2 project. I configured compass filter and i have some .scss files working perfect. But when I try to generate an image sprite and run ./app/console assetic:dump --watch throw an error:

```
[error] An error occurred while running:
'/usr/bin/ruby' '/usr/local/bin/compass' 'compile' '/tmp' '--images-dir' '/home/xuser/desarrollo/www/lab.dev/symfony/app/../web/images' '--config' '/tmp/assetic_compass5atwLN' '--sass-dir' '' '--css-dir' '' '/tmp/assetic_compassiAf1jw.scss'

Error Output:
Errno::EACCES on line 43 of /var/lib/gems/1.8/gems/chunky_png-1.2.7/lib/chunky_png/canvas/png_encoding.rb: Permission denied - /tmp/images/sprite-s8c89b4f1b7.png
Run with --trace to see the full backtrace

Output:
... 
```

I note the sprite is generated fine, but copied in /tmp/images/. I currently I do the same thing in a stand alone compass project and work fine, the issue is throug assetic. Could you help me?

# javascript - need item URL format for sharepoint socialdataservice.asmx

> ID：15668589
> 
> 赞同：1
> 
> 时间：2013-03-27T20:18:25.853
> 
> 标签：javascript, web-services, sharepoint

I am trying to set a list item's rating using SocialDataService.asmx. The POST response indicates success; however, nothing has actually been updated. My guess is that the URL format of the item I am trying to update is somehow not what the web service is expecting. Has anyone had success with this web service/operation?

My code:

attempt 1:

```
var payload = "<url>" + WebFullUrl 
+ "_api/Web/Lists/GetByTitle('Posts')/Items(" + id + ")</url><rating>" 
+ rating + "</rating><title></title><analysisDataEntry></analysisDataEntry>"; 
```

attempt 2:

```
var payload = "<url>" + WebFullUrl 
+ "Lists/Posts/DispForm.aspx?ID=" + id + "</url><rating>" 
+ rating + "</rating><title></title><analysisDataEntry></analysisDataEntry>"; 
```

The call ends up looking like:

```
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
 xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
 xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
<soap:Body>
<SetRating xmlns="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService">
<url>https:// (site url) /Lists/Posts/DispForm.aspx?ID=2</url>
<rating>4</rating>
<title></title>
<analysisDataEntry></analysisDataEntry>
</SetRating>
</soap:Body>
</soap:Envelope> 
```

and the response is:

```
<?xml version="1.0" encoding="utf-8"?><soap:Envelope
xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<soap:Body>
<SetRatingResponse
xmlns="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService">
SetRatingResult>2013-03-27T20:03:33.55</SetRatingResult>
</SetRatingResponse>
</soap:Body>
</soap:Envelope> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:39:03.663

我刚刚在类似情况下所做的是使用[Fiddler](http://fiddler2.com/)或[Firebug](http://getfirebug.com/)并单击 SharePoint 列表中的评级。然后，您可以看到 Microsoft 使用的确切 URL。

# tsql - TSQL：服务器中所有表的行数

> ID：15668590
> 
> 赞同：2
> 
> 时间：2013-03-27T20:18:27.167
> 
> 标签：tsql, sql-server-2008-r2

我正在尝试获取服务器中所有表的行数（不是特定数据库，而是服务器上的所有数据库，不包括 msdb、model、master 等）。除了数据库名称、表名称和行数之外，我不需要返回任何其他详细信息。

我解决这个问题的方法是获取服务器中的所有数据库并在它们上放置一个 id，这将在 while 循环中引用（从 id 开始直到最大 id）。然后，在 while 循环中，我获取匹配数据库 ID 中的表和行数。我的问题是 USE DatabaseName 似乎不允许我使其成为动态的，这意味着我不能将数据库名称存储在变量中，并在执行具有行计数查询的表时将其用作引用的数据库。

是否有另一种我缺少的方法（我查看了许多其他示例 - 经常使用游标，它在代码中似乎更长并且似乎使用更多资源 - 即使我使用，这也是一个相对快速的查询表中最大的数据库，除了它没有命中下一个数据库等等），还是我在代码中遗漏了一些明显的东西来使这个动态？

```
DECLARE @ServerTable TABLE(
    DatabaseID INT IDENTITY(1,1),
    DatabaseName VARCHAR(50)
)

DECLARE @count INT
DECLARE @start INT = 1
SELECT @count = COUNT(*) FROM sys.databases WHERE name NOT IN ('master','tempdb','model','msdb')

INSERT INTO @ServerTable (DatabaseName)
SELECT name 
FROM sys.databases
WHERE name NOT IN ('master','tempdb','model','msdb')

WHILE @start < @count
BEGIN

    DECLARE @db VARCHAR(50)
    SELECT @db = DatabaseName FROM @ServerTable WHERE DatabaseID = @start

    -- This is the problem, as the USE doesn't seem to allow it to be dynamic.
    USE @db
    GO

    SELECT @db
        ,o.name [Name]
        ,ddps.row_count [Row Count]
    FROM sys.indexes AS i
        INNER JOIN sys.objects AS o ON i.OBJECT_ID = o.OBJECT_ID
        INNER JOIN sys.dm_db_partition_stats AS ddps ON i.OBJECT_ID = ddps.OBJECT_ID AND i.index_id = ddps.index_id 
    WHERE i.index_id < 2  AND o.is_ms_shipped = 0 
    ORDER BY o.NAME

    SET @start = @start + 1
END 
```

注意：我尝试检查 sys.objects 和 sys.indexes 以查看是否可以使用数据库名称进行过滤，但我没有运气。

**更新：**我试着把它`SELECT`变成动态的东西，但没有成功（注意下面的代码只显示了变化`SELECT`）：

```
SET @sql = '
    SELECT ' + @db + ' [Database]
        ,o.name [Name]
        ,ddps.row_count [Row Count]
    FROM  ' + @db + '.sys.objects
        INNER JOIN ' + @db + ' sys.objects AS o ON i.OBJECT_ID = o.OBJECT_ID
        INNER JOIN ' + @db + ' sys.dm_db_partition_stats AS ddps ON i.OBJECT_ID = ddps.OBJECT_ID AND i.index_id = ddps.index_id 
    WHERE i.index_id < 2  AND o.is_ms_shipped = 0 
    ORDER BY o.NAME' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:25:47.217

不，这基本上就是你这样做的方式。

我不确定你为什么认为[while 循环比游标快（尽管这是一个常见的误解）](https://sqlblog.org/2012/01/26/bad-habits-to-kick-thinking-a-while-loop-isnt-a-cursor)。它们本质上是一样的。我并不总是使用游标，但当我这样做时，我会使用`LOCAL FAST_FORWARD`- 确保你也这样做。有关更多信息，请参阅这篇文章：

*   [不同的光标选项会产生什么影响？](http://www.sqlperformance.com/2012/09/t-sql-queries/cursor-options)

为了减少像这样的单个任务所需的代码，您可能对`sp_MSforeachdb`我编写的替换感兴趣 (`sp_MSforeachdb`是一个内置的、未记录的和不受支持的存储过程，它将为每个数据库重复一个命令，但是不可能，比如说，过滤掉系统数据库，并且它还有一个严重的错误，有时会停止执行）：

*   [制作更可靠、更灵活的 sp_MSforeachdb](https://www.mssqltips.com/sqlservertip/2201/making-a-more-reliable-and-flexible-spmsforeachdb/?utm_source=AaronBertrand)
*   [在 SQL Server 中的每个数据库的上下文中执行命令](https://www.mssqltips.com/sqlservertip/5694/execute-a-command-in-the-context-of-each-database-in-sql-server--part-2/?utm_source=AaronBertrand)

另一种方法是动态 SQL。

```
DECLARE @sql NVARCHAR(MAX) = N'';

SELECT @sql += '
  SELECT db = N''' + name + '''
    ,o.name [Name]
    ,ddps.row_count [Row Count]
  FROM ' + QUOTENAME(name) + '.sys.indexes AS i
    INNER JOIN ' + QUOTENAME(name) + '.sys.objects AS o 
      ON i.OBJECT_ID = o.OBJECT_ID
    INNER JOIN ' + QUOTENAME(name) + '.sys.dm_db_partition_stats AS ddps 
      ON i.OBJECT_ID = ddps.OBJECT_ID AND i.index_id = ddps.index_id 
    WHERE i.index_id < 2  AND o.is_ms_shipped = 0 
    ORDER BY o.NAME;'
FROM sys.databases 
WHERE database_id > 4;

PRINT @sql;
--EXEC sp_executesql @sql; 
```

（打印在那里，以便您可以在执行之前检查命令。如果您有大量数据库，它可能会在 8K 处被截断，但不要惊慌 - 这只是 SSMS 中的显示问题，命令已完成.)

您也可以先构建一个#temp 表，然后插入其中，这样您就可以使用一个结果集，例如

```
CREATE TABLE #x(db SYSNAME, o SYSNAME, rc SYSNAME);

DECLARE @sql NVARCHAR(MAX) = N'';

SELECT @sql += 'INSERT #x(db,o,rc)
  SELECT db = N''' + name + '''
    ,o.name [Name]
    ,ddps.row_count [Row Count]
  FROM ' + QUOTENAME(name) + '.sys.indexes AS i
    INNER JOIN ' + QUOTENAME(name) + '.sys.objects AS o 
      ON i.OBJECT_ID = o.OBJECT_ID
    INNER JOIN ' + QUOTENAME(name) + '.sys.dm_db_partition_stats AS ddps 
      ON i.OBJECT_ID = ddps.OBJECT_ID AND i.index_id = ddps.index_id 
    WHERE i.index_id < 2  AND o.is_ms_shipped = 0 
    ORDER BY o.NAME;'
FROM sys.databases 
WHERE database_id > 4;

EXEC sp_executesql @sql;

SELECT db, o, rc FROM #x ORDER BY db, o; 
```

现在，不要误以为这也不是在使用游标或循环——它是。但它是在循环中构建命令，而不是在循环中执行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:27:56.163

就您进行动态查询而言，而不是使用 using，您可以使用您选择的`@db`变量为您的表名创建一个完全限定的名称。

所以它会是`'FROM ' + @db+'.sys.objects'`等等。

您必须检查您的数据库名称是否有效（例如，如果您的名称由于某种原因需要括号）。

# python - Python：更新线程中的参数

> ID：15668591
> 
> 赞同：4
> 
> 时间：2013-03-27T20:18:28.393
> 
> 标签：python, multithreading

我想知道当这个参数在程序的主程序中获得一个新值时，是否可以启动一个新线程并更新它的参数，所以像这样：

```
i = 0

def foo(i):
    print i
    time.sleep(5)

thread.start_new_thread(foo,(i,))

while True:
    i = i+1 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:25:41.953

参数只是一个值，就像其他任何东西一样。传递该值只会对相同的值进行新的引用，如果您改变该值，每个引用都会看到它。

全局变量和函数参数具有相同名称的事实在这里无关紧要，并且有点令人困惑，因此我将重命名其中一个。此外，您的`foo`函数只执行`print`一次（可能在您增加值之前），然后休眠 5 秒，然后完成。你可能想要一个循环；否则，您实际上无法判断事情是否正常。

所以，这里有一个例子：

```
i = []

def foo(j):
    while True:
        print j
        time.sleep(5)

thread.start_new_thread(foo,(i,))

while True:
    i.append(1) 
```

那么，为什么您的代码不起作用？好吧，`i = i+1`不是改变 value `0`，而是将*新*值 ,分配`0 + 1`给`i`。该`foo`函数仍然具有对`0`未更改的旧值的引用。

由于整数是不可变的，所以不能*直接*解决这个问题。但是你可以很容易地*间接*解决它：用某种可变的包装*器替换整数。*

例如，您可以使用`set`和`get`方法编写一个 IntegerHolder 类；当您`i.set(i.get() + 1)`和其他参考这样做`i.get()`时，它将看到新值。

或者您可以只使用 a`list`作为支架。列表是可变的，并且包含零个或多个元素。当您这样做时`i[0] = i[0] + 1`，它将替换`i[0]`为一个新的整数值，但`i`仍然是相同的列表值，这就是另一个引用所指向的内容。所以：

```
i = [0]

def foo(j):
    print j[0]
    time.sleep(5)

thread.start_new_thread(foo,(i,))

while True:
    i[0] = i[0]+1 
```

这可能看起来有点 hacky，但它实际上是一个非常常见的 Python 习惯用法。

* * *

同时，在另一个线程中运行的事实`foo`产生了另一个问题。

理论上，线程同时运行，它们之间的任何数据访问都没有顺序。您的主线程可能在核心 0 上运行，并处理`i`核心 0 缓存中的副本，而您的`foo`线程在核心 1 上运行，并处理核心 1 缓存中的不同副本，`i`您的强制缓存同步的代码。

在实践中，您通常会侥幸逃脱，尤其是在 CPython 中。但是要真正*知道什么*时候可以摆脱它，你必须了解全局解释器锁是如何工作的，解释器如何处理变量，（在某些情况下）甚至你的平台的缓存一致性和你的 C 实现的内存模型等等在工作。所以，你不应该依赖它。正确的做法是使用某种同步机制来保护对`i`.

作为旁注，您也应该几乎永远不要使用`thread`代替`threading`，所以我也将切换它。

```
i = []
lock = threading.Lock()

def foo(j):
    while True:
        with lock:
            print j[0]
        time.sleep(5)

t = threading.Thread(target=foo, args=(i,))
t.start()

while True:
    with lock:
        i[0] = i[0]+1 
```

* * *

最后一件事：如果你创建了一个线程，你以后需要`join`它，否则你不能干净地退出。但是你的`foo`线程永远不会退出，所以如果你尝试`join`它，你将永远阻塞。

对于像这样的简单情况，有一个简单的解决方案。在打电话之前`t.start()`，做`t.daemon = True`。这意味着当您的主线程退出时，后台线程将在某个任意点自动终止。如果是写入文件或数据库，这显然是一件坏事。但在你的情况下，它并没有做任何持久或危险的事情。

对于更实际的情况，您通常希望创建某种方式在两个线程之间发出信号。通常你已经有一些东西让线程等待——a `Queue`、文件对象或它们的集合（通过`select`）等。如果没有，只需创建一个受锁保护的标志变量（或条件或任何适当的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:28:24.180

尝试全局变量。

```
i = 0

def foo():
    print i
    time.sleep(5)

thread.start_new_thread(foo,())

while True:
    i = i+1 
```

您还可以传递包含所需变量的哈希。

```
args = {'i' : 0}

def foo(args):
    print args['i']
    time.sleep(5)

thread.start_new_thread(foo,(args,))

while True:
    args['i'] = arg['i'] + 1 
```

您可能还想使用线程锁。

```
import thread

lock = thread.allocate_lock()
args = {'i' : 0}

def foo(args):
    with lock:
        print args['i']
    time.sleep(5)

thread.start_new_thread(foo,(args,))

while True:
    with lock:
        args['i'] = arg['i'] + 1 
```

希望这有帮助。

# python - oauth2client/appengine.py 使用 webapp2/python27/wsgi 返回“InvalidResponseError: header values must be str, got 'unicode'”

> ID：15668592
> 
> 赞同：5
> 
> 时间：2013-03-27T20:18:30.117
> 
> 标签：python, google-app-engine, oauth-2.0

事先，我的问题类似于[*App Engine 上的 Pyramid gets "InvalidResponseError: header values must be str, got 'unicode'*](https://stackoverflow.com/questions/9934923/pyramid-on-app-engine-gets-invalidresponseerror-header-values-must-be-str-got)和几个[google-api-python-client bugs](http://code.google.com/p/google-api-python-client/issues/list)，但对我的情况没有帮助。另外，我没有回答[问题 #254](http://code.google.com/p/google-api-python-client/issues/detail?id=254)（它本身看起来类似于[#111](http://code.google.com/p/google-api-python-client/issues/detail?id=111)，所以我在这里尝试。

[在本地 GAE 上，下面的简单示例（此示例](http://code.google.com/p/google-api-python-client/source/browse/samples/appengine/main.py)的简化和 python27 化版本）返回`InvalidResponseError: header values must be str, got 'unicode'`，尽管我的代码*没有*进行任何 unicode 标头设置。更准确地说，我期待 result `Hello`，但我有：

```
Internal Server Error
    The server has either erred or is incapable of performing the requested operation.
    Traceback (most recent call last):
      File "/home/ronj/.gae/lib/webapp2-2.5.2/webapp2.py", line 1546, in __call__
        return response(environ, start_response)
      File "/home/ronj/.gae/lib/webob_0_9/webob/__init__.py", line 2000, in __call__
        start_response(self.status, self.headerlist)
      File "/home/ronj/.gae/google/appengine/runtime/wsgi.py", line 156, in _StartResponse
        (_GetTypeName(value), value, name))
    InvalidResponseError: header values must be str, got 'unicode' (u'https://accounts.google.com/o/oauth2/auth?state=http%3A%2F%2Flocalhost%3A8080%2F&redirect_uri=http%3A%2F%2Flocalhost%3A8080%2Foauth2callback&response_type=code&client_id=xxxxxxxxxxxx.apps.googleusercontent.com&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fyoutube&access_type=offline') for 'Location' 
```

任何的想法？我在 Ubuntu 12.10 x64 上的 Python 2.7.3 上使用 GAE 1.7.5。

**编辑**：乔纳斯在[问题 #254](http://code.google.com/p/google-api-python-client/issues/detail?id=254)中提供了一个答案：*“在 OAuth2WebServerFlow 上生成 URL 的方法中添加一些 str() 应该相对容易。在 oauth2client/client.py 中的第 830 行返回之前用 str() 包装”*。
→ 看起来不错，但我应该如何实现呢？我同意我可以在我安装了 GAE 的本地计算机上修改文件，但是一旦部署，它将使用 Google 的 GAE，对吗？我怎样才能覆盖它？（很抱歉新手的问题）

谢谢你的帮助！

* * *

**应用程序.yaml**：

```
application: yourapp
version: 1
runtime: python27
api_version: 1
threadsafe: true

handlers:

- url: /
  script: yourapp.main

libraries:
- name: webapp2
  version: latest 
```

* * *

**你的应用程序.py**：

```
import webapp2, os, httplib2
from apiclient.discovery import build
from oauth2client.appengine import oauth2decorator_from_clientsecrets
from google.appengine.api import memcache

CLIENT_SECRETS = os.path.join(os.path.dirname(__file__), 'client_secrets.json')
MISSING_CLIENT_SECRETS_MESSAGE = "Warning: Please configure OAuth 2.0"
YOUTUBE_READ_WRITE_SCOPE = "https://www.googleapis.com/auth/youtube"
YOUTUBE_API_SERVICE_NAME = "youtube"
YOUTUBE_API_VERSION = "v3"

http = httplib2.Http(memcache)
youtube = build(YOUTUBE_API_SERVICE_NAME, YOUTUBE_API_VERSION, http=http)
decorator = oauth2decorator_from_clientsecrets(
    CLIENT_SECRETS,
    scope=YOUTUBE_READ_WRITE_SCOPE,
    message=MISSING_CLIENT_SECRETS_MESSAGE)

class MainPage(webapp2.RequestHandler):

  @decorator.oauth_required
  def get(self):
    self.response.headers['Content-Type'] = 'text/plain'
    self.response.write('Hello')

main = webapp2.WSGIApplication([('/', MainPage)], debug=True) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-06T13:38:25.413

即使我已经在使用最新版本的 apiclient，我也遇到了同样的问题。

对我来说解决此问题的答案已发布在问题跟踪器中[http://code.google.com/p/google-api-python-client/issues/detail?id=254](http://code.google.com/p/google-api-python-client/issues/detail?id=254)

不工作

```
flow = client.flow_from_clientsecrets(CLIENT_SECRETS,scope=scopes)
callback = self.request.relative_url('/oauth2callback')
auth_url = flow.step1_get_authorize_url(callback)
return self.redirect(auth_url) 
```

在职的

```
flow = client.flow_from_clientsecrets(CLIENT_SECRETS,scope=scopes)
callback = self.request.relative_url('/oauth2callback')
auth_url = str(flow.step1_get_authorize_url(callback))
return self.redirect(auth_url) 
```

注意包装 flow.step1_get_authorize_url 调用的 str()

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-09T05:36:12.987

另一个答案...添加 str() 解决了问题，但不是根本原因。我花了几个小时试图弄清楚为什么一个特定的重定向会引发这个错误，而其他的却没有，然后才注意到错误重定向的 URL 缺少初始的“/”。

我不知道*为什么*会这样 - 可能不完整的路径与完整路径的处理方式不同。但是，如果您遇到此错误，请尝试更改：

```
self.redirect('home.view') 
```

到：

```
self.redirect('/home.view') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-29T22:23:52.100

我使用的是 GAE 的捆绑版本的 python API，显然不应该这样做。`google-api-python-client-1.1`在项目[下载页面](https://code.google.com/p/google-api-python-client/downloads/list)上安装托管后，一切都按预期工作。

# c# - 使用 SharpSSH 时出现身份验证失败错误

> ID：15668595
> 
> 赞同：4
> 
> 时间：2013-03-27T20:18:42.100
> 
> 标签：c#, .net, ssh, putty, sharpssh

我正在尝试`Solaris/Unix`使用`C#`类连接到服务器以读取系统信息/配置、内存使用情况等。

我的要求是从 C# 应用程序（**就像我们使用`PuTTY`客户端**一样）在服务器上运行命令，并将响应存储在`string`变量中以供以后处理。

经过一番研究，我发现**`SharpSSH`**库可以用来做同样的事情。

当我尝试运行我的代码时，以下行给了我一个**`Auth Fail`异常**。我确信凭据（服务器名称、用户名和密码）是正确的，因为我能够`PuTTY`使用相同的凭据从客户端登录。

```
SshStream ssh = new SshStream(servername, username, password); 
```

我究竟做错了什么？

如果有帮助，以下是堆栈跟踪！

```
at Tamir.SharpSsh.jsch.Session.connect(Int32 connectTimeout)  
at Tamir.SharpSsh.jsch.Session.connect()  
at Tamir.SharpSsh.SshStream..ctor(String host, String username, String password) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T20:00:38.833

经过一番研究，我发现了一个 VB 代码，它为我指明了正确的方向。似乎为`KeyboardInteractiveAuthenticationMethod`帮助解决这个问题添加了一个额外的事件处理程序。希望这对其他人有帮助。

```
void HandleKeyEvent(Object sender, AuthenticationPromptEventArgs e)
    {
        foreach (AuthenticationPrompt prompt in e.Prompts)
        {
            if (prompt.Request.IndexOf("Password:", StringComparison.InvariantCultureIgnoreCase) != -1)
            {
                prompt.Response = password;
            }
        }
    }

private bool connectToServer()
{
    try
    {
        KeyboardInteractiveAuthenticationMethod kauth = new KeyboardInteractiveAuthenticationMethod(username);
        PasswordAuthenticationMethod pauth = new PasswordAuthenticationMethod(username, password);
        kauth.AuthenticationPrompt += new EventHandler<AuthenticationPromptEventArgs>(HandleKeyEvent);

        ConnectionInfo connectionInfo = new ConnectionInfo(serverName, port, username, pauth, kauth);

        sshClient = new SshClient(connectionInfo);
        sshClient.Connect();
        return true;
        }
    catch (Exception ex)
    {
        if (null != sshClient && sshClient.IsConnected)
        {
            sshClient.Disconnect();
        }
        throw ex;
    }
} 
```

# android - Android 更改每个片段的 setNavigationMode 会使应用程序崩溃

> ID：15668597
> 
> 赞同：2
> 
> 时间：2013-03-27T20:18:44.413
> 
> 标签：android, android-actionbar

我创建了以下项目，因此您可以查看我的确切代码以及发生了什么： [https ://github.com/CorradoDev/TabsTest/commit/8f054dab2371b791c4061ceb511413f720f65d67](https://github.com/CorradoDev/TabsTest/commit/8f054dab2371b791c4061ceb511413f720f65d67)

基本上我想要做的是隐藏某些页面的标签并在其他页面中显示它们。

下面是我用来显示 onresume 中的选项卡的代码

```
 if(getActivity().getActionBar().getNavigationMode()==ActionBar.NAVIGATION_MODE_STANDARD){
        getActivity().getActionBar().setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
    } 
```

然后隐藏我在简历上执行以下操作的选项卡：

```
 getActivity().getActionBar().setNavigationMode(ActionBar.NAVIGATION_MODE_STANDARD); 
```

当我在第一个片段上时（backstack 中没有任何内容）。我可以显示和隐藏第二个标签。它有时会在更改选项卡时出错。

当我在后台堆栈的第二个片段上时，我隐藏了第三个片段。我看到第二个和第三个片段都调用了 onrefresh 但第三个片段没有显示。

我对正在发生的事情以及为什么这并不容易感到困惑。

下面是我通常得到的错误 03-27 15:26:31.029: E/AndroidRuntime(5505): java.lang.IllegalStateException: Fragment already added: Fragment3{41f2e390 #2 id=0x1020002 fragment3}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T21:12:04.640

我仍然想知道为什么上述方法不起作用。但我的解决方法是使用片段而不是选项卡创建另一个活动。这似乎运作良好。但是如果他们不打算让您更改标签并且每个片段没有标签，我很感兴趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-01T15:54:44.247

我有类似的情况 - 只是我使用`NAVIGATION_MODE_LIST`而不是标签。当我从另一个片段调用片段时遇到类似的问题，例如单击列表项打开项目详细信息。

现在我从主要活动中调用所有片段，这允许我控制操作栏的设置。每当导航列表消失时，我只在调用`NAVIGATION_MODE_STANDARD`片段时调用`NAVIGATION_MODE_LIST`其他片段。

# javascript - 如何替换除第一个字符之外的所有单个字符

> ID：15668606
> 
> 赞同：2
> 
> 时间：2013-03-27T20:19:07.123
> 
> 标签：javascript, jquery, ajax, url

我需要替换除第一个字符之外的所有单个字符。因为我使用的是我用 Python 编写的服务器。我总是在 Url 上传递的信息。网址是：

```
http://localhost:8100/index2?decode=demo_title=Demo+title&proc1_script=script.sh+parameters&inputp3_id=pepepe&outputp2_value=&demo_input_description=hola+mundo&outputp4_visible=on&inputdata1_max_pixels=1024000&inputdata1_image_depth=1x8i&tag=&outputp1_id=nanana&proc1_src_compresion=zip&outputp3_description=&inputp1_type=text&inputdata1_description=input+data+description&inputp2_description=bien%3F&inputp3_description=funciona&outputp3_type=header&outputp2_visible=on&outputp3_visible=on&outputp1_type=header&outputp3_value=&demo_params_description=va+bien&demo_result_description=win%3F&outputp1_description=&inputdata1_type=image2d&inputp1_value=si&proc1_chk_script=off&outputp4_info=&outputp2_id=nanfdsvfa&inputp1_description=funciona&demo_wait_description=boh&outputp4_description=&inputp2_id=papapa&inputdata1_id=id_lsd&inputp1_visible=on&proc1_chk_cmake=off&proc1_cmake=-D+CMAKE_BUILD_TYPE%3Astring%3DRelease+&inputp3_visible=+off&outputp1_visible=on&outputp1_value=&outputp4_value=&inputp2_visible=on&proc1_source=lsd-1.5.zip&inputp3_value=si&proc1_make=-j4+-C+&images_config_file=cfgmydemo.cfg&outputp2_type=header&proc1_subdir=xxx-1.5&proc1_chk_make=on&inputp1_id=popopo&proc1_url=http%3A%2F%2Fwww.ipol.im%2Fpub%2Falgo%2F...&inputp2_value=no&demo_data_filename=data_saved.cfg&inputdata1_info=info_lsd&outputp3_info=&inputdata1_image_format=.pgm&inputdata1_compress=False&outputp1_info=&outputp3_id=nananartrtrt&inputp2_type=integer&proc1_id=lsd&inputp3_type=float&outputp2_description=&outputp4_type=header&outputp2_info=&outputp4_id=nana&tag=&inputp4_id=popopo&inputp4_type=text&inputp4_description=cddc&inputp4_value=sdlk&inputp4_info=dsl 
```

现在我有这个问题，第一个字符在 URL 上很重要，不必替换。

这是我用于替换 Javascript 中所有字符的脚本：

```
var $fm = $("#formparam");
                $.get($fm.attr('${nextstep}'))
                    .done(function(data, ok){
                    var fr=$fm.serialize();
                    fr=fr.replace(/\&/g,"+%23+");
                    fr=fr.replace(/\=/g,"%24+");
                    alert('call done: ' +fr);
                    // data is the content of the response
                    document.location.href+="index2?"+fr})
                    .fail(function(data){
                    alert('call failed');
                    // call failed for some reason -- add error messaging?
                    }); 
```

以及如何更改脚本以不替换第一个 = ？

更新：

我想更改所有单个字符 = 而不是第一个。

例子

前

```
some=string=here=more_people 
```

后

```
some=string_here_more_people 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:34:52.130

我认为这应该可以解决问题：

```
function replacew(str,pattern,value){
    int index=str.search(pattern);
    return str.substr(0,index+1)+str.substr(index+1).replace(pattern,value);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T20:58:30.457

[http://jsfiddle.net/EarUc/5/](http://jsfiddle.net/EarUc/5/)

从一些字符串开始（empieza con alguna `string`）

```
var str1 = "=moo=kie="; 
```

调用函数：（llame la funcion）

```
alert(replaceButFirst(str1, "=")); 
```

包括以下要使用的代码：（incluya el codigo siguiente para usarlo）

```
function replaceButFirst(strOriginal, strToReplace){

var n=strOriginal.indexOf(strToReplace);
var firstPart = strOriginal.substring(0, n + 1);
    var tempString = strOriginal.substring(n + 1);
tempString = tempString.replaceAll(strToReplace, "");

return firstPart + tempString;

} 
```

函数的原始使用可以在[这里找到](http://dumpsite.com/forum/index.php?topic=4.msg8#msg8)

```
String.prototype.replaceAll = function(str1, str2, ignore) 
{
    return this.replace(new RegExp(str1.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),(ignore?"gi":"g")),(typeof(str2)=="string")?str2.replace(/\$/g,"$$$$"):str2);
} 
```

# python - getPass() 在 Eclipse 中回显密码

> ID：15668607
> 
> 赞同：5
> 
> 时间：2013-03-27T20:19:10.270
> 
> 标签：python, eclipse, python-2.7, pydev

嘿，大家都刚刚开始涉足一点 Python 来帮助处理一些工作中的脚本，但我似乎对一个小问题感到困惑。

我将 Eclipse 与 pydev 一起用于我的开发平台并针对 python 2.7.3 进行开发。我只是想提示用户输入密码，使用：

```
password = getpass.getpass() 
```

在终端/命令提示符下运行时，该行按预期工作，但是当我在 Eclipse 控制台中运行时，用户的输入并没有像应有的那样隐藏。任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T20:25:45.070

这是记录在案的行为 - 某些终端无法进行无回声输入，在这种情况下，它应该给出警告：

> 如果无回显输入不可用，getpass() 回退到打印警告消息以流式传输并从 sys.stdin 读取并发出 GetPassWarning。

[从`getpass.getpass()`](http://docs.python.org/3/library/getpass.html#getpass.getpass).

# jquery - 文档准备好后，jQuery width() 立即不正确？

> ID：15668611
> 
> 赞同：7
> 
> 时间：2013-03-27T20:19:25.057
> 
> 标签：jquery, html, wordpress, jquery-selectors

出于某种原因`$("...").width()`，在文档准备好后立即返回错误的值。

我看到了这些值：

文件准备好后立即：

```
$(document).ready(function(){
  $("li.active a").width() //returns 76 - incorrect
});

$(document).ready(function(){
  $(window).load(function(){
    $("li.active a").width() //returns 59 - the correct value
  });
});

$(document).ready(function(){
  setTimeout(function(){
    $("li.active a").width() //returns 59 - the correct value
  }, 100);
}); 
```

我正在获取 wordpress 菜单项的宽度并调整它们的大小，以便它们始终适合我的响应式设计。没有应该导致此更改的图像或资产。

**更新** 见下面我的评论。原来有一个资产，一种嵌入的字体，需要一秒钟才能加载。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-27T20:21:11.893

这可能与`$(window).load`第一个示例中的缺少有关。

> “当加载 HTML 文档并且 DOM 准备就绪时，**文档就绪**事件已经执行，即使尚未加载所有图形。如果您想在窗口加载之前为某些元素连接事件，那么 $(文件）。准备好是正确的地方。” *

```
$(document).ready(function() {
 // executes when HTML-Document is loaded and DOM is ready
 alert("document is ready");
}); 
```

* * *

> “**窗口加载**事件在整个页面完全加载后执行，包括所有框架、对象和图像。因此，涉及图像或其他页面内容的函数应放置在窗口或内容标签本身的加载事件中。 " *

```
$(window).load(function() {
 // executes when complete page is fully loaded (all frames, objects and images)
 alert("window is loaded");
}); 
```

**报价来自[4loc](http://4loc.wordpress.com/2009/04/28/documentready-vs-windowload/)。*

# excel - 将今天的数据与同一天/同一时间但前一周的数据进行比较

> ID：15668612
> 
> 赞同：2
> 
> 时间：2013-03-27T20:19:35.113
> 
> 标签：excel, date, excel-formula

对于给定的样本数据，我需要一个公式来找出 E2-E7 之间的差异，它将今天的每小时数据与前一周的确切时间进行比较。

PS`3/27 11.00 AM`必须`3/20 11.00 AM`与 11.00 PM 进行比较。

```
       CDEFGH
第 1 行日期时间 X1 X2 X3 X4
第 2 行 3/27 上午 11:00 760197 408260 359812 77.55%
第 3 行 3/27 上午 10:00 758371 369609 326323 78.00%
第 4 行 3/27 上午 9:00 756123 313521 278248 78.31%
第 5 行 3/27 上午 8:00 753097 232591 206849 78.26%
第 6 行 3/21 晚上 11:00 760197 408260 359812 77.55%
第 7 行 3/21 上午 11:00 760197 408260 359812 77.55%

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:55:33.607

结合日期和时间（比如在 ColumnA 中）并在 Row2 中使用：

`=IFERROR(E2-VLOOKUP(A2-7,A:E,5,FALSE),"")`

根据需要复制下来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T21:46:13.190

这是一个解决方案的说明，当然可以简化。

但也许你可以使用它...

![在此处输入图像描述](../Images/fd7d86cef654f8e5b42319bc828173e1.png)

如您所见，使用的公式是：

```
=C2&D2  
=C2-DAY(7)   
=J2&D2  
=MATCH(K2,I:I,0)    
=E2-INDIRECT("E"&L2) 
```

希望能帮助到你。

# c# - 我是否需要管理员权限才能使用证书？

> ID：15668613
> 
> 赞同：-2
> 
> 时间：2013-03-27T20:19:35.823
> 
> 标签：c#, certificate, admin

用户是否需要管理员权限才能使用证书？例如，如果我是非管理员用户，当我运行一些代码来存储证书时，我会遇到什么问题吗？

我看到枚举 StoreName 有许多枚举值，其中一个是 My。我想知道使用 StoreName.My 是否允许我的代码同时适用于管理员和非管理员用户。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T17:58:11.093

您可以作为标准用户使用证书，但您可能希望使用证书实现一些非管理员无法完成的任务。

正如您正确提示的那样，您可以访问两个商店：我的（mmc 插件中的个人）和机器。

您可以在 My 中执行所有操作，并且可以在 Machine 中读取所有证书公钥。如果要为 IIS 工作进程安装证书，则必须在机器存储中进行。这将要求您成为管理员。

您还应该知道，大多数与加密相关的任务都需要该进程可以读取证书私钥。在这些情况下，证书应安装在机器/个人中，之后应授予正确的进程访问私钥。

# ios - 具有多个子类 UICollectionViewCell 的 UICollectionView

> ID：15668616
> 
> 赞同：9
> 
> 时间：2013-03-27T20:19:50.843
> 
> 标签：ios, objective-c, nsfetchedresultscontroller, uicollectionview, magicalrecord

我的 UICollectionView 中有多个按“datasetType”分组的部分。

我还为每个部分定制了一个 UICollectionViewCell。

如何确定方法`UICollectionViewCell`中需要的自定义`cellForItemAtIndexPath`项？

我的第一个虽然是基于`[sectionInfo name]`：

```
id sectionInfo = [[self.fetchedResultsController sections] objectAtIndex:indexPath.section];

if ([[sectionInfo name] isEqualToString:@"DatasetA"]) {
    DatasetACell *datasetACell = [collectionView dequeueReusableCellWithReuseIdentifier:datasetACellIdentifer forIndexPath:indexPath];

    DatasetA *datasetA = [self.fetchedResultsController objectAtIndexPath:indexPath];
} 
```

但是我遇到了一个问题，它试图加载错误的数据集单元。

这是否可行，我需要在其他地方寻找错误？还是我做错了这部分？

编辑：

我所拥有的应该工作。问题是索引不对齐。

对于我的 fetchedResultsController，我将其创建为：

```
_fetchedResultsController = [Dataset MR_fetchAllSortedBy:NAME
                                               ascending:TRUE
                                           withPredicate:predicate
                                                 groupBy:@"datasetType"
                                                delegate:self.fetchedResultsController.delegate
                                               inContext:[NSManagedObjectContext MR_contextForCurrentThread]]; 
```

这会获取它们并按名称对它们进行排序。我在项目中使用 Magical Record，并使用它的 fetch 控制器，因为我无法让 Core Data fetch 控制器工作：

```
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];

NSEntityDescription *entity = [NSEntityDescription entityForName:@"Dataset" inManagedObjectContext:[NSManagedObjectContext MR_contextForCurrentThread]];

[fetchRequest setEntity:entity];

NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:NAME ascending:TRUE selector:@selector(caseInsensitiveCompare:)];
NSArray *sortDescriptors = [NSArray arrayWithObjects:sortDescriptor, nil];

[fetchRequest setSortDescriptors:sortDescriptors];

NSError *error;

NSArray *fetchedArray = [[NSManagedObjectContext MR_contextForCurrentThread] executeFetchRequest:fetchRequest error:&error];
NSLog(@"fetchedArray: %@", fetchedArray);

NSFetchedResultsController *FRC = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:[NSManagedObjectContext MR_contextForCurrentThread] sectionNameKeyPath:nil cacheName:nil];
FRC.delegate = self; 
```

我在这段代码中执行的 fetchRequest 返回实体，一旦我将它通过 fetch 控制器，它总是不返回任何内容。我不认为它喜欢 MR 的上下文。/惊奇

当我尝试填充每个子类`UICollectionViewCell`（DatasetACell、DataseetBCell 等）时，它可能会检索到错误的数据单元格。

所以在 indexPath (0,0) 处，在`NSFetchedResultsController`

```
[self.fetchedResultsController sections] objectAtIndex:indexPath] 
```

将返回一个 datasetA 实体，而同一索引的集合视图

```
[collectionView dequeueReusableCellWithReuseIdentifier:datasetACell forIndexPath:indexPath] 
```

返回一个数据集BCell。

`NSFetchedResultsController`已排序`[collectionView dequeueResuableCellwithReuseIdentifier:forIndexPath]`但未排序时存在问题。

完整代码：

```
-(NSFetchedResultsController *)fetchedResultsController {
    if (_fetchedResultsController != nil) {
        return _fetchedResultsController;
    }

    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"boundary.boundaryID == %@", self.dataseter.boundaryID];

    _fetchedResultsController = [Dataset MR_fetchAllSortedBy:NAME
                                                   ascending:TRUE
                                               withPredicate:predicate
                                                     groupBy:@"datasetType"
                                                    delegate:_fetchedResultsController.delegate
                                                   inContext:[NSManagedObjectContext MR_contextForCurrentThread]];

    return _fetchedResultsController;
}

-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath {

    id sectionInfo = [[self.fetchedResultsController sections] objectAtIndex:indexPath.section];
    NSLog(@"indexPath: %@", indexPath);
    NSLog(@"[sectionInfo name]: %@", [sectionInfo name]);

    if ([[sectionInfo name] isEqualToString:SAVED_ANALYSIS]) {
        NSLog(@"section name is DATASET A");

        DatasetCellA *datasetCellA = (DatasetCellA *)[collectionView dequeueReusableCellWithReuseIdentifier:datasetcellAIdentifier forIndexPath:indexPath];

        DatasetA *datasetA = [self.fetchedResultsController objectAtIndexPath:indexPath];
        NSLog(@"datasetA.id: %@", datasetA.id);
        NSLog(@"datasetA: %@", datasetA);

        // configure and return cell
    }
    else if ([[sectionInfo name] isEqualToString:EDITED_IMAGES]) {
        NSLog(@"section name is DATASET B");

        DatasetCellB *datasetCellB = (DatasetCellB *)[collectionView dequeueReusableCellWithReuseIdentifier:datasetCellBIdentifer forIndexPath:indexPath];

        DatasetB *datasetB = [self.fetchedResultsController objectAtIndex:indexPath];
        NSLog(@"editedImage.id: %@", datasetB.id);
    NSLog(@"editedImage: %@", datasetB);

        // configure and return cell
    }
} 
```

日志：

```
2013-04-04 10:59:38.697 [2380:14003] indexPath: <NSIndexPath 0x19b645c0> 2 indexes [0, 0]
2013-04-04 10:59:38.697 [2380:14003] [sectionInfo name]: Dataset B
2013-04-04 10:59:38.697 [2380:14003] section name is DATASET B
2013-04-04 10:59:38.702 [2380:14003] datasetB.id: 1581
2013-04-04 10:59:38.703 [2380:14003] datasetB: <DatasetA: 0x1c193ac0> (entity: DatasetA; id: 0x16141bd0 <x-coredata://9313C8D3-0AA8-4F3F-B32D-F1F7843D4FA1/DatasetA/p168> ; data: {

})
2013-04-04 10:59:38.703 [2380:14003] indexPath: <NSIndexPath 0x19b64560> 2 indexes [1, 0]
2013-04-04 10:59:38.703 [2380:14003] [sectionInfo name]: Dataset A
2013-04-04 10:59:38.704 [2380:14003] section name is DATSET A
2013-04-04 10:59:38.709 [2380:14003] datasetA.id: 75
2013-04-04 10:59:38.709 [2380:14003] datasetA: <DatasetB: 0x1c15a830> (entity: DatasetB; id: 0x16141b30 <x-coredata://9313C8D3-0AA8-4F3F-B32D-F1F7843D4FA1/DatasetB/p165> ; data: {

})
2013-04-04 10:59:38.724 [2380:14003] -[DatasetB mode]: unrecognized selector sent to instance 0x1c15a830
2013-04-04 10:59:38.725 [2380:14003] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[DatasetB mode]: unrecognized selector sent to instance 0x1c15a830'
*** First throw call stack:
(0x1c19012 0x1a3ee7e 0x1ca44bd 0x1c08bbc 0x1c0894e 0x80028 0xe862da 0xe878f4 0xe89b91 0x9d32dd 0x1a526b0 0x56cfc0 0x56133c 0x561150 0x4df0bc 0x4e0227 0x4e08e2 0x1be1afe 0x1be1a3d 0x1bbf7c2 0x1bbef44 0x1bbee1b 0x28cc7e3 0x28cc668 0x982ffc 0x1ebd 0x1de5)
libc++abi.dylib: terminate called throwing an exception 
```

对于第一个索引（0,0），代码认为它是DatasetB，但实际上是DatasetA。在第二个索引 (1,0) 中相反；代码认为它是一个DatasetA，但它是一个DatasetB。在这个集合中，有 1 个 DatasetB 和许多 DatasetA。

当 fetch 控制器对其进行排序时，它首先对 Dataset B 进行排序。集合视图需要一个 DatasetB，但 fetch 控制器正在为同一索引返回一个 DatasetA。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T21:27:17.033

似乎需要排序的排序存在问题。

但我的问题是你为什么要打开部分名称？为什么不直接打开项目的类？

```
id object = [self.fetchedResultsController objectAtIndexPath:indexPath];

if ([object isKindOfClass:[DatasetA class]] {
  // Do your DatasetCellA stuff
} else if ([object isKindOfClass:[DatasetB class]) {
  // Do your DatasetCellB stuff
} 
```

至少这样你就不会遇到排序问题

您可能想要更正您的 fetch 请求，以便您按`datasetType`然后按`name`.

```
- (NSFetchedResultsController *)fetchedResultsController
{
  if (!_fetchedResultsController) {
    return _fetchedResultsController;
  }

  NSFetchRequest *request = [[NSFetchRequest alloc] init];
  request.entity          = [Dataset MR_entityDescription];
  request.sortDescriptors = @[
                            [NSSortDescriptor sortDescriptorWithKey:@"datasetType" ascending:YES],
                            [NSSortDescriptor sortDescriptorWithKey:@"name" ascending:NO],
                            ];

  _fetchedResultsController = 
    [[NSFetchedResultsController alloc] initWithFetchRequest:request
                                        managedObjectContext:[NSManagedObjectContext MR_context]
                                          sectionNameKeyPath:@"datasetType"
                                                   cacheName:nil];

  NSError *error = nil;
  if (![_fetchedResultsController performFetch:&error]) {
    NSLog(@"Could not perform fetch %@", [error localizedDescription]);
  }

  _fetchedResultsController.delegate = <..your delegate..>;

  return _fetchedResultsController;
} 
```

* * *

另外，您自己制作的`fetchResultsController`可能什么也没返回的原因是因为您自己没有使用 fetch 请求执行 fetch，而是通过 fetchedResultsController 来执行

```
if ([fetchedResultsController performFetch:&error]) {
   //... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T04:06:56.713

如果没有更多关于模型结构的知识，我无法确定，但是这里......

我认为您的问题是您希望搜索结果以某种方式排序，但它们并没有按照您期望的方式排序。

数据集使用了一个`groupBy:@"datasetType"`子句，它定义了这些部分。但是这些部分也将`groupBy`按键隐式排序。所以问题是：

你的模型中的这个`datasetType`键是什么，它是你期望的吗？显然您想按数据集名称排序，但`datasetType`名称是什么？这就是我认为问题所在。您正在检索错误的排序顺序，因为您没有按数据集的名称进行分组。

PS：您有“DATSET A”和“DATASET B”...因此，如果您确实按数据集名称进行分组，则一切都按预期工作...除了您的名字有错别字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T05:15:28.887

您的数据集名称显然有错字：

```
2013-04-04 10:59:38.704 [2380:14003] section name is DATSET A 
```

由于 DATSET A 中缺少第二个“A”，这将在 DATASET B 之后排序。

文字的危害。

# c# - 如何在 EPPLUS 或其他 excel 生成库中使用 Import Xml 功能？

> ID：15668618
> 
> 赞同：2
> 
> 时间：2013-03-27T20:19:54.080
> 
> 标签：c#, excel, epplus, xml-import

我在一些非常古老的帖子中读到 XML 导入功能将在 EPPLus 中实现。目前是否已实施？如何将数据导入到其单元格映射 XML 的 Excel 文档。我不能使用互操作服务，因为 excel 文件很大，我使用 EPPLUS 库中的许多技术来填充数据。或者我应该用 Interop 库重写所有这些填充物吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:29:43.550

xlsx 文件是基于 xml 的电子表格。正如它在[http://epplus.codeplex.com/](http://epplus.codeplex.com/)上所说，“EPPlus 是一个 .net 库，它使用 Open Office Xml 格式 (xlsx) 读写 Excel 2007/2010 文件。” 它速度很快，不是 Interop，而且不需要安装 Office。

# jquery - 检查是否已选择特定单选按钮 Jquery

> ID：15668619
> 
> 赞同：0
> 
> 时间：2013-03-27T20:19:56.063
> 
> 标签：jquery, html, radio-button

我想要完成的是：

当用户单击第一个*Open until Filled*选项时，请禁用*日期输入。*但是当用户点击第二个*打开直到*单选按钮时。启用*日期*输入。

截至目前，我似乎无法让它工作。它似乎完全跳过了我的检查。我错过了什么吗？

```
$(function() {
    if ($('input#id_open:checked').length > 0) {
        alert("please fill in the date");
        $('input[name=end_date]').attr('disabled', false);
    }
}); 
```

我在这里做了一个[**小提琴**](http://jsfiddle.net/8KggV/4/)来说明我的意思。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:23:08.177

工作示例：http: [//jsfiddle.net/8KggV/5/](http://jsfiddle.net/8KggV/5/)

```
$(function() {
    $('input').click(function(){
    if ($('#id_open:checked').length > 0) {
        $('input[name=end_date]').attr('disabled', false);
    }
        else{
            $('input[name=end_date]').attr('disabled', true);        
        }
    })
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:22:40.390

使用 jQuery 时，为了检测控件是否被选中，我使用 is 方法。您也不需要检查长度，因为 is 方法返回一个布尔值。

```
$(function() {
    if ($('input#id_open').is(':checked')) {
        alert("please fill in the date");
        $('input[name=end_date]').attr('disabled', false);
    }
}); 
```

# c++ - HSB vs HSL vs HSV

> ID：15668623
> 
> 赞同：50
> 
> 时间：2013-03-27T20:20:04.913
> 
> 标签：c++, colors, hsv, hsl, hsb

我正在制作一个 Color 类作为 C++ 中非常基本的图形 API 的一部分。所以我决定看一下微软的 .NET 框架，并注意到他们的 Color 类具有 HSB 的功能。

然后我开始了一项研究，以确定我是否应该在课堂上提供 HSB、HSL 或 HSV 或所有这些。

所以，我有 3 个关于 HSB、HSL、HSV 的问题：

1.  HSB 和 HSL 一样吗？

2.  如果没有，为什么没有 HSBL 甚至 HSBLV？

3.  我找到了许多不同的计算这些值的方法，有人可以告诉我最快的方法吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-10-26T03:39:31.090

> HSB 和 HSL 一样吗？

不，HSB 与 HSV 相同，但 HSL 不同。所有这些都被用作表示 RGB 颜色的友好方式。关于 HSL an HSV 的 Wikipedia 文章使用颜色 cilinders 解释了差异：[HSL 和 HSV](http://en.wikipedia.org/wiki/HSL_and_HSV) 基本上，HSB 和 HSL 的色调相同，但饱和度采用不同的值，亮度和亮度也不同。

> 如果没有，为什么没有 HSBL 甚至 HSBLV？

我不明白这一点。HSB/HSV 和 HSL 都可以表示任何 RGB 颜色。由于 B 和 L 的定义方式不同，因此无法独立拥有 B 和 L。给定的 HSB 亮度和饱和度与固定的亮度相关联。事实上，它们之间的转换非常容易。

> 我找到了许多不同的计算这些值的方法，有人可以告诉我最快的方法吗？

这里有一个类似的问题，用于从 RGB 计算 HSB：[Fast、optimized and accuracy RGB <-> HSB conversion code in C](https://stackoverflow.com/questions/6614792/fast-optimized-and-accurate-rgb-hsb-conversion-code-in-c)那里有一个 Java 实现可能会有所帮助。对于 HSB/HSV 和 HSL 之间的转换，请参阅[HSL vs HSB vs HSV](https://web.archive.org/web/20170321223122/http://codeitdown.com/hsl-hsb-hsv-color/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2019-08-31T15:36:41.437

原来 Brightness 和 Lightness 的区别是。“亮度”用于减色，“亮度”用于加色。现在，如果您的程序正在处理像 CMYK 系统这样的减色法，那么最好使用 HSB，否则最好使用 HSL。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-01-08T07:24:34.753

1.  HSB!=HSL 和 HSB==HSV
2.  **HSBL 和HSBLV**不存在，因为Lightness 和**B** **rightness**（也称为价值）是替代品
*****   以下是转换方法（更多关于 wiki [HSL2RGB](https://en.wikipedia.org/wiki/HSL_and_HSV#HSL_to_RGB_alternative)和[HSV2RGB](https://en.wikipedia.org/wiki/HSL_and_HSV#HSV_to_RGB_alternative)）****

 ******HSV -> RGB （**[在](https://stackoverflow.com/questions/17242144/javascript-convert-hsb-hsv-color-to-rgb-accurately/54024653#54024653)js 中实现）

[![在此处输入图像描述](../Images/b64e395037abac157004aa799f2170d7.png)](https://i.stack.imgur.com/7J84w.png)

**RGB -> HSV （**[在](https://stackoverflow.com/questions/8022885/rgb-to-hsv-color-in-javascript/54070620#54070620)js 中实现）

[![在此处输入图像描述](../Images/3049a3e542ef52714e6927f35e0d7802.png)](https://i.stack.imgur.com/CJKlf.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-12-06T23:41:49.833

HSB 和 HSV 相同，但 HSL 不同。HSB 代表色相、饱和度和亮度，HSV 代表色相、饱和度和值。HSL 代表色相、饱和度、亮度。这是与 Medium.com 的视觉差异：[https](https://i.stack.imgur.com/nX8NL.png) ://i.stack.imgur.com/nX8NL.png 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-05-03T13:24:28.123

如果您正在做 UI，使用 HSL 而不是 HSV 更有意义，因为您需要控制调色板的亮度 (L) 值。****

# javascript - jquery 对动态表上的两个输入求和并在第三个中显示

> ID：15668626
> 
> 赞同：0
> 
> 时间：2013-03-27T20:20:26.067
> 
> 标签：javascript, jquery

在 SO 社区中，我有一个脚本，可以将具有唯一名称的行添加到表中。我想在每一行上取两个输入并将它们相乘并在第三个输入中显示结果。

小提琴位于[http://jsfiddle.net/yUfhL/231/](http://jsfiddle.net/yUfhL/231/)

我的代码是： **HTML**

```
<table class="order-list">
  <tr><td>Product</td><td>Price</td><td>Qty</td><td>Total</td></tr>
  <tr>
      <td><input type="text" name="product" /></td>
      <td><input type="text" name="price" /></td>
      <td><input type="text" name="qty" /></td>
      <td><input type="text" name="linetotal" /></td>
    </tr>
</table>
<div id="grandtotal">
    Grand Total Here
</div> 
```

**JS**

```
var counter = 1;
jQuery("table.order-list").on('change','input[name^="product"]',function(event){
    event.preventDefault();
    counter++;
    var newRow = jQuery('<tr><td><input type="text" name="product' +
        counter + '"/></td><td><input type="text" name="price' +
        counter + '"/></td><td><input type="text" name="qty' +
        counter + '"/></td><td><input type="text" name="total' +
        counter + '"/></td><td><a class="deleteRow"> x </a></td></tr>');
    jQuery('table.order-list').append(newRow);
});

jQuery("table.order-list").on('click','.deleteRow',function(event){

    $(this).closest('tr').remove();
});

$('table.order-list tr').each(function() {
   var price = parseInt( $('input[id^=price]', this).val(), 10 );
   var qty   = parseInt( $('input[id^=qty]'  , this).val(), 10 );
   $('input[id^=linetotal]', this).val(price * qty);
}); 
```

所以目前我无法让 js 获得两个单元格的产品，数量和价格。我想在总行中显示结果。

最后一部分是将所有 linetotals 的总和显示为 div 中的总计`grandtotal`

一如既往的帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:54:43.680

您只是给元素一个名称属性，但使用 id 选择器 ([id^=price])。给他们一个特定的类比使用“id 开头”选择器要容易得多。此外，您希望何时计算总行数？您希望何时计算总计？在什么事件上？

这是我对它的外观的解释：

```
<table class="order-list">
    <thead>
        <tr><td>Product</td><td>Price</td><td>Qty</td><td>Total</td></tr>
    </thead>

    <tbody>
        <tr>
            <td><input type="text" name="product" /></td>
            <td>$<input type="text" name="price" /></td>
            <td><input type="text" name="qty" /></td>
            <td>$<input type="text" name="linetotal" readonly="readonly" /></td>
            <td><a class="deleteRow"> x </a></td>
        </tr>
    </tbody>

    <tfoot>
        <tr>
            <td colspan="5" style="text-align: center;">
                <input type="button" id="addrow" value="Add Product" />
            </td>
        </tr>

        <tr>
            <td colspan="5">
                Grand Total: $<span id="grandtotal"></span>
            </td>
        </tr>
    </tfoot>
</table> 
```

和 JS：

```
$(document).ready(function () {
    var counter = 1;

    $("#addrow").on("click", function () {
        counter++;

        var newRow = $("<tr>");
        var cols = "";
        cols += '<td><input type="text" name="product' + counter + '"/></td>';
        cols += '<td>$<input type="text" name="price' + counter + '"/></td>';
        cols += '<td><input type="text" name="qty' + counter + '"/></td>';
        cols += '<td>$<input type="text" name="linetotal' + counter + '" readonly="readonly"/></td>';
        cols += '<td><a class="deleteRow"> x </a></td>';
        newRow.append(cols);

        $("table.order-list").append(newRow);
    });

    $("table.order-list").on("change", 'input[name^="price"], input[name^="qty"]', function (event) {
        calculateRow($(this).closest("tr"));
        calculateGrandTotal();
    });

    $("table.order-list").on("click", "a.deleteRow", function (event) {
        $(this).closest("tr").remove();
        calculateGrandTotal();
    });
});

function calculateRow(row) {
    var price = +row.find('input[name^="price"]').val();
    var qty = +row.find('input[name^="qty"]').val();
    row.find('input[name^="linetotal"]').val((price * qty).toFixed(2));
}

function calculateGrandTotal() {
    var grandTotal = 0;
    $("table.order-list").find('input[name^="linetotal"]').each(function () {
        grandTotal += +$(this).val();
    });
    $("#grandtotal").text(grandTotal.toFixed(2));
} 
```

[http://jsfiddle.net/QAa35/](http://jsfiddle.net/QAa35/)

在您的 JS 中，您没有使用`linetotal`一个动态输入的`name`. 我还做了其他几个小的修改。您不妨使用`<thead>`，`<tbody>`因为`<tfoot>`您确实在`<table>`. 另外，我认为在“产品”输入更改时自动添加新行不是一个好的设计。这种情况经常发生，他们的意图可能不是添加新产品……按钮更友好。例如，假设您在第一个“产品”输入中键入“asdf”，然后单击某处。添加了一个新行。假设您打错了字，所以您返回并将其更改为“asd”，然后单击某处。添加了另一个新行。这似乎不对。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T21:12:42.980

这个函数应该可以解决问题：

```
function updateGrandTotal() {

    var prices = [];
    $('input[name^="price"]').each(function () {
        prices.push($(this).val());
    });

    var qnts = [];
    $('input[name^="qty"]').each(function () {
        qnts.push($(this).val());
    });

    var total = 0;
    for(var i = 0; i < prices.length; i++){
        total += prices[i] * qnts[i];
    }

    $('#grandtotal').text(total.toFixed(2));

} 
```

您只需将其绑定到表更改事件以在每次输入更改时更新总计：

```
$("table.order-list").change(updateGrandTotal); 
```

[这](http://jsfiddle.net/9Gshb/1/)是一个工作小提琴。

# ruby - 需要一个红宝石正则表达式进行匹配

> ID：15668627
> 
> 赞同：2
> 
> 时间：2013-03-27T20:20:30.040
> 
> 标签：ruby, regex, cucumber

我正在尝试从不同的 RPM 列表中提取版本。下面是一个例子：

```
rpm = "abc-def-ghi-1.1.0-10.el6.x86_64" 
```

这个变量可以有不同的字符串值，

```
rpm = "a-b-1.1.1-10.x86_64" 
```

我的目标是使用“匹配”方法（如下所示）编写一个正则表达式 - 尽管这个不涵盖 .el6 方面。

```
rpm.match(/^#{rpmname_to_match}-(.*).x86_64$/).nil? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:36:20.510

我不确定你想用 .el6 部分做什么，但如果你想要一个只匹配数字部分的模式，那么试试这个：

```
([0-9]+(?:(?:\.|-)(?:[0-9]+))*) 
```

这将只匹配以一位或多位数字开头的字符串，然后可以包含任意数量的序列，即句点或连字符后跟一位或多位数字。

因此，您的最终陈述可能如下：

```
rpm.match(/^#{rpmname_to_match}-([0-9]+(?:(?:\.|-)(?:[0-9]+))*)(.*)\.x86_64$/).nil? 
```

# google-app-engine - 生成 URL 以将图像存储在 Datastore Blob 中

> ID：15668629
> 
> 赞同：0
> 
> 时间：2013-03-27T20:20:33.703
> 
> 标签：google-app-engine, python-2.7, google-cloud-datastore

我是 Python 和 Google App Engine 的新手。我需要在 GAE 数据存储中存储一个图像（不是 blobstore - 有很多示例要存储在 blobstore 中，我已经让它在 blobstore 中工作）。

文档如下：

```
movie = Movie()
...
movie.picture = db.Blob(urlfetch.Fetch(picture_url).content)
movie.put() 
```

我的问题是如何获得**picture_url**？我不能使用**create_upload_url**方法，因为这是针对 Blobstore 的。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:26:06.147

这个问题的措辞没有人能回答，因为您需要告诉人们您打算如何开始获取图像数据。

您使用的代码是从某个 URL 下载图像并将其保存到您的 blobstore。您应该能够使用来自 flickr 或 facebook 或任何其他网站的任何可公开访问的图像 url 作为 url。您需要决定要使用的网址。

如果您希望用户上传数据，那么您需要用户使用 multipart/form-data 中的图像发出 POST 请求。您将访问请求处理程序`request.POST`对象中的数据。在这种情况下，您不会从 url 获取它。

如果您使用的是 Blobstore，GAE 会自动解析 POST 请求数据，将其保存在 Blobstore 中，并为您提供一个 url。如果您不使用 Blobstore，则您的请求对象中的图像数据将只存在于内存中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T01:46:13.477

```
db.Blob(urlfetch.Fetch(picture_url).content) 
```

用于从其他网站获取图像。

如果你想存储用户上传的东西，你最好使用

```
data = self.request.get('data')  # where 'data' is the data field from your HTML form
if data :
    db.Blob(data) 
```

# lightbox - 在页面加载时打开我的灯箱

> ID：15668630
> 
> 赞同：0
> 
> 时间：2013-03-27T20:20:38.193
> 
> 标签：lightbox

如果您访问我的页面（[http://www.dentalfixrx.com/local-equipment-repair/](http://www.dentalfixrx.com/local-equipment-repair/)）并单击右上角的“开始”按钮，您将打开一个灯箱表单。

我想创建代码，以便灯箱自动出现在页面加载中。

这是当前打开灯箱的代码：`<a href="download-kit.html" class="lbOn" title="form"><img src="images/mobile-dental-repairs.gif" width="184" height="36"border="0" class="getstarted" /></a>`

只是访问[http://www.dentalfixrx.com/local-equipment-repair/download-kit.html](http://www.dentalfixrx.com/local-equipment-repair/download-kit.html)不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:46:16.873

将灯箱代码包装到父 div (.parent) 中并最初隐藏整个 div

HTML：

```
<div class="parent">

<div class="downloadkit"><form action="formmail.php" method="post" >
<input type="hidden" name="recipients" value="brian@dentalfixrx.com,billdonatojr@gmail.com,andy@dentalfixrx.com" />
<input type="hidden" name="subject"value="New DentalFixRx Lead!" />
<input type="hidden" name="good_url" value="thanks-downloadkit.php" />

<div style=" width:300px; position:absolute; right:10px; top:15px;">
<h1 style="font-size:20px; margin:5px auto;">Emergency Fix Needed?</h1>
To receive a fast response, please complete the form below and click the "submit" button. 
</div>

     <p><label>Name/Business:<span class="red">*</span></label><input type="text" name="name" id="name"  /></p>
     <p> <label> Phone:<span class="red">*</span></label> <input type="text" name="phone" id="phone" / > </p>
     <p> <label>Email:<span class="red">*</span></label> <input type="text" name="email" id="email" / ></p>
     <p> <label>State:</label> <input type="text" name="st" id="st" / ></p>
     <p> <label>Zip Code:</label> <input type="text" name="zip" id="zip" / ></p>
     <p> <label>Service Needed:</label><select name="">
       <option>Select one</option>
       <option>Handpiece Repair</option>
       <option>  -Low Speed</option>
       <option>  -High Speed</option>
       <option>  -Electric High Speed</option>
       <option>Equipment Repair</option>
       <option>  -Autoclaves</option>
       <option>  -Chairs & Delivery Units</option>
       <option>  -Compressors</option>
       <option>  -Vacuum Pumps</option>
       <option>  -Ultrasonic Scalers</option>
       <option>  -Instrument Sharpening</option>     
       <option>  -Upholstery</option>
       <option>  -Curing Lights</option>
       <option>  -Film Processors</option>      
       <option>Other Service</option>          
     </select></p>
          <p> <label>Select type of request:</label><select name="">
       <option>Select one</option>
       <option>Just a casual question</option>
       <option>I need some help but it's not super time-sensitive</option>
       <option>Things are broken and I'd like them not to be!</option>
       <option>I can't get things done, please reply ASAP</option>
     </select></p>
   <div class="clear"></div>  

<input value=" " type="submit" class="download-btn" width="231px" height="36px" />
<a href="#" class="lbAction close" rel="deactivate"><span>Exit</span></a>
</form></div>

</div> 
```

CSS：

```
 div.parent 
        {
            display: none;
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            text-align: center;   
            font-family: 'Myriad Pro', Arial, sans-serif !important;
            font-size: 22px !important;
            border: 2px solid #aaa;
            z-index: 1040;
            -moz-box-shadow: 0px 0px 20px 2px #ccc;
            -webkit-box-shadow: 0px 0px 20px 2px #ccc;
            box-shadow: 0px 0px 20px 2px #ccc;
            background: rgb(54, 25, 25); /* Fall-back for browsers that don't
                                    support rgba */
            background: rgba(255, 255, 255, .7);            
        }

            div.downloadkit
            {
                position: fixed;
                width: 200px;
                height: 100px;
                top: 50%;
                left: 50%;
                margin-left: -100px;
                margin-top: -50px;
            } 
```

然后，在您网站的主页上，添加以下代码：注意，这是 jQuery，因此只需将 jquery 库添加到您的网站，无论是在标题中还是在结束正文标记上方 -

```
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script> 
```

现在在添加 jQuery 的地方添加以下代码：

```
<script type="text/javascript">
   $(window).load(function(){       //this is pageload
       $('div.parent').show(500);  //500 is the animation speed
   })
</script> 
```

注意：如果

```
$('div.parent').show(500); 
```

不起作用，请尝试：

```
$('div.parent').css('display','block'); 
```

# python - IP 作为 Python 关联/字典数组索引/键

> ID：15668631
> 
> 赞同：0
> 
> 时间：2013-03-27T20:20:38.447
> 
> 标签：python, arrays

我正在尝试将 assoc 数组索引设置为 IP，以便我可以跟踪它们在数据包中出现的次数。

```
 log = {}
 if log[str(s_addr)] < 1:
     log[str(s_addr)] = 1
 else:
     log[str(s_addr)] += 1
     if log[str(s_addr)] > 100:
         data_salary = {
             'protocol' : str(protocol),
             'source_ip': str(s_addr),
             'dest_ip': str(d_addr),
             'source_port':str(source_port),
             'dest_port': str(dest_port)
         }
         cursor.execute(add_salary, data_salary)
         cnx.commit()
         print("Logged") 
```

然而，这给了我一个 KeyError

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:25:52.833

它给你一个 KeyError 因为`log[str(s_addr)]`当你试图进行比较时未定义。尝试类似：

```
log = {
  str(s_addr) : 0
}
if log[str(s_addr)] < 1:
    ... 
```

# tree - 带有 Ebean 的 Java 树（同一张表中的父子关系）

> ID：15668634
> 
> 赞同：0
> 
> 时间：2013-03-27T20:20:41.527
> 
> 标签：tree, playframework-2.1, ebean

我完全坚持从数据库中检索父子结构。我无法创建适用于 Ebean 演变的下降模型，因为 Ebean 无法识别父关系。我尝试了什么：

```
public class Category extends Model {

    private static final long serialVersionUID = 4660222569406895990L;

    private Long id;
    private String sfname;
    // @ManyToOne -- does not work
    // @JoinColumn(name="id")
    private Category parent;

    public static Finder<Integer, Category> FIND = new Finder<Integer, Category>(Integer.class, Category.class);
} 
```

无论我尝试什么，上面的代码都会生成以下 SQL Evolution 脚本：

```
create table category (
   id                        bigint,
   name                      varchar(255)
); 
```

如果上述方法可行，那么顶层没有父级，那么这将如何或可以如何工作？

我对树和java完全没有经验，也许这对我来说如此困难:-)谢谢你的帮助！

** 2013-03-28 编辑 **

正如所`nico`指出的，我忘了添加`@Id`到主键。因此，以下模型有效：

```
@Id
private Long id;
private String sfname;
@ManyToOne
private Category parent; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:26:35.257

您可能忘记了`@Id`下面的注释`private Long id`：

```
public class Category extends Model {

    private static final long serialVersionUID = 4660222569406895990L;

    @Id
    private Long id;
    ...
} 
```

# java - acegi安全登录，无需手动输入密码

> ID：15668635
> 
> 赞同：0
> 
> 时间：2013-03-27T20:20:43.830
> 
> 标签：java, security, authentication, login, spring-security

我们在应用程序中使用了基于表单的 acegi 安全登录。但是现在我们想从另一个应用程序传递登录名和密码信息，因此我们的应用程序的打开必须对用户透明（不要求输入名称和密码，而有效的名称和密码已经指定和已知）。不幸的是，这似乎是一项艰巨或混乱的任务。搜索了互联网和这个网站，但仍然不清楚如何完成这样的程序。理想的可能是在打开应用程序时在 URL 中传递名称和密码，但根本看不到 acegi security 是否提供这种登录方式。也许还有其他一些方式存在？我们需要从基于 php 的网站打开 java 接口。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T21:03:48.590

您正在寻找的是 Spring Security（以前称为 Acegi）不是的单点登录框架。通常，如何使用这样的框架来实现这一点是您拦截对受保护资源的调用。如果某个令牌不存在，您将他们重定向到他们输入凭据的单点登录页面。如果他们通过了身份验证，则将传递令牌，这就是检查以确保用户通过身份验证的内容。您可以使用 Spring Security 与单点登录解决方案集成，但它不能作为一个整体运行。

您正在寻找的内容类似于[http://www.jasig.org/cas](http://www.jasig.org/cas)或 Atlassian 的 Crowd。

# c++ - C 或 C++ 中日历日期的算术（将 N 天添加到给定日期）

> ID：15668638
> 
> 赞同：8
> 
> 时间：2013-03-27T20:20:48.313
> 
> 标签：c++, c, date, date-arithmetic

我得到了一个日期，我将其作为输入，例如 (day, month, year): `12, 03, 87`。

现在我需要在几天后找出日期`n`。

我为此编写了代码，但效率不高。您能否告诉我任何运行速度更快且复杂性更低的好逻辑。

```
#include <stdio.h>

static int days_in_month[] = { 0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
int day, month, year;

unsigned short day_counter;

int is_leap(int y) {
    return ((y % 4 == 0 && y % 100 != 0) || y % 400 == 0);
}

next_day()
{
    day += 1; day_counter++;
    if (day > days_in_month[month]) {
        day = 1;
        month += 1;
        if (month > 12) {
            month = 1;
            year += 1;
            if (is_leap(year)) {
                days_in_month[2] = 29;
            } else {
                days_in_month[2] = 28;
            }
        }
    }
}

set_date(int d, int m, int y) 
{
    m < 1 ? m = 1 : 0;
    m > 12 ? m = 12 : 0;
    d < 1 ? d = 1 : 0;
    d > days_in_month[m] ? d = days_in_month[m] : 0;
    if (is_leap(y)){
        days_in_month[2] = 29;
    } 
    else {
        days_in_month[2] = 28;
    }
    day = d;
    month = m;
    year = y;
}

skip_days(int x)
{
    int i;
    for (i=0;i<x;i++) next_day();
}

print_date()
{
    printf ("day: %d month: %d year: %d\n", day, month, year);
}

int main(int argc, char **argv)
{
    int i;

    set_date(5, 2, 1980);
    skip_days(40);
    day_counter = 0;
    /* after this call next_day each day */

    print_date();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-27T21:03:36.670

> 您能否告诉我任何运行速度更快且复杂性更低的好逻辑。

如果这个确切的事情确实是您的应用程序的性能关键部分，那么您可能做错了什么。为了清楚和正确起见，您应该坚持现有的解决方案。选择最适合您的开发环境的一种。

* * *

C方法：

```
#include <stdio.h>
#include <time.h>

int main()
{        
    /* initialize */
    int y=1980, m=2, d=5;    
    struct tm t = { .tm_year=y-1900, .tm_mon=m-1, .tm_mday=d };
    /* modify */
    t.tm_mday += 40;
    mktime(&t);
    /* show result */
    printf("%s", asctime(&t)); /* prints: Sun Mar 16 00:00:00 1980 */
    return 0;
} 
```

不使用 Boost 方法的 C++：

```
#include <ctime>
#include <iostream>

int main()
{        
    // initialize
    int y=1980, m=2, d=5;
    std::tm t = {};
    t.tm_year = y-1900;
    t.tm_mon  = m-1;
    t.tm_mday = d;
    // modify
    t.tm_mday += 40;
    std::mktime(&t);
    // show result
    std::cout << std::asctime(&t); // prints: Sun Mar 16 00:00:00 1980
} 
```

[Boost.Date_Time](http://www.boost.org/doc/libs/1_53_0/doc/html/date_time.html)方法：

```
#include <boost/date_time/posix_time/posix_time.hpp>
#include <iostream>

int main()
{
    using namespace boost::gregorian;
    // initialize
    date d(1980,2,5);
    // modify
    d += days(40);
    // show result
    std::cout << d << '\n'; // prints: 1980-Mar-16
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-27T20:54:19.837

标准库`mktime`函数包含一个技巧，可以很容易地将几个月或几天添加到给定日期：您可以给它一个日期，例如“2 月 45 日”或“40 个月的第 2 天”，`mktime`并将其标准化进入适当的日期。例子：

```
#include <time.h>
#include <stdio.h>

int main() {
    int y = 1980;
    int m = 2;
    int d = 5;
    int skip = 40;

    // Represent the date as struct tm.                                                           
    // The subtractions are necessary for historical reasons.
    struct tm  t = { 0 };
    t.tm_mday = d;
    t.tm_mon = m-1;
    t.tm_year = y-1900;

    // Add 'skip' days to the date.                                                               
    t.tm_mday += skip;
    mktime(&t);

    // Print the date in ISO-8601 format.                                                         
    char buffer[30];
    strftime(buffer, 30, "%Y-%m-%d", &t);
    puts(buffer);
} 
```

与使用 以秒为单位进行算术相比`time_t`，这种方法的优点是夏令时转换不会引起任何问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-04T20:20:44.767

这是使用Howard Hinnant[在此处](http://howardhinnant.github.io/date_algorithms.html)发布的算法的解决方案的样子。

```
int main() {
    int day_count = days_from_civil(1980, 5, 2);
    auto [year, month, day] = civil_from_days(day_count + 40);
    printf("%04i-%02i-%02-i\n", (int)year, (int)month, (int)day);
} 
```

新的日期功能已获准包含在 C++20 中，但使用了不同的 API。C++20 解决方案可能类似于：

```
#include <chrono>

int main() {
    using namespace std::chrono;
    sys_days in_days = year_month_day{1980y, may, 2d};
    std::cout << year_month_day(in_days + days(40)) << '\n';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T20:32:00.120

最简单的技巧是使用`time_t`类型和相应的函数。

`mktime`将 tm 结构转换为`time_t`. 这是一个整数值，计算从 1970 年 1 月 1 日开始的秒数。

获得`time_t`值后，只需添加所需的秒数（每天 86400）。

要转换回来，使用`gmtime`或`localtime`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T20:34:42.160

只需将您想要的天数添加到 time_t 对象。

```
#define SECOND              1
#define MINUTE              60 * SECOND
#define HOUR                60 * MINUTE
#define DAY                 24 * HOUR

time_t curTime;
time_t futureTime;

time( & curTime );

futureTime = curTime + (5 * DAY);

struct tm * futureDate = gmtime(&futureTime);
std::cout<<"5 days from now will be: "<<futureDate->tm_mday<<"/"<<futureDate->tm_mon+1<<"/"<<futureDate->tm_year+1900<<std::endl; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-22T12:21:35.397

可以使用 C++ 运算符并通过将日期表示为类以非常 OOP 的方式实现。

```
#include <iostream>
#include <string>

using namespace std;

class Date {
public:
    Date(size_t year, size_t month, size_t day):m_year(year), m_month(month), m_day(day) {}
    ~Date() {}

    // Add specified number of days to date
    Date operator + (size_t days) const;

    size_t Year()  { return m_year; }
    size_t Month() { return m_month; }
    size_t Day()   { return m_day; }

    string DateStr();
private:
    // Leap year check 
    inline bool LeapYear(int year) const
        { return year % 4 == 0 && (year % 100 != 0 || year % 400 == 0); }

    // Holds all max days in a general year
    static const int MaxDayInMonth[13];

    // Private members
    size_t m_year;
    size_t m_month;
    size_t m_day;   
};

// Define MaxDayInMonth
const int Date::MaxDayInMonth[13] = {0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};

/// Add specified number of days to date
Date Date::operator + (size_t days) const {
    // Maximum days in the month
    int nMaxDays(MaxDayInMonth[m_month] + (m_month == 2 && LeapYear(m_year) ? 1 : 0));

    // Initialize the Year, Month, Days
    int nYear(m_year);
    int nMonth(m_month);
    int nDays(m_day + days);

    // Iterate till it becomes a valid day of a month
    while (nDays > nMaxDays) {
        // Subtract the max number of days of current month
        nDays -= nMaxDays;

        // Advance to next month
        ++nMonth;

        // Falls on to next year?
        if (nMonth > 12) {
            nMonth = 1; // January
            ++nYear;    // Next year
        }

        // Update the max days of the new month
        nMaxDays = MaxDayInMonth[nMonth] + (nMonth == 2 && LeapYear(nYear) ? 1 : 0);
    }

    // Construct date
    return Date(nYear, nMonth, nDays);
}

/// Get the date string in yyyy/mm/dd format
string Date::DateStr() {
    return to_string(m_year) 
        + string("/")
        + string(m_month < 10 ? string("0") + to_string(m_month) : to_string(m_month))
        + string("/")
        + string(m_day < 10 ? string("0") + to_string(m_day) : to_string(m_day)); 
}

int main() {
    // Add n days to a date
    cout << Date(2017, 6, 25).DateStr() << " + 10 days = "
         << (Date(2017, 6, 25) /* Given Date */ + 10 /* Days to add */).DateStr() << endl;

    return 0;
}

Output
2017/06/25 + 10 days = 2017/07/05 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-03-27T20:34:14.690

使用自纪元以来的秒数而不是直接操作日期字段可能更容易进行数学运算。

例如，此程序打印**7 天后**的日期：

```
#include <stdio.h>
#include <time.h>

main()
{
    time_t t;
    struct tm *tmp;

    time(&t);

    /* add a week to today */
    t += 7 * 24 * 60 * 60;

    tmp = localtime(&t);
    printf("%02d/%02d/%02d\n", tmp->tm_mon+1, tmp->tm_mday,
        tmp->tm_year % 100);
} 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2018-02-14T15:36:32.973

此代码将打印 10 天后的日期。将用户定义数字的值更改为 N。

```
#include< iostream.h>

#include< conio.h>

struct date{int d,m,y;};

void main()

    {

    date d1;

    void later (date);

    cout<<"ENTER A VALID DATE (dd/mm/yy)";

    cin>>d1.d>>d1.m>>d1.y;

    later(d1);

    getch();

    }

    void later(date d1)

    {

    int mdays[12]={31,28,31,30,31,30,31,31,30,31,30,31};

    if(((d1.y%4==0) && (d1.y%100!=0))||(d1.y%400==0))
    mdays[1]=29;
    d1.d=d1.d+10;

    if(d1.d>mdays[d1.m-1])

    {

    d1.d=d1.d-mdays[d1.m-1];

    d1.m++;

    if(d1.m>12)

    {d1.m=1;

    d1.y++;

    }

    }
    cout<<"DATE AFTER TEN DAYS IS "<<d1.d<<"\t"<<d1.m<<"\t"<<d1.y;

    getch();

    } 
```

# three.js - 在 three.js 库中，如何将 face4 转换为两个 face3 不重叠的三角形？

> ID：15668640
> 
> 赞同：3
> 
> 时间：2013-03-27T20:20:52.980
> 
> 标签：three.js, geometry

我有一个face4（四面体），我需要得到两个face3（三角形面）而不重叠。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T20:28:09.117

具有顶点 a、b、c、d 的 face4 等价于两个 face3。一个具有顶点 a,b,c，另一个具有顶点 a,c,d。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-27T20:41:04.950

有一个实用程序可以为您对四边形进行三角测量：

```
THREE.GeometryUtils.triangulateQuads( geometry ); 
```

编辑：此方法不再存在。

三.js r.70

# java - Java：JList getSelectedValue() NPE

> ID：15668643
> 
> 赞同：0
> 
> 时间：2013-03-27T20:21:06.290
> 
> 标签：java, swing, jlist

我在尝试运行我的脚本时遇到了 NPE，但我不明白为什么，目标是运行在我的 JList 中选择的文件，所以这里是相关的代码位，从我的 JList 人口开始：

```
File f1 = new File("ARForm.java");
String assetClasses = f1.getAbsolutePath();
String[] splits = assetClasses.split(":");
String pathName = splits[0] + ":\\";
File dir = new File(pathName);
String[] lista = dir.list();
@SuppressWarnings("unchecked") 
JList list1 = new JList(lista);
JScrollPane js = new JScrollPane(list1); 
```

这里是列出 NPE 的类的部分，标记的行，这两组代码来自两个不同的类。

```
Object fileName;
ARForm mform;

public void actionPerformed(ActionEvent a){
    try{
        **fileName = mform.list1.getSelectedValue();**
        Process p = Runtime.getRuntime().exec(fileName.toString());
    }
} 
```

如果这还不够，请告诉我并发布完整的课程。如果有更简单的方法来做我所做的事情，请告诉我。

**编辑**

这是我的课程，我意识到有些导入是不必要的，我懒得复制/粘贴：

```
import java.awt.*;
import java.util.*;
import javax.swing.*;
import javax.swing.event.*;

public class Autorun extends JFrame{
    public static void main(String[] args){
        ARForm mform = new ARForm();
        mform.setTitle("Security Roulette");
        mform.pack();
        mform.setLocationRelativeTo(null);
        mform.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        mform.setVisible(true);
    }
} 
```

* * *

```
import java.awt.*;
import java.util.*;
import javax.swing.*;
import javax.swing.event.*;
import java.io.*;

public class ARForm extends JFrame{
    JButton runButton;
    JLabel lab;
    File f1 = new File("ARForm.java");
    String assetClasses = f1.getAbsolutePath();
    String[] splits = assetClasses.split(":");
    String pathName = splits[0] + ":\\";
    File dir = new File(pathName);
    String[] lista = dir.list();
    @SuppressWarnings("unchecked") 
    JList list1 = new JList(lista);
    JScrollPane js = new JScrollPane(list1);

    public ARForm(){
        JPanel jp = new JPanel();
        jp.setLayout(new GridLayout(1,2));
        jp.add(js);
        jp.add(runButton = new JButton("Run"));
        runButton.setBounds(186, 10, 89, 23);
        runButton.addActionListener(new ButtonAction());
        add(jp);
    }
} 
```

* * *

```
import java.awt.event.*;
import java.util.*;
import javax.swing.*;
import java.io.*;

public class ButtonAction implements ActionListener{
    Object fileName;
    ARForm mform;

    public void actionPerformed(ActionEvent a){
        try{
            fileName = mform.list1.getSelectedValue();
            Process p = Runtime.getRuntime().exec(fileName.toString());
            System.exit(0);
        }
        catch (IOException e){
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, "Yo Mama!");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:29:47.110

你还没有初始化`ARForm mform`。也许这就是问题所在？

# git - 将本地 git 获取到新的 github 存储库时出错

> ID：15668645
> 
> 赞同：5
> 
> 时间：2013-03-27T20:21:13.273
> 
> 标签：git, github

-- 编辑 -- 我最终将所有文件复制到另一个文件夹并从那里推送。没有提交历史。:(

感谢您的回复。

- /编辑 -

我是 git 新手。对于我的 html5 应用程序，我使用了 aptana 的 html5 样板，它为您安装了一个 git 存储库。好的。现在，在我的应用程序上工作了几个星期后，我想把它推送到 github。我在那里创建了一个新的存储库。

现在，当我尝试从 shell 或 tortoisegit 推送到 github 时，我在上传所有文件后遇到错误：

```
$ git push -u origin master
...
remote: error: unable to find b4587434...<snip>...c701 (probably a checksum)
remote: fatal: objet of unexpected type
error: unpack failed: index-pack abnormal exit 
! [remote rejected] master -> master (unpacker error)
error: failed to push some refs to 'https://github.com/<user>/<project>.git' 
```

我一直在寻找解决方案，但还没有找到任何东西。我尝试的一些操作没有帮助：

*   我已将 origin 重命名为其他内容。
*   我在 github 上创建了另一个存储库。
*   “git status”确认我没有什么可提交的。

请帮忙，git花费这么多时间来找出应该简单的东西真是令人沮丧。:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-03T12:25:48.310

我试图镜像 Twbs 引导程序，但出现这样的错误，我的问题是我使用`--depth=1`. 我在没有参数的情况下重新克隆了 repo，`--depth=`并且使用以下步骤一切正常：

1.  `git clone --bare https://github.com/twbs/bootstrap.git`
2.  `cd bootstrap.git`
3.  `git push --mirror git@github.com:yourusername/your-repo-name.git`
4.  `cd ../ && rm -rf bootstrap.git`
5.  `git clone git@github.com:yourusername/your-repo-name.git`
6.  `cd your-repo-name`
7.  `git remote add twbs https://github.com/twbs/bootstrap.git`

现在你可以推送到你自己版本的 repo，`git push origin master`如果你想从原始 repo 中提取更改，你可以简单地做`git pull twbs master`.

更多信息可用@ [https://help.github.com/articles/duplicating-a-repository/](https://help.github.com/articles/duplicating-a-repository/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:46:40.967

所以你可以尝试的一件事是：

1.  转到 github.com/THE_REPO_YOU_MADE
2.  复制仓库顶部的 SSH url
3.  删除任何旧的原点遥控器

    ```
    git remote
    git remote rm origin 
    ```

4.  创建一个名为“origin”（或您想要的任何名称）的 github 远程

    ```
    git remote add origin git@github.com:USER_NAME/REPO_NAME.git 
    ```

5.  将文件推送到刚刚添加的远程

    ```
    git push remote origin master 
    ```

这些步骤假设您已经完成：

```
git init # creates a local repo
git add . # adds all files in the current directory
git commit -m "init commit" #commits your init 
```

我知道这些是非常基本的步骤，可能无法回答您收到的错误，但这些步骤

另一件要尝试的事情是检查您是否在回购中拥有回购。这是我的学生有时会遇到的问题。绑定推送和权限时会导致一些错误

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-27T08:49:54.503

注意：至少对于 git 2.0.1（2014 年 6 月 25 日），错误消息可能更具体。

请参阅[Jeff King (](https://github.com/peff) [)](https://github.com/peff)的[提交 77583e7](https://github.com/git/git/commit/77583e7739c76f623f49681c9ee4d10a313fe786)：[`peff`](https://github.com/peff)

### `index-pack`: 区分缺失对象和类型错误

> 当我们获取一个不包含我们期望接收的对象的包时，我们会收到如下错误：

```
$ git init --bare tmp.git && cd tmp.git
$ git fetch ../parent.git
[...]
error: Could not read 964953ec7bcc0245cb1d0db4095455edd21a2f2e
fatal: Failed to traverse parents of commit b8247b40caf6704fe52736cdece6d6aae87471aa
error: ../parent.git did not send all necessary objects 
```

> 这来自`check_everything_connected rev-list`. 如果我们尝试克隆相同的 repo（而不是 a `fetch`），我们最终会使用`index-pack`'s`--check-self-contained-and-connected`选项，它会产生如下输出：

```
$ git clone --no-local --bare parent.git tmp.git
[...]
fatal: object of unexpected type
fatal: index-pack failed 
```

> 不仅缺少 sha1，而且是误导性消息。
> 没有类型问题，而是缺少对象问题；我们没有注意到差异，因为我们只是比较`OBJ_BAD != OBJ_BLOB`。
> 让我们为这种情况提供不同的信息：

```
$ git clone --no-local --bare parent.git tmp.git
fatal: did not receive expected object 6b00a8c61ed379d5f925a72c1987c9c52129d364
fatal: index-pack failed 
```

> 当我们这样做的时候，让我们也改进一个真正的类型不匹配错误看起来像

```
fatal: object 6b00a8c61ed379d5f925a72c1987c9c52129d364: expected type blob, got tree 
```

# php - 在子查询上添加 INNER JOIN

> ID：15668648
> 
> 赞同：0
> 
> 时间：2013-03-27T20:21:16.130
> 
> 标签：php, mysql, sql

给定两个表 nf_users 和 nf_wr_year 以及以下查询，如何向 nf_users 表添加内部联接以选择其他列？

```
SELECT 
    points, 
    played, 
    wins 
FROM (
    SELECT
        p.*,
        @i:=@i + 1 rank,
        @match:=IF(p.points = 528, @i, @match)
    FROM
        nf_wr_year p,
        (SELECT @i:=0, @match:=0) vars
    ORDER BY p.points
) t
WHERE @match >= rank - 2 
    AND @match <= rank + 2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:02:03.133

在对 nf_wr_year 的引用之后添加连接：

```
SELECT u.[additional-columns-you-want]
...
FROM
    nf_wr_year p
    join nf_users u
        on u.[something] = p.[something],
    (SELECT @i:=0, @match:=0) vars
ORDER BY p.points
... 
```

*确保您在t*选择中没有任何重复的列名，例如您用来加入的列名，通常通过`SELECT p.*, u.*`...

# c# - 如何将输入值传递给 JavaScript 函数？

> ID：15668649
> 
> 赞同：0
> 
> 时间：2013-03-27T20:21:17.153
> 
> 标签：c#, javascript, html, function

我有这段代码，想在`GoLargeSearch`单击图像时将输入传递给我的函数。

```
<div id="s4-searcharea-large">
    <input accessKey="S" onkeydown="CoreInvoke('LargeSearchKeyDownGoSearch', event)" id="txtLargeSearchTerm" runat="server" class="ms-sharepointsearchtext" title="Enter search words" value="" maxLength="255" size="25" type="text" name="SearchString" /> 
    <div class="ms-searchimage">
        <span style="position: relative; width: 27px; display: inline-block; height: 27px; overflow: hidden" class="s4-clust">
            <a style="width: 27px; display: inline-block; height: 27px" id="onetIDGoSearchLarge" title="Search" onclick="GoLargeSearch(document.getElementById('txtLargeSearchTerm'))" href="javascript:">
                <img style="border-bottom: 0px; position: absolute; border-left: 0px; border-top: 0px; border-right: 0px;" alt="Search" src="/_layouts/GP_Custom/images/largesearch.png" />
            </a>
        </span>
    </div>
</div> 
```

如何获取输入的值以将其传递给`GoLargeSearch`？这似乎不起作用：

```
onclick="GoLargeSearch(document.getElementById('txtLargeSearchTerm'))" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:21:56.183

您缺少获取该元素值的部分：

```
onclick="GoLargeSearch(document.getElementById('txtLargeSearchTerm').value)" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T21:02:21.403

这行得通！

```
function GoLargeSearch (obj) { alert(obj.value); } 
```

但这是非常难看的代码 =/ 你不能使用 JQuery 吗？

# java - Java-将两个字符串转换为单个字符串

> ID：15668651
> 
> 赞同：-2
> 
> 时间：2013-03-27T20:21:25.000
> 
> 标签：java, string

我有两个字符串

```
String str1= "B0000001";
String str2= "Testing";

StringBuilder sb= new StringBuilder();
sb.append(str1)
sb.append("\\");
sb.append(str2);
return sb.toString(); 
```

我得到的结果是“B0000001”\“测试”

但我希望结果为“B0000001\Testing”

我怎样才能实现它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:28:11.370

```
 String str1 = "B0000001";
  String str2 = "Testing";
  StringBuilder sb = new StringBuilder();
  sb.append(str1);
  sb.append("\"\\\"");///////////(\")--->for (") and (\\) for(\) and (\")-->for (")
  sb.append(str2);
  System.out.println( sb.toString()); 
```

输出为：**B0000001"\"测试**

```
String str1= "B0000001"
String str2= "Testing"

StringBuilder sb= new StringBuilder();
sb.append(str1)
sb.append("\\");
sb.append(str2);
return sb.toString(); 
```

输出为：**B0000001\Testing**

# php - 是否可以让我的站点/服务器只能访问 xml 文件？

> ID：15668652
> 
> 赞同：0
> 
> 时间：2013-03-27T20:21:27.230
> 
> 标签：php, file, security

我想将一些客户付款计划信息存储在比 SQL 表更容易编辑的文件中。现在我将它存储在我的公共目录中的 XML 文件中。

有没有办法让它只能访问我的站点和/或服务器，以便用户不能篡改这些值？如果服务器端 php 正在读取这些值，会很难“破解”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:37:38.117

如果文件保存在根目录之外，则公众无法访问它。只要路径允许，[`openbase_dir`](http://www.php.net/manual/en/ini.core.php#ini.open-basedir)它仍然可以在服务器端包含`include`,`require`等。

# c++ - 如何在linux中找到默认的网络接口？

> ID：15668653
> 
> 赞同：3
> 
> 时间：2013-03-27T20:21:31.457
> 
> 标签：c++, linux

我看过这个问题：[Linux C: how to know the default interface for internet access？](https://stackoverflow.com/questions/10513673/linux-c-how-to-know-the-default-interface-for-internet-access)，但它建议解析命令的输出，这是我不想做的。我还检查了它的源代码并完全迷失在其中。

谁能给我一个可以做到这一点的片段？我想要的只是接口名称。

* * *

这是我使用 libmnl 的函数的当前（非工作）源代码：

```
bool get_default_interface(std::string* interface_name) {
    char buf[MNL_SOCKET_BUFFER_SIZE];
    struct nlmsghdr* nlh = mnl_nlmsg_put_header(buf);
    struct ifinfomsg* ifm = (ifinfomsg*) mnl_nlmsg_get_payload(nlh);
    int len = nlh->nlmsg_len;
    struct rtmsg* r = (rtmsg*) NLMSG_DATA(nlh);
    struct rtattr* rta = RTM_RTA(r);
    struct nlattr* tb[IFLA_MAX + 1] = {};
    mnl_attr_parse(nlh, sizeof(*ifm), data_attr_cb, tb);
    //struct rtnexthop* nh = (rtnexthop*) RTA_DATA(tb[RTA_MULTIPATH]);
    if (r->rtm_dst_len) {
            return false;
    }
    std::cout << mnl_attr_get_str(tb[IFLA_IFNAME]) << std::endl;
    *interface_name = mnl_attr_get_str(tb[IFLA_IFNAME]);
    return true;
} 
```

如您所知，我对此并不陌生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T21:49:53.690

这应该做。我从[这里](http://www.linuxquestions.org/questions/linux-networking-3/howto-find-gateway-address-through-code-397078/)的“Bob”中获取了它，并且冒昧地添加了一些缺失的包含并修改了输出。基本上，您打开一个套接字来查询路由，默认接口是与空目标地址关联的接口。

该代码适用于我的 64 位 Linux。

```
> Destination     Gateway         Interface       Source
> 0.0.0.0         192.168.0.1     eth1            *.*.*.*
>                                 ^^^^^ here it is!
> 127.0.0.0       *.*.*.*         lo              *.*.*.*
> ...

#include <asm/types.h>
#include <netinet/ether.h>
#include <netinet/in.h>
#include <net/if.h>
#include <stdio.h>
#include <sys/socket.h>
#include <sys/ioctl.h>
#include <linux/netlink.h>
#include <linux/rtnetlink.h>
#include <sys/types.h>
#include <unistd.h>
#include <string.h>
#include <stdlib.h>
#include <stdio.h>

#define BUFSIZE 8192

struct route_info{
        u_int dstAddr;
        u_int srcAddr;
        u_int gateWay;
        char ifName[IF_NAMESIZE];
};

int readNlSock(int sockFd, char *bufPtr, int seqNum, int pId) {
        struct nlmsghdr *nlHdr;
        int readLen = 0, msgLen = 0;
        do {
                /* Receive response from the kernel */
                if((readLen = recv(sockFd, bufPtr, BUFSIZE - msgLen, 0)) < 0)
                {
                        perror("SOCK READ: ");
                        return -1;
                }
                nlHdr = (struct nlmsghdr *)bufPtr;
                /* Check if the header is valid */
                if((0 == NLMSG_OK(nlHdr, readLen)) || (NLMSG_ERROR == nlHdr->nlmsg_type))
                {
                        perror("Error in received packet");
                        return -1;
                }
                /* Check if it is the last message */
                if (NLMSG_DONE == nlHdr->nlmsg_type)
                {
                        break;
                }
                /* Else move the pointer to buffer appropriately */
                bufPtr += readLen;
                msgLen += readLen;
                /* Check if its a multi part message; return if it is not. */
                if (0 == (nlHdr->nlmsg_flags & NLM_F_MULTI)) {
                        break;
                }
        } while((nlHdr->nlmsg_seq != seqNum) || (nlHdr->nlmsg_pid != pId));
        return msgLen;
}

char *ntoa(int addr)
{
        static char buffer[18];
        sprintf(buffer, "%d.%d.%d.%d",
                (addr & 0x000000FF)      ,
                (addr & 0x0000FF00) >>  8,
                (addr & 0x00FF0000) >> 16,
                (addr & 0xFF000000) >> 24);
        return buffer;
}
/* For printing the routes. */
void printRoute(struct route_info *rtInfo)
{
        /* Print Destination address */
        printf("%s\t", rtInfo->dstAddr ? ntoa(rtInfo->dstAddr) : "0.0.0.0  ");

        /* Print Gateway address */
        printf("%s\t", rtInfo->gateWay ? ntoa(rtInfo->gateWay) : "*.*.*.*");

        /* Print Interface Name */
        printf("%s\t", rtInfo->ifName);

        /* Print Source address */
        printf("%s\n", rtInfo->srcAddr ? ntoa(rtInfo->srcAddr) : "*.*.*.*");

        if (0 == rtInfo->dstAddr) {
                printf("\t\t\t^^^^^ here it is!\n");
        }

}

/* For parsing the route info returned */
void parseRoutes(struct nlmsghdr *nlHdr, struct route_info *rtInfo)
{
        struct rtmsg *rtMsg;
        struct rtattr *rtAttr;
        int rtLen;
        char *tempBuf = NULL;

        tempBuf = (char *)malloc(100);
        rtMsg = (struct rtmsg *)NLMSG_DATA(nlHdr);

        /* If the route is not for AF_INET or does not belong to main routing table
        then return. */
        if((rtMsg->rtm_family != AF_INET) || (rtMsg->rtm_table != RT_TABLE_MAIN))
                return;

        /* get the rtattr field */
        rtAttr = (struct rtattr *)RTM_RTA(rtMsg);
        rtLen = RTM_PAYLOAD(nlHdr);
        for (; RTA_OK(rtAttr,rtLen); rtAttr = RTA_NEXT(rtAttr,rtLen)) {
                switch(rtAttr->rta_type) {
                        case RTA_OIF:
                                if_indextoname(*(int *)RTA_DATA(rtAttr), rtInfo->ifName);
                                break;
                        case RTA_GATEWAY:
                                rtInfo->gateWay = *(u_int *)RTA_DATA(rtAttr);
                                break;
                        case RTA_PREFSRC:
                                rtInfo->srcAddr = *(u_int *)RTA_DATA(rtAttr);
                                break;
                        case RTA_DST:
                                rtInfo->dstAddr = *(u_int *)RTA_DATA(rtAttr);
                                break;
                }
        }
        printRoute(rtInfo);
        free(tempBuf);
}

int main()
{
        struct nlmsghdr *nlMsg;
        struct route_info *rtInfo;
        char msgBuf[BUFSIZE];

        int sock, len, msgSeq = 0;

        /* Create Socket */
        if((sock = socket(PF_NETLINK, SOCK_DGRAM, NETLINK_ROUTE)) < 0)
                perror("Socket Creation: ");

        /* Initialize the buffer */
        memset(msgBuf, 0, BUFSIZE);

        /* point the header and the msg structure pointers into the buffer */
        nlMsg = (struct nlmsghdr *)msgBuf;

        /* Fill in the nlmsg header*/
        nlMsg->nlmsg_len = NLMSG_LENGTH(sizeof(struct rtmsg)); // Length of message.
        nlMsg->nlmsg_type = RTM_GETROUTE; // Get the routes from kernel routing table .

        nlMsg->nlmsg_flags = NLM_F_DUMP | NLM_F_REQUEST; // The message is a request for dump.
        nlMsg->nlmsg_seq = msgSeq++; // Sequence of the message packet.
        nlMsg->nlmsg_pid = getpid(); // PID of process sending the request.

        /* Send the request */
        if(send(sock, nlMsg, nlMsg->nlmsg_len, 0) < 0){
                printf("Write To Socket Failed...\n");
                return -1;
        }

        /* Read the response */
        if((len = readNlSock(sock, msgBuf, msgSeq, getpid())) < 0) {
                printf("Read From Socket Failed...\n");
                return -1;
        }
        /* Parse and print the response */
        rtInfo = (struct route_info *)malloc(sizeof(struct route_info));
        // ADDED BY BOB
        /* THIS IS THE NETTSTAT -RL code I commented out the printing here and in parse routes */
        printf("Destination\tGateway\tInterface\tSource\n");
        for(;NLMSG_OK(nlMsg,len);nlMsg = NLMSG_NEXT(nlMsg,len)) {
                memset(rtInfo, 0, sizeof(struct route_info));
                parseRoutes(nlMsg, rtInfo);
        }
        free(rtInfo);
        close(sock);
        return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T21:07:19.863

Linux 的好处是几乎所有东西都是开源的。其中包括[ifConfig](http://freecode.com/projects/net-tools)的源代码。如果您不想调用远程进程，您可以轻松地将其与您的项目集成。

[ifConfig 用法](http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=/com.ibm.aix.cmds/doc/aixcmds3/ifconfig.htm)

# mysql - LIMIT 子句对 MySQL 性能的影响？

> ID：15668660
> 
> 赞同：2
> 
> 时间：2013-03-27T20:21:51.907
> 
> 标签：mysql, limit

我怀疑我已经知道了这个问题的答案，但是......

给定以下 3 个 MySQL 语句：

```
SELECT SQL_CALC_FOUND_ROWS title FROM STUFF LIMIT 1000000, 1;
SELECT SQL_CALC_FOUND_ROWS title FROM STUFF LIMIT 1;
SELECT title FROM STUFF; 
```

三者之间的性能有显着差异吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:31:13.987

`SQL_CALC_FOUND_ROWS`需要遍历所有行来计算答案，因此 1 和 2 之间没有时间差（如果表中的行少于 1000000 行，第一个查询可能不会返回任何内容）

第三个查询将输出整个表，而不仅仅是计算其行数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:25:27.187

这取决于，如果您添加`ORDER BY`并索引正在排序的列，它可能会**明显更快**。

这是因为它将在**不扫描和排序完整结果集**的情况下执行。使用索引将产生一个索引范围扫描，该扫描将在生成所需的行数后立即启动和停止。

# python - 将堆叠过滤器的行为更改为 sqlalchemy 或在 sqlalchemy 中

> ID：15668668
> 
> 赞同：0
> 
> 时间：2013-03-27T20:22:17.217
> 
> 标签：python, sqlalchemy

我想要以下内容：

```
q = db.session.query(db.models.Something).filter(a==a).filter(b==b).or().filter(c==c).filter(foo==bar) 
```

这将意味着 a=a 和 b=b 或 c=c 和 d=d。

我强烈希望避免在过滤器调用本身中应用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:32:53.553

您需要使用[`or_()`](http://docs.sqlalchemy.org/en/rel_0_8/core/expression_api.html#sqlalchemy.sql.expression.or_)and[`and_()`](http://docs.sqlalchemy.org/en/rel_0_8/core/expression_api.html#sqlalchemy.sql.expression.and_)函数：

```
from sqlalchemy.sql import or_, and_

q = db.session.query(db.models.Something).filter(
    or_(
        and_(a==a, b==b),
        and_(c==c, foo==bar)
    )) 
```

或者您可以使用`&`和`|`运算符：

```
q = db.session.query(db.models.Something).filter(
    (a==a) & (b==b) | (c==c) & (foo==bar)) 
```

请参阅[连接](http://docs.sqlalchemy.org/en/rel_0_8/core/tutorial.html#conjunctions)和[通用过滤器操作](http://docs.sqlalchemy.org/en/rel_0_8/orm/tutorial.html#common-filter-operators)。

# asp.net-mvc-4 - AngularJs、DropZone.Js、MVC4 - 拖放和预览预上传的图像

> ID：15668672
> 
> 赞同：7
> 
> 时间：2013-03-27T20:22:28.097
> 
> 标签：asp.net-mvc-4, angularjs

**html:**

```
<script src="~/Scripts/jquery-1.9.1.js"></script>
<script src="~/Scripts/DropZone-2.0.1.js"></script>
<script src="~/Scripts/angular.js"></script>
<script src="~/App_Angular/app.js"></script>

<div ng-app ="myApp" ng-controller ="ProductsCtrl">
<input ng-model="product.Name"/>
<input ng-model="product.PhotoName" id="result" />
<form id="dropzone"  class="fade well">Drop files here</form>
<input type="button" value="Upload Files" ng-click="save(product)" /> 
```

Javascript：

```
$("#dropzone").dropzone({
    url: 'Home/UploadFiles',
    paramName: "files", // The name that will be used to transfer the file
    maxFilesize: 102, // MB
    enqueueForUpload: false,
    accept: function (file, done) {
        angular.element(document.getElementById('result')).scope()
            .$apply(function (scope) {
                scope.product.PhotoName = $('#result').val();
            });

        return done();
    }
});

function uploadClicked() {
    var dz = Dropzone.forElement("#dropzone");
    for (var i = 0; i < dz.files.length; i++) {
        dz.filesQueue.push(dz.files[i]);
    }
    dz.processQueue(dz);
    $('#innerQue').empty();
} 
```

当在 ng-click 中调用 save 方法时，我已经能够成功地将照片名称传递给 $scope.product.PhotoName。

我**无法**上传图片。我不知道如何从角度调用“uploadClicked”。

任何援助将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-27T21:38:36.130

**已解决（在 Mark Rajcok 的帮助下）。**

**完整解决方案：**

**html:**

```
<script src="~/Scripts/jquery-1.9.1.js"></script>
<script src="~/Scripts/DropZone-2.0.1.js"></script>
<script src="~/Scripts/angular.js"></script>
<script src="~/App_Angular/app.js"></script>

<div ng-app ="myApp" ng-controller ="ProductsCtrl">
   <input ng-model="product.Name"/>
   <input ng-model="product.PhotoName" id="result" />
   <form id="dropzone"  class="fade well">Drop files here</form>
   <input type="button" value="Upload Files" ng-click="save(product)" />
</div> 
```

**Javascript：**

```
$("#dropzone").dropzone({
    url: 'Home/UploadFiles',
    paramName: "files", // The name that will be used to transfer the file
    maxFilesize: 102, // MB
    enqueueForUpload: false,
    accept: function (file, done) {
        angular.element(document.getElementById('result')).scope()
            .$apply(function (scope) {
                scope.product.PhotoName = $('#result').val();
            });

        return done();
    }
});

function uploadClicked() {
    var dz = Dropzone.forElement("#dropzone");
    for (var i = 0; i < dz.files.length; i++) {
        dz.filesQueue.push(dz.files[i]);
    }
    dz.processQueue(dz);
    $('#innerQue').empty();
} 
```

**在此处修改 dropzone.js：**

```
 addedfile: function (file) {
              file.previewTemplate = createElement(this.options.previewTemplate);
              this.previewsContainer.appendChild(file.previewTemplate);
 rem out -->  //file.previewTemplate.querySelector(".filename span").textContent = file.name;
 add this --> return ($('input[id=result]').val(file.name)); 
```

**角控制器：**

```
function ProductsCtrl($scope, $routeParams, $http, $location) {
$scope.products = [];
$scope.product = {};
$scope.save = function (data) {
    $scope.product = angular.copy(data);
    $http.post('/api/Products', $scope.product)
        .success(function () {
            window.uploadClicked();  <---------------------- Solution
        })
        .error(function (data) {
           // alert(data);
        });
}; 
```

**MVC 开发人员的额外奖励：**

```
 public ActionResult UploadFiles(IEnumerable<HttpPostedFileBase> files)
    {
         //Works in Everything and IE10+**

        if (!string.IsNullOrEmpty(Request.Headers["X-File-Name"]))
        {
            string path = Server.MapPath(string.Format("~/Uploads/{0}", Request.Headers["X-File-Name"]));
            Stream inputStream = Request.InputStream;

            FileStream fileStream = new FileStream(path, FileMode.OpenOrCreate);

            inputStream.CopyTo(fileStream);
            fileStream.Close();
        }
   } 
```

![在此处输入图像描述](../Images/a2907e9980b318ea672339079f83eeda.png)

# java - Java：使用线程的应用程序中的无限循环

> ID：15668673
> 
> 赞同：0
> 
> 时间：2013-03-27T20:22:29.953
> 
> 标签：java, multithreading, timer, infinite-loop

我有一家商店有很多队列。每个队列都有许多可以等待服务的最大客户端，我可以写队列的数量。我的商店必须在我给定的几分钟后关闭。问题是它没有。它只是生成服务的客户并生成等等等等。

```
import java.util.List;
import java.util.Timer;
import java.util.Scanner;

public class Main {

    public static void main(String[] args) {

        //long startTime = System.currentTimeMillis();
                long endTime;
                int nrCozi;
                int nrClientiMax;

                System.out.println("Introduceti cate minute va fi deschis magazinul: ");
                Scanner in = new Scanner(System.in);
                endTime = in.nextInt();
        endTime = System.currentTimeMillis() + endTime * 1000 * 60;

                System.out.println("Introduceti numarul de cozi: ");
                nrCozi = in.nextInt();

                System.out.println("Introduceti numarul maxim de clienti per coada: ");
                nrClientiMax = in.nextInt();
                System.out.println("clienti" + nrClientiMax);

        List<Coada> cozi = CoadaUtil.create(nrCozi, endTime);
        CoadaUtil.startCozi(cozi);

        Timer timer = new Timer();
        timer.schedule(new ClientGenerator(nrClientiMax, cozi), 0, (int) (Math.random()* 10 * 1000));

    }

} 
```

这是队列类

```
import java.util.ArrayList;
import java.util.List;

public class Coada implements Runnable {

    private List<Client> clients;
    private long closingTime;
        private long sleepTime = 0;
    private String nume;

    public Coada(long closingTime) {
        clients = new ArrayList<Client>();
        this.closingTime = closingTime;
    }

    public void setNume(String nume) {
        this.nume = nume;
    }

    public void addClient(Client c) {
        clients.add(c);
    }

    private Client pop() {
        if (clients.size() > 0) {
            Client c = clients.get(0);
            clients.remove(0);
            return c;
        }
        return null;
    }

    @Override
    public void run() {
        Client c = this.pop();
        long currentTime = System.currentTimeMillis();
        while (c != null || currentTime < closingTime) {
            if (c != null) {    
                            try {
                    System.out.println("Sunt coada " + this.nume + " si " +
                            "tratez clientul " + c.getNume());
                    Thread.sleep(c.getWaitingTime() * 1000);
                } catch (InterruptedException e) {
                }
            }
            currentTime = System.currentTimeMillis();
            c = this.pop();
         if(c==null){
                     this.sleepTime+=System.currentTimeMillis() - currentTime;
                     this.sleepTime++;
                }
                }
               // System.out.println("Coada " + this.nume +" a dormit " + this.sleepTime );

    }

    public int getClientSize() {
        return clients.size();
    }

    public String getNume() {
        return this.nume;
    }

        public long getSleepTime(){
            return this.sleepTime;
        }

} 
```

客户端生成器类

```
import java.util.List;
import java.util.TimerTask;

public class ClientGenerator extends TimerTask {

    private int nrClients;

    private List<Coada> cozi;

    public ClientGenerator(int i, List<Coada> cozi) {
        this.nrClients = i;
        this.cozi = cozi;
    }

    @Override
    public void run() {
        for (int i = 0; i < nrClients; i++) {
                        System.out.println("!!!!!!!!!!!!!Client" + i +" din " + nrClients);
            Client client = new Client((int) (Math.random() * 10), i + ""); // timp random
                        System.out.println("Clientul " + client.getNume() + " asteapta " + client.getWaitingTime()*10 + " secunde");

                        Coada coada = CoadaUtil.gasesteCoadaOptima(cozi);
            coada.addClient(client);
            System.out.println("Am adaugat clientul " + i + " la" +
                    " coada " + coada.getNume());
        }

    }

} 
```

CoadaUtil 类

```
import java.util.ArrayList;
import java.util.List;

public class CoadaUtil {

    private CoadaUtil(){}

    public static List<Coada> create(int nrCozi, long endTime) {
        List<Coada> cozi = new ArrayList<Coada>();
        for (int i = 0; i < nrCozi; i++) {
            Coada c = new Coada(endTime);
            c.setNume(i + "");
            cozi.add(c);
        }
        return cozi;
    }

    public static void startCozi(List<Coada> cozi) {
        for (int i = 0; i < cozi.size(); i++) {
            Thread t = new Thread(cozi.get(i));
            t.start();
        }
    }

    public static Coada gasesteCoadaOptima(List<Coada> cozi) {
        Coada c = cozi.get(0);
        for (Coada coada : cozi) {
            if (coada.getClientSize() < c.getClientSize()) {
                c = coada;
            }
        }
        return c;
    }

} 
```

我的猜测是它与 System.currentTimeMillis(); 从主班。

谢谢， 德拉戈斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T21:39:43.643

该程序并没有停止，因为您`Timer`在处理它们的线程完成很久之后就永远生成客户端。

`Coada`在处理线程（对象）完成后退出程序的一种简单方法是创建`Timer`一个守护线程：

`Timer timer = new Timer(true);`

当只有守护线程正在运行时，JVM 将退出。

来自[Timer](http://docs.oracle.com/javase/7/docs/api/java/util/Timer.html)的java文档：

> 在对 Timer 对象的最后一个实时引用消失并且所有未完成的任务都已完成执行后，计时器的任务执行线程优雅地终止（并成为垃圾回收的对象）。**但是，这可能需要任意长的时间才能发生。默认情况下，任务执行线程不作为守护线程运行，因此它能够防止应用程序终止。**

# php - PHP MVC - 何时何地实例化和传递用户对象以在所有视图中使用？

> ID：15668681
> 
> 赞同：0
> 
> 时间：2013-03-27T20:22:49.370
> 
> 标签：php, model-view-controller

身份验证后，我在何时何地实例化并传递 User 对象以在我的所有视图中使用？

`new User`我的逻辑是在身份验证后在我的`Login`控制器中创建一个。但是，在重定向到受保护的仪表板页面后，如何在我的所有视图中使用该对象及其数据？

我不喜欢使用静态方法，就像我对我的`Auth`和`Session`班级所做的那样。对于这两个小类，使用静态方法就可以了，对吧？

**登录控制器：**

```
class Login extends Controller {

    private $username;
    private $password;
    private $response;
    private $user;
    private $errors;

    public function __construct() {
        parent::__construct();
        $this->errors = array();
    }

    public function index() {
        $this->view->render('login/index');
    }

    public function submit() {
        $this->username = trim($_POST['username']);
        $this->password = trim($_POST['password']);

        try {
            if (!$this->isLoginValid())
                throw new Exception('invalid username or password');

            header('Location: '.URL_SSL.'dashboard');
        }
        catch (Exception $e) {
            $this->errors[] = $e->getMessage();
        }
    }

    private function isLoginValid() {
        $this->response = $this->model->submit($this->username);

        if ($this->response) {
            require APP.'lib/password_compat/password.php';

            $this->user = $this->response[0];

            if (password_verify($this->password, $this->user->password)) {
                $this->registerSessions();
                return true;
            }
            else {
                return false;
            }
        }
        else {
            return false;
        }
    }

    private function registerSessions() {
        Session::init();
        Session::set('loggedIn', true);
    }

} 
```

**仪表板控制器：**

```
class Dashboard extends Controller {

    public function __construct() {
        Auth::checkLogin();   // Checks the 'loggedIn' session
        parent::__construct();
    }

    public function index() {
        $this->view->setPageTitle('Dashboard');
        $this->view->render('dashboard/index');
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:27:45.550

您可以只存储`userId`在会话中并在任何地方使用它来创建用户对象。

然后是这样的：

```
class Dashboard extends Controller {

public function __construct() {
    Auth::checkLogin();   // Checks the 'loggedIn' session
    parent::__construct();
}

public function index() {
    $this->view->setUserDataArra((array) \Path\To\User\Class::GetUserObjectbyId($_SESSION['userId']));
    $this->view->setPageTitle('Dashboard');
    $this->view->render('dashboard/index');
}
} 
```

或者您可以在控制器中定义 $userObj 并在登录后填充它。

# python - 如何获取 numpy 函数（ufunc）参数

> ID：15668683
> 
> 赞同：3
> 
> 时间：2013-03-27T20:22:57.767
> 
> 标签：python, numpy

```
>>> import inspect
>>> import numpy as np
>>> inspect.getargspec(np.abs)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\Python27\lib\inspect.py", line 815, in getargspec
    raise TypeError('{!r} is not a Python function'.format(func))
TypeError: <ufunc 'absolute'> is not a Python function 
```

所以`inspect`不返回函数的参数`numpy`，因为它不将其识别为函数，而`numpy`似乎没有帮助函数返回函数的参数。

有谁知道如何获取任意 numpy 函数的参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-13T06:05:48.853

## 从上面的评论中复制-> 归功于 Seberg

所有 ufunc 都具有相同的签名。唯一的区别是输入和输出的数量，这些可以作为

```
.nin 
```

和

```
.nout 
```

——seberg 2013 年 3 月 27 日在 20:27

[https://stackoverflow.com/users/455221/seberg](https://stackoverflow.com/users/455221/seberg)

# php - 如何在 php 中处理大的唯一标识符？

> ID：15668685
> 
> 赞同：0
> 
> 时间：2013-03-27T20:23:03.227
> 
> 标签：php, integer

如何`id`在php中进行验证？我通常是用户`intval($_GET['id'])`，但是现在我正在处理大量数据并将`intval`它们返回为`0`.

```
$id = intval($_GET['id']); 
```

这是我的号码之一`95315898521642`

**注意：我要检查的是一个数字是否> 0**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:26:12.423

您可能想查看 long 数据类型，看看[如何在 PHP 上使用 64 位整数？](https://stackoverflow.com/questions/864058/how-to-have-64-bit-integer-on-php)了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:29:23.740

你可以`filter_var`使用`FILTER_SANITIZE_NUMBER_INT`

```
$id = filter_var($_GET['id'], FILTER_SANITIZE_NUMBER_INT);

if (!empty($id) && '-' != $id[0])
{
  echo 'Good!';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:29:26.880

如果您正在处理整数，您可以使用`ctype_digit()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T20:30:13.037

PHP 中的最大整数大小为 9223372036854775807（对于 64 位系统）和 2147483647（对于 32 位系统）。

您始终可以尝试使用`is_numeric()`来验证该值是数字还是正则表达式，例如`preg_match('/^[0-9]+$/i', $_GET['id'])`.

# java - 从项目中的另一个文件中读取数据

> ID：15668687
> 
> 赞同：0
> 
> 时间：2013-03-27T20:23:03.750
> 
> 标签：java, swing, user-interface, file-io

我陷入了一个我确信很容易克服的问题。主类用于构建 gui：

// AlladinLamp.java

```
package alladinlamp;

import javax.swing.table.*; 
import javax.swing.*; 
import java.awt.*;

class AlladinLamp  {

int fnh;
ComboBox runners;

[ ...code ]

AlladinLamp()  {

[ ...code ]

runners = new JComboBox( numberOfRunners );
       runners.setMaximumRowCount(5); 
       runners.addActionListener( new ActionListener() {   
          @Override
          public void actionPerformed( ActionEvent e ) {
             String  runnersNumber = ( String )runners.getSelectedItem();
             fnh = Integer.parseInt( runnersNumber ); 
}

[ ...code ]

public int getFNH() { return fnh; }

[ ...code ]

SwingUtilities.invokeLater( new Runnable()  {
            @Override
            public void run()  {
                AlladinLamp lamp = new AlladinLamp();                 
            }
        });

} 
```

我希望能够从另一个文件中读取 fnh

```
package alladinlamp; 

Class Processes  {

   int fullNH;
   AlladinLamp lamp;

   Processes()  {
      lamp = new AlladinLamp();
      fullNH = lamp.getFNH();

[ ...code ]

}

[ ...code ]

} 
```

但它没有发生（ fnh = null ）。整数是在它创建的同一个文件中读取的。我究竟做错了什么？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:39:45.653

我怀疑这里发生的事情是 AlladinLamp 中的 actionPerformed() 方法设置了您感兴趣的变量，在您的 Processes 类的构造函数**之后**被调用......它试图使用该数字。在这里尝试的简单方法是在该 actionPerformed 中插入一个 System.out.println 并在您的 AlladinLamp 和 Processes 构造函数的末尾，并查看事情发生的顺序。

正如其他海报提到的那样，它与包裹无关。如果您未指定 public，则默认可见性是包级别的可见性，因此应该没问题。

忘了提......请记住，Swing 库是一个基于事件的 GUI 库。所以你的 GUI 将首先被构建。直到稍后才会调用该 actionPerformed 方法……一旦设置了整个 UI 并且您从组合框中选择了某些内容。

# java - 在 Android 上使用 root 调用 'ls' 不会返回任何内容，应用程序挂起

> ID：15668688
> 
> 赞同：2
> 
> 时间：2013-03-27T20:23:04.197
> 
> 标签：java, android, root

我正在开发一个需要 root 的 Android 应用程序。它使用 root 访问一些内部内存的东西，然后我调用`ls`一个目录。然后我从中读取，如果有数据，效果很好，但如果目录为空，应用程序就会挂起。有没有解决这个问题的好方法？

这是代码

```
 final Runtime runtime = Runtime.getRuntime();
            try {
                // Perform su to get root privileges
                Process p = runtime.exec("su");
                DataOutputStream output = new DataOutputStream(p.getOutputStream());
                output.writeBytes("ls " + directoryPath + "\n");
                output.flush();
                InputStream stdout = p.getInputStream();
                byte[] buffer = new byte[1024];
                int read;
                String out = new String();
                while(true){
                    //If ls found no files it hangs on this line
                    read = stdout.read(buffer);
                    out += new String(buffer, 0, read);
                    if(read < 1024){
                        break;
                    }
                }
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T21:34:33.793

以下对我有用：请参阅我的[流程助手](https://bitbucket.org/jholetzeck/ministatus-android/src/0d594b5dbe0f9c838c4a61cb0e339f1ae11cb883/src/de/holetzeck/util/ProcessHelper.java?at=default)，然后例如

```
Pair<Integer, String> ret = ProcessHelper.runCmd(true, "su", "-c", "ls -l"); 
```

# jquery - 集合内的 JQuery 选择

> ID：15668693
> 
> 赞同：2
> 
> 时间：2013-03-27T20:23:18.927
> 
> 标签：jquery

我有多个相同类型的控件，ID 中间带有“xyz”：

```
 <input type="text" id="AutoStuff_hfyrt_xyz_MoreStuf_123" />
    <input type="text" id="AutoStuff_fyhrt_xyz_MoreStuf_7" /> 
```

如果我想要以“123”结尾的那个，我想应该是：

```
 var x = $("input[id*='xyz']").("[id$='123']").val() 
```

但我收到一个错误，“需要标识符”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:27:19.493

您可以使用[Multiple Attribute Selector](http://api.jquery.com/multiple-attribute-selector/)[`.filter()`](http://api.jquery.com/filter/)或简单地将两者结合起来。

```
// Using .filter()
var x = $("input[id*='xyz']").filter("[id$='123']").val();

// Using the Multiple Attribute Selector
var x = $("input[id*='xyz'][id$='123']").val(); 
```

[**演示**](http://jsfiddle.net/NVwPL/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:26:30.177

尝试

```
var x = $("input[id*='xyz']").$("[id$='123']").val(); 
```

或者

```
var x = $("[id$='123']", $("input[id*='xyz']")).val(); 
```

在第二种情况下，您可能需要切换参数或选择器的顺序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:26:54.870

var x = $('#AutoStuff_hfyrt_xyz_MoreStuf_123') 将是选择器。[] 用于属性，所以我认为这可能是导致该错误的原因。

```
[attr] has attribute
[attr=val] has attribute with value val
[attr!=val] does not have attribute with value val
[attr^=val] attribute begins with val
[attr$=val] attribute ends with val
[attr*=val] attribute includes val
[attr~=val] attribute includes val as a word
[attr|=val] attribute begins with val and optional hyphen 
```

来自 jquery 袖珍指南。

# visual-studio - 从用户的角度进行负载测试

> ID：15668694
> 
> 赞同：0
> 
> 时间：2013-03-27T20:23:25.283
> 
> 标签：visual-studio, scalability, jmeter, load-testing

我被要求在我目前工作的公司加载测试网页。到目前为止，一切都很好。

但是.....项目经理希望以真实用户的身份运行测试，生成请求/与网站交互。

在我看来，这是要实现的真实场景：计算机模拟用户与网站实例交互记录、导航、购买等。因此，为了实现这个目标，我开始寻找一些负载测试工具。

自上周以来，我一直在检查其中的两个：Visual Studio Ultimate 2012 负载测试工具和 JMeter。它们似乎都是执行负载测试的好选择。我已经成功地使用它们创建、运行和配置了测试。

我的问题：我无法用他们模拟真实用户。他们都不运行 JS，也不渲染 HTML（据我所知），以及其他类似浏览器的任务。

所以，我的问题是：我可以使用一些其他工具执行这样的负载测试吗？或者也许以我从未听说过的方式*与他们在一起？*有没有人遇到过这些问题并有经验可以分享？

我考虑过创建一个脚本来启动多个线程中的测试，每个测试都可能运行一个 Selenium Web Driver 测试。但我不相信这可以适当地扩展，也不相信我至少可以达到令人满意的测试性能。我们的目的是模拟从几百到几千（可能是 2-3k）同时与网站交互的用户。

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T06:56:16.557

我不知道您如何在这里定义“真实用户”。我对 JMeter 有一些经验，我做过的最接近的“真正的类似用户”的案例是制作一个包含用户将执行的典型请求列表的脚本。例如：

1.  用户 X 登录网站。
2.  用户 X 请求一个页面来查看他的个人资料
3.  用户 X 更新他的信息
4.  用户 X 通过点击一个随机朋友的名字来请求他朋友的页面
5.  用户 X 退出

然后我们在 100 秒内生成大约 100 个线程，模拟 100 个用户 X 在高时间做同样的事情。通过这种方式，结合一个好的分析器，我们可以估计当有 100 个用户同时在线时系统的性能（例如，平均响应率、最大响应率......）以及哪个函数是瓶颈我们必须考虑优化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-20T18:57:00.233

使用 Visual Studio，您可以记录与 UI 的交互，然后将这些记录加载到负载测试中并运行这些负载测试。您可以记录任何类型的 UI 交互。所以我不知道为什么您的操作无法与真实用户匹配。我的 asp.net mvc 3 站点正在大量使用淘汰赛、json、JS，我能够在使用 VS Ultimate 2012 进行负载测试时成功运行所有性能测试而没有任何问题，所以我不确定你为什么会遇到问题。

有关创建 UI 记录测试和负载测试的详细信息 - [http://msdn.microsoft.com/en-us/library/vstudio/dd293540.aspx](http://msdn.microsoft.com/en-us/library/vstudio/dd293540.aspx)

**如果有人需要有关负载测试策略的一些信息**- 您可以构建各种策略，例如 40% 的用户将购买产品，而 60% 的用户将只是导航。您可以使用各种策略来查看您的机器在不同负载下的表现，并找出资源的阈值是多少，然后您需要扩大或扩大规模。只要系统响应线性，它应该没问题，但是当您看到平均峰值时。响应时间，平均 页面时间（秒），这是您需要采取一些行动的时间。

有关构建负载测试策略的详细信息 - [http://msdn.microsoft.com/en-us/magazine/cc188783.aspx](http://msdn.microsoft.com/en-us/magazine/cc188783.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T18:40:11.760

你说：

> 我考虑过创建一个脚本来启动多个线程中的测试，每个测试都可能运行一个 Selenium Web Driver 测试。

您可以使用[NeuStar 网络性能](http://www.neustar.biz/enterprise/web-performance/what-is-load-testing)（以前称为 BrowserMob）做到这一点。您上传几个 Selenium 脚本并基于这些脚本配置测试。然后 NeuStar 配置 Amazon 云机器来运行您的场景、监控它们并提供漂亮的报告。

它不是免费的。对于涉及多达 25 个用户的测试来说，它非常便宜（几美元），而您需要的虚拟用户越多，它的价格就越高。也就是说，它背后的引擎叫做[BrowserMob Proxy](http://opensource.webmetrics.com/browsermob-proxy/)，它是开源的，所以你可以自己做一些努力。

# mysql - MySQL GROUP BY 和 SUM 值

> ID：15668700
> 
> 赞同：0
> 
> 时间：2013-03-27T20:24:09.523
> 
> 标签：mysql

我有一个包含以下数据的 MySQL 表：

```
filer            time               name        size-percentage-used  disk-count
filer01a  2012-01-19 05:59:02  aggr0                     96               3
filer01a  2012-01-19 05:59:02  ncna01a_aggr01            97              42
filer01a  2012-01-19 05:59:02  ncna01a_aggr02            96              22
filer01a  2012-01-19 05:59:02  ncna01a_aggr03             0              22
filer01a  2012-01-19 12:00:01  aggr0                     96               3
filer01a  2012-01-19 12:00:01  ncna01a_aggr01            97              42
filer01a  2012-01-19 12:00:01  ncna01a_aggr02            96              22
filer01a  2012-01-19 12:00:01  ncna01a_aggr03             0              22
filer01a  2012-01-20 12:00:01  aggr0                     96               3
filer01a  2012-01-20 12:00:01  ncna01a_aggr01            97              42
filer01a  2012-01-20 12:00:01  ncna01a_aggr02            96              22
filer01a  2012-01-20 12:00:01  ncna01a_aggr03             0              22
filer01a  2012-01-21 12:00:01  aggr0                     96               3
filer01a  2012-01-21 12:00:01  ncna01a_aggr01            97              42
filer01a  2012-01-21 12:00:01  ncna01a_aggr02            96              22
filer01a  2012-01-21 12:00:01  ncna01a_aggr03             0              22
filer01a  2012-01-22 12:00:02  aggr0                     96               3
filer01a  2012-01-22 12:00:02  ncna01a_aggr01            97              42
filer01a  2012-01-22 12:00:02  ncna01a_aggr02            96              22
filer01a  2012-01-22 12:00:02  ncna01a_aggr03             9              22
... 
```

申报者名单从 01 到 102，时间每天更新。我需要一个查询，它将提供 filer、sum( `disk-count`) 作为 DDM、size-percentage-used 和 max(time)。

我正在寻找的输出将是：

```
 filer    DDMs     size-percentage-used  time                
 ncna01a  89                         96  2012-01-19 05:59:02
 ncna01a  89                         96  2012-01-19 05:59:02
 ncna02a  89                         96  2012-01-19 05:59:02
 ... 
```

我是一个完整的 MySQL 新手，感谢任何和所有的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:28:55.547

据我了解，您将需要类似以下查询的内容：

```
SELECT SUM(disk-count) AS ddms, 
       AVG(size-percentage-used) AS percent_used, 
       MAX(time) as max_time 
FROM filers 
GROUP BY filer 
```

# ruby-on-rails - 模拟“”收到意外消息

> ID：15668703
> 
> 赞同：0
> 
> 时间：2013-03-27T20:24:52.963
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, ruby-on-rails-3.2

我有以下代码

```
Class Client 
  def initialize(options = {})
    @key = options['oauth_key']
    @secret = options['oauth_secret']
    @access_token_url = options['oauth_access_token_url']
    @signature_method = options['signature_method']
    @consumer = OAuth::Consumer.new(@key, @secret, {access_token_url: @access_token_url, signature_method: @signature_method})
  end

  def accounts_by_id(account_id)
    response = query_account(account_id)
    parse_json(response)
  end

  private
  def access_token()
    ...
    ...
    ... 
    @access_token = @consumer.get_access_token(nil)
    ...
  end 
```

消费者被嘲讽如下

```
oauth_mock = mock('oauth')
OAuth::Consumer.stubs(:new).returns(oauth_mock) 
```

`:get_access_token with (nil)`然而，当我做一个模拟“oauth”时收到意外消息

```
GameSystem::Client.new(oauth_key: 'KEY',oauth_secret: 'SECRET',oauth_access_token_url: 'http://localhost').accounts_by_id("kk") 
```

access_token 方法在 query_account 中被调用。有谁知道我也可以模拟它来克服这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T22:58:31.283

你正在存根`OAuth::Consumer.new`返回你的模拟，但你没有在你的模拟上存根任何东西，所以它没有`#get_access_token`方法（或任何其他方法）。您必须对要在模拟中使用的方法进行存根。

```
oauth_mock = mock
oauth_mock.stubs(:get_access_token).returns(whatever)
Oauth::Consumer.stubs(:new).returns(oauth_mock) 
```

# javascript - 闭包的全局对象

> ID：15668704
> 
> 赞同：4
> 
> 时间：2013-03-27T20:24:55.957
> 
> 标签：javascript, node.js

JS中有一些非常基本的东西我不确定。所以我想问问。

全局对象是`window`（或者`global`当然对于 node.js）。因此，我们可以例如通过变量的名称获取变量的值`window[myVariableName]`。

问题是如何使用闭包的局部变量来做到这一点？

```
function myFunction()
{
  // some code here    
  console.log(global_object[myVariableName]);
} 
```

甚至可以通过名称获取变量的值，当变量是当前闭包的全局但不属于`window`对象时，甚至可以通过名称获取变量的值。

根据我对 JS 及其工作原理的了解 - 这是不可能的。

顺便说一句，如何通过变量的名称获取变量的值是一个非常流行的面试问题，并且从未提到变量是全局的:)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:32:33.957

```
eval('var value = ' + myVariableName + ';');
console.log(value); 
```

是的， eval 是邪恶的，但它**是**一个解决方案（虽然是一个奇怪的任务）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T20:33:50.113

你可以用所有的邪恶来做到这一点`eval`

```
function test() {
 var a = 5;
 var myname = "a";
 console.log(eval(myname))
}

test() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:45:47.887

对于闭包，变量不能是“全局的”。
它要么是全球性的，要么不是。

如果不是，那么它在函数范围内。

如果它在函数的范围内，那么在该函数之外获取它的唯一方法是将其设置为从函数返回的属性，或者将其附加到对象/数组中传递给函数，或者在函数内部创建一个函数，返回该变量...

```
// modifying an object
var my_func = function (obj) {
    var hidden = 1;
    obj.hidden = hidden;
};

var my_obj = {};
my_func(my_obj);
my_obj.hidden; // 1

// returning a function
var my_func = function () {
    var a = 1,
        b = 2,
        c = 3,

        get_a = function () { return a; },
        get_b = function () { return b; },
        get_c = function () { return c; };

    return { a : get_a, b : get_b, c : get_c };
};

var my_obj = my_func();
my_obj.a(); // 1
my_obj.b(); // 2
my_obj.c(); // 3 
```

如果您希望通过“名称”来执行此操作，那么您将在闭包中创建一个对象，然后创建一个函数，该函数接受一个字符串并按名称查找该对象的属性。

```
// get property by name

var my_func = function () {
    var properties = {
        a : 1,
        b : 2,
        c : 3
    };

    return {
        get : function (name) {
            return properties[name]; // returns undefined if it doesn't exist
        }
    }; 
};

var my_obj = my_func();
my_obj.get("a"); // 1
my_obj.get("b"); // 2 
```

现在你可以。

PS：`eval();`并不总是保证以上述方式工作。
例如，将来`eval`应该在自己的范围内运行，并且无法访问调用函数的范围（与构建`new Function("...");`工作的方式相同）。

## ***编辑***

为了更进一步，更好地回答您关于`"global"`范围的问题：

```
window.bob = "Bob";

var outer_A = function () {
        var mid_A = function () {
            var inner_A = function () {
                console.log("INNER-A");
                console.log("bob = "  + bob );
                console.log("doug = " + doug);
            };

            inner_A();
        };

        mid_A();
    },

    outer_B = function () {
        var mid_B = function () {
                var doug = "Doug",

                    inner_B = function () {
                        console.log("INNER-B");
                        console.log("bob = "  + bob );
                        console.log("doug = " + doug);
                    };

                inner_B();
            },

            mid_C = function () {
                var inner_C = function () {
                    console.log("INNER-C");
                    console.log("bob = "  + bob );
                    console.log("doug = " + doug);
                };

                inner_C();
            };

        mid_B();
        mid_C();
    };

outer_A();
outer_B(); 
```

这对你有什么好处？
您最终应该得到一个如下所示的打印输出：

```
/*

INNER-A
bob = Bob
doug = undefined

INNER-B
bob = Bob
doug = Doug

INNER-C
bob = Bob
doug = undefined

*/ 
```

你为什么会这样呢？
好吧，很简单，因为你有分支功能范围。
`doug`在 内定义`mid_B`。
在其中创建的任何函数都`mid_B`可以潜在地访问`doug`.
在外部创建的任何函数都`mid_B`不能访问`doug`。

当`inner_C`被要求记录`doug`时，首先它检查是否`doug`存在于它自己的函数中。
如果不存在，则检查它是否存在于其父函数范围（`mid_C`）中。
如果不存在，则检查它是否存在于***其父***函数范围（`outer_B`）中。
如果不存在，则检查它是否存在于***其父***函数范围（`window`）中。
如果你一直回到`window`，它没有父函数范围
......所以如果它甚至不在`window`，那么将值设置为`undefined`。

同时，`inner_B`找不到`doug`，所以它检查`mid_B`并找到`doug`。

这不会使`doug`“全球”。
它成功了`in-scope`。

“全球”将是如果`outer_A`, `mid_A`, `inner_A`, `outer_B`, `mid_B`, `inner_B`,`mid_C`并且`inner_C`所有人都可以访问...

...那将是`bob`。
`bob`是全球性的。

它是全局的，因为它附加到 window 对象（或在 中定义为 a `var`，`global-scope`除了使用 时，它的工作方式几乎相同`delete`）。
并且因为所有子函数都有返回到的函数作用域`window`，所以所有函数都可以访问任何定义为属性/变量的东西`window`（除非在作用域链的上游有一个同名的变量，此时它会选择第一个它命中）。

这就是`global`意思，为什么在这个例子`doug`中不是变量。`global`

# sql - 如果我可以在不定义它们的情况下加入，那么主键和外键的目的是什么？

> ID：15668705
> 
> 赞同：1
> 
> 时间：2013-03-27T20:24:56.060
> 
> 标签：sql, database, database-design, constraints

由于我可以在不使用关系键（主键和外键）的情况下连接两个表，那么首先定义这些键的目的是什么？

例如，我的第一张桌子是

```
customer table
fields are cust_id, lastname, firstname 
```

我的第二张桌子是

```
product table
fields are product_id, productno, cust_id 
```

即使我没有将任何字段声明为主键或外键，我仍然可以加入这两个表：

```
SELECT *
FROM customer c
LEFT OUTER JOIN product p ON p.custid=c.cust_id 
```

那我为什么要定义键呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T20:38:12.407

有一些很好的答案，请允许我推断一下。

正如“dasblinkenlight”所述，检索速度（数据库提前知道两个表之间的关系并可能优化查询），更重要的是，参考/数据完整性。

让我们再谈谈第二个。

考虑一个简单的场景，您有以下三个表（我已对此进行了简化。实际上，您可以订购许多产品，但为了简洁起见，我保持简单）：

```
CustomerTable
   ID
   FirstName
   LastName

OrderTable
   ID
   CustomerID
   ProductID    

ProductTable
   ID
   Description 
```

没有外键，我们可以自由地：

*   创建没有产品的订单
*   创建没有客户的订单
*   删除有订单的客户
*   删除具有产品等的订单...

**这是灾难的秘诀**

通过使用外键，我们可以重新设计上述内容，因此：

```
CustomerTable
   ID
   FirstName
   LastName

OrderTable
   ID
   CustomerID -> References CustomerTable.ID
   ProductID -> References ProductTable.ID

ProductTable
   ID
   Description 
```

我们可以指定 CustomerID 和 ProductID 为“NOT NULL”（就像其他列一样）。这意味着要创建一个订单，我们*必须*有一个现有的客户和一个现有的产品。优秀的！

但它会变得更好。如果我开始删除产品会怎样？除非我们指定了一些级联选项（参见[this](http://en.wikipedia.org/wiki/Foreign_key#CASCADE)），否则数据库将抛出一个不稳定的消息并说“不。你不能删除它，它被某些东西引用了”。

这是等式的*数据完整性*部分。我们不能指向不存在的东西（外键坚持我们不指向任何东西[如果允许 null]，或者存在的东西。主键可以帮助我们解决这个问题）。

突然之间，数据库本身正在确保一切都很好地协同工作并很好地联系起来。没有它，您可以删除所有订单...删除产品...删除您想要的任何内容，然后您的应用程序会想知道到底发生了什么。

使用它们 ：）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T20:29:28.157

告诉您的 RDBMS 这两个键相关的两个原因是

*   **加快检索**速度 - 当您声明主键到外键关系时，RDBMS 可能会添加隐式索引以加快连接速度
*   **处理参照完整性**——RDBMS 可以检查删除主键以查看您是否正在删除从“子”记录引用的行，并可选择删除子记录或引发错误。如果您尝试使用在父表中没有匹配主键的外键插入记录，您的 RDBMS 也会告诉您。

除此之外，可以以类似的方式使用键和非键字段。特别是，在未声明为主键或外键的列上加入当然没问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-27T20:30:27.720

这不是关于“*能够加入*”，而是关于允许进入表格的内容。另外，如果您删除了一个客户，但数据库中有未完成的产品，会发生什么？如果没有外键，它们就是所谓的**孤立记录。**默认情况下，添加外键会**阻止**您删除子表引用的对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-27T20:52:25.600

这些概念都是关于约束的。

`PRIMARY KEY`is 约束表示一组列是唯一的，而不是`NULL`。大多数实现使用索引来支持这一点，并且在某些实现中，主键也是用于在磁盘存储中对页面中的数据进行排序的集群索引。

A`FOREIGN KEY`是一个约束，它指示一组列引用另一个表中的另一组列。通常外键仍然可以是`NULL`，但如果不是`NULL`，那么它必须是它引用的表中的有效键，并且它也必须是唯一的。它引用的键不必是主键，只需一个唯一键（数据库通常从唯一约束或索引等约束中确定）。外键本身不必有索引，但这通常是一个好主意，因为删除引用的表中的行需要在允许删除之前检查所有外键。这些都属于参照完整性的概念。

一般来说，数据库上的所有约束都可以保护数据完整性，也可以让优化器了解这些限制并获得更多关于最佳执行计划的线索。但是，可以简单地在表上具有适当的唯一索引，并且仍然获得相同的执行计划，而索引不作为主键的一部分或作为定义外键引用的前兆，但事实上索引是独特肯定会影响计划的选择。

查询 (DML) 中*允许*做很多事情，但 DDL 声明了数据的**结构**。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-27T20:29:15.923

简短的回答，数据完整性。

同样使用这样的外键将确保随着更多数据输入到表中，搜索发生得更快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-27T20:36:28.847

连接仅用于“公共变量”，因此连接可用于连接两个表中值相等的表。主键必须是唯一的，因此您可以始终引用它们，因此您也可以将它们用作其他表的引用。基本上，当您从 2 个表中进行查询时，发生的事情是笛卡尔积。（这在实际实现中不会发生，因为时间是一个因素），这会产生大量数据，但是连接会减少结果中的数据（理论上）。您可以在此处阅读有关联接的更多信息：

[http://www.w3schools.com/sql/sql_join.asp](http://www.w3schools.com/sql/sql_join.asp)

# jquery - jquery datepicker UTC

> ID：15668706
> 
> 赞同：2
> 
> 时间：2013-03-27T20:25:00.387
> 
> 标签：jquery, jquery-ui-datepicker

因此，当我保存事件时，我将其保存为 UTC。偏移量对于事件是正确的，并且它们显示正确。我有日期选择器...如果我单击一天，它会返回本地时区日期。因此，如果我在 -7，那么当我单击 2013 年 3 月 27 日时，应该会显示 2013 年 3 月 28 日凌晨 02:30 的事件。他们不是。

我可以将我点击的日期设为 UTC 日期吗？

# android - 通过 Web 服务将 JSON 数据从 Android 应用程序传输到数据库

> ID：15668708
> 
> 赞同：0
> 
> 时间：2013-03-27T20:25:06.793
> 
> 标签：android, json, web-services, rest, cloud

我正在开发一个记录传感器数据并对其进行汇总的 Android 应用程序，输出为 JSON 数据。这样做是为了将更少量的数据传输到服务器，因为它将存储在云数据库中。为此，我正在构建一个 RESTful Web 服务。我现在正在考虑两种选择：

1) 从 Android 应用程序为每条记录调用 Web 服务以将其插入数据库

2）从Android应用程序调用Web服务来传输整个JSON文件，然后在云端解析它，并将每条解析的记录插入数据库中

在我看来，选项 2 似乎更有效，因为可能有 100 条记录要插入到数据库中，并且调用 web 服务 100 秒的时间并不理想。请问各位小伙伴有什么看法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:31:15.430

我肯定会选择选项＃2。没有理由让您的应用程序如此健谈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:41:33.163

我认为答案取决于您收集传感器数据的速度。如果速率相对较低（每隔几秒），那么我建议您使用第一个选项（假设近实时数据有好处）。如果您的传感器数据被更频繁地获取（再次，相对而言），那么您的第二个建议更有意义。另外，考虑连接问题，因为这是移动的。提高更新速率可减少因连接丢失而丢失数据的机会。但我不能说你的数据的重要性。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T10:12:27.483

@user1135357 - 您将数据存储在云数据库中 - 究竟是哪个云数据库？您是否已经为您提供了一项特定的服务，或者还没有决定一项服务？

# ios - 默认 iPad 字母数字键盘进入数字模式

> ID：15668711
> 
> 赞同：6
> 
> 时间：2013-03-27T20:25:23.083
> 
> 标签：ios, keyboard, uitextfield, numeric

我有一个 UITextField 供用户输入他们的街道地址。我已将该字段的键盘适当地设置为默认值。

由于大多数人的街道地址都以数字开头，我希望它默认为数字模式，就好像用户已经按下了 .?123 键一样。这样，他们可以立即开始输入地址的数字部分，并且只要按下空格键，它就会立即转换回字母。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:12:42.897

当前没有执行此操作的设置或选项。您必须以编程方式执行此操作，方法是通过`UITextFieldTextDidChangeNotification`或使用`textField:shouldChangeCharactersInRange:replacementString:`委托方法通过通知观察空格键输入，然后切换键盘。

即使使用 UIKeyboardTypeNumbersAndPunctuation，iOS 也会在空格键后切换到字母键盘。这在 5.0 中已修复。

当您为某个字段切换键盘类型时，您实际上只是在说明下次显示时使用哪个键盘。如果键盘已经显示，切换类型不会改变它。所以，隐藏键盘，切换类型，然后再次显示：

```
[textField1 resignFirstResponder];
[textField1.keyboardType = UIKeyboardTypeAlphabet];
[textField1 becomeFirstResponder]; 
```

# asp.net - 如何在 Windows azure 上部署网站（不是 Web 应用程序）

> ID：15668714
> 
> 赞同：-1
> 
> 时间：2013-03-27T20:25:31.060
> 
> 标签：asp.net, azure

我想在 Windows azure [http://www.windowsazure.com/en-us/develop/net/tutorials/get-started/](http://www.windowsazure.com/en-us/develop/net/tutorials/get-started/)上部署一个网站（不是网络应用程序） 这个链接指南关于部署网络应用程序而不是网站

我已经使用 Visual Studio 2010 创建了网站，并希望使用 Visual Studio 进行部署

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T22:34:39.540

您可以使用 WebDeploy 或基于 FTP 的发布方法，如下所述：

[如何针对 Windows Azure 网站使用 VS 2010 的 Web 部署和 FTP 发布（不使用 Azure SDK）](http://social.msdn.microsoft.com/Forums/en-US/windowsazurewebsitespreview/thread/4ffc50e0-56ca-43c1-8c5c-a3171daf5c34)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T22:57:21.640

您也可以使用 Git 发布，详见[本文](http://www.windowsazure.com/en-us/develop/net/common-tasks/publishing-with-git/)

使用 Git 进行部署的优势在于通过 BitBucket、Github 或 CodePlex 进行持续部署方面。在 Bitbucket 中创建您的 Git 存储库（例如 - 允许私有存储库，因此即使您的网站不是开源的，与 Github 不同，您也可以使用它），将其链接到您的 Azure 帐户，然后将代码推送到 Bitbucket。然后，Azure 将自动为您部署该站点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T01:51:27.223

从您提供的链接安装工具后，您将获得与 Web 应用程序项目相同的网站项目体验。

按着这些次序：

1.  下载网络发布更新
2.  使用发布配置文件导入您的 Azure 网站
3.  点击发布

仅供参考，您还可以从 ASP.NET 2012.2 更新获取更新[http://weblogs.asp.net/scottgu/archive/2013/02/18/announcing-release-of-asp-net-and-web-tools- 2012-2-update.aspx](http://weblogs.asp.net/scottgu/archive/2013/02/18/announcing-release-of-asp-net-and-web-tools-2012-2-update.aspx)。一旦发布，这些也将包含在 VS Update 2 中。

# java - 如何使用 Swing Timer 来延迟进度条的加载

> ID：15668715
> 
> 赞同：1
> 
> 时间：2013-03-27T20:25:31.563
> 
> 标签：java, swing, timer, progress-bar, sleep

我需要找到一种方法来使用带有进度条的 Swing Timer。我尝试使用 Thread.sleep()，但是当我使用它时它使应用程序崩溃。有什么方法可以使用 Swing Timer 而不是 Sleep()？

```
public void piiEros(int dist)
{
    Pii pii = new Pii();
    pii.setVisible(true);
    for(int pc = 0;100 > pc; pc++)
    {
        try {
            Thread.sleep(dist/100);
        } catch (InterruptedException ex) {
            Logger.getLogger(Trav.class.getName()).log(Level.SEVERE, null, ex);
        }
        pii.pg.setValue(pc);
    }
    pii.dispose();
    o.Eros();
} 
```

注意：Pii 是一个带有进度条的类。Dist 是它加载的速度。Trav 是方法所在的类。Pc 代表 %，完成了多少会显示在条上。o.Eros 打开另一个 GUI。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T21:19:11.777

（从长远来看）使用`SwingWorker`. 它提供了许多有用的方法来更新 UI（从事件调度线程的上下文中），同时允许在后台继续执行......

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.GridBagLayout;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.util.List;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JProgressBar;
import javax.swing.SwingWorker;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class TestSwingWorker02 {

    public static void main(String[] args) {
        new TestSwingWorker02();
    }

    public TestSwingWorker02() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });
    }

    public class TestPane extends JPanel {

        public TestPane() {
            setLayout(new GridBagLayout());
            JProgressBar pb = new JProgressBar();
            add(pb);

            new ProgressWorker(pb, 40).execute();
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 200);
        }

    }

    public class ProgressWorker extends SwingWorker<Void, Integer> {

        private int delay;
        private JProgressBar pb;

        public ProgressWorker(JProgressBar progressBar, int delay) {
            this.pb = progressBar;
            this.delay = delay;
        }

        @Override
        protected void process(List<Integer> chunks) {
            // Back in the EDT...
            pb.setValue(chunks.get(chunks.size() - 1)); // only care about the last one...
        }

        @Override
        protected Void doInBackground() throws Exception {
            for (int index = 0; index < 100; index++) {
                publish(index);
                Thread.sleep(delay);
            }
            return null;
        }

        @Override
        protected void done() {
            // Back in the EDT...
            //pii.dispose();
            //o.Eros();
        }

    }

} 
```

`SwingWorker`允许您分离逻辑。在该`doInBackground`方法中，您可以专注于需要在 EDT 之外运行的那部分代码，您可以分别`publish`更新回 EDT 和`process`它们。完成后，`done`您可以根据需要进行清理。

`SwingWorker`还提供了进度监控功能，因此，在您的情况下，如果您不想这样做，您就不必使用 API 的`publish`/`process`部分。这将允许您将 a 附加`PropertyChangeListener`到工作人员，而无需向其公开进度条。（但我为这个例子做了）

```
public class ProgressWorker extends SwingWorker<Void, Integer> {

    private int delay;
    private JProgressBar pb;

    public ProgressWorker(JProgressBar progressBar, int delay) {
        this.pb = progressBar;
        this.delay = delay;
        // You can use a property change listener to monitor progress updates...
        addPropertyChangeListener(new PropertyChangeListener() {
            @Override
            public void propertyChange(PropertyChangeEvent evt) {
                if ("progress".equalsIgnoreCase(evt.getPropertyName())) {
                    pb.setValue((Integer)evt.getNewValue());
                }
            }

        });
    }

    @Override
    protected Void doInBackground() throws Exception {
        for (int index = 0; index < 100; index++) {
            setProgress(index);
            Thread.sleep(delay);
        }
        return null;
    }

    @Override
    protected void done() {
        // Back in the EDT...
        //pii.dispose();
        //o.Eros();
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T21:03:33.370

你可以`piiEros`用这种方式改变你的方法：

```
public void piiEros(int dist)
{
    final Pii pii = new Pii();
    pii.setVisible(true);
    javax.swing.Timer  timer = new javax.swing.Timer(dist/100, new ActionListener()
    {
      public void actionPerformed(ActionEvent evt)
      {
        pii.pg.setValue(pg.getValue()++);
        if ( pii.pg.getValue() > 100 )
        {
          timer.stop();
          pii.dispose();
          o.Eros();
        }
      }
    });
    timer.setInitialDelay(0);
    timer.setRepeats(true);
    timer.start();
} 
```

# ios - 对于大量内容，我应该在 CoreData 中使用什么 Objective-C 类型？

> ID：15668717
> 
> 赞同：1
> 
> 时间：2013-03-27T20:25:34.340
> 
> 标签：ios, objective-c, core-data

我正在开发一个阅读文章的应用程序（短到中型，想想 300 到 3,000 个字）。我将与服务器同步并将内容本地存储在 CoreData 模型中。用于内容字段的最佳类型是什么？从性能的角度来看，什么是最有效的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:32:31.973

如果只是纯文本，请将其存储在 Core Data 字符串属性中，该属性对应于`NSString`. 将其转换为其他格式不会为您带来任何好处。如果它是某种类型的富文本，您可能需要使用 Core Data 二进制属性（==`NSData`读取/写入时的实例）。

# c - 为什么按位运算比旧微处理器上的加法/减法运算略快？

> ID：15668718
> 
> 赞同：24
> 
> 时间：2013-03-27T20:25:34.397
> 
> 标签：c, bit-manipulation, bitwise-operators, cpu-architecture, digital-logic

我今天看到了这段摘录：

> 在大多数较旧的微处理器上，按位运算比加法和减法运算稍快，通常比乘法和除法运算快得多。在现代架构中，情况并非如此：按位运算的速度通常与加法相同（尽管仍比乘法快）。

我很好奇为什么按位运算比旧微处理器上的加法/减法运算要快一些。

我能想到的所有会导致延迟的是，实现加法/减法的电路取决于几个级别的逻辑门（并行加法器等），而按位运算的电路实现要简单得多。这是原因吗？

我知道算术和按位运算都在现代处理器上的一个时钟周期内执行，但纯粹谈谈电路的传播时间，理论上现代处理器中的延迟是否仍然存在？

最后，我有一个关于按位移位操作执行的概念性 C 问题：

```
unsigned x = 1;
x <<= 5;

unsigned y = 0;
y += 32; 
```

两者`x`和`y`都应该保持 value `32`，但是否需要**5**次单独的左移才能`x`达到该值（如通过管道实现的按位移位）？为了澄清，我纯粹是在询问电路行为而不是时钟周期数。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-27T20:35:04.010

在任何二进制位运算中，每个输出位仅取决于输入中的两个相应位。在加法运算中，每个输出位取决于输入中的相应位以及右侧的所有位（朝向较低值）。

例如，01111111 + 00000001 的最左边位为 1，但 01111110 + 00000001 的最左边位为 0。

在最简单的形式中，加法器将两个低位相加并产生一个输出位和一个进位。然后添加接下来的两个最低位，并添加进位，产生另一个输出位和另一个进位。这重复。因此，最高输出位位于加法链的末尾。如果像旧处理器那样一点一点地进行操作，那么需要时间才能完成。

通过将几个输入位输入更复杂的逻辑安排，有一些方法可以加快速度。但这当然需要更大的芯片面积和更大的功率。

今天的处理器有许多不同的单元来执行各种工作——加载、存储、加法、乘法、浮点运算等等。鉴于当今的能力，与其他任务相比，添加的工作量很小，因此它适合单个处理器周期。

也许从理论上讲，您可以制造一个按位运算比加法运算更快的处理器。（至少在纸面上，有一些奇异的处理器异步运行，不同的单元按照自己的节奏工作。）然而，随着设计的使用，你需要一些固定的周期来协调处理器中的许多事情——加载指令，将它们分派到执行单元，将结果从执行单元发送到寄存器等等。一些执行单元确实需要多个周期来完成它们的工作（例如，一些浮点单元需要大约四个周期来进行浮点加法）。所以你可以混合。然而，在当前规模下，使循环时间更小以使其适合按位运算但不适合加法可能不经济。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-27T20:38:16.987

加法的复杂之处（你通常可以免费减法）是存在讨厌的进位问题。

因此，您最终得到的天真的解决方案是 N 次[全加器](http://en.wikipedia.org/wiki/Adder_%28electronics%29#Full_adder)，其中 N 是您的 ALU 的位宽。

这些讨厌的携带意味着你有很多传播延迟。而且，由于一次结转可能会使整个结果不准确，因此您最终不得不等待相当长的时间来等待所有的结转值，而反过来，链上的所有其他全加器都必须等待结算。

有很多方法可以绕过这个特定的瓶颈，但没有一种方法像全加器链那样简单或资源便宜。（最快的是在硅中实现的查找表）

如果您想了解更多详细信息，您可能需要在[http://electronics.stackexchange.com](http://electronics.stackexchange.com)上提问

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-28T11:23:34.380

要回答你的最后一个问题，这取决于。有些架构只有 1 的移位（例如 z80），有些架构公开了较大的常量和/或变量的移位，但在内部将它们*实现*为一堆“移位 1”（例如 x86 的旧实现），有一些架构可以在一个周期内移位超过 1，但只有当移位量是一个常数时，有些架构（例如 x86 的现代实现）使用[桶形移位器](http://en.wikipedia.org/wiki/Barrel_shifter)并且可以在一个周期内移位一个变量，还有更多的可能性。

桶形移位器的电路深度与它可以做的最大移位成对数，这不一定是寄存器的宽度 - 它有时比宽度小一，甚至可以想象它更小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T20:38:56.020

一些加法实现必须为进位位做一个额外的循环。例如：16 位整数需要在 8 位处理器上执行多条指令。这也适用于转变。但是移位总是可以将高度位移动到下一个字节的较低位。加法必须在另一轮中添加低位。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-27T20:37:08.027

位操作符的执行时间更短，因为

*   处理器需要一条指令来执行按位操作，并且（比如说）需要一个执行周期，另一方面，其他算术指令（特别是乘法和除法）需要更多的执行周期
*   大多数情况下，逐位运算是在一个寄存器中执行的，而其他算术指令需要处理一个以上的寄存器

这就是为什么移位比其他算术运算更快的原因

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-03-27T20:30:12.563

这是我从汇编类的介绍中看到的。但是移位只是处理器可以执行的最快指令。加减法需要一些指令来执行。我想现代处理器会得到更好的优化。

想必有人可以更准确、更彻底地回答这个问题。

# asp.net - 在第二页使用 ASP.Net WebForm 输入，然后返回原始页面

> ID：15668723
> 
> 赞同：0
> 
> 时间：2013-03-27T20:25:44.253
> 
> 标签：asp.net

我有一个由文本框填充的 ASP.Net WebForm(EntryForm.aspx)，供用户填写，并将传递给数据库。我的客户希望用户单击一个按钮和一个弹出窗口以打开此弹出窗口中来自 entryform 文本框 (addressTextBox.txt) 的所有信息作为格式化页面供用户阅读和确认。如果正确，用户将单击将关闭弹出窗口的确认按钮，返回原始表单并填充确认字段，然后允许用户继续执行表单的下一步。如果单击取消按钮，它只会关闭弹出窗口，用户可以编辑他们的原始条目。

好的，所以我决定尝试使用 ASP 面板和 javascript 来显示/隐藏面板。这似乎最简单。我找到了一个不错的脚本，它似乎可以做我想做的事，但有问题。

我使用的是 Site.Master，所以我假设我将脚本函数放在页面的内容区域内。像这样

```
 <asp:Content ContentPlaceHolderID ="MainContent" runat="server">
   <script type =" text/javascript">
       function ShowPanel()
       {
       var panel = document.getElementById("<%=ConfirmPanel.ClientID%>");
       panel.style.display = 'block';
       return false;
       }
       </script> 
```

然后我打电话给它

```
<asp:Button ID="SubmitInfoButton" runat="server" Text="Submit Entry"
OnClientClick="return ShowPanel();"/> 
```

但面板从不显示在屏幕上。有什么建议么？

再次感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:58:14.810

由于它在同一页面上，因此您最好使用 javascript 来处理它。

在您的表单上放置一个按钮，该按钮将显示一个隐藏的 div（绝对使用 z-index 定位）。

然后，使用 javascript 将值复制到 div 内的标签中。在隐藏的 div 内，您可以放置​​一个按钮，该按钮将再次隐藏 div（您的确认按钮）并填充该字段（或启用“继续”按钮）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T05:51:45.890

当我之前在我的应用程序中这样做时，我使用了 Ajax 工具包中的 ModalPopupExtender 控件，我强烈建议您也这样做。模态弹出窗口实际上只是一个面板，其中应用了一些 css 以使其显示为模态。一个优点是您只需使用 .net C# 或 VB 代码即可完成所有操作，而不必使用 javascript。另一个优点是它看起来更专业，有一个模式弹出而不是浏览器弹出。但是，如果您要坚持使用 javascript，我会尝试删除 return from 这个词`OnClientClick="return ShowPanel();"`，如果这不起作用，只需在后面的代码中注册 javascript，然后在后面的代码中从按钮的单击事件中调用它。

# sql-server - 使用 group by 的 SQL Server GMT 日期和时间转换每小时报告

> ID：15668736
> 
> 赞同：0
> 
> 时间：2013-03-27T20:26:14.130
> 
> 标签：sql-server, group-by, case, gmt

几天来，我一直在努力解决这个问题，并且希望得到一些关于如何正确处理这个问题的反馈或建议。

我正在尝试创建一个每小时运行的 SQL 查询，该查询选择前一小时的所有记录并将它们插入到新的报告表中。我当前的 SQL 查询按预期工作；但我现在需要找出如何调整`CreationHour`和`CreationDate`根据客户的 GMT 设置

问题是付款记录是根据服务器日期/时间（即 GMT -5 和数据类型`datetime`）插入的，所以我需要根据客户 GMT 以某种方式调整时间，然后添加或减去 -5 GMT服务器。

到目前为止，我唯一能想到的是使用 CASE 语句，但问题是我需要使用相同的 CASE 语句 5 次，这将有 73 个可能的 WHEN 语句。

任何人都可以就如何解决此问题或解决此问题提出更好的选择吗？到目前为止，上周我遇到了 3 个死胡同，找不到更优化的方法来解决这个问题。

这是我正在执行的当前 SQL 查询：

```
SELECT 
   P.ComputerID, P.CustomerID, MAX(C.GMT) AS TimeAdguest,
   MAX(DATEPART(HOUR, dateadd(hour, (C.GMT -1), P.CreationDateTime))) AS [CreationHour], 
   Convert(varchar(10),MAX(dateadd(hour, (C.GMT -1),P.CreationDateTime)),101) AS [CreationDate],
   SUM(P.SecondsPurchased) AS [Seconds],
   SUM(P.PagesPurchased) AS [Pages], 
   SUM(P.Amount) AS [Amount]
FROM [Payments] P
left Join Customer C ON C.CustomerID = P.CustomerID
WHERE 
    DATEPART(HOUR, P.CreationDateTime) = DATEPART(HOUR, dateadd(hour,-1, getdate()))
    AND Convert(varchar(10), dateadd(hour, -1, P.CreationDateTime), 101) = Convert(varchar(10), dateadd(hour, -1, getdate()), 101)
GROUP BY 
    Convert(varchar(10),P.CreationDateTime,101), P.ComputerID, P.CustomerID 
```

并返回以下结果：

```
ComputerID  CustomerID  TimeAdguest CreationHour    CreationDate    Seconds Pages   Amount
-------------------------------------------------------------------------------------------
 7679   1188    -2  8   03/27/2013  1670    0   56.9600009918213
12891   42  17  3   03/28/2013  740 0   26.7200005054474
12893   42  17  3   03/28/2013  480 0   20.1400001049042
12894   42  17  3   03/28/2013  280 0   10.8799998760223
12943   42  17  3   03/28/2013  120 0   1
12943   1188    -2  8   03/27/2013  240 0   2
13407   1188    -2  8   03/27/2013  960 0   40.2800002098084
13476   1188    -2  8   03/27/2013  840 0   25.6999996900558
14281   42  17  3   03/28/2013  562 0   6
16026   1188    -2  8   03/27/2013  1134    0   13 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:44:54.847

下面的 SQL 通过删除报告的小时数的计算得到了简化，即我假设您想要报告日期时间的 @t1 到 @t2（本地服务器时间）之间的付款。CreationHour 和 CreationDate 是 P.CreationDateTime 通过添加 5 小时（以获取 GMT 时间）然后添加客户时区相对于 GMT 的偏移量来调整到客户时区。

```
SELECT P.ComputerID, P.CustomerID,
HOUR(DATEADD(HOUR, 5 + C.GMT, P.CreationDateTime)) AS [CreationHour],
CONVERT(VARCHAR(10),DATEADD(HOUR, 5 + C.GMT, P.CreationDateTime),101) AS [CreationDate],
SUM(P.SecondsPurchased) AS [Seconds],
SUM(P.PagesPurchased) AS [Pages], 
SUM(P.Amount) AS [Amount]
FROM [Payments] P
INNER JOIN Customer C ON C.CustomerID = P.CustomerID
WHERE P.CreationDateTime BETWEEN @t1 AND @t2
GROUP BY P.ComputerID, P.CustomerID,
HOUR(DATEADD(HOUR, 5 + C.GMT, P.CreationDateTime))
CONVERT(VARCHAR(10),DATEADD(HOUR, 5 + C.GMT, P.CreationDateTime),101) 
```

# validation - 验证成功后，什么会导致 Grails GORM 保存失败？

> ID：15668740
> 
> 赞同：2
> 
> 时间：2013-03-27T20:26:35.643
> 
> 标签：validation, grails, save, grails-orm

在验证和保存之前，我检查了我的域对象：

```
class MyDomain ... {
    static belongsTo = [owner: AnotherClass]
    ...
} 
```

“所有者”设置正确。然后我验证；它通过了。然后我保存；它抛出一个关于 order_id 为空的异常。即使`failOnError:false`在`save`.

这发生在集成测试中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T15:00:46.040

即使您的实例根据约束是有效的，保存也可能会失败，因为它取决于数据库。想象一下，如果你有：

```
class Person {
  ...  
  Integer age
  ...
  static constraints = {
    age nullable: true
  }
} 
```

还有一个例子：

```
def person = new Person(age: 9999) 
```

在您的数据库表中，人的年龄可以具有最大值**999**。您的实例是有效的，但插入会引发错误。

依赖于触发器的外键和操作也会发生同样的情况。

# java - box2d 身体不动

> ID：15668749
> 
> 赞同：0
> 
> 时间：2013-03-27T20:27:02.180
> 
> 标签：java, android, box2d, andengine

所以，我有这样的事情：

```
physicsWorld=new PhysicsWorld(new Vector2(10, 10), false);
Rectangle test = new Rectangle(100, 100, 50, 50, vbom);

FixtureDef wallFixtureDef = PhysicsFactory.createFixtureDef(0, 0f, 0.5f);

Body body = PhysicsFactory.createBoxBody(physicsWorld, test, BodyType.DynamicBody, wallFixtureDef);
physicsWorld.registerPhysicsConnector(new PhysicsConnector(test, body));
body.setLinearVelocity(100, 100);

registerUpdateHandler(physicsWorld);

attachChild(test); 
```

它不起作用，身体不动。任何想法为什么？

GLES 2 锚中心

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T15:17:50.573

根据我的观点，您必须在代码中应用两个更改。

1.  通过以下方式更改物理世界构造函数值

    mPhysicsWorld = new PhysicsWorld(new Vector2(0,SensorManager.GRAVITY_EARTH),false);

2.  按照以下方式更改 PhysicsConnector

    新的 PhysicsConnector(test,body,true,true);

我认为第二个建议对您有用，因为在您的代码中，我看到您没有更新对象的位置和旋转。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T04:42:59.043

你的物理世界注册到你的游戏场景。它工作我的设备和身体正在移动。

```
 PhysicsWorld physicsWorld = new PhysicsWorld(new Vector2(10, 10), false);
    Rectangle test = new Rectangle(100, 100, 50, 50,
            getVertexBufferObjectManager());
    FixtureDef wallFixtureDef = PhysicsFactory
            .createFixtureDef(0, 0f, 0.5f);
    Body body = PhysicsFactory.createBoxBody(physicsWorld, test,
            BodyType.DynamicBody, wallFixtureDef);
    physicsWorld.registerPhysicsConnector(new PhysicsConnector(test, body));
    body.setLinearVelocity(100, 100);
    yourScene.registerUpdateHandler(physicsWorld);
    yourScene.attachChild(test); 
```

# ajax - ADFS 会话过期并导致错误

> ID：15668751
> 
> 赞同：7
> 
> 时间：2013-03-27T20:27:14.710
> 
> 标签：ajax, adfs

我们将 ADFS 用于我们的内部应用程序 - 用户基本上可以在每次访问我们的应用程序之一时透明地登录。但是，如果用户将页面打开超过一个小时然后尝试在该页面上执行某些操作（而不是导航到另一个页面），他们会收到错误消息：

> 此页面正在访问不受其控制的信息。这会带来安全风险。你要继续吗？

该页面似乎正在尝试将该请求重定向到 ADFS 服务器，而浏览器正在阻止该请求。

因此，我的问题是：如何捕捉这种情况并让用户到 ADFS 服务器重新进行身份验证？

我没有任何运气在谷歌上找到任何关于此的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-08T21:40:56.580

更新：以下解决方案取决于 iframe。ADFS 3.0 的 X-Frame-Options 默认为 DENY，没有更改设置的选项。因此，此解决方案仅适用于 ADFS 2.1 及更早版本。

在您的 global.asax.cs 中，您将想要捕获任何中间 AJAX 302 并将它们变成 401 Unauthorized。这将阻止调用继续进行（并弹出该消息），并将我们发送到 $(document).ajaxError()。

```
 protected void Application_EndRequest()
    {
        var context = new HttpContextWrapper(this.Context);
        if (context.Response.StatusCode == 302 && context.Request.IsAjaxRequest())
        {
            context.Response.Clear();
            context.Response.StatusCode = 401;
        }
    } 
```

然后，在那里，拦截任何 401，然后再进行其余的错误处理。我选择向用户显示一条消息。您可以在此处执行下一步，但为了便于阅读，我将 ajaxSettings 对象发送到另一个函数。返回 true，这样它就不会继续进行其余的错误处理。

如果您想仔细检查这是否是 ADFS，event.target.referrer 将具有尝试重定向的 URL。

```
$(document).ajaxError(function (event, jqXHR, ajaxSettings, thrownError) {
    if (xhr.status == 401) { 
        alert("Your session has timed out. Click OK to reauthorize and extend your session.");

        TriggerReauthenticationRefresher(ajaxSettings); 
        return true;
    }
…the rest of the error handling code…            
}); 
```

对于这种情况，我的页面中有一个空 div，其 id 为“refresherBox”，但您可以在 DOM 中的任何元素上执行此操作。将一个 iframe 放在一起，该 iframe 会转到您域中的某个虚拟页面。就我而言， ADFSRefresher.cshtml 的内容只是

```
 <div><input type="hidden" value="@DateTime.Now.ToString()" /></div> 
```

我没有使用全局变量，而是使用 .data() 存储 ajaxSettings。我们还需要跟踪 iframe 重新加载的次数，因此我们还要存储 loadcount。将 iframe 插入 DOM，它就会启动。

```
function TriggerReauthenticationRefresher(ajaxSettings) {
    var refreshframe = '<iframe src="@Url.Action("ADFSRefresher", "Debug")" style="display:none" onload="TrackFrameReloads()" />';

    $('#refresherBox').data('loadcount', 0);
    $('#refresherBox').data('originalRequestSettings', ajaxSettings);

    $('#refresherBox').html(refreshframe);
} 
```

每次 iframe 完成加载时都会触发 TrackFrameReloads。由于我们知道即将发生 ADFS 重定向，因此它会触发两次。第一次是重定向，第二次是到它的 src url。所以它第一次触发时，我们只是增加 loadcount。

第二次触发时，我们知道我们已成功重新验证。检索 ajaxSettings，清除存储的数据，然后您可以重新使用原始设置发送 AJAX 调用！它将通过、取消重定向并运行其最初的成功和完整功能。

```
function TrackFrameReloads() {
    var i = $('#refresherBox').data('loadcount');
    if (i == 1) {
        alert('Your session has been extended.');

        var ajaxSettings = $('#refresherBox').data('originalRequestSettings');

        $('#refresherBox').removeData();

        $.ajax(ajaxSettings);

    } else {
        $('#refresherBox').data("loadcount", 1);
    }
} 
```

请注意，如果您定义了它们，则 error 和 complete 函数将已经触发。

如果愿意，您可以跳过向用户发送的两条警报消息。根据您的 ADFS 设置，这应该只需要 1 秒钟，并且用户根本不需要被告知发生了任何事情！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-07T15:15:48.850

您可以在 global.asax 中手动检查和重新颁发安全令牌，并使用它来创建滑动会话。对于滑动会话，您可以选择推迟重新身份验证，直到这样做变得“安全”（此时数据将不再因 ADFS 重定向而丢失）。

在 SessionSecurityTokenReceived 事件中，您可以评估令牌和请求。如果令牌已过期并且请求会因重定向而丢失数据，您可以重新发出新的“临时”令牌。新令牌的寿命应该很短，只要足够长，您就可以安全地完成当前请求。然后令牌将过期并在下一次请求时再次评估。

```
protected void SessionAuthenticationModule_SessionSecurityTokenReceived(object sender, SessionSecurityTokenReceivedEventArgs e)
{
    var now = DateTime.UtcNow;
    SessionSecurityToken token = e.SessionToken;
    var httpContext = new HttpContextWrapper(this.Context);

   if (now > token.ValidTo
       && (httpContext.Request.IsAjaxRequest() || httpContext.Request.HttpMethod == "POST"))
   {
       var sessionAuthModule = (SessionAuthenticationModule)sender;
       e.SessionToken = sessionAuthModule.CreateSessionSecurityToken(token.ClaimsPrincipal,
                                                                     token.Context,
                                                                     now,
                                                                     now.AddMinutes(2),
                                                                     token.IsPersistent);
       e.ReissueCookie = true;
   }
} 
```

ADFS 会话将继续推迟重新身份验证，直到下一个 GET 请求。然后重定向最终将发生，并且将向用户发出正常寿命的适当令牌。

# javascript - 根据raido按钮输入加载动态内容

> ID：15668755
> 
> 赞同：0
> 
> 时间：2013-03-27T20:27:37.743
> 
> 标签：javascript, jquery, html, css

我有 4 个框，a、b、c、d，如果我用户选择框 a，我希望它执行以下操作；

选择图片 a 加载内容 1

选择图片 b 加载内容 2

选择图片 c 加载内容 3

选择图像 d 加载内容 4

我希望在单击单选按钮之前隐藏所有可能加载的内容。到目前为止，它都是隐藏的，但是当单击单选按钮时，不会加载任何内容。

谢谢！

```
<div id="framework">
    <div class="element">
        <img style="float:left;" src="img/left.png" />
        <img style="padding-left:25px; float:left;" src="img/right.png" />
        <img style="padding-left:25px; float:left;" src="img/both.png" />
        <img style="padding-left:25px; float:left;" src="img/without.png" />
    </div>
    <form class="actions">
        <div style="clearfix:none;" class="confirm">
            <input type="radio" id="frame_left" name="framework">
        </div>
        <div style="clearfix:none;" class="confirma">
            <input type="radio" id="frame_right" name="framework">
        </div>
        <div style="clearfix:none;" class="confirmb">
            <input type="radio" id="frame_both" name="framework">
        </div>
        <div style="clearfix:none;" class="confirmc">
            <input type="radio" id="frame_without" name="framework">
        </div>
    </form>
</div>
<script>
    $(document).ready(function() {
        // do your checks of the radio buttons here and show/hide what you want to
        $("#navLeft").hide();
        $("#navRight").hide();
        if ($("#frame_left:checked").length > 0) {
            $("#navLeft").hide();
        }

        // add functionality for the onclicks here
        $("#frame_left").click(function() {
            $("#navleft").show();
        });

        $("#frame_right").click(function() {
            $("#navRight").hide();
        });
    });
</script>
<img id="navLeft" src="img/left.png" />
<img id="navRight" src="img/right.png" />
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:45:37.310

`navLeft`（使用 CamelCase）是您的 DIV 的 ID，但您`navleft`在脚本中使用（不使用 Camelcase）。

你在隐藏`navRight`，如果你点击`frame_right`你的 JS 会`navRight`再次隐藏？这不合逻辑，还是？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:55:13.880

我会使用 switch 语句来执行此操作，并默认使用 css 隐藏内容元素。 [一个工作小提琴](http://jsfiddle.net/R9MnT/2/)。不知道你的意思`frame_without`。也许只是为了什么都不显示，就像现在一样。

```
$(document).ready(function(){
$('input[name="framework"]').change(function() {
    $('#navLeft, #navRight').hide();

    switch($('input[name="framework"]:checked').attr('id')) {
        case "frame_left":
           $("#navLeft").show();
            break;
        case "frame_right":
            $("#navRight").show();
            break;
        case "frame_both":
           $("#navLeft, #navRight").show();
            break;
         case "frame_without":
            //Dont know what here should happen
            break;
    }
});
}); 
```

隐藏内容的css：

```
#navLeft, #navRight {
    display: none;
} 
```

# filepicker.io - 有什么方法可以指定首选的 mime 类型？

> ID：15668758
> 
> 赞同：0
> 
> 时间：2013-03-27T20:27:48.540
> 
> 标签：filepicker.io

有没有办法指定首选的 mime 类型？例如，我的服务接受 HTML 和 Word 文件。如果它来自 Google Docs，我想使用他们的本地转换（即我更喜欢获取 HTML 文件）。但是，我还希望能够从 Dropbox 中选择 word 文件（我将在本地进行转换）。如果我在 mimetypes 中同时指定两者，它总是给我一个 word 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T01:55:35.440

目前这个功能不存在，但我已经提交了一张票。我们可能会优先处理 mimetypes 数组，即 ['text/html', 'application/msword'] 将返回 html 文档，而 ['application/msword', 'text/html'] 将给出你这个词医生。当我们取得进展时，我会更新这个

# html - 带有 Bootstrap 的谷歌地图没有响应

> ID：15668762
> 
> 赞同：48
> 
> 时间：2013-03-27T20:28:11.027
> 
> 标签：html, css, google-maps-api-3, twitter-bootstrap

我正在使用引导程序并嵌入了 Google Maps API 3。

`#map_canvas`没有反应；这是一个固定的宽度。

另外，如果我使用`height: auto`并且`width: auto`地图没有显示在页面中。

为什么？

```
<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
#map_canvas {
   height: 400px;
    width: auto;
  }
</style>

<div class="container">
 <div class="row">
  <div class="span6">
   <div id="map_canvas"></div>
  </div>
 </div>
</div> 
```

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2013-03-27T20:39:41.180

***已修订：官方帖子已过时，因此我更新了答案并改进了代码。***

以下方法**不需要引导程序或任何其他框架**。它可以独立使用以使任何内容响应。通过计算对父元素应用填充[`aspect ratio`](http://en.wikipedia.org/wiki/Aspect_ratio)。然后使用绝对位置将子元素放置在顶部。

**的HTML：**

```
<div class="iframe-container">
    <!-- embed code here -->
</div> 
```

**CSS：**

```
.iframe-container{
    position: relative;
    width: 100%;
    padding-bottom: 56.25%; /* Ratio 16:9 ( 100%/16*9 = 56.25% ) */
}
.iframe-container > *{
    display: block;
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    margin: 0;
    padding: 0;
    height: 100%;
    width: 100%;
} 
```

* * *

下面的“小提琴”有如何制作的例子：

*   **响应式谷歌地图**
*   **响应式 OpenStreetMap**
*   **响应式 Vimeo 视频**
*   **响应式 Youtube 视频**

## 演示：http: [//jsfiddle.net/LHQQZ/135/](http://jsfiddle.net/LHQQZ/135/)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-05-10T11:42:43.947

这使用了固定纵横比为 16/9的 Bootstrap 的[响应式嵌入功能：](http://getbootstrap.com/components/#responsive-embed)

```
<div class="embed-responsive embed-responsive-16by9">
    <div id="map_canvas" class="embed-responsive-item" style="border: 1px solid black"></div>
</div> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-06-23T22:06:51.797

使地图在高度和宽度上都调整大小：

[http://niklausgerber.com/blog/responsive-google-or-bing-maps/](http://niklausgerber.com/blog/responsive-google-or-bing-maps/)

2018 年 9 月 27 日更新：据报道链接已关闭，不确定多少，所以我将我的网络存档搜索链接到他的 github：

[https://github.com/niklausgerber/responsive-google-or-bing-maps](https://github.com/niklausgerber/responsive-google-or-bing-maps)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-09-30T08:09:48.367

极其简单。使用 CSS 使地图相对于视口高度：

```
.map {
  height: 80vh;
} 
```

这指定 .map 容器必须是视口高度的 80%。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-01-13T18:13:08.513

如果其他人看这个，就有这样的问题。

我有一个带有openstreet 地图的iframe，但我无法使其响应。我终于放了一个“img-responsive”课程，一切都很好。

```
<iframe class="img-responsive" width="350" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="YOUR OPENSTREET URL HERE" style="border: 1px solid black"></iframe> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-09-01T05:07:46.030

# 09 2021

自从提出这个问题以来已经 8 年了。
如果你们中的任何人仍在寻找解决方案但找不到，那就在这里。

## Boostrap 5（经过测试和工作）

添加`width="100%"`到谷歌地图`iframe`

```
<div class="row">
    <div class="col-6">
        <iframe src="SOURCE" width="100%" OTHER_ATTRIBUTES></iframe>
    </div>
</div> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-27T20:29:08.453

你可以给`span6`类一个宽度和高度，然后给`map_canvas`一个宽度和高度`100%`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-10T15:44:07.407

Smartik 的回答效果很好。我正在使用 gmaps4rails gem 并将这些更改应用于生成的 css，如下所示：

```
.map_container {
padding: 6px;
border-width: 1px;
border-style: solid;
border-color: #ccc #ccc #999 #ccc;
-webkit-box-shadow: rgba(64, 64, 64, 0.5) 0 2px 5px;
-moz-box-shadow: rgba(64, 64, 64, 0.5) 0 2px 5px;
box-shadow: rgba(64, 64, 64, 0.1) 0 2px 5px;
display: block;
}

.gmaps4rails_map {
  display: block;
  height: 400px;
} 
```

然后将这些行添加到我的视图中：

```
<div class="map_container">
  <div id="map" class="gmaps4rails_map">
    <div id="map_canvas" class="span9">
      <%= gmaps({"map_options" => { "type" => "ROADMAP", "center_longitude" => 180,"auto_zoom" => false, "zoom" => 16, "auto_adjust" => true}, "markers" => { "data" => @json }})%>
    </div>
  </div> 
</div> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-09-24T02:04:23.070

```
<div class="map_container">
    <div id="map" class="gmaps4rails_map">
        <div id="map_canvas" class="span9">
            <%= gmaps({"map_options" => { "type" => "ROADMAP", "center_longitude" => 180,"auto_zoom" => false, "zoom" => 16, "auto_adjust" => true}, "markers" => { "data" => @json }})%>
        </div>
    </div> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-03-30T05:04:55.000

[这篇博文](https://www.ostraining.com/blog/coding/responsive-google-maps/)有一个很好的解决方案。

> 在嵌入代码周围添加一个 div 标签。使用 CSS 类 map-responsive，这样你的代码现在看起来像这样：

```
<div class="map-responsive">
    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d386950.6511603643!2d-73.70231446529533!3d40.738882125234106!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c24fa5d33f083b%3A0xc80b8f06e177fe62!2sNueva+York!5e0!3m2!1ses-419!2sus!4v1445032011908" width="600" height="450" frameborder="0" style="border:0" allowfullscreen></iframe>
</div> 
```

> 现在在您的样式表文件之一中添加一些 CSS 属性：

```
.map-responsive{
    overflow:hidden;
    padding-bottom:56.25%;
    position:relative;
    height:0;
}
.map-responsive iframe{
    left:0;
    top:0;
    height:100%;
    width:100%;
    position:absolute;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-11-16T01:12:07.490

对于那些使用 javascript api（不是 iframe）嵌入的人：

```
<div class="googleMapContainer">
  <div id="map"></div>
</div> 
```

```
.googleMapContainer {
    position: relative;
    &:after {
      content: "";
      display: block;
      padding-bottom: 100%;
    }
}

#map {
  position: absolute;
  height: 100%;
  width: 100%;
  right: 0;
  overflow: hidden;
} 
```

# java - 将 Class 对象映射到通用对象

> ID：15668770
> 
> 赞同：0
> 
> 时间：2013-03-27T20:28:34.450
> 
> 标签：java, spring, generics

所以我有一个抽象实体`Compound`和一个抽象 Service `CompoundService<T extends Compound>`。

还有另一个服务类需要访问`CompoundService<T extends Compound>`（任意数字，编译时未知的实现）的任何实现。这在 1 个特定方法中是必需的，并且该方法可以采用类参数`Class<? extends Compound>`。

问题是我如何类型安全地将此类映射到相应的服务类？

类似的东西`Map<Class<? extends Compound>, CompoundService<? extends Compound>>`不起作用，因为我需要通用参数`CompoundService`是特定的而不是通配符。

我不确定如何解释这一点。但`compoundService.getById(compoundId)`返回 type 的`Compound`实例`T`或`compoundService.save(compound)`需要`compound`type `T`。这意味着

```
Map<Class<? extends Compound>, CompoundService<? extends Compound>> services = //...;
CompoundService<T> compoundService = services.get(compoundClass); 
```

不起作用，因为 `CompoundService<? extends Compound>>`不能强制转换为`CompoundService<T>`.

嗯，不确定这是否有帮助。问题是 Class 对象`Class<? extends Compound>`到这个“类型”服务类的映射`CompoundService<? extends Compound>`。

有什么想法可以实现这一目标吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T21:13:06.057

我相信这是你想要做的：

```
abstract class Compound { }

class Compound1 extends Compound { }

abstract class CompoundService<T extends Compound> {
    ...
}

class Compound1Service extends CompoundService<Compound1> {
    ...
}

public class Test {

    static Map<Class<? extends Compound>, CompoundService<? extends Compound>> serviceMap = new HashMap<Class<? extends Compound>, CompoundService<? extends Compound>>();

    public static <T extends Compound> void main(String[] args) {
        serviceMap.put(Compound1.class, new Compound1Service());
        CompoundService<Compound1> service = getServiceFromMap(Compound1.class);
        System.out.println(service.getClass());
    }

    public static <T extends Compound> CompoundService<T> getServiceFromMap(Class<T> clazz) {
        return(CompoundService<T>)serviceMap.get(clazz);
    }

} 
```

我认为您不会比这更好并避免由于类型擦除而导致的演员表

# c# - 使用来自 SQLDataReader 的多个结果集

> ID：15668773
> 
> 赞同：1
> 
> 时间：2013-03-27T20:28:43.043
> 
> 标签：c#, linq-to-sql

我目前正在从事一个学校项目，并希望有人可以为我提供以下在线教程。这是一个家庭作业，所以我不是在找人给我答案，但我想找到一个与我预期的解决方案相似的教程。我一直在谷歌搜索 SQLDataReader 和 Linq，但无法找到类似于我所追求的解决方案。

我正在将我的 C# 客户端项目连接到 SQL 数据库。该数据库包含一个 Dogs 表和一个 BreedOfDog 表，以说明狗可以是混合品种的事实。BreedOfDog 有两个值，DogId 和 BreedId，将 Dog 表连接到 Breed 表。在我的客户端应用程序中，有一个为狗提供信息的容器。还有一个包含品种对象列表的 Dog 类。品种对象列表将用于用狗的品种填充列表框。这是我打算用伪代码做的：

创建一个允许多个结果集的 SQL 查询。我将使用 SQL 数据库中的存储过程

打开与 SQL 数据库的连接

执行将获取 Dog 对象列表的第一个查询

执行第二个查询。此查询将在第一个查询中为每只狗提取 DogId，在 BreedOfDog 上执行查询，创建 Breed 对象列表并将其添加到 Dog 对象。这将为 Dogs 列表中的每个 Dog 执行。

关闭连接

有没有好的教程可以指点我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:41:21.910

```
 List<DogClass> Dogs = new List<DogClass>();
    string SQL = "select DogId from Dog";
    SqlCommand Command = new SqlCommand(SQL, Con);
    SqlDataReader Reader = Command.ExecuteReader();
    while (Reader.Read())
    {
        DogClass Dog = new DogClass(Reader, Con);
        Dogs.Add(Dog);
    }
    Reader.Close(); 
```

* * *

```
using System;
using System.Collections.Generic;
using System.Data.SqlClient;

class DogClass
{
    string DogId;
    List<BreedClass> Breeds = new List<BreedClass>();

    internal DogClass(SqlDataReader Reader, SqlConnection Con)
    {
        DogId = Convert.ToString(Reader.GetValue(Reader.GetOrdinal("DogId"))).Trim();
        string SQL = "select BreedOfDog from Breeds where DogID = '" + DogId + "'";
        SqlCommand Command = new SqlCommand(SQL, Con);
        SqlDataReader Reader2 = Command.ExecuteReader();
        while (Reader2.Read())
        {
            BreedClass Breed = new BreedClass(Reader);
            Breeds.Add(Breed);
        }
        Reader2.Close();
    }
} 
```

* * *

```
using System;
using System.Data.SqlClient;

class BreedClass
{
    internal string Breed;

    internal BreedClass(SqlDataReader Reader)
    {
        Breed = Convert.ToString(Reader.GetValue(Reader.GetOrdinal("BreedOfDog"))).Trim();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:45:44.993

我记得在程序员学校（大学）做同样的问题！你会喜欢 linq to sql。你需要做的是：

1.  右键单击要放置 linq 数据类的文件夹。单击添加新项目 -> LINQ to SQL 类。
2.  然后，打开服务器资源管理器并将表拖放到 LINQ to SQL 类设计器上。
3.  然后，进入您想要使用该类的 .cs 页面并为您的数据库类实例化一个新对象，例如`DataClasses1DataContext db = new DataClasses1DataContext();`.
4.  然后，您可以通过 LINQ to SQL 语句操作数据库，就像`IQueryable<BREED> breeds = db.BREEDs.Take(50);`. 有关如何使用 LINQ 读取/写入/删除/等的信息，请参阅本文。[http://msdn.microsoft.com/en-us/library/bb882643.aspx](http://msdn.microsoft.com/en-us/library/bb882643.aspx)

# eclipse - Eclipse WebLogic 根目录

> ID：15668776
> 
> 赞同：0
> 
> 时间：2013-03-27T20:28:52.687
> 
> 标签：eclipse, weblogic

我正在开发一个 JSF 2.0 开发项目，该项目使用一些我不拥有且无法编辑的外部页眉和页脚文件。html 页眉和页脚文件引用了被引用的图像和 css `/images/corp_logo.gif`。

我以前通过将图像和 css 目录放在 Tomcat 根目录中，使项目在 Tomcat 7.0 中正常工作：

`C:\Users\1234\Documents\workspace\.metadata\.plugins\org.eclipse.wst.server.core\tmp2\wtpwebapps\ROOT`

但是，当我更改为 WebLogic 时，我找不到文件应该驻留的正确目录。该域位于此目录中：

`C:\Users\1234\Documents\workspace\.metadata\.plugins\org.eclipse.wst.server.core\tmp0`

如果我“复制图像位置”我得到 `http://localhost:7001/images/corp_logo.gif`

我应该在哪里复制图像和 css 目录，以便 WebLogic 正确显示页面？我已经尝试`C:/images`过元数据目录、weblogic 安装目录，但没有任何效果。

我在 Windows 7 上使用 Eclipse Indigo 和 WebLogic 10.3.5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T18:23:10.443

我的解决方案是将 Apache 放在 WebLogic 前面，并为 httpd.conf 中的图像目录使用别名。

```
Alias /images C:/fddt_dev/images
<Directory C:/fddt_dev/images>
    Order allow,deny
    Allow from all
</Directory> 
```

# php - Codeigniter CLI 不加载多个视图

> ID：15668782
> 
> 赞同：1
> 
> 时间：2013-03-27T20:29:07.953
> 
> 标签：php, codeigniter, command-line, command-line-interface, multiple-views

我正在尝试使用 codeigniter 通过 cron 作业运行每周电子邮件更新。如果我在浏览器中检查它一切正常，但是当我通过命令行运行它时，它会通过循环一次，然后在将 $message 变量设置为视图时死掉。

日志没有显示任何有用的信息

日志信息

```
DEBUG - 2013-03-27 20:26:35 --> Email Class Initialized
DEBUG - 2013-03-27 20:26:35 --> File loaded: /email_templates/weekly_user_update.php
DEBUG - 2013-03-27 20:26:36 --> Language file loaded: language/english/email_lang.php 
```

有问题的代码

```
public function weekly_update(){

      $this->load->model('statistics_model','stats');
      $this->load->library('email');
      $config['mailtype'] = "html";
      $this->email->initialize($config);

      $users = $this->stats->get_product_users();

      echo "Found ".count($users)." user(s).==".PHP_EOL;
      echo "--Beginning User Parse--".PHP_EOL;
      $count= 0;
      foreach($users as $user){
        echo " Parsing User ".$user['first_name']." ".$user['last_name']."[".$user['user_id']."]".PHP_EOL;
        $this->email->to($user['email']);
        $subject = "Weekly Updates for ".date('m/d/Y');
        $this->email->subject($subject);

        $message = $this->load->view('email_templates/weekly_user_update',$data,TRUE);

          $this->email->message($message);
          echo "  Sending Message to ".$user['email']." '".$subject."'".PHP_EOL;
          $this->email->send();

          echo "  Weekly Update Sent to {$to}!".PHP_EOL;

          $this->email->clear();

    }
} 
```

请帮助它让我发疯！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T08:47:35.030

$data 似乎没有在这个函数的任何地方设置，所以我猜它依赖于会话或 MY_Controller 中的某些东西来填充它——这在 CLI 中不可用

无法在没有看到其余代码的情况下准确地告诉您，但您应该能够从中跟踪它

# asp.net - 在数据库的表中存储安全问题列表 - 需要匿名访问？

> ID：15668784
> 
> 赞同：0
> 
> 时间：2013-03-27T20:29:12.453
> 
> 标签：asp.net, sql-server, forms-authentication

我有一个使用表单身份验证的项目。当用户注册时，他们需要使用他们的帐户设置一个安全问题。我想将安全问题列表存储在数据库中，以便将来的管理员可以控制此列表...添加问题，退出问题等...管理部分工作正常，但受到保护，这意味着我的业务层仅限于经过身份验证的用户，使用主要权限属性等。

问题是在实际的注册表单上，用户是匿名的。我无法理解如何允许匿名用户检索访问此问题列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:34:08.613

如果我正确理解您的设置，请执行以下操作：

1.  将您的`PrincipalPermission`属性从类移动到“仅限管理员”的特定方法。

2.  `PrincipalPermission`创建一个没有任何属性的新方法，即Retrieve 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T13:54:54.223

您的业​​务层需要允许匿名访问在注册过程中完成的任何事情。或者为这些用户创建一个备用路径（并行数据层）。

第二种方法的危险是您最终可能会重复代码，这对维护不利。

# c - 如何在 c 中管理和 csv 文件？

> ID：15668787
> 
> 赞同：-3
> 
> 时间：2013-03-27T20:29:21.140
> 
> 标签：c, csv, token, file-handling

# 我有一个 csv 文件，看起来像这样：

1.  1;53453;45847865
2.  1;37567;53687686
3.  .
4.  .
5.  .
6.  . n. 1;999768;5645644

我想打开文件，阅读它，然后将每一行拆分为 3 个标记，这些标记将与分号隔开....

例如

1;35435;75675

```
 token1 = 1;
 token2 = 35435;
 token3 = 75675; 
```

我拥有的代码是我打开并读取文件的主要代码和我手动获取字符串并将其拆分的函数...

## 我想知道是否有更简单的方法来实现这一点以及跳过文件第一行的方法！！！！！！

```
 #include<stdio.h>

    int main(){

    char c;
    FILE *fp;
    char line;

    float x;
    float y;

    if((fp=fopen("test.csv","r"))==NULL){
            printf("cannot open the file");
    }else{

      do{

    c =  fscanf (fp, "%c", &line);
    printf("%c" , line);

     }while(c!=EOF);    
     fclose(fp);
    }

  } 
```

****__ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __** -**

 **```
 int TokenX(char line) {

char *id;
char *x;
char *y;

char line[] = "1;345345;765767";
char *search = ";";

     id = strtok(line , search);
    // printf(id);

     x = strtok(NULL , search);
     printf(x);

     y = strtok(NULL , search);
     printf(y);

    return(x);  

    } 
```

* * *

```
 int TokenY(char line) {

  char *id;
  char *x;
  char *y;

  char line[] = "1;345345;765767";
  char *search = ";";

     id = strtok(line , search);
    // printf(id);

     x = strtok(NULL , search);
     printf(x);

     y = strtok(NULL , search);
     printf(y);

    return(y);  

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:21:42.407

平凡状态机：

```
#include <stdio.h>

int main(void)
{
char token1[123];
char token2[123];
char token3[123];
unsigned nline;
int ch,state;
char *dst=token1;

nline=0;
for (state=0; state >=0; ) {
        ch = getc(stdin);
        // fprintf(stderr, "Line=%u State=%d Ch=%c\n", nline, state, ch);
        switch(ch) {
        case EOF :
                state = -1; break;
        case ';' :
                if (dst) *dst = 0;
                switch(state++) {
                case 0: dst = token2; break;
                case 1: dst = token3; break;
                default: dst = NULL; break;
                }
                break;
        case '\n' :
                nline++;
                if (dst) *dst = 0;
                // if you want to skip the first line
                if (state>=2 && nline> 1) printf("%s:%s:%s\n"
                        , token1, token2 ,token3);
                state =0; dst = token1; break;
        default: *dst++ = ch; break;
                }
        }

return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:35:58.760

您可以`fscanf()`使用`while`. while 循环中的每次迭代都会从文件中读取一行。

```
int token1, token2, token3;
while(fscanf(fp, " %*d . %d ; %d ; %d", &token1, &token2, &token3)>0)
{

  printf("%d  %d   %d\n",token1, token2, token3);
} 
```

如果你想跳过第一行然后添加一个 integr 参数并初始化为 0。当你进入 while 循环时，检查它是否等于 0

```
int token1, token2, token3;
int check = 0; 
while(fscanf(fp, " %*d . %d ; %d ; %d", &token1, &token2, &token3)>0)
{
  if(!check) {check++; continue;}
  printf("%d  %d   %d\n",token1, token2, token3);
} 
```

1.  如果 csv 文件中每一行的字符串格式看起来像这样， `"1\. 25;78;547"`则`" %*d . %d ; %d ; %d"` 在`fscanf()`
2.  如果您的 csv 文件中每一行的字符串格式看起来像这样， `"25;78;547"`那么您必须`" %d ; %d ; %d"`在 `fscanf()`**

# java - 如何在Java中循环多个线程

> ID：15668790
> 
> 赞同：0
> 
> 时间：2013-03-27T20:29:27.160
> 
> 标签：java, multithreading, networking, concurrency

对于我们开发网络压力测试工具的项目，我们将数据包泛洪到整个子网。我们有一个 Runnable 类，它接受一个端口和广播地址，并在 while(!Thread.currentThread().isInterrupted) 循环中发送一个特定的数据包。然后我们有一个主类，它遍历每个网络接口和每个可能的端口，并将 Runnable 类添加到具有 1000 个线程固定池的 ExecutorService 中。问题是，如果 ExecutorService 等待当前 1000 个线程完成处理，它们永远不会因为它们处于 while 循环中。但是，启动每个线程（65536 * 接口数）会占用太多内存。我们正在寻找一种循环遍历线程的方法，以便它们都有机会运行一段时间并节省内存，同时仍然保持高网络输出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:47:43.440

我认为您可能会误以为更多线程总是提供更高的吞吐量。通常情况并非如此。

您的应用程序可能会受 CPU 限制，或受网卡吞吐量的限制。强迫操作系统处理数以万计的线程竞争这些资源*不会*增加你的吞吐量。只有当线程大部分时间都在等待一些高容量的外部资源（例如数据库）时，大量线程才有帮助。由于您只是在发送数据包并且（可能）对任何响应都不感兴趣，因此没有自然的等待点。

我建议您只拥有与处理器和/或网卡一样多的线程（以较小者为准）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:53:34.420

与其让每个线程始终运行完成或“永远”运行，不如让线程执行一小部分定义明确的工作，然后将它们重新添加到执行程序。这种高级管理可以通过“控制器”样式的对象来完成，该对象管理将任务重新添加到执行程序队列中，并执行一系列新的步骤。

例如，如果每个任务有 1000 个步骤要重复执行： - 任务 1 运行步骤 1-100，然后通过将自身添加回执行程序队列中的步骤 101-200 来完成 - 任务 2 有机会以类似方式执行（并完成） - 任务 1 现在是队列中的下一个，因此它执行 101-200，然后添加回 201-300 的执行程序队列。- 以此类推，直到任务 1 结束 - 901-1000 - 然后如果它想继续执行，则再次返回 1-100。

在您的情况下，不同的步骤可能是端口，不同的线程代表不同的广播地址 - 按照您认为合适的方式将其分解。

# ios - ios编辑文本字段无限循环

> ID：15668794
> 
> 赞同：1
> 
> 时间：2013-03-27T20:29:31.753
> 
> 标签：ios, ios5, uitextfield, uitextfielddelegate

**问题：**我有一个处理`editingChanged`事件的方法和另一个从对象模型更新我的文本字段的方法。问题是，如果我修改发送事件的字段的文本，它会再次触发editingChanged，然后我进入一个无限循环（仅在ios 5 中）！

**例子：**

```
- (IBAction)updateFields:(UITextField *)sender {
    if ([self myCustomValidation:sender]) {
        ... //update model
        //call another method that essentially does this
        field1.text = @"someformatted text"; //causes infinite loop if any field == sender
        field2.text = @"some more text";
    }
} 
```

您如何解决此问题（无需传递`sender`给所有发送`setText:`消息的方法）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:33:25.190

考虑实现`UITextFieldDelegate`' 方法`textField:shouldChangeCharactersInRange:replacementString:`而不是注册`editingChanged`控制事件。

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    ... //update model
    //call another method that essentially does this
    field1.text = @"someformatted text";  //causes infinite loop any field == sender
    field2.text = @"some more text";
    return YES; // or NO, depending on you actions
} 
```

根据[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html#//apple_ref/occ/intf/UITextFieldDelegate)，它应该服务于您的目的

> 每当用户在文本字段中键入新字符或删除现有字符时，文本字段都会调用此方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:36:14.557

无需编写自己的`IBAction` 方法，只需实现 UIExFeild 委托即可。

要检测**修改文本**，请实现`shouldChangeCharactersInRange`委托。

要检测**结束编辑**，请实现`textFieldDidEndEditing`委托。

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range      replacementString:(NSString *)string
{
  //write ur code here
  return YES;
}

- (void)textFieldDidEndEditing:(UITextField *)textField{

} 
```

# java - 带有 WEBKIT 的 SWT 浏览器高级功能

> ID：15668796
> 
> 赞同：1
> 
> 时间：2013-03-27T20:29:36.517
> 
> 标签：java, browser, webkit, swt, zooming

我目前正在构建一个 SWT 应用程序，该应用程序必须易于移植并具有简单、功能齐全的 Web 浏览器。我选择使用 webkit 主要是因为它已经安装在 osx，主要的 linux 发行版上，并且可以通过安装 Safari 轻松安装在 windows 上。

我已经为我的浏览器添加了基本功能，所有你可以用浏览器类明确地做的事情（状态文本、进度条等），但是我在添加必须更直接地与渲染引擎通信的功能时遇到了麻烦.

例如，我一直在尝试添加缩放功能。SWT 页面上有一个[片段](http://git.eclipse.org/c/platform/eclipse.platform.swt.git/tree/examples/org.eclipse.swt.snippets/src/org/eclipse/swt/snippets/Snippet329.java)显示了如何使用 Mozilla 作为渲染引擎来执行此操作，但它依赖于 browser.getWebBrowser() 函数，该函数使用除 mozilla 之外的任何引擎返回 null。

从我所做的搜索中，我找到了一个 Webkit 到 SWT 的端口，该端口现在已失效，以及我已经完成的一些示例。是否有任何我无法找到的类似 nsIWebBrowser 的 Webkit 对象？如果没有，我猜我最好的选择是使用 mozilla，或者使用 javascript 自己编写这些函数并扩展[BrowserFunction 类](http://dist.gumtree.codehaus.org/files/javadoc/eclipse/3.6/org/eclipse/swt/browser/BrowserFunction.html)。

如果我选择 mozilla，我将如何轻松地将 XLU 运行器与我的最终应用程序打包在一起，以便用户不必单独安装它？如果我选择 webkit，是否有任何关于使用带有 BrowserFunction 类的 javascript 来实现这种功能的好的文档。

我最终还必须实现查找、下载、视频播放和撤消/重做。你建议我往哪个方向走？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T04:53:51.483

> 从我所做的搜索中，我找到了一个 Webkit 到 SWT 的端口，该端口现在已失效，以及我已经完成的一些示例。是否有任何我无法找到的类似 nsIWebBrowser 的 Webkit 对象？

如果您正在寻找与 nsIWebBrowser 完全一样的东西，那么**没有**。但你可能会发现这`org.eclipse.swt.internal.webkit.IWebView`有点相似。

> 如果没有，我猜我最好的选择是使用 mozilla，或者使用 javascript 自己编写这些函数并扩展 BrowserFunction 类。

mozilla 实现的根源在于***The Original Code 是 Mozilla Communicator 客户端代码，它于 1998 年发布***，而 Webkit 实现则由 SWT 团队完成。根据我的经验，我发现使用 XULRunner 有点困难。该问题通常是由于 SWT 依赖于特定版本的 XULRunner。请参阅[SWT 常见问题解答](http://www.eclipse.org/swt/faq.php)。

扩展 BrowserFunction 可能很复杂，但您可以尝试一下。

> 如果我选择 mozilla，我将如何轻松地将 XLU 运行器与我的最终应用程序打包在一起，以便用户不必单独安装它？

只需在启动应用程序之前捆绑适当的 XULRunner 并设置正确的系统属性即可。请参阅[SWT 常见问题解答](http://www.eclipse.org/swt/faq.php)。

> 如果我选择 webkit，是否有任何关于使用带有 BrowserFunction 类的 javascript 来实现这种功能的好的文档。

唔。没有把握。您必须进一步搜索它或等待知道它的人。

> 我最终还必须实现查找、下载、视频播放和撤消/重做。你建议我往哪个方向走？

学习`org.eclipse.swt.browser.Webkit`班及其辅助班，如， `org.eclipse.swt.browser.WebDownloadDelegate`.

# java - 尝试从另一个类访问字符串时出现 NullPointerException

> ID：15668798
> 
> 赞同：-2
> 
> 时间：2013-03-27T20:29:42.387
> 
> 标签：java, nullpointerexception

当我尝试使用我构建的仅返回字符串的 getString() 方法从另一个类访问字符串时，我收到 NullPointerException。这是我尝试使用它的地方以及出现异常的地方：

```
public void storeChar(String str)
{
    wordSeed wrdSd = new wordSeed();
    seed = wrdSd.getSeed();

    for(int i = 0; i < str.length(); i++)
    {
        if(str.contains(seed))
        {
            int temp = str.indexOf(seed, i);
            singleChar.add(str.charAt(temp));
        }
    }
} 
```

我从 wrdSd.getSeed() 获取字符串并将其存储到种子中，但这显然只是将 null 放入种子而不是我想要的。然后，当我尝试使用 str.contains(seed) 时，它会引发异常。

预先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:33:52.607

尝试检查您的 wordSeed 类并查看初始值是否为空。如果您创建该类的一个实例（全新的，看到“wordSeed wrdSd = new wordSeed();”），那么当您使用 .getSeed() 时，您必须获得一个硬编码的值。

解决此问题的几种方法是使用您设置的相同 wordSeed 实例，或使用静态变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:36:09.943

确保在调用之前`getSeed()`，初始化它。您可以在构造函数中执行此操作，以便在创建 object 时初始化`wrdSd`该字段。`seed`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:36:02.910

```
public class  WordSeed  
{
    private String seed;
    public WordSeed()  
    {
    }   

    public String getSeed()  
    {
          return this.seed;
    }
} 
```

我认为您当前的实现是您需要添加以下两个选项之一：

```
private String seed = ""; 
```

或者

```
public WordSeed(String seed)  
{   
        if(null==seed)  
        {  
            this.seed="";
        } else
        { 
           this.seed=seed;  
         }
} 
```

# templates - 第二次访问时主详细视图的大小发生变化（IOS 6）

> ID：15668801
> 
> 赞同：1
> 
> 时间：2013-03-27T20:29:46.983
> 
> 标签：templates, ios6

我使用主从模板作为通用应用程序的基础。在纵向模式下使用详细视图时，第一次访问视图时高度为 1004 第二次访问相同视图时返回高度为 960。

我检查了这是空模板，这也发生在那里。

我正在使用视图边界属性来确定高度。

是什么原因造成的，可以解决吗？

# python - 使用 git submodule 导入 python 项目

> ID：15668804
> 
> 赞同：9
> 
> 时间：2013-03-27T20:29:52.693
> 
> 标签：python

（我意识到 StackOverflow 上有很多与 python 相关导入相关的问题；我也怀疑我做错了；但无论如何都在这里..）

我有一个 python 项目（mysubmod），组织如下：

```
/__init__.py
/lib
- /__init__py
- /foobar.py
/models
- /__init__.py
- /hello.py 
```

重要的：

*   /models/hello.py 导入 lib.foobar
*   /models/hello.py 有一个运行一些测试的**主块**

然后我有第二个项目（myproj），我将 mysubmod 作为 git 子模块导入其中；myproj 现在组织如下 -

```
/mysubmod
/scripts
- /__init__.py
- /__test.py 
```

在哪里：

*   scripts/test.py 导入 mysubmod.models.hello

但是，当我从命令行运行 /scripts/test.py 时，解释器现在抱怨 mysubmod/models/hello.py 无法再找到 lib.foobar。

重新加载。

更改了 mysubmod/models/hello.py 所以它现在导入 ..lib.foobar

现在我可以毫无怨言地运行 /scripts/test.py，但我不能再从命令行将任何 submod 脚本作为文件运行；我只能使用 python -m 选项将它们作为模块运行。

此外，即使使用 -m 选项，我也不能再单独运行 submod 项目文件，因为解释器会抱怨“尝试相对导入超出顶级包”；我必须上一级目录，即只能从 myproj 根目录真正运行 mysubmod（其中 mysubmod 作为根目录）。

这一切似乎都不太令人满意。我希望能够：

*   使用 git submodule 将 mysubmod 导入 myproj 以便它“正常工作”
*   继续能够独立开发 mysubmod（即作为文件而不是模块运行脚本）

有没有人对如何做到这一点有任何看法？关于 git submodule 和 python 的最佳实践有什么看法吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-28T07:31:52.017

好的答案是（经过许多错误的转弯）

*   添加单个顶级包 mysubmod（例如“helloworld”）
*   将 mysubmod 作为子模块导入 myprod，将 helloworld 包符号链接到 myprod 根目录（'ln -s mysubmod/helloworld helloworld'）

这样，无论您是将 submod 作为子模块还是独立使用，都可以维护包结构。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-09T12:54:34.737

您还可以`mysubmod`在`sys.path`启动`myproj`. 然后`mysubmod/models/hello.py`会发现`lib.foobar`。

# django - Django 表单无效，保留下一个参数

> ID：15668810
> 
> 赞同：1
> 
> 时间：2013-03-27T20:30:25.037
> 
> 标签：django, django-forms

返回无效表单时如何维护下一个参数？

（由于各种原因，我还不想实现 ajax）

这是我的观点的代码：

```
def registration(request):
    if request.method == 'POST':
        form = MyForm(request.POST)
        redirect_to = request.REQUEST.get('next','')
        if form.is_valid():
            #Do stuff
            return HttpResponseRedirect(redirect_to if redirect_to != '' 
                    else reverse('named_url'))
        #Next parameter lost here!!
        return render(request, 'registration.html', {'form' : form})

    else:
        return render(request, 'registration.html', {'form' : MyForm()}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:45:56.950

您应该将它作为另一个值传递到模板上下文中，然后在模板中将其用作`action`表单标签中的参数：

```
<form method="POST" action="?next={{ next }}"> 
```

# javascript - 是否可以在不通过 Google Closure Compiler 最小化代码的情况下编译 WebDriverJS？

> ID：15668811
> 
> 赞同：0
> 
> 时间：2013-03-27T20:30:27.160
> 
> 标签：javascript, selenium, selenium-webdriver, google-closure-compiler

为了我的目的，我需要修改[WebDriverJS](http://code.google.com/p/selenium/wiki/WebDriverJs#Working_in_a_Browser)。不过，编译后的源代码让我很难调试。描述函数名称和注释对我很有帮助！所以我想知道是否可以在不最小化其内容的情况下编译 WebDriverJS。

`build.desc`JavaScript 编译使用的是使用 Google Closure Compiler的[js_binary 。](http://code.google.com/p/selenium/wiki/CrazyFunBuild#js_binary)你们中的任何人都知道如何编译它并保留函数名和注释吗？这宁愿是所有来源的合并，然后是编译。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T09:42:52.030

感谢 Chads Post 在[“已编译和未编译的 Javascript 之间的潜在差异”](https://stackoverflow.com/questions/14147479/potential-differences-between-compiled-and-uncompiled-javascript)中，我更深入地了解了[闭包编译器的标志](https://developers.google.com/closure/compiler/docs/api-ref)。

*   `--compilation_level=WHITESPACE_ONLY`保留函数和变量名
*   `--formatting=PRETTY_PRINT`不删除换行符
*   `--formatting=PRINT_INPUT_DELIMETER`让我更好地了解在哪个文件中搜索源

不幸的是，我仍然不知道如何保存评论，但这只是一个小问题，因为我可以在源代码中查找它们。

**更新：** 似乎compile_level 没有删除goog.required-calls。我必须以某种方式删除它们，因为脚本不适用于它们。

**更新 2：** 我已经删除了所有`goog.require($mod)`并`goog.provide($mod)`在需要的地方调用和定义了对象（通常在`// Input $int`评论之后立即找到）。它现在正在工作。

# java - 可扩展的列表视图 android

> ID：15668813
> 
> 赞同：0
> 
> 时间：2013-03-27T20:30:32.723
> 
> 标签：java, android, expandablelistview

我正在开发一个将显示一些可扩展列表的应用程序。事实是有时对象不会有任何孩子。所以我想在我的可扩展列表中只显示有子元素的元素。我试图在 getGroupView 函数中放置一个 if ，如果该对象没有子对象，我返回 null 但我得到一个 nullPointerException 错误......

这是功能：

```
public View getGroupView(int i, boolean b, View view, ViewGroup viewGroup) {

    // Check if the object as child
    System.out.println("Result list :: " + mParent.get(i).getListe());

            if(mParent.get(i).getListe().isEmpty()){
        return null;
    }

    if (view == null) {
        view = inflater.inflate(R.layout.list_item_parent, viewGroup,false);
    }

    TextView textView = (TextView) view.findViewById(R.id.list_item_text_view);
    //"i" is the position of the parent/group in the list
    textView.setText(getGroup(i).toString());

    // Set the Image View with the brand logo
    ImageView logo = (ImageView) view.findViewById(R.id.brandlogo);

    // Set image Source
    logo.setImageResource(mParent.get(i).getLogoPath());

    // Set Image size       
    logo.getLayoutParams().height = 42;
    logo.getLayoutParams().width = 226;

    //return the entire view
    return view;
} 
```

有没有办法跳过这个功能？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:37:47.337

在`getGroupCount()`函数中返回有子项的项目数（有子项的项目数）。
作为`getGroubView()`回报，正确的观点（永远不要在`null`这里返回）。

# batch-file - 使用 sed 批量删除重复行

> ID：15668815
> 
> 赞同：1
> 
> 时间：2013-03-27T20:30:46.810
> 
> 标签：batch-file, sed

我正在清理 Windows 机器上的几百个文件，我需要对它们做的一件事是删除一些重复的行。因此，示例文件可能如下所示：

```
foo=false    
bar=true
baz=false
baz=false
baz=false 
```

因此，在与我合作时，`sed`我遇到了[这个网站](http://www.thegeekstuff.com/2009/11/unix-sed-tutorial-multi-line-file-operation-with-6-practical-examples/)，该网站展示了一条删除重复行的行。

```
sed "$!N; /^\(.*\)\n\1$/!P; D" textfile.txt 
```

因此，我将其插入命令窗口以查看它是否有效，并且控制台窗口显示已删除重复的行。之后，我将该行插入到我的批处理脚本中，以针对我需要编辑的文件列表运行它。

```
FOR /F %%a IN ('listfile.txt') DO (
  sed "$!N; /^\(.*\)\n\1$/!P; D" %%a
) 
```

但是当我对我的测试文件列表运行它时，它从文件中删除了每一行，除了其中一个重复的行。

我不太熟悉，无法`sed`确定该行在做什么，但我对它的测试表明它在做我想要的。那么给了什么？我是否遗漏`sed`了批处理文件中的工作方式？

* * *

根据我尝试的评论：

```
gawk "!a[$0]++" textfile.txt 
```

它再次在命令行上工作，但不在脚本中。因此，批处理文件运行此命令的方式肯定存在一些问题，但我无法弄清楚那是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T21:12:22.067

在 Windows 平台上，使用 PowerShell 很简单：

```
get-content "textfile.txt" | sort-object -unique 
```

账单

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T15:37:36.623

在对原始语句进行更多测试后，`sed`我发现它被挂断`!`在命令中。所以我开始沿着这条路线进行一些挖掘，发现即使在语句中`EnableDelyedExpansion`也导致它们之间的所有内容都被删除。`!``sed`

所以我的选择是逃避`!`或缩小`EnableDelayedExpansion`. 由于转义似乎不起作用，我只是将范围缩小到需要它的特定变量周围，然后该`sed`语句似乎可以正常工作。

# php - php 将文章添加到收藏夹

> ID：15668816
> 
> 赞同：-4
> 
> 时间：2013-03-27T20:30:53.270
> 
> 标签：php, mysql

我想做一个收藏按钮，所以当我网站上的用户点击它并离开网站，然后再回来时，他们收藏的文章仍然存在。我已经用 php 和 mysql 创建了一个会员系统。

我已经为我最喜欢的系统创建了一个表格，但有人可以建议添加哪些列吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:33:07.100

您只需要文章 ID 字段和唯一的 ID 字段。

然后你需要做的是当访问者喜欢一篇文章时设置一个 cookie，在这个 cookie 中将是该用户的唯一 ID，然后你可以准确地跟踪他们喜欢的文章。

# jquery - 有没有办法在 Webkit 浏览器上使用 jQuery 1.3.0 获取 $.mobile.pageCreate ？

> ID：15668817
> 
> 赞同：4
> 
> 时间：2013-03-27T20:31:02.497
> 
> 标签：jquery, html, jquery-mobile

我之前尝试过发布这个问题，但当时并没有意识到我遇到的问题来自使用 jQuery 1.3.0 库。

我正在尝试使用 jQuery mobile 在页面上创建一个没有用户交互的对话框。它在 FireFox 中有效，但在所有 webkit 浏览器中都失败，包括 Safari、Mobile Safari 和 Chrome。

这是问题的一个示例：http: [//jsfiddle.net/fskirschbaum/2YTwE/](http://jsfiddle.net/fskirschbaum/2YTwE/)

```
$.mobile.changePage( '#dialog' , { transition:"pop", role:"dialog" }); 
```

我已经尝试了几种不同的方法来让这个东西正常工作，我觉得我正在把头撞在墙上。如果您将库基础更改为 1.2.0，它会起作用，所以这似乎是 1.3.0 的问题，但我看不到其他人似乎有这个问题。

**编辑：**我尝试将其附加到几个事件但没有成功，包括：pagecreate、pageinit、pageload 等。这似乎没有帮助。我还要指出，这似乎是这个库崩溃到另一个库的问题，在一个只有 jquery 和 jquery mobile 的香草页面上，我可以使用 1.3 库让它工作，但不能在 jsFiddle 或我的环境中（我正在调用许多其他库，例如 jQueryUI 和其他库，并且我试图调整它们被调用的顺序。）

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T16:21:42.733

因此，它似乎与 webkit 渲染和某些其他库的问题有关。

将函数包装在`pageshow`我的环境中不起作用，但将其包装在`pagecreate`do 中，这是在 createPage 之后调用的事件。我还没有确定为什么会发生这种情况，但它确实有效。

[http://jsfiddle.net/fskirschbaum/pKw2A/](http://jsfiddle.net/fskirschbaum/pKw2A/)

但是，此解决方案在 Firefox / Gecko 渲染中中断，因此，该功能需要包装在浏览器检查中才能使其工作。显然这不是最优雅的解决方案，但它仍然是一个解决方案。

希望这将帮助其他有同样问题的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T04:59:56.560

如下调用`$.mobile.changePage`。

```
$(document).on('pageshow', '#home', function(){
    $.mobile.changePage('#dialog');
}); 
```

# iphone - ASIHTTPRequest 自定义进度跟踪

> ID：15668824
> 
> 赞同：0
> 
> 时间：2013-03-27T20:31:29.633
> 
> 标签：iphone, ios, protocols, asihttprequest

[我已经阅读了有关在文档](http://allseeing-i.com/ASIHTTPRequest/How-to-use#downloading_the_response_directly_to_a_file)中使用 ASIHTTPRequest 在我的应用程序中实现自定义进度跟踪的信息。它提到了实现 2 种方法，`request:didReceiveBytes:`并且`request:incrementDownloadSizeBy:`. 我已将这些添加到我的视图控制器中，但它们没有被调用。我只是想让示例代码在这一点上工作。

```
// ViewController.m

- (void)fetchThisURLFiveTimes:(NSURL *)url
{
    [myQueue cancelAllOperations];
    [myQueue setDownloadProgressDelegate:self];
    [myQueue setDelegate:self];
    [myQueue setRequestDidFinishSelector:@selector(queueComplete:)];
    int i;
    for (i=0; i<5; i++) {
        ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
        request.showAccurateProgress = YES;
        [myQueue addOperation:request];
    }
    myQueue.showAccurateProgress = YES;
    [myQueue go];
}

- (void)queueComplete:(ASINetworkQueue *)queue
{
   NSLog(@"Value: %f", [myProgressIndicator progress]);
}

- (void)request:(ASIHTTPRequest *)request didReceiveBytes:(long long)bytes
{
    NSLog(@"bytes: %lld", bytes);
}

- (void)request:(ASIHTTPRequest *)request incrementDownloadSizeBy:(long long)newLength
{
    NSLog(@"newLength: %lld", newLength);
} 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T16:46:12.603

哇。所以你把线放在哪里`self.myQueue.showAccurateProgress = YES;`真的很重要。它必须在该行之前添加`[self.myQueue addOperation:request];`。这对我有用。

```
- (void)fetchThisURLFiveTimes:(NSURL *)url
{
    [self.myQueue cancelAllOperations];        
    [self setMyQueue:[ASINetworkQueue queue]];
    [self.myQueue setDownloadProgressDelegate:self];
    [self.myQueue setDelegate:self];
    [self.myQueue setQueueDidFinishSelector:@selector(queueFinished:)];
    self.myQueue.showAccurateProgress = YES;

    int i;
    for (i=0; i<5; i++) {
        ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
        [self.myQueue addOperation:request];
    }
    [self.myQueue go];
}

- (void)queueFinished:(ASINetworkQueue *)queue
{
    if ([self.myQueue requestsCount] == 0) {
        [self setMyQueue:nil];
    }
    NSLog(@"Queue finished");
}

- (void)setProgress:(float)newProgress {
    NSLog(@"progress: %f", newProgress);
} 
```

试图弄清楚这一点真是浪费了 6 个小时。我希望这可以减轻一些人的麻烦。

# wix - 蜡成分状况

> ID：15668829
> 
> 赞同：2
> 
> 时间：2013-03-27T20:32:01.617
> 
> 标签：wix, installation, windows-installer

我试图让一个条件组件工作。

但是它根本不起作用，所以我很难过。

我有以下代码块：

该功能定义如下：

```
<Feature Id="MainFeature" Level="1" Title="!(loc.FEATURE.MAINFEATURE.TITLE)" 
         Description="!(loc.FEATURE.MAINFEATURE.DESCRIPTION)" Display="collapse">
      <ComponentRef Id="MainExecutable" />
      <ComponentRef Id="pmd" />
</Feature> 
```

并且组件定义为

```
<Component Id="MainExecutable" Guid="*">
 <Condition><![CDATA[(&MainFeature = 3) AND NOT (!MainFeature = 3)]]></Condition>
    <File Id="MainExecutableFile" Name="SampleApp.exe" 
          Source="..\ProductBuild\sampleFile.txt" KeyPath="yes">
     <Shortcut Id="MainExecutableStartMenu" Directory="ProgramMenuDir" 
               Name="!(loc.APPNAME)" WorkingDirectory="INSTALLDIR" 
               Icon="icon.ico" IconIndex="0" Advertise="yes"/>
     <Shortcut Id="MainExecutableDesktop" Directory="DesktopFolder" 
               Name="!(loc.APPNAME)" WorkingDirectory="INSTALLDIR" 
               Icon="icon.ico" IconIndex="0" Advertise="yes" />
    </File>
</Component> 
```

但是这些文件永远不会安装！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T21:06:47.270

`Component` `Condition`在确定特征状态时不评估A。因此，您`Condition`永远不会正确评估（如您所见）。

但是，我不确定您是否需要`Condition`. 仅当组件的父功能也设置为安装时，才会安装组件。似乎您`Condition`正在尝试复制内置行为（但由于上述原因不能）。

# javascript - d3的转场和动画是否使用requestAnimationFrame？

> ID：15668831
> 
> 赞同：10
> 
> 时间：2013-03-27T20:32:02.687
> 
> 标签：javascript, animation, d3.js, requestanimationframe

我试图弄清楚 d3 的默认动画`requestAnimationFrame`是否已经用于回调，或者我是否需要自己做。例如，我已经定义了一个自定义补间，它反复调用重绘函数来动画在图形上从一个域到另一个域的过渡（这是在咖啡脚本中）：

```
rd = @redraw # a function that takes an argument to redraw the graph
@svg.transition()
  .duration(1000)
  .tween "zoom", -> 
      interp = d3.interpolate(current_dom, target_dom)
      (t) -> rd interp(t) 
```

在我所有其他重绘调用中，我安排它`requestAnimationFrame`：

```
scheduleRedraw: =>
  # Stop a previous request if it hasn't executed yet
  cancelAnimationFrame(@animRequest) if @animRequest       
  @animRequest = requestAnimationFrame => @redraw 
```

但是，我想知道我是否需要在这里做同样的事情。我一直在查看 d3 源代码，发现唯一的引用`requestAnimationFrame`是在[d3 计时器类](https://github.com/mbostock/d3/blob/master/src/event/timer.js)中。希望对 d3 有更多了解的人可以帮助回答以下问题：

*   d3 计时器是否全局用于所有 d3 动画和过渡？
*   我需要在`requestAnimationFrame`这里手动使用吗？如果没有，在使用 d3 时我是否需要自己使用它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-05-23T18:44:41.353

来自[d3 的 wiki:Transitions:Timer](https://github.com/mbostock/d3/wiki/Transitions#timers)

> 如果您的浏览器支持，定时器队列将使用 requestAnimationFrame 来实现流畅高效的动画。

# java - 在 WebSphere 上运行 Apache-CXF

> ID：15668833
> 
> 赞同：0
> 
> 时间：2013-03-27T20:32:16.293
> 
> 标签：java, xml, apache, websphere, cxf

我正在尝试在 websphere 8.5 上部署 cxf 客户端。我解决了相互冲突的 cxf 类问题。现在我遇到了`XmlSchemaForm.class`缺少 QUALIFIED 字段的问题。显然正在加载错误的类。

我已经设置`xmlschema-core-2.0.3.jar`了要在启动时加载的共享库。

但是当我检查资源路径时它显示

```
bundleresource://222.fwk-496297919/org/apache/ws/commons/schema/XmlSchemaForm.class 
```

而不是 jar 文件路径。

我在 manifest.mf 下搜索并添加`DisableIBMJAXWSEngine:true`以避免 jax-ws 注释，但没有运气。

任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:38:42.177

将父级最后设置为类加载器策略

# javascript - `history.go` 是否不区分大小写

> ID：15668837
> 
> 赞同：1
> 
> 时间：2013-03-27T20:32:28.417
> 
> 标签：javascript, browser-history

在 javascript 中，`history.go`当涉及到一个 url 时方法是不区分大小写的。就好像实际的 url 是`Login.html`并且我传入了它，如果它在历史中`login.html`会去吗？`Login.html`

我继续阅读`w3schools`：

[http://www.w3schools.com/jsref/met_his_go.asp](http://www.w3schools.com/jsref/met_his_go.asp)

> 该参数可以是一个数字，它在特定位置（-1 后退一页，1 前进一页）内的 URL 或字符串。该字符串必须是部分或完整的 URL，并且该函数将转到与该字符串匹配的第一个 URL。

但随后`MDN`他们没有关于此功能的信息`go`

[https://developer.mozilla.org/en/docs/DOM/Manipulating_the_browser_history#Moving_to_a_specific_point_in_history](https://developer.mozilla.org/en/docs/DOM/Manipulating_the_browser_history#Moving_to_a_specific_point_in_history)

> 您可以使用 go() 方法从会话历史记录中加载特定页面，该页面由其与当前页面的相对位置标识（当然，当前页面的相对索引为 0）。

那么它`history.go(url)`甚至可以工作吗？还是我需要使用`history.go(number)`

* * *

如果情况是它区分大小写，那么是否可以使其不区分大小写（这可能是否）

* * *

**编辑**

IE 似乎是唯一支持将 url 传递给它的浏览器，通过`elclanrs`答案。

所以让我们稍微转移一下这个问题。有什么办法可以做到这一点吗？或者创建这种功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:35:07.007

也来自 MDN 关于[history.go(integerDelta)](https://developer.mozilla.org/en-US/docs/DOM/window.history)：

> 从会话历史中加载页面... 不带参数或使用非整数参数调用 go() 无效（**与 Internet Explorer 不同，它支持字符串 URL 作为参数**）。

所以我想这是你错过的重要一点。

# ios - 防止 iPhone 自动锁定，但允许屏幕变暗

> ID：15668840
> 
> 赞同：6
> 
> 时间：2013-03-27T20:32:37.337
> 
> 标签：ios, screen-brightness

我有一个在手忙的环境中工作的应用程序，因此用户很少触摸设备。当然，手机进入自动锁定状态，我的应用程序停止工作。我使用了这段代码：

```
 [[UIApplication sharedApplication] setIdleTimerDisabled:YES]; 
```

以防止设备，这很好。但是，我仍然希望屏幕自动变暗。上面的代码使屏幕不会自动变暗和自动锁定。

[这个问题](https://stackoverflow.com/questions/11486036/prevent-iphone-to-sleep)向我展示了如何手动调暗屏幕，这可能是一个足够好的解决方案。但我宁愿使用系统设置，而不是应用程序设置。

那么如何在仍然获得自动变暗的同时防止自动锁定？

# jquery - 如何替换div中的信息

> ID：15668842
> 
> 赞同：0
> 
> 时间：2013-03-27T20:32:40.673
> 
> 标签：jquery

当我使用 jQuery 单击一个 div 时，我试图用另一个 div 替换它，但我做不到，我不知道是否需要在一个 div 上使用 hide 属性。

这是代码

```
<div id="prepersonal">this is a test 1</div>
<div id="personal">this is a test 2</div> 
```

这是CSS

```
#prepersonal {
   width: 330px;
   height: 330px;
   border-radius: 5px;
   background-color: #FF6801;
   color: #FFFFFF;
   font-family: Tahoma;
   padding-top:7px; 
}

#personal {
   width: 330px;
   height: 330px;
   border-radius: 5px;
   background-color: #FF6801;
   color: #FFFFFF;
   font-family: Tahoma;
   padding-top:7px;
} 
```

有人可以知道答案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:33:43.660

以下内容将其中的内容替换为*已*编辑`div`的内容`click`：

```
$(function(){
    $('#prepersonal').on('click', function(){
        $('#personal').html(this.innerHTML);
    });
}); 
```

* * *

**在您发表评论后：**

```
$(function(){
    var a = $('#prepersonal'), b = $('#personal');

    // you can remove this call to hide by initially
    // hiding the div using display:none; in CSS
    b.hide();

    a.on('click', function(){
        toggledivs();
    });
    b.on('click', function(){
        toggledivs();
    });

    function toggledivs(){
        a.toggle();
        b.toggle();  
    };
}); 
```

[http://jsfiddle.net/f6r82/](http://jsfiddle.net/f6r82/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:39:56.273

```
$(function() {
    $("#prepersonal").click(function(){
        $("#personal").html($("#prepersonal").html()); //You can use the text() method instead of html if you need only the text
        $("prepersonal").css("display", "none");
    });
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:40:57.443

```
$(function(){
$('#prepersonal').on('click', function(){
    $(this).replaceWith($('#personal'));
});
}); 
```

# ios - 在 Objective-C 中实现 Future：检测到意外死锁

> ID：15668846
> 
> 赞同：1
> 
> 时间：2013-03-27T20:32:48.880
> 
> 标签：ios, objective-c, multithreading, cocoa

我`Future`在 Objective-C 中实现了一个类，类似于 Java 的`java.util.concurrent.Future`，但更适合我的简单需求。这是实现：

```
typedef id (^TaskBlock)();

static int NotDone = 0;
static int Done = 1;

@implementation Future

- (id)initWithBlock:(TaskBlock)aBlock {
    if((self = [super init])) {
        lock = [[NSConditionLock alloc] initWithCondition:NotDone];

        block = aBlock;
    }

    return self;
}

- (void)set:(id)aValue {
    if ([lock tryLockWhenCondition:NotDone]) {
        [lock lockWhenCondition:NotDone];
        value = aValue;
        [lock unlockWithCondition:Done];
    }
}

- (id)get {
    DLog(@"Retrieving future value");

    [lock lockWhenCondition:Done];
    id v = value;
    [lock unlock];

    return v;
}

- (void)start {
    dispatch_async(dispatch_get_global_queue(0, 0), ^{
        DLog(@"Requesting future value");

        [self set:block()];

        DLog(@"Future value set");
    });
}

@end 
```

当我使用它时，一个线程首先`get:`像这样被阻塞（它等待由 表示的冗长计算`block`完成）：

```
frame #0: 0x9139783e libsystem_kernel.dylib`__psynch_cvwait + 10
frame #1: 0x904a4e78 libsystem_c.dylib`_pthread_cond_wait + 914
frame #2: 0x904a4f7b libsystem_c.dylib`pthread_cond_timedwait_relative_np + 47
frame #3: 0x00b565f2 Foundation`-[NSCondition waitUntilDate:] + 389
frame #4: 0x00b26fc0 Foundation`-[NSConditionLock lockWhenCondition:beforeDate:] + 285
frame #5: 0x00b26e9d Foundation`-[NSConditionLock lockWhenCondition:] + 69
frame #6: 0x0000c335 Jungle`-[Future get](self=0x0757e220, _cmd=0x0000ec3a) + 85 at Future.m:52
frame #7: 0x0000ab23 Jungle`-[GADelayedBinding waitDelayed](self=0x071c39e0, _cmd=0x0000eb1d) + 99 at GADelayedBinding.m:44
frame #8: 0x00007a26 Jungle`-[GATuple waitDelayed](self=0x071baa70, _cmd=0x0000eb1d) + 390 at GATuple.m:99
frame #9: 0x000098fa Jungle`-[GAUnifier unify:with:dynamicContext:](self=0x07561030, _cmd=0x0000eaf8, query=0x071bcc50, base=0x07182f40, dynamicContext=0x00000000) + 2442 at GAUnifier.m:85
frame #10: 0x00009b06 Jungle`-[GAUnifier unify:with:](self=0x07561030, _cmd=0x0000e71e, query=0x071bcc50, base=0x07182f40) + 118 at GAUnifier.m:93
frame #11: 0x00002b44 Jungle`__32-[ViewController viewDidAppear:]_block_invoke(.block_descriptor=0x0756a6a0) + 84 at ViewController.m:38
frame #12: 0x04a0a53f libdispatch.dylib`_dispatch_call_block_and_release + 15
frame #13: 0x04a1c014 libdispatch.dylib`_dispatch_client_callout + 14
frame #14: 0x04a0d2e8 libdispatch.dylib`_dispatch_root_queue_drain + 335
frame #15: 0x04a0cfcb libdispatch.dylib`_dispatch_worker_thread3 + 20
frame #16: 0x904a2b24 libsystem_c.dylib`_pthread_wqthread + 346 
```

计算完成后，我在此处收到有关死锁的错误：

```
frame #0: 0x00b9f80f Foundation`_NSLockError
frame #1: 0x00b26f6f Foundation`-[NSConditionLock lockWhenCondition:beforeDate:] + 204
frame #2: 0x00b26e9d Foundation`-[NSConditionLock lockWhenCondition:] + 69
frame #3: 0x0000c268 Jungle`-[Future set:](self=0x0757e220, _cmd=0x0000ec35, aValue=0x07578b40) + 136 at Future.m:43
frame #4: 0x0000c501 Jungle`__15-[Future start]_block_invoke(.block_descriptor=0x0757e330) + 113 at Future.m:63
frame #5: 0x04a0a53f libdispatch.dylib`_dispatch_call_block_and_release + 15
frame #6: 0x04a1c014 libdispatch.dylib`_dispatch_client_callout + 14
frame #7: 0x04a0d2e8 libdispatch.dylib`_dispatch_root_queue_drain + 335
frame #8: 0x04a0cfcb libdispatch.dylib`_dispatch_worker_thread3 + 20
frame #9: 0x904a2b24 libsystem_c.dylib`_pthread_wqthread + 346 
```

我做错了什么？我的锁正在等待的所有条件对我来说都是正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:52:03.220

该方法`tryLockWhenCondition:`在成功时实际上会获取锁，因此您尝试将其锁定两次，这会导致死锁。

```
if ([lock tryLockWhenCondition:NotDone]) {
    [lock lockWhenCondition:NotDone]; //Remove this 
```

我还想指出，当您未指定`nonatomic`.

# objective-c - 如何在可可（osx）中检测顺时针/逆时针鼠标/光标拖动？

> ID：15668847
> 
> 赞同：0
> 
> 时间：2013-03-27T20:32:49.237
> 
> 标签：objective-c, macos, cocoa

我对objective-c和可可开发比较陌生，我很好奇是否有一种相对简单的方法来检测顺时针或逆时针鼠标/光标拖动？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T06:31:21.493

不确定在可可中是否可行。你可以尝试自己解决这个问题，抓住起点、终点和一些中间点坐标，根据这些点创建两个向量，然后找到三角形的有符号区域。有关数学，请参阅[本文档](http://www.cs.princeton.edu/~rs/AlgsDS07/16Geometric.pdf)（搜索“实施 CCW”）。

这是一个简单的函数：

```
int ccw(CGPoint a, CGPoint b, CGPoint c)
{
    const int area2 = (b.x - a.x)*(c.y - a.y) - (b.y - a.y)*(c.x - a.x);
    if (area2 < 0) return -1; // clockwise
    if (area2 > 0) return +1; // counter-clockwise
    return 0; // collinear
} 
```

**编辑**：请注意，您的 y 轴可能会从上到下指向，因此您可能需要在传递给函数之前切换结果的符号或转换点的 y 坐标。

# ios - 在 UIView 上画一条 5 像素的线

> ID：15668849
> 
> 赞同：2
> 
> 时间：2013-03-27T20:33:03.477
> 
> 标签：ios, objective-c, uiview, uitouch

我有一个非常简单（希望非常简单）的问题。在 Objective-C 中，如何在两点之间画一条线并将其添加到 UIView？我曾尝试使用 UIImageView 并操作其`Transform`属性，但最终在使用以下代码时将线变成正方形或矩形：

```
[[self tline] setFrame:CGRectMake(start.x, start.y, width, 5)];
[[self tline] setTransform:CGAffineTransformMakeRotation(angle)]; 
```

我有两个 CGPoints`start`和`end`, 我想在两个点之间画一条动态的 5px 线并将其添加到我的子视图中。

**BK：**

该点`start`是用户开始触摸屏幕的点，该点`end`是用户手指当前所在的点。显然，这会在游戏过程中发生很大变化。我需要能够移动这条线来连接这两点。

我正在使用这些`touchesBegan:, Moved:, and Ended:`方法来创建、移动和销毁线。

**核心图形**

我有以下代码；如何将此行添加到`self.view`？

```
CGContextRef c = UIGraphicsGetCurrentContext();
CGFloat color[4] = {1.0f, 1.0f, 1.0f, 0.6f};
CGContextSetStrokeColor(c, color);
CGContextBeginPath(c);
CGContextMoveToPoint(c, start.x, start.y);
CGContextAddLineToPoint(c, end.x, end.y);
CGContextSetLineWidth(c, 5);
CGContextSetLineCap(c, kCGLineCapRound);
CGContextStrokePath(c); 
```

**自定义 UIView：**

```
#import <UIKit/UIKit.h>

@interface DrawingView : UIView

@property (nonatomic) CGPoint start;
@property (nonatomic) CGPoint end;

- (void)drawRect:(CGRect)rect;

@end

#import "DrawingView.h"

@implementation DrawingView

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
    }
    return self;
}

- (void)drawRect:(CGRect)rect {
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSaveGState(context);
    CGContextSetLineCap(context, kCGLineCapSquare);
    CGContextSetStrokeColorWithColor(context, [UIColor whiteColor].CGColor); //change color here
    CGFloat lineWidth = 5.0; //change line width here
    CGContextSetLineWidth(context, lineWidth);
    CGPoint startPoint = [self start];
    CGPoint endPoint = [self end];
    CGContextMoveToPoint(context, startPoint.x + lineWidth/2, startPoint.y + lineWidth/2);
    CGContextAddLineToPoint(context, endPoint.x + lineWidth/2, endPoint.y + lineWidth/2);
    CGContextStrokePath(context);
    CGContextRestoreGState(context);

    NSLog(@"%f",_end.x);
}

- (void)setEnd:(CGPoint)end
{
    _end = end;
    [self setNeedsDisplay];
}

@end 
```

drawRect: 仅在我初始化视图时调用...

UIViewController 中的绘制方法：

```
- (void)drawTLine:(CGPoint)start withEndPoint:(CGPoint)end
{   
    [[self dview] setStart:start];
    [[self dview] setEnd:end];
    [[self dview] drawRect:[self dview].frame];
} 
```

这就是我添加绘图视图的方式：

```
DrawingView* dview = [[DrawingView alloc] initWithFrame:self.view.frame];
[dview setBackgroundColor:[UIColor clearColor]];
[self.view addSubview:dview]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:51:38.817

使用该方法子类`UIView`化并执行自定义绘图`drawRect:`

```
- (void)drawRect:(CGRect)rect {
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSaveGState(context);
    CGContextSetLineCap(context, kCGLineCapSquare);
    CGContextSetStrokeColorWithColor(context, [UIColor blackColor].CGColor); //change color here
    CGFloat lineWidth = 1.0; //change line width here
    CGContextSetLineWidth(context, lineWidth); 
    CGPoint startPoint = rect.origin; //change start point here
    CGPoint endPoint = {.x = CGRectGetMaxX(rect), .y = startPoint.y} //change end point here
    CGContextMoveToPoint(context, startPoint.x + lineWidth/2, startPoint.y + lineWidth/2);
    CGContextAddLineToPoint(context, endPoint.x + lineWidth/2, endPoint.y + lineWidth/2);
    CGContextStrokePath(context);
    CGContextRestoreGState(context);        
} 
```

这将在您的`UIView`.

如果您需要更新该行，您可以使用一些属性，例如

```
@property (nonatomic) CGPoint startPoint; 
```

并为 setter 提供自定义实现，例如

```
- (void)setStartPoint:(CGPoint)point {
      _point = point;
      [self setNeedsDisplay]; // this will cause drawRect: to be called again
} 
```

对您希望控制的每个属性执行此操作，并`drawRect:`使用这些属性进行绘图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:55:18.163

你可以像这样创建和 UIBezierPath

```
UIBezierPath path = [[UIBezierPath alloc] init]
[path moveToPoint: CGPoint(x,y)] // X and Y, start point
[path addLineToPoint:CGPoint(x2,y2) // X2 and Y2, end point 
```

如果要创建形状，可以使用方法放置更多点`addLineToPoint:`并完成使用 `closePath`方法

希望对你有帮助

# ios - 我是否需要 Mac 设备才能拥有“签名密钥”？

> ID：15668850
> 
> 赞同：0
> 
> 时间：2013-03-27T20:33:03.877
> 
> 标签：ios, cordova, certificate, key, signing

我正在PhoneGap 上开发移动应用程序。我没有“签名密钥”。但是，如果我支付 99 美元来获得一个 Apple Developer 帐户，我是否需要一台 MacOS 计算机来开发 phonegap 应用程序？我将在 iPad 上测试应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:44:25.430

> 我正在PhoneGap 上开发移动应用程序。我没有“签名密钥”。但如果我支付99 美元来获得Apple Developer 帐户。

要创建 IPA 或在 iPad 上测试应用程序，您应该有一个 Apple Developer 帐户。

> 我需要有一台 IOS 电脑来开发 phonegap 应用程序吗？

PhoneGap 有两种方法可以做到这一点。更简单的是PhoneGap Build。使用“运行”菜单上的“构建本机应用程序”将您的项目上传到他们的网站。几分钟后，您可以下载适用于 Apple iOS、Google Android、Palm、Symbian、BlackBerry 等应用程序商店的应用程序。

更复杂的方法是PhoneGap SDK。您需要下载完整的开发 SDK，安装和配置，然后在您自己的机器上编译。此方法是免费的，但设置起来可能既费时又棘手。

[在此处](http://www.nsbasic.com/app/tutorials/TT11.htm)查看更多详细信息

# android - cordova facebookConnect - 三星 g s3 上的登录刷新

> ID：15668851
> 
> 赞同：0
> 
> 时间：2013-03-27T20:33:04.523
> 
> 标签：android, facebook, cordova

我最近决定测试 Cordava FacebookConnect ( [https://github.com/mgcrea/cordova-facebook-connect](https://github.com/mgcrea/cordova-facebook-connect) )。

我设法安装在一个适用于 Android 虚拟设备的 Android 项目上。但是当我插入我的三星 GS3 时，该设备很合适，只是不断刷新应用程序。

我的代码非常基本：

```
var app = {

    initialize : function() {
        this.bindEvents();
    },

    bindEvents: function() {
        document.addEventListener('deviceready', this.onDeviceReady, false);
    },  

    onDeviceReady: function() {

        var facebookConnect = window.plugins.facebookConnect;

        console.log('ready');

        facebookConnect.login(
            { 
                permissions : ["email", "user_about_me"], 
                appId       : "3560694656564117"
            }, function(result) 
        {

            console.log("FacebookConnect.login:" + JSON.stringify(result));

            if( result.cancelled || result.error ) {

                console.log("FacebookConnect.login:failedWithError:" );

            }

        });

    }

}; 
```

奇怪的是，控制台每秒都会记录“就绪”，这不在 facebookConnect 回调中。就好像我以前登录过，重新访问了应用程序，插件验证了我的凭据，对话框关闭然后重新开始！如果我注释掉它正常加载的 facebookConnect 登录方法，控制台只会记录一次“准备就绪”。

有没有人遇到过这个？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:21:03.590

确保您在 facebook 应用程序仪表板中设置了本机 android 应用程序部分。特别是哈希键部分。

您应该指出是否调用了 facebook 回调。

如果出现 fb 错误，您可以随时查看 logcat。

# php - 按自定义字段排序 Cgridview

> ID：15668852
> 
> 赞同：1
> 
> 时间：2013-03-27T20:33:05.723
> 
> 标签：php, yii, cgridview

我知道有人问过类似的问题，对不起，但我一辈子都看不到我做错了什么。任何帮助将不胜感激。我要做的就是向 CGridView 添加一个额外的列，该列在数据库中总共显示两个值。

这些是我采取的步骤：

```
Database
User(forename, surname, part1, part2)

class User extends Controller:
    protected function getTotal($data,$row,$dataColumn){
            return $data->getAttribute('part1')+$data->getAttribute('part2');
    } 

    public function actionIndex(){
            $dataProvider=new CActiveDataProvider('User');
            $this->render('index',array(
                    'dataProvider'=>$dataProvider,
            ));
    }

class Stadium extends CActiveRecord:
    public function rules(){
            return array(
                    array('forename, surname', 'required'),
                    array('forename', 'surname', 'max'=>50),
                    array('part1, part2', 'numerical', 'integerOnly'=>true),

                    array('forename, surname, part1, part2, total', 'safe', 'on'=>'search'),
            );
    }

    public function attributeLabels()
    {
            return array(
                    'forename' => 'forename',
                    'surname' => 'surname',
                    'part1' => 'part1',
                    'part2' => 'part2',
                    'total' => array(
                            'asc'=>'part1 + part2',
                            'desc'=>'part1 + part2 desc',
                    ),
            );
    }

    public function search(){
            $criteria=new CDbCriteria;

            $criteria->compare('forename',$this->forename,true);
            $criteria->compare('surname',$this->surname,true);

            $criteria->compare('part1',$this->part1);
            $criteria->compare('part2',$this->part2);

            $criteria->compare('total',$this->part1 + $this->part2,true);

            $sort = new CSort();
            $sort->attributes = array(
                'total'=>array(
                    'asc'=>'part1 + part2 ASC',
                    'desc'=>'part1 + part2 DESC',
                ),
                '*',
            );

            return new CActiveDataProvider(User', array(
                    'criteria'=>$criteria,
                    'sort'=>$sort,
            ));
    }
}

view/User/index.php
    <?php $this->widget('zii.widgets.grid.CGridView', array(
                    'itemsCssClass'=>'table table-hover',
                    'dataProvider'=>$dataProvider,
                    'template'=>"{items}",
                    'columns'=>array(
                            array('name'=>'forename', 'header'=>'Forename'),
                            array('name'=>'surname', 'header'=>'Surname'),
                            array('name'=>'total', 'header'=>'Total', 'value'=>array($this, 'getTotal')),
                    ),
            )); ?>
<?php $this->endWidget();?> 
```

非常感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:46:36.043

解决方案：好的，这是您需要做的：

```
class Stadium extends CActiveRecord:
    public $total; //add this line

    //your rules should be fine

    //don't know if you need the asc and desc on attribute labels i just have one
    'total' => 'Total',

    $criteria->compare('total',$this->total); //change this line

    //i didn't use a Csort you might be able to but this is they way i did it
    return new CActiveDataProvider(User', array(
        'criteria'=>$criteria,
        'sort'=> array(
            'attributes' => array(
                'total'=>array(
                    'asc'=>'(part1 + part2) ASC',
                    'desc'=>'(part1 + part2) DESC',
                ),
                '*',
            ),
        ),
    ));

    //add this inside your model also
    public function afterFind() {
        parent::afterFind();
        $this->total = $this->part1+ $this->part2;
        return;
    } 
```

模型中的其他一切都很好。然后在您的 CGridView 上只需更改一行：

```
array('name'=>'total', 'header'=>'Total'), //don't need to set value it is part of the model like other columns now 
```

[http://www.yiiframework.com/forum/index.php/topic/21114-create-now-model-variable/](http://www.yiiframework.com/forum/index.php/topic/21114-create-now-model-variable/)

* * *

原答案：

我相信如果您要使用一个`CSort`对象，您需要将其添加到`CActiveDataProvider`using 中`setSort()`，或者您不必创建一个对象`CSort`，您可以将其直接放入 DataProvider 中。

选项1：

```
 $sort = new CSort();
    $sort->attributes = array(
        'total'=>array(
            'asc'=>'part1 + part2 ASC',
            'desc'=>'part1 + part2 DESC',
        ),
        '*',
    );

    $data = new CActiveDataProvider(User', array(
            'criteria'=>$criteria,
    ));
    $data->setSort($sort);
    return $data; 
```

选项 2：

```
return new CActiveDataProvider(User', array(
    'criteria'=>$criteria,
    'sort'=> array(
        'attributes' => array(
            'total'=>array(
                'asc'=>'part1 + part2 ASC',
                'desc'=>'part1 + part2 DESC',
            ),
            '*',
        ),
    ),
)); 
```

这可能会有所帮助 [http://www.yiiframework.com/wiki/381/cgridview-clistview-and-cactivedataprovider/#hh11](http://www.yiiframework.com/wiki/381/cgridview-clistview-and-cactivedataprovider/#hh11) [http://www.yiiframework.com/doc/api/1.1/CDataProvider#setSort-detail](http://www.yiiframework.com/doc/api/1.1/CDataProvider#setSort-detail)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:53:06.257

此外，Pitchinnate 的回答可能对您有所帮助，我注意到您有一种倾向，即您将逗号放在不应该出现的地方。例如

代替：

```
 $sort->attributes = array(
            'total'=>array(
                'asc'=>'part1 + part2 ASC',
                'desc'=>'part1 + part2 DESC',
            ),
            '*',
        ); 
```

你需要：

```
 $sort->attributes = array(
            'total'=>array(
                'asc'=>'part1 + part2 ASC',
                'desc'=>'part1 + part2 DESC'
            ),
            '*'
        ); 
```

你应该去掉最后一个元素之后的所有逗号。

# mysql - MIN( ) 有条件吗？MySQL

> ID：15668854
> 
> 赞同：5
> 
> 时间：2013-03-27T20:33:14.290
> 
> 标签：mysql

所以我有一个有几列的表，我正在做一个`GROUP BY`. 除了获取其他列之外，我还想在`MIN()`另一列为`NULL`. 这是我到目前为止所拥有的：

表列：

```
id        INT(11) UNSIGNED NOT NULL PRIMARY KEY AUTO_INCREMENT,
table2_id INT(11) UNSIGNED NOT NULL,
iteration INT(11) UNSIGNED,
timestamp INT(11) UNSIGNED NOT NULL 
```

SQL：

```
SELECT
    table2_id,
    COUNT(id) as total,
    COUNT(iteration) as completed,

    # I want the MIN(timestamp) but only when
    # iteration IS NULL
    MIN(timestamp) as next_incomplete
FROM
    table1
GROUP BY
    table2_id 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-27T20:35:58.513

将其用于`MIN`表达式：

```
MIN(CASE WHEN iteration IS NULL THEN timestamp END) as next_incomplete 
```

# c# - 来自 path.combine 的意外行为

> ID：15668856
> 
> 赞同：3
> 
> 时间：2013-03-27T20:33:18.890
> 
> 标签：c#, .net

给定代码：

```
 string p = @"C:\Users\Brian";
   string p2 = @"\bin\Debug";
   string result = Path.Combine(p, p2);//result: \bin\Debug
   Console.WriteLine(result); 
```

我希望看到以下结果：

```
 C:\Users\Brian\bin\Debug 
```

然而结果是

```
 \bin\Debug 
```

如果我初始化`p2 = @"bin\Debug";`

然后结果如预期。查看 MSDN，这似乎按设计工作：

> 如果 path2 不包含根（例如，如果 path2 不以分隔符或驱动器规范开头），则结果是两个路径的串联，中间有分隔符。如果 path2 包含根，则返回 path2。

`\`IMO，在.NET中排除作为根更有意义。AFAIK，这在任何 Windows 操作系统上都不是有效的根目录（`\\`可以）。然后我可以组合部分路径，而不用担心部分路径是否以`\`.

为什么这种方法设计为考虑单个`\`根？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T20:35:30.683

> 为什么这种方法设计为考虑单个 \ 一个根？

因为就其他操作而言，它*是根。*例如，在命令提示符下：

```
c:\Users\Jon\Test>dir \
 Volume in drive C is Windows8_OS
 Volume Serial Number is C058-6ADE

 Directory of c:\ 
```

或者来自 .NET 中的其他文件操作：

```
using System;
using System.IO;

class Test
{
    static void Main()
    {
        var lines = File.ReadAllLines(@"\Users\Jon\Test\Test.cs");
        Console.WriteLine(lines.Length);
    }
} 
```

输出：

```
11 
```

或来自 Java：

```
import java.io.*;
public class Test {

    public static void main(String[] args) throws Exception {
        String path = "\\Users\\Jon\\Test\\Test.java";
        // Just to prove that the double backslashes are language escapes...
        System.out.println(path);

        // Obviously we'd normally clean stuff up...
        InputStream stream = new FileInputStream(path);
        BufferedReader reader = new BufferedReader
            (new InputStreamReader(stream, "utf-8"));
        System.out.println(reader.readLine());
    }
} 
```

输出：

```
\Users\Jon\Test\Test.java
import java.io.*; 
```

我敢说本机代码也是如此。

那么，Windows 哪里*不允许*您以“\”开头的路径在当前驱动器中对其进行根目录？

> 为什么这种方法设计为考虑单个 \ 一个根？

我认为更大的问题是为什么你开始了你想要的*相对*路径`\`。

# android - 我在背景图片中的所有内容

> ID：15668857
> 
> 赞同：0
> 
> 时间：2013-03-27T20:33:21.063
> 
> 标签：android, android-layout, background-image, android-imageview

基本上我想尝试的是把我的所有内容都放在一个图像中。我查了一些东西，但他们所做的总是使用 imageView 和文本。但我想用它作为背景图片。

有人可以给我一个例子，这到底是如何工作的？由于内容始终必须保留在图像中，因此如何支持将其用于不同的屏幕尺寸？为了澄清我想要什么，我添加了一张图片。绿色空间是在 android xml 中绘制的背景，白色是实际图像，文本应该是我的所有内容。我想把所有东西都保持在白色，即使我有更多的边缘。

![在此处输入图像描述](../Images/70a51e684cff4ee6f25a3887e821f7f1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T22:03:50.403

最简单的方法是拥有 3 层

顶部遮罩内容图像底部

蒙版将是一个图像视图（在您的情况下，只有绿色部分，其余部分透明）。基本图像可以是任何东西，但它是对遮罩层的补充。

内容将是棘手的部分。您将需要弄清楚遮罩层的边界，这样您就不会进入遮罩之下。我建议将内容居中。

或者，如果形状会改变大小或复杂，我会建议使用带有剪裁图案的画布。[在 Android 上，如何制作形状奇特的剪裁区域？](https://stackoverflow.com/questions/9285450/on-android-how-do-i-make-oddly-shaped-clipping-areas)

# javascript - 使用已知的 href 变量获取 attr(id)

> ID：15668862
> 
> 赞同：0
> 
> 时间：2013-03-27T20:33:33.520
> 
> 标签：javascript, jquery

由于在变量中设置了 href 值，我想获得 id 名称。

为此，我想：

*   获取点击元素的 attr('href') （有效）。
*   把它放在一个变量中（OK）。
*   在每个名为“.link”的类中搜索这个href（不在#prev-ajax，#next-ajax id中）（问题）
*   获取父 ID。

我试过这个：

```
$('#prev-ajax,#next-ajax').click(function(e) {
    e.preventDefault();
    var href = $(this).attr('href');
    $(".link[href*= href ]:not('#prev-ajax,#next-ajax')");
    var ajax = $(this).parents('.element').attr('id');
    alert(ajax);
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:34:33.080

当您使用 JavaScript 变量时，您需要转义引号。另外，不要将`:not`选择器中的项目用引号括起来。

试试这个：

```
$(".link[href*= '" + href + "']:not(#prev-ajax, #next-ajax)"); 
```

编辑：看着你的小提琴，你也**没有用那个选择器做任何事情**。看到这个：

```
$(".link[href*= '" + href + "']:not(#prev-ajax, #next-ajax)");
var ajax = $(this).parents('.element').attr('id'); 
```

它**应该是**：

```
var link = $(".link[href*= '" + href + "']:not(#prev-ajax, #next-ajax)");
var ajax = link.parents('.element').attr('id'); 
```

演示： http: [//fiddle.jshell.net/UKyT4/1/](http://fiddle.jshell.net/UKyT4/1/)

# c - 将指向结构的指针传递给C中的函数

> ID：15668864
> 
> 赞同：0
> 
> 时间：2013-03-27T20:33:41.187
> 
> 标签：c, pointers, struct

我正在尝试编写一个函数，通过传入三个矩阵、要添加的两个矩阵和结果矩阵来添加两个矩阵。我用结构表示一个矩阵。这是我的代码

```
#include <stdio.h>
#include <stdlib.h>

typedef struct{
  int rows;
  int columns;
  double *data;
}Mat;

int Add(Mat *m1, Mat *m2, Mat **result);

int main(){
  Mat m1,m2;
  Mat *result = NULL;

  m1.rows=2;
  m1.columns=2;
  double temp1[2][2] = {{1,2},{3,4}};
  m1.data = &temp1[0][0];

  m2.rows = 2;
  m2.columns = 2;
  double temp2[2][2] = {{1,1},{1,1}};
  m2.data = &temp2[0][0];

  Add(&m1,&m2,&result);
  int ii,jj;
  printf("\nresult\n");
  for(ii=0;ii<2;ii++){
     for(jj=0;jj<2;jj++){
         printf("%f ",*result->data++);
      }
    printf("\n");
   }
   printf("%d\n ",result->columns);

 return 0;
}

int Add(Mat *m1, Mat *m2, Mat **result)
{
  int ii,jj;
  double new[m1->rows][m1->columns];
  int mat_size = (m1->rows)*(m1->columns);
  Mat *temp = malloc(sizeof(int)*2+sizeof(double)*mat_size);
  temp->rows = 2;
  temp->columns = 2;

  for(ii=0;ii<(m1->rows);ii++){
    for(jj=0; jj<(m1->columns);jj++){
      new[ii][jj] = *(m1->data++) + *(m2->data++);
     }
  }
  temp->data = &new[0][0];
   *result = temp;

} 
```

当我尝试打印结果矩阵时，我遇到的问题是在我的主要功能结束时。它只打印 0。我能够正确打印“结果”的列和行，但不能正确打印数据。任何人都可以帮忙吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:49:22.823

您的 Add 函数中有几个基本错误。这里有一个更正的版本。

```
void Add(Mat *m1, Mat *m2, Mat **result)
{
   int ii,jj;
   int mat_size = (m1->rows)*(m1->columns);
   Mat *temp = malloc(sizeof(Mat));         /* Allocate the matrix header */
   temp->rows    = m1->rows;
   temp->columns = m1->columns;
   temp->data    = calloc(mat_size, sizeof(double));     /* Allocate the matrix data */

   for(ii=0; ii<m1->rows; ii++) {
     int row = ii*m1->columns;
     for(jj=0; jj<m1->columns; jj++)
       temp->data[row + jj] = m1->data[row + jj] + m2->data[row + jj]; 
       /* or something like that*/
   }
       /* In any case, incrementing the data pointer is wrong */

  *result = temp;
} 
```

尽管如此，仍然缺少一些东西。没有完整性检查，即矩阵维度是否兼容并且没有检查分配错误。

# jsf - Apache Myfaces 在使用 h:dataTable 和空数据集时打印空白 td 标签

> ID：15668867
> 
> 赞同：3
> 
> 时间：2013-03-27T20:33:48.437
> 
> 标签：jsf, jsf-2, datatable, myfaces

当支持 an 的 List 或 Array为空时，有没有办法让 MyFaces*不*打印以下内容？`h:dataTable`

```
<table>
    <tbody id="itemsForm:itemsDataTable:tbody_element">
        <tr>
            <td></td>
        </tr>
    </tbody>
</table> 
```

我怀疑打印一个空的 tbody 会更正确。可以以某种方式覆盖它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T22:13:06.830

根据[XHTML 规范](http://www.w3.org/TR/xhtml1/dtds.html#a_dtd_XHTML-1.0-Transitional)，这些元素是必需的。*至少*`<table>`需要一个. 依次需要至少*一个*. *`<tr>``<tr>` *`<td>`**

 **```
<!ELEMENT table
     (caption?, (col*|colgroup*), thead?, tfoot?, (tbody+|tr+))>
<!ELEMENT caption  %Inline;>
<!ELEMENT thead    (tr)+>
<!ELEMENT tfoot    (tr)+>
<!ELEMENT tbody    (tr)+>
<!ELEMENT colgroup (col)*>
<!ELEMENT col      EMPTY>
<!ELEMENT tr       (th|td)+>
<!ELEMENT th       %Flow;>
<!ELEMENT td       %Flow;> 
```

*（`+`代表一个或多个，`*`代表零或多个，`?`代表零或一）*

最好的办法是在数据模型为空时完全隐藏表格。

```
<h:dataTable ... value="#{bean.items}" rendered="#{not empty bean.items}"> 
```

否则，您无法绕过自定义渲染器。**

# r - 将宽格式重塑为多列长格式

> ID：15668870
> 
> 赞同：17
> 
> 时间：2013-03-27T20:33:57.447
> 
> 标签：r, reshape, reshape2, melt

我想重塑一个具有多个测试的宽格式数据集，这些测试在 3 个时间点进行测量：

```
 ID   Test Year   Fall Spring Winter
    1   1   2008    15      16      19
    1   1   2009    12      13      27
    1   2   2008    22      22      24
    1   2   2009    10      14      20
    2   1   2008    12      13      25
    2   1   2009    16      14      21
    2   2   2008    13      11      29
    2   2   2009    23      20      26
    3   1   2008    11      12      22
    3   1   2009    13      11      27
    3   2   2008    17      12      23
    3   2   2009    14      9       31 
```

进入一个按列分隔测试但将测量时间转换为长格式的数据集，对于每个新列，如下所示：

```
 ID  Year    Time        Test1 Test2
    1   2008    Fall        15      22
    1   2008    Spring      16      22
    1   2008    Winter      19      24
    1   2009    Fall        12      10
    1   2009    Spring      13      14
    1   2009    Winter      27      20
    2   2008    Fall        12      13
    2   2008    Spring      13      11
    2   2008    Winter      25      29
    2   2009    Fall        16      23
    2   2009    Spring      14      20
    2   2009    Winter      21      26
    3   2008    Fall        11      17
    3   2008    Spring      12      12
    3   2008    Winter      22      23
    3   2009    Fall        13      14
    3   2009    Spring      11      9
    3   2009    Winter      27      31 
```

我没有成功尝试使用重塑和融化。现有帖子地址转换为单列结果。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-27T20:43:27.097

使用`reshape2`：

```
# Thanks to Ista for helping with direct naming using "variable.name"
df.m <- melt(df, id.var = c("ID", "Test", "Year"), variable.name = "Time")
df.m <- transform(df.m, Test = paste0("Test", Test))
dcast(df.m, ID + Year + Time ~ Test, value.var = "value") 
```

* * *

### 更新：使用版本 >= 1.9.0 的 data.table 熔体/铸造：

`data.table`从版本 1.9.0 导入包并在 C 中为 data.tables`reshape2`实现快速`melt`和方法。`dcast`更大数据上的速度比较如下所示。

有关新闻的更多信息，请访问[**此处**](https://stackoverflow.com/a/6913151/559784)。

```
require(data.table) ## ver. >=1.9.0
require(reshape2)

dt <- as.data.table(df, key=c("ID", "Test", "Year"))
dt.m <- melt(dt, id.var = c("ID", "Test", "Year"), variable.name = "Time")
dt.m[, Test := paste0("Test", Test)]
dcast.data.table(dt.m, ID + Year + Time ~ Test, value.var = "value") 
```

目前，您必须`dcast.data.table`明确编写，因为它还不是 S3 通用的`reshape2`。

* * *

### 对更大数据进行基准测试：

```
# generate data:
set.seed(45L)
DT <- data.table(ID = sample(1e2, 1e7, TRUE), 
        Test = sample(1e3, 1e7, TRUE), 
        Year = sample(2008:2014, 1e7,TRUE), 
        Fall = sample(50, 1e7, TRUE), 
        Spring = sample(50, 1e7,TRUE), 
        Winter = sample(50, 1e7, TRUE))
DF <- as.data.frame(DT) 
```

### reshape2 时间：

```
reshape2_melt <- function(df) {
    df.m <- melt(df, id.var = c("ID", "Test", "Year"), variable.name = "Time")
}
# min. of three consecutive runs
system.time(df.m <- reshape2_melt(DF))
#   user  system elapsed 
# 43.319   4.909  48.932 

df.m <- transform(df.m, Test = paste0("Test", Test))

reshape2_cast <- function(df) {
    dcast(df.m, ID + Year + Time ~ Test, value.var = "value")
}
# min. of three consecutive runs
system.time(reshape2_cast(df.m))
#   user  system elapsed 
# 57.728   9.712  69.573 
```

### data.table 时间：

```
DT_melt <- function(dt) {
    dt.m <- melt(dt, id.var = c("ID", "Test", "Year"), variable.name = "Time")
}
# min. of three consecutive runs
system.time(dt.m <- reshape2_melt(DT))
#   user  system elapsed 
#  0.276   0.001   0.279 

dt.m[, Test := paste0("Test", Test)]

DT_cast <- function(dt) {
    dcast.data.table(dt.m, ID + Year + Time ~ Test, value.var = "value")
}
# min. of three consecutive runs
system.time(DT_cast(dt.m))
#   user  system elapsed 
# 12.732   0.825  14.006 
```

`melt.data.table`比.快**约****175**倍`reshape2:::melt`，`dcast.data.table`比.**`reshape2:::dcast`**

 *** * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-28T02:37:24.590

坚持使用base R，这是“ `stack`+ `reshape`”例程的另一个很好的候选者。假设我们的数据集称为“mydf”：

```
mydf.temp <- data.frame(mydf[1:3], stack(mydf[4:6]))
mydf2 <- reshape(mydf.temp, direction = "wide", 
                 idvar=c("ID", "Year", "ind"), 
                 timevar="Test")
names(mydf2) <- c("ID", "Year", "Time", "Test1", "Test2")
mydf2
#    ID Year   Time Test1 Test2
# 1   1 2008   Fall    15    22
# 2   1 2009   Fall    12    10
# 5   2 2008   Fall    12    13
# 6   2 2009   Fall    16    23
# 9   3 2008   Fall    11    17
# 10  3 2009   Fall    13    14
# 13  1 2008 Spring    16    22
# 14  1 2009 Spring    13    14
# 17  2 2008 Spring    13    11
# 18  2 2009 Spring    14    20
# 21  3 2008 Spring    12    12
# 22  3 2009 Spring    11     9
# 25  1 2008 Winter    19    24
# 26  1 2009 Winter    27    20
# 29  2 2008 Winter    25    29
# 30  2 2009 Winter    21    26
# 33  3 2008 Winter    22    23
# 34  3 2009 Winter    27    31 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-28T00:57:02.507

基`reshape`函数替代方法如下。虽然这需要使用`reshape`两次，但可能有更简单的方法。

假设您的数据集被调用`df1`

```
tmp <- reshape(df1,idvar=c("ID","Year"),timevar="Test",direction="wide")
result <- reshape(
   tmp,
   idvar=c("ID","Year"),
   varying=list(3:5,6:8),
   v.names=c("Test1","Test2"),
   times=c("Fall","Spring","Winter"),
   direction="long"
) 
```

这使：

```
> result
              ID Year   time Test1 Test2
1.2008.Fall    1 2008   Fall    15    22
1.2009.Fall    1 2009   Fall    12    10
2.2008.Fall    2 2008   Fall    12    13
2.2009.Fall    2 2009   Fall    16    23
3.2008.Fall    3 2008   Fall    11    17
3.2009.Fall    3 2009   Fall    13    14
1.2008.Spring  1 2008 Spring    16    22
1.2009.Spring  1 2009 Spring    13    14
2.2008.Spring  2 2008 Spring    13    11
2.2009.Spring  2 2009 Spring    14    20
3.2008.Spring  3 2008 Spring    12    12
3.2009.Spring  3 2009 Spring    11     9
1.2008.Winter  1 2008 Winter    19    24
1.2009.Winter  1 2009 Winter    27    20
2.2008.Winter  2 2008 Winter    25    29
2.2009.Winter  2 2009 Winter    21    26
3.2008.Winter  3 2008 Winter    22    23
3.2009.Winter  3 2009 Winter    27    31 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-05-25T07:43:19.827

`tidyverse`/`tidyr`解决方案：

```
library(dplyr)
library(tidyr)

df %>% 
  gather("Time", "Value", Fall, Spring, Winter) %>% 
  spread(Test, Value, sep = "") 
```**

# javascript - 替换正则表达式中的最后一个匹配项

> ID：15668872
> 
> 赞同：1
> 
> 时间：2013-03-27T20:34:06.290
> 
> 标签：javascript, regex

我有一个自动完成的用户标记系统，可以填写 @ 符号之后的用户名。但是，我有这个问题，我有两个具有匹配子字符串的用户。例如：

`Tagging @billy and @b` 当用户使用名为（例如）@brendan 的用户填写 @b 标记时，它将替换 @billy 标记。如何倒退并仅替换最后一个标签？

编辑：这是我目前的解决方案，但感觉很笨拙。有没有办法只用 RegEx 做到这一点？：

```
function tagUser (chosenUsername) {
  var userRegex = new RegExp('(^|\\s)@([' + lastUserTag() + ']*)$', 'gi');
  var caption = $("#example").val();
  var match = caption.match(userRegex);

  var lastMatch = match[match.length - 1];
  $("#example").val(caption.replace(lastMatch, " @" + chosenUsername));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:51:34.357

不确定我是否完全理解您的问题。但是，只是为了让您知道，您可以使用负前瞻来仅替换最后匹配的文本，如下所示：

```
var str='@billy and @b';
str = str.replace(/@b\b(?!.*?@b\b)/, 'brendan'); 
```

# android - 开始新的活动意图错误

> ID：15668873
> 
> 赞同：0
> 
> 时间：2013-03-27T20:34:09.747
> 
> 标签：android, android-intent, android-activity

您好，我的应用程序上有 2 个活动，当我尝试我的代码时，我希望能够通过单击按钮在它们之间切换，但出现错误：

> 03-27 22:27:08.370: E/AndroidRuntime(9051): android.content.ActivityNotFoundException: 没有找到处理 Intent { act=com.tdgame.dorbt12.MAIN } 的活动

我的代码是：

```
 @Override
public void onClick(View v) {
    Intent open = new Intent("com.tdgame.dorbt12.MAIN");
    startActivity(open);
} 
```

这两个活动名称是：Main 和 Must

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:39:50.060

你还没有`com.price.dor.MAIN` 在你的清单中添加。

尝试像这样设置活动，因为您正在根据意图过滤器识别活动

```
 <activity
            android:name=".Main" >
            <intent-filter>
                <action android:name="com.tdgame.dorbt12.MAIN" />  //required
                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity> 
```

您需要意图过滤器操作标记，因为您使用该标记传递意图。

```
 Intent open = new Intent("com.tdgame.dorbt12.MAIN"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:41:48.060

尝试以下操作：

```
Intent open = new Intent(currentActivitiy.this, destinationActivity.class);
startActivity(open); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:42:45.343

你的意图的语法不应该有点不同吗？我通常写：

```
Intent open = new Intent(this, SecondActivity.class); 
```

`SecondActivity`您要运行的 Activity 的名称在哪里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T20:43:06.453

用这个

```
 Intent open  = new Intent(Main.this, Must.class);
            startActivity(open); 
```

添加

```
 <activity android:name=".Must" /> 
```

在关闭`application`你的清单之前

# mysql - 完整性错误django

> ID：15668874
> 
> 赞同：0
> 
> 时间：2013-03-27T20:34:14.277
> 
> 标签：mysql, django, sqlite

我在 django 项目中将 sqlite3 用于我的数据库，然后我决定将其更改为 mysql 引擎。我正确更改了settings.py中的所有内容，为了不丢失数据库，我将我的sqlite转储为文本，并用`更改了每个“，删除了提交和与sqlite3相关的所有内容。我在mysql上执行了转储文件并一切都完美地添加了但是，当我尝试在名为类别的表中添加类别时。

我收到此错误消息

> /admin/red_carpet/category/ 处的 IntegrityError
> （1062，“密钥 1 的重复条目 '0'”）

我认为关键是重复的错误是什么。我查看了“id”列以查看它的结构，我发现 id 列是“NOT NULL”。该列没有添加自动增量，所以我添加了它并尝试从管理页面执行类别我得到了同样的错误我再次查看了结构，然后我添加了`auto_increment`不应该从 0 开始但应该从 0 开始的查询最后一个值是 6。然后我再次从 django admin 添加了类别，但我仍然得到相同的错误，再次查看结构​​，特别是在 phpmyadmin 的索引部分中，我发现了那行

```
Keyname Type        Cardinality  Action  Field
PRIMARY  PRIMARY       9                 id 
```

对我来说，一切看起来都不错，实际上，当我通过 django admin 添加价值时，我得到了添加，尽管我收到了相同的错误消息

> /admin/red_carpet/category/ 处的 IntegrityError
> （1062，“密钥 1 的重复条目 '0'”）

我真的不明白为什么会出现这个问题！！！！任何人以前都彻底了解过这个！??

PS：当我尝试删除某些内容时，我会收到相同的错误消息。例如，如果我要删除一个类别，我会收到 exat 错误消息，但是当我查看数据库时，我发现该类别已被删除！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T13:07:09.400

防止跨数据库问题的一种方法是使用固定装置，例如以（db-agnostic）json 格式转储和加载数据：

请参阅django 文档中的[转储数据命令](https://docs.djangoproject.com/en/1.3/ref/django-admin/#dumpdata-appname-appname-appname-model)和 [固定装置](https://docs.djangoproject.com/en/dev/ref/django-admin/#what-s-a-fixture) 。

# joomla - 在 joomla 中打印

> ID：15668876
> 
> 赞同：1
> 
> 时间：2013-03-27T20:34:18.867
> 
> 标签：joomla, joomla2.5

我需要帮助来解决完全阻止我的项目的打印问题。准确地说，我有两篇包含 PHP 代码的 Joomla 文章（我使用插件 Free sourcerer）。

## 第一篇文章包含以下代码：

```
{source}
  <form method="post" action="http://localhost/essai/index.php?option=com_content&view=article&id=2">
     <p>
         <input type="text" name="num" />
     </p>
   <input type="submit" value="Display the value of num" />
  </form>
{/source} 
```

## id 为 2 的第二篇文章包含以下代码：

```
{sourcer}
   if (isset ($_POST [ 'num'])) { 
       $Address=J Request :: getVar( 'num', '', 'post'); 
       echo $Address; 
   } else { 
       echo "num does not exist";
   }
{/source} 
```

我的目标是恢复第二篇文章中 id 为 2 的表单 num 的输入字段的值并打印。当我点击“显示num的值”按钮时，值区`num`被检索并显示，但是当我点击链接打印文章时，在打开的窗口中显示“不存在num”。当我打印文章时，`$ _POST ['num']`不存在！

这是在 Joomla 或其他中打印的问题吗？请帮帮我。

> **注意**：我使用 Joomla_2.5.9，模板 Beez2 集成在 joomla 中，Sourcerer-Free v4.1.3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T11:11:36.653

您需要进行 2 项更改才能使其正常工作。

## 1 - 我在 PHP 中包含了表单

```
{source}
<?php       
    echo'<form method="post" action="http://localhost/essai/index.php?option=com_content&view=article&id=2">' .
        '<p>' .
        '<input type="text" name="num" />' .
        '</p>' .
        '<input type="submit" value="Display the value of num" />' .
        '</form>';
?>
{/source} 
```

## 2 - 从代码中删除一些额外的空格

```
{source}
<?php  
   if (isset($_POST['num'])) { 
       $Address=JRequest :: getVar('num','','post'); 
       echo $Address; 
   } else { 
       echo "num does not exist";
   }        
?>
{/source} 
```

# perl - 添加时间脚本 Perl

> ID：15668879
> 
> 赞同：0
> 
> 时间：2013-03-27T20:34:33.200
> 
> 标签：perl

我想创建一个脚本，它将接收 2 个参数（小时和分钟）（HH1:MN1 和 HH2:MN2）

*   如果#ARGV = 2，它必须有效
*   验证提供的时间是否正确（小时在 0 到 200 之间，分钟在 0 到 59 之间）
*   添加这些时间并打印到结果
*   如果打印 Nbday 超过 24 小时；HH:分钟
*   如果超过 7 天，它将打印周；第二天；HH：最小。

我从这个开始，但不知道如何继续计算欢迎任何帮助或想法谢谢

```
#!/usr/bin/perl

if ($#ARGV != 2)
{
print STDERR "Erreur Parameters have to be 2\n";
exit (-1);
}
if ($ARGV[0] = ~ / ([0-9] | 1 [0-9] ? [0-9] | 200 ) : ( [0-5] ? [0-9] ) /)
{
$heures1 = $1;
$minutes1 = $2;
}
else 
{
print STDERR "first parameter invalid\";
exit (-1);
}
if ($ARGV[1] = ~ / ([0-9] | 1 [0-9] ? [0-9] | 200 ) : ( [0-5] ? [0-9] ) /)
{
$heures2 = $3;
$minutes2 = $4;
}
`else `
{
print STDERR "Second parameter  invalid\";
exit (-1);
$heures = $heures1 + $heures2;
$minutes = $minutes1 + $minutes2' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:44:48.743

验证代码非常简单：

```
sub usage {
   print STDERR $_[0] if @_;
   print STDERR "usage: ...\n";
   exit(1);
}

usage() if @ARGV != 2;

my ($hours1, $minutes1) = $ARGV[1] =~ /^([0-9]+):([0-9]+)\z/ or usage();
my ($hours2, $minutes2) = $ARGV[1] =~ /^([0-9]+):([0-9]+)\z/ or usage();

0 <= $hours1   && $hours1   <= 200 or usage("Invalid number of hours for first argument\n");
0 <= $minutes1 && $minutes1 <=  59 or usage("Invalid number of minutes for first argument\n");
0 <= $hours2   && $hours2   <= 200 or usage("Invalid number of hours for second argument\n");
0 <= $minutes2 && $minutes2 <=  59 or usage("Invalid number of minutes for second argument\n"); 
```

范围检查可以通过正则表达式完成，但它容易出错且不可读。

```
/^0*(0|1[0-9]{0,2}|2(?:00?|[1-9])?|[3-9][0-9]?):0*(0|[1-5][0-9]?|[6-9])\z/ 
```

（正则表达式可能更简单一些，但它实际上是为了消除回溯的可能性。）

你已经[问](https://stackoverflow.com/questions/15627991/perl-script-time-calculator)过了，我们优雅地为数学部分提供了解决方案，那你为什么还要问呢？

```
my ($hours1, $minutes1) = split /:/, $arg1;
my ($hours2, $minutes2) = split /:/, $arg2;

my $hours   = $hours1   + $hours2;
my $minutes = $minutes1 + $minutes2;

$hours   += ($minutes - ($minutes % 60)) / 60;  $minutes %= 60;
my $days  = ($hours   - ($hours   % 24)) / 24;  $hours   %= 24;
my $weeks = ($days    - ($days    %  7)) /  7;  $days    %=  7; 
```

至于输出部分，你应该可以自己管理。一个有用的提示：

```
sprintf('%02d', $minutes)   # 0-padded to two digits 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:50:43.927

```
#!/usr/bin/perl

die "Erreur Parameters have to be 2" if (scalar(@ARGV) != 2) 

if ($ARGV[0] =~ /^([0-9]|1[0-9]?[0-9]|200):([0-5]?[0-9])$/) {
    $heures1 = $1;
    $minutes1 = $2;
} else {
    die "first parameter invalid";
}

if ($ARGV[1] =~ /^([0-9]|1[0-9]?[0-9]|200):([0-5]?[0-9])$/) {
    $heures2 = $3;
    $minutes2 = $4;
} else {
    die "Second parameter invalid";
}

$heures = $heures1 + $heures2;
$minutes = $minutes1 + $minutes2' 
```

# javascript - 通过单个数组进行递归，记录 javascript 中所有可能的组合

> ID：15668880
> 
> 赞同：0
> 
> 时间：2013-03-27T20:34:34.263
> 
> 标签：javascript

例如，我有一个数组

```
["red", "green", "blue", "purple"] 
```

此数组中可以有任意数量的条目。使用这个数组，我想创建一个可能的组合列表，但从不复制一个组合

例如，上面的数组将导致

```
red,green,blue,purple
red,green,purple,blue
red,blue,green,purple
red,blue,purple,green
red,purple,blue,green
red,purple,green,blue

green,red,blue,purple
green,red,purple,blue
green,blue,red,purple
green,blue,purple,red
green,purple,blue,red
green,purple,red,blue

blue,red,green,purple
blue,red,purple,green
blue,green,red,purple
blue,green,purple,red
blue,purple,green,red
blue,purple,red,green

purple,red,green,blue
purple,red,purple,blue
purple,green,red,blue
purple,green,blue,red
purple,blue,green,red
purple,blue,red,green 
```

我是递归的新手，我还没有完全掌握如何用它来完成这个，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:42:43.070

```
function combs(arr,str){
  var arrCopy,popped;
  for(var i =0; i<arr.length; i++){
     arrCopy = arr.splice(0);
     popped = arrCopy.splice(i,1)
     combs(arrCopy,popped);
  }
  if(arr.length === 0){
    console.log(str);
  }
} 
```

这会将所有选项打印到控制台。如果您需要以某种格式返回它们，您可以返回而不是在基本情况下打印，并根据需要将递归调用的结果连接在一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:44:17.583

你可以从这个开始：

[http://rosettacode.org/wiki/Permutations#JavaScript](http://rosettacode.org/wiki/Permutations#JavaScript)

它被实现为输出到 HTML 元素，但您应该能够轻松地对其进行调整以满足您的需求。

# android - 为什么我的动态微调器没有填充

> ID：15668884
> 
> 赞同：1
> 
> 时间：2013-03-27T20:34:50.873
> 
> 标签：android, dynamic, spinner

我动态地创建了一个微调器。它出现但为空。它旨在包含以下字符串数组。

```
<string-array name="task_array">
      <item>task 1</item>
      <item>task 2</item>
      <item>task 3</item>
      <item>task 4</item>    
    </string-array> 
```

以下是我的扩展 fragmentactivity 类的代码

```
public void addNewView() {
        final TableLayout table = (TableLayout) findViewById(R.id.spLayout);
        Spinner sp = new Spinner(this);
        ArrayAdapter<CharSequence> adapter_tasks = ArrayAdapter.
                createFromResource(this, R.array.task_array,
                        android.R.layout.simple_spinner_item);
        table.addView(sp);
        for(int i = 0; i < 10; i++) {
        sp.setId(i+10);

    }} 
```

有任何想法吗？ta

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:37:53.797

您忘记将适配器添加到微调器。

采用`sp.setAdapter(adapter_tasks);`

# jquery - 包括从 Listview 到 DetailsPage 小提琴的 Jquery Mobile Jsonp

> ID：15668889
> 
> 赞同：0
> 
> 时间：2013-03-27T20:35:11.530
> 
> 标签：jquery, json, listview, mobile, dynamic

我正在开发一个 Jquery Mobile Listview，它从 .json 文件中动态获取数据交叉浏览。

这部分对我来说很好用......现在我想从 Listview 条目中显示 DetailsPage 但无法让它工作......

需要一些帮助才能使其正常工作...我的大脑卡住了...

这是我的 JsFiddle

jsfiddle.net/masterluke/NbaZ6/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:43:54.127

看起来您到详细信息页面的转换工作正常，但您不确定如何使用列表视图中的数据填充页面。

看看这个小提琴：http: [//jsfiddle.net/rfF3j/1/](http://jsfiddle.net/rfF3j/1/)

当它渲染数据时，它会做一些不同的事情：

1.  它存储`dataStore`对象中的所有数据，以`item.id`.
2.  `.jqmData`它使用该函数将 item.id 附加到新创建的行。
3.  在该行上创建一个单击处理程序，当单击该处理程序时：
    1.  `item-id`从行中获取。
    2.  使用它来查找`item`from `dataStore`。
    3.  使用数据填充详细信息页面`item`。

鉴于，这不是存储数据的最佳方式，但它是您希望将其保存在某个地方以便以后重复使用它的一个示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T08:40:59.727

哦，对不起我的愚蠢问题（我的大脑是 Codefrozen），我用 ajax="false" 解决了我的问题，但这对我来说不是最好的解决方案，但对于这个小型 WebApp 来说还可以......

我还有另一个关于 Jsonp 的问题要问你或其他人！我想按类别“对象”过滤结果并在列表视图中仅显示链接上指定类别的数组单击这是我的 JsonP 文件...

[小提琴上的完整 JsonPCode](http://jsfiddle.net/masterluke/2M9LN/)

```
 "id":"4",
    "name":"Marilyn",
    "slogan":"Essen&Trinken",
    "beschreibung":"diverse Leckereien in Verbindung mit einem in Einzelbrühung hergestellten Kaffee",
    "images":["http://bistro.de/427428_363474813673251_1907009930_n.jpg"],
    "offen1":"Di-So ab 11 Uhr",
    "offen2":"Montag Ruhetag",
    "offen3":"",
    "homepage":"http://",
    "strasse":"Am Markt 36",
    "ort":"hometown",
    "telefon":"tel: 1234242888193",
    "google":"http://.de"
} 
```

# java - 使用 webdriver 按字母顺序从表中获取数据

> ID：15668891
> 
> 赞同：0
> 
> 时间：2013-03-27T20:35:16.960
> 
> 标签：java, selenium, webdriver

有没有办法使用 webdriver 按字母顺序从表中获取数据。

例如：

一个表包含“sno、语言、文本、链接”

我想知道是否可以使用语言作为列按字母顺序获取数据。假设语言不是按字母顺序排列的……俄语、西班牙语、英语、中文……等等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T08:53:26.730

是的，您需要一个 DataStructure 来存储在查找表元素时列出的 WebElement。

对于 Java，您可以使用 HashMap 之类的 DataStructure，您可以在其中将链接文本保存为 Key，稍后您可以使用 Collection.sort 使用所需的属性/列对该 DataStructure 进行排序。

# r - R多核mcfork（）：无法分叉：无法分配内存

> ID：15668893
> 
> 赞同：21
> 
> 时间：2013-03-27T20:35:22.120
> 
> 标签：r, memory, amazon-ec2, multicore, domc

我收到了名义上的错误：

```
mcfork(): Unable to fork: Cannot allocate memory 
```

在尝试使用 mcapply 运行函数后，但`top`说我在 51%

这是在 EC2 实例上，但我确实有最新的 R。

有谁知道还有什么可能导致此错误？

谢谢，

-N

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2015-08-23T21:45:19.183

问题可能正是错误消息所暗示的：没有足够的内存来分叉和创建并行进程。

R 本质上需要为每个单独的进程创建内存中所有内容的副本（据我所知，它不使用共享内存）。如果您已经在单个进程中使用了 51% 的 RAM，那么您没有足够的内存来创建第二个进程，因为这总共需要 102% 的 RAM。

尝试：

1.  **使用更少的内核**- 如果您尝试使用 4 个内核，您可能有足够的 RAM 来支持 3 个并行线程，但不是 4 个`registerDoMC(2)`。例如，将并行线程数设置为 2（如果您使用的是`doMC`并行后端）。
2.  **使用更少的内存**- 没有看到你的代码的其余部分，很难提出实现这一目标的方法。可能有帮助的一件事是确定哪些 R 对象占用了所有内存（[确定对象的内存使用情况？](https://stackoverflow.com/questions/1395270/determining-memory-usage-of-objects)），然后从内存中删除不需要的任何对象（`rm(my_big_object)`）
3.  **添加更多 RAM** - 如果所有其他方法都失败，请将硬件投入其中，以便您拥有更多容量。
4.  **坚持**单线程 - R 中的多线程处理是 CPU 和内存的权衡。听起来在这种情况下你可能没有足够的内存来支持你拥有的 CPU 能力，所以最好的做法可能是只坚持一个核心。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-05-20T09:35:31.917

R 函数`mcfork`只是系统调用的一个包装器[`fork`](http://man7.org/linux/man-pages/man2/fork.2.html#NOTES)（顺便说一句，手册页说，这个调用本身就是一个包装器`clone`）

我创建了一个简单的 C++ 程序来测试`fork`的行为：

```
#include <stdio.h>
#include <unistd.h>

#include<vector>

int main(int argc, char **argv)
{
    printf("--beginning of program\n");

    std::vector<std::vector<int> > l(50000, std::vector<int>(50000, 0));

//    while (true) {}

    int counter = 0;
    pid_t pid = fork();
    pid = fork();
    pid = fork();

    if (pid == 0)
    {
        // child process
        int i = 0;
        for (; i < 5; ++i)
        {
            printf("child process: counter=%d\n", ++counter);
        }
    }
    else if (pid > 0)
    {
        // parent process
        int j = 0;
        for (; j < 5; ++j)
        {
            printf("parent process: counter=%d\n", ++counter);
        }
    }
    else
    {
        // fork failed
        printf("fork() failed!\n");
        return 1;
    }

    printf("--end of program--\n");
    while (true) {}
    return 0;
} 
```

首先，程序在堆上分配了大约 8GB 的​​数据。然后，它通过 fork 调用产生 2^2^2 = 8 个孩子并等待被用户杀死，然后进入无限循环以便在任务管理器上轻松发现。

以下是我的观察：

1.  要使 fork 成功，您需要在我的系统上至少有 51% 的可用内存，但这**包括 swap**。您可以通过编辑`/proc/sys/vm/overcommit_*`proc 文件来更改它。
2.  正如预期的那样，没有一个子进程占用更多内存，因此这 51% 的空闲内存在整个程序过程中保持空闲，并且所有后续分叉也不会失败。
3.  内存在分叉之间共享，因此只有在您杀死最后一个孩子后才会回收。

* * *

**内存碎片问题**

*您不应该担心与 fork 相关的任何内存碎片层*。R 的内存碎片在这里不适用，因为 fork 是在虚拟内存上操作的。您不必担心物理内存的碎片，因为几乎所有现代操作系统都使用虚拟内存（因此它们可以使用交换）。唯一可能存在问题的内存碎片是虚拟内存空间的碎片，但 Linux 虚拟内存空间上的 AFAIK 是 2^47，这非常大，几十年来，您在寻找连续的区域时应该没有任何问题任何实用尺寸。

# 概括：

确保你有比物理内存更多的交换空间，只要你的计算实际上不需要比 RAM 更多的内存，你就可以`mcfork`随心所欲地使用它们。

或者，如果您愿意冒整个系统的稳定性（内存不足）的风险，请`echo 1 >/proc/sys/vm/overcommit_memory`在 linux 上以 root 身份尝试。

或者更好：（更安全）

```
echo 2 >/proc/sys/vm/overcommit_memory
echo 100 >/proc/sys/vm/overcommit_ratio 
```

您可以在此处阅读有关过度使用的更多信息：[https ://www.win.tue.nl/~aeb/linux/lk/lk-9.html](https://www.win.tue.nl/~aeb/linux/lk/lk-9.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-11-30T08:39:34.427

**给那些想要使用 RStudio 等 GUI 的人的注意事项。**
如果您想利用并行处理，建议不要使用 GUI，因为这会中断您的代码和 GUI 程序之间的多线程进程。`registerDoMC`以下是R 包帮助手册的摘录：

> 最初由 Simon Urbanek 编写并包含在 R 2.14.0 中的并行包中的多核功能提供了用于在具有多个内核或处理器的机器上并行执行 R 代码的功能，使用系统 fork 调用来生成当前进程的副本。
> 
> 多核功能，因此 registerDoMC，不应该在 GUI 环境中使用，因为多个进程共享同一个 GUI。

`registerDoMC(cores = n)`我通过在使用 RStudio 运行我的程序时禁用来解决了 OP 遇到的类似错误。多处理最适合使用基础 R。希望这会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-31T14:31:04.043

我有同样的错误，同时使用插入符号在具有 64 GB 内存的系统上训练 rpart 模型，在 7 核机器上使用 6 核进行并行处理。换成5核，问题就出来了。

```
library(doMC)
registerDoMC(5) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-10T05:33:06.210

我现在遇到了类似的问题。我不会声称知道正确答案。上述两个答案都提出了可能有效的行动方案，特别是如果您的分叉同时对内存产生额外的写入需求。但是，我一直在想，其他可能是困难的根源。内存碎片。有关以下内容的讨论，请参阅[https://raspberrypi.stackexchange.com/questions/7856/log-says-i-cant-allocate-memory-but-i-have-more-than-half-of-my-memory-free](https://raspberrypi.stackexchange.com/questions/7856/log-says-i-cant-allocate-memory-but-i-have-more-than-half-of-my-memory-free)类似 Unix 的用户看到可用内存但由于内存碎片而遇到内存不足错误的情况。这似乎是 R 的罪魁祸首，尤其是因为 R 喜欢连续的 RAM 块。也每`?Memory-limits`要求应该是关于地址空间而不是 RAM 本身 - 所以这可能是不正确的（尤其是在 64 位机器上）YMMV。

# c++ - 更改 while 循环以适应两种情况

> ID：15668894
> 
> 赞同：2
> 
> 时间：2013-03-27T20:35:26.887
> 
> 标签：c++

假设我有一个依赖于两个单独输入的 while 循环。在情况一中，while 循环将采用值 1，而在情况二中，它应该采用 !cin.eof()。有没有办法可以有效地做到这一点？为了更简洁：

```
string hello;
cin >> hello;

if(hello == "one")
{
    //make the while loop depend on value 1
}
else if(hello == "two")
{
    //make the while loop depend on value !cin.eof()
}

while(/*depends on above conditional*/)
{} 
```

我不想做类似的事情：

```
if(hello == "one)
{
     while(1){}
}
else if(hello == "two")
{
     while(!cin.eof){}
} 
```

因为 while 循环在每种情况下基本上都做同样的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T21:15:36.320

为了可读性和[凝聚力](http://en.wikipedia.org/wiki/Cohesion_%28computer_science%29)，我认为您应该将循环的内容移动到一个单独的函数中：

```
void DoSomething() { /* ... */ }

// ...
if(hello == "one)
{
    while(1){ DoSomething(); }
}
else if(hello == "two")
{
    while(!cin.eof){ DoSomething(); }
} 
```

更容易看出不同的`while`循环在做同样的事情，但它们的条件不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T20:38:51.457

只需使用 or ( `||`) 作为 while 循环中的条件。设置第一个条件`if(hello == "one")`。现在你有一个 while 循环，如果其中一个条件是`true`.

```
bool value = hello == "one";
while (value || !cin.eof) {} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-27T20:38:57.520

我相信你正在寻找这样的东西：

```
while((hello == "one") || (hello == "two" && !cin.eof)) {
} 
```

这段代码会做你想做的，因为它检查'是变量“一”吗？如果是这样，请继续执行。如果不是，它会检查：变量是“二”吗？如果是这样，它将检查`cin.eof`.

如果两者都不是，则循环不会执行。（`&& 1`省略第一个条件，因为它总是“真”，等于和无限循环）

编辑：

为了简化事情，您可能需要考虑此代码（如评论中所建议）：

```
bool HelloIsOne = (strcmp(hello, "one") == 0);
bool HelloIsTwo = (strcmp(hello, "two") == 0);

while(HelloIsOne || HelloIsTwo && !cin.eof) {
} 
```

我在上一个示例中放置的括号实际上是不必要的，因为`&&`绑定比 强`||`，但它们有助于代码的总体清晰度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T21:10:10.237

如果您使用的是 C++11：

```
#include <functional>

auto check = (hello == "one") ? []() bool -> { return 1; } :
                                []() bool -> { return !cin.eof(); };
while(check) {
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T22:44:52.873

这个怎么样：

```
 switch(hello)
    {
        case 'one':
        {
            for(; 1; );
            {
            // your loop here
            }
            break;
        }
        case 'two':
        {
            for(;!cin.eof; )
            {
            // your other loop here
            }
            break;
        }
        default:
        {
            cout << " shouldnt get here unless bad user input" << endl;
            break;
        }
    } 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-03-27T20:42:08.303

你可以这样做：

```
#include <iostream>
#include <string>

using namespace std;
int main()
{
    string hello;
    cin >> hello;
    while(hello=="one"?1:(!cin.eof()))
    {
        //do stuff
    }
    return 0;
} 
```

它检查字符串`hello`是否为“one”，如果为真，`while`则为 is的条件`1`，否则`!cin.eof()`为您想要的。

# datagridview - DataGridViewCellStyle 以千为单位显示数值数据

> ID：15668897
> 
> 赞同：2
> 
> 时间：2013-03-27T20:35:33.817
> 
> 标签：datagridview, formatting, datagridviewcellstyle

我只是想知道是否有一种方法可以在 DataGridViewCellStyle 中创建自定义格式以显示数千个数据。

在 Excel 中有一种自定义格式，您可以在其中在单元格中键入 1000，但它显示为 1。我尝试搜索这些板，但我所有的搜索都返回如何插入数千个分隔符，我已经知道该怎么做。

我目前的解决方法是在加载 DGV 之前将数据除以 1000，然后将返回的用户输入乘以 1000，但必须有更好的方法。我正在处理一些非常大的数字（以智利比索计算，不少于），所以我无法显示真实数字。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T12:43:40.283

使用格式字符串“0”

[来自 MSDN](http://msdn.microsoft.com/en-US/library/0c899ak8%28v=vs.80%29.aspx)：

> 数字缩放说明符：如果在显式或隐式小数点左侧立即指定一个或多个“，”字符，则每次出现数字缩放说明符时，要格式化的数字除以 1000

在 RichTextBox 中，这种格式对我有用：

```
richTextBox.Text = String.Format("{0:0,}", 24000);//Show as 24 
```

在 DataGridView 中，可以在设计器或代码中使用相同的格式：

```
//Number format "0,.###" will show number 12230 as 12.23

this.datagridview.Columns[this.dgvYuorColumn.Name].DefaultCellStyle.Format = "0,.###"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-25T07:35:23.907

这对我有用

```
this.datagridview.Columns[this.dgvYuorColumn.Name].DefaultCellStyle.Format = "#,#"; 
```

# web-services - 目录远程 API

> ID：15668898
> 
> 赞同：0
> 
> 时间：2013-03-27T20:35:42.567
> 
> 标签：web-services, dotnetnuke

我正在尝试使用远程 API 从 Catalook 中提取订单。这是我的代码：

```
 CATALooKRemote.RemoteController remote = new CATALooKRemote.RemoteController();
    remote.Url = "http://localhost/Customers/DotNetNuke_Community_06.02.04_Install/DesktopModules/CATALooKStore/remote.asmx";
    bool log = remote.Login(0, "host", "dnnhost");
    Response.Write(log);
    var orders = remote.GetOrders(new DateTime(2009, 1, 1), new DateTime(2014, 1, 1), -1);
    foreach (var a in orders)
    {

    }

    //throws null reference exception
    Response.Write(orders.Count()); 
```

我的系统中只有一个订单，但是我无法使用这种方法查询它。订单已付款状态。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:03:04.637

我从未使用过 CATALookRemote 服务，但查看 WSDL，您不需要传递用户名、密码和门户 ID 吗？

```
SRVRemote.RemoteControllerSoapClient remote = new SRVRemote.RemoteControllerSoapClient();
List<SRVRemote.OrderDetailsRemote> oOrders = null;
oOrders = remote.GetOrders(System.DateTime.FromOADate(0), System.DateTime.Today, -1, 0, "MyUsername", "MyPassword");
foreach (SRVRemote.OrderDetailsRemote order in oOrders) {
    //Do something
} 
```

# caching - Sencha Touch 2：应用程序在 iPhone 上缓存多长时间？

> ID：15668901
> 
> 赞同：1
> 
> 时间：2013-03-27T20:35:48.580
> 
> 标签：caching, sencha-touch-2.1

我在我的主屏幕上添加了一个 Sencha Touch 2 应用程序，然后在服务器上对其进行了更新；但只发送了 ajax 调用，我对 sencha touch 应用程序本身的更改不在我的设备上。

多久时间？我可以在某处设置持续时间吗？还是该应用程序再也没有下载过？但我无法想象在我更改某些内容后我总是必须重新安装应用程序......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T01:57:35.753

这取决于您如何加载应用程序，您可以通过打开或关闭缓存来加载它（使用加载程序设置）

您也可以使用 CACHE MANIFEST 文件无限期地缓存应用程序。

# c++ - LNK2005 函数指针数组“已在 .obj 中定义”

> ID：15668913
> 
> 赞同：0
> 
> 时间：2013-03-27T20:36:22.447
> 
> 标签：c++, visual-studio, linker-errors, lnk2005

好的，对该问题进行一些介绍：我正在使用在**Windows 7** - 64 位操作系统上运行的**Visual Studio 2012中的****C++/DirectX11**中的 C++/DirectX11 中的渲染引擎（以 32 位模式编译），并且出现了一个奇怪的链接错误我的班级（*Entity3D*就像场景的基本演员）。 我所有的包围体类都继承自一个*Shape3D*类。每个实体都有一个*Shape3D* * boundingVolume 成员，它在初始化时被初始化为特定的形状类型。*当两个Shape3D* 之间发生碰撞时，我通过一个函数传递它们 -然后该函数检查它们的类型（*球体*****`Entity` *****`bool Intersect(Shape3D* a, Shape3D* b)`**/*Box*/Whatever) 类型表示一个数字，它是函数指针数组中函数的索引：*********

 *******```
bool(*IntersectArray[4][4])(Shape3D* a, Shape3D* b) = 
{
    {
        IntersectSphereSphere,
        IntersectSphereBox,
        IntersectSphereOrientedBox,
        IntersectSphereFrustum,
    },
    {
        IntersectBoxSphere,
        IntersectBoxBox,
        IntersectBoxOrientedBox,
        IntersectBoxFrustum
    },
    {
        IntersectOrientedBoxSphere,
        IntersectOrientedBoxBox,
        IntersectOrientedBoxOrientedBox,
        IntersectOrientedBoxFrustum
    },
    {
        IntersectFrustumSphere,
        IntersectFrustumBox,
        IntersectFrustumOrientedBox,
        IntersectFrustumFrustum
    }
}; 
```

所以它就像一个虚拟调度。好的，这`InersectArray`是函数的数组（在 Intersect.h 中声明），这就是给我链接错误的原因：

```
error LNK1169: one or more multiply defined symbols found
error LNK2005: "char (__cdecl*(* Engine::Collision::IntersectArray)[4])(class Engine::Collision::Shape3D *,class Engine::Collision::Shape3D *)" (?IntersectArray@Collision@Engine@@3PAY03P6ADPAVShape3D@12@0@ZA) already defined in Entity3D.obj
File Intersect.obj 
```

*Intersect.h*仅包含在*Entity3D.cpp*中，不包含在*Entity3D.h*中，也不包含在 Entity3D.h 包含的任何标*头***中**。*Entity3D.cpp*仅包括*Entity3D.h*和*Intersect.h*。我清理并重建，错误仍然存​​在。*Intersect(Shape3D* a, Shape3D* b)* 仅在*Entity3D.cpp*文件中的*Entity3D的一种方法中调用。*项目中当前没有其他编译错误或警告。还有什么可能导致这样的问题？

 **** * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:00:50.827

修复了这个问题，我只是在*Intersect.cpp文件中移动了**IntersectArray*的定义，因为现在这是唯一需要它的地方。**********

# php - 使用 Zend Paginator 将分页应用于搜索结果

> ID：15668914
> 
> 赞同：1
> 
> 时间：2013-03-27T20:36:26.413
> 
> 标签：php, sql, zend-framework, pagination, zend-paginator

我已经搜索了类似的问题，但无济于事，所以希望有人可以提供帮助。

我在使用 Zend Framework (1.12) 构建的网站上对搜索结果进行分页时遇到问题。我可以检索项目并且分页已形成，但是当我单击转到下一页分页时，所有搜索结果都丢失了。该代码将 ?page=2 等附加到 URL，但该代码随后会丢失搜索项。

我读了一个关于可能使用会话或 Zend_Session 的问题，但我现在有点迷茫！PHP 相对较新。

首先这是我的搜索表单 - search-form.php (XHTML)

```
<?php
// Search Form
?>
<div id="search">
    <h4 style="margin-bottom:20px;">Search</h4>
    <form name="prodSearch" action="listing-search.php" method="post">
        <input type="text" name="searchitems" id="searchitems" />
        <input type="submit" name="search_items" id="search_items" value="Go" />
    </form>
</div> 
```

这包含在我的其他页面中。然后listing-search.php如下

```
<?php 
require_once('admin/scripts/library.php');
require_once('admin/scripts/db_definitions.php');
try {
?>
<!-- HTML Doc Type, Head removed e.t.c -->
<div id="listing-col-main">
<div id="all-cars">
  <h4>Search Results</h4>
</div>
<!-- Listings -->
<?php
    $query = $_POST['searchitems'];
    $min_length = 3;
    if (strlen($query) >= $min_length) {
        $query = htmlspecialchars($query);
        $query = mysql_real_escape_string($query);
        $raw = searchItems($dbread, $query);  
        $paginator = Zend_Paginator::factory($raw);
            if (isset($_GET['page'])) {
                $paginator->setCurrentPageNumber($_GET['page']);
            }
            $paginator->setItemCountPerPage(8);
            $paginator->setPageRange(3); 
            $count = $paginator->getTotalItemCount();
            if ($count > 0) {         
              foreach ($paginator as $results) { // repeat all results ?>
<?php 
              $item_id = $results['item_id'];
              $photos = getRelatedPhotos2($dbread, $item_id);
              ?>
<div class="product-listing">
  <div class="product-listing-image">
    <?php foreach ($photos as $photo) { //repeat ?>
    <img src="image_upload/<?php echo $photo['filename']; ?>" width="75" alt="" />
    <?php } ?>
  </div>
  <div class="product-listing-title">
    <h4><?php echo $results['type_name']; ?> - <?php echo $results['item_make'] . ' ' . $results['item_model']; ?> </h4>
  </div>
  <div class="product-listing-details">
    <p>YEAR: <?php echo $results['item_year']; ?> FUEL: <?php echo $results['item_fuel']; ?> TRANS: <?php echo $results['item_transmission']; ?> MILEAGE: <?php echo $results['item_mileage']; ?> </p>
  </div>
  <div class="product-listing-viewmore"><a href="itempage.php?item_id=<?php echo $results['item_id']; ?>">More Info</a></div>
</div>
<?php } ?>
<!-- 8 products per page -->
<div id="product-listing-pagination">
  <?php
  $pages = $paginator->getPages('Elastic');
  if (isset($pages->previous)) {
echo '<a href="' . $_SERVER['PHP_SELF'] . '?page=' . $pages->previous . '">Prev</a>';
  }
  foreach ($pages->pagesInRange as $page) {
if ($page != $pages->current) {
    echo " <a href='" . $_SERVER['PHP_SELF'] . "?page={$page}'>$page</a>";
}   else {
    echo ' ' . $page;
}
   }
   if (isset($pages->next)) {
echo ' <a href="' . $_SERVER['PHP_SELF'] . '?page=' . $pages->next . '">Next</a>';
   }

  ?>
</div>
<?php } else { ?>
<div id="noresults"> <?php echo "No results found for " . $query; ?> </div>
<?php }
    } ?>
</div>
<div id="col-right">
<?php include("search-usedcars.php"); ?>
<!-- End of Main Search -->
<div id="latest-news">
  <h3>Latest News</h3>
  <?php include("latestnews.php"); ?>
</div>
 </div>
 <div class="clear"></div>
 <div id="footer-bar"> <a href="#">Designed by</a> </div>
 </div>
 </body>
</html>
<?php 
} catch (Exception $e) {
echo $e->getMessage();
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:04:55.490

这是因为您的查询是在 $_POST 中传递的，当您单击导航链接时，您会丢失存储在 $_POST 中的数据，而只保留 $_GET 中的数据。将您的搜索表单方法更改为 $_GET 并添加`&searchitems="'.$query.'"`到您的导航链接中，或者将查询存储在 $_SESSION 中，或者您可以将导航链接更改为包含在表单中的按钮，使用方法 post 并包含 和 的隐藏`searchitems`字段`page`。我建议更改搜索表单方法以获得，因为它允许搜索书签并避免复杂性。

# jquery - 为什么“this”选择器不调用所选元素？

> ID：15668916
> 
> 赞同：0
> 
> 时间：2013-03-27T20:36:32.983
> 
> 标签：jquery, this

显然我不完全理解“this”选择器，因为它根本没有按预期工作。

在下面的 html/css 中，我有三个相同的 div 元素，每个元素都包含一个相同的段落。

第一个 div，我给出了一个 'x' 类，显示了我期望 div.y 出现的方式。第二个 div，我给出的 'y' 类是我最初编写代码的方式。第三个 div 不受 jQuery 影响，只是用来显示 div 在 jQuery 之前的样式。

我遇到的问题是我预计因为表达式针对特定元素中的所有段落，“this”选择器将选择这些段落而不是父函数中的目标元素。

有人可以向我解释为什么 y 类的 jQuery 有效而 x 类的 jQuery 没有吗？

编辑：我不是在问如何获得特定的结果。我在问为什么我会得到我的结果。我想更好地理解“这个”是如何工作的。

html:

```
<div class='x'><p>Lorem</p></div>
<div class='y'><p>Lorem</p></div>
<div><p>Lorem</p></div> 
```

CSS：

```
div {
    background-color:#658923;
    height:75px;
    width:75px;
    margin:10px;
    overflow:hidden;
}
p {
    width:50px;
}
.a {
    background-color:#ff5555;
} 
```

jQuery：

```
$(document).ready(function() {
    $('div.x').each(function() {
        $('p',this).each(function(){
            $(this).addClass('a').css({
            'height':$(this).outerWidth()
            });
        });
    });
    $('div.y').each(function() {
        $('p',this).addClass('a').css({
            'height':$(this).outerWidth()
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:48:22.353

我将浏览您的代码以及整个代码中`/*comment*/`所指`this`的内容。

```
$(document).ready(function() {
    // this == document
    $('div.x').each(function() {
        // this == <div class="x">
        $('p',this).each(function(){
            // this == <p>
            $(this).addClass('a').css({
                'height':$(this).outerWidth() // this == <p> **
            });
        });
    });
    $('div.y').each(function() {
        // this == <div class="y">
        $('p',this).addClass('a').css({
            'height':$(this).outerWidth() // this == <div class="y"> **
        });
    });
}); 
```

因此，在第一种情况下，您将获得 的`outerWidth`，`p`而在第二种情况下，您将获得`outerWidth`的`div`。这就是为什么一个人的行为与另一个人不同的原因。修复它取决于你的目标是什么，给定的代码并不那么明显。

# javascript - 在 JavaScript 中异步加载配置，如何最好地等待响应？

> ID：15668918
> 
> 赞同：0
> 
> 时间：2013-03-27T20:36:41.480
> 
> 标签：javascript

这就是我想要做的：

*   从远程服务器脚本请求 JSON 对象
*   等待，直到 JavaScript 获取所有响应数据
*   从响应对象打印一个值

如果值未定义，我正在尝试在 get config 函数中使用 setTimeout 在 1 秒后调用自身，当它不再未定义时，对值执行某些操作。

或者，我似乎可以创建一些循环数秒的方法，但如果有更好的方法来完成我想要做的事情，我想避免这种情况？我当前的代码似乎没有任何延迟地递归，这会破坏我的运行时间

感谢您的任何想法，代码如下：

```
function runApplication() {
    var initialiser = new Initialiser();
    var config = new Config();
    initialiser.fetchConfigurations(config);
    config.alertValue('setting1');
}

function Initialiser() {
    debug.log("Started");
}

Initialiser.prototype.fetchConfigurations = function(config) {
    var req = new XMLHttpRequest();
    var url = CONFIGURATION_SERVER_URL;
    req.onreadystatechange = function() {
        if (req.readyState == 4 && req.status == 200) {
            var configObject = eval('(' + req.responseText + ')');
            config.setConfig(configObject);
        } else {
            debug.log("Downloading config data...please wait...");
        }
    }
    req.open("GET", url, true);
    req.send(null);
}
function Config() {
    this.config
}

Config.prototype.setConfig = function(configObject) {
    this.config = configObject;
}

Config.prototype.getValue = function(setting) {
    if(this.config === undefined) {
        setTimeout(this.getValue(setting), 1000);   
    } else {
        return this.config[setting];
    }
}

Config.prototype.alertValue = function(setting) {
    if(this.config === undefined) {
        setTimeout(this.alertValue(setting), 1000); 
    } else {
        alert(this.config[setting]);
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:55:51.243

从我所看到的来看，您应该只添加一个额外的步骤来`.setConfig`处理下一部分。

```
Config.prototype.setConfig = function (data) {
    this.config = data;
    this.doSomethingAfterTheDataExists();
}; 
```

有很多方法可以做到这一点...
...编写版主/观察者/发布订阅实现非常简单，并且可以在相对较少的行中完成，以获得给定的好处...

编写一个 Promise 系统会更强大，但需要更多的工作（因为它就像上面的实现一样，增加了抽象层，为异步创建一个非常干净和直接的接口）。

`.setConfig`发布消息或触发另一个方法的另一种选择是在 AJAX 调用之后调用另一个方法`.setConfig`。

```
xhr.onreadystatechange = function () {
    // .......
    config.setConfig(/* ... */);
    config.doSomethingAfterTheDataExists();
}; 
```

如果您要进行多个 AJAX 调用，对多个属性进行多次分配，并且您想等到每个调用都完成，那么您真的应该考虑实现一个 Promise 系统。
它将节省您的理智，并且非常值得您可以缩小到遗忘的约 60-100 行。

如果您只是在等待那个响应返回，那么请记住，在`onreadystatechange`表示它已完成并且数据在那里（您的成功检查）之后会发生什么是同步的。
等待是异步部分。
一旦交付，一切（包括支票内的东西）都会回到程序上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:43:27.857

只需使用**带有成功/完成**回调的[jQuery](http://jquery.com/download/)和[getJSON 。](http://api.jquery.com/jQuery.getJSON/)

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:53:13.200

您可以对 XMLHttpRequest 使用同步调用而不是异步调用。但是，如果您的用户需要在您等待响应时与网页交互，这可能不是*最佳选择。*

```
...
req.open("GET", url, false);
request.send(null); 
```**

# python - 如何在 python 谷歌应用引擎中为 webapp 使用 setuptools 实现 WSGIProxy

> ID：15668923
> 
> 赞同：0
> 
> 时间：2013-03-27T20:36:58.823
> 
> 标签：python, google-app-engine, setuptools, django-wsgi

有人可以解释一下如何在谷歌应用引擎中使用 python 中的[setuptools](https://developers.google.com/appengine/docs/python/tools/libraries27)来为 webapp实现[WSGIProxy 。](http://pythonpaste.org/wsgiproxy/)

如果我无法访问文件系统，我该如何使用它？具体来说，关于如何在 GAE 上从 python egg 安装包的简单步骤。

对于使用过 setuptools 或在 GAE python 上安装了 3rd 方包的人来说，这应该相对容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:32:57.773

我刚刚回答了几乎相同的问题，但是关于不同的图书馆。安装第三方库背后的概念是完全相同的，您需要将实际代码的副本放在您的应用程序文件夹中，或者使用软链接进入。

[GAE - 包括外部 python 模块而不将它们添加到存储库？](https://stackoverflow.com/questions/15651891/gae-including-external-python-modules-without-adding-them-to-the-repository/15653005#15653005)

# sql - SQL Server 土耳其语字符情况

> ID：15668924
> 
> 赞同：5
> 
> 时间：2013-03-27T20:37:05.830
> 
> 标签：sql, sql-server, collate, sql-server-collation

我在 ASP.NET 和 SQL Server 中遇到了土耳其语字符问题。我在 asp.net 中有搜索框并尝试在数据库中进行搜索。但是，我在使用土耳其语字符时遇到问题。当我搜索包含非法“İ”字符的“GALVANİZ”时。我敢肯定，“GALVANİZ”一词在数据库中。

当我在 SQL Server 工具中执行一个简单的选择语句时，它也不会返回任何内容。

这是SQL

```
select * from Product where name like '%GALVANİZ%' 
```

这不会返回任何东西。我怎样才能修复它？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-27T20:46:32.107

您可以在查询中指定排序规则，例如`Turkish_CI_AI`，或者在字符串中使用“N”字符来指示它们是 Unicode，如下所示：

```
select * from Product where name like N'%GALVANİZ%' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-27T21:17:38.110

我自己也解决了这个问题。这是解决方案

```
select * from product where name like N'%GALVANi%' collate Turkish_CI_AS 
```

这是一个更好的解决方案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-11T14:51:17.180

sudo systemctl stop mssql-server sudo /opt/mssql/bin/mssql-conf set-collat​​ion 输入排序规则：Turkish_CI_AS sudo systemctl start mssql-server

# mysql - 这是一个低效的查询吗？

> ID：15668926
> 
> 赞同：4
> 
> 时间：2013-03-27T20:37:11.083
> 
> 标签：mysql

假设 table1 和 table2 都有大量的行（即几十万），下面的查询是不是效率低下？

编辑：添加了按字段排序。

```
SELECT * FROM (
  SELECT title, updated FROM table1
  UNION
  SELECT title, updated FROM table2
) AS query
ORDER BY updated DESC
LIMIT 25 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:39:55.187

这应该更快 - 但是我看不到 ORDER BY 那么你真正想要什么 25 条记录？

```
SELECT * FROM (
  SELECT title FROM table1 LIMIT 25
  UNION
  SELECT title FROM table2 LIMIT 25
) AS query
LIMIT 25 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T20:48:12.460

如果您绝对需要不同的结果，另一种可能性是使用`union all`and`group by`子句：

```
SELECT title FROM (
  SELECT title FROM table1 group by title
  UNION ALL
  SELECT title FROM table2 group by title
) AS query
group by title
LIMIT 25; 
```

在测试数据库 (at) 中的两个表中的索引 ID 列上不使用该`limit`子句进行测试，每个表都有约 920K 行，`$work`导致上面的查询超过一秒，通过 a 大约 17 秒`union`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:38:42.873

`UNION`必须进行额外的传递才能获取`distinct`记录，因此您应该使用`UNION ALL`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T20:49:50.150

是的，在内部查询中使用 order by 和 limits。

```
SELECT * FROM (
  (SELECT title FROM table1 ORDER BY title ASC LIMIT C)
  UNION
  (SELECT title FROM table2 ORDER BY title ASC LIMIT C)
) AS query
LIMIT 25 
```

这只会通过 C 行而不是 N（数十万行）。ORDER BY 是必需的，并且应该在索引列上。

C 是一个启发式常数，应根据域进行调整。如果你只期望有几个重复，C=50-100 可能没问题。

您也可以使用 EXPLAIN 自己找出答案。

# maven - EAR 的 Grails maven 包装

> ID：15668929
> 
> 赞同：2
> 
> 时间：2013-03-27T20:37:22.823
> 
> 标签：maven, grails, grails-2.0

在 Grails 2.2.x 之前，我已经能够使用 Maven 创建 grails 项目并将它们包含在 Maven Ear 项目中，并且一切正常。**Grails 2.2.x 中的新 pom.xml 已将打包类型更改为“grails-app”**，这导致了一些新问题。旧的包装类型是“战争”，效果很好。

***有没有人遇到同样的问题？有解决方法吗？***

这是我项目的结构。

```
TestProject 
 |-pom.xml 
 |-TestEar 
 |  \pom.xml 
 |-TestGrailsApp 
    \pom.xml 
```

**测试项目 pom.xml**

* * *

```
<project xmlns="http://maven.apache.org/POM/4.0.0"; xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"; 
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0http://maven.apache.org/xsd/maven-4.0.0.xsd";> 
  <modelVersion>4.0.0</modelVersion> 
  <groupId>test</groupId> 
  <artifactId>testProject</artifactId> 
  <version>0.1-SNAPSHOT</version> 
  <packaging>pom</packaging> 
  <name>Test Project</name> 
    <modules> 
        <module>TestGrailsApp</module> 
        <module>TestEar</module> 
    </modules> 
</project> 
```

**TestGrailsApp pom.xml**

* * *

4.0.0 测试 testGrailsApp grails-app 0.1-SNAPSHOT 测试 Grails 应用

```
<parent> 
  <groupId>test</groupId> 
  <artifactId>testProject</artifactId> 
  <version>0.1-SNAPSHOT</version> 
</parent> 

<properties> 
    <grails.version>2.2.1</grails.version> 
</properties> 
```

...

**TestEar pom.xml**

* * *

```
<?xml version="1.0" encoding="UTF-8"?> 
<project xmlns="http://maven.apache.org/POM/4.0.0"; xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"; 
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0http://maven.apache.org/xsd/maven-4.0.0.xsd";> 
    <modelVersion>4.0.0</modelVersion> 
    <artifactId>testEar</artifactId> 
    <packaging>ear</packaging> 
    <name>Test Ear</name> 
    <parent> 
        <groupId>test</groupId> 
        <artifactId>testProject</artifactId> 
        <version>0.1-SNAPSHOT</version> 
    </parent> 
    <build> 
        <plugins> 
            <plugin> 
                <artifactId>maven-ear-plugin</artifactId> 
                <configuration> 
                    <archive> 
                        <manifest> 
                            <addClasspath>true</addClasspath> 
                        </manifest> 
                    </archive> 
                    <modules> 
                        <webModule> 
                            <groupId>test</groupId> 
                            <artifactId>testGrailsApp</artifactId> 
                            <contextRoot>/web</contextRoot> 
                        </webModule> 
                    </modules> 
                </configuration> 
            </plugin> 
        </plugins> 
    </build> 
    <dependencies> 
        <dependency> 
            <groupId>test</groupId> 
            <artifactId>testGrailsApp</artifactId> 
            <type>grails-app</type> 
            <version>0.1-SNAPSHOT</version> 
        </dependency> 
    </dependencies> 
</project> 
```

这是尝试构建项目的结果

```
$ mvn install -e 
```

*错误堆栈跟踪已打开。*

```
[INFO] Scanning for projects... 
[INFO] Reactor build order: 
[INFO]   TestProject 
[INFO]   TestGrailsApp 
[INFO]   TestEar 
[INFO] ------------------------------------------------------------------------ 
[INFO] Building TestProject 
[INFO]    task-segment: [install] 
[INFO] ------------------------------------------------------------------------ 
[INFO] [timestamp:create {execution: default}] 
[INFO] [site:attach-descriptor {execution: default-attach-descriptor}] 
[INFO] [install:install {execution: default-install}] 
[INFO] Installing /local2/testProject/pom.xml to /usr2/User1/.m2/repository/test/TestProject/0.1-SNAPSHOT/testProject-0.1-SNAPSHOT.pom 
[INFO] ------------------------------------------------------------------------ 
[INFO] Building TestGrailsApp 
[INFO]    task-segment: [install] 
[INFO] ------------------------------------------------------------------------ 
[INFO] [grails:validate {execution: default-validate}] 
[INFO] [timestamp:create {execution: default}] 
[INFO] [grails:init {execution: default-init}] 
[INFO] [grails:config-directories {execution: default-config-directories}] 
[INFO] [grails:maven-compile {execution: default-maven-compile}] 

|Loading Grails 2.2.1 
|Downloading: testGrailsApp-0.1-SNAPSHOT.pom 
|Configuring classpath 
|Running pre-compiled script 
. 
|Environment set to development 
........... 
[INFO] [grails:maven-test {execution: default-maven-test}] 

|Loading Grails 2.2.1 
|Configuring classpath 
|Running pre-compiled script 
. 
|Environment set to test 
.................... 
|Running 4 unit tests... 

|Running 4 unit tests... 1 of 4 

|Running 4 unit tests... 2 of 4 

|Running 4 unit tests... 3 of 4 

|Running 4 unit tests... 4 of 4 
|Completed 4 unit tests, 0 failed in 1787ms 
. 
|Tests PASSED - view reports in /local2/testProject/testGrailsApp/target/test-reports 
[INFO] [grails:maven-grails-app-war {execution: default-maven-grails-app-war}] 

|Loading Grails 2.2.1 
|Configuring classpath 
|Running pre-compiled script 
. 
|Environment set to prod 
................................. 
|Packaging Grails application 
................ 
|Compiling 3 GSP files for package [testGrailsApp] 
... 
|Building WAR file 
...................................... 
|Done creating WAR target/testGrailsApp-0.1-SNAPSHOT.war 
[INFO] [grails:maven-functional-test {execution: default-maven-functional-test}] 

|Loading Grails 2.2.1 
|Configuring classpath 
|Running pre-compiled script 
. 
|Environment set to test 
.................... 
|Running 4 unit tests... 

|Running 4 unit tests... 1 of 4 

|Running 4 unit tests... 2 of 4 

|Running 4 unit tests... 3 of 4 

|Running 4 unit tests... 4 of 4 
|Completed 4 unit tests, 0 failed in 1747ms 
............................ 
|Packaging Grails application 
........................... 
|Tests PASSED - view reports in /local2/testProject/testGrailsApp//target/test-reports 
[INFO] [install:install {execution: default-install}] 
[INFO] Installing /local2/testProject/testGrailsApp/target/testGrailsApp-0.1-SNAPSHOT.war to /usr2/User1/.m2/repository/testProject/testGrailsApp/0.1-SNAPSHOT/testGrailsApp-0.1-SNAPSHOT.war 
[INFO] ------------------------------------------------------------------------ 
[INFO] Building TestEar 
[INFO]    task-segment: [install] 
[INFO] ------------------------------------------------------------------------ 
[INFO] [ear:generate-application-xml {execution: default-generate-application-xml}] 
[INFO] ------------------------------------------------------------------------ 
[ERROR] BUILD FAILURE 
[INFO] ------------------------------------------------------------------------ 
[INFO] Artifact[war:testProject:testGrailsApp] is not a dependency of the project. 
[INFO] ------------------------------------------------------------------------ 
[INFO] Trace 
org.apache.maven.BuildFailureException: Artifact[war:testProject:testGrailsApp] is not a dependency of the project. 
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:715) 
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalWithLifecycle(DefaultLifecycleExecutor.java:556) 
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoal(DefaultLifecycleExecutor.java:535) 
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandleFailures(DefaultLifecycleExecutor.java:387) 
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments(DefaultLifecycleExecutor.java:348) 
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLifecycleExecutor.java:180) 
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:328) 
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:138) 
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:362) 
    at org.apache.maven.cli.compat.CompatibleMain.main(CompatibleMain.java:60) 
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 
    at java.lang.reflect.Method.invoke(Method.java:597) 
    at org.codehaus.classworlds.Launcher.launchEnhanced(Launcher.java:315) 
    at org.codehaus.classworlds.Launcher.launch(Launcher.java:255) 
    at org.codehaus.classworlds.Launcher.mainWithExitCode(Launcher.java:430) 
    at org.codehaus.classworlds.Launcher.main(Launcher.java:375) 
Caused by: org.apache.maven.plugin.MojoFailureException: Artifact[war:testProject:testGrailsApp] is not a dependency of the project. 
    at org.apache.maven.plugin.ear.AbstractEarModule.resolveArtifact(AbstractEarModule.java:114) 
    at org.apache.maven.plugin.ear.WebModule.resolveArtifact(WebModule.java:78) 
    at org.apache.maven.plugin.ear.AbstractEarMojo.execute(AbstractEarMojo.java:200) 
    at org.apache.maven.plugin.ear.GenerateApplicationXmlMojo.execute(GenerateApplicationXmlMojo.java:84) 
    at org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginManager.java:490) 
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:694) 
    ... 17 more 
[INFO] ------------------------------------------------------------------------ 
[INFO] Total time: 51 seconds 
[INFO] Finished at: Wed Mar 27 11:20:40 PDT 2013 
[INFO] Final Memory: 39M/315M 
[INFO] ------------------------------------------------------------------------ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T21:09:52.550

要完成这项工作，您可以将 grails 应用程序重新发布为战争工件。要在 Grails 应用程序 pom 中执行此操作，请添加以下内容。然后在您的 EAR pom 中引用新的战争工件。

```
<project>
    <modelVersion>4.0.0</modelVersion>
    <artifactId>testGrailsApp</artifactId>
    <packaging>grails-app</packaging>

    <parent>
        <artifactId>testProject</artifactId>
        <groupId>test</groupId>
        <version>0.1-SNAPSHOT</version>
    </parent>

    <properties>
        <grails.version>2.2.1</grails.version>
    </properties>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-install-plugin</artifactId>
                <executions>
                    <execution>
                        <id>create-war-pom</id>
                        <phase>install</phase>
                        <goals>
                            <goal>install-file</goal>
                        </goals>
                        <configuration>
                            <artifactId>${project.parent.artifactId}War</artifactId>
                            <groupId>${groupId}</groupId>
                            <version>${version}</version>
                            <file>${build.directory}/${artifactId}-${version}.war</file>
                            <generatePom>true</generatePom>
                            <packaging>war</packaging>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
</project> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T01:07:37.383

我认为您只需要两个简单的修改：

1.  TestGrailsApp pom.xml 添加app继承自父pom后的artifact信息

    ```
    <parent> 
       <groupId>test</groupId> 
       <artifactId>testProject</artifactId> 
       <version>0.1-SNAPSHOT</version> 
    </parent>

    <groupId>test</groupId>
    <artifactId>testGrailsApp</artifactId>
    <packaging>grails-app</packaging>
    <version>0.1</version>
    <name>testGrailsApp</name>
    <description>testGrailsApp</description>

    <properties>
       <grails.version>2.2.1</grails.version>
    </properties> 
    ```

2.  编辑 TestEar pom.xml 如下（将类型添加为 war 而不是 grails-app）

    ```
    <dependencies> 
        <dependency> 
            <groupId>test</groupId> 
            <artifactId>testGrailsApp</artifactId> 
            <version>0.1-SNAPSHOT</version>
            <type>war</type>            
        </dependency> 
    </dependencies> 
    ```

你完了。！！

注意：我执行了“grails create-pom test”来创建应用程序的 pom.xml

原因：TestProject(Parent) -- TestGrailsApp (Child) -- TestEar (Child)

Grails maven 插件在生命周期中隐式构建战争。一旦构建了war文件，您只需要通知ear pom来获取war并使用它来将其打包到ear中。Maven-ear-plugin 完成剩下的工作。

# matlab - 在matlab中添加“真实香农小波”进行连续小波变换

> ID：15668934
> 
> 赞同：0
> 
> 时间：2013-03-27T20:37:36.797
> 
> 标签：matlab, signal-processing, wavelet

我是 MATLAB 新手，我想在 MATLAB 中使用“Real Shannon wavelet”进行连续小波变换。在 MATLAB 中有什么方法可以将“Real Shannon Wavelet”添加到 wavemngr，这样我就可以使用函数“cwt”来简单地执行 CWT。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T12:27:31.140

[小波管理器文档](http://www.mathworks.de/de/help/wavelet/ug/adding-your-own-wavelets.html)中对此进行了描述。除此之外似乎已经有香农小波要实现：'shan'

# perl - 在 perl 中加入两个文件（表）

> ID：15668940
> 
> 赞同：-1
> 
> 时间：2013-03-27T20:37:53.820
> 
> 标签：perl, join

我想使用 perl 将两个文件合二为一。进一步来说：

我有一个包含列的 txt 文件：

```
Irrelevant / Key / Various1 / ... / Various N 
```

和第二个带有列的*txt*文件：

```
Key / Price 
```

我想*阅读*这两个文件并加入它们，以便我拥有：

```
Key / Various1 / ... / Various N / Price 
```

对于第一个表的所有行。我该怎么做？我的经验很少。

我需要一个表（*哈希*？），然后我可以在我的脚本中进一步处理，或者一个新文件，然后我可以读取并执行其余的过程。

任何帮助将不胜感激。

* * *

谢谢你的讽刺......我已经说过我没有经验，我不知道ahshes是如何工作的，这似乎是解决方案......我找到了这段代码并尝试使用它，但它不起作用：

我像这样加载第一个文件： $list{$file}{$system}{$master_file_name}{$symbol}=$price;

第二个：$map{$file} = $charge;

我加入他们：%combined = (%map, %list);

```
foreach my $system (keys(%combined))
{
my $n=0;
my $i=0;
      my $workbook = Spreadsheet::WriteExcel->new("system.xls");
my $worksheet   = $workbook->add_worksheet("summary_unmapped_master_file");
map{$worksheet->write($n, $i++,$_)}   ("list", "charge", "System", "MAster_file", "symbol", "price");
$n++;$i=0;
foreach my $value (sort{$combined{$system}{$b} <=> $combined{$system}{$a}} keys %{$combined{$system}})
{   
    map{$worksheet->write($n, $i++,$_)} ($value,$list{$system}{$value});
    $n++;$i=0;
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T21:08:08.160

我通常鼓励海报展示一些作品。您已经尝试过但有些东西不起作用，而不是要求我们为您完成您的工作，这是一种诚意的标志。所以我就不举例了。也就是说，我想向您指出[Tie::Array::CSV](http://metacpan.org/module/Tie%3a%3aArray%3a%3aCSV)。它可以使这成为一项更简单的任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T09:21:02.487

*   打开包含价格的文件
*   一次读取一行价格文件，并将数据放入 Key 上的散列中。
*   打开另一个文件
*   打开输出文件
*   对于另一个文件中的每一行
    *   在价格哈希中查找匹配的价格
    *   将价格附加到现有记录的末尾
    *   将新记录写入输出文件

# jquery - 无法将悬停与 jQuery Tag Cloud 一起使用

> ID：15668941
> 
> 赞同：0
> 
> 时间：2013-03-27T20:38:03.737
> 
> 标签：jquery, tag-cloud

当人们将鼠标悬停在标签云中的任何项目上时，我需要添加一个 onHover 事件，这是代码。我认为某处存在冲突。现在它根本不会触发。

```
<html>
    <head>
        <title>jQCloud Example</title>
        <link rel="stylesheet" type="text/css" href="../jqcloud/jqcloud.css" />
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.js"></script>
        <script type="text/javascript" src="../jqcloud/jqcloud-1.0.3.js"></script>
        <script type="text/javascript">
            var word_list = [
                {text: "Lorem", weight: 13, link: "https://github.com/DukeLeNoir/jQCloud"},
                {text: "Ipsum", weight: 10.5, html: {title: "My Title", "class": "custom-class"}, link: {href: "http://jquery.com/", target: "_blank"}},
                {text: "Dolor", weight: 9.4},
                {text: "Sit", weight: 8},
                {text: "Amet", weight: 6.2},
                {text: "Consectetur", weight: 5},
                {text: "Adipiscing", weight: 5},
                {text: "Elit", weight: 5},
                {text: "Nam et", weight: 5},
                {text: "Leo", weight: 4},
                {text: "Sapien", weight: 4},
                {text: "Pellentesque", weight: 3},
                {text: "habitant", weight: 3},
                {text: "morbi", weight: 3},
                {text: "tristisque", weight: 3},
                {text: "senectus", weight: 3},
                {text: "et netus", weight: 3},
                {text: "et malesuada", weight: 3},
                {text: "fames", weight: 2},
                {text: "ac turpis", weight: 2},
                {text: "egestas", weight: 2},
                {text: "Aenean", weight: 2},
                {text: "vestibulum", weight: 2},
                {text: "elit", weight: 2},
                {text: "sit amet", weight: 2},
                {text: "metus", weight: 2},
                {text: "adipiscing", weight: 2},
                {text: "ut ultrices", weight: 2},
                {text: "justo", weight: 1},
                {text: "dictum", weight: 1},
                {text: "Ut et leo", weight: 1},
                {text: "metus", weight: 1},
                {text: "at molestie", weight: 1},
                {text: "purus", weight: 1},
                {text: "Curabitur", weight: 1},
                {text: "diam", weight: 1},
                {text: "dui", weight: 1},
                {text: "ullamcorper", weight: 1},
                {text: "id vuluptate ut", weight: 1},
                {text: "mattis", weight: 1},
                {text: "et nulla", weight: 1},
                {text: "Sed", weight: 1}
            ];
            $(function() {
                $("#my_favorite_latin_words").jQCloud(word_list);
                $('span').hover(function() {
                    alert('a');
                });
            });
        </script>
    </head>
    <body>
        <h1>jQCloud Example</h1>
        <div id="my_favorite_latin_words" style="width: 550px; height: 350px; border: 1px solid #ccc;"></div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-03-07T19:51:08.633

`afterCloudRender`在 jqcloud 完成创建 wordcloud 后，使用 jqcloud运行 jquery

```
$('#example').jQCloud(words,{
    shape : 'rectangle',
    afterCloudRender : function(){
        $('span','#example').each(function(){
            alert($(this).text());
        });
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:41:04.443

**原因**

`hover`处理程序被绑定到`span`页面加载时尚不存在的元素。因此，处理程序不会绑定到动态添加的`span`元素。

**解决方案**

与其直接*绑定*处理函数，不如将其*委托*给 DOM 更高层的页面加载时存在的父元素。

例如：

```
$("#my_favorite_latin_words").on('mouseenter', 'span', function() {
    alert('a');
}); 
```

# c# - LINQ - 获取对象列表中某种类型的所有成员

> ID：15668945
> 
> 赞同：2
> 
> 时间：2013-03-27T20:38:19.423
> 
> 标签：c#, linq

我有一个班级持有 a`Color`和一个字符串：

```
 public class Magic{
   public string Name {get; set;}
   public Color MyColor {get; set;}
 } 
```

我有他们的清单：

```
List<Magic> MyList = new List<Magic>(); 
```

我对 LINQ 不太熟悉，我想知道如何将 in 中的所有`Color`对象`List`放入新`List`的`Color`s中

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-27T20:39:20.083

您将使用[Select](http://msdn.microsoft.com/en-CA/library/bb548891.aspx)方法：

```
List<Color> magicColors = MyList
    .Select(magic => magic.MyColor)
    .ToList(); 
```

如果您只想要*独特的*颜色：

```
List<Color> magicColors = MyList
    .Select(magic => magic.MyColor)
    .Distinct()
    .ToList(); 
```

这个想法是，对于每一个`Magic`，它都会拉出它的`MyColor`. 这就是它的`Select(magic => magic.MyColor)`作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T20:41:40.223

这个问题有点含糊，如果您正在寻找颜色的投影，那么@ChrisSinclair 的答案是正确的。

另一方面，如果您想按颜色过滤，那么您可以这样做：

```
var magicS = (from magic in MyList where magic.MyColor == s select magic).ToList(); 
```

或者

```
var magicS = MyList.Where(m => m.MyColor == s).ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-16T18:13:39.163

我使用了 .FindAll 方法。

```
var lst = GetAllProducts();

List<ProductModel> sel = lst.FindAll(x => x.IsActive == true);

return sel; 
```

我有一种方法可以将所有产品放入 List<>。我的产品模型有一个名为 IsActive（布尔值）的属性。

此代码创建一个仅包含 Active=True 产品的新 List<>。

# c# - .Net/C# 的 GPS 驱动程序，用于从任何支持 NMEA 的 GPS 单元中提取 GPS 数据

> ID：15668948
> 
> 赞同：2
> 
> 时间：2013-03-27T20:38:30.400
> 
> 标签：c#, .net, gps, serial-port, nmea

我有一个地图应用程序，我希望能够允许我的用户连接任何通过通信端口或 USB 端口输出 NMEA 数据的 GPS 单元。

由于 NMEA 是 GPS 单元必须遵守的标准，我假设可以编写一个通用驱动程序来连接到 GPS 单元并开始接受 NMEA 数据。在网络搜索之后，我很惊讶没有找到任何人在 C# 中为 .NET 做过这个。

我错过了什么吗？我是否缺少某种程度的复杂性？有人对如何使我的应用程序与各种 GPS 单元一起工作有建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T20:54:33.900

你并不真正想要一个驱动程序，你想要一个解析器。驱动程序是处理它（几乎总是）一个com端口的东西，并且是特定于设备的。解析器解释实际的 NMEA 格式数据。看看这个解析器项目

[http://code.google.com/p/nmeasharp/wiki/NmeaSharpMain](http://code.google.com/p/nmeasharp/wiki/NmeaSharpMain)

缺少结果可能更多的是缺乏难度的问题，它是一种非常容易解析的格式。

当然你也可以使用 windows 7+ Sensor and Location API

[http://www.codeguru.com/csharp/.net/article.php/c16973/Using-the-Windows-7-Sensor-and-Location-Platform-from-C.htm](http://www.codeguru.com/csharp/.net/article.php/c16973/Using-the-Windows-7-Sensor-and-Location-Platform-from-C.htm)

如果您可以选择，我会使用 Location API，但这只是我个人的情况，它对任何 GPS 的支持都不是很好。如果您愿意，可以使用适配器将任何标准 NMEA gps 转换为 Windows 7 支持的

[http://www.turboirc.com/gps7/](http://www.turboirc.com/gps7/)

尽管如果您计划用于商业用途，这可能会带来问题（尽管编写替代品并不难）。

# python - 以下字符串的简单正则表达式

> ID：15668955
> 
> 赞同：0
> 
> 时间：2013-03-27T20:38:46.423
> 
> 标签：python

我有一个看起来像的字符串

```
rand_id%3A%3Ftmsid%3D1340496000_EP002960010145_11_0_10050_1_2_10036 
```

现在，我想做的是

```
extract timestamp: 134049600
        event: EP002960010145 
```

现在的问题是在 tmsid 之后有 %3D 我什至不知道它是什么.. 但无论如何，有时它的 %3D %6D 我认为它甚至可以是 %16D ??? 我不能确定

是否有一种可靠的方法来处理上述字符串中的这两个字段？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T20:43:17.700

您正在查看 URL 引用的数据：

```
>>> from urllib2 import unquote
>>> unquote('rand_id%3A%3Ftmsid%3D1340496000_EP002960010145_11_0_10050_1_2_10036')
'rand_id:?tmsid=1340496000_EP002960010145_11_0_10050_1_2_10036' 
```

您可以先拆分`=`，然后拆分`_`：

```
>>> unquoted = unquote('rand_id%3A%3Ftmsid%3D1340496000_EP002960010145_11_0_10050_1_2_10036')
>>> unquoted.split('=', 1)[1].split('_')
['1340496000', 'EP002960010145', '11', '0', '10050', '1', '2', '10036']
>>> timestamp, event = unquoted.split('=', 1)[1].split('_')[:2]
>>> timestamp, event
('1340496000', 'EP002960010145') 
```

相反，如果数据有多个字段并且您`&`也在那里找到了一个，您也许可以更好地将问号之后的所有内容解析为 URL 查询字符串，而不是使用[`urlparse.parse_qs()`](http://docs.python.org/2/library/urlparse.html#urlparse.parse_qs)

```
>>> from urlparse import parse_qs
>>> parse_qs(unquoted.split('?', 1)[1])
{'tmsid': ['1340496000_EP002960010145_11_0_10050_1_2_10036']}
>>> parsed = parse_qs(unquoted.split('?', 1)[1])
>>> timestamp, event = parsed['tmsid'][0].split('_', 2)[:2]
>>> timestamp, event
('1340496000', 'EP002960010145') 
```

# c# - C# 运行外部批处理和 java 文件

> ID：15668959
> 
> 赞同：0
> 
> 时间：2013-03-27T20:38:56.090
> 
> 标签：c#, .net, pos-tagger

我正在使用 Stanford POS-tagger 应用程序在大约 300 个文件中标记一些文章。为此，我编写了一个 C# 代码，它将遍历文件并使用标记器。

我的代码如下所示：

```
Process thisProcess=new Process();
thisProcess.StartInfo.CreateNoWindow=true;
thisProcess.StartInfo.WindowStyle=ProcessWindowStyle.Hidden;
thisProcess.StartInfo.WorkingDirectory=@"C:\postagger";
thisProcess.StartInfo.FileName=@"C:\postagger\stanford-postagger.bat";
thisProcess.StartInfo.UseShellExecute=false;
thisProcess.StartInfo.RedirectStandardOutput=true;

if(Directory.Exists(@"C:\brown2")) {
    DirectoryInfo brown=new DirectoryInfo(@"C:\brown2");
    DirectoryInfo brownParsed;

    if(!Directory.Exists(@"C:\brown-parsed"))
        brownParsed=Directory.CreateDirectory(@"C:\brown-parsed");
    else
        brownParsed=new DirectoryInfo(@"C:\brown-parsed");

    FileInfo[] files=brown.GetFiles();

    foreach(FileInfo f in files) {

        Console.WriteLine("Parsing file "+f.Name+" ...");
        thisProcess.StartInfo.Arguments=@"C:\postagger\models\wsj-0-18-bidirectional-distsim.tagger "+f.FullName;
        //Console.WriteLine(thisProcess.StartInfo.Arguments);
        thisProcess.Start();
        thisProcess.WaitForExit();
        //Console.Read();
        StreamWriter sw=new StreamWriter(Path.Combine(brownParsed.FullName, f.Name), false);
        string output=thisProcess.StandardOutput.ReadToEnd();
        //sw.Write(thisProcess.StandardOutput.ReadToEnd());
        sw.Write(output);
        sw.Flush();
        sw.Close();
        //Console.WriteLine("File {0} done!",f.Name);
        Console.WriteLine(output);
    }
}
else
    Console.WriteLine("Dir not found!");

Console.Read(); 
```

stanford-postagger.bat 看起来像这样：

> 用法：stanford-postagger 模型文本文件 例如，stanford-postagger models\left3words-wsj-0-18.tagger sample-input.txt
> 
> java -mx300m -cp "stanford-postagger.jar;" edu.stanford.nlp.tagger.maxent.MaxentTagger -model %1 -textFile %2

问题是：

代码运行它，但它**不会**运行 java 命令。我在我的笔记本电脑上试过了，它就像一个魅力，它标签。但由于内存不足，它不会标记大文件。但是在我更强大的PC上，它不会运行java。

如果我打开 CMD 并输入带有文件正确参数的 java 命令，它就可以工作。有什么可能导致它不起作用的想法吗？所有的路径都很好，我检查了三次。

这是我从非工作程序（在我的 PC 上）获得的输出示例：

> C:\postagger>java -mx300m -cp "stanford-postagger.jar;" edu.stanford.nlp.tagger.maxent.MaxentTagger -model C:\postagger\models\wsj-0-18-bidirectional-distim.tagger-textFile C:\brown2\aaa.txt

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:43:56.957

我不能 100% 确定使用它运行批处理文件，但也许使用 Process 来执行它？

```
var process = new Process
        {
            StartInfo = new ProcessStartInfo
            {
                FileName = "path-to-file.bat"
            }
        };
        process.Start();
        process.WaitForExit(); 
```

# sql - T-SQL 函数循环

> ID：15668962
> 
> 赞同：2
> 
> 时间：2013-03-27T20:39:00.443
> 
> 标签：sql, tsql, loops, sql-server-2008-r2

我想知道是否可以在我尝试创建的 T-SQL 函数上获得一些帮助：

以下是一些需要查询的示例数据：

简化表：

```
ID|PersonID|ValueTypeID|ValueTypeDescription|Value

 1|ZZZZZ000L6|ZZZZZ00071|Start Prison Date|3/28/2012
 2|ZZZZZ000L6|ZZZZZ00071|Start Prison Date|10/10/2012
 3|ZZZZZ000L6|ZZZZZ00072|End Prison Date  |3/29/2012
 4|ZZZZZ000MD|ZZZZZ00071|Start Prison Date|1/15/2012
 5|ZZZZZ000MD|ZZZZZ00072|End Prison Date  |2/15/2012
 6|ZZZZZ000MD|ZZZZZ00071|Start Prison Date|4/1/2012
 7|ZZZZZ000MD|ZZZZZ00072|End Prison Date  |4/5/2012
 8|ZZZZZ000MD|ZZZZZ00071|Start Prison Date|9/3/2012
 9|ZZZZZ000MD|ZZZZZ00072|End Prison Date  |12/1/2012 
```

我需要的是一个 T-SQL 函数，它接受`PersonID`和年份 ( `@PID, @YR`) 并返回该人当年入狱的天数。

```
dbo.NumDaysInPrison(@PID, @YR) as int 
```

例子：

```
dbo.NumDaysInPrison('ZZZZZ000L6', 2012) returns 84
dbo.NumDaysInPrison('ZZZZZ000MD', 2012) returns 124 
```

到目前为止，我已经想出了这个有时会给我答案的查询。

```
DECLARE @Year int
DECLARE @PersonID nvarchar(50)

SET @Year = 2012
SET @PersonID = 'ZZZZZ000AA'

;WITH StartDates AS
(
SELECT
Value,
ROW_NUMBER() OVER(ORDER BY Value) AS RowNumber
FROM Prisoners
WHERE ValueTypeDescription = 'Start Prison Date' AND PersonID = @PersonID AND YEAR(Value) = @Year
), EndDates AS
(
SELECT
Value,
ROW_NUMBER() OVER(ORDER BY Value) AS RowNumber
FROM Prisoners
WHERE ValueTypeDescription = 'End Prison Date' AND PersonID = @PersonID AND YEAR(Value) = @Year
)
SELECT
SUM(DATEDIFF(d, s.Value, ISNULL(e.Value, cast(str(@Year*10000+12*100+31) as date)))) AS NumDays
FROM StartDates s
LEFT OUTER JOIN EndDates e ON s.RowNumber = e.RowNumber 
```

如果今年早些时候的记录没有结束日期，则无法捕获：例如，如果一个人只有两条记录：

```
ID|PersonID|ValueTypeID|ValueTypeDescription|Value

 1|ZZZZZ000AA|ZZZZZ00071|Start Prison Date|3/28/2012
 2|ZZZZZ000AA|ZZZZZ00071|Start Prison Date|10/10/2012 
```

(3/28/2012 -> 年底) (10/10/2012 -> 年底)

将返回 360，而不是 278。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:22:50.567

这是我使用测试表和数据的实现。您必须在适当的地方进行更改。 *注意*：我在监狱里用 datediff + 1，所以如果你星期一进去，星期二离开，那算作两天。如果您希望它计为一天，请删除“+ 1”

```
create table PrisonRegistry
(
    id int not null identity(1,1) primary key
    , PersonId int not null
    , ValueTypeId int not null
    , Value date
)

-- ValueTypeIDs: 1 = start prison date, 2 = end prison date

insert PrisonRegistry( PersonId, ValueTypeId, Value ) values ( 1, 1, '2012-03-28' )
insert PrisonRegistry( PersonId, ValueTypeId, Value ) values ( 1, 1, '2012-10-12' )
insert PrisonRegistry( PersonId, ValueTypeId, Value ) values ( 1, 2, '2012-03-29' )
insert PrisonRegistry( PersonId, ValueTypeId, Value ) values ( 2, 1, '2012-01-15' )
insert PrisonRegistry( PersonId, ValueTypeId, Value ) values ( 2, 2, '2012-02-15' )
insert PrisonRegistry( PersonId, ValueTypeId, Value ) values ( 2, 1, '2012-04-01' )
insert PrisonRegistry( PersonId, ValueTypeId, Value ) values ( 2, 2, '2012-04-05' )
insert PrisonRegistry( PersonId, ValueTypeId, Value ) values ( 2, 1, '2012-09-03' )
insert PrisonRegistry( PersonId, ValueTypeId, Value ) values ( 2, 2, '2012-12-1' )
go

create function dbo.NumDaysInPrison(
    @personId int
    , @year int
)
returns int
as
begin

    declare @retVal int
    set @retVal = 0

    declare @valueTypeId int
    declare @value date
    declare @startDate date
    declare @noDates bit

    set @noDates = 1

    set @startDate = DATEFROMPARTS( @year, 1, 1 )

    declare prisonCursor cursor for
    select
        pr.ValueTypeId
        , pr.Value
    from
        PrisonRegistry pr
    where
        DATEPART( yyyy, pr.Value ) = @year
        and pr.ValueTypeId in (1,2)
        and PersonId = @personId
    order by
        pr.Value

    open prisonCursor

    fetch next from prisonCursor
    into @valueTypeId, @value

    while @@FETCH_STATUS = 0
    begin
        set @noDates = 0

        -- if end date, add date diff to retVal
        if 2 = @valueTypeId
        begin
            --if @startDate is null
            --begin
            --  -- error: two end dates in a row
            --  -- handle
            --end

            set @retVal = @retVal + DATEDIFF( dd, @startDate, @value ) + 1

            set @startDate = null
        end
        else if 1 = @valueTypeId
        begin
            set @startDate = @value
        end

        fetch next from prisonCursor
        into @valueTypeId, @value
    end

    close prisonCursor
    deallocate prisonCursor

    if @startDate is not null and 0 = @noDates
    begin
        set @retVal = @retVal + DATEDIFF( dd, @startDate, DATEFROMPARTS( @year, 12, 31 ) ) + 1
    end

    return @retVal
end

go

select dbo.NumDaysInPrison( 1, 2012 )
select dbo.NumDaysInPrison( 2, 2012 )
select dbo.NumDaysInPrison( 2, 2011 ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T21:00:52.630

因此，您似乎拥有拆分“开始日期”值和“结束日期”值所需的数据。你真的不需要遍历任何东西，你可以根据你的人提取你的起始值然后你的最终值并比较它们。

重要的是提取所有你需要开始的东西，然后比较适当的值。

这是基于上述数据的示例。需要对生产数据进行一些重大调整；它对数据做出假设`Value`。像我在这里一样硬编码 valuetypeid 也是一个坏主意；如果你正在制作一个函数，你会想要处理它，我想。

```
DECLARE @pid INT, @yr INT;

WITH startdatecalc AS
(
    SELECT personid, CAST([value] AS date) AS startdate, DATEPART(YEAR, CAST([value] AS date)) AS startyear
    FROM incarctbl 
    WHERE valuetypeid = 'ZZZZZ00071'
),
    enddatecalc AS
(
    SELECT personid, CAST([value] AS date) AS enddate, DATEPART(YEAR, CAST([value] AS date)) AS endyear
    FROM incarctbl 
    WHERE valuetypeid = 'ZZZZZ00072'
)       

SELECT CASE WHEN startyear < @yr THEN DATEDIFF(day, CAST(CAST(@yr AS VARCHAR(4)) + '-01-01' AS date), ISNULL(enddatecalc.enddate, CURRENT_TIMESTAMP))
    ELSE DATEDIFF(DAY, startdate, ISNULL(enddatecalc.enddate, CURRENT_TIMESTAMP)) END AS NumDaysInPrison
FROM startdatecalc 
LEFT JOIN enddatecalc
    ON startdatecalc.personid = enddatecalc.personid
    AND enddatecalc.enddate >= startdatecalc.startdate
    AND NOT EXISTS 
        (SELECT 1 FROM enddatecalc xref 
        WHERE xref.personid = enddatecalc.personid 
        AND xref.enddate < enddatecalc.enddate 
        AND xref.enddate >= startdatecalc.startdate 
        AND xref.endyear < @yr)
WHERE startdatecalc.personid = @pid
AND startdatecalc.startyear <= @yr  
AND (enddatecalc.personid IS NULL OR endyear >= @yr); 
```

编辑：添加了存在检查以尝试处理同一个人是否在同一年多次使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T21:05:22.377

这是一个复杂的问题。它与其说是“要求一个功能”，不如说是在处理两个相互竞争的问题。第一个是将基于交易的数据组织成记录，其中包含监狱期间的开始和结束日期。第二个是总结在另一个给定时间跨度（一年）内花费的时间。

我认为在继续编写函数之前，您需要花一些时间调查数据以了解其中的异常情况。以下查询应该对您有所帮助。它计算给定年份（即第一个 CTE 中的年份）的所有囚犯：

```
with vals as (
      select 2012 as yr
     ),
     const as (
      select cast(CAST(yr as varchar(255))+'-01-01' as DATE) as periodstart,
             cast(CAST(yr as varchar(255))+'-12-31' as DATE) as periodend
      from vals
     )
select t.personId, SUM(datediff(d, (case when StartDate < const.periodStart then const.periodStart else StartDate end),
                                (case when EndDate > const.PeriodEnd or EndDate is NULL then const.periodEnd, else EndDate end)
                               )
                      ) as daysInYear
from (select t.*, t.value as StartDate,
             (select top 1 value
              from t t2
              where t.personId = t2.personId and t2.Value >= t.Value and t2.ValueTypeDescription = 'End Prison Date'
              order by value desc
             ) as EndDate
      from t
      where valueTypeDescription = 'Start Prison Date'
     ) t cross join
     const
where StartDate <= const.periodend and (EndDate >= const.periodstart or EndDate is NULL)
group by t.PersonId; 
```

该查询可以作为一个函数进行调整。但是，我鼓励您在去那里之前调查数据。一旦你把事情包装在一个函数中，发现和理解异常就会变得更加困难——为什么有人在同一天进出？最长的监狱时间是多少？等等。

# oracle - 在 Oracle 触发器中获取当前行数据

> ID：15668964
> 
> 赞同：0
> 
> 时间：2013-03-27T20:39:15.690
> 
> 标签：oracle, plsql

我有一个 Oracle 10g 触发器，它在每一行之后都有一个 INSERT 触发事件，我想在触发器中基于当前插入的行的一些逻辑。我想获取插入的用户表标志列值，然后在触发器中，仅当标志为空时才使用 if-then-else 执行某些操作。关于如何获取被插入行的标志列值的任何想法？我的目标是在标志列值为空时不执行以下触发器中的任何逻辑。

```
Table: USERS

Columns:
id (PK generated from a DB sequence)
.... (more columns)
flag VARCHAR2(1 BYTE) and is nullable 
```

**扳机：**

```
//goal is to not do any of the logic in the trigger below when flag is null

CREATE OR REPLACE TRIGGER "DBUSER"."TI_USERS" 
  AFTER INSERT
  on Users

  for each row

declare numrows INTEGER;
begin
    select count(*) into numrows
      from Customer
      where
        /* %JoinFKPK(:%New,Customer," = "," and") */
        :new.Customer_Key = Customer.Customer_Key;
    if (
      /* %NotnullFK(:%New," is not null and") */

      numrows = 0
    )
    then
      raise_application_error(
        -20002,
        'Cannot INSERT Users because Customer does not exist.'
      );
    end if;

end;
ALTER TRIGGER "SIMPLEX"."TI_USERS" ENABLE 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T20:48:55.477

```
CREATE OR REPLACE TRIGGER "DBUSER"."TI_USERS" 
  AFTER INSERT
  on Users

  for each row

declare numrows INTEGER;
begin

IF ( :new.flag IS NOT NULL ) Then

    select count(*) into numrows
      from Customer
      where
        /* %JoinFKPK(:%New,Customer," = "," and") */
        :new.Customer_Key = Customer.Customer_Key;
    if (
      /* %NotnullFK(:%New," is not null and") */

      numrows = 0
    )
    then
      raise_application_error(
        -20002,
        'Cannot INSERT Users because Customer does not exist.'
      );
    end if;

end if;

end;
ALTER TRIGGER "SIMPLEX"."TI_USERS" ENABLE 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T20:51:21.977

包围整个街区`if :new.flag is not null then ... end if;`

# java - 如何使用 Java 打开端口（入站）？

> ID：15668967
> 
> 赞同：0
> 
> 时间：2013-03-27T20:39:21.973
> 
> 标签：java, port, router

是否可以使用 Java 打开入站端口？

如果没有，像 uTorrent 这样的程序如何在我的路由器中打开入站端口？
例如，uTorrent 自动添加了以下记录：
uTorrent (TCP) Yes TCP 24995 24995 24995 192.168.1.2
uTorrent (UDP) Yes UDP 24995 24995 24995 192.168.1.2

我怎样才能用 Java 做类似的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T22:02:21.393

使用[ServerSocket](http://docs.oracle.com/javase/7/docs/api/java/net/ServerSocket.html)类。

查看构造函数，它接收端口号，然后查看`accept`方法，它会阻塞等待客户端连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:50:24.987

这在 Java 中肯定是“可行的”。有几种方法可以做到这一点。我将 Apache Mina 用于我的一个项目。

[http://mina.apache.org/](http://mina.apache.org/)

# jquery - 移动浏览器上的 Ajax 错误

> ID：15668969
> 
> 赞同：0
> 
> 时间：2013-03-27T20:39:27.780
> 
> 标签：jquery

此代码适用于 Firefox、Chrome，但不适用于任何移动设备，我已经在 iPhone 和 Safari 以及 iPhone 和 Chrome 上进行了测试，但没有成功。

它是跨域的，我使用 jQuery 1.9.1 和 Migrate 插件。

返回状态为 NULL。

```
$.ajax({ url: 'http://mywebsite.com.br/ajaxPage.php',
                 type: 'POST',
                 dataType: 'json',
                 data:{ user: 'dude' },
                 complete:function(){
                    alert('Ajax: Complete');
                 },
                 success: function(callBack){
                    alert('Ajax: Success');
                    alert(callBack.message);
                 },
                 error:function(obj,text,status){
                    //alert(obj)
                    console.log(obj);
                    console.log('text');
                    alert('Ajax: Error');
                    alert(text);
                    alert(status);
                 } 
        }); 
```

# drupal - 使用 Drupal 上的复选框选择视图过滤器

> ID：15668979
> 
> 赞同：0
> 
> 时间：2013-03-27T20:40:17.123
> 
> 标签：drupal, view, checkbox

我创建了 3 种内容类型，我想在一个视图中显示它们。在那个视图中，我尝试添加 3 个复选框。当第一个复选框被选中时，视图将显示第一个内容类型。如果选中第二个，它将显示第二个内容类型，等等。

我在谷歌和论坛上搜索，但我什么也没找到。

有人可以帮助我吗？

非常感谢。

ps：对不起我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T08:52:37.863

实际上，分类法适用于暴露的过滤器。在您的情况下，这似乎有点矫枉过正，但我​​很确定您会得到预期的结果。

检查[better_exposed_filters](http://drupal.org/project/better_exposed_filters)应该为您提供更好的显示选项，实际上，您可能需要单选按钮，而不是复选框:)

正如[Vadim Eremeev](https://stackoverflow.com/users/2135439/vadim-eremeev)建议的那样，启用 Ajax 以便只需选择一个按钮即可显示相关内容。

现在，如果您使用分类法，您可能不需要三种不同的内容类型，但这是另一个问题！

# html - 如何将 Piler 与标准 HTML 一起使用而不是 Jade？

> ID：15668980
> 
> 赞同：2
> 
> 时间：2013-03-27T20:40:21.877
> 
> 标签：html, node.js, pug, piler

我正在使用 Node.js 和 Piler ( [https://github.com/epeli/piler](https://github.com/epeli/piler) )。项目网站上的示例展示了如何将 Piler 与 index.jade 文件一起使用。

index.jade:

```
!!! 5
html
  head
    !{css}
    !{js}
  body
    h1 Hello Piler 
```

当索引文件被交付给客户端时， `!{css}`and`!{js}`标签将转换为相应的 html 标签。

例如 ：`<script type="text/javascript" src="myscript.js"></script>`

如何在没有 index.jade 文件但使用 index.html 文件的情况下使用 Piler？index.html中的`!{css}`and`!{js}`标签应该是什么样子？

换句话说：我不想将 Piler 与 Jade 一起使用，而是与标准 html 一起使用。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-12T08:50:41.280

Piler 默认将 js 和 css 的 concat 版本存储在piler 缓存目录中，您可以`outputDirectory`在创建 JS/CSS 管理器时通过传递参数来指定该目录。

```
pilerCachePath = '/www/your-project/public-path/assets/';
var clientjs = piler.createJSManager({outputDirectory: pilerCachePath});
var clientcss = piler.createCSSManager({outputDirectory: pilerCachePath}); 
```

您可以定义一个可以访问的公共路径，然后在您的 html 中，只需使用这些路径

```
<!-- ... -->
<link rel="stylesheet" type="text/css" href="/assets/global.css">
</head>
<body>
<!-- ... -->
<script type="text/javascript" src="/assets/global.js"></script>
</body> 
```

但是，我建议为此目的使用[gruntjs](http://gruntjs.com/)。他们的文档[很好地介绍](http://gruntjs.com/getting-started)了如何使用它。

# php - 向用户发送确认电子邮件

> ID：15668981
> 
> 赞同：0
> 
> 时间：2013-03-27T20:40:26.277
> 
> 标签：php, mysql, email

当用户注册我的网站时，我正在尝试向他们发送一封包含确认码的电子邮件。电子邮件发送正常，但是当我输入完整的 URL 时，邮件没有发送

在这里你可以看到我正在使用的代码：

```
 $message = 'You have recieved this email because you have signed up to Amped. To complete the registration process, please
click on the link below. <br/> <a href=confirm.php?code=' . $row['emailcode'] . '>Click here to complete registration</a>' 
```

我需要在 confirm.php 之前输入完整的 url 以使链接正常工作，但是当我这样做时，电子邮件不会发送。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:42:16.717

您正在发送相对路径。您需要使用以下命令发送文件的整个路径`urlencode`：

```
$message = '<a href="' . urlencode("http://www.example.com/confirm.php?") . $row['emailcode'] . '">'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T20:42:33.413

您缺少引号：

```
 $message = 'You have recieved this email because you have signed up to Amped. To complete the registration process, please click on the link below. <br/> <a href="confirm.php?code=' . $row['emailcode'] . '">Click here to complete registration</a>' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T20:46:52.513

您应该确保清理该 url 变量，对其进行编码以安全使用 url，然后在 confirm.php 中对其进行解码。将 db 值直接回显到 url 不是一个好主意。urlencode() 是一个不错的解决方案。不这样做可能会导致 url 中断，进而导致脚本中断。

```
$code = urlencode($row['emailcode']);

$msg = "stuff.. <a href='http://www.example.con/confirm.php?code=". htmlentities($code) ."'>Click here</a>"; 
```

# python - 使用 numpy 数组有效地索引 numpy 数组

> ID：15668984
> 
> 赞同：1
> 
> 时间：2013-03-27T20:40:43.633
> 
> 标签：python, numpy, bigdata

我有一个非常（非常非常）大的二维数组 - 大约一千列，但有几百万行（足以让它不适合我的 32GB 机器的内存）。我想计算每一千列的方差。一个有帮助的关键事实：我的数据是 8 位无符号整数。

这就是我打算如何处理这个问题。*我将首先构造一个名为counts*的新二维数组，形状为 (1000, 256)，其思想是`counts[i,:] == np.bincount(bigarray[:,i])`. 一旦我有了这个数组，计算方差就很简单了。

麻烦的是，我不确定如何有效地计算它（这个计算必须实时运行，我希望带宽受限于我的 SSD 可以多快返回数据）。这是一些有效的方法，但速度非常慢：

```
counts = np.array((1000,256))
for row in iterator_over_bigaray_rows():
    for i,val in enumerate(row):
        counts[i,val] += 1 
```

有没有办法写这个运行得更快？像这样的东西：

```
counts = np.array((1000,256))
for row in iterator_over_bigaray_rows():
    counts[i,:] = // magic np one-liner to do what I want 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T20:54:23.433

我认为这就是你想要的：

```
counts[np.arange(1000), row] += 1 
```

* * *

但是，如果您的数组有数百万行，您仍然需要遍历数百万行。以下技巧在我的系统上提供了接近 5 倍的加速：

```
chunk = np.random.randint(256, size=(1000, 1000))

def count_chunk(chunk):
    rows, cols = chunk.shape
    col_idx = np.arange(cols) * 256
    counts = np.bincount((col_idx[None, :] + chunk).ravel(),
                         minlength=256*cols)
    return counts.reshape(-1, 256)

def count_chunk_by_rows(chunk):
    counts = np.zeros(chunk.shape[1:]+(256,), dtype=np.int)
    indices = np.arange(chunk.shape[-1])
    for row in chunk:
        counts[indices, row] += 1
    return counts 
```

现在：

```
In [2]: c = count_chunk_by_rows(chunk)

In [3]: d = count_chunk(chunk)

In [4]: np.all(c == d)
Out[4]: True

In [5]: %timeit count_chunk_by_rows(chunk)
10 loops, best of 3: 80.5 ms per loop

In [6]: %timeit count_chunk(chunk)
100 loops, best of 3: 13.8 ms per loop 
```

# c# - log4net 字符串匹配过滤器

> ID：15668985
> 
> 赞同：0
> 
> 时间：2013-03-27T20:40:45.267
> 
> 标签：c#, log4net

我只想记录我的明确设置消息。我设置了这样的消息`log.Info("My message - User is logged in");`所以我想在 log4net 配置中使用 stringmatch 过滤器作为过滤器类型，就像这样

```
<filter type="log4net.Filter.StringMatchFilter">
  <stringToMatch value="My message - " />
  <filter type="log4net.Filter.DenyAllFilter" /> 
```

但是在日志文件中仍然有很多消息（映射等），所以显然我在这里做错了。请帮忙

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T09:53:06.673

我不会通过过滤器来做到这一点，而是通过听特定的记录器来做到这一点。要从您的登录类中获取特定的消息，您需要为该记录器设置一个特定的名称：

```
ILog logger = LogManager.GetLogger("MyLoginClass"); //typeof(LoginClass).Name 
```

在您的配置中添加特定登录类记录器的配置：

```
<logger name="MyLoginClass">
  <level value="INFO"/>
  <appender-ref ref="MyAppender"/>
</logger> 
```

# c# - 如何在 Ubuntu 上的 MonoDevelop 中使用 System.Windows.Forms？

> ID：15668986
> 
> 赞同：4
> 
> 时间：2013-03-27T20:40:51.153
> 
> 标签：c#, .net, winforms, ubuntu, mono

我在工作之初就遇到了这个问题。我正在使用 Mono 2.10 和 MonoDevelop 2.8。当我创建一个新的 C# 项目时，我不能使用：

`using System.Windows.Forms`

因为这里没有这样的命名空间。

我搜索了一些答案并尝试了：

`apt-get install libmono-system-windows-forms4.0-cil`和

`apt-get install libmono-winforms2.0-cil`

但他们都告诉我我已经安装了它们。所以现在我想知道我是否不能用 Mono 编写 Windows 窗体应用程序，但我只能用它运行这样的应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-05T03:39:58.067

尽管评论中已经回答了这个问题，但新手（像我一样）可能会喜欢更详细的版本：

*   在 monodevelop 中，单击 References 文件夹旁边的齿轮/设置图标（或右键单击 References 文件夹）
*   选择“编辑参考”
*   搜索窗口
*   检查 System.Windows.Forms
*   点击确定

# function - VBScript：将参数传递给函数

> ID：15668987
> 
> 赞同：-1
> 
> 时间：2013-03-27T20:40:56.363
> 
> 标签：function, vbscript, parameter-passing

我有 2 个功能。我需要将一个参数从一个传递到另一个，并在第二个函数中对其进行评估。对于下面的代码，我需要在 env 中使用“QA”，但将其打印为“env”

```
strenv = "QA"
cus_number = getNumber(strenv)

If (IsNull(cus_number)) Then
    WScript.Echo "Number is null" 
Else
 WScript.Echo "cus_number : " & cus_number
End If

 Function getNumber(strenv)
    wscript.echo "env: " & strenv
    if strenv = "QA" Then
     number = "423"
    elseif strenv ="DEV" Then
      number= "678"
    endif
     getNumber=number
    End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T21:21:48.983

我在您的代码中看到至少 2 个问题：

1.  `strenv = QA`

    您可能打算将字符串分配给`"QA"`变量`strenv`。然而，没有双引号`QA`被认为是一个变量。由于您没有对其进行初始化，因此它的值为`Empty`，然后将其分配给`strenv`。

2.  函数中条件的语法不正确。请检查[文档](http://msdn.microsoft.com/en-us/library/5h27x7e9%28v=vs.84%29)。

# angularjs - 集成 karma-runner 和 cucumberjs

> ID：15668990
> 
> 赞同：8
> 
> 时间：2013-03-27T20:41:04.083
> 
> 标签：angularjs, cucumber, gruntjs, karma-runner

有没有人使用 karma-runner/testacular 来执行 cucumberjs 测试？我怀疑我可能必须编写一个像 Jasmine 适配器这样的适配器。任何有关将测试库与 karam-runner 集成的知识将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-05T16:14:29.170

我目前正在使用我写的适配器：[https ://npmjs.org/package/karma-cucumberjs](https://npmjs.org/package/karma-cucumberjs)

它对我来说一直很好，我现在正在第二个项目中使用它。但我确信一旦人们开始使用它并找到他们希望它做的事情，我可以对它做一些改变。如果有任何问题，请告诉我，您可以发送电子邮件至 s9tpepper@apache.org 或直接使用存储库上的 GitHub 问题。除非我正在寻找特定问题的答案，否则我不会检查 StackOverflow。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T06:41:36.677

这似乎是人们想要的。Jon Perl最近开始使用[karma-cucumber 。](https://github.com/jperl/karma-cucumber)它不包括 Cucumber.js 的 Karma 记者，但似乎是计划。

我也会在不久的将来研究这个。

# ipad - iscroll 子浏览器最大宽度

> ID：15668994
> 
> 赞同：0
> 
> 时间：2013-03-27T20:41:08.697
> 
> 标签：ipad, cordova, ios6, iscroll, childbrowser

只是一个与 Apple IOS6/IPad 2/IPad Mini 和 Childbrowser 中的 iScroll 4.2.5 相关的问题，通过 Adob​​e Phonegap 2.3.0 中的 App build 打开：

带有图像的水平滚动条，缩放到设备高度的 100%（宽度是动态的）：

```
<div id="iscroller">
<table><tr>
<td><img src="image1.jpg" /></td>
<td><img src="image2.jpg" /></td>
...
</tr></table>
</div> 
```

一张图片的宽度为 1125 像素，在 iscroller 周围有一些边框和空间，有 80 页，估计宽度为 111966

iscroll 非常适合水平滚动。但如果滚动条内的图片超过 80 张，iPad 2 在第 42 张图片后停止显示图片，iPad Mini 在第 70 张图片后停止显示。似乎最后一个图像是从上到下“剪切”的，或者页面的末端已经到达图像但没有到达滚动条。

似乎有一个最大宽度，但现在呢？tnx

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T16:34:05.830

一个解决方案是只显示允许的图像数量，然后用下一个允许的图像数量刷新 iscroll。