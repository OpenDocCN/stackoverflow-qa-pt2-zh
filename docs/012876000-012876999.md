# StackOverflow 问答 12876000-12876999

# javascript - 如何使用 javascript 从 Web 服务返回的二进制字符串构建 PDF 文件

> ID：12876000
> 
> 赞同：54
> 
> 时间：2012-10-13T18:57:56.510
> 
> 标签：javascript, jquery, pdf, cross-browser, binary-data

我正在尝试从作为 Ajax 请求响应的二进制流中构建 PDF 文件。

通过`XmlHttpRequest`我收到以下数据：

```
%PDF-1.4....
.....
....hole data representing the file
....
%% EOF 
```

到目前为止，我尝试的是通过`data:uri`. 现在，它没有任何问题，并且工作正常。不幸的是，它在 IE9 和 Firefox 中不起作用。一个可能的原因可能是 FF 和 IE9 在使用`data-uri`.

现在，我正在寻找适用于所有浏览器的任何解决方案。这是我的代码：

```
// responseText encoding 
pdfText = $.base64.decode($.trim(pdfText));

// Now pdfText contains %PDF-1.4 ...... data...... %%EOF

var winlogicalname = "detailPDF";
var winparams = 'dependent=yes,locationbar=no,scrollbars=yes,menubar=yes,'+
            'resizable,screenX=50,screenY=50,width=850,height=1050';

var htmlText = '<embed width=100% height=100%'
                     + ' type="application/pdf"'
                     + ' src="data:application/pdf,'
                     + escape(pdfText)
                     + '"></embed>'; 

                // Open PDF in new browser window
                var detailWindow = window.open ("", winlogicalname, winparams);
                detailWindow.document.write(htmlText);
                detailWindow.document.close(); 
```

正如我所说，它适用于 Opera 和 Chrome（Safari 尚未经过测试）。使用 IE 或 FF 会弹出一个空白的新窗口。

是否有任何解决方案，例如在文件系统上构建 PDF 文件以让用户下载它？我需要适用于所有浏览器的解决方案，至少在 IE、FF、Opera、Chrome 和 Safari 中。

我无权编辑 Web 服务实现。所以它必须是客户端的解决方案。有任何想法吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2015-08-01T14:40:11.823

> 是否有任何解决方案，例如在文件系统上构建 pdf 文件以让用户下载它？

尝试设置to ，替换 元素的属性 for`responseType`以允许从文件下载响应`XMLHttpRequest``blob``download``a``window.open``XMLHttpRequest``.pdf`

```
var request = new XMLHttpRequest();
request.open("GET", "/path/to/pdf", true); 
request.responseType = "blob";
request.onload = function (e) {
    if (this.status === 200) {
        // `blob` response
        console.log(this.response);
        // create `objectURL` of `this.response` : `.pdf` as `Blob`
        var file = window.URL.createObjectURL(this.response);
        var a = document.createElement("a");
        a.href = file;
        a.download = this.response.name || "detailPDF";
        document.body.appendChild(a);
        a.click();
        // remove `a` following `Save As` dialog, 
        // `window` regains `focus`
        window.onfocus = function () {                     
          document.body.removeChild(a)
        }
    };
};
request.send(); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-09-15T16:29:31.613

我意识到这是一个相当古老的问题，但这是我今天提出的解决方案：

```
doSomethingToRequestData().then(function(downloadedFile) {
  // create a download anchor tag
  var downloadLink      = document.createElement('a');
  downloadLink.target   = '_blank';
  downloadLink.download = 'name_to_give_saved_file.pdf';

  // convert downloaded data to a Blob
  var blob = new Blob([downloadedFile.data], { type: 'application/pdf' });

  // create an object URL from the Blob
  var URL = window.URL || window.webkitURL;
  var downloadUrl = URL.createObjectURL(blob);

  // set object URL as the anchor's href
  downloadLink.href = downloadUrl;

  // append the anchor to document body
  document.body.append(downloadLink);

  // fire a click event on the anchor
  downloadLink.click();

  // cleanup: remove element and revoke object URL
  document.body.removeChild(downloadLink);
  URL.revokeObjectURL(downloadUrl);
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-12T20:07:51.473

我改变了这个：

```
var htmlText = '<embed width=100% height=100%'
                 + ' type="application/pdf"'
                 + ' src="data:application/pdf,'
                 + escape(pdfText)
                 + '"></embed>'; 
```

至

```
var htmlText = '<embed width=100% height=100%'
                 + ' type="application/pdf"'
                 + ' src="data:application/pdf;base64,'
                 + escape(pdfText)
                 + '"></embed>'; 
```

它对我有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-07-27T20:00:20.873

@alexandre 与 base64 的答案可以解决问题。

为什么这适用于 IE 的解释在这里

[https://en.m.wikipedia.org/wiki/Data_URI_scheme](https://en.m.wikipedia.org/wiki/Data_URI_scheme)

在标题“格式”下它说

> 如果同时提供 ;base64 和 ;charset ，某些浏览器（Chrome、Opera、Safari、Firefox）接受非标准排序，而 Internet Explorer 要求 charset 的规范必须在 base64 标记之前。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-02T19:15:57.317

我在 PHP 中工作并使用一个函数来解码从服务器发回的二进制数据。我将信息提取到一个简单的 file.php 的输入中，并通过我的服务器查看该文件，所有浏览器都显示 pdf 人工制品。

```
<?php
   $data = 'dfjhdfjhdfjhdfjhjhdfjhdfjhdfjhdfdfjhdf==blah...blah...blah..'

   $data = base64_decode($data);
    header("Content-type: application/pdf");
    header("Content-Length:" . strlen($data ));
    header("Content-Disposition: inline; filename=label.pdf");
    print $data;
    exit(1);

?> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-08-03T13:02:58.830

检测浏览器并为 Chrome 使用 Data-URI，并为其他浏览器使用[PDF.js](https://mozilla.github.io/pdf.js)，如下所示。

```
PDFJS.getDocument(url_of_pdf)
.then(function(pdf) {
    return pdf.getPage(1);
})
.then(function(page) {
    // get a viewport
    var scale = 1.5;
    var viewport = page.getViewport(scale);
    // get or create a canvas
    var canvas = ...;
    canvas.width = viewport.width;
    canvas.height = viewport.height;

    // render a page
    page.render({
        canvasContext: canvas.getContext('2d'),
        viewport: viewport
    });
})
.catch(function(err) {
    // deal with errors here!
}); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-14T00:08:32.933

我最近看到了关于这个主题的另一个问题（[使用 dataurl 将 pdf 流式传输到 iframe 仅适用于 chrome](https://stackoverflow.com/questions/12848616/streaming-pdf-into-iframe-using-dataurl-works-only-in-chrome)）。

我已经在 ast 中构建了 pdf 并将它们流式传输到浏览器。我首先使用 fdf 创建它们，然后使用我自己编写的 pdf 类创建它们——在每种情况下，pdf 都是从基于通过 url 传入的几个 GET 参数从 COM 对象检索的数据创建的。

通过查看您在 ajax 调用中收到的发送数据，您似乎就快到了。我已经有几年没有使用代码了，也没有像我想要的那样记录它，但是 - 我认为你需要做的就是将 iframe 的目标设置为 url你从那里得到pdf。虽然这可能不起作用 - 输出 pdf 的文件也可能必须先输出 html 响应标头。

简而言之，这是我使用的输出代码：

```
//We send to a browser
header('Content-Type: application/pdf');
if(headers_sent())
    $this->Error('Some data has already been output, can\'t send PDF file');
header('Content-Length: '.strlen($this->buffer));
header('Content-Disposition: inline; filename="'.$name.'"');
header('Cache-Control: private, max-age=0, must-revalidate');
header('Pragma: public');
ini_set('zlib.output_compression','0');
echo $this->buffer; 
```

因此，如果没有看到 ajax 调用的完整响应文本，我无法确定它是什么，尽管我倾向于认为输出您请求的 pdf 的代码可能只相当于最后一个上面代码中的行。如果它是您可以控制的代码，我会尝试设置标题 - 这样浏览器就可以处理响应文本 - 您不必费心对其做任何事情。

我只是为我想要的 pdf 构建了一个 url（一个时间表），然后创建了一个字符串，该字符串表示所需 sie、id 等 iframe 的 html，该 iframe 使用构建的 url 作为它的 src。一旦我将 div 的内部 html 设置为构造的 html 字符串，浏览器就会要求提供 pdf，然后在收到它时显示它。

```
function  showPdfTt(studentId)
{
    var url, tgt;
    title = byId("popupTitle");
    title.innerHTML = "Timetable for " + studentId;
    tgt = byId("popupContent");
    url = "pdftimetable.php?";
    url += "id="+studentId;
    url += "&type=Student";
    tgt.innerHTML = "<iframe onload=\"centerElem(byId('box'))\" src='"+url+"' width=\"700px\" height=\"500px\"></iframe>";
} 
```

编辑：忘了提-您可以以这种方式发送二进制pdf。它们包含的流不需要是 ascii85 或十六进制编码。我在 pdf 中的所有流上都使用了 flate，效果很好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-28T16:04:23.343

您可以使用[PDF.js](https://mozilla.github.io/pdf.js/web/viewer.html)从 javascript 创建 PDF 文件...它很容易编码...希望这能解决您的疑问！！！

问候！

# c - 更改 Z 坐标 (OpenGL) 时不显示对象？

> ID：12876007
> 
> 赞同：0
> 
> 时间：2012-10-13T18:58:42.380
> 
> 标签：c, opengl, perspectivecamera

在 OpenGL 中渲染时遇到问题。一切都显示得很好，直到我改变 Z 坐标，它被剪裁/看不见了！是这样吗？我是否设置了透视投影矩阵错误？我被难住了...

我的渲染代码的相关位（`mat4_`函数是一个外部库，类似于他们的 GL 朋友）。

```
vec3_t eyevec = vec3_create(NULL);
eyevec[0] = 0.0f;
eyevec[1] = 0.0f;
eyevec[2] = 0.1f;
vec3_t centervec = vec3_create(NULL);
centervec[0] = 0.0f;
centervec[1] = 0.0f;
centervec[2] = 0.0f;
vec3_t upvec = vec3_create(NULL);
upvec[0] = 0.0f;
upvec[1] = 1.0f;
upvec[2] = 0.0f;

vec3_t transvec = vec3_create(NULL);
transvec[0] = 0.0f;
transvec[1] = 0.0f;
transvec[2] = -2.0f;

mat4_t perspective = mat4_perspective(60.0f, 800.0f / 600.0f, 0.1f, 100.0f, NULL);
mat4_lookAt(eyevec, centervec, upvec, perspective);

mat4_t modelview = mat4_identity(NULL);
//mat4_translate(modelview, transvec, modelview); objects vanish when doing this!
mat4_multiply(perspective, modelview, perspective);

const GLfloat verts[] = {
   //verts
   0.0f, 0.0f, 0.0f, 1.0f,
   0.0f, 0.5f, 0.0f, 1.0f,
   0.5f,  0.5f, 0.0f, 1.0f,
   0.5f,  0.0f, 0.0f, 1.0f,
   //colors
   1.0f, 0.3f, 0.4f, 0.5f,
   0.5f, 0.1f, 0.4f, 0.3f,
   0.0f,  1.0f, 0.5f, 0.6f,
   0.0f,  1.0f, 0.5f, 0.6f,
   //tex coords
   0.0f, 0.0f,
   0.0f, 1.0f,
   1.0f, 1.0f,
   1.0f, 0.0f,
};

const GLushort indices[] = {3, 0, 2, 0, 2, 1};

    glDrawElements(GL_TRIANGLE_STRIP, 6, GL_UNSIGNED_SHORT, NULL); 
```

另请注意，我尝试过正反两方面的翻译。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T13:21:13.877

您评论的附近是 0.1f，在翻译时您将 z : transvec[2] 设置为 -2.0f。

所以它在近平面之前，这意味着它将在世界空间中呈现在你的眼睛后面。

这似乎是它消失的原因。

# php - 通过 PHP cURL 连接服务以发送数据不起作用

> ID：12876012
> 
> 赞同：0
> 
> 时间：2012-10-13T18:58:52.420
> 
> 标签：php, api, curl

我正在尝试发布到 linksalpha API。[我已经尝试了无数种方法，但在post](http://apidocs.linksalpha.com/methods/post)时我什至没有从他们的服务器得到响应。

这是我设置的[开发页面。](http://julianjosephs.com/linksalpha.php)内容多部分响应对我来说看起来很奇怪。我编写的代码（现在隐藏了 api）如下。我没有尝试做任何事情:(:

```
<html>
<head></head>
<body>
<?php
$link = 'http://api.linksalpha.com/ext/post';

$data = array(
    'api_key' => 'xxxxxxxxxxxxxx',
    'post_id' => '434345',
    'post_link' => 'www.google.com',
    'post_title' => 'test title',
    'post_content' => 'test msg'
);

function networkpub_http_post($link, $body) {

    $url = $link;
    $ch = curl_init();

    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $body);
    curl_setopt($ch, CURLOPT_HEADER, false);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_VERBOSE, true);
    curl_setopt($ch, CURLINFO_HEADER_OUT, true);

    $response = curl_exec($ch);

    function dbg_curl_data($ch, $data=null) {
      static $buffer = '';

      if ( is_null($ch) ) {
        $r = $buffer;
        $buffer = '';
        return $r;
      }
      else {
        $buffer .= $data;
        return strlen($data);
      }
    }

    echo '<fieldset><legend>request headers</legend>
      <pre>', htmlspecialchars(curl_getinfo($ch, CURLINFO_HEADER_OUT)), '</pre>
    </fieldset>';

    echo '<fieldset><legend>response</legend>
      <pre>', htmlspecialchars(dbg_curl_data(null)), '</pre>
    </fieldset>';

    curl_close($ch);

    return $response;

}

    $response_full = networkpub_http_post($link, $data);

    echo($response_full);
?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:15:35.287

如果你通过`CURLOPT_POSTFIELDS with array`了，那么它将算作`multipart/form-data`但通过 cURL 发布数据，那么你需要`application/x-www-form-urlencoded version`

所以在你的函数开始之前加上以下内容

```
$body = http_build_query($body); 
```

# php - 带有正则表达式的安全密码

> ID：12876014
> 
> 赞同：5
> 
> 时间：2012-10-13T18:58:56.013
> 
> 标签：php, regex, passwords, character

我对正则表达式非常陌生，我进行了研究并稍微了解了我需要的是符合这些规范的密码

1.  任何字母字符（至少一个）
2.  任何数字字符（至少一个）
3.  没有空间
4.  特殊字符（0 个或多个）

我要做的是这个

```
^(?=.*[0-9])(?=.*[a-zA-Z])([a-zA-Z0-9]+)(?!\S)$ 
```

匹配 1、2、3 规格但不匹配 4 我在 4 上尝试了不同的东西，但我失败了

谁能帮我 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-13T20:25:00.263

你很亲密。这似乎可以解决您的问题：

```
preg_match("/^(?=.*[0-9])(?=.*[a-z])(\S+)$/i", $password) 
```

我做了两个改变。

1.  `i`通过使用修饰符（不区分大小写）来缩短一点。这允许删除 AZ`。
2.  我认为这里`(?!\S)`并没有真正的帮助。相反，您可以简单地使您的实际匹配只包含非空格字符（`\S+`）。这也将立即允许您的密码中包含特殊字符（除了空格之外的任何内容）。

如果您只想允许特定的一组特殊字符，请将 替换为`\S`包含字母、数字和您希望允许的所有字符的字符类。顺便说一句，如果您想确保密码具有一定的最小长度，您可以将其更改`+`为`{8,}`例如。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-13T20:20:35.930

不需要奇怪的正则表达式。特别是因为您想确保密码**包含**或**不包含**，并且它出现在哪里并不重要：

```
<?php

/**
 * Validates the password:
 *  * Has at least one alphabet character
 *  * Has at least one digit
 *  * Has no spaces
 *
 * @param string $password  Password to validate
 *
 * @return bool             Whether $password is valid or not.
 */
function validate_password($password) {
    //If no alphabet characters found, return false.
    if (!preg_match("/[a-z]/i", $password)) {
        return false;
    }
    //If no digits found, return false.
    if (!preg_match("/[0-9]/", $password)) {
        return false;
    }
    //If a space is found, return false.
    if (strpos($password, " ") !== false) {
        return false;
    }
    //Special characters are optional, so no checking.
    //If nothing happened so far, the password is valid. Return true.
    return true;
}

var_dump(
    validate_password("test"),          //False, no digits
    validate_password("test123 test"),  //False, space
    validate_password("123456"),        //False, no alphabet
    validate_password("test1234")       //True
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T20:11:11.597

使用三个单独的正则表达式 - 一个检查是否有字母字符，一个检查是否有数字，一个检查是否没有空格。虽然可以使用单个正则表达式完成所有这些操作，但每个附加条件都会显着增加正则表达式的复杂性。

```
preg_match("/[a-z]/i", $passwd) && preg_match("/[0-9]/", $passwd) && !preg_match("/ /", $passwd) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-13T19:43:07.217

似乎是这样的：

```
^(?=.*[0-9])(?=.*[a-zA-Z])(?=\S*$)(?=[0-9a-zA-Z.,;~!@#$%^&*()\-+=\\\]+$) 
```

添加您需要的所有特殊字符。

**编辑**：回复一些评论，这是测试运行的结果：

```
<?php

$re = '/^(?=.*[0-9])(?=.*[A-Z])(?=\S*$)(?=[0-9a-zA-Z.,;~!@#$%^&*()\-+=\\\]+$)/';

$s = 'A2x.';

echo preg_match($re, $s);

?> 
```

在 Ubuntu 下使用 CLI 测试：

```
me@mymachine$ php _.php
1 
```

它得到`0`或`1`取决于`$s`;)

# regex - 使用 sed/awk 匹配 n 个空格后的单词

> ID：12876017
> 
> 赞同：2
> 
> 时间：2012-10-13T18:59:20.757
> 
> 标签：regex, sed, awk

如果我有一个这样的字符串：

> word_1 某事测试

有什么办法可以使用`sed`/得到第二个或第三个单词`awk`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T19:18:45.650

如果您想要每行的第三个单词，请使用`cut -f 3 file_name`. 如果您仅在第一个单词与特定字符串`awk '/^word_1/ { print $3; }' file_name`或类似字符串匹配时才需要第三个单词（自从我使用 awk 以来已经有一段时间了，所以我必须在使用它之前查找语法）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T00:54:44.500

如果您只想要每行的第二个或第三个单词，我会这样使用`awk`：

```
awk '{ print $2 }' file.txt 
```

对于第二个单词，或者 with`$3`而不是`$2`对于第三个单词，等等。

@paul-tomblin 的建议`cut`也很好，尽管我的看法是，如果事情足够简单`awk`，我会使用它而不是花时间和脑细胞弄清楚我需要与其他人一起使用什么神秘的选项-random-Posix 命令。也就是说，我认为将精力集中在学习更通用的工具（例如`awk`）上是值得的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T22:19:49.073

您可以使用 for 循环在 n 个空格之后使用`awk`. 如果你有保存在 bash 变量中的空格数，你可以这样做：

```
spaces=0
awk -v n=$spaces '{ for (i=n+1; i<=NF; i++) printf (i!=NF) ? $i" " : $i"\n" }' file.txt 
```

结果：

```
word_1 something test 
```

* * *

```
spaces=1
awk -v n=$spaces '{ for (i=n+1; i<=NF; i++) printf (i!=NF) ? $i" " : $i"\n" }' file.txt 
```

结果：

```
something test 
```

* * *

```
spaces=2
awk -v n=$spaces '{ for (i=n+1; i<=NF; i++) printf (i!=NF) ? $i" " : $i"\n" }' file.txt 
```

结果：

```
test 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-14T06:47:45.750

这可能对您有用（GNU sed）：

```
echo {a..z} | sed -r 's/(\s*(\S*)){10}.*/\2/'
j 
```

哪里`{10}`可以是任何数字，例如`{2}`会返回`b`

对于高编号`awk`的单词来说效率更高。

# google-chrome - chrome开发者工具控制台没有扩展日志

> ID：12876028
> 
> 赞同：3
> 
> 时间：2012-10-13T19:00:44.150
> 
> 标签：google-chrome, google-chrome-devtools

现在我的 chrome 开发工具中的调试控制台充满了垃圾。据我所知，这些是来自 chrome 扩展的日志，我希望它们消失。这很烦人，因为我必须在每次刷新后清除控制台输出，然后才能开始调试。在谷歌上找不到任何东西，所以如果有人知道如何防止扩展日志出现在那里，请告诉我

[这就是 stackoverflow 网站http://i.imgur.com/UQvJS.png](http://i.imgur.com/UQvJS.png)上的样子

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-01-19T16:20:35.723

我在论坛中找到了另外两种方法。我发现这两者都完全符合我的要求。我选择了第一个，但第二个也可以。

通过右键单击控制台消息行的白色（空白）部分并选择 Filter > Hide Messages from foo.js，过滤掉来自特定源文件的所有消息。如果您愿意，您可以稍后从同一菜单撤消此过滤。Chrome 会记住为您执行此过滤，直到您禁用它（即使您导航到其他地方或重新启动 Chrome）。

Chrome 本身具有用户配置文件和快速用户切换功能。从 chrome://settings/ 添加用户。您可以从您创建的新用户测试您的 web 应用程序。在用户之间切换只需点击左上角的图标，然后选择另一个用户

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-26T02:39:56.603

您应该使用隐身模式。除非您允许，否则在隐身模式下几乎不允许扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T09:57:34.590

您可以在一定程度上减少可见的输出量 - 通过选择底部状态栏中的相应按钮过滤所需级别的消息（在屏幕截图中，选择了“全部”按钮；“错误”、“警告”和“日志”是可用的）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T10:01:08.383

没有简单的方法来禁用扩展的 loggig。您可以轻松禁用扩展程序并摆脱它们的日志记录。

但是，如果在您的情况下您想“忽略”扩展日志，您可以通过[`"%c"`](http://trac.webkit.org/changeset/130941)在控制台中使用新的样式命令使您自己的日志更加可见。

将此函数添加到您的代码顶部，以使您的日志变得粗体和大，并轻松忽略扩展日志。

```
var _log = console.log;
console.log = function() {
  _log.call(console, '%c' + [].slice.call(arguments).join(' '), 'font-weight:bold; font-size: 16px');
}; 
```

请注意，此功能刚刚介绍，您将需要 Chrome Canary 才能使用它。

![在此处输入图像描述](../Images/55e524dc723c750a8269ee322f438d1b.png)

# python - 在 Python 中创建属性和在类中声明它有什么区别？

> ID：12876033
> 
> 赞同：4
> 
> 时间：2012-10-13T19:01:03.060
> 
> 标签：python, descriptor

这两个代码将给出两个不同的输出，为什么？

```
class Test:
    def __get__(self, instance, owner):
        return 42
    def __set__(self, instance, value):
        pass

class A:
    a = Test()

a = A()
print(a.a) // print 42
a.a = 0
print(a.a) // print 42 
```

和

```
class Test:
    def __get__(self, instance, owner):
        return 42
    def __set__(self, instance, value):
        pass

class A:
    pass

a = A()
a.a = Test()
print(a.a) // print <__main__.Test object at 0xb700d6cc>
a.a = 0
print(a.a) // print 0 
```

Python 引擎中如何存储属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T19:03:27.263

您的`Test`课程不称为“属性”，而是[描述符](http://docs.python.org/reference/datamodel.html#implementing-descriptors)。根据定义，描述符仅在存储在（新样式，适用于可怜的 Python 2 用户）类中时才起作用。非类对象上的描述符对象没有特殊含义，它们被视为任何其他对象。它们的`__get__`方法在被检索时`__set__`被忽略，而它们在被替换时被忽略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T19:04:55.940

在第一种情况下，类`Test`充当您的类 A 的描述符，因为它定义了`__get__`方法`__set__`。

如果你在你的类中使用`any class`有`__get__`,`__set__`方法作为一个属性，它作为`descriptor`你的类的一个，而不是一个`attribute`.
因此，当您为该变量赋值时，该`descriptor's` `__set__`方法被调用，当您尝试访问它时，该`descriptor's` `__get__`方法被调用。`getters`描述符只是通过和提供对类属性的访问`setters`

因此，当您`a = Test()`在类 A 中执行此操作时，将`__get__`调用描述符方法并`42`返回值并将其分配给它。

`class Test`而在第二种情况下，您就像其他所有类一样实例化。因此，`a.a`表示对 class 实例的引用`Test`。

# javascript - 为什么使用 WebGL 渲染时 Box2D 身体的线条扭曲、不清晰、不直？

> ID：12876037
> 
> 赞同：0
> 
> 时间：2012-10-13T19:01:36.297
> 
> 标签：javascript, box2d, webgl

我将 Box2DWeb 与 javascript 和 WebGL 一起使用。

在 Box2D 中，我的身体尺寸约为 1.0，地面约为 5.0。我只是使用 WebGL 使用**translate**和**rotate**绘制它们（使用从**GetPosition()**和GetAngle( **)**函数获得的值）。我使用从这些函数中获得的相同值。即，我使用大约 1.0 的值来绘制对象，使用大约 5.0 的值绘制地面。

问题是当发生旋转时（比如两个物体碰撞时），物体旋转并平移直到平衡，最终绘制的位置**不清楚**。即使物体只是躺在地上，线条也不是直的。没有旋转，身体看起来就好了。

[这](http://i.imgur.com/elrTK.png)是一张图片：

正如你所看到的，一些边线和底线不是直的。它们看起来是扭曲的。为什么会发生这种情况？

总而言之，我**踏遍**世界，在某处**存储**更改的位置和角度，并使用**WebGL**转换到点并使用 WebGL 调用旋转并在屏幕上绘制身体。

**[编辑]** 较大物体最终静止时的角度为：-3.1379659302514917！它没有下降到一个完整的`-PI`. 也许这就是为什么它被这样看待。有什么办法可以解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T04:53:39.650

通用物理引擎不可避免地会产生不精确的结果。您可以通过设置更严格的阈值来停止模拟几乎静止的物体（显然 Box2D 将其称为“睡眠”），可以将其调整为更接近的近似值。

您还可以通过使用抗锯齿图形使其在屏幕上不那么明显，这样轻微的旋转不会在线条中产生一个像素的扭结，而是产生更平缓的斜率。

您还可以在接近倍数 π/2 实际上是精确的假设下调整旋转值，但这会在翻滚的身体中产生明显的故障。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T18:44:08.823

我发现它的发生是因为我使用透视投影而不是正交投影来绘制 2D 东西。

此外，我必须将图像保持在 0.5 m 到 5 m 的范围内，并使用 30.0 的比例在屏幕像素和 Box2D 米之间进行转换。

# cakephp-2.2 - 不带身份验证组件的重定向

> ID：12876040
> 
> 赞同：0
> 
> 时间：2012-10-13T19:01:40.740
> 
> 标签：cakephp-2.2

有没有办法在不使用 Auth 组件的情况下在 cakephp 中重定向？我没有数据库或不需要数据库，因此我没有用户表来实例化 Auth 组件以使用重定向。当我进行常规`header`重定向时，它不起作用，因为页面已经有输出。

蛋糕PHP 2.2

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T02:04:29.117

您可以使用控制器的重定向方法：

```
class OrdersController extends AppController {

    public function add() {
      ...
      $this->redirect('/orders/thanks');
    } 
```

我会为你做所有必要的输出。有关更多信息，请参阅[http://book.cakephp.org/2.0/en/controllers.html#flow-control上的 CakePHP 手册](http://book.cakephp.org/2.0/en/controllers.html#flow-control)

# ios6 - 主到详细视图 - 返回主视图时重置详细视图

> ID：12876045
> 
> 赞同：0
> 
> 时间：2012-10-13T19:02:22.957
> 
> 标签：ios6, master, detailview

如何在主-详细视图类型应用程序中重置详细视图？例如，我的主视图仅列出姓名，当您选择姓名时，我想要您选择的那个人的详细信息。应用程序将执行的操作。但是，当我从详细视图中按下“返回”按钮并选择另一个名称时，详细视图将保留第一个选定的项目。如何重置该详细信息视图，以便显示所选内容的详细信息？

我的 detailviewcontroller 中有这个（Profile 是一个类）：

```
-(id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil title:(NSString *)name details:(Profile *)profile{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        self.title = NSLocalizedString(@"Detail", @"Detail");

        NSLog(@"Details: %@", [profile lastName]);
        _detailProfile = profile;

    }
    return self;
} 
```

这是在我的主视图控制器中：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (!self.detailViewController) {
        //self.detailViewController = [[MediaDirectoryDetailViewController alloc] initWithNibName:@"MediaDirectoryDetailViewController" bundle:nil];

        _showProfile = [_profileArray objectAtIndex:indexPath.row];

        self.detailViewController = [[MediaDirectoryDetailViewController alloc] initWithNibName:@"MediaDirectoryDetailViewController" bundle:nil title:@"Detail" details:_showProfile];
    }
    NSDate *object = _objects[indexPath.row];
    self.detailViewController.detailItem = object;
    [self.navigationController pushViewController:self.detailViewController animated:YES];
} 
```

根据收到的答案编辑

行。detailProfile 是详细视图控制器的属性，我创建了一个方法：

```
@property (strong, nonatomic) Profile *detailProfile;
-(void)setDetailProfile:(Profile *)profile; 
```

实现如下：

```
-(void)setDetailProfile:(Profile *)profile{
    NSLog(@"Going to display profile: %@, %@", [profile lastName], [profile firstName]);

    [firstName setText:[profile firstName]];
    [lastName setText:[profile lastName]];
} 
```

现在，无论出于何种原因，我的标签 firstName 和 lastName 都没有更新。

我在主人身上做了以下事情：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (!self.detailViewController) {
        //self.detailViewController = [[MediaDirectoryDetailViewController alloc] initWithNibName:@"MediaDirectoryDetailViewController" bundle:nil];

        _showProfile = [_profileArray objectAtIndex:indexPath.row];

        NSLog(@"Profile selected last name: %@", [_showProfile lastName]);

       // self.detailViewController = [[MediaDirectoryDetailViewController alloc] initWithNibName:@"MediaDirectoryDetailViewController" bundle:nil title:@"Detail" details:_showProfile];

        self.detailViewController = [[MediaDirectoryDetailViewController alloc] initWithNibName:@"MediaDirectoryDetailViewController" bundle:nil title:@"Detail"];

        self.detailViewController.detailProfile = _showProfile;
    }
    NSDate *object = _objects[indexPath.row];
    self.detailViewController.detailItem = object;
    [self.navigationController pushViewController:self.detailViewController animated:YES];
} 
```

我对日志的输出选择新项目时不会更新 - 从详细信息返回后 - 我的标签正在更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T19:17:49.520

如果`detailProfile`不是详细视图控制器的属性，则将其转换为属性。创建您自己的`setDetailProfile`方法，并在其中更新您的详细控制器（和屏幕上）中的任何内容，当您获得新的配置文件时您需要这样做。（你没有说你目前在哪里做，但可能你可以将代码移出`viewWillAppear`或`viewDidAppear`或其他东西。）

更改您的 init 方法，使其不需要配置文件参数，然后将您的 master 更改为：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (!self.detailViewController) {
        self.detailViewController = [[MediaDirectoryDetailViewController alloc] initWithNibName:@"MediaDirectoryDetailViewController" bundle:nil title:@"Detail"];
    }
    _showProfile = [_profileArray objectAtIndex:indexPath.row];
    self.detailViewController.detailProfile = _showProfile;

    NSDate *object = _objects[indexPath.row];
    self.detailViewController.detailItem = object;
    [self.navigationController pushViewController:self.detailViewController animated:YES];
} 
```

编辑：

对于 iPhone。因为没有拆分视图，所以忽略有关创建自定义`setDetailProfile`方法的部分。相反，如上所示设置属性，然后`self.detailProfile`在`viewWillAppear:`.

# php - WordPress管理面板中的简单上传表单字段

> ID：12876047
> 
> 赞同：5
> 
> 时间：2012-10-13T19:02:28.137
> 
> 标签：php, forms, wordpress

根据Nicolas Kuttler[的 WordPress 简单上传字段](http://kuttler.eu/code/simple-upload-field-for-wordpress-pluginsthemes/)，可以创建自定义上传表单字段。但是，引入的代码只是函数。我想知道如何使用它。

有人可以提供一个可行的例子吗？如果代码提供上传文件的功能，那么代码是否属于该页面对我来说并不重要。我希望能够通过管理面板上传文件。

[编辑]

我想上传图片以外的文件，包括文本文件和 xml。我也想在没有javascript的情况下实现它。目前还没有发布有效的答案。（到目前为止，我很欣赏发布的信息作为答案。）

提前致谢。

* * *

建议的[示例插件](http://premiumcoding.com/wordpress-tutorial-custom-admin-panel/)不允许用户与上传框进行交互。我附上了下面的截图。

![在此处输入图像描述](../Images/292dbda6b39f4f0ad3910e5054e38a92.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T15:01:49.173

对于想了解更多有关文件上传的任何人，这里有一个涵盖主要主题和痛点的快速入门。这是在 Linux 机器上使用 WordPress 3.0 编写的，代码只是教授概念的基本概述——我相信这里的一些人可以提供改进实施的建议。概述你的基本方法

至少有三种方法可以将图像与帖子相关联：使用 post_meta 字段存储图像路径，使用 post_meta 字段存储图像的媒体库 ID（稍后将详细介绍），或将图像作为附件分配给帖子。此示例将使用 post_meta 字段来存储图像的媒体库 ID。YMMV。多部分编码

默认情况下，WordPress 的创建和编辑表单没有 enctype。如果你想上传一个文件，你需要在表单标签中添加一个“enctype='multipart/form-data'”——否则 $_FILES 集合根本不会被推送。在 WordPress 3.0 中，有一个钩子。在一些以前的版本中（不确定细节）你必须用字符串替换表单标签。

```
function xxxx_add_edit_form_multipart_encoding() 
{

echo ' enctype="multipart/form-data"';

}
add_action('post_edit_form_tag', 'xxxx_add_edit_form_multipart_encoding'); 
```

创建元框和上传字段

我不会深入创建元框，因为你们中的大多数人可能已经知道怎么做，但我只想说你只需要一个简单的元框，里面有一个文件字段。在下面的示例中，我包含了一些代码来查找现有图像，如果存在则显示它。我还包含了一些简单的错误/反馈功能，它们使用 post_meta 字段传递错误。您需要将其更改为使用 WP_Error 类......这只是为了演示。

```
 // If there is an existing image, show it
    if($existing_image) {

        echo '<div>Attached Image ID: ' . $existing_image . '</div>';

    } 

    echo 'Upload an image: <input type="file" name="xxxx_image" id="xxxx_image" />';

    // See if there's a status message to display (we're using this to show errors during the upload process, though we should probably be using the WP_error class)
    $status_message = get_post_meta($post->ID,'_xxxx_attached_image_upload_feedback', true);

    // Show an error message if there is one
    if($status_message) {

        echo '<div class="upload_status_message">';
            echo $status_message;
        echo '</div>';

    }

    // Put in a hidden flag. This helps differentiate between manual saves and auto-saves (in auto-saves, the file wouldn't be passed).
    echo '<input type="hidden" name="xxxx_manual_save_flag" value="true" />';

}

function xxxx_setup_meta_boxes() {

    // Add the box to a particular custom content type page
    add_meta_box('xxxx_image_box', 'Upload Image', 'xxxx_render_image_attachment_box', 'post', 'normal', 'high');

}
add_action('admin_init','xxxx_setup_meta_boxes'); 
```

处理文件上传

这是最重要的——实际上是通过连接到 save_post 操作来处理文件上传。我在下面包含了一个被大量评论的函数，但我想注意它使用的两个关键 WordPress 函数：

wp_handle_upload() 完成了处理上传的所有魔法。您只需将 $_FILES 数组中的字段的引用和一组选项传递给它（不要太担心这些——您需要设置的唯一重要的选项是 test_form=false。相信我）。但是，此函数不会将上传的文件添加到媒体库。它只是进行上传并返回新文件的路径（以及，方便地，完整的 URL）。如果有问题，它会返回一个错误。

wp_insert_attachment() 将图像添加到媒体库，并生成所有适当的缩略图。您只需将一组选项（标题、帖子状态等）和本地路径（不是 URL）传递给您刚刚上传的文件。将图像放入媒体库的好处在于，您可以稍后通过调用 wp_delete_attachment 并将项目的媒体库 ID 传递给它（我在下面的函数中执行此操作）轻松删除所有文件。使用此函数，您还需要使用 wp_generate_attachment_metadata() 和 wp_update_attachment_metadata()，它们完全符合您的预期——为媒体项目生成元数据。

```
function xxxx_update_post($post_id, $post) {

    // Get the post type. Since this function will run for ALL post saves (no matter what post type), we need to know this.
    // It's also important to note that the save_post action can runs multiple times on every post save, so you need to check and make sure the
    // post type in the passed object isn't "revision"
    $post_type = $post->post_type;

    // Make sure our flag is in there, otherwise it's an autosave and we should bail.
    if($post_id && isset($_POST['xxxx_manual_save_flag'])) { 

        // Logic to handle specific post types
        switch($post_type) {

            // If this is a post. You can change this case to reflect your custom post slug
            case 'post':

                // HANDLE THE FILE UPLOAD

                // If the upload field has a file in it
                if(isset($_FILES['xxxx_image']) && ($_FILES['xxxx_image']['size'] > 0)) {

                    // Get the type of the uploaded file. This is returned as "type/extension"
                    $arr_file_type = wp_check_filetype(basename($_FILES['xxxx_image']['name']));
                    $uploaded_file_type = $arr_file_type['type'];

                    // Set an array containing a list of acceptable formats
                    $allowed_file_types = array('image/jpg','image/jpeg','image/gif','image/png');

                    // If the uploaded file is the right format
                    if(in_array($uploaded_file_type, $allowed_file_types)) {

                        // Options array for the wp_handle_upload function. 'test_upload' => false
                        $upload_overrides = array( 'test_form' => false ); 

                        // Handle the upload using WP's wp_handle_upload function. Takes the posted file and an options array
                        $uploaded_file = wp_handle_upload($_FILES['xxxx_image'], $upload_overrides);

                        // If the wp_handle_upload call returned a local path for the image
                        if(isset($uploaded_file['file'])) {

                            // The wp_insert_attachment function needs the literal system path, which was passed back from wp_handle_upload
                            $file_name_and_location = $uploaded_file['file'];

                            // Generate a title for the image that'll be used in the media library
                            $file_title_for_media_library = 'your title here';

                            // Set up options array to add this file as an attachment
                            $attachment = array(
                                'post_mime_type' => $uploaded_file_type,
                                'post_title' => 'Uploaded image ' . addslashes($file_title_for_media_library),
                                'post_content' => '',
                                'post_status' => 'inherit'
                            );

                            // Run the wp_insert_attachment function. This adds the file to the media library and generates the thumbnails. If you wanted to attch this image to a post, you could pass the post id as a third param and it'd magically happen.
                            $attach_id = wp_insert_attachment( $attachment, $file_name_and_location );
                            require_once(ABSPATH . "wp-admin" . '/includes/image.php');
                            $attach_data = wp_generate_attachment_metadata( $attach_id, $file_name_and_location );
                            wp_update_attachment_metadata($attach_id,  $attach_data);

                            // Before we update the post meta, trash any previously uploaded image for this post.
                            // You might not want this behavior, depending on how you're using the uploaded images.
                            $existing_uploaded_image = (int) get_post_meta($post_id,'_xxxx_attached_image', true);
                            if(is_numeric($existing_uploaded_image)) {
                                wp_delete_attachment($existing_uploaded_image);
                            }

                            // Now, update the post meta to associate the new image with the post
                            update_post_meta($post_id,'_xxxx_attached_image',$attach_id);

                            // Set the feedback flag to false, since the upload was successful
                            $upload_feedback = false;

                        } else { // wp_handle_upload returned some kind of error. the return does contain error details, so you can use it here if you want.

                            $upload_feedback = 'There was a problem with your upload.';
                            update_post_meta($post_id,'_xxxx_attached_image',$attach_id);

                        }

                    } else { // wrong file type

                        $upload_feedback = 'Please upload only image files (jpg, gif or png).';
                        update_post_meta($post_id,'_xxxx_attached_image',$attach_id);

                    }

                } else { // No file was passed

                    $upload_feedback = false;

                }

                // Update the post meta with any feedback
                update_post_meta($post_id,'_xxxx_attached_image_upload_feedback',$upload_feedback);

            break;

            default:

        } // End switch

    return;

} // End if manual save flag

    return;

}
add_action('save_post','xxxx_update_post',1,2); 
```

权限、所有权和安全性

如果您在上传时遇到问题，可能与权限有关。我不是服务器配置方面的专家，所以如果这部分有问题，请纠正我。

首先，确保您的 wp-content/uploads 文件夹存在，并且归 apache:apache 所有。如果是这样，您应该能够将权限设置为 744，并且一切都应该正常工作。所有权很重要——如果目录没有正确拥有，即使将 perms 设置为 777 有时也无济于事。

您还应该考虑限制使用 htaccess 文件上传和执行的文件类型。这可以防止人们上传不是图像的文件，以及执行伪装成图像的脚本。您可能应该在谷歌上搜索更多权威信息，但您可以像这样进行简单的文件类型限制：

```
<Files ^(*.jpeg|*.jpg|*.png|*.gif)>
order deny,allow
deny from all
</Files> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T19:18:32.943

将所有代码添加到 functions.php 文件中。然后在您想要的主题文件中进行函数调用。

例如，如果您想要在页面模板中，请拨打电话

```
<div> <?php fileupload('form'); ?> </div> 
```

# php - 数组中第一对数组的翻转顺序

> ID：12876049
> 
> 赞同：0
> 
> 时间：2012-10-13T19:03:08.780
> 
> 标签：php, arrays

我有一个如下所示的数组，在数组键“句点”下，您有一个包含四个数组的数组，您可以在其中看到它打开关闭，打开关闭，我希望它关闭打开，关闭打开，但是每对数组（打开和关闭）仍然需要以父数组格式保留它们的顺序。我真的希望这是有道理的！我一直在努力解决这个问题，但我似乎无法让它正确迭代并保持该顺序。

任何帮助都会非常感激。谢谢你。

```
array(1) {
  ["opening_hours"]=>
  array(1) {
    ["periods"]=>
    array(12) {
      [0]=>
      array(1) {
        ["open"]=>
        array(2) {
          ["day"]=>
          string(1) "1"
          ["time"]=>
          string(4) "0730"
        }
      }
      [1]=>
      array(1) {
        ["close"]=>
        array(2) {
          ["day"]=>
          string(1) "1"
          ["time"]=>
          string(4) "1200"
        }
      }
      [2]=>
      array(1) {
        ["open"]=>
        array(2) {
          ["day"]=>
          string(1) "1"
          ["time"]=>
          string(4) "1600"
        }
      }
      [3]=>
      array(1) {
        ["close"]=>
        array(2) {
          ["day"]=>
          string(1) "1"
          ["time"]=>
          string(4) "2345"
        }
      }
      [4]=>
      array(1) {
        ["open"]=>
        array(2) {
          ["day"]=>
          string(1) "2"
          ["time"]=>
          string(4) "0745"
        }
      }
      [5]=>
      array(1) {
        ["close"]=>
        array(2) {
          ["day"]=>
          string(1) "2"
          ["time"]=>
          string(4) "1200"
        }
      }
      [6]=>
      array(1) {
        ["open"]=>
        array(2) {
          ["day"]=>
          string(1) "2"
          ["time"]=>
          string(4) "1600"
        }
      }
      [7]=>
      array(1) {
        ["close"]=>
        array(2) {
          ["day"]=>
          string(1) "2"
          ["time"]=>
          string(4) "2345"
        }
      }
      [8]=>
      array(1) {
        ["open"]=>
        array(2) {
          ["day"]=>
          string(1) "3"
          ["time"]=>
          string(4) "0800"
        }
      }
      [9]=>
      array(1) {
        ["close"]=>
        array(2) {
          ["day"]=>
          string(1) "3"
          ["time"]=>
          string(4) "1200"
        }
      }
      [10]=>
      array(1) {
        ["open"]=>
        array(2) {
          ["day"]=>
          string(1) "3"
          ["time"]=>
          string(4) "1600"
        }
      }
      [11]=>
      array(1) {
        ["close"]=>
        array(2) {
          ["day"]=>
          string(1) "3"
          ["time"]=>
          string(4) "2345"
        }
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T19:16:35.643

我想相信你的阵列是这样的

```
$array = array(
        "opening_hours" => array(
                "periods" => array(
                        0 => array("open" => array("day" => "1","time" => "0730")),
                        1 => array("close" => array("day" => "1","time" => "1200")),
                        2 => array("open" => array("day" => "1","time" => "1600")),
                        3 => array("close" => array("day" => "1","time" => "2345")),
                        4 => array("open" => array("day" => "2","time" => "0745")),
                        5 => array("close" => array("day" => "2","time" => "1200")),
                        6 => array("open" => array("day" => "2","time" => "1600")),
                        7 => array("close" => array("day" => "2","time" => "2345")),
                        8 => array("open" => array("day" => "3","time" => "0800")),
                        9 => array("close" => array("day" => "3","time" => "1200")),
                        10 => array("open" => array("day" => "3","time" => "1600")),
                        11 => array("close" => array("day" => "3","time" => "2345"))))); 
```

交换位置

```
$final = array();
$total = count($array['opening_hours']['periods']);

for($i = 0; $i < $total; $i += 2) {

    if (isset($array['opening_hours']['periods'][$i + 1])) {
        $final[] = $array['opening_hours']['periods'][$i + 1];
    }

    $final[] = $array['opening_hours']['periods'][$i];
}

var_dump($final); 
```

输出

```
array
  0 => 
    array
      'close' => 
        array
          'day' => string '1' (length=1)
          'time' => string '1200' (length=4)
  1 => 
    array
      'open' => 
        array
          'day' => string '1' (length=1)
          'time' => string '0730' (length=4)
  2 => 
    array
      'close' => 
        array
          'day' => string '1' (length=1)
          'time' => string '2345' (length=4)
  3 => 
    array
      'open' => 
        array
          'day' => string '1' (length=1)
          'time' => string '1600' (length=4)
  4 => 
    array
      'close' => 
        array
          'day' => string '2' (length=1)
          'time' => string '1200' (length=4)
  5 => 
    array
      'open' => 
        array
          'day' => string '2' (length=1)
          'time' => string '0745' (length=4)
  6 => 
    array
      'close' => 
        array
          'day' => string '2' (length=1)
          'time' => string '2345' (length=4)
  7 => 
    array
      'open' => 
        array
          'day' => string '2' (length=1)
          'time' => string '1600' (length=4)
  8 => 
    array
      'close' => 
        array
          'day' => string '3' (length=1)
          'time' => string '1200' (length=4)
  9 => 
    array
      'open' => 
        array
          'day' => string '3' (length=1)
          'time' => string '0800' (length=4)
  10 => 
    array
      'close' => 
        array
          'day' => string '3' (length=1)
          'time' => string '2345' (length=4)
  11 => 
    array
      'open' => 
        array
          'day' => string '3' (length=1)
          'time' => string '1600' (length=4) 
```

# iphone - 这是ARC下的泄漏吗？

> ID：12876052
> 
> 赞同：3
> 
> 时间：2012-10-13T19:03:31.463
> 
> 标签：iphone, objective-c, ios, cocoa, automatic-ref-counting

我正在使用 ARC，在一种方法中我分配了一个操作对象。这会导致内存泄漏吗？如果是，我应该在哪里设置`nil`？在完成块内部或之后`[operation start];`？

```
AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];
[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
    // success downloading file
    // Do something
} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    // error downloading file
    // Do something else
}];

[operation start]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:30:15.323

没有泄漏。没关系。但是，通常，在块内引用`operation`会导致保留循环。但看起来 API 已经为您预料到了这一点并传递了一个可用的副本。我想您可以假设`operation`block 参数可以安全引用。

通常，如果您需要在块中引用块所有者，您将声明一个未保留的副本并改为引用它...

```
__unsafe_unretained BlockOwningClass *blockOwnerCopy = blockOwner;
[blockOwner doBlock:^{  NSLog(@"%@", blockOwnerCopy); }]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T20:07:47.820

不，在这种情况下，系统会为您处理内存管理，没有任何泄漏的风险。

# uiimage - 合并两个以上的图像会占用太多内存，为什么？

> ID：12876055
> 
> 赞同：0
> 
> 时间：2012-10-13T19:03:40.340
> 
> 标签：uiimage, instruments, cgcontext

我不明白为什么使用 GCContext 来绘制/合并两个以上的 UIImage 会占用这么多内存。我启用了 ARC，当在 Instruments 中查看我的程序内存使用情况时（使用 VM Tracker 工具），我看到下面的第一个解决方案仅使用两个图像的内存（大约 16 MB DirtySize 和 80 MB ResidentSize），而在 CGContext 中绘图使用我所有 UIImage 的内存量（大约 468 MB DirtySize 和 520 MB ResidentSize），最终导致我的应用程序崩溃。如何确保 CGContext 使用的内存量不超过两个 UIImage 使用的内存量？实际上，我喜欢实现一种双缓冲，以绘制具有相同大小的图像文件（基于.PNG，并且已经具有透明设置）的多个图层，同时具有最小的内存需求和最佳性能。

请注意，我的 ViewController 包含一个“UIImageView *imageView”和一个“CGSize imageSize”属性。

以下代码仅用于检查加载 UIImages 消耗的内存量：

```
- (void)drawUsingTwoUIImages1:(NSMutableArray *)imageFiles
{
    if ( ! imageFiles.count ) {
        return;
    }
    NSString *imageFile1 = [imageFiles objectAtIndex:0];
    NSString *filePath1 = [[NSBundle mainBundle] pathForResource:imageFile1 ofType:nil];
    UIImage *image1 = [UIImage imageWithContentsOfFile:filePath1];
    UIImage *image2 = nil;
    image1 = [UIImage imageWithContentsOfFile:filePath1];
    for (NSInteger index = 1; index < imageFiles.count; index++) {
        NSString *imageFile2 = [imageFiles objectAtIndex:index];
        NSString *filePath2 = [[NSBundle mainBundle] pathForResource:imageFile2 ofType:nil];
        image2 = [UIImage imageWithContentsOfFile:filePath2];
    }
} 
```

我想在我的最终应用程序中使用的下一个代码，以显示所有绘制的图像文件。我怀疑需要按照 CGContext 处理的顺序或者可能是 CGLayerRef 的顺序来完成一些巧妙的技巧。如果有人能告诉我如何做到这一点，或者想出工作代码，我将再次进入编码天堂！

```
- (void)drawUsingTwoUIImages2:(NSMutableArray *)imageFiles
{
    _imageView.image = nil;
    if ( ! imageFiles.count ) {
        return;
    }
    NSString *imageFile1 = [imageFiles objectAtIndex:0];
    NSString *filePath1 = [[NSBundle mainBundle] pathForResource:imageFile1 ofType:nil];
    UIImage *image1 = [UIImage imageWithContentsOfFile:filePath1];
    UIImage *image2 = nil;
    for (NSInteger index = 1; index < imageFiles.count; index++) {
        if ( ! UIGraphicsGetCurrentContext() ) {
            UIGraphicsBeginImageContext(_imageSize);
        }
        NSString *imageFile2 = [imageFiles objectAtIndex:index];
        NSString *filePath2 = [[NSBundle mainBundle] pathForResource:imageFile2 ofType:nil];
        image2 = [UIImage imageWithContentsOfFile:filePath2];
        [image1 drawAtPoint:CGPointMake(0., 0.)];
        [image2 drawAtPoint:CGPointMake(0., 0.)];
        image1 = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();
    }
    _imageView.image = image1;
} 
```

以上真的让我发疯了，有没有人在这里看到我缺少的东西，或者知道该怎么做才能获得最大的性能和最小的内存使用？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T15:26:08.127

I already figured out that the way to go is using CATiledLayer and where needed tile your image data in various scale-sizes. Digging around in Apple's example code and searching in StackOverflow helped me to solve this issue.

# c# - 如何检测是否未选择 ComboBox 上的选定项目？

> ID：12876056
> 
> 赞同：16
> 
> 时间：2012-10-13T19:03:49.263
> 
> 标签：c#, windows, combobox

在我的 ComboBox 中，在用户单击它并选择任何项目之前，该字段是空白的。因此，如果没有用户单击 ComboBox，它仍然是空的。我们如何检查 ComboBox 是否为空？

此代码给我一个错误，因为还没有选择项目：

```
if( ComboBox.SelectedItem.ToString().Equals("") )
{
     //do something
} 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-10-13T19:12:01.890

```
if( ComboBox.SelectedItem == null ) {
   // do something
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-13T19:06:27.847

```
ComboBox.SelectedItems.Count 
```

这应该有效：P 它计算选定的项目。如果该数字为 0，则不选择任何项目。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-01-22T08:37:53.033

```
if( ComboBox.SelectedIndex == -1 ) 
```

# php - 如何将 CSS 和 HTML 转换为 PDF

> ID：12876057
> 
> 赞同：-1
> 
> 时间：2012-10-13T19:03:52.747
> 
> 标签：php, javascript, html, css

> **可能重复：**
> [使用 PHP 将 HTML + CSS 转换为 PDF？](https://stackoverflow.com/questions/391005/convert-html-css-to-pdf-with-php)

好吧，我绝不是程序员，但我精通 HTML 和 CSS，即使你是平面设计师，我也知道一些 javascript。

我想制作一个小型网络应用程序，这样客户就可以制作自己的名片，而无需每次新员工到来时都依赖我。

程序很简单，客户只需要输入员工的姓名和工作职位，提交它就会使用我预先建立的设计生成带有新卡的 PDF。

我想我可以用 CSS、HTML 和一点 Javascript 或 PHP 来完成在卡片中插入数据的部分吗？

但是如何将页面转换为可打印的 PDF？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:05:25.660

有用于从 HTML + CSS 生成 PDF 的[TCPDF](http://www.tcpdf.org/)。

> **TCPDF**是一个 PHP 类，用于在不需要外部扩展的情况下生成 PDF 文档。TCPDF 支持 UTF-8、Unicode、RTL 语言、XHTML、Javascript、数字签名、条形码等等。

# events - AngularJs ng-click 事件仅由文字参数触发

> ID：12876059
> 
> 赞同：10
> 
> 时间：2012-10-13T19:04:08.873
> 
> 标签：events, click, angularjs

当我在 ng-repeat 组中调用时

`<span ng-click="remove({{user.id}})">Delete</span>`

**不**调用**删除**函数_

 **但是当我用文字参数替换表达式时，它会被调用（正常工作）：

`<span ng-click="remove(123)">Delete</span>`

'{{user.id}}' 表达式被正确评估并且只有整数值。

有人知道发生了什么吗？锚标签（带有 href=""）也是如此。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-10-13T19:37:19.777

`ng-click="remove(user.id)"`应该工作，ng-click评估它的内容，所以你不需要插值

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-13T19:37:53.357

您不应该在 ng-click 表达式中使用花括号。试试这个：

```
<span ng-click="remove(user.id)">Delete</span> 
```

并且一定要检查 AngularJS 表达式文档：[http ://docs.angularjs.org/guide/expression](http://docs.angularjs.org/guide/expression)**

# linux - Linux - 如何在文件中搜索单词并打印它们出现的次数？

> ID：12876064
> 
> 赞同：1
> 
> 时间：2012-10-13T19:05:03.317
> 
> 标签：linux, bash, shell

我需要搜索一个目录 ARCHIVE，其中包含许多子目录，每个子目录都包含文件。每个文件中都有一个电子邮件地址。我想列出所有的电子邮件地址，并截断@blah.com，然后列出每个名称的出现次数。

我想出了如何找到电子邮件并截断 @ 部分，但我不知道如何计算每个名字出现的次数。

```
grep -R '^To: ' $ARCHIVE | cut -d@ -f1 | awk  '{print $2}' | sort | uniq 
```

同样由于某种原因，我无法让它在脚本中工作；每当我调用它时它什么都不做，但是如果我把它放在命令行中它就可以工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:36:56.747

Grep 有一个计数选项。

如果您设备的正则表达式功能强大到可以直接匹配电子邮件，您可以使用一个命令计算所有出现次数：

例如

```
$ echo -e "1\n\2\n3\n\4" | grep [0-9] -c
4 
```

也就是说，我认为你正在做的最好是使用 sed 和 awk：

```
sed 's/@.*//' tmp/mails | sort | uniq   | \
while read name ;
do 
   echo $name; 
   awk '$1 ~ /'$name'/ { ++c; } END {print c;}' tmp/mails ;
done

cat tmp/mails:
$ cat tmp/mails 
arne@gmail.com
arnt@treemail.com
jonas@hotmail.com
arne@gmail.com
kari@yahoo.no
alex@wee.moo
arne@gmail.com
jonas@hotmail.com
kari@yahoo.no
jonas@hotmail.com
kari@yahoo.no 
```

* * *

```
$  sed 's/@.*//' tmp/mails | sort | uniq   | while read name ;do echo $name; awk '$1 ~ /'$name'/ { ++c; } END {print c;}' tmp/mails ;done 
alex
1
arne
3
arnt
1
jonas
3
kari
3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T19:48:38.157

因此，通过我们长时间的评论对话，我会这样做：

```
grep -R '^To: ' $ARCHIVE | cut -d@ -f1 | awk  '{print $2}' | sort | uniq -c > ind.txt && wc -l ind.txt >> ind.txt 
```

这将获取`uniq`命令的输出，将其写入文件，然后收集总计并将其附加到同一文件中，以便您在底部查看。

或者正如 Geoff 指出的那样，你可以做到`uniq -c file.txt | awk '{print}END{print NR}'`。

# security - Java EE 6 应用程序中的 OpenID - 如何获取用户的 Principal 对象

> ID：12876065
> 
> 赞同：5
> 
> 时间：2012-10-13T19:05:05.563
> 
> 标签：security, jakarta-ee, servlets, jaspic

我第一次在我的应用程序中使用 OpenID 身份验证。我可以针对所选提供者成功验证用户身份，但我不知道如何在 Java EE 服务器上正确登录用户，因此看起来用户已使用例如基于表单的登录方式登录。我可以使用 Servlet 3.0 `login`，但它需要用户名/密码对，并且在使用 OpenID 时我没有密码。

我希望能够获得一个`Principal`对象并使用`isUserInRole`方法等。我错过了什么吗？我在 JBoss 7.1 上运行这个应用程序，但我想应该有一个通用的方法来做到这一点。或者，也许我遗漏了一些东西，`Principal`并且在使用 OpenID 时，所有与用户角色相关的东西都以不同的方式完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-04T13:34:37.180

> 我想应该有一个通用的方法来做到这一点。

确实有。您需要创建一个所谓的 JASPIC 身份验证模块。已经有一个可用于 OpenID，请参阅：

*   [http://www-02.imixs.com/roller/ralphsjavablog/entry/openid_serverauthmodule_jsr_196_with](http://www-02.imixs.com/roller/ralphsjavablog/entry/openid_serverauthmodule_jsr_196_with)
*   [http://code.google.com/p/openid4java-jsr196](http://code.google.com/p/openid4java-jsr196)

> 我可以使用 Servlet 3.0 登录，但它需要用户名/密码对，并且在使用 OpenID 时我没有密码。

这是正确的。因此，您需要调用 Servlet 3.0[验证](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#authenticate%28javax.servlet.http.HttpServletResponse%29)方法。因为`login`与用户名/密码密切相关，当您定义自己的身份验证模块时，它甚至会在 Java EE 7 中引发异常！（在 Java EE 6 中未定义会发生什么，但它通常不起作用）。

有关如何在 Java EE 中创建类似 OpenID 的身份验证模块的更多示例，请参阅我自己的项目[OmniSecurity](http://omnisecurity.omnifaces.org)和使用该项目早期版本的[实际应用程序。](http://jdevelopment.nl/open-source/java-ee-kickoff-app)*（不幸的是，代码有点难以理解，因为它需要一个极其复杂和令人费解的解决方法才能让 CDI 与 JASPIC SAM 一起工作，但希望它仍然能让您看到一般模式）*

# jquery - 将 onclick 添加到 json 生成的表中

> ID：12876066
> 
> 赞同：2
> 
> 时间：2012-10-13T19:05:09.267
> 
> 标签：jquery, json

我有一个从数据库解析的 JSON 数组。

```
$.getJSON(… , 
```

数据被迭代，`$.each`然后按名称放入 table1。

```
function(geojson) {
    $.each(geojson.features, function(i, feature) {
        var id = feature.properties.id;
        var name = feature.properties.name;
        var otherDetails = feature.properties.otherDetails;

        // Populate table1 with clickable links
        $("#table1 table").append('<tr><td><a href="#" onclick="['+id+']; return false;">'+name+'</a></td></tr>')
            //populate table2 with name
            .click(function(){
                $("#table2 table").append('<tr><td><a">'+name+' '+otherDetails+'</a></td></tr>')
        })
    });
}); 
```

这一切都很棒，正是我想要的。表中的每个功能“名称”都是可单击的，我希望在单击时另一个表（table2）仅填充一条记录的“名称”和“其他详细信息”。上面的代码几乎让我到了那里，但打算用单击的功能名称填充 table2，它用几乎是 table1 的副本的完整功能数组填充 table2，我认为因为它仍然在`$.each`. 如何停止嵌套追加中的 .each 迭代？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:12:45.953

事件`click`处理程序在级别上得到应用`table`，如此反复。尝试将其应用于行，如下所示：

```
 // Populate table1 with clickable links
 var newRow = $('<tr><td><a href="#" onclick="['+id+']; return false;">'+name+'</a></td></tr>');
 $("#table1 table").append(newRow);
 $(newRow).click(function(){
     $("#table2 table").append('<tr><td><a">'+name+' '+otherDetails+'</a></td></tr>')
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T19:12:04.817

将单击处理程序添加到 table1 的行。单击时，拉出名称以放入 table2 的新行中。

```
$('#table1 table').on('click', 'tr', function()
{
    var name = $(this).find('a').text();
    $('#table2 table').append('<tr><td><a">' + name + '</a></td></tr>');
}); 
```

维护数据的另一种方法是使用[数据属性](http://api.jquery.com/data/)。这也将允许您使用 otherinfo 数据。

# c - 检查数字中的偶数或奇数“1”位

> ID：12876067
> 
> 赞同：4
> 
> 时间：2012-10-13T19:05:08.970
> 
> 标签：c, bitwise-operators, bit, logical-operators

我想检查 number 是否将所有偶数位或奇数位设置为一个且只有它们。例如：

数字`42`是正确的，因为在二进制代码中`101010`，它的所有且只有偶数位设置为`1`。数`21`也对，`10101`。

`69`例如，数字。`1000101`是不正确的，因为只有三个奇数位设置为`1`。

我尝试过使用不同的操作，`^, &, >>, <<`但我仍然不知道如何使用这些操作符来做到这一点。是的，我需要在`C`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-13T19:28:07.393

这些数字具有 2 的幂的性质`(x ^ (x >> 1)) + 1`。`y`如果是 2 的幂`y & (y - 1) == 0`

因此，一项测试可能`((x ^ (x >> 1)) + 1) & (x ^ (x >> 1)) == 0`适用于任何大小的数字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-13T19:19:34.853

```
#include <stdio.h>

int main(void)
{
    unsigned uu;

    for (uu=0; uu < 43; uu++ ) {
        int res;
        res = (((uu & 0xAAAAAAAA) == uu) || ((uu & 0x55555555) == uu) );
        printf("%u: %d\n", uu, res);
    }
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T19:15:00.653

```
bool isEven(int n){
   bool isEven = true;
   while(n){
      if( n & 1 ){
          isEven = !isEven;
      }
      n = n >> 1;
   }

   return isEven;
} 
```

只要 n 为 != 0，while(n) 就会继续，它仍然有一个。如果第一位是一个，那么我们将偶数参数更改为相反的（偶数变为奇数，反之亦然），在每次迭代中，我们将第一个位向右移动。

# python - 如何使用 Emperor Mode 在 uWSGi 上部署 Bottle 应用

> ID：12876069
> 
> 赞同：1
> 
> 时间：2012-10-13T19:05:18.437
> 
> 标签：python, nginx, uwsgi

我正在尝试在 Emperor 模式下使用 uWSGi 部署一个 Bottle App。

演示.py

```
import os
from bottle import Bottle, route, run

app=Bottle()

@app.route('/index')
def index():
    return "Hello world! "

@app.route('/:name')
def hello(name):
    return "hello %s" % name

# Mod WSGI launch
os.chdir(os.path.dirname(file))
application = bottle.default_app() 
```

演示.ini

```
[uwsgi]
# Variables
base = /opt/apps/webapp/demo
app = demo
# Geneic Config
plugins=http,python
home = /opt/apps/webapp/demo
pythonpath=%(base)
socket = /tmp/%n.sock
module = %(app)
logto = /var/log/uwsgi/%n.log 
```

日志文件中的输出

```
gracefully (RE)spawned uWSGI master process (pid: 2414)
spawned uWSGI worker 1 (pid: 2646, cores: 1)
[pid: 2646|app: -1|req: -1/1] 10.0.0.240 () {40 vars in 688 bytes} [Sat Oct 13 15:00:00 2012] GET /demo => generated 48 bytes in 0 msecs (HTTP/1.1 500) 2 headers in 63 bytes (0 switches on core 0)
announcing my loyalty to the Emperor...
[pid: 2646|app: -1|req: -1/2] 10.0.0.240 () {40 vars in 688 bytes} [Sat Oct 13 15:00:05 2012] GET /demo => generated 48 bytes in 0 msecs (HTTP/1.1 500) 2 headers in 63 bytes (0 switches on core 0)
[pid: 2646|app: -1|req: -1/3] 10.0.0.240 () {42 vars in 719 bytes} [Sat Oct 13 15:00:26 2012] GET /demo => generated 48 bytes in 0 msecs (HTTP/1.1 500) 2 headers in 63 bytes (0 switches on core 0) 
```

但是在浏览器上我仍然看到这个错误

```
uWSGI Error

Python application not found 
```

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T04:38:48.327

我终于找到了答案，这似乎是一个愚蠢的错误。我在打电话

```
http://localhost/demo 
```

应该在哪里

```
http://localhost/demo/demo 
```

IE

```
http://localhost/{app_name}/{route_name} 
```

# regex - htaccess 根据前两个后两个字符重写规则

> ID：12876070
> 
> 赞同：2
> 
> 时间：2012-10-13T19:05:21.007
> 
> 标签：regex, .htaccess, mod-rewrite

对于所有正则表达式专家来说，这应该相当容易，但是我们遇到了问题。

我们犯了一个错误，允许人们将图像上传到一个文件夹。现在我们被困在一个文件夹中的 150k jpg 图像中，这大大降低了我们的服务器速度。

人们仍然可以上传到这个文件夹（实时站点），我们需要慢慢解决这个问题。这个想法是将文件移动到这样的子文件夹：

`/jpg/121765_180x135.jpg` 至 `/jpg/12/17/121765_180x135.jpg`

前两个/后两个字符/file.jpg

问题是少于 4 个字符的文件应该留在原处

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T03:54:11.510

重写`/jpg/121765_180x135.jpg`为`/jpg/12/17/121765_180x135.jpg`：

```
RewriteEngine On
RewriteRule ^/?jpg/([0-9]{2})([0-9]{2})(.*)\.jpg$ /jpg/$1/$2/$1$2$3.jpg [L] 
```

另一种方式：

```
RewriteEngine On
RewriteRule ^/?jpg/[0-9]{2}/[0-9]{2}/(.*)\.jpg$ /jpg/$1.jpg [L] 
```

这些规则要么进入你的虚拟主机/服务器配置，要么进入你的文档根目录中的 htaccess 文件。

# c - argv 是如何填充的？

> ID：12876071
> 
> 赞同：1
> 
> 时间：2012-10-13T19:05:21.620
> 
> 标签：c, arrays, string, pointers, argv

```
#include <stdio.h>

int main(int argc, char* argv[]){
  printf("argc: %d\n",argc);
  for(int i=0;i<sizeof(argv);i++){
    printf("argv[%d] %s\n",i,argv[i]);
  }
  return(0);
} 
```

在 GNU/linux 发行版下的 gnome 终端下使用它时编译得很好

```
printTest one\ two three
argc: 3
argv[0] /data/local/tmp/printTest
argv[1] one two
argv[2] three
argv[3] (null) 
```

我故意留下一个空白空间，而 argv 似乎表现得很奇怪。

这种行为正常吗？那是什么 null ？为什么 argv 创建一个空指针而不是仅仅提供一个较短的数组？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-13T19:11:13.567

`sizeof(argv)`是没有意义的——它是一个指针的大小（在你的平台上是 4 个），在这种情况下，它恰好比值的数量多一`argv`。

请改用`argc`此处。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-13T19:16:16.557

> 这种行为正常吗？

是的，一点没错。`one\ two`指定您希望这是一个参数。

> 那是什么 null ？为什么 argv 创建一个空指针而不是仅仅提供一个较短的数组？

它显示了数组的结尾，并且是标准要求的。它可以遍历所有不使用的参数`argc`，例如：

```
while (*++argv) {
    // do something
} 
```

但是正如duskwuff 指出的那样，您的代码中也有错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-13T19:16:33.803

您不应该使用`sizeof(argv)`：您只会获得系统上指针的大小，*而不是*参数的数量。

另请注意，这`argv[argc]`是`NULL`根据规范：无论您的转义空间或参数数量如何，都会有一个`NULL`at 。`argv[argc]`

从*5.1.2.2.1/2*开始：

> argv[argc] 应该是一个空指针。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-13T19:16:57.283

这是为了支持典型的 C-ish 习惯用法：

```
for (char** arg = argv + 1; *arg; arg++)
{
    // process next arg 
```

如您所见，`argv`它是以 0 结尾的字符串数组。

将输入拆分为单独的参数是由 shell 完成的，语言没有定义它。

# ruby-on-rails - Ruby 路由并不总是以相同的顺序

> ID：12876079
> 
> 赞同：0
> 
> 时间：2012-10-13T19:06:24.770
> 
> 标签：ruby-on-rails, routes

我的`routes.rb`文件中有这个：

```
resources :carts do
    collection do
      post :review
      post :charge
    end
end 
```

有时，当用户转到 时`/carts/review`，不是转到`review`操作，而是尝试`show`使用`id`of转到`review`。我在生产中遇到了 3 次此错误，并成功审查了购物车数十次。关于可能发生的事情有什么想法吗？

这是在带有 ruby​​ 1.9.1 的 Ubuntu 10.04 上运行的 Rails 3.2.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:14:34.850

您的路线仅`POST`接受`/carts/review`. A `GET`to`/carts/review`将被解释为`/carts/:id, :id => "review"`因为没有明确的`GET`路径`/carts/review`。

# python - 按字典值排序字典列表

> ID：12876082
> 
> 赞同：2
> 
> 时间：2012-10-13T19:09:33.387
> 
> 标签：python, list, python-2.7

晕，想按值对字典列表进行排序：

```
a = [{'cavity' : '11A', 'ltg_nr' : 'Ltgnr11A'},
        {'cavity' : '20', 'ltg_nr' : 'Ltgnr20'},
        {'cavity' : '10', 'ltg_nr' : 'Ltgnr10'},
        {'cavity' : '17B', 'ltg_nr' : 'Ltgnr17B'},
        {'cavity' : '1K', 'ltg_nr' : 'Ltgnr1K'},
        {'cavity' : '11A', 'ltg_nr' : 'Ltgnr11A'},
        {'cavity' : '11A', 'ltg_nr' : 'Ltgnr11A'},
        {'cavity' : '22', 'ltg_nr' : 'Ltgnr22'},
        {'cavity' : '21A', 'ltg_nr' : 'Ltgnr21A'},
        {'cavity' : '21C', 'ltg_nr' : 'Ltgnr21C'},
        {'cavity' : '21B', 'ltg_nr' : 'Ltgnr170'},
        {'cavity' : '101', 'ltg_nr' : 'Ltgnr170'},
        {'cavity' : '22AA', 'ltg_nr' : 'Ltgnr170'},
        {'cavity' : '100A', 'ltg_nr' : 'Ltgnr170'}]
newList= sorted(a, key=lambda k: (len(k['cavity']),k['cavity']) )
print "-"*20 + ' sorted ' + "-"*20
for k in newList:
    print k['cavity'] 
```

结果不是我例外：

```
C:\Python27>python.exe test_dict.py
-------------------- sorted --------------------
10
1K
20
22
101
11A
11A
11A
17B
21A
21B
21C
100A
22AA 
```

我将首先按数字排序，然后按字母字符排序。我怎样才能做到这一点 ：

```
1K
10
11A
11A
11A
17B
20
21A
21B
21C
22
22AA
100A
101 
```

欢迎所有建议 :) 感谢 Piotr

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T19:51:01.350

使用[natural_key() 函数](https://stackoverflow.com/a/341745/4279)：

```
import re

def natural_key(astr):
    """See http://www.codinghorror.com/blog/archives/001018.html"""
    return [int(s) if re.match(r'\d+$', s) else s
            for s in re.split(r'(\d+)', astr)]

sorted_list = sorted(a, key=lambda d: natural_key(d['cavity'])) 
```

### [结果](http://ideone.com/dtm5r)

```
[{'cavity': '1K', 'ltg_nr': 'Ltgnr1K'},
 {'cavity': '10', 'ltg_nr': 'Ltgnr10'},
 {'cavity': '11A', 'ltg_nr': 'Ltgnr11A'},
 {'cavity': '11A', 'ltg_nr': 'Ltgnr11A'},
 {'cavity': '11A', 'ltg_nr': 'Ltgnr11A'},
 {'cavity': '17B', 'ltg_nr': 'Ltgnr17B'},
 {'cavity': '20', 'ltg_nr': 'Ltgnr20'},
 {'cavity': '21A', 'ltg_nr': 'Ltgnr21A'},
 {'cavity': '21B', 'ltg_nr': 'Ltgnr170'},
 {'cavity': '21C', 'ltg_nr': 'Ltgnr21C'},
 {'cavity': '22', 'ltg_nr': 'Ltgnr22'},
 {'cavity': '22AA', 'ltg_nr': 'Ltgnr170'},
 {'cavity': '100A', 'ltg_nr': 'Ltgnr170'},
 {'cavity': '101', 'ltg_nr': 'Ltgnr170'}] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T19:34:36.400

您走在正确的轨道上，但主键可能不应该是`len(k['cavity'])`. 那只会考虑字符串的长度。

我认为您需要提取数字组件并具体对其进行排序：

```
import re

sorted(a, key=lambda k: (int(re.sub(r'[A-Z]+$', '', k['cavity'])), k['cavity']) )

[{'cavity': '1K', 'ltg_nr': 'Ltgnr1K'},
 {'cavity': '10', 'ltg_nr': 'Ltgnr10'},
 {'cavity': '11A', 'ltg_nr': 'Ltgnr11A'},
 {'cavity': '11A', 'ltg_nr': 'Ltgnr11A'},
 {'cavity': '11A', 'ltg_nr': 'Ltgnr11A'},
 {'cavity': '17B', 'ltg_nr': 'Ltgnr17B'},
 {'cavity': '20', 'ltg_nr': 'Ltgnr20'},
 {'cavity': '21A', 'ltg_nr': 'Ltgnr21A'},
 {'cavity': '21B', 'ltg_nr': 'Ltgnr170'},
 {'cavity': '21C', 'ltg_nr': 'Ltgnr21C'},
 {'cavity': '22', 'ltg_nr': 'Ltgnr22'},
 {'cavity': '22AA', 'ltg_nr': 'Ltgnr170'},
 {'cavity': '100A', 'ltg_nr': 'Ltgnr170'},
 {'cavity': '101', 'ltg_nr': 'Ltgnr170'}] 
```

我使用的正则表达式有点具体。它期望大写 AZ 字母可以从每个`cavity`. 我基于你的数据集。`cavity`如果不是，可能需要更改`<numbers><optional letters>`

# javascript - 无法使用 RequireJs 加载 Dojo 模块

> ID：12876085
> 
> 赞同：2
> 
> 时间：2012-10-13T19:11:06.467
> 
> 标签：javascript, module, dojo, requirejs, amd

我想我缺少一些东西。我读过你可以使用 RequireJS 来使用 dojo 模块，而不是使用 Dojo 加载器。我对 RequireJS 和定义模块很满意，但我似乎无法弄清楚发生了什么。我查看了 dojo js 文件，发现它们使用的 define() 与我声明自己的模块时一样。我的文件是这样组织的

```
// File path
-js
    main.js
    - lib
        .require.js
        -dojo
            // All dojo files 
```

我不确定我缺少什么，但是当我尝试加载 Dojo 模块时，该值未定义。下面是一些示例 HTML：

```
// index.html
<html>
    <head>
    </head>
    <body>
        // include require script & set main.js
        <script data-main="js/main" src="js/lib/require.js"></script>
    </body>
</html> 
```

和一个示例 main.js 文件...

```
 // Sample main.js file

    // BaseUrl = js/

    require.config({
        packages : [
            name     : 'dojo',
            location : 'lib/dojo';
        ]
    });

    require(['dojo', 'dojo/dom'], function(dojo, dom) {

        // 'dojo'     should load dojo/main.js
        // 'dojo/dom' should load dojo/dom.js

        // But they have a value of "undefined" when I look at them in the console
        console.log(dojo);
    }); 
```

任何想法我做错了什么？作为旁注，有时我会在控制台中收到此错误

```
TypeError: _3.add is not a function
[Break On This Error]   

_3.add("dom-addeventlistener",!!document.addEventListener); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-13T13:23:44.953

`_3.add("dom-addeventlistener",!!document.addEventListener);`实际上是`has.add("dom-addeventlistener", !!document.addEventListener);`

该错误`_3.add is not a function`是由于 requirejs 与 dojo 的 AMD 实现不同，它没有定义 has.js API 造成的。Dojo 尝试从 AMD 加载程序中提取 has.js 实现。如果使用外部加载器，则必须通过 dojoConfig 指明。运行缩小构建时，您需要添加`staticHasFeatures` 到构建配置文件：

```
staticHasFeatures: {
    "dojo-has-api": 0 // default 1
} 
```

这样做已经为我解决了这个问题。

[更多信息](https://github.com/dojo/dojo/blob/master/has.js)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-15T08:13:30.533

将所有的 dojo 文件放在 js 文件夹中。

你的文件夹结构应该像

```
// Folder structure
-js
    -dojo
    -dijit
    -dojox 
```

注意：确保您提供对 js/* 路径的访问权限。这样 url : [http://localhost:8080/app/js/dojo/dojo.js](http://localhost:8080/app/js/dojo/dojo.js)可以访问。

然后使用下面的脚本使用 requireJS 添加 dojo 模块，

```
setTimeout(

    function() {
        var dojoConfig = {
            async : true
        };

    require.config({
        packages : 
            [ {
                name : 'dojo',
                location : '../js/dojo'
            } ],    
    });

    require(
        [ 'dojo', 'dojo/dom' ],
        function(dojo, dom) {
            console.log(dojo);
            dom.byId("myDiv").innerHTML = "updatedHTML content";
    });

}, 1000); 
```

而已。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T19:16:57.203

首先，您的包配置定义是一个对象数组：

```
require.config({
    packages : [
        {
            name     : 'dojo',
            location : 'lib/dojo';
        }
    ]
}); 
```

之后，您应该检查您的 devtools 网络选项卡，以确保 require.js 正在加载正确的文件并且路径正确。请记住，这`location`是相对于`baseUrl`.

希望这有帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-09T21:48:14.910

`_3`表示您正在使用缩小的、独立的 dojo 发行版。如果您想将 Dojo 与不同的加载器一起使用，我相信您想使用从[他们的下载页面](http://dojotoolkit.org/download/)下载的 Source/SDK 。

# android - 如何在android中解析这个JSON数组？

> ID：12876091
> 
> 赞同：-1
> 
> 时间：2012-10-13T19:11:42.617
> 
> 标签：android, arrays, json

> **可能重复：**
> [在 Android 中发送和解析 JSON](https://stackoverflow.com/questions/2818697/sending-and-parsing-json-in-android)

**编辑**：最后我找到了一个答案，可以通过使用来获取没有键值的数组值`Iterator`。我刚刚从这个[链接得到了一个想法](https://stackoverflow.com/questions/8515018/getting-the-string-value-from-a-json-arrays-object-in-java)

我只是 JSON 解析的新手，我不知道如何解析这种类型`JSONArray`。谁能给我一个提示？

```
{

 "pages": [
      "image1.jpg",
      "image2.jpg"
  ]
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:12:48.550

您必须了解 JSON 的基本概念。

`{}`谈论一个实例（称为 JSONObject） `[]`谈论一个数组（在 Android 中称为 JSONArray） `"xxx":"yyy"`谈论 key & value

首先，你可以让回复的 json 字符串变成一个 JSONObject，`JSONObject replyJSON = new JSONObject(reply)`

然后，在回复的 JSONObject 中获取名为“pages”的 JSONArray， `JSONArray pagesArray = replyJSON.getJSONArray("pages")`

最后，通过方法获取 JSONArray 中的值`getString`，在您的示例中，您可以使用 pagesArray.getString(0) 和 pagesArray.getString(1)

查看文档以获取更多详细信息： [JSONArray](http://developer.android.com/reference/org/json/JSONArray.html#getJSONObject%28int%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T19:18:43.793

使用`new JSONObject(json)`；其中 json 是存储 json 字符串的变量。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-13T19:15:20.943

使用 JQuery 函数`parseJSON`：

```
var json = jQuery.parseJSON(string); 
```

# javascript - 站点导航之间的持久聊天栏

> ID：12876092
> 
> 赞同：0
> 
> 时间：2012-10-13T19:11:45.627
> 
> 标签：javascript, asp.net-mvc, navigation

我想要一个与 Facebook 非常相似的聊天 - 每当您浏览 facebook 时，用户都不会看到任何令人耳目一新的聊天！

您可以在其中一些打开时进行多个聊天，并且当您导航时，您不会注意到该区域的任何更改或加载。

我想为我的聊天获得相同的效果。通常是否从服务器取回信息需要更多时间。

我也想知道我应该在哪里保存当前打开的聊天信息——在数据库、cookie、localStorage 或其他地方。我猜数据库是合适的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:47:43.667

您可以将当前聊天数据保存到数据库（服务器）和本地存储（浏览器）中。准备好文档后，您可以查询本地存储以加载最近的讨论，并在加载这些讨论后检查服务器是否存在用户更改页面时可能出现的新消息。因为本地存储有它的限制，你必须删除旧的聊天行。

# mysql - MySQL INSERT IGNORE / ON DUPLICATE KEY UPDATE 未检测到重复项

> ID：12876104
> 
> 赞同：0
> 
> 时间：2012-10-13T19:12:42.150
> 
> 标签：mysql, duplicates

我在这里遇到了一个问题，经过 2 小时的谷歌搜索 Stackoverflow 答案和测试不同的想法后，我无法弄清楚。希望这对外面的人来说是一件轻而易举的事。

**编辑：固定！请参阅下面的解决方案。**

*这是我的代码：*

```
// Establish Table and vars
mysql_query("CREATE TABLE IF NOT EXISTS pages(page varchar(255), content varchar(255))");
$page = 'Hello'; $content = 'This is the content.';

// Ive tried this:
mysql_query("INSERT INTO pages SET page='$page' ON DUPLICATE KEY UPDATE content='$content'");

// Ive also tried:
mysql_query("INSERT IGNORE INTO pages SET page='$page', content='$content'"));
mysql_query("INSERT IGNORE INTO pages SET page='$page'")); // No content 
```

*预期结果：*创建一行，其 'page' 值为 'Hello'（'content' 值为 'This is the content.'）。当脚本第二次运行时，不会创建额外的行，因为已经有一行 'page' 值为 'Hello'。

*观察到的结果：*每次运行脚本时，都会创建一个页面值为“Hello”的新行，假设这不是重复键。为什么不买？我尝试创建一个 ID 字段为 AUTO_INCREMENT 和主键的表，但我认为这是导致问题的原因，所以我对其进行了简化。

*（那个代码是：）*

```
mysql_query("CREATE TABLE IF NOT EXISTS pages(id INT AUTO_INCREMENT NOT NULL, page varchar(255), content varchar(255), primary key (id))"); 
```

*预期结果：*如果没有“页面”字段为“Hello”的行，则应将新行插入表中。一旦这被创建，再次运行相同的脚本不应该导致一个新的行。

谢谢！

**编辑：固定！请参阅下面的解决方案。**

我的解决方案：

```
// Table needs a primary key to search for duplicates.
    mysql_query("CREATE TABLE IF NOT EXISTS pages(page varchar(255), content varchar(255), primary key (page))"); // Establish Table 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T19:16:43.957

您的`page`字段必须是 PRIMARY KEY 或具有唯一索引才能使 ON DUPLICATE KEY UPDATE 起作用。尝试：

```
CREATE TABLE IF NOT EXISTS pages(page varchar(255), content varchar(255), primary key (page)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T19:17:28.333

正如查询所说......在重复的**KEY**上。仅当插入违反表上的唯一约束时才会触发。如果没有键，数据库将不会扫描整个表以查看是否有重复。

# android - 如果再次单击当前选项卡，则重新加载片段？

> ID：12876106
> 
> 赞同：2
> 
> 时间：2012-10-13T19:12:50.400
> 
> 标签：android, android-fragments, android-viewpager

要在我的 Android 应用程序中导航，我使用`ActionBar.NAVIGATION_MODE_TABS`. 其中一个选项卡中的内容变化非常快。

用户应该能够通过再次触摸操作栏中的相同项目来重新加载选项卡。当前，`ViewPager`如果用户单击选项卡，选项卡内容会被缓存，因此不会刷新。

`TabListener.onTabReselected(...)`即使当前选项卡已经显示，也会触发，它可能是解决方案的起点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:49:43.223

> 由于即使当前选项卡已经显示，也会触发 TabListener.onTabReselected(...)，它可能是解决方案的起点。

在 上`onTabReselected()`，调用现有片段的方法，使其刷新其内容。

# javascript - 使 CSS 外观在旧 iPad（和其他浏览器）中正 常工作

> ID：12876109
> 
> 赞同：1
> 
> 时间：2012-10-13T19:13:22.380
> 
> 标签：javascript, jquery, forms, css

css 属性`appearance`允许您使用自定义图像更改单选按钮。这对于具有不同变体的产品非常有用，例如，因为用户可以点击/单击变体图像而不是单选按钮。

但是，它在原始 iPad 上无法正常工作（即使在使用 时 `-webkit-appearance`），因为某些图像的尺寸错误。

它在 Firefox 中也不起作用。

我想知道是否有任何 jquery/javascript 插件可以使它们正常工作。

我知道有[unifrom.js](http://uniformjs.com/)和[Ryan Fait 的脚本](http://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/)可以让你交换单选按钮和图像，但这些涉及创建跨度而不是像`appearance`.

我已经[阅读了有关](http://css-tricks.com/almanac/properties/a/appearance/#comment-172346)使外观起作用的技巧，但找不到任何有关如何实现它们的链接。

希望有一些东西可以强制外观正常工作（就像有脚本强制旧版浏览器识别 HTML5 标签一样）。

PS。我的网站需要 Javascript 才能工作，所以我不担心关闭 JS 的用户。它也是平板专用版本，所以我不太关心IE用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T14:28:55.663

没有可靠的跨边界设置单选按钮样式的好方法。但是，有一个不使用 javascript 的非常简单的解决方案：

```
body {
  padding: 50px;
}

input[type=radio] {
  opacity: 0;
  position: absolute;
  margin-top: 2px;
}

label {
  padding-left: 48px;
  margin-right: 20px;
  font: normal 38px/130% sans-serif;
  background: transparent url(http://www.screwdefaultbuttons.com/images/radio.jpg) 0 0 no-repeat;
}

input[type=radio]:checked + label {
  background-position: 0 -43px;
} 
```

​单击标签会检查其对应的输入单选。反过来，这会更改标签的背景图像，因此您可以使用没有 javascript 的图像自定义单选按钮。

你可以在这里看到一个演示：http: [//jsfiddle.net/wa2Gz/](http://jsfiddle.net/wa2Gz/)

# objective-c - 从视频文件 OpenCV 中抓取帧的最快方法

> ID：12876113
> 
> 赞同：1
> 
> 时间：2012-10-13T19:13:39.037
> 
> 标签：objective-c, xcode, video, opencv, frames

我想做一些openCV视频处理。我在 Mac 上使用 Xcode 4 中的 openCV，所以实际上我的代码是 Objective C++。

我想尽快访问视频的所有帧（不显示也不丢帧）并对它们进行计算。

我获取框架的代码：

```
CvCapture* capture = cvCaptureFromFile("A MOVIE FILE HERE");

IplImage* frame;

 while(1) {
    frame = cvQueryFrame(capture);

    if (!frame) break;

       // openCV Stuff here...

    char c = cvWaitKey(1); 
    if(c==27) break;
} 
```

我知道速度很大程度上取决于编解码器/分辨率/比特率 - 但似乎我无法以超过 120% 的速度阅读......知道如何更快地抓取帧吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:13:34.553

实际上只有一件事会减慢你的程序 -`waitKey`正如**Quentin Geissmann**已经提到的那样。如果你说：

> 已经试过了 - 忘了提。并没有真正加快速度。

比我不相信你，因为我刚刚在我的环境中对其进行了测试，它的速度提高了 30-40%。

这是基准代码：

```
#define WAIT_ON
int main()
{
    cv::Mat frame;
    cv::VideoCapture capture = cv::VideoCapture("video/in.avi");
    int k;

    double benchTime = (double)cv::getTickCount();
    while (1)
    {
        capture >> frame;
        if (!frame.data)
        {
            break;
        }

#ifdef WAIT_ON
        k = cv::waitKey(1);
        if (k == 27)
        {
            break;
        }
#endif
    }

    std::cout << ((double)cv::getTickCount() - benchTime)/cv::getTickFrequency() << std::endl;
} 
```

视频输入：`854x480, 24fps, 2:00`.

使用`WAIT_ON`宏：**~11 秒**

无：**~7.3 秒**

**更新：**

要降低视频流中的图像分辨率，请设置以下参数：

```
CV_CAP_PROP_FRAME_WIDTH Width of the frames in the video stream.
CV_CAP_PROP_FRAME_HEIGHT Height of the frames in the video stream. 
```

以其他[`set`方式](http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-set)（320x240）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T19:27:12.717

我已经多次注意到`cv::waitKey()`/`cvWaitKey()`在短时间（<10ms）时间内不准确。事实上，在我的情况下，它似乎至少睡了 10 毫秒，任何低于 10 毫秒的值。也许有人可以对此带来更精确的信息，但我建议**将其**从循环中删除（如果可以的话）。

我希望它有效，祝你好运

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-05-28T13:24:38.690

功能

```
cvSetCaptureProperty(capture, CV_CAP_PROP_FRAME_HEIGHT, 320);
cvSetCaptureProperty(capture, CV_CAP_PROP_FRAME_WIDTH, 200); 
```

不影响视频本身，如果你想改变帧的分辨率，你可以使用类似的东西：

```
cv::Size videoSize = cv::Size ((int) 320, (int) 200);
cv::resize(srcFrame,resFrame, videoSize); 
```

这将缩短处理每一帧所需的时间，因为它们会更小。希望能帮助到你

# php - 保留动态 php meny 的变化

> ID：12876115
> 
> 赞同：0
> 
> 时间：2012-10-13T19:13:42.630
> 
> 标签：php, drop-down-menu, fluid

我已经有一个站点，但我想重建它，因为它是用 table 和 iframe 制作的：www.kristofdelange.be（仍然是旧站点）。我设法实现了一个 php 菜单，我什至可以保留流体的变化。但问题是当我转到下一页时菜单会重置。我希望菜单在加载新链接时保持其状态。感谢您的答复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T19:22:53.863

那是因为每次有人单击链接时，您的网站都会刷新。您必须确保只刷新 1 个 div 而不是整个页面。您可以使用 ajax、jquery、javascript 或 php 执行此操作。

在我的第一个网站上，这是我使用的脚本：

```
<?php

if (isSet($_GET['page']))
{

        if (!isSet($page)){  $page = $_GET['page']; }
            if (file_exists( $page.'.php')) {
                include( $page.'.php'); 

        } 
        else
        {
        include('404.php');
        }
}
else
{
    include('home.php');

}

?> 
```

我假设我们说同一种语言，所以你应该明白这个想法。

你必须把它放在被替换的 DIV 中（我通常称之为内容）`<div id="content"> <my code > </div>`

如果你想使用它，你也必须改变你的href。

```
<a href="?page=contact">contact</a> 
```

代替`<a href="?page=http://www.kristofdelange.be/contact">contact</a>`

我希望这有帮助。祝你好运！

Ps 多亏了这一点，您的网站将变得更快，您可以删除加载页面中的所有代码。您只需键入文本并插入图片，无需任何网站标签。

我的联系页面：

```
This is contact 
```

所以没有更多的标签。您的 CSS 自动仍然适用于这些页面。除了我刚才告诉你的，什么都没有改变。]

编辑：内容将是您的 iframe 在您的旧网站上的内容。

# qt4 - phonon 后端插件无法加载

> ID：12876116
> 
> 赞同：2
> 
> 时间：2012-10-13T19:13:44.563
> 
> 标签：qt4, qt-creator, phonon

运行音乐播放器程序时出现以下错误...

```
WARNING: bool Phonon::FactoryPrivate::createBackend() phonon backend plugin could not be loaded 
WARNING: bool Phonon::FactoryPrivate::createBackend() phonon backend plugin could not be loaded 
WARNING: bool Phonon::FactoryPrivate::createBackend() phonon backend plugin could not be loaded 
The program has unexpectedly finished. 
```

我在 qt creator 中使用声子库。如果需要，操作系统是 ubuntu 12.04。错误是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-17T18:43:03.277

看来您的声子插件丢失了。你确定你安装了 phonon-gstreamer 或其他一些后端插件吗？

对于 phonon-gstreamer，只需执行“apt install phonon-backend-gstreamer”

# xaml - 如何使 RichTextBlock 中的超链接不完全对齐？

> ID：12876117
> 
> 赞同：7
> 
> 时间：2012-10-13T19:13:53.793
> 
> 标签：xaml, windows-8, windows-runtime, richtextbox, winrt-xaml

我希望能够在 RichTextBlock 元素中显示超链接，但我也希望它看起来正确。我能达到的最接近的是：

![我是如何让它看起来的](../Images/054c8f7f50e50674a5305fb1cb48f87a.png)

用于此的 XAML 粘贴在下面 - 本质上，我使用`InlineUIElement`并编辑了资源以删除按钮周围的所有杂物。我错过了什么吗？解决这个问题的唯一真正方法是滚动我自己的超链接吗？

这是富文本块的 XAML：

```
<RichTextBlock VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="14">
    <Paragraph>I just want this
        <InlineUIContainer>
            <HyperlinkButton Style="{StaticResource HyperlinkButtonStyle1}">Hyperlink</HyperlinkButton>
        </InlineUIContainer>
        to not look like crap
    </Paragraph>
</RichTextBlock> 
```

这是 nuked 资源的 XAML：

```
<Style x:Key="HyperlinkButtonStyle1" TargetType="HyperlinkButton">
    <Setter Property="Foreground" Value="{StaticResource HyperlinkForegroundThemeBrush}"/>
    <Setter Property="Background" Value="{StaticResource HyperlinkButtonBackgroundThemeBrush}"/>
    <!--<Setter Property="BorderBrush" Value="{StaticResource HyperlinkButtonBorderThemeBrush}"/>-->
    <Setter Property="BorderThickness" Value="0"/>
    <Setter Property="Padding" Value="0"/>
    <Setter Property="HorizontalAlignment" Value="Left"/>
    <Setter Property="VerticalAlignment" Value="Bottom"/>
    <Setter Property="FontFamily" Value="Global User Interface"/>
    <Setter Property="FontSize" Value="14"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="HyperlinkButton">
                <Grid>
                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup x:Name="CommonStates">
                            <VisualState x:Name="Normal"/>
                            <VisualState x:Name="PointerOver">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="ContentPresenter">
                                        <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource HyperlinkPointerOverForegroundThemeBrush}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Pressed">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="ContentPresenter">
                                        <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource HyperlinkPressedForegroundThemeBrush}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Disabled">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="ContentPresenter">
                                        <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource HyperlinkDisabledThemeBrush}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </VisualState>
                        </VisualStateGroup>
                        <VisualStateGroup x:Name="FocusStates">
                            <VisualState x:Name="Focused">
                                <Storyboard>
                                    <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="FocusVisualWhite"/>
                                    <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="FocusVisualBlack"/>
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Unfocused"/>
                            <VisualState x:Name="PointerFocused"/>
                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>
                    <Border x:Name="Border" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" VerticalAlignment="Bottom">
                        <ContentPresenter x:Name="ContentPresenter" ContentTemplate="{TemplateBinding ContentTemplate}" ContentTransitions="{TemplateBinding ContentTransitions}" Content="{TemplateBinding Content}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="0" VerticalAlignment="Bottom"/>
                    </Border>
                    <Rectangle x:Name="FocusVisualWhite" IsHitTestVisible="False" Opacity="0" StrokeDashOffset="1.5" StrokeEndLineCap="Square" Stroke="{StaticResource FocusVisualWhiteStrokeThemeBrush}" StrokeDashArray="1,1"/>
                    <Rectangle x:Name="FocusVisualBlack" IsHitTestVisible="False" Opacity="0" StrokeDashOffset="0.5" StrokeEndLineCap="Square" Stroke="{StaticResource FocusVisualBlackStrokeThemeBrush}" StrokeDashArray="1,1"/>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-14T00:08:51.210

您是否尝试过查看`TextButtonStyle`标准 VS 模板中包含的 StandardStyles.xaml 中的内容？您不必创建自己的超链接。在 Metro 中，您可以完全替换控件的模板，因此当已经存在具有您想要的功能的控件时，无需重现功能。

编辑：我采用`TextButtonStyle`模板并将边距更改为`Margin="3,-20,3,0"`然后添加`FontSize="14"`.

现在看起来像这样：

![在此处输入图像描述](../Images/b061354cb53025ea97bbef831aebd248.png)

离得这么远的原因是`TextBlock`模板`TextBlock`中的`TextButtonStyle`模板看起来像这样：

```
<Style x:Key="PageSubheaderTextStyle" TargetType="TextBlock" BasedOn="{StaticResource SubheaderTextStyle}">
    <Setter Property="TextWrapping" Value="NoWrap"/>
    <Setter Property="VerticalAlignment" Value="Bottom"/>
    <Setter Property="Margin" Value="0,0,0,40"/>
</Style> 
```

注意边距。所以要修复它，我们要么必须在父节点上创建一个负边距（就像我所做的那样），要么只需更改`PageSubheaderTextStyle`.

# c# - 除了返回一行之外，DataTable.NewRow 是否做任何其他事情？

> ID：12876118
> 
> 赞同：2
> 
> 时间：2012-10-13T19:14:19.700
> 
> 标签：c#, datatable, refactoring

我在继承的一些新代码中看到了很多：

`DataRow row = Method.dtContainer.NewRow();`

但是随后行永远不会添加到表中，甚至在此之后也不会使用。ReSharper 将其显示为灰色且可以安全删除。但是，我应该删除整行还是只删除变量分配？换句话说，调用 NewRow 是否对表做任何事情，或者它只是返回一个新对象，然后可以稍后将其添加到`DataTable`? 我已经检查过了，它不能通过反射、goto 等在其他任何地方访问。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T19:23:11.680

Resharper 是对的。

[`NewRow()`](http://msdn.microsoft.com/en-us/library/system.data.datatable.newrow.aspx)只返回一个具有`DataTable`实例结构（模式）的新行。

通常，新行会填充数据并添加到 中`DataTable`，如下所示：

```
dataTable.Rows.Add(newRow); 
```

如果不以任何方式使用它，则删除该行是安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-26T19:03:27.957

尝试运行此代码：

```
 var table = new DataTable();

    while(true)
    {
        var row = table.NewRow();
    } 
```

如果 Resharper 是正确的，它就不会抛出 OutOfMemoryException！

# cordova - Windowsphone7的Phonegap中的阿拉伯语？

> ID：12876126
> 
> 赞同：0
> 
> 时间：2012-10-13T19:15:09.963
> 
> 标签：cordova

我正在编写我的 HTML 页面以使用 Phonegap 将其转换为 .xap。我的应用在 about 页面中包含一些阿拉伯语和波斯语描述。我的应用程序在测试时不断崩溃。我应该怎么办？谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:17:24.953

阿拉伯语应该在 WP7 上的 Cordova/PhoneGap 下运行良好。为确保问题确实与阿拉伯语有关，您可以尝试替换/删除此文本并尝试运行该应用程序。这会让你知道这是否真的与阿拉伯语有关。

如果应用程序崩溃/强制关闭，这意味着应用程序本身有问题（本机部分、丢失/错误的文件引用等），而不是您的 html/js 文件。

如果您看到空白屏幕而不是 html 应用程序，则 html/js 文件存在问题。

一般建议是尝试最新的 Cordova/Phonegap for WP7 [http://phonegap.com/download](http://phonegap.com/download)

# python - Python 无法在 Windows 上运行并出现致命错误

> ID：12876127
> 
> 赞同：0
> 
> 时间：2012-10-13T19:15:15.860
> 
> 标签：python, window, fatal-error

在 Windows 的命令行中，当我尝试使用打开 Python 文件时`python filename.py`出现此错误，然后 python.exe 崩溃。

```
fatal python error py_initialize can't initialize sys standard streams
ImportError: no module named encodings_utf8 
```

**注意**：我使用的是 Python 2.7

我不知道我该怎么做。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-10-13T20:10:55.657

我认为您应该使用[http://pypy.org/download.html](http://pypy.org/download.html)中的 pypy， 不要忘记在启动之前安装[http://www.microsoft.com/en-us/download/details.aspx?id=5582](http://www.microsoft.com/en-us/download/details.aspx?id=5582) pypy :) 当然尝试卸载 python 并重新下载它并重新安装它可能是一个下载错误 google md5 sum 检查下载是否损坏 另外你没有告诉我们你正在运行哪个版本的 windows

# django - Django 和动态模型关系

> ID：12876128
> 
> 赞同：1
> 
> 时间：2012-10-13T19:15:19.170
> 
> 标签：django, django-models

我有一个主要模型：

```
ToolBox 
```

和其他三个模型：

```
Hammer
Nail
Plier 
```

显然，工具箱可以包含锤子、钉子或钳子的任意组合。

使用 Django，这种动态关系类型的良好 ORM 表示是什么？请记住，这些模型中的每一个都可以拥有自己丰富的属性集，因此简单的类型字段将无法完成这项工作。我还想知道如果 Django 中的管理界面可以正常工作的话，它是如何适应这种动态类型的东西的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:44:36.850

我不确定你所说的动态是什么意思，我认为你的例子很典型。

但无论如何，为了避免这种情况：

```
Toolbox
    many2many(Hammer)
    many2many(Nail)
    etc... (add new m2m field every time you add another tool class) 
```

我会这样做：

```
Toolbox

Hammer
    foreignkey(Toolbox)

Nail
    foreignkey(Toolbox) 
```

这将使事情更容易实现（使用 toolbox.hammer_set 等）。如果 Hammer、Nail 等有一些共同的字段，您还可以定义一个包含所有共同字段的抽象基类（例如 Tool）。

# mysql - SQL将int转换为日期时间

> ID：12876151
> 
> 赞同：0
> 
> 时间：2012-10-13T19:18:18.837
> 
> 标签：mysql, sql, tsql, select, casting

为什么这个 SQL 语句：

```
Select cast(convert(1231231231,103) AS datetime) 
```

导致错误：

> *#1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '103) AS datetime)' 附近使用正确的语法*

我需要转换`INT`为`DATETIME`，如何使它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:26:24.980

由于您的整数是 unix 时间，您可以使用`FROM_UNIXTIME(unix_timestamp)`：[https](https://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_from-unixtime) ://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_from-unixtime ？

# c# - 如何在 XNA 中从 2 个不同屏幕上的 2 个摄像头进行渲染？

> ID：12876152
> 
> 赞同：0
> 
> 时间：2012-10-13T19:18:25.667
> 
> 标签：c#, xna, xna-4.0, multiple-monitors, multiscreen

我的需要是检测是否插入了 2 个屏幕（如果没有，程序将退出），然后，我会让用户选择哪个屏幕是前屏，哪个是后屏。最后，游戏应该有两个摄像头，每个摄像头都应该在不同的屏幕（全屏）上渲染。
我已经研究了[Full Screen On Multiple Monitors With XNA](https://stackoverflow.com/questions/11081792/full-screen-on-multiple-monitors-with-xna) & [Working with multiplescreens in XNA 4.0](https://stackoverflow.com/questions/5301020/working-with-multiple-screens-in-xna-4-0)，这对我的需求没有太大帮助。（后者在答案中有一个断开的链接......）
我应该研究哪些课程？是[`GraphicApater`](http://msdn.microsoft.com/en-us/library/bb197299.aspx)给了我我需要的一切吗？也许来自命名空间的其他东西[`Microsoft.Xna.Framework.Graphics`](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.aspx)？提前致谢。

**编辑：**
我遇到了[如何确保表单在双显示器场景中显示在“附加”显示器上？](https://stackoverflow.com/questions/2561104/how-do-i-ensure-a-form-displays-on-the-additional-monitor-in-a-dual-monitor-sc)并且在想，如果可以很容易地使用表格，我可以有一个*“XNA 表格”*吗？IE 一个表单，上面有 XNA 内容渲染...
如果是这样，我可以创建 2 个表单，让它们加载到不同的屏幕上，然后最大化（全屏）它。那么，有可能吗？

# python - 如何用Python中的另一个字符串替换函数中的字符串？

> ID：12876158
> 
> 赞同：3
> 
> 时间：2012-10-13T19:19:04.173
> 
> 标签：python, python-3.x

我想做这个：

```
>>> special = 'x'
>>> random_function('Hello how are you')
'xxxxx xxx xxx xxx' 
```

我基本上想返回字符串：{(str) -> str}

我不断得到未定义的变量。

对不起，这是我的第一篇文章。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T19:41:46.943

这可以使用正则表达式轻松完成：

```
>>> re.sub('[A-Za-z]', 'x', 'Hello how are you')
'xxxxx xxx xxx xxx' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-13T21:25:08.527

由于 Python 中的字符串是不可变的，因此每次使用该`replace()`方法时都必须创建一个新字符串。每次调用 replace 也必须遍历整个字符串。这显然是低效的，尽管在这个规模上并不明显。

一种替代方法是使用列表综合（[文档](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)、[教程](http://carlgroner.me/Python/2011/11/09/An-Introduction-to-List-Comprehensions-in-Python.html)）循环遍历字符串一次并创建新字符列表。该[`isalnum()`](http://docs.python.org/library/stdtypes.html#str.isalnum)方法可用作仅替换字母数字字符的测试（即，保留空格、标点符号等不变）。

最后一步是使用该[`join()`](http://docs.python.org/library/stdtypes.html#str.join)方法将字符连接到新字符串中。请注意，在这种情况下，我们使用空字符串`''`将字符连接在一起，它们之间没有任何内容。如果我们使用`' '.join(new_chars)`，每个字符之间会有一个空格，或者如果我们使用，`'abc'.join(new_chars)`那么字母`abc`将在每个字符之间。

```
>>> def random_function(string, replacement):
...     new_chars = [replacement if char.isalnum() else char for char in string]
...     return ''.join(new_chars)
...
>>> random_function('Hello how are you', 'x')
'xxxxx xxx xxx xxx' 
```

当然，你应该给这个函数起一个比`random_function()`...更合乎逻辑的名字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-13T20:40:23.607

```
def hide(string, replace_with):
    for char in string:
        if char not in " !?.:;":  # chars you don't want to replace
            string = string.replace(char, replace_with) # replace char by char
    return string

print hide("Hello how are you", "x")
'xxxxx xxx xxx xxx' 
```

还要检查[string](http://docs.python.org/library/string.html)和[re](http://docs.python.org/library/re.html)模块。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-30T16:15:14.563

不确定我是否应该在评论或整个答案中添加这个？正如其他人建议的那样，我建议使用正则表达式，但您可以使用该`\w`字符来引用字母表中的任何字母。这是完整的代码：

```
 import re

 def random_function(string):
     newString=re.sub('\w', 'x', string) 
     return(newString)

 print(random_function('Hello how are you')) 
```

应该打印 xxxxx xxx xxx xxx

# python - Mod_Python：发布者处理程序与 PSP 处理程序

> ID：12876159
> 
> 赞同：0
> 
> 时间：2012-10-13T19:19:05.610
> 
> 标签：python, mod-python

我一直在测试 Mod_python，似乎有两种方法可以使用以下方法生成 python 代码：-

*   发布者处理程序
*   PSP 处理器

但是我已经让两者同时工作了，我应该使用一个而不是另一个吗？PSP 很像 PHP，但 Publisher 似乎更像 python。与使用一个相比是否有优势（速度、易用性等）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T20:07:44.297

我不熟悉 mod_python（项目很久以前就被放弃了），但现在 Python 应用程序正在使用 wsgi（mod_wsgi 或 uwsgi）。如果您使用的是 apache，mod_wsgi 很容易配置，对于 nginx，请使用 uwsgi。

# android - 从 Intents 打开 Twitter 应用程序

> ID：12876161
> 
> 赞同：0
> 
> 时间：2012-10-13T19:19:27.827
> 
> 标签：android, android-intent, twitter

有谁知道只打开 twitter 应用程序的类名吗？`intent.setClassName("com.twitter.android", "com.twitter.android");` 显然这不起作用。

我知道我们可以打开帖子链接，但这不是我想要的。任何人都可以帮忙吗？这是发布的代码。

```
intent.setClassName("com.twitter.android",
        "com.twitter.android.PostActivity"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:03:21.050

你试过这个吗？请注意，只有当他们已经安装了 twitter 应用程序时，它才会起作用。如果您只想打开应用程序（而不是发布推文），请尝试将 Intent.ACTION_SEND 更改为 Intent.ACTION_VIEW

```
 try{
        Intent intent = new Intent(Intent.ACTION_SEND);
        intent.putExtra(Intent.EXTRA_TEXT, "this is a tweet");
        intent.setType("text/plain");
        final PackageManager pm = getPackageManager();
        final List<?> activityList = pm.queryIntentActivities(intent, 0);
        int len =  activityList.size();
        for (int i = 0; i < len; i++) {
            final ResolveInfo app = (ResolveInfo) activityList.get(i);
            if ("com.twitter.android.PostActivity".equals(app.activityInfo.name)) {
                final ActivityInfo activity=app.activityInfo;
                final ComponentName name=new ComponentName(activity.applicationInfo.packageName, activity.name);
                intent.addCategory(Intent.CATEGORY_LAUNCHER);
                intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);
                intent.setComponent(name);
                startActivity(intent);
                break;
            }
        }
  }
    catch(final ActivityNotFoundException e) {
        Log.i("twitter", "no twitter native",e );
    } 
```

# linux - Linux程序 - 反转突出显示的文本

> ID：12876162
> 
> 赞同：1
> 
> 时间：2012-10-13T19:19:28.980
> 
> 标签：linux, flash, ubuntu, driver, prezi

我想开发一个将在我的 Ubuntu 12.04 的背景上运行的程序，所以当在任何正在运行的程序的某个文本框中选择一些文本并按下一些组合键（如 ctrl-F12）时，文本将被剪切，反转，并粘贴在同一个地方。

我知道一些在 Windows 上执行此操作的程序。

它在一些不支持从右到左的语言（如阿拉伯语和希伯来语）的程序和网页中很有用——字母是从左到右打印的，因此文本会颠倒。

更具体地说，我在[Prezi](http://www.prezi.com)中需要它，它在其嵌入式 Flash 编辑器中存在这种错误（我想过编写一个 chrome 插件，但我认为这样的插件不能操纵 Flash 对象中的选定文本）。

你知道这样的程序是否存在吗？为了开发具有这种功能的程序（在其他程序中操作选定的文本），我应该从哪里开始阅读？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T21:34:40.247

我的部分解决方案 - 一个反转剪贴板文本的 python 脚本：

```
#!/usr/bin/env python
from gi.repository import Gtk, Gdk

clipboard = Gtk.Clipboard.get(Gdk.SELECTION_CLIPBOARD)
# if you want to take the selected text without copying, set primary to:
# Gtk.Clipboard.get(Gdk.SELECTION_PRIMARY)
# (doesn't always work)
primary = clipboard 

def run():
    text = primary.wait_for_text()
    if not isinstance(text, str):
        return
    reversed_text = u''.join(reversed(text.decode('utf-8')))
    clipboard.set_text(reversed_text, -1)
    clipboard.store()

if __name__ == '__main__':
    run() 
```

然后定义一个键盘快捷键来运行脚本（我使用了 alt-Insert），并通过将其复制到剪贴板来反向选择脚本，调用脚本并将其粘贴回来（ctrl-Insert、alt-Insert、shift-Insert）。

我仍在寻找更好的解决方案，因此我可以使用单个键盘快捷键而不覆盖剪贴板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T09:57:13.887

下面是 Emacs 的一种输入法，可以反向输入文本：

```
(defun reverse-input-method (key)
  (if buffer-read-only
      (list key)
    (if (setq new key)
        (list new ?\2) ;; ?\2 == backwards char
      (list key ?\2))))

(defun reverse-input-activate (&optional arg)
  "Activate reverse-im input method.
With arg, activate reverse-im input method if and only if arg is
positive.

While this input method is active, the variable
`input-method-function' is bound to the function
`reverse-input-method'."
  (if (and arg
           (< (prefix-numeric-value arg) 0))
      (unwind-protect
          (progn
            (quail-hide-guidance)
            (quail-delete-overlays)
            (setq describe-current-input-method-function nil))
        (kill-local-variable 'input-method-function))
    (setq inactivate-current-input-method-function 'reverse-input-inactivate)
    (setq describe-current-input-method-function 'reversr-input-help)
    (quail-delete-overlays)
    (if (eq (selected-window) (minibuffer-window))
        (add-hook 'minibuffer-exit-hook 'quail-exit-from-minibuffer))
    (set (make-local-variable 'input-method-function)
         'reverse-input-method)))

(defun reverse-input-inactivate ()
  "Inactivate reverse-im input method."
  (interactive)
  (reverse-input-activate -1))

(defun reverse-input-help ()
  (interactive)
  (with-output-to-temp-buffer "*Help*"
    (princ "Inserts text in reverse order.")))

(provide 'reverse-im)

(register-input-method "reverse-im" "UTF-8" 'reverse-input-activate "<<"
                       "Input method for \"typing characters in reverse\".") 
```

例如，您可以将其保存在 ~/.emacs.d/reverse-im/reverse-im.el 中，然后将这些行添加到 .emacs

```
(add-to-list 'load-path (expand-file-name "~/.emacs.d/reverse-im/"))
(require 'reverse-im) 
```

然后在您需要编辑文本时使用[KeySnail](https://github.com/mooz/keysnail/wiki) Firefox 插件调用 emacs（您需要在 .bashrc 中设置文本编辑器或任何用于将 shell 变量存储到`emacsclient`并使用KeySnail 的[K2Emacs](https://raw.github.com/myuhe/KeySnail_Plugin/master/K2Emacs.ks.js)插件，或修改您的 .keysnail。 js 在需要时调用 Emacs。

Vim 有一个类似的插件叫做 Vimperator，但我没有使用它。

# javascript - 为什么这个 Javascript - SVG CSS 操作不工作？

> ID：12876164
> 
> 赞同：1
> 
> 时间：2012-10-13T19:19:37.653
> 
> 标签：javascript, jquery, css, html, svg

我很快就要拍了（*提问者注意*）

这是我正在使用的 SVG 图像：[http ://en.wikipedia.org/w/index.php?title=File:World98.svg&page=1](http://en.wikipedia.org/w/index.php?title=File:World98.svg&page=1)

这是一个免费的*公共领域*——用 SVG 制作的全球地图，其中（几乎）每个国家都被各自的边界所包围。

**不要去那里！您不必立即寻找它。**

我有件事要先告诉你。

这是图像的相关部分：（
编辑**）**西班牙*是我在这两个例子中试图操纵的国家*

```
<g
   id="gESP">
  <path
     class="region"
     d="M472.55,197.77 472.27,198.22 471.8,197.9 472.55,197.77Z"
     id="polyF1S67P1" />
  <path
     class="region"
     d="M479.45,196.82 479.35,197.75 478.75,197.9 478.33,197.55 478.67,196.8 479.45,196.82Z"
     id="polyF1S67P2" />
  <path
     class="region"
     d="M474.5,197.17 474.1,196.9 474.3,196.67 474.72,196.92 474.5,197.17Z"
     id="polyF1S67P3" />
  <path
     class="region"
     d="M476.85,196.17 475.95,197.22 475.27,196.3 477.45,195.62 476.85,196.17Z"
     id="polyF1S67P4" />
  <path
     class="region"
     d="M482.8,196.77 481.97,196.95 482.7,196.62 483.33,195.27 483.75,195.17 483.55,196.52 482.8,196.77Z"
     id="polyF1S67P5" />
  <path
     class="region"
     d="M472.7,195.88 472.22,195.12 472.42,194.9 473,195.22 472.7,195.88Z"
     id="polyF1S67P6" />
  <path
     class="region"
     d="M484.12,194.7 483.72,194.82 483.92,194.3 484.95,193.9 484.8,194.45 484.12,194.7Z"
     id="polyF1S67P7" />
  <path
     class="region"
     d="M526.65,167.6 526.12,167.47 526.65,167.6Z"
     id="polyF1S67P8" />
  <path
     class="region"
     d="M526.25,166.9 525.62,166.95 525.97,166.45 526.72,166.42 526.25,166.9Z"
     id="polyF1S67P9" />
  <path
     class="region"
     d="M530.97,164.47 531.85,164.75 530.77,165.85 529.72,165.17 528.82,165.1 530.3,164.15 531.12,164 530.97,164.47Z"
     id="polyF1S67P10" />
  <path
     class="region"
     d="M534.15,164.35 532.97,164.02 532.95,163.72 533.97,163.8 534.15,164.35Z"
     id="polyF1S67P11" />
  <path
     class="region"
     d="M500.85,153.45 502.62,154.02 506,153.77 509.67,154.4 512.23,154.12 515.75,154.65 517.25,154.42 518.32,154.9 518.17,155.42 518.62,155.27 520.6,156.12 523.67,156.45 524.35,156.02 525.97,156.42 526.38,157.15 529.6,157.4 530.47,157.05 531.43,157.55 531.02,157.62 531.25,158.5 530.57,159 528.02,160.32 525.1,160.95 524.22,161.62 524.62,162 523.9,162.2 521.32,165.22 521.67,166.5 522.8,167.35 520.8,168.57 519.97,170.1 520.1,170.57 518.55,170.67 517.67,171.15 516.15,172.95 515.42,172.7 514.5,173.02 510.1,173.02 509.25,173.6 507.88,173.82 506.6,174.95 505.45,174.5 504.5,173.25 504.97,172.47 504.47,172.7 503.17,171.45 501.65,171.72 501.4,170.77 502.9,168.92 502.5,168.95 501.82,168.17 502.8,166.52 501.3,164.85 502.7,164.7 503.07,163.85 502.7,163.42 503.32,162.95 503.02,161.02 504.9,159.45 504.05,159.25 503.85,158.5 499.6,158.88 499.27,157.97 497.65,158.55 497.55,158.05 498.1,157.57 497.75,157.55 497.8,156.67 497.15,156.7 497.42,156.12 496.57,155.62 496.75,155.07 497.57,154.65 499.02,154.47 499.3,153.95 500.85,153.45Z"
     id="polyF1S67P12" />
</g> 
```

我想要做的是用 Javascript 用红色填充国家。

我试过这个：

**尝试#1** -*没有成功*

```
function selectedCountryChanged(id) {
    var tmp = $("#selectedCountry").find("option:selected");
    var val = tmp.data('alpha');

    console.log('val'); // shows ESP in console

    for (var s in a.style) {
        console.log(s); // shows correctly all style properties in console
    }
        var a = document.getElementById("g"+val);
    a.style.fill = '#ffff00';
    console.log(a.style.fill); // shows rgb(255, 0, 0) in console
} 
```

**尝试#2** -*没有成功*

```
function selectedCountryChanged(id) {
    var tmp = $("#selectedCountry").find("option:selected");
    var val = tmp.data('alpha');
    var a = document.getElementById("g"+val);
    console.log(val); // shows ESP in console
    for(var s in a.style) {
        console.log(s); // shows all css-properties correctly
    }
    console.log(id + " " + val);

    a.setAttribute("style", "fill: #ff0000");
    console.log(a.style.getPropertyValue("fill")); // shows rgb(255, 0, 0) in console
} 
```

即使所有的调试信息都显示一切正常，这该死的东西为什么没有用红色填充一定是有原因的？如果我通过在 SVG 文件中分叉 css-part 手动执行此操作，则显示正常。

我只包含了代码中最相关的部分（恕我直言）。我会根据要求发布更多信息。

**编辑：**使用 Google Chrome 和 Mozilla Firefox 测试。两者都失败了。

**编辑#2：**在这两种方法中，Firebug 和 Javascript 控制台（在 Chrome 中）都没有出错。

* * *

**编辑：**

@Bill 在他的评论中和@Simon Boudrias 在他的回答中都指出了问题所在。

主元素的许多子路径都填充了白色，需要被覆盖。解决方案终于是微不足道的。

**解决方案**

```
function selectedCountryChanged(id) {
    // use the selection id to get alpha3-country identifier
    var tmp = $("#selectedCountry").find("option:selected");
    var val = tmp.data('alpha');
    // Get the style - element defined in SVG
    var a = document.getElementById("mapStyle");
    // By assigning the * as class name, we quarantee
    // that all the children are filled with red as well
    var newFill = "#g"+val+" * { fill: red; }";
    // If prevSelectedCountry is set, remove the red filling by
    // setting it white
    if (window.prevSelectedCountry != undefined) {
        $(a).append(window.prevSelectedCountry);
    }
    // Add this country to prevSelectedCountry
    window.prevSelectedCountry = "#g"+val+" * { fill: white; }";
    // Fill this country with red
    $(a).append(newFill);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:36:14.330

当我查看 .svg 图像时，我发现大多数`<path>`元素的`fill`属性都设置为白色。因此，您需要先覆盖或删除此属性。

当您选择组`<g>`元素时。因此，为了使填充属性或样式属性对其子项起作用，`<path>`您需要清除或更改它们自己的填充属性。

因此，您可以对此进行测试：（可能需要一些时间，具体取决于您使用的某些变量的值）

```
function selectedCountryChanged(id) {
    var tmp = $("#selectedCountry").find("option:selected");
    var val = tmp.data('alpha');
    var paths = $("#g" + val).find('path');

    paths.attr("fill", "#ff0000");
} 
```

# c - 在C中，空字符和换行符有什么区别？

> ID：12876166
> 
> 赞同：2
> 
> 时间：2012-10-13T18:20:28.343
> 
> 标签：c

~~NULL~~一个空字符和一个换行符之间的概念区别和相似之处，即'\0' 和'\n' 你能解释它们与整数和字符数据类型变量和数组的相关性吗？

作为参考，这里是一个读取和写入 2d char 数组的程序示例片段

***程序代码 1：***

```
int main()
{
    char sort(),stuname(),swap(),(*p)(),(*q)();
    int n;
    p=stuname;
    q=swap;
    printf("Let the number of students in the class be \n");
    scanf("%d",&n);
    fflush(stdin);
    sort(p,q,n);
    return 0;
}

char sort(p1,q1,n1)
char (*p1)(),(*q1)();
int n1;
{
    (*p1)(n1);
    (*q1)();
}

char stuname(int nos)  // number of students
{
    char name[nos][256];
    int i,j;
    printf("Reading names of %d  students started--->\n\n",nos);
    name[0][0]='k'; //initialising as non NULL charecter
    for(i=0;i<nos;i++)  // nos=number of students
    {
        printf("Give name of student %d\n",i);
        for(j=0;j<256;j++)
        {
            scanf("%c",&name[i][j]);
            if(name[i][j]=='\n')
            {
                name[i][j]='\0';
                j=257;
            }
        }
    }
    printf("\n\nWriting student names:\n\n");
    for(i=0;i<nos;i++)
    {
        for(j=0;j<256&&name[i][j]!='\0';j++)
        {
            printf("%c",name[i][j]);
        }
        printf("\n");
    }
}

char swap()
{
    printf("Will swap shortly after getting clarity on scanf and %c");
} 
```

上面的代码运行良好，而给出的相同逻辑略有不同，但没有给出适当的输出。这是代码

***程序代码 2：***

```
#include<stdio.h>
int main()
{
    char sort(),stuname(),swap(),(*p)(),(*q)();
    int n;
    p=stuname;
    q=swap;
    printf("Let the number of students in the class be \n");
    scanf("%d",&n);
    fflush(stdin);
    sort(p,q,n);
    return 0;
}

char sort(p1,q1,n1)
char (*p1)(),(*q1)();
int n1;
{
    (*p1)(n1);
    (*q1)();
}

char stuname(int nos)  // number of students
{
    char name[nos][256];
    int i,j;
    printf("Reading names of %d  students started--->\n\n",nos);
    name[0][0]='k'; //initialising as non NULL charecter
    for(i=0;i<nos;i++)  // nos=number of students
    {
        printf("Give name of student %d\n",i);
        ***for(j=0;j<256&&name[i][j]!='\0';j++)***
        {
            scanf("%c",&name[i][j]);

            /*if(name[i][j]=='\n')
            {
                name[i][j]='\0';
                j=257;
            }*/

        }
    }
    printf("\n\nWriting student names:\n\n");
    for(i=0;i<nos;i++)
    {
        for(j=0;j<256&&name[i][j]!='\0';j++)
        {
            printf("%c",name[i][j]);
        }
        printf("\n");
    }
}

char swap()
{
    printf("Will swap shortly after getting clarity on scanf and %c");
} 
```

这里还有一个相同程序的实例没有给出下面给出的正确输出

***程序代码 3：***

```
#include<stdio.h>
int main()
{
    char sort(),stuname(),swap(),(*p)(),(*q)();
    int n;
    p=stuname;
    q=swap;
    printf("Let the number of students in the class be \n");
    scanf("%d",&n);
    fflush(stdin);
    sort(p,q,n);
    return 0;
}

char sort(p1,q1,n1)
char (*p1)(),(*q1)();
int n1;
{
    (*p1)(n1);
    (*q1)();
}

char stuname(int nos)  // number of students
{
    char name[nos][256];
    int i,j;
    printf("Reading names of %d  students started--->\n\n",nos);
    name[0][0]='k'; //initialising as non NULL charecter
    for(i=0;i<nos;i++)  // nos=number of students
    {
        printf("Give name of student %d\n",i);
        ***for(j=0;j<256&&name[i][j]!='\n';j++)***
        {
            scanf("%c",&name[i][j]);
            /*if(name[i][j]=='\n')
            {
                name[i][j]='\0';
                j=257;
            }*/
        }
        name[i][i]='\0';
    }
    printf("\n\nWriting student names:\n\n");
    for(i=0;i<nos;i++)
    {
        for(j=0;j<256&&name[i][j]!='\0';j++)
        {
            printf("%c",name[i][j]);
        }
        printf("\n");
    }
}

char swap()
{
    printf("Will swap shortly after getting clarity on scanf and %c");
} 
```

为什么程序代码 2 和程序代码 3 不像代码 1 那样工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-13T19:54:12.380

空字符`'\0'`和换行符`'\n'`是两个不同的字符值，就像`'x'`和`'y'`是两个不同的字符值一样。

值为 0 的空字符用于标记*字符串*的结束，C 标准将其定义为“以第一个空字符终止并包括第一个空字符的连续字符序列”。例如，`strlen()`返回字符串长度的函数通过扫描字符序列来工作，直到找到终止的空字符。

换行符 ,`'\n'`用于表示文本文件中的行尾。*程序运行时字符串*存在于内存中，而*行*存在于程序外部的文本文件中。您可以将一行的内容（在文本文件中）读入字符串（在内存中）；根据您阅读它的方式，生成的字符串可能包含也可能不包含终止的`'\n'`. 空字符通常不会出现在文本文件中。

请注意，它`NULL`是（扩展为的宏）*空指针常量*。除了空指针和空字符都可以表示为`0`之外，它们之间几乎没有任何关系。请不要使用该术语`NULL`来指代空字符。

一件小事：在 C 中，诸如 , 或 之类的字符常量`'x'`实际上`'\0'`是`'\n'`type `int`，而不是 type `char`。（C++ 在这方面有所不同。）但它们几乎总是用于表示 type 的值`char`。例如，这个：

```
char c;
...
c = '\0'; 
```

将在 中存储一个空字符值`c`，该`int`值从 隐式转换`int`为`char`。在大多数情况下，您不必担心这一点。

`char`和`int`都是整数类型，你可以在它们之间自由转换。字符常量是类型的原因`int`是历史性的。

另外，我看到您使用的是旧式 (K&R) 函数定义。*早在 1989 年，ANSI 标准添加了一种使用原型*定义函数的新方法（您实际上在代码中使用了一些原型）——从那时起就有了两个新版本的 C 标准。旧式函数定义已过时，应避免使用。这个：

```
int func(x, y)
int x;
char *y;
{
    /* ... */
} 
```

是一个老式的定义。这个：

```
int func(int x, char *y)
{
    /* ... */
} 
```

是一个使用原型的定义，它是首选。一方面，它让编译器检查调用是否传递了正确数量和类型的参数。

之后你可能会有更多的问题。我强烈建议您看一下[comp.lang.c 常见问题解答](http://www.c-faq.com/)；它可能会回答其中的大多数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-13T18:49:05.593

程序#2 和#3 存在语法错误。

`'\n'`十六进制值`0x0a`通常用于在屏幕上格式化文本文件 o/p，只是为了便于阅读。

带有十六进制值的 '\0'`0x00`是字符串分隔符。尽管 NULL 具有数值`0x0000`，但它的类型为`void*`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T03:13:20.347

在程序代码 1 中，如果我放置 '\0' 而不是 '\n'。j for 循环没有被分隔。

以下是修改后的程序代码 1 的一部分：

```
char stuname(int nos)  //nos: number students already read
{
    char name[nos][256];
    int i,j;
    printf("Reading names of %d  students started--->\n\n",nos);
    for(i=0;i<nos;i++)  
    {
        printf("Give name of student %d\n",i);
        ***for(j=0;j<256;j++)***
        {
            scanf("%c",&name[i][j]);

            if(name[i][j]=='\0')    // modified from if(name[i][j]=='\n')
            {

                j=257;
            }

        }
    }
    printf("\n\nWriting student names:\n\n");
    for(i=0;i<nos;i++)
    {
        for(j=0;j<256&&name[i][j]!='\0';j++)
        {
            printf("%c",name[i][j]);
        }
        printf("\n");
    }
} 
```

如果我们按两次回车键，第一个回车键将被读取为换行符
，第二个回车键在读取字符数组时将被读取为空字符。

因此，一旦键入连续的第二个 enter 键，char 数组就应该停止读取。（我的意思是内部 j for 循环应该被终止）但是它会被读取直到 256 个键被键入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-13T18:50:35.020

从概念上讲，两者都是字符，这意味着它们在内部是 ascii 编码的。

'\0' 是整数 0，'\n' 是整数 10。

程序有错误！

# php - 在输入 PHP 或 JavaScript 时从数据库中采样？

> ID：12876169
> 
> 赞同：-1
> 
> 时间：2012-10-13T19:20:21.943
> 
> 标签：php, javascript, mysql, textbox, add

我写了一个将信息添加到 Mysql 数据库的网站。但是我想在将信息输入文本框时抽取数据库的一些行。

我有一个包含 3 行的数据库：A、B、C，我输入 A，在切换到 B 行的文本框后，一个脚本（PHP 或 JavaScript）显示了我的表中所有行的列表，其中包含我输入的 A 行。

我怎么能用 PHP/javascript 做到这一点？

我知道这有点难以理解，所以只要问你是否不明白。

问候杰夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T06:55:29.033

根据您在项目中使用的框架，有几个功能可以为您完成。对于道场：[http ://dojotoolkit.org/reference-guide/1.8/dijit/form/FilteringSelect.html#dijit-form-filteringselect](http://dojotoolkit.org/reference-guide/1.8/dijit/form/FilteringSelect.html#dijit-form-filteringselect)

jquery 也可以这样做： [http ://api.jqueryui.com/autocomplete/](http://api.jqueryui.com/autocomplete/)

# python - Flask OperationalError：无法使用 sqlite3 打开数据库文件

> ID：12876172
> 
> 赞同：11
> 
> 时间：2012-10-13T19:20:40.110
> 
> 标签：python, sqlite, flask

我正在尝试将现有的 sqlite3 db 连接到我正在构建的仪表板，但我遇到了一个我不知道如何解决的问题。我一直在通过尝试将 Flask 文档和其他来源的内容拼凑起来来解决这个问题，所以如果这里看起来有点奇怪，请随时打电话给我。可能是，我只是不知道:)

代码：

```
from __future__ import with_statement
from contextlib import closing
from flask import Flask, render_template, request, session, g, redirect, url_for, abort, flash
import sqlite3

#config
DATABASE = '~/home/aaron/Dropbox/coding/webapp2/tmp/test.db'
DEBUG = True
SECRET_KEY = 'development key'
USERNAME = 'admin'
PASSWORD = 'default'

app = Flask(__name__)
app.config.from_object(__name__)

def connect_db():
    return sqlite3.connect(app.config['DATABASE']) # LINE 17

@app.before_request
def before_request():
    g.db = connect_db() # LINE 22

@app.teardown_request
def teardown_request(exception):
    if hasattr(g, 'db'):
        g.db.close()

# App seems to error out before app.route and if __name__=='__main__' block
# Everything in my app.route is commented out 
```

完全错误：

> 回溯（最近一次调用）：文件“/usr/local/lib/python2.7/dist-packages/flask/app.py”，第 1701 行， **调用中** 返回 self.wsgi_app(environ, start_response) 文件“/usr/local/lib/python2.7/dist-packages/flask/app.py”，第 1689 行，在 wsgi_app response = self.make_response(self.handle_exception(e) ) 文件“/usr/local/lib/python2.7/dist-packages/flask/app.py”，第 1687 行，在 wsgi_app 响应 = self.full_dispatch_request() 文件“/usr/local/lib/python2.7/ dist-packages/flask/app.py”，第 1360 行，在 full_dispatch_request rv = self.handle_user_exception(e) 文件“/usr/local/lib/python2.7/dist-packages/flask/app.py”，第 1356 行, 在 full_dispatch_request rv = self.preprocess_request() 文件 "/usr/local/lib/python2.7/dist-packages/flask/app.py", 第 1539 行, 在 preprocess_request rv = func() 文件 "/home/aaron /Dropbox/coding/webapp2/control.py”，第 22 行，在 before_request g.db = connect_db() 文件“/home/aaron/Dropbox/coding/webapp2/control.py”，第 17 行，在 connect_db 返回 sqlite3.connect(app.config['DATABASE']) OperationalError: 无法打开数据库文件
> 
> 127.0.0.1 - - [2012 年 10 月 13 日 13:55:48] “GET /？**调试器**=yes&cmd=resource&f=style.css HTTP/1.1”200 - 127.0.0.1 - - [2012 年 10 月 13 日 13:55 :48]“GET /?**调试器**=yes&cmd=resource&f=jquery.js HTTP/1.1”200 - 127.0.0.1 - - [13/Oct/2012 13:55:48]“GET /?**调试器**=yes&cmd=resource&f=debugger .js HTTP/1.1" 200 - 127.0.0.1 - - [13/Oct/2012 13:55:48] "GET /?**调试器**=yes&cmd=resource&f=console.png HTTP/1.1" 200 - 127.0.0.1 - - [ 2012 年 10 月 13 日 13:55:48]“GET /？**调试器**=yes&cmd=resource&f=source.png HTTP/1.1”200 - 127.0.0.1 - - [2012 年 10 月 13 日 13:55:49]“GET / favicon.ico HTTP/1.1" 500 -
> 
> 回溯（最近一次调用）：文件“/usr/local/lib/python2.7/dist-packages/flask/app.py”，第 1701 行， **调用中** 返回 self.wsgi_app(environ, start_response) 文件“/usr/local/lib/python2.7/dist-packages/flask/app.py”，第 1689 行，在 wsgi_app response = self.make_response(self.handle_exception(e) ) 文件“/usr/local/lib/python2.7/dist-packages/flask/app.py”，第 1687 行，在 wsgi_app 响应 = self.full_dispatch_request() 文件“/usr/local/lib/python2.7/ dist-packages/flask/app.py”，第 1360 行，在 full_dispatch_request rv = self.handle_user_exception(e) 文件“/usr/local/lib/python2.7/dist-packages/flask/app.py”，第 1356 行, 在 full_dispatch_request rv = self.preprocess_request() 文件 "/usr/local/lib/python2.7/dist-packages/flask/app.py", 第 1539 行, 在 preprocess_request rv = func() 文件 "/home/aaron /Dropbox/coding/webapp2/control.py”，第 22 行，在 before_request g.db = connect_db() 文件“/home/aaron/Dropbox/coding/webapp2/control.py”，第 17 行，在 connect_db 返回 sqlite3.connect(app.config['DATABASE']) OperationalError: 无法打开数据库文件

似乎问题来自此配置行：

```
DATABASE = '~/home/aaron/Dropbox/coding/webapp2/tmp/test.db' 
```

我的问题：

1) 为什么 OperationalError 被抛出两次？

2）为什么每个 OperationalError 都会调用第 17 和 22 行（在我上面的代码中注释），即使这些是函数定义而不是函数调用？

3）如果这是一个有效的数据库，数据位于指定的路径，我该如何解决？

这些是我所引用的：

[http://flask.pocoo.org/docs/tutorial/dbcon/#tutorial-dbcon](http://flask.pocoo.org/docs/tutorial/dbcon/#tutorial-dbcon)

[http://flask.pocoo.org/docs/tutorial/views/#tutorial-views](http://flask.pocoo.org/docs/tutorial/views/#tutorial-views)

[http://flask.pocoo.org/docs/patterns/sqlite3/](http://flask.pocoo.org/docs/patterns/sqlite3/)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-13T19:58:41.443

我认为问题在于`~`字符（在 shell 中有效但在 Python 中无效），因此您可能需要编写完整的绝对路径。我没有使用 Flask，但我建议在您的设置中设置 PROJECT_ROOT 常量，然后使用相对路径：

```
import os

PROJECT_ROOT = os.path.dirname(os.path.realpath(__file__))

DATABASE = os.path.join(PROJECT_ROOT, 'tmp', 'test.db') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-24T21:26:07.677

这对我有用：

在开始定义数据库时，不要只说`app.database = 'example.db'`，而是必须用**双斜杠**指定主目录路径：
`"ex : //var//www//foldername//example.db"` 如果您使用的是 linux 并再次重新启动服务器。

# python - 如何创建一个只有一个元素的元组

> ID：12876177
> 
> 赞同：149
> 
> 时间：2012-10-13T19:21:19.223
> 
> 标签：python

在下面的示例中，我希望所有元素都是元组，为什么元组只包含一个字符串时会转换为字符串？

```
>>> a = [('a'), ('b'), ('c', 'd')]
>>> a
['a', 'b', ('c', 'd')]
>>> 
>>> for elem in a:
...     print type(elem)
... 
<type 'str'>
<type 'str'>
<type 'tuple'> 
```

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2012-10-13T19:24:00.977

> 为什么元组只包含一个字符串时转换为字符串？
> 
> ```
> a = [('a'), ('b'), ('c', 'd')] 
> ```

因为前两个元素不是元组；它们只是字符串。括号不会自动使它们成为元组。您必须在字符串后添加一个逗号，以向 python 表明它应该是一个元组。

```
>>> type( ('a') )
<type 'str'>

>>> type( ('a',) )
<type 'tuple'> 
```

要修复您的示例代码，请在此处添加逗号：

```
>>> a = [('a',), ('b',), ('c', 'd')]

             ^       ^ 
```

来自[Python 文档](http://docs.python.org/tutorial/datastructures.html#tuples-and-sequences)：

> 一个特殊的问题是包含 0 或 1 项的元组的构造：语法有一些额外的怪癖来适应这些。空元组由一对空括号构成；一个包含一个项目的元组是通过一个带有逗号的值来构造的（将单个值括在括号中是不够的）。丑陋，但有效。

如果你真的讨厌尾随的逗号语法，解决方法是将 a 传递`list`给`tuple()`函数：

```
x = tuple(['a']) 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-10-13T19:23:50.857

您的前两个示例不是元组，它们是字符串。单项元组需要一个尾随逗号，如：

```
>>> a = [('a',), ('b',), ('c', 'd')]
>>> a
[('a',), ('b',), ('c', 'd')] 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-10-13T19:24:07.097

`('a')`不是元组，而只是一个字符串。

您需要在末尾添加一个额外的逗号以`python`将它们视为`tuple`：-

```
>>> a = [('a',), ('b',), ('c', 'd')]
>>> a
[('a',), ('b',), ('c', 'd')]
>>> 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2020-12-07T03:00:46.733

来到这个页面，我很惊讶为什么没有人提到一个非常常见的元组方法之一。可能这是版本的事情，因为这是一个非常古老的帖子。无论如何，它是：

```
>>> b = tuple(('a'))
>>> type(b)
<class 'tuple'> 
```

# sql-server - 我可以将 SQL Server 与 SQL Server Express 一起安装吗？

> ID：12876179
> 
> 赞同：11
> 
> 时间：2012-10-13T19:21:37.130
> 
> 标签：sql-server, installation

我已经使用了使用 SQL Server Express 2008 作为后端的第三方应用程序，因此将其安装到我的 PC（Windows 7 Ultimate）上。

我需要针对 SQL Server 2012 Web Edition 进行开发工作，因此需要将其安装到我的 PC 上。这会导致与依赖于 SQL Server Express 的应用程序发生冲突吗？我是否必须将数据从 SQL Server Express 安装迁移到 SQL Server 2012？（我担心这可能会破坏东西，因为我无法控制使用它的应用程序。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-13T19:24:56.103

多个 SQL Server 实例绝对可以在一个系统上共存。

通常，第一个实例将被称为**默认实例**，并将被寻址为`""`（无实例名称） - 例如，您使用本地机器名称（或 IP 地址）连接到它，`.`或者`(local)`（如果连接到本地安装的默认实例） .

同一台机器上的任何其他 SQL Server 实例都必须是**命名实例**，例如具有唯一名称。通常，SQL Server Express 作为`SQLEXPRESS`实例安装 - 但这是惯例，而不是技术要求。

只要您确保您的各种实例都有唯一的名称（在安装它们的那台机器上），运行 2 个（甚至更多）SQL Server 实例应该没有问题 - 具有不同的版本和版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-13T19:24:39.987

这应该没问题。

在已安装版本的计算机上安装 SQL Server 时，应提示您输入实例名称 - 这是您需要连接的实例名称。

有关更多详细信息，请参阅[这篇](http://www.informit.com/guides/content.aspx?g=sqlserver&seqNum=29)InformIt 文章。

# jquery - 在 Jeditable 中输入类型号

> ID：12876183
> 
> 赞同：2
> 
> 时间：2012-10-13T19:22:21.533
> 
> 标签：jquery, input, jeditable

我只是想知道[Jeditable Plugin](http://www.appelsiini.net/2007/8/custom-input-types)的一件事。我已经在使用并且效果很好但是如果我需要输入类型号怎么办？[演示示例](http://www.appelsiini.net/projects/jeditable/default.html)涵盖：textarea、select、text 和不同的事件

如果我需要在事件*单击时指定输入**类型号*怎么办？

 *这是我的代码：

```
 $('.click').editable(function(value, settings) { 
     console.log(this);
     console.log(value);
     console.log(settings);
     return(value);
  }, {
      event     : "click",
      submit  : 'OK',
      style  : "inherit"
 }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-20T12:25:05.267

或者简单地创建您自己的自定义类型，如文档中的描述：http: [//www.appelsiini.net/2007/custom-input-types](http://www.appelsiini.net/2007/custom-input-types)

这应该工作得很好：

```
$.editable.addInputType('number', {
  element : function(settings, original) {
      var input = $('<input type="number">');
      $(this).append(input);
      return(input);
  },
  submit : function (settings, original) {
      if (isNaN($(original).val())) {
          alert('You must provide a number')
          return false;
      } else {
          return true;
      }
  }
}); 
```

接着：

```
$('.edit_number').editable(page_url, 
    {
        type:   'number'
    }
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T10:28:00.997

好的，我已经这样做了，它看起来很有效：

我首先在我的*jquery.jeditable.js中添加了一个新的输入类型*

```
 number: {
        element : function(settings, original) {
            var input = $('<input type="number">');
            if (settings.width  != 'none') { input.attr('width', settings.width);  }
            if (settings.height != 'none') { input.attr('height', settings.height); }
            /* https://bugzilla.mozilla.org/show_bug.cgi?id=236791 */
            //input[0].setAttribute('autocomplete','off');
            input.attr('number','off');
            $(this).append(input);
            return(input);
        }
    }, 
```

然后我在我的 html 页面中创建了脚本：

```
 $('.number').editable(function(value, settings) { 
     console.log(this);
     console.log(value);
     console.log(settings);
     return(value);
  }, { 
     type    : 'number', 
     style  : "inherit"
 }); 
```

在我的html中

```
<p class="number" style="text-align: right;">000,00</p> 
```*

# sockets - 制作这款游戏 所使用的编程语言和技术是什么？

> ID：12876189
> 
> 赞同：-1
> 
> 时间：2012-10-13T19:23:18.043
> 
> 标签：sockets, browser

本页使用什么编程语言和技术制作游戏：

[http://www.mundijuegos.com/juegos/juego.php?juego=7&sala=13](http://www.mundijuegos.com/juegos/juego.php?juego=7&sala=13)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T19:28:39.243

他们使用Flash，一般情况下你只需在弹出菜单中右击看看你有没有Flash，而且一般大多数网页游戏都是用Flash或Flex开发的。

# javascript - 无法在地理编码函数中设置全局变量

> ID：12876190
> 
> 赞同：0
> 
> 时间：2012-10-13T19:23:29.087
> 
> 标签：javascript, google-maps-api-3, google-geocoding-api

我得到了这个功能：

```
function myfunc()
{
    var x;
    geo.geocode({ 'latLng': marker.getPosition() }, function (results, status) {
    somestuff...
    x = what i need;
    });
    alert(x); //x undefined...
} 
```

地理编码功能正常工作......我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:25:56.583

我认为问题在于您`x`在`callback function`. 您设置回调，然后调用`alert()`，但此时`callback function`可能尚未执行。

# java - 交换线性链表中的值并递归返回一个副本

> ID：12876196
> 
> 赞同：1
> 
> 时间：2012-10-13T19:24:05.050
> 
> 标签：java, linked-list

我正在尝试创建一个函数，该函数采用链表并搜索列表中的每个节点。如果该节点有一个匹配的 int，i1，则与 i2 交换。最后返回一个链表，它是其替换的副本。

迭代地，我想我可以创建列表的副本，遍历每个节点，然后检查和替换。

```
for(LN copy = list; copy != null; copy = copy.next;)
  if (copy.value == i1)
   copy.value == i2;
return copy; 
```

原型是

```
public static LN copySwap (LN list, int i1, int i2); 
```

我不确定如何开始递归地实现它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:29:47.210

假设构造函数`LN`接受一个值和列表中的下一个节点，这应该可以工作：

```
public static LN copySwap (LN list, int i1, int i2) {
    if (list == null) {
        return null;
    }
    return new LN(list.value == i1 ? i2 : list.value, copySwap(list.next, i1, i2));
} 
```

# wpf - wpf如何从xml文件下载数据

> ID：12876199
> 
> 赞同：-1
> 
> 时间：2012-10-13T19:24:11.383
> 
> 标签：wpf, linq-to-xml

如何从文件xml下载数据

应用程序中的数据文件

```
 XDocument dane = XDocument.Load("gpw.xml");
    List<pozycjeGpw> listaGpw = new List<pozycjeGpw>();

    private void listBox1_Loaded(object sender, RoutedEventArgs e)
    {
    }
    private void button1_Click(object sender, RoutedEventArgs e)
    {
        listaGpw = (from item in dane.Descendants("pozycja")
                    select new pozycjeGpw()
                    {
                        nazwa_notowania = (item.Element("nazwa_notowania").Value),
                        biezacy = (item.Element("biezacy").Value),
                        zmiana = (item.Element("zmiana").Value),
                        zmiana2 = (item.Element("zmiana2").Value),
                        otwarcie = (item.Element("otwarci").Value),
                        max = (item.Element("max").Value),
                        min = (item.Element("min").Value),
                    }).ToList();
        listaGpw.Insert(0, new pozycjeGpw() { nazwa_notowania = "", biezacy = "", zmiana = "", zmiana2 = "", otwarcie = "", max = "", min = "" });
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:57:46.703

I'm not entirely sure what you want to do but from your comments it appears that you have an xml file and you want to display it in a WPF application. To do this you can use `XMLDataProvider` and `HierarchicalDataTemplates` / `DataTemplates`. Here is a short tutorial on how to do it: [http://dotnet-experience.blogspot.com/2011/11/wpf-working-with-xml-and.html](http://dotnet-experience.blogspot.com/2011/11/wpf-working-with-xml-and.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T19:35:52.407

怎么样：

```
WebClient webClient = new WebClient();
String result = webClient.DownloadString(yourUrlOfTheXmlFile);
textBox.Text = result; 
```

在带有名为 textBox 的 TextBox 的表单中执行此操作应在屏幕上显示下载的 xml 文件。

如果要从系统上的文件加载此 XML，也可以使用以下命令：

```
String result = File.ReadAllText(pathOfYourXmlFile);
textBox.Text = result; 
```

# php - 类似 Facebook 的个人资料图片 php

> ID：12876200
> 
> 赞同：-1
> 
> 时间：2012-10-13T19:24:15.003
> 
> 标签：php

我有一个论坛网站。

我正在开发个人资料图片，但我有点卡住了。

我有一个代码可以返回个人资料图片，但只返回您的个人资料图片，如果您登录到您的帐户，则无法在其他帐户上查看您的图片。

基本上，我真的不知道如何用语言来解释它，但是像 Facebook 一样的个人资料图片感觉你的个人资料图片可以被其他人看到，反之亦然。

此外，登录用户名表与答案中发布的名称不同。它们都被 mysql_fetch_assoc 赋予了变量 $row。Imagelocation 是存储个人资料图像的位置，a_name 是用户在答案中发布其姓名的位置，而 name 是用户在一般登录术语中的​​位置。

```
 $name = $_SESSION['name_of_user'];
        $query = mysql_query("SELECT * FROM fgusers3 WHERE name='$name'");
       $row = mysql_fetch_assoc($query);
       $location = $row['imagelocation']; 
```

那是页面顶部的代码、查询等。下面是我要添加个人资料图像的表中的行。

```
 <td width="12%" style=";" bgcolor="#F8F7F1"><? if ($rows['a_name'] == $row['name'] ) {
echo "<img src='$location' width='100' height='100'>";
      }  ?></td> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:07:31.760

如果我正确理解了这个问题，那么您在使用 php.ini 将 url 嵌入到图像标签的 src 属性中时遇到问题。如果是这种情况，您的问题的答案就在下面的链接中。Location 应该是一个 url，你只需要正确地转义它，以便它以 html 期望的格式显示。查看您的 html 并查看正在生成的内容。

[img src 不适用于 php 变量](https://stackoverflow.com/questions/693698/img-src-wont-work-with-php-variables)

# c++ - 在 dll 中初始化记录器

> ID：12876206
> 
> 赞同：2
> 
> 时间：2012-10-13T19:24:52.710
> 
> 标签：c++, dll, g2log

我正在尝试使用 VS2012 在我的 DLL 项目中使用 g2log 日志记录库。

问题是查看文档[LINK](http://www.codeproject.com/Articles/288827/g2log-An-efficient-asynchronous-logger-using-Cplus#TOC_initialization) ” 它需要在开始时进行初始化并在程序的生命周期内保持活动状态。由于我没有 main，并且使用 DllMain 没有帮助，我在哪里可以进行初始化？（我最近开始了这个项目，所以我也接受有关日志库其他选项的建议）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T19:46:26.417

当您使用 VS2012 时，您可以使用 C++11，这意味着您可以拥有线程安全的静态，因此您可以添加一个全局函数：

```
Logger& get_logger ()
{
   static Logger logger;
   return logger;
} 
```

然后使用该 get_logg() 来获取对象（如果您需要更精细的构造/初始化，您也可以使用 C++11 中的 std::atomic<> 在此函数中执行此操作）。这是使用 std::atomic_flag 的版本：

```
Logger& get_logger ()
{
   static std::atomic_flag is_initialized;
   if (! is_initialized.test_and_set()) {
     /* do lots of initialization */
   }

   return some_object;
} 
```

我不使用也不知道 g2log 库，所以我不能给出更明确的例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T14:12:22.193

我正计划做[类似](https://github.com/d-led/g2log-dll)的事情。在某处，您正在使用该 dll。在您的用户代码中，您可以调用初始化过程，您还可以在其中配置 g2log。

# jquery - 根据输入字段更改 Connected Jquery UI 滑块的值

> ID：12876209
> 
> 赞同：2
> 
> 时间：2012-10-13T19:25:02.797
> 
> 标签：jquery, jquery-ui, uislider, jquery-ui-slider

我有 3 个连接的 jquery ui 滑块，其中的值反映在它们旁边的输入字段中。

见[http://jsfiddle.net/oniiru/gWbMp/](http://jsfiddle.net/oniiru/gWbMp/)

就像现在一样，当我滑动滑块时，输入的值会发生变化，但是如果我在输入中键入新值，我无法弄清楚如何更改滑块的值。我知道还有其他这样的例子，但没有连接滑块，我不知何故无法让它工作。有人可以帮忙吗？对不起，我对此很陌生，任何帮助将不胜感激。

作为旁注，滑块手柄也超出滑块的末端，如果有人想帮助我弄清楚如何解决这个问题，我当然会很感激。:)

谢谢大家，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:30:50.743

使用以下代码：[修改后的 jsfiddle](http://jsfiddle.net/gWbMp/3/)

```
 $("input").change(function(){

         var index = $(this).attr('class').substring(0,1);
        $("#slider_"+ index).slider('value', this.value);
        refreshSliders( index - 0 );
}); 
```

**注意**：您不应该对多个元素使用相同的 ID。（您对所有输入使用相同的 id）。

# javascript - 在带有 jquery 的 javascript 中测量大型 json 的下载进度

> ID：12876213
> 
> 赞同：1
> 
> 时间：2012-10-13T19:25:22.903
> 
> 标签：javascript, jquery, json, google-chrome-extension

有什么方法可以测量和跟踪使用 getJSON 下载大型 JSON 文件的进度，或者如果不能这样做的话。目前，由于getJSON基本上只有一个成功回调，所以在json下载完成之前我不知道发生了什么。（一分钟以上）

如果有帮助，这将是独立 chrome 应用程序和 phonegap 应用程序的一部分

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T20:42:06.300

我最终遵循了 [https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest)上的指南 并使用 XMLHTTPRequests 而不是 getJSON

我还必须在 Rails 端的 ruby​​ 上使用一些机架中间件，以在 JSON 的 HTTP 响应中包含内容长度

# c - 汇编中的 malloc 和 strdup（自我实现）

> ID：12876214
> 
> 赞同：0
> 
> 时间：2012-10-13T19:25:24.807
> 
> 标签：c, pointers, assembly

**更新：修复了我的 C 代码示例。我在汇编中从一个 char* 复制到另一个 char* 。我需要按值复制，然后将新 char* 的地址返回给调用者。**

我正在尝试在程序集中创建与以下 C 代码等效的代码，但 gdb/valgrind 报告说我正在尝试释放已经“释放”的东西。

C中的代码：

```
char* func( int x, char* name){

    namestr = (char *) malloc( strlen(name) + 1 );
    nameestr = strdup( namestr, strlen(name) +1 );
    free( name ); //Just showing what I plan to do later.

    return namestr;    
}

int main( ){
    char* name = (char *) malloc( 10 );
    *name = "0123456789"

    char* some_string = func( 10, name );
    free( some_string );
} 
```

汇编代码：

```
new_student:
    pushl   %ebp
    movl    %esp, %ebp
    pushl   %edi
    pushl   %esi
    subl    $20, %esp
    movl    12(%ebp), %ecx
    movl    %ecx, %edi
    movl    %ecx, -12(%ebp)

;get length and allocate the appropriate space
.STR_ALLOCATE:
    movl    $0, %eax
    movl    $-1, %ecx
    repnz   scasb
    notl    %ecx
    subl    $1, %eax
    addl    $1, %eax
    movl    %ecx, -8(%ebp)
    pushl   %ecx
    call    allocate
    add     $4, %esp
    movl    %eax, -16(%ebp)

;copy the string byte by byte
.STR_CPY:
    movl    -8(%ebp), %ecx
    movl    %eax, %edi
    movl    12(%ebp), %esi
    rep     movsb
    movl    -12(%ebp), %eax

.END:
    popl    %esi
    popl    %edi
    leave
    ret 
```

谁能给我一些关于我做错了什么的提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T19:38:20.440

在你的 c 代码中你已经写了

```
free(name) 
```

这可能会导致您出现问题，因为您无法释放不是由 malloc 、 calloc 或 realloc 分配的内存，而且 namestr 在您尝试释放的 main 中不可见，因为它位于 func 函数的堆栈中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T21:30:10.243

在您的汇编例程结束时，您将返回值加载到`eax`：

```
movl    -12(%ebp), %eax 
```

但是，`-12(%ebp)`包含传递给函数的指针，而不是分配的指针。您应该在返回之前执行以下操作：

```
movl    -16(%ebp), %eax 
```

（或者只是不做任何事情——`eax`从`call allocate`指令返回后似乎没有任何修改）。

# java - 如何将标题添加到 GridView？

> ID：12876221
> 
> 赞同：0
> 
> 时间：2012-10-13T19:26:13.043
> 
> 标签：java, android, layout, gridview

我有`GridView`一个日历。我想在上面的一行中添加日期名称。

我尝试在上面创建一个布局，`GridView`但它并不适合每个设备。

我也不想将标题添加为网格中的单元格，因为我希望它们看起来与其他单元格不同。

是否可以向将`GridView`根据列对齐的标题添加标题？

这是我的照片`GridView`：

![在此处输入图像描述](../Images/141d3f2407d0945402258e515d2d0a06.png)

有没有办法添加标题行？或者至少获取屏幕上每列的大小并进行计算以确定上述每个列之间需要多少`TextView`边距？`Layout``GridView`

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T02:28:12.090

首先，您必须在适配器的 getCount() 方法中添加 7，因为您需要额外的 7 个单元格作为标题

然后，在适配器的 getView() 方法中，您必须检查位置是否为 0 到 6，然后创建标题单元格，例如 Mon Tue 等。

# php - 声明一个全局数组

> ID：12876222
> 
> 赞同：18
> 
> 时间：2012-10-13T19:26:14.503
> 
> 标签：php, globals

你好。我最近学习了 PHP，并试图声明一个全局数组，以便可以在函数内部访问。但我似乎遗漏了一些东西，因为我收到错误“未定义的变量：”

这是我的代码：

```
global $second_array;
$second_array = array();

function operatii($v) {
  $var1 = $second_array[count($second_array)-1];
  $var2 = $second_array[count($second_array)-2];
  $rez = null;

  echo $var1 . $var2 . "este?";
}

for ($i = 0; $i < count($a); $i++){
  if ($a[$i] === "+" || $a[$i] === "-" || $a[$i] === "*" || $a[$i] === "/" ) {
    operatii($a[$i]);
  } else {
    array_push($second_array, $a[$i]);
  }
} 
```

我似乎可以`$second_array`在for循环中使用，但不能在operatii函数中使用。
我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-13T19:39:14.080

在 PHP 中有两种方法可以引用全局变量：

1.  `global`在每个使用该变量的函数的开头使用关键字。
2.  使用`$GLOBALS`数组。

其中，我建议坚持使用第二个，因为它始终清楚地表明该变量是全局变量。

全局变量的问题之一是跟踪它们的使用位置。使用`$GLOBALS`数组在一定程度上缓解了这个问题。

但是，使用全局变量仍然存在问题；在代码中使用太多全局变量通常被认为是不好的做法。在使用过大量广泛使用全局变量的遗留系统之后，我可以保证它们会给未来的开发人员带来很多麻烦。

使用全局变量还使得为您的代码编写正式的测试套件（即单元测试）变得更加困难。

因此，我的建议是尽可能避免使用全局变量。在某些情况下它们是必要的，但是你越能避免它们，而是将变量传递给你的函数和类而不是使它们成为全局变量，事情就会变得更好。

所以总结一下：

如果您必须使用全局变量，请使用 引用它们`$GLOBALS['varname']`，但通常最好不要使用它们。

希望有帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-04-18T09:34:07.580

**对于在谷歌搜索中遇到这个老问题的其他人，**

在示例中，变量 $second_array 被声明为全局变量，而不是在下一行中创建的数组。为避免这种情况**，请确保全局声明位于数组声明之后**。我的偏好是将全局声明放在函数本身中。

```
$second_array = array();

function operatii($v) {

    global $second_array;  

    $var1 = $second_array[count($second_array)-1];
    $var2 = $second_array[count($second_array)-2];
    $rez = null;

    echo $var1 . $var2 . "este?";
}

for ($i = 0; $i < count($a); $i++){
    if ($a[$i] === "+" || $a[$i] === "-" || $a[$i] === "*" || $a[$i] === "/" ) {
        operatii($a[$i]);
    } else {
        array_push($second_array, $a[$i]);
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-13T19:30:59.497

正如每个人所建议的那样，您应该将数组作为函数参数传递。在主要情况下，使用全局变量是一种不好的做法。

```
 function operatii($second_array, $v) {
                $var1 = $second_array[count($second_array)-1];
                $var2 = $second_array[count($second_array)-2];
                $rez = null;
                echo $var1 . $var2 . "este?";
            }

            $second_array = array();

            for ($i = 0; $i < count($a); $i++) {
                if ($a[$i] === "+" || $a[$i] === "-" || $a[$i] === "*" || $a[$i] === "/" ) {
                    operatii($second_array, $a[$i]);
                } else {
                    array_push($second_array, $a[$i]);
                }
            } 
```

# java - 如何知道数组是否包含给定的值

> ID：12876223
> 
> 赞同：2
> 
> 时间：2012-10-13T19:26:21.320
> 
> 标签：java, arrays

您好，我正在尝试弄清楚数组是如何工作的，现在我创建了一个在类中查找整数的类，但我认为我已经完成了一些工作.. 特别是方法 convert 我认为是错误的.. 它必须搜索在数组中，如果数组索引包含该值，如果是打印出来但它不起作用，有人可以解释逻辑以及如何解决它吗？（如果可能的话，举个例子）

提前致谢！下面你可以看到我的代码：

```
package h05UitgeschrevenGetal;

import java.awt.event.*;
import java.util.Random;

import javax.swing.*;

public class GetalConverter extends JPanel implements ActionListener {

private JLabel getal;
private JTextField invoer, uitvoer;
private int invoerWaarde;
private JButton converteer;

String[] klein = new String[20];
String[] groot = new String[10];

public GetalConverter() {

    getal = new JLabel("geef een geheel getal");
    add(getal);

    invoer = new JTextField(7);
    invoer.addActionListener(this);
    add(invoer);

    converteer = new JButton("In woorden");
    converteer.addActionListener(this);
    add(converteer);

    uitvoer = new JTextField(7);
    uitvoer.setEditable(false);
    add(uitvoer);

    klein[0] = "nul";
    klein[1] = "een";
    klein[2] = "twee";
    klein[3] = "drie";
    klein[4] = "vier";
    klein[5] = "vijf";
    klein[6] = "zes";
    klein[7] = "zeven";
    klein[8] = "acht";
    klein[9] = "negen";
    klein[10] = "tien";
    klein[11] = "elf";
    klein[12] = "twaalf";
    klein[13] = "dertien";
    klein[14] = "veertien";
    klein[15] = "vijftien";
    klein[16] = "zestien";
    klein[17] = "zeventien";
    klein[18] = "achtien";
    klein[19] = "negentien";

    groot[1] = "tien";
    groot[2] = "twintig";
    groot[3] = "dertig";
    groot[4] = "veertig";
    groot[5] = "vijftig";
    groot[6] = "zestig";
    groot[7] = "zeventig";
    groot[8] = "tachtig";
    groot[9] = "negentig";

}

public void setValue(int val) {

     invoerWaarde = val;
     //System.out.println(invoerWaarde);
}

public int getValue() {

    return invoerWaarde;

}

public void convert() {

    // here comes the converting code

}

@Override
public void actionPerformed(ActionEvent e) {

    setValue(Integer.parseInt(invoer.getText()));
    convert();
    //System.out.println(invoerWaarde);

}

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T19:29:36.790

您已将数组定义为：-

```
String[] strings = new String[klein]; 
```

现在，当您调用`contains`方法时：-

```
Arrays.asList(strings).contains(waar) 
```

您实际上是在检查`ArrayList`type中是否包含整数`String`。因为，`waar`是您在`convert`方法中传递的整数。你期望它如何返回一个`true`值？

> 如果数组索引包含该值，它必须在数组中搜索

对于这种情况，您需要将其传递`value`给您的`convert`方法。你还算过客`index`。

我猜你想要这样的东西： -

```
public void convert(String value) {

    for (int i = 0; i < strings.length; i++) {
        if (strings[i].equals(value)) {

            System.out.println("Value: " + strings[i]);
            System.out.println("Index: " + i);
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T19:31:57.413

```
String findValue = ...;

for(String str: strs){
   if(str.equals(findValue)){
      return true;
   }
} 
```

如果您正在寻找索引 -

```
public void convert(Integer waar) {
    for(int index=0;index<strs.length;index++){
       if(strs[index].equals(String.valueOf(waar))){
          System.out.println("index -> "+index);
       }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-14T14:03:17.130

我知道一个事实，从上面给出的代码中，你的程序只能在 0 到 99 的范围内工作。试试这个代码：

```
public void Convert()
{
   int grootVal, kleinVal;
   if(invoerWaarde < 100){
      //ok, possibility of finding it in the array.
      grootVal = (int)Math.floor(invoerWaarde / 10.0)
      kleinVal = invoerWaarde - (grootVal * 10);
      try{
         String valueString = groot[grootVal] + " " + klein[kleinVal];
         System.out.println(valueString);
      }catch(ArrayOutOfBoundsException aoobe){
          System.out.println("");
      }
   }
} 
```

# java - 使用 TreeMap 填充 ComboBox

> ID：12876232
> 
> 赞同：1
> 
> 时间：2012-10-13T19:27:41.310
> 
> 标签：java, swing, jcombobox, treemap

我正在做一个项目，该项目需要我将颜色和颜色的十六进制代码从文本文件中读取到地图中。我创建了一个 TreeMap，它在屏幕上正确存储和打印，但我不知道如何让它将数据发送到组合框。到目前为止，这是我的代码...

```
public class Project extends JFrame{

    JComboBox CBColor = new JComboBox(new String[]
    {"", "AQUA", "BLACK", "BLUE", "BROWN", "FUCHSIA", "GRAY",
    "GREEN", "INDIGO", "LIME", "MAROON", "NAVY", "ORANGE",
    "PINK", "PURPLE", "RED", "SIENNA", "TAN", "TEAL", "WHITE", "YELLOW"});
    JTextArea TAText = new JTextArea(5, 25);
    JButton BApply = new JButton("Apply");
    JButton BExit = new JButton("Exit");

    public Project() {
        JPanel SelectionPanel = new JPanel(new BorderLayout());
        SelectionPanel.add(CBColor, BorderLayout.NORTH);
        SelectionPanel.add(TAText, BorderLayout.CENTER);
        JPanel ApplyPanel = new JPanel(new FlowLayout(FlowLayout.CENTER, 10, 10));
        ApplyPanel.add(BApply);
        ApplyPanel.add(BExit);
        add(SelectionPanel, BorderLayout.NORTH);
        add(ApplyPanel, BorderLayout.SOUTH);
        BApply.addActionListener(new ButtonListener());
        BExit.addActionListener(new ExitButtonListener());
    }

    private class ButtonListener implements ActionListener {
            public void actionPerformed(ActionEvent e) {
                String BGColor = "";
                if (CBColor.getSelectedItem() == "AQUA")
                    BGColor = "#00FFFF";
                else if (CBColor.getSelectedItem() == "BLACK")
                    BGColor = "#000000";
                else if (CBColor.getSelectedItem() == "BLUE")
                    BGColor = "#0000FF";
                else if (CBColor.getSelectedItem() == "BROWN")
                    BGColor = "#A52A2A";
                else if (CBColor.getSelectedItem() == "FUCHSIA")
                    BGColor = "#FF00FF";
                else if (CBColor.getSelectedItem() == "GRAY")
                    BGColor = "#BEBEBE";
                else if (CBColor.getSelectedItem() == "GREEN")
                    BGColor = "#008000";
                else if (CBColor.getSelectedItem() == "INDIGO")
                    BGColor = "#4B0082";
                else if (CBColor.getSelectedItem() == "LIME")
                    BGColor = "#00FF00";
                else if (CBColor.getSelectedItem() == "MAROON")
                    BGColor = "#800000";
                else if (CBColor.getSelectedItem() == "NAVY")
                    BGColor = "#000080";
                else if (CBColor.getSelectedItem() == "ORANGE")
                    BGColor = "#FFA500";
                else if (CBColor.getSelectedItem() == "PINK")
                    BGColor = "#FFC0CB";
                else if (CBColor.getSelectedItem() == "PURPLE")
                    BGColor = "#800080";
                else if (CBColor.getSelectedItem() == "RED")
                    BGColor = "#FF0000";
                else if (CBColor.getSelectedItem() == "SIENNA")
                    BGColor = "#A0522D";
                else if (CBColor.getSelectedItem() == "TAN")
                    BGColor = "#D2B48C";
                else if (CBColor.getSelectedItem() == "TEAL")
                    BGColor = "#008080";
                else if (CBColor.getSelectedItem() == "WHITE")
                    BGColor = "#FFFFFF";
                else if (CBColor.getSelectedItem() == "YELLOW")
                    BGColor = "#FFFF00";
                TAText.setBackground(Color.decode(BGColor));
            }
    }

    private class ExitButtonListener implements ActionListener {
            public void actionPerformed(ActionEvent e) {
            System.exit(0);
            }
    }

    public static void main(String[] args) throws Exception {

        Map<String, String> ColorsHex = new TreeMap<String, String>();

        BufferedReader input = new BufferedReader(new FileReader("colors.txt"));
        String line = "";
        while ((line = input.readLine()) != null) {
            String parts[] = line.split(", ");
            ColorsHex.put(parts[0], parts[1]);
        }
        input.close();        
        System.out.println(ColorsHex);
        System.out.print(ColorsHex.keySet());
        System.out.print(ColorsHex.get("RED"));

        Project frame = new Project();
        frame.setTitle("Colors");
        frame.setLocationRelativeTo(null);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setVisible(true);

    }

} 
```

这会编译并运行，但我试图让组合框读取导入的值而不是输入它们，并让侦听器读取元素而不是输入它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:42:24.260

`JComboBox`没有采用`Set`. 您将不得不使用[可用的构造函数](http://docs.oracle.com/javase/7/docs/api/javax/swing/JComboBox.html#JComboBox%28javax.swing.ComboBoxModel%29)之一。

**更新：**

一种解决方案是最初使用默认构造函数`JComboBox()`，调用 load 从文件中加载颜色，然后将模型设置为`JComboBox`：

```
protected void loadColors() throws IOException {
   Map<String, String> colorsHexMap = new TreeMap<String, String>();
   BufferedReader input = new BufferedReader(new FileReader("colors.txt"));
   ...

   Set<String> keySet = colorsHexMap.keySet();
   String[] keyArray = keySet.toArray(new String[keySet.size()]);
   ComboBoxModel<String> model = new DefaultComboBoxModel<>(keyArray);
   CBColor.setModel(model);
} 
```

此外，如果您创建`TreeMap`一个类成员变量，您将能够将您的十六进制颜色选择简化为 2 行：

```
String bgColor = colorsHexMap.get(CBColor.getSelectedItem());
TAText.setBackground(Color.decode(bgColor)); 
```

# iphone - 访问块内的实例变量

> ID：12876234
> 
> 赞同：0
> 
> 时间：2012-10-13T19:27:55.970
> 
> 标签：iphone, objective-c, ios, ipad, ios5

我有一个关于在像我这样的情况下使用异步块的最佳实践的问题。

例如，我有两个控制器：（让它成为控制器 1 和控制器 2）

我将控制器 2 推入控制器 1：

```
controller2 * c = [[controller2 alloc] init];
[self.navigationController pushViewController:c animated:YES];
[c release]; 
```

controller2 有一个实例变量：

```
@interface controller2 : UITableViewController{
    UIImageView * imageView;
} 
```

分配和释放它：

```
- (id)init{
   ...
   imageView = [[UIImageView alloc] init];
   ...
}

- (void)dealloc{
   [imageView release];
   [super dealloc];
} 
```

并且 controller2 为这个 imageView 下载一个图像：

```
- (void)viewDidLoad{
 ...

[NSURLConnection sendAsynchronousRequest:request queue:[[NSOperationQueue alloc] init] completionHandler:
    ^(NSURLResponse *response, NSData *data, NSError *error) {
        UIImage * image = [[UIImage alloc] initWithData:data scale:[[UIScreen mainScreen] scale]];
        imageView.image = image; 
        [image release];    
    }];
 } 
```

显然，用户可以按下导航栏顶部的“返回”按钮，我们的 controller2 的对象将与这个 imageView 一起被释放。

情况：

*   下载开始；

*   控制器弹出（用户按下“返回”按钮）

*   下载结束，imageView.image = image 原因（？）EXC_BAD_ACCESS（因为imageView被释放）

那么，我应该怎么做才能让它在我的代码中变得很酷呢？我喜欢积木！与 NSURLConnection 委托相比，它非常有趣且代码/类更少。

*   块可能保留实例变量？(:OOO)

*   也许我应该在块之前保留我的实例变量并在块中释放它？（我认为那很愚蠢）

那么，使用这些块的最佳实践是什么？也许我不应该在这种情况下使用块来使我的代码更好？

ps：我尝试这样做：将 NSOperationQueue 作为实例变量，并停止 dealloc 中的所有任务。但这会扼杀这个块的优势 :( 在这种情况下最好将我的下载器类与委托一起使用 ;( 反正有太多代码。

pps：我知道我应该在弹出控制器后停止下载；但我不介意。让它成为任何任务（例如，转换视频等，任何“繁重的”后台线程），无论如何都应该完成，即使用户离开了这个控制器，但如果它们还活着，它将使用一些实例变量。

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:54:03.473

你应该声明你的变量：

```
 __block UIImageView*imageView; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:40:00.663

```
[NSURLConnection sendAsynchronousRequest:request queue:imageDownloadersQueue completionHandler:^(NSURLResponse *response, NSData *firstImageData, NSError *error) {
        NSLog(@"first block beginning [self retainCount] = %d, [imagesDictionary retainCount] = %d",[self retainCount], [imagesDictionary retainCount]);

        NSURLRequest * request = [NSURLRequest requestWithURL:[NSURL URLWithString:url]];
        UIImage * first_image = [[[UIImage alloc] initWithData:firstImageData scale:[[UIScreen mainScreen] scale]] autorelease];
        [NSURLConnection sendAsynchronousRequest:request queue:imageDownloadersQueue completionHandler:^(NSURLResponse *response, NSData *secondImageData, NSError *error) {
            NSLog(@"second block beginning  [self retainCount] = %d, [imagesDictionary retainCount] = %d",[self retainCount], [imagesDictionary retainCount]);
            UIImage * second_image = [[[UIImage alloc] initWithData:secondImageData scale:[[UIScreen mainScreen] scale]] autorelease];
            if(first_image && second_image){
                [imagesDictionary setObject:[NSArray arrayWithObjects:first_image, second_image, nil] forKey:match.match_id];
            }            
        }];
    }]; 
```

第一个块开始 [self retainCount] = 2, [imagesDictionary retainCount] = 1

第二个块开始 [self retainCount] = 2, [imagesDictionary retainCount] = 1

似乎块保留“自我”并在最后释放它，所以“自我”（我的实例）不能在块结束之前释放

这就是答案，嗯？希望如此 ...

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T19:45:41.933

我认为你的块方法很好。我认为是内存管理让你：为什么 controller2 在它的 dealloc 方法中释放 imageView。那应该是

```
[imageView release]; 
```

不解除分配。controller2 是否保留该 imageView？

这将起作用的原因是 NSURLConnection 块将捕获 imageView，因此即使在 controller2 消失后它也会挂起。在您按下回的情况下，控制器消失，imageView 获取一个新图像，然后它也消失了。一切都应该没问题。

我同意你的观点，积木很棒。另一件很棒的事情是 ARC，两者配合得很好。你可以在这个项目中使用 ARC 吗？

# asp.net-mvc - 我可以使用 HttpContext.Application 而不是 Session 来存储特定于会话的数据吗？

> ID：12876235
> 
> 赞同：0
> 
> 时间：2012-10-13T19:27:56.837
> 
> 标签：asp.net-mvc, asp.net-mvc-2, session-variables, session-state

我需要访问 ASP.NET MVC 2 应用程序的控制器中的用户特定数据。我的控制器类有 2 个控制器方法：

```
[ControllerSessionState(ControllerSessionState.ReadOnly)]
public class CalendarController : BasicController
{
    [Authorize]
    public ActionResult ControllerMethod1()
    {
       //reads session specific data
    }

    [Authorize]
    public ActionResult ControllerMethod1()
    {
       //stores session specific data
    }
} 
```

我希望请求被并行化，即ControllerMethod1应该能够与ControllerMethod2并行运行。出于这个原因，我将会话标记为**ReadOnly**。但是，ControllerMethod2 必须将数据写入“会话”。由于这是不允许的，我考虑将我的数据存储在 HttpContext.Application 中。我可以在对象名称中对用户 ID 进行编码，例如：

```
 HttpContext.Application["Data" + currentUser.UserId] = <<my_data>>; 
```

我可以这样做吗？这种方法有什么缺点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:04:05.187

不要指定`ControllerSessionState.ReadOnly`显然需要在会话存储中写入的控制器。

相反，尝试以另一种方式解决并发问题（例如使用适当的锁定机制）。

另外，想想同一个用户同时访问这两种方法的几率是多少。我认为这些可能性是如此之低，以至于在这种情况下不值得考虑并发性。

# ios - iOS 应用程序因 -[NSCFString count] 崩溃：如果 count 仅为 1，则尝试获取 NSMutableArray 的计数时

> ID：12876238
> 
> 赞同：0
> 
> 时间：2012-10-13T19:28:27.937
> 
> 标签：ios, arrays, count, nsmutablearray, nsarray

我会保持这个简短而甜蜜，因为我确信这是我所缺少的一些简单的东西。我正在尝试获取 NSMutableArray 的计数，该数组可以包含可变数量的对象（id 编号）。数组是从 JSon 数据创建的，并且数组本身是完美创建的，无论是单个对象还是一千个对象。

关于获取计数，如果数组包含超过 1 个对象，则一切正常，花花公子 & 计数成功返回。但是，如果数组只有一个对象/id 号......应用程序崩溃并出现 -[NSCFString count]: 错误。

这是我正在使用的代码：

```
[request setCompletionBlock:^(void)
 {
     NSString *responseCurrent = [request responseString];
     NSMutableArray *json = [responseCurrent JSONValue];
     NSMutableArray *currentList = [[json valueForKeyPath:@"groupTO"] valueForKeyPath:@"currentList"];

     NSMutableArray *idNumArr = [[NSMutableArray alloc]init];
     idNumArr = [currentList valueForKey:@"idNumber"];
     debug(@"THIS IS ID ARRAY:  %@",idNumArr);

     debug(@"THIS IS COUNT OF THE ID ARRAY:  %@",[idNumArr count]);

     //  Ive also tried this to get the count, with no variation in results

     //  int countOfidNums = [idNumArr count];
     //  debug(@"count of arr:  %d",countOfidNums); 
```

我需要得到这个计数来实现条件来处理当这个数组只包含一个对象时出现的其他问题。

我假设问题源于数组中的对象是字符串这一事实，当只有一个对象时，它只是作为没有分隔逗号的字符串出现？？？也许？？？帮助！！！！

另外：不确定它是否有所作为，但我正在使用 ARC。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T19:35:29.820

这里的问题是，当你到达那条线时，`idNumArr`它不是一个数组，而是一个字符串。如果您不相信我，请`[idNumArr class]`在此之前打印出来，或者使用调试器介入。

```
 NSMutableArray *idNumArr = [[NSMutableArray alloc]init];
 idNumArr = [currentList valueForKey:@"idNumber"]; 
```

`[currentList valueForKey:@"idNumber"]`显然返回了一个字符串（并且没有理由在该分配之前立即分配数组。您可能想要：

```
 NSMutableArray *idNumArr = [[NSMutableArray alloc]init];
 [idNumArr addObject:[currentList valueForKey:@"idNumber"]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T19:35:34.000

```
idNumArr = [currentList valueForKey:@"idNumber"]; 
```

在这一行中，currentList 返回一个 NSString，并且“count”不是 NSString 中的方法（您可以在此处查看：[NSString class reference](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)

请记住，这里您使用的是指针，并且“键值”返回一个 id 指针（没有关联类型）。所以你必须检查“valueForKey”返回的对象实际上是不是一个NSArray。

```
if([idNumArr isKindOfClass:[NSMutableArray class]])
//Then you can use "count" 
```

请注意，上面的代码还没有经过测试，甚至没有经过语法检查。但是搜索该方法“isKindOfClass”以检查您在 idNumArr 中使用的对象类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T19:35:42.717

问题似乎是 idNumArr 实际上是一个字符串而不是一个数组。添加这样的日志，看看它给你什么：

```
idNumArr = [currentList valueForKey:@"idNumber"];
NSLog(@"%@", idNumArr class]); 
```

数组中只有一个字符串这一事实不应导致此问题。

# ruby - 如何配置 optparse 以接受两个参数选项作为命令？

> ID：12876239
> 
> 赞同：0
> 
> 时间：2012-10-13T19:28:35.280
> 
> 标签：ruby, command-line, optparse

我正在使用 Ruby 的`optparse`库来解析我的命令行应用程序的选项，但我不知道如何也接受命令。

它会是这样的：

```
commit -f -d init 
```

`init`在这种情况下将是命令。它并不总是必需的，因为如果用户没有提供任何命令，则应该运行一个默认命令。

这是我现在拥有的代码：

```
OptionParser.new do |opts|
  opts.banner  = %Q!Usage:
  pivotal_commit                                          # to commit with a currently started issue
  pivotal_commit -f                                       # to commit with a currently started issue and finish it
  pivotal_commit -d                                       # to commit with a currently started issue and deliver it
  pivotal_commit init -e "me@gmail.com" -p my_password -l #to generate a config file at the current directory!

  opts.on("-e", "--email [EMAIL]", String, "The email to the PT account you want to access") do |v|
    options[:email] = v
  end

  opts.on("-p", "--password [PASSWORD]", String, "The password to the PT account you want to access") do |v|
    options[:password] = v
  end

  opts.on("-f", '--finish', 'Finish the story you were currently working on after commit') do |v|
    options[:finish] = v
  end

  opts.on('-d', '--deliver', 'Deliver the story you were currently working on after commit') do |v|
    options[:deliver] = v
  end

  opts.on_tail('-h', '--help', 'Show this message') do
    puts opts
    exit
  end

  opts.on_tail('-v', '--version', 'Show version') do
    puts "pivotal_committer version: #{PivotalCommitter::VERSION}"
    exit
  end

end.parse! 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T15:52:49.953

命令行参数（不是选项）在`ARGV`调用之后，`OptionParser#parse!`因为`#parse!`从`ARGV`. 所以，你可以得到这样的子命令：

```
options = {}

OptionParser.new do |opts|
# definitions of command-line options...
# ...
end.parse!

subcommand = ARGV.shift || "init"

print "options: "
p options
puts "subcommand: #{subcommand}" 
```

如果您有许多子命令，[Thor](https://github.com/wycats/thor/wiki) gem 可能会帮助您。

而且，虽然这不是您问题的答案，但选项定义中的方括号（[]）意味着选项的参数是可选的。例如，根据您的定义，即使通过了选项，电子邮件和密码也可能为零：

```
$ pivotal_commit -e
options: {:email=>nil}
subcommand: init 
```

如果您在传递选项时需要参数，请删除括号：

```
# ...
  opts.on("-e", "--email EMAIL", String, "The email to the PT account you want to access") do |v|
    options[:email] = v
  end
# ... 
```

现在需要电子邮件参数：

```
$ pivotal_commit -e
pivotal_commit:6:in `<main>': missing argument: -e (OptionParser::MissingArgument) 
```

# c# - 如何进行定点除法？

> ID：12876242
> 
> 赞同：1
> 
> 时间：2012-10-13T19:29:01.840
> 
> 标签：c#, fixed-point

我有一个使用 long 的 8 字节定点数，其恒定分母为 (1 << 24)。如何对两个 Fixed8 值进行除法？由于我使用的是 C#，因此我不能简单地转换为更大的整数。还是我在语言上想太多了？

谢谢。

```
public struct Fixed8
{
    private long _numerator;
    public const long DENOMINATOR = 1 << 24;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T22:57:42.053

这是一种将所有计算保存在`long`s 中的方法。不过，它可能不会更快。我没有量过。

```
public struct Fixed8
{
    public Fixed8(double value)
    {
        _numerator = (long)(value * DENOMINATOR);
    }

    private long _numerator;
    public const long DENOMINATOR = 1 << 24;

    public static Fixed8 operator /(Fixed8 a, Fixed8 b)
    {
        long remainder;
        long quotient = Math.DivRem(a._numerator, b._numerator, out remainder) * DENOMINATOR;

        long morePrecision = remainder * DENOMINATOR / b._numerator;

        return new Fixed8 { _numerator = quotient + morePrecision };
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T19:53:01.680

您可以使用[BigInteger 结构](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.aspx)来执行计算：

```
public static Fixed8 operator /(Fixed8 a, Fixed8 b)
{
    Fixed8 result;
    result._numerator = (long)( new BigInteger(a._numerator) *
                                new BigInteger(DENOMINATOR)  /
                                new BigInteger(b._numerator) );
    return result;
} 
```

*完整代码：*

```
public const long DENOMINATOR = 1 << 24;

private long _numerator;

public Fixed8(double value)
{
    _numerator = (long)(value * DENOMINATOR);
}

public static Fixed8 operator /(Fixed8 a, Fixed8 b)
{
    Fixed8 result;
    result._numerator = (long)( new BigInteger(a._numerator) * 
                                new BigInteger(DENOMINATOR)  / 
                                new BigInteger(b._numerator) );
    return result;
}

public static explicit operator double(Fixed8 a)
{
    return (double)a._numerator / (double)DENOMINATOR;
}

public override string ToString()
{
    return ((double)this).ToString();
} 
```

*例子：*

```
var a = new Fixed8(7);
var b = new Fixed8(1.7);

Console.WriteLine(a);
Console.WriteLine(b);
Console.WriteLine(a / b); 
```

*输出：*

```
7
1.69999998807907
4.11764705181122

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T19:32:14.823

```
public long Division()
{
    long result = _numerator / DENOMINATOR;
    return result;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-13T20:17:15.637

使用 a`System.Numerics.BigInteger`很好。但是在这种特定情况下， a`System.Decimal`实际上具有足够的精度。所以这是我的建议：

```
 public static Fixed8 operator /(Fixed8 a, Fixed8 b)
 {
   decimal resultNumerator = (decimal)a._numerator * DENOMINATOR / b._numerator;
   return new Fixed8 { _numerator = Convert.ToInt64(resultNumerator) };
 } 
```

# java - 如何为 JAXBElement 创建 JSON？

> ID：12876245
> 
> 赞同：0
> 
> 时间：2012-10-13T19:29:25.930
> 
> 标签：java, json, jersey, jaxbelement

背景

```
@XmlRootElement
public class Person {
    private String firstName;
    private String lastName;

    ...//accessors
}

@Path("mypath")
 public class PersonResource{
   @POST
   @Produces({MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML})
    public Response addPerson(JAXBElement<Person> jaxbPerson) {
      Person person = jaxbPerson.getValue();
       ...//logic etc.
   }     
} 
```

`PersonResource. addPerson`会接受`{"firstName":"Alfred","lastName":"Bell"}`但不会`{"person":{"firstName":"Alfred","lastName":"Bell"}}`。

因此，我有以下问题。

问题：

给定

```
@XmlRootElement
public class car {
    private String maker;
    private String model;

   private AirBag airbag;
   private List<Tire> tires;

   @XmlElementWrapper(name = "tires")
   @XmlElement(name = "tire")
   public Set<Tire> get Tires() {
       return this.tires;
   }
    ...// more accessors
}

@Path("add-car")
 public class CarResource{
   @POST
   @Produces({MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML})
    public Response addPerson(JAXBElement<Car> jaxbCar) {
       Car car = jaxbCar.getValue();
       ...//logic etc.
   }     
} 
```

如何格式化 JSON 以便`JAXBElement<Car> jaxbCar`识别它？汽车必须有四个轮胎和一个安全气囊。

细节：

我正在使用泽西岛（Java REST-API）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T23:36:13.597

尝试将您的对象作为参数发送给 addPerson() 方法

```
public Person  addPerson(Person person){

    Person fme = new Person ();
        ...
} 
```

并且不要忘记`@XmlAccessorType(XmlAccessType.FIELD)`之前的添加`@XmlrootElement`

# ios - iOS 6 MapKit VoiceOver 在 Pin 之前读取 POI

> ID：12876247
> 
> 赞同：5
> 
> 时间：2012-10-13T19:29:37.217
> 
> 标签：ios, mapkit, accessibility, voiceover, ios6-maps

在 VoiceOver 下测试时，我的代码在 iOS 5 下运行良好。我的代码将一个集合添加`MKPinAnnotationViews`到`MKMapView`. 我在 iOS 6 中的问题是画外音在到达我添加的引脚之前会读取街道名称和其他 POI（可能很多）。有没有办法重新排序这些？我似乎找不到 Apple 关于如何为 iOS 6 的地图添加图钉的任何建议。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-01-03T08:18:12.463

处理您的情况的最佳方法是**使用转子**排序并仅选择您在谓词中指定的注释。

要了解应该如何实现它，我建议您观看**WWDC 2016 - What's New in Accessibility**视频，其内容[在这里](http://a11y-guidelines.orange.com/mobile_EN/dev-ios-wwdc-16202.html)得到了完美的总结，并通过一个详细的示例充分解释了此功能的工作原理。

# android - ListView Android“已停止”

> ID：12876253
> 
> 赞同：0
> 
> 时间：2012-10-13T19:30:17.880
> 
> 标签：android, listview

我正在尝试制作一个 listview 应用程序，并且从昨天发生在我身上，应用程序意外停止......这是我的代码：

```
package com.example.listview;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    ListView myListView = (ListView)findViewById(R.id.myListView);
    final EditText myEditText = (EditText)findViewById(R.id.myEditText);
    final ArrayList<String> todoItems = new ArrayList<String>();
    final ArrayAdapter<String> aa;
    aa = new ArrayAdapter<String>(this, R.layout.activity_main, todoItems);
    myListView.setAdapter(aa);

    myEditText.setOnKeyListener(new View.OnKeyListener() {
        public boolean onKey(View v, int keyCode, KeyEvent event) {
           if (event.getAction() == KeyEvent.ACTION_DOWN)
             if ((keyCode == KeyEvent.KEYCODE_DPAD_CENTER) || (keyCode == KeyEvent.KEYCODE_ENTER)) {
               todoItems.add(0, myEditText.getText().toString());
               aa.notifyDataSetChanged();
               myEditText.setText("");
               return true;
           }
        return false;
        }
   });

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
} 
```

这个应用程序用“日任务”做一个列表，你把这个“日任务”放在 EditText

编辑：这里是activity_main.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<ListView
    android:id="@+id/myListView"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginTop="100dp" >
</ListView>

<EditText
    android:id="@+id/myEditText"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="26dp"
    android:ems="10" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T19:39:59.970

如果没有您的 LogCat，我们只能*猜测*问题所在，但我发现您的适配器存在一个潜在错误：

```
new ArrayAdapter<String>(this, R.layout.activity_main, todoItems); 
```

这是在您的适配器中使用的错误布局，因为它会在第一个 ListView 内创建多个 ListView... 您应该传递一个简单的布局，例如：

```
new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, todoItems); 
```

# javascript - 如何获取 json 日期格式的日期？

> ID：12876254
> 
> 赞同：0
> 
> 时间：2012-10-13T19:30:24.643
> 
> 标签：javascript, json

我将一些信息存储在一个手写的 json 文件中。其中一个字段是日期（我只需要月份和年份。）

在前端，我使用我的 JS Frameworks 内置转换函数将该日期呈现为更易于阅读的格式。

我的问题 - 1\. 我如何首先获得那个 json 日期。是否有可以简化转换的节点或 Web 应用程序。2.如果我只需要月份+年份，有没有一种好方法可以忽略json日期的某些部分以忘记月份和时间中的具体日期？

参考：
[http ://docs.angularjs.org/api/ng.filter:date](http://docs.angularjs.org/api/ng.filter:date)

Json 本身就是这样简单的东西 -

```
[
 {
  "title": "One Dummy Book",
  "authors": "One Dummy Author",
  "pubdate": XXXXX
 },
 {
  "title": "Another Book",
  "authors": "Another Author"
  "pubdate": XXXXX
 }
] 
```

我应该如何写下我的出版日期或`pubdate`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T19:42:23.090

不幸的是，JSON 中没有日期的序列化和反序列化规范，所以这完全取决于您。

您可以标准化使用 unix 时间戳或更易读的值（例如 ISO-8601），并且取决于您是否需要您的恢复器自动将值恢复为日期，您可能还需要添加某种将其指定为日期的前缀或模式 - 例如'//date//1350157276920//date//'或类似的。

由于您只需要月份和年份，因此使用 ISO-8601 语法可能更容易，因为它只是 'yyyy-mm'。

# javascript - 如何重写此代码以避免使用全局变量？

> ID：12876258
> 
> 赞同：2
> 
> 时间：2012-10-13T19:30:49.853
> 
> 标签：javascript

过去我再次遇到过这个问题，我使用了全局变量，但我想知道还有什么其他方法可以处理它。

代码来自我目前正在玩[的一个 html5 画布教程。](http://billmill.org/static/canvastutorial/move.html)

```
var x = 150;
var y = 150;
var dx = 2;
var dy = 4;
var ctx;

function init() {
  ctx = $('#canvas')[0].getContext("2d");
  return setInterval(draw, 10);
}

function draw() {
  ctx.clearRect(0,0,300,300);
  ctx.beginPath();
  ctx.arc(x, y, 10, 0, Math.PI*2, true); 
  ctx.closePath();
  ctx.fill();
  x += dx;
  y += dy;
}

init(); 
```

我能做些什么来避免使用全局变量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T19:37:06.307

您可以使用模块模式 - 这是提供封装的一种巧妙方式：

```
var app = app || {};
app = (function () {
  var x = 150; // all these variables are private
  var y = 150;
  var dx = 2;
  var dy = 4;
  var ctx;

  var draw = function() { // this method is private
    ctx.clearRect(0,0,300,300);
    ctx.beginPath();
    ctx.arc(x, y, 10, 0, Math.PI*2, true); 
    ctx.closePath();
    ctx.fill();
    x += dx;
    y += dy;
  };

  return {
    init: function() { // this method is public
      ctx = $('#canvas')[0].getContext("2d");
      return setInterval(draw, 10);
    }
  }
}());

app.init(); // init() is public, but all the other vars and functions are not 
```

[在http://addyosmani.com/largescalejavascript/#modpattern](http://addyosmani.com/largescalejavascript/#modpattern)了解更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-13T19:35:49.560

[您可以使用一个对象，如此处](http://jsfiddle.net/RCJK7/)所示

```
myObj = {
    x: 150,
    y: 150,
    dx: 2,
    dy: 4,
    ctx: null,
    init: function() {
        this.ctx = $('#canvas')[0].getContext("2d");
        return setInterval((function(a){return function(){a.draw()}})(this), 10);
    },
    draw: function() {
        this.ctx.clearRect(0,0,300,300);
        this.ctx.beginPath();
        this.ctx.arc(this.x, this.y, 10, 0, Math.PI * 2, true);
        this.ctx.closePath();
        this.ctx.fill();
        this.x += this.dx;
        this.y += this.dy;
    }
}

myObj.init(); 
```

**重要信息**完全披露，~~此代码无法按原样运行~~。虽然我坚持我的一般方法，但 setInterval 仍然需要传递正确的上下文。我已经修复了我的答案以反映上述内容，并在小提琴链接中添加了一个工作示例。如果上下文传递让您感到困惑，请使用其他方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T19:35:28.573

将它们作为参数传递，并返回修改后的它们：

```
function init() {
  var x = 150;
  var y = 150;
  var dx = 2;
  var dy = 4;
  var ctx = $('#canvas')[0].getContext("2d");
  return setInterval(function() {
    var temp = draw(x, y, dx, dy, ctx);
    x = temp.x;
    y = temp.y;
  }, 10);
}

function draw(x, y, dx, dy, ctx) {
  ctx.clearRect(0,0,300,300);
  ctx.beginPath();
  ctx.arc(x, y, 10, 0, Math.PI*2, true); 
  ctx.closePath();
  ctx.fill();
  x += dx;
  y += dy;
  ret = {};
  ret.x = x;
  ret.y = y;
  return ret;
} 
```

（我不完全确定需要传递什么；如果可以，请少传递以减少耦合。）

但是，此解决方案不如@Asad 提出的更类似于类的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-13T19:49:01.047

将所有内容包装在一个对象或一个负责全局变量的 IIFE 中是很诱人的，而且确实很容易，但这并没有真正为聚会带来任何新东西。我建议一个简单的闭包，其中所有变量都设置在`init`函数内。在这个函数中，我们定义了`draw`函数，以便该函数可以访问闭包变量。由于该函数仅用于设置间隔，因此我省略了名称，因为在此闭包中根本不需要命名函数。

```
var init = function()
{
    var x, y, dx, dy, ctx = document.getElementById('canvas').getContext('2d');
    return setInterval(function()
    {
        ctx.clearRect(0,0,300,300);
        ctx.beginPath();
        ctx.arc(x, y, 10, 0, Math.PI*2, true); 
        ctx.closePath();
        ctx.fill();
        x += dx;
        y += dy;
    },10);
};
var iv = init();//<-- best off storing the interval somewhere
//... stop drawing:
clearInterval(iv); 
```

仅此而已。

# java - 在 Android 中使用 Windows Azure 服务总线队列

> ID：12876259
> 
> 赞同：0
> 
> 时间：2012-10-13T19:30:56.637
> 
> 标签：java, android, azure, sdk, servicebus

从不涉及直接处理 HTTP 请求的 android 应用程序访问 Windows Azure 服务总线队列是否有替代方法？例如，第三方库或 SDK，或有关如何在 Android 项目上使用 Windows Azure SDK for Java 的说明？

azure [-sdk-for-java](https://github.com/WindowsAzure/azure-sdk-for-java)显然与 Android 不兼容。我的理解是它直接引用了一些核心库，比如javax.inject。`trouble processing "javax/xml/stream/EventFilter.class"`尝试通过 Maven 在 Android 项目中使用它会导致错误，例如`Ill-advised or mistaken usage of a core class (java.* or javax.*) when not building a core library.`

[wa-toolkit-android](https://github.com/WindowsAzure-Toolkits/wa-toolkit-android/tree/master/library/storage/src/com/windowsazure/samples/android/storageclient)只支持存储，不支持服务总线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T21:55:45.510

您可以使用支持来自 Node.js 的服务总线的 Windows Azure 移动服务。Scott Guthrie 在这里解释了这一点：[http ://weblogs.asp.net/scottgu/archive/2012/10/16/windows-azure-mobile-services-new-support-for-ios-apps-facebook-twitter- google-identity-emails-sms-blob-service-bus-and-more.aspx](http://weblogs.asp.net/scottgu/archive/2012/10/16/windows-azure-mobile-services-new-support-for-ios-apps-facebook-twitter-google-identity-emails-sms-blobs-service-bus-and-more.aspx)。Node.js 和服务总线解释在这里： http: [//www.windowsazure.com/en-us/develop/nodejs/how-to-guides/service-bus-topics/](http://www.windowsazure.com/en-us/develop/nodejs/how-to-guides/service-bus-topics/)

今天，如 Chris Risner 所述，Android 可以连接到 Windows Azure Mobile 服务：http: [//chrisrisner.com/Windows-Azure-Mobile-Services-and-Android](http://chrisrisner.com/Windows-Azure-Mobile-Services-and-Android)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:59:23.447

您可以查看[适用于 Java 的 Windows Azure SDK，](http://www.windowsazure.com/en-us/develop/java/)它包含有关如何使用服务总线队列和主题的库和示例代码。[这里还有一篇关于如何使用普通 java](http://www.windowsazure.com/en-us/develop/java/how-to-guides/service-bus-queues/)中的队列的帖子，以防万一。

# ruby-on-rails - Rails 双重编码我的 json

> ID：12876261
> 
> 赞同：0
> 
> 时间：2012-10-13T19:31:51.117
> 
> 标签：ruby-on-rails, ruby

所以我试图返回一个包含其他对象数组的对象，并且我正在取回所有转义的对象 eg( `\"name\":\"My Name\"`)。我确定问题是我是双重编码，但我是 ruby​​ n00b，所以我不确定如何正确执行此操作

```
@Results = Marker.where("ID = '#{params[:id]}' and Stop_Id IS null").all

format.all { render json: { :Results => @Results.to_json(:include => :stops) } } 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T21:49:11.677

您应该覆盖`as_json`模型中的方法。

[请参阅此处获取建议。](http://jonathanjulian.com/2010/04/rails-to_json-or-as_json/)

# php - 来自具有最常用单词的多个字符串的新字符串

> ID：12876272
> 
> 赞同：2
> 
> 时间：2012-10-13T19:32:54.573
> 
> 标签：php, string

我正在尝试使用这些字符串之间最常见的单词从多个字符串中创建一个新字符串。例如：

```
$string[0] = 'Apple iPhone 4S 16GB Locked to Orange';
$string[1] = 'iPhone 4S 16GB boxed new';
$string[2] = 'iPhone 4S 16GB unlocked brand new';
$string[3] = 'Apple iPhone 16GB 4S Special Offer';
$string[4] = 'Apple iPhone 4S Sim Free';

## The new string should be:

$new_string = 'Apple iPhone 4S 16GB'; 
```

可能有数百个原始字符串，或者只有 2 个......

我不知道从哪里开始，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T19:38:46.297

你可以试试

```
$string = array();
$string[0] = 'Apple iPhone 4S 16GB Locked to Orange';
$string[1] = 'iPhone 4S 16GB boxed new';
$string[2] = 'iPhone 4S 16GB unlocked brand new';
$string[3] = 'Apple iPhone 16GB 4S Special Offer';
$string[4] = 'Apple iPhone 4S Sim Free';

print(getCommon($string)); 
```

输出

```
Apple iPhone 4S 16GB 
```

使用的功能

```
function getCommon($array,$occurance = 3)
{
    $array = array_reduce($array, function($a,$b) { $a = array_merge($a,explode(" ", $b)); return $a; },array());
    return implode(" ",array_keys(array_filter(array_count_values($array),function($var)use($occurance) {return $var > $occurance ;})));
} 
```

[观看现场演示](http://codepad.viper-7.com/xMfYcq)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T19:37:37.437

类似以下内容应该可以帮助您入门：

```
function getWordCount($someArray)
{
    $wordList = array();
    foreach($someArray as $item) {
        $wordList = array_merge($wordList, explode(' ', $item));
    }

    $result = array_count_values($wordList);
    arsort($result);

    return $result;
} 
```

注意我根据空格字符爆炸，这不考虑标点符号等，例如`.`or `,`。如果你想解决这个问题，你应该使用一些简单的正则表达式模式来根据你的要求获取字符串中的单词。

演示：[http ://codepad.viper-7.com/IuAc2s](http://codepad.viper-7.com/IuAc2s)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T20:05:48.510

另一种方法

```
$min_times_present = 3;
$words  = array();
foreach ($string as $str) {
  $words_string = preg_split('/\s+/', $str, 0, PREG_SPLIT_NO_EMPTY);
  foreach ($words_string as $word) {
    $words[$word] = (isset($words[$word])) ? $words[$word]+1 : 1;
  }
}
$result_arr = array_filter($words, function($value) use ($min_times_present) {
  return ($value >= $min_times_present);
});
arsort($result_arr, SORT_NUMERIC);
$result_str = implode(' ', array_keys($result_arr)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-28T01:34:42.310

我有一个类似的问题，我的解决方案是将所有短语合并到一个单词数组中，然后获取出现次数最多的单词：

```
$string = array();
$string[0] = 'Apple iPhone 4S 16GB Locked to Orange';
$string[1] = 'iPhone 4S 16GB boxed new';
$string[2] = 'iPhone 4S 16GB unlocked brand new';
$string[3] = 'Apple iPhone 16GB 4S Special Offer';
$string[4] = 'Apple iPhone 4S Sim Free';
$words=array();
for($i=0;$i<count($string);$i++){
    $words = array_merge($words,str_word_count($string[$i],1));
}

$instances = array_count_values($words);
arsort($instances);
$instances = array_slice($instances,0,5);
foreach($instances as $word=>$count){
    echo $word.' ';
}
    // Outputs "iPhone S GB Apple new" 
```

这种方法的问题是，如果一个词在同一个字符串中出现多次，它的出现次数将会增加。

# java - 井字游戏在游戏树搜索中打印最佳移动路径？

> ID：12876273
> 
> 赞同：0
> 
> 时间：2012-10-13T19:32:58.323
> 
> 标签：java, tic-tac-toe

我正在研究带有井字游戏（3x3）的 alpha-beta 修剪算法。目前对于 3x3 网格的任何给定实例，我都能够找出最佳情况：

```
public Best chooseAlphaBetaMove(int whosMov, int alpha, int beta) {

    Best reply = new Best();  
    Best myBest = new Best();

    if ((scoreGrid()==COMPUTER_WIN) || (scoreGrid()==OPPONENT_WIN) || 
                                       (scoreGrid()==GAME_DRAW)) {
        int score = scoreGrid();
        return new Best(score,-3,-3,count);
    }

    if (whosMov==COMPUTER_MOVE) {
        myBest.score = alpha;
    } else {
        myBest.score = beta;
    }

    for (int i=0; i<3; i++) {
    for (int j=0; j<3; j++) {
        if (layOut[i][j]==0) {
            moveGrid(whosMov,i,j);
            reply = chooseAlphaBetaMove(-whosMov,alpha,beta); 
            unmoveGrid(i,j);

            if ((whosMov==COMPUTER_MOVE)&&(reply.score>myBest.score)) {
                myBest.score = reply.score;
                alpha = reply.score;
                myBest.row = i;
                myBest.column = j;
            }

            if  ((whosMov==OPPONENT_MOVE)&&(reply.score<myBest.score)) {
                myBest.score = reply.score;
                beta = reply.score;
                myBest.row = i;
                myBest.column = j;
            }
            if (beta <= alpha) return myBest;
        }
    }
    }

        return myBest;
} 
```

最佳结构在哪里：

```
public class Best {

    public int score;
    public int row;
    public int column;
    public int count
} 
```

给定一个初始网格以及接下来谁将移动，我可以知道下一个玩家的最佳得分和最佳位置。但是，我不知道如何为这个最佳动作打印整个路径。（注意 - 我不想要整个搜索路径。我只想打印出从这个最佳移动到叶子的单个搜索路径）。有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T19:57:39.827

当您递归地沿着每条路径前进时，您需要跟踪它，可能通过将对 List/Stack 的引用传递到每个`chooseAlphaBetaMove`调用中。当您找到比当前最佳路径更好的路径时，您会获取当前路径的副本，并将其存储为“迄今为止的最佳路径”。完成后，您可以打印出最佳路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T19:57:13.813

您需要一些方法来跟踪搜索中的最佳移动。我的建议是保留一个包含最佳移动列表的数据结构。A`Stack`似乎是最适合这种情况的数据结构。在每次递归调用中，将第一个动作压入堆栈（因为这是迄今为止最好的动作）。当找到更好的移动时，弹出堆栈并推送新的。在您的 alpha-beta 修剪算法完成后，只需弹出堆栈并打印每个动作。这将给出“最佳”动作的顺序，直到游戏结束。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T21:29:27.813

[http://xkcd.com/832/](http://xkcd.com/832/)是一种可视化 TTT 树的有效方法

# java - 哈希表不接受字符串作为键

> ID：12876274
> 
> 赞同：1
> 
> 时间：2012-10-13T19:32:59.637
> 
> 标签：java, string, key, hashtable

我不明白为什么 Eclipse 给我一个关于将 BufferedReader 返回的字符串传递给 Hashtable 的 put(Object,Object) 方法的错误。我已经阅读了 API，我不认识任何线索。也许它不能确定它会返回一个唯一的字符串吗？

字符串*字典*设置在文件的其他位置，我已将其剥离到重要的部分 - 有问题的方法及其变量发生的任何事情。

```
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.Hashtable;

public class Model {
     private Hashtable hash=new Hashtable();
     private String dictionary;

     public void loadWords() throws IOException{
        BufferedReader br=null;

        try{        
            br=new BufferedReader(new FileReader(dictionary));
            do{
                hash.put(br.readLine(), new Node<E>);
            }
            while(br.readLine()!=null);

        }catch(IOException iOE){
            System.out.println("Fission mailed");
        }
        finally{
            br.close(); // Closing the buffered reader
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T19:36:49.317

看起来这不是 key 的问题，而是 value 部分的问题。您不能将`new Node<E>`其添加为值。它必须具有特定类型，例如`new Node<String>()`or `new Node<Integer>()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T19:48:25.717

\1。您没有调用节点的构造函数： hash.put(br.readLine(), new Node);

要调用默认构造函数，您必须使用类的名称调用“方法”，例如：

新字符串（）；/*或*/ new Node();

\2。泛型类型 <E> 在类的声明中的任何地方都看不到。要使用它，您必须执行以下操作：

```
 public class Model<E> {
       private Hashtable<String, Node<E>> hash=new Hashtable<String, Node<E>> (); 
```

..所以要么一路走下去，要么完全删除它。

# java - 如何使这种递归方法成为迭代方法？

> ID：12876275
> 
> 赞同：2
> 
> 时间：2012-10-13T19:33:00.820
> 
> 标签：java

我需要`Raju()`使用for循环来制作方法，所以我该怎么做？

```
public class Fall2012COP3337MidtermRecursion 
{
    // trace recursion
    public static void main(String[] args) 
    {        
        System.out.println("Raju(6) = " + Raju(6));        
    }

    // compute the nth Raju number
    private static long Raju(int n)
    {        
        if (n < 0)
           return 0L;
        if (n == 0 || n == 1)
           return 1L;

        return Raju(n-1) + Raju(n-2) + 1; // recurse
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T19:59:38.823

这应该这样做......它会编译。来自 Lewyx 的以下帖子的更正版本。（循环条件和编译错误）

```
public class Fall2012COP3337MidtermRecursion {
    // trace recursion
    public static void main(String[] args) 
    {
        for (int i = 0; i < 20 ; i++){
            System.out.println("RajuRecursion("+i+") = " + RajuRecursion(i)); 
            System.out.println("RajuIterative("+i+") = " + RajuIterative(i));

            // we see same results :)
        }
    }

    // decent iterative variant
    private static long RajuIterative(int n){

        long sum=0;
        long l1 = 1;
        long l2 = 1;

        if(n<0) return 0L; 
        if(n<2) return 1L;

        while(0<--n)
        {
            sum=l1+l2+1;
            l2=l1;
            l1=sum;
        }
        return sum;
    }

    // compute the nth Raju number
    private static long RajuRecursion(int n)
    {        
        if (n < 0)
           return 0L;
        if (n == 0 || n == 1)
           return 1L;

        return RajuRecursion(n-1) + RajuRecursion(n-2) + 1; // recurse
    }
} 
```

结果是：

```
RajuRecursion(0) = 1
RajuIterative(0) = 1
RajuRecursion(1) = 1
RajuIterative(1) = 1
RajuRecursion(2) = 3
RajuIterative(2) = 3
RajuRecursion(3) = 5
RajuIterative(3) = 5
RajuRecursion(4) = 9
RajuIterative(4) = 9
RajuRecursion(5) = 15
RajuIterative(5) = 15
RajuRecursion(6) = 25
RajuIterative(6) = 25
RajuRecursion(7) = 41
RajuIterative(7) = 41
RajuRecursion(8) = 67
RajuIterative(8) = 67
.... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T19:59:09.187

```
private static long Raju_Iterative(int n)
{        
    if (n < 0)
        return 0L;
    long a = 1L;
    long b = 1L;
    for(int i = 0; i < n-1; i++) {
        long c = a+b+1;
        a = b;
        b = c;
    }
    return b;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T20:03:49.040

```
static long Raju(int n) {
    if (n < 0) return 0;
    if (n < 2) return 1;

    long nm1 = 1, nm2 = 1;
    for (int i = 2; i <= n; ++i) {
        long raju = nm1 + nm2 + 1;
        nm2 = nm1;
        nm1 = raju;
    }

    return raju;
} 
```

# performance - 使用 Spring 3.1、Hibernate 4.1、Dbunit 等提高数据库测试的性能

> ID：12876278
> 
> 赞同：2
> 
> 时间：2012-10-13T19:33:06.170
> 
> 标签：performance, spring, hibernate, unit-testing, dbunit

我目前正在开始一个新项目，并且我有大约 190 个存储库测试。我注意到的一件事——我不完全确定为什么会发生这种情况——是针对 HSQLDB (2.2.8) 的集成测试的运行速度比我认为的要慢得多。

我想我已经在每次测试之前跟踪了数据插入的瓶颈。对于大多数测试，设置数据库的时间范围为 0.15 到 0.38 秒。这是无法接受的。我原以为内存数据库会快得多:(

这是我的所有存储库测试都扩展自的数据库测试类：

```
@ContextConfiguration(locations = {"classpath:applicationContext.xml"})
@RunWith(SpringJUnit4ClassRunner.class)
@TransactionConfiguration(defaultRollback=true)
@Transactional
public abstract class DatabaseTest {

    public static final String TEST_RESOURCES = "src/test/resources/";

    @Autowired
    protected SessionFactory sessionFactory;

    @Autowired
    protected UserRepository userRepository;

    @Autowired
    protected DataSource dataSource;

    protected IDatabaseTester databaseTester;

    protected Map<String, Object> jdbcMap;
    protected JdbcTemplate jdbcTemplate;

    @PostConstruct
    public void initialize() throws SQLException, IOException, DataSetException {
        jdbcTemplate = new JdbcTemplate(dataSource);

        setupHsqlDb();

        databaseTester = new DataSourceDatabaseTester(dataSource);
        databaseTester.setSetUpOperation(DatabaseOperation.CLEAN_INSERT);
        databaseTester.setTearDownOperation(DatabaseOperation.NONE);
        databaseTester.setDataSet(getDataSet());
    }

    @Before
    public void insertDbUnitData() throws Exception {
        long time = System.currentTimeMillis();

        databaseTester.onSetup();

        long elapsed = System.currentTimeMillis() - time;
        System.out.println(getClass() + " Insert DB Unit Data took: " + elapsed);
    }

    @After
    public void cleanDbUnitData() throws Exception {
        databaseTester.onTearDown();
    }

    public IDataSet getDataSet() throws IOException, DataSetException {
        Set<String> filenames = getDataSets().getFilenames();

        IDataSet[] dataSets = new IDataSet[filenames.size()];
        Iterator<String> iterator = filenames.iterator();
        for(int i = 0; iterator.hasNext(); i++) {
            dataSets[i] = new FlatXmlDataSet(
                new FlatXmlProducer(
                    new InputSource(TEST_RESOURCES + iterator.next()), false, true
                )
            );
        }

        return new CompositeDataSet(dataSets);
    }

    public void setupHsqlDb() throws SQLException {
        Connection sqlConnection = DataSourceUtils.getConnection(dataSource);
        String databaseName = sqlConnection.getMetaData().getDatabaseProductName();
        sqlConnection.close();

        if("HSQL Database Engine".equals(databaseName)) {
            jdbcTemplate.update("SET DATABASE REFERENTIAL INTEGRITY FALSE;");

            // MD5
            jdbcTemplate.update("DROP FUNCTION MD5 IF EXISTS;");
            jdbcTemplate.update(
                "CREATE FUNCTION MD5(VARCHAR(226)) " +
                    "RETURNS VARCHAR(226) " +
                    "LANGUAGE JAVA " +
                    "DETERMINISTIC " +
                    "NO SQL " +
                    "EXTERNAL NAME 'CLASSPATH:org.apache.commons.codec.digest.DigestUtils.md5Hex';"
            );
        } else {
            jdbcTemplate.update("SET foreign_key_checks = 0;");
        }
    }

    protected abstract DataSet getDataSets();

    protected void flush() {
        sessionFactory.getCurrentSession().flush();
    }

    protected void clear() {
        sessionFactory.getCurrentSession().clear();
    }

    protected void setCurrentUser(User user) {
        if(user != null) {
            Authentication authentication = new UsernamePasswordAuthenticationToken(user,
                user, user.getAuthorities());

            SecurityContextHolder.getContext().setAuthentication(authentication);
        }
    }

    protected void setNoCurrentUser() {
        SecurityContextHolder.getContext().setAuthentication(null);
    }

    protected User setCurrentUser(long userId) {
        User user = userRepository.find(userId);

        if(user.getId() != userId) {
            throw new IllegalArgumentException("There is no user with id: " + userId);
        }

        setCurrentUser(user);

        return user;
    }

    protected User getCurrentUser() {
        return (User) SecurityContextHolder.getContext().getAuthentication().getPrincipal();
    }

} 
```

这是我的应用程序上下文中的相关 bean：

```
<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="locations" value="classpath:applicationContext.properties"/>
</bean>

<bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"
      destroy-method="close">
    <property name="driverClass" value="${database.driver}"/>
    <property name="jdbcUrl" value="${database.url}"/>
    <property name="user" value="${database.username}"/>
    <property name="password" value="${database.password}"/>
    <property name="initialPoolSize" value="10"/>
    <property name="minPoolSize" value="10"/>
    <property name="maxPoolSize" value="50"/>
    <property name="idleConnectionTestPeriod" value="100"/>
    <property name="acquireIncrement" value="2"/>
    <property name="maxStatements" value="0"/>
    <property name="maxIdleTime" value="1800"/>
    <property name="numHelperThreads" value="3"/>
    <property name="acquireRetryAttempts" value="2"/>
    <property name="acquireRetryDelay" value="1000"/>
    <property name="checkoutTimeout" value="5000"/>
</bean>

<bean id="sessionFactory"
      class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource"/>
    <property name="mappingResources">
        <list>
            <value>...</value>
        </list>
    </property>
    <property name="namingStrategy">
        <bean class="org.hibernate.cfg.ImprovedNamingStrategy"/>
    </property>
    <property name="hibernateProperties">
        <props>
            <prop key="javax.persistence.validation.mode">none</prop>

            <prop key="hibernate.dialect">${hibernate.dialect}</prop>
            <prop key="hibernate.hbm2ddl.auto">${hibernate.hbm2ddl.auto}
            </prop>
            <prop key="hibernate.generate_statistics">false</prop>

            <prop key="hibernate.show_sql">false</prop>
            <prop key="hibernate.format_sql">true</prop>

            <prop key="hibernate.cache.use_second_level_cache">false</prop>
            <prop key="hibernate.cache.provider_class">

            </prop>
        </props>
    </property>
</bean>

<bean class="org.springframework.orm.hibernate4.HibernateExceptionTranslator"/>

<bean id="transactionManager"
      class="org.springframework.orm.hibernate4.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory"/>
</bean> 
```

为了尝试插入更少的数据，我允许每个测试类选择一个只加载它需要的数据的 DataSet 枚举。它是这样指定的：

```
public enum DataSet {
    NONE(create()),
    CORE(create("core.xml")),
    USERS(combine(create("users.xml"), CORE)),
    TAGS(combine(create("tags.xml"), USERS)), 
```

这会导致它运行得更慢而不是更快吗？这个想法是，如果我只想要核心 xml（语言、省份等），我只需要加载那些记录。我认为这会使测试套件更快，但它仍然太慢。

**我可以通过创建一个专门为每个测试类设计的单独的 xml 数据集来节省一些时间。这会删除一些插入语句。但即使我在单个 xml 数据集中有 20 个插入语句（因此，除了将数据集直接内联到 java 代码中之外，最小的 I/O 损失），在初始化期间每个测试仍然需要 0.1 到 0.15 秒数据库数据！**我不敢相信将 20 条记录插入内存需要 0.15 秒。

在我使用 Spring 3.0 和 Hibernate 3.x 的另一个项目中，在每次测试之前插入所有内容需要 30 毫秒，但实际上每次测试插入 100 行或更多行。对于只有 20 个插入的测试，它们就像没有延迟一样在飞行。这是我所期望的。我开始认为问题出在 Spring 的注释上——或者我在`DatabaseTest`课堂上设置它们的方式。这基本上是现在唯一不同的地方。

此外，我的存储库使用 sessionFactory.getCurrentSession() 而不是 HibernateTemplate。这是我第一次开始使用 Spring 中基于注释的单元测试，因为 Spring 测试类已被弃用。这可能是他们进展缓慢的原因吗？

如果您还需要知道任何其他信息来帮助解决问题，请告诉我。我有点难过。

编辑：我输入了答案。问题是 hsqldb 2.2.x。恢复到 2.0.0 解决了这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T19:54:36.713

恕我直言，这看起来很快。我见过慢得多的集成测试。也就是说，有多种方法可以使您的测试更快：

*   减少插入数据量
*   如果数据集相同并且前一个测试是只读测试（通常是这种情况，尤其是在每次测试结束时回滚时），请避免插入与前一个测试相同的数据。

我想应该可以用 DbUnit 来做。如果你准备好使用另一个框架，你可以使用我自己的[DbSetup](http://dbsetup.ninja-squad.com/)，它支持开箱即用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-14T00:13:56.817

问题是 Hsqldb 2.2.8。我恢复到 2.0.0，性能立即提升了 8-10 倍或更好。它不再需要 150-280 毫秒，而是下降到 7-15（有时是 20）毫秒。

我的整个测试套件（490 个测试）现在只需 18 秒而不是 80 秒即可运行。

我想给大家一个提示：避免使用 hsqldb 2.2.x。我认为他们添加了多线程支持，这会导致此类用例出现性能问题。

# vba - 在 Visual Basic 中导入外部函数

> ID：12876282
> 
> 赞同：0
> 
> 时间：2012-10-13T19:33:34.393
> 
> 标签：vba, vb6

我是 Visual Basic 的新手，我在每个地方都在寻找答案，似乎他们认为我的知识比我实际拥有的要多。

我有一个带有一些函数实现的 .bas 文件。我想以某种方式“导入”、“包含”或任何 vb 术语，这些功能以便我可以使用它们。我将如何继续这样做。从我所看到的最接近我正在寻找的东西是 Imports 命令，但我将如何使用它？像这样？：

```
Imports "foos.bas" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T22:06:50.330

您不导入，而是将文件“foos.bas”添加到您的项目中。有几种方法可以做到这一点。您可以使用“**文件**”菜单或项目资源管理器中的上下文菜单。一旦文件被添加到您的项目中，如果过程（Sub 或 Function）或属性被声明为公共，您可以从表单、其他模块（.bas 文件）或项目中的类中调用它们。如果您想了解更多，这里有一个完整解释的链接：[Working with Projects in VisualBasic 6](http://www.1sayfa.com/1024/diger/vb/ch05.htm)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T22:07:53.330

对于 .bas 文件，您不能像我认为的那样使用导入。您可以右键单击 VBA 项目并选择导入文件，但这只会将其复制进去。

如果你有 dll，你可以直接在 VBA中导入这样的**DLL 函数。**

```
Private Declare Function function_name Lib "dll_file.dll" Alias _
         "fake_name" (Arg1, Arg2, ...) As ReturnType 
```

例子：

```
Private Declare Function GetOpenFileName Lib "comdlg32.dll" Alias _
         "GetOpenFileNameAlias" (openFN As OPENFILENAME) As Long 
```

# jquery - js.erb 中的 jQuery 语法

> ID：12876284
> 
> 赞同：1
> 
> 时间：2012-10-13T19:33:48.237
> 
> 标签：jquery, ruby-on-rails, erb

我在 js.erb 文件中添加了一个新元素，并尝试将点击事件分配给新添加的元素。

这就是我在 js.erb 中的内容：

```
$("#<%= linkid %>").on("click", '<%= j function(event) {$(this).parent().next().toggle(); event.preventDefault();}) %>' ); 
```

使用“$”编写函数时出现语法错误。这里有什么解决方法？如果我必须将此函数放在此文件中的 var 中，我该怎么做？一般来说，有没有更好的方法？

更新：错误信息

```
/create.js.erb:7: syntax error, unexpected $undefined
....append= ( j function(event) {$(this).parent().next().toggle...
...                               ^
/create.js.erb:7: syntax error, unexpected ')', expecting keyword_end
...(); event.preventDefault();}) );@output_buffer.safe_concat('...
...                               ^): 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T19:40:49.057

里面`<%= ... %>`的东西应该是 Ruby 表达式，而不是 JavaScript。这个：

```
<%= j function(event) {$(this).parent().next().toggle(); event.preventDefault();}) %> 
```

根本不需要 ERB，那只是普通的旧 JavaScript。此外，jQuery 的第二个参数[`$(...).on('click', ...)`](http://api.jquery.com/on/)应该是 JavaScript 函数，而不是 JavaScript 字符串。你要这个：

```
$("#<%= linkid %>").on("click", function(event) {
    $(this).parent().next().toggle();
    event.preventDefault();
}); 
```

# mobile - Galaxy s iii 网络浏览器 DisplayModeProvider "MVC4"

> ID：12876289
> 
> 赞同：0
> 
> 时间：2012-10-13T19:34:45.943
> 
> 标签：mobile, asp.net-mvc-4, samsung-mobile

我的应用程序是 MVC4，它适用于 iPhone 和 Windows Phone，但不适用于三星 Galaxy S III，它显示桌面用户界面！我尝试了几个 InexOf，例如：

```
 DisplayModeProvider.Instance.Modes.Insert(0, new DefaultDisplayMode("Mobile")
            {
                ContextCondition = (context => context.GetOverriddenUserAgent()
                    .IndexOf("Linux", StringComparison.OrdinalIgnoreCase) >= 0)
            }); 
```

我也试过：

```
DisplayModeProvider.Instance.Modes.Insert(0, new DefaultDisplayMode("Mobile")
{
    ContextCondition = (context => context.GetOverriddenUserAgent()
        .IndexOf("Opera Mobi", StringComparison.OrdinalIgnoreCase) >= 0)
}); 
```

我使用我开发的较旧的 MVC3 应用程序检查了三星 III 浏览器，以下是浏览器信息：用户代理：Mozilla/5.0（Linux，U；Android 4.0.4 .... 浏览器：Safari 型号 SGH-1747M

我会很感激你的建议。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T07:19:09.423

以防万一有人遇到同样的问题。我在 MVC4 中盯着一个新项目（我之前使用的是 MVC4 的 Beta 版）Install-Package jQuery.Mobile.MVC；现在可以了。该问题与三星无关，因为我在 LG Android 上尝试了该应用程序并遇到了同样的问题。我还在全局文件中添加了以下内容：

```
 DisplayModeProvider.Instance.Modes.Insert(0, new DefaultDisplayMode("Linux")
           {
               ContextCondition = (context => context.GetOverriddenUserAgent().IndexOf
                   ("Linux", StringComparison.OrdinalIgnoreCase) >= 0)
           }); 
```

# javascript - 如何使用 JS 提交表单

> ID：12876293
> 
> 赞同：1
> 
> 时间：2012-10-13T19:35:16.120
> 
> 标签：javascript, jquery, html, forms

> **可能重复：**
> [提交不是 javascript 中的函数](https://stackoverflow.com/questions/833032/submit-is-not-a-function-in-javascript)

我正在尝试使用 JS 提交表单，但没有运气。[这是代码。**JSFIDDLE**](http://jsfiddle.net/4kg8c/)

```
<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript">
    function validate () {
        alert('start');        
        $('#myform').submit();
        alert('end');        
    }
    </script>
</head>
<body>
    <form id="myform" name="myform" method="post" action="">
        <input type="button" value="submit" id="submit" onclick="validate();" >
    </form>
</body>
</html> 
```

问题是“**为什么它不起作用？** ”。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-13T19:40:03.410

您有一个 id`submit`与表单方法冲突的表单元素，`submit`请将提交按钮 id 更改为其他内容。

您可以将表单元素作为表单对象的属性访问，因此如果您有一个表单，例如 myForm，并且表单中的输入带有 id 或名称 submit，那么 myForm.submit 将是带有 id 提交的输入元素，而不是原始的提交方法。

见[http://jsfiddle.net/4kg8c/1/](http://jsfiddle.net/4kg8c/1/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-13T19:42:26.090

控制台中的错误是

```
Uncaught TypeError: Property 'submit' of object #<HTMLFormElement> is not a function 
```

问题是您通过命名元素提交来劫持 sumit() 函数。将按钮的 id 更改为 btnSubmit。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T19:41:07.737

我已经使用解决方案修改了您的代码。

提交按钮的名称丢失。并且不要使用名称作为提交的“提交”。它与JS冲突。

```
<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript">
    function validate () {
        document.myform.submit();   
    }
    </script>
</head>
<body>
    <form id="myform" name="myform" method="post" action="">
        <input type="button" name="save" value="submit" id="submit" onclick="validate();" >
    </form>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-13T19:39:50.850

如果这是您编写的确切代码，那么我认为您没有在页面中包含 jQuery 库。

您需要先包含 jQuery 文件，然后才能使用该`$("#myform")`符号。

还要指定一些您要将页面提交到的操作 URL？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-13T19:38:16.490

您使用 jQuery 代码（`$`函数），但不包含 jQuery 源代码。

# c++ - 缺少范围变量OpenCV c ++

> ID：12876304
> 
> 赞同：0
> 
> 时间：2012-10-13T19:36:04.830
> 
> 标签：c++, opencv, template-matching

我有一个程序应该对图像和模板进行模板匹配，这是代码：

```
 int main()
{
   IplImage* imgOriginal = cvLoadImage("image.jpg", 0);
   IplImage* imgTemplate = cvLoadImage("template.jpg", 0);
   IplImage* imgResult = cvCreateImage(cvSize(imgOriginal->width-imgTemplate->width+1, imgOriginal->height-imgTemplate->height+1), IPL_DEPTH_32F, 1);
   cvZero(imgResult);
   cvMatchTemplate(imgOriginal, imgTemplate, imgResult, CV_TM_CCORR_NORMED);
   double min_val=0, max_val=0;
   CvPoint min_loc, max_loc;
   cvMinMaxLoc(imgResult, &min_val, &max_val, &min_loc, &max_loc);
   cvRectangle(imgOriginal, max_loc, cvPoint(max_loc.x+imgTemplate->width, max_loc.y+imgTemplate->height), cvScalar(0), 1);
   printf("%f", max_val);
   cvNamedWindow("result");
       cvShowImage("result", imgOriginal);
       cvWaitKey(0);
       return 0;
} 
```

包含文件：

```
 #include "opencv2/highgui/highgui.hpp"
#include "opencv2/imgproc/imgproc.hpp"

#include <iostream>
#include "stdio.h"

using namespace cv;
using namespace std; 
```

当我运行代码时，我收到此错误：

```
templateMatching.cpp:16:75: error: ‘cvMatchTemplate’ was not declared in this scope 
```

知道问题是什么吗？在此先感谢，马特

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-13T20:14:09.227

你需要包括

```
#include "opencv2/imgproc/imgproc_c.h" 
```

# mvvm-light - 为什么不工作：RelayCommand RaiseCanExecuteChanged

> ID：12876324
> 
> 赞同：2
> 
> 时间：2012-10-13T19:38:33.987
> 
> 标签：mvvm-light, relaycommand

当我`PressCommand.RaiseCanExecuteChanged();`在`TimerOnElapsed`方法中调用时，什么也没发生。

可能是什么问题呢？（GalaSoft.MvvmLight.WPF4 v4.0.30319 和 GalaSoft.MvvmLight.Extras.WPF4 v4.0.30319）

这是我的测试代码：

```
using System.Timers;
using System.Windows;
using GalaSoft.MvvmLight;
using GalaSoft.MvvmLight.Command;

namespace CommandTest {

public class MainWindowVM : ViewModelBase {

    public MainWindowVM() {

        PressCommand = new RelayCommand(
                            () => MessageBox.Show("Pressed"),
                            () => _canExecute);

        PressCommand.CanExecuteChanged += (sender, args) => System.Diagnostics.Debug.WriteLine(System.DateTime.Now.ToLongTimeString() + " CanExecuteChanged");

        _timer = new Timer(1000);
        _timer.Elapsed += TimerOnElapsed;
        _timer.Enabled = true;
    }

    public RelayCommand PressCommand { get; private set; }

    #region Private

    private void TimerOnElapsed(object sender, ElapsedEventArgs elapsedEventArgs) {
        _canExecute = !_canExecute;
        PressCommand.RaiseCanExecuteChanged();

        System.Diagnostics.Debug.WriteLine("At {0} enabled: {1}", elapsedEventArgs.SignalTime.ToLongTimeString(), _canExecute);
    }

    private readonly Timer _timer;
    private bool _canExecute;

    #endregion

}
} 
```

先感谢您

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-18T14:29:42.323

解释：

该`TimerOnElapsed`方法在工作线程上运行，但调用`PressCommand.RaiseCanExecuteChanged();`必须在 UI 线程上。

所以这是解决方案，更新的`TimerOnElapsed`方法：

```
 private void TimerOnElapsed(object sender, ElapsedEventArgs elapsedEventArgs) {
        _canExecute = !_canExecute;
        Application.Current.Dispatcher.Invoke(PressCommand.RaiseCanExecuteChanged);
        System.Diagnostics.Debug.WriteLine("At {0} enabled: {1}", elapsedEventArgs.SignalTime.ToLongTimeString(), _canExecute);
    } 
```

# php - 将一个数组切片成 4 个其他数组

> ID：12876333
> 
> 赞同：1
> 
> 时间：2012-10-13T19:39:40.927
> 
> 标签：php, arrays, slice

我有一个数组，我想将它分成 4 个其他数组，因为我想在四列上显示第一个数组的内容。

我已经尝试了上面的代码，但我得到的是包含 4 个项目的 N 列。

```
$groups = array();
for ($i = 0; $i < count($menu); $i += 4) $groups[] = array_slice($menu, $i, 4); 
```

是否可以对其进行修改以获得准确的 4 列并分配值以使其适合？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T19:59:10.793

就像 Michael Berkowski 建议的那样：

```
$groups = array_chunk($menu,4); 
```

应该给你你需要的。如果您更喜欢*“体力劳动”*：

```
$groups = array();
while($groups[] = array_splice($menu,0,4))
{//no need for any code here ^^ chunks the array just fine
    printf('This loop will run another %d times<br/>',(int)ceil(count($menu)/4));
} 
```

*更新：*

我看到我有点错了......想要分成4个数组，而不是四个数组：

```
$groups = array_chunk($menu,(int)ceil(count($menu)/4)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T20:06:02.003

你可以试试

```
// Some Random array
$array = range(1, 20);

// Split it 4 Chuncks
$array = array_chunk($array, 4);

// Slice The first 4 Chunks
$array = array_slice($array, 0, 4);

// Output Result
foreach ( $array as $set ) {
    printf("<li>%s</li>", implode(",", $set));
} 
```

# python - Urwid：如何查看错误？

> ID：12876335
> 
> 赞同：1
> 
> 时间：2012-10-13T19:39:48.143
> 
> 标签：python, urwid

我正在使用`urwid`库构建具有交互式控制台界面（行 htop，atop 实用程序）的应用程序，所以我的麻烦是：由于界面占用了控制台窗口中的所有空间 - 我看不到 python 的错误，我试图这样做：

```
import sys
f = open("test_err", "w")
original_stderr = sys.stderr
sys.stderr = f

print a #a is undefined

sys.stderr = original_stderr
f.close() 
```

它在我不使用 urwid 时有效，但在我使用时无效......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T20:19:56.160

这就是我想出的。我正在利用 unicode-rxvt (urxvt) 功能在文件描述符中传递。当然，这意味着您需要在 X 环境中进行开发，而不是在控制台中。

```
from __future__ import print_function

import os
from datetime import datetime

_debugfile = None

def _close_debug(fo):
    fo.close()

def DEBUG(*obj):
    """Open a terminal emulator and write messages to it for debugging."""
    global _debugfile
    if _debugfile is None:
        import atexit
        masterfd, slavefd = os.openpty()
        pid = os.fork()
        if pid: # parent
            os.close(masterfd)
            _debugfile = os.fdopen(slavefd, "w+", 0)
            atexit.register(_close_debug, _debugfile)
        else: # child
            os.close(slavefd)
            os.execlp("urxvt", "urxvt", "-pty-fd", str(masterfd))
    print(datetime.now(), ":", ", ".join(map(repr, obj)), file=_debugfile) 
```

这将在您第一次调用 DEBUG 时自动打开一个新的终端窗口并在退出时将其关闭。然后传递给它的任何消息都会显示在这个新窗口中。这是您的“调试窗口”。因此，您的主应用程序可以正常运行，不会被消息弄得一团糟，但您仍然可以在这个新终端中看到调试输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T21:11:10.727

您可以尝试将错误重定向到文件。每次运行程序后，都需要刷新文件。大多数编辑器让您通过按 f5 轻松完成此操作

```
def main():
    #your code here
    print someError #raises an error

try: #run main function
    main()
except BaseException as err: #catch all errors
    with open('errors.txt','a') as errors: #open a file to write the errors to
        errors.write(err.message+'\n')#write the error 
```

如果您只想一次在文件中看到一个错误（而不是在一个文件中长时间出现多个错误），请将 open 函数中的“a”更改为“w”。

如果您想在错误发生时立即看到错误，您可以让错误捕获器打开一个包含错误的窗口。

```
def main():
    #your code here
    print someErr

try: #run main function
   main()
except BaseException as err: #catch all errors
    import Tkinter as tk #imports the ui module

    root = tk.Tk() #creates the root of the window

    #creates the text and attaches it to the root
    window = tk.Label(root, text=err.message)
    window.pack()

    #runs the window
    root.mainloop() 
```

[如果你想建立自己的窗口来捕捉错误，你可以在这里](http://www.pythonware.com/library/tkinter/introduction/index.htm)了解 Tkinter 。（它内置在python中，你不必安装任何东西）

# objective-c - Objective-C：向无法响应的对象发送消息时是否调用了任何回调？

> ID：12876337
> 
> 赞同：0
> 
> 时间：2012-10-13T19:39:53.770
> 
> 标签：objective-c, ios

如果我向目标对象发送消息，但这是目标对象不知道如何响应的消息（没有定义），发生这种情况后是否会调用任何方法？在 Ruby 中，有一个 method_missing 方法。在 Objective-C 中是什么，有什么等价的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:04:22.267

正如 Richard J. Ross III 所说，您应该使用 -(BOOL)respondsToSelector:(SEL)aSelector 来查看对象是否响应它。答案是否定的，objective-c 中没有这种东西

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T19:41:01.927

这会引发 NSException。无法识别的选择器发送到实例等等。

# updatepanel - UpdatePanel + jquery 使用 on()

> ID：12876340
> 
> 赞同：0
> 
> 时间：2012-10-13T19:40:12.137
> 
> 标签：updatepanel, jquery

我一直在遇到著名的 jQuery 在回发后无法运行的问题。所以我做了一些研究，最好的新方法是 jQuery 的 live() 函数。但事实证明，这个从 1.7 版开始就被弃用了，取而代之的是 on() 函数。所以我将我的 jQuery 插件转换为使用 on() 函数，但它在回发后仍然不起作用。

插件：

```
$(document).ready(function () {
    $('.drag').on("mouseover", function () {
        AfterPostBack();
        $(this).draggable()
          .click( function () {
              $(this).draggable({ disabled: false });
          }).dblclick( function () {
              $(this).draggable({ disabled: true });
          });
    });
    $('.text_label').on("blur",function () {

        $(this).removeClass('focus');
    });
});

var AfterPostBack = function () {
  $('.drag').draggable("option", "containment", 'parent');
  $('.drag').draggable("option", "snap", 'parent');
   $('.drag').draggable("option", "cursor", 'move');
 }; 
```

网页：

```
<script type="text/javascript" src="Scripts/jquery-1.8.0.min.js"></script>
<script type="text/javascript" src="Scripts/jquery-ui-1.8.23.custom.min.js"></script>
<script type="text/javascript" src="Scripts/myplugin.js"></script>
<link href="Styles/myplugin.css" rel="stylesheet" type="text/css" />

<asp:UpdatePanel runat="server" ID="UP1" UpdateMode="Conditional" ChildrenAsTriggers="false"> 
<ContentTemplate>   
 <asp:Button ID="btn_AddText" runat="server" Text="Add Text" OnClick="AddText" />
<asp:PlaceHolder ID="ph1" runat="server">
    <div class="drag">
        <asp:Label ID="lbl1" class="text_label" runat="server" Text="Click Me"/>
     </div>
</asp:PlaceHolder>
</ContentTemplate>
<Triggers>
<asp:AsyncPostBackTrigger ControlID="btn_AddText" EventName="Click" />
</Triggers>
</asp:UpdatePanel> 
```

希望对此有所帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T19:51:54.800

您可以使用`function pageLoad(sender, args) { }`而不是`$(document).ready()`

> ASP.NET AJAX pageLoad() 快捷函数不是针对特定于浏览器的优化，而是作为更统一过程的结果而被调用。
> 
> 该过程在所有浏览器上以相同的方式排队，通过调用 setTimeout 超时为 0 毫秒。这个技巧利用 JavaScript 的单线程执行模型（理论上）将 init 事件推回，直到 DOM 刚刚完成加载。
> 
> 与直觉相反，这不是调用 pageLoad() 的唯一点。在每次部分回发之后也会调用它。它基本上是 Application.Init 和 PageRequestManager.EndRequest 的组合。

来源：[https ://encosia.com/document-ready-and-pageload-are-not-the-same/](https://encosia.com/document-ready-and-pageload-are-not-the-same/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-23T23:23:10.820

每页刷新有 2 个事件 add_init 和 document.ready 在同一时间运行

第二个是触发每个异步回发的页面加载，但在第一次加载时未触发

我做了 3 个函数并将代码放在相关的位置

```
Sys.Application.add_init(function () {
        // Initialization code here, meant to run once.
        try {
            //doOnes();
            doAllways();
        } catch (e) {
            console.log('Sys.Application.add_init: ', e);
        }
});

$(document).ready(function () {
  console.log('document.ready');
  //doAllways();
}

function pageLoad() {
  console.log('pageLoad');
  //doAftrerAjax();
  doAllways();
}

function doOnes() {
  console.log('doOnes');
}

function doAftrerAjax() {
  console.log('doAftrerAjax');
}

function doAllways(){
  console.log('doAllways');
  AfterPostBack();             <---this the place for the code
} 
```

`

# android - 初始化时会调用 LocationListener 的 onLocationChanged 吗？

> ID：12876347
> 
> 赞同：0
> 
> 时间：2012-10-13T19:41:20.803
> 
> 标签：android, locationlistener

我正在制作一个 LocationListener。创建时，是否会调用 onLocationChanged？（原来没有位置，所以叫它是有道理的）

还是有其他方法可以获取当前位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T19:45:25.280

您可以自己轻松地测试这个问题......

但是，是的，如果您创建一个`LocationListener`并调用`LocationManager#requestLocationUpdates()`，则在获取第一个位置*后*`onLocationChanged()`调用。了解如果您在无法接收任何 GPS 或网络信号的地方（在厚建筑或洞穴中），您可能永远不会收到位置修复...

# objective-c - 具有多个条件的“if”语句

> ID：12876348
> 
> 赞同：1
> 
> 时间：2012-10-13T19:41:21.287
> 
> 标签：objective-c, ios, if-statement

`if`所以我正在制作一个转换器应用程序，但在使用语句计算我的答案时遇到了问题。我有一个`UIPickerWheel`选择`convertFrom`和`convertTo`一个`textField`输入。

我的问题是，使用下面提到的代码，答案标签只显示随机单位，而不是在`pickerWheel`.

我认为我的错是`if`声明没有检查两者是否相同，只是其中之一。我如何让它检查两者是否正确，或者以正确的方式进行？

[下载完整项目](http://www.mediafire.com/?bmwosmfs2ir76oz)

代码：

```
#pragma mark -
#pragma mark PickerView Delegate
-(void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row
  inComponent:(NSInteger)component
{
    float convertFrom = [[_convertRates objectAtIndex:[pickerView selectedRowInComponent:0]] floatValue];
    float convertTo = [[_convertRates objectAtIndex:[pickerView selectedRowInComponent:1]] floatValue];
    float input = [inputText.text floatValue];
    float to = convertTo;
    float from = convertFrom;
    float convertValue = input;
    float mtpaTilMtpaFloat = convertValue * 1;
    float mtpaTilMMcfdayFloat = convertValue * 2;
    float mtpaTilMillSm3dayFloat = convertValue * 3;
    float mtpaTilMMBTUFloat = convertValue * 4;
    float mtpaTilPJPAFloat = convertValue * 5;
    float MMcfdayTilmtpaFloat = convertValue * 0.5;
    float MMcfdayTilMMcfdayFloat = convertValue * 1;
    float MMcfdayTilMillSm3dayFloat = convertValue *6;
    float MMcfdayTilMMBTUFloat = convertValue *7;
    float MMcfdayTilPJPAFloat = convertValue *8;
    float MillSm3dayTilMTPAFloat = convertValue /3;

    NSString *mtpaTilmtpa = [[NSString alloc ] initWithFormat:
                             @" %f MTPA = %f MTPA", convertValue, mtpaTilMtpaFloat];

    NSString *mtpaTilMMcfday = [[NSString alloc ] initWithFormat:
                                @" %f MTPA = %f MMcf/day", convertValue, mtpaTilMMcfdayFloat];

    NSString *mtpaTilMillSm3day = [[NSString alloc] initWithFormat:
                                   @" %f MTPA = %f Mill.SM3/day", convertValue, mtpaTilMillSm3dayFloat];

    NSString *mtpaTilMMBTU = [[NSString alloc] initWithFormat:
                              @" %f MTPA = %f MMBTU", convertValue, mtpaTilMMBTUFloat];

    NSString *mtpaTilPJPA = [[NSString alloc] initWithFormat:
                             @" %f MTPA = %f PJPA", convertValue, mtpaTilPJPAFloat];

    NSString *MMcfdayTilmtpa = [[NSString alloc] initWithFormat:
                                @" %f MMcfday = %f MTPA", convertValue, MMcfdayTilmtpaFloat];

    NSString *MMcfdayTilMMcfday = [[NSString alloc] initWithFormat:
                                   @" %f MMcfday = %f MMcfday", convertValue, MMcfdayTilMMcfdayFloat];

    NSString *MMcfdayTilMillSm3day = [[NSString alloc] initWithFormat:
                                      @" %f MMcfday = %f MillSm3day", convertValue, MMcfdayTilMillSm3dayFloat];

    NSString *MMcfdayTilMMBTU = [[NSString alloc] initWithFormat:
                                 @" %f MMcfday = %f MMBTU", convertValue, MMcfdayTilMMBTUFloat];

    NSString *MMcfdayTilPJPA = [[NSString alloc] initWithFormat:
                                @" %f MMcfday = %f PJPA", convertValue, MMcfdayTilPJPAFloat];

    NSString *MillSm3dayTilMTPA = [[NSString alloc] initWithFormat:
                                   @" %f MillSm3day = %f MTPA", convertValue, MillSm3dayTilMTPAFloat];

    if (from = 1, to == 1) { resultLabel.text = mtpaTilmtpa;
    }
    if (from = 1, to == 2) { resultLabel.text = mtpaTilMMcfday;
    }
    if (from = 1, to == 3) { resultLabel.text = mtpaTilMillSm3day;
    }
    if (from = 1, to == 4) { resultLabel.text = mtpaTilMMBTU;
    }
    if (from = 1, to == 5) { resultLabel.text = mtpaTilPJPA;
    }
    if (from = 2, to == 1) { resultLabel.text = MMcfdayTilmtpa;
    }
    if (from = 2, to == 2) { resultLabel.text = MMcfdayTilMMcfday;
    }
    if (from = 2, to == 3) { resultLabel.text = MMcfdayTilMillSm3day;
    }
    if (from = 2, to == 4) { resultLabel.text = MMcfdayTilMMBTU;
    }
    if (from = 2, to == 5) { resultLabel.text = MMcfdayTilPJPA;
    }
    if (from = 3, to == 1) { resultLabel.text = MillSm3dayTilMTPA;
    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T19:44:27.207

`=`你的大部分陈述中只有一个。您应该使用双等号 ( `==`)。单`=`人将值分配给`from`，而不是检查是否相等。我也会`,`用`&&`. 最后要做的一件事是合并`if`语句的公共部分。

```
if (from == 1) { 
    if (to == 1) {
        resultLabel.text = mtpaTilmtpa;
    }
    else if (to == 2) { 
        resultLabel.text = mtpaTilMMcfday;
    }
    else if (to == 3) { 
        resultLabel.text = mtpaTilMillSm3day;
    }
    else if (to == 4) { 
        resultLabel.text = mtpaTilMMBTU;
    }
    else if (to == 5) { 
        resultLabel.text = mtpaTilPJPA;
    }
}
else if (from == 2) { 
    if (to == 1) {
        resultLabel.text = MMcfdayTilmtpa;
    }
    else if (to == 2) { 
        resultLabel.text = MMcfdayTilMMcfday;
    }
    else if to == 3) { 
            resultLabel.text = MMcfdayTilMillSm3day;
    }
    else if (to == 4) { 
        resultLabel.text = MMcfdayTilMMBTU;
    }
    else if (to == 5) { 
        resultLabel.text = MMcfdayTilPJPA;
    }
}
else if (from == 3 && to == 1) { 
    resultLabel.text = MillSm3dayTilMTPA;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T19:54:20.603

您对所有这些 if 语句的使用都不能很好地扩展。您应该有一个包含标签的数组数组。然后使用两个组件中选定的选择器行来访问数组中的元素。然后你所有的 if 语句都会减少到 3 行代码。

# git - diff 返回相同文件的整个文件

> ID：12876350
> 
> 赞同：38
> 
> 时间：2012-10-13T19:41:43.743
> 
> 标签：git, diff

我有一个有 git repo 的网站。我克隆了 repo，以便我可以在一个目录中开发，然后推送到 repo，然后拉入 live/prod 目录（如果有更好的方法，我会对建议感兴趣，但那不在这个问题的范围）。

我在 live 目录中执行了以下操作来推送我所有的最新更改：

```
git add .
git commit -a // added a message
git push 
```

然后我在 dev 目录中执行了以下操作：

```
git clone git@bitbucket.org:user/repo.git 
```

然后我打开了两个文件，prod/root/test.php 和 dev/root/test.php，它们看起来一模一样。但是，当我执行以下 diff 命令时，它输出了整个文件：

```
diff prod/root/test.php dev/root/test.php 
```

我很困惑为什么 diff 如果它们是相同的会输出整个文件......我也试过用谷歌搜索这个并且找不到其他人有这个问题。也许是行尾问题或字符编码问题，它们看起来相同但实际上不同，当您推送到他们的仓库时 git/bitbucket 会转换它？这是我唯一能想到的......要么是那个，要么我错过了一些非常明显的东西。

这是输出：

```
1,3c1,3
< <?
< echo '<p>Hello world!</p>';
< ?>
---
> <?
> echo '<p>Hello world!</p>';
> ?> 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-10-13T19:46:24.907

这似乎是一个空白问题，为了将来避免它们，您可以设置 Git 来规范化它们。

Windows 和 UNIX 系统不使用相同的行尾，为了防止基于这些的冲突发生，你应该这样设置你的 git config：

*   **窗户**：`git config --global core.autocrlf true`
*   **Unix** ：`git config --global core.autocrlf input`

接下来，为了确保我们只提交理想的空白规则，您可以设置此[配置选项](https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration)：

```
git config --global core.whitespace trailing-space,space-before-tab,indent-with-non-tab 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-10-13T19:45:04.603

很可能是线路终止。试试`git diff --ignore-space-at-eol`。对于普通（非`git`）差异，它是`diff -b`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-13T19:43:42.677

这通常意味着行尾不同。大多数差异程序允许您忽略行尾的差异。你的允许你这样做吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-24T19:18:28.550

不是解决方案，将对您有所帮助。

`git diff --no-ext-diff --ignore-space-change -- <path>`-> 只能查看 git bash 中的代码更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-28T23:03:22.607

扩展@SimonBoudrias 的出色答案，`git config --global core.autocrlf true`要求 git 在结帐时将行尾从 LF 转换为 CRLF。对于在 Windows 上工作的开发人员非常有用。此命令会将以下内容添加到`%HOMEPATH%\.gitconfig`：

```
[core]
    autocrlf = true 
```

运行命令 from是最好的，但如果您觉得更容易，`Git Bash`可以手动添加上述行。`.gitconfig`

# git - Git - 合并后丢失的日志条目

> ID：12876358
> 
> 赞同：3
> 
> 时间：2012-10-13T19:42:41.443
> 
> 标签：git, merge, intellij-idea, git-merge, git-log

我似乎在一次以某种方式出错的合并后损坏了我的 Git 存储库。我所做的是：

*   `git checkout`<主分支>
*   `git merge`<功能分支>
*   我遇到了很多通过 Git Extension/kdiff 解决的冲突
*   最后一次冲突解决后，Git Extensions 问我是否想提交。我回答“否”，因为我想在提交之前再检查一下合并结果。
*   然后，我使用 IntelliJ 中的“更新项目”从中央存储库中提取最新更改，这样我即将发布的内容`git push`就不会被拒绝。我认为 IntelliJ 中的“更新项目”做了类似于`git stash; git pull --rebase; git stash apply`.

    “更新项目”命令没有给出警告、错误或合并冲突。

    我猜这一步是我问题的根源——Git 不知何故忘记了正在进行的合并。

*   然后我提交了合并并将其推送到中央存储库

当我使用 Git Extensions 浏览存储库历史记录时，我现在看到两个问题：

*   Git 似乎没有认识到功能分支已合并到主分支中。

    合并的结果很好，但是 Git Extensions 中分支历史的图形表示显示没有从功能分支到主分支的线。我的合并提交的日志条目就像常规的非合并提交一样从主分支继续。

*   当我执行“git log -- <在功能分支中更改的文件>”时，它不会显示所有实际更改文件的提交的日志条目。

    对于某些文件，在合并之前在功能分支上完成的更改的日志条目丢失。

    对于其他文件，即使在解决冲突期间修改了文件，我的合并提交的日志条目也会丢失。

    如果我使用“git log --full-history”，我可以看到丢失的日志条目。

谁能解释出了什么问题以及我能做些什么来解决这个问题？我花了几个小时修复合并冲突，如果可能的话，我想保留合并结果而不重做所有事情。

谢谢！

# c++ - 在 C++ 中读取字节

> ID：12876361
> 
> 赞同：6
> 
> 时间：2012-10-13T19:43:03.533
> 
> 标签：c++, c++11, binary, byte

我正在尝试从二进制文件中读取字节但没有成功。我尝试了很多解决方案，但没有得到任何结果。文件结构：

```
[offset] [type]          [value]          [description] 
0000     32 bit integer  0x00000803(2051) magic number 
0004     32 bit integer  60000            number of images 
0008     32 bit integer  28               number of rows 
0012     32 bit integer  28               number of columns 
0016     unsigned byte   ??               pixel 
0017     unsigned byte   ??               pixel 
........ 
xxxx     unsigned byte   ??               pixel 
```

我是如何尝试的（不起作用）：

```
auto myfile = fopen("t10k-images.idx3-ubyte", "r");
char buf[30];
auto x = fread(buf, 1, sizeof(int), myfile); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T19:57:12.427

读取字节为`unsigned char`：

```
ifstream if;

if.open("filename", ios::binary);

if (if.fail())
{
    //error
}

vector<unsigned char> bytes;

while (!if.eof())
{
    unsigned char byte;

    if >> byte;

    if (if.fail())
    {
        //error
        break;
    }

    bytes.push_back(byte);
}

if.close(); 
```

然后将多个字节变成一个`32-bit integer`例如：

```
uint32_t number;

number = ((static_cast<uint32_t>(byte3) << 24)
    | (static_cast<uint32_t>(byte2) << 16) 
    | (static_cast<uint32_t>(byte1) << 8) 
    | (static_cast<uint32_t>(byte0))); 
```

这应该涵盖字节序问题。是否`int`显示在系统上并不重要，因为转换是通过位移来处理的。该代码不假定内存中的任何特定顺序。`B0B1B2B3``B3B2B1B0`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T20:33:39.393

C++ 流库函数[`read()`](http://en.cppreference.com/w/cpp/io/basic_istream/read)可用于二进制文件 I/O。鉴于链接中的代码示例，我会这样开始：

```
std::ifstream myfile("t10k-images.idx3-ubyte", std::ios::binary);
std::uint32_t magic, numim, numro, numco;

myfile.read(reinterpret_cast<char*>(&magic), 4);
myfile.read(reinterpret_cast<char*>(&numim), 4);
myfile.read(reinterpret_cast<char*>(&numro), 4);
myfile.read(reinterpret_cast<char*>(&numco), 4);

// Changing byte order if necessary
//endswap(&magic);
//endswap(&numim);
//endswap(&numro);
//endswap(&numco);

if (myfile) {
    std::cout << "Magic = "  << magic << std::endl
              << "Images = " << numim << std::endl
              << "Rows = "   << numro << std::endl
              << "Cols = "   << numco << std::endl;
} 
```

如果应该反转字节顺序（字节序），您可以编写一个简单的反转函数，如下所示：[`endswap()`](https://stackoverflow.com/a/3824338/237483)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T19:49:22.580

这是从文件中读取 uint32_t 的方式：

```
auto f = fopen("", "rb"); // not the b, for binary files you need to specify 'b'

std::uint32_t magic = 0;
fread (&magic, sizeof(std::uint32_t), 1, f); 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-13T20:04:12.750

了解文件布局的字节顺序，从而读取多字节数字很重要。假设 big-endian*始终*是书面格式，并且假设值确实是 32 位无符号值：

```
uint32_t magic = 0;
unsigned char[4] bytes;
if (1 == fread(bytes, sizeof(bytes), 1, f))
{
   magic = (uint32_t)((bytes[0] << 24) | 
                      (bytes[1] << 16) | 
                      (bytes[2] << 8) | 
                      bytes[3]);
} 
```

注意：无论*阅读器*（您的程序）是小端还是大端，这都会起作用。我敢肯定我错过了至少一个演员，但希望你明白这一点。读取多字节数字的唯一安全且*可移植的方法是 (a)**知道*写入它们的字节顺序，以及 (b) 逐字节读取和组装它们。

# asp.net - Server.MapPath 并从 ASP.NET 应用程序运行命令行实用程序

> ID：12876364
> 
> 赞同：0
> 
> 时间：2012-10-13T19:43:24.030
> 
> 标签：asp.net, windows

我需要使用`Process`. .exe 文件位于 ASP.NET 项目中 - 'ProjectRoot/Utilities/utility.exe'

为什么此代码无法运行它：

```
string path = Server.MapPath("/Utilities/");
string args = " etc etc";
Process p = Process.Start(new ProcessStartInfo(path + "utility.exe", args));
p.WaitForExit(3000); 
```

我也试过`"\\utility.exe"`了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T01:06:02.493

这里有几件事要检查。

第一件事是确保这`string path = Server.MapPath("/Utilities/");`是一条有效的路径并且`utility.exe`位于正确的位置。

你说它不会抛出异常，所以调用至少应该是有效的`utility.exe` *。*但是，`utility.exe` *可能会*吞下它反过来遇到的任何异常（取决于它是如何编码的），这可能是它似乎不起作用的原因。

最重要的是，您的`args`变量可能正在指定要访问的文件或其他资源`utility.exe`。如果它确实吞下了异常，那么如果应用程序池身份无权访问资源，它可能会掩盖权限错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T19:50:06.810

答案取决于发生的异常的类型。顺便说一句，如果应用程序池的身份（与 Windows 应用程序中的进程相同）设置为受限用户（默认情况下），由于安全问题，您无法在服务器上执行进程.

如果你知道后果并且服务器是你自己的，你可以将应用程序池的身份更改为授权用户，那么你的应用程序可以毫不犹豫地做这样的事情。

干杯

# c - 在 C 中使用 fork 进行搜索

> ID：12876366
> 
> 赞同：0
> 
> 时间：2012-10-13T19:44:19.527
> 
> 标签：c, fork, binary-search

我应该对 fork 感到满意，我看到一个练习说使用 fork 调用来搜索索引从 0 到 15 的数组。我们假设每个进程只能做两件事......（ 1) 是检查数组的长度是否为 1，以及 (2) 将数组的单个元素与正在搜索的数字进行比较。基本上我给它传递了一个数字，它应该做有限数量的分叉并返回该数字的索引。这是我的代码..

```
#define MAXINDEX 16

int forkSearch(int a[], int search, int start, int end){
  if(start == end){
    if(*(a + end) == search){
      return end;
    }
  } 
  else{
    pid_t child = fork();
    if(child == 0) return forkSearch(a, search, start, end/2);
    else return forkSearch(a, search, (start + end)/2, end);
  }
}

int main(int argc, char* argv[]){
  int searchArray[MAXINDEX] = {1, 12, 11, 5, 10, 6, 4, 9, 13, 2, 8, 14, 3,\
                               15, 7};
  printf("Should be 1\. Index of 12 = %d\n", forkSearch(searchArray,
                                                       12, 0, MAXINDEX));
  return 0;
} 
```

这个快速爆炸的程序返回的所有内容似乎都是 1、10、11 或 13。为什么这不能正常工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T19:53:16.870

```
if(child == 0) return forkSearch(a, search, start, end/2); 
```

那里错了`end`，应该是`(start+end)/2`，右半边搜索的起始索引应该是`(start+end)/2 + 1`。否则，如果右半部分是`(start+end)/2 .. end`，when `end == start+1`，`start`递归调用的 for 是旧`start`值，并且您有一个无限循环。

您的程序具有未定义的行为，因为

```
int forkSearch(int a[], int search, int start, int end){
  if(start == end){
    if(*(a + end) == search){
      return end;
    }
  } 
```

如果 不返回值`start == end`，但是`*(a+end) != search`。`exit(0);`在内部之后添加一个`if`以退出未找到目标的进程。

```
int searchArray[MAXINDEX] = {...};

forkSearch(searchArray, 12, 0, MAXINDEX) 
```

将导致在 的越界访问`searchArray[MAXINDEX]`，以及未定义的行为。

# haskell - 模式匹配列表元素

> ID：12876367
> 
> 赞同：1
> 
> 时间：2012-10-13T19:44:24.447
> 
> 标签：haskell

有没有办法查看一个列表，当你找到值 4 和 5 时，做点什么？

我试过`foo (4:5:xs) = <do something>`但它没有编译

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-13T21:08:20.053

您还必须描述当您找不到 4 和 5 时会发生*什么*！

假设您希望在`"Found"`看到 4 和 5 时返回字符串，`"Not found"`否则。然后你可以使用这个功能：

```
foo :: [Int] -> String
foo (4:5:xs) = "Found"
foo (_:xs) = foo xs
foo [] = "Not found" 
```

如果您在看不到 4 和 5 时不想“做任何事情”，则必须将函数的返回类型更改为`Maybe String`（在此示例中）：

```
foo :: [Int] -> Maybe String
foo (4:5:xs) = Just "Found"
foo (_:xs) = foo xs
foo [] = Nothing 
```

我会使用第二个版本，这样您就不必记住“未找到”的值是什么。

# java - 无法使用 XMLReader 访问特定的 XML 元素

> ID：12876369
> 
> 赞同：1
> 
> 时间：2012-10-13T19:44:26.833
> 
> 标签：java, xml, parsing, jaxb

我需要使用 xmlreader 解析以下 xml 文件，然后使用 JAXB 解组这些部分。

```
<parents>
    <moms>
      <mom>
       ...
      </mom>
       <mom>
       ...
      </mom>
   ...
    </moms>
    <dads>
      <dad>
       ..
      </dad>
      ..
      ..
    </dads>
</parents> 
```

我可以到达`<moms>`元素，但我无法到达`<dads>`元素，要么使用相同的 Xmlreader 变量，要么使用全新的变量。我只能找到妈妈元素，然后在那里输入层次结构......

编码 ：

```
 fileInputStream = new FileInputStream( file );
        xmlStreamReader = Utils.getXMLStreamReader( fileInputStream, "UTF-8" );
        JAXBContext context = JAXBContext.newInstance(Moms.class, Dads.class);
        unmarshaller = context.createUnmarshaller();
        xmlStreamReader.nextTag();

            xmlStreamReader.require( XMLStreamConstants.START_ELEMENT, null, "parents" ); 
            xmlStreamReader.nextTag();
            xmlStreamReader.nextTag();
            xmlStreamReader.require( XMLStreamConstants.START_ELEMENT, null, part );
            xmlStreamReader.require( XMLStreamConstants.START_ELEMENT, null, "parents" ); 
           while ( xmlStreamReader.getEventType() == XMLStreamConstants.START_ELEMENT )
    {
        String localName = xmlStreamReader.getLocalName();

        if ( localName.equals("dads") )
        {
            xmlStreamReader.nextTag();
        }

        if (xmlStreamReader.getEventType() ==XMLStreamConstants.CHARACTERS) 
        {
            xmlStreamReader.next();
        }
    }                   
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T09:48:50.203

给定以下 XML

```
<parents>
  <moms>
    <mom>A</mom>
    <mom>B</mom>
  </moms>
  <dads>
    <dad>C</dad>
  </dads>
</parents> 
```

下面的代码

```
InputStream is = new FileInputStream("...");
XMLInputFactory xif = XMLInputFactory.newFactory();
XMLStreamReader xsr = xif.createXMLStreamReader(is);
while (xsr.hasNext()) {
  if (xsr.next() == XMLStreamConstants.START_ELEMENT
      && xsr.getLocalName().equals("dad")) {

    if (xsr.next() == XMLStreamConstants.CHARACTERS)
      System.out.println(xsr.getText());
  }
} 
```

打印*C*。

我认为你以某种方式设法跳过了*爸爸*的元素。尝试简化你的逻辑。所有这些*要求*和*nextTag*业务对我来说似乎都是错误的。另外，虽然我不确定，但你的条件语句*while*似乎很愚蠢。如果完成，请改用*xmlStreamReader.hasNext*并跳出循环。

# automata - 设计接受几个字符串的 nfa

> ID：12876370
> 
> 赞同：0
> 
> 时间：2012-10-13T19:44:52.283
> 
> 标签：automata, dfa, nfa

我需要帮助设计一个接受单词“hello”、“hello world”和“stay together”的 nfa，字母表包括英文字母表、数字和符号。我需要帮助开始。有人有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T12:30:49.077

我会从一个正则表达式开始，然后从那里开始。

您的问题的正则表达式是：你好 | 你好世界| 呆在一起（记住“你好”是多余的，但你没有指定它需要是最佳的）

然后我们可以使用构造规则将正则表达式转换为nfa。看起来[这里解释得很好](https://stackoverflow.com/questions/11819185/steps-to-creating-an-nfa-from-a-regular-expression)

因为它只是一堆连接（你好...）和一些联合（那些'|'字符表示联合），最终的 nfa 将如下所示（如果您想单独处理每个字母，则需要更多连接）：![在此处输入图像描述](../Images/3db4d8dc03cc162ac79a8b01990b8897.png)

注意：上面的图像是从[这里](http://hackingoff.com/compilers/regular-expression-to-nfa-dfa)生成的，用于正则表达式 h|hw|st

# javascript - 如何将多个相同类型的参数传递给jQuery Get

> ID：12876373
> 
> 赞同：10
> 
> 时间：2012-10-13T19:45:15.257
> 
> 标签：javascript, jquery

我正在尝试使用 jQuery $.get 从站点获取一些数据。我需要设置2个相同类型的参数：

```
..&q=Some Text&q=Some other text 
```

jQuery 似乎用第二个和只发送 1 覆盖了 q 的第一个实例。有什么办法解决这个问题吗？

这是我试图使用的代码：

```
var params = {
       "otherParam":"x",
       "q":text,
       "q":title
};
$.get(url, params, mySuccessFunction); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-13T19:46:01.717

尝试：

```
var params = {
  "otherParam": "x",
  "q": [ text, title ]
}; 
```

*编辑*— 更多信息：像这样的数组值参数由 jQuery 特殊处理。为了安抚许多常见的服务器框架，默认情况下（我认为从 1.5 或 1.6 版开始）这些将导致参数名称包含“[]”（左括号和右括号字符）作为后缀（没有数字，与我的错误相反在下面评论）。如果你不想这样，你可以设置

```
jQuery.ajaxSettings.traditional = true; 
```

它只是“q”而不是“q[]”。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-15T14:24:21.733

还有另一种解决它的方法，不需要`encodeURIComponent()`或弄乱 `jQuery.ajaxSettings.traditional = true;`我不想做的事情，因为我不想（即使是暂时的）干扰网站的其他部分可能同时做的事情。

是：

```
 var params=[ 
       {name:"q", value:title},
       {name:"q", value:text}
 ];
 $.get(url, params, mySuccessFunction); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-20T23:55:50.853

另一种无需修改的方法`jQuery.ajaxSettings.traditional = true;`是使用`$.param()` [http://api.jquery.com/jQuery.param/](http://api.jquery.com/jQuery.param/)

所以是这样的：

```
var params = {
  "otherParam": "x",
  "q": [ text, title ]
};

$.get(url, $.param(params, true), mySuccessFunction); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-13T19:47:42.867

你可以这样写 URL：

```
$.get(
   url+'?q='+encodeURIComponent(text)+'&q='+encodeURIComponent(title)+'&otherParam='+encodeURIComponent('x'),
   mySuccessFunction
); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-03-01T13:02:23.647

事情很简单，在 jQuery 网站[http://api.jquery.com/jquery.param/](http://api.jquery.com/jquery.param/)中有描述。

首先创建一个 params 对象

```
var params=[{
    name: 'param1',
    value: 'hello'
},
{
    name: 'param1',
    value: 'alex'
}]; 
```

接下来创建要发送到服务的数据。

```
var data = jQuery.param(params); 
```

该对象可以作为 ajax 请求的数据参数插入。我喜欢使用设置对象

```
var settings={
    url: 'api/domain/timeline',
    type: 'get',
    contentType: 'application/json',
    data: data
    };
$.ajax(settings); 
```

# vbscript - 如何通过 VBS 脚本获取 RSS 提要并在 CMD 中显示内容

> ID：12876382
> 
> 赞同：1
> 
> 时间：2012-10-13T19:46:34.127
> 
> 标签：vbscript, rss, cmd, feed

您好，我想弄清楚如何使用 VBS 解析 RSS 提要并将内容显示到 cmd 中。我得到了一些我在网上找到的代码。这就是我到目前为止所得到的。

批处理文件：

```
:news
start scripts\xml\getxml.exe -N --directory-prefix=%temp% http://feeds.bbci.co.uk/news/rss.xml
:newscheck
if NOT EXIST %temp%\rss.xml (
ping 123.45.67.89 -n 1 -w 500 > nul.
goto newscheck
)
start scripts\news\parsebbcnews.vbs
ping 123.45.67.89 -n 1 -w 500 > nul.
:newsxmlparsecheck
if NOT EXIST %temp%\bbcnews.txt (
ping 123.45.67.89 -n 1 -w 500 > nul.
goto newsxmlparsecheck
)
set /p headline= <%temp%\bbcnews.txt
echo %headline%
%speech% "%headline%"
del %temp%\rss.xml
del %temp%\bbcnews.txt
goto start 
```

然后这将启动 VBS：

```
 Dim xmlDoc, objNodeList, plot

Set wshShell = CreateObject( "WScript.Shell" )
tfolder =  wshShell.ExpandEnvironmentStrings("%TEMP%")
Set xmlDoc = CreateObject("Msxml2.DOMDocument")
xmlDoc.load(tfolder & "\rss.xml")
Set objNodeList = xmlDoc.getElementsByTagName("channel/item/description") 'Node to search for
Set objFSO = CreateObject("Scripting.FileSystemObject")

' Write all found results into forecast.txt
Const ForWriting = 2
Set objTextFile = objFSO.OpenTextFile _
    (tfolder & "\bbcnews.txt", ForWriting, True)
If objNodeList.length > 0 then
For each x in objNodeList
plot=x.Text
objTextFile.WriteLine(plot)
Next 'just remove this?
objTextFile.Close   
End If

'Extract todays data (first line) from 'forecast.txt' and write each data type to seperate line in today.txt
Const ForReading = 1
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objTextFile = objFSO.OpenTextFile _
    (tfolder & "\bbcnews.txt", ForReading)
    strNextLine = objTextFile.Readline
    'currentsplit = Split(strNextLine , ", ")
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objTextFile = objFSO.OpenTextFile(tfolder & "\headline.txt", ForWriting, True)  
    objTextFile.WriteLine(strNextLine) 
```

这从 bbc 获得 1 个新闻 rss 提要。我还希望显示多个提要。

我没有创建此代码，所以我不知道如何获取脚本和类似代码以从不同站点获取 rss。所以基本上我想知道如何使用 vb-script 执行此操作并将其显示在 cmd 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T13:55:15.530

如果您只对顶部标题感兴趣，则应使用“channel/item/title”而不是“channel/item/description”。对于许多提要，描述都使用 HTML 进行了丰富，因此打印第一行可能对您没有任何好处。

您可以将这两个脚本简化为以下内容：

```
Sub PrintTopHeadline(feed)
  Set req = CreateObject("MSXML2.XMLHTTP.3.0")
  req.Open "GET", feed, False
  req.Send

  Set xml = CreateObject("Msxml2.DOMDocument")
  xml.loadXml(req.responseText)
  WScript.StdOut.WriteLine xml.getElementsByTagName("channel/item/title")(0).Text
End Sub

PrintTopHeadline "http://feeds.bbci.co.uk/news/rss.xml"
PrintTopHeadline "http://news.google.com/news?ned=us&topic=h&output=rss"
... 
```

但是，您必须使用 调用脚本`cscript.exe`才能打印命令行输出：

```
cscript //NoLogo feeds.vbs 
```

**编辑：**为了显示来自提要的更多标题，您需要添加一个循环`PrintTopHeadline()`，如下所示：

```
For i = 0 To 4
  WScript.StdOut.WriteLine xml.getElementsByTagName("channel/item/title")(i).Text
Next 
```

可以通过以下方式删除 HTML 标签：

```
descr = xml.getElementsByTagName("channel/item/description")(0).Text

Set re = New RegExp
re.Pattern = "\s*<.+?>\s*"
re.Global  = True

descr = Trim(re.Replace(descr, " ")) 
```

但是，您需要额外的代码来将[HTML 实体](http://www.htmlhelp.com/reference/html40/entities/)转换回纯文本，例如：

```
descr = Replace(descr, "&quot;", """")
descr = Replace(descr, "&ntilde;", "ñ")
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T04:32:07.440

[此页面](http://www.tele-pro.co.uk/scripts/rss/rss_content_feed_class_dl.htm)包含一些可以帮助您的信息。篇幅比较大，这里就不重新发了。

具体来说[，这是](http://www.tele-pro.co.uk/scripts/rss/rss_content_feed_class.1.txt)他们创建的 VBscript 类的链接。[这](http://www.tele-pro.co.uk/scripts/rss/rss_content_feed_sample_code.txt)是使用该类的示例代码。

# javascript - 是否有允许从内部调用 javascript 的 Javascript Scheme 解释器？

> ID：12876383
> 
> 赞同：4
> 
> 时间：2012-10-13T19:46:40.390
> 
> 标签：javascript, scheme

我正在尝试为用户创建一个 Scheme 接口，以使用我的客户端 Javascript 内容。问题是，我不希望解释器像方案解释器一样简单地工作。

我只是希望能够为用户提供一些用 Javascript 实现的琐碎的原始函数。

`document.write()`用户基本上使用 Scheme 以他想要的任何奇特方式（有条件地、递归地、迭代地等）使用我的原始函数（比如使用函数编写东西的函数）。

有什么办法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T09:14:58.397

[BiwaScheme](http://www.biwascheme.org/)做你想做的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T14:36:25.380

看看[WhaleSong](http://hashcollision.org/whalesong/)，它将 Racket（的一个子集）编译为 JavaScript。

# list - 在 Haskell 中将列表分组为包含 n 个元素的列表

> ID：12876384
> 
> 赞同：30
> 
> 时间：2012-10-13T19:46:45.663
> 
> 标签：list, haskell

库中的列表是否有一个操作可以组成 n 个元素组？例如：n=3

```
groupInto 3 [1,2,3,4,5,6,7,8,9] = [[1,2,3],[4,5,6],[7,8,9]] 
```

如果没有，我该怎么做？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-10-13T19:53:50.620

在[Hoogle](http://www.haskell.org/hoogle/?hoogle=Int+-%3E+%5Ba%5D+-%3E+%5B%5Ba%5D%5D)上快速搜索表明没有这样的功能。另一方面，回复说`split`包里有一个，叫`chunksOf`.

但是，您可以自己完成

```
group :: Int -> [a] -> [[a]]
group _ [] = []
group n l
  | n > 0 = (take n l) : (group n (drop n l))
  | otherwise = error "Negative or zero n" 
```

当然，有些括号可以去掉，我留在这里是为了了解代码的作用：

基本情况很简单：只要列表为空，只需返回空列表。

递归案例首先测试是否`n`为正。如果`n`是`0`或更低，我们将进入无限循环，我们不希望这样。[`take`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:take)然后我们使用and将列表分成两部分[`drop`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:drop)：`take`返回第一个`n`元素，同时`drop`返回其他元素。然后，我们将第一个`n`元素添加到通过将我们的函数应用于原始列表中的其他元素而获得的列表中。

![在此处输入图像描述](../Images/55c00da4ce40d148c5cbd311358a5ce6.png)

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-10-13T20:02:25.613

此功能以及其他类似功能可以在流行的[拆分](http://hackage.haskell.org/package/split)包中找到。

```
> import Data.List.Split
> chunksOf 3 [1,2,3,4,5,6,7,8,9]
[[1,2,3],[4,5,6],[7,8,9]] 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-10-14T13:15:35.040

正如 Mihai 指出的，你可以自己写一个。但我会使用该[`splitAt`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Data-List.html#v:splitAt "分裂")函数，因为它不需要像`take`-`drop`组合那样对输入列表进行两次传递：

```
chunks :: Int -> [a] -> [[a]]
chunks _ [] = []
chunks n xs =
    let (ys, zs) = splitAt n xs
    in  ys : chunks n zs 
```

这是一种常见的模式 - 通过重复迭代从种子值（在本例中是您的输入列表）生成列表。该模式在[`unfoldr`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Data-List.html#v:unfoldr "展开器")函数中被捕获。我们可以将它与稍微修改的版本一起使用`splitAt`（感谢[Will Ness](https://stackoverflow.com/users/849891/will-ness)提供更简洁的版本）：

```
chunks n = takeWhile (not . null) . unfoldr (Just . splitAt n) 
```

也就是说，使用`unfoldr`我们生成`n`元素块，同时我们通过`n`元素缩短输入列表，并且我们生成这些块直到我们得到空列表——此时初始输入被完全消耗。

当然，正如其他人指出的那样，您应该使用`split`模块中已经存在的功能。但是习惯于标准 Haskell 库中的列表处理函数总是好的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-10-13T20:04:38.527

这通常被称为“块”，是最常提到的列表操作之一，它不在`base`. 该包[`split`](http://hackage.haskell.org/packages/archive/split/0.2.1.1/doc/html/Data-List-Split.html)提供了这样的操作，复制和粘贴黑线鳕文档：

```
 > chunksOf 3 ['a'..'z']
 ["abc","def","ghi","jkl","mno","pqr","stu","vwx","yz"] 
```

此外，与我的意愿相反，hoogle 只搜索一小组库（那些由 GHC 或 HP 提供的库），但您可以使用`+PKG_NAME`- hoogle with`Int -> [a] -> [[a]] +split`获取您想要的内容显式地将包添加到搜索中。有些人出于这个原因使用 Hayoo。

# javascript - 按 F5 时 Javascript 功能而不是刷新

> ID：12876389
> 
> 赞同：0
> 
> 时间：2012-10-13T19:47:51.090
> 
> 标签：javascript, html

我想防止页面实际重新加载，然后`reload()`在用户按下 F5 键时运行该功能。

这可能吗，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T19:54:18.593

您可以防止刷新`f5`使用`preventDefault` [jsfiddle](http://jsfiddle.net/jnZQJ/1/)

```
document.onkeydown = function(e){
    if(e.keyCode == 116){ // f5 keycode is 116
       e.preventDefault();
       e.returnValue = false; // for IE
    }
}​ 
```

# php - 如何重新配置 导致服务器问题的 RSS Feed

> ID：12876390
> 
> 赞同：1
> 
> 时间：2012-10-13T19:47:54.647
> 
> 标签：php, sql-server, rss, webserver

我一直在处理一个问题，即我的 RSS 提要（简单的 for 循环，将其设置为有效的 rss 格式）已被网站获取以将帖子发送到 Twitter/facebook，当它被获取时，它会使我的整个服务器崩溃。

这令人困惑，因为 RSS 提要在验证器、rss 阅读器、Firefox 的内置 url 阅读器中完美加载，我似乎无法弄清楚为什么只有在获取提要时，它才会使我的服务器崩溃。

这是一个已知问题，其中获取数据的站点会遇到占用过多内存的问题？

我在获取它之前运行 free -m，有 250+ MB 的可用空间，之后，它下降到 5MB 和一个不会加载的站点。你能做些什么来解决这类问题？这是负载平衡问题吗？我的 RSS 提要有问题？我应该使用 feedburner 吗？这能解决问题吗？

更新：我试过 feedburner，同样的问题。

# javascript - 如何在 chrome 扩展中使用 localstorage

> ID：12876391
> 
> 赞同：2
> 
> 时间：2012-10-13T19:48:08.987
> 
> 标签：javascript, google-chrome, google-chrome-extension, local-storage

我有一个扩展名。在选项页面上，我正在设置选项，这很明显。但我无法让本地存储工作。这些选项使用 jquery 绑定到 onclick 事件。我如何设置值的示例代码是这样的：

```
localStorage["new_tab"]=$("#n_tab").attr('checked');
localStorage["anim"]=$("#anime").attr('checked');
localStorage["bov_e"]=$("#bov_e").attr('checked'); 
```

问题出在哪里？你能以正确的方式指出我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T19:52:37.423

用于`localStorage.setItem("itemName", valueHere)`保存值并`localStorage.getItem("itemName")`检索它。

```
localStorage.setItem("new_tab", $("#n_tab").attr('checked'));
localStorage.setItem("anim", $("#anime").attr('checked'));
localStorage.setItem("bov_e", $("#bov_e").attr('checked'));

console.log(localStorage.getItem("new_tab"));
console.log(localStorage.getItem("anim"));
console.log(localStorage.getItem("bov_e")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T20:29:27.230

你也需要使用

```
 .prop('checked') 
```

# objective-c - 字符串应该如何与Objective C中的正则表达式匹配

> ID：12876398
> 
> 赞同：0
> 
> 时间：2012-10-13T19:49:02.693
> 
> 标签：objective-c, regex, nsregularexpression

我发现使用 NSRegularExpression 很难匹配字符串。通用字母字符不是 [az] 的问题，但如果我需要匹配像“导入”这样的词，我正在努力使其工作。我确定我必须以某种方式转义这个词，但我找不到任何与此相关的文档。一个非常基本的例子是

```
{{import "hello"}} 
```

我想在哪里获取字符串：你好

编辑：澄清 - 'hello' 可以是任何字符串 - 这是我想要返回的位

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:26:00.120

此正则表达式匹配示例中“-s”之间的文本：

```
\{\{import "([^"]+)"\}\} 
```

匹配将存储在第一个匹配组中。

# xamarin.android - 如何使用 Mvvmcross 将图像 src 绑定到资源可绘制图像？

> ID：12876406
> 
> 赞同：13
> 
> 时间：2012-10-13T19:50:22.473
> 
> 标签：xamarin.android, mvvmcross

我正在尝试绑定图像的 src。

我试过像这样使用 MvxHttpImageView

```
<Mvx.MvxHttpImageView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:id="@+id/iconeView"
                local:MvxBind="{'ImageUrl':{'Path':'ImgSrc'}}" /> 
```

和

```
public string ImgSrc
{
    get {return "@res/drawable/icon.png"; }
} 
```

我已经尝试了其他几个 ImgSrc，但仍然没有任何结果。

icon.png 在我的 Resources/Drawable 目录中，是一个 AndroidResource

任何帮助都会很棒！谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-03-28T16:08:04.257

较新版本的 MvvmCross 支持绑定到可绘制资源。使用[DrawableName 绑定](https://github.com/MvvmCross/MvvmCross/blob/master/MvvmCross/Platforms/Android/Binding/Target/MvxImageViewDrawableNameTargetBinding.cs)，您可以将 ImageView 绑定到视图模型上包含可绘制名称的属性。

```
using System;
using Cirrious.MvvmCross.ViewModels;

namespace MyApp.ViewModels
{
    public class UserProfileViewModel : MvxViewModel
    {    
            // set this to the name of one of the files
            // in your Resources/drawable/drawable-xxxx folders
        private MyDrawable _myDrawable;
        public string MyDrawable { 
            get { return _myDrawable; }
            set {
                _myDrawable = value;
                RaisePropertyChanged (() => MyDrawable);
            }
        }
    }
} 
```

在你的布局中

```
 <ImageView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        local:MvxBind="DrawableName MyDrawable"/> 
```

或者，如果您的[VM](https://github.com/MvvmCross/MvvmCross/blob/master/MvvmCross/Platforms/Android/Binding/Target/MvxImageViewDrawableTargetBinding.cs)属性是`int`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-14T09:48:51.047

mvxhttpimageview 知道如何从 http 和“磁盘”加载图像

可悲的是，它不知道如何从资源中加载

但是，有一些方法可以让图像加载静态内容。

1.  您可以编写自己的自定义绑定
2.  您可以使用标准的 imageview、存储在 android assets 中的图像以及 mvx 中内置的 'AssetImagePath' 绑定。

要尝试第一个，请查看会议示例 - 收藏按钮背景如何绑定到 IsFavorite

做第二个：

*   在资产文件夹中包含图标 - 例如 /assets/icon1.png
*   确保构建操作设置为 AndroidAsset
*   在 XML 中使用标准的 ImageView 和绑定文本，例如 {'AssetImagePath':{'Path':'WhichAsset'}}

在实际使用中，我通常还使用转换器 - 将 Viewmodel 属性（如 State 的值为 LoadingState.Loading）映射到资产图像路径（如“/loadingimages/loading.png”）

* * *

[您可以在https://github.com/slodge/MvvmCross/blob/master/Cirrious/Cirrious.MvvmCross.Binding/Android/Target/MvxImageViewDrawableTargetBinding.cs](https://github.com/slodge/MvvmCross/blob/master/Cirrious/Cirrious.MvvmCross.Binding/Android/Target/MvxImageViewDrawableTargetBinding.cs)中查看资产绑定的代码

* * *

抱歉答案不包含更多代码 - 在手机上回答

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-07-19T08:15:20.797

我构建了一个转换器，它将可绘制名称转换为位图并将位图绑定到 ImageView。

转换器：

```
public class ImageNameToBitmapConverter : MvxValueConverter<string, Bitmap>
{
    protected override Bitmap Convert(string value, Type targetType, object parameter, CultureInfo culture)
    {

        var topActivity = Mvx.Resolve<IMvxAndroidCurrentTopActivity>();

        var bm = BitmapFactory.DecodeResource(topActivity.Activity.Resources, GetResourceId(value, "drawable", topActivity));

        return bm;
    }

    private static int GetResourceId(string variableName, string resourceName, IMvxAndroidCurrentTopActivity topActivity)
    {
        try
        {
            return topActivity.Activity.Resources.GetIdentifier(variableName, resourceName, topActivity.Activity.PackageName);
        }
        catch (Exception)
        {
            return -1;
        }
    }
} 
```

XML 视图：

```
<ImageView
    local:MvxBind="Bitmap Icon, Converter=ImageNameToBitmap"
    android:layout_width="100dp"
    android:layout_height="100dp" /> 
```

`Icon`我绑定的属性是一个字符串，如：“ *icon_name* ”，我将图像`icon_name.png`放在 Android 项目的`Resources/drawable`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-24T14:14:04.093

对于最新的 MvvmCross，下一个解决方案是实际的：

在标记中：

```
<ImageView
    android:id="@+id/iconImage"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_margin="10dp"
    android:layout_centerVertical="true"
    local:MvxBind="DrawableName Type, Converter=TypeToImageStringConverter" /> 
```

在转换器中：

```
public class TypeToImageStringConverter : MvxValueConverter<VacationType, int>
{
    protected override int Convert(VacationType value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        switch (value)
        {
            case VacationType.RegularVacation:
                return Resource.Drawable.Icon_Request_Green;
            case VacationType.SickLeave:
                return Resource.Drawable.Icon_Request_Blue;
            case VacationType.LeaveWithoutPay:
                return Resource.Drawable.Icon_Request_Dark;
            case VacationType.OvertimeVacation:
                return Resource.Drawable.Icon_Request_Gray;
            case VacationType.ExceptionalLeave:
                return Resource.Drawable.Icon_Request_Plum;
            default:
                return Resource.Drawable.Icon_Request_Gray;
        }
    }
} 
```

所有的感觉是你必须给出一个可绘制的资源ID。

# php - 用mysqli制作一个函数从表中返回X行？

> ID：12876408
> 
> 赞同：0
> 
> 时间：2012-10-13T19:50:25.483
> 
> 标签：php, mysql, arrays, function, mysqli

我是函数的新手，所以为了了解它们，我一直在将我制作的网站转换为使用函数。我希望能够将该函数用于其他站点，因此我希望将所有表/查询信息传递给该函数，然后以数组或类似的形式返回帖子，以便在函数通过后我可以根据需要设置它们的样式信息回来。我已经通过一个帖子实现了这一点，但无法让它与多个帖子一起使用。我通常会检索大约 10 行，目前有 4 列。

这是我的单一帖子功能

```
 function readPostByID($postID, $table) {
    $mysqli = new mysqli(DB_HOST, DB_USER, DB_PASS, DB_NAME);
    if (mysqli_connect_errno()) {
        return false;
    }
    if ($result = $mysqli->query("SELECT * FROM '$table' WHERE id = '$postID'")) {
        while($row = $result->fetch_array()) {
            $time1 = date('H:i \o\n jS M Y', $row['publishedtime']);
            $postarray['1'] = $row['title'];
            $postarray['2'] = $row['content'];
            $postarray['3'] = $row['author'];
            $postarray['4'] = $time1;
        }
        $result->close();
    }
    mysqli_close($mysqli);
    return $postarray;
} 
```

将不胜感激将其切换为检索多个帖子的任何帮助

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T21:05:56.437

第一个更改是选择一个 ID 范围，您可以这样做：

```
 WHERE id in (1,2,3,4,5) 
```

您已经在遍历结果，但您需要更好的数据结构来存储它们。

`LIMIT`如果您正在进行分页，其他使用和偏移的建议很好。

# ios - Twitter官方iOS应用如何用自定义文本改变状态栏

> ID：12876414
> 
> 赞同：7
> 
> 时间：2012-10-13T19:51:06.410
> 
> 标签：ios, cocoa-touch, ios6

![](../Images/c13e8cbdea0e6c5c109397ac5b9b44fb.png)

新的 iOS 官方 Twitter 应用程序更改状态栏，如上图所示。如何实现这样的功能？

[[图片来源](http://littlebigdetails.com/post/33363254165/twitter-ios-app-gives-feedback-in-the-status-bar)]

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-13T19:55:48.300

这是我在我的应用程序中使用旋转动画的方法：

```
-(void)showStatusBarMessage:(NSString *)message hideAfter:(NSTimeInterval)delay
{
    __block UIWindow *statusWindow = [[UIWindow alloc] initWithFrame:[UIApplication sharedApplication].statusBarFrame];
    statusWindow.windowLevel = UIWindowLevelStatusBar + 1;
    UILabel *label = [[UILabel alloc] initWithFrame:statusWindow.bounds];
    label.textAlignment = UITextAlignmentCenter;
    label.backgroundColor = [UIColor blackColor];
    label.textColor = [UIColor grayColor];
    label.font = [UIFont boldSystemFontOfSize:13];
    label.text = message;
    [statusWindow addSubview:label];
    [statusWindow makeKeyAndVisible];
    label.layer.transform = CATransform3DMakeRotation(M_PI * 0.5, 1, 0, 0);
    [UIView animateWithDuration:0.7 animations:^{
        label.layer.transform = CATransform3DIdentity;
    }completion:^(BOOL finished){
        double delayInSeconds = delay;
        dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);
        dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
            [UIView animateWithDuration:0.5 animations:^{
                label.layer.transform = CATransform3DMakeRotation(M_PI * 0.5, -1, 0, 0);
            }completion:^(BOOL finished){
                statusWindow = nil;
                [[[UIApplication sharedApplication].delegate window] makeKeyAndVisible];
            }];
        });
    }];
} 
```

我将它放在 UIViewController 的一个类别中，以便从应用程序中的任何控制器中使用它。

**编辑：**需要`QuartzCore.framework`引用和`#import <QuartzCore/QuartzCore.h>`添加。

# ruby-on-rails - 从 gem 中确定 rails 环境

> ID：12876415
> 
> 赞同：4
> 
> 时间：2012-10-13T19:51:08.720
> 
> 标签：ruby-on-rails, ruby, gem

我正在研究 rails gem，其中我有一些逻辑，我希望基于 rails 环境有条件。

以下代码错误：

```
if Rails.env.production? 
```

在测试应用程序中运行时，这给了我：

```
undefined method .env for Gemname::Rails::Module 
```

那么，如何从 gem 中的模块中的方法调用中找到 Rails 环境呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-13T19:53:25.847

您的项目中有一个`Rails`模块，并且不断查找是找到它，而不是顶级 Rails 模块。您可以使用顶级常量：

```
::Rails.env.production? 
```

或者您可以只检查环境变量：

```
ENV['RAILS_ENV'] 
```

# qml - 如何在 QML 的 StackLayout 中将标签文本居中？

> ID：12876417
> 
> 赞同：2
> 
> 时间：2012-10-13T19:51:17.917
> 
> 标签：qml

我有一个容器，它是一个 DockLayout，在这个容器中是另一个作为 StackLayout 的容器。我有一个我想居中的标签，但我无法让它发挥作用。

我需要一些帮助。

这是结构的一个小概述：

```
Container {
    layout: DockLayout {
    }
    Container {
        id: cAnzeige
        Label {
            id: lblHeader
            textStyle.fontSize: FontSize.XLarge
            text: "header"
        }
        verticalAlignment: VerticalAlignment.Top
        layout: StackLayout {
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T12:07:37.890

1）使 StackLayout 填充水平宽度：

```
horizontalAlignment = HorizontalAlignment.FILL 
```

2）使标签居中：

```
horizontalAlignment = HorizontalAlignment.CENTER 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T00:49:21.673

`StackLayout`这里是多余的。在您的情况下使用`DockLayout`就足够了：

```
Container {
    layout: DockLayout {
    }
    Container {
        id: cAnzeige
        horizontalAlignment: HorizontalAlignment.Center
        verticalAlignment: VerticalAlignment.Center
        Label {
            id: lblHeader
            textStyle.fontSize: FontSize.XLarge
            text: "header"
        }
    }
} 
```

# ruby-on-rails - Rails 3：创建和删除操作给出“找不到模板”错误

> ID：12876418
> 
> 赞同：1
> 
> 时间：2012-10-13T19:51:19.210
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routing, blogs

我遇到了一个非常奇怪的错误。我已经安装了“ [Blogit](https://github.com/KatanaCode/blogit) ”，并试图添加一些零碎的东西。提交新条目时遇到一个奇怪的错误：

```
Template is missing

Missing template blogit/posts/create, blogit/application/create, application/create with 
{:locale=>[:en], :formats=>[:html], :handlers=>[:erb, :builder, :coffee]}. Searched in: * 
"/Users/James/Documents/Websites/Backpack Bug/app/views" * "/Users/James/.rvm/gems/ruby-
1.9.3-p0/gems/blogit-0.4.8/app/views" * "/Users/James/.rvm/gems/ruby-1.9.3-
p0/gems/kaminari-0.14.1/app/views" * "/Users/James/.rvm/gems/ruby-1.9.3-p0/gems/devise-
2.1.2/app/views" 
```

我感觉这与我的路由有关。这是routes.rb

```
appname::Application.routes.draw do

root :to => 'locations#index'

devise_for :users

resources :locations do
   collection do
   get 'location'
  end
end

mount Blogit::Engine => "/blog", :as => "blog" 

end 
```

这是帖子控制器：

```
module Blogit

class PostsController < ApplicationController

unless blogit_conf.include_admin_actions
  before_filter :raise_404, except: [:index, :show, :tagged]
end

blogit_authenticate(except: [:index, :show, :tagged])

blogit_cacher(:index, :show, :tagged)
blogit_sweeper(:create, :update, :destroy)

def index
  respond_to do |format|
    format.xml {
      @posts = Post.order('created_at DESC')
    }
    format.html {
      @posts = Post.for_index(params[:page])
    }
    format.rss {
      @posts = Post.order('created_at DESC')
    }
  end
end

def show
  @post    = Post.find(params[:id])
  @comment = @post.comments.new
end

def tagged
  @posts = Post.for_index(params[:page]).tagged_with(params[:tag])
  render :index
end

def location
  @georesult = Geocoder.search(params[:location])

 respond_to do |format|
  format.html {render :layout=>false}# venues.html.erb
 end
end

def new
  @post = current_blogger.blog_posts.new(params[:post])
  @location = @post.locations.build
end

def edit
  @post = current_blogger.blog_posts.find(params[:id])
  @location = @post.locations.new
end

def create
  @post = current_blogger.blog_posts.new(params[:post])

respond_to do |format|
  if @post.save
    format.html { redirect_to @post, :method => :get, notice: 'Blog post was successfully created.' }
    format.json { render json: @post, status: :created, location: @post }
  else
    format.html { render action: "new" }
    format.json { render json: @post.errors, status: :unprocessable_entity }
  end
end

end

def update
  @post = current_blogger.blog_posts.find(params[:id])
  if @post.update_attributes(params[:post])
    redirect_to @post, notice: 'Blog post was successfully updated.'
  else
    render action: "edit"
  end
end

def destroy
  @post = current_blogger.blog_posts.find(params[:id])
  @post.destroy
  redirect_to posts_url, notice: "Blog post was successfully destroyed."
end

private

def raise_404
  # Don't include admin actions if include_admin_actions is false
  render file: "#{Rails.root}/public/404.html", status: :not_found, layout: false
end

end

end 
```

到目前为止，我从源代码所做的所有更改是，我基本上创建了一个多部分表单，它允许搜索位置并将它们提交到同一发布操作中的位置表。不确定这是否与它有关。我可以发布所有这些代码，但它很长。如果您认为这也有用，请告诉我。

非常感谢您的帮助！坦率地说，我很难过。

詹姆士

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T03:41:42.983

只是一个预感：看看你的`location`动作是否被调用。我刚刚遇到了一个稍微不同的错误，我的控制器中的任何调用`redirect_to`都导致我`location`在同一个控制器中的方法被调用。（在方法`raise`的开头加上a`location`会很快让你知道。）

我没有尝试调查究竟为什么会发生这种情况，但是重命名我的`location`操作解决了这个问题（显然，这需要更改引用该端点的任何其他代码，例如我的 JavaScript 中的 AJAX 请求）。毫无疑问，Rails 的魔力。

# apache - 无法使用 Internet 中的另一台计算机连接到 localhost

> ID：12876420
> 
> 赞同：0
> 
> 时间：2012-10-13T19:51:31.453
> 
> 标签：apache, localhost

就像标题一样，我有一个问题，我不知道为什么它不起作用。防火墙被禁用。这是我的配置：

```
http://ziggy.vot.pl/configuration/1.jpg
http://ziggy.vot.pl/configuration/2.jpg
http://ziggy.vot.pl/configuration/3.jpg 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:03:30.900

您应该转发到 8080 端口而不是 80。

89.74.98.57 你是公网IP吗？你能ping通他们吗？也试试：

```
Listen 0.0.0.0:8080 
```

# ios - iOS最低系统

> ID：12876422
> 
> 赞同：0
> 
> 时间：2012-10-13T19:51:45.200
> 
> 标签：ios

我即将更新我的 iPad 应用程序。我没有从 iOS 6 中添加任何新功能，但是，我的一位测试人员告诉我他无法更新，因为他使用 iPad 1 卡在 5.1 上。我的项目的 BaseSDK 设置为 6.0，但是部署目标设置为5.1。我认为这仍然适用于 iOS 5？我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:03:49.523

检查目标的部署目标。这可能与项目的部署目标不同。目标的部署目标为 5.1 将允许应用在装有 iOS 5.1 的设备上运行。

# c# - 如何通过 testfixture 参数运行测试方法？

> ID：12876423
> 
> 赞同：2
> 
> 时间：2012-10-13T19:51:49.193
> 
> 标签：c#, .net, unit-testing, nunit, nunit-2.5

我有一个测试课和一个像下面这样的课。

```
public class Foo
{
    private IDbOjbect _db;

    public Foo(string conn)
    {
        _db = new DbOjbect(conn);
    }

    internal Foo(IDbObject db)
    {
        _db= db;
    }

    internal bool TestOne()
    {
        if (_db.CurrentDbType == DBType.Oracle)
        {
            //do something
            return true;
        }
        return false;
    }

    internal bool TestTwo()
    {
        if (_db.CurrentDbType == DBType.SqlServer || 
            _db.CurrentDbType == DBType.SqlServerCE)
        {
            //do something
            return true
        }
        return false;
    }

    internal bool TestThree()
    {
        if (_db.CurrentDbType == DBType.MySql || 
            _db.CurrentDbType == DBType.PostgreSQL || 
            _db.CurrentDbType == DBType.SQLite)
        {
            //do something
            return true
        }
        return false;
    }

    public void RunProcesses()
    {
         TestOne();
         TestTwo();
         TestThree();
    }
}

[TestFixture("sqlserver")]
[TestFixture("sqlserverce")]
[TestFixture("oracle")]
[TestFixture("mysql")]
[TestFixture("sqlite")]
[TestFixture("postgre")]
public class Tests
{
   private string _conn;
   private Foo f;

   public Tests(string conn)
   {
       _conn = conn;
   }

    [SetUp]
    public void SetUp()
    {
        db = new Mock<IDbObject>();
        switch (_conn)
        {
            case "sqlserver":
                db.Setup(x => x.CurrentDbType).Returns(DBType.SqlServer);
                break;
            case "sqlserverce":
                db.Setup(x => x.CurrentDbType).Returns(DBType.SqlServerCE);
                break;
            case "mysql":
                db.Setup(x => x.CurrentDbType).Returns(DBType.MySql);
                break;
            case "postgre":
                db.Setup(x => x.CurrentDbType).Returns(DBType.PostgreSQL);
                break;
            case "sqlite":
                db.Setup(x => x.CurrentDbType).Returns(DBType.SQLite);
                break;
            case "oracle":
                db.Setup(x => x.CurrentDbType).Returns(DBType.Oracle);
                break;
        }

        f = new Foo(db.Object);
    }

   [Test]
   public void TestOne()
   {
       Assert.IsTrue(f.TestOne());
   }

   [Test]
   public void TestTwo()
   {
       Assert.IsTrue(f.TestTwo());
   }

   [Test]
   public void TestThree()
   {
       Assert.IsTrue(f.TestThree());
   }
} 
```

当 _conn 是 oracle 时，我想运行 TestOne 方法。当 _conn 是 sqlserver 或 sqlserverce 时，我想运行 TestThree 方法。当 _conn 是 mysql、sqlite 或 postgre 时，我想运行 TestTwo 方法。我怎样才能做到这一点 ？是否有 nunit 的属性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-13T20:09:02.700

这真的不是`TestFixture`... 如果您不想使用`if`，为什么不在测试中明确说明？您可以将 a`TestCase`用于您希望通过某个测试的值。

```
[TestFixture]
public class Tests {

    [TestCase("test1")]
    public void FooTest_One(String value) {
        Foo f = new Foo(value);
        Assert.IsTrue(f.TestOne());
        Assert.IsFalse(f.TestTwo());
    }

    [TestCase("test2")]
    public void FooTest_Two(String value) {
        Foo f = new Foo(value);
        Assert.IsTrue(f.TestTwo());
        Assert.IsFalse(f.TestOne());
    }
} 
```

假设您要测试两个以上的值，您还可`TestCase`以为与预期行为相对应的值添加额外的 's：

```
[TestCase("test1")]
[TestCase("test1.1")]
public void FooTest_One(String value) ...

[TestCase("test2")]
[TestCase("test2.1")]
public void FooTest_Two(String value) ... 
```

这为您提供了测试应该失败的案例的额外好处。我不确定它是否符合您的实际情况，但除了预期的通过值之外，测试失败总是很重要的。

* * *

**编辑** 如果您确实需要基于 DB 类型的类的动态行为`Foo`，最好的办法是创建一个抽象类来表示预期的行为。使用它，您的特定于数据库的实现将在运行时被调用。这是一个简短的示例：

```
public abstract class Foo {
    protected IDbOjbect _db;

    private DBType _type;
    public DBType Type {
        get { return _type; }
    }

    public Foo(DBType type) {
        _type = type;
    }

    internal abstract bool RunTest();

    public void Connect(IDbObject db) {
        _db = db;
    }

    public static Foo Create(String type) {
        switch (type) {
            case "oracle": return new FooImpl_Oracle();
        }

        return null;
    }
}

public sealed class FooImpl_Oracle : Foo {
    internal FooImpl_Oracle() : base(DBType.Oracle) {
    }

    internal bool RunTest() {
        //do something
        return true;
    }
}

[TestFixture("oracle")]
public class Tests {
    private Foo f;

    public Tests(string conn) {
        f = Foo.Create(conn);
    }

    [SetUp]
    public void SetUp() {
        Mock<IDbObject> db = new Mock<IDbObject>();
        db.Setup(x => x.CurrentDbType).Returns(f.Type);
        f.Connect(db);
    }

    [Test]
    public void TestOne() {
        Assert.IsTrue(f.RunTest());
    }
} 
```

这将保留 的含义`TestFixture`，即使用特定配置选项运行夹具中的所有测试。它可能不完全适合您的实际情况，但希望这两个想法能给您一些方向。

# php - 反正有没有在同一段落上的搜索栏？

> ID：12876429
> 
> 赞同：0
> 
> 时间：2012-10-13T19:52:47.357
> 
> 标签：php, css

反正有没有在同一段落上的搜索栏？它一直在下降....：/

```
<li><a href="tree.php">Account</a></li>
<input type="text" class="uiinput" id="searchinput"  />
<div style="float:right;"/><li><a href='<?php echo $base_url; ?>logout.php' style='color:#fff'>Log Out </a></li>
</ul></div> 
```

请帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T21:24:02.027

您可以首先将输入和 div 放在他们自己`li`的 s 中，以修复 Michael Berkowski 的良好观察（即，您`HTML`的无效）

```
<ul>
    <li>
      <a href="tree.php">Account</a>
    </li>
    <li>
      <input type="text" class="uiinput" id="searchinput" />
      <div style="float:right;"/><a href='<?php echo $base_url; ?>logout.php' style='color:#fff'>Log Out </a>
    </li>
</ul> 
```

那么你可以申请`float:left;`s `li`。

```
li {
    float: left;
} 
```

这是未经测试的，但这样的事情会让你朝着正确的方向开始。请注意，它忽略了代码的其他问题，例如您似乎使用`list`不当。

# javascript - JavaScript、Chrome、文本框、空格、退格

> ID：12876434
> 
> 赞同：1
> 
> 时间：2012-10-13T19:53:18.690
> 
> 标签：javascript, google-chrome, clojurescript

我正在用 JavaScript 编写代码，目标是 Chrome。

现在，考虑一下在以下情况下会发生什么：

*   我在网页上按空格/退格键 vs
*   我在文本框上按空格/退格

通过使用 (goog.events.listen js/document.body ...) 我可以监听 Space/Baskspace 事件并对它们做出反应。但是，浏览器仍会处理它们，即当我按 Space 时，浏览器仍会向下滚动，而当我按 Basckspace 时，浏览器会转到上一个网页。

我想阻止这种“默认行为”——即我想处理空格/退格事件，并且我希望浏览器忽略它们。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T19:57:34.850

从事件处理程序返回 false 以取消事件。

```
document.body.onkeydown = function killSpace(e) {
    if (e.keyCode === 32) {
        return false;
    }
}; 
```

请不要像这样在全局范围内杀死键盘快捷键。它损害了可用性。仅当页面上的某些自定义小部件具有焦点时才阻止默认行为，并且此元素可以使用诸如 tab 之类的键盘快捷键失去焦点。

# c# - 将 Delphi+Assembler CRC32 实现翻译成 C#

> ID：12876436
> 
> 赞同：4
> 
> 时间：2012-10-13T19:53:39.637
> 
> 标签：c#, delphi, assembly, crc, crc32

我必须将一个旧的大型应用程序从 Delphi 部分翻译为 .NET (C#)。这是 CRC32 的一个奇怪的（至少对我而言）实现：

```
function CRC32(CRC: LongWord; Data: Pointer; DataSize: LongWord): LongWord; assembler;
asm
         AND    EDX,EDX
         JZ     @Exit
         AND    ECX,ECX
         JLE    @Exit
         PUSH   EBX
         PUSH   EDI
         XOR    EBX,EBX
         LEA    EDI,CS:[OFFSET @CRC32]
@Start:  MOV    BL,AL
         SHR    EAX,8
         XOR    BL,[EDX]
         XOR    EAX,[EDI + EBX * 4]
         INC    EDX
         DEC    ECX
         JNZ    @Start
         POP    EDI
         POP    EBX
@Exit:   RET
         DB 0, 0, 0, 0, 0 // Align Table
@CRC32:  DD 000000000h, 077073096h, 0EE0E612Ch, 0990951BAh
         DD 0076DC419h, 0706AF48Fh, 0E963A535h, 09E6495A3h
         DD 00EDB8832h, 079DCB8A4h, 0E0D5E91Eh, 097D2D988h
         DD 009B64C2Bh, 07EB17CBDh, 0E7B82D07h, 090BF1D91h
         DD 01DB71064h, 06AB020F2h, 0F3B97148h, 084BE41DEh
         DD 01ADAD47Dh, 06DDDE4EBh, 0F4D4B551h, 083D385C7h
         DD 0136C9856h, 0646BA8C0h, 0FD62F97Ah, 08A65C9ECh
         DD 014015C4Fh, 063066CD9h, 0FA0F3D63h, 08D080DF5h
         DD 03B6E20C8h, 04C69105Eh, 0D56041E4h, 0A2677172h
         DD 03C03E4D1h, 04B04D447h, 0D20D85FDh, 0A50AB56Bh
         DD 035B5A8FAh, 042B2986Ch, 0DBBBC9D6h, 0ACBCF940h
         DD 032D86CE3h, 045DF5C75h, 0DCD60DCFh, 0ABD13D59h
         DD 026D930ACh, 051DE003Ah, 0C8D75180h, 0BFD06116h
         DD 021B4F4B5h, 056B3C423h, 0CFBA9599h, 0B8BDA50Fh
         DD 02802B89Eh, 05F058808h, 0C60CD9B2h, 0B10BE924h
         DD 02F6F7C87h, 058684C11h, 0C1611DABh, 0B6662D3Dh
         DD 076DC4190h, 001DB7106h, 098D220BCh, 0EFD5102Ah
         DD 071B18589h, 006B6B51Fh, 09FBFE4A5h, 0E8B8D433h
         DD 07807C9A2h, 00F00F934h, 09609A88Eh, 0E10E9818h
         DD 07F6A0DBBh, 0086D3D2Dh, 091646C97h, 0E6635C01h
         DD 06B6B51F4h, 01C6C6162h, 0856530D8h, 0F262004Eh
         DD 06C0695EDh, 01B01A57Bh, 08208F4C1h, 0F50FC457h
         DD 065B0D9C6h, 012B7E950h, 08BBEB8EAh, 0FCB9887Ch
         DD 062DD1DDFh, 015DA2D49h, 08CD37CF3h, 0FBD44C65h
         DD 04DB26158h, 03AB551CEh, 0A3BC0074h, 0D4BB30E2h
         DD 04ADFA541h, 03DD895D7h, 0A4D1C46Dh, 0D3D6F4FBh
         DD 04369E96Ah, 0346ED9FCh, 0AD678846h, 0DA60B8D0h
         DD 044042D73h, 033031DE5h, 0AA0A4C5Fh, 0DD0D7CC9h
         DD 05005713Ch, 0270241AAh, 0BE0B1010h, 0C90C2086h
         DD 05768B525h, 0206F85B3h, 0B966D409h, 0CE61E49Fh
         DD 05EDEF90Eh, 029D9C998h, 0B0D09822h, 0C7D7A8B4h
         DD 059B33D17h, 02EB40D81h, 0B7BD5C3Bh, 0C0BA6CADh
         DD 0EDB88320h, 09ABFB3B6h, 003B6E20Ch, 074B1D29Ah
         DD 0EAD54739h, 09DD277AFh, 004DB2615h, 073DC1683h
         DD 0E3630B12h, 094643B84h, 00D6D6A3Eh, 07A6A5AA8h
         DD 0E40ECF0Bh, 09309FF9Dh, 00A00AE27h, 07D079EB1h
         DD 0F00F9344h, 08708A3D2h, 01E01F268h, 06906C2FEh
         DD 0F762575Dh, 0806567CBh, 0196C3671h, 06E6B06E7h
         DD 0FED41B76h, 089D32BE0h, 010DA7A5Ah, 067DD4ACCh
         DD 0F9B9DF6Fh, 08EBEEFF9h, 017B7BE43h, 060B08ED5h
         DD 0D6D6A3E8h, 0A1D1937Eh, 038D8C2C4h, 04FDFF252h
         DD 0D1BB67F1h, 0A6BC5767h, 03FB506DDh, 048B2364Bh
         DD 0D80D2BDAh, 0AF0A1B4Ch, 036034AF6h, 041047A60h
         DD 0DF60EFC3h, 0A867DF55h, 0316E8EEFh, 04669BE79h
         DD 0CB61B38Ch, 0BC66831Ah, 0256FD2A0h, 05268E236h
         DD 0CC0C7795h, 0BB0B4703h, 0220216B9h, 05505262Fh
         DD 0C5BA3BBEh, 0B2BD0B28h, 02BB45A92h, 05CB36A04h
         DD 0C2D7FFA7h, 0B5D0CF31h, 02CD99E8Bh, 05BDEAE1Dh
         DD 09B64C2B0h, 0EC63F226h, 0756AA39Ch, 0026D930Ah
         DD 09C0906A9h, 0EB0E363Fh, 072076785h, 005005713h
         DD 095BF4A82h, 0E2B87A14h, 07BB12BAEh, 00CB61B38h
         DD 092D28E9Bh, 0E5D5BE0Dh, 07CDCEFB7h, 00BDBDF21h
         DD 086D3D2D4h, 0F1D4E242h, 068DDB3F8h, 01FDA836Eh
         DD 081BE16CDh, 0F6B9265Bh, 06FB077E1h, 018B74777h
         DD 088085AE6h, 0FF0F6A70h, 066063BCAh, 011010B5Ch
         DD 08F659EFFh, 0F862AE69h, 0616BFFD3h, 0166CCF45h
         DD 0A00AE278h, 0D70DD2EEh, 04E048354h, 03903B3C2h
         DD 0A7672661h, 0D06016F7h, 04969474Dh, 03E6E77DBh
         DD 0AED16A4Ah, 0D9D65ADCh, 040DF0B66h, 037D83BF0h
         DD 0A9BCAE53h, 0DEBB9EC5h, 047B2CF7Fh, 030B5FFE9h
         DD 0BDBDF21Ch, 0CABAC28Ah, 053B39330h, 024B4A3A6h
         DD 0BAD03605h, 0CDD70693h, 054DE5729h, 023D967BFh
         DD 0B3667A2Eh, 0C4614AB8h, 05D681B02h, 02A6F2B94h
         DD 0B40BBE37h, 0C30C8EA1h, 05A05DF1Bh, 02D02EF8Dh
         DD 074726F50h, 0736E6F69h, 0706F4320h, 067697279h
         DD 028207468h, 031202963h, 020393939h, 048207962h
         DD 06E656761h, 064655220h, 06E616D64h, 06FBBA36Eh
end; 
```

它现在被使用并且它以某种方式工作，因为数据是通过网络发送的，并且目标设备可以正常处理它们。我需要从 C# 函数中获得相同的结果，因此我在 StackOverflow 解决方案中使用了 [)amien 在 C# 中与 CRC32 相关的最推荐的解决方案，[链接在这里](http://damieng.com/blog/2006/08/08/calculating_crc32_in_c_and_net)：但我得到了不同的结果：

```
//Old-Delphi
procedure TestCrc();
var
  ret: LongWord;
const
  lArr: array[0..2] of Byte = (49, 50, 51); //"123"
begin
  ret := CRC32(0, @lArr, Length(lArr)); //1997126336
  //print IntToStr(ret); //1997126336
end 
```

在 C# 中

```
//New-C#
static void Main(string[] args)
{
    Crc32 crc32 = new Crc32(); //Using Default ctor
    String hash = String.Empty;
    string testStr = "123"; //in bytes {49, 50, 51}
    byte[] out_bytes = crc32.ComputeHash(Encoding.ASCII.GetBytes(testStr));
    foreach (byte b in out_bytes) hash += b.ToString("x2").ToLower();
    Console.WriteLine("CRC-32 is {0} ({1})", hash, BitConverter.ToUInt32(out_bytes, 0));
    //Output is Uint32 value = 3529721992
} 
```

我不知道区别在哪里 - 也许在表格和种子中？或者也许更好的解决方案将旧功能包装在 DLL 中并通过 COM 从新的 C# 应用程序访问它？

请指教...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-13T21:52:59.947

我已经“模拟”了您发布的汇编代码。它给出了与您的测试相同的结果（1997126336）。

```
class Program
{
    static void Main(string[] args)
    {
        byte[] test = { 49, 50, 51 };
        Console.WriteLine(CRC32(0, test));
        Console.ReadLine();
    }

    static uint CRC32(uint CRC, byte[] data)
    {
        if (data == null || data.Length == 0) return CRC;

        uint eax = CRC, ebx = 0, ecx = (uint)data.Length, edx = 0;

    Start:
        ebx = (ebx & 0xFFFF0000) | (eax & 0x0000FFFF);
        eax >>= 8;
        ebx = (ebx & 0xFFFF0000) | (data[edx] ^ (ebx & 0x000000FF));
        eax = eax ^ Table[ebx];
        edx++;
        ecx--;
        if (ecx != 0) goto Start;
        return eax;
    }

    static readonly uint[] Table = {                              
        0x00000000, 0x77073096, 0xEE0E612C, 0x990951BA,
        0x076DC419, 0x706AF48F, 0xE963A535, 0x9E6495A3,
        0x0EDB8832, 0x79DCB8A4, 0xE0D5E91E, 0x97D2D988,
        0x09B64C2B, 0x7EB17CBD, 0xE7B82D07, 0x90BF1D91,
        0x1DB71064, 0x6AB020F2, 0xF3B97148, 0x84BE41DE,
        0x1ADAD47D, 0x6DDDE4EB, 0xF4D4B551, 0x83D385C7,
        0x136C9856, 0x646BA8C0, 0xFD62F97A, 0x8A65C9EC,
        0x14015C4F, 0x63066CD9, 0xFA0F3D63, 0x8D080DF5,
        0x3B6E20C8, 0x4C69105E, 0xD56041E4, 0xA2677172,
        0x3C03E4D1, 0x4B04D447, 0xD20D85FD, 0xA50AB56B,
        0x35B5A8FA, 0x42B2986C, 0xDBBBC9D6, 0xACBCF940,
        0x32D86CE3, 0x45DF5C75, 0xDCD60DCF, 0xABD13D59,
        0x26D930AC, 0x51DE003A, 0xC8D75180, 0xBFD06116,
        0x21B4F4B5, 0x56B3C423, 0xCFBA9599, 0xB8BDA50F,
        0x2802B89E, 0x5F058808, 0xC60CD9B2, 0xB10BE924,
        0x2F6F7C87, 0x58684C11, 0xC1611DAB, 0xB6662D3D,
        0x76DC4190, 0x01DB7106, 0x98D220BC, 0xEFD5102A,
        0x71B18589, 0x06B6B51F, 0x9FBFE4A5, 0xE8B8D433,
        0x7807C9A2, 0x0F00F934, 0x9609A88E, 0xE10E9818,
        0x7F6A0DBB, 0x086D3D2D, 0x91646C97, 0xE6635C01,
        0x6B6B51F4, 0x1C6C6162, 0x856530D8, 0xF262004E,
        0x6C0695ED, 0x1B01A57B, 0x8208F4C1, 0xF50FC457,
        0x65B0D9C6, 0x12B7E950, 0x8BBEB8EA, 0xFCB9887C,
        0x62DD1DDF, 0x15DA2D49, 0x8CD37CF3, 0xFBD44C65,
        0x4DB26158, 0x3AB551CE, 0xA3BC0074, 0xD4BB30E2,
        0x4ADFA541, 0x3DD895D7, 0xA4D1C46D, 0xD3D6F4FB,
        0x4369E96A, 0x346ED9FC, 0xAD678846, 0xDA60B8D0,
        0x44042D73, 0x33031DE5, 0xAA0A4C5F, 0xDD0D7CC9,
        0x5005713C, 0x270241AA, 0xBE0B1010, 0xC90C2086,
        0x5768B525, 0x206F85B3, 0xB966D409, 0xCE61E49F,
        0x5EDEF90E, 0x29D9C998, 0xB0D09822, 0xC7D7A8B4,
        0x59B33D17, 0x2EB40D81, 0xB7BD5C3B, 0xC0BA6CAD,
        0xEDB88320, 0x9ABFB3B6, 0x03B6E20C, 0x74B1D29A,
        0xEAD54739, 0x9DD277AF, 0x04DB2615, 0x73DC1683,
        0xE3630B12, 0x94643B84, 0x0D6D6A3E, 0x7A6A5AA8,
        0xE40ECF0B, 0x9309FF9D, 0x0A00AE27, 0x7D079EB1,
        0xF00F9344, 0x8708A3D2, 0x1E01F268, 0x6906C2FE,
        0xF762575D, 0x806567CB, 0x196C3671, 0x6E6B06E7,
        0xFED41B76, 0x89D32BE0, 0x10DA7A5A, 0x67DD4ACC,
        0xF9B9DF6F, 0x8EBEEFF9, 0x17B7BE43, 0x60B08ED5,
        0xD6D6A3E8, 0xA1D1937E, 0x38D8C2C4, 0x4FDFF252,
        0xD1BB67F1, 0xA6BC5767, 0x3FB506DD, 0x48B2364B,
        0xD80D2BDA, 0xAF0A1B4C, 0x36034AF6, 0x41047A60,
        0xDF60EFC3, 0xA867DF55, 0x316E8EEF, 0x4669BE79,
        0xCB61B38C, 0xBC66831A, 0x256FD2A0, 0x5268E236,
        0xCC0C7795, 0xBB0B4703, 0x220216B9, 0x5505262F,
        0xC5BA3BBE, 0xB2BD0B28, 0x2BB45A92, 0x5CB36A04,
        0xC2D7FFA7, 0xB5D0CF31, 0x2CD99E8B, 0x5BDEAE1D,
        0x9B64C2B0, 0xEC63F226, 0x756AA39C, 0x026D930A,
        0x9C0906A9, 0xEB0E363F, 0x72076785, 0x05005713,
        0x95BF4A82, 0xE2B87A14, 0x7BB12BAE, 0x0CB61B38,
        0x92D28E9B, 0xE5D5BE0D, 0x7CDCEFB7, 0x0BDBDF21,
        0x86D3D2D4, 0xF1D4E242, 0x68DDB3F8, 0x1FDA836E,
        0x81BE16CD, 0xF6B9265B, 0x6FB077E1, 0x18B74777,
        0x88085AE6, 0xFF0F6A70, 0x66063BCA, 0x11010B5C,
        0x8F659EFF, 0xF862AE69, 0x616BFFD3, 0x166CCF45,
        0xA00AE278, 0xD70DD2EE, 0x4E048354, 0x3903B3C2,
        0xA7672661, 0xD06016F7, 0x4969474D, 0x3E6E77DB,
        0xAED16A4A, 0xD9D65ADC, 0x40DF0B66, 0x37D83BF0,
        0xA9BCAE53, 0xDEBB9EC5, 0x47B2CF7F, 0x30B5FFE9,
        0xBDBDF21C, 0xCABAC28A, 0x53B39330, 0x24B4A3A6,
        0xBAD03605, 0xCDD70693, 0x54DE5729, 0x23D967BF,
        0xB3667A2E, 0xC4614AB8, 0x5D681B02, 0x2A6F2B94,
        0xB40BBE37, 0xC30C8EA1, 0x5A05DF1B, 0x2D02EF8D,
        0x74726F50, 0x736E6F69, 0x706F4320, 0x67697279,
        0x28207468, 0x31202963, 0x20393939, 0x48207962,
        0x6E656761, 0x64655220, 0x6E616D64, 0x6FBBA36E };

} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-13T21:57:19.110

遵循@DavidHeffernan 的建议，我在 C# 中也取得了相同的结果：

```
using System;
using System.Text;

namespace CRC32_Tst
{
    class Program
    {
        static void Main(string[] args)
        {
            UInt32[] MyTAB = new UInt32[] { 
                0x000000000, 0x077073096, 0x0EE0E612C, 0x0990951BA, 
                0x0076DC419, 0x0706AF48F, 0x0E963A535, 0x09E6495A3, 
                0x00EDB8832, 0x079DCB8A4, 0x0E0D5E91E, 0x097D2D988, 
                0x009B64C2B, 0x07EB17CBD, 0x0E7B82D07, 0x090BF1D91, 
                0x01DB71064, 0x06AB020F2, 0x0F3B97148, 0x084BE41DE, 
                0x01ADAD47D, 0x06DDDE4EB, 0x0F4D4B551, 0x083D385C7, 
                0x0136C9856, 0x0646BA8C0, 0x0FD62F97A, 0x08A65C9EC, 
                0x014015C4F, 0x063066CD9, 0x0FA0F3D63, 0x08D080DF5, 
                0x03B6E20C8, 0x04C69105E, 0x0D56041E4, 0x0A2677172, 
                0x03C03E4D1, 0x04B04D447, 0x0D20D85FD, 0x0A50AB56B, 
                0x035B5A8FA, 0x042B2986C, 0x0DBBBC9D6, 0x0ACBCF940, 
                0x032D86CE3, 0x045DF5C75, 0x0DCD60DCF, 0x0ABD13D59, 
                0x026D930AC, 0x051DE003A, 0x0C8D75180, 0x0BFD06116, 
                0x021B4F4B5, 0x056B3C423, 0x0CFBA9599, 0x0B8BDA50F, 
                0x02802B89E, 0x05F058808, 0x0C60CD9B2, 0x0B10BE924, 
                0x02F6F7C87, 0x058684C11, 0x0C1611DAB, 0x0B6662D3D, 
                0x076DC4190, 0x001DB7106, 0x098D220BC, 0x0EFD5102A, 
                0x071B18589, 0x006B6B51F, 0x09FBFE4A5, 0x0E8B8D433, 
                0x07807C9A2, 0x00F00F934, 0x09609A88E, 0x0E10E9818, 
                0x07F6A0DBB, 0x0086D3D2D, 0x091646C97, 0x0E6635C01, 
                0x06B6B51F4, 0x01C6C6162, 0x0856530D8, 0x0F262004E, 
                0x06C0695ED, 0x01B01A57B, 0x08208F4C1, 0x0F50FC457, 
                0x065B0D9C6, 0x012B7E950, 0x08BBEB8EA, 0x0FCB9887C, 
                0x062DD1DDF, 0x015DA2D49, 0x08CD37CF3, 0x0FBD44C65, 
                0x04DB26158, 0x03AB551CE, 0x0A3BC0074, 0x0D4BB30E2, 
                0x04ADFA541, 0x03DD895D7, 0x0A4D1C46D, 0x0D3D6F4FB, 
                0x04369E96A, 0x0346ED9FC, 0x0AD678846, 0x0DA60B8D0, 
                0x044042D73, 0x033031DE5, 0x0AA0A4C5F, 0x0DD0D7CC9, 
                0x05005713C, 0x0270241AA, 0x0BE0B1010, 0x0C90C2086, 
                0x05768B525, 0x0206F85B3, 0x0B966D409, 0x0CE61E49F, 
                0x05EDEF90E, 0x029D9C998, 0x0B0D09822, 0x0C7D7A8B4, 
                0x059B33D17, 0x02EB40D81, 0x0B7BD5C3B, 0x0C0BA6CAD, 
                0x0EDB88320, 0x09ABFB3B6, 0x003B6E20C, 0x074B1D29A, 
                0x0EAD54739, 0x09DD277AF, 0x004DB2615, 0x073DC1683, 
                0x0E3630B12, 0x094643B84, 0x00D6D6A3E, 0x07A6A5AA8, 
                0x0E40ECF0B, 0x09309FF9D, 0x00A00AE27, 0x07D079EB1, 
                0x0F00F9344, 0x08708A3D2, 0x01E01F268, 0x06906C2FE, 
                0x0F762575D, 0x0806567CB, 0x0196C3671, 0x06E6B06E7, 
                0x0FED41B76, 0x089D32BE0, 0x010DA7A5A, 0x067DD4ACC, 
                0x0F9B9DF6F, 0x08EBEEFF9, 0x017B7BE43, 0x060B08ED5, 
                0x0D6D6A3E8, 0x0A1D1937E, 0x038D8C2C4, 0x04FDFF252, 
                0x0D1BB67F1, 0x0A6BC5767, 0x03FB506DD, 0x048B2364B, 
                0x0D80D2BDA, 0x0AF0A1B4C, 0x036034AF6, 0x041047A60, 
                0x0DF60EFC3, 0x0A867DF55, 0x0316E8EEF, 0x04669BE79, 
                0x0CB61B38C, 0x0BC66831A, 0x0256FD2A0, 0x05268E236, 
                0x0CC0C7795, 0x0BB0B4703, 0x0220216B9, 0x05505262F, 
                0x0C5BA3BBE, 0x0B2BD0B28, 0x02BB45A92, 0x05CB36A04, 
                0x0C2D7FFA7, 0x0B5D0CF31, 0x02CD99E8B, 0x05BDEAE1D, 
                0x09B64C2B0, 0x0EC63F226, 0x0756AA39C, 0x0026D930A, 
                0x09C0906A9, 0x0EB0E363F, 0x072076785, 0x005005713, 
                0x095BF4A82, 0x0E2B87A14, 0x07BB12BAE, 0x00CB61B38, 
                0x092D28E9B, 0x0E5D5BE0D, 0x07CDCEFB7, 0x00BDBDF21, 
                0x086D3D2D4, 0x0F1D4E242, 0x068DDB3F8, 0x01FDA836E, 
                0x081BE16CD, 0x0F6B9265B, 0x06FB077E1, 0x018B74777, 
                0x088085AE6, 0x0FF0F6A70, 0x066063BCA, 0x011010B5C, 
                0x08F659EFF, 0x0F862AE69, 0x0616BFFD3, 0x0166CCF45, 
                0x0A00AE278, 0x0D70DD2EE, 0x04E048354, 0x03903B3C2, 
                0x0A7672661, 0x0D06016F7, 0x04969474D, 0x03E6E77DB, 
                0x0AED16A4A, 0x0D9D65ADC, 0x040DF0B66, 0x037D83BF0, 
                0x0A9BCAE53, 0x0DEBB9EC5, 0x047B2CF7F, 0x030B5FFE9, 
                0x0BDBDF21C, 0x0CABAC28A, 0x053B39330, 0x024B4A3A6, 
                0x0BAD03605, 0x0CDD70693, 0x054DE5729, 0x023D967BF, 
                0x0B3667A2E, 0x0C4614AB8, 0x05D681B02, 0x02A6F2B94, 
                0x0B40BBE37, 0x0C30C8EA1, 0x05A05DF1B, 0x02D02EF8D, 
                0x074726F50, 0x0736E6F69, 0x0706F4320, 0x067697279, 
                0x028207468, 0x031202963, 0x020393939, 0x048207962, 
                0x06E656761, 0x064655220, 0x06E616D64, 0x06FBBA36E
                            };
            //UInt32 DefaultSeed = 0xffffffff;
            UInt32 UsedSeed = 0x00000000;

            string testStr = "123";
            byte[] inBytes = Encoding.ASCII.GetBytes(testStr);

            UInt32 ret_uint = CalculateHash(MyTAB, UsedSeed, inBytes, 0, inBytes.Length);

            Console.WriteLine("CRC-32 is {0}", ret_uint); //1997126336

            Console.ReadKey();

        }

        public static UInt32 CalculateHash(UInt32[] table, UInt32 seed, byte[] buffer, int start, int size)
        {
            UInt32 crc = seed;
            for (int i = start; i < size; i++)
                unchecked
                {
                    crc = (crc >> 8) ^ table[buffer[i] ^ crc & 0xff];
                }
            return crc;
        }
    }
} 
```

# javascript - 使用 JavaScript 更改 Dojo 内容窗格属性

> ID：12876440
> 
> 赞同：0
> 
> 时间：2012-10-13T19:54:07.883
> 
> 标签：javascript, dojo, contentpane

我有一个 Dojo (1.8) 内容[窗格](http://dojotoolkit.org/reference-guide/1.8/dijit/layout/ContentPane.html)：

```
<div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="splitter:false, region:'leading', href:'page2.php?name=variableName'" style="width: 100%; height: 100%;" id="embeddedPg"> <!-- Embedded content shown here --> </div> 
```

我正在尝试`href`更改`data-dojo-props`. 我写了一个JavaScript函数如下：

```
function loadInfo(tableName){           
        var dojowidget = document.getElementById("embeddedPg");
        dojowidget.setAttribute("data-dojo-props","href:page2.php?name="+tableName);
    } 
```

当用户单击页面上的特定链接时调用此函数，并被适当地调用。
它没有给我任何 JavaScript 错误，但它也不起作用。这样做的正确方法是什么？我正在使用 Dojo 1.8。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T05:58:57.787

`document.getElementById`不返回 dojo 小部件。它只是返回 DOM 对象。

要访问 dojo 小部件，您应该使用`dijit/registry.byId`. 您可以通过更改 href 属性，`ContentPane's attr(name,value)`并且应该调用`refresh()`以显示它。

```
require(["dijit/layout/ContentPane", "dijit/registry",  "dojo/domReady!"]
  ,function(ContentPane, registry) {

    var refreshPage = function(tableName) {
        var cPane = registry.byId("embeddedPg");
        cPane.attr("href", "page2.php?name="+tableName);
        cPane.refresh();
    }
}); 
```

# c# - 遍历站点相对路径以查找文件 (ASP.NET MVC 3)

> ID：12876442
> 
> 赞同：3
> 
> 时间：2012-10-13T19:54:15.263
> 
> 标签：c#, .net, asp.net-mvc-3, web-applications

我的 Web 应用程序（ASP.NET MVC 3）中有一个文件夹，其中包含一组图像。我想使用 foreach 循环遍历文件夹以获取站点相对路径，然后我可以将其附加到图像标签。

例子

```
<div class="slides">
@foreach(string file in ?????)
{
    <img src="@file" alt="filename without extension">
}
</div> 
```

我该怎么做呢？

注意：我当前的 foreach 循环正在尝试查看物理路径并返回此错误

```
Could not find a part of the path 'C:\Content\Images\Photography\Slides\'. 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-13T20:25:13.513

假设您想枚举相对于网站根目录的路径中的文件，您可以这样做：

```
@foreach (var file in 
    Directory.GetFiles(Server.MapPath("~/Content/Images/Photography/Slides"))) 
```

# ruby-on-rails - 如何在 devise_invitable 中覆盖 destroy_if_previously_invited？

> ID：12876445
> 
> 赞同：0
> 
> 时间：2012-10-13T19:54:27.263
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我在我的 Rails 3 应用程序中使用`devise_invitable`with 。`devise`我想让我的用户能够在受邀者注册之前邀请其他用户并将这些受邀用户分组。

我的问题是，一旦受邀者出现并注册（但不使用邀请 URL），`destroy_if_previously_invited`around_filter 就会出现，破坏原始用户记录并为用户重新创建新记录，保留邀请数据但不传输user_groups 记录随之而来。

我想通过搜索与最初邀请的 user_id 匹配的任何 user_groups 并使用新创建的 user_id 保存它们来简单地覆盖此 around_filter。

我不断收到错误：

```
LocalJumpError in Users::RegistrationsController#create

no block given (yield) 
```

我的路线如下所示：

```
devise_for :users, :controllers => { :registrations => "users/registrations" } 
```

我已在 app/controllers/users/registrations_controller.rb 中将此设置为覆盖：

```
class Users::RegistrationsController < Devise::RegistrationsController

  around_filter :destroy_if_previously_invited, :only => :create

  private    

  def destroy_if_previously_invited
    invitation_info = {}

    user_hash = params[:user]
    if user_hash && user_hash[:email]
      @user = User.find_by_email_and_encrypted_password(user_hash[:email], '')
      if @user
        invitation_info[:invitation_sent_at] = @user[:invitation_sent_at]
        invitation_info[:invited_by_id] = @user[:invited_by_id]
        invitation_info[:invited_by_type] = @user[:invited_by_type]
        invitation_info[:user_id] = @user[:id]
        @user.destroy
      end
    end

    # execute the action (create)
    yield
    # Note that the after_filter is executed at THIS position !

    # Restore info about the last invitation (for later reference)
    # Reset the invitation_info only, if invited_by_id is still nil at this stage:
    @user = User.find_by_email_and_invited_by_id(user_hash[:email], nil)
    if @user
      @user[:invitation_sent_at] = invitation_info[:invitation_sent_at]
      @user[:invited_by_id] = invitation_info[:invited_by_id]
      @user[:invited_by_type] = invitation_info[:invited_by_type]
      user_groups = UserGroup.find_all_by_user_id(invitation_info[:user_id])
      for user_group in user_groups do
        user_group.user_id = @user.id
        user_group.save!
      end
      @user.save!
    end
  end
end 
```

我也可能只是把这一切都错了。任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T01:21:38.413

首先，不需要再次设置 around_filter，因为 devise_invitable 已经设置了它。您需要做的就是重新定义 UsersController 中的方法，这些方法将被调用，而不是 devise_invitable 方法。

其次，当这两种方法应该保持独立和被覆盖时，您似乎正在组合它们（我基于最新版本的 devise_invitatable 1.1.1）

尝试这样的事情：

```
class Users::RegistrationsController < Devise::RegistrationsController
  protected

  def destroy_if_previously_invited
    hash = params[resource_name]
    if hash && hash[:email]
      resource = resource_class.where(:email => hash[:email], :encrypted_password => '').first
      if resource
        @old_id = resource.id #saving the old id for use in reset_invitation_info
        @invitation_info = Hash[resource.invitation_fields.map {|field|
          [field, resource.send(field)]
        }]
        resource.destroy
      end
    end
  end

  def reset_invitation_info
    # Restore info about the last invitation (for later reference)
    # Reset the invitation_info only, if invited_by_id is still nil at this stage:
    resource = resource_class.where(:email => params[resource_name][:email], :invited_by_id => nil).first
    if resource && @invitation_info
      resource.invitation_fields.each do |field|
        resource.send("#{field}=", @invitation_info[field])
      end
      ### Adding your code here
      if @old_id
        user_groups = UserGroup.find_all_by_user_id(@old_id)
        for user_group in user_groups do
          user_group.user_id = resource.id
          user_group.save!
        end
      end
      ### End of your code
      resource.save!
    end
  end 
```

# java - JDialog - 刷新 JTree 中动态添加的节点

> ID：12876449
> 
> 赞同：5
> 
> 时间：2012-10-13T19:55:31.550
> 
> 标签：java, swing, jtree, jdialog, treemodel

我用于 JDialog 的 JTree 节点可见性存在问题。当我想向模型添加新节点时，Jtree 不会刷新。

奇怪的是，如果我设置 setRootVisible(true)，节点正在更新。

这是代码。提前致谢

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.JDialog;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTree;
import javax.swing.tree.DefaultMutableTreeNode;
import javax.swing.tree.DefaultTreeModel;

public class TestClass {

JTree tree;
DefaultTreeModel dm;
JDialog dialog;

public TestClass(){
    JFrame frame = new JFrame("title");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true);

    JPanel showPane = new JPanel();
    showPane.setLayout(new BorderLayout()); 

    dm = new DefaultTreeModel(new DefaultMutableTreeNode("root"));
    tree = new JTree(dm);
    tree.setRootVisible(false);

    JButton button = new JButton("add node");
    button.addActionListener(new ActionListener(){

        public void actionPerformed(ActionEvent arg0) {
            DefaultMutableTreeNode root = (DefaultMutableTreeNode) tree.getModel().getRoot();           
            dm.insertNodeInto(new DefaultMutableTreeNode("Node " + (root.getChildCount() + 1)), root, root.getChildCount());

            int c = root.getChildCount();
            System.out.println("child count: " + c);

            for(int i=0; i<c; i++){
                DefaultMutableTreeNode node = (DefaultMutableTreeNode) root.getChildAt(i);
                System.out.println("has node:" + node.getUserObject().toString());
            }
        }

    });

    showPane.add(tree, BorderLayout.CENTER);
    showPane.add(button, BorderLayout.PAGE_END);

    JComponent[] inputComponents = new JComponent[] {showPane};

    Object[] opButtons = {"OK"};

    JOptionPane optPane = new JOptionPane(inputComponents       
            , JOptionPane.PLAIN_MESSAGE             
            , JOptionPane.CLOSED_OPTION             
            , null                                      
            , opButtons                             
            , opButtons[0]);                            

    optPane.setPreferredSize(new Dimension(400 ,250));

    dialog = optPane.createDialog(null, "Create new Application Node");
    dialog.setLocationRelativeTo(frame);
    dialog.setVisible(true);

    if(optPane.getValue() != null){
        System.exit(0);
    }

}

public static void main(String arg[]){
    TestClass myClass = new TestClass();
} 
```

}

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-13T20:13:06.627

每次添加新的子节点时，请确保扩展从新节点的父节点到根节点的路径：

```
DefaultMutableTreeNode newChild = new DefaultMutableTreeNode("Node " + (root.getChildCount() + 1));
dm.insertNodeInto(newChild, root, root.getChildCount());
tree.expandPath(new TreePath(dm.getPathToRoot(newChild.getParent()))); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-13T21:01:46.907

Please also check another solution:

```
 DefaultTreeModel model = (DefaultTreeModel) (tree.getModel()); 
   model.reload(); 
```

[API](http://docs.oracle.com/javase/7/docs/api/javax/swing/tree/DefaultTreeModel.html#reload%28%29) says:

> invoke reload method if you've modified the TreeNodes upon which this model depends. The model will notify all of its listeners that the model has changed.

For a quick verification try the following:

```
public void actionPerformed(ActionEvent arg0) {
   DefaultMutableTreeNode root = (DefaultMutableTreeNode) tree.getModel().getRoot();
   dm.insertNodeInto(new DefaultMutableTreeNode("Node " + (root.getChildCount() + 1)), root, root.getChildCount());

   int c = root.getChildCount();
   System.out.println("child count: " + c);

   DefaultTreeModel model = (DefaultTreeModel) (tree.getModel()); // !!!
   model.reload();   // !!!

   for (int i = 0; i < c; i++) {
       DefaultMutableTreeNode node = (DefaultMutableTreeNode) root.getChildAt(i);
       System.out.println("has node:" + node.getUserObject().toString());
   }
} 
```

Please see the following answer for more details:

*   [Jtree not shown on adding a node!](https://stackoverflow.com/questions/6274782/jtree-not-shown-on-adding-a-node)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-17T16:12:18.507

@JBNizet 的答案是正确的，总结一下：

*   插入节点不会自动影响父节点的展开状态
*   所以为了确保新插入的孩子是可见的，它的父母必须展开

加入一些替代 api 以使孩子可见：

```
dm.makeVisible(new TreePath(newChild.getPath()); 
```

关于@Geoff Reedy 的评论（由我加粗）：

> JTree 的根节点通常是展开的，但是当树创建时，根节点没有任何子节点，因此*无法展开*

**cannot**没有那么严格：它是否可以扩展（即使有零个孩子）实际上取决于模型的 isLeaf 的实现。可以说，根永远不会是叶子（即使没有孩子），因为它的本质是不是 :-) 可以通过以下方式实现

```
final DefaultTreeModel model = new DefaultTreeModel(root) {

    @Override
    public boolean isLeaf(Object node) {
        if (isRoot(node)) {
            return false;
        }
        return super.isLeaf(node);
    }

    private boolean isRoot(Object node) {
        return node != null && node == getRoot();
    }

}; 
```

通过这样的实现，根总是被扩展（根可见或不可见）并且新插入的直接子将显示而不使它们显式可见。

# javascript - 使用 iPhone/iPod touch 浏览我的网站时，单击菜单栏项目会导致它们“抽搐”。为什么？

> ID：12876452
> 
> 赞同：2
> 
> 时间：2012-10-13T19:55:40.500
> 
> 标签：javascript, jquery, html, css

我不知道为什么会这样。这个问题在我测试过的 Android 设备上没有出现，但在 iPhone 或 iPod touch 上，点击菜单栏会导致它以各种尺寸进出。

[http://christianselig.com](http://christianselig.com)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:02:20.350

您在`.menu-bar`元素上设置了过渡。我怀疑正在发生的事情是浏览器正在调整它的大小，并且正在过渡到新的大小，而不是简单地捕捉。

只需替换您的过渡：

```
transition: 0.6 ease 
```

使用一个范围您要转换的属性：

```
transition: box-shadow 0.6 ease 
```

那*应该可以*解决它，但是我很难测试，因为问题发生在页面加载时。

编辑：我在正确的轨道上，错误的位置。确定锚点上的过渡就可以了。例如，请参阅[http://coffeepowered.net/projects/Christian%20Selig.htm](http://coffeepowered.net/projects/Christian%20Selig.htm)。

```
.menu-bar a {
    color: #555;
    padding: 5px 8px 7px 8px;
    text-decoration: none;
    -webkit-transition: -webkit-box-shadow 0.1s ease;
    transition: box-shadow 0.1s ease;
} 
```

# php - 从 CakePHP 发送推送

> ID：12876454
> 
> 赞同：1
> 
> 时间：2012-10-13T19:56:33.550
> 
> 标签：php, cakephp, urbanairship.com

我需要从 Urban Airship 发送一条推送消息。为此，我必须从 CakePHP 发送一个 API 请求。
我的问题：我应该把 API 请求的代码放在 CakePHP 的什么地方？在模型中还是在控制器中？这个正确的地方在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-13T20:59:42.247

我遵循[Neil Crookes](http://tv.cakephp.org/video/CakeFoundation/2010/12/24/neil_crookes_-_designing_cakephp_plugins_for_consuming_apis/playlist:4d14370c-0610-4e56-a6f2-57a282f0cb67)将逻辑保留在数据源中的想法。毕竟，API 实际上只是一个数据源。然后，模型作为 API 具有的各种端点被引入。例如，我有一个遵循此模型的[Stripe 插件。](https://github.com/jeremyharris/stripe)然后，StripeCustomer 模型具有`$path`数据源用作端点的变量。

这种模式有几个好处：

1.  API 调用与 ORM 集成 - 因此它们看起来像常规模型查找和保存
2.  您可以利用内置的验证、回调、行为等。
3.  非常干燥，因此易于调试和测试

# c++ - 为什么我不能初始化静态成员

> ID：12876464
> 
> 赞同：0
> 
> 时间：2012-10-13T19:57:50.670
> 
> 标签：c++, android-ndk, static-members

我有一个`MotionDirection`带有静态成员的类。该类的源代码如下。但我就是无法初始化类的静态成员，我可以得到原因。所以问题出在 中`MotionDirection.cpp`，有关编译器错误的详细信息，请参阅注释。

运动方向.h

```
#ifndef MOTION_DIRECTION
#define MOTION_DIRECTION

namespace game{
    class IntPosition;

    class MotionDirection {
        private:
        IntPosition* positionDisplacement;
        float angle;
        MotionDirection* returnDirection;

        public:
        MotionDirection( IntPosition* positionDisplacement, float angle );
        void setReturnDirection ( MotionDirection* returnDirection );

        IntPosition* getPositionDisplacement();
        float getAngle();
        MotionDirection* getReturnDirection();

        static MotionDirection* NONE;
        static MotionDirection* LEFT;
        static MotionDirection* RIGHT;
        static MotionDirection* UP;
        static MotionDirection* DOWN;

        static void initStatics();
    };
}

#endif 
```

运动方向.cpp

```
#include "MotionDirection.h"
#include "IntPosition.h"

namespace game{
    MotionDirection::NONE = new MotionDirection ( new IntPosition( 0, 0),   0.0f );
    // here I get an error:
    // MotionDirection.cpp:10:5: error: 'NONE' in 'class game::MotionDirection' does not name a type

    MotionDirection::MotionDirection( IntPosition* positionDisplacement, float angle ) {
        this->positionDisplacement = positionDisplacement;
        this->angle = angle;
    }

    void MotionDirection::setReturnDirection ( MotionDirection* returnDirection ) {
        this->returnDirection = returnDirection;
    }

    IntPosition* MotionDirection::getPositionDisplacement() {
        return positionDisplacement;
    }

    float MotionDirection::getAngle() {
        return angle;
    }

    MotionDirection* MotionDirection::getReturnDirection() {
        return returnDirection;
    }

    void MotionDirection::initStatics () {
        MotionDirection::NONE  = new MotionDirection ( new IntPosition( 0, 0),   0.0f );
        MotionDirection::LEFT  = new MotionDirection ( new IntPosition(-1, 0), 180.0f );
        MotionDirection::RIGHT = new MotionDirection ( new IntPosition( 1, 0),   0.0f );
        MotionDirection::UP    = new MotionDirection ( new IntPosition( 0,-1),  90.0f );
        MotionDirection::DOWN  = new MotionDirection ( new IntPosition( 0, 1), 270.0f );
    }

    MotionDirection::initStatics();
    // or here I get an error:
    // MotionDirection.cpp:45:35: error: expected constructor, destructor, or type conversion before ';' token

} 
```

PS 这是 Android-NDK 项目，我从 cygwin 控制台运行编译。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T20:00:53.537

### 第一个错误

只需更换

```
MotionDirection::NONE = new MotionDirection ( new IntPosition( 0, 0),   0.0f ); 
```

和

```
MotionDirection* MotionDirection::NONE = new MotionDirection ( new IntPosition( 0, 0),   0.0f ); 
```

注意`MotionDirection*`变量名称前的类型：您需要为编译器提供类型。

### 第二个错误

您不能将表达式放在功能块之外。有两种方法可以做到这一点“正确”：

1.

*   做`initStatics()`返回值。
*   添加私有静态变量。
*   通过为其赋值`initStatics()`来初始化新的静态变量。

2.

*   添加嵌套类。
*   `initStatics()`在其构造函数中写入调用。
*   添加该嵌套类的私有静态变量。

# c++ - 未定义的引用错误在其他文件中起作用

> ID：12876466
> 
> 赞同：0
> 
> 时间：2012-10-13T19:58:03.970
> 
> 标签：c++, class, include, codeblocks

我有一个游戏程序，我感到非常沮丧。一切运行良好，我决定通过为每组函数创建单独的文件来清理我的程序。代码很长，包含多个文件，但基本思想如下：

我在 Windows XP 上使用 Code::Blocks IDE

在我的`entity.h`Ive 中，我为该类声明了所有函数和变量。在我的`entity.cpp`Ive 中，以及在我的所有其他文件中。但是我仍然收到大量错误，这些错误告诉我，我对 entity.h 中的所有方法以及所有其他头文件都有未定义的引用。例如，我有一个函数调用`print()`可以更轻松地打印出来，这就是我从`entity.h`文件中调用的第一个方法。我收到此错误：

下面是 print() 的代码：

```
void print(string f) {
 cout<<f<<endl;
} 
```

我怎么称呼它：

```
void Player::win(){
entity e;
e.print("You have defeated the orc"); 
```

} 错误：

> 在函数“ZN6Player3winEv”中：未定义对“entity::print(std::string)”的引用

是的，我确实有一个`object`of `entity`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T20:06:42.563

`Undefined reference`错误发生在链接时（而不是编译时）。您的代码似乎编译正确，因此您的标头可能是正确的。但是您并没有将所有内容链接在一起以生成可执行文件。您没有提到平台、编译器或构建系统，所以我无法确切告诉您如何修复它，但通常编译器会`*.o`为每个文件生成一个`*.cpp`文件（即编译），然后将`*.o`文件链接到创建一个可执行文件。您需要确保所有`*.o`文件都链接在一起（另外，您可能没有将其中一个文件编译`*.cpp`成`*.o`文件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T20:04:32.533

快速猜测一下，您没有将`entity.o`文件链接到二进制文件。

如果您使用的是 linux g++，那么类似：

```
g++ -o binary entity.cpp game.cpp 
```

应该编译并将 cpp 文件链接到二进制文件。

要`Code::Blocks`选择特定构建组中的文件，您需要右键单击目标应用程序并选择`properties`. 这将弹出`Project/target options`. 转到`Build Targets`选项卡。页面的右下角是一个列表`Build target files`。您需要确保所有对可执行文件有贡献的文件都被选为构建目标的一部分。这意味着您需要对 entity.cpp 文件进行复选框。这可以确保包含代码的文件`entity::print`被编译并链接到目标可执行文件中。请注意，该`Build target files`选项卡适用于`build target`左侧列表中的选定项。您将需要确保检查该文件的所有`build targets`内容。

通常，当您在 Code::Blocks 中添加文件时，并且在您看到应该添加文件的目标的复选框的位置，您应该确保选中新文件所属的所有目标。向导的默认设置是不选中所有复选框。在您的情况下，因为它是一个简单的项目，您应该确保检查每个目标（通常它会以调试和发布作为两个目标开始）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2022-02-07T11:10:34.340

我有同样的问题。对我来说，解决方案是：当您在项目中添加文件时，不要忘记单击“添加到调试”和“添加到发布”，文件将在项目树中是的，但是您将出现错误“未定义”参考”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-07T11:17:15.447

**问题**是您最初定义的是一个名为的**自由函数**`print`，而不是一个名为class的**成员函数**。您需要在类的**范围内**将其定义为**成员函数**，这就是我在下面使用**范围解析运算符**所做的。`print``entity`**`entity` ****`::`******

 ******```
/////vvvvvvvv
void entity::print(string f) {  //note the scope resolution operator:: used here
 cout<<f<<endl;
} 
```******

# python - 使用 for 循环获取两个列表的输出

> ID：12876467
> 
> 赞同：3
> 
> 时间：2012-10-13T19:58:04.377
> 
> 标签：python, comparison

如果你们能帮助我解决这个问题，我将不胜感激。

在我的 python 代码中，我使用 open(file, r) 函数打开了两个文件。

现在我想要的是，读取这两个文件的所有行并比较这些数据中的两列是否匹配。

我已经为文件中的每一行尝试了一个嵌套的 for 循环

```
for line in file:
  for lines in file:
     file1 = split(line)
     file2 = split(lines)
     process matching query 
```

但是，它似乎不起作用。你们能指出我如何实现这一目标的正确方向吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T20:03:33.110

[使用zip](http://docs.python.org/library/functions.html#zip)同时遍历这些文件：

```
for line1,line2 in zip(file1,file2): 
```

并用线条完成所有逻辑。

Python 3.x`zip`是一个迭代器，而在 Python 2.x 中，您可以使用[`izip`](http://docs.python.org/library/itertools.html#itertools.izip)相同的功能。`zip`在 Python 2.x 中使用。将导致将所有文件内容读入内存，而迭代器版本将逐行推进。

# lex - 使用 JFlex 删除注释，但保留行终止符

> ID：12876469
> 
> 赞同：1
> 
> 时间：2012-10-13T19:58:37.050
> 
> 标签：lex, flex-lexer, lexer, jflex

我正在为 JFlex 编写词汇规范（它类似于 flex，但用于 Java）。我对 TraditionalComment ( `/* */`) 和 DocumentationComment ( `/** */`) 有疑问。到目前为止，我有这个，取自[JFlex 用户手册](http://jflex.de/manual.html)：

```
LineTerminator = \r|\n|\r\n
InputCharacter = [^\r\n]
WhiteSpace     = {LineTerminator} | [ \t\f]

/* comments */
Comment = {TraditionalComment} | {EndOfLineComment} | {DocumentationComment}

TraditionalComment   = "/*" [^*] ~"*/" | "/*" "*"+ "/"
EndOfLineComment     = "//" {InputCharacter}* {LineTerminator}
DocumentationComment = "/**" {CommentContent} "*"+ "/"
CommentContent       = ( [^*] | \*+ [^/*] )*

{Comment}           { /* Ignore comments */ }
{LineTerminator}    { return LexerToken.PASS; } 
```

`LexerToken.PASS`意味着稍后我将在输出上传递行终止符。现在，我想做的是：

忽略注释中的所有内容，**除了新行终止符**。

例如，考虑这样的输入：

```
/* Some
 * quite long comment. */ 
```

事实上它是`/* Some\n * quite long comment. */\n`。使用当前的词法分析器，它将被转换为单行。输出将是单个 '\n'。但我想要两行，'\n\n'。一般来说，我希望我的输出始终具有与输入相同的行数。怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T09:41:54.843

几天后，我找到了解决方案。我会把它贴在这里，也许有人会遇到同样的问题。

诀窍是，在识别出您在评论中之后 - 再次浏览其正文，如果您发现新的行终止符 - 传递它们，而不是忽略：

```
%{
public StringBuilder newLines;
%}

// ...

{Comment}           { 
                        char[] ch; 
                        ch = yytext().toCharArray(); 
                        newLines = new StringBuilder();
                        for (char c : ch)
                        {
                            if (c == '\n')
                            {
                                newLines.append(c);
                            }
                        } 
                        return LexerToken.NEW_LINES;
                    } 
```

# java - Switch 声明调查

> ID：12876471
> 
> 赞同：2
> 
> 时间：2012-10-13T19:58:52.410
> 
> 标签：java

我在这个版本中遇到了一些问题。首先它不会加载主类。其次，我需要用户输入他们选择的音乐，然后我需要编译器来打印选择。有人可以帮我处理这段代码吗？请原谅我，但我对编程完全陌生。

```
public class music {

public static void music(String[] args) {

    System.out.println("What's your favorite kind music?: ");
    System.out.println("1\. Country");
    System.out.println("2\. Rock");
    System.out.println("3\. Heavy Metal");
    System.out.println("4\. Folk");

    try{
    BufferedReader bufferRead = new BufferedReader(new InputStreamReader(System.in));
    int s = Integer.parseInt(bufferRead.readLine());
        switch(s){
            case 1:
                System.out.println("Country");
                break;
            case 2:
                System.out.println("Rock");
                break;
            case 3:
                System.out.println("Heavy Metal");
                break;
            case 4:
                System.out.println("Folk");
                break;
            default:
                System.out.println("Country");
                break;
      }

}catch(IOException e){
        e.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T20:00:44.093

```
public static void music(String[] args) 
```

这看起来不像主要方法。你应该使用`main`代替`music`： -

```
public static void main(String[] args) 
```

此外，`compilation`包含此类的单元应与该类的名称相同。最好将您的班级名称用作： -`Music`并将其另存为`Music.java`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-13T20:00:57.523

您的方法必须命名为`main`. 查看[本教程](http://docs.oracle.com/javase/tutorial/getStarted/application/index.html#MAIN)。

代替：

```
public static void music(String[] args) { 
```

尝试：

```
public static void main(String[] args) { 
```

`public static void music(String[] args)`定义了一个与类同名的静态方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-13T20:01:06.107

你的代码看起来不错，但只有你不能重命名主方法，`main()`方法签名必须是`public static void main(String[] args)`，你的代码应该像

```
public class Music{
    public static void main(String[] args) {
     ...
    }
} 
```

*注意*-*主要方法签名是恒定的，并在下面找到意义。*

**public** - public 每个人都可以访问它。

**static** - Java 环境应该能够在不创建类实例的情况下调用此方法，因此此方法必须声明为静态。

**void** - 返回 void 所以没有返回值。

**main( )** - 方法的名称，main 因为它是主要方法。

**String args[]** - 此方法的参数。必须给这个方法一个字符串数组，这个数组将被称为“args”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-13T20:01:28.647

函数名不能是`main()`music()

```
public class music {

public static void main(String[] args) {

    System.out.println("What's your favorite kind music?: ");
    System.out.println("1\. Country");
    System.out.println("2\. Rock");
    System.out.println("3\. Heavy Metal");
    System.out.println("4\. Folk");

    try{
    BufferedReader bufferRead = new BufferedReader(new InputStreamReader(System.in));
    int s = Integer.parseInt(bufferRead.readLine());
        switch(s){
            case 1:
                System.out.println("Country");
                break;
            case 2:
                System.out.println("Rock");
                break;
            case 3:
                System.out.println("Heavy Metal");
                break;
            case 4:
                System.out.println("Folk");
                break;
            default:
                System.out.println("Country");
                break;
      }

}catch(IOException e){
        e.printStackTrace();
    }
}
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-13T20:07:08.593

**解决方案**

发布的源代码的问题是您没有类的[入口点](http://docs.oracle.com/javase/tutorial/deployment/jar/appman.html "入口点")（即名为 的方法`main`）。

**建议**

由于您提到您也是编程新手，因此我冒昧地提出了一些风格建议，以使您的代码更简单，更易于阅读（IMO）：

```
import static java.lang.System.in;
import static java.lang.System.out;

import java.util.LinkedHashMap;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Scanner;

public class Music {

    private static final String DEFAULT_MUSIC = "Country";

    public static void main(String[] args) {
        Map<Integer, String> musicOptions = new LinkedHashMap<Integer, String>();
        musicOptions.put(1, DEFAULT_MUSIC);
        musicOptions.put(2, "Rock");
        musicOptions.put(3, "Heavy Metal");
        musicOptions.put(4, "Folk");

        out.println("What's your favorite kind music?: ");
        for (Entry<Integer, String> option : musicOptions.entrySet()) {
            Integer choice = option.getKey();
            String music = option.getValue();

            out.printf("%d. %s\n", choice, music);
        }

        final int choice = new Scanner(in).nextInt();
        String music = musicOptions.get(choice);
        if (music == null) {
            music = DEFAULT_MUSIC;
        }

        out.println(music);
    }

} 
```

**延伸阅读**

[http://docs.oracle.com/javase/1.5.0/docs/guide/language/static-import.html](http://docs.oracle.com/javase/1.5.0/docs/guide/language/static-import.html "静态导入") [http://docs.oracle.com/javase/7/docs/api/java/util/Scanner .html#nextInt()](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html "扫描器") [http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op2.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op2.html "三元运算符")

# ruby-on-rails - 资源未按预期工作的 Rails 子域路由

> ID：12876472
> 
> 赞同：2
> 
> 时间：2012-10-13T19:58:54.780
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes, ruby-on-rails-3.2, subdomain

在标准博客应用程序中，我已将此路线添加到现有路线中：

```
match '', to: 'blogs#show', constraints: { subdomain: /.+/ } 
```

这些是/是我已经存在的路线：

```
resources :blogs do
  member { get :settings }
  member { get :stats }
  member { match ':year/:month/:day/:article_id', to: 'blogs#show_article', :constraints => { year: /\d{4}/, month: /\d{2}/, day: /\d{2}/ } }
end 
```

在我的控制器中，我执行@blog = Blog.find(request.subdomain)，为了简单起见，我使用了id。稍后我会使用 blogs slug 或额外的域属性。

[就http://17.lvh.me:3000](http://17.lvh.me:3000)将显示博客 17而言，这很好用。但是我的成员操作没有按预期路由。在博客子域上，我希望[http://8.lvh.me:3000/settings](http://8.lvh.me:3000/settings)，但只有[http://17.lvh.me:3000/blogs/17/settings](http://17.lvh.me:3000/blogs/17/settings)有效。

那么我如何告诉我的博客资源成员操作它们应该在子域下路由而没有额外的冗余 /blogs/:id？我真的需要手动完成这一切吗？我觉得我错过了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T23:23:23.143

试试这个：

```
scope '/' do
 with_options :conditions => {:subdomain => /.+/}, :controller => :blogs do |site|
  site.match '', :action => :show
  site.get '/settings', :action => :settings
  site.get '/stats', :action => :stats
  site.match ':year/:month/:day/:article_id', to: 'blogs#show_article', :constraints => { year: /\d{4}/, month: /\d{2}/, day: /\d{2}/ }  
 end
end 
```

您必须`Blog.find(request.subdomain)`在控制器中的每个操作中都有。

PS 我知道这是[在 Rails 中使用子域的一个很好的理论练习](http://asciicasts.com/episodes/221-subdomains-in-rails-3)，但我个人更喜欢[干净的 URL](http://en.wikipedia.org/wiki/Clean_URL)。

# git - 在部署期间将 git 修订号插入文件

> ID：12876479
> 
> 赞同：14
> 
> 时间：2012-10-13T19:59:20.663
> 
> 标签：git, fabric

我在做什么我认为应该相当简单，但我似乎无法弄清楚如何让它工作。

我想在 html 和 javascript 文件中嵌入一个唯一的版本号，原因有两个。第一个原因是我想确保在加载 javascript 文件时，如果有新版本，系统不会尝试使用缓存，但如果我可以使用类似的方法调用它

```
 <script src="/app.js?v1.0.1-1-95425234"></script> 
```

我几乎可以肯定地确保这永远不会发生。第二个原因是我的远程错误日志记录，最好知道系统的哪个版本有错误，以便我可以考虑适当地修复它，但不必在每次部署时手动更新此版本号。

一路上遇到`git describe`了，我觉得它的输出值真的很适合这个。

基本上我想在我的 javascript 和 html 文件中取一个键，`GIT-CURRENT-VERSION`并将其替换为`git describe`

我在我的部署方法中使用了fabric，所以在我们获取了最新版本的git之后，在服务器端这样做会很有意义。

我怀疑`sed`and`grep`的某种组合在这里可以解决问题，如果我能为此找出一个衬里，那么添加到我的部署脚本中将非常容易。

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-13T22:28:03.207

我从来没有听说过`fabric`，但如果面料使用（或调用）`git archive`，那么你可以使用`gitattributes`. 也就是说，您可以让您的 HTML 文件包含以下内容：

```
<script src="/app.js?$Format:%H$"></script> 
```

在`.gitattributes`存储库的顶部：

```
*.html    export-subst 
```

然后，每当您使用 , 创建存档时`git-archive`，`$Format:%H$`都会被提交的哈希替换。您可以使用`--pretty-format`in中可用的任何内容`git-log`。

查看手册`gitattributes`，或者更好：*[Pro Git](http://git-scm.com/book)*书的*“ [8.2 自定义 Git - Git 属性](http://git-scm.com/book/en/v2/Customizing-Git-Git-Attributes)”*一章以获得更多想法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-13T20:40:33.053

您可以从部署的 git 树的根目录执行以下操作：

```
export VERSION="$(git describe)"
find . -type f -print0 | xargs -0 sed -i "s/GIT-CURRENT-VERSION/$VERSION/g" 
```

（这只是粗略的测试——谨慎使用。）

请注意，这将使您的树进行本地修改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T03:46:08.150

沿着 guettli 的评论，我想我发布了我的最终结果。这是我的解决方案，基于上述 Mark Longair 的解决方案。

```
export DESCRIPTION="$(git describe)"
find [PATH] -regextype posix-extended -regex ".*\.(js|html)" -type f -print0 | xargs -0 sed -i "s/CURRENT-GIT-DESCRIPTION/$DESCRIPTION/g" 
```

我会稍微解释一下我在这里做什么。

`export DESCRIPTION="$(git describe)"`获取 git 存储库当前状态的当前描述。有关更多信息，请查看[git describe 手册页](http://www.kernel.org/pub/software/scm/git/docs/git-describe.html)。

接下来，`find [PATH] -regextype posix-extended -regex ".*\.(js|html)" -type f -print0`您可以将 替换`[PATH]`为存储库的路径。`-regextype posix-extended -regex ".*\.(js|html)"`遍历您的目录并找到与 . 定义的正则表达式匹配的所有文件`".*\.(js|html)"`。就我而言，我知道我只希望替换发生在 javascript 或 html 文件中。最后`xargs -0 sed -i "s/CURRENT-GIT-DESCRIPTION/$DESCRIPTION/g"`告诉系统`CURRENT-GIT-DESCRIPTION`用上面定义的值替换`git describe`。

在我的情况下，这很好用，因为我使用[结构](http://docs.fabfile.org/en/1.4.3/)部署到服务器，并且因为我希望更改实时发生，所以我所做的是更新存储库，然后将其复制到新的部署中系统。一旦系统准备就绪，我会删除 git 数据文件，将其保留为常规数据结构。现在我可以告诉系统使用新版本，一切准备就绪。

希望能帮助其他希望实现类似目标的人！

# sql - PostgreSql：如何编写那个 sql 查询？（模式定义）

> ID：12876482
> 
> 赞同：-1
> 
> 时间：2012-10-13T19:59:39.787
> 
> 标签：sql, postgresql

```
从测试中选择*；
 一个 | b
---+---
 1 | 5
 4 | 1
 2 | 5
 3 | 3
 1 | 1
(5 行)

```

我如何编写这样的查询，所以“a”列中的所有输出值都是不同的，“b”列中的所有输出值也是不同的。

因此，例如，上述查询的有效结果集是：

```
1 | 5
 4 | 1
 3 | 3

```

下一个也是有效的：

```
4 | 1
 2 | 5
 3 | 3

```

最好找到尽可能多的结果，但这不是必需的。
最好的方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:22:46.697

自己找到解决方案！:)

a) 将 id 列添加到“test”表
b) sql 查询：

```
和
    t1 AS (SELECT a, MIN(id) as id FROM test GROUP BY a),
    t2 AS (SELECT b, MIN(id) as id FROM test GROUP BY b)
    从测试中选择 *
    id 在哪里（从 t1 选择 id）和 id 在（从 t2 选择 id）；

```

结果：

```
编号 | 一个 | b
----+---+---
  6 | 1 | 5
  7 | 4 | 1
  9 | 3 | 3

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T20:30:30.860

~~我认为这也应该给你正确的输出： SELECT a, MIN(b) as b FROM test GROUP BY a Intersect SELECT min(a) as a, b FROM test GROUP BY b;~~

编辑：试试这个：

```
Select MIN(t1.a), t1.b from (SELECT a, MIN(b) as b FROM test GROUP BY a) t1 GROUP BY t1.b 
```

# python - 在 Python 中定义浮点数的精度

> ID：12876483
> 
> 赞同：0
> 
> 时间：2012-10-13T19:59:47.410
> 
> 标签：python, numpy, floating-point, precision

我这里有一些python代码

代码：

```
 t = 1
 xt = array([ -1.,-1\. ])

 xt[0] = theta[0][0]* P_all_States[t-1][0] + theta[1][0]*P_all_States[t-1][1]

 xt[1] = theta[0][1]* P_all_States[t-1][0] + theta[1][1]*P_all_States[t-1][1]

 P_all_States[t][0] = xt[0]
 P_all_States[t][1] = xt[1]
 print ("Added probability distribution for time t = " + str(t) + " to P_all_States")
 print P_all_States 
```

输出：

> > 将时间 t = 1 的概率分布添加到 P_all_States [[0.6, 0.4], [0.62000000000000011, 0.38000000000000006], [-1.0, -1.0], [-1.0, -1.0], [-1.0, -1.0], [-1.0 , -1.0]]

如何让浮点数四舍五入到 2 位有效数字？

这些都是浮点数，所以我不想将它们转换为字符串，我希望它们保持为浮点数

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T20:09:14.373

我不确定您的意思，但如果您的意思是如何将它们的值修改为 0.62 等：由于它们的性质，这对于浮点数是不可能的。您可以使用小数而不是浮点数来解决此问题。如果您的意思是如何打印只有 2 位小数的浮点数，请使用：

```
print '{:3.2f}'.format(somefloat) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T20:05:12.900

```
>>> round(0.62000000000000011,2)
0.62 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T20:10:11.550

要转换整个列表，请将@Zashas 答案与：

```
rounded = [ [round(a[0],2), round(a[1],2)] for a in P_all_States ] 
```

# jquery - jQuery执行正则表达式多个选项

> ID：12876484
> 
> 赞同：1
> 
> 时间：2012-10-13T19:59:50.943
> 
> 标签：jquery, regex

我正在尝试设置一种基于三个堆叠按钮的验证码，这些按钮显示不同的视觉图标。该脚本呈现其中三个按钮（如下所示），我需要验证用户是否根据给定的指令单击了正确的图标。

但是为了给出指令，我需要知道哪些图标已经被渲染，所以我需要 jQuery 继续这三个按钮，选择 i id 属性，然后从加载的内容中选择两个（随机）。例如，在下面的按钮中，我会给出“单击'文件'和'主页'”的指令，以便可以提交表单。

我现在最大的挑战是让 jQuery 知道已呈现的内容并获取每个属性的名称，以便我可以检查按钮是否已被单击，这意味着现在已设置类“活动”。我认为这可以用正则表达式完成，但不确定如何。我尝试了一些不同的方法都没有成功。注意说“活动”类是由 jQuery addClass 在单击时设置的，所以最初该类只是“btn”。

```
<button id="cb-8" type="button" class="btn active">
    <i id="icon-eye-open" class="icon-eye-open"></i>
</button>
<button id="cb-5" type="button" class="btn active">
    <i id="icon-home" class="icon-home"></i>
</button>
<button id="cb-2" type="button" class="btn active">
    <i id="icon-file" class="icon-file"></i>
</button> 
```

提前感谢您对此的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T03:37:37.920

不需要正则表达式。您可以使用索引和简单的 HTML 属性来做到这一点！

首先，HMTL

```
<div class="instructions">
  Please select <span class="choices"></span>
</div>

<button id="cb-8" type="button" class="btn captcha" data-caption="The Eye">
    <i class="icon-eye-open"></i>
</button>
<button id="cb-5" type="button" class="btn captcha" data-caption="The Home">
    <i class="icon-home"></i>
</button>
<button id="cb-2" type="button" class="btn captcha" data-caption="The File">
    <i class="icon-file"></i>
</button>
<button id="cb-1" type="button" class="btn captcha" data-caption="The Flag">
    <i class="icon-flag"></i>
</button>
<button id="cb-3" type="button" class="btn captcha" data-caption="The Tag">
    <i class="icon-tag"></i>
</button>
<button id="cb-4" type="button" class="btn captcha" data-caption="The Calendar">
    <i class="icon-calendar"></i>
</button>

<br/><br/>

<button type="button" class="btn check-answer">
    <i id="icon-check" class="icon-check"></i>Check Answer
</button> 
```

还有剧本

```
$(function() {

  // Number of buttons we want to show
  var num_show_buttons = 4;

  // Numbers of buttons that will be the answers. 
  var num_good_buttons = 2;

  // Hide all buttons by default.. and cache it. 
  var all_btn = $(".captcha").hide();

  // Get random numbers to know which buttons we're going to show
  var rand = getRandomNumbers({nums: num_show_buttons, max: all_btn.length})

  // Get random numbres to know which ones are going to be the answers
  var good_rand = getRandomNumbers({nums: num_good_buttons, max: 3})

  // Crawl through each buttons and display the chosen ones.
  $.each(rand, function(x,y) {
    var t_btn = all_btn.eq(y).addClass("visible").show();
  })

  // Crawl through each good buttons, get the captions, and add a class so we know its the good ones.
  $.each(good_rand, function(x,y) {
    var t_btn = $(".captcha.visible").eq(y).addClass("good");

    // This outputs the icons to select to the user. 
    $(".choices").append(t_btn.data('caption') + ", ");
  })

  // Everytime a buttons is clicked, add the active class. If already active, remove it.
  $(document).on("click", '.captcha', function() {
    var btn = $(this);

    if (btn.is(".active")) {
      btn.removeClass("active");
    } else {
      btn.addClass("active")
    }
  });

  $(document).on("click", ".check-answer", function() {
    // By default, the validation is false
    var validation = false;

    // If the number of active buttons equals the numbers of good buttons...
    if ($(".captcha.active").length == num_good_buttons) {
      // Set it the validation to true! But it's not over yet..
      var validation = true;

      // Let's crawl through each active one...
      $(".captcha.active").each(function(x,y) {

        // ... and check if they're good! If not, validation is false!
        if ($(".captcha.active")[x] != $(".captcha.good")[x]) {
          validation = false;
        }
      })
    }

    // Display results
    if (validation == true) {
      alert ("Good stuff!");
    } else {
      alert ("Uh oh :(");
    }

  })

});

// Functions to get x random numbers between range
function getRandomNumbers(params) {
  def = {
    nums: 10,
    min: 0,
    max: 100
  }  

  opt = $.extend({}, def, params);

  var arr = []
  while(arr.length < opt.nums) {
    var randomnumber = Math.floor( Math.random() * opt.max) + opt.min
    var found=false;

    for(var i=0;i<arr.length;i++) { 
      if (arr[i] == randomnumber) { 
        found = true;
        break;
      }      
    }

    if (!found) {
      arr[arr.length] = randomnumber;
    }
  }  

  return arr;
} 
```

这是一个有效的 jsfiddle：http: [//jsfiddle.net/rx7Bx/1/](http://jsfiddle.net/rx7Bx/1/)

# assembly - SPARC 中的乘法算法

> ID：12876487
> 
> 赞同：2
> 
> 时间：2012-10-13T20:00:26.363
> 
> 标签：assembly, multiplication, sparc

在 SPARC 的这种乘法算法上工作了几天（直接）……真的不知道出了什么问题。我已经逐步完成了代码的几次迭代。它正在做提议的 C 算法想要它做的事情。这是C语言

```
negative = multiplier >= 0 ? 0 : 1;
product = 0;
for (i = 0; i < 32; i++) {
    if (multiplier & 1)
        product += multiplicand;
(product and multiplier registers combined as a unit) >> 1;
}
if (negative)
    product -= multiplicand; 
```

这里是 SPARC 程序集，注意我还没有实现负数的功能。该程序运行建议的次数。所以循环不是问题。我认为我的问题可能是我如何计算两个 32 位寄存器之间的右移，目前只是（在伪代码中）

sra 小寄存器 1 如果（大寄存器的最右边位 = 1）将小寄存器的最左边位更改为 1 个 sra 更大的寄存器

但这似乎并没有按计划进行，因为我得到的数字真的很不稳定

这是 SPARC 中的整个程序......你们可以提供的任何帮助将不胜感激。

```
 fmt:   .asciz "Multiplicand: %d, Product: %8.8X%8.8X Counter: %d\n"            !output statement
.align 4                !align formatting

.global main
main:   save     %sp, -96, %sp
set     82732983, %l0       !move multiplicand into register %l0
set     120490892, %l1      !move multiplier into register %l1
set     0, %l2          !initialize product variable at 0
set     1, %l3          !initialize counter variable to 1
ba  test
mov     32, %l5         !put max loop value in a register

loop:
set     fmt, %o0        !setup the format string for the print statement
mov     %l0, %o1        !moving variables for printing
mov     %l1, %o2
mov     %l2, %o3
mov %l3, %o4
call    printf
nop
postprint:
    and     %l1, 1, %l6     !bitwise and between multiplier and 1, store result in %l6
cmp     %l6, 0          !comparison statement comparing the above to 1
be  else            !skip the addition if rightmost bit of multiplier is 0
nop

add     %l0, %l2, %l2       !adding multiplicand and product
sra     %l1, 1, %l1     !shifting multiplier right
and     1, %l2, %l6     !checking if rightmost bit of product is a 1
cmp     %l6, 1          !conditional statement to check this
bl  endif           !if it's not a one, branch to zero
nop             !non op

clr     %o4
set 0x40000000, %o4     !put 0x40000000 in a register
or      %l1,    %o4,    %l1 !if it is a one, bitwise do or with 0x40000000 to make a one in the leftmost bit of the multiplier
    sra     %l2,    1,  %l2     !shift product to the right by 1
    inc     %l3         !increment counter variable
    ba      test            !and branch to the testing statement
    nop

endif:
clr     %o5
sra     %l2, 1, %l2     !arithmetic shift product right by one (first line of endif)
inc     %l3         !increment counter variable
ba  test            
nop
else:
    sra     %l1, 1, %l1     !shift multiplier to the right
    and     %l2, 1, %l6     !check if rightmost bit of product is 1
    cmp     %l6, 1          !conditional statement to check this
    bl      endif           !branch to endif if it's not
    nop             !nop
clr     %o4
set 0x40000000, %o4     !put 0x40000000 in a register
    or      %l1, %o4, %l1       !if the rightmost bit is one, we use a bitwise or to place a 1 in the leftmost bit of the multiplier
    sra     %l2, 1, %l2     !then right arithmetic shift the product
    inc     %l3         !and increment the counter
    ba      test
    nop

test:   cmp     %l3, %l5
    bl      loop

done:   mov 1,  %g1             !Exit the program
    ta  0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-11-01T19:30:28.657

将功能拆分为：`Add()`和`Multiply()`

[SPARC 组装手册](http://www.cse.scu.edu/~atkinson/teaching/sp05/259/sparc.pdf)

[加法算法](https://en.wikipedia.org/wiki/Addition)

```
unsigned int Add(unsigned int num1, unsigned int num2)
{
    /* Iterate till there is no carry  */
    while (num2 != 0)
    {
        /* carry now contains common set bits of num1 and num2  */
        unsigned int carry = num1 & num2;  

        /* Sum of bits of numbers where at least one of the bits is not set */
        num1 = num1 ^ num2; 

        /* Carry is shifted by one so that adding it to x gives the required sum */
        num2 = carry << 1;
    }
    return num1;
} 
```

[乘法算法](https://en.wikipedia.org/wiki/Multiplication_algorithm)

```
unsigned int Multiply(unsigned int multiplicand, unsigned int multiplier)
{
    unsigned int result = 0;

    while(multiplier != 0) /* Use while instead of for */
    {
        if (multiplier & 0x01) 
        {
            result = Add(result, multiplicand);
        }

        multiplicand <<= 1; /* Left shifting the value contained in 'multiplicand' by 1 */
        multiplier >>=1;    /* Right shifting the value contained in 'multiplier' by 1\. */
   }

   return result;
} 
```

请注意：`int`这里假定为 32 位整数。（您可以根据`typedefs`现在替换函数签名）。此外，您可以添加溢出检查并相应地处理错误。

# php - PHP 计算 GPA 和用户定义函数

> ID：12876489
> 
> 赞同：1
> 
> 时间：2012-10-13T20:00:52.673
> 
> 标签：php

[http://fog.ccsf.cc.ca.us/~tboegel/semesterGPA1.php](http://fog.ccsf.cc.ca.us/~tboegel/semesterGPA1.php)

我的表格应该计算课程的 GPA（上面的链接）。我仍然需要计算总分、GPA、总质量。我想我可以自己弄清楚，但我需要找出如何 $_REQUEST['course1'], course2, course3, units1, units2, etc...（见下文）

到目前为止，我有

```
<?php
$course = $_REQUEST['course0'];
$units = $_REQUEST['units0'];
$letterGrade = $_REQUEST['letterGrade0'];
$letterGrade = strtoupper($letterGrade);
if($letterGrade == 'A') {
    $numberGrade = 4;
} elseif ($letterGrade == 'B') {
    $numberGrade = 3;                                                                           
} elseif ($letterGrade == 'C')  {
    $numberGrade = 2;                                                                           
} elseif ($letterGrade == 'D')  {
    $numberGrade = 1;                                                                           
} else {
    $numberGrade = 0;                                                                           
}

$qualityPoints = $units * $numberGrade;

function calculateQualityPoints($course, $units, $letterGrade, $qualityPoints) {
echo "<tr><td>$course</td><td>$units</td><td>$letterGrade</td><td>$qualityPoints</td></tr>";

}

echo "<table width='50%' align='left'><tr><th>Course</th><th>Units</th><th>Letter Grade</th><th>Quality Points</th></tr>";
calculateQualityPoints($course, $units, $letterGrade, $qualityPoints);                          
echo "<tr><td><strong>Total</strong></td><td><strong>total</strong></td><td></td><td><strong>quality total</strong></td></tr><tr><td><strong>GPA</strong></td><td><strong>GPA #</strong></td></tr></table>";                                                                                    

?> 
```

只有第一个文本框有效。如何获取 course1、course2、course3、units1、units2、letterGrade1 等？

此代码来自 HTML 表单，用于输入课程、年级和单元。

```
<?php
  for ($i=0; $i<5; $i+=1) {
    print "<tr>\n";
    print "\t<td><input type='text' name='course$i'></td>\n";
    print "\t<td><input type='text' name='units$i' size=5></td>\n";
    print "\t<td><input type='text' name='letterGrade$i' size=5></td>\n";
    print "</tr>\n";
  }
  ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:59:47.967

Your using the post method in your form, so in semesterGPA2.php, you should use $POST['name'] to access those input variables, where name is Course 0, 1, 2, etc. You can use another for loop to display this.

Your code should look something like this, hope it helps. Don't guarantee there are no typos!.

```
<?php
//maybe put the th tag here, course, units lettergrade, etc.
$qualityPoints = 0;
$units = 0;
for($i=0; $i<5; $i++) {

    //these are just the names in input name = "", can rename yo anything you want
    $courseName = 'course'.$i; 
    $unitsName = 'units'.$i;
    $letterGradeName = 'lettergrade'.$i;

    //we are using post to retrieve these form input variables
    $letterGrade = $POST[$letterGradename];
    $units = $POST[$unitsName];
    $course = $POST[$courseName];
    //calculate the quality points for each one
    $qualityPoints = calculateQualityPoints($units, $letterGrade);
    //maybe hereyou can just output(echo) each row with the above information
    //echo above info

    //you can aggregate them here for output of the final grade, like a report card
    $qualityPoints += $qualityPoints;
    $units += $units;
}

//here you can use the total quality points and the total units to calculate gpa
$GPA = ($qualityPoints/$units)/25;
echo "GPA:". $GPA;
//or even make a function to calculate GPA
//Why not even create a report card class that encapsulates all of this, but may be over kill!
function calculateQualityPoints($units, $letterGrade) {
    if($letterGrade == 'A') {
        //you can conver the letter grade to number grade, or you can just do it directly 
        $qualityPoints = 100 * $units;
    } elseif ($letterGrade == 'B') {
        $qualityPoints = 75 * $units;                                                                         
    } elseif ($letterGrade == 'C')  {
        $qualityPoints = 50 * $units;                                                                        
    } elseif ($letterGrade == 'D')  {
        $qualityPoints = 25 * $units;                                                                           
    } else {
        $qualityPoints = 0;                                                                          
    }
    return $qualityPoints;
}

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T21:28:01.190

只需检查一下，如果值 == '' 或 NULL

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T20:13:29.577

用这个替换`calculateQualityPoints($course, $units, $letterGrade, $qualityPoints);` ......它应该工作

```
for ($i=0; $i<5; $i+=1) {
   echo "<tr><td>".$_REQUEST['course'.$i]."</td><td>".$_REQUEST['units'.$i]."</td>";      
   echo "<td>$letterGrade</td><td>$qualityPoints</td></tr>";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-24T16:26:55.867

```
<?php
    $ban1 = 50;
    $ban2 = -22;
?>

<!DOCTYPE html>
<html>
    <head>
        <title>Student Markssheet</title>
        <style>
            th {
                font-size: 20px;
                padding: 12px;
                background-color: blueviolet;
                color: #fff;
            }
            td{
                padding: 8px;
                font-size: 18px;
            }
        </style>
    </head>
    <body>
        <center><h2>Enter Your Data</h2></center>
            <table width="100%">
               <tr>
                   <th width="5%">SL NO.</th>
                   <th width="20%">Subject Name</th>
                   <th width="5%">Marks</th>
                   <th width="5%">L.G.</th>
                   <th width="5%">GP</th>
               </tr>
               <tr> <!--Bangla First Paper-->
                   <td>01</td>
                   <td>Bangla First Paper</td>
                   <td><?php echo $ban1 ?></td>
                   <td>
                       <?php
                          if(101 > $ban1 | $ban1 > 79){echo 'A+';}   
                          elseif(80 > $ban1 || $ban1 > 69){echo 'A';}   
                          elseif(70 > $ban1 || $ban1 > 59){echo 'A-';}  
                          elseif(60 > $ban1 || $ban1 > 49){echo 'B';}   
                          elseif(50 > $ban1 || $ban1 > 39){echo 'C';}   
                          elseif(40 > $ban1 || $ban1 > 32){echo 'D';}
                          elseif(33 > $ban1 || $ban1 > 0){echo 'F';}
                          else{ echo "Unalocated Number";} 
                       ?>
                   </td>
                   <td>
                       <?php
                          if(101 > $ban1 || $ban1 > 79){echo '5.00';}   
                          elseif(80 > $ban1 || $ban1 > 69){echo '4.00';}   
                          elseif(70 > $ban1 || $ban1 > 59){echo '3.50';}   
                          elseif(60 > $ban1 || $ban1 > 49){echo '3.00';}   
                          elseif(50 > $ban1 || $ban1 > 39){echo '2.00';}   
                          elseif(40 > $ban1 || $ban1 > 32){echo '1.00';}   
                          elseif(33 > $ban1 || $ban1 > 0){echo '0.00';}
                          else{ echo "Unalocated Number";} 
                       ?>
                   </td>
               </tr>
               <tr> <!--Bangla Secound Paper-->
                   <td>02</td>
                   <td>Bangla Secound Paper</td>
                   <td><?php echo $ban2 ?></td>
                   <td>
                       <?php
                          if(101 > $ban1 || $ban1 > 79){echo 'A+';}  
                          else if(80 > $ban2 || $ban2 > 69){echo 'A';}   
                          else if(70 > $ban2 || $ban2 > 59){echo 'A-';}   
                          else if(60 > $ban2 || $ban2 > 49){echo 'B';}   
                          else if(50 > $ban2 || $ban2 > 39){echo 'C';}   
                          else if(40 > $ban2 || $ban2 > 32){echo 'D';}   
                          else if(33 > $ban2 || $ban2 > 0){echo 'F';}
                          else{ echo "Unalocated Number";} 
                       ?>
                   </td>
                   <td>
                       <?php
                          if(101 > $ban1 || $ban1 > 79){echo '5.00';}   
                          else if(80 > $ban2 || $ban2 > 69){echo '4.00';}   
                          else if(70 > $ban2 || $ban2 > 59){echo '3.50';}   
                          else if(60 > $ban2 || $ban2 > 49){echo '3.00';}   
                          else if(50 > $ban2 || $ban2 > 39){echo '2.00';}   
                          else if(40 > $ban2 || $ban2 > 32){echo '1.00';}   
                          else if(33 > $ban2 || $ban2 > 0){echo '0.00';}
                          else{ echo "Unalocated Number";} 
                       ?>
                   </td>
               </tr>

            </table>
    </body>
</html> 
```

# haskell - 了解函数式编程中的排序

> ID：12876495
> 
> 赞同：6
> 
> 时间：2012-10-13T20:01:44.297
> 
> 标签：haskell, functional-programming, category-theory

我主要是一个实际的人，但我觉得这很有趣。

我一直在考虑单子排序，有一些事情我需要澄清。因此，冒着听起来很傻的风险，它是：

monadic 成员绑定

`bind :: m b -> (b -> m c) -> m c`

可以对“动作”进行排序，让您可以显式访问中间值。

这比分类成员如何给我更多`(.)`：

`(.) :: cat b c -> cat a b -> cat a c`

有了这个，我可以排序并访问中间值。毕竟`(f . g) x = f(g (x))`。

如果我可以排序，为什么我需要`bind`排序`(.)`？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-13T20:24:29.787

你在正确的轨道上。每个 monad 都会产生所谓的[Kleisli 范畴](http://www.haskell.org/haskellwiki/Arrow_tutorial#Kleisli_Arrows)。对于每个 monad `m`，其对应的 Kleisli 类别都有箭头`a -> m b`，可以使用[>=>](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Monad.html#v:-62--61--62-)组合它们，其定义为

```
f >=> g     = \x -> f x >>= g 
```

[Kleisli](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Arrow.html#v:Kleisli)类型将这个封装在 Haskell 类型系统中，可以看到它有实例

```
instance Monad m => Category (Kleisli m) where
    id = Kleisli return
    (Kleisli f) . (Kleisli g) = Kleisli (g >=> f) 
```

所以这个类别中的排序计算只是使用排序操作`>=>`，可以用 等价表示`>>=`。

`return`我们使用and来定义 monad ，因为它更方便，但是如果我们愿意，我们也可以使用and`>>=`来定义它们。`return``>=>`

（另请参阅我对查看 monad的[不同方式的](https://softwareengineering.stackexchange.com/q/161443/61231)[回答](https://softwareengineering.stackexchange.com/a/161464/61231)。）

# r - R ggplot2：用数值标记y轴上的水平线

> ID：12876501
> 
> 赞同：38
> 
> 时间：2012-10-13T20:02:26.423
> 
> 标签：r, ggplot2

我在 ggplot 中有一条水平线，我想在 y 轴上标记它的值（7.1）。

```
library(ggplot2)
df <- data.frame(y=c(1:10),x=c(1:10))
h <- 7.1
plot1 <- ggplot(df, aes(x=x,y=y)) + geom_point() 
plot2 <- plot1+ geom_hline(aes(yintercept=h)) 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-10-13T20:14:52.867

目前尚不清楚您是否希望 7.1 成为 y 轴的一部分，或者您是否只是想要一种标记线的方法。假设是前者，你可以用它`scale_y_continuous()`来定义你自己的休息时间。像这样的事情可能会做你想要的（最有可能需要一些摆弄）：

```
plot1+ geom_hline(aes(yintercept=h)) + 
  scale_y_continuous(breaks = sort(c(seq(min(df$y), max(df$y), length.out=5), h))) 
```

![在此处输入图像描述](../Images/615d6838f2c6e1d7de97e25b240330ef.png)

假设后者，这可能是你想要的更多：

```
plot1 + geom_hline(aes(yintercept=h)) +
  geom_text(aes(0,h,label = h, vjust = -1)) 
```

![在此处输入图像描述](../Images/d2972ba38b508a6b9370c96dc95389e0.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-10-20T14:47:34.497

*与 Chase 的[解决方案](https://stackoverflow.com/a/12876602/4836511)类似，只是更改了使用现有标签。*

* * *

`ggplot_build(plot1)$layout$panel_ranges[[1]]$y.major_source`可用于提取现有标签并添加新标签`h`。

```
plot1 + geom_hline(aes(yintercept=h)) + 
  scale_y_continuous(breaks = sort(c(ggplot_build(plot1)$layout$panel_ranges[[1]]$y.major_source, h))) 
```

[![在此处输入图像描述](../Images/dfb8d567b1e67317cc57b51e570c0111.png)](https://i.stack.imgur.com/9zoBq.png)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-13T20:11:08.043

这样的事情怎么样？

```
plot1 + geom_hline(aes(yintercept=h), colour="#BB0000", linetype="dashed") + 
 geom_text(aes( 0, h, label = h, vjust = -1), size = 3) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-11-01T10:59:17.783

[这是Prradep 的回答](https://stackoverflow.com/a/46851686/9976891)的后续。

我认为 Prradep 的答案适用于旧版本的 ggplot2。我正在使用 ggplot2 版本 3.1.0，为了提取该`plot1`版本中的现有标签，您必须使用：

```
ggplot_build(plot1)$layout$panel_params[[1]]$y.major 
```

这仅适用于线性轴！如果您有一个非线性 y 轴（例如对数），则 ggplot2 存储如果轴在`$y.major`. 实际的刻度线标签作为字符向量存储在`$y.labels`. 因此，对于非线性 y 轴，您需要使用：

```
as.numeric(ggplot_build(cl.plot.log)$layout$panel_params[[1]]$y.labels) 
```

# c - GCC 包括 windows 中的头文件

> ID：12876503
> 
> 赞同：2
> 
> 时间：2012-10-13T20:02:57.630
> 
> 标签：c, gcc, header

我的项目位于一个名为 junkyard 的目录中。在垃圾场内，我有`test.c`一个名为 include 的文件夹。

我的代码如下所示：

```
#include <my_global.h>
#include <mysql.h>

int main(int argc, char **argv)
{
  printf("MySQL client version: %s\n", mysql_get_client_info());
} 
```

这两个头文件位于包含文件夹中（同样位于项目的根目录中。因此，结构的必要文件位于如下所示：

> 垃圾场/test.c
> 
> 垃圾场/包括/mysql.h
> 
> 垃圾场/包括/my_global.h

请注意，我在 Windows 上使用 GCC。我无法编译程序，我尝试了几种方法。如何正确链接头文件？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-13T20:10:04.300

首先[`#include`语法](https://stackoverflow.com/questions/21593/what-is-the-difference-between-include-filename-and-include-filename)之间的区别：

*   `#include <>`表示从“编译器目录”中包含文件（可以通过[预处理器选项`-I`](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Preprocessor-Options.html#Preprocessor-Options)设置）
*   `#include ""`表示从“本地目录”中包含文件

如果你想从你的项目中包含文件，你可能应该使用：

```
#include "include/mysql.h"
#include "include/my_global.h" 
```

如果您（出于某些原因）仍想像这样`#include <>`使用 gcc：

```
gcc -Iinclude test.c 
```

# android - 在班级和活动之间共享变量

> ID：12876505
> 
> 赞同：2
> 
> 时间：2012-10-13T20:03:10.493
> 
> 标签：android, android-intent

我正在尝试编写我的第一个 android 应用程序。

我想实现刷卡，所以我为此添加了一些代码。

该代码的一部分在`OnCreate`方法中，一部分在它自己的类中。在两者中，我都需要引用 viewflippers id。

经过一番阅读，我创建了一个扩展应用程序类的类。我已将变量放入其中。

在活动类中，我可以引用它：

> GlobalVars vars = ((GlobalVars) getApplicationContext());

然后我可以参考我的取景器：

> ViewFlipper viewFlipper = vars.viewFlipper;

现在我想对 Gesture 类执行相同的滑动操作，但它会出错：

> GlobalVars vars = ((GlobalVars) getApplicationContext());

它说：“MyGestureDetector 类型的方法 getApplicationContext() 未定义”

那么如何在另一个不是活动的类中引用这些全局变量呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T02:37:07.600

如果要将 GlobalVars 应用程序对象与不是 Activity 的对象一起使用（因此没有 getApplicationContext()），则必须通过构造函数或设置器将其提供给 MyGestureDetector 检测器。

# iphone - UINavigation 栏的自定义后退按钮

> ID：12876509
> 
> 赞同：0
> 
> 时间：2012-10-13T20:03:31.193
> 
> 标签：iphone, ios, xcode

我在自定义后退按钮中的文本以显示所需的字符串时提到了很多线程（[如何更改导航栏上的“后退”按钮的标题](https://stackoverflow.com/questions/1449339/how-do-i-change-the-title-of-the-back-button-on-a-navigation-bar)、 [NavigationController UINavigationBar 后退按钮和其他几个）。](https://stackoverflow.com/questions/8000449/navigationcontroller-uinavigationbar-back-button)但是，他们不使用情节提要。很多都不适用。

为了给你一个背景，我通过故事板创建了我的视图（`view1`和`view2`），我想使用一个后退按钮`view2`导航到`view1`。我怎样才能使用 IB 做到这一点？

或者，我也尝试设置`self.navigationItem.backBarButtonItem.title`为`@"Custom text";`，但这也不起作用。

有人可以建议我如何更改`Back`按钮上的文本`view2`吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T01:46:39.663

我找到了我的问题的解决方案。下面描述的方法将让您更改后退按钮的文本，而无需更改父视图控制器的标题。

1.  打开故事板文件并单击连接两个视图控制器的链接。
2.  打开实用程序面板并单击属性检查器。
3.  给 storyboard segue 一个有意义的标识符。（为了这个例子，我称之为 saveReturn。）按回车接受。
4.  打开父视图控制器的 .m 文件并插入代码。

    `- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender` {
    `if ([segue.identifier isEqualToString:@"saveReturn"])` `{` `self.navigationItem.backBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"Save & Return" style: UIBarButtonItemStyleBordered target:nil action:nil];` `}` `}

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-18T17:39:03.543

我知道这是一个老问题 - 但为了完整性：

Storyboard 的实现方式（我个人喜欢在 Storyboard 中尽可能多地做）：

在您要更改的带有后退按钮的视图**之前**的视图（即您正在更改的后退按钮的目的地）选择导航栏并在属性检查器中更改“后退按钮”字段的值（这也是您可以更改视图的名称） - 见下文。

![在此处输入图像描述](../Images/d5f00a0a24af702b4069bae09b90d42e.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-13T23:06:40.467

这是故事板解决方案：

将视图控制器的标题设置为`prepareForSegue`适合后退按钮的短标题：

```
MyViewController *mvc = segue.destinationViewController;
mvc.title = @"Docs"; 
```

要将其改回，请执行以下操作`viewWillAppear`：

```
self.title = @"Important Documents"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-13T22:09:17.747

我对故事板不熟悉。

然而，通常，诀窍是

*   在从 view1 切换到 view2 之前，根据需要在 view2 的后退按钮上设置 view1 的标题

    [ViewController1 setTitle:@"view2的后退按钮我要的文字"];

*   当您切换回 view1 时，您不需要此标题。因此，在 view1 的视图控制器的实现中，您覆盖：

    -(void) viewWillAppear:(BOOL)animated{ [super viewWillAppear:animated]; [self setTitle:@"view1中我真正想要的标题"]; }

这样，当您从 view1 切换到 view2 时，您会触发您希望出现在后退按钮上的标题。当您从 view2 切换回 view1 时，您使用的是 view1“将出现”的事实！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-16T06:57:36.830

您没有在问题中指定 view1 是否是 view2 的前一个视图，但如果这是您想要做的（在后退按钮中使用自定义标题），那么在情节提要中很容易做到。

如果您在情节提要中看不到导航栏，请在情节提要中为 view1 选择视图控制器，并在属性检查器中，确保顶部栏选择了导航栏（而不是推断）

选择 view1 的导航栏，然后在 Attributes Inspector 中，您有 3 个字段：Title、Prompt 和 Back Button。如果将文本添加到后退按钮字段，当您从 view1 导航到 view2 时，后退按钮将使用此文本而不是 view2 的后退按钮中的标题。

# java - 循环通过休眠数据源问题

> ID：12876512
> 
> 赞同：0
> 
> 时间：2012-10-13T20:03:37.120
> 
> 标签：java, hibernate

我已经实现了 HibernateLoopDataSource，其中我有构造函数，一个没有应用标准，一个有。看起来像以下

```
HibernateLoopDataSource.java

//code trimmed
HibernateLoopDataSource(Session hibernate, Class<?> typeOfClass){
  this.hibernate = hibernate;
  this.typeOfClass = typeOfClass;
}

HibernateLoopDataSource(Session hibernate, Class<?> typeOfClass, AppliedCriteria appliedCriteria){
  this.hibernate = hibernate;
  this.typeOfClass = typeOfClass;

}

AppliedCriteria.java //looks like following 
```

它是一个接口，只包含一个方法

```
applyingCriteria(Criteria criteria); 
```

和

```
GettingArticles.java

// code trimmed

public LoopDataSource getArticles(){
return new HibernateLoopDataSource(hibernate, Article.class, new AppliedCriteria(){
 public void applyingCriteria(Criteria criteria){
   criteria.add(Restrictions.eq("article.id", fullCommentPageListing.getArticle().getId()));}});} 
```

但是，当我尝试初始化时，它不会报告任何内容，但是它会在不应用条件的情况下循环。这个问题的原因可能是什么，我坚持了 2 个小时，这可能是一些微不足道的，我看不到它，因为我为此工作了 8 个小时。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:21:19.957

您不对构造函数中的条件参数做任何事情：

```
HibernateLoopDataSource(Session hibernate, 
                        Class<?> typeOfClass, 
                        AppliedCriteria appliedCriteria){
    this.hibernate = hibernate;
    this.typeOfClass = typeOfClass;
    // you should have this.appliedCriteria = appliedCriteria here
} 
```

# c++ - std::map 插入卡在无限循环中或给出访问冲突错误

> ID：12876523
> 
> 赞同：1
> 
> 时间：2012-10-13T20:04:34.327
> 
> 标签：c++, access-violation, stdmap

我在 .h 文件中声明了一个 std::map

```
#include "pl.h"
#include <conio.h>
#include <iostream>
#include <fstream>
#include <string>
#include <boost/algorithm/string.hpp>
#include <boost/lexical_cast.hpp>
#include <vector>
#include <map>

using namespace std;

class ReadingXDSLfile
{
public:

     ReadingXDSLfile();
     ~ReadingXDSLfile();
     void readDotXDSLFile(string fileName, ifstream &file);
     void writeNodesList();

protected:
    typedef std::map<std::string, int> nodesMap;

    nodesMap nodes;

    std::vector<string> nodesName;
    std::map<std::string, int>::iterator nodeItr, nodeItr1;
    string outFileName;
private:
}; 
```

并且在 .cpp 文件中，当我尝试使用以下代码行插入项目时，它会给出访问冲突错误

```
int counter=0;
string strNode;
...
....
....
std::pair<string, int>prNode (strNode, counter);
     nodes.insert(prNode); 
```

错误：

```
Unhandled exception at 0x0043c5d9 in testMMHC.exe: 0xC0000005: Access violation reading location 0x0000002c. 
```

现在我在函数（.cpp 文件）中声明了一个临时映射变量，它允许我插入。但是当我将临时映射复制到头文件中声明的全局映射时，它会进入无限循环并且永远不会退出。

它发生在头文件中声明的所有映射变量中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:30:27.123

首先，在你的头文件中为你的地图声明一个 typedef 是可以的，但不要声明变量本身，除非你使用`extern`. 应该只有一个，并且应该在您的 .cpp 文件中。

在 .h 文件中：

```
#include <map>
#include <string>

typedef std::map<std::string, int> NodeMap;
extern NodeMap nodes; 
```

接下来，您的 .cpp 文件：

```
NodeMap nodes; 
```

最后，关于插入，你有很多可能的方法来做到这一点。

```
std::string strIndex = "foo";
int value = 0

// one way.
nodes[strIndex] = value;

// another way
nodes.insert(NodeMap::value_type(strIndex,value)); 
```

举几个例子。

**编辑：** OP 更改了问题的源内容，现在显示这`nodes`不是全局的，而是另一个类的成员变量。这个答案中的所有内容都`extern`变得毫无意义。

违规的偏移量表明迭代器之一或类本身正在通过空指针引用。0x2C 距离 NULL 有 44 字节深，这向我表明被引用的`ReadingXDSLfile` ***对象***可能来自 NULL 指针。

如果没有来自 OP 关于如何分配和访问被引用对象的更多信息，我敢肯定，我只能提供一个关于如何在标头中外部变量的定义明确的教程，这应该是显而易见的与这个问题无关。

# c# - WebRequest.DefaultWebProxy 或 WebRequest.GetSystemWebProxy() 是否在 MonoTouch 中调用 CFNetwork.GetDefaultProxy()？

> ID：12876524
> 
> 赞同：2
> 
> 时间：2012-10-13T20:04:38.237
> 
> 标签：c#, ios, xamarin.ios

我正在尝试注销对 MonoTouch 库的引用，所使用的只是：

```
IWebProxy oDefaultProxy =  CFNetwork.GetDefaultProxy (); 
```

在 .NET 中，还有`WebRequest.DefaultWebProxy`和`WebRequest.GetSystemWebProxy(`)。这些中的任何一个都可以`CFNetwork.GetDefaultProxy ()`在 iOS 上解决吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T23:17:35.477

我不清楚您所说的*退出参考*是什么意思。但是，您的 MonoTouch 安装中包含了 Mono 源代码（甚至可以在其中设置断点）。

此外，由于 Mono 是开源的，github 也有一个*几乎*相同的副本，因此您可以查看 用于 OSX（和 iOS）调用的内容[`DefaultWebProxy`](https://github.com/mono/mono/blob/mono-2-10/mcs/class/System/System.Net/WebRequest.cs#L215)和操作。[`GetSystemWebProxy`](https://github.com/mono/mono/blob/mono-2-10/mcs/class/System/System.Net/WebRequest.cs#L345)[`CFNetwork.GetDefaultProxy`](https://github.com/mono/mono/blob/mono-2-10/mcs/class/System/System.Net/WebRequest.cs#L348)

# ios - Cocos2d Gamecenter 因方向问题导致 iOS6 崩溃

> ID：12876526
> 
> 赞同：2
> 
> 时间：2012-10-13T20:04:39.220
> 
> 标签：ios, cocos2d-iphone, game-center

在给出解决方案之前已在此处询问过此问题，但无法正常工作

[iOS 6 Game Center 在身份验证时崩溃](https://stackoverflow.com/questions/12612643/ios-6-game-center-crash-on-authentication)

检查这个我有同样的问题。链接中的上述代码解决了它，GameCenter 工作，但现在 cocos2d 游戏旋转，这给游戏带来了问题。有没有人解决它或对此有任何解决方案

也试过这个，但它不起作用[GameCenter 身份验证在仅限横向的应用程序中抛出 UIApplicationInvalidInterfaceOrientation](https://stackoverflow.com/questions/12427979/gamecenter-authentication-in-landscape-only-app-throws-uiapplicationinvalidinter)我认为因为我使用的是 cocos2d 场景。

目前我正在实施此代码来解决问题，因为我别无选择。

```
-(NSUInteger)application:(UIApplication*)application supportedInterfaceOrientationsForWindow:(UIWindow*)window
{
    return UIInterfaceOrientationMaskAllButUpsideDown;
} 
```

我需要的解决方案很简单，可以打开游戏中心而不会崩溃，同时将代码锁定为横向（将所有 cocos2d 场景保持在横向）任何帮助将不胜感激。先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T19:35:46.703

根据我的经验，我经历的大多数答案都解决了 cocos2d 1.x 上的问题。但是，我的游戏是使用 cocos2d 2.x 开发的，所以这里解决了我的问题：

**1）我在目标设置中有这些设置：**

![在此处输入图像描述](../Images/8d03510cc40e845465f4a6bbb5d188a2.png)

![在此处输入图像描述](../Images/d5361eb8ddb96b7fb5f92f1b90e870b1.png)

人们说我应该添加肖像支持，但这只是搞砸了我的旋转......

**2) 确保您使用的是最新的 cocos2d 2.x！即使它处于测试阶段！（目前为 v2.1 b2）**

[http://www.cocos2d-iphone.org/](http://www.cocos2d-iphone.org/)

相信我，我有很多错误和头痛，因为我认为 beta 不稳定，我没有使用它。最终，总是建议使用 cocos2d 升级到 beta（不像 Xcode！）

**3) 在 AppDelegate.m 中，确保你没有使用`CCDirector`方法`runWithScene:`和`pushScene:`内部`- (BOOL)application: didFinishLaunchingWithOptions:`**

你想要做的，只是使用这个功能：

```
// This is needed for iOS4 and iOS5 in order to ensure
// ... blah blah blah
- (void)directorDidReshapeProjection:(CCDirector *)director {
    if (director.runningScene == nil) {
        // Add the first scene to the stack. blah blah...
        // and add blah
        [director runWithScene:[LanguageScene node]];
    }
} 
```

* * *

并且只是一个猜测，不要在`- (BOOL)application: didFinishLaunchingWithOptions:`. 在你的主场景被加载并被`onEnterTransitionDidFinish`调用后对他进行身份验证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T15:05:55.260

我终于让 Game Center 在 iOS 6 中工作，并为我留下了锁定的风景。

我将此代码放在我的 AppDelegate 中。（不是视图控制器）

```
- (NSUInteger)application:(UIApplication *)application supportedInterfaceOrientationsForWindow:(UIWindow *)window
{
  return (UIInterfaceOrientationMaskAll);
} 
```

我把它放在我的视图controller.m中

```
- (void)authenticateLocalPlayer {
     GKLocalPlayer *localPlayer = [GKLocalPlayer localPlayer];
     localPlayer.authenticateHandler = ^(UIViewController *viewController, NSError *error)
    {
        if (viewController != nil)
        {
            [self presentViewController:viewController animated:YES completion:nil];  
        }
     };
} 
```

我还发现了排行榜和成就视图控制器的更新。

```
[self presentViewController:achievements animated:YES completion:nil];
[self presentViewController:leaderboardController animated:YES completion:nil];

[self dismissViewControllerAnimated:NO completion:nil]; 
```

# c++ - std::unordered map 不按哈希值的递增顺序存储条目

> ID：12876528
> 
> 赞同：0
> 
> 时间：2012-10-13T20:05:04.700
> 
> 标签：c++, stl, c++11, unordered-map

我正在使用 Visual Studio 2010，并且正在使用 C++ 11 功能 std::unordered_map::hash_function() 打印为每个键字符串计算的哈希值。

但是我发现在内部，条目是按随机顺序存储的，而不是按哈希值的递增顺序存储的。

在下面的示例中，Dad 计算到最低的哈希值并且应该是 my_family_height_map 的开始条目，但它不是。开始元素是 sis 对，它计算的哈希值比爸爸更高。

凸轮有人解释为什么我看到这种奇怪的行为？

```
// unorderedmap_usage.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include <unordered_map>
#include <string>
#include <iostream>

int main()
{
    typedef std::unordered_map<std::string, double> height_map;
    height_map my_family_height_map;

    my_family_height_map["Dad"] = 5.10;
    my_family_height_map["Mom"] = 5.3;
    my_family_height_map["Sis"] = 5.3;
    my_family_height_map["Zach"] = 6.2;

    height_map::const_iterator c_it;

    // Print everything in the map
    for(c_it = my_family_height_map.begin(); c_it!= my_family_height_map.end(); ++c_it)
    {
        std::cout << "Hash:" << hasher_func(c_it->first) << "  Person is : " << c_it->first << " - height is " << c_it->second << "\n";
    }
} 
```

O/P：
哈希：572570820 人是：姐姐 - 身高是 5.3
哈希：306541572 人是：爸爸 - 身高是 5.1
哈希：1076885014 人是：妈妈 - 身高是 5.3
哈希：2613037907 人是：扎克 - 身高是 6.2
按任意关键继续。. .

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T20:09:23.247

顾名思义，无序地图是***无序***的。规范中没有要求必须按照哈希值递增的顺序迭代条目。或减少哈希。或者任何东西，这就是为什么它被称为“无序”。¹

如果您需要技术细节，则必须将哈希值转换为 bin 索引。这是通过一些截断/包装/等算法完成的，基于哈希表中的 bin 数量。这就是为什么它是无序的；因为迭代的顺序通常是 bin 的顺序，它不必与哈希的顺序匹配。

¹从技术上讲，它被称为“无序”，因为许多 C++ 标准库实现已经附带了名为`hash_map/set/etc`. 委员会不想与他们重叠。

# html - 文档模式 IE7 和 IE8 标准无法正确呈现

> ID：12876531
> 
> 赞同：0
> 
> 时间：2012-10-13T20:05:15.763
> 
> 标签：html, internet-explorer, rendering

我试图弄清楚为什么我的页面没有正确呈现。

我注意到当我的页面显示为“文档模式：IE7 标准”或“文档模式：IE8 标准”时，页面无法在浏览器中正确呈现。页面导航似乎有问题，如下所示：

![不正确的渲染](../Images/a3af8285d9d9fdbf50c7b16b3a54fe72.png)

当我更改为“文档模式：IE9标准”时，页面正确显示如下：

![正确渲染](../Images/36a7d72f69aa60e477948114e2c3c5d9.png)

知道如何解决这个问题吗？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T20:31:13.500

您的代码显然使用了 IE8 或 IE7 不支持的某些 CSS 样式或其他浏览器功能。

你还没有给我们任何代码，所以我不能确切地告诉你这些特性是什么，但是如果你需要支持这些旧浏览器，那么你需要解决这个问题。

第一件事：您提到您在 IE9 兼容模式下看到了这一点。如果不需要支持IE7/8，可以通过指定`x-ua-compatible`meta标签来防止IE9进入兼容模式，如下：

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

这将强制 IE 以可用的最佳渲染模式运行。所以 IE9 将使用 IE9 标准模式，而不是兼容模式。

但是，如果您确实需要支持 IE7 和 IE8，则需要执行以下操作之一：

*   修复您的代码以使用浏览器。
*   修复浏览器以使用您的代码。

如前所述，您还没有提供代码，所以我无法帮助您解决第一点，但第二个选项可能值得考虑。

有大量的 Javascript hack 旨在在旧浏览器中模拟新的浏览器功能——尤其是 IE。这些黑客被称为“polyfills”，你可以在这里找到一个相当全面的列表：[https ://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills)

如果你能确定是哪个浏览器功能破坏了你的代码，你可以在你的代码中实现相关的 polyfill，希望事情会突然开始工作。不同的 polyfill 以非常不同的方式工作，所以在不了解更多细节的情况下，我真的无法提供更多帮助，但它们中的大多数都有足够好的文档来帮助你入门。

最后，要注意一点：如果您正在使用 IE9 的兼容模式测试您的站点是否可以在 IE7/8 中运行，请小心 - 兼容模式存在许多已知问题，导致它们与IE7 或 IE8 的真实副本。如果你没有看到真实的东西，你就不能绝对肯定你的代码在这些浏览器中工作。兼容模式不够好，无法确定。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T20:13:56.033

每个版本的 Internet Explorer 对当时的标准都有完全不同的支持级别。一般来说，每个以后的版本都对当时的标准有更好和更完整的实现，但是，IE 以缺失、不完整或不正确的标准实现而闻名。

当您更改显示设置以反映旧版本时，您也会失去最新版本所拥有的新支持。例如，IE7 不支持 CSS3 功能，因此无法正确显示这些功能。

不要忘记，能够切换到较旧的文档模式背后的想法是双重的。对于普通用户来说，它是能够正确显示一个专门为旧版浏览器设计的页面（就像它是当前浏览器时一样）。对于开发人员/网站管理员，测试对可能仍在运行旧版本浏览器的旧机器上的用户的支持。

另请注意，如果您需要更具体的帮助，那么您可能希望在代码中进行编辑或使用 JSFIDDLE.net 等网站提供链接

# http - http-long 轮询和 -streaming：在同一连接上发送数据？

> ID：12876535
> 
> 赞同：0
> 
> 时间：2012-10-13T20:06:26.510
> 
> 标签：http, streaming, request, long-integer, polling

这里只是另一个快速理解的问题......我想知道，当使用长轮询或 http-streaming 时来自客户端的 HTTP 请求在服务器上挂起时，客户端是否可以通过*同一*连接发送数据还是客户端必须为此创建另一个连接，从而在网络和服务器上增加更多负载？

我假设是后者，但我不确定。在这里偶然发现了这个 IETF 文档，但在那里也找不到答案：[https ://datatracker.ietf.org/doc/html/draft-loreto-http-bidirectional-07](https://datatracker.ietf.org/doc/html/draft-loreto-http-bidirectional-07)

一如既往地提前感谢您的帮助。

编辑：稍微澄清一下我的问题：我想知道服务器和客户端之间的双向通信仍然可以通过一个连接进行（同时使用长轮询或http steraming），就像使用webSocket之类的东西一样。顺便说一句，开销与这个问题无关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T15:42:55.763

如果客户端和服务器支持 HTTP/1.1，他们可以使用[HTTP 管道](http://en.wikipedia.org/wiki/HTTP_pipelining)，这允许发出新请求，而不管其他请求是否已发出并仍在等待响应。这通过相同的单个连接起作用。这种并行请求的主要要求是它们应该是**幂等**的，即它们不应该通过服务器状态（数据）的可能变化而相互影响。

# grammar - 分解 LALR 语法

> ID：12876536
> 
> 赞同：1
> 
> 时间：2012-10-13T20:06:34.460
> 
> 标签：grammar, lalr, ply

> **可能重复：**
> [Python/YACC：解决移位/减少冲突](https://stackoverflow.com/questions/2939888/python-yacc-resolving-a-shift-reduce-conflict)

我正在尝试使用 Ply 创建一个解析器，它实现了一个像 Yacc 这样的 LALR(1) 解析器。但是，我遇到了困难的减少/减少冲突。据我所知，我的语法没有歧义，相反，冲突源于 LALR(1) 解析器的有限前瞻。我猜`A A`是遇到问题的时候会出现问题，因为解析器需要知道是否有第三个token来决定是否归约`t1`。那么如何将其分解为只需要单个标记前瞻的语法呢？

```
from ply import lex, yacc

tokens = ('A','B')
t_A = 'A'
t_B = 'B'

def p_top(p):
    'top : t1\n| t2'

def p_1(p):
    't1 : t7 t6'

def p_2(p):
    't2 : t3 t4\n| B'

def p_3(p):
    't3 : t6\n| B'

def p_4(p):
    't4 : t5 t5\n| B'

def p_5(p):
    't5 : t6\n| B'

def p_6(p):
    't6 : A'

def p_7(p):
    't7 : A'

lexer = lex.lex()
parser = yacc.yacc(debug=True)
parser.parse('AAA') 
```

这是 Ply 调试输出中的相关状态，尽管我不太了解它。

```
state 1

    (13) t7 -> A .
    (12) t6 -> A .

  ! reduce/reduce conflict for A resolved using rule 12 (t6 -> A .)
    B               reduce using rule 12 (t6 -> A .)
    A               reduce using rule 12 (t6 -> A .)

  ! A               [ reduce using rule 13 (t7 -> A .) ] 
```

# ruby-on-rails - 在 Rails 中实现多租户

> ID：12876538
> 
> 赞同：4
> 
> 时间：2012-10-13T20:06:40.350
> 
> 标签：ruby-on-rails, ruby, multi-tenant

我们在各自的在线 VPS 服务器上为多个客户端部署了一个中等规模的应用程序。所有客户端的代码都是相同的。维护正在成为一个巨大的负担。即使是同样的变化，我们也部署在这么多的服务器上。因此，我们计划为我们的应用程序实现多租户功能。

我们遇到了一些宝石，但这并没有达到目的，因此我们计划实施它。

我们创建了一个新模型`Client`，我们创建了一个`abstract superclass`继承自`ActiveRecord::Base`该类的所有依赖类。现在问题来了，当我想`default_scope`从我的超类中添加时。

```
class SuperClass < ActiveRecord::Base
  self.abstract_class = true
  default_scope where(:client_id => ???)
end 
```

这 ？？？每个用户的变化。所以我不能给出静态值。但我不确定如何动态设置此范围。那么可以做些什么呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-13T22:36:17.757

我们执行以下操作（您可能不需要线程安全部分）：

```
class Client < ActiveRecord::Base
  def self.current
    Thread.current['current_client']
  end

  def self.current=(client)
    Thread.current['current_client'] = client
  end
end

class SuperClass < ActiveRecord::Base
  self.abstract_class = true
  # Note that the default scope has to be in a lambda or block. That means it's eval'd during each request.
  # Otherwise it would be eval'd at load time and wouldn't work as expected.
  default_scope { Client.current ? where(:client_id => Client.current.id ) : nil }
end 
```

然后在 ApplicationController 中，我们添加一个 before 过滤器来根据子域设置当前 Client：

```
class ApplicationController < ActionController::Base
  before_filter :set_current_client

  def set_current_client
    Client.current = Client.find_by_subdomain(request.subdomain)
  end
end 
```

# webgl - 三.js 突然视口裁剪

> ID：12876540
> 
> 赞同：0
> 
> 时间：2012-10-13T20:06:51.970
> 
> 标签：webgl, three.js

我正在使用 Three.js 使用 WebGL 渲染器和 OrthographicCamera 绘制一些四面体。`THREE.OrthographicCamera(-ww, ww, hh, -hh, -100000, 100000);`它们是这样生成的：

```
var ret = new THREE.Mesh();
var retGeom = new THREE.Geometry();
var side = Math.sqrt(3);
var th = (Math.sqrt(6)/3)*side;
var rad = side*(Math.sqrt(3)/3);
var inrad = side*(Math.sqrt(3)/6);
var ang = Math.PI*2/3;

retGeom.vertices.push(new THREE.Vector3(0,0,th));
retGeom.vertices.push(new THREE.Vector3(Math.cos(0)*rad,Math.sin(0)*rad,0));
retGeom.vertices.push(new THREE.Vector3(Math.cos(ang)*rad,Math.sin(ang)*rad,0));
retGeom.vertices.push(new THREE.Vector3(Math.cos(-ang)*rad,Math.sin(-ang)*rad,0));

retGeom.faces.push(new THREE.Face3(1, 2, 0, null, new THREE.Color(0xff00ff), 0));
retGeom.faces.push(new THREE.Face3(3, 0, 2, null, new THREE.Color(0x0000ff), 0));
retGeom.faces.push(new THREE.Face3(3, 1, 0, null, new THREE.Color(0xffff00), 0));
retGeom.faces.push(new THREE.Face3(3, 2, 1, null, new THREE.Color(0x00ff00), 0)); 
```

我在顶点上使用 multiplyScalar(...) 来设置大小。使用的材料是`THREE.MeshBasicMaterial({vertexColors: THREE.FaceColors})`。我试过的最基本的 onResize 是这样的：

```
ww = window.innerWidth;
hh = window.innerHeight;

renderer.setSize(ww, hh);
camera.aspect = ww/hh;
camera.left = -ww;
camera.right = ww;
camera.top = hh;
camera.bottom = -hh;
camera.updateProjectionMatrix();
renderer.render(scene, camera); 
```

无论如何，当四面体的中心点由于使用内置轨迹球控件调整大小或平移而离开窗口的一侧时，我遇到的问题就会发生。尽管这会使它的一部分仍然在屏幕和窗口中，但此时整个事物都会停止渲染。

我尝试了不同的相机并看到了类似的行为。我还认为它可以用 setViewport(...) 或 setScissor(...) 修复，我玩了一点但没有成功。

有没有人知道要让对象渲染到完全不在屏幕上？我在这方面相当缺乏经验，并且觉得这里可能有一个我缺少的简单解决方案。

# python - 通过 FTP 使用 Python 下载文件

> ID：12876541
> 
> 赞同：1
> 
> 时间：2012-10-13T20:06:53.593
> 
> 标签：python, url, unix, download

我可以想到三种`ftp://`从 python 的地址下载文件的方法：使用`urllib`（或`urllib2`），使用`ftplib`，或`os.system`调用一个常见的程序，如`wget`. 假设我试图仅在 unix 系统上执行此操作。是否有充分的理由偏爱一种方法而不是另一种方法？特别是，`urllib`与`ftplib`？`urllib`使用起来似乎要简单得多。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:16:03.853

它很容易使用 python 下载 ftp 文件检查 python 文档： [http ://docs.python.org/library/ftplib.html](http://docs.python.org/library/ftplib.html)

顺便说一句，有人已经在这里问过：[如何从 ftp 下载文件？](https://stackoverflow.com/questions/7006574/how-to-download-file-from-ftp)

# syntax - yacc 中的 %left 和 %right

> ID：12876543
> 
> 赞同：15
> 
> 时间：2012-10-13T20:07:16.893
> 
> 标签：syntax, compiler-construction, yacc, operator-precedence

```
{%
#include<stdio.h>
#include<stdlib.h>
%}

%token ID NUM IF THEN LE GE EQ NE OR AND ELSE

%right '='
%left AND OR
%left '<' '>' LE GE EQ NE
%left '+''-'
%left '*''/'
%right UMINUS
%left '!'

%% 
```

上面提到的代码是一个简单`IF ELSE`程序的 yacc 的一部分。

是什么`%right`意思`%left`？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2016-01-11T01:13:05.260

我知道这是一个老问题，但万一其他人正在寻找此信息：

`%left`,`%right`和`%nonassoc`, 定义 yacc 将如何解决运算符的重复问题。如果您有：

```
1 + 2 + 3 
```

两个运算符具有相同的优先级（它们是相同的:)），在这种情况下 yacc 可以解决：

```
// using %left
(1 + 2) + 3 
```

或者：

```
// using %right
1 + (2 + 3) 
```

最后：

```
//using %nonassoc
1 + 2 + 3 is considered illegal and a syntax error! 
```

你可以在[这里](http://www.gnu.org/software/bison/manual/html_node/Precedence-Decl.html)阅读更多。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-14T10:36:07.997

`%left`并`%right`指定运算符的[关联](http://en.wikipedia.org/wiki/Operator_associativity)性。操作的关联性决定了相同优先级的两个操作中的哪一个先执行。

假设我们有语法规则：

```
exp ::= exp + exp
exp ::= ID 
```

假设我们必须解析表达式 x+yz。你看，由于加减的优先级是一样的，这个表达式可以解释为(x+y)-z或者x+(yz)。这似乎没什么大不了的，但它在语法中引入了歧义。

除了解析问题和理论，假设我们正在解析表达式。6+5-7，并假设我们的语言只能处理自然数，并且在发生下溢时抛出异常。(4)的结果`(6+5)-7`将不等于`6+(5-7)`(exception)，因此我们将无法预测结果——除非我们通过指定运算符的关联性来定义评估顺序。还要考虑表达式的情况，例如`f()+g()+h()`，当操作数是可能有副作用的函数时。

# html - 如何定位已经有浮动的 div？

> ID：12876545
> 
> 赞同：1
> 
> 时间：2012-10-13T20:07:28.807
> 
> 标签：html, css

我有一组 div 设置为 float:left 并且我希望它们彼此对齐但仍然居中，这就是我目前拥有的：

HTML

```
<div style="display: inline; text-align:center;">
    <div id="generalmenu">
        test
    </div>
    <div id="generalmenu">
        test
    </div>
    <div id="generalmenu">
        test
    </div>
</div> 
```

CSS

```
#phonicmenu { 
    background: white; 
}
#generalmenu { 
    background: white; 
    width:270; 
    padding: 25px; 
    float:left; 
    margin-left: auto; 
    margin-right: auto; 
} 
```

关于如何将这些菜单居中的任何想法？

编辑：添加了一个带有主体的 JS Fiddle，这样您就可以更清楚地看到问题。 [http://jsfiddle.net/aYWwM/](http://jsfiddle.net/aYWwM/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T20:18:47.767

问题还在于您将`div`s 用于它们不适合的目的。div 是块元素。您想将内容显示为内联元素，因此您应该使用`span`or 无序列表。

要做你需要的，只需创建一个包装 div 并将其`margin-left`设置`margin-right`为`auto`. 包装器应包含您需要的内联元素...请参阅[此 jsFiddle](http://jsfiddle.net/4eJsF/)

# spring - 带有 HSQLDB 的 Hibernate 4.1 给出“数据异常：字符串数据，右截断”

> ID：12876551
> 
> 赞同：16
> 
> 时间：2012-10-13T20:08:32.423
> 
> 标签：spring, hibernate, jpa, hsqldb, c3p0

我有一个非常奇怪的问题，当我将 som deps 升级到项目时得到了它。

我现在使用以下版本：

*   春天：3.1.0.RELEASE
*   休眠：4.1.7.Final
*   hsqldb：2.2.8（org.hsqldb）

我认为问题与文件字段有关。（数据库文件内容）

**堆栈跟踪：**

```
javax.persistence.PersistenceException: org.hibernate.exception.DataException: could not insert: [org.project.model.Cv]
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1387)
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1315)
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1321)
    at org.hibernate.ejb.AbstractEntityManagerImpl.persist(AbstractEntityManagerImpl.java:843)
    at sun.reflect.GeneratedMethodAccessor11.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240)
    at $Proxy36.persist(Unknown Source)
    at org.project.dao.jpa.GenericDaoJpa.save(GenericDaoJpa.java:49)
    at sun.reflect.GeneratedMethodAccessor10.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:318)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    at $Proxy40.save(Unknown Source)
    at org.project.dao.CvDaoTest.updateTest(CvDaoTest.java:77)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: org.hibernate.exception.DataException: could not insert: [org.project.model.Cv]
    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:102)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
    at org.hibernate.id.insert.AbstractReturningDelegate.performInsert(AbstractReturningDelegate.java:64)
    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2345)
    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2852)
    at org.hibernate.action.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:71)
    at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:273)
    at org.hibernate.event.def.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:320)
    at org.hibernate.event.def.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:203)
    at org.hibernate.event.def.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:129)
    at org.hibernate.ejb.event.EJB3PersistEventListener.saveWithGeneratedId(EJB3PersistEventListener.java:69)
    at org.hibernate.event.def.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:179)
    at org.hibernate.event.def.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:135)
    at org.hibernate.event.def.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:61)
    at org.hibernate.impl.SessionImpl.firePersist(SessionImpl.java:808)
    at org.hibernate.impl.SessionImpl.persist(SessionImpl.java:782)
    at org.hibernate.impl.SessionImpl.persist(SessionImpl.java:786)
    at org.hibernate.ejb.AbstractEntityManagerImpl.persist(AbstractEntityManagerImpl.java:837)
    ... 45 more
Caused by: java.sql.SQLDataException: data exception: string data, right truncation
    at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
    at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
    at org.hsqldb.jdbc.JDBCPreparedStatement.fetchResult(Unknown Source)
    at org.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate(Unknown Source)
    at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeUpdate(NewProxyPreparedStatement.java:105)
    at org.hibernate.id.IdentityGenerator$GetGeneratedKeysDelegate.executeAndExtract(IdentityGenerator.java:94)
    at org.hibernate.id.insert.AbstractReturningDelegate.performInsert(AbstractReturningDelegate.java:57)
    ... 60 more
Caused by: org.hsqldb.HsqlException: data exception: string data, right truncation
    at org.hsqldb.error.Error.error(Unknown Source)
    at org.hsqldb.error.Error.error(Unknown Source)
    at org.hsqldb.types.BinaryType.castOrConvertToType(Unknown Source)
    at org.hsqldb.types.BinaryType.convertToType(Unknown Source)
    at org.hsqldb.StatementDML.getInsertData(Unknown Source)
    at org.hsqldb.StatementInsert.getInsertValuesNavigator(Unknown Source)
    at org.hsqldb.StatementInsert.getResult(Unknown Source)
    at org.hsqldb.StatementDMQL.execute(Unknown Source)
    at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
    at org.hsqldb.Session.execute(Unknown Source)
    ... 65 more 
```

**安慰：**

```
INFO : org.hibernate.engine.jdbc.JdbcSupportLoader - Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException
Hibernate: insert into Nationality (id, countryCode) values (default, ?)
Hibernate: insert into Language (id, countryCode, languageCode) values (default, ?, ?)
Hibernate: insert into Person (id, birthdate, created, email, enabled, firstName, image, lastName, lastUpdate, nationality_id, password, role, salt) values (default, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
Hibernate: insert into Nationality (id, countryCode) values (default, ?)
Hibernate: insert into Person (id, birthdate, created, email, enabled, firstName, image, lastName, lastUpdate, nationality_id, password, role, salt) values (default, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
Hibernate: insert into Company (id, name) values (default, ?)
Hibernate: insert into Language (id, countryCode, languageCode) values (default, ?, ?)
Hibernate: insert into Company (id, name) values (default, ?)
Hibernate: insert into Skill (id, company_id, created, isCategory, lastUpdate, skill_fk) values (default, ?, ?, ?, ?, ?)
Hibernate: insert into Company (id, name) values (default, ?)
Hibernate: insert into Skill (id, company_id, created, isCategory, lastUpdate, skill_fk) values (default, ?, ?, ?, ?, ?)
Hibernate: insert into Nationality (id, countryCode) values (default, ?)
Hibernate: insert into Person (id, birthdate, created, email, enabled, firstName, image, lastName, lastUpdate, nationality_id, password, role, salt) values (default, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
Hibernate: insert into CourseExperience (created, lastUpdate, lastUpdatePerson_id, person_fk, endDate, startDate, id) values (?, ?, ?, ?, ?, ?, ?)
Hibernate: insert into Nationality (id, countryCode) values (default, ?)
Hibernate: insert into Person (id, birthdate, created, email, enabled, firstName, image, lastName, lastUpdate, nationality_id, password, role, salt) values (default, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
Hibernate: insert into CourseExperience (created, lastUpdate, lastUpdatePerson_id, person_fk, endDate, startDate, id) values (?, ?, ?, ?, ?, ?, ?)
Hibernate: insert into Cv (id, company, created, language, lastUpdate, lastUpdatePerson_id, name, person_fk, summary_id) values (default, ?, ?, ?, ?, ?, ?, ?, ?)
WARN : org.hibernate.util.JDBCExceptionReporter - SQL Error: -3401, SQLState: 22001
ERROR: org.hibernate.util.JDBCExceptionReporter - data exception: string data, right truncation 
```

**简历.java：**

```
package org.project.model;

import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.JoinColumn;
import javax.persistence.ManyToMany;
import javax.persistence.ManyToOne;
import javax.persistence.OneToMany;
import javax.persistence.OrderBy;
import javax.persistence.OrderColumn;
import javax.persistence.PrePersist;
import javax.persistence.PreUpdate;
import javax.persistence.Temporal;
import javax.persistence.TemporalType;

import org.project.model.interfaces.DomainObject;

@Entity
public class Cv implements DomainObject {

    private static final long serialVersionUID = -9111485038728016755L;

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(nullable = false)
    private String name;

    @ManyToOne
    @JoinColumn(name = "person_fk")
    private Person person;

    @ManyToMany
    private List<Skill> skills = new ArrayList<Skill>();

    @ManyToOne
    private Summary summary;

    @ManyToMany(targetEntity = Experience.class)
    @OrderColumn(name = "index")
    private List<Experience> experiences = new ArrayList<Experience>();

    @Temporal(TemporalType.TIMESTAMP)
    @Column(updatable = false, insertable = true)
    private Date created;

    @Temporal(TemporalType.TIMESTAMP)
    private Date lastUpdate;

    @ManyToOne(optional = false)
    private Person lastUpdatePerson;

    @Column(nullable = false)
    private Language language;

    @Column(nullable = false)
    private Company company;

    @OneToMany(orphanRemoval = true, cascade = CascadeType.ALL, targetEntity = DbFile.class)
    @OrderBy("created DESC")
    private List<DbFile> files = new ArrayList<DbFile>();

    @PrePersist
    @PreUpdate
    protected void updateDates() {
        Date now = new Date();
        if (this.created == null) {
            this.created = new Date(now.getTime());
        }
        this.lastUpdate = now;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Person getPerson() {
        return person;
    }

    public void setPerson(Person person) {
        this.person = person;
    }

    public List<Skill> getSkills() {
        return skills;
    }

    public void setSkills(List<Skill> skills) {
        this.skills = skills;
    }

    public List<Experience> getExperiences() {
        return experiences;
    }

    public void setExperiences(List<Experience> experiences) {
        this.experiences = experiences;
    }

    public Date getCreated() {
        return created;
    }

    public void setCreated(Date created) {
        this.created = created;
    }

    public Date getLastUpdate() {
        return lastUpdate;
    }

    public void setLastUpdate(Date lastUpdate) {
        this.lastUpdate = lastUpdate;
    }

    public Person getLastUpdatePerson() {
        return lastUpdatePerson;
    }

    public void setLastUpdatePerson(Person lastUpdatePerson) {
        this.lastUpdatePerson = lastUpdatePerson;
    }

    public void addSkill(Skill skill) {
        this.skills.add(skill);
    }

    public void addExperience(Experience experience) {
        this.experiences.add(experience);
    }

    public Summary getSummary() {
        return summary;
    }

    public void setSummary(Summary summary) {
        this.summary = summary;
    }

    public List<DbFile> getFiles() {
        return files;
    }

    public void setFiles(List<DbFile> files) {
        this.files = files;
    }

    public void addFile(DbFile file) {
        this.files.add(file);
    }

    public Company getCompany() {
        return company;
    }

    public void setCompany(Company company) {
        this.company = company;
    }

    public Language getLanguage() {
        return language;
    }

    public void setLanguage(Language language) {
        this.language = language;
    }

    @Override
    public int hashCode() {
        final int prime = 31;
        int result = 1;
        result = prime * result + ((id == null) ? 0 : id.hashCode());
        return result;
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (obj == null)
            return false;
        if (getClass() != obj.getClass())
            return false;
        Cv other = (Cv) obj;
        if (id == null) {
            if (other.id != null)
                return false;
        } else if (!id.equals(other.id))
            return false;
        return true;
    }
} 
```

**DbFile.java：**

```
package org.project.model;

import java.util.Date;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Lob;
import javax.persistence.PrePersist;
import javax.persistence.Temporal;
import javax.persistence.TemporalType;

import org.hibernate.annotations.Type;

import org.project.model.interfaces.DomainObject;

@Entity
public class DbFile implements DomainObject {

    private static final long serialVersionUID = 1974800702358176016L;

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String filename;

    @Column(nullable = false)
    @Lob
    @Type(type = "org.hibernate.type.MaterializedClobType")
    private byte[] content;

    private String contentType;

    @Temporal(TemporalType.TIMESTAMP)
    @Column(updatable = false)
    private Date created;

    @PrePersist
    protected void updateDates() {
        if (this.created == null) {
            this.created = new Date();
        }
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getFilename() {
        return filename;
    }

    public void setFilename(String filename) {
        this.filename = filename;
    }

    public byte[] getContent() {
        return content;
    }

    public void setContent(byte[] content) {
        this.content = content;
    }

    public String getContentType() {
        return contentType;
    }

    public void setContentType(String contentType) {
        this.contentType = contentType;
    }

    public Date getCreated() {
        return created;
    }

    @Override
    public int hashCode() {
        final int prime = 31;
        int result = 1;
        result = prime * result + ((id == null) ? 0 : id.hashCode());
        return result;
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (obj == null)
            return false;
        if (getClass() != obj.getClass())
            return false;
        DbFile other = (DbFile) obj;
        if (id == null) {
            if (other.id != null)
                return false;
        } else if (!id.equals(other.id))
            return false;
        return true;
    }
} 
```

**测试：**

```
@Transactional
@RunWith(SpringJUnit4ClassRunner.class)
...
@TransactionConfiguration(transactionManager = "transactionManager", defaultRollback = true)
public class CvDaoTest extends AbstractTest {

    @Autowired
    private CvDao cvDao;

    @Test
    public void updateTest() {
        Cv cv = new Cv();
        cv.setName("test");

        ...
        cv.setLastUpdatePerson(lastUpdatePerson);

        ...
        cv.setPerson(person);
        cv.setCreated(new Date());
        cv.setLastUpdate(new Date());

        cv.setCompany(getCompany());
        cv.setLanguage(getLanguage());

        ...
        cv.addSkill(skill1);
        cv.addSkill(skill2);

        ...
        cv.addExperience(experience1);
        cv.addExperience(experience2);

        cvDao.save(cv).getId();
    }
} 
```

**GenericDaoJpa.java**

```
public class GenericDaoJpa<T extends DomainObject> implements GenericDao<T> {

    private Class<T> type;
//  @PersistenceContext
    protected EntityManager entityManager;

    @PersistenceContext
    public void setEntityManager(EntityManager entityManager) {
        this.entityManager = entityManager;
    }

    public GenericDaoJpa(Class<T> type) {
        super();
        this.type = type;
    }

    @Transactional(readOnly = true)
    public T get(Long id) {
        if (id == null) {
            return null;
        } else {
            return entityManager.find(type, id);
        }
    }

    @SuppressWarnings("unchecked")
    @Transactional(readOnly = true)
    public List<T> getAll() {
        return entityManager.createQuery("select o from " + type.getName() + " o").getResultList();
    }

    @Transactional(readOnly = false)
    public T save(T object) {
        if (object.getId() != null) {
            return entityManager.merge(object);
        } else {
            entityManager.persist(object);
        }
        entityManager.flush();
        return object;
    }

    public T delete(T object) {
        entityManager.remove(object);
        return object;
    }
} 
```

它失败了：'cvDao.save(cv).getId();'

使用类 'com.mchange.v2.c3p0.ComboPooledDataSource' 和驱动程序 'org.hsqldb.jdbcDriver' 在 url 'jdbc:hsqldb:mem:data' 的数据源

我做错了什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-11-07T16:39:37.913

问题在于**HSQLDialect**实现，它在其构造函数中注册 sql 类型：

```
public HSQLDialect() {
    super();

    ...
    registerColumnType( Types.BLOB, "blob($l)" );
    registerColumnType( Types.CLOB, "clob($l)" );
    ...
} 
```

其中**$l**取自**列长度属性**。但是，如果未明确设置列长度属性，则它的默认值为`255`. 在这种情况下，`HSQLDialect`创建列为**CLOB(255)**，这对 clob 来说很有趣......

1)

一种解决方案是使用足够的值显式设置列长度。

例如：

```
@Lob
@Column(length = 10000)
private String text; 
```

但是如果你想避免这种人为的构造，你可以修改方言。

2)

第二种解决方案是**修改**HSQLDialect：

```
package com.extensions.dialect;

import java.sql.Types;
import org.hibernate.dialect.HSQLDialect;

public class MyHsqlDialect extends HSQLDialect {

    public MppHsqlDialect() {
        super();
        registerColumnType(Types.CLOB, "clob");
    }
} 
```

并在休眠配置设置新方言：

```
hibernate.dialect=com.extensions.dialect.MyHsqlDialect 
```

我在集成测试中使用此解决方案。

* * *

一些额外的信息可以在这里找到：

[https://hibernate.atlassian.net/browse/HHH-7541](https://hibernate.atlassian.net/browse/HHH-7541)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-12-05T22:17:14.883

正确的答案应该是：为您的 @Column 注释添加长度，如下所示：

```
@Lob
@Column(length = 10000, name = "style")
private String style; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-01-12T19:44:07.403

我有类似的问题。有很多错误：“数据异常：字符串数据，右截断”。决议是指定大字段的大小。没有该字段将被限制为默认大小。但这还不是全部。HSQL 不会自动更新数据库架构。因此，如果您重新创建数据库，更改将不会应用。

```
@Column(length = 5 * 1024 * 1024) // five megabytes
private byte[] bytesPreview; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-13T20:46:32.443

尝试 HSQLDB 2.2.9 或最新的 sanpshot，因为堆栈跟踪看起来像是 2.2.8 之后修复的问题。

快照和发布的 Maven 存储库在这里：

[http://www.hsqldb.org/repos/org/hsqldb/hsqldb/](http://www.hsqldb.org/repos/org/hsqldb/hsqldb/)

另请参阅下面的答案。似乎“org.hibernate.type.MaterializedClobType”的使用在 PostgreSQL 中很常见。但是您的字段是 byte[] 并且可以用 HSQLDB 更好地表示为 BLOB。

[通过 Hibernate（不是 JDBC）从 blob 中检索图像](https://stackoverflow.com/questions/9049488/retrieve-image-from-blob-via-hibernate-not-jdbc/9058813#9058813)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-31T13:53:23.630

当我的关系属性之一缺少 @ManyToOne 注释时，我收到了相同的错误消息。将 HSQLDB 升级到 2.2.9 并没有解决问题。

JPA 2 有这个要求：

> “关系最低限度需要关系注释，@OneToMany 或 @ManyToMany”

您是否在未添加此类注释的情况下添加了新属性？

# python - 使用正则表达式进行 Python 网页抓取

> ID：12876553
> 
> 赞同：1
> 
> 时间：2012-10-13T20:09:07.913
> 
> 标签：python, regex, web, beautifulsoup, scrape

有人可以帮助我编写一些代码来从游戏中提取统计数据吗？我可以将 html 放入 BeautifulSoup，但我不知道如何正确格式化正则表达式以获取整个页面的特定数据位。这是我所拥有的：

```
from urllib import urlopen
from bs4 import BeautifulSoup
import re

content = urlopen('http://www.worldoftanks.com/community/accounts/1000395103-FrankenTank').read()
soup = BeautifulSoup(content)
print soup 
```

如果你能告诉我如何提取一个统计数据，我就能弄清楚其余的。其中一项统计数据是参与的战斗次数（10103），编码如下：

```
<tr>
<td class=""> Battles Participated: </td>
<td class="td-number-nowidth"> 10 103 </td>
</tr> 
```

谢谢！

坦率

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T20:20:09.740

[搜索树](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#searching-the-tree)：

```
battles = soup.find('td', 'td-number-nowidth')
if battles:
   print(battles.get_text()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T20:22:13.913

您要提取的数字之间是否包含该空格？如果是这样，我会做一些看起来像这样的事情：

```
m = re.search('class="td-number-nowidth">(\d+) (\d+)</td>', soup)
if m:
    print(m.groups()) 
```

groups() 返回一个`tuple`包含“10”和“103”的字符串，因此您可能需要将它们连接在一起并将其保留为`string`类型或将其解析为`int`用于您的目的。

```
matched = m.groups()
num = matched[0] + matched[1]
finalnumber = int(num) 
```

# analytics - 跟踪小部件在多个网站上的安装？

> ID：12876557
> 
> 赞同：1
> 
> 时间：2012-10-13T20:09:23.643
> 
> 标签：analytics, web-analytics, web-analytics-tools

我有一个人们将在他们的网站上安装的小部件，我想实施一种跟踪方法来查看安装了小部件的域。我知道我可以只包含一个跟踪像素并跟踪我的服务器上的点击，但由于我预计小部件的安装量会超过 50k，这会给我的服务器带来很大的压力。

是否有可用于这种情况的跟踪服务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T04:29:02.690

如果您可以在您的小部件中放置小型 javascript 来运行，您可以试试[这个](http://infunl.com/#referral)工具——查看推荐分段示例。请注意，它不提供任何带有图形的 UI，如 Google Analytics 或类似服务。它只是一个 API 和小语言来查询收集的事件。

# java - Marbles 程序未删除

> ID：12876563
> 
> 赞同：2
> 
> 时间：2012-10-13T20:10:14.540
> 
> 标签：java, interface, polymorphism

我正在玩的程序有一些问题。我正在尝试做这个弹珠游戏，玩家在电脑上玩并移除弹珠，直到棋盘为空。我的问题是我用来移除弹珠的课程似乎没有移除它。我认为这很简单，但我只是不明白。我认为我遇到问题的部分是大写字母：

```
Pile tiles = new Pile();
tiles.createMarbles();
marbles = tiles.getMarbles();
System.out.println("There are now " + marbles + " left!");

HumanPlayer hum = new HumanPlayer();
SmartMode cpu = new SmartMode();
StupidMode badcpu = new StupidMode();

//ComputerMove cpu = new ComputerMove();
//PlayerMove hum = new PlayerMove();
do {
    if (compMove == true && marbles > 1) {
        if (compSmart) {
            //marbles = cpu.move(marbles);
            tiles.removesMarbles(cpu.move(marbles)); //THIS RIGHT HERE
            System.out.println("There are now " + marbles + " left!");
            compMove = false;
        }  if (!compSmart) {
            //marbles = badcpu.move(marbles);
            tiles.removesMarbles(badcpu.move(marbles)); // THIS RIGHT HERE
            System.out.println("There are now " + marbles + " left!");
            compMove = false;

        }
        /* marbles = (cpu.ComputerMove(marbles, compSmart));
         System.out.println("There are now " + marbles + " left!");
         compMove = false;*/
    } else if (compMove == false && marbles > 1) {
        //marbles = (hum.move(marbles));
        tiles.removesMarbles(hum.move(marbles)); // THIS RIGHT HERE
        System.out.println("There are now " + marbles + " left!");
        compMove = true;
    }

} while (marbles > 1); 
```

其余的不需要回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:53:12.967

条件`while (marbles > 1)`不会改变，因为`marbles`没有在循环中分配。

采用：

```
while (tiles.getMarbles() > 1) 
```

您使用以下构造：

```
do {
  if (... && marbles > 1 ) {}
  ...
} while(marbles > 1) 
```

可能这也是一样的：

```
while (tiles.getMarbles() > 0 ) {
  // additional condition on marbles not required.
  if (...) {}
} 
```

* * *

```
interface Movable {
   public int move();
}

class SmartPlayer implements Movable {
   public int move() {...}
}

Movable m = new SmartPlayer();
m.move(); 
```

# ios - 在我的 iOS 应用程序中遇到严重的性能问题

> ID：12876566
> 
> 赞同：0
> 
> 时间：2012-10-13T20:10:47.713
> 
> 标签：ios, performance

这是我的第一个 iOS 应用程序，我正试图找出我在这里做错了什么。我的应用程序会启动并挂起几秒钟，直到它响应。该应用程序将在启动时通过网络并从那里获取图像。然后它从添加了文本的图像构建视图。构建视图的函数相当长，但基本上它是从网络上获取每个对象的图像数据。我使用这些方法：

```
NSURL *url = [NSURL URLWithString: 
   @"http://mysite.com/images/best_trip_ever.png"];
UIImage *image = [UIImage imageWithData: [NSData dataWithContentsOfURL:url]]; 
```

由于它在应用程序启动时发生了数十次，我认为这可能是性能下降的原因之一。

我正在创建的视图是通过向我创建的视图添加子视图来制作的。我从网上获取的图像的每个对象都在发生这种情况。

我也有一个`table view`，对于每一行，我都使用相同的方法从网络带来的图像中再次在表格视图中显示一个漂亮的行。表格视图中非常明显的一点是，当我向下滚动时，单元格会卡住并且移动不顺畅。

对于每个对象，我将数据存储在一个`NSData`对象中，并`encode/decode`使用获取数据并将其写回对象的方法。

我不知道是不是从网络中引入图像让事情变得如此缓慢（在我看来这不应该那么慢。可能需要 7-8 秒！）或者是构建视图的行为从图像。

我不介意在每个图像可用之前显示微调器旋转符号，前提是应用程序会尽快唤醒。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:13:33.090

您正在应用程序的主线程上从 Internet 访问数据。这总是很糟糕，这就是导致挂起的原因。查看 Apple 的名为 LazyTableImages 的示例项目。它通过在后台加载图像来解决这个确切的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T20:17:27.220

[https://github.com/rs/SDWebImage](https://github.com/rs/SDWebImage)

这是一个非常有用的异步加载/缓存图像的框架

# jquery - 变量值问题

> ID：12876577
> 
> 赞同：0
> 
> 时间：2012-10-13T20:12:28.110
> 
> 标签：jquery, variables, load

我有一组 div 通过它们包含的内容的高度来获取它们的高度。我这样做的原因是因为我想切换这些 div 内部的内容，但希望它们相应地调整它们的高度，这也与在动画期间调整它们的高度有关。问题是当我加载新内容时，高度没有正确调整。我正在加载文本并使用 jquery .load 执行此操作，并使用 spans 将文本包含在它所保存的外部页面中，如果我包含带有

由于某种原因，它在.load 上失去了格式，不知道为什么。我需要帮助让容器适应 .load 更改的内容。

[http://klossal.com/brigham_about2.html](http://klossal.com/brigham_about2.html) 那是页面，顶部的动画是使用 .load 并且没有正确调整高度的动画，您可以在启动动画时看到它。第二个动画使用内联内容和容器调整它们的方式。

```
$("#outpt_main_open").click(function() {
$('#header_img_outpt_main').load('/brigham_profiles2.html     
#header_karlene_salguero_photo');
$('#header_paragraph_outpt_main').load('/brigham_profiles2.html      
#header_txt_karlene_salguero');
$('#bio_txt_outpt_main').load('/brigham_profiles2.html #bio_txt_karelene_salguero');
$('#edu_txt_outpt_main').load('/brigham_profiles2.html #edu_txt_karelene_salguero');
$('#contact_txt_outpt_main').load('/brigham_profiles2.html  
#contact_txt_karelene_salguero');
profile_outpt_main_open_animation();

}); 
```

那是提示加载的按钮。我需要先加载然后提示动画功能吗？或者我是否需要让变量以某种方式重新采样新的加载内容，或者他们自己这样做？或者这是完全不同的东西？任何帮助将不胜感激，这让我发疯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T21:48:51.913

问题是动画功能`profile_outpt_main_open_animation()`使用的是元素的原始高度，而不是加载新内容后的新高度。要解决此问题，`.height()`请在计算每个元素的顶部时使用该函数。

因此，例如，而不是

```
$("#profile_outpt_main_BIO").delay(330).animate({
    top:  profile_outpt_main_HEADER_ht + 20
}, 400); 
```

而是使用新的高度：

```
$("#profile_outpt_main_BIO").delay(330).animate({
    top:  $("#profile_outpt_main_HEADER").height() + 20
}, 400); 
```

您显然必须更改此函数中对原始高度的所有引用，而不仅仅是此处演示的那个。

# python - 在进行浏览器自动化时，网站将您注销多长时间？

> ID：12876578
> 
> 赞同：-5
> 
> 时间：2012-10-13T20:12:29.223
> 
> 标签：python, cookies, selenium

我正在使用 selenium 和 python 来进行浏览器自动化。我的程序将不断运行，但我不想退出网站。

网站在我空闲时将我注销需要多长时间？我怎样才能让它不让我退出？刷新网站上的页面就足够了吗？这不是像银行或商店那样有安全保障的网站。我只是不想退出。

我正在开发的网站是 points2shop.com 或 cashle.com。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:31:04.173

会话超时是在服务器端设置的 - 除非您实际上尝试通过增加不活动时间来计时并查看它何时超时，否则您无法确定超时时间。

任何 HTTP 请求（应该包括页面刷新）很可能会导致您保持登录状态。

# mysql - 在mysql存储过程中循环选择操作的单个结果

> ID：12876580
> 
> 赞同：0
> 
> 时间：2012-10-13T20:12:50.097
> 
> 标签：mysql, loops, stored-procedures

我正在尝试学习 mysql 中的存储过程，这可能不是您需要使用 SP 的最佳方案，但它仍然是一个学习过程:)

我有一张桌子，比如`table1`以下列：

```
table1_name, table1_location 
```

我有另一张桌子，比如`table2`以下列

```
table2_name, table2_location 
```

假设 table1 现在有 5 条记录，并且 table2 是空白的。我想运行一个 SP，并将所有 table1_name 和 table1_location 数据分别输入到 table2_name 和 table2_location 中。

这是我写的mysql代码-

```
DELIMITER //
CREATE PROCEDURE INS()
BEGIN
SELECT table1_name, table1_location FROM table1;
SET name, location VARCHAR(50);
INSERT INTO table2 VALUES (name, location);
END //
DELIMITER ; 
```

这段代码显然不起作用！我担心的是，由于已经有 5 条记录，那么 table1_name 将是一个具有 5 个值的数组，而 table1_location 也将是一个具有 5 个值的数组，通常由 SELECT 操作返回。如何获取每个单元格值然后进行插入操作？

我对 mysql/SP 很陌生 ..请多多包涵 :)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T21:02:50.730

不幸的是，对于您的学习，答案与存储过程无关。

插入可以获取选择的结果：

```
INSERT into table2
SELECT name, location
FROM table1 
```

如果您确实需要在存储过程中循环遍历行集，请查看[cursors](http://dev.mysql.com/doc/refman/5.0/en/cursors.html)。

# android - 为什么经常这样写？启动监控失败 0A3C202B1601A00A

> ID：12876586
> 
> 赞同：1
> 
> 时间：2012-10-13T20:13:48.070
> 
> 标签：android, android-emulator, avd, galaxy

我在这周重新安装了 windows 并重新安装了 AVD 和 SDK 并再次解压缩了 eclipse，但是当我将 Galaxy 手机连接到计算机时，eclipse 出现错误，首先在 eclipse 的控制台选项卡中写道：

```
The connection to adb is down, and a severe error has occured.You must restart adb and Eclipse.
Please ensure that adb is correctly located at 'C:\MOBILE PROGRAMMING\android-sdk\android-        sdk\platform-tools\adb.exe' and can be executed." 
```

然后频繁写入“Failed to start monitoring 0A3C202B1601A00A”。

当我断开电脑的电话时，此消息（无法开始监控 0A3C202B1601A00A）被删除。如果我尝试使用模拟器运行程序，则错误会在控制台选项卡中写入：

```
No active compatible AVD's or devices found. Relaunch this configuration after connecting a            device or starting an AVD. 
```

我不知道我应该怎么解决这个问题。请帮我。

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T09:29:03.027

Try this post. [Failed to start monitor](https://stackoverflow.com/questions/12980767/failed-to-start-monitoring-and-not-run-the-program-why)

The solution for me was actually to use a different USB port.

# javascript - 使用 Handlebars 和 Backbone 解析模板的问题

> ID：12876591
> 
> 赞同：1
> 
> 时间：2012-10-13T20:14:02.263
> 
> 标签：javascript, jquery, backbone.js, handlebars.js

我如何使用总计数值和名称的值，使用车把的消息数组组？我真的遇到了麻烦，因为 messages 已被放置为 array 。

```
"Adds each model as li to ul"

 _.each(this.model.models, function (message) {
            $(this.el).append(new itemView({model:message}).render().el);
 }, this); 

"Single item view"

var itemView = Backbone.View.extend({          //Represents each message

    tagName:"li",

    template:Handlebars.compile($('#message-list-item').html()),

    initialize: function () {
        _.bindAll(this, 'render', 'remove');
        this.model.bind('change', this.render);
    },

    render:function () {
        $(this.el).html(this.template(this.model.toJSON()));
        return this;
    }

});

<!-- Item View Template -->
 <script type="text/template" id="message-list-item">
    <div><a title="{{group.name}}"></a></div>    ((currently not working))
    <div><a title="{{total_messages}}"></a></div> ((currently not working))
    <div>
 </script>
<!--  Item View Template -->

JSON
 [
   {
    "total_messages": "10",
    "messages": [
        {
            "id": "10",
            "name": "msg1",
            "group": {
                "name": "Data12",
                "img_url": "placeholder_bn.png"
            }
        },
        {
            "id": "11",
            "name": "msg2"
        }
    ]
}
] 
```

# javascript - 为嵌套模型动态生成 id

> ID：12876597
> 
> 赞同：0
> 
> 时间：2012-10-13T20:14:40.020
> 
> 标签：javascript, ruby-on-rails, ruby

我正在使用 JavaScript 为嵌套模型生成隐藏输入的表单。它看起来有点像这样：

```
<!-- Attrs. inputs for nested model price -->
<button>Add price</button> 
```

jscript 会弹出一个引导模式，其中包含用于传递新价格属性的字段并为它们生成隐藏输入，如下所示：

```
<input type="hidden" value="1" name="product[prices_attributes][0][quantity]">
<input type="hidden" value="123" name="product[prices_attributes][0][amount]"> 
```

这意味着，对于我想发送给控制器的每个新价格，我必须生成 ID。问题是，有没有办法让控制器动态生成 id，而不是自己设置这些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:23:20.563

一种方法是获取当前时间戳而不是`[0]`您正在使用的时间戳。实际上，这不会用作新对象的 ID。将记录保存在数据库中时将创建 ID。您使用的那些“ID”仅用于识别不同的对象，因此您只需要它们是唯一的，因此时间戳是一个很好的解决方案。

```
new Date().getTime(); 
```

我还建议你试试这个 gem：[https ://github.com/ryanb/nested_form](https://github.com/ryanb/nested_form)

# database - 带有 django 的 Postgresql DatabaseError 列

> ID：12876600
> 
> 赞同：0
> 
> 时间：2012-10-13T20:14:43.943
> 
> 标签：database, django, postgresql

我正在尝试找到解决此错误的方法：

> 列posts_post.slug 不存在
> 
> 第 1 行：选择“posts_post”。“id”，“posts_post”。“title”，“posts_post”...

有谁知道这可能是什么原因造成的？

这是完整的错误输出：[http ://dpaste.com/813336/](http://dpaste.com/813336/)

```
 from django.db import models
    from django.contrib.auth.models import User
    from datetime import datetime

    class Category(models.Model):
    name = models.CharField(max_length=60)
    def __unicode__(self):
        return self.name

   class Tags(models.Model):
    name = models.CharField(max_length=60)
    def __unicode__(self):
        return self.name

   class Post(models.Model):
    title = models.CharField(max_length=120)
    slug = models.SlugField(max_length=120, unique=True)
    description = models.TextField()
    body = models.TextField()
    published = models.DateTimeField(default=datetime.now)
    categories = models.ForeignKey(Category)
    tags = models.ManyToManyField(Tags)
    def __unicode__(self):
        return self.title
    class Meta:
        ordering = ['-published']
    def get_absolute_url(self):
         return "/%s/%s/%s" % (self.published.year, self.published.month, self.slug) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:22:09.130

您后来添加了 SlugField 吗？如果是这样，syncdb 不会更新现有的数据库表。删除整个表并重新执行syncdb。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T20:26:54.967

错误很简单 - 您在给定的数据库表中没有列 slug。如果您稍后在模型中添加它，syncdb 不会修改表（此操作无法自动完成）。为此，请使用Django 必备应用程序[South应用程序。](http://south.readthedocs.org/en/latest/)

# asmx - Web服务错误“无法从传输连接读取数据”偶尔/随机且无明显原因

> ID：12876604
> 
> 赞同：1
> 
> 时间：2012-10-13T20:15:25.503
> 
> 标签：asmx, pocketpc

我有一个通过 asmx Web 服务发送和接收数据的 PocketPC 设备。在大多数情况下，这可以正常工作，但它会随机失败，并出现“无法从传输连接读取数据”的错误。问题是，这没有押韵或理由。有时它会持续数周而没有麻烦，而有时它会每周发生一次，或每周发生几次。

阅读有关此错误的信息，我发现它可能是连接问题或包含太多数据的数据包或类似的东西，但在所有情况下，我发现错误似乎一直在发生。我的问题是它很少发生。知道什么会导致这种情况间歇性发生吗？

# ios - 使用 UIScrollView 进行动画无限滚动

> ID：12876605
> 
> 赞同：1
> 
> 时间：2012-10-13T20:15:33.197
> 
> 标签：ios, animation, uiscrollview, infinite

我正在制作一个动画无限滚动视图，并且我使用了Apple 的[StreetScroller](http://developer.apple.com/library/ios/#samplecode/StreetScroller/Introduction/Intro.html)示例。我正在添加一个带有 NSTimer（1 秒间隔）的动画，调用一个 1 秒的动画，我正在设置滚动视图的内容偏移量（40 像素左右）。它工作得很好，但是当调用该方法时会出现问题，该方法`recenterIfNecessary`基本上重置了`contentOffset`滚动视图，但它也是动画的，所以看起来滚动视图“展开”回到中心，然后恢复动画。我猜我应该在重新定位时取消动画，但我不确定如何。

使用 NSTimer 调用的代码：

```
- (void)performScroll {
    CGFloat currentOffset = self.horizontal ? self.contentOffset.x : self.contentOffset.y;
    CGFloat newOffset = currentOffset + self.kActualPixelsPerSecond;
    CGPoint offsetPoint;
    if (self.horizontal)
        offsetPoint = CGPointMake(newOffset, 0.0);
    else
        offsetPoint = CGPointMake(0.0, newOffset);

    [UIView animateWithDuration:kScrollingTimeInterval
                          delay:0
                        options:UIViewAnimationOptionCurveLinear | UIViewAnimationOptionBeginFromCurrentState
                     animations:^{
                                [self setContentOffset:offsetPoint animated:NO];
                     } completion:nil];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-26T04:37:10.457

这个答案可能为时已晚。当我尝试构建无限滚动视图时，我也遇到了同样的情况。

我找到的解决方案是：

1.  制作一个标志来指示滚动视图是否在程序化滚动下，并检查每个重新定位器的标志。如果该标志打开，则应丢弃重新定位器。

2.  使用 CADisplayLink 以编程方式实现滚动。如果您想要动画曲线不仅仅是线性的，您可以在这里创建自己的计时函数。

3.  在每个程序化滚动结束时，另外调用recenter。

# android - 如何检查Android手机是否在没有gps的情况下移动

> ID：12876606
> 
> 赞同：1
> 
> 时间：2012-10-13T20:15:32.653
> 
> 标签：android, geolocation, accelerometer, android-sensors, gyroscope

我们想构建一个 Android 应用程序。

对于我们的想法，我们需要知道用户是否移动了。

这并不重要，如果用户移动了 3 或 10 米（10 - 30 英尺），但它应该超过半米（所以超过 1.5 英尺） - 所以用户应该真正离开它的位置，而不仅仅是移动它的与手机的手向相反的方向。

我知道[android 传感器](http://developer.android.com/reference/android/hardware/SensorManager.html)，但我是 android 编程的新手，我需要一点提示，如果用户移动了，最好的检查方法是什么。
wifi 信号水平的 GPS 不是一个选项，我们想使用大多数手机都有的典型安卓传感器。

在[此演示文稿](https://docs.google.com/viewer?url=http://www.touchqode.com/misc/20101025_jsug/20101025_touchqode_sensors.pdf)中，第 8 页提到，使用陀螺仪的设备并不多，但数据来自 2010 年。

现在我们有了 2012 年——它仍然是真的吗？推荐使用什么？

有没有一个框架已经解决了这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:33:21.703

> ...它应该超过半米（所以超过 1,5 英尺） - 所以用户应该真正离开它的位置，而不仅仅是将手机的手移到相反的方向。

你做不到。无论您做什么，我总能找到一种方法来欺骗您的临时解决方法。

原因是[准确性](https://stackoverflow.com/a/7835988/341970)。我还在那个答案中给出了一些替代方案，您可以尝试什么，具体取决于您的应用程序。

# hadoop - 在 MapReduce 中以最佳方式执行 HBase 查询

> ID：12876610
> 
> 赞同：3
> 
> 时间：2012-10-13T20:16:05.363
> 
> 标签：hadoop, mapreduce, hbase, cloudera

问题

我们有多个 HBase 表：A、B、C。假设 A 是需要处理的记录队列。它平均可以包含 2500 万条记录。A 有用户 ID。B 有每个用户执行的网站点击。B 可以包含数十亿行。C 有一些关于用户的次要信息。

我们使用 MapReduce 作业对队列中的记录执行预测分析（成千上万的决策树）。问题的范围不包括实际的分析建模。

问题

1.  MR 作业正在对表 B 和 C 执行即席查询。例如，Map 任务 1 执行查询以获取用户 1 的命中，而 Map 任务 2 执行查询以获取用户 2 的命中。如果这些命中最终在同一区域服务器中，将它会妨碍性能（比赛条件等）吗？是否有像 ChainMapper (ChainReducer) 这样的模式来拆分输入集，以便每个映射器具有跨越一个区域服务器的键？
2.  我最初的想法是让队列包含所有必需的输入（来自 b 和 c 的结果）。此输入将被压缩（仅用于建模）。这种方法将避免执行即席查询（同时通过多个地图任务跨区域服务器）。

欢迎任何其他建议。

我们正在使用 cloudera CDH 3（hadoop、hbase）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T19:57:06.450

这不是很容易解决，但我可以建议使用bloomfilter + reduce join。

构建bloomfilter和B的受影响区域集

```
Map: A -> BF(A), S = {regions of B} 
```

使用自定义的 InpufFormat，它将使用受影响的区域进行 B 表扫描，并扫描整个表 A

```
Map: B U S -> (tag 'B', keyB => value)
     A -> (tag 'A', keyA => value)
Reduce: reduce-join 
```

在 Reduce 中做你的分析工作。

# java - 调整应用程序窗口大小时，如何调整应用程序内的图像大小？

> ID：12876615
> 
> 赞同：2
> 
> 时间：2012-10-13T20:17:12.390
> 
> 标签：java, image, swing, resize

当我最大化我的应用程序时，JPanel 内部的图像不会随之调整大小。如何在窗口最大化时调整 JPanel 及其内容？

编辑：我正在使用 BufferedImage

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-13T20:40:46.903

这是一个开放式问题。

您想缩放以填充或缩放以适合该区域还是不关心纵横比？

比例填充和比例适合之间的区别

![在此处输入图像描述](../Images/43b74b1d574aebf4d9071fac5b30c434.png) ![在此处输入图像描述](../Images/54f8512b444ed43738cc3858877f411c.png)

此示例将对帧大小的变化做出反应并实时重新缩放图像。

```
public class TestScaling {

    public static void main(String[] args) {
        new TestScaling();
    }

    public TestScaling() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new ScalingPane());
                frame.setSize(200, 200);
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });
    }

    public class ScalingPane extends javax.swing.JPanel {

        private BufferedImage image;

        public ScalingPane() {
            try {
                image = ImageIO.read(getClass().getResource("/AtDesk.png"));
            } catch (IOException ex) {
                ex.printStackTrace();
            }    
            setBackground(Color.red);
        }

        public double getScaleFactor(int iMasterSize, int iTargetSize) {    
            double dScale = 1;
            dScale = (double) iTargetSize / (double) iMasterSize;

            return dScale;    
        }

        public double getScaleFactorToFit(Dimension original, Dimension toFit) {    
            double dScale = 1d;

            if (original != null && toFit != null) {    
                double dScaleWidth = getScaleFactor(original.width, toFit.width);
                double dScaleHeight = getScaleFactor(original.height, toFit.height);

                dScale = Math.min(dScaleHeight, dScaleWidth);
            }    
            return dScale;
        }

        public double getScaleFactorToFill(Dimension masterSize, Dimension targetSize) {
            double dScaleWidth = getScaleFactor(masterSize.width, targetSize.width);
            double dScaleHeight = getScaleFactor(masterSize.height, targetSize.height);

            double dScale = Math.max(dScaleHeight, dScaleWidth);

            return dScale;
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            double scaleFactor = Math.min(1d, getScaleFactorToFit(new Dimension(image.getWidth(), image.getHeight()), getSize()));
//            double scaleFactor = Math.min(1d, getScaleFactorToFill(new Dimension(image.getWidth(), image.getHeight()), getSize()));

            int scaleWidth = (int) Math.round(image.getWidth() * scaleFactor);
            int scaleHeight = (int) Math.round(image.getHeight() * scaleFactor);

            Image scaled = image.getScaledInstance(scaleWidth, scaleHeight, Image.SCALE_SMOOTH);

            int width = getWidth() - 1;
            int height = getHeight() - 1;

            int x = (width - scaled.getWidth(this)) / 2;
            int y = (height - scaled.getHeight(this)) / 2;

            g.drawImage(scaled, x, y, this);
        }
    }
} 
```

更好的解决方案是使用某种背景线程，它可以对组件大小的变化做出反应，并在背景中重新缩放原始图像，从而提供低质量和高质量的比例。

还应该注意的`Image.getScaledInstance`是，这既不是最快的也不是最高质量的缩放算法。查看[Image.getScaledInstance 的风险以](http://today.java.net/pub/a/today/2007/04/03/perils-of-image-getscaledinstance.html)获取更多信息。

您可能还会发现以下感兴趣的内容

[Java：保持JPanel背景图像的纵横比](https://stackoverflow.com/questions/11959758/java-maintaining-aspect-ratio-of-jpanel-background-image/11959928#11959928)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T20:25:49.967

一种粗暴的方式..

```
public void paintComponent(Graphics g) {
    super.paintComponent(g);
    g.draw(image,0,0,getWidth(),getHeight(),this);
    // .. 
```

# apache - 使用 .htaccess 将多个子域（http 和 https）转换为 www.domain.com

> ID：12876620
> 
> 赞同：1
> 
> 时间：2012-10-13T20:17:35.637
> 
> 标签：apache, .htaccess, redirect, subdomain

我有十几个已被 Google 索引的旧子域。我的网站的部分内容不仅被编入索引，而且还被编入了 http 和 https 的索引。

我已经设法正确重定向所有子域，前提是它们不是 https，但不能让任何 https 子域进行属性重定向。

这是我正在使用的代码：

```
RewriteCond %{HTTP_HOST} ^subdomain1.mysite.com$ [NC]
RewriteRule ^(.*)$ http://www.mysite.com/$1 [R=301,L]

RewriteCond %{HTTP_HOST} ^subdomain2.mysite.com$ [NC]
RewriteRule ^(.*)$ http://www.mysite.com/$1 [R=301,L]

RewriteCond %{HTTP_HOST} ^subdomain3.mysite.com$ [NC]
RewriteRule ^(.*)$ http://www.mysite.com/$1 [R=301,L] 
```

这很好用，直到有人去：[https://subdomain2.mysite.com](https://subdomain2.mysite.com) $ 未重定向回[http://www.mysite.com](http://www.mysite.com) $

我怎样才能让它工作？另外，我猜有比设置十几对重写条件/重写规则更简单的方法吗？有什么方法可以在几行中做到这一点，包括我列出所有子域的那一行？

任何建议都会很棒，是的，我在这里浏览了几十个线程来寻找答案并测试了提供的各种提示，尽管我看到的问题都与这种确切情况无关。

谢谢！

# jquery - jQuery：为什么我的延迟不起作用？

> ID：12876622
> 
> 赞同：1
> 
> 时间：2012-10-13T20:18:04.140
> 
> 标签：jquery

我有两个图像滑出然后我希望我的内容 div 在图像消失后淡入。动画有效并且被称为只是不是延迟部分:(

任何想法为什么这不起作用？

```
function mepage(){
var ele = document.getElementById("btn2");
var ele = document.getElementById("btn3");
var mycont = document.getElementById("mycontent");
if(ele.style.display == "inline-block") {
    $("#btn2").slideUp(1000);
    $("#btn3").slideUp(1000);
    $("#mecontent").delay(1000).css("visibility","visible").fadeIn(400);

}
else {
    $("#btn2").slideDown(1000);
    $("#btn3").slideDown(1000);
    $("#mecontent").css("visibility","hidden");
    ele.style.display = "inline-block";
} 
```

}

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T20:20:05.963

很少有函数被 jQuery 排队并且`css`不在其中。

你可以这样做：

```
$("#btn2").slideUp(1000);
$("#btn3").slideUp(1000, function() {
    $("#mecontent").css("visibility","visible").fadeIn(400);
}); 
```

或者，因为我不知道您为什么在 fadeIn 之前更改了可见性：

```
$("#btn2").slideUp(1000);
$("#btn3").slideUp(1000, function() {
    $("#mecontent").fadeIn(400);
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-13T20:20:51.497

该`.css`函数没有放在动画队列中，所以它会立即发生。请参阅[此答案](https://stackoverflow.com/a/10973084/6782)以获取允许您对其进行排队的插件。

也就是说，最好只使用“完成”功能，并使用`.show()`和`.hide()`更改元素的可见性：

```
if ($(ele).is(':visible')) {
    $("#btn2,#btn3").slideUp(1000, function() {
        $("#mecontent").delay(1000).fadeIn(400);
    });
} else {
    $("#btn2,#btn3").slideDown(1000, function() {
        $("#mecontent").hide();
    });
} 
```

# php - MySQLI 查询未显示所有带参数的链接

> ID：12876623
> 
> 赞同：0
> 
> 时间：2012-10-13T20:18:19.833
> 
> 标签：php, mysqli

我的 mysqli 查询仅显示 1 个链接，而原始 mysql 查询显示全部 6 个；知道为什么会发生这种情况吗？在显示链接的查询中，我有两个参数。一是启用值必须等于 1；第二个是管理页面的权限值等于或小于3。这是我在管理页面上没有遇到问题的旧查询：Old Mysql Query

```
 <?php  
        $result=mysql_query("SELECT * FROM navigation WHERE enabled='1' AND permission<='3'");
                while ($row=
                mysql_fetch_array($result))
                    {
                    echo '<li>';
                    echo $row['link'];
                    echo '</li>';
                    }

        ?> 
```

它显示了与变量匹配的所有链接。我的新 Mysqli 查询：

```
 $db = new mysqli($host, $user, $pass, $dbname);
    if(mysqli_connect_errno())
{
    die('The connection to the database could not be established.');
}   
$query = 'SELECT * FROM navigation where enabled="1"';
$result = $db->query($query);
$total_results = $result->num_rows;
while ($row = $result->fetch_object());
{
    echo '<li>';
                echo $row->link;
                echo '</li>';
            }
?> 
```

此查询仅显示第一个链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:43:35.060

所以这是一个答案。它解决了我的第一个问题并给了我一个新问题。

```
 <?php
$server = "****";
    $user = "****";
    $pass = "*****";
    $webdb = "****";
    $db = new mysqli($host, $user, $pass, $dbname);
    if(mysqli_connect_errno())
{
    die('The connection to the database could not be established.');
}   
$query = 'SELECT * FROM navigation where enabled="1"';
$result = $db->query($query);
$total_results = $result->num_rows;
while ($row = $result->fetch_object())
{
    echo '<li>';
                echo $row->link;
                echo '</li>';
                }

                            $result->free();

?> 
```

是显示所有设置为启用的链接的代码。如果添加到查询中，我的 <=3 变量不会显示任何链接，并且现在没有显示网页的其余部分。当我找到更多信息时，我会更新。

# android - AlertDialog 中的多个 EditText 对象

> ID：12876624
> 
> 赞同：49
> 
> 时间：2012-10-13T20:18:24.100
> 
> 标签：android, google-maps, dialog, android-edittext

我正在为大学做一个项目，让用户在地图上放置一个点，然后为覆盖对象设置标题和描述。问题是，第二个`EditText`框会覆盖第一个框。这是我的对话框代码。

```
//Make new Dialog
AlertDialog.Builder dialog = new AlertDialog.Builder(mapView.getContext());
dialog.setTitle("Set Target Title & Description");
dialog.setMessage("Title: ");

final EditText titleBox = new EditText(mapView.getContext());
dialog.setView(titleBox);

dialog.setMessage("Description: ");
final EditText descriptionBox = new EditText(mapView.getContext());
dialog.setView(descriptionBox); 
```

任何帮助，将不胜感激！！谢谢！

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2012-10-13T20:28:11.953

一个对话框只包含一个根视图，这就是`setView()`覆盖第一个 EditText 的原因。解决方案很简单，将所有内容放在一个 ViewGroup 中，例如 LinearLayout：

```
Context context = mapView.getContext();
LinearLayout layout = new LinearLayout(context);
layout.setOrientation(LinearLayout.VERTICAL);

// Add a TextView here for the "Title" label, as noted in the comments
final EditText titleBox = new EditText(context);
titleBox.setHint("Title");
layout.addView(titleBox); // Notice this is an add method

// Add another TextView here for the "Description" label
final EditText descriptionBox = new EditText(context);
descriptionBox.setHint("Description");
layout.addView(descriptionBox); // Another add method

dialog.setView(layout); // Again this is a set method, not add 
```

（这是一个基本示例，但它应该可以帮助您入门。）

您应该注意 a`set`和`add`方法之间的命名差异。`setView()`仅持有一个 View，对于`setMessage()`. 事实上，这对于每种`set`方法都应该是正确的，你所想的是`add`命令。 `add`方法是累积的，它们会构建您推送的所有内容的列表，而`set`方法是单一的，它们会替换现有数据。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-13T20:51:34.763

您可以构建包含两个 EditText 的布局，使用 a 对其进行膨胀并将`LayoutInflater`其用作`AlertDialog`.

```
LayoutInflater factory = LayoutInflater.from(this);

//text_entry is an Layout XML file containing two text field to display in alert dialog
final View textEntryView = factory.inflate(R.layout.text_entry, null);

final EditText input1 = (EditText) textEntryView.findViewById(R.id.EditText1);
final EditText input2 = (EditText) textEntryView.findViewById(R.id.EditText2);

input1.setText("DefaultValue", TextView.BufferType.EDITABLE);
input2.setText("DefaultValue", TextView.BufferType.EDITABLE);

final AlertDialog.Builder alert = new AlertDialog.Builder(this);
alert.setIcon(R.drawable.icon).setTitle("EntertheText:").setView(textEntryView).setPositiveButton("Save",
  new DialogInterface.OnClickListener() {
   public void onClick(DialogInterface dialog,
     int whichButton) {

    Log.i("AlertDialog","TextEntry 1 Entered "+input1.getText().toString());
    Log.i("AlertDialog","TextEntry 2 Entered "+input2.getText().toString());
    /* User clicked OK so do some stuff */
   }
  }).setNegativeButton("Cancel",
  new DialogInterface.OnClickListener() {
   public void onClick(DialogInterface dialog,
     int whichButton) {
     /*
     * User clicked cancel so do some stuff
     */
   }
  });
alert.show(); 
```

![在此处输入图像描述](../Images/02381b877ed774a580b551f025287c09.png)

您也可以像这样以编程方式添加您的 EditText：

```
LinearLayout layout = new LinearLayout(mapView.getContext());
layout.setOrientation(LinearLayout.VERTICAL);

final EditText titleBox = new EditText(mapView.getContext());
titleBox.setHint("Title");
layout.addView(titleBox);

final EditText descriptionBox = new EditText(mapView.getContext());
descriptionBox.setHint("Description");
layout.addView(descriptionBox);

dialog.setView(layout); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-27T16:32:37.917

```
val alert = AlertDialog.Builder(this)
    alert.setTitle("Buy Airtime")
    alert.setMessage("Enter phone details and amount to buy airtime.")

    val layout = LinearLayout(this)
    layout.orientation = LinearLayout.VERTICAL

    val mobileNoET = EditText(this)
    mobileNoET.setSingleLine()
    mobileNoET.hint = "Mobile Number"
    layout.addView(mobileNoET)

    val amountET = EditText(this)
    amountET.setSingleLine()
    amountET.hint = "Amount"
    layout.addView(amountET)

    val networkET = EditText(this)
    networkET.setSingleLine()
    networkET.hint = "Network"
    layout.addView(networkET)

    layout.setPadding(50, 40, 50, 10)

    alert.setView(layout)

    alert.setPositiveButton("Proceed") { _, _ ->
        val mobileNo = mobileNoET.text.toString()
        val amount = amountET.text.toString()
        val network = networkET.text.toString()

        Log.i("xxx",mobileNo )
        Log.i("xxx",amount )
        Log.i("xxx",network )

        Toast.makeText(this, "Saved Sucessfully", Toast.LENGTH_LONG).show()
    }

    alert.setNegativeButton("Cancel") { dialog, _ ->
        dialog.dismiss()
    }

    alert.setCancelable(false)
    alert.show() 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-07-13T19:06:52.240

使用 Xamarin 创建带有两个 EditText 的弹出窗口的代码

```
 public void dial()
    {

        AlertDialog alerta = new AlertDialog.Builder(this).Create();
        LinearLayout layout = new LinearLayout(this);

                   layout.Orientation = Orientation.Vertical;

        EditText factinput = new EditText(this);
        alerta.SetMessage("Facturas Disponibles:");
        layout.AddView(factinput);

        EditText canttinput = new EditText(this);
        alerta.SetMessage("Cantidad:");
        layout.AddView(canttinput);

        alerta.SetView(layout);

        alerta.SetButton("Cancelar", (a, b) =>
        {

            AlertDialog cencelacion = new AlertDialog.Builder(this).Create();
            cencelacion.SetMessage("Desea Cancelar");
            cencelacion.SetButton("OK", (c, d) => { });
            cencelacion.Show();

        });
        alerta.SetButton2("Aceptar", (ee, f) =>
        {
            AlertDialog confirmacion = new AlertDialog.Builder(this).Create();
            confirmacion.SetMessage("Realizar Busqueda de Factura");
            confirmacion.SetButton("OK", (c, d) => { });
            confirmacion.Show();
        }
        );

        alerta.Show();

    } 
```

# jquery - jQuery，我如何获得选择的位置？

> ID：12876628
> 
> 赞同：2
> 
> 时间：2012-10-13T20:19:06.947
> 
> 标签：jquery

我正在尝试获取在 select 语句中选择的任何日期 (1-12) 的值。

选择：

```
 <select id="month"></select> 
```

填充了这个：

```
 $(function(){
        $.ajax({
            type: "GET",
            url: "lib/getmonth.php",
            async: "false",
            success: function(response){
                var monthArry = response.split(",");
                for(var x=0; x < [monthArry.length-1]; x++){
                    $("#month").append("<option>" + monthArry[x] + "</option>");
                }
            }
        });
    }); 
```

我在这里不知所措，我显然可以得到名字，

```
 var month = $("#month").val(); 
```

但我不确定如何选择哪个“选项”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:21:34.333

您可以使用[:selected](http://api.jquery.com/selected-selector/)选择器：

```
var selectedOption = $("#month option:selected"); 
```

**编辑：**如果您正在寻找所选选项的内部文本，您可以将[text()](http://api.jquery.com/text/)应用于结果：

```
var selectedOptionText = $("#month option:selected").text(); 
```

如果你想要它的基于 1 的索引，你可以添加到[index()](http://api.jquery.com/index/)`1`返回的值：

```
var selectedMonth = $("#month option:selected").index() + 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T20:28:21.140

它为我工作[jsfiidle](http://jsfiddle.net/3yu4p/)。

简化的成功方法。

```
success: function(response){
       $("#month").append('<option>' +  response.split(",").join("</option><option>") + "</option>");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T20:31:29.123

如果您想知道 selected 的索引`option`：

```
var selectedOption = $('#month option:selected').index(); 
```

或者，使用纯 JavaScript：

```
var selectedOption = document.getElementById('month').selectedIndex; 
```

# jsp - 从java bean获取属性

> ID：12876632
> 
> 赞同：0
> 
> 时间：2012-10-13T20:19:46.973
> 
> 标签：jsp, jstl, javabeans

我是 jstl 的新手，所以这个问题可能听起来有点愚蠢：我正在尝试使用 jsp-tag 从我的文本数据库中获取与某个键相关的文本。

它应该像这样工作：

```
<c:getText key="myText" /> 
```

这可能吗？

编辑：我知道 jstl 中没有这样的 getText-Tag。这正是我想做的。我正在为我的文本使用一个简单的属性文件。我所需要的只是给任何标签一个键，标签给我与键相关的文本。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:34:37.163

如果文本在`java.util.Properties`对象中，您甚至不需要标签。将 Properties 对象存储在请求属性中（`myProperties`例如 ），并使用以下 EL 表达式：

```
${myProperties.myText} 
```

或者，如果键包含不能在 Java 标识符中使用的字符：

```
${myProperties['my text']} 
```

如果您仍想编写自定义标记，那么在谷歌上搜索“自定义 JST 标记”会导致以下教程：[http ://docs.oracle.com/javaee/5/tutorial/doc/bnalj.html](http://docs.oracle.com/javaee/5/tutorial/doc/bnalj.html)

# mysql - 如何更改参与外键的索引？

> ID：12876640
> 
> 赞同：1
> 
> 时间：2012-10-13T20:20:46.863
> 
> 标签：mysql, sql

我想将 an 修改`index(col1, col2, col3)`为 an`index(col1)`而不会激怒`col1`. 我该怎么做？

我的方法是删除并创建索引。但是它在执行时使外键失败。升级和还原架构的步骤是什么？

* * *

原来的：

```
 `sid` int(11) NOT NULL DEFAULT '0',
  `cid` int(11) NOT NULL DEFAULT '0',
  `uid` int(11) NOT NULL DEFAULT '0',
  ...
  UNIQUE KEY `User_sid` (`sid`,`cid`,`uid`),
  ...
  CONSTRAINT `User_ibfk_1` FOREIGN KEY (`sid`) REFERENCES `SolrMap` (`sid`) 
```

客观的：

```
 ...,
  `sid` int(11) NOT NULL DEFAULT '0',
  `cid` int(11) NOT NULL DEFAULT '0',       ####ONE LESS COLUMN
  `password_reset_valid_until` datetime DEFAULT NULL,
  `password_reset_id` char(24) DEFAULT NULL,
  ...
  KEY `User_sid` (`sid`)  ####NEW KEY
  ####WANT NEW FOREIGN KEY 
```

这就是我尝试但失败的方法：

```
ALTER TABLE `User` 
        DROP INDEX `User_sid`, 
        ADD INDEX `User_sid` (`sid`) USING BTREE,
        DROP COLUMN `uid`; 
```

这就是它失败的原因：

```
------------------------
LATEST FOREIGN KEY ERROR
------------------------
121013  8:27:39 Error in foreign key constraint of table friday/User:
there is no index in the table which would contain
the columns as the first columns, or the data types in the
table do not match the ones in the referenced table
or one of the ON ... SET NULL columns is declared NOT NULL. Constraint:
,
  CONSTRAINT "User_ibfk_1" FOREIGN KEY ("sid") REFERENCES "SolrMap" ("sid")
InnoDB: Renaming table `friday`.<result 2 when explaining filename '#sql-6fd_2f12e'> to `friday`.`User` failed! 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:26:50.330

您是否尝试过禁用外键检查或约束

```
 SET foreign_key_checks = 0;

 ALTER TABLE `User` 
    DROP INDEX `User_sid`, 
    ...........

 SET foreign_key_checks = 1; 
```

阅读更多[http://gauravsohoni.wordpress.com/2009/03/09/mysql-disable-foreign-key-checks-or-constraints/](http://gauravsohoni.wordpress.com/2009/03/09/mysql-disable-foreign-key-checks-or-constraints/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T14:47:59.120

```
ALTER TABLE `User` 
        ADD INDEX `idx_sid` (`sid`) USING BTREE,
        DROP INDEX `User_sid`, 
        DROP COLUMN `uid`; 
```

这确保我们在删除旧索引`sid` **之前仍然有一个索引。**

* * *

来自[http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html](http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html)：

> InnoDB 需要外键和引用键上的索引，以便外键检查可以快速且不需要表扫描。在引用表中，**必须有一个索引，其中外键列按相同顺序列为第一列**。如果引用表不存在，则会在引用表上自动创建此类索引。如果您创建另一个可用于强制外键约束的索引，则此索引可能会在稍后被静默删除。index_name，如果给定，如前所述使用。

# scala - Scala 编译器错误：“需要标识符，但找到整数文字”。为什么？

> ID：12876646
> 
> 赞同：2
> 
> 时间：2012-10-13T20:21:57.233
> 
> 标签：scala

代码很明显，我看不出它有什么问题。

```
object TestX extends App {

  val l= List[String]( "a","b","c" )
  val n= l.size

  def f( i:Int )= l[(i+1)%n ]
} 
```

编译器输出（Scala 2.9.2）：

```
  fsc -deprecation -d bin src/xxx.scala
  src/xxx.scala:11：错误：需要标识符，但找到整数文字。
    def f( i:Int )= l[(i+1)%n]
                         ^

```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-13T20:25:34.560

方括号`[`，`]`在 Scala 中用于声明或应用*类型参数*。在序列或数组中获取元素是可以省略的`apply(index: Int)`方法。`apply`因此：

```
def f(i:Int) = l.apply((i + 1) % n) 
```

或短

```
def f(i:Int) = l((i + 1) % n) 
```

* * *

请注意，`apply`这`size`需要`List`时间 O(N)，因此如果您经常需要这些操作来处理大型列表，请考虑`Vector`改用。

# iphone - NSDictionary writeToURL

> ID：12876647
> 
> 赞同：1
> 
> 时间：2012-10-13T20:21:58.087
> 
> 标签：iphone, nsdictionary

有人可以解释一下这是做什么的。我希望它写一个对诸如网络服务器之类的 URL 的顺从。如果不是我怎么能完成这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:32:24.513

`NSURL`对象用于描述 URL - 但“URL”不一定是 HTTP 链接。它可以很容易地成为指向本地文件系统或网络文件资源的指针。

该`writeToURL`方法用于将字典保存到本地文件系统。如果需要，您可以将字典的 PLIST 表示发送到您运行的服务器，但您必须编写客户端网络代码和（更重要的是）服务器端逻辑来接收它。

# c - fscanf() 没有像我预期的那样工作

> ID：12876651
> 
> 赞同：0
> 
> 时间：2012-10-13T20:22:35.383
> 
> 标签：c

这是打开文件然后读取其内容的代码（位于函数内部）`fscanf()`：

```
FILE *file = NULL;
int xTemp = 0, xTot = 0;
int yTemp = 0, yTot = 0;
int zTemp = 0, zTot = 0;
int i = 0;

file = fopen(nomeFile, "r");

if(file == NULL) {

    return 0;

} else {

    while(!feof(file)) {

        if(fscanf(file, "%f %f %f", &xTemp, &yTemp, &zTemp) != 3) {

            return -1;

        } else {

            i++;
            xTot += xTemp;
            yTot += yTemp;
            zTot += zTemp;

        }

    }

    coords.x = xTot/i;
    coords.y = yTot/i;
    coords.z = zTot/i;

    return i;

} 
```

这是我正在阅读的文件的内容`fscanf()`：

```
3.5 2.1 -1.4
4.1 -4.1 2.9
2.6 2.5 3.2
-1.2 0.0 4.3
1.5 1.3 6.0 
```

问题是它`fscanf()`不会分配给`xTemp`,`yTemp`和`zTemp`正确的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:24:50.660

您的格式字符串指定了 3 个`float`值，但您将指针传递给`int`. 您应该会看到有关使用不同类型的编译器警告。

如果要读取`float`，则使用`float`变量来接收数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T20:25:26.797

使用浮点变量而不是`int`s。在`fscanf`您使用`%f`但变量是调用未定义行为的整数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T20:27:25.300

您将变量声明为`int`,

```
int xTemp = 0, xTot = 0;
int yTemp = 0, yTot = 0;
int zTemp = 0, zTot = 0; 
```

但是将它们扫描为`float`s，因此这些值是`float`s 解释为的位表示`int`（尽管它是未定义的行为，因此也可能发生其他任何事情）。

此外，您的循环控制是错误的，

```
while(!feof(file)) {

    if(fscanf(file, "%f %f %f", &xTemp, &yTemp, &zTemp) != 3) {

        return -1;

    } 
```

总会回来`-1`的。*只有在您尝试从文件末尾读取数据后*`feof(file)`才会变为真，因此循环将在读取最后一行后再次运行，然后不再读取三个值。*`fscanf`*

 *更好的循环控制将是

```
while(fscanf(file, "%f %f %f", &xTemp, &yTemp, &zTemp) == 3) 
```*

# javascript - 在调用它们之前修改回调函数的参数

> ID：12876654
> 
> 赞同：1
> 
> 时间：2012-10-13T20:22:49.367
> 
> 标签：javascript, parameters, callback, dom-events

我有一个自定义对象，它实现了稍后将执行的功能。有人会这样称呼它：

```
customObject.onSomething(function(e) {
    // do something with e
    console.log('foobar');
}); 
```

以下是 onSomething 的创建方式：

```
var CustomObject = function() {
    this.onSomething = function(callback) {
        // If the user passes in parameter(s), how can I modify them before calling?
        callback.apply(this);
    }
} 
```

如何在对函数执行*应用*或*调用*之前修改用户传入的参数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-13T20:27:14.097

`apply`接受第二个参数，它是要传递给函数的参数列表。`call`做同样的事情，除了它传递自己的参数列表（第一个参数之后的所有内容`this`）。

因此，如果您知道您期望哪些参数，您可以将它们作为第二个参数添加到调用函数`apply`（或作为参数列表`call`）：

```
this.onSomething = function(arg1, arg2) {
   // reverse the first and second arguments
   callback.apply(this, [arg2, arg1]);
   // equivalent:
   callback.call(this, arg2, arg1);
}; 
```

如果你不知道期望什么样的参数，但你仍然想用它们做点什么，你可以使用内置的`arguments`伪数组来做，它保存了当前函数的参数（即使你没有声明他们明确地）。

您可以使用它来调用回调，并使用与调用函数相同的参数，或者对它们进行一些转换；例如：

```
this.onSomething = function() {
    // call callback with the same arguments we got
    callback.apply(this, arguments);

    // or, make some changes
    var newArgs = ["extra argument", arguments[1], arguments[0]];
    callback.apply(this, newArgs);
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T20:27:23.187

听起来你要的很简单，见下文：

```
var CustomObject = function() {
    this.onSomething = function(callback, param1, param2) {
        param1 += 4;
        param2 = 'Something about ' + param2 + ' is different...';
        callback.apply(this, [param1, param2]);
    }
} 
```

# c# - 在 WinRT 应用程序中处理两指、三指、四指滑动手势

> ID：12876655
> 
> 赞同：8
> 
> 时间：2012-10-13T20:23:11.270
> 
> 标签：c#, .net, xaml, windows-8, windows-runtime

我有以下代码：

```
private Point initialpoint;

private void ManipulationStarted(object sender, ManipulationStartedRoutedEventArgs e)
{
    initialpoint = e.Position;
}

private void ManipulationDelta(object sender, ManipulationDeltaRoutedEventArgs e)
{
    Point currentpoint = e.Position;
    if (currentpoint.X - initialpoint.X >= 100)
    {
        System.Diagnostics.Debug.WriteLine("Swipe Right");
        e.Complete();
    }
} 
```

我可以很容易地处理 1 个手指滑动手势，但我也想处理 2、3、4 个手指滑动手势。谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-14T00:52:02.020

根据this [MSDN Forum Posting](http://social.msdn.microsoft.com/Forums/en-US/toolsforwinapps/thread/7fddff93-71f6-4871-85b5-2c8bd69344e2)，您将需要使用[指针](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/windows.ui.input.pointerpoint.aspx)通知。**包含工作示例代码**的文档位于[MSDN 库中](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/jj150606.aspx#create_the_ui)

从最后一个链接：

> 指针对象表示来自输入设备（例如鼠标、笔/触笔、单指或多指）的单个唯一输入“接触”（PointerPoint）。系统在首次检测到接触时创建一个指针，并在指针离开（离开）检测范围或取消时销毁它。在多个设备或多点触控输入的情况下，每个接触都被视为唯一的指针。

* * *

请注意，我没有多点触控 Windows 8 设备来测试此代码。因此，它已经在 Simuator 中进行了所有限制的测试，并且如上述链接中所述，Windows 8 没有内置手势支持来检测多个手指，您必须使用较低级别的功能。

首先，我在上面的 MSDN 示例代码中添加了两个字典，并为您的 Swipe Threshold 添加了两个变量到类定义中。

```
Dictionary<uint, Point> startLocation;
Dictionary<uint, bool> pointSwiped;
int swipeThresholdX = 100;
int swipeThresholdY = 100; 
```

然后我在表单的构造函数中初始化字典

```
startLocation = new Dictionary<uint, Point>((int)SupportedContacts.Contacts);
pointSwiped = new Dictionary<uint, bool>((int)SupportedContacts.Contacts); 
```

然后，原始词典添加到或删除项目的每个地方我都对新词典的

添加：

```
startLocation[pt.PointerId] = pt.Position;
pointSwiped[pt.PointerId] = false; 
```

删除：

```
startLocation.Remove(pt.PointerId);
pointSwiped.Remove(pt.PointerId); 
```

然后最后把它们放在PointerMovedEvent中：

```
private void targetContainer_PointerMoved(object sender, PointerRoutedEventArgs e)
{
    Windows.UI.Input.PointerPoint currentPoint = e.GetCurrentPoint(targetContainer);
    if (currentPoint.IsInContact)
    {
        if (startLocation.ContainsKey(currentPoint.PointerId))
        {
            Point startPoint = startLocation[currentPoint.PointerId];
            if (Math.Abs(currentPoint.Position.X - startPoint.X) > swipeThresholdX) // I only did one Axis for testing
            {
                pointSwiped[currentPoint.PointerId] = true;
            }
        }
    }
    updateInfoPop(e);
} 
```

最终修改的 MSDN 示例：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using Windows.Foundation;
using Windows.Foundation.Collections;
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls;
using Windows.UI.Xaml.Controls.Primitives;
using Windows.UI.Xaml.Data;
using Windows.UI.Xaml.Input;
using Windows.UI.Xaml.Media;
using Windows.UI.Xaml.Navigation;

// The Blank Page item template is documented at http://go.microsoft.com/fwlink/?LinkId=234238

namespace PointerInput
{
    /// <summary>
    /// An empty page that can be used on its own or navigated to within a Frame.
    /// </summary>
    public sealed partial class MainPage : Page
    {
        Windows.Devices.Input.TouchCapabilities SupportedContacts = new Windows.Devices.Input.TouchCapabilities();

        uint numActiveContacts;
        Dictionary<uint, Windows.UI.Input.PointerPoint> contacts;
        Dictionary<uint, Point> startLocation;
        Dictionary<uint, bool> pointSwiped;
        int swipeThresholdX = 100;
        int swipeThresholdY = 100;

        public MainPage()
        {
            this.InitializeComponent();
            numActiveContacts = 0;
            contacts = new Dictionary<uint, Windows.UI.Input.PointerPoint>((int)SupportedContacts.Contacts);
            startLocation = new Dictionary<uint, Point>((int)SupportedContacts.Contacts);
            pointSwiped = new Dictionary<uint, bool>((int)SupportedContacts.Contacts);
            targetContainer.PointerPressed += new PointerEventHandler(targetContainer_PointerPressed);
            targetContainer.PointerEntered += new PointerEventHandler(targetContainer_PointerEntered);
            targetContainer.PointerReleased += new PointerEventHandler(targetContainer_PointerReleased);
            targetContainer.PointerExited += new PointerEventHandler(targetContainer_PointerExited);
            targetContainer.PointerCanceled += new PointerEventHandler(targetContainer_PointerCanceled);
            targetContainer.PointerCaptureLost += new PointerEventHandler(targetContainer_PointerCaptureLost);
            targetContainer.PointerMoved += new PointerEventHandler(targetContainer_PointerMoved);
        }

        // PointerPressed and PointerReleased events do not always occur in pairs. 
        // Your app should listen for and handle any event that might conclude a pointer down action 
        // (such as PointerExited, PointerCanceled, and PointerCaptureLost).
        void targetContainer_PointerPressed(object sender, PointerRoutedEventArgs e)
        {
            if (Convert.ToBoolean(SupportedContacts.TouchPresent) && (numActiveContacts > SupportedContacts.Contacts))
            {
                // cannot support more contacts
                eventLog.Text += "\nNumber of contacts exceeds the number supported by the device.";
                return;
            }

            Windows.UI.Input.PointerPoint pt = e.GetCurrentPoint(targetContainer);

            // Update event sequence.
            eventLog.Text += "\nDown: " + pt.PointerId;

            // Change background color of target when pointer contact detected.
            targetContainer.Fill = new SolidColorBrush(Windows.UI.Colors.Green);

            // Check if pointer already exists (if enter occurred prior to down).
            if (contacts.ContainsKey(pt.PointerId))
            {
                return;
            }
            contacts[pt.PointerId] = pt;
            startLocation[pt.PointerId] = pt.Position;
            pointSwiped[pt.PointerId] = false;
            ++numActiveContacts;
            e.Handled = true;

            // Display pointer details.
            createInfoPop(e);
        }

        private void targetContainer_PointerEntered(object sender, PointerRoutedEventArgs e)
        {
            Windows.UI.Input.PointerPoint pt = e.GetCurrentPoint(targetContainer);

            // Update event sequence.
            eventLog.Text += "\nOver: " + pt.PointerId;

            if (contacts.Count == 0)
            {
                // Change background color of target when pointer contact detected.
                targetContainer.Fill = new SolidColorBrush(Windows.UI.Colors.Blue);
            }

            // Check if pointer already exists (if enter occurred prior to down).
            if (contacts.ContainsKey(pt.PointerId))
            {
                return;
            }

            // Push new pointer Id onto expando target pointers array.
            contacts[pt.PointerId] = pt;
            startLocation[pt.PointerId] = pt.Position;
            pointSwiped[pt.PointerId] = false;
            ++numActiveContacts;
            e.Handled = true;

            // Display pointer details.
            createInfoPop(e);
        }

        // Fires for for various reasons, including: 
        //    - User interactions
        //    - Programmatic caputre of another pointer
        //    - Captured pointer was deliberately released
        // PointerCaptureLost can fire instead of PointerReleased. 
        private void targetContainer_PointerCaptureLost(object sender, PointerRoutedEventArgs e)
        {
            Windows.UI.Input.PointerPoint pt = e.GetCurrentPoint(targetContainer);

            // Update event sequence.
            eventLog.Text += "\nPointer capture lost: " + pt.PointerId;

            if (contacts.ContainsKey(pt.PointerId))
            {
                checkSwipe();
                contacts[pt.PointerId] = null;
                contacts.Remove(pt.PointerId);
                startLocation.Remove(pt.PointerId);
                if (pointSwiped.ContainsKey(pt.PointerId))
                    pointSwiped.Remove(pt.PointerId);

                --numActiveContacts;
            }

            // Update the UI and pointer details.
            foreach (TextBlock tb in pointerInfo.Children)
            {
                if (tb.Name == e.Pointer.PointerId.ToString())
                {
                    pointerInfo.Children.Remove(tb);
                }
            }

            if (contacts.Count == 0)
            {
                targetContainer.Fill = new SolidColorBrush(Windows.UI.Colors.Black);
            }

            e.Handled = true;
        }

        // Fires for for various reasons, including: 
        //    - A touch contact is canceled by a pen coming into range of the surface.
        //    - The device doesn't report an active contact for more than 100ms.
        //    - The desktop is locked or the user logged off. 
        //    - The number of simultaneous contacts exceeded the number supported by the device.
        private void targetContainer_PointerCanceled(object sender, PointerRoutedEventArgs e)
        {
            Windows.UI.Input.PointerPoint pt = e.GetCurrentPoint(targetContainer);

            // Update event sequence.
            eventLog.Text += "\nPointer canceled: " + pt.PointerId;

            if (contacts.ContainsKey(pt.PointerId))
            {
                checkSwipe();
                contacts[pt.PointerId] = null;
                contacts.Remove(pt.PointerId);
                startLocation.Remove(pt.PointerId);
                if (pointSwiped.ContainsKey(pt.PointerId))
                    pointSwiped.Remove(pt.PointerId);

                --numActiveContacts;
            }

            // Update the UI and pointer details.
            foreach (TextBlock tb in pointerInfo.Children)
            {
                if (tb.Name == e.Pointer.PointerId.ToString())
                {
                    pointerInfo.Children.Remove(tb);
                }
            }

            if (contacts.Count == 0)
            {
                targetContainer.Fill = new SolidColorBrush(Windows.UI.Colors.Black);
            }

            e.Handled = true;
        }

        private void targetContainer_PointerExited(object sender, PointerRoutedEventArgs e)
        {
            Windows.UI.Input.PointerPoint pt = e.GetCurrentPoint(targetContainer);

            // Update event sequence.
            eventLog.Text += "\nPointer exited: " + pt.PointerId;

            if (contacts.ContainsKey(pt.PointerId))
            {
                checkSwipe();
                contacts[pt.PointerId] = null;
                contacts.Remove(pt.PointerId);
                startLocation.Remove(pt.PointerId);
                if (pointSwiped.ContainsKey(pt.PointerId))
                    pointSwiped.Remove(pt.PointerId);

                --numActiveContacts;
            }

            // Update the UI and pointer details.
            foreach (TextBlock tb in pointerInfo.Children)
            {
                if (tb.Name == e.Pointer.PointerId.ToString())
                {
                    pointerInfo.Children.Remove(tb);
                }
            }

            if (contacts.Count == 0)
            {
                targetContainer.Fill = new SolidColorBrush(Windows.UI.Colors.Gray);

            }
            e.Handled = true;
        }

        /// <summary>
        /// Invoked when this page is about to be displayed in a Frame.
        /// </summary>
        /// <param name="e">Event data that describes how this page was reached.  The Parameter
        /// property is typically used to configure the page.</param>
        protected override void OnNavigatedTo(NavigationEventArgs e)
        {
        }

        void targetContainer_PointerReleased(object sender, PointerRoutedEventArgs e)
        {
            foreach (TextBlock tb in pointerInfo.Children)
            {
                if (tb.Name == e.Pointer.PointerId.ToString())
                {
                    pointerInfo.Children.Remove(tb);
                }
            }

            Windows.UI.Input.PointerPoint pt = e.GetCurrentPoint(targetContainer);

            // Update event sequence.
            eventLog.Text += "\nUp: " + pt.PointerId;

            // Change background color of target when pointer contact detected.
            targetContainer.Fill = new SolidColorBrush(Windows.UI.Colors.Red);

            if (contacts.ContainsKey(pt.PointerId))
            {
                checkSwipe();
                contacts[pt.PointerId] = null;
                contacts.Remove(pt.PointerId);
                startLocation.Remove(pt.PointerId);
                if(pointSwiped.ContainsKey(pt.PointerId))
                    pointSwiped.Remove(pt.PointerId);

                --numActiveContacts;
            }
            e.Handled = true;
        }

        private void targetContainer_PointerMoved(object sender, PointerRoutedEventArgs e)
        {
            Windows.UI.Input.PointerPoint currentPoint = e.GetCurrentPoint(targetContainer);
            if (currentPoint.IsInContact)
            {
                if (startLocation.ContainsKey(currentPoint.PointerId))
                {
                    Point startPoint = startLocation[currentPoint.PointerId];
                    if (Math.Abs(currentPoint.Position.X - startPoint.X) > swipeThresholdX) // I only did one Axis for testing
                    {
                        pointSwiped[currentPoint.PointerId] = true;
                    }
                }

            }
            updateInfoPop(e);
        }

        int numberOfSwipedFingers()
        {
            int count = 0;
            foreach (var item in pointSwiped)
            {
                if (item.Value) { count += 1; }
            }
            return count;
        }

        void checkSwipe()
        {
            int fingers = numberOfSwipedFingers();
            if (fingers > 1)
            {
                eventLog.Text += "\nNumber of Swiped fingers = " + fingers;
            }
            else if (fingers == 1)
            {
                eventLog.Text += "\nNumber of Swiped fingers = " + fingers;
            }
            if(fingers > 0)
                pointSwiped.Clear();
        }            

        void createInfoPop(PointerRoutedEventArgs e)
        {
            Windows.UI.Input.PointerPoint currentPoint = e.GetCurrentPoint(targetContainer);
            TextBlock pointerDetails = new TextBlock();
            pointerDetails.Name = currentPoint.PointerId.ToString();
            pointerDetails.Foreground = new SolidColorBrush(Windows.UI.Colors.White);
            pointerInfo.Children.Add(pointerDetails);
            pointerDetails.Text = queryPointer(e);
        }

        void updateInfoPop(PointerRoutedEventArgs e)
        {
            foreach (TextBlock pointerDetails in pointerInfo.Children)
            {
                if (pointerDetails.Name == e.Pointer.PointerId.ToString())
                {
                    pointerDetails.Text = queryPointer(e);
                }
            }
        }

        String queryPointer(PointerRoutedEventArgs e)
        {
            Windows.UI.Input.PointerPoint currentPoint = e.GetCurrentPoint(targetContainer);
            String details = "";
            switch (e.Pointer.PointerDeviceType)
            {
                case Windows.Devices.Input.PointerDeviceType.Mouse:
                    details += "\nPointer type: mouse";
                    break;
                case Windows.Devices.Input.PointerDeviceType.Pen:
                    details += "\nPointer type: pen";
                    if (e.Pointer.IsInContact)
                    {
                        details += "\nPressure: " + currentPoint.Properties.Pressure;
                        details += "\nrotation: " + currentPoint.Properties.Orientation;
                        details += "\nTilt X: " + currentPoint.Properties.XTilt;
                        details += "\nTilt Y: " + currentPoint.Properties.YTilt;
                        details += "\nBarrel button pressed: " + currentPoint.Properties.IsBarrelButtonPressed;
                    }
                    break;
                case Windows.Devices.Input.PointerDeviceType.Touch:
                    details += "\nPointer type: touch";
                    details += "\nrotation: " + currentPoint.Properties.Orientation;
                    details += "\nTilt X: " + currentPoint.Properties.XTilt;
                    details += "\nTilt Y: " + currentPoint.Properties.YTilt;
                    break;
                default:
                    details += "\nPointer type: n/a";
                    break;
            }

            GeneralTransform gt = targetContainer.TransformToVisual(page);
            Point screenPoint;

            screenPoint = gt.TransformPoint(new Point(currentPoint.Position.X, currentPoint.Position.Y));
            details += "\nPointer Id: " + currentPoint.PointerId.ToString() +
                "\nPointer location (parent): " + currentPoint.Position.X + ", " + currentPoint.Position.Y +
                "\nPointer location (screen): " + screenPoint.X + ", " + screenPoint.Y;
            return details;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-07T15:26:41.277

我将 Mark Hall 的答案改编为单独的课程，并处理向上、向下、向左和向右滑动。它仍然存在问题，您可以在不同时间抬起手指并获得多个事件并且可以改进，尽管它可以满足我的需求：

```
public enum DirectionSwiped
{
    None,
    Up,
    Down,
    Left,
    Right
}

public class SwipeEventArgs : EventArgs
{
    public DirectionSwiped Direction { get; set; }
    public int NumberOfTouches { get; set; }
}

public class SwipeGestureDetector
{
    public EventHandler<SwipeEventArgs> SwipeDetected;

    // How much of the grid needs to be covered by the swipe?
    private const double SWIPE_THRESHOLD = 0.5;

    // How much drift is allowed in the opposite axis?
    private const int ALLOWED_DRIFT = 100;

    Windows.Devices.Input.TouchCapabilities SupportedContacts = new Windows.Devices.Input.TouchCapabilities();

    uint numActiveContacts;
    Dictionary<uint, Windows.UI.Input.PointerPoint> contacts;
    Dictionary<uint, Point> startLocation;
    Dictionary<uint, DirectionSwiped> pointSwiped;

    private Grid mGrid;

    public SwipeGestureDetector(Grid grid)
    {
        mGrid = grid;

        numActiveContacts = 0;
        contacts = new Dictionary<uint, Windows.UI.Input.PointerPoint>((int)SupportedContacts.Contacts);
        startLocation = new Dictionary<uint, Point>((int)SupportedContacts.Contacts);
        pointSwiped = new Dictionary<uint, DirectionSwiped>((int)SupportedContacts.Contacts);
        grid.PointerPressed += new PointerEventHandler(Grid_PointerPressed);
        grid.PointerEntered += new PointerEventHandler(Grid_PointerEntered);
        grid.PointerReleased += new PointerEventHandler(Grid_PointerReleased);
        grid.PointerExited += new PointerEventHandler(Grid_PointerExited);
        grid.PointerCanceled += new PointerEventHandler(Grid_PointerCanceled);
        grid.PointerCaptureLost += new PointerEventHandler(Grid_PointerCaptureLost);
        grid.PointerMoved += new PointerEventHandler(Grid_PointerMoved);
    }

    // PointerPressed and PointerReleased events do not always occur in pairs. 
    // Your app should listen for and handle any event that might conclude a pointer down action 
    // (such as PointerExited, PointerCanceled, and PointerCaptureLost).
    void Grid_PointerPressed(object sender, PointerRoutedEventArgs e)
    {
        if (Convert.ToBoolean(SupportedContacts.TouchPresent) && (numActiveContacts > SupportedContacts.Contacts))
        {
            // cannot support more contacts
            Debug.WriteLine("\nNumber of contacts exceeds the number supported by the device.");
            return;
        }

        Windows.UI.Input.PointerPoint pt = e.GetCurrentPoint(mGrid);

        // Check if pointer already exists (if enter occurred prior to down).
        if (contacts.ContainsKey(pt.PointerId))
        {
            return;
        }
        contacts[pt.PointerId] = pt;
        startLocation[pt.PointerId] = pt.Position;
        pointSwiped[pt.PointerId] = DirectionSwiped.None;
        ++numActiveContacts;
        e.Handled = true;
    }

    private void Grid_PointerEntered(object sender, PointerRoutedEventArgs e)
    {
        Windows.UI.Input.PointerPoint pt = e.GetCurrentPoint(mGrid);

        // Check if pointer already exists (if enter occurred prior to down).
        if (contacts.ContainsKey(pt.PointerId))
        {
            return;
        }

        // Push new pointer Id onto expando target pointers array.
        contacts[pt.PointerId] = pt;
        startLocation[pt.PointerId] = pt.Position;
        pointSwiped[pt.PointerId] = DirectionSwiped.None;
        ++numActiveContacts;
        e.Handled = true;

    }

    // Fires for for various reasons, including: 
    //    - User interactions
    //    - Programmatic caputre of another pointer
    //    - Captured pointer was deliberately released
    // PointerCaptureLost can fire instead of PointerReleased. 
    private void Grid_PointerCaptureLost(object sender, PointerRoutedEventArgs e)
    {
        Windows.UI.Input.PointerPoint pt = e.GetCurrentPoint(mGrid);

        if (contacts.ContainsKey(pt.PointerId))
        {
            checkSwipe();
            contacts[pt.PointerId] = null;
            contacts.Remove(pt.PointerId);
            startLocation.Remove(pt.PointerId);
            if (pointSwiped.ContainsKey(pt.PointerId))
                pointSwiped.Remove(pt.PointerId);

            --numActiveContacts;
        }

        e.Handled = true;
    }

    // Fires for for various reasons, including: 
    //    - A touch contact is canceled by a pen coming into range of the surface.
    //    - The device doesn't report an active contact for more than 100ms.
    //    - The desktop is locked or the user logged off. 
    //    - The number of simultaneous contacts exceeded the number supported by the device.
    private void Grid_PointerCanceled(object sender, PointerRoutedEventArgs e)
    {
        Windows.UI.Input.PointerPoint pt = e.GetCurrentPoint(mGrid);

        if (contacts.ContainsKey(pt.PointerId))
        {
            checkSwipe();
            contacts[pt.PointerId] = null;
            contacts.Remove(pt.PointerId);
            startLocation.Remove(pt.PointerId);
            if (pointSwiped.ContainsKey(pt.PointerId))
                pointSwiped.Remove(pt.PointerId);

            --numActiveContacts;
        }

        e.Handled = true;
    }

    private void Grid_PointerExited(object sender, PointerRoutedEventArgs e)
    {
        Windows.UI.Input.PointerPoint pt = e.GetCurrentPoint(mGrid);

        if (contacts.ContainsKey(pt.PointerId))
        {
            checkSwipe();
            contacts[pt.PointerId] = null;
            contacts.Remove(pt.PointerId);
            startLocation.Remove(pt.PointerId);
            if (pointSwiped.ContainsKey(pt.PointerId))
                pointSwiped.Remove(pt.PointerId);

            --numActiveContacts;
        }
        e.Handled = true;
    }

    void Grid_PointerReleased(object sender, PointerRoutedEventArgs e)
    {
        Windows.UI.Input.PointerPoint pt = e.GetCurrentPoint(mGrid);

        if (contacts.ContainsKey(pt.PointerId))
        {
            checkSwipe();
            contacts[pt.PointerId] = null;
            contacts.Remove(pt.PointerId);
            startLocation.Remove(pt.PointerId);
            if (pointSwiped.ContainsKey(pt.PointerId))
                pointSwiped.Remove(pt.PointerId);

            --numActiveContacts;
        }
        e.Handled = true;
    }

    private void Grid_PointerMoved(object sender, PointerRoutedEventArgs e)
    {
        Windows.UI.Input.PointerPoint currentPoint = e.GetCurrentPoint(mGrid);
        if (currentPoint.IsInContact)
        {
            if (startLocation.ContainsKey(currentPoint.PointerId))
            {
                Point startPoint = startLocation[currentPoint.PointerId];

                // Compare startPoint to current location and determine if that point did a swipe?

                double horizontalMovement = currentPoint.Position.X - startPoint.X;
                double verticalMovement = currentPoint.Position.Y - startPoint.Y;

                double horizontalDistance = Math.Abs(horizontalMovement);
                double verticalDistance = Math.Abs(verticalMovement);

                double requiredLeftMovement = mGrid.ActualWidth * SWIPE_THRESHOLD * -1;
                double requiredRightMovement = mGrid.ActualWidth * SWIPE_THRESHOLD;

                double requiredUpMovement = mGrid.ActualHeight * SWIPE_THRESHOLD * -1;
                double requiredDownMovement = mGrid.ActualHeight * SWIPE_THRESHOLD;

                if (verticalMovement < requiredUpMovement && horizontalDistance < 100)
                {
                    pointSwiped[currentPoint.PointerId] = DirectionSwiped.Up;
                }
                else if (verticalMovement > requiredDownMovement && horizontalDistance < ALLOWED_DRIFT)
                {
                    pointSwiped[currentPoint.PointerId] = DirectionSwiped.Down;
                }
                else if (horizontalMovement > requiredRightMovement && verticalDistance < ALLOWED_DRIFT)
                {
                    pointSwiped[currentPoint.PointerId] = DirectionSwiped.Right;
                }
                else if (horizontalMovement < requiredLeftMovement && verticalDistance < ALLOWED_DRIFT)
                {
                    pointSwiped[currentPoint.PointerId] = DirectionSwiped.Left;
                }
            }
        }
    }

    void checkSwipe()
    {
        NotififyListenerIfSwiped(DirectionSwiped.Up);
        NotififyListenerIfSwiped(DirectionSwiped.Down);
        NotififyListenerIfSwiped(DirectionSwiped.Left);
        NotififyListenerIfSwiped(DirectionSwiped.Right);
    }

    private void NotififyListenerIfSwiped(DirectionSwiped direction)
    {
        int fingers = numberOfSwipedFingers(direction);
        if (fingers >= 1)
        {
            if (SwipeDetected != null)
            {
                SwipeDetected(this, new SwipeEventArgs() { Direction = direction, NumberOfTouches = fingers });
            }
        }

        if (fingers > 0)
            pointSwiped.Clear();
    }

    int numberOfSwipedFingers(DirectionSwiped direction)
    {
        int count = 0;
        foreach (var item in pointSwiped)
        {
            DirectionSwiped swipe = item.Value;
            if (swipe == direction)
            {
                count += 1;
            }
        }
        return count;
    }

} 
```

* * *

用法

```
 public void Gesture_Detected(Object sender, SwipeEventArgs e)
    {
        Debug.WriteLine("Number of touches: " + e.NumberOfTouches + " Direction: " + e.Direction);
    }

    public MainPage()
    {
        this.InitializeComponent();

        SwipeGestureDetector gestureDetector = new SwipeGestureDetector(this.rootGrid);
        gestureDetector.SwipeDetected += Gesture_Detected; 
```

# c++ - 用什么来表示 C++ 中的 lambda 字符

> ID：12876658
> 
> 赞同：1
> 
> 时间：2012-10-13T20:24:14.553
> 
> 标签：c++, lambda, character

在程序中，Lambda λ 理论上什么都不代表：''。我想以编程方式将其表示为“\ 0”，但显然这会终止一个字符串，这不一定是 lambda 所做的。另外，我正在阅读，`istringstream`并且在阅读该角色时遇到问题。

那么你会使用什么角色呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T21:27:15.770

我假设您有理由将 Int,Char,Int 表示为字符串，而不仅仅是定义一个结构来保存数据。

正如你所说，`\0`它在终止字符串时不起作用。但是还有其他不可见的 ASCII 字符可以在 C++ 中使用并轻松转义。看看[这个转义码列表](http://en.cppreference.com/w/cpp/language/escape)。

# android - 用于在 android 中进行货币转换的 web 服务 webservicex.net

> ID：12876659
> 
> 赞同：1
> 
> 时间：2012-10-13T20:24:16.597
> 
> 标签：android, web-services, currency, ksoap

我正在尝试在 android 中使用[webservicex.net](http://www.webservicex.net/currencyconvertor.asmx?op=ConversionRate)使用 ksoap2 进行货币转换。

但是，它返回 0！！它甚至不会抛出任何异常，即使我提供错误的参数也只会返回 0，尽管使用提供的 web 服务它工作得很好。

```
String NAME_SPACE = "http://www.webservicex.net/";
Static String URL = "http://www.webservicex.net/currencyconvertor.asmx";
Static String SOAP_ACTION = "http://www.webserviceX.NET/ConversionRate";
Static String METHOD_NAME = "ConversionRate";

String webResult = null;

SoapObject request = new SoapObject(Strings.NAME_SPACE, Strings.METHOD_NAME);
request.addProperty("FromCurrency", "USD");
request.addProperty("ToCurrency", "PKR");

SoapSerializationEnvelope envelop = new SoapSerializationEnvelope(SoapEnvelope.VER11);
envelop.dotNet = true;
envelop.setOutputSoapObject(request);

HttpTransportSE androidHttpRequest = new HttpTransportSE(Strings.URL);
androidHttpRequest.debug = true;
try {

    for (int i = 0; i < 3; i++) {
        androidHttpRequest.call(Strings.SOAP_ACTION, envelop);
        webResult = envelop.getResponse().toString();

        if (webResult != null)
            break;
        }

} catch (Exception e) {
     e.printStackTrace();
    Log.e("APP", "ERROR: " + e.getMessage());   
}

return webResult; 
```

如果我做错了什么，请纠正我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T06:22:57.620

我使用了错误的 NAME_SPACE，所以它没有获取预期的结果。

小小的改变对我有用。

```
String NAME_SPACE = "http://www.webserviceX.NET/";   // WORKS WITH THIS

String NAME_SPACE = "http://www.webservicex.net/";   // BRINGS 0 
```

# javascript - 使用 select2 和远程 jsonp 数据集未捕获的 TypeError

> ID：12876662
> 
> 赞同：2
> 
> 时间：2012-10-13T20:24:39.207
> 
> 标签：javascript, jquery, geonames

我正在尝试使用 select2 查询 Geonames 数据，一切似乎都在格式化结果。但是，填充结果时会产生错误，我相信它会阻止 formatSelection 函数不被执行。

小提琴在这里：http: [//jsfiddle.net/6CVbw/](http://jsfiddle.net/6CVbw/)

产生的错误是：

```
Uncaught TypeError: Property 'jQuery18206926385117694736_1350159499559' of object [object Window] is not a function 
```

有人有想法么？

编辑：这发生在 Chrome 和 Safari 中，尝试搜索伦敦或多伦多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T21:03:11.143

这个问题在 select2 插件内部。如果更准确 - 在基于 jQuery 的 JSONP 加载中。正如我在您的解压代码中看到的那样：http: [//jsfiddle.net/6CVbw/1/](http://jsfiddle.net/6CVbw/1/)

您可以评论这一行：

```
//null !== d && d.abort(); 
```

问题消失了。它是由中止 JSONP 请求引起的。您无法中止 JSONP 调用 - 因为您无法中止脚本标签的加载（JSONP 技术）。

此处包含更多详细信息： [Aborting jQuery JSONP request will throw error](https://stackoverflow.com/questions/9533848/aborting-jquery-jsonp-request-will-throw-error)

您可以在后端制作代理脚本并请求简单的 JSON，然后`.abort()`应该可以正常工作。

# sql - sql select FROM_UNIXTIME(unix_timestamp) 引擎独立

> ID：12876675
> 
> 赞同：0
> 
> 时间：2012-10-13T20:26:04.520
> 
> 标签：sql, datetime, select, unix-timestamp

我需要将 INT 转换为 DATETIME，在 SQL Server 上它将是：

```
select cast(convert(unix_timestamp,103) AS datetime) 
```

在 MySQL 上，语法是：

```
select FROM_UNIXTIME(unix_timestamp) 
```

但我需要让它独立于引擎（SQL Server、MySQL、T-sql 等）。可能吗？

也许它可以在 PHP 中欺骗它？

```
<?php
$sql='select cast(convert(1350134926,103) AS datetime)';
$result = @mysql_query($sql);

if(!$result){
  $sql=' select FROM_UNIXTIME(1350134926)';
  $result = @mysql_query($sql);

  if(!$result){...}

}

?> 
```

# c++ - OOP C++ 第一个编译器错误

> ID：12876679
> 
> 赞同：2
> 
> 时间：2012-10-13T20:26:27.687
> 
> 标签：c++, oop, cout

请帮助这个新手，这是我的代码：

```
#include <iostream>
using namespace std;

class Complex {
private:
    float r, i;

public:
    Complex(float rr, float ii) : r(rr), i (ii) {}
    float GiveRe () { return r; }
    float GiveIm () { return i; }
    void Setit (float rr, float ii) {
        r = rr;
        i = ii;
    }
};

Complex a(10, 20);

Complex sumit (Complex &ref) {
     static Complex sum (0, 0);
    sum.Setit(sum.GiveRe() + ref.GiveRe(), sum.GiveIm() + ref.GiveIm());
    return sum;
}

int main () {
    Complex sumvalue = sumit (a);
    cout << sumvalue << endl;
    return 0;
} 
```

错误：`no match for 'operator<<' in 'std::cout << sumvalue'`。

程序应该输出一个复数的总和。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:30:31.137

cout 无法告诉您要输出什么，您需要在类中指定 operator<< 或者可以将您的类隐式转换为兼容类型。

[http://www.cplusplus.com/reference/iostream/ostream/operator%3C%3C/](http://www.cplusplus.com/reference/iostream/ostream/operator%3C%3C/)

在您的课程中实现的 Rudolf Mühlbauer 的代码：

在类头中的某处添加：

```
friend ostream& operator<<(ostream& out, const Complex& compl); 
```

这在标题下方：

```
ostream& operator<<(ostream& out, const Complex& compl)
{
    return out << compl.r << "/" << compl.i;
} 
```

应更改实施以适合您的确切需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T20:33:50.313

您必须重载`"<<"`复杂类型的运算符。

```
#include <iostream>
using namespace std;

class Complex {
private:
    float r, i;

public:
    Complex(float rr, float ii) : r(rr), i (ii) {}
    float GiveRe () { return r; }
    float GiveIm () { return i; }
    void Setit (float rr, float ii) {
        r = rr;
        i = ii;
    }

};

ostream& operator<<(ostream& os, Complex& c)
    {
        float i;
        os<<c.GiveRe();
        if(c.GiveIm() < 0){  
            os<<"-j"<<c.GiveIm()*(-1);
        }else{
            os<<"+j"<<c.GiveIm();
        }
        return os;
    }

Complex a(10, 20);

Complex sumit (Complex &ref) {
     static Complex sum (0, 0);
    sum.Setit(sum.GiveRe() + ref.GiveRe(), sum.GiveIm() + ref.GiveIm());
    return sum;
}

int main () {
    Complex sumvalue = sumit (a);
    cout << sumvalue << endl;
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T20:35:31.220

一个完整的最小示例：

```
#include <iostream>

using namespace std;

class C {
  public: 
    int r, l;
    // if the operator needs access to private fields:
    friend ostream& operator<< (ostream&, const C&);
};

ostream& operator << (ostream& stream, const C& c) {
    stream << c.r << "--" << c.l;
    return stream;
}

int main() {
    C c;
    c.l = 1;
    c.r = 2;
    cout << c << endl;
} 
```

C++ 允许您定义运算符。STL 使用`<<`运算符进行输出，整个 istream/ostream 类层次结构使用此运算符进行输入/输出。

运算符作为函数实现，但始终遵循非常特定的语法。如示例所示，`ostream& operator << (ostream&, const MYTYPEHERE&)`是定义 ostream`<<`运算符的方式。

当 C++ 遇到一个语句时，它必须推断出所有操作数的类型，并（确实非常神奇地）找到问题的解决方案：给定我的操作数和运算符，我能找到一个使语句有效的类型吗？

这些 ofstream 运算符是为某处的所有基本类型定义的`<iostream>`，因此如果您编写`cout << 10`，编译器会找到一个运算符`ostream& operator<< (ostream&, int)`。

如果你想在这个游戏中使用用户定义的类型，你必须定义操作符。否则，声明`cout << sometype`将无效。这也是 C++ 中有时会出现严重编译器错误的原因：“好吧，我定义了一些运算符 <<，但没有一个与您的类型兼容！”。

因为有时为您的类型实现运算符是不利的（例如，如果您只输出一次），我建议编写：

```
cout << sum.re << "--" << sum.im << endl; // or similar 
```

这样，您编写的代码更少，输出格式也很灵活。谁知道您下次是否希望复数格式不同？但这是另一个讨论。

为什么要复杂这么多？因为 C++ 可能非常复杂。它非常强大，但充满了特殊的语法和例外。最后，与 C 的区别就在这里：C++ 在类型推断（模板需要）方面做得更好，通常会导致 WTF？

关于如何在您的代码中实现它，我认为其他答案提供了很好的解决方案！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-13T20:29:56.917

Complex 没有运算符 <<

```
ostream& Complex::operator << ( ostream& os )
    {
    // use os << field/method here to out put
    return os;
    } 
```

此外，如果 complex 可以以不同的方式显示到控制台，那么您应该考虑使用方法来显示而不是 cout <<

```
void Complex::DisplayToConsole()
    {
    std::cout << r << " " << i << '\n';
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-13T20:31:28.413

`sumit(a)`返回类型为 的对象`Complex`，该对象`cout`未定义为处理。

# php - XML：无法验证“类型”定义

> ID：12876689
> 
> 赞同：1
> 
> 时间：2012-10-13T20:27:51.507
> 
> 标签：php, xml, xml-validation

我正在尝试使用在 OSX 上使用 PHP 5.3.15 验证从脚本生成的 XML 与 .xsd 模式文件`DOMDocument::schemaValidate()`，但它无法验证`type`定义。我尝试将其更改为`xsi:type`，但仍然失败。我的 XML 看起来*与*验证没有任何问题的 XML 文件相同。我不知道这里可能会发生什么......

这是无法验证的 XML：

```
<DataGroups>
    <DataGroup xsi:type="ReportDataGroup"/>

    <DataGroup xsi:type="AlertDataGroup">
      // some XML here
    </DataGroup>

    <DataGroup xsi:type="MetricGroupingDataGroup">
      // some XML here
    </DataGroup>
</DataGroups> 
```

我收到以下警告之一`DataGroup`：

```
Severity: Warning
Message:  DOMDocument::schemaValidate(): Element 'DataGroup': The type definition is abstract. 
```

或者，更具体地说

```
Error 1876: Element 'DataGroup': The type definition is abstract 
```

我查了一下错误。这是：

```
XML_SCHEMAV_CVC_TYPE_2 = 1876 : 1876 
```

这是 .xsd 文件的相关部分：

```
<xs:complexType name="DataGroupType" abstract="true"/>

<xs:complexType name="AlertDataGroup">
    <xs:complexContent>
        <xs:extension base="DataGroupType">
            <xs:choice minOccurs="0" maxOccurs="unbounded">
                <xs:element name="AlertBase" type="BaseAlertType"/>
            </xs:choice>
        </xs:extension>
    </xs:complexContent>
</xs:complexType>
<xs:complexType name="ReportDataGroup">
    <xs:complexContent>
        <xs:extension base="DataGroupType">
            <xs:sequence minOccurs="0" maxOccurs="unbounded">
                <xs:element name="SmartReportTemplate" type="SmartReportTemplateType"/>
            </xs:sequence>
        </xs:extension>
    </xs:complexContent>
</xs:complexType>
<xs:complexType name="MetricGroupingDataGroup">
    <xs:complexContent>
        <xs:extension base="DataGroupType">
            <xs:sequence minOccurs="0" maxOccurs="unbounded">
                <xs:element name="MetricGrouping" type="MetricGroupingType"/>
            </xs:sequence>
        </xs:extension>
    </xs:complexContent>
</xs:complexType> 
```

知道这里会发生什么吗？我花了一整天的时间试图解决它，但无济于事。我必须让它验证，否则另一端的应用程序不会读取文件，因为它会在加载时验证。

**更新：**

我对生成的 XML 和预退出文件进行了并排比较，验证得很好。根本看不出有什么区别。我还发现了一些能够针对给定模式进行验证的 XML 验证服务和工具。每个人都完美地验证了它，没有任何错误。所以我不明白为什么我的本地验证仍然失败。

我正在设置正确的命名空间：

```
$xml->documentElement->setAttributeNS('http://www.w3.org/2000/xmlns/' ,'xmlns:introscope', 'generated://introscope.xsd');
$xml->documentElement->setAttributeNS('http://www.w3.org/2000/xmlns/' ,'xmlns:xsi', 'http://www.w3.org/2001/XMLSchema-instance');
$xml->documentElement->setAttributeNS('http://www.w3.org/2001/XMLSchema-instance', 'noNamespaceSchemaLocation', 'http://example.com/path/to/schema.xsd'); 
```

我的根节点看起来与验证文件中的根节点相同，所有名称空间都设置正确：

```
<ManagementModule xmlns:introscope="generated://introscope.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Version="1.0" Editable="true" DescriptionContentType="text/plain" IsActive="true" Name="ManagementModuleName" xsi:noNamespaceSchemaLocation="http://example.com/path/to/schema.xsd"> 
```

**更新#2：**

哇...在这个问题出现 2 天后，我意识到它只会在尝试验证流时失败。如果我将我的 XML 保存到一个文件并尝试验证它，它工作正常！什么？

**更新#3：**

根据要求添加代码片段：

这是验证码。这个片段漂浮在互联网上，多人成功使用它：

```
 function libxml_display_error($error)
    {
        $return = "\n";
        switch ($error->level) {
            case LIBXML_ERR_WARNING:
                $return .= "Warning $error->code: ";
                break;
            case LIBXML_ERR_ERROR:
                $return .= "Error $error->code: ";
                break;
            case LIBXML_ERR_FATAL:
                $return .= "<b>Fatal Error $error->code: ";
                break;
        }
        $return .= trim($error->message);
        if ($error->file) {
            $return .=    " in $error->file";
        }
        $return .= " on line $error->line\n";

        return $return;
    }

    function libxml_display_errors() {
        $errors = libxml_get_errors();
        foreach ($errors as $error) {
            print libxml_display_error($error);
        }
        libxml_clear_errors();
    } 
```

验证码在这里。显然我是在构建 xml 之后运行它，但为了清楚起见，我把它放在这里：

```
libxml_use_internal_errors(true);

if (!$xml->schemaValidate('/local/path/to/schema.xsd')) {
    print '<b>DOMDocument::schemaValidate() Generated Errors!</b>';
    libxml_display_errors();

} else {
    echo "VALID XML";
} 
```

如果我这样构造我的 XML，它不会验证：

```
$xml = new DOMDocument();
$xml = Array2XML::createXML('ManagementModule', $json);

$xml->documentElement->setAttributeNS('http://www.w3.org/2000/xmlns/' ,'xmlns:introscope', 'generated://introscope.xsd');
$xml->documentElement->setAttributeNS('http://www.w3.org/2000/xmlns/' ,'xmlns:xsi', 'http://www.w3.org/2001/XMLSchema-instance');
$xml->documentElement->setAttributeNS('http://www.w3.org/2001/XMLSchema-instance', 'noNamespaceSchemaLocation', 'http://example.com/path/to/schema.xsd'); 
```

我收到以下错误：

```
Error 1876: Element 'DataGroup': The type definition is abstract. on line 0
Error 1876: Element 'DataGroup': The type definition is abstract. on line 0
Error 1876: Element 'DataGroup': The type definition is abstract. on line 0 
```

如果我在上面的代码中添加以下行，请将输出保存到一个名为`text.xml`

```
echo $xml->saveXML(); 
```

然后执行以下操作：

```
$xml = new DOMDocument();
$xml->load('/path/to/test.xml'); 
```

然后尝试验证，我得到

```
VALID XML 
```

# iphone - 蓝牙连接到非 iOS 接收器

> ID：12876691
> 
> 赞同：0
> 
> 时间：2012-10-13T20:28:12.030
> 
> 标签：iphone, xcode, bluetooth, core-bluetooth, bluetooth-lowenergy

iPhone蓝牙可以连接到非iOS蓝牙接收器吗？或者我可以使用哪个蓝牙接收器将我的 iPhone 与外部设备通信？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T05:25:48.307

如果您想构建一个非 iOS 蓝牙接收器，它可以通过经典蓝牙（不是蓝牙 4.0 又名蓝牙低功耗）与 iPhone/iPad 通信，您必须为此获得 MFi 许可证（请参阅[Apple MFi 常见问题解答](http://mfi.apple.com/faqs)）并使用 iOS附件框架来执行连接。然而，通过低功耗蓝牙，Apple 提供了一个非常简单和开放的框架“CoreBluetooth”来建立 iOS 设备和 BLE 设备之间的通信，不需要许可证。这可能是因为苹果不必担心 BLE 设备的能耗。

# c++ - 如何使用多项式类重载 operator+ 以及要返回的类型

> ID：12876694
> 
> 赞同：1
> 
> 时间：2012-10-13T20:28:25.813
> 
> 标签：c++, operator-overloading

我在重载 + 运算符时遇到问题，我无法弄清楚原因是什么。+ 运算符返回一个多项式（称为 C），但它按值返回它，其中赋值运算符期望一个多项式对象作为通过引用传递的参数。为了使 C=A+B 工作，我是否需要第二个赋值运算符函数，它将按值传递的多项式作为参数？谢谢！

```
#include <iostream>
#include <ctime>
#include <cstdlib>

using namespace std;
void line(int lines);

class Polynomial
{
    private:
        int degree;
        int* coeffs;
    public:
        //constructors
        Polynomial() {degree=0;coeffs=new int[1];}
        Polynomial(int deg) {degree=deg;coeffs=new int[deg+1];}
        Polynomial(const Polynomial& A);

        //mutators
        void GetCoeffs(istream& in);
        void EditCoeff(int deg);
        void ResetCoeffs();
        int Coeff(int deg);
        void Randomize(int max);

        //accessors
        void Show(ostream& out);
        int Degree() {return degree;}

        //operators
        friend Polynomial operator+(Polynomial& A, Polynomial& B);
        void operator =(Polynomial A);
};

int main()
{
    Polynomial A(5);
    Polynomial B(5);
    A.Randomize(5);
    B.Randomize(5);

    A.Show(cout);
    line(2);
    B.Show(cout);
    line(2);
    Polynomial C(5);
    C=A+B;
    C.Show(cout);

    return 0;
}

void Polynomial::Randomize(int max)
{
    for (int i=degree; i>=0; i--)
    {
        coeffs[i]=rand()%(max+1) + 1;
        if ((rand()%(101) + 1)%2 == 0)
            coeffs[i]*=-1;
    }
}

void Polynomial::operator =(Polynomial A)
{
    if (degree==A.degree)
    {
        for (int i=degree; i>=0; i--)
        {
            coeffs[i]=A.coeffs[i];
        }
    }
}

Polynomial Polynomial::operator+(Polynomial& A, Polynomial& B)
{
    Polynomial C;
    if (A.degree>=B.degree)
    {
        C=A;
        for (int i=B.degree; i>=0; i--)
        {
            C.coeffs[i]=A.coeffs[i]+B.coeffs[i];
        }
        C.Show(cout);
        return C;
    }
    else
    {
        C=B;
        for (int i=A.degree; i>=0; i--)
        {
            C.coeffs[i]=A.coeffs[i]+B.coeffs[i];
        }
        C.Show(cout);
        return C;

    }

}

int Polynomial::Coeff(int deg)
{
    return coeffs[deg];
}

void line(int lines)
{
    for (int i=0; i<lines; i++)
        cout << endl;
}

void Polynomial::GetCoeffs(istream& in)
{
    for (int i=degree; i>=0; i--)
    {
        in >> coeffs[i];
    }
    in.ignore();
}

void Polynomial::Show(ostream& out)
{
    for (int i=degree; i>=0; i--)
    {
        if (coeffs[i]>=0)
        {
            if (i!=degree)
                out << " + ";
            out << coeffs[i];

        }
        else
        {
            if (coeffs[i]<0)
                out << " - ";
                out << 0-coeffs[i];
        }
        if (i>1)
            out << "x^" << i;
        else if (i==1)
            out << "x";

    }
}

Polynomial::Polynomial(const Polynomial& A)
{
    coeffs=new int[A.degree+1];
    degree=A.degree;
    for (int i=A.degree; i>=0; i--)
    {
        coeffs[i]=A.coeffs[i];

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:42:17.530

这里的问题是您混淆了全局（外部类定义）`operator+`和成员类定义`operator+`。

( `static`)`Polynomial operator+(Polynomial& A, Polynomial& B);`此运算符在全局范围内使用，因此在类之外。

在类中，您需要使用以下签名。

`Polynomial& operator+(const Polynomial& other);`

这是一个例子。

```
Polynomial p;
Polynomial q;
p = p + q; 
```

如果在类中定义了运算符，则代码如下：

```
p = p.operator+(q); //only needs one parameter. 
```

如果运算符是全局定义的，则代码为：

```
p = ::operator+(p, q); //needs both parameter 
```

* * *

**注意：** 要将其用作非成员函数`Polynomial operator+(Polynomial& A, Polynomial& B);`，从您的定义中删除`Polynomial Polynomial::operator+(Polynomial& A, Polynomial& B){/**/}`应该移到主函数之上，它现在变为：

`static Polynomial operator+(Polynomial& A, Polynomial& B){/**/}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T22:30:52.117

通常，您会`operator+`通过以下两种方式之一超载：

```
Polynomial operator+(const Polynomial &other) const; 
```

或作为非成员函数，

```
Polynomial operator+(Polynomial a, const Polynomial &b); 
```

您通常不需要`friend`后者的限定符，因为实现可能是根据已在类中定义的另一个重载运算符：

```
Polynomial operator+=(const Polynomial &other); 
```

那么您的非成员实现将是：

```
Polynomial operator+(Polynomial a, const Polynomial &b)
{
     a+=b;
     return a;
} 
```

如果您坚持使用代码中定义的函数，那么如果*您*`friend`需要访问私有成员，则需要将其设为 a ：

```
Polynomial operator+(Polynomial &a, Polynomial &b)
{
     Polynomial p;
     // add them as needed
     return p;
} 
```

# list - 使用 xsl 将字符分隔列表转换为层次结构

> ID：12876695
> 
> 赞同：0
> 
> 时间：2012-10-13T20:28:44.877
> 
> 标签：list, xslt, hierarchy, xslt-2.0

我的提要中的每个产品都有这样的类别节点：

```
<categories>
  <category>För henne &gt; Ansikte</category>
  <category>För henne &gt; Pumps &amp; klackskor</category>
  <category>För henne &gt; Stövlar &amp; stövletter</category>
  <category>För honom &gt; Badkläder</category>
  ...
</categories> 
```

哪里`&gt;`将父类与子类分开。

我想要做的是有这样的类别树：

```
<categories>
  <category name="För henne">
    <categories>
      <category name="Ansikte"/>
      <category name="Pumps &amp; klackskor"/>
      <category name="Stövlar &amp; stövletter"/>
    </categories>
  </category>
  <category name="För honom">
    <categories>
      <category name="Badkläder"/>
    </categories>
  </category>
</categories> 
```

我怎样才能用 xsl 实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T11:18:42.890

这是另一种 XSLT 2.0 样式表，我认为它是最简单但通用的解决方案。

**这种转变...**

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema"
 exclude-result-prefixes="xs">
<xsl:output omit-xml-declaration="yes" indent="yes"/>
<xsl:variable name="sep" select="' &gt; '" />

<xsl:template match="categories" name="cat-grouper">
  <xsl:param name="cat-strs" as="xs:string*" select="category" />
  <categories>
    <xsl:for-each-group select="$cat-strs[contains(.,$sep)]" group-by="substring-before(.,$sep)">
      <category name="{current-grouping-key()}">
        <xsl:call-template name="cat-grouper">
          <xsl:with-param name="cat-strs" select="for $s in current-group() return substring-after($s,$sep)" />
        </xsl:call-template>
      </category>
    </xsl:for-each-group>
    <xsl:for-each-group select="$cat-strs[not(contains(.,$sep))]" group-by=".">
      <category name="{current-grouping-key()}" />
    </xsl:for-each-group>
  </categories> 
</xsl:template>

</xsl:stylesheet> 
```

**...应用于以下输入**（改编自 OP 的示例输入，以解决他与输入中两次出现有关的评论`<category>För honom > Badkläder</category>`）**...**

```
<categories>
  <category>För henne &gt; Ansikte</category>
  <category>För henne &gt; Pumps &amp; klackskor</category>
  <category>För henne &gt; Stövlar &amp; stövletter</category>
  <category>För honom &gt; Badkläder</category>
  <category>För honom &gt; Badkläder</category>
</categories> 
```

**...产量...**

```
<categories>
   <category name="För henne">
      <categories>
         <category name="Ansikte"/>
         <category name="Pumps &amp; klackskor"/>
         <category name="Stövlar &amp; stövletter"/>
      </categories>
   </category>
   <category name="För honom">
      <categories>
         <category name="Badkläder"/>
      </categories>
   </category>
</categories> 
```

## 笔记

通过双重使用唯一的模板可以获得一些简单性。它既是`categories`根元素的匹配模板，也是处理类别字符串列表的命名模板。

## 另一个

这是另一种替代解决方案。如果更喜欢我提供给你的第一个，但值得看看这个。使用 tokenize() 的类似用法，您可能会认为这只是对 Dimitre 解决方案的调整。

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema"
 exclude-result-prefixes="xs">
<xsl:output omit-xml-declaration="yes" indent="yes"/>
<xsl:variable name="sep" select="' &gt; '" />

<xsl:template match="categories" name="cat-grouper">
  <xsl:param name="cat-strs" as="xs:string*" select="category" />
  <categories>
    <xsl:for-each-group select="$cat-strs" group-by="tokenize(.,$sep)[1]">
      <category name="{current-grouping-key()}">
        <xsl:variable name="subcats" select="
          for $s in current-group()[contains(.,$sep)]
            return substring-after($s,$sep)" />
        <xsl:if test="exists($subcats)">
          <xsl:call-template name="cat-grouper">
            <xsl:with-param name="cat-strs" select="$subcats" />
          </xsl:call-template>
        </xsl:if>  
      </category>
    </xsl:for-each-group>
  </categories> 
</xsl:template>

</xsl:stylesheet> 
```

* * *

## 附录

这是将我的第一个解决方案应用于 Dimitre 的输入文档的结果输出。我要求 OP 建议这是否是对他的转换规则的正确解释。这是我的理解，但也许我理解错了？

```
<categories>
   <category name="A">
      <categories>
         <category name="AB1">
            <categories>
               <category name="AB1C1"/>
            </categories>
         </category>
         <category name="AB2">
            <categories>
               <category name="AB2C1">
                  <categories>
                     <category name="AB2C1D1"/>
                     <category name="AB2C3"/>
                  </categories>
               </category>
               <category name="AB2C1"/>
            </categories>
         </category>
      </categories>
   </category>
   <category name="F">
      <categories>
         <category name="XY1">
            <categories>
               <category name="XY1Z1"/>
            </categories>
         </category>
         <category name="XY2">
            <categories>
               <category name="XY2Z1">
                  <categories>
                     <category name="XY2Z1T1"/>
                     <category name="XY2Z3"/>
                  </categories>
               </category>
               <category name="XY2Z1"/>
            </categories>
         </category>
      </categories>
   </category>
</categories> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T21:22:05.037

**一、XSLT 1.0 解决方案**：

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kCategory" match="category"
  use="substring-before(., ' >')"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match=
  "category
    [generate-id()
    =
     generate-id(key('kCategory', substring-before(., ' >'))[1])
    ]">
  <category name="{substring-before(., ' >')}">
    <categories>
      <xsl:apply-templates mode="inGroup"
        select="key('kCategory', substring-before(., ' >'))"/>
    </categories>
  </category>
 </xsl:template>

 <xsl:template match="category" mode="inGroup">
   <category name="{substring-after(., '> ')}"/>
 </xsl:template>
 <xsl:template match="category"/>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<categories>
  <category>För henne > Ansikte</category>
  <category>För henne > Pumps &amp; klackskor</category>
  <category>För henne > Stövlar &amp; stövletter</category>
  <category>För honom > Badkläder</category>
  ...
</categories> 
```

**产生想要的正确结果：**

```
<categories>
   <category name="För henne">
      <categories>
         <category name="Ansikte"/>
         <category name="Pumps &amp; klackskor"/>
         <category name="Stövlar &amp; stövletter"/>
      </categories>
   </category>
   <category name="För honom">
      <categories>
         <category name="Badkläder"/>
      </categories>
   </category>
  ...
</categories> 
```

**说明**：

1.  正确使用 Muenchian 分组方法。

2.  正确使用和覆盖身份规则。

3.  正确使用按键和模式。

* * *

**二、通用 XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema"
 xmlns:my="my:my" exclude-result-prefixes="my xs">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/*">
  <xsl:sequence select="my:grouping(*)"/>
 </xsl:template>

 <xsl:function name="my:grouping">
  <xsl:param name="pStrings" as="xs:string*"/>

  <xsl:if test="$pStrings[1]">
      <categories>
          <xsl:for-each-group select="$pStrings"
            group-by="tokenize(., ' > ')[1]">

            <category name="{current-grouping-key()}">
             <xsl:variable name="vnewStrings" as="xs:string*">
                 <xsl:for-each select="current-group()">
                   <xsl:sequence select="substring-after(., ' > ')"/>
                 </xsl:for-each>
             </xsl:variable>
             <xsl:sequence select="my:grouping($vnewStrings)"/>
            </category>
          </xsl:for-each-group>
      </categories>
  </xsl:if>
 </xsl:function>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时：**

```
<categories>
  <category>A > AB1 > AB1C1</category>
  <category>A > AB2 > AB2C1 > AB2C1D1</category>
  <category>A > AB2 > AB2C1</category>
  <category>A > AB2 > AB2C1 > AB2C3</category>
  <category>F > XY1 > XY1Z1</category>
  <category>F > XY2 > XY2Z1 > XY2Z1T1</category>
  <category>F > XY2 > XY2Z1</category>
  <category>F > XY2 > XY2Z1 > XY2Z3</category>
</categories> 
```

**产生了想要的正确结果：**

```
<categories>
   <category name="A">
      <categories>
         <category name="AB1">
            <categories>
               <category name="AB1C1"/>
            </categories>
         </category>
         <category name="AB2">
            <categories>
               <category name="AB2C1">
                  <categories>
                     <category name="AB2C1D1"/>
                     <category name="AB2C3"/>
                  </categories>
               </category>
            </categories>
         </category>
      </categories>
   </category>
   <category name="F">
      <categories>
         <category name="XY1">
            <categories>
               <category name="XY1Z1"/>
            </categories>
         </category>
         <category name="XY2">
            <categories>
               <category name="XY2Z1">
                  <categories>
                     <category name="XY2Z1T1"/>
                     <category name="XY2Z3"/>
                  </categories>
               </category>
            </categories>
         </category>
      </categories>
   </category>
</categories> 
```

**说明**：

1.  用于`<xsl:for-each-group>`

2.  使用标准 XSLT 函数：`current-group()`和`current-grouping-key()`.

3.  带停止条件的递归：空参数。

# c# - 如何在.Net中实现“使用此函数转换”自定义属性？

> ID：12876696
> 
> 赞同：3
> 
> 时间：2012-10-13T20:28:45.610
> 
> 标签：c#, .net, reflection, delegates, custom-attributes

我正在使用属性构建一些东西。我真正想作为属性实现的一件事是`convert a string to this property's type using this function`. 现在，我有这个：

```
 public delegate object ParameterConverter(string val);

    [AttributeUsage(AttributeTargets.Property)]
    public class ParameterConverterAttribute : ParameterBaseAttribute
    {
        ParameterConverter Converter;
        public ParameterConverterAttribute(ParameterConverter converter)
        {
            Converter=converter;
        }
        public object Convert(string val)
        {
            return Converter(val);
        }
    } 
```

我像这样使用它：

```
public class Tester
{
    [ParameterConverter(new ParameterConverter(TestConverter)] //error here
    public int Foo{get;set;}
    static object TestConverter(string val)
    {
      return 10;
    }
} 
```

但是，.Net 或至少 C# 似乎不支持这种事情。似乎属性内部的委托不起作用。

是否有任何解决此问题的方法或处理此问题的好方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-13T20:57:45.673

No Delegates cannot be passed as an argument to an Attribute. The Supported types are :

1.  Object
2.  Type
3.  Enum
4.  Single Dimentional Array
5.  bool, byte, float char, double, int, long, string .... etc.

But as it supports Type as well as strings, you can pass a Type and the name of the method to create a delegate inside the Attribute class.

```
public delegate object ParameterConverter(string val);

[AttributeUsage(AttributeTargets.Property)]
public class ParameterConverterAttribute : ParameterBaseAttribute
{
    public ParameterConverter Converter { get; set; }
    public ParameterConverterAttribute(Type delegateType, string method)
    {
     try{ // Important as GetMethod can throw error exception or return null
        this.Converter = (ParameterConverter)Delegate.CreateDelegate(delegateType, delegateType.GetMethod(method));
      }
      catch { } 
    }
    public object Convert(string val)
    {
        if(this.Converter != null)
             return Converter(val);
    }
} 
```

And now you can use it like :

```
public class Tester
{
    [ParameterConverter(typeof(ParameterConverter), "TestConverter"] 
    public int Foo{get;set;}
    static object TestConverter(string val)
    {
      return 10;
    }
} 
```

I hope this would help you.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T20:33:26.313

查找[TypeConverter 类](http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverter.aspx)

或者

[类型转换器示例](http://msdn.microsoft.com/en-us/library/87926x56%28VS.100%29.aspx)

此示例说明如何创建名为 AuthorConverter....的类型转换器。AuthorConverter 示例将 Author 对象转换为 String 并将 String 表示形式转换为 Author 对象。

* * *

更新：您可以跳过@abhishek 所显示的属性限制。

可能的另一种方法是定义一些“约定优于配置”：转换器函数是一种定义的方法，就像在同一类中定义的私有静态转换器（字符串 val）一样。在你的情况下：

```
public class Tester
{
    public int Foo{get;set;}
    private static int FooConverter(string val)
    {
      return 10;
    }
} 
```

您可以在属性顶部放置一些 ParameterConverterAttribute 作为自定义转换器功能存在的标志，但不是强制性的。

# c - Putty 有时喜欢在我的命令行中打印自己

> ID：12876699
> 
> 赞同：23
> 
> 时间：2012-10-13T20:28:59.950
> 
> 标签：c, putty

所以，有时当我通过连接到linux服务器的putty用C编程时，执行我的C文件进行测试后，命令行会重复填入“PuTTY”这个词30到40次。有时它会在我的程序中多次显示这个词。

其他人有类似的问题吗？如果这与它有任何关系，我也在做文件 I/O。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-13T20:31:58.240

当 PuTTY 收到 Ctrl-E（字符代码 5）时，它会输出“PuTTY”（除非您已将其配置为以其他方式回答）。听起来您的程序正在输出一些二进制文件。是不是故意的，我不知道。

# matlab - 使用符号向量进行符号表达式微分

> ID：12876702
> 
> 赞同：1
> 
> 时间：2012-10-13T20:29:28.337
> 
> 标签：matlab

我正在尝试使用创建的符号向量来区分以下符号表达式，但我不断收到错误。也就是说，我想要 df/dx1、df/dx2 和 df/dx3。这是我尝试过的：

```
>> x = sym('x', [3 1])

x =

 x1
 x2
 x3

>> symbolic = 0.5*transpose(x)*eye(1)*x + [1 1 1]*x

symbolic =

x1^2/2 + x1 + x2^2/2 + x2 + x3^2/2 + x3

>> diff(symbolic, x)
Error using mupadmex
Error in MuPAD command: Invalid argument. [contains]

  Evaluating: (Dom::Matrix(Dom::ExpressionField()))::_mult1

Error in sym/diff (line 44)
    R = mupadmex('symobj::diff', S.s, x.s, int2str(n));

>> diff(symbolic, x.x1)
Error using sym/subsref
Too many output arguments. 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T21:09:07.143

您可以尝试以下两个选项之一：

```
% option 1
x = sym('x', [3 1]);
f = 0.5*transpose(x)*eye(1)*x + [1 1 1]*x;

for i=1:3
    Df(1,i) = diff(f, x(i));
end

% I do not like this option because I do not know 
% how to evaluate the expressions with numeric values
x(1) = 1;
eval(Df) 
```

我更喜欢“选项 2”，因为它更容易评估表达式。

```
% option 2
syms x1 x2 x3 real; % 'real' fixes x1 x2 x3 as real numbers (not complex ones)
x = [x1 x2 x3]'; % '
f = 0.5*transpose(x)*eye(1)*x + [1 1 1]*x;

for i=1:3
    eval(['Df(1,i) = diff(f,x',num2str(i),');']);
end

% To eval at a certain value
x1 = 1;
x2 = 2;
x3 = 3;
eval(Df) 
```

我认为 eval 只有我上面使用的两个功能：

1.  将符号表达式评估为符号变量的特定值，就像我写 eval(Df) 时一样。
2.  您可以使用 eval 评估以字符串形式编写的 matlab 命令，就像您将其编写为普通代码一样。试试这个看看我的意思：

    a = 1; % 将 a 的值设置为 1

    评估（'a = 2'）；% 将 a 的值更改为 2

    eval(['a = ',num2str(5)]); % 将 a 的值设置为 5；

希望这可以帮助，

# opengl-es-2.0 - 在 OpenGL ES 2 中切换纹理

> ID：12876705
> 
> 赞同：2
> 
> 时间：2012-10-13T20:30:06.210
> 
> 标签：opengl-es-2.0, textures

我试图弄清楚如何将不同的纹理放入不同的纹理单元并选择要绘制的纹理。我的`onDrawFrame()`方法中有以下代码

```
 int[] texture = new int[7];
    texture[0] =TextureHelper.loadTexture(mActivityContext,R.drawable.texture1);
    texture[1] =TextureHelper.loadTexture(mActivityContext,R.drawable.texture2);
    texture[2] =TextureHelper.loadTexture(mActivityContext,R.drawable.texture3);
    texture[3] =TextureHelper.loadTexture(mActivityContext,R.drawable.texture4);
    texture[4] =TextureHelper.loadTexture(mActivityContext,R.drawable.texture5);
    texture[5] =TextureHelper.loadTexture(mActivityContext,R.drawable.texture6);
    texture[6] =TextureHelper.loadTexture(mActivityContext,R.drawable.texture7);

    for (int i = 0; i < 7; i ++) {
        GLES20.glActiveTexture(GLES20.GL_TEXTURE0 + i);
        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture[i]);
        GLES20.glUniform1i(mTextureUniformHandle, i);
        Matrix.setIdentityM(mModelMatrix, 0);
        Matrix.translateM(mModelMatrix, 0, -0.60f + 0.2f * i, 0.0f, 0.0f);
        draw();
    } 
```

这应该做的是将七个不同的纹理加载到单独的纹理单元中并绘制立方体，每个立方体具有不同的纹理。然而，最终发生的是所有的立方体最终都是用第一个纹理绘制的。

如果我更改`GLES20.glActiveTexture(GLES20.GL_TEXTURE0 + i)`为`GLES20.glActiveTexture(GLES20.GL_TEXTURE0)`和`GLES20.glUniform1i(mTextureUniformHandle, i)`，它可以正常工作`GLES20.glUniform1i(mTextureUniformHandle, 0)`，但它只使用一个纹理单元并每次都替换该单元中的纹理，这不是我想要做的。

我究竟做错了什么？提前致谢。

编辑：

顶点着色器：

```
 "uniform mat4 u_MVPMatrix;" + // A constant representing the
                                            // combined
                                            // model/view/projection matrix.
            "uniform mat4 u_MVMatrix;" + // A constant representing the
                                            // combined model/view matrix.

            "attribute vec4 a_Position;" + // Per-vertex position
                                            // information we will pass in.
            "attribute vec4 a_Color;" + // Per-vertex color information we
                                        // will pass in.
            "attribute vec2 a_TexCoordinate;" + // Per-vertex texture
                                                // coordinate information we
                                                // will pass in.

            "varying vec3 v_Position;" + // This will be passed into the
                                            // fragment shader.
            "varying vec4 v_Color;" + // This will be passed into the
                                        // fragment shader.
            "varying vec2 v_TexCoordinate;" + // This will be passed into
                                                // the fragment shader.

            // The entry point for our vertex shader.
            "void main()" + "{" +
            // Transform the vertex into eye space.
            "v_Position = vec3(u_MVMatrix * a_Position);" +

            // Pass through the color.
            "v_Color = a_Color;" +

            // Pass through the texture coordinate.
            "v_TexCoordinate = a_TexCoordinate;" +

            // gl_Position is a special variable used to store the final
            // position.
            // Multiply the vertex by the matrix to get the final point in
            // normalized screen coordinates.
            "gl_Position = u_MVPMatrix * a_Position;" + "} "; 
```

片段着色器：

```
 "precision mediump float;" + // Set the default precision to medium. We don't need as high of a
            // precision in the fragment shader.
            "uniform sampler2D u_Texture;" + // The input texture.

            "varying vec3 v_Position;" + // Interpolated position for this fragment.
            "varying vec4 v_Color;" + // This is the color from the vertex shader interpolated across the
            // triangle per fragment.
            "varying vec2 v_TexCoordinate;" + // Interpolated texture coordinate per fragment.

            // The entry point for our fragment shader.
            "void main()" +
            "{" +
                // Multiply the color by the diffuse illumination level and texture value to get final output color.
                "gl_FragColor = (v_Color * texture2D(u_Texture, v_TexCoordinate));" +
            "}"; 
```

绘制（）方法：

```
public void draw() {
// Pass in the position information
    mCubePositions.position(0);
    GLES20.glVertexAttribPointer(mPositionHandle, mPositionDataSize, GLES20.GL_FLOAT, false, 0, mCubePositions);
    GLES20.glEnableVertexAttribArray(mPositionHandle);

    // Pass in the color information
    mCubeColors.position(0);
    GLES20.glVertexAttribPointer(mColorHandle, mColorDataSize, GLES20.GL_FLOAT, false, 0, mCubeColors);
    GLES20.glEnableVertexAttribArray(mColorHandle);

    // Pass in the texture coordinate information
    mCubeTextureCoordinates.position(0);
    GLES20.glVertexAttribPointer(mTextureCoordinateHandle, mTextureCoordinateDataSize, GLES20.GL_FLOAT, false, 0, mCubeTextureCoordinates);
    GLES20.glEnableVertexAttribArray(mTextureCoordinateHandle);

    // This multiplies the view matrix by the model matrix, and stores the
    // result in the MVP matrix
    // (which currently contains model * view).
    Matrix.multiplyMM(mMVPMatrix, 0, mViewMatrix, 0, mModelMatrix, 0);

    // Pass in the modelview matrix.
    GLES20.glUniformMatrix4fv(mMVMatrixHandle, 1, false, mMVPMatrix, 0);

    // This multiplies the modelview matrix by the projection matrix, and
    // stores the result in the MVP matrix
    // (which now contains model * view * projection).
    Matrix.multiplyMM(mMVPMatrix, 0, mProjectionMatrix, 0, mMVPMatrix, 0);

    // Pass in the combined matrix.
    GLES20.glUniformMatrix4fv(mMVPMatrixHandle, 1, false, mMVPMatrix, 0);

    // Draw the cube.
    GLES20.glDrawArrays(GLES20.GL_TRIANGLES, 0, 6);
} 
```

分配 mTextureUniformHandle ：

`mTextureUniformHandle = GLES20.glGetUniformLocation(mProgramHandle, "u_Texture");`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-05T09:54:28.227

最近我一直在片段着色器中搜索多个纹理，并遇到了这个[Binding textures to samplers](http://www.opengl.org/wiki/Sampler_(GLSL)#Binding_textures_to_samplers)

我从中得到了以下工作：

在`onSurfaceCreated`或`onSurfaceChanged`：

*   加载着色器（附加和链接）并获取 sampler2D（和其他变量）的统一位置：

`normalMapLoc = GLES20.glGetUniformLocation(shaderProgram, "normalMap"); shadowMapLoc = GLES20.glGetUniformLocation(shaderProgram, "shadowMap");`

*   加载纹理：

`GLES20.glGenTextures(2, textures, 0); GLES20.glActiveTexture(GLES20.GL_TEXTURE0); GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textures[0]); GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST); GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_NEAREST); GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, 0, bitmap, 0); bitmap.recycle(); GLES20.glActiveTexture(GLES20.GL_TEXTURE1); GLES20.glBindTexture(GL10.GL_TEXTURE_COORD_ARRAY, textures[1]); GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST); GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_NEAREST); GLES20.glTexImage2D(GLES20.GL_TEXTURE_2D, 0, GLES20.GL_RGBA, width, height, 0, GLES20.GL_RGBA, GLES20.GL_UNSIGNED_BYTE, mColorBuffer); GLES20.glUniform1i(normalMapLoc, 0); // Texture unit 0 is for normal images. GLES20.glUniform1i(shadowMapLoc, 1); // Texture unit 1 is for shadow maps.`

在`onDrawFrame`：

`GLES20.glClearColor(0f, 0f, 0f, 0f); GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT | GLES20.GL_DEPTH_BUFFER_BIT); // pass variables to the fragment shader ... // get handle to vertex shader's Position member, etcetera int mPositionHandle = GLES20.glGetAttribLocation(shaderProgram, "vPosition"); GLES20.glEnableVertexAttribArray(mPositionHandle); GLES20.glVertexAttribPointer(mPositionHandle, 3, GLES20.GL_FLOAT, false, 0, mVertexBuffer); GLES20.glDrawElements(GLES20.GL_TRIANGLE_STRIP, 4, GLES20.GL_UNSIGNED_SHORT, mIndexBuffer);`

最后片段着色器看起来像这样（仅相关的代码部分）：

```
 uniform sampler2D normalMap, shadowMap;
    varying vec2 pos;

    void main() {
      vec4 color = texture2D(normalMap, pos);
      vec4 shadow = texture2D(shadowMap, pos);
      // do stuff with the colors
      ...
      gl_FragColor = ...;
    } 
```

这样我终于能够访问两种纹理！

希望这可以帮助。

# c - try 锁的源代码是什么？

> ID：12876707
> 
> 赞同：1
> 
> 时间：2012-10-13T20:30:26.767
> 
> 标签：c, mutex, semaphore

所以我想我了解信号和等待的源代码（等待是锁），但我不确定如何实现尝试锁。这是我等待的代码：

```
//if s->type is zero it is a binary semaphore type
if (s->type == 0)
    {
            // binary semaphore
            // if state is zero, then block task

            if (s->state == 0)
            {
                             // block task

                    // ?? move task from ready queue to blocked queue

                              //reschedule the tasks
                    return 1;
            }
            // state is non-zero (semaphore already signaled)
            s->state = 0;                // reset state, and don't block
            return 0;
    }
    else
    {
            // counting semaphore
            s->state--;
            // ?? implement counting semaphore
            if (s->state < 0)
            {

            }
    } 
```

到目前为止，这是我尝试锁定的内容：

```
if (s->type == 0)
{
            // binary semaphore
            // if state is zero, then block task

            if (s->state == 0)
            {
                    tcb[curTask].event = s;         // block task
                    tcb[curTask].state = S_BLOCKED;

                    removeNode(tcb[curTask].priority, READY_QUEUE, curTask);
                    enqueue(tcb[curTask].priority, curTask, BLOCKED_QUEUE);
                    return 1;
            }
            // state is non-zero (semaphore already signaled)
            s->state = 1;                                           // reset state, and don't block
            return 0;
}
else
{
        s->state--;
        if (s->state >= 0)
        {
            s->state++;
        }
        else
        {
            tcb[curTask].event = s;
            tcb[curTask].state = S_BLOCKED;
            removeNode(tcb[curTask].priority, READY_QUEUE, curTask);
            enqueue(tcb[curTask].priority, curTask, BLOCKED_QUEUE);
        }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T03:41:46.980

一个常规的自旋锁是这样实现的（伪 C-codish）：

```
void lock(locktype_t* LockVariable)
{
  while (CompareAndSwap(LockVariable,
                        STATE_UNLOCKED /* state to wait for */,
                        STATE_LOCKED /* new state to try to set */) !=
         STATE_UNLOCKED /* expected state at the beginning of CAS() */)
  {
    // spin here, doing nothing useful, waiting for *LockVariable to
    // first become STATE_UNLOCKED (CAS() returns its last value), after
    // which we will set it to STATE_LOCKED (CAS() will do that atomically)
  }
}

void unlock(locktype_t* LockVariable)
{
  *LockVariable = STATE_UNLOCKED;
} 
```

如果不希望无限期旋转并等待锁第一次解锁，我们使用上述的无循环变体，如下所示：

```
int tryToLock(locktype_t* LockVariable)
{
  if (CompareAndSwap(LockVariable,
                     STATE_UNLOCKED /* state to wait for */,
                     STATE_LOCKED /* new state to try to set */) !=
      STATE_UNLOCKED /* expected state at the beginning of CAS() */)
  {
    return 0; // the lock is still held by someone else, bail out
  }
  return 1; // the lock is now held by us, hurray!
} 
```

[比较和交换](http://en.wikipedia.org/wiki/Compare-and-swap)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T18:55:05.530

我正在寻找一个非自旋锁trylock。我已经想好该怎么做了。如果它是一个计数信号量，那么如果计数为正，我会递减并消耗资源。如果它是零或更少，我什么也不做，只返回一个错误代码。我不会减少计数或消耗资源。然后程序能够继续超过那个点。如果它是二进制信号量，我会在资源可用时使用它。然后我将二进制信号量的值更改为已消耗。如果它不可用，那么我返回一个错误代码。

# javascript - 通过javascript以html形式更新文本输入的bg颜色

> ID：12876710
> 
> 赞同：0
> 
> 时间：2012-10-13T20:30:52.210
> 
> 标签：javascript, html, forms, html-input

我有一个表单，我想在用户提交之前对其进行验证。为此，我编写了一个基本的 js 文件，用于检查值是否留空。在这种情况下，我希望文本字段的背景颜色更新为红色。我在网上环顾四周，正在努力让这个工作。这是我到目前为止所拥有的：

**HTML 表单：**

```
<script language="javascript" src="validateForm.js"></script>
<form name="contact form">
    <input  type="text" name="name"></td>
    <input type="button" value="Send" onsubmit="return validateForm()" method="post">
</form> 
```

**Javascript：**

```
function validateForm()
{
var result = true;
var form = document.forms["contact form"];

// Name
var name = form["name"].value;
if ( name == null || name == "" )
{
    form["name"].style.backgroundColor = red;
    result = false;
}

return result;
} 
```

请有人可以帮我完成这项工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T20:35:57.013

使用红色作为字符串（你错过了引号） [jsfiddle](http://jsfiddle.net/vQ3rX/)

```
form["name"].style.backgroundColor = "red"; // not red 
```

# c++ - 在 C++ 中从头开始制作 TCP 套接字

> ID：12876716
> 
> 赞同：1
> 
> 时间：2012-10-13T20:31:15.583
> 
> 标签：c++, sockets, tcp

我正在尝试在不使用任何非标准库的情况下在 C++ 中设置一个简单的 TCP 套接字。我想制作一个客户端套接字和一个服务器客户端，并将一个整数从客户端传递给服务器。有人可以给我一个服务器和客户端类的简单示例吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T20:39:45.683

C++ 不附带用于套接字的“标准库”，但当然可以访问用于套接字的标准 C 库。

```
#include <sys/socket.h>

sockaddr_in addr;
bzero(&addr, sizeof(addr));
addr.sin_family = AF_INET;
addr.sin_addr.s_addr = inet_addr(destination_address_as_32bit_number);
addr.sin_port = htons(destination_port_number_as_16bit_number);

int s = socket(AF_INET, SOCK_STREAM, 0);
connect(s, &addr, sizeof(addr)); 
```

你去...现在你可以像任何其他文件一样读取和写入“s”。
在服务器上你做的有点不同：

```
#include <sys/socket.h>

sockaddr_in addr;
bzero(&addr, sizeof(addr));
addr.sin_family = AF_INET;
addr.sin_addr.s_addr = 0; // bind to all interface addresses
addr.sin_port = htons(local_port_number_as_16bit_number);

int s = socket(AF_INET, SOCK_STREAM, 0);
bind(s, &addr, sizeof(addr));
listen(s, 50);  // 50 (the backlog) isn't really used on modern systems
int c = accept(s, &addr, sizeof(addr));  // addr gets info about client 
```

现在您可以像任何文件一样读取/写入“c”。"s" 是监听套接字，你在它上面什么也不做，除了`accept()`.

# php - 为什么我不能提交包含函数 fgets() 的文本？

> ID：12876719
> 
> 赞同：4
> 
> 时间：2012-10-13T20:31:29.580
> 
> 标签：php, html, fgets

我在学校期间使用我的网站在线编码（并在我的编程项目中取得进展），并将代码发送到我的电子邮件地址以继续在家中工作。

文本可以在一个`<textarea>`或一个`<input>`字段内（带有`name="Code" id="Code"`）。
无论哪种方式，我都无法提交包含 C/C++ 函数的文本**`fgets()`**：

```
TODO: Include a more stable function to get user input,
      such as fgets(input, 20, stdin); 
```

我不知道为什么提交 text:`fgets(input, 20, stdin)`会是一个问题，以及为什么a or中的*任何*文本都会是一个问题，因为它只是纯文本，而不是实际代码。`<textarea>``<input>`

当我单击提交时，我的`<textarea>`contains 中的文本`fgets()`没有任何反应（而不是给我`Invalid input`消息或`Email Sent`消息），并且我的文本没有被发送。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-13T20:36:41.437

可能是您服务器上的某些东西将此视为企图入侵该网站。

快速谷歌搜索显示`mod_security`（一个相当常见的 Apache 模块，它试图阻止 SQL 注入和其他漏洞利用）可能会阻止`POST`包含`fgets()`调用的参数。[http://forums.modx.com/thread?thread=9677](http://forums.modx.com/thread?thread=9677)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T20:39:54.730

您不应该自己将参数转换为一个字符串（或者如果是这样，请使用一些[javascript 替代 phps`urlencode()`](http://www.w3schools.com/jsref/jsref_encodeuricomponent.asp)）。

jQuery 支持[[1]](http://api.jquery.com/jQuery.post/) , [[2]](http://api.jquery.com/jQuery.ajax/) `data`作为[匿名对象](http://3dmdesign.com/development/javascript-variables-and-anonymous-objects)

> 要发送到服务器的数据。如果还不是字符串，则将其转换为查询字符串。它附加到 GET 请求的 url。请参阅 processData 选项以防止此自动处理。对象必须是键/值对。如果 value 是一个数组，jQuery 会根据传统设置的值（如下所述）序列化具有相同键的多个值。

所以你可以使用：

```
data: {
  'Name': name,
  'Code': code,
  ...
} 
```

它应该可以工作，更重要的是它需要注意正确的编码（转义）。如果这没有帮助（问题不在于格式错误的“*原始数据*”），请尝试 [ceejayoz 的解决方案](https://stackoverflow.com/a/12876762/1149736)。

# mysql - Vb.net Mysql：转义字符串

> ID：12876725
> 
> 赞同：1
> 
> 时间：2012-10-13T20:32:31.067
> 
> 标签：mysql, vb.net, prepared-statement, mysql-real-escape-string

这是一个非常快速的问题

在数据库中更新或插入数据的一种方法是使用准备好的语句，如下所示：

```
Dim cmd As New MySqlCommand("UPDATE `table` SET `field` = ?value", con)
cmd.Parameters.AddWithValue("?value", "user given value")
cmd.ExecuteNonQuery() 
```

这样做是为了防止任何 SQL 注入的机会。我的问题是我是否使用 mysqlHelper 类来转义字符串。它等同于准备好的陈述吗？换句话说，SQL 注入仍然可能吗？

**这是我如何使用转义字符方法**

```
Dim cmd As New MySqlCommand("UPDATE `table` SET `field` =" & MySqlHelper.EscapeString("user given value"),con)
cmd.ExecuteNonQuery() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:51:37.297

是的，但通常最好通过使用参数以正确的方式进行。不建议使用上述内容。

[看看这里](https://stackoverflow.com/questions/2020373/escaping-values-in-sql-queries-c-with-sql-connector)

# java - 数据库中的持久日期不等于检索日期

> ID：12876726
> 
> 赞同：6
> 
> 时间：2012-10-13T20:32:39.990
> 
> 标签：java, mysql, hibernate

我有一个具有 Date 属性的简单实体类。此属性对应于 MySQL 日期时间列。

```
@Entity
public class Entity {

    @Column(name = "start_date")
    @Temporal(TemporalType.TIMESTAMP)
    private java.util.Date startDate;

} 
```

这是我编写的集成测试的样子：

```
java.util.Date now = new java.util.Date();
Entity entity = new Entity();
entity.setStartDate(now);
entityService.save(entity); // save entity to database
entity = entityService.get(entity.getId()); // get entity back from database
Assert.assertEquals(entity.getStartDate(), now); 
```

我希望这两个日期相等，但事实并非如此！实际上，我有：

```
now.getTime() = 1350160029831
entity.getStartDate().getTime() = 1350160029000 
```

所以两个日期之间有一个小的差距。我真的很想知道这个差距可能来自哪里。它并不总是相同的，并且每次我开始测试过程时都会有所不同。在我的数据库中，存储的日期是 2012-10-13 22:15:38.0。

我真的需要在某处清除毫秒吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T20:45:02.127

从[MySQL 文档](https://dev.mysql.com/doc/refman/5.0/en/datetime.html)：

> DATETIME 或 TIMESTAMP 值可以包括以微秒（6 位）精度为单位的尾随小数秒部分。尽管可以识别此小数部分，但它会从存储到 DATETIME 或 TIMESTAMP 列中的值中丢弃。有关 MySQL 中小数秒支持的信息，请参阅第 11.1.5.6 节，“时间值中的小数秒”。

请注意，无论如何您都不应该使用 equals 来比较日期，因为各种 Date 子类都有错误的实现，这会导致以下问题`a.equals(b) && !b.equals(a)`：

```
java.util.Date d1 = java.sql.Date.valueOf("2012-01-01");
java.util.Date d2 = new java.util.Date(d1.getTime());
java.util.Date d3 = new java.sql.Timestamp(d1.getTime());

System.out.println(d1.equals(d2)); // true
System.out.println(d2.equals(d1)); // true
System.out.println(d1.equals(d3)); // true
System.out.println(d3.equals(d1)); // false
System.out.println(d2.equals(d3)); // true
System.out.println(d3.equals(d2)); // false 
```

# xml - 制作屏幕保护程序

> ID：12876738
> 
> 赞同：0
> 
> 时间：2012-10-13T20:33:38.160
> 
> 标签：xml, windows, directx, screensaver

不，我不是在谈论制作图片幻灯片。如何制作 windows（至少 windows 7）用于屏幕保护程序的实际文件？

它是 .scr 格式，当我在记事本中打开它时，我得到了一堆符号，其中散落着几个单词，但这是意料之中的。看起来它是用directx、xml，甚至是基于那里可识别代码的程序集（用于着色器）制作的。

我只是去了一个网站托管的地方并做了这个：

[链接到ribbons.scr 代码](http://stackoverflowquestion.webs.com)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T21:32:27.067

这是一个如何制作屏幕保护程序的示例。 [http://msdn.microsoft.com/en-us/library/windows/desktop/ms686421(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686421(v=vs.85).aspx)

# java - 在 Windows 7 上创建文件会导致“拒绝访问”异常

> ID：12876743
> 
> 赞同：2
> 
> 时间：2012-10-13T20:34:13.123
> 
> 标签：java, windows-7, access-denied

我有一个 Java 应用程序，用户可以使用以下代码创建一个文本文件并将其保存在他想要的计算机上的任何位置：

```
File txtFile = new File( path );
Writer writer = new BufferedWriter( new OutputStreamWriter( new FileOutputStream( txtFile ), "UTF-8" ) );  // Error occurs here. 
```

但是许多使用 Windows 7 的用户报告说，当将文件保存到**"C:\"**时，他们会收到 " **Access is denied** " 错误。我发现这是因为他们需要管理员权限才能在 Win7 中将文件保存在这样的路径中。

除了向用户显示警告消息：“*您无法将文件保存在此路径*”之外，我能否以某种方式将文件保存在此路径中，例如是否有办法通过 Java 代码在 Win7 中获得管理员权限，或者类似的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T20:38:21.080

简短的回答 - 不。

如果需要保存到C盘，则需要权限。如果这个程序只需要创建文件，你可以使用用户临时文件夹。请参阅 System.getProperty()

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T20:36:24.027

Windows Vista 和 Windows 7 启用了 UAC。UAC 拒绝在某些位置创建新文件，没有管理权限。

检查您的权限并确保在 ADMINISTRATIVE 帐户中执行 java 可执行文件，或禁用 UAC。

为此，请转到“开始”，键入“CMD.EXE”-> 右键单击​​ cmd.exe 文件并以管理员身份运行。然后导航到包含 .class 文件的位置。然后输入`java ClassFile`并按回车

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-13T20:43:57.603

您是在使用 cmd ，即 Dos 来运行您的文件还是 eclipse？无论您使用什么，看起来您都以默认用户身份运行。在 Windows 7 中，默认情况下 UAC 将写入 system.directory。

执行以下操作，希望它应该工作1

```
> If cmd.exe
>      Then when you open run from start menu. Right click it, select run as administrator and  then run your application
>     
>     If eclipse/any other IDE
>     
>     Close existing, right clicl eclipse,select run as admim and then run your application
> 
> Hope this helps 
```

# javascript - 来自php的多维json

> ID：12876744
> 
> 赞同：1
> 
> 时间：2012-10-13T20:34:26.450
> 
> 标签：javascript, jquery, json

我看不到访问我的 json 对象中最深的值。这是一组图像，内容如下：

```
{
   "imgs":[
      {
         "Landscape":{
            "2":"DSCF2719.jpg",
            "3":"DSCF2775.jpg",
            "4":"IMG_1586.jpg",
            "5":"Red Rose.jpg",
            "6":"untitled030617.jpg",
            "7":"untitled071756.jpg",
            "8":"untitled170744.jpg",
            "9":"untitled170907.jpg",
            "10":"untitled235450.jpg"
         }
      },
      {
         "People":{
            "2":"IMG_0775.jpg",
            "3":"untitled011003.jpg",
            "4":"untitled011809.jpg",
            "5":"untitled024716.jpg",
            "6":"untitled114229.jpg",
            "7":"untitled120704-1.jpg",
            "8":"untitled120704.jpg",
            "9":"untitled203242.jpg",
            "10":"untitled222816.jpg",
            "11":"untitled231442-2.jpg"
         }
      },
      {
         "Still Life":{
            "2":"DSCF2769.jpg",
            "3":"untitled001620.jpg",
            "4":"untitled010832.jpg",
            "5":"untitled112413.jpg",
            "6":"untitled152613.jpg",
            "7":"untitled232940.jpg"
         }
      },
      {
         "Test":{
            "2":"DSCF2719.jpg",
            "3":"DSCF2769.jpg",
            "4":"DSCF2775.jpg",
            "5":"IMG_0775.jpg",
            "6":"IMG_1586.jpg",
            "7":"Red Rose.jpg",
            "8":"untitled001620.jpg",
            "9":"untitled010832.jpg",
            "10":"untitled011003.jpg",
            "11":"untitled011809.jpg",
            "12":"untitled024716.jpg",
            "13":"untitled030617.jpg",
            "14":"untitled071756.jpg",
            "15":"untitled112413.jpg",
            "16":"untitled114229.jpg",
            "17":"untitled120704.jpg",
            "18":"untitled152613.jpg",
            "19":"untitled170744.jpg",
            "20":"untitled203242.jpg",
            "21":"untitled222816.jpg",
            "22":"untitled231442-2.jpg",
            "23":"untitled232940.jpg",
            "24":"untitled235450.jpg"
         }
      }
   ],
   "cats":[
      "Landscape",
      "People",
      "Still Life",
      "Test"
   ]
} 
```

除了最深的集合之外，我可以访问所有内容：

```
// accessed with $.ajax()
var obj = $.parseJSON(msg)
console.log(obj.cats[0]) // "Landscape"
console.log(obj.imgs[0][5]) // undefined
console.log(obj.imgs.length) // "3" 
```

我也尝试过在最深层次不使用联想方面，只是`"DSCF2719.jpg",`代替`"2":"DSCF2719.jpg",`

我好像在网上找不到这个。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:38:34.940

每个组都嵌套在类似 的类别下的对象中`Landscape, People`，但由于单个图像是数字属性，因此需要使用`[]`而不是更常见的 JavaScript 点属性表示法来访问它们。

```
// imgs is an Array, numerically indexed like [0]
// Landscape is an object in the first imgs element accessed via .Landscape
// 2 is a property of the Landscape object, but must be accessed with [2]
console.log(obj.imgs[0].Landscape[2]);
// "DSCF2719.jpg"

console.log(obj.imgs[0].People[6]); 
// "untitled114229.jpg" 
```

外部对象的最后一个属性`cats`只是一个数组，通过数字索引访问：

```
console.log(obj.cats[0]);
// Landscape 
```

### 编辑：要循环获取图像：

```
// Loops over imgs
for (var i=0; i<obj.imgs.length; i++) {
  var catName = obj.cats[i]; // Landscape, People, etc...
  // Use catName inside []
  // and a for-in loop to get the subsequent numeric properties
  for (var imgNum in obj.imgs[i][catName]) {
    console.log(obj.imgs[i][catName][imgNum]);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T20:48:08.423

obj.imgs[0] 是一个对象。它是唯一具有“景观”属性的。该属性的值是具有 9 个属性的对象。所以你应该尝试访问 obj.imgs[0][Landscape][5]。

但正如我所见，您的目标是将“cats”中的索引与“imgs”中的索引配对，在这种情况下，对于cats [0]，您应该更具描述性地访问obj.imgs [cats [0]] [5]。

请注意，最里面的列表不是索引而是命名的。5 不是第六个元素的索引，而是第四个元素的名称，所以它产生了红玫瑰。由于该对象没有提供有关最内层数组中存在哪些键的直接信息，因此您可以使用 for(x in ...) 循环来查找所有元素。

# colors - 如何在 RMagick 中使用 HSLA 颜色？

> ID：12876745
> 
> 赞同：1
> 
> 时间：2012-10-13T20:34:26.307
> 
> 标签：colors, imagemagick, rmagick, hsl

如何设置任意 HSLA 颜色而不是`gray20`？

```
draw = Magick::Draw.new
draw.font_family = 'arial'
draw.pointsize = 12
draw.gravity = Magick::CenterGravity
draw.annotate(@canvas, size,size, x,y, text) { self.fill = 'gray20' } 
```

另外，使用 gc.rectangle，如何设置填充的 HSLA 颜色？

```
gc = Magick::Draw.new
gc.fill ????
gc.rectangle(x,y, x + size,y + size) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T22:05:17.430

从 RMagick[文档](http://www.imagemagick.org/RMagick/doc/imusage.html#color_names)：

> 许多 RMagick 方法需要颜色名称参数或返回颜色名称。颜色名称可以是
> 
> 1.  X11 颜色名称，例如“red”、“chocolate”或“lightslategray”。
> 2.  SVG 颜色名称（类似于 X 颜色名称），或
> 3.  下表中显示的格式之一的字符串。
> 
> ...
> 
> hsla(h,s,l,a)

和 HSL[文档](http://www.imagemagick.org/script/color.php)

> hsla(33.3333%, 100%, 50%, 1.0) 绿色，alpha 值为 1.0
> 
> hsla(120, 255, 127.5, 1.0) 绿色，alpha 值为 1.0

所以，使用一个字符串：`fill 'hsl(0%,100%,100%,1)'`

# c# - 如何确保我正在启动的进程将关闭我的应用程序崩溃

> ID：12876747
> 
> 赞同：1
> 
> 时间：2012-10-13T20:34:39.143
> 
> 标签：c#, winforms

在我的应用程序中，我打开 Wireshark 进程并开始捕获包，在 UI 中，我有开始捕获的开始按钮和停止捕获的停止按钮，我通过终止我的 wireshark 进程来做到这一点。我的问题是，如果我在捕获过程中关闭了我的应用程序，但也没有使用我的停止按钮，我的 Wireshark 进程继续运行，我该如何处理这种情况并确保如果我的应用程序崩溃或有人关闭它，我的进程将关闭在捕获中

```
public void startCapturing()
{            
    ThreadStart tStarter = delegate { openAdapterForStatistics(_device); };
    Thread thread = new Thread(tStarter);
    thread.IsBackground = true;
    thread.Start();
    ProcessStartInfo tsharkStartInfo = new ProcessStartInfo();
    tsharkStartInfo.FileName = _tshark; 
    tsharkStartInfo.RedirectStandardOutput = true; 
    tsharkStartInfo.RedirectStandardError = true; 
    tsharkStartInfo.RedirectStandardInput = true; 
    tsharkStartInfo.UseShellExecute = false; 
    tsharkStartInfo.CreateNoWindow = true; 
    tsharkStartInfo.Arguments = string.Format(" -i " + _interfaceNumber + " -s " + _packetLimitSize + " -w " + _pcapPath);
    _tsharkProcess.StartInfo = tsharkStartInfo;
    _tsharkProcess.ErrorDataReceived += _cmdProcess_ErrorDataReceived;
    _tsharkProcess.OutputDataReceived += tshark_OutputDataReceived; 
    _tsharkProcess.EnableRaisingEvents = true; 
    _tsharkProcess.Start();
    _tsharkProcess.BeginOutputReadLine(); 
    _tsharkProcess.BeginErrorReadLine();                  
    FileInfo fileInfo = new FileInfo(_pcapPath);
    string directoryName = fileInfo.DirectoryName;
    DirectoryInfo directoryInfo = new DirectoryInfo(directoryName);
    FileInfo[] dirs = directoryInfo.GetFiles();
    _file = dirs.FirstOrDefault(f => f.Name.Equals(fileInfo.Name));
    _tsharkProcess.WaitForExit(); 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:52:58.237

假设您正在使用 处理异常`try-catch`，您可以确保 Wireshark 进程在最顶层语句`finally`末尾的块中关闭。`try-catch`从 MSDN 文档：

“finally 块对于清理 try 块中分配的任何资源很有用。无论 try 块如何退出，控制总是传递给 finally 块。”

例如：

```
try
{
    // Your application's code.
}
catch( Exception )
{
    // Handle, log, whatever.
}
finally
{
    // Make sure Wireshark process is killed.
} 
```

`finally`无论是否有异常，块中的代码都会被执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T21:51:56.737

你不能百分百确定。如果您的应用程序以“文明”方式崩溃，您可以关闭 Wireshark 进程（很像@jebar8 建议的）。不幸的是，您的应用程序可能会以无法运行`finally`代码的方式崩溃（例如，如果它内存不足或您的主线程超出堆栈空间）。

如果你也想考虑到这一点，你需要第三个过程。编写一个小程序来启动您的应用程序并对其进行监控。如果您的应用程序进程消失，那么您的监控进程可以杀死 Wirehsark（如果它还活着）。由于监控程序是一个简短而简单的程序，它意外崩溃的可能性非常小。

# ruby-on-rails - 将外部提供者添加到巫术

> ID：12876748
> 
> 赞同：1
> 
> 时间：2012-10-13T20:34:44.907
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, sorcery

我有一个带有身份验证的应用程序，它已经通过设计完成并使用omniauth从各种提供商（包括vk.com、google、twitter等）登录。一切似乎都运行良好，除了我需要为每个提供者包含一个单独的 gem。

现在我决定简化身份验证并添加一些日志记录，所以我决定从设计转向巫术。但是现在我遇到了外部提供商的问题，因为 gem 只有少数（没有 vk.com 或 yahoo，我确实需要）。

我试图理解外部提供者的代码以添加我自己的代码，但这对我来说似乎有点太复杂了。有没有更简单的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-28T23:26:55.717

以防万一有人在寻找类似答案时发现此问题，Sorcery 现在确实包括大多数主要登录的外部身份验证。看：

[https://github.com/NoamB/sorcery/wiki/External](https://github.com/NoamB/sorcery/wiki/External)

安装 External 模块后，在您的 Rails 应用程序中，您将拥有一个文件：config/initializers/sorcery.rb。其中将有大多数提供者的示例代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T14:33:10.590

我不认为你会找到一个简单的解决方案。

我在我工作的最后一个应用程序中遇到了这个问题。我最终选择了 Sorcery 和 Omniauth。我将它们集成在用户模型和会话控制器中。Sorcery 的外部提供者的东西似乎没有保持最新。

最后，如果我不得不再做一次，我可能会从头开始进行身份验证。巫术很好，但它似乎不足以保证额外的依赖。

如果从头开始进行身份验证是您最终的方式，您可以查看以下资源：

1.  [https://github.com/NoamB/sorcery/tree/master/lib](https://github.com/NoamB/sorcery/tree/master/lib)
2.  [https://github.com/railscasts/250-authentication-from-scratch-revised](https://github.com/railscasts/250-authentication-from-scratch-revised)

# android - 可以以编程方式打开“立即发言”对话框吗？

> ID：12876751
> 
> 赞同：2
> 
> 时间：2012-10-13T20:35:30.073
> 
> 标签：android, android-edittext

是否可以以编程方式打开“立即发言”对话框？

目前，如果用户点击我的“搜索”按钮，则会打开一个对话框，并且我会自动打开软键盘，因此用户无需点击 textedit 字段。

我想提供一个替代的“语音搜索”，它会打开对话框并自动打开“现在说话”窗口。因此用户不必在键盘上找到并点击“麦克风”按钮。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T22:24:32.770

对的，这是可能的。查看`ApiDemos`Android SDK 中的示例。有一个名为 的活动`VoiceRecognition`，它利用[`RecognizerIntent`](http://developer.android.com/reference/android/speech/RecognizerIntent.html).

基本上，你需要做的就是用一些额外的东西来创造一个适当的意图，然后阅读结果。

```
private static final int VOICE_RECOGNITION_REQUEST_CODE = 1234;

private void startVoiceRecognitionActivity() {
    Intent intent = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
    // identifying your application to the Google service
    intent.putExtra(RecognizerIntent.EXTRA_CALLING_PACKAGE, getClass().getPackage().getName());
    // hint in the dialog
    intent.putExtra(RecognizerIntent.EXTRA_PROMPT, "Speech recognition demo");
    // hint to the recognizer about what the user is going to say
    intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL,
                    RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
    // number of results
    intent.putExtra(RecognizerIntent.EXTRA_MAX_RESULTS, 5);
    // recognition language
    intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE,"en-US");
    startActivityForResult(intent, VOICE_RECOGNITION_REQUEST_CODE);
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == VOICE_RECOGNITION_REQUEST_CODE && resultCode == RESULT_OK) {
        ArrayList<String> matches = data.getStringArrayListExtra(
                    RecognizerIntent.EXTRA_RESULTS);
        // do whatever you want with the results
    }
    super.onActivityResult(requestCode, resultCode, data);
} 
```

# ruby - 有多个工人和暴发户的延迟工作

> ID：12876755
> 
> 赞同：2
> 
> 时间：2012-10-13T20:35:51.613
> 
> 标签：ruby, delayed-job

我想将我的单个延迟作业流程切换到多个工作人员。我目前有一个新贵的工作，它运行 rake 并使用没有“预期分叉”的 respawn 方法，因为 rake 不会分叉。现在要切换到多工人方法，我需要在我的新贵配置文件中“期待”。有什么建议么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-08-11T13:37:17.753

开箱即用，新贵*expect*似乎不支持[https://github.com/collectiveidea/delayed_job#running-jobs](https://github.com/collectiveidea/delayed_job#running-jobs)中概述的行为，因为有多个工作人员每个分叉两次来守护进程。

正如这个关于暴发户的问题所述：[暴发户期望/重生可以用于分叉两次以上的进程吗？](https://stackoverflow.com/questions/12200217/can-upstart-expect-respawn-be-used-on-processes-that-fork-more-than-twice)，您可以使用一些脚本自己在不同的钩子中引导进程。

另一种选择是使用新贵作业实例（[http://upstart.ubuntu.com/cookbook/#instance](http://upstart.ubuntu.com/cookbook/#instance)）来启动多个不分叉的作业。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T22:14:00.083

我不是很清楚你在问什么。但是，如果您希望多个延迟作业在后台运行，当您使用诸如 rake Jobs:Work 之类的命令启动延迟作业时，您可以指定要生成的使用者线程的数量。希望它可以帮助你。

# c++ - (C++) 将文件加载到向量中

> ID：12876760
> 
> 赞同：1
> 
> 时间：2012-10-13T20:36:28.460
> 
> 标签：c++, file-io, vector

> **可能重复：**
> [将文件读入 std::vector<char> 的有效方法？](https://stackoverflow.com/questions/4761529/efficient-way-of-reading-a-file-into-an-stdvectorchar)

这可能是一个简单的问题，但是我是 C++ 新手，我无法弄清楚。我正在尝试加载二进制文件并将每个字节加载到向量中。这适用于一个小文件，但是当我尝试读取大于 410 字节时，程序崩溃并说：

> 此应用程序已请求运行时以不寻常的方式终止它。请联系应用程序的支持团队以获取更多信息。

我在 Windows 上使用 code::blocks 。

这是代码：

```
#include <iostream>
#include <fstream>
#include <vector>

using namespace std;

int main()
{
    std::vector<char> vec;
    std::ifstream file;
    file.exceptions(
        std::ifstream::badbit
      | std::ifstream::failbit
      | std::ifstream::eofbit);
    file.open("file.bin");
    file.seekg(0, std::ios::end);
    std::streampos length(file.tellg());
    if (length) {
        file.seekg(0, std::ios::beg);
        vec.resize(static_cast<std::size_t>(length));
        file.read(&vec.front(), static_cast<std::size_t>(length));
    }

    int firstChar = static_cast<unsigned char>(vec[0]);
    cout << firstChar <<endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:40:03.637

我不确定你的代码有什么问题，但我刚刚用这段代码回答了一个类似的问题。

读取字节为`unsigned char`：

```
ifstream infile;

infile.open("filename", ios::binary);

if (infile.fail())
{
    //error
}

vector<unsigned char> bytes;

while (!infile.eof())
{
    unsigned char byte;

    infile >> byte;

    if (infile.fail())
    {
        //error
        break;
    }

    bytes.push_back(byte);
}

infile.close(); 
```

# c - 为什么我的程序不能识别另一个命令？

> ID：12876761
> 
> 赞同：0
> 
> 时间：2012-10-13T20:36:33.350
> 
> 标签：c

我目前正在编写一个程序的主要功能（到目前为止的基本功能）到目前为止我只包含了“结束”命令来结束程序。每当键入不是命令的其他任何内容时，它都会输出一条错误消息。但是，现在我在循环中输入了更多命令，它似乎没有识别出其他任何内容。我正在编写一个程序，在提示用户输入系数和指数后创建多项式。

该命令是 adc（添加系数命令），在一个空格之后，您应该添加一个代表系数的整数和另一个空格，另一个整数代表指数。

示例：adc 4 5 输出：4x^5

```
int main(void){
    char buf[5]; //Creates string array
    unsigned int choice;
    printf("Command? "); // Prompts user for command
    fflush(stdout);
    gets(buf); //Scans the input

    while(strncmp(buf, "end", 3) != 0) //Loop that goes through each case, so long as the command isn't "end".
    {
        switch( choice ){
        //Where the other cases will inevitably go
            if((strcmp(buf,"adc %d %d"))== 0){
            }
        break;
            default:
              printf("I'm sorry, but that's not a command.\n"); //Prints error message if input is not recognized command
    fflush(stdout);
              break;
        }
        printf("Command? "); //Recycles user prompt
        fflush(stdout);
        gets(buf);
    }
    puts("End of Program."); //Message displayed when program ends
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:39:31.347

您不能使用这样的格式字符串：`strcmp(buf,"adc %d %d")`测试某种输入。如果使用字面输入： ，您`strcmp`将仅表示字符串相等，*而不是*后跟两个整数。`"adc %d %d"` *`adc`*

 *您需要手动解析输入字符串，方法是在空格字符周围进行标记，使用`strcmp`eg检查第一个标记`adc`，然后分别解析数字。

我没有注意到`case`您的`switch`. 看起来您可以删除`switch`，因为您没有`choice`在任何地方使用。

另外，不要使用`gets`，`fgets`而是使用。*

# php - Codeigniter this->db->query

> ID：12876763
> 
> 赞同：4
> 
> 时间：2012-10-13T20:36:42.077
> 
> 标签：php, codeigniter

$this-db->query() 是否有 mysql 注入保护？我想知道，因为我在实例中使用它并且没有做任何事情来防止 sql 注入。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-13T21:30:35.897

不，db->query() 默认情况下不受 SQL 注入保护，您几乎没有选择。使用查询绑定

```
$sql = "SELECT * FROM some_table WHERE id = ? AND status = ? AND author = ?"; 
$this->db->query($sql, array(3, 'live', 'Rick')); 
```

对于更复杂的查询，您必须在继续时构建查询，请使用 compile_bind() 获取 SQL 块。

```
$sql = "SELECT * FROM some_table WHERE id = ? AND status = ? AND author = ?"; 
$safe_sql  = $this->db->compile_bind($sql, array(3, 'live', 'Rick')); 
```

等等

或者在参数上使用 escape $this->db->e​​scape()

```
$sql = "INSERT INTO table (title) VALUES(".$this->db->escape($title).")"; 
```

最好的做法是首先使用表单验证，并将 xss_clear、max_length 等内容与上述任何一种方式结合使用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-13T20:51:59.760

使用 CodeIgniter 进行查询的 ActiveRecord 样式会转义参数，但不会转义 query()。

您可以通过这种方式使用活动记录：

```
$someAge = 25;
$this->db->select('names, age');
$query = $this->db->get_where('people', array('age' => '>' . $someAge)); 
```

在此处阅读更多信息：[https ://www.codeigniter.com/userguide2/database/active_record.html](https://www.codeigniter.com/userguide2/database/active_record.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-25T02:12:18.353

您可以使用[查询绑定](https://codeigniter.com/userguide3/database/queries.html#query-bindings)。

CI 3 用户指南中的示例：

```
$sql = "SELECT * FROM some_table WHERE id = ? AND status = ? AND author = ?";
$this->db->query($sql, array(3, 'live', 'Rick')); 
```

# c++ - 确定在 C++11 中实现 bignums 的最有效字长？

> ID：12876765
> 
> 赞同：6
> 
> 时间：2012-10-13T20:36:45.260
> 
> 标签：c++, c++11, integer, portability, abi

通常 bignums 是通过使用多个单词来实现的，但我想尽可能便携地选择单词大小。这比看起来更棘手——`std::uint64_t`在许多 32 位编译器中都可用，但`std::uint32_t`在 32 位机器上可能是更好的选择。因此，诱惑将是使用 std::size_t，但不能保证给定架构`std::size_t`是最有效的算术类型，例如在[新的 x32 Linux ABI](http://en.wikipedia.org/wiki/X32_ABI) `std::size_t`上将是 32 位，但`std::uint64_t`仍然是最佳选择.

C++11 定义了各种大小的快速/最小类型，但它没有提供任何查询它们相对性能的方法。我意识到可能没有最好的可移植答案，我现在最好的猜测是`std::size_t`在配置时默认并检测异常架构。但也许有更好的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T00:19:33.993

有效实现 bignums 的真正关键是您需要有一个扩大的乘法，它可以为您提供 2 倍于基本字长的位。因此，如果您的平台支持 128 位乘法结果，您只能使用 uint64_t 作为基本字长。机器上指针的大小在很大程度上无关紧要。

如果您真的想要尽可能可移植的最有效的实现，您应该在编译时选择字长。然后有一个自动配置脚本（尝试）构建具有各种不同字长的代码，并测试这些构建结果的正确性和速度。

```
#define WORD_(SIZE)    std::uint ## SIZE ## _t
#define WORD(SIZE)     WORD_(SIZE)
#define X2_(SIZE)      X2_ ## SIZE
#define X2(SIZE)       X2_(SIZE)
#define X2_8           16
#define X2_16          32
#define X2_32          64
#define X2_64          128 
```

在您的代码中使用`WORD(WORD_SIZE)`and并使用or或or`WORD(X2(WORD_SIZE))`进行编译
`-DWORD_SIZE=8``16``32``64`

# tinymce - 如何在 Orchard TinyMCEDeluxe 中启用 TinyMCE 插件

> ID：12876767
> 
> 赞同：1
> 
> 时间：2012-10-13T20:37:01.067
> 
> 标签：tinymce, orchardcms

我已遵循[http://tinymcedeluxe.codeplex.com/上的所有指南](http://tinymcedeluxe.codeplex.com/)

我在我的主题文件夹下创建了以下 ResourceManifest.cs 文件：

```
using Orchard.UI.Resources;

namespace TinyMceDeluxe {
    public class ResourceManifest : IResourceManifestProvider {
        public void BuildManifests(ResourceManifestBuilder builder) {
            var manifest = builder.Add();
            manifest.DefineScript("OrchardTinyMce")
                .SetUrl("orchard-tinymce.js")
                .SetDependencies("TinyMce")
                .SetVersion("3.4.8"); 
        }
    }
} 
```

我在 Layout.cshtml 文件中添加了以下行：

```
Script.Require("OrchardTinyMce").AtFoot(); 
```

我已将 orcard.tinymce.js 文件复制到我的主题的脚本文件夹中。

加载了正确的文件，我可以使用 Firebug 进行检查。问题是，一旦我取消注释任何要使用的插件，TinyMCE 编辑器命令就会消失。例如：

```
////
//// Un-comment-out the tinymce.PluginManager.load commands for the plugins you want to use:
tinymce.PluginManager.load('advhr', '/Modules/TinyMceDeluxe/Scripts/plugins/advhr/editor_plugin.js');
//tinymce.PluginManager.load('advimage', '/Modules/TinyMceDeluxe/Scripts/plugins/advimage/editor_plugin.js');
//tinymce.PluginManager.load('advlink', '/Modules/TinyMceDeluxe/Scripts/plugins/advlink/editor_plugin.js');
//tinymce.PluginManager.load('advlist', '/Modules/TinyMceDeluxe/Scripts/plugins/advlist/editor_plugin.js');
... 
```

如果我取消注释 advhr 插件，TinyMCE 编辑器不会显示。如果我再次评论它，它会完美显示。不是一个插件工作。一旦我取消注释其中一个，即使我不在 TinyMCE.init 调用中使用它，它也不起作用。即使使用以下标准的 init：

```
tinyMCE.init({
    theme: "advanced",
    mode: "specific_textareas",
    editor_selector: "tinymce",
    plugins: "fullscreen,autoresize,searchreplace,mediapicker",
    theme_advanced_toolbar_location: "top",
    theme_advanced_toolbar_align: "left",
    theme_advanced_buttons1: "search,replace,|,cut,copy,paste,|,undo,redo,|,mediapicker,|,link,unlink,charmap,emoticon,codeblock,|,bold,italic,|,numlist,bullist,formatselect,|,code,fullscreen",
    theme_advanced_buttons2: "",
    theme_advanced_buttons3: "",
    convert_urls: false,
    valid_elements: "*[*]",
    // shouldn't be needed due to the valid_elements setting, but TinyMCE would strip script.src without it.
    extended_valid_elements: "script[type|defer|src|language]"
}); 
```

我不知道我是否做错了什么。我已经下载了包并解压缩，然后我将 TinyMceDeluxe 文件夹复制到了 Orchard.Web\Modules 文件夹。它现在位于标准 TinyMce 插件文件夹的下方。然后我在模块管理 UI 上启用了它。并创建了 ResourceManifest 并在我的主题文件夹中复制并配置了 orchard-tinymce.js 文件。

绝望中，我什至从我的主题文件夹中删除了 ResourceManifest.cs 文件和 orchard-tinymce.js 文件，并使用了 TinyMceDeluxe 模块本身下的所有内容，但它仍然无法正常工作。

有谁知道为什么会发生这种情况，以及为什么在 Orchard 中使用一些基本的 tinyMce 插件如此困难？我在 Wordpress 中从来没有遇到过问题 :-(。我可以在不使用模块的情况下手动添加所有内容吗？我会将它添加到我的主题中并尝试一下...

**编辑：**

Giscard 正确回答问题的罪魁祸首是我的 Orchard 应用程序的实际根路径。插件的加载尝试从根目录读取它们，但在 Visual Studio Orchard 中运行应用程序时，通常会像根路径是 OrchardLocal 一样运行它。这会产生很多问题，但它们是必要的问题，因为如果它没有以不同的 root 运行，您只会注意到在使用不同的 root 将站点部署在不同的环境中时需要注意不同的 root。所以我不得不像这样将根添加到所有插件加载中：

```
//tinymce.PluginManager.load('advhr', '/modules/tinymcedeluxe/scripts/plugins/advhr/editor_plugin.js');
tinymce.PluginManager.load('advhr', '/orchardlocal/modules/tinymcedeluxe/scripts/plugins/advhr/editor_plugin.js'); 
```

不幸的是，以硬编码的方式添加这个根前缀不会削减它，因为当部署到不同的服务器时它会失败，因为根可能会改变。

我不得不求助于一个肮脏的 JavaScript 技巧来解决它。我已将以下 JavaScript 代码放入 orchard-tinymce.js 文件中：

```
// Getting the root of the site by inspecting the script tag that just loaded this script...

var scripts = document.getElementsByTagName("script");
var scriptTag = scripts[scripts.length - 1];
var scriptPath = scriptTag.getAttribute("src");
var idx = scriptPath.indexOf("/Modules");
var appPath = scriptPath.substring(0, idx); 
```

现在 appPath 将保存我们应用程序根目录的路径。

然后我所要做的就是将插件加载代码更改为：

```
tinymce.PluginManager.load('table', appPath + '/modules/tinymcedeluxe/scripts/plugins/table/editor_plugin.js'); 
```

它正在工作，并且希望可以与任何根目录一起使用，或者即使该站点实际上位于根目录下（appPath 将返回一个空字符串）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T21:37:47.203

TinyMceDeluxe 作者在这里。巧合的是，几分钟前我刚刚发布了该模块的新版本。我建议您试用新版本 (v1.0.1)，因为它比以前的版本更容易运行。它现在是默认 TinyMce 模块的替代而不是附加组件，因此您只需禁用 TinyMce，然后启用 TinyMceDeluxe。

从 v1.0.1 开始，您不再需要触摸 resourcemanifest.cs，或覆盖任何视图/脚本/等。

TinyMceDeluxe 进入 Modules 文件夹，作为 TinyMce 的兄弟。您的模块文件夹将如下所示：

```
modules/
    TinyMce/
    TinyMceDeluxe/ 
```

然后自定义 /modules/tinymcedeluxe/scripts/orchard-tinymce.js。默认情况下，那里有一堆关于你可以改变什么的信息。

# javascript - 根据下拉选择添加新的列表行

> ID：12876769
> 
> 赞同：1
> 
> 时间：2012-10-13T20:37:31.613
> 
> 标签：javascript, jquery

我正在尝试以下。

我有根据下拉选择显示隐藏列表的功能。

请访问此处查看：

[http://jsfiddle.net/vSyK6/28/](http://jsfiddle.net/vSyK6/28/)

我要做的是选择option1时，它将显示＃list-option1内容的内容，如果选择了选项2，它将显示内容＃list-option2。

现在，我想要完成的是当显示两个内容时，如果您再次选择选项，它应该添加另一个列表并选择该选项。

基本上，如果我们按照这个顺序：

选项1....然后
选项2....然后

我们再次选择 Option1，它应该像这样显示

选项 1 内容
选项 2 内容
选项 1 内容

如果我们再次选择 Option2，它应该显示如下：

选项 1 内容
选项 2 内容
选项 1 内容
选项 2 内容

现在它会在列表的最后一行显示所选项目。它不会添加新的列表行。这个功能当然没有实现。我需要解决方案:-)

希望我有意义:)

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:51:49.113

我建议如下：

```
$('#List-Option1, #List-Option2').hide();

$('#category').change(function() {
    var str = $('#category').val();
    $('#List-' + str).clone(true, true).attr('id', function(i,v){
        return v.replace(/\d+/,'') + (parseInt($('#box li[id^="List-Option"]').length,10) + 1);
    }).appendTo('#box ul').show();
});​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/vSyK6/31/)。

参考：

*   [`attr()`](http://api.jquery.com/attr/).
*   [属性开始与 ( `attribute^="value"]`) 选择器](http://api.jquery.com/attribute-starts-with-selector/)。
*   [`clone()`](http://api.jquery.com/clone/).
*   [`parseInt()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt).
*   [`string.replace()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T20:46:50.837

更新[了 jsfiddle](http://jsfiddle.net/vSyK6/29/)。我正在使用 jQuery 克隆来创建新的选项内容。请注意，如果您想多次重复相同的代码，请不要使用 id。

# javascript - JSFIDDLE 在我的页面上不起作用

> ID：12876771
> 
> 赞同：1
> 
> 时间：2012-10-13T20:37:37.290
> 
> 标签：javascript, jquery

我有一个 JSFIDDLE 并试图让它在我的网络表单上工作，但它不工作。谁能告诉我我犯了什么错误。JSFIDDLE 工作得很好，但我不能让它只在我的页面上工作。这是小提琴的链接：[LINK](http://jsfiddle.net/Ywzjv/2/)

这就是我尝试使用它的方式：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script>
var devices = ['computer', 'router']
var device_types = {
    'computer': ['laptop', 'desktop'],
    'router': ['wireless', 'bluetooth']
}

var brands = {
    'laptop': ['HP', 'DELL'],
    'desktop': ['Apple', 'MAC'],
    'wireless':['Foo','Bar'],
    'bluetooth':['Grren','Blue']
}

function createOptions(arr) {
    var html = ['<option >--select--</option>'];
    $.each(arr, function(i, item) {
        html.push('<option value="' + item + '">' + item + '</option>')
    });
    return html.join('');
}

var mainOptions = createOptions(devices)

$(function() {
    $("input[type=button][value=Add]").click(function(e) {
        for (i = 0; i < document.getElementById('sel').value; i++) {
            e.preventDefault();
            var j = 1;

            var newDiv = $('<div class="row">').appendTo("#dropbox");
            $("<select class='devices has_dependents'>").attr("name", "input1_" + j).append(mainOptions).appendTo(newDiv)

            $("<select class='device_types has_dependents'>").attr("name", "input2_" + j).appendTo(newDiv)
            $("<select class='brands'>").attr("name", "input3_" + j).appendTo(newDiv)
            $("<input>").attr("name", "input4_" + j).appendTo(newDiv);
            $("<button>").text("Remove").appendTo(newDiv).click(function(e) {
                e.preventDefault();
                $(this).parent().remove();
            })
            j++;
        }
    });

    $(document).on('change', 'select.has_dependents', function() {
        var val = $(this).val(),
            option_obj;
        if ($(this).is('.devices')) {
            option_obj = device_types;
        } else {
            option_obj = brands;
        }

        var options = createOptions( option_obj[val]);

        $(this).next().html(options)
    })
})
</script>
</head>

<body>
<form>
    <select id="sel">
        <option value="" selected="selected"></option>
        <option value="01" >01</option>
        <option value="02" >02</option>
        <option value="03" >03</option>
        <option value="04" >04</option>
        <option value="05" >05</option>
        <option value="06" >06</option>
        <option value="07" >07</option>
        <option value="08" >08</option>
        <option value="09" >09</option>
        <option value="10" >10</option>
        <option value="11" >11</option>
        <option value="12" >12</option>
        <option value="13" >13</option>
        <option value="14" >14</option>
        <option value="15" >15</option>
    </select>
    <input type="button" value="Add" />

    <div id="dropbox"></div>
</form>​
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:51:17.140

第 67 行 ')' 后面有一个非可视字符

```
})<right here is a none visual character>
</script> 
```

编辑：这是固定代码的链接：

[http://pastebin.com/8n8fkgMy](http://pastebin.com/8n8fkgMy)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T20:53:17.050

您从 jsfiddle 剪切和粘贴中得到了一个非法字符，由于某种原因，它在其中放置了零宽度空格字符。它在 vim 中显示为`<200b>`第 67 行的结束括号。

# cocos2d-iphone - 移动 CCSprite 并获得回调

> ID：12876772
> 
> 赞同：0
> 
> 时间：2012-10-13T20:37:45.980
> 
> 标签：cocos2d-iphone, callback, ccaction

`CCSprite`我在我的基于 Cocos2D 的 iPhone 游戏中移动了一个实例，如下所示：

```
[mySprite runAction:[CCMoveBy actionWithDuration:1.0 
                                        position:ccp(10, 10)]]; 
```

每次精灵移动时如何获得回调？

我想做这样的事情：

```
[self registerForCallbacksFrom:mySprite 
                      selector:@selector(spriteMovedOneStep)]; 
```

每次mySprite`spriteMovedOneStep`移动时都会调用它。也可以指定回调的频率，以便最大限度地减少 CPU 使用率。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T08:51:24.563

一种可能的解决方案是将 CCMoveBy 子类化并从它的更新方法中调用您的回调。您还可以使用这种方法设置频率和您想要的一切。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T20:52:23.717

如果我的问题正确，您希望在 Sprite 移动时调用一个方法，对吗？**如果SpriteIsMoving BOOL**设置为 YES，如何安排执行您想要的更新方法，我不确定您要实现什么，但这是我的看法。

# iphone - 应用加载失败

> ID：12876780
> 
> 赞同：-1
> 
> 时间：2012-10-13T20:38:42.290
> 
> 标签：iphone, objective-c, ios, xcode

> **可能重复：**
> [NSLayoutConstraint 使 ViewController 崩溃](https://stackoverflow.com/questions/11252057/nslayoutconstraint-crashes-viewcontroller)

最近在更新 Xcode 之后，我的应用程序现在无法加载这个未经处理的异常，我现在不知道这是从哪里来的，如果有人可以分享一些信息，甚至对此进行修复会很棒

```
int retVal = UIApplicationMain(argc, argv, nil, nil); 
```

***Terminating app due to uncaught exception 'NSInvalidUnarchiveOperationException', reason: 'Could not instantiate class named NSLayoutConstraint' First throw call stack: (0x15b1022 0x13a0cd6 0x1559a48 0x15599b9 0x9ba4a3 0x9ba67b 0x9ba383 0x8ba16d 0x8bbeb7 0x698ce1 0x698ff8 0x69817f 0x6a7183 0x6a7c38 0x69b634 0x2d1def5 0x1585195 0x14e9ff2 0x14e88da 0x14e7d84 0x14e7c9b 0x697c65 0x699626 0x2b1d 0x2a55 0x1) 终止调用抛出异常 (lldb) ***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T22:20:55.853

您是否创建了使用 iOS 6 中添加的新自动布局的 Xib？默认情况下，xCode 现在使 Xib 文件使用自动布局。您可以通过取消选中 xib 文件检查器中的框来关闭 xib 中的自动布局。

# java - 在 Java 中使用 Gson 解析 Json

> ID：12876786
> 
> 赞同：2
> 
> 时间：2012-10-13T20:39:34.893
> 
> 标签：java, json, gson

我正在尝试解析本地 json 文件，但输出不是它应该显示的。我对 Json（和 Gson）没有什么经验，所以我不清楚问题是什么。

这是推文类：

```
 public class tweet {
         String from_user;
         String from_user_name;
         String profile_image_url;
         String text;

    public tweet(){
        //empty constructor
            }
} 
```

这是使用 Gson 的类：

```
import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import com.google.gson.Gson;

public class tweetfeedreader {
    public static void main(String args[]) throws FileNotFoundException {
        Gson gson = new Gson();
        BufferedReader bufferedReader = new BufferedReader(new FileReader(
                "C:/Users/LILITH/Desktop/jsonfile.json"));
        tweet J_tweet = gson.fromJson(bufferedReader, tweet.class);
        System.out.println(J_tweet);
    }
} 
```

最后，我保存到本地目录的 .json 文件： [http ://search.twitter.com/search.json?q=%40android](http://search.twitter.com/search.json?q=%40android)

没有错误，但输出是：

```
tweet@3030d5aa 
```

我不确定可能出了什么问题，所以感谢您的指导！

[编辑：我忘了补充说我之前搜索过 SO 并阅读了相关帖子。它们可能很相似，但我在拼凑这些部分时运气不佳。]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:43:27.127

从该 json 中删除结果数组，在 []s 之外什么都没有。

然后这几乎是我可以修改代码以使其正常工作的最低限度：

```
import java.lang.reflect.*;
import java.io.*;
import java.util.*;
import com.google.gson.*;
import com.google.gson.reflect.*;

public class tweetfeedreader {
  public static void main(String args[]) throws IOException {
    Gson gson = new Gson();
    BufferedReader bufferedReader = new BufferedReader(new FileReader(
            "jsonfile.json"));
    String line;
    StringBuilder sb = new StringBuilder();
    while ((line = bufferedReader.readLine()) != null) sb.append(line);
    Type tweetCollection = new TypeToken<Collection<tweet>>(){}.getType();
    Collection<tweet> tweets = gson.fromJson(line, tweetCollection);
    for (final tweet t : tweets) System.out.println(t.text);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T22:07:25.497

```
System.out.println(J_tweet); 
```

登录控制台引用对象`J_tweet`( `tweet@3030d5aa`) 例如向您的类
添加方法`toString()``tweet`

```
@Override 
public String toString()  
{  
   return "from_user: " + from_user + "; from_user_name : " + from_user_name;     
} 
```

# javascript - Javascript - 需要在 setInterval 函数之外使用 clearInterval

> ID：12876787
> 
> 赞同：2
> 
> 时间：2012-10-13T20:39:43.840
> 
> 标签：javascript

基本上，我所拥有的是函数内部的 setInterval。我想做的是，从外部控制它的行为。

这就是我所拥有的 -

```
function wheee() {
var i = 1;

slideee = setInterval(function() {
sliderContent.style.marginLeft = margin(i);
    if(i < imagesNoOneLess) {
        i++;
    } else {
        i = 0;
    }
}, 5000); } 
```

现在，我想从`wheee()`函数外部清除间隔。我怎样才能做到这一点？

我还想从外面再次运行间隔。如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:41:29.497

好吧，按照您现在获得代码的方式，它可能会正常工作，因为您没有使用`var`.

只要您以某种方式从`setInterval()`您那里导出返回值就可以了。您可以使该变量显式全局化（比隐式更好），或者让您的“wheee”函数将值返回给它的调用者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T21:38:58.737

全局变量并不危险，但如果您只有一个滑块，则一种很好的编码方式是使用对象文字来模拟单例对象。

```
var Slider= {
    slider: null,
    Start: function(i) {
        this.slider = setInterval(function() {
            // Slider code
            console.log('running: ' + i);
            i++;
        }, 1000);
    },
    Stop: function() {
        window.clearTimeout(this.slider);
    }
};

Slider.Start(1); // Start the slider
Slider.Stop(); // Stop the slider 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T20:42:39.847

将 的范围设置`slideee`为超出`wheee`。

使用对象以保持全局范围清洁。

# php - 在 php 中使用 ftp_get 感到困惑

> ID：12876790
> 
> 赞同：6
> 
> 时间：2012-10-13T20:39:58.327
> 
> 标签：php, ftp, get

我被一个房地产代理 vebra 导入脚本弄糊涂了，该脚本在移动到不同的服务器之前运行良好，但现在这似乎根本不起作用。

有谁知道为什么我会收到以下警告...

> 警告：ftp_get() [function.ftp-get]：打开文件传输的数据通道。在第 37 行的 /home/username/public_html/includes/cron/import/vebra-import.php
> 
> 警告：ftp_get() [function.ftp-get]: Transfer OK in /home/username/public_html/includes/cron/import/vebra-import.php on line 37

这是ftp连接代码：

```
 $ftp = ftp_connect($ftp_host, 21) or die("FTP Connection Error");

  ftp_login($ftp, $ftp_user, $ftp_pass) or die("Can't Connect to FTP");

  $ftpdir = ftp_nlist($ftp, "/");

  if(!empty($ftpdir) && count($ftpdir) > 0) {

  foreach($ftpdir as $ftpfile) {

      if(preg_match("/\.txt$/", $ftpfile)) {
          $getfile = ftp_get($ftp, $csv_dir.$ftpfile, $ftpfile, FTP_BINARY);
          if($getfile){
              $downloaded++;
          }
          $total++;

      }

  }

  }
  ftp_close($ftp); 
```

此外，它似乎是间歇性的，有时会成功执行，有时会因上述错误而失败。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-13T22:04:51.553

您的服务器未处于被动模式，并添加此代码进行处理：

```
ftp_pasv($ftp, true); 
```

有关更多信息，请查看 php.net 上的被动模式：http: [//php.net/manual/en/function.ftp-pasv.php](http://php.net/manual/en/function.ftp-pasv.php) 被动模式使用客户端而不是服务器发起的数据。所以这就是为什么你不能放在服务器上。如果未设置，它将失败。

注意：在`ftp_pasv()`功能之后设置`ftp_login()`功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-09T10:29:42.433

使用 ftp_pasv () 后问题仍然存在。我发现对服务器的请求数导致防火墙出现问题（我使用 foreach() 循环滚动多个文件）。因为我没有修改防火墙规则的权限，所以我在脚本中在请求之间添加了一个 sleep()。

这就是我修复警告的方式。

# android-layout - Android 3.0 及更高版本问题

> ID：12876795
> 
> 赞同：0
> 
> 时间：2012-10-13T20:40:34.907
> 
> 标签：android-layout, android-4.0-ice-cream-sandwich, android-3.0-honeycomb, android-version

感谢您花时间查看我的问题。我正在开发一个 android 应用程序，每次使用 parent="android.Theme.Holo.Light" 时都会在 eclipse 中出现错误。我使用 values-v11 创建了我的文件夹，指示何时为正确的版本使用正确的主题，但我只是收到错误消息：在我的 styles.xml 文件中找不到与给定名称“android.Theme.Holo.Light”匹配的资源.

知道为什么会这样吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T20:45:47.630

尝试这个：

parent="@android:style/Theme.Holo.Light"

# batch-file - 电子表格中的文件夹和文件名

> ID：12876798
> 
> 赞同：0
> 
> 时间：2012-10-13T20:40:41.290
> 
> 标签：batch-file

我正在寻找一个批处理文件，它可以为第一列中一个位置的所有文件夹名称和相邻列中该文件夹中的 .xxx 文件制作电子表格，最终我希望在第一列和每一行中都有一个包含文件夹名称的报告该文件夹中对应的 .xxx 文件名

例如，假设 folder_main 有 f1、f2 等等，每个文件夹都有 g1.xx、g2.xxx 等等，所以报告应该显示

```
 column1     column 2      column 3 ............
 f1           g1.xxx       g2.xxx   .....
 f2           h1.xxx....... 
```

你能帮我在vb中写一个批处理文件或一个脚本来执行这个功能吗？我有一千个文件夹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T06:53:42.923

这是您创建 CSV 样式输出的起点。您应该能够在任何电子表格程序中打开它。

```
@ECHO OFF

SETLOCAL EnableDelayedExpansion

FOR /F "delims=" %%A IN ('DIR /AD /B 2^> NUL') DO (
    SET line="%%A"
    FOR /F "delims=" %%B IN ('DIR %%A\*.xxx /B 2^> NUL') DO SET line=!line!,"%%B"
    ECHO !line!
) 
```

我不知道您对批处理脚本了解多少，所以我暂时保持原样。但是，如果有不清楚的地方，请随时询问。

编辑：
`EnableDelayedExpansion`有必要使`!`-stuff 工作（见下文）。

第一`FOR`行遍历当前目录中的所有子目录并丢弃所有可能的错误消息。对于每个找到的子目录，最后一行`DO (`和之间的内容都会被执行。`)`

`line`一旦第二个`FOR`-loop 完成， -variable 将保存所有文件。它使用子目录的名称进行初始化，即 CSV 输出中的第一列。

第二个循环在第一个循环中找到的子目录中`FOR`查找所有带有扩展名的文件，`xxx`并再次丢弃可能的错误消息。将`SET`文件名彼此附加。

`!`用于代替`%`您可能熟悉的。它将延迟扩展应用于代码（如果您想`SET /?`在命令行上获得有关此运行的更多信息）。

如果您想更深入地挖掘目录结构，则需要在第一个循环中添加 - 命令，`/S`例如.`DIR``'DIR /AD /B /S 2^> NUL'`

# java - 在 Java 中使用制表符分隔符对字符串进行标记，同时跳过一些标记

> ID：12876801
> 
> 赞同：3
> 
> 时间：2012-10-13T20:41:03.683
> 
> 标签：java, tokenize, stringtokenizer

我有一个包含数据的巨大文件（~8Gb / ~8000 万条记录）。每条记录都有 6-8 个属性，这些属性由单个选项卡拆分。我想让初学者在另一个文件中复制一些给定的属性。所以我想要一个比上面更优雅的代码，例如，如果我只想要总共 4 个标记中的第二个和最后一个标记：

```
StringTokenizer st = new StringTokenizer(line, "\t");
st.nextToken(); //get rid of the first token
System.out.println(st.nextToken()); //show me the second token
st.nextToken(); //get rid of the third token
System.out.println(st.nextToken()); //show me the fourth token 
```

我提醒这是一个巨大的文件，所以我必须避免任何多余的 if 检查。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T23:17:46.763

你的问题让我想知道性能。最近我一直在尽可能地使用 Guava 的 Splitter，只是因为我挖掘了语法。我从未测量过性能，所以我对四种解析样式进行了快速测试。我很快就把这些放在一起，所以请原谅风格和边缘情况正确性方面的错误。它们基于我们只对第二项和第四项感兴趣的理解。

我发现有趣的是，在解析 350MB 制表符分隔的文本文件（有四列）时，“homeGrown”（非常粗略的代码）解决方案是最快的，例如：

```
head test.txt 
0   0   0   0
1   2   3   4
2   4   6   8
3   6   9   12 
```

在我的笔记本电脑上运行超过 350MB 的数据时，我得到了以下结果：

*   国产：2271ms
*   番石榴分裂：3367ms
*   正则表达式：7302ms
*   标记化：3466ms

鉴于此，我想我会在大多数工作中坚持使用 Guava 的拆分器，并考虑为更大的数据集使用自定义代码。

```
 public static List<String> tokenize(String line){
    List<String> result = Lists.newArrayList();
    StringTokenizer st = new StringTokenizer(line, "\t");
    st.nextToken(); //get rid of the first token
    result.add(st.nextToken()); //show me the second token
    st.nextToken(); //get rid of the third token
    result.add(st.nextToken()); //show me the fourth token
    return result;
  }

  static final Splitter splitter = Splitter.on('\t');
  public static List<String> guavaSplit(String line){
    List<String> result = Lists.newArrayList();
    int i=0;
    for(String str : splitter.split(line)){
      if(i==1 || i==3){
        result.add(str);
      }
      i++;
    }
    return result;
  }

  static final Pattern p = Pattern.compile("^(.*?)\\t(.*?)\\t(.*?)\\t(.*)$");
  public static List<String> regex(String line){
    List<String> result = null;
    Matcher m = p.matcher(line);
    if(m.find()){
      if(m.groupCount()>=4){
        result= Lists.newArrayList(m.group(2),m.group(4));
      }
    }
    return result;
  }

  public static List<String> homeGrown(String line){
    List<String> result = Lists.newArrayList();
    String subStr = line;
    int cnt = -1;
    int indx = subStr.indexOf('\t');
    while(++cnt < 4 && indx != -1){
      if(cnt==1||cnt==3){
        result.add(subStr.substring(0,indx));
      }
      subStr = subStr.substring(indx+1);
      indx = subStr.indexOf('\t');
    }
    if(cnt==1||cnt==3){
      result.add(subStr);
    }
    return result;
  } 
```

请注意，通过适当的边界检查和更优雅的实现，所有这些都可能会变慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T21:00:58.713

You should probably use the unix `cut` utility, as Paul Tomblin says.

However, in Java you could also try:

```
String[] fields = line.split("\t");
System.out.println(fields[1]+" "+fields[3]); 
```

Whether this is more 'elegant' is a matter of opinion. Whether it's faster on large files, I don't know - you would need to benchmark it on your system.

Relative performance will also depend on how many fields there are per line, and which fields you want; `split()` will process the whole line at once, but `StringTokenizer` will work through the line incrementally (good if you only want fields 2 and 4 out of 20, for example).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T21:01:51.077

Although your data file is huge, it sounds like your question is more about how to conveniently access items in a line of text, where the items are separated by tab. I think StringTokenizer is overkill for a format this simple.

I would use some type of "split" to convert the line into an array of tokens. I prefer the [StringUtils split](http://commons.apache.org/lang/api-2.4/org/apache/commons/lang/StringUtils.html#split%28java.lang.String%29) in commons-lang over String.split, especially when a regular expression is not needed. Since a tab is "whitespace", you can use the default split method without specifying the delimiter:

```
String [] items = StringUtils.split(line);
if (items != null && items.length > 6)
{
    System.out.println("Second: " + items[1]  + "; Fourth: " + items[3]);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-13T22:03:21.077

如果您正在执行 readLines，则实际上是在扫描文件两次：1）您一次搜索文件 1 个字符以查找行尾字符 2）然后扫描每一行以查找 Tabs。

您可以查看其中一个 Csv 库。从记忆中，flatpack 只进行一次扫描。这些库可能会提供更好的性能（尽管我从未测试过）。

几个 java 库： - [Java Csv 库](http://sourceforge.net/projects/javacsv/) - [flatpack](http://sourceforge.net/projects/flatpack/?source=directory)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-14T00:24:57.030

如果您的文件很大，除了速度之外，您还将面临内存消耗问题，因为您必须将文件加载到内存中才能对其进行操作。

我有一个想法，但请注意这是特定于平台的并且违反了 Java 移动性。

您可以从 java 运行 unix 命令以获得大量的速度和内存消耗。例如：

```
 public static void main ( final String[] args)throws Exception {
         Runtime.getRuntime().exec("cat <file> | awk {print $1} >> myNewFile.txt");
    } 
```

# python - 使用 os.listdir 时出现 UnicodeEncodeError

> ID：12876810
> 
> 赞同：1
> 
> 时间：2012-10-13T20:42:34.777
> 
> 标签：python

*   操作系统：Windows 7、64 位
*   Python 3.1.3

当我尝试这样做时

```
os.listdir("F:\\music") 
```

我明白了

```
UnicodeEncodeError: 'gbk' codec can't encode character '\xe3' in position 643: illegal multibyte sequence 
```

`os.listdir`与其他目录一起使用，因此问题的原因显然是`F:\music`其自身内部的一些奇怪编码的文件或文件夹。如何找到此错误的根源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-21T14:45:30.060

[这是一个 Windows 控制台 unicode 问题，您可以通过安装win-unicode-console](https://github.com/Drekin/win-unicode-console)库来修复它

```
$ pip install win-unicode-console
$ edit a.py

  import win_unicode_console

  win_unicode_console.enable()
  print('non-gbk-character Résumé or 欧•亨利 works') 
```

我已经在中文 Windows 8 中的 python 3.4 中测试过

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T20:52:53.837

`UnicodeEncodeError`表示您正在尝试打印文件名。如果`os.lisdir()`有问题，您应该看到一个`UnicodeDecodeError`（*解码*，而不是*编码*）。

因为您使用 Unicode 路径名，所以`os.listdir()`返回容易解码的文件名；在 Windows 上，文件系统使用 UTF-16 对文件名进行编码，并且这些文件名很容易在 Python 中解码（[`sys.getfilesystemencoding()`](http://docs.python.org/py3k/library/sys.html#sys.getfilesystemencoding)告诉 Python 使用什么编解码器）。

但是，Windows 控制台使用*不同*的编码；在您的情况下`gbk`，该编解码器无法显示 UTF-16 可以编码的所有不同字符。

您正在这里寻找`print()`声明。您也许可以改用`print(filename.encode('gbk', errors='replace'))`尝试打印文件名；无法打印的字符将替换为问号。

或者，您可以使用 a`b'F:\\music'`作为路径并使用原始字节串而不是 Unicode。

# javascript - Photoshop/JavaScript app.activeDocument.layers.length 很慢

> ID：12876813
> 
> 赞同：1
> 
> 时间：2012-10-13T20:43:08.320
> 
> 标签：javascript, photoshop-script

我写了一个脚本，找到所有不包含任何其他组的组（LayerSets）。它在小文件上运行良好，但在大文件上确实很慢。经过一些测试，我发现函数“layers.length”需要很长时间才能执行。

只运行这一行代码，在一个有 200 层的文件中需要几秒钟： `app.activeDocument.layers.length`

因为我使用递归方法，所以我需要为每个组运行它。

有什么想法可以优化此代码或任何其他方式来获取文档中的所有组吗？

# r - 括号内的 gsub 和 pad

> ID：12876820
> 
> 赞同：5
> 
> 时间：2012-10-13T20:44:23.397
> 
> 标签：r

我有这样的向量：

```
x <- c("20(0.23)", "15(0.2)", "16(0.09)") 
```

而且我不想弄乱括号外面的数字，而是想删除里面数字的前导零并使所有内容都有2位数字。输出将如下所示：

```
"20(.23)", "15(.20)", "16(.09)" 
```

**有用的信息：**

我可以使用以下函数删除前导零并保留 2 位数字：[LINK](https://stackoverflow.com/questions/12643391/how-to-remove-leading-0-in-a-numeric-r-variable)

```
numformat <- function(val) { sub("^(-?)0.", "\\1.", sprintf("%.2f", val)) }

numformat(c(0.2, 0.26))
#[1] ".20" ".26" 
```

我知道`gsub`可以使用，但我不知道如何使用。我会提供一个`strsplit`答案，但这充其量是骇人听闻的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-13T21:15:15.893

gsubfn 包允许您用应用于匹配的函数替换正则表达式匹配的任何内容。所以我们可以使用你的`numformat`功能

```
library(gsubfn)
# Note that I added as.numeric in because what will be passed in
# is a character string
numformat <- function(val){sub("^(-?)0.", "\\1.", sprintf("%.2f", as.numeric(val)))}
gsubfn("0\\.\\d+", numformat, x)
#[1] "20(.23)" "15(.20)" "16(.09)" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-14T03:53:29.690

```
pad.fix<-function(x){
y<-gsub('\\.(\\d)\\)','\\.\\10\\)',x)
gsub('0\\.','\\.',y)
} 
```

如果需要，第一个 gsub 添加一个尾随零，第二个 gsub 删除前导零。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-13T21:46:56.890

这是 Tyler 的又一个问题，只是为了复杂化而显得复杂：）

所以你去：

```
R> x <- c("20(0.23)", "15(0.2)", "16(0.09)")
R> sapply(strsplit(gsub("^(\\d+)\\((.*)\\)$", "\\1 \\2", x), " "), 
+         function(x) sprintf("%2d(.%02d)", 
+                              as.numeric(x[1]), 
+                              as.numeric(x[2])*100))
[1] "20(.23)" "15(.20)" "16(.09)"
R> 
```

我们在这里做了几件事：

1.  `gsub()`挑选两个数字：第一个是括号前的数字，然后是括号内的一个。[事后看来，应该选择小数点后，见下文。]
2.  这仅使用空格将它们打印出来，例如`"20 0.23"`第一个。
3.  然后，我们对此使用标准`strsplit()`。
4.  然后我们`sapply`用来处理我们从中得到的列表`strsplit`
5.  我们将第一个数字打印为两位整数。
6.  第二个更棘手 - 该`(s)printf()`系列*无法*抑制前导零，因此我们打印小数，并打印整数的两位数 - 并相应地转换第二个数字。

这一切都很简洁，在一条线上，但它会更清楚地分解。

**编辑：**我不经常提供最快的解决方案，但是当我这样做时，至少我可以幸灾乐祸：

```
R> dason <- function(x) { numformat <- function(val){sub("^(-?)0.", "\\1.", sprintf("%.2f", as.numeric(val)))}; gsubfn("0\\.\\d+", numformat, x) }
R> dirk <- function(x) { sapply(strsplit(gsub("^(\\d+)\\((.*)\\)$", "\\1 \\2", x), " "), function(x) sprintf("%2d(.%02d)", as.numeric(x[1]), as.numeric(x[2])*100)) }
R> 
R> dason(x)
[1] "20(.23)" "15(.20)" "16(.09)"
R> dirk(x)
[1] "20(.23)" "15(.20)" "16(.09)"
R> 
R> res <- benchmark(dason(x), dirk(x), replications=1000, order="relative")
R> res
      test replications elapsed relative user.self sys.self user.child sys.child
2  dirk(x)         1000   0.133    1.000     0.132    0.000          0         0
1 dason(x)         1000   2.026   15.233     1.960    0.064          0         0
R> 
```

所以这大约快了 15 分钟。*在这种*情况下，这并不重要，但从长远来看，速度永远不会伤害任何人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-13T20:48:10.773

不`gsub`回答充其量是丑陋的。

```
x <- c("20(0.23)", "15(0.2)", "16(0.09)")

numformat <- function(val) { sub("^(-?)0.", "\\1.", sprintf("%.2f", val)) }
z <- do.call(rbind, strsplit(gsub("\\)", "", x), "\\("))
z[, 2] <- numformat(as.numeric(z[, 2]))
paste0(z[, 1], "(", z[, 2], ")") 
```

# c++ - 如何修复“')' 标记之前的预期主表达式”错误？

> ID：12876822
> 
> 赞同：7
> 
> 时间：2012-10-13T20:44:31.990
> 
> 标签：c++, token

这是我的代码。我不断收到此错误：

> 错误：“）”标记之前的预期主表达式

任何人有任何想法如何解决这个问题？

```
void showInventory(player& obj) {   // By Johnny :D
for(int i = 0; i < 20; i++) {
    std::cout << "\nINVENTORY:\n" + obj.getItem(i);
    i++;
    std::cout << "\t\t\t" + obj.getItem(i) + "\n";
    i++;
}
}

std::string toDo() //BY KEATON
{
std::string commands[5] =   // This is the valid list of commands.
    {"help", "inv"};

std::string ans;
std::cout << "\nWhat do you wish to do?\n>> ";
std::cin >> ans;

if(ans == commands[0]) {
    helpMenu();
    return NULL;
}
else if(ans == commands[1]) {
    showInventory(player);     // I get the error here.
    return NULL;
}

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-13T20:46:40.063

`showInventory(player);`正在传递一个类型作为参数。这是非法的，你需要传递一个对象。

例如，类似：

```
player p;
showInventory(p); 
```

我猜你有这样的事情：

```
int main()
{
   player player;
   toDo();
} 
```

这太可怕了。首先，不要将对象命名为与您的类型相同。其次，为了使对象在函数内可见，您需要将其作为参数传递：

```
int main()
{
   player p;
   toDo(p);
} 
```

和

```
std::string toDo(player& p) 
{
    //....
    showInventory(p);
    //....
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T20:54:29.467

```
showInventory(player);     // I get the error here.

void showInventory(player& obj) {   // By Johnny :D 
```

这意味着 player 是一种数据类型，而 showInventory 期望引用 player 类型的变量。

所以正确的代码将是

```
 void showInventory(player& obj) {   // By Johnny :D
    for(int i = 0; i < 20; i++) {
        std::cout << "\nINVENTORY:\n" + obj.getItem(i);
        i++;
        std::cout << "\t\t\t" + obj.getItem(i) + "\n";
        i++;
    }
    }

players myPlayers[10];

    std::string toDo() //BY KEATON
    {
    std::string commands[5] =   // This is the valid list of commands.
        {"help", "inv"};

    std::string ans;
    std::cout << "\nWhat do you wish to do?\n>> ";
    std::cin >> ans;

    if(ans == commands[0]) {
        helpMenu();
        return NULL;
    }
    else if(ans == commands[1]) {
        showInventory(myPlayers[0]);     // or any other index,also is not necessary to have an array
        return NULL;
    }

} 
```

# android - 为自定义图标集调整 ADW 启动器

> ID：12876824
> 
> 赞同：1
> 
> 时间：2012-10-13T20:44:38.077
> 
> 标签：android, launcher, android-theme, android-launcher

最近，我萌生了为安卓手机创建自定义启动器的想法。
在对可以帮助我完成任务的资源进行广泛搜索后，我发现没有多少帮助可用。
该站点上的许多帖子建议学习 ADW 启动器，来自 sdk 的主屏幕示例和其他一些开源启动器。
所以我拿了 ADW Launcher 并尝试试一试。我的问题是：

*   建议我，我应该在这个应用程序中关注哪些关键方面。
*   是否可以在此应用程序本身中添加我的自定义图标集而不使用可用的主题或模板，这建议使用[此](http://code.google.com/p/adw-launcher-android/wiki/ADWThemeGuide#Custom_Icon_Naming_-_Video_and_Databases)过程。

# python - Cythonized 功能意外缓慢

> ID：12876828
> 
> 赞同：2
> 
> 时间：2012-10-13T20:45:13.233
> 
> 标签：python, numpy, cython

我想加快一个我经常使用的功能，我想使用 cython。但是，在尝试了我在文档中找到的所有可能的 cython 优化之后，cython 代码比 python+numpy 函数慢了大约 6 倍。令人失望！

这是我的测试代码：（forward1是python函数，forward2是cython函数）

```
#geometry.py
def forward1(points, rotation, translation):
    '''points are in columns'''
    return np.dot(rotation, points - translation[:, np.newaxis])

#geometry.pyx
import numpy as np
cimport numpy as np
cimport cython

@cython.boundscheck(False)
@cython.wraparound(False)
@cython.nonecheck(False)
cdef np.float64_t[:,:] forward2(np.float64_t[:,:] points, np.float64_t[:,:] rotation, np.float64_t[:] translation):
    '''points are in columns'''
    cdef unsigned int I, J
    I = points.shape[0]
    J = points.shape[1]
    cdef np.float64_t[:,:] tmp = np.empty((I, J), dtype=np.float64)
    cdef unsigned int i
    for i in range(J):
        tmp[0, i] = points[0, i] - translation[0]        
        tmp[1, i] = points[1, i] - translation[1]        
    cdef np.float64_t[:,:] result = np.dot(rotation, tmp)
    return result

def test_forward2(points, rotation, translation):
    import timeit
    cdef np.float64_t[:,:] points2 = points
    cdef np.float64_t[:,:] rotation2 = rotation
    cdef np.float64_t[:] translation2 = translation
    t = timeit.Timer(lambda: forward2(points2, rotation2, translation2))
    print min(t.repeat(3, 10)) 
```

然后我计时：

```
t = timeit.Timer(lambda: forward1(points, rotation, translation))
print min(t.repeat(3, 10))
0.000368164520751

test_forward2(points, rotation, translation)
0.0023365181969 
```

我可以对 cython 代码做些什么来让它更快吗？

如果无法在 cython 中加速 forward1，我可以希望使用 weave 加速吗？

**编辑：**

只是为了记录，我试图加速该功能的另一件事是按 fortran 顺序传递点，因为我的点存储在列中并且其中有很多。我还将本地 tmp 定义为 fortran 顺序。我认为函数的减法部分应该更快，但 numpy.dot 似乎需要 C 顺序输出（无论如何要解决这个问题？），所以总的来说也没有加速。我还尝试转置点，以便减法部分在 C 顺序中更快，但似乎点积仍然是最昂贵的部分。

另外，我注意到 numpy.dot 不能使用 memoryviews 作为输出参数，即使它是 C 顺序，这是一个错误吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T21:40:21.567

看看你的代码，它看起来像是`numpy`已经非常优化的东西（数组和点积的减法。）。

Cython is great for speeding up cases where numpy often performs poorly (e.g. iterative algorithms where the iteration is written in python), but in this case, the inner loop is already being preformed by a BLAS library.

If you want to speed things up, the first place I'd look is what BLAS/LAPACK/ATLAS/etc libraries numpy is linked against. Using a "tuned" linear algebra library (e.g. ATLAS or Intel's MKL) will make a large (>10x in some cases) difference in cases like this.

To find out what you're currently using have a look at the output of `numpy.show_config()`

# javascript - 可以将函数用作对象属性名称吗？

> ID：12876829
> 
> 赞同：0
> 
> 时间：2012-10-13T20:45:18.357
> 
> 标签：javascript, function

这是代码示例：

```
var eventStack = {};
function addEvent (fn) {
  eventStack[fn] = fn;
}
function removeEvent (fn) {
  delete eventStack[fn];
}
addEvent(alert);
addEvent(console.log);
addEvent(addEvent); 
```

它适用于我自己定义的任何功能，但不适用于 console.log。取而代之的是 _firebugignore。

我认为 toString 属性有一些魔力

**编辑**hmng，我只是再次运行我的代码，它对 console.log 工作正常，以前键和值都被替换购买“_firebuignore”，我想它的 higgs bugson

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T21:23:56.847

是的，有一些魔力[`Function.prototype.toString`](http://es5.github.com/#x15.3.4.2)：它依赖于实现，它只需要返回函数的表示形式，它是[*FunctionDeclaration*](http://es5.github.com/#x13) -syntax-like。当然，它不能为所有那些环境内置函数（如`console.log`）返回一个 JS 函数。

但是，我认为通过字符串表示来识别函数根本不是一个好主意。很容易发生两个不同的函数最终出现在同一个字符串中（例如：两个相同的函数表达式，不同范围内的相同函数声明 - 或闭包，内置函数（`Array.prototype.toString.toString() == Function.prototype.toString.toString()`）。

相反，请使用 Array`eventStack`并通过 . 检查函数是否存在`indexOf()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T20:47:02.817

属性名称只能是字符串。其他类型会根据需要强制转换为字符串值。当您迭代属性时，`for ... in`您会得到字符串。

# wcf - WCF/silverlight 端点

> ID：12876831
> 
> 赞同：0
> 
> 时间：2012-10-13T20:45:25.070
> 
> 标签：wcf, silverlight, cross-domain

我有一个我正在努力克服的问题，我离开了，这是可能的，但我不确定如何。

我的服务中有以下配置

```
<configuration>
<system.serviceModel>
    <bindings>
        <customBinding>
            <binding name="CustomBinding_MyDataService">
                <binaryMessageEncoding />
                <httpTransport maxReceivedMessageSize="2147483647" maxBufferSize="2147483647" />
            </binding>
        </customBinding>
    </bindings>
    <client>
        <endpoint address="http://mywebsite.com/vdir/Services/MyDataService.svc"
            binding="customBinding" bindingConfiguration="CustomBinding_MyDataService"
            contract="HBDataLayer.MyDataService" name="CustomBinding_MyDataService" />          
    </client>
</system.serviceModel> 
```

问题是端点地址，我将地址设置为实际发布的位置，但是当我尝试在本地调试时，我遇到了跨域策略问题。我必须不断更新在 localhost 和网站之间切换的配置文件。

有人告诉我，它可以配置它，所以你没有这个问题。

有谁知道怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:46:21.277

我在开发 Silverlight 应用程序时一直遇到这个问题，您需要将 ClientAccessPolicy.xml 和 CrossDomain.xml 放在您的服务器上

[http://msdn.microsoft.com/en-us/library/cc197955(v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/cc197955(v=vs.95).aspx)

# google-chrome - 我如何才能访问在内容脚本的选项页面上设置的数据，例如。在谷歌浏览器扩展中

> ID：12876835
> 
> 赞同：0
> 
> 时间：2012-10-13T20:46:06.080
> 
> 标签：google-chrome, google-chrome-extension, local-storage

我在选项页面设置了一些值。现在工作正常。但我无法访问在 background.html 或内容脚本中设置的数据。我已经读过消息可以通过消息传递这样的事情，但对我来说，文档有点难以理解。如果有人能指出我正确的方向，那就太好了。示例故事>我在选项页面上设置此值`localStorage.setItem("somedata" , "true");` 然后，如果我要在将要运行扩展程序的页面上访问相同的数据，我会得到这样的结果：

```
localStorage.getItem("somedata"); 
```

并且值为`null`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T21:06:25.773

内容脚本无法直接从后台页面读取 localStorage 值。如果您想阅读 localStorage 键值对，请参阅此答案，其中提供了解释和实现此目的的代码：[Accessing global object from content script in chrome extension](https://stackoverflow.com/questions/10052259/accessing-global-object-from-content-script-in-chrome-extension/10053750#10053750)

虽然前面的方法有效，但我推荐使用[`chrome.storage`](http://developer.chrome.com/extensions/storage.html)API：所有扩展页面都可以使用它。`localStorage`和之间的一个巨大区别在于`chrome.storage`它`chrome.storage`是一个**异步**API。

这是一个说明差异的示例：

```
// synchronous localStorage
localStorage.setItem('keyname', 'value');
alert(localStorage.getItem('keyname'));

// asynchronous chrome.storage
chrome.storage.local.set({keyname: 'value'}, function() {
    chrome.storage.local.get('keyname', function(items) {
        alert(items.keyname);
    });
}); 
```

乍一看，`chrome.storage`API 看起来更加复杂。但是，如果您想在扩展中保存数据，这是最好的方法。该`localStorage`方法需要更多代码（请参阅我在此答案之上链接的答案）来实现相同的功能。而且，它*也是*异步的。

# android - 如何更改 AutoCompleteTextView 中下拉菜单的文本颜色？

> ID：12876840
> 
> 赞同：6
> 
> 时间：2012-10-13T20:46:44.533
> 
> 标签：android, autocompletetextview

如何更改下拉菜单中的文本颜色`AutoCompleteTextView`？或者如何更改下拉菜单的背景颜色，默认情况下下拉菜单的背景颜色为白色。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-12-26T14:10:51.693

您需要为此创建自定义适配器类，然后您可以将 textview 设置为此。

```
autoAdapter = new AutoAdapter(this, R.layout.autocompletelistview_test1,
            edittext); 
```

这是 autocompletelistview_test1

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayoutxmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent" 
android:layout_height="wrap_content">
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="44dip"
android:gravity="center_vertical"

android:singleLine="true"
android:ellipsize="end"
android:layout_marginRight="12dip"
android:textStyle="bold"
android:textColor="#cc3333"
android:id="@+id/textview"
android:textSize="14sp" /> 
```

使用以下代码更改下拉菜单的背景颜色，例如

```
 autocomplete.setDropDownBackgroundResource(R.color.autocompletet_background_color); 
```

您可以在 string.xml 中设置这样的值

```
 <color name="autocompletet_background_color">#EFEFEF</color> 
```

如果要更改下拉项的文本颜色，请执行以下操作。

在适配器类中。

```
 @Override
public View getView(int position, View v, ViewGroup parent)
{
    View mView = v ;
    if(mView == null){
        LayoutInflater vi = (LayoutInflater)appContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        mView = vi.inflate(id, null);
    }
    TextView text = (TextView) mView.findViewById(R.id.textview);        
    if(getItem(position) != null )
    {
        text.setTypeface(faceBold);
        if(getItem(position).equals("check some condition if you want. "))
        {
            text.setTextColor(Color.parseColor("#999999"));
            text.setText("set some text");               
        }           
        else
        {
            text.setTextColor(Color.parseColor("#cc3333"));
                text.setText(getItem(position));
        }           
    }
    return mView;
} 
```

如果您有任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-05-27T18:39:46.250

虽然更改文本颜色可能很棘手。更改下拉菜单的背景颜色很容易

```
AutoCompleteTextView searchView = ... 
searchView.setDropDownBackgroundDrawable(new ColorDrawable(context.getResources().getColor(R.color.colorId))); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-11T13:26:37.833

我解决了这个问题而没有使用自定义适配器膨胀布局

1.  只需创建一个布局***autocomplete_custom.xml***

    ```
    <?xml version="1.0" encoding="utf-8"?>
    <TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:id="@+id/any_id"
    android:textColor="#ffffff"/> 
    ```

2.  在您的适配器中使用它

    ```
    autocomplete.setAdapter(new ArrayAdapter<String>(this,
            R.layout.autocomplete_custom, listContainingText);); 
    ```

*跑。答对了！*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-13T20:56:05.490

默认情况下，实际上无法直接更改自动完成 textView 的颜色。相反，您必须为此实现自定义适配器，并从适配器通常为 textView 膨胀视图。看到[这个](https://stackoverflow.com/questions/8784249/android-autocompletetextview-with-custom-adapter-filtering-not-working)问题将帮助你解决你的问题。因此，您可以根据需要将属性设置为 textview。例如，您必须具有如下所示的自定义适配器

```
public class MyCustomBrandAdapter extends ArrayAdapter<Brand>{

List<Brand> Brandlist;
Context context;
private ArrayList<Brand> itemsAll;
private ArrayList<Brand> suggestions;
public MyCustomBrandAdapter(Context context, int textViewResourceId, List<Brand> Brandlist) 
{

    super(context,  textViewResourceId, Brandlist);
    this.Brandlist =  Brandlist;
    this.itemsAll = (ArrayList<Brand>) ((ArrayList<Brand>) Brandlist).clone();
    this.suggestions = new ArrayList<Brand>();
    this.context = context;
}

public View getView(int position, View convertView, ViewGroup parent) 
{
    View v = convertView;
    if (v == null) {
        LayoutInflater vi = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = vi.inflate(R.layout.listview, null);

    }
    Brand Brand = Brandlist.get(position);
    if (Brand != null) {
        TextView tt = (TextView) v.findViewById(R.id.txtName);

        if (tt != null) {
            tt.setText(Brandlist.get(position).toString());
        } else {
            System.out.println("Not getting textview..");
        }

    }
    return v;
}
 @Override
    public Filter getFilter() {
        return nameFilter;
    }

    Filter nameFilter = new Filter() {
        public String convertResultToString(Object resultValue) {
            String str = ((Brand)(resultValue)).getBrandDescription1(); 
            return str;
        }
        @Override
        protected FilterResults performFiltering(CharSequence constraint) {
            if(constraint != null) {
                suggestions.clear();
                for (Brand brand : itemsAll) {
                    if(brand.getBrandDescription1().toLowerCase().startsWith(constraint.toString().toLowerCase())){
                        suggestions.add(brand);
                    }
                }
                FilterResults filterResults = new FilterResults();
                filterResults.values = suggestions;
                filterResults.count = suggestions.size();
                return filterResults;
            } else {
                return new FilterResults();
            }
        }
        @Override
        protected void publishResults(CharSequence constraint, FilterResults results) {
            ArrayList<Brand> filteredList = (ArrayList<Brand>) results.values;
            List<Brand> getResult=new ArrayList<Brand>();
            if(results != null && results.count > 0) {
                clear();
                for (Brand c : filteredList) {
                    getResult.add(c);
                }
                Iterator<Brand> brandIterator=getResult.iterator();
                while(brandIterator.hasNext()){
                    Brand party=brandIterator.next();
                    add(party);
                }
                notifyDataSetChanged();
            }
        }
    };

} 
```

在此布局 R.layout.listview xml 如下

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:background="#ffffff" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/txtName"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="TextView"
            android:textColor="#000000" 
            android:textSize="12dp"/>

    </LinearLayout>

</LinearLayout> 
```

在这个 xml 中。我已将背景设置为白色`(android:background="#ffffff")`，并且我希望将文本设置为黑色 `(android:textColor="#000000")`，并按照我想要的大小`(android:textSize="12dp")`对其进行修改。我想现在它会让你清楚。

# javascript - jQuery解析巨大的响应失败

> ID：12876842
> 
> 赞同：1
> 
> 时间：2012-10-13T20:46:48.300
> 
> 标签：javascript, html, jquery

我正在开发一个应用程序，该应用程序向 url 发送请求并使用 jQuery 解析 html 上存在的表作为响应。虽然当返回的 html 代码量合理时，这似乎工作得很好，但它在大数据集时会以某种方式失败。

问题开始于

```
 $.get(url, function(response){
     $(response).find('table');
   }) 
```

尽管响应字符串中有一个表格，但返回一个空的搜索结果。但是，当表格很小（大约 1000 列）时，相同的代码可以正常工作

知道如何解决这个问题吗？

出于测试目的，我现在正在使用这个数据集，[http://socr.ucla.edu/docs/resources/SOCR_Data/SOCR_Data_Dinov_020108_HeightsWeights.html](http://socr.ucla.edu/docs/resources/SOCR_Data/SOCR_Data_Dinov_020108_HeightsWeights.html)

有什么替代建议可以让这个过程更快一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T21:11:11.147

试试这个：

```
$.get(url, function(response){
  var $response = $(response);
  var $table = $response.is('table') ? $response : $response.find('table');
  // ...

}) 
```

如果响应 HTML/XML 是 a `<table>`，则`find()`找不到它。它只查看您开始的元素的后代。上面的代码检查你是否已经获得了`<table>`.

# html - 仅从某些标签中选择属性名称的正则表达式

> ID：12876843
> 
> 赞同：0
> 
> 时间：2012-10-13T20:46:48.997
> 
> 标签：html, css, regex

什么是允许我从标签中选择所有属性名称`<form>`但`<input>`不能从任何其他 HTML 标签中选择所有属性名称的正则表达式？

例如：

```
<!-- all attribute names get selected -->
<input class="something" id="yes" type="text" name="my-field" value="Hello, world!">

<!-- class and id don't get selected because it's a div -->
<div class="something" id="no"></div>

<!-- class gets selected -->
<form class="my-form"></form> 
```

我只在属性名称之后

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T21:11:40.597

这样的正则表达式构建起来会非常复杂。尽管您[无法通过正则表达式匹配所有 HTML](https://stackoverflow.com/a/1732454/82548)，但需要非常复杂的[后](http://www.regular-expressions.info/lookaround.html)向检查来检查您要匹配的属性名称是否位于名称为“form”或“input”的开始标记之后。不要尝试构建这样的正则表达式，你会发疯和/或最终得到一个不可读、不可维护或不可理解的怪物。

相反，使用 DOM 解析器（您的语言会有一个）并应用 DOM 选择器并获取元素的属性名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T21:40:24.537

用正则表达式来做这件事并不容易，实际上用正则表达式做这件事也不是一个好主意。但这是可能的>>

```
input = '...';

var tmp = input, found, params = [];
var re = /(<(?:form|input)\b.*?\s)([\w\-]+)=(['"]).*?\3/gi;
do {
  found = 0;
  tmp = tmp.replace(re, function($0,$1,$2,$3) {
    params.push($2);
    found = 1;
    return $1;
  });
} while (found); 
```

检查[这个演示](http://jsfiddle.net/2wUGN/)。

# r - 在矩阵中使用缺失值 (NA) 在 R 中执行 NMF

> ID：12876846
> 
> 赞同：5
> 
> 时间：2012-10-13T20:47:02.997
> 
> 标签：r, missing-data, factorization

我正在为 R 中的 NMF（非负矩阵分解）寻找一个包/如果可能的相对现成的解决方案，它可以处理缺失值（NA）而不将它们视为 0。

对于一个简单的推荐系统，目标实际上是通过分解的乘积来估计这些缺失值。

NMF CRAN 包很棒，但似乎无法做到这一点（它最近在 CRAN 之外的延续也不能），而且我找不到合适的替代包......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-06-29T06:59:07.240

`NLLM`（[https://cran.r-project.org/web/packages/NNLM/index.html](https://cran.r-project.org/web/packages/NNLM/index.html)）通过 R 中的非负矩阵分解进行缺失值插补。

将矩阵的缺失值设置为`NA`。有关详细信息，请参阅[小插图。](https://cran.r-project.org/web/packages/NNLM/vignettes/Fast-And-Versatile-NMF.html#missing-value-imputation-and-application-in-recommendation-system)

# php - 嘲弄 - call_user_func_array() 期望参数 1 是一个有效的回调

> ID：12876849
> 
> 赞同：19
> 
> 时间：2012-10-13T20:47:11.453
> 
> 标签：php, mocking, phpunit, silex

我有一个需要模拟的课程：

```
class MessagePublisher
{
    /**
     * @param \PhpAmqpLib\Message\AMQPMessage $msg
     * @param string $exchange - if not provided then one passed in constructor is used
     * @param string $routing_key
     * @param bool $mandatory
     * @param bool $immediate
     * @param null $ticket
     */
    public function publish(AMQPMessage $msg, $exchange = "", $routing_key = "", $mandatory = false, $immediate = false, $ticket = null)
    {
        if (empty($exchange)) {
            $exchange = $this->exchangeName;
        }

        $this->channel->basic_publish($msg, $exchange, $routing_key, $mandatory, $immediate, $ticket);
    }
} 
```

我正在使用嘲弄 0.7.2

```
$mediaPublisherMock = \Mockery::mock('MessagePublisher')
    ->shouldReceive('publish')
    ->withAnyArgs()
    ->times(3)
    ->andReturn(null); 
```

不幸的是，由于这个错误，我的测试失败了

> call_user_func_array() 期望参数 1 是一个有效的回调，类 'Mockery\Expectation' 在第 54 行的 /vendor/mockery/mockery/library/Mockery/CompositeExpectation.php 中没有方法 'publish'

我尝试调试我发现此代码中的测试失败

```
public function __call($method, array $args)
{
    foreach ($this->_expectations as $expectation) {
        call_user_func_array(array($expectation, $method), $args);
    }
    return $this;
} 
```

其中
$method = 'publish'
$args = array()
$expectation 是 Mockery\Expectation 对象 () 的实例

我正在使用 php 5.3.10 - 知道有什么问题吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-10-17T10:07:18.280

发生这种情况是因为您将模拟期望分配给`$mediaPublisherMock`，而不是模拟本身。尝试将该`getMock`方法添加到该调用的末尾，例如：

```
$mediaPublisherMock = \Mockery::mock('MessagePublisher')
    ->shouldReceive('publish')
    ->withAnyArgs()
    ->times(3)
    ->andReturn(null)
    ->getMock(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T21:26:21.577

好的问题通过使用标准的 PhpUnit Mock 库解决

这有效：

```
$mediaPublisherMock = $this->getMock('Mrok\Model\MessagePublisher', array('publish'), array(), '', false);
$mediaPublisherMock->expects($this->once())
    ->method('publish'); 
```

为什么我没有从这个开始；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T20:52:22.857

我相信 $expectation 应该是你的课，MessagePublisher

# three.js - Three.js：在网页上投射阴影

> ID：12876854
> 
> 赞同：3
> 
> 时间：2012-10-13T20:47:55.487
> 
> 标签：three.js

是否可以在three.js中创建可以接收阴影的透明/不可见平面？我的目标是在没有背景的 3d 画布上绘制一些对象（这样我就可以看到画布元素后面的网页）。我希望对象在背景上投射阴影，我想，如果我可以制作一个不可见的平面，那么网页背景仍然可见。阴影投射在平面上，看起来阴影在网页上。现在我可以制作一个不透明度为 0.5（或类似）的白色平面，但这样平面是可见的。理想情况下，平面应该完全不可见（阴影除外）。

编辑：我创建了一个示例（基于[此](http://learningthreejs.com/blog/2012/01/20/casting-shadows/)）：http: [//jsfiddle.net/s5YGu/2/](http://jsfiddle.net/s5YGu/2/)

这里我的不透明度为 0.5，但你可以看到飞机。如果我将不透明度设置为 0，那么整个平面和阴影就会消失。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-20T12:32:35.250

我通过破解基本着色器来完成这项工作，这里是工作着色器代码[http://pastie.org/5088640](http://pastie.org/5088640)

它没有缺点 AFAIK，例如不透明度：0.1

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T00:40:47.250

是的，你可以达到你想要的效果，至少在我的机器上看起来还不错。:-)

这是一个小提琴：http: [//jsfiddle.net/ZXdV3/25/](http://jsfiddle.net/ZXdV3/25/)

有几个问题。首先，您必须`alpha: true`在渲染器构造函数中设置参数。

其次，虽然我假设您希望飞机完全透明，但您必须满足于`material.opacity = 0.1`，或左右。

第三，如果你在网页上放置一个画布，并且你希望网页是交互式的，你将不得不在画布中抑制指针事件（虽然我不确定 IE 是否支持这一点）`container.style.pointerEvents = 'none'`：

三.js r.67

# mysql - 为什么我的 NULL 计数在 MySQL 中返回 0？非常基础

> ID：12876858
> 
> 赞同：3
> 
> 时间：2012-10-13T20:48:13.353
> 
> 标签：mysql

我有 2 个简单的问题让我感到困惑（我是 Mysql 新手）

我有一个包含 3 列的表（调查），即 UserID（主要）、SkinColor 和 HairColor。我想计算头发颜色为空的人数（他们没有回答调查）。

我这样做了：

```
select count(id)
from survey
where haircolor is null 
```

但我很困惑为什么我做不到

```
select count(haircolor)
from survey
where haircolor is null 
```

它返回 0。这是为什么？

问题 2：我想返回调查对象的总数（所有 ID）、头发颜色为空值和肤色为空值的人数。我试过这个查询

```
select count(id), count(skincolor), count(haircolor)
from survey
where skincolor is null and haircolor is null 
```

但这只是返回了 skincolor 和 haircolor 显然都为空的计数，而不是每列的单独计数。有没有办法将 WHERE 约束放在 SELECT 部分，以便我可以为每个选择指定不同的约束？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:52:36.093

我这样做了：

> 从 haircolor 为空的调查中选择 count(id)

但我很困惑为什么我做不到

> 从头发颜色为空的调查中选择计数（头发颜色）

它第一次起作用，因为您第一次计算 X 为空且 IS 本身不为空的 ID。第二次计算本身为 NULL 的事物，而 NULL 事物的 COUNT 为 0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T21:00:54.907

for the second case:

```
select 'No haircolor', count(id)
from survey
where haircolor is null
union all 
select 'no skincolor',count(id)
from survey
where skincolor is null 
```

this should return something like:

```
No haircolor   3
No skincolor   1 
```

If you want the result as a single line you'll need to do a pivot on the result above.

Note: I'm assuming String literals are quoted with single quotes as in MsSql

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T20:53:00.157

至于问题2：

这很容易，因为 COUNT(null) 为 0：

```
 select count(id), count(skincolor), count(haircolor) from survey 
```

这为您提供了每列的非空值的数量。

您还应该能够执行以下操作：

```
SELECT count(1) AS num, 
       count(1)-count(skincolor) AS nullcolor, 
       count(1)-count(haircolor) AS nullhair 
    FROM survey 
```

# xpages - 获取未保存文档的 URL 或文档 ID

> ID：12876859
> 
> 赞同：1
> 
> 时间：2012-10-13T20:48:21.470
> 
> 标签：xpages, xpages-ssjs

在保存文档时，我正在运行正在执行 .save() 的 SSJS，然后我希望将文档链接 (URL) 包含在使用 context.getUrl() 发送的通知电子邮件的正文中。

这适用于已经保存的文档，因为它在打开文档时在 URL 中有文档 ID，但不适用于新文档。有没有办法为还没有 ID 的新文档完成此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T21:00:20.527

You have to construct the URL yourself since (as you already know) the context.getUrl() method can not be used.

So after your .save() you could do something like the following:

```
var docUrl = context.getUrl().toString().split(view.getPageName())[0] + "/" + database.getFilePath() + view.getPageName() + "?action=openDocument&documentId=" + document.getNoteID(); 
```

The `context.getUrl().toString().split(view.getPageName())[0]` part should give you the hostname and database filepath according to [David Leedys xpagescheatsheet.com URL test](http://xpagescheatsheet.com/cheatsheet.nsf/url.xsp). I then add the current XPage name and the openDocument and docid parameters.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T12:55:33.540

另一种可能性：如果文档后面有一个表单，并且属性“改为打开 XPages”，则可以使用该`http://server/database.nsf/0/universalid`语法。当您的文档中有唯一标识符时，您还可以使用按该标识符排序的视图并使用`http://server/database.nsf/sortedview/sortkey`. 使用排序视图，您可以在保存之前预测 URL。

# java - Maven 无法在 Netbeans 7.2 上解析

> ID：12876860
> 
> 赞同：1
> 
> 时间：2012-10-13T20:48:36.827
> 
> 标签：java, maven, netbeans-7

我对 Maven 非常陌生。我收到以下错误

```
 The following artifacts could not be resolved: stax:stax:jar:1.0, stax:stax-ri:jar:1.0, clover:clover:jar:1.3-rc4: Failure to find stax:stax:jar:1.0 in http://repo.maven.apache.org/maven2 was cached in the local repository, resolution will not be reattempted until the update interval of central has elapsed or updates are forced -> [Help 1]

To see the full stack trace of the errors, re-run Maven with the -e switch.
Re-run Maven using the -X switch to enable full debug logging. 
```

经过一些研究（例如[NetBeans：使用 -e 开关重新运行 Maven / PluginResolutionException](https://stackoverflow.com/questions/9702472/netbeans-re-run-maven-with-the-e-switch-on-pluginresolutionexception)），据说我需要编辑我的`~/.m2/settings.xml`文件。

我查看了文件，但看不到要更改的内容。因此，我将其包括在下面以供输入：

设置.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!--
User-specific configuration for maven. Includes things that should not
be distributed with the pom.xml file, such as developer identity, along with
local settings, like proxy information. The default location for the
settings file is ~/.m2/settings.xml
-->
<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd">
<!--proxies>
    <proxy>
        <host>my.proxy.host</host>
    </proxy>
</proxies-->

<!--pluginGroups>
    <pluginGroup>org.codehaus.mojo</pluginGroup>
</pluginGroups--> 
```

POM.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>

<groupId>com.schoolsupplies.v5</groupId>
<artifactId>com.schoolsupplies.v5.test</artifactId>
<version>1.0-SNAPSHOT</version>
<packaging>jar</packaging>

<name>com.schoolsupplies.v5.test</name>

<properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
</properties>

<dependencies>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.10</version>
        <scope>test</scope>
        <type>jar</type>
    </dependency>
    <dependency>
        <groupId>com.sun.jersey</groupId>
        <artifactId>jersey-client</artifactId>
        <version>1.14</version>
        <scope>test</scope>
        <type>jar</type>
    </dependency>
    <dependency>
        <groupId>org.codehaus.jettison</groupId>
        <artifactId>jettison</artifactId>
        <version>1.1</version>
        <scope>test</scope>
        <type>jar</type>
    </dependency>
  <dependency>
    <groupId>dom4j</groupId>
    <artifactId>dom4j</artifactId>
    <version>20040902.021138</version>
    <type>jar</type>
  </dependency>
</dependencies> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T16:58:57.863

我有同样的错误。我将存储库添加到 pom.xml 中，一切正常。

像这个例子：

```
<repositories>
  <repository>
    <id>bukkit-repo</id>
    <url>http://repo.bukkit.org/content/groups/public/</url>
  </repository>
<repositories> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T23:10:43.587

我打开依赖项目录并删除所有出现问题的 jars——尤其是因为它们没有在`pom.xml`文件中明确调用。之后，一切正常。

maven 似乎决定我的一些显式导入的依赖项需要这些文件。在我的情况下：`stax:stax-ri:jar:1.0`,`clover:clover:jar:1.3-rc4`等。

# c++ - 是否可以利用 is_trivially_copy_assignable 和 is_trivially_copy_constructible 进行优化？

> ID：12876864
> 
> 赞同：0
> 
> 时间：2012-10-13T20:49:10.913
> 
> 标签：c++, c++11, memcpy, typetraits

`memcpy`除非类型是可简单复制的，即满足`std::is_trivially_copyable`类型特征，否则值似乎不安全复制。我想知道类型特征`std::is_trivially_copy_assignable`,和的目的是什么`std::is_trivially_copy_constructible`，如果你不能利用它们进行初始化或赋值。他们允许其他优化吗？`std::is_trivially_move_assignable``std::is_trivially_move_constructible``memcpy`

我还想知道为什么标准需要一个简单的析构函数来使值可以用`memcpy`. （一个微不足道的析构函数确实简化了在内存中物理移动一个值，但它似乎根本不需要用 复制一个值`memcpy`）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T21:25:04.943

> 我想知道类型特征`std::is_trivially_copy_assignable`,的目的是什么`std::is_trivially_copy_constructible`，`std::is_trivially_move_assignable`以及`std::is_trivially_move_constructible`是否不能利用它们进行初始化或赋值`memcpy`

他们告诉你类型的属性，这还不够存在的理由吗？

你可能有一个类型，它有一个普通的复制构造函数，但有一个非普通的移动构造函数，所以它不符合普通可复制类型，但可以普通复制构造。

使用这种类型时，您可以使用 SFINAE 或其他静态多态性来启用/禁用某些操作，除非它们被保证是微不足道的。例如，假设一个类模板`TrivialPair<A,B>`可以将其移动构造函数声明为已删除，如果`A`并且`B`不是普通可移动构造函数，其他操作也类似。这意味着`TrivialPair`它只支持既支持又不调用任何重要函数的操作`A`。`B`

> 我还想知道为什么标准需要一个简单的析构函数才能复制值`memcpy`

“可简单复制”可以被认为是说类型只是一堆字节，即只是可以安全地复制到内存中另一个位置且不改变值的数据。如果该类型有一个重要的析构函数，那么它不仅仅是一堆字节，它还有一些编译器无法理解的额外行为，这可能会使 using`memcpy`不安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T21:18:50.873

当然。可以编写一个向量类模板，利用它并​​在其复制构造函数中调用 std::memcpy，以防万一这样做是安全的。我相信 std::copy 的至少一种实现对迭代器类型为 T* 且 T 可轻松复制的情况采用了类似的优化。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-07-17T02:37:31.913

我的猜测是，这就像标准中的任何其他挑剔一样。在某个地方，Joe 和 Jane 会谈论一个 char 是 8 位的，而 Bob 会进来大喊标准如何说它实际上是“8 位或更多位！” 第二天，他们将通过将浮点数复制到 uint32_t 并根据 IEEE-754 进行一些操作来做一些类型的双关语黑客，Bob 将再次进来大喊如何不严格要求 IEEE-754，并且他会坚持认为他们正在做的那些小玩意可能会导致一些理论机器在那里爆炸宇宙。

该死的鲍勃！

在实践中，很明显 std::is_trivially_copy_assignable 意味着表达式“A = B”只会计算为 memcpy()，所以继续利用。当然，当你 memcpy() 一个不是严格 std::is_trivially_copyable 的类型时，可能会有一些晦涩难懂的实现给你指指点点，我敢肯定 Bob 可能是上述实现的作者，但你真的在乎吗？

这只是我的猜测，请注意。我在这方面有一些经验，但我绝不是 C++ 细节方面的世界级专家。如果我对此有误（在实践中，而不仅仅是在理论上），请随时告诉我。我也很想看到一台 CHAR_BIT > 8 的机器（我实际上会关心），或者一台具有非 IEEE-754 浮点数的机器（同样，我实际上会关心）。

# c# - 是否有基于 T4 旁边的模板生成 Razor 视图（.cshtml）？

> ID：12876865
> 
> 赞同：5
> 
> 时间：2012-10-13T20:49:14.693
> 
> 标签：c#, asp.net-mvc-3, templates, code-generation

我正在开发一些代码生成器，用于基于数据库表生成模型、控制器和视图，这样我就可以创建一个 Asp.Net MVC3 网站。我现在可以使用 CodeDOM 生成模型和控制器，但是为了生成视图，我需要一些东西来制作模板，比如从 .cs 生成 .cshtml，我认为 T4 是个好主意，但我的一些同事坚持不使用 T4，是还有其他方法吗？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T14:13:26.887

我不确定他们为什么反对使用 T4，因为包括 Entity Framework 在内的许多代码库都使用它们。听起来你在做我刚做完的事情。我喜欢使用 Pre-Processed T4 模板，因此我能够将数据从 C# 代码输入到模板中，并以这种方式生成文件。这允许您有多个文件输出和基本参数来传递数据。

我使用它的方式是..我创建了一个类，用于收集有关数据库的所有信息..要包含或排除哪些表..然后是每个列的信息，如 pk 或 identity 可为空等。我将预处理的 t4 模板插入到该信息中，该信息能够生成所有 SQL、视图、模型、控制器信息……并且每当数据库更改时……我只需运行我的控制台应用程序并重新生成它。

预处理： http: [//odetocode.com/Blogs/scott/archive/2011/01/03/preprocessed-t4-templates.aspx](http://odetocode.com/Blogs/scott/archive/2011/01/03/preprocessed-t4-templates.aspx)

实体框架：http: [//msdn.microsoft.com/en-us/data/gg558520.aspx](http://msdn.microsoft.com/en-us/data/gg558520.aspx)

MVCScaffolding：http: [//blog.stevensanderson.com/2011/04/06/mvcscaffolding-overriding-the-t4-templates/](http://blog.stevensanderson.com/2011/04/06/mvcscaffolding-overriding-the-t4-templates/)

T4MVC： [http ://mvccontrib.codeplex.com/wikipage?title=T4MVC](http://mvccontrib.codeplex.com/wikipage?title=T4MVC)

我再次知道这无助于回答您的问题，但 T4 非常棒，我很想听听关于为什么不使用 T4 的争论。它甚至是内置的！

顺便说一句，这里有一些智能！： http: [//t4-editor.tangible-engineering.com/T4-Editor-Visual-T4-Editing.html](http://t4-editor.tangible-engineering.com/T4-Editor-Visual-T4-Editing.html)

如果您有任何问题，请随时联系我，我喜欢 T4，我愿意回答我能回答的任何问题。

这是我用来生成我的 POCO 模型的模板示例。由于使用我的普通 c# 方法传入数据的预处理能力，已经提取了很多内容。这个模板为我创建了 55 个模型，基于数据库中的表。

我的“SchemeCollector”使用我创建的 DatabaseInfo、TableInfo 和 ColumnInfo 类来保存我需要的所有模式。然后我有 9 个其他 t4 模板，它们也使用 SchemaCollector 类来填充数据。

这是我用来将数据传递到模板中进行生成的扩展。我有这一切设置也可以使用 XML 文件进行配置，但我只是希望它真正可重用是不必要的。

```
public partial class PocoGenerator
    {
        public string Namespace { get; set; }
        public string Inherit { get; set; }
        public DatabaseInfo Schema { get; set; }
        public bool Contract { get; set; }
        public string SavePath { get; set; }
    } 
```

这是我用来调用和填充模板并保存它的方法。

```
static void GeneratePoco(Config config)
        {
            var template = config.Poco;
            template.Schema = config.DatabaseInfo;

            File.WriteAllText(template.SavePath, template.TransformText());

            Console.WriteLine("      - POCOs generated for " + config.DatabaseInfo.DatabaseName + " complete");
        } 
```

这是模板

```
<#@ template  debug="true" hostSpecific="true" #>
<#@ output extension=".cs" #>
<#@ Assembly Name="System.Core.dll" #>
<#@ Assembly Name="System.Windows.Forms.dll" #>
<#@ import namespace="System" #>
<#@ import namespace="System.IO" #>
<#@ import namespace="System.Diagnostics" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Collections" #>
<#@ import namespace="System.Collections.Generic" #> 
<#@ assembly name="System.Xml.dll" #>
<#@ assembly name="System.Data.dll" #>
<#@ import namespace="System.Data" #>
<#@ import namespace="System.Data.SqlClient" #>
<#@ import namespace="CodeGenerator.Utilities" #>

using System;
using System.Runtime.Serialization;

namespace My.Models
{   <#  
        List<TableInfo> tables = Schema.Tables; 
    #>

    //#########################################################################################################
    //   This file has been generated from the tables contained in the <#= Schema.DatabaseName #> database.
    //   Changes to this file will be overwritten when the file is regenerated. Generated: <#= DateTime.Now #>
    //#########################################################################################################
    <#
    foreach (TableInfo table in tables)
    {
    #>

    [DataContract]
    public class <#= table.Name #> : IConfigTable
    {

        <#
        PushIndent("        "); 
            foreach (ColumnInfo col in table.Columns)
            {
                if(col.IsKey || col.IsIdentity)
                    WriteLine("[Key]");

                WriteLine("[DataMember]");
                if(col.IsNullable && col.Type != "string")
                    WriteLine("public " + col.Type + "? " + col.Name+ " { get; set; }");
                else
                    WriteLine("public " + col.Type + " " + col.Name+ " { get; set; }");
            }PopIndent();#>     
    }
    <# } #>
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-21T01:18:30.570

你的答案在这里：[https ://stackoverflow.com/a/2457206/538387](https://stackoverflow.com/a/2457206/538387)

其中有[ASP.NET MVC 和虚拟视图的链接](http://www.umbraworks.net/bl0g/rebuildall/2009/11/17/ASP_NET_MVC_and_virtual_views)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T17:35:17.243

我们有类似的任务，我们正在创建基于带有表单定义的输入 json 文件的动态 Web 表单。编辑器指定应在表单上呈现的不同控件（控件包含不同的属性、操作、验证器）。下面我将尝试描述我们逻辑的基本过程：

1.  反序列化和验证 json 文件。
2.  准备将传递给 T4 模板的数据。
3.  从数据生成 MVC 模型和控制器（步骤 2）。
4.  生成其他类（例如，一些帮助器、模型中的复杂类型）。
5.  添加到程序集嵌入资源，例如数据源等，图像等等。
6.  编译上面的所有东西。
7.  将 dll 放入模型文件夹中。
8.  重新启动站点。

模型中的所有属性都有其*[[UIHint]](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.uihintattribute.aspx)*属性和部分视图的名称。我们有大约 10 个知道如何表示每个属性的局部视图。为了支持这个逻辑，我们扩展了 ViewEngine 和 ModelMetadata 提供者。

ViewEngine 在附加文件夹中查找视图。ModelMetada 提供程序添加到“AdditionalValues”自定义属性。

我们的模型视图只有一行

```
@Html.EditorForModel() 
```

我们已经覆盖了 Object.cshtml 来处理“深度绑定”。最困难的部分是集合项目是复杂类型的集合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-13T21:13:37.103

我们广泛使用了 Code smith，还编写了一个插件。使用 t4 虽然您可以简单地生成类然后删除模板 - 为什么反对 T4？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-14T00:26:55.507

当然，我通过使用不错的扩展[RazorGenerator](http://razorgenerator.codeplex.com/)将 Razor 用于我的所有代码生成（和电子邮件生成等） 。它允许您将此扩展指定为“自定义工具”，并根据您的`.cshtml`输入生成一个结果 C# 类，您可以调用（并传入 a `@model`）将文本转换为您喜欢的任何输出。（在你的情况下有点讽刺的是，这将是剃刀 => 剃刀转换）

# ruby - String.scan 和 String.split 的区别

> ID：12876866
> 
> 赞同：11
> 
> 时间：2012-10-13T20:49:23.813
> 
> 标签：ruby

Ruby 中这两个 (`String#scan`和) 有什么区别？`String#split`

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-13T20:54:59.557

它们服务于完全不同的目的。 [`String#scan`](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-scan)用于从字符串中提取正则表达式的匹配项并在数组中返回匹配项，而[`String#split`](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-split)旨在基于分隔符将字符串拆分为数组。定界符可以是静态字符串（例如`;`在单个分号上拆分）或正则表达式（例如`/\s/+`在任何空白字符上拆分）。

的输出`String#split`不包括分隔符。相反，除定界符之外的所有内容都将在输出数组中返回，而 的输出`String#scan`将*仅*包括与定界符匹配的内容。

```
# A delimited string split on | returns everything surrounding the | delimiters
"a|delimited|string".split("|")
# Prints: ["a", "delimited", "string"]

# The same string scanninng for | only returns the matched |
"a|delimited|string".scan("|")
# Prints: ["|", "|"] 
```

以上两种方法都可以接受一个正则表达式来代替简单的字符串`"|"`。

```
# Split on everything between and including two t's
"a|delimited|string".split(/t.+t/)
# Prints: ["a|delimi", "ring"]

# Search for everything between and including two t's
"a|delimited|string".scan(/t.+t/)
# Prints: ["ted|st"] 
```

# iphone - 恢复 UIScrollview 的状态

> ID：12876867
> 
> 赞同：0
> 
> 时间：2012-10-13T20:49:38.590
> 
> 标签：iphone, objective-c, xcode, cocoa, uiscrollview

我试图弄清楚如何保存 UIScrollView 的状态。例如，我在从 xib 加载的 UIScrollView 中有几个图像和标签。

现在我的问题是，当用户返回此页面时，我如何才能使滚动视图的状态与他们停止滚动时的状态相同？有谁知道如何做到这一点？谢谢。

我发现了这个：

```
NSUserDefaults  *defaults = [NSUserDefaults standardDefaults];
[defaults setFloat: scrollview.contentOffset.x forKey: @"myScrollPositionX"];
[defaults setFloat: scrollview.contentOffset.y forKey: @"myScrollPositionY"]; 
```

和恢复：

```
scrollView.contentOffset = CGPointMake([defaults floatForKey: @"myScrollPositionX"], [defaults floatForKey: @"myScrollPositionY"]); 
```

我应该在哪里实现这个？对不起，我是**新人**，所以请简单点：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:59:00.000

You can save the position to the defaults in the viewWillDisappear:animated method of your view controller, and set the content offset in the viewWillAppear:animated method, so the state is saved as the user leaves the view, and is restored just before the user re-enters the view.

# php - 安排一个调用mysql中存储过程的php页面每x秒运行一次

> ID：12876868
> 
> 赞同：0
> 
> 时间：2012-10-13T20:49:48.423
> 
> 标签：php, mysql, stored-procedures, cron, scheduler

我在 mysql 中有一个存储过程，由 php 页面访问。此页面对访问者不可见（因为此页面不会显示站点中的任何链接）。这个 php 页面将只驻留在服务器中。我想知道我是否可以让服务器每隔 1 分钟自动运行/加载/.. php 页面，以便页面每 1 分钟调用一次存储过程。

我可以让调度程序运行存储过程，但由于我将使用存储过程上的 php 页面做很多其他事情，我希望每 1 分钟安排一次 php 页面。

这可能吗？我可能想太多了！我对调度程序不太了解，可能就是这样。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:57:41.337

Add a cron job:

```
 $ crontab -e 
```

To run the job every minute, inside the crontab, add the entry :

```
 * * * * * /usr/bin/php pathtoyourscript.php 
```

The [Wikiedia entry on Cron](http://en.wikipedia.org/wiki/Cron) has the information about what each star means.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T20:54:06.970

PHP 有一个命令行可执行文件，名为 php。您可以安排它来处理页面。例如`php myfile.php`，将运行文件 myfile.php。您可以使用服务器的调度工具（linux cron、windows 任务调度程序）为您运行该命令。

# android - Android - 尝试实现 Google Places API

> ID：12876870
> 
> 赞同：1
> 
> 时间：2012-10-13T20:49:57.620
> 
> 标签：android, json, http, google-places-api

我以前从未使用过 Google 地方信息，并认为是时候这样做了。我遵循了本教程：[http ://www.androidhive.info/2012/08/android-working-with-google-places-and-maps-tutorial/](http://www.androidhive.info/2012/08/android-working-with-google-places-and-maps-tutorial/)

我的问题是，当我创建此方法`createRequestFactory()`时，它说`JsonHttpParser`该类现在已弃用。我到处寻找替代解决方案，但一直未能做到。我的目标是 Android 2.1 并在 Eclipse Juno 中开发。有没有人知道如何解决这个冲突？我没有得到任何编译错误，并且 eclipse 正在构建它没有任何问题，但我不想使用这个已弃用的类。

这是我的代码：

```
public static HttpRequestFactory createRequestFactory(
        final HttpTransport transport) {
    return transport.createRequestFactory(new HttpRequestInitializer() {
        public void initialize(HttpRequest request) {
            GoogleHeaders headers = new GoogleHeaders();
            headers.setApplicationName("AndroidHive-Places-Test");
            request.setHeaders(headers);
            // deprecated this last two lines
            JsonHttpParser parser = new JsonHttpParser(new JacksonFactory());
            request.addParser(parser);
        }
    });
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T08:35:42.650

```
try{
    HttpPost httppost = new HttpPost(googleSearchPlaceUrl);
    HttpClient httpclient = new DefaultHttpClient();
    response = httpclient.execute(httppost);
    String data = EntityUtils.toString(response.getEntity());
    //parse with Json 

} catch (Exception e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T21:04:34.703

您必须使用 JsonObjectParser 而不是 JsonHttpParser

```
JsonObjectParser parser = new JsonObjectParser(new JacksonFactory()); 
```

# sql - SQL聚合函数计算有标准吗？

> ID：12876873
> 
> 赞同：5
> 
> 时间：2012-10-13T20:50:43.183
> 
> 标签：sql, performance, standards, aggregate-functions

在同一个查询中对同一个聚合函数的多次调用是否有关于 SQL 实现的标准？

例如，考虑以下示例，基于流行的示例模式：

```
SELECT Customer,SUM(OrderPrice) FROM Orders
GROUP BY Customer
HAVING SUM(OrderPrice)>1000 
```

据推测，计算 SUM(OrderPrice) 的值需要计算时间。每次引用聚合函数都会产生此成本，还是为特定查询存储结果？

或者，这种情况下是否没有 SQL 引擎实现的标准？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T21:14:12.247

尽管我使用过许多不同的 DBMS，但我只会向您展示在 SQL Server 上证明这一点的结果。考虑这个查询，它甚至在表达式中包含一个 CAST。查看查询计划，表达式`sum(cast(number as bigint))`只使用一次，定义为`DEFINE:([Expr1005]=SUM([Expr1006]))`.

```
set showplan_text on
select type, sum(cast(number as bigint))
from master..spt_values
group by type
having sum(cast(number as bigint)) > 100000

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  |--Filter(WHERE:([Expr1005]>(100000)))
       |--Hash Match(Aggregate, HASH:([Expr1004]), RESIDUAL:([Expr1004] = [Expr1004]) DEFINE:([Expr1005]=SUM([Expr1006])))
            |--Compute Scalar(DEFINE:([Expr1004]=CONVERT(nchar(3),[mssqlsystemresource].[sys].[spt_values].[type],0), [Expr1006]=CONVERT(bigint,[mssqlsystemresource].[sys].[spt_values].[number],0)))
                 |--Index Scan(OBJECT:([mssqlsystemresource].[sys].[spt_values].[ix2_spt_values_nu_nc])) 
```

上面可能不是很明显，因为它没有显示 SELECT 结果，所以我`*10`在下面的查询中添加了一个。请注意，它现在包括一个额外的步骤`DEFINE:([Expr1006]=[Expr1005]*(10))`（步骤从下到上运行），这表明新表达式需要它执行额外的计算。然而，即使这是优化的，因为它不会重新计算整个表达式 - 只是，它使用 Expr1005 并将其乘以 10！

```
set showplan_text on
select type, sum(cast(number as bigint))*10
from master..spt_values
group by type
having sum(cast(number as bigint)) > 100000

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  |--Compute Scalar(DEFINE:([Expr1006]=[Expr1005]*(10)))
       |--Filter(WHERE:([Expr1005]>(100000)))
            |--Hash Match(Aggregate, HASH:([Expr1004]), RESIDUAL:([Expr1004] = [Expr1004]) DEFINE:([Expr1005]=SUM([Expr1007])))
                 |--Compute Scalar(DEFINE:([Expr1004]=CONVERT(nchar(3),[mssqlsystemresource].[sys].[spt_values].[type],0), [Expr1007]=CONVERT(bigint,[mssqlsystemresource].[sys].[spt_values].[number],0)))
                      |--Index Scan(OBJECT:([mssqlsystemresource].[sys].[spt_values].[ix2_spt_values_nu_nc])) 
```

这很可能是所有其他 DBMS 的工作方式，至少考虑到主要的那些，即 PostgreSQL、Sybase、Oracle、DB2、Firebird、MySQL。

# ruby-on-rails - Rails 3.2：remote => true，提交后绑定

> ID：12876875
> 
> 赞同：2
> 
> 时间：2012-10-13T20:51:06.287
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3, ruby-on-rails-3.2

我有一个表单字段，我想立即清空提交。通常我会做类似的事情：

```
$("#form").submit(function(e){
  e.preventDefault();
  $.post(/* custom craft request */);
  $("#field").val('');
}); 
```

Rails 在我添加 时处理所有自定义制作`:remote => true`，但我找不到在提交后立即绑定的方法。

文档（[http://guides.rubyonrails.org/ajax_on_rails.html](http://guides.rubyonrails.org/ajax_on_rails.html)）坚持有一个 ajax:after 事件，但这似乎不存在。显然这个文档已经完全过时了，因为像 remote_form_for 这样的其他函数在 3.2 中不存在

任何帮助表示赞赏。我使用的 setTimeout 真的不太好。

编辑：添加我要替换的工作 setTimeout 解决方案：

```
$("#form_id").submit(function(e){
    setTimeout(function(){ 
        //this will happen after submission     
    }, 15);
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T22:07:13.780

您可以通过执行以下操作附加到 ajax 回调：

```
$("#form").bind("ajax:send", function(e){
   $("#field").val('');
}); 
```

不要忘记包含 rails.js 库[https://github.com/rails/jquery-ujs](https://github.com/rails/jquery-ujs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T21:57:50.163

根据 ujs wiki ( [https://github.com/rails/jquery-ujs/wiki/ajax](https://github.com/rails/jquery-ujs/wiki/ajax) )，所有 ajax 全局事件都可用：[http ://docs.jquery.com/Ajax_Events](http://docs.jquery.com/Ajax_Events)

所以这应该可以解决问题：

```
$("#form").bind("ajaxSend", function(){
  $("#field").val('');
}); 
```

我假设您希望在发送请求时立即触发事件。否则，您当然可以使用以下内容在完成后清除该字段（适用于失败或成功）：

```
$("#form").bind("ajax:complete", function(){
  $("#field").val('');
}); 
```

# applescript - 使用苹果脚本批量重命名子文件夹中的项目

> ID：12876878
> 
> 赞同：1
> 
> 时间：2012-10-13T20:51:11.140
> 
> 标签：applescript, batch-rename

我一整天都在尝试执行以下操作：我有一个包含 99 个子文件夹的文件夹。每个子文件夹里面都有一个pdf文件，它们都必须重命名才能使用相同的名称。现在它们以连续数字命名。因为我是脚本新手，所以我一直在用自动机做我所有的事情。但我有点不喜欢放弃一个问题。谷歌搜索没有带来任何好的解决方案。我试图理解示例脚本并对其进行修改，但没有成功。一个简短的尝试是：

```
tell application "Finder"
    set selected to selection
    open selected
    get files of folders of selected
    set name of files of folders to "anschreiben"
end tell 
```

我也试过：

```
tell application "Finder"
    set selected to selection
    open selected
    set mlist to every folder of selected
    set current_folder to first item of selected
    set xxx to first item of current_folder
    set name of xxx to "yyy"
    repeat with this_folder in mlist
        open current_folder
        set item 1 to item of current_folder
    end repeat
end tell 
```

，但是这将第一个文件夹重命名为 yyy 并产生了文件名已经给出的错误（因为它重命名了子文件夹，而不是里面的文件）

所以......我如何更深入地了解并重命名子文件夹中的所有文件？

谢谢大家，我知道这对你来说可能很容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T06:49:55.647

完成了！多亏了你和其他一两个专业人士，我现在有了一个漂亮的批量邮件脚本例程，它使用自动机、bash 行和（主要是）applescript。我将它用于工作申请，但您可以将它用于任何需要使用 Mail、MS Word 和 Excel 中的任何给定联系人列表（或就此而言的通讯簿）进行个性化批量电子邮件的情况。为了完整起见，我将添加所有必要的步骤。使用任何给定的 x 个姓名、电子邮件地址、个人地址列表，您可以生成 x 个子文件夹，其中包含 x 个个性化字母和非个性化文档。一旦您启动最后一个脚本并选择文件夹，您就可以观看将它们全部发送出去的邮件，按姓名称呼该人并附上正确的个性化信件（您参与了这一部分，adayzone！）！它更正了在电子邮件地址中呈现不同的外国名称拼写。它最适用于在“@”之前使用姓氏的电子邮件地址，并且现在可以忽略在姓氏前面设置的名字（即 firstname.lastname@company.com）。非常感谢大家的帮助！这是伟大的团队努力。我一回家就发，我应该在这里添加还是在另一个论坛（用于共享代码）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T21:04:10.310

寻找“全部内容”

```
set newName to "New.pdf"

tell application "Finder"
    set myFiles to every file of (entire contents of (first item of (selection as alias list)))
    repeat with aFile in myFiles
        set aFile's name to newName
    end repeat
end tell 
```

# javascript - 在 JQuery 和 Javascript 中向突出显示的文本添加数据

> ID：12876887
> 
> 赞同：0
> 
> 时间：2012-10-13T20:51:56.983
> 
> 标签：javascript, jquery, highlight, highlighting

`<SPAN>`我在网上找到了这个出色的代码，用于通过使用标签和用户定义的类包装来突出显示文本中的单词。我多次使用它来一次突出显示多个搜索而没有任何问题。

我想要做的是向此代码添加一个额外的功能，以向使用 JQuery 的 .data() 方法添加的每个标签添加更多数据。但是函数是如此的整洁和高效我找不到我需要注入它的地方！

我想要一个像`highlightJQueryText(elem, str, className, dataName, data)`

```
highlightJQueryText: function (elem, str, className) {
            var regex = new RegExp(str, "gi");
            return elem.each(function () {
            $(this).contents().filter(function() {
                    return this.nodeType == 3 && regex.test(this.nodeValue);
                }).replaceWith(function() {
                        return (this.nodeValue || "").replace(regex, function(match) {
                        return "<span class=\"" + className + "\">" + match + "</span>";
                    });
                });
            });
        } 
```

PS。它应该`span.data("dataName", data)`只将 a 添加到同时创建的那些标签中。（不是容器中具有“className”类的所有内容。）因为我使用相同的“ClassName”为不同的短语在同一个容器上多次运行该函数，但仍然希望在每个短语上存储一组不同的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T21:19:07.340

像这样的东西应该可以解决问题：

```
highlightJQueryText: function (elem, str, className, dataName, data) {
    var regex = new RegExp(str, "gi");
    return elem.each(function () {
        $(this).contents().filter(function() {
            return this.nodeType == 3 && regex.test(this.nodeValue);
        }).replaceWith(function() {
            return (this.nodeValue || "").replace(regex, function(match) {
                return "<span data-"+dataName+"=\""+data+"\" \
                              class=\""+className+"\">"+match+"</span>";
            });
        });
    });
} 
```

或者如果你真的想使用 JQuery`data`方法：

```
highlightJQueryText: function (elem, str, className, dataName, data) {
    var regex = new RegExp(str, "gi");
    return elem.each(function () {
    $(this).contents().filter(function() {
            return this.nodeType == 3 && regex.test(this.nodeValue);
        }).replaceWith(function() {
            return (this.nodeValue || "").replace(regex, function(match) {
                return $("<span class=\""+className+"\">"+match+"</span>")
                    .data(dataName, data);
            });
        });
    });
} 
```

# java - Java JTabbedPane 不能添加多个选项卡？

> ID：12876889
> 
> 赞同：2
> 
> 时间：2012-10-13T20:52:04.693
> 
> 标签：java, swing, text, actionlistener, jtabbedpane

我正在做一个特定的应用程序，只是一个基本的文本编辑器，我记得我有选项卡和 JMenu，所以如果你去 File --> New 它会在 JTabbedPane 上添加或“打开”另一个选项卡。但这一次它不是为我做的，有人可以帮忙吗？这是我的做法：

```
newFile.addActionListener(
                new ActionListener(){
                    public void actionPerformed(ActionEvent event){
                        tabs.addTab("new file", text);
                    }
                }
        ); 
```

因此，当单击它时，它应该添加另一个选项卡，但不是出于某种原因...如果重要的话，一开始会打开一个默认选项卡，当您单击新选项卡时，它会清除旧选项卡。谢谢你的帮助！（请询问您是否需要更多解释）在这里我上传了我的代码，因为这里的编辑器一直说我输入的方式格式不正确： http:
[//nardcake.com/java](http://nardcake.com/java)
那里有 2 个文件，一个初始化它和另一个是一切谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:54:25.460

~~尝试：~~

 ~~```
tabs.revalidate();
tabs.repaint(); 
```~~  ~~我已经删除了这两行（无论如何，这两行都是通过 addTab() 方法调用的），并像这样重写了你的 init.java：

```
 public static void main(String[] args) {
 System.out.println(SwingUtilities.isEventDispatchThread()); // 1
 SwingUtilities.invokeLater(new Runnable() {

        @Override
        public void run() {
            System.out.println(SwingUtilities.isEventDispatchThread()); //2
            EBLFWE window = new EBLFWE();
            window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            window.setExtendedState( window.getExtendedState()|JFrame.MAXIMIZED_BOTH );
            window.setSize(1024, 728);
            window.setVisible(true);
        }
    }); 
```

现在可以了。[引用](https://stackoverflow.com/questions/12872775/how-to-move-3-buttons-inside-a-window/12872821#128728219)我自己的话：

> Swing 组件的每次使用都必须通过 Event Dispatch Thread（缩写为[EDT](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)）来完成，否则您可能会得到不需要的视觉效果。请参阅[此处](http://www.javamex.com/tutorials/threads/invokelater.shtml)了解说明。

编辑：

所有与 GUI 相关的代码都必须在 EDT 上执行。您可以测试您的代码的某些部分是否*由*EDT 运行，如下所示：

```
 System.out.println(SwingUtilities.isEventDispatchThread()); 
```

如果它打印为 true，那么您可以安全地进行 GUI 更新（例如，在 Swing 组件实例上调用方法）——例如在 1 或 EBLFWE 类中的任何地方。但是 2 会打印错误 - 这是因为 运行*您*的程序的[线程](http://en.wikipedia.org/wiki/Thread_(computing))*不是*EDT。

 **当调用[SwingUtilities.invokeLater()](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingUtilities.html#invokeLater(java.lang.Runnable))时，您实际上是在事件调度线程中放置要执行的代码（在 EDT 认为合适的某个适当时间）。

EDT 执行实际的绘画和许多其他任务，因此当您从另一个[线程](http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.html)调用 GUI 更新代码时，您可能会弄乱顺序并获得不需要的视觉外观。**~~

# multithreading - Clojure + RabbitMQ / 多线程消息消费

> ID：12876892
> 
> 赞同：0
> 
> 时间：2012-10-13T20:52:34.317
> 
> 标签：multithreading, clojure, jvm, rabbitmq, langohr

**上下文：Clojure + RabbitMQ（通过 Langohr），对**[这个问题](https://stackoverflow.com/questions/12718573/clojure-message-handling-async-multithreaded)的跟进。

我在使用来自 RabbitMQ mq 的消息时得到了奇怪的结果（从直接交换获取消息并在处理消息后发布到扇出交换）。我不明白为什么消息在消费期间最终会出现在**单独的线程**中（每隔几条消息就会发生线程切换）。

消费者从一个单独的线程开始（以防止它在发生任何 IO 异常时使主线程崩溃），但这并不能解释切换。

```
; Message handler
(defn message-handler
  [pub-name ch metadata ^bytes payload]
  (let [msg (json/parse-string (String. payload "UTF-8"))
        content (string/join " " (map msg '("title" "link" "body")))
        tags (pluck-tags content)]
    (println (format "HANDLER %s: Message: %s | found tags: %s"
                     (Thread/currentThread)
                     (msg "title")
                     (tags-to-csv tags)))
  (nil)))
  ; (lb/publish ch pub-name "" (json/generate-string (assoc msg "tags" (tags-to-csv tags))))))

(defn -main
  [& args]
  (let [conn          (rmq/connect {:uri (System/getenv "MSGQ")})
        ch            (lch/open conn)
        q-name        "q.events.tagger"
        e-sub-name    "e.events.preproc"
        e-pub-name    "e.events"
        routing-key   "tasks.taggify"]
    (lq/declare ch q-name :exclusive false :auto-delete false)
    (le/declare ch e-pub-name "fanout" :durable false)
    (lq/bind ch q-name e-sub-name :routing-key routing-key)
    (.start (Thread. (fn []
       (lcm/subscribe ch q-name (partial message-handler e-pub-name) :auto-ack true)))))) 
```

消息处理程序只打印出当前线程和接收到的有效负载。这就是我得到的：

```
HANDLER in Thread[pool-1-thread-2,5,main]: Message: ...
HANDLER in Thread[pool-1-thread-2,5,main]: Message: ...
HANDLER in Thread[pool-1-thread-3,5,main]: Message: ... 
HANDLER in Thread[pool-1-thread-3,5,main]: Message: ...
HANDLER in Thread[pool-1-thread-3,5,main]: Message: ...
HANDLER in Thread[pool-1-thread-4,5,main]: Message: ...
HANDLER in Thread[pool-1-thread-4,5,main]: Message: ... 
```

**笔记**

我在和特工玩的时候注意到了这一点。我想在其自己的 CPU 绑定线程池中处理每条消息，并将其发布到无界 (IO) 线程池中。但是，在打印出当前线程后，我注意到即使不使用代理（或期货），消息也会由不同的线程处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T21:42:11.727

1）那里有一个扇出交换，这意味着在路由消息时根本不使用路由密钥。扇出交换将消息路由到绑定到它的每个队列。如果您想使用路由键，请使用直接或主题交换。

2）您总是使用相同的队列名称，这意味着您的代码所做的只是将多个消费者添加到同一个队列中。这意味着rabbitmq 只会围绕你的消费者循环消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T21:41:24.880

Langohr 的作者在这里。

代码中一定缺少某些东西。如果您使用代理获得此输出，那很容易：Clojure 代理（也包括期货和承诺）使用线程池。Langohr 的 langohr.consumers/subscribe 或 RabbitMQ Java 客户端中的底层 QueueingConsumer 没有。

# mysql - MySQL数据库复制问题——READ LOCK后二进制日志坐标不同

> ID：12876894
> 
> 赞同：0
> 
> 时间：2012-10-13T20:52:46.440
> 
> 标签：mysql, locking, replication

我即将复制一个频繁读/写的生产数据库。按照 MySQL 手册页上的说明，我执行以下命令

```
mysql> FLUSH TABLES WITH READ LOCK;
Query OK, 0 rows affected (0.16 sec)

mysql> show master status;
+------------------+-----------+--------------+------------------+
| File             | Position  | Binlog_Do_DB | Binlog_Ignore_DB |
+------------------+-----------+--------------+------------------+
| mysql-bin.000061 | 717697391 |              |                  |
+------------------+-----------+--------------+------------------+
1 row in set (0.00 sec) 
```

然后我通过执行以下命令开始我的备份过程

```
shell> mysqldump --lock-all-table --databases first second third -u root -p > dbdump.sql 
```

然后我运行以下命令

```
mysql> show master status;
+------------------+-----------+--------------+------------------+
| File             | Position  | Binlog_Do_DB | Binlog_Ignore_DB |
+------------------+-----------+--------------+------------------+
| mysql-bin.000061 | 717697462 |              |                  |
+------------------+-----------+--------------+------------------+
1 row in set (0.00 sec)

mysql> show master status;
+------------------+-----------+--------------+------------------+
| File             | Position  | Binlog_Do_DB | Binlog_Ignore_DB |
+------------------+-----------+--------------+------------------+
| mysql-bin.000061 | 717697462 |              |                  |
+------------------+-----------+--------------+------------------+
1 row in set (0.00 sec) 
```

如果执行“READ LOCK”语句后表已经被锁定，为什么连续两次“show master status”命令的坐标位置不同？我应该为我的复制使用哪个位置值？

顺便问一下，我需要跑步吗

```
mysql> UNLOCK TABLES; 
```

备份过程之后？或者当 mysqldump 完成时，表将自动解锁。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T22:32:03.507

如果您使用`mysqldump`该`--lock-all-tables`选项，`mysqldump`将`FLUSH TABLES WITH READ LOCK`在转储开始时发送，因此您无需手动执行。

# android - 为 Android 手机调试 Mono Droid 时出现握手错误

> ID：12876895
> 
> 赞同：1
> 
> 时间：2012-10-13T20:52:47.793
> 
> 标签：android, visual-studio-2010, xamarin.android

每隔一段时间（可能是三分之一）我部署到我的手机以测试我的 Android 应用程序（使用 Mono Droid 构建，专业的个人付费许可证），我收到以下错误。我正在使用 Visual Studio 2010，我的手机是 Android Samsung Epic 4G。

初始化调试器时出错：Mono.Debugging.Soft.ConnectionException：无法连接到调试器。---> System.IO.IOException：DWP 握手失败。

服务器堆栈跟踪：在 Mono.Debugger.Soft.Connection.Connect() ...

错误弹出后，我的应用程序在我的手机上显示空白一分钟，然后显示一个对话框强制关闭它。有没有人以前见过这种情况或知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-24T21:31:32.053

将目标更改为“AnyCPU”为我修复了它。

# python - 再次编码

> ID：12876896
> 
> 赞同：0
> 
> 时间：2012-10-13T20:52:52.547
> 
> 标签：python, encoding

我正在尝试在 python 上使用 sqlite：

```
from pysqlite2 import dbapi2 as sqlite
con = sqlite.connect('/home/argon/super.db')
cur = con.cursor()
cur.execute('select * from notes')
for i in cur.fetchall():
    print i[2] 
```

我有时会得到这样的东西（我来自俄罗斯）：

```
&#208;&#158;&#209;&#130;&#208;&#178;&#208;&#181;&#209;&#130; etc... 
```

如果我将此字符串传递给此函数（它在其他项目中对我有帮助）：

```
def unescape(text):
    def fixup(m):
        text = m.group(0)
        if text[:2] == "&#":
            # character reference
            try:
                if text[:3] == "&#x":
                    return unichr(int(text[3:-1], 16))
                else:
                    return unichr(int(text[2:-1]))
            except ValueError:
                pass
        else:
            # named entity
            try:
                text = unichr(htmlentitydefs.name2codepoint[text[1:-1]])
            except KeyError:
                pass
        return text # leave as is
    return re.sub("&#?\w+;", fixup, text) 
```

我得到更奇怪的结果：

```
ÐÑÐ²ÐµÑÐ¸ÑÑ Ñ ÑÐ¸ÑÐ¸ÑÐ¾Ð²Ð°Ð½Ð¸ÐµÐ¼ etc 
```

我应该怎么做才能获得正常的西里尔符号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T20:58:10.530

`&#208;&#158;``\xD0\x9E`看起来像是, 或的 UTF-8 字节对`\u1054`。更好地称为西里尔字符`О`（大写 O）。

换句话说，您手头上有奇怪编码的 UTF-8 数据。将`&#123;`数字转换为字节（`chr(208)`可以），然后从 UTF-8 解码：

```
>>> (chr(208) + chr(158)).decode('utf-8')
u'\u1054'
>>> print (chr(208) + chr(158)).decode('utf-8')
О
>>> print (chr(208) + chr(158) + chr(209) + chr(130) + chr(208) + chr(178)).decode('utf-8')
Отв 
```

# python - 如何在没有窗口的情况下将图像直接传送到屏幕上？

> ID：12876903
> 
> 赞同：1
> 
> 时间：2012-10-13T20:53:17.517
> 
> 标签：python, windows-7, windows-xp, screen, blit

如何显示来自 PNG、BITMAP、JPEG 文件等的图像。在没有窗口的屏幕上？我希望图像周围没有框架，最好不要在任务栏上注册为窗口。我想把这些图像快速连续地放在屏幕上。如果它与 Windows XP 和 Windows 7 兼容，我希望它。我愿意下载一个外部模块。如果这是可能的，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T22:16:58.727

这将创建一个透明背景的形状窗口，在同一文件夹中显示“image.png”

```
import wx

# Create a .png image with something drawn on a white background
# and put the path to it here.
IMAGE_PATH = 'image.png'

class ShapedFrame(wx.Frame):
    def __init__(self):
        wx.Frame.__init__(self, None, -1, "Shaped Window",
                style = wx.FRAME_SHAPED | wx.SIMPLE_BORDER)
        self.hasShape = False
        self.delta = wx.Point(0,0)

        # Load the image
        image = wx.Image(IMAGE_PATH, wx.BITMAP_TYPE_PNG)
        image.SetMaskColour(255,255,255)
        image.SetMask(True)            
        self.bmp = wx.BitmapFromImage(image)

        self.SetClientSize((self.bmp.GetWidth(), self.bmp.GetHeight()))
        dc = wx.ClientDC(self)
        dc.DrawBitmap(self.bmp, 0,0, True)
        self.SetWindowShape()
        self.Bind(wx.EVT_LEFT_DCLICK, self.OnDoubleClick)
        self.Bind(wx.EVT_LEFT_DOWN, self.OnLeftDown)
        self.Bind(wx.EVT_LEFT_UP, self.OnLeftUp)
        self.Bind(wx.EVT_MOTION, self.OnMouseMove)
        self.Bind(wx.EVT_RIGHT_UP, self.OnExit)
        self.Bind(wx.EVT_PAINT, self.OnPaint)
        self.Bind(wx.EVT_WINDOW_CREATE, self.SetWindowShape)
        self.Bind(wx.EVT_ERASE_BACKGROUND, self.OnEraseBackground)
    def OnEraseBackground(self,evt=None):
        pass        
    def SetWindowShape(self, evt=None):
        r = wx.RegionFromBitmap(self.bmp)
        self.hasShape = self.SetShape(r)

    def OnDoubleClick(self, evt):
        if self.hasShape:
            self.SetShape(wx.Region())
            self.hasShape = False
        else:
            self.SetWindowShape()

    def OnPaint(self, evt):
        dc = wx.PaintDC(self)
        dc.DrawBitmap(self.bmp, 0,0, True)

    def OnExit(self, evt):
        self.Close()

    def OnLeftDown(self, evt):
        self.CaptureMouse()
        pos = self.ClientToScreen(evt.GetPosition())
        origin = self.GetPosition()
        self.delta = wx.Point(pos.x - origin.x, pos.y - origin.y)

    def OnMouseMove(self, evt):
        if evt.Dragging() and evt.LeftIsDown():
            pos = self.ClientToScreen(evt.GetPosition())
            newPos = (pos.x - self.delta.x, pos.y - self.delta.y)
            self.Move(newPos)

    def OnLeftUp(self, evt):
        if self.HasCapture():
            self.ReleaseMouse()

if __name__ == '__main__':
    app = wx.PySimpleApp()
    ShapedFrame().Show()
    app.MainLoop() 
```

这是我使用的图像 ![这是我使用的图像](../Images/972dbd89511e63cdbd35afc640766dcf.png)

# c++ - 由于某种原因必须两次发送 MPI 消息

> ID：12876904
> 
> 赞同：0
> 
> 时间：2012-10-13T20:53:21.383
> 
> 标签：c++, c, multiprocessing, mpi

我一直在研究一个 MPI 项目，其中从站都将数据发送回主站。出于某种原因，如果我连续进行 2 次连续发送，主机只会收到数据。这很奇怪，我认为这会导致我遇到其他一些奇怪的问题。知道什么会导致这种情况吗？我认为第一次发送是发送某种垃圾数据或其他东西。但是，发送是完全相同的代码行。

编辑：下面的代码...

```
if (numProcs > 0)
    MPI_Barrier( MPI_COMM_WORLD ) ; //only wait if there are other processes to wait for

if (rank != 0)
{
    MPI_Send(handArray, 10, MPI_DOUBLE, 0, TAG_HAND, MPI_COMM_WORLD);
    MPI_Send(handArray, 10, MPI_DOUBLE, 0, TAG_HAND, MPI_COMM_WORLD);
}
//8\. After the main loop the master process receives and sums together the hand counts array
//   from each slave process.
else
{
    int activeProcs = numProcs - 1;
    getHandsFromSlaves( activeProcs, handArray ); 
```

然后主人继续打印一些数据......

这是 getHands FromSlaves 方法。请注意，我也尝试过使用阻塞调用来解决同样的问题。

```
void getHandsFromSlaves( int& activeCount, double handTotals[10] ){

static MPI_Request request;
static int msgBuff, recvFlag;
static double handBuff[10];
MPI_Status status;

while (activeCount > 0)
{
    if( request )
    {
        // Already listening for a message

        // Test to see if message has been received
        MPI_Test( &request, &recvFlag, &status );
        //cout << "TAG: " << status.MPI_TAG << " SOURCE: "<< status.MPI_SOURCE  << " ERROR: " << status.MPI_ERROR << endl;
        if( recvFlag )
        {
            // Message received
            if( status.MPI_TAG == TAG_HAND )
            {
                cout << "Hand Received!" << endl;

                for(int m = 0; m < 10; ++m)
                {
                    handTotals[m] += handBuff[m];
                }

                activeCount--;
            }
            else
            {
                //error report... what happened?
                cout << "TAG: " << status.MPI_TAG << " SOURCE: "<< status.MPI_SOURCE  << " ERROR: " << status.MPI_ERROR << endl;
            }

            // Reset the request handle
            request = 0;
        }
    }

    if( !request && activeCount > 0 )
        // Start listening again
        MPI_Irecv(&handBuff, 10, MPI_DOUBLE, MPI_ANY_SOURCE, MPI_ANY_TAG, MPI_COMM_WORLD, &request);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T23:02:00.427

好吧，您可能正在尝试处理太多消息，因为您的`request`变量在进入您的`getHandsFromSlaves()`例程时未定义。由于在输入时，`request`几乎可以肯定是非零的，`MPI_Test`因此即使您没有发布`Irecv`.

事实上，这里发布的代码摘录有很多非常奇怪的事情。为什么是局部变量`static`？你为什么要实现自己的 busywait`MPI_Test()`而不是 using `MPI_Wait()`？如果您在接收之间没有做任何有用的事情，为什么还要使用非阻塞接收？事实上，如果你只是总结所有的数组，你为什么要做单独的点对点接收而不是做一个`MPI_Reduce()`？

以下更短的代码似乎可以完成您在上面尝试做的事情：

```
#include <stdio.h>
#include <mpi.h>

int main (int argc, char **argv) {

    int rank, numProcs;

    MPI_Init(&argc, &argv);
    MPI_Comm_rank(MPI_COMM_WORLD, &rank);
    MPI_Comm_size(MPI_COMM_WORLD, &numProcs);
    double handArray[10];
    double handTotal[10];

    for (int i=0; i<10; i++)
        handArray[i] = rank + i;

    if (rank == 0)  // Since apparently rank 0 doesn't do anything
    {
        for (int i=0; i<10; i++)
            handArray[i] = 0;
    }

    MPI_Reduce(handArray, handTotal, 10, MPI_DOUBLE, MPI_SUM, 0, MPI_COMM_WORLD);

    if (rank == 0) {
        printf("Hand Totals= \n");
        for (int i=0; i<10; i++)
            printf(" %lf ", handTotal[i]);
        printf("\n");
    }

    MPI_Finalize();
} 
```

# ruby - 迷失在 rspec 的海洋中

> ID：12876905
> 
> 赞同：0
> 
> 时间：2012-10-13T20:53:26.103
> 
> 标签：ruby, rspec

我是如此接近。我正在为此方法创建一个简单的 rspec 测试。我希望它检查该方法是否接收到“板”并返回值 c3。

当前的测试看起来像这样......

```
 describe 'attempt_win' do
    it 'should contain all possible ai win moves' do
      @player_computer.attempt_win(@board).should include(@ai_winmoves)
    end
    it 'should return a win move' do
      # need to fake grid input here
      board = Board.new
      board.grid[:a1] = "O"
      board.grid[:b2] = "O"

      @player_computer.attempt_win(board).should  include("c3")  #how to say return 'c3' ??
    end
  end 
```

我正在测试的方法看起来像这样......

```
 def attempt_win(board)

    @keys_with_o = board.grid.select{ |k, v| v == "O" }.keys  # find Os on the board

    @answers_array = [] # initialize answers array

    @ai_winmoves.each do |k, v| # go through each win move in the ai_winmoves array above.         
      ai_keys = v.select{ |k, v| v == "O"}.keys # grab all computer player's Os from the value hash

      intersection = ai_keys & @keys_with_o 
      # get common elements between two arrays..note: keys_with_o = all current O's on game board
      if intersection.length >=2 # when two intersections exist it means two O's are on the board

        @answers_array << k # add to answers array per iteration

        @answers_array.each do |key|
          # answer = @anskey[@thing.last].to_sym
          puts "which moves can ai win with?"
          puts @anskey[key]
          answer = @anskey[key].to_sym
          puts "attempt win"
          puts answer

          if board.grid[answer] == " " #if win move space is empty take it
            @move = answer               
          else #check for a block move  
            # attempt_block    # handled at line 162               
          end
        end
      end
    end # END @ai_winmoves.each do |k,v|
  end 
```

当我运行 rspec spec 时，与此测试相关的输出如下所示...

```
 attempt_win
      should contain all possible ai win moves
  which moves can ai win with?
  c3
  attempt win
  c3
      should return a win move (FAILED - 1) 
```

所以我需要以某种方式在我的 rspec 期望中捕获“c3”

有人指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:12:00.120

好的，所以测试结果是这样的......

```
 describe 'attempt_win' do
    it 'should contain all possible ai win moves' do
      @player_computer.attempt_win(@board).should include(@ai_winmoves)
    end
    it 'should return a win move' do
      # need to fake grid input here
      myboard = Board.new
      myboard.grid[:a1] = "O"
      myboard.grid[:b2] = "O"

      @player_computer.attempt_win(myboard).should  eq(:c3)
    end
  end 
```

问题出在我如何在方法中返回我的答案...... Rspec 让我正确地写了它......

```
 def attempt_win(board)

    @keys_with_o = board.grid.select{ |k, v| v == "O" }.keys  # find Os on the board

    @answers_array = [] # initialize answers array

    @ai_winmoves.each do |k, v| # go through each win move in the ai_winmoves array above.         
      ai_keys = v.select{ |k, v| v == "O"}.keys # grab all computer player's Os from the value hash

      intersection = ai_keys & @keys_with_o 
      # get common elements between two arrays..note: keys_with_o = all current O's on game board
      if intersection.length >=2 # when two intersections exist it means two O's are on the board

        @answers_array << k # add to answers array per iteration

        @answers_array.each do |key|

          # puts "which moves can ai win with?"
          # puts @anskey[key]
          answer = @anskey[key].to_sym
          # puts "attempt win"
          # puts answer

          if board.grid[answer] == " " #if win move space is empty take it
            @move = answer              
          else #check for a block move  
            # attempt_block    # handled at line 162               
          end
        end
      end
    end # END @ai_winmoves.each do |k,v|
    return @move 
  end 
```

# php - 不同的图像出现在不同的页面上（Wordpress / PHP）

> ID：12876906
> 
> 赞同：3
> 
> 时间：2012-10-13T20:53:31.867
> 
> 标签：php, wordpress

我是 Wordpress / PHP 的新手。请你能建议我通过 Wordpress 在页面内显示图像的最佳方式吗？它们不必在管理员中进行编辑，但如果这样做更容易，则可以进行编辑。

目前我正在这样做；

```
<?php if (is_page(43)) { ?>
<img src="/images/notting-hill-4.jpg">
<img src="/images/notting-hill-5.jpg">

<?php } elseif (is_page(162)) {  ?>

<img src="/images/notting-hill-7.jpg">
<img src="/images/notting-hill-8.jpg">
<img src="/images/notting-hill-9.jpg">

<?php } else { ?>

<img src="/images/notting-hill-1.jpg">
<img src="/images/notting-hill-2.jpg">
<img src="/images/notting-hill-3.jpg">

<?php } ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T23:56:54.583

例如，您可以使用 NextGen 画廊插件。在这里找到它：[http ://wordpress.org/extend/plugins/nextgen-gallery/](http://wordpress.org/extend/plugins/nextgen-gallery/)

为每个页面创建一个画廊。然后使用简码或提供的其他方式来显示您想要的图像。不要被图库功能所迷惑，它还可以让您显示单个图像（我非常确定，虽然我已经有一段时间没有使用它了。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-23T06:22:19.523

您可以使用不同的模板并在编辑器中设置模板，然后每个页面都有不同类型的模板

阅读更多： [https ://codex.wordpress.org/Stepping_into_Templates](https://codex.wordpress.org/Stepping_into_Templates)

如果页面具有相同的模板，您可能只需将图像直接添加到帖子或页面编辑器中

# css - 垂直拉伸 div 100% 高度

> ID：12876907
> 
> 赞同：2
> 
> 时间：2012-10-13T20:53:33.150
> 
> 标签：css, html

[jsfiddle](http://jsfiddle.net/Jf5J8/1/)

如何将第二个 div 延伸到其所有垂直位置。它必须“照顾”他上方 div 的下边距和所有页面的下边距。如何让它填满所有的地方？里面会有正常的内容，我会制作水平滚动的页面，我需要它来适应各种用户 Y 分辨率。底部边距将保持不变。我真的很想避免使用js。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T21:05:05.557

[http://jsfiddle.net/Jf5J8/2/](http://jsfiddle.net/Jf5J8/2/)

```
#rest {
         background-color:blue;
         height:100%;
         position:relative;
         top:0;left:0;
         bottom:0;right:0;
      }
html, body {
             height:100%;
           } 
```

你的代码

```
#rest {
    background-color:blue;
    height:100%;
    position:relative;
    top:0;
    left:0;
    bottom:0;
    right:0;
    height:auto; 
```

}

包含两次时间`height`。`height:auto;`最后删除

# php - Codeigniter 图像库使用 2 组坐标裁剪图像以在任何地方制作正方形？

> ID：12876908
> 
> 赞同：0
> 
> 时间：2012-10-13T20:53:36.420
> 
> 标签：php, codeigniter, image-processing, gd

花时间阅读文档并搜索示例。我了解从顶部 0 裁剪图像，左侧 0 非常简单。然而。我想传递两组坐标，一个起点和一个终点。四点，一个在任何地方定义的正方形。但是，从我找到的示例中，以及从我收集到的内容中，演绎不会让我这样做。codeigniter 所以我正在寻求对这个想法的确认，我是否只能提供从 0 开始的端点，并且它会根据所述端点裁剪一个正方形，或者我可以实际指定一个 x 开始，一个 x 结束，以及类似的 y ?

或者我可以在codeigniter中使用其他一些技术来传递起点和终点的坐标吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T21:32:59.530

您可以使用例如定义的裁剪图像类，并通过库或 codeigniter 中的帮助程序将其称为类：

例如调用它：

```
LibraryCropImage::ResizedThumbnail($profile_thumbsize_x, $profile_thumbsize_x, $path, $filename, $path_to, $filename_to.'_sized', $quality, $fileextension);
LibraryCropImage::CroppedThumbnail($profile_thumbsize_x, $profile_thumbsize_x, $path, $filename, $path_to, $filename_to.'_cropped', $quality, $fileextension);

abstract class LibraryCropImage  {

    function ResizedThumbnail($thumbnail_width, $thumbnail_height, $path, $filename, $path_to, $filename_to, $quality, $ext)
    {
    list($width, $height) = getimagesize($path.$filename);

    $new_width = $thumbnail_width;
    $new_height = $thumbnail_height;

    if ($ext == "jpg" || $ext == "jpeg")
    {
        $thumb = @imagecreatefromjpeg($path.$filename);
    }
    else if ($ext == "gif")
    {
        $thumb = @imagecreatefromgif($path.$filename);
    }
    else if ($ext == "png")
    {
        $thumb = @imagecreatefrompng($path.$filename);
    }
    $thumbp = imagecreatetruecolor($new_width, $new_height);

    imagecopyresampled($thumbp, $thumb, 0, 0, 0, 0, $new_width, $new_height, $width, $height);

    ob_start();
    if ($ext == "jpg" || $ext == "jpeg")
    {
        imagejpeg($thumbp, null, $quality);
    }
    else if ($ext == "gif")
    {
        imagegif($thumbp);
    }
    else if ($ext == "png")
    {
        imagepng($thumbp, null);
    }
    $i = ob_get_clean();
    $fp = fopen($path_to.$filename_to.'.'.$ext, 'w');
    fwrite ($fp, $i);
    fclose ($fp);
    imagedestroy($thumbp);
    }

    function CroppedThumbnail($thumbnail_width, $thumbnail_height, $path, $filename, $path_to, $filename_to, $quality, $ext)
    {
    list($width, $height) = getimagesize($path.$filename);

    $new_width = $thumbnail_width;
    $new_height = $thumbnail_height;

    if ($ext == "jpg" || $ext == "jpeg")
    {
        $image = @imagecreatefromjpeg($path.$filename);
    }
    else if ($ext == "gif")
    {
        $image = @imagecreatefromgif($path.$filename);
    }
    else if ($ext == "png")
    {
        $image = @imagecreatefrompng($path.$filename);
    }

    $filename = $path.$filename;

    $thumb_width = $thumbnail_width;
    $thumb_height = $thumbnail_height;

    $width = imagesx($image);
    $height = imagesy($image);

    $original_aspect = $width / $height;
    $thumb_aspect = $thumb_width / $thumb_height;

    if($original_aspect >= $thumb_aspect) {
       // If image is wider than thumbnail (in aspect ratio sense)
       $new_height = $thumb_height;
       $new_width = $width / ($height / $thumb_height);
    } else {
       // If the thumbnail is wider than the image
       $new_width = $thumb_width;
       $new_height = $height / ($width / $thumb_width);
    }

    $thumb = imagecreatetruecolor($thumb_width, $thumb_height);

    // Resize and crop 
    imagecopyresampled($thumb,
                       $image,
                       0 - ($new_width - $thumb_width) / 2, // Center the image horizontally
                       0 - ($new_height - $thumb_height) / 2, // Center the image vertically
                       0, 0,
                       $new_width, $new_height,
                       $width, $height);

    ob_start();
    if ($ext == "jpg" || $ext == "jpeg")
    {
        imagejpeg($thumb, null, $quality);
    }
    else if ($ext == "gif")
    {
        imagegif($thumb);
    }
    else if ($ext == "png")
    {
        imagepng($thumb, null);
    }
    $i = ob_get_clean();
    $fp = fopen($path_to.$filename_to.'.'.$ext, 'w');
    fwrite ($fp, $i);
    fclose ($fp);
    imagedestroy($thumb);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T23:05:37.240

## 给你的建议：

*   采用[`imagecopyresized()`](http://www.php.net/manual/en/function.imagecopyresized.php)
*   [`exec()`](http://php.net/manual/en/function.exec.php)与[`vcrop`](http://manpages.ubuntu.com/manpages/natty/man1/vcrop.1Vi.html)Debian结合使用
*   使用[Imagick::cropImage](http://www.php.net/manual/en/imagick.cropimage.php)或[`exec()`](http://php.net/manual/en/function.exec.php)结合[convert -crop](http://linux.die.net/man/1/convert)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T23:50:05.550

我在这里回答了这个问题：[如何在 codeigniter 中裁剪图像？](https://stackoverflow.com/questions/3325106/how-to-crop-image-in-codeigniter)

基本上，您提供两个轴 (x/y)。但它不会像你想象的那样从 0 到那个轴裁剪区域，它实际上会返回更靠近中心的部分。因此，出于这个原因，可以裁剪出 (x1,y1) 和 (x2,y2) 之间的区域。

# php - 使用 PHP 提取服务器时间并存储在 MySQL 中 - Unix 时间戳好吗？

> ID：12876909
> 
> 赞同：1
> 
> 时间：2012-10-13T20:54:05.127
> 
> 标签：php, mysql, datetime

全部，

我正在尝试决定如何处理依赖（服务器）时间间隔的项目中的时间（简而言之，在用户至少在 n 小时前完成特定操作后，某些内容才可用）。现在，似乎最简单的选择是提取 Unix 时间戳`time()`并将其存储在 MySQL 中。

为什么这不是一个好主意？我需要注意什么问题？性能影响？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T20:58:14.353

Seems fine to me. Though you should probably store it as a **[`DATETIME`](http://dev.mysql.com/doc/refman/5.0/en/datetime.html)** and use **[`DateTime`](http://il1.php.net/manual/en/class.datetime.php)** objects, rather than UNIX timestamps and `time()`.

```
$time = new DateTime;
echo $time->format("Y-m-d H:i:s"); //Outputs current time, example: 2012-10-13 22:58:34 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T21:02:58.230

时间戳很好。不要划分它们，这是不必要的计算。如果您计划更频繁地查询（每个对象）超时而不是更新它，那么您最好存储到期时间而不是当前时间（因此只计算一次增量）。请注意 DATETIME 列：它们不考虑时区设置，而您的 PHP 则...因此，如果您碰巧在不同的请求上有不同的时区设置，那么您就不走运了。时间戳是绝对的，它们也解释了夏令时之类的威胁，其中 3:01 是 1:59 之后的 2 分钟......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T20:59:38.393

Actually, this is the best idea. The function `time()` give you the number of seconds from January 1th, 1970 00:00:00\. There's no performance impact because it's only an `integer`. In MySQL, create a field like that `INT, 10, Unsigned`.

Time will give you performance on the SELECT and the WHERE. See [http://gpshumano.blogs.dri.pt/2009/07/06/mysql-datetime-vs-timestamp-vs-int-performance-and-benchmarking-with-myisam/](http://gpshumano.blogs.dri.pt/2009/07/06/mysql-datetime-vs-timestamp-vs-int-performance-and-benchmarking-with-myisam/)

The only problem you have is : time is limited to year 2038... but by the time 2038 come, the internal computer clock bytes will be larger ... hope so.

The other thing you may want to worrie about the DATETIME is : PHP time() run under UTC, while DATETIME depend on the timezone...

Stats when you do INSERT with 10000000 rows.

![enter image description here](../Images/36f7e6e7d719dd741bf4ef7f208e3179.png)

Stats when you SELECT / WHERE with indexes :

![enter image description here](../Images/fa2385cf123b82d05309b467d17e4f42.png)

# macos - 如何在 OSX 上使用 FireMonkey 获取当前修饰符状态？

> ID：12876911
> 
> 赞同：5
> 
> 时间：2012-10-13T20:54:16.413
> 
> 标签：macos, delphi, delphi-xe2, firemonkey, keyevent

使用**Delphi** for Windows，我通常使用以下代码：

```
function isCtrlDown : Boolean;
var
  ksCurrent : TKeyboardState;
begin
  GetKeyboardState(ksCurrent);
  Result := ((ksCurrent[VK_CONTROL] and 128) <> 0);
end; 
```

**如何在 Mac OSX 上使用 FireMonkey 实现这一点？**

我找到[了这个](http://opensource.apple.com/source/WebCore/WebCore-955.66/platform/mac/KeyEventMac.mm?txt)，但我不知道如何使用 FireMonkey/Delphi（它使用...）来管理它：

```
void PlatformKeyboardEvent::getCurrentModifierState(bool& shiftKey, bool& ctrlKey, bool& altKey, bool& metaKey)
{
    UInt32 currentModifiers = GetCurrentKeyModifiers();
    shiftKey = currentModifiers & ::shiftKey;
    ctrlKey = currentModifiers & ::controlKey;
    altKey = currentModifiers & ::optionKey;
    metaKey = currentModifiers & ::cmdKey;
} 
```

我还在调查……目前，我已经找到了这个单元，里面有**关键事件**的东西…… `unit Macapi.AppKit;`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-14T08:12:38.127

这将返回当前的班次状态：

```
uses
  Macapi.CoreGraphics;

function KeyboardModifiers: TShiftState;
const
  kVK_Shift                     = $38;
  kVK_RightShift                = $3C;
  kVK_Control                   = $3B;
  kVK_Command                   = $37;
  kVK_Option                    = $3A;
begin
  result := [];
  if (CGEventSourceKeyState(0, kVK_Shift) <> 0) or (CGEventSourceKeyState(0, kVK_RightShift) <> 0) then Include(result, ssShift);
  if CGEventSourceKeyState(0, kVK_Command) <> 0 then Include(result, ssCommand);
  if CGEventSourceKeyState(0, kVK_Option) <> 0 then Include(result, ssAlt);
  if CGEventSourceKeyState(0, kVK_Control) <> 0 then Include(result, ssCtrl);
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T07:28:57.803

根据这个[答案](https://stackoverflow.com/questions/5993633/how-to-get-keyboard-state-in-objective-c-without-referring-to-nsevent)，你可以试试这个：

```
function isCtrlDown : Boolean; 
begin
    Result := NSControlKeyMask and TNSEvent.OCClass.modifierFlags = NSControlKeyMask;
end; 
```

# java - Java 1.7 中的 JMenuItem ActionListener 使用自定义 Popup 错过了鼠标单击

> ID：12876917
> 
> 赞同：1
> 
> 时间：2012-10-13T20:55:09.547
> 
> 标签：java, swing, popup, jmenuitem

我不确定问题出在我的代码还是 Java 1.7 上。

在下面的代码中（主要基于 Java Popup Demo），弹出窗口将在鼠标右键单击时出现。鼠标悬停时弹出菜单项将突出显示，单击 JmenuItem 使弹出菜单消失；但是，单击时不会触发 JMenuItem 的 actionEvent（应在 JTextArea 中报告）。

其他掘金：如果我键入 JMenuItem 的助记符（此处为“a”），则触发 actionEvent（该事件在 JTextArea 中报告）。

如果我没有附加自定义 Popup(Factory)，则鼠标单击会按预期触发 actionEvent。

我正在使用 OSX 10.7.5

此问题发生在：

```
    java版本“1.7.0_07”
    Java(TM) SE 运行时环境 (build 1.7.0_07-b10)
    Java HotSpot(TM) 64 位服务器 VM（内部版本 23.3-b01，混合模式）

```

此代码在以下情况下表现良好：

```
    java版本“1.6.0_33”
    Java(TM) SE 运行时环境 (build 1.6.0_33-b03-424-11M3720)
    Java HotSpot(TM) 64 位服务器 VM（内部版本 20.8-b03-424，混合模式）

```

非常感谢任何帮助/想法！独立的代码示例如下。

谢谢

安德鲁

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*; 

public class PopupMenuDemo implements ActionListener  {
    JTextArea output;
    JScrollPane scrollPane;
    String newline = "\n";

    public Container createContentPane() {
        JPanel contentPane = new JPanel(new BorderLayout());
        contentPane.setOpaque(true);
        output = new JTextArea(5, 30);
        output.setEditable(false);
        scrollPane = new JScrollPane(output);
        contentPane.add(scrollPane, BorderLayout.CENTER); 
        return contentPane;
    }

    public void createPopupMenu() {
        JMenuItem menuItem;
        JPopupMenu popup = new JPopupMenu();
        menuItem = new JMenuItem("A popup menu item", 'a');
        menuItem.addActionListener(this);
        popup.add(menuItem);
        MouseListener popupListener = new PopupListener(popup);
        output.addMouseListener(popupListener);
    }

    public void actionPerformed(ActionEvent e) {
        JMenuItem source = (JMenuItem)(e.getSource());
        String s = "Action event detected."
        + newline
        + "    Event source: " + source.getText()
        + " (an instance of " + source.getClass().getName() + ")";
        output.append(s + newline);
        output.setCaretPosition(output.getDocument().getLength());
    }

    private void createAndShowGUI() {
        JFrame frame = new JFrame("PopupMenuDemo");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    PopupFactory.setSharedInstance(new MyPopupFactory());
        PopupMenuDemo demo = new PopupMenuDemo();
        frame.setContentPane(demo.createContentPane());

        demo.createPopupMenu();

        frame.setSize(450, 260);
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            new PopupMenuDemo().createAndShowGUI();
        }
        });
    }

    class PopupListener extends MouseAdapter {
        JPopupMenu popup;

        PopupListener(JPopupMenu popupMenu) {
            popup = popupMenu;
        }

        public void mousePressed(MouseEvent e) {
            maybeShowPopup(e);
        }

        public void mouseReleased(MouseEvent e) {
            maybeShowPopup(e);
        }

        private void maybeShowPopup(MouseEvent e) {
            if (e.isPopupTrigger()) {
                popup.show(e.getComponent(), e.getX(), e.getY());
            }
        }
    }

    class MyPopupFactory extends PopupFactory {
    public Popup getPopup(Component owner, Component contents, int x, int y) throws IllegalArgumentException {
        return new MyPopup(owner, contents, x, y);
    }
    }

    class MyPopup extends Popup {
    private JWindow popupWindow;

    MyPopup(Component owner, Component contents, int ownerX, int ownerY) {
        popupWindow = new JWindow();
        popupWindow.setLocation(ownerX, ownerY);
        popupWindow.getContentPane().add(contents, BorderLayout.CENTER);
        contents.invalidate();
    }

    public void show() {
        popupWindow.setVisible(true);
        popupWindow.pack();
    }

    public void hide() {
        popupWindow.setVisible(false);
        popupWindow.removeAll();
        popupWindow.dispose();
    }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2021-06-08T09:13:30.970

问题在于构造函数的使用`new JWindow()`，这使得新窗口与所有者组件无关。因此，单击弹出窗口的处理方式与单击 UI 中任何不相关部分的处理方式相同，从而取消弹出窗口。

您必须使用类似`new JWindow(SwingUtilities.getWindowAncestor(owner))`的方法使弹出窗口成为所有者窗口的子窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T02:51:07.977

首先，我会放弃使用 a`MouseListener`来监控弹出触发器，你最好使用它`JComponent#setComponentPopupMenu`并省去你自己的麻烦。

其次，我不知道您为什么要提供自己的弹出工厂，但这会给您带来问题。如果您注释掉该`popupWindow.dispose`行，它将起作用。至于为什么，我不能告诉你，可能 IDE 正在运行，所以我无法调试代码：P

# python - try-except-raise 子句，良好的行为？

> ID：12876919
> 
> 赞同：0
> 
> 时间：2012-10-13T20:55:43.863
> 
> 标签：python, exception, raise, traceback

我注意到我在过去写了很多类似下面的 try-except 子句。这样做的主要原因是编写更少的代码。

```
class Synchronizer(object):
    # ...

    def _assert_dir(self, dirname, argname, argnum):
        """ *Private*. Raises OSError if the passed string does not point
            to an existing directory on the file-system. """

        if not os.path.isdir(dirname):
            message = 'passed `%s` argument (%d) does not point to a ' \
                      'directory on the file-system.'
            raise OSError(message % (argname, argnum))

    def synchronize(self, source_dir, dest_dir, database):

        # Ensure the passed directories do exist.
        try:
            self._assert_dir(source_dir, 'source_dir', 2)
            self._assert_dir(dest_dir, 'dest_dir', 3)
        except OSError:
            raise

        # ... 
```

我是这样做的，否则我需要写

```
class Synchronizer(object):
    # ...

    def synchronize(self, source_dir, dest_dir, database):

        # Ensure the passed directories do exist.
        if not os.path.isdir(source_dir):
            message = 'passed `source_dir` argument (2) does not point to a ' \
                      'directory on the file-system.'
            raise OSError(message)

        if not os.path.isdir(dest_dir):
            message = 'passed `dest_dir` argument (3) does not point to a ' \
                      'directory on the file-system.'
            raise OSError(message)

        # ... 
```

我实际上喜欢编写方法进行检查和提升操作的想法，但我看到了一个很大的缺点：*可读性*。特别是对于进行代码折叠的编辑器，该`try`语句并不能很好地告诉读者其中发生了什么，而是`if not os.path.isdir(source_dir)`一个很好的提示。

恕我直言，try-except 子句是必需的，因为它会混淆异常来自的异常*捕获器（回溯的读取器）。*

你觉得这个设计怎么样？它对你来说是可怕的、伟大的还是令人困惑的？或者您对如何改善这种情况有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T21:16:31.073

在使用 try 处理异常情况之前，我会问自己两个问题，如果两者的答案都是肯定的，那么我才会尝试处理异常。

Q1。这真的是一个例外情况吗？如果条件在 90% 的时间内发生，我不想执行 try 块。在这种情况下最好使用 if - else。

Q2。我可以从错误中恢复吗？如果我无法从异常中恢复，则处理异常毫无意义。最好将它传播到更高级别，这会自动发生，而无需我编写额外的代码。

如果目录不存在，您发布的代码不会做任何恢复，而且您似乎无法做很多事情。为什么不让错误传播到更高的层次呢？为什么你甚至需要一个 try 块呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T21:10:13.860

这取决于你的要求..

*   如果你想捕捉一些异常，并继续你的方法中的代码，那么你应该使用第二种情况。让你在你的方法中尝试除块。

    ```
    def function():
       try:
          raise IOError
       except IOError e:
          // Handle
       //continue with reset of the function
       print "This will get printed"

    function() 
    ```

*   但是，如果您想在一个地方处理所有异常，针对特定类型使用特定操作，或者您只想暂停您的函数，如果引发一个异常，您可以更好地在函数之外处理它们：-

    ```
    def function():
       raise IOError

       // subsequent code Will not execute
       print "This will not get printed"

    try:
       function()
    except IOError e:
       // Handle IOError
    except EOFError e1:
       // Handle EOF Error 
    ```

*   通过使用第二种方式，您实际上增加了一些代码不被执行的机会。一般来说，你的 try-except 块应该是`small`. 他们应该分开处理不同点的异常，而不是所有的异常都应该在一个地方处理。

*   就我而言，我通常喜欢尽可能减少我的 try-except 块。这样我就知道我的异常到底是在哪里引发的。

# php - SQL 查询只检索一行

> ID：12876921
> 
> 赞同：3
> 
> 时间：2012-10-13T20:55:54.693
> 
> 标签：php, sql, database, web

我有一个 php 网站，上面有一些代码，可以在用户定义一些搜索词后从数据库中提取，然后向他们展示一个包含所有信息的表格

问题是即使我从表中选择 *，我也只能取回第一行。

代码：

```
$result = mysql_query("SELECT trees.*     
FROM trees 
INNER JOIN price 
ON trees.ID=price.treeid  
");

$num_rows = mysql_num_rows($result);
if($num_rows == 0) {
echo "No rows retrieved";
} else {
echo $num_rows;
} 
```

我的数据库中有 2 行：

```
Spruce  El Sorbeous Sprucious   Green   Green   Green   100     200
its a tree ma!  true    NULL    NULL    NULL

Mayday  el daymay   red green   white   10  4000000
GOING DOWN  true    Grey    true    false 
```

当我在那里打印出 $num_rows 时，它只有一个。当我打印出下面的表格时，只有一行：

```
echo '<table border = 0 cellpadding=0 >';
echo '<tr>';
echo '<td><b><u>Name</b></u></td>
<td><b><u>Latin Name</b></u></td>
<td><b><u>Primary Color</b></u></td>
<td><b><u>Secondary Color</b></u></td>
<td><b><u>Fall Color</b></u></td>
<td><b><u>Trunk Color</b></u></td>';

echo '<td><b><u>Description</b></u></td>
<td><b><u>Height</b></u></td>
<td><b><u>Spread</b></u></td>
<td><b><u>Drought Resistant?</b></u></td>
<td><b><u>Flowering?</b></u></td>
<td><b><u>Fruit Producing?</b></u></td>';

echo '</tr>';

while ($row = mysql_fetch_assoc($result)) {
     echo '<tr>';
     echo '<td>';
     echo $row['name'];
     echo '</td>';
     echo '<td>';
     echo $row['latinname'];
     echo '</td>';
     echo '<td>';
     echo $row['primarycolor'];
     echo '</td>';
     echo '<td>';
     echo $row['secondarycolor'];
     echo '</td>';
     echo '<td>';
     echo $row['fallcolor'];
     echo '</td>';
     echo '<td>';
     echo $row['trunkcolor'];
     echo '</td>';
     echo '<td>';
     echo $row['description'];
     echo '</td>';
     echo '<td>';
     echo $row['height'];
     echo '</td>';
     echo '<td>';
     echo $row['spread'];
     echo '</td>';
     echo '<td>';
     echo $row['droughtresistant'];
     echo '</td>';
     echo '<td>';
     echo $row['flowering'];
     echo '</td>';
     echo '<td>';
     echo $row['fruitproducing'];
     echo '</td>';

     echo '</tr>';

}
echo '<table>'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T20:57:51.500

INNER JOIN 将仅返回两个表中具有 NOT NULL 值的值。您可能正在加入具有 NULL 值的东西。请改用 LEFT 或 RIGHT 连接！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T21:01:05.890

由于 PRICE 表中没有数据示例，我猜测只有一行被连接。

The question remains, why are you doing that JOIN? You're not collecting any data from the PRICE table, so what's the point.
BTW, where in the data is the ID?

# rabbitmq - OS X Leopard 上的 RabbitMQ 启动错误

> ID：12876925
> 
> 赞同：0
> 
> 时间：2012-10-13T20:57:10.543
> 
> 标签：rabbitmq

谁能帮助诊断为什么 RabbitMQ 无法启动？它过去运行良好，但突然拒绝启动。我正在运行命令`sudo rabbitmqctl start`，我得到以下输出：

```
Error: {'EXIT',
       {function_clause,
           [{rabbit_control,action,
                [start,rabbit@BELLOMACPRO,[],
                 [{"-p","/"},{"-n","rabbit@BELLOMACPRO"},{"-q",false}],
                 #Fun<rabbit_control.1.100323439>],
                [{file,"src/rabbit_control.erl"},{line,168}]},
            {rabbit_control,start,0,
                [{file,"src/rabbit_control.erl"},{line,84}]},
            {init,start_it,1,[]},
            {init,start_em,1,[]}]}} 
```

我没有发现这特别有用，但对于更了解 Erlang 的人来说，也许有一些显而易见的东西。日志文件没有最近的条目来说明问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:25:31.140

我从来没有弄清楚问题的原因是什么，但我通过直接使用执行服务器`sudo rabbitmq-server`而不是尝试使用`rabbitmqctl`. 仍然欢迎解释。

# c - 以升序功能插入记录 - C 家庭作业

> ID：12876927
> 
> 赞同：1
> 
> 时间：2012-10-13T20:57:29.700
> 
> 标签：c, list, sorting

美好的一天，堆栈溢出。

我有一个家庭作业，我在这个周末工作，但我遇到了一些问题。我们有一个结构“记录”（其中包含有关经销商汽车的信息），它根据 1）其品牌和 2）根据其车型年份放置在链接列表中的特定位置。

这是在最初构建列表时完成的，当在 Main 中调用“int insertRecordInAscendingOrder”函数时。在“insertRecordInAscendingOrder”中，调用了第三个函数“createRecord”，其中创建了链表。然后该函数转到函数“compareCars”以确定将哪些元素放在哪里。根据此函数返回的值，insertRecordInAscendingOrder 然后将记录放在它所属的位置。然后打印出该列表。还有更多的任务，但当我完成它时，我会越过那座桥。

理想情况下，为了使分配被认为是正确的，链表必须按以下顺序排列：

```
 Chevrolet 2012 25
    Chevrolet 2013 10
    Ford 2010 5
    Ford 2011 3
    Ford 2012 15
    Honda 2011 9
    Honda 2012 3
    Honda 2013 12
    Toyota 2009 2
    Toyota 2011 7
    Toyota 2013 20 
```

从具有以下数据排序的文本文件中：

```
 Ford 2012 15
    Ford 2011 3
    Ford 2010 5
    Toyota 2011 7
    Toyota 2012 20
    Toyota 2009 2
    Honda 2011 9
    Honda 2012 3
    Honda 2013 12
    Chevrolet 2013 10
    Chevrolet 2012 25 
```

请注意，“make”字段的字母顺序优先，然后，型号年份从最旧到最新排列。

但是，该程序将其作为最终列表生成：

```
 Chevrolet 2012 25
    Chevrolet 2013 10
    Honda 2011 9
    Honda 2012 3
    Honda 2013 12
    Toyota 2009 2
    Toyota 2011 7
    Toyota 2012 20
    Ford 2010 5
    Ford 2011 3
    Ford 2012 15 
```

昨天我和一名研究生坐下来，试图解决所有这些问题，但我们只是不明白为什么它将福特节点踢到了列表的末尾。

这是代码。您会注意到，我在插入节点的每个实例中都包含了一个 printList 调用。通过这种方式，您可以看到节点按“顺序”排列时发生的情况。它在 ANSI C99 中。所有函数调用都*必须*按照指定进行，所以不幸的是，没有真正的方法可以通过创建更有效的算法来解决这个问题。

```
 #include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX_LINE 50
#define MAX_MAKE 20

typedef struct record
{
    char *make;
    int year;
    int stock;
    struct record *next;
} Record;

int compareCars(Record *car1, Record *car2);
void printList(Record *head);
Record* createRecord(char *make, int year, int stock);
int insertRecordInAscendingOrder(Record **head, char *make, int year, int stock);

int main(int argc, char **argv)
{
    FILE *inFile = NULL;
    char line[MAX_LINE + 1];
    char *make, *yearStr, *stockStr;
    int year, stock, len;
    Record* headRecord = NULL;

    /*Input and file diagnostics*/
    if (argc!=2)
    {
        printf ("Filename not provided.\n");
        return 1;
    }

    if((inFile=fopen(argv[1], "r"))==NULL)
    {
        printf("Can't open the file\n");
        return 2;
    }

    /*obtain values for linked list*/
    while (fgets(line, MAX_LINE, inFile))
    {
        make = strtok(line, " ");
        yearStr = strtok(NULL, " ");
        stockStr = strtok(NULL, " ");
        year = atoi(yearStr);
        stock = atoi(stockStr);
        insertRecordInAscendingOrder(&headRecord,make, year, stock);

    }

    printf("The original list in ascending order: \n");
    printList(headRecord);
}

/*use strcmp to compare two makes*/

int compareCars(Record *car1, Record *car2)
{
    int compStrResult;
    compStrResult = strcmp(car1->make, car2->make);
    int compYearResult = 0;

    if(car1->year > car2->year)
    {
        compYearResult = 1;
    }
    else if(car1->year == car2->year)
    {
        compYearResult = 0;
    }
    else
    {
        compYearResult = -1;
    }

    if(compStrResult == 0 )
    {
        if(compYearResult == 1)
        {
            return 1;
        }
        else if(compYearResult == -1)
        {
            return -1;
        }
        else
        {
            return compStrResult;
        }
    }
    else if(compStrResult == 1)
    {
        return 1;
    }
    else
    {
        return -1;
    }
}

int insertRecordInAscendingOrder(Record **head, char *make, int year, int stock)
{
    Record *previous = *head;
    Record *newRecord = createRecord(make, year, stock);
    Record *current = *head;
    int compResult;

    if(*head == NULL)
    {
        *head = newRecord;
        printf("Head is null, list was empty\n");
        printList(*head);
        return 1;
    }
    else if ( compareCars(newRecord, *head)==-1) 
    {
        *head = newRecord;
        (*head)->next = current;
        printf("New record was less than the head, replacing\n");
        printList(*head);
        return 1;
    }
    else
    {
        printf("standard case, searching and inserting\n");
        previous = *head;

        while ( current != NULL &&(compareCars(newRecord, current)==1)) 
        {
            printList(*head);
            previous = current; 
            current = current->next; 
        }

        printList(*head);
        previous->next = newRecord;
        previous->next->next = current;
    }
    return 1;
}

/*creates records from info passed in from main via insertRecordInAscendingOrder.*/
Record* createRecord(char *make, int year, int stock)
{
    printf("CreateRecord\n");
    Record *theRecord;
    int len;

    if(!make)
    {
        return NULL;
    }

    theRecord = malloc(sizeof(Record));

    if(!theRecord)
    {
        printf("Unable to allocate memory for the structure.\n");
        return NULL;
    }

    theRecord->year = year;
    theRecord->stock = stock;

    len = strlen(make);
    theRecord->make = malloc(len + 1);
    strncpy(theRecord->make, make, len);
    theRecord->make[len] = '\0';
    theRecord->next=NULL;

    return theRecord;
}

/*prints list. lists print.*/
void printList(Record *head)
{
    int i;
    int j = 50;
    Record *aRecord;
    aRecord = head;

    for(i = 0; i < j; i++)
    {
        printf("-");
    }
    printf("\n");
    printf("%20s%20s%10s\n", "Make", "Year", "Stock");

    for(i = 0; i < j; i++)
    {
        printf("-");
    }
    printf("\n");

    while(aRecord != NULL)
    {       
        printf("%20s%20d%10d\n", aRecord->make, aRecord->year,
        aRecord->stock);        
        aRecord = aRecord->next;
    }
    printf("\n");
} 
```

命令行参数所需的文本文件可以以您喜欢的任何名称保存；以下是您需要的内容：

```
 Ford 2012 15
    Ford 2011 3
    Ford 2010 5
    Toyota 2011 7
    Toyota 2012 20
    Toyota 2009 2
    Honda 2011 9
    Honda 2012 3
    Honda 2013 12
    Chevrolet 2013 10
    Chevrolet 2012 25 
```

在此先感谢您的帮助。我将继续自己耕耘。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T21:18:12.070

问题是

```
else if(compStrResult == 1) 
```

你检查一个特定的返回值`strcmp`. 规范只说在各自的情况下结果是正数、负数或零，并且通常是第一个不同字符之间的差异。你应该检查

```
if (compStrResult > 0) 
```

那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T21:27:12.243

编写一个非常简单的测试套件会告诉您错误在 compareCars 中。

由于年份的比较相当直接，请查看 strcmp 的文档：它不返回 0、1 或 -1，而是返回 0 或正整数或负整数。

```
int compareCars(Record *car1, Record *car2)
{
    int makecmp = strcmp(car1->make, car2->make);

    if( makecmp > 0 )
      return 1;

    if( makecmp == 0 )
    {
        if (car1->year > car2->year)
          return 1;
        if( car1->year == car2->year )
          return 0;
    }

    return -1;
} 
```

该功能的示例测试套件：

```
#include <assert.h>

void main()
{
  Record c1 = {"Toyota", 1991};
  Record c2 = {"Toyota", 1992};
  Record c3 = {"Ford", 1991};
  Record c4 = {"Ford", 1992};

  assert( compareCars( &c1, &c2 ) == -1 );
  assert( compareCars( &c1, &c1 ) == 0 );
  assert( compareCars( &c2, &c1 ) == 1 );
  assert( compareCars( &c2, &c3 ) == 1 );
  assert( compareCars( &c3, &c2 ) == -1 );
  assert( compareCars( &c3, &c4 ) == -1 );
  assert( compareCars( &c4, &c3 ) == 1 );
  assert( compareCars( &c4, &c1 ) == -1 );
} 
```

然后，请注意：在 createRecord 中我建议使用 of`strdup`代替 malloc/strncpy 和朋友。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-13T21:33:45.790

无论如何：修复后的代码；致力于编码风格

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX_LINE 50
#define MAX_MAKE 20

typedef struct record
{
    char *make;
    int year;
    int stock;
    struct record *next;
} Record;

int compareCars(Record *car1, Record *car2);
void printList(Record *head);
Record* createRecord(char *make, int year, int stock);
int insertRecordInAscendingOrder(Record **head, char *make, int year, int stock);

int main(int argc, char **argv)
{
    FILE *inFile = NULL;
    char line[MAX_LINE + 1];
    char *make, *yearStr, *stockStr;
    int year, stock, len;
    Record* headRecord = NULL;

    /*Input and file diagnostics*/
    if (argc!=2)
    {
        printf ("Filename not provided.\n");
        return 1;
    }

    if((inFile=fopen(argv[1], "r"))==NULL)
    {
        printf("Can't open the file\n");
        return 2;
    }

    /*obtain values for linked list*/
    while (fgets(line, MAX_LINE, inFile))
    {
        make = strtok(line, " ");
        yearStr = strtok(NULL, " ");
        stockStr = strtok(NULL, " ");
        year = atoi(yearStr);
        stock = atoi(stockStr);

       // fprintf (stderr, "Record read Make[%s] Year[%d] Stock[%d]", make, year, stock);
        insertRecordInAscendingOrder(&headRecord,make, year, stock);

    }

    printf("The original list in ascending order: \n");
    printList(headRecord);

    scanf ("%d", &len);

    return 0;
}

/*use strcmp to compare two makes*/

int compareCars(Record *car1, Record *car2)
{
    int compStrResult;
    compStrResult = strcmp(car1->make, car2->make);
    int compYearResult = 0;

    if(car1->year > car2->year)
    {
        compYearResult = 1;
    }
    else if(car1->year == car2->year)
    {
        compYearResult = 0;
    }
    else
    {
        compYearResult = -1;
    }

    if(compStrResult == 0 )
    {
        if(compYearResult == 1)
        {
            return 1;
        }
        else if(compYearResult == -1)
        {
            return -1;
        }
        else
        {
            return compStrResult;
        }
    }
    else if(compStrResult > 0)
    {
        return 1;
    }
    else
    {
        return -1;
    }
}

int insertRecordInAscendingOrder(Record **head, char *make, int year, int stock)
{
    Record *previous = *head;
    Record *newRecord = createRecord(make, year, stock);
    Record *current = *head;
    //int compResult;

    if(*head == NULL)
    {
        *head = newRecord;
        printf("Head is null, list was empty\n");
        //printList(*head);
        return 1;
    }
    else if ( compareCars(newRecord, *head)==-1)
    {
        *head = newRecord;
        (*head)->next = current;
        printf("New record was less than the head, replacing\n");
        //printList(*head);
        return 1;
    }
    else
    {
        printf("standard case, searching and inserting\n");
        previous = *head;

        while ( current != NULL &&(compareCars(newRecord, current)==1))
        {
            //printList(*head);
            previous = current;
            current = current->next;
        }

        //printList(*head);
        previous->next = newRecord;
        previous->next->next = current;
    }
    return 1;
}

/*creates records from info passed in from main via insertRecordInAscendingOrder.*/
Record* createRecord(char *make, int year, int stock)
{
    printf("CreateRecord\n");
    Record *theRecord;
    int len;

    if(!make)
    {
        return NULL;
    }

    theRecord = malloc(sizeof(Record));

    if(!theRecord)
    {
        printf("Unable to allocate memory for the structure.\n");
        return NULL;
    }

    theRecord->year = year;
    theRecord->stock = stock;

    len = strlen(make);
    theRecord->make = malloc(len + 1);
    strncpy(theRecord->make, make, len);
    theRecord->make[len] = '\0';
    theRecord->next=NULL;

    return theRecord;
}

/*prints list. lists print.*/
void printList(Record *head)
{
    int i;
    int j = 50;
    Record *aRecord;
    aRecord = head;

    for(i = 0; i < j; i++)
    {
        printf("-");
    }
    printf("\n");
    printf("%20s%20s%10s\n", "Make", "Year", "Stock");

    for(i = 0; i < j; i++)
    {
        printf("-");
    }
    printf("\n");

    while(aRecord != NULL)
    {
        printf("%20s%20d%10d\n", aRecord->make, aRecord->year,
        aRecord->stock);
        aRecord = aRecord->next;
    }
    printf("\n");
} 
```

# python - Python Qt QListWidget Double Clicked

> ID：12876935
> 
> 赞同：6
> 
> 时间：2012-10-13T20:58:17.943
> 
> 标签：python, pyqt, pyqt4, signals-slots, qlistwidget

I want to add double clicked attribute for my QListWidget objects.

My command line does not work:

```
 self.connect(self.listWidget, QtCore.SIGNAL("itemDoubleClicked(QtGui.QListWidgetItem)"), self.showItem) 
```

How to add double clicked attribute ? How to give object parameter to QtCore.SIGNAL.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-13T21:32:16.450

信号连接不起作用的原因是您为[QListWidget.itemDoubleClicked](http://www.riverbankcomputing.com/static/Docs/PyQt4/html/qlistwidget.html#itemDoubleClicked)使用了错误的签名。它应该看起来像这样：

```
self.connect(self.listWidget,
             QtCore.SIGNAL("itemDoubleClicked(QListWidgetItem *)"),
             self.showItem) 
```

但是，我建议您避免使用这种完全连接信号的方法，而改用[新式语法](http://www.riverbankcomputing.com/static/Docs/PyQt4/html/new_style_signals_slots.html)。这将允许您像这样重写上面的代码：

```
self.listWidget.itemDoubleClicked.connect(self.showItem) 
```

这不仅更简单、更干净，而且更不容易出错（事实上，如果使用了错误的信号名称/签名，则会引发异常）。

# codeigniter - Dreamweaver and CodeIgniter Design View not working when editing a View page

> ID：12876937
> 
> 赞同：1
> 
> 时间：2012-10-13T20:58:23.260
> 
> 标签：codeigniter, url-rewriting, dreamweaver, design-view

when opening a CodeIgniter View file in Dreamweaver Design View (application/views/register.php), the Design View loads only the content in the file (without css), because it tries to open localhost/mysite/application/views/register.php instead of localhost/mysite/register where is the register page with header.php and footer.php loaded before and after register.php (I'm loading these Views from another View called template.php).

So, the question is: **How to tell Dreamweaver which is the correct url that is must open? Is there something like url rewriting in Dreamweaver?**

Thanks!

# php - Apache mod_rewrite REST URL

> ID：12876942
> 
> 赞同：1
> 
> 时间：2012-10-13T20:59:25.180
> 
> 标签：php, apache, url, rest, mod-rewrite

Please help me with this one, which should be easy but I've never managed to properly learn Apache mod_rewrite's syntax...

I have a REST webservice implemented in PHP and I need to rewrite the following URL:

```
[1] http://www.myserver.com/service/ca;x={valx},y={valy},z={valz} 
```

into

```
[2] http://www.myserver.com/service/ca.php?x={valx}&y={valy}&z={valz} 
```

How to accomplish this?

I'm using Apache2 on Ubuntu, this is the configuration:

```
Alias "/service" "/opt/htdocs/service"
<Directory "/opt/htdocs/service">
  AllowOverride All
  Options -Indexes FollowSymLinks
</Directory> 
```

and the content of my `/opt/htdocs/service` directory:

```
$>ls -1 /opt/htdocs/service

  ca.php 
```

Mod_rewrite is enabled:

```
$>a2enmod rewrite

  Module rewrite already enabled 
```

Thanks in advance!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T06:38:12.300

尝试将其放入您的服务器/虚拟主机配置或文档根目录中的 htaccess 文件中：

```
RewriteEngine On

RewriteRule ^/?service/ca;(.*)$ /service/ca.php?$1 [L]

RewriteCond %{QUERY_STRING} ^(.*),(.*)$
RewriteRule ^/?serivce/ca\.php$ /service/ca.php?%1&%2 [L] 
```

# linux - Azure local disk - where'd it go? (Linux VM)

> ID：12876947
> 
> 赞同：5
> 
> 时间：2012-10-13T21:00:16.123
> 
> 标签：linux, azure, virtual-machine

The Azure VM table...

[https://www.windowsazure.com/en-us/pricing/details/#header-2](https://www.windowsazure.com/en-us/pricing/details/#header-2)

...says that, for example, a Medium Instance comes with 490GB of local storage. So I was expecting the usual 30GB Azure BLOB OS disk, and then a 490GB /mnt/resource.

But no:

```
$ df -h
Filesystem            Size  Used Avail Use% Mounted on
/dev/mapper/VolGroup-lv_root
                       28G  1.7G   25G   7% /
tmpfs                 1.7G     0  1.7G   0% /dev/shm
/dev/sda1             485M   68M  392M  15% /boot
/dev/sdb1             133G  188M  126G   1% /mnt/resource 
```

That's on the CentOS image, but it's the same for other images.

Am i missing something? I don't see the space in a volume group or anything, and there are no sd* devices that aren't mounted.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-02T02:23:40.630

Neil Mackenzie 在评论中的回答似乎是正确的

> 所有 Windows Azure IaaS VM 都带有两个磁盘 - 一个由保存在 Windows Azure Blob 存储中的 VHD 支持的 OS 磁盘和一个物理连接到托管服务器的临时磁盘。这个临时磁盘是真正的临时磁盘，如果 VM 被解除分配（在门户或 API 上关闭）或移动以进行服务器修复，则其上的任何内容都将丢失。对于 Linux VM，此临时磁盘 /dev/sdb。

我发现这个链接来证实：http: [//blogs.msdn.com/b/wats/archive/2013/12/07/understanding-the-temporary-drive-on-windows-azure-virtual-machines.aspx](http://blogs.msdn.com/b/wats/archive/2013/12/07/understanding-the-temporary-drive-on-windows-azure-virtual-machines.aspx)

# ruby - 通过参数将列表传递给postgresql

> ID：12876949
> 
> 赞同：2
> 
> 时间：2012-10-13T21:00:19.867
> 
> 标签：ruby, postgresql, sh

我正在使用 Ruby 通过 shell 通过如下命令调用 postgresql：

```
%x[ psql -A -F "," -o feeds/tmp.csv -f lib/sql/query.sql -v id_list="#{id_list}" ] 
```

query.sql 看起来像但可以更改：

```
Select *
From tbl_test
Where id in (:id_list) 
```

查询应解析为：

```
Select *
From tbl_test
Where id in ('a','b','c') 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T23:47:48.683

```
# before
-v id_list="#{id_list}"

# after
# `join` will separate the values in an array with the string provided
# `map...` the block given to map will surround each item with single quotes
-v id_list="#{id_list.map { |i| "'#{i}'" }.join(', ') }"

# When `id` is an INTEGER you want the `IN` list specified without quotes
# SELECT * FROM tbl_test WHERE id IN (1, 2, 3);
-v id_list="#{id_list.map(&:to_i).join(', ') }" 
```

# jquery - jqGrid 结果溢出网格和“请选择行”消息

> ID：12876950
> 
> 赞同：0
> 
> 时间：2012-10-13T21:00:25.477
> 
> 标签：jquery, css, asp.net-mvc, jquery-ui, jqgrid

（我对网络编程比较陌生，所以它可能是一个容易被忽视的问题）

我正在使用 ASP.NET MVC4 构建一个应用程序，其中包含一个显示 jqGrid 的剃刀视图。它使用 ajax 动态获取列元数据，并且数据似乎都返回正常。当我运行应用程序并显示视图时，会显示数据，但网格的标题和正文都会溢出网格（见图）。

![渲染网格](../Images/ce2bbc8f989d6b9fc8bcec87b6c239cb.png)

我确实注意到数据下方似乎有一条警告，说明“请选择行”。我怀疑问题是 CSS 或与警告有关。我曾尝试更改 ui.jqgrid.css、site.css 等中的各种属性，但无济于事。

这是呈现的html：

```
 <!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Feed List Preview</title>
    <link href="/Content/themes/base/jquery.ui.core.css" rel="stylesheet" type="text/css" />
<link href="/Content/themes/base/jquery.ui.resizable.css" rel="stylesheet" type="text/css" />
<link href="/Content/themes/base/jquery.ui.selectable.css" rel="stylesheet" type="text/css" />
<link href="/Content/themes/base/jquery.ui.accordion.css" rel="stylesheet" type="text/css" />
<link href="/Content/themes/base/jquery.ui.autocomplete.css" rel="stylesheet" type="text/css" />
<link href="/Content/themes/base/jquery.ui.button.css" rel="stylesheet" type="text/css" />
<link href="/Content/themes/base/jquery.ui.dialog.css" rel="stylesheet" type="text/css" />
<link href="/Content/themes/base/jquery.ui.slider.css" rel="stylesheet" type="text/css" />
<link href="/Content/themes/base/jquery.ui.tabs.css" rel="stylesheet" type="text/css" />
<link href="/Content/themes/base/jquery.ui.datepicker.css" rel="stylesheet" type="text/css" />
<link href="/Content/themes/base/jquery.ui.progressbar.css" rel="stylesheet" type="text/css" />
<link href="/Content/themes/base/jquery.ui.theme.css" rel="stylesheet" type="text/css" />
<link href="/Content/site.css" rel="stylesheet" type="text/css" />

    <script src="/Scripts/modernizr-2.0.6-development-only.js" type="text/javascript"></script>

    <script src="/Scripts/jquery-1.8.2.js" type="text/javascript"></script>

    <script src="/Content/themes/redmond/jquery-ui-1.9.0.custom.min.css" type="text/javascript"></script>
<script src="/Content/jquery.jqGrid/ui.jqgrid.css" type="text/javascript"></script>
<script src="/Scripts/i18n/grid.locale-en.js" type="text/javascript"></script>
<script src="/Scripts/jquery.jqGrid.src.js" type="text/javascript"></script>

    <script type="text/javascript">
        var jqDataUrl = "LoadData";
        var jqMetaUrl = "GetColumnData";

        $(document).ready(function () {
            $.ajax(
                {
                    type: "POST",
                    url: jqMetaUrl,
                    data: "",
                    dataType: "json",
                    success: function (result) {
                        col_names = result.colNames;
                        col_model = result.colModel;

                        $("#jqTable").jqGrid({
                            url: jqDataUrl,
                            datatype: "json",
                            mtype: "POST",

                            //Specify the column names
                            colNames: col_names,

                            //Configure the columns
                            colModel: col_model,

                            //Grid total width and height
                            width: 800,
                            shrinkToFit:false,
                            height: 400,

                            //Paging
                            toppager: true,
                            pager: $('#jqTablePager'),
                            rowNum: 25,
                            rowList: [25, 50, 100],
                            viewrecords: true, //Specify if total number of records is displayed

                            //Formatting
                            altRows: true

                            //Default Sorting (ignored)

                            //Grid Caption
                            //caption: "Feed List Preview"
                        }).navGrid("#jqTablePager",
                        { refresh: true, add: false, edit: false, del: false },
                        {}, //settings for edit
                        {}, //settings for add
                        {}, //settings for delete
                        { sopt: ["cn"] } //search options, Some options can be set on column level
                    )
                    },
                    error: function (x, e) {
                        alert("ReadyState: " + x.readyState + "; Status:" + x.status + "; Message:" + e.msg + ";");
                    }
                });
        });

    </script>

</head>
<body>
    <div id="header">
        <h1>
            Header
        </h1>
    </div>

<h2>Feed List Preview</h2>

<div>
    <table id="jqTable" class="scroll"></table>
    <div id="jqTablePager" />
</div>

    <script src="/Scripts/jquery.unobtrusive-ajax.js" type="text/javascript"></script>
<script src="/Scripts/jquery.validate.js" type="text/javascript"></script>
<script src="/Scripts/jquery.validate.unobtrusive.js" type="text/javascript"></script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T03:11:30.747

好的，在同事的帮助下，我们确定了 ui.jqgrid.css 和 jquery-ui*.css（主题）在页面渲染时没有加载。这可以在 IE 的开发人员工具中看到。

此问题的原因似乎是 Razor 视图未正确处理 java 脚本。将内容和脚本移动到纯 HTML 页面后，一切都正确呈现。

所以仍然有一个关于为什么 javascript 没有被渲染的问题，但我现在有一个足够的解决方法。

# html - 如何使这些图像居中在页面上？

> ID：12876954
> 
> 赞同：1
> 
> 时间：2012-10-13T21:00:57.607
> 
> 标签：html, css, image, centering

我正在制作一个正在建设的页面，其中包含一张背景图片和两张我在 Photoshop 中制作的图片。他们说的是“我们正在建设中”和“Quinncuatro Productions 的产品”。现在一切都完美地显示在页面上，但图像似乎真的很喜欢拥抱页面的左侧。这就是我现在所拥有的。我最简单的想法是现在的样式标签。我的第一个和第二个想法在标题评论中。难道我做错了什么？

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Think Klinck</title>
<style>
body{
background-image:url('metalBackground.jpg');
}
img{
margin-left:auto;
margin-top:auto;
}

/*This was the first idea that I had:
.UnderConstruction{
align:center;
margin-left:auto;
margin-top:auto;
}
.Q4Productions{
align:center;
margin-left:auto;
margin-top:auto;

And this was my second:
div.center{
margin-left:auto;
margin-top:auto;
}
*/
</style>
</head>

<body>

<div id="UnderConstruction" class="center">
<img src="UnderConstruction.gif" alt="ThinKlinch.com is regretfully under construction.">
</div>

<div id="Q4Productions" class="center">
<img src="Q4Productions.gif" alt="A product of Quinncuatro Productions.">
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T21:02:11.027

```
#UnderConstruction,#Q4Productions{
    text-align:center;
}​ 
```

或者

```
.center{
    text-align:center;
}​ 
```

这将使您的图像在 div 中居中。

# php - 一个整数在没有我添加的情况下被添加到数组中

> ID：12876957
> 
> 赞同：0
> 
> 时间：2012-10-13T21:01:03.167
> 
> 标签：php

嗨，我一直在尝试使用 PHP 开发一个 RPN 计算器，并且在程序中的某个时刻，我的数组中突然出现了一个数字 1。我已经用调试器检查了该程序 3 次，但我不明白它来自哪里.这是我的代码：

```
 if(isset($_GET["send"])){
                $v0 = $_GET["val0"];
                $a = explode(" ", $v0);
                $second_array = array();

                function operatii($v , $second_array){
                    $var1 = array_pop($second_array);
                    $var2 = array_pop($second_array);
                    $rez = null;

                    switch ($v){
                        case '+':
                            $rez = $var1 + $var2;
                            break;
                        case '-':
                            $rez = $var2 - $var1;
                            break;
                        case '*':
                            $rez = $var1 * $var2;
                            break;
                        case '/':
                            $rez = $var2 / $var1;
                            break;
                    }

                    array_push($second_array, $rez);
                    print_r($second_array);
                    echo '<br/>';
                }

                for($i = 0; $i < count($a); $i++){
                    if($a[$i] === "+" || $a[$i] === "-" || $a[$i] === "*" || $a[$i] === "/" ){
                        operatii($a[$i] , $second_array);
                        continue;
                    }else{
                        array_push($second_array, $a[$i]);

                    }
                }
            }

        ?>

        <form method="get" action="">
            <input type="text" value="<?php  ?>" name="val1" disabled/>
            <input type="text" value="" name="val0" />
            <input type="submit" value="Introdu" name="send"/>
        </form> 
```

长话短说，这个表格将采用这样的表达式 5 1 - 5 + 并执行 5 - 1 + 5 的操作。

在for循环运行两次并且operatii()方法运行它的sequence之后出现问题，在方法结束时$rez变量get被推入$second_array。在此之后，方法结束和操作方法之间以及下一个循环迭代的开始 1 被添加到 $second_array 中。

正如我之前提到的，我运行了调试器 3 次，但我找不到任何关于为什么以及从何处将 1 添加到数组中的任何合乎逻辑的解释。谁能告诉我发生了什么以及我该如何纠正它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T21:08:53.353

错误是您将 $second_array 作为值而不是作为参考传递。这意味着数组被复制，并且您在 operatii 函数中所做的任何更改都不会影响函数之外的 second_array 。要做的就是改变

`function operatii($v , $second_array){`

到

`function operatii($v , &$second_array){`

有关该主题的更多信息：

[PHP中的数组是按值传递还是按引用传递？](https://stackoverflow.com/questions/2030906/are-arrays-in-php-passed-by-value-or-by-reference)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T21:08:21.047

您缺少数组`&`，也可以将运算符保存在数组中

```
if (isset($_GET["send"])) {
    $_GET["val0"] = isset($_GET["val0"]) ? $_GET["val0"] : "";
    $a = explode(" ", $_GET["val0"]);
    $second_array = array();

    function operatii($v, &$second_array) {
        $var1 = array_pop($second_array);
        $var2 = array_pop($second_array);
        $rez = null;
        switch ($v) {
            case '+' :
                $rez = $var1 + $var2;
                break;
            case '-' :
                $rez = $var2 - $var1;
                break;
            case '*' :
                $rez = $var1 * $var2;
                break;
            case '/' :
                $rez = $var2 / $var1;
                break;
        }
        array_push($second_array, $rez);
        print_r($second_array);
        echo '<br/>';
    }

    $oprators = array("+","-","*","/");
    for($i = 0; $i < count($a); $i ++) {
        if (in_array($a[$i], $oprators)) {
            operatii($a[$i], $second_array);
            continue;
        } else {
            array_push($second_array, $a[$i]);
        }
    }
} 
```

# javascript - setInterval with an Array

> ID：12876960
> 
> 赞同：3
> 
> 时间：2012-10-13T21:01:28.137
> 
> 标签：javascript, jquery, arrays, setinterval

I'd like to use the `setInterval` function in `jQuery` in order to create an alert with the content of one array every 4 seconds. However my alerts show all the values of my array within a short amount of time and it stops for 4 seconds after having displayed all the values.

```
$.each(['html5', 'EDM', 'Coca Cola', 'creativity'], function(id,value) {
    setInterval(function(){
        alert(value);
    }, 4000);
}); 
```

In this case, I'd like to display something like : *Alert('html5') - 4 seconds - Alert('EDM') - 4 seconds - Alert('Coca Cola') - 4 seconds - Alert('creativity') - 4 seconds - Alert('html5') - 4 seconds - Alert('EDM') - 4 seconds - ...*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-13T21:04:09.183

`setInterval`从循环中移动。

```
var arr = ['html5', 'EDM', 'Coca Cola', 'creativity'];
var index = 0;
setInterval(function() {
    console.log(arr[index++ % arr.length]);
}, 4000);​ 
```

[**现场演示**](http://jsfiddle.net/67ghr/)
无需 jQuery。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-13T21:06:50.367

使用递归`setTimeout`

```
var arr = ['html5', 'EDM', 'Coca Cola', 'creativity'];
var alertLoop = function(i) {
    if (arr[i]) {
        alert(arr[i]);
        setTimeout(function(){alertLoop(i+1);}, 4000);
    }
}
alertLoop(0); 
```

演示：http: [//jsfiddle.net/B5tJw/](http://jsfiddle.net/B5tJw/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-13T21:17:20.963

`setInterval`不鼓励使用。如需解释，请在此处阅读：http: [//bonsaiden.github.com/JavaScript-Garden/#other.timeouts](http://bonsaiden.github.com/JavaScript-Garden/#other.timeouts)

总结一下问题：

`setInterval`无论页面上发生了什么，都会定期触发事件。

但是，Javascript 不是多线程的：它一次只能运行一个代码序列。如果`setInterval`在另一个代码序列正在运行时触发，则新的代码序列将被阻塞，直到前一个代码序列完成，并等待它。

如果这种情况反复发生，您最终可能会遇到大量等待运行的事件。

您`alert()`用于显示您的消息。`alert()`导致代码执行序列暂停，直到用户响应消息，但保持锁定状态，以便其他事件无法运行它们的代码。对于 来说，这是一个特殊的问题`setInterval`，因为它会在指定的时间触发新事件，而不管是否有其他东西阻塞了脚本。

解决方案是使用`setTimeout`而不是`setInterval`.

`setTimeout`只触发一次，但很容易告诉它在自己的函数中再次触发，因此您可以获得与 相同的效果`setInterval`，但控制更多。您的代码可以等到`alert()`用户接受之后再触发下一个事件，这意味着您不会遇到可能发生的级联事件的问题`setInterval`。

希望这有助于解释事情。我在开头提到的链接也很有帮助。

# image - Matlab DICOM 切片

> ID：12876961
> 
> 赞同：3
> 
> 时间：2012-10-13T21:01:38.153
> 
> 标签：image, matlab, slice, dicom

我在 matlab 中将 DICOM 图像加载为矩阵。我的问题是，如何在每个正交方向上显示该图像的特定切片？

与位置 100 处的视图切片 x 类似，y=0，z=0

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T00:34:55.590

如果你的矩阵是 M，并且有 d 维（3，或者你有什么）并且你想绘制一个维度之一的一维“切片”，那么：

```
 plot(squeeze(M(n1,n2, ...,:,...)); 
```

其中 n1,n2,... 是要切片的维度 x,y,... 的位置，运算符 (:) 是要绘制的维度。

例如，给定一个 5 维矩阵 M=rand(10,10,10,10,10)，让我们围绕一些点（x=n1，y=n2 等...）对第 4 维进行切片

```
 M=rand(10,10,10,10,10);
   n1=4; n2=7; n3=3; n5=5; 
   plot(squeeze(M(n1,n2, n3, :, n5))); 
```

如果切片是二维的，那么您可以使用 imshow 或 imagesc 来显示二维切片，例如显示第 2 维和第 4 维：

```
 imagesc(squeeze(M(n1,:,n3,:,n5))) 
```

# jquery - jquery modernizr margin 0 auto 不工作

> ID：12876967
> 
> 赞同：1
> 
> 时间：2012-10-13T21:02:14.337
> 
> 标签：jquery, html, css, modernizr

我已经建立了一个显示良好的网站，直到我包含了modernizr.min.js。

我的定位为 0 的身体包装自动向左浮动，顶部的边距约为 50 像素，出于好奇，我告诉它向右浮动，只是让它向左漂移。

以前有人遇到过这个问题吗？如果是这样，你修复了吗？

提前谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T23:05:13.330

Modernizr 最好放在您的`<head>` **任何其他脚本或 CSS 之前**。也许这可以解决你的问题。

# uiimage - iPhone 5 - 背景图片

> ID：12876969
> 
> 赞同：1
> 
> 时间：2012-10-13T21:02:23.047
> 
> 标签：uiimage, iphone-5

随着 iPhone 5 的新屏幕分辨率和宽高比，在处理全屏（或大部分全屏）图像时，似乎有两种方法可以利用新的屏幕空间：

*   包括两个图像 bg@2x.png 和 bg-h568@2x.png 并检查设备的主屏幕边界以确定加载哪个。
*   仅包含一个文件，但使其成为 iPhone 5 的完整分辨率

*（还有其他方法：拉伸、平铺和/或使用 Quartz 绘图。）*

这两种选择都有缺点：

*   包含两个文件会增加应用程序的包大小
*   在 4 上加载 iPhone 5 的视网膜图像会在屏幕上显示图像数据时剪切图像数据，但仍会消耗相同数量的内存资源

我对更好地了解第二个缺点的细节特别感兴趣。

我认为如果我可以进一步使用这个整合图像的想法，它将保存应用程序包（和我的设计师）......

假设我有一张图像，纵向占用 320pt x 480pt，横向占用 480pt x 320pt（宽 x 高）。

*（编辑：最初我没有考虑其他一些重要的花絮。为了完整起见，我在这里包括这些想法）*

如果我们创建一个分辨率为 480pt x 480pt 的图像文件而不是横向和纵向文件，这将阻止应用程序包包含两个文件，每个文件都包含 320pt x 320pt 区域的重复图像数据。但是，这个大的方形图像将在角落中包含四个 80pt x 80pt 的象限，这些象限不会被看到。在所有条件相同的情况下，应用程序包中的图像数据仍应减少 20%。

重读比尔的[“iBooks Author Experiment”](http://bill.dudney.net/roller/objc/entry/experimenting_with_ibooks_author)，内存需求很容易弄清楚：

*   横向或纵向：`640 * 960 * 4 = 2,457,600`
*   大广场：`960 * 960 * 4 = 3,686,400`

加载大方块所需的内存比加载适合屏幕大小的图像多 50%。很明显，应用程序包中的节省无法与资源消耗相提并论！

但是，如何将其扩展到一个包含 iPhone 5 和 iPhone 4 - 568pt x 568pt 的巨大正方形？应用程序包中只有一个文件（巨型正方形），而不是四个文件（iP4 横向、iP4 纵向、iP5 横向、iP5 纵向）。可节省约 60%。

命中的资源呢？

*   iPhone 5 横向或纵向：`1136 * 640 * 4 = 2,908,160`
*   巨人广场：`1136 * 1136 * 4 = 5,161,984`

iPhone 4 的内存增加了 110%，iPhone 5 的内存增加了 77.5%。

我最初的问题大致分为两个部分：1\. 我是否正确理解这一点，以及 2\. 这种权衡是否明智。

我希望我的编辑（受比尔回答的启发）表明我现在确实了解这些东西。而且，如果新发现的知识是正确的，那么＃2 几乎可以回答自己。:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T05:06:02.290

一般来说，你会得到它。

假设您有大方形图像并且它是某种平铺图案（亚麻等），那么您可以使用 ImageIO 以您需要的大小加载裁剪后的图像，这将使用一些额外的内存来解压缩图像，但一旦完成它只会消耗填充背景需要什么。

我建议不要缩放图像。

但另一方面，使用 3 张图片（foo、foo@2x 和 foo-h568@2x）而不是 1 张图片发布应用程序更有意义。我想说你应该使用一张图片的唯一方法是，如果你接近（我认为）50MB 的 3G/LTE 下载大小。

# python - 嵌套字符串到元组python

> ID：12876974
> 
> 赞同：3
> 
> 时间：2012-10-13T21:03:14.877
> 
> 标签：python

我的字符串看起来像：

```
"('f', ('d', ('a', 'b')), 'g')" 
```

我想将其转换为元组。怎么能这样做...我将在绘制树状图时使用它

编辑：附加说明：我的代码和输出（打印）：

```
print type(myString)                     # <type 'str'>
print myString                           #('f',('d',('a','b')),'g')
myString = ast.literal_eval(myString)
print type(myString)                     #<type 'tuple'>
print myString                           #('f', ('d', ('a', 'b')), 'g')

for tuple in myString:                   #f
    print tuple                          #('d', ('a', 'b'))
                                         #g 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-13T21:05:55.937

您可以使用[`ast.literal_eval`](http://docs.python.org/library/ast.html#ast.literal_eval)- 例如：

```
>>> import ast
>>> s = "('f', ('d', ('a', 'b')), 'g')"
>>> ast.literal_eval(s)
('f', ('d', ('a', 'b')), 'g') 
```

该功能的[文档](http://docs.python.org/library/ast.html#ast.literal_eval)说：

> 安全地评估表达式节点或包含 Python 表达式的字符串。提供的字符串或节点只能由以下 Python 文字结构组成：字符串、数字、元组、列表、字典、布尔值和无。
> 
> 这可用于安全地评估来自不受信任来源的包含 Python 表达式的字符串，而无需自己解析值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T21:06:05.460

使用[`ast.literal_eval`](http://docs.python.org/library/ast.html#ast.literal_eval).

这不会让一些恶意脚本从提供的字符串中运行`eval`。

# string - 使用 STL 就地反转字符串的单词

> ID：12876976
> 
> 赞同：0
> 
> 时间：2012-10-13T21:03:32.057
> 
> 标签：string, stl, stl-algorithm, c++-standard-library

这个问题已经在 SO:. 这是我使用反转字符串然后反转单词的传统算法的 STL 函数的版本。有没有更优雅的解决方案而不使用循环？

```
std::string something;
std::getline(std::cin, something);
std::reverse(something.begin(), something.end());
for (size_t i = 0, size_t nextPos = something.find_first_of(' ', i);
     nextPos != std::string::npos; i = nextPos + 1, 
     nextPos = something.find_first_of(' ', i)) {
     std::string::iterator startIter = something.begin() + i;
     std::string::iterator endIter = something.begin() + nextPos;
     std::reverse(startIter, endIter);
} 
```

假设输入是完美的，句子前后没有空格，单词之间只有一个空格。是否有不需要循环的 stl 解决方案？

最好的，Subramanian

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T21:10:53.883

这是使用迭代器和闭包的无循环方式：

```
#include <iterator>
#include <algorithm>
#include <sstream>
#include <string>

std::istringstream iss(something);
std::string sentence;

std::for_each(std::istream_iterator<std::string>(iss),
              std::istream_iterator<std::string>(),
              [&sentence](std::string const & s) { sentence.insert(0, s + ' '); }
             ); 
```

* * *

**更新：**这是一个单循环的就地算法：

```
#include <string>
#include <algorithm>

void reverse(std::string & s)
{
    for (std::size_t pos, done = 0;
         (pos = s.find(' ')) != s.npos && ++pos + done <= s.size();
         done += pos)
    {
        std::rotate(s.begin(), s.begin() + pos, s.end() - done);
    }
} 
```

例子：

```
#include <iostream>

int main()
{
    for (std::string line; std::getline(std::cin, line); )
    {
        reverse(line);
        std::cout << '"' << line << '"' << std::endl;
    }
} 
```

测试运行：

```
$ echo "hello world how are you " | ./prog
"you are how world hello " 
```

# xml - 网络收获——去除不寻常的字符

> ID：12876982
> 
> 赞同：0
> 
> 时间：2012-10-13T21:05:03.010
> 
> 标签：xml, regex, web-scraping, webharvest

我正在尝试抓取在锚点后有一些空格的页面：

```
</a>&nbsp;&nbsp;|&nbsp;&nbsp; 
```

我似乎找不到指定文本的方法，我要么触发处理器错误，要么无法检测到字符串本身。之后的所有内容都会导致 html-to-xml 转换失败，因为包含字符时 xml 格式不正确。因此，我需要删除之后的所有内容（请注意，在文档的其他部分之后还有其他部分有 div 标签或其他内容）。

我的代码：

```
<xpath expression="/">
     <regexp replace="true">
            <regexp-pattern>(nbsp;)</regexp-pattern>
                <regexp-source>
                    <html-to-xml omitcomments="true" advancedxmlescape="true" prunetags="head,script,meta,meta ,p,base,br,link,img,image,input,option,nbsp;">
                       <http url="http://mysite.org/map/aindex/" method="get" />
                    </html-to-xml>
                </regexp-source>
                <regexp-result>
                    <template></template>
                </regexp-result>
      </regexp>
</xpath> 
```

我认为我的问题在于正则表达式模式。我试过了：

 `````
 &nbsp;  
    \& nbsp;  (without the space in between -- SO doesn't display that correctly
    \s+\|\s+
```` 

`除其他事项外。我什至尝试将表达式放在 CDATA 元素中，但我也无法让它工作。`

 `有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T22:21:01.500

对于`&nbsp;`正则表达式模式，您可以尝试使用`\u00A0```

# azure - 更改 Azure 网站订阅

> ID：12876984
> 
> 赞同：38
> 
> 时间：2012-10-13T21:05:24.183
> 
> 标签：azure, azure-web-app-service

我有一个 Windows azure 的免费试用版，我出国了，它用完了。

我现在已升级为现收现付帐户。都好。

但是，我以前的网站仍然在我的旧订阅中运行，有什么方法可以使用我的新的现收现付订阅重新激活这些网站？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-13T22:43:49.077

如果您升级现有的免费帐户而不是开设新的现收现付帐户，这应该是一个无缝过渡。

您可以[联系支持人员](http://www.windowsazure.com/en-us/support/contact/)- 使用“计费问题”选项，然后选择“转移订阅”，他们应该能够为您提供帮助。

当然，您也可以将资产重新部署到新订阅。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-08-12T18:52:30.227

我用微软创建了一张“账单”票。当您专门为此通过他们的向导时，有一种票证。在我让免费试用期到期后，他们能够将我的“免费试用”升级为付费。缺点是我所有的虚拟机都被删除了。然而，它确实让我可以毫无问题地访问我的网站和存储。我能够使用存储 vhd 重新创建所有 VM。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-12T05:38:51.987

我的经验是我刚刚重新部署到我在新订阅下创建的新网站。我没有找到将它们转移到新订阅的方法。

您可以将 SQL Azure 移动到新订阅，但不能移动到网站。要将 SQL Azure 迁移到新订阅，您需要使用旧的 Azure 门户管理。请按照以下步骤操作：http: [//blogs.msdn.com/b/windowsazure/archive/2012/03/07/moving-sql-azure-servers-between-subscriptions.aspx](http://blogs.msdn.com/b/windowsazure/archive/2012/03/07/moving-sql-azure-servers-between-subscriptions.aspx) 请注意，您正在移动数据库所在的服务器. 因此，如果您在同一服务器中有多个数据库，则所有内容都将被移动。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-02-17T14:43:01.070

发布的链接 stack247 中的文档现已过时。要更改数据库的目标订阅，您必须更改数据库服务器的目标订阅。有几种方法可以导航到服务器，但这里只是一个示例：

1.  单击**数据库**选项卡
2.  单击要更改**的数据库的名称**
3.  在**仪表板**视图中，单击**快速**浏览部分中的服务器链接。它位于视图的**右下角**。
4.  在**仪表板**视图中，单击**快速浏览部分中的****更改订阅**链接。这是视图的**右侧**。
*****   更改**Target Subscription**，然后单击**检查**按钮。****

 ****至于更改网站或云服务的订阅，我会按照上面的建议进行；并重新发布网站或云服务。发布时，通过单击上一个按钮更改设置以针对不同的订阅。

- - - - -更新 - - - - -

如果您有大量资产需要移动到另一个帐户，请使用 Azure 帮助台创建票证。您必须执行上述操作并切换数据库/服务器的帐户，但 Microsoft 能够在其端运行一个脚本来移动所有内容。根据您资产的大小，可能需要更长的时间。对我来说幸运的是，搬家只是一天。我建议这样做，而不是第二次发布所有内容。

[https://manage.windowsazure.com/?getsupport=true](https://manage.windowsazure.com/?getsupport=true)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-05-06T06:39:30.900

[您可以在https://manage.windowsazure.com](https://manage.windowsazure.com)上将 Azure SQL DB 从一个订阅移动到另一个订阅

两个订阅都应该在同一个默认目录中。如果它们位于不同的目录中，则选择：

*   *订阅*
*   *管理订阅/目录*
*   选择订阅并点击底部的*“编辑” 。*
*   选择其他订阅所在的目录，然后单击“下一步”。

当两个订阅在同一个目录中时。

*   选择*“SQL 数据库”*
*   选择合适的服务器
*   在 Quick Glance 中，您应该会看到*“更改订阅”*

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-10-10T08:53:55.800

上面提到的所有解决方案现在都已过时。在[https://portal.azure.com/](https://portal.azure.com/)中，

1.  对于 SQL Server，请进入“SQL Server”菜单，选择要更改的服务器。在概览中，单击订阅名称右侧的编辑按钮。

2.  对于 WebApp，请转到“应用服务计划”菜单，选择您的计划，单击资源组，然后在概览中，单击订阅名称右侧的编辑按钮。****

# c++ - 列为班级成员

> ID：12876985
> 
> 赞同：1
> 
> 时间：2012-10-13T21:05:42.803
> 
> 标签：c++

我遇到了一些麻烦！我的目标是通过函数检查输入数字与素数列表是否为素数（在列表中）`find()`。我还没有走到那一步。这是作业，所以我必须重载函数运算符并以这种愚蠢（恕我直言）的方式来做。到目前为止，这是我所拥有的：

```
using namespace std;

class isprime {
    public: isprime() { /*nothing...yet?*/
    }
    bool operator()(int);
    list <int> pnums(1, 2);

    private: int expandList(int number);
};

bool isprime::operator()(int number) {
    if (pnums.back() < number) {}
}

int isprime::expandList(int number) {
    for (int j = pnums.back(); j = number; j++) {
        for (int i = 2; i < sqrt(j); i++) {
            if (j % i != 0) pnums.push_back(j);
        }

    }
}

int main() {
    isprime pcheck;
    int number;

    while (cin >> number) {
        if (pcheck(number)) cout << number << " is prime!\n";
    }
} 
```

这是我的错误：

> prime2.cpp:12：错误：数字常量 prime2.cpp:12 之前的预期标识符：错误：数字常量prime2.cpp 之前
> 的预期'，'或'...'
> ：在成员函数'bool isprime::operator()( int)'：
> prime2.cpp:19：错误：'((isprime*)this)->isprime::pnums' 没有类类型
> prime2.cpp：在成员函数'int isprime::expandList(int)'中：
> prime2.cpp:23: 错误: '((isprime*)this)->isprime::pnums' 没有类类型
> prime2.cpp:25: 错误: '((isprime*)this)->isprime::pnums ' 没有类类型

我不明白出了什么问题。谁能帮帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T21:55:47.413

最大的问题是您如何尝试使用类中列表的构造函数。如果您只是`(1, 2)`从类中的列表声明中删除，它应该编译。其次，如果你想在你的类中调用一个对象的构造函数，我推荐这种方法

```
class isprime{
  public: 
   isprime() : pnums(1,2) { /*nothing...yet?*/ }
   ...
   list <int> pnums;
   ... 
```

# weather - 谷歌和雅虎天气 API

> ID：12876989
> 
> 赞同：0
> 
> 时间：2012-10-13T21:06:10.890
> 
> 标签：weather

我创建了一个谷歌天气 api，它允许用户输入一个城市并获取 3 天的天气详细信息。

谷歌已经关闭了这项服务。

使用 yahoo api，我需要一个 WOEID 来获取天气详细信息。有没有办法让我从雅虎获取 3 天的天气并在此过程中将位置更改为 WOEID，或者我应该查看替代 api。下面是 yahoo api 要求的示例。

[http://weather.yahooapis.com/forecastrss?p=SFXX0044&u=c&d=5](http://weather.yahooapis.com/forecastrss?p=SFXX0044&u=c&d=5)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-20T08:46:36.483

我强烈推荐使用[forecast.io](https://developer.forecast.io/)，它非常易于使用具有丰富天气数据源的 API

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-01T21:12:00.820

您可以查看这个免费的天气 API - [https://www.mashape.com/george-vustrey/ultimate-weather-forecasts#!documentation](https://www.mashape.com/george-vustrey/ultimate-weather-forecasts#!documentation)

旧金山 7 天天气的示例结果：

```
[
 {
  "day_of_week": "Mon",
  "high": "80.23",
  "low": "56.19",
  "condition": "Partly cloudy in the evening."
 },
 {
  "day_of_week": "Tue",
  "high": "78.32",
  "low": "59.2",
  "condition": "Mostly cloudy throughout the day."
 },
 {
  "day_of_week": "Wed",
  "high": "87.21",
  "low": "57.64",
  "condition": "Mostly cloudy throughout the day."
 },
 {
  "day_of_week": "Thu",
  "high": "90.1",
  "low": "60.91",
  "condition": "Clear throughout the day."
 },
 {
  "day_of_week": "Fri",
  "high": "88.66",
  "low": "57.88",
  "condition": "Clear throughout the day."
 },
 {
  "day_of_week": "Sat",
  "high": "86.5",
  "low": "54.11",
  "condition": "Partly cloudy in the morning."
 },
{
  "day_of_week": "Sun",
  "high": "89.62",
  "low": "52.42",
  "condition": "Clear throughout the day."
}
] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-13T14:35:12.067

另一个不错的选择是[OpenWeatherMap](http://openweathermap.org/)。对于任何给定的位置，它都提供当前条件、天气预报和非常有吸引力的交互式地图。

OpenWeatherMap 提供历史数据，但免费天气数据计划的可用城市列表有限。与 Weather Underground API 不同，它允许每天进行超过 500 次调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-28T13:07:23.430

我正在为我的网站使用[OpenWeatherMap](http://www.openweathermap.org/)。您可以查看另一种选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-06T22:15:32.527

[雅虎！天气 API](http://soup.metwit.com/post/47181933854/an-alternative-to-yahoo-weather-api)已于 2013 年 4 月 3 日失效。

您可以使用 Metwit[天气 API](http://metwit.com/weather-api/)。
如果您可以在客户端实现它们：每天 200 个请求（基于 ip 的限制）不需要身份验证。覆盖全球，符合 JSON 和 REST 标准。您可以免费注册额外的 API 调用，如果您仍然需要在服务器端调用它们，基本计划非常便宜。

这里有一个 jQuery 中的小例子：http: [//jsbin.com/isukam/1](http://jsbin.com/isukam/1)使用我们的[天气资源](http://metwit.com/weather-api/docs/resources/weather/)。

完全披露：我拥有这个可爱的 API。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-06T18:48:23.787

我会看一个替代方案。获取 WOEID 很复杂（并且更改为按次付费搜索模型），并且雅虎的 API 提供的内容并不多于该位置的当前条件。

[Weather Underground API](http://www.wunderground.com/weather/api/d/docs?d=data/history)是一个提供相当丰富历史的API 。但是，如果您每天调用超过 500 次，则他们的 API 访问费用每月至少需要 520 美元。

还有其他天气 API。大多数历史 API 都是付费服务。货比三家，以最优惠的价格满足您的需求。

如果您的网站是针对特定国家/地区的，则您所在的国家/地区可能有免费的数据产品。例如，查看美国的 NOAA 数据服务或英国的气象局服务。

# mysql - mysql select as 语句结合查找和替换

> ID：12876994
> 
> 赞同：0
> 
> 时间：2012-10-13T21:06:57.223
> 
> 标签：mysql

我尝试使用 Select As 从表中选择一个值，以便我可以在查找和替换语句中使用该值。这是我到目前为止所拥有的，但没有运气：

SELECT meta_value from wp_postmeta where meta_key=description and post_id IN (22179,22182) AS "video", update wp_posts set post_content = replace(post_content,"[description]","video")

有什么建议么？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T21:25:07.210

`AS`用于重命名你的列`SELECT`，所以它看起来像这样：

```
 SELECT meta_value as video from ... 
```

这不是你想要的。你在追求`SELECT INTO`，例如

```
 SELECT meta_value INTO @my_var from ... 
```

然后您可以稍后使用@my_var。

请参阅[手册](http://dev.mysql.com/doc/refman/5.0/en/select-into.html)。

# php - 以任何方式输出保存为文件正文一部分的 HTTP 标头

> ID：12876995
> 
> 赞同：0
> 
> 时间：2012-10-13T21:07:45.333
> 
> 标签：php, http, header

假设一个文件保存在磁盘上：

```
HTTP/1.1 200 OK
Date: Thu, 28 Jun 2012 22:11:14 GMT
Pragma: no-cache
Cache-Control: must-revalidate, no-store
Expires: Thu, 01 Jan 1970 00:00:00 GMT
Content-Length: 1234
Connection: close
Content-Type: text/html

<html .... 
```

php中是否有任何内置函数可以输出文件，同时识别其中的标题并正确发送它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T21:12:55.350

不，没有。你必须自己实现一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T21:17:58.767

它不存在，但您可以使用以下

```
$file = "file.html";
var_dump(fileHeaders($file)); 
```

输出

```
array
  0 => string 'HTTP/1.1 200 OK' (length=15)
  1 => string 'Date: Thu, 28 Jun 2012 22:11:14 GMT' (length=35)
  2 => string 'Pragma: no-cache' (length=16)
  3 => string 'Cache-Control: must-revalidate, no-store' (length=40)
  4 => string 'Expires: Thu, 01 Jan 1970 00:00:00 GMT' (length=38)
  5 => string 'Content-Length: 1234' (length=20)
  6 => string 'Connection: close' (length=17)
  7 => string 'Content-Type: text/html' (length=23)
  8 => string '' (length=0) 
```

使用的功能

```
function fileHeaders($file) {
    $content = file_get_contents($file, null, null, 0, 1000);
    $content = trim($content);
    if (stripos($content, "HTTP") === 0) {
        return array_map("trim", explode("\n", strtok($content, "<")));
    }
    return false;
} 
```