# StackOverflow 问答 12790000-12790999

# c++ - RGB 颜色到 HSL 字节

> ID：12790009
> 
> 赞同：3
> 
> 时间：2012-10-08T21:51:59.193
> 
> 标签：c++, python, math, rgb, hsl

我已经看到了一些将 RGB 转换为 HSL 的实现。大多数都是准确的，并且可以双向工作。

对我来说，它在 2 个方向上工作并不重要（无需放回 RGB）但我想要返回值从 0 到最大 255 的代码，也适用于 Hue 通道。而且我不想做像 Hue/360*250 这样的设计我正在搜索基于整数的数学没有 Dwords（它用于另一个系统），很好的是某种布尔逻辑（和/或/xor）

它不应该做任何基于整数或实数的数学，目标是代码只使用字节数学。

也许有人在使用类似的代码时已经发现了这样的数学

1.  c++ 或
2.  c# 或
3.  Python

我可以翻译成 c++

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T21:57:42.093

签出[`colorsys`](http://docs.python.org/library/colorsys.html)模块，它有如下方法：

[`colorsys.rgb_to_hls(r,g,b)`](http://docs.python.org/library/colorsys.html#colorsys.rgb_to_hls)

[`colorsys.hls_to_rgb(h,l,s)`](http://docs.python.org/library/colorsys.html#colorsys.hls_to_rgb)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:03:26.603

[easyrgb](http://www.easyrgb.com)站点有许多用于色彩空间转换的代码片段。这是[rgb->hsl](http://www.easyrgb.com/index.php?X=MATH&H=18#text18)代码。

# card.io - 不支持前置摄像头

> ID：12790011
> 
> 赞同：4
> 
> 时间：2012-10-08T21:52:12.937
> 
> 标签：card.io

CardIOActivity.canReadCardWithCamera(this) 函数和 CardIOActivity 类本身不提供允许人们使用前置摄像头的方法。可以提供这个选项吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:22:37.557

我们 (card.io) 对使用前置摄像头（包括镜像输出和不包括镜像输出）进行了相当多的实验，发现它是一种尴尬和不舒服的用户体验，所以我们有意识地决定不启用它。

# javascript - 关于jquery中的气泡显示

> ID：12790014
> 
> 赞同：1
> 
> 时间：2012-10-08T21:52:16.350
> 
> 标签：javascript, jquery, jquery-ui, graph

我想打印这样的东西![在此处输入图像描述](../Images/6648a6c6fac3f24908a8e06097e5994e.png)

你看到的每个气泡都是一个“li”元素

所以我做了 float=left 这样我就可以水平地看到它们。我无法理解，我应该如何动态显示两种不同的颜色。

例如：如果是 60% 和 40%，那么我需要显示更多的蓝色气泡和更少的橙色气泡，反之亦然。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T21:58:19.697

如果没有您的某些特定代码，则无法提供详细信息，但是：将模运算符 ( `%`) 与`>`or一起使用`<`。

例如：

```
var idx = $('ul li').index(); 
```

获取索引，然后

```
var color = (idx % 11 < 6) ? "blue" : "orange"; 
```

选择颜色。

# c++ - 操作系统可移植 C/C++ XML 解析器

> ID：12790016
> 
> 赞同：0
> 
> 时间：2012-10-08T21:52:30.237
> 
> 标签：c++, xml, xml-parsing

什么是最快的 C/C++ 开源、OS 可移植 XML 解析器，同时具有 Unicode 支持和 XML Schema 支持？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T21:55:04.950

没有“最好的……”之类的东西，但是[Xerces-C++](http://xerces.apache.org/xerces-c/)是一个强大的，它支持 XML Schema，而[pugixml](http://pugixml.org/documentation/)是一个非常简洁的，但是它没有验证

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T21:55:09.690

一个常用的 xml 库是 libxml2，可[在此处](http://www.xmlsoft.org/)获得。

# c# - 在 C# 中组织自定义异常

> ID：12790018
> 
> 赞同：11
> 
> 时间：2012-10-08T21:52:38.257
> 
> 标签：c#, custom-exceptions

我正在创建一个 C# 应用程序，并尝试在适当的时候利用自定义异常。我在这里查看了其他问题和 MSDN 设计指南，但没有遇到任何像我在这里想知道的那样具体的问题。

如何组织自定义异常的最佳实践是什么？

例如，我有一个`Disk`抛出`InvalidDiskException`. `Disk`是唯一抛出此异常的类。

目前，我将异常嵌套在 Disk.cs 文件中，如下所示：

**磁盘.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace OrganizingExceptionsInCSharp
{
    class Disk
    {
        [Serializable]
        public class InvalidDiskException : Exception
        {
            public InvalidDiskException() { }
            public InvalidDiskException(string message) : base(message) { }
            public InvalidDiskException(string message, Exception innerException) : base(message, innerException) { }
        }

        //
        // Code that throws the exception.
        //
    }
} 
```

是否应该将异常定义在与 Disk 相同的级别（即不嵌套在其中）？异常是否应该嵌套在磁盘中但保留它自己的部分文件？可能还有其他更好的选择吗？如果还有其他我没有想到的考虑因素，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-14T13:03:36.087

我会在 {MyNamespace}.Exceptions 中定义我的自定义异常

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:23:42.293

恕我直言，自定义异常应该在它们自己的独立程序集中，原因很简单：如果你最终将它们扔到进程/机器边界，如果它们不共享一个涉及的每个进程可能会遇到问题（因此会遇到另一个异常）对自定义异常的共同理解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-05T01:17:03.720

我建议为每个自定义异常设置一个文件/类，并将这些文件/类放在名为 CustomException 的项目子文件夹中。

# c# - 如何结束对 Windows 8 Live Tile 的定期更新

> ID：12790021
> 
> 赞同：2
> 
> 时间：2012-10-08T21:52:47.940
> 
> 标签：c#, .net, windows-8, windows-runtime

我已经看到很多关于如何在 Windows 8 中开始定期更新动态磁贴的示例，例如：

```
PeriodicUpdateRecurrence recurrence = PeriodicUpdateRecurrence.Hour;
System.Uri url = new System.Uri(polledUrl);
TileUpdateManager.CreateTileUpdaterForApplication().StartPeriodicUpdate(url, recurrence); 
```

但是，您如何撤消此操作？我添加了一个应用程序设置来禁用实时磁贴更新，但我找不到删除轮询的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T21:56:07.690

我通过浏览 Intellisense 选项找到了答案。

要将图块恢复为其默认状态，即不活动，请使用：

```
TileUpdateManager.CreateTileUpdaterForApplication().Clear(); 
```

希望这对某人有所帮助 - 在任何 Windows 开发人员中心快速入门中都不容易找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T21:57:13.663

```
PeriodicUpdateRecurrence recurrence = PeriodicUpdateRecurrence.Hour;
System.Uri url = new System.Uri(polledUrl);
var tileUpdater = TileUpdateManager.CreateTileUpdaterForApplication();

tileUpdater.StartPeriodicUpdate(url, recurrence);

// ...

tileUpdater.StopPeriodicUpdate(); 
```

# python - 使用 python3 Mountain Lion 在 tkinter 中制作工具栏/菜单

> ID：12790023
> 
> 赞同：2
> 
> 时间：2012-10-08T21:52:57.923
> 
> 标签：python, tkinter

在修补了 tkinter 之后，我似乎无法让我的窗口看起来完全符合我想要的样子。但总的来说，我不确定文件编辑视图布局指的是什么。这是工具栏还是菜单？

到目前为止，我的 gui 看起来比我想要的要少得多。我应该一起抛弃 tkinter 吗？

有没有人剪断了给出一般 osx 布局的代码？那将是一个很大的帮助。也许我只是在概念上没有掌握 gui 编程方面。

谢谢

我想在以下代码中添加菜单

```
from tkinter import *
from tkinter import ttk

def undef(*args):
    pass
def undef2(*args):
    pass

root = Tk()

root.title("KDM Checker Beta ")

mainframe = ttk.Frame(root, padding="5 5 5 5")
mainframe.grid(column=12, row=12, sticky=(N, W, E, S))
mainframe.columnconfigure(0, weight=1)
mainframe.rowconfigure(0, weight=1)

countryvar = StringVar()
country = ttk.Combobox(mainframe, textvariable=countryvar)
country['values'] = ('dolby', 'sony', 'doremi')
country.grid(column=1, row = 1)

DATE = StringVar()
VENUE = StringVar()
UUID = StringVar()
SERVER_SERIAL = StringVar()

DATE_entry = ttk.Entry(mainframe, width=8, textvariable=DATE)
DATE_entry.grid(column=3, row=4, sticky=(W, E))

VENUE_entry = ttk.Entry(mainframe, width=8, textvariable=VENUE)
VENUE_entry.grid(column=3, row=8, sticky=(W, E))

UUID_entry = ttk.Entry(mainframe, width=8, textvariable=UUID)
UUID_entry.grid(column=3, row=16, sticky=(W, E))

state = StringVar()
mount = ttk.Radiobutton(mainframe, text='dolby', variable=state, value='dolby')

ttk.Label(mainframe, textvariable=DATE).grid(column=1, row=4, sticky=(W, E))
ttk.Label(mainframe, textvariable=VENUE).grid(column=1, row=8, sticky=(W, E))
ttk.Label(mainframe, textvariable=UUID).grid(column=1, row=16, sticky=(W, E))

ttk.Label(mainframe, text="KDM Window").grid(column=1, row=4, sticky=E)
ttk.Label(mainframe, text="Venue").grid(column=1, row=8, sticky=E)
ttk.Label(mainframe, text="UUID").grid(column=1, row=16, sticky=E)

for child in mainframe.winfo_children(): child.grid_configure(padx=3, pady=9)

DATE_entry.focus()

root.bind('<Return>', undef)

root.mainloop() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T01:20:16.283

要创建菜单栏，您需要创建`Menu`该类的实例，然后将其用`menubar`作主应用程序的属性值。从那里您可以创建其他菜单并将它们附加到菜单栏`add_cascade`。

例如：

```
import tkinter as tk
import sys

class ExampleApp(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self._create_menubar()
        self.text = tk.Text()
        self.text.pack(side="top", fill="both", expand=True)

    def _create_menubar(self):
        # create a menu for the menubar and associate it
        # with the window
        self.menubar = tk.Menu()
        self.configure(menu=self.menubar)

        # create a File menu and add it to the menubar
        file_menu = tk.Menu(self.menubar, tearoff=False)
        self.menubar.add_cascade(label="File", menu=file_menu)
        file_menu.add_command(label="Quit", command=self.on_quit)

        # create a Edit menu and add it to the menubar
        edit_menu = tk.Menu(self.menubar, tearoff=False)
        self.menubar.add_cascade(label="Edit", menu=edit_menu)
        edit_menu.add_command(label="Cut", underline=2, command=self.on_cut)
        edit_menu.add_command(label="Copy", underline=0, command=self.on_copy)
        edit_menu.add_command(label="Paste", underline=0, command=self.on_paste)

        # create a View menu and add it to the menubar
        view_menu = tk.Menu(self.menubar, tearoff=False)
        self.menubar.add_cascade(label="View", menu=view_menu)
        view_menu.add_cascade(label="Whatever", command=self.on_whatever)

    def log(self, s):
        self.text.insert("end", s + "\n")
        self.text.see("end")

    # not good programming style, but I'm trying to keep 
    # the example short
    def on_cut(self): self.log("cut...")
    def on_copy(self): self.log("copy...")
    def on_paste(self): self.log("paste...")
    def on_quit(self): sys.exit(0)
    def on_whatever(self): self.log("whatever...")

if __name__ == "__main__":
    app = ExampleApp()
    app.mainloop() 
```

# sql-server - 存储过程中备份失败

> ID：12790024
> 
> 赞同：1
> 
> 时间：2012-10-08T21:52:59.407
> 
> 标签：sql-server, tsql

如果我使用`BACKUP`语句：

```
BACKUP DATABASE [Database name]
TO DISK = ‘Location’
WITH INIT, NOSKIP, NOFORMAT 
```

备份确实有效。但是，如果我尝试在存储过程中使用相同的查询，例如

```
SET @SQLCMD = N'BACKUP DATABASE [Database Name] TO DISK = ''' + @FILENAME + ''' WITH INIT,NOSKIP, NOFORMAT' 

EXEC (@SQLCMD) 
```

我收到错误消息：

> 消息 203，级别 16，状态 2，过程 sp_BackupDatabase，第 31 行
> 名称 'BACKUP DATABASE [数据库名称] TO DISK = 'C:\Users\PC\Desktop\Backup\20121008\db.bak' WITH INIT,NOSKIP, NOFORMAT ' 不是有效的标识符。

我无法弄清楚我在哪里出错。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T21:58:43.280

先生，您正在做什么将命令作为存储过程执行，当然它不是存储过程名称的有效标识符！所以我建议你`"sp_executesql"`改用。如果您的代码工作正常，它应该可以在其他任何地方工作。

参考[http://msdn.microsoft.com/en-us/library/ms175170(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms175170%28v=sql.105%29.aspx)

像这样的代码：

```
Declare @Command    Nvarchar(500);

Select  @Command    =   N'BACKUP DATABASE [Database Name] TO DISK = ''' + @FILENAME + ''' WITH INIT,NOSKIP, NOFORMAT';

Execute sp_executesql   @Command 
```

干杯

# iphone - 适用于 iOS 的 RTSP 视频流

> ID：12790034
> 
> 赞同：3
> 
> 时间：2012-10-08T21:54:01.297
> 
> 标签：iphone, ios, ipad, video, rtsp

我想在 iPhone 屏幕上显示视频流`RTSP`。可以抛出项目的源代码或如何实现的细节。找到了 2 个项目，但他们还没有编译：

[https://github.com/mooncatventures-group/RTSPPlay](https://github.com/mooncatventures-group/RTSPPlay)

[https://github.com/mooncatventures-group/RtspFrames-test](https://github.com/mooncatventures-group/RtspFrames-test)

该站点的源代码`VLC`也无法编译，没有文件。告诉我，是否可以将流录制到视频文件中？它是如何实施的？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T10:32:20.720

您可以使用[FFmpeg](http://ffmpeg.org)来显示 RTSP 视频流。例如，您可以查看我在 github 上托管的[项目。](https://github.com/kolyvan/kxmovie)它是使用 ffmpeg 和 OpenGLES 的 iOS 电影播放器​​。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-13T22:01:32.887

对我来说，最好的选择是 [https://github.com/durfu/DFURTSPPlayer](https://github.com/durfu/DFURTSPPlayer)

是的，它已经很老了，而且不能开箱即用，但是如果您将 mpeg 库更新到 3.0，将项目重构为 ARC 并摆脱不推荐使用的 mpeg 方法，这似乎是一个不错的选择。绝对比 VLC 好。

以上所有内容都可以在这里找到[https://github.com/rozum-dev/DFURTSPPlayer](https://github.com/rozum-dev/DFURTSPPlayer)

# css - IE“允许阻止的内容”分解字体

> ID：12790041
> 
> 赞同：0
> 
> 时间：2012-10-08T21:55:03.540
> 
> 标签：css, fonts

我在 www.fontsquirrel.com 上生成了一些 @font-face 页面

它工作得很好，即使在 IE 上，但 IE 显示它请求允许被阻止的内容（当请求出现时，字体已经加载，看起来没问题）。当您单击“允许”字体时，只需将其更改为默认值或列表中的下一个。

我在squirrel上生成后没有改过，所以代码一定没问题。有什么想法该怎么做吗？

附言。它与 google fonts api 的工作方式相同。

# actionscript-3 - AS3 setInterval 双、三问题

> ID：12790052
> 
> 赞同：0
> 
> 时间：2012-10-08T21:55:39.717
> 
> 标签：actionscript-3, timer, setinterval

我遇到了 setInterval AS3 问题。让我解释一下：我正在制作一个带有计时器的游戏，例如，让我们给出它的实例 timer1.every 500 毫秒 timer1 向左移动 25 次（timer1.x-=25）和当 timer1 hitTests finish1 (if(timer1.hitTestObject(finish1))) 它进入你失去的场景。你必须重播关卡。当我点击重播并进入场景时，setInterval 中的速度会增加一倍，如果我再次失去，三倍等等。如何解决这个问题？我尽快修复它非常重要。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:01:09.727

听起来多个实例`timer1`正在继续运行。

1 个实例`timer1`以原始速度运行。

2 个实例`timer1`以双倍速度运行。等等

确保`timer1`在更改场景之前停止、删除或终止原件。

您可能想要引用该函数`clearInterval`。

# php - Zend Database Mutli 表“选择”通过加入

> ID：12790055
> 
> 赞同：0
> 
> 时间：2012-10-08T21:55:55.537
> 
> 标签：php, zend-framework, postgresql

使用 Zend DB。我试图弄清楚如何使用 DB 类编写这个查询。

```
select 
   org.orgid
   org.role
   user.userid
   user.firstname
from orgTable org
join userTable user on org.userid = user.userid
where org.orgid = 'generated-id' 
```

从我理解或认为我理解如何使用类似 AS 条件的一个定义的文件中，但即便如此我仍然不确定。最终，这将根据跨表条件扩展到多表连接，因此不确定如何开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:02:58.210

我想这就是你要找的

```
$db = Zend_Db::factory( ...options... );

$select = $db->select()
             ->from(array('org' => 'orgTable'),
                    array( 
                        'orgid' => 'org.orgid', 
                        'role'  =>'org.role',
                        'userid'  =>'user.userid',
                        'firstname' =>'user.firstname'
                    ))
             ->join(array('user' => 'userTable'),
                    'org.userid = user.userid',array())
            ->where('org.orgid = ?',$generated_id); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:07:31.947

这是一个`Zend_Db_Select`返回您正在寻找的结果。

```
 $select = $db->select()
                 ->from(array('org' => 'orgTable'), array('orgid', 'role'))
                 ->join(array('user' => 'userTable'), 'org.userid = user.userid', array('userid', 'firstname'))
                 ->where('org.orgid = ?', 'generated-id'); 
```

您可以使用表名的数组表示法来获取查询中的别名。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T06:37:09.187

在**zend 框架 2**中，以下代码可帮助您查找所需内容

```
$generated_id = 1 ;

$select = new \Zend\Db\Sql\Select( array('org' =>'orgTable'));

$select->columns(array('orgid','role') )
       ->join( array('user' => 'userTable'),  
               'org.userid = user.userid', 
               array('userid','firstname')
       )->where( array('org.orgid' => $generated_id ) ); 
```

如果您的适配器平台是 mysql，则用于打印 sql

```
$mysqlPlatform = new \Zend\Db\Adapter\Platform\Mysql();
echo $select->getSqlString(  $mysqlPlatform ); 
```

将 sql 打印为

```
SELECT 
     `org`.`orgid` AS `orgid`, 
     `org`.`role` AS `role`, 
     `user`.`userid` AS `userid`, 
     `user`.`firstname` AS `firstname` 
FROM 
     `orgTable` AS `org` 
         INNER JOIN `userTable` AS `user` 
         ON `org`.`userid` = `user`.`userid` 
WHERE 
     `org`.`orgid` = '1' 
```

# scala - 通过 Scala 使用 Astyanax（Cassandra 客户端）时的类型不匹配

> ID：12790058
> 
> 赞同：1
> 
> 时间：2012-10-08T21:56:33.933
> 
> 标签：scala, types, hector, astyanax

我正在尝试通过 Scala 使用 Java Cassandra 客户端 Astyanax，但收到此编译错误：

```
[error] /massrel/metrics-batcher/src/main/scala/com/massrel/batcher/MetricsWriter.scala:35: type mismatch;
[error]  found   : com.netflix.astyanax.model.ColumnFamily[java.nio.ByteBuffer,java.lang.Long]
[error]  required: com.netflix.astyanax.model.ColumnFamily[java.lang.Comparable[_ >: java.lang.String with java.nio.ByteBuffer <: java.lang.Comparable[_ >: java.lang.String with java.nio.ByteBuffer <: java.lang.Object]],java.lang.Long]
[error] Note: java.nio.ByteBuffer <: java.lang.Comparable[_ >: java.lang.String with java.nio.ByteBuffer <: java.lang.Comparable[_ >: java.lang.String with java.nio.ByteBuffer <: java.lang.Object]], but Java-defined class ColumnFamily is invariant in type K.
[error] You may wish to investigate a wildcard type such as `_ <: java.lang.Comparable[_ >: java.lang.String with java.nio.ByteBuffer <: java.lang.Comparable[_ >: java.lang.String with java.nio.ByteBuffer <: java.lang.Object]]`. (SLS 3.2.10)
[error]     m.withRow(CF_M, "foo").incrementCounterColumn(0, 1)
[error]               ^
[error] /massrel/metrics-batcher/src/main/scala/com/massrel/batcher/MetricsWriter.scala:36: type mismatch;
[error]  found   : com.netflix.astyanax.model.ColumnFamily[java.nio.ByteBuffer,java.lang.Long]
[error]  required: com.netflix.astyanax.model.ColumnFamily[java.lang.Comparable[_ >: java.lang.String with java.nio.ByteBuffer <: java.lang.Comparable[_ >: java.lang.String with java.nio.ByteBuffer <: java.lang.Object]],java.lang.Long]
[error] Note: java.nio.ByteBuffer <: java.lang.Comparable[_ >: java.lang.String with java.nio.ByteBuffer <: java.lang.Comparable[_ >: java.lang.String with java.nio.ByteBuffer <: java.lang.Object]], but Java-defined class ColumnFamily is invariant in type K.
[error] You may wish to investigate a wildcard type such as `_ <: java.lang.Comparable[_ >: java.lang.String with java.nio.ByteBuffer <: java.lang.Comparable[_ >: java.lang.String with java.nio.ByteBuffer <: java.lang.Object]]`. (SLS 3.2.10)
[error]     m.withRow(CF_M, "bar").incrementCounterColumn(0, 1)
[error]               ^ 
```

这是有问题的代码：

```
package com.massrel.batcher

import java.nio.ByteBuffer
import scala.collection.mutable.{Map => MMap}
import com.netflix.astyanax._
import com.netflix.astyanax.impl._
import com.netflix.astyanax.connectionpool._
import com.netflix.astyanax.connectionpool.impl._
import com.netflix.astyanax.thrift._
import com.netflix.astyanax.model._
import com.netflix.astyanax.serializers._

class MetricsWriter {
  val context: AstyanaxContext[Keyspace] = new AstyanaxContext.Builder()
    .forCluster("cluster1")
    .forKeyspace("dev1")
    .withAstyanaxConfiguration(new AstyanaxConfigurationImpl()
        .setDiscoveryType(NodeDiscoveryType.RING_DESCRIBE)
        .setConnectionPoolType(ConnectionPoolType.TOKEN_AWARE)
    )
    .withConnectionPoolConfiguration(new ConnectionPoolConfigurationImpl("connectionpool1")
        .setPort(9160)
        .setMaxConnsPerHost(1)
        .setSeeds("127.0.0.1:9160")
    )
    .withConnectionPoolMonitor(new CountingConnectionPoolMonitor())
    .buildKeyspace(ThriftFamilyFactory.getInstance());
  context.start()

  val keyspace = context.getEntity()
  val CF_M = new ColumnFamily[ByteBuffer, java.lang.Long]("M", ByteBufferSerializer.get(), LongSerializer.get())

  def writeTest() {
    val m = keyspace.prepareMutationBatch()
    m.withRow(CF_M, "foo").incrementCounterColumn(0, 1)
    m.withRow(CF_M, "bar").incrementCounterColumn(0, 1)
    m.execute()
  }
} 
```

我可以在我的代码中做些什么来解决这个问题？

如果有帮助，您可以在此处查看 Astyanax 代码：[https ://github.com/Netflix/astyanax](https://github.com/Netflix/astyanax)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:31:54.150

来自`MutationBatch.java`：

```
<K, C> ColumnListMutation<C> withRow(ColumnFamily<K, C> columnFamily, K rowKey); 
```

所以你`rowKey`的类型必须与你的第一个类型参数相同`ColumnFamily`。你的是 a`ColumnFamily[ByteBuffer, java.lang.Long]`并且你已经通过了它`"foo"`，这是 a `String`，而不是 a `ByteBuffer`。

# bash - 来自 cron 的电子邮件缺少脚本输出中的换行符，为什么？

> ID：12790062
> 
> 赞同：2
> 
> 时间：2012-10-08T21:57:18.507
> 
> 标签：bash, cron

我有一个执行 shell 脚本的 crontab，如果有输出，我希望在我的电子邮件中看到输出：

这是 crontab 条目的样子：

```
*/2 * * * * /bin/check_perms.sh 
```

实际脚本如下所示：

```
#!/bin/bash
declare -a fix_dirs

fix_dirs=(`cat $(dirname $0)/dirs_to_fix.txt`)

for dir in "${fix_dirs[@]}"; do
   find $dir -type d ! -perm -go=xw -exec stat -c '%U %n %A' {} +
   find $dir -type f ! -perm -go=w -exec stat -c '%U %n %A' {} +
done 
```

我猜测 find 的输出是问题所在，但如果我重定向到一个文件，该文件有换行符。当我收到来自 cron 的电子邮件时，它缺少 find 返回的文件之间的所有换行符。

更新：这只是一个邮件客户端“问题”我在这里找到了一种禁用 Outlook 行为的方法：http: [//support.microsoft.com/kb/287816](http://support.microsoft.com/kb/287816)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T22:01:18.443

您的电子邮件客户端很可能正在删除换行符。尝试查看电子邮件客户端中的消息源。

# python - Python DateTimeType sybase

> ID：12790065
> 
> 赞同：0
> 
> 时间：2012-10-08T21:57:37.727
> 
> 标签：python, database

当我使用 python Sybase 包并执行游标 fetch() 时，其中一列是日期时间 - 在返回的序列中，它具有该值的 DateTimeType 对象。我可以在 sybasect 模块中找到它，但找不到此数据类型的任何文档。我希望能够将其转换为字符串输出 - 类似于将 strftime() 与 datetime 对象一起使用。
有这方面的信息吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T00:45:36.273

您最好的选择是安装[egenix-mx-base](http://pypi.python.org/pypi/egenix-mx-base)软件包。这将使[mxDateTime](http://www.egenix.com/products/python/mxBase/mxDateTime/doc/%5d)模块可用于`sybase`包，默认情况下，*所有日期时间列将作为`mxDateTime.DateTime`对象*返回（引用自`sybase`包文档）。

正如您将能够在[mxDateTime](http://www.egenix.com/products/python/mxBase/mxDateTime/doc/%5d)文档中验证的那样，获取您的字符串输出将很容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-03T15:49:25.330

核心问题是 DateTimeType 对象与 datetime 对象中指定月份的方式不同。

我写了一个小函数来处理这个问题。这样就不需要安装额外的模块，也不需要额外的 DateTime 转换。

欢迎对代码进行任何改进:-)

```
def ps_datetime_converter(date_time_type_object):
    # Convert from python-sybase DateTimeType format (months 0 to 11) to datetime type format
    try:
        dt_kwargs = {}
        dt_kwargs['year'] = date_time_type_object.year
        dt_kwargs['month'] = date_time_type_object.month + 1
        dt_kwargs['day'] = date_time_type_object.day
        dt_kwargs['hour'] = date_time_type_object.hour
        dt_kwargs['minute'] = date_time_type_object.minute
        dt_kwargs['second'] = date_time_type_object.second
        dt_kwargs['microsecond'] = date_time_type_object.msecond
        date_time_object = datetime(**dt_kwargs)
        return date_time_object
    except:
        print "Conversion from DateTimeType object to datetime object failed." 
```

# heroku - POST 请求的请求超时 (H-12)

> ID：12790067
> 
> 赞同：1
> 
> 时间：2012-10-08T21:57:49.917
> 
> 标签：heroku, timeout

我们在 Heroku 上的暂存服务器上遇到了一个有趣的问题。每个 post/put/delete 请求都会冻结大约 10 秒或更长时间，其中一些最终会超时，从而导致 Heroku H-12 超时错误。另一个有趣的细节：请求似乎在超时后被处理，因为数据库记录得到更新。我们不处理大数据，我们只是尝试更新数据库中一条记录上的一个字段。我们的本地环境（localhost:3000）工作正常。我们没有任何阻止操作（发送电子邮件、处理大型查询……）我们尝试过激活/停用缓存（dalli）、资产编译，我们已经切换了登台服务器的实例。我们在 staging.rb 中尝试了不同的设置。

关于我们如何尝试解决此问题的任何建议？

```
2012-10-08T21:32:15+00:00 app[web.1]: Started PUT "/users/151" for 67.180.34.143 at 2012-10-08 21:32:15 +0000
2012-10-08T21:32:15+00:00 app[web.1]: Processing by UsersController#update as HTML
2012-10-08T21:32:15+00:00 app[web.1]:   Parameters: {"utf8"=>"✓", "authenticity_token"=>"n4xK0Esi2zgBqSRtDTu3IEhnUAv0//bAkjLnKyk7xFk=", "user"=>{"role"=>"2", "designer_status"=>"1", "invitation_limit"=>"56"}, "commit"=>"Update", "id"=>"151"}
2012-10-08T21:32:45+00:00 heroku[router]: Error H12 (Request timeout) -> POST ziba-exygy-2.herokuapp.com/users/151 dyno=web.1 queue= wait= service=30000ms status=503 bytes=0
2012-10-08T21:32:46+00:00 app[web.1]: Redirected to https://ziba-exygy-2.herokuapp.com/users
2012-10-08T21:32:46+00:00 app[web.1]: Completed 302 Found in 30304ms (ActiveRecord: 53.7ms)
2012-10-08T21:32:46+00:00 app[web.1]: cache: [POST /users/151] invalidate, pass
2012-10-08T21:32:46+00:00 app[web.1]:   User Load (3.7ms)  SELECT `users`.* FROM `users` WHERE `users`.`id` = 42 LIMIT 1
2012-10-08T21:32:46+00:00 app[web.1]:   User Load (12.3ms)  SELECT `users`.* FROM `users` WHERE `users`.`id` = 151 LIMIT 1
2012-10-08T21:32:46+00:00 app[web.1]:    (2.8ms)  BEGIN
2012-10-08T21:32:46+00:00 app[web.1]:   User Exists (3.2ms)  SELECT 1 FROM `users` WHERE (`users`.`email` = BINARY 'pierre+tttttttttt@blablabla.com' AND `users`.`id` != 151) LIMIT 1
2012-10-08T21:32:46+00:00 app[web.1]:    (3.1ms)  COMMIT
2012-10-08T21:32:46+00:00 app[web.1]:    (2.7ms)  BEGIN
2012-10-08T21:32:46+00:00 app[web.1]:   CACHE (0.0ms)  SELECT 1 FROM `users` WHERE (`users`.`email` = BINARY 'pierre+tttttttttt@ blablabla.com' AND `users`.`id` != 151) LIMIT 1
2012-10-08T21:32:46+00:00 app[web.1]:    (11.6ms)  UPDATE `users` SET `invitation_limit` = 56, `updated_at` = '2012-10-08 21:32:31' WHERE `users`.`id` = 151
2012-10-08T21:32:46+00:00 app[web.1]:    (2.9ms)  COMMIT 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T21:05:59.470

事实证明，我们的登台服务器并未包含实时服务器拥有的所有 Heroku 附加组件。缺少的附加组件之一是飞行狮身人面像。我们的一些模型假设 Sphinx 在那里，并会尝试使用它来导致这种行为。

# ios - 如何使用 twitter iOS API 共享网络图像？

> ID：12790069
> 
> 赞同：1
> 
> 时间：2012-10-08T21:58:15.303
> 
> 标签：ios, twitter

我有一个 iPhone 应用程序，我希望用户能够发布应用程序显示的图像。图片已经上线了。我想知道我可以让本地推文表在用户键入推文时向他们显示图像。

我知道你可以这样做 [tweetSheet addImage:[UIImage imageNamed:@"image.png"]] 但这仅适用于您在发推文时上传到推特的本地图像，对吗？

# silverlight - 找不到已安装的 Silverlight 开发者运行时版本

> ID：12790071
> 
> 赞同：1
> 
> 时间：2012-10-08T21:58:20.327
> 
> 标签：silverlight, visual-studio-2012, silverlight-5.0, visual-studio-lightswitch

在以下环境中：

-VS2012

-Windows 7 64 位

-微软 Silverlight 5 SDK

我在 VS2012 中创建了一些灯开关应用程序，但在尝试创建新应用程序或打开现有灯开关项目时遇到错误。我收到一个弹出窗口，上面写着“无法找到已安装的 silverlight 开发者运行时版本”。

弹出窗口中有一个开始下载的链接，但下载后，我仍然收到相同的错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-08T22:18:33.173

我能够通过执行以下操作来解决此问题：

*   我进入“卸载程序”并注意到我安装了 4 个不同的 Silverlight 相关项目。

    *   微软银光

    *   微软 Silverlight SDK3

    *   微软 Silverlight SDK4
    *   微软 Silverlight SDK5

我刚刚卸载了第一个项目“Microsoft Silverlight”，然后从以下链接重新安装了相应的（32 位或 64 位）Microsoft Silverlight SDK5： [http](http://www.silverlight.net/downloads) ://www.silverlight.net/downloads 。

不要使用 VS 2012 中给出的链接。不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T10:31:52.067

对于 Visual Studio 2010，我有一个稍微不同的解决方案。卸载当前的 Silverlight 运行时后，如果我从 Visual Studio 建议的 url 下载它，我就能让它工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-27T15:37:14.697

我发现找到最新 Silverlight 5 Developer Runtime 或 End-User Runtime 的最佳方法是在下载中搜索最新的 Silverlight 位。根据您使用的 Visual Studio 或操作系统版本，所有其他建议似乎会让您大吃一惊。

[搜索 Microsoft 下载](http://search.microsoft.com/en-us/DownloadResults.aspx?q=silverlight&sortby=-availabledate)

只需查找最新的“Microsoft Silverlight 安全更新”条目即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-08T17:35:25.780

Silverlight 安全更新 KB2890788 为我修复了它，在尝试卸载并重新安装但没有成功之后。

# javascript - 如何制作 Angularjs 嵌套路由？

> ID：12790075
> 
> 赞同：9
> 
> 时间：2012-10-08T21:58:31.970
> 
> 标签：javascript, url-routing, angularjs

我是 angular 新手，我想知道 angularjs 是否支持像 emberjs 这样的嵌套路由，我的意思是这样的路由：`myappurl/#/company/:company_id/department/:department_id`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-15T10:15:39.720

值得一提的是，除了`ui-router`完成这项任务外，还有另一个 Angular 库。这个也有效：

[http://angular-route-segment.com](http://angular-route-segment.com)

使用起来比ui-router简单多了。示例路由配置如下所示：

```
$routeSegmentProvider.

when('/section1',          's1.home').
when('/section1/prefs',    's1.prefs').
when('/section1/:id',      's1.itemInfo.overview').
when('/section1/:id/edit', 's1.itemInfo.edit').
when('/section2',          's2').

segment('s1', {
    templateUrl: 'templates/section1.html',
    controller: MainCtrl}).

within().

    segment('home', {
        templateUrl: 'templates/section1/home.html'}).

    segment('itemInfo', {
        templateUrl: 'templates/section1/item.html',
        controller: Section1ItemCtrl,
        dependencies: ['id']}).

    within().

        segment('overview', {
            templateUrl: 'templates/section1/item/overview.html'}).

        segment('edit', {
             templateUrl: 'templates/section1/item/edit.html'}).

        up().

    segment('prefs', {
        templateUrl: 'templates/section1/prefs.html'}).

    up().

segment('s2', {
    templateUrl: 'templates/section2.html',
    controller: MainCtrl}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-08T22:35:41.827

根据文档中给出的示例：[https](https://docs.angularjs.org/api/ngRoute/directive/ngView) ://docs.angularjs.org/api/ngRoute/directive/ngView 。是的，Angularjs 支持它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-25T09:06:59.597

也值得一试[https://github.com/angular-ui/ui-router](https://github.com/angular-ui/ui-router)

# php - CodeIgniter 'get' 表单动作？

> ID：12790076
> 
> 赞同：0
> 
> 时间：2012-10-08T21:58:38.320
> 
> 标签：php, codeigniter

我在页面（视图）上有一个表单，它的 URL 是：

> www.example.com/page?item=samsung-galaxy-nexus

我在此页面（视图）上的表格是：

```
<form name="formsearch" action="<?php echo site_url(uri_string()); ?>" method="get">
<input id= name="search"name="search" class="filter-search" type="text" placeholder="Search Me"/>
<button type="submit" class="filter-button">Search</button>
</form> 
```

因此，假设我在搜索中输入“Microsoft”并按 Enter。我需要它去的 URL + 查询字符串是：

> www.example.com/page?item=samsung-galaxy-nexus&search=microsoft

我可以让它与普通的 PHP 一起工作，但是我似乎无法让它在 CodeIgniter 中工作。我还进入了 config.php 并将查询 url 设置为 true。

还需要注意的是，如果当前的 URL 是：

> www.example.com/page?item=samsung-galaxy-nexus

如果我这样做`<?php echo current_url(); ?>`输出

> www.example.com/?page

注意如何？交换了位置

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T13:10:52.700

我根本无法让这个工作。最后我使用了一个 CodeIgniter 3rd Party Helper 在[这里](http://getsparks.org/packages/query_string_helper/versions/HEAD/show)找到：

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-08T22:16:30.360

转到：application/config/config.php（在第 72 行左右）并更改

```
$config['uri_protocol'] = 'AUTO'; 
```

至

```
$config['uri_protocol'] = 'PATH_INFO'; 
```

或者

```
$config['uri_protocol'] = 'QUERY_STRING'; 
```

它应该对你有用，如果没有尝试 'REQUEST_URI' 或 'ORIG_PATH_INFO'

如果你仍然有这个问题，你可以简单地重建 $_GET 请求（在你的基本 Controller 的构造函数中），如下所示：

```
 parse_str($_SERVER['QUERY_STRING'],$_GET); 
```

# java - Criteria Eager fetch-joined 集合以避免 n+1 选择

> ID：12790080
> 
> 赞同：13
> 
> 时间：2012-10-08T21:59:11.783
> 
> 标签：java, hibernate, hibernate-criteria

假设 Item 和 Bid 是实体：一个 Item 有很多 Bid。它们在**Hibernate**中以典型的父/子关系映射：

```
<class name="Item" table="ITEM">
  ...
  <set name="bids" inverse="true">
    <key column="ITEM_ID"/>
    <one-to-many class="Bid"/>
  </set>
</class> 
```

在执行此查询后尝试访问每个项目的出价时，如何避免 n+1 选择？

```
List<Item> items = session.createCriteria(Item.class)
                        .createAlias("bids", "b").
                        .add(Restrictions.gt("b.amount", 100)).
                        .list(); 
```

**请注意**，我需要*急切地获取*出价，但***对集合有进一步的限制***（b.amount > 100）

我尝试了以下失败：

```
List<Item> items = session.createCriteria(Item.class)
                        .setFetchMode("bids", FetchMode.JOIN).
                        .createAlias("bids", "b").
                        .add(Restrictions.gt("b.amount", 100)).
                        .list();                        

List<Item> items = session.createCriteria(Item.class)
                        .createCriteria("bids")
                        .add(Restrictions.gt("amount", 100)).
                        .list(); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-08T22:25:50.610

这个条件查询似乎是正确的：

```
 List<Item> items = session.createCriteria(Item.class)
                    .setFetchMode("bids", FetchMode.JOIN)
                    .createAlias("bids", "b")
                    .add(Restrictions.gt("b.amount", 100))
                    .list(); 
```

`FetchMode.JOIN`是为了解决`n+1`问题。你有没有定义一些 `default_batch_fetch_size`| `batch-size`映射或配置中的任何位置，这是反向影响？

如果没有，您能否尝试以下 HQL 并看到这解决了您的问题？

```
 Query query = 
      session.createQuery("from Item it left join it.bids b where b.amount=:bids");
 query.setParamter(bids, 100);
 List<Item> items = query.list(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-09T15:15:28.070

这是对为什么对 fetch-joined 集合添加限制会导致集合未初始化的解释（**请注意**，没有限制的相同查询会为集合产生急切的 fetch）：

> “如果您在表 A 和 B 之间存在 1:n 关系，并且您向 B 添加了一个限制并想急切地获取 A 和 B，那么问题是当您想从 A 导航到 B 时会发生什么。如果您只看到 B 中与限制匹配的数据，还是应该看到所有与 A 相关的 B？” [在这里查看更多...](https://forums.hibernate.org/viewtopic.php?f=1&t=944439&sid=7f975b6c31faab79ed28dee887f6606e)

但是，使用 HQL 而不是标准，获取部分投标集合

```
List<Item> items = session.createQuery(
          "from Item i left join fetch i.bids b where b.amount > :amount")
          .setParameter("amount", 100)
          .list(); 
```

*在我看来这是一个不一致的地方，但这就是它的工作原理*

顺便说一句，如果您需要的是父母及其所有孩子的列表，而只是孩子都符合一定限制的父母，那么您可以使用这个

```
List<Item> items = session.createQuery(
          "from Item i left join fetch i.bids b " +
          "where not exists (from Bid b where b.item = i and b.amount <= :amount)")
          .setParameter("amount", 100)
          .list(); 
```

这是一个相关的帖子：[休眠查询未返回完整对象](https://stackoverflow.com/questions/2147769/hibernate-query-not-returning-full-object?answertab=active#tab-top)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-02T15:44:49.100

我认为您需要的是在另一个条件上使用子查询的条件。类似的答案在这里： [https ://stackoverflow.com/a/15768089/1469525](https://stackoverflow.com/a/15768089/1469525)

```
DetachedCriteria criteria = session.createCriteria(Item.class, "i");
criteria.setFetchMode("bids", FetchMode.JOIN);

DetachedCriteria bidCriteria = DetachedCriteria.forClass(Bid.class, "b");
bidCriteria.add(Restrictions.gt("amount", 100));
bidCriteria.add(Restrictions.eqProperty("b.itemId", "i.id"));
criteria.add(Subqueries.exists(bidCriteria.setProjection(Projections.property("b.id")))); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-03-12T14:18:13.800

试试这个代码。它解决了我的问题。

```
List<Item> items = session.createCriteria(Item.class)
                .setFetchMode("bids", FetchMode.SELECT)
                .createAlias("bids", "b")
                .add(Restrictions.gt("b.amount", 100))
                .list(); 
```

# php - MySQL 数据库连接适用于 Live Server，但不适用于 Test Server

> ID：12790081
> 
> 赞同：0
> 
> 时间：2012-10-08T21:59:24.787
> 
> 标签：php, mysql, database-connection

我有一个特殊的情况，数据库连接在实时服务器上工作，但不在我的本地计算机上。

我有以下连接脚本来访问我的本地计算机（运行 WAMP）以及实时服务器上的数据库：

```
function GetGlobalConnectionOptions()
{
    return array(
      'server' => 'localhost',
      'port' => '3306',
      'username' => 'sample_username',
      'password' => 'sample_password',
      'database' => 'sample_database'
); 
```

我可以很好地连接到实时服务器数据库。但是，我无法连接到测试计算机上的 localhost 数据库。这是我收到的错误：

```
Could not connect to localhost: 
Access denied for user ''@'localhost' to database 'sample_database' 
```

我不明白它如何在我的本地主机上不起作用。另外，我担心它说用户是''@'localhost'而不是sample_username@localhost。可能这是问题的一部分，但我被困住了。任何建议将不胜感激。

仅供参考，我在每个数据库中都设置了两个用户名，并授予了所有权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:24:53.023

在标准安装中，本地主机上的用户必须有明确的授权。所以 user@% 有访问权限是不够的，它必须是`user@localhost`. 以管理员身份输入`grant all privileges on * to user@localhost identified by 'password'; flush privileges;`

# php - 检查字符串的第一个字符是否为字母的函数

> ID：12790082
> 
> 赞同：3
> 
> 时间：2012-10-08T21:59:36.297
> 
> 标签：php, regex

我做了这个函数来检查第一个字符是否是字母。

```
function isLetter($string) {
  return preg_match('/^\s*[a-z,A-Z]/', $string) > 0;
} 
```

但是，如果我检查以 coma () 开头的句子，`,`则函数返回`true`。检查第一个字母是 az 还是 AZ 的正确正则表达式是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-08T22:00:19.960

您只需要删除逗号：

```
'/^\s*[a-zA-Z]/' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:05:49.607

在我看来，一种更清洁的方式。只是使代码更具人类可读性。

```
 function isLetter($string) {
    return preg_match('/^[a-z]/i', trim($string));
} 

```

# javascript - 在 IE 中导致错误的 Javascript 变量或新函数

> ID：12790083
> 
> 赞同：0
> 
> 时间：2012-10-08T22:00:02.687
> 
> 标签：javascript

嘿伙计们，我在 Internet Explorer 中遇到了这个声明的问题，我想知道是否有更明智的方法来做到这一点？

```
var NEWVARIABLE = NEWVARIABLE || {};
NEWVARIABLE.Tools = NEWVARIABLE.Tools || {}; 
```

它给了我`NEWVARIABLE`不存在的错误

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T22:01:43.280

您不能使用（或测试）未定义的变量。我最初认为这就是您对以下语句所做的事情

```
var NEWVARIABLE = NEWVARIABLE || {}; 
```

然而，多亏了 Fabrício，我意识到 var 声明被提升了（移动到脚本标签的顶部，因此在它遇到语句时已经声明了。

测试变量是否用于`typeof === 'undefined'`查看变量是否存在的不太容易混淆的方法

```
var NEWVARIABLE;
if (typeof NEWVARIABLE === 'undefined') {
    NEWVARIABLE = {};
} 
```

检查属性时可以使用相同的样式，不必`typeof`对属性使用测试，即使它们没有定义，也可以测试它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:27:44.270

您已接受答案，但其中包含误导性陈述：

> 您不能使用（或测试）未定义的变量。这就是你正在做的

该变量已声明，所以它不是你在做什么。

在OP中，代码：

```
> var NEWVARIABLE = NEWVARIABLE || {};
> NEWVARIABLE.Tools = NEWVARIABLE.Tools || {}; 
```

不包含语法错误，它会抛出错误的唯一情况是如果 NEWVARIABLE 已经存在并且具有在尝试访问或分配给它时抛出错误的 Tools 属性（某些主机对象可能会发生）。

如果`NEWVARIABLE`之前已经分配了一个原生对象或原始值，它不会抛出错误，尽管结果可能不是你所期望的。

# compression - 无损压缩理论，压缩比是否基于模式大小和重复次数？

> ID：12790084
> 
> 赞同：0
> 
> 时间：2012-10-08T22:00:10.097
> 
> 标签：compression, binary-data, huffman-code, lzw, lossless

我想知道以下哪种场景将无损算法应用于具有重复数据的二进制数据的最高比率。

我是否正确假设压缩比取决于模式？

1.  尺寸
2.  多次重复

例如二进制数据：

10 10 10 10 10 10 10 10 图案 (10) 尺寸 2，图案 (10) 重复 8

1001 1001 1001 1001图案（1001）尺寸4，图案（1001）重复4

0000000 11111111 图案（0）尺寸1，图案（0）重复8；图案（1）尺寸1，图案（1）重复8；或 0000000 11111111 模式 (0000000) 大小 8，模式 (0000000) 重复 8；图案 (11111111) 尺寸 8，图案 (11111111) 重复 1；

以上哪个实现了最高和最低的压缩比？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T01:41:16.700

这些都是在野外不太可能看到的序列。这个问题的重点是什么？

普通的压缩器是面向字节的。因此，任何导致相同字节重复的模式都将提供最高的压缩率。例如，放气限制中的 1032:1。短模式的其他简单重复将获得非常高的压缩比。例如，对于两个或三个重复字节的模式，再次使用 1032:1 进行放气。

在这些荒谬的极端情况下，压缩限制是压缩格式的函数，而不是数据的函数。

# python - python virtualenv ImportError 没有名为检查时间烧瓶的模块

> ID：12790092
> 
> 赞同：5
> 
> 时间：2012-10-08T22:00:51.330
> 
> 标签：python, flask, virtualenv, configure, importerror

我最近从磁盘上删除了一些旧的开发文件夹，现在我的一个 virtualenv 项目不起作用。当我尝试导入烧瓶时，我注意到了这个问题。

我正在使用 Ubuntu，我在 virtualenv 中使用 python2.7 而不是默认 python 的 python2.6。

我将描述我是如何修复它的，但我想知道是否有更好的方法。

仅供参考，我默认在终端中使用 bash ......

[从http://www.python.org/download/releases/2.7/](http://www.python.org/download/releases/2.7/)下载源

将源文件移动到 /project/src/dir 并解压

将终端的工作目录更改为新提取的目录

配置和制作

```
mkdir python2.7
./configure --prefix=/project/src/dir/python2.7
make
make install 
```

创建 virtualenv 并指定要使用的 python

```
virtualenv --no-site-packages -p /project/src/dir/python2.7/bin/python2.7 projectname 
```

进入虚拟环境

```
cd projectname
source bin/activate 
```

如果你想要的话，得到烧瓶

```
pip install flask 
```

测试看看我们是否可以导入时间并检查

（重击）

```
python 
```

（蟒蛇壳）

```
import time
import inspect 
```

测试是否可以导入flask

```
import flask 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T22:47:09.103

也许您之前正在使用 --system-site-packages 并且可以通过 VirtualEnv 外部的路径使用烧瓶。

请记住，如果旧版本的 VirtualEnv 完全移动，它们也不是很可重定位。

# ruby-on-rails - 在 RSpec/Rails 验收测试中，有没有办法将消息推送到 RSpec 输出并保持良好的缩进？

> ID：12790100
> 
> 赞同：4
> 
> 时间：2012-10-08T22:01:30.590
> 
> 标签：ruby-on-rails, rspec

我的验收测试（RSpec/Capybara）在一个`it...do`块下有一些很长的步骤序列，我想手动将每个步骤的一些附加文档添加到 RSpec 文档输出中。

因此，RSpec 输出（以文档格式）当前如下所示：

```
FooController
  New user creates account and creates profile
    it passes 
```

在漫长的步骤序列中，我想将一些附加信息推送到输出：

```
FooController
  New user creates account and creates profile
    ... new user saw signup page!
    ... new user got email confirmation!
    ... confirmation link worked!
    ... new user saw empty profile!
    ... new user filled in profile
    it passes 
```

在记录应用程序方面，这些额外的语句比带有单个“它通过”结果消息的大黑匣子要好。

由于显然没有办法使用多个`it...do`块来构建验收测试的长序列，我希望有一种简单的方法可以将附加消息推送到 RSpec 输出流，理想情况下它们被缩进和显示（红色/green) 好像它们是 pat 或单独的`it...do`示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-03T16:17:15.337

最终，我选择了自定义[DocumentationFormatter](https://github.com/rspec/rspec-core/blob/master/lib/rspec/core/formatters/documentation_formatter.rb)，方法是在文件夹中的某处包含以下代码`spec/support`（以确保自动加载）：

```
require "rspec/core/formatters/documentation_formatter"

class RSpec::Core::ExampleGroup
  def step(msg)
    example.metadata[:step_messages] << msg if example.metadata[:step_messages]
    yield
  end
end

class RSpec::Core::Formatters::DocumentationFormatter
  def example_started(example)
    example.metadata[:step_messages] = []
  end

  def example_passed(example)
    output.puts passed_output(example)
    print_steps(example)
  end

  private
    def print_steps(example)
      example.metadata[:step_messages].each do |msg|
      output.puts detail_color("#{'  ' * (@group_level + 1)}#{msg}")
    end
  end
end 
```

通过这个技巧，您可以获得一种`step`可以在您的`it`块中使用的方法。运行 rspec 时，将打印出`--format documentation`来自块的相关消息，并适当缩进。`step`例如下面的代码

```
it "should show all and only appoved posts" do
  step "show all approved posts" do
    Post.all.approved.each do |post|
      should have_content(post.title)
    end
  end
  step "show only approved posts" do
    should have_selector(".post", count: Post.all.approved.count)
  end
end 
```

将产生以下输出（步骤字符串以浅蓝色着色）：

```
should show all and only appoved posts
  show all approved posts
  show only approved posts 
```

诚然，这是一个非常粗略的解决方案，但通过多做一些工作，它可能会变得更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T01:46:19.693

这就是我所做的...在我的规范中添加了一个 nextstep("message") 方法，该方法使用 awesome_print gem 将“消息”输出到控制台，这样我就可以给它上色，也可以给记录器上色。

```
 def nextstep(txt)
    $step += 1
    @speclog.debug ''
    @speclog.debug ''
    @speclog.debug "#{$scene}, step: #{$step}: " + txt
    ap (' ' * ($indent * 2 - 1)) + "step: #{$step}: " + txt, {:color => {:string => :blueish}}
  end 
```

有点骇人听闻，但它确实在运行 rspec 时为我们提供了非常好的描述性输出，例如，如果我们有

```
it "New user creates account and creates profile" do
   # some assertions
   nextstep "... new user saw signup page!"
   # some assertions
   nextstep " ... new user got email confirmation!"
   # some assertions
   nextstep " ... confirmation link worked!"
   # some assertions
   nextstep "... new user saw empty profile!"
   # some assertions
   nextstep "... new user filled in profile"
end 
```

如问题所示，我们得到更具描述性的规范输出（如果出现故障，我们会看到我们正在执行的步骤）：

```
 step 1: ... new user saw signup page!
   step 2: ... new user got email confirmation!
   step 3: ... confirmation link worked!
   step 4: ... new user saw empty profile!
   step 5: ... new user filled in profile" 
```

# php - 检测到javascript后重定向

> ID：12790101
> 
> 赞同：2
> 
> 时间：2012-10-08T22:01:38.163
> 
> 标签：php, javascript, html, redirect

我是 Web 开发的新手，去年将我的公司网站更改为使用大量 js 的单页网站，以便用户可以同时完成许多任务而无需离开首页。虽然我的用户似乎真的很喜欢新布局，但我没有意识到这会对我的 SEO 产生影响，我完全退出了谷歌搜索。

因此，在我网站的这个新版本中，我正在检测用户是否启用了 js。例如，如果用户链接到`www.myAddress.com/howItWorks.php`并且禁用了 js，例如 google bot，他们将能够使用查看内容。但是，如果他们启用了 js，我想重定向到我的主页`www.MyAddress.com`，它仍然是单页布局。本质上，我只希望谷歌（以及少数禁用 js 的人）看到旧布局，而其他人都使用更新的东西。

我听说元重定向很难与 SEO 一起使用，并且一些搜索引擎会忽略使用它们的网站，因为它们是垃圾邮件发送者的常用工具。

*   如果我在检测到用户启用了 js 后使用元重定向，会伤害我的 SEO 吗？
*   还有什么我应该使用的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:08:12.260

> 还有什么我应该使用的吗？

是的，一点没错。

[使用渐进增强](http://en.wikipedia.org/wiki/Progressive_enhancement)的原则构建网站。使用[不显眼的 JavaScript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)来帮助实现这一点。使用[pushState 和朋友](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)为动态更改的内容提供有状态的 URI，这些内容映射到无需 JavaScript 即可工作的真实 URI。

不要试图维护网站的两个完全独立的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:33:32.180

我不建议使用 javascript 尝试向 Google 展示与普通用户不同的内容视图，因为您会发现这会对您的 SEO 性能产生进一步的负面影响。

如果这个网站的一部分是高度互动的并且主要针对现有客户，我会阻止谷歌索引这个页面，并使用你想要吸引新客户的内容构建一组单独的页面。使用良好的 SEO 实践构建这些页面，并且通过一些努力，您应该能够恢复您的 SEO 排名。

# javascript - jQuery UI 自动完成 - 我可以更改搜索的位置吗？

> ID：12790104
> 
> 赞同：2
> 
> 时间：2012-10-08T22:01:44.887
> 
> 标签：javascript, jquery, json, jquery-ui

我正在尝试实现自动完成。到目前为止，我已经克服了一个障碍：沿着可选项目显示自定义信息。就此而言，我使用 JSON 对象传递数据。就像这样：

```
[{"codigo":"XL","descripcion":"Extra Large"},{"codigo":"M","descripcion":"Medium"},{"codigo":"S","descripcion":"Small"},{"codigo":"L","descripcion":"Large"}] 
```

现在初始化代码是：

```
$this->template->add_js("$.getJSON(\"".base_url('talles/listar')."\", 
            function(data)
            {
                $('#txt_talle')
                    .autocomplete(
                        {
                            minLength: 0,
                            source: data,
                            focus: function(event, ui) { 
                                $('#txt_talle').val(ui.item.codigo);
                                return false;
                            },
                            select: function(event, ui) {
                                $('#txt_talle').val(ui.item.codigo);
                                return false;
                            }
                        })
                    .focus(function(){ $('#txt_talle').autocomplete('search') })
                    .data('autocomplete')._renderItem = function(ul, item) {
                        return $('<li></li>')
                        .data('item.autocomplete', item)
                        .append('<a>' + item.codigo + '|' + item.descripcion + '</a>')
                        .appendTo(ul);
                    }
                ;
            });", 'embed'); 
```

但现在的问题是搜索不起作用。我猜这不起作用，因为它搜索对象，而不是对象*内部*。我想让它在 item.codigo 值中搜索。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T22:20:01.613

查看 jQuery 自动完成小部件中的“源”选项：http: [//api.jqueryui.com/autocomplete/#option-source](http://api.jqueryui.com/autocomplete/#option-source)。它要么需要一个字符串数组，要么需要一个具有`label`和`value`属性的对象数组。

尝试向talles/listar 服务器调用中返回的 JSON 数组的每个项目添加`label`和属性。`value`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:31:26.460

Maybe add it like this

```
$.getJSON("URL", function(data){
    var autoc = [];
    for (row in data) {
        if (data.hasOwnProperty(row)) {
            autoc[] = {
                'label': row.codigo,
                'value': row.descripcion
            }
        } 
    }
    $('#txt_talle').autocomplete({
            minLength: 0,
            source: autoc,
            focus: function(event, ui) { 
                $('#txt_talle').val(ui.item.codigo);
                return false;
            },
            select: function(event, ui) {
                $('#txt_talle').val(ui.item.codigo);
                return false;
            }
    }).focus(function(){
        $('#txt_talle').autocomplete('search')
    }).data('autocomplete')._renderItem = function(ul, item) {
        return $('<li></li>')
        .data('item.autocomplete', item)
        .append('<a>' + item.codigo + '|' + item.descripcion + '</a>')
        .appendTo(ul);
    };
}); 
```

I'm creating a new object based on your data object feeding the right label, value keys, as per [@Nick Fishman's Answer](https://stackoverflow.com/questions/12790104/jquery-ui-autocomplete-can-i-change-where-it-searches/12790283#12790283)

# python - 将可接受的值写入 if 语句

> ID：12790106
> 
> 赞同：0
> 
> 时间：2012-10-08T22:01:59.950
> 
> 标签：python, if-statement, boolean, logic

我在让它工作时遇到了一些麻烦，试图评估两个值并导致违反规则，但接受 N/A 作为值相等之外的唯一可接受值。

这是我到目前为止所拥有的。

```
x = value1
y = value2  

if x == "N/A" or x == y: 
    Rule.Violated = False
else:
    Rule.Violated = True 
```

Rule.Violated 是我用来返回错误消息的系统中的内置函数，如果违反规则为假，则不返回错误消息，但我认为 if 语句的结果对于弄清楚逻辑并不重要，但如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:18:18.277

我可能会做这样的事情：

```
if x not in ('N/A', y,):
    raise ValueError('my message') 
```

使用异常处理是处理输入验证的推荐的 Pythonic 方式。

（此外，建议使用内置的异常类型，因为如果提供的异常类型覆盖*整个*stdlib，您将不需要创建新的异常类型）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:06:49.730

那是你要的吗？

```
Rule.Violated = (x != y and x != "N/A") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T23:16:30.663

我想通了，感谢帮助过的人。我的问题是数据类型，下次我有问题时一定要提到数据类型，但是对于那些好奇的人，这里是答案。

必须使用开发人员告诉我的函数将字段作为字符串获取并比较字符串。以前试图将日期时间与字符串进行比较，我的愚蠢举动。FormSet 也是我们系统中的内置参考，我试图避免使用除直接 python 之外的任何东西来提问。

```
x = FormSet.GetFieldString(CurrentForm, “SUM_VALUE_DATE”)
y = FormSet.GetFieldString(CurrentForm, “ORG_APPRAISAL_DATE”)

if x == “N/A” or FormSet.GetDaySpan(x, y) == 0:
            Rule.Violated = False
else:
            Rule.Violated = True 
```

# emacs - 停止 org-mode 重新映射键绑定

> ID：12790109
> 
> 赞同：4
> 
> 时间：2012-10-08T22:02:17.303
> 
> 标签：emacs, org-mode, key-bindings

我有一个我想要的宏`C+'`，并且 org-mode 将它重新映射到`org-cycle-agenda-files`任何`.org`缓冲区，有什么想法可以防止这种情况发生吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T22:33:07.317

我曾经有 ：

```
 (defun org-mode-is-intrusive ()
    ;; Make something work in org-mode:
    ;; (local-unset-key (kbd "something I use"))
    (local-unset-key (kbd "C-'"))
    )
  (add-hook 'org-mode-hook 'org-mode-is-intrusive) 
```

在我`.emacs`处理这样的烦恼。

# .net - Couchbase 客户端在生产服务器上太慢了

> ID：12790110
> 
> 赞同：3
> 
> 时间：2012-10-08T22:02:28.723
> 
> 标签：.net, performance, windows-server-2008-r2, couchbase

我们最近为我们的项目购买了一台新服务器。之后，我注意到 Couchbase 客户端存在性能问题。然后我写了一个简单的加载工具来比较不同机器上的性能：

```
internal class Program {
    private static IMemcachedClient _client;
    private static string _key = "mykey";
    private static bool _value = false;
    private static void Main() {
        _client = new CouchbaseClient();

        _client.Store(StoreMode.Set, _key, _value);
        while (true) {
            _client.Get(_key);
        }
    }
} 
```

在我的开发机器上，此工具每秒可对 localhost memcached 实例进行 35k 次获取。但是在服务器上它要慢得多 - 每秒 4k 获取相同的设置。

这是非常大的差异，我不明白原因。

开发机器配置：

*   Windows 7 专业版 x64
*   酷睿 i7-2600 3.4GHz
*   8Gb 内存

生产服务器配置：

*   Windows 2008 R2 企业版 x64
*   2x 至强 E5645 2.4GHz
*   48Gb 内存

你能帮我理解为什么服务器这么慢吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T00:21:06.123

这是一个硬件问题。六核 Xeon 或主板。Hoster 更改了它们，现在问题已解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T09:58:48.383

我认为生产服务器并不慢。我想当您使用开发服务器运行测试时，您会通过 localhost 运行。本地主机比真正的网络接口快得多。

# python - Python - 为什么这个类变量没有在方法中定义？

> ID：12790114
> 
> 赞同：14
> 
> 时间：2012-10-08T22:03:01.277
> 
> 标签：python, variables, scope

我有一个 python 应用程序，如下所示：

```
global_counter = 0
connections = {}

class SocketHandler():
    currentid = 0
    def open(self):
        global global_counter
        global connections
        currentid = global_counter
        global_counter += 1
        connections[currentid] = self
        print "WebSocket " + str(currentid) + " opened"

    def on_close(self):
        global connections
        print "WebSocket " + str(currentid) + " closed"
        del connections[currentid] 
```

我收到错误：

```
NameError: global name 'currentid' is not defined 
```

在“打开”和“on_close”的行上，我打印我正在打开/关闭连接。我在课堂上定义的，为什么不在范围内。另外，我已经读过使用全局变量是不好的，但我没有看到解决这个问题的方法。有人可以指出我应该做什么吗？谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-08T22:21:44.177

在 Python 中，您没有对方法内部属性的隐式访问权限。

`currentid`像一行中的一个裸名：

```
del connections[currentid] 
```

总是在本地函数作用域中查找名称，然后在每个封闭函数作用域中查找名称，然后再尝试全局模块作用域（然后将内置函数作为最后的手段）。`currentid`是一个类属性，在任何这些范围内都找不到。

要在 Python 中查找属性，您**始终**需要指定要查找的对象。虽然查找协议意味着对象不一定需要具有属性本身；属性查找将回退到您指定的对象的类（以及基类，如果涉及继承）。

所以这会起作用：

```
del connections[self.currentid] 
```

但是，我认为您的其余代码也没有按照您的想法进行。方法中的这一行`open`：

```
currentid = global_counter 
```

不设置对象的`currentid`属性`SocketHandler`。分配给一个裸名*总是*分配给一个局部变量，除非您明确声明它`global`（您似乎意识到了这一点，因为您使用了`global`关键字）。所以在`open`方法中，`currentid`是一个局部函数变量；它的值在方法结束时丢失`open`。

事实上，您的`SocketHandler`对象根本没有`currentid`属性（除非您还没有向我们展示更多代码）。放入`currentid = 0`类块并没有给所有`SocketHandler`实例一个`currentid`属性。它给`SocketHandler`类**本身**一个属性`currentid`；这就像`def open(self):`块在类对象上创建一个`open`属性（存储一个函数），而不是在每个单独的实例上。

读`self.currentid`入`on_close`方法将无法在对象中找到`currentid`属性`self`，因此 Python 将查看`self`is的类`SocketHandler`。该对象*确实*有一个`currentid`值，因此读取的结果`self.currentid`将是`0`，无论您之前是否在该对象上运行`open`过`SocketHandler`。

如果您打算将 存储`currentid`为每个实例变量`SocketHandler`，那么 in 行`open`需要是：

```
self.currentid = global_counter 
```

这分配给`currentid`引用的对象的属性`self`。然后，您还需要将`currentid`方法中的所有其他引用更改为`self.currentid`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-08T22:04:07.803

`currentid`应该是`self.currentid`因为它是一个类变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T22:04:33.913

`currentid`是实例属性，所以使用`self.currentid`代替`currentid`：

```
def on_close(self):
        global connections
        print "WebSocket " + str(self.currentid) + " closed"
        del connections[self.currentid] 
```

# image - WordPress 将图像文件大小至少增加 10 倍

> ID：12790116
> 
> 赞同：0
> 
> 时间：2012-10-08T22:03:15.447
> 
> 标签：image, wordpress, resize

当我将大约 29kb 的图像上传到我的网站时，它们的文件大小至少会增加到 220kb 或 287kb。

我非常确定我的事实，我在 Photoshop 工作多年，我知道如何显着减小文件大小，当我在前端上传和显示时，在 Firefox 中查看图像属性，甚至下载文件并检查它们的大小，它已从 20KB 变为约 190KB。

WP 在上传时“处理”图像究竟有什么意义，似乎他们只是在其中处理更多的东西。

反正。有解决办法吗？一个真的会在上传时压缩图像吗？甚至只是展示？

谢谢大家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T06:47:44.990

这可能是 WordPress 中的默认图像大小。[您可以使用add_image_size()](http://codex.wordpress.org/Function_Reference/add_image_size)定义自己的图像大小以满足您的需求。

要添加到您的 functions.php 文件的代码：

```
 <?php add_image_size( $name, $width, $height, $crop ); ?> 
```

添加所需的图像大小和参数。

# ios - 在左上角创建自定义圆角矩形按钮角？

> ID：12790118
> 
> 赞同：11
> 
> 时间：2012-10-08T22:03:28.377
> 
> 标签：ios, objective-c, cocoa-touch, cashapelayer

我有一个自定义按钮，我想让它的左上角边框看起来像普通的圆形矩形。

我找到了使所有角落都变得圆润的代码：

```
_myButton.layer.cornerRadius = 8;
_myButton.layer.borderWidth = 0.5;
_myButton.layer.borderColor = [UIColor grayColor].CGColor;
_myButton.clipsToBounds = YES; 
```

![在此处输入图像描述](../Images/50ef19c6d66bc638c9f394241f097f6a.png)

如何修复代码以使其仅在左上角变圆？

* * *

编辑：

```
_myButton.layer.borderWidth = 2;
_myButton.layer.borderColor = [UIColor blackColor].CGColor;

UIBezierPath *maskPath = [UIBezierPath bezierPathWithRoundedRect:_myButton.bounds
                                                    byRoundingCorners:UIRectCornerTopLeft | UIRectCornerTopRight
                                                        cornerRadii:CGSizeMake(7.0, 7.0)];

CAShapeLayer *maskLayer = [[CAShapeLayer alloc] init];

maskLayer.frame = _myButton.bounds;
maskLayer.path = maskPath.CGPath;
_myButton.layer.mask = maskLayer;
[maskLayer release]; 
```

此代码不起作用。整个按钮消失。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-08T23:05:24.273

你几乎明白了，但是，在构建你的 之后`CAShapeLayer`，使用它来添加自己作为按钮层的子层，而不是作为隐藏按钮的某些部分（在这种情况下是角）的 alpha 蒙版。

```
UIButton* button = [UIButton buttonWithType:UIButtonTypeCustom];
button.frame = CGRectMake(10,300,300,40);
[button setTitle:@"Hey" forState:(UIControlStateNormal)];
[button setTitleColor:[UIColor blueColor] forState:(UIControlStateNormal)];

UIBezierPath *shapePath = [UIBezierPath bezierPathWithRoundedRect:button.bounds
                                                byRoundingCorners:UIRectCornerTopLeft | UIRectCornerTopRight
                                                      cornerRadii:CGSizeMake(7.0, 7.0)];

CAShapeLayer *shapeLayer = [CAShapeLayer layer];
shapeLayer.frame = button.bounds;
shapeLayer.path = shapePath.CGPath;
shapeLayer.fillColor = [UIColor clearColor].CGColor;
shapeLayer.strokeColor = [UIColor blackColor].CGColor;
shapeLayer.lineWidth = 2;
[button.layer addSublayer:shapeLayer];

[self.view addSubview:button]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-16T21:40:49.290

```
CAShapeLayer * positiveCorner = [CAShapeLayer layer];
positiveCorner.path = [UIBezierPath bezierPathWithRoundedRect: self.button.bounds
                                            byRoundingCorners: UIRectCornerTopRight | UIRectCornerBottomRight
                                                  cornerRadii: (CGSize){5, 5}].CGPath;

self.button.layer.mask = positiveCorner; 
```

# session - 使用服务器上的会话存储，会话密钥有什么作用？

> ID：12790119
> 
> 赞同：0
> 
> 时间：2012-10-08T22:03:59.817
> 
> 标签：session, web-applications, rack

我知道如果将会话保存到 cookie，您需要使用秘密对其进行加密，否则恶意客户端可以随意修改其会话。由于许多普遍讨论的原因，这种设计仍然很糟糕。

但是，如果有人在服务器上保存会话（我碰巧通过 Rack:Session:Dalli 使用 Memcache 存储），我知道客户端获取的所有内容都是一个带有密钥的 cookie，服务器使用该密钥从存储中查找其会话。我仍然设置了会话秘密。但我不明白它的作用了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T13:43:58.373

加密一个大的随机数本质上会产生另一个大的随机数。换句话说，如果信息没有任何意义（它只是一个随机数），那么加密就没有安全优势。如果您存储的 ID 中嵌入了一些信息，例如某个位集或仅使用了某个 ID 子集，则加密很有用。

会话 ID 的长度很重要。显然，ID 越长，越能抵抗暴力破解。同时用户会话的预期数量也是一个因素，因为会话数量减少了寻找有效会话 ID 所需的蛮力尝试次数。例如，两个同时进行的会话会将 ID 的有效强度降低一位（128 位密钥变得与 127 位密钥仅对一个会话有效）。一个拥有（比如说）1,000,000 个同时会话的亚马逊规模的网站实际上会丢失 20 位的会话密钥强度。

如果您需要防御暴力攻击，请实施一个中间件来检查它。向会话 ID 添加信息，例如应用程序唯一的字符串，可以更轻松地检测暴力攻击（并且需要会话 ID 加密）。请注意，这不会*增强*密钥本身的安全性，并且基本上是浪费精力，除非应用程序在显示不正确的会话 ID 时采取一些措施。

无论您做什么，只要确保使用 SSL 并将 cookie 设置为仅 https。会话服务器端超时，不要依赖 cookie 过期和客户端浏览器的善意。

**TL;DR** : 如果只使用 cookie 存储会话 ID，如果使用好的 RNG，则不需要加密。使用 SSL 并设置 cookie[安全属性](http://en.wikipedia.org/wiki/HTTP_cookie#Secure_and_HttpOnly)。

# jqgrid - jqGrid 内联编辑：自动完成列的奇怪行为

> ID：12790123
> 
> 赞同：0
> 
> 时间：2012-10-08T22:04:17.380
> 
> 标签：jqgrid, autocomplete

我有一个带有自动完成列的 jqGrid（使用内联编辑）。当用户从自动完成列中选择一个值时，事件处理程序会在另一列上设置一个值，并将自动完成列上的值设置为不同于`label`从自动完成源返回的值。两列定义（此处为完整的[jsFiddle](http://jsfiddle.net/syltech/27dLM/37/)示例）：

```
{
    name: 'cartoonId',
    index: 'cartoonId',
    width: 90,
    editable: false},
{
    name: 'cartoon',
    index: 'cartoon',
    width: 200,
    editable: true,
    edittype: 'text',
    editoptions: {
        dataInit: function(elem) {
            $(elem).autocomplete({
                source: autocompleteSource,
                select: function(event, ui){
                    var rowId = $("#inlineGrid").jqGrid('getGridParam', 'selrow');
                    if(ui.item){
                        $("#inlineGrid").jqGrid('setCell', rowId, 'cartoonId', ui.item.CartoonId);
                        $("#inlineGrid").jqGrid('setCell', rowId, 'cartoon', ui.item.Name);                            
                    }
                    return false;
                }
            });
        }
    }}, 
```

问题是，每当用户从自动完成中选择一个值时，无论是通过单击它还是使用箭头并按 Tab 键，该单元格都不再可编辑，并且网格似乎完全失去焦点。如果我注释掉设置`cartoon`单元格值的行，它会正常运行。有什么办法可以解决这种行为吗？我需要整行保持编辑模式，包括`cartoon`列，直到用户完成编辑。

jqGrid 4.4.1
jQuery 1.7.2
jQuery UI 1.8.18

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T05:47:53.390

您应该将`Name`项目的属性从`autocompleteSource`to重命名，`value`因为 jQuery UI Autocomplete 会检查`label`和`value`默认情况下（请参阅[文档](http://docs.jquery.com/UI/Autocomplete#overview)）。

您不能使用当前处于编辑模式`setCell`的列。`'cartoon'`您也应该`return false;`从`select`回调中删除。所以代码可能看起来如下

```
dataInit: function (elem) {
    $(elem).autocomplete({
        source: autocompleteSource,
        select: function (event, ui) {
            var rowId = $("#inlineGrid").jqGrid('getGridParam', 'selrow');
            if (ui.item) {
                $("#inlineGrid").jqGrid('setCell', rowId, 'cartoonId',
                    ui.item.CartoonId);
            }
        }
    });
} 
```

见[http://jsfiddle.net/27dLM/38/](http://jsfiddle.net/27dLM/38/)

# asp.net - Entity Framework 5 在保存时停止运行 T4 模板文件

> ID：12790124
> 
> 赞同：4
> 
> 时间：2012-10-08T22:04:28.333
> 
> 标签：asp.net, .net, entity-framework, t4, entity-framework-5

在工作中，我们刚刚升级到 Entity Framework 5。我们的 EDMX 文件下面现在有几个其他节点：

```
EntityContainer.Context.tt 
```

其中包含生成的 DbContext 对象和

```
EntityContainer.tt 
```

其中包含实体本身。

在短时间内，当我们保存 EDMX 文件时，在 EF 中添加实体会自动重新生成 tt（T4 模板）。现在突然之间，我们必须右键单击 T4 模板并选择“运行自定义工具”以让它们为上下文或实体重新生成 .cs 文件。

任何想法这可能是如何发生的？

## 更新

在 EDMX 中，属性“保存时转换相关文本模板”设置为 true，问题仍然存在。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-08T22:13:56.727

您的 EDMX 是否在项目的子文件夹中？如果是这样，好消息是你没有做错任何事。坏消息是这是一个已知问题……请查看我的博客文章。[http://thedatafarm.com/blog/data-access/watch-out-for-vs2012-edmx-code-generation-special-case/](http://thedatafarm.com/blog/data-access/watch-out-for-vs2012-edmx-code-generation-special-case/)。

暂时有两种解决方法：

1) 将 edmx 移动到主项目文件夹 2) 根据需要显式强制生成代码

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-08T22:57:49.623

实际上还有另一种解决方法。`EF 5.x DbContext Generator`我发现此错误是因为我通过添加到项目将 EF 4 EDMX 升级到 EF 5 ，这将 T4 模板添加到现有 EDMX。

但是，在项目文件中，它没有将它们标记为`DependentUpon`EDMX 文件，因此它们没有出现在 EDMX 节点下。相反，它们与文件夹中的 EDMX 并排出现。T4 代工作正常，直到我手动进入并`DependentUpon`在项目文件中添加节点。

观察：[http ://www.youtube.com/watch?v=-boB5GhqfUI](http://www.youtube.com/watch?v=-boB5GhqfUI)

# asp.net - 从代码自动更改语言

> ID：12790129
> 
> 赞同：2
> 
> 时间：2012-10-08T22:05:16.020
> 
> 标签：asp.net

我在 C# win 应用程序中使用以下代码更改语言（例如 changelanguge("en") ）我如何在 asp 中使用这样的东西？

```
public void changelanguge(String languge)
        {
            foreach (InputLanguage lang in InputLanguage.InstalledInputLanguages)
            {
                if (lang.Culture.TwoLetterISOLanguageName == languge)
                {
                    Application.CurrentCulture = lang.Culture;
                    Application.CurrentInputLanguage = lang;
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:15:59.230

### 选项1

在 ASP.NET 页面 (ASPX) 中，您需要重写该`InitializeCulture`方法：

```
 protected override void InitializeCulture()
    {
        this.UICulture = "";
        this.Culture = "";
    } 
```

### 选项 2

在页面的标记中：

```
<%@ Page UICulture="" Culture="" 
```

### 选项 3

在 web.config

```
<globalization culture="" uiCulture="" enableClientBasedCulture="true" /> 
```

### 选项 4

使用`HttpModule`（此示例使用 ASP.NET 配置文件来获取语言，您可以更改以从不同来源获取语言）

```
public class LocalizationModule : IHttpModule
{
    public void Dispose()
    {
    }

    public void Init(HttpApplication context)
    {
        context.PreRequestHandlerExecute += context_PreRequestHandlerExecute;
    }

    void context_PreRequestHandlerExecute(object sender, EventArgs e)
    {
        var application = sender as HttpApplication;
        var context = application.Context;
        var handler = context.Handler;
        var profile = context.Profile as CustomProfile;

        if (handler != null)
        {
            var page = handler as Page;

            if (page != null)
            {
                if (profile != null)
                {
                    if (!string.IsNullOrEmpty(profile.Language))
                    {
                        page.UICulture = profile.Language;
                        page.Culture = profile.Language;
                    }
                }
            }
        }
    }
} 
```

然后你只需要在 web.config 文件中配置它：

```
<httpModules>
  <add name="Localization" type="Msts.Topics.Chapter06___Globalization_and_Accessibility.Lesson01___Globalization_and_Localization.LocalizationModule" />
</httpModules>

  <system.webServer>
    <validation validateIntegratedModeConfiguration="false" />
    <modules runAllManagedModulesForAllRequests="true">
      <add name="Localization" type="Msts.Topics.Chapter06___Globalization_and_Accessibility.Lesson01___Globalization_and_Localization.LocalizationModule" />
    </modules>
  </system.webServer> 
```

# php - HTAccess 重定向和删除文件+扩展名

> ID：12790131
> 
> 赞同：0
> 
> 时间：2012-10-08T22:05:33.757
> 
> 标签：php, html, .htaccess, url, redirect

如果用户键入

```
www.example.com/Front 
```

或者

```
www.example.com/Front.php 
```

我想重定向到

```
www.example.com 
```

这是我的htaccess：

```
RewriteEngine on

DirectoryIndex Front.php

RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /([^/]+)/([^\.]+)\.php\ HTTP/
RewriteRule ^([a-zA-Z0-9_-]+)/([^.]+)\.php$ http://www.example.com/$1/$2 [R=301,L] 
```

但是由于某种原因，当我键入`www.example.com/Front.php`页面加载但 url 没有改变时，它保持为`/Front.php`. 我需要添加/更改什么才能使其正确重定向？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T22:10:25.417

您的 RewriteRule 与您的 URL 不匹配。所以这里的重写没有任何反应。

您的 URL 是`Front.php`（开头没有斜线，因为您在 .htaccess 文件中）。正则表达式是`^([a-zA-Z0-9_-]+)/([^.]+)\.php$`- 这不匹配，因为除了其他内容之外，您的网址中没有斜杠。

不触发 RewriteRule 中的正则表达式会导致包括所有前面的 RewriteCond 在内的完整规则被忽略。

如果您的 .htacces 没有更多规则，那么就是这样。

您应该启用 RewriteLog 以查看发生了什么。

# c# - 为什么我不能在 c# 中另一个类中创建的对象上使用类方法？

> ID：12790135
> 
> 赞同：-1
> 
> 时间：2012-10-08T22:05:56.237
> 
> 标签：c#, xml

如何将 xmldocument 对象发送到另一个类中的函数？在下面的示例中，我没有从 scan 函数中显示所有 xmldocument 方法和属性。

```
xmldocument xmldoc = new xmldocument();
xmldoc.load(test.xml);

anotherclass axls = new anotherclass();
axls.scan(xmldoc);

public class anotherclass()
{
    public void scan(object xmldoc)  {  some code }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T22:08:50.330

您用于函数参数的类型应该是最有意义的。据我所知，您的扫描方法应该适用于`XmlDocument`s. 因此，例如，将其更改为：

```
public class anotherclass()
{
    public void scan(XmlDocument xmldoc)  { // some code }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:10:56.133

Intellisense 只会显示声明对象的方法，不会显示实际持有​​的类的方法。此外，对于 C# 编码，编译器将无法在 Object 类型的参数上找到 XmlDocument 的方法。

请将您的方法签名更改为采用 an`XmlDocument`而不是 an `Object`，您应该获得您正在寻找的智能感知。

来自[框架设计指南](http://msdn.microsoft.com/en-us/library/vstudio/ms229015%28v=vs.100%29.aspx)的帮助是：

> 请使用提供成员所需功能的最少派生参数类型。

# ruby - 在使用 Ruby 的 Selenium 中，如何使用 xpath 选择此更新元素的文本？

> ID：12790136
> 
> 赞同：0
> 
> 时间：2012-10-08T22:05:58.163
> 
> 标签：ruby, selenium-webdriver

我想选择“updatedOn_1756”中的文本，它通常会返回“10:12 PM”之类的内容。我该怎么做？我认为它会类似于 element = driver.find_element(:id, "updatedOnID")，但这不起作用。顺便说一句，我正在使用 Firefox。

编辑：我相信页面是动态更新的。尽管此处显示的源代码中没有文本，但页面上显示了一个时间（当我单击“查看源代码”时，它不会显示在页面源代码中）。

```
 <tr id='row_for_1756'  >
            <td class="IDClass">1756</td>
            <td>Jameson</td>
            <td><a id='DrinkName_1756' class="linkToClient" title="Launch Live Viewer" href='/client/Client.application?myid=1756'>Stevens 18</a> - 
                <a title="BETA Client" href='/client/Client.application?bell=1756' style="color: green; font-weight: bold;">(BETA VERSION)</a> - <a id='DrinkName_Old_1756' class="linkToClient" title="Version before" href='/client/blank/Client.application?myid=1756' style="color: Red;">(old version)</a></td>
            <td>9980</td>
            <td><span id='updatedOn_1756' class="updatedOnID"></span></td>
            <td><span id='histUpdatedOn_1756' class="updatedOnID"></span></td>
        </tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T01:48:58.727

它不起作用的原因是因为你要求一个不存在`id`的 value 。`updatedOnID`有一个具有该值的*类*，但由于您正在寻找 ，因此`id`您需要整个 ID 值，包括数字：

```
driver.find_element(:id, "updatedOn_1756") 
```

# c - 卡在 C 文件 i/o 上

> ID：12790137
> 
> 赞同：0
> 
> 时间：2012-10-08T22:06:13.450
> 
> 标签：c, file, io

我有一个从 txt 文件读取的 C 程序。文本文件包含一个单词列表，每行一个单词。我想要做的是从文本文件中获取单词并将它们打印为一个句子/段落，但是，当我尝试打印它们时，它们仍然每行打印一个单词。当我从文件中读取它们时，我将它们存储在 2d 字符数组中。我认为正在发生的是数组从 txt 文件中复制换行符，对吗？如果是这样，如何在没有新行字符的情况下将单词添加到数组中？

```
 while(fgets(line,20,lineRead)!=NULL)
    {
        for(j = 0; j < 20;j++)
        {            
            message[k][j]= line[j];

        }
        printf("%s", message[k]);
    } 
```

我尝试了几个while循环但没有成功：

```
while(line[j] != ' ')        
while(line[j] != NULL)       
while(line[j] != EOF)      
while(line[j] != ' \') 
```

我正在学习 C，所以请具体说明我的错误。我想了解我做错了什么，而不仅仅是得到答案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:10:57.513

fgets 函数在您正在读取的缓冲区中包含换行符 \n 。只需在循环中包含一个条件语句即可复制除 \n 和 \r 之外的所有字符。就像是：

```
if ( line[j] != '\n' && line[j] != '\r' ) {
    /* Copy the character in your new buffer */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:13:17.227

换行符是字符串的一部分，您需要删除它们：

```
#include <string.h>

while(fgets(line,20,lineRead)!=NULL)
{
    char* newline_pos = strpbrk (line, "\n\r"); // get first occurance of newline or carriage return
    if (newline_pos) 
         *newline_pos = '\0';

    printf("%s ", line);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T22:13:41.250

您可以简单地将您的 for 循环更改为：

```
for(j = 0; j < 20 && line[j] != '\n';j++)
{            
    message[k][j]= line[j];
}
if(j < 20)
    message[k][j] = '\0'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T22:13:57.060

你应该做：

```
while(fgets(line,20,lineRead)!=NULL)
    {        
        strcpy(message[k], line);
        if(message[k][strlen(line)-1] == '\n')
            message[k][strlen(line)-1] = '\0']
        printf("%s", message[k]);
    } 
```

这样做是它复制`line`到`message[k]`最后一个字符，然后如果它是换行符则删除它。我们正在检查最后一个字符，因为文档说“换行符使 fgets 停止读取，但函数认为它是有效字符并包含在复制到 str 的字符串中。” 因此，如果存在换行符，它将是最后一个字符。

# sql - 来自另一个查询的 SQL Server 列别名

> ID：12790139
> 
> 赞同：-1
> 
> 时间：2012-10-08T22:06:36.580
> 
> 标签：sql, tsql, sql-server-2005, sql-server-2005-express

为什么此代码在 SQL Server 2005 中不起作用？

```
select c.price AS (select CityName from Cities ci where ci.cityid= c.cityid)
from prices c
where cityid=1 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:12:30.330

这是什么问题！因为您使用子查询的位置是别名位置。别名是您赋予长名称以便在查询的其他部分轻松使用它们的名称。我想你的想法是这样的代码：

```
Select  c.price
,   ci.CityName
    From    prices  As  c
    Inner   Join
        Cities  As  ci 
    On  ci.cityid   =   c.cityid 
```

并且请以嵌套样式编写您的代码。它很容易阅读，当然也更容易理解。

**更新：**

如果您需要城市列表作为列名和它们下方的价格，则应使用`"PIVOT"`运算符。像这样的代码：

```
Select  PivotedResult.[1]   As  US
,   PivotedResult.[2]   As  UK
,   PivotedResult.[3]   As  IR
    From    prices  As  c
    Pivot   (
        Sum(c.price)
        For c.cityid    In  (
            [1]
        ,   [2]
        ,   [3]
        )
    )   As  PivotedResult 
```

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:13:10.467

因为在任何 SQL 规范或标准中都没有说它应该工作。来自任何 rdbms 的 SQL 是关于数据的，而不是它的呈现方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T22:10:12.837

**已编辑**

`select c.price AS [Tokyo] from prices c where c.cityid=1`

不，这是不可能的，也不太可能得到 ISO SQL 标准组的任何喜爱。您正在混合 RDBMS 和前端语义的目的。

想象一下，如果您有**2 行**数据，1 行用于 [Tokyo]，1 行用于 [Kyoto]，会发生什么情况。你会给这个专栏起什么名字？更好的选择是生成 2 列，如下所示，让前端使用来自第 2 列的标签。

* * *

也许

```
select c.price
      ,(select CityName from Cities ci where ci.cityid= c.cityid) AS CityName
  from prices c
 where cityid=1 
```

当您希望将输出列命名为查询的调用者时，使用术语“列别名”。在这种情况下，将返回子查询中的 CityName，并且该查询中的第二列被命名为“CityName”。

假设`cityid`是唯一的，则返回多个结果的子查询不会有任何问题——这在 SELECT 表达式中是不允许的。

除非 price.cityid 可能不存在于 Cities 表中（在这种情况下您的查询很好），否则最好重写

```
select c.price, ci.CityName
  from prices c
  join Cities ci on ci.cityid= c.cityid
 where cityid=1 
```

# special-characters - 使用 php 从 .rtf 或 .doc 解码特殊字符

> ID：12790143
> 
> 赞同：2
> 
> 时间：2012-10-08T22:06:54.457
> 
> 标签：special-characters, decoding, iso-8859-1, latin1

我正在尝试找到一种干净的方法来使用 php 解码一些“特殊字符”，我有一个 RTF 文件（还有 PDF 和 DOC 有理智的问题），我设法打开它并在其中找到明文，放​​在结束它仍然会输出一些字符，例如：é 为 é 或 ç 为 Ã§。我尝试过 mb_detect_encoding（也使用“auto”）但它检测到“ACSII”，我尝试使用 mb_convert_encoding($mytext,'ISO-8859-1'), mb_convert_encoding($mytext,'ISO-8859-15' ), mb_convert_encoding($mytext,'UTF-8') 然后 UTF-8 到 ISO-8859-1, htmlspecialchars, utf8_decode (递归)。我制作了一个映射表，但我认为这不是最好的方法吗？

泽维尔·维兰

PS：大部分文件都是用法国拉丁字符集创建的。

# android - Android 的 WebView 中的动画

> ID：12790146
> 
> 赞同：0
> 
> 时间：2012-10-08T22:07:10.217
> 
> 标签：android, html, webview, flash, gif

据我所知，WebViews 中的 swf 和 gif 不受 Android 官方支持，尽管它们在我的 HTC Desire 设备中工作。

我正在构建一个基于 WebView 的应用程序。我所做的是将“应用程序”编码为 HTML，将其放入“原始”文件夹，一旦应用程序启动，它会将所有 html 和图像放入 SD 上的文件夹中（如果它们还没有的话）。

现在我需要在那里显示一些动画。我用 Actionscript 制作了它们，我很高兴它似乎可以工作（动画每个 25KB），但在发布一段时间后，我收到了看不到动画的人的报告。

然后我将它们修补成一个 GIF（每个内存增加到 400KB-1MB）。在这一点上，我决定从原始文件夹中取出 gif，并在应用程序第一次运行时从网络中的一个服务器下载它们，这样我的 apk 就不会变得太大。但是我又收到投诉说人家看不到（后来发现GIF也不支持）

Google-ing 和 stackoverflow-ing 我发现唯一的解决方案是将这些 GIF 拆分成单独的图像，并用 javascript 将它们一一显示以创建动画。我想这种方法对于小动画（比如一些脸打招呼或类似的东西）是可以的，但对于整个动画......它的重量约为每个动画 3MB（当 swf 为 25KB 时......）。而且我认为从用户的数据配额中获取 30MB（未来可能更多用于新动画）并不好。

所以：

1.  还有其他解决方案吗？
2.  是否有很多不支持 SWF 的手机？和GIF？如果它们不是太多，我会考虑在我的应用程序的描述中说明如果手机内存不足动画将无法工作（动画在我的应用程序中不是很重要）

非常感谢你，

胜利者

编辑：附加信息：动画就像[这样](http://livewind.olisrv.org/rrv_downloads/rule13a.gif "这个")。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T21:51:10.710

所以...我发现唯一的方法是使用 HTML5 画布动画，因为令人惊讶的是许多设备都支持它。

动画不像在兼容 GIF 的设备中那样流畅，但我宁愿让每个人都可以访问它。

所以，CommonsWare 回答了我的第二个问题，但我会回答我的第一个问题：是的，使用 HTML5。这并不需要大量的工作，因为 JS 也可以是面向对象的，并且语法与 AS3 非常相似。

最好的部分是基本代码的权重只有 34KB（假设引擎加上所有图像），每个动画（在单独的文件中）的权重在 1 到 2KB 之间。太棒了，我可以将它们全部放入我的 Android 的原始文件夹中。

非常感谢 CommonsWare 的评论。

# svg - 使用 SVG feDisplacementMap 过滤器，我如何抗锯齿？

> ID：12790152
> 
> 赞同：1
> 
> 时间：2012-10-08T22:07:50.230
> 
> 标签：svg, svg-filters

当使用 feDisplacementMap svg 过滤器时，我平滑的 svg 线条变得参差不齐。我可能可以将它渲染大然后缩小它，但是 SVG 不应该能够抗锯齿吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T03:00:12.173

好的，所以我想出了自己问题的答案：filterRes 属性：[http ://www.w3.org/TR/SVG/filters.html#FilterElementFilterResAttribute](http://www.w3.org/TR/SVG/filters.html#FilterElementFilterResAttribute)

在我的测试中，在 Chrome 上，增加 filterRes 会大大降低速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:42:05.833

SVG 过滤器在像素级别而不是矢量级别处理输入。就 SVG 过滤器而言，它被交给了一个 RGBA 像素的大矩形来处理。置换贴图的结果可能看起来像素化，因为过滤器不知道被置换的边缘在哪里 - 就它而言，它只是像素。（用于抗锯齿的旧半透明像素也已被替换。）但是，有时您可以添加另一个或两个过滤器来解决由此产生的任何问题。解决这个问题的创造性方法：

1.  取置换后的图形，用几个像素的半径对其进行模糊处理，然后将模糊处理重新混合到原始图形中。

2.  使用置换后的图形，进行亮度到 alpha 的转换，然后使用带有漫反射光照效果的 alpha 贴图添加虚假的抗锯齿光照效果。

3.  使用带有边缘检测值的卷积矩阵从图形中提取边缘，模糊该结果并将其混合回源图形中。

根据您的图形，您可能可以使用侵蚀或扩张过滤器，但这往往会产生四四方方的高光并且可能不起作用。当然，您可以随时调整您在 SVG 中的输入（使用笔触效果）以“预抗锯齿”您的源图形，这样结果看起来就不会那么奇怪。

# android - Opencv Android 的代码优化

> ID：12790154
> 
> 赞同：2
> 
> 时间：2012-10-08T22:08:05.880
> 
> 标签：android, c++, optimization, image-processing, opencv

我在 Android 上使用这个 opencv 代码进行强度均衡。执行时间约为每帧 300 毫秒 (720x480)。有人对可能的时间优化有想法吗？

这是代码：

```
 cvtColor(image, hsvImage, CV_BGR2HSV);
        // Get intensity
        intensity = hsvImage.at<Vec3b>((int)reference.Point_::y, (int)reference.Point_::x);
        float value = (float)REGULAR_INTENSITY / intensity[2];
        float saturation = (float)REGULAR_SATURATION / intensity[1];
        if (counter == 15 && (int)intensity[2] < REGULAR_INTENSITY) {
            equalization = false;
        }
        // Modify intensity
        float transformedSaturation, transformedValue;
        for(int i = 0; i < hsvImage.rows; i++) {
            unsigned char *data = hsvImage.ptr(i);
            for(int j = 0; j < hsvImage.cols; j++) {
                transformedSaturation = (uchar)*++data * saturation;
                if (transformedSaturation > MAX_COLOR) {
                    transformedSaturation = MAX_COLOR;
                }
                *data++ = transformedSaturation;
                transformedValue = (uchar)*data * value;
                if (transformedValue > MAX_COLOR) {
                    transformedValue = MAX_COLOR;
                }
                *data++ = transformedValue;
            }
        }
        cvtColor(hsvImage, image, CV_HSV2BGR); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T15:45:29.767

您是否尝试过使用 OpenCV[转换](http://docs.opencv.org/modules/core/doc/operations_on_arrays.html?highlight=transform#cv.Transform)？我想它是优化的，但我不知道饱和投射（即如果 > max_color，则 = 最大颜色）

# mysql - C# Mysql - 给定的键在字典中不存在

> ID：12790162
> 
> 赞同：2
> 
> 时间：2012-10-08T22:09:00.190
> 
> 标签：mysql, connection-string

我正在尝试执行以下代码：

```
 _cmd.CommandText = "SELECT * FROM category";
    MySqlDataReader ret;
    _cmd.Connection = _con;
    _con.Open();
    ret = _cmd.ExecuteReader(System.Data.CommandBehavior.CloseConnection);
    _con.Close();

    return ret; 
```

然而，我收到一个奇怪的错误：

> 字典中不存在给定的键。

正在从 web.config 正确读取连接字符串（我可以使用调试器看到这一点）。我还有其他使用相同连接字符串（用于插入数据）的方法，它们可以正常工作。有什么我在这里想念的吗？！

这是我试图调用的方法：

```
 public MySqlDataReader ExecuteReader(String sql, MySqlParameter[] param)
    {
        if (param != null)
            _cmd.Parameters.AddRange(param);

        _cmd.CommandText = sql;
        MySqlDataReader ret;

        _con.Open();
        ret = _cmd.ExecuteReader(System.Data.CommandBehavior.CloseConnection);

        return ret;
    } 
```

它是从此 Web 服务调用的：

```
[WebMethod]
        public string[] GetCategories()
        {
            String sql = "SELECT CategoryName FROM category";
            DatabaseHelper dh = new DatabaseHelper();
            MySqlDataReader dr = dh.ExecuteReader(sql, null);
            List<String> categories = new List<string>();
            while (dr.Read())
            {
                categories.Add(dr[0].ToString());
            }
            dr.Close();

            return categories.ToArray();
        } 
```

# grails - Grails 总是尝试卸载插件

> ID：12790164
> 
> 赞同：1
> 
> 时间：2012-10-08T22:09:06.350
> 
> 标签：grails, grails-plugin, grails-2.0

每次我运行 Grails 应用程序时，它都会尝试卸载插件 ( `resources-1.2.RC2`)。当它使用 IntelliJ IDEA 安装时，它成功卸载它，我看到：

```
| Uninstalled plugin [resources] 
```

并失败：

```
| Error Fatal error during compilation org.apache.tools.ant.BuildException: 
  srcdir "***/2.1.1/projects/***/plugins/resources-1.2.RC2/grails-app/resourceMappers" 
  does not exist! (Use --stacktrace to see the full trace) 
```

请注意，我只能使用 InteliJ IDEA 安装此插件，当我尝试从命令行（使用`grails install-plugin resources`）安装它时，它只记录：

```
| Plugin not installed. 
```

如果没有安装插件，而我正在这样做`grails run-app`，它会写（每次！）：

```
| Warning No plugin [resources-1.2.RC2] installed, cannot uninstall 
```

应用程序失败，因为无法从`resources`插件中找到所需的类。

--

我猜这是因为内部配置损坏`~/grails`（我前段时间尝试卸载它），并且它在每次运行时执行此操作。但我能找到。

我什至试图从中删除项目目录`~/.grails/2.1.1/projects`- 没有帮助。

我怎样才能阻止它删除这个插件？哪里 grails 存储信息它应该卸载什么插件？

PS另外，我不明白，为什么`plugins { compile ":resources:1.2.RC2" }`不`BuildConfig.groovy`被grails使用？我总是需要运行`install-plugin`命令才能使其工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T10:17:41.453

实际上， install-plugin 已被弃用。请改用 BuildConfig.groovy。要正确设置所有内容，请从 application.properties 文件中删除所有插件。然后将它们添加到您的 BuildConfig.groovy。IntelliJ 并不擅长捕捉此类更新，因此您可能必须在更新 BuildConfig 后手动运行刷新依赖项。这就是为什么它以前不起作用的原因。

# iphone - 如何编辑 IAP 的 plist 文件

> ID：12790165
> 
> 赞同：1
> 
> 时间：2012-10-08T22:09:24.667
> 
> 标签：iphone, ios, in-app-purchase

我想在我的应用程序中实现 IAP，并且产品是非消耗品。我曾尝试使用[EBPurchase](https://github.com/ebutterfly/EBPurchase)和[MKStoreKit](http://blog.mugunthkumar.com/coding/using-mkstorekit-in-your-apps/)。他们都提到我应该编辑 plist 文件来设置配置，比如将一系列产品添加到 plist 中。谁能教我如何编辑 plist？我们需要更改 Bundle 标识符吗？任何资源都有帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:14:05.167

将 plist 添加到项目后，您可以在 Xcode 中编辑它，就像编辑任何其他 plist（或 .m 文件或 .h 文件）一样。因此，以 MKStoreKit 为例：

1.  按照说明在 XCode 中将 MKStoreKit 文件添加到您的应用程序
2.  找到`MKStoreKitConfigs.plist`并打开它，让它出现在 Xcode 的中间窗格中（它看起来像一个网格）
3.  在 plist 上右键单击或 ctrl-clik 以显示上下文菜单和“添加行”
4.  输入密钥的名称，然后从下拉列表中选择类型并输入一个值
5.  查看示例文件以了解 NSArrays 和 NSDictionaries 如何使用小三角形图标来展开和折叠自己。

# shell - 将文件移动到 hadoop 集群的 Shell 脚本

> ID：12790166
> 
> 赞同：3
> 
> 时间：2012-10-08T22:09:31.070
> 
> 标签：shell, hadoop, hdfs

这可能已经在某个地方得到了回答，但我还没有找到。

我有一个简单的 shell 脚本，我想用它来将日志文件移动到我的 Hadoop 集群中。该脚本将由 Logrotate 每天调用。

它失败并出现以下错误：“/user/qradar: cannot open `/user/qradar' (No such file or directory)”。

```
#!/bin/bash

#use today's date and time
day=$(date +%Y-%m-%d)

#change to log directory
cd /var/log/qradar

#move and add time date to file name
mv qradar.log qradar$day.log

#load file into variable
#copy file from local to hdfs cluster

if [ -f qradar$day.log ]

then
    file=qradar$day.log
    hadoop dfs -put /var/log/qradar/&file   /user/qradar

else
    echo "failed to rename and move the file into the cluster" >> /var/log/messages

fi 
```

目录 /user/qradar 确实存在，并且可以与 Hadoop 文件命令一起列出。我还可以使用 Hadoop 文件命令手动将文件移动到正确的目录中。我可以通过这种方式将文件移动到集群中吗？有没有更好的办法？

欢迎任何想法和评论。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T23:11:26.513

是`&file`错字`hadoop dfs -put`吗？

如果不是，那么这可能是您的问题，您正在后台运行命令`hadoop dfs -put /var/log/qradar/`（与号在后台运行命令），然后`file /user/qradar`是 shell 在本地路径上查找的 command 。

我的猜测是您的意思是以下（美元而不是＆符号）：

```
hadoop dfs -put /var/log/qradar/$file /user/qradar 
```

# jquery - 如何使用锚点和菜单活动样式在页面上禁用和恢复 jQuery 航点

> ID：12790180
> 
> 赞同：2
> 
> 时间：2012-10-08T22:10:26.830
> 
> 标签：jquery, jquery-waypoints

我有一个页面使用 jQuery waypoints 插件以及 scrollTo 插件来实现粘性标题等（这里的教程：http://webdesign.tutsplus.com/tutorials/javascript-tutorials/create-a-sticky -navigation-header-using-jquery-waypoints/)。

我几乎所有东西都运行良好，但是我遇到了您可以在子菜单上看到的行为 - 当单击与页面下方 div 对应的链接时，页面会根据 div 滚动，并且菜单会更新为 '选择'类风格。但是因为页面滚动过其他 div，所以当页面滚动过时，菜单会通过每个活动菜单项进行动画处理。我希望能够删除该功能，然后在页面导航到相应的 div 后立即恢复它，以便删除此动画活动菜单链接的闪烁。您可以在这里看到我在说什么（在子菜单中，如果您单击任何链接，例如班车司机或接待员等）。

[http://pinnacleahs.com/?page_id=8](http://pinnacleahs.com/?page_id=8)

我知道航点插件中有一个 remove() 方法，但我不确定如何恢复它。此外，也许还有另一种方法可以达到同样的目的。

我的功能如下所示：

```
$(function() {
// Do our DOM lookups beforehand
var nav_container = $(".navContainer");
var nav = $(".navStickyHolder");
nav_container.waypoint({
handler: function(event, direction) {
nav.toggleClass('sticky', direction=='down');
if (direction == 'down'){
nav_container.css({ 'height':nav.outerHeight() });
} else  { 
 nav_container.css({ 'height':'auto' });
} 
},
offset: 177
});

var sections = $(".servicePanel");
 var navigation_links = $(".servicesNavigation li a");
 sections.waypoint({
    handler: function(event, direction) {
    var active_section;
    active_section = $(this);
    if (direction === "up") active_section = active_section.prev();

        var active_link = $('.servicesNavigation li a[href="#' +  active_section.attr("id") + '"]');
        navigation_links.removeClass("selected");
        active_link.addClass("selected");

    }, offset: 295
})

navigation_links.click( function(event) {

        $.scrollTo(
        $(this).attr("href"),
        {
            duration: 300,
            offset: { 'left':0, 'top': -240 }
        }
    );

    navigation_links.removeClass("selected");
    $(this).addClass("selected");

        });
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T05:42:06.870

嗨，您使用的是最新版本的航点[吗](http://imakewebthings.com/jquery-waypoints/)？您需要将航点选项“连续”定义为“假”

例如：

```
 $('.div')
  .waypoint(function(direction){
    if (direction === 'down') {
      do stuff
    } //endif
    },{
        offset: '10px',
        continuous: false
  })
  .waypoint(function(direction){
    if (direction === 'up') {
     do stuff
    } //endif
    },{
       offset: '10px',
        continuous: false
    });
}); 
```

# wpf - ListBox 如何填充其父宽度？

> ID：12790183
> 
> 赞同：1
> 
> 时间：2012-10-08T22:10:34.510
> 
> 标签：wpf, listbox

我有一个`ListBox`并且需要它填充父母的宽度，但还没有找到一种方法来做到这一点，它`ListBox`始终具有`ListBox`宽度而不是 100%。

这是我的 XAML 代码：

```
<ListBox ItemsSource="{Binding anagSearchResults}" BorderThickness="0" Background="Gray"
     SelectedItem="{Binding selectCustomer}" 
     FontSize="14"    
     ScrollViewer.HorizontalScrollBarVisibility="Disabled">
     <ListBox.ItemContainerStyle>
           <Style TargetType="ListBoxItem">
               <Setter Property="HorizontalContentAlignment" Value="Stretch"></Setter>
           </Style>
     </ListBox.ItemContainerStyle>
     <ListBox.ItemTemplate>
         <DataTemplate>
               <Grid HorizontalAlignment="Stretch">
                   <Grid.ColumnDefinitions>
                       <ColumnDefinition Width="*"></ColumnDefinition>
                       <ColumnDefinition Width="*"></ColumnDefinition>
                       <ColumnDefinition Width="*"></ColumnDefinition>
                       <ColumnDefinition Width="*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="{Binding FirstName}"></TextBlock>
                    .... 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T06:55:55.717

我会检查父级的 Horizo​​ntalAlignment 并确保它们都没有设置为左、右或居中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-08T22:20:24.743

我会使用 ListView GridView。
然后对于宽度，您需要使用转换器。
将此示例中的转换器更改为父宽度/ 4

[在此处输入链接描述](https://stackoverflow.com/questions/9083933/gridviewcolumn-width-adjustment/9088071#9088071)

查看我的检查答案

# ios - 使用 IF 比较 3 个值

> ID：12790184
> 
> 赞同：-1
> 
> 时间：2012-10-08T22:10:39.457
> 
> 标签：ios, xcode, if-statement

我有 3 个 UILabel 文本字段，我正在尝试比较每个文本字段中的一个值，以突出显示最小值。

我目前有以下代码：

```
if (((pd1 <= pd3) && (pd1 <= pd2)) || ((pd2 == 0) && (pd3 == 0))){
    pdOne.textColor = [UIColor yellowColor];
}
if (((pd2 > 0) && (pd2 <= pd1)) && ((pd3 >0) && (pd2 <= pd3))) {
    pdTwo.textColor = [UIColor yellowColor];
}
if ((pd3 >0) && (pd3 <=1) && (pd3 <= pd2)) {
    pdThree.textColor = [UIColor yellowColor];
} 
```

在某个地方我会出错，并且希望对此有一些指导。

非常感谢

该操作的完整代码是

```
- (IBAction)calculateOne:(id)sender; {

NSLog(@"count=%d",count);

pd3 = pd2;
pdThree.text = pdTwo.text;

pdThree.font = [UIFont systemFontOfSize:kDefaultFontSize];
//setup text resizing check here
if (pdThree.contentSize.height > pdThree.frame.size.height) {
    int fontIncrement = 1;
    while (pdThree.contentSize.height > pdThree.frame.size.height) {
        pdThree.font = [UIFont systemFontOfSize:kDefaultFontSize-fontIncrement];
        fontIncrement++;
    }
}

pd2 = pd1;
pdTwo.text = pdOne.text;

pdTwo.font = [UIFont systemFontOfSize:kDefaultFontSize];
//setup text resizing check here
if (pdTwo.contentSize.height > pdTwo.frame.size.height) {
    int fontIncrement = 1;
    while (pdTwo.contentSize.height > pdTwo.frame.size.height) {
        pdTwo.font = [UIFont systemFontOfSize:kDefaultFontSize-fontIncrement];
        fontIncrement++;
    }
}

[brand resignFirstResponder];
[qty resignFirstResponder];
[size resignFirstResponder];
[price resignFirstResponder];
double num1, num2, num3, num4, answerb;

num1 = [qty.text intValue];
num2 = [size.text intValue];
num3 = [price.text intValue];
num4 = (num3/100);
count = (count+1);
NSLog(@"count=%d",count);

answerb=((num3/(num1*num2))*10);
pd1 = answerb;

NSString *answerStringc = [[NSString alloc] initWithFormat:@"%@ %@ x %@ml @ £%.2f = £%.4f/litre ", brand.text, qty.text, size.text, num4, answerb];
pdOne.text= answerStringc;
pdOne.font = [UIFont systemFontOfSize:kDefaultFontSize];
pdOne.textColor = [UIColor whiteColor];
pdTwo.textColor = [UIColor whiteColor];
pdThree.textColor = [UIColor whiteColor];

if (((pd1 <= pd3) && (pd1 <= pd2)) || ((pd2 == 0) && (pd3 == 0))){
    pdOne.textColor = [UIColor yellowColor];
}
if (((pd2 > 0) && (pd2 <= pd1)) && ((pd3 >0) && (pd2 <= pd3))) {
    pdTwo.textColor = [UIColor yellowColor];
}
if ((pd3 >0) && (pd3 <=pd1) && (pd3 <= pd2)) {
    pdThree.textColor = [UIColor yellowColor];
}

//setup text resizing check here
if (pdOne.contentSize.height > pdOne.frame.size.height) {
    int fontIncrement = 1;
    while (pdOne.contentSize.height > pdOne.frame.size.height) {
        pdOne.font = [UIFont systemFontOfSize:kDefaultFontSize-fontIncrement];
        fontIncrement++;
    }
}

NSLog(@"pd1 = %f",pd1);
NSLog(@"pd2 = %f",pd2);

if ((count >1) && ([SLComposeViewController isAvailableForServiceType:SLServiceTypeTwitter]) && ([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook]))  {
    self.tweetButton.enabled = YES;
    self.tweetButton.alpha = 1.0f;
    self.facebookButton.enabled = YES;
    self.facebookButton.alpha = 1.0f;

} else if ((count <2)) {
    self.tweetButton.enabled = NO;
    self.tweetButton.alpha = 0.5f;
    self.facebookButton.enabled = NO;
    self.facebookButton.alpha = 0.5f;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:20:42.453

我认为这会更容易实现并且更易读（假设你的 pd1、pd2、pd3 是整数）：

```
// Begin with the assumption that pd1 is the smallest
int smallestValue = pd1;
UILabel *smallestLabel = pdOne;

// If pd2 is smaller, use it
if ((pd2 != 0) && (pd2 < smallestValue)) {
     smallestValue = pd2;
     smallestLabel = pdTwo;
}

// If pd3 is smaller, use it
if ((pd3 != 0) && (pd3 < smallestValue)) {
     smallestValue = pd3;
     smallestLabel = pdThree;
}

// Highlight the smallest
smallestLabel.textColor = [UIColor yellowColor]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:56:37.100

> 我有 3 个 UILabel 文本字段，我正在尝试比较每个文本字段中的一个值，以突出显示最小值。

很简单：假设你的值是浮点数，你可以使用这个：

```
// You want to ignore values that reads 0, so for each value that is zero we will use CGLOAT_MAX instead in the MIN computation.
// Note: "x?:y" is equivalent to "x?x:y"
// and reads "if x is true (not 0/nil/NO), then use x, else use y"
float minval = MIN( (pd1?:CGFLOAT_MAX) , MIN( (pd2?:CGFLOAT_MAX) , (pd3?:CGFLOAT_MAX) ));

pdOne.textColor   = (pd1 == minval) ? [UIColor yellowColor] : [UIColor blackColor];
pdTwo.textColor   = (pd2 == minval) ? [UIColor yellowColor] : [UIColor blackColor];
pdThree.textColor = (pd3 == minval) ? [UIColor yellowColor] : [UIColor blackColor]; 
```

如果您的值是整数，请使用`int minval`并且更重要的是使用`INT_MAX`而不是`CGFLOAT_MAX`.

# c++ - 无法将整数分配给动态分配的二维数组

> ID：12790188
> 
> 赞同：0
> 
> 时间：2012-10-08T22:11:12.607
> 
> 标签：c++, c

我通过以下方式创建了一个二维数组：

```
int** map_array = (int**)malloc(sizeof(yy_value*xx_value)); 
```

当我尝试为某个位置分配一个值时：

```
map_array[y*xx_value+x] = 5; 
```

我收到以下错误：

```
Assigning to 'int *' from incompatible type 'int' 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T22:13:20.190

改变：

```
int** map_array = (int**)malloc(sizeof(yy_value*xx_value)); 
```

至：

```
int* map_array = (int*)malloc(yy_value*xx_value*sizeof(map_array[0])); 
```

说明：你在这里分配一个“扁平化”的二维数组，在这里你计算你自己的一维索引，而不是一个实际的二维数组。此外，传递给 malloc 的大小也不正确。

请注意，如果没有充分的理由，您可能不应该在 C++ 程序中使用 malloc。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:14:26.253

您也可以将二维数组用作：

```
int **map_array = (int**)malloc(xx_value*sizeof(int*))
for (i = 0; i < xx_value; i++) {
    map_array[i] = (int*)malloc(yy_value*sizeof(int))
} 
```

并使用以下方式访问元素：

```
map_array[x][y] = 5; 
```

# visual-studio-2012 - Intellitrace 生产不创建 itrace 文件

> ID：12790189
> 
> 赞同：2
> 
> 时间：2012-10-08T22:11:20.430
> 
> 标签：visual-studio-2012, visual-studio-debugging, intellitrace

到目前为止，Intellitrace 一切都很好，但是现在在设置生产收集时，它只是没有这样做。没有错误，一切都是......只是不创建 .itrace 文件。

所以我做了什么，我有 WIN 7、32 位 SP1。我有它 IIS7。

我想复制动手实验室的 FabrikamFiber 演示。它适用于 F5 调试，但其他东西根本不起作用。

需要注意的一件事是，我正在虚拟 VMWare 机器上对此进行测试，包括收集和调试。

我使用普通命令，我什至将每个人都作为 Intellitrace 文件夹和日志文件夹的用户进行测试。

PS C:\Users\IEUser> Start-IntelliTraceCollection "FabrikamFiber.Extranet.Web" C:\IntelliTrace\collection_plan.ASP.NET.trace.xml C:\IntelliTrace

所有的路径都很好！

但简单地说，在运行应用程序时，它不会记录任何内容。

执行状态命令，返回这个：

ApplicationPool：FabrikamFiber.Extranet.Web ProcessId：4068 ProcessStartTime：10/8/2012 11:48:20 PM CollectionPlanPath：C:\Windows\Temp\FabrikamFiber.Extranet.Web_collection_plan.ASP.NET.trace.xml OutputPath：

Outputpath 是空的！

并且没有创建 .itrace 文件？！

有人知道吗？

弗拉丹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-10T00:40:55.047

如果[IntelliTrace .cab 文件在下载后未像这样展开，](http://msdn.microsoft.com/en-us/library/hh398365%28v=vs.110%29.aspx#BKMK_Install_the_IntelliTrace_Stand_Alone_Collector)则可能会发生这种情况：

**展开 /f:* IntelliTraceCollection.cab 。**

# jquery - 使用可选择的 jquery 进行多项选择和点击

> ID：12790192
> 
> 赞同：0
> 
> 时间：2012-10-08T22:11:57.033
> 
> 标签：jquery, jquery-ui, binding, selectable

我正在用可选择的 jquery 进行一个小时的计划。

这个想法很简单：可以进行多种选择。如果单击，则打开/关闭小时。如果按下 shift，字段变为红色并被破坏。

代码：

```
$(function() {
    $("#selectable").bind("mousedown", function(event) {
        event.metaKey = true;
    }).selectable({
        selecting: function() {
            $(this).find('td.ui-selecting').addClass('potential');
            if (event.shiftKey == 1) {
                $(this).find('td.ui-selecting').addClass('destroy');
            }
        },
        stop: function() {
            $(this).find('td.ui-selected.destroy').removeClass('ui-selected potential');
            $(this).find('td.ui-selected.potential').removeClass('potential');
            $(this).find('td.destroy').removeClass('destroy');
        }
    });
    $("td.ui-state-default").click(function() {
        $(this).toggleClass('ui-selected');
    });
});​ 
```

查看实时示例：[http ://studentify-static-pages.s3.amazonaws.com/calendar.html](http://studentify-static-pages.s3.amazonaws.com/calendar.html)

现在。我似乎无法获得简单的点击权。可能是因为我之前绑定过它。期望的行为：简单的点击（所以 0 套索）切换 ui-select。

有什么提示吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T22:22:46.853

尝试这个

```
$("ui-selectee ").on('click','td.ui-state-default' ,function() {
        $(this).toggleClass('ui-selected');
    }); 
```

将事件委托给其父级

# java - java内存不足异常（jdbc）

> ID：12790193
> 
> 赞同：0
> 
> 时间：2012-10-08T22:12:04.007
> 
> 标签：java, mysql, jdbc, heap-memory

我正在尝试从 mysql 数据库中循环读取序列化对象并在 java 中对其执行一些操作。我编写了以下函数，用于从 ResultSet 对象中返回对象。

```
public static MyObj deSerializeCacheTagInfo(ResultSet res
    ) throws SQLException, IOException, ClassNotFoundException 
{
    byte[] buf = res.getBytes(3);
    ObjectInputStream objectIn = null;
    if (buf != null)
        objectIn = new ObjectInputStream(new ByteArrayInputStream(buf));
    MyObj info = (MyObj)objectIn.readObject();
    return info;
} 
```

当我运行这段代码时，它给了我一个内存不足的异常。我搜索了一下，意识到这可能是因为结果集很大并且保存在内存中，所以我尝试一次获取大约 50 行。

但这似乎也无济于事。

在使用 visualvm 进行分析时，它报告所有空间都被`byte[] objects`. 但我不完全确定出了什么问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T21:38:06.650

默认情况下，MySQL JDBC 驱动程序*将完整的 ResultSet*提取到内存中。

您可以将其更改为流式提取，如下所示：

```
Statement st = connIn.createStatement(ResultSet.TYPE_FORWARD_ONLY, ResultSet.CONCUR_READ_ONLY);
st.setFetchSize(Integer.MIN_VALUE); 
```

只进、只读结果集与 Integer.MIN_VALUE 提取大小的组合用作驱动程序逐行流式传输结果集的信号。在此之后，将逐行检索使用该语句创建的任何结果集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:28:24.230

在返回之前尝试添加`objectIn.close();`，它可能会有所帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T12:40:09.310

您可以通过使用`-mx256m`256mb 堆空间或`-mx512m`512mb 等选项来增加堆空间。

通过在网络上设置 VM 参数来搜索增加的堆空间。

这可能会有所帮助

[在 Java 中增加堆大小](https://stackoverflow.com/questions/1565388/increase-heap-size-in-java)

# iphone - 使用 NSFetchedResult 控制器处理节标题

> ID：12790194
> 
> 赞同：2
> 
> 时间：2012-10-08T22:12:05.413
> 
> 标签：iphone, objective-c, ios, ipad, core-data

我是核心数据的新手，目前我正在使用核心数据模型构建应用程序。我想要实现的是一个表格视图，每个月都有部分标题。目前我的应用程序正在运行，它显示每个单元格中的所有数据，但没有每个月的部分标题。我想要的是带有“日期”的对象：“26/08/2012”显示在标题为八月的部分下方。

我有一个包含以下数据的 json 网络服务。

```
 "date": "26/08/2012",
    "hour": "18u00",
    "type": "JPL",
    "home": "KRC Genk",
    "away": "Zulte-Waregem",
    "homeScore": "2",
    "awayScore": "0" 
```

我构建了它的一个 NSManagedObject 子类，以及这个类的一个类别来将值存储在数据库中。这一切都有效。为了将这些值放在表格视图中，我有以下方法。

```
- (void)getKalender // attaches an NSFetchRequest to this UITableViewController
{
    NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Kalender"];
    request.sortDescriptors = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"date" ascending:YES]];

    self.fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request
                                                                        managedObjectContext:self.genkDatabase.managedObjectContext
                                                                          sectionNameKeyPath:nil
                                                                                   cacheName:nil];

} 
```

这就是我在 cellForRowAtIndexPath 中所做的

```
static NSString *simpleTableIdentifier = @"KalenderCell";

        KalenderCell *cell = (KalenderCell *)[tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];
        if ((cell == nil) || (![cell isKindOfClass:KalenderCell.class]))
        {
            NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"KalenderCell" owner:self options:nil];
            cell = [nib objectAtIndex:0];
        }

        // ask NSFetchedResultsController for the NSMO at the row in question
        Kalender *kalender = [self.fetchedResultsController objectAtIndexPath:indexPath];
        // Then configure the cell using it ...

        NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
        [dateFormat setDateFormat:@"dd/MM"];
       NSString *dateStr = [dateFormat stringFromDate:kalender.date];
        cell.lblType.text           = kalender.type;
        cell.lblHome.text           = kalender.home;
        cell.lblHomeScore.text      = kalender.homeScore;
        cell.lblAwayScore.text      = kalender.awayScore;
        cell.lblAway.text           = kalender.away;
        cell.lblDate.text           = dateStr;
        cell.lblHour.text           = kalender.hour;

        return cell; 
```

但在这里我被困住了。谁能帮助我如何使用 NSFetchedResult 控制器设置这些部分标题？

提前谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T22:21:44.997

*只需在 NSFetchedResultsController 初始的sectionNameKeyPath*中设置要使用的字段的名称，如下所示：

```
self.fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request managedObjectContext:self.genkDatabase.managedObjectContext sectionNameKeyPath:@"date" cacheName:nil]; 
```

这应该将日期字符串设置为部分名称。随意使用您想要的任何字段。

# java - Java中的for循环...创建金字塔

> ID：12790195
> 
> 赞同：-2
> 
> 时间：2012-10-08T22:12:10.330
> 
> 标签：java

我应该编写一个嵌套的 for 循环来打印以下输出：

```
 1
                1  2  1
             1  2  4  2  1
          1  2  4  8  4  2  1
       1  2  4  8 16  8  4  2  1
    1  2  4  8 16 32 16  8  4  2  1
 1  2  4  8 16 32 64 32 16  8  4  2  1 
```

我应该使用两种方法。

main 方法只应该从用户那里获取所需的行数。我应该编写另一个名为 printPyramid 的方法：

1.  有行数
2.  打印具有该行数的金字塔
3.  什么都不返回。

到目前为止，我有：

```
 import java.util.Scanner;

    public class Pyramid {

    //Getting number of rows, calling printPyramid in main method

    public static void main(String[] args) {

    Scanner input = new Scanner(System.in);

    //Get user input = number of lines to print in a pyramid
    System.out.println("Enter the number of lines to produce: ");
    int numLines = input.nextInt();

    //call method:
    printPyramid();

    }//End of main method

    //Making a new method...

    public static void printPyramid (int numLines) {

    int row;
    int col;

    row = 0;
    col = 0;

        for (row = 1; row <= numLines; row++){
            //print out n-row # of spaces
            for (col = 1; col <= numLines-row; col++){
                System.out.print("  ");
            }

            //print out digits = 2*row-1 # of digits printed
            for (int dig= 1; dig <= 2*row-1; dig++){
                System.out.print(row + "  "); 
            }

        System.out.println();
        }//end of main for loop

    }//end of printPyramid

    }//end of class 
```

我得到错误，我不知道如何让它正确打印出来。我相信方法搞砸了？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-08T22:26:32.440

这里有两个大错误。首先， Java 中的**ALL**都是类，因此您必须将该*main*方法放在一个类中。例如：

```
public class Anything {
    public static void main ...

    public static void printPyramid ...
} 
```

第二个，你必须调用`printPyramid`main里面的方法，因为如果不先调用它就不会被执行。

```
public class Anything {
    public static void main ... {
         ...
         printPyramid (numLines);
         ...
    }

    public static void printPyramid ...
} 
```

我希望这个小迹象对你有所帮助。

# sql - SSMS 2012 中的 VS 样式片段。它们存在吗？

> ID：12790196
> 
> 赞同：2
> 
> 时间：2012-10-08T22:12:15.867
> 
> 标签：sql, visual-studio, ssms, code-snippets, ssms-2012

我正在尝试在 SQL Server 管理工作室中设置一个简单的片段。当我听到“片段”这个词时，我认为它们会像在 Visual Studio 中那样工作。我的意思是有一些变量被填写，等等......我没有看到。

有人可以告诉我 SSMS 2012 是否支持 Visual Studio 样式片段。如果是这样，您能否提供一个支持变量替换的片段示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T23:11:57.173

这可能与您要查找的内容接近。在 View->Template explorer 下列出了您在使用、构建、开发数据库时经常使用的一大堆结构。您也可以使用`Ctrl+Alt+T`. 那里实际上有数百个。从构建视图到设置触发器再到创建 XML 模式的一切。

模板的真正好处是您可以构建自己经常使用的结构。我已经构建了很多我自己的模板来保存我从[Brent Ozars blitz 脚本](http://www.brentozar.com/blitz/)和其他人（如[Adam Machanic 改进的 SP_WHO](http://sqlblog.com/blogs/adam_machanic/archive/2007/12/31/a-gift-of-script-for-2008-who-s-active-what-are-they-doing-and-who-is-blocked.aspx)等）获得的片段。

虽然可能不像您在 Visual Studio 项目中找到的那些花哨（阅读交互式），但我发现它们非常方便。

如果您使用这些模板，还有另一个非常方便的小功能。如果您按下**`Ctrl-Shift-M`**（或使用显示 A->B 的工具栏按钮），您会看到一个对话框，让您可以轻松地将模板参数替换为您自己的值。

* * *

更新 SSMS2012 的后期研究

我最近才开始使用 SSMS 2012，发现有一个我不知道的新功能。右键单击时，您实际上会看到“插入片段”下拉菜单。我现在更好地理解了你的问题。然而，显然，这些与我上面发布的几乎相同。

# iphone - 带有徽章编号的 TableView 行

> ID：12790197
> 
> 赞同：2
> 
> 时间：2012-10-08T22:12:23.853
> 
> 标签：iphone, objective-c, ios, ios5

如何将徽章图标添加到表格视图中的一行？这方面的一个例子是 iOS 中的邮件应用程序，其中收件箱行有一个徽章图标，显示未读邮件的数量？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T22:19:33.837

[TDBadgedCell](https://github.com/tmdvs/TDBadgedCell)是一个很好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:15:49.567

您必须自己创建它，因为没有用于此的模板单元格。幸运的是它非常简单，为数字创建一个带有样式标签的自定义单元格，并根据模型对象中的信息在 cellForRowAtIndexPath: 中更新它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T22:17:34.087

要么创建一个自定义 tableViewCell，其中包含 a`UILabel`作为子视图，要么将 UILabel 添加到单元格的 contentView。

不过，我建议您创建自己的（自定义）tableViewCell。

要获得标签的徽章形状，您可以使用“cornerRadius”来获得圆形，并设置`backgroundColor`、`textColor`和`borderWidth`、 和`borderColor`。获得*unreadCount 后*，只需将其分配给您的 customCell 的 badgeLabel 的文本属性。

就那么简单 ！

# c++ - C++ 浮点数组初始化

> ID：12790198
> 
> 赞同：26
> 
> 时间：2012-10-08T22:12:28.260
> 
> 标签：c++, arrays, floating-point, initialization

> **可能重复：**
> [C 和 C++：自动结构的部分初始化](https://stackoverflow.com/questions/10828294/c-and-c-partial-initialization-of-automatic-structure)

在阅读[Code Complete](https://rads.stackoverflow.com/amzn/click/com/0735619670)时，我遇到了一个 C++ 数组初始化示例：

```
float studentGrades[ MAX_STUDENTS ] = { 0.0 }; 
```

我不知道 C++ 可以初始化整个数组，所以我测试了它：

```
#include <iostream>
using namespace std;

int main() {
    const int MAX_STUDENTS=4;
    float studentGrades[ MAX_STUDENTS ] = { 0.0 };
    for (int i=0; i<MAX_STUDENTS; i++) {
        cout << i << " " << studentGrades[i] << '\n';
    }
    return 0;
} 
```

该程序给出了预期的结果：

```
0 0
1 0
2 0
3 0 
```

但是将初始化值从更改`0.0`为，例如`9.9`：

```
float studentGrades[ MAX_STUDENTS ] = { 9.9 }; 
```

给出了有趣的结果：

```
0 9.9
1 0
2 0
3 0 
```

初始化声明是否仅设置数组中的第一个元素？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-10-08T22:29:09.923

You only initialize the first N positions to the values in braces and all others are initialized to 0\. In this case, N is the number of arguments you passed to the initialization list, i.e.,

```
float arr1[10] = { };       // all elements are 0
float arr2[10] = { 0 };     // all elements are 0
float arr3[10] = { 1 };     // first element is 1, all others are 0
float arr4[10] = { 1, 2 };  // first element is 1, second is 2, all others are 0 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-08T22:14:36.700

不，它将所有未明确设置为默认初始化值的成员/元素设置为数字类型为零。

# javascript - 对 JSON 数据进行分组的函数

> ID：12790204
> 
> 赞同：1
> 
> 时间：2012-10-08T22:12:43.857
> 
> 标签：javascript

我正在尝试用 javascript 编写一个函数，该函数从 JSON 输入数据返回属于特定组的数据，包括该组的子组。数据如下所示：

```
 [
            {"id":"0", "name":"Person 0"},
            {"id":"1", "name":"Person 1","group":"0"},
            {"id":"2", "name":"Person 2","group":"0"},
            {"id":"3", "name":"Person 3","group":"2"},
            {"id":"4", "name":"Person 4","group":"2"},
            {"id":"5", "name":"Person 5","group":"4"},
            {"id":"6", "name":"Person 6","group":"4"},
            {"id":"7", "name":"Person 7","group":"0"},
            {"id":"8", "name":"Person 8","group":"7"}
            ] 
```

这里，组 x 中的人与 id x 的人属于同一组。

例如：function(data, group) 将为 function(data, 2) 返回以下内容：

```
 [
            {"id":"3", "name":"Person 3","group":"2"},
            {"id":"4", "name":"Person 4","group":"2"},
            {"id":"5", "name":"Person 5","group":"2"},
            {"id":"6", "name":"Person 6","group":"2"},
            ] 
```

和功能（数据，0）：

```
 [
            {"id":"1", "name":"Person 1","group":"1"},
            {"id":"2", "name":"Person 2","group":"2"},
            {"id":"3", "name":"Person 3","group":"2"},
            {"id":"4", "name":"Person 4","group":"2"},
            {"id":"5", "name":"Person 5","group":"2"},
            {"id":"6", "name":"Person 6","group":"2"},
            {"id":"7", "name":"Person 7","group":"7"},
            {"id":"8", "name":"Person 8","group":"7"}
            ] 
```

我试图循环遍历数组，但这不处理子组，所以我想我必须以递归方式来做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:17:44.947

您可以`.reduce()`在子组中进行数据数组和连接。

```
function dataForGroup(data, group, refs) {
    if (!refs)
        refs = {};

       // check if it's in the list
    if (refs[group] === true)
        return []; // or you can throw an Error
    else
        refs[group] = true; // first encounter, so add it to the list

    return data.reduce(function(res, obj) {
        return obj.group == group ? 
                   res.concat(obj, dataForGroup(data, obj.id, refs)) : res;
    }, []);
} 
```

希望没有循环引用！

~~虽然我不理解`group(data, 0)`输出，也没有看到任何子组数据。~~

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:17:15.310

遍历整个数据数组并过滤掉具有相同组的项目。

```
 var newArr = [],
    isVisted = []; // using to prevent circular reference.

function getGroup(data, groupId, inside) {
    if (!inside) {
        newArr = [];
        isVisted = [];
    }
    if (isVisted.indexOf(groupId) !== -1) {
        return
    };
    for (var k = 0; k < data.length; k++) {
        if (data[k].group == groupId) {
            newArr.push(data[k])
            getGroup(data, data[k].id, true);
        }
    }

    return newArr;
} 
```

[jsfiddle 演示](http://jsfiddle.net/zTFbz/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T22:20:17.397

因为你说使用javascript，所以我只使用javascript。然而，在 jquery 中有更简单的方法来做这样的事情。我没有测试它，只是写了它，所以如果有任何问题，请不要犹豫发表评论。

```
function Group(data)
{
    var result = [];

    for (var item in data)
    {
        var group = (item.group) ? item.group : -1;

        if (!result[group])

            result[group] = [];

        result[group].push(item);
    }

    return result;
}

var secondGroup = Group(
    [
        {"id":"0", "name":"Person 0"}, 
        {"id":"1", "name":"Person 1","group":"0"}, 
        {"id":"2", "name":"Person 2","group":"0"}, 
        {"id":"3", "name":"Person 3","group":"2"}, 
        {"id":"4", "name":"Person 4","group":"2"}, 
        {"id":"5", "name":"Person 5","group":"4"}, 
        {"id":"6", "name":"Person 6","group":"4"}, 
        {"id":"7", "name":"Person 7","group":"0"}, 
        {"id":"8", "name":"Person 8","group":"7"} 
    ]
)[2]; 
```

干杯

# mysql - 通过 ssl 连接到 mysql 的最佳 Node.js mysql 模块是什么？

> ID：12790205
> 
> 赞同：6
> 
> 时间：2012-10-08T22:12:52.793
> 
> 标签：mysql, node.js, ssl, node-mysql

到目前为止，我已经使用[node-mysql](https://github.com/felixge/node-mysql)构建了我的应用程序。我刚刚使用 AWS RDS 服务设置了一个可安全访问的 mysql 数据库，并已使用 mysql 命令行客户端成功测试了 SSL 连接。我有亚马逊的公钥 .pem 文件。node-mysql 似乎没有用于 SSL 连接选项的 api。

到目前为止我发现的唯一一个是[Node-mysql-libmysqlclient](https://github.com/Sannis/node-mysql-libmysqlclient)但我在尝试连接它时遇到了错误，关于绑定依赖项为空，所以我不确定我是否应该信任它。建议使用哪个模块/api？或者，如果您知道我需要在 node-mysql 中修改什么，我愿意稍微修改一下，但看起来它正在使用较低级别的套接字连接到 MySQL，所以我不确定获得添加了 SSL 部分。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-08-06T21:18:35.030

```
var mysql  = require('mysql');
var fs     = require('fs');

var connection = mysql.createConnection({
  host     : 'localhost',
  user     : 'me',
  password : 'secret',
  database : 'my_db',
  ssl      : {
        ca   : fs.readFileSync('./ssl/server-ca.pem'), // should be enough for AWS
        key  : fs.readFileSync('./ssl/client-key.pem'), // required for google mysql cloud db
        cert : fs.readFileSync('./ssl/client-cert.pem'), // required for google mysql cloud db
  }
}); 
```

这应该够了吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-28T09:41:47.900

node-mysql 模块支持 ssl 连接，如下所示：[https](https://github.com/felixge/node-mysql#ssl-options) ://github.com/felixge/node-mysql#ssl-options 。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2018-04-08T08:51:57.320

使用续集！为 MariaDB/MySQL 提供最好的 ORM。 [https://github.com/sequelize/sequelize](https://github.com/sequelize/sequelize)

```
npm install sequelize
--- then ---
npm install mariadb
--- or ---
npm install mysql 
```

# html - CSS字体不起作用

> ID：12790208
> 
> 赞同：-3
> 
> 时间：2012-10-08T22:13:12.403
> 
> 标签：html, css

此页面上表单标签中的字体 - [http://bakebox.in/order-form/](http://bakebox.in/order-form/)必须与此页面中的相同 - [http://bakebox.in/test/](http://bakebox.in/test/) 我尝试使用相同的字体标签对于两者，但它不起作用

```
font: 300 18px 'BebasNeueRegular', Arial, sans-serif; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T22:16:52.810

您可能缺少`@font-face`工作版本中的声明：

```
@font-face {
    font-family: "BebasNeueRegular";
    font-style: normal;
    font-weight: normal;
    src: url("BebasNeue/BebasNeue-webfont.eot?#iefix") format("embedded-opentype"), url("BebasNeue/BebasNeue-webfont.woff") format("woff"), url("BebasNeue/BebasNeue-webfont.ttf") format("truetype"), url("BebasNeue/BebasNeue-webfont.svg#BebasNeueRegular") format("svg");
} 
```

在 wp-content/themes/in-motion/style.css 样式表中。

# jquery - CSS 和 Jquery 悬停

> ID：12790209
> 
> 赞同：1
> 
> 时间：2012-10-08T22:13:16.100
> 
> 标签：jquery, html, jquery-selectors, hover, show-hide

**编辑**：在此编辑之前，我要求提供涉及 CSS 的解决方案。我被告知我需要 Javascript 来完成以下任务

**描述**：我有一个显示成员完整个人资料的类（profile-inner）。它的背景颜色是白色。我已经悬停在 profile-inner 工作。它的背景颜色是灰色。“profile-footer”类中有“评论”链接。单击它时，它会切换类“inline-profile-comment”（展开/折叠）。

**问题**：“profile-inner”悬停选择整个容器，包括切换类“inline-profile-comment”。我不想要这个。我只希望在未显示“inline-profile-comment”时悬停。

**网页**：

```
<div class="profile-inner">
  an entire profile

    <div class="profile-footer">
      <a data-toggle="collapse" data-target="#<%= profile_item.id %>_comment">
       Comment</a> 
       <ul><li>lots of list items etc</li></ul>

       <div class="inline-profile-comment">
      <div id="<%= profile_item.id %>_comment" class="show collapse">
     The comment form
   </div></div>

 </div></div> 
```

**CSS**：

```
.profile-inner {
  background-color: rgb(255, 255, 255);
}

.profile-inner:hover {
  background-color: rgb(243, 243, 243);
  cursor: pointer;
} 
```

我希望我已经解释得足够好。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:37:31.600

这是一个概念证明。我非常喜欢在对象的主要元素上切换状态，在这种情况下是你的 profile-inner。本质上，我们所做的是使用“隐藏评论”状态来定义我们的 CSS 规则，切换评论表单和悬停。

[http://jsfiddle.net/amustill/NgzU6/](http://jsfiddle.net/amustill/NgzU6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:37:31.630

我认为如果您`add/remove`在切换发生后上课并将`css`悬停选择器更改为该选择器，则可以执行此操作`class`，例如

**JS**

```
$('.profile-inner').toggleClass('hover');
$('.profile-footer a').on('click', function(e){
    e.preventDefault();
    $('.inline-profile-comment').toggle('fast',function(){
        $('.profile-inner').toggleClass('hover');
    });
}); 
```

**CSS**

```
profile-inner {
    background-color: rgb(255, 255, 255);
}
.profile-inner.hover:hover {
    background-color: rgb(243, 243, 243);
    cursor: pointer;
}
.inline-profile-comment{ display:none; } 
```

[**工作示例**](http://jsfiddle.net/6Awaz/3/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T22:27:04.073

你可以做你所拥有的，再加上这个：

```
.profile-inner:hover .inline-profile-comment {
    background-color: Whatever it should be; } 
```

# macos - Sudo 不提示输入密码 Mac bash 脚本

> ID：12790213
> 
> 赞同：1
> 
> 时间：2012-10-08T22:13:40.813
> 
> 标签：macos, bash, sudo

我正在尝试编写一个脚本，将一行附加到 /etc/hosts，这意味着我需要 sudoer 权限。但是，如果我从桌面运行脚本，它不会提示输入密码。我只是得到许可被拒绝。

示例脚本：

```
#!/bin/bash
sudo echo '131.253.13.32        www.google.com' >> /etc/hosts
dscacheutil -flushcache 
```

一个终端弹出并说权限被拒绝，但实际上从未提示输入 sudo 密码。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T22:59:10.917

[sudo 不适用于重定向运算符](https://stackoverflow.com/questions/11617305/why-does-shell-redirection-fail-when-using-echo-sudo)。您可以使用`echo | sudo tee -a`或`sudo bash -c 'echo >>'`：

```
echo 131.253.13.32 www.google.com | sudo tee -a /etc/hosts
sudo bash -c 'echo 131.253.13.32 www.google.com >> /etc/hosts' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:04:42.427

您在这里所做的实际上是：

1.  切换到root，然后运行`echo`

2.  切换回自己并尝试将输出附加`sudo`到 `/etc/hosts`

那是行不通的，因为当你追加到时你需要是 root `/etc/hosts`，而不是在运行时`echo`。

最简单的方法是

```
sudo bash -c "sudo echo '131.253.13.32        www.google.com' >> /etc/hosts" 
```

它将以 root 身份运行 bash 本身。但是，这并不是特别安全，因为您现在以 root 身份调用 shell，这可能会做很多讨厌的事情（特别是，它会执行名称在环境变量 BASH_ENV 中的文件的内容，如果有一. 所以你可能更愿意谨慎一点：

```
sudo env -i bash -c "sudo echo '131.253.13.32        www.google.com' >> /etc/hosts" 
```

# git - Git 推送到 Azure 失败（RPC 失败）

> ID：12790215
> 
> 赞同：7
> 
> 时间：2012-10-08T22:13:43.963
> 
> 标签：git, azure

我已经通过 Git 部署到 Azure 几个月了，没有出现重大问题，但现在我似乎遇到了一个我无法克服的错误。

我创建了一个新的 Azure 网站，为正在开发的项目创建单独的预览链接。我在新站点上设置了 Git 发布，并尝试推送我在其他 Azure 网站上使用的相同项目存储库。但是，每次推送尝试都会失败：

```
error: RPC failed; result=56, HTTP code = 0
fatal: The remote end hung up unexpectedly
fatal: The remote end hung up unexpectedly 
```

我尝试推送一个更小的提交（只是一个空的文本文件），并且推送很好。

我相当肯定这个错误是由于我的回购大小（~50mb）造成的。由于这是一个新的推送，它需要传输完整的 repo 大小，而不是我几个月来一直在做的增量推送。

我试过增加我的`http.postBuffer`：

```
git config http.postBuffer 524288000 
```

但我的推动仍然失败。

Azure 是否需要增加它收到的 POST 请求的大小？或者还有其他我不知道的修复方法吗？

有什么建议么？

**更新：**
这是一个已知问题。它（到目前为止）已被缩小为 Mac 和 https 组合的问题。您可以关注[MSDN](http://social.msdn.microsoft.com/Forums/en-US/azuregit/thread/2edc314d-8e18-4d12-843e-92d6de6c3c3d/)和[GitHub 上](https://github.com/projectkudu/kudu/issues/171)的问题主题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:45:18.907

我很确定这不是您可以自己解决的问题。我还有两个网站 git push 今天早上运行良好，但现在我遇到了同样的错误。让我们拭目以待，看看会发生什么……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-02T13:50:49.470

**我的环境**

Windows 7 在运行 El Capitan（版本 10.11.5）的 Macbook Pro 上运行 VMWare Fusion。使用 Git Bash 作为我的客户端。Azure 应用服务作为我的远程 git 目标。

**问题**

我有两个环境在 Azure 上作为 Web 应用程序（应用程序服务）运行，用于同一个站点（一个登台环境和一个生产环境）。

当我通过 git push 推送到暂存环境时，我没有问题。

当我通过 git push 推送到生产环境时，我收到以下错误消息：

```
RPC failed; curl 56 SSL read: error:00000000:lib(0):func(0):reason(0), errno 10054
The remote end hung up unexpectedly 
```

**解决方案**

在阅读了@redhotvengeance 的更新后，我启动了我的 Windows 7 桌面并将源代码下载到它，然后推送到我的 Azure 生产环境（失败的部署），它完成了推送，没有任何问题。

似乎它可能是某种 Azure / Mac 问题。

# python - 为什么我不能用同一个模型注册多个 Django ModelAdmin？

> ID：12790220
> 
> 赞同：9
> 
> 时间：2012-10-08T22:14:20.363
> 
> 标签：python, django, django-models, django-admin

我有以下模型管理员：

```
class EventAdmin(admin.ModelAdmin):
    # ModelAdmin config

    def queryset(self, request):
        queryset = super(EventAdmin, self).queryset(request)
        return queryset.exclude(date_end__lt=date.today())

admin.site.register(Event, EventAdmin) 
```

现在我想添加一个模型来管理存档（比今天更早）的事件。

```
class EventArchiveAdmin(admin.ModelAdmin):
    # ModelAdmin config

    def queryset(self, request):
        queryset = super(EventArchiveAdmin, self).queryset(request)
        return queryset.filter(date_end__lt=date.today())

admin.site.register(Event, EventArchiveAdmin) 
```

但是如果我尝试这样做，我会得到*AlreadyRegistered*异常。

为什么我不能用相同的模型实现另一个 ModelAdmin，我怎样才能获得同一模型的不同*管理视图*？

我知道我可以`list_filter`在我的课堂上实现一​​个自定义，但我想把事情分开放在不同的页面中。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-08T22:15:29.663

使用代理模型：

```
class Event(db.Model):
     ...

class ActiveEventManager(models.Manager):
    def get_queryset(self):
        return super(ActiveEventManager, self).get_queryset().filter(active=True)

class ActiveEvent(Event):
    class Meta:
        proxy = True

    objects = ActiveEventManager()

class ArchiveEventManager(models.Manager):
    def get_queryset(self):
        return super(ArchiveEventManager, self).get_queryset().filter(active=False)

class ArchiveEvent(Event):
    class Meta:
        proxy = True

    objects = ArchiveEventManager() 
```

现在，您可以注册 2 个没有覆盖`ModelAdmin.queryset`方法的模型：

```
class EventAdmin(admin.ModelAdmin):
    # ModelAdmin config

admin.site.register(ActiveEvent, EventAdmin)
admin.site.register(ArchiveEvent, EventAdmin) 
```

您可以在文档中阅读有关[代理模型](https://docs.djangoproject.com/en/1.4/topics/db/models/#proxy-models)和[管理器的模式。](https://docs.djangoproject.com/en/1.4/topics/db/managers/#modifying-initial-manager-querysets)

另外，使用这个：

```
queryset = super(EventArchiveAdmin, self).queryset(request) 
```

作为第一个参数`super()`，采用*当前*课程。见[文档](http://docs.python.org/library/functions.html#super)

**注意：** django在 django==1.7 中已重命名`Manager.get_query_set`为。`Manager.get_queryset`

# dynamics-crm-2011 - 使用联系人创建活动时，我应该如何实现 `OnLoad` 事件处理程序？

> ID：12790228
> 
> 赞同：1
> 
> 时间：2012-10-08T22:14:55.743
> 
> 标签：dynamics-crm-2011

我已经使用活动类型的自定义实体创建了自己的解决方案。我想在**使用现有联系人**创建新实例时显示一条消息，但不允许用户创建一个，如果**只是尝试这样做而不通过 contact**。

基本上，我的目标是创建该活动并非不可能（除了一种方式外，任何尝试都会直接隐藏表单）。用户必须转到联系人（或潜在客户等）并在其中添加并创建自定义活动实体的实例。这样，我可以保证已经填写了“关于”字段。

我猜我需要以某种方式检测表单的打开是一种创造尝试。我怎样才能做到这一点？

此外，就像现在一样，用户无法创建自定义类型的非接触式活动，因为它不会与其他活动一起出现在菜单上。我必须以某种方式禁用它，但我不知道如何。有谁有吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:55:23.400

您可以通过多种方式做到这一点，但最简单的可能是：

*   将相关字段设为只读。
*   将相关字段设为必填项。

这样，如果用户打开一个创建新表单，他们将无法设置相关信息，并且因为它是强制性的，他们将无法保存记录。当他们通过现有联系人打开时，相关字段将自动映射。也就是说，在这种情况下，只要强制要求就足够了。

（[作为一个侧面，JavaScript 可用于识别当前表单状态](http://crmbusiness.wordpress.com/2011/04/17/crm-2011-using-javascript-to-identifying-if-a-form-is-in-create-or-update-contect/)，但我不确定这在这里有多大用处）。

就自定义活动出现的位置而言，默认情况下，我的活动显示在多个位置，例如：

*   CRM > 工作场所 > 活动 > 功能区 > 其他活动 > XXX。
*   CRM > 工作场所 > 活动 > 视图选择器 > XXX。

它们不会显示在工作场所的左侧导航下方，因为它们被分组在“活动”下。我很确定这些都是默认设置。

您可以通过编辑站点地图来进行更大的控制，您可以在其中放置几乎任何东西，任何地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T06:26:54.710

除了 Wood 先生，我想向您展示一些代码。它按预期工作，但我不确定它是否是最佳的。

```
var foo = function () {

  var whatIsGoingOn = Xrm.Page.ui.getFormType();

  if (whatIsGoingOn === 1)
    alert("Let there be an entity!");
  else
    alert("Not a creation...");
} 
```

[此处](http://msdn.microsoft.com/en-us/library/gg327828.aspx)列出了其他状态（删除、更新等）的数值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T10:44:34.507

回答你问题的第二部分：

创建自定义活动时，您可以通过选中实体表单右上角的框来选择是否将其显示在“正常”活动菜单中。据我所知，这是一次唯一的选择，以后无法更改。

对于您的设置，我建议不要选中此框，因此它不会出现在活动菜单中，以避免用户甚至被诱惑这样做。

相反，将活动 N:1 的显式关系添加到 Contact，并将另一个 N:1 的关系添加到 Lead。使用此关系将您的活动添加到联系人和潜在客户表单的左侧导航中，或为它们添加一个网格（取决于您希望如何使用它以及是否需要将视图过滤为默认的“关联视图”以外的其他内容）。

当用户导航到此部分时，他们将查看是否存在任何以前的此类活动，并能够添加新活动。但是这意味着子记录是通过这种关系的子记录，而不是使用“关于”，因此在活动的表单上使用脚本，以便如果填写了联系人，则将其复制到相关，如果填写了线索然后复制。如果两者都不是，则使用警报或其他方式警告用户出现问题（参见前面的评论）。如果您希望有关是只读但由脚本填写，则需要确保使用强制保存值：

```
Xrm.Page.getAttribute("regardingobjectid").setSubmitMode("always"); 
```

您必须在表单上查找联系人和潜在客户才能在脚本中使用它们，但您可以将它们设置为“默认不可见”，以便它们存在但用户看不到（并且不占用空间） .

# design-patterns - Creating Inter-Instance Awareness on Objects? Good idea or bad?

> ID：12790229
> 
> 赞同：1
> 
> 时间：2012-10-08T22:15:09.217
> 
> 标签：design-patterns, user-interface, singleton

I'm playing around with a user interface that will allow the creation of one or multiple items of a base type that the user can manipulate.

Some of the manipulations the user makes to one object will affect the others. Think about a vector drawing tool that allows multi-select. If the user drags one object the others should move as well.

I do have a parent container object which *could* be responsible for handling communication between the objects but since that's all it would be doing I feel like this approach is too tightly coupled. I feel like an approach that allows the objects to communicate with each other independently of any outside classes would be a better design.

I was considering something along the lines of a singleton communicator class defined inside the object. It's purpose would be to keep a list of the objects and alert the other objects to various events such as a new object being added, removed or some other manipulation that may or may not affect the behavior of the other objects.

Is this a bad design? Off the cuff thoughts are appreciated as well as any resources you may have on the subject. Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T07:00:56.837

I think I would go with a Composite instead.

In the multiple select case, add all selected objects to the Composite instance. You can now manipulate the group as a whole via the Composite.

# shell - find 和 cat 合并 csv 文件

> ID：12790231
> 
> 赞同：1
> 
> 时间：2012-10-08T22:15:16.317
> 
> 标签：shell, find, cat

我在 ~/data 的子目录中有数千个文件。我希望合并所有具有特定扩展名的 csv 文件，例如 .x 并将合并的文件保存到 ~/data/merged.x

我知道我需要将 find、cat 和 >> 与选项 -iname 一起使用，但我发现它很难做到。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:17:38.317

```
find ~/data -name "*.x" | while read file
do
    cat $file >> ~/data/merged.x
done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:06:24.920

```
find ~/data -type f ! -name 'merged.x' -a -name '*.x' -exec cat {} \+ >> ~/data/merged.x 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T07:35:25.270

```
find ./data/ -type f -name "*.c*" | xargs cat > ~/data/merged.x 
```

# python - 使用python的对象和字符串定义一个类

> ID：12790233
> 
> 赞同：1
> 
> 时间：2012-10-08T22:15:39.160
> 
> 标签：python, string

我被告知

> 定义一个新类 Track，它有一个艺术家（一个字符串）、一个标题（也是一个字符串）和一个专辑（见下文）。
> 
> 1.  有方法`__init__(self, artist, title, album=None)`。参数艺术家和标题是字符串，专辑是专辑对象（见下文）
> 2.  有一个方法`__str__(self)`可以返回此轨道的合理字符串表示
> 3.  有一种方法`set_album(self, album)`可以将此曲目的专辑设置为专辑

这是我第一次使用类，我想知道是否有人可以解释在 Python 中使用字符串和对象之间的区别。我`__str__`也读过，但我不确定它是如何工作的。它说“返回的字符串`__str__`是供应用程序用户查看的”，但我从来没有看到我的输入的返回值。有人可以解释一下please的用法`__str__`吗？

我不确定我是否正确地遵循了指南，如果有人可以确认我所做的事情是正确的，那就太好了。

```
class Track:
    def __init__(self, artist, title, album=None):
        self.artist = str(artist)
        self.title = str(title)
        self.album = album

    def __str__(self):
        return self.artist + " " + self.title + " " + self.album

    def set_album(self, album):
        self.album = album

Track = Track("Andy", "Me", "Self named") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T22:32:50.713

你的课程对我有好处，但如果你真的希望属性是字符串，你应该考虑使用@property 装饰器并制作propper setter 和getter。下面的例子：

```
class Track:
    def __init__(self, artist, title, album=None):
        self._artist = str(artist)
        self._title = str(title)
        self._album = album

    def __str__(self):
        return self.artist + " " + self.title + " " + self.album
    #example for artist
    @property
    def artist(self):
        return self._artist
    @artist.setter
    def artist(self, artist):
        if artist != type("string"):#ensure that value is of string type.
            raise ValueError
        else:
            self._artist = artist
    #this way you could properly make setters and getter for your attributes
    #same ofr the other stuff

Track = Track("Andy", "Me", "Self named") 
```

# c++ - 推入队列期间的内存泄漏

> ID：12790239
> 
> 赞同：3
> 
> 时间：2012-10-08T22:16:03.767
> 
> 标签：c++, c, memory-leaks, queue

我一直在为我的数据网络课程做一个项目，我遇到了内存泄漏，但我不明白为什么会这样。

顺便说一句，我知道 C 和 C++ 的混合很糟糕，但我对此无能为力，它基于类代码，我无法修改它，我知道这不是一个好方法它和我需要使用 char* 作为必要条件。

我的程序是多线程的，我处理这个结构：

```
typedef struct packetQueue
{
    char* buf;
    int length;

    packetQueue()
    {
        buf = nullptr;
        length = 0;
    }

    packetQueue(char* buffer, int len)
    {
        length = len;
        buf = new char[length + 1];
        memcpy(buf, buffer, len);
        buf[length] = '\0';
    }

    packetQueue(const packetQueue& other)
    {
        length = other.length;

        if (other.buf)
        {
            buf = new char[length + 1];
            memcpy(buf, other.buf, length);
            buf[length] = '\0';
        }
        else
        {
            buf = nullptr;
        }
    }

    packetQueue& operator=(const packetQueue& that)
    {
        if (this == &that)
        {
            return *this;
        }

        delete[] buf;

        length = that.length;

        if (that.buf)
        {
            buf = new char[length + 1];
            memcpy(buf, that.buf, length);
            buf[length] = '\0';
        }
        else
        {
            buf = nullptr;
        }
        return *this;
    }

    ~packetQueue()
    {
        delete[] buf;
        buf = nullptr;
    }

} PACKET; 
```

在我的带有两个参数的构造函数中，我做了那个赋值，因为我的队列的推送对我的结构做了一个深拷贝，就像我有我的拷贝构造函数一样，我已经处理了。所以，我有一个线程（我一直在测试，VLD结果只是针对这个）。

```
DWORD _stdcall PHY_in_Thread(void* data)
{
    int numbytes, counter = 0;

    SOCKET hostSocket = *(SOCKET*) data; // Socket where the host receives

    struct sockaddr_in si_recvfrom;
    struct sockaddr_storage their_addr;
    socklen_t addr_len;

    addr_len = sizeof their_addr;

    while ( 1 )
{
    char* recBuf = new char[BUFLEN + 1];
    // Checks if it's any buffer on the socket to be processed
    if ( (numbytes = recvfrom(hostSocket, recBuf, BUFLEN, 0, (sockaddr*) &si_recvfrom, &addr_len)) == -1)
    {
        cerr << "Could not receive datagram." << endl;
        delete[] recBuf;
        closesocket(hostSocket);            
        WSACleanup();
        exit(0);
    }
    recBuf[numbytes] = '\0'; // append NULL to the end of the string

    char* temporalBuffer = new char[numbytes - CHECKSUM_MAX_SIZE + 1];
    memcpy(temporalBuffer, recBuf, numbytes - CHECKSUM_MAX_SIZE);
    temporalBuffer[numbytes - CHECKSUM_MAX_SIZE] = '\0';

    char extractedChecksum[CHECKSUM_HEX_SIZE + 1];
    DWORD crcBuffer = crc32buf(temporalBuffer, numbytes- CHECKSUM_MAX_SIZE); // Calculates the CRC32 checksum
    _snprintf(extractedChecksum, 8 , "%08lX", crcBuffer); // Prints the string in a buffer
    extractedChecksum[CHECKSUM_HEX_SIZE] = '\0';

    delete[] temporalBuffer;

    string strExtractedChecksum = extractedChecksum; // Copies the array in a string
    transform(strExtractedChecksum.begin(), strExtractedChecksum.end(), strExtractedChecksum.begin(), upper); // Uppercase the string

    // Array for store the checksum of the packet
    char readChecksum[CHECKSUM_MAX_SIZE + 1];

    // Store the checksum of the packet in local variable
    memcpy( readChecksum, &recBuf[numbytes - CHECKSUM_MAX_SIZE], CHECKSUM_MAX_SIZE);    
    readChecksum[CHECKSUM_MAX_SIZE] = '\0';

    std::stringstream stream;
    string strReadChecksum;
    for (int i = 0; i < CHECKSUM_MAX_SIZE; i++ )
    {
        int number = static_cast<int>(readChecksum[i]); // Casts every character of the checksum array

        if ( readChecksum[i] <= -1 ) // In case the int value it's negative adds the constant value to make that recognizable
        {
            number += 256;
        }

        // Convert the decimal number in a hex representation
        stream.str("");
        stream << hex << number;

        if ( stream.str().length() < 2 ) // In case it's a number less than 10, adds a 0 at the beginning
        {
            strReadChecksum += "0" +  stream.str();
        }
        else
        {
            // Working out the presentation of the number
            strReadChecksum += stream.str();
        }
    }

    std::transform(strReadChecksum.begin(), strReadChecksum.end(), strReadChecksum.begin(), upper); // Uppercase the string
    strReadChecksum[CHECKSUM_HEX_SIZE] = '\0';

    cout << "[PI] Frame #" << counter <<" received ("<< numbytes <<" bytes). " << endl;
    if ( !strcmp(strReadChecksum.c_str(), extractedChecksum) ) // Checks if the CRC are equal
    {
        cout << "[CRC] Checksum OK: 0x" << extractedChecksum << endl;
    }
    else
    {
        cout << "[CRC] Checksum failure: 0x" << extractedChecksum << endl;
    }

    // Push the packet in the MAC_in_queue to be processed
    MAC_in_queue.push(PACKET(recBuf, numbytes));
    recBuf = nullptr;
    counter++;

            break;   // Just for test one packet
}

MAC_in_queue.clear();

return 0; 
```

}

但是当我执行这个线程并向这个线程发送一些东西以存储在这个队列中时，就会出现泄漏。在此执行中，只有一项可以使事情变得简单。

```
---------- Block 29 at 0x0068F718: 264 bytes ----------
  Call Stack:
    d:\program files (x86)\microsoft visual studio 11.0\vc\include\concurrent_queue.h (402): Host.exe!Concurrency::concurrent_queue<packetQueue,std::allocator<packetQueue> >::_Allocate_page + 0xF bytes
    f:\dd\vctools\crt_bld\self_x86\crt\src\concurrent_queue.cpp (113): MSVCP110D.dll!Concurrency::details::_Micro_queue::_Push + 0xD bytes
    f:\dd\vctools\crt_bld\self_x86\crt\src\concurrent_queue.cpp (240): MSVCP110D.dll!Concurrency::details::_Concurrent_queue_base_v4::_Internal_move_push
    d:\program files (x86)\microsoft visual studio 11.0\vc\include\concurrent_queue.h (581): Host.exe!Concurrency::concurrent_queue<packetQueue,std::allocator<packetQueue> >::push + 0xF bytes
    d:\users\silex rpr\documents\visual studio 2012\projects\project3\hoster\host.cpp (638): Host.exe!PHY_in_Thread + 0x3D bytes
    0x7474339A (File and line number not available): kernel32.dll!BaseThreadInitThunk + 0x12 bytes
    0x76EC9EF2 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x63 bytes
    0x76EC9EC5 (File and line number not available): ntdll.dll!RtlInitializeExceptionChain + 0x36 bytes
  Data:
    00 00 00 00    01 00 00 00    60 F8 68 00    80 00 00 00     ........ `.h.....
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........
    CD CD CD CD    CD CD CD CD    CD CD CD CD    CD CD CD CD     ........ ........ 
```

但是我不明白这些数据泄漏在哪里，我希望我说清楚了。

预先感谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-12T14:54:05.873

在您分配的`while ( 1 )`循环开始时：`PHY_in_Thread()``recBuf`

```
char* recBuf = new char[BUFLEN + 1]; 
```

但是在循环体的末尾，你错过了释放它；您只是由于 `recBuf = nullptr;`分配而泄漏了内存。

相反，请尝试`recBuf`在循环体的末尾正确删除：

```
delete [] recBuf;
recBuf = nullptr; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T13:58:21.450

在分配“that”的副本之前，您的赋值运算符不会释放 PACKET 中的旧内容。因此，如果您覆盖某些容器代码中的条目，则被覆盖的项目所持有的缓冲区将会泄漏。那是泄漏，但我当然无法证明这是您所看到的泄漏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T04:18:00.167

您已使用以下命令在 while(1) 循环的开头分配了 recBuf：

```
char* recBuf = new char[BUFLEN + 1]; 
```

然后你将它传递给一个临时变量 PACKET(recBuf, numbytes)，它只存在于一行代码的范围内：

```
MAC_in_queue.push(PACKET(recBuf, numbytes)); 
```

现在，假设 MAC_in_queue 像这样初始化：

```
concurrent_queue<PACKET> MAC_in_queue 
```

这意味着您将同时使用复制构造函数和 operator=。因为在这两个命令中都没有释放为 buf 分配的内存，所以存在泄漏。

请阅读[这篇文章](http://www.learncpp.com/cpp-tutorial/912-shallow-vs-deep-copying/)，其中包含与您类似的示例。看看他们如何实现 Copy 构造函数和 operator =

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-12T15:36:34.417

在我看来，你的 packetQueue 没有做太多（除了内存管理，它不能正常工作）。

您可以使用标准容器来实现您的类。假设你不想要你的类的引用计数实现，我们需要排除 std::string，但你可以使用 std::vector。例如：

```
class PacketQueue
{
public:
    PacketQueue() : buf_() {}
    PacketQueue(char* buffer, int len) : buf_(buffer,buffer + len) {}
    //here your function to return the '\0' terminated buffer
    //and all the other stuff that you need
private:
    std::vector<char> buf_;
}; 
```

请注意，默认值：复制构造函数、赋值运算符和析构函数都可以，您不需要实现这些。基本上，内存管理被封装到 std::vector 中。

这也是强大的异常安全保证。你的代码不是。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-16T05:50:59.323

我只能建议我之前的其他人。泄漏在您的 while 循环中，分配了 recBuf 但没有适当的删除。详细说明：

```
//Allocates memory,ok
char* recBuf = new char[BUFLEN + 1];

//free memory when exits, ok
if ( (numbytes = recvfrom(...)) == -1)
{
    cerr << "Could not receive datagram." << endl;
    delete[] recBuf;
    ...
}

//do something with it

//And here is the problem
MAC_in_queue.push(PACKET(recBuf, numbytes));
//With this you call this constructor
// packetQueue(char* buffer, int len)
// which allocates the same amount of memory, and copies the contents of recBuf
//So, there is a +1 memory allocation

// This is not deallocate memory :)
recBuf = nullptr; 
```

我建议将 recBuf 内存分配移到循环之外，并在最后删除它（使用 delete[] recBuf ）

```
delete[] recBuf;
MAC_in_queue.clear(); 
```

，有了这个，你不会每次都不必要地分配，因此会更快一些。或者，如果您更喜欢这种方式，您应该插入如下代码：

```
 delete[] recBuf;
 recBuf = nullptr; 
```

# php - 如何配置 PHP 不解析符号链接？

> ID：12790240
> 
> 赞同：4
> 
> 时间：2012-10-08T22:16:03.683
> 
> 标签：php, linux

我的文件系统旨在以下列方式托管所有项目：

```
/[path to server]/[client name]/[project name] 
```

每个`/[client name]/[project name]`都有一个使用 UUID（36 个字符长代码）构造的符号链接。因此，请求`/[uuid]`解决到一个适当的`/[client name]/[project name]`.

我在 PHP 级别面临一个问题。PHP 自动将任何符号链接解析为真实路径。相反，我希望 PHP 使用符号路径。

我所关注的根本问题是保护客户身份。因此，无论是抛出 PHP 异常，还是转储任何错误或`__FILE__`, 或`__DIR__`值，它都应该包含符号链接而不是实际路径。

这是可配置的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T01:37:44.270

> 这是可配置的吗？

不，您需要为此修补 PHP 源代码并重新编译。

`file://`通过替换默认的流包装器，也许有一些机会（但我不知道能走多远） 。但可能不适用于主脚本。

# box-api - 带有正斜杠的文件名

> ID：12790241
> 
> 赞同：1
> 
> 时间：2012-10-08T22:16:09.830
> 
> 标签：box-api

我想知道您如何处理带有正斜杠的文件名？目前（我无法控制或更改它）我们的用户可以保存带有斜杠的文件。当我们对此进行测试时，您系统上的文件将重命名为最后一个斜杠之后的内容。

例如，名为 Test10/09/2012.ppt 的文件将重命名为 2012.ppt。

我想知道的是你们如何处理传入的文件名字符串，以及我们如何对它们进行编码以让您接受以斜杠命名的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T00:37:13.560

强制重命名实际上不是预期的行为。这是我们目前正在努力修复的一个错误。Box 有一组被禁止的字符（\、/、"、:、<、>、|、*、?、.），但是当您以 a 的名称发送此类字符时，我们也应该返回错误通过 API 文件。

我们应该尽快解决这个问题。

# c# - 如何使用事件数组处理传入的命令？

> ID：12790248
> 
> 赞同：4
> 
> 时间：2012-10-08T22:16:41.313
> 
> 标签：c#, tcp, event-handling

我目前正在研究一个简单的客户端/服务器模型，它在 TCP 数据包（如 HTTP）中发送数据包，命令基本上是整数（每个数据包的前 4 个字节），我想找出一种有效的方法处理这些命令。

最明显的答案是编写数千个 if 或用数千个案例做一个巨大的 switch 语句，但没有更好的方法吗？

我想创建一个事件数组，然后只提高相应的索引，以便每个 int 引用一个名为的事件（例如 MessageReceived）。我想我也会节省时间，所以我怎么能解决这个问题？

编辑：服务器处理多个连接，每个连接的客户端一个，因此在我的情况下为每个命令创建单独的连接并不是那么有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T22:22:17.223

听起来像是枚举的工作！

```
enum YourEnum   
{
  DoThis,
  DoThat
}

YourEnum foo = (YourEnum)yourInt; 
```

Visual Studio 甚至可以使用内置的代码片段创建整个 switch 语句，并且您的代码变得非常可读。

```
switch(foo) 
```

变成

```
switch(foo)
{
  case YourEnum.DoThis:
    break;
  case YourEnum.DoThat:
    break;
  default:
    break;
} 
```

**更新 1**

从可维护性的角度来看，这有点吓人，但是如果您创建了这样的类：

```
public class ActionProcessor
{
  public void Process(int yourInt)
  {
    var methods = this.GetType().GetMethods();
    if (methods.Length > yourInt)
    {
      methods[yourInt].Invoke(this, null);
    }
  }

  public DoThis()
  {
  }

  public DoThat()
  {
  } 
```

或者更好但更难维护：

```
[AttributeUsageAttribute(AttributeTargets.Method, 
                         Inherited = false, 
                         AllowMultiple = false)]
public sealed class AutoActionAttribute : Attribute
{ 
  public AutoActionAttibute(int methodID)
  {
    this.MethodID = methodID;
  }
  public int MethodID { get; set; }
}

public class ActionProcessor
{
  public void Process(int yourInt)
  {
    var method = this.GetType().GetMethods()
      .Where(x => x.GetCustomAttribute(typeof(AutoActionAttribute), 
                                       false) != null
                  && x.GetCustomAttribute(typeof(AutoActionAttribute), 
                                       false).MethodID == yourInt)
      .FirstOrDefault();

    if (method != null)
    {
      method.Invoke(this, null);
    }
  }

  [AutoAction(1)]
  public DoThis()
  {
  }

  [AutoAction(2)]
  public DoThat()
  {
  }
} 
```

**更新 2**（编码我认为 Josh C. 正在谈论的内容）

```
// Handles all incoming requests.
public class GenericProcessor
{
  public delegate void ActionEventHandler(object sender, ActionEventArgs e);

  public event ActionEventHandler ActionEvent;

  public ProcessAction(int actionValue)
  {
    if (this.ActionEvent != null)
    {
      this.ActionEvent(this, new ActionEventArgs(actionValue));
    }
  }
}

// Definition of values for request
// Extend as needed
public class ActionEventArgs : EventArgs
{
  public ActionEventArgs(int actionValue)
  {
    this.ActionValue = actionValue;
  }

  public virtual int ActionValue { get; private set; }
} 
```

这将创建负责某些值的 SomeActionProcessor：

```
// Handles a specific (or multiple) requests
public class SomeActionProcessor
{
  public void HandleActionEvent(object sender, ActionEventArgs e)
  {
    if (e.ActionValue == 1)
    {
      this.HandleAction();
    }
  }

  private void HandleAction()
  {
  }
} 
```

然后创建类并将它们连接起来：

```
GenericProcessor gp = new GenericProcessor();
SomeActionProcessor sap = new SomeActionProcessor();
gp.ActionEvent += sap.HandleActionEvent; 
```

开火并发送通用处理器请求：

```
gp.ProcessAction(1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:28:15.617

您可能会实现发布者-订阅者模型。您将拥有许多听众，而不是只有一个听众。每个侦听器至少会侦听一个命令。然后，您可以将您的交换机拆分为多个类。

# r - 如何在轴标签中制作平方根符号？

> ID：12790253
> 
> 赞同：4
> 
> 时间：2012-10-08T22:17:00.393
> 
> 标签：r, plotmath

如何使平方根符号出现在 R 中的轴标签上？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-08T22:21:02.400

使用`expression(sqrt(x))`，请参阅[帮助文件](http://stat.ethz.ch/R-manual/R-devel/library/grDevices/html/plotmath.html)（`?plotmath`按照 mnel 的评论中提到的操作）以获取 R 图中的数学注释。

```
plot(1:10,
     main='Example',
     ylab=expression(sqrt(x))) 
```

产生

![在此处输入图像描述](../Images/83bf5d06ba92a755c7cf77656302ee28.png)

# bash - BASH: ls first 5 from $PATH 不显示错误

> ID：12790255
> 
> 赞同：2
> 
> 时间：2012-10-08T22:17:15.977
> 
> 标签：bash

我从大学的 bash 开始，任何人都知道如何解决这个问题：

显示 $PATH 变量中每个目录的前 5 个文件，如果某个目录不存在，则不显示错误消息。

解决方案可能是这样的：

`ls -a ``echo $PATH | sed "s/:/ /g"`` 2> /dev/null`

它有效，也许还有其他选择，但我不知道如何将每个节目块的结果限制为 5 个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:24:04.387

试试下面的代码：

```
printf '%s\n' ${PATH//:/ } |
    while read dir; do
        /bin/ls 2>/dev/null -1 "$dir" |
            head -5
    done 
```

*   该`${PATH//:/* /}`部分使用[*bash参数扩展*](http://wiki.bash-hackers.org/syntax/pe)
*   `printf '%s\n'`正在打印换行符上由空格分隔的任何单词
*   `/bin/ls -1`在换行符上列出文件。我把完整的路径覆盖别名
*   `head -5`打印前 5 行

**编辑**

这是使用`perl`格式化输出的另一种解决方案：

```
#!/usr/bin/perl -lw

use strict;
use Env qw/PATH/;

my $hash = {};
my @paths = split ":", $PATH;

push @{ $hash->{"$_"} }, glob "${_}/*" for @paths;

foreach my $key (keys(%$hash)) {
    next unless $hash->{$key}->[0];
    print "$key";
    for (my $i = 0; $i < 5; $i++) {
        my $line = $hash->{$key}->[$i];
        print "  $line" if $line;
    }
    print "\n";
} 
```

输出示例：

```
/opt/kde/bin
  /opt/kde/bin/checkXML
  /opt/kde/bin/cupsdconf
  /opt/kde/bin/cupsdoprint
  /opt/kde/bin/dcop
  /opt/kde/bin/dcopclient

/usr/bin
  /usr/bin/2to3
  /usr/bin/2to3-2.7
  /usr/bin/2to3-3.2
  /usr/bin/7z
  /usr/bin/7za 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:27:16.063

[不解释（ man bash](http://linux.die.net/man/1/bash) ...）不会帮助你太多

```
(IFS=:; for a in $PATH; do find "$a" -type f | head -n 5; done) 2> /dev/null 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T08:26:58.700

这应该工作，看看：

```
#!/bin/bash

IFS=':' read -a array <<<"$PATH"

for i in "${array[@]}"; do
ls -al $i 2>/dev/null | head -5
done 
```

命令 IFS=..... 将 $PATH 变量拆分为数组，然后循环数组显示受 5 个第一个值限制的结果

# java - BST 的迭代方法

> ID：12790261
> 
> 赞同：0
> 
> 时间：2012-10-08T22:18:10.750
> 
> 标签：java, stack, binary-search-tree

这些是我的领域：

```
public class BSTSet <E> extends AbstractSet <E> {

    // Data fields
    private BSTNode root;
    private int count = 0;
    private Comparator<E> comp;   // default comparator

    /** Private class for the nodes.
     *  Has public fields so methods in BSTSet can access fields directly. 
     */
    private class BSTNode {

        // Data fields

        public E value;
        public BSTNode left = null;
        public BSTNode right = null;

        // Constructor

        public BSTNode(E v) {
            value = v;
        }

        //creates a method called contains so that i can call it later on for my find method
        public boolean contains(Object item) {
            return contains(item);//root.value.equals(item);
        }

        public int height() {
            return height();
        }

    }
    // Constructors - can either use a default comparator or provide one
    public BSTSet() {
        comp = new ComparableComparator();      // Declared below
    }

    public BSTSet(Comparator <E> c) {
        comp = c;
    }
} 
```

这就是我想要完成的：

```
private class BSTSetIterator implements Iterator<E> {

    private Stack<BSTNode> stack = new Stack<BSTNode>();
    private BSTNode current = root;

    public BSTSetIterator(BSTNode root) {

         return new BSTSetIterator();

    }

    public boolean hasNext() {

        boolean hasNext = false;
        hasNext = !stack.isEmpty() || current != null;
        return hasNext;

    }

    public E next() {

        BSTNode next = null;

        while (current != null) {
            stack.push(current);
            current = current.left;
        }
        next = stack.pop();
        current = next.right;

        return next;

    }

    public void remove() {
        throw new UnsupportedOperationException();
    }
}
// Comparator for comparable 

private class ComparableComparator implements Comparator<E> {
    public int compare(E ob1, E ob2) {
        return ((Comparable)ob1).compareTo(ob2);
    }
} 
```

到目前为止，代码在行`return new BSTSetIterator();`和`return next;`. 因为`return next`它说返回的是错误的数据类型。我将如何着手修复这些方法，以便我可以使用堆栈迭代 BST？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:41:42.943

```
BSTSetIterator(); 
```

这不起作用，因为您的构造函数需要一个根并且您没有传递该参数。如果你有一个名为“tree”的 BSTSet 对象，并且你想创建一个新的迭代器，那么你应该这样创建迭代器：

```
BSTSetIterator iterator = new BSTSetIterator(tree.getRoot()); 
```

但是，您的 BSTSet 类中没有 getter，并且您的根是私有的。别担心，该问题的解决方案是在 BSTSetIterator 类中创建一个公共 getter，如下所示：

```
public BSTNode getRoot()
{
    return this.root;
} 
```

构造函数不返回值，这是不正确的：

```
 public BSTSetIterator(BSTNode root) {
         return new BSTSetIterator();
    } 
```

相反，这样写你的构造函数：

```
public BSTSetIterator(BSTNode root)
{
    this.current = root;
} 
```

此外，这个定义是不正确的，因为 root 是遥不可及的：

```
private BSTNode current = root; 
```

你应该有这个：

```
private BSTNode current; 
```

至于你的其他问题，

```
BSTNode next = null; 
```

表示您的名为“next”的变量属于 BSTNode 类型。

```
public E next() 
```

表示您调用的方法 next 是 E 类型。由于 E 和 BSTNode 不一样，你的回报：

```
return next; 
```

是不正确的。我可以给你更多帮助，但我意识到你现在正在学习这门语言，最好让你自己探索技术和编程，因为这样你会变得更快。“授人以鱼，养其一日。授人以渔，养其一生。”

# typescript - 如何跨多个 AMD 文件传播模块？

> ID：12790262
> 
> 赞同：8
> 
> 时间：2012-10-08T22:18:13.430
> 
> 标签：typescript

我不知道是否有可能将“导出模块”分布在多个文件中。

如果我有文件 Contact.ts：

```
// file Contact.ts
export module Contacts {
   export class Contact {
      ...
   }
} 
```

和另一个 ContactView.ts

```
// file ContactView.ts
export module Contacts {
   export class ContactView {
      model: Contact;  // <---  is not recognized
   }
} 
```

然后 TSC 无法识别 Contact 类。如您所见，Contact 和 ContactView 被声明为驻留在同一个模块中，并且根据规范它应该可以工作。

我正在构建一个使用 require.js 和 AMD 模式的复合应用程序，所以我必须使用“导出模块”声明。

我应该做某种类型的“提前声明”还是一些棘手的“导入”？

感谢您的建议。

编辑：目前我通过导入分别加载每个模块，但是，如果您注意到，它会造成大量代码浪费和大量“导入”依赖项。我的问题是，是否有办法使用相同的命名空间（即联系人）来告知我不想导入的 TS。我正在研究正常的 // 命令，但它不起作用。我什至尝试了 *.d.ts 声明文件，但到目前为止没有成功。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T01:21:33.023

该规范允许您跨多个文件定义*内部*模块（本质上，内部模块是指 javascript 模块模式）。*外部*模块，例如 AMD 或 CommonJS 模块，认为每个文件都是实际的“代码模块”，并且其中的命名空间/命名是无关紧要的，因为模块无论如何都会被加载到它自己的新对象中。

您可以编写以下代码以在 ContactView.ts 模块中加载 Contact.ts 模块：

```
// file ContactView.ts    
import mod = module("./Contact");

export module Contacts {
   export class ContactView {
      model: mod.Contacts.Contact;  // <---  will be recognized
   }
} 
```

这应该可以很好地工作，但是如果您想访问另一个区域中两个模块的内容（例如，自己创建一个新的 Contact 模型），您必须基本上导入它们：

```
import c = module("./Contact");
import cv = module("./ContactView"); 
```

我认为这已经足够好了，因为您清楚地说明了您的依赖关系。缺点是它们不会共享一个共同的父对象，因此让它们都处于“联系”模块模式中可能没有多大用处。

另一种选择是将“Contact”与“ContactView”一起导出，如下所示（授予此代码有点愚蠢，因为您已经通过 ContactView 的模型属性做到了这一点，但永远不会少......）：

```
export module Contacts {
   export class ContactView {
       model: mod.Contacts.Contact;
       constructor() {
           this.model = new mod.Contacts.Contact();
       }
    }

    export var Contact = mod.Contacts.Contact;
} 
```

因此，您可以在加载 ContactView 后访问它。

编辑：顺便说一句，您不仅可以通过“export module Name { ... }”导出模块，还可以导出任何内容，因为文件本身就是模块。所以你可以有一个只有“export function foo() { ... }”的文件，而没有任何模块模式代码包装它。

EDIT2：看起来 AMD 可能具有加载多个依赖项并从中构建“模块”的功能，但我不知道这在 TS 中如何工作，这里有一个链接：http: [//www.adobe.com /devnet/html5/articles/javascript-architecture-requirejs-dependency-management.html](http://www.adobe.com/devnet/html5/articles/javascript-architecture-requirejs-dependency-management.html)（构造器模块）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-12T23:12:09.423

我在同一个问题上挣扎了一段时间，只是想分享我在做什么，以防其他人在这个问题上徘徊。

首先，我为自己定义了一个引用文件，它声明了我的模块中的所有文件：

```
/// <reference path="_contacts.dependencies.ts" />
/// <reference path="../contacts/Contact.ts" />
/// <reference path="../contacts/ContactView.ts" />
/// <reference path="../contacts/ContactModel.ts" /> 
```

请注意，文件内指定的路径是相对于参考文件本身 ( `_contacts.ts`) 的位置，与参考`.js`文件不同。我的目录结构如下所示：

```
modules
    references // all of the reference files
        knockout 
        underscore
        // ... a subfolder for every 3rd party library used
    contacts
    commerce 
    // ... other modules at same level as contacts 
```

回到参考文件本身。第一行包含一个单独的参考文件，其中列出了模块使用的所有外部库，例如下划线、moment 或您有`.d.ts`定义文件的任何其他现有库。其余行是组成模块的文件。

在作为模块一部分的每个文件中，我引用了上面的文件：

```
/// <reference path="../references/_contacts.ts" />
module Contacts {
    export class Contact { 
        public model: ContactModel;
        // ...
    }
} 
```

同样，您可以创建一个参考文件来列出所有模块：

```
/// <reference path="_address.ts" />
/// <reference path="_contacts.ts" />
/// <reference path="_commerce.ts" /> 
```

只需从您的源文件中指出这一点。

但是，这并不能解决发出的代码在单独的文件中的问题。对于这个问题，我使用了一个 JavaScript 缩小工具，它能够将多个文件捆绑到一个源文件中。根据您的编译设置和用例需求，您可能需要在生成的代码周围应用一些包装器，以使其作为 AMD 模块工作（还不太熟悉该部分）。

# python - 将“位置”值分配给范围内的输入？

> ID：12790267
> 
> 赞同：-3
> 
> 时间：2012-10-08T22:18:36.077
> 
> 标签：python, python-3.x

```
for i in range(n):  
    x=input() 
```

我想要`x`附加值`i`，这可以不列出清单吗？

例如，如果`n == 3`, 并且我输入`a`, `b`, 那么`c`, 我想要：

```
x(n-1) == b 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T22:35:59.050

如果您不愿意使用列表，可以使用 dict：

```
In [81]: x={}

In [82]: for i in range(3):
   ....:     x[i+1]=input()
   ....:     
   ....:     
a
b
c

In [83]: x
Out[83]: {1: 'a', 2: 'b', 3: 'c'}

In [84]: x[3]
Out[84]: 'c' 
```

否则，如果我们的输入只有一个字符长，那么您也可以使用字符串。

```
In [85]: x=''

In [86]: for i in range(3):
   ....:     x += input()
   ....:     
   ....:     
a
b
c

In [87]: x
Out[87]: 'abc'

In [88]: x[2]     # here index starts at 0th position
Out[88]: 'c' 
```

# algorithm - 如何在二值图像中找到线段的 x、y 的中点？

> ID：12790272
> 
> 赞同：1
> 
> 时间：2012-10-08T22:19:07.203
> 
> 标签：algorithm, matlab, image-processing, line-segment

我在二进制图像中有一些损坏的线段，我需要修复它们（使它们笔直并保持原来的粗度）。为了做到这一点，我必须**找到线段的中间点**，所以当我检查邻域以找到线条的粗细时，我将能够找到像素停止为 1 并变为 0 的位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T23:22:15.737

假设您损坏的线段是直的，您可以在 MATLAB 中使用 regionprops 来找到每个边界框的中心。因为如果一个线段是直的，它总是边界框的对角线，因此框的中心也是线段的中心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T04:43:23.877

认为

```
A = [xa ya];
B = [xb yb]; 
```

然后

```
C = round( mean([A;B]) ); 
```

Matlab 将`round`数字四舍五入到最接近的整数，因此这最小化了从分析中心 ( `mean([A;B])`) 到最近像素的（城市街区）距离。

如果您想保持亚像素精度（这对于大多数计算实际上是可取的，直到需要从结果到像素索引的显式映射），只需删除`round`并仅使用该`mean`部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T23:10:13.050

让我们称点 A 和 B 来减少歧义，A(Xa, Ya) 和 B(Xb, Yb)

设 C 为中点。

```
C(Xc, Yc)
Xc = (Xa + Xb) / 2
Yc = (Ya + Yb) / 2 
```

我们有四个有趣的数字，两个用于 X 坐标，两个用于 Y 坐标。

```
Xmin = floor(Xc)
Xmax = ceil(Xc)
Ymin = floor(Yc)
Ymax = ceil(Yc) 
```

中间点的 X 坐标为 Xmin 或 Xmax，中间点的 Y 坐标为 Ymin 或 Ymax。

所以我们有四个潜在的点：`(Xmin, Ymin), (Xmin, Ymax), (Xmax, Ymin), (Xmax, Ymax)`。

所以，最后，我们必须决定哪个点离 C 最近。

P(Xp, Yp) 到 C(Xc, Yc) 的距离为：

```
sqrt(sqr(Xp - Xc) + sqr(Yp - Yc)) 
```

计算从四个点到 C 的四个距离，选择最小值，这将是可能的最佳中间点。

# javascript - 画布球偏离用弧线绘制的球

> ID：12790273
> 
> 赞同：0
> 
> 时间：2012-10-08T22:19:11.627
> 
> 标签：javascript, canvas, html5-video, html5-canvas

我有两个球（圆圈）在我的 HTML 中飞来飞去。如果它们聚在一起，它们应该偏转并飞回另一个方向。我已经用圆弧绘制了圆圈，并且我有 x、y 坐标和半径的变量。

```
var xGreen;
var yGreen;
var rGreen;
var xOrange;
var yOrange;
var rOrange; 
```

因为它们应该移动，所以我只需更改 x 和 y 位置：

```
xGreen += xSpeed;
yGreen += ySpeed;
xOrange += xSpeed;
yOrange += ySpeed; 
```

那么我怎样才能知道圆圈何时发生碰撞呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:34:34.283

`distance = Math.sqrt(Math.pow(xG-xO,2)+Math.pow(yG-yO,2))`

然后，您可以通过检查该距离是否小于每个球的半径之和来判断它们是否发生碰撞。

# php - Zend Framework 2：在视图中格式化日期

> ID：12790274
> 
> 赞同：0
> 
> 时间：2012-10-08T22:19:12.853
> 
> 标签：php, zend-framework2, view-helpers

我是 Zend 框架的新手，并决定尝试使用 ZF2 构建一个简单的应用程序。

我有一个日期从我的表网关扩展 AbstractTableGateway 的数据库中提取，这是正确提取我的数据，但我想使用 Zend_Date 格式化我的日期，而不是自己在我的模型/视图中操作字符串表示。

有人对我如何做到这一点有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-09T05:36:50.687

另一种选择是已经存在的 ViewHelper [\Zend\I18n\View\Helper\DateFormat](http://framework.zend.com/manual/2.0/en/modules/zend.i18n.view.helpers.html#dateformat-helper)

这样，您可以确保您的视图脚本已准备好进行国际化 (i18n)，并且您的所有页面查看者都能够以各自的格式查看日期。

这需要启用 php_intl 扩展。

长期使用如下所示：

```
echo $this->dateFormat(
    new DateTime(),
    IntlDateFormatter::MEDIUM, // date
    IntlDateFormatter::MEDIUM, // time
    "en_US"
); 
```

但是，就像 AlloVince 的方法一样，我建议为此编写自己的视图助手。这样你就可以写出类似的东西`$this->myDateFormat($db->getDate())`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-09T02:25:51.403

这是我的自定义数据时间助手供参考：

[https://github.com/AlloVince/eva-engine/blob/master/vendor/Eva/View/Helper/Datetime.php](https://github.com/AlloVince/eva-engine/blob/master/vendor/Eva/View/Helper/Datetime.php)

在您的模块配置文件中将此帮助程序注册为可调用的帮助程序服务

```
'view_helpers' => array(
    'invokables' => array(
        'datetime' => 'Eva\View\Helper\Datetime',
    ),  
), 
```

然后通过以下方式在视图中调用它：

```
$this->datetime(time(), 0, 'Y-m-d');  //2012-10-09
$this->datetime()->jsTime(time()); //Sat Oct 6 17:16:05 UTC+0800 2012 
```

# java - java中的指数增长，返回类型的双精度数组

> ID：12790275
> 
> 赞同：1
> 
> 时间：2012-10-08T22:19:14.510
> 
> 标签：java, arrays, for-loop, exponential

我正在处理一项 CS 任务，但我在理解如何在给定用户指定的增长率的情况下以时间增量输出代表银行账户中货币数量的双精度数组时遇到了一些麻烦。我有一个主要方法，它要求用户提供 $ 的初始金额、增长率和时间间隔数（表示初始金额、增长率和周期数的 iA、gR 和 nP）。然后这个方法调用另一个返回类型为 double[] 的方法。我的问题是我的 for 循环中的代码，它编译得很好，但输出乱码。继承人的代码：

```
import java.util.Scanner;

public class Benford {
    public static double[] generateBenfordNumbers (double iA, double gR, int nP) {  
        double[] bankStatement = new double[nP];

        for (int i = 0; i<nP; i++) { 
            bankStatement[i] = (iA*(Math.pow((1+(gR)), (i++))));
        }

        return bankStatement;
    }

    public static void main (String[] args) {
        Scanner scan = new Scanner(System.in); 
        double iA;
        double gR;
        int nP;

        System.out.print("What is the initial amount of money that you are starting with? : ");
        iA = scan.nextDouble();
        System.out.println();

        System.out.print("What is the amount of growth per time period? : ");
        gR = scan.nextDouble();
        System.out.println();

        System.out.print("How many time periods would you like to use? : ");
        nP = scan.nextInt();
        System.out.println();

        generateBenfordNumbers(iA, gR, nP);
        System.out.print(generateBenfordNumbers(iA, gR, nP));
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:23:53.140

在行

```
bankStatement[i] = (iA*(Math.pow((1+(gR)), (i++)))); 
```

`i++`增加`i`第二次。你可能想要：

```
bankStatement[i] = (iA*(Math.pow((1+(gR)), i + 1))); 
```

或者，如果我们清理它，

```
bankStatement[i] = iA * Math.pow(1 + gR, i + 1); 
```

`i + 1`返回一个大于 的值 1 `i`，但实际上并不增加变量本身。

* * *

还有，你真的`Math.pow`每次都要用吗？您不能手动将数组的第一个元素设置为`iA`并随后用于`bankStatement[i-1]`计算`bankStatement[i]`吗？做这样的事情可能会改善你的程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:22:07.973

i 递增两次：在循环级别并进入正文

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T22:25:51.047

乱码输出如下所示：

```
[D@1b67f74 
```

这是双数组文本表示。你可以使用：

```
System.out.print(Arrays.toString(generateBenfordNumbers(iA, gR, nP))); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T22:24:37.957

您不应该在对 Math.pow 的调用中增加 i。这是因为您已经在 for 循环中增加了它。结果是您的数组元素被跳过而不是设置。这可能是胡言乱语的来源。

您可能想要更改：

```
bankStatement[i] = (iA*(Math.pow((1+(gR)), (i++)))); 
```

到：

```
bankStatement[i] = iA*Math.pow(1+gR, i); 
```

另外，顺便说一句，您通常不应该使用这么多括号，因为这会使阅读变得困难。如果您不确定操作的顺序是什么，[请查一下](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/operators.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-08T22:33:02.497

其他人所说的，您将 i 增加两次，所以我不会重复。我只想补充一点，括号可以很好地组织公式并确保计算的正确执行顺序，但是如果您过度使用它们，它们可能会混淆您的程序的意图，并且它们可能会使您正在寻找的问题更难发现。比较

```
bankStatement[i] = iA * Math.pow(1.0 + gR, i+1); 
```

和

```
bankStatement[i] = (iA*(Math.pow((1+(gR)), (i)))); 
```

明白了吗？

编辑 - 在 ARS 关于 i 的初始值的非常有效的评论之后，我更改了清理后的语句。

# rest - Flickr API 通过 HTTPS 请求，可能吗？

> ID：12790280
> 
> 赞同：1
> 
> 时间：2012-10-08T22:19:47.507
> 
> 标签：rest, https, flickr

迁移到`https`flickr-api 后，我们遇到了问题。找不到[Flickr](http://www.flickr.com/services/api/request.rest.html)是否支持`rest`over `https`？

我们希望提出这种可以正常工作`http`且无路可走的请求`https`。

```
https://api.flickr.com/services/rest/?format=json&sort=interestingness-desc&method=flickr.photos.search&tags=Italy&tag_mode=all&api_key=<key> 
```

请问有什么帮助或建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T22:00:15.050

您可以简单地将：http://api.flickr.com/services 替换**[为](http://api.flickr.com/services)** ：**[https ://secure.flickr.com/services](https://secure.flickr.com/services)**

取自[这里](http://tech.groups.yahoo.com/group/yws-flickr/message/7839)

**** 更新 ****

正如迈克尔指出的那样，URL 发生了变化，现在是 - [https://api.flickr.com/services](https://api.flickr.com/services)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T13:53:27.527

在[yws-flickr](http://tech.groups.yahoo.com/group/yws-flickr/)搜索和发布几个小时后。我们已经看到了两种解决方法：

1.  通过 https 通过您的服务器代理 flickr 请求（可能会出现更多负载和一些安全问题）
2.  通过 cron 服务定期更新链接数据库（**实现这个**）

# python - 为什么 matplotlib 不使用我提供的 .ttf 字体？

> ID：12790284
> 
> 赞同：8
> 
> 时间：2012-10-08T22:20:04.053
> 
> 标签：python, fonts, matplotlib

我正在尝试在 matplotlib 中使用 TTF 字体；.ttf 文件已下载并保存在我的机器上。我已按照[本网站上的其他说明](https://stackoverflow.com/questions/7726852/how-to-use-a-random-otf-or-ttf-font-in-matplotlib)`font_manager`使用;选择字体 但是，我尝试使用字体属性生成的任何文本仍然出现在默认的 matplotlib 字体中。

我知道 Python 确实成功地找到了字体文件，因为`prop.get_name()`类似的命令确实显示了我想要的字体的属性 - 但这不是我图中出现的内容。有什么建议么？

举个例子：

```
import matplotlib.pyplot as plt
import matplotlib.font_manager as fm

fig, ax = plt.subplots()

prop = fm.FontProperties(fname='/Users/smith/fonts/coolfont.ttf')
ax.set_title('Text in a cool font', fontproperties=prop, size=40)

fig.show() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T12:16:26.160

这是因为您使用的后端。

当我尝试对我的默认后端做类似的事情时，`MacOS`它`cairo` 没有工作。

但是，当我切换到`agg`并`TKagg`运行您的示例时，自定义字体就在那里。

这是您的代码已修改，以便在我的机器上运行

```
#!/usr/bin/env python
import matplotlib
matplotlib.use( "agg" )
import matplotlib.pyplot as plt
import matplotlib.font_manager as fm

fig, ax = plt.subplots()
prop = fm.FontProperties(fname='Outwrite.ttf')
ax.set_title('Text in a cool font', fontproperties=prop, size=40)
plt.show()
plt.savefig('test.png') 
```

生成的图像带有自定义字体。

# asp.net - 如何将加密数据从 http 页面发布到 https 页面？

> ID：12790285
> 
> 赞同：0
> 
> 时间：2012-10-08T22:20:06.970
> 
> 标签：asp.net, .net, http, encryption, https

我们有一个没有使用 SSL 的站点，并且 SSL 刚刚被引入其中。我们只在登录页面上实施 SSL，但网站提供了两个登录位置 1）登录页面和 2）主页上的登录小部件。我们不希望主页使用 https 和 SSL。

需要将用户名和密码从主页登录小部件以加密格式传递到后端。

请指导如何完成？如果我以某种方式将 https: 放入操作 url 和/或制作表单方法 post 可以做到吗？请使用 Ajax 或任何其他方法？

请告诉我怎么做？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:28:06.953

是的，只需将操作 URL 更改为`https://`就足够了。

# ios - 与 iOS5 相比，iOS6 的 UIWebView 中的复制选择更容易触发

> ID：12790286
> 
> 赞同：0
> 
> 时间：2012-10-08T22:20:12.123
> 
> 标签：ios, uiwebview

我正在使用 UIWebView 并注意到复制功能在 iOS 6 中比在 iOS 5 中更容易触发。

如果我显示一个带有小按钮的网页，那么在 iOS 5 上单击按钮没有问题，但是在 iOS 6 上，操作系统很容易将单击按钮解释为复制按钮或整个按钮的愿望屏幕和按钮，或者 UIWebView 屏幕，或者首先是按钮，然后屏幕被突出显示以进行复制。

我怎样才能阻止这种情况发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T22:27:31.937

[这个问题与这个问题](https://stackoverflow.com/questions/5995210/disabling-user-selection-in-uiwebview)非常相似。

给出的最佳答案非常彻底，应该对您有用。

# javascript - Tinymce 获取更改的内容

> ID：12790292
> 
> 赞同：1
> 
> 时间：2012-10-08T22:20:38.737
> 
> 标签：javascript, tinymce, wysiwyg, codemirror

我正在使用 TinyMCE 作为我正在开发的协作编辑器的所见即所得编辑器。我需要对编辑器进行非常精细的更改（插入（'a'）、删除（2）等）。我看到 TinyMCE 有一些事件来处理这种情况`onchange_callback`，和`handle_event_callback`. 这些方法都没有给你改变编辑器的内容，只是编辑器实例或事件。有没有人知道一种只对编辑器进行更改的方法，有点像 CodeMirror？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T07:45:46.240

为此，您可以在指定的时间点保存编辑器内容，然后将其与编辑器内容进行比较以供以后使用。

# javascript - 使用 jQuery 隐藏按钮

> ID：12790297
> 
> 赞同：17
> 
> 时间：2012-10-08T22:21:14.287
> 
> 标签：javascript, jquery, button

有人可以告诉我如何在使用 jQuery 按下此按钮后隐藏它吗？

```
<input type="button" name="Comanda" value="Comanda" id="Comanda" data-clicked="unclicked" /> 
```

或者这个：

```
<input type=submit  name="Vizualizeaza" value="Vizualizeaza"> 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-08T22:25:01.950

试试这个：

```
$('input[name=Comanda]')
.click(
     function ()
     {
         $(this).hide();
     }
); 
```

为了做其他所有事情，你可以使用这样的东西：

```
$('input[name=Comanda]')
.click(
     function ()
     {
         $(this).hide();

         $(".ClassNameOfShouldBeHiddenElements").hide();
     }
); 
```

要根据 ID 隐藏任何其他元素，请使用以下元素：

```
$('input[name=Comanda]')
.click(
     function ()
     {
         $(this).hide();

         $("#FirstElement").hide();
         $("#SecondElement").hide();
         $("#ThirdElement").hide();
     }
); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-08T22:23:09.937

您可以使用`.hide()`绑定到`click`处理程序的函数：

```
$('#Comanda').click(function() {
    $(this).hide();
}); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-08T22:33:40.907

jQuery为此提供了[.hide()方法。](http://api.jquery.com/hide/)只需选择您选择的元素，然后调用此方法。例如：

```
$('#comanda').hide(); 
```

还可以通过提供以毫秒或字符串为单位的*持续时间*参数（可能的值是“快”和“慢”）来确定转换运行的速度：

```
$('#comanda').hide('fast'); 
```

如果你想在元素隐藏之后做一些事情，你也必须提供一个回调作为参数：

```
$('#comanda').hide('fast', function() {
  alert('It is hidden now!');
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-08T22:24:16.850

这取决于您使用[的 jQuery 选择器](http://api.jquery.com/category/selectors/?rdfrom=http://docs.jquery.com/mw/index.php?title=Selectors&redirect=no)。由于`id`在 DOM 中应该是唯一的，所以第一个很简单：

```
$('#Comanda').hide(); 
```

第二个可能需要更多的东西，这取决于其他元素以及如何唯一识别它。如果`name`那个特定`input`的是唯一的，那么这将起作用：

```
$('input[name="Vizualizeaza"]').hide(); 
```

# php - 两个 foreach 之间的区别（向数组中添加新元素）

> ID：12790302
> 
> 赞同：2
> 
> 时间：2012-10-08T22:21:50.210
> 
> 标签：php, arrays, foreach

为什么**[这个](http://ideone.com/CCOIX)**foreach：

```
$abc = array('a','b');
foreach ($abc as $k => &$a) {
    echo $a;    
        $abc[] = 'c';
        if ($k > 5) die;
} 
```

输出这个：

```
abccccc 
```

而**[这个](http://ideone.com/31oxj)**：

```
$abc = array('a');
foreach ($abc as $k => &$a) {
    echo $a;    
    $abc[] = 'c';
    if ($k > 5) die;
} 
```

输出这个：

```
a 
```

我希望两个 foreaches 的行为方式相同（迭代直到 key = 6）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:27:30.577

因为第二个 foreach 不会再次触发 foreaches，即只进行一次迭代，因此即使添加了一个元素，添加也会发生在 foreach 已经结束时（它从只有一个元素的想法开始，并且它没有继续循环）

# java - 启动时出现 Java Webstart 错误

> ID：12790306
> 
> 赞同：1
> 
> 时间：2012-10-08T22:22:29.537
> 
> 标签：java, jboss, ejb-3.0, jboss7.x, java-web-start

我有一个使用 webstart 的 EJB 3.0 项目，我试图将其作为 WAR 部署到 JBoss AS 7.1.1。我可以很好地访问 html 页面，但是当我单击 webstart 链接时，它会尝试从[http://java.sun.com](http://java.sun.com)下载 JRE 1.7并弹出以下错误：

```
"AutoDL?BundleId=68742" on java.sun.com is not a Java installer. 
```

这是我的战争的目录结构：

```
root of war(dir)
-->GrahamsProjClient-webstart.jnlp
-->GrahamsProjStartAppPage.html
-->app(dir)
    -->GrahamsProjClient.jar(The actual client project)
-->META-INF(dir)
    -->context.xml(blank file)
    -->MANIFEST.MF
-->WEB-INF(dir)
    -->web.xml
    -->classes(dir) contains my compiled servlet
    -->lib(dir)
        -->jboss-servlet-api_3.0_spec-1.0.0.Final.jar
        -->jnlp-servlet.jar 
```

以下是战争中重要文件的链接：

GrahamsProjClient-webstart.jnlp --> [http://pastebin.com/zwkm1zz3](http://pastebin.com/zwkm1zz3)

```
<?xml version="1.0" encoding="UTF-8"?>
<jnlp codebase="$$codebase">
 <information>
     <title>Grahams Project</title>
     <vendor>Graham</vendor>
     <description>desc</description>
 </information>
 <resources>
   <j2se version="1.6"/>
   <jar href="GrahamsProjClient.jar"/>
 </resources>
 <application-desc/>
</jnlp> 
```

GrahamsProjStartAppPage.html --> [http://pastebin.com/EXu8Z5dZ](http://pastebin.com/EXu8Z5dZ)

web.xml --> [http://pastebin.com/KK3fPPY9](http://pastebin.com/KK3fPPY9)

GrahamsProjServlet.java --> [http://pastebin.com/iC9JDiTL](http://pastebin.com/iC9JDiTL)

这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T16:46:36.620

在摆弄了一段时间后，我遇到了解决方案。在命令`GrahamsProjStartAppPage.html`中`deployJava.createWebStartLaunchButton()`需要有`1.6.0+`而不是`1.6.0`. 所以 html 文件现在看起来像这样：

```
<body>
<!-- ... -->
<script src=
  "http://www.java.com/js/deployJava.js"></script>
<script>
    // using JavaScript to get location of JNLP
    // file relative to HTML page
    var dir = location.href.substring(0,
        location.href.lastIndexOf('/')+1);
    //var url = dir + "GrahamsProjClient-webstart.jnlp";
    var url = "http://127.0.0.1:8080/GrahamsProjClient/GrahamsProjClient-webstart.jnlp"
    deployJava.createWebStartLaunchButton(url, '1.6.0+'); //changed from 1.6.0 to 1.6.0+
</script>
<!-- ... -->
</body> 
```

# cocoa - 自定义 NSSharingService 窗口示例

> ID：12790307
> 
> 赞同：1
> 
> 时间：2012-10-08T22:22:42.880
> 
> 标签：cocoa, appkit

似乎可以自定义 NSSharingService 使用的 NSWindow。有人知道这样做的任何例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T11:46:16.343

您可以使用`sharingServicePicker:sharingServicesForItems:proposedSharingServices:`委托（应符合 `NSSharingServicePickerDelegate 协议）。

这为您提供了一个对 NSSharingServicePicker 对象的引用，就在它呈现给用户之前，因此您可以在那里对其进行自定义。

# javascript - 当可滚动框位于具有不透明度和高度的元素顶部时，Firefox 不会重新绘制

> ID：12790310
> 
> 赞同：4
> 
> 时间：2012-10-08T22:23:07.280
> 
> 标签：javascript, firefox, dom

这可能是我多年来网站编码中遇到的最奇怪的事情，所以我想我会由一些比我聪明的人来运行它，试图解释为什么会发生这种情况。如果没有解释，我可能会将其作为错误报告提交。我花了很长时间才真正找出问题的原因。

以下行为我只能在 Firefox（当前版本 15，可能还有其他版本）中产生。Internet Explorer、Chrome 或 Safari 中不存在问题。很难解释，我只是在这里创建了一个演示：http: [//sandbox.uatu.net/dom-changes.php](http://sandbox.uatu.net/dom-changes.php)

一般的想法是，在一组非常特定的条件下，当滚动可滚动框时，Firefox 会阻止 DOM 更改，无论滚动是由用户完成还是由脚本自动完成。这是设置：

```
<div id="superContainer">
   <div id="subContainer">
       <div id="mainPage">
           scrollable box in here
       </div>
   </div>
</div> 
```

重要属性：

*   # superContainer 具有高度和宽度尺寸

*   # subContainer 有一个高度维度

*   # subContainer 的不透明度设置小于 1

*   # subContainer 有背景颜色

*   # mainPage 的 position 属性为 absolute

无论如何，如果您访问该演示页面，您会看到尝试滚动框会冻结所有页面动画。实际上，您可以在 Firebug 中观察其中一些元素，并看到属性正在实时更改，但 Firefox 只是拒绝重新绘制页面上的任何内容。

如果您将这些属性中的任何一个切换到关闭位置，一切都很好。正是这种特殊的设置组合似乎产生了问题。

有人对为什么有任何想法吗？我无法告诉你这让我有多疯狂——我整个周末基本上都在排除故障，在我发现它的网站上完全重构了我的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:51:58.873

在我看来，不透明度+绝对位置是这里的罪魁祸首，请阅读 w3 关于透明度的规范以了解引擎如何渲染和威胁不透明度。

[http://www.w3.org/TR/css3-color/#transparency](http://www.w3.org/TR/css3-color/#transparency)

> 由于不透明度小于 1 的元素是由单个屏幕外图像合成的，因此其外部的内容无法在其内部的内容块之间按 z 顺序分层。出于同样的原因，实现必须为不透明度小于 1 的任何元素创建新的堆叠上下文。如果未定位不透明度小于 1 的元素，则实现必须在其父堆叠上下文中同时绘制它创建的层如果它是具有“z-index：0”和“不透明度：1”的定位元素，将使用的堆叠顺序。如果定位了不透明度小于 1 的元素，则应用“z-index”属性，如[[CSS21]](http://www.w3.org/TR/css3-color/#CSS21)中所述，除了“auto”被视为“0”，因为总是创建新的堆叠上下文。请参阅[第 9.9 节](http://www.w3.org/TR/CSS21/visuren.html#layers)和[[CSS21]的](http://www.w3.org/TR/css3-color/#CSS21)[附录 E](http://www.w3.org/TR/CSS21/zindex.html)以获取有关堆叠上下文的更多信息。本段中的规则不适用于 SVG 元素，因为 SVG 有自己的[渲染模型](http://www.w3.org/TR/SVG11/render.html)（[[SVG11]](http://www.w3.org/TR/css3-color/#SVG11)，第 3 章）。

如果你从 #mainPage 中删除 position: absolute ，你会注意到 bug 消失了，你可能还是想提交 bug 并为你的实现考虑一个计划 B。

# java - Java 中的大 O 表示法

> ID：12790314
> 
> 赞同：-2
> 
> 时间：2012-10-08T22:23:18.397
> 
> 标签：java, big-o

嘿伙计们，有人可以为我解释一下大 o 符号吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:32:32.213

由于您有一个数组，这意味着连续的内存。这意味着对任何给定索引的查找将在一个操作中进行，因为不需要像在链表中那样迭代。所以它是 O(1)。

在没有排序或排序的情况下比较两个 ArrayList 对象 A 和 B 是 O(n^2)，因为 ArrayList A 中的每个元素都必须与 B 中的每个元素进行比较。所以 A 中有 n 个元素，B 中有 n 个元素。那将导致 A 中的每个元素都需要与 B 进行 n 次比较。由于 A 中有 n 个元素，即 n 次比较，O(n^2)。

尽管如果您使用排序算法，它将与排序算法一样快，例如 O(n log n) 时间或 O(n)，具体取决于所使用的排序算法。

在未排序的数组中搜索特定的目标值确实是 O(n)。之所以如此，是因为您必须搜索数组中的每个元素以检查它是否存在。由于列表中有 n 个元素，这意味着有 n 个比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:33:49.043

1- 因为数组元素可以随机访问（不需要像链表一样从一个单元格移动到另一个单元格）所以你基本上可以说 array[28] 这是 O(1)

2-比较两个数组列表可以以一种会导致较低的大O但排序的方式完成。

您可以使用合并排序或快速排序 O(nlg(n)) 对每个数组列表进行排序，然后在 O(n) 中比较两个排序列表。结果是 O(nlgn)。

但是另一种算法（没有排序）将遍历一个数组（n）中的每个元素。然后检查该元素是否是另一个数组（n）（并将其标记为正确处理重复项）。后一种算法是 O(n^2)。

3- 是的。您必须一一浏览整个列表，直到找到所需的元素。

# java - 为什么Android线程在完成执行之前就被终止了？

> ID：12790319
> 
> 赞同：1
> 
> 时间：2012-10-08T22:24:17.020
> 
> 标签：java, android, multithreading, android-asynctask

我有一个从 Internet 获取一些数据的线程。它表明它正确执行并检索数据。但是，如果我调用一个应该返回数据的方法，它会给我留下空值。从中我得出一个结论，即线程在鳍成型之前以某种方式停止了。

这是代码：

```
private class getHash extends AsyncTask<String, Void, String>{
    @Override
    protected String doInBackground(String... params) {
        String str = null;
        try {
            // Create a URL for the desired page
            URL url = new URL(params[0]);

            // Read all the text returned by the server
            InputStream is =  url.openStream();
            InputStreamReader isr = new InputStreamReader(is);
            BufferedReader in = new BufferedReader(isr);
            str = in.readLine();
            is.close();
            isr.close();
            in.close();
        } catch (MalformedURLException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        hash = str; //If I set a global variable here it gets passed without a hitch
        return str;
    }
    @Override
    protected void onPostExecute(String result) {
        hash = result; // If I comment the line above and live this one I left with a null
    }
} 
```

编辑：根据要求添加调用线程的代码：

```
 getHash hashThread =  new getHash();
            hashThread.execute(new String[] {"http://www.full.path/to/the/file.hash"});

            if(hash != null && !hash.equals(localHash)){
.... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:25:40.817

**无论启动 AsyncTask**

```
{
 ....
 getHash hashThread =  new getHash(this);
 hashThread.execute(new String[] {"http://www.full.path/to/the/file.hash"});
 return; // ok now we just have to wait for it to finish ... can't read it until then
}

// Separate callback method
public void onHashComplete(String hash) {

   if(hash != null && !hash.equals(localHash)) {
      ....
   }
   ....
 } 
```

现在在您的**GetHash 课程中**

```
public String doInBackground(String[] params) {
    .... // don't set hash here ... it will work but you will probably read it at the wrong time.
    return str;
}

public void onPostExecute(String str) {
    onHashComplete(str); // or just do all the work in here since it is a private inner class
} 
```

……

希望这会有所帮助。记住`doInBackground()`发生在 AsyncTask 线程上，`onPostExecute()`在主线程上执行。无论调用什么线程`execute()`也应该是主线程。由于主线程的工作方式，您不能期望在`onPostCreate()`它首先用来调用`execute()`的任何回调完成之前发生。所以这就是我添加回报的原因。

# ruby-on-rails - 您如何在 Ruby on Rails 控制器操作中使用单行 javascript 响应？

> ID：12790324
> 
> 赞同：0
> 
> 时间：2012-10-08T22:25:06.647
> 
> 标签：ruby-on-rails

我无法在网上找到有关如何执行此操作的任何有用资源。基本上我要做的是`$('#test-div').show();`在我的`def show_div`控制器操作完成时运行一个简单的 jQuery。

我已经尝试了以下方法，但它不起作用。它实际上呈现了让我感到困惑的 HTML。当我明确声明该方法以 js 响应时。

users_controller.rb

```
 def show_div
    @user = User.first
    respond_to do |format|
      format.js {}
    end

    # also tried
    # render :js => "$('#test-div').show();"
  end 
```

show_div.js.erb

```
$('#test-div').show(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T22:33:34.957

`render :text`应该做你所要求的——只返回原始文本（在你的情况下恰好是 JavaScript 代码）而不做任何事情。

# java - 内存不足：无法创建新的本机线程

> ID：12790326
> 
> 赞同：2
> 
> 时间：2012-10-08T22:25:13.720
> 
> 标签：java, multithreading, operating-system

我正在开发一个应用程序，客户端（用户）可以控制创建新线程并杀死它们。该应用程序基于 Java。

在其中一种情况下，用户创建多个线程并杀死它们并创建新线程并继续。一段时间后，OutofMemoryException 弹出。我认为这与线程堆栈问题有关。所以我将线程堆栈 XSS 从 1024KB 减少到 512KB，并将 Java 堆大小从 Xms 256mb XmX 1024mb 减少到 Xms 256mb Xmx 512mb。

我还使用 yourkit 对应用程序进行了内存分析，只是为了查看它是否从堆大小溢出。但这似乎没问题..线程被创建并杀死了。

这是 8GB RAM Windows 7 机器

我想知道，还有什么可能导致这个异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:32:12.793

造成这种情况的主要原因有 3 个。

1.  内存泄漏
2.  低效的算法
3.  堆大小太小

这些通常可以通过以下方式修复：

1.  内存泄漏 - 取消引用不需要的对象
2.  低效算法 - 提供内存效率更高的算法（有时越少越好）
3.  堆大小 - 增加堆大小

# python - 如何消除“sys.excepthook is missing”错误？

> ID：12790328
> 
> 赞同：48
> 
> 时间：2012-10-08T22:25:26.600
> 
> 标签：python, exception, io

注意：我没有尝试在 Windows 下或使用 2.7.3 以外的 Python 版本重现下面描述的问题。

引发相关问题的最可靠方法是将以下测试脚本的输出通过管道`:`（在 下`bash`）：

```
try:
    for n in range(20):
        print n
except:
    pass 
```

IE：

```
% python testscript.py | :
close failed in file object destructor:
sys.excepthook is missing
lost sys.stderr 
```

我的问题是：

> *如何修改上面的测试脚本*以避免在脚本如图所示运行时出现错误消息（在 Unix/ 下`bash`）？

（如测试脚本所示，错误不能用`try-except`.）

诚然，上面的例子是高度人为的，但是当我的脚本的输出通过一些第 3 方软件传输时，我*有时会遇到同样的问题。*

错误消息当然是无害的，但它让最终用户感到不安，所以我想让它保持沉默。

编辑：以下脚本与上面的原始脚本的不同之处仅在于它重新定义了 sys.excepthook，其行为与上面给出的完全相同。

```
import sys
STDERR = sys.stderr
def excepthook(*args):
    print >> STDERR, 'caught'
    print >> STDERR, args

sys.excepthook = excepthook

try:
    for n in range(20):
        print n
except:
    pass 
```

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-10-09T19:42:15.010

> 如何修改上面的测试脚本以避免在脚本如图所示运行时出现错误消息（在 Unix/ 下`bash`）？

您需要阻止脚本将任何内容写入标准输出。这意味着删除任何`print`语句和任何使用`sys.stdout.write`，以及调用这些语句的任何代码。

发生这种情况的原因是您将 Python 脚本中的非零输出量传送到从不从标准输入中读取的内容。这不是`:`命令独有的；您可以通过管道传输到任何不读取标准输入的命令来获得相同的结果，例如

```
python testscript.py | cd . 
```

或者举个更简单的例子，考虑一个脚本，它只`printer.py`包含

```
print 'abcde' 
```

然后

```
python printer.py | python printer.py 
```

会产生同样的错误。

当您将一个程序的输出通过管道传输到另一个程序时，写入程序产生的输出会备份在缓冲区中，并等待读取程序从缓冲区请求该数据。只要缓冲区非空，任何关闭写入文件对象的尝试都应该失败并出现错误。这是您看到的消息的根本原因。

触发错误的具体代码在 Python 的 C 语言实现中，这解释了为什么不能用`try`/`except`块捕获它：它在脚本的内容完成处理后运行。基本上，当 Python 自行关闭时，它会尝试关闭`stdout`，但这会失败，因为仍有缓冲的输出等待读取。因此 Python 尝试像往常一样报告此错误，但`sys.excepthook`已作为终结过程的一部分被删除，因此失败。然后 Python 尝试向 打印一条消息`sys.stderr`，但该消息已被再次释放，因此失败。您在屏幕上看到消息的原因是 Python 代码确实包含意外事件`fprintf`直接将一些输出写入文件指针，即使 Python 的输出对象不存在。

# 技术细节

对这个过程的细节感兴趣的人，让我们看一下 Python 解释器的关闭序列，它[`Py_Finalize`是](https://github.com/python/cpython/blob/2.7/Python/pythonrun.c#L404)在`pythonrun.c`.

1.  在调用退出钩子并关闭线程后，终结代码调用[`PyImport_Cleanup`](https://github.com/python/cpython/blob/2.7/Python/import.c#L428)以终结和释放所有导入的模块。该函数执行的倒数第二个任务是[删除`sys`模块](https://github.com/python/cpython/blob/2.7/Python/import.c#L536)，主要包括调用[`_PyModule_Clear`](https://github.com/python/cpython/blob/2.7/Objects/moduleobject.c#L100)以清除模块字典中的所有条目 - 特别包括标准流对象（Python 对象），例如`stdout`和`stderr`。
2.  当一个值从字典中删除或被一个新值替换时，它[的](https://github.com/python/cpython/blob/2.7/Include/object.h#L771)[引用计数](https://github.com/python/cpython/blob/2.7/Objects/dictobject.c#L519)使用[宏](https://github.com/python/cpython/blob/2.7/Include/object.h#L771)递减。引用计数为零的对象有资格进行释放。由于模块保存了对标准流对象的最后剩余引用，因此当这些引用被取消设置时，它们就可以被释放了。¹[`Py_DECREF`](https://github.com/python/cpython/blob/2.7/Include/object.h#L771)`sys``_PyModule_Clear`
3.  Python文件对象[的`file_dealloc`](https://github.com/python/cpython/blob/2.7/Objects/fileobject.c#L612)释放是[由](https://github.com/python/cpython/blob/2.7/Objects/fileobject.c#L612). `fileobject.c`这首先使用恰当命名的[函数](https://github.com/python/cpython/blob/2.7/Objects/fileobject.c#L421)[调用 Python 文件对象的`close`方法](https://github.com/python/cpython/blob/2.7/Objects/fileobject.c#L456)：[`close_the_file`](https://github.com/python/cpython/blob/2.7/Objects/fileobject.c#L421)

    ```
    ret = close_the_file(f); 
    ```

    对于标准文件对象，`close_the_file(f)` [委托给 C`fclose`函数](https://github.com/python/cpython/blob/2.7/Objects/fileobject.c#L496)，如果仍有数据要写入文件指针，该函数会设置错误条件。`file_dealloc`然后检查该错误情况并打印您看到的第一条消息：

    ```
    if (!ret) {
        PySys_WriteStderr("close failed in file object destructor:\n");
        PyErr_Print();
    }
    else {
        Py_DECREF(ret);
    } 
    ```

4.  打印该消息后，Python 会尝试使用[`PyErr_Print`](https://github.com/python/cpython/blob/2.7/Python/pythonrun.c#L1062). 它委托给[`PyErr_PrintEx`](https://github.com/python/cpython/blob/2.7/Python/pythonrun.c#L1156)，并作为其功能的一部分，`PyErr_PrintEx`尝试从`sys.excepthook`.

    ```
    hook = PySys_GetObject("excepthook"); 
    ```

    如果在 Python 程序的正常过程中完成，这会很好，但在这种情况下，`sys.excepthook`已经被清除了。² Python 检查此错误情况并打印第二条消息作为通知。

    ```
    if (hook && hook != Py_None) {
        ...
    } else {
        PySys_WriteStderr("sys.excepthook is missing\n");
        PyErr_Display(exception, v, tb);
    } 
    ```

5.  在通知我们缺少 后`excepthook`，Python 然后回退到使用 打印异常信息[`PyErr_Display`](https://github.com/python/cpython/blob/2.7/Python/pythonrun.c#L1221)，这是显示堆栈跟踪的默认方法。这个函数做的第一件事就是尝试访问`sys.stderr`.

    ```
    PyObject *f = PySys_GetObject("stderr"); 
    ```

    在这种情况下，这不起作用，因为`sys.stderr`已经被清除并且无法访问。³因此，代码直接调用`fprintf`将第三条消息发送到 C 标准错误流。

    ```
    if (f == NULL || f == Py_None)
        fprintf(stderr, "lost sys.stderr\n"); 
    ```

有趣的是，Python 3.4+ 中的行为略有不同，因为最终确定过程现在在清除内置模块之前[显式刷新标准输出和错误流。](https://github.com/python/cpython/blob/3.4/Python/pythonrun.c#L590)这样，如果您有等待写入的数据，您会收到一个明确表示该条件的错误，而不是正常完成过程中的“意外”失败。另外，如果你运行

```
python printer.py | python printer.py 
```

使用 Python 3.4（当然在语句上加上括号之后`print`），您根本不会收到任何错误。我想 Python 的第二次调用可能由于某种原因正在消耗标准输入，但这是一个完全独立的问题。

* * *

¹其实，这是一个谎言。Python 的导入机制[缓存了每个导入模块的字典的副本，该副本在](https://github.com/python/cpython/blob/2.7/Python/import.c#L568)[`_PyImport_Fini`](https://github.com/python/cpython/blob/2.7/Python/import.c#L270)运行之前不会被释放，[稍后在 的实现中`Py_Finalize`](https://github.com/python/cpython/blob/2.7/Python/pythonrun.c#L480)，*那是*对标准流对象的最后引用消失的时候。一旦引用计数达到零，*立即*`Py_DECREF`释放对象。但是对于主要答案而言，重要的是引用已从模块的字典中删除，然后在稍后的某个时间被释放。*`sys`*

 *²同样，这是因为在`sys`真正释放任何内容之前，模块的字典已被完全清除，这要归功于属性缓存机制。`-vv`在收到有关关闭文件指针的错误消息之前，您可以使用选项运行 Python，以查看所有未设置的模块属性。

³除非您了解前面脚注中提到的属性缓存机制，否则此特定行为是唯一没有意义的部分。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-07-25T17:05:40.903

我今天自己遇到了这种问题，并去寻找答案。我认为这里的一个简单解决方法是确保您首先刷新 stdio，因此 python 阻塞而不是在脚本关闭期间失败。例如：

```
--- a/testscript.py
+++ b/testscript.py
@@ -9,5 +9,6 @@ sys.excepthook = excepthook
 try:
     for n in range(20):
         print n
+    sys.stdout.flush()
 except:
     pass 
```

然后这个脚本什么也没有发生，因为异常（IOError：[Errno 32] Broken pipe）被try...except抑制。

```
$ python testscript.py  | :
$ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-08T22:31:16.020

在您的程序中抛出一个无法使用 try/except 块捕获的异常。要抓住他，请覆盖函数`sys.excepthook`：

```
import sys
sys.excepthook = lambda *args: None 
```

从[文档](http://docs.python.org/library/sys.html#sys.excepthook)：

> **sys.excepthook（类型，值，回溯）**
> 
> 当异常被引发但未被捕获时，解释器调用 sys.excepthook 并带有三个参数，异常类、异常实例和回溯对象。在交互式会话中，这发生在控制返回到提示之前；在 Python 程序中，这发生在程序退出之前。可以通过将另一个三参数函数分配给 sys.excepthook 来自定义对此类顶级异常的处理。

说明性示例：

```
import sys
import logging

def log_uncaught_exceptions(exception_type, exception, tb):

    logging.critical(''.join(traceback.format_tb(tb)))
    logging.critical('{0}: {1}'.format(exception_type, exception))

sys.excepthook = log_uncaught_exceptions 
```

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2017-03-18T02:29:13.303

我意识到这是一个老问题，但我在谷歌搜索错误时发现了它。就我而言，这是一个编码错误。我最后的声明之一是：

```
print "Good Bye" 
```

解决方案只是将语法修复为：

```
print ("Good Bye") 
```

[树莓派零，Python 2.7.9]*

# sql - 如何处理在 Oracle 中返回多行的子查询？

> ID：12790329
> 
> 赞同：0
> 
> 时间：2012-10-08T22:25:31.950
> 
> 标签：sql, oracle

我正在为我的项目编写一个有点复杂的查询我有两个表，如下所示 test, test_Av

测试：

```
 CREATE table test(id int not null, title varchar(50), place
     varchar(20), postcode varchar(20), primary key(id));

          INSERT INTO test VALUES(1,'test','','91982'); 
          INSERT INTO test VALUES(2,'test','','91982'); 
          INSERT INTO test VALUES(3,'test','','91982'); 
          INSERT INTO test VALUES(4,'test','','91982'); 
          INSERT INTO test VALUES(5,'test','','91982'); 
```

测试_AV

```
 CREATE table test_AV(id int not null, testid int, name varchar(25),
     stringvalue varchar(25) ,primary key(id));

INSERT INTO test_AV VALUES(1,1,'latitude','16.15074'); 
INSERT INTO test_AV VALUES(2,1,'longitude', '-22.74426'); 
INSERT INTO test_AV VALUES(3,2,'latitude','16.13725'); 
INSERT INTO test_AV VALUES(4,2,'longitude', '-22.85822'); 
INSERT INTO test_AV VALUES(5,3,'latitude','14.85633'); 
INSERT INTO test_AV VALUES(6,3,'longitude', '-24.72379'); 
INSERT INTO test_AV VALUES(7,4,'latitude','14.86949'); 
INSERT INTO test_AV VALUES(8,4,'longitude', '-24.70150'); 
INSERT INTO test_AV VALUES(9,5,'latitude','15.03118'); 
INSERT INTO test_AV VALUES(10,5,'longitude', '-24.32523'); 
```

test_AV 表中的 testid 是外键

我需要从给定的“纬度”和“经度”找到半径 100 公里的结果来实现这一点我写了这样的查询

```
select * from (   SELECT id, 
     title, 
     ((ACOS(
           SIN(16.15074 * 3.141592653 / 180) 
           * SIN((SELECT stringvalue from test_AV WHERE name='latitude')
           * 3.141592653 / 180) 
           + COS(16.15074 * 3.141592653 / 180) 
           * COS((SELECT stringvalue from test_AV WHERE name='latitude') 
           * 3.141592653 / 180)
           * COS((-22.74426 - (SELECT stringvalue from test_AV WHERE name='longitude'))
           * 3.141592653 /180))*6373))    AS distance   FROM
 test ) t where distance <= 100 
```

代替子查询中的子查询，我需要 test_AV 表中的所有纬度和经度值，当我写这个时，它是说子查询是说子查询返回多行

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T06:38:28.300

正如wildplasser正确提到的那样，您需要将子查询与主查询相关联 - 请参阅下面的查询，注意`WHERE av.testid = ts.id`子查询中的子句：

```
select * from (   SELECT id,  
 title,  
 ((ACOS( 
       SIN(16.15074 * 3.141592653 / 180)  
       * SIN((SELECT stringvalue from test_AV av WHERE av.testid = ts.id and name='latitude')  
       * 3.141592653 / 180)  
       + COS(16.15074 * 3.141592653 / 180)  
       * COS((SELECT stringvalue from test_AV av WHERE av.testid = ts.id and name='latitude')  
       * 3.141592653 / 180)  
       * COS((-22.74426 - (SELECT stringvalue from test_AV av WHERE av.testid = ts.id and name='longitude'))  
       * 3.141592653 /180))*6373))    AS distance   FROM  
test ts ) t where distance <= 100 
```

那是为了解决您的查询。但是有一种将 Oracle 行转为列的技术。您可以获得一个数据集，其中您的经度和纬度行在一行中与 testid 相关联：

```
select testid,
max(decode(name, 'longitude', to_number(stringvalue), NULL)) longitude,  
max(decode(name, 'latitude', to_number(stringvalue), NULL)) latitude  
from test_AV  
group by testid 
```

现在只需将这个表加入测试。

# c++ - 生成随机 DAG

> ID：12790337
> 
> 赞同：32
> 
> 时间：2012-10-08T22:26:33.630
> 
> 标签：c++, c, algorithm, graph, cycle

我正在解决有向无环图的问题。

但是我在一些有向无环图上测试我的代码时遇到了麻烦。测试图应该很大，并且（*显然*）是非循环的。

我尝试了很多代码来生成无环有向图。但我每次都失败了。

是否有一些现有的方法可以生成我可以使用的无环有向图？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-10-08T23:06:08.920

我编写了一个 C 程序来执行此操作。关键是对节点进行“排名”，并且*只*将边缘从排名较低的节点绘制到排名较高的节点。

我编写的程序[以 DOT 语言](http://en.wikipedia.org/wiki/DOT_language)打印。

这是代码本身，注释解释了它的含义：

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define MIN_PER_RANK 1 /* Nodes/Rank: How 'fat' the DAG should be.  */
#define MAX_PER_RANK 5
#define MIN_RANKS 3    /* Ranks: How 'tall' the DAG should be.  */
#define MAX_RANKS 5
#define PERCENT 30     /* Chance of having an Edge.  */

int main (void)
{
  int i, j, k,nodes = 0;
  srand (time (NULL));

  int ranks = MIN_RANKS
              + (rand () % (MAX_RANKS - MIN_RANKS + 1));

  printf ("digraph {\n");
  for (i = 0; i < ranks; i++)
    {
      /* New nodes of 'higher' rank than all nodes generated till now.  */
      int new_nodes = MIN_PER_RANK
                      + (rand () % (MAX_PER_RANK - MIN_PER_RANK + 1));

      /* Edges from old nodes ('nodes') to new ones ('new_nodes').  */
      for (j = 0; j < nodes; j++)
        for (k = 0; k < new_nodes; k++)
          if ( (rand () % 100) < PERCENT)
            printf ("  %d -> %d;\n", j, k + nodes); /* An Edge.  */

      nodes += new_nodes; /* Accumulate into old node set.  */
    }
  printf ("}\n");
  return 0;
} 
```

这是从测试运行生成的图表：

![随机生成的 DAG](../Images/ae68a8ac33d40202974d3766161e4e20.png)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-10-08T22:39:28.213

[https://mathematica.stackexchange.com/questions/608/how-to-generate-random-directed-acyclic-graphs](https://mathematica.stackexchange.com/questions/608/how-to-generate-random-directed-acyclic-graphs)的答案适用：如果您有图形边缘的邻接矩阵表示，那么如果矩阵是下三角形，它必然是一个 DAG。

类似的方法是对节点进行任意排序，然后仅在*x < y时才考虑从节点**x*到*y*的边。该约束也应该通过构造来获得您的 DAGness。如果您使用结构来表示节点，那么内存比较将是一种对节点进行排序的任意方式。

 *基本上，伪代码将类似于：

```
for(i = 0; i < N; i++) {
    for (j = i+1; j < N; j++) {
        maybePutAnEdgeBetween(i, j);
    }
} 
```

其中*N*是图中的节点数。

伪代码表明，给定 N 个节点，潜在 DAG 的数量为

```
2^(n*(n-1)/2), 
```

因为有

```
n*(n-1)/2 
```

有序对（“N 选择 2”），我们可以选择它们之间是否有边。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-09T03:27:15.337

因此，尝试将所有这些合理的答案放在一起：

（在下文中，我用 V 表示生成图中的顶点数，用 E 表示边数，我们假设 E ≤ V(V-1)/2。）

就个人而言，我认为最有用的答案是 Flavius 的评论，他指出了[http://condor.depaul.edu/rjohnson/source/graph_ge.c](http://condor.depaul.edu/rjohnson/source/graph_ge.c)上的代码。该代码非常简单，并且可以通过注释方便地进行描述，我将其复制：

```
To generate a directed acyclic graph, we first
generate a random permutation dag[0],...,dag[v-1].
(v = number of vertices.)
This random permutation serves as a topological
sort of the graph. We then generate random edges of the
form (dag[i],dag[j]) with i < j. 
```

实际上，代码所做的就是通过重复执行以下操作来生成请求的边数：

1.  在 [0, V) 范围内生成两个数字；
2.  如果他们是平等的，就拒绝他们；
3.  如果第一个更大，则交换它们；
4.  如果它以前生成过它们，则拒绝它们。

这个解决方案的问题在于，当 E 接近最大边数 V(V-1)/2 时，算法变得越来越慢，因为它必须拒绝越来越多的边。更好的解决方案是制作一个包含所有 V(V-1)/2 个可能边的向量；随机洗牌；并选择洗牌列表中的第一个（请求的边）边。

[储层采样算法](http://en.wikipedia.org/wiki/Reservoir_sampling)允许我们在空间 O(E) 中执行此操作，因为我们可以从 k 的值推断出第 k 条边^的端点。因此，我们实际上不必创建源向量。但是，它仍然需要 O(V ² ) 时间。

或者，可以进行[Fisher-Yates](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle) shuffle（或 Knuth shuffle，如果您愿意），在 E 次迭代后停止。在 Wikipedia 中提供的 FY shuffle 版本中，这将产生尾随条目，但该算法也可以向后运行：

```
// At the end of this snippet, a consists of a random sample of the
// integers in the half-open range [0, V(V-1)/2). (They still need to be
// converted to pairs of endpoints).
vector<int> a;
int N = V * (V - 1) / 2;
for (int i = 0; i < N; ++i) a.push_back(i);
for (int i = 0; i < E; ++i) {
  int j = i + rand(N - i);
  swap(a[i], a[j]);
a.resize(E); 
```

这仅需要 O(E) 时间，但需要 O(N ² ) 空间。实际上，这可以通过一些技巧改进到 O(E) 空间，但是 SO 代码片段太小而无法包含结果，所以我将提供一个更简单的 O(E) 空间和 O(E log E ） 时间。我假设有一个类 DAG 至少：

```
class DAG {
  // Construct an empty DAG with v vertices
  explicit DAG(int v);

  // Add the directed edge i->j, where 0 <= i, j < v
  void add(int i, int j);
}; 
```

现在来了：

```
// Return a randomly-constructed DAG with V vertices and and E edges.
// It's required that 0 < E < V(V-1)/2.
template<typename PRNG>
DAG RandomDAG(int V, int E, PRNG& prng) {
  using dist = std::uniform_int_distribution<int>;
  // Make a random sample of size E
  std::vector<int> sample;
  sample.reserve(E);
  int N = V * (V - 1) / 2;
  dist d(0, N - E);  // uniform_int_distribution is closed range
  // Random vector of integers in [0, N-E]
  for (int i = 0; i < E; ++i) sample.push_back(dist(prng));
  // Sort them, and make them unique
  std::sort(sample.begin(), sample.end());
  for (int i = 1; i < E; ++i) sample[i] += i;
  // Now it's a unique sorted list of integers in [0, N-E+E-1]
  // Randomly shuffle the endpoints, so the topological sort
  // is different, too.
  std::vector<int> endpoints;
  endpoints.reserve(V);
  for (i = 0; i < V; ++i) endpoints.push_back(i);
  std::shuffle(endpoints.begin(), endpoints.end(), prng);
  // Finally, create the dag
  DAG rv;
  for (auto& v : sample) {
    int tail = int(0.5 + sqrt((v + 1) * 2));
    int head = v - tail * (tail - 1) / 2;
    rv.add(head, tail);
  }
  return rv;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-08T22:32:36.070

您可以生成一个随机有向图，然后对循环进行深度优先搜索。当你找到一个循环时，通过删除一条边来打破它。

我认为这是最坏的情况 O(VE)。每个 DFS 需要 O(V)，并且每个 DFS 至少删除一条边（所以最大 E）

如果您通过均匀随机选择所有 V^2 个可能的边来生成有向图，并且您以随机顺序进行 DFS 并删除随机边 - 这将为您提供所有可能的 dag 上的均匀分布（或至少接近它）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-03-03T18:23:31.193

一个非常简单的方法是：

1.  通过迭代下对角矩阵的索引来随机分配边（如上面的链接所示：[https](https://mathematica.stackexchange.com/questions/608/how-to-generate-random-directed-acyclic-graphs) ://mathematica.stackexchange.com/questions/608/how-to-generate-random-directed-acyclic-graphs ）

2.  这将为您提供一个可能包含多个组件的 DAG。您可以使用不相交集数据结构为您提供组件，然后可以通过在组件之间创建边来合并这些组件。

此处描述了不相交集：[https ://en.wikipedia.org/wiki/Disjoint-set_data_structure](https://en.wikipedia.org/wiki/Disjoint-set_data_structure)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-08-02T07:32:15.100

编辑：我最初在处理名为灵活作业车间调度问题的调度问题时发现了这篇文章，其中作业（处理操作的顺序）由有向无环图定义。这个想法是使用一种算法来生成多个随机有向图（作业）并创建调度问题的实例来测试我的算法。本文末尾的代码是我用来生成实例的代码的基本版本。实例生成器可以在[这里](https://github.com/Willtl/online-printing-shop)找到。

我翻译成 Python 并集成了一些功能来创建随机 DAG 的传递集。这样，生成的图具有相同可达性的最小边数。

通过将输出粘贴到**模型代码**（右侧）中，可以在[http://dagitty.net/dags.html上可视化传递图。](http://dagitty.net/dags.html)

 **算法的 Python 版本

```
import random

class Graph:
    nodes = []
    edges = []
    removed_edges = []

    def remove_edge(self, x, y):
        e = (x,y)
        try:
            self.edges.remove(e)
            # print("Removed edge %s" % str(e))
            self.removed_edges.append(e)
        except:
            return

    def Nodes(self):
        return self.nodes

    # Sample data
    def __init__(self):
        self.nodes = []
        self.edges = []

def get_random_dag():
    MIN_PER_RANK = 1    # Nodes/Rank: How 'fat' the DAG should be
    MAX_PER_RANK = 2
    MIN_RANKS = 6   # Ranks: How 'tall' the DAG should be
    MAX_RANKS = 10
    PERCENT = 0.3  # Chance of having an Edge
    nodes = 0

    ranks = random.randint(MIN_RANKS, MAX_RANKS)

    adjacency = []
    for i in range(ranks):
        # New nodes of 'higher' rank than all nodes generated till now
        new_nodes = random.randint(MIN_PER_RANK, MAX_PER_RANK)

        # Edges from old nodes ('nodes') to new ones ('new_nodes')
        for j in range(nodes):
            for k in range(new_nodes):
                if random.random() < PERCENT:
                    adjacency.append((j, k+nodes))

        nodes += new_nodes

    # Compute transitive graph
    G = Graph()
    # Append nodes
    for i in range(nodes):
        G.nodes.append(i)
    # Append adjacencies
    for i in range(len(adjacency)):
        G.edges.append(adjacency[i])

    N = G.Nodes()
    for x in N:
        for y in N:
            for z in N: 
                if (x, y) != (y, z) and (x, y) != (x, z):
                    if (x, y) in G.edges and (y, z) in G.edges:
                        G.remove_edge(x, z)

    # Print graph
    for i in range(nodes):
        print(i)
    print()
    for value in G.edges:
        print(str(value[0]) + ' ' + str(value[1]))

get_random_dag() 
```

下面，您可能会在图中看到由上面的 Python 代码生成的具有许多冗余边的随机 DAG。

[![随机 DAG](../Images/d2cf1e2e78a21a7fad541d329cf4d2c1.png)](https://i.stack.imgur.com/TP6pw.png)

我调整了代码以生成相同的图形（相同的可达性），但边数尽可能少。这也称为传递归约。

```
def get_random_dag():
    MIN_PER_RANK = 1    # Nodes/Rank: How 'fat' the DAG should be
    MAX_PER_RANK = 3
    MIN_RANKS = 15   # Ranks: How 'tall' the DAG should be
    MAX_RANKS = 20
    PERCENT = 0.3  # Chance of having an Edge
    nodes = 0
    node_counter = 0

    ranks = random.randint(MIN_RANKS, MAX_RANKS)

    adjacency = []
    rank_list = []
    for i in range(ranks):
        # New nodes of 'higher' rank than all nodes generated till now
        new_nodes = random.randint(MIN_PER_RANK, MAX_PER_RANK)

        list = []
        for j in range(new_nodes):
            list.append(node_counter)
            node_counter += 1
        rank_list.append(list)

        print(rank_list)

        # Edges from old nodes ('nodes') to new ones ('new_nodes')
        if i > 0:
            for j in rank_list[i - 1]:
                for k in range(new_nodes):
                    if random.random() < PERCENT:
                        adjacency.append((j, k+nodes))

        nodes += new_nodes

    for i in range(nodes):
        print(i)
    print()
    for edge in adjacency:
        print(str(edge[0]) + ' ' + str(edge[1]))
    print()
    print() 
```

结果：

[![传递图](../Images/da50006389824114850008b64a93d86f.png)](https://i.stack.imgur.com/o4xuP.png)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-08T22:30:13.153

创建一个图，其中包含`n`节点和每对节点之间的边`n1`以及`n2`if`n1 != n2`和`n2 % n1 == 0`。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-11-20T20:24:32.643

我最近尝试重新实现接受的答案，发现它是不确定的。如果您不强制执行 min_per_rank 参数，您最终可能会得到一个包含 0 个节点的图。

为了防止这种情况，我将 for 循环包装在一个函数中，然后检查以确保在每个等级之后，它`min_per_rank`都得到满足。下面是 JavaScript 实现：

[https://github.com/karissa/random-dag](https://github.com/karissa/random-dag)

还有一些伪 C 代码将取代已接受答案的主循环。

```
int pushed = 0

int addRank (void) 
{
  for (j = 0; j < nodes; j++)
    for (k = 0; k < new_nodes; k++)
      if ( (rand () % 100) < PERCENT)
        printf ("  %d -> %d;\n", j, k + nodes); /* An Edge.  */

  if (pushed < min_per_rank) return addRank()
  else pushed = 0

  return 0
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-01-01T11:58:18.610

# 生成可能未连接的随机 DAG

这是一个用于生成可能未连接的随机 DAG 的简单算法。

```
const randomDAG = (x, n) => {
    const length = n * (n - 1) / 2;

    const dag = new Array(length);

    for (let i = 0; i < length; i++) {
        dag[i] = Math.random() < x ? 1 : 0;
    }

    return dag;
};

const dagIndex = (n, i, j) => n * i + j - (i + 1) * (i + 2) / 2;

const dagToDot = (n, dag) => {
    let dot = "digraph {\n";

    for (let i = 0; i < n; i++) {
        dot += `    ${i};\n`;

        for (let j = i + 1; j < n; j++) {
            const k = dagIndex(n, i, j);
            if (dag[k]) dot += `    ${i} -> ${j};\n`;
        }
    }

    return dot + "}";
};

const randomDot = (x, n) => dagToDot(n, randomDAG(x, n));

new Viz().renderSVGElement(randomDot(0.3, 10)).then(svg => {
    document.body.appendChild(svg);
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/viz.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/full.render.js"></script>
```

如果您多次运行此代码片段，您可能会看到未连接的 DAG。

## 那么，这段代码是如何工作的呢？

有向无环图（DAG）只是一个[拓扑排序](https://en.wikipedia.org/wiki/Topological_sorting)的无向图。顶点的无向图`n`可以有最大的`n * (n - 1) / 2`边，不计算重复边或从顶点到自身的边。现在，您只能拥有从较低顶点到较高顶点的边。因此，所有边缘的方向都是预先确定的。

这意味着您可以使用`n * (n - 1) / 2`边权重的一维数组来表示整个 DAG。边缘权重`0`表示边缘不存在。因此，我们只需创建一个由 0 或 1 组成的随机数组，这就是我们的随机 DAG。

顶点DAG 中从顶点`i`到顶点的边，其中，在索引处具有边权重where 。`j``n``i < j``k``k = n * i + j - (i + 1) * (i + 2) / 2`

* * *

# 生成连接的 DAG

生成随机 DAG 后，您可以使用以下函数检查它是否已连接。

```
const isConnected = (n, dag) => {
    const reached = new Array(n).fill(false);

    reached[0] = true;

    const queue = [0];

    while (queue.length > 0) {
        const x = queue.shift();

        for (let i = 0; i < n; i++) {
            if (i === n || reached[i]) continue;
            const j = i < x ? dagIndex(n, i, x) : dagIndex(n, x, i);
            if (dag[j] === 0) continue;
            reached[i] = true;
            queue.push(i);
        }
    }

    return reached.every(x => x); // return true if every vertex was reached
}; 
```

如果它没有连接，那么它的[补码将始终是连接](https://math.stackexchange.com/q/122184/22562)的。

```
const complement = dag => dag.map(x => x ? 0 : 1);

const randomConnectedDAG = (x, n) => {
    const dag = randomDAG(x, n);
    return isConnected(n, dag) ? dag : complement(dag);
}; 
```

请注意，如果我们创建一个具有 30% 边的随机 DAG，那么它的补码将具有 70% 的边。因此，唯一安全的值`x`是 50%。但是，如果您更关心连接性而不是边的百分比，那么这不应该是一个交易破坏者。

最后，把它们放在一起。

```
const randomDAG = (x, n) => {
    const length = n * (n - 1) / 2;

    const dag = new Array(length);

    for (let i = 0; i < length; i++) {
        dag[i] = Math.random() < x ? 1 : 0;
    }

    return dag;
};

const dagIndex = (n, i, j) => n * i + j - (i + 1) * (i + 2) / 2;

const isConnected = (n, dag) => {
    const reached = new Array(n).fill(false);

    reached[0] = true;

    const queue = [0];

    while (queue.length > 0) {
        const x = queue.shift();

        for (let i = 0; i < n; i++) {
            if (i === n || reached[i]) continue;
            const j = i < x ? dagIndex(n, i, x) : dagIndex(n, x, i);
            if (dag[j] === 0) continue;
            reached[i] = true;
            queue.push(i);
        }
    }

    return reached.every(x => x); // return true if every vertex was reached
};

const complement = dag => dag.map(x => x ? 0 : 1);

const randomConnectedDAG = (x, n) => {
    const dag = randomDAG(x, n);
    return isConnected(n, dag) ? dag : complement(dag);
};

const dagToDot = (n, dag) => {
    let dot = "digraph {\n";

    for (let i = 0; i < n; i++) {
        dot += `    ${i};\n`;

        for (let j = i + 1; j < n; j++) {
            const k = dagIndex(n, i, j);
            if (dag[k]) dot += `    ${i} -> ${j};\n`;
        }
    }

    return dot + "}";
};

const randomConnectedDot = (x, n) => dagToDot(n, randomConnectedDAG(x, n));

new Viz().renderSVGElement(randomConnectedDot(0.3, 10)).then(svg => {
    document.body.appendChild(svg);
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/viz.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/full.render.js"></script>
```

如果您多次运行此代码片段，您可能会看到一个 DAG 的边数比其他 DAG 多得多。

* * *

# 生成具有一定百分比边的连接 DAG

如果您既关心连通性又关心一定比例的边，那么您可以使用以下算法。

1.  从一个完全连接的图开始。
2.  随机删除边缘。
3.  删除一条边后，检查图形是否仍然连接。
4.  如果它不再连接，则添加该边缘。

需要注意的是，这种算法的效率不如前一种方法。

```
const randomDAG = (x, n) => {
    const length = n * (n - 1) / 2;

    const dag = new Array(length).fill(1);

    for (let i = 0; i < length; i++) {
        if (Math.random() < x) continue;
        dag[i] = 0;
        if (!isConnected(n, dag)) dag[i] = 1;
    }

    return dag;
};

const dagIndex = (n, i, j) => n * i + j - (i + 1) * (i + 2) / 2;

const isConnected = (n, dag) => {
    const reached = new Array(n).fill(false);

    reached[0] = true;

    const queue = [0];

    while (queue.length > 0) {
        const x = queue.shift();

        for (let i = 0; i < n; i++) {
            if (i === n || reached[i]) continue;
            const j = i < x ? dagIndex(n, i, x) : dagIndex(n, x, i);
            if (dag[j] === 0) continue;
            reached[i] = true;
            queue.push(i);
        }
    }

    return reached.every(x => x); // return true if every vertex was reached
};

const dagToDot = (n, dag) => {
    let dot = "digraph {\n";

    for (let i = 0; i < n; i++) {
        dot += `    ${i};\n`;

        for (let j = i + 1; j < n; j++) {
            const k = dagIndex(n, i, j);
            if (dag[k]) dot += `    ${i} -> ${j};\n`;
        }
    }

    return dot + "}";
};

const randomDot = (x, n) => dagToDot(n, randomDAG(x, n));

new Viz().renderSVGElement(randomDot(0.3, 10)).then(svg => {
    document.body.appendChild(svg);
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/viz.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/full.render.js"></script>
```

希望有帮助。***

# openlayers - openlayer 中标记弹出窗口的意外行为。

> ID：12790338
> 
> 赞同：1
> 
> 时间：2012-10-08T22:26:42.823
> 
> 标签：openlayers

当我将鼠标悬停在标记上时，有时会在标记上触发弹出窗口，有时会在坐标上触发。似乎它在第一次或最后一次注册事件时工作正常。markersObjs 是从 Web 服务动态创建的服务器端。我使用两个城市或一百个城市似乎并不重要。

```
 var map, baseLayer, markers;

        function drawMap( ){
            var markersObjs = {
                'sections' : {
                    'Atlanta' : {id: '01', lat :'-84.42', lon :'33.65'},
                    'Denver' : {id: '02', lat :'-104.87', lon :'39.75'}
                },
                'chapters' : {
                    'Houston' : {id: '03', lat :'-95.35', lon :'29.97'},
                    'Orlando' : {id: '04', lat :'-81.32', lon :'28.43'}
                 }
              };

            map = new OpenLayers.Map("emap");            
            baseLayer = new OpenLayers.Layer.WMS( "Locals Map", "http://labs.metacarta.com/wms/vmap0", {layers:"basic"} );
            map.addLayer( baseLayer );
            map.setCenter( new OpenLayers.LonLat( -98, 38 ), 3.5 ); 

            i = null;
            for ( var value in markersObjs ){

                //set the first object in loop show the rest are false
                if(i == null){
                    show = true;
                    i++;
                }else{
                    show = false;
                }
                addMarkers( value, markersObjs[value], show  );
            }
        console.log(map);
        }

        function addMarkers( name, markersOBJ, show ){
          markers = new OpenLayers.Layer.Markers( name );             
            markers.setVisibility(show);

            map.addLayer( markers ); 

            for( var value in markersOBJ ){
                marker = new OpenLayers.Marker( new OpenLayers.LonLat( markersOBJ[value].lat, markersOBJ[value].lon ) );
                marker.PlaneID = value;
                marker.LinkID = markersOBJ[value].id;
                markers.addMarker( marker);

                //add on click                     marker.events.register('click', this.PlaneID , function(e){
                    console.log( 'marker(Click):\n');
                    console.log( marker );
                    console.log( '\n');

                    var markerLink = '/regions/?'+this.LinkID;
                    window.open( markerLink, '_top');
                });

                //add mouseover
                marker.events.register('mouseover', marker, function(e){
                    console.log( 'this.PlaneID (mouseOver):\n');
                    console.log( this.PlaneID );
                    console.log( '\n');
                    popup= new OpenLayers.Popup.FramedCloud(this.PlaneID,
                                                  new OpenLayers.LonLat( this.lonlat.lon, this.lonlat.lat ),
                                                  null,
                                                  '<div class="mapPopUp">'+this.PlaneID+'<\/div>',
                                                  null, 
                                                  false);          
                    map.addPopup(popup);
                    console.log(map);
                });

                //here add mouseout event
                markers.events.register('mouseout', marker, function(evt) {
                     for(var i=0; i<map.popups.length; i++){
                          if(map.popups[i].id == this.PlaneID){
                            console.log( 'this.PlaneID (mouseOut):\n');
                            console.log( this.PlaneID );
                            console.log( '\n');
                             map.popups[i].destroy();
                             break;
                          }
                       }
                });
             }

         } 
```

# c# - 如何在特定集合上选择 .First() 的优先级

> ID：12790339
> 
> 赞同：0
> 
> 时间：2012-10-08T22:26:44.273
> 
> 标签：c#, asp.net, entity-framework

我有以下代码：

```
 //Pretend there is a few static values in this list
    List<string> repeatUserIds = new List<string>();

    SomeCollection.Where(x => repeatUserIds.Contains(x.UserId)).First().MyCol = "somevalue";

    MyEntities.SaveChanges(false);
    scope.Complete();
    MyEntities.AcceptAllChanges(); 
```

我还有一个`List<string>`名为的对象`repeatUserIds`，其中包含一个静态 UserId 列表，可能是 5 个左右。我希望能够让我的`SomeCollection.Where(x => repeatUserIds.Contains(x.UserId))`语句返回`repeatUserIds`如果有匹配项，如果没有匹配`repeatUserIds`项（如果 repeatUserIds.Contains retunrs false），则返回具有最旧用户 ID 的项目，然后只返回 SomeCollection 中的第一个项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T12:13:07.787

您可以使用在连接中保留第一个集合的排序顺序的事实。因此，可以通过两个步骤找到“第一个”项目：

```
var dbList = SomeCollection.Where(x => repeatUserIds.Contains(x.UserId))
             .ToList();

repeatUserIds.Join(dbList, s => s, x => x.UserId, (s,x) => x)
             .First().MyCol = "somevalue"; 
```

但是请注意，理论上，`List`不能保证对象中元素的顺序。您可能希望[`SortedList`](http://msdn.microsoft.com/en-us/library/ms132319.aspx)使用`repeatUserIds`.

# haskell - Haskell GHC 动态编译仅适用于第一次编译

> ID：12790341
> 
> 赞同：7
> 
> 时间：2012-10-08T22:26:55.117
> 
> 标签：haskell, compiler-construction, ghc, dynamic-compilation, ghc-api

遵循[此处发布的 GHC 教程，并按照](http://www.bluishcoder.co.nz/2008/11/dynamic-compilation-and-loading-of.html)[我之前提出的堆栈溢出问题](https://stackoverflow.com/questions/12779143/dynamic-compilation-in-haskell-ghc-api-error)中的建议对此代码进行了更改，我创建了一个程序，该程序能够在 Test.hs 中编译和运行模块，并使用函数 print 打印字符串到屏幕：

```
import GHC
import GHC.Paths
import DynFlags
import Unsafe.Coerce

main :: IO ()
main =
    defaultErrorHandler defaultLogAction $ do
      func <- runGhc (Just libdir) $ do
        dflags <- getSessionDynFlags
        setSessionDynFlags dflags
        target <- guessTarget "Test.hs" Nothing
        addTarget target
        r <- load LoadAllTargets
        case r of
          Failed -> error "Compilation failed"
          Succeeded -> do
            m <- findModule (mkModuleName "Test") Nothing
            setContext [IIModule m]
            value <- compileExpr ("Test.print")
            do let value' = (unsafeCoerce value) :: String -> IO ()
               return value'
      func "Hello"
      return () 
```

如评论中所述，此代码的问题在于它似乎仅在您第一次运行时才有效（当尚未编译 Test.hs 时）。如果您再次尝试运行该代码，则会出现以下错误：

```
mkTopLevEnv: not interpreted main:Test 
```

我相信这与代码已经编译的事实有关。如果我删除 .hi 和 .o 文件并再次运行该程序，则该程序会以正确的输出正确运行。我错过了什么？我目前正在使用 ghc 版本 7.4.1

（注意：我尝试过查看 GHC API，但找不到对 mkTopLevEnv 的任何引用）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T01:05:30.010

西蒙马洛[在这里](http://www.haskell.org/pipermail/glasgow-haskell-users/2011-October/021009.html)建议更换

```
guessTarget "Test.hs" Nothing 
```

和

```
guessTarget "*Test.hs" Nothing 
```

应该避免您遇到的错误，因为它告诉 GHC 不要加载 .o 文件。

[通过 nabble](http://haskell.1045720.n5.nabble.com/mkTopLevEnv-not-interpreted-main-Main-td4861327.html)查看页面上的整个线程

当然，您可以每次都删除 .hi 和 .o 文件，但这是一个丑陋的解决方法。

# iphone - 应用程序确实从背景 iPhone 打开

> ID：12790353
> 
> 赞同：0
> 
> 时间：2012-10-08T22:28:00.483
> 
> 标签：iphone, objective-c, ios, uiapplication

即使 myApp 已经在后台打开，我如何确定它何时打开？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:04:14.100

`- (void) applicationWillEnterForeground`似乎是您正在寻找的方法。

# java - 在子类的重写方法中设置的 Java 类属性丢失

> ID：12790354
> 
> 赞同：1
> 
> 时间：2012-10-08T22:28:05.143
> 
> 标签：java, polymorphism

我正在构建一个 Android 应用程序，并设置了一个基本 DBObject 类来简化表交互。DBObject 构造函数设置一个游标并将其传递给虚拟方法 loadRecord，子类将覆盖该方法以加载其自己的属性。根据 loadRecord 末尾的 Log.i 调用，属性都是正确的，但是一旦调用方法取回对象，所有数据成员都具有类声明中定义的默认值，而不是加载的值（字符串为 null ，浮点数为 0.00 等）。

```
public abstract class DBObject {
....

    public DBObject(DBHelper dbh, String table_name, int _id){
        // loads an existing DBObject from the database by id
        this.dbh = dbh;
        this.TABLE_NAME = table_name;
        this.id = _id;
        setupDbr();
        String sql = String.format("select * from %s where _id=%d", TABLE_NAME, id);
        Cursor cur = dbr.rawQuery(sql, null);
        if (cur.getCount() == 0){
            throw new RowDoesNotExistException(id);
        } else if (cur.getCount() > 1){
            throw new RowDoesNotExistException("Record is not unique.", id);
        }
        cur.moveToFirst();
        loadRecord(cur);
    }
....
abstract void loadRecord(Cursor cur); 
```

此构造函数调用重写的 loadRecord，它在子类中如下所示：

```
public class Expense extends DBObject{

    public String date = null;
    public String supplier = null;
    public String description = null;
    public float amount = 0.00f;
    public boolean receipt = false;

    public Expense(DBHelper dbh, String _id){
        super(dbh, DBHelper.EXPENSE_TABLE, _id);
...
    @Override
    void loadRecord(Cursor cur){
        id = cur.getInt(0);
        date = cur.getString(1);
        supplier = cur.getString(2);
        description = cur.getString(3);
        amount = cur.getFloat(4);
        receipt = (cur.getInt(5) == 1);
        Log.i("net.bradmont.reimburseit", String.format("%d, %s, %s, %s", id, date, supplier, description));
    } 
```

在 DBObject 构造函数中设置的成员保持原样。我对此完全不知所措......

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:32:43.537

问题是你有实例变量初始化器：

```
public String date = null;
public String supplier = null;
public String description = null;
public float amount = 0.00f;
public boolean receipt = false; 
```

初始化器将在超类构造函数执行*之后、子类构造函数的主体执行**之前*执行。这是在构造函数中调用重写方法的问题之一——这通常是一个非常糟糕的主意。

您可以通过不使用实例变量初始化程序来解决此特定问题：

```
public String date;
public String supplier;
public String description;
public float amount;
public boolean receipt; 
```

现在在超类构造函数完成和子类构造函数执行之间不会有额外的赋值。然而，这并不是一个*很好的*解决方案——最好重新设计它以避免在超类构造函数中调用被覆盖的方法。

我也会尝试摆脱公共字段......将它们设为私有，以避免暴露你的类的实现细节。

有关如何执行构造函数的详细信息，请参阅[JLS 的第 12.5 节。](http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.5)

# javascript - 使用javascript缩放时保持比例的框

> ID：12790361
> 
> 赞同：0
> 
> 时间：2012-10-08T22:28:34.243
> 
> 标签：javascript, jquery, html, css

我制作了一个脚本： http: [//jsfiddle.net/radar24/XZgh4/](http://jsfiddle.net/radar24/XZgh4/)，它将给定的维度缩放到外部 div。一切似乎都很好，直到我输入诸如 200 x 99 之类的尺寸。然后盒子在外面长大。

我真的找不到原因，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:48:16.053

问题是你没有限制你在两个轴上的比例。您的盒子的高度：宽度比例为 5:3。如果您不沿两个轴进行限制，则可能会在框外流血。一个例子可能最好地说明这一点。

以高度为两个维度中较大者为例。您的代码仅将其限制在 500px 轴上。因此，如果我们把一个比例为 5:>3 的盒子扔进去，你会得到一个爬行边缘。

例如，把“3”和“5”放在你的盒子里。完美契合。现在让它成为 3.1 和 5。Ruh roh。

您需要在每个部分中添加另一个 if 语句，然后确定尺寸比是否超出此边界。在上述情况下，您需要使 5:3.1 的高度不是 500px，而是使 3.1 等于 300px 的高度（小于 500px）。那将是 483 像素。

这有意义吗？

如果没有，我会尝试重新措辞：

将另一组 if 语句放在您已有的两个 if 语句中。这些检查是否在设置 LARGER 维度时，是否使 SMALLER 维度在该方向上超出框的边界。在伪代码中

```
if (height > width)
    calculate the height
    calculate the width
    if (width > div.width)
       width = div.width
       height = div.width * aspect; 
```

只是问我这是否不够清楚！

编辑：[这是一个正确的 JSFiddle](http://jsfiddle.net/MgvXW/)。如果您希望每个边缘都有一个白色边框，则需要添加更多代码。

Edit2：[这是白色边框回来了！](http://jsfiddle.net/yMyz8/)

Edit3：您也可以尝试[对其进行](http://jsfiddle.net/GXmbJ/)美化并仅使用方面来做到这一点。我为你做了第一个。三个去！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:42:23.053

这是一个很小的错误。在比较它们之前，您忘记将`width`and转换`height`为整数。因此，您需要更改`if (width >= height)`为`if (parseInt(width) >= parseInt(height))`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T22:49:40.413

jQuery .val() 总是返回一个字符串，你应该把它解析成整数

[改变了jsfiddle](http://jsfiddle.net/XZgh4/256/)

```
....

        height = parseInt($('#height').val()) || 0;// making 0 as default value.
        width = parseInt($('#width').val()) || 0;
.... 
```

# ios - NSNumber 转换对经纬度

> ID：12790363
> 
> 赞同：0
> 
> 时间：2012-10-08T22:28:47.473
> 
> 标签：ios, nsnumber

```
NSNumber *a;

for(NSDictionary *item in[res valueForKey:@"snapshot"])
{
a=[item valueForKey:@"lat"];
NSLog(@"%@",a);
b=[item valueForKey:@"lng"];
NSLog(@"%@",b);
} 
```

写在控制台上： ("29.13","29.38","29.31","29.30","29.43" ) ("94.13","94.38","93.30","94.58","94.34" )`

我怎样才能让每个值转换为双精度值？我想从此输出中获取每个纬度和经度对。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:52:26.433

根据您的说法，`NSLog`您从中获得的价值`valueForKey:`是`NSArrays`，不是`NSNumber`。所以简单地通过这些数组。

```
for(NSDictionary *item in[res valueForKey:@"snapshot"])
{
    NSArray* latitudesList  = [item valueForKey:@"lat"];
    NSArray* longitudesList = [item valueForKey:@"lng"];
    NSInteger idx = 0;
    NSInteger nb = MIN( latitudesList.count , longitudesList.count );
    for(NSInteger idx = 0; idx < nb; ++idx)
    {
      double lat = [[latitudesList  objectAtIndex:idx] doubleValue];
      double lng = [[longitudesList objectAtIndex:idx] doubleValue];
      NSLog(@"Pair #%d = { %f , %f }", idx, lat, lng);
    }
} 
```

# java - 展开树搜索实现

> ID：12790365
> 
> 赞同：0
> 
> 时间：2012-10-08T22:29:02.587
> 
> 标签：java, data-structures, binary-search-tree, splay-tree

我一直在尝试学习一些数据结构的来龙去脉，并且试图让二叉树能够正常工作。每次我运行以下代码并且我正在寻找的节点超过根时它告诉我它在那里，然后只是从根向下删除整个边。如果节点仅从顶部向下一层，则它可以正常工作。

我不确定出了什么问题，但我想这与我的旋转功能有关。我让它在我之后建模的插入函数中正常工作。

```
public class SplayBST {
    Node root;
    int count;
    int level = 0;
    boolean found = false;
    public SplayBST() {
        root = null;
        count = 0;
    }

public String searchIt(String x) {
    //after finishing search method I need to check if splaySearch exists then don't insert just splay it
    splaySearch(root, x);
    if (this.found == true) {
        this.found = false;
        return x;
    }
    else {
        return null;
    }
}

    Node splaySearch(Node h, String x) {
        if (h == null) {
            return null;
        }
        if (x.compareTo(h.value) < 0) {
            try {
            if (x.compareTo(h.left.value) < 0) {
                h.left.left = splaySearch(h.left.left, x);
                h = rotateRight(h);
            } else if (x.compareTo(h.left.value) > 0) {
                h.left.right = splaySearch(h.left.right, x);
                h.left = rotateLeft(h.left);
            }
            else {
                this.found = true;
                return h.left;
            }
            return rotateRight(h);
            } 
        catch (NullPointerException ex) {
            return null;
            }
        }

        else { //basically x.compareTo(h.value)>0
            try {
            if (x.compareTo(h.right.value) > 0) {
                h.right.right = splaySearch(h.right.right, x);                
                h = rotateLeft(h);
            } else if (x.compareTo(h.right.value) < 0) {
                h.right.left = splaySearch(h.right.left, x);
                h.right = rotateRight(h.right);
            }
            else {
                this.found = true;
                return h.right;
            }
            return rotateLeft(h);
            }
            catch (NullPointerException ex) {
                return null;
            }
        }
    }

    Node rotateLeft(Node h) {
        Node x = h.right;
        h.right = x.left;
        x.left = h;
        return x;
    }
    Node rotateRight(Node h) {
        Node x = h.left;
        h.left = x.right;
        x.right = h;
        return x;
    }

    class Node {
        Node left;
        Node right;
        String value;
        int pos;
        public Node(String x) {
            left = null;
            right = null;
            value = x;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T00:00:59.030

我支持 Tristan Hull 使用“有效”搜索方法创建常规 BST 的方法。一旦你开始工作，添加一个 splay 方法就相当简单了。当我[在 Java 中实现 Splay Tree](http://code.google.com/p/java-algorithms-implementation/source/browse/src/com/jwetherell/algorithms/data_structures/SplayTree.java)时，我实际上做了同样的事情。这是一个更好的软件设计和更简单的实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:05:26.693

您的问题是，当您旋转时，您更新了函数“SplaySearch”中对节点 H 的引用，但没有更新原始“searchIt”函数中的父节点。因此，程序“认为”原始父节点仍然是父节点，即使旋转节点应该是父节点。因此，当您运行用于打印树的任何方法时，您从一个节点打印，该节点实际上不是树的父节点，而是一个子节点（它所在的级别取决于您的程序调用 rotateLeft 和 rotateRight 的次数）。

为了解决这个问题，我建议在普通二叉树中实现搜索，然后将“展开”函数与将节点展开到树顶部的搜索函数完全分开。您将在每次搜索结束时调用此 splay 函数，确保正确更新您的参考。这是实现伸展树的传统方式，我建议你看看它（也许看看关于伸展树的维基百科文章或谷歌搜索）。此外，您可能想知道您的旋转功能不完整。在展开树方面，您还有 2 种不同类型的双旋转，它们与单旋转非常不同。同样，我建议查找 splay 树以更深入地了解它们。

# objective-c - Release Custom Object returned by function

> ID：12790366
> 
> 赞同：0
> 
> 时间：2012-10-08T22:29:03.497
> 
> 标签：objective-c, xcode

I'm getting a leak memory error with a custom object (called LinesOfText class) returned by a function. This is a simple example with no detailed implementation:

```
-(void)myMethod(){
LinesOfText *linesOfText = [self linesOftext:@"this is my text"];
} 

-(LinesOfText *)linesOftext:(NSString *)_string{
LinesOfText *linesOfText = [[linesOfText alloc] init];
[linesOfText propsOfTextLine:_string];
return linesOfText;
} 
```

I'm not sure where I've to release the object

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T22:31:07.877

In myMethod, use:

```
LinesOfText *linesOfText = [[LinesOfText linesOftext:@"this is my text"] autorelease]; 
```

Instead of:

```
LinesOfText *linesOfText = [self linesOftext:@"this is my text"]; 
```

In your other file, use:

```
+(LinesOfText *)linesOftext:(NSString *)_string { 
```

Instead of:

```
-(LinesOfText *)linesOftext:(NSString *)_string { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:33:34.040

Usually such methods should return an autoreleased value, that is, in your linesOftext method, do

```
return [linesOfText autorelease]; 
```

(or call autorelease on it right when creating it),

```
LinesOfText *linesOfText = [[[linesOfText alloc] init] autorelease]; 
```

By convention, if your method name contains "new", "alloc", "copy", it should return a retained object. Return an autoreleased object otherwise (e.g. see methods like NSMutableArray's arrayWithCapacity:, or NSString's stringWithFormat:... See this for more information: [https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html)

And yes, like zsnow suggests it may be a good idea to make it a static (+) method if possible.

# android - Android - Emulator showing garbled layout

> ID：12790368
> 
> 赞同：0
> 
> 时间：2012-10-08T22:29:19.737
> 
> 标签：android, android-emulator

I'm developing an android app. So far I've been testing everything on my Galaxy Nexus with android 4+. I've done all my programming with backwards compatibility in mind.

I'm very close to release, and want to make sure that it runs okay on API 9+. Since I don't have a real android 2.3 phone, I'm using the emulator.

Everything seems to work fine, but the layout is sometimes okay, and sometimes completely garbled!

![enter image description here](../Images/bf13bf0c6c4f5092e90e5a64ce176a03.png)

The background is horrible, and `TextView`s are a lot of times missing. But sometimes they're okay for just a few moments before garbling up. How reliable is this emulator? Is this how it would really look if I ran it on a real machine? What can cause this?

EDIT: The layout in the screenshot is made up of 7 small `ViewGroups` containing `ListViews`. This is the code for the main background drawable (the blue-green-gray garbled one):

```
<?xml version="1.0" encoding="utf-8"?>
<bitmap xmlns:android="http://schemas.android.com/apk/res/android"
    android:src="@drawable/main_bgtile"
    android:tileMode="repeat" /> 
```

EDIT2: I also noticed that when a transaction animation when switching fragments is played, the fragments look perfect for the duration of the animation, and then re-garble when it's done.

**EDIT 3: My logcat seems to be flooded with the following error:** `10-09 00:41:40.385: D/skia(327): SkGL unimplemented: stroke path`

A few dozens of those. What should I do to fix this?

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T01:19:26.933

我解决了它：

我正在使用 actionbarsherlock；出于某种原因，我决定禁用样式中的操作栏，然后在活动中重新请求它。

通过从我的活动中的 onCreate() 方法中删除这一行，我能够解决问题： `this.getWindow().requestFeature(Window.FEATURE_ACTION_BAR)`

# encryption - Value obfuscation information at value level in RavenDB

> ID：12790370
> 
> 赞同：2
> 
> 时间：2012-10-08T22:29:33.450
> 
> 标签：encryption, obfuscation, ravendb

I am storing sensitive information within RavenDB relating to employee performance reviews. As such, I need a simple first-line-of-defence against curious db admins, to prevent them from browsing the data.

I would class this as client-side encryption (although it need not be TNO) just really to obfuscate the data, however, in such a way that it obviously does not impact indexability.

**Notes:**

1.  I am aware that indexed fields will remain unencrypted in Lucene.
2.  I would *really* like to maintain document schema browsability if possible, so if someone were to use Raven Studio, they would see something like this (they can see the schema, not the data):

    `{ WhatIThinkOfMyManager: 'jfjsd83hfdljdf983nofs==', AmIHappyWithMyPayLevel: false }`

Are there any facilitiesin Raven for this? And how do I go about it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T11:01:31.393

RavenDB 1.2 支持对磁盘上的数据（包括索引）进行加密。但是有权访问数据的管理员可以看到它的解密形式。

您可能希望将数据存储在使用您自己的代码加密的 RavenDB 中。

# android - Random layout XML in Android

> ID：12790371
> 
> 赞同：1
> 
> 时间：2012-10-08T22:29:50.343
> 
> 标签：android, xml

I want to randomize my layout using this code:

```
public class testing extends Activity 
   {
    /** Called when the activity is first created. */
      private Integer [] mLinearLayoutIds = { 
            R.layout.games0,
            R.layout.games1,
            R.layout.games2,
            R.layout.games3,
            R.layout.games4,
            R.layout.games5,
            }; 
      public void onCreate(Bundle savedInstanceState) 
         {
           super.onCreate(savedInstanceState);
           setContentView(R.layout.main);
           Random random = new java.util.Random();
           int rand = random.nextInt(6);
           setContentView(mLinearLayoutIds[rand]);
         }
  } 
```

but, every time the layout that was shown before is shown again.

How do I mark for a layout that has been shown before so it does not show again?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:43:11.103

这将需要持久存储。请参阅“SharedPreferences”来存储您的布局选项（或者如果您有很多，您可以选择使用 SQLite）。

每次用户启动活动时，您应该从数组中随机选择一个事件并将其存储为已使用并从该数组中取出。

这样做需要您在用户第一次打开应用程序时初始化数组。

（您可以只使用一个偏好并从包含您的选择的 JSONArray 中存储一个字符串。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:55:16.360

我假设“每次”是指“在后台后显示下一次活动”。我认为您已将代码放置在此任务的错误方法中。尝试将其移出`void onCreate()`to `void onResume()`。

```
public class Testing extends Activity {
    private Integer [] mLinearLayoutIds = { 
        R.layout.games0,
        R.layout.games1,
        R.layout.games2,
        R.layout.games3,
        R.layout.games4,
        R.layout.games5,
    };

    public void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       setContentView(R.layout.main);
    }

    public void onResume() {
        Random random = new java.util.Random();
        int rand = random.nextInt(6);
        setContentView(mLinearLayoutIds[rand]);
    }
} 
```

# iphone - Receiving reachability notifications while running in the background?

> ID：12790372
> 
> 赞同：1
> 
> 时间：2012-10-08T22:30:01.183
> 
> 标签：iphone, ios, notifications, reachability

I'm having trouble with receiving reachability notifications while running in the background as a location-based reminder app. Has any one succeeded in getting this to work and if so, how?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T18:32:04.943

我需要使用后台任务包围来让它工作。可达性需要一个活动的运行循环，而使用后台任务似乎是在后台提供此功能的一种方式。不确定是否有其他/更好的解决方案。

此外，如果您使用的是 RestKit，它已经附带了一个 Reachability Observer，它是 Apple Reachability 示例代码的修改版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T18:35:58.883

你不能在后台检查网络，我的建议是使用本地或推送通知来恢复你的应用程序，然后你可以检查网络状态。

# focus - JQuery focus on tab pressed

> ID：12790376
> 
> 赞同：0
> 
> 时间：2012-10-08T22:30:21.543
> 
> 标签：focus

Hi I am trying to make an input field focused when tab is pressed on another input field, but it's not working, anyone can tell me why?

Here is the code I'm using:

[http://jsfiddle.net/kk4GN/4/](http://jsfiddle.net/kk4GN/4/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:33:44.490

利用`event.preventDefault();`

**更新**——http [://jsfiddle.net/kk4GN/7/](http://jsfiddle.net/kk4GN/7/)

# r - How to choose non-interruped numbers only?

> ID：12790378
> 
> 赞同：4
> 
> 时间：2012-10-08T22:30:24.273
> 
> 标签：r, selection

I have two vectors:

```
x<-c(0,1,0,2,3,0,1,1,0,2)
y<-c("00:01:00","00:02:00","00:03:00","00:04:00","00:05:00",
     "00:06:00","00:07:00","00:08:00","00:09:00","00:10:00") 
```

I need to choose only those in `y`, where values of `x` is not interrupted by 0\. As a result, I'd like to get a dataframe like this

```
y        x
00:04:00 2
00:05:00 3
00:07:00 1
00:08:00 1 
```

We built a script like this, but with a big dataset it takes time. Is there a more elegant solution? And I wonder, why `df<-rbind(bbb,df)` returns inverted df?

```
aaa<-data.frame(y,x)
df<-NULL
for (i in 1:length(aaa$x)){
  bbb<-ifelse((aaa$x[i]*aaa$x[i+1])!=0, 
              aaa$x[i], 
              ifelse((aaa$x[i]*aaa$x[i-1])!=0, 
                     aaa$x[i], 
                     NA))
  df<-rbind(bbb,df)
}
df<-data.frame(rev(df))
aaa$x<-df$rev.df.
bbb<-na.omit(aaa)
bbb 
```

I'm a newbie in R, so please, as much detail as you can :) Thank you!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:51:14.860

```
aaa <- data.frame(y,x)
rles <- rle(aaa$x == 0)
bbb <- aaa[rep(rles$values == FALSE & rles$lengths >= 2, rles$lengths),] 
```

这使

```
> bbb
         y x
4 00:04:00 2
5 00:05:00 3
7 00:07:00 1
8 00:08:00 1 
```

您遇到的子问题：`df<-rbind(bbb,df)`返回`df`reversed 因为您`bbb`在其余（现有）行之前添加新行（）；颠倒参数的顺序，你不需要 reverse `df`。

现在分解答案，因为它涉及很多部分。`aaa`首先，重新表述您的标准，您希望至少有 2 行没有 0 的延伸。所以第一个标准是找到 0

```
> aaa$x == 0
 [1]  TRUE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE 
```

然后你想弄清楚这些伸展的长度；`rle`做这个。

```
> rle(aaa$x == 0)
Run Length Encoding
  lengths: int [1:8] 1 1 1 2 1 2 1 1
  values : logi [1:8] TRUE FALSE TRUE FALSE TRUE FALSE ... 
```

这意味着有 1 `TRUE`，然后是 1 ，然后是`FALSE`1 `TRUE`，然后是 2 `FALSE`s，等等。这个结果被分配给`rles`。您想要的部分是值所在的位置`FALSE`（不是 0），并且该运行的长度为 2 或更多。

```
> rles$values == FALSE & rles$lengths >= 2
[1] FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE 
```

这需要扩展回 的长度`aaa`，并且`rep`会这样做，使用`rles$lengths`来复制适当的条目。

```
> rep(rles$values == FALSE & rles$lengths >= 2, rles$lengths)
 [1] FALSE FALSE FALSE  TRUE  TRUE FALSE  TRUE  TRUE FALSE FALSE 
```

这给出了一个适合索引的逻辑向量`aaa`

```
> aaa[rep(rles$values == FALSE & rles$lengths >= 2, rles$lengths),]
         y x
4 00:04:00 2
5 00:05:00 3
7 00:07:00 1
8 00:08:00 1 
```

# php - php echo random value from text fields

> ID：12790380
> 
> 赞同：0
> 
> 时间：2012-10-08T22:30:28.130
> 
> 标签：php

I want to post all text box responses to results.php and then randomly choose one of the responses to display.

the form:

```
<form action="results.php" method="post">
<input maxlength="30" name="friend[]" size="30" type="text" placeholder="Enter an option" />
<input maxlength="30" name="friend[]" size="30" type="text" placeholder="Enter an option" />
<input maxlength="30" name="friend[]" size="30" type="text" placeholder="Enter an option" />
<input maxlength="30" name="friend[]" size="30" type="text" placeholder="Enter an option" />
<input type="submit" value="Submit" /> 
```

the php contents (obviously wrong, but something like this?)

```
foreach ($_POST['friend'] as $value) {          
    if ($value) {
      echo mt_rand($value);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:32:20.450

You could use [`array_rand`](http://php.net/manual/en/function.array-rand.php):

```
$random_input = $_POST['friend'][array_rand($_POST['friend'])]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:32:42.777

```
echo $_POST['friend'][ rand(0, count($_POST['friend']) - 1) ]; 
```

# linux-kernel - mapping memory reserved by mmap kernel boot param into user space

> ID：12790382
> 
> 赞同：6
> 
> 时间：2012-10-08T22:30:55.803
> 
> 标签：linux-kernel, kernel, linux-device-driver, embedded-linux, kernel-module

As discussed in [this](https://stackoverflow.com/q/1911473/143897) question, i am reserving a memory chunk at the boot time using a kernel boot parameter `memmap=8G$64G`

I have written a [character driver](http://pete.akeo.ie/2011/08/writing-linux-device-driver-for-kernels.html) kernel module which , ~~during initialization does a ioremap of this reserved memory chunk.~~ As explained [here](http://www.linuxquestions.org/questions/linux-kernel-70/mmap-of-several-gb-of-reserved-memory-using-805818/#post3972954) , in my driver `mmap` all i need to do is `remap_pfn_range` for this memory chunk pointer returned by the `ioremap`.

I am running this on **3.0 linux kernel**. My user space application opens this memory chunk as a device mounted by the driver. When i do `mmap` from the use space application i see a **system hang.** my `dmesg` don't provide me much information.

**Any inputs ?**

```
static int __init myDev_module_init(void)
{
   int retval;

   myDev_major = register_chrdev(0, DEVICE_NAME, &myDevfops);
   if (myDev_major < 0) 
   {
       err("failed to register device: error %d\n", myDev_major);
       retval = myDev_major;
       goto FAILED_CHRDEVREG;
   }

   myDev_class = class_create(THIS_MODULE, CLASS_NAME);
   if (IS_ERR(myDev_class)) 
   {   
       err("failed to register device class '%s'\n", CLASS_NAME);
       retval = PTR_ERR(myDev_class);
       goto FAILED_CLASSREG;
   }

   myDev_device = device_create(myDev_class, NULL, MKDEV(myDev_major, 0), NULL, CLASS_NAME "_" DEVICE_NAME);
   if (IS_ERR(myDev_device)) 
   {
       err("failed to create device '%s_%s'\n", CLASS_NAME, DEVICE_NAME);
       retval = PTR_ERR(myDev_device);
       goto FAILED_DEVREG;
   } 
```

here the `myDev.startOffset` is initialized to `#define`d 64GB and `myDev.memSize` to 8GB.

```
 //myDev.startAddr = ioremap(myDev.startOffset,myDev.memSize);

 //memset_io(myDev.startAddr, 0, myDev.memSize);  
 return 0;

  FAILED_DEVREG:
   class_unregister(myDev_class);
   class_destroy(myDev_class);
  FAILED_CLASSREG:
   unregister_chrdev(myDev_major, DEVICE_NAME);
  FAILED_CHRDEVREG:
   return -1;
}

static int myDev_device_open(struct inode* inode, struct file* filp)
{
    dbg("");

    if ( ((filp->f_flags & O_ACCMODE) == O_WRONLY) || ((filp->f_flags & O_ACCMODE) == O_RDWR) ) 
    {
        warn(" Opening the device with write access\n");
        //return -EACCES;
    }

    info(" device Open is called\n");
    filp->private_data = &myDev;
    return 0;
 } 
```

And the `mmap` is pretty straight forward.

```
static int myDev_device_mmap(struct file * f, struct vm_area_struct * vma)
{
 int retval = 0;
struct myDevDev * pDev = (struct myDevDev *)(f->private_data);

dbg("");
if(vma)
{
    if(f)
    {
        if(f->private_data)
            warn("mmap: f->private_data  : %p\n", f->private_data);
        else
            warn(" mmap :f->private_data  : NULL \n");
    }
    else
    {
        warn("mmap: f  :NULL\n");
    }
    warn(": mmap: vm start : %lu\n", vma->vm_start);
    warn(" mmap: vm end  : %lu\n", vma->vm_end);
    warn(" mmap: vm pg offset  : %lu\n", vma->vm_pgoff);

    //retval = remap_pfn_range(vma, vma->vm_start, pDev->startOffset >> PAGE_SHIFT,    pDev->memSize, PAGE_SHARED) ;
    // retval = remap_pfn_range(vma, vma->vm_start, pDev->startAddr >> PAGE_SHIFT,    pDev->memSize, PAGE_SHARED) ;
    //retval = remap_pfn_range(vma,pDev->startAddr ,pDev->startOffset >> PAGE_SHIFT,  pDev->memSize, PAGE_SHARED);
    retval = remap_pfn_range(vma,vma->vm_start ,pDev->startOffset >> PAGE_SHIFT,  pDev->memSize, PAGE_SHARED);
    if(retval <0)
    {
        warn(" ERROR : in mapping kernel virtual space to user space return value : %d \n",retval);
        return -EINVAL;
    }

    //if(0)
    {
        vma->vm_flags |=VM_LOCKED;
        vma->vm_ops = &myRemapVMOps;
        vma->vm_flags |= VM_RESERVED;

        vma->vm_private_data = f->private_data;
        myDevice_VMA_Open(vma);
    }
}
else
{
    warn ("vma is NULL");
}

dbg(" Done ");
warn("mmpaing done : \n");

return 0;
} 
```

from my user space application i am doing the following :

```
int err, i=0;
void * mptr = NULL;
printf(" Access the reserved memory chunk \n  ");
int fd = open("/dev/myDevice", O_RDWR | O_SYNC);

if(fd <=0)
{
    printf("ERROR: my device driver is not loaded \n");
    return 1;
}

  printf("\n mmaping mem chunk size :%llu pagesize :%lu input mptr :%p\n", sz,getpagesize (), mptr);

  mptr = mmap(0, sz , PROT_READ | PROT_WRITE, MAP_SHARED | MAP_LOCKED, fd, 0);

if(mptr == MAP_FAILED) 
{
    close(fd);
    perror("Error mmapping the file");
    printf("\nmmapped mem address %p\n",mptr);
    exit(1);
}
printf("\nmmapped mem address %p\n",mptr);

//char * ptr = (char *)mptr;
//*ptr = 'a';

//int * pInt =  (int *) (((char *) mptr)+1); 
//for(;i<10000; ++i)
{
  //  pInt[i] = 2*i;
}

 /* free the mmapped memory
 */
if (munmap(mptr, sz) == -1) 
{
    perror("Error un-mmapping the file");
}

close(fd); 
```

Observation :

I don't see the size getting reflected in the `(vma->vm_end - vma->vm_start)` which for some reason is **ALWAYS 4K.**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-31T11:51:48.527

1.  您可以逐步使用标准 phram 驱动程序从用户空间访问您的内存。不需要编码。内核重新​​编译最多。

2.  你真的有超过 64Gb 的 RAM 吗？你的硬件真的支持它吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-15T00:42:49.753

> 当我从使用空间应用程序执行 mmap 时，我看到系统挂起。

在您可以使用 remap_pfn_range() API 之前，请参阅 mm/memory.c（内核源代码）内联的文档，它表明您必须首先持有 mm 信号量。

```
/**
 * remap_pfn_range - remap kernel memory to userspace
 * @vma: user vma to map to
 * @addr: target user address to start at
 * @pfn: physical address of kernel memory
 * @size: size of map area
 * @prot: page protection flags for this mapping
 *
 *  Note: this is only safe if the mm semaphore is held when called.
 */ 
```

获取信号量的方法是通过 up_read() 和 down_read() API - 只需在 mm 目录中对 up_read 进行“grep”，有很多示例：

```
mempolicy.c:    up_read(&mm->mmap_sem);
migrate.c:  up_read(&mm->mmap_sem);
mincore.c:      up_read(&current->mm->mmap_sem);
mmap.c:     up_read(&mm->mmap_sem);
msync.c:            up_read(&mm->mmap_sem);
nommu.c:    up_read(&mm->mmap_sem); 
```

# java - 如何匹配两个并行数组的索引？

> ID：12790390
> 
> 赞同：0
> 
> 时间：2012-10-08T22:31:58.127
> 
> 标签：java, arrays, parallel-arrays

我在一个文本文件中有一个在姓名和年龄之间交替的列表。有9个名字和9个年龄。

我需要我的程序来显示

人（在此处插入姓名）具有最高年龄：（在此处插入年龄）。

到目前为止，这是我的代码：

```
 public class Names 
     {

public static void main(String[] args) throws Exception
{

      // get textfile
      Scanner input = new Scanner( new File("names_and_ages.txt") );

final String[] names= new String[9];
final int[] ages= new int[9];
int counter = 0;

while (input.hasNext()) //while not end-of-file
{
    names[counter]=input.next();  
    ages[counter]=Integer.parseInt(input.next());
    counter++;

}
highestAge(names, ages);
input.close();
}//end of main

public static void highestAge (String[] name, int[] age)
{
    String name;
int count = 0;
int oldest = highestAge[count];
for ( int number: highestAge)
{
    if (number > oldest)
        {
        oldest = number;
        }
}
System.out.print("Person " + name + " has the highest age: " + oldest );
}//end of Size method

}//end of class 
```

一切都编译了，我只是看不到使名称与年龄相匹配。帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:42:19.687

如果你创建了一个 Person 类，你就可以省去管理两个数组的麻烦。

这将是您的 Person 类：

```
class Person {
    String name;
    int age;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:43:03.810

```
public static void highestAge(String[] names, int[] ages)
{
    //SET SENSIBLE DEFAULTS TO oldest AND index
    int index = 0;
    int oldest = ages[0];
    //Looping based on index
    for (int i = 0;  i < ages.length; i++)
    {
        if (ages[i] > oldest)
        {
           index = i;
           oldest = ages[i];
        }
}
System.out.print("Person " + names[index] + " has the highest age: " + ages[index] );
}//end of Size method 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T22:42:54.067

你不远了。您需要维护最老年龄的“索引”，然后您可以使用它在两个数组之间进行引用。

```
public static void highestAge (String[] names, int[] ages)
{
    String name
    int oldest = 0;
    int oldestIndex = -1;
    for (int index = 0; index < ages.length; index++) 
    {
        if (ages[index] > oldest)
        {
            oldest = number;
            oldestIndex = index;
        }
    }
    System.out.print("Person " + names[oldestIndex] + " has the highest age: " + oldest );
}//end of Size method 
```

另外，我不知道您的示例是如何编译的，我没有看到在`highestAge`任何地方声明的数组：P

就个人而言，我会创建一个`Person`具有名称和年龄作为字段的类......

```
public class Person {
    private String name;
    private int age;
    public Person(String name, int age) {
        this.name = name;
        this.age = age;
    }

    public String getName() {
        return name;
    }

    public int getAge() {
        return age;
    }
} 
```

然后我会`Person`在循环的每次迭代中创建一个新的并将它们添加到一个人数组（`Person[] people = new Person[...]`）（实际上，我会使用 a 的实现，`java.util.list`但这就是我）

你会突然获得大量的创造力。

你可以提供一种`isOlderThen(Person person)`方法来比较人们。

```
if (person.isOlderThen(oldest)) {
    oldest = person;
} 
```

您实际上只是根据每个人的年龄对数组进行排序，使用[`Arrays.sort`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#sort%28T%5b%5d,%20java.util.Comparator%29)和[`Comparator`](http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T22:43:13.277

1）创建一个类

```
class person
{
   String name;
   int    age;
} 
```

2) 只创建一个数组：Person[] 个人

3）重写方法highestAge

```
Person getOldest( Person[] persons )
{
   Person oldest = null;
   for( Person person : persons )
   {
      if( oldest == null || person.age > oldest.age )
      {
         oldest = person;
      }
   }
   return oldest;
} 
```

# linux - Linux 中的 raw_spin_lock 是否禁用 hrtimer 中断？

> ID：12790392
> 
> 赞同：2
> 
> 时间：2012-10-08T22:32:05.580
> 
> 标签：linux, linux-kernel, kernel, deadlock, spinlock

在一个处理器上，在同一个线程中，首先调用 raw_spin_lock()，然后它启动一个 hrtimer 并再次返回 raw_spin_lock()，它将在那里旋转。在 hrtimer 中断处理函数中，会调用 raw_spin_unlock()。

这会导致死锁吗？在 raw_spin_lock() 上旋转会禁用中断吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T01:04:50.763

`raw_spin_lock_irq()`并`raw_spin_lock_irqsave()`禁用本地中断，但其他 CPU 上的中断仍然可能发生。`raw_spin_lock()`才不是。

如果任何中断处理程序试图锁定已经持有的自旋锁，那么在不小心启用本地中断的情况下使用自旋锁可能会导致死锁。出于同样的原因，我提到的所有功能都不是可重入的。锁拥有者永远不可能释放锁。不过，既然在这种情况下 ISR 会释放锁，死锁应该不成问题。

我认为您还应该检查*完成变量*，这些变量旨在执行您似乎试图以这种不寻常的方式使用自旋锁来完成的事情。见[这个](http://www.makelinux.com/books/lkd2/ch09lev1sec7)和`wait_on_completion(_interruptible)(_timeout)()` [这里](http://kernel.org/doc/htmldocs/device-drivers.html)的功能。

更多关于自旋锁的信息可以在[这里](http://lxr.free-electrons.com/source/Documentation/spinlocks.txt?v=3.6)找到。

# ruby-on-rails - 每 30 个字符用 \n 分解一个字符串

> ID：12790394
> 
> 赞同：0
> 
> 时间：2012-10-08T22:32:13.790
> 
> 标签：ruby-on-rails, ruby

> **可能重复：**
> [在单词边界处将文本换行成行](https://stackoverflow.com/questions/2312153/wrapping-text-into-lines-at-word-boundaries)

我需要从用户那里获取一个 textarea 输入，然后每 30 个字符将其分成多行。困难的部分是我还需要确保换行符发生在“”（空格）处，以免打断单词。

我最初试图解决这个问题的尝试是这样的：

```
if @square.text.length > 30
  text = @square.text[0, 31] + "\n" + @square.text[31, @square.text.length]
else
   text = @square.text
end 
```

另外，我知道上面只处理需要分解一次的字符串。我需要最多六个换行符。

任何想法如何去做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:49:49.717

`word_wrap`从文本助手中使用：

```
include ActionView::Helpers::TextHelper
# or, if you are in a controller
# helper :text

word_wrap(@square.text, :line_width => 30) 
```

# jquery - 彩盒未正确触发“未捕获的类型错误：对象 [对象对象] 没有方法‘彩盒’”

> ID：12790397
> 
> 赞同：1
> 
> 时间：2012-10-08T22:32:23.573
> 
> 标签：jquery, html, css, colorbox

我已将所有正确的文件放入其中，并且 js 和 css 已正确链接，但我的颜色框似乎无法正常工作。控制台中的错误是：

```
Uncaught TypeError: Object [object Object] has no method 'colorbox' 
```

在标题文本中链接（这是正确的）：

```
<!--ColorBox -->
<link rel="stylesheet" href="css/colorbox.css" />
    <script src="js/jquery.colorbox.js"></script>
    <script>
      $(document).ready(function(){
        //Examples of how to assign the ColorBox event to elements
        $(".group1").colorbox({rel:'group1'});
        $(".group2").colorbox({rel:'group2', transition:"fade"});
        $(".group3").colorbox({rel:'group3', transition:"none", width:"75%", height:"75%"});
        $(".group4").colorbox({rel:'group4', slideshow:true});
        $(".ajax").colorbox();
        $(".youtube").colorbox({iframe:true, innerWidth:425, innerHeight:344});
        $(".iframe").colorbox({iframe:true, width:"80%", height:"80%"});
        $(".inline").colorbox({inline:true, width:"50%"});
        $(".callbacks").colorbox({
          onOpen:function(){ alert('onOpen: colorbox is about to open'); },
          onLoad:function(){ alert('onLoad: colorbox has started to load the targeted content'); },
          onComplete:function(){ alert('onComplete: colorbox has displayed the loaded content'); },
          onCleanup:function(){ alert('onCleanup: colorbox has begun the close process'); },
          onClosed:function(){ alert('onClosed: colorbox has completely closed'); }
        });

        //Example of preserving a JavaScript event for inline calls.
        $("#click").click(function(){ 
          $('#click').css({"background-color":"#f00", "color":"#fff", "cursor":"inherit"}).text("Open this window again and this message will still be here.");
          return false;
        });
      });
    </script>
<!-- End ColorBox --> 
```

任何人都可以帮忙吗？[这里](http://www.rubytuesdaycreative.co.uk/testsite/)有一个活生生的例子

单击“注册我”按钮时，颜色框应启动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T23:37:38.257

脚本有问题。你有两个额外的“})”集。像这样删除它们：

```
<script>
  $(document).ready(function(){
    $(".callbacks").colorbox({
      inline:true,
      onOpen:function(){ alert('onOpen: colorbox is about to open'); },
      onLoad:function(){ alert('onLoad: colorbox has started to load the targeted content'); },
      onComplete:function(){ alert('onComplete: colorbox has displayed the loaded content'); },
      onCleanup:function(){ alert('onCleanup: colorbox has begun the close process'); },
      onClosed:function(){ alert('onClosed: colorbox has completely closed'); }
    });

    //Example of preserving a JavaScript event for inline calls.
    $("#click").click(function(){ 
      $('#click').css({"background-color":"#f00", "color":"#fff", "cursor":"inherit"}).text("Open this window again and this message will still be here.");
      return false;
    });
  });
</script> 
```

给自己找一个可以进行代码折叠的编辑器，这样你就可以直观地看到这些错误。

另外，不要在头部加载 JS；这是一个性能打击。[http://developer.yahoo.com/performance/rules.html#js_bottom](http://developer.yahoo.com/performance/rules.html#js_bottom)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:37:42.277

修复[http://www.rubytuesdaycreative.co.uk/testsite/src/jquery.countdown2.js中的语法错误](http://www.rubytuesdaycreative.co.uk/testsite/src/jquery.countdown2.js)

`Uncaught SyntaxError: Unexpected token }`

其他一切看起来都不错

# iphone - 什么方法让 MKPinAnnotaionView 向北质押？

> ID：12790399
> 
> 赞同：0
> 
> 时间：2012-10-08T22:32:25.753
> 
> 标签：iphone, annotations, mkmapview, ios6

我正在根据设备的标题旋转 MapView，而 MKPinAnnotationView 总是向北倾斜。我想改变它，我应该改变什么方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T06:50:27.970

尝试使用

```
- (void)mapView:(MKMapView *)mapView regionWillChangeAnimated:(BOOL)animated;
- (void)mapView:(MKMapView *)mapView regionDidChangeAnimated:(BOOL)animated; 
```

# html - How to make webpage build dynamically based on previous clicked link?

> ID：12790400
> 
> 赞同：0
> 
> 时间：2012-10-08T22:32:28.717
> 
> 标签：html, sql, dynamic, web

I am setting up a website where you click a category which takes you to a page listing various items under that category. How can I make it where after a user selects a category the webpage is dynamically built around that category. Example: After clicking Beer category the next page will say "List of Beer", had they clicked wine it would say "List of Wine."

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T02:24:31.420

您需要使用检索方法设置某种数据存储。

例如，您可以创建一个数据存储（SQL、XML 等），并在其上放置服务（在这种情况下，您的服务可能是 /category/{name}）。然后，您的网页可以调用该服务，并动态显示数据存储中的数据。

有一些很好的资源可以帮助您入门，例如 codeigniter (php)、spring (java) 和 ASP.NET MVC

# java - Need to save JSON in ORMLite and serialize it via Jackson

> ID：12790404
> 
> 赞同：1
> 
> 时间：2012-10-08T22:32:36.910
> 
> 标签：java, android, json, jackson, ormlite

I have a field on an object that is JSON. I can save this as a String but then when I use Jackson to serialize it and send it up to my server, the JSON is treated as a string and escaped. I'd like to send it up as actual JSON. I've made my getters and setters on the model use JSONObject even though the field is a String, and this makes ORMLite happy but now I'm getting errors when using Jackson for serialization. How can I store JSON via ORMLite and send it unescaped via Jackson (on Android)?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:21:24.340

如果它已经存储为 JSON 编码的字符串，你不想使用像杰克逊这样的库——只需按原样编写字符串。除非您确实需要以某种方式修改数据，在这种情况下，您需要先解析，然后修改，然后生成为 JSON。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:21:40.837

将字符串转换为 byte[] 并保存为 byte[]。当您将其拉出时，只需将`new String(bytes)`其传递给杰克逊。

# ruby-on-rails - Error installing bcyrpt-ruby gem bundle

> ID：12790411
> 
> 赞同：2
> 
> 时间：2012-10-08T22:33:08.513
> 
> 标签：ruby-on-rails, gem, bundle-install, bcrypt-ruby

I'm trying to install the Devises gem, running `bundle install` and then getting this error with bcrypt-ruby which I haven't had before. What can I do?

```
Installing bcrypt-ruby (3.0.1) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb 
creating Makefile

make
xcrun cc -I. -I/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/universal-darwin11.0 -I/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/universal-darwin11.0 -I. -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common -arch i386 -arch x86_64 -g -Os -pipe -fno-common -DENABLE_DTRACE  -fno-common  -pipe -fno-common   -c bcrypt_ext.c
Error: No developer directory found at /Developer. Run /usr/bin/xcode-select to update the developer directory path.
make: *** [bcrypt_ext.o] Error 1

Gem files will remain installed in /Users/Fryed/.bundler/tmp/25124/gems/bcrypt-ruby-3.0.1 for inspection.
Results logged to /Users/Fryed/.bundler/tmp/25124/gems/bcrypt-ruby-3.0.1/ext/mri/gem_make.out
An error occured while installing bcrypt-ruby (3.0.1), and Bundler cannot continue.
Make sure that `gem install bcrypt-ruby -v '3.0.1'` succeeds before bundling. 
```

Okay, so I need to install bcrypt-ruby...

```
wpub-6-65:treebook Fryed$ sudo gem install bcrypt-ruby -v '3.0.1'
Password:
Building native extensions.  This could take a while...
ERROR:  Error installing bcrypt-ruby:
    ERROR: Failed to build gem native extension.

        /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb
creating Makefile

make
xcrun cc -I. -I/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/universal-darwin11.0 -I/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/universal-darwin11.0 -I. -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common -arch i386 -arch x86_64 -g -Os -pipe -fno-common -DENABLE_DTRACE  -fno-common  -pipe -fno-common   -c bcrypt_ext.c
Error: No developer directory found at /Developer. Run /usr/bin/xcode-select to update the developer directory path.
make: *** [bcrypt_ext.o] Error 1

Gem files will remain installed in /Library/Ruby/Gems/1.8/gems/bcrypt-ruby-3.0.1 for inspection.
Results logged to /Library/Ruby/Gems/1.8/gems/bcrypt-ruby-3.0.1/ext/mri/gem_make.out 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T14:03:21.720

要么你没有安装 XCode，要么你的开发者目录配置不正确。

如果是第一个，请尝试安装 XCode。

如果是第二个，试试这个（或一些变化，取决于你的 XCode 目录在哪里）

```
sudo xcode-select -switch /Applications/Xcode.app/Contents/Developer 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-20T23:03:39.707

```
gem 'bcrypt-ruby', '~>3.0.1', :github => 'rking/bcrypt-ruby' 
```

rking 的 bcrypt-ruby 分支注释掉 3.0.1 的失败 c 编译补丁。Bcrypt-ruby 在一年前修复了这个问题，但不是针对版本 3.0.1，这似乎是您的 Rails 应用程序所需的依赖项。

在 github 上查看问题： [https ://github.com/bundler/bundler/issues/2410](https://github.com/bundler/bundler/issues/2410)

# applescript - Applescript 本机工作，但不在文件制作器中

> ID：12790412
> 
> 赞同：0
> 
> 时间：2012-10-08T22:33:21.263
> 
> 标签：applescript, filemaker

我正在尝试将 pdf 保存为文本。以下代码在我在 scripteditor 中运行时有效，但在我在 filemaker 中运行时无效（在将我的 applescripts 转换为在 filemaker 步骤中运行之前我从未遇到过问题）。

```
activate application "Adobe Reader"
tell application "System Events"
    tell process "Adobe Reader"
        click menu item "Text..." of menu 1 of menu item "Save As" of menu 1 of menu bar item "File" of menu bar 1
    end tell
end tell 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T04:49:08.143

此类命令的一个可能错误来源是**“文本...”**菜单项名称中的 3 个点。一些菜单项实际上使用 3 个句点，而另一些则使用省略号（您可以使用选项分号键入）。我以前使用过错误的表格，所以请确保您为菜单项使用了正确的表格。

唯一确定的方法是尝试两者，看看哪个有效。通常使用省略号，因此最好先尝试该形式。

# php - 在 Symfony 中，有没有办法一次创建 pdf 文件页面？

> ID：12790414
> 
> 赞同：6
> 
> 时间：2012-10-08T22:33:31.640
> 
> 标签：php, symfony, pdf-generation, twig

我有带有 TWIG 模板引擎的 Symfony 框架。我正在制作 1000 页的 pdf

```
<dynamic-page>...content in for-loop...</dynamic-page>` 
```

但是，在使用 写入磁盘时`ps_facade`，它给了我内存耗尽的致命错误。那么有什么方法可以让我以 5 页为单位创建这个 pdf 文件吗？

经过研究，我发现使用包含 5 页数据的模板然后将其写入文件应该可以。但这样我将无法添加页码，因为页码应该是 1-1000。我的页脚代码如下所示，

```
<placeholders>
    <footer>
        <div height="30px" width="100%">
        <hr/>
        <div float="left">Blah Blah</div>
        <div float="left" margin-left="350px"><page-info format="Page %s of %s"></div>
        </div>
    </footer>
</placeholders> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T10:44:25.890

[对于这样的长进程](http://knplabs.fr/blog/knpbundles-now-uses-rabbitmq)，您应该使用消息传递系统。RabbitMQ 可以完成这项工作。

1.  您的用户请求 pdf
2.  您立即告诉他，他的请求已被考虑，并且在工作完成后他会收到一封电子邮件，或者他可以稍后再回来
3.  消费者看到工作，并启动 pdf 生成（不必在 php 中）。

优点：由于该进程不是由 php 的 web 版本运行，它没有 memory_limit 和 max_execution 时间限制如果作业已经在运行，您可以告诉您的用户，而不是为同一个 pdf 启动另一代。而且由于人们在不耐烦时经常刷新页面，这对于您的服务器来说确实是一个巨大的 Pro（更少的 CPU 使用率）。

缺点：你必须设置一个消息服务器并学习一些东西。但这真的是骗局吗？

# android - android BluetoothChat 使用来自另一个类的发送接收方法

> ID：12790419
> 
> 赞同：0
> 
> 时间：2012-10-08T22:33:39.220
> 
> 标签：android, bluetooth, arduino

您好，我正在使用 BluetoothChat 示例与 arduino 通信。到目前为止一切正常，现在我想访问 sendMessage() 方法，以便能够不是从主类发送数据，而是从我创建的另一个类发送数据。这是 BluetoothChat.java 中的 BluetoothChat 发送函数

```
private void sendMessage(String message) {
    // Check that we're actually connected before trying anything
    if (mChatService.getState() != BluetoothChatService.STATE_CONNECTED) {
        Toast.makeText(this, R.string.not_connected, Toast.LENGTH_SHORT).show();
        return;
    }

    // Check that there's actually something to send
    if (message.length() > 0) {
        // Get the message bytes and tell the BluetoothChatService to write
        byte[] send = message.getBytes();
        mChatService.write(send);
        // Reset out string buffer to zero and clear the edit text field
        mOutStringBuffer.setLength(0);
        mOutEditText.setText(mOutStringBuffer);
    }
} 
```

现在我想从我的 Config.java 访问它。这是我到目前为止所做的。我将私有 void sendMessage 更改为公共，并在 Config.java 中添加了这些：

```
BluetoothChat firstClass = new BluetoothChat(); 
```

并在 onCreate 这个

```
firstClass.sendMessage("test"); 
```

虽然我在切换到 Config.java 活动时没有收到任何错误，但应用程序崩溃了。
任何人都可以帮我解决这个问题吗？谢谢！

日志猫

> 10-08 22:49:15.125: D/dalvikvm(1541): GC_EXTERNAL_ALLOC 释放 98K, 47% 空闲 2962K/5511K, 外部 3943K/4883K, 暂停 23ms 10-08 22:49:15.128: D/BluetoothSocket(1541):套接字已经处于关闭状态：android.bluetooth.BluetoothSocket@40535c88 10-08 22:49:15.128：D/BluetoothSocket(1541)：套接字已经处于关闭状态：android.bluetooth.BluetoothSocket@40523b10 10-08 22:49:15.296 : E/BluetoothChat(1541): -- ON STOP -- 10-08 22:49:20.585: D/AndroidRuntime(1541): 关闭 VM 10-08 22:49:20.585: W/dalvikvm(1541): threadid =1：线程以未捕获的异常退出（组= 0x40015578）10-08 22：49：20.589：E/AndroidRuntime（1541）：致命异常：主要10-08 22：49：20.589：E/AndroidRuntime（1541）：java .lang.NullPointerException 10-08 22:49:20.589：E/AndroidRuntime(1541)：在 com.example.android.BluetoothChat.BluetoothChat。sendMessage(BluetoothChat.java:218) 10-08 22:49:20.589: E/AndroidRuntime(1541): 在 com.example.android.BluetoothChat.Config.onItemSelected(Config.java:45) 10-08 22:49: 20.589: E/AndroidRuntime(1541): 在 android.widget.AdapterView.fireOnSelected(AdapterView.java:871) 10-08 22:49:20.589: E/AndroidRuntime(1541): 在 android.widget.AdapterView.access$200( AdapterView.java:42) 10-08 22:49:20.589: E/AndroidRuntime(1541): 在 android.widget.AdapterView$SelectionNotifier.run(AdapterView.java:837) 10-08 22:49:20.589: E/ AndroidRuntime(1541): 在 android.os.Handler.handleCallback(Handler.java:587) 10-08 22:49:20.589: E/AndroidRuntime(1541): 在 android.os.Handler.dispatchMessage(Handler.java:92 ) 10-08 22:49:20.589: E/AndroidRuntime(1541): 在 android.os.Looper.loop(Looper.java:130) 10-08 22:49:20.589:E/AndroidRuntime(1541): 在 android.app.ActivityThread.main(ActivityThread.java:3687) 10-08 22:49:20.589: E/AndroidRuntime(1541): 在 java.lang.reflect.Method.invokeNative(Native方法) 10-08 22:49:20.589: E/AndroidRuntime(1541): 在 java.lang.reflect.Method.invoke(Method.java:507) 10-08 22:49:20.589: E/AndroidRuntime(1541) : 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842) 10-08 22:49:20.589: E/AndroidRuntime(1541): 在 com.android.internal.os.ZygoteInit.main （ZygoteInit.java:600）10-08 22:49:20.589：E/AndroidRuntime（1541）：在 dalvik.system.NativeStart.main（本机方法）E/AndroidRuntime(1541): 在 java.lang.reflect.Method.invoke(Method.java:507) 10-08 22:49:20.589: E/AndroidRuntime(1541): 在 com.android.internal.os.ZygoteInit $MethodAndArgsCaller.run(ZygoteInit.java:842) 10-08 22:49:20.589: E/AndroidRuntime(1541): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600) 10-08 22 :49:20.589: E/AndroidRuntime(1541): at dalvik.system.NativeStart.main(Native Method)E/AndroidRuntime(1541): 在 java.lang.reflect.Method.invoke(Method.java:507) 10-08 22:49:20.589: E/AndroidRuntime(1541): 在 com.android.internal.os.ZygoteInit $MethodAndArgsCaller.run(ZygoteInit.java:842) 10-08 22:49:20.589: E/AndroidRuntime(1541): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600) 10-08 22 :49:20.589: E/AndroidRuntime(1541): at dalvik.system.NativeStart.main(Native Method)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:28:09.683

BluetoothChat 类是一个活动。Activity对象由Android OS管理（调用created、onCreate、onResume等方法）。

所以，你不应该做这样的事情：

```
BluetoothChat firstClass = new BluetoothChat(); 
```

有几种方法可以重用此功能

a) 从 BluetoothChat 复制并将其粘贴到 Config（让我们暂时忘记代码重复）。

您需要从管理 mBluetoothAdaptor 方法的 onCreate、onStart 和其他方法复制代码

b) 如果您要同时保留 BluetoothChat 活动和 Config 活动，您可以将可重用代码移动到某个帮助程序类（不是活动）并从两个活动中使用它。

PS 我建议阅读一些关于活动及其生命周期的信息，因为如果没有这些知识，开发任何 Android 应用程序都将非常困难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T03:20:31.417

您需要 Thread 或 AsyncTask 来通过蓝牙从 Android 发送 ant 消息。看这个简单的例子：[http ://english.cxem.net/arduino/arduino5.php](http://english.cxem.net/arduino/arduino5.php)

# java - Big-O 运行时确定 List 是否包含 X 和 F(X)

> ID：12790423
> 
> 赞同：0
> 
> 时间：2012-10-08T22:33:54.147
> 
> 标签：java, big-o

我试图了解以下方法的大 O 是什么。

```
 for(Integer i : list){
        if(list.contains(-i))
            //doSomething
    } 
```

我知道 contains 方法是 O(n)，而像这样的 for 循环也是 O(n)。这是否使此方法的总数为 O(n * n)？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:38:06.753

假设`List.contains`是O(n)，那么是的，整个算法是O(n^2)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-13T07:30:41.130

但是，如果您在列表中使用迭代器并使用 hasNext 方法，那么最坏情况下的总运行时间将大 O(n)。近似公式将是一个常数加上 n，其中 n 是 if 条件。与 for 循环不同，迭代器需要一个恒定的时间来返回一个对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-13T07:37:22.773

因此，假设 m 和 n 是两个列表，那么总运行时间将为 n+1m+2m+...+(n-n+1)m。

# sql - 如何使用基于函数的索引

> ID：12790424
> 
> 赞同：0
> 
> 时间：2012-10-08T22:34:07.280
> 
> 标签：sql, oracle

这是我第一次尝试在 oracle 中使用基于函数的索引。但我不知道如何实现它。我在网上搜索并找到了与此相关的简单示例，例如使用 UPPER 函数索引的 SQL 等。虽然，我发现很多可以解释什么是基于函数的索引，但没有任何内容可以解释它在复杂 SQL 的情况下是如何工作的。我使用子选择跟踪 SQL 并且确实存在性能问题，当我进行一些搜索以改进它时，我发现有一种叫做基于函数的索引的东西。但现在我不知道如何使用它以及它如何提高性能。这是SQL。你能帮我如何在这个 SQL 上实现基于函数的索引（如果有可能的话。）

```
INSERT INTO TABLE1( K_ID, KKID, K_SEGMENTS, COL1, COL2, COL3, COL4, COL5, COL6, COL7 , COL8,COL9, COL10) 
SELECT DISTINCT K_ID , KKID , K_SEGMENTS , COL1 , COL2 , COL3 , COL4 , COL5 , COL6 , COL7 
, COL8 , COL9 , COL10 
 FROM TABLE2 A 
 , TABLE3 P 
 WHERE P.KEY1 = A.KEY1 
 AND NOT EXISTS ( 
 SELECT 1 
  FROM TABLE1 B 
  WHERE 1=1 
  AND A.K_ID = B.K_ID 
  AND A.K_SEGMENTS = B.K_SEGMENTS) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T07:34:33.473

您的查询不使用基于函数的索引可能有助于的“函数”（例如 UPPER）。您的子查询与and`TABLE1`相关，因此如果我确信性能问题与此子查询有关，我会考虑的一件事是在这两列上添加一个普通索引（即不是 FB 索引）。`K_ID``K_SEGMENTS`

如果您只需要提高查询的性能，我首先要看的是解释计划。

# c# - SerialPort.Write() 和 SerialPort.WriteLine() 之间的区别？

> ID：12790427
> 
> 赞同：0
> 
> 时间：2012-10-08T22:34:26.910
> 
> 标签：c#, methods, serial-port, msdn

我查看了 msdn 上的[SerialPort.Write()](http://msdn.microsoft.com/en-us/library/y2sxhat8.aspx)和[SerialPort.WriteLine()](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.writeline.aspx)方法，并在下面的简单代码上尝试了它们，但它们看起来与我非常相似。

有人可以简单地解释一下主要区别是什么吗？

```
if (sendtoprint == true)
            {
                for (int i = 0; i < gcode.Count(); i++)
                {
                    port.Write(gcode[i]);
                } 
```

和

```
if (sendtoprint == true)
            {
                for (int i = 0; i < gcode.Count(); i++)
                {
                    port.WriteLine(gcode[i]);
                } 
```

和

```
if (sendtoprint == true)
            {
                for (int i = 0; i < gcode.Count(); i++)
                {
                    port.Write(gcode[i]+"\r\n");
                } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-08T22:38:25.873

WriteLine 附加指定的文本和换行符。Write 仅附加指定的文本。

例如：

```
Write("A");
Write("B");
Write("C"); 
```

将导致：ABC

然而：

```
WriteLine("A");
WriteLine("B");
WriteLine("C"); 
```

会导致：

```
A
B
C 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-08T22:36:09.887

在顶部的[WriteLine doc中：](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.writeline.aspx)

> [WriteLine] 将指定的字符串*和*NewLine 值写入输出缓冲区。

WriteLine 将`NewLine`字符添加到输出的末尾，而 Write 没有。

所以`SerialPort.Write("Hello")`会输出`"Hello"`到缓冲区。

并将`SerialPort.WriteLine("Hello")`输出类似于`"Hello\n"`缓冲区的内容。（取决于当前的换行值）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T22:42:18.360

我相信唯一的区别是该`WriteLine`方法添加了，`\n`因此下一个数据流将打印在新行上。这对于`Console.Write()`和是一样的`Console.WriteLine()`。

# iphone - 如何在 iPhone 设备上部署现有的 sqlite 文件

> ID：12790431
> 
> 赞同：0
> 
> 时间：2012-10-08T22:34:34.677
> 
> 标签：iphone, ios, sqlite

我的 iPhone 应用程序上有一个旧的 sqlite 文件，但是在设备上测试时找不到 sqlite 文件。有什么方法可以在 iPhone 设备上部署 sqlite 文件吗？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T22:36:31.947

该文件需要添加到您的 Xcode 项目中。确保您正在加载正确的文件并且没有拼写错误。

**编辑：**根据评论更新：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"sqlitefile" ofType:@"db"];
if ([[NSFileManager defaultManager] fileExistsAtPath:path]) {
    // Don't create new sqlite file
}
else {
    // Create a new sqlite file
} 
```

# http - 不同的 HTTP 主机通过同一个 TCP 连接

> ID：12790440
> 
> 赞同：2
> 
> 时间：2012-10-08T22:36:03.523
> 
> 标签：http, tcp, connection, host, multiplexing

HTTP 服务器是否应该期望`Host`在同一个 TCP 连接上接收具有不同字段的请求？尽管与直觉相反，RFC 2616 似乎并没有明确禁止客户端在认为合适的情况下将请求多路复用到同一连接上的不同主机。

任何相关文件中是否有任何规范性规则禁止这样做？如果没有，是否有任何实际考虑可以有效防止这种情况，从而允许服务器不对每个请求检查主机？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T16:01:00.387

引用 Chromium 的 William Chan 的话：

> 除了 SPDY，这不会发生，除了代理服务器。
> 
> 如果 IP 地址重叠，我们实际上已经讨论过重用与不同主机的 TCP 连接，但考虑了安全性和破坏 HTTP 服务器实现（假设您有一个反向代理 HTTP 服务器，它具有不同的应用程序服务器后端，可能具有不同的所有者...... .一个损坏的反向代理可能只是假设所有连接重用都将指向同一个应用程序服务器后端，这会很糟糕）。

所以很有可能，尽管 Chromium 不这样做。

# eclipse - 如何在eclipse中构建PCL+OpenCV+OpenNI项目

> ID：12790449
> 
> 赞同：0
> 
> 时间：2012-10-08T22:37:11.700
> 
> 标签：eclipse, opencv, kinect, openni, point-cloud-library

我已经成功配置了包含和库，以便在 OS X 下的 Eclipse 中构建 OpenCV 和 OpenNI。但是现在我需要添加 PCL 库。我尝试以相同的方式执行此操作，但是 1- 文件很多，2-添加库后[出现 614 错误。](http://pastebin.com/6DadfdPR)

我有 CMakeLists.txt，我可以用它来构建 PCL 项目。

```
find_package(PCL 1.3 REQUIRED)
include_directories(${PCL_INCLUDE_DIRS})
link_directories(${PCL_LIBRARY_DIRS})
add_definitions(${PCL_DEFINITIONS}) 
```

我可以以某种方式将此 Cmake 添加到已经工作的 OpenCV+OpenNI 的现有配置中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:45:24.940

从您得到的错误来看，您似乎没有链接到某些依赖项，例如`VTK`. `OpenCV`我认为这与or无关`OpenNI`。

编辑：我`VTK`在您的屏幕截图中看不到任何内容。您应该在该部分中包含标头文件夹路径，该`Include`部分中的库文件夹路径以及该`Library search path`部分中的库本身`Libraries`（在您的屏幕截图中的相同位置`libpcl_visualization`等）。（*免责声明：我没有使用 Eclipse，我从你的截图中猜测，如果我错了，请编辑我的答案*）

请注意，由于您没有使用 CMake，您可能迟早必须为其他依赖项执行此操作（例如 Boost 等）

# asp.net-mvc - 部署 ASP.NET MVC Web 应用程序

> ID：12790451
> 
> 赞同：0
> 
> 时间：2012-10-08T22:37:13.960
> 
> 标签：asp.net-mvc, deployment

我正在尝试将我的站点发布到远程主机，但在托管面板中找不到服务 URL。

我应该在服务 URL 部分写什么才能连接到目标计算机并在其上发布应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T02:19:53.580

服务 URL 通常为： [https ://mywebserver.com:8172/MsDeploy.axd](https://mywebserver.com:8172/MsDeploy.axd)

# php - 在函数中分配和传递引用变量

> ID：12790452
> 
> 赞同：0
> 
> 时间：2012-10-08T22:37:19.517
> 
> 标签：php, function, variables, reference

```
function test(&$a)
{
    $a = $a + 3;

} 
```

如果我先分配变量并调用它： $a = 3; 测试($a); 回声$a; //它将输出6

但如果我做这个测试($a = 3); 回声$a; //它将返回3

这是为什么？第二个函数调用中的引用变量是否也将其修改为 6？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:42:16.973

开启严格标准即可查看：

> 只有变量应该通过引用传递

您不应该期望您的第二个示例完全有效。它确实似乎是一个巧合，尽管 PHP 确实记录了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:46:49.510

```
<?php
function test(&$a)
{
    echo $a;
    $a = $a + 3;
}

test($q = 3);
?> 
```

这输出`3`. 我有点惊讶，我希望看到`true`as`$q = 3`通常会成功并因此返回 true。

# filepicker.io - filepicker.io 转换

> ID：12790456
> 
> 赞同：1
> 
> 时间：2012-10-08T22:37:32.240
> 
> 标签：filepicker.io

我有一个文件选择器网址

[https://www.filepicker.io/api/file/wIilPqwFSxCg8zZdsYTN?dl=false](https://www.filepicker.io/api/file/wIilPqwFSxCg8zZdsYTN?dl=false)

然后我对此进行一些编辑并使用 CURL 命令将其保存回来。这作为例外工作。

我遇到的问题是当我使用转换选项创建缩略图时，它不会从新图像创建缩略图，而是从旧图像创建缩略图。

[https://www.filepicker.io/api/file/wIilPqwFSxCg8zZdsYTN/convert?h=150&w=150&fit=crop&dl=false](https://www.filepicker.io/api/file/wIilPqwFSxCg8zZdsYTN/convert?h=150&w=150&fit=crop&dl=false)

# c# - System.Security.Cryptography 与 Windows.Security.Cryptography

> ID：12790459
> 
> 赞同：14
> 
> 时间：2012-10-08T22:37:49.040
> 
> 标签：c#, encryption, windows-8

我是一名新的 Windows 8 开发人员，我有一些专为 Linux 设计的代码，但只要安装了 GTK#，我也可以在 Windows 上运行。

我目前正在将该应用程序作为现代 UI (Metro) 应用程序移植到 Windows 8。它进展顺利，但当我尝试导入我的密钥派生代码（它获取用户的密码并从中派生一个 256 位密钥）时，Visual Studio Ultimate 2013 表明它无法识别`using System.Security.Cryptography`.

在查看 Windows 8 开发人员网站后，我发现有一个新类`Windows.Security.Cryptography`可用，但是 Visual Studio 似乎也无法识别它。

所以，既然你有了背景，我有几个问题：

1.  System.Security.Cryptography 在 Windows 8 中可用吗？如果支持，是否支持 RT 版本？如何让 Visual Studio 识别它？
2.  Windows.System.Security 有何不同，是否有与 Rfc2898DeriveBytes 兼容的类/方法？通过兼容，我的意思是给定相同的密码和盐，因此有办法获得相同的密钥。

为了澄清我想要做什么，我的密钥派生代码发布在下面：

```
public class GetKey
{
    // constructor
    public GetKey (bool use=true, string password="none")
    {   if (use == true)
        {
            this.genSalt();
            byte[] salt = this.salt;
            Rfc2898DeriveBytes pwdKey = new Rfc2898DeriveBytes(password, salt, 4000);
            this.key = pwdKey.GetBytes(32);
            this.iv = pwdKey.GetBytes(16);
        }
    }

    // properties
    private byte[] key;
    private byte[] iv;
    private byte[] salt;

    // methods
    public void retrieveKey(string password)
    {
        try 
        {
            byte[] salt = this.salt;
            Rfc2898DeriveBytes pwdKey = new Rfc2898DeriveBytes(password, salt, 4000);
            this.key = pwdKey.GetBytes(32);
            this.iv = pwdKey.GetBytes(16);
        }
        catch (Exception e)
        {
            GenericDialog win = new GenericDialog("Unknown Error: " + e.Message, "Error Notice", "Unknown Error");
            win.Show();
        }
    }

    public void genSalt()
    {
        string sSalt = UtilityClass.randString(16);
        byte[] salt = UtilityClass.ToByteArray(sSalt);
        this.salt = salt;
    }   

    public byte[] returnKey()
    {
        return this.key;
    }

    public byte[] returnIv()
    {
        return this.iv;
    }

    public byte[] returnSalt()
    {
        return this.salt;
    }
    public bool setSalt(string salt)
    {
        try 
        {
            this.salt = Convert.FromBase64String(salt);
        }
        catch
        {
            GenericDialog win = new GenericDialog("Decryption failed because the salt was invalid.", "Error Notice", "Invalid Salt");
            win.Show();
            return false;
        }
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-25T20:08:31.673

1) System.Security.Cryptography 在 Windows 应用商店应用中不可用，因此您必须使用 Windows.Security.Cryptography。有关使用 .NET 可移植库为不同目标框架重用类库的详细说明，请参阅下面的链接。如果需要，您始终可以使用您最喜欢的 IoC 容器注入抽象。

[http://www.hanselman.com/blog/HiddenGemsInVisualStudio11BetaNETPortableClassLibraries.aspx](http://www.hanselman.com/blog/HiddenGemsInVisualStudio11BetaNETPortableClassLibraries.aspx)

2) 我在 Windows.Security.Cryptography 或类似的东西中看不到 Rfc2898DeriveBytes 的实现。见下文。

[http://msdn.microsoft.com/en-us/library/windows/apps/windows.security.cryptography.core.symmetricalgorithmnames.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.security.cryptography.core.symmetricalgorithmnames.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-11T17:47:57.540

Windows.Security.Cryptography 及其子命名空间可能是要走的路。

请参阅[http://msdn.microsoft.com/en-us/library/windows/apps/windows.security.cryptography.core.cryptographicengine.derivekeymaterial.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.security.cryptography.core.cryptographicengine.derivekeymaterial.aspx)了解使用多种算法派生密钥材料的方法。

# objective-c - 如何将 iOS 地图嵌入 UINavigationController

> ID：12790461
> 
> 赞同：2
> 
> 时间：2012-10-08T22:38:01.460
> 
> 标签：objective-c, uinavigationcontroller, mapkit, ios6

你们中有人知道如何将新地图嵌入到导航中吗？我们有一个包含以下代码的应用程序——它调用谷歌地图在地图中显示开始和结束地址。

```
NSURL *mapURL = [NSURL URLWithString:some_url_string];
[webview loadRequest:[NSURLRequest requestWithURL:mapURL]];

UIViewController *viewController = [[UIViewController alloc] init];
viewController.title = @"My Map Display";
[viewController.view addSubview:webview];

[self.navigationController pushViewController:viewController animated:YES]; 
```

我们有用于构建正确 url 的位置坐标。

上面的代码将新的 UIViewController/webview 推送到当前视图的 navigationController 中，以允许应用程序的用户使用后退按钮返回到我们的应用程序。

当用户需要新地图时，我们希望在运行 iOS 6 的设备上调用新地图 API。Apple 展示了新 API MKMapItem 的以下使用模式：

```
[MKMapItem openMapsWithItems:mapItems launchOptions:options]; 
```

然而，做事方式使地图呈现在我们的应用程序上——用户没有明显的方式从显示的地图返回到我们的应用程序。我们更喜欢 UINavigationController 中的地图，以便用户能够使用后退按钮从地图显示中返回。你们中有人知道我们如何将地图嵌入到导航控制器中吗？我们如何嵌入调用 [MKMapItem openMapsWithItems:] 生成的地图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T23:59:45.257

我认为您对当前的解决方案有些误解。根据您所说的用户永远不会离开您的应用程序，他们只是在 UIWebView 中查看 Google 地图。这`openMapsWithItems:mapItems:launchOptions:`实际上会打开 Maps 应用程序，因此您无法从 Maps 应用程序中提供返回您的应用程序的链接。

话虽如此，有几件事需要考虑。

1.  在地图应用程序中打开对用户来说非常有用，他们可以获得地图应用程序提供的所有好处，例如转弯路线和搜索
2.  让您的用户留在您的应用程序中是一种在地图视图上显示位置的非常快速且用户友好的方式

因此，考虑到这两个因素，我个人总是投票支持两者。在您的应用程序中提供一个简单的地图视图，以便他们可以快速查看地图上的位置，然后还为他们提供在地图应用程序中打开应用程序的选项，以便他们可以根据需要做更多的事情。

如果您选择这条路线，那么您需要做的是查看 MKMapView 类，而不是将您的 webview 添加为子视图，您将添加 MKMapView 作为子视图并将您的注释添加到 MKMapView。然后，一种常见的使用模式是允许用户触摸注释以调出带有按钮的“标注”，以便在地图应用程序中打开。

# r - 用现有数据替换向量中的缺失数据

> ID：12790462
> 
> 赞同：2
> 
> 时间：2012-10-08T22:38:02.607
> 
> 标签：r

我有一个向量（我实际上只是从数据框中检索了各个列），其中缺少数据。我想用向量中的下一个可用数据（或者如果下一个不可用，则为以前的数据）替换丢失的数据。例如，

```
data <- c(NA, NA, NA, NA, 5, NA, NA, 7, NA, NA) 
```

应该成为

```
data <- c(5, 5, 5, 5, 5, 7, 7, 7, 7, 7) 
```

我知道这是一种非常具体的填充缺失数据的方法，但我想知道是否有一个优雅的解决方案。我尝试使用`which(is.na(data))`来获取丢失的索引并`which(!is.na(data))`获取带有数据的索引，但是即使使用这两个索引列表来操作向量也需要很多混乱的逻辑。我想知道我是否`which`以任何方式滥用，或者是否有其他内置函数或包可以让我优雅地执行这个逻辑。

感谢您的帮助！

作为参考，只要向量不以一堆 NA 结尾，下面的代码就可以工作，但我必须添加更多逻辑才能使其与原始数据集一起工作。

```
data <- c(NA, NA, NA, NA, 5, NA, NA, 7)
missingIndeces <- which(is.na(data))
filledIndeces <- which(!is.na(data))
if(length(missingIndeces) > 1) {
    for(j in 1:length(data)) {
        temp <- data[j:length(data)]
        filledData <- which(!is.na(temp))
        if(filledData[1] > 1)
            data[j] <- temp[filledData[1]]
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-08T22:46:26.467

也许使用`na.locf`...？

```
library(zoo)
na.locf(na.locf(zoo(data),fromLast = TRUE,na.rm = FALSE),na.rm = FALSE)
 1  2  3  4  5  6  7  8  9 10 
 5  5  5  5  5  7  7  7  7  7 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-09-23T20:11:50.610

我想添加下一个使用`runner`r cran 包的解决方案。

```
library(runner)
> fill_run(data, run_for_first = T)
 [1] 5 5 5 5 5 5 5 7 7 7
> rev(fill_run(rev(data), run_for_first = T))
 [1] 5 5 5 5 5 7 7 7 7 7 
```

整个包都经过优化，主要是用cpp编写的。因此提供了很大的效率。

# html - 打印时裁剪的 HTML 页面

> ID：12790468
> 
> 赞同：2
> 
> 时间：2012-10-08T22:38:42.010
> 
> 标签：html, printing, crop

我有一个网站，我试图打印它，但它被裁剪了。只有 70% 的宽度显示在纸上。

如果我打印预览并将 scape 更改为 70%，那么它会打印整个页面而不进行裁剪。

但是，我如何使其默认自动缩放，因为我不希望在没有预览的情况下打印的访问者获得裁剪页面。

我尝试使用空白页和只有一个`<img />`标签（图像宽度 1400 像素），但它仍然被裁剪。这是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:09:49.370

我能想到的：您的打印机必须将网站转换为厘米/英寸。如果我们说你想用普通打印机（打印分辨率为72dpi）打印一张A4大小的纸，那么你可以打印总宽度为595px，高度为794px。如果您希望您的网站能够定期打印，我建议您为您的网站提供一个满足该要求的特殊“打印版本”——例如使用 CSS3 媒体类型：[http ://www.w3schools.com/css/css_mediatypes.asp](http://www.w3schools.com/css/css_mediatypes.asp)

# java - 如何缩放文本以适应容器？

> ID：12790472
> 
> 赞同：0
> 
> 时间：2012-10-08T22:39:20.577
> 
> 标签：java, swing, text, scaling

问题是：我有一个绘图区，可以显示图形（自定义绘图）。首次启动应用程序时，没有选择要绘制的图形，并且绘制区域设置为默认（首选）大小。为了不让用户感到困惑，我想显示一些文本（例如“未选择图像”），直到绘制真正的图形。绘图窗口包含在 JScrollPane 中，因此也可以调整其大小。有没有办法将文本（JLabel？）添加到绘图区域并让它自动缩放以填充绘图区域的范围？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T01:24:56.393

在根据您的需要调整标签的字体大小之后，您需要将 JLabel 添加到 JScrollPane 组件中。见下文：

```
jScrollPane1.setViewportView(jLabel1); 
```

[上一个问题](https://stackoverflow.com/questions/2715118/how-to-change-the-size-of-the-font-of-a-jlabel-to-take-the-maximum-size)中的第二个解决方案确实很好地说明了如何将字体大小缩放到容器......只需用您的 JScrollPane 替换字符串宽度。由于它是从 JComponent 继承的，因此您可以像这样使用 getWidth：

```
jScrollPane1.getWidth(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T06:03:51.627

请参阅链接[http://java-sl.com/tip_adapt_label_font_size.html](http://java-sl.com/tip_adapt_label_font_size.html)

`JLabel's`它显示了在调整大小时如何调整字体大小。

# c# - 数据库设计c#代码优先关系！不是多对多或一对多。别的东西

> ID：12790473
> 
> 赞同：0
> 
> 时间：2012-10-08T22:39:24.037
> 
> 标签：c#, database-design, ef-code-first

请看下面的图片。请注意，Job_History 和Employees 表的Employee_ID 是相同的。我如何首先在 c# 代码中表达这一点。这种关系叫什么？我认为是复合的....不确定。

![在此处输入图像描述](../Images/1db15f0dc9945fcc8d8b48880d5cbef1.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:43:25.773

它应该是一对多（employees.employee_Id 到 job_history.employee_id）。

1.  employees 表有一个主键employee_Id，
2.  job_history 表有一个复合主键employee_Id 和start_date。

# javascript - 根据 JS 确认框防止更新面板中的回发

> ID：12790475
> 
> 赞同：1
> 
> 时间：2012-10-08T22:39:35.833
> 
> 标签：javascript, jquery, asp.net

我有一个更新面板，其中包含一个 gridview 并在每行图像（删除图标）内删除该行。我正在尝试在常规 JavaScript 确认弹出窗口中给出答案。

```
$(function(){
    $("img.delete").on("click", function(evt){ 
        return false; //Does not work
        /*or*/
        evt.preventDefault();//Does not work either
    });
}); 
```

呈现的 HTML：

```
 <td>
        <img id="ctl00_ctl00_ctl00_ctl00_ctl00_ctl00_ContentPlaceHolderDefault_Content_Content_Content_Content_DashboardGrid_ctl02_DeleteControl140" class="delete" onclick="__doPostBack('ctl00$ctl00$ctl00$ctl00$ctl00$ctl00$ContentPlaceHolderDefault$Content$Content$Content$Content$DashboardGrid','Delete$0')" width="20" height="20" title="Remove item from your list." src="/images/delete_item.png" alt="Remove item from your list." style="border-width:0px;">
</td> 
```

它不起作用，因为回发总是由更新面板执行，该面板将其 UpdateMode 设置为默认值，因为我没有在标记中设置它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T16:48:27.630

[ThiefMaster](https://stackoverflow.com/users/298479/thiefmaster)提供的答案对我有用，在：[preventDefault() 不适](https://stackoverflow.com/questions/10432365/preventdefault-doesnt-work/10432386#10432386)用于我的案例的微小调整：

```
function pageLoad() 
{
  var inlineFunction = new Function($('img.delete').attr('onclick'));
  $('img.delete').click(function(event){
    if(!confirm('Are you sure?')) {
        event.stopImmediatePropagation();         
    }
  }).click(inlineFunction).removeAttr('onclick');
} 
```

pageLoad 事件在使用 updatepanel+scriptmanager 时可用，它允许我在每个部分回发时重新附加事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T01:38:22.193

上次我工作时，我的情况是回发被完全阻止了。情况是我将回发控件放置在 div 标签中，并使用 .live 事件将此类点击事件应用于该 div 标签。这阻止了回发。因此，将图像控件放在 div 元素中并对那个 div 执行相同的操作。但我不确定如何允许回发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T22:44:18.020

在这种情况下，请尝试`OnClientClick="return Delete()"`在您的标记中声明并检查页面是否仍在回发..

```
function Delete(){

   return false;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T01:05:25.620

`onclick="__doPostBack('controlId','Delete$0')"`无论您从`$("img.delete").click()`事件返回什么，看起来都有as an image 属性会导致页面回发。

您可以尝试`__doPostBack`从单击事件中调用该方法吗？这对我有用 - 我能够以这种方式控制回发。

展望未来，您可能必须`Page.ClientScript.GetPostBackEventReference`在 JavaScript 中使用和公开您的回发，以便您可以从事件处理程序中调用它们。

# facebook-oauth - 在新的浏览器窗口中显示 facebook 小登录对话框

> ID：12790477
> 
> 赞同：2
> 
> 时间：2012-10-08T22:39:47.423
> 
> 标签：facebook-oauth

起初是使用 Javascript SDK for facebook 来验证我的用户。现在我正在使用“Facebook C# SDK”。

我使用它没有问题，但一个真的很烦人。

如何让浏览器显示 javascript 调用的简洁的小登录对话框？

这是我的登录网址

```
("https://www.facebook.com/dialog/oauth/?client_id={0}&redirect_uri={1}&display={2}", 
```

mAppID，mRedirectUrl，“弹出”）；

我试过这个

```
 Response.Write("<script>window.open('" + url + "');</script>"); 
```

但是在我这样做之前浏览器会询问我的许可。javascript SDK在不需要我许可的情况下打开了一个窗口..

我应该怎么做才能让它在未经许可的情况下打开一个小的登录对话框

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T08:59:00.977

我想通了 - 诀窍是添加`display=popup`到您的 oAuth URL：

```
e.g. http://www.facebook.com/login?...&display=popup 
```

# ruby-on-rails - Rails：为什么我在提交表单后退出？（短的）

> ID：12790478
> 
> 赞同：0
> 
> 时间：2012-10-08T22:39:48.060
> 
> 标签：ruby-on-rails

我正在创建一个用于图片上传的应用程序。有用户、相册、图片。但是，当我登录并创建新专辑时，在重定向时它会出于某种原因将我注销。任何人都可以帮忙吗？

这是我的相册控制器创建操作

```
def create
  @user = User.find(params[:user_id])
  @album = @user.albums.build(params[:album])
  @album.users << @user.friends.find(params[:users][:friend_id])
  respond_to do |format|
    if @user.save
      format.html { redirect_to user_album_path(@user, @album), notice: 'Album was successfully created.' }
      format.json { render json: @album, status: :created, location: @album}
    else
      format.html { render action: "new" }
      format.json { render json: @album.errors, status: :unprocessable_entity }
    end
  end 
end 
```

配置/路由

```
Pholder::Application.routes.draw do
resources :users do
  resources :friends
  resources :albums do
    resources :photos
  end
end
end 
```

（不要认为这是必要的，但这里是专辑/new.html.erb 的表格，以防您想查看）

```
<%= form_for ([@user, @album]), :html => { :id => "uploadform", :multipart => true } do |f| %>
<div class="formholder">
    <%= f.label :name %>
    <%= f.text_field :name %>

    <%= collection_select(:users, :friend_id, @user.friends, :id, :name_with_initial, :multiple => true ) %>

    <%= f.label :description %>
    <%= f.text_area :description %>

    <br>

    <%=f.submit %>
</div>
<% end %> 
```

html生成的表格：

```
<form accept-charset="UTF-8" action="/users/27/albums" class="new_album" enctype="multipart/form-data" id="uploadform" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="cUx2AZc5Cxa+FZxtOWwHDZ8WSnvb4l9B2BqcWhXYmgg=" /></div>
<div class="formholder">
<label for="album_name">Name</label>
<input id="album_name" name="album[name]" size="30" type="text" />

<select id="users_friend_id" name="users[friend_id]"><option value="29">Ben</option>
<option value="30">Bally</option></select>

<label for="album_description">Description</label>
<textarea cols="40" id="album_description" name="album[description]" rows="20">
 </textarea>

<br>

<input name="commit" type="submit" value="Create Album" /> 
```

终端日志

```
Started POST "/users/27/albums" for 127.0.0.1 at 2012-10-08 18:51:11 -0400
Processing by AlbumsController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"cUx2AZc5Cxa+FZxtOWwHDZ8WSnvb4l9B2BqcWhXYmgg=", "album"=>{"name"=>"world tour", "description"=>"fadsjkafsdjk"}, "users"=>{"friend_id"=>"29"}, "commit"=>"Create Album", "user_id"=>"27"}
  User Load (0.1ms)  SELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT 1  [["id", "27"]]
  User Load (0.2ms)  SELECT "users".* FROM "users" INNER JOIN "friendships" ON "users"."id" = "friendships"."friend_id" WHERE "friendships"."user_id" = 27 AND "users"."id" = ? AND (status = 'accepted') LIMIT 1  [["id", "29"]]
   (0.0ms)  begin transaction
   (0.7ms)  UPDATE "users" SET "remember_token" = '0lIsogcOIkUMMWFbRWerjw', "updated_at" = '2012-10-08 22:51:11.476530' WHERE "users"."id" = 27
  SQL (0.2ms)  INSERT INTO "albums" ("created_at", "description", "name", "updated_at") VALUES (?, ?, ?, ?)  [["created_at", Mon, 08 Oct 2012 22:51:11 UTC +00:00], ["description", "fadsjkafsdjk"], ["name", "world tour"], ["updated_at", Mon, 08 Oct 2012 22:51:11 UTC +00:00]]
  SQL (0.2ms)  INSERT INTO "album_users" ("album_id", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)  [["album_id", 113], ["created_at", Mon, 08 Oct 2012 22:51:11 UTC +00:00], ["updated_at", Mon, 08 Oct 2012 22:51:11 UTC +00:00], ["user_id", 29]]
  SQL (0.2ms)  INSERT INTO "album_users" ("album_id", "created_at", "updated_at", "user_id") VALUES (?, ?, ?, ?)  [["album_id", 113], ["created_at", Mon, 08 Oct 2012 22:51:11 UTC +00:00], ["updated_at", Mon, 08 Oct 2012 22:51:11 UTC +00:00], ["user_id", 27]]
   (6.3ms)  commit transaction
Redirected to http://localhost:3000/users/27/albums/113 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T00:01:42.730

查看您的代码（链接在下面的评论中），这就是问题所在。保存相册时，您正在调用@user.save！这会触发用户模型中的 create_remember_token，从而导致注销。

这是您在相册控制器中调用 @user.save 的代码：

```
def create
  @user = User.find(params[:user_id])
  @album = @user.albums.build(params[:album])
  @album.users << @user.friends.find(params[:users][:friend_id])
  respond_to do |format|
    if @user.save 
```

这是用户模型中的 before_save：

```
class User < ActiveRecord::Base
  ....
  before_save :create_remember_token 
```

您可能希望消除 before_save，然后在用户登录时调用 create_remember_token。

# php - 如何编写查询代码以显示每个选定旅行房型、数量和总成本的汇总价格？

> ID：12790481
> 
> 赞同：3
> 
> 时间：2012-10-08T22:40:13.773
> 
> 标签：php, mysql, sql

在 Stackoverlflow 上慷慨的编码人员的大力帮助下，我一直在学习 PHP+MySQL，并且我的第一个功能数据库即将结束，但被卡住了。

我正在尝试建立一个数据库，其中用户为每个人或家庭（最多 12 人）选择房间类型。该表格的设置是为每个人分配一个房间类别（因为产品是按人而不是按房间出售的）。可用房型为 SGL、DBL（最多 2 人）、TPL（最多 3 人）和 QUD（最多 4 人）。

我有一个表格，其中包含每种房间类型的输入价格，称为 tourprices，这些价格根据旅行开始的日期在一个名为 tourstart 的单独表格中有所不同。

基本上，我想编写代码来查看为每个人选择的房间类型，查找相关的房间价格，计算每个房间类型的入住人数，乘以价格 x 房间类型数量（在旁边显示每人价格每个人）并总结所有房间的总费用。

*   **价格表**有行*“ID、日期、SGL、DBL、TPL、QUD”*
*   **客户表**有行*“ID、姓名、购买的旅游”*
*   **预订表**有行 *"Id, client_id, tour_id, tourdate_id, roomtype"*
*   **旅游表**有行 *“Tour_id，旅游名称，对销售开放/关闭”*
*   **旅游日期表**有行 *"Tourdate_id, tour_id, date1, date2, date3,... date25"*

**例如：** 旅游价格（每人）

*   2012 年 5 月 1 日巡演 - SGL=$300；DBL=150 美元；TPL=100 美元；QUD=75 美元
*   2012 年 10 月 1 日巡演 - SGL=$500；DBL=250 美元；TPL=166.67 美元；QUD=125 美元

用户想要预订 1 个 SGL、2 个 DBL、+ 1 个 TPL 用于 8 人的 1May2012 旅游。

因此，生成的确认显示应该类似于以下内容（以及通常的 HTML：“谢谢，您是最好的客户..blah，blah”，这已经很好了）：

*   人 1) SGL $300
*   人 2) DBL $150
*   人 3) DBL $150
*   人 4) DBL $150
*   人 5) DBL $150
*   人 6) TPL $100
*   人 7) TPL $100
*   人 8) TPL $100

总价 = 1x$300 + 4x$150 + 3x$100 + 0x$75 = $1200

我已经为系统设置了 html 表单以及插入查询部分，并且数据正在发布到数据库中。对于计算查询（预订确认页面），我已经得到：

```
$selectedDate = $tourstart
$query = "SELECT `sgl`, `dbl`, `tpl`, `qud` FROM tourprices WHERE `tour_id` = $tour AND `tourstart` = $tourstart";
$query .= "COUNT `sgl` as SglRmCount FROM `clients`";
$query .= "COUNT `dbl` as DblRmCount FROM `clients`";
$query .= "COUNT `tpl` as TplRmCount FROM `clients`";
$query .= "COUNT `qud` as QudRmCount FROM `clients`";
$result = $pdo->query($query);
?> 
```

*   a）我不确定这是否是最简洁的查询。
*   b) 就可以确定的而言，我的 SELECT 查询是否正确？
*   c）我如何将数学引入查询（或者这是在查询之外完成的？如果是，我该如何编码？）。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:02:28.113

您创建的查询将不起作用。计数未正确使用。Count 旨在从选择字段中返回一个数字，如下所示：

```
SELECT COUNT(`sgl`) FROM your_table WHERE your_value = 0; 
```

这将返回一个数字，该数字是返回的记录数的总和。以下是您创建的查询：

```
SELECT `sgl`, `dbl`, `tpl`, `qud` FROM tourprices WHERE `tour_id` = INPUTED_VALUE_FROM_PHP AND `tourstart` = YOUR_tourstart_VALUE COUNT `sgl` as SglRmCount FROM `clients` COUNT `dbl` as DblRmCount FROM `clients` COUNT `tpl` as TplRmCount FROM `clients`; 
```

此查询将不起作用，因为第一个计数未正确使用，其次因为您只能调用一个 FROM 是给定的查询。看起来您希望返回多个不相关的值。如果是这种情况，那么您可以为您需要的所有内容创建多个 SELECT 查询。

查询中的内联数学也是完全可能的，您几乎可以内联做任何事情。这是您可以做的一些基本数学的资源：http: [//www.keithjbrown.co.uk/vworks/mysql/mysql_p9.php](http://www.keithjbrown.co.uk/vworks/mysql/mysql_p9.php)

# c# - 在某些情况下，Stringbuilder 未写入 HttpContext.Current.Response.Write

> ID：12790482
> 
> 赞同：0
> 
> 时间：2012-10-08T22:40:23.140
> 
> 标签：c#, asp.net

我正在使用此函数循环两个文件类型的输入控件。

```
protected void btnUpload_Click(object sender, EventArgs e)
{
    HttpFileCollection hfc = Request.Files;
    int numFiles = hfc.Count;
    for (int i = 0; i < hfc.Count; i++)
    {
        HttpPostedFile hpf = hfc[i];
        string FilePath = hpf.FileName;
        CreateProgress(FilePath, i + 1, numFiles);
        Thread.Sleep(2000);
    }
} 
```

在这个阶段我对文件什么都不做，我只是想证明在上传每个文件后我可以在浏览器中写一些东西让用户知道文件正在被上传。函数 CreateProgress 是这样的：

```
public void CreateProgress(string FilePath, int i, int numFiles)

{
    StringBuilder sbProgress = new StringBuilder();
    string strTableId = "mainTable" + i;
    sbProgress.Append("<html><head><link rel=\"StyleSheet\" href=\"stylesheet/StyleSheet1.css\" type=\"text/css\" /></head><body>");
    sbProgress.Append("<table id=\"" + strTableId + "\" border=\"0\">");
    sbProgress.Append("<tr>"); 
    sbProgress.Append("<td>");
    sbProgress.Append("<p class=\"filey\">Uploading " + FilePath + " ..... file " + i.ToString() + " of " + numFiles.ToString() + "</p>");
    sbProgress.Append("</td>");
    sbProgress.Append("<td style=\"display:none\">");
    sbProgress.Append("</td>");
    sbProgress.Append("</tr>");
    sbProgress.Append("</table>");
    sbProgress.Append("</body></html>");
    HttpContext.Current.Response.Write(sbProgress.ToString());
    HttpContext.Current.Response.Flush();
} 
```

上面的代码每次都能完美运行。我点击上传文件并在屏幕上显示“上传 SomeFile.txt ... 文件 1 of 2” 2 秒，然后“上传 SomeOtherFile.txt ... 文件 2 of 2” 2 秒。

但是，您将在构建 StringBuilder 的代码中看到我正在构建一个包含一行和两个单元格的表。我不需要或使用该行中的第二个单元格，但是如果我通过注释掉这样的三行来删除它...

```
 public void CreateProgress(string FilePath, int i, int numFiles)

{
    StringBuilder sbProgress = new StringBuilder();
    string strTableId = "mainTable" + i;
    sbProgress.Append("<html><head><link rel=\"StyleSheet\" href=\"stylesheet/StyleSheet1.css\" type=\"text/css\" /></head><body>");
    sbProgress.Append("<table id=\"" + strTableId + "\" border=\"0\">");
    sbProgress.Append("<tr>"); 
    sbProgress.Append("<td>");
    sbProgress.Append("<p class=\"filey\">Uploading " + FilePath + " ..... file " + i.ToString() + " of " + numFiles.ToString() + "</p>");
    //sbProgress.Append("</td>");
    //sbProgress.Append("<td style=\"display:none\">");
    //sbProgress.Append("</td>");
    sbProgress.Append("</tr>");
    sbProgress.Append("</table>");
    sbProgress.Append("</body></html>");
    HttpContext.Current.Response.Write(sbProgress.ToString());
    HttpContext.Current.Response.Flush();
} 
```

...然后，当单击“上传”按钮时 - 一开始没有任何反应，然后屏幕上显示第二条消息（上传文件 2 of 2）。为什么在地球上注释掉三行以便不创建行中的第二个单元格会导致它停止正常工作？

事实上，如果我保留 3 行并从 td 标记中删除 'style="display:none"' - 它无法正常工作。把 style="display:none" 放回去，它工作正常。

实际上，我根本不想真正创建一个表。我试过删除很多并简单地这样做：

```
 StringBuilder sbProgress = new StringBuilder();
    sbProgress.Append("<html><head><link rel=\"StyleSheet\" href=\"stylesheet/StyleSheet1.css\" type=\"text/css\" /></head><body>");
    sbProgress.Append("<p class=\"filey\">Uploading " + FilePath + " ..... file " + i.ToString() + " of " + numFiles.ToString() + "</p>");
    sbProgress.Append("</body></html>");
    HttpContext.Current.Response.Write(sbProgress.ToString());
    HttpContext.Current.Response.Flush();
} 
```

但这也不起作用。第一条消息“上传文件 1 的 2”没有出现，但第二条消息（“上传文件 2 的 2”）确实出现。

有任何想法吗？我想成为一名出租车司机。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:43:13.987

基本上，您在这里与 HTTP 的请求/响应性质作斗争。如果您在初始请求中生成某种“操作标识符”并将其提供给客户端，您会做得更好。然后写一些Javascript来轮询操作的进度，每次都传入操作标识符。这样你就可以拥有一系列*完整*的请求/响应对，而不是依赖于浏览器如何处理尚未完成的响应。

（您可以使用长轮询而不是常规定时轮询，仅在每个部分完成时返回，但您仍然具有相同的基本多请求设置。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:13:31.017

您实际上创建了格式错误的标记

```
//sbProgress.Append("</td>");
//sbProgress.Append("<td style=\"display:none\">");
//sbProgress.Append("</td>"); 
```

您应该已经注释了最后两行。第一行应该是上面它的结束标记。

本来应该

```
sbProgress.Append("<p class=\"filey\">Uploading " + FilePath + " ..... file " + i.ToString() + " of " + numFiles.ToString() + "</p>");
sbProgress.Append("</td>");
//sbProgress.Append("<td style=\"display:none\">");
//sbProgress.Append("</td>");
sbProgress.Append("</tr>"); 
```

# android - oncheckedlistener 破坏代码 android

> ID：12790489
> 
> 赞同：1
> 
> 时间：2012-10-08T22:41:25.700
> 
> 标签：android, checkbox

我关注了这个线程： [OnCheckChanged 侦听器仅适用于 customlistview 中的第一个复选框](https://stackoverflow.com/questions/9306726/the-oncheckchanged-listener-works-only-for-the-first-checkbox-in-a-customlistvie)

用于为我的 android 应用程序中的 CheckBox 编写 onCheckedListener() 代码。上面的链接有listview，在我的例子中我有一个gridview。

我目前的代码是：

```
public View getView(int position, View convertView, ViewGroup parent)
{
    ViewHolder holder;
    ImageView imgView = null;

        if (convertView == null) {

            holder = new ViewHolder(); 
            LayoutInflater ltInflate = (LayoutInflater) context.getSystemService( Context.LAYOUT_INFLATER_SERVICE ); 
            convertView = ltInflate.inflate(R.layout.griditem, null);

            holder.textview1 = (TextView) convertView.findViewById(R.id.grid_item_alert_date);
            holder.textview2 = (TextView) convertView.findViewById(R.id.grid_item_alert_time);
            holder.textview3 = (TextView) convertView.findViewById(R.id.grid_item_alert_type);

            holder.imageview    = (ImageView) convertView.findViewById(R.id.grid_item_image);
            holder.checkbox = (CheckBox) convertView.findViewById(R.id.checkbox_ack);
            convertView.setTag(holder);

        }
        else
        {   
            holder = (ViewHolder) convertView.getTag();
        }

        holder.checkbox.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {

              @Override
              public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
                 // TODO Auto-generated method stub
                  Toast.makeText(context, " checkbox checked", Toast.LENGTH_SHORT).show();

              } });

        holder.textview1.setId(position);
        holder.textview2.setId(position);
        holder.textview3.setId(position);
        holder.imageview.setId(position);
        holder.checkbox.setId(position);

        holder.textview1.setText("Text 1 ");
        holder.textview2.setText("Text 2 ");
        holder.textview3.setText("Text 3 ");
        holder.checkbox.setChecked(false);
        holder.imageview.setImageBitmap(bitmap);
        holder.id = position;

        return convertView; 
```

}

当我选中我的应用程序崩溃的复选框时，我想知道为什么？

* * *

更新：这是选中复选框后的 logcat 输出：

```
10-08 23:01:54.777: I/inh(1950): Item loaded: /images/img1.jpg
10-08 23:02:03.538: D/AndroidRuntime(1950): Shutting down VM
10-08 23:02:03.538: W/dalvikvm(1950): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
10-08 23:02:03.557: E/AndroidRuntime(1950): FATAL EXCEPTION: main
10-08 23:02:03.557: E/AndroidRuntime(1950): java.lang.IllegalStateException: Could not find a method onCheckboxClicked(View) in the activity class com.exp.ir.client.ImageGraph for onClick handler on view class android.widget.CheckBox with id 'checkbox_ack'
10-08 23:02:03.557: E/AndroidRuntime(1950):     at android.view.View$1.onClick(View.java:3578)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at android.view.View.performClick(View.java:4084)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at android.widget.CompoundButton.performClick(CompoundButton.java:100)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at android.view.View$PerformClick.run(View.java:16966)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at android.os.Handler.handleCallback(Handler.java:615)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at android.os.Handler.dispatchMessage(Handler.java:92)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at android.os.Looper.loop(Looper.java:137)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at android.app.ActivityThread.main(ActivityThread.java:4745)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at java.lang.reflect.Method.invokeNative(Native Method)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at java.lang.reflect.Method.invoke(Method.java:511)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at dalvik.system.NativeStart.main(Native Method)
10-08 23:02:03.557: E/AndroidRuntime(1950): Caused by: java.lang.NoSuchMethodException: onCheckboxClicked [class android.view.View]
10-08 23:02:03.557: E/AndroidRuntime(1950):     at java.lang.Class.getConstructorOrMethod(Class.java:460)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at java.lang.Class.getMethod(Class.java:915)
10-08 23:02:03.557: E/AndroidRuntime(1950):     at android.view.View$1.onClick(View.java:3571)
10-08 23:02:03.557: E/AndroidRuntime(1950):     ... 12 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T23:12:01.227

好的，所以我在定义复选框的 layout.xml 中发现了问题我添加了这行导致找不到事件处理程序

android:onClick="onCheckboxClicked"

删除了这个，代码现在可以正常工作。

感谢 Sam 和其他人的观看。

# ios - Magical Record 的新手：上下文未在数据存储中创建行

> ID：12790490
> 
> 赞同：0
> 
> 时间：2012-10-08T22:41:36.583
> 
> 标签：ios, core-data, magicalrecord

我有一个基于 Core Data 的应用程序，我决定尝试使用 Magical Record。（基本上 MR 似乎做了很多我写的助手类所做的事情）

但是，它基于模型创建了数据库，但是当我尝试使用新插入的对象保存上下文时，它似乎成功了，但在数据库中没有创建任何内容。我已经逐步确保新对象在即将保存的上下文中，我告诉它保存，没有创建错误，但没有数据。我认为我在这里缺少一些明显的东西。

```
- (void)saveContext:(NSManagedObjectContext*)context withMessage:(NSString*)messageString
{
    NSError *error = nil;
    NSString *message = messageString;
    NSManagedObjectContext *managedObjectContext = nil;
    if (!context) {
        managedObjectContext = [NSManagedObjectContext defaultContext];
    } else {
        managedObjectContext = context;
    }
    if(!message) {
        message = @"Data Saved";
    }
    if ([managedObjectContext hasChanges]) {
        [managedObjectContext save:&error];
        if (error) {
            NSLog(@"Save Error: %@", [error localizedDescription]);
        }
        else {
            UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Save Successful!"
                                                            message:message
                                                           delegate:nil
                                                  cancelButtonTitle:@"OK"
                                                  otherButtonTitles:nil];
            [alert show];
        }
    }
} 
```

有什么见解吗？正如我所提到的，我可以确认堆栈已设置（我在 App Delegate 的 applicationDidFinishLoading 方法中进行了设置，并命名了商店），并且相应的数据库存在于预期的位置，并带有适当的表。我可以确认托管对象上下文的插入对象中存在预期的新插入对象，并且保存没有导致错误。但是，保存后，数据不存在。（显然也不是在 managedObjectContext 中）

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:04:58.550

我看不到您实际保存实体的位置，或对该代码中的实体进行更改。

同样值得注意的是，您在该代码中做了太多工作。您可能想做更多类似的事情：

```
- (void) saveMyEntity:(NSObject<NSManagedObject *>) yourEntity;
{
    [MagicalRecord saveWithBlock:^(NSManagedObjectContext *localContext){

        yourEntity.message = @"something new";

    } completion:^{
        <UIAlert stuff here>
    }];
} 
```

MagicalRecord 提供了一个易于使用的 API，它隐藏了很多乏味的记忆如何保存数据等。阅读 README 文件可能很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T14:21:40.743

好的，我仍然不知道我的代码出了什么问题，但不使用 NSManagedObjectContext 的保存方法似乎有效。相反，我这样做了：

```
- (void)saveContextWithMessage:(NSString*)messageString
{
    NSString *message = messageString;
    if (!message) {
        message = @"Data Saved";
    }
    [MagicalRecord saveInBackgroundWithBlock:^(NSManagedObjectContext* localContext){}
                                  completion:^{
                                  UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Save Successful!"
                                                                                  message:message
                                                                                 delegate:nil
                                                                        cancelButtonTitle:@"OK"
                                                                        otherButtonTitles:nil];
                                  [alert show];
    }];
} 
```

如前所述，我正在用 MR 为我做的代码做事，所以我删除了它以使其更清晰。

# mysql - 有没有办法在没有第二次查询的情况下执行此条件 JOIN？

> ID：12790492
> 
> 赞同：1
> 
> 时间：2012-10-08T22:41:38.747
> 
> 标签：mysql, sql

这是我的查询：

```
SELECT *
FROM `messages` m
JOIN questions q ON m.question_response = q.question_id 
WHERE m.message_id = '$message_id' 
```

问题是 JOIN 并不总是需要，只有在`m.question_response`is not的值时才需要`0`。有没有办法在这种情况下进行 JOIN 而不求助于第二个查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:51:00.397

我相信您可以在多种条件下加入，并且它们可以是静态的。

```
SELECT *
FROM `messages` m
JOIN questions q 
    ON m.question_response = q.question_id 
    AND m.question_response <> 0
WHERE m.message_id = '$message_id' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:05:35.053

```
SELECT m.*
FROM `messages` m,`questions` q 
WHERE m.message_id = '$message_id' 
   AND m.question_response = 0 
   OR (m.question_response <> 0 AND m.question_response = q.question_id) 
```

# javascript - 在rails中将用户图像添加到jquery ui自动完成

> ID：12790496
> 
> 赞同：0
> 
> 时间：2012-10-08T22:42:01.820
> 
> 标签：javascript, ruby-on-rails-3, jquery-ui, jquery-autocomplete

我刚刚成功地将 jquery ui 自动完成小部件添加到我的 rails 应用程序中的搜索功能，它工作正常:)。这是我的代码

javascript

```
 <script type="text/javascript">
  jQuery(document).ready(function($) {

$('#search').autocomplete({
 minLength: 1,
 source: "<%= list_path(:json) %>",

 focus: function(event, ui){
   $('#search').val(ui.item.user_name);
   return false;
 },
 select: function(event, ui){
 $('#search').val(ui.item.user_name);
 return false;
 }
})

.data("autocomplete")._renderItem = function(ul,item){
  return $("<li></li>")
  .data("item.autocomplete",item)
  .append("<a>" + item.first_name + " " + item.last_name + "<br>" + item.user_name  +  "</a>" )
  .appendTo(ul);
};

}); 
```

控制器动作

```
 def list
 list = []
 @user = User.where("user_name LIKE ? or first_name LIKE ? or last_name LIKE ?",   "#{params[:term]}%" , "#{params[:term]}%" , "#{params[:term]}%")
@user.each{|user| list << user}

respond_to do |format|
format.json { render :json => list.to_json,:layout=>false }
end
end 
```

所以基本上 javascript 在搜索框中键入每个字母后调用该操作，然后将结果附加到 html 视图中。

但我想添加更多内容，不仅包括名字、姓氏和用户名，还包括用户名

我尝试使用返回的结果从 javascript 内部获取图像，例如

```
 <script>
      .
      .
      .
     // somwhere inside my javascript code
     var id = item.id
   <% @image= UserImage.find(:first,:conditions=>["user_id=?",id]) %>
      .
      .
    </script> 
```

然后我尝试将图像与用户名、名字等一起附加，例如

```
 <script>
           .
           . 
           .
        .append("<a>"+ <%=image_tag(@image.image.url(:thumb))%> + " " + tem.first_name + " " + item.last_name + "<br>" + item.user_name + "</a>" )
         <script> 
```

但它没有用......叹息

我想知道我是否可以以某种方式在 json 中添加图像路径（来自我的控制器），然后将其附加到 javascript 文件中

请帮助:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:41:08.707

你必须改变几个文件

```
# controller
def list
  @users = User.where("user_name LIKE :q or first_name LIKE :q or last_name LIKE :q", { q: "#{params[:term]}%")

  respond_to do |format|
    format.json { render json: @users.as_json(only: [:first_name, :last_name, :user_name], methods: [:avatar_url] }
  end
end

# user.rb
def avatar_url
  user_image.image.url :thumb
end

# js
.data("autocomplete")._renderItem = function(ul,item){
  return $("<li></li>")
    .data("item.autocomplete",item)
    .append("<a>" + item.first_name + " " + item.last_name + "<br>" + item.user_name  +  "</a>" )
    .append("<img src='" + item.avatar_url + "'>")
    .appendTo(ul);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:33:00.657

我尝试使用回形针为用户存储图像我得到了这个：

```
 jQuery(document).ready(function($) {
  $('#user_name').autocomplete({
   minLength: 1,
   source: "<%= users_path(:json) %>",

   focus: function(event, ui){
    $('#user_name').val(ui.item.name);
    return false;
   },
   select: function(event, ui){
    $('#user_name').val(ui.item.name);
    return false;
   }
  })

  .data("autocomplete")._renderItem = function(ul,item){
   return $("<li></li>")
  .data("item.autocomplete",item)
  .append("<a>"+"<img src='" + item.avatar_url +"'>"  + item.first_name + " " + item.last_name + "<br>" + item.name  +  "</a>" )
  .appendTo(ul);
  };
}); 
```

用户.rb

```
def self.search (search_name)
 return scoped unless search_name.present?
  where(['name LIKE ? or first_name LIKE ? or last_name LIKE ?', "%#{search_name}%", "%#{search_name}%",  "%#{search_name}%"])
end
def avatar_url
 self.avatar.url :thumb
end 
```

users_controller.rb

```
def index
if params[:name]
  @users = User.search(params[:name])
else
  @users = User.all
end
respond_to do |format|
  format.html # index.html.erb
  format.json { render json: @users.as_json(only: [:first_name, :last_name, :name], methods: [:avatar_url] )}
end 
```

结尾

这里是完整的代码：[https ://github.com/senayar/autocompletion_image_paperclip](https://github.com/senayar/autocompletion_image_paperclip)

根据jvnill编辑

# r - 用于绘图的 mclapply 与 for 循环：速度和可扩展性焦点

> ID：12790504
> 
> 赞同：2
> 
> 时间：2012-10-08T22:42:24.210
> 
> 标签：r, for-loop, foreach, ggplot2, mclapply

我在 R 中运行一个函数，该函数可能需要很长时间才能运行，因为它执行多个命令来转换和子集一些数据，然后再将其推入`ggplot`绘图。我需要多次运行此函数来调整参数值。我将提供的示例很简单……但想知道如何加快速度？如果按比例放大，即获得每个组合的最快方法是什么...是否有一种通用方法可以将`for`循环转换为`mclapply`假设它们更快...请随时提供替代模拟示例来证明对特定方法的偏好

*模拟示例：*

基本功能：

```
ff <- function(n, mu, stdev){
     x1 <- c(1:n)
     y1 <- rnorm(n,mu,stdev)
     z1 <- data.frame(cbind(x1,y1))
     ggplot(z1, aes(x=x1,y=y1))+
       geom_point()+
       labs(title=paste("n=",n,"mu=",mu, "stdev=",stdev))
} 
```

所以通过参数的方法是执行以下操作......

```
for(i in 1:10){
    for(j in 1:2){
       for(k in seq(100,500,by=100)){
         ff(k,i,j)
       }
    }
} 
```

加快速度的最快方法是什么？我假设它可能需要类似`expand.grid(x=c(1:10),y=c(1:2),z=seq(100,500,by=100))`的东西和使用`mclapply`来遍历每一行......以某种并行方式？（我有 4 个内核可用于此）。请根据可以最大程度提高速度的方法，随意从基本功能中提取一些内容或将内容放入基本功能中。如果您增加每个参数的范围，该过程显然会花费更长的时间，但是对此没有什么可以做的......或者如果拆分更多核心或其他东西，也可以以某种方式改变......？

并且对于奖励积分...是否有任何东西可以保存输出图像并创建像包`manipulate`中一样的滑块以交互方式遍历所有参数...它所做的只是拉出相关图像，而不是而不是每次都重新计算。

注意请随意使用/建议`foreach`您认为可能对您的解决方案有用的任何其他软件包（如 ）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:59:05.973

如果使用`mclapply`，将参数组合成一个列表并将其传递给函数，而不是使用 for 循环。

例如

```
df <- expand.grid(i = 1:10, j = 1:2 , k = seq(100, 500, 100))
params <- mapply(list, n = df[, 3], mu = df[, 1], stdev = df[,2], SIMPLIFY = F)

ff <- function(tlist) {
    n <- tlist$n 
    mu <- tlist$mu 
    stdev <- tlist$stdev
     x1 <- c(1:n)
     y1 <- rnorm(n,mu,stdev)
     z1 <- data.frame(cbind(x1,y1))
     ggplot(z1, aes(x=x1,y=y1))+
       geom_point()+
       labs(title=paste("n=",n,"mu=",mu, "stdev=",stdev))
}

results <- llply(params, ff, .progress='text') 
```

如果使用`mclapply`

```
results <- mclapply(params, ff, mc.cores = 4, mc.preschedule = TRUE) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:00:41.670

保存输出图像非常容易。只需调用`ggsave()`您的`ff()`函数。

```
ff <- function(n, mu, stdev){
  x1 <- c(1:n)
  y1 <- rnorm(n,mu,stdev)
  z1 <- data.frame(cbind(x1,y1))
  ggplot(z1, aes(x=x1,y=y1))+
    geom_point()+
    labs(title=paste("n=",n,"mu=",mu, "stdev=",stdev))
  ggsave(paste0(n,"_", mu, "_", stdev, ".jpeg"))
} 
```

您对使用`expand.grid()`. 这是我要做的：

```
x <- expand.grid(i = 1:10, j = 1:2, k = seq(100,500,100)) 
```

然后调用它，我会使用`lapply()`或者`mclapply()`如果你在 Linux 上并且有多个内核可用：

```
lapply(seq(nrow(x)), function(i) ff(x[i,2], x[i,1], x[i,3])) 
```

这将创建 100 个具有“n_mu_stdev.jpeg”命名约定的 jpeg。至于访问这些并在屏幕上呈现它们的有效方法，我会研究一个 Web 浏览器和一些简单的 CSS 和 jQuery 来使其变得简单。尽管恕我直言，这确实是一个单独的问题。

# c++ - 设置运算的浮点精度

> ID：12790508
> 
> 赞同：0
> 
> 时间：2012-10-08T22:42:46.937
> 
> 标签：c++, floating-point

我正在寻找一种方法来强制计算机计算具有一组有效数字的浮点运算。这是出于纯粹的学习原因，所以我不在乎结果的准确性损失。

例如，如果我有：

```
float a = 1.67;
float b = 10.0;
float c = 0.01

float d = a * b + c; 
```

我希望每个数字都用 3 个有效数字表示，我想看看：

```
d = 16.7; 
```

不是：

```
d = 16.71; 
```

到目前为止，我得到了一个可能的答案：[限制浮点精度？](https://stackoverflow.com/questions/3383817/limit-floating-point-precision)

但是使用该策略将每个浮点变量转换为一个具有我想要的精度的代码会使我的代码膨胀。然后对结果做同样的事情。

有没有一种自动的方法来修复精度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:54:48.500

浮点数据类型是二进制浮点数，即它们在二进制数字方面具有精度，实际上一般不可能精确地表示十进制值。因此，首先将操作截断到正确的小数位数时会遇到一些问题。`n`可行的方法是在每次操作后以数字精度（例如 with ）格式化浮点值，`n == 3`并将其转换回浮点值。这不会特别有效，但会起作用。为了避免使用相应的截断逻辑乱扔代码，您可以将所需的操作封装到一个类中，该类执行操作并适当地截断结果。

或者，您可以使用有效数和合适的以 10 为底的指数来实现必要的逻辑。显着性将被限制在 -999 和 999 之间的值。实现这样的类可能需要更多的工作，但结果可能更有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:28:03.517

> 到目前为止，我得到了一个可能的答案：[限制浮点精度？](https://stackoverflow.com/questions/3383817/limit-floating-point-precision)

阅读第二个答案，获得了 10 票，而不是仅获得 4 票的接受的答案。*不要这样做。*

*当您在纸上*进行计算时，您不想这样做，更不用说在计算机上。这些中间计算最好比基础数据显示的至少一个额外的有效数字，最好是两个或更多。您截断到最后数据指示的精度。我们在纸上这样做的唯一原因是人们不擅长处理大量数字。这是一种短路操作，可根据人们的计算方式（或错误计算方式）进行调整。

All that you are doing by rounding intermediate calculations accomplishes is to create an opening for errors to creep in and slowing the computer down, oftentimes by a quite a bit. Don't worry about the extra precision in those intermediate results. Simply use display the results to the desired precision on output.

The opposite problem sometimes does apply. You may need to worry about loss of precision in your intermediate results. Sometimes that loss of precision will mean changing from floats to doubles, or from doubles to variable precision arithmetic (which is *slow*).

# twitter - 如何确定一条推文包含带有 twitter api 的视频链接？

> ID：12790509
> 
> 赞同：0
> 
> 时间：2012-10-08T22:42:48.717
> 
> 标签：twitter

我正在使用 twitter api 拉回用户的推文。然后我想循环浏览推文，如果推文包含视频（例如指向 youtube vid 的链接），我想在我的页面中显示视频。问题是，在调用 user_timelime REST 函数以确定推文包含视频链接时，推特 API 返回的 JSON 中似乎没有任何内容。我知道我可以扫描传回的网址以查找“youtube”这个词，但我希望它能够扩展到用户插入包含视频的链接的任何网站。

我可能在 JSON twitter 回馈中遗漏了一些东西，但我不确定。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T17:46:52.910

请参阅此链接[https://dev.twitter.com/overview/api/entities-in-twitter-objects#extended_entities](https://dev.twitter.com/overview/api/entities-in-twitter-objects#extended_entities)

Twitter API 提供推文中包含的媒体文件的所有 URL

# c# - 从列表格式以表格格式显示工资历史记录？

> ID：12790511
> 
> 赞同：0
> 
> 时间：2012-10-08T22:42:56.117
> 
> 标签：c#, tsql, sql-server-2000, pivot

我敢肯定这对于 SQL 的铁杆极客来说不是一个难题，但我需要一些帮助。这适用于 SQL Server 2000（继承的项目！）。

我有一张薪水清单，如下所示：

```
EmployeeID  |  EffectiveDate  | Salary
1           |   2/1/2011      | 500
1           |   6/1/2011      | 600
1           |   12/1/2011     | 650 
```

我需要创建一个查询，将在给定年份按月输出这些薪水。所以输出就像

```
EmployeeID  | Jan | Feb | Mar | Apr | Apr | May | Jun | Jul | Aug | Sept | Oct | Nov | Dec
1           | 500 | 500 | 500 | 500 | 500 | 500 | 600 | 600 | 600 | 600  | 600 | 600 | 650 
```

我知道必须有一种方法可以使用 SQL 有效地做到这一点，但我似乎无法做到这一点。显然，我会用 SQL 命名上面的月份列，例如 SELECT EmployeeID、'Jan' AS Jan、'Feb' AS Feb 等，但由于我正在寻找范围，因此语句的其余部分更难。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T23:26:42.803

由于您使用的是 SQL Server 2000，它没有`PIVOT`函数，因此您必须使用聚合函数和`CASE`语句来复制它。与此类似：

```
select  employeeid,
  sum(case when DatePart(Month, EffectiveDate) = 1 then Salary end) as Jan,
  sum(case when DatePart(Month, EffectiveDate) = 2 then Salary end) as Feb,
  sum(case when DatePart(Month, EffectiveDate) = 3 then Salary end) as Mar,
  sum(case when DatePart(Month, EffectiveDate) = 4 then Salary end) as Apr,
  sum(case when DatePart(Month, EffectiveDate) = 5 then Salary end) as May,
  sum(case when DatePart(Month, EffectiveDate) = 6 then Salary end) as Jun,
  sum(case when DatePart(Month, EffectiveDate) = 7 then Salary end) as Jul,
  sum(case when DatePart(Month, EffectiveDate) = 8 then Salary end) as Aug,
  sum(case when DatePart(Month, EffectiveDate) = 9 then Salary end) as Sep,
  sum(case when DatePart(Month, EffectiveDate) = 10 then Salary end) as Oct,
  sum(case when DatePart(Month, EffectiveDate) = 11 then Salary end) as Nov,
  sum(case when DatePart(Month, EffectiveDate) = 12 then Salary end) as Dec
from  yourtable
group by employeeid 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/61ed5/2)

编辑，根据您上面的评论将价值从一个月转移到下一个月，这里有一个可能对您有用的解决方案。

```
declare @query as nvarchar(max) = '',
  @rowcount as int = 1,
  @pivotrow as int,
  @currentMonthSalary as int = 0,
  @priorMonthSalary as int = 0,
  @employeeid int 

select distinct effectivedate
into #colspivot
from yourtable

while @rowcount <= 12 -- loop thru each month
  begin

    set @pivotrow = (select top 1 datepart(month, effectivedate)
                        from #colspivot
                        order by datepart(month, effectivedate))

    select @currentMonthSalary = salary, @employeeid = EmployeeID
            from yourtable
            where datepart(month, effectivedate) = @pivotrow

    if @pivotrow = @rowcount
        begin
            insert into FinalData (employeeid, effectivemonth, salary)
            select @employeeid, cast(DateName(month, DateAdd(month, @pivotrow, 0) -1) as varchar(3)), @currentMonthSalary

            set @query = @query + ', sum(case when effectivemonth = ''' +  cast(DateName(month, DateAdd(month, @pivotrow, 0) -1) as varchar(3)) + ''' 
                                        then ' + cast(@currentMonthSalary as varchar(10)) + ' end) as '+ cast(DateName(month, DateAdd(month, @pivotrow, 0) -1) as varchar(3))

            delete from #colsPivot where datepart(month, effectivedate) = @pivotRow

            set @priorMonthSalary = @currentMonthSalary
        end
    else
        begin
            insert into FinalData (employeeid, effectivemonth, salary)
            select @employeeid, cast(DateName(month, DateAdd(month, @rowcount, 0) -1) as varchar(3)), @priorMonthSalary

            set @query = @query + ', sum(case when effectivemonth = ''' + cast(DateName(month, DateAdd(month, @rowcount, 0) -1) as varchar(3)) + '''  
                        then ' +  cast(@priorMonthSalary as varchar(10)) + ' end) as '+cast(DateName(month, DateAdd(month, @rowcount, 0) -1) as varchar(3))
        end

    if @rowcount <= 12
      set @rowcount = @rowcount + 1
  end

set @query = 'select employeeid '+ @query 
              + ' from FinalData group by employeeid;'

exec(@query) 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/ca5b5/1)。我创建了一个新表`FinalData`来存储每个月的数据，同时循环创建 sql 语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T06:15:56.147

试试这个查询：

```
Select  EmployeeID, [Jan],[Feb],[Mar],[Apr],[May],[Jun],[Jul],[Aug],[Sep],[Oct],[Nov],[Dec]
From
(
    Select EmployeeID, CAST(DateName(MONTH,EffectiveDate) as varchar(3)) as Mon, Salary
        From Employees

) as SourceTable

PIVOT
(
    Sum(Salary)
    For Mon in ( [Jan],[Feb],[Mar],[Apr],[May],[Jun],[Jul],[Aug],[Sep],[Oct],[Nov],[Dec] )
) as PivotTable 
```

它产生的结果与您在输出样本中显示的结果完全相同。

# server-side-includes - 防止刷新 SSI

> ID：12790519
> 
> 赞同：1
> 
> 时间：2012-10-08T22:43:29.470
> 
> 标签：server-side-includes

我有一些 SSI 在我的站点内的许多页面中重复 - 特别是我的导航树，它允许用户展开或折叠树中的节点。

我想阻止加载相同的 .shtml 文件，如果它已经在前一页中加载 - 这样当用户点击我的导航树中的一个条目时，整个树不会刷新到目标页面（这会导致用户的当前节点被折叠）。关于如何实现这一点的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:13:29.290

一种方法是将导航树放在单独的框架中（而不是 iframe），这会带来其自身的问题；由于包含发生在服务器端，因此包含的内容中导致页面刷新的任何内容都将刷新整个页面，而不考虑通过 SSI 包含的内容和未包含的内容。将树放在自己的框架中，并将其链接修改为指向内容框架，您就不会有这个问题——当然，使用框架来解决这个问题只会给您带来另一个问题。

更好的选择是使用 cookie 和 Javascript 来记录树的哪些节点被扩展。您可以将单击处理程序绑定到每个节点扩展器/收缩器，该处理程序将更新表示树状态的 Javascript 对象，并且在每个单击事件中，将该对象展平为字符串并通过 document.cookie 存储。这样，您可以将树状态保存到下一个页面加载中，其中 onload 处理程序可以展开 cookie 中列出的节点以将树返回到单击页面重新加载链接时的状态。

假设存在 jQuery（具有原生 JSON 支持的浏览器或加载的等效库），您的节点扩展器/收缩器控件被实现为具有类“node-control”的 <a> 标记，那么这样的事情可能会起作用，即控件对于扩展节点具有“扩展”类（可能由预先存在的单击处理程序给出），并且每个节点都有一个 id 属性，该属性唯一地标识其在树中的位置。

```
 // begin "persistent-node-state.js"

 window.nodesExpanded = {};

 // do the following on document load completion: 
 jQuery(document).ready(function() {
   // check for a nodesExpanded value in the cookie
   var cookieMatch = document.cookie.match(/nodesExpanded=(.*?)\;/);
   if (cookieMatch) { // no nodesExpanded cookie found -- do nothing
     // we found a nodesExpanded cookie; let's unserialize its value into
     // window.nodesExpanded
     window.nodesExpanded = JSON.parse(cookieMatch[1]);
   };

   // iterate through the nodesExpanded object's keys, which are IDs of controls whose
   // nodes we want to expand (if we didn't find a cookie, then window.nodesExpanded 
   // is an empty object, making this loop a very complicated no-op)
   for (node_id in nodesExpanded) {
     // call the pre-existing click handler to expand the node
     jQuery('a.node_control#' + node_id).click();
   };

   // now that that's done, give each node control an additional click handler which 
   // puts its state into window.nodesExpanded and updates the cookie
   jQuery('a.node-control').click(function(i,el) {
     var node_id = jQuery(el).attr('id');

     // if this control's node is expanded...
     if (jQuery(el).hasClass('expanded')) {
       // ...then add the control's id as a key in window.nodesExpanded...
       window.nodesExpanded[node_id] = true;
     }
     else {
       // ...otherwise remove any existing key in window.nodesExpanded with this 
       // node's ID
       window.nodesExpanded[node_id] = undefined;
     };

     // store the updated state in the cookie so it'll persist across page loads
     document.cookie('nodesExpanded=' + JSON.stringify(window.nodesExpanded));
   });
 });

 // end "persistent-node-state.js" 
```

当然，所有这些都可以在没有 jQuery 的情况下完成，但加载该库并不需要太多成本——你甚至不必下载它，而是可以[从 Google 的 CDN 加载它](https://developers.google.com/speed/libraries/devguide#jquery)——它让一切都可以做使用 Javascript 会容易得多，除非您需要支持非常旧的（例如 IE6 之前的）浏览器或具有一般性质的东西，否则没有很好的理由不这样做。

类似地，所有各种提示（即，如何识别节点扩展/收缩控件、如何判断它是否已扩展、如何触发导致节点扩展或收缩的事件等）都可以根据需要进行修改；在没有站点链接或一些示例代码的情况下，很难根据您的情况定制一个示例，所以我选择了尽可能通用的东西，同时仍然展示了基本想法，并且不应该太难编辑以品尝.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-23T22:39:53.857

服务器端包括服务器端。如果您在多个页面中有相同的包含文件，则每次都会包含它。Apache（或 IIS）将看到这一点。另一方面，如果在构建单个“页面”时，同一个文件包含在多个包含文件中，您可以在包含的文件中设置一个变量，并在文件包含的每个位置对其进行测试。我使用为我的站点设置全局变量的配置文件来做到这一点。

# ios - 如何接收异步任务完成的通知

> ID：12790525
> 
> 赞同：1
> 
> 时间：2012-10-08T22:43:56.207
> 
> 标签：ios, nsoperationqueue

我在 prepareForSegue 回调中有 NSOperationQueue 和 3 NSInvocationOperation ，我需要在完成所有异步任务后移动到另一个视图控制器。只有在移动到另一个屏幕之后，我才能收到关于完成所有异步任务的通知？

我试过这个没有成功：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

}); 
```

**编辑：**

似乎我不明白一些事情：

```
-(void)initPurchase{

    [operationQueue cancelAllOperations];

    NSInvocationOperation *downloadImageOperation = [[NSInvocationOperation alloc] initWithTarget:[BSImageDownloader getInstance] selector:@selector(downloadImageSync:) object:@"http://.........jpg"];

    NSInvocationOperation *createImageOperation = [[NSInvocationOperation alloc] initWithTarget:[BSImageCreator getInstance] selector:@selector(createImage:) object:@"dsadsadsa"];

    NSInvocationOperation *saveImageOperation = [[NSInvocationOperation alloc] initWithTarget:[BSImageSaver getInstance] selector:@selector(saveImageAsPng:) object:[BSSharedObject getInstance].createdImage];

    [createImageOperation addDependency:downloadImageOperation];
    [saveImageOperation addDependency:createImageOperation];

    [operationQueue addOperation:downloadImageOperation];
    [operationQueue addOperation:createImageOperation];
    [operationQueue addOperation:saveImageOperation];

}

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{

    [[BSPopupManager getInstance]showWaitingPopup];

    dispatch_group_t group = dispatch_group_create();

    dispatch_group_async(group, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), 
                         ^{
                             Purchase *purchase = [[Purchase alloc] init];
                             [purchase initPurchase];
                         });

    dispatch_group_notify(group, dispatch_get_main_queue(), ^{
        [[BSPopupManager getInstance] closeWaitingPopup];
        BSPurchaseViewController *purchaseViewController = [segue destinationViewController];
        purchaseViewController.pngImage = [BSSharedObject getInstance].createdImage;

 NSLog(@"2");
    });

    dispatch_release(group);

}
} 
```

我仍然得到 NSLog(@"2"); 早于我在第三个 NSInvocationOperation 中保存图像

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T22:50:16.737

`dispatch_group_async()`如果您打算使用 GCD 执行异步任务，则可以使用该功能： [Grand Central Dispatch (GCD) Reference](https://developer.apple.com/library/mac/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html)

```
dispatch_group_t group = dispatch_group_create();

dispatch_group_async(group, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), 
^{
     //Code here is executed asynchronously
});

dispatch_group_notify(group, dispatch_get_main_queue(), 
^{
   //Do something when async has completed
   //Note: You are not required to use the main 
   //queue if you aren't performing any UI work.
});

dispatch_release(group); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:25:09.857

添加第四个操作，该操作依赖于在主线程上发布 NSNotification 的前三个操作。就像是

```
NSOperation * completionOp = [NSBlockOperation blockOperationWithBlock:^{
  dispatch_async(dispatch_get_main_queue(), ^{
    [[NSNotificationCenter defaultCenter] postNotificationName:MyOperationsCompletedNotification object:... userInfo:nil];
  });
}];
[completionOp addDependency:op1];
[completionOp addDependency:op2];
[completionOp addDependency:op3];
[opQueue addOperation:op1];
[opQueue addOperation:op2];
[opQueue addOperation:op3];
[opQueue addOperation:completionOp]; 
```

我`...`在代码中留下了 a ，因为您可能想用 nil 以外的东西填充对象字段（但它不应该是 UIKit 类，除了那些被记录为线程安全的类）。

或者，每个操作都可以通过 a`dispatch_async()`或返回其结果`-performSelectorOnMainThread:`，但同样，在块中引用线程不安全的 UIKit 类的实例（或作为 a 的接收者或对象`-performSelectorOnMainThread:`）是不明智的。

有很多方法可以做到这一点，这些方法在 GameKit 示例中被特别提到是线程不安全的——特别是，任何可能最终调用`-release`UIView 或 UIViewController 的方法都是危险的，因为这可能会导致`-dealloc`在后台线程上调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-15T08:53:26.137

您可以在**Swift 3+中使用 GCD** **dispatch_group**来实现这一点。当所有任务完成时，您会收到通知。

 **```
let group = DispatchGroup()

    group.enter()
    run(after: 6) {
      print(" 6 seconds")
      group.leave()
    }

    group.enter()
    run(after: 4) {
      print(" 4 seconds")
      group.leave()
    }

    group.enter()
    run(after: 2) {
      print(" 2 seconds")
      group.leave()
    }

    group.enter()
    run(after: 1) {
      print(" 1 second")
      group.leave()
    }

    group.notify(queue: DispatchQueue.global(qos: .background)) {
      print("All async calls completed")
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T23:44:05.633

`isFinished`您可以使用键值观察来观察`saveImageOperation`.**

# java - 如何使用来自另一个线程的服务器更新 java swing gui？

> ID：12790528
> 
> 赞同：3
> 
> 时间：2012-10-08T22:44:19.670
> 
> 标签：java, swing, sockets, thread-synchronization

我有这个 Java Swing 应用程序，每次传入客户端尝试建立连接时，它都会启动一个新线程，该线程使用执行程序池打开套接字服务器。

该应用程序需要两个按钮，一个用于启动，另一个用于停止服务器。我想要的是显示服务器状态，并禁用相反的按钮，直到其状态改变。

这就是我现在所拥有的，但我不知道当线程停止时如何与 EDT 通信。我能做的就是检查`isRunning()`方法。

使用 SwingWorker 会更好吗？

```
public class ServerManager implements Runnable {

    private Executor mExecutor          = Executors.newSingleThreadExecutor();
    private ServerSocket mServerSocket  = null;
    private int mDefaultPort            = 43012;    
    private volatile boolean isRunning  = false;

    public ServerManager (int port){
        mDefaultPort = port;        
    }

    @Override
    public void run() {
        try {           
            mServerSocket = new ServerSocket(mDefaultPort);
            isRunning = true;
            while (isRunning){
                mExecutor.execute(new IncomingClientThread(mServerSocket.accept()));
            }
        } catch (IOException e) {           
            e.printStackTrace();
        } finally {
            if(mServerSocket != null){
                stop();
                System.out.println("Server closed");
            }
        }
    }

    public void stop(){
        try {
            mServerSocket.close();
            isRunning = false;
        } catch (IOException e) {
            throw new RuntimeException("Error closing server", e);
        }
    }

    public synchronized boolean isRunning() {
        return isRunning;
    }

    public int getServerPort (){
        return mDefaultPort;
    }
} 
```

这就是我在 GUI 线程中的内容：我只使用一个按钮并在每次按下它时更改其文本，但如果服务器由于某种原因断开连接，则按钮保持不变。

```
connectButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent arg0) {
                if(mServer.isStopped()){
                    new Thread (mServer).start();
                    connectButton.setText("Desconectar");
                    infoLabel.setText("Servidor online en IP: " + NetworkUtils.getLocalIpAddress()
                            + " puerto: " + mServer.getServerPort());
                    System.out.println(mServer.getIpAddress());
                }else{
                    mServer.stop();
                    connectButton.setText("Conectar");
                    infoLabel.setText("Offline");
                }
            }
        }); 
```

欢迎任何帮助！谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T22:59:56.917

一种可能的解决方案是给它一个 SwingWorker 的部分功能——给它一个 SwingPropertyChangeSupport 对象，并允许你的 GUI 监听和响应状态变化。

例如，

```
public class ServerManager implements Runnable {
  public static final String IS_RUNNING = "is running"; // for the Event's name
  private SwingPropertyChangeSupport propChngSupport = new SwingPropertyChangeSupport(this);
  private volatile boolean isRunning  = false;
  // other variables

  // addPropertyChangeListener(...) {...} goes here
  // removePropertyChangeListener(...)  {...} goes here

  public void setIsRunning(boolean isRunning) {
    boolean newValue = isRunning;
    boolean oldValue = this.isRunning;
    this.isRunning = isRunning;
    propChngSupport.firePropertyChange(IS_RUNNING, oldValue, newValue);    
  }

  public void run() {
    // ....
  }

  // other methods
} 
```

关键是永远不要在其 setter 方法之外更改 isRunning 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T09:08:36.567

所以，我按照@Hovercraft Full Of Eels 的建议所做的是：

在线程类中：

```
 public class ServerManager implements Runnable {

...     
        public static final String IS_RUNNING = "IS_RUNNING";

        private SwingPropertyChangeSupport pChange = new SwingPropertyChangeSupport(this);

        public void setIsRunning (boolean isRunning){
            boolean newValue = isRunning;
            boolean oldValue = this.isRunning;
            this.isRunning = isRunning;
            pChange.firePropertyChange(IS_RUNNING, oldValue, newValue);         
        }   

        public void addPropertyChangeListener (PropertyChangeListener listener){
            pChange.addPropertyChangeListener(IS_RUNNING, listener);
        }

        public void removePropertyChangeListener(PropertyChangeListener listener){
            pChange.removePropertyChangeListener(IS_RUNNING, listener);
        }
...
    } 
```

在 GUI 类中：

```
public class StatusPane extends JPanel{

    private ServerManager mServer;

    public StatusPane() {       
    ...
        mServer = new ServerManager();

        mServer.addPropertyChangeListener(new PropertyChangeListener() {
            public void propertyChange(PropertyChangeEvent evt) {
                System.out.println(evt.getPropertyName() + " cambia su valor de " 
                        + evt.getOldValue() + " a " + evt.getNewValue());
            }
        });
    ... 
    }
} 
```

# ruby - 使用命令行控制 ruby 程序

> ID：12790529
> 
> 赞同：0
> 
> 时间：2012-10-08T22:44:23.857
> 
> 标签：ruby, grid, command-line-interface

我正在尝试创建一个图像生成器，它可以创建一个带有参数的网格，其中 x 代表行，y 代表列作为坐标。我现在想要做的是让命令行通过输入命令和参数来控制程序到目前为止我将调用的方法我的代码如下所示。我该怎么做才能让它工作。例如创建一个新图像 I,5,6。

命令行：

```
 require 'pixel'

    print "Hello please enter a command in : >> "
    command = gets.chomp

    case command
    when "i", "I"
     i = Image.new(m=5,n=6)
    when "c","C"
     i.clear
    when "l","L" 
     i.add_color(x,y,c) 
    when "v","V" 
     i.vertical(x,y1,y2,c)
    when "h","H" 
     i.horizontal(x1,x2,y,c)
    when "f","F" 
     i.fill(x,y,c)
    when "s","S" 
     i.s
    when "x","X" 
     exit
    else
      puts "Opps command does not exist"
    exit
    end 
```

Ruby 图像生成器代码：

```
 class Image
      attr_accessor :m,:n

    def initialize(m,n)
     @m = m
     @n = n
     @image_array = Array.new(@n) {Array.new(@m).fill{(0)}}
    end

    def add_color(x,y,c)   
     x = x 
     y = y - 2
     @image_array[x][y] = c  
    end  

   def vertical(x,y1,y2,c)
    x = x - 1
    y1 = y1 - 1
    y2 = y2 - 1
    @image_array[y1..y2].each {|row| row[x] = c }
   end

  def horizontal(y,x1,x2,c)
   y = y - 2
   z = x2...x1
  @image_array[y].fill(c,z) 
 end

 def fill(x,y,c)
  x = x - 1 
  y = y - 1
  s = x * y
  s.upto(1).to_a
  y.upto(1).to_a

  @image_array[1..s].each {|r| r[y]=c }
  @image_array[1..s].fill(c,s)
end

def s
 p @image_array
end

def clear(m,n)
 @image_array = Array.new(@n) {Array.new(@m).fill{(0)}}
end
end 
```

阻止它工作的命令行代码有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:05:26.410

您发现命令行参数位于全局变量/数组 ARGV

[http://www.ruby-doc.org/docs/ProgrammingRuby/html/rubyworld.html](http://www.ruby-doc.org/docs/ProgrammingRuby/html/rubyworld.html)

有几个库可以帮助您进行命令行解析。一个较旧的，已经是标准库的一部分，是 optparse。

这里我做了一个如何使用它的例子：http: [//pleac.sourceforge.net/pleac_ruby/userinterfaces.html](http://pleac.sourceforge.net/pleac_ruby/userinterfaces.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:15:11.120

看看 optparse 库

[http://ruby.about.com/od/advancedruby/a/optionparser.htm](http://ruby.about.com/od/advancedruby/a/optionparser.htm)

# html - div 高度取决于另一个 div 中的图像

> ID：12790530
> 
> 赞同：0
> 
> 时间：2012-10-08T22:44:50.717
> 
> 标签：html, css

我希望左侧与右侧（包含图像）`div`高度相同。`div`问题是图像是流动的（也就是说，我不能在左边有一个特定的大小`div`）。

这可能吗？

```
<div class="container">
    <div class="left">
        <div>text</div>
        <div>text</div>
    </div>
    <div class="right">
        <div>image</div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:48:51.980

遗憾的是，这不能用 CSS 直接完成……它需要 JavaScript。这是使用 jQuery 的方法

```
var highestCol = Math.max($('.left').height(),$('.right').height());
$('.container > div').height(highestCol); 
```

这将获得较高的高度，`<div>`然后将其分配给左右两侧。这样，两者将具有相同的高度。

我建议您在`column`左右 div 中添加一个类似的类。然后你可以使用：

```
var highestCol = Math.max($('.left').height(),$('.right').height());
$('.column').height(highestCol); 
```

我们也可以将它用作 jQuery 插件......考虑一下：

```
$.fn.setAllToMaxHeight = function(){
    return this.height( Math.max.apply(this, $.map( this , function(e){
        return $(e).height()
    }) ) );
} 
```

这样，您可以在任何希望它们具有相同高度的 div 集上使用它。

```
$('div.columns').setAllToMaxHeight(); 
```

当然，我们希望我们的代码在**所有图像**都加载后运行（因为如果不是，并且 DOM 已经准备好，那么高度就不会正确）所以我们将代码包装在：

```
$(window).load(function () {
    // use the plugin way :
    $('div.columns').setAllToMaxHeight();

    // or use the other way :
    var highestCol = Math.max($('.left').height(),$('.right').height());
    $('.column').height(highestCol);

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:29:09.917

VKen，看起来你想要实现的是一个 Faux Column 布局。

一个非常简单（无 js）的解决方案是使用覆盖容器 div 的图像：

```
.container{overflow:hidden;background: url(faux_background.jpg) repeat-y}
.left,
.right{float:left;}
.left{width:30%} 
```

这将执行以下操作：容器将环绕左右 div，无论它们的高度如何。左 div 将始终为 30%。容器 div 的背景会散发出左 div 无限增长的错觉（假设右 div 更长，反之亦然）。

有关更多信息，A list apart 有一篇很好的文章：[http ://www.alistapart.com/articles/fauxcolumns/](http://www.alistapart.com/articles/fauxcolumns/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T00:39:08.203

这是一个列表，其中包含不同的方法来做到这一点：[http ://css-tricks.com/fluid-width-equal-height-columns/](http://css-tricks.com/fluid-width-equal-height-columns/)

# python - 正则表达式，不包含字符

> ID：12790531
> 
> 赞同：-1
> 
> 时间：2012-10-08T22:44:52.723
> 
> 标签：python, regex

我有一个看起来像这样的模式：

```
pattern = '.*class=(.*)' 
```

它给了我这样的结果：

```
my_class=Hello
your_class=Hi
fclass=FHello
class=That's What I need 
```

基本上我想说我需要返回一个`class`只包含的字符串，而不是一些`fclass my_class`等等

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T22:46:36.800

如果您在单独的行上运行正则表达式，则可以使用该`^`符号来定位正则表达式的开头：

```
pattern = r'^class=(.*)' 
```

如果没有，单词边界可能会有所帮助：

```
pattern = r'\bclass=(.*)' 
```

# asp.net-mvc - 如何使用基于代码的属性指定 MVC SiteMaps Visibility 属性？

> ID：12790532
> 
> 赞同：1
> 
> 时间：2012-10-08T22:44:57.440
> 
> 标签：asp.net-mvc, mvcsitemapprovider, asp.net-mvc-sitemap

我正在使用 MVC SiteMap 提供程序的最新 Nuget 包。我们正在大量使用基于代码的属性来定义我们站点中的节点。

例如`[MvcSiteMapNode(Title = "Examination Types", ParentKey = "LookupTable", Key = "ExaminationTypeIndex")]`

我们希望使用自定义可见性提供程序来隐藏 SiteMap 中的节点，如下[所示](http://mvcsitemap.codeplex.com/wikipage?title=Advanced%20node%20visibility)

但是我们似乎无法使用基于代码的节点来指定节点可见性属性？有没有办法做到这一点。我们只能指定一个自定义可见性提供程序，我们宁愿使用 visible 属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-12T15:46:21.173

Visibility 是一个自定义属性，因此您需要在 Attributes 字段中提供它以便与 [MvcSiteMapNodeAttribute] 一起使用它。唯一棘手的部分是 .NET 属性不支持字典类型，因此您需要将属性作为转义的 JSON 字符串提供。

```
[MvcSiteMapNode(Title = "Examination Types", ParentKey = "LookupTable", Key = "ExaminationTypeIndex", Attributes = @"{ ""visibility"": ""SiteMapPathHelper,!*"" }")] 
```

注意：如果您需要提供多个自定义属性，请用逗号分隔它们。

```
Attributes = @"{ ""visibility"": ""SiteMapPathHelper,!*"", ""myCustomAttribute"": true }" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T19:36:51.387

我发现这样做的唯一方法是创建几个自定义可见性提供程序。例如，如果您的可见性标志可能是“真”和“假”......那么您只需创建一个始终返回假的可见性提供程序。在您在代码中创建的站点地图节点中 - 指定该提供者。

如果您不想对每个属性都这样做，请创建一个从 MvcSiteMapNodeAttribute 继承的新类，该类设置适当的可见性提供程序 - 然后在适当的情况下使用它。

# java - 正则表达式在 twitter 文本文件中查找 Shorturl

> ID：12790536
> 
> 赞同：2
> 
> 时间：2012-10-08T22:45:16.780
> 
> 标签：java, regex

我需要在 java 的文本帖子中找到短 url。我有以下正则表达式“(http://(bit\.ly|t\.co|lnkd\.in|tcrn\.ch).*?)\s”

我有 2 个问题

1.  上述表达式的问题是，如果它位于行尾，则它与短 url 不匹配。ex For text "blah [http://linkd.in/R9Msf3](http://linkd.in/R9Msf3) blah" 给出 "http://linkd.in/R9Msf3 "

    但是等等等等[http://linkd.in/R9Msf3](http://linkd.in/R9Msf3)没有给出“http://linkd.in/R9Msf3”

    有什么建议如何匹配这两种模式？基本上我只需要替换文本中的短网址。

2.  还有没有更好的方法来获取所有短 url 格式？如果我对其进行硬编码，那么每次我都必须向配置中添加新格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T00:08:57.287

而不是`.*`用来`\S*`避免匹配空格。您不需要`?`，您可以使用`\b`而不是`\s`匹配 url 结尾和空格或字符串结尾之间的边界。

```
(http://(bit\.ly|t\.co|lnkd\.in|tcrn\.ch)\S*)\b 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:49:33.633

`(\s|$)`在你的正则表达式结束时尝试

所以 `http://(linkd\.in|t\.co|bitly\.co|tcrn\.ch).*?(\s|$)`

[用正则表达式](http://regexpal.com)测试

![在此处输入图像描述](../Images/a9ec1716212a083493719015edaf6845.png)

# objective-c - 实体继承 - Core Data iOS

> ID：12790539
> 
> 赞同：1
> 
> 时间：2012-10-08T22:45:22.917
> 
> 标签：objective-c, ios, core-data, nsfetchedresultscontroller, nsfetchrequest

**描述核心数据模型：**

我的费用跟踪应用程序有一个核心数据模型。我创建了一个名为“Money”的抽象父实体，其属性为“vendor”、“date”、“amount”等。“费用”和“收入”这两个子实体继承自父实体“金钱”。然后还有其他实体，例如“Category”和“subCategory”及其属性。截至目前的总数：我的数据模型中有 5 个实体。

我有从子实体“费用”和“收入”到实体“类别”的关系，而实体“类别”又与实体“子类别”有一对多关系，因为一个类别可以有一个或多个子类别。实体“类别”与实体“费用”和“收入”具有一对多关系，并且可能存在特定类别的费用或收入。到目前为止，这对我来说很有意义。

我有一个表格视图，并使用 NSFetchedResultsController 来填充我的表格视图，其中包含混合 od 费用和收入。

我有一个带有“ExpenseS”和“Income”按钮的警报视图 - 两者都被推送到同一个视图控制器，其中包含诸如填写供应商、金额、类别、子类别和导航栏上的保存按钮等详细信息。

这是我的保存方法：

```
- (void)saveMoney:(id)sender
{    
    AppDelegate * applicationDelegate = (AppDelegate *) [[UIApplication sharedApplication] delegate];

    NSManagedObjectContext * context = [applicationDelegate managedObjectContext];

    _money = (Money*) [NSEntityDescription insertNewObjectForEntityForName:@"Money" inManagedObjectContext:context];

    double expenseAmt = [_amountTxtField.text doubleValue];

    NSDate *expenseDate = [dateFormatter dateFromString:[NSString stringWithFormat:@"%@",currentDateLbl.text]];

    _money.vendor = vendorTxtField.text;
    _money.cat = categoryLbl.text;
    _money.subcat = subCategoryLbl.text;
    _money.amount = [NSNumber numberWithDouble:expenseAmt];
    _money.date = expenseDate;
    _money.photo = _templateImgView.templateImage.image;
    _money.notes = notesLbl.text;
    _money.paidBy = paidResourceLbl.text;

    NSError * error = nil;
    [context save:&error];

    [self.navigationController dismissModalViewControllerAnimated:YES];

} 
```

这将新的费用/收入保存到表格视图中，并且我在表格视图中获得了结果（费用/收入）的混合。但是我怎么知道我的行是支出还是收入。我认为获取请求应该使它工作？但是这个获取请求应该放在哪里，用什么方法呢？我尝试使用以下代码：

AppDelegate * applicationDelegate = (AppDelegate *) [[UIApplication sharedApplication] delegate]; NSManagedObjectContext * context = [applicationDelegate managedObjectContext];

```
// Retrieve the entity from the local store -- much like a table in a database
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Money" inManagedObjectContext:context];
NSFetchRequest *request = [[NSFetchRequest alloc] init];

[request setEntity:entity];
[request setIncludesSubentities:YES];

// Set the sorting -- mandatory, even if you're fetching a single record/object
NSSortDescriptor *sortDescriptor1 = [[NSSortDescriptor alloc] initWithKey:@"date" ascending:YES];

NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptor1,nil];
[request setSortDescriptors:sortDescriptors];
[sortDescriptors release]; sortDescriptors = nil;
[sortDescriptor1 release]; sortDescriptor1 = nil;

NSError * error;

NSArray * objects = [context executeFetchRequest:request error:&error];

for (Money* money in objects)
{
    NSLog(@"money class");

    if([money isKindOfClass:[Expense class]])
    {
        NSLog(@"expense class");
    }
    else
    {

    }
}

[context save:&error]; 
```

这从不打印“费用类”，根本不去那里。我不知道这将如何工作以及我将以什么方法放置这个获取请求。

请帮帮我。我会很感激的。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T02:46:51.783

创建实体时，应使用 Expense 或 Income 作为实体名称，例如：

```
[NSEntityDescription insertNewObjectForEntityForName:@"Expense" inManagedObjectContext:context]; 
```

然后，当您使用实体名称“Money”获取时，它会按照您的预期拉出子实体。

# php - 复选框从文本框中获取值

> ID：12790542
> 
> 赞同：1
> 
> 时间：2012-10-08T22:45:27.233
> 
> 标签：php, checkbox, textbox

我在组合复选框和文本框值时遇到问题。这是我的代码片段：

```
<input type="checkbox" name="id_staf[]" value="query from database">
<input type="text" name="note[]" value="any text entered">
<br>
<input type="checkbox" name="id_staf[]" value="query from database">
<input type="text" name="note[]" value="any text entered">
<br>
<input type="checkbox" name="id_staf[]" value="query from database">
<input type="text" name="note[]" value="any text entered">
<br> 
```

这是我处理该表单的 php 代码：

```
$array_id_staf = $_POST['id_staf'];
$array_note= $_POST['note'];

for($a = 0; $a < count($array_id_staf); ++$a) {
echo $query1 = "UPDATE peserta SET note='$array_note[$a]' WHERE id= '$array_id_staf[$a]'<br>debugging";
//----------------------testing---------------------------@mysql_query($query1); // hold first for debugging
} // Closing for 
```

如果选中了所有复选框，则结果操作系统正常。但是如果检查了第二个和第三个，数组 $array_note 就会出错。

请帮我。提前致谢。

# c - 无法理解结构的内存分配

> ID：12790543
> 
> 赞同：1
> 
> 时间：2012-10-08T22:45:33.247
> 
> 标签：c, memory-management

考虑遵循 C 代码 -

```
typedef struct node
{
    int data;
}node;

int main()
{
    node *temp;
    temp->data=100;
    printf("%d",temp->data);
    return 0;
} 
```

它`Segmentation fault`在线包含`temp->data=100;`因为（我认为）我没有为它分配内存。因此，没有诸如`temp->data`.
但是，当我尝试使用 -

```
int main()
{
    node *temp,*n;
    n=(node*)malloc(sizeof(node));
    n->data=100;
    temp->data=n->data;
    printf("%d",temp->data);
    retrun 0;
} 
```

它给出了正确的输出 100。我没有分配内存`temp`指向的地方。但我仍然在复制`n->data`到`temp->data`. 如何 ？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T06:48:31.357

临时指针采用一些垃圾值作为未初始化的值。碰巧 temp 有一个垃圾值，它可能恰好是您的程序的合法地址，因此它运行。如果垃圾值有非法地址，则会产生段错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:51:07.923

你很幸运。

局部变量不会自动初始化，因此当程序开始时，两者都`temp`包含`n`堆栈中发生的任何值。接下来，分配内存并`n`设置为指向它。值 100 存储在`data`结构的成员中。

但`temp`仍然未初始化，因此值 100 被复制到未指定的内存区域。根据该内存的位置，程序可能会出现段错误，或者它可能只是破坏它不拥有的内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T22:52:21.210

你没有段错误`temp->data=n->data;`只是巧合。`temp`未初始化，因此它指向数字必杀技。

当您调用时`malloc`，您已经分配`sizeof node`了字节（实际上可能更多），然后您可以完全访问`n`.

一般来说，您应该`malloc`以这种方式调用：

```
node *n;
n = malloc(sizeof *n); 
```

1.  没有演员表
2.  用`sizeof *n`而不是`sizeof <datatype>`. 如果您更改数据类型（例如，您有一个错字，而不是`typedef .... node`您已经写了`typedef ... nhode`。那么您只需要更改变量的声明，其余代码根本不需要更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-10T18:25:02.890

你的第一个代码也是正确的，只是“temp”指向一个垃圾值，所以你必须初始化它。

```
temp=(node *)malloc(sizeof(node)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-08T22:49:21.807

你在第一部分的权利，它是段错误，因为 node* temp 没有指向任何地方（嗯，某处，但不是分配的内存）。

我不知道为什么第二个“有效”。我怀疑它只是看起来有效，因为它没有崩溃。但是由于 temp 从未初始化过，谁知道它在哪里粘贴'100'。也许只是徘徊在以后崩溃。无论哪种方式，写入未初始化的内存都不是一个好主意；-0

# postgresql - 清理 postgres 中列的输入

> ID：12790547
> 
> 赞同：1
> 
> 时间：2012-10-08T22:46:10.327
> 
> 标签：postgresql, validation, plpgsql, sanitization, postgresql-8.1

所以，我认为这应该相当简单，但文档使它看起来有点复杂。我在 PostgreSQL（目前是 8.1）中编写了一个 SQL 函数，它对一些字符串输入进行了一些清理。值得一提的是，该字符串是一个 LDAP 专有名称，我希望逗号后始终没有空格 - 函数是 clean_dn()，它返回清理后的 DN。我想做同样的事情来强制对另一对列的所有输入为小写，等等——一旦我弄清楚这部分，这应该很容易。

无论如何，只要有人尝试插入或更新和修改该列，我希望此函数在表的“dn”列上运行。但是我能找到的所有规则示例似乎都假设所有插入/更新查询都会一直修改表中的所有列。在我的情况下，情况并非如此。我认为我真正想要的是一个仅更改值而不是返回 true 或 false 的约束，但这对于约束的 SQL 概念似乎没有意义。我是否让我的规则对新表执行更新？我是否必须为每个可能的新值组合创建一个新规则？如果我添加一个列，我是否必须检查并更新我的所有规则组合以反映每个可能的新列组合？

必须有一个简单的方法...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:56:12.567

首先，更新到当前版本的 PostgreSQL。8.1 早就死了，被遗忘了，没有得到支持，而且非常非常老了.. 你明白我的意思吗？[当前版本是 PostgreSQL 9.2](http://www.postgresql.org/support/versioning/)。

然后，使用**触发器**而不是规则。它更简单。这是大多数人的方式。我愿意。

对于`col`表中的列`tbl`...

首先，创建一个[**触发函数**](http://www.postgresql.org/docs/current/interactive/plpgsql-trigger.html)：

```
CREATE OR REPLACE FUNCTION trg_tbl_insupbef()
  RETURNS trigger AS
$BODY$
BEGIN

NEW.col := f_myfunc(NEW.col);  -- your function here, must return matching type

RETURN NEW;

END;
$BODY$
  LANGUAGE plpgsql VOLATILE; 
```

[**然后在触发器**](http://www.postgresql.org/docs/current/interactive/sql-createtrigger.html)中使用它。
对于古代 Postgres 8.1：

```
CREATE TRIGGER insupbef
  BEFORE INSERT OR UPDATE
  ON tbl
  FOR EACH ROW
  EXECUTE PROCEDURE trg_tbl_insupbef(); 
```

对于现代 Postgres (9.0+)

```
CREATE TRIGGER insbef
  BEFORE INSERT OR UPDATE OF col  -- only call trigger, if column was updated
  ON tbl
  FOR EACH ROW
  EXECUTE PROCEDURE trg_tbl_insupbef(); 
```

您可以将更多内容打包到一个触发器中，但是您不能仅针对一列设置 UPDATE 触发器...

# java - Tomcat HttpSession Cookie 共享

> ID：12790549
> 
> 赞同：0
> 
> 时间：2012-10-08T22:46:12.427
> 
> 标签：java, tomcat, servlets, session-cookies

我有几个在不同服务器上运行的相同 Web 应用程序的单独实例（都有不同的面向公众的 IP）。我利用会话来存储当前登录的用户信息。

```
HttpSession session = req.getSession(true);     

User user = (User)session.getAttribute("user");
if (user == null) {
  // get my user
  session.setMaxInactiveInterval(....);
  session.setAttribute("user", user);
} 
```

问题是，当我登录到一个实例（称为实例 1）然后登录到另一个实例（实例 2）时，当我切换到实例 1 时，它会获取实例 2 的 cookie，并且当用户在实例 1 上不存在这样的 id，甚至更糟糕的是，它只是默默地找到与该 id 匹配的用户..

我查看了 cookie，只有一个`JSESSIONID`使用“localhost”域创建的 cookie，它与所有实例共享。有没有办法设置Tomcat将域设置为机器的域？

我正在运行 Tomcat 6.0.35

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T01:29:54.017

您可以更改`defaultHost`为`hostname`服务器的（或网络名称）。
看一下Tomcat的`conf/server.xml`配置文件：

```
<Engine ... defaultHost="myserver"> 
```

然后你还需要改变：

```
<Host ... name="myserver"> 
```

参见： http:
[//tomcat.apache.org/tomcat-6.0-doc/config/engine.html](http://tomcat.apache.org/tomcat-6.0-doc/config/engine.html)
[http://tomcat.apache.org/tomcat-6.0-doc/config/host.html](http://tomcat.apache.org/tomcat-6.0-doc/config/host.html)

作为另一种可能的解决方案，您可以`jvmRoute`为每个实例定义“唯一名称”。

```
<Engine ... jvmRoute="instance1"> 
```

这将产生一个`JSESSIONID`类似：

```
C85262796BE5F656BD8EF58A96F03C96.instance1 
```

# java - .? 运算符理论上可能在java中？

> ID：12790550
> 
> 赞同：3
> 
> 时间：2012-10-08T22:46:16.613
> 
> 标签：java, operators, isnull

我知道 Java 不支持运算符重载，但似乎其他语言中的一些运算符可能会使 Java 受益。

可能我最喜欢的例子是`.?`运算符。`.?`对象的成员仅在对象为非 null时才能访问：

```
public void example(String arg)
{
    if(arg != null && arg.equals("quit"))
        ...
} 
```

可以缩短为

```
public void example(String arg)
{
    if(arg.?equals("quit"))
        ...
} 
```

该`.?`运算符（至少恕我直言）易于阅读，并消除了一些有时会损害代码可读性的额外代码。在某些代码中，可能会对对象或参数的 null 状态进行多次检查，并可能导致对整个代码块进行不必要和过多的缩进。

显然，这不会是革命性的变化，但`.?`可以普遍适用于`Object`我所见的所有子类。我错了吗？如果现在采用 Java 将不支持运算符重载，这是否违背了过去的逻辑？

# javascript - 样式化谷歌图表表

> ID：12790553
> 
> 赞同：17
> 
> 时间：2012-10-08T22:46:32.323
> 
> 标签：javascript, google-visualization

我正在尝试将 CSS 样式添加到 Google 图表表中。我试过这个：

[https://developers.google.com/chart/interactive/docs/gallery/table#customproperties](https://developers.google.com/chart/interactive/docs/gallery/table#customproperties)

在第一个单元格（迈克）上，但它没有用。我在 options 变量中将 allowHtml 设置为 true。如何更改单个单元格的背景、文本颜色等？谢谢你。

```
<script type="text/javascript">
        google.load('visualization', '1', {packages:['table']});
        google.setOnLoadCallback(drawTable);
        function drawTable() {
            var data = new google.visualization.DataTable();
            data.addColumn('string', 'Employee Name');
            data.addColumn('date', 'Start Date');
            data.addRows(3);
            data.setCell(0, 0, 'Mike', {style: 'background-color:red;'});
            data.setCell(0, 1, new Date(2008, 1, 28));
            data.setCell(1, 0, 'Bob');
            data.setCell(1, 1, new Date(2007, 5, 1));
            data.setCell(2, 0, 'Alice');
            data.setCell(2, 1, new Date(2006, 7, 16));

            var options = {
                allowHtml: true
            };

            // Create a formatter.
            // This example uses object literal notation to define the options.
            var formatter = new google.visualization.DateFormat({formatType: 'long'});

            // Reformat our data.
            formatter.format(data, 1);

            // Draw our data
            var table = new google.visualization.Table(document.getElementById('dateformat_div'));
            table.draw(data, options);
        }
    </script> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-07-16T13:37:43.313

> 如何更改单个单元格的背景、文本颜色等？谢谢你。

根据@Bondye 的评论，可以在开发人员指南中找到答案。

[https://developers.google.com/chart/interactive/docs/examples#custom_table_example](https://developers.google.com/chart/interactive/docs/examples#custom_table_example)

定义符合您的标准的样式规则：

```
<style>
.orange-background {
   background-color: orange;
  }

 .orchid-background {
  background-color: orchid;
 }

.beige-background {
 background-color: beige;
  }
</style> 
```

绘制时将它们应用到桌子上。

```
var cssClassNames = {
'headerRow': 'italic-darkblue-font large-font bold-font',
'tableRow': '',
'oddTableRow': 'beige-background',
'selectedTableRow': 'orange-background large-font',
'hoverTableRow': '',
'headerCell': 'gold-border',
'tableCell': '',
'rowNumberCell': 'underline-blue-font'};

var options = {'showRowNumber': true, 'allowHtml': true, 'cssClassNames': cssClassNames};

var data = new google.visualization.DataTable();

//... add data here ...

var table = new google.visualization.Table(container);
table.draw(data, options); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-07-11T09:25:09.017

[谷歌图表](/questions/tagged/google-charts "显示标记为“谷歌图表”的问题")的自定义表格格式对我来说很棘手：

1.  它的风格是：`.tableRow { background-color:rgb(246, 253, 253); }`
2.  它也适用于标准 css：`tr:hover {background-color: ...;}`
3.  它有时仅适用于`!important`css 键：`background-color: rgba(141, 186, 238, 0.76) !important;`

这是我的工作示例：

```
// Load the Visualization API and the controls package.
google.load('visualization', '1.0', { packages: ['table'] });

// Set a callback to run when the Google Visualization API is loaded.
google.setOnLoadCallback(drawDashboard);

// Callback that creates and populates a data table,
// instantiates a dashboard, a range slider and a pie chart,
// passes in the data and draws it.
function drawDashboard() {
  // Create our data table.
  var data = google.visualization.arrayToDataTable([
    ['Sex', 'Name', 'Donuts eaten', 'Html'],
    ['Male', 'Michael', 5, '<input type="checkbox" id="1" name="check">'],
    ['Female', 'Elisa', 7, '<input type="checkbox" id="2" name="check">'],
    ['Male', 'Robert', 3, '<input type="checkbox" id="3" name="check">'],
    ['Male', 'John', 2, '<input type="checkbox" id="4" name="check">'],
    ['Female', 'Jessica', 6, '<input type="checkbox" id="5" name="check">'],
    ['Male', 'Aaron', 1, '<input type="checkbox" id="6" name="check">'],
    ['Female', 'Margareth', 8, '<input type="checkbox" id="7" name="check">'],
  ]);
  var table = new google.visualization.Table(document.getElementById('table'));

  var options = 
  {
    allowHtml: true, 
    showRowNumber: true, 
    width: '100%', 
    height: '100%'
    ,
    cssClassNames: { 
      headerRow: 'headerRow',
      tableRow: 'tableRow',
      oddTableRow: 'oddTableRow',
      selectedTableRow: 'selectedTableRow',
      // hoverTableRow: 'hoverTableRow',
      headerCell: 'headerCell',
      tableCell: 'tableCell',
      rowNumberCell: 'rowNumberCell'
    }    

  };

  table.draw(data, options);
}
```

```
body
{
 font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

/* Tables */
th {
  padding-top: 12px;
  padding-bottom: 12px;
  text-align: left;
  background-color: rgb(83, 133, 180);
  border-color: rgb(151, 150, 168) !important;
  color: white;
}

.oddTableRow {
    background-color:rgb(232, 246, 247);
}

.tableRow { background-color:rgb(246, 253, 253); } 

tr:hover {background-color: rgba(233, 235, 154, 0.76) !important;}
.selectedTableRow {
    background-color: rgba(141, 186, 238, 0.76) !important;
}
```

```
<!doctype html>

<html>
  <head>
    <link rel="stylesheet" href="style.css">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="script.js"></script>
  </head>

  <body>
    <h1>Google Charts. Custom HTML & CSS in table</h1>
    <div id="table"></div>
  </body>
</html>
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-05T16:28:26.697

对于更现代的小部件和图表，您可以将自定义 css 应用于 Google 图表，请参阅此 repo 以了解已实现的样式

[https://github.com/weekdone/GoogleChartStyles](https://github.com/weekdone/GoogleChartStyles)

# ruby-on-rails - 在 form_for rails 中选择

> ID：12790557
> 
> 赞同：0
> 
> 时间：2012-10-08T22:46:50.960
> 
> 标签：ruby-on-rails, forms

我做了什么：

```
rails g scaffold game optionselect:string
rake db:migrate 
```

在我看来**form_for(@game)**：

```
<div class="field">
  <%= f.label :optionselect %><br />
  <%= f.select( :optionselect, "id", { "Option 1" => "1", "Option 2" => "2"}) %>
</div> 
```

我想做的事：

从选择框中选择一个值并将所选值保存在**@game.optionselect**

问题：没有可见的可选值。当我省略**f。**在**f.select**前面的值是可见的，但没有被保存（我知道）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T12:35:13.903

将此类集合保留在模型中并创建类方法来准备它们是一种很好的做法，例如：

```
class Game < ActiveRecord::Base

  OPTIONS = [
    {:name => 'Option 1', :id => 1},
    {:name => 'Option 2', :id => 2},
    {:name => 'Option 3', :id => 3}
  ]

  def self.options
    OPTIONS.map{ |option| [option[:name], option[:id]] }
  end
end 
```

然后在视图中：

```
= f.select :optionselect, Game.options 
```

# oracle - 将 Oracle 存储过程从使用 DBMS_XMLSave 转换为 DBMS_XMLStore

> ID：12790559
> 
> 赞同：0
> 
> 时间：2012-10-08T22:47:27.767
> 
> 标签：oracle, plsql, oracle11g, oracle-xe

我继承了一个在后端使用 Oracle 数据库的应用程序。该数据库最初使用的是完整版的 Oracle，但我们已将其移至 Oracle XE。Oracle XE 似乎不支持 Oracle XML SQL 实用程序（包括 DBMS_XMLSave），或者至少我无法弄清楚如何安装它。

根据此链接（[http://ellebaek.wordpress.com/2011/01/27/converting-between-oracle-data-and-xml/](http://ellebaek.wordpress.com/2011/01/27/converting-between-oracle-data-and-xml/)）：

> 与 DBMS_XMLQUERY 一样，DBMS_XMLSAVE 是用 Java 实现的，因此 Oracle Database Express Edition 不支持它。

数据库中的存储过程使用 DBMS_XMLSave，但从这个链接 ( [https://forums.oracle.com/forums/thread.jspa?threadID=530048](https://forums.oracle.com/forums/thread.jspa?threadID=530048) ) 看来 DBMS_XMLSave 已被 DBMS_XMLStore 取代：

> DBMS_XMLSTORE PL/SQL 包是在 Oracle 数据库 10g 第 1 版中引入的。该包根据 XML 文档的内容对数据库内的关系表或对象表执行 DML 操作。
> 
> 请注意，在 Oracle 数据库 10g 之前，此功能存在于另一个 PL/SQL 包中，称为 DBMS_XMLSAVE。

我尝试了链接中的解决方案：

```
CREATE OR REPLACE PUBLIC SYNONYM DBMS_XMLSAVE FOR DBMS_XMLSTORE;
GRANT EXECUTE ON DBMS_XMLSAVE TO PUBLIC; 
```

这确实修复了大部分错误，但是我留下了一些问题行：

```
DBMS_XMLSave.setDateFormat(v_insCtx, 'MM/dd/yyyy');
DBMS_XMLSave.setBatchSize(v_updCtx, -1);
DBMS_XMLSave.setDateFormat(v_updCtx, 'MM/dd/yyyy'); 
```

DBMS_XMLStore 似乎不支持这些方法。挖掘我想我找到了解决setDateFormat的方法。根据此链接 ( [http://ellebaek.wordpress.com/2011/01/27/converting-between-oracle-data-and-xml/](http://ellebaek.wordpress.com/2011/01/27/converting-between-oracle-data-and-xml/) ) DBMS_XMLStore 使用 NLS 设置日期/时间值。此链接（[http://www.tiplib.com/231/nls-parameter-session-logon-trigger](http://www.tiplib.com/231/nls-parameter-session-logon-trigger)）指出可以在这样的存储过程中更改 NLS 设置：

```
BEGIN
    DBMS_SESSION.SET_NLS('NLS_DATE_FORMAT','YYYYMMDD');
    COMMIT;
END; 
```

所以我希望我可以像这样替换 setDateFormat 行：

```
-DBMS_XMLSave.setDateFormat(v_insCtx, 'MM/dd/yyyy');  -- remove
+DBMS_SESSION.SET_NLS('NLS_DATE_FORMAT','MM/dd/yyyy');  -- insert 
```

我找不到 setBatchSize 的替代品。

所以我的问题是：

1.  我是以正确的方式处理这个问题，还是有更好的方法？

2.  DBMS_XMLSave.setDateFormat(v_insCtx, 'MM/dd/yyyy') -> DBMS_SESSION.SET_NLS('NLS_DATE_FORMAT','MM/dd/yyyy') 会改变工作吗？

3.  是否有 setBatchSize 的替代品？是否需要更换 setBatchSize？

一般来说，如果有人问类似上述问题 2 的问题，我会告诉他们尝试并告诉我，但我目前无法编译代码，而且我没有已知的工作基线。我可以删除问题行，它可能会产生一些结果，但我不清楚结果是否正确。删除问题线并尝试检查结果将是我从这里开始的方法。

原代码如下：

```
 procedure insert_xml(p_xmlDoc in clob, p_tableName in varchar2) is
        v_insCtx DBMS_XMLSave.ctxType;
        v_rows number;
    begin
      v_insCtx := DBMS_XMLSave.newContext(p_tableName); -- get the context handle
      DBMS_XMLSave.setDateFormat(v_insCtx, 'MM/dd/yyyy'); -- set date format
      v_rows := DBMS_XMLSave.insertXML(v_insCtx, p_xmlDoc); -- this inserts the document
      DBMS_XMLSave.closeContext(v_insCtx); -- this closes the handle
    exception
      when OTHERS then
        raise_application_error(-20001,'An error was encountered. - '||SQLCODE||' -ERROR- '||SQLERRM);
    end insert_xml;

    procedure update_xml(p_xmlDoc in clob, p_tableName in varchar2, p_key in varchar2) is
            v_updCtx DBMS_XMLSave.ctxType;
            v_rows number;
        begin
            v_updCtx := DBMS_XMLSave.newContext(p_tableName); -- get the context
            DBMS_XMLSave.setBatchSize(v_updCtx, -1);
            DBMS_XMLSave.setDateFormat(v_updCtx, 'MM/dd/yyyy'); -- set date format
            DBMS_XMLSave.clearUpdateColumnList(v_updCtx); -- clear the update settings..
            DBMS_XMLSave.setKeyColumn(v_updCtx, p_key); -- set EMPNO as key column
            v_rows := DBMS_XMLSave.updateXML(v_updCtx, p_xmlDoc); -- update the table.
            DBMS_XMLSave.closeContext(v_updCtx); -- close the context..!
      exception
        when OTHERS then
          raise_application_error(-20001,'An error was encountered. - '||SQLCODE||' -ERROR- '||SQLERRM);
        end update_xml; 
```

感谢你的协助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T00:11:02.847

我已经半回答了这个问题。当我尝试时：

```
DBMS_SESSION.SET_NLS('NLS_DATE_FORMAT','MM/DD/YYYY'); 
```

我发现我得到了这些错误：

```
ORA-31011: XML parsing failed
ORA-19202: Error occurred in XML processing
LPX-00222: error received from SAX callback function
ORA-01843: not a valid month 
```

在挖掘之后我发现：

```
EXECUTE IMMEDIATE 'ALTER SESSION SET NLS_DATE_FORMAT = "MM/DD/YYYY"'; 
```

这似乎让日期处理不会抱怨，我认为它已经解决了问题，但我在这个阶段不能 100% 确定。

我没有替换 DBMS_XMLSave.setBatchSize(); 我不确定这是否会影响性能。

我直接修改了代码，而不是使用公共同义词，它目前看起来像这样：

```
 procedure insert_xml(p_xmlDoc in clob, p_tableName in varchar2) is
        v_insCtx DBMS_XMLStore.ctxType;
        v_rows number;
    begin
        v_insCtx := DBMS_XMLStore.newContext(p_tableName); -- get the context handle
        EXECUTE IMMEDIATE 'ALTER SESSION SET NLS_DATE_FORMAT = "MM/DD/YYYY"';
        v_rows := DBMS_XMLStore.insertXML(v_insCtx, p_xmlDoc); -- this inserts the document
        DBMS_XMLStore.closeContext(v_insCtx); -- this closes the handle
    exception
        when OTHERS then
          raise_application_error(-20001,'An error was encountered. - '||SQLCODE||' -ERROR- '||SQLERRM);
    end insert_xml;
    procedure update_xml(p_xmlDoc in clob, p_tableName in varchar2, p_key in varchar2) is
        v_updCtx DBMS_XMLStore.ctxType;
        v_rows number;
    begin
        v_updCtx := DBMS_XMLStore.newContext(p_tableName); -- get the context
        EXECUTE IMMEDIATE 'ALTER SESSION SET NLS_DATE_FORMAT = "MM/DD/YYYY"';
        DBMS_XMLStore.clearUpdateColumnList(v_updCtx); -- clear the update settings..
        DBMS_XMLStore.setKeyColumn(v_updCtx, p_key); -- set EMPNO as key column
        v_rows := DBMS_XMLStore.updateXML(v_updCtx, p_xmlDoc); -- update the table.
        DBMS_XMLStore.closeContext(v_updCtx); -- close the context..!
    exception
        when OTHERS then
          raise_application_error(-20001,'An error was encountered. - '||SQLCODE||' -ERROR- '||SQLERRM);
        end update_xml; 
```

# google-cloud-messaging - 是否应该能够多次注册同一设备而无需在“重复”注册中获得规范 ID？

> ID：12790561
> 
> 赞同：1
> 
> 时间：2012-10-08T22:47:35.473
> 
> 标签：google-cloud-messaging

我已经实现了 GCM，但有些观点我似乎没有理解。

GCM 有一个 Canonical Id 的概念，如果客户端注册两次或多次，而您从服务器向这些 Google 发送消息，则会返回最后一次注册的 regId 的（该）规范 id ?? 当我故意不取消注册设备来测试它时，它仍然成功地将多条消息发送到同一设备。我是否误解了规范 id 是什么？您是否可以多次注册设备？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T00:41:09.380

是的，您可以多次注册同一个应用程序/设备，并且规范 ID 旨在帮助您在问题出现时解决该问题。当您收到带有规范 ID 的响应时，您的服务器将需要修剪您的注册 ID 列表。你可以看到我在这里写的回复：[android GCM get original id of canonical id](https://stackoverflow.com/questions/13958079/android-gcm-get-original-id-of-canonical-id/13959022#13959022)这描述了格式和做什么。

这篇文章还包含有关规范 ID 的良好信息：[GCM 和 id 处理](https://stackoverflow.com/questions/13752995/gcm-and-id-handling)

# objective-c - 禁用 MKmapkit mapView userLocation annotationView

> ID：12790563
> 
> 赞同：6
> 
> 时间：2012-10-08T22:47:58.743
> 
> 标签：objective-c, ios, mapkit, userlocation

我有一个`mapView`带`annotationViews`和`userLocation`蓝点的。

我正在使用以下代码来获取蓝点：

```
[self.mapView setShowsUserLocation:YES]; 
```

是可选择的`annotationViews`并且有标注。

但是，如果 an`annotationView`靠近用户的位置，有时蓝点会偷走触摸。

我可以设置一个`annotationView.enabled = NO;`，它会显示 annotationView，但它不会从附近偷走触摸`annotationView`。

我想将用户位置蓝点设置`annotationView`为 enabled=NO，这样它就不会窃取 close by 的触摸`annotationViews`。

我可以设置蓝点的标题：

```
self.mapView.userLocation.title = @"title here..." 
```

但我无法禁用蓝点。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-09T01:25:06.353

您可以通过在委托方法中获取对它的引用来设置`enabled`用户位置（因此您可以确保视图已准备好）：`MKAnnotationView``didAddAnnotationViews`

```
-(void)mapView:(MKMapView *)mapView didAddAnnotationViews:(NSArray *)views
{
    MKAnnotationView *ulv = [mapView viewForAnnotation:mapView.userLocation];
    ulv.enabled = NO;
} 
```

*（模型*对象没有`enabled`属性——它是视图的属性。）`userLocation`

# c - C删除第一个和最后一个元素

> ID：12790564
> 
> 赞同：1
> 
> 时间：2012-10-08T22:48:05.350
> 
> 标签：c

我有一个数组（使用基于 C 的语言）`char eItem[32]`，.

对于每个“i”，将加载这些值：

```
{ WADMIN, WADMIN, WADMIN, WADMIN, PALA, PALA, PALA, PALA } 
```

现在，我编写了这段代码来删除每个值的第一个和最后一个元素。

```
for ( i = 0; i <= 7; i++ ) {
    // code to get values
    k = strlen( eItem );
    eItem[k - 1] = "";
    eitem[0] = "";
    printf( eItem );
} 
```

非常简单，但它不起作用。怎么来的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T01:42:32.170

玛丽安，

请通过以下实现目的。它应该合理地工作。

```
#include<stdio.h>
#include<string.h>
#include<stdlib.h>

int main()
{
  const char *src_strings[]={"WADMIN", "WADMIN", "WADMIN", "WADMIN", "PALA", "PALA", "PALA", "PALA"}; //source array of char pointers
  char *dest_strings[8]; //Destination array of character pointers
  int string_count,length,cindex;

  printf("Modified Strings\n");
  printf("================\n");

  //Traverse through the strings in the source array
  for(string_count=0;string_count<8; string_count++) 
  {
    //Compute the lenght and dynamically allocate the
    //required bytes for the destination array
    length=strlen(src_strings[string_count]);
    dest_strings[string_count]= (char*)malloc(sizeof(length-1));

    //Copy characters to destination array except first and last
    for(cindex=1; cindex<length-1; cindex++)
    {
       *(dest_strings[string_count]+cindex-1)=*(src_strings[string_count]+cindex);
    }

    //Append null character
    *(dest_strings[string_count]+cindex)='\0';
    printf("%s\n",dest_strings[string_count]);

    //Free memory as it is not needed
    free(dest_strings[string_count]);

  }
  return 0;
} 
```

### 样本输出

```
Modified Strings
================
ADMI
ADMI
ADMI
ADMI
AL
AL
AL
AL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:51:49.733

您正在将字符串分配给字符串（字符）的单个元素。相反，您需要使用单引号指定一个字符。例如，在单词的前面和末尾放置一个空格，这似乎是您想要做的：

```
eItem[k-1]=' ';
eItem[0]=' '; 
```

但是您实际上可以通过使单独的字符指针指向字符串中的第二个字符来截断字符串的开头，并通过添加 NULL 字节在结尾处截断：

```
eItem[k-1]='\0';
char * truncated_eItem = eItem + 1; 
```

请记住，这`+1`意味着它指向`1 * sizeof(char)`内存中下游的地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T22:54:27.357

```
eItem = eItem+1;
eItem[strlen(eItem)-1] = 0; 
```

# php - 在 PEAR 中修复“不推荐通过引用分配新的返回值”？

> ID：12790567
> 
> 赞同：1
> 
> 时间：2012-10-08T22:48:25.607
> 
> 标签：php

> **可能重复：**
> [Pear 错误消息与 PHP5.3.0](https://stackoverflow.com/questions/2246546/pear-error-messages-with-php5-3-0)

我是 php 新手，我正在关注网络上的教程。我对这个 PEAR 东西一无所知，我知道它是一个图书馆。我下载了 xampp，pear 也包含在其中。但我遇到了这个错误。

错误说

> 不推荐使用：在第 80 行的 C:\xampp\php\PEAR\Config.php 中不推荐使用通过引用分配 new 的返回值
> 
> 不推荐使用：在第 166 行的 C:\xampp\php\PEAR\Config.php 中不推荐使用通过引用分配 new 的返回值

我所做的是进入那里并改变它

```
function Config()
    {
        $this->container =& new Config_Container('section', 'root');
    } // end constructor 
```

进入这个

```
function Config()
    {
        $this->container = new Config_Container('section', 'root');
    } // end constructor 
```

我以某种方式摆脱了错误，但是如果我所做的更改将来会犯更多错误怎么办。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:49:33.033

只有在古代 PHP 版本中才需要在实例化对象时使用引用运算符。所以这个改变不会引入新的错误。

但是，您必须进行此更改的事实意味着您正在使用您可能根本不应该使用的古老/遗留代码。它可能会使用其他糟糕的编程实践，甚至可能包含未修复的安全漏洞。

# openssl - OpenSSL：无法获取本地颁发者证书

> ID：12790572
> 
> 赞同：17
> 
> 时间：2012-10-08T22:49:29.983
> 
> 标签：openssl, certificate

我有一个证书 C.pfx，它被授予我使用 OpenSSL。证书 C.pfx 具有以下证书路径：C->B->A

我使用以下命令将 C.pfx 转换为 PEM： openssl pkcs12 -in C.pfx -out C.pem -nodes -- 工作正常

我在文件编辑器中打开了证书 C.pem，发现它同时具有 RSA PRIVATE KEY 和 CERTIFICATE 部分。

我还看到在 Windows XP 的 Trusted Roor Certification Athorities 存储下安装了 A 和 B 证书。

目标是使用 OpenSSL for Windows 1.0.1c 版（目前是最新版本）对测试文件进行签名、加密、解密和验证

我使用以下命令：

- 签署 -

```
openssl smime -sign -signer C.pem -in test.txt -out test.tmp    -- WORKS OK 
```

--加密--

```
openssl smime -encrypt -in test.tmp -out test.enc C.pem     -- WORKS OK 
```

--解密--

```
openssl smime -decrypt -in test.enc -recip C.pem -inkey C.pem -out test1.tmp    -- WORKS OK 
```

- 验证 -

```
openssl smime -verify -in test1.tmp -CAfile "C.pem" -out notes1.txt -- FAILS 
```

我使用 MMC 控制台将 B 和 A 证书导出到 CER 文件，然后使用 OpenSSL 将它们转换为 PEM。之后，我尝试了以下 2：

```
openssl smime -verify -in test1.tmp -CAfile "A.pem" -out notes1.txt -- FAILS

openssl smime -verify -in test1.tmp -CAfile "B.pem" -out notes1.txt -- FAILS 
```

所有 3 次验证尝试均失败，并出现以下错误：

```
Verification failure
3672:error:21075075:PKCS7 routines:PKCS7_verify:certificate verify error:.\crypt
o\pkcs7\pk7_smime.c:342:Verify error:unable to get local issuer certificate 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-09T22:23:59.150

当您使用`openssl smime verify` openssl 尝试通过检查其签名（即证书中的签名，而不是您要求验证的签名消息中的签名）来验证它要使用的证书是否受信任。为此，它必须拥有颁发证书的 CA 密钥的证书副本。

该`-CAfile`参数用于传递包含该 CA 证书的文件的名称，而不是用于签署消息的密钥的证书。您将使用参数指定用于签署消息的密钥`-certfile`的证书......但在您的情况下，证书将在`test.tmp`文件中（您可以通过指定`-nocerts`何时签署消息来抑制它）。

要在验证消息时禁止检查密钥证书，您可以将`-noverify`参数提供给 verify 命令（虽然`openssl smime verify -noverify`看起来有点奇怪）。

# knockout.js - 使用 ko.validation 一次验证一个属性

> ID：12790583
> 
> 赞同：1
> 
> 时间：2012-10-08T22:50:29.647
> 
> 标签：knockout.js, knockout-validation

我正在使用[ko.validation](https://github.com/ericmbarnard/Knockout-Validation)，以前，我使用它来一次验证整个视图模型。现在，我将视图模型拆分为多个部分，并且我需要能够一次验证一个或几个属性。我有几个自定义验证器，所以我宁愿不只是切换到完全手动验证。有没有办法使用 ko.validation 一次只验证一个属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T01:17:40.207

对于需要在多个视图中重复使用的视图模型，或者当一个视图需要同一视图模型的多个实例，但具有不同的验证要求（注释中的引用）时，这是一个越来越常见的问题。Knockout 和 Knockout-Validation 非常棒，但是当前的实现还不能很好地扩展到这些可重用性场景。

[我最近在为Extreme Engineering Solutions](http://www.xes-inc.com/)工作时开发的开源项目“ValidatedViewModel”提供了一种基于实例构建验证约束组应用程序的方法。[在 github 上](https://github.com/carlschroedl/validatedviewmodel)克隆经过验证的视图模型。请让我知道您对文档、单元测试和功能的看法。

# macos - 如何解决所有命令都进入空白行的 git config 问题？

> ID：12790584
> 
> 赞同：1
> 
> 时间：2012-10-08T22:50:44.583
> 
> 标签：macos, git, configuration

我对 git 并不陌生，但我对 github 较新，并且仍然是 bash 的初学者。我试图设置一些配置内容并最终在我的本地机器上破坏了 git。这是我按照[github 上的这些说明进行的密码缓存操作](https://help.github.com/articles/set-up-git)。

```
$ git config --global user.name 'myusername'
$ git config --global user.email 'myemail@email.com'
$ git credential-osxkeychain
git: 'credential-osxkeychain' is not a git command. See 'git --help'.
$ curl -s -O http://github-media-downloads.s3.amazonaws.com/osx/git-credential-osxkeychain
$ chmod u+x git-credential-osxkeychain
$ which git
/usr/bin/git
$ sudo mv git-credential-osxkeychain /usr/bin/git
$ git config --global credential.helper osxkeychain
^?^C 
```

在这个命令 git 之后，我没有收到任何响应，只是一个新行，我最终 ctrl+c'ed 出来了。现在，每当我在*任何*repo 中执行 git 命令时，不仅仅是这个，光标只会移动到新行。我无法推/拉/克隆或使用我通常使用的命令。

我已经尝试重新安装最新版本的 git，但仍然有问题。我该怎么办？

**更新：**

我已经尝试取消设置 credential.helper 并卸载并重新安装 git。仍然看到相同的行为。我注意到，如果我运行只是`$ git`响应是`Usage: git credential-osxkeychain <get|store|erase>`. 此时，我只想删除 credential-osxkeychain。还是不成功。

根据要求， -a git 的输出是：

```
$ which -a git
/usr/bin/git
/usr/local/git/bin/git 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T22:58:58.957

当您运行此命令时：

```
$ sudo mv git-credential-osxkeychain /usr/bin/git 
```

您用可执行文件覆盖了现有`git`的可执行`git-credential-osxkeychain`文件。该脚本仅作为 Git 的子命令运行，而不是独立运行。

如果您使用 Time Machine，您可以尝试`/usr/bin/git`从备份中恢复旧的。否则，您需要重新安装 Git。

* * *

根据下面的评论，看起来它`/usr/bin/git`实际上仍然是`git-credential-osxkeychain`，可能是因为 Git 将自己安装到`/usr/local`而不是`/usr/bin`.

如果您不再关心钥匙串行为，则可以`git`完全删除当前的可执行文件：

```
$ sudo rm /usr/bin/git 
```

`/usr/local/git/bin`如果在您的路径中，这可能会导致 Git 立即开始为您工作。或者您可以简单地将其移至`/usr/local/git/bin/git-credential-osxkeychain`：

```
$ sudo mv /usr/bin/git /usr/local/git/bin/git-credential-osxkeychain 
```

哪个（再次假设您的路径是正确的）应该允许您将其用作您最初想要的凭证助手。

# c - RGB原始图像的简单模糊

> ID：12790589
> 
> 赞同：3
> 
> 时间：2012-10-08T22:51:27.173
> 
> 标签：c, opengl, image-processing, rgb

我正在尝试在 c 中制作一个简单的模糊效果。我在 512*512 RGB 像素数组中加载了一个图像，我正在使用 3x3 内核来模糊该图像

这是内核

```
float matrix[9] = {1.0f/9.0f, 1.0f/9.0f, 1.0f/9.0f, 1.0f/9.0f, 1.0f/9.0f, 1.0f/9.0f, 1.0f/9.0f, 1.0f/9.0f, 1.0f/9.0f}; 
```

这是进行模糊处理的代码

```
void useBlur(){

  for(int i = 0; i < ARRAY_SIZE; i++){
      float r = 0;
      float g = 0;
      float b = 0;
      int m, n;

      for(int y = -1,  m = 0; y <= 1; y++, m++){
          for(int z = -1,  n = 0; z <= 1; z++, n++){
              r += (float)orig_image[i + 512 * y + z].r * (float)matrix[m*3+n];
              g += (float)orig_image[i + 512 * y + z].g * (float)matrix[m*3+n];
              b += (float)orig_image[i + 512 * y + z].b * (float)matrix[m*3+n];
          }

      }

      image[i].r = r;
      image[i].g = g;
      image[i].b = b;

  }
} 
```

我不确定该代码有什么问题，但它正在产生结果：

![在此处输入图像描述](../Images/187f6427dbcdf8c8fea84d1d673a2b28.png)

任何想法为什么颜色是错误的？以及如何解决？

编辑：将矩阵 [7] 从 9.0/9.0 固定到 1.0/9.0 并上传新图像

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T23:39:16.897

我尝试了您的代码进行了一些更改，我拥有的图像是 BGRA，并且我将 opencv 用于我的图像容器，但是代码的结构是相同的并且可以完美运行。

```
 for (int i = 2*image.cols; i < image.rows*image.cols-2*image.cols; i++)
    {
        float r = 0;
        float g = 0;
        float b = 0;

        for (int y = -1; y <=1; y++)
        {
            for (int z = -1; z <=1; z++)
            {
                b += (float)image.at<cv::Vec4b>(i + image.cols*y+z)(0)*(1.0/9);
                g += (float)image.at<cv::Vec4b>(i + image.cols*y+z)(1)*(1.0/9);
                r += (float)image.at<cv::Vec4b>(i + image.cols*y+z)(2)*(1.0/9);
            }
        }
        image.at<cv::Vec4b>(i)(0) = b;
        image.at<cv::Vec4b>(i)(1) = g;
        image.at<cv::Vec4b>(i)(2) = r;
    } 
```

我认为这意味着问题不在您发布的代码中，或者 opencv cv::Mat 类正在处理您的图像容器没有的东西。显而易见的候选者是您似乎在代码末尾隐式地从 float 转换为 uchar。你能测试在你的图像上运行这个循环但不修改它吗？它可能看起来像这样，或任何其他方式。这很丑陋，但转换很快。

```
void useBlur(){

for(int i = 0; i < ARRAY_SIZE; i++){
  float r = 0;
  float g = 0;
  float b = 0;
  int m, n;

  for(int y = -1,  m = 0; y <= 1; y++, m++){
      for(int z = -1,  n = 0; z <= 1; z++, n++){
          if(y == 0 && z == 0)
          {
            r += (float)orig_image[i + 512 * y + z].r * (float)matrix[m*3+n]*9;
            g += (float)orig_image[i + 512 * y + z].g * (float)matrix[m*3+n]*9;
            b += (float)orig_image[i + 512 * y + z].b * (float)matrix[m*3+n]*9;
          }
      }

  }

  image[i].r = r;
  image[i].g = g;
  image[i].b = b;

 }
 } 
```

理论上，当您这样做时，图像不会发生任何变化，因此如果图像发生变化，那是因为一些转换错误。我承认这个理论不太可能，但你的代码结构似乎很合理，所以我不知道还有什么建议。

# java - 使用 Java 锁实现数据库并发

> ID：12790593
> 
> 赞同：1
> 
> 时间：2012-10-08T22:52:00.117
> 
> 标签：java, database, concurrency

我有以下情况。我有两张桌子。一个存储作为交易计数器的多个值。通过 java 应用程序，第一个表值被读取、递增并写入第二个表，以及新值被写回第一个表。显然，这可能会出错，因为它是一个多用户系统。在 Java 中，我对这个问题的解决方案是提供锁，在对任一表执行任何操作之前，必须，而且*应该，获取锁。*这些锁 ReentrantLocks 是静态的，表 1 中的每一列都有一个锁，因为它们的值完全相互独立。

这是推荐的方法吗？

干杯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T22:55:24.017

**否**。对数据库并发使用*隐式数据库锁*¹。关系数据库支持作为[ACID](http://en.wikipedia.org/wiki/ACID)重要组成部分的事务：使用它们。

以 Java 为中心的锁*不能跨 VM 工作*，因此在多用户/服务器环境中*无济于事。*

* * *

¹数据库足够智能，可以获取/释放锁以确保一致性和隔离性，甚至可以使用“无锁”实现，例如 MVCC。在*极少数*情况下必须请求显式数据库锁，但这是一个高级用例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T00:22:17.130

虽然同意@pst 回答的一些观点，但我会说这略有不同。

如果事件序列本质上是并且可能永远都是“面向 SQL”的，那么您也可以在数据库级别进行锁定（实际上，可能通过使用事务隐式地进行）。

但是，如果在您的应用程序层中存在或您计划构建**重要的数据操作逻辑**（通常或在此特定操作的情况下），则在应用程序级别锁定可能更合适。（实际上，您可能仍会在事务中运行 SQL，以便您实际上在两个级别上都锁定。）

对于依赖 DB 级锁定，我认为多个 VM 的问题本身并不一定是一个引人注目的问题。如果您有多个服务器应用程序访问数据库，则无论如何您都希望建立一个定义良好的协议，在什么情况下同时访问数据。在一个中等复杂度的系统中，无论如何您都希望建立一个对数据运行定期健全性检查的系统。（即使您的服务器应用程序在 100% 的时间里都表现完美，后端技术支持永远不必在您的应用程序之外的数据库上运行一些杂项 SQL...？）

# gcc - gcc -L 路径和 -l 库的顺序列表

> ID：12790594
> 
> 赞同：1
> 
> 时间：2012-10-08T22:52:02.680
> 
> 标签：gcc, makefile

我正在看`Makefile`别人写的，我看到（在变量扩展之后）他`gcc`用一个顺序的`-L`路径列表调用，然后是`-l`库。

例如：

```
gcc file.o -Lpath_1 -la -lb -c -Lpath_2 -ld -le -lf ... -o binary_file 
```

我的问题是：

*   这个电话是否保证`gcc`：
    *   **仅**`path1`在搜索`-la`,`-lb`和`-lc`,时查看
    *   并且**仅**在`path2`搜索`-ld`,`-le`和`-lf`?
*   这是“正确的”（推荐的）gcc 语法吗？

# osx-mountain-lion - Quartz Composer 使用视频捕获输出作为 GLSL 着色器 environmnet

> ID：12790595
> 
> 赞同：2
> 
> 时间：2012-10-08T22:52:10.357
> 
> 标签：osx-mountain-lion, quartz-composer

LS,

一年前，我在 Snow Leopard (SL) 上使用 Quartz Composer 制作了一个非常简单的屏幕保护程序。

屏幕保护程序使用“视频捕获”补丁捕获内置摄像头的输入，并将图像用作“GLSL 着色器”补丁的环境参数的输入，如 GLSL Environment Map.qtz 股票示例中所示。着色器反过来将视频捕捉映射到著名的 3D 茶壶上，创造出镀铬茶壶镜像 iMac 或 MB 前的人的错觉。您可以在此处找到屏幕保护程序：[压缩 QC 源](http://www.twan.com/screensaver/mirrored_teapot.qtz.zip)

在 Mountain Lion (ML) 下，视频捕获的输出无法用作 GLSL 着色器补丁环境的输入。

视频捕获仍然有效。因为您仍然可以将其用作茶壶补丁的图像参数的输入。

此外，我将屏幕保护程序作为屏幕保护程序运行还是在 QC 运行程序中运行都没有关系。

有人知道发生了什么吗？问题归结为：为什么在 ML 下无法使用视频捕获输出作为 GLSL 着色器补丁的环境？

屏幕保护程序虽然简单，但很受欢迎，如果人们不能再享受它，那就太可惜了。

我热切期待一个解决方案！

# ios - 如何使用自定义 URL 方案从 iOS 应用程序发布到 Facebook 应用程序的链接？

> ID：12790598
> 
> 赞同：3
> 
> 时间：2012-10-08T22:52:25.497
> 
> 标签：ios, facebook, url-scheme

我正在创建一个 iOS 应用程序（使用 Adob​​e AIR），我想在我的游戏中添加一个分享按钮，让玩家可以分享我的游戏的链接。我可以使用我的应用程序的令牌使用 Graph API 来做到这一点，但我不希望我的应用程序发布故事。我希望本机 Facebook 应用程序打开并带来一个共享对话框。我所有的研究都认为我使用了自定义 URL 方案，`fb://publish/?text=my_text`但我无法让它工作。我尝试在 Safari 中准确输入，它带来了本机 Facebook 应用程序，但没有发布对话框或任何东西。网上的所有消息来源都告诉了这一点，但它不起作用。我可能做错了什么？

# regex - 检查输入的正则表达式不为空加上 它的字母数字？

> ID：12790601
> 
> 赞同：4
> 
> 时间：2012-10-08T22:52:34.333
> 
> 标签：regex

我需要一个正则表达式来检查输入是否不能为空，并且输入是否只有字母数字字符。

我知道字母数字部分，`^[\s+0-9a-zA-Z]+$`但我不确定非空要求。

我只能使用一个表达式，不能使用任何语言函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T03:34:42.480

只需使用此正则表达式来匹配非空字母数字字符串：

```
^[a-zA-Z0-9]+$ 
```

*细节*

*   `^`- 字符串开始
*   `[a-zA-Z0-9]+`- 一个或多个字母或数字
*   `$`- 字符串结束。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T22:56:13.283

我将假设 Not empty 你的意思不仅是空白，否则你就会得到你想要的答案。`+`表示一个或多个。

```
^[a-zA-Z0-9][a-zA-Z0-9\s]*^ 
```

将确保字符串中包含除空格以外的其他内容。

~~此外，如果`\s`是有效的，那么我假设`\w`也是如此，这意味着这可以更容易地说为~~

 ~~```
^[(?:\w|\s)*$ 
```~~ 

`?:`中的使其`( )`成为非捕获组。如果您不关心捕获，则可以省略它，使其非常简洁。

```
^\w(\w|\s)*$ 
```

# javascript - JavaScript 中 (new Date()).toDateString() 的可能返回值？

> ID：12790604
> 
> 赞同：3
> 
> 时间：2012-10-08T22:52:56.090
> 
> 标签：javascript, date

`(new Date()).toDateString()`的返回值为`"Mon Oct 08 2012"`。但是，我在任何地方都找不到任何文档来说明一周中其余几天和几个月的缩写是什么。它们都只是3个字符的缩写吗？我正在尝试编写一个正则表达式。

可以找到文档甚至源代码的人 +100 万分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T23:01:01.573

三字母缩写，首字母大写。

*   月份：一月、二月、三月、四月、五月、六月、七月、八月、九月、十月、十一月、十二月
*   日子：周日，周一，周二，周三，周四，周五，周六

但是，您可能希望查看 Date.Parse() 而不是使用正则表达式来解析日期字符串，具体取决于您正在做什么。

编辑：请注意 Date.Parse() 相当依赖于浏览器。查看[为什么 Date.parse 给出不正确的结果？](https://stackoverflow.com/questions/2587345/javascript-date-parse)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T22:56:13.143

它只是日和月的标准英语缩写。只有前 3 个字母和第一个大写。

来自[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/toDateString)：

> 日期实例是指特定的时间点。调用 toString 将返回格式为**美式英语的人类可读格式的日期**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T23:01:46.680

不难发现：

W3Schools：[http ://www.w3schools.com/jsref/jsref_todatestring.asp](http://www.w3schools.com/jsref/jsref_todatestring.asp)

Mozilla 开发者网络：[链接](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/toDateString)

微软开发者网络：[链接](http://msdn.microsoft.com/es-es/library/microsoft.jscript.dateprototype.todatestring%28v=vs.90%29.aspx)

正如你所看到的，它们都收敛了，它的星期几，月份的名字，都有 3 个字符，月份和全年。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-08T23:04:25.660

[规范](http://es5.github.com/#x15.9.2)没有定义字符串的输出：

> String 的内容取决于实现，但旨在以方便、人类可读的形式表示当前时区中 Date 的“日期”部分。

这可能会在未来发生变化，但就目前而言，每个浏览器/环境都可以产生不同的输出。

# django - 在 Django 中，如何告诉我的项目在运行时在不同的日志目录中读/写？

> ID：12790607
> 
> 赞同：1
> 
> 时间：2012-10-08T22:53:53.837
> 
> 标签：django, testing, logging

我正在开发一个 django 项目，该项目除了有一个用于其模型和关系的数据库外，还写入一个名为`activity_logs`项目目录之外的日志目录，以跟踪格式化的用户活动，每个用户一个文件。这是另一种基于文件结构的解决方案，而不是让数据库表携带这些信息，因为这会从数据库中卸载一些存储，并且相对容易格式化和表达此类活动。也许你们中的一些人可能会建议将这种数据存储在数据库中，这很好，但我仍然相信所有这些都存在我需要帮助回答的问题。

这个 django 项目有多个应用程序，它们具有广泛的测试套件，每个应用程序一个。此外，还有一个`logging.py`文件封装了日志记录功能（向/从日志文件写入/读取活动），因此测试套件中的测试用例以及视图功能（以及各种其他实用程序功能）都使用这些日志记录功能，以便存储这些用户活动并根据模型关系检索它们以模拟用户通知系统。由于 logging 模块负责此日志记录，它需要知道写入到哪里，因此我们有一个名为的目录结构`activity_logs`它向其中写入用户日志文件，为新用户创建一个，为从数据库中删除的用户删除一个。我们希望在这个项目中进行的最新更改之一是创建一个单独的日志目录来测试此日志记录功能，例如`test_activity_logs`，以便在写入测试用户的测试目录或常规活动日志时不会混淆真实用户的目录。

我的问题是：在运行时，我如何告诉系统，无论是在哪个执行起点（无论是通过 django 测试`Client`对象的视图函数调用、测试用例、通过 URL 发出的实际 HTTPrequest 等） ，什么时候看里面的`activity_logs`还是`test_activity_logs`目录？这完全取决于我是为真实用户还是测试用户生成新信息，但是用户是我们系统中的用户，我在试图告诉这些调用一些日志记录函数的函数写入到测试日志目录与常规目录。例如，我正在尝试的一种方法是将关键字参数 (kwarg) 传递给日志记录函数，以便它们可以知道要读/写哪个目录，如下所示：

`self.assertTrue(activity_has_been_logged(ACTIVITY_ACCOUNT_CREATED, user.get_profile(), use_test_activity_log_directory=True) == True)`

调用的 kwarg`use_test_activity_log_directory=True`将告诉调用的日志记录函数`activity_has_been_logged`读取测试活动日志目录。不幸的是，除了有点不灵活（但可以容忍）之外，这并不能解决 django 测试`client`对象通过 URL 将 GET 或 POST 请求发送到将活动写入日志文件的视图函数的情况：

`response = client.post(propose_match_url, post) #Can't write to test_log_directory if by default it writes to regular directory!`

如何让客户端将此 kwarg 传递给那些视图函数？我认为完全可以做到这一点，但我不确定摆弄这些 kwargs 是否是最好的方法，或者可能在项目设置文件中创建一个全局变量，但这可能会导致一些竞争条件问题具有共享的可变变量。

你的帮助会很棒。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T06:08:00.003

所以我刚刚解决了这个问题。托管所有日志功能的日志文件实际上是唯一需要知道在哪里查找（`test_activity_logs`或`activity_logs`）的地方，因为所有其他组件将调用来自日志模块的函数来写入/读取这些目录/从这些目录中读取。`UserProfile`我为名为的类的模型类提供了一个附加字段，该`is_test`字段是一个布尔字段，用于确定是否查看`test_activity_logs`if`is_test=True`或`activity_logs`if `is_test=False`。这样，日志记录模块只需检查类型的输入参数`UserProfile`及其新字段即可确定在何处执行其日志记录功能。问题解决了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T22:59:56.810

如果您在 *nix 机器上或在 OS X 上启动，请查看 daemontools。两者都可以确保您的 Django 实例保持在您喜欢的任何模式下运行（daemontools 有更多选项）并且可以隔离用于记录标准输出的目录/标准错误。

您可以为每个实例设置环境变量，以帮助其他日志文件和临时文件知道在哪里创建，然后您可以从 os.environment 获取这些文件，或者如果使用 daemontools，则只需使用当前工作目录作为基础。

该目录是使用 daemontools 自动为您创建的。

# java - Java构建时间常数配置

> ID：12790609
> 
> 赞同：2
> 
> 时间：2012-10-08T22:54:11.230
> 
> 标签：java, ant, annotations, constants, final

我有一个想要使用多种配置构建的项目。我有一个常量需要在构建之间有所不同，但我不知道如何根据我的配置更改它。

例如，我希望能够根据配置文件中的值执行以下操作。

```
@WebService(targetNamespace = "http://example.com/")
public class CustomerWebService { 
```

和

```
@WebService(targetNamespace = "http://demo.example.com/")
public class CustomerWebService { 
```

我们使用 ant 进行构建。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T23:46:21.117

我建议尝试模拟 Maven 资源过滤和配置文件属性

# 源过滤

## src/模板/MyFile.java

```
..
@WebService(targetNamespace = "@WS_NAMESPACE@")
public class CustomerWebService {
.. 
```

## 构建.xml

```
<target name="filter-sources">
    <copy todir="${build.dir}/src">
       <fileset dir="src/templates" includes="**/*.java"/>
       <filterset>
          <filter token="WS_NAMESPACE" value="${ws.namespace}"/>
       </filterset>
    </copy>
</target>

<target name="compile" depends="filter-sources">
    <javac destdir="${build.dir}/classes">
        <src path="src/java"/>
        <src path="${build.dir}/src"/>
        <classpath>
        ..
        ..
    </javac>
</target> 
```

笔记：

*   ANT 复制任务能够执行模板替换。

# 构建配置文件

## 属性文件

每个配置都有不同的属性文件

```
src/properties/dev.properties
src/properties/qa.properties
src/properties/prod.properties
.. 
```

## 构建.xml

```
<property name="profile" value="dev"/>
<property file="src/properties/${profile}.properties"/> 
```

## 选择替代构建配置文件

```
ant -Dprofile=qa .. 
```

# php - 用这个 php 代码创建一个函数

> ID：12790610
> 
> 赞同：2
> 
> 时间：2012-10-08T22:54:23.780
> 
> 标签：php

我只需要一些帮助，用这段代码创建一个 php 函数，或者换句话说，只是将这个代码包装在一个 php 函数中：

```
if (isset($_GET['id'])){

    $username = mysql_real_escape_string($_GET['id']);

    if(ctype_alnum($username)){

        $check = mysql_query("SELECT username,first_name FROM users WHERE username='$username'");
        if(mysql_num_rows($check)===1){

            $get = mysql_fetch_assoc($check);
            $username = $get['username'];
            $firstname = $get['first_name'];

            echo '<div id="mini_profile">This is '.$username.'\'s profile.</div>';

            }else{

            header("Location: index.php");
            exit();

            }
        }
    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T22:56:29.240

真的很容易:)

```
function yourFunc() {
if (isset($_GET['id'])){

$username = mysql_real_escape_string($_GET['id']);

if(ctype_alnum($username)){

    $check = mysql_query("SELECT username,first_name FROM users WHERE username='$username'");
    if(mysql_num_rows($check)===1){

        $get = mysql_fetch_assoc($check);
        $username = $get['username'];
        $firstname = $get['first_name'];

        echo '<div id="mini_profile">This is '.$username.'\'s profile.</div>';

        }else{

        header("Location: index.php");
        exit();

        }
    }
}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T23:10:07.830

```
function getMyDivElement($name) {
    $username = mysql_real_escape_string($name);

    if(ctype_alnum($username)) {
        $check = mysql_query("SELECT username,first_name FROM users WHERE username='{$username}'");
        if(is_resource($check) && ($get = mysql_fetch_assoc($check))) {
            $username = $get['username'];
            $firstname = $get['first_name']; //You need this?

            return '<div id="mini_profile">This is '.$username.'\'s profile.</div>';
        }
    }

    return null;
}

//usage
if (isset($_GET['id'])) {
    $div = getMyDivElement($_GET['id']);
    if($div) {
        echo $div;
    } else {
        header("Location: index.php");
        exit();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T23:02:29.540

另一种方法是将 echo 语句作为字符串返回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T23:03:14.240

创建函数的想法是提供可重用的代码。这意味着您正在封装逻辑，允许您更改代码的内部工作而不影响函数的实际使用并避免繁琐的重复。

在您的示例中，您应该考虑属于此类别的区域。我个人可以看到这里可以实现的几个功能。

示例，不运行，但应该给你一些想法。

```
<?php

  function getUser($username)
  {
    if (is_string($username) && strlen($username)) {
      $query  = "
        SELECT 
          username, firstname 
        FROM 
          users 
        WHERE 
          username = :username
      ";  
      $result = executeQuery($query, array("username" => $username));
      return $result->fetch();
    }
  }

  function getDatabase($host, $db, $user, $password)
  { 
    return new PDO("mysql:host=$host;dbname=$dbname, $user, $pass");
  }

  function executeQuery($sql, array $params = array())
  {
    $db   = getDatabase();
    $conn = $db->prepare($sql);

    return $conn->execute($params);
  }

  function validateInput($input)
  {
    return ctype_alnum($input);
  }

  function advanceTo($page, $params) 
  {
    header("Location: $page.php");
    exit();
  }

if (isset($_GET["username"])){
  if (validateInput($_GET["username"])) {
    $user = getUser($_GET["username"]);
    if (! empty($user)) {
      // authUserAndSetSessionForUser($user);
      /** This page is then directed to and welcome message shown **/
      advanceTo("user-home-page", array($user));
    } else {
      advanceTo("index");
    }
  }
}

?> 
```

# sql-server - 创建用户配置文件并查找其他表中是否存在值的存储过程

> ID：12790611
> 
> 赞同：0
> 
> 时间：2012-10-08T22:54:24.913
> 
> 标签：sql-server, stored-procedures

我有一个创建用户配置文件的存储过程，我的表单具有以下字段：

```
FirstName,
LastName.
EmailAddress,
ZipCode,
Password 
```

邮政编码是我的 UserProfile 中的一个 FK，类型为 smallint，该值可能存在也可能不存在于名为的表中`Location`：

```
LocationId bigInt (identity index)
ZipCode smallint 
```

有没有办法从我的存储过程中查询该表，如果该项目存在，则在我的存储过程中使用该条目的 PK 吗？

到目前为止，这是我的存储过程

```
CREATE PROCEDURE [dbo].[SP_InsertInitialProfile]

@FirstName          NVARCHAR(1000),
@LastName           NVARCHAR(1000),
@EmailAddress       NVARCHAR(1000),
@ZipCode            SMALLINT,
@Password           NVARCHAR(1000)

AS

IF (SELECT COUNT(1) FROM UserProfile WHERE EmailAddress =@EmailAddress) = 1
BEGIN
    RETURN -1 
END ELSE
BEGIN
    INSERT INTO UserProfile(FirstName,LastName,EmailAddress,Password)
    VALUES(@FirstName,@LastName,@EmailAddress,@Password)

    RETURN  Cast(@@IDENTITY as INT)
END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:15:45.340

你可以像这样做SP：

```
 CREATE PROCEDURE [dbo].[SP_InsertInitialProfile]

            @FirstName          NVARCHAR(1000), 
            @LastName           NVARCHAR(1000), 
            @EmailAddress       NVARCHAR(1000), 
            @ZipCode            SMALLINT, 
            @Password           NVARCHAR(1000)  

            AS 

             varCountNbr number;

            BEGIN

               SELECT COUNT(1) INTO varCountNbr
               FROM 
                  Location
               WHERE 
                 ZipCode=@ZipCode;

               IF  varCountNbr = 0
                     INSERT @ZipCode INTO Location TABLE;
              -- You have to commit here, in order to have the PK value exists.
                     COMMIT;

               INSERT INTO USERPROFILE TABLE;

               COMMIT;

            END; 
```

# html - 我无法让页脚保持居中

> ID：12790615
> 
> 赞同：1
> 
> 时间：2012-10-08T22:54:47.217
> 
> 标签：html, footer

我已经安静地搜索了一下，发现了很多我测试过的 CSS，但是 margin: 0 auto; 没有工作和。我不能让我的页脚保持在中心和底部。我可以让它到底部，我可以让它居中，但不能两者兼而有之。

这是HTML

```
<div align="center">    
    <table class="copyrightbar">    
        <tr>
            <td class="noborder">
                <img  class="ledge" src="images\lefthalfcircle.png">
            </td>
            <td class="noborder" >
            <img class="copyrightimg" src="images\copyright.png">
            </td>
            <td class="noborder">
                <img class="redge" src="images\righthalfcircle.png">
            </td>
        </tr>
    </table>
</div> 
```

这是CSS

```
.copyrightbar
{
   border-collapse: collapse;
   border: 0px;
   padding: 0px;
   float: left;
   position: fixed;
   bottom: 10px;
   display:block;
} 
```

我不确定为什么它不会保持居中或我做错了什么。现在，薄设置为仅停留在底部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T23:05:31.283

试试这个[jsfiddle](http://jsfiddle.net/6rPBU/)

我知道图像实际上并没有显示，但它应该按您的需要显示。

HTML：

```
<div class="wrapper">    
    <table class="copyrightbar">    
        <tr>
            <td class="noborder">
                <img  class="ledge" src="images\lefthalfcircle.png">
            </td>
            <td class="noborder" >
                <img class="copyrightimg" src="images\copyright.png">
            </td>
            <td class="noborder">
                <img class="redge" src="images\righthalfcircle.png">
            </td>
        </tr>
    </table>
</div>​ 
```

CSS：

```
.wrapper {
    position: fixed;
    bottom: 10px;
    width: 100%;
}    

.copyrightbar {
   margin: 0 auto;
   border-collapse: collapse;
   border: 0px;
   padding: 0px;
} 
```

​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:19:42.657

使用 float:left 有什么意义？如果您希望它居中，则将整个元素浮动到左侧没有任何意义，因为它与您想要的完全相反。

但是，如果你想保留它，那么你的包装器 div 应该被赋予一个 id，让我们说 id="footer" 然后使用这个 css

```
#footer {
    width:400px (not sure if that is too wide or not, you can play around with it until it is the right width)
    margin: 0 auto;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T22:58:27.410

将类或 ID 添加到包装器 div。然后使用 CSS 使用 `position: fixed' 将其放置在底部。

然后在您的表格上设置一个宽度（通过 CSS）并使用`margin: 0 auto`您上面提到的声明。（哦，从桌子上删除`position: fixed`）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T23:02:36.087

可能是因为你的 CSS 文件有 { float: left; }?

# c# - 带有类型参数的自定义控件

> ID：12790636
> 
> 赞同：2
> 
> 时间：2012-10-08T22:56:58.743
> 
> 标签：c#, winforms, oop, design-patterns

我正在构建一个扩展 DataGridView 的 WinForms 自定义控件。

```
interface IMyControl<A, B> { }
public partial class MyControl<A, B> : DataGridView, IMyControl<A, B>
{
} 
```

`A`并且`B`是业务领域对象类型。

但是，代码不会编译。`MyControl.Designer.cs`无法编译。

```
protected override void Dispose(bool disposing) //no suitable method found to override
{
    if (disposing && (components != null))
    {
        components.Dispose();
    }
    //'object' does not contain a definition for 'Dispose'
    base.Dispose(disposing); 
} 
```

> 'Infrastructure.MyControl.Dispose(bool)'：找不到合适的方法来覆盖 MyControl.Designer.cs

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:12:50.980

您不能拥有通用控件。

试试这个：

```
interface IMyControl<A, B> { }
public partial abstract class MyControlBase<A, B> : DataGridView, IMyControl<A, B>
{
    // Generic code goes here
}

// Create non-generic wrappers for the generic base class
public partial class MyControl_One : DataGridView, MyControlBase<SomeType, OtherType>
{
     // Type-specific (if any) code goes here
}
public partial class MyControl_Two : DataGridView, MyControlBase<MyType, YourType>
{
     // Type-specific (if any) code goes here
} 
```

将您当前拥有的任何通用代码留在通用基类中。包装类可以非常薄，因为它只用于提供一个非泛型控件来添加到您的表单中。

# core-plot - 你如何使用 CPScatterPlotInterpolationLinear？

> ID：12790637
> 
> 赞同：0
> 
> 时间：2012-10-08T22:57:11.410
> 
> 标签：core-plot, interpolation, scatter-plot

我刚刚通过谷歌搜索“插值”偶然发现了“CPScatterPlotInterpolationLinear”。

这是否意味着我可以通过插值填补散射/线性数据的空白？我之前问过一个类似的问题，并被告知[CP 不会在图中添加点](https://stackoverflow.com/questions/12662898/can-how-core-plot-extrapolate-scatter-points-to-fit-fixed-labeling-policy)。

我试图通过创建一个包含 180 个元素的数组 180 天/6 个月来创建一个 6 个月的固定间隔散点图。缺失的数据/天充满了 [NSNull null] 对象......但 CP 仅绘制非空值而没有插值。

'CPScatterPlotInterpolationLinear' 枚举让我重新思考。

**问题：**如何使用“CPScatterPlotInterpolationLinear”在图表上插入缺失数据？...无需实际添加数据点，只需“连接点”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T00:26:43.887

当您在散点图上设置线条样式时，Core Plot 会将数据点与使用给定样式绘制的线条连接起来。该`interpolation`属性控制点的连接方式：

*   `CPTScatterPlotInterpolationLinear`: 这是默认的。数据点与连续点之间直接绘制的直线相连。

*   `CPTScatterPlotInterpolationStepped`：从每个数据点开始绘制步骤。

*   `CPTScatterPlotInterpolationHistogram`：以每个数据点为中心绘制步骤。

*   `CPTScatterPlotInterpolationCurved`：数据点通过连续点之间绘制的平滑曲线连接。

这些样式都不会添加数据点（即可以用绘图符号或数据标签指示的点）。它们只是连接数据源提供的数据点。

# java - 建议用 Java 解析这个 XML

> ID：12790641
> 
> 赞同：1
> 
> 时间：2012-10-08T22:57:50.153
> 
> 标签：java, xml, xpath, xml-parsing

对 Java 并不陌生；但对于 XML 解析来说相对较新。我对那里的许多 XML 工具知之甚少，但对它们中的任何一个都知之甚少。我也不是 XML 专业人士。

我的特殊问题是……我得到了一个无法修改的 XML 文档，我只需要将它的随机位解析为 Java 对象。只要它是合理的，纯粹的速度并不是一个很大的因素。同样，内存占用空间也不必是绝对最优的，只要不是疯狂的。我只需要通读一次文档来解析它，然后我将把它扔到 bitbucket 中并使用我的 POJO。

所以，我愿意接受建议……您会使用哪种工具？
而且，您能否建议一些入门代码来满足我的特殊需求？

这是我正在尝试制作的示例 XML 和相关 POJO 的片段：

```
<xml>
  <item id="...">
    ...
  </item>
  <metadata>
    <resources>

      <resource>
        <ittype>Service_Links</ittype>
        <links>
          <link>
            <path>http://www.stackoverflow.com</path>
            <description>Stack Overflow</description>
          </link>
          <link>
            <path>http://www.google.com</path>
            <description>Google</description>
          </link>
        </links>
      </resource>

      <resource>
        <ittype>Article_Links</ittype>
        <links>
          ...
        </links>
      </resource>

      ...

    </resources>
  </metadata>
</xml>

public class MyPojo {

    @Attribute(name="id")
    @Path("item")
    public String id;

    @ElementList(entry="link")
    @Path("metadata/resources/resource/links")
    public List<Link> links;
} 
```

注意：这个问题最初是由[这个问题](https://stackoverflow.com/questions/12648363/xpath-simplexml-selection-of-child-based-on-value-of-childs-sibling)产生的，我试图使用 SimpleXml 解决它；我到了我认为也许有人可以提出解决同一问题的不同途径的地步。

另请注意：我真的希望有一个*CLEAN*解决方案......我的意思是，使用注释和/或 xpath 以及最少的代码......我想要的最后一件事是具有巨大笨拙方法的巨大类文件...... . 那个，我已经... 我正在努力寻找更好的方法。

:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T16:22:08.497

好的，所以我确定了一个（对我而言）似乎以最合理的方式满足我的需求的解决方案。我对其他建议表示歉意，但我只是更喜欢这条路线，因为它将大部分解析规则保留为注释，而我必须编写的少量程序代码非常少。

我最终选择了 JAXB；最初我认为 JAXB 要么从 Java 类创建 XML，要么将 XML 解析为 Java 类，但只能使用 XSD。然后我发现 JAXB 有注释，可以将 XML 解析为 Java 类而无需 XSD。

我正在使用的 XML 文件很大而且很深，但我只需要这里和那里的一点点；我担心将来将地图导航到哪里会非常困难。所以我选择构建一个以 XML 为模型的文件夹树……每个文件夹映射到一个元素，每个文件夹中都有一个 POJO 代表该实际元素。

问题是，有时有一个元素有几个级别的子元素，它有一个我关心的属性。仅仅为了访问一个属性而创建 4 个嵌套文件夹和一个 POJO 会很痛苦。但这就是您使用 JAXB 的方式（至少，据我所知）；我又一次在角落里。

然后我偶然发现了[EclipseLink 的 JAXB 实现：Moxy](http://www.eclipse.org/eclipselink/moxy.php)。Moxy 有一个 @XPath 注释，我可以将其放置在该父 POJO 中，并用于向下导航几个级别以访问单个属性，而无需创建所有这些文件夹和元素 POJO。好的。

所以我创建了这样的东西：（注意：我选择在需要按摩值的情况下使用吸气剂）

```
// maps to the root-"xml" element in the file
@XmlRootElement( name="xml" )
@XmlAccessorType( XmlAccessType.FIELD )
public class Xml {

    // this is standard JAXB
    @XmlElement;               
    private Item item;
    public Item getItem() {    
        return this.item;
    }

    ...
}

// maps to the "<xml><item>"-element in the file
public class Item {

    // standard JAXB; maps to "<xml><item id="...">"
    @XmlAttribute              
    private String id;
    public String getId() {
        return this.id;
    }

    // getting an attribute buried deep down
    // MOXY; maps to "<xml><item><rating average="...">"
    @XmlPath( "rating/@average" )    
    private Double averageRating;
    public Double getAverageRating() {
        return this.average;
    }

    // getting a list buried deep down
    // MOXY; maps to "<xml><item><service><identification><aliases><alias.../><alias.../>"
    @XmlPath( "service/identification/aliases/alias/text()" )
    private List<String> aliases;
    public List<String> getAliases() {
        return this.aliases;
    }

    // using a getter to massage the value
    @XmlElement(name="dateforindex")
    private String dateForIndex;
    public Date getDateForIndex() {
        // logic to parse the string-value into a Date
    }

} 
```

另请注意，我将 XML 对象与我在应用程序中实际使用的模型对象分开。因此，我有一个工厂，可以将这些原始对象转换为我在我的应用程序中实际使用的更强大的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:52:49.380

如果您的 XML 文档相对较小（如这里所示），我将使用 DOM 框架和 XPath 类。这是我的一个教程中的一些[样板 DOM/XPath 代码](http://www.javamex.com/tutorials/xml/parsing_xpath_2.shtml)：

```
File xmlFile = ...
DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
DocumentBuilder db = dbf.newDocumentBuilder();
Document doc = db.parse(xmlFile);

XPath xp = XPathFactory.newInstance().newXPath();
String value = xp.evaluate("/path/to/element/text()", doc);
// .. reuse xp to get other values as required 
```

换句话说，基本上你：

*   通过 DocumentBuilder 将您的 XML 转换为 Document 对象；

*   创建一个 XPath 对象；

*   重复调用 XPath.evaluate()，传入所需元素的路径和您的 Document。

如您所见，在获取 Document 对象时有一点复杂性，并且与所有优秀的 XML API 一样，它会引发大量愚蠢且无意义的检查异常。但除此之外，对于结构相对固定的简单中小型 XML 文档的解析是相当严肃的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T08:11:34.077

您可以使用 SAXParser 或 STAXParser。如果您能负担得起更多的内存，那么您也可以负担得起使用 DOMParser。我建议 STAXParser 最适合你。

# perl - 将 utf-8 转换为 html &...;

> ID：12790643
> 
> 赞同：1
> 
> 时间：2012-10-08T22:58:04.617
> 
> 标签：perl

在 Perl 中，如何将包含 utf-8 字符的字符串转换为 HTML，其中这些字符将转换为**&...;** ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T23:16:09.473

首先，拆分一个空模式以获取单个字符的列表。然后，将每个字符映射到自身，如果它是 ASCII，或者它的代码，如果不是：

```
use Encode qw( decode_utf8 );

my $utf8_string = "\xE2\x80\x9C\x68\x6F\x6D\x65\xE2\x80\x9D";
my $unicode_string = decode_utf8($utf8_string);

my $html = join q(),
    map { ord > 127 ? "&#" . ord . ";"
                    : $_
        } split //, $unicode_string; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-16T15:54:21.703

`ord`只需简单地计算其+ 必要的 HTML 实体格式，即可替换每个不可打印且非低 ASCII 符号（即 \x20 - \x7F 区域之外的任何符号） 。Perl 正则表达式有`/e`标志来指示替换应该被视为代码。

```
use utf8;
my $str = "testТест"; # This is correct UTF-8 string right in the code
$str =~ s/([^[\x20-\x7F])/"&#" . ord($1) . ";"/eg;
print $str;
# test&#1058;&#1077;&#1089;&#1090; 
```

# javascript - 如何在textarea中滚动背景图像和文本？

> ID：12790645
> 
> 赞同：10
> 
> 时间：2012-10-08T22:58:13.273
> 
> 标签：javascript, css, html

我知道这有点难以解释，但是通过查看下面的代码，您会有所了解，情况是我有一个带有线条背景的文本区域（类似于笔记本，图像样式重复），文本区域也变成了例如固定高度。300px，所以我的问题是当滚动条出现时，我想将线条与文本粘在一起，现在文本正在滚动，背景线保持在固定位置..

请告诉我您的建议，是否可以将背景线与文本一起滚动？

这是我的html代码..

```
<div style="width:500px; height:300px; margin:0px auto; background:#ebebeb;">
<textarea style="width:100%; height:300px; background:url(line.jpg) repeat; line-height:30px; font-size:20px; font-family:Georgia, 'Times New Roman', Times, serif;" name="" cols="" rows=""></textarea>
</div> 
```

在这里你可以看到图像 - { ![在此处输入图像描述](../Images/c20d71261c8675515f1fb97a66316ffe.png)}

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-08T23:33:02.803

`background-attachment: local;`在设置背景图像后使用。

# [*演示*](http://dabblet.com/gist/3855623)

适用于 IE9+、Safari 5+、Chrome 和 Opera

在 Firefox 中不起作用 - 请参阅[此](https://bugzilla.mozilla.org/show_bug.cgi?id=483446)。

**HTML**：

```
<div>
    <textarea>
        background-attachment: local;
        <!-- and so on, many more lines -->
        background-attachment: local;
    </textarea>
</div> 
```

**CSS**：

```
div {
    width: 500px;
    margin: 0 auto;
    background: #ebebeb;
}
textarea {
    display: block;
    width: 100%;
    height: 300px;
    background: url(http://i.stack.imgur.com/EN81e.jpg);
    background-attachment: local;
    font: 20px/1.5 Georgia, 'Times New Roman', Times, serif;
} 
```

* * *

# 编辑

另一个[*更好的兼容性解决方案*](http://caniuse.com/contenteditable)（仅在其中不起作用的浏览器是 Opera Mobile 和 Opera Mini）将不使用 a `textarea`，而是`div`使用具有[**`contenteditable`**](http://html5doctor.com/the-contenteditable-attribute/)属性的另一个。

# [*演示*](http://dabblet.com/gist/3855704)

**HTML**：

```
<div class='outer'>
    <div class='inner' contenteditable='true'>
        background-attachment: local;
                <!-- more stuff -->
        background-attachment: local;
    </div>
</div> 
```

**CSS**：

```
.outer {
    overflow-y: scroll;
    width: 500px;
    height: 300px;
    margin: 0 auto;
    background: #ebebeb;
}
.inner {
    width: 100%;
    min-height: 300px;
    background: url(http://i.stack.imgur.com/EN81e.jpg);
    font: 20px/1.5 Georgia, 'Times New Roman', Times, serif;
} 
```

# android - 覆盖 OnConfigurationChanged 时，视图仍会旋转

> ID：12790648
> 
> 赞同：0
> 
> 时间：2012-10-08T22:58:42.197
> 
> 标签：android, android-layout, android-softkeyboard, android-orientation

对于我当前的活动，我目前在清单中添加了以下内容：

```
android:configChanges="orientation|keyboardHidden|screenSize" 
```

在他的实际活动中，我重写了 OnConfigurationChanged 方法，如下所示：

```
@Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);

    if (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE) {
        Toast.makeText(this, "landscape", Toast.LENGTH_SHORT).show();
    } else if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT){
        Toast.makeText(this, "portrait", Toast.LENGTH_SHORT).show();
    }
} 
```

活动中的视图仍在旋转，但我想指定其中一些不应该旋转。

有谁知道如何避免活动中**所有**UI 元素的不可避免的轮换？

这里需要注意的是，*当键盘被激活时，我仍然需要操作系统以横向模式打开键盘*——我只是不希望其他视图旋转。我相信这意味着强制活动处于纵向模式（我知道该怎么做）将不起作用，除非有人知道如何在活动处于纵向模式时以横向模式专门打开软键盘。

先感谢您。

# deployment - 管理 mvc 应用程序的发布配置文件

> ID：12790650
> 
> 赞同：0
> 
> 时间：2012-10-08T22:58:59.090
> 
> 标签：deployment, asp.net-mvc-4, visual-studio-2012, publish-profiles

我正在开发一个 MVC 4 Web 应用程序 VS2012。

对于这样的应用程序，我通常创建一个 msi 来安装应用程序，但对于这个项目，我正在转向更现代的发布机制。我通常安装到不同的环境：

*   开发者
*   qa（服务器 1、2、3）
*   分期
*   产品（服务器 1、2、3）

问题是，我是否需要为每个环境创建一个发布配置文件，包括 qa 和 prod 上的每个服务器的配置文件（因为 1 个 Web 配置设置因服务器而异）。

似乎需要为此创建大量发布配置文件。我对么？管理发布配置文件的最佳方式是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T12:33:50.310

发布配置文件专为您所描述的内容而设计。它们允许您在每个服务器的基础上指定不同的发布配置。

我不确定你的意思是什么`What is the best way to manage the publish profiles?`。VS 2012.2 将在解决方案中为您管理这些。

您还可以右键单击发布配置文件并为该特定发布配置文件添加 Web 配置转换。

Sayed Hashimi 有一个很好的视频来解释这一点。[http://www.youtube.com/watch?v=HdPK8mxpKEI](http://www.youtube.com/watch?v=HdPK8mxpKEI)

# ios - 无尽的无限滚动视图

> ID：12790654
> 
> 赞同：-1
> 
> 时间：2012-10-08T22:59:35.063
> 
> 标签：ios, animation, uiscrollview, scrollview

有没有办法产生一个垂直滚动视图，它会产生无限连续滚动的错觉？

Apple 已经发布了一个名为 StreetScroller 的示例代码，它可以为水平滚动视图执行此操作，但可以为垂直滚动视图复制吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T00:14:43.730

试试[这](https://github.com/caesarcat/InfinitePagingView "这个")是一个很棒的控件，允许水平和垂直无限滚动。

# linux - 调度程序中的 sched_feat 宏是什么意思

> ID：12790656
> 
> 赞同：3
> 
> 时间：2012-10-08T22:59:38.677
> 
> 标签：linux, linux-kernel, kernel

以下宏定义在`./kernel/sched/sched.h`

```
#define sched_feat(x) (static_branch_##x(&sched_feat_keys[__SCHED_FEAT_##x]))
#else /* !(SCHED_DEBUG && HAVE_JUMP_LABEL) */
#define sched_feat(x) (sysctl_sched_features & (1UL << __SCHED_FEAT_##x))
#endif /* SCHED_DEBUG && HAVE_JUMP_LABEL */ 
```

我无法理解它扮演什么角色。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T06:25:43.997

The `sched_feat()` macro is used in scheduler code to test if a certain scheduler feature is enabled. For example, in `kernel/sched/core.c`, there is a snippet of code

```
int mutex_spin_on_owner(struct mutex *lock, struct task_struct *owner)
{
        if (!sched_feat(OWNER_SPIN))
                return 0; 
```

which is testing whether the "spin-wait on mutex acquisition if the mutex owner is running" feature is set. You can see the full list of scheduler features in `kernel/sched/features.h` but a short summary is that they are tunables settable at runtime without rebuilding the kernel through `/sys/kernel/debug/sched_features`.

For example if you have not changed the default settings on your system, you will see "OWNER_SPIN" in your `/sys/kernel/debug/sched_features`, which means the `!sched_feat(OWNER_SPIN)` in the snippet above will evaluate to false and the scheduler code will continue on into the rest of the code in `mutex_spin_on_owner()`.

The reason that the macro definition you partially copied is more complicated than you might expect is that it uses the [jump labels](https://lwn.net/Articles/436041/ "jump labels") feature when available and needed to eliminate the overhead of these conditional tests in frequently run scheduler code paths. (The jump label version is only used when `HAVE_JUMP_LABEL` is set in the config, for obvious reasons, and when `SCHED_DEBUG` is set because otherwise the scheduler feature bits can't change at runtime) You can follow the link above to lwn.net for more details, but in a nutshell jump labels are a way to use runtime binary patching to make conditional tests of flags much cheaper at the cost of making changing the flags much more expensive.

You can also look at the [scheduler commit that introduced jump label use](https://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=f8b6d1cc7dc15cf3de538b864eefaedad7a84d85) to see how the code used to be a bit simpler but not quite as efficient.

# java - 手动创建表单

> ID：12790657
> 
> 赞同：1
> 
> 时间：2012-10-08T22:59:54.207
> 
> 标签：java, user-interface, layout, jform

我正在尝试使用代码而不是设计器手动创建表单，我已经使用设计器创建了。

![在此处输入图像描述](../Images/1675b6f9d348ad43e4a2aa481611ebb3.png)

这是我到目前为止提出的手动代码，但我在并排对齐标签和文本字段时遇到问题

```
mport java.awt.*;
import javax.swing.*;
/**
 *
 * @author jackandjill
 */
public class summinup_copy extends JFrame
{
    private JLabel lblTitle, lblOctal, lblDecimal, lblMessage ;

private JTextField txtOctal, txtDecimal;

private JButton calculate_btn;

public  summinup_copy()       

{

JPanel panel = (JPanel)this.getContentPane();

panel.setLayout(new BorderLayout());

JPanel panCentre = new JPanel();

panCentre.setLayout(new GridLayout(3,3));

lblTitle = new JLabel("Area of Triangle");

lblTitle.setFont(new Font("Arial", 1, 20));

lblTitle.setHorizontalAlignment(JLabel.CENTER);

lblOctal = new JLabel("Octal");

lblOctal.setHorizontalAlignment(JLabel.CENTER) ;

//lblDecimal = new JLabel("Decimal");
//
//lblDecimal.setHorizontalAlignment(JLabel.CENTER);

lblMessage = new JLabel("Result will be displayed here");

lblMessage.setForeground(Color.red);

lblMessage.setHorizontalAlignment(JLabel.CENTER);

txtOctal = new JTextField("0", 5);

txtOctal.setHorizontalAlignment(JLabel.CENTER); 
//txtDecimal = new JTextField("0", 5);
//
//txtDecimal.setHorizontalAlignment(JLabel.CENTER);

calculate_btn = new JButton("Calculate Area");

//AHandlerClass aListener = new AHandlerClass() ;

//btnOtoD.addActionListener(aListener);

//btnDtoO.addActionListener(aListener);

panCentre.add(lblOctal);

//panCentre.add(lblDecimal);

panCentre.add(txtOctal);

//panCentre.add(txtDecimal);

panCentre.add(calculate_btn);

//panCentre.add(btnDtoO);

panel.add(lblTitle, BorderLayout.NORTH);

panel.add(lblMessage,BorderLayout.SOUTH);

panel.add(panCentre, BorderLayout.CENTER);

}

public static void main(String args[]) {

summinup_copy myGui = new summinup_copy();

myGui.setTitle("Bharath");

myGui.setSize(400, 200);

myGui.setVisible(true);
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:04:14.843

正如您已经知道的那样，在手动编写 Swing GUI 时必须使用 LayoutManagers。以下是一些链接，可以帮助您确定哪个 LayoutManager 适合给定外观：

[http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)

[http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html)

为了在 JTextField 或其他组件旁边放置 JLabel，我通常使用[GridLayout](http://docs.oracle.com/javase/7/docs/api/java/awt/GridLayout.html)或[GridBagLayout](http://docs.oracle.com/javase/7/docs/api/java/awt/GridBagLayout.html)。我发现要让组件看起来像我想要的那样需要大量的试验和错误。通常，您必须拥有多层嵌入式 JPanel 才能使其恰到好处。

# mysql - Mysql binlog 不可读

> ID：12790660
> 
> 赞同：0
> 
> 时间：2012-10-08T23:00:05.193
> 
> 标签：mysql

我的复制中断给了我这个错误

无法添加或更新子行：外键约束失败

我试图查看外键失败的值，但是当我阅读这个二进制日志时，我得到了这个不可读的字符 - 我的复制二进制日志格式是 ROW。我如何知道复制在哪一行失败？

# 121008 14:09:31 服务器 ID 372059 end_log_pos 52230307 Table_map: `magento`。`catalogsearch_result`映射到数字 305

# 121008 14:09:31 服务器 id 372059 end_log_pos 52230355 Write_rows：表 id 305 标志：STMT_END_F

BINLOG ' 6yRzUBNbrQUAQgAAAKP4HAMAADEBAAAAAAEAB21hZ2VudG8AFGNhdGFsb2dzZWFyY2hfcmVzdWx0 AAMDA/YCFAQA 6yRzUBdbrQUAMAAAANP4HAMAADEBAAAAAAEAA//4IWwSAClUAACAAAAAAAAAAAA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T11:00:58.633

或者，您可以使用以下开关之一输出 binlog：

--base64-输出=从不

或者

--base64-输出=解码行

从 mySQL 手册：

[http://dev.mysql.com/doc/refman/5.1/en/mysqlbinlog.html#option_mysqlbinlog_base64-output](http://dev.mysql.com/doc/refman/5.1/en/mysqlbinlog.html#option_mysqlbinlog_base64-output)

应该有助于使您的 binlog 输出更具可读性。请注意， decode-rows 将忽略它无法解码的任何内容......

# css - 用 CSS 伪造一个 flash 链接？

> ID：12790664
> 
> 赞同：0
> 
> 时间：2012-10-08T23:00:20.960
> 
> 标签：css

我们有一个几年前由外部营销机构创建的 .swf 文件...

300px X 600px ...它有一个他们也创建的PDF的嵌入式链接..

我们希望链接到另一个对营销更友好的 PDF 文件...

有没有办法使用 CSS 伪造一个指向这个新 PDF 的链接？

我们已停止与旧营销机构的联系，并且从未编辑过原始 .fla 文件。

我在想我可以在 Flash 文件上添加一个...并以某种方式为 a href 创建一个类，使其等于该 PDF 的大小并链接到此 PDF...

听起来可行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:21:42.160

除非文件被加密，否则如果您使用 swf 反编译器并从那里提取 pdf，它可能会容易得多。试试[SWFTools](http://www.swftools.org/)。

# php - 用 PHP 编写的 HTML/PHP 美化器/格式化程序库

> ID：12790672
> 
> 赞同：2
> 
> 时间：2012-10-08T23:01:12.370
> 
> 标签：php, javascript, html, web

我正在尝试找到一个用 PHP 编写的 HTML 美化器。我的唯一目的是格式化或标记由我的程序生成的几个 html/php 文件。我不需要检查它是否有效。

我尝试查找不同的库，如 Tidy 等，但我无法决定使用哪一个。鉴于我的目的只是格式化服务器上​​的文件，我不希望检查这些文件的有效性的开销。我需要支持 HTML5 标签，而这些库中的很多都不支持它们。因此，我唯一要寻找的是能够格式化文件。与[http://tools.arantius.com/tabifier](http://tools.arantius.com/tabifier)完全一样的东西，但对于可以在服务器端运行的 PHP。

这些文件是使用 PHP DomDocument 库生成的。我试着用

```
file_doc->formatOutput = TRUE;
file_doc->preserveWhiteSpace = FALSE;
$this->file_doc->saveHTMLFile($this->filepath); 
```

但它不起作用。

这些文件不是完全从头开始生成的。当我的程序运行时添加的标签很少，数据被发送回服务器，这些标签被附加到文件并保存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-19T08:56:31.967

这个问题很老，但你可以使用 HTML 净化器 [http://htmlpurifier.org/](http://htmlpurifier.org/) 它有很多选项，它有一个整理 html 代码的选项。

# c - 使用 getNum(); 正确和无限循环问题

> ID：12790673
> 
> 赞同：0
> 
> 时间：2012-10-08T23:01:12.397
> 
> 标签：c, loops, infinite

我正在尝试做的这个任务只是有一些问题。基本上我需要一个菜单​​，4个选项，其中两个接受用户的输入，作为基数和指数的形式。第三个输出base raise 的答案，然后第四个退出程序。

我无法通过 getNum() 获取用户输入；我不太确定如何正确使用它。只是看一些关于如何让我的代码更好地工作的技巧。

寻求帮助：

1.  接受来自两个不同功能的用户输入并使用它来输出答案
2.  解决选择菜单选项时的无限循环问题
3.  每个功能完成后循环程序回到主菜单，只有在选择菜单选项 4 时才退出程序

    ```
    int main(void)
    {
        int option = 0;
        do
        {
            loadMenu();
                while (option<1 || option>4)
                {
                    printf("\nChoose an option between 1 and 4:");

                    option = getNum();
                    while (getNum() != '\n');
                }
                switch (option)
                {
                    case 1:
                        baseChange();   //Gets base number
                        break;
                    case 2:
                        powerChange();  //Gets exponent
                        break;
                    case 3:
                        calcMath(); //Calculates the answer
                        break;
                    default:
                        break;
                }
        }

            while (option != 4);
            printf("Goodbye!\n");
    }
    void loadMenu()                      //Menu choices
    {
        printf("Power Menu:\n" );
        printf("  1\. Change base\n");
        printf("  2\. Change exponent\n");
        printf("  3\. Calculate\n");
        printf("  4\. Exit\n");
        printf("Option?\n");
    }

    int baseChange(int base)
    {   
        printf("What is your base?: ");

        base = getNum();
        while (getNum() != '\n');

        return base;
    }

    int powerChange(int power)
    {

        printf("What is the power?: ");

        power = getNum();
        while (getNum() != '\n');

        return power;
    }

    int calcMath(int base, int power)
    {
        int index = 0;
        long answer = 1.00;

        for(index = 1; index <= power; index++) answer = answer * base;
        {
            printf("%d raised to the power of %d is %ld.\n\n", base, power, answer);
        }

        return answer;
    } 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-04T11:38:13.110

请在 main() 之前声明 getnum() 函数，如下所示；

```
/* declare getnum() prior to its first use */
float getnum(void)
{
  float x;

  printf("Enter a number: ");
  scanf("%f", &x);
  return x;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:15:53.810

> 我无法通过 getNum() 获取用户输入；我不太确定如何正确使用它。

您还没有告诉我们有关此功能的任何信息；它不是 C 标准的一部分。

> 只是看一些关于如何让我的代码更好地工作的技巧。寻求帮助：

我认为这还为时过早。把更多的精力放在解决你的问题上，如果你有具体的问题再回来。更像这个：

> 解决选择菜单选项时的无限循环问题

看看你的程序在第二次循环中对 option 做了什么。

# c# - 如何从列表中删除 包含在 url 中带有特定字符串的 url？

> ID：12790676
> 
> 赞同：0
> 
> 时间：2012-10-08T23:01:24.953
> 
> 标签：c#

我有这个代码：

```
private void button6_Click(object sender, EventArgs e)
{
    crawlLocaly1 = new CrawlLocaly();
    crawlLocaly1.StartPosition = FormStartPosition.CenterParent;
    DialogResult dr = crawlLocaly1.ShowDialog(this);
    if (dr == DialogResult.Cancel)
    {
        crawlLocaly1.Close();
    }
    else if (dr == DialogResult.OK)
    {
        LocalyKeyWords.Add(crawlLocaly1.getText() + "," + mainUrl);
        crawlLocaly1.Close();
    }
} 
```

当用户单击按钮 6 时，它会打开一个带有文本框的新表单，用户输入一个关键字，该关键字可以是 url，也可以只是一个单词。当用户单击“确定”时，它正在执行以下操作：

```
LocalyKeyWords.Add(crawlLocaly1.getText() + "," + mainUrl); 
```

LocalyKeyword 是一个列表， crawlLocaly1 是一个新表单，我在其中获取用户在文本框中键入的文本。

mainUrl 是当前网址。

因此，如果 mainUrl 是例如[http://www.google.com](http://www.google.com)

用户输入：丹尼尔

所以在索引 0 的 LocalyKeyWords 列表中我会看到：Daniel,http://www.google.com 所以我知道关键字 Daniel 属于[http://www.google.com](http://www.google.com)

现在我有这个代码：

```
private void removeExternals(List<string> externals)
{

} 
```

现在用户可以随时更改和设置 mainUrl。我需要在函数 removeExternals 中检查 mainUrl 现在是什么，然后在 List LocalyKeyWords 中找到 url，然后从 List externals 中删除属于 LocalyKeyWords 中 url 的关键字的所有位置。

例如 mainUrl 现在是[http://www.google.com](http://www.google.com) 所以我需要找到属于[http://www.google.com](http://www.google.com) 的关键字 例如关键字是 Daniel: Daniel,http://www.google。 com

所以现在删除 List externals 中包含关键字 Daniel 的所有位置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T00:10:43.773

正如其他人所说，查找或字典在这里可能是最好的。如果您使用字典滚动：

```
//Declaration. This will map a Url to one or more keywords.
Dictionary<string, List<string>> LocalyKeyWords = new Dictionary<string, List<string>>();

...

//Adding an item.
if(LocalyKeyWords.ContainsKey(mainUrl)
{
    LocalyKeyWords[mainUrl].Add(crawlLocaly1.getText());
}
else
{
    LocalyKeyWords.Add(mainUrl, new List<string>(new string[] { crawlLocaly1.getText() } ));
}

...

private void removeExternals(List<string> externals)    
{    
     if(!LocalyKeyWords.ContainsKey(mainUrl))
     {
         return;
     }

     List<string> keywords = LocalyKeyWords[mainUrl];
     List<int> indices = new List<int>();

     foreach(string keyword in keywords)
     {
         //Accumulate a list of the indices of the items that match.
         indices = indices.Concat(externals.Select((v, i)
             => v.Contains(keyword) ? i : -1 )).ToList();         
     }

     //Filter out the -1s, grab only the unique indices.
     indices = indices.Where(i => i >= 0).Distinct().ToList();
     //Filter out those items that match the keyword(s) related to mainUrl.
     externals = externals.Where((v, i) => !indices.Contains(i)).ToList();    
} 
```

这应该可以解决问题，但我不是 100% 确定你的目标是什么。

# ruby-on-rails - 数据表在两个视图上显示不同

> ID：12790679
> 
> 赞同：0
> 
> 时间：2012-10-08T23:01:47.830
> 
> 标签：ruby-on-rails, datatable, coffeescript

我有一个基于 railsapp 项目“启动预启动注册站点”的 Rails 应用程序

我正在尝试将预建页面中的数据表复制到我编写的页面上，并且我页面上的数据表缺少预建页面上显示的分页和搜索框。

虽然数据表的 haml 声明在两个视图中是相同的，但它生成的 html 是不同的。我认为的 html 缺少以下内容；

```
<div id="DataTables_Table_0_wrapper" class="dataTables_wrapper form-inline" role="grid">
<div class="row"> 
```

谁能指出我正确的方向？
如果有帮助，我可以发布更多代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T23:07:44.920

一位朋友在我的代码中发现了导致此问题的错误。为了利益，任何有类似问题的人都可以解决它；

在我看来，数据表定义了 7 个（表头），只有 5 个 tds（表数据）。即使表格显示正常，除了额外的标题，它混淆了 tableData java 脚本，无法正常工作。

# php - 使用 PhpUnit 时 Composer 无法加载 loader

> ID：12790681
> 
> 赞同：3
> 
> 时间：2012-10-08T23:01:54.877
> 
> 标签：php, phpunit, composer-php

我正在尝试将 PhpUnit 与 Composer 一起使用。为此，我做了：

1 将 phpunit 添加到 req composer 部分：

> ```
> "require": {
>     "php": ">=5.3.0"
> },
> "require-dev": {
>     "phpunit/phpunit": "3.7.*"
> },
> "autoload": {
>     "psr-0": {"PhpProject": "src/"}
> } 
> ```

2 安装需要的东西：

> php composer.phar 安装 --dev

操作成功完成。

> 安装 phpunit/phpunit (3.7.6) 下载：100%

不幸的是，当我想运行测试时，我得到

> ./vendor/bin/phpunit PHP 致命错误：在第 12 行的 /home/serek/php/project/tests/bootstrap.php 中的非对象上调用成员函数 add()

出现问题是因为 return ComposerAutoloaderInit::getLoader(); 在供应商/自动加载中将 NULL 返回到测试引导程序中。

知道如何在不破解 Loader 的情况下解决它吗？

代码：phpunnit.xml.dist

```
> <?xml version="1.0" encoding="UTF-8"?>
> 
> <phpunit bootstrap="tests/bootstrap.php" colors="true">
>     <testsuites>
>         <testsuite name="PhpProject Test Suite">
>             <directory>tests/PhpProject/</directory>
>         </testsuite>
>     </testsuites>
> 
>     <filter>
>         <whitelist>
>             <directory suffix=".php">src/PhpProject/</directory>
>         </whitelist>
>     </filter> </phpunit> 
```

tests/bootstrap.php（这里我只需要自动加载器）

```
> $loader = require_once __DIR__ . "/../vendor/autoload.php";
> $loader->add('PhpProject\\', __DIR__); //<- this is problematic line 12 (comments has 9 lines) 
```

/../供应商/autoload.php

```
// autoload.php generated by Composer
require_once __DIR__ . '/composer' . '/autoload_real.php';
return ComposerAutoloaderInit::getLoader(); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-09T10:28:08.517

问题是 PHPUnit 已经需要自动加载文件，因此您的 require_once 调用未执行，因此未设置返回值（php 不保留 require 调用的返回值，因此 require_once 在该用例上中断）。

您可以安全地将其更改为 a `require`，因为在最近的 composer 版本中，自动加载器不再创建两次，并且多次需要它只会每次都返回相同的实例。

# sql - SQL Server 2005查询获取QC项目数据库中具有相同模式的多条记录

> ID：12790685
> 
> 赞同：2
> 
> 时间：2012-10-08T23:02:26.263
> 
> 标签：sql, sql-server-2005

我们从 QC 应用程序访问 SQL Server 2005 服务器。

为了访问 SQL Server 2005 服务器中的数据，我们使用 Quality Center Application 中的仪表板模块。

抱歉，我无法发布图片，因为我对 stackoverflow 比较陌生。

当我执行以下查询时，我收到两行作为输出。

```
SELECT *
FROM CYCL_FOLD
WHERE CF_ITEM_NAME LIKE  '%Quality Center%' 
```

当我参数化实体并且当我使用 LIKE 时，它只返回行。

```
SELECT *
FROM CYCL_FOLD
WHERE CF_ITEM_NAME LIKE   @FOLDER_NAME@ 
```

请让我知道如何使用 like 子句获取多行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-02T02:48:18.483

```
SELECT *
  FROM CYCL_FOLD
     WHERE CF_ITEM_NAME LIKE  '%'+ @FOLDER_NAME +'%' 
```

# javascript - 如何在 Windows 8 对话框中包含复选框？

> ID：12790691
> 
> 赞同：1
> 
> 时间：2012-10-08T23:02:58.097
> 
> 标签：javascript, user-interface, windows-8

我目前正在开发一个 win 8 应用程序。

对于我的一个对话框，我想包括“不再向我显示此消息”复选框。我查看了 Windows.UI.Popups 的 msdn 文档，但找不到我想要的信息。

如何包含复选框？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T03:13:16.747

这是不可能的——内置`MessageDialog`类不提供该级别的定制。您将需要构建自己的基于弹出控件的控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T17:07:50.217

You can't add new elements in the *MessageDialog*

If you use HTML5/javascript app. You can make you own "Windows Store" dialog style. With CSS and to place a checkbox, use this code:

```
<input type="checkbox">value</input> 
```

# c++ - 二进制 '==' : 没有找到接受左操作数的运算符

> ID：12790693
> 
> 赞同：2
> 
> 时间：2012-10-08T23:03:23.743
> 
> 标签：c++

好的，所以我在 Stack Overflow 上阅读了这个问题的多个实例，但我似乎找不到与我的项目相关的答案。 [找到采用左手操作数的二进制无运算符](https://stackoverflow.com/questions/8936409/error-c2678-binary-no-operator-found-which-takes-a-left-hand-operand)

我似乎无法弄清楚为什么我可以在说 2 个整数上使用相等运算符，但不能在编写该程序的两个目标文件之间使用。
这是课堂上的一个片段：

```
template <class Type>
class stackType: public stackADT<Type>
{
public:
  const stackType<Type>& operator=(const stackType<Type>&); 
  stackType(const stackType<Type>& otherStack); 
  ~stackType(); 
  bool operator== (const stackType<Type>&) const;
private:
  int maxStackSize; //variable to store the maximum stack size
  int stackTop;     //variable to point to the top of the stack
  Type *list;       //pointer to the array that holds the stack elements
};

template<class Type>
bool stackType<Type>::operator==(const stackType<Type & right) const
{ 
  //assuem the stacks have same number of elements
  if(this->stacKTop != right.stackTop)
    return false;
  //check for eqaulity
  for (int i=0; i<stackTop; i++)
    if (this->list[i] != right.list[i])
      return false;
  return true;
 }//end operator function 
```

测试的主程序：

```
using namespace std;
int main()
{
  stackType<int> s1(12);
  stackType<int>s2(15);    
  for (int i=3; i<30; i+=3)
  {
    s1.push(i);
    s2.push(i);
  }//end for
  if(s1 == s2)
    cout<<"both stacks are equal"<<endl;
  else
    cout<<"stacks are not equal"<<endl;
} 
```

我正在使用 Visual Studio 2012，我只是感到困惑和筋疲力尽。我尝试更改声明我已将关键字 const 添加到声明中，我添加了更多参数，什么都没有。我在两个整数上测试了相等运算符，它编译并工作。再次，我想从我的混乱中学习，所以欢迎所有输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:21:42.133

如果您将代码定义`public stackADT<Type>`为一个空类，则该代码可以工作，这意味着它可能不应该存在，或者您对代码有一些其他的奇怪之处。

至于语法：在`(const stackType<Type & right) const`你错过了一个`>`. `stackTop`此外，您在`stacKTop`某一时刻拼写错误。

# c# - 无法替换 Current.LocalFolder 中的现有文件

> ID：12790698
> 
> 赞同：1
> 
> 时间：2012-10-08T23:04:23.990
> 
> 标签：c#, windows, windows-runtime

我有一个从选择器获得的图像文件。我将其保存为“me.png”：

```
Windows.Storage.ApplicationData.Current.LocalFolder 
```

如果我再次执行该操作以尝试用新文件覆盖旧文件，应用程序将崩溃：

```
 An exception of type 'System.UnauthorizedAccessException' occurred in mscorlib.dll but was not handled in user code

Additional information: Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED))

If there is a handler for this exception, the program may be safely continued. 
```

我用来覆盖文件的代码是：

```
 await file.CopyAsync(Windows.Storage.ApplicationData.Current.LocalFolder, "me.png", Windows.Storage.NameCollisionOption.ReplaceExisting); 
```

知道为什么会这样吗？它第二次在该行代码上崩溃。如果我将冲突选项更改为 GenerateUniqueName 它可以正常工作，因此覆盖文件似乎是一个问题。

更新：

完整代码

```
 localSettings.Values["me_image_path"] = "Asssets/pinkBackground.png";
                 tile.BackgroundImage = localSettings.Values["me_image_path"];

var picker = new FileOpenPicker();
            picker.SuggestedStartLocation = PickerLocationId.PicturesLibrary;
            picker.ViewMode = PickerViewMode.Thumbnail;
            picker.FileTypeFilter.Add(".jpg");
            picker.FileTypeFilter.Add(".jpeg");
            picker.FileTypeFilter.Add(".png");

            StorageFile file = await picker.PickSingleFileAsync();

            if (file == null) return;
            await file.CopyAsync(Windows.Storage.ApplicationData.Current.LocalFolder, "me.png", Windows.Storage.NameCollisionOption.ReplaceExisting);

            localSettings.Values["me_image_path"] = "ms-appdata:///local/me.png";
            tile.BackgroundImage = localSettings.Values["me_image_path"]; 
```

# javascript - 在两个现有元素之间放置并拟合 n 个元素

> ID：12790702
> 
> 赞同：2
> 
> 时间：2012-10-08T23:04:53.540
> 
> 标签：javascript, jquery, html, css, positioning

有两个固定宽度的元素（以 % 为单位）。

第一个元素定位`left: 0`，第二个元素定位`right: 0`；

需要在这两个元素之间附加一些 N 个元素，因此每个新附加的元素都具有相同的宽度（取决于主要元素之间的可用空间）。

[http://jsfiddle.net/hXUyh/1/](http://jsfiddle.net/hXUyh/1/)

问题是新元素的定位不准确（相互交叉或在它们之间留下一些额外的空间）并且与不同浏览器的窗口大小不一致。

请帮忙。

我知道不同的浏览器会给出不同的输出，但这个脚本将仅限于谷歌浏览器使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:57:32.063

尝试这个：

```
$(document).ready(function() {
    for (var i = 0; i < 9; i++) {
        $('<div/>').appendTo('body')
    }
    $(window).resize(function() {
        var firstWidth = $('#element-0').width();
        var r = ($(window).width() - (firstWidth * 2) - 2) / 9;
        $('div').slice(2, 11).each(function(i) {
            $(this).css({
                left: i == 0 ? firstWidth : firstWidth + r * (i),
                width: r
            })
        })
    }).resize() 
});​ 
```

[http://jsfiddle.net/yav9Q/](http://jsfiddle.net/yav9Q/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:58:25.477

不久前我也有类似的要求。在不质疑或更改您的策略/代码的情况下，这是一个尽可能接近的小提琴：http: [//jsfiddle.net/hXUyh/3/](http://jsfiddle.net/hXUyh/3/) （请注意，我没有满足您的原始代码的大小调整没有' t)

width() jquery 函数会舍入的问题。所以你的数学总是会有点偏离。我通过在 window.innerWidth 上使用计算来改进这一点，由于浮点宽度，它会有点错位。使用浮点宽度进行像素完美对齐不是要走的路。

如果您想要完美对齐，请使用填充。这是一个使用尽可能小的填充的示例：http: [//jsfiddle.net/hXUyh/8/](http://jsfiddle.net/hXUyh/8/) 如果您不需要边框，数学会容易得多。

# iphone - 双节可扩展表格视图

> ID：12790704
> 
> 赞同：0
> 
> 时间：2012-10-08T23:04:59.807
> 
> 标签：iphone, ios, xcode, uitableview

我目前在编码中面临一个大问题，但我找不到任何解决方案。

[正如您在这里看到的](http://i.stack.imgur.com/xIQqI.jpg)，我想创建一个可扩展的表格视图：

*   类别分为 2 个部分
*   子类别

我的意思是，如果您点击“2A”，“2A-1”、“2A-2”等列表就会展开。如果点击“2B”，则出现“2B-1”、“2B-2”列表，以此类推。

你觉得我能怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T03:28:51.630

我已经在一些产品中编写了这种性质的解决方案。完成此操作的代码有点广泛，因此我将为您提供一个高级概述。

将每个“行”创建为一个部分。显然，为了使每个节标题实际上看起来像一行，重写`viewForHeaderInSection`等等。

让您的视图控制器保存一个数组，其中包含展开的部分（未展开的部分是折叠的）

在 `- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section` 检查节是否展开，如果是，则返回子项数，否则返回0。

因此，cellForRowAtIndexPath 总是只返回子项，而 viewForHeaderInSection 总是返回父项。

当用户单击标题单元格时，切换部分扩展标志，并`reloadSections:withRowAnimation:`获得漂亮的动画过渡

请注意，由于在 IOS6 之前，总是重新创建节标题并且从不缓存，因此性能不是很好。使用 IOS6，这个问题也得到了解决，因为它也回收了标题单元格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T03:49:54.727

对于可扩展单元，您可以使用[VPPDropDown](https://github.com/vicpenap/VPPDropDown)类，我自己使用它，很好:)

# drag-and-drop - Select and drag text on Mac OS X 10.6 doesn't allow me to drag

> ID：12790705
> 
> 赞同：0
> 
> 时间：2012-10-08T23:05:00.983
> 
> 标签：drag-and-drop, osx-snow-leopard, text-editor, textselection

I have just been enlightened on what I previously thought was a short-coming of the whole Mac OS X platform - that like Windows, a user may select a block of text and drag it. This is particularly useful in developing.

However, the reason I thought it wasn't an available option was because it has never worked for me. No programs allow for select and drag, and I've gone through several online tutorials and forums to see if anybody else has the same issue. None of my work-mates can figure it out.

Why would my whole system dis-allow text dragging? Now that I know it's possible, it's driving me crazy not being able to do it.

I've gone through the System Preferences and the Mouse panel has no specific drag option. Trackpad has a single-finger drag option, but that's not allowing dragging, even with the trackpad.

I'm on a Macbook Pro, from around 2008\. I'm using an external mouse and running OS 10.6\.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T00:19:33.900

This should probably be on apple.stackexchange.com instead of here, but be that as it may... the trick is that you need to hold the mouse down for a fraction of a second, until the mouse cursor changes from an insertion point to an arrow, and then you can drag.

# c# - 表单关闭时取消自定义 UserControl 上的验证事件

> ID：12790706
> 
> 赞同：1
> 
> 时间：2012-10-08T23:05:00.323
> 
> 标签：c#, winforms, events, event-handling

我有一个自定义控件，可以在加载表单时获得焦点。它使用验证事件来处理它被留空或输入无效数据。

我的问题是，当用户加载表单然后关闭它时，它正在经历验证过程并显示错误，因为它是空的。

在 BaseForm (: Form) 上，我们覆盖了 WndProc 方法并在表单上设置了一个标志来表示它正在关闭，现在在验证事件处理程序中，我可以获取父表单并在表单正在关闭时取消从该方法返回。

我想要做的是对对象执行此检查，以便它影响所有现有实例并在表单关闭时取消验证事件。我只是无法取消活动。

这是 UserControl 代码的外壳。

```
public class SearchControl : UserControl
{
    public SearchControl()
    {
        Validating += OnControlValitading;
    }

    public void OnControlValitading(object sender, CancelEventArgs e)
    {
        BaseForm  frm = FindForm() as BaseForm;
        if(frm != null && frm.IsClosing)
        {
            e.Cancel = true;
            //TODO Cancel validation event on all objects
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:22:45.903

覆盖 OnValidating 并使用 CancelEventArgs：

```
public class SearchControl : UserControl
{

    protected override void OnValidating(CancelEventArgs e)
    {
        BaseForm frm = FindForm() as BaseForm;
        if (frm != null && frm.IsClosing)
        {
            e.Cancel = true;
            //TODO Cancel validation event on all objects
        }
    }
} 
```

# javafx-2 - 我们可以在 JAVAFX 中使用创建和使用自定义 EventHandler 类吗？

> ID：12790709
> 
> 赞同：4
> 
> 时间：2012-10-08T23:05:14.950
> 
> 标签：javafx-2, javafx

我对 JavaFX 中的事件处理有疑问。根据教程（以及我遇到的其他示例），事件处理在 JavaFX 中以以下方式进行：

```
Button addBtn = new Button("Add");
addBtn.setOnAction(new EventHandler<ActionEvent>() {
    @Override
    public void handle(ActionEvent event) {
            System.out.println("Add Clicked");
    }
}); 
```

但是，我想知道，如果我可以“处理”按钮单击以下方式：

```
Button addBtn = new Button("Add");
addBtn.setOnAction(new addButtonClicked()); 
```

`addButtonClicked()`我定义和编写的用于处理按钮单击操作的类（具有自己的一组方法和功能）在哪里。

有没有办法为 JavaFX 中的按钮附加我自己的事件处理程序类？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-29T05:19:29.543

EventHandler 是一个接口类。所以，它应该是“实现”而不是“扩展”

```
private static class AddButtonClicked implements EventHandler<ActionEvent> {
     @Override
     public void handle(ActionEvent event) {
          System.out.println("My Very Own Private Button Handler");
     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:20:52.010

当然。

```
private static class AddButtonClicked extends EventHandler<ActionEvent> {
     @Override
     public void handle(ActionEvent event) {
          System.out.println("My Very Own Private Button Handler");
     }
} 
```

# python - 如何在非纯黑色背景中标记不同的对象？

> ID：12790716
> 
> 赞同：0
> 
> 时间：2012-10-08T23:05:34.433
> 
> 标签：python, image-processing, numpy, scipy

我知道`scipy.ndimage.label`如果背景颜色不是纯黑色，则无法标记。
所以我有一个黑色背景的图像，它不是纯黑色，所以我们**不能**假设所有像素中的所有 RGB 值都是（0,0,0）。

如何准备图像以便我可以使用`ndimage.label`？

这是一个类似的图像进行测试：
[测试图像 http://imageshack.us/a/img4/8661/backgrf.png](http://imageshack.us/a/img4/8661/backgrf.png)
注意：
（1）图像从转换`RGB`为`PNG gray scale`.
(2) 背景颜色不同。
(3) 将`ndimage.label`整个图像标记为一个对象。
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T02:31:05.763

您可以将所有小于某个阈值的值设置为 0，然后调用标签：

```
In [16]: img2 = img.copy()     # Copy the image.

In [17]: img2[img2 < 20] = 0   # Set all values less than 20 to 0.

In [18]: lbl, n = label(img2)

In [19]: n
Out[19]: 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T17:15:32.890

这是一种尽可能增加对比度的简单方法，使任何“亮”变为白色，而“暗”变为黑色。假设 8 位灰度并调整 @Warren Weckesser 回答中的代码：

```
img2 = img.copy()     # Copy the image.
img2[img2 < 128] = 0   # Set all values less than 128 to 0 (black).
img2[img2 >= 128] = 255   # Set all values equal or greater than 128 to 255 (white).
lbl, n = label(img2) 
```

让我知道这是否适合您。

# java - 通过意图传递一个Bundle

> ID：12790722
> 
> 赞同：0
> 
> 时间：2012-10-08T23:06:53.363
> 
> 标签：java, android, hashmap

我正在尝试将数据存储到一个包中并开始一个新的活动。然后在新活动中我想取消数据。铸件代码如下：

```
Intent i = new Intent(MainActivity.this, ShowProductActivity.class);
Bundle bundle = new Bundle();
// Getting adapter of the listview
SimpleAdapter adapter = (SimpleAdapter ) mListView.getAdapter();
bundle.putSerializable("param1",  ((HashMap<String, Object>) adapter.getItem(position)));
i.putExtras(bundle);
startActivity(i); 
```

通常，捆绑包中包含的数据如下：

```
Bundle[{param1={position=0, image=2130837504, flag=/data/data/com.example.app/cache/wpta_0.jpeg, price=Brand : Dash Price : 27}}] 
```

如何将上述数据检索到第二个活动中？我正在使用以下代码块，但无法访问属性。

```
Bundle bundle = this.getIntent().getExtras();
HashMap<String, Object> param1 = (HashMap<String, Object>)bundle.getSerializable("param1"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T23:19:34.263

我不认为您需要创建一个 Bundle 来传递一个 Serializable，只需将 Serializable 直接放入 Intent 附加组件中：

```
i.putExtras("param1", ((HashMap<String, Object>) adapter.getItem(position))); 
```

* * *

**或者**，如果您必须使用中间 Bundle，请查看以下文档[`Bundle#putExtras(Bundle bundle)`](http://developer.android.com/reference/android/content/Intent.html#putExtras%28android.os.Bundle%29)：

> 向意图添加一组扩展数据。键必须包含包前缀，例如应用程序 com.android.contacts 将使用类似“com.android.contacts.ShowAll”的名称。

# git - 如何将功能分支应用/合并到较新的发布分支上？

> ID：12790723
> 
> 赞同：0
> 
> 时间：2012-10-08T23:07:11.763
> 
> 标签：git

让我们考虑一下这种情况：

```
---A---B---C---D---E---F---G---H---I---J---  (master from upstream)
       \                    \
        D'--F'               J'              (releases from upstream)
             \
              P---Q                          (own branch) 
```

我们希望将我们自己的所有分支合并或修补到 J' 上。

当 P---Q 是 master 分支的直系后代时，我不会遇到太多麻烦。但是，在这个用例中，我遇到了许多与我自己的分支中未触及的文件相关的合并冲突。这些冲突源于此示例中的 D'---F' 部分。所以我从 F'---Q 生成了一个差异，并尝试将它应用到 J'。结果：许多应用错误。另一种方法 git-format-patch F'---Q 然后 git am -3 -k 也不是一个有效的解决方案。实际上，这与合并解决方案非常相似。我也试过变基。再说一遍：许多我没有接触过的文件出现在变基过程中。

有什么干净的解决方案可用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T08:06:09.287

我开始意识到，由 git format-patch 生成的提交数量远远超过了绝对必要的数量。处理这个并格式化补丁更小的提交范围可以更好地处理 git am 迭代。为了解释发生了什么，我扩展了图表：

```
---A---B---C---D---E---F---G---H---I---J---  (master from upstream)
    \   \                    \
     \   D'--F'               J'              (releases from upstream)
      \       \
       M---N---P---Q                          (own branch) 
```

M--N 是以前的提交，基于 master。P 是一个合并的提交，所以

```
git format-patch F'..Q 
```

导致历史上更深的补丁系列（我的案例：大约 60 个），以及非常奇怪的 git am 迭代。当使用格式补丁 P---Q 时，我得到大约。30 次提交（确实，P---Q 是一种简化）。现在 git am 迭代导致 git mergetool 步骤与自 P 以来的提交有明确的关系，并且是可管理的。

# python - 在 python 中制作键值对时需要帮助

> ID：12790725
> 
> 赞同：0
> 
> 时间：2012-10-08T23:07:52.783
> 
> 标签：python, dictionary, key-value

我有这个代码：

```
 while i<len(line):
        if re.findall(pattern, line[i]):
            k,v = line[i].split('=')
            print k
            token = dict(k=v)
            print token
            break 
```

我得到的结果是：

```
ptk
{'k': 'ptk_first'} 
```

如何使这几行代码更好，字典看起来像这样：

```
{'ptk': 'ptk_first'} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T23:10:57.330

```
for line in lines:
    if re.match(pattern, line):
        k,v = line.split('=')
        token = {k:v}
        print token 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T23:32:46.663

像这样的东西：

```
lines="""\
key1=data on the rest of line 1
key2=data on the rest of line 2
key3=data on line 3"""

d={}
for line in lines.splitlines():
    k,v=line.split('=')
    d[k]=v

print d 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T23:13:56.160

```
In [112]: line="ptk=ptk_first" 

In [113]: dict([line.split("=")])
Out[113]: {'ptk': 'ptk_first'} 
```

对于您的代码：

```
for line in lines:
    if re.findall(pattern, line):
        token = dict([line.split("=")])
        print token 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-09T06:01:16.417

使用正则表达式你可以试试这个：

```
>>> import re
>>> lines="""
... ptk=ptk_first
... ptk1=ptk_second
... """
>>> dict(re.findall('(\w+)=(\w+)',lines,re.M))
{'ptk1': 'ptk_second', 'ptk': 'ptk_first'} 
```

# paypal - 如何正确编码发送到 PayPal Payments Pro 的值？

> ID：12790726
> 
> 赞同：1
> 
> 时间：2012-10-08T23:07:57.097
> 
> 标签：paypal

## 问题

将参数列表发送到 PayPal API 的正确方法是什么？这是我想知道如何正确发送的一些参数的具体示例：

```
TRXTYPE               S
BILLTOSTREET          123 Marks & Spencer St.
CUSTREF               648=ZVC_Gxk 
```

关于此事的文档不一致，我在网上找到的大多数代码都没有使用 PayPal 描述的长度前缀（但似乎仍然有效！）。

## 背景

[PayPal Payments Pro](https://cms.paypal.com/cms_content/US/en_US/files/developer/PayflowGateway_Guide.pdf)文档在p44 和周边页面上描述了他们的自定义和非标准兼容 NVP 格式。[在PayPal API NVP Basics](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_nvp_NVPAPIOverview)页面上也有矛盾地描述为“所有使用 HTTP 发送的执行 PayPal API 操作的请求都必须经过 URL 编码。”。

大型 PDF 文档也自相矛盾：

*   PDF 的“名称-值参数语法指南”部分指出“不要在值中使用空格”。但是，它随后提供了一个“正确”NVP 字符串的示例，该字符串在 BILLTOSTREET 参数中包含空格。

*   “名称-值参数语法指南”部分声明“将 NVP 参数字符串括在引号中”。这是指整个编码值字符串吗？我的 POST 正文是否应该如下所示，包括引号？“TRXTYPE=S&TENDER=C...”

*   它声称整个参数字符串应该用双引号引起来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T01:46:07.247

根据我的经验，以下工作：

*   URL 编码所有值（但不是参数名称）
*   没有引号，既不是值也不是整个帖子正文

顺便说一句，我学会了不要把 Paypal 的（可怕的）文档看得太严肃，而是诉诸反复试验，所以......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T04:19:33.153

如果您使用一种常见的服务器端语言（php、ror、java、.net）并希望节省时间和精力，只需使用适当的 PayPal 的 SDK [https://cms.paypal.com/au/cgi-bin /?cmd=_render-content&content_ID=开发者/library_download_sdks](https://cms.paypal.com/au/cgi-bin/?cmd=_render-content&content_ID=developer/library_download_sdks)

# ios - 如果未设置 Twitter，让 Twitter 显示转到我的设置页面的选项？iOS5+

> ID：12790727
> 
> 赞同：3
> 
> 时间：2012-10-08T23:08:47.860
> 
> 标签：ios, ios5, twitter

如果我访问 Twitter，我更愿意使用自动警报框，要求用户转到设置，但无法让它工作并提供我自己的默认对话框，我真的不想这样做。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

NSLog(@"indexPath.row %i", indexPath.row);

if (indexPath.row == 0) {

    store = [[ACAccountStore alloc] init]; // Long-lived

    twitterType = [store accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierTwitter];

    [store requestAccessToAccountsWithType:twitterType withCompletionHandler:^(BOOL granted, NSError *error) {

        if (granted) {
            // Access has been granted, now we can access the accounts

            twitterAccounts = [store accountsWithAccountType:twitterType];
            if (twitterAccounts.count == 1) {
                  [self getTwitterData:[twitterAccounts objectAtIndex:0]];

            } else {
                   [self selectTwitterAccount];
            }
        } else {
        // Prefer NOT to do this ************************************
        [self performSelectorOnMainThread:@selector(showTwitterError) withObject:nil waitUntilDone:NO];
        }

    }];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T04:50:52.510

据我所知，这仅在 iOS 版本 5.0 - 5.0.1 中才有可能。然后在 iOS 5.1 中再次贬值

所以目前没有解决方案......

如果您想使用 iOS 5 部分：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"prefs://"]]; 
```

还有一些关于同一主题的[阅读](https://stackoverflow.com/questions/377102/how-do-i-open-the-settings-application-from-my-application)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T07:25:09.310

这有点棘手，我通过删除子视图得到`*TWTWeetComposeViewController*`，所以它只在用户未登录时显示警报，通过点击设置按钮，我们可以在我的应用程序中打开设置页面。

```
 + (void)setAlertForSettingPage :(id)delegate 
    {
     // Set up the built-in twitter composition view controller.
        TWTweetComposeViewController *tweetViewController = [[TWTweetComposeViewController alloc] init];

        // Create the completion handler block.
        [tweetViewController setCompletionHandler:^(TWTweetComposeViewControllerResult result) {
            [delegate dismissModalViewControllerAnimated:YES];
        }];

        // Present the tweet composition view controller modally.
        [delegate presentModalViewController:tweetViewController animated:YES];
        //tweetViewController.view.hidden = YES;
        for (UIView *view in tweetViewController.view.subviews){
            [view removeFromSuperview];
        }

     } 
```

在这里，delegate 是您的视图控制器，如果您在视图控制器中使用此方法，只需使用`self`而不是`delegate`.

我不得不面对同样的问题并找到了这个解决[方案](https://stackoverflow.com/questions/11325266/open-twitter-setting-from-acaccountstore-ios-5-1-twitter/)

# python - 带有 unicode 字符的 SPARQL 正则表达式过滤器

> ID：12790729
> 
> 赞同：2
> 
> 时间：2012-10-08T23:09:12.863
> 
> 标签：python, regex, sparql

我有以下与 virtuoso 和 pyodbc 一起使用的 SPARQL 查询，我试过这个：

```
queryUnicode = u"""
SELECT ?subject ?pred ?value
WHERE
{
    ?subject ?pred ?value.
    FILTER ( regex(str(?value), 'abcd\\u00e9.*$', "i") )
}""" 
```

但是如果给出以下错误并且没有返回结果。

```
18:10:13 INFO: ERRS_0 22023 SR375 Invalid argument 2 to rdf_regex_impl. Must be narrow or wide string or an complete string RDF box 
```

知道我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T08:51:36.973

看起来像是处理 unicode 正则表达式的 Virtuoso 错误。

# c - 当所有元素都被覆盖时，我的链表数组实现有什么问题？

> ID：12790730
> 
> 赞同：1
> 
> 时间：2012-10-08T23:09:30.903
> 
> 标签：c, linked-list, hashtable

我正在尝试将哈希表实现为链表数组。目前我正在尝试创建一个简单的哈希表，其中键是数组的索引，值是用于实现链接的单链表。

这是我到目前为止编写的代码：

```
#include<stdio.h>
#include<stdlib.h>

struct Node
{
    int value;
    struct Node *next; 
};
struct Node *hashtable[7];

int empty(int index)
{
    if(hashtable[index]==NULL)
        return 0;
    return 1;
}

void addNode(int frame,struct Node **iter)
{
    if(*iter==NULL)
       *iter=malloc(sizeof(struct Node));
    else
    {
        while((*iter)->next != NULL)
            (*iter)=(*iter)->next;

        (*iter)->next=malloc(sizeof(struct Node));
        (*iter)=(*iter)->next;

    }

    (*iter)->value=frame;
    (*iter)->next=NULL;
}

void print()
{
    int i;
    struct Node **iter;
    for(i=0;i<7;i++)
    {
        iter=&hashtable[i];        
        while(*iter !=NULL)
        {
            printf("%d%s%d\n",(*iter)->value,"--",i);
            (*iter)=(*iter)->next;
        }
    }
}

int main()
{
    int i=0,count=7;
    for(i=0;i<7;i++)
        hashtable[i]=NULL;
    i=empty(1);
    printf("%d",i);
    do
    {
        printf("Enter no:\n");
        scanf("%d",&i);
        struct Node** temp;
        temp=&hashtable[i-1%7];
        addNode(rand(),temp);
        count--;
        print();
    } while(count > 0);

    return 0;
} 
```

当我调用 print 时，我只能看到一个元素添加到一个特定的索引，这是添加的最后一个元素，我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:19:23.047

```
void add_node(int frame,struct Node **iter)
   {

        /* find (pointer to) NULL pointer at end of chain */
        for ( ; *iter; iter = &(*iter)->next ) {;}

        *iter = malloc(sizeof **iter );

        (*iter)->value = frame;
        (*iter)->next = NULL;

     } 
```

# c# - 如何获取 DataGridTextColumn 类型的 Datagrid 的单元格内容

> ID：12790731
> 
> 赞同：2
> 
> 时间：2012-10-08T23:09:43.397
> 
> 标签：c#

我有一个包含 4 列 x 6 行的数据网格，第四列是 DataGridTextColumn 类型，我想获取单元格的值并将它们写入文本文件，对于 DataGridComboBoxColumn 和 Textblock 类型都可以，我可以得到值，但对于 DataGridTextColumn 的类型，我不能，并且此列是通过应用程序手动输入的（在其中写入值，如文本框），我使用了：

```
FrameworkElement fe = datagrid.columns[3].GetCellContent(datagridrow);
TextBlock tb = fe as TextBlock;
streamWriter.Write(tb.Text); 
```

但它没有用，有人可以帮忙吗？

谢谢

# sql - SQL：从 fn_Split 结果中删除前面的空格

> ID：12790745
> 
> 赞同：0
> 
> 时间：2012-10-08T23:11:27.487
> 
> 标签：sql, split, delimiter

只是一个快速的问题。

我在寻找通过分隔符拆分字符串的解决方案时发现了这两篇文章。

*   [在多行上执行表值函数？](https://stackoverflow.com/questions/454945/execute-table-valued-function-on-multiple-rows)

这导致我

*   [T-SQL：与字符串连接相反 - 如何将字符串拆分为多条记录](https://stackoverflow.com/questions/314824/t-sql-opposite-to-string-concatenation-how-to-split-string-into-multiple-reco?answertab=active#tab-top)

这对我很有用，但是字符串由分号和空格分隔。如果我将分隔符指定为分号，则在第一个子字符串之后，以下子字符串前面有一个空格。

但是，如果我将分隔符指定为**'; '**（分号后跟空格），结果是一样的。我已将 fn_Split 函数中的字符长度增加到 2 和 5，也没有变化。

是我可以在 Split 函数中更改的内容，还是在 Split 函数返回结果后需要另一个函数来删除前面的空格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:18:36.743

我刚刚阅读了有关从字符串中删除前面空格的 LTRIM 函数。这对我有用，因为我将拆分结果存储在表中，因此我可以在更新语句中使用 LTRIM。

谢谢阅读。

# javascript - 如何从包含 CDATA 和 xml 的节点中读取单个 xml 节点

> ID：12790752
> 
> 赞同：2
> 
> 时间：2012-10-08T23:12:02.337
> 
> 标签：javascript, xml, xpath, cdata, xmldom

我有个问题。我有几个随机包含节点的 xml 文件，其中包含 CDATA 和 reqular xml 节点。我需要读取这些节点的内容，但我不确定如何确定该节点是普通 xml 节点、CDATA 节点还是包含两者混合的节点，其中开头和结尾的 CDATA 部分可能包含任何事物。（如果有帮助，我正在使用 xPath 来引用我的节点）

用于检索节点文本内容的行：

```
contentObj.text = contentNode.selectSingleNode("./text").text; 
```

导致问题的 xml 示例：

```
<text>
     <![CDATA[<P align=center>&nbsp;</P>
          <P align=center>]]>
     <media identifier="005896523">
          <label>
               <![CDATA[NOTE]]>
          </label>
          <description>
               <![CDATA[Image for NOTE]]>
          </description>
          <comments>Update Required</comments>
     </media>
    <![CDATA[</P>
       <P>&nbsp;</P>
       <P align=left>&nbsp;</P>]]>
</text> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T11:11:14.497

当你说

```
contentNode.selectSingleNode("./text") 
```

这当然返回`<text>`元素节点；但是当你要求

```
.text 
```

它的属性，您要求的是整个`<text>`元素的文本内容，它是其所有后代文本节点的值的串联。

如果要选择单个文本节点，请尝试

```
contentNode.selectSingleNode("./text/text()[1]").text; 
```

即选择`<text>`元素的第一个文本节点子节点，然后检索其文本属性。这应该`"<P align=center>&nbsp;</P> <P align=center>"`在您的示例中为您提供（作为未解析的文本，而不是 XML 树）。

为了区分 CDATA 和非 CDATA，您必须使用 XPath，它的设计目的不是能够区分它们。另一方面，XML DOM 可以，至少在某些实现中是可以的。所以你可以试试

```
var children = contentNode.selectNodes("./text/node()"); 
```

这将选择元素`nodeList`的所有子`<text>`元素中的一个，包括文本节点、元素节点和可能的 CDATA 节点。遍历其中的节点`children`并检查它们的`nodeType`属性以查看它是`NODE_CDATA_SECTION`、`NODE_TEXT`还是其他东西。

让我们知道进展如何，以及您是否需要进一步的帮助。

## 编辑

我假设你接受了这个答案，你能够让事情正常进行，我很高兴你能够做到。

但是，我不想在不强调@choroba 所暗示的警告的情况下放弃这一点：CDATA 包装器（围绕一块文本）对大多数 XML 工具是不可见的（尽管文本内容是可见的）。XML 数据模型（[此处](http://www.w3.org/XML/Datamodel.html)非正式地描述）对 CDATA 部分一无所知。XML Infoset 的标准[明确省略了](http://www.w3.org/TR/xml-infoset/#omitted)有关 CDATA 标记部分的边界的信息。

因此，虽然您这次“走运了”，因为您使用了确实提供有关 CDATA 部分的信息的 XML DOM，但依赖该信息以 XML 编码重要数据是违反 XML 的精神（因此是不明智的）。因此，您最好以其他方式对该信息进行编码。否则，如果您需要对数据使用其他 XML 工具，您可能会遇到困难。

我认为您在这里尝试提取的重要信息是 CDATA 部分中的文本是转义标记。例如，它是不应该是（或不能是）XML 树的一部分的 HTML 标记。因此，您可以通过使用自定义元素包围每个标识来对该标识进行编码：

```
<text>
     <escaped><![CDATA[<P align=center>&nbsp;</P>
          <P align=center>]]></escaped>
     <media identifier="005896523">
     ... 
```

然后为了在将来找到这些部分，您所要做的就是查找名为 的元素`<escaped>`，这对于任何 XML 工具来说都是一项简单而自然的任务。

我不知道这些 XML 文件的设计是否在您的控制之下。如果没有，您至少应该可以选择向设计师发送反馈。如果不精通 XML 的设计人员犯了设计错误，了解它符合他们的最大利益，以便他们能够纠正它，或者至少在未来的设计中避免同样的错误。如果您在一个指挥链下工作，并且 XML 的设计者在不同的部门，则反馈的适当途径可能是通过您的主管。了解他们是否正在生产不可移植的 XML 设计符合该部门的最大利益。

# matlab - 基于矩阵 A，生成矩阵 B，其中包含矩阵 A 列的所有可能乘法

> ID：12790753
> 
> 赞同：2
> 
> 时间：2012-10-08T23:12:09.743
> 
> 标签：matlab, matrix

假设我有一个包含 3 列的矩阵：`c1`、`c2`、`c3`，并且我想创建一个新矩阵，其中每一列都是该矩阵的两列的任何可能乘积。

因此，如果我有一个包含**d**列的矩阵，我想创建一个包含**d+d(d-1)/2+d**列的新矩阵。例如，考虑具有 3 列`c1`, `c2`,的矩阵`c3`。我想创建的矩阵应该有列`c1`, `c2`, `c3`, `c1xc2`, `c2xc3`, `c1xc3`, `c1^2`,`c2^2`和`c3^2`。

有没有有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T02:05:12.590

我很尴尬地发布这个 - 我确信必须有一个更简单的方法（有一个**更**简单的方法 - 请参阅我在答案底部的 12 月更新），但这将完成这项工作：

```
A = [1 2 3; 4 5 6];
n =  size(A, 2);

B = A(:, reshape(ones(n, 1) * (1:n), 1, n^2)) .* repmat(A, 1, n);
Soln = [A, B(:, logical(reshape(tril(toeplitz(ones(n, 1))), 1, n^2)'))]; 
```

计算效率不高，因为在该`B`步骤中我实际上计算了我需要的组合数量的两倍（即我得到 c1.*c1、c1.*c2、c1.*c3、c2.*c1、c2.*c2、 c2.*c3, c3.*c1, c3.*c2, c3.*c3)，然后在第二步中，我只取出我需要的列（例如，我删除了 c3.*c1，因为我已经已经得到 c1.*c3 等等）。

**更新：**刚出去开车，我想到了一个更好的方法。您只需要构造两个形式的索引向量：`I1 = [1 1 1 2 2 3]`和`I2 = [1 2 3 2 3 3]`，然后`(A(:, I1) .* A(:, I2))`将获得您所追求的所有列产品。我现在不在我的电脑旁，但稍后会回来并制定一个构建索引向量的通用方法。我认为使用该结构可以很容易地完成`tril(toeplitz)`。干杯。几个小时后会更新。

**更新：** Rody 的第二个解决方案 (+1) 正是我在之前的更新中想到的，所以我不会费心重复他现在在那里所做的事情。尤达的其实也很整洁，所以又+1。

**12 月更新：**有趣的是，在这里工作之后，我不得不为自己的研究重新审视这个问题（编写 White 的异方差检验）。我现在实际上更喜欢一种新方法，@slayton 在评论中推荐（有点神秘）。具体来说，使用`nchoosek`. 我的新解决方案如下所示：

```
T = 20; K = 4;
X = randi(100, T, K);
Index = nchoosek((1:K), 2);
XAll = [X, X(:, Index(:, 1)) .* X(:, Index(:, 2)), X.^2]; 
```

`nchoosek`准确地产生我们需要快速轻松地构建叉积的指数！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T04:38:21.620

以下是有点体面的：

```
B = arrayfun(@(x) circshift(A, [0 -x]), 0:size(A,2)-1, 'UniformOutput', false);
B = cat(2, ones(size(A)), B{:});

C = repmat(A, 1, size(A,2)+1) .* B 
```

然而，这将导致矩阵

```
c1 c2 c3 (c1.*c1) (c2.*c2) (c3.*c3) (c1.*c2) (c2.*c3) (c3.*c1) (c1.*c3) (c2.*c1) (c3.*c2) 
```

其中的顺序与您要求的不同，并且产品不是唯一的。如果您只想要所有独特的产品，请使用：

```
[sA1, sA2] = size(A);

aa = repmat(1:sA2, sA2,1);

C = [A, A(:,nonzeros(triu(aa))).*A(:,nonzeros(triu(aa.')))] 
```

这导致

```
c1 c2 c3 (c1.*c1) (c2.*c1) (c2.*c2) (c3.*c1) (c3.*c2) (c3.*c3) 
```

这与您要求的顺序不同，但它仅包含独特的产品。

顺序对您的目的重要吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T07:44:00.450

这是另一种选择。首先，定义一个函数，为给定的列数返回所有可能的对（根据您在问题中的要求）：

```
cols=@(n)cat(1,num2cell((1:n)'),num2cell((1:n)'*[1,1],2),num2cell(nchoosek(1:n,2),2)) 
```

该功能应该是不言自明的。尝试查看输出中的几个小值，`n`然后亲自查看。有了这个，您可以进行如下操作：

```
s = RandStream('twister','Seed',1); %for reproducibility 
x = rand(s, 4, 3) %your matrix

%    0.4170    0.1468    0.3968
%    0.7203    0.0923    0.5388
%    0.0001    0.1863    0.4192
%    0.3023    0.3456    0.6852

o = cellfun(@(c)prod(x(:,c),2),cols(size(x,2)),'UniformOutput',0);
out = cat(2,o{:})

%    0.4170    0.1468    0.3968    0.1739    0.0215    0.1574    0.0612    0.1655    0.0582
%    0.7203    0.0923    0.5388    0.5189    0.0085    0.2903    0.0665    0.3881    0.0498
%    0.0001    0.1863    0.4192    0.0000    0.0347    0.1757    0.0000    0.0000    0.0781
%    0.3023    0.3456    0.6852    0.0914    0.1194    0.4695    0.1045    0.2072    0.2368 
```

# python - Numpy.where：来自两个不同数组的条件非常慢

> ID：12790755
> 
> 赞同：1
> 
> 时间：2012-10-08T23:12:16.937
> 
> 标签：python, numpy, where

我有三个类型为 numpy.ndarray 的数组，尺寸为（n 乘 1），分别命名为 *幅值*、*距离*和*重量*。我想使用*振幅*数组的选定条目，基于它们各自的*距离*和*重量*值。例如，我想在某个距离范围内找到条目的索引，所以我写：

```
index = np.where( (distance<10) & (distance>=5) ) 
```

然后我将继续使用`amplitude(index)`. 只要我只使用一个数组来指定条件，这就会很好地工作。例如，当我尝试

```
index = np.where( (distance<10) & (distance>=5) & (weight>0.8) ) 
```

操作变得超慢。为什么会这样，有没有更好的方法来完成这项任务？事实上，我最终想使用来自 6 个不同数组的许多条件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T00:15:33.207

这只是一个猜测，但也许`numpy`正在广播您的数组？如果数组的形状完全相同，则`numpy`不会广播它们：

```
>>> distance = numpy.arange(5) > 2
>>> weight = numpy.arange(5) < 4
>>> distance.shape, weight.shape
((5,), (5,))
>>> distance & weight
array([False, False, False,  True, False], dtype=bool) 
```

但是如果它们有不同的形状，并且这些形状是可广播的，那么它就会。`(n,)`, `(n, 1)`, 并且`(1, n)`都可以说是“n乘1”数组，但它们并不完全相同：

```
>>> distance[None,:].shape, weight[:,None].shape
((1, 5), (5, 1))
>>> distance[None,:]
array([[False, False, False,  True,  True]], dtype=bool)
>>> weight[:,None]
array([[ True],
       [ True],
       [ True],
       [ True],
       [False]], dtype=bool)
>>> distance[None,:] & weight[:,None]
array([[False, False, False,  True,  True],
       [False, False, False,  True,  True],
       [False, False, False,  True,  True],
       [False, False, False,  True,  True],
       [False, False, False, False, False]], dtype=bool) 
```

除了返回不希望的结果之外，如果数组甚至是中等大小，这可能会导致速度大幅下降：

```
>>> distance = numpy.arange(5000) > 500
>>> weight = numpy.arange(5000) < 4500
>>> %timeit distance & weight
100000 loops, best of 3: 8.17 us per loop
>>> %timeit distance[:,None] & weight[None,:]
10 loops, best of 3: 48.6 ms per loop 
```

# c# - 在本地计算机上使用 WCF 获取错误“此集合已包含带有方案 http 的地址”

> ID：12790756
> 
> 赞同：3
> 
> 时间：2012-10-08T23:12:19.423
> 
> 标签：c#, .net, wcf

我第一次尝试 WCF 并在尝试实例化主机时收到以下错误：

该集合已经包含一个带有 http 方案的地址...

我发现了很多其他对此的引用，并尝试了一些解决方案无济于事。一个不适用于我的相当常见的线程是问题出在某种网络服务器上。我只是从我的本地机器上运行所有东西。

我发现一个有趣的症状是我正在开发 ac# Forms 应用程序。最初我的顶级表单对象继承了我的服务接口而不是单独的服务类。当我以这种方式实现时，主机端没有错误，但客户端却遇到了麻烦。

基于此解决方案： [如何解决“ChannelDispatcher 无法打开其 IChannelListener”错误？](https://stackoverflow.com/questions/1252791/how-to-solve-the-channeldispatcher-is-unable-to-open-its-ichannellistener-erro)

...我决定将服务主机分离成一个单独的对象。那是我开始看到问题的时候。

ServiceContract 很简单：

```
[ServiceContract]
public interface ISSAService
{
    [OperationContract]
    void CreateSpaMonitor();
} 
```

我像这样实例化服务：

```
 Uri baseAddr = new Uri("http://localhost:8000/SSAService");
        ServiceHost localHost = new ServiceHost(typeof(SSAService), baseAddr); 
```

其中 SSAService 是 Service 接口的实现。

如果我将第二行更改为以下内容（并实现接口......），错误就会消失：

```
 Uri baseAddr = new Uri("http://localhost:8000/SSAService");
        ServiceHost localHost = new ServiceHost(typeof(SSAManager), baseAddr); 
```

SSAManager 是我的顶级表单类...

然后我遇到了一个客户端问题，这就是我开始的地方......

我尝试更改端口号，但这似乎没有任何影响。

我是 WCF 的新手，所以也许我遗漏了一些明显的东西。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-05T02:00:36.277

我收到了这个错误：

此集合已包含一个采用方案 https 的地址。此集合中的每个方案最多可以有一个地址。如果您的服务托管在 IIS 中，您可以通过将“system.serviceModel/serviceHostingEnvironment/multipleSiteBindingsEnabled”设置为 true 或指定“system.serviceModel/serviceHostingEnvironment/baseAddressPrefixFilters”来解决问题。参数名称：项目

我通过对我的 web.config 执行以下操作来解决它。也许在需要这条线的 .NET Framework 4 中发生了一些变化，因为我以前不需要它：

```
<system.serviceModel>
      <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />           
    <!--  Rest of the system.serviceModel content omitted for brevity--->

<system.serviceModel> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-22T00:08:33.703

如果您在具有不同域名/端口的同一个 IIS 站点上有多个绑定，也会发生这种情况。我通过删除额外的命名绑定解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T23:38:37.537

我之前找到的解决方案之一是添加如下内容：

```
 <serviceHostingEnvironment>
    <baseAddressPrefixFilters>
      <add prefix="http://localhost:8000"/>
    </baseAddressPrefixFilters>
  </serviceHostingEnvironment> 
```

然后绝对指定端点地址。这似乎没有效果，但我仍然在构造函数中使用 baseAddr，如上所示。

我的解决方案是从构造函数中删除 baseAddr 。

# css - iOS iFrame 溢出错误

> ID：12790758
> 
> 赞同：1
> 
> 时间：2012-10-08T23:12:33.817
> 
> 标签：css, ios5, iframe

iOS 设备访问的网站上的 iFrame 显示了被 iFrame 拉入的网页的整个高度，尽管 iFrame 的高度是通过 CSS 设置的。用溢出将它包装在一个容器中：隐藏什么都不做。我发现的唯一解决方案是使用：

```
overflow: auto;
-webkit-overflow-scrolling: touch; 
```

它隐藏了内容，但 iFrame 的高度仍然延伸到拉入网页的整个高度，这可能会导致过度滚动。有没有办法强制 iFrame 达到一定高度而不显示超出该高度的内容？我不关心滚动或任何其他功能。

# java - 如何覆盖android资产？

> ID：12790760
> 
> 赞同：2
> 
> 时间：2012-10-08T23:12:42.133
> 
> 标签：java, android, file, overwrite, download-manager

我的资产文件夹中有一个小的 XML(KB) 文件。我的应用程序从中提取数据。但是后来我下载了文件的更新版本，我需要以某种方式替换它，但我不知道该怎么做？
由于我正在开发更高的 API`SI 可以使用 DownloadManager 类。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-08T23:15:45.590

您不能替换资产——资产，如资源，是只读的。

相反，您需要调整您的应用程序以检测您是否已下载替换文件，并在可用时使用该替换文件而不是资产。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-09T08:33:24.437

我的解决方案是：在我使用资产文件之前，我删除了路径中的所有缓存文件---/data/data/com.yourpackagename.xxx，当然只是当应用程序版本高于旧应用程序版本时。（我保存了一个 SharedPreferences当应用程序首次运行时。所以我可以比较应用程序版本）。我不知道为什么存在新应用程序的资产资源，但该解决方案对我有用！

ps：我的应用主页是一个网页视图和资产中的文件，所以，我需要在每次应用更新时替换它！

# python - dir(models.Model.Blog) 没有显示Blog的类变量（Fields），为什么？

> ID：12790761
> 
> 赞同：2
> 
> 时间：2012-10-08T23:12:49.170
> 
> 标签：python, django, django-models

**模型.py：**

```
from django.db import models

class Blog(models.Model):
    title = models.CharField(max_length=100, unique=True)
    body = models.TextField() 
```

在 Python 中调用`dir`类上的函数通常会显示一个列表，其中包含已定义的类变量。但奇怪的是，当我执行`python manage.py shell`以下操作时：

```
>>> import blog.models as bm
>>> dir(bm.Blog)
['DoesNotExist', 'MultipleObjectsReturned', '__class__', '__delattr__', '__dict__', 
'__doc__', '__eq__', '__format__', '__getattribute__', '__hash__', '__init__', 
'__metaclass__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', 
'__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__unicode__', 
'__weakref__', '_base_manager', '_default_manager', '_deferred', '_get_FIELD_display', 
'_get_next_or_previous_by_FIELD', '_get_next_or_previous_in_order', '_get_pk_val', 
'_get_unique_checks', '_meta', '_perform_date_checks', '_perform_unique_checks', 
'_set_pk_val', 'clean', 'clean_fields', 'date_error_message', 'delete', 'full_clean', 
'objects', 'pk', 'prepare_database_save', 'save', 'save_base', 'serializable_value', 
'unique_error_message', 'validate_unique'] 
```

`dir(bm.Blog)`不包含`title`and`body`类变量（意外）。`dir(bm.Blog())`但是确实包含那些类变量（预期的）。

```
>>> dir(bm.Blog())
['DoesNotExist', 'MultipleObjectsReturned', '__class__', '__delattr__', '__dict__', 
'__doc__', '__eq__', '__format__', '__getattribute__', '__hash__', '__init__', 
'__metaclass__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', 
'__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__unicode__', 
'__weakref__', '_base_manager', '_default_manager', '_deferred', '_get_FIELD_display', 
'_get_next_or_previous_by_FIELD', '_get_next_or_previous_in_order', '_get_pk_val', 
'_get_unique_checks', '_meta', '_perform_date_checks', '_perform_unique_checks', 
'_set_pk_val', '_state', 'body', 'clean', 'clean_fields', 'date_error_message', 
'delete', 'full_clean', 'id', 'objects', 'pk', 'prepare_database_save', 'save', 
'save_base', 'serializable_value', 'title', 'unique_error_message', 'validate_unique'] 
```

`Model`那么为什么当我在该类上调用 dir 函数时，我看不到 Django 子类的类变量呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T23:21:47.790

发生这种情况是因为您继承自`db.Model`，它具有特定的元类[`ModelBase`](https://github.com/django/django/blob/master/django/db/models/base.py#L55)。所以`title=models.CharField`和其他字段（提供有关表中行的元信息）不是模型类的真实属性，而不是模型实例中此字段的*值*。但是您可以访问它们：

```
Blog._meta.get_field('title') # models.CharField instance 
```

# .net - WCF 如何通过 ASP.NET 路由确定 webHttpBinding 中使用的端点地址？

> ID：12790770
> 
> 赞同：0
> 
> 时间：2012-10-08T23:13:29.010
> 
> 标签：.net, wcf, silverlight, webhttpbinding

我的 Web 应用程序中的一些 Silverlight 代码使用了 WCF 服务。它使用 ASP.NET 路由功能：

```
private void RegisterRoutes()
{
    var factory = new WebServiceHostFactory();
    RouteTable.Routes.Add(new ServiceRoute("Service", factory, typeof(ServiceService)));
} 
```

这目前适用于我们的生产环境。

在其他一些环境中，我得到了例外

> System.InvalidOperationException：找不到与具有绑定 WebHttpBinding 的端点的方案 http 匹配的基地址。注册的基地址方案是 [https]。

我刚刚将完全相同的代码部署到我们的集成环境和培训环境。它在集成中有效，但在训练中失败。两种环境都运行相同版本的 Windows Server 2008 R2 Enterprise，以及相同版本的 IIS 7.5。两者都在 IIS 中配置了相同的绑定（所有 IP 地址上的端口 443 和 80）。

我已经对代码进行了检测，可以看到当它工作时，服务正在使用 http 和 https。失败时，仅使用 https。两个系统之间的 web.config 是相同的。

我知道，通常，对于托管在 IIS 应用程序中的服务，WCF 使用 IIS 中的绑定信息。在这种情况下，正在使用 ASP.NET 路由功能。

WCF 如何确定要使用的基地址？

* * *

**更新**：这是我们 web.config 文件的摘录：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.serviceModel>
    <diagnostics>
      <endToEndTracing propagateActivity="true" activityTracing="true"
       messageFlowTracing="true" />
    </diagnostics>
    <extensions>
      <behaviorExtensions>
        <add name="silverlightFaults" type="Services.SilverlightFaultBehavior, Services" />
      </behaviorExtensions>
    </extensions>
    <behaviors>
      <serviceBehaviors>
        <behavior name="ServiceBehavior">
          <serviceMetadata httpGetEnabled="false" />
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>
      <endpointBehaviors>
        <behavior name="SilverlightRESTBehavior">
          <webHttp helpEnabled="false" automaticFormatSelectionEnabled="false" 
                   defaultOutgoingResponseFormat="Json" faultExceptionEnabled="false" />
          <silverlightFaults />
        </behavior>
      </endpointBehaviors>
    </behaviors>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
    <services>
      <service behaviorConfiguration="ServiceBehavior" name="Services.SpendAnalysisService">
        <endpoint address="" behaviorConfiguration="SilverlightRESTBehavior"
          binding="webHttpBinding" contract="Services.SpendAnalysisService" />
        <host> <!-- Added: not in the original-->
          <baseAddresses>
            <add baseAddress="http://" />
            <add baseAddress="https://" />
          </baseAddresses>
        </host>
      </service>
    </services>
    <standardEndpoints>
      <webHttpEndpoint>
        <standardEndpoint name="d" helpEnabled="false" defaultOutgoingResponseFormat="Json"
          automaticFormatSelectionEnabled="false" faultExceptionEnabled="false" />
      </webHttpEndpoint>
    </standardEndpoints>
  </system.serviceModel>
</configuration> 
```

* * *

**编辑**：

另一个提示：Training 环境的 IIS 中设置了“SSL Required”，在 Integration 环境中清除了。在培训环境中清除它可以防止服务器端异常。现在，两种环境中的 WCF 日志都显示正在考虑 http 和 https 地址。

现在的问题是：当请求以 https 形式到达时，为什么 WCF 认为它需要 http？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:45:53.130

这个非常具体的问题的答案很简单：

`http`失败的站点对和都有 IIS 绑定`https`。但是，在 IIS 的“SSL 设置”下设置了“需要 SSL”标志。这是有道理的，因为该站点只能通过 SSL 访问（一旦负载均衡器设置正确）。这导致 WCF 从其基地址搜索中排除 http 方案。清除“要求 SSL”标志解决了这个问题。

一旦我创建了一个复制器，剩下的问题可能是微软支持的一个问题：为什么在整个请求和所有相关请求都进来之后， WCF 还要*考虑*这个问题？`http``https`

我希望找到一种更通用地重写这个问题的方法，以便答案可以使其他人受益。现在，我很想以“过于本地化”来结束这个问题。

# sql - 向 TOP Select 添加 1 个数字会挂起查询

> ID：12790775
> 
> 赞同：4
> 
> 时间：2012-10-08T23:14:03.670
> 
> 标签：sql, sql-server, view

好的，首先是免责声明。我在我的几个表中使用实体属性值方法。所以基本上我在一个表的单列中有一个属性列表，然后我想在单独的视图中将其填充到单行中。

我找到了这个解决方案，效果很好：

[SQL：具有基于源表中列值的列名的动态视图](https://stackoverflow.com/questions/10986031/sql-dynamic-view-with-column-names-based-on-column-values-in-source-table)

然而，初始加载非常慢（填充 514 行需要 27 分钟）。我认为有些事情似乎根本不正确，所以我使用 TOP 选择了 Client 表的部分。我得到了立竿见影的结果。我发现我可以通过这种方式立即将整个数据库排队。但是我发现了一个非常奇怪的警告。我最多可以选择 5250 条记录。

到目前为止，我仍然得到了立竿见影的效果。如果我尝试选择 5251，则查询挂起。我在测试服务器上尝试过，得到了相同的限制，但数量不同（我可以在那里选择最多 5321）。请记住，该表只有 514 条记录，所以我不知道为什么将 1 个数字添加到 TOP 选择会导致它挂起。有人对此有任何意见吗？下面是我的工作 sql 查询：

```
DECLARE @cols AS NVARCHAR(MAX)
DECLARE @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(a.AttributeName) 
                from AttributeCodes a                                   
        FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)') 
    ,1,1,'')

set @query = 'SELECT TOP 5250 ClientID, ' + @cols + ' from 
         (
             select c.ClientID
                    , c.[Value]
                    , a.AttributeName                                           
                from Client c
                inner join AttributeCodes a
                    on a.AttributeCodeId = c.AttributeCodeID

        )x
        pivot 
        (
            min([Value])
            for AttributeName in (' + @cols + ')
        )p'

execute(@query) 
```

编辑：

好的，似乎问题在于执行计划通过添加另一个数字而完全改变。我将在下面发布两个结果。我仍然不知道它为什么会改变，如果有什么方法可以阻止它使用哈希匹配而不是内部连接。

[执行计划 1](http://i48.tinypic.com/hte8e8.jpg)（即时）：
[![执行计划 1](../Images/f38b0266a3a5b5085a961359c664be30.png)](https://i.stack.imgur.com/CTLVd.jpg)

[执行计划 2](http://i46.tinypic.com/358qu4n.jpg)（30 分钟以上）： [![执行计划 2](../Images/53e7921ba29f2b59ff4a85ec5977343a.png)](https://i.stack.imgur.com/WYFaJ.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T16:58:54.743

如果不查看确切的索引设计并确切了解您选择的内容的大小和范围以及数据库中的内容，我无法给您确切的原因。

但我可以告诉您的是，SQL Server 使用成本阈值来制定计划，以确定扫描表或执行大量搜索是否更有利。这里发生的情况是 SQL Server 似乎在 5250/5251 边界处越过了该阈值。

如果您要向主表添加更多数据行，重建统计信息，然后重新查询，您可能会发现 SQL Server 将停止扫描和散列并返回基于查找的计划，因为行的比例它将不得不反复寻求将再次降低。

那么，如何消除这个问题呢？我首先会说 EAV 在某些场景中对于某些类型的设计可能很好，但是当您从系统中提取大量数据，或者您想要从这些模型中获取报告时，EAV 就会出现问题，并且这些是您倾向于看到的问题类型。既然你有选择性

您在这里有几个可能的解决方案。

1.  为您的连接添加一个 LOOP JOIN[提示](http://msdn.microsoft.com/en-us/library/ms173815.aspx)。呸。
2.  对从数据库中询问的内容更具选择性——例如，一次只询问单个客户的值。
3.  重新评估您使用 EAV 模型的原因并使用传统技术重新设计您的数据模型。

再说一次，我不太了解你对这个设计的推理，所以如果我在你的位置并且我的背靠在墙上，我可能会做 1) 和 3) 的组合。我会添加提示以“止血”，然后我会考虑重新评估完全使用实体属性值设计的决定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T01:18:40.590

*以下是格式化的评论，不是答案。*

出于病态的好奇心，我一直在摆弄下面的测试代码。我意识到它没有正确的代码来检查测试表是否存在，随机数的边缘情况无疑是错误的，...。就这样。

目的是创建比问题中描述的更多的测试数据和更大的结果。使用显示的参数，初始化大约需要 306 秒，在我的笔记本上运行动态查询大约需要 87 秒。（Windows 7 Professional 64 位，16GB 内存，SQL Server 2008 R2 64 位。）我没有看到任何困难的迹象。Daniel，您是否看到任何明显的差异，例如`Value`可能更大的列的不同数据类型？SQL Server 的版本？有效内存？我完全搞砸了你的 EAV 表示吗？

```
-- Test parameters.
declare @NumberOfAttributes as Int = 1000
declare @NumberOfClients as Int = 1000
declare @NumberOfSampleRows as Int = 1000000
declare @NumberOfTopRows as Int = 10000
declare @Start as DateTime = GetDate()

-- Houseclean any prior data.
if Object_Id( 'AttributeCodes' ) is not NULL
  drop table AttributeCodes
if Object_Id( 'Client' ) is not NULL
  drop table Client

-- Create the tables.
create table AttributeCodes (
  AttributeCodeId Int Identity(1,1) not NULL,
  AttributeName VarChar(64) not NULL )
create table Client (
  ClientId Int not NULL,
  AttributeCodeId Int not NULL,
  [Value] VarChar(64) not NULL )

set nocount on

-- Generate some sample attributes.
declare @Count as Int
set @Count = @NumberOfAttributes
while ( @Count > 0 )
  begin
  insert into AttributeCodes ( AttributeName ) values
    ( 'Attr_' + Right( '000' + Cast( @Count as VarChar(8) ), 4 ) )
  set @Count = @Count - 1
  end

-- Generate some sample client data.
declare @ClientId as Int
declare @AttributeCodeId as Int
set @Count = @NumberOfSampleRows
while ( @Count > 0 )
  begin
  set @ClientId = 1 + Cast( Rand() * @NumberOfClients as Int )
  set @AttributeCodeId = 1 + Cast( Rand() * @NumberOfAttributes as Int )
  insert into Client ( ClientId, AttributeCodeId, Value ) values
    ( @ClientId, @AttributeCodeId, Replicate( 'i', Cast( Rand() * 64 as Int ) ) )
  set @Count = @Count - 1
  end

-- Build the list of columns.
declare @Cols as NVarChar(Max)
select @Cols = Stuff(
  ( select ',' + QuoteName( AttributeName ) from AttributeCodes order by AttributeName for XML path(''), type).value( '.[1]', 'NVarChar(max)' ), 1, 1, '' );

-- Build an execute the summary query.
declare @Query as NVarChar(Max)
set @Query = 'select top (' + Cast( @NumberOfTopRows as VarChar(8) ) + ') ClientId, ' + @Cols +
  ' from ( select C.ClientId, C.[Value], A.AttributeName from Client as C inner join AttributeCodes as A on A.AttributeCodeId = C.AttributeCodeId ) as X' +
  ' pivot ( Min( [Value] ) for AttributeName in (' + @cols + ') ) as P' 
declare @InitializationComplete as DateTime = GetDate()
execute( @Query )
select DateDiff( ms, @Start, @InitializationComplete ) as 'Initialization (ms)',
  DateDiff( ms, @InitializationComplete, GetDate() ) as 'Query (ms)',
  DateDiff( mi, @Start, GetDate() ) as 'Total (min)' 
```

# c# - MVC3 Html.SelectList - 即使所选选项已更改，验证期间始终会看到初始值

> ID：12790777
> 
> 赞同：0
> 
> 时间：2012-10-08T23:14:12.147
> 
> 标签：c#, asp.net-mvc-3

我正在创建一个填充有枚举值的选择列表：

```
<%= Html.DropDownListFor(model => model.OrderStatus, new SelectList(Enum.GetValues(typeof(OrderStatus))))%> 
```

我现在正在执行客户端验证以确保正确设置 OrderStatus：

```
[DisplayName("Order Status"), EnsureOrderStatus("ID")]
public OrderStatus OrderStatus { get; set; }

public class EnsureOrderStatus : ValidationAttribute, IClientValidatable
    {
        private readonly string OrderIDPropertyName;

        public EnsureOrderStatus(string orderIDPropertyName)
        {
            OrderIDPropertyName = orderIDPropertyName;
        }

        protected override ValidationResult IsValid (object value, ValidationContext validationContext)
        {
            ValidationResult validationResult = ValidationResult.Success;

            var propertyTestedInfo = validationContext.ObjectType.GetProperty(OrderIDPropertyName);
            if (propertyTestedInfo == null)
            {
                validationResult = new ValidationResult(string.Format("Unknown property {0}", OrderIDPropertyName));
            }
            else
            {
                int orderID = (int)propertyTestedInfo.GetValue(validationContext.ObjectInstance, null);
                OrderStatus orderStatus = (OrderStatus)value;

                if (orderID == 0 && orderStatus != OrderStatus.Future)
                {
                    validationResult = new ValidationResult(string.Format("Order must have have an Order Status of Future when being created."));
                }
            }

            return validationResult;
        }

        public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
        {
            var rule = new ModelClientValidationRule
                {
                    ErrorMessage = ErrorMessage,
                    ValidationType = "ensureorderstatus"
                };

            rule.ValidationParameters["orderid"] = OrderIDPropertyName;
            yield return rule;
        }
    } 
```

IsValid 内部的 'value' 值始终是 OrderStatus 的第一个枚举值。我想知道是否需要采取其他步骤来确保 DropDownList 元素的选定值正确更新。

**更新代码：**

```
//OrderDetailsModel:
[DisplayName("Order Status"), EnsureOrderStatus("ID")]
public OrderStatus OrderStatus { get; set; }
public List<OrderStatusModel> OrderStatusModels = new List<OrderStatusModel>();

public OrderDetailsModel()
{
    OrderStatusModels.Add(new OrderStatusModel { EnumStatus = OrderStatus.Active, StringStatus = "Active" });
    OrderStatusModels.Add(new OrderStatusModel { EnumStatus = OrderStatus.Completed, StringStatus = "Completed" });
    OrderStatusModels.Add(new OrderStatusModel { EnumStatus = OrderStatus.Future, StringStatus = "Future" });
}

<%= Html.DropDownListFor(model => model.OrderStatus, new SelectList(Model.OrderStatusModels, "StringStatus", "EnumStatus"))%> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T23:36:08.270

我会重新考虑这个......个人。尝试将枚举破解为 SelectList 将创建比所需更多的工作。

简单地说，将这一切包装在一个 ViewModel 中。考虑一下：

```
public enum OrderStatus {
    NOT_SHIPPED,
    SHIPPED
}

public class ViewModel {
    public OrderStatus SelectedStatus { get; set; }
    public List<StatusViewModel> Models = new List<StatusViewModel>();
}

public class StatusViewModel {
    public string StringStatus { get; set; }
    public OrderStatus EnumStatus { get; set; }
} 
```

设置（可能在控制器中..或其他地方）涉及到：

```
ViewModel model = new ViewModel();

model.Models.Add(new StatusViewModel() { EnumStatus = OrderStatus.NOT_SHIPPED, StringStatus = "Not shipped" });
model.Models.Add(new StatusViewModel() { EnumStatus = OrderStatus.SHIPPED, StringStatus = "Shipped" });

return View(model); 
```

..你的观点就是这样：

```
@model Models.ViewModel
@Html.DropDownListFor(x => x.SelectedStatus, new SelectList(Model.Models, "StringStatus", "EnumStatus")) 
```

然后，当您的模型在发布后进入时，SelectedStatus 是强类型 OrderStatus 枚举：

```
public ActionResult Index(ViewModel model) {
    // model.SelectedStatus is an OrderStatus
} 
```

# java - 地图 ，对象>注册表

> ID：12790778
> 
> 赞同：1
> 
> 时间：2012-10-08T23:14:44.957
> 
> 标签：java, generics, collections, guava

我需要将测试值放在一个类中，就像在这个简化的例子中一样：

```
import java.util.List;
import java.util.Map;
import com.google.common.collect.Lists;
import com.google.common.collect.Maps;
public class TestVal {
  private static Map<Class<?>, Object> dummyValues = Maps.newHashMap();
  static {
    dummyValues.put(String.class, "Banana");
    dummyValues.put(Integer.class, 42);
  }
  @SuppressWarnings("unchecked")
  static final <T> T ofType(Class<T> type) {
    return (T) dummyValues.get(type);
  }
  public static void main(String[] args) {
    List<? extends Object> list =
        Lists.newArrayList(ofType(String.class), ofType(Integer.class));
    for (Object object : list) {
      System.out.printf("%s: %s%n", object, object.getClass().getName());
    }
  }
} 
```

一旦运行，它会给我：

```
Banana: java.lang.String
42: java.lang.Integer 
```

所以它作为一个“基本”系统很好。

不过，我想要更多的类型安全性。

我试图研究番石榴的`ImmutableClassToInstanceMap`但是......我觉得有点困难，看看这个方法签名：

```
public static
    <B, S extends B>
        ImmutableClassToInstanceMap<B>
            copyOf(
                Map<? extends Class<? extends S>,
                ? extends S> map
            ) 
```

残酷，不是吗？我如何将它用于“任何”类型？在 Google 的 Wiki 上没有看到示例。

我可以像上面那样“向上一步”而不是“一路走来”吗？我是否错过了另一种明显的方法来做同样的事情？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-08T23:20:07.920

诶？你需要做的`ImmutableClassToInstanceMap`就是像

```
ImmutableClassToInstanceMap<Object> map = ImmutableClassToInstanceMap
  .builder()
  .put(String.class, "foo")
  .put(Integer.class, 42)
  .build(); 
```

然后你只需打电话`map.getInstance(String.class)`出去`String`。

上的泛型`copyOf()`很复杂但很有必要，但在这种情况下，您几乎肯定只想使用构建器。

# tfs - 关于 mvc 应用程序的 tfsbuild 设置的反馈

> ID：12790781
> 
> 赞同：0
> 
> 时间：2012-10-08T23:15:36.650
> 
> 标签：tfs, continuous-integration, asp.net-mvc-4, visual-studio-2012, tfsbuild

我是 TFSBuild 的新手，但我已经能够为我的解决方案创建构建定义。我有几个问题很有帮助。

我创建了 3 个定义 - 我想知道这是否是正确的方法。

1.  每次签入时触发的定义，构建代码并仅运行单元测试
2.  定义每晚运行，构建一切，运行所有单元和集成测试
3.  我专门用于部署的定义 - 所以我通过参数指定环境并构建代码，运行单元和集成测试，然后 ms 再次通过参数将其部署到指定的环境

当我分支我的代码等时，我将不得不为每个定义创建 3 个定义，这可能会变得难以管理。请问对此有什么意见吗？

每个定义都有自己的一组内部版本号是真的吗？它们可以共享吗？

我的应用程序是一个带有 VS2012 IDE 的 MVC4 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T07:10:15.223

遗憾的是，TFS Build 对分支的支持不是很好，是的，这通常意味着您为每个分支复制构建定义。我过去见过一些自定义构建过程模板，它们试图解决这个问题，但没有内置任何东西。

您可以用 Windows 调度程序任务替换 #2 以使用自定义参数运行 #1，这不是最好的解决方案，但可以扩展为在午夜使用集成测试标志对每个构建定义进行排队。

对于#3，我没有使用构建定义进行部署，而是使用了一个名为 TFS Deployer 的外部工具，这允许我通过更改构建的构建质量来使用任何构建进行部署。将每个分支需要设置的构建数量减少 1。

每个构建定义都有自己的构建编号，没有内置的共享方式，但是我相信这是由构建定义设置的，因此您可以以某种方式绕过它。

# sql - 根据列值更改 sql 查询输出

> ID：12790788
> 
> 赞同：0
> 
> 时间：2012-10-08T23:16:46.447
> 
> 标签：sql

我的表中有两种类型的客户，特权用户和普通用户。当我从客户表中选择一些列值时，我想要普通用户的默认值，而我需要特权用户的实际值。询问：

```
select name,id,budget,employees,duration from customers
where reg_date >= to_date( '01-SEP-2012','dd-mmm-yyyy') 
  and reg_date <= to_date('01-OCT-2012','dd-mmm-yyyy') 
```

对于普通用户，我需要预算、员工、持续时间列的值为 0。

我必须通过“id”和“reg_mode”查询另一个表来检查用户是否是特权用户。可能会建议我在客户表中有一列来包含客户的“类型”。不幸的是，我无权修改表格。有什么想法可以以更短的延迟提取值吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:31:59.443

不知道我是否明白了，特别是因为表结构不太清楚......让我们假设另一个表名是 user_type。我想你想要的是（注意我的查询可能有小错误，因为我没有尝试，我只是想给出一个结构的想法）：

```
select name,id, '0' as budget, '0' as employees, '0' as duration from customers 
inner join user_type on
       customers.id = user_type.id
where reg_date >= to_date( '01-SEP-2012','dd-mmm-yyyy')  
  and reg_date <= to_date('01-OCT-2012','dd-mmm-yyyy') 
  and user_type.reg_mode = 'normal'

union

select name,id, budget, employees, as duration from customers 
inner join user_type on
       customers.id = user_type.id
where reg_date >= to_date( '01-SEP-2012','dd-mmm-yyyy')  
  and reg_date <= to_date('01-OCT-2012','dd-mmm-yyyy') 
  and user_type.reg_mode = 'privileged' 
```

内部连接类似于 where，如果您对该术语有疑问，请告诉我...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:27:13.817

你需要在这里做两件事：

1.  加入您的第二张表，其中包含以下信息`reg_mode`：

    SELECT * FROM customers JOIN reg_data ON customers.ID = reg_data.ID

    例如，请参阅`JOIN` [此处的详细信息](http://en.wikipedia.org/wiki/Join_%28SQL%29)

2.  选择正确的值取决于`reg_mode`：

    SELECT (CASE reg_mode WHEN "privileged" THEN customers.budget ELSE 0 END) 作为预算，...

    有关SQL Server，请参阅`CASE` [此处的详细信息。](http://msdn.microsoft.com/ru-ru/library/ms181765.aspx)对于其他数据库，它应该或多或少相同

# iphone - iPhone 5 中的 viewDidAppear 高度为 656

> ID：12790790
> 
> 赞同：4
> 
> 时间：2012-10-08T23:17:02.303
> 
> 标签：iphone, objective-c, ios, ipad

我在视图控制器上的 viewDidAppear 中的高度为 656。这不是我期望的 iPhone 5 的正确高度。知道为什么会发生这种情况吗？我有一个作为 UIViewController 的子视图添加的 UIView，并且我设置了 struts，使其始终粘在 UIViewController 的底部。但是因为高度是 656，所以我再也看不到这个 UIView。知道为什么吗？

这是我的代码：

```
- (void) viewDidAppear:(BOOL) animated
{
 [super viewDidAppear:animated];
  NSLog(@"%f", self.view.bounds.size.height); 
} 
```

这就是我初始化 VC 的方式：

```
 SavedViewController *savedStoriesVC = [[SavedViewController alloc] initWithNibName:@"SavedViewController" bundle:nil];
    savedStoriesVC.managedObjectContext = managedObjectContext;
    savedStoriesVC.delegate = self;

    UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:savedStoriesVC];
    navController.navigationBarHidden = YES; 
```

![在此处输入图像描述](../Images/36d0ad78d3a2b0f7bdc56bd8860457c9.png) ![在此处输入图像描述](../Images/3071561ad5d498324480428a42179f86.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T00:14:34.363

我刚遇到同样的问题。我能够通过关闭所有支柱和弹簧来“修复”它。但是，当然，轮换不起作用。

# entity-framework - 实体框架 SSDL 版本之间的差异

> ID：12790791
> 
> 赞同：0
> 
> 时间：2012-10-08T23:17:18.650
> 
> 标签：entity-framework

根据以下 URL，Entity Framework Storage Schema Definition Language 有三个版本：

[http://msdn.microsoft.com/en-us/data/jj652016.aspx](http://msdn.microsoft.com/en-us/data/jj652016.aspx)

我正在开发一个应该支持所有这些（包括旧版本）的工具，但不幸的是我找不到描述它们之间差异的文档。

有谁知道这样的文件或能够描述差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T04:08:17.757

有 3 个主要版本的 EF 工件（即 CSDL、SSDL 和 MSL）。V1 是在作为 .NET Framework 3.5 SP1 的一部分发布的第一个实体框架版本中引入的。V2 是在 .NET Framework 4 附带的 EF4 中引入的。V3 是在 .NET Framework 4.5 附带的 EF5 中引入的。V3 也将被 EF6 使用，它不会作为 .NET Framework 的一部分提供，但将是一个独立版本 - 这是项目站点[http://entityframework.codeplex.com](http://entityframework.codeplex.com)。当向实体框架添加新功能并且无法使用现有版本来实现这些功能时，必须更改工件（并因此增加版本）。我没有 V1 和 V2 之间变化的列表，但您可以在此处找到 v2 和 v3 之间的变化列表： [http://msdn.microsoft.com/en-us/data/jj650889](http://msdn.microsoft.com/en-us/data/jj650889)。查找更改内容的一种方法是将 v1 工件的架构与 v2 工件的相应架构进行比较。您可以通过浏览 EF6 代码（在 src/EntityFramework/Resources/System/Data/{EntityModel [|](http://entityframework.codeplex.com) MappingSpecification}) - 自 EF5 以来架构没有更改。

# python - 在 windows 命令行中启动一个 .py 文件

> ID：12790792
> 
> 赞同：0
> 
> 时间：2012-10-08T23:17:26.763
> 
> 标签：python

这是我的情况：

```
D:\Python27\python.exe
D:\Python27\search\file.py 
```

但是`file.py`需要一些论据才能开始

```
file.py -a searchFunction=dfs 
```

我怎样才能打开这个文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T23:18:37.443

嗯，添加论据？

假设你在 Windows 上，开始 -> 运行 -> cmd

然后在终端中你可以输入：

`D:\Python27\python.exe D:\Python27\search\file.py -a searchFunction=dfs`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T23:18:36.587

嗯

```
D:\Python27\python.exe D:\Python27\search\file.py -a searchFunction=dfs 
```

# java - 使用字符串创建对象

> ID：12790794
> 
> 赞同：0
> 
> 时间：2012-10-08T23:17:47.103
> 
> 标签：java, reflection

> **可能重复：**
> [使用字符串代替变量名](https://stackoverflow.com/questions/5157539/use-string-in-place-of-variable-name)

Java中是否有任何方法允许使用字符串创建对象？

假设我有一个名为“Toyata”的类，无论如何我可以使用 Car 类中的字符串变量 s 创建一个 Toyata 的对象吗？

```
public class Car{
String s = "Toyota";
}

public class Toyota{
int speed;

public Toyota(int speed){
this.speed=speed;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:42:43.430

您需要通过`s`. 然后你必须通过你的类的`getConstructor()`方法查找正确的构造函数。由于`Toyota`不包含默认构造函数，因此您需要查询与预期参数匹配的构造函数。在这种情况下，它是一个`int`. `int`以`Class`形式表示`Integer.TYPE`。最后，一切都说完了，你可以`newInstance()`用传入的所需速度调用构造函数，你应该有一个可以使用的新实例。当然会有一些检查异常需要处理。

```
Class<?> clazz = Class.forName(s);
Constructor constructor = clazz.getConstructor(new Class[] {Integer.TYPE});
Toyota toyota = (Toyota) constructor.newInstance(new Object[] {90}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:20:14.360

您*可以*使用反射，但您需要一个完全限定的类名：

[https://stackoverflow.com/a/4030634/1217408](https://stackoverflow.com/a/4030634/1217408)

编辑：

Hovercraft Full Of Eels 关于使用`map`查找的评论在这种情况下可能更合适。

# coffeescript - 如何在翡翠咖啡脚本中发表评论

> ID：12790796
> 
> 赞同：4
> 
> 时间：2012-10-08T23:17:56.197
> 
> 标签：coffeescript, pug

我正在尝试在翡翠中使用咖啡脚本，而### 似乎不起作用。并且咖啡脚本中翡翠的块级注释不允许我评论一组行。它只允许基于注释的缩进的完整块。有什么建议么？？？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T11:09:23.070

`###`评论似乎对我有用（不要忘记这是多行评论，所以你需要关闭它们）：

```
!!! 5
html(lang='en')
  head
    title App

  body  
    :coffeescript
      ### Comment ###
      require "index"
      ###
      Comment 2
      ### 
```

编译为：

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>App</title>
  </head>
  <body> <script type="text/javascript">

/* Comment
*/

(function() {

  require("index");

  /*
  Comment 2
  */

}).call(this);
</script>
  </body>
</html> 
```

# jquery - Jquery查找当前底部css值

> ID：12790797
> 
> 赞同：0
> 
> 时间：2012-10-08T23:17:58.570
> 
> 标签：jquery, jquery-ui

我有一个由插件中的代码动态调整大小的元素。它的自定义滚动条插件位于[此处](http://manos.malihu.gr/jquery-custom-content-scroller)。

所以我将它用于我正在制作的这个小型全球聊天内容，基本上，我正在轮询数据库以查看是否有新消息，如果有，我正在更新聊天框并调整大小。一切正常。

什么不能正常工作，是我将它设置为在每次更新时自动滚动到底部。但是，如果您试图在框的顶部查看过去的事情，这可能会很烦人。所以基本上我在想我可以检查滚动条的滑块是否在确切的底部，然后使用插件底部功能将其保持在那里。但是，如果它不完全为 0，则将其留在原处。

但是，我不知道有一个 jquery 函数会像那样动态地触底。

当我尝试

```
alert($('.mCSB_container').css('bottom')); 
```

它只是说：自动；

有人知道计算这个的函数或方法吗？

这是插件呈现的html：

```
<div id="chat_messages_wrap" class="scrollbox mCustomScrollbar _mCS_1">
   <div class="mCustomScrollBox" id="mCSB_1" style="position:relative; height:100%; overflow:hidden; max-width:100%;">
      <div class="mCSB_container mCS_no_scrollbar" style="position: relative; top: 0px; ">                                              
         <div class="message_wrap" id="message_57">
            <span class="message_time">Mon Oct 08 2012 17:57:01</span>
            <div class="message_avatar_wrap"><img src="..."></div>
            <div class="message_message_wrap">
               <span class="message_username">EyeptchsRLame</span>
               <p class="message_message">hey there</p>
            </div>
            <div class="message_divider"></div>
         </div>
      </div>
      <div class="mCSB_scrollTools" style="position: absolute; display: none; ">
         <a class="mCSB_buttonUp" style="display:block; position:relative;"></a>
         <div class="mCSB_draggerContainer" style="position:relative;">
            <div class="mCSB_dragger" style="position: absolute; top: 0px; ">
               <div class="mCSB_dragger_bar" style="position:relative;"></div>
            </div>
            <div class="mCSB_draggerRail"></div>
         </div>
         <a class="mCSB_buttonDown" style="display:block; position:relative;"></a>
      </div>
   </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:23:21.987

您可以通过找到顶部值然后添加高度来找到元素的底部

```
var obj = $('.mCSB_container');
var bottom = obj.position().top + obj.height(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-14T02:36:23.323

正如 RTF 建议`position()`的那样，不考虑元素的填充、边框和边距。

您想使用jQuery 函数`offset().top`来查找渲染元素的`top`（也就是与文档顶部的距离），然后添加总渲染高度，**其中包括所选元素的边框、填充和（如果此函数的参数是设置为****) 边距。**`outerHeight()`**`true`**

它看起来像这样：

```
var container  = $('.mCSB_container'),
    top        = container.offset().top,
    height     = container.outerHeight(true),   // true to include margin
    bottom     = top + height + "px";           // add "px" so the browser has a unit to work with

console.log(bottom); 
```

# python-2.7 - 通过在 Windows 7 上轻松安装 Scipy 安装

> ID：12790800
> 
> 赞同：2
> 
> 时间：2012-10-08T23:18:29.150
> 
> 标签：python-2.7, scipy, blas, atlas

我尝试在 Windows 7 上安装 Scipy 我按照指南从这里[http://abel.ee.ucla.edu/cvxopt/install/index.html](http://abel.ee.ucla.edu/cvxopt/install/index.html)安装 ATLAS/BLAS但运行后`easy-install scipy`出现错误：

```
C:\Users\t>C:\Python27\Scripts\easy_install.exe scipy
Searching for scipy
Reading http://pypi.python.org/simple/scipy/
Reading http://www.scipy.org
Reading http://sourceforge.net/project/showfiles.php?group_id=27747&package_id=1
9531
Reading http://new.scipy.org/Wiki/Download
Best match: scipy 0.11.0
Downloading http://pypi.python.org/packages/source/s/scipy/scipy-0.11.0.zip#md5=
40b700ddde9ddab643b640fff7a9d753
Processing scipy-0.11.0.zip
Running scipy-0.11.0\setup.py -q bdist_egg --dist-dir c:\users\tszyro~1\appdata\
local\temp\easy_install-z05lfr\scipy-0.11.0\egg-dist-tmp-zxl8pc
Running from scipy source directory.
C:\Python27\lib\site-packages\numpy\distutils\system_info.py:1425: UserWarning:

    Atlas (http://math-atlas.sourceforge.net/) libraries not found.
    Directories to search for the libraries can be specified in the
    numpy/distutils/site.cfg file (section [atlas]) or by setting
    the ATLAS environment variable.
  warnings.warn(AtlasNotFoundError.__doc__)
C:\Python27\lib\site-packages\numpy\distutils\system_info.py:1434: UserWarning:

    Blas (http://www.netlib.org/blas/) libraries not found.
    Directories to search for the libraries can be specified in the
    numpy/distutils/site.cfg file (section [blas]) or by setting
    the BLAS environment variable.
   warnings.warn(BlasNotFoundError.__doc__)
C:\Python27\lib\site-packages\numpy\distutils\system_info.py:1437: UserWarning:

    Blas (http://www.netlib.org/blas/) sources not found.
    Directories to search for the sources can be specified in the
    numpy/distutils/site.cfg file (section [blas_src]) or by setting
    the BLAS_SRC environment variable.
  warnings.warn(BlasSrcNotFoundError.__doc__)
error:
    Blas (http://www.netlib.org/blas/) libraries not found.
    Directories to search for the libraries can be specified in the
    numpy/distutils/site.cfg file (section [blas]) or by setting
    the BLAS environment variable. 
```

我不知道我现在该怎么办。在 BLAS/ATLAS 安装期间，我没有收到任何警告，它似乎安装正常，尽管现在不知道如何检查它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-14T01:13:15.790

[您可以从http://www.scipy.org/install.html](http://www.scipy.org/install.html)选择任何预构建的二进制安装程序。比手动构建和安装要容易得多。

# ruby-on-rails - 如果我有两个模型并且需要对每个属性进行计算，我应该即时计算还是创建第三个模型？

> ID：12790805
> 
> 赞同：0
> 
> 时间：2012-10-08T23:18:44.513
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有两个模型 - `Score`& `Weight`。

这些模型中的每一个都有大约 5 个属性。

我需要能够`weighted_score`为 my创建一个`User`，这基本上是`Score.attribute_A`* `Weight.attribute_A`，`Score.attribute_B`*`Weight.attribute_B`等的产品。

我最好创建第三个模型 - 比如说`Weighted_Score`，我将每个属性的产品值存储在一行中`user_id`，然后在我需要特定`weighted_score`（例如`my_user.weighted_score.attribute_A`）时查询该表，或者我最好只是动态进行计算每次？

我是从效率的角度来问的。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:39:56.663

我认为答案取决于情况。如果计算非常昂贵，则创建第三张表可能是一个好主意，您不想让系统的其余部分陷入困境，并且可以立即向用户回复一条消息，说明计算将在未来。在这种情况下，您可以将处理卸载到后台工作人员并异步创建第三个模型的实例。此外，您应该[对表进行反规范化，](http://asktom.oracle.com/pls/apex/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:1092433274582)以便您可以直接访问它，而无需查找权重/分数记录。

其他一些想法：

1.  将优化重点放在具有许多记录的模型上。例如，如果 Weight 将只有 100 条记录，但 Score 可能是无限的，则将 Weight 加载到内存中，并将所有精力集中在优化 Score 查询上。
2.  在 calc 方法上使用[memoization](http://rails-bestpractices.com/posts/59-use-memoization)
3.  对最昂贵的操作/方法使用[缓存。](http://guides.rubyonrails.org/caching_with_rails.html)如果您不太关心值更新的频率，您可以每晚显式扫描缓存或其他内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:34:38.673

除非需要存储计算的分数（假设它发生了变化并且您想保留对它的更改），否则我看不到增加复杂性以将其存储在单独的表中的任何好处。

# visual-studio-2005 - 如何在 Visual Basic 2005 Express 中禁用“仅我的代码”？

> ID：12790806
> 
> 赞同：6
> 
> 时间：2012-10-08T23:18:51.843
> 
> 标签：visual-studio-2005, visual-studio-express

如何在 Visual Basic 2005 Express 中禁用“[仅我的代码](http://msdn.microsoft.com/en-us/library/h5e30exc%28v=vs.80%29.aspx)”？

它[应该](https://stackoverflow.com/questions/4649093/visual-studio-2010-debugger-steps-over-methods-and-doesnt-stop-at-breakpoints/4649220#4649220)在菜单*Tools* -> *Options* -> *Debugging* -> *Enable Just My Code*中，但我找不到它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T23:20:05.383

对于大多数 Express 版本，此选项在 Visual Studio 本身中不可用（但它在 Visual C# 2010 Express 中）。例如，在 Visual Studio 2008 中，选项对话框是：

![Visual Studio 2008 的选项对话框](../Images/ac4f64160e472b8e0badfa0c0c7d1e17.png)

但在 Express 版 Visual Basic 2005 Express 中，“调试”不可用 - 12 个中只有 4 个是：

![Visual Studio 2008 的选项对话框](../Images/088ed1a24e027b1792e80188efb95be4.png)

但是，可以通过设置文件更改“仅我的代码”设置`CurrentSettings.vssettings`：

1.  打开 Visual Basic Express 2005 的设置文件，`CurrentSettings.vssettings`（见下文）
2.  将 JustMyCode 的值从“1”更改为“0” - 替换`<PropertyValue name="JustMyCode">1</PropertyValue>`为`<PropertyValue name="JustMyCode">0</PropertyValue>`.
3.  保存文件，但使用不同的名称，例如`JustMyCodeOff_CurrentSettings.vssettings`.
4.  打开 Visual Basic 2005 速成版。
5.  打开菜单*Tools* -> *Import and Export Settings* -> *Import selected environment settings* (中间选项) -> *Next*。
6.  选择“不，只是导入新设置，覆盖我的当前设置”->*下一步*（因为我们已经在旧文件中有一个我们没有触及的备份副本）。
7.  按浏览到新的设置文件，例如`JustMyCodeOff_CurrentSettings.vssettings`.
8.  按下一步并完成。

请注意，设置文件中包含“Just My Code”的行非常长，超过 200,000 个字符，并非所有文本编辑器都能处理。安全的选择可能是使用十六进制编辑器将“1”更改为“0”。

一个常见的位置`CurrentSettings.vssettings`是：

```
C:\Documents and Settings\SomeUser\My Documents\Visual Studio 2005\Settings\VB Express\CurrentSettings.vssettings 
```

* * *

调试器的其他设置是：

*   确认删除所有断点
*   停止所有进程
*   StopOnExceptionCrossingManagedBoundary
*   启用地址级别调试
*   ShowDisassemblyWhenNoSource
*   启用断点约束
*   使用异常助手
*   自动展开异常
*   只是我的代码
*   ShowNonPublicMembers
*   WarnIfNoUserCodeOnLaunch
*   AllowImplicitFuncEval
*   允许字符串
*   使用源服务器
*   ShowSourceServerDiagnostics
*   AlwaysColorMarkerText
*   使用文档校验和
*   立即输出
*   ShowRawStructures
*   禁用 JIT 优化
*   显示无符号对话框
*   十六进制显示
*   十六进制输入
*   AddUnmappedBreakpointAtMappedLocation
*   StepIntoOnRestart
*   启用
*   ENCApplyChangesOnContinue
*   ENC欢迎
*   ENCStale代码警告
*   ENC预编译
*   ENC重新链接
*   NOENC允许编辑
*   NOENCI忽略
*   NOENC重建
*   确认发现文件
*   DisasmLineNumbers
*   模块ShowAll
*   使用 CodeSense
*   DisasmFields
*   调用堆栈视图选项
*   显示外部代码
*   源步单位
*   DisasmStepUnit
*   跨线程调用堆栈
*   保存远程转储
*   长评估超时
*   正常评估超时
*   快看超时
*   数据提示超时
*   AutosReturnValsTimeout
*   AutosRegistersTimeout
*   本地超时
*   寄存器超时
*   地址表达式超时
*   ScriptDocsTimeout
*   立即窗口超时
*   设置值超时
*   ShowNonprintableCharsAsGlyphs
*   显示系统进程
*   ShowProcessesFromAllSessions
*   增强数据提示
*   用户指定引擎
*   输出异常
*   OutputOnModuleLoad
*   OutputOnModuleUnload
*   OutputOnModuleSymbolSearch
*   OutputOnProcessDestroy
*   OutputOnThreadDestroy
*   OutputOnOutputDebugString
*   OutputOnDebuggerMessage
*   可变窗口图标
*   禁用附加安全警告
*   LoadDllExports
*   本机RPC
*   AllowSideEffectEval
*   启用WatchTipBar
*   AutoLoadFromSymbolPath
*   LoadSymbolsWhenSettingsChanged
*   一键编辑
*   OfferArrayExpansion
*   VariableWindowPromptOnLargeExpansion
*   变量WindowMaxSupportedChildren
*   PromptToAddSourceToIgnoreList
*   SourceServerExtractToDirectory
*   默认跟踪点消息
*   ProgramToDebugPath
*   AttachToProcessDefaultEngineList
*   安全源本地目录
*   符号路径
*   符号路径状态
*   符号缓存目录

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-19T12:43:12.837

您可以在选项窗口中选择“显示所有设置”。然后你还会看到调试选项，我猜（我有 VB 2010，在这里它以这种方式工作）。

# android - 使用 android 客户端创建 WCF https 服务器

> ID：12790808
> 
> 赞同：0
> 
> 时间：2012-10-08T23:18:56.090
> 
> 标签：android, wcf, encryption, https, certificate

我想将 Android 客户端连接到 WCF Webservice。有几个很好的指南描述了如何做到这一点，但 https 的概念对我来说真的很模糊。这是我想要的：

1) 自托管 WebService 通过 https 与经过身份验证的客户端进行通信。用户数据库驻留在 SQL Server 上。该服务必须是任何用户执行的“简单安装”。用户将在他/她的 PC 上安装该服务，然后从 google play 下载客户端，仅使用 ipadress 配置它。

问题：似乎不可能使用 WCF 执行此操作，因为 wshttp 看起来需要在 mashine 上安装证书。一种可能的前进方式是在安装过程中生成一个自签名证书，但是我怎样才能以用户友好的方式将证书发送给 android 客户端？

2) 在 Google Play 上发布的能够与服务通信的 Android 应用程序。发送到服务的数据既可以是简单数据类型（字符串和整数数据），也可以是 3-25Mb 的大型二进制文件。

安装该服务的用户只知道他的 IP 地址，因此不必为任何证书问题或其他技术细节而烦恼。一种选择可能是使用消息而不是传输安全，但我在这方面的知识非常有限。

服务器和客户端之间传递的信息属于个人信息，可能包含密码，包括使用密码的匹配网站、个人信息、日历事件等。它不会包含汇款单、信用卡号或帐号。

服务器和客户端的核心功能或多或少已经实现。我现在需要保护客户端和服务器之间的通信。

任何有关开发此方法的好方法的建议将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T14:23:27.977

我想将服务器服务部署到最终用户的方式使得很难将 WCF 与 ssl 一起使用。其他选项会产生其他问题。我现在已经放弃了这个特定项目的 WCF，转而使用 Bouncy Castle、SslSocket 和自定义协议进行良好的旧套接字编程。这可能是我矫枉过正，但让我可以完全控制身份验证证书管理和正在发送的数据。我使用带有自签名证书的 ssl 并覆盖 android 中的证书验证方法，手动验证证书中的所有数据，除了重新解析主机名......对我来说足够了，因为我使用预共享密钥来加密和解密数据。

感谢所有帮助

# django - Django 查询计数总是返回 0

> ID：12790810
> 
> 赞同：2
> 
> 时间：2012-10-08T23:19:07.760
> 
> 标签：django, django-queryset

这是我的模型：

```
class People(models.Model):
    name = models.CharField(max_length=100)
    lastname = models.CharField(max_length=100) 
```

在views.py

- 当我尝试这个来计算空的姓氏字段时：

```
People.objects.filter(lastname__isnull=True).count() 
```

尽管有一些空的姓氏字段，但它始终返回 0 事件。

为什么我得到 0，我的代码是否有任何问题，或者是否有任何其他方法可以计算表中的空字段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T23:28:40.673

您`CharField`最有可能存储空字符串，而不是 NULL

[关于空字段值的 Django 文档](https://docs.djangoproject.com/en/dev/ref/models/fields/#null)

> Field.null
> 如果为 True，Django 会将空值作为 NULL 存储在数据库中。默认为假。
> 
> 请注意，空字符串值将始终存储为空字符串，而不是 NULL。仅对非字符串字段（例如整数、布尔值和日期）使用 null=True。对于这两种类型的字段，如果您希望在表单中允许空值，您还需要设置 blank=True，因为 null 参数仅影响数据库存储（请参阅空白）。
> 
> 除非您有充分的理由，否则请避免在基于字符串的字段（例如 CharField 和 TextField）上使用 null。如果基于字符串的字段具有 null=True，这意味着它有两个可能的“无数据”值：NULL 和空字符串。在大多数情况下，“无数据”有两个可能的值是多余的；Django 约定是使用空字符串，而不是 NULL。

尝试将您的查询更改为：

```
People.objects.filter(lastname="").count() 
```

Empty is not the same as NULL. You would have needed to set your fields to have `null=True`, which as the docs suggest, is not recommended for a CharField.

# ruby - 从 FP 的角度来看，在 YARV Ruby 中创建线程通常被视为副作用吗？

> ID：12790815
> 
> 赞同：2
> 
> 时间：2012-10-08T23:19:24.033
> 
> 标签：ruby, multithreading, functional-programming, side-effects

如果 Ruby 方法创建线程，但在方法中连接它们，从函数式编程的角度来看，这是否仍被视为副作用？我正在使用的实现是 YARV Ruby，其中线程由操作系统创建，尽管使用 GVL（全局 VM 锁）。

创建线程的原因是进行`system`调用，这无论如何都是副作用，但我从未遇到任何人说线程是否是副作用。

简化的伪代码如下所示：

```
 def run_tasks
    input_files = (1..4).map {|i| "input_#{i}"}
    output_files = (1..4).map {|i| "output_#{i}"}
    threads = [input_files, output_files].transpose.map |input_file, output_file|
      # system itself is a side effect
      Thread.new { system(["sub_program.rb", input_file, output_file]) }
    end
    threads.map(&:join)
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T10:42:22.830

*如果线程除了接收初始参数并返回一些最终结果或使用任何其他*副作用之外没有以任何方式进行通信，那么线程的使用可以被认为是纯粹的。

如果可以将“生成一个线程以运行计算 X 然后获取其结果”的代码替换为仅说“运行计算 X”的代码，除了更改运行时量之外没有任何影响，那么它就是纯粹的。如果你不能这样做，那么线程正在做一些副作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:38:48.107

[时间的流逝很少被认为是副作用](http://en.wikipedia.org/wiki/Side_effect_%28computer_science%29#Temporal_side_effects)，因此使用线程来减少发生的时间并不是副作用。这类似于使用记忆来提高性能，这也不是副作用，即使它修改了隐藏状态。

请注意，这`input_files.zip(output_files)`将与 一样好`[input_files, output_files].transpose`，并且可以更好地传达您的意图。

# iphone - MKMapView initWithFrame 不使用 ARC 释放内存

> ID：12790817
> 
> 赞同：5
> 
> 时间：2012-10-08T23:19:41.017
> 
> 标签：iphone, ios, memory-leaks, mkmapview, automatic-ref-counting

我一直在使用工具来查找未正确释放的分配。我有 MKMapViewDelegate 在实例化后通过实例方法添加地图。我可以在调用树中看到，在 ViewDelegate 释放后，此方法一直保留大约 300KB 的内存。我注释掉了代码的主要部分，它仍然只用这一行来维护内存：

```
self.map = [[MKMapView alloc] initWithFrame:CGRectMake(10, 210, 300, 125)]; 
```

我查看对象列表，MKMapView 本身并不存在，但是当我不断创建新的 ViewDelegates 时，内存不断增加。以下是地图的定义方式：

```
@property (strong, nonatomic)        MKMapView *map; 
```

地图的委托设置为 nil，以及 ViewDelegate 的 dealloc 上的引用

```
self.map.delegate = nil;
self.map = nil; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T01:08:40.723

一旦你将委托设置为 nil，就不再有任何指针，iOS 会在需要时释放它。iOS 设置为 nil 后可能不会立即释放内存。

请记住，您通过将*指针*设置为 nil 来删除指针，但对象仍然保留在堆上，基本上什么都不做，直到那里分配了其他东西。

（我假设您还使用 MKMapView 从其超级视图中删除了`[self.map removeFromSuperView]`）。

# uml - 如何在活动图中使用扩展关系分支到另一个用例？

> ID：12790819
> 
> 赞同：0
> 
> 时间：2012-10-08T23:19:58.960
> 
> 标签：uml, activity-diagram

很抱歉问另一个新手问题，但现在我正在将 UML 图转换为活动图。我需要将我的活动图分支到两个不同的用例，每个用例在 UML 图表上都有扩展关系。我用什么符号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T16:18:21.943

我认为您可以为此使用呼叫行为操作。

# c++ - 将内存映射的数据块读入结构

> ID：12790820
> 
> 赞同：1
> 
> 时间：2012-10-08T23:20:01.017
> 
> 标签：c++, windows, memory-mapping

我今天一直在 VC++ 2008 上玩内存映射，但我仍然没有完全理解如何使用它，或者它是否适合我的目的。我的目标是快速读取一个非常大的二进制文件。

我有一个结构：

```
typedef struct _data
{
    int number;
    char character[512];
    float *entries;
}Data; 
```

它被多次写入文件。“条目”变量是浮点小数数组。写完这个文件（10000 个数据结构，每个“条目”数组是 90000 个浮点数）后，我尝试使用以下函数对这个文件进行内存映射，以便我可以更快地读取数据。这是我到目前为止所拥有的：

```
void readDataMmap(char *fname,      //name of file containing my data
                  int arraySize,    //number of values in struct Data
                  int entrySize)    //number of values in each "entries" array
{
    //Read and mem map the file
    HANDLE hFile = INVALID_HANDLE_VALUE;
    HANDLE hMapFile;
    char* pBuf;

    int fd = open(fname, O_RDONLY);
    if(fd == -1){
        printf("Error: read failed");
        exit(-1);
    }

    hFile = CreateFile((TCHAR*)fname, 
                       GENERIC_READ,          // open for reading 
                       0,                     // do not share 
                       NULL,                  // default security 
                       OPEN_EXISTING,         // existing file only 
                       FILE_ATTRIBUTE_NORMAL, // normal file 
                       NULL);                 // no template

    if (hFile == INVALID_HANDLE_VALUE) 
    { 
        printf("First CreateFile failed"));
        return (1);
    } 

    hMapFile = CreateFileMapping(hFile,
         NULL,                    // default security
         PAGE_READWRITE,
         0,                       // max. object size
         0,                    // buffer size
         NULL);                 // name of mapping object

    if(hMapFile == ERROR_FILE_INVALID){
        printf("File Mapping failed");
        return(2);
    }

    pBuf = (char*) MapViewOfFile(hMapFile,   // handle to map object
                        FILE_MAP_READ, // read/write permission
                        0,
                        0,
                        0);         //Was NULL, 0 should represent full file bytesToMap size
    if (pBuf == NULL)
    {
      printf("Could not map view of file\n");
      CloseHandle(hMapFile);

      return 1;
    }

    //Allocate data structure
    Data *inData = new Data[arraySize];
    for(int i = 0; i<arraySize; i++)inData[i].entries = new float[entrySize];

    int pos = 0;
    for(int i = 0; i < arraySize; i++)
    {
        //This is where I'm not sure what to do with the memory block
    }
} 
```

在函数结束时，在内存被映射并且我返回一个指向内存块“pBuf”开头的指针之后，我不知道该怎么做才能将该内存块读回我的数据中结构体。所以最终我想把这块内存转移回我的 10000 个数据结构条目的数组中。当然，我这样做可能完全错了......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-08T23:34:35.697

处理内存映射文件实际上与处理任何其他类型的内存指针没有什么不同。内存映射文件只是一个数据块，您可以使用相同的名称从任何进程读取和写入。

我假设您想将文件加载到内存映射中，然后在那里随意读取和更新它，并以某个定期或已知的间隔将其转储到文件中，对吗？如果是这种情况，那么只需从文件中读取并将数据复制到内存映射指针即可。稍后您可以从地图中读取数据并将其转换为内存对齐结构并随意使用您的结构。

如果我是你，我可能会创建一些辅助方法，例如

`data ReadData(void *ptr)`

和

`void WriteData(data *ptrToData, void *ptr)`

`*ptr`内存映射地址在哪里，`*ptrToData`是指向要写入内存的数据结构的指针。在这一点上，它的内存是否映射并不重要，如果你想从加载到本地内存中的文件中读取，你也可以这样做。

您可以使用 memcpy 将数据从源复制到目标，以与任何其他块数据相同的方式读取/写入它，并且您可以使用指针算法来推进数据中的位置。不要担心“内存映射”，它只是一个指向内存的指针，你可以这样对待它。

此外，由于您将要处理直接内存指针，因此您不需要将每个元素一个一个地写入映射文件，您可以将它们全部写入一批，例如

`memcpy(mapPointer, data->entries, sizeof(float)*number)`

它将浮点 * 条目大小从`data->entries`映射指针起始地址复制。显然，您可以根据需要在任何地方复制它，这只是一个示例。请参阅[http://www.devx.com/tips/Tip/13291](http://www.devx.com/tips/Tip/13291)。

以你会做的方式读回数据是类似的，但是你想明确地将内存地址复制到一个已知的位置，所以想象一下你的结构是扁平的。代替

```
data:
  int
  char * -> points to some address
  float * -> points to some address 
```

如果您的指针指向其他地方的其他内存，请像这样复制内存

```
data:
  int 
  char * -> copy of original ptr
  float * -> copy of original ptr
512 values of char array 
number of values of float array 
```

因此，您可以通过这种方式将内存映射中的数据“重新序列化”到本地。请记住，数组只是指向内存的指针。内存不必在对象中是连续的，因为它可以在另一个时间分配。您需要确保将指针指向的实际数据复制到内存映射。这样做的一种常见方法是将对象直接写入内存映射，然后使用所有扁平数组跟随对象。读回它首先读取对象，然后将指针递增`sizeof(object)`并读取下一个数组，然后再将指针递增`arraysize`等。

这是一个例子：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct data{
    int size;
    char items[512];
    float * dataPoints;
};

void writeToBuffer(data *input, char *buffer){
    int sizeOfData = sizeof(data);
    int dataPointsSize = sizeof(float) * input->size;

    printf("size of data %d\n", sizeOfData);

    memcpy(buffer, input, sizeOfData);

    printf("pointer to dataPoints of original %x\n", input->dataPoints);

    memcpy(buffer + sizeOfData, input->dataPoints, dataPointsSize);
}

void readFromBuffer(data *target, char * buffer){
    memcpy(target, buffer, sizeof(data));

    printf("pointer to datapoints of copy %x, same as original\n", target->dataPoints);

    // give ourselves a new array
    target->dataPoints =  (float *)malloc(target->size * sizeof(float));

    // do a deep copy, since we just copied the same pointer from 
    // the previous data into our local

    memcpy(target->dataPoints, buffer + sizeof(data), target->size * sizeof(float));

    printf("pointer to datapoints of copy %x, now it's own copy\n", target->dataPoints);
}

int main(int argc, char* argv[])
{
    data test;

    for(unsigned int i=0;i<512;i++){
        test.items[i] = i;
    }

    test.size = 10;

    // create an array and populate the data
    test.dataPoints = new float[test.size];

    for(unsigned int i=0;i<test.size;i++){
        test.dataPoints[i] = (float)i * (1000.0);
    }

    // print it out for demosntration
    for(unsigned int i=0;i<test.size;i++){
        printf("data point value %d: %f\n", i, test.dataPoints[i]);
    }

    // create a memory buffer. this is no different than the shared memory
    char * memBuffer = (char*)malloc(sizeof(data) + 512 + sizeof(float) * test.size + 200);

    // create a target we'll load values into
    data test2;

    // write the original out to the memory buffer
    writeToBuffer(&test, memBuffer);

    // read from the memory buffer into the target
    readFromBuffer(&test2, memBuffer);

    // print for demonstration
    printf("copy number %d\n", test2.size);
    for(int i=0;i<test2.size;i++){
        printf("\tcopy value %d: %f\n", i, test2.dataPoints[i]);
    }

    // memory cleanup

    delete memBuffer;
    delete [] test.dataPoints;

    return 0;
} 
```

在将数据从结构写入内存时，您可能还想了解数据对齐。检查[使用打包结构](http://msdn.microsoft.com/en-us/library/ms253935%28v=vs.80%29.aspx)、[C++ 结构对齐问题](https://stackoverflow.com/questions/1455458/c-struct-alignment-question)和[数据结构对齐](http://en.wikipedia.org/wiki/Data_structure_alignment)。

如果您在读取时不提前知道数据的大小，则应将数据的大小写入内存映射开头的已知位置以供以后使用。

无论如何，为了解决它是否正确在这里使用它的事实，我认为它是正确的。来自[维基百科](http://en.wikipedia.org/wiki/Memory-mapped_file#Benefits)

> 内存映射文件的主要好处是提高 I/O 性能，尤其是在用于大文件时。...内存映射过程由虚拟内存管理器处理，虚拟内存管理器与负责处理页面文件的子系统相同。内存映射文件一次加载一整页到内存中。页面大小由操作系统选择以获得最佳性能。由于页面文件管理是虚拟内存系统中最关键的元素之一，因此将文件的页面大小部分加载到物理内存中通常是非常高度优化的系统功能。

您要将整个内容加载到虚拟内存中，然后操作系统可以根据需要为您将文件分页进出内存，从而创建“延迟加载”机制。

综上所述，内存映射是共享的，因此如果它跨越进程边界，您将希望将它们与命名互斥锁同步，这样您就不会覆盖进程之间的数据。

# jsf-2 - JSF 导航案例不导航

> ID：12790825
> 
> 赞同：0
> 
> 时间：2012-10-08T23:20:24.820
> 
> 标签：jsf-2, primefaces

当我单击搜索按钮时，我试图让我的 index.xhtml 将我带到另一个带有结果的页面。我正在使用 primefaces JSF。

我的问题是我无法让它进入下一页。它正在调用我的 searchController beans findItem 方法，但结果页面没有改变。它只是停留在 index.xhtml 页面上。

有人有想法吗？

```
@ManagedBean(name="sController")
@RequestScoped
public class SController implements Serializable {
    private static final long serialVersionUID = 1L;

    public SController() { }

    public String findItem() {
        System.out.println("findItem called!");

        return "success";
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }
} 
```

这是我的 faces-config.xml。

```
<?xml version="1.0" encoding="UTF-8"?>
<faces-config 
    xmlns="http://java.sun.com/xml/ns/javaee" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd"
    version="2.0">

<navigation-rule>
    <from-view-id>/index.xhtml</from-view-id>
    <navigation-case>
        <from-action>#{sController.findItem}</from-action>
        <from-outcome>success</from-outcome>
        <to-view-id>/items.xhtml</to-view-id>
    </navigation-case>
</navigation-rule>
</faces-config> 
```

这是我的 index.xhtml。

```
<f:view>
<h:form>
    <p:panel id="search" header="Search Item">
        <p:panelGrid columns="2" cellpadding="5">

            <h:outputLabel value="Name" for="name"/>
            <p:inputText id="name" value="#{sController.name}"/>

        </p:panelGrid>
    </p:panel>

    <p:commandButton value="Search" 
        actionListener="#{sController.findItem}"/>
</h:form>
</f:view> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T01:00:59.990

这是一种解决方法。为了其他可能访问此页面时遇到相同问题的人的利益，您的页面无法导航，因为您在`actionListener`属性中使用的方法表达式不应该在那里使用（那里只允许使用[ActionListener](http://www.mkyong.com/jsf2/jsf-2-actionlistener-example/)类型的方法）。`action`在命令按钮的属性中使用该方法。

正确实现`ActionListener`接口的方法具有返回类型，`void`因此不会隐式执行任何基于 JSF 的导航。然而，返回类型的正则方法表达式`String`用于基于 JSF 的导航。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T05:12:31.523

1.  删除你的 faces-config 文件（正如你所指出的）
2.  用动作替换 actionListener：

    `<p:commandButton value="Search" action="#{sController.findItem}"/>`

3.  附加`faces-redirect=true`到您返回的字符串以重定向到*成功*页面：

    ```
    public String findItem() {
        System.out.println("findItem called!");

        return "success?faces-redirect=true";
    } 
    ```

# robotium - 使用 Robotium 测试 4 次点击深度的活动

> ID：12790828
> 
> 赞同：0
> 
> 时间：2012-10-08T23:21:14.193
> 
> 标签：robotium

我有一个家庭活动 ActivityA，它有一个创建意图的按钮，设置一些 Extras 并调用 ActivityB。这又调用了 ActivityC ，然后又调用了 ActivityD。我不想编写一个打开 ActivityA 并继续钻取 4 个活动以到达我想要测试的活动的测试用例。如何设置 ActivityD 在启动时所需的 Extras 以防止我的代码出现错误。例如，在我调用启动 activityD 的意图之前，它会设置一个 Extra，然后 ActivityD 会使用它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T12:18:44.577

Robotium 为您提供了启动具有给定意图的活动的选项，您需要确定正确启动活动所需的意图。如果您查看 logcat，它可能会为您提供正确启动活动所需的详细信息。如果您不确定要查找什么，请发布单击活动 C 上的元素和活动 D 启动之间的时间的 logcat 日志，我可以尝试寻找您。

# jquery - 悬停添加类上的jQuery

> ID：12790830
> 
> 赞同：0
> 
> 时间：2012-10-08T23:21:19.200
> 
> 标签：jquery, css

我知道使用 CSS，将鼠标悬停在一个元素上不能更改嵌套在给定元素内的元素的属性。因此，我一直在使用 jquery 来更改嵌套在给定元素内的元素的属性。我的代码如下：

```
<?php
    for($i=0;$i<$count;$i++)
    {
?>   
   <tr>
       <td>Sample</td>
       <td>Text</td>
   </tr>
<?php
    }
?>
<script type="text/javascript">
    $(document).ready(function(){

   $('tr').each(function(index) {
        $(this).hover(function() {  
            $(this).css("color", "#ffffff");    
            $(this).css("background-color", "#0080ff");
        });

        $(this).mouseout(function() {   
            $(this).css("color", "#222222");
            $(this).css("background-color", "#f0f0f0"); 
        });
    });
});
</script> 
```

问题是，一旦我将鼠标悬停在标签上，我就会触发 mouseout 动作，并且字体颜色正在切换回 #222222，我希望它是这样的，只要我将鼠标悬停在标签上或其中任何内容，行的背景颜色设置为#0080ff，字体颜色设置为#ffffff。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T23:28:23.880

我认为您可以使用 CSS 来定位对象内的元素。

在你的情况下：

```
tr {
    color: #222;
    background-color: #f0f0f0;
}

tr:hover {
    color: #fff;
    background-color: #0080ff;
} 
```

这是[jsfiddle](http://jsfiddle.net/Cn8VJ/)

看起来你的 javascript 正在做什么 - 更改 CSS 属性。我是否正确解释了您的问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:24:13.657

您应该使用`hover()`. 您的代码应如下所示：

```
$('tr').each(function(index) {
        $(this).hover(function() {  
            $(this).css("color", "#ffffff");    
            $(this).css("background-color", "#0080ff");
        }, function(){   
            $(this).css("color", "#222222");
            $(this).css("background-color", "#f0f0f0"); 
        });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T23:24:50.167

您需要`mouseleave`，因为只有当鼠标完全在元素之外而不是在元素子元素上时才会触发。所以

```
$(this).mouseout(...) 
```

应该

```
$(this).mouseleave(...) 
```

或者你可以简单地做

```
$('tr').each(function(index) {
    $(this).hover(function() {  
        $(this).css("color", "#ffffff");    
        $(this).css("background-color", "#0080ff");
    }, function() {   
        $(this).css("color", "#222222");
        $(this).css("background-color", "#f0f0f0"); 
    });
}); 
```

它实际上将第一个函数绑定为`mouseenter`处理程序，将第二个函数绑定为`mouseleave`处理程序。

# scroll - 使用随文本滚动的背景设置文本区域的样式？

> ID：12790831
> 
> 赞同：0
> 
> 时间：2012-10-08T23:21:23.110
> 
> 标签：scroll, textarea, notepad

我正在尝试创建一个带有记事本背景的文本区域（例如： http: [//www.bookofzeus.com/articles/css-styling-textarea-give-notebook-notepad-look/](http://www.bookofzeus.com/articles/css-styling-textarea-give-notebook-notepad-look/)），但我遇到了该示例中的相同问题是，当文本超出高度并能够滚动时，背景不会随之滚动，因此只有文本漂浮在所有行上时看起来很糟糕。有什么方法可以让背景随着文本滚动而移动，看起来就像在纸上真实写字一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:40:32.360

我不知道是否有纯 CSS 方法。这是一种使用 jQuery 的方法。

它将背景 y 位置与滚动位置重新对齐。

[http://jsfiddle.net/WTCUK/](http://jsfiddle.net/WTCUK/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:49:16.607

也许：

```
<html>
  <head>
    <style>
      #fake_textarea{
        width:925px; 
        min-height:100%;
        background-repeat: repeat-y;
        background: url(http://www.artsinmotion.net/notebook_paper.jpg);
        padding-left:100px;
        font-family:arial;
      }

      #wrapper{
        width:1025px; 
        height:500px;
        overflow: auto;
      }
    </style>
  </head>
  <body>
    <div id='wrapper'>
      <div id='fake_textarea' contenteditable></div>
    </div>
  </body>
 </html> 
```

# git - Git 不会删除未跟踪的文件

> ID：12790838
> 
> 赞同：1
> 
> 时间：2012-10-08T23:21:48.523
> 
> 标签：git

我今天从我们的 staging 中撤出，发现之前其他人推送的代码已损坏。所以我做到了`git reset --hard <previous commit>`。这无济于事。

我可以`git reset`做任何我想要的傻事，所有合并的更改仍然存在于我的本地副本中。因此，我一直在阅读我可以重置拉动的每一种排列方式，尝试`reset`, `revert`, `clean`, 等等，但无论我采用哪种方法，我都无法恢复拉动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:25:50.077

运行`git log`并选择适合您的最后一次提交的哈希；然后给`git reset --hard $HASH`，您的本地副本将被还原。

如果它不起作用，请提供您已执行的命令及其各自的输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:29:29.910

如果你只想返回一个提交，你可以做`git checkout HEAD^`

如果你想回到旧的提交。

1.  混帐日志
2.  找出
3.  做一个 git checkout HASH 或 git checkout -b state HASH

# macos - MacOSX 10.8.2：如何清除不需要的电源管理断言？

> ID：12790844
> 
> 赞同：14
> 
> 时间：2012-10-08T23:22:52.680
> 
> 标签：macos, osx-mountain-lion, power-management, assertions

有一些在 MacOSX Mountain Lion 下运行的程序现在（自安装 10.8.2 以来）会导致设置不需要的电源管理断言。我正在寻找一种方法来清除这些断言。

这是一个示例：这些程序中的一个或多个导致在“powerd”中设置以下电源管理断言。注意下面的“powerd”行...

```
% pmset -g assertions    
10/7/12 11:51:47 AM EDT  
Assertion status system-wide:
   PreventUserIdleDisplaySleep    1
   CPUBoundAssertion              0
   PreventSystemSleep             0
   PreventUserIdleSystemSleep     0
   ExternalMedia                  0
   UserIsActive                   0
   ApplePushServiceTask           0
   BackgroundTask                 0

Listed by owning process:
  pid 18(powerd): [0x00000005000001d7] 11:24:18 PreventUserIdleDisplaySleep named: "com.apple.powermanagement.delayDisplayOff" 
... etc. ... 
```

这些程序退出并在“powerd”中保留此电源管理断言，并且它永远保持活动状态。这可以防止“显示睡眠”和屏幕保护程序被调用。

在这种情况下，我知道的唯一选择（除了重新启动）是在“powerd”进程上执行“kill -HUP”。这会导致该守护进程退出并重新启动而没有错误的断言。

有谁知道我在 10.8.2 下清除“powerd”中的“PreventUserIdleDisplaySleep”断言，而不强制重新启动该守护进程？如有必要，我很乐意通过 Cocoa、Carbon 或 AppleScript 程序执行此操作。

我知道[IOPMLib](https://developer.apple.com/library/mac/#documentation/IOKit/Reference/IOPMLib_header_reference/Reference/reference.html)，但该库中的例程似乎只能清除在同一进程中创建的电源断言。***我需要一种方法来告诉外部和已经运行的“powerd”进程来清除它***管理的“PreventUserIdleDisplaySleep”断言。有谁知道用于在运行的“供电”实例中从外部设置和清除电源管理断言的 API？也许通过某种通知... ???

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-27T13:55:44.150

答案很简单。我有同样的问题。

对以下文件夹进行备份，这些文件夹可以在`/Library/LaunchAgents/LaunchDaemons/Internet Plug-ins`. 下一个。清空文件夹的内容。然后重启你的mac。测试您的能量设置或仅在终端 ( `pmset -g assertions`) 中测试。你的问题应该得到解决。您可以将文件一一放回以找到导致问题的文件或保留它。

当您使用 Safari 并且缺少插件时，您会弹出一个窗口。您可以简单地重新安装它们。无论哪种方式，您的 mac 都应该可以正常工作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-25T04:18:37.980

[从这里摘录](http://mactips.dwhoard.com/mactips/system/display-sleep)

它说狮子，但这是你看到的同样的问题。

pmset -g

pmset -g 断言

ps -ax | grep [pid 运行]

kill -9 [pid 运行]

# c# - Linux/Mono 上的 YSOD 故障排除

> ID：12790846
> 
> 赞同：0
> 
> 时间：2012-10-08T23:23:23.337
> 
> 标签：c#, linux, fluent-nhibernate, mono, ysod

我似乎有一个无法在我的 Windows 测试环境中复制的 Mono 问题，在该环境中我得到一个如下所示的 YSOD：

```
Server Error in '/' Application

Object reference not set to an instance of an object

Description: HTTP 500\. Error processing request.

Stack Trace:

System.NullReferenceException: Object reference not set to an instance of an object
  at FluentNHibernate.Visitors.DefaultMappingModelVisitor.Visit (FluentNHibernate.MappingModel.ColumnMapping columnMapping) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.MappingModel.KeyMapping.AcceptVisitor (IMappingModelVisitor visitor) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.Visitors.DefaultMappingModelVisitor.Visit (FluentNHibernate.MappingModel.KeyMapping keyMapping) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.MappingModel.ClassBased.SubclassMapping.AcceptVisitor (IMappingModelVisitor visitor) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.Visitors.DefaultMappingModelVisitor.Visit (FluentNHibernate.MappingModel.ClassBased.SubclassMapping subclassMapping) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.MappingModel.ClassBased.ClassMappingBase.AcceptVisitor (IMappingModelVisitor visitor) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.MappingModel.ClassBased.ClassMapping.AcceptVisitor (IMappingModelVisitor visitor) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.Visitors.DefaultMappingModelVisitor.Visit (FluentNHibernate.MappingModel.ClassBased.ClassMapping classMapping) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.MappingModel.HibernateMapping.AcceptVisitor (IMappingModelVisitor visitor) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.Visitors.DefaultMappingModelVisitor.<Visit>b__0 (FluentNHibernate.MappingModel.HibernateMapping x) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.Utils.CollectionExtensions.Each[HibernateMapping] (IEnumerable`1 enumerable, System.Action`1 each) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.Visitors.DefaultMappingModelVisitor.Visit (IEnumerable`1 mappings) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.PersistenceModel.ApplyVisitors (IEnumerable`1 mappings) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.PersistenceModel.BuildMappings () [0x00000] in <filename unknown>:0 
  at FluentNHibernate.PersistenceModel.EnsureMappingsBuilt () [0x00000] in <filename unknown>:0 
  at FluentNHibernate.PersistenceModel.Configure (NHibernate.Cfg.Configuration cfg) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.Cfg.MappingConfiguration.Apply (NHibernate.Cfg.Configuration cfg) [0x00000] in <filename unknown>:0 
  at FluentNHibernate.Cfg.FluentConfiguration.BuildConfiguration () [0x00000] in <filename unknown>:0 
Version information: Mono Runtime Version: 2.10.8.1 (Debian 2.10.8.1-1ubuntu2.2); ASP.NET Version: 4.0.30319.1 
```

我正在挠头如何解决这个问题。标准调试工具明显缺失。是否有一些机制来收集行号和上下文信息来研究这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T02:39:56.230

好的，我想通了，但这里的答案太长了。[我在这里](http://aclassicgeek.blogspot.com/2012/10/mono-and-fluentnhibernate.html)写了一篇博客（是的，我承认这是一个杂牌）。

# c# - 删除 Visual Studio 中未使用的代码

> ID：12790848
> 
> 赞同：31
> 
> 时间：2012-10-08T23:23:52.627
> 
> 标签：c#, .net, visual-studio-2010, visual-studio, code-cleanup

关于这个问题：“[删除未使用的引用（！=“使用”）](https://stackoverflow.com/questions/81597/remove-unused-references-using) ”，我想知道是否有一个工具可以从 Visual Studio 解决方案中删除未使用的类、结构、委托等。

**设想：**

我有一个杂乱无章的 Visual Studio 解决方案，其中包含 1000 个：

*   本机方法导入
*   结构
*   代表们
*   枚举

而不是通过单击“查找所有引用”并确定代码是否在某处使用的每个文件，是否有任何机制可以让我轻松删除冗余代码文件？

**例子：**

```
//This class contains a method called getRandomValue which returns type RANDOM
public class NativeMethods
{
    [DllImport("random.dll")]
    public static extern RANDOM getRandomValue();
}

//This is the RANDOM object as referenced by getRandomValue();
[StructLayout(LayoutKind.Sequential)]
public struct RANDOM
{
    uint a;
    uint b;
    uint c;
}

//This is redundant since nothing is referencing it.
[StructLayout(LayoutKind.Sequential)]
public struct MESSAGE
{
    IntPtr sender;
    IntPtr recipient;
    char[] mText;
} 
```

**注意自我：**

我的直觉是这会很棘手，因为与 Java 不同，对象名称不必与文件名相同，并且多个对象声明可以驻留在单个文件中，但是在这种情况下（我的场景）每个对象都是在自己的文件中声明（具有相同的名称）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-09T01:34:59.700

ReSharper 是清理代码的最佳选择。

[借助ReSharper Early Access Program](http://confluence.jetbrains.net/display/ReSharper/ReSharper+Early+Access+Program)，您可以免费使用它。

![在此处输入图像描述](../Images/69e886b3b5880e0d47898d6e121d8661.png)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-08T23:40:16.050

您可以使用多种工具来执行此操作：

*   [FxCop](http://www.microsoft.com/en-us/download/details.aspx?id=6544)（免费）
*   [NDepend](http://www.ndepend.com/)（付费）
*   [Resharper](http://www.jetbrains.com/resharper/)（付费）

FxCop 只会找到未使用的内部代码和私有代码。当然，如果您确保只公开公开需要在程序集之外访问的代码，那么这应该足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-13T08:09:03.830

正如@Ergwun 所指出的，工具[NDepend](http://www.NDepend.com)可以帮助查找未使用的方法、字段和类型。

详细说明一下，NDepend 建议[在 LINQ 查询 (CQLinq) 上编写代码规则](http://www.ndepend.com/Features.aspx#CQL)。提出了大约[200 条默认代码规则](http://www.ndepend.com/DefaultRules/webframe.html)，其中 3 条专用于*未使用/死代码*检测

基本上这样的规则来检测未使用的方法，例如：

```
// <Name>Dead Methods</Name>
warnif count > 0 
from m in Application.Methods where !m.MethodsCallingMe.Any()
select m 
```

[![NDepend 规则查找未使用的方法（死方法）](../Images/e001d52c4aa8471f4074a6d296fe9413.png)](https://i.stack.imgur.com/LLfeT.png)

但这条规则很幼稚，会返回微不足道的误报。在许多情况下，一个方法从未被调用但它未被使用（入口点、类构造函数、终结器......）这就是为什么 3 个默认规则更加详细的原因：

*   [潜在的死类型](http://www.ndepend.com/DefaultRules/webframe.html?Q_Potentially_dead_Types.html)（因此检测未使用的类、结构、接口、委托......）
*   [可能死掉的方法](http://www.ndepend.com/DefaultRules/webframe.html?Q_Potentially_dead_Methods.html)
*   [潜在死区](http://www.ndepend.com/DefaultRules/webframe.html?Q_Potentially_dead_Fields.html)

NDepend 集成在 Visual Studio 2017、2015、2013、2012、2010 中，因此可以[在 IDE 中检查/浏览/编辑](http://www.ndepend.com/Doc_VS_CQL.aspx)这些规则。该工具还可以集成到您的 CI 流程中，它可以构建[报告](http://www.ndepend.com/SampleReports.aspx)，显示违反规则和罪魁祸首代码元素。NDepend 还有一个[VS Team Services 扩展](https://marketplace.visualstudio.com/items?itemName=ndepend.ndependextension)。

如果你点击上面这3个链接查看这些规则的源代码，你会发现关于类型和方法的部分有点复杂。这是因为它们不仅检测未使用的类型和方法，还检测*仅*由未使用的死类型和方法（递归）使用的类型和方法。

这是*静态分析*，因此规则名称中的前缀*可能是。*如果*仅*通过反射使用代码元素，则这些规则可能会将其视为未使用，但事实并非如此。

除了使用这 3 条规则之外，我还建议通过测试来衡量代码覆盖率并争取完全覆盖。通常，您会看到测试无法覆盖的代码实际上是可以安全丢弃的*未使用/死代码。*这在不清楚代码分支是否可达的复杂算法中特别有用。

*免责声明：我为 NDepend 工作。*

# android - Android 地图缩放

> ID：12790851
> 
> 赞同：0
> 
> 时间：2012-10-08T23:24:31.677
> 
> 标签：android, google-maps

我正在尝试制作一个使用 Google maps API mapviews 的应用程序，我的问题是，在构建应用程序时，我意识到 Google 地图上的道路在放大时会缩小，并想知道是否有任何方法可以禁用这种缩放最大缩放道路的全尺寸。希望这张照片能消除任何误解：

![在最大变焦中成为最大尺寸的道路](../Images/c4d493f286b507ff2747267fb76a71a7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T00:25:13.633

我不相信你会对你正在尝试做的事情的结果感到满意，将缩放固定到一个特定的值，这将带来非常棒的用户体验......

但是，如果您真的想尝试一下，只需使用本文中的解决方案[之一](https://stackoverflow.com/questions/4146395/set-minimum-zoom-level-for-mapview)

祝你好运。

# java - 对于大型项目，Spring Data JPA 与 Hibernate 有何不同？

> ID：12790853
> 
> 赞同：129
> 
> 时间：2012-10-08T23:24:41.643
> 
> 标签：java, spring, hibernate, jpa, spring-data-jpa

我很难决定是否应该在新项目中坚持使用 Hibernate，还是应该使用 JPA 和新的 Spring Data 实现。

Spring Data 框架是针对大型项目还是针对查询要求不高的小型项目？

虽然我当然看到了使用`@Query`注解在代码缩减方面的优势，但您如何处理动态查询呢？当你想实现一个相当复杂的 save() 方法时怎么办？

文档说要创建一个自定义接口和实现，你的主存储库实现了，但是如果你需要访问 crud 存储库本身的任何超级方法怎么办？crud 存储库实现了自定义存储库 - 而不是相反。这似乎是一个奇怪的设计。

我非常不确定这个框架是否能够应对复杂和大型应用程序的挑战。我从来没有遇到过 Hibernate 的很多问题，我正在考虑坚持使用良好的旧可靠而不是使用 Spring Data JPA。

我该怎么办？如果我使用 Spring Data JPA，我会遇到哪些不可预见的并发症和成本？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2012-10-09T18:56:08.937

所以，`spring-data`做一些额外的魔法来帮助复杂的查询。一开始很奇怪，您在文档中完全跳过了它，但它确实强大且有用。

它涉及创建一个自定义`Repository`和一个自定义的“RepositoryImpl”，并告诉 Spring 在哪里可以找到它。这是一个例子：

配置类 -~~指向您仍然需要的 xml 配置~~，注释指向您的存储库包（它`*Impl`现在自动查找类）：

```
@Configuration
@EnableJpaRepositories(basePackages = {"com.examples.repositories"})
@EnableTransactionManagement
public class MyConfiguration {
} 
```

~~jpa-repositories.xml - 告诉`Spring`在哪里可以找到你的存储库。还告诉`Spring`寻找具有`CustomImpl`文件名的自定义存储库：~~

 ~~```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:jpa="http://www.springframework.org/schema/data/jpa"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:util="http://www.springframework.org/schema/util"
xsi:schemaLocation="http://www.springframework.org/schema/data/mongo http://www.springframework.org/schema/data/jpa/spring-jpa.xsd
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

<jpa:repositories base-package="com.example.repositories" repository-impl-postfix="CustomImpl" />

</beans> 
```~~  ~~`MyObjectRepository`- 这是您可以放置​​带注释和未注释查询方法的地方。请注意此存储库接口如何扩展该存储库接口`Custom`：

```
@Transactional
public interface MyObjectRepository extends JpaRepository<MyObject, Integer>, MyObjectRepositoryCustom {

    List<MyObject> findByName(String name);

    @Query("select * from my_object where name = ?0 or middle_name = ?0")
    List<MyObject> findByFirstNameOrMiddleName(String name);
} 
```

`MyObjectRepositoryCustom`- 更复杂且无法通过简单查询或注释处理的存储库方法：

```
public interface MyObjectRepositoryCustom {

    List<MyObject> findByNameWithWeirdOrdering(String name);
} 
```

`MyObjectRepositoryCustomImpl`- 您实际使用 autowired 实现这些方法的地方`EntityManager`：

```
public class MyObjectRepositoryCustomImpl implements MyObjectRepositoryCustom {

    @Autowired
    private EntityManager entityManager;

    public final List<MyObject> findByNameWithWeirdOrdering(String name) {
        Query query = query(where("name").is(name));
        query.sort().on("whatever", Order.ASC);
        return entityManager.find(query, MyObject.class);
    }
} 
```

令人惊讶的是，这一切都结合在一起，并且来自两个接口（以及您实现的 CRUD 接口）的方法都会在您这样做时出现：

```
myObjectRepository. 
```

你会看见：

```
myObjectRepository.save()
myObjectRepository.findAll()
myObjectRepository.findByName()
myObjectRepository.findByFirstNameOrMiddleName()
myObjectRepository.findByNameWithWeirdOrdering() 
```

它确实有效。您将获得一个查询界面。`spring-data`真的已经为大型应用程序做好了准备。而且，您可以推入简单或注释的查询越多，您的处境就越好。

所有这些都记录在[Spring Data Jpa 站点上](http://docs.spring.io/spring-data/data-jpa/docs/1.4.x/reference/htmlsingle/#repositories.custom-implementations)。

祝你好运。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-09T00:50:29.917

我在具有简单查询需求的小型和大型项目中使用了 Spring Data JPA。主要优点是甚至不必使用`@Query`注释。Spring Data 中没有任何东西可以阻止您在大型项目中使用它，最近的`QueryDSL`支持可能会对您有所帮助。[这是一个](http://blog.mysema.com/2010/07/querying-hibernate-with-querydsl.html)使用[QueryDSL](http://www.querydsl.com/)来定位 Hibernate 的示例。

如果您预见到复杂的查询，并且在没有 JPA 的情况下使用 Hibernate 对象感觉很舒服，我认为另一种组合可能是将简单的 Spring Data 放在`Repository`复杂的基于 Hibernate 的旁边，并使用您可能需要的特定方法。将 Hibernate 实现扭曲成 Spring Data JPA 结构可能不那么麻烦。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-08-12T06:35:52.437

Spring JPA 将为您提供大量使用查询方法声明编写 SQL 甚至一些 HQL 的抽象。Spring JPA 以其查询生成而大放异彩，但是当您想要一个纯粹的休眠解决方案时，您可以根据需要进行自定义，因为 Spring JPA 仍然基于休眠。查看文档[http://static.springsource.org/spring-data/data-jpa/docs/current/reference/html](http://static.springsource.org/spring-data/data-jpa/docs/current/reference/html)了解更多信息。~~

# angularjs - AngularJS 指令滚动到给定的项目

> ID：12790854
> 
> 赞同：33
> 
> 时间：2012-10-08T23:24:44.497
> 
> 标签：angularjs

我有一个在我的控制器中定义的范围变量 $scope.first_unread_id 。在我的模板中，我有：

```
<div id="items" >
  <ul class="standard-list">
    <li ng-repeat="item in items" scroll-to-id="first_unread_id">
    <span class="content">{{ item.content }}</span>
    </li>
  </ul>
</div> 
```

我的指令看起来像：

```
angular.module('ScrollToId', []).
directive('scrollToId', function () {
  return function (scope, element, attributes) {
    var id = scope.$parent[attributes["scrollToId"]];
    if (id === scope.item.id) {
      setTimeout(function () {
        window.scrollTo(0, element[0].offsetTop - 100)
      }, 20);
    }
  }

}); 
```

但是，它可以解决两个问题：

1.  有没有更好的方法将“first_unread_id”从控制器范围中获取到直接而不是询问范围。$ parent？这似乎有点“恶心”。我希望我可以通过视图将其作为参数传递给直接，而不必在任何 li 元素上重复该参数。

2.  有没有更好的方法来避免 setTimeout() 调用的需要？没有它，它*有时会*起作用- 我想是由于布局时间的不同。我了解我使用的语法是定义一个链接函数——但我不清楚这是默认情况下的前置链接还是后置链接——以及这是否对我的问题很重要。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-10-09T00:20:05.700

1.  您不应该需要 scope.$parent - 因为它将继承父范围的值，并且当它在父范围中发生更改时，它将被传递下来。
2.  默认为链接后功能。您是否加载了一些图像或某些内容会在初始加载后不久使页面布局发生变化？您是否尝试过没有时间的 setTimeout，例如 setTimeout(function(){})？这将确保这将在其他所有事情完成之后进行。
3.  我还会稍微更改您指令的逻辑以使其更通用。如果给定条件为真，我会让它滚动到元素。

以下是这 3 个变化：

html:

```
<div id="items" >
  <ul class="standard-list">
    <li ng-repeat="item in items" scroll-if="item.id == first_unread_id">
      <span class="content">{{ item.content }}</span>
    </li>
  </ul>
</div> 
```

JS：

```
app.directive('scrollIf', function () {
  return function (scope, element, attributes) {
    setTimeout(function () {
      if (scope.$eval(attributes.scrollIf)) {
        window.scrollTo(0, element[0].offsetTop - 100)
      }
    });
  }
}); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-12-15T09:00:58.387

假设父元素是我们滚动的元素，这对我有用：

```
app.directive('scrollIf', function () {
  return function(scope, element, attrs) {
    scope.$watch(attrs.scrollIf, function(value) {
      if (value) {
        // Scroll to ad.
        var pos = $(element).position().top + $(element).parent().scrollTop();
        $(element).parent().animate({
            scrollTop : pos
        }, 1000);
      }
    });
  }
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-02-06T15:51:34.907

我最终得到了以下代码（不依赖于 jQ），如果滚动元素不是窗口，它也可以工作。

```
app.directive('scrollIf', function () {
    var getScrollingParent = function(element) {
        element = element.parentElement;
        while (element) {
            if (element.scrollHeight !== element.clientHeight) {
                return element;
            }
            element = element.parentElement;
        }
        return null;
    };
    return function (scope, element, attrs) {
        scope.$watch(attrs.scrollIf, function(value) {
            if (value) {
                var sp = getScrollingParent(element[0]);
                var topMargin = parseInt(attrs.scrollMarginTop) || 0;
                var bottomMargin = parseInt(attrs.scrollMarginBottom) || 0;
                var elemOffset = element[0].offsetTop;
                var elemHeight = element[0].clientHeight;

                if (elemOffset - topMargin < sp.scrollTop) {
                    sp.scrollTop = elemOffset - topMargin;
                } else if (elemOffset + elemHeight + bottomMargin > sp.scrollTop + sp.clientHeight) {
                    sp.scrollTop = elemOffset + elemHeight + bottomMargin - sp.clientHeight;
                }
            }
        });
    }
}); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-09-02T07:29:24.207

与接受的答案相同，但使用 javascript 内置方法“ [scrollIntoView](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView) ”：

```
angular.module('main').directive('scrollIf', function() {
    return function(scope, element, attrs) {
        scope.$watch(attrs.scrollIf, function(value) {
            if (value) {
                element[0].scrollIntoView({block: "end", behavior: "smooth"});
            }
        });
    }
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-21T18:02:32.593

结合 UI Router 的[$uiViewScroll](http://angular-ui.github.io/ui-router/site/#/api/ui.router.state.$uiViewScroll)我最终得到了以下指令：

```
app.directive('scrollIf', function ($uiViewScroll) {
    return function (scope, element, attrs) {
        scope.$watch(attrs.scrollIf, function(value) {
            if (value) {
                $uiViewScroll(element);
            }
        });
    }
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-26T09:42:35.117

对于在 ES6 中获取最佳答案的答案：

文件：`scroll.directive.js`

```
export default function ScrollDirective() {
    return {
        restrict: 'A',
        scope: {
            uiScroll: '='
        },
        link: link
    };

    function link($scope, $element) {
        setTimeout(() => {
            if ($scope.uiScroll) {
                $element[0].scrollIntoView({block: "end", behavior: "smooth"});
            }
        });
    }
} 
```

文件`scroll.module.js`

```
import ScrollDirective from './scroll.directive';

export default angular.module('app.components.scroll', [])
    .directive('uiScroll', ScrollDirective); 
```

将其导入项目后，您可以在 html 中使用它：

```
<div id="items" >
  <ul class="standard-list">
    <li ng-repeat="item in items" ui-scroll="true">
    <span class="content">{{ item.content }}</span>
    </li>
  </ul>
</div> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-10T21:33:22.873

结合@uri，这适用于我在.run中使用ui-router和stateChangeSuccess的动态内容：

```
$rootScope.$on('$stateChangeSuccess',function(newRoute, oldRoute){

        setTimeout(function () {
            var postScroll = $state.params.postTitle;
            var element = $('#'+postScroll);
            var pos = $(element).position().top - 100 + $(element).parent().scrollTop();
            $('body').animate({
                scrollTop : pos
            }, 1000);
        }, 1000);

    }); 
```

# entity-framework - 使用 LINQ 和 TPT EF 时如何转换为子类？

> ID：12790856
> 
> 赞同：8
> 
> 时间：2012-10-08T23:25:05.340
> 
> 标签：entity-framework, casting, ef-code-first

我有以下类层次结构：

```
public class RealPeople { }

public class Users : RealPeople { }
public class People : RealPeople { } 
```

在我的 dbContext 中，我为`RealPeople`OnModelCreating 过程定义了一个 dbSet，我为 People 和 Users 指定了单独的表：

```
modelBuilder.Entity<Users>().ToTable("Users");
modelBuilder.Entity<People>().ToTable("People"); 
```

这将在我的数据库中创建相应的完整层次结构，其中包含 3 个相应的表。当我想检索`Users`我的数据库中的列表时，问题就来了。这个：

```
List = (from Reg in PersistentMgr.RealPeople select (Users)Reg)
       .ToList(); 
```

或这个：

```
List = (from Reg in PersistentMgr.RealPeople select (Users)((RealPeople)Reg))
       .ToList(); 
```

抛出异常：

> LINQ 只能转换原始模型类型。

所以问题是，我不能将 RealPeople 转换为相应的子类用户。关于这个有什么想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-09T11:46:37.620

获取子类集合的方法是使用[`OfType`](http://msdn.microsoft.com/en-us/library/bb360913.aspx#Y684)：

```
var users = (from p in PersistentMgr.RealPeople select p).OfType<User>(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-08T23:48:09.837

试试这个：

```
var list = PersistentMgr.RealPeople.Select(reg => reg as Users).ToList(); 
```

更好的：

```
var list = PersistentMgr.RealPeople.Select(reg => (reg is Users) ? reg as Users : null).ToList(); 
```

如果你尝试这个，你会得到同样的错误：

```
var realperson = new RealPeople();
var user = (Users) realperson; 
```

原因是编译器不知道如何通过简单的强制转换将复杂类型转换为子类型 - 所以您需要使用 as 关键字。这将返回 null，或者将超类型转换为子类型。

```
var realperson = new RealPeople();
var user = realperson as Users; // user is realperson converted into a Users object
var aString = "this is a string";
var otheruser = aString as Users; // otheruser is null, because aString was not a valid supertype for Users 
```

# c++ - bad weak pointer when base and derived class both inherit from boost::enable_shared_from_this

> ID：12790859
> 
> 赞同：6
> 
> 时间：2012-10-08T23:25:15.303
> 
> 标签：c++, boost, shared-ptr, multiple-inheritance, enable-shared-from-this

I have a base class which derives from boost::enable_shared_from_this, and then another class which derives from both the base class and boost::enable_shared_from_this:

```
#include <boost/enable_shared_from_this.hpp>
#include <boost/shared_ptr.hpp>

using namespace boost;

class A : public enable_shared_from_this<A> { };

class B : public A , public enable_shared_from_this<B> {
public:
    using enable_shared_from_this<B>::shared_from_this;
};

int main() {
shared_ptr<B> b = shared_ptr<B>(new B());
shared_ptr<B> b_ = b->shared_from_this();

return 0;
} 
```

This compiles but at runtime it gives

```
terminate called after throwing an instance of 'boost::exception_detail::clone_impl<boost::exception_detail::error_info_injector<boost::bad_weak_ptr> >'
  what():  tr1::bad_weak_ptr
Aborted 
```

What is causing this, and is there some way around it?

EDIT:

What if I need something like this:

```
class A : public enable_shared_from_this<A> { };
class B : public enable_shared_from_this<B> { };    

class C : public A, public B, public enable_shared_from_this<C> {
public:
    using enable_shared_from_this<C>::shared_from_this;
}; 
```

such that A and B both need shared_from_this on their own (and one can't inherit it from the other), and C needs A, B, and shared_from_this?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-09T00:10:02.043

You shouldn't inherit from `enable_shared_from_this` more than once in a given inheritance chain.

In this case, you can leave the base class `A` inheriting from `enable_shared_from_this`, and have the derived class `B` return a `shared_ptr<A>` and then [`static_pointer_cast`](http://www.boost.org/doc/libs/1_51_0/libs/smart_ptr/shared_ptr.htm#static_pointer_cast) it to `shared_ptr<B>`.

Or as Omnifarious pointed out, you could have a function in `B` which does this for you. Although, rather than overloading `shared_from_this()` I would favour explicitly-named functions to minimise surprises for clients of the class:

```
#include <boost/enable_shared_from_this.hpp>
#include <boost/shared_ptr.hpp>

using boost::shared_ptr;

class A : public boost::enable_shared_from_this<A> { };

class B : public A {
public:
    using enable_shared_from_this<A>::shared_from_this;
    shared_ptr<B> shared_B_from_this() {
        return boost::static_pointer_cast<B>(shared_from_this());
    }
    shared_ptr<B const> shared_B_from_this() const {
        return boost::static_pointer_cast<B const>(shared_from_this());
    }
};

int main() {
    shared_ptr<B> b = shared_ptr<B>(new B);
    shared_ptr<B> b1 = boost::static_pointer_cast<B>(b->shared_from_this());
    shared_ptr<B> b2 = b->shared_B_from_this();
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-09T06:24:27.040

Here's how I would solve your problem:

```
#include <boost/enable_shared_from_this.hpp>
#include <boost/shared_ptr.hpp>

using namespace boost;

class virt_enable_shared_from_this :
   public enable_shared_from_this<virt_enable_shared_from_this>
{
 public:
   virtual ~virt_enable_shared_from_this() {}
};

template <class T>
class my_enable_shared_from_this : virtual public virt_enable_shared_from_this
{
 public:
   shared_ptr<T> shared_from_this() {
      return dynamic_pointer_cast<T>(virt_enable_shared_from_this::shared_from_this());
   }
};

class A : public my_enable_shared_from_this<A> { };

class B : public my_enable_shared_from_this<B> { };

class C : public A, public B, public my_enable_shared_from_this<C> {
 public:
   using my_enable_shared_from_this<C>::shared_from_this;
};

int main() {
   shared_ptr<C> c = shared_ptr<C>(new C());
   shared_ptr<C> c_ = c->shared_from_this();

   return 0;
} 
```

This is painful and at least a bit ugly. But it works reasonably well, after a fashion. I think [Fraser](https://stackoverflow.com/users/424459/fraser)'s idea of re-thinking your design is likely the better option.

# mongodb - 缩短 MongoDB 属性名称值得吗？

> ID：12790861
> 
> 赞同：22
> 
> 时间：2012-10-08T23:25:32.750
> 
> 标签：mongodb, database-schema

在[使用 mongoDB、express 和 Node.js 滚动的博客中，](http://howtonode.org/express-mongodb)作者提到缩短属性名称是个好主意：

> ....经常报告的 mongoDB 问题是磁盘上数据的大小...每条记录都存储所有字段名称 ....这意味着拥有属性通常可以更节省空间例如't'或'b'而不是'title'或'body'，但是为了避免混淆，除非确实需要，否则我会避免这样做！

我知道如何做到这一点的解决方案。我更感兴趣的是什么时候真正需要这样做？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-08T23:45:55.780

引用[Donald Knuth 的](http://en.wikiquote.org/wiki/Donald_Knuth)话：

> 过早的优化是编程中万恶（或至少是大部分）的根源。

然而，构建您的应用程序似乎是最明智、可维护和合乎逻辑的。然后，如果您遇到性能或存储问题，请处理影响最大的问题，直到性能令人满意或收益递减规律意味着进一步优化没有意义。

如果您不确定特定设计决策的影响（如长属性名称），请创建一个原型来测试各种假设（如“较短的属性名称会节省更多空间”）。不要指望测试的结果是决定性的，但它可能会教你一些你没想到会学到的东西。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-07-30T03:13:44.923

保持有意义名称的优先级高于短名称的优先级，除非您自己的情况和测试提供了更改这些优先级的特定理由。

[正如SERVER-863的](https://jira.mongodb.org/browse/SERVER-863)[评论](https://jira.mongodb.org/browse/SERVER-863?focusedCommentId=812326&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-812326)中所提到的，如果您使用**MongoDB 3.0+**和 WiredTiger 存储选项并启用了快速压缩，那么长字段名称就*不再*是一个问题，因为压缩有效地为您处理了缩短问题。

 **** * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-09T09:36:20.230

底线：所以保持紧凑，因为它仍然有意义。

我认为这并不是真正*需要*缩短为一个字母的名称。无论如何，您应该尽可能缩短它们，并且您对此感到满意。假设您有一个用户*名：{FirstName, MiddleName, LastName}，*您可能最好使用偶数*名称：{first, middle, last}*。如果你觉得舒服，你可能会觉得*name:{f, m,l} 没*问题。
您应该使用短名称：因为它会消耗磁盘空间、内存，因此可能会在某种程度上减慢您的应用程序（内存中保存的对象更少，由于更大的大小和更长的查询时间导致查找时间更慢，因为查找数据需要更长的时间）。
一个好的模式文档可能会告诉开发人员 t 代表城镇而不是标题。根据您的堆栈，您甚至可以通过一些辅助工具来隐藏开发人员使用这些快捷方式来映射它。

最后我要说的是，没有关于何时以及应该缩短多少模式名称的指导方针。这在很大程度上取决于您的环境和要求。但是，如果您可以提供一个很好的文档来解释所有内容和/或提供实用程序来简化开发人员和管理员的生活，那么您最好保持它的紧凑性。无论如何，管理员可能会直接与 mongodb 交互，所以我想不应该错过一个好的文档。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-01-09T06:40:52.057

加上我的 2 美分。

在设计数据模型时，可以避免使用长命名属性（或“AbnormallyLongNameAttributes”）。在我之前的组织中，我们测试了保留短命名属性策略，例如，组织定义了 4-5 个字母编码的字符串，例如：

1.  名字 = FSTNM,
2.  姓氏 = LSTNM，
3.  月盈亏百分比 = MTPCT,
4.  同比销售预测 = YOYSP，依此类推..)

虽然我们观察到查询性能的改进，主要是由于通过网络传输的数据大小减少，或者（因为我们将 JAVA 与 MongoDB 一起使用）减少了 MongoDB 文档/Java Map 堆空间中“键”的长度，性能的整体提升不到 15%。

在我个人看来，这是一个微优化，需要额外的成本（和一个巨大的头痛）来维护/设计一个额外的系统来管理每个数据模型的数据属性字典。该系统在调试应用程序/回答客户查询时需要具有组织范围的透明度。

如果您发现自己处于使用此策略将性能提高 20% 对您有利可图的位置，可能是时候扩展您的 MongoDB 服务器/选择其他一些数据建模/查询策略，或者选择不同的完全数据库。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-01-20T15:01:54.103

我执行了一个小基准测试，我将 252 行数据从 Excel 上传到两个集合 testShortNames 和 testLongNames，如下所示：

**长名称：**

```
{
    "_id": ObjectId("6007a81ea42c4818e5408e9c"),
    "countryNameMaster": "Andorra",
    "countryCapitalNameMaster": "Andorra la Vella",
    "areaInSquareKilometers": 468,
    "countryPopulationNumber": NumberInt("77006"),
    "continentAbbreviationCode": "EU",
    "currencyNameMaster": "Euro"
} 
```

**简称：**

```
{
    "_id": ObjectId("6007a81fa42c4818e5408e9d"),
    "name": "Andorra",
    "capital": "Andorra la Vella",
    "area": 468,
    "pop": NumberInt("77006"),
    "continent": "EU",
    "currency": "Euro"
} 
```

然后我得到了每个的统计数据，保存在磁盘文件中，然后对这两个文件做了一个“差异”：

```
pprint.pprint(db.command("collstats", dbCollectionNameLongNames)) 
```

下图显示了两个感兴趣的变量：size 和 storageSize。我的阅读表明 storageSize 是压缩后使用的磁盘空间量，基本上 size 是未压缩的大小。所以我们看到 storageSize 是相同的。显然，Wired Tiger 引擎很好地压缩了字段名。 [![在此处输入图像描述](../Images/094919e13f30344d600f714a95b1e0cc.png)](https://i.stack.imgur.com/pHkk9.png)

然后我运行一个程序从每个集合中检索所有数据，并检查响应时间。

尽管这是一个亚秒级查询，但长名称始终花费大约 7 倍的时间。当然，将较长的名称从数据库服务器发送到客户端程序需要更长的时间。

```
-------LongNames-------
Server Start DateTime=2021-01-20 08:44:38
Server End   DateTime=2021-01-20 08:44:39
StartTimeMs= 606964546  EndTimeM= 606965328
ElapsedTime MilliSeconds= 782
-------ShortNames-------
Server Start DateTime=2021-01-20 08:44:39
Server End   DateTime=2021-01-20 08:44:39
StartTimeMs= 606965328  EndTimeM= 606965421
ElapsedTime MilliSeconds= 93 
```

在 Python 中，我只是执行了以下操作（我实际上必须遍历项目以强制读取，否则查询仅返回光标）：

```
results = dbCollectionLongNames.find(query)
for result in results:
    pass 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-20T20:30:28.767

如果使用详细的 xml，尝试使用自定义名称来改善它可能非常重要。SERVER-863 票证中的用户评论在他的案例中说；我正在存储外部定义的 XML 对象，并带有详细的命名：字段名可能是总记录大小的 70%。因此，就 I/O 和内存效率而言，字段名称标记化可能是一个巨大的胜利。***

# javascript - 如何从单页应用程序 URL 解析参数？

> ID：12790867
> 
> 赞同：2
> 
> 时间：2012-10-08T23:25:59.777
> 
> 标签：javascript, url, asp.net-mvc-2

我的网址是这个

```
http://localhost:1871/Home/Index#/user/20 
```

如何使用 Javascript 从此 url 中提取 20 到变量中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T23:39:46.070

一个班轮：`var id = window.location.hash.split('/').pop();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:31:07.507

简单地做

```
var parts = document.location.pathname.split('/');
var number = parts[parts.length - 1]; 
```

`number`是你需要的变量。如果 "/user/20" 是一个锚点，那么只需替换`pathname`为`hash`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T23:32:40.577

这应该可以解决问题：

```
parts = window.location.hash.substr(2).split('/');
id = parts[parts.length - 1]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-08T23:50:11.313

使用 jQuery，您可以做到这一点。

1) 添加到你的项目[jQuery URL Parser Plugin](https://github.com/allmarkedup/jQuery-URL-Parser)

2）获取您的参数

```
$.url('http://localhost:1871/Home/Index#/user/20').fsegment(1); // returns 'user'
$.url('http://localhost:1871/Home/Index#/user/20').fsegment(2); // returns '20' 
```

我认为它非常优雅/容易/可以理解

# lisp - 编程语言用来评估 AST 的算法是什么？

> ID：12790871
> 
> 赞同：0
> 
> 时间：2012-10-08T23:26:47.077
> 
> 标签：lisp, scheme, eval, abstract-syntax-tree

编程语言用来评估其 AST 的算法是什么？

也就是说，假设我们有 4 个基本函数`/*+-`。什么是可以正确评估任何 AST 的基本算法，例如：

```
(+ (- (* 3 2) (+ (/ 5 2))) (* 2 4)) 
```

我的疑问实际上是如果对节点的评估返回仍然需要评估的东西会发生什么。例如，在 Scheme 中，对 的评估`((lambda (a) (+ a 2)) 3)`将是`(+ 3 2)`。但这可以再次评估为 5。那么语言如何确定何时停止评估表单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T01:43:06.907

您完全误解了 Scheme/Lisp 评估的工作原理。我将使用您提供的示例：

```
(+ (- (* 3 2) (+ (/ 5 2))) (* 2 4)) 
```

为了评估一个列表，我们评估每个元素。第一个预计会返回一个过程（我忽略了语法运算符的特殊情况），其余的可以返回任意值。我们将其余部分作为参数调用该过程。

在顶层，这是一个包含 3 个元素的列表：

1.  `+`
2.  `(- (* 3 2) (+ (/ 5 2)))`
3.  `(* 2 4)`

对这些中的每一个进行评估。第一个是一个变量，其值为一个过程（Scheme 的内置加法函数）。其他是列表，需要递归到评估算法中。我将跳过描述第二个，因为它的复杂性，并转到第三个：`(* 2 4)`.

这是 3 个元素的列表：*、2 和 4。如上所述，* 是乘法函数。2 和 4 是文字，因此它们对自己进行评估。所以我们用参数 2 和 4 调用乘法函数，它返回 8。

复杂的第二个参数经历了相同的过程，只是多了几个层次的递归。它最终返回 4。因此我们使用参数 4 和 8 调用乘法函数，它返回 32。

您的第二个示例的处理方式类似。在顶部，您有一个包含两个元素的列表：

1.  `(lambda (a) (+ a 2))`
2.  `3`

对这些中的每一个进行评估。Lambda 是一种特殊语法，它解析其内容并返回一个过程，该过程在参数变量绑定到参数的上下文中评估其主体，因此第一个返回的过程将其参数添加 2 并返回。3 是一个字面量，所以它只返回数字 3。然后我们使用参数 3 调用该过程，它将 2 添加到它并返回 5。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T00:53:09.497

有许多不同的算法。

**备选方案 1：**您可以将 AST 编译为更线性的中间表示。您的代码可以编译为如下内容：

```
a <- 3 * 2
b <- 5 / 2
c <- a - b
d <- 2 * 4
e <- c + d
return e 
```

这很容易评估，因为它只是一系列指令。大多数指令具有相同的格式：`X <- Y OP Z`，因此评估器将非常简单。

**备选方案 2：**您可以将备选方案 #1 编译为机器码或字节码。

```
li      r3, 3
muli    r3, 2
li      r4, 5
divi    r4, r5, 2
subf    r3, r3, r4
li      r4, 2
muli    r4, r4, 4
add     r3, r3, r4
blr 
```

**备选方案 3：**您可以将备选方案 #1 编译为称为 SSA 的特殊形式，或“单一静态分配”，它类似于 #1，但每个分配的 LHS 是唯一的，并且特殊的“phi”节点用于组合来自不同的分支。然后可以将 SSA 编译为机器码或字节码。

**备选方案 4：**您可以通过递归下降来评估 AST。大多数关于 Scheme / Lisp 的书籍都详细介绍了这一点。

**备选方案 5：**您可以使用递归下降将代码转换为堆栈机器代码，然后对其进行评估。就像是：

```
push 3
push 2
mul
push 5
push 2
div
sub
push 2
push 4
mul
add
ret 
```

**Alternative ∞：**还有很多其他的技术。关于这个主题的书很*厚。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T00:06:08.930

在您给出的情况下，执行将在 5 处停止，因为它是一个文字值并代表它自己。这并不难测试。您不妨问一个深入遍历列表的函数如何知道如何停止（实际上，您应该知道，因为在 Scheme 中这是同一件事）。

在 Scheme 中，任何复合表达式最终都应解析为 7 种原始数据类型之一或空列表，除非它陷入无限循环。如果您想提前知道表达式是否会解决，那么这是一个有趣的问题：[http ://en.wikipedia.org/wiki/Halting_problem](http://en.wikipedia.org/wiki/Halting_problem)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T00:30:24.980

我想你可能问错了问题，但我会尝试：

直到它得到一个可以使用的结果。在您的示例中，您询问的是解释器何时停止评估表达式......它 100% 依赖于语言，如果您要询问编译器，这将是一个完全不同的答案。对于您的方案示例，您需要阅读方案规范 ( [R5RS](http://www.schemers.org/Documents/Standards/R5RS/) )。

所以它是由解释器的作者定义的。如果单个文字（甚至变量）是我的语言中表达式的预期结果，那么它将停在那里。

# python - Python/MySQL-如何正确使用 %s 来计算行数

> ID：12790876
> 
> 赞同：3
> 
> 时间：2012-10-08T23:27:48.087
> 
> 标签：python, mysql

我制作了一个函数，它使用`cursor.rowcount`Python 中的函数计算表中的行数。现在我想将它应用到我通过 %s 选择的表中。问题是我不知道如何应用它。这是我正在使用的示例。

```
def data_input (table):
    cursor.execute ("USE database")
    cursor.execute ("TRUNCATE TABLE table1")
    cursor.execute ("TRUNCATE TABLE table2")
    cursor.execute ("LOAD DATA LOCAL INFILE 'table1data' INTO TABLE table1 FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' (field1, field2, field3, field4, field5)")
    cursor.execute ("LOAD DATA LOCAL INFILE 'table2data' INTO TABLE table2 FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' (field1, field2, field3)")
    cursor.execute ("SELECT * FROM %s", table)
    print cursor.rowcount

data_input ("table1") 
```

基本上它已经做的是将所有数据从文本文件输入到 MySQL 中的表中，现在我希望该函数还打印特定表的行数。它收到一条错误消息，说明 MySQL 语法错误，因此此代码对于 rowcount 部分是错误的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-08T23:34:41.803

```
query = "SELECT COUNT(*) from `%s`" %table
cursor.execute(query)             #execute query separately
res = cursor.fetchone()
total_rows = res[0]      #total rows 
```

# excel - Play Framework 1.2.5 Excel 模块无法解析单元格标签 jx:forEach

> ID：12790878
> 
> 赞同：1
> 
> 时间：2012-10-08T23:28:09.333
> 
> 标签：excel, playframework-1.x, jxls

您好以下是我的java方法

```
public static void csvReport(String date) throws Exception
{
    request.format = "xlsx";
    renderArgs.put(RenderExcel.RA_ASYNC, true);
    renderArgs.put("results", currentResults.values());
    renderArgs.put("date", date);
    render();
} 
```

然后我的观点看起来像

```
<jx:forEach items="${results}" var="result">                    
${result.simpleName}    ${result.version}   ${result.registerCount} ${result.uniqueAccess}  ${result.totalAccess}   ${result.updateCount}
</jx:forEach> 
```

但是当我运行它时，`NullPointerException`由于属性解析失败，我得到一个在`item`属性上**打开引号的结果。**

有任何想法吗？

# objective-c - 使用未声明的标识符 self

> ID：12790880
> 
> 赞同：5
> 
> 时间：2012-10-08T23:28:20.880
> 
> 标签：objective-c, ios

我创建了一个名为 Data parsing 的类，在这个类中，我列出了三个函数：

第一个是`getData()`，它需要调用`parseLine()`。

我这样调用`parseLine()`方法：

```
[self parseline]; 
```

但是，我收到以下错误：

```
Sse of undeclared identifier 'self' 
```

我在这个类中的函数是如何相互调用的？

```
void getData(NSString *data) { 
    while(temp_top < [data length]) { 
        icc_data[++data_top] = [data characterAtIndex:temp_top]; 
        if (icc_data[data_top]==')' && icc_data[data_top -1]=='\031') { } 
        if (icc_data[0]!='\031' && icc_data[data_top]=='\n') { 
            [dataParsing parseLine]; 
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-08T23:43:58.267

您正在实现`void getData(NSString *data)`为 C 函数。函数没有获得对`self`. 改用一种方法：

```
- (void)data
{
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T23:51:04.250

要使用 C 函数，只需正常调用它：

```
getData(myData); 
```

如果您将其实现为 Objective C 方法，例如：

```
- (void)getData:(NSString *)data
{
     //Code
} 
```

然后你调用它使用`self`：

```
[self getData:myData]; 
```

# php - AES256 从 iOS 到 PHP

> ID：12790882
> 
> 赞同：1
> 
> 时间：2012-10-08T23:28:25.127
> 
> 标签：php, ios, xcode, encryption, aes

我正在尝试使用[AES-Crypt-Objc](https://github.com/Gurpartap/AESCrypt-ObjC)在 Xcode 中对其进行解密。我已经尝试过所有东西......不同的libariers等等......

..anyhting 出错了，但我不知道是什么问题。帮助...

**更新（另一种意见）** 现在我试试这个：

```
function mc_encrypt($encrypt, $key = "12345678901234567890123456789012") 
{
    $encrypt = "Affe";
    $iv2 = ''; 
    for($i=0;$i<16;$i++){ $iv2 .= "\0";  }

    $ciphertext = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, ($encrypt), MCRYPT_MODE_CBC,$iv2);
    $encode= base64_encode($ciphertext);

    return $encode;
} 
```

在 Obj-C 中，我也使用相同的框架（IV 现在仍然为零）

......仍然没有任何工作......

AND 一些 Objc-C 代码：注意：request responseString 是来自上面的字符串。

```
NSString *key = @"12345678901234561234567890123456";
NSLog(@"decrypted: %@",[AESCrypt decrypt:[request responseString] password:key]); 
```

输出有时什么都没有，有时为空。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T03:08:48.023

**对于大多数系统，加密应该是非确定性的——两次加密相同的明文几乎不应该给出相同的密文。**为什么？假设您在第 0 天的午夜向您的同伙发送“黎明攻击”，攻击失败（但您毫发无伤），并且在第 1 天的午夜，您再次发送“黎明攻击”......

除此之外，让我数一下方法：

*   您没有显示任何 ObjC 代码，因此很难判断那里出了什么问题。
*   奇怪的是，您的 PHP 代码使用 26 个字符的“键”。对于 AES-128，它应该是 16*个字节。*我不知道 PHP 是如何`mcrypt`处理超长键的；ObjC 代码在`FixKeyLengths()`.
*   PHP（如您所示）和 ObjC 代码（默认情况下）都使用固定的 IV。**很坏。**
    *   他们使用不同的 IV，这可能就是您得到不同答案的原因。

FWIW，我到处都看到了那个（或类似的）ObjC 代码。我不能不推荐它。它***确实***不适合一般用途。

只需使用 HTTPS。

# javascript - 如何为父 JavaScript 文件编写可执行的 jQuery？

> ID：12790885
> 
> 赞同：1
> 
> 时间：2012-10-08T23:28:41.470
> 
> 标签：javascript, jquery, iframe, iframe-app

我有两个[JavaScript](http://en.wikipedia.org/wiki/JavaScript)文件。第一个文件设置变量并写入另一个名为的文件的内容`iframe.js`：

```
/* Parent File  */
var aff_id = 2; // Your affiliate ID
var aff_source_id='1'; // Your site ID
var aff_source_subid=''; // Your custom tracking ID
var thankyouUrl = ''; // Leave blank if you don't have a thank you page
var live = 0; // 1 for production
var lead_type = 1; // Auto insurance
document.write(unescape('%3Cscript src="'+site+'/api/js/iframe.js"%3E%3C/script%3E')); 
```

```
/* Child File */
if(!site) var site='https://leadthis.com';
$(function(){
    var height,width,src = 'http://lead/api/iframe/insurance/auto.php#'+encodeURIComponent(document.location.href )+'?aff_id='+aff_id+'&aff_source_id='+encodeURIComponent(aff_source_id)+'&aff_source_subid='+encodeURIComponent(aff_source_subid)+'&live='+live,
    emarfi=$('<iframe id="appframe" src="'+src+'" scrolling="no" frameborder="0"><\/iframe>').appendTo('#emarfi');
});
document.write('<div id="emarfi"><\/div>'); 
```

我想在这个子文件中编写一些可执行的 JavaScript 代码来处理写入父文件的 iframed 内容。这可能吗？我试过这个：

```
document.write("$(function(){ $('iframe').load(function(){alert('Hello Iframe');})});"); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T08:16:33.310

我已经根据 krg 的评论开始使用 Porthole，这正是我所需要的。谢谢。 [http://ternarylabs.com/2011/03/27/secure-cross-domain-iframe-communication/](http://ternarylabs.com/2011/03/27/secure-cross-domain-iframe-communication/)

# perl - Perl 按哈希中的值对哈希进行排序

> ID：12790891
> 
> 赞同：1
> 
> 时间：2012-10-08T23:29:32.460
> 
> 标签：perl, sorting, hash

我认为我的想法是正确的，但是我搞砸了一些语法/约定，因为我收到错误“全局符号 %timeHash 需要显式包名称”。

代码：

```
foreach $key (sort hashValueDescendingNum (keys(%timeHash))) {
   print "\t$key\t\t $timeHash{$key}\n";
}

sub hashValueDescendingNum {
   my $hash = shift;
   $hash{$b} <=> $hash{$a};
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T23:33:16.137

排队

```
foreach my $key (sort { $timeHash{$b} <=> $timeHash{$a} } keys %timeHash) {
   print "\t$key\t\t $timeHash{$key}\n";
} 
```

以您尝试的方式使用自定义排序功能将无法正常工作，因为那样您的子将需要访问原始哈希。

```
foreach my $key (sort hashValueDescendingNum (keys(%timeHash))) {
    print "\t$key\t\t $timeHash{$key}\n";
}

sub hashValueDescendingNum {
   $timeHash{$b} <=> $timeHash{$a}; # Ew.
} 
```

相反，您可以进一步抽象它：

```
foreach my $key (sortedHashKeysByValueDescending(%timeHash)) {
    print "\t$key\t\t $timeHash{$key}\n";
}

sub sortedHashKeysByValueDescending {
  my %hash = @_;
  my @keys = sort { $hash{$b} <=> $hash{$a} } keys %hash;
  return @keys;
} 
```

该代码效率不高，因为它传递了 %hash，但引用会更好：

```
foreach my $key (sortedHashKeysByValueDescending(\%timeHash)) {
    print "\t$key\t\t $timeHash{$key}\n";
}

sub sortedHashKeysByValueDescending {
  my $hash = shift;
  return sort { $hash->{$b} <=> $hash->{$a} } keys %$hash;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T10:26:27.037

```
use List::UtilsBy qw( rev_nsort_by );

foreach my $key ( rev_nsort_by { $timeHash{$_} } keys %timeHash ) {
    ...
} 
```

# c# - wpf/pixelsense 中的自定义多点触控

> ID：12790894
> 
> 赞同：3
> 
> 时间：2012-10-08T23:30:34.893
> 
> 标签：c#, wpf, touch, multi-touch, pixelsense

我正在和一个博士生一起工作，他正在做一个关于使用计算机进行人与人之间协作的项目，特别是在触摸方面。用于此的平台是像素感（表面）2.0 表。

到目前为止，我们已经尝试了一些使用常规 wpf/surface 界面模型的原型，并得出结论，多点触控功能并未充分发挥其潜力。

因此，我们希望实现自定义多点触控手势，以便手指的数量和相对于屏幕上元素的位置指定动作。这种手势的一个示例是使用彼此靠近的 2 根手指从每只手进行缩放，而不是总共 2 根手指。如果使用此手势而不是正常的捏合缩放，它将允许在同一区域上进行绘图和缩放。

虽然这种方法有一些问题需要解决，但我们在实现这些自定义手势时遇到了更紧迫的问题。我们知道可以在 XNA 中实现（通过使用 TouchTarget.GetState），但是重写我们的接口会相当乏味，所以我们宁愿避免它。

那么如何在 wpf/surface 2.0 中实现这一点呢？

# ruby-on-rails - 修改关联模型的 Activerecord 回调

> ID：12790900
> 
> 赞同：0
> 
> 时间：2012-10-08T23:31:34.427
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我有 2 个有关联的模型。我想在一个模型中设置 before_save 来修改另一个模型。这是我所拥有的：

```
class Event < ActiveRecord::Base
  belongs_to :leads
end

class Lead < ActiveRecord::Base
  before_save  :update_event
  has_many :events, :dependent => :destroy
  accepts_nested_attributes_for :events, :reject_if => lambda { |a| a[:title].blank? }

  def update_event
    self.events.title = "Testing to set the event title"
  end
end 
```

最终，事件具有诸如标题之类的属性，这些属性将从系统内的各种模型关联中设置。在上面的示例中，Leads 就是其中之一。潜在客户将有一个可能事件的下拉列表，因此我想在 before_save 中做一些事情，而下拉列表中的选择最终会设置事件标题。如：

```
self.events.title = self.selected_event 
```

我得到的错误如下：

```
undefined method `title=' for #<ActiveRecord::Relation:0x007fed3229d610> 
```

我显然做错了。我会很感激任何帮助。我仍在寻找解决方案，如果我弄明白了，我会自己更新。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T23:35:08.337

每个潜在客户有多个事件。因此，在您的情况下，您希望：

```
before_save  :update_events

def update_events
  events.each do |event|
    event.title = "Testing to set the event title"
  end
end 
```

# xcode - UICollectionView 在 IB 中不包含 UICollectionViewCell

> ID：12790902
> 
> 赞同：22
> 
> 时间：2012-10-08T23:31:36.367
> 
> 标签：xcode, interface-builder, ios6, uicollectionview

我正在尝试将 UICollectionView 添加到 IB 中的 .nib 文件中。我已经完成了一些教程并且没有任何问题。

在我现有的应用程序中，当我将集合视图拖到 IB 中的视图中然后展开对象时，CollectionView Flow Layout 在那里，但没有集合视图单元格。我也无法将单元格拖放到集合视图中。此外，集合视图的显示方式也不同，显示的是单元格网格的图像，而不是正常的白框。

我尝试使用 nib 创建一个新的视图控制器，并且在添加 collectionView 时得到相同的结果。

此应用程序面向 iOS 4.2，但我已将部署目标更改为 iOS 6。

在任何新创建的项目中，我都没有这种行为。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T17:47:02.187

我无法告诉你为什么它不起作用，但对我来说，这篇博文中的子类方法解决了这个问题：

[http://www.adoptioncurve.net/archives/2012/09/a-simple-uicollectionview-tutorial.php](http://www.adoptioncurve.net/archives/2012/09/a-simple-uicollectionview-tutorial.php)

这是一个简短的总结：

*   创建一个扩展 UICollectionViewCell 的新类 MyViewCell 并根据需要创建属性、操作、出口和方法。

`@interface MyViewCell : UICollectionViewCell`

*   创建一个以 Collection View Cell 作为其根对象的视图（xib 文件）（并删除默认创建的对象）。
*   在属性中，将此 Collection View Cell 的自定义类设置为您的扩展类 MyViewCell（而不是默认的 UICollectionViewCell）。
*   在 Collection Reusable View 下的属性中定义一个标识符，例如 myCell，稍后您将需要它来注册您的调用。
*   返回您的自定义类并修改 inithWithFrame 方法以加载和使用您创建的视图。

    ```
    - (id)initWithFrame:(CGRect)frame 
    { 
       self = [super initWithFrame:frame]; 
       if (self) 
       { 
         // Initialization code 
         NSArray *arrayOfViews = [[NSBundle mainBundle] loadNibNamed:@"CVCell" owner:self options:nil];

         if ([arrayOfViews count] < 1) { return nil; }

         if (![[arrayOfViews objectAtIndex:0] isKindOfClass:[UICollectionViewCell class]]) { return nil; }

         self = [arrayOfViews objectAtIndex:0];
       }
       return self;
    } 
    ```

*   然后你可以注册这个类供collectionView使用

`[self.collectionView registerClass:[MyViewCell class] forCellWithReuseIdentifier:@"myCell"];`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-10-16T13:14:47.683

自从提出这个问题以来已经有一段时间了，但我最近遇到了同样的问题。

最终，我在[这里](https://stackoverflow.com/questions/15184968/uicollectionview-adding-uicollectioncell)找到了答案。

简而言之：

*   如果您在 .xib 文件中，则不能将 UICollectionViewCell 拖放到 UICollectionView 中。这只能在故事板中实现。

*   解决方法是为您的自定义单元创建一个 .xib 文件并使用以下方法手动注册该单元：

    `[self.collectionView registerClass:[CollectionViewCell class] forCellWithReuseIdentifier:CELL_ID];`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-17T11:03:36.737

在单独的 nib 文件中定义单元格视图。视图必须是类型`UICollectionViewCell`或子类。

然后，您必须将 nib 注册到您的集合视图中：

```
- (void)viewDidLoad
{
    UINib *cellNib = [UINib nibWithNibName:@"MyNib" bundle:nil];
    [self.collectionView registerNib:cellNib forCellWithReuseIdentifier:@"cell"];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-01T21:33:55.670

虽然这些答案是正确的，但问题的根本原因非常微妙，Apple 需要在日志中更新他们的错误消息。当你看到：

```
Unknown class MyViewCell in Interface Builder file. 
```

它实际上意味着您的源代码缺少**@implementation**声明或.m 文件尚未添加到目标中。所以检查你的代码并确保你有：

```
@implementation MyViewCell

@end 
```

**UITableViewCell 和 UICollectionViewCell 都是如此。**

对于一般情况，我在[https://stackoverflow.com/a/12755891/539149](https://stackoverflow.com/a/12755891/539149)进一步讨论了这个问题。

有趣的是，如果您缺少**@implementation**并调用：

```
[self.myCollectionView registerClass:[MyViewCell class] forCellWithReuseIdentifier:@"MyViewCell"]; 
```

你会看见：

```
Undefined symbols for architecture armv7:
  "_OBJC_CLASS_$_MyViewCell", referenced from:
      objc-class-ref in MyViewController.o
ld: symbol(s) not found for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

所以Apple知道这个问题，他们只是在编译期间没有检测到它。我建议不要将自定义单元格放在单独的 nib 中或调用 registerClass: forCellWithReuseIdentifier:。将自定义单元格存储在其容器 UICollectionView 或 Interface Builder 中的 UITableView 内要干净得多。

# php - 使用表A php mysql中的id计算表B中的行

> ID：12790903
> 
> 赞同：1
> 
> 时间：2012-10-08T23:31:41.020
> 
> 标签：php, mysql, count

我一定筋疲力尽，因为我知道我以前做过，但我不记得我是怎么做的或找到那个片段的。我有两个表“问题”和“答案”。“问题”中的主要“id”也是“答案”中的“id”。我正在尝试根据该表中的“id”计算“答案”。

```
 <?php

  $query = "SELECT * FROM questions ORDER BY id DESC";

  $result = mysql_query("$query");
  while($row = mysql_fetch_array($result)){
$id = $row['id'];
    $date = $row['date'];
    $question = $row['question'];
$time = date("U");
$likes = $row['likes'];
    $query2 = "SELECT * FROM answers WHERE id = $id";
    $num_rows = mysql_num_rows($query2);
    print("<span style='font-size: .7em';><a href='qplusone.php?id=$id'>+1</a>
 - Likes:$likes</span> $question - <a href='answer.php?id=$id&pp=$time'>answer it</a>
 or <a href='answers.php?id=$id&pp=$time'>read $num_rows answers</a> 
<span style='font-size: .7em';>($date)</span><br />");
  }

  ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:36:34.013

好吧，首先你永远不会执行`$query2`. 但比返回所有行并计数更好，只需返回 mysql 计数的行数。

```
$query2 = "SELECT count(*) FROM answers WHERE id = $id";
$result = mysql_query($q);
$row = mysql_fetch_array($result);

$count = $row['count(*)']; // $count holds the number of matching records. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T23:34:04.430

要获得每个问题的答案计数，您可以这样做

```
select q.id,
       count(*) as answers
from answer a
left join questions q on q.id = a.id 
group by q.id 
```

# javascript - jquery ui 主题切换器

> ID：12790907
> 
> 赞同：1
> 
> 时间：2012-10-08T23:32:05.993
> 
> 标签：javascript, jquery, jquery-ui

你好我使用themeswitcher jquery ui，但现在没有工作。

mi代码是：

```
<script type="text/javascript" src="http://jqueryui.com/themeroller/themeswitchertool/"></script>

            $('#switcher').themeswitcher({
                 onSelect: function() {
                    $.cookie('hola',$.cookie('jquery-ui-theme'),{ expires: 7 });
                    //alert($.cookie('jquery-ui-theme'));
                 },
                 path:'/web/'
                 ,initialText: "Seleccione tema"
                 ,loadTheme: "Smoothness"
                 ,buttonPreText: "Tema: "
                }); 
```

我觉得方向不行。

小部件不存在？

有人可以帮助我吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T00:28:38.693

jqueryUI.com 刚刚完全重做了他们的网站。主题切换器工具不再存在。我认为，除非他们把他们的东西直接送到那里，否则你就不走运了。

其他人在这里抱怨这个问题[。](http://forum.jquery.com/topic/jquery-plugin-themeswitcher-no-longer-works).

根据他们的[推](https://twitter.com/jqueryui)特，主题切换器“不再存在”。但总[有超级主题切换器。](https://github.com/harborhoffer/Super-Theme-Switcher)

# visualization - 具有毫秒精度的 Graphite / Graphiti-esque 工具，可选聚合

> ID：12790915
> 
> 赞同：1
> 
> 时间：2012-10-08T23:33:22.980
> 
> 标签：visualization, time-series, graphite

我需要一个时间序列数据存储和可视化平台，我可以将实验数据转储到分层命名空间中，然后再返回进行分析。保存图形模板、链接到图形和其他从分析到演示的功能将非常有用。最初，我真的很高兴阅读[Graphite](http://graphite.wikidot.com/)和[Graphiti](https://github.com/paperlesspost/graphiti)，因为它们似乎符合要求。但是，我正在跟踪的事件相隔几毫秒，我需要保持毫秒精度而不进行聚合或平均。[看起来](https://stackoverflow.com/questions/8216736/graphite-time-per-point-precision)让 Graphite 发挥出色的唯一方法是从statsd 聚合到每秒指标，这会掩盖我感兴趣的事件。在某些情况下，可选聚合会很好，但并非总是如此。

[Cube](http://square.github.com/cube/)接受带有毫秒时间戳的事件，但[Cubism](http://square.github.com/cubism/)似乎是一个丰富的库，而不是像 Graphite 这样的成熟平台。它似乎也非常注重实时性。如果我找不到一个好的堆栈来满足我的需求，我可能会使用 Cube 来存储我的数据，但是使用生成一堆堆 matplotlib 图形的批处理脚本来可视化它并不有趣。

我是否被误导了，或者是否有另一个框架可以为我提供具有任意时间粒度的体面分析/交互性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T15:56:53.613

Cubism.js 只是 Graphite 的前端（和其他后端，如 Cube），所以我认为它会满足您的需求。

您需要设置一个 Graphite 系统来存储具有适当详细级别（例如毫秒）的指标（而不是 Cube），然后使用 Cubism 的[Graphite 上下文](https://github.com/square/cubism/wiki/Graphite)以相同的步长值显示它。

# sql - 如果月份为空，则按月查询多个表组的查询计数返回零

> ID：12790921
> 
> 赞同：1
> 
> 时间：2012-10-08T23:33:58.657
> 
> 标签：sql, sql-server, tsql, sql-server-2000

我需要一些帮助来获取每个地区所有 projectTypes 的每月项目计数。我已经尝试了以下语句，但它没有返回我需要的内容。以下语句的问题在于，仅当该月有计数时，它才返回 projectType。如果月份没有计数，我需要返回零。任何帮助深表感谢。

```
SELECT r.region, pt.projectType, count(p.id) as totalCount, p.postedOn as monthCount
FROM region r cross join ProjectTypes pt left join projects p on p.regionID = r.id and pt.id = p.TypeID 
WHERE year(p.postedOn) = '2012' 
group by r.region, pt.projectType, p.postedOn 
order by r.region 
```

请在此处提供示例：[http ://sqlfiddle.com/#!3/6680f/18](http://sqlfiddle.com/#!3/6680f/18)

```
地区：
-------------------------
编号 | 地区 |
-------------------------
1 | 东 |
-------------------------
2 | 中西部 |
-------------------------
3 | 西 |
-------------------------

项目类型：
-------------------------
编号 | 项目类型 |
-------------------------
1 | 网页设计 |
-------------------------
2 | 数据库 |
-------------------------
3 | 发展 |
-------------------------

项目：
-------------------------------------------------- ----------------------
编号 | 项目名称 | 地区ID | 项目类型ID | 发表于 |
-------------------------------------------------- ----------------------
1 | 项目 1 | 1 | 2 | 2012-09-02 |
-------------------------------------------------- ----------------------
2 | 项目 2 | 2 | 2 | 2012-09-02 |
-------------------------------------------------- ----------------------
3 | 项目 3 | 1 | 1 | 2012-09-02 |
-------------------------------------------------- ----------------------
4 | 项目 4 | 3 | 2 | 2012-09-02 |
-------------------------------------------------- ----------------------
5 | 项目 5 | 3 | 1 | 2012-10-02 |
-------------------------------------------------- ----------------------
6 | 项目 6 | 3 | 2 | 2012-10-02 |
-------------------------------------------------- ----------------------
7 | 项目 7 | 3 | 3 | 2012-10-02 |
-------------------------------------------------- ----------------------
8 | 项目 8 | 2 | 3 | 2012-10-02 |
-------------------------------------------------- ----------------------
9 | 项目 9 | 1 | 2 | 2012-10-02 |
-------------------------------------------------- ----------------------
10 | 项目 10 | 1 | 2 | 2012-10-02 |
-------------------------------------------------- ----------------------

期望的结果：
-------------------------------------------------- --------
地区 | 项目类型 | 总数 | 月数 |
-------------------------------------------------- --------
东 | 网页设计 | 1 | 九月 |
-------------------------------------------------- --------
东 | 数据库 | 1 | 九月 |
-------------------------------------------------- --------
东 | 发展 | 0 | 九月 |
-------------------------------------------------- --------
中西部 | 网页设计 | 0 | 九月 |
-------------------------------------------------- --------
中西部 | 数据库 | 1 | 九月 |
-------------------------------------------------- --------
中西部 | 发展 | 0 | 九月 |
-------------------------------------------------- --------
西 | 网页设计 | 0 | 九月 |
-------------------------------------------------- --------
西 | 数据库 | 1 | 九月 |
-------------------------------------------------- --------
西 | 发展 | 0 | 九月 |
-------------------------------------------------- --------
东 | 网页设计 | 0 | 十月 |
-------------------------------------------------- --------
东 | 数据库 | 2 | 十月 |
-------------------------------------------------- --------
东 | 发展 | 0 | 十月 |
-------------------------------------------------- --------
中西部 | 网页设计 | 0 | 十月 |
-------------------------------------------------- --------
中西部 | 数据库 | 0 | 十月 |
-------------------------------------------------- --------
中西部 | 发展 | 1 | 十月 |
-------------------------------------------------- --------
西 | 网页设计 | 1 | 十月 |
-------------------------------------------------- --------
西 | 数据库 | 1 | 十月 |
-------------------------------------------------- --------
西 | 发展 | 1 | 十月 |
-------------------------------------------------- --------

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T00:53:18.457

WITH 块定义了所需的月份（或者更确切地说，每个月的第一天）的虚拟表。这会延长您的 CROSS JOIN 以给您所有的月份。

```
;WITH months(startdate) AS (
     SELECT CAST('20120901' AS date)
  UNION ALL
     SELECT dateadd(m,1,startdate)
       FROM months
      WHERE startdate < '20121001'
)

    SELECT r.region,
           pt.projectType,
           count(p.id) totalCount,
           DATENAME(Month,m.startdate) monthCount
      FROM region r
CROSS JOIN ProjectTypes pt
CROSS JOIN months m
 LEFT JOIN projects p ON p.regionID = r.id
       AND pt.id = p.TypeID
       AND p.postedOn >= m.startdate
       AND p.postedOn <  dateadd(m,1,m.startdate)
  GROUP BY r.region, pt.projectType, m.startdate
  ORDER BY m.startdate, region, projecttype
    OPTION (maxrecursion 0); 
```

我把这个应用到[你的小提琴上](http://sqlfiddle.com/#!3/6680f/80/0)

对于 SQL Server 2000，或者实际上是为了性能，将表创建`Months`为适当的表，并用从 1999 年到 2169 年的月份填充它，例如

```
CREATE TABLE Months (
  startdate datetime -- the first day of month
    primary key
);
insert Months
select DateAdd(M,Number,'19990101')
from master..spt_values
where type='P'
GO 
```

然后，只需使用月份表的条件选择您需要的月份范围，即如下：

```
 SELECT r.region,
           pt.projectType,
           count(p.id) totalCount,
           DATENAME(Month,m.startdate) monthCount
      FROM region r
CROSS JOIN ProjectTypes pt
      JOIN months m on m.startdate between '20120901' and '20121001'
 LEFT JOIN projects p ON p.regionID = r.id
       AND pt.id = p.TypeID
       AND p.postedOn >= m.startdate
       AND p.postedOn <  dateadd(m,1,m.startdate)
  GROUP BY r.region, pt.projectType, m.startdate
  ORDER BY m.startdate, region, projecttype; 
```

更新[的 SQL Fiddle](http://sqlfiddle.com/#!3/2cef0/2/0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T06:38:32.573

嗨，我的回答需要你桌子上的所有月份并制作套装。

```
SELECT
r.region
,pt.projectType
,(SELECT Count(*)
  FROM Projects pp
    WHERE pt.id = pp.TypeID
      AND r.id = pp.regionID
      AND DATENAME(MONTH, p.postedOn)=DATENAME(MONTH, pp.postedOn)) AS COUNT
,DATENAME(MONTH, p.postedOn) AS monthName
FROM ProjectTypes pt, region r,
(SELECT DISTINCT postedOn FROM Projects )p
ORDER BY r.region, DATENAME(MONTH, p.postedOn) 
```

**[SQLFiddle 示例](http://sqlfiddle.com/#!3/6680f/109)**

# objective-c - 异步获取大量资源并将它们“异步”保存到数据库中。使用哪种好模式？（AFNetworking，核心数据）

> ID：12790923
> 
> 赞同：2
> 
> 时间：2012-10-08T23:34:08.697
> 
> 标签：objective-c, core-data, asynchronous, synchronization, moc

我需要用注释填充我的地图。每个注释都有从远程服务器获取的相应 Place 资源。每个地方都有关联的类别 - 它也作为单独的资源从服务器获取。

假设要填充给定区域，我需要获取 100 个位置，每个位置属于 20 个类别之一（实际上还有更多）。

我使用 AFNetworking 来获取这两种资源。我尝试缓存地点和类别以供离线使用，因此在地图上显示注释之前，我将获取的资源写入核心数据表。

每个地方都按需求检索其关联的类别资源，我需要在“地方”表中写一个地方，在“类别”表中写一个类别。

由于获取是异步完成的，当将特定类别写入表时，我不知道是否可能另一个地方“线程”尝试将相同的关联类别写入“类别”表。

所以，问题是：当需要用异步检索的信息填充它们时，使用 Core Data 表的模式是什么？具体来说，任何要编写类别的给定线程如何知道已经有一个线程正在尝试这样做？

更新 1：我目前的问题是目前我有重复的类别。我的猜测是，显然每个尝试写入的类别都不知道同一类别的并行写入。

更新2：我的案例最简单的描述如下：

我在一个线程中创建了一个新的 Category 实体，其中包含一些字段，同时在另一个线程中，我创建了具有相同字段的完全相同的 Category 实体，旨在成为与第一个线程相同的 Category 对象。

一个线程赢得调用*[managedObjectContext save:&error]*，但是在实际记录出现在 PersistentStore 之前，第二个线程也调用了保存。问题是：如何防止“类别”表中的记录重复？

更新 3：我正在考虑使用托管对象上下文的两种变体：1）所有线程重用一个共享 moc 实例 2）在每个线程上实例化一个新 moc

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T23:53:06.450

“官方”答案将是关于使用`NSOperationQueue`和/或采取手动步骤以确保您对 的所有访问都`NSManagedObjectContext`发生在创建上下文的同一线程上。您可以遵循许多[参考资料和教程](http://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/CoreData/Articles/cdConcurrency.html)来实施此方法。

作为替代方案，github 上有一个[线程安全的 Core Data 扩展，可以为您执行此操作。](https://github.com/adam-roth/coredata-threadsafe)如果你使用它，它会自动同步你的数据库操作，这样你就不必担心另一个线程是否正在处理上下文。您可以在它们进入时插入它们，该框架将确保您的操作被转换为不会使 Core Data 爆炸的东西。

完全披露：我建立了 github 项目。

# php - 从旧 mysql 文件夹中获取旧 MySQL 数据并导入新数据库

> ID：12790929
> 
> 赞同：2
> 
> 时间：2012-10-08T23:34:46.277
> 
> 标签：php, mysql, windows, phpmyadmin

在我旧电脑的硬盘上，我安装了带有 MySQL 和 PHPMyAdmin 的 WAMP5。数据在文件夹中。如何获取三个文件中的数据？数据在`E:\wamp\bin\mysql\mysql5.5.24\data\fbdb`，我可以看到。

我想将`country`表导入`fbdb`数据库，这些是我从中获得的文件`country.MYD`：`country.frm`和`country.MYI`

我如何处理这些文件以添加到新数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:40:32.907

假设您已经在新计算机上创建了“fbdb”数据库，只需将找到的 country.* 文件复制到新计算机 MySQL 数据目录下的“fbdb”文件夹中，然后重新启动 MySQL 服务器——只要它与创建表的 MySQL 服务器的版本相同或更新，这应该是您需要做的所有事情，因为 MySQL 引擎会自动检查，并在必要时更新这些文件中的“国家”表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:47:31.487

您应该将数据库的所需部分从旧磁盘导出然后导入到新磁盘，甚至整个数据库。首先，您将需要的内容导出到文件中，然后您可以使用该文件将其导入数据库。阅读此论坛主题[以获取更多](http://www.codingforums.com/showthread.php?t=22880)信息。

# c++ - 轨道球体应该在中央立方体上投射聚光灯

> ID：12790936
> 
> 赞同：3
> 
> 时间：2012-10-08T23:36:04.217
> 
> 标签：c++, qt, opengl, qglwidget

我正在编写一个程序，它在屏幕中间绘制**一个旋转立方体（带有纹理） ，然后是一个****围绕立方体运行的黄色小球**。这个想法是使球体成为照亮立方体的聚光灯。

**这是问题所在**：如下图所示，我无法实现聚光灯效果。似乎整个立方体都被点亮了：

![](../Images/914a42e535cabecd3ff4eee61a264417.png) ![](../Images/19a5c9c48c5e5dc3ed9fe562066b9dcf.png)

我设置`GL_SPOT_DIRECTION`为立方体位置。我没有设置表面法线，因为我很难理解如何为立方体计算它们，而且我不确定像这样的简单图形应用程序是否真的需要它。

我在下面分享代码：

**主.cpp**：

```
#include <QApplication>
#include "glwidget.h"

int main(int argc, char* argv[])
{
    QApplication app(argc, argv);

    GLWidget gl_widget;
    gl_widget.show();

    return app.exec();
} 
```

**GLWidget.h**：

```
#pragma once
#include <QGLWidget>
#include <QImage>

class GLWidget : public QGLWidget
{
    Q_OBJECT
public:
    explicit GLWidget(QWidget* parent = 0);
    virtual ~GLWidget();

    void _draw_texture_cube(int w, int h);
    void _draw_light();

    /* OpenGL initialization, viewport resizing, and painting */

    void initializeGL();
    void paintGL();
    void resizeGL( int width, int height);

    /* enable the user to interact directly with the scene using the keyboard */

    void keyPressEvent(QKeyEvent *e);

private:
    int _width;
    int _height;
    QImage* _img;
    GLuint  _texture;
    float xrot;
    float yrot;
    float zrot;
    bool _light_on;
    bool _must_rotate;
    bool _pause_light;
    GLfloat _light_pos[3];
    GLfloat _cube_pos[3];
    GLUquadricObj* _quadratic;

protected slots:
    void _tick();
}; 
```

**GLWidget.cpp**：

```
#include "GLWidget.h"

#include <iostream>
#include <QKeyEvent>
#include <QTimer>

#include <cmath>

#define LIGHT_MOVEMENT_SPEED    20.0f           // Degrees per second
#define pi                      3.141592654f

GLWidget::GLWidget(QWidget *parent)
: QGLWidget(parent), _img(NULL), _light_on(true), _must_rotate(true),
  _pause_light(false), _quadratic(NULL)
{
    _width = 0;
    _height = 0;
    _texture = 0;

    xrot = 0.f;
    yrot = 0.f;
    zrot = 0.f;

    // Set central cube position
    _cube_pos[0] = 0.0f;
    _cube_pos[1] = 0.0f;
    _cube_pos[2] = -7.0f;

    // Set light position
    _light_pos[0] = 0.5f;
    _light_pos[1] = 0.5f;
    _light_pos[2] = -7.0f;
}

GLWidget::~GLWidget()
{
    if (_img)
        delete _img;

    glDeleteTextures(1, &_texture);
}

void GLWidget::_tick()
{
    update(); // triggers paintGL()

    QTimer::singleShot(33, this, SLOT(_tick()));
}

void GLWidget::initializeGL()
{
    std::cout << "GLWidget::initializeGL" << std::endl;
    glClearColor(0.0f, 0.0f, 0.0f, 1.0f);       // Black Background

    glEnable(GL_CULL_FACE);

    /* Load bitmap */

    glEnable(GL_TEXTURE_RECTANGLE_ARB);
    glPixelStorei (GL_UNPACK_ALIGNMENT, 1);

    if (!_img)
    {
        std::cout << "GLWidget::paintGL: loading image" << std::endl;

        QImage tmp(":/crate.jpg");
        if (tmp.isNull())
        {
            std::cout << "GLWidget::paintGL: !!! Failed QImage #1" << std::endl;
            return;
        }

        _img = new QImage(QGLWidget::convertToGLFormat(tmp));
    }

    /* Convert bitmap into texture */

    // Create The Texture
    glGenTextures(1, &_texture);

    // Typical Texture Generation Using Data From The Bitmap
    glBindTexture(GL_TEXTURE_RECTANGLE_ARB, _texture);

    // Generate The Texture
    glTexImage2D(GL_TEXTURE_RECTANGLE_ARB, 0,
                 GL_RGBA, _img->width(), _img->height(), 0,
                 GL_RGBA, GL_UNSIGNED_BYTE, _img->bits());

    if (glGetError() != GL_NO_ERROR)
    {
        std::cout << "GLWidget::paintGL: !!! Failed glTexImage2D" << std::endl;
        return;
    }

    /* Setup lighting */

    glShadeModel(GL_SMOOTH);    //Smooth color shading

    // Light properties
    GLfloat AmbientLight[4]      = {0.2, 0.2, 0.2, 1.0};
    GLfloat DiffuseLight[4]      = {0.8, 0.8, 0.8, 1.0};      // color
    GLfloat SpecularLight[4]     = {1.0, 1.0, 1.0, 1.0};      // bright
    GLfloat SpecRef[]            = {0.7f, 0.7f, 0.7f, 1.0f};
    GLubyte Shine                = 60.0;

    //glLightModelfv(GL_LIGHT_MODEL_LOCAL_VIEWER, AmbientLight);
    glLightfv(GL_LIGHT0, GL_AMBIENT, AmbientLight);
    glLightfv(GL_LIGHT0, GL_DIFFUSE, DiffuseLight);
    glLightfv(GL_LIGHT0, GL_SPECULAR, SpecularLight);
    glLightfv(GL_LIGHT0, GL_POSITION, _light_pos);

    glColorMaterial(GL_FRONT, GL_AMBIENT_AND_DIFFUSE);
    glMaterialfv(GL_FRONT, GL_SPECULAR, SpecRef);           // refletância do material
    glMaterialf(GL_FRONT, GL_SHININESS, Shine);             // concentração do brilho
    glLightModeli(GL_LIGHT_MODEL_TWO_SIDE, 0);
    //glColorMaterial(GL_FRONT,GL_DIFFUSE);

    glEnable(GL_COLOR_MATERIAL);
    glEnable(GL_LIGHTING);
    glEnable(GL_LIGHT0);
    glEnable(GL_DEPTH_TEST);

    // Sphere
    _quadratic = gluNewQuadric();               // Create A Pointer To The Quadric Object
    gluQuadricNormals(_quadratic, GLU_SMOOTH);  // Create Smooth Normals
    gluQuadricTexture(_quadratic, GL_TRUE);     // Create Texture Coords

    /* Start the timer */

    _tick();
}

/* Draw the central cube with texture
 */
void GLWidget::_draw_texture_cube(int w, int h)
{
    glPushMatrix();

    glTranslatef(_cube_pos[0], _cube_pos[1], _cube_pos[2]);
    glRotatef ( xrot, 1.0, 0.0, 0.0 );
    glRotatef ( yrot, 0.0, 1.0, 0.0 );
    glRotatef ( zrot, 0.0, 0.0, 1.0 );

    glColor3f(1.0f, 1.0f, 1.0f);

    glBegin(GL_QUADS);  // Draw A Cube

        // Front Face
        glTexCoord2f(0.0f, 0.0f);           glVertex3f(-1.0f, -1.0f,  1.0f);
        glTexCoord2f(w, 0.0f);              glVertex3f( 1.0f, -1.0f,  1.0f);
        glTexCoord2f(w, h);                 glVertex3f( 1.0f,  1.0f,  1.0f);
        glTexCoord2f(0.0f, h);              glVertex3f(-1.0f,  1.0f,  1.0f);

        // Back Face
        glTexCoord2f(w, 0.0f);              glVertex3f(-1.0f, -1.0f, -1.0f);
        glTexCoord2f(w, h);                 glVertex3f(-1.0f,  1.0f, -1.0f);
        glTexCoord2f(0.0f, h);              glVertex3f( 1.0f,  1.0f, -1.0f);
        glTexCoord2f(0.0f, 0.0f);           glVertex3f( 1.0f, -1.0f, -1.0f);

        // Top Face
        glTexCoord2f(0.0f, h);              glVertex3f(-1.0f,  1.0f, -1.0f);
        glTexCoord2f(0.0f, 0.0f);           glVertex3f(-1.0f,  1.0f,  1.0f);
        glTexCoord2f(w, 0.0f);              glVertex3f( 1.0f,  1.0f,  1.0f);
        glTexCoord2f(w, h);                 glVertex3f( 1.0f,  1.0f, -1.0f);

        // Bottom Face
        glTexCoord2f(w, h);                 glVertex3f(-1.0f, -1.0f, -1.0f);
        glTexCoord2f(0.0f, h);              glVertex3f( 1.0f, -1.0f, -1.0f);
        glTexCoord2f(0.0f, 0.0f);           glVertex3f( 1.0f, -1.0f,  1.0f);
        glTexCoord2f(w, 0.0f);              glVertex3f(-1.0f, -1.0f,  1.0f);

        // Right face
        glTexCoord2f(w, 0.0f);              glVertex3f( 1.0f, -1.0f, -1.0f);
        glTexCoord2f(w, h);                 glVertex3f( 1.0f,  1.0f, -1.0f);
        glTexCoord2f(0.0f, _img->height()); glVertex3f( 1.0f,  1.0f,  1.0f);
        glTexCoord2f(0.0f, 0.0f);           glVertex3f( 1.0f, -1.0f,  1.0f);

        // Left Face
        glTexCoord2f(0.0f, 0.0f);           glVertex3f(-1.0f, -1.0f, -1.0f);
        glTexCoord2f(w, 0.0f);              glVertex3f(-1.0f, -1.0f,  1.0f);
        glTexCoord2f(w, h);                 glVertex3f(-1.0f,  1.0f,  1.0f);
        glTexCoord2f(0.0f, h);              glVertex3f(-1.0f,  1.0f, -1.0f);

    glEnd();
    glPopMatrix();

    if (_must_rotate)
    {
        xrot += 0.6f;
        yrot += 0.4f;
        zrot += 0.8f;
    }
}

/* Draw light source and light model (sphere)
 */
void GLWidget::_draw_light()
{
    if (_light_on)
    {
        glEnable(GL_LIGHT0);    // enable lights that we use
    }
    else
    {
        glDisable(GL_LIGHT0);
    }

    static float light_angle = 25.0f;
    if (!_pause_light)          // stop moving the light source
    {
        light_angle += LIGHT_MOVEMENT_SPEED * 0.1;
        if (light_angle > 360.0f)
            light_angle -= 360.0f;
    }

    /* Set light source position */

    _light_pos[0] = 4.0f * (float) cos(light_angle * pi / 180.0f);
    _light_pos[1] = 4.0f * (float) sin(light_angle * pi / 180.0f);
    _light_pos[2] = -7;
    glLightfv(GL_LIGHT0, GL_POSITION, _light_pos);

    GLfloat SpotDir[] = {_cube_pos[0], _cube_pos[1], _cube_pos[2], 0.0 };
    glLightfv(GL_LIGHT0, GL_SPOT_DIRECTION, SpotDir);

    glLightf(GL_LIGHT0, GL_SPOT_CUTOFF, 150.0);
    glLightf(GL_LIGHT0, GL_SPOT_EXPONENT, 15.0);

    /* Set the light model position to be the same as the light source */

    glPushMatrix();
        glTranslatef(_light_pos[0], _light_pos[1], _light_pos[2]);
        glColor3ub(255, 255, 0);                // yellow
        gluSphere(_quadratic, 0.2f, 32, 32);    // draw sphere
    glPopMatrix();
}

void GLWidget::paintGL()
{
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); // Clear Screen And Depth Buffer

    glMatrixMode   ( GL_MODELVIEW );    // Select The Model View Matrix
    glLoadIdentity();                   // Reset The Current Modelview Matrix

    /* Draw central cube */

    glEnable(GL_TEXTURE_RECTANGLE_ARB);
    glBindTexture(GL_TEXTURE_RECTANGLE_ARB, _texture);       // Select Our Texture
    _draw_texture_cube(_img->width(), _img->height());
    glDisable(GL_TEXTURE_RECTANGLE_ARB);

    /* Draw light source and light model*/

    _draw_light();
}

void GLWidget::resizeGL( int w, int h)
{
    _width = w;
    _height = h;
    glViewport(0, 0, w, h);
    glMatrixMode(GL_PROJECTION);    // Select The Projection Matrix
    glLoadIdentity();               // Reset The Projection Matrix
    if (h == 0)                     // Calculate The Aspect Ratio Of The Window
       gluPerspective ( 60, ( float ) w, 0.4, 500.0 );
    else
       gluPerspective ( 60, ( float ) w / ( float ) h, 0.4, 500.0 );

    glMatrixMode   ( GL_MODELVIEW );  // Select The Model View Matrix
    glLoadIdentity ( );    // Reset The Model View Matrix
    gluLookAt(0.0,  0.0, 2.0,   // eye
              0.0,  0.0, 0.0,   // center
              0.0,  1.0, 0.0);  // up
}

void GLWidget::keyPressEvent(QKeyEvent *e)
{
    switch (e->key())
    {
        case Qt::Key_L:
            if (_light_on)
                _light_on = false;
            else
                _light_on = true;
        break;

        case Qt::Key_P:
            if (_pause_light)
                _pause_light = false;
            else
                _pause_light = true;
        break;

        case Qt::Key_R:
            if (_must_rotate)
               _must_rotate = false;
            else
               _must_rotate = true;
        break;

        default:
        break;
    }
} 
```

**Lighting.pro**：

```
QT += core gui opengl

SOURCES += \
    GLWidget.cpp \
    main.cpp

HEADERS += \
    GLWidget.h

RESOURCES += \
    resource.qrc 
```

为了达到预期的效果，在这个应用程序中需要改变什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T19:29:45.377

您没有为立方体面指定任何法线。由于 OpenGL 是一个状态机，它将使用所有顶点的默认表面法线，因此你所有的面。由于法线向量对照明至关重要，因此您所有的脸都将被照亮几乎相同（顶点位置仍然不同，但效果较弱）。

您还应该知道，OpenGL 的固定功能照明是按顶点完成的。如果您真的想在 cuve 上看到一个好的聚光灯，您需要对其进行细分，以便在实际评估照明方程的地方使用更多顶点，或者使用着色器进行每个片段的照明。

# java - 为什么会编译？

> ID：12790939
> 
> 赞同：0
> 
> 时间：2012-10-08T23:36:12.693
> 
> 标签：java, helpers

尝试使用构造函数类来获取名称并获取 ID：

```
Public Student( String newName, String newId) 
```

但它不会编译。我抛出`Error: Syntax error on token "(", ; expected`。

```
/**
 * construct class
 * @parm String newName
 * @parm String newId
 */
public Student( String newName, String newId)
name = newName;
id = newId;

/**
* getName method that return instant varible name
*/
Public String getName() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-08T23:39:45.983

public 必须是小写

```
public Student( String newName, String new Id) {...} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T00:00:24.020

`public`, `private`, `protected`, `static`,`class`是小写的关键字。

# wordpress - 在插件中使用 wordpress 循环

> ID：12790942
> 
> 赞同：0
> 
> 时间：2012-10-08T23:37:17.950
> 
> 标签：wordpress

我弄乱了一个使用 wordpress 循环的插件。我已经为此工作了很长一段时间，似乎无法在这里找到解决方案。

基本上，我的插件文件夹中有以下功能：

```
function fnp_getslideshow($settings) {
$query = new WP_Query( "posts_per_page=5");
while ( $my_query->have_posts() ) : $my_query->the_post();
# Code here
endwhile;
} 
```

和

```
add_action( 'loop_start', 'fnp_getslideshow', 10, 1 ); 
```

出于某种原因，我收到以下错误：“致命错误：调用 C:\xampp\htdocs\slb\wp-content\plugins\feature-post-slideshow 中非对象上的成员函数 have_posts() \fnp_functions.php 第 80 行"。关于造成这种情况的任何想法？

# c++ - C++ 64 位 Excel 加载项 (XLL) 未在 64 位 Excel 中正确加载

> ID：12790943
> 
> 赞同：3
> 
> 时间：2012-10-08T23:37:28.077
> 
> 标签：c++, excel, visual-studio, 64-bit, xll

我有一段 C++ 代码，它创建了一个 XLL（Excel 插件）。它可以通过Excel成功加载，并且可以完美运行。

然后，我切换到 64 位 Excel，代码停止工作。因此，我使用 x64 平台设置重新编译了 Visual Studio 中的代码。编译没有错误。

现在，当我尝试在 64 位 Excel 中加载它时，Excel 无法识别文件扩展名：

[![在此处输入图像描述](../Images/6e3a9ec7d139b0e082f7dd8a7f139104.png)](https://i.stack.imgur.com/a9XeJ.png)

它抱怨显示“'MyAddin.xll' 的文件格式和扩展名不匹配。”，并为我提供以下选项以继续：`yes`、、`no`或`cancel`。

如果我忽略该消息并按`yes`，则加载项崩溃，并且我收到错误消息：

> 该程序不能在 DOS 模式下运行。

由于加载项编译正确，我不确定如何解决此错误。我的问题是：任何人都可以给我任何关于如何克服这个问题的指示吗？

我的要求是：

1.  64 位 Excel 必须将我的 XLL 识别为有效的加载项（第一条错误消息必须消失）

2.  第二个错误是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T22:52:22.700

该消息通常意味着运行时链接器找不到 dll。使用 sysinternals 中的depends.exe（64 位）找出哪个。您可以忽略 xlcall32.dll 和 ieshims.dll 警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-16T08:36:59.637

你用32位版本的Excel打开64位插件，会报只能在DOS下打开的错误。需要安装64位（一般无法安装32位和64位）office才能打开64位插件！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-10T06:48:58.003

正如 Keith 所提到的，这个错误很可能是因为没有找到某些 .dll 依赖项。可能出现的一个具体问题是，如果您的 .xll 正在调用位于同一目录中的另一个 .dll。当 Excel 启动并加载 .xll 时，它将搜索其工作目录并且无法找到 .dll。

解决此问题的一种方法是将 .dll 的目录添加到您的路径中。

# php - PHP - 如何在安全 URL (HTTPS) 上触发 HTTP 获取请求？

> ID：12790944
> 
> 赞同：0
> 
> 时间：2012-10-08T23:37:27.613
> 
> 标签：php, xml, curl, https, http-get

我试图在要求用户名和密码的安全 URL 上触发 HTTP GET 请求。当我从浏览器中使用它时这很好，但我不确定如何使用 PHP 来做到这一点。

我尝试过使用这两种方法：

1）在这里建议使用Curl：[通过PHP发出HTTPS请求并获得响应](https://stackoverflow.com/questions/3873187/make-a-https-request-through-php-and-get-response)

2) 使用此处建议的 file_get_contents：[如何从 PHP 发送 GET 请求？](https://stackoverflow.com/questions/959063/how-to-send-a-get-request-from-php)

但是第一个没有给我任何回复。第二个给了我以下错误：

```
failed to open stream: HTTP request failed 
```

这是我的 curl 代码：

```
$url="https://xxxxx.com";
$ch=curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$response = curl_exec($ch);
curl_close($ch);
echo $response; 
```

对于 file_get_contents：

```
$url="https://xxxx.com";
$response=file_get_contents($url);
echo $response; 
```

该 URL 将为我正在测试的 API 返回一个 XML 响应。有人可以指出我正确的方向吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T23:52:35.280

如果我们专注于发送用户名和密码的要求，因为我怀疑这是你的主要问题，试试这个

```
$ch = curl_init();

$url="https://xxxxx.com";
// OR - check with your server's operator
$url="http://xxxxx.com";

curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_USERPWD, "$username:$password");
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
// or maybe 
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_ANY);
// - see http://stackoverflow.com/questions/4753648/problems-with-username-or-pass-with-colon-when-setting-curlopt-userpwd
// check the cURL documentation

$output = curl_exec($ch);
$info = curl_getinfo($ch);
// don't forget to check the content of $info, even a print_r($info) is better 
// than nothing during debug
curl_close($ch); 
```

# apache - 对子域的所有子目录使用 .htacess RewriteCond

> ID：12790946
> 
> 赞同：1
> 
> 时间：2012-10-08T23:38:00.300
> 
> 标签：apache, .htaccess, mod-rewrite, rewrite, subdomain

我将如何对我的子域的所有子目录使用 RewriteCond

示例：`test.example.com/folder1/page1.php`-> `code.example/folder1/page1.php`（在地址栏中显示 test.example.com/folder1/page1.php）

我目前正在使用：

```
RewriteCond %{HTTP_HOST} ^(.+)\.example\.com
RewriteRule ^(.*)$ http://code.example.com/$1 [CO=cookie:%1:.example.com:126144000:/,P]
```

这就是我想要的`test.example.com/page2.php`-> `code.example.com/page2.php`（在地址栏中显示 test.example.com/page2.php）
但是当我这样做时`test.example.com/folder1/page1.php`->`code.example.com/folder1/page1.php`我看到 code.example.com/folder1/page1.php （我**不**想要)

# c - 交换双链表中的两个节点

> ID：12790951
> 
> 赞同：0
> 
> 时间：2012-10-08T23:39:06.957
> 
> 标签：c, doubly-linked-list

我必须编写一个程序，该程序基本上会对链表中的节点进行排序。我有 5 个函数需要为此作业编写，但我被困在其中一个函数上。我遇到问题的功能是交换两个节点。该函数的标头如下：

```
void swap (struct lnode** head, struct lnode* n1, struct lnode* n2) 
```

只要两个节点不相邻，我就可以正常工作。我们有一个提供给我们的 list.h 文件，我们应该使用两个函数`evictNode(struct lnode** head, struct lnode* node)`和`void insertNode (struct lnode** head, struct lnode* prevNode, struct lnode* nodeToBeInserted)`. 这些函数也处理`next`和`previous`指针的重新分配。如果它们彼此相邻，我只是不完全确定如何交换节点。我试过把它画出来，但我无法把它包起来。

哦，顺便说一句，我处理其余节点的方式是使用以下代码：

```
evictNode(head, n1);
evictNode(head, n2);
insertNode(head, n1prev, n2);
insertNode(head, n2prev, n1); 
```

编辑：尝试

```
struct lnode* temp = n2;
insertNode(head,n1prev,temp)
evictNode(head, n2) 
```

其中`struct lnode* n1prev = nodeGetPrev(n1)` 有两个函数返回上一个/下一个指针

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T00:09:13.713

我会这样做：

```
struct lnode* tmp = nodeGetPrev(n1);
/*
 * Remove n1 and insert it before n2
 * note to calling nodeGetPrev(n2) after removing n1
 */
evictNode( head, n1 );
insertNode( head, nodeGetPrev(n2), n1 );
/* If n2 were before n1 and we insert n1 before n2, swap is done */
if( tmp != n2 ) {
    evictNode( head, n2 );
    insertNode( head, tmp, n2 );
} 
```

# c - 用 C 中的位运算符将 Nybbles 分隔为一个字节

> ID：12790961
> 
> 赞同：2
> 
> 时间：2012-10-08T23:40:40.227
> 
> 标签：c, bit-manipulation, bits

如果我们有一个十进制值：**123**
及其二进制版本：**01111011**

我怎样才能从这个字节中得到最左边的四个和最右边的四个位到 2 个单独的`int`变量中？

我是说：

```
int a = 7;  // 0111 (the first four bits from the left)
int b = 11; // 1011 (the first four bits from the right) 
```

非常感激！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-08T23:43:40.227

```
int x = 123;
int low = x & 0x0F;
int high = (x & 0xF0) >> 4; 
```

这称为*掩蔽*和*移位*。通过`AND`ing with `0xF`（它是 binary `00001111`），我们删除了高四位。`AND`使用`0xF0`（二进制`11110000`）删除低四位。然后（在后一种情况下），我们向右移动 4 位，实际上，推开低 4 位，只留下高 4 位。

正如@owlstead 在下面的评论中所说，还有另一种获得更高位的方法。我们可以直接移位，而不是屏蔽低位然后移位。

`int high = x >> 4;`

请注意，我们不需要屏蔽低位，因为无论它们是什么，它们都消失了（我们已经将它们推出了）。上面的例子更清楚，因为我们首先明确地将它们归零，但对于这个特定的例子没有必要这样做。

但是要处理大于 16 位（`int`通常是 32 位）的数字，我们仍然需要屏蔽，因为我们可以让*更高*的16 位妨碍！

`int high = (x >> 4) & 0x0F;`

# android - 当用户滚动时，是否可以在分段列表视图或线性布局中“堆积”标题

> ID：12790962
> 
> 赞同：3
> 
> 时间：2012-10-08T23:40:50.663
> 
> 标签：android, android-layout, android-listview, android-linearlayout

我有一个想法，但我不知道它是否可以在android上实现。

想法是这样的：
我有一个包含几个部分的表单供用户填写。现在该表单位于一个包含在 ScrollView 中的 LinearLayout 中。该表单包含三个部分：step1、step2 和 step3。我想要做的是当用户向下滚动时，部分折叠并且标题保留在 ScrollView 的顶部。我在下面创建了几个插图来帮助描述我想要的内容：

滚动前：
[截图 http://img15.hostingpics.net/pics/421226951.png](http://img15.hostingpics.net/pics/421226951.png)

滚动后：（[来源：][[hostingpics.net](http://img15.hostingpics.net/pics/909525512.png)][）]
[![截屏](../Images/9a13785e461679ed98ffa942678b0873.png)](https://i.stack.imgur.com/XV3VI.png)

感谢您的答复！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T00:13:42.027

谷歌开发人员提供了一些基本的代码片段。Roman Nurik为 ListView[展示了一些粘性标题。](https://plus.google.com/u/0/113735310430199015092/posts/1Sb549FvpJt)检查提供的视频中的第二个解决方案，它不是您正在寻找的，但它很接近。

您还可以查看[同步滚动库](https://github.com/xrigau/Synchronized-Scrolling/tree/master/XaviRigau-SynchronizedScrolling)，它在市场上提供了[示例应用程序。](https://play.google.com/store/apps/details?id=com.xrigau.syncscrolling.samples)您应该检查他是如何实现最后一个示例“类似于 Gmail 应用程序”的，它看起来像您所描述的那样。

# oracle - 将第一行与其他行进行比较

> ID：12790964
> 
> 赞同：0
> 
> 时间：2012-10-08T23:41:04.460
> 
> 标签：oracle

我在选择多行后需要面对的问题，循环遍历每一行并将那些有一些相关信息的人提取到第一行。

例子：

```
select NAME,ENGLISH_GRADE,FRANCE_GRAE
from (some complex query that have order by and returns 100 rows) WHOLE_ROWS
where

//Here I need to loop over WHOLE_ROWS and make something like that:
//if(currentRow.ENGLISH_GRADE==WHOLE_ROWS(0).ENGLISH_GRADE)
//fetch this row 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T01:07:54.153

基本上，您需要将查询连接到自身。您可以使用子查询因式分解子句：

```
WITH complex_query AS
    ( ... complex query here ... ) 
SELECT 
  FROM complex_query cq1
 WHERE cq1.english_grade = ( SELECT english_grade FROM cq1
                              WHERE rownum = 1 ) 
```

这是一个[SQL Fiddle](http://sqlfiddle.com/#!4/1a007/1)。你也可以通过分析来做到这一点，但在我看来，这些似乎更难理解。

# python - 在python中嵌入for循环

> ID：12790970
> 
> 赞同：1
> 
> 时间：2012-10-08T23:42:32.563
> 
> 标签：python, python-3.x

有人可以解释一下这段代码的确切含​​义：

```
for i,j in [(i,j) for i in range(len(rows)-2,-1,-1) for (j) in range(i+1)]: 
```

当有一个称为行的数组时。分配给 i 和 j 的是什么？

我相信我将成为数组的第 n-1 个索引，但我不确定 j。只是 i+1 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T23:45:31.040

```
[(i,j) for i in range(len(rows)-2,-1,-1) for (j) in range(i+1)] 
```

是相同的：

```
result = []
# from len(rows)-2 to 0, decrementing by one each time
for i in range(len(rows)-2,-1,-1):
       # from 0 to i        
    for j in range(i+1):
       result.append((i, j)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:45:35.533

它作为序列的产品工作：

```
>>> [(i, j) for i in [1, 2] for j in ['a', 'b']]
[(1, 'a'), (1, 'b'), (2, 'a'), (2, 'b')] 
```

这类似于：

```
from itertools import product
print [(i, j) for i, j in product(list1, list2)] 
```

# jquery - 移动 GPU 加速滑动切换功能

> ID：12790972
> 
> 赞同：3
> 
> 时间：2012-10-08T23:42:48.383
> 
> 标签：jquery, ios, css, mobile, hardware-acceleration

我正在为 HTML 和 CSS 中的移动应用程序开发一个界面。该应用程序使用了很多表单，我想使用 jQuery slideToggle 功能来显示和隐藏不常用的元素。

jQuery 动画在移动设备上运行非常糟糕，因此经过一些研究，似乎只有 CSS 中的 transform: translate3d() 会在 webkit 移动浏览器上调用硬件加速。

关于如何使用 CSS translate 3d 创建幻灯片切换的任何想法？

多谢你们，

G

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T23:43:25.180

使用 tranlateY() 仍然没有使用硬件加速。

如果您仍想使用 jQuery Mobile 来实现切换效果，则应更改 Jquery Mobile CSS。

寻找这个：

```
.slide.in {
            -webkit-transform: translateX(0);
            -webkit-animation-name: slideinfromright;
            }
.slide.out {
            -webkit-transform: translateX(-100%);
            -webkit-animation-name: slideouttoleft;
        }

@-webkit-keyframes slideinfromright {
            from { -webkit-transform: translateX(100%); }
            to { -webkit-transform: translateX(0); }
        }
@-webkit-keyframes slideouttoleft {
            from { -webkit-transform: translateX(0); }
            to { -webkit-transform: translateX(-100%); }
        } 
```

（见这里[http://jquerymobile.com/demos/1.1.0-rc.1/docs/pages/page-customtransitions.html](http://jquerymobile.com/demos/1.1.0-rc.1/docs/pages/page-customtransitions.html)）

并改变：

```
"translateX(-100%)" to "translate3d(-100%,0,0)"<br>
"translateX(0)" to "translate3d(0,0,0)"<br>
"translateX(100%)" to "translate3d(100%,0,0)" 
```

这将使 jQuery 用于 webkit 设备的移动过渡更顺畅。

来自 Webkit：

> translate3d(x, y, z) 在 x、y 和 z 中移动元素，只在 z 中移动元素。正 z 朝向观察者。与 x 和 y 不同，z 值不能是百分比。 [https://www.webkit.org/blog/386/3d-transforms/](https://www.webkit.org/blog/386/3d-transforms/)

众所周知，使用 translate3d 将 CSS 动画推入硬件加速。即使您要进行基本的 2d 翻译，也可以使用 translate3d 获得更多功能！

[http://davidwalsh.name/translate3d](http://davidwalsh.name/translate3d)

这样你就可以实现你正在寻找的东西。

迭戈·特里戈

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-09T10:42:09.173

只是想让您知道 1.3.1 版的 JQuery mobile 正在使用 translate3d 的幻灯片动画。1.3.0 没有。

# ruby-on-rails - 在属性访问器覆盖中引发错误？

> ID：12790973
> 
> 赞同：0
> 
> 时间：2012-10-08T23:42:50.353
> 
> 标签：ruby-on-rails, ruby-on-rails-3, attr

我正在覆盖 ActiveRecord 中的属性访问器，以将格式为“hh:mm:ss”的字符串转换为秒。这是我的代码：

```
class Call < ActiveRecord::Base
  attr_accessible :duration

  def duration=(val)
    begin
      result = val.to_s.split(/:/)
             .map { |t| Integer(t) }
             .reverse
             .zip([60**0, 60**1, 60**2])
             .map { |i,j| i*j }
             .inject(:+)
    rescue ArgumentError
      #TODO: How can I correctly report this error?
      errors.add(:duration, "Duration #{val} is not valid.")
    end
    write_attribute(:duration, result)
  end

  validates :duration, :presence => true,
                       :numericality => { :greater_than_or_equal_to => 0 }

  validate :duration_string_valid

  def duration_string_valid
    if !duration.is_valid? and duration_before_type_cast
      errors.add(:duration, "Duration #{duration_before_type_cast} is not valid.")
    end
  end
end 
```

我正在尝试在验证期间有意义地报告此错误。我的前两个想法包含在代码示例中。

1.  添加到访问器覆盖内的错误 - 有效，但我不确定它是否是一个不错的解决方案。
2.  使用验证方法`duration_string_valid`。检查其他验证是否失败并报告 duration_before_type_cast。在这种情况下，这`duration.is_valid?`不是一个有效的方法，我不确定如何检查持续时间是否已通过其他验证。
3.  我可以在 duration=(val) 内设置一个实例变量并在`duration_string_valid`.

我希望得到一些关于这是否是进行此操作的好方法以及如何改进错误报告的反馈。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T06:35:06.360

**首先**，清理你的代码。将字符串到持续时间转换器移动到服务层。在`lib/`目录中创建`StringToDurationConverter`：

```
# lib/string_to_duration_converter.rb
class StringToDurationConverter
  class << self
    def convert(value)
      value.to_s.split(/:/)
         .map { |t| Integer(t) }
         .reverse
         .zip([60**0, 60**1, 60**2])
         .map { |i,j| i*j }
         .inject(:+)
    end
  end
end 
```

**二**、添加自定义`DurationValidator`验证器

```
# lib/duration_validator.rb
class DurationValidator < ActiveModel::EachValidator
  # implement the method called during validation
  def validate_each(record, attribute, value)
    begin
      StringToDurationConverter.convert(value)
    resque ArgumentError
      record.errors[attribute] << 'is not valid.'
    end
  end
end 
```

你的模型看起来像这样：

```
class Call < ActiveRecord::Base
  attr_accessible :duration

  validates :duration, :presence => true,
                       :numericality => { :greater_than_or_equal_to => 0 },
                       :duration => true

  def duration=(value)
    result = StringToDurationConverter.convert(value)
    write_attribute(:duration, result)
  end
end 
```

# hibernate - 获取具有特定权限的人员 - 带有 grails 的弹簧安全性

> ID：12790982
> 
> 赞同：0
> 
> 时间：2012-10-08T23:44:21.593
> 
> 标签：hibernate, grails, join, criteria-api

我有典型的 Spring Security 域类布局（Person、Authority 和连接表 PersonAuthority）。我进行了以下查询，但我不知道如何建立正确的标准来获取只有特定权限的人（最后一个“if”块）。

```
public static def query(Map params=[:]){
    def criteria = Person.createCriteria();
    def rows = criteria.list(max:params.max,offset:params.offset){
    order(params.column?:"id",params.order?:"asc")
        if(params.id){
            idEq (params.id as Long);
        }        
        if(params.username){
            ilike "username","%"+params.username+"%"    
        }
        if(params.email){
            ilike "email","%"+params.email+"%"
        }
        if(params.accountLocked){
            eq "accountLocked",Boolean.valueOf(params.accountLocked)
        }
        if(params.enabled){
            eq "enabled",Boolean.valueOf(params.enabled)
        }
        if(params.passwordExpired){
            eq "passwordExpired",Boolean.valueOf(params.passwordExpired)
        }
        if(params.authorities){
            inList "authority",params.authorities;
        }
    }
    return rows;
} 
```

对于这个查询，我得到`org.hibernate.QueryException: could not resolve property: authority`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T02:20:35.210

如果您没有从默认的 Spring Security 选项和类中修改任何内容，那么我想您没有`authority`or`authorities`字段。

但是，您应该在您的 Person 类中有一个方法，该方法`getAuthorities()`返回一组 Authorities

# python - 用 Python 读取多行文件

> ID：12790983
> 
> 赞同：1
> 
> 时间：2012-10-08T23:44:22.700
> 
> 标签：python, file, file-read

我正在寻找一种 Python 方法，它可以从文件中读取多行（一次 10 行）。我已经调查过了`readlines(sizehint)`，我尝试传递值 10 但不只读取 10 行。它实际上一直读取到文件末尾（我已经尝试过小文件）。每行有 11 个字节长，每次读取都应该获取 10 行。如果找到少于 10 行，则仅返回这些行。我的实际文件包含超过 150K 行。

知道如何实现这一目标吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-08T23:52:47.403

您正在寻找[`itertools.islice()`](https://docs.python.org/2/library/itertools.html#itertools.islice)：

```
with open('data.txt') as f:
    lines = []
    while True:
        line = list(islice(f, 10)) #islice returns an iterator ,so you convert it to list here.
        if line:                     
            #do something with current set of <=10 lines here
            lines.append(line)       # may be store it 
        else:
            break
    print lines 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-08T23:47:16.547

这应该这样做

```
def read10Lines(fp):
    answer = []
    for i in range(10):
        answer.append(fp.readline())
    return answer 
```

或者，列表理解：

```
ten_lines = [fp.readline() for _ in range(10)] 
```

在这两种情况下，`fp = open('path/to/file')`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T00:36:50.887

另一种可以摆脱愚蠢的无限循环以支持更熟悉的`for`循环的解决方案依赖于`itertools.izip_longest`迭代器的一个小技巧。诀窍是`zip(*[iter(iterator)]*n)`分解`iterator`成大小为 n 的块。由于文件已经是类似生成器的迭代器（而不是类似序列），我们可以这样写：

```
from itertools import izip_longest
with open('data.txt') as f:
    for ten_lines in izip_longest(*[f]*10,fillvalue=None):
        if ten_lines[-1] is None:
           ten_lines = filter(ten_lines) #filter removes the `None` values at the end
        process(ten_lines) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T00:16:07.380

```
from itertools import groupby, count
with open("data.txt") as f:
    groups = groupby(f, key=lambda x,c=count():next(c)//10)
    for k, v in groups:
        bunch_of_lines = list(v)
        print bunch_of_lines 
```

# php - 不管用

> ID：12790984
> 
> 赞同：-1
> 
> 时间：2012-10-08T23:44:25.363
> 
> 标签：php, php-ini

我们已经将我们的项目移动到一个新服务器，使用 PHP 版本 5.3.10 (Linux ip-10-145-181-140 3.2.0-24-virtual #37-Ubuntu SMP Wed Apr 25 12:51:49 UTC 2012 i686)

现在`<?=$variable?>` 不在这里工作。

`<?php echo $variable; ?>` 正在工作中

但我们的项目挤满了`<?=$variable?>`

如何更改 php.ini/server 设置以运行此代码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T23:49:44.673

这是因为不建议使用它们。不过，查找您`php.ini`的文件并将`short_open_tag`选项编辑为`1`.

重启网络服务器/php

`.php`您可以通过在您的 webroot 中创建一个文件来找到 ini 文件所在的位置，如下所示：

```
<?php
   phpinfo();
?> 
```

# php - 如何检查最近 30 天内的情况

> ID：12790985
> 
> 赞同：-3
> 
> 时间：2012-10-08T23:44:33.867
> 
> 标签：php

我正在尝试做这样的事情：

如果“结束日期”在过去 30 天内，请执行此操作。如果没有，请执行此操作。

我将如何在 php 中编写它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T23:50:25.217

假设您将“结束日期”作为 unix 时间戳，我会尝试以下操作：

```
$month = 60 * 60 * 24 * 30; // month in seconds
if (time() - $closingTime < $month) {
  // within the last 30 days ...
} else {
  // the closing date it longer ago ...
} 
```

# python - 在另一个目录中运行 Python 脚本

> ID：12790986
> 
> 赞同：7
> 
> 时间：2012-10-08T23:45:02.897
> 
> 标签：python

我的 Linux 桌面上名为“test”的目录中有以下 Python 脚本：

```
#!/usr/bin/python

f = open('test.txt','w')
f.write('testing the script') 
```

所以这是`/Home/Desktop/test/script.py`

如果我进入目录并键入`./script.py`它可以正常工作并创建 test.txt 文件。

但是由于某种原因，我无法从桌面 ( `/Home/Desktop`) 运行脚本。例如，我尝试过`./test/script.py`，但没有奏效。

对脚本的文件权限是`755`, 和目录`777`。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-08T23:54:08.693

您可以使用`os.path.dirname()`and`__file__`来获取绝对路径，如下所示：

```
#!/usr/bin/python

import os  # We need this module

# Get path of the current dir, then use it to create paths:
CURRENT_DIR = os.path.dirname(__file__)
file_path = os.path.join(CURRENT_DIR, 'test.txt')

# Then work using the absolute paths:
f = open(file_path,'w')
f.write('testing the script') 
```

这样，脚本**将只处理与**脚本位于同一目录中的文件，而不管您从何处执行它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:49:50.460

在你的`open('test.txt', 'w')`放`open(r'./test.txt', 'w')`. 当你运行它时，使用 "python `script.py`。看看它是否有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T23:55:29.840

如果您的 cwd 是`/Desktop/test`，然后您尝试执行`./test/script.py`，则您正在尝试在`/Desktop/test/test/script.py`. 更有可能的是，您只是想做`./script.py`.

顺便说一句，如果您提供了从命令行获得的错误消息，而不是仅仅说“不起作用”，那么您的问题会更有用

如果脚本正在运行并且没有任何内容回显到控制台，则很可能它正在运行。请注意，[以“w”模式打开文件会截断文件](http://docs.python.org/library/functions.html#open)。也许您想使用a+？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T23:48:41.517

“等等”没有多大意义。

你在文件系统的哪个位置？测试目录与您所在位置的相对位置是什么？

您是否尝试过完全合格的路径？例如，

```
/home/daniel/test/script.py 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-08T23:51:56.100

你在哪个目录下执行？您可以尝试使用：

```
import os

print os.getcwd() 
```

验证工作目录是否是您认为的那样。

# list - haskell - 包含可能不起作用的列表的函数

> ID：12790987
> 
> 赞同：1
> 
> 时间：2012-10-08T23:45:11.633
> 
> 标签：list, function, haskell, maybe

我有以下功能：

```
-- xs: list to be changed
-- ws: list of indices where the values will change to 0
replaceAtIndices xs ws = [if (fromJust (elemIndex x xs)) `elem` ws then 0 else x | x <- xs] 
```

该函数接受 2 个列表。ws 是 xs 中我想更改为 0 的值的索引。

出于某种原因，它适用于某些情况，而不适用于其他情况：

```
*Main> replaceAtIndices [1,2,3,4] [2,3] 
```

[1,2,0,0] -- 正确

```
*Main> replaceAtIndices [1,2,3,4] [2] 
```

[1,2,0,4] -- 正确

```
*Main> replaceAtIndices [1,1,2,1,3] [3] 
```

[1,1,2,1,3] -- 应该是 [1,1,2,0,3]

谁能解释这是为什么？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T00:03:42.527

`elemIndex`返回列表中*第一次*出现的项目的索引，因此在第三种情况下，它总是返回不匹配`0`的索引，因此没有任何内容被替换。`1``3`

将索引与项目关联的更好方法是使用`zip`：

```
replaceAtIndices xs ws = [if i `elem` ws then 0 else x | (i, x) <- zip [0..] xs] 
```

# java - hibernate 给两行相同的行而不是两行不同的行

> ID：12790991
> 
> 赞同：0
> 
> 时间：2012-10-08T23:29:24.580
> 
> 标签：java, hibernate, dao

我有一个用户 dao

```
@Entity
@Table(name="EBIGUSERTIM")
public class EbigUser {

private String id;
private Integer source;
private String entryscheme;
private String fullName;
private String email;

private Long flags;
private String status;
private String createdBy;
private Date createdStamp;
private String modifiedBy;
private Date modifiedStamp;

@Id
@Column(name="ID")
public String getId() {
    return id;
}
public void setId(String id) {
    this.id = id;
}
@Id
@Column(name="SOURCE")
public Integer getSource() {
    return source;
}
public void setSource(Integer source) {
    this.source = source;
}
@Column(name="ENTRYSCHEME")
public String getEntryscheme() {
    return entryscheme;
}
public void setEntryscheme(String entryscheme) {
    this.entryscheme = entryscheme;
}
@Column(name="FULLNAME")
public String getFullName() {
    return fullName;
}
public void setFullName(String fullName) {
    this.fullName = fullName;
}
@Column(name="EMAIL")
public String getEmail() {
    return email;
}
public void setEmail(String email) {
    this.email = email;
}
@Column(name="FLAGS")
public Long getFlags() {
    return flags;
}
public void setFlags(Long flags) {
    this.flags = flags;
}
@Column(name="STATUS")
public String getStatus() {
    return status;
}
public void setStatus(String status) {
    this.status = status;
}
@Column(name="CREATEDBY")
public String getCreatedBy() {
    return createdBy;
}
public void setCreatedBy(String createdBy) {
    this.createdBy = createdBy;
}
@Column(name="CREATEDSTAMP")
public Date getCreatedStamp() {
    return createdStamp;
}
public void setCreatedStamp(Date createdStamp) {
    this.createdStamp = createdStamp;
}
@Column(name="MODIFIEDBY")
public String getModifiedBy() {
    return modifiedBy;
}
public void setModifiedBy(String modifiedBy) {
    this.modifiedBy = modifiedBy;
}
@Column(name="MODIFIEDSTAMP")
public Date getModifiedStamp() {
    return modifiedStamp;
}
public void setModifiedStamp(Date modifiedStamp) {
    this.modifiedStamp = modifiedStamp;
} 
```

我正在从数据库中选择 2 行。sql工作

```
select * from ebigusertim where id='blah' 
```

它返回 2 个不同的行。当我使用休眠查询数据时，似乎没有为列表中的每个条目分配对象内存。因此，我在列表中获得 2 个具有相同对象的条目。

```
 Criteria userCriteria = session.createCriteria(EbigUser.class);
        userCriteria.add(Restrictions.eq("id", id));
        userlist = userCriteria.list(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T00:01:50.413

为什么要定义两`id`列（两者`id`都`source`用注释映射`@Id`）？

```
 @Id
    @Column(name="ID")
    public String getId() {
        return id;
    }
    public void setId(String id) {
        this.id = id;
    }
    @Id
    @Column(name="SOURCE")
    public Integer getSource() {
        return source;
    } 
```

如有误请删除。如果两者一起制作`composite key`，请相应地映射它们，例如

```
 @Embeddable
  public class UserPK implements Serializable {

    @Column(name = "ID", nullable = false)
    private String id;

    @Column(name = "SOURCE", nullable = false)
    private Integer source;

    .....
    .....
   }

Use this new class in you original class as Id as below:

   @EmbeddedId
   private UserPK userPK; 
```

希望这可以帮助。

# powershell-3.0 - 如何在 powershell 版本 3 中调用 Microsoft.PowerShell.GraphicalHost

> ID：12790993
> 
> 赞同：0
> 
> 时间：2012-10-08T23:45:50.293
> 
> 标签：powershell-3.0, powershell-ise

我当前的 ps 版本是 v3，但是如果我需要调用程序集“Microsoft.PowerShell.GraphicalHost”，则此程序集是我已安装的 Windows Management Framework Core 的一部分，但仍然出现以下错误 Add-Type : Could not加载文件或程序集 'Microsoft.PowerShell.GraphicalHost, Version=1.0 .0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' 或其依赖项之一。该系统找不到指定的文件。任何大师可以帮助我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:15:58.743

当我尝试使用 Out-GridView cmdlet 时，我遇到了同样的错误。

最初，我尝试显式加载 PowerShell ISE，如下所述：

[在 PowerCLI 中使用 Out-GridView 功能](http://www.yellow-bricks.com/2011/02/24/using-the-out-gridview-feature-in-powercli/)

为了提高效率，我稍微修饰了一下：

```
if ( (Get-WindowsFeature -Name PowerShell-ISE -ErrorAction SilentlyContinue ) -eq $null )
{ 
    Import-Module ServerManager; Add-WindowsFeature PowerShell-ISE
 } 
```

我验证成功：

```
Get-WindowsFeature PowerShell-ISE 
```

但是，我仍然遇到同样的错误。更重要的是，当我从命令行测试代码时，Out-GridView cmdlet 起作用了！

问题在于 Quest Software 的 PowerGUI 脚本编辑器。虽然我安装了 PowerShell v.3，但脚本编辑器仍然使用 v.2 启动。我将启动快捷方式更改为使用“-version 3.0”选项，从而解决了问题。

这是我找到解决方案的地方：

[主题：自从用 Powershell V3 安装 PowerGUI 后无法使用外网格视图](http://powergui.org/thread.jspa?threadID=19535)

# bash - bash 脚本中的输出重定向不起作用

> ID：12790996
> 
> 赞同：1
> 
> 时间：2012-10-08T23:46:38.440
> 
> 标签：bash, outputstream, fileoutputstream

我有一个脚本，可确保进程继续运行，并且进程的输出被重定向到相应的 process_name.out 文件。

神秘地（至少对我来说），输出不会被重定向到文件，除非我关闭脚本，尽管错误确实如此。

这方面的任何线索都会非常有帮助。

```
#!/bin/bash

until $1 >> "/root/$1.out" 2>>"/root/$1.log" ; do
    echo "Server $1 crashed with exit code $?.  Respawning.." >> "/root/procees.log"
    sleep 1
done 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T11:37:02.087

评论之一中提到的@shelter 的解决方案是使用

```
until unbuffer $1 
```

反而