# StackOverflow 问答 14034000-14034999

# php - Capifony，奇怪的供应商部署中断

> ID：14034004
> 
> 赞同：1
> 
> 时间：2012-12-25T21:10:24.307
> 
> 标签：php, capistrano, capifony, vendors

我的供应商文件夹有问题。

我正在使用运行最新版本 capifony 的 Symfony 2.1.x。

每次我尝试部署它时，它都能正常工作，一切都按预期进行。但是当我尝试查看我的网站时，它说它找不到特定的实体，当我压缩本地计算机的供应商文件夹并解压缩它时，一切正常。但是这很耗时，因为供应商文件夹的大小约为 100mb，我可以使用 composer 来安装它们。我不明白这个问题，因为它没有意义。在 localhost 上一切正常，我正在运行我的供应商的最新版本，但在部署后它突然丢失了一些东西。

我希望这有点清楚，有人可以帮助我

问候 C4D3R

我的部署.rb

```
set :application, "****"
set :domain,      "***.hostgator.com"
set :deploy_to,   "/home/***/public_html/test.***.org/"

set :app_path,    "app"
set :web_path,    "web"
set :user,        "*****"
set :port,        "2222"
set :use_sudo,    false
set :php_bin, "/opt/php53/bin/php"
set :assets_install, false
default_run_options[:pty] = true

#SYMFONY 2 SPECIFIC
set :shared_files,      ["app/config/parameters.yml"]
set :shared_children,   [app_path + "/logs", web_path + "/uploads", "vendor"]
set :use_composer, true
set :update_vendors, true
set :cache_warmup, true
set :repository,  "git@bitbucket.org/****/***.git"
set :scm,         :git
# Or: `accurev`, `bzr`, `cvs`, `darcs`, `subversion`, `mercurial`, `perforce`, or `none`
set :vendors_mode,          "install"
set :model_manager, "doctrine"
# Or: `propel`

role :web,        domain                         # Your HTTP server, Apache/etc
role :app,        domain                         # This may be the same as your `Web` server
role :db,         domain, :primary => true       # This is where Symfony2 migrations will run

set  :keep_releases,  3
# IMPORTANT = 0
# INFO      = 1
# DEBUG     = 2
# TRACE     = 3
# MAX_LEVEL = 3
logger.level = Logger::MAX_LEVEL

# Be more verbose by uncommenting the following line
# logger.level = Logger::MAX_LEVEL

#SPEED UP DEPLOY
# Symfony2 2.1
#before 'symfony:composer:update', 'symfony:copy_vendors'

namespace :symfony do
  desc "Copy vendors from previous release"
  task :copy_vendors, :except => { :no_release => true } do
    if Capistrano::CLI.ui.agree("Do you want to copy last release vendor dir then do composer install ?: (y/N)")
     capifony_pretty_print "--> Copying vendors from previous release"
     run "cp -a #{previous_release}/vendor #{latest_release}/"
     capifony_puts_ok
   end
 end
end

# Fix persmissions on VPS

after "deploy:update_code" do
  namespace :symfony do
    capifony_pretty_print "--> Fixing permissions"
    run "cd #{latest_release} && find . -type f -exec chmod 644 {} \\;"
    run "cd #{latest_release} && find . -type d -exec chmod 755 {} \\;"
    capifony_puts_ok
  end
end

after "deploy", "deploy:cleanup" 
```

# servlets - 使用 ThreadLocal 存储 HttpServletRequest 和 response

> ID：14034016
> 
> 赞同：1
> 
> 时间：2012-12-25T21:12:20.993
> 
> 标签：servlets, thread-local-storage

> **可能重复：**
> [ThreadLocal 将 ServletRequest 和 Response 存储在 servlet 中：为什么？](https://stackoverflow.com/questions/5473077/threadlocal-to-store-servletrequest-and-response-in-servlet-what-for)

我有一个 servlet 类，它将信息发送到某个 Delegator 类，该类稍后调用一些业务服务方法。

我需要 Delegator 类方法的当前 HttpServletRequest 和 HttpServletResponse 对象。我没有将其保留为方法签名的一部分，而是考虑将其设置在 servlet 类的 ThreadLocal 变量中，然后从 Delegator 类的方法中的 ThreadLocal 变量中检索它。

下面是示例代码。

```
//Servlet class
    public class TestServlet extends HttpServlet{        
        protected void doGet( HttpServletRequest request, HttpServletResponse response ) throws ServletException,IOException{
           Utils.setHttpServletRequest(request);
           Utils.setHttpServletResponse(response);  
        }

    }

                             //******Utils class*************
public class Utils {
public static final ThreadLocal<HttpServletRequest> servletRequest = new ThreadLocal<HttpServletRequest>();

public static final ThreadLocal<HttpServletResponse> servletResponse = new ThreadLocal<HttpServletResponse>();

    public static HttpServletRequest getHttpServletRequest(){
        return servletRequest.get();
    }

    public static HttpServletResponse getHttpServletResponse(){
        return servletResponse.get();
    }

    public static void setHttpServletRequest( HttpServletRequest request ){
        servletRequest.set( request );
    }

    public static void setHttpServletResponse( HttpServletResponse response ){
        servletResponse.set( response );
    }
}

//Delegator clas

public class TestClass{
       public void testMethod(){
          //IS THIS CORRECT?
          HttpServletRequest request=Utils.getHttpServletRequest();
        }

} 
```

您能否建议这种方法是否存在任何可能的问题？

# asp.net-mvc-3 - 如何在List之间进行映射 和一个字符串？

> ID：14034019
> 
> 赞同：1
> 
> 时间：2012-12-25T21:12:43.303
> 
> 标签：asp.net-mvc-3, c#-4.0, automapper-2

我有一个像这样的模型和视图模型，但 AutoMapper 不会将值从 MyViewModel 传递给 MyModel！

**我的模型：**

```
public List<string> ContentLinks { get; set; }
public string ListOfContentLinks {
    get
    {
        return String.Join(";", ContentLinks);
    }
    set {
        ContentLinks = value.Split(';').ToList();
    } 
} 
```

**我的视图模型：**

```
public List<string> ContentLink { get; set; } 
```

**助推器：**

```
Mapper.CreateMap<MyViewModel, MyModel>(); 
```

我必须做些什么才能使映射正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T21:18:46.057

默认映射的属性必须具有相同的名称。你有`ContentLinks`一种情况`ContentLink`，另一种情况

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T21:24:48.910

如果您不想拥有同名的属性，请为该成员使用自定义映射：

```
Mapper.CreateMap<MyViewModel, MyModel>()
      .ForMember(d => d.ContentLinks, opt => opt.MapFrom(s => s.ContentLink)); 
```

# java - 在 Java 中加载和显示 HTML+CSS

> ID：14034024
> 
> 赞同：1
> 
> 时间：2012-12-25T21:14:05.637
> 
> 标签：java, html, css, parsing

我正在尝试在我的 Java 程序中显示 Xbox Gamer Card：这是一张 GamerCard：[http ://gamercard.xbox.com/de-DE/anybody.card](http://gamercard.xbox.com/de-DE/anybody.card)

目前我有以下内容：

```
import java.awt.Dimension;
import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.URL;

import javax.swing.JEditorPane;
import javax.swing.text.html.HTMLEditorKit;

public class CardLoader extends JEditorPane {
    private static final long serialVersionUID = 1L;
    private static final String[] card = { "http://gamercard.xbox.com/de-DE/", ".card" };
    private static final String styleSheetLink = "http://gamercard.xbox.com/Content/Gamercard/default/gamercard.css";

    public CardLoader(String username) {
        HTMLEditorKit kit = new HTMLEditorKit();
        this.setEditable(false);
        this.setPreferredSize(new Dimension(200, 135));

        kit.getStyleSheet().addRule(URLCaS(styleSheetLink));
        this.setEditorKit(kit);

        try {
            this.setPage(card[0] +username +card[1]);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    String URLCaS(String url){
        InputStream in = null;
        String returner = new String();
        try {
            in = new URL(url).openStream();
            InputStreamReader inR = new InputStreamReader( in );
            BufferedReader buf = new BufferedReader( inR );
            String line;

            while ( ( line = buf.readLine() ) != null ) {
                returner += line + "\n";
            }

            in.close();
        } catch (Exception e){
            e.printStackTrace();
        }
        return returner.substring(3);
    }
} 
```

看起来，它可以应用样式表，但不正确。

希望可以有人帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T18:54:48.647

看一下[Flying-Saucer](https://code.google.com/p/flying-saucer/)，它可以将 Html 渲染为 Swing：

> Flying Saucer 采用 XML 或**XHTML**并对其应用符合 CSS 2.1 的样式表，以便使用**Swing**或 SWT 呈现为 PDF（通过 iText）、图像和屏幕上。

这里有一些截图可用：[https ://code.google.com/p/flying-saucer/wiki/Screenshots](https://code.google.com/p/flying-saucer/wiki/Screenshots)

*   [常见问题解答](https://code.google.com/p/flying-saucer/wiki/FAQSwing)
*   [用户指南](http://flyingsaucerproject.github.com/flyingsaucer/r8/guide/users-guide-R8.html)（[渲染到 Swing 面板](http://flyingsaucerproject.github.com/flyingsaucer/r8/guide/users-guide-R8.html#xil_21)）

# java - 确保每个 Hashmap 桶/槽一个值

> ID：14034028
> 
> 赞同：0
> 
> 时间：2012-12-25T21:14:35.090
> 
> 标签：java, collections, map, hashmap

有没有办法在不篡改Java函数的情况下**严格**保证每个Hashmap桶的条目数`object.hashcode()`？

负载因子是平均值：（条目数）**/**（桶数）。本质上，假设我有一个容量为 1000 的 Hashmap。为了这个示例，假设我使用 1 的负载因子。我将要存储在 HashMap 中的 100 个对象具有错误的哈希码函数，它总是返回每个对象的值相同。当我存储完 100 个对象后，它们都将映射到同一个 HashMap 存储桶，我最终会获得 LinkedList 的性能。负载因子将保持沉默，因为 100 个条目 / 1000 个桶 = 0.1 < 1。现在如果我放置 1 M 个相同的对象会发生什么。HashMap 永远不会调整大小（无论如何都不会使用），因为永远不会触发**LF 。**

我知道这是现实世界中不常见的情况，但想提高我的理解。HashMap 有没有办法防止这种情况发生，或者至少从结构本身得到一些警告？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-25T21:31:21.470

A`HashMap`将始终根据密钥的哈希码计算要使用的存储桶。如果每个键具有相同的哈希码，它们都将映射到同一个桶。`hashCode()`如果不提供更好的实现，您将无法阻止您描述的行为。

您可以查看使用开放寻址的 Map 实现（例如[Trove](http://trove.starlight-systems.com/)的`THashMap`）。他们总是每个桶只有一个条目。但是性能不会提高，它们只是以不同的方式处理冲突，而且它们也不会解决您的根本问题：哈希码错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T23:00:27.060

编写一个完美的 HashFunction 是实现您所寻找的唯一方法。

给定一组小的特权输入，可以调整排列表，以便这些输入产生不同的哈希值，从而产生所谓的完美哈希函数。

查看[Pearson 的哈希](http://en.wikipedia.org/wiki/Pearson_hashing)

# ftp - FTP STOR 命令，我如何知道是否所有数据都已发送？

> ID：14034041
> 
> 赞同：2
> 
> 时间：2012-12-25T21:16:18.743
> 
> 标签：ftp, ftp-server

我正在尝试构建一个简单的 FTP 服务器，但是对于 STOR 命令，我不确定如何区分数据连接关闭，因为所有数据都已发送，或者数据连接是否过早关闭。

在 RETR 命令中，我知道要发送的文件的大小，但在 STOR 命令中，我不知道应该接收多少字节。

如果数据连接过早关闭，FTP服务器应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-08-11T19:21:37.660

FTP 服务器无法知道传输是否中断。这是协议的一个缺点。服务器只存储它获得的字节数，如果出现网络问题，则由客户端恢复上传（通常通过向服务器询问远程文件大小，然后结合跳过字节数进行存储已经保存了）。

这种行为通常会导致设置中出现问题，因为服务器端进程想要对上传的文件采取行动，因为它永远无法知道上传何时完成。这通常通过让客户端在上传完成后重命名文件来处理。

# google-apps-script - 使用 OAuth 通过本机客户端 (.Net) 访问受保护的 Google Apps 脚本网络服务

> ID：14034043
> 
> 赞同：0
> 
> 时间：2012-12-25T21:16:34.810
> 
> 标签：google-apps-script, oauth-2.0, google-api-client, google-oauth

我的 .Net 客户端应用程序 (Winform) 允许用户使用浏览器控件在 Google 上进行身份验证。我能够在响应中检索 access_token（我按照 [此处](https://developers.google.com/accounts/docs/OAuth2InstalledApp)的说明进行操作）。获得此 access_token 后，如何使用它“获取”（或发布）到受保护的 Google Apps 脚本。例如，如果我有一个 Web 服务 URL [https://script.google.com/macros/s/XYXYXYXYXYX](https://script.google.com/macros/s/XYXYXYXYXYX)，它被设置为作为经过身份验证的用户运行。有没有一种方法可以让我使用 access_token（通过一些特殊的 HTTP 标头或 .Net 客户端 Oauth 库）作为认证用户下载 URL？[这里](https://developers.google.com/accounts/docs/OAuth2InstalledApp)的说明仅显示如何访问受 google 保护的 API（不是 Google Apps 脚本）。需要明确的是，我不希望访问 Apps 脚本中的任何 Google API。只是一些由 Google Apps 脚本生成的简单 XML 动态 XML 或 JSON 文档。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T16:20:37.047

Apps 脚本不支持传入的 OAuth。

# javascript - 是否有用于 localStorage 的 Javascript 库来模拟 SQLite

> ID：14034044
> 
> 赞同：14
> 
> 时间：2012-12-25T21:16:49.193
> 
> 标签：javascript, sql, sqlite, local-storage

我有一个使用 SQLite 进行存储的应用程序。我们需要对其进行更改以使其能够与 Firefox 和其他浏览器一起使用。

LocalStorage 似乎是选择。但是，localStorage 不提供更复杂的 sql 功能（例如 OrderBy、GroupBy、表连接等）。

有谁知道可以与 localStorage 一起使用并使其行为更像 SQL 的 Javascript 现有库？-谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-25T22:15:41.453

您可以使用其中一种 javascript linq 实现。他们从普通的 javascript 对象/数组中获取数据，因此与 localstorage 的接口应该非常容易。

[http://jslinq.codeplex.com/](http://jslinq.codeplex.com/)
[http://linqjs.codeplex.com/](http://linqjs.codeplex.com/)
甚至[http://www.thomasfrank.se/sqlike.html](http://www.thomasfrank.se/sqlike.html)

他们的在线演示：[http](http://secretgeek.net/JsLinq/) ://secretgeek.net/JsLinq/ （注意左上角的选项）

我不太确定插入/更新方面，但你可以肯定用它们做一些很好的数据查询。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-05T02:08:52.120

试试[sql.js](https://github.com/kripken/sql.js)。这是 SQLite 从原生 C 到纯 javascript 的直接端口。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-10-30T10:44:59.700

试试[alasql.js](https://github.com/agershun/alasql)。这是一个用纯 JavaScript 编写的 SQL 数据库。即使它没有与 locasStorage 一起使用的功能，但您可以在会话或更改之前和之后轻松保存和恢复所需的所有数据。

这是一个如何将 Alasql 与 localStorage 一起使用的示例：

```
// Create database and table structure
var db = new alasql.Database();
db.exec('CREATE TABLE students (studentid INT, school STRING)');

// Load table data from localStorage if it exists or create new table
if(localStorage['students']) {
    db.tables.students.data = JSON.parse(localStorage['students']);
} else {
    db.tables.students.data = [
       {studentid: 55, school: 'abc'},
       {studentid: 56, school: 'klm'},
       {studentid: 57, school: 'nyz'}
    ];
    localStorage['students'] = JSON.stringify(db.tables.students.data);
};

// Add new student and save database
db.tables.students.data.push({student: 100, school:'qwe'}); 
localStorage['students'] = JSON.stringify(db.tables.students.data);

// SQL-query
console.log(db.exec("SELECT * FROM students WHERE school > 'ght'")); 
```

这个例子[在 Fiddle](http://jsfiddle.net/6a06dqhc/3/)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-26T13:42:15.157

如果您正在寻找 SQLLite 的 HTML5 / JavaScript 关系数据库替代品： [SequelSphere](http://www.sequelsphere.com)

SequelSphere 是一个 Javascript 库，适用于所有现代浏览器和平台，并将其数据存储在 IndexedDB 和 LocalStorage 中（取决于浏览器支持的内容）。它可以轻松地与任何 3rd 方 RIA 框架集成，并提供“更改跟踪器”来帮助进行数据同步。

由于您询问了复杂的 SELECT 功能，因此可以在 SequelSphere 的网站上找到以下内容：[Top 9 Cool SequelSphere 功能](http://www.sequelsphere.com/how-it-works/top-features/)

> SequelSphere 最令人印象深刻的功能必须是其革命性的 SQL 解析和执行引擎。它处理所有正常的 SELECT 功能和表达式，然后处理 LEFT、RIGHT 和 FULL 外连接。它不仅拥有处理无限嵌套的子查询，它还在每个主要子句（SELECT、FROM、WHERE、JOIN、ON、HAVING 甚至 GROUP BY！）中处理它们。说到分组，它还处理分组集、汇总、多维数据集和总计分组功能。它甚至可以优雅地处理复杂的条件表达式，例如：
> 
> (a,b) 不在 ((1, 2), (3, 4), (select c, d from tab))
> 
> 再加上在运行时混合自定义、用户定义的函数和第三方表的能力（这两个功能本身就很酷），SQL 引擎确实非同寻常。没有其他 SQL 引擎可以做到这些事情，更不用说在所有主要浏览器和平台上 100% 使用 JavaScript 做到这一点了。而且，我们不要忘记它以极快的速度完成所有这些工作：解析、规划和优化所有发生的亚毫秒级。

完整披露：我是 SequelSphere 的一员，产品很棒。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-27T05:37:50.213

试试我的开源库[https://bitbucket.org/ytkyaw/ydn-db/wiki/Home](https://bitbucket.org/ytkyaw/ydn-db/wiki/Home)它有 IndexedDB、WebSQL 和网络存储。提供了丰富的查询选项。令人惊讶的易于使用。

# javascript - 如何使用多阵列启动 localStorage

> ID：14034045
> 
> 赞同：1
> 
> 时间：2012-12-25T21:16:51.393
> 
> 标签：javascript, local-storage

我试图修改我的本地存储浪费了很多时间。

最初我像这样启动它

```
localStorage.setItem('bipme','{"modules": []}'); 
```

它工作，但知道我需要有这个例子

```
{
    "modules" : [
        {
            "id" : "0",
            "pseudo" : "Titi",
            "mode" : "gps",
            "perimetre" : "3",
            "distance" : "1",
            "start" : "2012-09-23 08:00:00",
            "refresh" : "08:20:00",
            "last" : "2012-09-23 08:00:00"
        },
        {
            "id" : "1",
            "pseudo" : "Toto",
            "mode" : "phone",
            "perimetre" : "10",
            "distance" : "0",
            "start" : "2012-09-23 08:00:00",
            "refresh" : "08:20:00",
            "last" : "2012-09-23 08:00:00"
        },
        {
            "id" : "2",
            "pseudo" : "Tete",
            "mode" : "gps",
            "perimetre" : "5",
            "distance" : "5",
            "start" : "2012-08-23 08:00:00",
            "refresh" : "10:20:00",
            "last" : "2012-09-23 08:00:00"
        }
    ],
    "modulesIndex" : 0,

    "watchPosition" : [
        {
            "id" : "0",
            "pseudo" : "Antoine",
            "phone" : "+41781234567",
            "date" : "2012-05-01 17:20:00"
        },
        {
            "id" : "1",
            "pseudo" : "Barbara",
            "phone" : "+41781234567",
            "date" : "2012-05-27 17:20:00"
        }
    ]
} 
```

然后，我尝试了这个

```
localStorage.setItem('bipme','{"modules":[]},{"modulesIndex":0},{"watchPosition":[]}'); 
```

但现在我总是收到这个错误信息

```
SyntaxError: JSON.parse: unexpected non-whitespace character after JSON data
[Break On This Error]   

var objJSON = JSON.parse(localStorage.getItem('bipme')); 
```

那么现在我该如何正确启动我的本地存储

感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T05:35:56.483

设计模式是，您使用 JSON 字符串化到要存储的对象。例如：

```
var objs = {
  modules : [
    {
        "id" : "0",
        "pseudo" : "Titi",
        "mode" : "gps",
        "perimetre" : "3",
        "distance" : "1",
        "start" : "2012-09-23 08:00:00",
        "refresh" : "08:20:00",
        "last" : "2012-09-23 08:00:00"
    }]
};
localStorage.setItem('bipme', JSON.stringify(objs)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T21:34:31.237

你在那里有多个对象。如果这是您想要的，则需要对数组使用方括号：

```
localStorage.setItem('bipme','{"modules":[]},{"modulesIndex":0},{"watchPosition":[]}');
// Should be:
localStorage.setItem('bipme','[{"modules":[]},{"modulesIndex":0},{"watchPosition":[]}]'); 
```

如果您打算`modulesIndex`etc. 成为同一对象的一部分，那么只需不要关闭该对象：

```
localStorage.setItem('bipme','{"modules":[],"modulesIndex":0,"watchPosition":[]}'); 
```

我相信你已经在你的评论中解决了。

# c++ - 将对象转换为 std::unique_ptr

> ID：14034046
> 
> 赞同：6
> 
> 时间：2012-12-25T21:16:52.640
> 
> 标签：c++, pointers, type-conversion

我有一个简单的菜鸟问题，我找不到答案：

在 C++ 中，如何转换常规对象

```
int i; 
```

变成一个`std::unique_ptr`？

```
std::unique_ptr<int> iptr = &i; //invalid
std::unique_ptr<int> iptr = static_cast<std::unique_ptr<int>>(&i); //invalid 
```

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-25T21:19:15.997

你没有。该对象不能被 删除`delete`，这是`unique_ptr`将要做的。你需要

```
auto iptr = make_unique<int>(); 
```

在这里，我们将 make_unique 定义为与 make_shared 相同的实用函数，它应该是标准的，但不幸的是被忽略了。这是简要的实现：

```
template<typename T, typename... Args> std::unique_ptr<T> make_unique(Args&&... args) {
    return std::unique_ptr<T>(new T(std::forward<Args>(args)...));
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-25T21:20:02.330

你没有。`i`不是动态分配的，所以不需要删除。如果你在它的地址周围包裹一个智能指针，它会`delete &i`在某个时候给你未定义的行为。您应该只将您`new`编辑的内容包装在智能指针中，如下所示：

```
std::unique_ptr<int> ptr(new int(5)); 
```

智能指针的全部意义在于它为您管理动态分配对象的生命周期。`i`具有自动存储持续时间，因此将在其范围结束时被销毁。你不需要任何东西来帮助你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-25T21:25:00.363

我相信这会奏效：

```
int i;
auto deleter = [](int *ptr){};
std::unique_ptr<int, decltype(deleter)> iptr(&i, deleter); 
```

您必须提供一个什么都不做的自定义删除器。默认删除器无法删除未分配的自动变量`new`。（然而，这违背了使用智能指针的目的，但表明它是可能的）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-25T21:20:13.597

当 unique_ptr 被销毁时会发生什么？或者另一种方式，当变量超出范围时？实际上没有任何意义

# objective-c - Xcode 链接器错误：对于架构 x86_64 而言文件太小

> ID：14034048
> 
> 赞同：100
> 
> 时间：2012-12-25T21:17:11.723
> 
> 标签：objective-c, ios, xcode, macos, cocoa

我正在 Xcode 中开发一个应用程序。

当我尝试构建时，出现此错误：

```
ld: in /Users/theodore/Library/Developer/Xcode/DerivedData/Tower-bkpdifuqssebjdgurzmtirbxejnn/Build/Intermediates/Tower.build/Debug/Tower.build/Objects-normal/x86_64/TWRAppDelegate.o, file too small for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：209
> 
> 时间：2015-04-29T19:13:58.993

窃取@martin-baulig 的答案：

尝试完全重建/清理。以前的构建可能已异常中止，导致 TWRAppDelegate.o 文件损坏或大小为零。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-03-03T15:04:44.347

我通常在有问题的文件中添加一个空格（可以是任何字符），删除它然后保存。比干净的构建更容易和更快。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2018-11-21T14:25:20.893

`Build Script Phase`可以添加自动修复此问题。转到 Xcode -> 你的项目 -> 你的目标 -> 构建阶段 -> + -> 新的运行脚本阶段

将其重命名为`Xcode Link Fix`并将其移至阶段上方`Compile Sources`。将此粘贴到脚本正文中：

```
# Legacy build system
legacy_dir=`dirname "${LD_DEPENDENCY_INFO_FILE}"`
if [ -d "${legacy_dir}" ]; then
    find "${legacy_dir}" -size 0 | while read -d $'\n' file; do
        rm "$file"
    done
fi

# New build system
if [ -d "${OBJECT_FILE_DIR_normal}" ]; then
    find "${OBJECT_FILE_DIR_normal}" -size 0 | while read -d $'\n' file; do
        rm "$file"
    done
fi 
```

此脚本检查大小为零的目标文件并将其删除，以便在下一步编译完成时成功。

如果您有很多应用程序目标，则需要为每个应用程序目标添加此脚本。

该脚本需要大约 0.1 秒的时间来运行，并使您免于完整的项目重建。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-10-20T08:57:18.157

`rm -rf /Users/hostname/Library/Developer/Xcode/DerivedData`

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-09-14T02:34:01.493

只需在终端应用程序中运行 cmd 即可删除此文件：

```
rm /Users/theodore/Library/Developer/Xcode/DerivedData/Tower-bkpdifuqssebjdgurzmtirbxejnn/Build/Intermediates/Tower.build/Debug/Tower.build/Objects-normal/x86_64/TWRAppDelegate.o
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-03-20T13:19:18.153

无需完全清理缓存即可修复错误的快速方法：

1.  打开错误描述的文件（如果出现此问题`TWRAppDelegate`）
2.  命令+一个
3.  命令 + X
4.  重建 - 失败
5.  命令 + V
6.  重建 - 成功

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-06-29T11:18:08.093

由于构建一个干净的项目可能需要太长时间，因此对于那些有权访问缓存中损坏的文件的人来说，有更短的方法：

*   删除文件（删除参考）
*   构建项目
*   重新插入文件
*   构建项目

完整版，因此您可以轻松找到文件：

*   在 Xcode 项目导航器中查找文件
*   右键单击文件并按“在查找器中显示”（在文件所在的位置打开查找器）
*   在 Xcode 中选择文件并按退格键，然后单击“删除引用”
*   构建项目（它会失败但等待它完成）
*   通过将文件从查找器拖动到您刚刚删除它的相同位置来重新插入文件
*   构建项目（现在应该可以工作）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-06-04T20:29:39.120

您可以删除 TWRAppDelegate.o 文件并继续构建。复制错误消息中提到的完整路径并将其粘贴到终端中的“rm”命令后面。无需清理/重建、删除派生数据、从项目中添加/删除文件等。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-08-02T05:28:38.313

步骤 1\. 转到：项目 > 构建设置 > 搜索路径

步骤 2\. 将“始终搜索用户路径”设置为“是”

步骤 3\. 构建项目（您会收到警告，但项目会构建。）

步骤 4\. 将“始终搜索用户路径”设置回否并再次构建以消除警告

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-12-05T22:15:46.763

在我的情况下没有进行干净的重建，所以我解释了我是如何解决问题的：
- 删除了对文件的引用（不要删除文件）
- 再次将文件添加到项目并运行

# maven - Maven M2_HOME 设置为无效目录（Windows 7）

> ID：14034052
> 
> 赞同：17
> 
> 时间：2012-12-25T21:17:44.827
> 
> 标签：maven, windows-7, installation

我尝试将 Maven 安装到 Windows 7，但效果不佳。一些基本信息：

Maven安装目录： `C:\Program Files\Apache Software Foundation\apache-maven-3.0.4` 系统变量“ `M2_HOME`”： `C:\Program Files\Apache Software Foundation\apache-maven-3.0.4\` 系统变量“ `Path`”： `%M2_HOME%apache-maven\src\bin;%JAVA_HOME%\bin`

如果我`mvn --version`在命令路径中运行，我会收到错误消息：

> 请`M2_HOME`在您的环境中设置变量以匹配 Maven 安装的位置

`mvn`因此，目前未根据说明设置子目录，即`%M2_HOME%\bin`. 如果我`%M2_HOME%apache-maven\src\bin`用那个替换，我得到：

> mvn 不是内部或外部命令、可运行程序或批处理文件

在 Maven 安装目录（或 zip 文件中）中没有`\bin`直接文件夹`apache-maven-3.0.4`，我想知道是否应该有一个？

我是Maven的新手，希望你们能提供帮助。

顺便说一句，Java 命令可以从任何目录工作，所以我认为这不是这里的问题，但我不能确定。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-03-15T08:57:07.927

In `M2_HOME`-set`C:\apache-maven-3.0.4`即没有`bin`. In `PATH`- 设置`%M2_HOME%\bin`，即`bin`在路径中。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-12-25T22:24:53.040

如果您下载的包 apache-maven-3.3.9 不包含 bin 文件夹，则您的下载错误。您必须[下载一个包含](http://archive.apache.org/dist/maven/maven-3/3.3.9/binaries/apache-maven-3.3.9-bin.zip)bin、boot、conf、lib 文件夹的 zip 文件，否则会出现问题。下载的文件应该有大约 4.8 mb 大小。您可以通过 md5 或 SHA1 校验和检查文件。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-04-25T21:12:14.447

在 3.3.1 中 *.bat 文件消失了，只剩下 *.cmd 文件。.CMD 与 .BAT 相同，某些软件需要它们。我已将 .CMDs 重命名为 .BATs 以使其在 Netbeans 下运行。它导致“Maven M2_HOME 设置为无效目录”。将 .BAT 复制到 .CMD（即两者都在文件夹中）解决了这个问题。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2016-07-15T14:24:39.063

在我的情况下，设置是正确的：

**Windows 系统变量：**

*   M2 C:\dev\software\apache-maven-3.3.9\bin
*   M2_HOME C:\dev\software\apache-maven-3.3.9

**Windows 用户变量：**

*   %M2_HOME%\bin

但是当有**两次**安装 maven 时我遇到了同样的问题，即使所有引用都指向最新版本，在我的例子中是 3.3.9。***删除旧***版本后，相同的命令识别出 maven。

前：

```
maven -v
ERROR: M2_HOME is set to an invalid directory.
M2_HOME = "C:\dev\software\apache-maven-3.3.9"
Please set the M2_HOME variable in your environment to match the
location of the Maven installation 
```

后：

```
maven -v
Apache Maven 3.3.9
Maven home: C:\dev\software\apache-maven-3.3.9
Java version: 1.7.0_51, vendor: Oracle Corporation
Java home: C:\Program Files\Java\jdk1.7.0_51\jre 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-02-12T07:09:04.533

您需要下载名为“Binary zip”的 Maven 文件。例如： http: [//mirrors.digipower.vn/apache/maven/maven-3/3.1.1/binaries/apache-maven-3.1.1-bin.zip](http://mirrors.digipower.vn/apache/maven/maven-3/3.1.1/binaries/apache-maven-3.1.1-bin.zip)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-09-01T14:53:44.253

我的电脑也有同样的问题，我解决了：

*   我删除了 Maven 目录和 Maven 环境变量
*   [我在https://maven.apache.org/download.cgi](https://maven.apache.org/download.cgi)上下载了二进制 zip 存档
*   我解压了`C:\maven`
*   我添加了新的环境变量：`C:\maven`in `M2_HOME`，`%M2_HOME%\lib`in`M2` 和add `%M2%`in`PATH`

它有效！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-12-24T11:10:30.720

刚才我遇到了同样的问题。在我的情况下，问题是`PATH`没有正确设置包括`%M2_HOME%\bin`. 一旦设置正确，问题就解决了。

当您遇到此类问题时，请在命令行上打印 的值，`PATH`以确保它正确获取值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-03-17T19:00:51.913

对我来说，PATH 变量有旧版本的 Maven。所以我更新了它。我应该使用 %M2_HOME% 但我已经拼出了路径。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-11-20T21:00:39.790

摆脱环境变量 M2_HOME。maven 3 不使用它，事实上，它混淆了它。如果您在路径中使用过它，那么要么明确定义 maven bin 的路径，要么将其更改为其他内容 - 例如 M3_HOME。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-11-04T15:21:39.163

下一步后一切顺利。

1.  在[http://maven.apache.org/download.cgi](http://maven.apache.org/download.cgi)页面上，来自 4 个变体需要下载***二进制***文件。

2.  设置环境变量（来自@JamesB - [https://stackoverflow.com/a/13093358/3941340](https://stackoverflow.com/a/13093358/3941340)的提示）：

JAVA_HOME=C:\Program Files\Java\jdk1.6.0_35

MAVEN_HOME=D:\software\apache-maven-3.0.4

PATH=%PATH%;%MAVEN_HOME%\bin;%JAVA_HOME%\bin

3.  运行*mvn -version*

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-07T15:01:06.240

在搜索路径中显示的另一个目录中有旧版本的 MVN。删除了旧版本，一切正常。使用 Windows 文件搜索扫描驱动器以查找“mvn”的所有实例以查找旧版本。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-02-11T06:55:14.470

将整个 bin 位置添加到“PATH”环境变量 例如：C:\Program Files\Apache Software Foundation\apache-maven-3.0.4\bin

不需要 M2_HOME，M2。它对我有用

Microsoft Windows [版本 10.0.14393] (c) 2016 Microsoft Corporation。版权所有。

> C:\Users\XXXX>mvn -version Apache Maven 3.3.9 (bb52d8502b132ec0a5a3f4c09453c07478323dc5; 2015-11-10T22:11:47+05:30) Maven 主页：C:\Program Files\Apache Software Foundation\apache-maven-3.3 .9\bin.. Java 版本：1.8.0_91，供应商：Oracle Corporation Java 主页：C:\Program Files\Java\jdk1.8.0_91\jre 默认语言环境：en_US，平台编码：Cp1252 操作系统名称：“windows 10” ，版本：“10.0”，拱：“amd64”，家庭：“dos”

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-05-20T11:30:54.057

检查不同 maven 位置中的系统变量 M2_HOME 和 PATH。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-06-09T06:18:32.663

在您的帐户的环境变量中设置“M2_HOME”和“PATH”，从系统环境变量中删除“PATH”。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-04-10T08:34:16.293

有可能在并行位置安装另一个版本的 Maven。在这种情况下，删除不需要的路径并针对 M2_HOME 重置适当的路径。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-08-23T21:09:30.973

**快速解答**
基于安装的不同Maven版本相关的M2_HOME使用问题，为了简化事情，M2_HOME的使用已被删除，不再支持。Windows 用户的另一个重要变化：%HOME% 的使用已被 %USERPROFILE% 取代

**更详细的回答**
你观察到的一直是maven的问题。当您在同一目录中安装两个不同版本时，会检测到旧版本，而不会检测到新版本。
Maven 3.3.9 发布后，Eclipse Aether 项目退役，代码库迁移到 Apache Maven 项目。3.4.0 版本的最初目标是在迁移到 Apache Maven 项目后用完全相同的代码替换 Aether，然后继续对解析器代码以及 Maven 的其他区域进行错误修复。这从未像预期的那样发生，因此决定永远烧毁 3.4.x 发布线。切换到 3.5 带来了这些变化

# applescript - AppleScript 是否有条件（三元）运算符的等价物？

> ID：14034060
> 
> 赞同：6
> 
> 时间：2012-12-25T21:19:09.493
> 
> 标签：applescript, ternary-operator

熟悉编程，我缺少使用三元运算符分配变量的能力（即“`x`如果某事为真，则将变量设置为，否则将其设置为`y`”）。我在想类似的东西：

```
set my_string to (if a is 0 return "" else return " - substring") 
```

这当然行不通，我还没有发现任何类似的东西。是否有另一种方法可以用 applescript 实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T12:54:05.320

看起来 AppleScript 不支持条件运算符，但您可以为此目的使用带有两个元素的列表。当然，总的来说它不是很优雅：

```
set my_string to item (((a is 0) as integer) + 1) of {"", " - substring"} 
```

还有另一种方法：您可以使用 shell 脚本

```
set b to (do shell script "test " & a & " -eq 0 && echo 'is 0' || echo 'is not 0'") 
```

我怎么能忘记这个？:)

在您的情况下，它会更加简单（因为如果根本没有回声，将返回一个空字符串）。

```
set b to (do shell script "test " & a & " -eq 0 || echo '- substring'") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-25T21:50:45.140

```
if a is 0 then
    set my_string to ""
else
    set my_string to " - substring"
end if 
```

或者

```
set a to 7

set my_string to my subTern(a)

on subTern(aLocalVar)
    if aLocalVar is 0 then return ""
    if aLocalVar is not 0 then return " - substring"
end subTern 
```

# image - 几幅相似图像的图像分割

> ID：14034064
> 
> 赞同：0
> 
> 时间：2012-12-25T21:19:56.150
> 
> 标签：image, image-processing, image-segmentation

我有一个有点奇怪的问题。自从大约 6 个月前我开始去健身房以来，我每周都会拍一张裸照，我想看看我在视频中的变化。问题是我没有把它们放在蓝色的墙或类似的东西前，而是在我的房间里。现在我想从中提取我并从中创建一个视频。我可以手动完成，但这将是很多工作，而且不会有一半的乐趣。有几个问题：

*   房间看起来很相似，但并非背景中的一切总是完全相同
*   房间的灯光很不一样
*   自己的灯光不一样
*   我拍照片的地方几乎是一样的（我尽力了），但不完全一样，所以每张照片上的所有东西都会有几个像素的不同
*   角度也有点不同

我希望能够从每张照片中提取我并自动调整照明，使其看起来尽可能相似。

我知道一种适用于类似问题的算法：我有一个只有背景的视频和一个人走过场景的视频。然后，我可以计算仅背景视频中每个像素的平均 m RGB 矢量并构建协方差矩阵 C，对于真实视频，我提取每个像素 x，其中 (xm)'C(xm) 大于某个阈值。但是我想如果背景的光照有轻微的变化就可以了，但是我想它不适用于不同的角度和不同的位移，所以我想我需要改进。

我有很好的编程技能和图像处理的基本知识，所以我可能能够理解有关该主题的论文等。我只是不知道要搜索什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:57:47.583

像素可以属于对象和背景两类的图像分割任务通常称为“阈值化”。有几种算法可用，但几乎每个图像处理库都默认实现了 Otsu 的方法（http://en.wikipedia.org/wiki/Otsu%27s_Method）。如果闪电不均匀，您可以尝试使用多个阈值的一类算法，一个用于图像中每个像素子集的阈值，而不是仅用于整个图像的一个阈值。这些方法在文献中被称为“自适应阈值”/“局部阈值”，并来自 OCR 和医学研究。您可能需要使用一些形态过滤器对结果进行预处理/后处理以消除噪声。

这是一篇关于 MATLAB 中类似分割任务的精彩博客文章：http: [//blogs.mathworks.com/steve/2010/10/08/the-two-amigos/](http://blogs.mathworks.com/steve/2010/10/08/the-two-amigos/)

如果您仍然没有得到好的结果，请在文献中搜索“背景减法”以获取不基于强度阈值的更复杂的算法。

# java - NetBeans 中的 Java。无法访问嵌套的公共类和枚举

> ID：14034065
> 
> 赞同：0
> 
> 时间：2012-12-25T21:19:57.633
> 
> 标签：java, netbeans

这是 Category.java 中的部分代码

```
public class Category

    {
        static public final class range
        {
            public range( double lower, double upper )
            {
                this.lower = lower;
                this.upper = upper;
            }
            public double lower;
            public double upper;
        }    
    static public Map< category_type, range > validCategoryRanges = new EnumMap<>(category_type.class);
    ... 
```

当需要访问同一包的其他文件时，没有这样的类，只看到字段validCategoryRanges。（在 Eclipse 中它有效）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T21:42:35.437

尝试在初始化块之外定义嵌套类，就像任何成员变量一样。这应该与您使用的任何 IDE 无关。公共类 OuterClass { 公共静态最终类 InnerClass { } }

# c++ - 使用控制台进行分页

> ID：14034068
> 
> 赞同：0
> 
> 时间：2012-12-25T21:20:22.690
> 
> 标签：c++, visual-c++, pagination

是否可以使用控制台用户界面进行分页？假设我有 30 条员工记录，我只想显示 10 条。用户按下箭头按钮，他们可以看到接下来的 10 条列表。可能吗？

```
EXEC SQL DECLARE EmployeeReportCursorJawatan CURSOR FOR
        SELECT EMP_ID, NAMA, IC, JAWATAN, GAJI_ASAS, TEL_RUMAH, TEL_BIMBIT, ALAMAT FROM PEKERJA WHERE upper(JAWATAN) LIKE upper(:str);

    EXEC SQL OPEN EmployeeReportCursorJawatan;
    /* loop through the cursor and break the loop when end*/
    EXEC SQL WHENEVER NOT FOUND DO break;
    while (1)
    {
        /* fetch the data from cursor and display*/
        EXEC SQL FETCH EmployeeReportCursorJawatan INTO :emp_idSearch, :namaSearch, :icSearch, :jawatanSearch, :gajiSearch, :homeSearch, :mobileSearch, :alamatSearch;

    cout<<"\nID\t\t: " << emp_idSearch;
    cout<<"\nName\t\t: " << namaSearch;
    cout<<"\nIC\t\t: " << icSearch;
    cout<<"\nPost\t\t: " << jawatanSearch;
    cout<<"\nSalary\t\t: RM " << gajiSearch;
    cout<<"\nPhone number (H): " << homeSearch;
    cout<<"\nPhone number (M): " << mobileSearch;
    cout<<"\nAddress\t: " << alamatSearch;
    cout<<"\n---------------------------------------------------------\n";

        totalCustomer++;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T15:00:29.097

合乎逻辑的解决方案是安装`more`在机器上，并让用户通过它管道输出。但实施起来并不难。基本上，您决定在一页上放置多少行或条目，然后跟踪当前页面顶部的索引。然后输出如下内容：

```
int currentTop = 0;
bool finished = false;
while ( !finished ) {
    clearScreen();
    for ( int i = 0; i < maxOnPage && i + currentTop < entryCount; ++ i ) {
        displayEntry( i + currentTop );
    }
    std::cout << "Continue: ";
    std::string command;
    std::cin >> command;
    switch ( parseCommand( command ) ) {
    case advanceOneLine:
        ++ currentTop;
        break;

    case advanceOnePage:
        currentTop += maxOnPage;
        break;

    case finish:
        finished = true;
        break;

    default:
        //  ???
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T21:23:51.607

是的，它实际上比你想象的要容易得多。这是我编写的程序中的一段代码，它正是这样做的，重要的是简单地创建一个静态变量来表示用户所在的“页面”。破败不堪

*   使用静态变量来表示页码
*   使用迭代器和 std::advance 将迭代器推送到当前页码
*   从页面的第一个元素开始循环到最后一个元素（在这个程序中，我让每个页面显示我的 lsit 的 10 个元素

* * *

```
void ExList::Display()
{
    using std::setw; //save time
    //begin iter starts at page number * 10 since each page has 10 elements
    list<Workout>::iterator PageNum = wrkout.begin(); std::advance(PageNum, AdvanceVar * 10);
    //advance the iter 10 places past PageNum so the loop will run 10 times
    list<Workout>::iterator iterEnd = PageNum; std::advance(iterEnd, 10);
    //formatting for my 'exercise tracker' program
    std::cout << setw(20) << "Page: " << AdvanceVar + 1 << "/" << (((int) wrkout.size()) /  10) + 1
     << std::endl << std::endl;
    std::cout << std::left          //left justified
    << setw(TAB) << "Date"          //print titles
    << setw(TAB) << "Type"
    << setw(TAB) << "Distance"
    << setw(TAB) << "Units"
    << setw(TAB) << "Additional Comments\n"
    << "---------------------------------------------------------------------\n";
    //loop through 10 times displaying the proper elements
    for(PageNum; PageNum != iterEnd && PageNum != wrkout.end(); PageNum++)
    {
        std::cout << std::left
        << setw(TAB) << PageNum->Date
        << setw(TAB) << ConvertEnum(PageNum->TYPE)
        << setw(TAB) << PageNum->distance
        << setw(TAB) << PageNum->units
        << setw(TAB) << "Select to review\n";
    }

    std::cout << "---------------------------------------------------------------------\n";

} 
```

如果您想查看整个程序以获得更深入的程序，请给我发送电子邮件

# java - Java Robot - 检查符号键

> ID：14034069
> 
> 赞同：1
> 
> 时间：2012-12-25T21:20:58.537
> 
> 标签：java, keyboard, awt, keypress, awtrobot

我目前的项目涉及使用 Java 的 Robot 类来模拟按键的自动化。我的问题是某些键码无法传递给机器人的`keypress(int keycode)`方法。

### 我已经知道的：

在阅读了这个问题的解决方案后：[Why are some KeyEvent keycodes throwing IllegalArgumentException: Invalid key ocode](https://stackoverflow.com/questions/6634375/why-are-some-keyevent-keycodes-throwing-illegalargumentexception-invalid-key-c)，我开始修改我的代码，更改某些符号，如`£ (VK_DOLLAR)`to `VK_SHIFT + VK_3`、`& (VK_AMPERSAND)`to`VK_SHIT + VK_7`等......

### 我的问题：

然而，我的问题是如何确定哪个键在与 shift 结合时给出什么符号，因为不同的键盘（并且通常来自操作系统的不同键盘配置）会改变这些。

一个典型的例子是`@ (at symbol) and " (double quote)`. `VK_SHIFT + VK_2`在某些系统上可能是 at 符号，而在其他系统上可能是双引号。

在调用机器人按键之前，Java 中是否有要检查的符号依赖于哪个键？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T13:04:11.990

使用机器人时，我已经经历了 IllegalArgumentException。这是因为您的键盘布局。我的解决方案是使用 Alt 代码：

```
public static void alt(int event1, int event2, int event3, int event4) throws Exception {

Robot bot = new Robot();
bot.delay(50); //Optional
    bot.keyPress(KeyEvent.VK_ALT);

        bot.keyPress(event1);
        bot.keyRelease(event1);

        bot.keyPress(event2);
        bot.keyRelease(event2);

        bot.keyPress(event3);
        bot.keyRelease(event3);

        bot.keyPress(event4);
        bot.keyRelease(event4);

    bot.keyRelease(KeyEvent.VK_ALT);

} 
```

它使发送 Alt 代码变得容易。

例如，如果你想要一个＆符号，只需使用`alt(KeyEvent.VK_NUMPAD0, KeyEvent.VK_NUMPAD0, KeyEvent.VK_NUMPAD3, KeyEvent.VK_NUMPAD8);`

您只需确保 Num Lock 已打开。

获取所需替代代码的有用网站是[http://www.alt-codes.net/](http://www.alt-codes.net/)

# python - 本地单元测试 - 调用高复制数据存储的异步请求

> ID：14034079
> 
> 赞同：0
> 
> 时间：2012-12-25T21:22:21.443
> 
> 标签：python, unit-testing, google-app-engine

我一直在使用测试驱动开发在应用引擎上开发一个 python 应用程序。我编写的测试之一向本地服务器发出了 2 个 HTTP 请求（模拟应用程序的正常行为）。第一个请求生成一个数据库实体并返回我在服务器上分配给它的一些 ID，第二个请求将它获得的 ID 与其他数据一起发送以更新第一条记录。我的问题是，尝试在第二个请求上使用 --high_replication （模拟高复制数据存储）运行服务器，服务器无法在数据存储中找到 ID。（没有 --high_replication 它正在工作）。我找到了一种解决方法，在每个请求之间添加睡眠，但我确信有更好的方法。

任何信息或帮助将非常感谢。

为了提供更多信息，这是测试的一部分：

```
response = self.sendPing()
response = self.updatePing(response['response'])
self.assertEquals(response['response'], 'OK') 
```

我为此找到的解决方法是：

```
response = self.sendPing()
time.sleep(1)
response = self.updatePing(response['response'])
self.assertEquals(response['response'], 'OK') 
```

在请求之间睡 1 秒时，我得到了很好的结果

科德科德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T05:35:35.753

您提供的代码并没有告诉我太多关于您如何查询数据的信息。

从纯理论的角度来看，您有几个选择：

1.  使用创建的实体的键并在响应中返回该键，然后使用该键获取记录。最终一致性不适用于按键获取。
2.  使用命名键。[请参阅此问题中的答案](https://stackoverflow.com/questions/10271103/ndb-using-users-api-to-form-an-entity-group)。
3.  [使用祖先查询](https://developers.google.com/appengine/docs/python/ndb/queries#ancestor)。它们总是一致的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T00:43:12.723

当您使用 --high_replication 时，数据存储会模拟最终的一致性行为。

正如 Sologoub 所提到的，您可以进行适当的完全一致的数据存储调用以获得正确的读取。

另一种选择是强制 dev_appserver 数据存储以完全一致的方式运行。您可能希望使用它来简化某些测试，但请记住，它不是模拟现实世界的一致性行为。

请参阅文档：[https ://developers.google.com/appengine/docs/python/tools/localunittesting#Writing_HRD_Datastore_Tests](https://developers.google.com/appengine/docs/python/tools/localunittesting#Writing_HRD_Datastore_Tests)

您想将 PseudoRandomHRConsistencyPolicy 设置为 100

# javascript - 使用动画CSS顺序动画元素

> ID：14034080
> 
> 赞同：1
> 
> 时间：2012-12-25T21:22:24.770
> 
> 标签：javascript, jquery, css, css-transitions

我有以下[http://jsfiddle.net/fFMt2/1/](http://jsfiddle.net/fFMt2/1/)，其中有一组 20 个盒子。[我使用来自http://daneden.me/animate](http://daneden.me/animate)的动画 css 插件。

我想做的是按顺序为每个框设置动画，我的意思是一个接一个地为它们设置动画。

我不确定我缺少什么来让它们按顺序制作动画。

我似乎对 setTimeout 函数做错了什么

```
setTimeout(function(){
        $('.slider').append('<li><div class="box animated bounceInRight"></div></li>');
        },100); 
```

感谢有人可以帮我解决这个问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T21:24:52.200

您必须增加每个项目的延迟。

```
 setTimeout(function(){
    ...
 },100 * idx);
        --^-- 
```

**演示：http:** [//jsfiddle.net/fFMt2/2/](http://jsfiddle.net/fFMt2/2/)

# jquery - httpd.conf 和 HTML5 pushstate()

> ID：14034082
> 
> 赞同：5
> 
> 时间：2012-12-25T21:22:45.583
> 
> 标签：jquery, html, ajax, httpd.conf, pushstate

我正在运行一个支持 HTML4 哈希和 HTML5 pushstate() 的启用 AJAX 的站点。

我刚刚迁移到 AWS EC2 实例（运行 apache 的 Linux 服务器），两个站点都运行良好。

我遇到的唯一问题是当我刷新 HTML4 哈希页面时显示正确的页面。

但是，当我刷新像[http://www.datingjapan.co/conversations](http://www.datingjapan.co/conversations)这样的 HTML5 页面时，我收到以下错误消息：

![在此处输入图像描述](../Images/5e5dd89359c7fa639cf3dbc6c89185b3.png)

看来 apache 正试图进入文件夹“convertations”，而不是只调用站点“index.php”，然后使用 jquery 加载正确的页面。

任何人都可以建议这里可能是什么问题。我假设它是一个 httpd.conf 设置。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-25T21:55:09.573

如果您尝试将`index.php`文件用作某种类型的引导程序，您可能想在`.htaccess`文件中尝试此操作：

```
<IfModule mod_rewrite.c>
    RewriteEngine on
    RewriteCond %{HTTP_HOST} !^(www\.).+$ [NC]
    RewriteRule ^(.*)$ http://www.%1/$1 [R=301,L]

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-l
    RewriteRule ^(.*)$ index.php?/$1 [L]
</IfModule> 
```

基本上，这会将所有请求从非 www 重定向到 www，然后如果它不是文件或目录，它会将请求转发到`index.php`文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T21:39:56.227

我自己没用过`pushState()`，但如果浏览器`/conversations`向 www.datingjapan.co 发送请求，那么 Apache 确实会在其文档根目录中查找名为“conversations”的文件或文件夹，除非你告诉它做一些不同的事情.

如果您希望 www.datingjapan.co 上的所有 URL 都由一个 index.php 文件处理，那么您可以在 Apache 设置文件中使用[该`AliasMatch`指令：](http://httpd.apache.org/docs/2.2/mod/mod_alias.html#aliasmatch)

```
AliasMatch ^.*$ /index.php 
```

我*认为*这将导致所有 URL 都由 index.php 处理。（虽然我对 Apache 配置不是很感兴趣，所以我可能是错的。）

# android - 如何在 android 媒体播放器中播放 mms:// 链接

> ID：14034083
> 
> 赞同：4
> 
> 时间：2012-12-25T21:23:02.000
> 
> 标签：android, radio

我想在我的 android 应用程序中播放这台收音机：[http](http://www.voadeewaradio.com/) : //www.voadeewaradio.com/ 上面写着“LIVE AUDIO”

我查看了该页面的源代码，找到了播放收音机的链接，它的 .asx 格式：

```
 <a href="http://www.voanews.com/wm/live/radiodeewa.asx">Live Audio</a> 
```

我使用 Cocsoft StreamDown 将 .asx 格式更改为普通的 url:port，然后将被读取

```
player.setDataSource("mms://a1314.l211036239.c2110.g.lm.akamaistream.net/D/1314/2110/v0001/reflector:36239"); 
```

正如您所看到的，Cocsoft StreamDown 给了我上面的链接，当我将其粘贴到浏览器中时，它会在媒体播放器中打开收音机。虽然在 android 中这个链接不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T21:46:14.170

我对[http://vitamio.org](http://vitamio.org)软件很幸运。

我从他们的网站下载了 vitamio-Android-3.0.7z 并创建了一个测试项目，其中包含：

```
import io.vov.vitamio.MediaPlayer;

...
public class MainActivity extends Activity {

  private static final String TAG = "MainActivity";

  String mms_url = "mms://streaming.radionz.co.nz/national-mbr";

  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    if (!io.vov.vitamio.LibsChecker.checkVitamioLibs(this))
      return;

    Button button = new Button(this);
    button.setText("Hit me");
    setContentView(button);

    final MediaPlayer player = new MediaPlayer(MainActivity.this);

    button.setOnClickListener(new View.OnClickListener() {

      @Override
      public void onClick(View v) {
        Log.i(TAG, "playing a mms stream ...");
        try {
          player.setDataSource(mms_url);
          player.prepare();
          player.start();
        } catch (Exception e) {
          Log.e(TAG, e.getMessage(), e);
        }
      }
    });
  }
} 
```

我在基于 Android4.2 armeabi-v7a 的模拟器上对此进行了测试。

他们没有编译的演示应用程序是用于播放视频的。

这是我创建的演示应用程序：[https ://www.dropbox.com/s/u2ub1jwne3qjuxd/vitamio_mms_test.tar.bz2?n=127293939](https://www.dropbox.com/s/u2ub1jwne3qjuxd/vitamio_mms_test.tar.bz2?n=127293939)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T01:32:21.940

首先，无需将 URL 硬编码到您的应用程序中，只需读取`.asx`-file 并从中解析 URL，它是一种简单的 XML 格式。

这样，如果流 URL 发生变化，您就不需要更新您的应用程序。

* * *

对于彩信流的播放，[Android 的`MediaPlayer`](http://developer.android.com/guide/appendix/media-formats.html#network). 您需要第三方库来执行此操作：[Java library to read a Microsoft Media Server (MMS) stream](https://stackoverflow.com/q/207854/717341)

# php - php通过ajax从输入值发送数组

> ID：14034085
> 
> 赞同：1
> 
> 时间：2012-12-25T21:23:04.830
> 
> 标签：php, jquery

我正在保存这样的数组

```
<input type="hidden" value="Array ( [0] => cb_05 [1] => cb_06 [2] => cb_07 [3] => cb_08 [4] => cb_09 [5] => type ) " id="price_id" name="price_id"> 
```

我需要获取数组并通过 jquery 中的帖子发送它

```
var price_id = $("#price_id").val();

$.post("class.php",{price_id:price_id},function(data){

        alert(data);

    }); 
```

当我在课堂上执行 foreach 时，它不会将其视为数组，我认为这是因为它是作为字符串发送的，有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T21:39:36.100

您可以使用`data-`属性和 jQuery`data()`方法来处理数组

```
<anyElement id="price_id" data-priceArray="<?php echo json_encode($array) ?>"/>
<!-- will look like-->
<anyElement id="price_id" data-priceArray="["1","2","3","4"]"/> 
```

JS

```
var price_id = $("#price_id").data('priceArray');
/* is now a js array*/
  alert(price_id[3])

$.post("class.php",{price_id:price_id},function(data){
        alert(data);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T21:27:40.160

php 不会自动将来自 print_r() 的字符串识别为数组。您需要使用特定的函数将数组序列化为 php 可以识别的内容。`json_encode()`是一个很好的功能。

但是，`json_encode()`可能会产生一个字符串，其中包含引号和其他字符会破坏您的 html，因此我们需要使用不含此类字符的编码再次对其进行编码。我们`base64_encode()`为此使用。

```
<input type="hidden" value="<?=base64_encode(json_encode($source_array))?>" id="price_id" name="price_id"> 
```

稍后，当您收到 ajax 或表单帖子时

```
$reified_array = json_decode(base64_decode($_POST['price_id']));
foreach ($reified_array as $val) { ... } 
```

[json_decode](http://php.net/manual/en/function.json-decode.php)
[json_encode](http://php.net/manual/en/function.json-encode.php)
[base64_encode](http://php.net/manual/en/function.base64-encode.php)

# c++ - C++ 算法循环 - 并行处理？

> ID：14034087
> 
> 赞同：3
> 
> 时间：2012-12-25T21:23:13.890
> 
> 标签：c++, parallel-processing

我一直在尝试对我用 C++ 编写的素数生成器的多线程进行一些研究，我发现我想要做的就是所谓的“并行处理”。在过去的大约 45 分钟里，我一直在研究这个问题，但我似乎无法弄清楚。

我要执行此操作的代码大约有 95 行，这太长了，无法在此处发布，但这是基本概念：

```
unsigned long long i, total;

for(i;true;i++){
    total = total + i;
    cout << "Your new total is " << total << endl;
} 
```

有什么办法可以将它流式传输到 2 个处理器，以便它们一起工作而不是竞争？如果是这样，我将如何编码？我对 C++ 有点熟悉，但还有很多我不知道的地方，因此非常感谢您提供深入的回答。

**编辑：**第一次使用错误的算法。我觉得这就是。

**编辑 2：**由于很多答案都说这取决于我的算法，所以我将发布我的代码，因为它只有 95 行。

```
/*Generic GPL stuff, coded by me */

#include <iostream>
#include <list>
#include <fstream>
using namespace std;

int main(){
    //Declare some variables and what not.
    unsigned long long count = 0, misc = 0, length = 0, limit = 0;
    list <long long> primes;
    ifstream inFile;
    ofstream outFile;

    cout << "Initializing starting values based on your existing file of generated prime numbers.\n";

    //Now let's get our starting values;
    inFile.open("/home/user/Desktop/primes.txt");

    //First, we need to find the prime generator thus far
    for(unsigned long long x=0;inFile.good();x++){
        inFile >> count;

        if(!(bool)(x%100000000) && x!=0){
            misc = x/100000000;

            cout << misc << "00000000 primes read so far...\n";
        }
    }

    inFile.close();

    cout << "Highest generated prime found.\n";

    //Now, as much as I hate to say it, we need to parse part of the file again now that we have the largest prime.
    inFile.open("/media/ssd/primes_src.txt");

    for(length; limit < count; length++){
        inFile >> misc;
    }

    inFile.close();

    limit = misc * misc;

    cout << "Initialization complete. Now generating primes.\n";

    //Loop time
    l:

    //We're just going to flat-out skip even numbers
    count++;
    count++;

    //This checks to see if the number it's trying to test is beyond the current limit of accuracy.
    if(count >= limit){

        // Now if we are, we have 1 more possible prime factor
        length++;

        inFile.open("/media/ssd/primes_src.txt");

        for(unsigned long long x=0; x < length; x++){
            inFile >> misc;
        }

        inFile.close();

        limit = misc * misc;
    }

    inFile.open("/media/ssd/primes_src.txt");
    inFile >> misc; //We don't care about 2

    for(unsigned long long x=1; x < length; x++){
        inFile >> misc;

        if(!(bool)(count%misc)){
            inFile.close();

            goto l;
        }
    }

    inFile.close();

    outFile.open("/home/user/Desktop/primes.txt", ios::out | ios::app);

    //Now if we haven't been "goto"d, we add it to the file.
    outFile << count << endl;

    outFile.close();

    goto l;

    return 0;
} 
```

/home/user/Desktop/primes.txt 是我保存所有生成的素数的文件。
/media/ssd/primes_src.txt 是我的文件，其中包含高达 2^32 的所有素数加上 1 个素数，以供良好测量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T21:31:17.397

假设`i = iterator`，显示的代码确实使得 的值`total`不依赖于 for 循环的先前迭代。您的算法似乎无需太多努力即可并行化。

最简单的方法是在编译器选项中启用[OpenMP](http://en.wikipedia.org/wiki/OpenMP)，然后在 for 循环之前添加以下代码：

```
#pragma omp parallel for
for(...) 
```

请注意，此答案假定您的算法的每次迭代都不依赖于前一次迭代（否则您将不得不输入一些代码以防止竞争条件）。

**编辑**：您的算法现在不容易并行化。一些注意事项：

*   如果您可以将计算划分为独立的块，那么该算法很容易并行化（每个块一个线程）
*   如果算法在*不修改旧数据的情况下**创建*新数据，并且不读取新数据的状态，那么它也是可并行化的
**   如果你必须有迭代的结果`n - 1`才能进行迭代`n`，那么你就完蛋了。这里最好的选择是拿一张纸和一支铅笔，并在数学上（或逻辑上）尝试以不同的方式格式化你的算法（即，改变你的算法！）。*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T21:40:48.083

我不知道您的算法是否适合这种方法，但我完成并行工作的一种方法是创建多个线程，它们都完全独立运行，除了一个更新“下一个候选者”的点（我正在计算奇怪的数字，所以我的更新是`i = __sync_fetch_and_add(&current, 2);`“目前为止的数字处理”。 __sync_fetch_and_add() 是 g++ 中的标准函数，但微软编译器有同样的东西，称为`InterLockedAdd()`.

当我运行我的“基准”时，我的机器上的 4 个内核（100% = 1 个内核）只比 400% 的改进少了一点点。

我使用了普通的 pthread_create()，当我从输入达到给定范围内的“最大值”时，每个线程都会结束。

正如所承诺的：一个简单的素数查找器：

```
#include <iostream>
#include <cstring>
#include <cstdlib>
#include <pthread.h>

using namespace std;

static int current;
static int max_value = 7780;

static void *find_prime(void *)
{
    for(;;)
    {
        int i = __sync_fetch_and_add(&current, 2);
        bool prime = true;

        if (i > max_value)
        {
            pthread_exit(NULL);
        }
        for(int j = 2; j < i && prime; j++)
        {
            if (!(i % j))
            {
                prime = false;
            }
        }
        if (prime)
        {
            cout << i << " " << flush;
        }
    }
}

int main(int argc, char **argv)
{
    int    start = 3;
    int    threads = 1;
    pthread_t *thread_id;

    for(int i = 1; i < argc; i++)
    {
        if (strcmp(argv[i], "-t") == 0 && argc > i+1)
        {
            i++;
            threads = strtol(argv[i], NULL, 0);
        }
        if (strcmp(argv[i], "-e") == 0 && argc > i+1)
        {
            i++;
            max_value = strtol(argv[i], NULL, 0);
        }
    }

    current = start;

    cout << "1 2 " << flush;

    thread_id = new pthread_t[threads-1];
    for(int i = 0; i < threads; i++)
    {
        int rc = pthread_create(&thread_id[i], NULL, find_prime, NULL);
        if (rc != 0)
        {
            cerr << "Huh? Pthread couldn't be created. rc=" << rc << endl;
        }
    }
    for(int i = 0; i < threads; i++)
    {
        pthread_join(thread_id[i], NULL);
    }
    cout << endl;
} 
```

评论：主要启动“线程”线程数（`-t num`在命令行上指定 - 还有一个`-e num`定义“最大值”）。每个线程使用 __sync_fetch_and_add() 函数“挑选”一个数字。线程检查它是否是素数，然后迭代 j 以尝试除数。如果数字是素数，则打印，否则只需选择下一个数字。

如果您愿意，而不是打印数字[并且给定足够大的数字，您可能会遇到`cout <<`从线程内调用的问题]，您可以使用数组，并使用 int my_index = __sync_fetch_and_add(&index, 1); 并用它来存储到一个数组中。

自然地，如果每个循环不能完全独立运行，这种方法就不起作用——那么事情就会变得更加复杂。

编辑：请注意，此代码中缺少许多有用的错误检查。如果你给零个线程，它不会做任何事情，如果你给一个负数的最终值，谁知道，等等。

$ 时间 ./prime -t 1 -e 100000 > /dev/null

```
real    0m5.574s
user    0m5.553s
sys     0m0.009s 
```

和：时间 ./prime -t 4 -e 100000 > /dev/null

```
real    0m1.762s
user    0m5.572s
sys     0m0.010s 
```

如您所见，它的速度几乎快了 4 倍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T22:19:14.117

您可以查看此[代码](http://people.sc.fsu.edu/~jburkardt/c_src/prime_openmp/prime_openmp.c)，该代码使用 openMP 计算素数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-25T21:43:59.810

并行化的唯一方法是跟踪 N 个总数，并在循环后将它们加在一起。或者，如果添加代表一些更复杂的功能，请尝试使用互斥锁来访问共享变量。不过，这很可能在性能方面很糟糕......*

# python - Python最后一场比赛

> ID：14034089
> 
> 赞同：0
> 
> 时间：2012-12-25T21:23:52.193
> 
> 标签：python, regex

如何获取以下字符串中的“california”部分？

```
http://states.com/_states/united_states/50/california 
```

我正在尝试以下但不知道如何匹配最后一个 /。

```
match = re.search(r'\/(.*)$', state_url) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-25T21:32:44.777

你确定你需要正则表达式吗？下面的呢？

```
In [66]: url = 'http://states.com/_states/united_states/50/california'

In [67]: url.split('/')[-1]
Out[67]: 'california' 
```

但这当然取决于您是否总是想提取 URL 中的最后一个单词。我只是想提一下。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T21:25:55.383

采用

```
r'[^/]*$' 
```

它匹配任意数量的字符，除了`'/'`输入结束之前，或者理想情况下，对于 URL，

```
r'[^/#?]*(?:$|[#?])' 
```

它匹配 URL 路径部分中任意数量的非特殊字符，直到 input ( `$`) 的末尾或路径部分的末尾`[#?]`。这`(?:...)`只是一个不捕获内容的括号组。

* * *

[顺便说一句， RFC 3986](http://www.ietf.org/rfc/rfc3986.txt)的附录 B是使用正则表达式解析 URI 的一个很好的参考。

> # 附录 B. 使用正则表达式解析 URI 引用
> 
> 由于“first-match-wins”算法与 POSIX 正则表达式使用的“贪婪”消歧方法相同，因此使用正则表达式来解析 URI 引用的潜在五个组成部分是很自然且司空见惯的。
> 
> 以下行是将格式良好的 URI 引用分解为其组件的正则表达式。
> 
> ```
>  ^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?
>   12            3  4          5       6  7        8 9 
> ```
> 
> ...

# templates - 编译 angularjs 模板以显示在通知上

> ID：14034091
> 
> 赞同：2
> 
> 时间：2012-12-25T21:23:57.873
> 
> 标签：templates, compilation, notifications, angularjs, growl

我想在我的 angularjs 项目中使用这个库（ [http://pinesframework.org/pnotify/ ）](http://pinesframework.org/pnotify/)

在这里显示错误通知是一个简单的用法：

```
 $.pnotify({
        title: 'Oh No!',
        text: text OR HTML,
        type: 'error'
    }); 
```

我想要的是在通知中显示我收到的 JSON 错误，但我无法在此通知中添加带有角度标签的 html。

这就是我试图做的（我从服务调用它，我将 $scope 传递给函数）：

```
 scope.errors = {"errors":[{"text":"error1"},{"text":"error2"}]};
        var htmlTemplate = '<p ng-repeat = "error in errors.errors">{{error.text}}</p>';
        var result = $compile(htmlTemplate)(scope); 
```

然后

```
 $.pnotify({title: title,
        text: result,
        type: 'error',
    }); 
```

但通知只是显示`[object Object]`

如果我尝试将它添加到这样的 div 中，它可以正常工作

```
 result.appendTo($("#someDiv")); 
```

我试图解决它，但对我没有任何效果，我想从 angularjs 方面解决它，而不是通过为我的案例更改库。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T21:36:58.330

我想出的解决方案涉及在 pnotify 将模板添加到 DOM 之后对模板进行 $compile()。为了在 pnotify 添加它之后找出它在 DOM 中的位置，我使用该`addClass`参数添加了一个名为`myClazz`. 然后我使用 jQuery 选择器找到它：

```
var htmlTemplate = '<p ng-repeat = "error in errors.errors">{{error.text}}</p>';
$.pnotify({
    title: 'title',
    text: htmlTemplate,
    type: 'error',
    addclass: 'myClazz'
});
// now that htmlTemplate has been added to the DOM, $compile it
var element = $('.myClazz');
$compile(element)(scope); 
```

[小提琴](http://jsfiddle.net/mrajcok/zGxUt/)

请注意，DOM 操作实际上应该在指令中完成，而不是在服务中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:52:14.723

在查看您的 jsfiddle 之后：jsfiddle.net/bh6kX/19 在我们得到答案之前我有一些评论。

compile 函数不返回 html，它返回一个链接函数，用于将模板（DOM 元素/树）绑定到范围[docs](http://docs.angularjs.org/api/ng.%24compile)。您也不需要编译任何东西，因为它看起来像 pnotify （我没有经验）将直接文本作为参数。因此，在遍历您的错误变量之后，我将其缩短为：

```
var errors = [{"text":"error1"},{"text":"error2"}]; 
```

只是将文本连接在一起，我将它传递给 ptnoify 并且它起作用了。样式不存在，但我感觉这只是 jsfiddle 不喜欢 css。

**小提琴**：http: [//jsfiddle.net/rtCP3/36/](http://jsfiddle.net/rtCP3/36/)

# java - Java RMI，找不到存根类，java.rmi.ServerException：RemoteException发生在服务器线程中；

> ID：14034092
> 
> 赞同：0
> 
> 时间：2012-12-25T21:24:26.953
> 
> 标签：java, client-server, rmi, stub

我正在尝试运行我的 rmi 程序。但是它似乎找不到我的存根类。我执行成功启动的命令'start rmiregistry'。然后在做之后：

```
java -classpath . -Djava.security.policy=AllSecurity.policy RMIAuctionManagerImpl 
```

我收到以下错误：

```
Failed to register object java.rmi.ServerException: RemoteException occurred in
server thread; nested exception is:
    java.rmi.UnmarshalException: error unmarshalling arguments; nested excep
tion is:
    java.lang.ClassNotFoundException: RMIAuctionManagerImpl_Stub
java.rmi.ServerException: RemoteException occurred in server thread; nested exce
ption is:
    java.rmi.UnmarshalException: error unmarshalling arguments; nested excep
tion is:
    java.lang.ClassNotFoundException: RMIAuctionManagerImpl_Stub
    at sun.rmi.server.UnicastServerRef.oldDispatch(UnicastServerRef.java:419
)
    at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:267)
    at sun.rmi.transport.Transport$1.run(Transport.java:177)
    at sun.rmi.transport.Transport$1.run(Transport.java:174)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.rmi.transport.Transport.serviceCall(Transport.java:173)
    at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:5
53)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTranspor
t.java:808)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport
.java:667)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.
java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor
.java:603)
    at java.lang.Thread.run(Thread.java:722)
    at sun.rmi.transport.StreamRemoteCall.exceptionReceivedFromServer(Stream
 RemoteCall.java:273)
    at sun.rmi.transport.StreamRemoteCall.executeCall(StreamRemoteCall.java:
 251)
    at sun.rmi.server.UnicastRef.invoke(UnicastRef.java:377)
    at sun.rmi.registry.RegistryImpl_Stub.rebind(Unknown Source)
    at java.rmi.Naming.rebind(Naming.java:177)
    at RMIAuctionManagerImpl.main(RMIAuctionManagerImpl.java:133)
Caused by: java.rmi.UnmarshalException: error unmarshalling arguments; nested ex
ception is:
    java.lang.ClassNotFoundException: RMIAuctionManagerImpl_Stub
    at sun.rmi.registry.RegistryImpl_Skel.dispatch(Unknown Source)
    at sun.rmi.server.UnicastServerRef.oldDispatch(UnicastServerRef.java:409
)
    at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:267)
    at sun.rmi.transport.Transport$1.run(Transport.java:177)
    at sun.rmi.transport.Transport$1.run(Transport.java:174)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.rmi.transport.Transport.serviceCall(Transport.java:173)
    at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:5
53)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTranspor
t.java:808)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport
.java:667)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.
java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor
.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.ClassNotFoundException: RMIAuctionManagerImpl_Stub
    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:264)
    at sun.rmi.server.LoaderHandler.loadClass(LoaderHandler.java:453)
    at sun.rmi.server.LoaderHandler.loadClass(LoaderHandler.java:184)
    at java.rmi.server.RMIClassLoader$2.loadClass(RMIClassLoader.java:637)
    at java.rmi.server.RMIClassLoader.loadClass(RMIClassLoader.java:264)
    at sun.rmi.server.MarshalInputStream.resolveClass(MarshalInputStream.jav
a:216)
    at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:159
3)
    at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1514)
    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1
750)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1347)
    at java.io.ObjectInputStream.readObject(ObjectInputStream.java:369)
    ... 13 more 
```

我在不同的计算机上已经厌倦了这个，我没有遇到这个问题，它似乎只是发生在我的笔记本电脑上，我的环境变量有问题吗？我检查了我的环境变量和我厌倦了运行它的另一台 PC 相同的位置。

这是我的课程的代码：

```
import java.io.Serializable;
import java.util.ArrayList;
import java.rmi.*;
import java.rmi.server.*;
import java.sql.*;

public class RMIAuctionManagerImpl extends UnicastRemoteObject implements          RMIAuctionManager, Serializable {

protected ArrayList<RMIAuctionItem> itemList ;
protected ArrayList<RMIBidder> bidderList;

public RMIAuctionManagerImpl() throws RemoteException
{
    itemList= new ArrayList<RMIAuctionItem>();
    bidderList=new ArrayList<RMIBidder>();
}

public ArrayList<RMIBidder> getBidders() throws RemoteException
{
    return bidderList;
}

public ArrayList<RMIAuctionItem> getItems() throws RemoteException
{
    return itemList;
}

public RMIAuctionItem findItem(String itemName) throws RemoteException
{
    for(int i =0; i<itemList.size();i++)
    {
        if(itemList.get(i).getName()==itemName)
        {
            return itemList.get(i);
        }
    }
    return null;    
}
public void add(RMIBidder aBidder) throws RemoteException
{
    bidderList.add(aBidder);
}
public void sendMessageToServer(RMIAuctionItem aItem, RMIBidder aBidder, double theMessage) throws RemoteException
{
    Connection conn =null;
    PreparedStatement prestmt = null;

    try {
        Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
    } catch (ClassNotFoundException e) {
        System.out.println("Driver Not Found");
            e.printStackTrace();
    }

     try {

         conn = DriverManager.getConnection("jdbc:odbc:RMIAuctionHouseDB");

    } catch (SQLException e) {
        System.out.println("Connection Not Found");
        e.printStackTrace();
    }

     try {
            String insertSQL = "Insert into RMIAuctionHouse (ItemName, ClientName, BidAmount) VALUES (?,?,?)";
            prestmt = conn.prepareStatement(insertSQL);
            prestmt.setString(1, aItem.getName());
            prestmt.setString(2, aBidder.getName());
            prestmt.setDouble(3, theMessage);

        } catch (SQLException e1) {
            System.out.println("Statement Not Found");
            e1.printStackTrace();
        }

         try {
             prestmt.executeUpdate();
        } catch (SQLException e) {
            System.out.println("Sql Query Not Found");
            e.printStackTrace();
        }

        try {
            prestmt.close();
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }

        aItem.makeBid(aBidder, theMessage);
}

public void joinBidding(RMIBidder aBidder,RMIAuctionItem aItem) throws RemoteException
{
    System.out.println("Bound Client: "+ aBidder.getName()+ " to "+ aItem.getName());
    aItem.joinBidding(aBidder);
}

public void setItems() throws RemoteException
{
    RMIAuctionItem aItem=new RMIAuctionItemImpl();
    aItem.setName("Ps3");
    aItem.setPrice(200);
    RMIAuctionItem aItem2= new RMIAuctionItemImpl();
    aItem2.setName("Macbook");
    aItem2.setPrice(500);
    RMIAuctionItem aItem3=new RMIAuctionItemImpl();
    aItem3.setName("HTC Desire HD");
    aItem3.setPrice(100);
    itemList.add(aItem);
    itemList.add(aItem2);
    itemList.add(aItem3);
}

public void deleteItems() throws RemoteException
{
    for(int i=0; i<itemList.size();i++)
    {
        itemList.remove(itemList.get(i));
    }
}

public static void main (String[] args)
{
    try{
        RMIAuctionManager myRMIAuctionManager=new RMIAuctionManagerImpl();

        Naming.rebind("RMIAuctionServer", myRMIAuctionManager);

        //myRMIAuctionManager.deleteItems();
        //myRMIAuctionManager.setItems();

        System.out.println("Remote object bound to registry");
    }
    catch( Exception e){

        System.out.println("Failed to register object " + e);
        e.printStackTrace();
        System.exit(1);

 }
}
   } 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-06-29T14:42:12.040

确保您`rmiregistry`从可以访问您的类的目录开始（bin/ 根文件夹，而不是包文件夹）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T08:33:33.277

*RMI 注册表*找不到该类。因此，您的笔记本电脑的注册表设置存在一些差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T23:10:55.827

这听起来像一个类路径问题。我要做的是在代码启动时打印出代码中的 java 类路径。然后比较不同机器上使用的类路径。其他计算机可能有一个类路径，其中包含您的程序在您的 PC 上寻找的缺少的类或 jar 文件。

[Java 技巧 - 如何打印类路径](http://www.java-tips.org/java-se-tips/java.lang/how-to-print-classpath.html)

# ios - 像 Xcode 调试器窗口一样滚动 UITextView

> ID：14034097
> 
> 赞同：2
> 
> 时间：2012-12-25T21:24:57.403
> 
> 标签：ios, scroll, uitextview

我有一个 UITextView 将在事件发生时添加行，作为一种日志来显示正在发生的事情。我希望它像 Xcode 中的调试器窗口一样运行。新行出现在底部，随着新文本的添加，文本会自动向上滚动。我只需要存储实际显示的文本，因此清除离开 textView 的文本也很好。

在查看文档时，我看到了一种滚动到顶部但不滚动到底部的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T21:29:35.027

您可以使用`UIScrollView`'s `scrollRangeToVisible`：

```
CGPoint p = [helpText contentOffset]; 
[helpText setContentOffset:p animated:NO];
[scrollView scrollRangeToVisible:NSMakeRange([scrollView.text length] - 1, 0)]; 
```

# java - 如何在 Java 中使用 Mutex 解决餐饮哲学家的问题？

> ID：14034099
> 
> 赞同：-1
> 
> 时间：2012-12-25T21:25:47.617
> 
> 标签：java, mutex, dining-philosopher

我的 java 项目有 3 个 java 类。有 Main、Philosoper 和 chStick。我使用布尔值 isTaken 解决了餐饮哲学家问题。

在项目 chStick.java 中，如下所示。此类控制筷子在使用或不使用。

```
class ChStick
{
   private int id;
   private boolean isTaken;

   ChStick (int id)
   {  
       this.id=id;
   }

   synchronized void get () throws InterruptedException
   {
       while(isTaken){
          wait();
       }

       isTaken=true;
   }

   int getID ()
   {
       return id;
   }

   synchronized void put () throws InterruptedException
   {
      isTaken=false;
   }
} 
```

此代码成功运行。当我使用信号量而不是布尔值 isTaken 时，它也成功运行。

我的问题是使用 Mutex 重写这个类。我尝试了很多方法，但仍然没有奏效。它必须使用 Mutex 类。

编辑：

```
class Philos extends Thread// #9 - Make this class to be inherited from Thread class
{
   private String name;
   private ChStick left, right;

   Philos (String name, ChStick left, ChStick right)
   {
     // #10 - Assign this philosopher a name, his left and rigt chopsticks.
       this.left=left;
       this.right=right;
       this.name=name;
   }

    @Override
   public void run ()
   {
       while (true)
       {
          try
          {
              System.out.println ("Philosopher " + name + " is thinking.");

              // #11 - Make philosopher sleep for a RANDOM time.
              Thread.sleep(1000);

              System.out.println ("Philosopher " + name + " is hungry.");

              if (left.getID () < right.getID ())
              {
                  System.out.println ("Philosopher " + name +
                                      " getting left ChStick.");

            // #12 - Make philosopher to get left chopstick.
                  left.get();

                  System.out.println ("Philosopher " + name +
                                      " got left ChStick."+left.getID());
              }
              else
              {
                  System.out.println ("Philosopher " + name +
                                      " getting right ChStick.");

                  // #13 - Make philosopher to get right chopstick.
                  right.get();

                  System.out.println ("Philosopher " + name +
                                      " got right ChStick."+right.getID());
              }

              // Get other ChStick.

              if (left.getID () < right.getID ())
              {
                  System.out.println ("Philosopher " + name +
                                      " getting right ChStick.");

            // #14 - Make philosopher to get (left or right)? chopstick.
                  right.get();

                  System.out.println ("Philosopher " + name +
                                      " got right ChStick."+right.getID());
              }
              else
              {
                  System.out.println ("Philosopher " + name +
                                      " getting left ChStick.");

                  // #15 - Make philosopher to get (left or right)? chopstick.
                  left.get();

                  System.out.println ("Philosopher " + name +
                                      " got left ChStick."+left.getID());
              }

              System.out.println ("Philosopher " + name + " is eating.");

              // #16 - Make philosopher sleep for a RANDOM time.
              Thread.sleep(2000);

              // #17 - Make philosopher to put the left chopstick down.

              System.out.println ("Philosopher " + name +
                                  " putting down left ChStick."+left.getID());
              left.put();

              // #17 - Make philosopher to put the right chopstick down.

              System.out.println ("Philosopher " + name +
                                  " putting down right ChStick."+right.getID());
              right.put();
          } 
          catch (InterruptedException e) {}
       }
   }
}

public class Main
{
   public static void main (String [] args)
   {                                                 

    // #1 - Here you should create chopstick instances 
    //      and number them using the structure defined in its class definition. 

    // ChStick cs1 = new ChStick ..
       ChStick cs1 = new ChStick(1);
       ChStick cs2 = new ChStick(2);
       ChStick cs3 = new ChStick(3);
       ChStick cs4 = new ChStick(4);
       ChStick cs5 = new ChStick(5);

    // #2 - Here you should create Philosopher instances
    //      and assign them names, their right and left chopsticks.
    //      BE CAREFUL IN WHICH ORDER THEY SIT AROUND THE TABLE 

    // Philos p1 = new Philos ("P1"...)
      Philos p1 = new Philos("P1",cs1,cs5);
      Philos p2 = new Philos("P2",cs2,cs1);
      Philos p3 = new Philos("P3",cs3,cs2);
      Philos p4 = new Philos("P4",cs4,cs3); 
      Philos p5 = new Philos("P5",cs5,cs4);

    // #3 - Start p
      p1.start();
      p2.start();
      p3.start();
      p4.start();
      p5.start();
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T22:00:02.997

我想您正在寻找的是对[Conductor 解决方案](http://en.wikipedia.org/wiki/Dining_philosophers_problem#Conductor_solution)的变体。

您的互斥体将充当导体，但一次只允许一位哲学家拿叉子吃饭。

因此，任何 phislopher 线程都将等待`acquire()`互斥锁上的成功，然后使用叉子，因为没有其他哲学家在用餐，所以叉子必须可用。然后吃饭，放下叉子，然后调用`release()`互斥体。

# c++ - 使用 ID3DXEffect->SetTexture 取消绑定纹理

> ID：14034101
> 
> 赞同：1
> 
> 时间：2012-12-25T21:25:59.020
> 
> 标签：c++, directx-9, d3dx

在使用 FX 框架将纹理绑定到使用 FX 框架的采样器时，我遇到了一些问题：

```
ID3DXEffect->SetTexture(FXShadowtex,Lights->sunlight->ShadowTex) 
```

一旦该纹理绑定到采样器，我就不能再次渲染它（比如说，当太阳改变位置时）。当我这样做时，会出现以下错误：

> Direct3D9：（警告）：无法渲染到也用作纹理的渲染目标。渲染目标被检测为绑定，但无法检测纹理是否实际用于渲染。

但是，我不知道如何使用 FX 框架或其他任何可靠的方法“取消设置”纹理。我尝试了几件事：

*   **ID3DXEffect->SetTexture(FXShadowtex,NULL)。**这会导致崩溃。
*   **ID3DXEffect->SetTexture(FXShadowtex,SomeDummy)。**这真的很丑。
*   编译后找出与fx文件中定义的采样器对应的采样器索引，并将其设置为NULL：**IDirect3DDevice9->SetTexture(i,NULL)**。这显然不是很实用。
*   忘记警告。由于无休止的垃圾邮件，这使得 D3D 调试输出毫无用处，而且非常难看。
*   在进行任何渲染之前，从零循环到 fx 文件中定义的采样器数量，并将它们全部设置为 NULL。这也太丑了。

还有其他我忘记的方法吗？解释为什么上述任何“解决方案”都是必要的邪恶也很好。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:46:21.703

找出哪个纹理单元绑定到该采样器制服（请参阅 msdn 上的 ID3DXEffect 类），然后简单地使用 IDirect3DDevice9::SetTexture() 取消设置纹理。

我认为这个解决方案在这种情况下是最不难看的。但是，您始终可以编写自己的效果类（顺便说一句，这非常简单）。

使用例如[D3DXCompileShaderFromFile](http://m.cdn.blog.hu/da/darthasylum/temp/ed1.jpg)然后您可以遍历返回的常量表并使用[IDirect3DDevice9::SetPixelShaderConstantF](http://msdn.microsoft.com/en-us/library/windows/desktop/bb174452%28v=vs.85%29.aspx)设置统一值。请注意，在这种情况下，矩阵被设置为列优先（这意味着您必须在着色器中从左侧乘以向量）。一个有效的解决方案是为常量分配一个连续的空间并在一次调用中设置它们。

# javascript - JavaScript setInterval() 方法会导致内存泄漏吗？

> ID：14034107
> 
> 赞同：69
> 
> 时间：2012-12-25T21:27:11.300
> 
> 标签：javascript, memory-leaks, setinterval

目前正在开发一个基于 JavaScript 的动画项目。

我注意到，正确使用`setInterval()`，`setTimeout()`甚至`requestAnimationFrame`在没有我的请求的情况下分配内存，并导致频繁的垃圾收集调用。更多 GC 调用 = 闪烁 :-(

例如; 当我通过在 Google Chrome 中调用 init() 来执行以下**简单代码**时，内存分配 + 垃圾收集在前 20-30 秒内都很好......

```
function init()
{
    var ref = window.setInterval(function() { draw(); }, 50);
}

function draw()
{
    return true
} 
```

不知何故，在一分钟左右的时间内，分配的内存开始出现奇怪的增加！由于 init() 只被调用一次，**分配内存大小增加的原因是什么？**

**（编辑：chrome截图上传）**

![铬截图](../Images/253f840de31560ac0708c878d2b6ee96.png)

注意 #1：是的，我尝试在下一个 setInterval() 之前调用 clearInterval()。问题依旧！

注意＃2：为了隔离问题，我保持上面的代码简单而愚蠢。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-12-25T22:14:08.673

编辑：[尤里的回答](https://stackoverflow.com/a/14851513/854025)更好。

* * *

**tl; dr IMO 没有内存泄漏。正斜率只是 setInterval 和 setTimeout 的效果。垃圾被收集，如锯齿模式所见，这意味着根据定义没有内存泄漏。（我认为）。**

我不确定有没有办法解决这个所谓的“内存泄漏”。在这种情况下，“内存泄漏”是指对 setInterval 函数的每次调用都会增加内存使用量，如内存分析器中的正斜率所示。

现实情况是没有实际的内存泄漏：垃圾收集器仍然能够收集内存。根据定义，内存泄漏“发生在计算机程序获取内存但未能将其释放回操作系统时”。

如下面的内存配置文件所示，没有发生内存泄漏。每个函数调用都会增加内存使用量。OP 预计，因为这是一遍又一遍地调用同一个函数，所以不应该增加内存。然而，这种情况并非如此。每个函数调用都会消耗内存。最终，垃圾被收集起来，形成锯齿图案。

我已经探索了几种重新排列间隔的方法，它们都导致相同的锯齿模式（尽管一些尝试导致垃圾收集永远不会发生，因为引用被保留）。

```
function doIt() {
    console.log("hai")
}

function a() {
    doIt();
    setTimeout(b, 50);
}
function b() {
    doIt();
    setTimeout(a, 50);
}

a(); 
```

[http://fiddle.jshell.net/QNRSK/14/](http://fiddle.jshell.net/QNRSK/14/) ![](../Images/44d36697687cbddd28b5f78274f709f5.png)

```
function b() {
    var a = setInterval(function() {
        console.log("Hello");
        clearInterval(a);
        b();                
    }, 50);
}
b(); 
```

[http://fiddle.jshell.net/QNRSK/17/](http://fiddle.jshell.net/QNRSK/17/) ![](../Images/683c830947a5306ce131c0bb60a1e4a8.png)

```
function init()
{
    var ref = window.setInterval(function() { draw(); }, 50);
}
function draw()
{
    console.log('Hello');
}
init(); 
```

[http://fiddle.jshell.net/QNRSK/20/](http://fiddle.jshell.net/QNRSK/20/) ![](../Images/f7cdd1e97db7b486c0aa356cc4dc7850.png)

```
function init()
{
    window.ref = window.setInterval(function() { draw(); }, 50);
}
function draw()
{
    console.log('Hello');
    clearInterval(window.ref);
    init();
}
init();​ 
```

[http://fiddle.jshell.net/QNRSK/21/](http://fiddle.jshell.net/QNRSK/21/) ![](../Images/58f8e7064d6113594b7eb110b0c90b39.png)

显然`setTimeout`并且`setInterval`不是 Javascript 的正式部分（因此它们不是 v8 的一部分）。实施留给实施者。我建议你看看[node.js 中 setInterval 等的实现](https://github.com/joyent/node/blob/0f503cf0de8d43d1f4218dea25534a1cfac88266/lib/timers.js#L215-306)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-02-13T10:34:06.073

这里的问题不在于代码本身，它没有泄漏。这是因为时间轴面板的实现方式。当 Timeline 记录事件时，我们会在每次调用 setInterval 回调时收集 JavaScript 堆栈跟踪。堆栈跟踪首先在 JS 堆中分配，然后复制到本机数据结构中，堆栈跟踪复制到本机事件后，它成为 JS 堆中的垃圾。这反映在图表上。禁用以下调用[http://trac.webkit.org/browser/trunk/Source/WebCore/inspector/TimelineRecordFactory.cpp#L55](http://trac.webkit.org/browser/trunk/Source/WebCore/inspector/TimelineRecordFactory.cpp#L55)使内存图平坦。

有一个与此问题相关的错误：[https ://code.google.com/p/chromium/issues/detail?id=120186](https://code.google.com/p/chromium/issues/detail?id=120186)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-02-12T18:11:19.137

每次进行函数调用时，它都会创建一个[堆栈帧](http://en.wikipedia.org/wiki/Stack_frame#Structure)。与许多其他语言不同，Javascript 将堆栈帧存储在堆上，就像其他所有语言一样。这意味着每次调用一个函数（每 50 毫秒执行一次）时，都会将一个新的堆栈帧添加到堆中。这加起来并最终被垃圾收集。

考虑到 Javascript 的工作原理，这有点不可避免。唯一可以真正减轻它的方法是使堆栈帧尽可能小，我相信所有的实现都会这样做。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-02-12T19:40:44.433

我想回复您关于 setInterval 和闪烁的评论：

> 我注意到，正确使用 setInterval()、setTimeout() 甚至 requestAnimationFrame 会在没有我请求的情况下分配内存，并导致频繁的垃圾收集调用。更多 GC 调用 = 闪烁 :-(

您可能想尝试用基于 setTimeout的*不那么邪恶的自调用函数替换 setInterval 调用。*Paul Irish 在名为“我从 jQuery 源代码中学到的 10 件事”的演讲中提到了这一点（视频[在这里](http://paulirish.com/2010/10-things-i-learned-from-the-jquery-source/)，注释[在这里](http://ifiona2012.wordpress.com/2012/09/28/learn-jquery-source-codes-with-paul-irish/)见 #2）。您所做的是将您对 setInterval 的调用替换为一个函数，该函数**在完成应做的工作后**通过 setTimeout 间接调用自身。引用谈话内容：

> 许多人认为 setInterval 是一个邪恶的函数。无论函数是否完成，它都会以指定的时间间隔继续调用函数。

使用上面的示例代码，您可以从以下位置更新您的 init 函数：

```
function init() 
{
    var ref = window.setInterval(function() { draw(); }, 50);
} 
```

至：

```
function init()
{
     //init stuff

     //awesome code

     //start rendering
     drawLoop();
}

function drawLoop()
{
   //do work
   draw();

   //queue more work
   setTimeout(drawLoop, 50);
} 
```

这应该会有所帮助，因为：

1.  在完成之前，您的渲染循环不会再次调用 draw()
2.  正如上述许多答案所指出的那样，来自 setInterval 的所有不间断函数调用都会给浏览器带来开销。
3.  调试会更容易一些，因为您不会被 setInterval 的持续触发所打断

希望这可以帮助！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-25T22:44:46.563

Chrome 几乎没有看到您的程序有任何内存压力（按照今天的标准，1.23 MB 的内存使用率非常低），因此它可能不认为它需要积极地进行 GC。如果您修改程序以使用更多内存，您将看到垃圾收集器启动。例如试试这个：

```
<!html>
<html>
<head>
<title>Where goes memory?</title>
</head>
<body>

Greetings!

<script>
function init()
{
    var ref = window.setInterval(function() { draw(); }, 50);
}

function draw()
{
    var ar = new Array();
    for (var i = 0; i < 1e6; ++i) {
        ar.push(Math.rand());
    }
    return true
}

init();
</script>

</body>
</html> 
```

当我运行这个时，我得到了一个锯齿形的内存使用模式，峰值在 13.5MB 左右（同样，按照今天的标准来说相当小）。

PS：我的浏览器的细节：

```
Google Chrome   23.0.1271.101 (Official Build 172594)
OS  Mac OS X
WebKit  537.11 (@136278)
JavaScript  V8 3.13.7.5
Flash   11.5.31.5
User Agent  Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.101 Safari/537.11 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-02-12T16:35:37.187

尝试在没有匿名函数的情况下执行此操作。例如：

```
function draw()
{
    return true;
}

function init()
{
    var ref = window.setInterval(draw, 50);
} 
```

它的行为仍然相同吗？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-02-12T16:46:24.390

似乎没有内存泄漏。只要 GC 后内存使用量再次下降，并且总体内存使用量没有平均上升趋势，就没有泄漏。

我在这里看到的“真正”问题是`setInterval`确实使用内存来操作，而且看起来它不应该分配任何东西。实际上它需要分配一些东西：

1.  它将需要分配一些堆栈空间来执行匿名函数和 draw() 例程。
2.  我不知道是否需要分配任何临时数据来自己执行调用（可能不需要）
3.  它需要分配少量存储空间来保存`true`来自`draw()`.
4.  在内部，setInterval 可能会分配额外的内存来重新安排重复发生的事件（我不知道它在内部是如何工作的，它可能会重复使用现有的记录）。
5.  JIT 可能会尝试跟踪该方法，这将为跟踪和一些指标分配额外的存储空间。VM 可能会确定此方法太小而无法跟踪它，我不确切知道打开或关闭跟踪的所有阈值是多少。如果您运行此代码的时间足够长，以便 VM 将其识别为“热”，它可能会分配更多内存来保存 JIT 编译的机器代码（之后，我预计平均内存使用量会减少，因为生成的机器代码应该在大多数情况下分配更少的内存）

每次执行匿名函数时，都会分配一些内存。当这些分配加起来达到某个阈值时，GC 将启动并清理以使您回到基本水平。循环将继续如此，直到您将其关闭。这是预期的行为。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-11-17T16:45:22.223

我也有同样的问题。客户向我反映，其计算机的内存每次都在增加。起初我觉得一个网络应用程序可以做到这一点真的很奇怪，即使它是通过一个简单的浏览器访问的。我注意到这只发生在 Chrome 中。

但是，我开始与合作伙伴进行调查，通过 Chrome 的开发人员工具和管理器任务，我们可以看到客户端向我报告的内存增加。

然后我们看到一个 jquery 函数（请求动画帧）被一遍又一遍地加载，增加了系统内存。在那之后，感谢这篇文章，我们看到了一个 jquery 倒计时，因为它有一个“SETINTERVAL”，每次都在更新我的应用程序布局中的日期。

当我使用 ASP.NET MVC 时，我只是从 BundleConfig 和我的布局中退出了这个 jquery 脚本倒计时，用以下代码替换我的时间倒计时：

```
@(DateTime.Now.ToString("dd/MM/yyyy HH:mm")) 
```

# schema - 更改 DN openldap

> ID：14034109
> 
> 赞同：0
> 
> 时间：2012-12-25T21:27:33.200
> 
> 标签：schema, openldap

我正在使用 InetOrgPerson、organizationalPerson、person 和 posixaccount 对象类。

我希望邮件属性成为 RDN/DN，以便它可以用于绑定（身份验证）而不是 cn/uid。

我该怎么做？

PS：我对 LDAP 很陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T11:38:39.650

LDAP API 调用是`ldap_modrdn()`，它通常只`modrdn()`在非 C API 中调用。

您尝试解决的问题有两种不同的方法：与其重命名所有对象，更传统的方法是使用*搜索*或*代理*用户根据过滤器查找 DN。这隐藏了目录中的任何命名和层次结构。

它是这样的：

1.  用户输入电子邮件和密码
2.  应用程序作为受限访问搜索用户绑定到目录
3.  `(mail=whatever)`在用户容器中搜索带有过滤器的对象
4.  如果只找到一个用户，则尝试使用完整的 DN 和用户密码重新绑定
5.  如果成功继续登录

如果您在 SO 中搜索“ldap search authenticate”，您应该能够找到一些合适的代码，具体取决于您正在开发的内容。

# php - 基于分数的反馈重定向问卷

> ID：14034113
> 
> 赞同：0
> 
> 时间：2012-12-25T21:28:41.157
> 
> 标签：php, javascript

我想在我的网站上添加一个简单的问卷，其中包含几个多项选择题。每个问题都有一个分数，最后用户会根据总分被重定向到自定义页面。有人可以推荐我这样的 php 或 javascript 脚本或任何其他可能的解决方案吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T21:32:09.190

只是让你知道，你不应该要求人们在这个网站上给你一个代码。您应该先尝试自己制作，如果遇到任何问题，请寻求帮助。但是，就您的问题的 php 脚本而言，这里有一个完整的源代码，来自 elanman。

[http://blog.elanman.com/elanzips/php-quiz.zip](http://blog.elanman.com/elanzips/php-quiz.zip)

你也有著名的hotscripts，在这里查看：

[http://www.hotscripts.com/category/scripts/php/scripts-programs/tests-quizzes/](http://www.hotscripts.com/category/scripts/php/scripts-programs/tests-quizzes/)

# ruby - 使用标准库仅提取第二个匹配到 Ruby 中的正则表达式

> ID：14034119
> 
> 赞同：2
> 
> 时间：2012-12-25T21:30:13.420
> 
> 标签：ruby, regex, string

我正在编写一个 Ruby 脚本来遍历一个文本文件并在每行中提取第二次出现的正则表达式模式。以下是一行文本的示例：

```
gi|324021737|ref|NM_001204301.1|    gi|324021738|ref|NP_001191230.1|    100.00  459 0   0   1080    2456    294 752 0.0  905 
```

我要获取的数字是`gi|324021738`上面示例中的数字，但不是`gi|324021737`行首的数字。这些值始终以 开头`gi|`，但其后的位数会有所不同。

仅将 Regex 的第二个匹配项附加到字符串数组的最有效方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T21:33:55.917

你可以使用这个正则表达式： -

```
"^gi.*?(gi\|\d+).*?$" 
```

并让第 1 组脱离它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-25T23:32:34.737

这将比使用`split('|')`正则表达式更好地处理：

```
array = []

text = 'gi|324021737|ref|NM_001204301.1|    gi|324021738|ref|NP_001191230.1|    100.00  459 0   0   1080    2456    294 752 0.0  905'
array << text.split('|')[4, 2].map(&:lstrip)
=> [["gi", "324021738"]] 
```

管道（“|”）通常用于分隔数据库输出中的字段，类似于逗号分隔值文件 (CSV)。

Ruby 的[CSV](http://ruby-doc.org/stdlib-1.9.2/libdoc/csv/rdoc/CSV.html)甚至是更好的选择：

```
require 'csv'

text = 'gi|324021737|ref|NM_001204301.1|    gi|324021738|ref|NP_001191230.1|    100.00  459 0   0   1080    2456    294 752 0.0  905'

array = []
CSV.parse(text, :col_sep => '|') do |row|
  array << row[4, 2].map(&:lstrip)
end

array
=> [["gi", "324021738"]] 
```

使用 CSV 可能比拆分更好，尤其是比简单的正则表达式更好的原因是，当分隔文件嵌入另一个字段时，它通常会转义分隔字符。捕获该条件的正则表达式很难编写和维护。`split`也可能做错事，这就是为什么最好依赖预先构建/预先测试的“轮子”，如 CSV。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T23:40:00.250

我花了几秒钟来理解@Rohit 发布的正则表达式。

这是使用拆分的替代答案。使用“”字符（空格）将字符串分成组。然后使用“|”分割索引 1 处的元素。获取索引 1 处的元素。这就是您要查找的数字。

```
s = "gi|324021737|ref|NM_001204301.1|    gi|324021738|ref|NP_001191230.1|    100.00  459 0   0   1080    2456    294 752 0.0  905"
s.split(" ")[1].split("|")[1]

=> "324021738" 
```

# java - JAXB 组合相似元素

> ID：14034120
> 
> 赞同：3
> 
> 时间：2012-12-25T21:30:15.210
> 
> 标签：java, jaxb

我有一个 XML 源，它以我无法更改的格式生成 XML。
格式类似于：

```
    <entry name="bob" color="red"/>
    <entry name="bob" color="blue"/>
    <entry name="bob" color="green"/>

```

其中*name*属性可用于分组。
解组后的结果类似于

```
    类条目{

        字符串名称=“鲍勃”；
        字符串颜色=“红色”；

    }

    类条目{

        字符串名称=“鲍勃”；
        字符串颜色=“绿色”；

    }

```

但是我想将这些组合成类似于：

```
    类条目{

        字符串名称=“鲍勃”；
        设置颜色 = {“红色”、“蓝色”、“绿色”};

    }

```

有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T21:49:04.500

作为 JAXB 解组过程的一部分，我认为这并不容易。此外，您应该已经将 a 定义`public Set<String> colors`为对象的字段。作为单独的第二个处理步骤应该很容易实现：

```
entries = unmarshaller.unmarshal(...);
Map<String, Entry> compacted_entries = new HashMap<String, Entry>();
for (Entry entry: entries) {
   if compacted_entries.containsKey(entry.name)
     compacted_entries.get(entry.name).colors.add(entry.color);
   else
     compacted_entries.put(entry.name, entry);
     entry.colors = new HashSet<String>();
     entry.colors.add(entry.color);
   end
} 
```

# iphone - 在 iPhone 上打开一个端口

> ID：14034121
> 
> 赞同：1
> 
> 时间：2012-12-25T21:30:17.663
> 
> 标签：iphone, objective-c, sockets, networking, ports

我几乎完成了一个适用于 iPhone 的应用程序，最后我想在 iPhone/iPad/iTouch 上打开一个端口（比如 8080）。

应用程序的这一部分允许用户使用 :8080 在他们的网络浏览器上输入他们的 iDevice 的 IP 地址，并将向他们显示我创建的 HTML 页面。

我浏览了几个 Apple 文档，但我仍然没有很好地掌握这个概念。

有人可以带我看一篇关于 iPhone 网络或在 iPhone 上打开套接字的基础知识的文章吗？

# clearcase - 从脚本在单个 cleartool 会话中运行多个命令？

> ID：14034122
> 
> 赞同：1
> 
> 时间：2012-12-25T21:30:26.003
> 
> 标签：clearcase, cleartool

### 问题

[cleartool 文档](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/topic/com.ibm.rational.clearcase.cc_ref.doc/topics/cleartool.htm)提到了“单命令模式”和“交互模式”。单命令模式允许您以非交互方式运行单个命令。交互模式允许您在交互会话中运行多个命令？

我需要使用同一会话从脚本运行多个命令。更具体地说，我需要运行一个`cd`命令来切换到一个视图目录，这样我才能运行`find -avobs`. 我不能使用单命令模式，因为每次调用`cleartool`.

是否可以编写脚本以使用交互模式进行交互，或者在同一会话中从脚本运行多个命令？

* * *

注意 - 我考虑`cd`过从批处理脚本中运行，而不是从 cleartool 中运行。但是，我想使用 syntax `cd \\view\<view-tag>`，但是当我尝试从 cmd.exe 运行它时，出现错误：

> CMD 不支持将 UNC 路径作为当前目录。

即使我确实找到了一种方法来解决这个问题，而无需在单个会话中使用多个命令，我仍然对一般情况下是否可行感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T21:40:45.340

您可以在带有`cleartool`命令的 bash 脚本中使用 cd（单命令模式）。

在 Windows 中，可以通过以下方式访问动态视图

```
cd m:\MyDynamicView 
```

之后，任何 cleartool 命令都将在该目录的上下文中执行（动态视图）

快照视图也是如此。

```
cd c:\path\to\root\snapshotview 
```

*UNC 路径是为视图存储*保留的（任何客户端都必须可以访问）。
它不适用于视图根目录。

将此[答案](https://stackoverflow.com/questions/2927206/cleartool-question/2927385#2927385)`cleartool`视为在 a 之后使用的命令示例`cd`：它们可以毫无问题地在脚本中使用。

请注意，您必须先启动视图（如果它是动态视图）：请参阅[此答案](https://stackoverflow.com/questions/13794088/list-of-directories-off-of-the-root-of-vob-in-cleartool/13794249#13794249)以查看具体示例。

# python - 将项目添加到空列表python的列表中

> ID：14034124
> 
> 赞同：-1
> 
> 时间：2012-12-25T21:30:46.553
> 
> 标签：python

不完全确定如何问这个问题，但它就在这里。

我有一个空白列表

我想将一个元素添加到列表中的列表中。

因此，就我而言，我正在通过 apache.conf 查找包含 ServerAlias 的任何行。

如果找到它，我想将该行添加到子列表的最后一个元素中。所以....

```
[['ServerAlias test.com']] 
```

如果它在特定虚拟主机中找到另一个条目，它将将该项目添加到同一子列表中。

```
[['ServerAlias test.com','ServerAlias neww.com']] 
```

下一次它通过新的虚拟主机。我想在此列表的末尾添加一个列表并重新开始。等等...

```
[['ServerAlias test.com','ServerAlias neww.com'],['ServerAlias cranberry.com']] 
```

我知道我在描述这一点时做得很糟糕。

这是我的非工作代码，因此可能会有所帮助。

```
def buildvars(fileoutput):
import time
import re
servername=[]
docroot=[]
serveralias=[[]]
vhostdata={}
invhost=0
for line in fileoutput.split('\n'):
    if line == '' or re.search('^#',line) or re.search('^\s+#',line):  #delete blank lines... I dont care about them
        pass
    else: 
        if re.search('^\s*\<VirtualHost', line): #check if we are in a vhost
            invhost=1  #mark that we are in a vhost
            aliascounter=0 
        elif re.search('^\s*\</VirtualHost', line):
            invhost=0
            if aliascounter==0:
                serveralias.append('None') 
        if invhost == 1:
            if re.search('^\s*ServerName.*$',line):  #if we are in a vhost, check if the line contains servername
                servername.append(line.strip())  #then append it to the vhosts list
            if re.search('^\s*DocumentRoot.*$',line):
                docroot.append(line.strip())
            if re.search('^\s*ServerAlias.*$',line):
                if not serveralias: 
                    serveralias[0[0]].append(line.strip())
                else:
                    serveralias[-1[0]].append(line.strip())
                    aliascounter+=1 
```

希望有人知道我在说什么。圣诞节快乐！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T21:39:09.440

`serveralias[0[0]]`不是你想要的表达方式。这意味着'取第 0 项`0`，然后将其用作键以从`serveralias`' 中获取值。`TypeError`每当 Python 尝试评估该表达式时，您都会得到一个，因为 0 是不可索引的。

如果您实际上想要获取列表第 0 项的第 0 项，则需要将该表达式替换为`serveralias[0][0]`. 但是您甚至不想这样做；您只想附加到`serveralias`.

所以`serveralias[0[0]].append(foo)`用`serveralias[0].append(foo)`和`serveralias[-1[0]].append(foo)`替换`serveralias[-1].append(foo)`。

不知道代码中是否还有其他问题，我没有仔细看。

# python - 在不访问类的任何实例的情况下寻址使用“self”声明的变量

> ID：14034131
> 
> 赞同：-3
> 
> 时间：2012-12-25T21:31:21.937
> 
> 标签：python, oop, self

在此示例中，我可以在`x`不触摸任何实例的情况下查找 的键`C`吗？

```
class C:
    def __init__(self):
        self.x = dict(one=1, two=2) 
```

我的目的：

我有一个`ElementClass`和`ManagerClass`。`ElementClass`包含一个用 dict 实现的结构。并且`ManagerClass`方法必须通过将输入字典的键与原型字典键的键进行比较来验证输入。

如何在不模糊的情况下实现这一点？

**UPD：** 人们说如果我`x`用声明`self`，这意味着我已经接触过实例。实际上并不总是：

```
class C:
    x = dict(one=1, two=2)

    def m(self):
        print(id(self.x)

x = C() 
```

在这个例子中，我没有`x`用声明`self`，但我可以用`self`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T21:34:50.977

不适用于您当前的设置。但是，您可以创建`x`一个类变量：

```
class C(object):
    x = dict(one=1, two=2) 
```

您可以使用类变量并保留类范围的实例列表：

```
class C(object):
    instances = []

    def __init__(self):
        self.x = dict(one=1, two=2)

        self.instances.append(self) 
```

`C`现在，您可以通过访问类变量来遍历 的所有实例：

```
for instance in C.instances:
    print instance.x 
```

* * *

为此使用类变量不是一个好主意。只需将列表添加到您的经理类：

```
class Manager(object):
    def __init__(self):
        self.elements = []

    def is_valid(self, element):
        return 42 not in element.x

    def validate(self):
        for element in self.elements:
            if not self.is_valid(element):
                return False

        return True

class Element(object):
    def __init__(self, manager):
        manager.elements.append(self)

        self.x = {'one': 1, 'two': 2}

if __name__ == '__main__':
    manager = Manager()
    element1 = Element(manager)
    element2 = Element(manager)
    element3 = Element(manager)

    print manager.validate() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T21:47:55.480

没有实例作为属性的实例属性不存在。您可以从该类的实例访问类属性，但在这种情况下，该属性属于类本身，而不是实例。您可以查看一个简单的装饰器或描述符协议来创建一个结构，该结构`x`通过中央接口对每个实例的所有值进行编目，并允许类以不同于实例的方式访问数据......

# c - 使用 C 中的结构正确实现 GCD

> ID：14034135
> 
> 赞同：1
> 
> 时间：2012-12-25T21:31:44.107
> 
> 标签：c, garbage-collection, greatest-common-divisor

我正在用c实现一个非常简单的计算机代数系统。我的程序在一段时间后崩溃时遇到了一些问题。

这个想法是有一个像 3^(21+8^(3^100)) + 4 这样的表达式，并看到它等于 2 mod 7。我已经用 java 编写了程序，并试图将它移植到 c。

我就是这样做的：我有一个名为 expr 的结构。它可以是二进制表达式或原子 int

```
struct expr
{
    struct expr* a;
    struct expr* b;
    char op;
    int value;
};
typedef struct expr expr;

expr* new_expr(int i)
{
    expr* e = malloc(sizeof(expr));
    e->op='i';
    e->value = i;
    return e;
}

expr* new_expr2(expr* a, expr* b, char op)
{
    expr* e = malloc(sizeof(expr));
    e->a=a;
    e->b=b;
    e->op=op;
    e->value = 0;
    return e;
}

void free_expr(expr* e)
{
    free_expr(e->a);
    free_expr(e->b);
    free(e);
}
/* ... other methods ... */ 
```

我怀疑（其中一个）问题是我没有在 gcd 函数中释放内存。这就是我编写 gcd 函数的方式。

```
expr* gcd(expr* a, expr* b)
{
    expr* t = b;
    while(!equals(b, zero))
    {
        t=b;
        b=mod(a, b);
        a=t;
    }
    return a;
} 
```

这在java中很好用，但我不确定它是否在c中有效，因为它没有自动垃圾收集。当函数是递归的时，我不确定如何构造它。所以我想我的问题是，我应该把 free_expr 函数放在哪里？mod(a, b) 分配一个新的 expr 结构，因此它最终会创建很多永远不会被释放的 expr。我怀疑这可能是它崩溃的原因。构建这个的正确方法是什么？还是我做错了？

由于代码可维护性，我宁愿在 struct expr 中进行计算，而不是在 int 中进行计算。

谢谢你的帮助。

[编辑] 这是我的模组功能

```
expr* mod(expr* number, expr* modulo)
{
    expr* result;
    if(number->op=='i')
    {
        if(modulo->op=='i')
        {
            int i = (number->value)%(modulo->value);
            while(i<0)
            {
                i=i+(modulo->value);
            }
            return new_expr(i);
        }
    }
    switch(number->op)
    {
    case '+':
        result = new_expr(mod(number->a,modulo)->value+mod(number->b,modulo)->value);
        break;
    case '-':
        result = new_expr(mod(number->a,modulo)->value-mod(number->b,modulo)->value);
        break;
    case '*':
        result = new_expr(mod(number->a,modulo)->value*mod(number->b,modulo)->value);
        break;
    case '/':
        result = new_expr(mod(number->a,modulo)->value/mod(number->b,modulo)->value);
        break;
    case '^':
        result = modexpEuler(number->a,number->b, modulo);
        break;
    }
    (result->value)%=(modulo->value);
    return result;
}

expr* modexpEuler(expr* a, expr* b, expr* n)
{
if(!(a->op=='i')||!(n->op=='i'))
{
    printf("wrong input ");
    exit(0);
}

if(equals(b, one))
{
    return mod(a,n);
}
if(equals(b, zero))
{
    if(b->op=='^'){
        printf("adf %d\n",b->a->value);
        printf("asdf %d\n", b->b->value);
    }else{

        printf("asdf %c\n", b->op);
        printf("asdf %d\n", b->value);
        printf("asdf %d\n", a->value);
        printf("asdf %d\n", a->b->value);
    }
    return copy_expr(zero);
}
if(equals(mod(a, n), zero))
{
    return copy_expr(zero);
}
if(b->op == 'i')
{
    return expmod(a, b, n);
}
if(equals(gcd(a,n), one))
{
    expr* tempA = mod(a, n);
    expr* tempB = mod(b, phi(n));
    printf("trying to use euler\n");
    printf("%d\n",a->value);
    printf("%d\n",b->value);
    return modexpEuler(tempA, tempB, n);
}
else
{
    printf("gcd not 1 ");
    exit(0);
} 
```

}

phi(n) 计算欧拉函数。

[编辑 2] 这是我的平等

```
int equals(expr* a, expr* b)
{
    if((a->op)!=(b->op))
    {
        return 0;
    }
    if((a->op)=='i')
    {
        return (a->value)==(b->value);
    }else{
        return equals(a->a,b->a)&&equals(a->b,b->b);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T21:44:52.680

在`gcd`，你有三个`expr*`，即`a, b`和`t`。

```
expr* gcd(expr* a, expr* b)
{
    expr* t = b;
    while(!equals(b, zero))
    {
        t=b;
        b=mod(a, b); 
```

现在`t`指向`b`之前指向的内容，`b`指向模数，并且`a`仍然指向它在本次迭代中进入循环体时所指向的内容。

```
 a=t; 
```

现在它被覆盖并且变得无法访问。因此，释放它的正确时间将在该任务之前。在那之前你不能释放它，因为它在`mod(a, b)`. 之后你无法释放它，因为那时你不再拥有它的句柄。

```
 }
    return a;
} 
```

请注意，传入的指向结构因此在 中被销毁`gcd`，因此如果之后在函数之外需要它们，则应该制作（深度）副本。

段错误的直接原因可能是

```
void free_expr(expr* e)
{
    free_expr(e->a);
    free_expr(e->b);
    free(e);
} 
```

那绝对需要`NULL`检查。照原样，您尝试`free_expr(0->a)`，这是未定义的行为，几乎肯定会崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T21:39:25.523

假设 mod 正在分配一个新的 expr，那么是的，有一个泄漏。我可能会传入第三个 expr 来获取结果，而不是在 mod 中分配一个。这允许您的调用代码决定在内存方面做什么。

顺便检查一下 valgrind 可能很有用。它可以用来查找内存问题，而且它很容易用于基本的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-25T21:49:11.003

```
typedef struct expr
{
    struct expr* a;
    struct expr* b;
    char op;
    int value;
} expr;

expr* new_expr(int i)
{
    expr* e = malloc(sizeof(expr));
    e->a=NULL                          <----
    e->b=NULL                          <----
    e->op='i';
    e->value = i;
    return e;
}

expr* new_expr2(expr* a, expr* b, char op)
{
    expr* e = malloc(sizeof(expr));
    e->a=a;
    e->b=b;
    e->op=op;
    e->value = 0;
    return e;
}

void free_expr(expr* e)
{
    if (e!=NULL) {
        free_expr(e->a);
        free_expr(e->b);
        free(e);
    }
}
/* ... other methods ... */

expr* gcd(expr* aa, expr* bb)
{
    expr *a = copy_of(aa), *b = copy_of(bb);
    expr* t = b;
    while(!equals(b, zero))
    {
        t=b;
        b=mod(a, b);
        free_expr(a);
        a=t;
    }
    free_expr(b);
    return a;
} 
```

# google-apps-script - 如何使用 Appscript doPost 创建 REST API？

> ID：14034140
> 
> 赞同：2
> 
> 时间：2012-12-25T21:32:42.930
> 
> 标签：google-apps-script

1 个月后，我想再次提出有关该主题的问题：这是包含所有链接的整篇文章：[https ://docs.google.com/document/d/1Tb0-twzHl-wXbvaNF2IpCT0CiONT9PoqPlEweLz3oYI/edit](https://docs.google.com/document/d/1Tb0-twzHl-wXbvaNF2IpCT0CiONT9PoqPlEweLz3oYI/edit)

项目中有一个函数，其中 urlFetchApp 使用第二个脚本函数中的 doPost 发送有效负载。第二个函数将有效载荷存储在电子表格中： 1\. 电子表格：运行第一个函数时，第二个函数不会将有效载荷存储在电子表格中。详细说明如下：

**1\. 带脚本的项目**

```
function merry2script() {
  var url = 'https://script.google.com/macros/s/AKfycbzM97wKyc0en6UrqXnVZuR9KLCf-UZAEpzfzZogbYApD9KChnnM/exec';
  var payload = {payloadToSend : 'string to send'};
  var method = 'post'
  var response = UrlFetchApp.fetch(url, {method : method, payload: payload}).getContentText();
  Logger.log(response);
  return;
} 
```

img merry2.jpg

**2\. 带脚本的项目**

```
function doPost(e) {
  var ss = SpreadsheetApp.openById("0Apjz67q9b5PldFJUYkkzVGRHdGFYc1pFYWk5T0Eyc0E");
  var sheet = ss.getSheetByName("testsheet");
  var record;
  for (var i in e.parameters) {
    record = 'parameter: ' + i + ' = ' + e.parameters[i];
    sheet.getRange(sheet.getLastRow() + 1, 1, 1, 1).setValue(record);
  }
  var output = ContentService.createTextOutput();
  output.setContent("content to return");
  return output;
} 
```

img merry_christmas.jpg

发布 2\. 脚本，

img 出版证据 2\. 脚本：mch1.jpg

**1\. 电子表格** [https://docs.google.com/spreadsheet/ccc?key=0Apjz67q9b5PldFJUYkkzVGRHdGFYc1pFYWk5T0Eyc0E](https://docs.google.com/spreadsheet/ccc?key=0Apjz67q9b5PldFJUYkkzVGRHdGFYc1pFYWk5T0Eyc0E)

**结果：** 当负载通过 hurl.it（网页）发送时，它不会显示在电子表格中。没有结果的尝试

**尝试使用此选项** 安装此 chrome 扩展“高级 REST 客户端”客户端/hgmloofddffdnphfgcellkdfbfbjeloo img 结果

**生成电子表格** ss_test.jpg

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-07T18:44:00.277

为了从发布的 URL 获得响应，必须使用以下设置发布它：

1.  **执行应用程序为：**我
2.  **谁有权访问该应用程序：**任何人，甚至是匿名的

这是必需的，因为按照您获取 URL 的方式，它只能访问公共可用的网址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-24T08:39:41.280

您只需要将标题键包含在您的字典中，这就是全部当然还有 Hari Das 提到的内容

**标头：{“授权”：“承载”+ ScriptApp.getOAuthToken()}**

```
function merry2script() {
      var url = 'https://script.google.com/macros/s/AKfycbzM97wKyc0en6UrqXnVZuR9KLCf-UZAEpzfzZogbYApD9KChnnM/exec';
      var payload = {payloadToSend : 'string to send'};
      var method = 'post'
      var headers: {"Authorization": "Bearer " + ScriptApp.getOAuthToken()}
      var response = UrlFetchApp.fetch(url, {method : method, payload: payload, headers: headers}).getContentText();
      Logger.log(response);
      return;
    } 
```

# scala - 如何通过 Scala 反射访问默认参数值？

> ID：14034142
> 
> 赞同：19
> 
> 时间：2012-12-25T21:32:57.733
> 
> 标签：scala, reflection, scala-2.10

假设我有一堂课：

```
case class Foo(id: Int, name: String, note: Option[String] = None) 
```

自动生成的伴生对象中的构造函数和应用方法都采用三个参数。当通过反射查看时，第三个参数（注）被标记：

```
p.isParamWithDefault = true 
```

此外，通过检查，我可以找到在伴随对象中产生值的方法：

```
method <init>$default$3 
```

和

```
method apply$default$3 
```

两者都有：

```
m.isParamWithDefault = true 
```

但是，我在 TermSymbol 上找不到任何关于 notes 参数的东西，它实际上将我指向正确的方法来获取默认值，也找不到在上述 MethodSymbols 上指向参数的 TermSymbol 的任何东西。

是否有直接的方法将参数的 TermSymbol 与生成其默认值的方法联系起来？还是我需要做一些笨拙的事情，比如检查伴随对象上的方法名称？

我对这里的案例类构造函数示例和常规方法都感兴趣。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-25T23:51:15.973

有一定程度的杂乱无章。

[此答案](https://stackoverflow.com/a/13813000/1296806)的示例代码，粘贴在下面。

正如我所说，名称的形式在 4.6、6.6.1 的规范中。这不是临时的。`For every parameter pi , j with a default argument a method named f $default$n is generated which computes the default argument expression.`

缺乏访问和重构这些生成名称的结构化能力是一个已知问题（ML 上有一个当前线程）。

```
import reflect._
import scala.reflect.runtime.{ currentMirror => cm }
import scala.reflect.runtime.universe._

// case class instance with default args

// Persons entering this site must be 18 or older, so assume that
case class Person(name: String, age: Int = 18) {
  require(age >= 18)
}

object Test extends App {

  // Person may have some default args, or not.
  // normally, must Person(name = "Guy")
  // we will Person(null, 18)
  def newCase[A]()(implicit t: ClassTag[A]): A = {
    val claas = cm classSymbol t.runtimeClass
    val modul = claas.companionSymbol.asModule
    val im = cm reflect (cm reflectModule modul).instance
    defaut[A](im, "apply")
  }

  def defaut[A](im: InstanceMirror, name: String): A = {
    val at = newTermName(name)
    val ts = im.symbol.typeSignature
    val method = (ts member at).asMethod

    // either defarg or default val for type of p
    def valueFor(p: Symbol, i: Int): Any = {
      val defarg = ts member newTermName(s"$name$$default$$${i+1}")
      if (defarg != NoSymbol) {
        println(s"default $defarg")
        (im reflectMethod defarg.asMethod)()
      } else {
        println(s"def val for $p")
        p.typeSignature match {
          case t if t =:= typeOf[String] => null
          case t if t =:= typeOf[Int]    => 0
          case x                         => throw new IllegalArgumentException(x.toString)
        }
      }
    }
    val args = (for (ps <- method.paramss; p <- ps) yield p).zipWithIndex map (p => valueFor(p._1,p._2))
    (im reflectMethod method)(args: _*).asInstanceOf[A]
  }

  assert(Person(name = null) == newCase[Person]())
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-26T00:00:49.083

您*可以*通过强制转换为内部 API 来做到这一点，而无需对生成的名称做出假设：

```
scala> :power
** Power User mode enabled - BEEP WHIR GYVE **
** :phase has been set to 'typer'.          **
** scala.tools.nsc._ has been imported      **
** global._, definitions._ also imported    **
** Try  :help, :vals, power.<tab>           **

scala> case class Foo(id: Int, name: String, note: Option[String] = None)
defined class Foo

scala> val t = typeOf[Foo.type]
t: $r.intp.global.Type = Foo.type

scala> t.declaration(nme.defaultGetterName(nme.CONSTRUCTOR, 3))
res0: $r.intp.global.Symbol = method <init>$default$3

scala> t.declaration(nme.defaultGetterName(newTermName("apply"), 3))
res1: $r.intp.global.Symbol = method apply$default$3 
```

当然，这在某种程度上也不是更好，因为指定了名称修饰而没有指定内部 API，但它可能更方便。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-04-03T09:50:15.970

对于只有以下情况`Type`的情况`Foo`：

```
% scala
Welcome to Scala 2.13.1 (OpenJDK 64-Bit Server VM, Java 15-loom).

scala> :paste

import scala.reflect.runtime.currentMirror
import scala.reflect.runtime.universe._
import scala.reflect.runtime.universe.definitions._

def defaults(tpe: Type): Seq[(Int, Any)] = {
  tpe.typeSymbol.asClass.primaryConstructor.asMethod.paramLists.flatten.
    zipWithIndex.flatMap{ case (x, i) =>
    if (x.asTerm.isParamWithDefault) {
      val m = currentMirror
      val im = m.reflect(
        m.reflectModule(tpe.typeSymbol.asClass.companion.asModule).instance
      )
      val method = tpe.companion.decl(
        TermName("apply$default$"+(i+1).toString)
      ).asMethod
      val v = im.reflectMethod(method)()
      Some(i -> v)
    } else None
  }
}

scala> case class Foo(id: Int, name: String, note: Option[String] = None)

scala> defaults(typeOf[Foo])
res0: Seq[(Int, Any)] = List((2,None)) 
```

与您可以在伴随对象上调用任何方法的方式相同。

[有关 Mirrors 的文档](https://docs.scala-lang.org/overviews/reflection/environment-universes-mirrors.html#runtime-mirrors)包含如何在类上调用方法的示例。

# perl - 如何使部分代码在perl中只运行一次

> ID：14034145
> 
> 赞同：2
> 
> 时间：2012-12-25T21:33:38.687
> 
> 标签：perl

即使脚本在以后多次执行，如何使部分代码在 perl “第一次执行时只运行一次”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T21:37:44.570

您可以将那部分代码放在某个`if`块中进行测试，例如使用文件，无论它是否是脚本的第一次执行，如果是，则仅执行该块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-25T21:45:21.980

一种可能的方法是重写脚本本身，如下所示：

```
use warnings;
use script;

#### RUN ONCE BEGIN

do_something_once_only();

my $script_name = $0;
my $script_copy = $0 . 'old';
open my $fin, '<', $script_name or die $!;
open my $fout, '>', $script_copy or die $!;

my $script_content = do { local $/ = undef; <$fin>; };
$script_content =~ s/#### RUN ONCE BEGIN.+?#### RUN ONCE END/s;
print $fout $script_content;
`cp $script_copy $script_name`;

#### RUN ONCE END

do_something_else(); 
```

这只是一个概念；不幸的是，不能在这里测试它。但基本思想非常简单：在脚本中创建一个明确分隔的“运行一次”块，然后在第一次执行时，从脚本内容中删除该块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-25T22:18:58.860

我会开发一个类对象来用非常清楚的英语来完成它的工作。在 Ubuntu 中，在 /var/run/[run_name]/ 下为您的脚本创建一个新目录，并在第一次运行时使用该脚本在其中创建一个文件。例如：

文件名：RunOnce.pm

```
package RunOnce;
use Moose;

has 'run_name' => ( is => 'ro' , isa => 'Str' , required => 1 );
has 'initialize_file' => ( is => 'ro' , isa => 'Str'
    , builder => '_build_initialize_file'
    , lazy => 1 );

sub _build_initialize_file {
    return '/var/run/'. $_[0]->run_name . '/run_once.txt';
}

sub is_initialized {
    my $self = shift;
    return ( -f $self->initialize_file );
}

sub initialize {
    my $self = shift;
    open(my $init_file,'>' . $self->initialize_file )
         || die "Could not open initialize file "
            . $self->initialize_file . "! $!";
    $self->process_initial_run();
    print $init_file "Initialized on " . localtime(time) . "\n";
    close($init_file);
}

sub process_initial_run {
    warn "I don't do anything yet.";
}

package main;

my $runner = RunOnce->new(run_name => 'test_run');
$runner->initialize unless $runner->is_initialized();

1; 
```

我刚刚在我自己的盒子上测试了这个：

```
paul@paul-1204-virtualbox:~$ sudo rm -rf /var/run/test_run/
paul@paul-1204-virtualbox:~$ sudo mkdir /var/run/test_run/
paul@paul-1204-virtualbox:~$ sudo chown paul:paul /var/run/test_run
paul@paul-1204-virtualbox:~$ perl RunOnce.pm
I don't do anything yet. at RunOnce.pm line 29.
paul@paul-1204-virtualbox:~$ perl RunOnce.pm
paul@paul-1204-virtualbox:~$ 
```

现在您可以覆盖包和类并执行您想要的操作，并且能够多次使用它来处理不同的项目，而无需太多工作：

新文件 RunOnceOverride.pm：

```
package RunOnceOverride;

use Moose;

extends 'RunOnce';

sub process_initial_run {
    warn "I'm going to try to do something else!";
}

package main;

my $runner = RunOnceOverride->new(run_name => 'test_run_override');
$runner->initialize unless $runner->is_initialized();

1; 
```

现在：

```
paul@paul-1204-virtualbox:~$ sudo rm -rf /var/run/test_run_override/
paul@paul-1204-virtualbox:~$ sudo mkdir /var/run/test_run_override/
paul@paul-1204-virtualbox:~$ sudo chown paul:paul /var/run/test_run_override/
paul@paul-1204-virtualbox:~$ perl -I. RunOnceOverride.pm
I'm going to try to do something else! at RunOnceOverride.pm line 8.
paul@paul-1204-virtualbox:~$ perl -I. RunOnceOverride.pm
paul@paul-1204-virtualbox:~$ 
```

这是该问题的一个很好的可扩展解决方案，但 initialize 可能应该检查 is_initialized 本身，而不是期望主代码来执行它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-26T08:41:57.807

你不能做这样的事情：

```
mySub if (!(-e "/some/path/cpuid.txt"));

sub mySub() {
    //do something
    open(my $cpuid, ">", "/some/path/cpuid.txt") || die $!;
    print $cpuid "blah";
} 
```

顺便说一句，我不是任何形式的 DRM 的忠实粉丝。另外，您建议这样做的方式将很容易被打破。只需删除 cpuid.txt 文件即可。

# python - Python：是否可以访问“finally”子句中的返回值？

> ID：14034156
> 
> 赞同：15
> 
> 时间：2012-12-25T21:36:20.427
> 
> 标签：python, return-value, finally

我在一个`try`子句中有一个 return 语句：

```
def f():
    try:
        return whatever()
    finally:
        pass # How do I get what `whatever()` returned in here? 
```

是否可以在`finally`子句中获取返回值？

这更像是一个理论问题，所以我不是在寻找一种解决方法，比如将其保存到变量中。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-25T21:38:00.413

不，不是——`finally`子句的内容独立于返回机制；如果您确实想查看返回的值，则必须按照您提到的那样做，并将其显式保存在范围内的某个位置。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-26T00:28:32.253

在return语句之后你绝对必须“进入”吗？

如果在声明**之前**允许更改，那么您只需要。`return``sys.settrace()`

**之后** 获取值`return`：

我认为，在无**堆栈**Python 中，您应该能够做到这一点。“线程”可以在无堆栈中腌制，并且即将返回的值，也就是值堆栈的顶部，应该在那里。

在**CPython**中，我还没有找到查看值堆栈顶部的方法。

*   不允许动态改变 frame.f_lasti
*   不允许动态改变 frame.f_code
*   动态改变 frame.f_trace 是允许的，但似乎没有帮助
*   在返回语句“已执行”后，从 finally 块中设置跟踪函数未捕获实际返回事件
*   with 语句不捕获返回值
*   我假设调用者忽略 f 的返回值，因此自省或跟踪调用者无济于事
*   我假设whatever() 有副作用，不能再次调用
*   调试器，至少我尝试过的那些，没有得到返回值（？）；用 Python 编写的调试器使用 sys.settrace 和/或最后一个异常，它们都不包含堆栈上的返回值。

当然，使用C 级扩展**一切皆有可能，这里有一个快速演示：**`ctypes`

```
"""
valuestack.py: Demo reading values from Python value stack
Offsets are derived for CPython-2.7.2, 64-bit, production build
"""
import ctypes, inspect, random

def id2obj(i):
    """convert CPython `id` back to object ref, by temporary pointer swap"""
    tmp = None,
    try:
        ctypes.cast(id(tmp), ctypes.POINTER(ctypes.c_ulong))[3] = i
        return tmp[0]
    finally:
        ctypes.cast(id(tmp), ctypes.POINTER(ctypes.c_ulong))[3] = id(None)

def introspect():
    """pointer on top of value stack is id of the object about to be returned
    FIXME adjust for sum(vars, locals) in introspected function
    """
    fr = inspect.stack()[1][0]
    print "caught", id2obj(ctypes.cast(id(fr), ctypes.POINTER(ctypes.c_ulong))[47])

def value():
    tmp = random.random()
    print "return", tmp
    return tmp

def foo():
    try:
        return value()
    finally:
        introspect()

if __name__ == "__main__":
    foo() 
```

与 osx 附带的 64 位模式下的 Python-2.7.2 一起使用：

```
air:~ dima$ python valuestack.py 
return 0.959725159294
caught 0.959725159294 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-25T21:39:26.133

这是不可能的。如果您考虑巨大的骇人听闻的黑客攻击，例如检查字节码和摆弄框架对象，则*可能是这样。*我不确定这是否有意义，因为返回值不在本地，而且我认为您不能通过框架对象访问中间值堆栈（这是保存返回值的位置）。

也许您可以使用`ctypes`plus C API，但这也可能*非常*不稳定，并且需要*非常*熟悉`finally`. 我对它的了解还不够远，无法判断这是多么可行，但不用说，这完全超出了**Python**代码所能做的范围。

还有一个额外的问题是*可能没有返回值*（如果`whatever()`抛出异常）！我想你可以很容易地检测到这种情况，使用`sys.exc_info()`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-26T00:43:59.117

```
def f():
    InvalidFoo = object()
    foo = InvalidFoo
    try:
        foo = whatever()
        return foo
    finally:
        if foo is not InvalidFoo:
            # look at foo 
```

# c# - .Net 微框架中的自定义事件

> ID：14034160
> 
> 赞同：2
> 
> 时间：2012-12-25T21:36:49.933
> 
> 标签：c#, events, .net-micro-framework, netduino

我想创建一个简单的`PushButton`类来包装一个`InterruptPort`. 我想给它两个简单的`Up`和`Down`事件，当端口高和低时触发。

通常我会这样做：

```
public event EventHandler<EventArgs> Up;
public event EventHandler<EventArgs> Down; 
```

但是没有`EventHandler`课？那我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T21:48:08.617

.NET Micro Framework 不支持泛型，但非泛型[`EventHandler`](http://msdn.microsoft.com/en-us/library/hh400199.aspx)仍然可用。

所以你可以像这样使用它：

```
public event EventHandler Up;
public event EventHandler Down; 
```

> **命名空间**：Microsoft.SPOT
> 
> **程序集**：Microsoft.SPOT.TinyCore（在 microsoft.spot.tinycore.dll 中）

# z-index - KineticJS 中的 Z 索引

> ID：14034163
> 
> 赞同：3
> 
> 时间：2012-12-25T21:36:55.587
> 
> 标签：z-index, kineticjs

我正在尝试使用 kineticJS 进行编程，但在 Z-Index 管理方面遇到了一些问题。

似乎你不能只设置你想要的任何范围的 z-index，但是每个对象都有自己的 z-index，你可以与其他对象重新更改它们。因此，如果您有 2 个对象，它们的 z-index 为 0 和 1。您不能将其设置为 100 或类似的值。那是对的吗？

我的问题是，我正在尝试用等距概述编写一个小游戏。并且玩家的 z-index 应该比他正在行走的墙壁低，但是当他在墙壁前面时 z-index 较高。但是我不能让所有具有相同 y 坐标的墙都具有相同的 z-index，它们都有自己的免费 z-index，这使得一切都非常随机。

例如，y 坐标为 5 的墙的 z-index 为 5，而墙前面的玩家的 z-index 为 6。但最后，所有墙的随机索引为 5-20，玩家得到一个随机索引，因此完全不可能创建这样的游戏。

还有其他方法来管理对象的 z-index 吗？我看到的唯一解决方案是使用唯一的 z-index 为我的地图的所有图块制作一个包含 2 个隐藏对象的隐藏层，并编写一个脚本，使用墙壁和玩家或其他对象动态更改它们。但是必须有更好的方法来确保对象以正确的顺序显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T06:37:51.993

我刚刚遇到了同样的问题。似乎 Z-index 只能按顺序工作？所以我对元素列表进行了排序，然后根据数组索引分配了它们的 Z 索引：

```
var sortedElements = _elements.slice();
sortedElements.sort(function(a, b) {
    var diff = a.getY() - b.getY();
    if ( diff !== 0 ) { return diff; }
    return a.getX() - b.getX();
} );
for ( var loop = 0, length = sortedElements.length; loop < length; loop++ ) {
    sortedElements[loop].setZIndex(loop);
} 
```

# android - Android 浏览器在 Facebook 移动网站上崩溃

> ID：14034165
> 
> 赞同：0
> 
> 时间：2012-12-25T21:37:02.233
> 
> 标签：android, mobile, web, facebook-login

我正在尝试构建一个移动 facebook 网络应用程序，并且我正在尝试调试 javascript SDK 的登录和授权功能。当我的应用程序将移动浏览器重定向到 facebook 以进行授权时，移动浏览器在加载移动 facebook 网络登录页面时崩溃。这也发生在他们的“hackbook”样本上。我正在使用 android 2.3 姜饼的股票浏览器。海豚浏览器也崩溃了。有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:11:36.083

欢迎使用 Facebook API！有史以来最糟糕和更不稳定的开发平台。你有一个很好的测试反应：继续一个官方的演示样本，看看你是否可以复制这个错误。如果是这样，则意味着您对此无能为力，只能等待 FB 修复他们的代码。

只是为了测试，你介意试试这个 URL 吗？ [http://www.remi-grumeau.com/projects/emy/demos/facebook/](http://www.remi-grumeau.com/projects/emy/demos/facebook/)

这已经在 iOS5&6、Android 2.3&4、Blackberry 6&7、WindowsPhone8 上测试过。

雷米

# ruby-on-rails - TODO LIST 与设计

> ID：14034166
> 
> 赞同：0
> 
> 时间：2012-12-25T21:37:43.110
> 
> 标签：ruby-on-rails, devise

我申请了TODO List。

我安装了这个设计并想定义两种用户：

```
1) admin
2) worker 
```

所以我将创建管理控制器。同时，我创建了 user_controller。

我想强制登录，以便让工作人员更新他的任务（完成与否），所以我尝试了：

```
class WorkersController < ApplicationController
  before_filter :authenticate_user! 
```

ps，我的模型名称是user.rb：

```
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :lockable, :timeoutable, :confirmable and :activatable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation
  # attr_accessible :title, :body
end 
```

但是，:authenticate_user！是不行的。即使我注销，我也可以创建任务。

之后，我必须知道登录用户的邮件是什么（以便更新他的任务）。所以我必须写一些类似的东西：

```
def index 
  @email = params[:session][:email] 
```

但我得到一个错误：

```
NoMethodError in WorkersController#index

undefined method `[]' for nil:NilClass
Rails.root: /home/alon/projects/TODOLIST

Application Trace | Framework Trace | Full Trace
app/controllers/workers_controller.rb:8:in `index' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T22:06:48.970

首先，电子邮件不存储在会话中。登录后，Devise 有一个辅助方法 current_resource （在您的情况下为 current_user，因为单词“resource”被替换为模型名称）。你应该使用

```
@email = current_user.email 
```

至于允许/禁止某些操作，您需要使用 CanCan [https://github.com/ryanb/cancan](https://github.com/ryanb/cancan)

# assembly - x86 汇编，ROR 循环，从寄存器或内存计数

> ID：14034168
> 
> 赞同：1
> 
> 时间：2012-12-25T21:37:56.867
> 
> 标签：assembly, x86, nasm

我正在 x86 程序集中使用 nasm 编写代码。我希望能够做到这一点（在 EAX 中是旋转次数，或在 [EBP + 12] 下）：

```
ror ESI, EAX ;count- register
ror ESI, DWORD [EBP + 12] ;count- memory 
```

但这是不可能的。ror 只接受立即常量，如

```
ror ESI, 4  ; four right rotations 
```

我不喜欢循环：

```
loop:  
ror ESI, 1
sub EAX, 1
cmp EAX, 0
jg loop 
```

这个问题可能有更好的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T21:50:49.987

我发现 ROR 仅适用于 CL 寄存器，例如：

```
ror ESI, CL 
```

# android - Android 应用程序未在 avd 中执行

> ID：14034173
> 
> 赞同：2
> 
> 时间：2012-12-25T21:38:46.030
> 
> 标签：android, macos, sdk, avd

我已经在我的 OSX Mountain Lion 中安装了 Android SDK，来自以下网址 [http://developer.android.com/sdk/index.html](http://developer.android.com/sdk/index.html) 只需解压缩文件即可使环境正常工作。

确实可以，但是当我尝试在 avd 中执行时，模拟器会打开，但该应用程序从未出现。

我尝试过使用不同的设备和不同的应用程序，并执行`adb kill-server`和`adb start-server`. 但不工作。

**编辑：**

控制台说：

```
[2012-12-25 22:47:00 - test] Android Launch!
[2012-12-25 22:47:00 - test] adb is running normally.
[2012-12-25 22:47:00 - test] No Launcher activity found!
[2012-12-25 22:47:00 - test] The launch will only sync the application package on the device!
[2012-12-25 22:47:00 - test] Performing sync
[2012-12-25 22:47:00 - test] Automatic Target Mode: using existing emulator 'emulator-5554' running compatible AVD 'mobile_test_4.1'
[2012-12-25 22:47:00 - test] Uploading test.apk onto device 'emulator-5554'
[2012-12-25 22:47:00 - test] Installing test.apk...
[2012-12-25 22:47:04 - test] Success!
[2012-12-25 22:47:04 - test] /test/bin/test.apk installed on device
[2012-12-25 22:47:04 - test] Done! 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T21:51:24.453

# responsive-design - 响应式网页设计：百分比/html5 样板/960gs 还是 Foundation 框架？

> ID：14034179
> 
> 赞同：2
> 
> 时间：2012-12-25T21:39:36.943
> 
> 标签：responsive-design, fluid-layout, 960.gs, html5boilerplate, zurb-foundation

我有使用以 px 表示的固定尺寸的 HTML5 和 CSS3 构建静态网站的经验。我过去常常手工编写 CSS，这可能是最好的方法（结合使用 SASS 和 Compass，我仍然需要学习）。现在我必须实现一个新网站，并且我正在尝试制作一个灵活的布局，该布局可以很好地显示在桌面和移动设备上任何浏览器大小的任何主要浏览器（Internet Explorer、Firefox、Opera、Safari）上。我现在更关心桌面分辨率，但如果它在移动设备上看起来也不错，那就更好了。

我目前正在阅读 Ethan Marcotte 的《响应式网页设计》一书，并且正在学习当我必须使用他的公式设置维度时使用百分比：目标 / 上下文 = 结果（基本上是内容和容器）。我认为这是制作灵活网站的好方法。Ethan Marcotte 所说的响应式网站应该包含 3 个要素：

1.  灵活的基于网格的布局；
2.  灵活的图像和媒体；
3.  媒体查询。

我认为这是实现它的好方法。

* * *

*   除了该理论和手工制作的 CSS 之外，在不同的浏览器中可能会有不同的元素显示。我已经尝试过我目前正在使用并且我更喜欢的 Css 重置和 Normalize.css。我想尝试集成 Modernizr 的 HTML5 样板。你推荐它吗？

*   最近有越来越多的网格系统（甚至 Adob​​e Dreamweaver CS6 也使用 respond.js 实现了一种创建流体布局网格的方法。有什么好处吗？）我正在考虑尝试 960 网格系统或 ZURB 的 Foundation。我知道流体布局有不同版本的 960gs，无论如何，Foundation 现在对于流体布局更好吗？

*   最后，是否可以将 HTML5 Boilerplate 与 960gs 或 Foundation 结合起来，这有意义吗？

我已经阅读了与这些主题相关的问题和答案，但通常它们特定于一件事。我想对所有这些事情有一个全局的看法，并对如何进行提出建议。我提前感谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:03:36.723

我正在使用 Zurb 的 Foundation 来完成我所有的最新项目；它提供了我需要的一切。随着笔记本和台式机屏幕的分辨率越来越高，我发现限制为 960 像素的网格也已成为过去，因为在大屏幕上它们只覆盖 50%（或更少 = 这就像在 1024 像素上使用 480 像素布局一样）屏幕）！使用 Foundation，如果您相应地调整字体大小，您可以轻松地变宽。我现在通常会涨到1440。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T22:45:23.733

无论 960gs 提供什么，Bootstrap 和 Foundation 都提供更多。也就是说，Bootstrap 和 Foundation 都已经包含了基于网格的布局以及响应性选项。

也就是说，我建议您仔细查看 Bootstrap 和 Foundation，然后进行自己的比较。选择提供您更喜欢的功能的那个。如果您的工作井井有条，那么两者中的一个就足够了。

既然你还没有尝试过，我建议你现在真的去做，你的问题会在一瞬间消失。我建议你从 Bootstrap 开始，因为当你这样做时，你可能永远不会考虑尝试其余的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-25T21:46:01.093

Dreamweaver CS6 提供了许多用于创建灵活和流畅的布局的工具。我推荐你使用960网格系统，DW也提供了一个可以预览不同屏幕尺寸的网页的工具（你可以在网页的状态栏中找到这个，在右下角）

我几乎可以肯定这会对您有所帮助：

[http://webdesign.tutsplus.com/tutorials/applications/getting-started-with-dreamweaver-cs6-fluid-grids/](http://webdesign.tutsplus.com/tutorials/applications/getting-started-with-dreamweaver-cs6-fluid-grids/)

# javascript - 为什么扩展本机对象是一种不好的做法？

> ID：14034180
> 
> 赞同：155
> 
> 时间：2012-12-25T21:39:55.093
> 
> 标签：javascript, prototype, prototypal-inheritance

每个 JS 意见领袖都说扩展原生对象是一种不好的做法。但为什么？我们的表现是否受到打击？他们是否担心有人“以错误的方式”做这件事，并向 中添加可枚举类型`Object`，实际上破坏了任何对象上的所有循环？

以[TJ Holowaychuk](https://github.com/visionmedia)的[should.js](https://github.com/visionmedia/should.js)为例。他[添加了一个简单的吸气剂](https://github.com/visionmedia/should.js#omg-it-extends-object)，`Object`一切正常（[来源](https://github.com/visionmedia/should.js/blob/master/lib/should.js#L66-78)）。

```
Object.defineProperty(Object.prototype, 'should', {
  set: function(){},
  get: function(){
    return new Assertion(Object(this).valueOf());
  },
  configurable: true
}); 
```

这真的很有意义。例如，可以扩展`Array`.

```
Array.defineProperty(Array.prototype, "remove", {
  set: function(){},
  get: function(){
    return removeArrayElement.bind(this);
  }
});
var arr = [0, 1, 2, 3, 4];
arr.remove(3); 
```

是否有反对扩展本机类型的论据？

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2012-12-25T21:51:19.463

当你扩展一个对象时，你改变了它的行为。

更改仅由您自己的代码使用的对象的行为很好。但是，当您更改其他代码也使用的某些内容的行为时，您可能会破坏其他代码。

在 javascript 中向对象和数组类添加方法时，由于 javascript 的工作方式，破坏某些东西的风险非常高。多年的经验告诉我，这种东西会导致 javascript 中出现各种可怕的错误。

如果您需要自定义行为，最好定义自己的类（可能是子类）而不是更改原生类。这样你就不会破坏任何东西。

在不继承类的情况下改变类的工作方式的能力是任何好的编程语言的一个重要特性，但它必须很少使用并且必须谨慎使用。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-12-26T04:24:10.690

没有可衡量的缺点，例如性能下降。至少没有人提到任何。所以这是个人喜好和经验的问题。

**主要的专业论点：**它看起来更好，更直观：语法糖。它是一个特定于类型/实例的函数，因此它应该专门绑定到该类型/实例。

**主要的反对论点：**代码可以干扰。如果 lib A 添加一个函数，它可能会覆盖 lib B 的函数。这可以很容易地破坏代码。

两者都有道理。当您依赖两个直接更改您的类型的库时，您很可能最终会收到损坏的代码，因为预期的功能可能不一样。我完全同意这一点。宏库不得操纵本机类型。否则，作为开发人员，您将永远不知道幕后究竟发生了什么。

这就是我不喜欢 jQuery、下划线等库的原因。不要误会我的意思；它们绝对是经过精心编程的，它们工作起来就像一个魅力，但它们*很大*。你只使用了其中的 10%，并且了解了大约 1%。

这就是为什么我更喜欢[原子方法](https://github.com/component)，你只需要你真正需要的东西。这样，你总是知道会发生什么。微型图书馆只做你想让他们做的事情，所以他们不会干涉。在让最终用户知道添加了哪些功能的情况下，扩展本机类型可以被认为是安全的。

**TL;DR**如有疑问，请不要扩展本机类型。仅在您 100% 确定最终用户会知道并想要该行为的情况下扩展本机类型。在*任何*情况下都不能操纵本机类型的现有功能，因为它会破坏现有接口。

如果您决定扩展类型，请使用[`Object.defineProperty(obj, prop, desc)`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty); [如果不能](https://kangax.github.io/compat-table/es5/)，请使用类型的`prototype`.

* * *

我最初提出这个问题是因为我希望`Error`s 可以通过 JSON 发送。所以，我需要一种方法来对它们进行字符串化。`error.stringify()`感觉比`errorlib.stringify(error)`; 正如第二个结构所暗示的那样，我是在对自己进行操作，`errorlib`而不是对`error`自己进行操作。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-12-25T22:26:09.653

在我看来，这是一个不好的做法。主要原因是整合。引用 should.js 文档：

> 天哪，它扩展了对象？？？！？！@是的，是的，它确实，只有一个吸气剂应该，不，它不会破坏你的代码

那么，作者怎么会知道呢？如果我的模拟框架做同样的事情怎么办？如果我的 promises lib 也一样怎么办？

如果您在自己的项目中这样做，那很好。但是对于图书馆来说，这是一个糟糕的设计。Underscore.js 是正确完成事情的一个例子：

```
var arr = [];
_(arr).flatten()
// or: _.flatten(arr)
// NOT: arr.flatten() 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2015-07-16T17:57:23.580

> 如果您逐个查看它，也许某些实现是可以接受的。

```
String.prototype.slice = function slice( me ){
  return me;
}; // Definite risk. 
```

覆盖已经创建的方法会产生比它解决的问题更多的问题，这就是为什么在许多编程语言中通常声明要避免这种做法。开发人员如何知道功能已更改？

```
String.prototype.capitalize = function capitalize(){
  return this.charAt(0).toUpperCase() + this.slice(1);
}; // A little less risk. 
```

在这种情况下，我们不会覆盖任何已知的核心 JS 方法，而是扩展 String。这篇文章中的一个论点提到了新开发者如何知道这个方法是否是核心 JS 的一部分，或者在哪里可以找到文档？如果核心 JS String 对象获得一个名为**capitalize**的方法会发生什么？

如果不是添加可能与其他库冲突的名称，而是使用所有开发人员都能理解的公司/应用特定修饰符，该怎么办？

```
String.prototype.weCapitalize = function weCapitalize(){
  return this.charAt(0).toUpperCase() + this.slice(1);
}; // marginal risk.

var myString = "hello to you.";
myString.weCapitalize();
// => Hello to you. 
```

如果您继续扩展其他对象，所有开发人员都会在野外遇到它们（在这种情况下）**we**，这会通知他们这是一个公司/应用程序特定的扩展。

这并不能消除名称冲突，但确实减少了这种可能性。如果您确定扩展核心 JS 对象适合您和/或您的团队，也许这适合您。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-10-01T16:03:42.393

**扩展内置的原型确实是个坏主意。**但是，ES2015 引入了一种新技术，可用于获得所需的行为：

# 利用`WeakMap`s 将类型与内置原型相关联

以下实现扩展了`Number`和`Array`原型，而根本不涉及它们：

```
// new types

const AddMonoid = {
  empty: () => 0,
  concat: (x, y) => x + y,
};

const ArrayMonoid = {
  empty: () => [],
  concat: (acc, x) => acc.concat(x),
};

const ArrayFold = {
  reduce: xs => xs.reduce(
   type(xs[0]).monoid.concat,
   type(xs[0]).monoid.empty()
)};

// the WeakMap that associates types to prototpyes

types = new WeakMap();

types.set(Number.prototype, {
  monoid: AddMonoid
});

types.set(Array.prototype, {
  monoid: ArrayMonoid,
  fold: ArrayFold
});

// auxiliary helpers to apply functions of the extended prototypes

const genericType = map => o => map.get(o.constructor.prototype);
const type = genericType(types);

// mock data

xs = [1,2,3,4,5];
ys = [[1],[2],[3],[4],[5]];

// and run

console.log("reducing an Array of Numbers:", ArrayFold.reduce(xs) );
console.log("reducing an Array of Arrays:", ArrayFold.reduce(ys) );
console.log("built-ins are unmodified:", Array.prototype.empty);
```

正如您所见，即使是原始原型也可以通过这种技术进行扩展。它使用映射结构和`Object`标识将类型与内置原型相关联。

我的示例启用了一个`reduce`仅期望 an`Array`作为其单个参数的函数，因为它可以从数组本身的元素中提取如何创建空累加器以及如何将元素与该累加器连接的信息。

请注意，我可以使用普通`Map`类型，因为当弱引用仅表示内置原型时，它们没有意义，这些原型永远不会被垃圾收集。但是，`WeakMap`除非您拥有正确的密钥，否则 a 不可迭代且无法检查。这是一个理想的功能，因为我想避免任何形式的类型反射。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2018-05-02T11:51:27.810

**不应**扩展本机对象的另一个原因：

我们使用 Magento，它使用*prototype.js*并在原生对象上扩展了很多东西。在您决定加入新功能之前，这很好用，这就是大麻烦开始的地方。

我们在其中一个页面上引入了 Webcomponents，因此 webcomponents-lite.js 决定替换 IE 中的整个（本机）事件对象（为什么？）。这当然会破坏*prototype.js*，从而破坏Magento。（在你发现问题之前，你可能会花费大量时间来追溯它）

如果您喜欢麻烦，请继续这样做！

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-12-29T18:59:46.593

我可以看到三个不这样做的原因（至少在*应用程序中），其中只有两个在现有答案中得到解决：*

1.  如果你做错了，你会不小心给扩展类型的所有对象添加一个可枚举的属性。使用 轻松解决[`Object.defineProperty`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty)，默认情况下会创建不可枚举的属性。
2.  您可能会与您正在使用的库发生冲突。可以通过勤奋避免；只需在向原型添加内容之前检查您使用的库定义的方法，升级时检查发行说明并测试您的应用程序。
3.  您可能会导致与本机 JavaScript 环境的未来版本发生冲突。

第 3 点可以说是最重要的一点。您可以通过测试确保您的原型扩展不会与您使用的库造成任何冲突，因为*您*决定使用哪些库。假设您的代码在浏览器中运行，本机对象并非如此。如果您定义`Array.prototype.swizzle(foo, bar)`今天，明天 Google 添加`Array.prototype.swizzle(bar, foo)`到 Chrome，您最终可能会遇到一些困惑的同事，他们想知道为什么`.swizzle`的行为似乎与 MDN 上记录的内容不符。

（另请参阅[mootools 对他们不拥有的原型的摆弄如何迫使 ES6 方法重命名以避免破坏网络的故事](https://bugzilla.mozilla.org/show_bug.cgi?id=1075059)。）

这可以通过对添加到本机对象的方法使用特定于应用程序的前缀来避免（例如，用定义`Array.prototype.myappSwizzle`而不是`Array.prototype.swizzle`），但这有点难看；它也可以通过使用独立的实用函数而不是增加原型来解决。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-11-03T03:38:36.573

性能也是一个原因。有时您可能需要遍历键。做这件事有很多种方法

```
for (let key in object) { ... }
for (let key in object) { if (object.hasOwnProperty(key) { ... } }
for (let key of Object.keys(object)) { ... } 
```

我通常使用`for of Object.keys()`它做正确的事情并且相对简洁，无需添加检查。

但是，[它要慢得多](https://jsperf.com/for-in-vs-for-of-keys/1)。

[![for-of vs for-in 性能结果](../Images/5d8cd79413da0e7bfd97f99b1a944c2f.png)](https://i.stack.imgur.com/onF0B.png)

只是猜测原因`Object.keys`很慢很明显，`Object.keys()`必须进行分配。事实上，AFAIK 它必须分配所有密钥的副本。

```
 const before = Object.keys(object);
  object.newProp = true;
  const after = Object.keys(object);

  before.join('') !== after.join('') 
```

JS 引擎可能会使用某种不可变键结构，以便`Object.keys(object)`返回一个引用，该引用迭代不可变键并`object.newProp`创建一个全新的不可变键对象，但无论如何，它显然会慢 15 倍

甚至检查`hasOwnProperty`速度也慢了 2 倍。

所有这一切的重点是，如果您有性能敏感的代码并且需要遍历键，那么您希望能够使用`for in`而无需调用`hasOwnProperty`. 只有在未修改的情况下才能执行此操作`Object.prototype`

请注意，如果您使用`Object.defineProperty`修改原型，如果您添加的东西不可枚举，那么它们不会影响 JavaScript 在上述情况下的行为。不幸的是，至少在 Chrome 83 中，它们确实会影响性能。

[![在此处输入图像描述](../Images/a057d96790c32ab4c4490dc30a7b906a.png)](https://i.stack.imgur.com/ad9gs.png)

我添加了 3000 个不可枚举的属性，只是为了试图强制出现任何性能问题。只有 30 个属性，测试太接近了，无法判断是否有任何性能影响。

[https://jsperf.com/does-adding-non-enumerable-properties-affect-perf](https://jsperf.com/does-adding-non-enumerable-properties-affect-perf)

Firefox 77 和 Safari 13.1 显示增强和未增强类之间的性能没有差异，也许 v8 将在这方面得到修复，您可以忽略性能问题。

但是，让我也补充一下，还有[一个故事`Array.prototype.smoosh`](https://developers.google.com/web/updates/2018/03/smooshgate)。简短的版本是 Mootools，一个流行的库，他们自己制作了`Array.prototype.flatten`. 当标准委员会试图添加本地人`Array.prototype.flatten`时，他们发现不能不破坏很多网站。发现中断的开发人员建议将 es5 方法命名`smoosh`为一个笑话，但人们吓坏了，不明白这是个笑话。他们决定`flat`而不是`flatten`

这个故事的寓意是你不应该扩展原生对象。如果你这样做了，你可能会遇到同样的问题，除非你的特定库碰巧像 MooTools 一样受欢迎，否则浏览器供应商不太可能解决你造成的问题。如果您的库确实如此受欢迎，那么强迫其他人解决您引起的问题将是一种卑鄙的做法。所以，请**不要扩展本机对象**

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-02T12:17:13.883

**编辑：**

一段时间后我改变了主意 -**原型污染很糟糕**（但是我在帖子末尾留下了示例）。

它可能会导致比上面和下面的帖子中提到的更多的麻烦。

**在整个 JS/TS 领域拥有单一标准很重要（拥有一致的 npmjs 会很好）。**

以前我写过 Bull**it 并鼓励人们在他们的库中这样做 - 对此感到抱歉：

> [Jeff Clayton](https://stackoverflow.com/users/2246213/jeff-clayton) 的提议似乎也不错 - 方法名称前缀可以是您的包名称，后跟下划线，例如：（ `Array.prototype.<custom>_Flatten`不存在的包前缀可能会成为未来的现有包）

* * *

**部分原始答案：**

我个人在扩展本机方法，我只是`x`在我的库中使用前缀（在扩展 3rd 方库时也使用它）。

仅限 TS：

```
declare global {
  interface Array<T> {
    xFlatten(): ExtractArrayItemsRecursive<T>;
  }
} 
```

JS+TS：

```
Array.prototype.xFlatten = function() { /*...*/ } 
```

# push-notification - Trigger.io 启用 Parse 导致 iOS 构建失败

> ID：14034183
> 
> 赞同：1
> 
> 时间：2012-12-25T21:40:17.680
> 
> 标签：push-notification, apple-push-notifications, trigger.io, parse-platform

在我的 trigger.io 应用程序的配置中启用`Parse`会导致构建过程在 70% 时失败。

这是日志的最后一点：

```
[INFO] [ 60%] TakingInstallLock
[INFO] [ 65%] PreflightingApplication
[INFO] [ 65%] InstallingEmbeddedProfile
[INFO] [ 70%] VerifyingApplication
[ERROR] Failed when running /path/to/forge-workspace/appname/.lib/fruitstrap: ------ Install phase ------ 
```

我还需要做些什么来让 Parse 工作吗？

我看到它不适用于通配符配置证书，但我没有使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T12:18:22.900

您的配置文件很可能没有启用推送通知。

请参阅 Parse 推送通知文档中的步骤 1-3：[https ://parse.com/tutorials/ios-push-notifications](https://parse.com/tutorials/ios-push-notifications)

# iphone - 无法填充 UITableView

> ID：14034185
> 
> 赞同：1
> 
> 时间：2012-12-25T21:40:20.783
> 
> 标签：iphone, objective-c, ios, uitableview

我在填充子类 UITableView 时遇到问题。

我得到的只是一个空白屏幕。

它被嵌入到 a`UIView`中（`UITableViewDelegate`并`UITableViewDataSource`设置在 中`UITableViewController.h`）：

```
 TableViewController *tableView = [[TableViewController alloc] 
                                     initWithStyle:UITableViewStyleGrouped];
    tableView.view.frame = CGRectMake(0.0, 50.0, 320.0, 
                           self.view.bounds.size.height);
    tableView.tableView.dataSource = tableView;
    tableView.tableView.delegate = tableView;
    [self.view addSubview:tableView.view]; 
```

* * *

然后，在 UITableViewController 我创建一个虚拟数组用作数据源：

```
library = [[NSArray alloc] initWithObjects:
                    @"Dummy 1",
                    @"Dummy 2",
                    @"Dummy 3",
                    @"Dummy 4", nil]; 
```

* * *

然后我执行所需的数据源委托方法，如下所示：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 2;
} 
```

* * *

```
- (NSInteger)tableView:(UITableView *)tableView 
                       numberOfRowsInSection:(NSInteger)section
{
    int rows;
    if (section == 0) {
        rows = [library count];
    }
    else if (section == 1) {
        rows = 0;
    }
    return rows;
 } 
```

* * *

```
- (NSString *)tableView:(UITableView *)tableView 
                        titleForHeaderInSection:(NSInteger)section {
    if(section == 0) {
        return [NSString stringWithFormat:@"Missions Library"];
    }
    else {
         return [NSString stringWithFormat:@"Acknowledgements"];
    }
} 
```

* * *

```
- (UITableViewCell *)tableView:(UITableView *)tableView 
                                   cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellId = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellId 
                                       forIndexPath:indexPath];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault 
                                        reuseIdentifier:CellId];
    }

    cell.textLabel.text = [library objectAtIndex:indexPath.row];
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

    return cell;
} 
```

我已经阅读了许多表格视图教程，但我无法弄清楚问题所在。我没有收到错误消息，只是一个空白的表格视图屏幕。

我做错了什么？

**几个更新：**

1.  如果我不将 tableView 的视图添加为子视图而是直接调用它，我会显示页眉和页脚，但不会显示单元格。

2.  cellForRowAtIndexPath 方法根本没有被调用（我用 NSLog 检查过）。这解释了为什么我没有得到细胞。

3.  整个练习是有一个只占据屏幕下部的分组表格视图。但我的方法可能不是实现这一目标的最佳方法......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T22:21:02.777

我认为这里的问题是您的库数组正在加载对象，但 UITableView 实例本身没有得到通知（通过 reloadData）。另外，请记住，调用

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellId 
                                    forIndexPath:indexPath]; 
```

确保您将获得一个单元格，因此无需：

```
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault 
                                     reuseIdentifier:CellId];
} 
```

只要标识符在情节提要中正确设置。

我可能是错的，但我需要知道数据填充发生在哪里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-25T22:29:23.940

看起来您缺少 [self.tableView reloadData]。

另外，如果您支持 ios 6.0+，请使用该方法

```
registerClass:forCellReuseIdentifier: 
```

当你设置你的 UITableView 时。这将确保

```
dequeueReusableCellWithIdentifier 
```

返回一个单元格，而不是 nil，因此您不必执行 if (cell == nil) 检查。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-26T02:45:15.047

您不需要使用 TableViewController。只需添加一个 UITableView。

从...开始：

```
UITableView *tableData; 
```

然后是填充表格并将其添加为子视图的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-25T23:25:38.187

如果您将 tableview 添加到 UIViewController，您希望添加 UITableView 而不是 UITableViewController。

# scala - Play Framework 2.1 + ReactiveMongo - 填充多个下拉列表

> ID：14034188
> 
> 赞同：4
> 
> 时间：2012-12-25T21:40:55.670
> 
> 标签：scala, mongodb, playframework, playframework-2.0, playframework-2.1

我有一个带有多个下拉列表的表单，我使用这些下拉列表`select`和`options`模板中的助手。应填充列表的实体取自数据库。但是，从数据库中检索是异步的，所以我应该`Async`在操作中使用，如本[例所示](http://stephane.godbillon.com/2012/10/18/writing-a-simple-app-with-reactivemongo-and-play-framework-pt-1.html "例子")。但是，就我而言，我应该等待的不是一个`find`操作，而是一个未知大小`Seq`的`Future`对象。那么如何`Future`在渲染页面之前等待多个 -s 来准备列表呢？或者也许有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T04:18:28.957

如果你没有一个很好的方法来组合它们，Scala 期货将一文不值。

如果您有一个未来对象序列，您可以将其转换为序列的未来：

```
val futureList = Future.sequence(listOfFutures) 
```

所以现在你有一个单一的未来要处理。有关以各种方式组合期货的其他一些有用功能，请参阅有关[未来伴侣对象的文档。](http://www.scala-lang.org/archives/downloads/distrib/files/nightly/docs/library/index.html#scala.concurrent.Future$)

如果您对使用期货的其他方式感到好奇（例如，由于它们的一元性质，您甚至可以使用简单的 for-comprehansion 将它们组合起来），您可能需要查看[Scala 期货入门以](http://doc.akka.io/docs/akka/2.1.0/scala/futures.html)获得更多见解。

此外，如果您正在使用 ReactiveMongo，那么绝对值得查看有关 Play 2.x 的[Enumerator/Iteratee 实现的文档。](http://www.playframework.org/documentation/2.0.4/Iteratees)如果您掌握了这种方法，您将能够即时组合您的反应性数据流等等，创造真正的魔力。

# php - PHP 搜索 SEO 优化与 url 重写

> ID：14034189
> 
> 赞同：0
> 
> 时间：2012-12-25T21:40:58.210
> 
> 标签：php, forms, mod-rewrite

嘿家伙可以告诉我如何使我的搜索按钮与 url 重写，因为它不酷我的整个网站是 url 重写和搜索是 /Articles/Search/?s=...... 这是我的表格：

```
<form action="Articles/Search/" method="get">
<input type="text" value="Търси" name="s" id="keyword" title="s" onfocus="clearText(this)" onblur="clearText(this)" class="txt_field" />
<input type="submit" value="" id="searchbutton" title="Търси" class="sub_btn" /></form> 
```

我想喜欢：/Articles/Search/keyword1-keyword2/ 我可以交换空格。如果它没有用 php 转发就好了，也许 js

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T21:51:58.160

保持搜索表单 URI“SEO 优化”的最直接方法是（尽管不像您在第一步中概述的那样）从`GET`方法切换到`POST`方法：

```
<form action="Articles/Search/" method="post"> 
```

接下来，您可以提供您自己的一组 URI，这些 URI 将与您网站的搜索功能一起使用，就像您已经通过 URI 提供的任何其他参数一样：

```
http://example.com/keywords/keyword1/keyword2/ 
```

然后`keywords`控制器可以启动搜索，所有参数空间分开或类似。这在一定程度上取决于您使用哪种 URL 重写。因此，您需要根据您的具体需求采用它，但这应该很容易，因为您已经为网站的其余部分做到了这一点。

# linux - bash - 不包括“for file in $(find ...)”中的目录

> ID：14034190
> 
> 赞同：4
> 
> 时间：2012-12-25T21:41:02.830
> 
> 标签：linux, bash, for-loop, find, backup

我必须编写一个脚本，将所有 *.txt 文件从主目录复制到该脚本的第一个参数 (${1}) 中指定的新创建目录。

如果备份目录已经存在，我想跳过它。我正在尝试在 find 中排除 -prune ，但它对我不起作用。最后我在循环中做了if语句，这也不起作用，我不知道为什么......谢谢帮助！

这是我的代码：

```
#!/bin/bash

mkdir ${1}

for file in $(find ~/ -name *.txt)

do

    if [ ! -f ~/${1}/$file ]
    then
        cp -i -v $file -t ~/${1}
    fi

done 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:30:10.603

这应该这样做：

```
#!/bin/bash

[[ -n "$1" ]] || { echo >&2 'Give me an argument!'; exit 1; }

destdir=$(readlink -m -- "$1")

[[ "$destdir" == *\** ]] && { echo >&2 "Sorry, I'm in the stupid situation where the destination dir contains the \`*' character. I can't handle this."; exit 1; }

mkdir -pv -- "$destdir" || { echo >&2 "Couldn't create directory \`$destdir'. Sorry."; exit 1; }

find "$HOME" -path "$destdir" -prune -o \( -name '*.txt' -exec cp -iv -t "$destdir" -- {} \; \) 
```

Pro：适用于名称中包含空格或有趣符号的文件（与您的不同）（除了一种愚蠢的情况，请参见下面的*Con*）。

缺点：正如 ormaaj 在评论中指出的那样，如果目标路径的名称包含模式字符，这可能会失败`*`。安全地考虑了这种情况，如果发生这种情况，脚本会优雅地退出。

**解释。**

*   给那个脚本一个参数。它可以是相对于当前目录的绝对值。`readlink`, 使用该`-m`选项会注意将其转换为绝对路径：这就是变量`destdir`.
*   如果适用，该目录`$destdir`与其父目录一起创建。
*   在主目录中，如果我们找到`$destdir`目录，我们会修剪这个分支，否则，我们会查找所有`*.txt`文件并将它们复制到`$destdir`.

再一次，这个脚本对于带有有趣符号的文件名是 100% 安全的：空格、换行符或连字符，除了`*`目标目录名称中的模式字符，但这种情况可以通过优雅的退出安全地处理，而不是潜在地搞砸文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:00:43.200

您可以将其简化为

```
mkdir -p "$1"
find ~/ -name "$1" -prune , -name '*.txt' -print0 | xargs -0 cp -n -v -t "$1" 
```

您必须引用`*.txt`，否则 shell 会将其扩展到`.txt`当前目录中的所有文件，而不是搜索`.txt`您的主目录下的所有文件。`-name "$1" -prune`不包括备份目录。

[`xargs`](http://linux.die.net/man/1/xargs)调用[`cp`](http://linux.die.net/man/1/cp)尽可能多的文件名，从而节省大量时间。

`cp -n`而不是`cp -i`防止覆盖已经存在的文件。如果你想保留它，你当然可以`-n`替换`-i`。

如果您想保留目录层次结构，[rsync](http://rsync.samba.org/)可能更适合此备份任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T21:47:01.920

您的代码中有错误，您正在创建目录：

```
mkdir ${1} 
```

但是复制和测试不同的路径（`-f ~/${1}/$file`，`-t ~/${1}`）。创建一个变量以防止此类错误：

```
#!/bin/bash
dest=~/${1}
[ -d "$dest" ] || mkdir "$dest"
SAVEIFS=$IFS
IFS=$(echo -en "\n\b")
for file in $(find ~/ -name '*.txt' -print)
do
  dfile="$dest/"$(basename "$file")
  if [ "$file" -ef "$dfile" ]; then
    echo same
  else
    cp -i -v "$file" -t "$dfile"
  fi  
done
IFS=$SAVEIFS 
```

# c++ - 如何获得表示未定义值C++？

> ID：14034191
> 
> 赞同：-3
> 
> 时间：2012-12-25T21:41:05.543
> 
> 标签：c++, undefined

我有计算两个斜率并比较它们的代码，如果它们相同，我会得到它们的值。

但是，如果未定义一个斜率，程序就会崩溃。我需要知道它们是否相同，即使它们未定义。我不能使用任何其他负整数或正整数，因为这会在很大程度上弄乱我的代码。

我更喜欢单词值，例如 5/0 = undefined，但不确定我该怎么做。

例如：

```
#include <iostream>
using namespace std;

int r = 5/0;

int main()
{
    // Instead of crashing, this should tell me this value is undefined somehow.
    cout << r << endl;
    return 0;
} 
```

如果斜坡完全垂直，我该如何处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T21:50:02.283

您应该以始终定义的方式（例如角度）来表示坡度。如果您的程序中有另一个步骤由于数学原因未定义结果，您可以引发异常。

同样为了从向量 x,y 获取角度，您应该使用 atan2 [http://en.cppreference.com/w/cpp/numeric/math/atan2](http://en.cppreference.com/w/cpp/numeric/math/atan2)

```
 double theta = atan2(y,x) ; // this is always fine 
```

比较由向量 x1,y1 和 x2,y2 定义的两个角度：

```
double th1 = atan2(y1,x1) 
double th2 = atan2(y1,x1) 

const double mypi=3.141592653589793238463;

double angleDiff = pi - abs(abs(th1 - th2) - pi); 

if(angleDiff*10<=mypi){
    cout << " angles are within 0.1 pi (that is 18 degr) <<endl; 
} 
```

还要记住，在比较浮点值时，除了少数特殊情况外，您不应期望*完全匹配。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-11T07:49:29.120

我知道这个问题已经很老了，但是当我试图解决一个几乎相同的问题时，我决定发布一个答案。

我建议一种方法是使用空指针来识别未定义的值。在我的情况下，使用角度是非常不准确的，因为我使用的是 gmp（gnu 多精度库），我需要完美的精度来处理从 64 位开始的巨大位大小并不断攀升。

浮点根本不会削减它。

正如我所看到的，您有两种选择，一个标志要与检索斜率分开进行测试，或者在检索斜率后进行测试。我看不到不涉及抛出异常的替代方案

```
class line {
    bool vertical;
    bignum slope;

    // one method two functions
    bool is_vertical(){return vertical;}
    bignum slope() {return slope}

    //alternative method 
    bignum *slope() {if (vertical) return NULL; else return &slope}
} 
```

大多数代码需要以与任何其他行不同的方式处理垂直线，因此在 if 语句中处理垂直线并不是一项繁重的任务

```
if ((slope = line.slope())==NULL){//vertical
    // do some vertical stuff 
    cout << "line is vertical";
} else {
    // do some other line stuff with bignum *slope
    cout "slope is " << *slope;
} 
```

# mysql - 管理 mysql 数据库上的可解锁项

> ID：14034193
> 
> 赞同：1
> 
> 时间：2012-12-25T21:41:09.253
> 
> 标签：mysql, database

那么我该怎么说呢，我正在处理一个用户数据库，每个用户都会有一些解锁能力。

所以我不确定管理这些数据的最佳方法是什么，我是否应该有一个包含每个可解锁对象和一个数量值的表，并将其链接到用户？或者，还有更好的方法？或者也许我可以使用 2 个数据库，一个用于用户，一个用于可解锁？

老实说，我认为我对它如何工作的想法并不是最好的，因为如果我有 1000 个可能的可解锁项，则每个用户都必须链接到具有 1000 个可能性的表。此外，如果我想添加新项目，我将不得不以这种方式更新大型数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T22:11:33.520

**编辑**

我的回答是一个非常糟糕的主意，它可以工作，但在关系数据库中被认为是一种不好的做法，因为您不想在一个字段中混搭项目，最好使用多个表来规范化。话虽如此，如果您使用的是 noSql，您可以使用我建议的方法，但您可以使用关联数组（json）结构来保存这些值，而不是使用连接字符串。

* * *

在您的用户表中，创建一个名为“unlockables”的列，或者您认为最好的列（将“text”作为数据类型），每次用户获得其中一个可解锁项时，您将其添加到此字段中，以分隔“*”或任何您想要的，如果这些可解锁物品也有数量，您还可以添加第二个分隔符，例如“ID+Quantity*ID+Quantity”，假设您有 3 个具有以下 ID 的物品 (12,45,89)和这个等量的数量（1,6,2），你像这样添加它（12+1*45+6*89+2）然后当你使用php检索这个值时你会爆炸字符串两次，首先使用“*” ，然后使用“+”，您将拥有一个包含数据的数组，您也可以为此创建第二个表，但这是您的选择，这只是满足您想要的快速方法，我希望这可以帮助你一点。

# php - 带过滤器的排名系统

> ID：14034199
> 
> 赞同：1
> 
> 时间：2012-12-25T21:42:50.173
> 
> 标签：php, javascript, jquery, mysql

我想根据人口为国家建立一个排名系统。但我想要的是我的排名过滤器。过滤器是 3 个下拉选择 html 标记：

1.  所有国家（以及下拉列表中的国家列表）
2.  所有地区（在选择国家时自动生成），以及
3.  所有时间（2 年、4 年、6 年）。

预期人口是根据数据库中的表格计算的。

问题是：为上面的每个过滤器计算总体并将其存储在一个表中是否更好？或者，当场计算并显示？我很困惑如何使系统工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T23:42:43.103

要直接回答您的问题，*通常*最好以最基本的形式存储数据，然后在呈现数据时执行任何操作。因此，在您的情况下，这将是**“当场计算并显示它们”**选项。

现在的服务器是如此之快，以至于动态计算几乎不会对性能造成明显影响，除非计算的计算量*非常大*。

如果您以最简单的形式存储数据 - 在这种情况下，只是原始人口数据 - 您可以通过更改逻辑（代码）以新的排列（例如新过滤器）显示数据，而不必更改或更新（迁移) 您的任何数据。

# r - 从截断的正态分布中高效生成随机数

> ID：14034200
> 
> 赞同：10
> 
> 时间：2012-12-25T21:43:05.253
> 
> 标签：r, random-sample

我想从平均值 = 0 和 sd -1 的正态分布中抽取 50,000 个值。但我想将值限制为 [-3,3]。我已经编写了代码来执行此操作，但不确定它是否最有效？希望能得到一些建议。

```
lower <- -3 
upper <- 3
x_norm<-rnorm(75000,0,1)
x_norm<-x_norm[which(x_norm >=lower & x_norm<=upper)]
repeat{
    x_norm<-c(x_norm, rnorm(10000,0,1))
    x_norm<-x_norm[which(x_norm >=lower & x_norm<=upper)]
    if(length(x_norm) >= 50000){break}
}
x_norm<-x_norm[1:50000] 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-25T22:57:55.097

像你的代码这样的东西肯定会起作用，但你大大高估了你需要多少值。鉴于它是一个已知分布和相当多的样本，您知道有多少样本会出现多于或少于 3 个。

```
(1-pnorm(3))*2 * 50000
[1] 134.9898 
```

因此，鉴于您在 50,000 的平局中可能只得到约 135 超出范围，因此很容易再抽出几个，但仍然不是一个非常大的数字并对其进行修剪。只需取 50,500 个中小于或大于 3 的前 50,000 个。

```
x <- rnorm(50500)
x <- x[x < 3 & x > -3]
x <- x[1:50000] 
```

我运行了前 2 行 40,000 次，它每次返回的长度都大于 50000。一个小的布尔检查可以保证它总是这样。

```
x <- 1
while (length(x) < 50000){
    x <- rnorm(50500)
    x <- x[x < 3 & x > -3]}
x <- x[1:50000] 
```

对我来说，这在 6 毫秒内执行了几乎 100% 的时间。这是在 R 中执行此操作的一种简单方法，执行速度非常快，易于阅读，并且不需要附加组件。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-25T21:51:56.857

如果您*真的*关心效率，那么这段简短的 Rcpp 代码将很难被击败。将以下内容存储在文件中，例如`/tmp/rnormClamp.cpp`：

```
#include <Rcpp.h>

using namespace Rcpp;

// [[Rcpp::export]]
NumericVector rnormClamp(int N, int mi, int ma) {
    NumericVector X = rnorm(N, 0, 1);
    return clamp(mi, X, ma);
}

/*** R
  system.time(X <- rnormClamp(50000, -3, 3))
  summary(X)
*/ 
```

使用`sourceCpp()`（也来自[Rcpp](http://dirk.eddelbuettel.com/code/rcpp.html)）来构建和运行它。在我的计算机上实际绘制和夹紧大约需要 4 毫秒：

```
R> sourceCpp("/tmp/rnormClamp.cpp")

R>   system.time(X <- rnormClamp(50000, -3, 3))
   user  system elapsed 
  0.004   0.000   0.004 

R>   summary(X)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-3.00000 -0.67300 -0.00528  0.00122  0.68500  3.00000 
R> 
```

`clamp()`糖函数在 Romain 之前的 SO 回答中得到了介绍，[其中](https://stackoverflow.com/a/13870367/143305)还指出您需要 Rcpp 的 0.10.2 版。

**编辑：**根据 Ben 的提示，我似乎误解了。这是 C++ 和 R 的混合：

```
// [[Rcpp::export]]
List rnormSelect(int N, int mi, int ma) {
  RNGScope scope;
  int N2 = N * 1.25;
  NumericVector X = rnorm(N2, 0, 1);
  LogicalVector ind = (X < mi) | (X > ma);
  return List::create(X, ind);
} 
```

哪个可以附加到较早的文件。然后：

```
R>   system.time({ Z <- rnormSelect(50000, -3, 3); 
+                  X <- Z[[1]][ ! Z[[2]] ]; X <- X[1:50000]})
   user  system elapsed 
  0.008   0.000   0.009 

R>   summary(X)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-3.00000 -0.68200 -0.00066 -0.00276  0.66800  3.00000 
R> 
```

我将重新讨论我必须查找的逻辑索引和行子集。明天吧。但是 9 毫秒仍然不算太糟糕 :)

**编辑2：**看起来我们真的没有逻辑索引。我们必须添加这个。这个版本是“手动”完成的，但并不比从 R 中索引快多少：

```
// [[Rcpp::export]]
NumericVector rnormSelect2(int N, int mi, int ma) {
  RNGScope scope;
  int N2 = N * 1.25;
  NumericVector X = rnorm(N2, 0, 1);
  LogicalVector ind = (X >= mi) & (X <= ma);
  NumericVector Y(N);
  int k=0;
  for (int i=0; i<N2 & k<N; i++) {
    if (ind[i]) Y(k++) = X(i);
  }
  return Y;
} 
```

和输出：

```
R>   system.time(X <- rnormSelect2(50000, -3, 3)) 
   user  system elapsed 
  0.004   0.000   0.007 

R>   summary(X)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-2.99000 -0.66900 -0.00258  0.00223  0.66700  2.99000 

R>   length(X)
[1] 50000
R> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-12-26T16:55:01.443

John 和 Dirk 给出了拒绝抽样的好例子，这对于给定的问题应该没问题。但要给出另一种方法，当您拥有累积分布函数及其逆函数（或其合理近似值）时，您可以从均匀分布生成数据并进行变换：

```
x <- qnorm( runif(50000, pnorm(-3), pnorm(3)) )
range(x)
hist(x) 
```

对于给定的问题，我不希望这比拒绝采样方法好得多（如果有的话），但是如果您想从截断的正常 0,1 生成 2 到 3 之间的数据，那么这种方法可能会很多更高效。它确实取决于累积及其倒数（在这种情况下为 pnorm 和 qnorm），因此不会像拒绝抽样那样简单，因为没有那些容易获得的分布。

# java - 动态 JSON 传递给 REST Web 服务并使用它将数据插入 mysql db

> ID：14034201
> 
> 赞同：1
> 
> 时间：2012-12-25T21:43:12.130
> 
> 标签：java, mysql, json, hibernate

我正在尝试将动态 JSON 字符串传递给我的 REST Web 服务，该服务又将用于填充 mysql 数据库。我可以使用硬编码的 JSON 字符串来做到这一点，但是我不知道如何传递动态 JSON 字符串。

如何检索通过 WebService 传入的参数，将其解析为 JSON，并将其保存到数据库中？

任何见解都值得赞赏，因为我对这个主题很陌生。我附上了用于硬编码 JSON 字符串解析并添加到 mysql 数据库的代码。

我的 StackService.java

```
import java.util.Date;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

import org.apache.log4j.Logger;
import org.hibernate.Session;

import com.google.gson.Gson;
import com.tracker.domain.Flow;
import com.tracker.persistence.HibernateUtil;
@Path("")
public class StackService {

    private Logger LOG = Logger.getLogger(StackService.class);

    /**
     * curl -X GET http://localhost:8080/stack
     */
    @GET
    @Path("")
    @Produces(MediaType.APPLICATION_JSON)
    public void getStock() {

        String stackJsonString = "{\"stack_name\":\"GOOG\",\"id\":null\"}";
        Gson gson = new Gson();
        Stack stock = gson.fromJson(stockJsonString, stock.class);
        Session session = HibernateUtil.getSessionFactory().getCurrentSession();

        String stockName = stock.getstock_name();
        stock.setstock_name(stockName);

        session.beginTransaction();
        session.save(stock);
        session.getTransaction().commit();

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T04:46:04.110

如果传递 json 参数是您的问题，那么您可以尝试使用 path 参数。

```
 @GET
    @Path("{jsonString}")
    @Produces(MediaType.APPLICATION_JSON)
    public void getStock(@PathParam("jsonString") String jsonString) {

        String stackJsonString = jsonString; 
```

但我建议您使用 post 方法，这会使其变得简单，但您应该在决定使用 post 之前考虑它是否是幂等操作。

# asp.net - 编码和网页和utf8？

> ID：14034202
> 
> 赞同：-1
> 
> 时间：2012-12-25T21:43:17.180
> 
> 标签：asp.net, .net, html, encoding, utf-8

*我已经知道 utf 是用于“我如何存储它”的，它有好处，因为它的长度可变，这对 web 很有用。*

**Q#1**

1）当我宣布

```
<meta http-equiv="Content-Type"    content="text/html; charset=utf-8" /> 
```

是为了

*   **html 文件本身是如何**存储在我的硬盘中的？

*   或者 - 应该**如何**将文档传输到客户端（文档中的每个字符都将作为 utf 8 字符下载？）

*   或者 - 当用户填写表单并提交时 -浏览器应**如何**将表单 input+html 中的每个字符传输到服务器

**Q#2**

2）如果 utf-8 可以包含所有内容，为什么我有时会看到`charset=windows-1255"`？为什么他们不总是使用`utf8`和玩得开心？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T00:08:47.727

Q1。元内容类型告诉浏览器如何解释从服务器接收到的字节。`meta`您可以将文件保存为标签指定的编码。服务器可能会在标头中设置字符集，`Content-Type`但这可能与实际文件不匹配，因为没有 100% 可靠的方法来检测文件的编码。无论字符集如何，文件的字节都以相同的方式传输。

根据[http://www.w3schools.com/tags/att_form_accept_charset.asp](http://www.w3schools.com/tags/att_form_accept_charset.asp)，页面的内容类型也会影响浏览器在从页面发布表单时用来编码数据的字符集。

Q2。好问题。我相信字符集仍然有很多误解，因此编码与开发人员定义的标头不匹配并不罕见。旧版应用程序可能无法编写 UTF-8。当 UTF-8 中的等效字符占用更多字节时，使用特定的 8 位字符集也可以节省一小部分字节。例如，欧元符号可以在 Windows-1252 中使用 8 位表示，但在 UTF-8 中则为 24 位

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T21:47:01.890

字符集的声明`Content-Type`是向客户端指示接收到的文本编码的字符集。客户端应该对文档采取适当的操作，无论使用什么编码，是否存储原始字节和字符集声明，或将文本解码为中性字符集，或诸如此类。

# query-string - html/javascript：锚链接查询字符串中的值长度限制或解决方法

> ID：14034205
> 
> 赞同：0
> 
> 时间：2012-12-25T21:44:01.700
> 
> 标签：query-string, anchor, limit

我有一个 ajax 脚本正在运行，它允许用户搜索 dbase 联系人表，然后单击他们想要通过电子邮件向其发送一些文本的联系人。将文本发送给联系人的链接只是结果中的锚链接，文本作为 url 中的变量传递。然后在服务器端，服务器将文本通过电子邮件发送到联系人的电子邮件地址。

我遇到的问题是，如果文本超过一定长度而不是隐藏在 url 中，它就会在页面上可见。然后脚本不再正常工作。起初，我认为问题可能是由于文本中的一个特殊字符破坏了锚链接的 url，但似乎并非如此......这只是长度问题。

我找到了这个[帖子](https://stackoverflow.com/questions/3091485/what-is-the-limit-on-querystring-get-url-parameters)

这表示查询字符串不应该有限制。但是，在我的情况下，甚至在尝试提交查询字符​​串之前就出现了问题，因为它从 url 中弹出并在页面上可见。因为它在一个去服务器的 url 中，所以我想不出一种在 url 之外传递冗长文本值的好方法，

有没有人遇到过这个问题，如果有，你能建议一个解决方法吗？

这是示例。

```
a href="sendemail.php?contactid=33&text=HERE IS SOME SHORT TEXT">Send to Harry</a> //works

a href="sendemail.php?contactid=33&text=HERE IS SOME REALLY LONG TEXT THAT GOES ON AND ON.....ON AND ON.... ON AND ON....ON AND ON....PAST A FEW HUNDRED CHARACERS">Send to Harry</a>  // "HERE IS SOME REALLY LONG TEXT etc." IS VISibLE ON PAGE 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T21:55:02.490

在这个 jsfiddle 中测试你的两个链接：http: [//jsfiddle.net/rzj6n/](http://jsfiddle.net/rzj6n/)一切都很好，你的问题必须在其他地方。

但是，如果您想避免很长的查询字符串，您可能需要使用表单来发布数据，而不是使用 GET。

```
<form action="sendemail.php" method="POST">
    <input type="hidden" name="contactid" value="33" />
    <input type="hidden" name="text" value="here is some text..." />
    <input type="submit" value="Send to Harry" />
</form> 
```

然后您将需要使用`$_POST['contactid']`and访问传递的值`$_POST['text']`

# c++ - 将键码的字符串表示形式转换为 Qt::Key （或任何 int）并返回

> ID：14034209
> 
> 赞同：8
> 
> 时间：2012-12-25T21:44:33.030
> 
> 标签：c++, qt, type-conversion, string-parsing, keycode

我想将表示键盘上的键的字符串转换为键码枚举，如[Qt::Key](http://doc.qt.digia.com/4.7/qt.html#Key-enum)（或其他任何东西）。示例转换为：

*   `"Ctrl"`至`Qt::Key_Control`
*   `"Up"`至`Qt::Key_Up`
*   `"a"`至`Qt::Key_A`
*   `"5"`至`Qt::Key_5`

如您所见，上面不仅包括字母数字键，还包括修饰符和特殊键。我没有附加到 Qt 键码枚举，但似乎 Qt 在`QKeySequence`的`fromString`静态函数中具有此解析功能（请参阅[此直接链接](http://qt-project.org/doc/qt-4.8/qkeysequence.html#fromString)）：

```
QKeySequence fromString(const QString & str, SequenceFormat format); 
```

你可能是我需要这种转换的原因。好吧，我有一个由[GhostMouse](http://www.ghost-mouse.com)生成的数据文件。这是我输入的日志。这是我输入的示例`" It "`：

```
{SPACE down}
{Delay 0.08}
{SPACE up}
{Delay 2.25}
{SHIFT down}
{Delay 0.11}
{i down}
{Delay 0.02}
{SHIFT up}
{Delay 0.03}
{i up}
{Delay 0.05}
{t down}
{Delay 0.08}
{t up}
{Delay 0.05}
{SPACE down}
{Delay 0.12}
{SPACE up} 
```

所以我需要一种方法来将字符串“SPACE”和表示此数据文件中键的所有其他字符串转换为唯一的`int`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-25T22:00:28.117

您已经在正确的轨道上查看`QKeySequence`，因为这可用于在字符串和键代码之间进行转换：

```
QKeySequence seq = QKeySequence("SPACE");
qDebug() << seq.count(); // 1

// If the sequence contained more than one key, you
// could loop over them. But there is only one here.
uint keyCode = seq[0]; 
bool isSpace = keyCode==Qt::Key_Space;
qDebug() << keyCode << isSpace;  // 32 true

QString keyStr = seq.toString().toUpper();
qDebug() << keyStr;  // "SPACE" 
```

**由 OP 添加**

以上不支持修饰键，例如 Ctrl、Alt、Shift 等。不幸的是，`QKeySequence`不将`Ctrl`键本身确认为键。因此，要支持修饰键，您必须使用“+”号拆分字符串表示，然后分别处理每个子字符串。以下是完整的功能：

```
QVector<int> EmoKey::splitKeys(const QString &comb)
{
    QVector<int> keys;
    const auto keyList = comb.split('+');
    for (const auto &key: keyList) {
        if (0 == key.compare("Alt", Qt::CaseInsensitive)) {
            keys << Qt::Key_Alt;
        } else if (0 == key.compare("Ctrl", Qt::CaseInsensitive)) {
            keys << Qt::Key_Control;
        } else if (0 == key.compare("Shift", Qt::CaseInsensitive)) {
            keys << Qt::Key_Shift;
        } else if (0 == key.compare("Meta", Qt::CaseInsensitive)) {
            keys << Qt::Key_Meta;
        } else {
            const QKeySequence keySeq(key);
            if (1 == keySeq.count()) {
                keys << keySeq[0];
            }
        }
    }
    return keys;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-12T15:07:43.127

在一行中，尝试一下：

```
qDebug() << QKeySequence(event->modifiers()+event->key()).toString() << '\n'; 
```

首先我调用 QKeySequence 构造函数，然后使用 toString() 将其转换为字符串。

输出（最后一个是 windows 键）：

```
"Alt+??"

"Alt+A"

"Alt+A"

"Alt+A"

"A"

"S"

"F1"

"F2"

"Home"

"Ins"

"Num+8"

"Num+5"

"Num+4"

"Num+."

"Num++"

"Num+-"

"Num+/"

"Num+*"

"??" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-25T22:01:16.257

大部分键码都可以恢复，比如`QKeySequence::fromString("SPACE")[0]`返回32。对Shift、Ctrl等无效，需要自己处理一些字符串。

# c++ - C++ 类（组合和继承 - 头文件、类数组）

> ID：14034217
> 
> 赞同：1
> 
> 时间：2012-12-25T21:46:41.143
> 
> 标签：c++, class, inheritance, header-files, composition

我已经编写了 4 个头文件（类），其中 3 个类已成功编译（Customer、GoldCustomer 和 PlatinumCustomer）。GoldCustomer 和 PlatinumCustomer 是 Customer 的派生（继承），而有问题的 MovieTicket 类是所有其他 3 个类的组合。这是遵循强加的要求：显示继承和组合。

编译 MovieTicket 会给我这些错误。任何人都可以帮助检查和解释吗？似乎有重复的类声明（但从我在谷歌读到的内容，只要你把包含类的头文件放在头文件中，这个错误就不会出现）。另一件事是，我的类数组给出了错误......我不知道为什么

```
In file included from class_GoldCustomer.hpp:3:0, from class_MovieTicket.hpp:5:
class_Customer.hpp:11:7: error: redefinition of ‘class Customer’

In file included from class_MovieTicket.hpp:4:0: 
class_Customer.hpp:11:7: error: previous definition of ‘class Customer’

In file included from class_PlatinumCustomer.hpp:3:0, 
from class_MovieTicket.hpp:6:  class_Customer.hpp:11:7: 
error: redefinition of ‘class Customer’

In file included from class_MovieTicket.hpp:4:0: class_Customer.hpp:11:7: 
error: previous definition of ‘class Customer’

class_MovieTicket.hpp:29:22: error: expected ‘]’ before ‘;’ token
class_MovieTicket.hpp:29:25: error: expected unqualified-id before ‘]’ token
class_MovieTicket.hpp:32:26: error: expected ‘]’ before ‘;’ token
class_MovieTicket.hpp:32:29: error: expected unqualified-id before ‘]’ token
class_MovieTicket.hpp: In member function 
‘void MovieTicket::newMovie(int, std::string,     std::string, int, int, float)’:
class_MovieTicket.hpp:53:3: error: ‘ListGold’ was not declared in this scope
class_MovieTicket.hpp:53:12: error: expected ‘]’ before ‘;’ token
class_MovieTicket.hpp:53:15: error: expected primary-expression before ‘]’ token
class_MovieTicket.hpp:53:15: error: expected ‘;’ before ‘]’ token
class_MovieTicket.hpp:54:3: error: ‘ListPlat’ was not declared in this scope
class_MovieTicket.hpp:54:12: error: expected ‘]’ before ‘;’ token
class_MovieTicket.hpp:54:15: error: expected primary-expression before ‘]’ token
class_MovieTicket.hpp:54:15: error: expected ‘;’ before ‘]’ token
class_MovieTicket.hpp: In member function ‘void MovieTicket::Purchase()’:
class_MovieTicket.hpp:103:4: error: ‘ListGold’ was not declared in this scope
class_MovieTicket.hpp:108:4: error: ‘ListPlat’ was not declared in this scope
Compilation failed. 
```

以下是代码：

class_Customer.hpp

```
#include <iostream>
#include <string>

//header guard
#ifndef CUSTOMER_H
#define CUSTOMER_H

using namespace std; 

class Customer {

protected:
//data members
int id;
string type;
int sold;

//public:
//constructor and destructor
Customer(){
    type = "non member"; //default this customer class as 'non member'
    sold = 0;
}
~Customer(){}

//functions member
void setID(int inputID){ //set ID of the customer
    id = inputID;
}

int getSold(){ //get no. of sold
    return sold;
}

};
#endif[/CODE] 
```

class_GoldCustomer.hpp

```
#include <iostream>
#include <string>
#include "class_Customer.hpp"

using namespace std; 

//header guard
#ifndef GOLDCUSTOMER_H
#define GOLDCUSTOMER_H

class GoldMember : protected Customer{

private:
//data members
int gold_id;
int annual_fee;
float discount;

public:
//constructor and destructor
GoldMember(){
    type = "gold"; 
    sold = 0;
    annual_fee = 10;
    discount = 0.1;
}
~GoldMember(){}

//functions member
int getAnnualFee(){ //get annual fee
    return annual_fee;
}

float getDiscount(){ //get discount
    return discount;
}

};
#endif[/CODE] 
```

class_PlatinumCustomer.hpp

```
#include <iostream>
#include <string>
#include "class_Customer.hpp"

#define POINT 5; //how many ticket purchased needed to eligible for one free ticket

using namespace std; 

//header guard
#ifndef PLATINUMCUSTOMER_H
#define PLATINUMCUSTOMER_H

class PlatinumMember : protected Customer{

private:
//data members
int plat_id;
int annual_fee;
float discount;
int redeem_point = 0; //count the tickets purchased as 'points'

public:
//constructor and destructor
PlatinumMember(){
    type = "gold"; 
    sold = 0;
    annual_fee = 50;
    discount = 0.2;
    redeem_point = 0;
}
~PlatinumMember(){}

//functions member
int getAnnualFee(){ //get annual fee
    return annual_fee;
}

float getDiscount(){ //get discount
    return discount;
}

int getFRedeemPoint(){ //get redeem point
    return redeem_point;
}

int getFreeTicket(){ //get no. of free tickets based on redeem point
    int result;
    result = redeem_point/POINT;
    return result;
}

};
#endif[/CODE] 
```

最后编译失败：

class_MovieTicket.hpp

```
#include <iostream>
#include <string>

#include "class_Customer.hpp"
#include "class_GoldCustomer.hpp"
#include "class_PlatinumCustomer.hpp"

//header guard
#ifndef MOVIETICKET_H
#define MOVIETICKET_H

using namespace std; 

#define MAX 20; //no of tickets per movie hall available

class MovieTicket {

private:
int movie_id;
string movie_title;
string date;
int hall_no;
int seat_no;
float ori_price;

int NonMemberCount;

GoldMember ListGold[MAX];
int GoldMemberCount;

PlatinumMember ListPlat[MAX];
int PlatMemberCount;

static int AvailTicket;
static int SoldTicket;

public:
//constructor and destructor
MovieTicket(){};
~MovieTicket(){};

//functions member
void newMovie(int inputMovieID, string inputTitle, 
 string inputDate, int inputHall,    int inputSeat, float inputPrice){

    movie_id = inputMovieID;
    movie_title = inputTitle;
    date = inputDate;
    hall_no = inputHall;
    seat_no = inputSeat;
    ori_price = inputPrice;

    ListGold[MAX] = {0};
    ListPlat[MAX] = {0};

    AvailTicket = MAX;
    SoldTicket = 0;
}

int getAvailTicket(){
    return AvailTicket;
}

int getSoldTicket(){
    return SoldTicket;
}

void Purchase(){
    int no_of_ticket;
    int membership;
    int Inputgold_id;
    int Inputplat_id;

    cout <<"Enter Movie ID?" << endl;
    cin >> movie_id;
    cout << endl << "How many ticket?" << endl;
    cin >> no_of_ticket;
    cout << endl << "Enter membership? 1\. Non 2\. Gold 3.Plat" << endl;
    cin >> membership;

    this->SoldTicket += no_of_ticket;
    this->AvailTicket = MAX - this->SoldTicket;

    if (membership == 2){
        cout << "Enter your Gold Membership ID?" << endl;
        cin >> Inputgold_id;
        GoldMember Inputgold_id; 
                     //create a Gold customer class with 'ID' as the name
    } 
    else if (membership == 3){
        cout << "Enter your Platinum Membership ID?" << endl;
        cin >> Inputplat_id;
        PlatinumMember Inputplat_id; 
                    //create a Plat customer class with 'ID' as the name
    }

    switch (membership){
        case 1:
        NonMemberCount++;
        break;

        case 2:
        GoldMemberCount++;
        ListGold[GoldMemberCount] = Inputgold_id;
        break;

        case 3:
        PlatMemberCount++;
        ListPlat[PlatMemberCount] = Inputplat_id;
        break;
    }
}
};
#endif[/CODE] 
```

p / s：对不起，很长的帖子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:02:52.357

你的编译命令行是什么？您是否将头文件提供给他的编译器？您应该有一个包含所有内容的虚拟 main.cpp，并且只编译 main.cpp

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:03:12.170

您当然不应该在这里使用分号：`#define MAX 20;`

这导致`PlatinumMember ListPlat[MAX];`扩展，`PlatinumMember ListPlat[20;];`这就是编译器抱怨的原因。

其他几个地方也有类似的`#define`

我建议使用 'const int MAX = 20; `(preferrably`max = 20`，因为大写表示宏）。

乍一看，其他错误只是上述错误的后果 - 编译器在遇到奇怪的东西时会有点丢失，并且只是在不声明变量的情况下继续，然后变量稍后会丢失。

编辑：顺便说一句，在你的“platinumMember.hpp”中，这`type = "gold";`不应该是`type = "platinum";`吗？

（该死，太慢了！）

# android - 如果应用程序已恢复，如何从活动中获取结果

> ID：14034218
> 
> 赞同：0
> 
> 时间：2012-12-25T21:46:47.630
> 
> 标签：android, android-activity, back-stack

问题标题可能不够清楚。它解决了应用程序在资源不足的情况下被Android“杀死”后，将结果从子活动传递给父活动的问题，然后在用户返回该应用程序时自动恢复。

假设活动 A 使用 调用活动`startActivityForResult()`B。当应用程序执行上下文在 B 中时，应用程序进入后台并在一段时间后被系统卸载。稍后，用户切换回应用程序，并且活动 B 恢复没有问题。唯一的问题是 A 目前在 Android 的后台堆栈中不存在，并且当用户关闭 B（`finish()`伴随适当的`setResult()`调用）时，A 不会收到结果。A不是`onActivityResult()`事件，而是`onCreate()`从启动链接收和其他事件。

所以问题是如何在“杀死”状态后恢复的应用程序中的活动之间传递结果？

**更新：**

尽管@fedepaol 提供了一个指向谷歌群组的链接，有人在其中写了`onActivityResult`应该在有问题的情况下调用的链接，但我无法让它工作。我还应该注意，谷歌群组中该问题的 OP 也没有解决问题。我也在 SO 上发现了一个类似的问题 - [onActivityResult 在进程被杀死后不被调用](https://stackoverflow.com/questions/6328413/onactivityresult-is-not-called-after-process-is-killed)- 也没有解决方案。

我仔细检查了我的代码，不明白为什么它不起作用。在正常情况下，会调用被覆盖的方法。如果后台的activity一一还原，则不会。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T21:56:12.063

我不确定您`onActivityResult`是否会被调用。根据我的理解（可能不正确），操作系统应该为您提供所有工具来使用`onCreate`/`onRestoreInstanceState`方法重建 A 的状态。在他们之后，我希望使用之前的结果调用 onActivityResult。

Dianne Hackborn的[回答](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/PlrqRVtyvrs)也证实了这一点。

同样，您应该在返回结果之前处理 B 被杀死的情况。

# ruby-on-rails - 无法在命令行 Ruby on Rails 中生成模型

> ID：14034223
> 
> 赞同：0
> 
> 时间：2012-12-25T21:47:54.620
> 
> 标签：ruby-on-rails, activerecord, model

我今天刚开始在 Rails 上学习 Ruby。我正在关注 Rails For PHP Developers 一书。无论如何，当我键入 rails g model Subscribers 时，下一行显示“调用活动记录”。我从 cmd 行创建控制器没有问题，所以我的模型为什么没有生成。这意味着模型文件没有在模型目录中创建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T08:12:52.313

您需要将 mysql2 gem 添加到您的 gemfile 中。然后运行 ​​bundle install 并再次尝试。

在本地机器上学习 rails 时，最好使用默认的 SQLite 数据库。您必须更改 config/database.yml 才能将 MySQL 用于您的开发环境，这需要您安装 MySQL 适配器。

注意：使用 mysql2 gem，而不是 mysql gem。它会为你省去很多悲伤。

# c# - 如何在基于瓷砖的游戏中处理液体流动？

> ID：14034226
> 
> 赞同：1
> 
> 时间：2012-12-25T21:48:18.220
> 
> 标签：c#, xna, tile

正如标题所说，我需要在基于瓷砖的游戏中处理液体。

**信息：**每个图块是 16xPixels，它有一个水位（字节）。水应该与它附近的其他瓷砖平均起来，因为每个瓷砖都有一个水位。但我似乎做不到。

我希望它像在这个视频中一样： [http ://www.youtube.com/watch?v=3v9sH638nr0](http://www.youtube.com/watch?v=3v9sH638nr0)

但我就是做不到。帮助？

```
if (WaterLevel > 0)
        {
            //Bottom
            if (Program.Game.CurrentMap.Tiles[(int)TileLocation.X, (int)TileLocation.Y + 1].Collide == false && Program.Game.CurrentMap.Tiles[(int)TileLocation.X, (int)TileLocation.Y + 1].WaterLevel != 255)
            {
                if ((int)Program.Game.CurrentMap.Tiles[(int)TileLocation.X, (int)TileLocation.Y + 1].WaterLevel + (int)WaterLevel > 255)
                {
                    WaterLevel -= (byte)(255 - Program.Game.CurrentMap.Tiles[(int)TileLocation.X, (int)TileLocation.Y + 1].WaterLevel);
                    Program.Game.CurrentMap.Tiles[(int)TileLocation.X, (int)TileLocation.Y + 1].WaterLevel = 255;
                }
                else
                {
                    Program.Game.CurrentMap.Tiles[(int)TileLocation.X, (int)TileLocation.Y + 1].WaterLevel += WaterLevel;
                    this.WaterLevel = 0;
                }
            }
            //Left or Right
            else
            {
                bool Left = Program.Game.CurrentMap.Tiles[(int)TileLocation.X - 1, (int)TileLocation.Y].Collide;
                bool Right = Program.Game.CurrentMap.Tiles[(int)TileLocation.X + 1, (int)TileLocation.Y].Collide;
                byte Divider = 1;
                int Average = WaterLevel;
                if (Left)
                {
                    Divider += 1;
                    Average += Program.Game.CurrentMap.Tiles[(int)TileLocation.X - 1, (int)TileLocation.Y].WaterLevel;
                }
                if (Right)
                {
                    Divider += 1;
                    Average += Program.Game.CurrentMap.Tiles[(int)TileLocation.X + 1, (int)TileLocation.Y].WaterLevel;
                }
                WaterLevel = (byte)(Average / Divider);
                Average /= Divider;
                Divider -= 1;
                if (Left)
                {
                    Program.Game.CurrentMap.Tiles[(int)TileLocation.X - 1, (int)TileLocation.Y].WaterLevel = (byte)(Average / Divider);
                    Average /= Divider;
                    Divider -= 1;
                }
                if (Right)
                {
                    Program.Game.CurrentMap.Tiles[(int)TileLocation.X + 1, (int)TileLocation.Y].WaterLevel = (byte)(Average / Divider);
                    Average /= Divider;
                    Divider -= 1;
                }
            }
        } 
```

# java - 附加 Java VisualVM 以进行 CPU 分析会导致 JVMTI 错误 66

> ID：14034227
> 
> 赞同：5
> 
> 时间：2012-12-25T21:48:50.500
> 
> 标签：java, visualvm, jvmti

在使用 VisualVM 对我的应用程序进行 cpu 分析时，我遇到了错误

> “Profiler Agent 错误：带有消息：重新定义失败，错误 66”。

在那之后，它将所有类文件从构建路径复制到我启动应用程序的位置。

我试图找到一些关于它的信息，错误代码的意思是（根据JVMTI-documentation）：

> JVMTI_ERROR_UNSUPPORTED_REDEFINITION_HIERARCHY_CHANGED (66)
> 对于新的类版本，直接超类不同，或者直接实现的接口集不同。

因为分析通常在我的环境中工作（Java build 1.7.0_09-b05，Fedora 17 64 位）。我已经尝试过 Visualvm-docs 中所说的“-Xshare:off”，但没有任何效果。

由于这是我遇到此问题的唯一 Java-SE 应用程序，因此它似乎与我正在使用的库有关。以下是我的类路径：

*   Log4j 1.2.17
*   Apache OpenJPA 2.2.1
*   公共配置 1.9
*   共享池 1.6
*   PostgreSQL 9.1-901jdbc4
*   imgscalr-lib-4.2

任何人都可以看到库和错误之间的相关性吗？我真的没有想法了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T09:47:14.310

看起来这可能是由 JPA 引起的。您可以使用`Sampler`而不是`Profiler`. 另一种可能性是定义根方法和检测过滤器，以便由 JPA 检测的类不会被 VisualVM 分析。请参阅[使用 VisualVM 进行分析，第 1 部分](https://blogs.oracle.com/nbprofiler/entry/profiling_with_visualvm_part_1)和[使用 VisualVM 进行分析，第 2 部分](https://blogs.oracle.com/nbprofiler/entry/profiling_with_visualvm_part_2)，以获取有关分析以及如何设置分析根和检测过滤器的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-22T09:00:10.203

一个小补充：在分析使用 OpenJPA 的应用程序时，我收到了相同的错误消息。只要您不关闭应用程序，只需在每个错误对话框中单击“确定”，错误似乎就会消失。

因此，您只需按下按钮即可重置收集的结果并再次运行代码。例如，通过循环运行它并使用`new Scanner(System.in).nextLine()`或通过 UI 中的按钮单击。

# android - ACTION_GET_CONTENT 不显示所有视频

> ID：14034229
> 
> 赞同：0
> 
> 时间：2012-12-25T21:49:00.443
> 
> 标签：android, android-intent, mime-types

我正在使用 ACTION_GET_CONTENT 选择手机上的视频之一：

```
 final Intent intent = new Intent(Intent.ACTION_GET_CONTENT);
    intent.setType("video/*");
    startActivityForResult(intent, SELECT_VIDEO); 
```

不幸的是，有时它只显示手机上现有视频文件的一个子集，尤其是最新的视频文件。视频文件存在，但它们未显示在图库中。手机是装有 Android 4.0.4 的 HTC Incredible S。

有没有办法刷新画廊或类似的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T22:17:44.717

创建媒体文件的应用程序负责更新`MediaStore`，例如通过[`MediaScannerConnection`](http://developer.android.com/reference/android/media/MediaScannerConnection.html)和`scanFile()`，或通过发送`ACTION_MEDIA_SCANNER_SCAN_FILE`广播。

如果 Incredible S 上的某个应用程序未能做到这一点，那是该应用程序的错，您对此无能为力。

# c++ - Qt phonon module play 5.1 杜比

> ID：14034232
> 
> 赞同：0
> 
> 时间：2012-12-25T21:49:11.830
> 
> 标签：c++, qt4, phonon

是否可以让 qt phonon 模块在 5.1 中播放声音以及如何做到这一点？我认为默认情况下它只在 2.1 中播放。

# internet-explorer - Nginx：返回错误 403 并显示一条消息

> ID：14034235
> 
> 赞同：7
> 
> 时间：2012-12-25T21:50:08.527
> 
> 标签：internet-explorer, nginx, webserver, user-agent

如果用户代理是 MSIE 6，我希望 nginx 返回错误 403 并显示自定义错误消息。我使用了这段代码，最初几分钟一切正常。然后它只是返回了没有消息的错误！不知道为什么......这是代码（我试图把'而不是'，没有'或'的纯文本，仍然没有运气）：

```
location ~ \.php$ {
    try_files $uri =404;
    fastcgi_split_path_info ^(.+\.php)(/.+)$;           
    include /etc/nginx/fastcgi.conf;
    fastcgi_pass unix:/var/run/php5-fpm.sock;
    if ($http_user_agent ~ "MSIE 6" ) {
      return 403 "Browser not supported. Please update or change to another one.";
    }
} 
```

编辑：忘了说它在 php 块中，因为我只想为 PHP 请求阻止 MSIE 6。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T10:09:55.943

实际上，您的配置应该可以工作。您可以使用 curl 检查它：

```
# curl -i -H "User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1" http://localhost/i.php
HTTP/1.1 403 Forbidden
Server: nginx/1.3.6
Date: Wed, 26 Dec 2012 10:05:34 GMT
Content-Type: application/octet-stream
Content-Length: 62
Connection: keep-alive

Browser not supported. Please update or change to another one. 
```

访问日志也值得检查（默认情况下 log_format 包括 $http_user_agent 变量）。

顺便问一下，/etc/nginx/fastcgi.conf 中有什么？

另一件事是，如果您希望使用真正 MSIE 6 浏览器的人看到您的消息，您最好执行以下操作：

```
location ~ \.php$ {
    ...
    if ($http_user_agent ~ "MSIE 6" ) {
        return 403;
    }
    error_page 403 /old_browser.html;
} 
```

并使用您的消息创建 old_browser.html。请注意，此文件应大于 512 字节，以确保 MSIE 将显示其内容，而不是一些标准的 IE 403 消息。[http://browsershots.org](http://browsershots.org)之类的工具非常适合调试此类情况。:)

# java - Android：在我的 sdcard 上保存 gson.toJson() 返回字符串

> ID：14034236
> 
> 赞同：1
> 
> 时间：2012-12-25T21:50:18.067
> 
> 标签：java, android, io, gson, java-io

我正在尝试让应用程序将一些 Json 数据保存在本地文件中（在 sdcard 上）..

第一次运行时，我只需将 json-data 保存在一个文件中......

然后返回“applications_arr”（不是来自文件，而是来自 JsonReader）

[在这里](http://paste.ubuntu.com/1465627/)查看holde asyncTask-class ：

还有[ApplicationsModel.class](http://paste.ubuntu.com/1465638/)（实现Parcelable）

* * *

```
amFile = new File(this.activity.getFilesDir()+"/applications"+UUID.randomUUID()+".json");
gson = new GsonBuilder().create();

reader = new JsonReader(new BufferedReader(new InputStreamReader(new URL("http://software-center.ubuntu.com/api/2.0/applications/any/ubuntu/any/any/").openConnection().getInputStream())));
reader.beginArray();

//save am-json-data on sdcard
FileWriter fw = new FileWriter(amFile.getAbsoluteFile());
fw.write(gson.toJson(reader, ApplicationsModel.class));
fw.close();

//create am-arraylist to use now.. amFile is other use      
while (reader.hasNext()) {
    ApplicationsModel model = gson.fromJson(reader, ApplicationsModel.class);
    applications_arr.add(model);
}
reader.endArray();
reader.close(); 
```

看起来错误在于：

> fw.write(gson.toJson(reader, ApplicationsModel.class));

我的 Logcat 看起来像[这样](http://paste.ubuntu.com/1466228/)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T01:02:12.280

You probably need to specify the [WRITE_EXTERNAL_STORAGE](http://developer.android.com/reference/android/Manifest.permission.html#WRITE_EXTERNAL_STORAGE) permission in your [manifest](http://developer.android.com/guide/topics/manifest/uses-permission-element.html).

This would look like:

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

EDIT:

Looking at your logcat, the error is:

> java.util.concurrent.ExecutionException: java.lang.IllegalArgumentException: expected receiver of type com.ubuntu.apps.ApplicationsModel, not com.google.gson.stream.JsonReader

Which is saying that Gson is expecting to read in an ApplicationModel, and instead you are giving it a JsonReader.

That said, the line where you are trying to save the Json you're reading streaming from the URL to a file doesn't need Gson. Just stream the Json straight to the file.

# jquery - 如何更改输入的值：当另一个输入的值时的文本：在没有用户与其他输入交互的情况下更改文本

> ID：14034237
> 
> 赞同：1
> 
> 时间：2012-12-25T21:50:31.927
> 
> 标签：jquery, javascript-events

我有两个输入 [type=text]。

```
<input type=text id=inputOne>
<input type=text id=summary> 
```

**当#inputOne 更改时，我想用#inputOne.value 更新#summary.value（这是问题）。**我无法解决的问题是*“用户”没有直接访问/更改#inputOne*，因此它的模糊、按键、更改、onmouseover 等事件没有启动，或者它们是但我无法让它工作.

用户使用 unknownFunction 更改#inputOne.value，我无法修改，也无法访问。

```
<script>
  ...
  unknownFunction(){
     ...
     $("#inputOne").val(aDynamicValue);
  }
</script> 
```

我尝试的基本 jQuery 函数如下。它不工作:)

```
<script>
   ...
   $("#inputOne").change(function(){
       $("#summary").val("Value: "+$(this).val()+"...");
   });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T21:58:28.190

如果您无法修改更新值的函数，则必须轮询源以进行更改。

```
setInterval(function() {
  var inputOne = $('#inputOne'), summary = $('#summary'), previous = $inputOne.val();
  return function() {
    var current = inputOne.val();
    if (current !== previous) {
      summary.val('Value: ' + current + '...');
      previous = current;
    }
  }
}(), 100); 
```

这将每 100 毫秒检查一次输入是否有变化，并在值更新时更新摘要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:15:57.217

根据[HTML5 规范](http://www.w3.org/TR/html5/forms.html#common-event-behaviors)，以编程方式更改输入元素的值应触发`input`and`change`事件。该`input`事件在元素的内容被更改时发生，该`change`事件在更改被*提交*时发生，例如从元素中跳出。

这表明为`input`事件绑定处理程序应该比`change`. 试一试，看看它是否有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-01T08:13:22.930

这适用于所有浏览器和 Jquery <= v1.10

```
$('#inputOne').on('keyup', function () {
    $("#summary").val("Value: "+$(this).val()+"...");
}); 
```

文本框输入字段更改事件会按您的预期触发，jQuery .Change 事件仅在支持 html5 的浏览器上正常工作

# xml - XQuery：如何获取前一个元素而不是在 XML 文件中选择的元素？

> ID：14034240
> 
> 赞同：1
> 
> 时间：2012-12-25T21:50:59.860
> 
> 标签：xml, xquery, exist-db

好吧，如果我有例如：

```
<entries>
  ...
  <entry id="34" weight="83">...</entry>
  <entry id="35" weight="21">...</entry>
  ...
</entries> 
```

出于任何原因，我得到了 ID 为 35: 的条目`let $entry := //entry[xs:integer(./@weight)=21]`。我怎样才能简单地获取上一个条目（ID 34）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T22:26:56.877

使用 XPath 轴`preceding-sibling`获取所有前面的兄弟，而不是将结果集限制为最后一个。

```
(//entry[xs:integer(./@weight)=21]/preceding-sibling::*)[last()] 
```

根据您的数据集和 XQuery 实现，反过来可能会更快：找到`<entry/>`满足条件的元素。

```
//entry[./following-sibling::*[1][xs:integer(./@weight)=8]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-25T22:32:41.200

```
//entry[xs:integer(@weight)=21]/preceding-sibling::entry[1] 
```

前面的兄弟轴倒数。`[1]`表示前一个兄弟姐妹。

# c# - 如何在用于 SQL 插入的方法中进行参数化查询？

> ID：14034249
> 
> 赞同：2
> 
> 时间：2012-12-25T21:52:02.077
> 
> 标签：c#, sql, parameterized

我真的不知道如何在标题中很好地解释它，但这是我的问题。

在许多重载方法中，我制作了这种方法，其唯一目的是将给定值插入给定表中：

```
public static int Insert(string cs, string table, string[] values)
{
    using (SqlConnection con = new SqlConnection(cs))
    {
        try
        {
            string strCommand = string.Format(
                "INSERT INTO {0} VALUES ({1})", 
                table, 
                values.Aggregate((a, b) => (a + ", " +b)));
            SqlCommand com = new SqlCommand(strCommand, con);
            con.Open();
            int result = com.ExecuteNonQuery();
            return result;

        }
        catch (SqlException ex)
        {
            HttpContext.Current.Response.Write(ex.Message);
            return 0;
        }
    }
} 
```

现在它没有使用参数化查询，不是吗？

我真的很想在其中实现这个概念，但我不知道如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:15:23.223

您需要更改方法以传递带有参数名称的字符串数组和包含参数值的等长对象数组

```
public static int Insert(string cs, string table, string[] paramNames, object[] paramValues)
{
    using (SqlConnection con = new SqlConnection(cs))
    {
        try
        {
            string strCommand = string.Format(
                "INSERT INTO {0} VALUES ({1})", table, 
                paramNames.Aggregate((a, b) => (a + ", " +b)));

            SqlCommand com = new SqlCommand(strCommand, con);
            for(int x = 0; x < paramNames.Length; x++)
                com.Parameters.AddWithValue(paramNames[x], paramValues[x]);

            con.Open();
            int result = com.ExecuteNonQuery();
            return result;
        }
        catch (SqlException ex)
        {
            HttpContext.Current.Response.Write(ex.Message);
            return 0;
        }
    }
} 
```

您可以使用类似这样的方法调用此过程

```
string[] parNames = new string[] {"@keyID", "@custName"};
object[] parValues = new object[] {1, "Mike"};
DBHelper.Insert("constring", "customers", parNames, parValues); 
```

然而，让我说，这种方法同样有很多缺点。因为您没有传递一组特定的列，所以您被迫传递每列的值，如果您的表包含 Identity 列，这会给您带来问题。（您不能明确地为 Identity 列设置值。）

因此，传递列名数组而不是参数名数组要好得多。
使用此数组，您可以更好地自定义查询（例如省略字段），并且参数名称可以由列名称派生。

```
public static int Insert(string cs, string table, string[] colNames, object[] paramValues)
{
    ......
          string strCommand = string.Format(
                "INSERT INTO {0} ({1}) VALUES ({2})", table, 
                colNames.Aggregate((a, b) => (a + ", " +b)),
                colNames.Select(n => "@" + n).Aggregate((a, b) => (a + ", " + b)));
    .....

            for(int x = 0; x < colNamesNames.Length; x++)
                com.Parameters.AddWithValue("@" + colNames[x], paramValues[x]);

} 
```

当然，在调用中更改您的参数以使用列名而不是参数名。

```
string[] colNames = new string[] {"ID", "Name"}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T22:24:56.657

如果您在插入语句中使用位置值，则在添加、删除或重新排序表列时会遇到问题。使用命名插入是一个更好的主意

```
INSERT INTO mytable (col1, col2, col3) VALUES (x, y, z) 
```

因此，您还必须传递列名。这还允许您跳过非必需列或标识列和时间戳、计算列或由触发器填充的列。

```
public static int Insert(string cs, string table, string[] columns, object[] values) 
```

我还将值数组的类型更改为，`object[]`因为这允许您以正确的类型传递值（例如，整数值 as`int`或日期/时间值 as `DateTime`。此外，我们不会将值直接添加到 sql 语句中，相反，我们使用参数占位符 ( `@xy`)。这里我们只是使用以“@”为前缀的列名。

```
INSERT INTO mytable (col1, col2, col3) VALUES (@col1, @col2, @col3) 
```

```
string cmd = string.Format(
    "INSERT INTO {0} ({1}) VALUES ({2})", 
    table,
    columns.Aggregate((a, b) => (a + ", " + b))
    columns.Select(c => "@" + c).Aggregate((a, b) => (a + ", " + b))); 
```

现在我们必须将值作为参数添加到`SqlCommand`

```
for (int i = 0; i < columns.Length; i++) {
    com.AddWithValue("@" + columns[i], values[i]);
} 
```

其他部分（打开连接、创建和执行命令等）保持不变。

* * *

例子：

```
int result = Insert(
    cs, "mytable", 
    new string[] { "id", "name", "birthdate" },
    new object[] { 107, "John", new DateTime(1980,7,19) }
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-25T22:26:07.380

您可以使用包含列名及其各自值的字典

```
 Dictionary<string, object> values = new Dictionary<string,object>();
   values.Add("userid", 1022);
        values.Add("username", "JFord");
        values.Add("IsActive", 0);
   string table = "users"; 
```

用法：

```
MyClass.Insert("connection", "users", values); 
```

方法

```
public static int Insert(string cs, string table, Dictionary<string,object> values)
{
        string strCommand = string.Format("INSERT INTO {0} VALUES ({1})",
            table, "@"+String.Join(", @", values.Keys));

 //strCommand becomes: "INSERT INTO users VALUES (@userid, @username, @IsActive)"

        SqlCommand com = new SqlCommand(strCommand, conn);

        foreach (string key in values.Keys)
        {
            com.Parameters.AddWithValue("@" + key, values[key]);
        }

} 
```

# ssh - 通过 SSH 对文件夹下特定文件扩展名的 chmod 权限

> ID：14034254
> 
> 赞同：10
> 
> 时间：2012-12-25T21:53:52.670
> 
> 标签：ssh, chmod

我的文件夹是`/images/`. 此文件夹中有`.png`,`.gif`和`.jpg`图像。如何`.jpg`通过SSH将文件夹下特定文件扩展名的权限更改为644？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-25T21:56:05.540

使用 ssh 连接到远程计算机，然后执行此命令可能会起作用：

`find /images/. -name "*.jpg" | xargs chmod 644`

# php - PHP 登录脚本 - If 语句和数组

> ID：14034255
> 
> 赞同：1
> 
> 时间：2012-12-25T21:53:55.463
> 
> 标签：php, arrays, login-script

各位程序员和编码员大家好。我正在开发一个基于**zubrag**已经很棒的登录脚本的增强登录脚本。

我要实现**的目标：如果用户是管理员，他将登录。如果用户是普通用户，他将不会登录。**

会发生什么：**用户登录，即使他不是管理员。**

这是代码片段：

```
// user provided password
if (isset($_POST['access_password'])) {

  $login = isset($_POST['access_login']) ? $_POST['access_login'] : '';
  $pass = $_POST['access_password'];
  if (!USE_USERNAME && !in_array($pass, $users)
  || (USE_USERNAME && ( !array_key_exists($login, $users) || $users[$login] != $pass ) ) 
  ) {
      showLoginPasswordProtect("Incorrect username or password.");
  } 
```

我遇到问题的部分：

```
 elseif (array_key_exists($login, $admins)) {
  showLoginPasswordProtect("User not an admin.");
  } 
```

其余代码：

```
 else {
      // set cookie if password was validated
      setcookie("verify", md5($login.'%'.$pass), $timeout, '/');
      setcookie("user", $login, 0, '/');
      // Some programs (like Form1 Bilder) check $_POST array to see if parameters passed
      // So need to clear password protector variables
      unset($_POST['access_login']);
      unset($_POST['access_password']);
      unset($_POST['Submit']);
  }

} 
```

用户名和密码数组：

```
$users = array(
  'username' => 'password',
  'administrator' => 'administrator-password'
); 
```

管理员数组：

```
$admins = array(
  'administrator'
); 
```

现在把所有这些想象在一起，问题会是什么？（这可能真的很容易，我只是不是专业的编码器。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T21:59:52.923

你确定管理员可以登录吗？

在这里，您是说如果用户名在 admin 数组中，则拒绝访问：

```
elseif (array_key_exists($login, $admins)) {
  showLoginPasswordProtect("User not an admin.");
} 
```

  您可能想要做的是拒绝不在 admin 数组中的用户的访问权限：

```
elseif (!array_key_exists($login, $admins)) {
  showLoginPasswordProtect("User not an admin.");
} 
```

# c# - Ninject的代表工厂

> ID：14034258
> 
> 赞同：2
> 
> 时间：2012-12-25T21:54:10.310
> 
> 标签：c#, ninject, ioc-container, autofac

Autofac 有[委托工厂](http://code.google.com/p/autofac/wiki/DelegateFactories)，但我找不到任何关于如何在[Ninject](http://www.ninject.org/)中实现它的信息。我想使用它的原因是避免引用容器本身，而是能够动态创建指定类型的新对象。

我可以做类似的事情来达到相同的结果吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T16:26:08.280

我相信您正在寻找工厂扩展（[链接](https://github.com/ninject/ninject.extensions.factory/wiki)）。

# asp.net-mvc - 如何在 Asp.NET MVC 重定向到操作中指定 url 地址

> ID：14034265
> 
> 赞同：0
> 
> 时间：2012-12-25T21:55:13.327
> 
> 标签：asp.net-mvc, url-rewriting

MVC 中是否有办法在执行重定向操作后指定浏览器 url 地址？在我的代码中，我有

```
RedirectToAction("myaction", "mycontroller", new {arg1= "height", arg2="weight"}) 
```

浏览器中显示的地址是：

```
http/mywebsite/mycontroller/myaction?arg1=height&arg2=weight 
```

但是，我希望出现在浏览器 url 中的是：

```
http://mywebsite/height/weight 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T10:33:47.107

您需要添加一个特定的路由来实现这一点，只需在 Global.asax.cs 中将 MapRoute 添加到您的应用程序开始：

```
protected void Application_Start()
{
    RouteTable.Routes.MapRoute("myRouteName",
        "/{height}/{weight}",
        new { controller = "mycontroller", action = "myaction" },
        new[] { "Namespace.Of.My.Controller" });
} 
```

# php - mysql加入两个表like和posts

> ID：14034268
> 
> 赞同：0
> 
> 时间：2012-12-25T21:55:36.330
> 
> 标签：php, mysql, join, mysqli

这是我的**php/MySQL**任务：

我有一个表`POSTS`，其中包含`num`作为主键的字段和有关帖子的其他信息字段（`author`、、`title`等）。我还有一个表`LIKE`，其中包含一个作为主键的`userId`字段和一个`POST`与`num`. `posts`给定一个特定的`userID`，我需要从`POSTS`表中获取 userId“喜欢”的所有行。

### 表 1 - 职位

-num
-author
-title

### 表 2 - 喜欢

-userId
-postId

这一切都在**php**中，所以我的第一个想法是从`LIKES`表中获取`userId`与给定行匹配的所有行，并将这些行存储在一个数组中。然后我会遍历数组，对于每一行我会搜索得到`POSTS`表的行`where postId=POSTS.num`。但是，这似乎会相当慢，特别是因为通过数组的每次迭代都是一个单独的 mysql 查询。

我假设有更快的方法。是使用临时表还是有更好的方法来连接表？我必须假设两个表都包含很多行。我是 mysql 新手，所以如果有更好的解决方案，请解释为什么它更好。提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T22:20:53.413

```
SELECT poli.* FROM (
SELECT po.* FROM posts po 
JOIN likes li
ON li.postId = po.num
WHERE li.userId = '$yourGivenUserId'
) AS poli 
```

$yourGivenUserId 是给定的用户 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:02:18.857

尝试以下查询：

```
SELECT
  `posts`.*
FROM
  `likes`
INNER JOIN
  `posts` ON
  `posts`.num = `likes`.postId
WHERE
  `likes`.Userid = {insert user id here} 
```

根据您的架构（不确定“喜欢”中的每条记录是否必须是唯一的，您可能希望`DISTINCT`在您的选择中使用关键字来过滤掉重复项。

# javascript - Javascript 显示结果

> ID：14034269
> 
> 赞同：0
> 
> 时间：2012-12-25T21:55:53.083
> 
> 标签：javascript, jquery

我无法弄清楚我做错了什么。我尝试进行更改，但是当我这样做时，各种问题不断出现。沮丧正在杀死我。

这目前有效：当我单击 btnShowResult 时，它会显示测验结果（正确或错误），然后在其下方显示正确百分比。

我无法工作：我只想要结果上方的百分比，然后是总数中正确或错误的数量，然后是结果。

它应该是什么样子

您的分数是：100% 您得到：20 分中的 20 分正确 结果：问题 1 正确 问题 2 正确等等。

```
 resultSet += '<div> Question ' + (i + 1) + ' is ' + results[i] + '</div>'
                }
               resultSet += '<div class="totalScore">Your score is ' + (trueCount * 500/100).toFixed(0) + '%</div>'

                $('#resultKeeper').html(resultSet).show();
            })

        }

    };

    jQuiz.init();
}) 
```

# c# - 在 Windows Phone 中捕获 SMS 事件

> ID：14034274
> 
> 赞同：1
> 
> 时间：2012-12-25T21:57:06.287
> 
> 标签：c#, windows-phone, windows-phone-8

我想知道用户是否真的确认发送短信，或者他是否只是按下后退按钮而不发送短信。虽然在 Android 甚至在 iOS 中，这只是通过回调来完成，但 WP8 并没有为此提供任何明显的解决方案。

所以我想知道是否有一个事件在发送短信时被触发，如果没有发送短信则不会被触发。

可能有人可以捕获此事件以检查 SMS 是否实际发送或被取消。

sms itslef 是从我喜欢捕捉 SMS 事件的应用程序中启动的。

澄清一下，我不想自动发送短信——我知道这在 WP 中是不可能的。我只需要知道用户是否真的发送了短信。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T22:16:04.107

目前在 WP8 上这是不可能的。如果您有兴趣在未来的版本中看到这一点，请在[wpdev uservoice](http://wpdev.uservoice.com/forums/110705-app-platform)建议中填写您的用例以及您对此感兴趣的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T13:00:48.090

在 Windows Phone 世界中这是不可能的。SmsComposeTask 是一个从ChooserBase<> 派生的启动器API，并实现了fire and forget 类型的动作。因此，您无法从启动器获取任何数据。

我承认最好知道消息是否发送给用户。最好的祝福

# r - 获得 confint 以使用 rms lrm 对象

> ID：14034277
> 
> 赞同：4
> 
> 时间：2012-12-25T21:57:23.353
> 
> 标签：r, glm

我无法从 rms 包中获得逻辑回归来使用 confint()，这是一个示例：

```
library(rms)
data(mtcars)
dd <- datadist(mtcars)
options(datadist = "dd")
fit <- lrm(am ~ gear + mpg, data=mtcars)
confint(fit) 
```

这给出了错误：

> 错误：$ 运算符对原子向量无效

traceback() 给出：

```
4: profile.glm(object, which = parm, alpha = (1 - level)/4, trace = trace)
3: profile(object, which = parm, alpha = (1 - level)/4, trace = trace)
2: confint.glm(fit)
1: confint(fit) 
```

我猜 lrm() 模型没有实现 confint。

## 我的问题

有没有方便的替代方式？是否为 rms 包创建了其他替代方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T22:15:51.743

`confint.default(fit)`似乎工作。请注意，它正在构建 Wald 置信区间，而不是更准确的*配置文件*置信区间，从而`confint.glm()`产生......

`class(fit)`; `methods(class="lrm")`; `methods(class="rms")`不建议任何明显的替代品...

你可能会`bootcov()`和朋友一起寻找引导置信区间（但我还没有让这些工作......）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T01:59:27.240

试试这个：

```
> summary(fit)[ , c("Lower 0.95", "Upper 0.95")]
               Lower 0.95   Upper 0.95
gear        -6.148918e+01 9.756505e+01
 Odds Ratio  1.975094e-27 2.354854e+42
mpg         -1.063706e+00 6.028564e+00
 Odds Ratio  3.451743e-01 4.151185e+02 
```

（这些结果表明完全分离或其他一些建模病理学。）

# c - 尽管我安装了 liblapack-dev，但我得到“lapack.h：没有这样的文件或目录”

> ID：14034284
> 
> 赞同：7
> 
> 时间：2012-12-25T21:58:38.097
> 
> 标签：c, lapack

我使用 Synaptic 安装了 liblapack-dev 及其依赖项，并将其包含`<lapack.h>`在我的代码中。

如果我尝试像这样编译我的程序......

```
mpicc program.c -llapack -o output 
```

...我收到以下错误：

```
program.c:4:20: fatal error: lapack.h: No such file or directory 
compilation terminated. 
```

我怎样才能解决这个问题？我已经花了几个小时在谷歌上搜索解决方案，但没有任何帮助。

我正在使用 Linux Mint，但我在最新版本的 Ubuntu 上尝试了相同的操作，但它仍然无法正常工作。当我尝试从我的程序中“消除”MPI 并使用 gcc 编译时，同样的事情。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2015-10-19T19:13:31.437

我在 Debian 上遇到了类似的问题。我注意到

```
dpkg -L liblapack-dev 
```

没有返回单个头文件。所以我做了一些搜索，`apt-cache`发现似乎是 C 头文件。通过安装后

```
sudo apt-get install liblapacke-dev 
```

（注意额外的 e！），我能够编译一个最小的工作示例，在[此处](http://www.physics.orst.edu/~rubin/nacphy/lapack/codes/linear-c.html)找到。修改`include`顶部以读取

```
#include <lapacke.h> 
```

并编译

```
gcc -llapack lapack_example.c 
```

在我的系统上成功运行。希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T22:57:53.627

回答是因为它不适合评论：

[手册](http://www.netlib.org/lapack/#_standard_c_language_apis_for_lapack)说：

```
Standard C language APIs for LAPACK

collaboration LAPACK and INTEL Math Kernel Library Team

    LAPACK C INTERFACE is now included in the LAPACK package (in the lapacke directory)

    LAPACKE User Guide

    Updated: April 20, 2012

    header files: lapacke.h, lapacke_config.h, lapacke_mangling.h, lapacke_utils.h 
```

所以也许你需要

```
#include <lapacke.h> 
```

# iphone - UITableView 使用解析另一个页面在底部添加行

> ID：14034285
> 
> 赞同：3
> 
> 时间：2012-12-25T21:59:23.433
> 
> 标签：iphone, ios, uitableview

我正在研究一个用于学习目的的示例项目。我已经通过使用 NSXMLParser 解析 RSS 提要成功地解析了一个 wordpress 站点。自定义单元格包括缩略图、标题、作者和帖子的发布日期。

目前它显示包含 10 个帖子的提要的第一页。如果我在浏览器中键入它们，我可以通过输入 /?paged=3访问提要的第二页[http://sitename.com/feed/?paged=2和第三页。](http://sitename.com/feed/?paged=2)

我想要做的是当用户向下滚动到底部时，它使用第二个页面提要 url 并在底部显示帖子等等。谁能指导我如何完成这项任务。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T22:02:25.457

要制作无限滚动器，您需要知道何时开始获取新项目。有很多方法可以做到这一点，但最好的地方是挂钩`UITableViewDelegate`'s 方法。`cellForRowAtIndexPath:`调用时，检查该行是否是数据存储中的最后一行。如果是，请调用新数据，然后将其附加到旧数据并刷新您的视图。您还可以挂钩到表视图滚动器，以查看它何时滚动到底部以进行此调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T22:49:51.490

Coneybeare 对如何设置它有正确的想法。

使用 AFNetworking，它会让您的生活更轻松。

我会有一个 int 计数器来跟踪上次调用的 URL。然后，一旦用户到达最底部的单元格（您通过委托方法知道），我会将 int 增加 1，然后将其附加到表示 URL 的字符串。您可以为此使用 stringByAppendingString 方法。

现在您有了一个带有正确 url 的新字符串，您可以启动一个新请求，并将数据附加到您已有的数据中。然后你可以做 [self.tableView reloadData] 来刷新表格。

# c# - ASP.NET 和 C# 页面查看计数器：使用数据库

> ID：14034288
> 
> 赞同：6
> 
> 时间：2012-12-25T22:00:12.093
> 
> 标签：c#, asp.net

我正在从事一个类似于 stackoverflow.com 概念的项目

会有很多问题，我希望每个问题都有一个页面浏览计数器。

我觉得最好的方法是使用数据库，因为问题的数量会很大，而且会随着时间的推移而增加。

如果我只是创建了一个 TABLE **Question_Views** 并为每个问题设置一行，那将非常容易。

像这样的东西。

```
ID-----Question_ID------Views
1-------23--------------400
2-------24--------------301
3-------25--------------123 
```

但是页面计数器是否考虑了 IP 地址？意思是，如果我打开第 23 个问题的网页，然后改天我也会查看这个问题，它是增加 1 还是增加 2？

如果我需要考虑 IP 地址，这种方法有点错误，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:20:59.503

这听起来很简单——但如果你喜欢一个准确的计数器，那就不是了。
你有

*   读取和索引您的页面的机器人，包括已知和未知的
*   禁用 cookie 和/或禁用 javascript 的用户
*   Google 和 Bing 从您的网站捕获图像以供上一个直播
*   一次又一次加载页面以进行刷新的用户
*   位于公司防火墙后且拥有通用 ip 的用户。
*   由于使用动态 ip 连接而更改 ips 的用户
*   试图操纵数据的攻击者。

就在今天[，YouTube](http://www.dailydot.com/news/youtube-universal-sony-fake-views-black-hat/)从页面浏览量中删除了数十亿的虚假统计数据！

所以现在的问题是，你要测量什么？

1.  访问 ?
2.  访客？
3.  页面浏览量？
4.  独特的页面浏览量 ?

[点击量、访问量、访问者、综合浏览量和唯一浏览量之间的差异](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1257084)对于您如何衡量浏览量至关重要。

对于如何识别访问者而不是机器人或试图操纵计数器的攻击者也很重要？

一个想法是跟踪所有这些参数，并显示独特的页面浏览量。一个用户可以算作 1 次唯一的页面查看，即使是查看该页面 10 次对于有 cookie 的会话。当会话到期并且用户再次出现时，例如，如果他在 60 分钟后没有会话，那么您再次计算他。

而这里的困难在于找到所有的机器人，以及看到一页就走的“虚假用户”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T22:02:20.140

当然，这取决于。您是否*希望*同一用户刷新页面计为两次页面浏览？如果一个用户每小时看到两次相同的页面呢？还是一天两次？

弄清楚你想要什么，然后它会更容易实现。

另外，不要将 IP 地址用于任何事情。而是通过 HTTP 会话识别您的用户。

# ruby - 重定向后使用 Ruby Mechanize 下载 XLS 文件时出现无法解释的不一致

> ID：14034291
> 
> 赞同：2
> 
> 时间：2012-12-25T22:00:39.503
> 
> 标签：ruby, web-scraping, mechanize, mechanize-ruby

我有一个访问 fcc.gov 的脚本，然后单击触发下载的链接：

```
require "mechanize"

docket_number = "12-268" #"96-128"

url = "http://apps.fcc.gov/ecfs/comment_search/execute?proceeding=#{docket_number}"
agent = Mechanize.new
agent.pluggable_parser.default = Mechanize::DirectorySaver.save_to 'downloads'

agent.get(url) do |page|
    link = page.link_with(:text => "Export to Excel file")
    xls = agent.click(link)
end 
```

这在`docket_number`“12-268”时工作正常。但是，当您将其更改为“96-128”时，Mechanize 会下载页面的 html 而不是所需的电子表格。

两个页面的网址是：

*   [http://apps.fcc.gov/ecfs/comment_search/execute?proceeding=12-268](http://apps.fcc.gov/ecfs/comment_search/execute?proceeding=12-268)（有效）
*   [http://apps.fcc.gov/ecfs/comment_search/execute?proceeding=96-128](http://apps.fcc.gov/ecfs/comment_search/execute?proceeding=96-128)（这是我需要帮助的地方）

如您所见，如果您在浏览器（我使用的是 Chrome）中访问每个页面并单击“导出到 Excel 文件”，则会下载电子表格文件并且没有问题。“96-128”有更多行，因此当您单击导出链接时，它会将您带到一个新页面，该页面每 10 秒左右刷新一次，直到文件开始下载。我怎样才能解决这个问题，为什么会出现这种不一致？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:20:19.990

单击 96-128 上的 Export 将带您进入使用这种标签刷新的页面（我以前从未听说过）：

```
<meta http-equiv="refresh" content="5;url=/ecfs/comment_search/export?exportType=xls"/> 
```

默认情况下，Mechanize 不会跟随这些刷新。要解决这个问题，请更改以下设置`agent`：

```
agent.follow_meta_refresh = true 
```

来源：[https ://stackoverflow.com/a/2166480/94154](https://stackoverflow.com/a/2166480/94154)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:15:01.180

前面的 12-268 有 48 个条目，96-128 有 4046 个。当我点击后者的“导出到 Excel 文件”时，有时会有一个页面显示：

> 完成处理 4046 条记录中的 933 条。如果此页面未自动重新加载，请单击。

我猜mechanize也看到了这一点。

# javascript - 指定 Google Map Markers 的 z-index

> ID：14034292
> 
> 赞同：41
> 
> 时间：2012-12-25T22:00:41.517
> 
> 标签：javascript, jquery, html, google-maps

我有一个谷歌地图，里面有很多使用 websockets 添加的标记。我正在使用基于数据可用性的自定义标记图像。我想确保最新的标记保持在地图中所有其他元素的顶部。

我该怎么做呢？

**代码：**

```
circleIcon = {
    path: google.maps.SymbolPath.CIRCLE,
    fillColor: "blue",
    fillOpacity: 1,
    scale: 2,
    strokeColor: "red",
    strokeWeight: 10
};

coordinates = image[2].split(',');

pin=new google.maps.LatLng(coordinates[0], coordinates[1]);

if(marker) {
    marker.setMap(null);
}

if(image[0] != "NOP") {
    var markerIcon = circleIcon;
} else {
    var markerIcon = image_car_icon;
}

marker=new google.maps.Marker({
    position:pin,
    icon:markerIcon
});

marker.setMap(map);

map.setCenter(marker.getPosition()); 
```

**更新**

我正在使用 jquery 来更新 InfoWindow 的 z-index，例如：

```
popup = new google.maps.InfoWindow({
    content:'<image id="pin_' + pin_count + '" src="data:image/png;base64,' + image[1] +'"/>',
});

popup.open(map, marker);

google.maps.event.addListener(popup, 'domready', function() {
    console.log("DOM READY...........................");

    // Bring latest Image to top            
    e = $('#pin_' + pin_count).parent().parent().parent().parent();
    e.css({
        'z-index' : 99999 + pin_count,
    });
}); 
```

也许这就是标记显示在 InfoWindow 后面的原因。我尝试使用 zIndex 进行更新，但标记仍显示在 InfoWindow 后面：

```
marker=new google.maps.Marker({
    position:pin,
    zIndex: 9999999 + pin_count,
    icon:markerIcon
}); 
```

**更新**

示例代码。我希望“绿色圆圈”图标标记位于“pin”图标标记后面。

* * *

```
<!DOCTYPE html>
<html>
<head>
<script src="http://maps.googleapis.com/maps/api/js?key=&sensor=false"></script>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

<script>

    var london = new google.maps.LatLng(51.508742,-0.120850);

    function initialize()
    {
        var pin1=new google.maps.LatLng(51.508742, -0.120850);
        var pin2=new google.maps.LatLng(51.508642, -0.120850);

        var mapProp = {
          center:pin1,
          zoom:17,
          disableDefaultUI:true,
          mapTypeId:google.maps.MapTypeId.ROADMAP
          };

        var map = new google.maps.Map(document.getElementById("googleMap"), mapProp);

        var marker=new google.maps.Marker({
          position:pin2,
          zIndex:99999999
          });

        marker.setMap(map);

        var infowindow = new google.maps.InfoWindow({
          content:"Hello World!"
          });

         infowindow.open(map,marker);

        circleIcon = {
            path: google.maps.SymbolPath.CIRCLE,
            fillColor: "blue",
            fillOpacity: 1,
            scale: 2,
            strokeColor: "green",
            strokeWeight: 10
        };

        var marker2=new google.maps.Marker({
          position:pin1,
          icon:circleIcon,
          zIndex:99999
          });

        marker2.setMap(map);
    }

    google.maps.event.addDomListener(window, 'load', initialize);

</script>
</head>

<body>
<div id="googleMap" style="width:500px;height:380px;"></div>

</body>
</html> 
```

* * *

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2015-09-17T12:36:13.303

您必须结合 zIndex 选项将标记选项“优化”设置为 false。

```
var marker=new google.maps.Marker({
      position:pin2,
      optimized: false,
      zIndex:99999999
}); 
```

这应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-12-25T22:30:08.117

默认情况下，地图将使地图上较低的标记的 z-index 更高，因此它们从上到下明显堆叠

您可以`zIndex`为标记设置选项。您只需要在添加标记并将其添加到标记选项对象时创建一个增量 zIndex 计数器：

```
marker=new google.maps.Marker({
    position:pin,
    icon:markerIcon,
    zIndex: counterValue
}); 
```

我不太确定基本起始值需要是多少

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-01-22T20:41:46.560

Problem solved. Just set the zValue to 999 (I'm guessing higher will bring it more to the top) and it should come to the top. I guess the default is below 999:

```
var zValue;

if (someCondition) {
    zValue = 999;
}

var marker = new google.maps.Marker({
    map: map,
    position: {lat: lat, lng: lng},
    title: titleString,
    icon: image,
    zIndex: zValue
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T13:10:10.703

[请注意，正如谷歌地图文档](https://developers.google.com/maps/documentation/javascript/reference#CircleOptions)中所说，圆的 z-index 将与其他多边形的 z-index 进行比较，而不是与标记的 z-index 进行比较。

# sql - 需要更正Sql Query

> ID：14034295
> 
> 赞同：0
> 
> 时间：2012-12-25T22:01:08.300
> 
> 标签：sql, sql-server

对于以下查询，我需要一点帮助。我需要找到：

> 每个校区每学期平均人数

我的表结构是：

*   表名 - 注册
*   列
    *   学生卡
    *   校园
    *   年
    *   批
    *   学期

在、和的帮助下`campus`，我可以识别每个独特的学期。更多的是我在数据库中的重复。`year``semester``batch``student_id`

我做了以下，但它不会帮助。所以我需要一些帮助。

```
SELECT semester,year,campus
  FROM regestration
  GROUP BY  semester, year, campus
  ORDER BY count(*) desc 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T22:08:05.930

尝试类似：

```
SELECT year,campus, AVG(CountOfStudents)
FROM
(
  SELECT semester,year,campus, count(*) as CountOfStudents
  FROM regestration
  GROUP BY  semester, year, campus
) t
GROUP BY  year, campus 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:08:52.200

要获取每学期每个校区的学生人数，您需要在查询中添加 COUNT(*)：

```
SELECT semester, year, campus, COUNT(*) as students
    FROM registration
    GROUP BY semester, year, campus 
```

不过，我不知道你想要什么平均值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T22:08:59.237

怎么样

```
select avg(students), campus from (
  select count(student_id) students, campus from registration
   group by semester, year, campus
) group by campus 
```

# php - laravel 循环通过急切加载的嵌套关系

> ID：14034305
> 
> 赞同：0
> 
> 时间：2012-12-25T22:02:51.417
> 
> 标签：php, foreach, nested-loops, laravel

再次挣扎​​，可以做一些帮助。
它可能看起来很长，但事实并非如此，:)

我有一组急切加载和相关的数组。这是代码（Laravel）

```
$user = User::with(array('profile','classrooms','warnings','observation','complaint','pmainduction','workshops','grievances','grievances.grievanceaction'))
    ->where('id', '=', $id)->get(); 
```

这样可以在每个员工的个人资料页面中完美地获取数据。当我遍历申诉和每个申诉的 grievanceaction 时，它会复制数据并且不会像在 print_r 中那样显示它

数组的一部分是

```
[grievances] => Array
                    (
                        [0] => Grievance Object
                            (
                                [attributes] => Array
                                    (
                                        [id] => 1
                                        [user_id] => 8
                                        [company] => Company name
                                        [date] => 2012-12-24
                                        [nature] => Visa
                                        [details] => can't renew visa.                                                                                         [action] => emailed company
                                        [status] => 1
                                        [created_at] => 0000-00-00 00:00:00
                                        [updated_at] => 0000-00-00 00:00:00
                                    )

                                [original] => Array
                                    (
                                        [id] => 1
                                        [user_id] => 8
                                        [company] => Company name
                                        [date] => 2012-12-24
                                        [nature] => Visa
                                        [details] => can't renew visa.                                                                                  [action] => emailed company
                                        [status] => 1
                                        [created_at] => 0000-00-00 00:00:00
                                        [updated_at] => 0000-00-00 00:00:00
                                    )

                                [relationships] => Array
                                    (
                                        [grievanceaction] => Array
                                            (
                                                [0] => Grievanceaction Object
                                                    (
                                                        [attributes] => Array
                                                            (
                                                                [id] => 1
                                                                [action] => do something here                                                                                                                                [grievance_id] => 1
                                                                [created_at] => 2012-12-25 00:00:00
                                                                [updated_at] => 2012-12-25 20:03:04
                                                            )

                                                        [original] => Array
                                                            (
                                                                [id] => 1
                                                                [action] => do something here
                                                                [grievance_id] => 1
                                                                [created_at] => 2012-12-25 00:00:00
                                                                [updated_at] => 2012-12-25 20:03:04
                                                            )

                                                        [relationships] => Array
                                                            (
                                                            )

                                                        [exists] => 1
                                                        [includes] => Array
                                                            (
                                                            )

                                                    )

                                                [1] => Grievanceaction Object
                                                    (
                                                        [attributes] => Array
                                                            (
                                                                [id] => 2
                                                                [action] => some text here
                                                                [grievance_id] => 1
                                                                [created_at] => 2012-12-25 00:00:00
                                                                [updated_at] => 2012-12-25 00:00:00
                                                            )

                                                        [original] => Array
                                                            (
                                                                [id] => 2
                                                                [action] => some text here
                                                                [grievance_id] => 1
                                                                [created_at] => 2012-12-25 00:00:00
                                                                [updated_at] => 2012-12-25 00:00:00
                                                            )

                                                        [relationships] => Array
                                                            (
                                                            )

                                                        [exists] => 1
                                                        [includes] => Array
                                                            (
                                                            )

                                                    )

                                            )

                                    )

                                [exists] => 1
                                [includes] => Array
                                    (
                                    )

                            )

                        [1] => Grievance Object
                            (
                                [attributes] => Array
                                    (
                                        [id] => 5
                                        [user_id] => 8
                                        [company] => Company name
                                        [date] => 2012-12-25
                                        [nature] => Housing
                                        [details] => another issue here
                                        [action] => meet with company staff
                                        [status] => 1
                                        [created_at] => 2012-12-25 20:24:57
                                        [updated_at] => 2012-12-25 20:24:57
                                    )

                                [original] => Array
                                    (
                                        [id] => 5
                                        [user_id] => 8
                                        [company] => Company name
                                        [date] => 2012-12-25
                                        [nature] => Housing
                                        [details] => another issue here
                                        [action] => meet with company staff
                                        [status] => 1
                                        [created_at] => 2012-12-25 20:24:57
                                        [updated_at] => 2012-12-25 20:24:57
                                    )

                                [relationships] => Array
                                    (
                                        [grievanceaction] => Array
                                            (
                                                [0] => Grievanceaction Object
                                                    (
                                                        [attributes] => Array
                                                            (
                                                                [id] => 3
                                                                [action] => different text here
                                                                [grievance_id] => 5
                                                                [created_at] => 2012-12-25 00:00:00
                                                                [updated_at] => 2012-12-25 23:29:21
                                                            )

                                                        [original] => Array
                                                            (
                                                                [id] => 3
                                                                [action] => different text here
                                                                [grievance_id] => 5
                                                                [created_at] => 2012-12-25 00:00:00
                                                                [updated_at] => 2012-12-25 23:29:21
                                                            )

                                                        [relationships] => Array
                                                            (
                                                            )

                                                        [exists] => 1
                                                        [includes] => Array
                                                            (
                                                            )

                                                    )

                                            )

                                    ) 
```

如您所见，我有申诉对象 1 和 2，每个对象都有自己的申诉。在我的输出中，我想实现这一点

```
--------------------------------------------------------------
|  Grievance name: 1  |   Date:     |   Action:    |  Status: |
--------------------------------------------------------------
|   (grievanceaction data for 1st grievance in loop )        |
|   action: relationship action here      date: with date    |
|                                                            |
--------------------------------------------------------------
--------------------------------------------------------------
|  Grievance name: 2  |   Date:     |   Action:    |  Status: |
--------------------------------------------------------------
|   (grievanceaction data for 2nd grievance in loop )        |
|   action: relationship action here      date: with date    |
|                                                            |
-------------------------------------------------------------- 
```

我目前有

```
--------------------------------------------------------------
|  Grievance name: 1  |   Date:     |   Action:    |  Status: |
--------------------------------------------------------------
|   (grievanceaction data for 1st grievance in loop )         |
|                                                             |
|                                                             |
--------------------------------------------------------------
--------------------------------------------------------------
|  Grievance name: 2  |   Date:     |   Action:    |  Status: |
--------------------------------------------------------------
|   (grievanceaction data for 1st grievance in loop )         |
|                                                             |
|                                                             |
-------------------------------------------------------------- 
```

代码是

```
<table width="100%" class="table table-striped table-bordered">

@if(empty($user['0']->grievances))
   <thead>
   <tr>
   <th colspan="3">  No Grievances logged.</th>
   </tr>
   </thead>
@else
   <thead>

@foreach ($user['0']->grievances as $grievance )

<tr>
<th>Date: {{ date("d-M-Y",strtotime($grievance->date)) }}</th>
<th>Nature: {{ $grievance->nature }}</th>
<th>Initial Action:</strong> {{ $grievance->action }}  </th>
<th>Status: 

    @if ( $grievance->status == 1 )
          Active
    @else
          Resolved
    @endif
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="4">Description: {{ $grievance->details }} </td>
</tr>
<tr>
<td colspan="4">

              <!-- here is where i try and loop through the grievanceactions -->

              <table width="100%" class="table table-striped table-bordered">
              <tr>
              <th scope="col">Date</th>
              <th scope="col">Action</th>
              </tr>
              <tbody>
              @foreach ($user['0']->grievances['0']->grievanceaction as $grievance )
              <tr>
              <td>{{ date("D, d-M-Y H:i",strtotime($grievance->created_at)) }}</td>
              <td>{{ $grievance->action }}</td>
              </tr>
              @endforeach
              </tbody>
              </table>
</td>
</tr>
@endforeach

@endif
</td>
</tr>
</tbody>
</table> 
```

我真的很感激一些帮助，谢谢

:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T08:37:29.950

问题是你硬编码你总是从`$user['0']->grievances['0']`例如第一个中接受申诉。申诉循环应该是：

```
 @foreach ($grievance->grievanceaction as $grievanceaction )
              <tr>
              <td>{{ date("D, d-M-Y H:i",strtotime($grievanceaction->created_at)) }}</td>
              <td>{{ $grievanceaction->action }}</td>
              </tr>
              @endforeach 
```

编辑：一些注意事项：

1.  Blade 中有一个`@forelse`循环，它有一个`@empty`部分，这在顶部保存了一个 if。
2.  您不需要`get()`为用户使用，您可以简单地使用`first()`所以 ['0'] 不需要每次。
3.  通常将 *-many 关系命名为复数表示它是一个结果数组（grievanceaction -> grievanceactions）。

# macos - 从文件名导入 EXIF

> ID：14034312
> 
> 赞同：1
> 
> 时间：2012-12-25T22:04:31.463
> 
> 标签：macos, date, filenames, exif, exiftool

好的，所以有大量的示例和应用程序使用[ExifTool](http://www.sno.phy.queensu.ca/~phil/exiftool/)将 EXIF 数据转换为 .jpg 名称。但是如果你想反过来呢？我有许多使用 ODBC 日期但不包含元 EXIF 日期的文件。我如何 - 使用什么应用程序或 EXIFTool 命令行 - 从文件名更新 EXIF_DATE？

> 2012-02-24_1330073217.jpg

我通过 filenamepattern 找到了一个 Windows 应用程序 [EXIFDate 来](http://www.fileguru.com/EXIFDate-By-Filenamepattern/screenshot)执行此操作，但我是 mac 用户。：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-10-18T12:51:18.300

此命令将执行您想要的操作：

```
exiftool "-alldates<filename" DIR 
```

其中 DIR 是一个或多个目录和/或文件名。

# html - CSS/HTML 2x2 网格问题

> ID：14034313
> 
> 赞同：5
> 
> 时间：2012-12-25T22:04:48.067
> 
> 标签：html, css, grid

这个问题以前也出现过类似的问题，但我环顾四周，找不到其他人发生这种情况。

我可以制作一个 4x4 的 div 网格以及在 HTML 中使用的图像，但其中一个 div 是我想要的文本（右上角）。当我`<p>Some text</p>`在该 div 中输入时，它会在左侧的 div 下方，底部两个仍然对齐并在移动的文本 div 下方。

我尝试将高度固定，但没有任何改变，div 只是向上移动，但其他人保持原样。

CSS：

```
/* Page Content */

.container
    {width: 910px;
    height: auto;
    margin: 0px auto;
    padding-top: 35px;
    position: relative;}

/* Home Page Content */

.gridblock, .gridblock2, .gridtext
    {width: 450px;
    height: 200px;
    padding: 0px;
    position: relative;
    display: inline-block;}

.gridblock
    {margin: 2px;}

.gridblock2, .gridtext
    {margin: 3px, 0px, 3px, 0px;}

.gridtext
    {width: 450px;
    height: 200px;
    position: relative;
    background-color: #f9f9f9;} 
```

HTML：

```
<div class="container">
    <div class="gridblock">
        <img src="images/homegrid1.jpg" alt="3345 Mastering">
    </div>
    <div class="gridtext">
        <p>Some Text</p>    
    </div>
    <div class="gridblock">
        <img src="images/homegrid2.jpg" alt="3345 Mastering">
    </div>
    <div class="gridblock2">
        <img src="images/homegrid3.jpg" alt="3345 Mastering">
    </div>
    <ul class="footer">
    </ul> 
```

这是一个在线演示：http: [//jsfiddle.net/saidbakr/2LCwg/](http://jsfiddle.net/saidbakr/2LCwg/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T23:15:01.757

如果我的问题是正确的，那么问题似乎出在 property 上`display:inline-block`。

添加`vertical-align:top`到您的`.gridtext`班级：

```
.gridtext {
    vertical-align:top;
} 
```

它应该修复它。这是一个工作[小提琴](http://jsfiddle.net/2LCwg/2/)。

这是一篇关于 display:inline-block 属性的有趣文章[。](http://robertnyman.com/2010/02/24/css-display-inline-block-why-it-rocks-and-why-it-sucks/%22here%22)

或者，您可以删除该`display:inline-block`属性（默认情况下，您的 div 将显示为块）并给它们浮动：

```
.gridblock, .gridblock2, .gridtext {
    width: 450px;
    height: 200px;
    padding: 0;
    position: relative;
    float:left;
} 
```

此外，当您使用图像时，您可以添加`overflow:hidden`到上述类中，以确保这些图像不会扩展出其容器并弄乱网格。

```
.gridblock, .gridblock2 {
    overflow:hidden;
} 
```

# java - 无法在不同的包中加载类

> ID：14034315
> 
> 赞同：0
> 
> 时间：2012-12-25T22:04:52.730
> 
> 标签：java, reflection

我正在尝试访问另一个包中的类，但它不起作用。它一直在告诉我`ClassNotFoundException`。当我使用与它工作的类`Class.forName("x.testClazz")`相同的包中的`TestGenerator`类调用时。

```
package x;
public class TestGenerator {
    public static void main(String[] args) {
        try {
            Class<?> cls = Class.forName(
                "atv12.randomtesting.integration.classes.EasyBranch");
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
} 
```

任何解决方案？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-26T01:30:53.870

您可以尝试使用此代码

```
package org.benson.another;
public class TestIt {
public void sayHello(){
    System.out.println("hello");
}
} 
```

TestIt 类是

```
 package org.benson.test;
    import org.benson.another.TestIt;
    public class TestLoadClass {
    public static void main(String[] args) throws ClassNotFoundException, InstantiationException, IllegalAccessException {
        ((TestIt)Class.forName("org.benson.another.TestIt").newInstance()).sayHello();
    }
    } 
```

并尝试比较与您的代码有什么不同，也许您会找到解决方案

# sharepoint-designer - 如何在 InfoPath Designer 2010 中自定义工作流任务表单

> ID：14034318
> 
> 赞同：2
> 
> 时间：2012-12-25T22:05:23.457
> 
> 标签：sharepoint-designer, sharepoint-workflow, infopath2010

我有一个 Sharepoint 2010 站点。它包含一个列表。我创建了一个在该列表中添加项目时触发的工作流。工作流将与一些用户开始对**当前项目的****反馈过程。**我的查询是：

 **1.  如何在 InfoPath Designer 2010 中自定义任务表单，如在 Sharepoint Designer 2010 中遵循的步骤，这将引导我在 Infopath Designer 2010 中打开任务表单。
2.  我已将任务的持续时间设置为 7 天。我还允许将任务重新分配给其他人。但是当用户在任务表单中提供反馈并单击“**重新分配任务**”按钮时，弹出的下一个表单让用户有机会更改我不想要的任务持续时间。有什么办法可以做到这一点？
3.  我可以为一个工作流设置多个任务表单，这些任务表单可以通过单击任务表单本身上的按钮一个接一个地打开，例如，单击表单 A 中的按钮会在关闭表单 A 后导致表单 B 等等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T12:40:00.783

在进行了更多挖掘之后，我找到了问题的答案：

1.  发布工作流会使表单出现在 SharePoint Designer 2010 中相应工作流的“*表单”*部分中。从那里可以单击该表单并在*Infopath 2010*中对其进行编辑。

2.  当您在*Infopath 2010*中打开表单时，单击*页面设计*选项卡并将*视图*从*Main（默认）*更改为*ReassignTask*。这将显示“重新分配任务到”表单的模板。在这里，可以简单地删除允许用户更改截止日期的字段。

3.  没有深入研究这一点，因为上述解决方案已经解决了我的问题。**

# html - 网站图标不起作用

> ID：14034319
> 
> 赞同：5
> 
> 时间：2012-12-25T22:05:39.213
> 
> 标签：html, css

我的网站图标无法正常工作。它位于我项目的根目录中。我需要图标的绝对路径吗？

例如：`"C:/Users/Damian/www/favicon.ico"`或者我应该输入：

```
<LINK REL="SHORTCUT ICON" HREF="favicon.ico" > 
```

够了吗？我已清除浏览器的 cookie。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-25T22:06:42.460

相对路径很好，只要路径相对于您正在服务的文档。

看看下面的链接 - 它可能会有所帮助。

[http://www.w3.org/2005/10/howto-favicon](http://www.w3.org/2005/10/howto-favicon)

你使用的是什么浏览器？请记住，显示图标取决于浏览器，不同的浏览器可能有不同的方式来期望图标在 HTML 中的显示方式。如果您确定您的 HTML 是正确的，那么尝试其他浏览器可能会有所帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-25T22:08:15.350

如果您的网站图标与页面位于同一目录中：

```
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /> 
```

否则使用这个

```
<link rel="icon" href="your_url/favicon.ico" type="image/x-icon" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-25T22:11:34.753

favicon 只需要相对路径。它工作正常，但这是浏览器缓存的问题。尝试清除您的历史记录和缓存，然后重试。或者如果您使用 localhost 访问您的网站，请尝试使用 127.0.0.1

# ruby-on-rails - 如何在 routes.rb 中使用“post”

> ID：14034322
> 
> 赞同：0
> 
> 时间：2012-12-25T22:06:31.960
> 
> 标签：ruby-on-rails

请帮助我我已经创建了一个控制器`'users'`，其中包含用于登录用户的表单的视图`'login'`，我已将更改`routes.rb`更改`get user/login`为`post user/login`

现在当我去的时候`localhost:3000/users/login`出现：

```
Routing Error

No route matches [GET] "/users/login"
Try running rake routes for more information on available routes. 
```

请问应该怎么做才能使该页面工作，这个问题是因为我在路由器中将“get”更改为“post”，还有一些我应该添加的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:10:14.843

当您在浏览器中访问该 url 时，请求的类型是`GET`- 但是，正如您所说，现在这个请求没有路由。

`POST`当您在此页面上实际提交表单时，路由将很有用 - 使用简单提交（将`method`属性指定为`POST`）或 AJAX 请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T23:58:24.093

您可以在 routes.rb 中使用两者：

```
get user/login
post user/login 
```

这意味着控制器将识别使用这两种方法发出的请求。由您的控制器逻辑来解决它。get 通常用于呈现登录表单；post 将接收用户的用户名和密码，对他/她进行身份验证，然后重定向到成功登录的页面（或不成功，如有必要）。

我这样说可能会引发一些争议，但是如果您是初学者，并且希望通过用户身份验证制作一个“严肃”的网站，您可能不想留下任何机会，而是使用像设计这样的宝石（https： //github.com/plataformatec/devise) 为您完成。有人会说，最好先从头开始学习，这也是有一定道理的。

# c# - 更新/刷新绑定到 wpf/xaml 中另一个元素属性的 TextBlock

> ID：14034326
> 
> 赞同：0
> 
> 时间：2012-12-25T22:07:02.583
> 
> 标签：c#, wpf, xaml, listview, textblock

我想更新绑定到列表视图项属性的文本块中的文本。这是我将文本块绑定到列表视图项的方式。

**mWindow.xaml**

```
<ListView Name="ListViewDetails"               
      ItemsSource="{Binding Persons}" 
      SelectedItem="{Binding CurrentPerson}">
      ...
</ListView> 

<TextBlock>
     <Run Text="{Binding ElementName=ListViewDetails, Path=SelectedItem.Office}"/>
     ...
</TextBlock> 
```

如果列表视图中的项目属性发生更改，则文本不会更新。

**mWindow.xaml.cs**

```
public partial class mWindow: Window , INotifyPropertyChanged 
{

            private Person currentPerson;
            public Person CurrentPerson
            {
                get
                {
                    return currentPerson;
                }
                set
                {
                    this.currentPerson = value;
                    this.NotifyPropertyChanged("CurrentPerson"); 
                }
            }

            public event PropertyChangedEventHandler PropertyChanged;
            private void NotifyPropertyChanged(string propertyName)
            {
                var handler = this.PropertyChanged;
                if (handler != null)
                {
                    handler(this, new PropertyChangedEventArgs(propertyName));
                }

            }

            private void editLisView{

            ...

            // refresh ListView
            ICollectionView view =CollectionViewSource.GetDefaultView(ListViewInsuranceDetails.ItemsSource);
            view.Refresh();
            }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T09:25:07.343

我以为我必须为 CurrentPerson 属性实现 INotifyPropertyChanged。当我为人员类实现 INotifyPropertyChanged 时，它可以工作。

# google-apps-script - 将 Gzip 数据发布到 Google Apps 脚本

> ID：14034328
> 
> 赞同：0
> 
> 时间：2012-12-25T22:07:06.490
> 
> 标签：google-apps-script

我正在尝试将大型数据集从另一个网络服务上传到 google Apps 脚本。我想使用 Gzip 压缩和（我为 AutomaticDecompression DecompressionMethod.GZip 设置了一个标头）。但是，当我这样做时，我会收到 400 错误请求错误。Google Apps 脚本服务器是否支持自动解压缩？（我尝试了使用文件上传的解决方法，但是 e.Parameter 不显示文件 Blob，如本 [StackOverflow 帖子中所述](https://stackoverflow.com/questions/11785232/htmlservice-input-type-file/11957475#comment19358616_11957475)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:12:11.603

我能够弄清楚这一点。我正在发送压缩为 Deflate 而不是 GZip 的数据流。

# c++ - 将 [][] 放入 **

> ID：14034329
> 
> 赞同：3
> 
> 时间：2012-12-25T22:07:43.633
> 
> 标签：c++, c

> **可能重复：**
> [通过指针传递二维数组](https://stackoverflow.com/questions/3515045/passing-two-dimensional-array-via-pointer)

```
int table[20][20];
int** table1 = table;
int a;
table[0][0] = 4;
a = table1[0][0]; 
```

最后一行给了我访问冲突，我不明白..

提前致谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-25T22:11:15.790

简短的回答是指向指针的指针与数组数组不同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-25T22:19:07.767

您不能在一次赋值中从二维 int 数组创建 int **。首先，您需要分配正确数量的指针：table1 = malloc(sizeof(int*) * 20);

然后你可以使用一个循环来填写你的下一级指针：

```
for(int i = 0; i < 20; i++)
    table1[i] = table[i]; 
```

原因是指向指针的指针是一个保存地址的内存位置。当您进行第一次分配时，该指针指向 20 个 int 指针。然后我们为每个指针分配原始表中每一行的第一个地址。现在，当我们使用 时`a = table1[0][0]`，编译器将获取 table1[0] - 所以我们在循环中设置的数组中的第一个指针。这指向 table[0] 行，因此我们从中获取 [0] 元素，并获取填充在那里的 4 [当然，任何其他数字索引也将得到 4，因此很难证明它有效就在这种情况下）。

在这种`table[y][x]`情况下，编译器将获取 table 的地址，将 y * 20 * sizeof(int) 添加到它，然后添加 x * sizeof(int)。这让我们在“桌子”所在的“方形”内存块中占据了一个不错的位置。

（再次，输入太多，自从我开始写这篇文章以来，还有两个答案）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-25T22:23:55.040

C 编译器太宽容了：

```
int** table1 = table; 
```

cc：在函数'main'中：cc：3：17：警告：从不兼容的指针类型初始化[默认启用]

如果我们输入不正确的代码，编译器会抱怨，而我们忽略抱怨然后得到一些奇怪的结果，我们应该想知道吗？

无论如何，table1 并不指向指向 int 的指针，它崩溃的方式是实现问题（对齐、分段等）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-25T22:17:00.057

虽然 `table1[1]`是指针类型，但在`table`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-25T22:18:27.420

给定

```
int table[20][20]; 
```

`table`兼容`int*`，不兼容`int**`。

这应该编译并能够`table1`从`table1[0]`to访问`table1[399]`：

```
int* table1 = table; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-25T22:22:15.117

问问自己：给定一个指针，并被告知访问第 3、4 项 - 编译器应该如何知道二维数组的第一个维度有多大**，**以便跳过正确数量的项目？

正确：一点也不。

# java - org.springframework.security.oauth 和 org.codehaus.spring-security-oauth 有什么区别？

> ID：14034330
> 
> 赞同：2
> 
> 时间：2012-12-25T22:07:50.453
> 
> 标签：java, maven, oauth, spring-security, oauth-2.0

我正在尝试使用 Spring Security 学习 Oauth 身份验证，并且刚刚找到了两个版本的 spring-security-oauth 库。

```
<dependency>
    <groupId>org.codehaus.spring-security-oauth</groupId>
    <artifactId>spring-security-oauth</artifactId>
    <version>3.17</version>
</dependency>

<dependency>
    <groupId>org.springframework.security.oauth</groupId>
    <artifactId>spring-security-oauth</artifactId>
    <version>1.0.0.M6</version>
</dependency> 
```

我想知道是否有人可以告诉我区别以及首选的是哪个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T22:16:09.497

该[网站讲述了它是关于什么的](http://spring-security-oauth.codehaus.org/)。

> 该项目已被 SpringSource 作为 Spring Security 的官方扩展采用。主动功能开发已移至该位置。
> 
> 欢迎您继续使用 Codehaus 工件，但请注意这里没有开发任何新功能。这对那些仍在使用 Spring Security 2.x 的人有影响，因为新的开发只是为了支持 Spring Security 3.x。

# sql - 左上角和右上角单元格的 SQL 视图

> ID：14034344
> 
> 赞同：0
> 
> 时间：2012-12-25T22:10:06.600
> 
> 标签：sql, sql-server

==>[参考这个线程](https://stackoverflow.com/questions/12546369/view-to-identify-grouped-values-or-object)！

参考那里显示为最佳解决方案的输出，我怎样才能获得边界单元格？即 min(StartX)、min(StartY) 和 max(EndX) 和 max(EndY) 或者在某些情况下 max(EndX+1) 或 max(EndY+1) 如果列或行被遗漏，例如这种情况下图中的 3,10 个（绿色边框是我的边界单元格）

![[边界框](http://tinypic.com/r/2moyvjo/6)](../Images/20c3bb34e8156121af4bb8a1be78f320.png)

X Y PieceCells 边界
1 1 (1,1)(2,1)(2,2)(3,2) (1,1)(3,2)
8 1 (10,1)(8,1)(8, 2)(9,1)(9,2)(9,3) (8,1)(10,1)

那么我想要这样：
BoundaryStartX, BoundaryStartY, BoundaryEndX, BoundaryEndY
1 1 3 2
8 1 10 3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:07:12.570

我可以使用几何数据类型非常简单地做到这一点。

```
declare @g geometry;
set @g = geometry::STGeomFromText(
   'POLYGON( (1 -1, 1 -2, 2 -2, 2 -3, 4 -3, 4 -2, 3 -2, 3 -1, 1 -1) )'
   , 0);

select @g, @g.STEnvelope(); 
```

几何从 SQL2008 开始可用。另请注意，我将您的坐标系转换为标准笛卡尔坐标系（原点右侧的正 x 轴，下方的负 y 轴）；你最好考虑做同样的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T04:52:13.140

```
use tempdb;
if exists (select 1 from sys.tables where name = 'grid')
    drop table grid;

if not exists (select 1 from sys.tables where name = 'tally')
begin
    create table tally (i int not null);
    with 
        a as (select 1 as [i] union select 0),
        b as (select 1 as [i] from a as [a1] cross join a as [a2]),
        c as (select 1 as [i] from b as [a1] cross join b as [a2]),
        d as (select 1 as [i] from c as [a1] cross join c as [a2]),
        e as (select 1 as [i] from d as [a1] cross join d as [a2])
    insert into tally
    select row_number() over (order by i) from e
    create unique clustered index [CI_Tally] on tally (i)
end

create table grid (
    x tinyint, 
    y tinyint, 
    cell as geometry::STGeomFromText(
    'POLYGON( (' + 
        cast(x as varchar) + ' ' + cast(-1*y as varchar) + ', ' +
        cast(x+1 as varchar) + ' ' + cast(-1*y as varchar) + ', ' +
        cast(x+1 as varchar) + ' ' + cast(-1*(y+1) as varchar) + ', ' +
        cast(x as varchar) + ' ' + cast(-1*(y+1) as varchar) + ', ' +
        cast(x as varchar) + ' ' + cast(-1*y as varchar) +
        ') )'
        , 0)
);

insert into grid (x, y) 
    values 
    (1,1),
    (2,1),
    (2,2),
    (3,2),

    (8,1),
    (9,1),
    (8,2),
    (9,2),
    (9,3),
    (10,1);

with cte as (
    select cell, row_number() over (order by x, y) as [rn]
    from grid
),
cte2 as (
    select cell, [rn]
    from cte
    where [rn] = 1

    union all

    select a.cell.STUnion(b.cell) as [cell], b.rn
    from cte2 as a
    inner join cte as b
        on a.rn + 1 = b.[rn]
), cte3 as (
    select cell
    from cte2
    where [rn] = (select count(*) from grid)
), clusters as (
    select i, cell.STGeometryN(t.i) as c
    from cte3 as [a]
    cross join tally as [t]
    where t.i <= cell.STNumGeometries()
)
select *, c.STEnvelope() from clusters 
```

此解决方案解决了您的原始问题和这个问题。我喜欢这个，因为你仍然可以使用你想要的任何奇怪的坐标系，它会做你想做的事。您所要做的就是相应地修改网格表上的计算列。我将把信封角的计算留给读者作为练习。:)

作为解释，计算列根据给定的 x 和 y 坐标创建一个 1x1 几何实例。从那里，我基本上将所有这些结合在一起，这将产生一个多面体。从那里，我遍历多面体中的各个多边形以获得各个簇。信封免费提供。从这里，如果您愿意，您应该能够将最终选择（或非常类似的东西）包装在视图中。

# java - 将 Apache commons IO 添加到我的项目中

> ID：14034350
> 
> 赞同：3
> 
> 时间：2012-12-25T22:11:29.927
> 
> 标签：java, apache, jar, io

**你好呀，**

我已将**“Apache commons IO”** jar 添加到我的项目中，位于名为 libs 的文件夹中。 **Eclipse**不再对 Apache commons jar 中的类进行下划线，这让我认为它是正确链接的。

但是每当我导出我的 jar 并运行它时，我都会得到一个**java.lang.ClassNotFoundException**。我该如何解决这个错误？

附加信息： -**不**导出为**可运行**的 jar，因为这是一个插件。- 我确保 jar 在导出的 jar 中（使用 WinRAR 打开）

非常感谢您的帮助，我现在已经花了 2 个多小时在互联网上搜索！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T23:07:13.263

创建一个名为 Manifest.mf 的清单文件，并确保它包含在您的 jar 文件中。您可以在命令行中执行此操作，也可以将其作为构建的一部分包含在内。我过去曾使用 ant 将文件复制到 jar 中。

该文件应包含如下条目：

```
Manifest-Version: 1.0
Main-Class: com.myproject.MyMainClass
Class-Path: commons-io.jar 
```

如果该文件被打包到 META-INF 文件夹中的 jar 文件中，那么您应该可以在 Eclipse 之外运行它。我自己做的一件事是用 Eclipse 打包一个包含所有内容的可运行 jar，然后将 jar 与我自己的 jar 进行比较以查看差异。您还可以在代码中打印出类路径，并查看 Eclipse 使用的内容与您自己运行程序使用的内容之间的区别。

# c# - 在 C# 中创建一个 sql 连接

> ID：14034351
> 
> 赞同：1
> 
> 时间：2012-12-25T22:11:30.020
> 
> 标签：c#, .net, sql-server

我是这个网站的新手，也是编程的新手。我目前正在通过销售点创建库存系统。它使用模态和非模态形式。我的问题是，我正在处理`change password`必须连接到数据库才能覆盖密码字段的对话框。我使用的数据库是microsoft sql server management studio express。这是我到目前为止所拥有的必要评论。请注意，在“设计”表单上，我有一个绑定到数据库的组合框。我哪里做错了？

```
private void ChangePwdButton_Click(object sender, EventArgs e)
{
  SqlConnection sqlconn = new SqlConnection();
  sqlconn.ConnectionString = @"Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Users\Gerald-   dean Martin\Documents\SQL Server Management Studio Express\Projects\BodyMates.mdf;Integrated Security=True;User Instance=True";
     sqlconn.Open();
    string oldpwd = txtOldPwd.Text;
    string newpwd = txtNewPwd.Text;
    string confirmNewPwd = txtConfirmNewPwd.Text;
    string sqlquery = "UPDATE [Employee] SET Pwd=@newpass where EmployeeCode=@empcode";
    SqlCommand cmd = new SqlCommand(sqlquery, sqlconn);
    cmd.Parameters.AddWithValue("@newpass", txtConfirmNewPwd.Text);
    cmd.Parameters.AddWithValue("@empcode", comboEmpCode.SelectedValue);
    //cmd.Parameters.AddWithValue("@pwd", txtNewPwd.Text);
    cmd.Connection = sqlconn;
    cmd.ExecuteNonQuery();
    SqlDataReader dr = cmd.ExecuteReader();             
    while (dr.Read())
    {
        if(txtOldPwd.Text == dr["pwd"].ToString() && (txtNewPwd.Text == txtConfirmNewPwd.Text))
        {
            if (comboEmpCode.SelectedIndex == 0)
            {
               string query = "UPDATE [Employee] SET Pwd = '" + txtConfirmNewPwd.Text + "'";
            }
        }

       // if ((txtNewPwd.Text == dr["newpwd"].ToString()) & (txtConfirmNewPwd.Text == (dr["confirmNewPwd"].ToString()))) { }
    }
   // MessageBox.Show("Password was changed Successfully!", "Password Change", MessageBoxButtons.OK, MessageBoxIcon.Information); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:29:30.967

您可以使用[`ExecuteNonQuery`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executenonquery.aspx)like`cmd.ExecuteNonQuery();`它返回`int`值。像这样使用它；

```
int i = cmd.ExecuteNonQuery(); 
```

而且也是[`ExecuteReader()`](http://msdn.microsoft.com/en-us/library/9kcbe65k.aspx)这样工作的；

```
SqlDataReader reader = command.ExecuteReader();
        while (reader.Read())
        {
            Console.WriteLine(String.Format("{0}", reader[0]));
        } 
```

您可以读取返回数据的列。像第一列`reader[0]`，第二列`reader[1]`等。

但是在所有这些信息之前，如果您是编程新手，您可以在 Stackoverflow 上找到很多书籍建议和有用信息。检查这些文章；

*   [每个程序员都应该读的最有影响力的一本书是什么？](https://stackoverflow.com/questions/1711/what-is-the-single-most-influential-book-every-programmer-should-read)
*   [https://stackoverflow.com/questions/477748/what-are-the-best-c-sharp-books](https://stackoverflow.com/questions/477748/what-are-the-best-c-sharp-books)
*   [https://stackoverflow.com/questions/2018/best-book-for-a-new-database-developer](https://stackoverflow.com/questions/2018/best-book-for-a-new-database-developer)

# ruby-on-rails - Rails 教程 Rspec 误区

> ID：14034354
> 
> 赞同：4
> 
> 时间：2012-12-25T22:11:44.137
> 
> 标签：ruby-on-rails, ruby, rspec

Michael Hartl 的 rails 教程的清单 6.20 显示了以下代码：

```
before do
    @user = User.new(name: "Example User", email: "user@example.com")
  end
  .
  .
  .
  describe "when email address is already taken" do
    before do
      user_with_same_email = @user.dup
      user_with_same_email.email = @user.email.upcase
      user_with_same_email.save
    end

    it { should_not be_valid }
  end 
```

我无法理解这个概念，因为@user.dup 返回完全相同对象的表示，该对象被复制到 user_with_same 电子邮件中，但@user 从未保存到文件中任何位置的数据库中。因此，user_with_same_email.save 测试应该每次都有效。但是，测试通过了。有人请解释一下...@user = User.new(...) 上是否有隐式数据库保存？我知道如果它是 User.create(...) 会有一个保存，但不是新方法。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T23:10:21.907

您不会错过隐式保存。

`user_with_same_email`确实保存正确（就我个人而言，我会一直使用 save! 来确保它不会默默地失败）

`@user`规范指定的是无法保存主题（即），因为数据库中存在具有相同电子邮件的行。

# javascript - 按 \n 分割时忽略尾随和前导换行符？

> ID：14034373
> 
> 赞同：4
> 
> 时间：2012-12-25T22:17:29.310
> 
> 标签：javascript, regex, string, split

我正在尝试将一些文本拆分为单独的行，同时为 JS 语法荧光笔保留空格：

```
var text = '\n\n\ntest\n\ntext\n\n'; 
```

当我使用`.split('\n')`时，我的数组中有一堆空白元素：

```
> text.split('\n');
["", "", "", "test", "", "text", "", ""] 
```

目前，我`.strip()`在拆分之前的文本，但这看起来很乱：

```
> text.replace(/^\s+|\s+$/g, '').split('\n');
["test", "", "text"] 
```

有没有办法在使用时忽略尾随和前导换行符`.split()`？我尝试编写一个正则表达式，但效果并不好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T22:23:29.260

```
var text = '\n\n\ntest\n\ntext\n\n lorem ipsum';
var arr = text.match(/[ \w]+/g);

console.log(arr); //=> ["test", "text", " lorem ipsum"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:23:29.637

您可以使用`split(/\n+/)`尽可能多的换行符然后拆分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T23:15:29.520

虽然我无法完全理解您的逻辑，但也许以下内容可以帮助您使用以下方法进行解析`split`：

```
var text = "\n\n\ntest\n\ntext\n\n",
    parsed = ("\n" + text + "\n").split(/^\n+|\n+$|\n/).slice(1, -1);

console.log(parsed);   // ["test", "", "text"] 
```

# c# - 如果我只有实体集名称和唯一属性的值，有没有办法从上下文中获取对象？

> ID：14034380
> 
> 赞同：1
> 
> 时间：2012-12-25T22:18:08.500
> 
> 标签：c#, entity-framework-5

我正在尝试编写一个同步程序。我有一个我对本地数据库的更改的日志表，并希望将它们应用到远程数据库。

对于每个日志条目，我需要在远程数据库中找到相应的记录，因为我知道实体集名称和名为 RowId 的唯一字段的值。RowId 不是主键。

我尝试将以下内容放在我的上下文类中，但这意味着每次添加新域类时我都必须编辑代码。

有没有办法在不使用巨大的 switch 语句的情况下编写程序？我的方法类似于 Entity Framework 的 GetObjectByKey 方法

这是我要替换的巨型 switch 语句

```
public object GetObjectByRowId(string EntitySetName, Guid RowId)
{
    switch ("People")
    {
        case AppDataEnum.People:
            return People.SingleOrDefault(x => x.RowId == RowId);
            break; 
```

ETC..

我也许可以通过让所有实体实现一个 IRowId 接口来解决它，但我希望 EF 有一个内置的方式

我在[这里问了一个相关的问题](https://stackoverflow.com/questions/15013379/can-i-use-entitykey-with-fields-that-are-not-keys)

我认为[这里](https://stackoverflow.com/questions/4766450/generics-and-entity-framework-how-do-i-return-a-different-type-depending-on-a-c)的答案可能会有所帮助。尽管在那种情况下，许多类型都是从同一个表中提取的。在我的场景中，许多表都有 RowId 字段。

```
Public Class Person : LoggedEntity
{
 public string FirstName { get; set; }
 public string LastName { get; set; }
} 
```

公共类组织：LoggedEntity { public string FirstName { get; 放; } 公共字符串姓氏 { 获取；放; } }

```
Public Class LoggedEntity
{  [Key]
    public int Id { get; set; }
    public Guid RowId { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:44:51.930

在这种情况下，您的唯一键由类型 + 唯一标识符的元组组成。如果我正确理解了您的问题，则每个给定类型的行 ID 都是唯一的，但不同类型的两个对象可能具有相同的行 ID。

您可以覆盖 GetHashCode 并根据类型和行 ID 的组合构造一个唯一的哈希。如何提出一个好的散列函数超出了这个问题的范围，但作为一个非常愚蠢的解决方案，你可以做类似 (Type.Name + RowId).GetHashCode()

这将返回从两者连接的字符串的哈希码。从那时起，您可以将所有内容放入 HashSet 并有效地检索对象。

如果效率不是问题，只需在它们自己的列表中跟踪每种类型的对象，并在查找特定类型时，只需遍历具有感兴趣类型的对象列表以查找特定的 RowId。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T02:53:53.363

在意识到涉及泛型的答案后，我终于得到了

```
 public TEntity GetEntityByRowId<TEntity>( Guid rowId) where TEntity : LoggedEntity
    {
        return Db.Set<TEntity>().SingleOrDefault(x => x.RowId == rowId);
    } 
```

# solr - Solr 中 OR 子句的行为

> ID：14034388
> 
> 赞同：0
> 
> 时间：2012-12-25T22:19:19.717
> 
> 标签：solr, solrnet

我的 solr 索引包含具有名为部门的字段的文档。此字段是多值非必需 int 字段。我想构造一个查询，其结果必须是并集

*   所有不包含外勤部门的文件
*   包含字段部门的所有文档，但字段的值仅限于选定的少数几个。

我尝试构建如下所示的查询：

```
-department:* OR (department:* AND department:(100 OR 200)) 
```

这不会返回任何结果。而如果我只是使用

```
-department:* 
```

或者

```
department:* AND department:(100 OR 200) 
```

，查询似乎运行良好。简而言之，在这种情况下，我无法理解 OR 子句的行为。任何指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T03:40:17.013

结帐[SolrQuery 语法](http://wiki.apache.org/solr/SolrQuerySyntax#Differences_From_Lucene_Query_Parser)

纯否定查询：-

> -field:[* TO *] 查找所有没有字段值的文档

你可以试试 ：-

> q=-部门：[* TO *] OR 部门：（100 OR 200）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T14:49:09.180

为了实现你想要的，我认为你可以使用[Solr grouping](http://wiki.apache.org/solr/FieldCollapsing)。

你可以给类似的东西，

```
&q=*&group=true&group.query=department:[100]&group.query=department:[200]&group.query=-department:[*] 
```

# ruby-on-rails - 比较 nil:NilClass 的两个日期未定义方法`>'

> ID：14034390
> 
> 赞同：0
> 
> 时间：2012-12-25T22:19:23.680
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我试图在我的控制器中比较两个日期这是代码

```
if @user.payment.count == 0
    some action
elsif @user.payment.last.active_until.to_date > Time.now.to_date
    some action
elsif @user.payment.last.active_until.nil?
    some action
end 
```

当我试图评估这个

```
elsif @user.payment.last.active_until.to_date > Time.now.to_date 
```

我收到此错误：

```
undefined method `>' for nil:NilClass 
```

但是我有相同的行以显示其他信息，并且效果很好。

我不明白为什么在控制器中不起作用。

在此先感谢您的帮助。

* * *

更新

这是我的控制台输出

```
1.9.3p286 :002 > u.payment.last.active_until
  Payment Load (0.2ms)  SELECT "payments".* FROM "payments" WHERE "payments"."user_id" = 10 ORDER BY "payments"."id" DESC LIMIT 1
 => Thu, 24 Jan 2013 
```

如果我在控制台中进行比较，我会得到：

```
1.9.3p286 :003 > u.payment.last.active_until.to_date > Time.now.to_date
  Payment Load (0.3ms)  SELECT "payments".* FROM "payments" WHERE "payments"."user_id" = 10 ORDER BY "payments"."id" DESC LIMIT 1
 => true 
```

* * *

更新 2

如果在我的控制器中为真而在控制台中为假，则相同，我认为这是问题所在

```
1.9.3p286 :010 > u.payment.last.active_until.nil?
  Payment Load (0.3ms)  SELECT "payments".* FROM "payments" WHERE "payments"."user_id" = 10 ORDER BY "payments"."id" DESC LIMIT 1
 => false 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T22:24:09.827

只需重新排序您的陈述，因此首先检查日期`nil?`：

```
if @user.payment.count == 0
  some action
elsif @user.payment.last.active_until.nil?
  some action
elsif @user.payment.last.active_until.to_date > Time.now.to_date
  some action
end 
```

PS：此外，请检查该`to_date`方法是否不会`nil`为非`nil`对象返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:26:20.853

你的问题是`@user.payment.last.active_until`

您应该在尝试访问该字段之前进行检查，`nil`您可能会看到它是空的

我养成的一个好习惯是，每次我访问这样的链方法时，我都会检查值是否不是`nil`，所以我不会意外调用方法，`nil`除非我绝对 100% 确定值永远不会为零。

```
payments = @user.payment

if payments.count == 0
    some action
elsif payments.last.active_until.nil?
    some action
elsif payments.last.active_until.to_date > Time.now.to_date
    some action
end 
```

或者，如果您想保留当时的相同代码

```
if payments.count == 0
    some action
elsif !payments.last.active_until.nil? && payments.last.active_until.to_date > Time.now.to_date
    some action
elsif payments.last.active_until.nil?
    some action
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T22:28:23.530

检查模型中的语法，包括验证。我在网上看到的有关此类错误的所有答案都只是语法错误。这个错误本质上是说你试图在左边的对象上调用一个比较，这恰好不存在，所以它可能是你的模型或验证的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-25T22:40:49.773

`to_date`返回的唯一方法`nil`是当您有一个空白字符串时。所有其他字符串都会引发某种异常。您需要检查空白字符串而不是`nil?`因为`"".nil? == false`。相反，使用`@user.payment.last.active_until.blank?`. 这将检查空白字符串和零。

```
if @user.payment.count == 0
    some action
elsif @user.payment.last.active_until.blank?
    some action
elsif @user.payment.last.active_until.to_date > Time.now.to_date
    some action
end 
```

除此之外，您将日期存储为字符串是否有充分的理由？

# python - 使用 QWebKit 的永久 cookie —— 从哪里获得 QNetworkAccessManager？

> ID：14034401
> 
> 赞同：3
> 
> 时间：2012-12-25T22:21:24.347
> 
> 标签：python, qt, cookies, qwebkit

我需要在使用 QWebKit 的应用程序中持久存储 cookie。我知道我必须创建一个子类`QNetworkCookieJar`并将其附加到`QNetworkAccessManager`. 但是我如何将它附加`QNetworkAccessManager`到我的`QWebView`或`QNetworkAccessManager`让它使用它？

如果这很重要，我会使用 Python 3 和 PyQt。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T10:59:56.537

`QWebView.page().networkAccessManager().cookieJar()`您可以通过/获取/设置 cookie jar `setCookieJar()`。

Qt 中包含的浏览器演示（在 C++ 中）展示了如何读取和写入 cookie 到磁盘。

# php - 多条件php

> ID：14034409
> 
> 赞同：5
> 
> 时间：2012-12-25T22:23:37.550
> 
> 标签：php, switch-statement

我写了一个有很多条件的简单脚本：

```
$item =12;
    if($item < 5)
    { 
    //display icon buyer
    }
    elseif ($item < 10)
    {
    //display icon buyer
    }
    elseif ($item < 15)
    {
    //display icon good buyer
    }
    elseif ($item < 20)
    {
    //display icon top buyer
    }
    // etc.... 
```

这是一个很长的多重条件，我知道这很糟糕。

我如何优化代码？

**笔记。** `switch`不可能，因为我正在使用运算符`<`and `>`等。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-25T22:26:53.380

比一堆条件更好的是寻找一个允许计算它的模式。

在您的情况下，它看起来是 5 步-非常适合除法。

* * *

或映射它：

```
$item = 12;

$icons = [
    10 => 'buyer',
    15 => 'good buyer',
    20 => 'top buyer',
];

foreach ($icons as $value => $icon) {
    if ($item < $value) {
        return $icon;
    }
}
return null; 
```

这允许更灵活的步骤（正如您在相关数据中所拥有的那样）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-25T22:33:04.147

试一试（[**演示**](http://codepad.org/yXzKJ2Rb)）：

```
<?php
function icon($item) {
    $icons = array(
        'buyer',
        'buyer',
        'good buyer',
        'top buyer'
    );
    $index = max(0, min(3, $item / 5));
    return $icons[$index];
}

$item = 12;
echo icon($item) . "\n";

$item = 1;
echo icon($item) . "\n";

$item = 100;
echo icon($item) . "\n"; 
```

* * *

只需添加到`$icons`数组中即可获得更多选项/图标。

# sql - SQL 查询用于获取一个学期内注册超过 5 门课程的学生总数

> ID：14034412
> 
> 赞同：0
> 
> 时间：2012-12-25T22:24:03.073
> 
> 标签：sql

我是 sql 查询的新手，所以不太了解

我有一个名为registration的表

该表具有以下结构

```
Student_ID int,
Course varchar(15),
Score int,
Semester varchar(15),
Discipline varchar(10),
Campus varchar(15),
Degree varchar(10),
Year int 
```

它不包含任何主键它​​有来自同一所大学的 4 个不同校区的学生的数据，所以 student_id 是重复的

我需要在特定学期修读超过 5 门课程的学生总数

我希望我已经把问题说清楚了，如果有人可以的话，请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:35:43.570

使用`GROUP BY`和`HAVING COUNT`获取所有修过五门以上课程的学生：

```
SELECT student_id
FROM yourtable
WHERE Semester = ....
GROUP BY student_id
HAVING COUNT(DISTINCT Course) > 5 
```

要获取学生人数，您可以计算查询返回的行数：

```
SELECT COUNT(*) AS total FROM
(
    SELECT student_id
    FROM yourtable
    WHERE Semester = ....
    GROUP BY student_id
    HAVING COUNT(DISTINCT Course) > 5
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T23:30:47.113

要获得注册超过 5 门课程的学生，请执行以下操作...

```
SELECT CAMPUS, STUDENT_ID
FROM REGISTRATION
WHERE SEMESTER = 'GIVEN SEMESTER'
GROUP BY CAMPUS, STUDENT_ID
HAVING COUNT(*) > 5; 
```

要获得注册超过 5 门课程的学生人数，请执行以下操作...

```
SELECT COUNT(*)
FROM REGISTRATION
WHERE SEMESTER = 'GIVEN SEMESTER'
GROUP BY CAMPUS, STUDENT_ID
HAVING COUNT(*) > 5; 
```

您需要按校园和学生 ID 分组，因为不同校园的学生 ID 重复。此外，如果我理解正确，主键应该是复合的（校园、学生 ID、学期、年份、课程）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T23:37:03.023

```
SELECT COUNT(DISTINCT(sub.Student_ID)) FROM
(
SELECT un.Student_ID, COUNT(*) FROM university un 
GROUP BY un.Student_ID, un.Semester
HAVING 
COUNT(un.Course)>5
) AS sub 
```

我假设表名是大学

# asp.net - How to exclude Webresource.axd from firing my custom HttpModules

> ID：14034415
> 
> 赞同：1
> 
> 时间：2012-12-25T22:24:35.620
> 
> 标签：asp.net, httpmodule, preconditions

I've been searching around all day on the web but found nothing. In my web.config I set:

```
<modules runAllManagedModulesForAllRequests="false"> 
```

And

```
<add name="MyModule" type="namespace.to.MyModule" preCondition="managedHandler" /> 
```

And this is preventing MyModule (hooked to PostAuthenticateRequest in this example) from being fired on static resources like images, css, js and so on. But the module is still fired by .axd files inside the page, in particular it's fired from WebResource.axd

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T11:27:16.027

I added this check in my HttpModule and it works:

```
 ' Skip the module for non aspx requests like .axd or url without default document
     Private Sub Application_PostAuthenticateRequest(ByVal source As Object, ByVal e As EventArgs)
        Dim request = DirectCast(source, HttpApplication).Request
        If request.CurrentExecutionFilePathExtension.ToLower <> ".aspx" Then
            Exit Sub
        End If 
```

This is hooked to PostAuthenticateRequest. If you hook to other events, like for example OnEndRequest, beware you have access to HttpContext and not HttpApplication so add this instead:

```
 Protected Overridable Sub OnEndRequest(context As HttpContext)          
  ' Skip the module for non aspx requests like .axd or url without default document
        Dim request = context.Request
        If request.CurrentExecutionFilePathExtension.ToLower <> ".aspx" Then
            Exit Sub
        End If 
```

Also note that when calling an URL without document, like for example [http://www.yoursite.com](http://www.yoursite.com) IIS triggers a request to [http://www.yoursite.com/Default.aspx](http://www.yoursite.com/Default.aspx) (or whatever def document you set). So even if your page is empty you will trigger 2 requests. IIS Site states that "For default document requests, the first request is to an extensionless URL. Therefore, IIS does not run any managed modules that are marked with a precondition of managed Handler during initial request processing." But that's not true. Even with my HttpModule marked with attribute precondition="managedHandler" with a request like [http://www.yoursite.com/](http://www.yoursite.com/) it still gets triggered two times (one for / and one for /Default.asp). Anyway with the workaround posted here above you solve this as well.

# javascript - 为移动设备缩放大型 CSS 背景图像

> ID：14034418
> 
> 赞同：1
> 
> 时间：2012-12-25T22:24:58.707
> 
> 标签：javascript, css, image, background, responsive-design

我目前正在构建一个 XenForo 主题，该主题旨在使用透明度和有趣的 CSS3 效果展示全屏、中等高分辨率的照片背景。然而，我担心一个相当讨厌的缩放问题——尤其是在小型设备上。正如您可能想象的那样，想到访问者试图在 3G 或 GPRS 连接上加载近 1 兆字节的照片，我感到很痛苦。

有问题的背景是附加到`<html>`元素的固定背景图像。

处理规模问题的合适方法是什么？我只会做这么多的压缩，那么基于 JavaScript 的解决方案为视口/设备提供适当大小的图像是否足够有效？还有其他我可以考虑的解决方案吗？

谢谢你的时间 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T23:12:18.543

您应该向移动浏览器提供较低分辨率的图像。一种方法是使用 CSS 媒体查询：http: [//mobile.smashingmagazine.com/2010/07/19/how-to-use-css3-media-queries-to-create-a-mobile-version-您的网站/](http://mobile.smashingmagazine.com/2010/07/19/how-to-use-css3-media-queries-to-create-a-mobile-version-of-your-website/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T23:15:15.380

如上所述，使用 CSS 功能`@media`，您可以为所有设备类型提供正确的图像尺寸。看看 Twitter 的 CSS 框架[Bootstrap](http://twitter.github.com/bootstrap/scaffolding.html#responsive)。

我建议对所有请求使用小图像，但仅将其替换为桌面浏览器，但平板电脑可以同时使用慢速互联网连接和快速 wifi 访问。这需要更复杂的解决方案。

此外，使用 AJAX 提供图像可能会大大加快页面速度。

# java - 反序列化后如何返回正确的对象类型？

> ID：14034421
> 
> 赞同：1
> 
> 时间：2012-12-25T22:25:56.210
> 
> 标签：java, serialization

我目前正在为我的代码库开发一个序列化类。这是为了避免一遍又一遍地编写相同的代码。

因为这是我的代码库的一部分，所以我永远不知道我正在反序列化什么样的对象类。我想知道任何人都可以更新我的代码以使返回值成为我在方法变量中提供的那种类。希望这是有道理的:)

```
public static Object deserializeObject(File serializedFile) {
    Object returnObject;
    if (!serializedFile.exists() || !serializedFile.canRead()) {
        return null;
    }
    try {
        //use buffering
        InputStream file = new FileInputStream(serializedFile);
        InputStream buffer = new BufferedInputStream(file);
        ObjectInput input = new ObjectInputStream(buffer);
        try {
            //deserialize the List
            returnObject = input.readObject();
        } finally {
            input.close();
        }
    } catch (ClassNotFoundException ex) {
        ex.printStackTrace();
        return null;
    } catch (IOException ex) {
        ex.printStackTrace();
        return null;
    }

    return returnObject;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:53:55.567

您可以像这样声明该方法：

```
public static <T> T deserializeObject(File serializedFile, Class<T> type) {
    ...
    return (T) returnObject; // Or return type.cast(returnObject);
} 
```

当您调用该方法时，您可以使用

```
MyObj myObj = deserializeObject(file, MyObj.class); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:29:07.140

是否要返回反序列化对象的类？如果是这样，你可以这样做

```
return returnObject.getClass().getName(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T22:59:31.790

您可以使用 instanceof 检查来查看您传入的对象类型，然后根据这种情况将其设置为适当的类型。

```
 public static void doSomething(Animal aAnimal){
    if (aAnimal instanceof Fish){
      Fish fish = (Fish)aAnimal;
      fish.swim();
    }
    else if (aAnimal instanceof Spider){
      Spider spider = (Spider)aAnimal;
      spider.crawl();
    }
  } 
```

您还可以添加另一个参数作为方法的输入，并传入要反序列化的对象类。通常我会把它命名为 Class clazz。

```
public static Object deserializeObject(Class clazz, File serializedFile) 
```

如果您传入类的类型，则可以使用该值强制转换您的对象。

# javascript - 儿童Javascript游戏

> ID：14034426
> 
> 赞同：3
> 
> 时间：2012-12-25T22:26:20.017
> 
> 标签：javascript, html, getelementbyid

我正在尝试用javascript制作游戏。我在代码中仍然有很多问题。代码应该有 2 个按钮；一个用于洗牌图像骰子和一个按钮来检查孩子是否写了正确的答案。

*   2 个按钮
*   1 个文本框
*   以及显示答案是否正确的地方

这是我的代码。

我不知道为什么当我放置 document.getElementbyID("test") 的来源时，它什么也没显示，因为我希望每次单击开始时都会选择一个随机图像。

我将不胜感激任何帮助，因为我仍然是 javascript 的初学者。

```
 <head> 

<script type="text/javascript">

function startf(){
var images = []; 
index = 0;
images[0] = "<img src='1.png' length=70px width=75px>";
images[1] = "<img src='2.png' length=70px width=75px>";
images[2] = "<img src='3.png' length=70px width=75px>";
images[3] = "<img src='4.png' length=70px width=75px>";
index = Math.floor(Math.random() * images.length);
take(index);

function take(ind)
{
return document.getElementbyId("ind")="What should i put here";
}
}
function check(){
var ch=getElementbyId("answer").value;
if (ch=index+1)
{
document.getElementbyId.innerHTML="TRUE";
}
else
{
document.getElementbyId.innerHTML="False";
}

}
</script><br>
</head>
<img id="test" src=""  alt="..." length="75px" width="75px" />

<body>

<input type="button" value="start" onclick="startf()">
<input id="answer" type="text" name="checkvalue" value="Enter Value" onclick="check()">
<div id="fa">
</div>
<input type="button" value=chek onclick="check()">

</body> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T22:39:55.127

1-放置并结束每个指令-->`;`

2- 不要直接使用 document.getElementById，至少会出现一次错误，你不希望这样。

```
function _e(id) {
   return document.getElementById(id);
} 
```

3-始终在 IF-ELSE 块周围放置括号和 (...)：

```
if (...) {
    //....
} else {
    //....
} 
```

4- 每个标签属性的值都应该有“”，例如：

```
<input type="button" value="start" onclick="check()" /> 
```

5-您只能将图像路径放在数组中，因为它似乎是需要在#test 图像中更新的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T22:31:08.313

这是`document.getElementById`检查外壳。你的检查功能是错误的......你不能为 document.getElementById 函数赋值。你的 if 也是错误的。你知道任何 JavaScript 吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T23:45:08.900

我猜你想要的可能是这样的。您似乎只是试图通过使用来添加或替换元素，`document.getElementById(id) = something`但这不是它的工作方式。相反，要将图像更改为另一个文件，您需要更改其`src`属性。（还有其他方法，但这可能是最简单的。）

```
// Declare the variable called number here so it can be accessed
// by all of the following functions.
var number;

// a simple function to save typing document.getElementById all the time
function _e(id) {
    return document.getElementById(id);
}
function startf() {
    // Pick a number between 1 and 4
    number = Math.floor(Math.random() * 4 + 1);

    // Set the image with id 'test' to have the source 1.png, 2.png etc.
    _e('test').src = number + '.png';
}

function check() {
    // note that == is used for comparison, = is used for assignment
    if (_e('answer').value == number) {
        _e('fa').innerHTML = "TRUE";
    }
    else {
        _e('fa').innerHTML = "False";
    }
}​ 
```

# vb6 - 在vb6中使用二维数组作为word mailmarge数据源的数据源

> ID：14034427
> 
> 赞同：1
> 
> 时间：2012-12-25T22:26:31.577
> 
> 标签：vb6, datasource, multidimensional-array, mailmerge, word-automation

我正在 vb6 中创建一个单词自动化来创建邮件标签的邮件标签。[**这**](http://support.microsoft.com/kb/258512)是一个使用文本文件作为数据源的帮助链接。现在我想使用二维数组作为数据源。我不知道如何使用二维数组而不是文本文件作为数据源。请帮忙。

# php - 如何在 php 中回显 php 和 html 的混合？

> ID：14034437
> 
> 赞同：-1
> 
> 时间：2012-12-25T22:28:28.733
> 
> 标签：php, html, echo

我有一个循环，每次循环运行时，我希望它回显一个新的 div，其中有一个 php 变量。这是我目前的代码：

```
<?php

$i = 1;
while($i <= 5){
    echo "<div class=\"box\"><p>"$confessions[$i]"</p></div>"
    $i++;
}

?> 
```

但是，这是行不通的。做这样的事情的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-25T22:32:04.817

您忘记将这些部分连接在一起：

```
 echo "<div class=\"box\"><p>".$confessions[$i]."</p></div>"; 
```

请注意我放置点运算符 (.) 的位置，该行也以分号结束。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T22:37:40.607

[*"当一个字符串用双引号或heredoc指定时，变量会在其中解析"*](http://php.net/manual/en/language.types.string.php#language.types.string.parsing)，所以如果你要使用双引号，你也可以这样做：

```
echo "<div class='box'><p>{$confessions[$i]}</p></div>"; 
```

*（为了便于阅读，我将您的 HTML 属性更改为使用单引号。HTML 规范允许使用单引号。）*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-25T22:32:18.313

这是最好的方法：

```
echo '<div class="box"><p>' . $confessions[$i] . '</p></div>'; 
```

*   你必须使用“。” 连接（连接）字符串
*   始终以分号结束您的命令；）
*   当您使用 ' 而不是 "时，您不必转义 HTML-"
*   PHP 处理使用 ' 实际上比使用 "
*   如果您使用的是带有语法高亮的 IDE，它会以与 HTML 不同的颜色显示变量

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-25T22:32:07.750

缺少 '.' 和 ';' - 如果您有错误报告和 display_errors，应该会出现解析错误。

```
echo "<div class=\"box\"><p>".$confessions[$i]."</p></div>"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-25T22:33:28.593

简单的。您必须在 php/html 回显中的 html 和 php 之间放置一个“和”。那个“和”就是“。” 您还必须以评论结束该行。

解决方案：

```
echo '<div class="box"><p>' . $confessions[$i] . '</p></div>'; 
```

# iphone - 在游戏中移动 UIView 的最佳方式（无需用户交互）

> ID：14034446
> 
> 赞同：-1
> 
> 时间：2012-12-25T22:30:10.200
> 
> 标签：iphone, objective-c, core-animation, accelerometer, move

我正在寻找一种良好且流畅的方式来一次移动`UIViews`多个`Screen`。`Action`应该在检测`Accelerometer`到加速度时发生。我已经尝试过这种方式：

```
- (void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration{

    CGPoint ObjectPos = Object.center;

    ObjectPos.x -= acceleration.x;

    Object.center = ObjectPos;
} 
```

（当然我添加了一些调整来改进运动检测），但总而言之，它仍然不是很流畅。

我希望核心动画有某种方式，但它似乎不适用于加速。

非常感谢您的帮助，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T22:49:45.237

我建议您阅读这篇文档：~~[Isolating the Gravity Component from Acceleration Data](http://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/MotionEvents/MotionEvents.html%23//apple_ref/doc/uid/TP40009541-CH4-SW11)~~和下面的部分，即“Isolating Instantaneous Motion from Acceleration Data”。

基本上，您需要过滤掉重力以获得平稳的运动。该链接提供了示例代码。

**编辑**：UIAccelerometer 在 iOS 5.0 中已被弃用，随附的文档似乎也不见了。

为了将来参考，我进行了一些挖掘，发现似乎是原始示例代码（[source](http://ios-programming.blogspot.nl/2011/11/gyroscope-accelerometer-ios-sdk.html)）的“复本”：

```
// This example uses a low-value filtering factor to generate a value that uses 10 percent of the
// unfiltered acceleration data and 90 percent of the previously filtered value

// Isolating the effects of gravity from accelerometer data
#define kFilteringFactor 0.1
- (void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration {
    // Use a basic low-pass filter to keep only the gravity component of each axis.
    accelX = (acceleration.x * kFilteringFactor) + (accelX * (1.0 - kFilteringFactor));
    accelY = (acceleration.y * kFilteringFactor) + (accelY * (1.0 - kFilteringFactor));
    accelZ = (acceleration.z * kFilteringFactor) + (accelZ * (1.0 - kFilteringFactor));
    // Use the acceleration data.
}

// shows a simplified high-pass filter computation with constant effect of gravity.

// Getting the instantaneous portion of movement from accelerometer data
#define kFilteringFactor 0.1
- (void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration {
    // Subtract the low-pass value from the current value to get a simplified high-pass filter
    accelX = acceleration.x - ( (acceleration.x * kFilteringFactor) + (accelX * (1.0 - kFilteringFactor)) );
    accelY = acceleration.y - ( (acceleration.y * kFilteringFactor) + (accelY * (1.0 - kFilteringFactor)) );
    accelZ = acceleration.z - ( (acceleration.z * kFilteringFactor) + (accelZ * (1.0 - kFilteringFactor)) );
    // Use the acceleration data.
} 
```

# c# - 将图片框动态添加到标签页时出现空引用错误

> ID：14034447
> 
> 赞同：0
> 
> 时间：2012-12-25T22:30:18.210
> 
> 标签：c#, bitmap

获取异常消息：

> 你调用的对象是空的。

我的代码是：

```
PictureBox myPicBox = new PictureBox();
myPicBox.Visible = true;
myPicBox.Image = Bitmap.FromFile(@"C:\Users\MyUser\Downloads\1341596825343s1jpg.jpg");
myPicBox.Dock = DockStyle.Fill;
this.MyTabPage.Controls.Add(myPicBox); 
```

`MyTabPage`选项卡控件中的第四页在哪里。有什么建议么？

**编辑：**

堆栈跟踪在这里

> 在C:\ShipSiegeTool\ShipSiegeDashBoard\Form1.cs 中的ShipSiegeDashBoard.Form1.LoadSpaceStations() 中：ShipSiegeDashBoard.Form1..ctor() 中C:\ShipSiegeTool\ShipSiegeDashBoard\Form1.cs 中的第46 行：ShipSiegeDashBoard.Program 中的第31 行。 C:\ShipSiegeTool\ShipSiegeDashBoard\Program.cs 中的 Main()：System.AppDomain._nExecuteAssembly(RuntimeAssembly 程序集，String[] args) 的第 18 行，Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
> 的 System.Threading.ExecutionContext .Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Threading.ThreadHelper.ThreadStart()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:49:11.550

我想您的`MyTabPage`控件尚未初始化。在初始化之前，您不应该尝试使用它。

# java - Java 冲突检测不起作用

> ID：14034452
> 
> 赞同：-1
> 
> 时间：2012-12-25T22:31:13.843
> 
> 标签：java

我过去曾就类似问题发表过帖子，但由于我缺乏细节，答案并没有真正与我需要的东西相关，所以我将尝试尽可能详细地解释我的问题，希望它会更容易让你明白我的要求。

我在 youtube 上观看了 Bucky 的 slick 游戏教程并制作了一个 2D Java 游戏，该游戏基本上是一个从上方（鸟瞰图）观看的 2D 玩家，可以通过用户键输入（上、下、左、右）在 2D 地图上移动。玩家四处移动的地图非常小，因此必须设置边界，以便玩家无法离开地图，以便您更好地了解这是如何完成的，这里是设置 voundries 的教程：

[http://www.youtube.com/watch?v=FgGRHId8Fn8](http://www.youtube.com/watch?v=FgGRHId8Fn8)

该视频还将向您展示游戏的确切内容。问题是，这些边界只需要一个轴，这意味着如果玩家向下走，您会说“如果玩家到达 X 轴上的坐标（数字），则将玩家移动到相反的方向，这样他就不能走再进一步。” 现在这给我带来了一个问题，因为这只需要一个轴，所以很容易设置和理解，但是如果你看视频，在地图上有一所房子，我希望我的播放器也不能走过去但这涉及到二维，我看过矩形碰撞之类的东西，并在其他帖子中看到过与它们相关的东西，但我感到困惑，因为我是 Java 新手，除了观看 Bucky 之外，目前还没有真正做太多事情教程。

目前我的游戏类代码有以下方法：初始化、渲染和更新。所以总结一下，我真的只是想建立一种不让我的玩家穿过房子的方法，我也会提到（我应该在我的其他线程中提到它）因为我对 Java 很陌生，请你帮忙一步一步地向我展示如何设置碰撞，我的意思是如果需要的话，甚至是像制作矩形这样的基础知识。

如果需要我的代码，请告诉我，我会尽快发布。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T22:58:14.627

在这种情况下，您的更新类还应该再添加一个条件来寻找房子。假设房子的坐标（假设矩形房子在这里用于其他形状只是改变 x 和 y 值）是 (x1,y1)(x1,y2)(x2,y2)(x3,y1) 你必须添加一个条件来制作确保 x 值不在 x1 和 x2 之间，同时 y 值不能在 y1 和 y2 之间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:40:56.167

您可以将板设置为具有诸如“isBlocked”之类的属性的类的 2x2 网格。默认情况下，棋盘边缘会将此属性设置为 true 以防止角色离开边缘。当您添加其他障碍物（例如房屋或墙壁）时，对象占据的网格位置也将属性设置为 true。然后在移动角色时，您只需检查角色移动到的网格位置是否将属性设置为 false 以查看它是否是允许的移动。这也使得保存关卡数据变得非常简单，因此您可以稍后从磁盘加载它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T22:36:05.863

两种可能的选择：

1.  扩展`Shape`或`Rectangle`或相关的 Slick 对象（它们应该存在 IMO）并检查`intersect()`

2.  寻找`(x1,y1)`并`(x2,y2)`重视它从外部开始并在内部结束。

假设您有 intersect() 方法：

```
//Grab the previous position
prevPosX = movingobject.X;
prevPosY = movingobject.Y;
//Update the position
movingobject.update();

//Test for collision
if(movingobject.intersects(targetobj)) {
    //If it collided, move it back 
    movingobject.X = prevPosX;
    movingobject.Y = prevPosY;
    //And reverse the direction 
    //(might want to do other stuff - e.g. just stop the object)
    movingobject.speed *= -1;  //Reverse the speed
} 
```

# asp.net-mvc-3 - MVC3：获取克隆对象的值

> ID：14034453
> 
> 赞同：0
> 
> 时间：2012-12-25T22:31:16.323
> 
> 标签：asp.net-mvc-3, drop-down-menu, model, clone

我有一个包含模型选项的下拉列表；当用户单击按钮时，我想添加一个类似的下拉列表。我的下拉列表和按钮定义为

```
<div id="parent">
    <div class="id">
        @Html.DropDownListFor(m =>m.mymodel)
    </div>
</div>
<input type="button" value="submit" onclick="JSFunc()"/> 
```

而函数，JSFunc() 是

```
var control = document.getElementById('id').cloneNode( true );
document.getElementById( 'parent' ).appendChild( new ); 
```

如何从控制器获取克隆对象的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:39:09.040

您必须将`name`新创建的属性设置为`<select>`与控制器中的参数名称匹配的唯一值。

（或参数属性名称，或其他任何取决于模型绑定器和您的情况）

# actionscript-3 - 在 AS3 中的 Equirectangular Map Projection 上将 LAT、LONG 转换为实际屏幕 X、Y 坐标

> ID：14034455
> 
> 赞同：3
> 
> 时间：2012-12-25T22:31:26.793
> 
> 标签：actionscript-3, flash, actionscript, geolocation, map-projections

我正在做一个关于地理位置的小项目。我需要在地图上突出显示某些城市`equirectangular projection`。我已经获得了`LON` `LAT`这些城市的值，我需要找到一种方法将这些值转换为屏幕上的实际 x、y 坐标，该坐标适用于任何大小的地图（使用等角投影）。我找到了一个代码，但它是为`Mercator projection`. 任何线索？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T22:42:57.257

这比做墨卡托投影要简单得多，试试这个功能：

```
public function getXY(lat:Number, lng:Number):Point
{
  var screenX:Number = ((lng + 180) * (mapWidth  / 360));
  var screenY:Number = (((lat * -1) + 90) * (mapHeight/ 180));

  return new Point(screenX,screenY);
} 
```

`mapWidth`并且`mapHeight`应该是您正在使用的地图图像的宽度和高度。此函数将根据地图大小返回从 LAT LON 到屏幕 X、Y 的转换坐标。

# java - 将侦听器添加到下拉菜单

> ID：14034467
> 
> 赞同：0
> 
> 时间：2012-12-25T22:34:01.407
> 
> 标签：java, combobox, swt

所以我在下面建立了一个下拉菜单：

```
new Label(shell, SWT.NONE).setText("Bet Type:");
betType = new Combo(shell, SWT.SINGLE | SWT.BORDER);
betType.setItems(new String[] {"   ", "NFL", "NBA", "CFB"});
betType.setLayoutData(gridData); 
```

我想要的是当有人选择其中一个下拉选项时，将调用我稍后将编写的函数。

我试过做这样的事情：

```
betType.addSelectionListener(new SelectionAdapter()) { ... } 
```

或者：

```
betType.addSelectionListener(new SelectionListener()) { ... } 
```

或者：

```
betType.addModifyListener(new ModifyListener()) { ... } 
```

而且我不断收到错误消息，说“无法实例化类型 ModifyListener 或 SelectionListener”等。如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T23:11:17.327

您的代码的问题是您`(`过早关闭第一个 -bracket。

这：

```
betType.addSelectionListener(new SelectionListener()) { ... } 
```

应该：

```
betType.addSelectionListener(new SelectionListener() { ... }); 
```

以下代码完全符合您的要求：

```
public static void main(String[] args)
{
    Display d = new Display();
    final Shell shell = new Shell(d);
    shell.setLayout(new GridLayout(1, false));

    new Label(shell, SWT.NONE).setText("Bet type:");

    final Combo betType = new Combo(shell, SWT.SINGLE | SWT.BORDER);
    betType.setItems(new String[] {"   ", "NFL", "NBA", "CFB"});

    betType.addListener(SWT.Selection, new Listener()
    {
        @Override
        public void handleEvent(Event arg0)
        {
            System.out.println(betType.getText());
        }
    });

    shell.pack();
    shell.open();
    while (!shell.isDisposed())
        while (!d.readAndDispatch())
            d.sleep();
} 
```

或者，这也可以：

```
betType.addSelectionListener(new SelectionListener()
{
    @Override
    public void widgetSelected(SelectionEvent arg0)
    {
        System.out.println(betType.getText());
    }

    @Override
    public void widgetDefaultSelected(SelectionEvent arg0)
    {
    }
}); 
```

# css - 可扩展的非矩形 CSS 按钮？

> ID：14034471
> 
> 赞同：3
> 
> 时间：2012-12-25T22:35:39.797
> 
> 标签：css, html

在网上搜索了很多之后，我发现了很多关于使用 CSS 设置提交按钮样式的建议和示例，但它们都生成了矩形按钮。我想制作一个非矩形按钮，它会自动调整大小以适应按钮图例。具体来说，我希望按钮看起来像这样（加或减圆角）：

![非矩形按钮](../Images/b55087b34291a1ac46547b8894d09714.png)

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T22:44:13.087

完全可以使用边框半径，但您必须使用 JavaScript 而不是`<button>`元素提交。

例如：

```
.icon {
background-color: lightblue;
width: 100px;
padding: 4px;
margin: 10px;

border-top-left-radius: 10px;
-moz-border-radius-topleft: 10px;
border-bottom-left-radius: 10px;
-moz-border-radius-bottomleft: 10px;

border-top-right-radius: 60px 22px;    
-moz-border-radius-topright: 60px 22px;   
border-bottom-right-radius: 60px 22px;   
-moz-border-radius-bottomright: 60px 22px;
} 
```

使：

![在此处输入图像描述](../Images/4edc3edc0522e538c8a02a1b32d68372.png)

现场观看：

[http://jsfiddle.net/9zamA/](http://jsfiddle.net/9zamA/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:48:36.783

您可以使用 CSS 边框三角形技巧：[http ://css-tricks.com/snippets/css/css-triangle/](http://css-tricks.com/snippets/css/css-triangle/)

你可以使用 svg。

# javascript - JS中如何引用当前对象的属性

> ID：14034476
> 
> 赞同：12
> 
> 时间：2012-12-25T22:36:27.210
> 
> 标签：javascript, object

> **可能重复：**
> [对象字面量声明中的自引用](https://stackoverflow.com/questions/4616202/self-references-in-object-literal-declarations)

我在 JS 中有一些简单的对象，比如这个例子：

```
var object = {
 firstname : 'john',
 lastname : 'paul',
 wholename : firstname + lastname
} 
```

那么这个简单的事情是行不通的；john 和 paul 在全名中未定义，因此我尝试使用仅在执行 function 时才有效的 'this' 运算符`(getWholeName(){return this.firstname+this.lastname} )`。但是如果我想使用变量而不是函数，我该怎么办？我也试过`object.firstname + object.lastname`，但它不起作用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-25T22:38:33.740

无法引用该对象，但您可以动态添加属性：

```
var object = { 
    firstname : 'john', 
    lastname : 'paul'
};

object.wholename = object.firstname + object.lastname; 
```

**编辑：**

为什么不将它包装在一个函数中呢？

```
var makePerson = function (firstname, lastname) {
    return {
        firstname: firstname,
        lastname: lastname,
        wholename: firstname + lastname  // refers to the parameters
    };
};

var object = makePerson('john', 'paul'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T22:45:52.583

在 Javascript 中，每个函数都是一个对象。您应该将 Object 的构造函数声明为如下函数：

```
function person(firstname,lastname)
{
this.firstname=firstname;
this.lastname=lastname;

this.wholeName=wholeName;

 //this will work but is not recommended.
 function wholeName()
 {
 return this.firstname+this.lastname;
 }
} 
```

你也可以通过原型化来为你的对象添加额外的方法，这是推荐的做事方式。更多信息在这里：

[http://www.javascriptkit.com/javatutors/proto.shtml](http://www.javascriptkit.com/javatutors/proto.shtml)

# c++ - c++中的布尔乘法？

> ID：14034478
> 
> 赞同：16
> 
> 时间：2012-12-25T22:37:24.397
> 
> 标签：c++, boolean, ternary-operator, standards-compliance

考虑以下：

```
inline unsigned int f1(const unsigned int i, const bool b) {return b ? i : 0;}
inline unsigned int f2(const unsigned int i, const bool b) {return b*i;} 
```

的语法`f2`更紧凑，但标准是否保证`f1`和`f2`严格等价？

此外，如果我希望编译器在编译时`b`和`i`已知的情况下优化这个表达式，我应该更喜欢哪个版本？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-25T22:44:13.357

嗯，是的，两者都是等价的。`bool`是整数类型，`true`保证`1`在整数上下文中转换为，而`false`保证转换为`0`.

（反之亦然，即非零整数值保证`true`在布尔上下文中转换为，而零整数值保证`false`在布尔上下文中转换为。）

由于您使用的是无符号类型，因此可以轻松地提出其他可能基于 bit-hack 但完全可移植的同一事物的实现，例如

```
i & -(unsigned) b 
```

尽管一个体面的编译器应该能够为您的任何版本自行选择最佳实现。

PS 虽然令我大吃一惊的是，GCC 4.1.2 实际上编译了所有三个变体，即它在基于乘法的变体中使用机器乘法指令。它足够聪明，可以`cmovne`在变体上使用指令`?:`使其无分支，这很可能使其成为最有效的实现。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-25T22:48:35.643

是的。可以安全地假设`true`is`1`和`false`is`0`像你一样在表达式中使用并且得到保证：

**C++11，整体促销，4.5**：

> bool 类型的右值可以转换为 int 类型的右值，false 变为 0，true 变为 1。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-25T22:40:56.300

编译器将使用隐式转换来生成`unsigned int`from `b`，所以，是的，这应该可以工作。您通过简单的乘法跳过条件检查。哪个更有效/更快？不知道。一个好的编译器很可能会优化我假设的两个版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-25T23:27:58.790

FWIW，以下代码

```
inline unsigned int f1(const unsigned int i, const bool b) {return b ? i : 0;}
inline unsigned int f2(const unsigned int i, const bool b) {return b*i;}

int main()
{
    volatile unsigned int i = f1(42, true);
    volatile unsigned int j = f2(42, true);
} 
```

用 gcc -O2 编译产生这个程序集：

```
 .file   "test.cpp"
    .def    ___main;    .scl    2;  .type   32; .endef
    .section    .text.startup,"x"
    .p2align 2,,3
    .globl  _main
    .def    _main;  .scl    2;  .type   32; .endef
_main:
LFB2:
    .cfi_startproc
    pushl   %ebp
    .cfi_def_cfa_offset 8
    .cfi_offset 5, -8
    movl    %esp, %ebp
    .cfi_def_cfa_register 5
    andl    $-16, %esp
    subl    $16, %esp
    call    ___main
    movl    $42, 8(%esp)   // i
    movl    $42, 12(%esp)  // j
    xorl    %eax, %eax
    leave
    .cfi_restore 5
    .cfi_def_cfa 4, 4
    ret
    .cfi_endproc
LFE2: 
```

如您所见，剩下的或`f1`或所剩无几。`f2`

就 C++ 标准而言，允许编译器在优化方面做任何事情，只要它不改变可观察的行为（*as if*规则）。

# jquery - jQuery - 处理许多其他表单中的特定表单

> ID：14034484
> 
> 赞同：0
> 
> 时间：2012-12-25T22:38:43.017
> 
> 标签：jquery, submit, selector, multiple-forms

我知道很多人为此创建了主题：“在同一页面上处理多个表单”。然而，在阅读了大部分内容之后，我没有找到解决方案。

我有一个列出一些文章的页面。借助滑块，用户可以在每个帖子上打分，然后提交。为了提交与文章关联的标记，我使用了函数 .each() 但我没有得到预期的结果：它是我提交的页面的最后一个表单，无论我提交什么表单。

HTML：

```
<form method="post" action="" class="vote-form">
    <input type="hidden" id="amount" name="amount" class="hidden" value="5" />
    <input type="hidden" id="post_id" name="post_id" value="<?php echo get_the_ID(); ?>" />
    <input type="submit" name="post_vote" value="VOTE">
</form> 
```

JS：

```
$( ".vote-form" ).each(function() {

    $( this ).submit(function() {

        // get all the inputs into an array.
        var $inputs = $('.vote-form :input');

        // get an associative array of just the values.
        var values = {};
        $inputs.each(function() {
            values[this.name] = $(this).val();
            alert(values[this.name]);
        });

        // ************ Save vote in AJAX *************
        // ...

        return false;
    });
}); 
```

当我提交其中一个表单时，警报会显示隐藏输入的每个值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:42:47.810

您需要获取`input`已确定元素的 s 。你可以使用`.find()`它。

```
$( ".vote-form" ).each(function() {
    var $this = $(this);
    $this.submit(function() {
        // get all the inputs into an array.
        var $inputs = $this.find(':input');
        ... 
```

您正在抓取所有存在的`input`元素，我怀疑因此在关联数组创建期间，具有相同元素的元素`this.name`在您处理匹配元素列表时被覆盖。

顺便说一句，您可以在匹配的元素集上删除`.each()`因为工作。`.submit()`

**注意：**我缓存`$(this)`在这里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:42:35.473

显然，它显示了所有数据，因为您`each()`在 class 的所有元素上使用循环`vote-form`。如果您只想显示提交的表单，只需删除 each 并使用单个提交事件触发器，例如：

```
$('.vote-form').submit(function() {

    // get all the inputs into an array.
    var $inputs = $(this).find(':input'); // Get all input fields of "this" specific form

    // get an associative array of just the values.
    var values = {};
    $inputs.each(function() {
        values[this.name] = $(this).val();
        alert(values[this.name]);
    });

    // ************ Save vote in AJAX *************
    // ...

    return false;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T22:44:23.477

从主要父元素（在您的情况下为表单）使用`find()`，您将搜索隔离到您正在使用的特定实例

```
 var $inputs = $(this).find(':input'); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-25T22:49:31.790

你的问题是上下文。通过选择您的输入

```
var $inputs = $('.vote-form :input'); 
```

您不会告诉 jQuery 特定的表单，因此它会选择所有具有“.vote-form”类的输入。我更喜欢在 jQuery-Selector 中传递上下文。所以它应该是这样的：

```
var $inputs = $(':input', $(this)); 
```

通过使用`this`，您可以在提交方法中获取表单对象。

工作 js-fiddle：http: [//jsfiddle.net/xuAQv/282/](http://jsfiddle.net/xuAQv/282/)

# django - 如何从现有的基本模型实例创建继承的 django 模型实例？

> ID：14034486
> 
> 赞同：4
> 
> 时间：2012-12-25T22:38:59.913
> 
> 标签：django, django-models, django-inheritance

我有两个[像这样](https://docs.djangoproject.com/en/dev/topics/db/models/#multi-table-inheritance)的 django 模型：

```
class Place(models.Model):
    name = models.CharField(max_length=50)
    address = models.CharField(max_length=80)

class Restaurant(Place):
    serves_hot_dogs = models.BooleanField()
    serves_pizza = models.BooleanField() 
```

我之前创建了一个`Place`实例，如下所示：

```
sixth_ave_street_vendor = Place(name='Bobby Hotdogs', address='6th Ave')
sixth_ave_street_vendor.save() 
```

现在，鲍比已经将他的街头小贩升级为餐厅。我怎么能在我的代码中做到这一点？！为什么此代码不起作用：

```
sixth_ave_restaurant = Restaurant(place=sixth_ave_street_vendor,
                                  serves_hot_dogs=True,
                                  serves_pizza=True)
sixth_ave_restaurant.save() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T23:38:08.863

这是我的解决方法：

```
sixth_ave_restaurant = Restaurant(place_ptr=sixth_ave_street_vendor,
                                  serves_hot_dogs=True,
                                  serves_pizza=True)
sixth_ave_restaurant.save_base(raw=True) 
```

如果你想用 做其他事情`sixth_ave_restaurant`，你应该再次得到它，因为它还`id`没有被分配，因为它在 normal 之后被分配`save()`：

```
sixth_ave_restaurant = Restaurant.objects.get(id=sixth_ave_street_vendor.id) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T22:56:32.800

您应该使用`place_ptr`而不是`place`.

```
restaurant = Restaurant.objects.create(place_ptr=sixth_ave_street_vendor,
                                       serves_hot_dogs=True, serves_pizza=True) 
```

# node.js - systemtap 分析 gc node.js

> ID：14034488
> 
> 赞同：0
> 
> 时间：2012-12-25T22:39:15.250
> 
> 标签：node.js, systemtap

我通过 nvm 安装了 node.js(0.9.4)，根据 changelog，它具有 systemtap 支持。

我在我的 Fedora linux 发行版上安装了 systemtap。

```
$ sudo yum install systemtap 
```

我使用了 Ben Noordhuis 的这个[要点](https://gist.github.com/4078925)。

```
$ stap -l 'process("node")' 
```

什么都不生产。

```
$ sudo stap gc.stp -c 'node test.js'
semantic error: while resolving probe point: identifier 'process' at gc.stp:7:7
        source: probe process("node").mark("gc__start")
                      ^

semantic error: no match
semantic error: while resolving probe point: identifier 'process' at :12:7
        source: probe process("node").mark("gc__done") 
```

我完全没有使用 systemtap 的经验，但喜欢玩弄它吗？它有什么可能？我可以查看代码消耗了多少内存（http://stackoverflow.com/questions/13126808/whats-the-node-js-memory-breakdown）？

* * *

更新以回答评论。

```
$ readelf -n node

readelf: Error: 'node': No such file

$ which node
~/nvm/v0.9.4/bin/node

$ readelf -n ~/nvm/v0.9.4/bin/node

Notes at offset 0x0000021c with length 0x00000020:
  Owner                 Data size   Description
  GNU                  0x00000010   NT_GNU_ABI_TAG (ABI version tag)
    OS: Linux, ABI: 2.6.32

Notes at offset 0x0000023c with length 0x00000024:
  Owner                 Data size   Description
  GNU                  0x00000014   NT_GNU_BUILD_ID (unique build ID bitstring)
    Build ID: 294da933883eaeaf7e848073dc3db6bff6762fb4

$ uname -a
[alfred@alfred81-AMILO-Pi-2515 gc-stap]$ uname -a
Linux alfred81-AMILO-Pi-2515.lan 3.6.3-1.fc17.x86_64 #1 SMP Mon Oct 22 15:32:35 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux

$ stap -V
Systemtap translator/driver (version 2.0/0.154, rpm 2.0-1.fc17)
Copyright (C) 2005-2012 Red Hat, Inc. and others
This is free software; see the source for copying conditions.
enabled features: AVAHI LIBRPM LIBSQLITE3 NSS TR1_UNORDERED_MAP NLS 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T16:05:29.753

您的节点副本似乎是在没有 sys/sdt.h 标记的情况下编译的。如果它们被编译，`readelf -n`会显示类似...

```
 stapsdt              0x00000040   NT_STAPSDT (SystemTap probe descriptors)
    Provider: stap
    Name: stap_system__spawn
    Location: 0x000000000012e1b0, Base: 0x00000000001cb886, Semaphore: 0x0000000000000000
    Arguments: -4@%ebx -4@%eax 
```

也许它是用 --without-dtrace 配置的。

# c - fdlibm/e_pow.c 中的常数公式

> ID：14034489
> 
> 赞同：3
> 
> 时间：2012-12-25T22:39:31.943
> 
> 标签：c, math, floating-point

我试图了解[fdlibm/e_pow.c](http://www.netlib.org/fdlibm/e_pow.c)中幂函数的实现。有谁知道常数是如何计算的？特别是，我需要`dp_h[]`, `dp_l[]`, `L1`, `L2`, `L3`, `L4`, `L5`, `L6`, `P1`, , , `P2`, `P3`, `P4`, `P5`, `lg2`,`lg2_l`的`ovt`公式`cp_l`（尾巴是什么？）。

此外，给出的等式缺少括号。它应该是[(3/2)*(log(x)-2s-2/3*s**3)](http://www.wolframalpha.com/input/?i=3/2%2a%20%28log%28x%29-2s-2/3%2as%2a%2a3%29)吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-25T23:18:46.667

所有这些都是基于对链接源的非常粗略的检查：

`dp_h`并且`dp_l`是添加或不添加的高低调整项（取决于用于加载它们的数组索引），具体取决于减少参数所在的binade部分。

`Ln`和`Pn`分别是指数函数和对数函数的多项式逼近系数。如果没有更仔细的检查，很难确定，但从系数看，它们似乎是极小极大近似值，通常使用 Remes 交换算法计算。

`lg2`,`lg2_h`并且`lg2_l`是 log(2) 的近似值——分别是 log(2) 舍入为双精度位，舍入为 21 位，舍入为 21 位的残差舍入为双精度位。

`ovt`我认为是溢出阈值的缩写，用于在计算算法的指数部分之前确定结果是否溢出。人们需要更仔细地检查算法的细节，以准确解释它是如何推导出来的。

`cp_h`并`cp_l`一起形成 2/(3*log2) 的头尾近似。

“tail”是数学库设计中的常用名词；通常，库需要以比使用单个浮点值更高的精度来表示常量。所以常数表示为“头+尾”，其中“头”是舍入到某个位数的值，“尾”是常数 - 舍入到数据类型的头。

如果您不熟悉这类基本术语，那么您可能想先查看一些比 pow() 更简单的数学库函数；它是库中数学上最复杂的函数之一。我还建议查看 Muller 等人的[Handbook of Floating-Point Arithmetic](http://www.springer.com/birkhauser/mathematics/book/978-0-8176-4704-9)进行介绍。

# apache - 如何从不同的网络连接到我的 apache localhost？

> ID：14034493
> 
> 赞同：2
> 
> 时间：2012-12-25T22:40:14.500
> 
> 标签：apache, configuration, connection

如果两个设备在同一个网络中，我可以连接它，但是例如，如果我在我的 android 上使用 4G 并打开 wifi 并尝试连接，`http://computer-ip-address`那么它只会挂起并最终出错，说 count not connect。apache 服务器托管在我的本地 mac 中，我暂时禁用了防火墙。关于如何让设备使用不同的网络连接到我本地网络上的 apache 服务器的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T22:47:10.897

您将需要配置您的路由器，以便它将端口 80 从外部转发到您的 mac。

然后，您可以`http://your-public-Internet-ip`在手机上打开，有效地访问您本地的 Web 服务器。

如果您不喜欢记住您的 IP 地址，尤其是在旅途中，答案是 dyndns 或任何免费的替代方案，例如[http://www.no-ip.com/services/managed_dns/free_dynamic_dns.html](http://www.no-ip.com/services/managed_dns/free_dynamic_dns.html)。

使用这样的服务，您将能够进入`http://yourname.service.com`您的手机。您要么必须将路由器配置为始终告诉该服务您当前的 IP（检查您的路由器以获取支持的服务），要么在您的 mac 上运行一个小程序来处理这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-25T22:49:39.073

您需要在路由器上启用端口转发，以将 TCP 80（如果您使用 SSL，可能还有 TCP 443）转发到您的 Web 服务器 IP 地址。

完成后，您应该能够通过路由器的公共 IP 地址访问您的站点。

请注意，您的 Web 服务器正在使用 DHCP 提供的动态地址，您的 IP 可能会更改，这将使其无法正常工作。我建议你给你的网络服务器一个静态 IP 地址来阻止这个。

您的路由器上可能也有一个动态 IP，因此您可以向 ISP 请求一个静态 IP，或者您可以注册一个动态 DNS 服务。

如果您发布您的路由器型号，我们可能会为您提供有关设置端口转发的更具体说明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-25T22:43:45.593

我希望你的 httpd.conf 设置了端口监听

```
Listen 80 
```

此外，您只能从 LAN 访问您的站点，否则，您的服务器需要从公共 IP 地址访问，而不是通过 Internet 4g 连接的私有 IP 地址，这意味着不同的网络

奖励积分，如果您尝试从外部地址访问您的服务器，您是否在路由器上配置了端口转发？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-25T22:59:44.550

如果您可以立即`localhost`使用 4G 网络连接到您的网络，那么互联网上的任何人都可以这样做。重要的是要了解您的问题的答案有两个组成部分：

*   保护来自 Internet 的 HTTP 访问（端口 80 或其他）。您可能不想为您的本地网络敞开大门。
*   配置从您的客户端（在本例中为您的手机）到本地计算机（在本例中为您的 Mac）的寻址。如果后者没有公共 IP 地址，那么您将不得不配置您的客户端以访问您的路由器，并配置您的路由器以进行相应的转发。

鉴于这主要是系统配置工作，我猜测[Serverfault](https://serverfault.com/)将是一个更好的地方来找到令人满意的答案。

# c# - 使用 Dapper 的 IDbConnection 工厂

> ID：14034497
> 
> 赞同：3
> 
> 时间：2012-12-25T22:41:08.883
> 
> 标签：c#, asp.net, dapper

我在我的 ASP.NET WebForms 解决方案中使用了 dapper。

我所有处理数据的类都从这个基类中检索一个打开的连接

```
public abstract class SalesDb : IDisposable
{
    protected static IDbConnection OpenConnection()
    {
        IDbConnection connection = new SqlConnection(ConfigurationManager.ConnectionStrings["SalesDb"].ConnectionString);
        connection.Open();
        return connection;
    }

    public void Dispose()
    {
        OpenConnection().Dispose();
    }
} 
```

使用此基类的服务类示例

```
public class LeadService : SalesDb
{
    public IEnumerable<LeadDto> Select()
    {
        using (IDbConnection connection = OpenConnection())
        {
            return connection.Query<LeadDto>("Lead_Select",
                null, null, true, null, CommandType.StoredProcedure);
        }
    }
} 
```

`OpenConnection(`基类中的 ) 方法是静态的并且每次调用都返回一个新实例，这有什么缺点吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-25T23:20:29.827

您正在 dispose 中创建新连接？那是行不通的！使用超过 100 次迭代的简单循环（最大池大小默认为 100），您可能会看到某种异常（*打开的连接过多*，[*ExecuteReader 需要打开且可用的连接*](https://stackoverflow.com/questions/9705637/executereader-requires-an-open-and-available-connection-the-connections-curren)等）。

无论如何，我预计会出现严重的性能问题，因为池需要连续创建新的物理连接。

我不会重新发明[**Connection-Pool**](http://msdn.microsoft.com/en-us/library/8xx3tyca.aspx)。我的建议是：不要使用那个类，在 asp.net 中更是如此。

[不要在连接池的领土上偷猎](https://stackoverflow.com/a/9707060/284240);-)

**但**请注意，您的两个问题都可以用*No*来回答。静态方法不是问题（与静态连接不同），也不是它总是返回一个新连接（因为池将返回当前未使用的连接）。但是您班级的主要问题是`dispose`创建连接并打开它们。

# asynchronous - 了解 netty 的工作原理

> ID：14034500
> 
> 赞同：3
> 
> 时间：2012-12-25T22:41:34.917
> 
> 标签：asynchronous, netty

我试图了解 netty 是如何工作的，在阅读了一些文档之后，我想看看我是否理解了事情是如何在高层次上工作的。

基本上，netty 有一个事件循环，所以每当你调用它时，它都会被序列化，请求会被推送到 o/s 级别，它使用 epoll 并等待事件发送回 netty。

当操作系统生成一个 netty 订阅的事件时，netty 就会触发一个事件循环。

现在感兴趣的部分是，必须解析被触发的事件，并且客户端代码（或自定义代码）必须弄清楚这个事件实际上是针对谁的。

例如，如果这是用于聊天应用程序，当发送消息时，由客户端代码决定通过 ajax 将此消息发送给正确的用户。

这是对 netty 工作原理的正确概述吗？

顺便说一句，当 netty 监听通过 epoll 发送的事件时，这个事件循环是单线程的还是从线程池中工作的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T04:23:39.417

听起来对我来说是正确的。

Netty 中有多个事件循环线程，但这并不意味着单个 Channel 的事件由多个事件循环线程处理。Netty 选择一个线程并将其分配给一个 Channel。一旦分配，所有与 Channel 相关的事件都由选择的线程处理。

这也不一定意味着一个事件循环线程只处理一个 Channel。一个事件循环线程可以处理多个 Channel。

# wpf - DataGrid 不会更新 ViewModel

> ID：14034502
> 
> 赞同：1
> 
> 时间：2012-12-25T22:42:10.637
> 
> 标签：wpf, mvvm, wpfdatagrid

我有一个绑定到下面 ViewModel 的 ObservableCollection 的数据网格。Datagrid 将正确显示所有值，因此绑定似乎正在工作，但如果我更改某些值，Grid 将不会调用我的 VM 的设置器。有人能告诉我为什么吗？

这是我的视图模型：

```
 public class DocumentVm : ViewModelBase
{
    private Document document;
    public bool IsNew { get; private set; }
    public Document Document {
        get { return document; }
    }

    public DocumentVm(Document document)
    {
        this.document = document;
        IsNew = false;
    }

    public DocumentVm(Document document, bool isNew)
    {
        this.document = document;
        IsNew = isNew;
    }

    public String Name 
    {
        get { return document.Name; }
        set { document.Name = value; RaisePropertyChangedEvent("Name");}
    }

    public String Path
    {
        get { return document.Path; }
        set { document.Path = value; }
    }

    public String Metadata
    {
        get { return document.Metadata; }
        set { document.Metadata = value; }
    }

    public int SpeechId
    {
        get { return document.SpeechId; }
        set { document.SpeechId = value; }
    }

} 
```

这是 XAML 代码：

```
<DataGrid Margin="3" Grid.Row="7" Grid.Column="1" BorderThickness="0" 
      ItemsSource="{Binding Path=CurrentSpeech.Documents, Mode=TwoWay}" 
      SelectedItem="{Binding Path=CurrentSpeech.CurrentDocument, Mode=TwoWay}">
<DataGrid.Columns>
    <DataGridTemplateColumn Header="Name" Width="SizeToCells">
        <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
                <TextBox Text="{Binding Name, Mode=TwoWay}" />
            </DataTemplate>
        </DataGridTemplateColumn.CellTemplate>
    </DataGridTemplateColumn>
    <DataGridTemplateColumn Header="MetaDaten" Width="SizeToCells">
        <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
                <TextBox Text="{Binding Metadata, Mode=TwoWay}" />
            </DataTemplate>
        </DataGridTemplateColumn.CellTemplate>
    </DataGridTemplateColumn>
    <DataGridTemplateColumn Header="Pfad" Width="SizeToCells">
        <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding Path}" />
            </DataTemplate>
        </DataGridTemplateColumn.CellTemplate>
    </DataGridTemplateColumn>
</DataGrid.Columns> 
```

谢谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T13:24:58.993

UpdateSourceTrigger=缺少绑定上的PropertyChanged。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T01:05:40.130

Not sure why the setters aren't getting called but if you use dependency properties they actually do get called. I'm far too drunk to investigate why the CLR properties aren't getting set in your project but this works for me.

```
public partial class MainWindow : Window
{        public ObservableCollection<DocumentVm> Items
    {
        get { return (ObservableCollection<DocumentVm>)GetValue(ItemsProperty); }
        set { SetValue(ItemsProperty, value); }
    }
    public static readonly DependencyProperty ItemsProperty =
        DependencyProperty.Register("Items", typeof(ObservableCollection<DocumentVm>), typeof(MainWindow), new PropertyMetadata(null));

    public MainWindow()
    {
        InitializeComponent();
        Items = new ObservableCollection<DocumentVm>();
        Items.Add(new DocumentVm() { Name = "Name 1"});
        Items.Add(new DocumentVm() { Name = "Name 2"});
    }
}

public class DocumentVm : DependencyObject
{
    public string Name
    {
        get { return (string)GetValue(NameProperty); }
        set { SetValue(NameProperty, value); }
    }
    public static readonly DependencyProperty NameProperty =
        DependencyProperty.Register("Name", typeof(string), typeof(DocumentVm), new PropertyMetadata(null, new PropertyChangedCallback( (s, e)=>
            {
                // This will run when the property is set.
            })));        
} 
```

# git - 更改 GitHub 拉取请求的“基本仓库”

> ID：14034504
> 
> 赞同：15
> 
> 时间：2012-12-25T22:42:36.493
> 
> 标签：git, github, pull-request

对于 GitHub 拉取请求，您指定一个基本存储库（您希望更改的位置）和一个头存储库（它们来自哪里）。

但是，我想使用不在下拉列表中的基本仓库。是否可以将基础回购添加到列表中？两者之间存在关系（它们共享初始提交）

在我想要的实际存储库中，fork 没有 GitHub forks 通常在左上角的名称下方具有的标准“fork from”。但是，它*是*一个叉子；它只是没有通过 GitHub 系统分叉。如果您知道如何添加此元数据，我怀疑这也将允许拉取请求。（[这个问题](https://stackoverflow.com/questions/5749246/how-do-i-change-which-github-project-i-forked-from)询问如何更改“分叉来源”。但这部分没有回答）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T08:30:35.983

> 是否可以将基础回购添加到列表中？

不，不是自己。

Github 只允许你在它知道的分叉上执行拉取请求，并且无法在以后将两个 repos 注册为彼此的分叉。

您可以尝试两种选择：

1.  **通过 support@github.com联系 Github 支持**并（简要）描述您的情况，包括您的用户名和涉及的两个 repo。如果您向他们提出要求，他们可能能够将“分叉”状态添加到您的存储库中，从而允许您生成 PR
2.  **绕过 Github**来添加您的更改：Git 不依赖于诸如拉取请求之类的东西，您可以联系其他项目并要求他们合并您的更改。这可以通过多种方式完成，例如，您可以提供更改的补丁，或者他们可以添加您的 Github 存储库并合并或重新设置您的更改。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-03-29T15:06:52.123

尝试导航到以下网址：

https://github.com/[source]/[repo]/pull/new/[target:branch]...[source:branch]

[资源](http://srcmvn.com/blog/2013/03/14/sending-a-pull-request-on-github-even-when-the-base-repository-you-want-is-missing/)

# ssl - DH 与 DHE 和 ECDHE 以及完美的前向保密

> ID：14034508
> 
> 赞同：41
> 
> 时间：2012-12-25T22:43:05.437
> 
> 标签：ssl, public-key-encryption, diffie-hellman

Diffie-Hellman (DH) 是否提供完美的前向保密？还是仅适用于 Ephemeral Diffie-Hellman (DHE) 的功能？Elliptic Curve Ephemeral diffie-Hellman (ECDHE) 是否优于 DHE？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-12-26T13:08:41.507

正是 DHE 和 ECDHE 的短暂特性提供了完美的前向保密性。

这个想法是，即使有人记录流量并破坏服务器以获取其私钥，他们也无法破译该流量，因为他们将丢失不会保存的临时 DH 参数。在固定 DH 的情况下，私有 DH 参数实际上就是私有密钥：它们也会以同样的方式被破坏，并允许攻击者破译过去的流量。（请注意，无论如何，对固定 DH、非匿名密码套件的支持在实践中都非常罕见。）

DHE 提供的完美前向保密是有代价的：更多的计算。ECDHE 变体使用椭圆曲线加密来降低这种计算成本。[您可以在Vincent Bernat 的*SSL/TLS 和完美前向保密*文章](http://vincent.bernat.im/en/blog/2011-ssl-perfect-forward-secrecy.html)中找到更多详细信息和基准。

# html - 带有元数据的流式音频导致浏览器停止

> ID：14034512
> 
> 赞同：3
> 
> 时间：2012-12-25T22:44:01.173
> 
> 标签：html, audio, stream, ogg, icecast

我们有一个来自 icecast2 服务器的 ogg vorbis 流。在流中启用元数据后，当使用原生 html5 标记在 chrome 和 firefox 中启动新的逻辑流（当元数据更改时）时，流将停止播放（尽管仍连接到服务器）。但是，当元数据从音频流中禁用时，这不会发生。

```
<p><b>Example of audio tag in HTML5.</b></p>
<audio src="http://mysite:port/stream.ogg" controls ></audio> 
```

我们需要流中的元数据，所以我们不能禁用它。有谁知道解决这个问题？任何见解都会有所帮助。谢谢。

# c# - 有没有更好的永久链接解决方案

> ID：14034517
> 
> 赞同：1
> 
> 时间：2012-12-25T22:44:47.750
> 
> 标签：c#, asp.net-mvc

我正在用 C# 和 ASP.NET MVC 开发一个网站，人们可以在其中管理自己的网页。目前我正在使用 StackOverflow 的永久链接解决方案，但我不确定这是否适用于我的情况，因为人们会不断地添加和删除页面。这意味着 pages 表中的 id 会变得非常大。

示例：mydomain.com/page/ **17745288223** /my-page-title

有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T22:48:22.667

好吧，您可以使用某种散列来提高查找效率。例如，您可以计算页面标题、创建日期、用户信息等的 SHA-1 哈希 - 就像 git 对提交 ID 所做的那样。

或者您可以使用简单的数字，但使用十六进制数字或字母数字字符（如某些 url 缩短服务）将它们转换为一些紧凑的表示形式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T22:48:37.187

> 这意味着 pages 表中的 id 会变得非常大。

那有什么问题？

an 的最大值`int`也非常大（刚刚超过 20 亿），所以我怀疑它会达到任何限制，除非您计划拥有数百万用户，每个用户有数千页。

如果您仍然担心，那么您可以使用`long`（64 位整数）。它可以处理数以百万计的用户数以百万计的页面。请注意，地球上的人口只有几十亿。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T22:48:45.047

虽然这是作为评论开始的，但我认为它越来越大，所以它又来了……

页面 id 解决方案似乎很好。

你在担心什么？如果您期望有几百万页，那就是 7 个字符。如果您期望超过几十亿页，即 9 - 10 个字符。我认为这很容易管理。

您还可以将其表示为十六进制并将其减少到最多 8 个字符以适应最多 2^32 个不同的 id。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-25T22:56:10.593

我认为对于您的情况（用户创建页面），将单个用户创建的所有页面放在他/她自己的路径下实际上更加用户友好，即：

```
 mydomain.com/page/{username/nickname/some-name-selected-by-user}/my-page-title 
```

如果您不想使用这种格式，则 URL 中的`int`or`long`可能会这样做。

# jquery - HTML jquery Buttons 有时没有反应

> ID：14034521
> 
> 赞同：0
> 
> 时间：2012-12-25T22:45:35.773
> 
> 标签：jquery, html, button, click

嗨，我有几个简单的按钮，有时没有反应。它很少发生，但我仍然不喜欢它。如果您非常快速地单击或非常快速地更改导航，它会发生更多。这是我为他们准备的代码：

```
$(document).ready(function () { 
    $('[id*=txt]').hide();
    $('[id*=hd]').hide();                   
    $('[id*=home]').show();
    $('#btnhome').css('background-color',"#555");
    $('#btnhome').css('opacity',"0.4");

    $('.button').click(function (){
        $('[id*=txt]').hide();
        $('[id*=hd]').hide();
        $('.button').css('background',"transparent");
        $('.button').css('opacity',"1");
        $(this).css('background-color',"#555");
        $(this).css('opacity',"0.4");
   });          

    $('#btnhome').click(function () {   
        $('[id*=home]').show();             
    });     

    $('#btnabout').click(function () {              
        $('[id*=about]').show();        
    });    

    $('#btncontact').click(function () {        
        $('[id*=contact]').show();  
    });
}); 
```

这些是按钮：

```
<button class="button" id="btnhome">Home</button>          
<button class="button" id="btnabout">About</button>
<button class="button" id="btncontact">Contact</button> 
```

它们仅用于显示和隐藏文本，并且在单击时还会更改颜色不透明度等。当他们没有反应时，什么也没有发生，就好像我没有定义任何点击功能一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T23:02:47.660

我想你想要这样的东西

```
$(document).ready(function () { 
    $('.button').css({'background':'transparent', 'opacity':'1'})
    .eq(0).css({'background-color':'#555', 'opacity':"0.4"});

    $('.button').click(function (){
        $('.button').css({'background':'transparent', 'opacity':'1'});
        $(this).css({'background-color':'#555', 'opacity':'0.4'});
    });          
});​ 
```

[**演示**](http://jsfiddle.net/Pzqwf/)。

您也可以使用 `$('#btnhome').css({'background-color':'#555', 'opacity':"0.4"});`代替`.eq(0).css({'background-color':'#555', 'opacity':"0.4"});`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T23:05:29.520

我会做这样的事情（[演示](http://jsfiddle.net/Mottie/mMF5r/)）

CSS

```
.current {
    background-color: #555;
    opacity: 0.4;
    filter: alpha(opacity=40);
}​ 
```

HTML

```
<button class="button current" data-content="home">Home</button>          
<button class="button" data-content="about">About</button>
<button class="button" data-content="contact">Contact</button>
<hr>
<div class="content" id="home">Home text</div>
<div class="content" id="about">About text</div>
<div class="content" id="contact">Contact text</div> 
```

Javascript

```
$(function () { 

    var setCurrent = function(el){
        var $el = $(el),
            txtId = '#' + $el.attr('data-content');
        // show current content only
        $('.content').hide();
        $(txtId).show();

        // update buttons
        $el
            .addClass('current')
            .siblings().removeClass('current');
    };

    $('.button').click(function(){
        setCurrent(this);
    });
    $('.current').trigger('click');

});​ 
```

​</p>

# excel - 将范围复制到具有条件的新工作簿

> ID：14034522
> 
> 赞同：0
> 
> 时间：2012-12-25T22:45:44.770
> 
> 标签：excel, vba

![数据库](../Images/2c42fdfb4db9e607fd9f07b263ff18ee.png)

大家好！我一直在尝试为以下目的制作 vba 代码：将一系列工作簿（A1:F2 上方的屏幕截图）复制到新工作簿。我已经成功地做到了这一点。我想将另一个标准添加到 vba 代码中。vba 代码应仅复制第 2 行已填充值的列。因此，查看屏幕截图中的示例，这意味着通过运行 vba 代码，我会将范围 A1:A2 保存到新工作簿中， C1：C2，E1：E2。新的工作簿看起来像第二个屏幕截图

![截图2](../Images/75f2846c93bdfdf5b83bbc2777587c91.png)

任何帮助表示赞赏！提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T01:48:29.520

忽略空白的一种非常有用的方法（不循环）是使用`SpecialCells`. 下面的代码可能比您的问题所需的要长一些，但它是这样编写的

1.  可适配其他板材
2.  它将从第 2 行复制非空白，无论它们是值和/或公式
3.  在没有看到您的代码的情况下，它会复制到新工作簿

**代码**

```
Sub CopyEm()
Dim WB As Workbook
Dim ws As Worksheet
Dim rng1 As Range
Dim rng2 As Range
Dim rng3 As Range
Set ws = Sheets(1)
On Error Resume Next
Set rng1 = ws.Rows(2).SpecialCells(xlConstants)
Set rng2 = ws.Rows(2).SpecialCells(xlFormulas)
If rng1 Is Nothing Then
Set rng3 = rng2
ElseIf rng2 Is Nothing Then
Set rng3 = rng1
Else
Set rng3 = Union(rng1, rng2)
End If
If rng3 Is Nothing Then Exit Sub
On Error GoTo 0
Set WB = Workbooks.Add
rng3.Offset(-1, 0).Copy WB.Sheets(1).[a1]
rng3.Copy WB.Sheets(1).[a2]
End Sub 
```

# c - cuBlas，cuda 功能不工作，不产生错误

> ID：14034524
> 
> 赞同：0
> 
> 时间：2012-12-25T22:46:05.807
> 
> 标签：c, cuda, nvidia, cublas

这是一个说明问题的最小程序。我正在使用具有 128 个 CUDA 内核的 GTS 250，在 Windows 7 上使用 CUDA 5.0。

```
void cuda_ops_test(int N, float* R)
{
    //Values of input matrix in CPU
    fprintf(stderr, "\nValues of R: \n");
    for (int i=0; i<N; ++i)
        fprintf(stderr, "%f, ", R[i]);
    fprintf(stderr, "\n");

    //Initialize CUDA/CUBLAS
    cublasHandle_t handle;
    cublasStatus_t status;
    status = cublasCreate(&handle);
    if (status == CUBLAS_STATUS_SUCCESS)
        fprintf(stderr, "CUBLAS initialization succeeded.\n");

    //Allocate device memory
    float *dR = 0;
    cudaError_t alloc_status;
    alloc_status = cudaMalloc((void**)&dR, N*sizeof(dR[0]));
    if(alloc_status == cudaSuccess)
        fprintf (stderr, "\nDevice memory allocation succeeded.\n");

    //Load array into memory
    status = cublasSetMatrix(1, N, sizeof(R[0]), R, N, dR, N);
    if(status == CUBLAS_STATUS_SUCCESS)
        fprintf (stderr, "\nDevice write succeeded.\n");

    //First operation: summation
    float ans;
    status = cublasSasum(handle, N, dR, 1, &ans);
    if (status == CUBLAS_STATUS_SUCCESS)
        fprintf(stderr, "\ncublasSasum produced no error. Sum of dR: %d\n", ans);
    else
        fprintf(stderr, "\ncublasSasum error: %d.\n", status);

    //Second operation: y = ax+y
    const float alpha = 2.0;
    status = cublasSaxpy(handle, N,
                 &alpha,
                 dR, 1,
                 dR, 1);
    if (status == CUBLAS_STATUS_SUCCESS)
        fprintf(stderr, "\ncublasSaxpy produced no error.\n");
    else
        fprintf(stderr, "\ncublasSaxpy error: %d.\n", status);

    // transfer device dR to host R
    status = cublasGetMatrix (1, N, sizeof(dR[0]), dR, N, R, N);
    if(status == CUBLAS_STATUS_SUCCESS)
        fprintf (stderr, "\nDevice read succeded\n");

    //Display post-op values of R
    fprintf(stderr, "\nValues of R, after cublasSaxpy: \n");
    for (int i=0; i<N; ++i)
        fprintf(stderr, "%f, ", R[i]);
    fprintf(stderr, "\n");

    //Attempt to zero with cudaMemset
    cudaError_t stat = cudaMemset(dR, 0, N*sizeof(dR[0]));
    if (stat==cudaSuccess)
        fprintf(stderr, "\nZeroing with cudaMemset on R produced no error.\n");

    //Again transfer device dR to host R, after zeroing
    status = cublasGetMatrix (1, N, sizeof(dR[0]), dR, N, R, N);
    if(status == CUBLAS_STATUS_SUCCESS)
        fprintf (stderr, "\nDevice read succeded.\n");

    //Display values of R again
    fprintf(stderr, "\nValues of R, after zeroing with cudaMemset: \n");
    for (int i=0; i<N; ++i)
        fprintf(stderr, "%f, ", R[i]);
    fprintf(stderr, "\n");

    cudaFree(dR);
} 
```

这是输出，表明当数据被加载到 GPU 内存中时，实际上没有发生任何操作：

> R值：0.123020、0.367809、0.834681、0.035096、0.517014、0.662984、0.426221、0.104678、
> 
> CUBLAS 初始化成功。
> 
> 设备内存分配成功。
> 
> cublasSasum 没有产生错误。dR 总和：0
> 
> cublasSaxpy 没有产生错误。
> 
> cublasSaxpy 之后的 R 值：0.123020、0.367809、0.834681、0.035096、0.517014、0.662984、0.426221、0.104678、
> 
> 在 R 上使用 cudaMemset 清零没有产生错误。
> 
> 使用 cudaMemset 归零后的 R 值：0.123020、0.367809、0.834681、0.035096、0.517014、0.662984、0.426221、0.104678、

这是怎么回事？（和节日快乐。:)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T01:46:05.973

您的代码有几个错误。正如我在评论中提到的那样，您错过了您的设备读取和设备写入消息都没有被打印出来的事实，因为这些功能（cublasSetMatrix，cublasGetMatrix）实际上失败了。

要修复 cublasSetMatrix 和 cublasGetMatrix 调用，请将 `lda`和`ldb`参数更改为 1：

```
 status = cublasSetMatrix(1, N, sizeof(R[0]), R, 1, dR, 1);    
 ...     
 status = cublasGetMatrix (1, N, sizeof(dR[0]), dR, 1, R, 1); 
```

这些函数的[文档](http://docs.nvidia.com/cuda/cublas/index.html#topic_5_9)说：“源矩阵A和目标矩阵B的前导维度分别在lda和ldb中给出。前导维度表示分配矩阵的行数”

在打印出 cublasSasum 操作结果的行中，您的 printf 语句错误地使用 int 格式说明符打印出浮点值。这行不通。更改`%d`为`%f`：

```
 fprintf(stderr, "\ncublasSasum produced no error. Sum of dR: %f\n", ans); 
```

通过这些更改，我能够得到一个合理的结果：

```
Values of R:
0.123020, 0.367809, 0.834681, 0.035096, 0.517014, 0.662984, 0.426221, 0.104678,
CUBLAS initialization succeeded.

Device memory allocation succeeded.

Device write succeeded.

cublasSasum produced no error. Sum of dR: 3.071503

cublasSaxpy produced no error.

Device read succeded

Values of R, after cublasSaxpy:
0.369060, 1.103427, 2.504043, 0.105288, 1.551042, 1.988952, 1.278663, 0.314034,

Zeroing with cudaMemset on R produced no error.

Device read succeded.

Values of R, after zeroing with cudaMemset:
0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
```

请注意，[这个 SO 问题/答案](https://stackoverflow.com/questions/13041399/equivalent-of-cudageterrorstring-for-cublas/13041801#13041801)提供了一个有用、方便的 cublas 错误解析器功能的提示。将它构建到 cublas 函数调用的包装器或错误检查宏中并不难。

# graphics - 光线追踪折射看起来很“假”

> ID：14034525
> 
> 赞同：3
> 
> 时间：2012-12-25T22:46:19.290
> 
> 标签：graphics, 3d, transparency, raytracing, aero-glass

因此，在我正在构建的光线追踪器中，我已经获得了用于球体的折射以及焦散效果，但是玻璃球体看起来并不是特别好。我相信折射数学是正确的，因为光线似乎在反转你所期望的方式弯曲，但它看起来不像玻璃，它只是看起来像纸或其他东西。

我已经读过全内反射是造成玻璃看起来像它的大部分原因，但是当我测试我的折射光线是否超过临界角时，它们都没有，所以我的玻璃球体没有全内反射。我不确定这是正常的还是我做错了什么。我已经在下面发布了我的折射代码，所以如果有人有任何建议，我很想听听。

```
/*
 * Parameter 'dir' lets you know whether the ray is starting
 * from outside the sphere going in (0) or from in the sphere
 * going back out (1).
 */
void Ray::Refract(Intersection *hit, int dir)
{

    float n1, n2;
    if(dir == 0){ n1 = 1.0; n2 = hit->mat->GetRefract(); }
    if(dir == 1){ n1 = hit->mat->GetRefract(); n2 = 1.0; }

    STVector3 N = hit->normal/hit->normal.Length();
    if(dir == 1) N = -N;
    STVector3 V = D/D.Length();
    double c1 = -STVector3::Dot(N, V);
    double n = n1/n2;

    double c2 = sqrt(1.0f - (n*n)*(1.0f - (c1*c1))); 

    STVector3 Rr = (n * V) + (n * c1 - c2) * N;

    /*These are the parameters of the current ray being updated*/
    E = hit->point;  //Starting point
    D = Rr;          //Direction
} 
```

此方法在我的主要光线追踪方法 RayTrace() 期间调用，该方法以递归方式运行。下面是负责折射的一小部分：

```
 if (hit->mat->IsRefractive())
    {    
        temp.Refract(hit, dir); //Temp is my ray that is being refracted
        dir++;
        result += RayTrace(temp, dir); //Result is the return RGB value.
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-25T23:47:55.083

你是对的，你永远不会在球体中得到全内反射（从外面看）。这是因为对称性：球体内的光线会在两端以相同的角度射入表面，这意味着，如果它在一端超过临界角，那么它也必须在另一端超过临界角（因此一开始就无法从外部进入球体）。

但是，根据[菲涅耳定律](http://en.wikipedia.org/wiki/Fresnel_equations)，您仍然会得到很多*部分*反射。看起来您的代码无法解释这一点，这可能就是您的玻璃看起来很假的原因。尝试包括它，看看它是否有帮助。

（是的，这意味着你的光线在射到折射表面时会一分为二。这在现实中会发生，所以你只需要忍受它。你可以追踪两条路径，或者，如果你使用的是无论如何，随机光线追踪算法，只需使用适当的权重随机采样其中一个。）

附言。如果您不想处理光偏振之类的问题，您可能只想使用[Schlick](http://en.wikipedia.org/wiki/Schlick%27s_approximation)对菲涅耳方程的近似。

# actionscript-3 - as3如何跟踪哪个movieclip正在调度事件

> ID：14034527
> 
> 赞同：1
> 
> 时间：2012-12-25T22:47:07.867
> 
> 标签：actionscript-3, movieclip, dispatchevent

我正在做一个 fps 游戏。游戏包含多个敌人。但我称同一个电影剪辑为敌人。该movieclip 会发送fire 事件并减少玩家生命。但我需要知道哪个movieclip 正在调度事件。我随机添加了敌人，我需要知道刚刚开火的敌人的敌人位置。这是一些可能有帮助的代码...

```
dispatchEvent(new Event('Enemy_Fired')); // this event is dispatching from enemy movieclip

this.addEventListener('Enemy_Fired',ReduceLife);

    public function ReduceLife(e:Event){
        life--;
        var currentLife:int = life * lifeRatio;
        if(life<1){
            Game_Over();
            //game_completed();
        } else {
            sview.playerhit.gotoAndPlay(2);
            sview.lifebar.gotoAndStop(100 - currentLife);
            sview.health.text = String(currentLife);
        }
//Here i need to know this event dispatched from which enemy
    } 
```

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T22:49:55.797

您可以使用以下方法获取对调度事件的对象的引用：

```
e.target 
```

正如这行代码中所见，似乎父级正在调度事件。

`dispatchEvent(new Event('Enemy_Fired')); // this event is dispatching from enemy movieclip`

因为 dispatchEvent 与 this.dispatchEvent 相同，这意味着您的根类正在调度事件。

你需要把它改成这个 `yourEnemyMovieClip.dispatchEvent(new Event('ENEMY_FIRED',true,false);`

请注意，我将您的 Event 的 bubbles 属性设置为 true，并将其设置为 false。气泡意味着您的活动将在展示链上冒泡。这很重要，因为您正在根类中侦听事件，它比调度事件的影片剪辑高一级。

在此处查看 Event 类的构造函数：http: [//help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/Event.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/Event.html)

在您的事件监听器中添加以下内容

```
 e.stopImmediatePropagation(); 
```

这将阻止事件在显示链上向上冒泡，从而节省应用程序的性能。

# heroku - 如何在 heroku 上部署 matplotlib - 满足 numpy 要求

> ID：14034529
> 
> 赞同：3
> 
> 时间：2012-12-25T22:48:02.627
> 
> 标签：heroku, matplotlib

我正在尝试在 Heroku 上部署一个使用 matplotlib 的 Web 应用程序。这个[问题](https://stackoverflow.com/questions/13131512/install-matploblib-via-pip-in-a-virtualenv-to-push-to-heroku)是相关的，但似乎并没有解决我的具体问题。更准确地说，我正在部署一个重复的应用程序“登台”用于测试目的。当我运行命令时：

```
git push staging master 
```

将我的应用程序推送到 Heroku 我收到了意想不到的 Heroku 推送拒绝：

```
 ============================================================================
           BUILDING MATPLOTLIB
                       matplotlib: 1.1.1
                           python: 2.7.2 (default, Oct 31 2011, 16:22:04)  [GCC 4.4.3]
                         platform: linux2

           REQUIRED DEPENDENCIES
                            numpy: no
                                   * You must install numpy 1.4 or later to build
                                   * matplotlib.
           Complete output from command python setup.py egg_info:
           basedirlist is: ['/usr/local', '/usr']

       ============================================================================

       BUILDING MATPLOTLIB

                   matplotlib: 1.1.1

                       python: 2.7.2 (default, Oct 31 2011, 16:22:04)  [GCC 4.4.3]

                     platform: linux2

       REQUIRED DEPENDENCIES

                        numpy: no

                               * You must install numpy 1.4 or later to build

                               * matplotlib.

       ----------------------------------------
       Command python setup.py egg_info failed with error code 1 in /tmp/build_sj82km4g47z3/.heroku/venv/build/matplotlib
       Storing complete log in /app/.pip/pip.log
 !     Heroku push rejected, failed to compile Python app

To git@heroku.com:warm-atoll-3630.git
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:warm-atoll-3630.git' 
```

出乎意料，因为我认为我已经解决了这个问题。事实上，我的生产应用程序运行良好。我通过有一个两层需求文件来解决它。

要求.txt：

```
numpy==1.6.2
-r ./prod-requirements.txt 
```

产品要求.txt：

```
matplotlib==1.1.1
other requirements... 
```

显然我已经忘记了我是如何实际解决这个问题的。我记得由于 matplotlib 依赖于 numpy 的方式以及 Heroku 如何通过 pip 安装需求，这很棘手。这是我所指的[问题。](https://stackoverflow.com/questions/11797688/matplotlib-requirements-with-pip-install-in-virtualenv)可以做什么？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T00:37:04.853

我通过从 prod-requirements.txt 文件中删除 matplotlib 解决了这个问题（请参阅原始问题）。然后部署，然后将 matplotlib 添加到我的 prod-requirements.txt 文件中，然后再次部署。我假设这就是通过 requirements.txt 实现的目标：

```
numpy==1.6.2
-r ./prod-requirements.txt 
```

然后将 matplotlib=1.1.1 放入 prod-requirements 文件中。但显然不是。似乎我可以只用一个需求文件来实现这一点。

# php - 如何获取名称中包含 iso-8859-2 字符的远程图像？

> ID：14034534
> 
> 赞同：1
> 
> 时间：2012-12-25T22:48:42.320
> 
> 标签：php, image, curl

我正在使用 PHP 中的 cURL 从远程服务器保存和调整大量图像的大小，但是以前的开发人员没有实现任何类型的系统来使用户上传的图片“安全”，因此用户能够上传任何类型的具有任何名称的文件格式，然后上传的文件名按原样保存到数据库中，因此许多文件具有非 URL 安全和 iso-8859-8 字符。例如：

```
gaght101125659_5 Gn-eŐs mtó gÁrlós.jpg 
```

根据[这个答案](https://stackoverflow.com/a/12337698/1494454)，我制作了一个获取图片的代码。

```
private function getRemoteUrl($file)
{
  $ch = curl_init();
  curl_setopt($ch, CURLOPT_URL, $file);
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
  curl_setopt($ch, CURLOPT_BINARYTRANSFER, 1);
  $data = curl_exec($ch);
  curl_close($ch);
  return $data;
}

$img = imagecreatefromstring($this->getRemoteUrl($url));//$url contains the plain url of the image. 
```

此代码非常适用于名称为的图像，`gaht123115516_2.jpg`但对于上面显示的示例，它会给出错误消息：

```
Warning: imagecreatefromstring() [function.imagecreatefromstring]: Data is not in a recognized format in /home/test/public_html/resizing.php on line 64 
```

当然，因为花哨的角色。那么我应该如何`getRemoteUrl($file)`处理`$file`变量以使其工作？这可以在 PHP 中完成吗？如果不是，我应该尝试哪些其他方法/编程语言？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:52:21.477

[URL 编码](http://php.net/manual/en/function.urlencode.php)指定的文件名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T22:53:19.063

在文件名上使用`urlencode()`。不要`urlencode()`整个网址。

# ocaml - ocp-build.conf 多个工作进程的语法？

> ID：14034543
> 
> 赞同：3
> 
> 时间：2012-12-25T22:50:04.907
> 
> 标签：ocaml, opam, ocp-build

我想配置我的 OCaml OPAM 构建以并行运行多个工作进程。实际上在 OPAM github 上有一张票

[https://github.com/OCamlPro/opam/issues/310](https://github.com/OCamlPro/opam/issues/310)

这说我只需要编写一个 ocp-build.conf 文件。不幸的是，我完全没有找到任何关于这个配置文件语法的文档。我有 S'edTFW，如果我能找到它，我会很高兴 RTFM。

有谁碰巧知道如何为多个工作进程配置 ocp-build ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T10:23:37.713

第一次`ocp-build`调用时，它会在项目中创建一个全局文件`~/.ocp/ocp-build.conf`（`~`是您的主目录）和一个本地文件`ocp-build.root`。

根据您的 版本`ocp-build`，这两个文件都定义了一个选项`ncores`（旧版本）或`njobs`（最新版本）。在`ocp-build.root`中，默认值为`None`，表示未设置该值，应使用默认值（即来自全局文件的值）。

例如，在我的`~/.ocp/ocp-build.conf`文件中，我有`ncores = 5`（并且`njobs = 5`，因为我也使用最新版本），这意味着可以并行启动 5 个进程（我使用四核，所以任何大于 4 的都是好的）。

请注意，`ocp-build`如果依赖关系不是太强，或者您同时编译字节码和本机代码，则只能并行编译。

# asp.net-mvc-3 - 如何使用 mvc 3 下拉列表

> ID：14034545
> 
> 赞同：0
> 
> 时间：2012-12-25T22:50:26.280
> 
> 标签：asp.net-mvc-3

您好，我是 mvc 3 的新手，我需要一些指针/帮助来填充下拉列表。我有 3 个类是我的域类。基本上我想做的是制作一个下拉列表，其中将填充特定成员租借的电影。最简单的方法是什么？是使用 ViewBag 还是制作 ViewModel？

```
 public class Member
    {
        public virtual int MemberId { get; set; }
        public virtual long PersonalNr { get; set; }
        public virtual string Name { get; set; }
        public virtual string LastName { get; set; }
        public virtual List<Rental> Rentals { get; set; }
    }
    public class Movie
    {
        public virtual int MovieId { get; set; }
        public virtual string Name { get; set; }
        public virtual bool IsInStock { get; set; }

    }
   public class Rental
    {
        public virtual int RentalId { get; set; }
        public virtual int MovieId { get; set; }
        public virtual Movie Movie { get; set; }
        public virtual int MemberId { get; set; }
        public virtual Member Member { get; set; }

        public DateTime startDate { get; set; }
        public DateTime dueDate { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T22:59:07.747

最简单的方法是

```
@Html.DropDownListFor(
    x => x.SelectedRentalId,
    Model.Rentals
) 
```

更好地了解如何使用它，包括选择部分，se [Darin's answer](https://stackoverflow.com/users/29407/darin-dimitrov)

> [https://stackoverflow.com/a/6807331/28004](https://stackoverflow.com/a/6807331/28004)

# python - 为什么这个 Python Flask 路由器在被跨域 AJAX 调用 ping 时返回 400 错误？

> ID：14034550
> 
> 赞同：2
> 
> 时间：2012-12-25T22:52:36.250
> 
> 标签：python, jquery, flask, jqxhr

我有以下 Python Flask 路由器：

```
@app.route('/create', methods=['GET', 'POST'])
@crossdomain(origin='*')
def create():
    if request.method == 'POST':
        print(request.form)
        title = request.form['title']
        url = request.form['url']

        new_mark = Mark(
            title=title,
            url=url
        )
        new_mark.save()

        return new_mark 
```

当我进行 ajax 调用（如下）时，它会响应 400 错误。

```
$.ajax({
     type: 'POST',
     url: 'http://localhost:5000/create',
     data: {
            'title': sender.title,
            'url': sender.url
           },
     xhrFields: {
            withCredentials: true
           },
     dataType: 'json'
}); 
```

当我尝试打印出来时，`request`它会打印一个空的`immutableMultiDict`. 知道为什么它给出这个 400 以及为什么没有数据吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T23:06:16.883

您的 ajax 调用正在发送 json 编码的数据。我想你应该解码。

```
import json

data = json.loads(request.data)

print data.get("title") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T23:25:22.703

我很蠢。我实际上并没有发送任何数据，因为 sender.url 和 sender.title 不包含任何值-_-。

# javascript - jQuery在ajax之后修改我的html（img inside a）

> ID：14034553
> 
> 赞同：0
> 
> 时间：2012-12-25T22:53:15.210
> 
> 标签：javascript, jquery, image

我想创建无限滚动并使用 jQuery get 从服务器获取 html。我收到正确的 html 部分：

```
 <li>
    <dl>
        <dt>

            <a href=/product/1/>

                    <img src="/media/cache/14/9a/149a1ecabfd10c168495c70ab5ab6ddb.jpg" width="237" height="300" alt='Some text' />

            </a>
        </dt>
        <dd class="title">Some name</dd>
        <dd>Some text</dd>
        <dd class="price">

                <span class="old-price">&euro; 10.0</span>&euro; 8.0

        </dd>
    </dl>
</li> 
```

然后我尝试使用命令将此文本附加到 ul：

```
$(data).appendTo(container); 
```

但浏览器呈现下一个 html：

```
<li>
    <dl>
        <dt>

            <a href="/product/1"></a>

                    <img src="/media/cache/14/9a/149a1ecabfd10c168495c70ab5ab6ddb.jpg" width="237" height="300" alt="Some text">

        </dt>
        <dd class="title">Some name</dd>
        <dd>Some text</dd>
        <dd class="price">

                <span class="old-price">€ 10.0</span>€ 8.0

        </dd>
    </dl>
</li> 
```

正如我们所见，a 中的 img 在 a 之后变成了 img。jQuery创造了什么样的魔法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T23:00:55.610

`<a href=/product/1/>`被解释为`<a href="/product1"></a>`。尝试引用 href 的值。

# meteor - 在 Meteor 框架中操作模板实例的正确方法是什么？

> ID：14034556
> 
> 赞同：2
> 
> 时间：2012-12-25T22:54:18.107
> 
> 标签：meteor

我是 Meteor 的新手，想知道如何解决在我看来是一个常见问题。

假设我有一个列出餐厅的车把模板：

```
<template name="Restaurants">
  {{#each Restaurant}}
    {{name}}
  {{/each}}
</template> 
```

现在，当用户单击餐厅模板时，我想显示该餐厅的菜单。

我添加了一个名为“menuItems”的子模板，其中包含给定餐厅的所有菜单项：

```
<template name="Restaurants">
  {{#each Restaurant}}
    {{name}} 
    {{> menuItems}}
  {{/each}}
</template> 
```

当用户单击餐厅模板上的任意位置时，我只想渲染 menuItems 子模板的一个实例（仅渲染所选餐厅的菜单项）。

它应该是这样的：

```
Template.Restaurants.events({
'click' : function (e) {
       // This is where I need help - what's the right way to display only one subtemplate instance?
     }
}); 
```

我的问题是 - 我如何才能选择并只显示正确的 menuItems 模板实例？

此外，我想仅在单击之后而不是之前将 menuItems 模板实例放置在 DOM 中（拥有所有餐厅的所有菜单项并且仅隐藏这些 div 不是一个选项，因为 db 中这些项目的数量很大）。

如果您认为我应该以其他方式解决问题，请告诉我，谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T00:23:59.183

您应该使用`{{#if}}`和`Session`。像这样：

```
<template name="Restaurants">
  {{#each Restaurant}}
    {{name}} 
    {{#if restaurantSelected}}
      {{> menuItems}}
    {{/if}}
  {{/each}}
</template> 
```

通过使用`Session`反应式数据源，您可以设置一个全局标志来指示是否选择了一家餐厅。

```
Template.Restaurants.restaurantSelected = function() {
  // check whether this restaurant is selected. "this" refers to the current
  // context, eg. the current restaurant in the loop
  return Session.equals("restaurantSelected", this._id);
} 
```

每当您更改该会话密钥时，该值将更新并且模板将被重绘。因此，您可以在单击餐厅时切换它：

```
Template.Restaurants.events({
  'click' : function (e) {
    // store the current restaurant ID
    // make sure the event selector is correct!
    Session.set("restaurantSelected", this._id);
  }
}); 
```

**编辑**为了清楚起见，我创建[了一个完整的示例](https://gist.github.com/4376780)，您可以将其复制到您的项目中并试用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-16T07:16:54.107

我几乎总是避免使用 Session。我认为它污染了全球范围。它还阻止您运行模板的多个实例。我建议使用范围为模板实例的 reactiveVar 或 reactiveDict。感谢 Rahul 启动演示项目。我拿了他的例子并对其进行了修改以展示我推荐的方法。

将 reactiveDict 附加到模板实例 onCreate。使用它来存储状态而不是全局 Session var！

```
Template.Restaurants.onCreated(function() {
  this.state = new ReactiveDict;
  this.state.set('currentRestaurant', null); // could set a init value here
}); 
```

此事件处理程序将在单击时设置 reactiveDict 的状态

```
'click': function(e, t) {
    t.state.set('currentRestaurant', this._id);
} 
```

此助手用于显示/隐藏菜单模板

```
currentRestaurant: function() {
// check whether this restaurant is selected. "this" refers to the current
// context, eg. the current restaurant in the loop
return Template.instance().state.equals("currentRestaurant", this._id);
}, 
```

菜单模板从数据上下文而不是从 Session 接收选定的 id

```
<template name="Restaurants">
  <ul>
    {{#each Restaurant}}
    <li>
      {{name}}
      {{#if currentRestaurant}}
      {{> menuItems restaurant=_id}}
      {{/if}}
      </li>
    {{/each}}
  </ul>
</template>

<template name="menuItems">
  <ul>
    <li class="menu">I'm a menu for {{restaurantName}}!</li>
  </ul>
</template> 
```

添加这个助手只是为了表明我们真的得到了 id

```
Template.menuItems.helpers({
  restaurantName: function() {
    var restaurantMenu = Restaurants.findOne(this.restaurant);
    return restaurantMenu.name;
  },
}) 
```

将一个完整工作的项目发布到 github。 [https://github.com/white-rabbit-japan/scopedReactivityDemo](https://github.com/white-rabbit-japan/scopedReactivityDemo)

应用程序托管在meteor.com [http://scopedreactitivydemo.meteor.com/](http://scopedreactitivydemo.meteor.com/)

# bcrypt - pbkdf2 上如何发生暴力破解？

> ID：14034557
> 
> 赞同：1
> 
> 时间：2012-12-25T22:54:30.273
> 
> 标签：bcrypt, brute-force, pbkdf2, scrypt

很抱歉这个问题，但我问的是：使用 MD5 时，我们得到一个哈希，所以为了得到密码，我们对所有单词进行哈希处理，直到找到相同的哈希值。

但是在 pbkdf2 或 bcrypt 或 scrypt 等密钥派生算法中，黑客需要寻找什么？或者他会对所有单词做出相同的算法以获得相同的密钥推导？

很抱歉这个愚蠢的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:56:21.807

这是相同的一般想法 - 尝试所有哈希 - 但要慢几千（或百万，甚至十亿）倍。

# mysql - 来自 db 的结果，我应该使用 AJ 或 MYSQL Query 对它们进行排序吗？

> ID：14034558
> 
> 赞同：0
> 
> 时间：2012-12-25T22:54:36.997
> 
> 标签：mysql, optimization, angularjs

从 db 中检索数据时，我想按列对它们进行排序，并对它们进行 DESC 或 ASC 排序。我的 SQL 查询做我想做的事。但我想知道这样做的最快方法是什么？

问题是我认为用户在更改顺序或排序选项时不应该更新整个页面。这就是为什么我认为最好用 AJ 对它们进行排序。所以一切都是瞬间的。你怎么看？AJ 还是在从数据库中检索时直接排序和排序？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T22:59:44.253

这取决于。

为了在第一页加载时获取数据并尽可能快地对其进行排序，最好让数据库这样做，以便它可以使用索引。这当然假设您已经在适当的列上创建了索引。此外，如果您只显示第一`n`行，那么最好让数据库进行排序并仅将第一`n`行返回给客户端，而不是为客户端提供整个数据库的副本。

另一方面，如果您已经将所有行提取到客户端并且只想应用不同的排序，那么在客户端上进行排序可能会更快，以避免额外的数据库命中。

# gwt - 锚元素点击事件

> ID：14034559
> 
> 赞同：0
> 
> 时间：2012-12-25T22:54:39.810
> 
> 标签：gwt, click, anchor

我使用 uibinder 已经有一段时间了，并且非常擅长它。我知道所有关于使用 HTMLPanel 和 Anchor 添加点击处理程序的知识。但是，在某些情况下，这种设计方法根本不符合要求。

假设我有一个无序列表，每个列表都有一些锚元素。

```
<ul><li><a ...></li>...</ul> 
```

最好将每个 li 作为一个组件（java 类），这样您就可以在 ul 中添加该组件的多个实例。这意味着在 ui.xml 中，您从 li 开始（我看不到其他方式）。但是没有办法在里面插入Anchor。你不能用 HTMLPanel 替换 li ，因为这会创建一个你不想要的 div 。

通过在此 uibinder 中将锚点保留为 a，将无法检测到锚点单击事件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:48:02.007

在您的 HTML 中，将 ID 设置为锚点：

```
<a id='testachor'>...</a> 
```

在您的 GWT 代码中，将锚点包装到一个小部件中：

```
Anchor testAnchor = Anchor.wrap(Document.getElementById('testanchor')); 
```

然后向其添加点击处理程序：

```
testAnchor.addDomHandler(new ClickHandler(){...}, ClickEvent.getType()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T04:10:15.647

`<li>`您可以在标签内添加 Anchor 小部件：

```
<g:HTMLPanel>
    <ul>
        <li>
            <g:Anchor ui:field="link" />
        </li>
    </ul>
</g:HTMLPanel> 
```

# c++ - 不初始化指针和将其初始化为 null 有什么区别？

> ID：14034560
> 
> 赞同：0
> 
> 时间：2012-12-25T22:54:58.437
> 
> 标签：c++, struct, null, initialization, declare

我正在为我的游戏制作真正开始构建一个简单的通用引擎，并且我正在尝试以某种方式组织和体面地制作我的引擎，这意味着我不希望它成为我扔到一边的东西一旦我完成了我的计划。

我添加要显示的对象，`drawObject`s，这些对象可以移动，也可以不移动，并且有动画，或者没有动画。

如果他们确实有动画，我想初始化一个`animationSet`，它里面`animationSet`会有 xxx 。`animationComp`由于我试图保持整洁并且一直致力于对内存和 cpu 使用的“优化”（例如共享已加载的图像指针，以及我想到的任何东西），我不想在数组中要求可能未使用的内存.

所以我`animationSetS* animationSet = NULL;`最初计划只在需要我添加的动画的对象上做一个`animationSet = animationSetS[spacesINEED];`，即那些不是动画的对象`NULL`，因此不使用内存（对吗？）。然后就出现了这个问题！（标题）

```
 struct animationComp {
        SDL_Rect* clip;
        int clipsize;
    };

    struct animationSetS {
        animationComp* animation;
        int currentFrame;
        int currentAnimation;
        int animationNumber;
    };

    struct drawObject { // Um objecto.
        char* name;
        SDL_Surface* surface;
        bool draw = true;
        float xPos;
        float yPos;
        bool willMove = false; // 0 - Won't move, 10 - Moves alot, TO IMPLEMENT
        bool isSprite = false;
        animationSetS* animationSet;
    }; 
```

我涉猎了很多问题，对此感到抱歉。对于此处的任何澄清回复，我将在接下来的 10 分钟内回复……也许 1 小时？或者更多。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T23:04:48.933

将指针设置为 NULL 意味着您将能够添加`ASSERT(ptr != NULL);`并知道您的指针不会意外包含来自它正在使用的内存中的任何垃圾值。

因此，如果由于某种原因，您最终在正确设置对象之前使用了该对象，您可以检测到它。

如果您有时不使用字段，它也有帮助，您仍然可以调用`delete stuff;`[假设它首先被分配]。

请注意，使变量保持未初始化意味着它可以在其有效范围内具有任何值[对于某些类型，在有效范围之外-例如指针和浮点值可以是“处理器不允许的值”]。这意味着不可能在代码中“判断”它是否已初始化——但如果你不初始化，事情就会变得非常糟糕！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T23:12:20.190

如果这真的应该在 C++ 中实现（正如你所写的那样），你为什么不使用 C++ 标准库呢？喜欢

```
struct animationSetS {
    std::vector< std::shared_ptr<animationComp> > animation;
    // ...
} 
```

# ruby-on-rails - Gemfile.lock 是否应该致力于 Windows 上的源代码管理？

> ID：14034561
> 
> 赞同：13
> 
> 时间：2012-12-25T22:55:07.970
> 
> 标签：ruby-on-rails, ruby, windows, heroku

红宝石新手在这里。

我通过 ruby​​installer 下载了 ruby​​，做了`gem install rails`，解决了一些缺失的库，最后 fork 了我想要处理的[ruby​​ 项目。](http://selfstarter.us/)

在接触任何东西之前，我看到我的 Gemfile.lock 已修改：

```
diff --git a/Gemfile.lock b/Gemfile.lock
index aefda68..9ebccba 100644
--- a/Gemfile.lock
+++ b/Gemfile.lock
@@ -46,6 +46,7 @@ GEM
     diff-lcs (1.1.3)
     erubis (2.7.0)
     eventmachine (1.0.0)
+    eventmachine (1.0.0-x86-mingw32)
     execjs (1.4.0)
       multi_json (~> 1.0)
     hike (1.2.1)
@@ -65,11 +66,17 @@ GEM
     multi_json (1.3.6)
     multi_xml (0.2.2)
     pg (0.14.1)
+    pg (0.14.1-x86-mingw32)
     polyglot (0.3.3)

...

 PLATFORMS
   ruby
+  x86-mingw32 
```

所有修改的行似乎都与 Windows 相关。[这个答案](https://stackoverflow.com/a/4151540/11236)似乎表明我不应该 gitignore Gemfile.lock （它已经提交给我克隆的 repo）。[这个答案](https://stackoverflow.com/a/6811182/11236)意味着，如果我提交并将其推送到 heroku，我可能会遇到错误（这是有道理的，因为我不希望我的应用程序依赖于 Windows 特定的文件）。

那么，它是什么？我应该如何解决它？我应该从我的仓库中删除 Gemfile.lock 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T00:03:06.940

Last time I pushed to Heroku with a Windows `Gemfile.lock` it handled it pretty gracefully. I don't remember if it failed and rebuilt the `Gemfile.lock` or just stripped the binary gem tags.

There are 2 viable options I see.
One is to assume that there isn't going to be a problem with this behavior. Which means using strict gem version requirements or updating your `bundle` and confirming everything works before you push.

Another is to use the [`:platform` flag in your Gemfile](http://gembundler.com/v1.2/man/gemfile.5.html#PLATFORMS-platforms-). I won't recommend this, but it should force the source down and compile the gem locally. Which means any external dependencies need to be available. With a lot of binary gems (like the `pg` gem) this isn't an easy task. With some other gems it can be nearly impossible. Once again, I would not recommend doing this.

# c# - 如何在 FluentNHibernate Autommaping 上创建自定义公式字段

> ID：14034564
> 
> 赞同：0
> 
> 时间：2012-12-25T22:56:03.397
> 
> 标签：c#, fluent-nhibernate

假设下一个实体

```
public class Result
{
    [Required]
    public virtual int Id { get; set; }
    [Required]
    public virtual Sku Sku { get; set; }
    [Required]
    public virtual Payer Payer { get; set; }
    [Required]
    public virtual double StkPrev { get; set; }
    [Required]
    public virtual double StkCurrent { get; set; }
    [Required]
    public virtual double Buy { get; set; }
    public virtual double SellOut {get { return StkPrev + Buy - StkCurrent; }}
 ... } 
```

我需要专门映射数据库中的属性“SellOut”。

我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T11:05:22.170

```
public virtual double SellOut { get; private set; } 
```

和

```
Map(x => x.SellOut).Formula("Some Sql here"); 
```

# c# - 更新 datagridview 中的“数据类型不匹配异常”

> ID：14034566
> 
> 赞同：1
> 
> 时间：2012-12-25T22:56:06.097
> 
> 标签：c#, ms-access, datagridview, oledb

我有以下代码用于更新我的数据库。更新工作正常，但是当我尝试刷新数据网格视图时，程序会抛出“标准异常中的数据类型不匹配”这是代码

```
string gen = "";
        if (male_rdbtn.Checked)
            gen = "M";
        if (female_rdbtn.Checked)
            gen = "F";
        //Updates the database
        OleDbDataAdapter da = new OleDbDataAdapter();

        da.UpdateCommand = new OleDbCommand();
        da.UpdateCommand.Connection = GetConnection();
        da.UpdateCommand.CommandText =
           "UPDATE patients SET " +
           "firstlastname ='" + nametxt.Text +
           "', birthdate='" + birthtxt.Text +
           "', birthplace='" + birthcmb.SelectedItem +
           "', gender='" + gen +
           "', bloodtype='" + bloodcmb.SelectedItem +
           "', telnum='" + teltxt.Text +
           "', address='" + addresstxt.Text +
           "' WHERE patientid=" + txt;

        da.UpdateCommand.ExecuteNonQuery();

        da.UpdateCommand.Connection.Close();

        //My code to refresh data grid view
        OleDbCommand cmd = new OleDbCommand();
        cmd.Connection = GetConnection();
        cmd.CommandText = "SELECT * FROM patients WHERE patientid = '"+ txt +"'";

        OleDbDataAdapter dad = new OleDbDataAdapter();
        dad.SelectCommand = cmd;

        DataSet ds = new DataSet();
        dad.Fill(ds, "patients");//mismatch exception is thrown here
        dataGridView1.DataSource = ds;
        dataGridView1.DataMember = "patients";

        cmd.Connection.Close();

    } 
```

我怎样才能解决这个问题。谢谢

编辑：通过更正语法解决

# php - QueryPath Find - 使用多个选择器查找元素

> ID：14034570
> 
> 赞同：0
> 
> 时间：2012-12-25T22:56:27.813
> 
> 标签：php, css-selectors, querypath

我想要实现的是在以下示例中同时找到 UL 和 DIV。以及任何其他可能的后续 DIV 和 UL。

```
<ul id="networknavigation" class="navigation" role="navigation">
</ul>
[ .. some code .. ]
<div id="footer" class="navigation">
</div>
[ .. some code .. ] 
```

在查看了 QueryPath API 之后，我发现可以使用多个选择器，正如您在页面的“示例选择器”部分中看到的那样：
[QueryPath CSS 选择器参考](http://api.querypath.org/docs/_c_s_s_reference.html)

我正在使用这样的函数使用 PHP 和 QueryPath：

```
public function testFindNavigation()
{
 $errors = array();
 foreach($this->qp->find('ul, div') as $el) {
    if($el->hasClass('navigation, nav, menu') || $el->attr('id') == 'nav' || $el->attr('role') == 'navigation') {
      array_push($errors, $el->html());
    }
 }
 return $errors; 
} 
```

不幸的是，这个函数只返回 UL 而不是 footer-DIV，我真的不知道为什么它不起作用。我也尝试使用这样的 find 方法：

```
qp->find('ul', 'div') 
```

这给了我完全相同的结果。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:21:42.857

我认为你需要改变

```
$el->hasClass('navigation, nav, menu') 
```

至

```
$el->hasClass('navigation', 'nav', 'menu') 
```

仅返回 UL 的原因是您的上述语句版本是询问元素是否具有“导航、导航、菜单”类，这不是您的本意。

# regex - 删除每个内部具有相同扩展名的行 tag - Regular Expression

I create a Report List with Winrar.
Inside this list i have a text list like this

```
<tag>Adventures of Shugg

> ID：14034573
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2012-12-25T22:57:22.667
> 
>         
> 
> 标签：regex, notepad++, archive, winrar

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2012-12-25T23:25:41.733

很快就把这个扔了。在记事本++中应该可以正常工作。确保设置全局标志（如果有）和多行标志。

```
/^.+(\.[^.]+)$(?=\s*(?:(?!<tag>)[^.])+\1)|^(?!<tag>)[^.]+/gm 
```

你应该（很可能）不要像我上面那样使用标志和分隔符。我相信你会弄清楚的。

说明+演示：[http ://regex101.com/r/lC0lD1](http://regex101.com/r/lC0lD1)</tag> 
```

# java - [az][az]* 和 [az]+ 正则表达式的区别

> ID：14034574
> 
> 赞同：-1
> 
> 时间：2012-12-25T22:57:33.757
> 
> 标签：java, regex

以下正则表达式有什么区别。对我来说，它们都是一样的

1.  `[a-z][a-z]*` **VS** `[a-z]+`
2.  `[a-z][a-z]*` **VS** `[a-z]*[a-z]`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-25T23:02:46.350

正如您所想的，这些正则表达式是相同的。

### #1：

```
[a-zA-Z]  # exactly one alphabetic char
[a-zA-Z]* # 0 to infinite alphabetic chars 
```

相对

```
[a-zA-Z]+ # 1 to infinite alphabetic chars 
```

一个是刚刚`1 + [0, \infinity] = [1, \infinity]`，另一个`[1, \infinity]`。

### 进一步的评论

＃2 的工作原理类似，您在每种情况下所做的只是以重复字符的一个示例（在您的情况下，`[a-zA-Z]`, 来自重复字符命令，`*`或`+`.

下面的答案指出，更易读的版本是首选是正确的目标。绝对没有理由做类似`[a-zA-Z]*[a-zA-Z]`or的事情`[a-zA-Z][a-zA-Z]*`，因为最终它们都是`[a-zA-Z]+`.

### TL;博士

一切都是一样的，只要你在正则表达式中连续重复两个相同的命令，你就做错了。

## 更新：

```
$ python -m timeit -s "import re" "re.search(r'[a-zA-Z]*[a-
zA-Z]', '2323hfjfkf 23023493')"
1000000 loops, best of 3: 1.14 usec per loop

$ python -m timeit -s "import re" "re.search(r'[a-zA-Z]+',
'2323hfjfkf 23023493')"
1000000 loops, best of 3: 1 usec per loop

$ python -m timeit -s "import re" "re.search(r'[a-zA-Z][a-z
A-Z]*', '2323hfjfkf 23023493')"
1000000 loops, best of 3: 0.956 usec per loop 
```

事实证明，这`[a-zA-Z][a-zA-Z]*`比使用`[a-zA-Z]+`. 我有点惊讶，但坦率地说，我不认为可读性的损失值得 0.05 微秒的效率提升。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T23:10:39.477

在功能上，所有这些正则表达式都是相同的。

但是，在某些情况下使用`+`量词可能会有问题，因为根据解析器及其设置，它可能需要或不需要转义 ( `\+`) 以保留其特殊含义。这就是为什么有些人避免使用`+`并更喜欢更明确的`XX*`形式，以保持他们的正则表达式更便携。

但是，就 Java 而言，它[`+`始终保留其特殊含义，除非 escaped](http://docs.oracle.com/javase/tutorial/essential/regex/quant.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T23:02:04.180

是的，所有四个都是完全相等的正则表达式。`[a-z]+`是最简单的一种，应该为可读性问题选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-25T23:02:39.070

你是对的`[a-zA-Z][a-zA-Z]*`并且`[a-zA-Z]+`匹配所有相同的字符串，所以在这方面没有区别。与另一个相比，它有一个主要优势`[a-zA-Z]+`，那就是它更具可读性（可读性很重要！）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-25T23:06:09.067

两者都是相同的检查[模式](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)不情愿量词。[a-zA-Z]+ 对自己和他人来说更具可读性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-25T23:14:09.740

```
[a-zA-Z][a-zA-Z]* Vs [a-zA-Z]*[a-zA-Z] 
```

我认为这个正则表达式的主要区别在于第一个表达式比第二个表达式更早完成。因为 [a-zA-Z][a-zA-Z]* 的匹配树的步数少于表达式的另一部分。

# php - 抑制 PHP_Beautify 中的下一个标记

> ID：14034589
> 
> 赞同：4
> 
> 时间：2012-12-25T23:01:05.507
> 
> 标签：php, indentation, php-beautifier

我正在使用 PEAR PHP_Beautifier 尝试格式化大量遗留代码，并实现数组元素的特定格式化。

我写了一个自定义过滤器：

```
class PHP_Beautifier_Filter_ArrayIndent extends PHP_Beautifier_Filter
{
    public function t_array($sTag)
    {
        if (($this->oBeaut->getNextTokenContent(1) === '(') &&
            ($this->oBeaut->getNextTokenContent(2) !== ')')) {
            //    Don't use for Array type hinting
            //    Don't use for Empty array definition
            $this->oBeaut->add($sTag);
            $this->oBeaut->addNewlineIndent();
        } elseif ($this->oBeaut->getNextTokenContent(2) !== ')') {
             //    Ensure a space after type hinted array before argument name
             $this->oBeaut->add($sTag . ' ');
        } else {
             //  Empty array definition
             $this->oBeaut->add($sTag);
        }
    }
} 
```

我正在尝试获取以下格式（左大括号与“数组”在同一行）：

```
public function doSomething(array $params = array()) {
    $dummy1 = array();
    $dummy2 = array (
        'Hello' => 'World',
        'Goodnight' => 'Vienna'
    );
} 
```

但我得到：

```
public function doSomething(array $params = array()) {
    $dummy1 = array();
    $dummy2 = array 
    (
        'Hello' => 'World',
        'Goodnight' => 'Vienna'
    );
} 
```

有没有办法在“t_array”之后修改/抑制下一个标记，或者跳过它以便我可以处理过滤器中的左大括号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:09:06.240

这条线`$this->oBeaut->addNewlineIndent();`不会是导致新线的原因吗，不应该将其删除或更改为不同的方法吗？

建议：

```
<?php
if (($this->oBeaut->getNextTokenContent(1) === '(') && ($this->oBeaut->getNextTokenContent(2) !== ')')) { 
    $this->oBeaut->add($sTag); 
} elseif ($this->oBeaut->getNextTokenContent(2) !== ')') {
    // Ensure a space after type hinted array before argument name 
    $this->oBeaut->add($sTag . ' '); 
} else {
    // Empty array definition 
    $this->oBeaut->add($sTag); 
} 
```

# c# - 从矩阵的每一行和每一列中选择一个元素，并且最小化总和

> ID：14034594
> 
> 赞同：4
> 
> 时间：2012-12-25T23:02:43.270
> 
> 标签：c#, algorithm, dynamic-programming

如果你有一个 NxN 的正整数矩阵，并且要求你从每一行每一列中只选择一个元素，使得所选择的元素的总和最小化，那么如何解决呢？

我认为这是关于动态编程。我试图`O(n!)`使用记忆来最小化时间：

```
 Dictionary<byte[,], int>[] memo = new Dictionary<byte[,], int>[17];

    int rec(byte[,] arr)
    {
        if (arr.Length == 1) return arr[0, 0];
        int opt = find(arr);
        if (opt != -1) return opt;
        opt = 1 << 25;
        for (int i = 0; i < arr.GetLength(1); ++i)
            opt = Math.Min(opt, arr[0, i] + rec(divide(arr, i)));
        add(arr, opt);
        return opt;
    } 
```

这会从当前矩阵的第 0 行中选择一个元素，然后对矩阵进行除法并递归调用自身来求解子矩阵。函数`divide`根据所选元素划分当前矩阵。则子矩阵大小为 (N-1)x(N-1)。函数`find`在 中执行线性搜索`memo[n]`，`add`并将解决方案添加到`memo[n]`但这太慢了，因为它会将每个矩阵与其他矩阵进行比较。

你有一些改进吗？有更快的 DP 算法吗？任何帮助表示赞赏

**例子**

```
1     2     3    4

8     7     6    5

9     11    10   12

13    14    16   15 
```

最优解：1 + 5 + 10 + 14

脚步：

```
7   6  5

11 10 12

14 16 15 
```

* * *

```
11 10

14 16 
```

* * *

```
14 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T23:21:04.287

这实际上是[分配问题](http://en.wikipedia.org/wiki/Assignment_problem)。它可以使用[匈牙利算法在多项式时间内求解，](http://en.wikipedia.org/wiki/Hungarian_algorithm)以及其他方法。

# php - 即使用户名/密码错误，登录表单也能成功

> ID：14034598
> 
> 赞同：1
> 
> 时间：2012-12-25T23:03:52.390
> 
> 标签：php, mysql, login

我有一个登录表单，例如：

```
<?php include "base.php"; ?> 

<div id="loginpart">  
<?php  
if(!empty($_SESSION['LoggedIn']) && !empty($_SESSION['Username']))  
{  
 ?>   
 You are logged in as <b><?=$_SESSION['Username'];?> </b>. | <a     href="logout.php">LogOut</a>
 <?php  
}  
elseif(!empty($_POST['username']) && !empty($_POST['password']))  
{  
$username = mysql_real_escape_string($_POST['username']);  
$password = md5(mysql_real_escape_string($_POST['password']));  
$checklogin = mysql_query("SELECT * FROM user WHERE username = '".$username."' AND user_password = '".$password."'");  
if($checklogin)  
{  
    $row = mysql_fetch_row($checklogin);
    $_SESSION['Username'] = $username; 
    $_SESSION['LoggedIn'] = 1;  
    echo "<p>Success: We are now redirecting you to the member area.</p>";  
    echo "<meta http-equiv='refresh' content='2;index.php' />";
    //header('Location:index.php');  
}  
else  
{  
    echo "<p>Error: Sorry, your account could not be found. Please <a     href=\"index.php\">click here to try again</a>.</p>";  
}  
}  
else  
{  
?>    
<form method="post" action="index.php" name="loginform" id="loginform">   
    Username:<input type="text" name="username" id="username" />
    Password:<input type="password" name="password" id="password" />
    <input type="submit" name="login" id="login" value="Login" />  
| <a href="register.php">Register</a>  
</form>  
<?php  
}  
?>  
</div> 
```

它首先检查用户是否登录。如果没有，则登录。包括 base.php 调用数据库：

```
<?php  
session_start();  
$dbhost = "localhost"; // this will ususally be 'localhost', but can sometimes differ  
$dbname = "login"; // the name of the database that you are going to use for this  project  
$dbuser = "root"; // the username that you created, or were given, to access your     database  
$dbpass = ""; // the password that you created, or were given, to access your database  
mysql_connect($dbhost, $dbuser, $dbpass) or die("MySQL Error: " . mysql_error());  
mysql_select_db($dbname) or die("MySQL Error: " . mysql_error());  
?> 
```

错误在第二个括号中，它正在检查用户名和密码。

数据库表为：

```
create table user(
user_ID smallint unsigned auto_increment,
username varchar(30),
user_password varchar(16),
user_fname VARCHAR(30) NOT NULL,
user_lname VARCHAR(30) NOT NULL,
user_contact varchar(14),
user_email varchar(30),
user_street varchar(20),
user_city varchar(20),
constraint pk_user primary key (user_ID)
) engine innodb; 
```

问题是即使我输入了错误的用户名或密码。它使我登录。有人请在我错的地方提供帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T23:09:01.193

您没有检查是否正在返回一行。

`if($checklogin)`将始终评估为真，即使结果集为空（因为密码错误或找不到用户）。

您需要将此 if 子句替换为一个将检查非空结果集的子句，例如：

```
if(mysql_num_rows($checklogin) > 0) 
```

作为旁注：您可能还想选择更多的表达式变量名称，例如`$checklogin_result`，`$checklogin_row`这样如果您的项目有一天变得非常大，您就不会失去视线；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T23:09:38.537

它返回成功可能是因为没有语法错误并且您的查询成功执行。但这并不意味着返回了行。需要检查空行

```
if(mysql_num_rows($checklogin) > 0)  
{  
    $row = mysql_fetch_row($checklogin);
    $_SESSION['Username'] = $username; 
    $_SESSION['LoggedIn'] = 1;  
    echo "<p>Success: We are now redirecting you to the member area.</p>";  
    echo "<meta http-equiv='refresh' content='2;index.php' />";
    //header('Location:index.php');  
}  
else  
{  
    echo "<p>Error: Sorry, your account could not be found. Please <a     href=\"index.php\">click here to try again</a>.</p>";  
} 
```

# mysql - MySql 不创建这些表

> ID：14034603
> 
> 赞同：-1
> 
> 时间：2012-12-25T23:06:04.697
> 
> 标签：mysql, phpmyadmin

> **可能重复：**
> [CREATE TABLE 中的 1064 错误 ... TYPE=MYISAM](https://stackoverflow.com/questions/12428755/1064-error-in-create-table-type-myisam)

我正在尝试安装一个名为 php-stats 的 PHP 脚本，这个：[http](http://www.php-stats.it/) ://www.php-stats.it/ 这是一个提供有关网站统计信息的 PHP。

我过去使用过它，它非常好。

今天我试图在我的服务器上安装它，但我有一些问题

它需要安装在服务器上并使用数据库...我的问题是当它尝试创建数据库表时...在许多表中出错...

错误具有以下形式（这与一个特定的表有关）：

**执行错误：CREATE TABLE php_stats_cache (user_id varchar(15) NOT NULL default '0', data int(11) NOT NULL default '0', lastpage varchar(255) NOT NULL default '0', visitor_id varchar(32) NOT NULL默认 ''，命中 tinyint(3) unsigned NOT NULL default '0'，访问 smallint(5) unsigned NOT NULL default '0'，reso varchar(10) NOT NULL default ''，colo varchar(10) NOT NULL default ' ', os varchar(20) NOT NULL default '', bw varchar(20) NOT NULL default '', host varchar(50) NOT NULL default '', lang varchar(8) NOT NULL default '', giorno varchar(10 ) NOT NULL default '', level tinyint(3) unsigned NOT NULL default '0', UNIQUE KEY user_id (user_id) ) TYPE=MyISAM 错误字符串：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 17 行的 'TYPE=MyISAM' 附近使用正确的语法**

我还尝试访问包含查询定义的 *.sql 文件，并在 PHP MyAdmin 中执行创建查询表，例如这个查询（与之前的错误有关）：

```
DROP TABLE IF EXISTS php_stats_cache;
CREATE TABLE php_stats_cache (
  user_id varchar(15) NOT NULL default '0',
  data int(11) NOT NULL default '0',
  lastpage varchar(255) NOT NULL default '0',
  visitor_id varchar(32) NOT NULL default '',
  hits tinyint(3) unsigned NOT NULL default '0',
  visits smallint(5) unsigned NOT NULL default '0',
  reso varchar(10) NOT NULL default '',
  colo varchar(10) NOT NULL default '',
  os varchar(20) NOT NULL default '',
  bw varchar(20) NOT NULL default '',
  host varchar(50) NOT NULL default '',
  lang varchar(8) NOT NULL default '',
  giorno varchar(10) NOT NULL default '',
  level tinyint(3) unsigned NOT NULL default '0',
  UNIQUE KEY user_id (user_id)
) TYPE=MyISAM; 
```

Ig 我尝试在 PhpMyAdmin 中执行此查询，我收到以下错误消息：

**#1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 17 行的 'TYPE=MyISAM' 附近使用正确的语法**

我也尝试在我的 PC 上的本地 mysql 服务器上执行它，但我总是得到相同的错误消息......

为什么？问题是什么？我该怎么做才能解决这个问题？

谢谢

安德烈亚

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T23:08:39.713

Using`TYPE`已被弃用，并在 MySQL 5.5 中被删除。改为使用`ENGINE = MYISAM`。

```
CREATE TABLE php_stats_cache (....) ENGINE = MYISAM; 
```

# javascript - 我的服务器是否缺少所需的 javascript 组件？

> ID：14034606
> 
> 赞同：0
> 
> 时间：2012-12-25T23:06:35.213
> 
> 标签：javascript, html, html5-video

我正在尝试创建一个播放 HTML5 视频并显示 SRT 字幕的网站。我试图模仿[这里](http://accessibility.oit.ncsu.edu/video/audiodescriptions/headingsmap-captions-only.html)所做的事情，但是当我在[我的网站](http://www.suchipi.com/stream/stream.html)上做同样的事情时，FireBug`TypeError: textTrack[i] is undefined`会在 javascript 调试器中报告。我正在使用 apache2、php 等运行 Debian Squeeze 服务器。是否需要安装任何组件才能使 javascript 正常工作？我尝试编辑驱动字幕的 htmltexttrack.js 以硬编码 i 的值，但它仍然报告未定义的错误，让我相信缺少一些基本的 javascript。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T00:02:20.490

我已经在 firebug 中检查了您的代码，由于某种原因，我的浏览器无法访问其原始源中的字幕文件`html5texttrack.js`（诅咒我可以直接从浏览器访问该文件）

```
<track kind="caption" src="http://accessibility.oit.ncsu.edu/video/audiodescriptions/source/captions.vtt" label="English" /> 
```

firebug 不会产生任何错误，但在控制台日志中，`GET`请求此文件的方法有一条读取行。

我做了什么，将字幕文件复制到我的计算机上，然后将加载字幕的代码行更改为：

```
<track kind="caption" src="captions.vtt" label="English"> 
```

一切都像一个魅力......

# postgresql - Heroku Postgres DB HEROKU_POSTGRESQL_AMBER 和 HEROKU_POSTGRESQL_GOLD 有什么区别？

> ID：14034608
> 
> 赞同：3
> 
> 时间：2012-12-25T23:07:08.913
> 
> 标签：postgresql, heroku

我创建了一个新的 Heroku 应用程序，然后将 Dev Heroku Postgres 数据库附加到它上面。
在应用程序的活动日志中，我看到：

```
v07 : Attach HEROKU_POSTGRESQL_GOLD resource 5 minutes ago
v06 : Deploy 076b03a 19 minutes ago
v05 : Add config 19 minutes ago
v04 : Add DATABASE_URL config 19 minutes ago
v03 : Attach HEROKU_POSTGRESQL_AMBER resource 19 minutes ago
v02 : Enable Logplex 21 minutes ago
v01 : Initial release 21 minutes ago 
```

所以 GOLD db 必须是我添加的 Dev 版本。什么是琥珀？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T23:04:37.670

当您最初部署您的应用程序时，如果您需要它，我们会自动为您（开发人员）提供一个数据库（例如`pg`，如果这是一个 ruby​​ 应用程序，我们会检测您的 Gemfile 中的 gem。这将是`HEROKU_POSTGREQL_AMBER`，我们也碰巧设置了身为你的`DATABASE_URL`

因此，您手动配置了另一个数据库`HEROKU_POSTGRESQL_GOLD`，大概是通过`heroku addons:add heroku-postgresql`.

我的猜测是您正在使用`HEROKU_POSTGRESQL_AMBER`它，因为它必须设置为`DATABASE_URL`. 要验证这一点，请尝试`heroku config --app <your-app> | grep postgres`. 您也可以运行`heroku pg:info --app <your-app>`以检查应用程序上安装的所有数据库，并验证哪个是您的主数据库 ( `DATABASE_URL`)。

然后，您可以使用 删除备用`heroku addons:remove HEROKU_POSTGRESQL_<COLOR-OF-THE-SPARE-MOST-LIKELY-GOLD>`。

# opengl - opengl - 渲染设计（初级）

> ID：14034611
> 
> 赞同：2
> 
> 时间：2012-12-25T23:07:30.597
> 
> 标签：opengl

我有一个模拟程序，我想在动画中（比如说 500 个时间步长）或交互方式（改变一个对象意味着在最坏的情况下重新计算所有其他对象）渲染大约 500 - 1000 个对象（相当小，最多 50 个三角形）。

这种渲染任务的最佳方法是什么？

我在考虑 VBO 并使用`glBufferSubData`它来更新每个时间步的对象。还是有其他方法？

另外，由于大约有 20 种类型的对象，我应该使用 20 种不同的 VBO，以便我可以相应地设置属性吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T23:17:41.937

如果您正在制作关键帧动画（每帧一组顶点），则要么将它们全部上传为单独的 VBO 并更改您绑定的那个，要么将它们全部上传到单个 VBO 并更改属性。我怀疑这两种解决方案之间会有很大的性能差异。

我会避免`glBufferSubData`，因为 OpenGL 应该能够为您管理所有内存。如果这是一组大得多的数据，我建议您使用这种方法，因为您可以从磁盘流式传输所需的顶点，以避免一次将其全部存储在内存中，但是对于少量数据，这不是问题。

如果您正在制作基于骨骼的动画，则该`glBufferSubData`方法基本上是在 CPU 上进行蒙皮的唯一方法。进行蒙皮（在 GPU 上）的顶点着色器将比 CPU 蒙皮执行得更好，只需将帧存储在`mat3x4`统一中即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T23:09:44.073

对于如此少量的对象，您可能应该选择最简单的方法来执行此操作，并且仅在您确实需要时才进行优化...

简单，我的意思是概念上对你来说最简单。

如果您愿意，您可以使用具有不同偏移量的单个 VBO 对象，无需使用多个。

# google-maps - 将地图划分为统一的区域

> ID：14034612
> 
> 赞同：2
> 
> 时间：2012-12-25T23:07:37.143
> 
> 标签：google-maps, d3.js, visualization, geospatial

我正在尝试建立一个使用谷歌地图可视化一些统计信息的网站。实际上，我要做的是将地图划分为相邻的单元格（例如蜂窝图案），并为每个数据点确定属于哪个单元格并聚合属于一个单元格的所有点，以便我可以显示关于地图上该单元格的一些统计信息。有没有一种简单的方法可以使用 Google 地图和 d3.js 完成这项工作？

请注意，我们正在谈论的地图仅包含一个城市，而我的所有数据点都在该城市内。这里还有一个重要步骤是确定纬度/经度坐标属于地图上的哪个单元格，这就是我现在面临的挑战。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T23:24:21.553

有一个名为[hexbin](https://github.com/d3/d3-plugins/tree/master/hexbin)的 D3 插件，它似乎正是您正在寻找的。[您可以在此处](http://bl.ocks.org/4248145)、[此处](http://bl.ocks.org/4248146)和[此处](http://bl.ocks.org/4330486)查看其使用示例。您应该能够调整这些以在任何比例地图上使用：城市、国家或其他地方。

# c# - C# 创建多个图像并保存它们

> ID：14034616
> 
> 赞同：-3
> 
> 时间：2012-12-25T23:09:12.830
> 
> 标签：c#, loops, save

我想创建多个以数字为中心的 200x200 图像，并将它们以相应的文件名自动保存到文件夹中。仅此而已，仅此而已。

我想最好用一个图像框试试这个，然后用一个循环在上面写，但我一无所获。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T23:16:03.637

你走在正确的轨道上，伙计。然而; 要完成您想要的，您需要调用**System.Drawing**命名空间中可用的“图形”类。

您想要完成的任务非常简单。

首先遍历您要创建的图像

假设你想要 5 张图片

...调用 for 循环！

```
for (int I = 0; I < 5; I++) { } 
```

在循环内部，我们要创建一个可编辑的 200x200 图像。我更喜欢“位图”类来完成此任务。

创建位图后，我将为它创建图形。然后我将在大约绘制字符串。中心。如果你想要 100% 的中心，你可以使用 MeasureString 函数

最终代码：

```
for (int I = 0; I < 5; I++) {
    Bitmap B = new Bitmap(200, 200);
    Graphics G = Graphics.FromImage(B);
    G.DrawString(I.ToString(), this.Font, Brushes.Black, new PointF(100.0f, 100.0f);
    B.Save(System.IO.Path.Combine(Environment.GetFolderPath(Environment.SpecialFolders.Desktop), I + ".png"))) // Save on the desktop
} 
```

**我还没有尝试过这段代码，但我认为它可以工作。可能需要少量修改:)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T23:17:46.777

抱歉只拿到了我的手机...

在伪代码中

创建一个循环。

```
Inside the loop create a bitmap
    // for i=0...
    // using (var BMP = new bitmap(dimensions))
    {
    // get graphics 
       Using (graphics g = graphics.fromimage(BMP))
    {
    // draw text
    Text render.draw text()
    // save image
    }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T23:21:26.803

这可能就像使用一种方法来完成艰苦的工作一样简单：

```
public void CreateImageWithText(string text)
{
    using (var b = new Bitmap(200, 200))
    {
        using (var g = new Graphics.FromImage(b))
        {
            using (var f = new Font("Arial", 12, FontStyle.Bold, GraphicsUnit.Point))
            {
                var strFormat = new StringFormat();
                strFormat.Alignment = StringAlignment.Center;
                strFormat.LineAlignment = StringAlignment.Center;

                g.DrawString(text, f, Brushes.Blue, new Rectangle(0,0,200,200), strFormat);
            }
        }
        b.Save("C:\\image.jpg", ImageFormat.Jpeg);
    }
} 
```

然后在 for 循环中做：

```
for (var i = 0; i < 5; i++)
    CreateImageWithText(string.Format("{0}", i)); 
```

如果您计划多次调用它，请记住正确处理您`Bitmap`的 s`Graphics`和实例。`Font`这就是我的方法中的 using 语句的用途。

# ember.js - emberjs：删除元素时的动画

> ID：14034618
> 
> 赞同：3
> 
> 时间：2012-12-25T23:09:29.367
> 
> 标签：ember.js

我的应用程序正在显示一个“分组字段”表，其中每组字段都有一个删除按钮。

例如： firstname lastname age deleteButton firstname lastname age deleteButton firstname lastname age deleteButton firstname lastname age deleteButton

当前，当单击 deleteButton 时，链接的行会被后端绑定自动删除。

我想在要删除的行上制作动画...

怎么做 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T01:57:18.220

我不确定，但也许你可以试试这个？ [http://emberjs.com/api/classes/Ember.View.html#event_willDestroyElement](http://emberjs.com/api/classes/Ember.View.html#event_willDestroyElement)

# php - php - linux上的htaccess问题

> ID：14034622
> 
> 赞同：3
> 
> 时间：2012-12-25T23:09:59.963
> 
> 标签：php, mod-rewrite

我在 Windows 上创建了一个自定义 php MVC，它运行良好，没有任何错误，但在 linux 上我面临一些错误，比如我无法访问除默认控制器之外的任何其他控制器。

例如：`localhost/mymvc` - 这个 url 将我重定向到我的默认控制器

但是当我尝试打开任何其他控制器时，例如：`localhost/mymvc/projects` 我收到“404 未找到错误”

这是我的重定向功能：

```
/* ***** Getting URL ***** */
$url = isset($_GET['url']) ? $_GET['url'] : null;
$url = explode('/',$url);

/* ***** When URL does not contain any controller name call default controller ***** */
if(empty($url[0])){
    $defaultpage = HOME;
    require 'application/controllers/'.$defaultpage.'.php';
    $controller = new $defaultpage();
    $controller->loadModel($defaultpage);
    $controller->index();
    return false;
}

/* ***** When URL contains controller name ***** */
$page = 'application/controllers/'.$url['0'].'.php';
if(file_exists($page)){
    require $page;
}else{
    $this->error();
}
$controller = new $url[0];
$controller->loadModel($url[0]); 
```

我确信这里没有错误，但仍然希望你们审查。我认为 .htaccess 文件有问题，所以这就是我的内容：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule ^(.+)$ index.php?url=$1 [QSA,L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-26T12:59:40.637

**理解你的 htaccess**

重写引擎将被启用：
`RewriteEngine On`

重写的基本目录将是/：
`RewriteBase /`

如果请求匹配一个不存在的文件，继续：
`RewriteCond %{REQUEST_FILENAME} !-f`

如果请求匹配一个不存在的目录，继续：
`RewriteCond %{REQUEST_FILENAME} !-d`

如果请求匹配一个不存在的符号链接，继续：
`RewriteCond %{REQUEST_FILENAME} !-l`

Rewrite to index.php:
// L 表示如果规则匹配，则不再处理该规则以下的 RewriteRules。
// QSA 将来自原始请求 URL 的任何查询字符串附加到在重写目标中创建的任何查询字符串
`RewriteRule ^(.+)$ index.php?url=$1 [QSA,L]`

正如我们所见，您的 htaccess 没有实际问题。现在您需要检查您的 apache 中是否启用了 mod_rewrite。

您可以只输出 phpinfo() 并检查它是否已启用。

现在进入你的 PHP。

首先一定要记住linux是区分大小写的。

调试：

在这条线之后

`$page = 'application/controllers/'.$url['0'].'.php';`

添加这个 var_dump

`var_dump($page);`

检查路径是否正确，然后进行其余的调试分析！

问候

# vim - 为什么 vim 不允许使用 :e 命令进行通配？

> ID：14034625
> 
> 赞同：4
> 
> 时间：2012-12-25T23:10:27.573
> 
> 标签：vim, vi

我在 Vim 中使用缓冲区作为“选项卡”，并使用`:e[dit]`命令打开新文件。为什么我不能在`:e`命令中使用 globbing？

```
:e some_dir/*
E77: Too many file names 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T00:36:04.150

您*可以*使用 globbing with`:edit`和其他命令；但是，glob 必须有一个*唯一的结果*，因为该`:edit`命令只接受一个文件。（它应该如何在单个当前窗口中显示多个匹配项？）

如果要按顺序编辑多个文件，可以使用`:args`or`:argadd`代替。请注意，该`:split`命令也不接受多个文件（可能是因为许多匹配项会无意中导致大量窗口拆分的风险），但您可以编写自己的`:Split`命令来提供此功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T05:15:28.783

只需使用`:n`：

```
:n some_dir/* 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T07:06:20.290

您应该改用 :args 或 :argadd 。

```
:args src/*
:tab all 
```

第一个命令将所有文件从 src/ 文件夹加载到缓冲区，第二个命令将每个缓冲区然后放入单独的选项卡中。

:help arglist 将提供更多信息

# google-app-engine - 部署时 GAE/J OneToMany JPA 持久性失败

> ID：14034626
> 
> 赞同：1
> 
> 时间：2012-12-25T23:10:29.223
> 
> 标签：google-app-engine, jpa, deployment, persistence, one-to-many

我正在使用带有 JPA 的 Google App Engine 来实现一对多的双向关系。当我在家里的机器上调试和测试我的应用程序时，一切正常，但在我将它部署到 App Engine 后，持久性似乎崩溃了。

这是我的模型（为简单起见，已删除）：

用户.java：

```
@Entity
class User implements Serializable
{
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Key id;

    @OneToMany(mappedBy = "owner",
               cascade = CascadeType.ALL,
               fetch = FetchType.EAGER)
    private List<Book> books;

    public getBooks() { return this.books; }
} 
```

书.java：

```
@Entity
class Book implements Serializable
{
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Key id;

    @ManyToOne(fetch = FetchType.LAZY)
    private User owner;

    private String name;
} 
```

创建一个新的`User`：

```
User user = new User()

// This is done just for testing. It works fine.
user.getBooks().add(new Book("TEST"))

EntityManager em = /* ... */
EntityTransaction transaction = em.getTransaction();

try
{
    transaction.begin();
    em.persist(user);
    transaction.commit();
}

/* Exceptions handling. */

finally
{
    if (transaction.isActive())
        transaction.rollback();

    em.close();
} 
```

并添加一本书：

```
User user = /* ... */
Book book = new Book("A new book");

user.getBooks().add(book);

EntityManager em = /* ... */
EntityTransaction transaction = em.getTransaction();

try
{
    transaction.begin();
    /* user.getBooks().add(book);  - placing this here doesn't change anything */
    em.merge(user);
    transaction.commit();
}

/* Exceptions handling. */

finally
{
    if (transaction.isActive())
        transaction.rollback();

    em.close();
} 
```

在我添加与用户一起创建的“测试”书之前，我看到的是，第一本书实体的创建工作得很好，但是每当我创建*另一个*实体时，前一个实体就会以某种方式从数据存储中删除并且是取而代之的是我刚刚创建的新书（我可以根据书名来判断）。所以我不能为同一个用户创建不止一本书。

我试图看看我是否以某种方式弄乱了 Book 实体的持久性，因此我添加了“TEST”书。问题仍然存在，只是现在我有了第一本书（“TEST”），并且每当我尝试添加新书时，我都会不断替换列表中的第二本书。

同样，当我调试我的应用程序时，这不会发生，只有在我部署之后才会发生。

我尝试`em.persist(book)`在调用 to 之前调用`em.merge(user)`，但这导致了一个异常，说这本书的所有者在它被持久化时已经设置并且无法更改。我尝试自己设置关系（就像在这个[线程](https://stackoverflow.com/questions/8434853/jpa-onetomany-update)中一样），但是在添加书籍时导致事务失败。

我不确定它是否相关，但我看到的“书籍”列的类型是`datastore_types.Key.from_path`，如：

```
[datastore_types.Key.from_path(u'User', 9001L, u'Book', 1L, _app=u's~myapp'),
 datastore_types.Key.from_path(u'User', 9001L, u'Book', 2001L, _app=u's~myapp')] 
```

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T06:01:30.910

Can you try below:

```
User user = /* ... */
Book book = new Book("A new book");

book.setOwner(user);

EntityManager em = /* ... */
EntityTransaction transaction = em.getTransaction();

try{
    transaction.begin();
    em.persist(user);
    transaction.commit();

}finally{
    if (transaction.isActive())
        transaction.rollback();

    em.close();
} 
```

# algorithm - 访问磁盘中矩阵（游戏地图）中的图块的算法

> ID：14034628
> 
> 赞同：3
> 
> 时间：2012-12-25T23:10:51.633
> 
> 标签：algorithm

我正在开发一个瓷砖映射游戏。
我需要访问圆盘中具有给定半径并以给定点为中心的图块。

访问正方形中的图块很容易，我们只需要使用两个循环：

```
for(int i=xmin; i<xmax; ++i)
   for(int j=ymin; j<ymax; ++j)     
       // the tile map[i][j] is in the square 
```

但是您如何访问给定圆盘（整圈）中的图块？

**编辑：**
我的意思是，我可以处理边界矩形中的每个图块（限制磁盘），并通过使用确定该矩形中的图块是否在磁盘中`(x-x0)²+(y-y0)²<R²`，但是使用该算法，我们将探索无用的图块。
当使用大半径时，要处理的瓦片很多，并且会很慢，因为`(x-x0)²+(y-y0)²<R²`多次计算很重
我想要一种比这个更高效的算法。

**EDIT2：**
我不需要完美的磁盘

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T06:10:21.330

我们可以通过线性扫描`x`，计算 的范围`y`。然后我们只需要扫描圆圈中的图块，就像这张画得很糟糕的图片一样。（圣诞颜色？）

![在此处输入图像描述](../Images/6ad260136446b55b427c37c4505b71e4.png)

如果我们有一个带半径`r`和 x 位置的圆`x`，我们可以计算出 的最大长度`y`：

![在此处输入图像描述](../Images/9ce0fc4b7e4113db791656d41f0fdb0c.png)

```
y = sqrt(r * r - x * x); 
```

因此，遍历图块的代码如下所示：

```
int center_x = (xmin + xmax) / 2;
int center_y = (ymin + ymax) / 2;

for(int x = xmin; x <= xmax; x++) {
    int ydist = sqrt(r * r - (center_x - x) * (center_x - x));
    for(int y = center_y - ydist; y <= center_y + ydist; y++) {
        // these are the tiles in the disc
    }
} 
```

这是一些Python代码：

```
from Tkinter import *
from math import *

tk = Tk()
g = Canvas(tk, width=500, height=500)
g.pack()

x0 = 25 # x center
y0 = 25 # y center
r = 17  # radius
t = 10  # tile side length

for x in range(x0 - r, x0 + r + 1):
    ydist = int(round(sqrt(r**2 - (x0 - x)**2), 1))
    for y in range(y0 - ydist, y0 + ydist + 1):
        g.create_rectangle(x * t, y * t, x * t + t, y * t + t
                , fill='#'
                + '0123456789ABCDEF'[15 - int(15 * sqrt((x0 - x)**2 + (y0 - y)**2) / r)]
                + '0123456789ABCDEF'[int(15 * sqrt((x0 - x)**2 + (y0 - y)**2) / r)]
                + '0')

g.create_oval((x0 - r) * t, (y0 - r) * t, (x0 + r) * t + t, (y0 + r) * t + t, outline="red", width=2)

mainloop() 
```

结果磁盘：

![在此处输入图像描述](../Images/fb355a9926506188665145683f64fb2e.png)

最后并不完美，但我希望它对你来说足够好（或者你可以修改它）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-26T07:03:02.983

您可以在您的平铺矩阵中使用[Bresenham 的圆算法（第 3.3 节，扫描转换圆）](http://books.google.co.ve/books?id=-4ngT05gmAQC&printsec=frontcover#v=onepage&q&f=false) （它仅使用整数算术，非常准确并处理整个圆的第四部分以产生整个圆周）来检测那些形成圆周，然后从上到下（或从左到右）跟踪它们之间的线：

![在此处输入图像描述](../Images/9bb00ee65f05e0930ae2e9962778b879.png)

以下是圆算法的伪实现：

```
static void circle(int x0, int y0, int x1, int y1) {
    // Bresenham's Circle Algorithm
    int x, y, d, deltaE, deltaSE;
    int radius, center_x, center_y;
    bool change_x = false;
    bool change_y = false;

    if( x0 > x1 ) {
        // swap x values
        x = x0;
        x0 = x1;
        x1 = x;
        change_x = true;
    }
    if( y0 > y1 ) {
        // swap y values
        y = y0;
        y0 = y1;
        y1 = y;
        change_y = true;
    }

    int dx = x1 - x0;
    int dy = y1 - y0;

    radius = dx > dy ? (dy >> 1) : (dx >> 1);
    center_x = change_x ? x0 - radius : x0 + radius;
    center_y = change_y ? y0 - radius : y0 + radius;

    x = 0;
    y = radius;
    d = 1 - radius;
    deltaE = 3;
    // -2 * radius + 5
    deltaSE = -(radius << 1) + 5;

    while(y > x) {
        if(d < 0) {
            d += deltaE;
            deltaE  += 2;
            deltaSE += 2;
            x++;
        } else {
            d += deltaSE;
            deltaE  += 2;
            deltaSE += 4;
            x++;
            y--;
        }
        checkTiles(x, y, center_x, center_y);
    }
}

void checkTiles(int x, int y, int center_x, int center_y) {
    // here, you iterate tiles up-to-down from ( x + center_x, -y + center_y) to (x + center_x, y + center_y) 
    // in one straigh line using a for loop
    for (int j = -y + center_y; j < y + center_y; ++j) 
       checkTileAt(x + center_x, j);

    // Iterate tiles up-to-down from ( y + center_x, -x + center_y) to ( y + center_x,  x + center_y)
    for (int j = -x + center_y; j < x + center_y; ++j) 
       checkTileAt(y + center_x, j);

    // Iterate tiles up-to-down from (-x + center_x, -y + center_y) to (-x + center_x,  y + center_y)
    for (int j = -y + center_y; j < y + center_y; ++j) 
       checkTileAt(-x + center_x, j);

    // here, you iterate tiles up-to-down from (-y + center_x, -x + center_y) to (-y + center_x, x + center_y)
    for (int j = -x + center_y; j < x + center_y; ++j) 
       checkTileAt(-y + center_x, j);
} 
```

使用这种技术，您应该只处理所需的图块（并且只处理四分之一圆之后），不会检查任何不必要的图块。除此之外，它仅使用整数运算，这使它非常快（推论和解释可以在提供的书籍链接中找到），并且生成的圆周被证明是真实圆周的最佳近似值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T09:19:28.783

排除广场外的瓷砖不会更快。我只会使用一个正方形，但忽略圆外的瓷砖。（例如通过检查瓷砖离圆心有多远）

```
for(int i=xmin; i<xmax; ++i):
   for(int j=ymin; j<ymax; ++j):
       if map[i][j] not in the circle:
           break
       // the tile map[i][j] is in the square 
```

对性能开销的粗略估计：

```
Area Square = 2*r*2*r
Area Circle = pi*r*r

Area Square / Area Circle = 4/pi = 1.27 
```

这意味着仅使用正方形而不是圆形`1.27 times slower`（假设使用圆形没有其自身的低效率）

此外，因为您可能会对图块执行一些操作（使得涉及圆中图块的迭代要慢得多），这意味着使用圆形布局而不是方形布局，性能增益将下降到几乎为 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-25T23:34:50.647

使用边界八边形。它是切掉角的边界正方形。您需要这些测试来确定一个点（瓷砖的任何角落）是否处于该形状。将其放入 2D 循环中。

```
abs(x) < R
abs(y) < R
abs(x)+abs(y) < sqrt(2)*R 
```

当然，预先计算 sqrt(2)*R。

显然，这与圆形不同，但与正方形相比，它可以很好地减少浪费的空间量。

如果不需要在循环中进行某种测试，就很难生成一个仅完美地越过瓷砖中心或瓷砖角的循环。编写此类循环的任何希望都来自使用 Bresenham 的算法。

# selenium-webdriver - 两个类似的动态下拉列表选择 selenium web driver

> ID：14034631
> 
> 赞同：0
> 
> 时间：2012-12-25T23:11:39.243
> 
> 标签：selenium-webdriver

我有两个相似的动态下拉列表，我无法从第二个下拉列表中进行选择。下面是html：

```
<div id="list" class="x-list">
<div id="list-list" class="x-list-list-ct">
<ul>
<li class="x-item" role="option">US Dollar - USD</li> 
<li class="x-item x-list-selected x-list-item-over" role="option">Afghan Afghani - AFN</li> //<--this is my 1st selection from 1st dropdown list
<li class="x-item" role="option">Albanian Lek - ALL</li>
<li class="x-item" role="option">Algerian Dinar - DZD</li>
<li class="x-item" role="option">Angolan Kwanza - AOA</li>
<li class="x-item" role="option">Argentine Peso - ARS</li>
</ul>
</div>
</div>

<div id="list" class="x-list">
<div id="list-list" class="x-list-list-ct">
<ul>
<li class="x-item x-list-selected x-list-item-over" role="option">US Dollar - USD</li> //<--this is my default hover selection
<li class="x-item" role="option">Afghan Afghani - AFN</li> 
<li class="x-item" role="option">Albanian Lek - ALL</li>
<li class="x-item" role="option">Algerian Dinar - DZD</li>
<li class="x-item" role="option">Angolan Kwanza - AOA</li>
<li class="x-item" role="option">Argentine Peso - ARS</li>
</ul>
</div>
</d 
```

当一个元素被选中或悬停时，类名更改为“x-item x-list-selected x-list-item-over”

对于第一个列表，我使用 driver.findElement(By.xpath("//li[text()[contains(.,'Afghan Afghani - AFN')]]")).click();

当我对第二个列表执行相同操作时，元素被选中但列表没有关闭。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T19:14:03.167

试试这些 xpath，第一个 div 使用 1，第二个 div 使用 2

```
"//div[@id='list'][1]//li[text()='Afghan Afghani - AFN']" 
```

或 `"//li[text()='Afghan Afghani - AFN'][1]"`
和 `"//li[text()='Afghan Afghani - AFN'][2]"`

我认为当您与页面上的其他元素交互时，列表会自动关闭，例如，尝试向另一个元素（如按钮）发送空格，这样列表就会失去焦点并自行关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T17:37:12.440

像这样试试

从第一个列表中选择

```
driver.findElement(By.xpath("//div[1]/div/ul/li[text()='Afghan Afghani - AFN']")).click(); 
```

从第二个列表中选择

```
driver.findElement(By.xpath("//div[2]/div/ul/li[text()='Afghan Afghani - AFN']")).click(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-16T08:33:58.050

尝试使用类似这样的代码

```
 (//div[@id='list'])[1] 
```

# android - Android中复杂的多点触控手势

> ID：14034641
> 
> 赞同：0
> 
> 时间：2012-12-25T23:14:38.083
> 
> 标签：android, events, touch, gesture

我正在尝试在应用程序中实现 5 个手指手势。我知道我应该使用 MotionEvent，但我真的不知道如何。我只需要5个指针的初始和最终坐标，但我真的不知道如何获取它们。提前感谢您的回答。一段代码将非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T10:22:19.237

我自己设法弄清楚了，我会解释如何。首先，我使用 MotionEvent.getPointerCount() 来查看是否实际上有 5 个指针。接下来，我通过调用 MotionEvent.getX() 和 MotionEvent.getY() 使用指针坐标来自己处理 MotionEvents。

# haxe - 将像素数组保存到文件中

> ID：14034644
> 
> 赞同：0
> 
> 时间：2012-12-25T23:15:15.257
> 
> 标签：haxe

在 Haxe 编程语言中，是否有任何跨语言的方式将像素数据数组保存到文件中（例如，以 BMP 或 PNG 格式）？

```
class SavePixelsToFile {
  static function main(){
    //how can I save this array of pixel data to a file? It is a simple 2D array of RGB arrays, with the red, green, and blue components in the respective order.
    var arr = [
      [[0, 0, 0],[255, 255, 255]],
      [[255, 255, 255],[0, 0, 0]]
      ];
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T05:31:48.413

格式库会做你想做的事。[http://code.google.com/p/hxformat/](http://code.google.com/p/hxformat/)

安装这个库：haxelib install format

使用以下方法将其链接到您的 hxml 文件中：-lib 格式

要将图像数据写入文件，请执行以下操作：

```
function writePixels24(file:String, pixels:haxe.io.Bytes, width:Int, height:Int) {
    var handle = sys.io.File.write(file, true);
    new format.png.Writer(handle)
        .write(format.png.Tools.build24(width, height, pixels));
    handle.close();
}

var bo = new haxe.io.BytesOutput();
for (pixel in pixels)
    for (channel in pixel) 
         bo.writeByte(channel);
var bytes = bo.getBytes();
writePixels24("Somefile.png", bytes); 
```

这适用于具有 sys.* 包（非闪存）的目标。您仍然可以在没有 sys.* 包的情况下生成 png，但需要另一种保存文件的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T23:25:59.123

一种易于编写的格式是[PPM](http://netpbm.sourceforge.net/doc/ppm.html "Netpbm 彩色图像格式")。netpbm 工具可以轻松地操作它们，也可以转换为多种格式，包括[PBM](http://netpbm.sourceforge.net/doc/ppmtobmp.html)和[PNG](http://netpbm.sourceforge.net/doc/pnmtopng.html)。

# semantic-web - 检查 OWL 表达式之间的逻辑蕴涵关系？

> ID：14034656
> 
> 赞同：2
> 
> 时间：2012-12-25T23:18:34.013
> 
> 标签：semantic-web, ontology, owl, swrl

我有一个简单的问题，我怀疑它没有简单的答案。本质上，我想检查一个 OWL 表达式 (#B) 从另一个 (#A) 逻辑上遵循是否是真的 - 换句话说，我想问：#A -> #B 是真的吗？

原因是我正在为应用程序编写匹配算法，该算法将基于知识的结构（由#KnowledgeStructure 类表示）与描述当前应用程序状态需求的结构（#StateRequirement）匹配。两种结构都具有属性，这些属性具有表示第三种结构（#Model）状态下的 OWL 表达式的字符串值。它们是： #KnowledgeStructure.PostCondition 表示应用于#Model 的知识结构将如何转换#Model；和#StateRequirement.GoalCondition，它表示应用程序旨在实现的#Model 状态。因此，我想通过检查#KnowledgeStructure.PostCondition 是否产生所需的#StateRequiremment.GoalCondition 来查看#KnowledgeStructure 是否满足#StateRequirement。我可以抽象地表达为：(#KnowledgeStructure.Postcondition => #StateRequirement.GoalCondition) => Match(#KnowledgeStructure, #StateRequirement)。不太容易混淆，我可以将其表示为： ((#A -> #B) -> Match(#A, #B)) 其中 #A 和 #B 都是有效的 OWL 表达式。

在一般情况下，我希望能够表达以下规则：“如果表达式 #B 从 #A 遵循是真的，那么表达式 Match(#A, #B) 也是真的”。

本质上，我的问题是：我如何在 OWL 中提出或实现这样的规则？如何测试一个表达式是否来自另一个表达式？此外，如果没有明确说明这种关系，现有的推理器是否足够强大来确定两个表达式之间的关系 #A -> #B？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T11:10:26.233

我不是 100% 确定我完全理解了这个问题，但根据我的理解，我会以这种方式面对这种情况。

首先，我指的是 Java，因为我知道的所有库都是为这种语言设计的。其次，我认为OWL本身不能满足你的目标，因为它可以表示规则和公理，但它不提供推理，即你需要一个推理器，所以你需要构建一个程序使用它，加上我将在下面画出的额外处理：

1）你没有提到它，但我猜你有一个潜在的本体，你需要证明你的后果关系（你用符号“->”表示）。如果本体不明确，也许可以从您在问题中提到的文本表达式中提取/组合它。

2）您需要使用一个库进行本体操作，我建议使用曼彻斯特大学的[OWL API](http://owlapi.sourceforge.net/)，它非常强大且简单，在“文档”部分下的教程中，您可以概述主要功能，包括推理器的使用（该示例显示了隐士，但该原理适用于任何其他推理者）。

3）此时你需要检查本体是否一致（否则任何东西都可以推导出来，因为它经常发生在错误的前提下）

4）你在本体中添加如下公理（你直接用Java构建，不需要序列化回来，你可以让推理器处理内存中的表示）并检查一致性：A\sqsubseteq B，即，使用相关的解释：A^I \subseteq B^I，所以它等价于 A => B（它们具有相同的真值表）。

5) 此时您可以添加公理 Match(A,B)，其中 A 和 B 是您的类表达式，而 Match 是一个角色/关系，它关联所有类表达式，其中第二个是第一个的结果。

6) 在多次重复这些步骤之后，您可能想要序列化结果并存储它，这再次可以非常简单地使用内存中表示的 OWL API 来实现。

有关描述逻辑（支持 OWL 本体的逻辑）的一些基础知识，您可以参考[A description logic Primer (2012), Horrocks et al。](https://www.google.it/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&ved=0CEkQFjAB&url=http://arxiv.org/abs/1201.4089&ei=2B_gUIfkDsb44QShnYGoDQ&usg=AFQjCNGTx4GmGHf9d5gxqkcXZm4RCRsf5Q&sig2=lJpe7hESs50JRBDaV5_7jQ&bvm=bv.1355534169,d.bGE)以及[描述逻辑的基础（2011 年），鲁道夫](http://www.aifb.kit.edu/images/1/19/DL-Intro.pdf)。

我不是逻辑学家或深度学习专家，所以请验证我提供的所有信息并随时纠正我:)

# android - ExpandableListView onChildClick 不起作用

> ID：14034658
> 
> 赞同：0
> 
> 时间：2012-12-25T23:19:00.483
> 
> 标签：android, expandablelistview

我正在编写一个媒体播放器应用程序。单击播放列表按钮时，ExpandList Activity 启动，根据单击的子项，它应该启动我的主要活动并返回子位置。但它并没有做任何事情。没有错误或任何东西。似乎它甚至没有进入 onChildClick 方法，我不知道为什么。我看过很多例子，他们似乎都和我一样。我希望有人能指出我做错了什么。下面是我的代码。谢谢

```
import java.util.ArrayList;
import android.app.ExpandableListActivity;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.ExpandableListView;
import android.widget.ExpandableListView.OnChildClickListener;
import android.widget.Toast;

public class ExpandListActivity extends ExpandableListActivity implements
OnChildClickListener {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    ExpandableListView expandbleLis = getExpandableListView();
    expandbleLis.setDividerHeight(2);
    expandbleLis.setGroupIndicator(null);
    expandbleLis.setClickable(true);
    expandbleLis.setOnChildClickListener(this);

    setGroupData();
    setChildGroupData();

    NewAdapter mNewAdapter = new NewAdapter(groupItem, childItem);
    mNewAdapter
    .setInflater(
            (LayoutInflater)       getSystemService(Context.LAYOUT_INFLATER_SERVICE),
            this);
    expandbleLis.setAdapter(mNewAdapter);

}

public void setGroupData() {
    groupItem.add("TechNology");
    groupItem.add("Mobile");
    groupItem.add("Manufacturer");
    groupItem.add("Extras");
}

ArrayList<String> groupItem = new ArrayList<String>();
ArrayList<Object> childItem = new ArrayList<Object>();

public void setChildGroupData() {
    /**
     * Add Data For TecthNology
     */
    ArrayList<String> child = new ArrayList<String>();
    child.add("Java");
    child.add("Drupal");
    child.add(".Net Framework");
    child.add("PHP");
    childItem.add(child);

    /**
     * Add Data For Mobile
     */
    child = new ArrayList<String>();
    child.add("Android");
    child.add("Window Mobile");
    child.add("iPHone");
    child.add("Blackberry");
    childItem.add(child);
    /**
     * Add Data For Manufacture
     */
    child = new ArrayList<String>();
    child.add("HTC");
    child.add("Apple");
    child.add("Samsung");
    child.add("Nokia");
    childItem.add(child);
    /**
     * Add Data For Extras
     */
    child = new ArrayList<String>();
    child.add("Contact Us");
    child.add("About Us");
    child.add("Location");
    child.add("Root Cause");
    childItem.add(child);
}

@Override
public boolean onChildClick(ExpandableListView parent, View v,
        int groupPosition, int childPosition, long id) {

    Toast.makeText(ExpandListActivity.this, "Clicked On Child",
            Toast.LENGTH_SHORT).show();

    // Starting new intent
    Intent in = new Intent(getApplicationContext(),
            AndroidBuildingMusicPlayerActivity.class);

    // Sending childPosition to PlayerActivity
    in.putExtra("childPosition", childPosition);

    Log.println(0, getClass().getName(), "onChildClick inside");

    setResult(100, in);

    startActivity(in);

    // Closing PlayListView
    finish();

    return true;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:17:09.487

**解决了我的问题**

我只是在适配器类的 onClick 方法中添加了它，它就可以工作了。谢谢你们。

```
Intent intent= new Intent(activity, AndroidBuildingMusicPlayerActivity.class);   
intent.putExtra("childPosition",childPosition); 
activity.setResult(100, intent);  
activity.finish(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T05:13:24.493

如果您使用 调用此活动`startActivityForResult()`，则返回调用活动的正确方法如下：

```
Intent returnIntent = new Intent();
returnIntent.putExtra("childPosition", childPosition);
setResult(RESULT_OK,returnIntent);        
finish(); 
```

所以你需要删除这些行：

```
Intent in = new Intent(getApplicationContext(),
            AndroidBuildingMusicPlayerActivity.class);
startActivity(in); 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T01:55:00.393

这是适配器类。我尝试在 onClick 中添加一个意图，但它不允许我“startActivity();” 因为我猜我是在适配器类而不是活动类中执行此操作。我不确定。

```
@SuppressWarnings("unchecked")
public class NewAdapter extends BaseExpandableListAdapter {

public ArrayList<String> groupItem, tempChild;
public ArrayList<Object> Childtem = new ArrayList<Object>();
public LayoutInflater minflater;
public Activity activity;

public NewAdapter(ArrayList<String> grList, ArrayList<Object> childItem) {
    groupItem = grList;
    this.Childtem = childItem;
}

public void setInflater(LayoutInflater mInflater, Activity act) {
    this.minflater = mInflater;
    activity = act;
}

@Override
public Object getChild(int groupPosition, int childPosition) {
    return null;
}

@Override
public long getChildId(int groupPosition, int childPosition) {
    return 0;
}

@Override
public View getChildView(int groupPosition, final int childPosition,
        boolean isLastChild, View convertView, ViewGroup parent) {
    tempChild = (ArrayList<String>) Childtem.get(groupPosition);
    TextView text = null;
    if (convertView == null) {
        convertView = minflater.inflate(R.layout.playlist_item, null);
    }
    text = (TextView) convertView.findViewById(R.id.songTitle);
    text.setText(tempChild.get(childPosition));
    convertView.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            Toast.makeText(activity, tempChild.get(childPosition),
                    Toast.LENGTH_SHORT).show();

        }
    });
    return convertView;
}

@Override
public int getChildrenCount(int groupPosition) {
    return ((ArrayList<String>) Childtem.get(groupPosition)).size();
}

@Override
public Object getGroup(int groupPosition) {
    return null;
}

@Override
public int getGroupCount() {
    return groupItem.size();
}

@Override
public void onGroupCollapsed(int groupPosition) {
    super.onGroupCollapsed(groupPosition);
}

@Override
public void onGroupExpanded(int groupPosition) {
    super.onGroupExpanded(groupPosition);
}

@Override
public long getGroupId(int groupPosition) {
    return 0;
}

@Override
public View getGroupView(int groupPosition, boolean isExpanded,
        View convertView, ViewGroup parent) {
    if (convertView == null) {
        convertView = minflater.inflate(R.layout.grouprow, null);
    }
    ((CheckedTextView) convertView).setText(groupItem.get(groupPosition));
    ((CheckedTextView) convertView).setChecked(isExpanded);
    return convertView;
}

@Override
public boolean hasStableIds() {
    return false;
}

@Override
public boolean isChildSelectable(int groupPosition, int childPosition) {
    return true;
}

} 
```

# jquery - 在jquery中选中复选框时触发锚链接单击

> ID：14034659
> 
> 赞同：0
> 
> 时间：2012-12-25T23:19:25.693
> 
> 标签：jquery, checkbox, anchor

> **可能重复：**
> [使用 jQuery 在链接上重新触发点击事件](https://stackoverflow.com/questions/1762703/re-firing-a-click-event-on-a-link-with-jquery)

检查复选框时是否可以触发单击的锚链接？下面是我的 html 和 jQuery

html:

```
<div id="filter-1" class="filter tags">
 <ul>
  <li class="grey">
    <input type="checkbox">
    <a title="" href="/collections/mens/grey">Grey</a>
  </li>

 <li class="all">
   <input type="checkbox">
   <a title="" href="/collections/mens">All color</a>
  </li>
 </ul>
 </div> 
```

jQuery：

```
 $("input[type='checkbox']").change(function(){
  var item=$(this);    
   if(item.is(":checked"))
    {
     item.siblings('a').trigger('click');
    }    
 }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-25T23:22:07.520

```
 $("input[type='checkbox']").change(function(){
  var item=$(this);    
   if(item.is(":checked"))
    {
      location.href = item.siblings('a').attr('href');
    }    
 }); 
```

# ios - 需要在 iOS 中从 NSMutableDictionary 生成的 JSON 文档添加前缀

> ID：14034663
> 
> 赞同：0
> 
> 时间：2012-12-25T23:20:22.567
> 
> 标签：ios, json, nsmutabledictionary

我能够通过遍历一个`NSMutableDictionary`. 这`NSMutableDictionary`又包含两个也是`NSMutableDictionary`'s 的值，它们的键分别是`reports`和`results`。

构造 JSON 文档的代码如下：

```
NSMutableDictionary *jsonDoc = [NSMutableDictionary dictionary];
    [jsonDoc setObject:results forKey:@"results"];
    [jsonDoc setObject:reports forKey:@"reports"];

    NSError *ierror = nil;
    NSData *jsonData = [NSJSONSerialization dataWithJSONObject:jsonDoc options:NSJSONWritingPrettyPrinted error:&ierror];
    NSString *jsonString = [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding];
    NSLog(@"JSON Output: %@", jsonString); 
```

我的 JSON 输出如下所示：

```
JSON Output: {
  "results" : [
    {
      "date" : "2012-12-25T16:58:25",
      "name" : "Test 1",
      "result" : "Fail"
    },
    {
      "date" : "2012-12-25T16:58:33",
      "name" : "Test 2",
      "result" : "Pass"
    },
    {
      "date" : "2012-12-25T16:58:38",
      "name" : "Test 3",
      "result" : "Pass"
    },
    {
      "date" : "2012-12-25T16:58:45",
      "name" : "Test 4",
      "result" : "Fail"
    }
  ],
  "reports" : [

  ]
} 
```

我对我得到的输出感到非常满意。但是，我现在想做的是在我输出的数据前面加上额外的细节，这些细节会`JSON Output: {`在`"results"`. 其他详细信息只是简单的`NSString`值，如`"Name:"`, `"Address"`, `"City"`, `"Province"`,`"Postal Code"`等。考虑到我目前拥有的代码结构，我将如何做到这一点？问题是，当我最初构建 JSON 对象时，我希望这些细节成为原始 JSON 对象的一部分，而不仅仅是在输出到控制台时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T23:46:02.277

只需为要添加到 jsonDoc 字典的每个键/值对调用 setObject:forKey:。将它们放在问题中的两个调用之上或之下都没有关系，因为字典是无序的。

# windows - windows下如何查询用户的session id？

> ID：14034666
> 
> 赞同：1
> 
> 时间：2012-12-25T23:20:58.473
> 
> 标签：windows, winapi, visual-c++, sessionid, winlogon

假设有两个用户，分别是 A 和 B，登录计算机，我们可以在 cmd.exe 中使用命令“查询会话”来获取每个用户名的所有会话 ID。

我的问题如下：

1、如何通过API（用户态或内核态）查询给定用户名的会话id？

2、如何通过API（用户态或内核态）查询给定session id的用户名？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T23:39:51.700

您可以为此使用[远程桌面服务 API](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383464%28v=vs.85%29.aspx)。

> 1、如何通过API（用户态或内核态）查询给定用户名的会话id？

只需使用 获取所有会话[`WTSEnumerateSessions`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383833%28v=vs.85%29.aspx)，遍历它们，获取用户名[`WTSQuerySessionInformation`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383838%28v=vs.85%29.aspx)并检查它是否匹配。

或者，如果您有该用户[的访问令牌](http://msdn.microsoft.com/en-us/library/windows/desktop/ms721532%28v=vs.85%29.aspx#_security_access_token_gly)，您可以使用[`GetTokenInformation`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa446671%28v=vs.85%29.aspx)它来检索它的会话 ID。

> 2、如何通过API（用户态或内核态）查询给定session id的用户名？

正如您可能从上一个答案中猜到的那样，您可以使用[`WTSQuerySessionInformation`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383838%28v=vs.85%29.aspx)从会话 ID 中获取用户名。

# java - Apache Commons Ftp 文件上传 0 字节

> ID：14034673
> 
> 赞同：2
> 
> 时间：2012-12-25T23:22:08.083
> 
> 标签：java, android, apache, ftp

我正在开发一个需要将某些内容上传到 FTP 的应用程序。我一直无法使 apache commons 与文件上传一起工作。上传的文件有 0 个字节。我尝试了 ASCII 和二进制模式，结果相同。这是我的代码

```
 Log.d("FTP", "Connecting");
    ftpsClient.connect(server,port);

    if(ftpsClient.isConnected())
    {
        Log.d("FTP", "Sending File");
        ftpsClient.login("XXXXXXX", "XXXXXXXX");
        ftpsClient.setFileType(FTP.BINARY_FILE_TYPE);
        InputStream is = new FileInputStream("sdcard/log.txt");
        ftpsClient.storeFile("log.txt", is);
        is.close();
        ftpsClient.logout();
        ftpsClient.disconnect();
    } 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T03:33:42.967

去过那里，做到了，看到了完全相同的问题。

后

```
ftpsClient.login("XXXXXXX", "XXXXXXXX"); 
```

添加

```
ftpsClient.enterLocalPassiveMode(); 
```

为了稍微扩展答案，这里有一个完整的片段：

```
private class FTPUploadTask extends AsyncTask<AFileDescriptor, Long, Boolean> {

    private static final int bufferSize = 64;
    private boolean isCanceling = false;
    private long fileSize = 0;

    private ProgressDialog pd;

    @Override
    protected void onPreExecute() {
        pd = new ProgressDialog( ThisActivity.this );
        pd.setCancelable( false );
        pd.setMessage( "Uploading something..." );
        pd.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        pd.setProgress(0);
        pd.setMax(100);
        pd.show();
    }

    @Override
    protected void onProgressUpdate(Long... progress) {
        pd.setProgress( (int)( progress[0] * 100 / fileSize ) );
     }

    private int storeFile( OutputStream out, String local ) {
        try {
            InputStream in = new FileInputStream( local );

            byte[] buffer = new byte[ bufferSize * 1024 ];
            int read;
            int allRead = 0;
            while( ( ( read = in.read( buffer ) ) != - 1 ) && !isCanceling ) {
                allRead += read;
                this.publishProgress( (long) allRead );
                out.write( buffer, 0, read );
            }
            in.close();
            in = null;
            out.flush();
            out.close();
            out = null;
            return allRead;
        } catch( Throwable th ) {
            Log.d( "Error: ", th.getMessage() );
            return -1;
        }
    }

    @Override
    protected Boolean doInBackground( AFileDescriptor... params ) {
        ASubFileDescriptor file = params[0].getDefaultFile();
        FTPClient ftp = new FTPClient();
        try {
            ftp.connect( FTPHostName );
            ftp.login( FTPUser, FTPPass );
            ftp.cwd( FTPTargetFolder );

            ftp.enterLocalPassiveMode();

                            String storeName = file.getStoreName();
            ftp.setFileType( FTP.BINARY_FILE_TYPE );
            this.fileSize =  file.getFile().length();
            OutputStream out = ftp.storeFileStream( storeName );
            int bytes = storeFile( out,
                       file.getFile().getAbsolutePath() );

            ftp.logout();
            ftp.disconnect();
            return bytes > 0;
        } catch( Throwable th ) {
            Log.d( "FTP Error:", th.getMessage() );
            return false;
        }
    }

    @Override
    protected void onPostExecute( Boolean success ) {
        try {
            pd.dismiss();
        } catch( Throwable th ) {

        }

        if( success ) {
                        // do something
        } else {
                        // do something else
    }
} 
```

此片段用于将某些调试信息上传到本地服务器以获得 2 级支持。根据您使用上传的方式，您可能需要添加更多错误检查/恢复和用户交互。

# c# - WPF：如何在 DockPanel 中拉伸中间的孩子？

> ID：14034674
> 
> 赞同：43
> 
> 时间：2012-12-25T23:22:10.600
> 
> 标签：c#, wpf, xaml, textbox, dockpanel

我向 RadioButton 元素添加了一个 DockPanel，这样我就可以使用 100% 的宽度水平分布单选按钮标签、一个文本框和一个按钮。

`LastChildFill="True"`在 DockPanel 中使用会拉伸最后一个元素。如果文本框是面板中的最后一个子项，则效果很好。但是，由于按钮是最后一个元素并且具有固定宽度，因此应该拉伸文本框。但是，没有像`2ndChildFill="True"`.

我的代码如下所示：

```
 <RadioButton HorizontalAlignment="Stretch"
                                        HorizontalContentAlignment="Stretch">
        <DockPanel >
            <TextBlock VerticalAlignment="Center">in location:</TextBlock>
            <TextBox Grid.Column="1" Margin="10,0,0,0">Path string</TextBox>
            <Button HorizontalAlignment="Right" 
                    Margin="10,0,0,0" Padding="3,0">...</Button>
        </DockPanel>
    </RadioButton> 
```

它给了我这个：

![wpf 截图](../Images/c5ef44fb54fc017bc51bb2a840f79672.png)

任何想法，提示来解决这个问题？提前谢谢了...

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-12-25T23:32:08.510

您需要[`DockPanel.Dock`](http://msdn.microsoft.com/en-us/library/system.windows.controls.dockpanel.dock.aspx)为元素设置附加属性并保留`TextBox`为最后一个元素：

```
<RadioButton HorizontalAlignment="Stretch"
             HorizontalContentAlignment="Stretch">
    <DockPanel LastChildFill="True">
        <TextBlock DockPanel.Dock="Left"
                   VerticalAlignment="Center"
                   Text="in location:" />
        <Button DockPanel.Dock="Right"
                Margin="10,0,0,0"
                Padding="3,0"
                Content="..." />
        <TextBox Margin="10,0,0,0">
            Path string
        </TextBox>
    </DockPanel>
</RadioButton> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-04-01T18:46:06.483

接受的答案是解决您的问题，但会创建另一个问题。如果有人使用键盘 ( `TAB`) 在您的界面中导航，`Button`将在 之前获得焦点`TextBox`。从长远来看，这可能非常烦人。如果您不想破坏您的标签订单，请使用`Grid`而不是`DockPanel`：

```
<RadioButton HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <TextBlock Grid.Column="0" VerticalAlignment="Center">in location:</TextBlock>
        <TextBox Grid.Column="1" Margin="10,0,0,0">Path string</TextBox>
        <Button Grid.Column="2" HorizontalAlignment="Right" Margin="10,0,0,0" Padding="3,0">...</Button>
    </Grid>
</RadioButton> 
```

`TabIndex`另一种方法是使用属性自己控制标签顺序。不过，这可能很棘手，尤其是当您在集合中显示控件时。

```
<RadioButton HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" TabIndex="0">
    <DockPanel LastChildFill="True">
        <TextBlock DockPanel.Dock="Left" VerticalAlignment="Center" Text="in location:" />
        <Button DockPanel.Dock="Right" Margin="10,0,0,0" Padding="3,0" Content="..." TabIndex="2"/>
        <TextBox Margin="10,0,0,0" TabIndex="1">Path string</TextBox>
    </DockPanel>
</RadioButton> 
```

# flattr - 查看捐赠给特定事物的金额

> ID：14034675
> 
> 赞同：0
> 
> 时间：2012-12-25T23:22:17.950
> 
> 标签：flattr

假设您想使用 Flattr 拥有一个类似 kickstarter 的网站，您可以在其中为每个单独的用户创建一个事物。你怎么能告诉（使用 API）每个用户 Flattr'd 多少？它不会立即更新（它必须在每个月的第一天更新），但有可能吗？如果没有办法做到这一点，你能说出一个特定的 Flattr 对你总共有多少吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T12:07:05.153

在每个月的收入报告的详细信息中，有一个链接可以将该收入报告下载为 CSV 文件，然后您可以将其导入您的系统，以了解每件东西收到了多少。该信息尚未通过 API 公开（请参阅此[问题](https://stackoverflow.com/questions/9047968/getting-your-flattr-transactions-from-within-a-python-script)），因此您必须手动下载文件 - 幸运的是，一年只有 12 个月，所以不需要做太多工作:)

CSV 文件包含以下列：

*   period - 格式为 YYYY-MM 的日期
*   id - flattr 事物的内部数字 id
*   flattr url - Flattr.com 上事物的 URL
*   url - 事物指向的原始 URL
*   标题
*   clicks - 该时间段内事物的点击量
*   收入 - 该事物在该期间的收入
*   总点击次数

所以 - 如您所见，如果某项点击次数超过一次，您将无法看到每次点击的价值，并且您也无法查看点击该内容的用户（但是您可以看到一些用户通过[向常规 API 询问](http://developers.flattr.net/api/resources/things/#the-thing-object)更多信息，但由于某些用户是匿名的，如果不征得他们的许可，您无法弄清楚他们是谁）。

如果你真的需要知道一个用户是否有任何东西，那么你可以通过让他们使用[Flattr API](http://developers.flattr.net/api/)[对你的系统进行身份验证来强制他们](http://developers.flattr.net/api/#authorization)[通过你](http://developers.flattr.net/api/resources/flattrs/#flattr-a-url)的系统来扁平化这个东西- 这样你至少会知道是否已经制作了一个 flattr是否由用户决定，但你仍然很难弄清楚他们的 flattr 值多少钱——但这就是 Flattr 的一点——人们应该花他们个人觉得舒服的东西，而不是花别人认为他们应该花的东西消费。

# java - 设置不带“=”的 HttpClient POST 请求正文

> ID：14034676
> 
> 赞同：0
> 
> 时间：2012-12-25T23:22:21.280
> 
> 标签：java, post, httpclient, apache-httpclient-4.x

我需要使用这样的主体发出 POST 请求：

```
{"a":[12345]} 
```

如果我尝试像这样构建 POST 请求：

```
List <NameValuePair> nvps = new ArrayList <NameValuePair>();
nvps.add(new BasicNameValuePair("{\"u\":[123]}", ""));
httpost.setEntity(new UrlEncodedFormEntity(nvps)); 
```

当然，它会使用“=”分隔符创建一个 POST 请求正文

```
{"a":[12345]}= 
```

我该如何做对？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T00:01:23.910

尝试使用使用 JSON 有效负载创建的 StringEntity，而不是当前使用的 UrlEncodedFormEntity、NameValuePair 等。

# .htaccess - 使用 htaccess 从 url 中删除 .php

> ID：14034677
> 
> 赞同：0
> 
> 时间：2012-12-25T23:22:56.187
> 
> 标签：.htaccess

我需要知道如何从目录索引文件中删除“.php”

我不想看到这个：

```
http://www.domain.nl/wa.admin/index.php?login_msg=nopassword 
```

我看到了很多帖子，但由于某种原因它们对我不起作用。

这些是我的基本规则

```
RewriteRule ^admin[/]*$ /wa.admin [L]

RewriteRule ^([^./]{2}[^.]*)$ /index.php?page=$1 [QSA,L] 
```

我必须在内部做什么，因为它来自重定向？我必须使用绝对网址才能使其工作吗？

谢谢， 丰富

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T23:29:55.260

这应该适合你。

```
RewriteBase /

# Stop rewrite process if the path points to a static file anyway
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d 
RewriteRule .* - [L]

RewriteRule (.*) index.php 
```

用文字解释：如果请求的资源是文件夹或文件不重写，如果不重写到index.php。

在你的情况下`wa.admin/index.php?login_msg=nopassword`看起来像`wa.admin/?login_msg=nopassword`.

不要忘记更新您的应用程序。此规则仅将请求映射到适当的文件。这不会影响您的 HTML 输出。这意味着通过这种重写，您可以访问两个 URL，但要在应用程序中链接哪个取决于您。

如果您想与其他人分发您的应用程序，您可以结合使用环境和 if 标签来确定 mod_rewrite 是否可用。

```
<IfModule mod_rewrite.c>
# Enable URL rewriting
RewriteEngine On

# Set flag so we know URL rewriting is available
SetEnv REWRITEURLS 1

# You will have to change the path in the following option if you
# experience problems while your installation is located in a subdirectory
# of the website root.
RewriteBase /

# Stop rewrite process if the path points to a static file anyway
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d 
RewriteRule .* - [L]

RewriteRule (.*) index.php

</IfModule> 
```

用于`apache_getenv("REWRITEURLS");`访问设置变量的值。

您的代码可能如下所示（未经测试）：

```
<?php
$rewriteurls = apache_getenv("REWRITEURLS");

if ($rewriteurls == '1') {
    //adjust all your links
}
?> 
```

# javascript - Google 地图控件无法正确显示

> ID：14034678
> 
> 赞同：1
> 
> 时间：2012-12-25T23:23:18.073
> 
> 标签：javascript, css, google-maps

> **可能重复：**
> [缩放控制和街景未显示在我的 Google 地图上？](https://stackoverflow.com/questions/8511436/zoom-control-and-streetview-not-showing-on-my-google-map)

我一直在尝试不同的浏览器、操作系统、画布大小，都一样（注意缩放栏应该在的位置）。任何人碰巧遇到了这个问题？ [http://imgur.com/K6G3s](https://imgur.com/K6G3s)
这就是我初始化地图的方式（真的没什么特别的）：

```
var options = {
    zoom: 8,
    mapTypeId: google.maps.MapTypeId.ROADMAP,
    center: mapCenter
};
map = new google.maps.Map(document.getElementById("mapCanvas"), options); 
```

任何帮助表示赞赏！

# c# - .Net Micro Framework 中的事件处理

> ID：14034679
> 
> 赞同：1
> 
> 时间：2012-12-25T23:23:28.027
> 
> 标签：c#, event-handling, .net-micro-framework, netduino

我想知道是否有人对如何在 .Net Micro Framework 中正确执行事件有一些指示和/或很好的指南。

我已经获得了一个 Netduino，并且正在围绕各种组件制作一个小型包装框架，我正试图让它成为一种事件驱动的。开始按照我习惯的方式进行操作，但发现[`Microsoft.SPOT`](http://msdn.microsoft.com/en-us/library/cc506546.aspx)命名空间中有几个类和接口似乎与事件相关，而我之前没有使用过它们中的任何一个。例如：

*   调度员
*   DispatcherFrame
*   调度程序对象
*   调度员操作
*   调度器定时器
*   EventHandlersStore
*   事件路由
*   事件接收器
*   事件监听器
*   事件处理器
*   路由事件

还有几个。我如何正确使用所有这些？我应该使用它们吗？

作为一个例子，我想在照片/光传感器周围创建一个包装器，只要光度发生变化，它就会引发一个事件。为此（我想？）我需要轮询模拟引脚的值，看看它是否改变。我可以很简单地通过在单独的线程上触发观察者或类似的东西来做到这一点。但是还有其他方法我应该这样做吗？例如，我想我不应该每个传感器都有一个线程，因为这可能会变得很多，而且这里的资源非常有限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T22:44:15.790

就像在其他 .net 版本中一样使用事件。

声明和使用事件。

如果您希望订阅者使用自定义方法签名，请声明并使用委托。

如果您想遵循 (sender, args) 模式等，请构建自定义事件参数。

使用事件处理程序或内联函数订阅/取消订阅事件。

底线是微框架事件没有什么特别之处。您拥有其他版本中的所有内容，因此只需专注于为您的消费者制作一个好的 api，就像您通常会做的那样。

# android - 使用套接字的应用程序在尝试连接到服务器时冻结

> ID：14034680
> 
> 赞同：2
> 
> 时间：2012-12-25T23:23:42.277
> 
> 标签：android, sockets

我正在做将一些数据从手机发送到 PC 的应用程序。我使用套接字来做到这一点。当服务器在线时它可以工作，但是当我尝试连接错误的 ip/port 或服务器没有运行时，应用程序会冻结，我什么也做不了。这是因为手机上的客户端尝试连接到服务器。

我有主要课程：

```
Thread cThread = new Thread( new TCPClient( ip, port, message, context) );
cThread.start(); 
```

新 TCPClient 中有上下文，因为我需要在发送消息或出现错误时制作 Toast。在 TCPClient 类中有：

```
public void run(){
try {
InetAddress serverAddr = InetAddress.getByName(s_ip);
Log.d("TCP", "C: Connecting...");
Socket socket = new Socket(serverAddr, s_port); 
```

当服务器在线时，它将转到：

```
Log.d("TCP", "C: Sending: '" + s_msg + "'");
PrintWriter out = new PrintWriter( new BufferedWriter( new OutputStreamWriter(socket.getOutputStream())),true);
out.println(s_msg);
Log.d("TCP", "C: Sent.");
Log.d("TCP", "C: Done."); 
```

但是当服务器离线或我输入错误的 ip/port 时，我的应用程序会冻结。一时间我什么都做不了。

是否有任何解决方案可以在一段时间后强制停止尝试连接到服务器？例如，在 5 秒后应用程序会去捕捉并给我错误。

我尝试使用 AsyncTask 执行此操作，然后即使客户端尝试连接到服务器，应用程序仍在工作，但是在我无法接受的时间后出现错误的 toast，所以我想要一个解决方案，当客户端无法连接到服务器时会给我错误例如 5 秒。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T00:44:57.060

您可以设置连接超时。您必须使用不同的`Socket`类构造函数。其中：

```
Socket socket = new Socket(serverAddr, s_port); 
```

利用：

```
Socket socket = new Socket();
socket.connect(new InetSocketAddress(serverAddr, s_port), 5000); 
```

如果超时，则会引发异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T00:40:31.673

也许你没有设置a`timeout` `connection`所以它`0`默认是“”，这意味着它永远不会超时，所以你可以将超时设置为1分钟它不会冻结超过一分钟。

# c++ - Linux 向活动应用程序发送 unicode 字符

> ID：14034681
> 
> 赞同：2
> 
> 时间：2012-12-25T23:23:50.913
> 
> 标签：c++, linux, qt

好的，所以我正在尝试使用 C++ 和 Qt4 for Linux 开发一个应用程序，它将某些键序列映射到特殊的 Unicode 字符。此外，我正在尝试使其成为双语，因此发送的特殊 Unicode 字符取决于所选语言。示例：AltGr+s 将发送 ß 或 ș，具体取决于选择了德语还是罗马尼亚语。在 Windows 上，我使用 AutoHotKey 实现了这一点。但是，我无法让 IronAHK 在 Linux 上工作，所以我为它编写了一个不错的 Qt 应用程序，使用 Qxt 注册“全局”快捷方式。我试过这个片段：

```
void mainWnd::sendKeypress( unsigned int keycode )
{
    Display *display = QX11Info::display();
    Window curr_focus;
    int revert_to;

    XGetInputFocus( display, &curr_focus, &revert_to );

    XTestFakeKeyEvent( display, keycode, true,  0 );
    XTestFakeKeyEvent( display, keycode, false, 1 );

    XFlush( display );
} 
```

从另一个应用程序（它工作的地方）复制，但在这里它似乎什么都不做。此外，我尝试发送的字符在我目前在笔记本电脑上使用的 US 101 键盘上找不到（以及作为操作系统中的布局），这可能存在问题。

所以我的问题是：如何让应用程序向具有焦点的应用程序发送一个 Unicode 字符，插入一个特殊字符（有点像 KCharMap）？请记住，这些是在普通美式键盘上找不到的特殊字符。提前致谢。

# c# - TableServiceContext：序列化时无法转换为不支持的类型“DateTimeOffset”异常

> ID：14034699
> 
> 赞同：3
> 
> 时间：2012-12-25T23:27:40.920
> 
> 标签：c#, azure, azure-table-storage

我一直在尝试为 Azure 设置新的 MVC Web 角色，并连接到 Azure 表服务。我在 VS 2012 中使用了 1.8 Azure SDK 和 Azure 项目模板。我将所有 nuget 包更新到最新版本，但我仍然怀疑 WCF 对 DateTimeOffset 的支持存在问题，这是版本 5 中的新功能。

我有一个像这样的简单对象：

```
[DataServiceEntity()]
[DataServiceKey("PartitionKey", "RowKey")]
public class AppUser : TableEntity
{
} 
```

我有一个 MVC 操作来创建一个新的 AppUser，如下所示：

```
var connectionString = CloudConfigurationManager.GetSetting("DataStorageConnectionString");
var storageAccount = CloudStorageAccount.Parse(connectionString);
var tableClient = storageAccount.CreateCloudTableClient();
var ctx = new TableServiceContext(tableClient);

ctx.AddObject("Users", user);
var response = ctx.SaveChanges(); 
```

当此代码在我的 MVC Web 角色中执行时，我的 connectString 的结果是 UseDevelopmentStorage=true。

SaveChanges 调用导致以下异常：

```
System.NotSupportedException was caught
  HResult=-2146233067
  Message=Can't cast to unsupported type 'DateTimeOffset'
  Source=System.Data.Services.Client
  StackTrace:
       at System.Data.Services.Client.ClientConvert.GetEdmType(Type propertyType)
       at System.Data.Services.Client.DataServiceContext.WriteContentProperty(XmlWriter writer, String namespaceName, ClientProperty property, Object propertyValue)
       at System.Data.Services.Client.DataServiceContext.WriteContentProperties(XmlWriter writer, ClientType type, Object resource, EpmSourcePathSegment currentSegment, Boolean& propertiesWritten)
       at System.Data.Services.Client.DataServiceContext.CreateRequestData(EntityDescriptor box, Boolean newline)
       at System.Data.Services.Client.DataServiceContext.SaveResult.CreateChangeData(Int32 index, Boolean newline)
       at System.Data.Services.Client.DataServiceContext.SaveResult.BeginNextChange(Boolean replaceOnUpdate)
       at System.Data.Services.Client.DataServiceContext.SaveChanges(SaveChangesOptions options)
       at MvcWebRole1.Controllers.UserController.Create(AppUser user) in c:\src\Azure1\MvcWebRole1\Controllers\UserController.cs:line 67
  InnerException: 
```

查看 TableEntity 时，Timestamp 属性的类型为 DateTimeOffset。我一直在调查我的构建中的依赖项之一是旧的并导致问题的想法，但我无法识别任何旧版本。据我所知，我正在使用最新版本的SDK，最新版本的项目模板，并更新了所有的包，所以我现在有点不知所措。

** 12/26 更新 **

我创建了一个新的控制台应用程序，仅使用存储客户端进行测试，并且能够完美地复制该行为。Azure 存储客户端 nuget 包仅在一个多星期前发布，可能还没有打算出来。我无法让它与开发存储或实时 Azure 一起使用，但从 10 月和 6 月分别恢复到 1.8 和 1.7 SDK 附带的 1.7 程序集需要一些重写，但它确实适用于两个开发存储和 Azure。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T00:43:51.520

您是否尝试过不从 TableEntity 派生而只是将您自己的 PartitionKey/RowKey 属性实现为字符串，将时间戳实现为 DateTime？

此外，尝试针对真实的 Azure 存储帐户进行测试。在过去的几年里，我发现模拟存储帐户对于认真的 Azure 存储开发来说并不是一个有用的测试平台。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-01T15:59:05.140

在我看来，您正在混合访问方法。TableServiceContext 来自 1.x 存储 API，而 TableEntity 来自 2.0 存储 API。

如果您想使用 1.x 库，请从 TableServiceEntity 而不是 TableEntity 派生并且不要使用这些属性。如果要使用 2.0 库，请使用 CloudTable 和 TableOperation 而不是 TableServiceContext。

# c++ - 在 C++ 中将字符串转换为变体

> ID：14034706
> 
> 赞同：8
> 
> 时间：2012-12-25T23:29:19.120
> 
> 标签：c++, visual-studio-2010, visual-c++, variant

我有这个当前代码，它将“AAPL”输入到 Excel 表中，并返回相应的值。

我想这样做，以便在`cout << "Ticker: ";`我可以输入股票代码（例如 AAPL）并使用它之后，`variant_t ticker = "xxx".`我尝试通过使用这样做，`string`但我得到一个错误，说不能从`'std::string to const _variant_t &'`无论如何要这样做？提前致谢。

```
 XL->Workbooks->Open(L"F:\\xxx\\Desktop\\fxxxx.xlsx");
 Excel::RangePtr pRange = pSheet->Cells;

 cout << "Ticker: ";
 variant_t ticker = "AAPL";

 pRange->Item[2][1] = ticker;
 double value = pRange->Item[2][2];
 cout << "\n Value = " << value << endl; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T00:16:31.877

电话`ticker.SetString(str.c_str())`应该可以完成这项工作。

请参阅：http: [//msdn.microsoft.com/en-us/library/x295h94e%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/x295h94e%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T01:20:55.777

这是工作代码：

```
 XL->Workbooks->Open(L"F:\\xx\\Desktop\\xxz.xlsx");                              //Open databse
    Excel::_WorksheetPtr pSheet = XL->ActiveSheet;                                      //Point to Active Sheet
    Excel::RangePtr pRange = pSheet->Cells;                                             //Point to Active Cells
    cout << " Ticker: ";                                                                //Prompt Ticker
    string tick;                                                                        //Define string "tick" to store ticker
    cin >> tick;                                                                        //Store ticker
    variant_t ticker;                                                                   //Define variant to be used for ticker
    ticker.SetString(tick.c_str());                                                     //Convert string to variant                                 
    pRange->Item[2][1] = ticker;                                                        //Write ticker to cell
    double bi = pRange->Item[2][2];                                                     //Read Beta, store as "bi"
    cout << "\n Beta = " << bi << endl;                                                 //Return Value
    XL->Application->Quit(); 
```

# html - 当父元素悬停时，如何将 css 转换应用于元素？

> ID：14034709
> 
> 赞同：1
> 
> 时间：2012-12-25T23:30:01.200
> 
> 标签：html, css, css-transitions

我有html：

```
<div class="social-section">
    <a href="#" class="glyphicons facebook"><i></i></a>
    <a href="#" class="glyphicons twitter"><i></i></a>
</div> 
```

当鼠标悬停时，我希望使用 CSS3 过渡让图标淡化为不同的颜色。不幸的是，如果可能的话，我不确定如何进行这项工作。我目前对 css 的尝试是：

```
.social-section * i:before { /* Apply this to the i:before, when the a is hovered */
    -webkit-transition: all 0.3s ease-in;
    -moz-transition: all 0.3s ease-in;
    -ms-transition: all 0.3s ease-in;
    -o-transition: all 0.3s ease-in;
    transition: all 0.3s ease-in;
}

.social-section a i:before {
    color: red;
}

.social-section a:hover i:before {
    color: black;
} 
```

如果这有帮助，这里是 Glyphicons 字体 css 代码的相关部分：

```
.glyphicons {
    display: inline-block;
    position: relative;
    padding: 0 0 5px 35px;
    *display: inline;
    *zoom: 1;
}
.glyphicons i:before {
    position: absolute;
    left: 0;
    top: 0;
    font: 20px/1em 'Glyphicons';
    font-style: normal;
    color: red;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T23:34:12.643

一个伪代码，因为我不确定它应该如何根据您的问题行事......

将您拥有的过渡 css 代码放在您想要影响的元素中（即不是父元素）

```
#child {
   // transitions....
} 
```

然后做

```
 #parent:hover #child {
   // your changes
} 
```

当父元素悬停时，对子元素进行更改。孩子现有的过渡效果将用于此，我认为这是您的目标。

此外，如果您要在图标之间转换，则需要更改精灵图像的位置，我假设您正在使用它，而不是更改`color`样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T09:44:10.213

答案是伪元素不能在大多数浏览器的大多数版本上进行转换。这个问题非常令人沮丧，以至于 Chris Coyier（css-tricks.com 的）在当前状态下[保持打开页面。](http://css-tricks.com/transitions-and-animations-on-css-generated-content/)

截至撰写本文时，伪元素的转换受以下支持：

*   火狐 4.0+
*   铬 26+
*   IE 10+

您可以在浏览器上[确认这一点。](http://codepen.io/chriscoyier/pen/BkhFI)

# google-chrome - jpg 文件未在 chrome 中显示

> ID：14034716
> 
> 赞同：4
> 
> 时间：2012-12-25T23:32:06.577
> 
> 标签：google-chrome, jpeg

我在 chrome 中查看 jpg 文件时遇到问题。

我在一个文件夹中有 4 张图片。除了我的谷歌浏览器，所有浏览器都显示出来了。实际上chrome只显示3张图片:(我很困惑。

你能在你的 chrome 中检查一下吗？如果您的 chrome 也一样，请您帮我找出问题所在？

```
No 1: <img src="http://demo.cutedrops.com/dmi/sites/default/files/donate-buttons/donate-my-insurance-ad-300-250.jpg" />
<br />
No 2: <img src="http://demo.cutedrops.com/dmi/sites/default/files/donate-buttons/donate-my-insurance-ad-200-200.jpg" />
<br />
No 3: <img src="http://demo.cutedrops.com/dmi/sites/default/files/donate-buttons/donate-my-insurance-ad-468-90.jpg" />
<br />
No 4: <img src="http://demo.cutedrops.com/dmi/sites/default/files/donate-buttons/donate-my-insurance-ad-125-125.jpg" />​ 
```

[http://jsfiddle.net/h8KMP/](http://jsfiddle.net/h8KMP/)

注意：我在 photoshop cs6 中将文件保存为“另存为 web”。

谢谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-25T23:47:30.847

AdBlock for Chrome 可能会导致根据图像尺寸阻止图像。

如果您正在使用此扩展程序，请尝试禁用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T23:42:44.650

我正在使用**`Google Chrome Version 23.0.1271.97 m`**，您的图像***没有问题。***`4`

由于 Chrome 没有像 Firefox 那样的浏览器内图像信息，因此我在当前版本的 Firefox 中检查了图像，`Right-Click Mouse >>> View Image Info`并且图像规格检查正常。

![](../Images/5baba25438cc4dc3da581df4b88b6a9e.png)

为了验证图像本身不是罪魁祸首，我将它下载到一个临时文件夹并使用免费软件[**IrfanView Image**](http://www.irfanview.com/)桌面应用程序检查了规格。该信息也得到了很好的验证，因为 IrfanView 将检测任何文件头问题（如果存在）。

![](../Images/319c16b1aa2bd309b79a13bb7bba845d.png)

**编辑：**

最近的评论表明图像在加载后会消失。在这种情况下，我建议您检查以确保您的 Chrome 已更新到当前版本。

从 Chrome 的设置中，选择**`About Google Chrome`**检查是否有可用更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-16T21:41:23.900

我遇到的问题是 Chrome 没有使用 sRGB 颜色显示 jpeg 文件。我刚刚在 Gimp 中打开了图像并将其导出为 jpeg 以覆盖原始图像，它成功了！我希望这可以帮助那里的人。

# git - 仅在拉取请求中包含特定提交

> ID：14034718
> 
> 赞同：30
> 
> 时间：2012-12-25T23:32:28.867
> 
> 标签：git, github, pull-request

假设我已经克隆了存储库，创建了新分支“Topic1”，进行了更改，提交了它们，然后将它们推送到了远程仓库`git push origin Topic1`。之后，我向主分支发出了拉取请求。

然后在我的本地存储库中，我从分支“Topic1”签出到分支“Topic2”，在那里进行了一些更改，提交并再次将这个新分支推送到远程。并再次向主人提出拉取请求。我想提一下，同时没有对 master 分支进行任何更改，因此我不需要将本地 repo 与上游同步。

这就是问题所在：当我转到“Topic2”的拉取请求页面时，“Topic1”的所有提交都会出现在那里。所以，我的问题 - 我如何才能获得仅与“Topic2”分支相关的第二次拉取请求提交？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-12-25T23:43:58.370

1.  创建一个新的分支基于`upstream/master`

2.  *从您的分支Topic2*[中挑选](http://www.kernel.org/pub/software/scm/git/docs/git-cherry-pick.html)相关提交（进入新分支）

3.  从这个新分支创建一个拉取请求。

# node.js - 如何使用 Node.js + Mongoose + MongoDB 保存多语言数据？

> ID：14034720
> 
> 赞同：1
> 
> 时间：2012-12-25T23:32:38.853
> 
> 标签：node.js, mongodb, mongoose

我想在我的数据库中保存多语言数据。在 Django 中，我使用了 django-transmeta，我可以轻松地保存和访问多语言数据。

在 Mongoose 中，我应该如何保存数据，或者我应该使用哪些模块？

例如，我想以 3 种语言保存一个项目的名称：

在分贝中，应该是：

```
{
  name : {
        en : 'Car',
        tr : 'Araba',
        es : 'Coche'
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T07:06:40.803

是的你是对的...

这是一种方法：

```
{
  _id
  name : {
        en : 'Car',
        tr : 'Araba',
        es : 'Coche'
  }
} 
```

另一个是：

```
{
   YourId:'1'
   locale: 'en',   
   name: 'Car'
}
{
   YourId:'1'
   locale: 'tr',   
   name: 'Araba'
}
{
   YourId:'1'
   locale: 'es',   
   name: 'Coche'
} 
```

在第二个例子中，索引'YourId'和'locale'很好

# python - 关于GAE的第一个问题

> ID：14034721
> 
> 赞同：-1
> 
> 时间：2012-12-25T23:32:56.827
> 
> 标签：python, google-app-engine

我正在接近 Google App Engine。我想实现一些处理程序，但我收到“糟糕！此链接似乎已损坏”。他们每个人的错误：

```
from google.appengine.ext import webapp
from google.appengine.ext.webapp.util import run_wsgi_app

class MainPage(webapp.RequestHandler):

    def get(self):
        self.response.headers['Content-Type'] = 'text/plain'
        self.response.out.write('Hello, webapp World!')

application = webapp.WSGIApplication([('/', MainPage)], debug=True)

def main():
    run_wsgi_app(application)

if __name__ == "__main__":
    main() 
```

如果我使用简单的打印功能（即打印“2gf”），一切都会完美运行。这是我的 app.yaml 文件：

```
application: sample-app
version: 1
runtime: python
api_version: 1

handlers:
- url: /aaa/aaa
  script: helloworld.py

- url: /bbb/bbb
  script: helloworld2.py 
```

建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T23:43:48.073

您的代码很旧，并且 yaml 文件将 python 脚本/应用程序指向了错误的 url。试试下面的代码：

```
import webapp2

class HomePageHandler(webapp2.RequestHandler):
def get(self):
    self.response.headers['Content-Type'] = 'text/plain'
    self.response.write('Hello appengine!')

app = webapp2.WSGIApplication([('/', MainPage)],
                                   debug=True) 
```

app.yaml 文件应该包含如下内容：

```
application: helloworld
version: 1
runtime: python27
api_version: 1
threadsafe: true

handlers:
- url: /.*
script: helloworld.py 
```

此外，请阅读以下[App Engine python 教程](https://developers.google.com/appengine/docs/python/gettingstartedpython27/helloworld)。它很好地解释了 App Engine 编码的主要概念。当我开始时，它对我帮助很大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T00:20:56.443

在您的`app.yaml`中，您没有任何路由说明`/`。因此，当您点击的 URL 与 YAML 中已有的 URL 不匹配时，您的应用程序不知道该怎么做，并向您显示该错误。为了解决这个问题，您需要为您的`app.yaml`. 正如@Tkingovr（给他+1）所提到的，您希望将默认（`/.*`）指向您的脚本。在您的底部添加该处理程序`app.yaml`并将其指向您的主脚本。但是我同意@Tkingovr - 现在切换到2.7（当你第一次学习时）从长远来看会让事情变得更容易:)

# jquery - 选择替代路线会减少缩放

> ID：14034724
> 
> 赞同：1
> 
> 时间：2012-12-25T23:33:52.007
> 
> 标签：jquery, google-maps-api-3, tabs, zooming, directions

我正在使用 google maps api v3 和 jquery mobile。我有一个页面，其中 tab1 显示带有路线的地图，而 tab2 显示路线详细信息 (setPanel) 。当我为响应调用 setDirections 时，一切正常。地图居中，缩放也正确。当我导航到详细信息并选择替代路线并按 tab1 返回地图以查看新路线时，缩放关闭。为什么会这样？我可以做点什么让它工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T00:18:22.237

如果在地图未显示的情况下更改方向（到备用路线），则地图大小错误（隐藏时其大小向 API 报告为零）。您需要在地图显示后触发[“调整大小”事件。](https://developers.google.com/maps/documentation/javascript/reference#Map)

从文档中：

> resize - 当 div 更改大小时，开发人员应在地图上触发此事件：google.maps.event.trigger(map, 'resize')。

更新：当地图被隐藏且未设置边界时，似乎没有触发方向更改事件。显示地图时手动设置边界似乎有效。

```
function refresh(map) {
  google.maps.event.trigger(map, 'resize');
  var routeIndex = globVars.directionsDisplay.getRouteIndex();
  var routes  = globVars.directionsDisplay.getDirections().routes;
  globVars.map.fitBounds(routes[routeIndex].bounds);    
  alert('resize');                    
} 
```

[jsfiddle](http://jsfiddle.net/msNAb/10/)

# grails - 从 Grails 在 S3 上获取图像时“权限被拒绝”

> ID：14034726
> 
> 赞同：2
> 
> 时间：2012-12-25T23:34:13.657
> 
> 标签：grails, groovy, amazon-web-services, amazon-s3, amazon-elastic-beanstalk

我有一个 grails 2.1.1 应用程序正在访问存储在 s3 上的存储桶中的图像，我正在使用 Grails-AWS 插件访问它。

当我使用“grails run-app”并且服务器是 localhost:8080/myApp 时，一切正常。我可以毫无问题地放置和获取文件。

但是，当我将 war 文件部署到 Amazon Elastic Beanstalk 时，尝试获取图像时出现以下错误：

```
 java.io.FileNotFoundException: 90916.png (Permission denied)

at java.io.FileOutputStream.<init>(FileOutputStream.java:209)

at java.io.FileOutputStream.<init>(FileOutputStream.java:160)

at com.sommelier.domain.core.MyDomainObject.getPicture(MyDomainObject.groovy:145) 
```

这是我获取引发错误的图像的代码：

```
 File getPicture() {

    def url = aws.s3().on("mybucket").url(image, "myfoldername")

    File imageFile = new File(image)
    def fileOutputStream = new FileOutputStream(imageFile)
    def out = new BufferedOutputStream(fileOutputStream)
    out << new URL(url).openStream()
    out.close()

    return imageFile        

} 
```

我已将我的 s3 存储桶的权限设置为尽可能开放。我使用了“添加更多权限”按钮并添加了所有可能的选项。

这是我的存储桶策略：

```
{
"Version": "2008-10-17",
"Id": "Policy1355414697022",
"Statement": [
    {
        "Sid": "AllowPublicRead",
        "Effect": "Allow",
        "Principal": {
            "AWS": "*"
        },
        "Action": "s3:GetObject",
        "Resource": "arn:aws:s3:::mybucket/*"
    },
    {
        "Sid": "",
        "Effect": "Allow",
        "Principal": {
            "AWS": "*"
        },
        "Action": "s3:PutObject",
        "Resource": "arn:aws:s3:::mybucket/*"
    }
]
 } 
```

还有我的 CORS 配置：

```
<CORSConfiguration>
<CORSRule>
    <AllowedOrigin>*</AllowedOrigin>
    <AllowedMethod>GET</AllowedMethod>
    <MaxAgeSeconds>3000</MaxAgeSeconds>
    <AllowedHeader>Authorization</AllowedHeader>
</CORSRule>
 </CORSConfiguration> 
```

有什么想法吗？这是 S3 权限问题，还是有其他问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T08:18:21.897

您似乎正在尝试创建没有写权限的文件。

最好不要将副本保存到应用服务器。如果可以，我建议您从内存中的对象返回操作/内容/任何内容。

但是，如果您确实出于某种原因在本地确实需要该文件，则应该在 /tmp 中具有写权限

# jquery - jQuery .hover 错误

> ID：14034727
> 
> 赞同：0
> 
> 时间：2012-12-25T23:34:21.660
> 
> 标签：jquery

当鼠标悬停在框（“titulo”）上时，我正在做一些代码来做某事，但是当鼠标悬停在字母上时，效果会关闭。代码在上面，网站在这里：

[http://www.feijaodesign.com/toga/](http://www.feijaodesign.com/toga/)

带有效果的框是唯一带有文本“PROMOÇOES”的框

谢谢队友。

```
$(".titulo").hover(function(){
  $(".titulo").animate({
    top: "0px",
    height: "100px"
  }, 100 );
});

$(".titulo").hover(function(){
  $(".titulo").animate({
    top: "55px",
    height: "45px"
  }, 100 );
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T23:37:56.427

您应该[`hover()`](http://api.jquery.com/hover/)以不同的方式使用方法：

```
$(".titulo").hover(function() {
    $(this).animate({
        top: "0px",
        height: "100px"
    }, 100);
}, function() {
    $(this).animate({
        top: "55px",
        height: "45px"
    }, 100);
}); 
```

# fat-free-framework - 无脂肪框架 {closure}() 缺少参数 1

> ID：14034728
> 
> 赞同：2
> 
> 时间：2012-12-25T23:34:27.903
> 
> 标签：fat-free-framework

在遵循这段代码时

```
 $f3=require('lib/base.php');

    $f3->route('GET /brew/@count',
        function($f3) {
            echo $f3->get('PARAMS.count').' bottles of beer on the wall.';
        }
    );
    $f3->run(); 
```

[来自https://github.com/bcosca/fatfree#routing-engine](https://github.com/bcosca/fatfree#routing-engine)上的 Fat-Free Framework 示例，我在浏览器中收到此错误：

```
 Internal Server Error

    Missing argument 1 for {closure}()

    * /var/www/f3/index.php:36 Base->{closure}
    * /var/www/f3/lib/base.php:972         
    * Base->call(Closure::__set_state(),NULL,'beforeroute,afterroute')
    * /var/www/f3/index.php:40 Base->run() 
```

我知道问题是 $f3 没有作为参数传递给函数，但我不明白为什么。有谁能够帮我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T01:00:47.860

我只是同样的情况！我使用的是 SourceForge 的 3.0.1 版。我尝试了以下方法，它有效，但产生了其他问题：

```
$f3=require('lib/base.php');

$f3->route('GET /brew/@count',
    function() use ($f3) {
        echo $f3->get('PARAMS.count').' bottles of beer on the wall.';
    }
);
$f3->run(); 
```

use 子句（在 php 中没有很好地记录）允许您使用来自匿名函数的父范围的变量。在此处阅读更多内容：[闭包与匿名函数（区别？）](https://stackoverflow.com/questions/4912116/closure-vs-anonymous-function-difference)

**尝试将 F3 核心升级到最新版本。其中一位开发人员建议从此处升级到 3.0.2 版本：[https](https://github.com/bcosca/fatfree) ://github.com/bcosca/fatfree 。这是一个非常快速的修复！**

# android - android单项上下文菜单

> ID：14034731
> 
> 赞同：-2
> 
> 时间：2012-12-25T23:35:57.760
> 
> 标签：android, contextmenu, onlongclicklistener

我为布局设置了一个 onLongClickListener。长按时，我需要一个带有单一“删除”选项的上下文菜单。最简单的管理方法是什么？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T23:58:49.520

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    // ....

    mView = someView;
}

@Override
public void onCreateContextMenu(ContextMenu menu, View v,
        ContextMenuInfo menuInfo) {

    menu.setHeaderTitle("Menu Title");
    MenuItem remove = menu.add("Delete");

    remove.setOnMenuItemClickListener(new OnMenuItemClickListener() {
        @Override
        public boolean onMenuItemClick(MenuItem item) {
            //doStuff...
        }
    });

    super.onCreateContextMenu(menu, v, menuInfo);
} 
```

在 onLongPress 或者你可以调用[openContextMenu的东西](http://developer.android.com/reference/android/app/Activity.html#openContextMenu%28android.view.View%29)

# facebook - 使用 FB.XFBML.parse 重新渲染 Facebook 插件

> ID：14034732
> 
> 赞同：2
> 
> 时间：2012-12-25T23:36:20.900
> 
> 标签：facebook, facebook-like, facebook-javascript-sdk, xfbml

有没有办法使用 FB.XFBML.parse 而无需再次渲染 Facebook 插件，这会导致它“闪烁”（消失并重新出现）。

将使用 Facebook Like 按钮或 Facebook Recommandations Bar。

现场示例：[http ://www.gablabelle.com/eve-d](http://www.gablabelle.com/eve-d)

滑动查看右下角的闪烁。

```
$.address.state(ajax_object.path).crawlable(true).value(whereiam);
$(".fb-recommendations-bar").data("href",whereiamurl);
//$(".fb-like").data("href",whereiamurl);
fburl = $(".fb-recommendations-bar").data("href");
//fburl = $(".fb-like").data("href");
console.log(fburl);
FB.XFBML.parse(); 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T22:08:43.853

当需要“页面更改”时，在 facebook 插件 div 的顶部添加一个不透明层。将其设置为完全不透明的动画。调用 FB.XFBML.parse() 并给它一些时间重新渲染。将图层设置为不透明，然后从 facebook 插件 div 的顶部移除不透明图层（或将其留在那里，以便下次您需要进行“页面更改”而不实际重新加载页面时）。

这种技术会给你一个优雅地消失/重新出现的插件，而不是一个刺耳的刺耳的“闪烁”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T13:36:17.267

您可以通过将父 DOM 元素传递给`FB.XFBML.parse`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-19T08:23:38.323

DMCS provided what seems to be the only half-proper answer, but it's butt ugly. You don't know how long it'll take on each persons web browser to render the stuff. The callback which supposedly says it's rendered doesn't work either. Also the flicker isn't seen in firefox but only in google chrome.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T07:27:10.187

在幻灯片更改事件中缓存上**一张幻灯片**+**当前幻灯片**+**下一张幻灯片**的 Facebook 赞。因此，当您转到下一个或上一个并且它的 Facebook like 应该已经准备好/加载时，用户不应该看到闪烁。除非他/她快速使用幻灯片。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-25T15:14:48.487

我最近有这个。

我通过将 XFMBL 包装在一个变量中来解决它......不知道为什么，但没有它它似乎会闪烁......完全破解了一种阻止闪烁但对我有用的方法！

```
 if(call == 0){
          FB.XFBML.parse();
          call = 1;
  } 
```

# c# - 是否有适用于 Windows 8 应用程序的设置查看器/管理器？

> ID：14034733
> 
> 赞同：0
> 
> 时间：2012-12-25T23:36:30.710
> 
> 标签：c#, windows-8, windows-store-apps, application-settings, roaming

为了测试我的漫游和/或本地设置，我希望能够清除所有设置。

我可以这样做，我猜：

```
App.roamingSettings.Value["SomeVal"] = string.Empty;
App.roamingSettings.Value["SomeOtherVal"] = string.Empty;
App.roamingSettings.Value["YetAnotherVal"] = string.Empty;
...
etc. 
```

...但我宁愿有一些更快，更清洁（没有双关语）的方式。有吗？

此外，与此相关的是，如果有一个“设置管理器”实用程序可以快速验证它们是否也是您认为的那样，那将是一件好事。有人知道吗？

## 更新

这是我根据答案“自己动手”的尝试；到目前为止，没有去：

```
string roamingSettingPairs = string.Empty;
for (int i = 0; i < App.roamingSettings.Values.Count; i++)
{
    // Print out whatever you want to verify that everything is as it should be
    //string roamingSettingName = App.roamingSettings.Name[i].ToString();
    //string roamingSettingValue = App.roamingSettings.Values[i].ToString();
    Dictionary<string, object> roamingSettingVals = App.roamingSettings.Values;
    string roamingSettingName = roamingSettingVals.Keys[i];
    object roamingSettingObj = roamingSettingVals.Values[i];
    //roamingSettingPairs = string.Format("{0}{1}={2}{3}", roamingSettingPairs, roamingSettingName,
      //                                  roamingSettingValue, Environment.NewLine);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:57:50.383

您可以使用以下代码删除所有漫游设置：

```
ApplicationData.Current.RoamingSettings.Values.Clear(); 
```

对于设置管理器，我可能会像这样使用 for 循环：

```
for (int i = 0; i < ApplicationData.Current.RoamingSettings.Values.Count; i++)
{
    // Print out whatever you want to verify that everything is as it should be
} 
```

# mysql - 直观地管理表格数据的简便方法

> ID：14034734
> 
> 赞同：4
> 
> 时间：2012-12-25T23:36:51.150
> 
> 标签：mysql, sql, database, ms-access

我正在从事经济项目，我需要管理具有许多外键的链接表中的大数据。我有几年的 Oracle DBA 经验，所以我可以毫无问题地管理所有这些，但我需要能够与不了解数据库的其他人共享数据，因为我需要让他们以图形方式显示数据。Toad 可以满足我的所有需求以及更多功能，但该程序对于我的需求来说太复杂了。

与其浪费时间用 C# 编写管理数据的程序，我正在寻找一个好的程序：

1.  显示主表/视图数据，带有过滤/分组/排序选项和下拉框选项
2.  选择一行并按选定行的数据显示链接表中的数据
3.  制作我可以调整和打印的所选行的报告/数据页。（我知道这是一个更大的要求）

此外，什么是最适合和最简单的数据库？我只与 Oracle 合作过，但肯定太多了，所以 MySql？Access（我首先尝试在Access程序中完成所有这些，但是调整表格太难了，最后你无法制作发布版本。

并且这些表将具有相同 ID 的 start_date 和 finish_date，但我认为我可以最大限度地制作仅显示最后一个的视图不会成为问题。（顺便说一句，这样的表叫什么名字，我从来不知道）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T17:05:01.337

看看 Tableau [http://www.tableausoftware.com](http://www.tableausoftware.com)

它将让用户以多种不同的方式查看数据，进行出色的可视化并与大多数数据库一起使用。它是一个只读工具，因此非常适合安全报告，但如果您希望用户更改数据，则需要将其与其他工具结合使用。

您可以在 Tableau 中定义一个连接，为不理解外键等的用户设置关系。当然，或者制作隐藏这些细节的视图，无论您选择哪种工具。

# asp.net - 页面刷新时的GridView

> ID：14034736
> 
> 赞同：0
> 
> 时间：2012-12-25T23:37:14.130
> 
> 标签：asp.net, gridview, sqldatasource

我有一个`GridView`和`Button`一个网络表单。
我改变`SelectCommand`了`SqlDataSource`用户单击按钮的时间。
然后结果已显示在 GridView 中。但是当页面刷新时，结果会发生变化。例如当用户想要更改 GridView 的页面时。
为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T12:00:54.270

似乎您的数据在每次页面加载时再次绑定到网格。请确保没有在每次页面加载时都设置数据源和数据绑定。

将您的代码放入 (!IsPostBack) 中，如下所示：

```
if(!IsPostBack)
{
Gridview1.DataSource=yourDataSource;
GridView1.DataBind();
} 
```

# javascript - 使用 onclick 的参数动态创建按钮

> ID：14034737
> 
> 赞同：4
> 
> 时间：2012-12-25T23:37:25.987
> 
> 标签：javascript, javascript-events

> **可能重复：**
> [如何将参数传递给事件处理函数并仍然使用“this”引用？](https://stackoverflow.com/questions/9202339/how-to-pass-arguments-to-an-event-handler-function-and-still-use-this-referenc)

我已经做了一些搜索，但我正在努力寻找解决方案，所以如果有人认为这是重复的，我会很感激你说明你输入的内容......似乎我的搜索能力已经休息了一天！：S无论如何：

```
function CreateMe(){

    //....

    var mycell = row.insertCell(-1);
    var myelement3 = document.createmyelement("input");
    myelement3.type = "button";
    myelement3.value = "Delete";
    myelement3.onclick = DeleteMe;
    myelement3.name = "Delete[]";
    mycell.appendChild(myelement3);

    //....

}

function DeleteMe(){
    alert(this);
} 
```

我有一个带有调用*CreateMe*的按钮的表单，该按钮动态创建一个按钮。我所追求的是能够在单击此动态按钮时将参数传递给*DeleteMe函数；*特别是这个：

```
onclick="DeleteMe(this.parentNode.parentNode.rowIndex)" 
```

来自：[http ://www.java2s.com/Code/JavaScript/HTML/Deletingtablerows.htm](http://www.java2s.com/Code/JavaScript/HTML/Deletingtablerows.htm)

我对如何在这里进行有点不知所措，所以如果有人可以伸出援助之手，我将不胜感激。

**编辑**：为了清楚起见，我要问的是如何将参数从动态生成的按钮的 onclick 事件传递给*DeleteMe*函数。显然我无法做到这一点，因为这只会立即评估函数：

```
 myelement3.value = "Delete";
    myelement3.onclick=DeleteMe(this.parentNode.parentNode.rowIndex);
    myelement3.name = "Delete[]"; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T00:17:33.033

你快到了。`.onclick`应该是一个函数，所以你所要做的就是将该函数调用包装到另一个函数中：

```
myelement3.onclick = function() { 
    DeleteMe(this.parentNode.parentNode.rowIndex);
    // or
    // DeleteMe.call(this, this.parentNode.parentNode.rowIndex);
    // to set `this` inside `DeleteMe` to the DOM element as well.
}; 
```

如果浏览器支持[`.bind`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)，你甚至可以这样做：

```
myelement3.onclick = DeleteMe.bind(
    myelement3, 
    myelement3.parentNode.parentNode.rowIndex
); 
```

但这将`myelement3.parentNode.parentNode.rowIndex`在创建时进行评估，而不是在单击元素时进行评估。如果元素改变了它们的位置，这可能会导致问题，在这种情况下，你宁愿选择第一个解决方案。

* * *

或者，由于`this`引用了单击的元素，您可以访问*内部`DeleteMe`*的行索引：

```
function DeleteMe(){
    var index = this.parentNode.parentNode.rowIndex;
}

// ...

myelement3.onclick = DeleteMe; 
```

只要您`DeleteMe`仅作为事件处理程序调用而不是手动调用，这就会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T23:51:39.513

你可以试试这个

```
function DeleteMe(e){
    e = e || window.event;
    var el = e.target || e.srcElement;
    // here el is your button that's been clicked
    alert(el.parentNode.parentNode.rowIndex);
}​ 
```

# mysql - How to remove minute in TIME Data Type in SQL/Rails App

> ID：14034738
> 
> 赞同：0
> 
> 时间：2012-12-25T23:37:27.257
> 
> 标签：mysql, ruby-on-rails, forms, time, simple-form

I've got a form for selecting TIME. I'm using [Simple Form](https://github.com/plataformatec/simple_form) and [Jquery Timepicker](https://github.com/tkrotoff/jquery-timepicker-rails). How do I remove the minute field of the form. So I have two fields for the :mondayopen parameter showing up. One is the hour and the other is the minute. How can I remove the minute.

Here's how it currently looks: ![enter image description here](../Images/a1e82b88a9e1932eb7a5ebc4721ff54d.png)

**My Form**

```
<%= simple_form_for [current_user, @store], :html => {:multipart => true, :class => 'form-horizontal'} do |f| %>
    </br>
    <%= f.input :mondayopen, :label => 'Monday Open Time', :input_html => { :class => 'mondayo' } %>        
    <%= f.button :submit, class: 'btn btn-primary', style: 'margin-left: 40px;'  %><%= link_to 'Your Store', user_store_path(current_user, @store), :class => 'btn btn-inverse edit_store_button_path' %>
<% end %> 
```

```
<script>
    $('.mondayo').timepicker({ 'step': 15 });
    $('.mondayc').timepicker({ 'step': 15 });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T05:38:41.700

If you have `mondayopen` field as `time` type field SimpleForm creates `time_select` for you but you don't need it as you are using jquery timepicker plugin. So you can just redefine it like this:

```
<%= f.input :mondayopen, :as => :string, :label => 'Monday Open Time', :input_html => { :class => 'mondayo' } %> 
```

# regex - R 正则表达式提取文本不立即遵循模式

> ID：14034740
> 
> 赞同：2
> 
> 时间：2012-12-25T23:37:46.073
> 
> 标签：regex, r, gsub

我有一个数据框，其中有一列包含半结构化文本。我正在寻找某些信息，但它们有一个我不知道如何利用的模式。

```
head(events5)
     flight_history_id         date_time_recorded              event
862          280604281 2012-11-13 17:55:58.673-08 Arrival Estimation
5514         280316415 2012-11-12 17:25:08.814-08    Time Adjustment
5527         280315758 2012-11-12 16:10:06.968-08    Time Adjustment
5539         280316495 2012-11-12 15:38:10.099-08    Time Adjustment
5545         280303866 2012-11-13 06:51:45.831-08    Time Adjustment
5558         280303866 2012-11-12 05:50:23.547-08    Time Adjustment
                                                                               data_updated
862                                                     EGA- Based on Distance and Airspeed
5514                        EGD- New=11/13/12 20:20, DGATE- New=A1, EGA- New=11/13/12 21:00
5527         EGD- New=11/13/12 19:05, DGATE- New=A7, EGA- New=11/13/12 20:50, AGATE- New=C5
5539                        EGD- New=11/13/12 06:35, DGATE- New=A1, EGA- New=11/13/12 07:15
5545 AGD- Old=11/13/12 07:40 New=11/13/12 07:38, EGA- Old=11/13/12 10:25 New=11/13/12 10:18
5558         EGD- New=11/13/12 07:45, DGATE- New=11, EGA- New=11/13/12 10:25, AGATE- New=A1 
```

这是输出：

```
structure(list(flight_history_id = c(280604281L, 280316415L, 
280315758L, 280316495L, 280303866L, 280303866L, 280271465L, 280271465L, 
280271465L, 280271465L), date_time_recorded = structure(c(10L, 
4L, 3L, 2L, 7L, 1L, 9L, 8L, 6L, 5L), .Label = c("2012-11-12 05:50:23.547-08", 
"2012-11-12 15:38:10.099-08", "2012-11-12 16:10:06.968-08", "2012-11-12 17:25:08.814-08", 
"2012-11-12 17:58:14.268-08", "2012-11-13 05:16:41.01-08", "2012-11-13 06:51:45.831-08", 
"2012-11-13 07:38:19.593-08", "2012-11-13 07:54:22.588-08", "2012-11-13 17:55:58.673-08"
), class = "factor"), event = structure(c(1L, 2L, 2L, 2L, 2L, 
2L, 2L, 2L, 2L, 2L), .Label = c("Arrival Estimation", "Time Adjustment"
), class = "factor"), data_updated = structure(c(3L, 8L, 7L, 
4L, 2L, 5L, 1L, 10L, 9L, 6L), .Label = c("AGD- New=11/13/12 10:22, EGA- Old=11/13/12 11:20 New=11/13/12 11:09", 
"AGD- Old=11/13/12 07:40 New=11/13/12 07:38, EGA- Old=11/13/12 10:25 New=11/13/12 10:18", 
"EGA- Based on Distance and Airspeed", "EGD- New=11/13/12 06:35, DGATE- New=A1, EGA- New=11/13/12 07:15", 
"EGD- New=11/13/12 07:45, DGATE- New=11, EGA- New=11/13/12 10:25, AGATE- New=A1", 
"EGD- New=11/13/12 08:55, EGA- New=11/13/12 09:45, AGATE- New=A1", 
"EGD- New=11/13/12 19:05, DGATE- New=A7, EGA- New=11/13/12 20:50, AGATE- New=C5", 
"EGD- New=11/13/12 20:20, DGATE- New=A1, EGA- New=11/13/12 21:00", 
"EGD- Old=11/13/12 08:55 New=11/13/12 10:05, EGA- Old=11/13/12 09:45 New=11/13/12 10:55", 
"EGD- Old=11/13/12 10:05 New=11/13/12 10:30, EGA- Old=11/13/12 10:55 New=11/13/12 11:20"
), class = "factor")), .Names = c("flight_history_id", "date_time_recorded", 
"event", "data_updated"), row.names = c(862L, 5514L, 5527L, 5539L, 
5545L, 5558L, 5564L, 5566L, 5570L, 5572L), class = "data.frame") 
```

我正在尝试从 column`'New='`开始提取部分的字段部分。问题是有时两者之间有一个“Old=”字段。我查看了使用 stringr::str_split 并将列转换为列表，但仍然有同样的问题。我认为这是一个正则表达式/gsub 问题，但不知道具体如何实现。`'EGA'``'data_updated'`

有什么建议么？

编辑：我希望最终产品是具有 EGA/New 值的向量/列。所以是这样的：

```
NA
11/13/12 21:00
11/13/12 20:50
11/13/12 07:15
11/13/12 10:18
11/13/12 10:25 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T23:42:36.323

那个怎么样？

```
EGA-\s*(?:Old=\d{2}\/\d{2}\/\d{2}\s+\d{2}:\d{2}\s*)?New=(\d{2}\/\d{2}\/\d{2}\s+\d{2}:\d{2}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-25T23:44:10.647

`EGA`这是一个替代方法，与@Pharaoh 的正则表达式相比，在-tag之后使用无限量的文本

```
/EGA-(?:(?!New=|").)+(New=[:\d\/ ]+)/g 
```

如果`"`否定前瞻中的 太笼统，您可以将其更改为`EGD`.

演示+说明： [http ://regex101.com/r/qY4uA0](http://regex101.com/r/qY4uA0)

如果不需要，请删除标志和分隔符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T06:19:26.837

与@BlueMagister 的概念类似，但没有那么多嵌套：

```
gsub(".*EGA-.*New=([0-9/]{8} [0-9:]{5}).*|.*EGA.*", "\\1", events5$data_updated)
# [1] ""               "11/13/12 21:00" "11/13/12 20:50" "11/13/12 07:15"
# [5] "11/13/12 10:18" "11/13/12 10:25" "11/13/12 11:09" "11/13/12 11:20"
# [9] "11/13/12 10:55" "11/13/12 09:45" 
```

基本上，第一部分`gsub`说寻找“EGA-”，它不一定出现在字符串的开头，并在遇到“New =”时开始捕获。捕获模式`([0-9/]{8} [0-9:]{5})`表示您首先需要一个带有数字和斜线的 8 个字符长的字符串，然后是一个空格，然后是一个带有数字和冒号的 5 个字符长的字符串。然后这个`|`字符用来表示在它之前或之后寻找 EGA。

要向您添加新信息，您`data.frame`可以使用以下内容：

```
within(events5, {
  EGA.New <- gsub(".*EGA-.*New=([0-9/]{8} [0-9:]{5}).*|.*EGA-.*", 
                  "\\1", events5$data_updated)
}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-26T03:32:18.947

这是一个从头到尾的解决方案：

```
##formats of the date-times
date.format <- "\\d{2}/\\d{2}/\\d{2} \\d{2}:\\d{2}"
##puts this together into a regex
regex.string <- paste0("EGA- (?:Old=",date.format," )?New=(",date.format,")")

##if pattern matches, get the part of "new" we are looking for
##otherwise NA
ifelse(grepl(regex.string,events5$data_updated),
  gsub(paste0("^.*",regex.string,".*$"),"\\1",events5$data_updated),
  NA_character_) 
```

# xml - VBNet 中的 XML 解析

> ID：14034745
> 
> 赞同：5
> 
> 时间：2012-12-25T23:39:42.003
> 
> 标签：xml, vb.net, xml-parsing

我正在尝试使用 VB.NET`<itemnote>`根据子元素的`name`属性`<series>`和属性从中提取内部文本。我可以提取名称属性，但我无法访问的内部文本`name``<item>``<itemnote>`

这是一些示例 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<Products>
  <series name="HiTech" year="2000" country="United Kingdom">
    <item name="Robotic" collected="no">
    <itemnote>Exclusive UK Release</itemnote>
    </item>
     <item name="Future" collected="yes">
    <itemnote>LED Edition</itemnote>
    </item>
  </series>
  <series name="Neo" year="2003" country="United Kingdom">
    <item name="X Rated" collected="no">
    <itemnote>Red striped version</itemnote>
    </item>
     <item name="Cool Breeze" collected="no">
    <itemnote>Includes promo booklet</itemnote>
    </item>
  </series>
</Products> 
```

到目前为止，我已经尝试使用带有 XDocument 的递归循环，但除了所有`<series>`和`<item>`属性的列表之外，我无法获得任何东西。我也尝试过使用 XPath 和 Linq，但我不知道如何让其中任何一个都按照我的意愿进行。任何帮助都会很棒！干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T05:47:29.930

您需要获取`<item>`节点的引用并基于`item`元素，您可以比较`parent`和`child`元素的名称属性值。

```
Dim nameOfSeries = "HiTech"
Dim nameOfItem = "Future"

Dim result = doc.Descendants("item").Where(Function(p)
                               Return p.Parent.Attribute("name").Value = nameOfSeries And 
                                                p.Attribute("name").Value = nameOfItem
                               End Function)

IF result.Count Then
  For Each ele In result
    Console.WriteLine(ele.Element("itemnote").Value)
  Next
End If 
```

# sql - sql中的指数衰减

> ID：14034750
> 
> 赞同：4
> 
> 时间：2012-12-25T23:40:40.297
> 
> 标签：sql, tsql

考虑下表：

```
Person | 1/1/13 | 1/2/13  | 1/3/13 | 1/4/13 | 1/5/13
Bill   | 4      | 2       | 1      | .5     | .25
Jane   | 0      | 0       | 2      | 1      | .5
Mary   | 0      | 8       | 4      | 2      | 1
-------------------------------------------------
Total  | 4      | 10      | 7      | 3.5    | 1.75 
```

这来自下表：

```
Bill | 1/1/13 | 4
Jane | 1/3/13 | 2
Mary | 1/2/13 | 8 
```

基本上，我们知道第一天，然后我们假设该值每隔一天减少一半。我想从第一个表中获取“总”行。

有没有办法在（T-）SQL中做到这一点？我已经在 R 中做到了，但我完全不知道如何在 SQL 中做到这一点。（日期是实际日期，而不仅仅是星期几。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T00:54:28.960

```
with dow as (
     select 'Monday' as dow, 1 as num union all
     select 'Tuesday', 2 union all
     select 'Wedneday', 3 union all
     select 'Thursday', 4 union all
     select 'Friday', 5 union all
     select 'Saturday', 6 union all
     select 'Sunday', 7
    )
select dow.dow,
       t.num * power(cast(0.5 as float), dow.dow - t.dow))
from (select t.*, dow.dow as dow
      from t join
           dow
           on t.dow = dow.dow
     ) t join
     dow
     on t.dow >= dow.dow
group by t.name, dow.dow 
```

This gets the data in a normalized format . . . , , .

If you really need it pivoted (that is, going across in columns), you can use the `pivot` keyword, or do conditional aggregation sums.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T00:52:02.420

如果您的表格如下所示：

```
CREATE TABLE t (person VARCHAR(7), day_of_week_name VARCHAR(7), value NUMERIC);
INSERT INTO t VALUES ('Bill', 'Monday', 4);
INSERT INTO t values ('Jane', 'Weds', 2);
INSERT INTO t VALUES ('Mary', 'Tuesday', 8); 
```

并且您有某种`day_of_week`表格，其中包含天的相对位置：

```
CREATE TABLE day_of_week (name VARCHAR(7), position INT);
INSERT INTO day_of_week VALUES ('Monday', 1);
INSERT INTO day_of_week values ('Tuesday', 2);
INSERT INTO day_of_week VALUES ('Weds', 3);
INSERT INTO day_of_week VALUES ('Thurs', 4);
INSERT INTO day_of_week VALUES ('Friday', 5); 
```

那么用 a 来做这件事并不*太难*`PIVOT`看：

```
SELECT Monday, Tuesday, Weds, Thurs, Friday
  FROM ( SELECT dow2.name AS day_of_week_name,
                t.value / power(2, dow2.position - dow1.position) AS decayed_value
           FROM t
           JOIN day_of_week AS dow1
             ON t.day_of_week_name = dow1.name
           JOIN day_of_week AS dow2
             ON dow1.position <= dow2.position
       ) AS b
 PIVOT ( SUM(decayed_value)
           FOR day_of_week_name
             IN (Monday, Tuesday, Weds, Thurs, Friday)
       ) AS pvt
; 
```

（[这里是 SQL 小提琴。](http://sqlfiddle.com/#!6/a7e39/6)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T00:44:54.123

我创造了一个怪物，但它有效。

它是 mysql，但我确信它很容易转换为 tsql

```
select sum(mon)
     , sum(tue)
     , sum(wed)
     , sum(thur)
     , sum(fri)
  from (
            select person
                 , if (1 < field(day, 'mon', 'tue', 'wed', 'thur', 'fri'), 0, val / pow(2, 1 - field(day, 'mon', 'tue', 'wed', 'thur', 'fri'))) as mon
                 , if (2 < field(day, 'mon', 'tue', 'wed', 'thur', 'fri'), 0, val / pow(2, 2 - field(day, 'mon', 'tue', 'wed', 'thur', 'fri'))) as tue
                 , if (3 < field(day, 'mon', 'tue', 'wed', 'thur', 'fri'), 0, val / pow(2, 3 - field(day, 'mon', 'tue', 'wed', 'thur', 'fri'))) as wed
                 , if (4 < field(day, 'mon', 'tue', 'wed', 'thur', 'fri'), 0, val / pow(2, 4 - field(day, 'mon', 'tue', 'wed', 'thur', 'fri'))) as thur
                 , if (5 < field(day, 'mon', 'tue', 'wed', 'thur', 'fri'), 0, val / pow(2, 5 - field(day, 'mon', 'tue', 'wed', 'thur', 'fri'))) as fri
            from (
                (select 'bill' as person, 'mon' as day, 4 as val from dual)
                union
                (select 'jane', 'wed', 2 from dual)
                union
                (select 'mary', 'tue', 8 from dual)
            ) t

) tbl 
```

[http://sqlfiddle.com/#!2/d41d8/5249](http://sqlfiddle.com/#!2/d41d8/5249)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T00:46:56.737

像这样应该在sql server中工作：

```
with data 
     as (select ppl.name, 
                case 
                  when ppl.day_of_week = 'Monday' then val 
                  when 1 < day_val then 0 
                end monday, 
                case 
                  when ppl.day_of_week = 'Tuesday' then val 
                  when 2 < day_val then 0 
                  else val * Power(Cast(0.5 as FLOAT), ( 2 - day_val )) 
                end Tuesday, 
                case 
                  when ppl.day_of_week = 'Weds' then val 
                  when 3 < day_val then 0 
                  else val * Power(Cast(0.5 as FLOAT), ( 3 - day_val )) 
                end Weds, 
                case 
                  when ppl.day_of_week = 'Thurs' then val 
                  when 4 < day_val then 0 
                  else val * Power(Cast(0.5 as FLOAT), ( 4 - day_val )) 
                end thurs, 
                case 
                  when ppl.day_of_week = 'Friday' then val 
                  when 5 < day_val then 0 
                  else val * Power(Cast(0.5 as FLOAT), ( 5 - day_val )) 
                end friday 
           from (select name, 
                        day_of_week, 
                        val, 
                        case day_of_week 
                          when 'Monday' then 1 
                          when 'Tuesday' then 2 
                          when 'Weds' then 3 
                          when 'Thurs' then 4 
                          when 'Friday' then 5 
                        end day_val 
                   from person) ppl) 
select coalesce(name, 'Total') as "Name", 
       Sum(monday) as "Monday", 
       Sum(tuesday) as "Tuesday", 
       Sum(weds) as "Weds", 
       Sum(thurs) as "Thursday", 
       Sum(friday) as "Friday" 
  from data 
 group by name with rollup 
```

[http://sqlfiddle.com/#!6/c4c6e/1](http://sqlfiddle.com/#!6/c4c6e/1)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-19T21:00:32.240

以下查询假定存在此表变量：

```
DECLARE @data TABLE (
    Person varchar(50),
    Date date,
    Value int
);

INSERT @data VALUES 
('Bill', '2013-01-01', 4),
('Jane', '2013-01-03', 2),
('Mary', '2013-01-02', 8); 
```

这是获取原始衰减数据的递归 CTE 方法：

```
WITH decay AS (
    SELECT Person, Date, CAST(Value as float) AS Value
    FROM @data
    UNION ALL
    SELECT Person, DATEADD(day, 1, Date) AS Date, Value / 2 AS Value
    FROM decay
    WHERE Value / 2 >= 0.25
)
SELECT Person, Date, SUM(Value) AS Value
FROM decay
GROUP BY Person, Date; 
```

我想这可能会解决大多数人的需求，但如果你需要它，你可以指定列的日期：

```
WITH decay AS (
    SELECT Person, Date, CAST(Value as float) AS Value
    FROM @data
    UNION ALL
    SELECT Person, DATEADD(day, 1, Date) AS Date, Value / 2 AS Value
    FROM decay
    WHERE Value / 2 >= 0.25
)
SELECT pvt.Person, 
    ISNULL(pvt.[2013-01-01], 0) AS [2013-01-01], 
    ISNULL(pvt.[2013-01-02], 0) AS [2013-01-02], 
    ISNULL(pvt.[2013-01-03], 0) AS [2013-01-03], 
    ISNULL(pvt.[2013-01-04], 0) AS [2013-01-04], 
    ISNULL(pvt.[2013-01-05], 0) AS [2013-01-05]
FROM (
    SELECT Person, Date, SUM(Value) AS Value
    FROM decay
    GROUP BY Person, Date
) AS q
PIVOT (
    SUM(Value)
    FOR Date
    IN ([2013-01-01], [2013-01-02], [2013-01-03], [2013-01-04], [2013-01-05])
) AS pvt; 
```

这为您提供了结果集：

```
Person  2013-01-01  2013-01-02  2013-01-03  2013-01-04  2013-01-05
------------------------------------------------------------------
Bill    4           2           1           0.5         0.25
Jane    0           0           2           1           0.5
Mary    0           8           4           2           1 
```

不幸的是，PIVOT 要求您指定要旋转的行/列值/名称，因此必须动态生成查询。

# javascript - JavaScript 从文本框文本更改背景图像

> ID：14034755
> 
> 赞同：0
> 
> 时间：2012-12-25T23:42:23.183
> 
> 标签：javascript, css, url, button, input

我正在尝试从我的文本输入字段中获取文本并将其用作背景图像。显然它需要是一个有效的 URL。

到目前为止，这是我的代码...

CSS：

```
body {
  margin: 0px;
  padding: 0px;
  border: 0px;
}

.bgimg {
  background-image:url('http://192.168.0.4/DesktopVersion/Inc/Images/Background/DarkWood.jpg');
} 
```

JavaScript：

```
$("#SetBG").click(function() {
  var URL = document.getElementById("ImageURL").text();
  $(".bgimg").css('background-image',"url(" +URL +")");
}); 
```

HTML：

```
<input type="text" id="ImageURL"></input>
<button id="SetBG">Set Background</button> 
```

希望有人可以帮助我弄清楚为什么这不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T23:46:11.887

输入到`<input>`元素中的值存储为它的`value`属性，而不是它包含的文本节点（这是 jQuery`.text()`函数返回的内容）。

尝试这个：

```
$("#SetBG").click(function() {
    var URL = document.getElementById("ImageURL").value;
    $(".bgimg").css('background-image',"url(" +URL +")");
}); 
```

# apache - 如何正确验证对同一网络中本地主机的访问？

> ID：14034757
> 
> 赞同：0
> 
> 时间：2012-12-25T23:42:35.870
> 
> 标签：apache, authentication

我在我的本地机器上运行了一个 apache 服务器。我可以`http://localhost`从同一网络中的不同设备连接，但我想添加一层身份验证。因此，当用户尝试访问 localhost 时，它必须输入正确的用户名/密码才能继续。无论如何，如果没有 apache 服务器返回的 javascript 或 html 文件中的身份验证代码，是否可以这样做？我是新手，所以我有点困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T23:48:08.643

您可以将 apache 配置为需要身份验证。看看[http://httpd.apache.org/docs/2.4/howto/auth.html](http://httpd.apache.org/docs/2.4/howto/auth.html)

# c++ - C++ 向量迭代器不兼容

> ID：14034760
> 
> 赞同：1
> 
> 时间：2012-12-25T23:42:53.483
> 
> 标签：c++, vector

嗨，我在运行我的程序时遇到问题。这部分代码有异常“向量迭代器不兼容”`backtrack(params, set, results);`

你可以在这个链接上看到完整的代码[http://liveworkspace.org/code/MjgyND](http://liveworkspace.org/code/MjgyND) $7

ps > 在 XCode 中的 MacOS 上一切正常，但在 VS 2012 (Win7) 上我有这个错误..

ps > 在 liveworkspace 上工作正常。可能需要修改编译器设置？

```
int backtrack(btIData params, std::vector<float> set, std::vector<btNode> &results)
{
    if (reject(params, set)) {
        return 0;
    } else {
        accept(params, set, results);
    }

    set = first(params,set);
    while( (set.size() != 0) || reject(params, set)) {
        backtrack(params, set, results);
        set = right(params,set);
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T00:30:38.913

好吧，您是否尝试使用*调试器*？如果有，你发现了什么？如果不是，那么这不完全是一个“为我调试我的代码”网站。

无论如何，如果没有额外的应用领域知识，很难弄清楚你的代码在做什么。而且调试起来非常麻烦，因为您按值传递了很多容器。

然而，一个形式上的错误是相当明显的。您的`right`and`first`函数会将`set`数组（从`backtrack`）增加到大于`params.input`数组大小的大小。例如，如果您的`params.input`数组有大小`5`（如在您的测试代码中），您的`set`数组将增长到 size `6`。

两个函数中的这种情况显然应该限制`set`数组的增长

```
int l = (int) candiates.size(); // `candiates` is `set`
if (l > params.input.size())
  // Don't grow array
else
  // Grow array 
```

但由于某种原因，您使用了严格比较`l > params.input.size()`而不是非严格比较`l >= params.input.size()`。当只有元素时，这正是允许您的`set`数组增长到 size的原因。`6``params.input``5`

然后稍后在您使用索引值从to`getPathSummary`迭代`input`数组`0``sets.size() - 1`

```
float getPathSummary(btIData params, std::vector<float> sets)
{
    float summary = 0;
    for (int i =0; i < sets.size(); i++) {
        summary += params.input[i] * sets[i];
    }

    return summary;
} 
```

这会导致索引超出范围并导致程序崩溃。即您尝试访问`params.input[5]`不存在的 。

越界访问尝试将在标准库的不同调试实现中产生不同的运行时错误。在您的情况下，它恰好与“不兼容的迭代器”有关。

PS 停止按值传递繁重的数据结构。使用参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T00:25:09.313

如果 btNode 类是在另一个 DLL 中定义的，并且模板 std::vector 在该 DLL 中被引用，则根据用于构建代码的标准库的版本和用于构建外部 DLL 的标准库的版本，您可能会遇到不兼容性。

但在你的情况下，一切似乎都存在于同一个文件中

# jquery - 为什么这个 jquery.hide() 函数不能在这个 UL 元素上工作？

> ID：14034763
> 
> 赞同：0
> 
> 时间：2012-12-25T23:43:47.887
> 
> 标签：jquery, css, html-lists

子菜单出现成功，但不会随`mouseleave`功能隐藏。运行 console.log() 会显示一个事件将在鼠标退出的正确时刻触发`<ul>`，但由于某种原因它不会隐藏。但是，我可以更改其他样式（例如将背景更改`<ul>`为红色或其他东西。）非常令人费解...

```
$(document).ready(function() {
    $(".topLine").hover(function() {
        $(".subTopNav").hide(); //hide all potentially open submenus
        $(this).find(".subTopNav").show(); //show this submenu
    });
    $(".subTopNav").mouseleave(function() { //if mouse leaves the submenu
        $(this).hide(); //hide the open submenu (this is what isn't working)
        $(this).css('background-color','red'); //this works
    })
}); 
```

```
<li class="topLine">
<span class="topNavItem">Item 1</span>
<ul class="subTopNav">
    <li><a href="#">subItem 1</a></li>
    <li><a href="#">subItem 2</a></li>
    <li><a href="#">subItem 3</a></li>
</ul>
</li> 
```

```
#topNavItems { display: inline; line-height: 40px; }
#topNavItems li { display: inline; font-weight: bold; margin-right: 45px; cursor: pointer; }
#topNavItems li a { text-decoration: none; color: #000000; }
.topLine { position: relative; }
.subTopNav { display: none; position: absolute; top: 20px; left: 25%; background-color: #000000; width: 145px; color: #FFFFFF; padding-left: 10px; }
.subTopNav li { display: block; color: #CCCCCC; font-weight: normal !important; font-size: 12px; line-height: 24px; margin-right: 0px !important; }
.subTopNav a { color: #CCCCCC !important; display: block; }
.subTopNav a:hover { color: #FFFFFF !important; } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T00:02:56.213

The problem is that `hover()` used with only one argument function will trigger the same function for both `mouseenter` and `mouseleave`

> .hover( mouseenterHandler,mouseleaveHandler)

or

> .hover( singleHandler/* triggers for both events*/)

Change your `hover` to `mouseenter` and code works

DEMO: [http://jsfiddle.net/VhDyA/](http://jsfiddle.net/VhDyA/)

API refrence: [http://api.jquery.com/hover/](http://api.jquery.com/hover/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T23:55:37.667

你为什么不试试 $(".subTopNav li").hide(); ? 您正在隐藏 ul，但带有“显示：块”的 li 项目保持不变。我会试试的。。

# performance - 水库采样与获取列表长度并选择随机元素的性能

> ID：14034764
> 
> 赞同：4
> 
> 时间：2012-12-25T23:43:49.883
> 
> 标签：performance, haskell, criterion

我编写了两个函数来从未知长度的列表中选择一个随机元素。第一个使用水库采样（水库大小为 1），第二个获取列表的长度以选择一个随机索引并返回它。出于某种原因，前者要快得多。

第一个函数使用单次遍历并以概率 (1/i) 选取每个元素，其中 i 是列表中元素的索引。它导致选择每个元素的概率相等。

```
pickRandom :: [a] -> IO a
pickRandom [] = error "List is empty"
pickRandom (x:xs) = do
  stdgen <- newStdGen
  return (pickRandom' xs x 1 stdgen)

-- Pick a random number using reservoir sampling
pickRandom' :: (RandomGen g) => [a] -> a -> Int -> g -> a
pickRandom' [] xi _ _ = xi
pickRandom' (x:xs) xi n gen =
  let (rand, gen') = randomR (0, n) gen in
  if (rand == 0) then
    pickRandom' xs x (n + 1) gen' -- Update value
  else
    pickRandom' xs xi (n + 1) gen' -- Keep previous value 
```

第二个版本遍历列表一次以获得它的长度，然后选择一个介于 0 和输入列表长度 (-1) 之间的索引来获得元素之一，再次以相等的概率。列表1.5的预期遍历次数：

```
-- Traverses the list twice
pickRandomWithLen :: [a] -> IO a
pickRandomWithLen [] = error "List is empty"
pickRandomWithLen xs = do
  gen <- newStdGen
  (e, _) <- return $ randomR (0, (length xs) - 1) gen
  return $ xs !! e 
```

这是我用于对这两个函数进行基准测试的代码：

```
main :: IO ()
main = do
  gen <- newStdGen
  let size = 2097152
      inputList = getRandList gen size
  defaultMain [ bench "Using length" (pickRandomWithLen inputList)
              , bench "Using reservoir" (pickRandom inputList)
              ] 
```

这是一个剥离的输出：

```
benchmarking Using reservoir
mean: 82.72108 ns, lb 82.02459 ns, ub 83.61931 ns, ci 0.950

benchmarking Using length
mean: 17.12571 ms, lb 16.97026 ms, ub 17.37352 ms, ci 0.950 
```

换句话说，第一个函数比第二个函数快大约 200 倍。我预计运行时间主要受随机数生成和列表遍历次数（1 vs. 1.5）的影响。还有什么其他因素可以解释如此巨大的差异？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-26T00:30:36.683

您的基准操作实际上并未评估结果，

```
pickRandom :: [a] -> IO a
pickRandom [] = error "List is empty"
pickRandom (x:xs) = do
  stdgen <- newStdGen
  return (pickRandom' xs x 1 stdgen) 
```

只得到一个新的`StdGen`并返回一个 thunk。这很直接。

```
pickRandomWithLen :: [a] -> IO a
pickRandomWithLen [] = error "List is empty"
pickRandomWithLen xs = do
  gen <- newStdGen
  (e, _) <- return $ randomR (0, (length xs) - 1) gen
  return $ xs !! e 
```

计算列表的长度，然后返回一个 thunk，这当然要慢得多。

迫使双方评估结果，

```
return $! ... 
```

使`length`使用版本**更快**，

```
benchmarking Using length
mean: 14.65655 ms, lb 14.14580 ms, ub 15.16942 ms, ci 0.950
std dev: 2.631668 ms, lb 2.378186 ms, ub 2.937339 ms, ci 0.950
variance introduced by outliers: 92.581%
variance is severely inflated by outliers

benchmarking Using reservoir
collecting 100 samples, 1 iterations each, in estimated 47.00930 s
mean: 451.5571 ms, lb 448.4355 ms, ub 455.7812 ms, ci 0.950
std dev: 18.50427 ms, lb 14.45557 ms, ub 24.74350 ms, ci 0.950
found 4 outliers among 100 samples (4.0%)
  2 (2.0%) high mild
  2 (2.0%) high severe
variance introduced by outliers: 38.511%
variance is moderately inflated by outliers 
```

（在通过打印其总和来强制对输入列表进行评估之后），因为这只需要一次调用 PRNG，而水库采样使用`length list - 1`调用。

如果使用比 a 更快的 PRNG，差异可能会更小`StdGen`。

实际上，使用[`System.Random.Mersenne`](http://hackage.haskell.org/packages/archive/mersenne-random/1.0.0.1/doc/html/System-Random-Mersenne.html)而不是`StdGen`( 需要`pickRandom'`具有`IO a`结果类型，并且由于它不提供特定范围内的生成，但仅默认范围会稍微偏斜拾取元素的分布，但是因为我们只对伪所需的时间感兴趣-随机数生成，这并不重要），水库采样的时间下降到

```
mean: 51.83185 ms, lb 51.77620 ms, ub 51.91259 ms, ci 0.950
std dev: 482.4712 us, lb 368.4433 us, ub 649.1758 us, ci 0.950 
```

（`pickRandomWithLen`当然，时间不会发生可测量的变化，因为它只使用了一代）。大约九倍的加速，这表明伪随机生成是主导因素。

# html - 是否可以将 div 与“绝对”父级居中？

> ID：14034769
> 
> 赞同：7
> 
> 时间：2012-12-25T23:44:25.280
> 
> 标签：html, css

```
<style type="text/css">
.square {
    width:251px;
    height:207px; 
    border: 1px solid #d6d6d6;
    -webkit-box-shadow: 1px 1px 3px rgba(0,0,0,.1);
    -moz-box-shadow: 1px 1px 3px rgba(0,0,0,.1);
    box-shadow: 1px 1px 3px rgba(0,0,0,.1);
    margin: 10px;
    overflow: hidden;
    position: relative;
    background-color:#fff;
    /*display: inline-block;*/
    float: left;
    cursor: pointer;
    text-align: left;
}
.square img {
    display: block;
    margin: 0px;
    padding: 9px;
    width:234px !important;
    height:190px !important;
    position:absolute;
}
.square .caption {
    width:214px;
    height:170px;
    background:#000;
    color:#fff;
    padding:10px;
    position:absolute;
    left:9px;
    top:9px;
    /*display:none;*/
    filter:alpha(opacity=80);
    -moz-opacity:0.8;
    -khtml-opacity: 0.8;  
    opacity: 0.8;
}
.square .text{
    border:1px dotted #d6d6d6;
    margin: 10px;
    padding: 5px;
    vertical-align: center;
    max-height: 100px;
    overflow: auto;
}
.square .until {
    font-size: 12px;
    font-style: italic;
    position: absolute;
    right: 10px;
    bottom: 5px;
}
</style>

<div class="square">
    <a href="/" >
        <img width="234" height="190" src="files/2011/12/17.jpg"  alt="17" title="17"/>
    </a>
    <a href="/" rel="bookmark">
        <div class="caption">
            <h2>Half A Beatle</h2>
            <div class="text">lol</div>
            <div class="until">Until: 01 01 2012</div>
        </div>
    </a>
</div> 
```

![图片](../Images/2040b385c9c8980543735199fe69789b.png)

那么在当前情况下是否可以将 div 居中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T00:15:56.477

单独使用 CSS 完全有可能，尽管您需要进行一些在 IE6 / 7 中不起作用的有趣更改。

如果您的父容器设置为`display: table-cell`并且`vertical-align: middle`子元素设置为`display: inline-block`，您将获得内容居中居中的表格效果。

[你自己看！](http://jsfiddle.net/Yh7Fn/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-22T09:39:45.453

有点晚了，但这是我的答案......诀窍是除了我们的文本容器 div 之外还有一个辅助 div，如下面的代码......我希望这会有所帮助：D

```
<div style=" position: absolute;
             display: inline-block;
             top: 20%;
             bottom: 20%;
             right: 20%;
             left: 20%;
             background-color: #434154;
             text-align: center;">
    <div style="display: inline-block;
                height: 100%;
                vertical-align: middle;"></div>
    <div style="position: relative;
                color: #FFFFFF;
                background-color: #546354;
                display: inline-block;
                vertical-align: middle;">
               THIS IS CENTERED WITHOUT SCRIPTING :D
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-25T23:52:35.277

如果您知道要居中的 div 的高度（我假设它是 .text），那么您可以执行以下操作：

```
.square .text {
    height: 100px;
    top: 50%;
    margin-top: -50px; /* This should be half of height */
} 
```

如果将 div 的顶部放置在父容器的 50% 处，所有这一切都会发生。margin-top 将其向上推，因此中心位于父级的中心。

**编辑：**使用变换显示示例：

```
.square .text{
    border:1px dotted #d6d6d6;
    margin: 0 10px;
    padding: 5px;
    vertical-align: center;
    max-height: 100px;
    overflow: auto;
    position: absolute;
    left: 0;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    -webkit-transform: translateY(-50%);
} 
```

不过，这不适用于不支持转换的浏览器。看到这个[http://jsfiddle.net/WEQVK/](http://jsfiddle.net/WEQVK/)

# android - 在 SimpleCursorAdapter 上使用 notifyDataSetChanged 不起作用

> ID：14034770
> 
> 赞同：2
> 
> 时间：2012-12-25T23:44:28.713
> 
> 标签：android, listview, simplecursoradapter, baseadapter

在我的代码中，现在，为了正确刷新列表视图，我必须重新获取我的数据库信息并重新创建`SimpleCursorAdapter`.

例如，我在列表视图中有一个按钮。单击此按钮时，它会从数据库中删除列表视图项的条目。所以我想要做的就是从列表视图中删除该项目，而不必重新创建适配器。

我尝试将我的全局从更改`SimpleCursorAdapter`为`BaseAdapater`（因为它扩展`SimpleCursorAdapater`并允许使用该`notifyDataSetChanged()`函数），但它仍然不起作用。

这是我现在使用的代码（确实有效）：

声明代码`global`和`onCreate()`：

```
private RoutinesDataSource datasource;
private SimpleCursorAdapter dataAdapter;
private boolean isEditing = false;
private Toast toast_deleted;
private String[] columns = new String[] { MySQLiteHelper.COLUMN_NAME };
private int[] to;

@SuppressLint("ShowToast")
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_routines);

    toast_deleted = Toast.makeText(this, "", Toast.LENGTH_SHORT);
    datasource = new RoutinesDataSource(this);
    datasource.open();

    Cursor cursor = datasource.fetchAllRoutines();
    to = new int[] { R.id.listitem_routine_name };
    dataAdapter = new SimpleCursorAdapter(this, R.layout.listitem_routine, cursor, columns, to, 0);
    setListAdapter(dataAdapter);
} 
```

列表视图项中删除按钮的代码：

```
public void onClick(View view) {        
    ListView l = getListView();
    int position = l.getPositionForView(view);

    Cursor cursor = ((SimpleCursorAdapter)l.getAdapter()).getCursor();
    cursor.moveToPosition(position);
    long id = cursor.getLong(cursor.getColumnIndex(MySQLiteHelper.COLUMN_ID));
    String name = cursor.getString(cursor.getColumnIndex(MySQLiteHelper.COLUMN_NAME));

    switch (view.getId()) { 

        case R.id.button_routine_delete:
            toast_deleted.setText(getString(R.string.toast_routine_deleted));
            toast_deleted.show();
            datasource.deleteRoutine(id);
            onResume();
            break;
    }
} 
```

记下我使用`onResume()`.

我知道这很`datasource.deleteRoutine(id)`有效，因为当我关闭活动并重新打开它时，列表项就消失了。

onResume() 的代码正确显示列表并删除了 listview 项：

```
@Override
protected void onResume() {
    datasource.open();
    Cursor cursor = datasource.fetchAllRoutines();

    if (isEditing) {
        to = new int[] { R.id.listitem_routine_edit_name };
        dataAdapter = new SimpleCursorAdapter(this, R.layout.listitem_routine_edit, cursor, columns, to, 0);
        setListAdapter(dataAdapter);
    }
    else {
        to = new int[] { R.id.listitem_routine_name };
        dataAdapter = new SimpleCursorAdapter(this, R.layout.listitem_routine, cursor, columns, to, 0);
        setListAdapter(dataAdapter);
    }

    super.onResume();
} 
```

我只是认为每次我只想删除已从数据库中删除的列表项时重新创建适配器是不好的做法。就像我说的那样，我已经尝试使用 BaseAdapter 进行 notifyDataSetChanged ，但它根本不起作用。

还要注意`isEditing`布尔值。如果在显示删除按钮的操作栏中单击编辑按钮，则将其设置为 true。这很有用，因为我还有一个编辑按钮，单击该按钮会启动一个活动，因此当他们完成编辑后返回时，它仍会为用户显示按钮。

所以无论如何，有人可以指出我如何刷新列表而不必重新创建适配器 - 或者我所做的最好的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T00:08:51.897

mango 对他的决议的评论中的 URL 运行良好。

我只是把里面的代码改成`onResume()`这样：

```
 datasource.open();
    Cursor cursor = datasource.fetchAllRoutines();
    dataAdapter.changeCursor(cursor);

    super.onResume(); 
```

由于`onResume()`在有人添加或编辑项目后已经调用它，我认为在按下删除按钮时调用它不会有什么坏处，因为它不再重新创建适配器，而是简单地更改光标。

# unix - Unix删除具有特定名称的目录中的所有文件夹

> ID：14034771
> 
> 赞同：4
> 
> 时间：2012-12-25T23:44:31.427
> 
> 标签：unix, find, rm

嗨，我的一张磁盘上有很多名为“@eaDir”的文件夹，我想搜索，找到所有文件夹并删除它们及其内容。

我知道这可能是 find 和 rm 命令的组合，但我无法弄清楚它们。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T23:47:21.900

尝试这个：

```
find . -type d -name '@eaDir' -print0 | xargs -rt0 rm -rv 
```

这是同样的事情，但使用明确的长选项`xargs`：

```
find . -type d -name '@eaDir' -print0 | xargs --no-run-if-empty --verbose --null rm -rv 
```

（如果您正在编写需要由其他人维护/审查的脚本，使用长选项总是一个好主意）

但在此之前：

```
man find
man xargs 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T23:47:43.973

```
find /path/to/the/disk -type d -name "@eaDir" -delete 
```

请注意，这里的顺序是基本的：引用手册页，

> 警告：不要忘记 find 命令行被评估为表达式，因此将 -delete 放在首位将使 find 尝试删除您指定的起点以下的所有内容。

因此，*与往常一样*，首先尝试使用 .`find`命令`-print`，然后，当您检查一切正常时，将其替换为`-delete`. 请注意，这`-delete`意味着`-depth`，因此，要对 进行有意义的测试`-print`，您应该在表达式中明确指定它：

> 在测试稍后打算与 -delete 一起使用的 find 命令行时，应显式指定 -depth 以避免以后出现意外。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-14T19:06:12.400

转到根文件夹或目录并执行以下命令：

```
find . -path '*/@eaDir/*' -delete -print && find . -path '*/@eaDir' -delete -print 
```

这应该适合你。

# c# - 消除数据库中的重复项

> ID：14034773
> 
> 赞同：2
> 
> 时间：2012-12-25T23:45:06.973
> 
> 标签：c#, ms-access, oledb

我有以下代码用于从文件中读取并填充我的数据库。一切正常，只是所有记录都插入了两次。

```
OleDbCommand c = new OleDbCommand();
c.Connection = GetConnection();
c.CommandText =
    @"CREATE TABLE patients (
        patientid AUTOINCREMENT PRIMARY KEY,
        firstlastname CHAR(50),
        birthdate CHAR(50),
        birthplace CHAR(50),
        gender CHAR(1),
        bloodtype CHAR(50),
        telnum CHAR(50),
        address CHAR(255)
    )";
c.ExecuteNonQuery();

string info = "";
string name = "";
string date = "";
string place = "";
string blood = "";
string num = "";
string address = "";
//Read from file and insert values to patient table
StreamReader myReader = new StreamReader("myPath/patient.txt");
while (true)
{
    info = myReader.ReadLine();
    if (info == null) break;

    if (info.Trim() != String.Empty)
    {
        string[] words = info.Split(',');
        if (words.Length == 6)
        {
            name = words[0].Trim();
            date = words[1].Trim();
            place = words[2];
            blood = words[3];
            num = words[4];
            address = words[5];
        }
    }

    string cmdText = "INSERT INTO patients (" +
      "firstlastname, birthdate, birthplace, bloodtype, telnum, address) " +
      "VALUES (?,?,?,?,?,?)";

    using (OleDbConnection cn = GetConnection())
    {

        using (OleDbCommand cmd = new OleDbCommand(cmdText, cn))
        {
            cmd.Parameters.AddWithValue("name", name);
            cmd.Parameters.AddWithValue("date", date);
            cmd.Parameters.AddWithValue("place", place);
            cmd.Parameters.AddWithValue("blood", blood);
            cmd.Parameters.AddWithValue("num", num);
            cmd.Parameters.AddWithValue("address", address);
            cmd.ExecuteNonQuery();
        }
    }

} 
```

我注意到这条线 `if (info.Trim() != String.Empty)`

每隔一次返回“false”，因此记录被插入两次，但不知道如何解决这个问题。

我怎样才能消除这些重复？谢谢

编辑：文件内容如显示姓名、日期、城市、血型、手机号码和地址：

Mehtap Selim, 11/06/1985, Kyrenia, FBRh+, 05617584509, Yasemin St. No:48 Edremit Kyrenia KKTC

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T23:54:41.607

看起来你的代码结构仍然允许写入你的数据库，即使条件语句是假的，并且由于数据仍然在你之前写入的变量中，它会再次写入它们。尝试将数据库写入包含在相同的条件中。至于为什么每隔一段时间就会出现错误，我们需要查看文件的内容。

IE

```
if (info.Trim() != String.Empty)
{
    string[] words = info.Split(',');
    if (words.Length == 6)
    {
        name = words[0].Trim();
        date = words[1].Trim();
        place = words[2];
        blood = words[3];
        num = words[4];
        address = words[5];
    }

    string cmdText = "INSERT INTO patients (" +
       "firstlastname, birthdate, birthplace, bloodtype, telnum, address) " +
       "VALUES (?,?,?,?,?,?)";

    using (OleDbConnection cn = GetConnection())
    {
        using (OleDbCommand cmd = new OleDbCommand(cmdText, cn))
        {
            cmd.Parameters.AddWithValue("name", name);
            cmd.Parameters.AddWithValue("date", date);
            cmd.Parameters.AddWithValue("place", place);
            cmd.Parameters.AddWithValue("blood", blood);
            cmd.Parameters.AddWithValue("num", num);
            cmd.Parameters.AddWithValue("address", address);
            cmd.ExecuteNonQuery();
        }
    }
} 
```

# c# - Windows RT：捕捉模式将 GridView 更改为 ListView

> ID：14034775
> 
> 赞同：1
> 
> 时间：2012-12-25T23:45:20.240
> 
> 标签：c#, xaml, listview, gridview, windows-runtime

当我的应用程序被捕捉时，显示 a`GridView`并不是呈现信息的最佳方式。我想用 a`ListView`来代替它。我也想更改项目模板。

我目前有一个`UserControl`接受`DataContext`作为项目模板的，所以我可以简单地创建一个新视图并使用它，它应该可以工作。所以我基本上是想`local:NormalDetailView`换`local:SnappedDetailView`

最初我想同时在其中同时拥有 ListView 和 GridView 并根据捕捉模式调整可见性。但我对这项技术的性能表示怀疑。

最后，这是一个`LayoutAwarePage`，所以我在底部确实有所有 XAML 内容`VisualStateManager.VisualStateGroups`等。

```
 <GridView x:Name="GalleryGridView"ItemsSource="{Binding ListOfItems}">
        <GridView.ItemTemplate>
            <DataTemplate>
                <local:NormalDetailView VerticalAlignment="Center" Width="250" Height="250"  DataContext="{Binding}"/>
            </DataTemplate>
        </GridView.ItemTemplate>
    </GridView> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T01:38:36.590

如果您同时使用网格视图和列表视图，并根据视图状态调整可见性，则性能会很好。这正是 Visual Studio 中的“拆分应用程序”模板所做的。

只需基于此模板生成一个应用程序并查看 ItemsPage.xaml 和 ItemsPage.xaml.cs。其他模板也可以这样做，但我没有使用它们，所以我不确定。

# c# - 如何计算 Rayintersection 3D 以进行拾取

> ID：14034776
> 
> 赞同：1
> 
> 时间：2012-12-25T23:45:22.217
> 
> 标签：c#, math, opengl, opentk

我正在努力实现一个基本上告诉我的函数，如果光线“足够接近”一个对象

基本上我实现了[实现光线拾取](https://stackoverflow.com/questions/2093096/implementing-ray-picking) @nornagon 独奏来创建光线。我在屏幕上的对象以一个点为中心。我假设如果光线在该点的一定距离内，则选择该对象。

我称这 3 个点（X、Y、Z）：_pickFrom、_pickTo 和 pO

首先，这是我根据屏幕上的鼠标位置计算射线的方法：

```
 public static void Pick(int x, int y)
    {
        float nx = 2.0f * ((float)x) / ((float)_width) - 1.0f;

        float ny = 1.0f - 2.0f * ((float)y) / ((float)_height);

        Matrix4 unview = Matrix4.Invert(Matrix4.Mult(_projectionMatrix, _modelviewMatrix));

        Vector4 nearPoint = Vector4.Transform(new Vector4(nx, ny, 0, 1), unview);

        _pickTo = nearPoint - _pickFrom;
    } 
```

_pickFrom 是相机在场景中的位置。_pickTo 是pickray 的方向。_width 和 _height 是渲染上下文的大小。

我现在将如何实现一个函数，让我知道一个点到pickray的距离？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T14:49:06.413

我现在自己想通了：

```
public void SetMouse(int x, int y)
{
    float xpos = 2.0f * ((float)x / (float)_width) - 1.0f;
    float ypos = 2.0f* (1.0f - (float)y / (float)_height) - 1.0f;

    Vector4 startRay = new Vector4(xpos, ypos, -1, 1);
    Vector4 endRay = new Vector4(xpos, ypos, 1, 1);

    Matrix4 trans = _modelView.Data * _projection.Data;
    trans.Invert();
    startRay = Vector4.Transform(startRay, trans);
    endRay = Vector4.Transform(endRay, trans);

    _pickFrom = startRay.Xyz / startRay.W;
    _pickTo = endRay.Xyz / endRay.W;
} 
```

……

```
public float Distance(Vector3 p)
{
    Vector3 x1 = _pickFrom;
    Vector3 x2 = _pickTo;

    return Vector3.Cross
    (Vector3.Subtract(p, x1), 
     Vector3.Subtract(p, x2)
    ).Length / Vector3.Subtract(x2, x1).Length;
} 
```

# performance - 在OpenGL中修改缓冲区

> ID：14034777
> 
> 赞同：1
> 
> 时间：2012-12-25T23:45:32.700
> 
> 标签：performance, opengl, buffer, vbo

我有一个可修改的地形，它存储在顶点缓冲区中。由于它的顶点数量很多，我不想每次修改地形时都重新上传所有顶点。我现在要做的是将地形分割成更小的块，这样我只需要重新创建包含地形修改的区域的缓冲区。

但是我怎样才能添加或删除现有缓冲区的一些顶点呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T08:46:00.283

您可以`glBufferSubData`像 datenwolf 所说的那样使用，或者如果您计划进行大量修改并随机访问数据，您可能希望使用将缓冲区映射到客户端内存，然后`glMapBuffer`再取消映射`glUnmapBuffer.`（然后，根据您的访问说明符选择，您可以将数据编辑为 C 数组）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T00:06:03.137

You can change data in an existing buffer using `glBufferSubData`

# c# - 如何在 ASP.Net 和 C# 中从数据库中获取和显示图像

> ID：14034779
> 
> 赞同：4
> 
> 时间：2012-12-25T23:45:35.913
> 
> 标签：c#, asp.net, image

有很多关于使用**FileUpload**控制器在数据库表中插入图像的好教程。

然而，我找不到关于如何获取这些图像并显示它们的好教程。

当我以前将图像名称或路径存储在数据库中（作为 Varchar）时，这样做会非常简单......

**HTML/ASP：**

```
<img src="" runat="server" id="myImage" /> 
```

**C＃：**

```
myImage.Src = myReader.getValue(0).toString(); 
```

**结果：**

```
<img src="/Images/pic.png" runat="server" id="myImage" /> 
```

瞧，图片将显示出来。

但是现在我想获取上传的图片，而不是路径，这意味着表格列的类型是 IMAGE。

有些教程最终会导致全屏显示图片。

我不希望这样，我只是想以与上一个示例中显示的方式相同的方式获取和显示图像，并在我的网页中具有给定的大小和位置。

为什么我要将图像上传到数据库？因为这些图片是“个人资料图片”，而不是公共图片，所以我不希望客人简单地浏览 /Images/ 来查找我网站的所有图片，无论是公共的还是私人的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T23:53:32.307

首先，要做你想做的事，我只需将文件复制到一个临时位置并将该位置用于“src”属性。稍后，您可以删除该文件。更复杂的方法是创建一个 aspx 页面，将图像作为二进制流写入网页。此页面将从数据库中获取图像，并将流写入响应中。然后，您将在图像的 src 属性中使用此 aspx 页面。但是，将图像路径存储在数据库中并将实际文件存储在文件系统上并不意味着该文件夹必须是可浏览的或公开的。例如，您可以关闭目录浏览。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T00:39:22.313

创建一个`IHttpHandler`可以从数据库中提供图像的自定义实现。例如，您可以将字节放入流中并将该流复制到 Web 响应的输出。

这是一个简单的例子：

```
public class MyImageHandler : IHttpHandler
{
    public bool IsReusable { get { return true; } }

    public void ProcessRequest(HttpContext ctx)
    {
        Stream yourStream = ...; // This is where you get your data from your database
        ctx.Response.ContentType = "image/jpeg";
        yourStream.CopyTo(ctx.Response.OutputStream);
    }
} 
```

然后您需要对其进行配置以响应您希望的 URL。

*   您可以使用 Web.config 文件来执行此操作
*   或者创建一个`.ashx`文件并让它指向你自己的 HTTP 处理程序

如果您对此有任何疑问，请写评论。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-25T23:56:54.220

您将需要一个 aspx 页面，从数据库中读取图像并返回原始字节。

这是如何执行此操作的快速草图：

```
byte[] data = (byte[])myReader.getValue(0);

Response.ContentType = "image/jpeg"; //or whatever your used image type is
Response.OutputStream.Write(data, 0, data.Length);
Response.End(); 
```

另一种方法是为此实现自定义 HttpHandler。

`img`另一部分是使用指定图像 ID 的参数从您的标签“调用”此页面：

```
myImage.Src = "/image.aspx?id=" + myReader.getValue(0).toString(); 
```

# google-chrome - webkit缩放错误缩放问题与字体大小，似乎没有变小

> ID：14034784
> 
> 赞同：1
> 
> 时间：2012-12-25T23:46:57.120
> 
> 标签：google-chrome, safari, webkit

我对 webkit 浏览器 safari 和 chrome 有疑问。当我缩小时，我将一行文本设置为 41 像素，另一种字体设置为大约 12 像素。当我缩小到 33% 和 25% 左右时，设置为 12px 的字体不会变小。实际上它与 41 px 文本的大小几乎相同，因此当我在 webkit 中缩小时，不会变小的文本溢出它们的容器并溢出，将其他文本推出它们的容器等等上。这只发生在 webkit 浏览器中，它在 firefox、ie 和 opera 中完美运行。

我在互联网上寻找任何东西，但我只发现一个网站谈论谷歌浏览器中的字体大小阈值：http: [//dropshado.ws/post/12971305087/webkit-zoomed-out-font-size-threshold](http://dropshado.ws/post/12971305087/webkit-zoomed-out-font-size-threshold)

我找不到针对此问题的 bugzilla 错误。我找到的唯一解决方案是在包含溢出文本的 div 上指定溢出隐藏，它看起来很好，但字体仍然没有正确缩放，只是被切断了。其他人经历过这个吗？

# qt - '&' : 对绑定成员函数表达式的非法操作

> ID：14034791
> 
> 赞同：0
> 
> 时间：2012-12-25T23:48:14.760
> 
> 标签：qt, qlist

刚刚进入 QT，我正在尝试创建一个 LineEdit 文本框数组。

错误：C2276：“&”：对绑定成员函数表达式的非法操作

在以下行：

```
QList<QLineEdit *> leBetList = parentWidget.findChildren<QLineEdit *>("leBet0"); 
```

我有 5 个 QLineEdit 框，分别命名为 leBet0、leBet1 等。

这是其余的代码：

主窗口.cpp

```
#include "mainwindow.h"
#include "ui_mainwindow.h"
#include <QLineEdit>
#include <QList>
#include <QString>

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{

    ui->setupUi(this);
}

MainWindow::~MainWindow()
{

    delete ui;
}

void MainWindow::on_pushButton_clicked()
{
     QString sBetStreet[5];
     int iBetStreet[5];

     QList<QLineEdit *> leBetList = parentWidget.findChildren<QLineEdit *>("leBet0");

    for(int i=0;i<5;i++)
    {
        sBetStreet[i] = ui->leBetList[i]->text();
        iBetStreet[i]=sBetStreet[i].toInt();
    }

    int iBetResult=iBetStreet[0]+iBetStreet[1];
    QString sBetResult;
    sBetResult=QString::number(iBetResult);

    ui->teOutput->setText(sBetResult);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T00:16:34.910

`parentWidget`是一个函数。你需要调用它

```
parentWidget()->findChildren ... 
```

糟糕的编译器的错误消息可能是指它的内部表示，它显然`&`对成员函数名称应用了隐式操作。

# android - 如何将自定义数据传递给 Google Maps v2 InfoWindowAdapter？

> ID：14034792
> 
> 赞同：7
> 
> 时间：2012-12-25T23:48:58.097
> 
> 标签：android, google-maps-android-api-2

我正在尝试利用 InfoWindowAdapter 为 InfoView 提供自定义内容。我正在从我的 Web 服务中提取 JSONArray 并添加标记，但我没有看到如何通过标记将详细信息传递给回调。

```
 @Override
    public View getInfoWindow(Marker marker) 
```

在 Javascript API 中，我可以设置任意标记信息。我希望能够传递可用作自定义内容条件的信息，例如 marker.status 字符串。所以除了标题等之外，视图将需要一些我需要传入的自定义字段。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T01:18:27.997

也许尝试将您的信息或对象添加到标记中，如下所述：http: [//bon-app-etit.blogspot.be/2012/12/add-informationobject-to-marker-in.html](http://bon-app-etit.blogspot.be/2012/12/add-informationobject-to-marker-in.html)

编辑：我还发了一个帖子，继续之前使用 InfoWindowAdapter。看看[这里](http://bon-app-etit.blogspot.be/2012/12/using-infowindowadapter-part-1.html)！

# javascript - UAC下的ShellWindows中搜索

> ID：14034793
> 
> 赞同：2
> 
> 时间：2012-12-25T23:49:04.367
> 
> 标签：javascript, uac, jscript, wsh, hta

我有一个运行 HTA 窗口与用户通信的 JScript 应用程序。它以特定 ID 启动 HTA 应用程序，然后在 shellWindows 集合中搜索具有此 ID 的窗口并对其进行控制。它在大多数情况下都能正常工作，但在脚本上带有 UAC 的 Windows 7 上需要提升其权限。当它这样做时，createHTAWindow 函数不再工作，因为它无法在 shellWindows 集合中找到 HTA 窗口。如果脚本不尝试提升其权限，则 HTA 部分可以正常工作。以下是重现问题的代码示例。它适用于关闭 UAC 或同时打开 UAC 且 Elevate 变量处于 False 状态的 Windows 7。但是如果 UAC 开启并且 Elevate == True 那么它不会：/

```
var WshShell = new ActiveXObject("WScript.Shell");
var Elevate = true;

function main(){
    var oXMLHTTP = new ActiveXObject("MSXML2.XMLHTTP");    
    innerhtml =
        "<html> " +
        "<head> " +
        "<title>Test HTA window</title> " +
        "<HTA:APPLICATION " +
        "APPLICATIONNAME='test' " +
        "VERSION='1.0' " +
        "BORDER='none' " +
        "CAPTION='yes' " +
        "INNERBORDER='no' " +
        "CONTEXTMENU='no' " +
        "SCROLL='no' " +
        "MAXIMIZEBUTTON='no' " +
        "MINIMIZEBUTTON='no' " +
        "SELECTION='no' " +
        "/> " +
        "<STYLE> " +
        "body{ " +
        "font-family:Verdana; " +
        "font-size:11px; " +
        "} " +
        "</STYLE> " +
        "</head> " +
        "<script language='javascript'> " +
        "function window.onload(){ " +
        "self.focus(); " +
        "self.resizeTo(300,80); " +
        "} " +
        "</script> " +
        "<body scroll=no bgcolor='D4D0C8' style='border:0;'> " +
        "<center> Test HTA window " +
        "<br><br> " +
        " It will be closed in 10 sec " +
        "</center> " +
        "</body> " +
        "</html> ";
    width = 300; height = 80;
    var window = createHTAWindow(innerhtml,0,0,width,height);
    window.moveTo((window.screen.width-width)/2,(window.screen.height-height)/2);
    WScript.Sleep(10000);
    window.close();
}
// function createHTAWindow by JSman
function createHTAWindow(content, x, y, width, height)
{
var HTASettings = "", e, window, Host = this; 
    width = Number(width) || 400;
    height = Number(height) || 300;
    try {
        HTASettings = content.match(/<hta[^>]+>/gim)[0].replace(/\r?\n/g, " ").replace(/"/g,"'");
    } catch(e) {
    }

    var ID = "u"+Math.floor(Math.random()*10000000)
    var CodeForLinking = "\"<title> </title><script>moveTo(-300,-300); resizeTo(0,0)</script>" + 
        HTASettings + 
        "<object id=" + ID + 
        " classid='clsid:8856F961-340A-11D0-A96B-00C04FD705A2'><param name=RegisterAsBrowser value=1></object>\"";
    var ShellWindows = ( new ActiveXObject("Shell.Application") ).Windows();
    var NumberOfWindows = ShellWindows.Count;

    WshShell.Run("mshta.exe about:"+CodeForLinking);

// for debug purpose
WScript.Sleep(1000);
var s="ID: " + ID + "\n";
for (var i=ShellWindows.Count; --i>=0;){
    s = s + i + ": " + ShellWindows.Item(i).id + "\n";
}
WScript.Echo(s);

    outer: for (var t=0; t<500; t++)    
    inner:  for (var i=ShellWindows.Count; --i>=0;){
        try{
            if( ShellWindows.Item(i).id == ID ){
                window = ShellWindows.Item(i).parent.parentWindow;
                break outer;
            }
        } catch(e) {
            WScript.Echo(e.message);
            return false;
        }
        WScript.Sleep(10);
    }

    if (!window) {
        WshShell.Popup("Error", 0, "Error", 0+48);
        WScript.Quit();
        return false;
    }

    try {
        window.document.open(); window.Host = Host; 
        window.document.write([content||"", "<script language='JScript'>eval;resizeTo(",width,",", height,"); moveTo(", Number(x) ||  (window.screen.width - width) / 2,",", Number(y) || (window.screen.height - height) / 2, ");</script>"].join(""));
        window.document.close();
    } catch (e) {
    }
    return window;
}

if ( Elevate && WScript.Arguments.Count() == 0 ) {
    var oShell = new ActiveXObject("Shell.Application");
    oShell.ShellExecute("wscript.exe", "\"" + WScript.ScriptFullName + "\"" + " /isElevated", WScript.ScriptFullName.slice(0,-WScript.ScriptName.length-1), "runas", 1);
    WScript.Quit();
}

main(); 
```

你能解释一下为什么会发生这种情况并提出解决这个问题的建议吗？

# java - 围绕球体移动相机

> ID：14034796
> 
> 赞同：6
> 
> 时间：2012-12-25T23:50:18.743
> 
> 标签：java, android, opengl-es, 3d, libgdx

我正在尝试围绕我的世界中的模型以球形运动方式移动我的相机。我已经看到将球坐标（rho，theta，phi）转换为笛卡尔坐标（x，y，z），但我不确定如何进行设置。到目前为止，这是我尝试过的，但它并没有持续围绕模型运行。它到达某个点，然后旋转似乎会自行反转。

初始化`theta`和`phi`：

```
private float theta = 0.0f;
private float phi = 0.0f; 
```

更新`theta`和`phi`每一帧：

```
// This should move the camera toward the upper-right continuously, correct?
theta = (theta+1.0f)%360;
phi = (phi+1.0f)%360; 
```

转换`theta`和`phi`为相机的笛卡尔坐标：

```
camera.position.x = CAMERA_DISTANCE * (float)Math.sin(theta*MathHelper.PIOVER180) * (float)Math.cos(phi*MathHelper.PIOVER180);
camera.position.y = CAMERA_DISTANCE * (float)Math.sin(theta*MathHelper.PIOVER180) * (float)Math.sin(phi*MathHelper.PIOVER180);
camera.position.z = CAMERA_DISTANCE * (float)Math.cos(theta*MathHelper.PIOVER180); 
```

然后更新相机查看点和视图矩阵：

```
camera.lookAt(0, 0, 0);
camera.update(); 
```

**注意：** 我在带有 libGDX 框架的 Android 上使用 Java，我正在尝试使用 2D 屏幕虚拟操纵杆来控制旋转，但我仍然需要找到一种方法将操纵杆映射到`theta`和`phi`.

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T04:30:17.090

我最近做了这样的事情。[这个网站](http://www.flashandmath.com/mathlets/multicalc/coords/shilmay23fin.html)帮助我想象我需要做什么。

您需要做的是将您的本地操纵杆坐标（相对于它的中心）转换为俯仰和偏航值：

```
public float getPitch()
{
    return (position.X - center.X) * MathHelper.PIOVER180;
}

public float getYaw()
{
    return (position.Y - center.Y) * MathHelper.PIOVER180;
} 
```

然后你可以使用四元数来表示它的旋转：

```
public void rotate(float pitch, float yaw, float roll)
{
    newQuat.setEulerAngles(-pitch, -yaw, roll);
    rotationQuat.mulLeft(newQuat);
} 
```

然后您可以使用 libGDX 的内置`rotate(quaternion)`方法将四元数应用于相机的视图矩阵：

```
camera.view.rotate(rotationQuat);

// Remember to set the camera to "look at" your model
camera.lookAt(0, 0, 0); 
```

# xcode4.5 - 如何从 Xcode 中更改 OS X 应用程序名称中恢复？

> ID：14034799
> 
> 赞同：2
> 
> 时间：2012-12-25T23:50:52.503
> 
> 标签：xcode4.5

我是在 MacBookPro 上使用 Xcode 4.5.2 的新手。我正在开发基于 AMSerialPort 的应用程序，并想更改应用程序名称。在构建设置>打包（项目和目标）中，我更改了产品名称，并在摘要中更改了捆绑标识符。 ![构建设置](../Images/138cf7268e8db73ab41e4c397018d70e.png)

在下一次运行时，它得到了以下错误。该项目构建正常。仍然有一些对旧名称的引用（项目和 finder 中的版本 col. 显示了它。 ![错误信息](../Images/034e99f22fc052ae855888dd85a60411.png)

我阅读了很多关于此错误和类似错误的帖子，但没有一个答案对我有用。我已经尝试了几乎所有的 SDK 和架构，我已经删除了方案并自动创建了一个新方案，完成了清理，关闭了项目，关闭了 Xcode 并重新启动重新打开了项目，但没有任何乐趣。

试图让所有名称匹配我更改了 .xcodeproj 名称，通过双击它在 XCode 中打开它，现在运行和停止按钮被禁用。Cmd B 不会构建它。所有文件都显示在列表中，我可以编辑它们。

有没有希望解开我的烂摊子，还是我应该解压缩另一个副本？这样做让我重新开始更改名称。

# android - 尝试使用 SharedPreferences 存储字符串集时的不当行为

> ID：14034803
> 
> 赞同：74
> 
> 时间：2012-12-25T23:51:33.137
> 
> 标签：android, android-preferences

我正在尝试使用[`SharedPreferences`API](http://developer.android.com/reference/android/content/SharedPreferences.html)存储一组字符串。

```
Set<String> s = sharedPrefs.getStringSet("key", new HashSet<String>());
s.add(new_element);

SharedPreferences.Editor editor = sharedPrefs.edit();
editor.putStringSet(s);
edit.commit() 
```

我第一次执行上面的代码时，`s`设置为默认值（刚刚创建的 end empty `HashSet`）并且存储没有问题。

第二次和下一次执行此代码时，将`s`返回一个添加了第一个元素的对象。我可以添加元素，并且在程序执行期间，它显然存储在 中`SharedPreferences`，但是当程序被终止时，`SharedPreferences`再次从其持久存储中读取并且更新的值会丢失。

如何存储第二个以及之后的元素，以免丢失？

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2012-12-25T23:51:33.137

这个“问题”记录在[`SharedPreferences.getStringSet`](http://developer.android.com/reference/android/content/SharedPreferences.html#getStringSet%28java.lang.String,%20java.util.Set%3Cjava.lang.String%3E%29).

`SharedPreferences.getStringSet`返回 .hashSet 中存储的 HashSet 对象的引用`SharedPreferences`。当您向该对象添加元素时，它们实际上是添加到`SharedPreferences`.

没关系，但是当您尝试存储它时问题就来了：Android 将您尝试保存使用的修改后的 HashSet`SharedPreferences.Editor.putStringSet`与存储在 上的当前哈希集进行比较`SharedPreference`，两者都是同一个对象！！！

`Set<String>`一种可能的解决方案是制作对象返回的副本`SharedPreferences`：

```
Set<String> s = new HashSet<String>(sharedPrefs.getStringSet("key", new HashSet<String>())); 
```

这会产生`s`一个不同的对象，并且添加到的字符串`s`不会添加到存储在`SharedPreferences`.

其他可行的解决方法是使用相同的`SharedPreferences.Editor`事务来存储另一个更简单的首选项（如整数或布尔值），您唯一需要的是强制每个事务的存储值不同（例如，您可以存储字符串设置大小）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-26T08:07:41.247

此行为已记录在案，因此是设计使然：

从getStringSet：

> “请注意，您不得修改此调用返回的集合实例。如果您这样做，则无法保证存储数据的一致性，您也无法修改实例。”

这似乎很合理，特别是如果它记录在 API 中，否则这个 API 必须在每次访问时进行复制。所以这个设计的原因可能是性能。我想他们应该让这个函数返回结果包装在不可修改的类实例中，但这又需要分配。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-11-18T01:15:36.293

正在寻找相同问题的解决方案，通过以下方式解决：

1) 从共享首选项中检索现有集合

2）复制一份

3) 更新副本

4) 保存副本

```
SharedPreferences.Editor editor = sharedPrefs.edit();
Set<String> oldSet = sharedPrefs.getStringSet("key", new HashSet<String>());

//make a copy, update it and save it
Set<String> newStrSet = new HashSet<String>();    
newStrSet.add(new_element);
newStrSet.addAll(oldSet);

editor.putStringSet("key",newStrSet); edit.commit(); 
```

[为什么](https://developer.android.com/reference/android/content/SharedPreferences.html#getStringSet(java.lang.String,%20java.util.Set%3Cjava.lang.String%3E))

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-06-12T01:14:12.013

## 源码说明

虽然这里的其他好的答案正确地指出这个潜在的问题记录在[SharedPreferences.getStringSet()](https://developer.android.com/reference/android/content/SharedPreferences?hl=en#getStringSet(java.lang.String,%2520java.util.Set%3Cjava.lang.String%3E))中，基本上“不要修改返回的 Set，因为不能保证行为”，但我想实际贡献对于任何想要深入研究的人来说，导致此问题/行为的源代码。

查看[SharedPreferencesImpl](https://android.googlesource.com/platform/frameworks/base/+/refs/tags/android-9.0.0_r42/core/java/android/app/SharedPreferencesImpl.java)（Android Pie 的源代码），我们可以看到原始值（在我们的例子中为 a）和新修改的值`SharedPreferencesImpl.commitToMemory()`之间发生了比较：`Set<String>`

```
private MemoryCommitResult commitToMemory() {
    // ... other code

    // mModified is a Map of all the key/values added through the various put*() methods.
    for (Map.Entry<String, Object> e : mModified.entrySet()) {
        String k = e.getKey();
        Object v = e.getValue();
        // ... other code

        // mapToWriteToDisk is a copy of the in-memory Map of our SharedPreference file's
        // key/value pairs.
        if (mapToWriteToDisk.containsKey(k)) {
            Object existingValue = mapToWriteToDisk.get(k);
            if (existingValue != null && existingValue.equals(v)) {
                continue;
            }
        }
        mapToWriteToDisk.put(k, v);
    } 
```

所以基本上这里发生的事情是，当您尝试将更改写入文件时，此代码将遍历您修改/添加的键/值对并检查它们是否已经存在，并且只会在它们不存在或不存在时将它们写入文件不同于读入内存的现有值。

这里要注意的关键线是`if (existingValue != null && existingValue.equals(v))`。`existingValue`如果是`null`（不存在）或者如果`existingValue`的内容与新值的内容不同，则您的新值只会被写入磁盘。

**这是问题的症结所在。** `existingValue`从内存中读取。您尝试修改的 SharedPreferences 文件被读入内存并存储为（稍后在您每次尝试写入文件时`Map<String, Object> mMap;`复制到该文件中）。`mapToWriteToDisk`当你打电话时，`getStringSet()`你会`Set`从这个内存地图中得到一个。如果您随后向同一`Set`实例添加值，则您正在修改**内存**映射。然后，当您调用`editor.putStringSet()`并尝试提交时，它`commitToMemory()`会被执行，并且比较行会尝试比较您新修改的值，`v`，`existingValue`它与您刚刚修改的内存`Set`中的值基本相同。对象实例不同，因为`Set`s 被复制到不同的地方，但内容是相同的。

**因此**，您尝试将新数据与旧数据进行比较，但您已经通过直接修改该`Set`实例无意中更新了旧数据。因此，您的新数据不会被写入文件。

### 但是为什么最初存储的值在应用程序被杀死后消失了呢？

正如 OP 所说，似乎在您测试应用程序时存储了这些值，但是在您终止应用程序进程并重新启动它之后，新值就会消失。这是因为当应用程序正在运行并且您正在添加值时，您**仍在**将值添加到 in-memory`Set`结构中，并且当您调用时，`getStringSet()`您将返回相同的 in-memory `Set`。你所有的价值观都在那里，看起来它正在发挥作用。但是在你杀死应用程序之后，这个内存结构和所有新值一起被破坏，因为它们从未被写入文件。

## 解决方案

正如其他人所说，只要避免修改内存结构，因为你基本上会造成副作用。因此，当您调用`getStringSet()`并希望重用内容作为起点时，只需将内容复制到不同的`Set`实例中，而不是直接修改它：`new HashSet<>(getPrefs().getStringSet())`. 现在，当比较发生时，内存中`existingValue`的值实际上与您修改后的值不同`v`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-09-23T10:27:46.433

我尝试了上述所有答案，但都没有为我工作。所以我做了以下步骤

1.  在将新元素添加到旧共享首选项列表之前，请对其进行复制
2.  调用具有上述副本的方法作为该方法的参数。
3.  在该方法中清除持有该值的共享首选项。
4.  将副本中存在的值添加到已清除的共享首选项中，它将视为新的。

    ```
    public static void addCalcsToSharedPrefSet(Context ctx,Set<String> favoriteCalcList) {

    ctx.getSharedPreferences(FAV_PREFERENCES, 0).edit().clear().commit();

    SharedPreferences sharedpreferences = ctx.getSharedPreferences(FAV_PREFERENCES, Context.MODE_PRIVATE);
    SharedPreferences.Editor editor = sharedpreferences.edit();
    editor.putStringSet(FAV_CALC_NAME, favoriteCalcList);
    editor.apply(); } 
    ```

我遇到了值不持久的问题，如果我在从后台清理应用程序后重新打开应用程序，则只显示添加到列表中的第一个元素。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-06-24T05:34:54.617

就像一个注释，共享首选项不能只是被覆盖。如果你已经给它赋值了，你必须先通过方法移除它`remove(KEY)`，然后再`commit()`销毁这个键。然后，您可以为其分配一个新值。

[https://developer.android.com/reference/android/content/SharedPreferences.html#getStringSet(java.lang.String,%20java.util.Set%3Cjava.lang.String%3E)](https://developer.android.com/reference/android/content/SharedPreferences.html#getStringSet(java.lang.String,%20java.util.Set%3Cjava.lang.String%3E))

# c++ - 在同一条指令中引用和取消引用

> ID：14034807
> 
> 赞同：5
> 
> 时间：2012-12-25T23:52:12.303
> 
> 标签：c++, pointers, reference

想知道 LLVM 源代码我偶然发现了这行代码

```
MachineInstr *MI = &*I; 
```

我是 C++ 中的新手，引用和指针之间的区别对我来说非常模糊，我认为这与这种区别有关，但这个操作对我来说毫无意义。有人对此有解释吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-25T23:54:34.913

of 的类型`I`可能是某种迭代器或智能指针，它具有一元`operator*()`重载以产生`MachineInstr&`. 如果您想获得一个指向所引用对象的内置指针，`I`您将获得对该对象的引用 using `*I`，然后获取该引用的地址，使用`&*I`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-25T23:54:21.637

C++ 允许重载解引用运算符，因此它在对象上使用重载方法，然后获取结果的地址并将其放入指针中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-25T23:55:24.263

这个说法：

```
MachineInstr *MI = &*I; 
```

取消引用`I`，`*`并获取其结果的地址，`&`然后将其分配给`MI`指向 的指针`MachineInstr`。它看起来像是`I`一个迭代器，`*I`存储在容器中的值也是如此，因为迭代器定义了`*`在迭代点返回项目的运算符。容器（例如列表）必须包含一个`MachineInstr`. 这可能是一个`std::list<MachineInstr>`.

# php - PHP - 表单验证 - 下拉菜单 + 评论框

> ID：14034821
> 
> 赞同：1
> 
> 时间：2012-12-25T23:56:23.003
> 
> 标签：php, forms, validation, if-statement

在过去的几个小时里，我一直在为学生制作输入表格。我已经完成了几乎所有工作，0 次打嗝，但我遇到了一个小问题，我想不出解决办法。我有一个下拉菜单，对此的验证是：

```
 }
        if(empty($why) === true) {
            $errors[] = 'Please make sure to select the proper reasoning for your vistit today!';
    } 
```

默认变量设置为空或只是 value=""（空）...

现在我需要验证的下一件事是，如果学生选择“其他”选项，我需要他们将至少 10 个字符和最多 30 个字符插入专门为找不到一般原因的学生制作的评论框中他们访问了财政援助办公室。这就是我所拥有的（顺便说一句它不起作用）：

```
if(isset($why) === Other) {
        $errors[] = 'Please add a comment explaining why you are visiting the office.';
} 
```

所以总而言之，我需要帮助写一个验证，如果学生选择其他，那么他或她必须在“评论框”中写一个关于他或她为什么访问办公室的简短摘要。

任何帮助都会很可爱。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T00:10:40.290

可以说“其他”字段的文本区域被称为`$other`

```
if(empty($why)){
  $errors[] = 'Please select a reason';
}elseif($why == 'Other' && empty($other)){
  $errors[] = 'You selected Other. Please enter a reason why';
} 
```

您的代码可能需要比上面更详细，因为您希望设置最小和最大字符数，但您明白了吗？

顺便说一句，我认为您没有理由要使用`===`运算符而不是`==`运算符。他们做完全相同的事情，但`===`检查它是否是同一类型，不确定这对您的脚本有什么好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T00:04:22.107

For `if(isset($why) === Other)`, *Other*不应该用引号引起来，因为*$why*会将下拉菜单选择的值作为文本返回？

`if(isset($why) === 'Other')`假设*“其他”*是下拉菜单的“*其他*”选择选项的名称，那么应该可以工作。

编辑：再次查看您的代码，您正在将一个`isset()`值与另一个 var（其他）进行比较。您希望`if(isset($why) && $why === 'Other')`这样可以检查*$why*是否已设置，并且它也等于文本*"Other"*。=== 运算符还会检查 $why 和 Other 是否属于同一类型，因此您应该检查其余代码以确保*$why*和*Other*属于同一类型。

# c++ - 使用 Qt，我应该使用 setStyleSheet 还是 QPalette(Background, image) 来设置背景图像？

> ID：14034824
> 
> 赞同：2
> 
> 时间：2012-12-25T23:56:57.367
> 
> 标签：c++, qt, pyqt, qwidget, qscrollarea

我对使用 Qt 进行开发相当陌生。过去一周我读了很多书，听说有时使用样式表设置背景图像会导致“减速”问题。

作为我的天才（讽刺），我想出了如何使用 QPalette.setBrush() 方法设置背景。

我的问题是：

*   在为 QWidget、QScrollArea 等设置背景图像时，我应该使用哪种方法来获得最佳性能（如果重要的话，低内存占用）。

如果有帮助，我正在使用的图像会重复出现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T00:11:25.787

在这种情况下，使用`setBrush`比使用样式表更快。

使用样式表通常会导致 UI 性能不佳并增加启动时间。样式表也有一些限制，例如，没有透明列表或树视图 AFAIR。

# scala - Scala 2.9.2 简单字符串插值抛出错误

> ID：14034825
> 
> 赞同：3
> 
> 时间：2012-12-25T23:57:18.960
> 
> 标签：scala, read-eval-print-loop

我正在尝试学习 Scala，IDE 和 REPL 都在抱怨字符串插值：

```
scala> val name = "World"
name: java.lang.String = World

scala> val message = s"Hello $name"
<console>:1: error: ';' expected but string literal found.
   val message = s"Hello $name"
                  ^ 
```

问题是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-26T00:04:30.507

String interpolation is not available in 2.9.2\. It was [coined in 2.10.0](http://docs.scala-lang.org/overviews/core/string-interpolation.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T05:13:15.093

我想回答我自己对 osx 窥视的问题：scala 的 brew 安装是这样完成的（来自我的 confluence 实例）：

**安装 Scala 2.10.0** Scala 在该语言中有 akka 演员，因此使用它比 brew 安装的 2.9.x 更好。

有人很好地使用文档为 scala 2.10.0 进行了 brew 安装。在外壳中运行。

**带有文档的 Scala 2.10.0**

```
$brew install https://raw.github.com/gist/4525237/scala.rb --with-docs

$brew switch scala 2.10.0 
```

检查你可以在之后运行'scala'。

# django - 在 Form 类中设置 Django 字段的值

> ID：14034826
> 
> 赞同：0
> 
> 时间：2012-12-25T23:57:36.353
> 
> 标签：django

我正在尝试在 Form 类中设置 Django 字段的值。这是我的模型

```
class Workout(models.Model):
    user = models.ForeignKey(User , db_column='userid')

    datesubmitted = models.DateField() 
    workoutdate = models.DateField(); 
    bodyweight = models.FloatField(null=True);
    workoutname = models.CharField(max_length=250) 
```

这是表单类，我试图在其中实现这一点：

```
class WorkoutForm(forms.ModelForm):

    class Meta: 
        model = Workout

    def __init__(self,*args, **kwargs):
        # this is obviously wrong, I don't know what variable to set self.data to
        self.datesubmitted = self.data['datesubmitted'] 
```

好的，对不起各位。我正在像这样将`request.POST`数据传递给`WorkoutForm`我的视图

```
w = WorkoutForm(request.POST) 
```

然而，不幸的是，html 元素的名称与模型的名称不同。例如，`date submitted`html 中没有字段。这实际上是在数据库中生成并保存的时间戳。

所以我认为我需要能够以某种方式将它保存在表单类中。

这就是为什么我试图将`datesubmitted`字段设置为`datetime.datetime.now()`

基本上我使用表单类来简化验证，我没有使用表单作为它的 html 输出，我完全不理会它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T00:09:38.850

你必须在`save`你的表格方法中做到这一点

```
class WorkoutForm(forms.ModelForm):

    class Meta: 
        model = Workout

    def __init__(self,*args, **kwargs):
        super(WorkoutForm, self).__init__(*args, **kwargs)

    def save(self, *args, **kw):
        instance = super(WorkoutForm, self).save(commit=False)
        instance.datesubmitted = datetime.now()
        instance.save() 
```

您如何在模型中设置它也可以在创建新对象时保存当前日期时间：

```
datesubmitted = models.DateTimeField(auto_now_add=True) 
```

您可以在表单中设置一些额外的值：

```
form = WorkOutForm(curr_datetime = datetime.datetime.now(), request.POST) # passing datetime as a keyword argument 
```

然后在表单中获取并设置它：

```
def __init__(self,*args, **kwargs):
    self.curr_datetime = kwargs.pop('curr_datetime')
    super(WorkoutForm, self).__init__(*args, **kwargs) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T00:10:42.287

您不应该`ModelForm`为此使用 a 。使用 normal `Form`，在视图或方法中创建一个新的模型实例，复制值，然后返回模型实例。

# c++ - C++ 容器内的 char* 范围

> ID：14034827
> 
> 赞同：4
> 
> 时间：2012-12-25T23:57:42.923
> 
> 标签：c++, containers, cstring, strdup

具有以下内容：

```
#include <set>

std::set<const char *> global = std::set<const char *>();
void x() {
    const char *c = "a";
    const char *d = "b";

    global.insert(c);
    global.insert(d);
}

int main() {
    x();
    for (std::set<const char *>::const_iterator iter=global.begin(), end=global.end(); iter!=end; ++iter) {
        printf("%s\n", *iter);
    }

    return 0;
} 
```

最后，正如预期的那样，我收到`a`并`b`打印了。

然而，是否有任何保证，例如，如果该集合是`bozo`对象的一部分，那么作为集合，它们将持续到`bozo`的生命周期结束？或者我必须`strdup`用弦来确定吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-25T23:59:54.403

你完全没问题，因为字符串文字具有静态存储持续时间。也就是说，该字符串将在程序运行期间一直存在于内存中。但是，如果您要像这样将您的`c`和声明`d`为数组，那就不行了：

```
const char c[] = "a";
const char d[] = "b"; 
```

这是因为当使用字符串文字初始化数组时，文字中的字符会被复制到数组中。该数组具有自动存储期限，因此内容将在函数结束时销毁`x`。如果您仍然这样做`global.insert(c)`，您将推入指向数组第一个元素的指针`c`，但该数组将不再存在。

这里有一些标准报价。首先，§2.14.5/8：

> 普通字符串文字和 UTF-8 字符串文字也称为窄字符串文字。窄字符串文字的类型为“ *n* `const char`数组”，其中*n*是字符串的大小，定义如下，并且具有静态存储持续时间 (3.7)。

现在定义静态存储持续时间（§3.7.1/1）：

> 所有没有动态存储持续时间、没有线程存储持续时间和非本地变量的变量都有*静态存储持续时间*。这些实体的存储应持续到程序的持续时间（3.6.2、3.6.3）。

# intellij-idea - IDEA，如何取消编辑器与文件类型的关联？

> ID：14034830
> 
> 赞同：2
> 
> 时间：2012-12-25T23:58:37.663
> 
> 标签：intellij-idea

我的目录中有一个名为`protected.keys`. 创建它时，我要求`IntelliJ`将其视为`properties`.

![在此处输入图像描述](../Images/d7eb8abe0940c5504817949f56b76b2d.png)

相反，我想将其更改为我该`text`怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T04:55:12.873

`File`您可以在|中更改它 `Settings`| **文件类型**，从 中删除文件名或扩展名`Properties files`并将其分配给`Text files`.

# android - Null pointer when updating Textview within Fragment

> ID：14034832
> 
> 赞同：1
> 
> 时间：2012-12-25T23:59:20.313
> 
> 标签：android, android-fragments, textview

I'm writting an application with two fragments. The First fragment sends text information to the activity that created both fragments. That work perfectly. My second fragment is created at the same time as the first fragment. The second fragment contains a textview in its xml layout. My main activity should pass the text based data to the second fragment and the text should be displayed. The problem is when the text reachs the second fragments method the textview alwasy returns a null pointer.

```
//This is the main methods creation of the fragment    
try {  
    //message frag on bottom
    FragmentManager fM = getFragmentManager();
    FragmentTransaction fTrans = fM.beginTransaction(); 
    messFrag = new DisplayMessageFragment();
    fTrans.add(R.id.BottomDisplayFragment, messFrag,"MESSAGE_FRAGMENT");
    fTrans.commit();
} catch(Exception e) {
    e.printStackTrace();
} 
```

```
//this is whe main methods call the fragments text view updating method
@Override
public void getDisplayWindowMessage_StartFrag(String message) {
    getFragmentManager().findFragmentByTag("MESSAGE_FRAGMENT");
    messFrag.setMessage(message);
} 
```

```
//This is my fragment class        
public class DisplayMessageFragment extends Fragment {
    TextView displayedMessage;
    View view ;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);

    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        view = inflater.inflate(R.layout.displaymess_frag,container, false);
        displayedMessage = (TextView) view.findViewById(R.id.MessageDisplay);

        return view;
    }

    public void setMessage(String newMessage){
        //displayedMessage=(TextView) view.findViewById(R.id.MessageDisplay);
        displayedMessage = (TextView) getView().findViewById(R.id.MessageDisplay);
        displayedMessage.setText(newMessage);
    }
} 
```

Stack Trace:

```
java.lang.NullPointerException
12-26 02:06:14.505: E/AndroidRuntime(710):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
12-26 02:06:14.505: E/AndroidRuntime(710):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
12-26 02:06:14.505: E/AndroidRuntime(710):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
12-26 02:06:14.505: E/AndroidRuntime(710):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
12-26 02:06:14.505: E/AndroidRuntime(710):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-26 02:06:14.505: E/AndroidRuntime(710):  at android.os.Looper.loop(Looper.java:137)
12-26 02:06:14.505: E/AndroidRuntime(710):  at android.app.ActivityThread.main(ActivityThread.java:4424)
12-26 02:06:14.505: E/AndroidRuntime(710):  at java.lang.reflect.Method.invokeNative(Native Method)
12-26 02:06:14.505: E/AndroidRuntime(710):  at java.lang.reflect.Method.invoke(Method.java:511)
12-26 02:06:14.505: E/AndroidRuntime(710):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
12-26 02:06:14.505: E/AndroidRuntime(710):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
12-26 02:06:14.505: E/AndroidRuntime(710):  at dalvik.system.NativeStart.main(Native Method)
12-26 02:06:14.505: E/AndroidRuntime(710): Caused by: java.lang.NullPointerException
12-26 02:06:14.505: E/AndroidRuntime(710):  at .DisplayMessageFragment.setMessage(DisplayMessageFragment.java:38)
12-26 02:06:14.505: E/AndroidRuntime(710):  at .Schduler_Activity.getDisplayWindowMessage_StartFrag(Schduler_Activity.java:79)
12-26 02:06:14.505: E/AndroidRuntime(710):  at 
StartFragment.onCreateView(StartFragment.java:31)
12-26 02:06:14.505: E/AndroidRuntime(710):  at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:828)
12-26 02:06:14.505: E/AndroidRuntime(710):  at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:1032)
12-26 02:06:14.505: E/AndroidRuntime(710):  at android.app.BackStackRecord.run(BackStackRecord.java:622)
12-26 02:06:14.505: E/AndroidRuntime(710):  at android.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1382)
12-26 02:06:14.505: E/AndroidRuntime(710):  at android.app.Activity.performStart(Activity.java:4474)
12-26 02:06:14.505: E/AndroidRuntime(710):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1929)
12-26 02:06:14.505: E/AndroidRuntime(710):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T00:29:16.503

Why are you trying to re-set the `displayedMessage` var? You set it in `onCreateView` and you have it as a class variable, so it should still be there when you call the `serMessage` method.

Just drop the `findViewById` in the `setMesage` method and I believe your NPE will go away.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T01:41:10.553

I found my error. I attempted to call the second fragment during the first fragments callback which throw the NPE as fragments can not directly communicate.

# android - 如果有 1 个，如何在 2 个文本视图中拆分文本？

> ID：14034833
> 
> 赞同：6
> 
> 时间：2012-12-25T23:59:28.383
> 
> 标签：android, android-layout, listview

我有一个列表视图，其中每个项目有 2 个图像，一个在右侧，另一个在左侧。它们之间有一个由数据填充的文本视图。如果文本很长，那么它可以继续向下，但正如您在图像中看到的那样，有很多可用空间。我也想使用这个空间来显示文本。我一直在网上浏览，我看到过类似[http://code.google.com/p/android-flowtextview/downloads/detail?name=FlowTextDemo.zip&can=2&q=](http://code.google.com/p/android-flowtextview/downloads/detail?name=FlowTextDemo.zip&can=2&q=)的东西，但这是没用的。我不想失去对图像的控制，因为我需要它们的点击方法。最好的方法是什么？我想也许我可以在图像和另一个之间放置一个文本视图，当第一个被填充时，第二个继续，但是我怎么知道有多少个字母可以保留第一个文本视图？![在此处输入图像描述](../Images/b1813795aa983ab544b16dc8e332729d.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T00:19:11.253

我不明白为什么`FlowTextView`（你链接到的）对你不起作用。它源自`RelativeLayout`任何子视图并围绕其流动文本。子视图可以是您的图像，就像您通常在`RelativeLayout`. 他们的`onClick`方法应该可以正常工作。

```
<com.pagesuite.flowtext.FlowTextView
    android:id="@+id/tv"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:id="@+id/the_text >

    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:onClick="onTopLeftClick"
        android:src="@drawable/top_left_image" />
    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:onClick="onTopRightClick"
        android:src="@drawable/top_right_image" />

</com.pagesuite.flowtext.FlowTextView> 
```

您将需要在代码中设置文本，或者扩展`FlowTextView`并定义您自己的自定义属性以从 xml 执行此操作。

# php - PHP MySQL 更新数据库

> ID：14034834
> 
> 赞同：-3
> 
> 时间：2012-12-25T23:59:39.363
> 
> 标签：php, mysql

我是 php 和 mysql 的新手，我想创建一个查询来执行更新或添加一个新表（如果它不在数据库中）

到目前为止，我有这个，为什么我会收到 Parse error: syntax error, unexpected T_STRING for

```
mysql_query(UPDATE ps_product SET id_tax_rules_group = 1 WHERE id_tax_rules_group = 0); 
```

你能帮我让这段代码工作吗？当我只评论所有 mysql_quer 时，我得到空白页并回显“ID $trenutnired 在表中不存在并且：$countUpdated
”；

不管用？

我使用 PHP 5.2.17

谢谢

```
 <?php

     $mysql_db = "";
    $mysql_user = "";
    $mysql_pwd  = "";

    $con = mysql_connect("localhost", $mysql_user, $mysql_pwd);
    if (!$con) {
        die('Could not connect: ' . mysql_error());
    }

    mysql_select_db($mysql_db, $con);

      $countUpdated=0;

        mysql_query(UPDATE ps_product_shop prod_shop INNER JOIN ps_product prod USING(id_product) SET prod_shop.id_category_default = prod.id_category_default WHERE prod_shop.id_product BETWEEN 1 AND 62226);

                mysql_query(UPDATE ps_product_supplier SET id_currency = 3 WHERE id_currency = 0);                      
                mysql_query(UPDATE ps_product SET id_tax_rules_group = 1 WHERE id_tax_rules_group = 0);
                mysql_query(UPDATE ps_product_shop SET id_tax_rules_group = 1 WHERE id_tax_rules_group = 0);

    $kveri = "SELECT id_product,id_supplier,supplier_reference, wholesale_price FROM ps_product";

    $ispis = mysql_query($kveri) or die(mysql_error());

               while ($row = mysql_fetch_array($ispis)){

               $trenutnired = $row['id_product'];
               $trenutnired1 = 0;
               $trenutnired2 = $row['id_supplier'];
               $trenutnired4 = $row['supplier_reference'];
               $trenutnired5 = $row['wholesale_price'];
               $trenutnired6 = 3;

               $drugatab = mysql_query("SELECT * FROM ps_product_supplier WHERE id_product = '$trenutnired'");

               $dalipostoji = mysql_num_rows($drugatab);

               if ($dalipostoji == 0) {

               echo "ID $trenutnired does not exist in table and:: $countUpdated<br />";   

                 mysql_query("INSERT INTO ps_product_supplier (id_product_supplier, id_product, id_product_attribute, id_supplier, product_supplier_reference, product_supplier_price_te, id_currency)  VALUES ('', '$trenutnired', '$trenutnired1',  '$trenutnired2', '$trenutnired4', '$trenutnired5', '$trenutnired6')");

                                   $countUpdated++;

               };
             }               
    ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T00:01:55.007

看来你忘了放双`"`后`mysql_query(`

你有没有试过这个：

`mysql_query("UPDATE ps_product SET id_tax_rules_group = 1 WHERE id_tax_rules_group = 0 ");`

代替

`mysql_query(UPDATE ps_product SET id_tax_rules_group = 1 WHERE id_tax_rules_group = 0);`

***检查下面的整个代码***（修改）

* * *

```
<?php

     $mysql_db = "";
    $mysql_user = "";
    $mysql_pwd  = "";

    $con = mysql_connect("localhost", $mysql_user, $mysql_pwd);
    if (!$con) {
        die('Could not connect: ' . mysql_error());
    }

    mysql_select_db($mysql_db, $con);

      $countUpdated=0;

      //popravak kategorija
        mysql_query("UPDATE ps_product_shop prod_shop INNER JOIN ps_product prod USING(id_product) SET prod_shop.id_category_default = prod.id_category_default WHERE prod_shop.id_product BETWEEN 1 AND 62226 ");

                // sve na kunu
                mysql_query("UPDATE ps_product_supplier SET id_currency = 3 WHERE id_currency = 0");

                //dodavanje poreza

                mysql_query("UPDATE ps_product SET id_tax_rules_group = 1 WHERE id_tax_rules_group = 0");
                mysql_query("UPDATE ps_product_shop SET id_tax_rules_group = 1 WHERE id_tax_rules_group = 0");

    //$kveri = "SELECT id_product_supplier, id_product, id_product_attribute, id_supplier,product_supplier_reference, product_supplier_price_te, id_currency FROM ps_product";
    $kveri = "SELECT id_product,id_supplier,supplier_reference, wholesale_price FROM ps_product";

    $ispis = mysql_query($kveri) or die(mysql_error());

               while ($row = mysql_fetch_array($ispis)){

               $trenutnired = $row['id_product'];
               $trenutnired1 = 0;
               $trenutnired2 = $row['id_supplier'];
               $trenutnired4 = $row['supplier_reference'];
               $trenutnired5 = $row['wholesale_price'];
               $trenutnired6 = 3;

                                                            //echo $trenutnired;

               $drugatab = mysql_query("SELECT * FROM ps_product_supplier WHERE id_product = '$trenutnired'");

               $dalipostoji = mysql_num_rows($drugatab);

               if ($dalipostoji == 0) {

               echo "ID $trenutnired ne postoji u drugoj tablici i trenutno: $countUpdated<br />";   

                 mysql_query("INSERT INTO ps_product_supplier (id_product_supplier, id_product, id_product_attribute, id_supplier, product_supplier_reference, product_supplier_price_te, id_currency)  VALUES ('', '$trenutnired', '$trenutnired1',  '$trenutnired2', '$trenutnired4', '$trenutnired5', '$trenutnired6')");

                                   $countUpdated++;

               };

             }

    ?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T00:01:58.033

That error indicates a problem in your PHP. Specifically, the `mysql_query()` function takes a *string* as its first argument. So you'll need to wrap your SQL statement in quotes:

```
mysql_query("UPDATE ps_product SET id_tax_rules_group = 1 WHERE id_tax_rules_group = 0"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T00:10:55.453

You should always check if your query was successful before continuing script execution because on production servers error reporting is usually disabled (as it should be) so you won't be able to see errors in your code like in this case where you actually tried to fetch the number of records for an unsuccessful query.

I.e. you should have checked if your `SELECT` query actually returns a result like this.

```
$drugatab = "SELECT * FROM ps_product_supplier WHERE id_product = '$trenutnired'";
if($rezultati = mysql_query($drugatab) && mysql_num_rows($rezultati)){
    // Successful query...
    mysql_query("INSERT INTO ps_product_supplier (id_product_supplier, id_product, id_product_attribute, id_supplier, product_supplier_reference, product_supplier_price_te, id_currency)  VALUES ('', '$trenutnired', '$trenutnired1',  '$trenutnired2', '$trenutnired4', '$trenutnired5', '$trenutnired6')");
    $countUpdated++;
} else {
    echo "ID $trenutnired ne postoji u drugoj tablici i trenutno: $countUpdated<br />";
} 
```

# objective-c - Cocos2d每5秒一次删除一个对象

> ID：14034843
> 
> 赞同：0
> 
> 时间：2012-12-26T00:00:53.620
> 
> 标签：objective-c, cocos2d-iphone

我的 cocos2d 游戏有问题。我试图每 5 秒删除一次敌人射出的弹丸（每个弹丸的寿命应该为 5 秒），但我不知道该怎么做。我得到的错误

```
Assertion failure in -[CCTimer initWithTarget:selector:interval:] 
```

这是我的代码：

```
-(void)projectileShooting:(ccTime)dt
{
    [self schedule:@selector(projectileShooting:) interval:2.5];
    projcount++;
    if([proj count] <= 15 ){
        if(enemy1.position.y < 320){
            v = ccp(player.position.x,player.position.y);
            for(CCSprite *enemies in enemy){
            CCSprite * projectilebullet = [CCSprite spriteWithFile:@"Projectile.png"];
            [proj addObject:projectilebullet];
            [self addChild:projectilebullet];
            CGPoint MyVector = ccpSub(enemies.position,player.position );
            MyVector = ccpNormalize(MyVector);
            MyVector = ccpMult(MyVector, enemies.contentSize.width/2);
            MyVector = ccpMult(MyVector,-1);
            projectilebullet.position = ccpAdd(enemies.position, MyVector);
            for(CCSprite *projectile in proj){
                [self schedule:@selector (deleteprojectile:projectile:) interval:5];
            }
        }
    }
}

for(CCSprite *enem2 in enemytwo)
{
    if(  [proj count] <= 15){
        CCSprite * projectilebull = [CCSprite spriteWithFile:@"Projectile.png"];
        CGPoint MyVector = ccpSub(enem2.position,player.position );
        MyVector = ccpNormalize(MyVector);
        MyVector = ccpMult(MyVector, enem2.contentSize.width/2+10);
        MyVector = ccpMult(MyVector,-1);
        projectilebull.position = ccpAdd(enem2.position, MyVector);
        [self addChild:projectilebull];
        [proj addObject:projectilebull];
        for(CCSprite *projectile in proj){
        }
    }
}

}

-(void)deleteprojectile:(CCSprite *)protime:(ccTime)dt{
    NSMutableArray *timepro = [[NSMutableArray alloc]init];
    [timepro addObject:protime];
    for(CCSprite *objecttime in timepro){
        [proj removeObject:objecttime];
        [self removeChild:objecttime cleanup:YES];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T20:42:50.130

这有点小技巧，但这是我在程序中使用的，直到我找到更优雅的解决方案。我的游戏层中有一个方法，我调用它来从其父节点中删除一个节点，如下所示：

```
-(void)removeNode:(CCNode*)node {
    [node removeFromParentAndCleanup:YES];
} 
```

当我想在延迟后安排一个节点删除时，我这样称呼它：

```
[self performSelector:@selector(removeNode:) withObject:node afterDelay:delay]; 
```

很简单，而且很有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T15:41:48.927

将选择器中的参数名称更改为**protime**而不是**projectile**。选择器必须与对象的类定义中定义的签名匹配。您的选择器未正确定义，可能 Timer 正在检查对象是否实现给定的选择器。

我没有时间测试它，所以感谢@RamyAlZuhouri 的确认。

# ruby-on-rails - 在两个实例化对象之间创建关联

> ID：14034844
> 
> 赞同：9
> 
> 时间：2012-12-26T00:01:14.780
> 
> 标签：ruby-on-rails, associations, has-many, belongs-to

我有两个模型：（专辑和产品）

1) 内部模型

里面的专辑.rb：

```
class Album < ActiveRecord::Base
  attr_accessible :name
  has_many :products
end 
```

product.rb 内部：

```
class Product < ActiveRecord::Base
  attr_accessible :img, :name, :price, :quantity
  belongs_to :album
end 
```

2）使用“ **rails console** ”，我如何设置关联（所以我可以使用“<%= Product.first.album.name %>”）？

例如

```
a = Album.create( :name => "My Album" )
p = Product.create( :name => "Shampoo X" )
# what's next? how can i set the album and the product together? 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-26T00:04:37.400

You can do like this:

```
a = Album.create( name: "My Album" )

p = Product.create( name: "Shampoo X" )
# OR
p = Product.create( name: "Shampoo X", album_id: a.id )
# OR
p.album = a
# OR
p.album_id = a.id
# OR 
a.products << a
# finish with a save of the object:
p.save 
```

You may have to set the attribute accessible to album_id on the Product model (not sure about that).

**Check @bdares' comment also.**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T00:28:16.173

创建产品时添加关联：

```
a = Album.create( :name => "My Album" )
p = Product.create( :name => "Shampoo X", :album => a ) 
```

# php - 数据库中的 UTF8 字符无法在浏览器中正确显示 - MySQL 和 PHP CodeIgniter

> ID：14034847
> 
> 赞同：2
> 
> 时间：2012-12-26T00:01:39.227
> 
> 标签：php, codeigniter, utf-8, character-encoding, amazon-ec2

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T00:11:35.553

确保您的 my.cnf（可能位于 /etc/）具有以下条目：

```
[mysqld]
default-character-set=utf8
default-collation=utf8_general_ci
character-set-server=utf8
collation-server=utf8_general_ci
init-connect='SET NAMES utf8'

[client]
default-character-set=utf8 
```

进行更改后，您需要重新启动 mysql 服务。

**在此处添加我的评论以使其更清晰。**

确保设置了以下 HTTP 标头，以便浏览器知道预期的字符集。

```
Content-type: text/html; charset=UTF-8 
```

还可以尝试将此标签添加到 html`<head>`标签的顶部

```
<meta http-equiv="Content-type" value="text/html; charset=UTF-8" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T11:50:02.307

原始数据已被编码为 UTF-8，结果在 Windows-1252 中解释，然后再次 UTF-8 编码。这真的很糟糕；这与标头可以修复的简单编码不匹配无关。您的数据实际上已损坏。

如果数据库中的数据正常（检查`SELECT hex(column) FROM myTable)`以查看它是否已经在数据库中进行了双重编码），那么您的代码必须在输出时将其转换为 UTF-8。

在您的项目中搜索 function `utf8_encode`,`convert_to_utf8`或 just `iconv`or的用法`mb_convert_encoding`。跑步

```
$ grep -rn "\(utf8_\(en\|de\)code\|convert_to_utf8\|iconv\|mb_convert_encoding\)" . 
```

在您的应用程序的 /application 文件夹上应该足以找到一些东西。

另请参阅这些配置值：

```
<?php
var_dump(
    ini_get( "mbstring.http_output" ),
    ini_get( "mbstring.encoding_translation" )
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T02:23:33.367

要使浏览器正确显示。您应该检查三点：

1.  脚本文件的编码。
2.  连接的编码。
3.  数据库或表模式的编码。

如果所有这些都兼容，您将获得所需的页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-26T13:00:37.843

好吧，如果您绝对肯定地确定您的 mysql 客户端编码设置为`utf8`，则有两种可能的情况。一 - 双编码 - 由 Esailija 描述。

但是还有另一个：您的数据实际上是用 1251 编码的，而不是 utf-8 编码的。在这种情况下，您必须重新编码数据或在表上设置正确的编码。虽然它不是一个按钮推送任务
这里是一个手册（俄语）正是针对这种情况：[http ://phpfaq.ru/charset#repair](http://phpfaq.ru/charset#repair)

简而言之，您必须转储您的表，在表上使用相同的编码集（以避免重新编码），将该转储备份到安全的地方，然后更改表定义以反映实际编码，然后将其加载回来。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-28T05:25:26.227

经过2天的努力，终于解决了这个问题。感谢@yourcommonsense、@robsquires 和我的一个工作朋友提供帮助调试问题的好资源。

问题是在将 sql 文件转储到数据库（导入）时，服务器、数据库、客户端和连接的字符集被设置为`latin1`（`status`命令有助于解决这个问题）。所以命令行也设置`latin1`为，这就是它显示正确字符的原因，但与 PHP 代码的连接是 UTF8，它试图再次对其进行编码。以双重编码结束。

**解决方案**：

1.  `mysqldump`表格和数据（在 中`latin1`）
2.  转储数据库
3.  `/etc/my.cnf`如 Rob Squires 所述，将默认字符集设置为 UTF8
4.  重启mysql
5.  使用正确的字符集和排序规则再次创建数据库
6.  将文件转储回其中

它工作正常。

感谢大家的贡献！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-26T11:02:44.523

`mysql_set_charset('utf8')`mysql连接后试试 。然后它应该工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-26T00:47:47.793

可能这也可能是由于未安装 mbstring 扩展（这将解释您的开发环境和生产环境之间的差异）

看看这篇[文章](http://tympanus.net/codrops/2009/08/31/solving-php-mysql-utf-8-issues)，也许会给你更多的答案。

# html - CSS中的层次结构显示

> ID：14034861
> 
> 赞同：19
> 
> 时间：2012-12-26T00:05:50.690
> 
> 标签：html, css, html-lists

我在为分层显示（如文件和文件夹树）提出 CSS 时遇到了麻烦。我使用嵌套的无序列表：

```
<ul>
  <li>animals<ul>
    <li>dogs</li>
    <li>cats</li>
  </ul></li>
</ul> 
```

它们在适当的 CSS 减去连接线的情况下很好地显示。我需要线路连接。我使用以下 CSS 执行此操作：

```
ul ul li:before {
  content: "";
  padding: 15px;
  border: 1px solid #000;
  border-width: 0 0 1px 1px;
  border-radius: 0 0 0 10px;
  position: absolute;
  left: -22px;
  top: -15px;
} 
```

问题是线条与动物、狗和猫的图标重叠。我尝试将 z-index 更改为无效。有没有更好的方法来使用 CSS 实现这一点？还是有另一种方法可以使 z-index 有意义？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-26T01:35:49.300

看看这个例子。您可以轻松地将鲑鱼色框替换为图像：

![带有 css 示例的文件结构](../Images/527f4643e06027ea728a43bfcf182af3.png)

### HTML

```
<div>
    <h3>Root</h3>
    <ul>        
      <li>Folder 1
        <ul>
            <li>Folder 2
                <ul>
                    <li>file1.xml</li>
                    <li>file2.xml</li>
                    <li>file3.xml</li>
                </ul>
            </li>
            <li>file.html</li>
          </ul>
      </li>
      <li>file.psd</li>
      <li>file.cpp</li>
    </ul>
</div> 
```

### CSS

```
body {
    margin: 20px;
    line-height: 3;
    font-family: sans-serif;

}

div {
    position: relative;
}

ul {
    text-indent: .5em;
    border-left: .25em solid gray;
}

ul ul {
    margin-top: -1.25em;
    margin-left: 1em;

}

li {
    position: relative;
    bottom: -1.25em;
}

li:before {
    content: "";
    display: inline-block;
    width: 2em;
    height: 0;
    position: relative;
    left: -.75em;
    border-top: .25em solid gray;
}

ul ul:before, h3:before, li:after {
    content: '';
    display: block;
    width: 1em;
    height: 1em;
    position: absolute;
    background: salmon;
    border: .25em solid white;
    top: 1em;
    left: .4em;
}

h3 {
    position: absolute;
    top: -1em;
    left: 1.75em;
}

h3:before {
    left: -2.25em;
    top: .5em;
} 
```

## [演示](http://jsfiddle.net/JEPtg/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-26T00:31:43.413

[**jsFiddle 演示**](http://jsfiddle.net/tjgRB/)

有一个很棒的过时的[在线教程](http://jasongraphix.com/journal/merry-nested-list/)，可以完全满足您的需求。

它使用***图像***来创建独特的项目符号，但在您的情况下，您可以使用管道（即**`|`**）符号并指定具有所需颜色的较大字体大小。

**截屏：**
![](../Images/24ee66a0c310fbf80c2c4204d3d414bc.png)

**编辑：**

这是一个额外的 jsFiddle 复制您的弯曲连接线。

[**jsFiddle 演示 2**](http://jsfiddle.net/tjgRB/1/)

**编辑2：**

这是一个最终***修订***的jsFiddle 修订版，它添加了一个转义空间以在保持弯曲连接的同时获得更好的可视性。

[**jsFiddle 演示 3**](http://jsfiddle.net/tjgRB/3/)和[**3b**](http://jsfiddle.net/tjgRB/4/)

![](../Images/a8bb298973ed114aa6d794630bff1867.png)

**编辑 3：**这个*特殊*`content`的空白区域是上面演示中用于属性的选项：

```
Entity  Name Symbol/Description
&#8194; &ensp;   en space 
```

可以肯定的是，特殊空格是 Symbol 下 3 个空格的**中间**。使用它不需要使用替代字符加上透明度来*模拟空格*。删除透明度属性意味着 IE8 很高兴。以防万一，***下面的空行***包含 1 个**特殊的空格**字符。复制到剪贴板以使用`Entity`和`Name`不工作：

**EDIT 4:** Alternate for Edit 3 是检查为[**使用 CSS 内容添加 HTML 实体**](https://stackoverflow.com/q/190396/1195891)提供的 SO Answers 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T00:36:34.790

如果你想要一个简单的例子，我们去：

**HTML**

```
<ul>
  <li>animals
   <ul>
    <li>dogs</li>
    <li>cats</li>
  </ul></li>
</ul>​ 
```

**CSS**

```
li {
  border-left: 1px solid #000;
  margin-left: 10px;
  margin-top: 5px;
  padding-left: 10px;
}​ 
```

查看[jsFiddle 结果](http://jsfiddle.net/jasdeepkhalsa/XnNue/)

# javascript - 防止 HTML 画布对象选择

> ID：14034864
> 
> 赞同：1
> 
> 时间：2012-12-26T00:06:29.757
> 
> 标签：javascript, html, css

我正在使用交互式动画自定义我的主页，但无法让它在页面中看起来更加美观。请参阅[http://geotheory.co.uk/](http://geotheory.co.uk/)。我想在用户单击页面时停止选择画布对象。动画是一个[处理脚本](http://geotheory.co.uk/rectangles.pde)，然后被[翻译](http://geotheory.co.uk/processing-1.4.1.min.js)成 javascript。index.html 内容如下：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>geotheory.co.uk</title>
</head>
<body  id="home" bgcolor="#202020">
    <script src="processing-1.4.1.min.js"></script>
    <div id="canvasContainer">
    <canvas padding: 0 data-processing-sources="rectangles.pde"></canvas>
    </div>
</body> 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T01:55:37.817

它是导致它的 :focus 伪类。这应该解决它：

```
canvas:focus{
    outline:none;
} 
```

# java - Embedded Array Retrieval Mongodb Java

> ID：14034866
> 
> 赞同：0
> 
> 时间：2012-12-26T00:07:54.453
> 
> 标签：java, mongodb

I've been trying to get this query, but I have been unable to roll my heads over this one.

The Object looks like this:

```
{
   restaurantName:'abc',
   reviews:[
              {
                 text:'Its awesome!'
                 person: 'John Doe'
              }
              {
                 text:'Nice Ambience'
                 person: 'Davis'
              }

           ]
} 
```

The intent is to find out all the reviews text present in the document. How do I do this using JAVA driver for Mongo. I keep getting Class Cast Exceptions

Following is the code:

Set fields = new TreeSet();

```
BasicDBList e ;
    try {
        DBObject dbObject;
        while (cursor.hasNext()) {
        doc = new Document();
         e = (BasicDBList) cursor.next().get("reviews");
          for(BasicDBObject temp: e){
               fields.addAll(temp.keySet());
           }
        }
          //System.out.println(cursor.next());
        } 
```

The error I am getting is:

```
Exception in thread "main" java.lang.ClassCastException: com.mongodb.BasicDBObject cannot be cast to java.util.ArrayList at org.poly.darshan.utils.DataExtractor.main(DataExtractor.java:57) 
```

The code mentioned above intends to find the unique fields present in the sub-objects. But the problem is more or less the same.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T05:43:07.260

好的，找到了解决方案。就我而言，我知道字段名称，因此我可以检索 DBObject，然后检查每个字段名称并相应地对其进行类型转换以检索它。*想知道 Javascript 的仙境是多么自由。幸运的是，在 Java 中，我们几乎总是知道我们会得到什么。:)

解决方案如下所示：

```
while (cursor.hasNext()) {
        doc = new Document();
        e = cursor.next();
        for (String field : e.keySet()) {
            if (field.equals("reviews")) {
            BSONObject temp = (BSONObject) e.get(field);
            System.out.println(temp.toString());
            }
                 //else print the other String values
        }
} 
```

如果检索到 BSOONList，则相应地对其进行类型转换。BSONList 可能包含 BSONList 或 BSONObject，因此如果您不知道要检索什么，它会变得混乱。在这些情况下，动态类型转换很有帮助。

# c++ - How to (easily) wrap a c++ function unto an easy to install R 'package'

> ID：14034868
> 
> 赞同：0
> 
> 时间：2012-12-26T00:08:33.373
> 
> 标签：c++, r, eigen

Suppose I have an c++ code (see below for a simple example). I want to make it easy for a journal referee to install/run it.

So i figured the easiest way is to warp it unto a simplified R package-like tar.gz file so the referee could install it by simply invoking install.packages to a local .tar.gz file.

The reason for this is that i do not know what machine the referee is using, but i'm pretty sure the referee would know how to install a R packages so it's much easier for me to warp my code as a R 'package' --or at any rate, something sufficiently similar to it that it could be installed by a simple call to install.package().

An answer to a earlier [question](https://stackoverflow.com/a/5172509/189035) seems to suggest this is indeed possible. I followed the suggestions therein and created a /src directory with my cpp code (the one shown below) and a Makevars.win file containing:

```
## This assume that we can call Rscript to ask Rcpp about its locations
## Use the R_HOME indirection to support installations of multiple R version
#PKG_LIBS = $(shell $(R_HOME)/bin/Rscript.exe -e "Rcpp:::LdFlags()")
PKG_CPPFLAGS = -I../inst/include -I.
PKG_CXXFLAGS = -DEIGEN_DONT_PARALLELIZE $(SHLIB_OPENMP_CXXFLAGS)
PKG_LIBS = $(shell $(R_HOME)/bin/Rscript.exe -e "Rcpp:::LdFlags()") $(SHLIB_OPENMP_CXXFLAGS) 
```

and a Makevars file containing:

```
## Use the R_HOME indirection to support installations of multiple R version
#PKG_LIBS = `$(R_HOME)/bin/Rscript -e "Rcpp:::LdFlags()"` 
# This was created by RcppEigen.package.skeleton, but the R script that is 
# called creates error message:
# PKG_CPPFLAGS = `$(R_HOME)/bin/Rscript -e "RcppEigen:::RcppEigenCxxFlags()"`
PKG_CPPFLAGS = -I../inst/include
PKG_CXXFLAGS = -DEIGEN_DONT_PARALLELIZE $(SHLIB_OPENMP_CXXFLAGS)
PKG_LIBS = `$(R_HOME)/bin/Rscript -e "Rcpp:::LdFlags()"` $(SHLIB_OPENMP_CXXFLAGS) 
```

e.g. I simply followed the answer in the SO post to look around for how this is done in other packages (I also add RcppEigen to the list of dependencies because this guarantees that Eigen is installed on the target machine). I also created a /R directory containing the file MSE.R which contains:

```
fx01<-function(x){
    x<-as.matrix(x)
    Dp<-rep(0,ncol(x))
    fit<-.C("mse",as.integer(nrow(x)),as.integer(ncol(x)),as.single(x),as.single(Dp))
    as.numeric(fit[[4]])
} 
```

and an empty /inst/include and a /man directory containing a minimal (but valid) .Rd file. I've added a NAMESPACE file containing:

```
import(Rcpp)
import(RcppEigen)
useDynLib(MySmallExample) 
```

Here is the question:

*   the c++ function otherwise compiles/runs fine. Is there a way to warp it unto a R package so as to make it easy to install/run by a third person.

Here is the c++ code used for this example.

```
#include <algorithm>
#include <cstdlib>
#include <ctime>
#include <functional>
#include <fstream>
#include <iostream>
#include <math.h>
#include <time.h>
#include <stdio.h>
#include <stdlib.h>
#include <sstream>
#include <vector>

#include <Eigen/Dense>
#include <Eigen/LU>
#include <Eigen/SVD>

using namespace std;
using namespace Eigen;
using Eigen::MatrixXf;
using Eigen::VectorXf;

float median(VectorXf& x) {
    int n=x.rows();
    int half=(n+1)/2;   
    half--;                 
    float med;
    nth_element(x.data(),x.data()+half,x.data()+x.size());  
    if((n%2)==1){
        med=x(half);
    } else {
        float tmp0=x(half);
        float tmp1=x.segment(half+1,half-1).minCoeff(); 
        med=0.5*(tmp0+tmp1);
    }
    return med;
}
VectorXf fx01(MatrixXf& x){
    int p=x.cols();
    int n=x.rows();
    VectorXf Recept(n);
    VectorXf Result(p);
    for(int i=0;i<p;i++){
        Recept=x.col(i);
        Result(i)=median(Recept);
    }
    return Result;
}
extern "C"{
    void mse(int* n,int* p,float* x,float* medsout){
        MatrixXf x_cen=Map<MatrixXf>(x,*n,*p);  
        VectorXf MedsOut=fx01(x_cen);
        Map<VectorXf>(medsout,*p)=MedsOut.array();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T01:04:25.533

Have you read the `Writing R Extensions' manual about how to interface with R?

You are *of course* free to do this without Rcpp, but we wrote Rcpp for our use as we find that it makes these very interchanges easier. 94 packages on CRAN which use Rcpp appear to agree...

You are using Eigen, and you want this packaged for a third party ("a referee"). Now, if you were to use RcppEigen *you would assured that Eigen is present as it is inside RcppEigen*. With what you do, you're not...

Plus, `.C()` is a much more restrictive interface that `.Call()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T02:05:21.190

拥有正确的说明文件非常重要。我用过这个：

```
Package: MySmallExample
Type: Package
Title: MysmallExample
Version: 0.0.0
Date: 2012-12-24
Depends: Rcpp (>= 0.9.10)
Imports: RcppEigen (>= 0.2.0)
Suggests: mvtnorm
LinkingTo: Rcpp, RcppEigen
Description: A small minimal Package.
License: GPL (>= 2)
LazyLoad: yes
Authors@R: person("joe", "programer", email =
        "joe.programer@joe_inc.com", role = c("aut", "cre"))
Collate: 'MSE.R'
Packaged: 2012-12-24 12:34:56 UTC; andi
Author: joe programer [aut, cre]
Maintainer: joe programer <joe.programer@joe_inc.com>
Repository: CRAN
Date/Publication: 2012-12-24 12:34:56 
```

最重要的似乎是“整理：”字段：它应该正确列出 /R 目录中的所有 .R 文件。Depends & Imports 字段也应该与 NAMESPACE 文件一致。

文件 NAMESPACE 包含一行也很重要

```
export("fx01","fx02") 
```

其中 "fx01","fx02" 是 /R/*.R 文件中所有 R 函数的名称（在本例中，只是 fx01）。

然后，我将整个内容打包成一个 .tar.gz。跑了

```
install.packages("MySmallExample.tar.gz",repos=NULL,type="source")

> install.packages("/MySmallExample.tar.gz",repos=NULL,type="source")
Installing package(s) into ‘/R/x86_64-pc-linux-gnu-library/2.15’
(as ‘lib’ is unspecified)
* installing *source* package ‘MySmallExample’ ...
** libs
g++ -I/usr/share/R/include -DNDEBUG -I../inst/include  -I"/R/x86_64-pc-linux-gnu-library/2.15/Rcpp/include" -I"/R/x86_64-pc-linux-gnu-library/2.15/RcppEigen/include"  -DEIGEN_DONT_PARALLELIZE -fopenmp -fpic  -O3 -pipe  -g  -c MSE.cpp -o MSE.o
g++ -shared -o MySmallExample.so MSE.o -L/R/x86_64-pc-linux-gnu-library/2.15/Rcpp/lib -lRcpp -Wl,-rpath,/R/x86_64-pc-linux-gnu-library/2.15/Rcpp/lib -fopenmp -L/usr/lib/R/lib -lR
installing to /R/x86_64-pc-linux-gnu-library/2.15/MySmallExample/libs
** R
** inst
** preparing package for lazy loading
** help
*** installing help indices
** building package indices
** testing if installed package can be loaded

* DONE (MySmallExample) 
```

# c# - 字典 TryGetValue NullReferenceException

> ID：14034873
> 
> 赞同：4
> 
> 时间：2012-12-26T00:09:27.087
> 
> 标签：c#, .net, dictionary, nullreferenceexception

我`_dicCache.TryGetValue(objID, out newObject);` 在线上收到 NullReferenceException。我完全不知道为什么会发生这种情况。请来人指出正确的方向吗？

这是我的课：

```
public class Cache<T>
{
    public string Name { get; set; }

    private  Dictionary<int, T> _dicCache = new Dictionary<int, T>();

    public  void Insert(int objID, T obj)
    {
        try
        {
            _dicCache.Add(objID, obj);

            HttpContext.Current.Cache.Insert(Name, _dicCache, null, DateTime.Now.AddMinutes(10), TimeSpan.FromMinutes(0));
        }
        catch (Exception)
        {
            throw;
        }
    }

    public bool Get(int objID, out T obj)
    {
        _dicCache = (Dictionary<int, T>)HttpContext.Current.Cache.Get(Name);

        try
        {
            return _dicCache.TryGetValue(objID, out obj);
        }
        catch (Exception)
        {
            throw;
        }
    }
 } 
```

这就是我所说的：

```
 Services.Cache<Entities.User> cache = new Services.Cache<Entities.User>();
   cache.Name = Enum.Cache.Names.usercache.ToString();

   Entities.User user = new Entities.User();

   cache.Get(pUserId, out user); 
```

我还尝试将 Get 课程更改为：

```
 public T Get(int objID, out T obj)
    {
        _dicCache = (Dictionary<int, T>)HttpContext.Current.Cache.Get(Name);

        T newObject = (T)Activator.CreateInstance<T>();

        try
        {
            _dicCache.TryGetValue(objID, out newObject);

            obj = newObject;

            return obj;
        }
        catch (Exception)
        {
            throw;
        }
    } 
```

`_dicCache.TryGetValue(objID, out newObject);`但是我仍然在该行得到相同的 NullReferenceException 。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-26T00:26:57.480

我认为你可以有这个例外的唯一方法是如果你的字典是空的。

```
_dicCache.TryGetValue(objID, out newObject); 
```

`null`是键的有效参数（如果`TKey`是引用类型），但在您的情况下它是`int`.

你确定`_dicCache`不是`null`吗？我会检查分配的值：

```
_dicCache = (Dictionary<int, T>)HttpContext.Current.Cache.Get(Name); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T00:20:57.430

实际上将 _dicCache 放入 http 上下文缓存的方法是 insert 方法，该方法从未在您的代码中调用，因此当您尝试从 http 上下文中获取它时，您会得到 null（您只调用 Get）。

我会更改 Name 设置器以在那时将字典实际放入 http 上下文中，或者更好的是，如果您可以通过将 Name 属性作为构造函数参数以某种方式将字典插入到构造函数的缓存中。一般来说，我尝试以这样一种方式设计类，使它们在尽可能短的时间内处于“未初始化”状态。

# file - Bash 在脚本中执行部分行

> ID：14034876
> 
> 赞同：0
> 
> 时间：2012-12-26T00:10:32.397
> 
> 标签：file, bash, sh

我有一个文件，其中包含类似于以下命令：

```
cat /home/ptay89/test/01.out
cat /home/ptay89/testing/02.out
... 
```

但我只希望其中几个执行。例如，如果我只想查看以 1.out 结尾的输出文件，我可以这样做：

```
cat commands | grep 1.out | sh 
```

但是，对于命令文件中的每一行，我得到以下输出：

```
: cannot be loaded - no such file or directoryst/01.out 
```

当我直接从文件中复制并粘贴我想要的命令时，它工作正常。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T00:23:11.780

您的文件中可能有虚假的回车符（在 Windows 下创建？）。使用`tr`而不是`cat`删除它们：

```
tr -d '\015' <commands | grep 1.out | sh 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T00:35:53.807

尝试做一个

```
grep -e '^cat.*out' commands | grep 1.out | sh 
```

那应该忽略任何奇怪的字符，只取你需要的字符。

# cakephp - cakephp 渲染 + afterfilter 变量未设置

> ID：14034886
> 
> 赞同：1
> 
> 时间：2012-12-26T00:11:40.697
> 
> 标签：cakephp, variables, render, cakephp-2.1

我正在尝试对我的应用程序中的特定操作名称使用渲染。实际上，这是我在 AppController::afterFilter() 中设置的条件

```
 if($this->action == 'parameter') {
        $this->render('/Elements/parameter');
    }
    else if($this->action == 'datagrid') {
        $this->render('/Elements/datagrid');
    } 
```

在我的控制器中`/samples/parameter`：

```
 $this->set('model', Inflector::singularize(Inflector::camelize($this->name)));
        $this->set('controller', $this->name);
        if($parameter_id) {
            $this->set('mode', $mode);
            $this->set('parameter', $this->Sample->find('first', array('conditions' => array('Sample.id' => $parameter_id))));
        } else {
            $this->set('mode', 'add');
            $this->set('parameter', array());
        } 
```

我知道我必须在变量定义之后渲染，所以我使用了`afterFilter`一些我不理解或错过的东西？

**信息：** 我已在`Samples Controller`功能中设置

```
 public function afterFilter(){
        parent::afterFilter();
    } 
```

谢谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T03:10:20.070

渲染过程完成**后**`afterFilter()`调用回调，因此在其中调用是错误的。**`render()`**

 **如果要更改要呈现的视图，请在`beforeRender()`. 所以做类似的事情

```
if ($this->action == 'parameter') {
    $this->view = '/Elements/parameter';
} elseif ($this->action == 'datagrid') {
    $this->view = '/Elements/datagrid';
} 
```**

# mysql - 在 MySQL 中使用序列号和空格进行分组以重复值

> ID：14034891
> 
> 赞同：1
> 
> 时间：2012-12-26T00:12:59.827
> 
> 标签：mysql, sql, report

我想像这样从资源表创建报告

```
docid|col5 |  item     | qty | price |
------------------------------------------
doc1 |  a  |   item1   | 4   | 100   | 
doc1 |  a  |   item2   | 5   | 20    |
doc2 |  a  |   item3   | 10  | 20    |
doc2 |  a  |   item4   | 11  | 20    | 
```

变成这样

```
no | docid  |   item    | qt  | price |
------------------------------------------
1  |  doc1  |   item1   | 4   | 100   |
   |        |   item2   | 5   | 20    |
2  |  doc2  |   item3   | 10  | 20    |
   |        |   item4   | 11  | 20    | 
```

任何人都可以帮助我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T01:52:28.163

下面的查询将执行您想要的操作。它具有三个特殊功能。

1.  首先，它使用递增的`@docIdNumber`用户变量来生成序列号 (1,2) 以伴随 (doc1,doc2)。这是在 MySQL 中执行此操作的一种方法。

2.  其次，它使用`@prevDocId`用户变量来跟踪项目是否仍与前一行相同。如果是，它会打印 ''，而不是值。

3.  最后，请注意不寻常地使用 INNER JOIN 将用户变量初始化为 0 或 ''。这是初始化这些变量的技巧。这就是它所做的一切。

如果您想进行实验，整个事情都在[http://sqlfiddle.com/#!2/99899/61 。](http://sqlfiddle.com/#!2/99899/61)

```
SELECT 
  IF(t.docid=@prevDocId,'',number) as number,
  IF(t.docid=@prevDocId,'',@prevDocId:=t.docid) AS docid,
  item,qty,price
FROM
( 
  SELECT DISTINCT docid,item,qty,price
  FROM theTable
  ORDER BY docid
) AS t
INNER JOIN
(
  SELECT @docIdNumber := @docIdNumber + 1 as number, docid
  FROM
  (
    SELECT docid
    FROM theTable
    GROUP BY docid
  ) t
  INNER JOIN (SELECT @docIdNumber := 0) as initializerOnly1
) docIdNumbers ON t.docid = docIdNumbers.docid
INNER JOIN (SELECT @prevDocId := '') as initializerOnly2 
```

# c - waitpid 在不应该阻塞时阻塞

> ID：14034895
> 
> 赞同：12
> 
> 时间：2012-12-26T00:13:57.303
> 
> 标签：c, linux, shell, signals, wait

我正在写一个迷你外壳（不，不是为了学校：P；为了我自己的乐趣），现在大部分基本功能已经完成，但是在尝试处理 SIGTSTP 时我被卡住了。

假设当用户按下 时`Ctrl+Z`，SIGTSTP 应该被发送到 shell 的 Foreground 进程（如果存在），并且 Shell 应该正常继续。

创建每个进程后（如果是前台进程），下面的代码等待：

```
if(waitpid(pid, &processReturnStatus, WUNTRACED)>0){//wait stopped too
    if(WIFEXITED(processReturnStatus) || WIFSIGNALED(processReturnStatus))
        removeFromJobList(pid);
} 
```

我正在按如下方式处理信号：

```
void sigtstpHandler(int signum)
{
    signum++;//Just to remove gcc's warning
    pid_t pid = findForegroundProcessID();
    if(pid > -1){
        kill(-pid, SIGTSTP);//Sending to the whole group
    }
} 
```

发生的情况是，当我按下 时`Ctrl+Z`，子进程确实被挂起（`ps -all`用于查看进程的状态）但我的 shell 挂在`waitpid`它永远不会返回，即使我传递了`WUNTRACED`标志，据我所知，它应该`waitpid`在该过程也停止了。
那么我可能做错了什么？还是我错误地理解了waitpid的行为？

注意：
-findForegroundProcessID() 返回正确的 pid；我仔细检查了那个。
- 我在我之后更改每个进程的组 - 处理工作正常- 如果我在我的外壳挂起后使用另一个终端发送 SIGCONT，子进程将恢复其工作，外壳最终会获得它`fork`
。 -我正在捕获 SIGTSTP，据我阅读（和测试）可以捕获它。- 我尝试使用 waitid 而不是 waitpid 以防万一，问题仍然存在。 **编辑：**`Ctrl+C`

 **```
void sigchldHandler(int signum)
{
    signum++;//Just to remove the warning
    pid_t pid;
    while((pid = waitpid(-1, &processReturnStatus, 0)) > 0){    
        removeFromJobList(pid);
    }
    if(errno != ECHILD)
        unixError("kill error");
} 
```

我的 SIGCHLD 处理程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T00:55:17.620

`SIGCHLD`为停止的儿童提供。*信号处理程序中*的`waitpid()`调用- 未指定- 永远阻塞。 *`WUNTRACED`*

 *您可能不应该`removeFromJobList()`在两个不同的地方进行处理。如果我不得不猜测，听起来它涉及全局数据结构，并且不属于信号处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T09:45:56.107

Waitpid 没有返回，因为您没有设置 sigchld 处理程序（我之前发送给您）。你有没有得到收获的子进程。此外，waitpid 需要处于 while 循环中，而不是 if（也发送给您）。

您应该捕获的唯一信号是 SIGCHLD。原因是如果你的进程被正确地分叉，内核会将该信号发送到前台进程，并且它将终止它或停止它或执行任何正确的信号。

当进程组设置不正确时，信号将被发送到错误的进程。一种测试方法是运行前台进程并按 Ctrl-Z。如果您的整个外壳都存在，那么 Ctrl-Z 信号将被发送到整个外壳。这意味着您没有在新进程组中设置新进程并给它一个终端。

现在，如果您的 Ctrl-Z 信号正在停止您的整个 shell，您需要执行以下操作。一旦你 fork 一个进程，在子进程中： - 使用 setpgid 在它自己的组中设置进程。- 通过阻止 SIGTTOU 给它一个健全的终端，然后使用 tcsetpgrp 给它一个终端。

在父进程中： - 还使用 setpgid 设置其子进程。这是因为您不知道是孩子还是父母先执行，所以这避免了竞争条件。设置两次并没有什么坏处。***

# windows - SetParent() (win32)

> ID：14034896
> 
> 赞同：1
> 
> 时间：2012-12-26T00:14:11.487
> 
> 标签：windows, winapi, user-interface

任何想法如何使用 SetParent()？

以下似乎不起作用：

```
fhWnd = FindWindow(_T("Notepad"), NULL);

hWnd = CreateWindowEx(WS_EX_TOPMOST , _T("test"), _T("test"),
        WS_POPUP,
        20, 20, 400, 400, NULL, NULL, hInst, NULL);

 SetParent(hWnd, fhWnd);

 DWORD style = GetWindowLong(hWnd, GWL_STYLE);
 style = style & ~(WS_POPUP);
 style = style | WS_CHILD | WS_VISIBLE | WS_CLIPCHILDREN | WS_CLIPSIBLINGS;
 SetWindowLong(hWnd, GWL_STYLE, style);
 SetWindowLong(fhWnd, GWL_STYLE, GetWindowLong(fhWnd, GWL_STYLE) | WS_CLIPCHILDREN); 
```

使用上面的代码，我必须将父窗口移出屏幕并再次移回，以便查看子窗口上绘制的内容。

知道我做错了什么吗？

# javascript - 尝试从解析中提取数据并使用 underscore.js 渲染得到空的字段

> ID：14034897
> 
> 赞同：0
> 
> 时间：2012-12-26T00:14:29.877
> 
> 标签：javascript, underscore.js, parse-platform

尝试从 parse.com 提取数据并使用 underscore.js 我尝试使用它来构建数据表。当我使用硬编码的 json 运行它时，它可以工作，但是当我尝试使用提取的数据运行它时，它会返回一个空表。

```
 Parse.initialize("", "");

        var allDeals = Parse.Object.extend("Deal");
        var query = new Parse.Query(allDeals);

        query.find({
            success: function(results){

                var deals = JSON.stringify(results); 

             var template = $("#usageList").html();
             $("#target").html(_.template(template,{deals:deals}));

            },
            error: function(error) {
                alert('something was wrong');
            }
        }); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T13:05:10.707

就像@mu 说的那样，查看结果中的内容会更容易。但我之前用 Parse 遇到过这个问题。猜一猜..你可以试试这个

```
$('#target').html(_.template(template, { deals: results.models })); 
```

“结果”是一个主干集合，“模型”包含您所追求的对象数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T00:44:56.030

`results`大概您在`success`回调中获得了某种 JavaScript 对象。然后将其序列化为 JSON 字符串：

```
var deals = JSON.stringify(results); 
```

这给你留下了一个字符串，`deals`你的模板可能不知道如何处理一个字符串，它可能需要一个对象或任何一开始就存在`results`的东西。尝试跳过字符串化并`results`直接输入模板：

```
$('#target').html(_.template(template, { deals: results })); 
```

# c# - 在 C# 中计算（复杂的）十进制数数组

> ID：14034898
> 
> 赞同：5
> 
> 时间：2012-12-26T00:15:03.553
> 
> 标签：c#, arrays, list, math, arraylist

我有一个列表框，用户可以在其中输入十进制数字。假设他们将输入 5 个数字：

```
1.1
1.2
1.3
1.4 
1.5 
```

我需要得到这 5 个数字中所有变化的总和。例如`1.1 and 1.2`then和`1.1 1.2 1.3`then的总和。`1.1 1.2 1.3 1.4``1.2 1.4 1.5``1.1 1.3 1.5`

我开始了一些事情，但是经历了所有变化，一次只跳过一个数字：

```
List<Double[]> listNumber = new List<double[]>();            
Double[] array;            
for (int i = 0; i < listBox1.Items.Count; i++)
{
    array = new Double[listBox1.Items.Count];                
    for (int k = 0; k < listBox1.Items.Count; k++)
    {
        if (!k.Equals(i))
        {
            array[k] = (Convert.ToDouble(listBox1.Items[k]));                       
        }
    }
    listNumber.Add(array);
} 
```

我需要找到一种方法来计算我想要的方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T01:17:00.113

只是我在手机上的大纲：

从您的输入列表和包含零的输出列表开始。

对于输入中的每个数字，通过将当前输入数字添加到当前输出列表中的每个数字来创建一个新的双精度列表；然后将此列表连接到输出列表的末尾。

（可选）删除每个输入数字的零和第一个实例，以及任何重复项：

例如，对于您的示例输入高达 1.4：

```
0
0 1.1
0 1.1 1.2 2.3
0 1.1 1.2 2.3 1.3 2.4 2.5 3.6
0 1.1 1.2 2.3 1.3 2.4 2.5 3.6 1.4 2.5 2.6 3.7 2.7 3.8 3.9 5.0
         1.2 2.3      2.4 2.5 3.6         2.6 3.7 2.7 3.8 3.9 5.0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T01:31:40.827

在您最初的尝试中，您的代码仅计算所有可能对的总和。从您的描述中，您还想找到三个数字的总和等。

如果总是有 5 个十进制数，那么你可以简单地有 5 个 for 循环。然而，更通用的设计会更干净

```
double[] input = double[5]; //Pretend the user has entered these
int[] counters = int[input.Length]; //One for each "dimension"
List<double> sums = new List<double>();

for (int i = 0; i < counters.Length; i++)
   counters[i] = -1; //The -1 value allows the process to begin with sum of single digits, then pairs, etc..

while (true)
{
    double thisSum = 0;
    //Apply counters
    for (int i = 0; i < counters.Length; i++)
    {
        if (counters[i] == -1) continue; 

        thisSum += input[counters[i]];
    }

    //Increment counters
    counters[0]++; //Increment at base
    for (int i = 0; i < counters.Length; i++)
    {
        if (counters[i] >= counters.Length)
        {
            if (i == counters.Length - 1) //Check if this is the last dimension
               return sums; //Exhausted all possible combinations

            counters[i] = 0;
            counters[i+1]++;
        }
        else
           break;
    }
} 
```

这里没有任何代码来避免两次添加相同的数字（我会让你尝试完成它。提示：你可以在增量计数器部分之后简单地这样做，包含“增量计数器”部分和while 循环内的新“检查计数器”部分，当计数器唯一时在 while 循环外中断...

注意：我还没有测试过这段代码，但它会很接近，并且可能会有一两个错误 - 如果您需要任何关于错误的帮助，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T00:38:42.753

虽然我对 C# 不是很精通，但我确信有一种更简单的方法可以做你想做的事；当然，除非我错过了一些东西。

为什么不为 List 或 Array 中的每个元素创建一个 for 循环，然后告诉它自己跳过。例子：

```
Double[] array = new Double[3];
array[0] = 1,1;
array[1] = 1,2;
array[2] = 1,3;

Double sum = 0;

for ( int i = 0; i < array.Length ; i++ )
{
    for ( int x = 0 ; x < array.Length ; x++ ) {
        if ( array[i] != array[x] )
        {
            sum = array[x] + array[x+1] // or [x-1] depending on the value of x, you should be able to work this out.   
        }
    }
} 
```

通过查看这个示例，您应该能够理解我的意思。当然，这是一个非常基本的原型，您要做的是将其扩展以根据 x 的值向后检查，并使用多个“总和”变量来存储总和 - 取决于您的结果类型寻找。

- 我希望这会有所帮助，圣诞快乐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T07:59:41.720

拿你的`listBox`and，在每个数字前面，要么用 a`0`表示它*不会*参与你的总和，要么用 a`1`表示*它将*参与你的总和。使用您的示例列表`1.1`, `1.2`, `1.3`,和 的总和`1.4`,那么那么那么这会给您（为了清楚起见，我只写s ，空格表示）：`1.5``1.1``1.2``1.1 1.2 1.3``1.1 1.2 1.3 1.4``1.2 1.4 1.5``1.1 1.3 1.5``1``0`

```
 |     |     | 1.1 |     |
         |     | 1.1 | 1.2 | 1.2 | 1.1
         |     | 1.2 | 1.3 | 1.4 | 1.3
     1.1 | 1.2 | 1.3 | 1.4 | 1.5 | 1.5
---+-----+-----+-----+-----+-----+-----
1.1|  1           1     1           1
1.2|        1     1     1     1
1.3|              1     1           1
1.4|                    1     1
1.5|                          1     1 
```

正如您现在看到的那样，列出这些数字的所有组合现在类似于从 0 计数到 31（二进制中的 11111，`2⁵ - 1`）。如果您对空序列不感兴趣，则从 1 开始计数。

这是将此计数转换为`listNumber`您想要的样例的示例代码。请原谅语法，因为我不懂 C#。这也意味着这是未经测试的代码。

```
Double[] array = new Double[listBox1.Items.Count];
for (int i = 0; i < listBox1.Items.count; i++)
    array[k] = Convert.ToDouble(listBox1.Items[i]);
int count = 2 ^ array.Items.Count;
List<Double>[] listNumber = new List<Double>[count];
for (int i = 0; i < listNumber.Items.Count; i++) {
    listNumber[i] = new List<Double>();
    for (j = 0; j < array.Items.Count)
        if (i & (1 << j) != 0)
            listNumber[i].Add(array[j]);
} 
```

# c# - C# 多线程递增

> ID：14034902
> 
> 赞同：1
> 
> 时间：2012-12-26T00:16:29.193
> 
> 标签：c#, multithreading, increment

我正在尝试制作一个基本上很重要的应用程序（并在此过程中学习 C#）。越快越好。

这就是为什么最初我在考虑多线程的原因。但是，在我看来，这是不可能的，因为多线程的全部意义在于同时并行运行代码，对吧？

那么，我可以使用多个线程吗？或者有什么一般提示可以让它更快地增加？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T00:21:44.027

您必须划分数字范围。例如，不是在一个线程中从 0 递增到 999'999，而是让四个线程从 0 递增到 249'999、从 250'000 到 499'999、从 500'000 到 749'999 以及从 750'000 到 999 '999 分别。

并看看[Task Parallelism (Task Parallel Library)](http://msdn.microsoft.com/en-us/library/dd537609.aspx)。

不要犯错误来创建增加一次的一百万个任务！多任务处理的开销实际上会大大减慢这个过程。如果每项任务都必须执行大量工作，您实际上只能提高速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T01:11:41.613

为了获得最佳性能，对于单个变量的简单递增，我会使用经常被忽视的[Interlocked](http://msdn.microsoft.com/en-us/library/system.threading.interlocked.aspx)类。

```
private long SingleVariable = 0;
public void MultiThreadedMethod()
{
   Interlocked.Increment(SingleVariable);
} 
```

尽管在这个简单的示例中，多线程不会带来明显的好处，但性能方面是明智的，因为我预计缓存（缓存一致性网络）带宽会成为这种情况下的瓶颈。

然而，这种模式在多线程世界中通常很有用，其中多个线程可能正在完成一个工作单元，然后增加一个中央计数器以跟踪线程的总进度。互锁的替代方法是使用 Monitor.Enter（或 C# 中的 lock 关键字），这会相对较慢。

# c++ - 代码“ENTER”在VC++中缓冲串口

> ID：14034906
> 
> 赞同：1
> 
> 时间：2012-12-26T00:16:54.230
> 
> 标签：c++, serial-port

我需要输入代码以通过串口发送，我使用 Visual C++ 2010。

```
sprintf_s(bufff,"X");    //code X
oSerial.WriteData(bufff,1); Sleep(500);

sprintf_s(bufff,"\n\r");    // code "enter"
oSerial.WriteData(bufff,1); Sleep(500);

sprintf_s(bufff,"A"); //code A   
oSerial.WriteData(bufff,1); Sleep(500); 
```

我通过以下方式阅读结果：

```
 oSerial.ReadData(buf,500);Sleep(500);
 printf("N: %s \n",buf);Sleep(10000); 
```

结果是：

```
 N:XA 
```

所以我认为我输入的“输入”代码是错误的，有人可以回答吗？

# php - PHP 自动包含

> ID：14034907
> 
> 赞同：11
> 
> 时间：2012-12-26T00:17:15.130
> 
> 标签：php

我想在服务器的每个执行中自动包含一个 PHP 脚本，我希望通过 PHP ini、设置或能够在 php 中编写一个简单的扩展并包含我的 php 脚本。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-26T00:20:44.743

您可以`auto_prepend_file`在文件中设置指令`php.ini`：

[http://php.net/manual/en/ini.core.php#ini.auto-prepend-file](http://php.net/manual/en/ini.core.php#ini.auto-prepend-file)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-26T00:21:32.993

如果运行 Apache 并且可以访问 .htaccess 您可以执行以下操作，否则请查看 @Lock 的答案

```
prepend.php:
<?php
echo "<p>this is the prepended file</p>\n";

main.php:
<?php
echo "<p>this is the main file</p>\n";

append.php:
<?php
echo "<p>this is the appended file</p>\n"; 
```

并使用以下说明添加 prepend.php 和 append.php，当调用 main.php 时，将从脚本中输出以下内容：

```
<p>this is the prepended file</p>
<p>this is the main file</p>
<p>this is the appended file</p> 
```

并使用以下说明添加 prepend.php 和 append.php，当调用 main.php 时，将从脚本中输出以下内容：

```
<p>this is the prepended file</p>
<p>this is the main file</p>
<p>this is the appended file</p> 
```

前置脚本

要添加一个文件以便在主脚本之前对其进行解析，请将以下设置添加到 .htaccess 文件、php.ini（这当然会影响所有网站）或配置：

```
php_value auto_prepend_file prepend.php 
```

不需要包含路径，但如果不是，则它将使用包含路径来查找它。如果脚本所在的包含路径或目录中没有此文件的副本，这可能会导致类似“警告：未知：无法打开流：第 0 行的未知中没有此类文件或目录”之类的错误。所以最好获得前置文件的完整路径。附加脚本

这与添加脚本几乎相同，并且适用相同的注释。追加文件的方法如下：

```
php_value auto_append_file append.php 
```

覆盖设置，因此没有任何内容被预先或附加

如果您需要覆盖现有的 auto_append_file 或 auto_prepend_file 设置，您可以通过将值设置为“none”来执行此操作，如下所示：

```
php_value auto_prepend_file none
php_value auto_append_file none 
```

如果您希望 .htaccess 在网站的根级别设置附加/前置文件，但又希望特定子目录不执行附加或前置操作，这可能很有用。您将在该子目录中创建一个新的 .htaccess 文件，如上所述将它们设置为 none。

来源：[http ://www.electrictoolbox.com/php-automatically-append-prepend/](http://www.electrictoolbox.com/php-automatically-append-prepend/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-26T00:22:41.507

如果您在 Apache 上并且可以使用，另一种解决方案是使用`.htaccess`. 我添加一行：

`php_value include_path "/var/www/mysite.com/config"`

然后在我的 PHP 文件中，我可以包含

`include_once('someconfig.php');`

看起来在`/var/www/mysite.com/config/`. 诚然，我在不知道自动前置解决方案的情况下完成了这项工作——它看起来更清洁、更高效。

# javascript - 如何计算相同类型元素的宽度直到某个元素

> ID：14034918
> 
> 赞同：0
> 
> 时间：2012-12-26T00:20:44.803
> 
> 标签：javascript, jquery, loops

HTML：

```
<li class="home"><a href="/"><img alt="home" src="img/gohome.png"/></a></li>
<li class="portfolio closed" ><a href="portfolio"><span>portfolio</span></a></li>
<li class="articles opened" style="margin-right: 849px;"><a href="articles"><span>articles</span></a></li>
<li class="contact"><a href="contact"><span>contact</span></a></li> 
```

JS：

```
 $('nav li').each(function(index) { //Navigation total width
         navWidth += $(this).width();
    }); 
```

我有类似的脚本，但我还必须计算 Li 元素的宽度，直到某些基于类的特定元素。文件夹。而且我不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T00:31:00.200

另一个选项[`nextUntil()`](http://api.jquery.com/nextUntil/)：

```
$("nav li:first").nextUntil(".portfolio").andSelf().each(function(index) {
     navWidth += $(this).width();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T00:25:14.907

一种方法是在遇到具有该类的元素时退出循环：

```
$('nav li').each(function() {
     if ($(this).hasClass('portfolio')) {
         return false;
     }
     navWidth += $(this).width();
}); 
```

另一种方法是只选择所有元素，直到具有 class 的元素`portfolio`。这可以通过获取所述元素的索引并选择直到该索引的所有元素来完成：

```
var $lis = $('nav li');

$lis.slice(0, $lis.filter('.portfolio').index()).each(function() {
    // ...
}); 
```

这是假设所有这些`li`元素都是彼此的兄弟姐妹。

**参考：** [`.each`](http://api.jquery.com/each/) , [`.filter`](http://api.jquery.com/filter/),[`.slice`](http://api.jquery.com/slice/)

# c# - 字典 , WP8

> ID：14034921
> 
> 赞同：1
> 
> 时间：2012-12-26T00:21:22.597
> 
> 标签：c#, windows, windows-phone-8

我正在尝试为 Windows Phone 8 创建一个带有字符串/图像键/值的字典。

我了解字典的工作原理，但不确定我将使用哪种类型的图像。

本质上，我正在尝试创建 26 个图像，每个字母 1 个，以便苹果对应于一个苹果的图像。

不过，我对如何在 WP8 上执行此操作感到困惑，因此将不胜感激任何正确方向的指导

**更新：**谢谢你的回答。我仍然必须在这里做错事。例如：

```
 //Set up the dictionary of AlphaImages objects. 
    if (AlphaImages == null)
    {
        AlphaImages = new Dictionary<string, BitmapImage>();
        AlphaImages.Add("Apple", new BitmapImage(@"Apple.jpg"));
    } 
```

它声称我对 BitmapImage 使用了无效的参数。 [跟随这个线程，](https://stackoverflow.com/questions/9963706/adding-multiple-bitmap-values-for-one-key-in-dictionary-with-c-sharp)用户对这段代码采取了不同的方法：

```
Dictionary<string, Bitmap> lookup = new Dictionary<string, Bitmap>();
lookup.Add("A", new Bitmap(@"C:\08\letters\1\a1.bmp", true)); 
```

而且我无法让它正常工作，因为编译器会吐出同样的错误。

我可能做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T19:10:39.630

尝试：

AlphaImages.Add("Apple", new BitmapImage(new Uri("Apple.jpg", UriKind.Relative)));

确保图像设置为具有内容的构建操作。

空气编码。:)

另外，请看[这里](http://blogs.msdn.com/b/swick/archive/2011/04/07/image-tips-for-windows-phone-7.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T03:47:14.303

您正在寻找[`BitmapImage`课程](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapimage%28v=vs.95%29.aspx)。

# css - CSS - 如何排列按钮？

> ID：14034922
> 
> 赞同：0
> 
> 时间：2012-12-26T00:21:31.497
> 
> 标签：css

我正在尝试创建一个包含多行的表单。每行都有一个可选输入字段，后跟一个必填按钮。按钮应垂直排列 - 如下所示：

```
_____________  _______________
|  input 1  |  |   button 1  |
|___________|  |_____________|
               _______________
               |   button 2  |
               |_____________| 
```

我试图以固定的左边距使按钮向左浮动，但这样做会将输入字段移动到按钮的右侧 - 即使输入字段首先出现在标记中：

```
<div>
    <input type="text">
    <button>Action 1</button>
</div> 
```

请[在此处](http://jsfiddle.net/nareshbhatia/EeNFH/)查看我的 jsfiddle 。为什么会发生这种情况，正确的解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:03:41.883

Here's an alternative, the margins and colors may need modification. See jsfiddle link for sample result.

It has a left-aligned label and right-aligned input (button style) in a div, for each line. The non-breaking space is needed as a placeholder in the span element that represents an "empty label".

[http://jsfiddle.net/qallar/kfgCb/5/](http://jsfiddle.net/qallar/kfgCb/5/)

The html is:

```
<div class='line'>
  <span class='formlabel'>label 1</span>
  <input class='formbutton' type='button' value='button 1 text ' />
</div>

<div class='line'>
  <span class='formlabel'>&nbsp;</span>
  <input class='formbutton' type='button' value='button 2 text' />
</div> 
```

and the css:

```
.line
{
  display: block;
  background-color: #ddd; /* also try #fff */
  margin: 0px;
  padding: 2px;
  height: 30px;
  width: 200px;    
}

.formlabel
{
  float: left;
  background-color: #eee; /* also try #fff */
  margin: 0px;
  padding: 2px;
  width: 75px;
  height: 100%;
  clear: both;    
}

.formbutton
{
  float: right;
  background-color: #0f0;
  margin: 0px;
  padding: 0px;
  width: 100px;
  height: 100%;    
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T06:28:27.217

输入字段飞到按钮的右侧，因为它是一个内联元素。浮动仅适用于块元素，内联元素将始终围绕浮动元素流动。这解释了原始 jsFiddle 中的行为。

话虽如此，即使我将 display:block 放在输入元素上，它仍然表现得像内联。不过，我能够使基本概念适用于 div，这是一个真正的块元素。[请参阅此处](http://jsfiddle.net/nareshbhatia/qwFbC/)的 jsFiddle 。

```
<div class="row">
    <button>Action 1</button>
    <div class="in"></div>
</div>

.row {
    clear: both;
}

.in {
    background-color: green;
    height: 24px;
    width: 100px;
}

button {
    float: left;
    margin-left: 110px;
    width: 150px;
} 
```

唯一的解决方法似乎是 Musa 提供的一种解决方法（参见[这个 jsFiddle](http://jsfiddle.net/EeNFH/7/)），他使用 text-align 将按钮向右对齐并限制 div 的宽度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T00:28:45.967

使用行。

```
<div class="row-rap">
    <div class="right">
        <input type="text">
    </div>
    <div class="left">
        <input type="button" value="Action 1">
    </div>
</div>
<div class="row-rap">
    <div class="right">
        <input type="text">
    </div>
    <div class="left">
        <input type="button" value="Action 2">
    </div>
</div>​ 
```

使用以下样式。

```
div.row-rap {
    width: 100%;
}
div.row-rap .right, div.row-rap .left {
    width: 50%;
    float: left;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T00:31:04.377

您需要 div 容器来执行此操作，如此[jsFiddle](http://jsfiddle.net/npuLj/)所示。

**HTML 代码**

```
<div class="container">
    <div class="left">
        <button>
    </div>
    <div class="right">
        <button>
    </div>
</div> 
```

**CSS 代码**

```
.container {
    width: 190px;
    height: 22px;
    margin: 0;
}

.left {
    float: left;
    width: 95px;
    height: 22px;
}

.right {
    float: right;
    width: 95px;
    height: 22px;
} 
```

​</p>

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-03T17:38:31.663

我不是 CSS 专家，通常这项任务适用于我使用表格

```
<table>
<tr><td>Optional Input</td><td>Button</td></tr>
<tr><td>Optional Input</td><td>Button</td></tr>
</table> 
```

如果由于某种原因表格不是一个选项，您可以使用 div/span

```
<div style="display: table-row">
<span style="display: table-cell">Optional Input</span>
<span style="display: table-cell">Button</span>
</div> 
```

大概是这样的

[![在此处输入图像描述](../Images/870d597c1700d78f26d5919c1974cbf9.png)](https://i.stack.imgur.com/ZYXJ3.jpg)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-12-26T03:15:48.110

using Block formatting context [https://developer.mozilla.org/en-US/docs/CSS/Block_formatting_context](https://developer.mozilla.org/en-US/docs/CSS/Block_formatting_context)

jsfiddle code: [http://jsfiddle.net/EeNFH/9/](http://jsfiddle.net/EeNFH/9/)

the html code:

```
<div class="inp">
    <input type="text">
</div>
<div class="btns">
    <p><button>Action 1</button></p>
    <p><button>Action 2</button></p>
</div> 
```

and the styles:

```
input {
    width: 100px;
}

button {
    width: 150px;
}

.inp{
    float:left;
}

.btns{
    overflow:hidden;
}
​ 
```

# ruby-on-rails - 在控制台中有价值，但在我的控制器和视图中为零？

> ID：14034925
> 
> 赞同：0
> 
> 时间：2012-12-26T00:22:11.610
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我有这种奇怪的行为，我不明白为什么。事情是这样的：

我的付款模式中有此记录：

```
1.9.3p286 :019 > u.payment.last
  Payment Load (0.3ms)  SELECT "payments".* FROM "payments" WHERE "payments"."user_id" = 10
 => [#<Payment id: 37, bank_name: "Mercantil", plan: "Plan Uno", date: "2012-12-25", reference_number: "3452435", coupon: "", user_id: 10, created_at: "2012-12-25 21:56:12", updated_at: "2012-12-25 21:58:31", active_until: "2013-01-24">] 
```

如您所见，我的用户有一条记录：10。

如果我尝试在我的控制器中获取相同的信息，我不会得到任何异常，但是

```
@user.payment.last.active_until 
```

是空的，在视图中也是一样的。

例如，如果我在我看来尝试这个：

```
<%= @user.payment.last.active_until %> 
```

什么都没有，一片空白。

如果我试试这个

```
<%= @user.payment %> 
```

我和我的控制台一样

```
[#<Payment id: 37, bank_name: "Mercantil", plan: "Plan Uno", date: "2012-12-25", reference_number: "3452435", coupon: "", user_id: 10, created_at: "2012-12-25 21:56:12", updated_at: "2012-12-25 21:58:31", active_until: "2013-01-24">, #<Payment id: nil, bank_name: nil, plan: nil, date: nil, reference_number: nil, coupon: nil, user_id: 10, created_at: nil, updated_at: nil, active_until: nil>] 
```

我真的不明白这里发生了什么。请提供任何帮助。

提前致谢。

PD：用户可以有很多付款，但我只需要最后一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T00:30:46.860

它与您的控制台中的不同。在控制台中，您得到一条记录，但在视图中，您得到两条记录——您在控制台中看到的记录，以及另一条空白记录。

我猜空白的那个是您`form`用于创建新`Payment`记录的表单的标签助手的那个，但这也是`last`返回的那个。要么取最后一个，要么在调用之前过滤已保存的记录`last`。

# php - Facebook PHP SDK会话变量未通过

> ID：14034928
> 
> 赞同：1
> 
> 时间：2012-12-26T00:23:17.207
> 
> 标签：php, facebook, session, facebook-graph-api

fbconnect.php

```
include('functions.php');
connect();

require 'src/facebook.php';

if (!isset($_SESSION['user'])) {

// Create our Application instance (replace this with your appId and secret).
$facebook = new Facebook(array(
  'appId'  => 'xxx',
  'secret' => 'xxx',
));

// Get User ID
$user = $facebook->getUser();

// We may or may not have this data based on whether the user is logged in.
//
// If we have a $user id here, it means we know the user is logged into
// Facebook, but we don't know if the access token is valid. An access
// token is invalid if the user logged out of Facebook.

if ($user) {
  try {
    // Proceed knowing you have a logged in user who's authenticated.
    $user_profile = $facebook->api('/me', 'GET');

$ret = $facebook->api( array(
                         'method' => 'fql.query',
                         'query' => 'SELECT affiliations FROM user WHERE uid = me()',
                     ));

$network = $ret['0']['affiliations']['0']['name'];
//echo $network;

$data = $facebook->api('/me', 'get', array("fields"=>"location"));
$location = $data['location']['name'];

$sql = mysql_query("SELECT * FROM xx_users WHERE user_id=$user_profile[id]");

if (mysql_num_rows($sql) == 0) {

mysql_query("INSERT INTO xx_users (name, user_id, email, network, location)
VALUES ('$user_profile[name]', '$user_profile[id]', '$user_profile[email]', '$network', '$location')");

}

else {

}

  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}

// Login or logout url will be needed depending on current user state.
if ($user) {
  $logoutUrl = $facebook->getLogoutUrl();
} else {
//  $loginUrl = $facebook->getLoginUrl();
$loginUrl = $facebook->getLoginUrl(array(
        'scope'     => 'email, user_location, user_work_history, user_education_history', // Permissions to request from the user
        'redirect_uri'  => 'http://comfyshoulderrest.com/socialexchange/home.php', // URL to redirect the user to once the login/authorization process is complete.
        ));

}
}

else {
$_SESSION['user'] = $user;
$_SESSION['friends'] = $facebook->api('/me/friends');
// $_SESSION['friends'] = $facebook->api('/$user/friends'); THIS GIVES THE SAME RESULT
} 
```

数据.php

```
include('functions.php');
connect();
session_start();

$friends = $_SESSION['friends'];
$user = $_SESSION['user'];

$arr = $friends['data'];
$friend_ids_arr = array();
foreach ($arr as $friend) { // THIS IS LINE 14
    $friend_ids_arr[] = $friend['id'];
} 
```

错误：

```
Warning: Invalid argument supplied for foreach() in /blah/data.php on line 14 
```

我正在做什么阻止变量通过？

**编辑**

`$_SESSION['user']`打印得很好，所以我认为问题出在这一行：

`$_SESSION['friends'] = $facebook->api('/me/friends');`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T00:39:46.453

我不确定 data.php 如何与 fbconnect.php 联系起来，但也许你想使用

```
$friends = $_SESSION['friends']; 
```

前

```
$arr = $friends['data']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T00:50:55.740

据我所见，在 fbconnect.php 上，您没有启动会话。尝试插入 session_start(); 在连接（）之后。

# php - 没有 cookie 的 PHP 会话

> ID：14034933
> 
> 赞同：-1
> 
> 时间：2012-12-26T00:25:14.133
> 
> 标签：php, html, session, cookieless

没有饼干，我有点迷失了。我想创建一个通过 url 传递 SID 的会话，但我不知道如何从另一个页面传递和获取数据。我用谷歌搜索了很多，但 90% 的示例都与 cookie 相关。

这就是我所拥有的。

索引.php

```
<?php
    ini_set("session.use_cookies",0);
    ini_set("session.use_only_cookies",0);
    ini_set("session.use_trans_sid",1);
    session_start();
?>

<html>
<head>
    <title>Index</title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />        
    <link rel="STYLESHEET" type="text/css" href="style.css">
</head>
<body>  
    <a href="index.php?" class="navactive">Index</a>
    <a href="second.php?">Second</a>        

    <form action="access.php" method="POST">
        User: <input type="text" name="user" size="15"/><br>
        Pass: <input type="password" name="pass" size="15"/><br>
        <button type="submit"/>Ok</button>
        <button type="reset"/>Reset</button>
    </form>     

    Logged as: <?php print $_SESSION["name"]; ?>                

</body>
</html> 
```

access.php 最后一部分

```
........
.......
....

    if($count==1){

    // Register $myusername and redirect to file "second.php"
    ini_set("session.use_cookies",0);
    ini_set("session.use_only_cookies",0);
    ini_set("session.use_trans_sid",1);
    session_name('test');

    session_start();
    $_SESSION['name'] = $myusername; 

    header("location:second.php?".SID);
    exit;
}
else {
    echo "Wrong Username";
}
ob_end_flush();
?> 
```

第二个.php

```
<?php
    ini_set("session.use_cookies",0);
    ini_set("session.use_only_cookies",0);
    ini_set("session.use_trans_sid",1);
    session_start();
?>

<html>
<head>
    <title>Second</title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />        
    <link rel="STYLESHEET" type="text/css" href="style.css">
</head>
<body>
    <a href="index.php?">Index</a>
    <a href="second.php?" class="navactive">Second</a><br>              

    <a href="logout.php">Logout</a><br>         

    Logged as: <?php print $_SESSION["name"]; ?>                    

</body>
</html> 
```

注销.php

```
<?php
    ini_set("session.use_cookies",0);
    ini_set("session.use_only_cookies",0);
    ini_set("session.use_trans_sid",1);
    session_start();
    session_unset();    
    session_destroy();
    header('Location: index.php');
    exit;
?> 
```

- 我必须在“登录为：”中输入什么？"打印 $_SESSION["name"];" 什么都不显示。

-当我登录时，我被重定向到 second.php，然后我单击任何链接，实际记录的会话终止并且 SID 更改。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T00:44:29.203

我只是复制了您的代码并自己进行了测试。一切都很好，但不要在 access.php 文件中使用 session_name('test') 。不太确定那是做什么的，但是当我包含它时它会中断。相反，我使用 $_SESSION['name'] 而不调用 session_name() 函数并且一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T00:38:07.273

为了通过 URL 传递任何内容，您必须使用正确的语法：

your.url.com/ **?key=value&key2=value2...**等等

然后检索此数据：

`echo $_GET['key']`和`echo $_GET['key2']`

# c - 为什么我在 c 中附加到这个 str 数组时出现异常？

> ID：14034935
> 
> 赞同：0
> 
> 时间：2012-12-26T00:25:38.683
> 
> 标签：c, windows, winapi

我正在从光盘读取原始字节并尝试以十六进制打印它们。我在 ConsoleApp.exe 中收到“0x666CDF46 (msvcr110d.dll) 处的未处理异常：0xC0000005：访问冲突写入位置 0x002EC000。” 在 for 循环内。我的猜测是我跑完了 TCHAR 数组的末尾，`str`但我不知道为什么。`dwBytesRead`并且`dwSize`是 4096。for 循环在 4027 时停止异常`i`，我相信它应该到达 4096。有人可以对此有所了解吗？

```
int _tmain(int argc, _TCHAR* argv[])
{
    HANDLE  hCD, hFile;
    DWORD   dwBytesRead;

    hFile = CreateFile (L"sector.dat",...);

    hCD = CreateFile (L"\\\\.\\E:", ...);

    if (hCD != INVALID_HANDLE_VALUE)
    {
        DISK_GEOMETRY         dgCDROM;

        ...

        LPBYTE lpSector;
        DWORD  dwSize = 2 * dgCDROM.BytesPerSector;  // 2 sectors

        lpSector = (LPBYTE) VirtualAlloc (NULL, dwSize,
            MEM_COMMIT|MEM_RESERVE,
            PAGE_READWRITE);

        ....

        if (ReadFile (hCD, lpSector, dwSize, &dwBytesRead, NULL)) {
            const int size = (int) dwBytesRead;
            TCHAR *str = new TCHAR[size*2+1];
            int i;

            for (i=0; i<size;i++) {
                _stprintf_s(str+2*i, (size_t) dwBytesRead, L"%02x", lpSector[i]);
            }
            str[2*i]=L'\0'; 
            OutputDebugString(str);
            ...
        }

        ...
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T00:36:20.963

您`dwBytesRead`在调用内部的使用`_stprintf_s`无效。您正在告诉`_stprintf_s`目标缓冲区的大小，对于循环中的*每次*迭代，都从特定点开始`str`并扩展到`dwBytesRead`字符。这是不正确的，尤其是当您的循环迭代器`i`到达缓冲区的末尾时。

您可以通过以下方式解决此问题：

```
 _stprintf_s(str+2*i, (size*2+1) - (2*i), L"%02x", lpSector[i]); 
```

我很难说这是否真的能解决你的问题，因为目前还不清楚问题的根源究竟是什么。

# java - 无法从 java 连接到 hbase

> ID：14034937
> 
> 赞同：0
> 
> 时间：2012-12-26T00:26:54.783
> 
> 标签：java, osx-lion, hbase

我已经设置了一切，就像 hbase 文档说的那样。这是我的 hbase-site.xml

```
<configuration>
    <property>
        <name>hbase.rootdir</name>
        <value>file:///users/urijvoskresenskij/hbase-0.94.3/hbase</value>
    </property>
    <property>
        <name>hbase.zookeeper.property.dataDir</name>
        <value>/users/urijvoskresenskij/hbase-0.94.3/zookeeper</value>
    </property>
</configuration> 
```

Java 代码：

```
import java.io.IOException;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.HBaseConfiguration;
import org.apache.hadoop.hbase.client.HBaseAdmin;
import org.apache.hadoop.hbase.client.HTable;
import org.apache.hadoop.hbase.client.Put;
import org.apache.hadoop.hbase.util.Bytes;

public class MainHBase {

    /**
     * @param args
     */
    public static void main(String[] args) throws Exception {
        Configuration config = HBaseConfiguration.create();
        config.set("hbase.zookeeper.quorum", "localhost");
        HBaseAdmin admin = new HBaseAdmin(config);
        try {
            HTable table = new HTable(config, "test-table");
            Put put = new Put(Bytes.toBytes("test-key"));
            put.add(Bytes.toBytes("cf"), Bytes.toBytes("q"), Bytes.toBytes("value"));
            table.put(put);
        } finally {
            admin.close();
        }
} 
```

这是一个例外：

```
2012-12-26 11:08:07.980 java[10204:1c03] Unable to load realm info from SCDynamicStore
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.3-1240972, built on 02/06/2012 10:48 GMT
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:host.name=192.168.1.101
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:java.version=1.7.0-ea
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:java.vendor=Oracle Corporation
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:java.home=/Library/Java/JavaVirtualMachines/JDK 1.7.0 Developer Preview.jdk/Contents/Home/jre
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:java.class.path=/Users/urijvoskresenskij/Documents/workspace/Hbase/bin:/Users/urijvoskresenskij/hbase-0.94.3/lib/activation-1.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/asm-3.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/avro-1.5.3.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/avro-ipc-1.5.3.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-beanutils-1.7.0.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-beanutils-core-1.8.0.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-cli-1.2.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-codec-1.4.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-collections-3.2.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-configuration-1.6.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-digester-1.8.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-el-1.0.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-httpclient-3.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-io-2.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-lang-2.5.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-logging-1.1.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-math-2.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/commons-net-1.4.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/core-3.1.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/guava-11.0.2.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/hadoop-core-1.0.4.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/high-scale-lib-1.1.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/httpclient-4.1.2.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/httpcore-4.1.3.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jackson-core-asl-1.8.8.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jackson-jaxrs-1.8.8.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jackson-mapper-asl-1.8.8.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jackson-xc-1.8.8.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jamon-runtime-2.3.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jasper-compiler-5.5.23.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jasper-runtime-5.5.23.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jaxb-api-2.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jaxb-impl-2.2.3-1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jersey-core-1.8.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jersey-json-1.8.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jersey-server-1.8.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jettison-1.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jetty-6.1.26.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jetty-util-6.1.26.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jruby-complete-1.6.5.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jsp-2.1-6.1.14.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jsp-api-2.1-6.1.14.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/jsr305-1.3.9.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/junit-4.10-HBASE-1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/libthrift-0.8.0.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/log4j-1.2.16.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/metrics-core-2.1.2.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/netty-3.2.4.Final.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/protobuf-java-2.4.0a.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/servlet-api-2.5-6.1.14.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/slf4j-api-1.4.3.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/slf4j-log4j12-1.4.3.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/snappy-java-1.0.3.2.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/stax-api-1.0.1.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/velocity-1.7.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/xmlenc-0.52.jar:/Users/urijvoskresenskij/hbase-0.94.3/lib/zookeeper-3.4.3.jar:/Users/urijvoskresenskij/hbase-0.94.3/hbase-0.94.3-tests.jar:/Users/urijvoskresenskij/hbase-0.94.3/hbase-0.94.3.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.aop-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.asm-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.aspects-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.beans-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.context-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.context.support-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.core-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.expression-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.instrument-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.instrument.tomcat-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.jdbc-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.jms-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.orm-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.oxm-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.test-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.transaction-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.web-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.web.portlet-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.web.servlet-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/dist/org.springframework.web.struts-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Downloads/commons-logging-1.1.1/commons-logging-1.1.1.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.web-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.aop-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.asm-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.aspects-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.beans-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.context-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.context.support-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.core-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.expression-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.instrument-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.instrument.tomcat-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.jdbc-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.jms-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.orm-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.oxm-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.test-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.transaction-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.web.portlet-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.web.servlet-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Desktop/spring-framework-3.1.3.RELEASE/src/org.springframework.web.struts-sources-3.1.3.RELEASE.jar:/Users/urijvoskresenskij/Downloads/commons-logging-1.1.1/commons-logging-1.1.1-javadoc.jar:/Users/urijvoskresenskij/Downloads/commons-logging-1.1.1/commons-logging-1.1.1-sources.jar:/Users/urijvoskresenskij/Downloads/commons-logging-1.1.1/commons-logging-adapters-1.1.1.jar:/Users/urijvoskresenskij/Downloads/commons-logging-1.1.1/commons-logging-api-1.1.1.jar:/Users/urijvoskresenskij/Downloads/commons-logging-1.1.1/commons-logging-tests.jar
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:java.library.path=/Users/urijvoskresenskij/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/_q/z5blmlxs39d4pmmv1fj9mh500000gn/T/
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:os.arch=x86_64
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:os.version=10.7.5
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:user.name=urijvoskresenskij
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:user.home=/Users/urijvoskresenskij
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Client environment:user.dir=/Users/urijvoskresenskij/Documents/workspace/Hbase
12/12/26 10:08:08 INFO zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=180000 watcher=hconnection
12/12/26 10:08:08 INFO zookeeper.ClientCnxn: Opening socket connection to server /127.0.0.1:2181
12/12/26 10:08:08 INFO zookeeper.RecoverableZooKeeper: The identifier of this process is 10204@MacBook-Air-Urij.local
12/12/26 10:08:08 INFO client.ZooKeeperSaslClient: Client will not SASL-authenticate because the default JAAS configuration section 'Client' could not be found. If you are not using SASL, you may ignore this. On the other hand, if you expected SASL to work, please fix your JAAS configuration.
12/12/26 10:08:08 INFO zookeeper.ClientCnxn: Socket connection established to localhost/127.0.0.1:2181, initiating session
12/12/26 10:08:08 INFO zookeeper.ClientCnxn: Session establishment complete on server localhost/127.0.0.1:2181, sessionid = 0x13bd4823ba20007, negotiated timeout = 40000
12/12/26 10:08:08 WARN client.HConnectionManager$HConnectionImplementation: Encountered problems when prefetch META table: 
org.apache.hadoop.hbase.TableNotFoundException: Cannot find row in .META. for table: test-table, row=test-table,,99999999999999
    at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:164)
    at org.apache.hadoop.hbase.client.MetaScanner.access$000(MetaScanner.java:54)
    at org.apache.hadoop.hbase.client.MetaScanner$1.connect(MetaScanner.java:133)
    at org.apache.hadoop.hbase.client.MetaScanner$1.connect(MetaScanner.java:130)
    at org.apache.hadoop.hbase.client.HConnectionManager.execute(HConnectionManager.java:360)
    at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:130)
    at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:105)
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.prefetchRegionCache(HConnectionManager.java:922)
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegionInMeta(HConnectionManager.java:977)
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:864)
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:821)
    at org.apache.hadoop.hbase.client.HTable.finishSetup(HTable.java:234)
    at org.apache.hadoop.hbase.client.HTable.<init>(HTable.java:174)
    at org.apache.hadoop.hbase.client.HTable.<init>(HTable.java:133)
    at MainHBase.main(MainHBase.java:20)
Exception in thread "main" org.apache.hadoop.hbase.TableNotFoundException: test-table
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegionInMeta(HConnectionManager.java:999)
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:864)
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:821)
    at org.apache.hadoop.hbase.client.HTable.finishSetup(HTable.java:234)
    at org.apache.hadoop.hbase.client.HTable.<init>(HTable.java:174)
    at org.apache.hadoop.hbase.client.HTable.<init>(HTable.java:133)
    at MainHBase.main(MainHBase.java:20) 
```

已经尝试谷歌它，但无法找到解决方案。我的操作系统是 OS X。我尝试创建的表无法从 hbase shell 扫描。请帮忙 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T15:56:23.793

您是否创建了“测试表”？在将数据放入其中之前，表必须存在。

```
Configuration conf = HBaseConfiguration.create();
HBaseAdmin hbase = new HBaseAdmin(conf);
HTableDescriptor desc = new HTableDescriptor("test_table");
HColumnDescriptor cf = new HColumnDescriptor("cf".getBytes());
desc.addFamily(cf);
hbase.createTable(desc); 
```

# css - 将带有背景图像的 div 设置为 100% 高度

> ID：14034939
> 
> 赞同：0
> 
> 时间：2012-12-26T00:27:26.703
> 
> 标签：css

我想为页面内容设置背景。带有背景图像的 div 具有`class=history`. “历史”和历史本身之上的所有 div 都将高度设置为 100%。但是，“历史” div 没有得到正确的高度。

下面是代码示例。我可能会遗漏一些相关细节，但一旦找到解决方案就会添加它们。另请参阅[实时页面](http://dynamicsresolved.com/company/history/)。

CSS：

```
html, body {
    height: 100%;
    background: url(cream_dust.png) repeat 0 0;
} 
```

的HTML：

```
<html>
<body class="page page-id-41 page-child parent-pageid-8 page-template-default logged-in admin-bar">
<div class="wrapper-for-footer">
<div id="page" class="hfeed site">
<div id="main" class="site-main">
<div id="primary" class="content- 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T01:06:30.730

An element that is set to `height: 100%` will only take up 100% of the vertical space of its parent. If there's an element somewhere between `history` and `body` that doesn't have a height, then it won't be as tall as you're expecting.

The majority of the `history` element is floated content, so it has collapsed to only contain the non-floated content.

Add a clearfix to the `history` element.

`overflow: hidden`

or

```
.history {
    zoom: 1; // fix for IE
}

.history:after {
    content: ' ';
    display: block;
    height: 0;
    clear: both;
    visibility: hidden;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T00:43:28.820

您可能需要添加`position:absolute;`到`div`您尝试给予 100% 高度的内容。

编辑：您**需要**添加`position:absolute;`到`history` `div`

# c++ - 与条件评估和 for 循环的步骤混淆

> ID：14034940
> 
> 赞同：0
> 
> 时间：2012-12-26T00:27:48.663
> 
> 标签：c++, c, for-loop, step-into

```
void draw_diamond(int n)
{
int mid_pos = ceil((double)n / 2);
int left_spaces = mid_pos-1;
int line_stars = 1;

putchar(10);
//printing from top through the middle of the diamond
for(line_stars, left_spaces ; line_stars <= n; line_stars+=2, left_spaces--);
{
    //printing the left_spaces
    for(int i=1; i<=left_spaces; i++)
        putchar(32);

    //printing the line_stars
    for(int i=1; i<=line_stars; i++)
        putchar('*');
    putchar(10);
} 
```

...

我在这里遇到问题，当我`step into`第`for loop`一次时，什么都没有发生，第二次`for loop step is applied`例如：如果我`pass 1 to n`那么：

mid_pos =1; left_spaces=0; line_stars=1;

它进入循环内部：left_spaces=-1; line_stars=3;

`for loop`打印 3 颗星，它应该只打印 1 颗星。

我很困惑，如果有人可以提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T00:31:53.637

哦，注意偷偷摸摸的分号：

```
for(line_stars, left_spaces ; line_stars <= n; line_stars+=2, left_spaces--);
                                                                            ^
                                                                            | 
```

`for`你的陈述到此结束。循环将一直运行，直到`line_stars`大于`n`。到最后，`line_stars`现在将等于 3（因为它增加了 2）。`left_spaces`将为-1。

Now the rest of your code which is enclosed by curly brackets will execute. The first `for` loop won't run at all, but the second one will run from 1 until `line_stars` and, as we know, `line_stars` is 3, so we get 3 stars printed out.

# build - 使用乳胶而不是来自 LaTeXTools 插件的 pdflatex 运行 Sublime Text 构建

> ID：14034941
> 
> 赞同：0
> 
> 时间：2012-12-26T00:28:12.000
> 
> 标签：build, makefile, latex, sublimetext2

在 Sublime Text 的 LatexTools 插件提供的构建文件中，我修改了语句

```
"cmd": ["latexmk", "-e", "\\$pdflatex = 'pdflatex %O -interaction=nonstopmode -synctex=1 %S'", "-f", "-pdf"] 
```

通过用乳胶替换 pdflatex 的第二个实例。我的问题是，如何指定是要使用“dvipdfm”还是“dvi2ps + ps2pdf”。

如果有人可以为此目的提供示例构建文件，那将是最有帮助的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T19:59:17.737

经过一番反复试验，我终于让以下构建文件正常工作。这使我可以在 pdflatex 和 latex 之间进行选择，还可以在 dvipdfm 和“dvi2ps + ps2pdf”的替代方案之间进行选择

```
 // Compilation settings
    // ====================
    //
// The actual magic happens in the make_pdf command
// I stick to the format of standard ST2 sublime-build files
// with minor variations.
// NOTE: the viewer is NOT configured from here! 
// As of 5/24/11, it cannot be changed, but I will introduce a setting later

{
    // General settings; DO NOT MODIFY!!!
    "target": "make_pdf",
    "selector": "text.tex.latex",

    //-----------------------
    // Linux-specific settings
    // ----------------------
    // If  linux/os variable is used, then command palette does not show variant names

        // Linux texification settings
        // -------------------------
        // Personalize this, IF you know what you are doing!
        // e.g. change 'pdflatex...' to 'xelatex...'
        // Refer to the documentation for latexmk
        //
        // Note: do NOT include $file or similar!!!
        // Only configure the compilation parameters you need, MINUS the
        // actual file to be compiled
        // 
        // By default, latexmk is told to use pdflatex, with synctex on for
        // backward/forward search, forcing compilation (e.g. even if no bib file is found)
        // and producing pdf rather than dvi output

        "cmd": ["latexmk",
                "-e","\\$dvipdf = 'dvipdfmx %O -o %D %S'", "-e", "\\$latex = 'latex %O -interaction=nonstopmode -synctex=1 %S'",
                "-f", "-pdfdvi"],

        "variants":
        [

        { "cmd": ["latexmk",
                "-e", "\\$pdflatex = 'pdflatex %O -interaction=nonstopmode -synctex=1 %S'",
                "-f", "-pdf"],
          "name": "Run"
        },

        { "cmd": ["latexmk",
                "-e", "\\$latex = 'latex %O -interaction=nonstopmode -synctex=1 %S'",
                "-f", "-pdfps"],
          "name": "LaTeX_PS_PDF"
        },

        {"cmd": ["latexmk", "-e",  "\\$clean_ext = 'aux fls fdb_latexmk dvi ps synctex.gz'", "-c"],
         "name" : "Clean "
        }

        ]       
} 
```

# php - 一个实体管理器和多个数据库未检测到模式更改的学说

> ID：14034943
> 
> 赞同：3
> 
> 时间：2012-12-26T00:28:17.797
> 
> 标签：php, symfony, doctrine, doctrine-orm

使用 Symfony-2.1 和 Doctrine-2.3。我有多个数据库，需要进行跨数据库连接，所以我遵循了以下建议：

*   [Doctrine2 和 Zend 框架中的多数据库连接](https://stackoverflow.com/questions/5442521/multiple-database-connection-in-doctrine2-and-zend-framework)
*   [使用与多个实体管理器的关系](https://stackoverflow.com/questions/11463517/using-relationships-with-multiple-entity-managers)

并设置多个连接和一个实体管理器。这里是`app/config/config.yml`：

```
doctrine:
    dbal:
        default_connection: db1
        connections:
            db1:
                driver:   pdo_mysql
                host:     127.0.0.1
                dbname:   db1
            db2:
                driver:   pdo_mysql
                host:     127.0.0.1
                dbname:   db2
    orm:
        default_entity_manager: default
        auto_generate_proxy_classes: %kernel.debug%
        entity_managers:
            default:
                auto_mapping: true
                mappings:
                    FirstBundle:
                        type:   annotation
                        dir:    Model
                        prefix: NoiseLabs\FirstBundle\Model
                    SecondBundle:
                        type:   annotation
                        dir:    Model
                        prefix: NoiseLabs\SecondBundle\Model 
```

中的实体类`FirstBundle`：

```
namespace NoiseLabs\FirstBundle\Model;

/**
 * @ORM\Entity
 * @ORM\Table(name="db1.table1")
 */
class FirstEntity
{
    /**
     * @ORM\Id
     * @ORM\Column(name="id", type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;
} 
```

中的实体类`SecondBundle`：

```
namespace NoiseLabs\SecondBundle\Model;

/**
 * @ORM\Entity
 * @ORM\Table(name="db2.table2")
 */
class SecondEntity
{
    /**
     * @ORM\Id
     * @ORM\Column(name="id", type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @ORM\ManyToOne(targetEntity="NoiseLabs\FirstBundle\Model\FirstEntity")
     * @ORM\JoinColumn(name="firstId", referencedColumnName="id", onDelete="CASCADE")
     */
    protected $first;
} 
```

现在，**问题`app/console doctrine:schema:update --dump-sql`只是检测 (default connection) 中的架构更改`db1.tables`**。如果我将默认连接设置为`db2`它只会输出与`db2.tables`.

我已经检查`app/console doctrine:mapping:info`并正在映射所有实体类。

这是 Doctrine/Symfony 的限制还是我需要调整我的配置？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T02:04:05.590

每个实体管理器只能有一个连接。将默认实体管理器一分为二。`app/console doctrine:schema:update`接受一个可选参数 ( `em`) 来指定正在使用的实体管理器。你必须运行它两次：

```
app/console doctrine:schema:update --dump-sql em="default"
app/console doctrine:schema:update --dump-sql em="my_second_em" 
```

Symfony2 食谱中还有一篇短文（[如何使用多个实体管理器和连接](http://symfony.com/doc/current/cookbook/doctrine/multiple_entity_managers.html)）值得一读。

# iphone - 无法在工作区的 XCode 4 中链接静态库

> ID：14034944
> 
> 赞同：2
> 
> 时间：2012-12-26T00:28:22.133
> 
> 标签：iphone, ios, xcode, static-libraries, workspace

因此，我正在开发一个项目，但无法让我的 XCode 4 工作区正常运行。我将主应用程序作为工作区中的一个项目。然后我将静态库项目添加到工作区中。似乎一切正常。我可以从其他项目导入文件。它可以构建，但是当我运行它时，我得到了这个：

```
dyld: Symbol not found: _OBJC_CLASS_$_iGBC
  Referenced from: /var/mobile/Applications/CD00CC83-28E4-4467-96C0-0D1777E21FDA/GBA4iOS.app/GBA4iOS
  Expected in: flat namespace
 in /var/mobile/Applications/CD00CC83-28E4-4467-96C0-0D1777E21FDA/GBA4iOS.app/GBA4iOS 
```

并崩溃。看起来虽然 Xcode 认为该库已被链接，并且它可以构建和运行，但该应用程序*实际上*并没有该库。但是在派生的数据文件夹中，看起来应该存在的所有内容......都存在。

![图片](../Images/5f3d93a6f0846cae48d66986e1335063.png)

我对 XCode 以及它在设置中的所有细微差别都要发疯了。我可以通过完整性检查以确保其正常工作吗？我还可以做些什么？

**编辑：** 项目设置是有效的，我已经链接了库。 ![图书馆](../Images/c26430e3a7165d5a020026535050e2cb.png)

**编辑 2：** 我的工作区已设置，因此库也在工作区中： ![工作区](../Images/b96392289abb4fbc51d529b571a1bdba.png)

我已从主项目中删除了 lib.a 文件，并将其从构建阶段部分中删除，并多次添加回来。以这种方式添加时没有“将库复制到目标文件夹”选项，所以我不能这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T07:49:20.453

尝试清理您的构建，如果它不起作用，请在构建阶段删除库和您的项目文件夹。将库添加到项目时，选中“如果需要，将项目复制到目标”，在构建阶段添加该库。

# css - Xcode、phoneGap 中不包含 CSS 文件。但它们在浏览器中工作

> ID：14034946
> 
> 赞同：0
> 
> 时间：2012-12-26T00:28:43.447
> 
> 标签：css, xcode, cordova

这是我的html代码：

```
<!DOCTYPE html>
<!--
 test app
 -->
<html>
    <head>
        <title>jQuery Mobile page</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
            <link rel="stylesheet" charset="utf-8" href="http://darrenvenn.com/greenie.min.css" />
            <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile.structure-1.2.0.min.css" />
            <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
            <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
            <title>test app</title>
            </head>
    <body>
        <div data-role="page" data-theme="a">

            <div data-role="header" data-position="inline">
                <h1>Sample Header</h1>
            </div>
            <div data-role="content" data-theme="a">
                <input type="button" value="selection 1" onclick=""/>
                <p>
                <input type="button" value="selection 2" onclick="" />
                </p><p>
                <input type="button" value="selection 3" onclick="" />
                </p><p>
                <input type="button" value="selection 4" onclick="" />
                </p>
            </div>
                <script type="text/javascript" src="cordova-2.2.0.js"></script>
        </div>
    </body>
</html> 
```

当我从浏览器运行它时，它发现 greenie.min.css 文件很好。当我在 PhoneGap/Xcode 中运行它时，它永远不会加载 css。想知道为什么我的 CSS 在浏览器中加载正常时不会加载到 PhoneGap 中。我尝试了许多不同的方式，使用普通版本和最小版本，在本地加载和从 url 加载，没有任何效果，没有。

这应该很简单！...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:11:07.500

检查 CSS 文件及其所在目录的权限。特别是，确保在 CSS 目录上设置了 x 标志。众所周知，这会在某些情况下影响 CSS 加载，例如在具有某些电子阅读器（包括 iBooks）的 EPUB 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-17T20:19:36.103

对我来说，这是因为我的路径是从“/”开始的。这在 Chrome 和 Android 中运行良好，但由于某种原因在 IOS 上运行良好。

# twitter-bootstrap - Bootstrap Typeahead：删除第一项的强制选择

> ID：14034950
> 
> 赞同：7
> 
> 时间：2012-12-26T00:29:48.943
> 
> 标签：twitter-bootstrap, bootstrap-typeahead

嗨，我在 twitter 引导程序中使用 typeahead。我在这里发现的是，在自动完成下拉菜单中，它默认选择第一个选项。我的要求是，最初它应该没有选择任何内容，只有当我按下导航键（向上或向下）或将鼠标悬停在它上面时，它才会进入第一个选项。是否可以使用预输入。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-08-27T18:07:47.180

为了避免默认情况下通过 typeahead first 选项进行选择，我使用了官方文档中记录的参数：**autoSelect**。默认情况下，它设置为“真”

我的代码：

```
$('#searchString', this.el).typeahead({
        source: function (query, process) {
            var q = '/autocompleteSearch?searchString=' + query;               

            return $.get(q, function (data) {
                return process(data);
            });
        },
        minLength: 3,
        autoSelect: false
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-06T12:55:03.187

Twitter有一个更强大的[typeahead 项目](https://github.com/twitter/typeahead.js#readme)，它没有这个问题。我不明白为什么这个项目不直接包含在 Twitter Bootstrap 中。

你可以[在这里看到一些例子](http://twitter.github.io/typeahead.js/examples/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-27T07:03:33.083

您可以简单地覆盖引导输入预渲染方法来实现这一点。`items.first().addClass('active')`来自原始 typeahead 插件的行将在此覆盖中删除。

```
$.fn.typeahead.Constructor.prototype.render = function(items) {
     var that = this

     items = $(items).map(function (i, item) {
       i = $(that.options.item).attr('data-value', item)
       i.find('a').html(that.highlighter(item))
       return i[0]
     })

     this.$menu.html(items)
     return this
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-18T10:21:28.227

虽然不完全符合您的要求，但[这里](https://stackoverflow.com/questions/13363070/how-to-change-selection-behaviour-of-bootstraps-typeahead)有一个很好的解决方法。基本上，您将用户插入的文本放入第一个预先输入的建议中。正如链接的答案所提到的，这与您从 Chrome 地址栏中获得的行为相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-26T09:28:03.097

**1-打开 bootstrap-typeahead.js 并注释 items.first().addClass('active')**

```
render: function (items) {
  var that = this

  items = $(items).map(function (i, item) {
    i = $(that.options.item).attr('data-value', item)
    i.find('a').html(that.highlighter(item))
    return i[0]
  })

//  items.first().addClass('active')
  this.$menu.html(items)
  return this
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-13T09:43:35.850

我在[这里](https://bibwild.wordpress.com/2013/04/04/overriding-bootstrap-typeahead-to-not-initially-select/)找到了一个解决方案，首先添加这个：

```
var newRender = function(items) {
     var that = this

     items = $(items).map(function (i, item) {
       i = $(that.options.item).attr('data-value', item)
       i.find('a').html(that.highlighter(item))
       return i[0]
     })

     this.$menu.html(items)
     return this
};
$.fn.typeahead.Constructor.prototype.render = newRender;

$.fn.typeahead.Constructor.prototype.select = function() {
    var val = this.$menu.find('.active').attr('data-value');
    if (val) {
      this.$element
        .val(this.updater(val))
        .change();
    }
    return this.hide()
}; 
```

它会覆盖引导程序预先输入以不最初选择任何内容

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-18T06:02:27.030

默认情况下，“typeahead-focus-first”设置为 true，只需通过 typeahead-focus-first="false" 将其设置为 false。

# c# - 多态性 + DDD

> ID：14034951
> 
> 赞同：1
> 
> 时间：2012-12-26T00:30:28.057
> 
> 标签：c#

在我的第一个真正的 DDD 项目中，我对在这种情况下采取哪种课程持怀疑态度......

我有一个分布式架构，其中多个应用程序的用户将只有一个帐户，使他们能够进行身份验证。此帐户可以在我们自己的系统上创建，或者用户可以与我们分享他与 facebook、google 和其他第三方帐户提供商的登录信息。

因此，有一个项目仅用于此目的，控制用户帐户。

这种情况使我在我的模型中采用了这种方法（简化）：

```
public class User
{
    public User(string name)
    {
        Id = Guid.NewGuid();
        Name = name;
    }

    public Guid Id { get; protected set; }

    public string Name { get; protected set; }
}

public abstract class Account
{
    protected Account(User user)
    {
        Id = Guid.NewGuid();
        User = user;
    }

    public Guid Id { get; protected set; }

    public User User { get; protected set; }
}

public class MySystemAccount : Account
{
    public MySystemAccount(string email, string password, User user)
        : base(user)
    {
        Email = email;
        Password = password;
    }

    public string Email { get; protected set; }

    public string Password { get; protected set; }
}

public class FacebookAccount : Account
{
    public FacebookAccount(string facebookId, User user)
        : base(user)
    {
        FacebookId = facebookId;
    }

    public string FacebookId { get; protected set; }
} 
```

问题是其他应用程序将通过 REST 服务访问该项目。

所以，我想到了一个单一的 /Authenticate 服务，它将提供一个动态形式的 json。它可以是带有电子邮件/密码的 json，也可以是带有 facebookId 的 json。

但是，我怎样才能连接这些层呢？

我想过做一个应用程序服务，但我被困在谁和如何决定发生了什么，我的休息服务应该与应用程序通信什么以及应用程序将如何知道做这件事，无论是哪种身份验证，来自我自己域的用户或来自 facebook 的用户等等..

对此有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T02:35:40.797

我是 Stackoverflow 的新手，所以不确定如何将其作为“建议”，但我会重新考虑一下你的模型。我认为“用户”严格来说是通过您自己的网站使用您的应用程序的人。该“用户”将按照您的建议通过身份验证，可以通过您自己系统中的帐户，也可以通过 Facebook 和 Google 等 Open ID 或 OAuth ID 提供商。

但是，如果应用程序想要通过 REST 调用访问您的“应用程序”，那么我会让它们通过不同的身份验证机制。在我看来，您提供的是 API 层和软件即服务。我将看看 Twitter、Facebook 或 Google 如何公开它们的 API 以供其他应用程序使用。通常，在对 REST 调用进行身份验证时会涉及到密钥和应用程序 ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:59:32.837

这似乎是一个多部分的问题——一部分是关于对象模型和多态性，另一部分是关于架构的。

关于对象模型，在这种情况下使用继承并不理想。每个子类型`Account`实际上都不会有太多特定的行为或任何行为。唯一的特化是存在不同的数据字段。此外，使用继承会使持久性复杂化。

在架构上，我认为你想要实现的是[federated identity](http://en.wikipedia.org/wiki/Federated_identity)。这基本上将用户（身份）的概念与身份验证过程分离。反过来，这允许所有剩余的应用程序代码绕过身份验证问题并仅依赖于用户的身份。查看[OpenID](http://openid.net/)以及在 C# 中提供 OpenID 实现的[DotNetOpenAuth库。](http://www.dotnetopenauth.net/)

# ruby-on-rails - Javascript 方法在移动格式中不起作用（既不是 JS 也不是 HTML）

> ID：14034957
> 
> 赞同：2
> 
> 时间：2012-12-26T00:30:46.207
> 
> 标签：ruby-on-rails, mobile

[我有一个类似 reddit 的应用程序，它允许用户使用Activerecord Reputation System gem](https://github.com/twitter/activerecord-reputation-system)为链接投票。

我正在尝试创建一个基于[Railscast#199](http://railscasts.com/episodes/199-mobile-devices?view=comments)`mobile.erb`的移动版本，如果通过移动设备访问该站点，则使用该格式。

投票方法在非移动格式下运行良好（默认为 javascript，但也适用于 html），但在移动端返回错误如下。请注意，它试图`Get`代替`Post`.

```
Started GET "/links/98/vote?type=like" for 127.0.0.1 at 2012-12-25 19:16:45 -0500
ActionController::RoutingError (No route matches [GET] "/links/98/vote"): 
```

这可能是什么原因造成的？是`before_filter`防止javascript吗？我怎样才能解决这个问题？非常感谢您的意见！

**application_controller.rb**

```
before_filter :prepare_for_mobile

def prepare_for_mobile
  session[:mobile_param] = params[:mobile] if params[:mobile]
  request.format = :mobile if mobile_device?
end

def mobile_device?
  if session[:mobile_param]
    session[:mobile_param] == "1"
  else
    request.user_agent =~ /Mobile/
  end
end
helper_method :mobile_device? 
```

**路线.rb**

```
resources :links do
  member { post :vote }
end 
```

**链接控制器.rb**

```
def vote
  value = params[:type] == "like" ? 1 : 0
  @link = Link.find(params[:id])
  @link.add_or_update_evaluation(:link_votes, value, current_user)
  respond_to do |format|
    format.html { redirect_to :back }
    format.mobile { redirect_to :back }
    format.js
  end
end 
```

**_link.mobile.erb**

```
<div id="link_<%= @link.id %>">
  <%= link_to "like", vote_link_path(@link, type: "like"), method: "post", remote: true %>
</div>

<div id="link_points_<%= @link.id %>">
  <%= @link.reputation_for(:link_votes).to_i %>
</div> 
```

**投票.js.erb**

```
$('#link_<%= @link.id %>').html("<%= j link_to "up", vote_link_path(@link, type: "like"), method: "post", remote: true %>");

$('#link_points_<%= @link.id %>').html("<%= @link.reputation_for(:link_votes).to_i %>; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T14:25:59.430

这是我所做的：

**配置/初始化程序/mime_types.rb**

```
Mime::Type.register_alias "text/html", :mobile
Mime::Type.register_alias "text/javascript", :mobilejs /* newly added mobilejs */ 
```

**application_controller.rb**

```
before_filter :prepare_for_mobile

def prepare_for_mobile
  session[:mobile_param] = params[:mobile] if params[:mobile]
  if mobile_device?
    if request.format == :js
      request.format = :mobilejs /* newly added mobilejs format */
    else
      request.format = :mobile
    end
  end
end 
```

# asp.net - 如何使（链接）按钮功能作为超链接？

> ID：14034960
> 
> 赞同：19
> 
> 时间：2012-12-26T00:31:04.630
> 
> 标签：asp.net, button, hyperlink, webforms, linkbutton

如何使用`asp:Button`or `asp:LinkButton`as `asp:Hyperlink`？

现有的超链接只是转到同一页面上的另一个部分：`NavigateUrl="#Section2"`

我想在 aspx 文件中执行此操作而无需额外编码。谢谢。

目的是让按钮看起来而不是带下划线的文本但**我不想使用带有超链接的图像**来实现此目的。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-26T01:03:08.930

You can use OnClientClick event to call a JavaScript function:

```
<asp:Button ID="Button1" runat="server" Text="Button" onclientclick='redirect()' /> 
```

JavaScript code:

```
function redirect() {
  location.href = 'page.aspx';
} 
```

But i think the best would be to style a hyperlink with css.

Example :

```
.button {
  display: block;
  height: 25px;
  background: #f1f1f1;
  padding: 10px;
  text-align: center;
  border-radius: 5px;
  border: 1px solid #e1e1e2;
  color: #000;
  font-weight: bold;
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-01-13T12:17:31.497

有一条中间道路。如果你想要一个 HTML 控件但你需要在服务器端访问它，你可以简单地添加`runat="server"`属性：

```
<a runat="server" Id="lnkBack">Back</a> 
```

然后，您可以`href`使用更改服务器端`Attributes`

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
       lnkBack.Attributes.Add("href", url);
    }
} 
```

导致：

```
<a id="ctl00_ctl00_mainContentPlaceHolder_contentPlaceHolder_lnkBack" 
      href="url.aspx">Back</a> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-08-18T19:30:38.100

完成此操作的最佳方法是简单地将“href”添加到链接按钮，如下所示。

```
<asp:LinkButton runat="server" id="SomeLinkButton" href="url" CssClass="btn btn-primary btn-sm">Button Text</asp:LinkButton> 
```

使用 javascript 或在 page_load 中以编程方式执行此操作也可以，但不是执行此操作的最佳方式。

你会得到这样的结果：

```
<a id="MainContent_ctl00_SomeLinkButton" class="btn btn-primary btn-sm" href="url" href="javascript:__doPostBack(&#39;ctl00$MainContent$ctl00$lSomeLinkButton&#39;,&#39;&#39;)">Button Text</a> 
```

您也可以使用常规的 `<a href="" class=""></a>`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-06-24T12:18:42.707

这可以使用 PostBackUrl 和常规按钮轻松完成。

```
<asp:Button ID="Button1" runat="server" Text="Name of web location" PostBackUrl="web address" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-16T04:17:58.200

您可以使用链接按钮导航到同一页面中的另一个部分`PostBackUrl="#Section2"`

# asp.net-mvc-3 - mvc路由经典asp页面

> ID：14034965
> 
> 赞同：2
> 
> 时间：2012-12-26T00:32:24.913
> 
> 标签：asp.net-mvc-3, asp-classic, routing

我正在将 asp 经典 (.asp) 转换为 mvc4。该站点很好，但是当我尝试将旧页面映射到新路线时，它失败了。

我只想： default.asp 到 / 或 pageA.asp 到 /NewPageA

当我尝试映射旧页面时，看起来 asp 经典处理程序首先拦截请求并尝试查找页面 .asp，但由于不存在，它会引发 404 错误。

我映射错了？我的映射是这样的：

```
routes.MapRoute("DefaultOld", "default.asp", new { controller = "Home", action = "IndexOld" });
routes.MapRoute("MenuOld", "menu.htm", new { controller = "Home", action = "IndexOld" });
routes.MapRoute("RecepcaoOld", "recepcao.htm", new { controller = "Home", action = "IndexOld" });
routes.MapRoute("EntradaPorOld", "entrada_por.htm", new { controller = "Home", action = "IndexOld" }); 
```

是否可以告诉服务器忽略经典页面并让 mvc 路由拦截请求并按照应有的方式行事？

我正在使用 IIS 7。

我在这里尝试了这个解决方案（http://blog.abodit.com/2010/04/a-simple-redirect-route-handler-for-asp-net-3-5-routing/），可以很好地映射 tp aspx页面，但是当我尝试使用 asp 或 htm 时，它根本不起作用。所以我认为我需要禁用处理程序 od classic asp，对吗？但在 htm 方面，如果我禁用 StaticHandler，图像和所有静态资源将无法正常工作，对吗？干杯

# java - 我需要在 printf 中打印这个

> ID：14034966
> 
> 赞同：-7
> 
> 时间：2012-12-26T00:33:07.720
> 
> 标签：java

我做了这个程序，但我需要用`printf()`. 我需要像 6.00 这样的小数点后有 2 位数字，它也应该四舍五入。我以前`println()`只是尝试一下。

```
 public static void main(String[ ] args)
    {
        double[ ] x = {1.0, 0.90, 0.80, 0.70, 0.60, 0.50, 0.40, 0.30, 0.20, 0.10, 0.00, -0.10, -0.20, -0.30, -0.40, -0.50, -0.60, -0.70, -0.80, -0.90, -1.00};
        double r = 1;
        for (int i = 0; i <= 20; i++) {
                System.out.println(x[i]);
        }
        for(int i=0;i<21;i++) {     
              double y = Math.sqrt(Math.pow(r, 2)- Math.pow(x[i], 2));
              System.out.println("");
              System.out.println(y);
        }
    } 
```

以下是它的排列方式：http: [//i.stack.imgur.com/7atLn.png](http://i.stack.imgur.com/7atLn.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T00:35:07.003

尝试使用

```
System.out.printf("%.2f%n", x[i]); 
```

* * *

**编辑**这是另一个想法，基于您想要的输出：

```
double[] x = { 1.0, 0.90, 0.80, 0.70, 0.60, 0.50, 0.40, 0.30, 0.20,
           0.10, 0.00, -0.10, -0.20, -0.30, -0.40, -0.50, -0.60, -0.70,
           -0.80, -0.90, -1.00 };

double r = 1;

for (int i = 0; i < x.length; i++) {
    double y = Math.sqrt(Math.pow(r, 2) - Math.pow(x[i], 2));
    System.out.printf("%10.2f%10.2f%n", x[i], y);
} 
```

```
      1.00 0.00
      0.90 0.44
      0.80 0.60
      0.70 0.71
      0.60 0.80
      0.50 0.87
      0.40 0.92
      0.30 0.95
      0.20 0.98
      0.10 0.99
      0.00 1.00
     -0.10 0.99
     -0.20 0.98

```

# wordpress - WordPress $wpdb 和分页链接

> ID：14034967
> 
> 赞同：1
> 
> 时间：2012-12-26T00:33:13.350
> 
> 标签：wordpress

我正在尝试使用 $wbdb 类对来自数据库查询的一组结果进行分页。我已经让它分页了，但是我得到了一些奇怪的结果，我不确定这是否正常。代码在表格顶部为查询返回的每个结果打印一个“>”。谁能告诉我做错了什么。

我正在使用我从中获得的以下代码

```
 $rows_per_page = 10;
    $current = (intval(get_query_var('paged'))) ? intval(get_query_var('paged')) : 1;

    $rows = $wpdb->get_results('SELECT * FROM subscriber ORDER BY sub_lname ASC');

    $start = ($current - 1) * $rows_per_page;
    $end = $start + $rows_per_page;
    $end = (sizeof($rows) < $end) ? sizeof($rows) : $end;

    $pagination_args = array(
     'base' => @add_query_arg('paged','%#%'),
     'format' => '?page=%#%',
     'total' => ceil(sizeof($rows)/$rows_per_page),
     'current' => $current,
     'show_all' => False,
     'prev_next'    => True,
     'prev_text'    => __('« Previous'),
     'next_text'    => __('Next »'),
     'type' => 'plain',
     'add_args'     => False
    );

echo paginate_links($pagination_args); 
```

您可以在此处实时查看输出[http://www.thewaymultimedia.com/IML/manage-subscribers/page/2](http://www.thewaymultimedia.com/IML/manage-subscribers/page/2)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T01:57:09.250

错误在表格的打印代码中。电话号码`<td>`标签未适当关闭。

例如：

```
<td>4085058047<td> 
```

最后一个标签应该是`</td>`. 此错误在每一行中重复出现。

您必须寻找打印结果的函数并更正它。

顺便说一下，总行数也是错误的=total+1。

# jquery - 通过 jQuery更改/添加子元素的目标属性的子元素

> ID：14034970
> 
> 赞同：0
> 
> 时间：2012-12-26T00:34:01.217
> 
> 标签：jquery, html, dom

 我有一个`<div>`喜欢下面

```
<div class="divClass">
<ul class="ulClass">
    <li id="liID" class="liClass">
        <a href="myLink">
        <span class="spanClass">myText</span>
        </a>
    </li>
</ul>
</div> 
```

现在我想编写一个 jQuery 脚本来读取`<a>`元素并将目标属性的值设置为`_blank`. 

我浏览了[JQuery 更改子元素的属性](https://stackoverflow.com/questions/7204209/jquery-change-atributes-of-child-elements)并得到了一个脚本。但是，它给了我一个像下面这样的脚本

```
$('.divClass').click(function(e){

$(this).find('.aclass').text("yeeee");
$(this).find('.imgclass').attr("src", "remove_favorit.png");

e.preventDefault(); 

}); 
```

我真正想要的是遍历`<div>`, `<ul>`，`<li>`然后伸手到`<a>`其中并设置`target`. 我怎样才能做到这一点？

我也经历[了子元素的Get属性](https://stackoverflow.com/questions/4740297/jquery-get-attribute-of-child-element)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T00:44:32.703

我认为你不希望它发生在点击但下面的代码将设置`target=_blank`点击里面的链接`divClass`

```
$(function(){
    $('.divClass .ulClass .liClass').on('click', 'a', function(e){
        $(this).attr('target', '_blank');
        e.preventDefault();
    });
});​ 
```

这段代码将在页面加载时完成

```
$(function(){
    $('.divClass .ulClass liClass a').attr('target', '_blank');
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T00:53:34.730

在这里查看[http://fiddle.jshell.net/MQfJM/](http://fiddle.jshell.net/MQfJM/)

正如您在图像中看到的，![在此处输入图像描述](../Images/4b65310d73ab23097f5db3a85193630c.png)此代码在加载页面时为页面中的所有元素添加了一个目标空白。

假设您只想将 target="_blank" 添加到列表中。你只需要替换它

```
$('a') with $('ul a') 
```

如果你想在用户点击锚点时添加 target="_blank" 你可以修改我的代码`$(document).ready(function(){ /* code */ })` 看起来像

```
$('a').on( 'click', function(){
   $(this).attr( 'target', '_blank' );
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T00:44:02.657

您可以使用：`$(".divClass > .ulClass > .liClass > a").attr("target", "_blank")`

这是一个非常具体的选择器，如果需要，请删除所有“>”。

# java - BlackBerry 项目中 Timer 的使用

> ID：14034971
> 
> 赞同：1
> 
> 时间：2012-12-26T00:34:09.687
> 
> 标签：java, blackberry, java-me, timer, timertask

我正在尝试以这种方式在我的 BlackBerry 项目中使用 Timer -

```
Timer timer = new Timer();
timer.schedule(new TimerTask() {
    public void run() {
        pushScreen(new MyScreen()); 
    }
},200); 
```

但是我在执行程序时遇到了运行时异常。有人可以告诉我这段代码有什么问题吗？或者在 BlackBerry 项目中使用 Timer 的任何其他技巧。

我的目标是推动 SplashScreen 10 秒，然后 MyScreen 页面将打开。所以我想在打开 MyScreen 页面时使用计时器延迟 10 秒，在计时器期间我将显示 SplashScreen 页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T06:09:55.123

正如[理查德在他的回答中提到的那样](https://stackoverflow.com/a/14035405/119114)，您遇到了问题，因为您试图从主（又名“UI”）线程以外的线程操作 UI。您只需要稍作改动即可使您的代码正常工作：

```
UiApplication.getUiApplication().invokeLater(new Runnable() {
                                                public void run() {
                                                    pushScreen(new MyScreen()); 
                                                }
                                             }, 
                                             200   /* delay */, 
                                             false /* repeat = no */); 
```

以上是您发布的 BlackBerry Java 代码的等价物。

> 我的目标是推动 SplashScreen 10 秒，然后 MyScreen 页面将打开。所以我想在打开 MyScreen 页面时使用计时器延迟 10 秒，在计时器期间我将显示 SplashScreen 页面。

如果这实际上是您想要做的，那么只需`SplashScreen`在应用程序启动后立即出现：

```
public class MyApp extends UiApplication
{
   /**
    * Entry point for application
    * @param args Command line arguments (not used)
    */ 
   public static void main(String[] args)
   {
      // Create a new instance of the application and make the currently
      // running thread the application's event dispatch thread.
      MyApp theApp = new MyApp();       
      theApp.enterEventDispatcher();
   }

   public MyApp()
   {        
      // Push a screen onto the UI stack for rendering.
      final SplashScreen splashScreen = new SplashScreen();
      pushScreen(splashScreen); 

      UiApplication.getUiApplication().invokeLater(new Runnable() {
                                                      public void run() {
                                                          pushScreen(new MyScreen()); 
                                                          popScreen(splashScreen);
                                                      }
                                                   }, 
                                                   10*1000   /* delay in msec */, 
                                                   false /* repeat = no */);

   } 
```

这可以满足您的要求，但 Richard 提供的链接还允许用户提前关闭初始屏幕。这可能是也可能不是你想要的，所以我只是提供上面的替代方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T02:28:42.663

很难说到底出了什么问题，但你不应该做的一件事是在不是事件线程的线程上与用户界面进行交互。

它不会教您如何使用计时器，但有一篇关于如何制作启动画面的[开发人员文章。](http://supportforums.blackberry.com/t5/Java-Development/Create-a-splash-screen/ta-p/444959)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-03T14:39:56.853

您每 200 毫秒推送一个新屏幕......当屏幕被推送时，您需要终止计时器。请记住，时间间隔以毫秒为单位，因此您需要计算它。

祝你好运！

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-26T01:18:28.223

对于 Android，您可能想要执行以下操作：

```
initialize();
setButtonListeners();
new Thread() {
    public void run() {
        try {
            sleep(3000);
        } catch (Exception e) {
        } finally {
                Intent menuIntent = new Intent(SplashLoadScreen.this,
                        MainMenu.class);
                startActivity(menuIntent);
        }
    }
}.start(); 
```

我对黑莓不太熟悉，但您似乎使用 pushScreen() 而不是 startActivity()，而且您不像 Android 那样使用 Intents，所以可能是这样的：

```
initialize(); //Method to initialize all variables you might want to use.
//...Some code
new Thread() {
    public void run() {
        try {
            sleep(3000); //Time in milliseconds 
            //to make this thread sleep before executing whatever other code.
        } catch (Exception e) {
        } finally {
                pushScreen(new MyScreen()); //Push next screen
        }
    }
}.start(); 
```

try{} catch(){} finally{} 是异常处理。基本上，如果在尝试休眠 3000 毫秒时发生任何错误，那么它将捕获所有异常（也称为错误）并执行 catch(){} 中的任何操作。然后，在 try {}（如果没有发现异常）或 catch(){}（如果发现错误）完成后，它会执行 finally{} 中的任何操作。这个案子终于要推下一个画面了。

# jwplayer - jwplayer宽度加载变小了为什么？

> ID：14034983
> 
> 赞同：0
> 
> 时间：2012-12-26T00:37:19.107
> 
> 标签：jwplayer

请看一下页面；[http://www.songarea.com/music-codes/akon.html](http://www.songarea.com/music-codes/akon.html)

是什么导致这个宽度（玩家宽度加载小于 300）问题有人知道吗？

我的 jwplayer 配置是；

```
 <div id=\"container\">Loading the player ...</div>
        <script type=\"text/javascript\">
        jwplayer(\"container\").setup({
        flashplayer: \"/images/songarea/soso/player.swf\",
        file: \"http://www.youtube.com/watch?v=".$youtube_id."&feature=youtube_gdata_player\",
        stretching:\"exactfit\",
        'controlbar': 'bottom',
        'controlbar.idlehide': 'false', 
        'autostart': 'false',
        'volume': '25',
        'height': '200',
        'width': '300',
        skin: \"/images/songarea/soso/skins/smooth.zip\"        
        });</script>"; 
```

# android - Android - ProgressBuilder 成为我的 RoboDialogFragment？

> ID：14034990
> 
> 赞同：0
> 
> 时间：2012-12-26T00:40:00.847
> 
> 标签：android, roboguice

我有以下对话进度。此对话框进度正在根据需要注入到活动/片段中。当我在 Activity 中显示它时，它工作得很好。但是，当我尝试在活动的片段中显示它时，它会显示在对话框下方。

修复此类以正确显示进度对话框的任何方法，`without having to manually pass the context to this class?`

进度对话框类

```
public class ProgressBuilder implements IProgressBuilder {

    private ProgressDialog progressDialog;

    @Inject
    public ProgressBuilder(Provider<Context> contextProvider) {
        this.progressDialog = new ProgressDialog(contextProvider.get());
    }

    public void show() {
        this.show("Loading...", null);
    }

    public void show(String message) {
        this.show(null, message);
    }

    public void show(String title, String message) {
        this.progressDialog.setTitle(title);
        this.progressDialog.setMessage(message);
        this.progressDialog.show();
    }

    public void dismiss() {
        this.progressDialog.dismiss();
    }
} 
```

活动课

```
public class MyActivity extends RoboFragmentActivity {

@Inject IProgressBuilder progress

} 
```

这个片段显示在 MainActivity

```
public class MyActivity extends RoboDialogFragment {

@Inject IProgressBuilder progress

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T01:06:08.673

你真的应该为此使用 DialogFragment。

文档中有大量示例：

[developer.android.com/reference/android/app/DialogFragment.html](http://developer.android.com/reference/android/app/DialogFragment.html)

您只需用 DialogFragment 的子类包装 ProgressDialog。使用他们包装 AlertDialog 的文档中的示例，并将其替换为 ProgressDialog 并设置好。

# sql - 如何避免同一张表上的多个联接？

> ID：14034994
> 
> 赞同：-3
> 
> 时间：2012-12-26T00:42:13.827
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我想知道如何通过仅 1 个左连接来避免所有这些左连接，或者其他任何需要较少连接的东西？

```
select colums
  FROM [SectionAUnresolved] a
  left join sectionanotmarkedcounts sdirector
  on a.director=sdirector.employee

  left join sectionanotmarkedcounts s_rm
  on a.rm=s_rm.employee

  left join sectionanotmarkedcounts s_rep
  on a.rep=s_rep.employee

  left join sectionanotmarkedcounts s_css
  on a.css=s_css.employee

  left join sectionanotmarkedcounts s_Css2
  on a.css2=s_Css2.employee 
```

谢谢您的指导！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T00:53:21.737

要直接回答您的问题，您可以更改架构，以便从左连接表返回的数据包含在 SectionAUnresolved 中。您可以通过以下方式执行此操作：

1.  直接将数据写入相应的列；或者
2.  具有稍后批量更新的空列

你的问题没有太多背景。因此，很难为您的特定问题提供绝对答案。但通常这将是您问题的答案。

您不应该害怕连接，如果性能是一个问题，建议使用关键字段上的索引和/或使用视图（物化或非物化）和/或分区以及任何数量的其他性能增强工具。

**更新**

@Konstantin-Vasilcov 的想法看起来很有可能，虽然有点不正确（需要 or，not and）

```
 select colums
  FROM [SectionAUnresolved] a
  left join sectionanotmarkedcounts [all]
  on a.director=[all].employee
    or a.rm=[all].employee
    or a.rep=[all].employee
    or a.css=[all].employee
    or a.css2=[all].employee 
```

然而，这将导致记录成倍增加，如果您随后可以使用您的应用程序进行透视，这不是问题，尽管这不会提供有关使用什么关系的信息。因此，需要更改您的架构，规范化您的 SectionAUnresolved 表。

```
 select ct.type, colums
  FROM [SectionAUnresolved] a
  left join SectionAUnresolved_countTypes ct
    on ct.Unresolvedid = a.id
  left join sectionanotmarkedcounts [all]
    on ct.employee=[all].employee 
```

在哪里：

*   ct.type {director, rm, rep,css,css2}
*   "ct.Unresolvedid = a.id" - 将新的 SectionAUnresolved_countTypes 表链接到单个 SectionAUnresolved 行

将您的联接减少到 2，并允许更多“countTypes”而不增加联接数量或任何架构更改。

**更新**

感谢@Conrad-Flix，您可以使用 case 语句来确定返回的每条记录使用了什么连接（请参阅上面的第一个代码片段）。这样做意味着您不必进一步规范化 SecionAUnresolved 表，但是您可能仍需要这样做，具体取决于性能。

据我所知，案例语句没有被索引，并且可能需要物化视图索引以进行优化。IMO，正常化仍然是更好的结构改进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T01:02:05.910

简短的回答是“不”。

...因为您想要的数据位于不同的行中，您必须加入才能获取它。没有办法绕过它。