# StackOverflow 问答 12806000-12806999

# printing - 将 sharepoint 导出列表移到功能区之外的 excel 按钮

> ID：12806011
> 
> 赞同：2
> 
> 时间：2012-10-09T18:18:23.927
> 
> 标签：printing, export-to-excel, sharepoint-list, sharepointfoundation2010

我正在使用 SharePoint Foundation 2010 创建一个面向外部的网站，允许匿名用户查看大多数页面和列表。

在我的一个页面上有一个列表，我希望我的匿名用户能够导出到 excel（用于打印目的）。但是我的问题是我已经完全隐藏了匿名用户的功能区（出于明显的样式原因），并且不打算让他们能够查看它。

有什么方法可以将“导出到 Excel”按钮从功能区移动到页面，或者有什么其他方法可以在页面上创建可以导出列表的控件？

最后，我的主要目标是能够让匿名用户只打印显示的列表，而不必打印整个页面。

# .net - 在 Delphi 中实现 .NET 接口

> ID：12806012
> 
> 赞同：1
> 
> 时间：2012-10-09T18:18:25.423
> 
> 标签：.net, delphi, interop

我的主要应用程序在 C# 中，并引用另一个 .NET DLL 声明`IPlugin`和`IPluginHost`. 我现在需要将此 DLL 导入到 Delphi 项目中，以便为主应用程序制作插件。我听说这是可能的，但是关于导入类（我不想要）或在 .NET 中运行 Delphi 代码有很多

在谁能澄清之前有没有人这样做过？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:32:16.910

直接在 Delphi 中实现 .NET 接口将非常困难（我什至不确定是否可能）。但是，根据您想把手弄脏的程度，您可以使用一些选项。

1) 您可以在 Delphi 中创建一个 ActiveX DLL，然后将该库导入 .NET。然后，您可以在 C# 中创建一个实现接口的代理类，并将调用路由到 Delphi ActiveX DLL。

2) 您可以在 Delphi 中创建一个本地 windows DLL，然后在 .NET 中编写接口。然后，您可以在 C# 中创建一个实现接口的代理类，并将调用路由到 Delphi DLL。

3) 您可以使用像 Hydra (http://www.remobjects.com/hydra/) 这样支持 .NET 和 Delphi 的插件框架。

在所有这些情况下，您应该小心处理 32/64 位情况，因为 .NET 代码能够在这两种情况下运行，但 Delphi 代码需要为每个环境独立编译。

根据您的情况，另一种选择可能是以对象 pascal 的形式编写 Delphi 代码，该代码将生成称为 Oxygene (http://www.remobjects.com/oxygene/) 的 .NET 字节代码。

**编辑：**如果您尝试创建用于 .NET 插件框架的 Delphi 插件，最好执行以下操作：

在 Delphi 中创建一个与您的 IPlugIn 和 IPlugInHost 接口匹配的新接口。然后，您可以构建一个 .NET Delphi 插件包装器，其中包含一些配置信息来指定要加载的 Delphi 插件。然后，这个 .NET 包装器将加载 Delphi DLL 并根据需要调用 DLL 方法。视觉的东西需要某种 ActiveX 包装器，但你应该能够很好地使用非视觉的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T21:01:21.640

最简单的方法是为 delphi 提供一个 .NET 到 COM 包装器 dll。我发现这是迄今为止与 .NET 交互最轻松的方式。

# xml - XML 模式：唯一性约束

> ID：12806018
> 
> 赞同：1
> 
> 时间：2012-10-09T18:18:43.130
> 
> 标签：xml, xsd, schema

经过数小时的尝试，我仍然无法得到这个简单的例子来做我想要的。目标非常简单：带有 Notes 的 xml-Document 仅在每个`Node`都分配了唯一的`NoteID`.

这是我的`Notes.xsd`：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
            targetNamespace="http://xml.netbeans.org/schema/Notes"
            xmlns:tns="http://xml.netbeans.org/schema/Notes"
            elementFormDefault="qualified">
    <xsd:element name="Notes">
        <xsd:complexType>
            <xsd:sequence>
                <xsd:element name="Note" maxOccurs="unbounded">
                    <xsd:complexType>
                        <xsd:sequence>
                            <xsd:element name="NoteID" type="xsd:positiveInteger"/>
                            <xsd:element name="Content"  type="xsd:string"/>
                        </xsd:sequence>
                    </xsd:complexType>
                    <xsd:unique name="newKey">
                        <xsd:selector xpath="."/>
                        <xsd:field xpath="NoteID"/>
                    </xsd:unique>
                </xsd:element>
            </xsd:sequence>
        </xsd:complexType>
    </xsd:element>
</xsd:schema> 
```

并且`Notes.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<ns0:Notes  xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
            xmlns:ns0='http://xml.netbeans.org/schema/Notes'
            xsi:schemaLocation='http://xml.netbeans.org/schema/Notes Notes.xsd'>
    <ns0:Note>
        <ns0:NoteID>1</ns0:NoteID>
        <ns0:Content>this</ns0:Content>
    </ns0:Note>
    <ns0:Note>
        <ns0:NoteID>1</ns0:NoteID>
        <ns0:Content>is a</ns0:Content>
    </ns0:Note>
    <ns0:Note>
        <ns0:NoteID>3</ns0:NoteID>
        <ns0:Content>test</ns0:Content>
    </ns0:Note>
</ns0:Notes> 
```

而且我不知道为什么这会验证：

```
$ xmllint --noout -schema Notes.xsd Notes.xml 
Notes.xml validates 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T20:58:29.290

`xsd:unique`在错误的地方，你需要在`xpath`s.

这有效：

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
            targetNamespace="http://xml.netbeans.org/schema/Notes"
            xmlns:tns="http://xml.netbeans.org/schema/Notes"
            elementFormDefault="qualified">
  <xsd:element name="Notes">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="Note" maxOccurs="unbounded">
          <xsd:complexType>
            <xsd:sequence>
              <xsd:element name="NoteID" type="xsd:positiveInteger"/>
              <xsd:element name="Content"  type="xsd:string"/>
            </xsd:sequence>
          </xsd:complexType>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
    <xsd:unique name="newKey">
      <xsd:selector xpath="tns:Note"/>
      <xsd:field xpath="tns:NoteID"/>
    </xsd:unique>
  </xsd:element>
</xsd:schema> 
```

# mysql - Mysql 从 PreparedStatement.getGeneratedKeys() 返回 Long；

> ID：12806020
> 
> 赞同：0
> 
> 时间：2012-10-09T18:18:44.633
> 
> 标签：mysql, jdbc, activejdbc

使用 JDBC 3 驱动程序，可以将一条记录插入到表中，并立即获取列的自动生成值。此技术用于 ActiveJDBC。

这是表定义：

```
CREATE TABLE users (id  int(11) NOT NULL  auto_increment PRIMARY KEY, first_name VARCHAR(56), last_name VARCHAR(56), email VARCHAR(56)) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

这在 H2 和 PostgreSQL 上运行良好，返回值的类型是整数。但是，在 MySQL 中，类型是 Long，而我认为它应该是 Integer。在 Mysql 中查询同一行时，“id”返回为 Integer。

任何人都知道为什么“getGeneratedKeys()”在 Mysql 中返回 java.lang.Long 以及如何修复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T11:49:43.610

原因：MySQL 用于跟踪值的生成器是`BIGINT`，因此驱动程序将其描述为 BIGINT，相当于 Long。请参阅[`LAST_INSERT_ID`](http://dev.mysql.com/doc/refman/5.5/en/information-functions.html#function_last-insert-id)MySQL 手册。

像 PostgreSQL 这样的驱动程序返回表的实际列（实际上 PostgreSQL 在使用时返回**所有**列`getGeneratedKeys()`；我假设 MySQL 只是调用`LAST_INSERT_ID()`.

如何解决它：正如 Jim Garrison 在评论中指出的那样：始终使用`getInt()`, or `getLong()`, 而不是`getObject()`。

# android - Android 上的基本身份验证

> ID：12806023
> 
> 赞同：4
> 
> 时间：2012-10-09T18:18:53.463
> 
> 标签：android, basic-authentication

我找到了一个例子

```
try {
        String data = "YOUR REQUEST BODY HERE";
        //
        CredentialsProvider credProvider = new BasicCredentialsProvider();
        credProvider.setCredentials(new AuthScope(AuthScope.ANY_HOST, AuthScope.ANY_PORT),
            new UsernamePasswordCredentials("YOUR USER NAME HERE", "YOUR PASSWORD HERE"));
        //
        DefaultHttpClient http = new DefaultHttpClient();
        http.setCredentialsProvider(credProvider);
        //
        HttpPut put = new HttpPut("YOUR HTTPS URL HERE");
        try {
            put.setEntity(new StringEntity(data, "UTF8"));
        } catch (UnsupportedEncodingException e) {
            Log.e(TAG, "UnsupportedEncoding: ", e);
        }
        put.addHeader("Content-type","SET CONTENT TYPE HERE IF YOU NEED TO");
        HttpResponse response = http.execute(put);
        Log.d(TAG, "This is what we get back:"+response.getStatusLine().toString()+", "+response.getEntity().toString());
    } catch (ClientProtocolException e) {
        //
        Log.d(TAG, "Client protocol exception", e);
    } catch (IOException e) {
        //
        Log.d(TAG, "IOException", e);
    } 
```

但我必须以授权格式发送一个字符串：`<Login>@<ID>:<Passsword>`

这该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:35:36.253

你应该先看看什么是 HTTP Basic：[http ://en.m.wikipedia.org/wiki/Basic_access_authentication#section_3](http://en.m.wikipedia.org/wiki/Basic_access_authentication#section_3)

您的问题不是针对 HTTP Basic 的，由于本质上不安全，因此根本不应该使用。

我认为您要求的内容应该是 URL 的一部分。即使使用 SSL 等额外措施，我仍然不会在 URL 中嵌入凭据。

HTTP Basic 定义了用户名和密码必须如何加密（实际上是散列）。没有办法拥有 HTTP 和您要求的格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T02:36:29.860

您确定您的服务器确实在使用基本身份验证吗？如果是，您应该像这样设置凭据：

```
new UsernamePasswordCredentials("Login@ID", "Passsword"); 
```

否则检查实际的身份验证协议是什么并实现它（在标头中发送身份验证信息，或作为 URL 的一部分或作为 POST 参数等）

# iphone - 将 libPusher 添加到我的项目或 IOS 推送聊天应用程序中的任何示例项目？

> ID：12806024
> 
> 赞同：1
> 
> 时间：2012-10-09T18:18:54.340
> 
> 标签：iphone, objective-c, ios, ipad, pusher

我有一个 Iphone 应用程序，我想在其中使用 libpusher 库。在获得此链接的路上`https://github.com/lukeredpath/libPusher/wiki/Adding-libPusher-to-your-project`。但我仍然留下了很多选项。并没有真正解释哪些是要调用的方法，哪些是委托方法和目的.有没有人有任何伟大的教程或示例应用程序来实现这一点。我对这个 API 完全陌生。任何人都可以带我脱离这个挖掘吗？

# url - Drupal 7 - 用户通知的 URL

> ID：12806027
> 
> 赞同：2
> 
> 时间：2012-10-09T18:19:04.210
> 
> 标签：url, drupal-7, notifications

我在 Drupal 7 中使用通知模块。用户可以订阅分类术语并获取电子邮件通知。我想为用户创建一个菜单链接，以便能够查看他所做的订阅。链接是 www.example.com/user/6/notifications。

我想使用适合每个用户的东西。意思是，网址中的 6 将被替换为某些东西。我试过 www.example.com/user/ **[user-id]** /notifications。它给出了拒绝访问错误。

www.example.com/user/6/notifications 运行良好。令牌模块在站点上启用。

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T03:49:47.413

您必须使用此代码获取登录的用户 uid

$user->uid 并存储在订阅 url 中。或者可以在这个页面上使用

```
global $user
$uid = $user->uid; 
```

# javascript - 无需单击按钮即可使用 javascript 或 jquery 取消隐藏搜索结果 div

> ID：12806041
> 
> 赞同：0
> 
> 时间：2012-10-09T18:20:21.550
> 
> 标签：javascript, jquery, html, css

我现在很沮丧……而且犯了很多错误。对于那个很抱歉

我一直在尝试根据搜索结果取消隐藏特定的 div

如果没有进行搜索，则不应出现 div，这很容易使用 css，但是一旦搜索完成，我必须将样式更改为“块”。

由于我使用的是谷歌自定义搜索 javascript，因此很难将按钮替换为触发我的 javascript 函数的另一个类似按钮。

我也不知道如何将“resultDiv”替换为更复杂的路径

我已经完成了这个 javascript 函数来隐藏基于结果 div 的 div ...

css div 样式位于#main.section .widget.HTML

```
function check()
{
    if (document.getElementById('resultDiv')) {
      if ($('.gsc-expansionArea').is(":empty")) {
         document.getElementById('resultDiv').style.display = 'none';
      }
      else {
         document.getElementById('resultDiv').style.display = 'block';
      }
   }    
} 
```

我认为可能有两种可能的解决方案。首先是加载脚本

```
<body onLoad="check();"> 
```

但似乎不起作用。

其次是检查 ?q= 的 URL，这意味着搜索已完成，但我不知道如何从 URL 获取这些参数。

请帮助我。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:32:22.407

好吧，既然你已经标记了[jquery](/questions/tagged/jquery "显示标记为“jquery”的问题")：

```
$(window).load(function(){
   check();
}) 
```

你的功能 check() 可能更像

```
function check() {
    if ($('#resultDiv').length) {
        if ($('.gsc-expansionArea').is(":empty")) {
            $('#resultDiv').css({'display': 'none'})
        }
        else {
            $('#resultDiv').css({'display': 'block'})
        }
    }
} 
```

**--**

> *其次是检查 ?q= 的 URL，这意味着搜索已完成，但我不知道如何从 URL 获取这些参数。*

采用`location.search`

*   [位置搜索属性](http://www.w3schools.com/jsref/prop_loc_search.asp)
*   [MDN window.location](https://developer.mozilla.org/en-US/docs/DOM/window.location)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:27:07.210

代替

```
<body onLoad="javascript:check();"> 
```

和

```
<body onLoad="check();"> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-09T18:47:19.603

您可以使用

```
$(document).ready(function()
{ 
  check();  
} 
```

在页面加载时加载函数。您还可以使用 jQuery 简化您的功能：

```
function check()
{
  var isEmpty= $('.gsc-expansionArea').is(":empty");
  $('#resultDiv').toggle(isEmpty);
} 
```

的文档`toggle`在[这里](http://api.jquery.com/toggle/)。

# c# - 对 .pst 文件进行重复数据删除以查找唯一的电子邮件

> ID：12806042
> 
> 赞同：1
> 
> 时间：2012-10-09T18:20:23.690
> 
> 标签：c#, .net, hash, pst, deduplication

我手头有一项（看起来像是）一项大任务。
我需要浏览多个文件夹的不同归档卷（我们说的是 TB 级数据）。每个文件夹中都有一个 .pst 文件。其中一些文件夹（以及文件）可能完全相同（文件中的名称或数据）。我希望能够一次比较两个以上的文件（如果可能的话），看看是否找到了任何重复文件。找到重复项后，我需要删除它们并保留原件，然后最终提取所有唯一的电子邮件。

我知道有些程序可以找到重复项，但我不确定他们需要在这些文件中传递什么参数，我不知道他们是否可以处理如此大量的数据。我想用 C# 或 VB 编程。我不知道应该从哪里开始。有什么建议么？？

前任...

```
m:\mail\name1\name.pst

m:\mail\name2\name.pst (same exact data as the one above)

m:\mail\name3\anothername.pst (duplicate file to the other 2) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T01:40:15.707

我将通过首先递归查找所有 PST 文件，然后匹配文件长度，然后按固定的字节前缀过滤，最后执行完整的哈希或字节比较以获得实际匹配来完成查找重复项的过程。

递归地构建列表并找到潜在的匹配项可以像这样简单：

```
Func<DirectoryInfo, IEnumerable<FileInfo>> recurse = null;
recurse = di => di.GetFiles("*.pst")
    .Concat(di.GetDirectories()
        .SelectMany(cdi => recurse(cdi)));

var potentialMatches =
    recurse(new DirectoryInfo(@"m:\mail"))
        .ToLookup(fi => fi.Length)
        .Where(x => x.Skip(1).Any()); 
```

该`potentialMatches`查询按文件大小为您提供了一系列完整的潜在匹配项。

然后，我将使用以下函数（我将实现留给您）进一步过滤此列表。

```
Func<FileInfo, FileInfo, int, bool> prefixBytesMatch = /* your implementation */
Func<FileInfo, FileInfo, bool> hashMatch = /* your implementation */ 
```

通过文件长度和字节前缀限制匹配，您将显着减少超大文件所需的哈希计算。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T00:21:01.883

如果您只想删除整个重复文件，则该任务很容易实现。

您将必须浏览所有文件夹并对每个文件的内容进行哈希处理。产生的散列有一些位（例如 32 到 256 位）。*如果两个文件哈希值相等，则各个文件相同的概率极高（取决于哈希函数的抗碰撞性，读取的位数）。*

当然，现在实现取决于您（我不是 C# 或 VB 程序员），但我建议您使用类似以下伪代码的内容（接下来我会解释每个步骤并为您提供演示如何在 C# 中执行此操作的链接） ：

```
 do{
       file_byte_array = get_file_contents_into_byte_array(file)          1
       hash = get_hash from_byte_array(file_byte_array);                  2
       if(hashtable_has_elem(hashtable,hash))                             3
         remove_file(file);                                               4
       else                                                               5
         hashtable_insert_elem(hashtable,hash,file);                      6
     }while_there_are_files_to evaluate                                   7 
```

此逻辑应在所有*.pst*文件上执行。在第 1 行（我假设您打开了文件）**，您将文件的所有内容写入[字节数组。](https://stackoverflow.com/questions/2030847/best-way-to-read-a-large-file-into-byte-array-in-c)**

获得文件的字节数组后，必须使用散列函数（第 2 行）对其进行散列。您有大量的哈希函数实现可供选择。在某些实现中，您必须将文件分成块并散列每个块的内容（例如[here](https://stackoverflow.com/questions/2124468/possible-to-calculate-md5-or-other-hash-with-buffered-reads#2124500)、[here](http://msdn.microsoft.com/en-us/library/system.security.cryptography.hashalgorithm.transformblock.aspx)和[here](http://msdn.microsoft.com/en-us/library/system.security.cryptography.hashalgorithm.transformblock.aspx)）。**如果您的文件真的很大并且不适合您的记忆，那么将文件分成几部分可能是唯一的选择。**另一方面，您有许多接受整个流的函数（例如，[这里](https://stackoverflow.com/questions/6094306/hash-sha1-large-files-over-2gb-in-c-sharp#6094414)，**[这里](http://msdn.microsoft.com/en-us/library/xa627k19.aspx)是与您的问题非常相似的示例**，[这里](https://stackoverflow.com/questions/7244104/suitable-hash-code-methods-for-an-array-of-bytes#7244519)，[这里](https://stackoverflow.com/questions/7244104/suitable-hash-code-methods-for-an-array-of-bytes#7244316)，但我建议您使用超快的[MurmurHash3](http://blog.teamleadnet.com/2012/08/murmurhash3-ultra-fast-hash-algorithm.html)）。如果您有效率要求，请远离加密哈希函数，因为它们要重得多，并且您不需要加密属性来执行任务。

最后，在计算完散列之后，您只需要获取一些保存散列并比较它们的方法，以便找到相同的散列（读取文件）并删除它们（第 3-6 行）。我打算使用[哈希表](http://www.dotnetperls.com/hashtable)或[字典](http://www.dotnetperls.com/dictionary)，其中标识符（用于执行查找的对象）是文件哈希，对象 File 是条目值。

***笔记：***

**记住！！！：** *哈希值的位数越多，冲突的可能性就越小。*如果您想了解更多关于散列函数中的碰撞概率的信息，请阅读这篇[出色的文章](http://preshing.com/20110504/hash-collision-probabilities)。您必须注意此主题，因为您的目标是删除文件。**如果发生冲突，那么您将删除一个不相同的文件，并且您将永远丢失它。**有许多策略可以识别冲突，您可以将它们组合起来并添加到您的算法中（例如比较文件的大小、比较随机位置的文件内容值、使用多个哈希函数）。我的建议是使用所有这些策略。如果您使用两个散列函数，那么对于两个被认为相同的文件，它们的每个散列函数的散列值必须相等：

```
 file1, file2;
    file1_hash1  = hash_function1(file1);
    file2_hash1  = hash_function1(file2);
    file1_hash2  = hash_function2(file1);
    file2_hash2  = hash_function2(file2);

    if(file1_hash1 == file2_hash1 &&
       file2_hash2 == file2_hash2)
      // file1 is_duplicate_of file2;
    else
      // file1 is_NOT_duplicate_of file2; 
```

# php - PHP请求在服务器中被阻止

> ID：12806048
> 
> 赞同：1
> 
> 时间：2012-10-09T18:20:50.477
> 
> 标签：php, apache, unix, block

在向 Apache 服务器发送 PHP POST 请求时，该请求被服务器阻止。我收到了禁止的错误。这对于某些请求非常具体。在请求中，我发送 html 数据并将 html 数据保存在 MYSQL 数据库中。我使用的是unix操作系统。

我正在尝试保存一些句子，例如， `process = runtime.exec("");` 我发送上面的句子我得到了禁止的错误，否则我得到了成功的响应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:38:47.300

我认为您的服务器设置禁止某些 URL 参数值。一个类似的例子（对于 Struts），解释了为什么可以在这里找到：[https ://www.sec-consult.com/files/20120104-0_Apache_Struts2_Multiple_Critical_Vulnerabilities.txt](https://www.sec-consult.com/files/20120104-0_Apache_Struts2_Multiple_Critical_Vulnerabilities.txt)

你可以尝试用一些编码来欺骗它（我怀疑这会起作用）或者用一些无害的东西代替“.exec（”这个词。

# php - 使用 php echo 包括来自另一个站点的特定 html 元素

> ID：12806050
> 
> 赞同：0
> 
> 时间：2012-10-09T18:20:56.883
> 
> 标签：php, html, include, echo, include-path

我是 php 的新手（昨天开始），我有一个不错的 html/css 背景和一点 js，所以我想试一试。

我正在尝试构建一个简单的应用程序来自学 php，并且我想从另一个站点引用一段 html，例如 div ：

`<div id="name"> <p>Sam</p> </div>`在“http://www.example.com/about.php”页面上

我正在尝试的是`<?php echo file_get_contents("http://www.example.com #name"); ?>`正确的方法吗？

我也无法确定是否更好使用`include` `echo`或`echo file_get_contents`

抱歉这么基本的问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:29:14.280

这可以用 来完成[`DOMDocument`](http://uk1.php.net/manual/en/class.domdocument.php)，这里有一个例子：

```
$doc = new DOMDocument();
$doc->loadHTMLFile('http://example.com/');

// get the element that has id=name
$result = $doc->getElementById('name');

echo $result->nodeValue; // prints: Sam

// or print out $result to see all of the properties
print_r($result); 
```

# haskell - 获取终端宽度 Haskell

> ID：12806053
> 
> 赞同：8
> 
> 时间：2012-10-09T18:21:02.253
> 
> 标签：haskell, console, functional-programming, terminal, ioctl

如何在 Haskell 中获取终端的宽度？

我尝试过的事情

```
System.Posix.IOCtl (could not figure out how to get it to work) 
```

这只适用于unix。

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-09T19:58:28.627

如果您不想依赖 ncurses，这里是`ioctl()`使用 FFI 的适当请求的包装器，基于[在 C 中获取终端宽度的接受答案？](https://stackoverflow.com/a/1022961/98117)

**术语大小.hsc**

```
{-# LANGUAGE ForeignFunctionInterface #-}

module TermSize (getTermSize) where

import Foreign
import Foreign.C.Error
import Foreign.C.Types

#include <sys/ioctl.h>
#include <unistd.h>

-- Trick for calculating alignment of a type, taken from
-- http://www.haskell.org/haskellwiki/FFICookBook#Working_with_structs
#let alignment t = "%lu", (unsigned long)offsetof(struct {char x__; t (y__); }, y__)

-- The ws_xpixel and ws_ypixel fields are unused, so I've omitted them here.
data WinSize = WinSize { wsRow, wsCol :: CUShort }

instance Storable WinSize where
  sizeOf _ = (#size struct winsize)
  alignment _ = (#alignment struct winsize) 
  peek ptr = do
    row <- (#peek struct winsize, ws_row) ptr
    col <- (#peek struct winsize, ws_col) ptr
    return $ WinSize row col
  poke ptr (WinSize row col) = do
    (#poke struct winsize, ws_row) ptr row
    (#poke struct winsize, ws_col) ptr col

foreign import ccall "sys/ioctl.h ioctl"
  ioctl :: CInt -> CInt -> Ptr WinSize -> IO CInt

-- | Return current number of (rows, columns) of the terminal.
getTermSize :: IO (Int, Int)
getTermSize = 
  with (WinSize 0 0) $ \ws -> do
    throwErrnoIfMinus1 "ioctl" $
      ioctl (#const STDOUT_FILENO) (#const TIOCGWINSZ) ws
    WinSize row col <- peek ws
    return (fromIntegral row, fromIntegral col) 
```

这使用[`hsc2hs`预处理器](http://www.haskell.org/ghc/docs/latest/html/users_guide/hsc2hs.html)根据 C 标头计算出正确的常量和偏移量，而不是对它们进行硬编码。我认为它与 GHC 或 Haskell 平台一起打包，所以你很可能已经拥有它。

如果您使用的是 Cabal，您可以添加`TermSize.hs`到您的`.cabal`文件中，它会自动知道如何从`TermSize.hsc`. 否则，您可以`hsc2hs TermSize.hsc`手动运行以生成一个`.hs`文件，然后您可以使用 GHC 编译该文件。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-09T18:35:14.557

你可以使用[hcurses](http://hackage.haskell.org/package/hscurses)。初始化库后，您可以使用它`scrSize`来获取屏幕上的行数和列数。

要使用`System.Posix.IOCtl`，您必须定义一个数据类型来表示`TIOCGWINSZ`请求，它填充以下结构：

```
struct winsize {
    unsigned short ws_row;
    unsigned short ws_col;
    unsigned short ws_xpixel;   /* unused */
    unsigned short ws_ypixel;   /* unused */
}; 
```

您需要定义一个 Haskell 数据类型来保存此信息，并使其成为以下实例`Storable`：

```
{-# LANGUAGE RecordWildCards #-}
import Foreign.Storable
import Foreign.Ptr
import Foreign.C

data Winsize = Winsize { ws_row    :: CUShort
                       , ws_col    :: CUShort
                       , ws_xpixel :: CUShort
                       , ws_ypixel :: CUShort
                       }

instance Storable Winsize where
  sizeOf _ = 8
  alignment _ = 2
  peek p = do { ws_row    <- peekByteOff p 0
              ; ws_col    <- peekByteOff p 2
              ; ws_xpixel <- peekByteOff p 4
              ; ws_ypixel <- peekByteOff p 6
              ; return $ Winsize {..}
              }
  poke p Winsize {..} = do { pokeByteOff p 0 ws_row
                           ; pokeByteOff p 2 ws_col
                           ; pokeByteOff p 4 ws_xpixel
                           ; pokeByteOff p 6 ws_ypixel
                           } 
```

现在，您需要创建一个虚拟数据类型来表示您的请求：

```
data TIOCGWINSZ = TIOCGWINSZ 
```

最后，您需要将您的请求类型设为 的实例`IOControl`，并将其与`Winsize`数据类型相关联。

```
instance IOControl TIOCGWINSZ Winsize where
  ioctlReq _ = ?? 
```

您需要用头文件（在我的系统上）中`??`表示的常量替换 。`TIOCGWINSZ``0x5413`

现在，您已准备好发布`ioctl`. 此命令不关心输入数据，因此您要使用以下`ioctl'`形式：

```
main = do { ws <- ioctl' 1 TIOCGWINSZ
          ; putStrLn $ "My terminal is " ++ show (ws_col ws) ++ " columns wide"
          } 
```

请注意，1 指的是 STDOUT。

呸！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-10T04:04:30.093

由于您仅在 Unix 上需要它，我建议：

`resizeOutput <- readProcess "/usr/X11/bin/resize" [] ""`

然后对输出进行一点解析。这可能不是 100% 可移植的，但我相信您可以提供`resize`参数（`-u`特别是检查），因此您将获得相当一致的输出。

# mysql - SQL：查询整个数据库

> ID：12806054
> 
> 赞同：0
> 
> 时间：2012-10-09T18:21:03.127
> 
> 标签：mysql, sql, database

我是一个完整的 SQL 初学者。我正在使用一个查询数据库的程序，然后处理结果。默认查询是：

```
SELECT * 
FROM data, 
     questions, 
     users 
where users.U_Id = data.Subj_Id 
  and data.Subj_Id between 1 and 10 
  and data.Q_Id = questions.Q_Id 
  and questions.Q_Id between 1 and 10 
order by Subj_Id; 
```

我希望它查询每`Subj_Id`一个`Q_Id`. 我不知道有多少，不同的科目有不同的问题。我应该如何更改上述查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:23:53.577

您可以像这样重写上面的查询。

```
select * 
from 
    data 
        inner join 
    users on users.U_Id = data.Subj_Id 
        inner join 
    questions on data.Q_Id = questions.Q_Id 
where data.Subj_Id between 1 and 10 
and questions.Q_Id between 1 and 10 
order by Subj_Id; 
```

通过将表之间的连接与数据的过滤器分开，这使得它更加清晰。所以要查询整个数据库，你只需`where`从上面删除子句......

```
select * 
from 
    data 
        inner join 
    users on users.U_Id = data.Subj_Id 
        inner join 
    questions on data.Q_Id = questions.Q_Id 
order by Subj_Id; 
```

# css - 我必须使用 Compass 来使用 Django-Grappelli 修改 CSS 吗？

> ID：12806056
> 
> 赞同：0
> 
> 时间：2012-10-09T18:21:09.910
> 
> 标签：css, django, compass-sass, django-grappelli

我最近在我的第一个 django 应用程序上设置了 django-grappelli。虽然我喜欢它的外观，但我想自定义颜色和其他 CSS。

根据我的研究，看起来我将不得不使用 Compass，但我以前从未使用过 Compass，并且想在我踏上这条道路之前仔细检查这是不是最好的方法！

*对于想要自定义颜色主题的人来说，Django-grapelli 是否是正确的选择？*

**我尝试过的事情**

1.  修改 Grappelli 样式表中的 CSS，但它们的格式使其变得乏味。
2.  扩展样式表，但我不确定在哪里为管理员执行此操作。
3.  创建一个 custom.css 但不知道该把路径放在哪里

谢谢你的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:57:19.397

在我看来 Compass 只是一个编写 CSS 的工具。我从未使用过它，但目前我看不出它如何使修改管理界面比手动操作更容易！

每当我对管理员进行更改（我已经对 进行了更改`Grappelli`，就像您尝试做的那样），我总是使用您列出的第 2 项。我从来没有遇到过任何麻烦！如果您想再试一次，我可以尝试帮助您。

我首先要做的是转到我的`Python`安装目录并`Grappelli`从`Lib/site-packages`. 我将此代码作为项目级应用程序放在我的项目目录中。因此，如果您正在使用`Django 1.4`，您将拥有一个包含项目文件夹以及其中的文件夹`manage.py`。把代码放在那里。

然后，使用您最喜欢的 Web 开发人员工具（我更喜欢 Chrome 的），找出您需要修改的样式表以及`css`它所在的文件。我通过右键单击元素并选择 Inspect Element 来做到这一点。这会调出开发工具，并在右侧告诉您`css`它引用的文件以及它所在的行。如果您在您喜欢的文本编辑器中打开该`css`文件并对其进行更改，它应该可以工作！

如果您对此有任何问题，请告诉我。我可以尝试进一步帮助你。

（而且，PS，我并没有试图对 Chrome 的开发者工具的使用有一个基本的概述。我只是想通过不假设任何事情来提供帮助。我希望你不要把它当作一种侮辱。）

# javascript - 如何使用 javascript/jquery 在时间字符串中添加一秒

> ID：12806059
> 
> 赞同：3
> 
> 时间：2012-10-09T18:21:12.910
> 
> 标签：javascript, timer, seconds

我正在尝试使用 Javascript 创建一个计时器，但我不知道如何在时间字符串中添加一秒。

时间字符串：03:31:15

```
function updateWorked() {
        var time = $("#worked").html();
        ???
        $("#worked").html(wtime);
}

$(document).ready(function() {
    setInterval('updateWorked()', 1000);
}); 
```

我应该在“？？？”中写什么？使这项工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T18:31:22.110

假设您首先使用 PHP 之类的东西来获取时间字符串，并且您无法按照 Marc B 的建议将日期/时间作为数字来跟踪，您可以像这样自己解析字符串：

```
var $worked = $("#worked");
var myTime = $worked.html();
var ss = myTime.split(":");
var dt = new Date();
dt.setHours(ss[0]);
dt.setMinutes(ss[1]);
dt.setSeconds(ss[2]);
var dt2 = new Date(dt.valueOf() + 1000);
var ts = dt2.toTimeString().split(" ")[0];
$worked.html(ts); 
```

**编辑：**[在此](http://jsfiddle.net/6aYzw/)代码中工作 jsFiddle 。

这是带有计时器的代码：[jsFiddle](http://jsfiddle.net/6aYzw/1/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-09T18:44:51.960

下面是一个关于如何在时间字符串中添加秒的示例。您可以使用日期对象以您想要的任何格式打印出字符串，在此示例中，我只是使用内置 toTimeString 方法。

```
var timeString = "10/09/2012 14:41:08";
// start time
var startTime = new Date(timeString);
// prints 14:41:08 GMT-0400 (EDT)
console.log(startTime.toTimeString())
// add a second to the start time
startTime.setSeconds(startTime.getSeconds() + 1);
// prints 14:41:09 GMT-0400 (EDT)
console.log(startTime.toTimeString()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T18:37:19.763

如果您尝试实时保持计数器，则应使用`new Date()`获取时间，然后对其进行格式化：

```
function updateWorked() {
    var time = new Date(),
        wtime = formatDate(time);
    $("#worked").html(wtime);
} 
```

但是，如果您试图保持特定时间，那么您应该扩大 Date 对象的范围并使用它：

```
var time = new Date(/* your starting time */);
function updateWorked() {
    time.setTime(time.getTime()+1000);
    var wtime = formatDate(time);
    $("#worked").html(wtime);
} 
```

此外，您还想添加一个`formatDate`功能：

```
function formatDate(date) {
  var hours = date.getHours().toString();
  if (hours.length < 2) hours = '0'+hours;
  var minutes = date.getMinutes().toString();
  if (minutes.length < 2) minutes = '0'+minutes;
  var seconds = date.getSeconds().toString();
  if (seconds.length < 2) seconds = '0'+seconds;
  return hours+':'+minutes+':'+seconds;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-09T18:40:13.403

使用 jquery 和 javascript 的混合你可以实现这个例子。

我厌倦了实现您要寻找的东西，首先创建了一个日期对象并获取时间、分钟和秒的所有值，然后替换该值。请看一下jsfiddle

**演示**

[http://jsfiddle.net/saorabhkr/xtrpK/](http://jsfiddle.net/saorabhkr/xtrpK/)

# line - 将标签内的多行粘贴为单独的行 - Sublime text

> ID：12806061
> 
> 赞同：26
> 
> 时间：2012-10-09T18:21:18.713
> 
> 标签：line, sublimetext, copy-paste, tabular

我必须在 html 页面中设置标题/作者项目列表，其中每个标题/作者行都`<li>`像这样：

```
<ul>
  <li> title name - <em>author name</em></li>
  <li> title name - <em>author name</em></li>
  <li> title name - <em>author name</em></li>
  and so on...
</ul> 
```

他们给了我一个包含两列的 Excel 文件，一列标题，一列作者，大约 90-100 行。

获得`<li>`上述 s 列表的最佳和最快方法是什么？（我使用 Sublime Text 2）

只需在 Sublime Text 2 中复制/粘贴，我对每个标题/作者行都有一个单独的行，就像这样

```
title name author name
title name author name
title name author name 
```

没有其他的..

我可以轻松地将每一行包装在`<li>`thx 中：

*   菜单**选择**- >**拆分为行**（Cmd/Ctlr + Shift + L）

    并输入标签，但随后我坚持以一种自动方式插入标题后的破折号（ - ）和`<em>`s作者。

    我最好的猜测是（但我真的不知道该怎么做）找到一种方法来复制/粘贴一堆行，然后将它们粘贴到每个光标所在的位置，每个光标都像这样单独一行（考虑**`|`**as光标）：

    ```
    *copy* authors name as single lines

    |author name1
    |author name2
    |author name3 
    |author name4

    *paste* authors as single line each where the cursor "|" stands

    <li>title name - <em> |author name1 </em></li>
    <li>title name - <em> |author name2 </em></li>
    <li>title name - <em> |author name3 </em></li>
    <li>title name - <em> |author name4 </em></li> 
    ```

    不幸的是，实际发生的事情（在崇高的文本 2 中）是这样的：

    ```
    <li>title name - <em> |author name1
                           author name2
                           author name3 
                           author name4 </em></li>
    <li>title name - <em> |author name1
                           author name2
                           author name3 
                           author name4 </em></li>
    <li>title name - <em> |author name1
                           author name2
                           author name3 
                           author name4 </em></li>
    <li>title name - <em> |author name1
                           author name2
                           author name3 
                           author name4 </em></li> 
    ```

    所有复制的行都简单地粘贴到每个光标的块中

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-10-09T20:38:19.677

可能您只需要验证复制到剪贴板的行数是否与用 ++ 分割的行数相`CMD`匹配。`SHIFT``L`

如果它们匹配，Sublime Text 会按照您的预期运行，将每个源行复制到每个目标行（至少在我的机器上...... :)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-23T18:55:16.137

我实际上刚刚找到了这个问题的答案，并想分享以防万一其他人遇到这个问题。Riccardo 是对的，但我可以扩展。

当源和目标的数量不匹配时，当您希望粘贴到位时，Sublime 将粘贴到块中。当有额外的硬回报或额外的元素时，我遇到了你的错误。举个例子。

```
|author name1
|author name2 
```

将触发 Sublime 将两个值粘贴到位，因为有**两个源**值和*一个目标元素。*

```
<li>title name - <em> |author name1
                       author name2 </em></li> 
```

因此，就 Riccard 而言，您可能选择了一些额外的东西，Sublime 认为这是额外的价值。

所以要解决这个问题，你需要有相同的来源和目标。

```
|author name1
|author name2

<li>title name - <em> |author name1 </em></li>
<li>title name - <em> |author name2 </em></li> 
```

# java - Java中两个对象包的联合

> ID：12806064
> 
> 赞同：3
> 
> 时间：2012-10-09T18:21:48.230
> 
> 标签：java, object, interface, union, bag

我需要有关 Java 作业问题的帮助。我有两个袋子，比如说包含`bag1`字符串`A`、和 ，`B`并且包含字符串、和。我需要为这两个包的联合编写一个 BagInterface ，然后是一个类调用。`C``D``bag2``E``F``G``H``ArrayBag<T> implements BagInterface<T>`

BagInterface 我在想这样的事情：

```
public interface BagInterface<T> {

    public T union(T[] item);
}

public class ArrayBag<T> implements BagInterface<T> {

    private final static int DEFAULT_CAP = 4;
    private int numElements;
    private T[] bag;

    public ArrayBagR(int cap) {
        bag = (T[]) new Object[cap];
        this.numElements = 0;
    }

    public T union(T[] item) {

        // Not sure how I should write this so I can pass
        // another class object in the parameter

        // Like say if I write a main to run this I could
        // do something like Bag1.union(Bag2)
        // and get something like A B C D E F G H
    }
} 
```

就像说如果我有这个

```
public static void main(String[] args) {
    BagInterface bag1 = new ArrayBag(n);
    BagInterface bag2 = new ArrayBag(m);
    BagInterface<String> everything = bag1.union(bag2);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:28:21.953

根据你的例子，

```
BagInterface bag1 = new ArrayBag(n);
BagInterface bag2 = new ArrayBag(m);
BagInterface<T> everything =  bag1.union(bag2); 
```

当你打电话时，`union`作为参数`bag1`传递，`bag2`

```
 this.bag -> represents bag1
 item in the argument represent bag2 
```

现在你可以写一些东西了。无需从此方法返回。**`bag1`将与联合更新。**

```
 public BagInterface<T> union(T[] item) {
    T[] everything = thi.bag;
    for(T elem: item){
       if(not(this.bag contains elem )){
          everything  -> add(elem);
       }
    }
    return this;
 } 
```

请注意：这是共享概念的伪代码（不是代码）。

示例 java 代码如下所示：

```
 public BagInterface<T>  union(T[] item) {
        List<T> unionList = Arrays.asList(this.bag);
        for(T elem: item){
           boolean present = false;
           for(T elem1: this.bag){
              if(elem1.equals(elem)){
                  present = true;
              }
           }
           if(!present){
               unionList.add(elem);
           }
        }
       this.bag = unionList.toArray(new Bag[unionList.size()]);
       return this;
     } 
```

您还可以进一步使用`List`方法`contains`将代码简化为：

```
 public BagInterface<T> union(T[] item) {
        List<T> unionList = Arrays.asList(this.bag);
        for(T elem: item){
           if(!unionList.contains(elem)){
               unionList.add(elem);
           }
        }
        this.bag = unionList.toArray(new Bag[unionList.size()]);
        return this;
     } 
```

如果你不想更新`bag1`内容，你应该有这样的方法：

```
 public BagInterface<T> union(T[] item2) {
                BigInterface<T> everything = new BagArray<T>();
        List<T> unionList = Arrays.asList(this.bag);
        for(T elem: item){
           if(!unionList.contains(elem)){
               unionList.add(elem);
           }
        }
        everything.setBags(unionList.toArray(new Bag[unionList.size()]));
        return everything;
     } 
```

# perl - 将“值”函数应用于哈希或数组引用的状态如何？

> ID：12806066
> 
> 赞同：3
> 
> 时间：2012-10-09T18:21:53.563
> 
> 标签：perl

鉴于这`$struct`是一个可以是哈希或数组引用的数据结构，我有一些看起来像这样的代码：

```
for (ref($struct) eq "HASH" ? values %$struct : values @$struct) {  
    # process $_
    ...
} 
```

我想使用该函数的新`values`功能（接受对 unblessed 哈希或数组的引用）来编写它，这在我的 5.14.2 版本中有效：

```
for (values $struct) {  
    # process $_ 
    ...
} 
```

漂亮多了！

但是文档`values`说这个功能是“高度实验性的”。它现在已经发布了几个版本（据我所知，从 5.12 到 5.16.0）。有谁知道是什么状态？实验进展如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:25:34.920

它被标记为实验性的，因为它是一个有争议的变化。这是有争议的，因为它不适用于所有对哈希的引用。* 自引入该功能以来没有发现任何新问题，但我认为没有人期望会发现任何新问题。

* * *

* —`values($hash)`可能会失败的地方`values(%$hash)`会成功。您的原始代码具有完全相同的问题，因此这种“限制”对`values`您来说不是问题。

# python - 在 Python 中解析和添加文件的内容

> ID：12806068
> 
> 赞同：-4
> 
> 时间：2012-10-09T18:22:06.187
> 
> 标签：python, parsing, sum

我正在做的是我有一个包含一些数据的文件，如下所示：

```
ben     | 2 | 40
germany | 6 | 60 
```

我需要的输出是::

```
ben     | 2 | 40
germany | 6 | 60

field 1 =   8
field 2 = 100 
```

请建议我一些解决方案以在 Python 中继续前进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:29:18.353

这对我来说有家庭作业的味道，所以我将尝试坚持提供一些指示，而不是一个彻底的解决方案。

您可以使用 Python 的`open()`函数打开文件。生成的对象可以在循环中迭代，例如`for line in myfile:`. 完成文件后，您应该调用`myfile.close()`，您可以在“附加”模式下重新打开它以在最后写下答案。

每行都是一个字符串，您可以调用`line.split('|')`将行分成块。我喜欢使用多重赋值：`name, col1, col2 = line.split('|')`. 您可能需要使用`int()`将数字从字符串格式强制转换为整数格式，以便您可以将它们相加。

我认为这可能是一个非常可靠的开始，对吧？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:27:58.447

可能有更优雅的方式来做到这一点......

```
results = [0, 0]
with open("\path\to\file.txt") as f:
    for line in f:
        values = line.split("|")
        results[0] += int(values[1])
        results[1] += int(values[2])

print("field 1 = " + str(results[0]), "field 2 = " + str(results[1])) 
```

# c# - Json.net 捕获重复项并引发错误

> ID：12806080
> 
> 赞同：0
> 
> 时间：2012-10-09T18:22:45.343
> 
> 标签：c#, json, json.net

> **可能重复：**
> [Json.NET (Newtonsoft.Json) - 两个同名的“属性”？](https://stackoverflow.com/questions/3877526/json-net-newtonsoft-json-two-properties-with-same-name)

我正在使用 JSON.NET 将 JSON 文件反序列化为字典。现在我想做的是有以下行：

```
JsonConvert.DeserializeObject<IDictionary<string, object>>(text); 
```

如果 JSON 中有重复的条目，则抛出异常，如下所示：

```
{
    "ExampleText": "Example 1",
    "ExampleText": "Example 2",
    "ExampleText": "Example 3",
} 
```

标准的 JSON.NET 行为是简单地将“ExampleText”条目替换为 JSON 中最后的条目。是否可以抛出异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:53:01.917

**- 编辑 -**

您不需要反序列化为`IDictionary<string, object>`. `JObject`已经实现`IDictionary<string, JToken>`

```
var obj = (JObject)JsonConvert.DeserializeObject(json); //will throw exception for dublicates.
var str = (string)obj["ExampleText"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:40:30.907

如果您查看 msdn 中的 IDictionary

> “每个关联必须有一个唯一的键”

您在重复键中的问题。我认为你应该使用另一个集合。

尝试这个

```
class MyValue
{
  public string Key {get; set;}
  public string Value {get; set;}
}

JsonConvert.DeserializeObject<List<MyValue>>(text); 
```

# jquery-plugins - 带有 click 和 ajaxForm 调用的 Jquery 就绪函数

> ID：12806084
> 
> 赞同：0
> 
> 时间：2012-10-09T18:23:17.017
> 
> 标签：jquery-plugins, ajaxform, ready

我真的是使用 JQuery 的新手，我的代码中有错误。当用户单击“按钮”时，下一段代码运行良好，它将文件加载到内容 div 中。

```
 $(document).ready(function() {

        $('.Button').click(function() {
        var href = $(this).attr('href');

        if( typeof href != "undefined" && href != ""){
            $.ajax({
                url: href,
                dataType: 'text',
                success: function(data) {
                            $('#content').html(data);
                            ultXML = href;
                }
            });
        }
    });

}); 
```

但是现在我正在尝试使用 JQuery Form 插件（使用此示例[http://www.malsup.com/jquery/form/](http://www.malsup.com/jquery/form/)）并且它不起作用（ajaxForm 调用），我无法理解如何合并我的下一个代码原始码。我尝试了很多方法，例如制作 2 个准备好的功能，但它也不起作用，

```
 $(document).ready(function() { 
            // bind 'myForm' and provide a simple callback function 
            $('#myForm').ajaxForm(function() { 
                alert("Thank you for your comment!"); 
            }); 
        }); 
```

我必须将下一段代码放在我原来的就绪函数中的什么地方？怎么可能两者兼得？

```
 $('#myForm').ajaxForm(function() { 
                alert("Thank you for your comment!"); 
            }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:35:35.650

像这样，工作？

```
$(document).ready(function() {

$('.Button').click(function() {
    var href = $(this).attr('href');

    if( typeof href != "undefined" && href != ""){
        $.ajax({
            url: href,
            dataType: 'text',
            success: function(data) {
                        $('#content').html(data);
                        ultXML = href;
            }
        });
    }
});

$('#myForm').ajaxForm(function() { 
    alert("Thank you for your comment!"); 
}); 
```

});

# mysql - mysql上的代码有什么问题

> ID：12806085
> 
> 赞同：0
> 
> 时间：2012-10-09T18:23:19.103
> 
> 标签：mysql

很傻的问题。我是初学者并试图将其导入 MySQL，但它不起作用并告诉我在第 1 行附近有错误。

```
CREATE TABLE `clown_info` (
 `name` varchar(50) default NULL,
 `last_seen` varchar(50) default NULL,
 `appearance` varchar(50) default NULL,
 `activities` varchar(50) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

INSERT INTO clown_info VALUES ('Elsie', 'Cherry Hill Senior Center', 'F, red hair, green dress, huge feet', 'balloons, little car');
INSERT INTO clown_info VALUES ('Pickles', 'Jack Green\'s party', 'M, orange hair, blue suit, huge feet','mime');
INSERT INTO clown_info VALUES ('Snuggles' ,'Ball?Mart' ,'F, yellow shirt, baggy red pants', 'horn, umbrella');
INSERT INTO clown_info VALUES ('Mr. Hobo' ,'Party for Eric Gray' ,'M, cigar, black hair, tiny hat violin');
INSERT INTO clown_info VALUES ('Clarabelle' ,'Belmont Senior Center' ,'F, pink hair, huge flower, blue dress', 'yelling, dancing');
INSERT INTO clown_info VALUES ('Scooter', 'Oakland Hospital' ,'M, blue hair, red suit, huge nose', 'balloons'); 
INSERT INTO clown_info VALUES ('Zippo' ,'Millstone Mall', 'F, orange suit, baggy pants', 'dancing'); 
INSERT INTO clown_info VALUES ('Babe', 'Earl’s Autos' ,'F, all pink and sparkly', 'balancing, little car');
INSERT INTO clown_info VALUES ('Bonzo' ,'','M, in drag, polka dotted dress', 'singing, dancing');
INSERT INTO clown_info VALUES ('Sniffles' ,'Tracy\'s', 'M, green and purple suit, pointy nose',''); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:27:42.287

```
INSERT INTO clown_info VALUES ('Mr. Hobo' ,'Party for Eric Gray' ,'M, cigar, black hair, tiny hat violin'); 
```

**列数与值数不匹配**

正在插入 4 列和 3 个值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:28:05.600

以下`INSERT`行失败：

```
INSERT INTO clown_info VALUES ('Mr. Hobo' ,'Party for Eric Gray' ,'M, cigar, black hair, tiny hat violin');
[Err] 1136 - Column count doesn't match value count at row 1 
```

您的表有 4 列，但该语句仅插入 3。

# iphone - 如何控制子视图的大小和布局？

> ID：12806091
> 
> 赞同：1
> 
> 时间：2012-10-09T18:23:44.583
> 
> 标签：iphone, objective-c, ios, ipad, uiviewcontroller

我正在深入研究 iOS 开发，并试图弄清楚如何控制多个子视图（在本例中为两个子视图）的大小和布局。我在不同的上下文中发布了这个问题，但我的问题没有得到回答，所以我将它作为一个更简单的问题重新发布。我试图添加到子视图并将它们分别定位在 (0, 0) 和 (100, 100) 处，但是我添加的第一个视图（主视图）最终填满了整个屏幕。我的代码很简单，我做错了什么阻止我控制两个子视图的大小和位置？

**MySplitViewController.m**

```
#import "MySplitViewController.h"
#import "MasterViewController.h"
#import "DetailViewController.h"

@interface MYSplitViewController (){}

@property (nonatomic, strong) MasterViewController *masterViewController;
@property (nonatomic, strong) DetailViewController *detailViewController;

@end

@implementation MySplitViewController

- (id)initWithCoder:(NSCoder *)aDecoder{
    self = [super initWithCoder:aDecoder];
    if (self) {
      self.masterViewController = [[MasterViewController alloc] initWithNibName:nil bundle:nil];
      self.detailViewController = [[DetailViewController alloc] initWithNibName:nil bundle:nil];
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    self.view.frame = CGRectMake(0, 0, 768, 1004);
    [self.view addSubview:self.masterViewController.view];
    [self.masterViewController viewDidLoad];
    [self.view addSubview:self.detailViewController.view];
    [self.detailViewController viewDidLoad];
}

@end 
```

**主视图控制器.m**

```
#import "MasterViewController.h"

@interface MasterViewController ()

@end

@implementation MasterViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
    }
    return self;
}

- (void)viewDidLoad {
    [super viewDidLoad];
    UITableView *table = [[UITableView alloc] initWithFrame:CGRectMake(0, 0, 100, 1004) style:UITableViewStylePlain];
    table.dataSource = self;
    table.delegate = self;
    [self.view addSubview:table];
}

@end 
```

**细节视图控制器.m**

```
#import "DetailViewController.h"

@interface DetailViewController ()

@end

@implementation DetailViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
    }
    return self;
}

- (void)viewDidLoad {
    [super viewDidLoad];
    UIView *uiview = [[UIView alloc] initWithFrame:CGRectMake(100, 0, 668, 1004)];
    [self.view addSubview:uiview];
}

@end 
```

非常感谢您的智慧！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:32:09.683

`self.masterViewController.view`尝试在添加为子`self.detailViewController.view`视图之前设置框架`self.view`。

例如：-

```
self.masterViewController.view.frame = CGRectMake(0, 0, 100, 100);
self.detailViewController.view.frame = CGRectMake(100, 100, 200, 200); 
```

而且你不应该`viewDidLoad`直接调用方法。一旦视图加载到屏幕上，它就会自动调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T19:10:21.033

您应该`UIView`为 MySplitViewController 视图创建派生类并实现`layoutSubviews`方法

# android - Android WebView 在设备上动画视图时闪烁错误

> ID：12806094
> 
> 赞同：5
> 
> 时间：2012-10-09T18:24:00.557
> 
> 标签：android, android-emulator, android-webview, android-animation

我正在尝试实现滑入式导航（例如 Facebook、Path 或 Google+ Android 应用程序）。[可以在此处找到](https://bitbucket.org/robertkarl/slide-navigation-web-view)重现此错误的完整来源。

然而，当在设备上制作屏幕外的动画`WebView`时，会发生闪烁，就好像设备`WebView`在将其从屏幕上推出之前正在咬我一口。

![WebView 幻灯片导航菜单 IN（设备）](../Images/70e6c84e9add92dd8f9a295d3f4a290d.png)

仿真器上不会出现神器！动画顺利进行。

![WebView 幻灯片导航菜单 IN（模拟器）](../Images/95cb7ffb6b92add28e42ba607d954a17.png)

有趣的是，这种闪烁似乎只发生在动画视图为`WebView`! 这是使用 TextView 作为主要内容视图的同一个项目。

![TextView 幻灯片导航菜单 IN（设备）](../Images/7e5448f65a81c89ff5121993df0830b9.png)

Web 视图活动的布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/blue" >

    <WebView
        android:id="@+id/web_content"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true" />

</RelativeLayout> 
```

对于文本视图活动：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/blue" >

    <TextView
        android:id="@+id/web_content"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Hello there. no flicker!"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
         />

</RelativeLayout> 
```

调用代码以滑动导航菜单：

```
 private void slideIn() {
        LinearLayout actionBarFrame = (LinearLayout) findViewById(android.R.id.content).getParent();

        LayoutInflater inflater = (LayoutInflater) getSystemService(LAYOUT_INFLATER_SERVICE);
        menuView = inflater.inflate(R.layout.menu, null);
        menuView.setLayoutParams(new FrameLayout.LayoutParams(SIZE, LayoutParams.MATCH_PARENT, Gravity.LEFT));
        FrameLayout decorView = (FrameLayout) getWindow().getDecorView();
        decorView.addView(menuView);
        decorView.bringChildToFront(actionBarFrame);

        FrameLayout.LayoutParams params = (FrameLayout.LayoutParams) actionBarFrame.getLayoutParams();
        params.setMargins(SIZE, 0, -SIZE, 0);
        actionBarFrame.setLayoutParams(params);

        TranslateAnimation ta = new TranslateAnimation(-SIZE, 0, 0, 0);
        ta.setDuration(DURATION); 
        actionBarFrame.startAnimation(ta);
    } 
```

并将其滑出：

```
 private void slideOut() {
        LinearLayout actionBarFrame = (LinearLayout) findViewById(android.R.id.content).getParent();

        FrameLayout.LayoutParams params = (FrameLayout.LayoutParams) actionBarFrame.getLayoutParams();
        params.setMargins(0, 0, 0, 0);
        actionBarFrame.setLayoutParams(params);

        TranslateAnimation ta = new TranslateAnimation(SIZE, 0, 0, 0);
        ta.setDuration(DURATION);
        ta.setAnimationListener(new  AnimationListener() {
            @Override 
            public void onAnimationEnd(Animation arg0) {
                ((FrameLayout) getWindow().getDecorView()).removeView(menuView);
                menuView = null;
            }
            @Override public void onAnimationRepeat(Animation arg0) { }
            @Override public void onAnimationStart(Animation arg0) { }
        });
        actionBarFrame.startAnimation(ta);
    } 
```

我将代码作为公共存储库上传到[BitBucket](https://bitbucket.org/robertkarl/slide-navigation-web-view)，因此您可以像我一样尝试这个项目。

任何有关为什么会发生这种情况或如何解决它的帮助或想法将不胜感激！所需要的是平滑地动画`WebView`出图片并重新进入。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T08:51:14.600

一般来说，问题似乎与`WebViews`在 3.0+ 设备上启用硬件加速时的错误有关。我也尝试过使用[滑动菜单](https://github.com/jfeinstein10/SlidingMenu)库，`WebView`但遇到了同样的闪烁问题。环顾四周后，我在这里找到了解决方法：

[如果启用了硬件加速（Android 3.0+），WebView 会以白色背景“闪烁”](https://stackoverflow.com/questions/9476151/webview-flashing-with-white-background-if-hardware-acceleration-is-enabled-an)

变通方法使用以下代码将图层类型设置`WebView`为软件渲染：

```
webview.setLayerType(View.LAYER_TYPE_SOFTWARE, null); 
```

这段代码为我解决了闪烁问题，但缺点是性能较低。

# objective-c - 为 NSOpenPanel 取消按钮设置自定义标题

> ID：12806104
> 
> 赞同：1
> 
> 时间：2012-10-09T18:24:53.690
> 
> 标签：objective-c, xcode, macos, cocoa, nsopenpanel

我试过用这个：

1）创建`NSOpenPanelExtension.h`包含以下内容的文件：

```
#import <Cocoa/Cocoa.h>

@interface NSOpenPanel (Extension)

- (void)setCancelButtonTitle:(NSString *)newTitle;

@end 
```

2）创建`NSOpenPanelExtension.m`包含以下内容的文件：

```
#import "NSOpenPanelExtension.h"

@implementation NSOpenPanel (Extension)

- (void)setCancelButtonTitle:(NSString *)newTitle
{
NSRect oldFrame = [_cancelButton frame];

[_cancelButton setTitle:newTitle];
[_cancelButton sizeToFit];

NSRect newFrame = [_cancelButton frame];
float delta = oldFrame.size.width - newFrame.size.width;

[_cancelButton setFrameOrigin:NSMakePoint(oldFrame.origin.x + delta,
oldFrame.origin.y)];
}

@end 
```

3）在需要的地方使用它：

```
#import "NSOpenPanelExtension.h"
...
NSOpenPanel *panel = [NSOpenPanel openPanel];  
[panel setCancelButtonTitle:@"NO!"]; 
```

但是当`[panel setCancelButtonTitle:@"NO!"]`我`NSOpenPanel`崩溃并且这出现在我的控制台上时（以及通常的错误和代码）：

```
*** Assertion failure in -[NSRemoteOpenPanel forwardingTargetForSelector:], /SourceCache/RemoteViewServices/RemoteViewServices-80.5/NSRemoteSavePanel.m:1975
An uncaught exception was raised
sandboxed save/open panel presently acting unlike a panel 
```

怎么了？如何更改 a 的取消按钮标题`NSOpenPanel`？示例代码将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:48:36.720

此问题可能与[App Sandbox Design Guide 中提到的 NSOpenPanel 更改有关：](http://developer.apple.com/library/mac/#documentation/Security/Conceptual/AppSandboxDesignGuide/AppSandboxInDepth/AppSandboxInDepth.html)

> 为您的应用启用 App Sandbox 时，某些 NSOpenPanel 和 NSSavePanel 方法的行为会有所不同：
> 
> 您不能使用 ok: 方法调用 OK 按钮。
> 
> 您不能使用 NSOpenSavePanelDelegate 协议中的 panel:userEnteredFilename:confirmed: 方法重写用户的选择。
> 
> 此外，NSOpenPanel 和 NSSavePanel 类的有效**运行时继承路径与 App Sandbox****不同**...

# php - 在wordpress中样式化php生成的链接

> ID：12806108
> 
> 赞同：0
> 
> 时间：2012-10-09T18:25:11.930
> 
> 标签：php, css, wordpress

我的 wordpress 循环中有以下代码来显示粘性帖子：

```
<div class="blogpost">
<?php // div class for styling sticky posts on main page. ?>
<div id="post-<?php the_ID(); ?>" <?php post_class(); ?>

    <h2><a href="<?php the_permalink(); ?>" title="<?php the_title_attribute(); ?>"><?php the_title(); ?></a></h2>

    <?php the_excerpt(); // Show summary of posts only. ?>
</div> <!-- end class sticky -->
</div> <!-- end class blogpost --> 
```

我想用 CSS 为 h2 设置样式，但我无权访问它。当我查看 firebug 中的代码时，它看起来像这样：

```
<div class="blogpost">
<div id="post-324" class="post-324 post type-post status-publish format-standard sticky hentry category-uncategorized" <h2="">

    <a href="http://mydomain.com/wordpress/?p=324">Headline of post </a>
    ...
</div>
</div> 
```

有谁知道我必须改变什么才能让我的标题 h2 变成 a？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:32:03.147

第一个代码块缺少`>`after `<?php post_class(); ?>`。`h2`因此，一旦修复，您应该能够设置样式。

如果你想要`h2`里面`a`，你可以把它放在里面：

`<a href="<?php the_permalink(); ?>" title="<?php the_title_attribute(); ?>"><h2><?php the_title(); ?></h2></a>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:45:33.957

看看这部分代码

```
<div id="post-<?php the_ID(); ?>" <?php post_class(); ?> 
```

试试这个代码：

```
<div id="post-<?php the_ID(); ?>" <?php post_class(); ?>> 
```

所有代码：

```
<div class="blogpost">
<div id="post-<?php the_ID(); ?>" <?= post_class(); ?>>
    <h2><a href="<?php the_permalink(); ?>" title="<?php the_title_attribute(); ?>"><?= the_title(); ?></a></h2>
    <?php the_excerpt(); ?>
</div> 
</div> 
```

# nosql - 正在寻找一种支持流式计数、草图绘制和大型集合交叉点的架构

> ID：12806109
> 
> 赞同：1
> 
> 时间：2012-10-09T18:25:15.280
> 
> 标签：nosql, cassandra, hbase

我想知道 Stackoverflow 社区是否可以通过建议一种可以解决我的问题的技术（即 HBase、Raiku、Cassandra 等）来帮助我。我有一个大型数据集，我们想**实时更新和查询，**大约**10 兆兆字节**。我们的数据集是一个像素流，其中包含一个用户 ID 和一个或多个特征（通常大约 10 个）。可能的**特征总数以百万计**。

我们想象我们的数据模型看起来像：

**FEATUREID_TO_USER_TABLE** : 功能 id -> {UserID Hash, UserID Hash, ...}

**FEATUREID_TO_COUNTER_TABLE**：特征 id -> {自史诗以来的小时数 -> HyperLogLog 字节 blob }

我们希望保留一组按用户 ID 的哈希排序的排序用户 ID。如果新 ID 具有较低的哈希值，我们还希望为每个 FEATUREID_TO_USER_TABLE 条目保留最多约 200k 的旧 ID。

我们希望商店支持以下操作（不一定用 SQL 表示）：

```
select FeatureID, count(FeatureID) from FEATUREID_TO_USER_TABLE where UserID in 
(select UserID from FEATUREID_TO_USER_TABLE where FeatureID = 1234)
    group by FeatureID; 
```

和

```
update FEATUREID_TO_COUNTER_TABLE set HyperLogLog = NewBinaryValue where FEATUREID_TO_COUNTER_TABLE.id = 567 
```

我们相信跨机器分片这些数据的最简单方法是通过用户 ID。

感谢您的任何想法，马克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T14:09:14.697

Cassandra 是持久化数据的绝佳选择，但您需要其他东西来实时处理它。我建议您查看[Storm](https://github.com/nathanmarz/storm)，因为它可以相对轻松地为您提供实时流数据处理。它是一个为您处理并发和并行化的开源框架。它是在 JVM 上编写的，但也具有针对各种非 JVM 语言的语言绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T14:15:47.947

我不确定我是否理解你的全部描述，所以我在黑暗中拍摄了一些上下文。

有什么方法可以对您的数据进行分区，以便您可以查询到一个分区？这对扩展时的可扩展性和查询有很大帮助。您通常不想查询太大的表，而是查询分区。

IE。PlayOrm 在 cassandra 上具有分区功能，因此您可以查询一个分区。

虽然 PlayOrm 也有连接查询，但它此时不进行子选择，但通常客户端只是对 nosql 存储进行第一次调用，然后聚合结果并进行第二次查询，它仍然非常快（可能与你打了一个电话，因为即使是 cassandra 也必须在内部对其他服务器进行两次调用）。

嗯，我越读你的帖子，我不确定你应该在那里写 SQL，因为你可以通过主键做所有事情，但我不是 100% 确定。该 SQL 令人困惑，因为它抓取了行中的所有用户 ID，然后只计算它们？？？？因为它在选择和子选择中是同一个表？

就数据分片而言，您无需执行任何操作，因为 cassandra 会自动执行此操作。

# c++ - 如何在eclipse中启用qt4代码补全？

> ID：12806115
> 
> 赞同：1
> 
> 时间：2012-10-09T18:25:42.190
> 
> 标签：c++, eclipse, qt4

我用 Qt 的一些元素开发应用程序。我使用 cmake 作为构建系统，只使用 Eclipse 作为编辑器和调试器。一切都很好（感谢 CMake），但是我不能强制 IDE 完成我的 Qt 代码。

很多时候有人问过它，解决方案是添加包含路径。我当然做到了，但是

```
#include <QtSql> 
```

是不同的，因为包含目录中没有这样的文件。如果我手动包含所有必需的文件，它可能会起作用。有什么方法可以让 Eclipse 理解“QtSql”是指该模块中的所有类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:58:55.240

安装 qt4 eclipse 集成包。你可以在[这里找到说明](http://doc.qt.digia.com/qt-eclipse/eclipse-integration-installation.html)

正如网页所说，模块包应该在里面`eclipse/plugins`，解压包并从命令行启动一次eclipse：

```
eclipse -clean 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:36:34.360

根据您的问题，我假设您已经在 Eclipse 中设置了其他 Qt 模块，例如 QtCore 或 QtGui，如果没有，请参阅此帖子：[https ://stackoverflow.com/a/12670991/1611055](https://stackoverflow.com/a/12670991/1611055)

要同时使用 QSql 子模块（没有 eclipse Qt 插件，恕我直言，不再维护），您需要在“项目属性 => C/C++ 常规 => 路径和符号”中添加以下设置：

在“包含”选项卡上，对于 GNU C++ 语言，添加以下包含路径：

```
/usr/include/qt4/QtSql 
```

在“符号”选项卡上，对于 GNU C++ 语言，添加以下值为“1”的符号：

```
QT_SQL_LIB 
```

通过这些设置，Eclipse C++ 索引器也知道 QtSql 类。

# android - 在 Android 中使用限定符测试替代资源选择的工具

> ID：12806119
> 
> 赞同：2
> 
> 时间：2012-10-09T18:25:56.510
> 
> 标签：android, layout, qualifiers

我很难根据 Android 中的限定符测试不同的布局。我想知道是否有人知道一些工具来验证基于某些设备配置（例如，屏幕尺寸、android 版本..）获取哪些资源。理想情况下，我想在常见的预定义配置中进行选择，或者我想指定我的自定义设备配置，提供我的 apk（或项目）并输出一种解决方案，告诉我选择了什么以及为什么。你知道有没有类似的东西？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:33:58.510

我选择一个通用视图，然后将其复制到每个资源文件夹中。例如，在我当前的项目中，我在主页上有一个标题栏。我只是将文本硬编码到资源文件夹名称，例如 res-layout-large-land，或者可能是带有 RDLL（用于 res-drawable-large-land）的占位符图像。

# c# - 如何将数组值设置为构造函数c#

> ID：12806121
> 
> 赞同：1
> 
> 时间：2012-10-09T18:26:01.253
> 
> 标签：c#, arrays, constructor

我让程序运行了伙计们非常感谢我刚刚删除了所有内容并从头开始重新开始！现在我遇到了问题：

// 构造函数

```
public Grade ( string cname , int Studentident , int [] homework , int [] classwork ,      int [] midexam , int [] finalexam)
{
    coursename = cname ;
    Studentid = Studentident ;  
    hwgrade = homework ;
    cwgrade = classwork ;
    midegrade = midexam ;
    finalegrade = finalexam ;
} 
```

// 尝试设置值

```
Grade grade = new Grade('m',1,1,1,1,1); 
```

它给了我一个错误，无法从 int 转换为 int[]

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T18:27:57.613

您必须传入*数组*，而不是单个值：

```
Grade grade = new Grade('m',
                        new int[] {1}, 
                        new int[] {1}, 
                        new int[] {1}, 
                        new int[] {1}, 
                        new int[] {1}); 
```

`int``int[]`毕竟不一样。

以上假设您的字段（例如`hwgrade`）被声明为`int[]`而不是`int`。

如果不是这种情况，并且字段实际上是整数而不是整数数组，则需要更改方法签名以采用整数而不是数组：

```
public Grade(string cname, 
             int Studentident, 
             int homework, 
             int classwork,
             int midexam,
             int finalexam) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:28:05.337

您可以使用此代码替换 - 如果您希望使用 int 而不是 int 数组，请删除 []

```
Grade ( string cname , int Studentident , int homework , int classwork ,      int midexam , int  finalexam)
{
  ...
} 
```

或者创建数组`new int[] {1}`并传入参数

# python - 缺少 python bz2 模块

> ID：12806122
> 
> 赞同：81
> 
> 时间：2012-10-09T18:26:07.963
> 
> 标签：python, linux, bzip2

我已经安装在我的主目录中。

```
[spatel@~ dev1]$ /home/spatel/python-2.7.3/bin/python -V
Python 2.7.3 
```

我正在尝试运行一个需要 python 2.7.x 版本的脚本，但我缺少 bz2 错误

```
[spatel@~ dev1]$ ./import_logs.py
Traceback (most recent call last):
  File "./import_logs.py", line 13, in <module>
    import bz2
ImportError: No module named bz2 
```

我尝试安装 bz2 模块，但出现很多错误

```
 [spatel@dev1 python-bz2-1.1]$ /home/spatel/python-2.7.3/bin/python setup.py install
    ...
    ...
    ...
    bz2.c:1765: error: âBZ_FINISH_OKâ undeclared (first use in this function)
    bz2.c:1765: warning: comparison between pointer and integer
    bz2.c:1771: error: âPyMemberDefâ has no member named âavail_outâ
    bz2.c:1778: error: âPyMemberDefâ has no member named ânext_outâ
    bz2.c:1778: error: âPyMemberDefâ has no member named âtotal_out_hi32â
    bz2.c:1778: error: âPyMemberDefâ has no member named âtotal_out_lo32â
    bz2.c:1778: error: invalid operands to binary +
    bz2.c:1778: warning: statement with no effect
    bz2.c:1779: error: âPyMemberDefâ has no member named âavail_outâ
    bz2.c:1779: error: âPyMemberDefâ has no member named ânext_outâ
    bz2.c:1779: error: invalid operands to binary -
    bz2.c:1779: error: invalid operands to binary -
    bz2.c:1779: warning: statement with no effect
    bz2.c:1783: error: âPyMemberDefâ has no member named âavail_outâ
    bz2.c:1784: error: âPyMemberDefâ has no member named âtotal_out_hi32â
    bz2.c:1784: error: âPyMemberDefâ has no member named âtotal_out_lo32â
    bz2.c:1784: warning: passing argument 2 of â_PyString_Resizeâ makes integer from pointer without a cast
    error: command 'gcc' failed with exit status 1 
```

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2012-10-09T18:39:32.103

可能当您从源代码构建 python 时，您没有 bz2 标头。

在 Ubuntu/Debian 上安装它们：

```
sudo apt-get install libbz2-dev 
```

软呢帽：

```
sudo yum install bzip2-devel 
```

并再次构建python。您可能会注意到，python 在配置/构建时会检查很多库，如果您错过了其中的一些，您可能不会在您的案例中获得对 bz2 等库的支持。

您应该获得预构建二进制文件以避免这种情况。Ubuntu 12.04 打包[python 2.7.3](http://packages.ubuntu.com/precise/python/python)，你的脚本需要的版本。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2020-04-27T17:39:13.187

导入熊猫时，python 3.8.2 发生了这种情况：`import pandas as pd`

导致一条长错误消息结尾：“错误：ModuleNotFoundError：没有名为'_bz2'的模块”

通过执行以下 2 个 bash 命令解决了这个问题：

```
sudo apt-get install libbz2-dev
sudo cp /usr/lib/python3.8/lib-dynload/_bz2.cpython-38-x86_64-linux-gnu.so  /usr/local/lib/python3.8/ 
```

然后它工作得很好。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-04-05T07:36:45.987

在 CentOS 7 上，安装 bzip2-devel：

```
sudo yum install  bzip2-devel 
```

然后重新编译python。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-11-22T05:46:47.293

如果您将 python 安装在特定位置，则仅安装`libbz2-dev`将不起作用。

centos有一个解决方法：

*   Centos 6

    ```
    sudo cp /usr/lib64/python2.6/lib-dynload/bz2.so /python_install_path/lib/python2.7 
    ```

*   森托斯 7

    ```
    sudo cp /usr/lib64/python2.7/lib-dynload/bz2.so /python_install_path/lib/python2.7 
    ```

`python_install_path`通常是`/usr/local/lib/python2.7/`，如果您有自定义 python 路径，则需要替换它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-11-07T11:57:56.157

您必须`bzip2`通过源代码重新安装：

1.  `yum install bzip2-devel`

2.  `wget http://www.bzip.org/1.0.6/bzip2-1.0.6.tar.gz`

3.  `tar -zxvf bzip2-1.0.6.tar.gz`

4.  `cd bzip2-1.0.6`

5.  `make && make install`

6.  配置并重新编译python

这些步骤有时会起作用。

最后，我发现了问题所在，它需要 /usr/local/Python-3.5.2/lib/python3.5/lib-dynload/_bz2.cpython-35m-x86_64-linux-gnu.so **，**它必须有当我通过源代码编译 bzip2 时出现问题。我从另一个 VM 复制此文件以解决问题。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-10-09T18:39:42.983

您需要安装 bz2 c 库的开发版本。您可能没有，这就是为什么在您构建 python 的用户副本时没有安装它的原因。在 Ubuntu 上，它是 libbz2-dev 软件包。它在 Fedora 上的名称可能相同或相似。或者您可以从 www.bzip.org 下载它。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-12-18T11:32:25.343

上面的解决方案可以解决python2.7的bz2问题。但不是 python 3.x 是的，你需要 _bz2.cpython-3xm-x86_64-linux-gnu.so，但是你应该在你自己的环境中构建它。

这是我的解决方案：

1.  百胜安装 bzip2-devel。（或 apt-get）
2.  下载 bzip2-1.0.6。制作 && 制作安装 ()
3.  像这样构建 Python3 的 _bz2.cpython：

python3的源码文件夹下vim run.sh：Python-3.xx

```
export CFLAGS="-I/usr/include"
export LDFLAGS="-L/usr/lib64"
export LD_LIBRARY_PATH=/usr/lib64
make distclean
./configure --prefix=/home/xxx/Python3 && make && make install 
```

您可以设置与您的预版本相同的前缀，这不会卸载您安装的任何软件包。在此之前，制作一个备份文件夹。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-09-06T18:59:42.630

这是因为`.so`缺少文件而发生的。

说`python3.7`从以下位置下载文件： [_bz2.cpython-37m-x86_64-linux-gnu.so](https://github.com/azwyane/simple_text_editor/blob/master/edi/_bz2.cpython-37m-x86_64-linux-gnu.so)

对于不同版本的`python`尝试为您的版本查找此文件。说`python3.8`更改`37`为`38`等并找到并下载文件。

现在：使用权限`Ubuntu`复制文件夹内的文件。`/usr/local/lib/python3.7``sudo`

为此，请转到下载文件的文件夹并执行命令（根据您的`python`版本相应地更改文件名和目标文件夹）：

```
sudo cp _bz2.cpython-37m-x86_64-linux-gnu.so /usr/local/lib/python3.7 
```

最后下载`python`，解压zip文件，解压后配置编译：

```
./configure --enable-optimizations
sudo make altinstall 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2021-07-05T22:05:07.533

就我而言，我在导入 pandas 时遇到了这个错误`import pandas`。安装 python 3.9.1 解决了这个问题。

我的 python 版本是 3.8.6，我正在使用 Pyenv 并运行 MacOS Big Sur。

错误

```
$ python
Python 3.8.6 (default, Nov 21 2020, 02:39:42)
[Clang 12.0.0 (clang-1200.0.32.27)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import pandas as pd
Traceback (most recent call last):
...
    from _bz2 import BZ2Compressor, BZ2Decompressor
ModuleNotFoundError: No module named '_bz2' 
```

安装 3.9.1

```
$ pyenv install --list
$ pyenv install 3.9.1
$ pyenv local 3.9.1
$ pyenv global 3.9.1
$ pip install pandas 
```

再次

```
$  python
Python 3.9.1 (default, Jul  5 2021, 22:26:09)
[Clang 12.0.5 (clang-1205.0.22.11)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import pandas as pd
>>> 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-10-25T23:35:38.740

我还应该在 CentOS 6 上添加它，确保你有`bzip2-devel`，未`bzip2-libs`安装。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-04-25T16:19:53.400

`Python`从其他位置安装时（我使用`Python 3.7.5`on `Centos 7`） ，我也遇到了这个问题。

以下是我使它能够工作的步骤：

1.  导出环境变量

```
export PATH=<YOUR_PYTHON_PATH>/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin
export PYTHONPATH=<YOUR_PYTHON_PATH>/lib/python3.7/site-packages
export LD_RUN_PATH=/usr/local/lib:/usr/lib64
export LD_LIBRARY_PATH=/usr/local/lib:/usr/lib64
export CFLAGS="-I/usr/include"
export LDFLAGS="-L/usr/lib64" 
```

2.  安装 bzip2-devel

```
yum install -y bzip2-devel 
```

3.  下载并编译bzip2

```
wget/curl <bzip2_url>
make
make install 
```

通过这样做，您无需下载`_bz2.cpython-35m-x86_64-linux-gnu.so`文件。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-09-16T09:56:01.310

只有在为我导入熊猫时，它才会在 Jupyter 中发生。

我的解决方法是将`/usr/lib/python3.8/lib-dynload`（包括`_bz2.cpython-38-x86_64-linux-gnu.so`）的内容复制到`~/.local/lib/python3.8/site-packages/`.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2022-01-21T12:58:28.927

我将其固定如下

1.  `# sudo find / -name '*_bz2*'`

搜索结果示例：</p>

> /usr/lib64/python3.6/lib-dynload/_bz2.cpython-36m-x86_64-linux-gnu.so

2.  `# sudo cp /usr/lib64/python3.6/lib-dynload/_bz2.cpython-36m-x86_64-linux-gnu.so /usr/local/python3.8.5/lib/python3.8/lib-dynload`
3.  `sudo mv _bz2.cpython-36m-x86_64-linux-gnu.so _bz2.cpython-38-x86_64-linux-gnu.so`

如果您的 python 是**3.7**，您应该将文件名从 更改`36m`为`37m`。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-07-03T09:21:57.730

这是我在 CentOS 上的解决方案：（步骤 2-6 可能会跳过）

1.  `sudo yum install bzip2-devel`

2.  `bzip2-1.0.6.tar.gz`从[https://github.com/nemequ/bzip2/releases](https://github.com/nemequ/bzip2/releases)下载

3.  `tar -zxvf bzip2-1.0.6.tar.gz`
4.  `cd bzip2-1.0.6`
5.  `make && make install`
6.  [从https://github.com/Imaginashion/ccdev-vision/blob/master/.fr-d0BNfn/django-jquery-file-upload/venv/lib/python3.5/lib-dynload/_bz2.cpython-](https://github.com/Imaginashion/ccdev-vision/blob/master/.fr-d0BNfn/django-jquery-file-upload/venv/lib/python3.5/lib-dynload/_bz2.cpython-35m-x86_64-linux-gnu.so)下载文件[35m-x86_64-linux-gnu.so](https://github.com/Imaginashion/ccdev-vision/blob/master/.fr-d0BNfn/django-jquery-file-upload/venv/lib/python3.5/lib-dynload/_bz2.cpython-35m-x86_64-linux-gnu.so)并将其移动到 `/[your python path]/lib-dynload/_bz2.cpython-35m-x86_64-linux-gnu.so`
7.  `sudo ln -s `find /usr/lib64/ -type f -name "libbz2.so.1*"` /usr/lib64/libbz2.so.1.0` 归功于[https://michaelheap.com/error-while-loading-shared-libraries-libbz2-so-1-0-cannot-open-shared-object-file-on-centos-7](https://michaelheap.com/error-while-loading-shared-libraries-libbz2-so-1-0-cannot-open-shared-object-file-on-centos-7)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-12-08T06:16:27.493

我在使用本地编译的 python 3.6.9 进行 debian 拉伸时遇到了同样的问题在 /usr/local/lib/python3.6/lib-dynload/ 中，有一个 _bz2.cpython-365m-x86_64-linux-gnu.so 文件（注意' **365m** '部分......）我创建了这个库的符号链接，它解决了这个问题：

```
sudo ln -s _bz2.cpython-365m-x86_64-linux-gnu.so _bz2.cpython-369m-x86_64-linux-gnu.so
sudo ln -s _bz2.cpython-365m-x86_64-linux-gnu.so _bz2.cpython-36m-x86_64-linux-gnu.so 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-03-01T17:59:54.473

我也得到了这个烦人的输出并修复了这个错误。我实际上在`Python 3.7`and中得到了那个错误`3.8`。我什至在远程服务器中都没有 sudo 权限，但我设法通过降级 Python 来修复该错误。安装`Python 3.6`而不是 3.7 或 3.8 可以解决问题。

# c# - 具有中断的持续运行作业，最佳方法

> ID：12806124
> 
> 赞同：0
> 
> 时间：2012-10-09T18:26:13.267
> 
> 标签：c#, .net, batch-processing

问题：在长时间运行过程中跟踪三个状态。1) 是 EOD（一天结束）信号，用于发送给定日期收到的电子邮件报告 2) 在同一天收到的新信号，用于发送修订报告（增加修订号 3）是在发送时收到的信号发生，如果是这样，只需警告用户正在处理 EOD 信号。

收到一天结束信号后，在实际一天结束时……午夜，所有变量都被重置

目前正在使用三个单独的布尔值处理。问题是，是否有一种更有效的方法可以在不使用这么多布尔变量的情况下在这个无限循环中跟踪这三个条件。

一些代码因为发布它太多了，但这里是 jist：

```
public class job
{
    private bool receivedEndOfDaySignal = false;
    private bool receivedEodOfDaySignalSend = false;
    private bool receivedEodOfDaySignalDuringSend = false;

    public void RunThisJob(IJobData JobData, IJobStatus Status)
    {
         // job setup code.
         // listener for incoming signals
         Helper.OnSignalReceived += Helper_OnSignalReceived;

         // loop for constant run
           for (; ; )
            {
                //We're still cooking
                Helper.StillGoing();

                //wait till the email send is supposed to execute
                Helper.WaitUntilTime(RunTime);

                //Send the mail
                SendMail();

                // reset signal booleans
                receivedEodOfDaySignalSend = receivedEodOfDaySignalDuringSend = false;

    }

    bool Helper_OnSignalReceived(IJobSignal signal, BatchWaitType waitType)
    {
        //Which?
        switch (signal.Code.ToUpper())
        {
            case "ENDOFDAY":
                // Acknowledge the end of day signal 
                // if end of day received more than once before being reset.
                if (receivedEodOfDaySignalDuringSend)
                {
                    Helper.Logger.Log(LogStatus.Info, "Batch", "An END OF DAY signal was already received. ");
                    Helper.Status.AcknowledgeSignal(signal);
                    return true;
                }
                // when an eod signal is received and revision count has been initialized increase the count.
                // only initialized after first eod signal received and not when another receiving during a send
                if (revisionCount != null) revisionCount++;
                // set all the flags when EOD comes through even though some will still be set
                receivedEndOfDaySignal = receivedEodOfDaySignalSend = receivedEodOfDaySignalDuringSend = true;
                Helper.Status.AcknowledgeSignal(signal);
                return true;
        }

        //Still here?
        return false;
    }

} 
```

侦听器为正在运行的进程设置适当的变量......我所拥有的实际上是有效的。只是想知道是否有更好的方法来做到这一点。

# ruby-on-rails - 时间到期时如何自动调用动作？

> ID：12806125
> 
> 赞同：0
> 
> 时间：2012-10-09T18:26:18.273
> 
> 标签：ruby-on-rails

**我是一名 Rails 新手程序员。**

我正在开发一个社交网络。如果帖子一个小时没有被阅读，系统会向用户发送一条消息。

我读过 Resque 和 Rake，但我不知道哪种方式适合我的情况。

我发现delayed_job 可以做一个异步方法。5.minutes.from_now 将在调用 in_the_future 时进行评估

```
handle_asynchronously :in_the_future, :run_at => Proc.new { 5.minutes.from_now } 
```

[https://github.com/collectiveidea/delayed_job](https://github.com/collectiveidea/delayed_job)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:30:42.087

好吧，您可以让一个 cron 作业在满足给定条件的记录上每小时运行一个 rake 任务，或者您可以让每个作业创建一个专门为该用户在现在 + 1 小时运行的后台作业条目（如延迟作业）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:31:40.457

您可以使用 cron 和一些 rake 任务来发送消息。或类似[delayed_job](https://github.com/collectiveidea/delayed_job)

# r - 如何按字典顺序订购我的数据框

> ID：12806128
> 
> 赞同：9
> 
> 时间：2012-10-09T18:26:24.487
> 
> 标签：r, sorting, r-faq

我有以下数据框

```
a = data.frame(a=c(1,2,3,4,5,6,7),b=c(1,2,3,10,12,21,4),c=c(1,2,10,11,"X","Y",3))
> a
  a  b  c
1 1  1  1
2 2  2  2
3 3  3 10
4 4 10 11
5 5 12  X
6 6 21  Y
7 7  4  3 
```

我想按字典顺序对整个数据框进行排序，以便输出（例如，列“c”）应该像

```
> a[,"c"]
[1] 1  2  3 10 11  X  Y 
```

我试过了，我得到了不同的答案

```
indata <- a[do.call(order,a[,c("c","a","b")]),]
> indata[,"c"]
[1] 1  10 11 2  3  X  Y
Levels: 1 10 11 2 3 X Y 
```

我尝试了 gtools、mixedorder 包并在一列上运行良好：

```
> a[mixedorder(a$c),]
  a  b  c
1 1  1  1
2 2  2  2
3 3  3 10
4 4 10 11
5 5 12  X
6 6 21  Y
7 7  4  3 
```

但如果我包含多个列，它就不起作用：

```
> a[with(a,order(mixedorder(c),mixedorder(b),mixedorder(a))),]
  a  b  c
1 1  1  1
2 2  2  2
4 4 10 11
5 5 12  X
6 6 21  Y
7 7  4  3
3 3  3 10 
```

虽然我期待：

```
 a  b  c
1 1  1  1
2 2  2  2
4 7  4  3
5 3  3 10
6 4 10 11
7 5 12  X
3 6 21  Y 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-09T18:33:36.523

一种选择是`mixedorder()`从**gtools**包中使用。

```
library(gtools)
a[mixedorder(a$c),]
#   a  b  c
# 1 1  1  1
# 2 2  2  2
# 7 7  4  3
# 3 3  3 10
# 4 4 10 11
# 5 5 12  X
# 6 6 21  Y 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-09T18:48:05.887

坚持基础，您可以自己制作一个功能：

```
a = data.frame(a=c(1,2,3,4,5,6,7),b=c(1,2,3,10,12,21,4),c=c(1,2,10,11,"X","Y",3))

SORTER_DEVICE <- function(x) {
    c(sort(as.numeric(na.omit(gsub("[a-zA-Z]", NA, x)))),
        sort(na.omit(gsub("[0-9]", NA, x))))
}
data.frame(apply(a, 2, SORTER_DEVICE)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-14T14:15:31.370

不幸的是，混合排序（还）不支持多列排序。因此，您需要自己实现它，例如：

```
a[order(sub("[0-9]+", "", a$c),
        as.numeric(sub("[[:alpha:]]*([[:digit:]]*)", '\\1', a$c)),
        as.numeric(a$b),
        as.numeric(a$a)), ] 
```

首先，使用 a$c 对 data.frame 进行字母数字排序，对于平局情况（实际上在您的 data.frame 'a' 中不存在），它使用 a$b 和 a$a。

输出是：

```
 a  b  c
1 1  1  1
2 2  2  2
7 7  4  3
3 3  3 10
4 4 10 11
5 5 12  X
6 6 21  Y 
```

PS：这是 David Winsemius 在[这篇文章](http://r.789695.n4.nabble.com/choosing-multiple-columns-tp4640025p4640104.html%20here)中写的，作为对类似问题的回复。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-08-01T09:30:11.480

假设这些是人类染色体名称，*chr1...chr22, chrX, chrY*。我们可以将它们转换为数字，然后使用 order：

```
# convert to numeric
a$chromN <- as.integer(ifelse(a$c == "X", "23", ifelse(a$c == "Y", "24", a$c)))

# now sort as usual:
a[ order(a$chromN), ]

#   a  b  c chromN
# 1 1  1  1      1
# 3 3  3 10      2
# 4 4 10 11      3
# 2 2  2  2      4
# 7 7  4  3      5
# 5 5 12  X     23
# 6 6 21  Y     24 
```

# azure - 如何将 Cassette 或 Combres 与 Azure webrole 集成？

> ID：12806131
> 
> 赞同：1
> 
> 时间：2012-10-09T18:26:48.913
> 
> 标签：azure, cassette, combres

我刚刚建立了一个新的解决方案/项目来测试它（使用截至 2012 年 10 月 9 日的最新 azure sdk）。我从 Cassette 开始尝试缩小、压缩和组合我的 css 和脚本文件。在本地运行时，尝试访问我的页面时出现 500 错误。奇怪的是，即使关闭自定义错误、打开调试等，我也无法获得更多信息。然后我卸载了 Cassette 并尝试了 Combres（有人说他们已经让它与 Azure 一起工作）。同样的错误。只是为了好玩，我将我的启动项目更改为仅网络角色，并且页面加载得很好。

为了使这个工作网站在 Azure 下工作，我缺少什么设置？

编辑：当我删除任何将提供 minfying/combining 功能的包时，页面正确加载（在 Azure 模拟器上本地运行）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T11:21:17.117

我在部署到 Azure 时遇到了类似的错误。我的问题是我使用的 .less 文件未包含在 .cspkg 中。您可以调查要部署到 Azure 的包，以确保它们包含所有相关文件。

在我的情况下，将 .less 文件的“*构建操作”更改为“**内容*”使一切正常。

如果您启用远程错误以调试部署以暂存错误应该变得明显`<customErrors mode="Off" />`

# c# - StructureMapController 的问题

> ID：12806132
> 
> 赞同：0
> 
> 时间：2012-10-09T18:26:52.627
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-2, mvccontrib

当我的项目在本地机器上以调试模式运行时，我收到以下错误`Value cannot be null. Parameter name: key`。我试图调试它以查看导致问题的原因，但我运气不佳。当请求视图时，会抛出此错误但页面加载，我不知道是什么导致了这个问题。

我在下面包含了错误消息和堆栈跟踪：

```
System.ArgumentNullException was unhandled by user code
  Message=Value cannot be null.
Parameter name: key
  Source=mscorlib
  ParamName=key
  StackTrace:
       at System.Collections.Generic.Dictionary`2.FindEntry(TKey key)
       at System.Collections.Generic.Dictionary`2.ContainsKey(TKey key)
       at StructureMap.Util.Cache`2.get_Item(KEY key)
       at StructureMap.BuildSession.CreateInstance(Type pluginType)
       at StructureMap.Container.GetInstance(Type pluginType)
       at StructureMap.ObjectFactory.GetInstance(Type pluginType)
       at MvcContrib.StructureMap.StructureMapControllerFactory.CreateController(RequestContext context, String controllerName) in c:\builds\mvccontrib\src\MvcContrib.StructureMap\StructureMapControllerFactory.cs:line 13
       at System.Web.Mvc.MvcHandler.ProcessRequestInit(HttpContextBase httpContext, IController& controller, IControllerFactory& factory)
       at System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContextBase httpContext, AsyncCallback callback, Object state)
       at System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContext httpContext, AsyncCallback callback, Object state)
       at System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest(HttpContext context, AsyncCallback cb, Object extraData)
       at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
       at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)
  InnerException: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:03:14.727

确保页面上引用的任何 CSS 或 JavaScript 资源确实存在于指定的位置。如果找不到资源，您`StructureMapControllerFactory`可能会尝试获取与路由匹配的控制器实例。

如果你`StructureMapControllerFactory`看起来像这样：

```
public class StructureMapControllerFactory : DefaultControllerFactory
{
    protected override IController GetControllerInstance(
        RequestContext requestContext, 
        Type controllerType)
    {
        return ObjectFactory.GetInstance(controllerType) as Controller;
    }
} 
```

然后您可以检查`requestContext.RouteData.Values`以帮助确定导致问题的资源。

# java - 给定代码的复杂性？

> ID：12806133
> 
> 赞同：1
> 
> 时间：2012-10-09T18:26:52.973
> 
> 标签：java, data-structures, time-complexity

我试图找出下面给定代码的复杂性作为问题大小 n 的函数。

```
sum = 0;

if (EVEN(n))
    for (i = 0; i < n; i++)
      if (i%2 == 0)
        O(logn)
      else
        sum ++;
else
    sum = sum + n; 
```

这是我的答案，但我不确定我是否正确。

`sum=0; is equal to O(1)`.

第一个 if else 循环由一个嵌套的 for 循环和一个嵌套的 if 语句组成。所以它将是 for 循环内代码的 n 倍。因为它的 if 语句将是块 1 或块 2。因为`O(logn)`它比 sum ++ 慢，所以`O(1)`它是`O(logn)`。所以它是`O(n)*O(logn)`。

因此，最终答案将是`O(1) + n*O(logn)`。这个对吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:31:04.263

如果您谈论最差的运行时间，Yeap 似乎是正确的。你可以重写`O(n)*O(logn)`为`O(n*log(n))`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:38:05.793

是的，O(nlog(n)) 将是复杂性。

# oracle - Oracle 开发人员套件 10g 多语言支持

> ID：12806136
> 
> 赞同：0
> 
> 时间：2012-10-09T18:27:05.170
> 
> 标签：oracle, oracleforms

我正在开发 Oracle Forms 10g 应用程序。该应用程序是在 Oracle Forms 6i 和 Oracle 10g 中开发的，因此我使用 Oracle Express 10g 将该应用程序升级到 Oracle Forms 10g 和 Report 10g。

问题是应用程序是在沙特阿拉伯设计的，NLS_LANG = "ARABIC_SAUDI_ARABIA.AR8MSWIN1256"，因此表单开发人员和运行时会在阿拉伯文中提供所有错误消息，而我现在没有阿拉伯文。有没有办法解决这个问题？我想在表单开发人员中阅读英文错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:33:26.027

您应该能够使用 Oracle [TranslationHub 11g](http://www.oracle.com/ocom/groups/public/@otn/documents/webcontent/198892_en-gb.pdf)或[TranslationHub 9i](http://www.oracle.com/technetwork/developer-tools/forms/documentation/translationhuboverview-129288.pdf)做到这一点。

如果您安装了 Oracle Developer Suite，则默认情况下应安装 TranslationHub，有关详细手册以及如何使用，请访问

> 开始菜单 > 所有程序 > Oracle- Developer Suite > Forms Developer > TranslationHub 帮助

![在此处输入图像描述](../Images/12424f27a36747e3382b5152b35899b4.png)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-10T11:06:26.450

显示的 oracle 错误消息的语言由 oracle home 的 NLS_LANGUAGE 定义。NLS_LANG 设置的第一部分指定语言，第二部分指定本地设置，第三部分指定字符集。我没有亲自使用过阿拉伯语 NLS 设置，但我在使用斯堪的纳维亚 NLS 设置时遇到了类似的问题。我通过将 NLS_LANG 设置的第一部分更改为 AMERICAN 来修复它。你可以试试“AMERICAN_SAUDI_ARABIA.AR8MSWIN1256”

在 Windows 中，可以通过打开 regedit 并在 HKEY_LOCAL_MACHINE\SOFTWARE\ORACLE 下的某处找到您的 oracle 主目录来轻松更改 NLS_LANG 设置。

# java - 在android数据库中插入异常

> ID：12806142
> 
> 赞同：1
> 
> 时间：2012-10-09T18:27:18.660
> 
> 标签：java, android, sqlite

在 for 循环和打印日志之后调用插入函数时抛出 UnknownFormatConversionException，我捕获了该异常但如何删除它？不知道是什么原因发生的

```
try {
        List<Status> timeline = 
            ((YambaApp) getApplication()).getTwitter().getPublicTimeline();
        for (Status status : timeline) {
            Log.d(TAG, String.format("%s: %s", status.user.name,
                    status.text));
            statusData.insert(status);

            }
    } catch (TwitterException e) {
        Log.d(TAG,"Failed to access twitter service  ",e);
    } catch(NullPointerException a){
        Log.d(TAG,"Pref had been changed and twitter object is null",a);
    } catch (UnknownFormatConversionException u){
        Log.d(TAG,"exception "+ u);
    } 
```

下面是插入函数的代码：

```
public void insert(Status status){
    db=dbHelper.getWritableDatabase();

    ContentValues value= new ContentValues();
    //converting BigInteger to String
    BigInteger bi=status.id;
    String status_id= new String(bi.toByteArray());

    value.put(C_ID, status_id);
    value.put(C_CREATED_AT, status.createdAt.getTime());
    value.put(C_TEXT, status.user.name);
    value.put(C_TEXT, status.text);

    db.insert(TABLE, null, value);
} 
```

这是抛出异常的完整堆栈跟踪

```
10-10 06:05:22.648: E/AndroidRuntime(627): FATAL EXCEPTION: IntentService[RefreshService]
10-10 06:05:22.648: E/AndroidRuntime(627): java.util.UnknownFormatConversionException: Conversion: i
10-10 06:05:22.648: E/AndroidRuntime(627):  at java.util.Formatter$FormatToken.unknownFormatConversionException(Formatter.java:1397)
10-10 06:05:22.648: E/AndroidRuntime(627):  at     java.util.Formatter$FormatToken.checkFlags(Formatter.java:1334)
10-10 06:05:22.648: E/AndroidRuntime(627):  at java.util.Formatter.transform(Formatter.java:1440)
10-10 06:05:22.648: E/AndroidRuntime(627):  at java.util.Formatter.doFormat(Formatter.java:1079)
10-10 06:05:22.648: E/AndroidRuntime(627):  at java.util.Formatter.format(Formatter.java:1040)
10-10 06:05:22.648: E/AndroidRuntime(627):  at java.util.Formatter.format(Formatter.java:1009)
10-10 06:05:22.648: E/AndroidRuntime(627):  at java.lang.String.format(String.java:1998)
10-10 06:05:22.648: E/AndroidRuntime(627):  at java.lang.String.format(String.java:1972)
10-10 06:05:22.648: E/AndroidRuntime(627):  at com.example.yamba.StatusData$DbHelper.onCreate(StatusData.java:59)
10-10 06:05:22.648: E/AndroidRuntime(627):  at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:165)
10-10 06:05:22.648: E/AndroidRuntime(627):  at com.example.yamba.StatusData.insert(StatusData.java:32)
10-10 06:05:22.648: E/AndroidRuntime(627):  at com.example.yamba.RefreshService.onHandleIntent(RefreshService.java:32)
10-10 06:05:22.648: E/AndroidRuntime(627):  at android.app.IntentService$ServiceHandler.handleMessage(IntentService.java:65)
10-10 06:05:22.648: E/AndroidRuntime(627):  at android.os.Handler.dispatchMessage(Handler.java:99)
10-10 06:05:22.648: E/AndroidRuntime(627):  at android.os.Looper.loop(Looper.java:137)
10-10 06:05:22.648: E/AndroidRuntime(627):  at android.os.HandlerThread.run(HandlerThread.java:60)
10-10 06:05:22.968: W/IInputConnectionWrapper(627): showStatusIcon on inactive InputConnection 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:27:30.790

在你的`insert()`方法改变

```
String status_id= new String(bi.toByteArray()); 
```

至

```
String status_id = bi.toString(); 
```

调用`bi.toByteArray()`将返回一个字节数组，其中包含`BigInteger`. 您无法`String`按照您的操作方式将其正确转换。只需使用提供的`toString()`方法`BigInteger`。

# sitecore - 在模板上的 Sitecore 中将 Treelist 和 Multilist 更改为 TreelistEx

> ID：12806148
> 
> 赞同：4
> 
> 时间：2012-10-09T18:27:51.987
> 
> 标签：sitecore, treelist

我在我的 Sitecore 安装中使用了多列表或树列表字段。我最近了解了 treelist 和 treelistex 之间的区别，并想在项目上使用 treelistex 字段来加速项目的加载。我想用 treelistex 字段替换所有多列表和树列表字段。

我可以在模板级别更改此字段而不影响当前数据吗？还是现有数据会丢失？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-09T21:16:30.597

我相信这两种字段类型都将它们的值存储为以竖线分隔的 ID 列表，因此如果您进行更改，您预先存在的数据不应该受到影响。您始终可以通过添加一个新字段、选择一些数据然后对其进行更改以确保数据仍然存在来测试这一点。

# java - 两个 ArrayList 具有相同的引用

> ID：12806149
> 
> 赞同：0
> 
> 时间：2012-10-09T18:27:54.703
> 
> 标签：java, collections, arraylist

```
import java.util.*;

class Test {
    public static void main(String[] args) {
        ArrayList<Integer> a = new ArrayList<Integer>();
        ArrayList<Integer> b = new ArrayList<Integer>();
        //added 0-9 to ArrayList
        for(int i=0;i<9;i++)
        a.add(new Integer(i));

        //initialize the Iterator
        ListIterator<Integer> i = a.listIterator();
        while(i.hasNext())
        System.out.print(i.next());

        System.out.print(" ");

        b = a;
        Collections.shuffle(a);
        //initialized the iterator again and print all the elements
        i = b.listIterator();
        while(i.hasNext())
        System.out.print(i.next());
    }
}

//Output : 012345678 528430617 
```

根据上面的代码，如果我正在改组 ArrayList a 那么 ArrayList b 也会更新所以即使在更新之后我怎么能看到它不应该更新 b

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:29:38.840

这段代码没有做你认为它做的事情：

```
b = a; 
```

`b`和的值`a`都是*引用*，而不是*对象*。上面的语句简单地复制了`a`to的值`b`，所以现在两个变量具有相同的值，指的是同一个对象。

同一点的另一个演示：

```
StringBuilder x = new StringBuilder();
StringBuilder y = x;
x.append("foo");
System.out.println(y); // Will print foo 
```

*Java 中的*所有对象都是这样工作的。*表达式的值*始终*是原始值或引用，而*不是*对象。*

 *如果要创建第二个对象，则需要明确地执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T18:29:42.610

您需要创建以下副本`a`：

```
b = new ArrayList<Integer>(a); 
```

这将创建一个新的`ArrayList`并将所有`a`'s 元素添加到其中。*

# r - R中的maM（marrayNorm）中的列总和

> ID：12806157
> 
> 赞同：4
> 
> 时间：2012-10-09T18:28:17.070
> 
> 标签：r

我不得不承认我是 R 的*新手*，所以我真的需要一些帮助！

我有一个`marrayNorm`来自图书馆的对象`marray`（在生物导体上），在将 12 个阵列标准化后，每个阵列有 13640 个点。现在我需要将我的 12 列转换为 6 列，方法是将每 2 个数组归一化数据列相加。

开始`maM(marrayNorm)`：

```
 **a   b   c   d** ... (up to 12 columns)  
 1    2    3   4  
 5   6   7   8   
9   10  11  12 
```

...13640 行

以：

```
**ab  cd**  
3   7  
11  15  
19  23 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:42:13.167

```
result <- cbind(maM(marrayNorm)[, 1] + maM(marrayNorm)[, 2],  
                maM(marrayNorm)[, 3] + maM(marrayNorm)[, 4], 
                maM(marrayNorm)[, 5] + maM(marrayNorm)[, 6],
                maM(marrayNorm)[, 7] + maM(marrayNorm)[, 8], 
                maM(marrayNorm)[, 9] + maM(marrayNorm)[, 10],
                maM(marrayNorm)[, 11] + maM(marrayNorm)[, 12]) 
```

# c# - 在强类型视图中显示强类型部分

> ID：12806159
> 
> 赞同：0
> 
> 时间：2012-10-09T18:28:24.283
> 
> 标签：c#, asp.net-mvc, partial-views

我不能在强类型视图中呈现强类型部分吗？

我在尝试时收到以下错误：

> 传入字典的模型项的类型为“System.Data.Linq.Table `1[UI.Models.vwProject]', but this dictionary requires a model item of type 'System.Collections.Generic.IEnumerable`1[UI.Models.ProjectStatus]”。

我使用 ViewData.Model 填充两个视图

```
public ActionResult Index()
{
    ViewData.Model = project.vw_Projects;
    return View();
}

public ActionResult ProjectStatus()
{
    ViewData.Model = project.ProjectStatus;
    return View();
} 
```

这是我的观点：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<IEnumerable<UI.Models.vwProject>>" %>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

    <div>
    <table>
    <tr>
        <th>
            Project
        </th>
        <th>
            Hours
        </th>
    </tr>
    <tr>
        <td>
            <%= Html.Encode(item.ProjectCode) %>
        </td>
        <td>
            <%= Html.Encode(item.ProjectHours) %>
        </td>
    </tr>

<div>
 <%  Html.RenderPartial("ProjectStatus"); %>
</div>

</asp:Content> 
```

这是我的部分：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<IEnumerable<UI.Models.ProjectStatus>>" %>

    <table>
        <tr>
            <th>
                Code
            </th>
            <th>
                Status
            </th>
        </tr>

    <% foreach (var item in Model) { %>

        <tr>
            <td>
                <%= Html.Encode(item.ProjectCode) %>
            </td>
            <td>
                <%= Html.Encode(item.ProjectStatus) %>
            </td>
        </tr>

    <% } %>

    </table> 
```

我对如何在强类型或动态视图中显示强类型/动态部分感到有些困惑。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:34:11.677

是的你可以。但是，如果您不将模型传递给 RenderPartial，它将使用视图中的模型。所以，你需要做这样的事情：

```
Html.RenderPartial("ProjectStatus", new List<ProjectStatus>()); %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:34:00.080

如果你渲染一个部分，它不会影响你的控制器动作，默认情况下使用partent的视图模型渲染视图。

如果你想调用你的控制器动作`ProjectStatus`，那么你需要的是[RenderAction](http://msdn.microsoft.com/en-us/library/ee728607%28v=vs.108%29.aspx)方法：

```
<%  Html.RenderAction("ProjectStatus"); %> 
```

一篇关于[何时将 RenderAction 与 RenderPartial 与 ASP.NET MVC 一起使用的好文章](http://captaincodeman.com/2009/02/21/when-to-use-renderaction-vs-renderpartial-with-asp-net-mvc/)

# c++ - 如何连接/合并向量

> ID：12806160
> 
> 赞同：4
> 
> 时间：2012-10-09T18:28:33.033
> 
> 标签：c++, vector

我试图找出一种将 2 个向量和一个整数合并为一个向量的方法。IE

```
return data.push_back(fn(data1), mid, fn(data2)); 
```

注意这是一个递归函数。矢量数据在到达返回语句之前已存储在其中的值。我需要使用 return 语句中的值更新 data 中的值。

我完全不知道该怎么做。我一直在寻找几个小时，但似乎没有任何工作！

非常感谢任何指导。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-09T18:32:19.140

[`std::vector::insert()`](http://www.cplusplus.com/reference/stl/vector/insert/)接受一个迭代器范围：

```
std::vector<int> left(fn(data1));
std::vector<int> right(fn(data2));
data.insert(data.end(), left.begin(), left.end());
data.push_back(mid);
data.insert(data.end(), right.begin(), right.end());
return data; 
```

您还可以使用[`std::copy()`](http://www.cplusplus.com/reference/algorithm/copy/)from`<algorithm>`和[`std::back_inserter()`](http://www.cplusplus.com/reference/std/iterator/back_inserter/)from `<iterator>`：

```
std::copy(left.begin(), left.end(), std::back_inserter(data));
data.push_back(mid);
std::copy(right.begin(), right.end(), std::back_inserter(data)); 
```

但是，`insert()`可以预先知道它的输入范围的大小和`reserve()`合适的内存量，同时`back_insert_iterator`是不透明的——它只是重复调用`push_back()`. 它们都以线性时间运行，但`insert()`可能会进行更少的分配。

如果向量的元素移动比复制更有效，则可以使用 C++11 [`std::make_move_iterator()`](http://en.cppreference.com/w/cpp/iterator/make_move_iterator)from`<iterator>`来调整输入范围：

```
data.insert(data.end(),
    std::make_move_iterator(left.begin()),
    std::make_move_iterator(left.end()));
data.push_back(mid);
data.insert(data.end(),
    std::make_move_iterator(right.begin()),
    std::make_move_iterator(right.end())); 
```

虽然我怀疑这会对`int`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:33:46.203

`std::back_inserter`与 一起使用`std::copy`。例如：

```
void foo(vector<int> lhs, vector<int>& rhs)
{
  vector<int> result;
  copy( lhs.begin(), lhs.end(), back_inserter(result));
  copy( rhs.begin(), rhs.end(), back_inserter(result));
  result push_back(42);
  return result;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T18:32:02.903

您想使用[带有 3 个迭代器参数](http://www.cplusplus.com/reference/stl/vector/insert/)的插入成员函数。

# ios - iOS越狱漏洞，漏洞的影响以及如何管理它们

> ID：12806165
> 
> 赞同：2
> 
> 时间：2012-10-09T18:29:08.103
> 
> 标签：ios, ios6, jailbreak, exploit, fuzzing

[Syringe](https://github.com/Chronic-Dev/syringe)项目让您将[漏洞](https://github.com/Chronic-Dev/syringe/tree/master/syringe/exploits)“注入”到 iOS，但漏洞实际上做了什么？

当我查看[limera1n 漏洞利用](https://github.com/Chronic-Dev/syringe/blob/master/syringe/exploits/limera1n/limera1n.c)的内部时，我不明白它实际上做了什么，而且我似乎也找不到任何人解释它。

基本上我想了解更多关于漏洞利用代码如何工作以及如何找到它们的信息（我读到 Fuzzing 对此非常有用，但我找不到任何适用于 iOS 的方法，所以请分享一些相关信息）。

我阅读了[iOS Hacker's Handbook](https://rads.stackoverflow.com/amzn/click/com/1118204123)但这并没有深入了解漏洞利用细节，它只是解释了它如何工作的基础知识。

总的来说，我想了解更多关于漏洞利用等的编码。

PS：请不要退缩（如果你知道的话，即使你不能“简化它”也分享一下）。

# linux - 检查已安装的包，如果没有找到安装

> ID：12806176
> 
> 赞同：22
> 
> 时间：2012-10-09T18:29:37.307
> 
> 标签：linux, bash, shell, yum, apt

我需要检查已安装的软件包，如果未安装，请安装它们。

RHEL、CentOS、Fedora 的示例：

```
rpm -qa | grep glibc-static
glibc-static-2.12-1.80.el6_3.5.i686 
```

如何在 BASH 中进行检查？

我会做类似的事情吗？

```
if [ "$(rpm -qa | grep glibc-static)" != "" ] ; then 
```

我需要为其他发行版使用什么？容易得到？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-10-09T18:31:16.883

试试下面的代码：

```
if ! rpm -qa | grep -qw glibc-static; then
    yum install glibc-static
fi 
```

或更短：

```
rpm -qa | grep -qw glibc-static || yum install glibc-static 
```

* * *

对于Debian喜欢：

```
dpkg -l | grep -qw package || apt-get install package 
```

对于archlinux：

```
pacman -Qq | grep -qw package || pacman -S package 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-08T12:38:25.847

基于@GillesQuenot 和@Kidbulra 的回答，这是一个如何**循环多个包**并在缺少时安装的示例：

```
packageList="git gcc python-devel"

for packageName in $packageList; do
  rpm --quiet --query $packageName || sudo yum install -y $packageName
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-28T23:20:25.347

```
if [ $(yum list installed | cut -f1 -d" " | grep --extended '^full name of package being checked$' | wc -l) -eq 1 ]; then
  echo "installed";
else
  echo "missing"
fi 
```

我使用它是因为它返回已安装/丢失而不依赖于错误状态（这可能会导致脚本出现问题，通过

```
set -o errexit 
```

例如）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-25T21:11:09.000

如果您对下载的 RPM 执行此操作。你可以做到。

```
rpm -Uvh package-name-version-tag.rpm 
```

# java - Scala无法运行已编译的类，但直接运行它

> ID：12806182
> 
> 赞同：2
> 
> 时间：2012-10-09T18:30:08.343
> 
> 标签：java, scala, jvm

TL；DR：当我使用第一个变体时，REPL 运行对象很好，但是当我将 import test._ 替换为包 test 以进行编译时，即使成功编译的代码也无法运行。

我有一个用 Scala 编写的简单 Hello World 应用程序：

```
import test._
object TestApp {
  def main (args: Array[String]) {
    val p = new HelloWorldPrinter
    p.output()
  }
} 
```

HelloWorldPrinter.output() 方法只是`println("Hello World");`

当我使用`scala TestApp.scala`它运行应用程序并输出 Hello World 时，当我在其上运行 fsc 或 scalac 进行编译时，它会生成一个具有相同包名称“test”的子文件夹并将 TestApp.class 放在那里。然后，如果我运行`scala test/TestApp`它不起作用并抛出此错误：

```
Exception in thread "main" java.lang.RuntimeException: Cannot figure out how to run target: test/TestApp
    at scala.sys.package$.error(package.scala:27)
    at scala.tools.nsc.GenericRunnerCommand.scala$tools$nsc$GenericRunnerCommand$$guessHowToRun(GenericRunnerCommand.scala:38)
    at scala.tools.nsc.GenericRunnerCommand$$anonfun$2.apply(GenericRunnerCommand.scala:48)
    at scala.tools.nsc.GenericRunnerCommand$$anonfun$2.apply(GenericRunnerCommand.scala:48)
    at scala.Option.getOrElse(Option.scala:108)
    at scala.tools.nsc.GenericRunnerCommand.<init>(GenericRunnerCommand.scala:48)
    at scala.tools.nsc.GenericRunnerCommand.<init>(GenericRunnerCommand.scala:17)
    at scala.tools.nsc.MainGenericRunner.process(MainGenericRunner.scala:33)
    at scala.tools.nsc.MainGenericRunner$.main(MainGenericRunner.scala:89)
    at scala.tools.nsc.MainGenericRunner.main(MainGenericRunner.scala) 
```

但是，如果我`cd`进入“测试”以从那里运行编译的类，我会得到一个完全不同的错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: TestApp (wrong name: test/TestApp)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at scala.tools.nsc.util.ScalaClassLoader$URLClassLoader.scala$tools$nsc$util$ScalaClassLoader$$super$findClass(ScalaClassLoader.scala:88)
    at scala.tools.nsc.util.ScalaClassLoader$class.findClass(ScalaClassLoader.scala:44)
    at scala.tools.nsc.util.ScalaClassLoader$URLClassLoader.findClass(ScalaClassLoader.scala:88)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at scala.tools.nsc.util.ScalaClassLoader$URLClassLoader.scala$tools$nsc$util$ScalaClassLoader$$super$loadClass(ScalaClassLoader.scala:88)
    at scala.tools.nsc.util.ScalaClassLoader$class.loadClass(ScalaClassLoader.scala:50)
    at scala.tools.nsc.util.ScalaClassLoader$URLClassLoader.loadClass(ScalaClassLoader.scala:88)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:247)
    at scala.tools.nsc.util.ScalaClassLoader$$anonfun$tryClass$1.apply(ScalaClassLoader.scala:37)
    at scala.tools.nsc.util.ScalaClassLoader$$anonfun$tryClass$1.apply(ScalaClassLoader.scala:37)
    at scala.util.control.Exception$Catch$$anonfun$opt$1.apply(Exception.scala:104)
    at scala.util.control.Exception$Catch$$anonfun$opt$1.apply(Exception.scala:104)
    at scala.util.control.Exception$Catch.apply(Exception.scala:88)
    at scala.util.control.Exception$Catch.opt(Exception.scala:104)
    at scala.tools.nsc.util.ScalaClassLoader$class.tryClass(ScalaClassLoader.scala:36)
    at scala.tools.nsc.util.ScalaClassLoader$class.tryToLoadClass(ScalaClassLoader.scala:31)
    at scala.tools.nsc.util.ScalaClassLoader$URLClassLoader.tryToLoadClass(ScalaClassLoader.scala:88)
    at scala.tools.nsc.util.ScalaClassLoader$.classExists(ScalaClassLoader.scala:120)
    at scala.tools.nsc.GenericRunnerCommand.scala$tools$nsc$GenericRunnerCommand$$guessHowToRun(GenericRunnerCommand.scala:34)
    at scala.tools.nsc.GenericRunnerCommand$$anonfun$2.apply(GenericRunnerCommand.scala:48)
    at scala.tools.nsc.GenericRunnerCommand$$anonfun$2.apply(GenericRunnerCommand.scala:48)
    at scala.Option.getOrElse(Option.scala:108)
    at scala.tools.nsc.GenericRunnerCommand.<init>(GenericRunnerCommand.scala:48)
    at scala.tools.nsc.GenericRunnerCommand.<init>(GenericRunnerCommand.scala:17)
    at scala.tools.nsc.MainGenericRunner.process(MainGenericRunner.scala:33)
    at scala.tools.nsc.MainGenericRunner$.main(MainGenericRunner.scala:89)
    at scala.tools.nsc.MainGenericRunner.main(MainGenericRunner.scala) 
```

是什么赋予了？

编辑：

这是我的 TestApp.scala 对象：[https ://gist.github.com/3863344](https://gist.github.com/3863344)

这是我的 Printers.scala 类：[https ://gist.github.com/3863348](https://gist.github.com/3863348)

用 fsc 编译后运行`scala test/TestApp`给了我第一个错误。进入`test`子文件夹并运行`scala TestApp`给了我第二个错误。`scala TestApp.scala`在主文件夹中运行给了我这个：

```
TestApp.scala:1: error: illegal start of definition
package test
^
one error found 
```

编辑 2：我刚刚发现 REPL 无法运行带有包声明的代码，所以我明白为什么会发生上述错误。但是，我仍然无法运行我编译的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T08:15:04.897

Try running the compiled code as `scala test.TestApp` from the main folder (in the case of running compiled classes `scala` accepts class name as its argument, not a file name).

Scala (just as java) has a list of locations to search classes in - called *classpath*. By default, the location is set to the current directory. Then for given class `packageX.packageY.ClassName` it searches for the corresponding `.class` file `packageX/packageY/ClassName.class`. So if you run `scala test.TestApp` with no explicit classpath it locates the compiled file `test/TestApp.class` and runs it.

# android - 纯文本附件以 base64 结尾

> ID：12806184
> 
> 赞同：2
> 
> 时间：2012-10-09T18:30:14.477
> 
> 标签：android, email, android-intent, base64, email-attachments

在我的 Android 应用程序中，我试图允许用户发送带有附件的电子邮件。附件是纯文本文件。我希望用户能够仅选择电子邮件应用程序来发送此电子邮件。

这是我正在使用的代码：

```
Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
emailIntent.setType("message/rfc822");
emailIntent.putExtra(Intent.EXTRA_SUBJECT,  "Some awesome email");
emailIntent.putExtra(Intent.EXTRA_TEXT, "Check out the attachment!");
emailIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("file://" + file.getAbsolutePath()));
listActivity.startActivity(Intent.createChooser(emailIntent, "Send email with..."); 
```

仅显示电子邮件应用程序，到目前为止一切顺利。当我使用 gmail 发送电子邮件时，电子邮件按原样到达，附件和所有内容。

但是，当我使用 k9 邮件发送电子邮件时，附件最终被编码为 base64。所以基本上，它是不可读的。

当我使用

```
emailIntent.setType("text/plain"); 
```

附件可以正常到达（纯文本），但选择应用程序对话框包含非电子邮件应用程序。

我怎样才能两全其美？无论使用哪个电子邮件客户端，都只有选择应用程序对话框中的电子邮件应用程序和纯文本格式的文本文件附件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:37:35.383

`Intent.createChooser()`给你一个常规的`Intent`。只需修改`Intent`您返回的内容。像这样的东西：

```
Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
emailIntent.setType("message/rfc822");
emailIntent.putExtra(Intent.EXTRA_SUBJECT,  "Some awesome email");
emailIntent.putExtra(Intent.EXTRA_TEXT, "Check out the attachment!");
emailIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("file://" + file.getAbsolutePath()));
Intent intent = Intent.createChooser(emailIntent, "Send email with...");
intent.setType("text/plain");
listActivity.startActivity(intent); 
```

# java - 如何修改我的方法来搜索然后删除 O(N) 或 O(N * log N) 中的重复项？

> ID：12806186
> 
> 赞同：1
> 
> 时间：2012-10-09T18:30:16.517
> 
> 标签：java, arrays, duplicates, time-complexity

我创建了一个搜索重复项然后将重复项索引存储到另一个数组中的方法。然后我遍历我的大数组并移动所有条目而不重复。

现在，我的问题是它使用 O(N*N) 并且我正在使用额外的内存空间，因为我正在添加额外的数组。

怎么可能做到这一点？**假设我需要了解如何在不使用其他库或 HashSet 的情况下完成此操作。**

任何提示表示赞赏。

```
 public void dups()
   {
       int[] index = new int[100];

       int k = 0;
       int n = 0;
       int p = 0;

       for (int i = 0; i < elements; i++)
           for (int j = i + 1; j < elements; j++)
               if(a[j].equals(a[i]))
                   index[k++] = i;

       for (int m = 0; m < elements; m++)
           if (m != index[p])
               a[n++] = (T) a[m];
           else
               p++;

       elements -= k;
   } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:35:57.053

**`O(n)`您（通常）找不到重复项。**

不过在**`O(n*log n)`**. 只需对数组进行排序（`O(n*log n)`），然后可以在`O(n)`.

另一方面，如果您可以使用哈希表（如果您不想使用任何其他库，您可能不想这样做），您可以扫描数组并计算每个元素在数组中出现的频率. 之后，您可以遍历哈希表中的每个元素，并找到那些出现多次的元素。这将需要**预期**的运行时间**`O(n)`**，但不是确定性的`O(n)`。

**最后，为什么我写你一般都找不到重复项`O(n)`？**
可以想象几种特殊情况，在`O(n)`. 例如，您的数组只能包含从 0 到 99 的数字。在这种情况下，您可以使用另一个数组（大小为 100）来计算每个元素在数组中出现的频率。这与哈希表的工作方式相同，但它的运行时间是确定性`O(n)`的。

`O(n)`当然，如果数组已经排序，则可以找到重复项的另一个示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:43:38.467

使用 a`HashSet`在 O(n) 时间内执行此操作：

```
public <T> int removeDups(T[] original) {
    HashSet<T> unique = new HashSet<T>();
    for (T item: original) {
        unique.add(item);
    }

    int size = unique.size();
    int curr = 0;
    for (int i = 0; i < original.length; i += 1) {
        if (unique.remove(original[i])) {
            original[curr] = original[i];
            curr++;
        }
    }

    return size;
} 
```

请注意，这取决于`hashCode`您的列表元素在桶中正确分配元素`HashSet`以实现 O(n) 的方法。在最坏的情况下，这是 O(n*m)，其中 m 是唯一元素的数量，所以你绝对应该测量它。

此实现修改数组，并返回唯一元素的数量。虽然数组可能比这个大，但超过那个点的元素应该被认为是垃圾。

它通过列表向其中添加项目`HashSet`（添加项目是O（1）），然后通过更新数组，所以它是O（n）（再次假设一个好的散列函数）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:10:16.237

HashMap 的默认实现是基于数组的并且是 O(n)。因此，如果您想要一个有趣的练习，您可以筛选 HashMap 的实现，以准确了解它如何散列其键。基本上，它使用键的 hashCode 并使用它来索引预定位置的数组（hashCode & arraylength - 1），并将值存储在该索引处。如果您要重复这个概念，同时使用值作为键和值，那么您的数组中将只有唯一的条目。

但是，如果您有大量重复项，但只有唯一值，您最终会得到一个包含很多空槽的数组。填充数组后，您只需循环一次即可删除任何空槽。（例如：将所有非空条目复制到列表中）

这将是 O(n)，但需要 2 次通过 - 一次填充数组，一次删除空槽。它还需要一个与现有数组长度相同的附加数组，以及一个较小的数组（或列表）用于最终的唯一值列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T18:42:46.893

这不是 O(n) 因为哈希和等于比较，并使用 LinkedHashSet，它是 Java 标准库的一部分，但可能足够接近：

```
public void dups() {
    Set<Integer> uniques = new LinkedHashSet<>();
    for (int i = 0; i < elements.length; i++) {
        uniques.add(elements[i]);
    }
    // todo: copy the set into a list, then call toArray() to get an array.
} 
```

# java - java - 如果字符串以分号结尾，则从字符串中删除分号

> ID：12806187
> 
> 赞同：16
> 
> 时间：2012-10-09T18:30:18.757
> 
> 标签：java, string

我有一个要求，如果分号出现在字符串的末尾（仅在末尾），我需要删除它。我已经尝试了以下代码。但它仍然没有被替换。谁能告诉我需要在行号中的以下代码中更改什么
（我从这里引用了代码[How do I delete specific characters from a specific String in Java?](https://stackoverflow.com/questions/1962181/how-do-i-delete-the-last-character-of-a-particular-string-in-java)）

```
public static void main(String[] args) {
    String text = "wherabouts;";
    System.out.println("SSS "+text.substring(text.length()-1));
    if(text.substring(text.length()-1) == ";"){
        text.replaceAll(";", "");
    }
    System.out.println("TEXT : "+text);
} 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-09T18:34:44.080

```
text.replaceAll(";", ""); 
```

由于 Java 中的字符串是不可变的，因此`replaceALl()`方法不会进行就地替换，而是返回一个新的修改后的字符串。因此，您需要将返回值存储在其他字符串中。另外，要匹配末尾*的分号*，您需要在`$`后面使用量词`;`

```
text = text.replaceAll(";$", ""); 
```

`$`表示字符串的结尾，因为您要替换最后一个`semi-colon`..

如果您不使用`$`，它将替换`;`您字符串中的所有 ..

或者，对于您的工作，您可以简单地使用它，如果您想删除最后一个`;`：

```
 if (text.endsWith(";")) {
        text = text.substring(0, text.length() - 1);
        System.out.println(text);
    } 
```

**更新**：而且，如果最后有更多的分号：

```
text = text.replaceAll(";+$", ""); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-10-09T18:32:01.500

`String modifiedText = text.replaceAll(";$", "");`

**或者**

`text = text.replaceAll(";$", "");`

**或者**

```
if (text.endsWith(";")) {
    text = text.substring(0, text.length() - 1);
} 
```

***注意***：

字符串是不可变的。这意味着您无法更改它们。

因此，您必须重新分配*文本*或将其设置为新变量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-09T18:31:48.053

```
text = text.replaceAll(";", ""); 
```

这是给你的一点额外阅读 [http://javarevisited.blogspot.com/2010/10/why-string-is-immutable-in-java.html](http://javarevisited.blogspot.com/2010/10/why-string-is-immutable-in-java.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-09T18:32:08.927

你不应该忘记 String 是不可变的。因此，无论何时要修改它，都必须将结果分配给一个变量。

您需要的可能解决方案：

```
if (text.endsWith(";") {
  text = text.substring(0, text.length() - 1);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-09T18:36:00.193

String 是不可变的，因此替换后将创建新的 String。

```
String newString = text.replace(";", ""); 
```

或者

```
String newString = text.replaceAll(";$", ""); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-09T18:34:03.197

```
if (text.endsWith(";")){
    text = text.substring(0,text.length()-1);
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-10-09T18:34:15.823

您使用了错误的版本`String.substring`，您可以使用：

```
text.substring(0, text.length() - 1) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-10-09T18:32:06.853

java中的字符串是不可变的，所以`replaceAll`返回一个新的字符串。

做

```
 text = text.replaceAll(";", ""); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-10-09T18:32:13.483

如果您要使用而`.equals()`不是，请使用而不是：`==``substring()``charAt()`

```
if(text.substring(text.length()-1).equals(";")) 
```

此外，重新分配您的文本变量：

```
text = text.replaceAll(";", ""); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-10-09T18:44:08.640

您提供的代码中存在多个问题。

使用[equals](https://stackoverflow.com/questions/767372/java-string-equals-versus)比较对象。

```
if(text.substring(text.length()-1).equals(";")) 
```

如果只想替换最后一个字符，则不需要replaceAll。

要么这样做

```
if(text.substring(text.length()-1).equals(";")) {
      text = text.substring(0, text.length()-1);
    } 
```

或者

```
text = text.replaceAll(";", ""); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-10-09T18:50:20.783

```
public static void main(String[] args) {
    String text_original = "wherabouts;";
    char[] c = text_original.toCharArray();

    System.out.println("TEXT original: "+ text_original);

    String text_new = c[text_original.length()-1] == ';' ? text_original.substring(0,text_original.length()-2) : text_original;

    System.out.println("TEXT new: "+text_new);
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-10-09T18:55:40.227

只有一个分号的解决方案

```
// Don't use regular expressions if you don't need to.
if (text.endsWith(";")) {
    text = text.substring(0, text.length() - 1);
} 
```

可能不止一个分号的较慢解决方案

```
text.replaceAll(";+$", ""); 
```

另外，这里是您最初发布的代码的一些其他问题，以供参考。

```
if(text.substring(text.length()-1) == ";"){ 
```

您不能将字符串与`==`. 相反，您必须将它们与`.equals()`. 这将正确地写成这样`...ength()-1).equals(";")`。

```
text.replaceAll(";", ""); 
```

这将替换它找到的所有分号。这意味着如果您的字符串是`some;thing;`，它会将其转换为`something`，但您只想删除最后一个分号，如下所示`some;thing`：要正确执行此操作，您需要使用如下特殊`$`字符查找字符串的结尾：

```
text.replaceAll(";$", ""); 
```

# ios - 自定义警报视图

> ID：12806188
> 
> 赞同：-1
> 
> 时间：2012-10-09T18:30:27.320
> 
> 标签：ios, objective-c, hud

Foursquare 使用自定义警报（如附件图像）。我试图获得相同的外观和感觉、圆角、淡入和淡出效果等。我环顾四周，但我发现的所有解决方案似乎都过于复杂了一些简单的东西，比如：

[http://joris.kluivers.nl/blog/2009/04/23/subclass-uialertview-to-create-a-custom-alert/](http://joris.kluivers.nl/blog/2009/04/23/subclass-uialertview-to-create-a-custom-alert/)

我在正确的道路上吗？我应该使用一些我不知道的自定义视图类吗？我应该自己写吗？

![图片](../Images/73919d65dd916b26427038149273c5f6.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:41:28.847

您链接的方法很好。`UIAlertView`当警报弹出时，他们可能会进行子类化以获得相同的“暗淡”效果（参见他们的屏幕截图）。Foursquare 没有那种暗淡的效果（在您的图像中）。他们可能只是简单地将其子类化`UIView`并将其作为子视图添加到`UIWindow`应用程序中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:39:44.053

如果已经编写的子类有效，为什么不呢？如果不是，那么他们在您粘贴在您的帖子中的那篇博客文章中所做的似乎就是覆盖`drawRect`绘制自己的图形的方法。如果您愿意自己做这件事，那是有可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-29T13:08:06.790

看看 MBProgressHUD：[https ://github.com/jdg/MBProgressHUD](https://github.com/jdg/MBProgressHUD)

此 HUD 可以使用图像进行自定义：

```
 HUD.customView = customImage; // UIImageView
    HUD.mode = MBProgressHUDModeCustomView; 
```

问候。

# bash - Bash read -r -d '' FILE_CONTENTS <<'EOF' as root 对我来说是**核**

> ID：12806189
> 
> 赞同：0
> 
> 时间：2012-10-09T18:30:27.820
> 
> 标签：bash

这个用于将多行字符串文字分配给变量的典型 Bash 脚本习惯用法：

```
read -r -d '' FILE_CONTENTS <<'EOF'
... contents ...
EOF 
```

在我使用它的任何地方都很好地为我服务。

`root`我像今天一样运行一个包含这个成语的脚本，结果一败涂地。文件会损坏，各种奇怪的东西从天而降。我蒸发了我的 Mac。顺便说一句，这个错误已经摧毁了......基本上一切。如果我可以投票支持自己拥有核能力，我会的。自我毁灭的有效性。

* * *

[![核](../Images/98a38afc9c92bcc1b043e4e7c83f33d5.png)](https://i.stack.imgur.com/MHuSg.gif)
[（来源：[iliketowastemytime.com](http://iliketowastemytime.com/sites/default/files/best_animated_gif_nuclear_explosion.gif)）]

* * *

让我为您提供一个最小的工作配置来复制它：

```
# Recreating a .vimrc file, for example
read -r -d '' FILE_CONTENTS <<'EOF'
    let mapleader = "<space>"
    let maplocalleader = "\\"
EOF
echo "${FILE_CONTENTS}" > .vimrc 
```

这作为用户工作得很好，`tinosino`但是......作为根......任何带有反斜杠的东西都是有问题的。

为什么？在哪里寻找“*差异*”？选项？环境？“回声”的别名（？！）我迷路了。也尝试`bash -x`过：我正在测试的脚本上的页面和页面失败。在 root 的设置中可能会改变什么？在哪里？

```
OS X version: 10.8.2
Bash version: 3.2.48(1)-release 
```

我在剧本中有一个`sh`Vs`bash`守卫，但没有奏效……它是不是结构不好？

```
if [ ${BASH_VERSION-not_running_within_bash} = not_running_within_bash ]; then
  echo This script is meant to be executed by the Bash shell but it isn\'t.
  echo Continuing from another shell may lead to unpredictable results.
  echo Execution will be aborted... now.
  return
fi 
```

它停止`zsh`但不会停止`sh`运行脚本......我怎么能这样做？

**编辑**：我求助于将脚本*保护*更改为：

```
if [[ ! $(ps -p $$ -o comm | paste -s - | awk '{ print $NF }') == *bash* ]]; then 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:58:05.080

不要忘记 root 通常以 #!/bin/sh 的形式运行脚本

`#!/bin/bash`您描述的错误听起来像是为运行而编写的脚本`#!/bin/sh`。在某些系统上`#!/bin/sh`指向`#!/bin/bash`，因此您的 bash-ismed 代码可以工作，但是当使用真正的 Bourne Shell ( `#!/bin/sh`) 运行时，bashisms 会导致脚本失败，有时，就像您的情况一样，以非常灾难性的方式失败。

只是注意到您对 BASH_VERSION 的测试。好主意。我敢打赌，由于`=`. 试试吧`-eq`。我没有真正的 Bourne Shell 可供测试。

对不起，祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:17:33.910

这将是另一种方法：

```
#!/bin/bash
(
cat <<'EOF'
let mapleader = "<space>"
let maplocalleader = "\\"
EOF
) > .vimrc 
```

# visual-c++ - 为什么使用链接器选项 /DYNAMICBASE 可以加快我的应用程序的速度？

> ID：12806195
> 
> 赞同：2
> 
> 时间：2012-10-09T18:30:50.153
> 
> 标签：visual-c++, linker

我目前使用一个简单的应用程序进行了一些速度测量，在此过程中，我注意到当我告诉链接器使用 /DYNAMICBASE 时，运行时间缩短了大约 1.5%。

我同意 1.5% 很容易在测量过程中出现错误，但我实际上使用 /DYNAMICBASE 运行了超过 15 次，使用 /DYNAMICBASE:NO 运行了 15 次以上，每次运行大约 5 分钟。甚至 /DYNAMICBASE:NO 运行中最快的速度都不比最慢的 /DYNAMICBASE 运行速度快...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-06T09:41:17.913

如果您的解决方案直接或间接使用许多 DLL - /DYNAMICBASE 可以减轻 Windows 加载程序的一些负担，尤其是在应用于依赖 DLL 时。当使用的二进制文件被加载并放置在进程地址空间中时，如果它们的默认基地址范围发生冲突 - Windows 加载程序必须*重新*设置它们的基址，即确定新的基地址并遍历 DLL 全局符号调用（数据或函数）并更改它们到新地址。对于许多或非常大的 DLL，这可能会对启动时间产生不可忽视的影响。

如果您从调试器运行，您可以在“模块”窗口中查看加载的二进制文件，并检查左侧的图标以确定模块是否经历了变基：

[![模块窗口](../Images/1732217381e44f3d278391cef3da6e09.png)](https://i.stack.imgur.com/FPRCf.png)

如果您看到许多 DLL 避免使用 /DYNAMICBASE 进行变基，这可能是原因。您可以（并且原则上应该）使用 /BASE 直接控制基地址，而不是把这个好处留给机会。

# c# - 无法从 C# 连接到 mysql，连接已打开错误

> ID：12806196
> 
> 赞同：-1
> 
> 时间：2012-10-09T18:30:57.920
> 
> 标签：c#, .net, mysql, database

我正在尝试连接到 mysql 数据库，据我所知，我的凭据（用户名、密码、数据库名称......等）都是正确的。我卡在 coonection.open() 语句中，该语句显示连接已打开的错误。

我在其他网站上搜索帮助，它已被报告为一个错误... [http://support.microsoft.com/kb/823401](http://support.microsoft.com/kb/823401)

在寻找替代解决方案时，我遇到了

```
 using ( connection = MySqlConnection(connectionString)) 
```

我无法继续。对此的任何帮助将不胜感激。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using MySql.Data.MySqlClient;
using System.Windows.Forms;

namespace HotelManagement
{
class DBConnect
{
    private MySqlConnection connection;
    private string server;
    private string database;
    private string uid;
    private string password;

    //constructor
    public DBConnect()
    {
        Initialize();
    }

    private void Initialize()
    {
        server = "localhost";
        database = "hm";
        uid = "root";
        password = "password";
        string connectionString;
        connectionString = "SERVER=" + server + ";" + "DATABASE=" + database + ";" +    "UID=" + uid + ";" + "PASSWORD=" + password + ";";

        connection = new MySqlConnection(connectionString);
    }

    public bool openConnection()
    {
        try
        {
            connection.Open();  //*SHOWS ERROR InvalidOperationUnhandled: Conection already open*
            return true;

        }
        catch (MySqlException e)
        {
            //error 0: Cannot Connect to the server
            switch (e.Number)
            {
                case 0: MessageBox.Show("Cannot Connect to the server");
                    break;
                case 1045: MessageBox.Show("invalid username/password");
                    break;
            }
            return false;
        }
    }

    public bool closeConnection()
    {
        try
        {
            connection.Close();
            return true;
        }
        catch (MySqlException e)
        {
            MessageBox.Show(e.Message);
            return false;
        }
    }

    public void insert()
    {
        string query = "insert into test (i) values (10)";
        if (this.openConnection() == true)
        {
            //creating command and connections
            MySqlCommand cmd = new MySqlCommand(query, connection);
            cmd.ExecuteNonQuery();
            this.closeConnection();
        }
    }

    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T18:34:44.643

你必须关闭你的连接，你还没有关闭连接（也许在第一次调试之后）

您可以使用

```
connection.Close(); 
```

最佳实践：

我建议你使用 using 块，以确保你在处理结束时清理非托管对象

```
using(var connection = new MySqlConnection(...))
{
  ...
} 
```

# ruby-on-rails - 如何在 Ruby on Rails 3.2.8 中的 LocalStorage 上保存数据？

> ID：12806198
> 
> 赞同：9
> 
> 时间：2012-10-09T18:31:13.343
> 
> 标签：ruby-on-rails, ruby, html, local-storage, session-variables

我正在尝试保存一个名为`persistent_data`.

我通常使用`session[:persistent_data]`or `cookies[:persistent_data]`，但我想改用 localstorage 。

我如何在 Rails 上做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-09T18:48:25.160

Localstorage 与 Rails 无关。您可以像使用任何其他语言一样执行此操作：

```
<script>
localStorage.setItem("company_id", "1");
</script>

localStorage.getItem("company_id");
=> 1 
```

但是，您可以使用 rails 动态设置项目：

```
<script>
localStorage.setItem("company_id", "<%= @company.id %>");
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-10-03T07:24:29.020

这很简单，需要了解本地存储的工作原理。

您可以直接执行此操作，或者（这可能更清洁）使用 setItem() 和 getItem() 方法：

```
localStorage.setItem('color','blue'); 
```

如果你读出颜色键，你会得到“蓝色”：

```
localStorage.getItem('color');`// output will be blue` 
```

要删除项目，您可以使用 removeItem() 方法：

```
localStorage.removeItem('color'); 
```

烦人的事情是当你有一个数组时，它不会以正确的方式存储。

```
var car = {};
car.wheels = 4;
car.doors = 2;
car.sound = 'vroom';
car.name = 'Suzuki Mehran';
console.log( car );
localStorage.setItem( 'car', car );
console.log( localStorage.getItem( 'car' ) ); //output as `[object Object]` 
```

但不必担心，我们也有解决方案。您可以使用本机 JSON.stringify() 和 JSON.parse() 方法解决此问题：

```
localStorage.setItem( 'car', JSON.stringify(car) ); 
```

你可以简单地把它拿回来

```
JSON.parse( localStorage.getItem( car ) ); 
```

希望你现在没有任何困惑！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T18:43:57.390

据我所知，localStorage 与 Rails 无关，它是纯 Javascript/HTML5 功能。

您可以在应用程序 js 中使用以下内容，以便从本地存储读取或写入数据：

```
var foo = localStorage.getItem("bar");
localStorage.setItem("bar", foo); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T19:07:23.100

正如其他人已经说过的那样，本地存储是 Javascript/Html 功能/解决方案，但如果想了解如何将其与 Rails 集成，Ryan Bates 在[http://railscasts.com/episodes/248-offline-apps-part-2](http://railscasts.com/episodes/248-offline-apps-part-2)上有一个 railscast ，尽管您可能需要观看第 1 部分才能完全理解它。

# android - Android 视图启用和可聚焦的交互

> ID：12806205
> 
> 赞同：0
> 
> 时间：2012-10-09T18:31:31.127
> 
> 标签：android, android-view

将例如 EditText 设置为禁用是否意味着视图无法获得焦点？如果我稍后重新启用该视图，我之前的焦点设置是否会再次适用？

本质上，我想知道这两条焦点线是否必要：

```
@Override
public void setEnabled(boolean enable) {
    super.setEnabled(enable);

    // Manually set nested view enabled state
    _myInnerView.setEnabled(enable);
    _myInnerView.setFocusable(enable);
    _myInnerView.setFocusableInTouchMode(enable);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:45:00.570

您可以使用

```
getWindow().getCurrentFocus(); 
```

找出哪个视图具有焦点。有了这个，只需尝试它在您的特定活动中的运行方式。

# android - 如何告诉 proguard 不要混淆我班级中的某些方法名称？

> ID：12806206
> 
> 赞同：0
> 
> 时间：2012-10-09T18:31:36.127
> 
> 标签：android, proguard

我正在使用的外部集合库允许我在自定义对象列表上执行 where 方法。它需要我要过滤的方法/属性名称，并将其作为字符串。由于进行了混淆，该方法似乎不存在。

我试图告诉 proguard 不要混淆该对象上的方法，但它不起作用。

在 proguard 配置中，我正在尝试这个

```
-keep public class com.mop.mobile.myproject.obj.MyClass**
-keepnames public class com.mop.mobile.myproject.obj.MyClass** 
```

这是 logcat 跟踪

```
E/AndroidRuntime(20419): FATAL EXCEPTION: main
E/AndroidRuntime(20419): java.lang.RuntimeException: Unable to start activity Co
mponentInfo{com.mop.mobile.myproject/com.mop.mobile.myproject.MyPagerActivity}: java.la
ng.RuntimeException: java.lang.RuntimeException: java.lang.NoSuchMethodException
: getMyId []
E/AndroidRuntime(20419):        at android.app.ActivityThread.performLaunchActiv
ity(ActivityThread.java:2059)
E/AndroidRuntime(20419):        at android.app.ActivityThread.handleLaunchActivi
ty(ActivityThread.java:2084)
E/AndroidRuntime(20419):        at android.app.ActivityThread.access$600(Activit
yThread.java:130)
E/AndroidRuntime(20419):        at android.app.ActivityThread$H.handleMessage(Ac
tivityThread.java:1195)
E/AndroidRuntime(20419):        at android.os.Handler.dispatchMessage(Handler.ja
va:99)
E/AndroidRuntime(20419):        at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime(20419):        at android.app.ActivityThread.main(ActivityThrea
d.java:4745)
E/AndroidRuntime(20419):        at java.lang.reflect.Method.invokeNative(Native
Method)
E/AndroidRuntime(20419):        at java.lang.reflect.Method.invoke(Method.java:5
11)
E/AndroidRuntime(20419):        at com.android.internal.os.ZygoteInit$MethodAndA
rgsCaller.run(ZygoteInit.java:786)
E/AndroidRuntime(20419):        at com.android.internal.os.ZygoteInit.main(Zygot
eInit.java:553)
E/AndroidRuntime(20419):        at dalvik.system.NativeStart.main(Native Method)

E/AndroidRuntime(20419): Caused by: java.lang.RuntimeException: java.lang.Runtim
eException: java.lang.NoSuchMethodException: getMyId []
E/AndroidRuntime(20419):        at com.a.a.b.a.a.a(Unknown Source)
E/AndroidRuntime(20419):        at com.a.a.b.a.b.a(Unknown Source)
E/AndroidRuntime(20419):        at com.a.a.b.a.a(Unknown Source)
E/AndroidRuntime(20419):        at com.mop.mobile.myproject.MyPagerActivity.a(Unknow
n Source)
E/AndroidRuntime(20419):        at com.mop.mobile.myproject.MyPagerActivity.onCreate
(Unknown Source)
E/AndroidRuntime(20419):        at android.app.Activity.performCreate(Activity.j
ava:5008)
E/AndroidRuntime(20419):        at android.app.Instrumentation.callActivityOnCre
ate(Instrumentation.java:1079)
E/AndroidRuntime(20419):        at android.app.ActivityThread.performLaunchActiv
ity(ActivityThread.java:2023)
E/AndroidRuntime(20419):        ... 11 more
E/AndroidRuntime(20419): Caused by: java.lang.RuntimeException: java.lang.NoSuch
MethodException: getMyId []
E/AndroidRuntime(20419):        at com.a.a.c.a.a(Unknown Source)
E/AndroidRuntime(20419):        ... 19 more
E/AndroidRuntime(20419): Caused by: java.lang.NoSuchMethodException: getOverallP
riorityId []
E/AndroidRuntime(20419):        at java.lang.Class.getConstructorOrMethod(Class.
java:460)
E/AndroidRuntime(20419):        at java.lang.Class.getMethod(Class.java:915)
E/AndroidRuntime(20419):        ... 20 more
W/ActivityManager(  307):   Force finishing activity com.mop.mobile.myproject/.Asse
tListPager
W/ActivityManager(  307):   Force finishing activity com.mop.mobile.myproject/.Near
MeActivity
W/ActivityManager(  307): Activity pause timeout for ActivityRecord{435fbdc0 com
.mop.mobile.myproject/.MyPagerActivity}
I/ActivityManager(  307): No longer want com.google.android.gms (pid 20052): hid
den #16
W/System.err(20419): IOException processing: 26
W/System.err(20419): java.io.IOException: Server returned: 3
W/System.err(20419):    at android_maps_conflict_avoidance.com.google.googlenav.
map.BaseTileRequest.readResponseData(BaseTileRequest.java:115)
W/System.err(20419):    at android_maps_conflict_avoidance.com.google.googlenav.
map.MapService$MapTileRequest.readResponseData(MapService.java:1473)
W/System.err(20419):    at android_maps_conflict_avoidance.com.google.googlenav.
datarequest.DataRequestDispatcher.processDataRequest(DataRequestDispatcher.java:
1117)
W/System.err(20419):    at android_maps_conflict_avoidance.com.google.googlenav.
datarequest.DataRequestDispatcher.serviceRequests(DataRequestDispatcher.java:994
)
W/System.err(20419):    at android_maps_conflict_avoidance.com.google.googlenav.
datarequest.DataRequestDispatcher$DispatcherServer.run(DataRequestDispatcher.jav
a:1702)
W/System.err(20419):    at java.lang.Thread.run(Thread.java:856)
W/ActivityManager(  307): Activity destroy timeout for ActivityRecord{42a743d0 c
om.mop.mobile.myproject/.myprojectActivity}
W/ActivityManager(  307): Activity destroy timeout for ActivityRecord{435fbdc0 c
om.mop.mobile.myproject/.MyPagerActivity} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:48:29.513

试试这个：

```
-keep public class com.mop.mobile.myproject.obj.MyClass { *; } 
```

代替

```
-keep public class com.mop.mobile.myproject.obj.MyClass** 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-11T10:56:23.627

要告诉 proguard 不要混淆某个类的方法/属性，请使用这些行...

```
keepclassmembers class com.mop.mobile.myproject.obj.MyClass{*;}

keepattributes com.mop.mobile.myproject.obj.MyClass 
```

它对我有用。

# php - 使用带有脚本字体的 Imagettfbbox() 的图像高度错误

> ID：12806209
> 
> 赞同：1
> 
> 时间：2012-10-09T18:31:45.200
> 
> 标签：php

我正在动态生成一些文本的PNG图像（透明背景）。文本将是用户键入的任何内容，使用英语 111 Vivace BT（脚本）作为字体。

无论文本有多大，图像始终为 100px 高 x 200px 宽。我希望文本水平居中并尽可能靠近图像顶部。

除了 imagettfbbox() 似乎为边界框返回了不正确的点之外，这一切都正常工作，它认为文本比实际高，因此在文本之前的图像顶部出现了一些空白区域。

请看附件的例子png，我画了一些红色的指引来演示这个问题。左侧显示了 38px 高的准线，这就是 imagettfbbox() 认为的文本高度。右侧显示了一条针对文本本身测量的线，它只有 26 像素高。

有没有更准确的方法来获取盒子？还是我在这里犯了其他错误？

```
$text = "A";
$fontSize = 15;
$font = "e111viva-webfont.ttf";
$textColor = convertHexToRGB( "000000" );
$angle = 25;
$image = imagecreatetruecolor( 200,  100 );
$textDimensions = imagettfbbox($fontSize, $angle, $font, $text);
$textHeight = abs($textDimensions[7]);
$textWidth = abs($textDimensions[0]) + abs($textDimensions[2]); // lower left X + lower right X
$textLeft = (200 - $textWidth) / 2;
// center horizontally
$textX = $textDimensions[0] + (imagesx($image) / 2) - ($textDimensions[4] / 2) - 25;
$textY = $textDimensions[1] * 2;
imagesavealpha($image, true);
imagealphablending($image, true);
$transparentColor = imagecolorallocatealpha($image, 0, 0, 0, 127);
$fillResult = imagefill($image, 0, 0, $transparentColor);
$textColor = imagecolorallocate($image, $textColor["r"], $textColor["g"], $textColor["b"]);
$ttfTextResult = imagettftext($image, $fontSize, 0, $textLeft, $textHeight, $textColor, $font, $text);
header('Content-Type: image/png');
imagepng($image);
imagedestroy($image); 
```

![图像高度不正确](../Images/44af2d5852c18c689deb5f5780ca33c0.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T20:47:25.970

发现了问题，这是我的错误，我将角度设置为 25 而不是 0。所以 PHP 认为文本将写在一个角度上，这将使高度（和宽度）测量对角线而不是从从上到下和从一侧到另一侧。

当我将角度校正为 0 时，它工作正常。

# php - 在 Yii WebModules 中定义布局

> ID：12806211
> 
> 赞同：0
> 
> 时间：2012-10-09T18:31:51.733
> 
> 标签：php, module, yii

我将在我的网络项目中使用一个网络模块。我想做的是使用我原来的项目主题作为它的布局。但是当我在文件 DefaultController 中的模块类上编写此代码时（我的模块名称是 cpanel）没有任何反应，模块无法从主题加载布局。这是我的代码：

```
class DefaultController extends Controller {

    public function actionIndex() {
        $this->layout = "column2";
        $this->render('index');
    }

} 
```

我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:11:25.847

我认为应该是：

```
$this->layout = '//layouts/column2';
$this->render('index'); 
```

确保“layouts”文件夹中有“column2.php”布局文件：`\protected\views\layouts\`

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:13:04.303

我已经解决了我的问题。我的布局视图页面（column2.php）中有一行获取主视图内容。

```
$this->beginContent('//layouts/main'); 
```

我删除了第一个斜线，它确实对我有用。只是将其更改为：

```
$this->beginContent('/layouts/main'); 
```

# gnuplot - 在 Gnuplot 中绘制同一列的 xy 数据

> ID：12806226
> 
> 赞同：1
> 
> 时间：2012-10-09T18:32:31.827
> 
> 标签：gnuplot

我正在阅读 Gnuplot in Action 一书，遇到了讨论“每个”命令的部分。作者使用的样本数据是：

```
# time - value
0 100.03 # temperature
0 2.10 # pressure
1 100.26 # t
1 2.02 # p
2 101.34 # t
2 1.95 # p
3 102.41 # t
3 1.87 # p 
```

他使用以下命令绘制温度与第一列数据（时间）的关系：

```
plot "data" every 2 using 1:2 with lines 
```

有没有办法在不必操纵文件本身的情况下绘制温度与压力的关系？换句话说，是否可以将同一列用于绘图的 x 和 y 数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T23:58:55.223

我不知道怎么做，因为 gnuplot 一次读取 1 个“记录”。您可以告诉 gnuplot 要读取哪些记录，但没有办法告诉 gnuplot 混合相邻的记录（除了将繁重的工作交给其他实用程序）。但是，由于 gnuplot 可以读取其他实用程序的标准输出，因此您可以这样做而不会弄乱位于磁盘上的文件或创建任何临时文件。以下是使用 awk 的方法：

```
#untested
plot '<awk "BEGIN{getline}{a=$2;getline; b=$2;    print a,b}" test.dat' u 1:2 w lines
#          #discard header #line1        #line2  #print mix 
```

*使用 可能有更简单的方法`sed`，但我不太了解`sed`，`awk`这还不错*

# jquery - 使用 Carrierwave 和 JQuery 文件上传的多个文件上传

> ID：12806230
> 
> 赞同：1
> 
> 时间：2012-10-09T18:32:50.893
> 
> 标签：jquery, ruby-on-rails, carrierwave, formtastic

```
<%= semantic_form_for(@image, :url => { :action => "create_friend_upload" }, :html => {:multipart => true}) do |f| %>
    <%= f.inputs do %>
     <%= f.input :image, :input_html => {:multiple => true}, name: "gallery[image]" %>
     <%= f.hidden_field :friend_upload, :value => true %>    
     <%= f.hidden_field :user_id %>
     <%= f.hidden_field :friend_uploader, :value => current_user.name %>
    <% end %>
     <%= f.buttons do %>
     <%= f.commit_button :button_html => {:class => "primary"} %>
    <% end %>
    <% end %> 
```

我的问题是它不断提交一个数组，Carrierwave 无法处理。它一直在说`name=\"gallery[image][]\"`，而不是只是`name=\"gallery[image]\"`。（见下文）。因此，我也不断收到错误消息`can't convert nil into String`。

```
 @headers="Content-Disposition: form-data; name=\"gallery[image][]\"; filename=\"VW 3.jpeg\"\r\nContent-Type: image/jpeg\r\n", 
```

有谁知道如何解决这个问题？谢谢！

**更新：**

我也确实在 JQuery 上看到了 Ryan 的 railscasts 视频，他对此的修复对我不起作用。

图库.rb

```
class Gallery < ActiveRecord::Base
  attr_accessible :image, :name, :friend_upload, 
  mount_uploader :image, GalleryUploader
end 
```

画廊控制器

```
def friend_upload
 @image = Gallery.new
end

def create_friend_upload
 @image = Gallery.create(params[:gallery])
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T05:39:12.680

因为您正在指定`:multiple => true`，所以 rails 会生成`name="gallery[image][]"`. 由于[https://github.com/rails/rails/pull/8108](https://github.com/rails/rails/pull/8108) ，在升级到最新版本的 rails (3.2.13) 时，您也可能会遇到此问题。

简单的解决方法是

```
$('#fileupload').fileupload({
    paramName: 'gallery[image]'
}); 
```

这利用`paramName`选项来指定文件表单数据

参考：

*   [https://github.com/blueimp/jQuery-File-Upload/wiki/Options#paramname](https://github.com/blueimp/jQuery-File-Upload/wiki/Options#paramname)
*   [https://github.com/blueimp/jQuery-File-Upload/issues/1529](https://github.com/blueimp/jQuery-File-Upload/issues/1529)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-25T11:08:03.450

出现问题是因为您没有放入`name`其中`input_html`，这就是 using 的问题`simple form`，可能`semantic form`也是如此

# mysql - 为字段指定限定表名的替代解决方案

> ID：12806231
> 
> 赞同：0
> 
> 时间：2012-10-09T18:32:53.057
> 
> 标签：mysql, sql

关于`Column '' in field list is ambiguous`MySQL中的错误。如果 mysql 无法确定字段名称属于哪个表，则会导致此问题。有没有人知道为字段指定限定表名的不同方法，而不是将表名作为字段本身的前缀。假设我有一个这样的字段列表

```
INSERT INTO dupes 
   ( lead_id,set_id,upload_date,agent,callcenter
    ,generation_date,vendors,first_name
    ,last_name,email,phone,address,city,state,zip,dob
    ,gender,marital_status,rented,year,make,model,trim
    ,vin,primary_use,miles_oneway,mileage,license_num,license_state
    ,education,job_title,license_status)

(SELECT lead_id,set_id,upload_date,agent,vendors,callcenter
    ,generation_date,first_name,last_name
    ,email,phone,address,city,state,zip,dob,gender,marital_status
    ,rented,year,make,model,trim,vin,primary_use,miles_oneway
    ,mileage,license_num,license_state,education,job_title
    ,license_status 
 FROM leads_auto 
 JOIN (
    SELECT vendors, email, MIN(lead_id) min_lead_id 
    FROM leads_auto 
    WHERE vendors = 1762
    GROUP BY vendors, email) y 
 ON    y.vendors = leads_auto.vendors 
   AND y.email = leads_auto.email 
   AND leads_auto.lead_id <> y.min_lead_id) 
```

现在我正在考虑使用`GROUP_CONCAT([fields] SEPARATOR ',[table name].')`将字段添加到变量中，然后执行它。还有其他人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:52:07.477

我可以立即看到“电子邮件”字段不明确，因为它存在于您的第一个表 Leads_auto 中，并且您在 JOIN 中选择了它。当你使用 JOIN 时，你应该在所有的 SELECTions 前面加上一个明确的表别名，像这样：

```
SELECT la.lead_id,la.set_id,la.upload_date,...  
FROM leads_auto la
JOIN (SELECT ...) y
... 
```

通过这种方式，您可以引用`la.field_name`或`y.field_name`明确您的意思。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:49:52.777

只是一个建议，但我会按照与子句`INSERT`中相同的顺序列出列名。`SELECT`

# mvvm - 操作 ViewModel 的 ApplicationCommands 是否打算与 MVVM 一起使用？

> ID：12806232
> 
> 赞同：0
> 
> 时间：2012-10-09T18:32:53.607
> 
> 标签：mvvm, mvp

静态类`ApplicationCommands`由许多`RoutedUICommand`s 组成，其中一些可能是纯粹基于视图的命令（撤消/重做、剪切/复制/粘贴），但其他的最终需要使用视图模型。但是，当使用后面的命令之一时，例如`Save`，没有干净的方法将命令传播到视图模型：

```
<CommandBindings>
    <CommandBinding Command="Save" Executed="Save_Executed" />
</CommandBindings>
....
<MenuItem Command="Save" /> 
```

这将调用`Save_Executed`代码隐藏类上的事件处理程序，因为它将在 MVP 模式中使用，但它不允许我将命令移动到 MVVM 中的视图模型，除非在`Save_Executed`事件处理程序中使用这条丑陋的行：

```
((ViewModel1)this.DataContext).Save(); 
```

这也与其他命令完全不一致，比如`RelayCommand`直接在视图模型中定义的s。由于所有这些不便，我的印象是 ApplicationCommands 在设计时只考虑了 MVP，而不是 MVVM。

需要传播到视图模型的命令是否完全可用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T16:02:35.737

如果我正确理解您的问题，我认为如果您像这样处理它，您可以按照您的要求做。

**你的视图模型**

```
// Call this from your ctor
 private void InitializeCommandBindings()
    {
        this.CommandBindings = new CommandBindingCollection(new[]
            {                   
        new CommandBinding(
                    ApplicationCommands.Save,
                    new ExecutedRoutedEventHandler(YourEventHandler),
                    new CanExecuteRoutedEventHandler((sender, e) => e.CanExecute = Your Logic...))
});
} 
```

**你的看法**

```
<Button Command="{x:Static ApplicationCommands.Save}"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-03T09:59:35.853

您需要将绑定添加到视图

```
this.CommandBindings.AddRange(((MainViewModel)this.DataContext).CommandBindings); 
```

# ios - iOS 企业帐户：使用 iTunes 分发应用程序

> ID：12806233
> 
> 赞同：0
> 
> 时间：2012-10-09T18:32:56.773
> 
> 标签：ios, deployment, enterprise

我无法使用 iTunes 安装应用程序

以下是我做过的事情

1) 制作分发证书 2) 制作与 xcode 文件匹配的 app id 3) 制作临时文件 4) 在 xcode 中安装 5) 存档文件 6) 保存以供内部开发 7) 选择了上述 mob 临时文件 8) 应用程序是保存为 ipa 文件 9) 将其拖到 iTunes 上 10) 同步 11) 未安装应用程序是我在 Pad 上而不是在 iTunes 上遇到的错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:53:13.373

iTunes only works on the computer they synced with. You are better off using OTA (over the air) distribution. Check [this site](http://testflightapp.com/dashboard/) to get started using an OTA service

# mysql - 在 MySQL 中选择多个具有相同名称的列

> ID：12806237
> 
> 赞同：2
> 
> 时间：2012-10-09T18:33:10.277
> 
> 标签：mysql, sql

我想访问 mysql 中的两个表，并想使用两个表中的字段。我使用内部连接来匹配两个表，但想知道如何获取两个表中的字段，因为两个表具有相同的字段名称和不同的值。这是我的查询...

```
$query1 = mysql_query("SELECT facilitator.FacID, facilitator.email, assigned.email FROM facilitator INNER JOIN assigned ON facilitator.FacID = assigned.FacID WHERE assigned.email = '$stuemail' AND facilitator.active = '1'") or die($query."<br/><br/>".mysql_error());
            while($line1=mysql_fetch_array($query1,MYSQL_ASSOC)){
                $faci= $line1['FacID'];
                $facemail = $line1['email'];
                $stumail2 = $line1['email'];
.............code goes on.............. 
```

我想获取两个电子邮件字段值，但想知道该怎么做。我确定我为 $stumail2 写的内容是错误的。请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:35:50.490

你有几个选择。

第一个是在 MySQL 中分配一个字段别名：

```
SELECT
    facilitator.FacID,
    facilitator.email AS facilitatorEmail,
    assigned.email AS assignedEmail
    .... 
```

第二个，因为您正在使用`mysql_fetch_array()`，是通过索引访问字段。该`facilitator.email`字段具有 index`1`并且`assigned.email`具有 index `2`，因此您可以使用：

```
$facemail = $line1[1];
$stumail2 = $line1[2]; 
```

或者，默认情况下，MySQL*应该*`1`为每个重复的列名添加一个递增的数字（从 开始）。因此，您应该能够使用`email1`来访问该`assigned.email`列：

```
$facemail = $line1['email'];
$stumail2 = $line1['email1']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:35:25.107

您可以在列上使用别名来消除歧义，例如：

```
SELECT facilitator.FacID, 
    facilitator.email as FacilitatorEmail, 
    assigned.email as AssignedEmail
FROM ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T18:38:28.143

您只需要查询中的“as”关键字：

```
$query1 = mysql_query("SELECT facilitator.FacID, facilitator.email as fac_email, assigned.email as assign_email FROM facilitator INNER JOIN assigned ON facilitator.FacID = assigned.FacID WHERE assigned.email = '$stuemail' AND facilitator.active = '1'") or die($query."<br/><br/>".mysql_error());
        while($line1=mysql_fetch_array($query1,MYSQL_ASSOC)){
            $faci= $line1['FacID'];
            $facemail = $line1['fac_email'];
            $stumail2 = $line1['assign_email']; 
```

# iphone - NSLayoutConstraint 和动态 UITableViewCell 高度

> ID：12806240
> 
> 赞同：3
> 
> 时间：2012-10-09T18:33:28.453
> 
> 标签：iphone, ios, cocoa-touch, uitableview, nslayoutconstraint

如何为动态 tableViewCell 高度编写（或在 IB 中执行）布局约束？例如，如果单元格的 contenView 中有 textView（大小适合），并且我希望单元格与标签一样高。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T18:35:58.050

如果您已经完全正确地设置了约束，您可以通过获取单元格的实例并调用`systemLayoutSizeFittingSize:UILayoutFittingCompressedSize`它来计算高度。这将导致您的实例围绕约束收缩，从而为您提供所需的高度。

但是，表格中的单元格仍然会从`tableView:heightForRowAtIndexPath:`. 所以你仍然必须做在自动布局存在之前你会做的事情：你必须提前计算所有单元格的高度，以便你可以响应一连串的`tableView:heightForRowAtIndexPath:`调用。不同之处在于，现在您使用自动布局来执行高度计算，而不是之前所做的任何事情。

现在有一个坏消息：对于一张长桌，这可能会很慢。

# c - 保持软件免费的秘密服务器协议

> ID：12806243
> 
> 赞同：2
> 
> 时间：2012-10-09T18:33:42.513
> 
> 标签：c, protocols, network-protocols

我目前正在学习 C 中的基本网络，并且我对 Internet 的“晦涩”部分感兴趣：秘密协议。

假设我开发了一款多人在线游戏。我会设计自己的数据打包和解包协议，这样客户端和服务器都可以正确发送、接收和解析信息（例如：位置数据包、施法……等等）。当然，我不希望该协议出现在公共领域，因为任何想在我的服务器中制造“坏事”的人都可以做到。但我想保留我的项目免费软件。

那我该怎么办？你能告诉我如何让我假设的项目保持开源，而不会使其不安全吗？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T18:36:19.613

不可能 - 如果您提供源代码，那么您也提供了协议的实现。你无法保护大门敞开的东西。相反，您专注于保护对服务器端内容的访问。

例如，您试图让人们不知道您的应用程序说英语，而您应该专注于通过他们的 ID 徽章过滤说英语的人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T18:41:54.320

您可以使用加密而不在开源中包含客户端密钥。但是，由于您必须将其包含在客户端中，因此很容易被黑客入侵。总是有可能破解您的服务器，但在许多情况下，您可以在服务器中保持控制和验证。例如，服务器可以跟踪您携带的多少金币，客户端可以告诉服务器为 X 枚金币购买新工具。服务器可以轻松验证交易并保留库存。移动也是如此：服务器知道客户端在哪里以及他们可以去哪里。尽管如此，这并不能阻止机器人。

# smartcard - 来自智能卡读卡器的 Reader MaxIFSD 属性

> ID：12806254
> 
> 赞同：1
> 
> 时间：2012-10-09T18:34:24.227
> 
> 标签：smartcard, apdu, winscard, ifd

我正在尝试找到一种在不存在卡时从读卡器读取 IFD（接口设备 - 序列号）属性的方法。SCard API 似乎有这样的要求，即所有属性只能通过卡句柄读取。虽然这对于卡片属性来说似乎很明显，但读取阅读器属性似乎是一个不好的要求。

我正在研究的一种方法是直接向阅读器驱动程序发送 TLV 命令；这应该可行，但问题是我需要弄清楚驱动程序为其 FDO 公开的名称。

甚至我下载并测试过的许多智能卡实用程序也要求存在卡。然而，一个实用程序 (PCSCDiag.exe) 能够获得我所追求的一个值，即使该卡不存在也是如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T08:38:46.673

您可以通过将 SCARD_SHARE_DIRECT 传递给 SCardConnect 来获取句柄（注意可能的可移植性问题！）。查看 OpenSC 中的 src/libopensc/reader-pcsc.c 以[从](https://github.com/OpenSC/OpenSC/blob/master/src/libopensc/reader-pcsc.c#L1060)阅读器（驱动程序）读取阅读器参数（如果可用，仅使用标准参数）。

# c# - 如何让 Windows 7 尊重 FixedSingle FormBorderStyle？

> ID：12806256
> 
> 赞同：0
> 
> 时间：2012-10-09T18:34:39.287
> 
> 标签：c#, winforms, windows-7, resize, formborderstyle

为了防止用户调整表单大小，我将其 FormBorderStyle 设置为 FixedSingle，如下所示：

[禁用 Windows 窗体的大小调整](https://stackoverflow.com/questions/7970262/disable-resizing-of-a-windows-form)

这适用于 XP，但在 Windows 7 上则不行。必须做些什么才能让它在 Windows 7 上也能正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:38:55.670

您可以在表单上将 MinimumSize 设置为等于 MaximumSize。

# r - 如何在没有数据的类别上强制执行 ggplot 的 position_dodge？

> ID：12806260
> 
> 赞同：21
> 
> 时间：2012-10-09T18:34:51.220
> 
> 标签：r, ggplot2

我正在尝试在 ggplot 上使用 position_dodge 来获取共享相同类别（cat）的两个不同信号（ind）的箱线图。当有一个类别包含一个信号的数据但另一个信号没有数据时，包含数据的信号的箱线图覆盖所有水平间距，并且不遵守该特定类别的 position_dodge 指令。有没有办法让 ggplot 强制执行躲闪规则？正如您在下面的示例中看到的，信号 x 没有 B 类数据，因此它失去了 position_dodge 保留的空间。我想避免这种情况。

提前致谢。

```
data<-data.frame(cat=c('A','A','A','A','B','B','A','A','A','A','B','B'), 
                 values=c(3,2,1,4,NA,NA,4,5,6,7,8,9), 
                 ind=c('x','x','x','x','x','x','y','y','y','y','y','y'))

print(ggplot() +
        scale_colour_hue(guide='none') +
      geom_boxplot(
           aes(x=as.factor(cat), y=values, 
               fill=ind), 
           position=position_dodge(width=.60), 
           data=data,
           outlier.size = 1.2,
           na.rm=T)) 
```

![有原始问题的图](../Images/d288be7d37e42d36ff36a65006b52c0d.png)

# 进度更新

经过一些解决方法后，我想出了我正在寻找的结果......（有点）

```
data            <- data.frame(
cat=c('A','A','A','A','B','B','A','A','A','A','B','B','B'), 
values=c(3,2,1,4,NA,NA,4,5,6,7,8,9, 0), 
ind=c('x','x','x','x','x','x','y','y','y','y','y','y','x'))

p  <- ggplot() +
      scale_colour_hue(guide='none') +
      geom_boxplot(aes(x=as.factor(cat), y=values, fill=ind),
      position=position_dodge(width=.60), 
      data=data,
      outlier.size = 1.2,
      na.rm=T) +
      geom_line(aes(x=x, y=y), 
                data=data.frame(x=c(0,3),y=rep(0,2)), 
                size = 1, 
                col='white')
print(p) 
```

![解决方法](../Images/2cb5e4042d83b9af2087dd8c07b2c10e.png)

有些人建议使用刻面来获得我想要的效果。刻面并没有给我想要的效果。我正在寻找的最终图表如下所示：

![最终图](../Images/6e14012c3e4279ba229ff997e29176f8.png)

如果您注意到，y = 10 处的白色主刻度线比其他刻度线厚。这条较粗的线是 size=1 的 geom_line，它隐藏了不需要的箱线图。

我希望我们可以更无缝地组合不同的几何对象。我在 Hadley 的 github 上将此报告为一个错误，但 Hadley 说这是 position_dodge 的设计行为。我想我正在以非标准方式使用 ggplot2，解决方法是解决这类问题的方法。无论如何，我希望这有助于一些 R 人进一步推动 ggplot 强大的功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T13:43:00.427

经过一些解决方法后，我想出了我正在寻找的结果......（有点）

```
data            <- data.frame(
cat=c('A','A','A','A','B','B','A','A','A','A','B','B','B'), 
values=c(3,2,1,4,NA,NA,4,5,6,7,8,9, 0), 
ind=c('x','x','x','x','x','x','y','y','y','y','y','y','x'))

p  <- ggplot() +
      scale_colour_hue(guide='none') +
      geom_boxplot(aes(x=as.factor(cat), y=values, fill=ind),
      position=position_dodge(width=.60), 
      data=data,
      outlier.size = 1.2,
      na.rm=T) +
      geom_line(aes(x=x, y=y), 
                data=data.frame(x=c(0,3),y=rep(0,2)), 
                size = 1, 
                col='white')
print(p) 
```

![解决方法](../Images/2cb5e4042d83b9af2087dd8c07b2c10e.png)

有些人建议使用刻面来获得我想要的效果。刻面并没有给我想要的效果。我正在寻找的最终图表如下所示：

![最终图](../Images/6e14012c3e4279ba229ff997e29176f8.png)

如果您注意到，y = 10 处的白色主刻度线比其他刻度线厚。这条较粗的线是 size=1 的 geom_line，它隐藏了不需要的箱线图。

我希望我们可以更无缝地组合不同的几何对象。我在 Hadley 的 github 上将此报告为一个错误，但 Hadley 说这是 position_dodge 的设计行为。我想我正在以非标准方式使用 ggplot2，解决方法是解决这类问题的方法。无论如何，我希望这有助于一些 R 人进一步推动 ggplot 强大的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T06:02:05.277

B 的 x 没有值，因此您可以添加“B”、0、“x”，这基本上表明 B 的 x 没有“值”分布。中位数和其他百分位数为零。

```
 data<-data.frame(cat=c('A','A','A','A','B','B','A','A','A','A','B','B','B'), 
             values=c(3,2,1,4,NA,NA,4,5,6,7,8,9,0), 
             ind=c('x','x','x','x','x','x','y','y','y','y','y','y','x')) 
```

此外，您不必在此处添加位置参数，因为当您将 x 视为一个因素时， ggplot -- geom_boxplot 将自动闪避到两侧。

```
print(ggplot() +
  scale_colour_hue(guide='none') +
  geom_boxplot(aes(x=as.factor(cat), y=values, fill=ind), 
  data=data,
  outlier.size = 1.2,
  na.rm=T)) 
```

![](../Images/67150cbc1b039bcde4b323a92e9ff4e8.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-12T23:50:28.353

我刚刚从 Hadley 在他的 git[站点上](https://github.com/hadley/ggplot2/issues/688)发布的评论中获得了使用 faceting 的线索，因此归功于 ggplot2 包的维护者 Hadley！

看看这是不是你想要的。要了解有关在此图中设置胡须和其他选项的更多信息，请查看 ggplot2 包中的此帮助页面：

```
?stat_boxplot

data<-data.frame(cat=c('A','A','A','A','B','B','A','A','A','A','B','B'), 
             values=c(3,2,1,4,NA,NA,4,5,6,7,8,9), 
             ind=c('x','x','x','x','x','x','y','y','y','y','y','y'))

p <- ggplot(data = data, aes(factor(cat), values))                     
p + stat_boxplot(geom="boxplot", position = "dodge", width = 0.60, na.rm = TRUE) +  facet_grid(.~ind) 
```

![在此处输入图像描述](../Images/601459a8b4af22cb3d6a8f4ed87f69e1.png)

要为您的情节添加颜色，在我看来这是多余的，因为您已经根据“ind”变量来处理情节，试试这个：

```
p <- ggplot(data, aes(factor(cat), values, fill = ind))                     
p + stat_boxplot(geom="boxplot", position = "dodge", width = 0.60, na.rm = TRUE) + facet_grid(.~ind) 
```

![在此处输入图像描述](../Images/eae61bbfd481df7572492f2ad8a17883.png)

！

# vb.net - 使用 ParamArray，但至少需要一个参数

> ID：12806267
> 
> 赞同：5
> 
> 时间：2012-10-09T18:35:26.177
> 
> 标签：vb.net, parameters, paramarray

我曾经拥有的：

```
Public Sub Subscribe(channel As ChannelType)
Public Sub Subscribe(channels As IEnumerable(Of ChannelType)) 
```

第一个只是调用第二个`{channel}`将其参数转换为数组。

我认为必须创建一个通道列表以传递给该方法很尴尬，并选择将两个重载组合成一个方法，该方法采用`ParamArray`.

```
Public Sub Subscribe(ParamArray channels() As ChannelType)

'Usage
Subscribe(ChannelType.News)
Subscribe(ChannelType.News, ChannelType.Sports)
Subscribe() 'Oops... this is valid 
```

这里的“最佳实践”是什么？我喜欢`ParamArray`让人们传递东西的灵活性，但它无法通过编译器错误反馈帮助开发人员“更快地失败”......这意味着像 an 这样的东西`ArgumentException`在这里是不可能的，因为人们消费它方法可能不会编写任何单元测试。一种选择如下...

```
Public Sub Subscribe(channel As ChannelType)
Public Sub Subscribe(channel As ChannelType, ParamArray channels() As ChannelType) 
```

但我觉得这让我几乎回到了原点，令人困惑，并且要求我对该方法的实施不那么直截了当。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-09T23:17:40.080

另一个要考虑的选择是

```
Module ParamArrayTest
    Sub ShowThings(ParamArray MyThings() As Integer)
        For Each thing As Integer In MyThings
            Debug.Print("{0}", thing)
        Next
    End Sub

    ' Don't try to call without parameters:
    <Obsolete("Must have at least one parameter", True)> Sub ShowThings()
        Throw New ArgumentException("Must specify at least one parameter")
    End Sub

    Sub Test()
        ShowThings(3, 4, 5)
        ShowThings()
    End Sub
End Module 
```

`<Obsolete()>`带有第二个参数的标记通知`True`编译器尝试使用标记的方法会导致编译错误。由于所讨论的方法将在并且仅当尝试在没有任何参数的情况下调用该方法时才使用，因此仅在这种情况下才会导致错误。请注意，如果尝试向方法传递 ; 的零元素数组，则不会使用方法`Integer`。在这种情况下，`ParamArray`将使用标准形式。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-09T18:41:21.827

我认为你提到的选项是最好的选择。为参数使用更清晰的名称将减少混乱：

```
Public Sub Subscribe(mainChannel As ChannelType, ParamArray otherChannels() As ChannelType) 
```

另一种选择是在运行时强制执行它，但正如您所说，它不会很快失败：

```
Public Sub Subscribe(ParamArray channels() As ChannelType)
    If channels.Count = 0 then
        Throw new InvalidOperationException("At least one channel is needed")
    End If
End Sub 
```

# r - 在矩阵列范围内的随机点创建 1

> ID：12806272
> 
> 赞同：1
> 
> 时间：2012-10-09T18:35:50.630
> 
> 标签：r

给定以下数据格式，如果 D1 是 R 中的矩阵，我将如何每天在 0630 和 1030（含）时间之间用单个随机 1 填充列 X2？每天只有一个 1，那个 1 随机出现。实际数据要长得多，可能是 1000 天或更长时间，所以我最终会得到 1000 个 1 都放在 0630 和 1030 之间。

请注意，虽然这是 5 分钟的数据，但我想找到一个也适用于其他时间段的解决方案。（15 分钟、1 分钟等）如有必要，这可能是第二步。

```
D1 <- structure(c(1110920, 1110920, 1110920, 1110920, 1110920, 1110920, 
1110920, 1110920, 1110920, 1110920, 1110920, 1110920, 1110920, 
1110920, 1110920, 1110920, 1110920, 1110920, 1110920, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 1110921, 
1110921, 1110921, 1110921, 1110921, 1110921, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 1110922, 
1110922, 1110922, 1110922, 1110922, 2225, 2230, 2235, 2240, 2245, 
2250, 2255, 2300, 2305, 2310, 2315, 2320, 2325, 2330, 2335, 2340, 
2345, 2350, 2355, 0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 
100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 200, 
205, 210, 215, 220, 225, 230, 235, 240, 245, 250, 255, 300, 305, 
310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 400, 405, 410, 
415, 420, 425, 430, 435, 440, 445, 450, 455, 500, 505, 510, 515, 
520, 525, 530, 535, 540, 545, 550, 555, 600, 605, 610, 615, 620, 
625, 630, 635, 640, 645, 650, 655, 700, 705, 710, 715, 720, 725, 
730, 735, 740, 745, 750, 755, 800, 805, 810, 815, 820, 825, 830, 
835, 840, 845, 850, 855, 900, 905, 910, 915, 920, 925, 930, 935, 
940, 945, 950, 955, 1000, 1005, 1010, 1015, 1020, 1025, 1030, 
1035, 1040, 1045, 1050, 1055, 1100, 1105, 1110, 1115, 1120, 1125, 
1130, 1135, 1140, 1145, 1150, 1155, 1200, 1205, 1210, 1215, 1220, 
1225, 1230, 1235, 1240, 1245, 1250, 1255, 1300, 1305, 1310, 1315, 
1335, 1340, 1345, 1350, 1355, 1400, 1405, 1410, 1415, 1420, 1425, 
1430, 1505, 1510, 1515, 1520, 1525, 1530, 1535, 1540, 1545, 1550, 
1555, 1600, 1605, 1610, 1615, 1620, 1625, 1630, 1635, 1640, 1645, 
1650, 1655, 1700, 1705, 1710, 1715, 1720, 1725, 1730, 1735, 1740, 
1745, 1750, 1755, 1800, 1805, 1810, 1815, 1820, 1825, 1830, 1835, 
1840, 1845, 1850, 1855, 1900, 1905, 1910, 1915, 1920, 1925, 1930, 
1935, 1940, 1945, 1950, 1955, 2000, 2005, 2010, 2015, 2020, 2025, 
2030, 2035, 2040, 2045, 2050, 2055, 2100, 2105, 2110, 2115, 2120, 
2125, 2130, 2135, 2140, 2145, 2150, 2155, 2200, 2205, 2210, 2215, 
2220, 2225, 2230, 2235, 2240, 2245, 2250, 2255, 2300, 2305, 2310, 
2315, 2320, 2325, 2330, 2335, 2340, 2345, 2350, 2355, 0, 5, 10, 
15, 20, 25, 30, 35, 40, 45, 50, 55, 100, 105, 110, 115, 120, 
125, 130, 135, 140, 145, 150, 155, 200, 205, 210, 215, 220, 225, 
230, 235, 240, 245, 250, 255, 300, 305, 310, 315, 320, 325, 330, 
335, 340, 345, 350, 355, 400, 405, 410, 415, 420, 425, 430, 435, 
440, 445, 450, 455, 500, 505, 510, 515, 520, 525, 530, 535, 540, 
545, 550, 555, 600, 605, 610, 615, 620, 625, 630, 635, 640, 645, 
650, 655, 700, 705, 710, 715, 720, 725, 730, 735, 740, 745, 750, 
755, 800, 805, 810, 815, 820, 825, 830, 835, 840, 845, 850, 855, 
900, 905, 910, 915, 920, 925, 930, 935, 940, 945, 950, 955, 1000, 
1005, 1010, 1015, 1020, 1025, 1030, 1035, 1040, 1045, 1050, 1055, 
1100, 1105, 1110, 1115, 1120, 1125, 1130, 1135, 1140, 1145, 1150, 
1155, 1200, 1205, 1210, 1215, 1220, 1225, 1230, 1235, 1240, 1245, 
1250, 1255, 1300, 1305, 1310, 1315, 1335, 1340, 1345, 1350, 1355, 
1400, 1405, 1410, 1415, 1420, 1425, 1430, 1435, 1505, 1510, 1515, 
1520, 1525, 1530, 1535, 1540, 1545, 1550, 1555, 1600, 1605, 1610, 
1615, 1620, 1625, 1630, 1635, 1640, 1645, 1650, 1655, 1700, 1705, 
1710, 1715, 1720, 1725, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0), .Dim = c(500L, 3L), .Dimnames = list(NULL, c("Date", 
"Time", "X2"))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:57:05.613

```
library("plyr")
resample <- function(x, ...) x[sample.int(length(x), ...)] # from `sample` documentation
D2 <- as.matrix(ddply(as.data.frame(D1), .(Date), function(DF) {
  intime <- which(DF$Time >= 630 & DF$Time <= 1030)
  if (length(intime) > 0) {
    DF[resample(intime,1),"X2"] <- 1
  }
  DF
})) 
```

这会将矩阵转换为 data.frame，使用`ddply`from`plyr`来查看一天中的一天，然后匿名函数找到属于您给定时间范围内的条目的索引，随机选择一个（使用`sample`via `resample`）并为其分配 1。整个事情又变成了一个矩阵（因为它就是这样开始的）。

与其显示整个输出，不如`D2`看看与`D1`

```
> which(D2 != D1, arr.ind = TRUE)
     row col
[1,] 117   3
[2,] 405   3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:58:54.897

我更改了 D1 对象。

```
D1 [ , "X2"] <-  ave(D1[, "Time"] , D1[ , "Date"], 
         FUN= function(x){ x[sample( length(x), 1)] <- 1; return (x) } )
 unique(D1[ , "Date"])
#[1] 1110920 1110921 1110922
 which(D1 == 1, arr.ind = TRUE)
# ----
     row col
[1,]  11   3
[2,]  51   3
[3,] 419   3 
```

这通过将每日“时间”发送到函数`sample`，然后从这些“时间”的长度返回单个伪随机行值来工作。在`ave`函数中，该值用作设置单个随机 1 的索引。`ave`返回与 d["X2"] 长度相同的向量

# python - Django 在模板中获取 ContentType

> ID：12806276
> 
> 赞同：9
> 
> 时间：2012-10-09T18:36:11.093
> 
> 标签：python, django, django-templates, django-contenttypes

我有一个页面，其中包含许多具有不同内容类型的对象。我需要有能力评价这些对象。这是它的一个类：

```
class Score(models.Model):
    user            = models.ForeignKey(User)

    content_type    = models.ForeignKey(ContentType)
    object_id       = models.PositiveIntegerField()
    for_object      = generic.GenericForeignKey('content_type', 'object_id')

    like            = models.BooleanField(default=True)
    created_at      = models.DateTimeField(auto_now_add=True, blank=True, null=True)

    comment         = models.CharField(max_length=255, blank=True, null=True)

    objects = ChainerManager(ScoreQuerySet)

    def __unicode__(self):
        return u'Score for (%s, #%s) from user %s at %s' %\
            (self.content_type, self.object_id, self.user.get_full_name(), self.created_at)

    class Meta:
        unique_together = (('user', 'content_type', 'object_id'),) 
```

我的模板应该是这样的：

```
...
{% for random_object in random_object_queryset %}
<a href={% url like_object random_object.<content_type> random_object.id %}>{{ random_object.name }}</a>
<a href={% url dislike_object random_object.<content_type> random_object.id %}>{{ random_object.name }}</a>
{% endfor %}
... 
```

我可以制作模板标签来获取它，或者获取一个类名，即使用这个片段：[http](http://djangosnippets.org/snippets/294/) : //djangosnippets.org/snippets/294/ 我可以重写这个片段来获取对象的 content_type_id，但我害怕一点关于数据库中的大量 CT 查找。

但是是否有一些嵌入式方法可以在模板中获取对象的 CT？

**视图代码：**

```
def rate_object(request, classname, object_id, like=True):
    user = request.user
    Klass = ContentType.objects.get(model=classname).model_class()
    obj = get_object_or_404(Klass, user=user, pk=object_id)

    try:
        score = Score.objects.for_object(user, obj)
        score.like = like
        score.save()
    except Score.DoesNotExist:
        score = Score.objects.like(user, obj) if like else Score.objects.dislike(user, obj)

    return HttpResponse(obj) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-12-31T08:27:19.617

为了建立@Colleen 的答案，我最终使用了这样的模板过滤器：

```
from django import template
from django.contrib.contenttypes.models import ContentType

register = template.Library()

@register.filter
def content_type(obj):
    if not obj:
        return False
    return ContentType.objects.get_for_model(obj) 
```

并在这样的模板中使用它：

```
{% load helpers %}
{% with instance|content_type as ctype %}
    <input type="hidden" name="content_type" value="{{ ctype.pk }}">
{% endwith %} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-21T11:18:54.867

我更喜欢使用[分配标签](https://docs.djangoproject.com/en/1.4/howto/custom-template-tags/#assignment-tags)（Django 1.4 中的新功能）：

```
@register.assignment_tag
def content_type(obj):
    if not obj:
        return False
    return ContentType.objects.get_for_model(obj) 
```

并用作

```
{% content_type object as object_ct %} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-09T19:54:15.860

我还遇到过需要模板中的内容类型的情况，而我发现获得它的唯一方法是通过自定义模板标签。

但是，在您的情况下，由于您将 content_type 显式存储为外键，因此我不会担心。`prefetch_related()`当您在视图中获取乐谱对象时可以使用最坏的情况。我不知道如果你要求一个foreignkey.id，Django是否足够聪明，可以在现场停下来，这是唯一的事情。

# java - Android：ImageView 和 SD 卡

> ID：12806277
> 
> 赞同：0
> 
> 时间：2012-10-09T18:36:14.743
> 
> 标签：java, android

我正在尝试将 /mnt/sdcard/img.jpg 中的图像读入 ImageView。

```
Bitmap bm = BitmapFactory.decodeFile("/mnt/sdcard/img.jpg");     
imageView1.setImageBitmap(bm); 
```

我有写外部存储权限。

但是 ImageView 是空的，LogCat 没有任何错误，

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:51:22.307

尝试

```
File file = new File("/mnt/sdcard/img.jpg");
Bitmap bitmap = BitmapFactory.decodeFile(file.getAbsolutePath());
imageview1.setImageBitmap(bitmap); 
```

# java - Java中的双十进制格式

> ID：12806278
> 
> 赞同：129
> 
> 时间：2012-10-09T18:36:15.087
> 
> 标签：java, formatting, double, decimal

我在格式化双精度的小数时遇到了一些问题。如果我有一个双精度值，例如 4.0，我如何格式化小数，使其改为 4.00？

* * *

## 回答 #1

> 赞同：237
> 
> 时间：2012-10-09T18:38:18.743

一种方法是使用[NumberFormat](http://docs.oracle.com/javase/tutorial/i18n/format/decimalFormat.html)。

```
NumberFormat formatter = new DecimalFormat("#0.00");     
System.out.println(formatter.format(4.0)); 
```

输出：

**4.00**

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2012-10-09T18:38:01.813

使用 Java 8，您可以使用`format`方法..：-

```
System.out.format("%.2f", 4.0); // OR

System.out.printf("%.2f", 4.0); 
```

*   `f`用于`floating`点值..
*   `2`小数点后表示，小数点后的位数`.`

对于大多数 Java 版本，您可以使用`DecimalFormat`：-

```
 DecimalFormat formatter = new DecimalFormat("#0.00");
    double d = 4.0;
    System.out.println(formatter.format(d)); 
```

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2012-10-09T18:37:36.150

使用[String.format](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#format%28java.lang.String,%20java.lang.Object...%29)：

`String.format("%.2f", 4.52135);`

根据文档：

> 始终使用的语言环境是由`Locale.getDefault()`.

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2016-03-18T22:09:41.867

使用 String.format，您可以这样做：

```
double price = 52000;
String.format("$%,.2f", price); 
```

请注意使这与@Vincent 的答案不同的逗号

输出：

`$52,000.00`

一个很好的格式化资源是关于这个主题的[官方](https://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html)java 页面

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-10-09T18:42:19.610

您始终可以使用静态方法`printf from System.out`- 然后您将实现相应的格式化程序；这节省了其他示例需要您执行的堆空间。

前任：

```
System.out.format("%.4f %n", 4.0); 

System.out.printf("%.2f %n", 4.0); 
```

节省了堆空间，这是一个很大的好处，但我认为这个例子比任何其他答案都更易于管理，特别是因为大多数程序员都知道 C 中的 printf 函数（尽管 Java 稍微改变了函数/方法）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-10-09T19:00:26.890

```
double d = 4.0;
DecimalFormat nf = DecimalFormat.getInstance(Locale.ENGLISH);
System.out.println(nf.format("#.##")); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-10-09T18:39:34.640

```
new DecimalFormat("#0.00").format(4.0d); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-11-01T08:42:21.730

另一种方法是使用类中的`setMinimumFractionDigits`方法`NumberFormat`。

在这里，您基本上可以指定要在小数点后出现多少个数字。

因此，假设您指定的数量为 2，则输入`4.0`将产生。`4.00`

但是，如果您的`Double`输入包含超过指定的数量，它将采用指定的最小数量，然后再加一位向上/向下舍入的数字

例如，`4.15465454`指定的最小数量为 2 将产生`4.155`

```
NumberFormat nf = NumberFormat.getInstance();
nf.setMinimumFractionDigits(2);
Double myVal = 4.15465454;
System.out.println(nf.format(myVal)); 
```

[在线尝试](https://ideone.com/jJ9XGu)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-04-07T04:50:20.290

有很多方法可以做到这一点。这些在下面给出：

假设您的原始号码如下所示：

```
 double number = 2354548.235; 
```

**使用数字格式：**

```
NumberFormat formatter = new DecimalFormat("#0.00");
    System.out.println(formatter.format(number)); 
```

**使用字符串格式：**

```
System.out.println(String.format("%,.2f", number)); 
```

**使用 DecimalFormat 和模式：**

```
NumberFormat nf = DecimalFormat.getInstance(Locale.ENGLISH);
        DecimalFormat decimalFormatter = (DecimalFormat) nf;
        decimalFormatter.applyPattern("#,###,###.##");
        String fString = decimalFormatter.format(number);
        System.out.println(fString); 
```

**使用 DecimalFormat 和模式**

```
DecimalFormat decimalFormat = new DecimalFormat("############.##");
        BigDecimal formattedOutput = new BigDecimal(decimalFormat.format(number));
        System.out.println(formattedOutput); 
```

在所有情况下，**输出**都是： **2354548.23**

**注意**：

在舍入期间，您可以添加`RoundingMode`格式化程序。下面是一些舍入模式：

```
 decimalFormat.setRoundingMode(RoundingMode.CEILING);
    decimalFormat.setRoundingMode(RoundingMode.FLOOR);
    decimalFormat.setRoundingMode(RoundingMode.HALF_DOWN);
    decimalFormat.setRoundingMode(RoundingMode.HALF_UP);
    decimalFormat.setRoundingMode(RoundingMode.UP); 
```

**这里是进口**：

```
import java.math.BigDecimal;
import java.math.RoundingMode;
import java.text.DecimalFormat;
import java.text.NumberFormat;
import java.util.Locale; 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-08-15T14:44:40.323

您可以使用以下任何一种方法

1.  如果您正在使用`java.text.DecimalFormat`

    ```
    DecimalFormat decimalFormat = NumberFormat.getCurrencyInstance(); 
    decimalFormat.setMinimumFractionDigits(2); 
    System.out.println(decimalFormat.format(4.0)); 
    ```

    或者

    ```
    DecimalFormat decimalFormat =  new DecimalFormat("#0.00"); 
    System.out.println(decimalFormat.format(4.0)); 
    ```

2.  如果要将其转换为简单的字符串格式

    ```
    System.out.println(String.format("%.2f", 4.0)); 
    ```

以上所有代码将打印**4.00**

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-06-03T12:30:16.913

工作 100%。

```
import java.text.DecimalFormat;

public class Formatting {

    public static void main(String[] args) {
        double value = 22.2323242434342;
        // or  value = Math.round(value*100) / 100.0;

        System.out.println("this is before formatting: "+value);
        DecimalFormat df = new DecimalFormat("####0.00");

        System.out.println("Value: " + df.format(value));
    }

} 
```

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2015-10-27T22:59:23.017

首先导入`NumberFormat`. 然后添加这个：

```
NumberFormat currencyFormatter = NumberFormat.getCurrencyInstance(); 
```

如果涉及货币，这将为您提供两位小数并加上美元符号。

```
import java.text.NumberFormat;
public class Payroll 
{
    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) 
    {
    int hoursWorked = 80;
    double hourlyPay = 15.52;

    double grossPay = hoursWorked * hourlyPay;
    NumberFormat currencyFormatter = NumberFormat.getCurrencyInstance();

    System.out.println("Your gross pay is " + currencyFormatter.format(grossPay));
    }

} 
```

* * *

## 回答 #13

> 赞同：-4
> 
> 时间：2012-10-09T18:39:29.503

你可以这样做：

```
double d = 4.0;
DecimalFormat df = new DecimalFormat("#.##");
System.out.print(df.format(d)); 
```

* * *

## 回答 #14

> 赞同：-4
> 
> 时间：2015-12-02T19:43:10.733

我知道这是一个老话题，但如果你真的喜欢用句号而不是逗号，只需将你的结果保存为 X,00 到一个字符串中，然后只需将它更改一个句点，这样你就可以得到 X.00

最简单的方法就是使用替换。

```
String var = "X,00";
String newVar = var.replace(",","."); 
```

输出将是您想要的**X.00**。另外，为了方便起见，您可以一次完成所有操作并将其保存到双变量中：

```
Double var = Double.parseDouble(("X,00").replace(",","."); 
```

我知道这个回复现在没有用，但也许检查这个论坛的人会寻找这样的快速解决方案。

# javascript - 单击显示 div，图像

> ID：12806280
> 
> 赞同：0
> 
> 时间：2012-10-09T18:36:20.983
> 
> 标签：javascript, jquery, show-hide, getelementbyid

当我单击一个框时，我制作了这段代码来显示一个 div：

JS

```
<script type="text/javascript">
var bool = 0;
function showDiv() {
    if (bool == 1) {
        bool = 0;
        document.getElementById('show').style.visibility = "hidden";
    } else if (bool == 0) {
        bool = 1;
        document.getElementById('show').style.visibility = "visible";
    }
}​
</script> 
```

HTML

```
<input type="button" value="click" onclick="showDiv();" />

<div id="show" style=" visibility:hidden;">
  <p>it is okay it is okay it is okay it is okay it is okay</p>
</div> 
```

但是，当我想要单击以显示 div 的图像时，我该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:39:47.300

当你标记你的问题 jquery 时，我建议使用`.toggle`方法来代替..

```
$('#yourimageid').click(function() {
   $('#targetelementid').toggle();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:47:24.943

使用 jQuery，您可以将代码简化为：

```
$('input,img').click(function() {
    $('#show').css('visibility', ($('#show').css('visibility') == 'visible') ? 'hidden' : 'visible');
});​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/tNEXr/1/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T18:39:16.783

做

```
$('#imageId').click(showDiv); 
```

将`showDiv`函数绑定到`click`id 为 imageId 的元素上的事件。

参考：[http ://api.jquery.com/click/](http://api.jquery.com/click/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T18:40:09.283

最简单的方法（鉴于您已经拥有的）：

```
<img src="myimage.jpg" onclick="showDiv();"/> 
```

但是，如果您实际上使用的是 jQuery，那么您可以使用 .toggle 方法，这意味着您不必费心维护您的`bool`变量（这实际上应该是一个布尔值！）。

使用 jQuery，您可以执行以下操作：

```
$('#imageId').click(function() {
    $('show').toggle();
}); 
```

# apache-flex - 有没有办法将密码保存到带有 Flash 网站的浏览器？

> ID：12806283
> 
> 赞同：1
> 
> 时间：2012-10-09T18:36:33.540
> 
> 标签：apache-flex, flex4

有没有办法提示浏览器在 Flex 或 Flash 应用程序上保存密码？并返回到检索该登录名的网页（与 HTML 网站的行为相同）？我对创造性的解决方案持开放态度......

~~~**更新**~~~~~~~~~~~~

我应该提到我试图避免 SharedObject 路线。这是因为 FireFox 和 Chrome 的同步功能等功能使得登录和 cookie 可以跨设备移植。我正在考虑将用户名和密码复制到 HTML 文本输入中，并在 HTML 页面加载时检查它们是否存在。你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:20:54.477

不需要“创造性”的解决方案。只需使用本地[SharedObject](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/SharedObject.html)。

写入`userData`磁盘：

```
var so:SharedObject = SharedObject.getLocal("my_user_data", "/", false);
so.data.user = userData;
so.flush(90000);
so.close(); 
```

`userData`从磁盘读取：

```
var so:SharedObject = SharedObject.getLocal("my_user_data", "/", false);
var userData:UserData;

if (so.data.hasOwnProperty('user'))
    userData = so.data.user as UserData; 
```

现在用以下内容填充 TextInputs`userData`

# ruby-on-rails - 使用 json 返回创建的 rails 项目的 id

> ID：12806292
> 
> 赞同：3
> 
> 时间：2012-10-09T18:37:28.360
> 
> 标签：ruby-on-rails, xcode, json

在 XCode (iOS) 中，我使用 JSON 访问 rails 数据库。我创建了特定的操作来从数据库中检索数据并将数据输入到数据库中。

我想在我的数据库中插入一条记录并立即返回创建对象的 id。但是我找不到将这些动作“链接”在一起的方法。

对于插入数据，我使用这样的请求：

```
 NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"http://..."]];
    [request setHTTPMethod:"@POST"];
    [request addValue:@"application/json" forHTTPHeaderField:@"content-type"];
    NSData *objectData = [NSData alloc];
    NSError *parseError = nil;
    objectData = [NSJSONSerialization dataWithJSONObject:myData options:NSJSONWritingPrettyPrinted error:&parseError];
    [request setHTTPBody:objectData]; 
```

对于数据检索，我使用以下内容：

```
 NSMutableArray *myArray = [[NSMutableArray alloc] init];

    NSData *myContent = [NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://..."]];
    NSError *parseError = nil;
    NSInputStream *myStream = nil;

    myStream = [[NSInputStream alloc] initWithData:myContent];
    [myStream open];

   myArray = [NSJSONSerialization JSONObjectWithStream:myStream options:NSJSONReadingAllowFragments error:&parseError]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T06:54:59.830

我认为在控制器 json 动作中你可以使用类似的东西

```
def json 
  #-- do your magic to fill @object --
  if @object.save
    respond_to do |format|
      format.json { render :json => {:id => @object.id} } # Return the id
      # format.json { render :json => @object } #You can return the whole object
      format.html { render :string => "#{@object.inspect}" }
    end
  else
    render :json => {:error => "OMG Failed to save the model!"} 
  end
end 
```

# javascript - 用于检查数字是否在 JavaScript 范围内的最短代码

> ID：12806304
> 
> 赞同：6
> 
> 时间：2012-10-09T18:38:24.290
> 
> 标签：javascript

这就是我检查一个数字是否在一个范围内（在其他两个数字之间）的方式：

```
var a = 10,
    b = 30,
    x = 15,
    y = 35;

x < Math.max(a,b) && x > Math.min(a,b) // -> true
y < Math.max(a,b) && y > Math.min(a,b) // -> false 
```

我必须在我的代码中做很多数学运算，我正在寻找更短的等效代码。

这是我想出的一个较短的版本。但我确信它可以变得更短：

```
a < x && x < b
true
a < y && y < b
false 
```

但缺点是我必须重复`x`或`y`

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-09T18:42:56.457

```
Number.prototype.between = function (min, max) {
    return this > min && this < max;
};

if ((5).between(4, 6)) {
    alert('worked!');
}

var num = 6;
if (num.between(5, 7)) {
    alert('still worked!');
} 
```

[http://jsfiddle.net/jbabey/4jjRm/1/](http://jsfiddle.net/jbabey/4jjRm/1/)

请注意，您需要在括号中包含数字文字，否则解释器会认为您的属性是小数点并爆炸。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T18:42:23.483

如果我必须经常这样做，我只需编写一个函数`inRange(a, b, x)`，这样在我需要的任何时候它都会是一个简短的函数调用。这样，您还可以使函数体的混淆程度稍低，而不必担心其长度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-24T14:53:25.723

如果您需要灵活地测试一个数字是否介于两个数字之间而不首先找到最小值和最大值：

```
let inRange = (num1, num2, numTest) => {
  [min, max] = [num1, num2].sort((a, b) => a > b);
  return numTest > min && numTest < max;
} 
```

从低到高测试：

```
inRange(1, 5, 3); // true
inRange(1, 5, 6); // false 
```

测试从高到低：

```
inRange(5, 1, 3); // true
inRange(5, 1, 6); // false 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-18T12:02:52.557

我从上面编辑了代码，因为它不能很好地排序。这对我来说非常有效（包括范围结束）：

```
var isNumberInRange = (num1, num2, testNum) => {
  var min, max;
  [min, max] = [num1, num2].sort((a, b) => a - b);
  return (testNum >= min && testNum <= max);
}; 
```

# c# - 为什么 Web 用户通过 NTLM 进行身份验证？

> ID：12806307
> 
> 赞同：6
> 
> 时间：2012-10-09T18:38:39.433
> 
> 标签：c#, asp.net, .net, visual-studio-2010

我正在使用表单身份验证并从 Visual Studio 2010 启动一个站点。它使用的是 Visual Studio 开发 (web) 服务器而不是 IIS。web.config 有：

```
<authenticaion mode="Forms">
  <forms name=".MyApp" protection="All" cookieless="UseCookies"/>
</authentication> 
```

登录页面使用 ASP.NET 登录控件。在用户甚至登录之前，我可以看到以下内容：

```
HttpContext.Current.Request.LogonUserIdentity.AuthenticationType == "NTLM"
HttpContext.Current.User.Identity == System.Security.Principal.GenericIdentity
HttpContext.Current.User.Identity.AuthenticationType == "NTLM" 
```

该用户似乎被认证为本地系统用户而不是 Web 用户。这是否意味着用户将始终通过身份验证，无论他们是否登录该站点？

网络用户 NTLM 怎么样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T20:25:43.270

据我所知，cassini 不支持 Windows 身份验证。

它作为本地系统帐户运行，这就是您所看到的 NTLM 身份验证。

如果您正在为 Asp.Net 应用程序（或 WCF）开发/调试安全功能，我强烈建议您部署到 IIS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T20:33:48.723

如果我没记错的话，当您使用 VS 和它的开发服务器进行调试时，您会看到`yourself`正在`User`运行 Visual Studio（在您的用户上下文中）。

Visual Studio 在您的上下文中运行（您的 Windows 用户帐户/权限等） -`Request.LogonUserIdentity.User`

它不应该影响您对 Web 表单/表单身份验证的调试。Forms Auth登录成功后，即可获得`HttpContext.User.Identity.Name`“forms auth user”（web用户）。

# git - 如何取消提交 Git 更改

> ID：12806309
> 
> 赞同：2
> 
> 时间：2012-10-09T18:38:42.203
> 
> 标签：git

我想取消提交已运行“git commit”的更改。

特别是，我想指定文件。

例子：

```
> #5 commits ago 
> commit -m "bug fix" A.java
> 
> #bunch of commits occurred
> 
> [command to uncommit] A.java 
```

**注意**我不想从我的仓库中删除 A.java。我只想将它返回到它的基本状态，即当我运行时`git clone repo`。

谢谢，凯文

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T19:20:21.917

小心变基，如果你已经推送了你的提交，你将不得不强制推送，除非你知道自己在做什么，否则可能会遇到麻烦。

用于`git revert $SHAYOUWNATOREVERT`恢复您不再需要的提交。这基本上会创建一个撤消给定提交的“反向”提交。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T18:44:37.267

您可以进行变基交互并删除提交。但是，如果以后的提交依赖于该提交，它可能不起作用。

`git rebase -i HEAD~5`

只需删除相应的行，然后保存并退出。

如果您已推送到远程，请勿这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-09T18:47:03.593

除非 A.java 包含无法在 repo 历史记录中存在的私有数据，否则您应该删除该文件，而不是尝试删除它以前的存在。

```
git rm A.java 
```

如果文件包含必须删除的敏感数据，则可以删除文件的历史记录，但它会重写 refs，需要强制推送，并且需要克隆或拉取当前 refs 的任何人的额外工作.

[https://help.github.com/articles/remove-sensitive-data](https://help.github.com/articles/remove-sensitive-data)

简而言之：

```
git filter-branch --index-filter 'git rm --cached --ignore-unmatch A.java' --prune-empty --tag-name-filter cat -- --all 
```

如果尝试从另一个存储库或分支恢复版本，请编辑以合并答案：

如果 A.java 是您已修改的文件，并且您希望将其返回到可用的原始版本，`upstream/master`那么这将替换您当前的副本：

```
git checkout upstream/master A.java 
```

# c# - 在 IE 中打印 div 的内容

> ID：12806312
> 
> 赞同：1
> 
> 时间：2012-10-09T18:38:48.563
> 
> 标签：c#, javascript, css, internet-explorer

好的，由于某种原因，我的 div 以 Firefox 和 Chrome 中的方式打印出来，但是当我转到 IE 时它不起作用。它只打印出 div 的一页，然后是页眉和页脚。我尝试添加一些新代码，看看是否可以让它更好地工作，但仍然存在问题。当前代码确实打印得很好，但没有继承它们在页面上而不是在外部样式表中的 div 样式。下面注释掉的代码是他们之前的代码。有人有帮助吗？

```
 function buildPrint() {

        var sourceDiv = document.getElementById("display_div");
        var WindowObject = window.open('', 'print_div', 'width=750,height=650,top=50,left=50,toolbars=no,scrollbars=yes,status=no,resizable=yes');
        WindowObject.document.writeln(sourceDiv.innerHTML);
        WindowObject.document.close();
        WindowObject.focus();
        WindowObject.print();
        WindowObject.close();

        //document.getElementById("print_div").innerHTML = sourceDiv.innerHTML;
        //window.print();

    }
<asp:Content ID="Content3" ContentPlaceHolderID="BodyPlaceHolder" runat="server">
<div id="display_div">
<asp:CheckBox ID="showAllOptionals" runat="server" Text="Show All Optionals" AutoPostBack="true" />
<asp:Literal ID="mainTable" runat="server" />
</div>

</asp:Content>
<asp:Content ID="Content4" ContentPlaceHolderID="PrintContent" runat="server">
<div id="print_div" style="page-break-after:avoid;">
</div>

</input><input onclick=\"buildPrint();\" id=\"printBtn\" type=\"button\" value=\"Print\"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T20:03:24.657

I got the solution, I had to add different CSS to it so the div overflowed and printed. Thanks for all the help

# ssi - 基本 SSI 不起作用

> ID：12806314
> 
> 赞同：7
> 
> 时间：2012-10-09T18:38:59.513
> 
> 标签：ssi

这让我很生气。我正在尝试让服务器端包含工作。我托管我的网站的服务器启用了 SSI，拥有服务器的公司表示我的问题与我的代码有关，而不是与他们的服务器有关。

这是我的名为 test.html 的文件

```
<!DOCTYPE html>

<html lang="en">
<head>

<meta charset="utf-8">

</head>
<body>

<!--#include file="assets/includes/top.html" -->

</body>
</html> 
```

文件 top.html 只是一堆 html，没有错。

当我调用主文件 test.shtml 它工作正常。当我称它为 test.html 时，它没有。当我用谷歌搜索时，它说这与文件解析有关。这与代码有什么关系？我该怎么做才能使其与 .html 文件扩展名一起使用。（出于 SEO 原因，我不能使用 .shtml）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-08T23:56:32.277

将以下命令添加到`.htaccess`文件中：

```
# Enable server side includes
Options +Includes 

# pass .html files to the server for parsing
AddHandler server-parsed .html 
```

**参考**

*   [万维网上的 CGI 编程](https://www.oreilly.com/openbook/cgi/ch05_02.html)

*   [服务器端包括 | 备忘单](http://www.cheat-sheets.org/sites/ssi.su/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-05-20T15:06:58.163

我遇到过同样的问题。现在我使用 xampp 并且在 VirtualHost 声明之前添加了这些行

```
<Directory />
    Options FollowSymLinks Indexes Includes
    AllowOverride All
    Order allow,deny
    Allow from All
    Satisfy any
    AddType text/html .shtml .html .htm
    AddOutputFilter INCLUDES .shtml .html .htm
    <Limit PUT>
            Order allow,deny
            Deny from all
    </Limit>
</Directory> 
```

希望这有帮助

# regex - 如何删除以某些单词开头的句子？

> ID：12806316
> 
> 赞同：3
> 
> 时间：2012-10-09T18:39:02.517
> 
> 标签：regex, plsql, oracle11g

使用 PL/SQL，我如何删除句子，除了第一次出现的以单词开头的句子`This product`？假设每个句子都以句点 ( `.`) 结尾，并且每个句子都以大写字母开头；例如：

```
 v_desc varchar2(500);
 v_desc := 'This product is used. Product may make you wealthy. This product may appear red. This product is not new.'; 
```

我的尝试：

```
 v_desc := regexp_replace(v_desc,'This product*{2,}','') ;
 v_desc := regexp_replace(v_desc,'This product*{2,}*','') ; 
```

期望的结果

```
v_desc := 'This product is used. Product may make you wealthy.'; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:03:13.613

试试这个：

```
 v_desc := regexp_replace(v_desc,'[^^](This product).*[.]', '') ; 
```

这是分解：

```
[^^] = Not the beginning of the line
(This product).*[.] = Searching for all instances of "This product" followed by a "." 
```

这将最终搜索不在行首的“此产品...”的所有实例。

*评论后编辑

那么你想要的是正面的样子`(?<=)`。它应该如下所示：

```
 v_desc := regexp_replace(v_desc,'(?<=(This product).*)(This product).*[.]', '') ; 
```

分解：

```
(?<=(This product).*) = Positive lookbehind.  
(This product).*[.] = What is being searched for 
```

如果表达式“This product ...”在它之前，它只会触发下一个值为真。这将防止“此产品”的首次出现出现在要替换的值中。

我想指出，并非所有正则表达式的植入都支持前瞻和后视。我不知道 PL/SQL 的细节，所以我不能保证这会奏效。当我在[Regex Hero](http://regexhero.net/tester/)上进行测试时，它确实有效。

# java - Spring Security 3.1 + JPA - 空指针异常

> ID：12806318
> 
> 赞同：4
> 
> 时间：2012-10-09T18:39:12.760
> 
> 标签：java, spring, spring-mvc, spring-security, nullpointerexception

我是 Spring 新手，面临 Spring Security 的问题。

我正在尝试实现自定义 UserDetailsS​​ervice 以进行用户检索并在访问 UserService 对象时获取空指针异常。我正在自动装配这个对象。在其他 Controller 和 Service 方法上完成时，自动装配工作正常，但由于某种原因，它在这里不起作用，因此当访问自动装配对象（UserService）时，我得到空指针异常。

我真的很感激这方面的帮助。

异常堆栈跟踪：

```
java.lang.NullPointerException
java.lang.NullPointerException
at com.contact.list.service.CustomUserDetailsService.loadUserByUsername(CustomUserDetailsService.java:37)
at org.springframework.security.authentication.dao.DaoAuthenticationProvider.retrieveUser(DaoAuthenticationProvider.java:81)
at org.springframework.security.authentication.dao.AbstractUserDetailsAuthenticationProvider.authenticate(AbstractUserDetailsAuthenticationProvider.java:132)
at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:156)
at org.springframework.security.authentication.ProviderManager.authenticate(ProviderManager.java:174)
at org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter.attemptAuthentication(UsernamePasswordAuthenticationFilter.java:94)
at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:194)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:173)
at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at com.springsource.insight.collection.tcserver.request.HttpRequestOperationCollectionValve.invoke(HttpRequestOperationCollectionValve.java:88)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
at java.lang.Thread.run(Thread.java:722) 
```

CustomUserDetailsS​​ervice 类：

```
 package com.contact.list.service;

import java.util.ArrayList;
import java.util.Collection;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Configurable;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;
import org.springframework.context.support.GenericXmlApplicationContext;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.User;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.stereotype.Repository;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import com.contact.list.form.Role;
import com.contact.list.repository.UserRepository;

@Service
@Transactional(readOnly = true)
public class CustomUserDetailsService implements UserDetailsService {

@Autowired
private UserService userService;

public UserDetails loadUserByUsername(String username)
        throws UsernameNotFoundException {

    try{
        com.contact.list.form.User domainuser =     userService.findByUsername(username);

        boolean enabled = true;
        boolean accountNonExpired = true;
        boolean credentialsNonExpired = true;
        boolean accountNonLocked = true;

        return new User(domainuser.getUsername(),
                        domainuser.getPassword().toLowerCase(),
                        enabled,accountNonExpired,
                        credentialsNonExpired,
                        accountNonLocked,
                        getAuthorities(domainuser.getRoles())
                );

    }catch (Exception e){
        System.out.println(e);
        e.printStackTrace();
        throw new RuntimeException(e);
    }

}

public Collection<? extends GrantedAuthority> getAuthorities(List<Role> roles){

    List<GrantedAuthority> authList = getGrantedAuthorities(getroles(roles));
    return authList;
}

public static List<GrantedAuthority> getGrantedAuthorities(List<String> userroles){

    List<GrantedAuthority> authorities  = new ArrayList<GrantedAuthority>();
    for(String userrole:userroles){
        authorities.add(new SimpleGrantedAuthority(userrole));
    }
    return authorities;
}

public List<String> getroles(List<Role> roles){

    List<String> userroles = new ArrayList<String>();

    for (Role role : roles){

     if(role.getRole() == 1){
         userroles.add("ROLE_USER");
     }
     if(role.getRole() == 2){
         userroles.add("ROLE_ADMIN");
     }

    }

    return userroles;
}

} 
```

用户服务接口：

```
 package com.contact.list.service;

import java.util.List;

import com.contact.list.form.Contact;
import com.contact.list.form.User;

public interface UserService {

public List<User> findAll();

public void save(User user);

public User findByUsername(String username);
} 
```

用户服务实现类：

```
 package com.contact.list.service;

    import java.util.List;

    import org.springframework.beans.factory.annotation.Autowired;
    import org.springframework.stereotype.Repository;
    import org.springframework.stereotype.Service;
    import org.springframework.transaction.annotation.Transactional;

    import com.contact.list.form.Contact;
    import com.contact.list.form.User;
    import com.contact.list.repository.UserRepository;
    import com.google.common.collect.Lists;

    @Service
    @Repository
    @Transactional
    public class UserServiceImpl implements UserService {

@Autowired
private UserRepository userrepository;

public void save(User user) {

    userrepository.save(user);
}

@Transactional(readOnly=true)
public List<User> findAll() {
    return Lists.newArrayList(userrepository.findAll());
}

public User findByUsername(String username){

    return userrepository.findByUsername(username);

}

    } 
```

用户存储库：

```
 package com.contact.list.repository;

import org.springframework.data.repository.CrudRepository;

import com.contact.list.form.User;

public interface UserRepository extends CrudRepository<User, Long> {

User findByUsername(String username);

} 
```

用户等级：

```
 package com.contact.list.form;

import java.util.ArrayList;
import java.util.List;

import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.OneToMany;
import javax.persistence.Table;

@Entity
@Table(name = "USER_TBL")
public class User {

@Column(name = "FIRST_NAME")
private String firstName;

@Column(name = "LAST_NAME")
private String lastName;

@Column(name = "EMAIL")
private String email;

@Id
@Column(name = "USERID")
private String username;

@Column(name = "PASSWORD")
private String password;

@OneToMany(mappedBy = "user", cascade = CascadeType.ALL)
private List<Role> roles = new ArrayList<Role>();

public String getFirstName() {
    return firstName;
}
public void setFirstName(String firstName) {
    this.firstName = firstName;
}
public String getLastName() {
    return lastName;
}
public void setLastName(String lastName) {
    this.lastName = lastName;
}
public String getUsername() {
    return username;
}
public void setUsername(String username) {
    this.username = username;
}
public String getPassword() {
    return password;
}
public void setPassword(String password) {
    this.password = password;
}
public String getEmail() {
    return email;
}
public void setEmail(String email) {
    this.email = email;
}
public List<Role> getRoles() {
    return roles;
}
public void setRoles(List<Role> roles) {
    this.roles = roles;
}

} 
```

网页.xml：

```
<!-- Spring Security Configuration --> 
<filter>
  <filter-name>springSecurityFilterChain</filter-name>
  <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
  <filter-name>springSecurityFilterChain</filter-name>
  <url-pattern>/*</url-pattern>
</filter-mapping>

<!-- The definition of the Root Spring Container shared by all Servlets and Filters -->
<context-param>
   <param-name>contextConfigLocation</param-name>
   <param-value>
     /WEB-INF/spring/root-context.xml
     /WEB-INF/spring-security.xml
   </param-value>
</context-param>

<!-- Creates the Spring Container shared by all Servlets and Filters -->
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<!-- Processes application requests -->
<servlet>
    <servlet-name>appServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
       <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
           /WEB-INF/spring/appServlet/servlet-context.xml
        </param-value>
       </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>appServlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

servlet-context.xml：

```
<!-- DispatcherServlet Context: defines this servlet's request-processing infrastructure -->

<!-- Enables the Spring MVC @Controller programming model -->
<annotation-driven />

<!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory -->
<resources mapping="/resources/**" location="/resources/" />

<interceptors>
    <beans:bean class="org.springframework.web.servlet.theme.ThemeChangeInterceptor"/>
</interceptors>

<beans:bean id="themeSource" class="org.springframework.ui.context.support.ResourceBundleThemeSource"/>

<beans:bean id="themeResolver" class="org.springframework.web.servlet.theme.CookieThemeResolver"/>

<!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory -->
<beans:bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <beans:property name="prefix" value="/WEB-INF/views/" />
    <beans:property name="suffix" value=".jsp" />
    <beans:property name="requestContextAttribute" value="requestContext"/>
</beans:bean>

<context:component-scan base-package="com.contact.list" />

<beans:bean id = "myDataSource" class = "org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <beans:property name="driverClassName" value = "org.postgresql.Driver"/>
    <beans:property name="url" value = "jdbc:postgresql://localhost:5432/hibernatedb"/>
    <beans:property name="username" value = "postgres"/>
    <beans:property name="password" value = "password"/>
</beans:bean>

 <!-- JPA Config -->

 <beans:bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <beans:property name="entityManagerFactory" ref="emf"/>
 </beans:bean>

 <tx:annotation-driven transaction-manager="transactionManager" />

 <beans:bean id = "emf" class = "org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
   <beans:property name = "dataSource" ref = "myDataSource"/>
   <beans:property name = "jpaVendorAdapter">
     <beans:bean class = "org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"/>
   </beans:property>
   <beans:property name = "packagesToScan" value = "com.contact.list.form" />
   <beans:property name="jpaProperties">
     <beans:props>
      <beans:prop key="hibernate.dialect">org.hibernate.dialect.PostgreSQLDialect</beans:prop>
      <beans:prop key = "hibernate.show_sql">true</beans:prop>
      <beans:prop key="hibernate.hbm2ddl.auto">update</beans:prop>
     </beans:props>
   </beans:property>
 </beans:bean>

 <beans:bean id = "passwordEncoder" class = "org.springframework.security.authentication.encoding.Md5PasswordEncoder"/>

 <context:annotation-config/>

 <!-- JPA Config -->

 <!-- JPA Repository Abstraction Config -->

 <jpa:repositories base-package="com.contact.list.repository"  entity-manager-factory-ref="emf" transaction-manager-ref="transactionManager"/> 
```

弹簧安全.xml

```
 <http auto-config="true" use-expressions="true">
 <intercept-url pattern="/home*" access="hasRole('ROLE_USER')"/>
     <form-login login-page="/login" default-target-url="/home" authentication-failure-url="/loginfailed" />
     <logout logout-success-url="/logout" />
     </http>

     <authentication-manager>
     <authentication-provider user-service-ref = "customUserDetailsService">
     <password-encoder ref = "passwordEncoder"/>
     </authentication-provider>
     </authentication-manager>

     <beans:bean id="customUserDetailsService" class="com.contact.list.service.CustomUserDetailsService"/>

     <beans:bean id = "passwordEncoder" class = "org.springframework.security.authentication.encoding.Md5PasswordEncoder"/>

     </beans:beans> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T14:06:28.650

所以，写它作为答案，这里发生的事情是，在一个典型的 Spring Web 应用程序中，你有属于 Spring MVC Servlet 的应用程序上下文（Spring 术语，这里是 bean 所在的地方）*。*

这个在 web.xml 中定义为`/WEB-INF/spring/appServlet/servlet-context.xml`.

另一方面，Spring Security Filter 不能访问这样的上下文，它只能访问根上下文。根上下文加载了`ContextLoaderListener`定义的 和 bean：

```
<param-value>
     /WEB-INF/spring/root-context.xml
     /WEB-INF/spring-security.xml
</param-value> 
```

由于定义了根上下文，因此 Servlet 上下文被构建为根上下文的子级。这使 Servlet 上下文能够访问位于其父级中的 bean，但其他方式是不可能的。

然后，在 Servlet 上下文中定义了作为 DataSource、Persistence system (JPA) 和 Services 的基本 bean。安全系统试图访问服务 bean（用户服务）但没有成功，因为该服务位于 Servlet 上下文而不是根上下文（Spring Security 所在的位置）中，因此出现空指针异常。

**解决方案：**将 Datasource、JPA 和 Services bean 移动到根上下文，并将 Servlet 上下文留给 Spring MVC 控制器和视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-17T18:56:28.903

您应该从*UserServiceImpl*类中删除*@Repository*注释。否则 Spring 会尝试两次实例化 bean（因为 @Service 和 @Repository 注释）......

 *```
@Service
@Repository
@Transactional
public class UserServiceImpl implements UserService { 
```*

# iphone - 使用 NSSortDescriptor

> ID：12806329
> 
> 赞同：0
> 
> 时间：2012-10-09T18:39:37.237
> 
> 标签：iphone, objective-c, ios, core-data, nssortdescriptor

我正在使用 sortDescriptor 对我的 NSFetchRequest 结果进行排序。我正在这样做。

```
NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Team"];
    request.sortDescriptors = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"position" ascending:YES]]; 
```

位置可以是 4 个值：

1.  攻击者
2.  守门员
3.  边锋
4.  后卫

目前它对所有位置进行了分组。所以首先是所有的前锋，然后是所有的守门员，然后是所有的后卫，最后是所有的边锋。我现在想要实现的是改变排名的顺序。排名顺序应该是。

1.  首先是门将
2.  其次所有的防守者
3.  第三所有边锋
4.  最后是所有边锋

有人知道我该怎么做吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:57:34.937

一种混乱的做法是添加一个额外的整数列来表示每个玩家类型，然后按其排序。

编辑：这不一定是一种“混乱”的方法，因为它可以完成这项工作，但我建议它混乱的唯一原因是因为你必须添加额外的东西才能知道玩家的类型。尽管如此，这是一种合理的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:04:11.583

如果你有一个存储所有对象的关系，你可以准备辅助方法，这些方法将使用 NSSortDescriptors 和准备好的块对 NSSet 中的项目进行排序。或者您可以获取所有对象，然后对它们进行排序。

# c++ - 如何编写可以在 msdos 上运行的 c++ 控制台 exe？

> ID：12806330
> 
> 赞同：4
> 
> 时间：2012-10-09T18:39:37.783
> 
> 标签：c++, compiler-construction, console-application, cross-compiling, dos

我一直在谷歌上寻找这个，但从来没有得到明确的答案。我正在尝试编写一个简单的 hello world 应用程序并使其在 msdos 下运行（我将安装在附近的旧钻机上）。

但首先，我一直在尝试编译一个普通的控制台应用程序并将其放入 dosbox 以测试它不起作用，只是说它无效。所以我假设我需要其他东西来编译它。这是否意味着我有义务在 msdos 环境中构建我的代码？即使是这种情况，我也不知道该怎么做，有点像msdos dummy ..

如果有人能对我的案子有所了解，我将不胜感激！

PS：我运行的是64位系统

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:43:36.737

您可以为 DOS 使用免费的[DJGPP](http://www.delorie.com/djgpp/)编译器。
这[是使用 DJGPP 的文档](http://www.delorie.com/djgpp/doc/ug/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T18:45:08.337

我假设您指的是实际的 DOS，而不是在 Windows 中运行的命令提示符。

DOS 是 16 位操作系统，因此您需要一个能够生成 16 位二进制文​​件的编译器。Windows 控制台应用程序是 32 位的，因此它不会在 DOS 下运行。您不必在 DOS 环境中构建代码，您只需要正确的编译器即可。

至于编译器，您可能需要查看[OpenWatcom](http://www.openwatcom.org/index.php/Main_Page)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-09T18:46:25.437

> Microsoft Visual C++ 1.52 是 Microsoft C++ 编译器的唯一可用版本，它支持编译 16 位代码。

[http://social.msdn.microsoft.com/forums/en-US/Vsexpressvc/thread/cfc848e8-a797-42a5-8537-892cfc234123](http://social.msdn.microsoft.com/forums/en-US/Vsexpressvc/thread/cfc848e8-a797-42a5-8537-892cfc234123)

您需要找到一个可以生成 16 位 COM 文件的旧编译器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T03:44:34.360

> 在 64 位系统上运行它会是一个问题吗？...

是的，64 位 Windows 无法执行 16 位程序。如果您安装一台带有 MS-DOS 或 32 位 Windows 系统的虚拟 PC，则该虚拟 PC 将能够执行 16 位程序。

您是否需要编辑您的问题以说明您使用的是 64 位 Windows？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-09T18:43:55.100

听起来您正在现代版本的 Windows 上编译控制台应用程序，并试图简单地将其复制到旧的 DOS 框。问题是 DOS 不向前兼容。您不能在 Windows 之前的 DOS 版本上运行使用 Windows 7 编译的程序。最简单的解决方案是在 DOS 框本身上编译您的程序。或者，如果您想在较新的机器上进行开发，您需要获得一个针对您要运行程序的操作系统的交叉编译器。

# apache-flex - CSS 中有没有办法隐藏 Spark Scroller 或 Spark Datagrid 中的向上和向下按钮？

> ID：12806334
> 
> 赞同：0
> 
> 时间：2012-10-09T18:39:48.687
> 
> 标签：apache-flex, flex4

CSS 中有没有办法隐藏 Spark Scroller 或 Spark Datagrid 中的向上和向下按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T00:40:18.693

不，它需要自定义皮肤。

# javascript - 如何让 div 重新调整自身大小以在页面加载时显示图像

> ID：12806340
> 
> 赞同：1
> 
> 时间：2012-10-09T18:40:29.293
> 
> 标签：javascript, jquery, dom

所以我的目标是制作一个底部有 3 个可点击热点的图像幻灯片。我现在已经有了这个的基本功能，但是我的内容 div 直到它第一次遍历图像时才正确调整大小。我需要在页面加载时立即正确调整所有内容的大小和位置。

```
<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
<script type="text/javascript">     
        $(document).ready(function () {
            $("#image").attr("src", images[0]);         
        });     

        //Click tracking
        var badClicks = 0;
        var skipClicks = 0;
        var goodClicks = 0;

        //Counter to keep track of images
        var iCount = 0;
        var images = [];
        images[0] = "images/document.png";
        images[1] = "images/document2.png";
        images[2] = "images/document3.png";

        function nextImage(){
            iCount++;

            //If there are no more images in the array, go back to the first image
            if (images[iCount]==null) {
                iCount = 0;
            };

            //Change image source to new image
            $("#image").attr("src", images[iCount]);

            //Set content wrapper width & height to current image's width & height
            $("#content").css("width", $("#image").css("width"));
            $("#content").css("height", $("#image").css("height"));

            //Store content wrapper's new width and height into variables
            var h = parseInt($("#content").css("height"));
            var w = parseInt($("#content").css("width"));

            //Move hotspot-wrapper to the bottom of the new image
                //Height of content wrapper - height of hotspot wrapper = new top
            $("#hotspot-wrapper").css("top", h - parseInt($("#hotspot-wrapper").css("height")));

            console.log(images[iCount] + " h " + h + " w " + w);
        }

        //Do something with data for "bad" hotspot
        function bad(){
            badClicks++;
        }

        //Do something with data for "skip" hotspot
        function skip(){
            skipClicks++;
            nextImage();
        }

        //Do something with data for "good" hotspot
        function good(){
            goodClicks++;
        }

        //Show the collected data
        function displayResults(){
            $("#results").append("<br />Bad: " + badClicks 
            + " Skip: " + skipClicks 
            + " Good: " + goodClicks);
        }
    </script>
  </head>
  <body>
    <div id="content">      
        <img id="image" />
        <div id="hotspot-wrapper">
            <div id="hotspot-a" class="hotspot" onclick="bad();"></div>
            <div id="hotspot-b" class="hotspot" onclick="skip();"></div>
            <div id="hotspot-c" class="hotspot" onclick="good();"></div>
        </div>
    </div>
        <br />
        <div id="results" style="clear:both">
            <button onclick="displayResults();" style="text-align: center">Show results</button>
        </div> 
```

任何帮助、提示或建议将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T19:00:06.003

首先，我更喜欢这种方式来初始化图像数组：

```
var images = [];
var image = new Image();
image.src = '/some/image/url.jpg';
/* while you doing this image already load in background - so its faster way*/
images.push(image); 
```

您可以使用 jQuery 以这种方式显示这些图像：

```
$('#parend_of_image_div').html(images[iCount]); 
```

在您的`nextImage`函数内部使用以下代码：

```
var img = images[iCount];
$(img).load(function(){
    var width = $(this).width()
    var height = $(this).height();
    /* do other stuff */
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T18:53:20.540

这是你的问题

```
 $("#image").css("width") 
```

但是，您还没有使用 css 设置#image 的宽度。你需要使用

```
$('#image').width() 
```

此外，为了安全起见，您应该只在图像触发加载事件后继续执行这部分代码：

```
//Change image source to new image
$("#image").attr("src", images[iCount]).load(function(){

    //Set content wrapper width & height to current image's width & height
    $("#content").css("width", $("#image").width());
    $("#content").css("height", $("#image").height());

    //And then the rest... 
```

# javascript - 打印某些 div 无法正常工作

> ID：12806344
> 
> 赞同：0
> 
> 时间：2012-10-09T18:40:47.940
> 
> 标签：javascript, html, printing, datatable, html-table

我正在使用 datables 插件在我的网络应用程序上绘制表格。

但问题就在这里。

我有一个打印按钮，它调用我这个功能：

```
function printHTML(clonedDive){
        var iframe = document.createElement("iframe");
        document.body.appendChild(iframe);
    iframe.contentWindow.onunload = function(){
            $("#submenu").show("fast");
            $(".content-secondary").animate({
                             width: '15%'
                         });

            $(".content-primary").animate({
                             width: '83%'
                         });     
     };
      iframe.contentWindow.document.body.appendChild(clonedDive);
      iframe.contentWindow.print();

      document.body.removeChild(iframe); 
} 
```

这就是我调用这个函数的方式：

```
printHTML( document.getElementById("results").cloneNode(true)); 
```

现在`results`div 看起来像这样：

```
<div id="results">
<table id="stops" width="100%" border="1" cellspacing="2" cellpadding="5" >
                <thead>
                    <tr class="even">

                    </tr>
                </thead>

                      <tbody>
                      </tbody>

                     </table>
                     </br>

                     <hr>

                     <p id="title"><b>Map</b></p>
                     <div id="map_find">

                     </div>
</div> 
```

所以表格是这样工作的：当您单击行时，该行被突出显示并显示地图。所以当我点击打印按钮时出现问题。

在打印预览中，我可以看到表格，但未突出显示该行，也未显示 Google 地图。似乎它向我展示了首先初始化的 div 并且没有突出显示的行并且没有显示谷歌地图。

我能做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:16:24.473

你考虑过改用[`@media types`](https://developer.mozilla.org/en-US/docs/CSS/@media)吗？

```
@media print
{
  *{
     visibility: hidden;
  }
  #results{
     visibility: visible;
  }
} 
```

您可以设置您不想打印的所有内容`visibility: hidden`以及您想打印的任何内容的可见性`visibility: visible`。

然后点击你会打电话：

[`window.print()`](https://developer.mozilla.org/en-US/docs/DOM/window.print)

**[媒体类型示例](http://jsfiddle.net/MsmVb/)**

**[没有媒体类型的示例](http://jsfiddle.net/aPztQ/)**

# php - 用户页面出现 404 错误

> ID：12806346
> 
> 赞同：0
> 
> 时间：2012-10-09T18:40:56.030
> 
> 标签：php, http-status-code-404

我的基于用户的网站设置如下：

1.  每个用户在 mydomain.com/user123 上都有自己的个人资料页面
2.  在幕后，用户不知道，这重定向到 mydomain.com/profile.php?user=user123

如果有人访问任何 URL，如 mydomain.com/randomstring，我如何确保查看器在“randomstring”不等于当前用户名的情况下看不到“mydomain.com/profile.php?user=randomstring”在我的网站上注册，但他们看到的是 404 错误？

（出于参考目的，profile.php 填充了一个预定义的模板，该模板提取与每个唯一用户名关联的自定义变量。因此，如果某个用户名不存在，则转到 mydomain.com/randomstring 会显示一个名为“ randomstring 的个人资料页面。”）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:43:27.430

```
<?php
if(/*USER_DOESN'T_EXIST*/)
header("HTTP/1.0 404 Not Found");
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:07:33.683

```
 check the random string with database userid 
(i suppose the id is the user id) if user id not in db 
    header("location:404.php"); 
```

或者

让 apache 为你处理

在您的 htaccess 文件中

```
ErrorDocument 404 /missing.html 
```

或在您的 php 脚本中

```
header("HTTP/1.0 404 Not Found"); 
```

# perl - DBIx::Class 查询失败，但从 DBIC_TRACE 转储有效

> ID：12806348
> 
> 赞同：0
> 
> 时间：2012-10-09T18:41:08.487
> 
> 标签：perl, orm, dbix-class

顺便说一句，我现在无法重写当前的数据库架构，但这与我遇到的问题无关，所以请忽略表结构：D

我正在运行这个数据库查询：

```
my $rs = $dbx->resultset('Result')->search(
           {
             'result_hnd'         => 16078055,
             'seasons.outdoor'    => 'venue.outdoors',
             'seasons.start_date' => { '<=' => 'meet.date_end'   },
             'seasons.end_date'   => { '>=' => 'meet.date_begin' },
           },
           {
             'join' => [
               {
                 'team' => {
                   'league_teams' => {
                     'league' => 'seasons',
                   },
                 },
               },
               {
                 'meet' => 'venue'
               },
             ],
             '+select' => ['seasons.season_hnd','seasons.name','seasons.start_date','seasons.end_date','meet.date_begin','meet.date_end'],
             '+as'     => ['season_hnd','season_name','s_start','s_end','m_start','m_end'],
             columns   => ['result_hnd'],
             group_by  => ['seasons.season_hnd'],
           }
         ); 
```

当我运行它时，我没有得到任何结果。启用 DBIC_TRACE 后，我将生成的 SQL 视为：

```
SELECT me.result_hnd, seasons.season_hnd, seasons.name, seasons.start_date, seasons.end_date, meet.date_begin, meet.date_end FROM track.result me JOIN track.team team ON team.team_hnd = me.team_hnd LEFT JOIN track.league_team league_teams ON league_teams.team_hnd = team.team_hnd LEFT JOIN track.league league ON league.league_hnd = league_teams.league_hnd LEFT JOIN track.season seasons ON seasons.league_hnd = league.league_hnd OR seasons.league_hnd = league.parent_league_hnd JOIN track.meet meet ON meet.meet_hnd = me.meet_hnd JOIN track.venue venue ON venue.venue_hnd = meet.venue_hnd WHERE ( ( result_hnd = ? AND seasons.end_date >= ? AND seasons.outdoor = ? AND seasons.start_date <= ? ) ) GROUP BY seasons.season_hnd: '16078055', 'meet.date_begin', 'venue.outdoors', 'meet.date_end' 
```

当我将此语句复制并粘贴到我的 MYSQL 客户端（并插入占位符）时，如下所示：

```
SELECT me.result_hnd, seasons.season_hnd, seasons.name, seasons.start_date, seasons.end_date, meet.date_begin, meet.date_end 
  FROM track.result me 
      JOIN track.team team ON team.team_hnd = me.team_hnd 
      LEFT JOIN track.league_team league_teams ON league_teams.team_hnd = team.team_hnd 
      LEFT JOIN track.league league ON league.league_hnd = league_teams.league_hnd 
      LEFT JOIN track.season seasons ON seasons.league_hnd = league.league_hnd OR seasons.league_hnd = league.parent_league_hnd 
      JOIN track.meet meet ON meet.meet_hnd = me.meet_hnd 
      JOIN track.venue venue ON venue.venue_hnd = meet.venue_hnd 
WHERE ( ( result_hnd = 16078055 AND seasons.end_date >= meet.date_begin AND seasons.outdoor = venue.outdoors AND seasons.start_date <= meet.date_end ) ) 
  GROUP BY season_hnd; 
```

我得到了我期望的确切结果（7 条记录）。

这真的很奇怪。出于所有意图和目的，这不是完全相同的查询吗？我在调试中遗漏了什么吗？还是在 DBIx::Class::ResultSet 层发生了其他没有被转储的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:25:37.167

要告诉 SQL::Abstract 右边的值实际上是一个标识符，您可以执行以下操作（如[docs](https://metacpan.org/module/SQL%3a%3aAbstract#ident)中所述）：

```
 {
     'result_hnd'         => 16078055,
     'seasons.outdoor'    => { -ident => 'venue.outdoors' },
     'seasons.start_date' => { '<=' => { -ident => 'meet.date_end' }   },
     'seasons.end_date'   => { '>=' => { -ident => 'meet.date_begin' } },
   }, 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:45:43.227

> 出于所有意图和目的，这不是完全相同的查询吗？

（*出于*所有意图和目的，...）

不，在日志中，你有相当于

```
result_hnd = '16078055'
AND seasons.end_date >= 'meet.date_begin'
AND seasons.outdoor = 'venue.outdoors'
AND seasons.start_date <= 'meet.date_end' 
```

或者可能

```
result_hnd = 16078055
AND seasons.end_date >= 'meet.date_begin'
AND seasons.outdoor = 'venue.outdoors'
AND seasons.start_date <= 'meet.date_end' 
```

在您的尝试中，您使用了

```
result_hnd = 16078055
AND seasons.end_date >= meet.date_begin
AND seasons.outdoor = venue.outdoors
AND seasons.start_date <= meet.date_end 
```

抱歉，我没有适合你的解决方案。

# php - 用 codeigniter 更新配置项？

> ID：12806353
> 
> 赞同：1
> 
> 时间：2012-10-09T18:41:36.573
> 
> 标签：php, mysql, codeigniter

我的问题是可以在codeigniter的自定义配置文件中编辑配置值吗？

我明白那个

```
$this->config->set_item('item_name', 'item_value'); 
```

会将某个配置项设置为某个值，但是这种更改会是永久性的吗？如果我有一个网站的管理员配置文件，并希望允许用户编辑某些需要永久更改的值，或者直到用户再次更改它们。

还是我最好将设置存储在数据库中然后获取它们？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:46:35.707

据我所知，除了直接在配置文件中写入更改外，没有办法保存 CI 配置中的更改。

所以最好使用数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T20:53:33.043

听起来您希望一个值在应用程序的生命周期内保持不变，并且您考虑让用户修改应用程序配置变量。

**问题**

无论您尝试将此“设置”保存到哪个级别的范围，无论是应用程序还是服务器，您都有可能在服务器重新启动时丢失它。

**回答**

如果您真的想保留此值，则需要将其保存在数据库中。除了物理上丢失您的数据库之外，价值将永远存在。

# php - GAPI 输出与 Google Analytics 网站不匹配

> ID：12806354
> 
> 赞同：0
> 
> 时间：2012-10-09T18:41:40.513
> 
> 标签：php, api, google-analytics, google-api

我必须获得有关我的 Google Analytics（分析）目标的主要信息。

我正在使用 GAPI lib，使用以下代码：

```
<?php
require_once 'conf.inc';
require_once 'gapi.class.php';

$ga = new gapi(ga_email,ga_password);

$dimensions = array('pagePath', 'hostname');
$metrics = array('goalCompletionsAll', 'goalConversionRateAll', 'goalValueAll');

$ga->requestReportData(ga_profile_id, $dimensions, $metrics, 
      '-goalCompletionsAll', '', '2012-09-07', '2012-10-07', 1, 500);
$gaResults = $ga->getResults();

foreach($gaResults as $result)
{
    var_dump($result);
} 
```

剪切此代码是输出：

```
object(gapiReportEntry)[7]
  private 'metrics' => 
    array (size=3)
      'goalCompletionsAll' => int 12031
      'goalConversionRateAll' => float 206.93154454764
      'goalValueAll' => float 0
  private 'dimensions' => 
    array (size=2)
      'pagePath' => string '/catalogs.php' (length=13)
      'hostname' => string 'www.example.com' (length=13)
object(gapiReportEntry)[6]
  private 'metrics' => 
    array (size=3)
      'goalCompletionsAll' => int 9744
      'goalConversionRateAll' => float 661.05834464043
      'goalValueAll' => float 0
  private 'dimensions' => 
    array (size=2)
      'pagePath' => string '/price.php' (length=10)
      'hostname' => string 'www.example.com' (length=13) 
```

我在 Google Analytics 网站上的目标 URL 页面上看到的同一日期是：

```
 Goal Completion Location    Goal Completions    Goal Value
1\.  /price.php                        9,396            $0.00
2\.  /saloni.php                       3,739            $0.00 
```

如您所见，输出不匹配。为什么？怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T17:33:16.603

您需要将目标表达式与 pagePath 匹配。首先，您必须从该站点[http://www.seerinteractive.com/blog/google-analytics-management-api-phpinterface-for-php](http://www.seerinteractive.com/blog/google-analytics-management-api-phpinterface-for-php)下载 gManagement 扩展。然后按照以下步骤操作：

1) 将以下代码添加到 gapi 类的 accountObjectMapper 方法中：

```
 foreach ($entry->children('http://schemas.google.com/ga/2009')->goal as $goal){
    if ($goal->attributes()->active=='true'){
        $properties['name'] = strval($goal->attributes()->name);
        $properties['number'] = strval($goal->attributes()->number);
        foreach ($goal->children('http://schemas.google.com/ga/2009')->destination as $destination){
            $properties['expression'] = strval($destination->attributes()->expression);
            $properties['matchType'] = strval($destination->attributes()->matchType);
        }
    } 
```

这必须在 Load Entry 循环内。

2）通过gManagement类获取goals表达式和matchType：

```
$gm = new gManagementApi($account, $password);
        $profiles = $gm->requestAccountFeed('~all', '~all');

        $account_id = '';
        $property_id = '';

        foreach ($profiles as $profile) {
            if ($profile->getProfileId() == $profile_id) {
                $account_id = $profile->getAccountId();
                $property_id = $profile->getWebPropertyId();
                break;
            }
        }

        $goals = $gm->requestAccountFeed($account_id, $property_id, '~all'); 
```

3) 为您的 PagePath 查询构建过滤器：

```
$filter = '';
        foreach ($goals as $goal) {
            if ($goal->getMatchType() == 'head') {
                $filter .= "ga:pagePath=~^" . $goal->getExpression() . ","; 
             } else if ($goal->getMatchType() == 'exact') {
                $filter .= "ga:pagePath==" . $goal->getExpression() . ",";   
             } else {
                $filter .= "ga:pagePath=@" . $goal->getExpression() . ",";  
             }
        }

        return substr($filter,0,-1); 
```

4）在添加内置过滤器时进行相同的查询：

$ga->requestReportData(ga_profile_id, $dimensions, $metrics, '-goalCompletionsAll', $filter, '2012-09-07', '2012-10-07', 1, 500);

这是很多步骤，但对我有用。希望对你有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-27T20:46:40.443

还要确保您没有采样。如果您 a) 在您查询的时间段内有超过 50,000 次查看并且 b) 没有分析溢价，Google 会自动采样和推断

有一个简单的解决方法，只需有一个每天查询的循环，并在循环结束时递增日期变量。

# java - 在哪里可以找到统一 EL 2.2 的语法？

> ID：12806355
> 
> 赞同：2
> 
> 时间：2012-10-09T18:41:40.933
> 
> 标签：java, jsp, jsf, el

我花了一整天的时间寻找统一表达语言 2.2 的正式语法，但我能找到的最好的是[这个具有规范的 PDF](https://services.brics.dk/java/courseadmin/SWP/documents/getDocument/expression_language-2_2-mrel-spec.pdf?d=61845)，但不是以我可以工作或用作参考卡的方式。

这是非常令人沮丧的，因为在处理一种新的形式语言时首先想到的是语法（但甲骨文似乎有一个“破解突击队”致力于在他们的网站上混淆内容）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:50:13.117

这些作品在链接的 PDF 文件的第 1.19 节中列出。

# c++ - 虽然循环条件不起作用

> ID：12806359
> 
> 赞同：0
> 
> 时间：2012-10-09T18:41:52.710
> 
> 标签：c++, while-loop, text-based

嘿，基本上我希望玩家和狼互相攻击，直到彼此死亡。但是while循环是无限的，所以显然条件不满足。但我看不出我哪里出了问题 if (choice1 == 1) // if 语句在整个游戏中使用，以允许用户通过游戏与选择进行交互。

```
while((Status.health != 0) && (Wolves.health != 0) )
        {
        int playerAttack = Status.strength + hitPoints() +  Rock.attack;
        cout<< "This is the player attack" << playerAttack;
        Wolves.health = Wolves.health - playerAttack;
        cout << "This is the wolves health" << Wolves.health;
        if (Wolves.health <= 0)
        {
            cout << "\nThe wolves are dead\n ";
        }
        int wolfAttack = Wolves.attack + hitPoints();
        Status.health - wolfAttack;
        if(Status.health <= 0)
        {
            gameOver();
        }// print out of object health.
        } 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:44:00.913

比较：

```
Wolves.health = Wolves.health - playerAttack; 
```

对比

```
Status.health - wolfAttack; 
```

注意到有什么不同吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T18:44:02.853

你确定这是正确的：

```
Status.health - wolfAttack; 
```

这实际上是一个无操作。也许你的意思是：

```
Status.health -= wolfAttack; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-09T18:44:47.513

好吧，我认为健康状况不完全是 0 - 因为您的状况仅查找 != 0 它应该大于 0

while((Status.health > 0) && (Wolves.health > 0)) ...

编辑：也失踪=约翰迪布林首先找到

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-09T19:33:56.400

在计算机中，某些数字无法表示，例如 0.1，因此如果计算 1 - (0.1 * 10)，其结果不等于 0。您只检查了 !=0 和 ==0 条件。试试这个：

> =0 或 <=0 如果你的“健康”变量是整数，你给出一个容错，例如：=(0.5) 或 <=(0.5) 等...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-09T18:44:23.867

很可能这两个值都不会为零。这听起来很可能，因为你自己使用了这个`<=`条件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-09T18:44:37.217

我认为你得到了负值，我建议使用

```
while((Status.health > 0) && (Wolves.health > 0) ) 
```

# sql - 时间数据修复

> ID：12806361
> 
> 赞同：0
> 
> 时间：2012-10-09T18:41:59.273
> 
> 标签：sql, sql-server-2008

我们在应用程序端搞砸了，在一列中加载了一些不正确的数据。现在我们需要修复这些数据。这是我们需要做的。

```
Starttime                      Answertime

2012-08-30 00:40:40.000      2012-08-30 03:40:53.000 
```

回答时间几乎比开始时间多 3 小时，这是不正确的。现在我们需要找到answertime 和 starttime 之间的**秒差，并将其添加到 starttime 中。**因此，对于上述 2012-08-30 **00:40:53.000**将是新的回答时间。

目前有点困惑如何去做。使用 sql server 2008 R2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:52:29.737

```
declare @t table (
  Starttime datetime,
  Answertime datetime);
insert @t values (
  '2012-08-30 00:40:40.000','2012-08-30 03:40:53.000'),(
  '2012-08-30 00:59:59.900','2012-08-30 03:00:03.000');

update @t set Answertime =
  case when dateadd(hh,datediff(hh,answertime,starttime),answertime) > starttime
       then dateadd(hh,datediff(hh,answertime,starttime),answertime)
       else dateadd(hh,datediff(hh,answertime,starttime)+1,answertime) end
where Answertime > DateAdd(hh,1,StartTime); -- more than 1 hour apart

select * from @T;

>>
STARTTIME                   ANSWERTIME
August, 30 2012 00:40:40    August, 30 2012 00:40:53
August, 30 2012 00:59:59    August, 30 2012 01:00:03 
```

答案的要点是将 Minutes:Seconds.MilliSecs 放在一边，应答时间与开始时间相同。它还修复了第二行等边缘情况，其中更改使其早于开始时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:09:27.703

假设您想忽略除秒之外的所有内容，但要处理差异超过一分钟的情况。

```
Update timetable set Answertime =
case when DatePart(ss,Answertime) >= DatePart(ss,Starttime) 
     then dateAdd(ss, DatePart(ss,Answertime)-DatePart(ss,starttime),Starttime)
else
     dateAdd(ss, 60+DatePart(ss,Answertime)-DatePart(ss,Starttime),Starttime)
end 
```

# .net - SectionInformation.AllowOverride 与 SectionInformation.InheritInChildApplications

> ID：12806362
> 
> 赞同：1
> 
> 时间：2012-10-09T18:42:02.993
> 
> 标签：.net

AllowOverride 说：

```
Gets or sets a value that indicates whether the associated configuration section can be overridden by lower-level configuration files. 
```

InheritInChildApplications 说：

```
Gets or sets a value that indicates whether the settings that are specified in the associated configuration section are inherited by applications that reside in a subdirectory of the relevant application. 
```

这是设置与部分交易还是有什么区别？

# php - 在 php 中使用 shell_exec 调用 gcc

> ID：12806365
> 
> 赞同：1
> 
> 时间：2012-10-09T18:42:03.677
> 
> 标签：php, gcc, compiler-construction, shell-exec

```
<?php
$output=shell_exec('gcc prog.c');
echo "$output";
?> 
```

我正在尝试使用 php 执行 ac 程序并使用 shell_exec 调用 gcc 来执行程序，但它没有给出任何输出但没有显示错误。可以请人纠正错误提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:46:36.183

gcc用于编译c文件。它不会“运行” .c 文件。从命令行尝试。运行 gcc prog.c 后你会注意到你有一个名为“a.out”的文件。a.out 是从 prog.c 成功编译创建的可执行文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:46:11.520

调用`gcc`将启动`prog.c`文件的编译。它没有执行它。

如果您需要`prog.c`在运行时编译您的文件，我会编写一个看起来有点像这样的快速 shell 脚本：

```
#!/bin/bash

rm prog_compiled_from_php               # Remove previously compiled program
GCC=`which gcc`                         # Find the path to gcc and store it in the "GCC" variable
$GCC prog.c -o prog_compiled_from_php   # Compile prog.c into the binary called prog_compiled_from_php
./prog_compiled_from_php                # Execute the compiled program 
```

将此文件另存为`prog_compile`

确保你使这个脚本可执行，这个：`chmod a+x prog_compile`

从 PHP 调用`$output = shell_exec('prog_compile');`

我不是 bash 脚本专家，请随时纠正我的语法:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-20T14:58:46.270

您可以使用`&&`. 要编译 C 文件并执行和回显输出，您可以使用以下代码：

```
$output = shell_exec('cd /path/to/c_file && gcc prog.c && a');
echo '&output'; 
```

# android - 具有自己的网络服务器的一致的安全 Google Play 应用内购买方案

> ID：12806370
> 
> 赞同：3
> 
> 时间：2012-10-09T18:42:26.727
> 
> 标签：android, security, in-app-purchase, in-app-billing, android-billing

我已多次阅读[Android 开发人员指南](http://developer.android.com/guide/google/play/billing/index.html)中的所有文档， 并熟悉了很好的 Google 演示文稿[Evading Pirates 和 Stopping Vampires](http://static.googleusercontent.com/external_content/untrusted_dlcp/www.google.com/en//events/io/2011/static/presofiles/dgalpin_android_pirates_and_vampires.pdf)

最后，我尝试按照上面的演示实现涉及我自己的 Web 服务器的应用内计费方案。以下是与我的服务器交互的要点：

1.  在向 Google 发出 REQUEST_PURCHASE 请求之前，我向我的网络服务器发出请求以注册新的购买。如果请求成功，我会从服务器获得一个随机数。
2.  交易完成后，我会收到一组通知 ID，以将它们传递给 GET_PURCHASE_INFORMATION 请求。此时我需要使用在步骤 1 中从我的服务器收到的随机数。**<-我被困在这里了！**
3.  当 GET_PURCHASE_INFORMATION 成功时，我得到一个signedJson 和一个我传递给我的服务器的签名。它验证购买并在服务器上提交交易。

到目前为止我无法理解的是两件事：

1.  **在我的情况下，如何通过传入的 IN_APP_NOTIFY 意图识别先前生成的随机数？**据我了解，它可以对应于当前购买完成或另一次购买退款。据我所知，我们只有与 REQUEST_PURCHASE 请求无关的通知 ID。
2.  **如何以我的服务器 100% 确认此事件的方式安全地处理退款？**恕我直言，最自然的方式是定期从我的服务器请求 Google 服务器以检索订单的实际状态。不幸的是，在我的国家，开发人员无法使用 Google Checkout API。另一种方法是通过设备定期检查订单状态，使用 GET_PURCHASE_INFORMATION 请求传递已知的通知 ID 和新的随机数。如果在一段时间内检查失败，购买将自动过期，直到第一次成功的订单状态验证。这种情况可能吗？我可以在订单的 CONFIRM_NOTIFICATIONS 请求之后使用已知的通知 ID 发出 GET_PURCHASE_INFORMATION 请求吗？

**编辑：**关于退款（第 2 点）有一个相关主题[Android In-App billing security issues？](https://stackoverflow.com/questions/11190856/android-in-app-billing-security-issues). **Google Play 中没有内置的最终用户功能要求开发者退款应用内购买是否正确？**如果是这样，那么我们可能会在我们的应用程序中实现一个按钮，将此类退款请求发送到我们的服务器，包括所有必要的信息，例如经过验证的用户凭据，然后在 Google 商家帐户和服务器的数据库中手动处理退款。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:33:36.477

没有程序化的方式来请求退款。用户必须与您联系（通过电子邮件等），您可以在开发者控制台中为他们的购买退款。处理完退款后，应用程序将收到`PURCHASE_STATE_CHANGED`带有新订单状态（已退款）的签名通知（广播）。您可以将其转发到您的服务器进行验证，就像新购买一样，并相应地更改订单状态。您不应该关心 nonce 与什么请求相关联，只需检查它是否确实是您生成的请求（参见 Dungeons 示例）。如果您在服务器上执行此操作，您通常会搜索您的数据库以检查您之前生成的随机数是否存在。

# perl - 检查数组中的所有字符串是否都在第二个数组中

> ID：12806374
> 
> 赞同：-3
> 
> 时间：2012-10-09T18:42:57.630
> 
> 标签：perl

假设我有 2 个数组

```
my @one = ("one","two","three","four","five");
my @two = ("three","five"); 
```

如何判断第二个数组中的所有元素是否都在第一个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:49:45.737

```
my %one = map { $_ => 1 } @one;
if (grep($one{$_}, @two) == @two) {
   ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T21:18:03.230

还有另一种解决方法。

```
my %hash;
undef @hash{@two};  # add @two to keys %hash 
delete @hash{@one}; # remove @one from keys %hash 
print !%hash;       # is there anything left? 
```

我从这个[perlmonks 节点偷了这个想法](http://www.perlmonks.org/?node_id=997026)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T22:22:45.093

```
use strict;

my @one = ("one","two","three","four","five");
my @two = ("three","five");

my %seen_in_one = map {$_ => 1} @one;

if (my @missing = grep {!$seen_in_one{$_}} @two) {
    print "The following elements are missing: @missing";
} else {
    print "All were found";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T19:30:52.520

自 5.10 起，智能匹配运算符将执行此操作。

```
my $verdict = !grep { not $_ ~~ @one } @two; 
```

或与[**`List::MoreUtils::all`**](http://search.cpan.org/perldoc?List%3a%3aMoreUtils#all)：

```
my $verdict = all { $_ ~~ @one } @two; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-09T19:12:10.157

另一种方法，不确定它是否比 ikegami 的更好。仍然是 TIMTOWDI

```
#!/usr/bin/env perl

use strict;
use warnings;

use List::Util qw/first/;
use List::MoreUtils qw/all/;

my @one = ("one","two","three","four","five");
my @two = ("three","five");

if ( all { my $find = $_; first { $find eq $_ } @one } @two ) {
  print "All \@two found in \@one\n";
} 
```

# c - 将 char 传递给函数会破坏堆

> ID：12806378
> 
> 赞同：0
> 
> 时间：2012-10-09T18:43:08.180
> 
> 标签：c, char, heap-memory, heap-corruption

下面的伪代码，但有谁知道为什么这会破坏堆？urlencode 函数是在其他地方下载的标准库函数，并且似乎按设计运行。在实际代码中，我使用的是动态大小的 char 数组，这就是 main 中 malloc 要求的原因。

```
/* Returns a url-encoded version of str */
/* IMPORTANT: be sure to free() the returned string after use */
char *urlencode(char *str) {
  //char *pstr = str, *buf = malloc(strlen(str) * 3 + 1), *pbuf = buf;
  char *pstr = str, *buf = malloc(strlen(str) * 3 + 1), *pbuf = buf;
  while (*pstr) {
    if (isalnum(*pstr) || *pstr == '-' || *pstr == '_' || *pstr == '.' || *pstr == '~') 
      *pbuf++ = *pstr;
    else if (*pstr == ' ') 
      *pbuf++ = '+';
    else 
      *pbuf++ = '%', *pbuf++ = to_hex(*pstr >> 4), *pbuf++ = to_hex(*pstr & 15);
    pstr++;
  }
  *pbuf = '\0';
  return buf;
}

int testFunction(char *str) {
    char *tmpstr;
    tmpstr = urlencode(str);
    // Now we do a bunch of stuff
    // that doesn't use str
    free(tmpstr);
    return 0;
    // At the end of the function,
    // the debugger shows str equal
    // to "This is a test"
}

int main() {
    char *str = NULL;
    str = malloc(100);
    strcpy(str, "This is a test");
    testFunction(str);
    free(str); // Debugger shows correct value for str, but "free" breaks the heap
    return 0;
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:55:26.660

I would guess that `str` was already freed by `free(tmpstr);` - please have a look at the behavior of the `urlencode`-function. It seems like it does not generate a new string as return value, but passes the (changed) input string back.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T21:58:28.920

问题原来是 str 的初始 malloc 执行为 0 的大小计算问题。感谢您的评论，不幸的是，没有办法将答案真正标记为评论。

如果这是关闭它的不正确方法，请告诉我。

# c# - 如何将列表中的值写入文本文件？

> ID：12806379
> 
> 赞同：-1
> 
> 时间：2012-10-09T18:43:07.643
> 
> 标签：c#

我有这个功能：

```
private void button6_Click(object sender, EventArgs e)
{
    crawlLocaly1 = new CrawlLocaly();
    crawlLocaly1.StartPosition = FormStartPosition.CenterParent;
    DialogResult dr = crawlLocaly1.ShowDialog(this);
    if (dr == DialogResult.Cancel)
    {
        crawlLocaly1.Close();
    }
    else if (dr == DialogResult.OK)
    {
        //LocalyKeyWords.Add(crawlLocaly1.getText() + "," + mainUrl);
        if(LocalyKeyWords.ContainsKey(mainUrl)) 
        {
            LocalyKeyWords[mainUrl].Add(crawlLocaly1.getText());

        }
        else
        {
            LocalyKeyWords.Add(mainUrl, new List<string>(new string[]
            {
                crawlLocaly1.getText()
            }
            ));
        } 
        crawlLocaly1.Close();
    }
} 
```

当用户在 textBox 中键入内容并单击“确定”时，LocalKeyWords 中的结果即 Dictionary> 如下所示：

在索引 0 中会有例如：[http://www.google.com](http://www.google.com) ","google 其中 google 是属于[http://www.google.com的键](http://www.google.com)

现在，如果用户在 url 中输入一次关键字，它将转到第二部分，如果用户更改相同 url 的密钥，它将转到第一部分，否则如果用户更改 url，它将转到第二部分部分。

第一次为 url 放置密钥，第二次为相同的 url 更新密钥或为新 url 放置新密钥。

所以列表应该是这样的：

```
index 0 http://www.google.com,google
index 1 http://www.microsoft.com,com 
```

等等......这个功能正常工作我只需要将列表添加到硬盘上的文本文件中。所以在 Form1 级别我有 streamwriter w = new streamwriter(@"d:\test.txt");

事实上，当我在 List 上使用断点时，我在左侧看到了 url then ，然后我看到了一些不是关键字的东西：

```
 [0] = {[http://www.google.co.il, System.Collections.Generic.List`1[System.String]]} 
```

它不是错误或其他东西，它只是在断点上，这就是我的看法。相反 System.Collections.Generic.List`1[System.String] 我想看到关键字，例如：google

无论如何，我如何将列表值写入文本文件，以便文本文件格式如下所示：

```
0 http://www.google.com,google
1 http://www.microsoft.com,hello
2 http://www.cnet.com,Daniel 
```

0 1 2 表示索引，url 表示 mainUrl，右 sie 表示 Keys（用户输入的关键字）。

然后如何将文本文件中的值读回 lixtBox ？因此，当我在构造函数中运行程序时，它会读取文本文件并在 listBox 中显示这种格式：

```
url: http://www.google.com --- keword: google
url: http://www.microsoft.com --- keword: hello
url: http://www.cnet.com --- keword: Daniel 
```

因此，在 listBox 中，用户会比在文本文件中看到更好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:01:29.277

您可以尝试使用此简单代码将您的值写入文本文件：

```
 int count = 0;
        foreach(KeyValuePair<string, string> kvp in LocalyKeyWords)
        {
            w.WriteLine(count.ToString() + " " + kvp.Key + " " + kvp.Value);
            count++;
        }
        w.Close(); 
```

您也可以使用以下代码读取该文本文件，我必须警告您，它不会检查您是否在文本文件中使用空白字符分隔所有三个字符串。此外，如果您存储的文本包含空白字符，您应该使用一些特殊字符分隔文件中的字符串。

```
 TextReader r = new StreamReader(@"d:\test.txt");
        string line = string.Empty;
        while ((line = r.ReadLine()) != null)
        {
            string[] data = line.Split(new char[] { ' ' },  StringSplitOptions.RemoveEmptyEntries);
            ListViewItem lvi = new ListViewItem("url: " + data[1] + " " + data[2]);
            listView1.Items.Add(lvi);
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:29:23.753

What the debugger is telling you is accurate. You're adding a List of String to your collection and not a string, that's why the debugger shows you a list instead of a string. It's a newbie mistake to think the tools are wrong.

```
LocalyKeyWords.Add(mainUrl, new List<string>(new string[] 
```

By the way, that statement isn't even syntactically correct - your closing bracket is missing.

# json - JSON API 响应格式有什么标准吗？

> ID：12806386
> 
> 赞同：817
> 
> 时间：2012-10-09T18:43:36.350
> 
> 标签：json

是否存在用于构建来自 API 的 JSON 响应的标准或最佳实践？显然，每个应用程序的数据都是不同的，所以我不关心这些，而是​​“响应样板”，如果你愿意的话。我的意思的一个例子：

**请求成功：**

```
{
  "success": true,
  "payload": {
    /* Application-specific data would go here. */
  }
} 
```

**请求失败：**

```
{
  "success": false,
  "payload": {
    /* Application-specific data would go here. */
  },
  "error": {
    "code": 123,
    "message": "An error occurred!"
  }
} 
```

* * *

## 回答 #1

> 赞同：765
> 
> 时间：2013-01-26T16:12:33.243

是的，已经出现了几个标准（尽管对标准的定义有一些自由）：

1.  [JSON API](http://jsonapi.org) - JSON API 也包括创建和更新资源，而不仅仅是响应。
2.  [JSend](https://github.com/omniti-labs/jsend) - 很简单，可能你已经在做。
3.  [OData JSON 协议](http://docs.oasis-open.org/odata/odata-json-format/v4.0/errata02/os/odata-json-format-v4.0-errata02-os-complete.html#_Toc403940655)- 非常复杂。
4.  [HAL](http://stateless.co/hal_specification.html) - 像 OData，但目标是像[HATEOAS](http://en.wikipedia.org/wiki/HATEOAS)。

还有 JSON API 描述格式：

*   [昂首阔步](https://github.com/wordnik/swagger-core/wiki)
    *   [JSON Schema](http://json-schema.org/)（由 swagger 使用，但您可以单独使用它）
*   JSON 格式的 WADL
*   [随机存取存储器](http://raml.org)
*   HAL，因为[理论上 HATEOAS](http://en.wikipedia.org/wiki/HATEOAS)是自我描述的。

* * *

## 回答 #2

> 赞同：253
> 
> 时间：2014-05-17T07:46:30.413

### [谷歌 JSON 指南](https://google.github.io/styleguide/jsoncstyleguide.xml)

成功响应返回[`data`](https://google.github.io/styleguide/jsoncstyleguide.xml?showone=data#data)

```
{
  "data": {
    "id": 1001,
    "name": "Wing"
  }
} 
```

错误响应返回[`error`](https://google.github.io/styleguide/jsoncstyleguide.xml?showone=error#error)

```
{
  "error": {
    "code": 404,
    "message": "ID not found"
  }
} 
```

如果你的客户端是JS，你可以用它`if ("error" in response) {}`来检查是否有错误。

* * *

## 回答 #3

> 赞同：165
> 
> 时间：2012-10-19T18:05:34.753

我想事实上的标准还没有真正出现（而且可能永远不会出现）。但无论如何，这是我的看法：

**请求成功：**

```
{
  "status": "success",
  "data": {
    /* Application-specific data would go here. */
  },
  "message": null /* Or optional success message */
} 
```

**请求失败：**

```
{
  "status": "error",
  "data": null, /* or optional error payload */
  "message": "Error xyz has occurred"
} 
```

优点：成功和错误情况下的顶级元素相同

缺点：没有错误代码，但是如果您愿意，您可以将状态更改为（成功或失败）代码，或者您可以添加另一个名为“代码”的顶级项目。

* * *

## 回答 #4

> 赞同：96
> 
> 时间：2012-10-09T19:49:35.717

假设您的问题是关于 REST Web 服务设计，更准确地说是关于成功/错误。

我认为有3种不同类型的设计。

1.  仅使用**HTTP 状态代码**来指示是否存在错误，并尝试将自己限制为标准状态代码（通常就足够了）。

    *   优点：它是独立于您的 api 的标准。
    *   缺点：关于真实情况的信息较少。
2.  使用**HTTP 状态 + json 正文**（即使是错误）。为错误定义一个统一的结构（例如：代码、消息、原因、类型等）并将其用于错误，如果成功则返回预期的 json 响应。

    *   优点：仍然是标准的，因为您使用现有的 HTTP 状态代码并返回描述错误的 json（您提供有关发生情况的更多信息）。
    *   缺点：输出 json 会因错误或成功而异。
3.  **忘记 http 状态**（例如：总是状态 200），总是使用 json 并在响应的根部添加一个布尔值 responseValid 和一个错误对象（代码、消息等），如果它是一个错误则将被填充，否则其他字段（成功）已填充。

    *   优点：客户端仅处理作为 json 字符串的响应主体并忽略状态（？）。

    *   缺点：标准较低。

由你来选择:)

根据 API，我会选择 2 或 3（对于 json rest api，我更喜欢 2）。我在设计 REST Api 时经历的另一件事是每个资源 (url) 文档的重要性：参数、正文、响应、标题等 + 示例。

我还建议您使用 jersey（jax-rs 实现）+ [genson](http://code.google.com/p/genson/)（java/json 数据绑定库）。您只需在类路径中删除 genson + jersey 即可自动支持 json。

**编辑：**

*   解决方案 2 是最难实现的，但优点是您可以很好地处理异常，而不仅仅是业务错误，最初的努力更重要，但从长远来看，您会赢。

*   解决方案 3 在服务器端和客户端都很容易实现，但它不是很好，因为您必须将要返回的对象封装在包含 responseValid + 错误的响应对象中。

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2016-04-03T20:39:32.807

[RFC 7807：HTTP API 的问题详细信息](https://datatracker.ietf.org/doc/rfc7807/)是目前我们拥有的最接近官方标准的东西。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2013-03-13T08:19:54.357

以下是 Instagram 使用的 json 格式

```
{
    "meta": {
         "error_type": "OAuthException",
         "code": 400,
         "error_message": "..."
    }
    "data": {
         ...
    },
    "pagination": {
         "next_url": "...",
         "next_max_id": "13872296"
    }
} 
```

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2013-09-23T07:28:13.023

我不会傲慢地声称这是一个标准，所以我会使用“我更喜欢”的形式。

我更喜欢简洁的响应（当请求 /articles 列表时，我想要一个 JSON 文章数组）。

在我的设计中，我使用 HTTP 进行状态报告，**200**只返回有效负载。

**400**返回请求错误的消息：

```
{"message" : "Missing parameter: 'param'"} 
```

如果模型/控制器/URI 不存在，则返回**404**

如果我这边的处理出现错误，我会返回**501**并显示一条消息：

```
{"message" : "Could not connect to data store."} 
```

从我所看到的情况来看，相当多的 REST-ish 框架倾向于遵循这些原则。

**理由**：

JSON 应该是一种**有效负载**格式，它不是会话协议。冗长的会话式有效负载的整个想法来自 XML/SOAP 世界以及导致这些臃肿设计的各种错误选择。在我们意识到这一切都令人头疼之后，REST/JSON 的全部意义在于亲吻它，并坚持 HTTP。我认为 JSend 中没有任何远程*标准*，尤其是其中更冗长的。XHR 将对 HTTP 响应做出反应，如果您将 jQuery 用于您的 AJAX（就像大多数人一样），您可以使用`try`/`catch`和`done()`/`fail()`回调来捕获错误。我看不出用 JSON 封装状态报告比这更有用。

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2014-04-28T18:45:46.517

为了它的价值，我以不同的方式做这件事。成功的调用只有 JSON 对象。我不需要包含指示 true 的成功字段和具有 JSON 对象的有效负载字段的更高级别的 JSON 对象。对于标头中的 HTTP 状态，我只返回 200 或 200 范围内适当的 JSON 对象。

但是，如果出现错误（400 系列中的某个错误），我会返回一个格式正确的 JSON 错误对象。例如，如果客户端正在使用电子邮件地址和电话号码发布用户，并且其中一个格式错误（即我无法将其插入到我的基础数据库中），我将返回如下内容：

```
{
  "description" : "Validation Failed"
  "errors" : [ {
    "field" : "phoneNumber",
    "message" : "Invalid phone number."
  } ],
} 
```

这里的重要一点是“字段”属性必须与无法验证的 JSON 字段完全匹配。这使客户可以确切地知道他们的请求出了什么问题。此外，“消息”位于请求的语言环境中。如果“emailAddress”和“phoneNumber”都无效，则“errors”数组将包含两者的条目。409（冲突）JSON 响应正文可能如下所示：

```
{
  "description" : "Already Exists"
  "errors" : [ {
    "field" : "phoneNumber",
    "message" : "Phone number already exists for another user."
  } ],
} 
```

有了 HTTP 状态代码和这个 JSON，客户端就拥有了以确定性方式响应错误所需的一切，并且它不会创建一个新的错误标准来尝试完全替换 HTTP 状态代码。请注意，这些仅发生在 400 个错误的范围内。对于 200 范围内的任何内容，我都可以返回合适的内容。对我来说，它通常是一个类似 HAL 的 JSON 对象，但这并不重要。

我想添加的一件事是“错误”数组条目或 JSON 对象本身的根中的数字错误代码。但到目前为止，我们还不需要它。

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2016-07-29T09:50:59.617

他们对大型软件巨头——谷歌、Facebook、Twitter、亚马逊等的其余 api 响应格式没有一致意见，尽管上面的答案中提供了许多链接，其中一些人试图标准化响应格式。

由于 API 的需求可能不同，因此很难让每个人都参与并同意某种格式。如果您有数百万用户使用您的 API，为什么要更改响应格式？

以下是我对受谷歌、推特、亚马逊和互联网上一些帖子启发的响应格式的看法：

[https://github.com/adnan-kamili/rest-api-response-format](https://github.com/adnan-kamili/rest-api-response-format)

招摇文件：

[https://github.com/adnan-kamili/swagger-sample-template](https://github.com/adnan-kamili/swagger-sample-template)

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2012-10-09T19:06:53.060

JSON 的重点在于它是完全动态和灵活的。随心所欲地弯曲它，因为它只是一组序列化的 JavaScript 对象和数组，植根于单个节点。

根节点的类型取决于您，它包含的内容取决于您，是否将元数据与响应一起发送取决于您，是否将 mime-type 设置为`application/json`或保留它`text/plain`取决于您（只要你知道如何处理边缘情况）。

构建您喜欢的轻量级架构。
就个人而言，我发现分析跟踪和 mp3/ogg 服务和图像库服务以及用于在线游戏的文本消息和网络数据包，以及博客文章和博客评论在什么方面**都有*****非常不同的要求***发送和接收什么以及如何使用它们。

因此，在做所有这些时，我最不想做的就是尝试使每个都符合相同的样板标准，该样板标准基于 XML2.0 或类似的东西。

***也就是说，使用对您***有意义且经过深思熟虑的模式有很多话要说。
只需阅读一些 API 响应，记下您喜欢的内容，批评您不喜欢的内容，写下这些批评并理解它们为什么会以错误的方式影响您，然后考虑如何将您学到的知识应用到您需要的东西上。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2014-06-11T22:09:18.443

[JSON-RPC 2.0](http://www.jsonrpc.org/specification)定义了标准的请求和响应格式，在使用 REST API 之后是一股清新的空气。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2019-01-07T23:28:28.743

建议的基本框架看起来不错，但定义的错误对象太有限了。往往不能用一个单一的值来表达问题，而是需要[一连串的问题和原因](https://agiletribe.wordpress.com/2019/01/05/translatable-error-messages/)。

我做了一些研究，发现返回错误（异常）的最常见格式是这种形式的结构：

```
{
   "success": false,
   "error": {
      "code": "400",
      "message": "main error message here",
      "target": "approx what the error came from",
      "details": [
         {
            "code": "23-098a",
            "message": "Disk drive has frozen up again.  It needs to be replaced",
            "target": "not sure what the target is"
         }
      ],
      "innererror": {
         "trace": [ ... ],
         "context": [ ... ]
      }
   }
} 
```

这是 OASIS 数据标准[OASIS OData](http://docs.oasis-open.org/odata/odata-json-format/v4.0/errata02/os/odata-json-format-v4.0-errata02-os-complete.html#_Toc403940655)提出的格式，似乎是目前最标准的选项，但目前似乎没有任何标准的高采用率。这种格式与 JSON-RPC 规范一致。

您可以在以下位置找到实现此功能的完整开源库： [Mendocino JSON Utilities](https://github.com/agilepro/mendocino/blob/master/src/com/purplehillsbooks/json/JSONException.java)。该库支持 JSON 对象以及异常。

[详细信息在我关于JSON REST API 中](https://agiletribe.wordpress.com/2015/09/16/json-rest-api-exception-handling/)的错误处理的博客文章中进行了讨论

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-05-18T18:32:51.453

对于后来者，除了包含 HAL、JSend 和 JSON API 的公认答案外，我还要添加一些其他值得研究的规范：

*   [JSON-LD](https://www.w3.org/TR/json-ld/)，这是 W3C 建议，并指定如何在 JSON 中构建可互操作的 Web 服务
*   [REST 的Ion 超媒体类型](https://ionspec.org/)，它声称自己是“一种简单直观的基于 JSON 的 REST 超媒体类型”

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-03-07T11:36:49.690

我曾经遵循这个标准，在客户端层非常好、简单、干净。

通常情况下，HTTP 状态 200，所以这是我在顶部使用的标准检查。我通常使用以下 JSON

我还使用 API 的模板

```
dynamic response;

try {
   // query and what not.
   response.payload = new {
      data = new {
          pagination = new Pagination(),
          customer = new Customer(),
          notifications = 5
      }
   }

   // again something here if we get here success has to be true
   // I follow an exit first strategy, instead of building a pyramid 
   // of doom.
   response.success = true;
}
catch(Exception exception){
   response.success = false;
   response.message = exception.GetStackTrace();
   _logger.Fatal(exception, this.GetFacadeName())
}

return response;

{ 
  "success": boolean,
  "message": "some message",
  "payload": { 
     "data" : []
     "message": ""
     ... // put whatever you want to here.
  } 
} 
```

在客户端层我将使用以下内容：

```
if(response.code != 200) { 
  // woops something went wrong.
  return;
}

if(!response.success){
  console.debug ( response.message ); 
  return;
}

// if we are here then success has to be true.
if(response.payload) {
  ....
} 
```

请注意我是如何早早打破厄运金字塔的。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-03-30T19:40:54.827

除了常识，没有违法或违法的标准。如果我们将其抽象为两个人交谈，标准是他们可以在最短的时间内用最少的单词准确理解彼此的最佳方式。在我们的例子中，“最少词”是优化带宽以提高传输效率，“准确理解”是提高解析器效率的结构；最终导致数据越少，结构越通用；这样它就可以通过一个针孔并可以通过一个通用范围进行解析（至少在最初）。

几乎在所有建议的情况下，我都会看到“成功”和“错误”场景的不同响应，这对我来说有点模棱两可。如果这两种情况下的反应不同，那么为什么我们真的需要在那里放置一个“成功”标志呢？没有“错误”就是“成功”这不是很明显吗？是否可以在“成功”为 TRUE 并设置“错误”的情况下做出响应？或者，“成功”是假的，没有设置“错误”？一个flag还不够？我宁愿只使用“错误”标志，因为我相信“错误”会比“成功”少。

另外，我们真的应该将“错误”设置为标志吗？如果我想响应多个验证错误怎么办？因此，我发现将每个错误作为该节点的子节点的“错误”节点更有效；其中一个空的（计数为零）“错误”节点表示“成功”。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-05-21T15:23:10.973

我将此结构用于 REST API：

```
{
  "success": false,
  "response": {
    "data": [],
    "pagination": {}
  },
  "errors": [
    {
      "code": 500,
      "message": "server 500 Error"
    }
  ]
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-01-28T00:54:01.813

有点晚了，但这是我对 HTTP 错误响应的看法，我发送代码（通过状态）、通用消息和详细信息（如果我想提供特定端点的详细信息，有些是不言自明的，所以不需要详细信息但它可以是自定义消息，甚至可以是完整的堆栈跟踪，具体取决于用例）。为了成功，它是一个类似的格式、代码、消息和数据属性中的任何数据。

ExpressJS 响应示例：

```
// Error

    res
      .status(422)
      .json({
        error: {
          message: 'missing parameters',
          details: `missing ${missingParam}`,
        }
      });

    // or

    res
      .status(422)
      .json({
        error: {
          message: 'missing parameters',
          details: 'expected: {prop1, prop2, prop3',
        }
      });

 // Success

    res
      .status(200)
      .json({
         message: 'password updated',
         data: {member: { username }}, // [] ...
      }); 
```

* * *

## 回答 #18

> 赞同：-4
> 
> 时间：2018-08-10T04:40:31.603

移动开发人员可以轻松理解的 Web api 的最佳响应。

**这是为了“成功”响应**

```
{  
   "code":"1",
   "msg":"Successfull Transaction",
   "value":"",
   "data":{  
      "EmployeeName":"Admin",
      "EmployeeID":1
   }
} 
```

**这是针对“错误”响应**

```
{
    "code": "4",
    "msg": "Invalid Username and Password",
    "value": "",
    "data": {}
} 
```

# android - 我的操作栏 Holo Light Theme 的意外效果

> ID：12806394
> 
> 赞同：1
> 
> 时间：2012-10-09T18:44:01.803
> 
> 标签：android

我使用 XML 为我的主要活动定义了操作栏的主题，如下所示：

```
<style name="AppTheme" parent="@android:style/Theme.Holo.Light" />

<style name="HomeTheme" 
    parent="@style/AppTheme">
    <item name="android:actionBarStyle">@style/HomeActionBarStyle</item>
</style>

 <style name="HomeActionBarStyle" 
    parent="@android:style/Widget.Holo.ActionBar">
    <item name="android:displayOptions">showHome|showTitle</item>
</style> 
```

然后在我的 Manifest 文件中，我使用定义的 Theme 设置了我的活动的 Theme ：

```
<activity
....
android:theme="@style/HomeTheme"
....
</activity> 
```

一切都按预期进行，除了两件事：1）操作栏区域的边界线仍然是蓝色 2）操作栏区域的背景颜色是白色而不是灰色。

我不确定我的错误可能是什么，或者这只是我的模拟器中的一个错误？我需要解决前两点才能拥有漂亮的 GUI

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:52:18.337

改变

`parent="@android:style/Widget.Holo.ActionBar"`

到

`parent="@android:style/Widget.Holo.Light.ActionBar.Solid"`

默认情况下，标准 ActionBar 下方有蓝线，而不是灰色。固体变体可能是您正在寻找的。

# ruby-on-rails - Rails - Twitter API：如何从 ID 链接获取到 Twitter 个人资料？

> ID：12806396
> 
> 赞同：1
> 
> 时间：2012-10-09T18:44:01.883
> 
> 标签：ruby-on-rails, api, twitter

我从 Twitter API 获取用户 ID（当然在个人资料链接、用户名等旁边）。如何根据用户 ID 显示指向用户个人资料的链接？

例如，Facebook API 也提供用户 ID，如果我把它放到浏览器`www.facebook.com/users_id`中，我会得到他的个人资料......

推特有什么办法吗？`www.twitter.com/users_id`返回空白页...

**编辑：**显然我可以保存用户的 URL（或他的用户名），但相应的用户可以随时更改它......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T20:40:47.437

你叫什么推特“个人资料”？我猜你说的是[用户时间线](https://dev.twitter.com/docs/api/1/get/statuses/user_timeline)

根据 api 文档，您的 url 应该看起来像这样：

```
https://api.twitter.com/1/statuses/user_timeline.html?&user_id=(your_id_here) 
```

但是，我建议使用其中一种[twitter api gem](https://dev.twitter.com/docs/twitter-libraries#ruby)来缓解您的痛苦……

# java - Java中的实数或值是什么意思以及Java中原始类型的非常基本的解释

> ID：12806400
> 
> 赞同：7
> 
> 时间：2012-10-09T18:44:16.963
> 
> 标签：java, primitive

引用 Java 书籍中的一句话“我建议坚持为实数输入 double 类型”以及“对于实数值，您应该坚持使用 double 类型”。我不明白实数或值是什么意思...实数与什么相对？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-09T18:47:25.237

[实数](http://en.wikipedia.org/wiki/Real_number)而不是[整数](http://en.wikipedia.org/wiki/Integer)。在数学中，实数可以是连续谱中的任何值，例如`4.2`或 pi。整数是实数的子集。

[这](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)是Java原语。一些重要的数字包括`int`何时需要整数和`double`何时允许分数。如果你偏离了这些，你通常有一个特定的理由这样做。

整数很容易用二进制表示，并且很容易指定可以用指定位数精确表示的整数的特定范围。Java 中的 An`int`使用 32 位并将您从 -2,147,483,648 变为 2,147,483,647。其他整数类型类似，但位数不同。

但是，沿连续体表示数字更加困难。在实数线上的任意两点之间，还有无穷多个其他实数。因此，不可能准确地表示一个区间中的所有实数。解决此问题的一种方法是使用[浮点数](http://en.wikipedia.org/wiki/Floating_point)。我不会过多介绍细节，但基本上会丢失一些精度，因此可以准确表示的内容存在差距。出于许多目的，这无关紧要，但对于跟踪银行账户余额之类的事情，这可能很重要。可能值得一读著名的[What Every Computer Scientist Should Know About Floating-Point Arithmetic](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)。

在 Java 中，解决其中一些问题的一种方法包括使用类似[`BigDecimal`](http://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html). 其他一些语言可能会提供其他原语作为替代方案。例如，C# 有[`decimal`](http://msdn.microsoft.com/en-us/library/364x0z75%28v=vs.80%29.aspx)数据类型，而 Java 没有。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-09T18:46:18.437

实数表示浮点数，即`double`or `float`，而不是整数 ( `int`or `long`)

# ios - 从 iPhone 中获取二进制文件

> ID：12806403
> 
> 赞同：1
> 
> 时间：2012-10-09T18:44:33.847
> 
> 标签：ios, export, binaryfiles, binary-data

我的 iPhone 应用程序正在创建一个二进制文件（最大 20MB）。我想保存这个二进制文件并将其导出到我的 Mac。这严格用于开发而不是提交到 App Store。关于最佳实践的任何建议/建议？我正在考虑电子邮件的附件，但想问问你们中的一些专家是否有更好的方法。提前谢谢了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:55:25.210

If you are doing this just for the development try to add `Application supports iTunes file sharing` (UIFileSharingEnabled) to your app's Info.plist file with YES value to enable sharing via iTunes.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T18:58:10.060

打开 XCode -> Organizer -> Applications -> Your APP -> 选择它并按下载 所有应用程序数据将被下载到存档，有你的文件

# wordpress - 允许重复的分类蛞蝓 wordpress

> ID：12806409
> 
> 赞同：0
> 
> 时间：2012-10-09T18:44:48.873
> 
> 标签：wordpress, taxonomy

我正在尝试在我的主题中建立一个分层分类法，它也使用分层 slug 重写。

我有汽车品牌作为自定义分类。这将列出本田、丰田等类别……</p>

然后在每个品牌下，它会根据地理按子类别细分，例如

本田 - 阿拉巴马州 - 德克萨斯州 丰田 - 阿拉巴马州 - 德克萨斯州

我遇到的问题是有多个相同名称的子类别存在于不同的主要类别中，但完全独立。

示例：xyz.com/honda/alabama xyz.com/toyota/alabama-2

Wordpress 在第二个类别的末尾附加一个 -2。有没有办法防止永久链接中的-2？

还是有更好的方法来构建分类？

我想要的结果是：

xyz.com/honda/alabama xyz.com/toyota/Alabama

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-22T21:21:35.190

我很高兴终于找到了解决这个问题的方法。可以在此处找到详细说明：[http](http://www.cuberis.com/2013/07/wordpress-duplicate-slugs-for-different-post-types/) ://www.cuberis.com/2013/07/wordpress-duplicate-slugs-for-different-post-types/ 。

这篇文章基本上说这是一个已知问题，有[一个可用的补丁](http://core.trac.wordpress.org/attachment/ticket/18962/wp-includes_post.diff)[，](http://core.trac.wordpress.org/ticket/18962)但该补丁需要编辑核心文件，可以使用以下功能解决（如果需要）：

```
function wp_cpt_unique_post_slug($slug, $post_ID, $post_status, $post_type, $post_parent, $original_slug) {
if ( in_array( $post_status, array( 'draft', 'pending', 'auto-draft' ) ) )
return $slug;

global $wpdb, $wp_rewrite;

// store slug made by original function
$wp_slug = $slug;

// reset slug to original slug
$slug = $original_slug;

$feeds = $wp_rewrite->feeds;
if ( ! is_array( $feeds ) )
$feeds = array();

$hierarchical_post_types = get_post_types( array('hierarchical' => true) );
if ( 'attachment' == $post_type ) {
// Attachment slugs must be unique across all types.
$check_sql = "SELECT post_name FROM $wpdb->posts WHERE post_name = %s AND ID != %d LIMIT 1";
$post_name_check = $wpdb->get_var( $wpdb->prepare( $check_sql, $slug, $post_ID ) );

if ( $post_name_check || in_array( $slug, $feeds ) || apply_filters( 'wp_unique_post_slug_is_bad_attachment_slug', false, $slug ) ) {
$suffix = 2;
do {
$alt_post_name = substr ($slug, 0, (200 - ( strlen( $suffix ) + 1 ) )) . "-$suffix";
$post_name_check = $wpdb->get_var( $wpdb->prepare($check_sql, $alt_post_name, $post_ID ) );
$suffix++;
} while ( $post_name_check );
$slug = $alt_post_name;
}
} elseif ( in_array( $post_type, $hierarchical_post_types ) ) {
if ( 'nav_menu_item' == $post_type )
return $slug;
// Page slugs must be unique within their own trees. Pages are in a separate
// namespace than posts so page slugs are allowed to overlap post slugs.
$check_sql = "SELECT post_name FROM $wpdb->posts WHERE post_name = %s AND post_type = %s AND ID != %d AND post_parent = %d LIMIT 1";
$post_name_check = $wpdb->get_var( $wpdb->prepare( $check_sql, $slug, $post_type, $post_ID, $post_parent ) );

if ( $post_name_check || in_array( $slug, $feeds ) || preg_match( "@^($wp_rewrite->pagination_base)?d+$@", $slug ) || apply_filters( 'wp_unique_post_slug_is_bad_hierarchical_slug', false, $slug, $post_type, $post_parent ) ) {
$suffix = 2;
do {
$alt_post_name = substr( $slug, 0, (200 - ( strlen( $suffix ) + 1 ) )) . "-$suffix";
$post_name_check = $wpdb->get_var( $wpdb->prepare( $check_sql, $alt_post_name, $post_type, $post_ID, $post_parent ) );
$suffix++;
} while ( $post_name_check );
$slug = $alt_post_name;
}
} else {
// Post slugs must be unique across all posts.
$check_sql = "SELECT post_name FROM $wpdb->posts WHERE post_name = %s AND post_type = %s AND ID != %d LIMIT 1";
$post_name_check = $wpdb->get_var( $wpdb->prepare( $check_sql, $slug, $post_type, $post_ID ) );

if ( $post_name_check || in_array( $slug, $feeds ) || apply_filters( 'wp_unique_post_slug_is_bad_flat_slug', false, $slug, $post_type ) ) {
$suffix = 2;
do {
$alt_post_name = substr( $slug, 0, (200 - ( strlen( $suffix ) + 1 ) )) . "-$suffix";
$post_name_check = $wpdb->get_var( $wpdb->prepare( $check_sql, $alt_post_name, $post_type, $post_ID ) );
$suffix++;
} while ( $post_name_check );
$slug = $alt_post_name;
}
}

return $slug;
}
add_filter('wp_unique_post_slug', 'wp_cpt_unique_post_slug', 10, 6); 
```

该函数应包含在主题的 functions.php 文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-06T22:52:25.213

技术上的答案是您需要重新组织类别，WordPress 不执行它，不是很有帮助，但是您可以。从业务角度来看，我们使用（付费）插件来允许重复的 slug，它应该是内置在 WordPress 中的，但你去吧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-18T03:53:34.483

您可以使用页面而不是帖子来执行此操作。改用页面来重构您的网站。

# ios - 如何防止具有自定义属性的 UIBarButtonItem 改变大小

> ID：12806413
> 
> 赞同：5
> 
> 时间：2012-10-09T18:44:57.267
> 
> 标签：ios, cocoa-touch, ios5

我在 iPad 应用程序（iOS 5.1）顶部的 UIToolbar 中有一个 UIBarButtonItem。我在 Interface Builder 中将其宽度设置为 65。它的样式为“镶边”，标识符为“自定义”。按下时文本标签和色调会发生变化：

```
 [btnA setTitle:@"State A"];
    [btnA setTintColor:[UIColor STATE_A_COL]; 
```

等等，采用各种标签和颜色。这很好用，即使各个州的标题长度完全不同，按钮也没有调整大小。

然后我添加了这段代码来设置字体，在启动时：

```
UIFont * futura = [UIFont fontWithName:@"Futura" size:13];
NSDictionary *attributes = [NSDictionary dictionaryWithObject:futura
                                                       forKey:UITextAttributeFont];
[btnA setTitleTextAttributes:attributes forState:UIControlStateNormal]; 
```

现在，按钮的大小适合它在启动时的标题宽度。它随着标题的变化而改变大小。如何锁定尺寸？我不明白这里的相互作用；我以为我所做的只是更改标题字体属性，而不是按钮的任何其他内容。

我也尝试过明确设置`width`属性：

```
[btnA setWidth:65.0]; 
```

再次无济于事。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T19:29:53.890

我`UIBarButtonItem`通过使用该`possibleTitles`属性来停止调整大小，以提示所需的最大宽度。

```
[btnA setPossibleTitles:[NSSet setWithObjects:@"State A', @"B", @"Final state", nil]]; 
```

这行得通，但我无法将宽度明确设置为我想要的大小，所以我把这个问题留了下来。

# jquery - 右键单击后鼠标悬停在标记上不再起作用

> ID：12806417
> 
> 赞同：0
> 
> 时间：2012-10-09T18:45:22.993
> 
> 标签：jquery, jquery-gmap3

在这里查看我的小提琴[http://jsfiddle.net/WEZVX/2/](http://jsfiddle.net/WEZVX/2/)

请注意，当您将鼠标悬停在标记上时，您会看到显示用户名的叠加层。

然后，如果您右键单击标记以显示菜单并让它关闭。

以前的鼠标悬停不再显示？

知道为什么以及如何解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:10:16.893

通过向上下文菜单覆盖添加标签来修复它

[http://gmap3.net/forum/viewtopic.php?id=229](http://gmap3.net/forum/viewtopic.php?id=229)

然后仅通过标签在菜单上调用 clear 。

# html - 制作具有灵活中间的 3 列网格

> ID：12806418
> 
> 赞同：1
> 
> 时间：2012-10-09T18:45:26.230
> 
> 标签：html, css, dynamic-columns, two-columns

我解决了我遇到的一个问题，我认为该解决方案可能对其他人有所帮助。

我需要有一个 3 列布局，具有固定的左右列和灵活的中心。它需要填充列之间的空间，无论它如何更改，因此无法修复。这很奇怪，似乎不会起作用，但它就像魔术一样。

我修改了放在一起的内容[http://jsfiddle.net/qx32C/36/](http://jsfiddle.net/qx32C/36/)

这是我的 3 列版本的演示[http://jsfiddle.net/chazthetic/qx32C/294/](http://jsfiddle.net/chazthetic/qx32C/294/)

HTML

```
<div class="container">
<div class="right">lkasjdfl;<br />kjasdf;<br />lkjas;<br />ldfkjdjf</div>
<div class="lineContainer">
    <div class="left">lkasjdfl;<br />kjasdf;<br />ldfkja;<br />sldfjk;laksdjf</div>
    <div class="middle">lkasjdfl;<br />kjasdf;<br />lkjas;</div>
</div> 
```

​</p>

CSS

```
.lineContainer {
    overflow: hidden; /* clear the float */
    border: 1px solid #000
}
.lineContainer div {
    height: auto;
} 
.left {
    width: 100px;
    float: left;
    border-right: 1px solid #000
}
.middle {
    margin-left: 100px;
    background: #ccc
}
.right {
    width: 100px;
    float: right;
    border: 1px solid #000
}
​ 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-09T19:20:31.523

你也应该把中间的左边浮动。这将允许元素都依赖于浏览器的大小。

```
.left {
    width: 100px;
    float: left;
    border-right: 1px solid #000
}
.middle {
    float:left;
    background: #ccc
}
.right {
    width: 100px;
    float: right;
    border: 1px solid #000
} 
```

​</p>

# plsql - PL-SQL 将查询结果存储到变量中

> ID：12806421
> 
> 赞同：0
> 
> 时间：2012-10-09T18:45:33.257
> 
> 标签：plsql

再会，

我有一个如下的 PL-SQL 查询。我正在尝试执行查询并将结果存储到变量中。到目前为止，我有这个有效的查询：

```
 SELECT DECODE(COUNT(*), 0, 'N', 'Y') REC_EXISTS
    FROM
         (SELECT 
                COUNT(*) AS TOTAL_COUNT
           FROM DEV.BASEOBJECT INNER JOIN
                DEV.ANIMAL ON DEV.BASEOBJECT.ID = DEV.ANIMAL.BASEOBJECT_ID
       GROUP BY DEV.BASEOBJECT.ID, 
                DEV.BASEOBJECT.FIRST_NAME, 
                DEV.BASEOBJECT.LAST_NAME, 
                DEV.BASEOBJECT.CITY,
                DEV.BASEOBJECT.STATE,
                DEV.BASEOBJECT.ZIP,
                DEV.ANIMAL.ID,
                DEV.ANIMAL.NAME,
                DEV.ANIMAL.BREED, 
                DEV.ANIMAL.DATE_OF_BIRTH, 
                DEV.ANIMAL.GENDER,
                DEV.ANIMAL.SPECIES
         HAVING (COUNT(*) > 1)); 
```

但是，当我尝试使用此查询将结果保存到变量中时：

```
DECLARE
    v_name  VARCHAR2(2);
BEGIN
    SELECT DECODE(COUNT(*), 0, 'N', 'Y') REC_EXISTS
        INTO v_name
    FROM
         (SELECT 
                COUNT(*) AS TOTAL_COUNT
           FROM DEV.BASEOBJECT INNER JOIN
                DEV.ANIMAL ON DEV.BASEOBJECT.ID = DEV.ANIMAL.BASEOBJECT_ID
       GROUP BY DEV.BASEOBJECT.ID, 
                DEV.BASEOBJECT.FIRST_NAME, 
                DEV.BASEOBJECT.LAST_NAME, 
                DEV.BASEOBJECT.CITY,
                DEV.BASEOBJECT.STATE,
                DEV.BASEOBJECT.ZIP,
                DEV.ANIMAL.ID,
                DEV.ANIMAL.NAME,
                DEV.ANIMAL.BREED, 
                DEV.ANIMAL.DATE_OF_BIRTH, 
                DEV.ANIMAL.GENDER,
                DEV.ANIMAL.SPECIES
         HAVING (COUNT(*) > 1));
END 
```

我收到一个错误：

```
ERROR
ORA-06550: line 1, column 8:
PLS-00103: Encountered the symbol "" when expecting one of the following:

   begin function package pragma procedure subtype type use
   <an identifier> <a double-quoted delimited-identifier> form
   current cursor
The symbol "" was ignored. 
```

最终，这将是一个存储过程，但我还没有准备好那部分，因为我想验证我所拥有的到目前为止是否有效。

TIA,

科森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:11:00.830

你怎么运行这个？你使用什么工具？我认为问题在于您的工具/IDE 正在尝试将其编译为函数/过程。这段代码*看起来*不错，如果您在 SQL*Plus 中将其作为脚本运行，它可能会毫无问题地运行。如果将其作为脚本运行，则应`dbmbs_output.put_line(v_name)`在查询后添加一个以查看结果。

# sql - 读取从另一个正在进行的事务中插入的行数

> ID：12806425
> 
> 赞同：1
> 
> 时间：2012-10-09T18:45:43.577
> 
> 标签：sql, sql-server, sql-server-2012

我有一笔交易，类似于

```
BEGIN TRANSACTION

INSERT INTO Table2 WITH(TABLOCK)
   SELECT BLAH 
   FROM Table

COMMIT TRANSACTION 
```

此交易最多可能需要一个小时才能完成。

我想运行一个查询，有点像：

```
SELECT COUNT(*) FROM Table2 
```

定期在一个完全不同的线程上报告到目前为止已经插入了多少行。

这可能吗？有没有办法查询未提交的行数？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:49:32.937

在查询中添加 WITH (NOLOCK) 提示。

```
SELECT COUNT(*) FROM Table2 WITH (NOLOCK); 
```

在开始事务之前进行基线计数，然后从当前数字中减去该值以获得新插入的行数。

# android - Android Webview css错误

> ID：12806429
> 
> 赞同：1
> 
> 时间：2012-10-09T18:45:49.733
> 
> 标签：android, css, android-webview

我的 android 应用程序以独特的 html 将 Web 应用程序加载到 webview 中。

我的 css 很大，像 350kb。有时在慢速连接（主要是 EDGE）中，并非所有样式似乎都能正确加载。

某些图像（我正在使用数据 uri）丢失，并且某些部分根本不加载 css 样式。我试图将样式内联放在页面中（假设 css 文件出错）但没有效果。

看起来 android webview 只是停止了 css 解析并显示了页面。有没有人经历过这样的事情？我怎样才能以一种好的方式解决这个问题？

我只在姜饼中测试过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:57:10.270

我认为使用基于网络的移动应用程序比桌面设备更轻，因为这些设备的连接速度较慢。您是否尝试过分离 css 以查看此问题是否是由于大负载造成的？

# objective-c - 在导航控制器 (XCode) 中创建滚动类别部分

> ID：12806431
> 
> 赞同：0
> 
> 时间：2012-10-09T18:46:11.270
> 
> 标签：objective-c, uiscrollview, uitabbar, categories, uinavigationcontroller

所以我很好奇。我正在寻找一种方法来创建类似于位于此应用程序顶部的类别选择器：http: [//itunes.apple.com/us/app/xfeed-rss-reader/id313206921](https://i.stack.imgur.com/Oh8kY.jpg) ?mt=8 .. . 06921?mt=8。我会使用工具栏来解决这个问题，并将其拉长到用户可以“滚动”类别的位置吗？还是一个带有 Tabbar 的 ScrollView？我想按照“正确”的方式执行此操作，并且我已经看到有关 Tabbar 位于 ScrollView 中的标志。

![在此处输入图像描述](../Images/7ee3a026a6394c73fa2a86ac3426477c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T21:39:01.813

如果我正在实现它，我将使用包含 UIButtons 的 UIScrollView 创建它。UITabBars 与 UIViewControllers 和 UINavigationControllers 有一些很好的集成，但是当您需要更多可定制的行为（例如，从左到右滚动）时，好处很快就会下降。我通常会将它们全部放在 xib 中并适当地连接插座，除非它们是动态的很重要。

您提到了正确性，因此更“正确”的方法是创建一个类似于 UISegmentedControl 的 UIControl 来处理适当大小的标签的创建，适当地处理触摸等。如果您要动态设置类别，则需要覆盖 sizeThatFits : 并调用 sizeToFit 以便您可以正确调整滚动视图的内容区域。

# c# - ASP .Net：根据用户输入动态过滤 ListView 项目

> ID：12806436
> 
> 赞同：0
> 
> 时间：2012-10-09T18:46:19.647
> 
> 标签：c#, asp.net, listview, datapager

我有一个带有 DataPager 控件的 ListView。我正在尝试显示一系列问题。每个问题及其选择都属于列表视图中的一个项目，我每页显示一个问题。选项是启用了自动回发的单选按钮。现在，根据用户对第一个问题的回答，我想过滤列表视图中的其余问题，以仅显示与用户选择相关的问题。此外，我不想从列表视图中完全删除其他问题，因为如果用户导航到第一个问题并更改他的回答，我希望列表相应地更改。有没有办法动态隐藏包含不相关问题的页面？

谢谢。

注意：列表项由自定义 sql 查询填充： `SELECT questionNumber,questionText,OptionA,OptionB,OptionC,OptionD,OptionE,OptionF,OptionG,OptionH,OptionI,OptionJ,OptionK,OptionL,Other,questionTag,subType from Questionairre`

在此查询中，“subType”字段中的值应与第一个问题中的选择进行比较。第一个问题的子类型字段将不被检查。以下代码是我到目前为止所拥有的。变量“firstChoice”是存储从第一个问题回发的值的静态变量。

```
 protected void ListView_ItemDataBound(object sender, ListViewItemEventArgs e)
    {
        SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString);

        ListViewDataItem di = (ListViewDataItem)e.Item;

        Label q=new Label();
        foreach(Control control in di.Controls)
        {

            if (control.GetType() == typeof(Label))
            {
                q = (Label)control;

                if (q.ID == "subType" && q.Text != firstChoice)
                    {
                        di.Visible = false;

                    }
            }
        }

    } 
```

# wpf - DataTemplate 可以绑定到嵌套类吗？

> ID：12806438
> 
> 赞同：12
> 
> 时间：2012-10-09T18:46:23.537
> 
> 标签：wpf, xaml, mvvm, datatemplate, nested-class

XAML 中的 DataTemplate 可以与嵌套类关联吗？

我正在开发一个 MVVM 应用程序，并且遇到了数据模板问题。我有一个视图模型，为项目控件提供其他视图模型的集合。这些项目是定义为外部视图模型中嵌套类的层次结构的一部分。到目前为止，我一直无法在 XAML 中创建一个映射来引用内部嵌套类。

这是类层次结构（为简洁起见）：

```
public class MainViewModel
{
    public class A
    {
    }

    public class B : A
    {
    }

    public class C : A
    {
    }

    public ObservableCollection<A> Items
    {
        get;
        set;
    }
} 
```

在 XAML 中，我试图将 DataTemplate 映射到类型 B 和 C，但我无法完全限定嵌套类名称。

```
<ItemsControl ItemsSource="{Binding Path=Items}">
    <ItemsControl.Resources>
        <DataTemplate DataType="{x:Type ns:BracingViewModel.B}">
            <Grid>
            ....
            </Grid>
        </DataTemplate>
        <DataTemplate DataType="{x:Type ns:BracingViewModel.C}">
            <Grid>
            ....
            </Grid>
        </DataTemplate>
    </ItemsControl.Resources>
</ItemsControl> 
```

问题：对嵌套类的引用在 XAML 中显示为构建错误。我得到以下信息：

```
Error   5   Cannot find the type 'ns:B'. Note that type names are case sensitive. Line...

Error   5   Cannot find the type 'ns:C'. Note that type names are case sensitive. Line... 
```

如果我将 A、B、C 类层次结构移到 MainViewModel 类之外（即到命名空间级别），这可以正常工作。

作为一般习惯，我尝试保持与视图模型相关的类定义为其中的嵌套类，但这导致我遇到了这个问题。

所以，我的问题是：甚至可以将 DataTemplate 与嵌套类相关联吗？如果是这样，在 XAML 部分中是如何完成的？

在此先感谢...乔

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-10-09T19:36:48.073

这对我有用：

```
 <ItemsControl ItemsSource="{Binding Path=Items}">
        <ItemsControl.Resources>
            <DataTemplate DataType="{x:Type ns:MainViewModel+B}">
                <Grid Background="Blue"
                      Width="30"
                      Height="30">

                </Grid>
            </DataTemplate>
            <DataTemplate DataType="{x:Type ns:MainViewModel+C}">
                <Grid Background="Chartreuse" Width="30" Height="30">

                </Grid>
            </DataTemplate>
        </ItemsControl.Resources>
    </ItemsControl> 
```

换句话说，只需`.`将标记扩展`+`中的`x:Type`

归功于：[这个线程](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/12f3e120-e217-4eee-ab49-490b70031806/)

# css - IE7 中的浮动项目中断，在 IE8+ 中有效

> ID：12806446
> 
> 赞同：2
> 
> 时间：2012-10-09T18:46:45.187
> 
> 标签：css, internet-explorer

我有一个开发站点（[http://www.tentenstudios.com/clients/swls/our-surgeon](http://www.tentenstudios.com/clients/swls/our-surgeon)）在 FF、Chrome 和 IE8+ 中运行良好，但在 IE7 中右角图像中断，我不能似乎找出导致问题的原因。右上角的图像在一个左浮动的容器 DIV 中，但它上面还有一个绝对定位的图形，不确定这是否与它有关。

感谢任何人都可以提供的任何帮助！

根据请求，这是一个带有（我认为）相关代码的 JSFiddle：http: [//jsfiddle.net/HyVcG/](http://jsfiddle.net/HyVcG/)

另外，要查看这项工作，您可以使用 IE 打开链接并按 F12 以调出开发控制台，然后单击浏览器模式：IE9 并将其更改为 IE7。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T19:16:22.897

`.eightcol`宽度和内边距`.fourcol`加起来超过 100%。某些浏览器可能会以不同于其他浏览器的方式舍入十进制值。

```
65.4546% + 3.63636% + 30.9091% = 100.00006% 
```

这是一个[jsfiddle 演示](http://jsfiddle.net/Matt_Coughlin/AvXXC/)，您可以在其中看到右列在 IE6/7 中中断，但在所有其他浏览器中都很好。

这个 CSS 网格可能不是为支持 IE6/7 而构建的。如果一切都失败了，您可以编辑或覆盖 CSS 网格中的一些宽度或边距值。但是每次升级 CSS 网格时都必须重新应用这些更改。不确定是否有更简单的解决方案。

**编辑：**出于比较的目的，这里有一个版本的[jsfiddle 演示](http://jsfiddle.net/Matt_Coughlin/AvXXC/1/)，其中整数百分比加起来正好是 100%。

# asp.net - 在后面的代码中的下拉列表中获取错误的值

> ID：12806447
> 
> 赞同：-1
> 
> 时间：2012-10-09T18:46:46.293
> 
> 标签：asp.net, drop-down-menu

我已经阅读了一些不同的例子，对于那些不完全了解asp.net页面生命周期的人来说，这似乎是一个明显的新手问题，抱歉还在学习。我的修复尝试都没有成功。

aspx：

```
...
<%
for( int j = 0; j < 11; j++)
{
  ChildWeightPounds.Items.Add( new ListItem(j.ToString(),j.ToString()));
}
%>
<asp:DropDownList ID="ChildWeightPounds" runat="server" OnSelectedIndexChanged="DropDownListSelected">
     <asp:ListItem Value="">-Select-</asp:ListItem>
</asp:DropDownList>
...
<asp:Button ID="InsertButton" runat="server" Text="Submit" OnClick="InsertButton_Click" /> 
```

aspx.cs：

```
protected void InsertButton_Click(object sender, EventArgs e)
{
   foreach (Control c in NewPatientForm.Controls)
    {
        ....
        if (c is TextBox)
        {
             TextBox tb = (TextBox)c;
             //Expected response:
             Response.Write( "field: " + tb.ID + " = " + tb.Text + "<br />");
        }
        if (c is DropDownList)
        {
            DropDownList ddl = (DropDownList)c;

            //Unexpected response: 
            //this is not giving me my selected value, but only the top item ("--select--")
            Response.Write("field: " + ddl.ID + ", selectedItem: " + ddl.SelectedItem.Value + "<br />");
         }
    }
 } 
```

很明显，这是一个 IsPostBack，DataBind()，我对页面生命周期缺乏了解的问题。但是没有意义的是，我正在遍历所有控件，并且文本框、复选框、复选框列表都可以正常工作，并在字段中给我值，由于某种原因，下拉列表没有给我值。

我尝试过使用 OnSelectedIndexChanged 事件，也尝试过使用 DataBind() 函数，但是玩这些，仍然没有得到我的价值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:52:53.817

The biggest issue with your example is you are using inline C# within your page with `<% %>`. This isn't advised for `asp.net`. That's more of a legacy/classic ASP approach which won't play well with .NET for many reasons.

Try moving your code that adds the items to the `dropdownlist` from the markup file into the .cs file, and be sure to hook into a page event that happens at or before `OnPreRender`. That is the last point you can alter the page controls and have viewstate/lifecycle work correctly.

```
protected void Page_Load(object sender, EventArgs e)
{
    for( int j = 0; j < 11; j++)
    {
        ChildWeightPounds.Items.Add( new ListItem(j.ToString(),j.ToString()));
    }
} 
```

It's likely without running your example that the values are being inserted into the `dropdownlist` at the incorrect time in the `lifecycle`, and because of that when you try to access the selected value in the code behind it doesn't work.

Consider the following article on asp.net [lifecycle](http://msdn.microsoft.com/en-us/library/ms178472%28v=vs.100%29.aspx) which may assist you.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:52:15.477

您可以`AutoPostBack="true"`在 DropDownList 上进行调整，并定义`OnSelecIndexChanged event`

```
 <asp:DropDownList ID="ChildWeightPounds" runat="server"
         OnSelectedIndexChanged="DropDownListSelected" AutoPostBack="true>
         <asp:ListItem Value="">-Select-</asp:ListItem>
    </asp:DropDownList> 
```

代码背后

```
void DropDownListSelected(Object sender, EventArgs e)
{
 var value =  ChildWeightPounds.SelectedValue;
} 
```

# c++ - 相当于 c++ 中的 Console.ReadLine()

> ID：12806450
> 
> 赞同：18
> 
> 时间：2012-10-09T18:46:51.940
> 
> 标签：c++, string, scanf, readline

![截屏](../Images/c0a5661689988b217bdb34eef6939ba6.png) 我的老师刚刚给了我一个 c++ 作业，我试图用 scanf 获取一个字符串，但它只输入最后一个字符。任何人都可以帮助我吗？我正在寻找与 c++ 中的 console.readline() 等效的东西。

编辑：我还必须能够通过指针存储值。

所以图片显示了当前在后台运行的代码，它应该在没有保证的情况下停止：并等待输入，但它跳过了它。

getline(cin, ptrav->nam); 有效，但由于某种原因它跳过了一行......

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-10-09T18:49:26.777

您正在寻找`std::getline()`. 例如：

```
#include <string>
std::string str;
std::getline(std::cin, str); 
```

*当您说我还必须能够通过指针存储值*时，我几乎不知道您的意思。

**更新：**查看您更新的问题，我可以想象发生了什么。读取选项的代码，即数字 1、2 等，没有读取换行符。然后你调用`getline`which 消耗换行符。然后你`getline`再次调用它来获取字符串。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-09T19:11:58.703

根据[MSDN， Console::ReadLine](http://msdn.microsoft.com/en-us/library/system.console.readline.aspx)：

```
Reads the next line of characters from the standard input stream. 
```

C++ 变体（不涉及指针）：

```
#include <iostream>
#include <string>

 int main()
{
 std::cout << "Enter string:" << flush;
 std::string s;
 std::getline(std::cin, s);
 std::cout << "the string was: " << s << std::endl;
} 
```

* * *

C-Variant（带有缓冲区和指针）也适用于 C++ 编译器，但不应使用：

```
 #include <stdio.h>
 #define BUFLEN 256

 int main()
{
 char buffer[BUFLEN];   /* the string is stored through pointer to this buffer */
 printf("Enter string:");
 fflush(stdout);
 fgets(buffer, BUFLEN, stdin); /* buffer is sent as a pointer to fgets */
 printf( "the string was: %s", buffer);
} 
```

* * *

根据您的代码示例，如果您有一个结构`patient`（在大卫赫弗曼的评论后更正）：

```
struct patient {
   std::string nam, nom, prenom, adresse;
}; 
```

然后，以下应该起作用（在[DavidHeffernan](https://stackoverflow.com/a/12806484/170194)通过逻辑思维解决了`ios::ignore`附加问题后添加）。请**不要**在您的代码**中**使用。**`scanf`**

 ****```
...
std::cin.ignore(256); // clear the input buffer

patient *ptrav = new patient;

std::cout << "No assurance maladie : " << std::flush;
std::getline(std::cin, ptrav->nam);
std::cout << "Nom : " << std::flush;
std::getline(std::cin, ptrav->nom);
std::cout << "Prenom : " << std::flush;
std::getline(std::cin, ptrav->prenom);
std::cout << "Adresse : " << std::flush;
std::getline(std::cin, ptrav->adresse);
... 
```****

# graph - 统一成本搜索和 Dijkstra 算法有什么区别？

> ID：12806452
> 
> 赞同：80
> 
> 时间：2012-10-09T18:47:06.547
> 
> 标签：graph, artificial-intelligence

*我想知道统一成本搜索*和*Dijkstra 算法*之间有什么区别。它们似乎是相同的算法。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-10-18T15:37:42.987

> Dijkstra 的算法，也许更广为人知，可以看作是统一成本搜索的一种变体，其中没有目标状态并且处理继续进行，直到所有节点都已从优先级队列中移除，即直到所有节点的最短路径 (不只是一个目标节点）已经确定

[http://en.wikipedia.org/wiki/Uniform-cost_search#Relationship_to_other_algorithms](http://en.wikipedia.org/wiki/Uniform-cost_search#Relationship_to_other_algorithms)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2013-01-29T16:26:42.527

Dijkstra 的算法在图中搜索*从根到每个其他节点的最短路径，而统一成本**根据到目标节点*的成本搜索最短路径。

此外，统一成本具有较少的空间需求，而优先级队列是“懒惰”填充的，这与 Dijkstra 的相反，后者在开始时以无限成本将所有节点添加到队列中。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2016-09-08T17:17:17.580

NotAUser、dreaMone 和 Bruno Calza 的其他答案汇编

Dijkstra 算法找到从根节点到每个其他节点的最短路径。uniform cost 根据从根节点到目标节点的成本搜索最短路径。统一成本搜索是 Dijkstra 的算法，它专注于寻找到单个终点的最短路径，而不是到每个点的最短路径。

UCS 通过在找到终点后立即停止来实现这一点。对于 Dijkstra，没有目标状态，并且处理继续进行，直到所有节点都从优先级队列中移除，即直到确定了到所有节点（不仅仅是目标节点）的最短路径。

UCS 的空间需求较少，优先级队列逐渐填充，而 Dijkstra 的优先级队列在开始时将所有节点添加到队列中，成本是无限的。

由于以上几点，Dijkstra 比 UCS 更耗时

UCS 通常用在树上，而 Dijkstra 用在一般图上

Djikstra 仅适用于将整个图作为输入的显式图。UCS 从源顶点开始，逐渐遍历图的必要部分。因此，它适用于显式图和隐式图（生成状态/节点的地方）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-14T00:19:37.263

有一篇论文讨论了两者的异同。

[http://www.aaai.org/ocs/index.php/SOCS/SOCS11/paper/view/4017/4357](http://www.aaai.org/ocs/index.php/SOCS/SOCS11/paper/view/4017/4357)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-08-20T16:45:21.590

主要区别在于，*Dijkstra 算法*是在顶点数有限时定义的。它说将所有顶点放入队列中。但是当顶点数趋于无限时，我们不能将所有顶点放入队列中。*统一成本搜索*是在这样的情况下定义的，其中顶点的数量是未知的。

# sql-server-2008 - 将 RDLC 从 2008 升级到 2010（2005 报告到 2008 报告）错误

> ID：12806462
> 
> 赞同：1
> 
> 时间：2012-10-09T18:47:44.520
> 
> 标签：sql-server-2008, reporting-services

多年来，我创建了多个报告，只要在 VS2010 中打开 RDLC 文件，它就会要求升级。我看过很多关于更改 .config 文件的帖子，但是这些文件没有使用配置文件，因为它们是基于应用程序的。我在实验室机器上安装了 Microsoft.ReportViewer.Winforms、.Common、.ProcessingObjectModel 和 .WebForms 9.0 和 8.0。

升级报告并尝试在实验室机器（ms server 2008）上运行它后，我收到以下错误：“报告定义的目标命名空间无效'http://schemas.microsoft.com/sqlserver/reporting/2008 /01/reportdefinition' 无法升级。

Report Viewer 2010 Redistributable Package 能否解决此问题？我找不到明确的答案。如果没有，是否有另一种解决方法而不将服务器模式从本地更改为服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:24:50.117

您真的应该使用 SQL Server Business Intelligence Development Studio (BIDS) 打开那些，它可以在程序菜单上的 Microsoft SQL Server 2008R2 文件夹下找到。

# c - 在C中为结构中的数组分配顺序内存地址

> ID：12806472
> 
> 赞同：4
> 
> 时间：2012-10-09T18:48:30.567
> 
> 标签：c, arrays, memory-management, struct, malloc

我想知道如何为另一个结构内的结构数组分配顺序内存。假设我有 struct1，它有一个 struct2 数组，我想把它全部放在一个连续的内存块中。

我可以使用 malloc 来分配块，但我将如何分配数组的内存？

```
struct1 *set = malloc(sizeof(struct1) + sizeof(struct2)*number_of_structs);
set->arr = (struct2*)set + sizeof(struct); //This is probably wrong
set->arr[0].data = 1;
set->arr[1].data = 2; 
... 
```

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:54:09.827

使用*灵活的数组成员*：

```
#define NUM_ELEM  42

struct a {
   /* whatever */    
};

struct b {
    int c;
    struct a d[];  // flexible array member
};

struct b *x = malloc(sizeof *x + NUM_ELEM * sizeof x->d[0]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T18:56:12.447

这种方式在一些 Windows API 中使用，它可能看起来像这样：

```
struct struct1
{
     // some members ...

     struct struct2 arr[1];
}

struct1 *set = malloc(sizeof(struct1) + sizeof(struct2) * (number_of_structs-1)); 
```

set->arr 指向`number_of_structs`成员数组。struct1 始终包含至少一个 struct2 内部 + 连续内存块中的其他 struct2 成员。

# go - 动态解析文件

> ID：12806474
> 
> 赞同：2
> 
> 时间：2012-10-09T18:48:47.160
> 
> 标签：go, go-templates

对于解析文件，我为 template.ParseFiles 设置了一个变量，我目前必须手动设置每个文件。

两件事情：

我如何能够遍历一个主文件夹和多个子文件夹并自动将它们添加到 ParseFiles，这样我就不必单独手动添加每个文件？

我如何能够在子文件夹中调用具有相同名称的文件，因为目前如果我在 ParseFiles 中添加同名文件，我会在运行时出错。

```
var templates = template.Must(template.ParseFiles(
    "index.html", // main file
    "subfolder/index.html" // subfolder with same filename errors on runtime
    "includes/header.html", "includes/footer.html",
))

func main() {
    // Walk and ParseFiles
    filepath.Walk("files", func(path string, info os.FileInfo, err error) {
        if !info.IsDir() {
            // Add path to ParseFiles

        }
        return
    })

    http.HandleFunc("/", home)
    http.ListenAndServe(":8080", nil)
}

func home(w http.ResponseWriter, r *http.Request) {
    render(w, "index.html")
}

func render(w http.ResponseWriter, tmpl string) {
    err := templates.ExecuteTemplate(w, tmpl, nil)
    if err != nil {
        http.Error(w, err.Error(), http.StatusInternalServerError)
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:40:23.337

要遍历目录查找文件，请参阅： http: [//golang.org/pkg/path/filepath/#Walk](http://golang.org/pkg/path/filepath/#Walk)或[http://golang.org/pkg/html/template/#New](http://golang.org/pkg/html/template/#New)和[http://golang.org /pkg/html/template/#Template.Parse](http://golang.org/pkg/html/template/#Template.Parse)

至于您的其他问题 ParseFiles 使用文件的基本名称作为模板名称，这会导致您的模板发生冲突。你有两个选择

1.  重命名文件。
2.  用于`t := template.New("name of your choice")`创建初始模板
    1.  使用您已经启动的 walk 函数并调用`t.Parse("text from file")`每个模板文件。您必须自己打开并阅读模板文件的内容才能在此处传递。

编辑：代码示例。

```
func main() {
    // Walk and ParseFiles
    t = template.New("my template name")
    filepath.Walk("files", func(path string, info os.FileInfo, err error) {
        if !info.IsDir() {
            // Add path to ParseFiles
            content := ""
            // read the file into content here
            t.Parse(content)
        }
        return
    })

    http.HandleFunc("/", home)
    http.ListenAndServe(":8080", nil)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T16:53:00.020

所以基本上我在遍历文件夹时设置了 New("path name i want").Parse("String from read file")。

```
var templates = template.New("temp")

func main() {
    // Walk and ParseFiles
    parseFiles()

    http.HandleFunc("/", home)
    http.ListenAndServe(":8080", nil)
}

//////////////////////
// Handle Functions //
//////////////////////
func home(w http.ResponseWriter, r *http.Request) {
    render(w, "index.html")
    render(w, "subfolder/index.html")
}

////////////////////////
// Reusable functions //
////////////////////////
func parseFiles() {
    filepath.Walk("files", func(path string, info os.FileInfo, err error) error {
        if !info.IsDir() {
            filetext, err := ioutil.ReadFile(path)
        if err != nil {
                return err
        }
        text := string(filetext)
            templates.New(path).Parse(text)
        }
        return nil
    })
}

func render(w http.ResponseWriter, tmpl string) {
    err := templates.ExecuteTemplate(w, tmpl, nil)
    if err != nil {
        http.Error(w, err.Error(), http.StatusInternalServerError)
    }
} 
```

# ios - 从 Bundle 加载自定义视图控制器失败 - “Interface Builder 文件中的未知类”

> ID：12806476
> 
> 赞同：0
> 
> 时间：2012-10-09T18:48:51.367
> 
> 标签：ios, xcode, uiviewcontroller, bundle

我正在使用下面的代码来展示 Bundle 中的初始视图控制器。

```
NSString *path = [NSHomeDirectory() stringByAppendingPathComponent:@"Library/ReMoreTesting.bundle"];
NSBundle *bun = [NSBundle bundleWithPath:path];
UIStoryboard *sb = [UIStoryboard storyboardWithName:@"ReMoreTesting" bundle:bun];
UIViewController *vc = [sb instantiateInitialViewController];
[self presentViewController:vc animated:YES completion:NULL]; 
```

但是，`presentViewControllerAnimated:completion`会导致记录错误：“Interface Builder 文件中的未知类 RMTViewController”。布局加载正常，但如果我单击依赖于 RMTViewController 的东西（任何不在标准 ViewController 定义中的东西），它会因“无法识别的选择器”而崩溃。

在我看来，Storyboard 文件正在加载，但是编译并存储在同一个 Bundle 中的类文件没有被调用。我是否遗漏了一些指定在哪里寻找课程的东西？

谢谢！

另外，是的，这是一个动态加载的库，我知道该应用程序不会通过 Apple 的批准提交到 App Store。此外，我可以从另一种方法成功访问代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:48:51.367

在发布这个问题时，我发现了问题所在。我想我还是会发布它。

事实证明，加载 Storyboard 也不会加载 Bundle 的库。`[bun load]`在实例化 Storyboard 之前调用解决了这个问题。

事后看来一切都很容易，是吗？

# python - 随机样本生成器

> ID：12806478
> 
> 赞同：0
> 
> 时间：2012-10-09T18:48:59.927
> 
> 标签：python, random

对随机样本生成有什么建议吗？每次运行时，我都需要从一个大列表中随机选择 100 个项目。我可以通过比较项目的 ID 并循环直到计数达到 100 来做到这一点，但我想知道是否有任何内置功能可以简化这个过程。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T18:51:50.097

你想要[`random.sample(population, k)`](http://docs.python.org/library/random.html#random.sample)。

> 返回从总体序列中选择的唯一元素的 ak 长度列表。用于无放回的随机抽样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-09T18:51:06.633

使用[`random.sample`](http://docs.python.org/library/random.html#random.sample)：

```
import random
x = range(10000)
y = random.sample(x, 100) 
```

# python - Matplotlib imshow() 拉伸到“适合宽度”

> ID：12806481
> 
> 赞同：39
> 
> 时间：2012-10-09T18:49:13.927
> 
> 标签：python, matplotlib

我有一个图像，以及与其像素的每一列相关联的度量。我`pyplot`用来创建一个顶部有图像的图形，以及下面的列测量图。我正在使用这样的东西：

```
import numpy as np
import matplotlib.pyplot as plt

A = np.random.rand(34*52).reshape(34,52)
means = np.average(A,axis=0)

plt.figure()

plt.subplot(2,1,1)
plt.imshow(A, interpolation='nearest' )

plt.subplot(2,1,2)
plt.plot(means)

plt.show() 
```

如何拉伸图像的宽度以匹配绘图的宽度。这样，当查看绘图中的测量值时，源像素将位于其正上方的列中。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-10-09T20:35:39.240

事实证明，这就像打电话一样`aspect='auto'`简单`imshow`。

```
plt.imshow(A, interpolation='nearest', aspect='auto') 
```

# .net - 我的 ODP.Net 和 REF_CURSORS 的 app.config 配置有什么问题？

> ID：12806485
> 
> 赞同：0
> 
> 时间：2012-10-09T18:49:30.387
> 
> 标签：.net, oracle, entity-framework, odp.net, sys-refcursor

我已经为此苦苦挣扎了一段时间，我正在遵循[本指南](http://download.oracle.com/oll/obe/EntityFrameworkOBE/EntityFrameworkOBE.htm#t3)：

这是我到目前为止采取的步骤：

1.  创建新的控制台项目
2.  添加新的实体模型
3.  将“测试”存储过程导入实体模型，sp 如下所示：

    ```
    CREATE OR REPLACE PROCEDURE SCHEMA.TEST(P_SALIDA OUT NUMBER,
                                P_CURSOR1 OUT sys_refcursor,
                                P_CURSOR2 OUT sys_refcursor) IS
    BEGIN
       P_SALIDA := 15;
       OPEN P_CURSOR1 FOR
       SELECT 125.72 "DECIMAL", 150 "INTEGER", 'JUST PASSING BY' "TEXT" FROM DUAL;

       OPEN P_CURSOR2 FOR
       SELECT 'JUST SOME TEXT' "TEXT" FROM DUAL;

    END TEST;
    / 
    ```

4.  将此添加到 app.config：

```
<add name="SCHEMA.TEST.RefCursor.P_CURSOR1" value="implicitRefCursor bindinfo='mode=Output'" />  
<add name="SCHEMA.TEST.RefCursorMetaData.P_CURSOR1.Column.0" value="implicitRefCursor metadata='ColumnName=DECIMAL;NATIVEDATATYPE=Number;ProviderType=Decimal'" />  
<add name="SCHEMA.TEST.RefCursorMetaData.P_CURSOR1.Column.1" value="implicitRefCursor metadata='ColumnName=INTEGER;NATIVEDATATYPE=Number;ProviderType=Int32'" />  
<add name="SCHEMA.TEST.RefCursorMetaData.P_CURSOR1.Column.2" value="implicitRefCursor metadata='ColumnName=TEXT;NATIVEDATATYPE=Varchar2;ProviderType=Varchar2'" />  

```

```
<add name="SCHEMA.TEST.RefCursor.P_CURSOR2" value="implicitRefCursor bindinfo='mode=Output'" />
<add name="SCHEMA.TEST.RefCursorMetaData.P_CURSOR2.Column.0" value="implicitRefCursor metadata='ColumnName=TEXT;NATIVEDATATYPE=Varchar2;ProviderType=Varchar2'" />

```

然后我尝试从之前创建的实体模型中导入函数，但是当我在选择复杂类型后单击获取列信息时没有任何反应，它不会像**obe**教程那样显示光标。

任何帮助，将不胜感激。

谢谢

编辑：

所以我今天又试了一次，这次的表现有所不同。现在，当我单击导入函数对话框中的“获取列信息”按钮时，该对话框将关闭，没有其他任何反应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T15:37:57.703

所以，这可能听起来很尴尬，但实际上是 Visual Studio 的问题，我关闭了 IDE 并再次打开它，它开始工作了。

我仍然不向任何人推荐这种方法，仅仅导入一个函数就需要做太多的工作。

# python - 创建向量 z 的最快方法，使得 z[i] = 1/(1+i)

> ID：12806488
> 
> 赞同：0
> 
> 时间：2012-10-09T18:49:44.793
> 
> 标签：python, numpy

我需要在 numpy 中创建一个向量 z，使得 z[i] = 1/(1+i)。那么在下面的代码中有没有更快的方法呢？

```
import numpy as np
n = 10000
z = np.zeros(n)
for i in xrange(n):
    z[i] = 1.0/(1 + i) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:53:08.287

Quickest way:

```
z = 1.0/np.arange(1, n+1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:51:18.817

怎么样：

```
z = np.arange(n)
z = 1/(1+z) 
```

# r - 如何在 R 中使用两个变量创建 3 x 3 列联表

> ID：12806491
> 
> 赞同：5
> 
> 时间：2012-10-09T18:49:52.510
> 
> 标签：r

**例子：**

```
x <- c( 1, NA, 0, 1)
y <- c(NA, NA, 0, 1)
table(x,y, useNA="always") # --->
#       y
# x      0 1 <NA>
#   0    1 0    0
#   1    0 1    1
#  <NA>  0 0    1 
```

**我的问题是：**

```
a <- c(NA, NA, NA, NA)
b <- c(1, 1, 1, 1)
table(a, b, useNA="always") ## --> It is 1X2 matrix. 
#       b
# a      1 <NA>
#   <NA> 4    0 
```

我想得到一个 3X3 表，其**列名、行名和维度**与上面的示例相同。然后我将为该表应用 chisq.test。非常感谢您的回答！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T18:55:22.317

You can achieve this by converting both `a` and `b` into factors with the same levels. This works because factor vectors keep track of all possible values (aka levels) that their elements might take, even when they in fact contain just a subset of those.

```
a <- c(NA, NA, NA, NA)
b <- c(1, 1, 1, 1)

levs <- c(0, 1)

table(a = factor(a, levels = levs), 
      b = factor(b, levels = levs), 
      useNA = "always")
#       b
# a      0 1 <NA>
#   0    0 0    0
#   1    0 0    0
#   <NA> 0 4    0 
```

# excel - excel中的嵌套列表

> ID：12806494
> 
> 赞同：1
> 
> 时间：2012-10-09T18:50:07.063
> 
> 标签：excel, list, nested

我什至不知道如何问这个。

我有一个数据库，其中每一行都是一个人。列是联系信息、电话等。一列是“访问日期”。每个人可以访问多个日期。我不想使用逗号或将它们全部堆叠在一个字段中。

有没有办法拥有一个“嵌套”列表（不是下拉菜单 - 只是每个人的访问日期列表），这样一个人仍然只消耗一行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:41:28.473

是的，

为此，请为每个人提供一个唯一且不会更改的 ID。然后在另一张纸上存储 ID 和日期。

主表（ID、姓名、联系信息、电话等）第二张表（ID、访问日期）

在数据库理论中，这称为“一对多”关系，而我所描述的称为“规范化数据集”。

在 Excel 中，您现在可以使用公式来操作数据，但是您需要或可以在将其拆分后想象。

正如您在评论中提到的，计算用户的所有访问日期。在右侧的主工作表上，您可以使用：

```
=countif(Sheet2!A:A,Sheet1!A1) 
```

这将计算第二张表中与主表上当前行 ID 匹配的所有 ID。

**关于使用一个单元格的注意事项：**

将所有日期存储在一个单元格中最终会将其最大化，并且随着它的增长将使其难以查看/搜索，因此我强烈建议不要使用这种方法。

但是，如果您坚持将日期保留在其中，则可以通过计算逗号的总数 + 1 来计算访问次数`=(LEN(G1) - LEN(SUBSTITUTE(G1,",","")))+1`此公式采用所有日期的长度以及删除逗号的日期长度并减去它们以获得多次出现。

**关于使用多列的注意事项：**

这种方法与我建议的方法具有相同的想法，我们将许多日期与行的人的身份相关联。但是，有一些关键的限制和缺点。

主要区别在于，当我们通过调换日期以垂直扩展来抽象日期时，我们可以更轻松地操作它们，并使一个人的 20 个日期列表更易于阅读。通过在第二张表中垂直转置日期而不是使用这种方法，我们还获得了使用 Excel 内置过滤器的能力。仅仅存储大量数据本身是没有用的。以一种您可以轻松查看和操作的方式存储它可以让一切变得更加*强大*。

# python - Python：列表类型转换的元组如何工作？

> ID：12806501
> 
> 赞同：1
> 
> 时间：2012-10-09T18:50:24.157
> 
> 标签：python, python-2.7

我很想知道python如何在内部处理元组到列表的类型转换。例如，

```
>>> list((1,2,3))
[1, 2, 3] 
```

它是在内部调用 for 循环以将其添加到列表中还是仅仅是类型转换。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T18:55:59.263

Python 没有“类型转换”。可迭代对象被传递给[`list`初始化程序](http://hg.python.org/releasing/2.7.3/file/7bb96963d067/Objects/listobject.c#l2438)，初始化程序将其委托给[`extend()`方法](http://hg.python.org/releasing/2.7.3/file/7bb96963d067/Objects/listobject.c#l798)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:55:17.840

它迭代给定的对象，就像在 for 循环中一样，因此也支持像文件或生成器函数这样的迭代器。

[这](http://hbfs.wordpress.com/2011/11/29/python-iterators/)是对 python 的可迭代对象的一个​​很好的解释。

# visual-studio-2012 - 自定义 Visual Studio 2012 安装（仅限 C#）

> ID：12806503
> 
> 赞同：13
> 
> 时间：2012-10-09T18:50:32.690
> 
> 标签：visual-studio-2012

有没有办法自定义 Visual Studio 2012 安装的语言？我只想要 C#，没有 VB 或 F# 等。

我正在尝试安装 Visual Studio 2012 Premium RTM。

我看到的第一个安装页面：

![在此处输入图像描述](../Images/7b5da7689d67f538d582124b745afbc6.png)

接下来我看到了这个：

![在此处输入图像描述](../Images/9d3076396a5581cc7e7a244d2b639635.png)

但是没有选项可以选择我要安装的语言:-(

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-16T18:11:58.830

我认为这与您将获得的定制一样多。

[http://blogs.msdn.com/b/visualstudio/archive/2012/06/04/setup-improvements-for-visual-studio.aspx](http://blogs.msdn.com/b/visualstudio/archive/2012/06/04/setup-improvements-for-visual-studio.aspx)

[http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2639283-bring-back-the-visual-studio-installation-customiz](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2639283-bring-back-the-visual-studio-installation-customiz)

根据他们 [Microsoft] 删除的这些链接，然后带回了自定义选项。你所见即所得。我知道我安装的 VS 2012（将 express 升级到 Ultimate）只占用 2 GB，所以 IDK 为什么说它需要 6。

![在此处输入图像描述](../Images/cfca82167d7623c040854bd1d1dce84d.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-29T06:51:42.963

我[在 Visual Studio 安装论坛上提出了这一点](http://social.msdn.microsoft.com/Forums/vstudio/en-US/504ebf41-9179-4acc-a756-e5ef546dc74e/bring-back-custom-install-options-for-languages-in-vs-2012-install)，看看结果如何。

# cakephp - CakePHP 缓存配置总是恢复为文件（来自 Memcache 或 APC）

> ID：12806504
> 
> 赞同：1
> 
> 时间：2012-10-09T18:50:34.500
> 
> 标签：cakephp, cakephp-2.0, cakephp-2.1

首先，在我的运行 PHP 5.3.15 的 Macbook Pro 开发服务器上，使用 PECL 成功安装了 Memcache 和 APC（并被验证为工作）

我刚刚烘焙了一个测试 Cake 2.2.2 应用程序。在`Config/core.php`我有以下内容：

```
/**
 * Pick the caching engine to use.  If APC is enabled use it.
 * If running via cli - apc is disabled by default. ensure it's available and enabled in this case
 *
 */
$engine = 'File';
if (extension_loaded('apc') && function_exists('apc_dec') && (php_sapi_name() !== 'cli' || ini_get('apc.enable_cli'))) {
    $engine = 'Apc';
}
if (extension_loaded('memcache') && php_sapi_name() !== 'cli') {
    $engine = 'Memcache';
}

// In development mode, caches should expire quickly.
$duration = '+999 days';
if (Configure::read('debug') >= 1) {
    $duration = '+10 seconds';
}

// Prefix each application on the same server with a different string, to avoid Memcache and APC conflicts.
$prefix = 'mcmyapp_';

/**
 * Configure the cache used for general framework caching.  Path information,
 * object listings, and translation cache files are stored with this configuration.
 */
Cache::config('_cake_core_', array(
    'engine' => $engine,
    'prefix' => $prefix . 'cake_core_',
    'path' => CACHE . 'persistent' . DS,
    'serialize' => ($engine === 'File'),
    'duration' => $duration
));

/**
 * Configure the cache for model and datasource caches.  This cache configuration
 * is used to store schema descriptions, and table listings in connections.
 */
Cache::config('_cake_model_', array(
    'engine' => $engine,
    'prefix' => $prefix . 'cake_model_',
    'path' => CACHE . 'models' . DS,
    'serialize' => ($engine === 'File'),
    'duration' => $duration
));

Cache::config('default', array(
    'engine' => $engine,
    'serialize' => ($engine === 'File'),
    'duration'=>$duration,
    'prefix'=>$prefix,
));

debug(Cache::settings()); 
```

上述最终 debug() 的输出为：

```
array(
    'prefix' => '*****',
    'engine' => 'Memcache',
    'serialize' => false,
    'duration' => (int) 10,
    'servers' => array(
        (int) 0 => '127.0.0.1'
    ),
    'compress' => false,
    'persistent' => true,
    'probability' => (int) 100,
    'groups' => array()
) 
```

因此`core.php`，Cake 似乎希望将 Memcache 用作其缓存引擎。

然而，当我`localhost/myapp/pages/home`在浏览器中访问时，CakePHP 的默认、新鲜出炉的欢迎页面向我打招呼，通知我`The FileEngine is being used for core caching`

如果我在我的应用程序中的其他任何地方（除了`core.php`）`debug(Cache::settings())`，我会得到以下信息：

```
array(
    'prefix' => '*****',
    'engine' => 'File',
    'serialize' => false,
    'duration' => (int) 10,
    'servers' => array(
        (int) 0 => '127.0.0.1'
    ),
    'compress' => false,
    'persistent' => true,
    'probability' => (int) 100,
    'groups' => array()
) 
```

基本上，CakePHP 似乎恢复为 File 进行缓存，忽略我的配置`core.php`以使用 Memcache ......除非我在这里做错了什么？？！

`Configure::write('debug', 0)`我已经用and试过了`Configure::write('debug', 1)`。

我应该提到，通过上述，APC 和 Memcache 扩展都在`php.ini`.

任何帮助将不胜感激，在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T22:46:25.057

Memcached 应该在某个端口上，默认端口是 11211（检查）...因此您的配置尝试连接到 Memcached，失败并恢复为默认（文件）缓存...

尝试：

```
Cache::config('default', array(
    'engine' => 'Memcache',
    'duration'=> 3600, 
    'probability'=> 100, 
    'servers' => array('127.0.0.1:11211') <<<<==
)); 
```

# ios - 如何在不使用 dispatch_get_current_queue() 的情况下验证我是否在给定的 GCD 队列上运行？

> ID：12806506
> 
> 赞同：40
> 
> 时间：2012-10-09T18:50:50.847
> 
> 标签：ios, macos, objective-c-blocks, grand-central-dispatch

最近，我需要一个函数来保证在特定串行调度队列上同步执行给定块。有可能这个共享函数可以从已经在该队列上运行的东西中调用，所以我需要检查这种情况，以防止同步分派到同一个队列时出现死锁。

我使用如下代码来执行此操作：

```
void runSynchronouslyOnVideoProcessingQueue(void (^block)(void))
{
    dispatch_queue_t videoProcessingQueue = [GPUImageOpenGLESContext sharedOpenGLESQueue];

    if (dispatch_get_current_queue() == videoProcessingQueue)
    {
        block();
    }
    else
    {
        dispatch_sync(videoProcessingQueue, block);
    }
} 
```

此函数依赖于使用`dispatch_get_current_queue()`来确定运行此函数的队列的身份，并将其与目标队列进行比较。如果匹配，它知道只运行块内联而不调度到该队列，因为函数已经在其上运行。

`dispatch_get_current_queue()`我听说过关于使用这样的比较是否合适的相互矛盾的事情，我在标题中看到了这样的措辞：

> 建议仅用于调试和记录目的：
> 
> 代码不得对返回的队列做出任何假设，除非它是全局队列之一或代码自己创建的队列。如果该队列不是 dispatch_get_current_queue() 返回的队列，则代码不能假定在队列上同步执行不会出现死锁。

此外，在 iOS 6.0 中（但尚不支持 Mountain Lion），GCD 标头现在将此功能标记为已弃用。

听起来我不应该以这种方式使用此功能，但我不确定应该使用什么来代替它。对于像上面这样针对主队列的函数，我可以使用`[NSThread isMainThread]`，但是如何检查我是否在我的自定义串行队列之一上运行，以便防止死锁？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-10-09T19:09:07.893

分配您想要使用的任何标识符`dispatch_queue_set_specific()`。然后，您可以使用 . 检查您的标识符`dispatch_get_specific()`。

请记住，这`dispatch_get_specific()`很好，因为它将从当前队列开始，然后如果未在当前队列上设置密钥，则沿着目标队列前进。这通常无关紧要，但在某些情况下可能很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-21T11:40:57.157

这是一个非常简单的解决方案。它不如使用`dispatch_queue_set_specific`和`dispatch_get_specific`手动的性能好——我没有这方面的指标。

```
#import <libkern/OSAtomic.h>

BOOL dispatch_is_on_queue(dispatch_queue_t queue)
{
    int key;
    static int32_t incrementer;
    CFNumberRef value = CFBridgingRetain(@(OSAtomicIncrement32(&incrementer)));
    dispatch_queue_set_specific(queue, &key, value, nil);
    BOOL result = dispatch_get_specific(&key) == value;
    dispatch_queue_set_specific(queue, &key, nil, nil);
    CFRelease(value);
    return result;
} 
```

# sql - 就架构设计提出建议

> ID：12806507
> 
> 赞同：0
> 
> 时间：2012-10-09T18:50:59.567
> 
> 标签：sql, schema

我想将位置的开放时间和关闭时间存储到数据库表中。您认为以下哪种桌子设计更理想？我正在使用 MySQL 或者可能是 PostgreSQL（这有关系吗？）。

一天一个记录？（返回 1-7 个结果）

```
id, location_id, weekday, start_time, closing_time 
```

还是每个位置一个记录？（总是返回 1 个结果）

```
id, location_id, mon_start, mon_end, tue_start, tue_end, ... ... ... sun_start, sun_end 
```

最常见的查询将简单地显示这样的内容（总是整周）：

```
Location: blablabla
Operating Hours:
    Monday: 8 AM to 8 PM
    ... ...
    Sunday: 8 AM to 12 PM 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:53:30.023

The first solution is clearly correct. The second one is not normalized, harder to program against, and not extendable (for holidays, special hours, etc).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:56:03.103

绝对是第一个，它更好地规范化，您可以使用查找表轻松生成第二种格式的数据，也许还有一个视图。

正如第一张海报所说，第一个解决方案可以很容易地扩展到包括假期等。第二个不是那么灵活。

# npm - 无法使用 TSC - 读取文件“anything.ts”时出错：找不到文件

> ID：12806510
> 
> 赞同：4
> 
> 时间：2012-10-09T18:51:07.830
> 
> 标签：npm, typescript, tsc

无论我做什么，我都无法让 TSC Typescript 编译器找到任何文件。我已经尝试过 Visual Studio Extension 附带的 tsc 和 npm 附带的 tsc。我在 Node.js 命令行 windows shell 和 Git Bash shell 中尝试过。不管我做什么，它只是说找不到文件。我读过编译器只适用于 .ts 和 .str 文件，但这似乎不是问题。

这是我所看到的一个快速示例。我知道这些文件将是空的，但我已经用包含代码的文件尝试了所有这些，它不会改变任何东西。

```
C:\>touch test.ts

C:\>ls *.ts
test.ts

C:\>tsc test.ts
Error reading file "test.ts": File not found

C:\>tsc C:\test.ts
Error reading file "C:\test.ts": File not found

C:\>touch test.str

C:\>tsc test.str
Error reading file "test.str": File not found

C:\>tsc ./test.str
Error reading file "./test.str": File not found

C:\>tsc ./test.ts
Error reading file "./test.ts": File not found

C:\>touch test.js.ts

C:\>tsc test.ts
Error reading file "test.ts": File not found

C:\>tsc test.js
Error reading file "test.js": File not found 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:56:58.310

恐怕，TSC 在空文件上会以这种方式失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T19:06:13.470

看起来像当前编译器 [0.8] 中的一个错误，tsc 不应该在空文件上失败。然而

> 我知道这些文件将是空的，但我已经用包含代码的文件尝试了所有这些，它不会改变任何东西。

我有点担心这部分。还是这样吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:01:58.713

这很难从远处调试。打字稿编译器在解析文件之前会进行大量处理。

运行的输出是什么

```
tsc -debug test.ts 
```

? 另外，请确保 test.ts 不为空。

# mysql - SQL - 选择出现次数最多的值

> ID：12806518
> 
> 赞同：0
> 
> 时间：2012-10-09T18:51:58.227
> 
> 标签：mysql, sql

我有一个由这些表组成的非常简单的数据库。在这里，我正在尝试编写一个查询，以从 Games 表中选择参与最多游戏的玩家。

只要看下面的例子，你就可以知道答案当然是 Ben，因为 PID 2（即来自 Players 表的 Ben）在 Games 表中出现的次数最多，这意味着 Ben 赢得了最多的比赛。

但我不确定如何编写查询以选择 Games 表中最经常出现的值。

```
Players         Games          

PID | name      GID | PID
----|-----      ----|------
1   |  Al       A   |  3
2   |  Ben      A   |  2
3   |  Carl     A   |  2
4   |  Jack     A   |  1
5   |  Ron      A   |  4 
```

有没有人有什么建议？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T18:55:22.723

Well, join players and games, count, group by player, order by count desc (greatest first), and limit to one if you want the first.

```
SELECT p.NID, p.name, COUNT(*)
FROM Players p
INNER JOIN Games g ON g.PID= p.NID
GROUP BY p.NID, p.name
ORDER BY COUNT(*) DESC
LIMIT 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:57:16.940

我猜没有计数要做，只是 Games 表中的一个简单整数值表示玩家 ID 的游戏数......

```
SELECT pl.name FROM Players pl join Games g ON pl.NID=g.GID
ORDER BY g.games DESC
limit 1; 
```

# layer - NSScrollView + 图层支持

> ID：12806519
> 
> 赞同：4
> 
> 时间：2012-10-09T18:52:03.903
> 
> 标签：layer, nsscrollview

我有这个层次结构：

NSPageController -> NSScrollView -> NSView 1（与滚动视图大小相同）-> 居中的 NSView 2（目录中的页面）-> 更多子视图（页面上的交互元素）

这是来自 NSPageController 示例，我用 NSView 1 替换了那里的 NSImageView。

现在我想启用 layer-backing 并设置 wantLayer 和 layer redraw 策略。

我遇到的问题是，当我在 NSScrollView 上打开图层支持时，在触控板上使用捏合手势缩放滚动视图时，它不再正确更新 NSView 1 的图层边界。

我错过了层支持工作的涓涓细流？

另外，我发现如果我从 NSView 2 开始启用图层支持，那么调整大小就可以了，但是我在那里绘制的页面图像看起来很粗糙。我移动到带有图层支持的 NSView 1，因为我还想要 NSView 2 上的阴影，并且只有在超级视图也打开了图层支持时才会显示。

# .net - Windows client application with crystal reports connecting to an Azure database

> ID：12806529
> 
> 赞同：1
> 
> 时间：2012-10-09T18:52:31.093
> 
> 标签：.net, winforms, azure, crystal-reports

I'm working on an existing .Net winforms application that has traditionally had crystal reports run against a LAN SQL Server database. I'm trying to get it working with an Azure cloud database.

The existing app uses the server name given by the user at login time to connect and set each table's location etc within the report so the report can be run against any database server rather than only work against the database the report was designed against. Hopefully this is a familiar concept for those who have used Crystal Reports in a windows app before as this is the second company I have worked for that has code similar to the following which loops through each table and sub report in the report to make sure they are all pointing at the specified server:

```
For Each crTable In crTables
        CrtableLogoninfo = crTable.LogOnInfo
        CrtableLogoninfo.ConnectionInfo = App._CrConnectionInfo
        crTable.ApplyLogOnInfo(CrtableLogoninfo)
        crTable.Location = App.DBName & ".dbo." & crTable.Location.Substring(crTable.Location.LastIndexOf(".") + 1)
    Next
    crSections = CrReportDocument.ReportDefinition.Sections
    For Each crSection In crSections
        crReportObjects = crSection.ReportObjects
        For Each crReportObject In crReportObjects
            If crReportObject.Kind = ReportObjectKind.SubreportObject Then
                crSubreportObject = CType(crReportObject, SubreportObject)
                subRepDoc = crSubreportObject.OpenSubreport(crSubreportObject.SubreportName)
                crTables = subRepDoc.Database.Tables
                For Each crTable In crTables
                    CrtableLogoninfo = crTable.LogOnInfo
                    CrtableLogoninfo.ConnectionInfo = App._CrConnectionInfo
                    crTable.ApplyLogOnInfo(CrtableLogoninfo)
                    crTable.Location = App.DBName & ".dbo." & crTable.Location.Substring(crTable.Location.LastIndexOf(".") + 1)
                Next
            End If
        Next
    Next 
```

This has been working for years against various LAN databases but doesn't seem to work with Azure. Crystal at runtime decides that the parameters that have been set by code need to be prompted for from the user, which seems to indicate something has gone wrong with the connection. If you enter parameter values it then errors complaining certain fields do not exist.

I've played about with various calls to _CrConnectionInfo.LogonProperties.Set("Connection String", "SomeConnectionString") immediately before the code above but at best it proceeds to a point where it says "Operation not yet implemented".

I tried from Crystal Reports directly to connect to the cloud and got that working using the SQL Server Client 11 connection type. In the application when I create an SQL client connection via a call to `_CrConnectionInfo.LogonProperties.Set("Connection String", ""Provider=SQLNCLI;Server=tcp:theAzureDBInstanceName;Password=thePassword;Persist Security Info=True;User ID=thelogin;Initial Catalog=theDBName;Encrypt=yes;")")` or some similar variation it still doesn't work.

Does anyone know how to get Crystal to connect to an Azure database directly from a .Net app? If you have code suggestions either VB.Net or C# samples are fine.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-06T11:14:16.107

Crystal Reports（即使是最新的 CR 2013 SP4）仍然不支持 Azure SQL。

来源：[http ://scn.sap.com/thread/3430662](http://scn.sap.com/thread/3430662)

如果您在本地 MSSQL 数据库上设计报告，则可以在运行时在 Azure SQL 数据库上成功运行报告（前提是您正确设置了表位置），正如我在上面链接的线程中提到的那样 - 但如果您使用存储过程有一个警告 - 您必须关闭报告选项“第一次刷新时验证存储过程”。

如果您想要支持 Azure SQL，那么我敦促您对“创意场所”的想法进行投票：[https](https://ideas.sap.com/ct/ct_a_view_idea.bix?idea_id=) ://ideas.sap.com/ct/ct_a_view_idea.bix?idea_id= {91C7DF6B-4BDA-4DB4-90DB-9695ADCCF09B }

我仍然对为什么 SAP 没有解决这个问题感到目瞪口呆。

注意：我发现自己使用 Crystal Reports 导致“操作尚未实现”的另一个常见原因是报表使用了客户端上不可用但在报表中使用的字体。“无效字体”消息会很好:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T21:47:19.510

这可能是由于[不支持](http://msdn.microsoft.com/en-us/library/windowsazure/ee336288.aspx)USE 语句造成的。您能否更改您的代码并确保：

1.  连接字符串直接引用数据库：`...;Initial Catalog=myDataBase;...`
2.  在您的代码中，替换`App.DBName & ".dbo." & ...`为`".dbo." & ...`（尝试删除对数据库的任何直接引用）

# git - Git 创建巨大的临时垃圾对象

> ID：12806530
> 
> 赞同：6
> 
> 时间：2012-10-09T18:52:37.133
> 
> 标签：git

我想在本地使用 git 来跟踪对一些本地文件的更改，这些文件通过我的主目录发送。

我在 初始化了一个存储库`~`，然后添加了几个文件`git add`，并进行了一些提交。到目前为止一切顺利，`.git`是 300K 大。

问题是一夜之间，**`.git`增长到 5.4G**，填满了我的磁盘（*也许它可以增长更多*）。这发生了两次：第一次，我重新创建了 repos，第二次，`git prune`修复了它。修剪前，`git count-objects -v`报告`error: garbage found: .git/objects/95/tmp_obj_...`.

编辑：发布后一小时，它再次发生（我再次修剪）。

**为什么会发生，以及如何解决？**

（我尝试将所有这些文件与链接分组在一个目录中，但可以提出一个可行的解决方案，将文件保存在所需的位置，但如果问题真的出现在 repos 上`~/`，那么我会在这个方向。）

> Debian GNU/Linux wheezy/sid 上的 git 版本 1.7.10.4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T22:12:26.290

原来我有**[另一个](http://i.imgur.com/91vqf.gif)git 存储库使用 cron[自动](http://doc.norang.ca/org-mode.html#GitSync)**提交，其中的脚本有一个**损坏`cd`**（所以它留在了`~/`，然后运行*​​git add . >/dev/null*和*commit*，从那里）。

[非常感谢 Alex Shepard 在聊天中的帮助，这导致了这一点。]

# c# - 为什么使用 Lockbits 编辑图像仍然需要 7 秒？

> ID：12806531
> 
> 赞同：1
> 
> 时间：2012-10-09T18:52:51.480
> 
> 标签：c#, .net, winforms, drawing

## 我的应用程序

我正在编写一个需要将 RGB 转换为灰度图像的应用程序。转换有效，但转换 3648 * 2736 像素的图像大约需要 7 秒。我知道 set 和 getpixel 需要一些时间。但我认为如果你使用 Lockbits，即使图像不小，也不应该花这么长时间。（如果有错请纠正我）。也许我只是在我的代码中犯了一个致命的错误。

## 编码

```
public static long ConvertToGrayScaleV2(Bitmap imageColor, bool useHDTVConversion)
        {
            Stopwatch stpw = new Stopwatch();
            stpw.Start();
            System.Drawing.Imaging.BitmapData imageColorData = imageColor.LockBits(new Rectangle(new Point(0, 0), imageColor.Size),
                System.Drawing.Imaging.ImageLockMode.ReadWrite, imageColor.PixelFormat);

            IntPtr PtrColor = imageColorData.Scan0;
            int strideColor = imageColorData.Stride;
            byte[] byteImageColor = new byte[Math.Abs(strideColor) * imageColor.Height];
            System.Runtime.InteropServices.Marshal.Copy(PtrColor, byteImageColor, 0, Math.Abs(strideColor) * imageColor.Height);

            int bytesPerPixel = getBytesPerPixel(imageColor);
            byte value;
            if (bytesPerPixel == -1)
                throw new Exception("Can't get bytes per pixel because it is not defined for this image format.");
            for (int x = 0, position; x < imageColor.Width * imageColor.Height; x++)
            {
                position = x * bytesPerPixel;
                if (useHDTVConversion)
                {
                    value = (byte)(byteImageColor[position] * 0.0722 + byteImageColor[position + 1] * 0.7152 + byteImageColor[position + 2] * 0.2126);                    
                }
                else
                {
                    value = (byte)(byteImageColor[position] * 0.114 + byteImageColor[position + 1] * 0.587 + byteImageColor[position + 2] * 0.299);
                }
                byteImageColor[position] = value;
                byteImageColor[position+1] = value;
                byteImageColor[position+2] = value;

            }

            System.Runtime.InteropServices.Marshal.Copy(byteImageColor, 0, PtrColor, Math.Abs(strideColor) * imageColor.Height);
            imageColor.UnlockBits(imageColorData);
            stpw.Stop();
            return stpw.ElapsedMilliseconds;
        }

        public static int getBytesPerPixel(Image img)
        {
            switch (img.PixelFormat)
            {
                case System.Drawing.Imaging.PixelFormat.Format16bppArgb1555:    return 2;
                case System.Drawing.Imaging.PixelFormat.Format16bppGrayScale:   return 2;
                case System.Drawing.Imaging.PixelFormat.Format16bppRgb555: return 2;
                case System.Drawing.Imaging.PixelFormat.Format16bppRgb565: return 2;
                case System.Drawing.Imaging.PixelFormat.Format1bppIndexed: return 1;
                case System.Drawing.Imaging.PixelFormat.Format24bppRgb: return 3;
                case System.Drawing.Imaging.PixelFormat.Format32bppArgb: return 4;
                case System.Drawing.Imaging.PixelFormat.Format32bppPArgb: return 4;
                case System.Drawing.Imaging.PixelFormat.Format32bppRgb: return 4;
                case System.Drawing.Imaging.PixelFormat.Format48bppRgb: return 6;
                case System.Drawing.Imaging.PixelFormat.Format4bppIndexed: return 1;
                case System.Drawing.Imaging.PixelFormat.Format64bppArgb: return 8;
                case System.Drawing.Imaging.PixelFormat.Format64bppPArgb: return 8;
                case System.Drawing.Imaging.PixelFormat.Format8bppIndexed: return 1;
                default: return -1;
            }

        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-20T02:49:47.703

我知道这是旧的，但有一些可能有价值的观点：

这`imageColor.Width * imageColor.Height`是一项昂贵的操作，您运行的次数比您需要的多近 1000 万次 (3648 * 2736)。

*   `for`循环正在重新计算每次**迭代**
*   不仅如此，CLR 还必须**每次都**`Width`导航到 Bitmap 对象和`Height`属性1000 万次。这比您每次尝试在位图上运行时所需的操作多 3000 万次。

 **改变：

```
for (int x = 0, position; x < imageColor.Width * imageColor.Height; x++)
{
    ...
} 
```

到：

```
var heightWidth = imageColor.Width * imageColor.Height;
for (int x = 0, position; x < heightWidth; x++)
{
    ...
} 
```

如果您缓存三种不同操作（R、G、B，有 255 个可能值）的所有潜在结果，并使用查找新值而不是计算新值 1000 万次，您还将看到巨大的性能提升.

这是完整的、非常快速的代码（比 ColorMatrix 快得多）。请注意，我已将所有可能的预先计算的值移动到局部变量中，并且在循环中涉及的工作绝对最少。

```
 var lookupR = new byte[256];
                var lookupG = new byte[256];
                var lookupB = new byte[256];
                var rVal = hdtv ? 0.114 : 0.0722;
                var gVal = hdtv ? 0.587 : 0.7152;
                var bVal = hdtv ? 0.299 : 0.2126;
                for (var originalValue = 0; originalValue < 256; originalValue++)
                {
                    var r = (byte)(originalValue * rVal);
                    var g = (byte)(originalValue * gVal);
                    var b = (byte)(originalValue * bVal);
                    // Just in case...
                    if (r > 255) r = 255;
                    if (g > 255) g = 255;
                    if (b > 255) b = 255;
                    lookupR[originalValue] = r;
                    lookupG[originalValue] = g;
                    lookupB[originalValue] = b;
                }
                unsafe
                {
                    var pointer = (byte*)(void*)bitmap.LockBits(new Rectangle(0, 0, bitmap.Width, bitmap.Height), ImageLockMode.ReadWrite, bitmap.PixelFormat);
                    var bytesPerPixel = getBytesPerPixel(bitmap);
                    var heightWidth = bitmap.Width * bitmap.Height;
                    for (var y = 0; y < heightWidth; ++y)
                    {
                        var value = (byte) (lookupR[pointer[0]] + lookupG[pointer[1]] + lookupB[pointer[2]]);
                        pointer[0] = value;
                        pointer[1] = value;
                        pointer[2] = value;
                        pointer += bytesPerPixel;
                    }
                    bitmap.UnlockBits();
                }
                break; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-27T04:19:05.403

我遇到了一个类似的性能问题，我需要遍历一组位图数据。我发现在引用位图的宽度或高度属性或作为循环的边界时，性能会受到显着影响，就像您对 imagecolor.width 和 .height 所做的那样。通过简单地在循环外声明一个整数并提前缓存位图的高度和宽度，我将循环时间减半。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-09T18:54:28.830

如果要转换为灰度，请尝试改用 ColorMatrix 转换。来自：[https ://web.archive.org/web/20141230145627/http://bobpowell.net/grayscale.aspx](https://web.archive.org/web/20141230145627/http://bobpowell.net/grayscale.aspx)

```
 Image img = Image.FromFile(dlg.FileName);
        Bitmap bm = new Bitmap(img.Width,img.Height);
        Graphics g = Graphics.FromImage(bm); 

        ColorMatrix cm = new ColorMatrix(new float[][]{   new float[]{0.5f,0.5f,0.5f,0,0},
                                  new float[]{0.5f,0.5f,0.5f,0,0},
                                  new float[]{0.5f,0.5f,0.5f,0,0},
                                  new float[]{0,0,0,1,0,0},
                                  new float[]{0,0,0,0,1,0},
                                  new float[]{0,0,0,0,0,1}}); 

        /* 

        //Gilles Khouzams colour corrected grayscale shear
        ColorMatrix cm = new ColorMatrix(new float[][]{   new float[]{0.3f,0.3f,0.3f,0,0},
                                  new float[]{0.59f,0.59f,0.59f,0,0},
                                  new float[]{0.11f,0.11f,0.11f,0,0},
                                  new float[]{0,0,0,1,0,0},
                                  new float[]{0,0,0,0,1,0},
                                  new float[]{0,0,0,0,0,1}}); 

        */ 

        ImageAttributes ia = new ImageAttributes();
        ia.SetColorMatrix(cm);
        g.DrawImage(img,new Rectangle(0,0,img.Width,img.Height),0,0,img.Width,img.Height,GraphicsUnit.Pixel,ia);
        g.Dispose(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T21:06:55.720

我猜想编组和复制占用了大量时间。此[链接](http://www.switchonthecode.com/tutorials/csharp-tutorial-convert-a-color-image-to-grayscale)描述了 3 种图像灰度化方法。**

# html - Website optimization for IE <10

> ID：12806540
> 
> 赞同：0
> 
> 时间：2012-10-09T18:53:23.987
> 
> 标签：html, internet-explorer, optimization, quirks-mode, ie-compatibility-mode

I created a website using HTML 5 and it works perfectly on Chrome, Firefox and Internet Explorer 10\. If I'm running the website in Compatibility mode the layout is all messed up.

Only if I change Document Mode from IE5 quirks to another value inside Developers Tool it's working perfectly.

Is there someone who can give me some hints or some tips&tricks to make it work properly.

You can find the website here: [http://www.westmotors.ro/beta](http://www.westmotors.ro/beta)

Thank you in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:00:27.057

这是一个不错的网站，您可以在其中查看任何浏览器的 HTML5 就绪情况：http: [//html5readiness.com/](http://html5readiness.com/)

此外，我强烈建议您使用 Modernizr javascript 插件以使您的网站兼容：http: [//modernizr.com/](http://modernizr.com/)

最后一件事，尝试为 html5 功能找到一些“polyfills”，你不能在你的网站中使用“本地方式”

# python - wx.ListCtrl with TextEditMixin - 禁用选定单元格的编辑

> ID：12806542
> 
> 赞同：7
> 
> 时间：2012-10-09T18:53:30.367
> 
> 标签：python, listview, wxpython

`ListCtrl`使用with时有什么方法可以禁用用户对特定单元格的编辑`TextEditMixin`？

我想有某种方式可以否决编辑事件，但我找不到它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-09T20:19:18.400

事件 wx.EVT_LIST_BEGIN_LABEL_EDIT：

```
class EditableListCtrl(wx.ListCtrl, listmix.TextEditMixin):
    def __init__(self, parent, ID=wx.ID_ANY, pos=wx.DefaultPosition,
                 size=wx.DefaultSize, style=0):
        wx.ListCtrl.__init__(self, parent, ID, pos, size, style)
        listmix.TextEditMixin.__init__(self)
        self.Bind(wx.EVT_LIST_BEGIN_LABEL_EDIT, self.OnBeginLabelEdit)

    def OnBeginLabelEdit(self, event):
        if event.m_col == 1:
            event.Veto()
        else:
            event.Skip() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-08-02T08:26:37.780

在 wxPython 4.0.0 版中，该行：

`if event.m_col == 1` 不起作用。采用

`if event.GetColumn() == 1`

反而。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T20:19:30.980

我记得，您必须绑定到 EVT_LIST_BEGIN_LABEL_EDIT。然后在您的事件处理程序中，您只需检查您所在的列，如果您位于您希望可编辑的列中，则执行“event.Allow()”，否则您否决。

# amazon-ec2 - 亚马逊 AWS ElasticBeanstalk 自定义 AMI

> ID：12806547
> 
> 赞同：1
> 
> 时间：2012-10-09T18:54:01.653
> 
> 标签：amazon-ec2, amazon-web-services, amazon, amazon-elastic-beanstalk, amazon-ami

我正在尝试在 AWS Beanstalk 中使用自定义 AMI。我在 EC2 (ElasticBeanstalk-Tomcat7-32bit-20110913-1132 (ami-278e4c4e)) 中手动启动了默认的 Amazon ElasticBeanstalk 映像，并从中创建了我的自定义 AMI。然后我转到 ElasticBeanstalk，启动一个环境，一旦它启动并运行，我就切换到环境配置中的这个自定义 AMI。

健康状态为绿色。但是我的 webapp 没有部署在实例上：

```
[root@ip-***-***-***-*** ~]# ls -l /opt/tomcat7/webapps
total 0 
```

Tomcat 正在运行：

```
[root@ip-***-***-***-*** ~]# /etc/init.d/tomcat7 status
Tomcat 7 is running. 
```

我对为什么我的应用程序没有部署感到困惑。有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T09:34:09.407

好吧，Beanstalk AMI 使用初始化脚本从 S3 复制您的应用程序，并将其部署到容器 (Tomcat)。我建议： 1\. 查看 CloudInit 日志：/var/log/cloud-init.log。2\. 如果一切正常（甚至是空的），编辑 /etc/sysconfig/cloudinit 中的脚本以添加一些跟踪，以检查 CloudInit 脚本是否已执行，或者在某些时候失败。

很抱歉无法为您提供更好的帮助，但从这里很难知道发生了什么！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T01:56:10.590

我通常做的是启动一个 Beanstalk 实例（不是具有 Beanstalk AMI 的实例），然后我对该实例进行修改，最后我创建我的自定义 AMI 来完成您想要实现的目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T15:23:40.367

与此同时，我发现了问题所在。当您从 Amazon 预定义的 Beanstalk 映像之一创建自己的 AMI 时，您实际上并未对文件系统进行任何更改（安装任何东西、创建文件等），AWS 在创建自定义快照时不会创建新快照急性心肌梗死。创建的 AMI 将无法在 Beanstalk 中运行。

只要您在创建自己的自定义 AMI 之前对默认图像进行任何更改，一切都应该可以正常工作。

# java - blob data partially inserted in database

> ID：12806548
> 
> 赞同：1
> 
> 时间：2012-10-09T18:54:03.353
> 
> 标签：java, oracle, blob

When I insert `blob` data into Oracle database, it is partially inserted. Iam using the following code for insertion.

```
oracle.sql.BLOB newBlob =oracle.sql.BLOB.createTemporary(conn, false, oracle.sql.BLOB.DURATION_SESSION);
newBlob.putBytes(1, str.getBytes());
ps.setBlob(1, newBlob); 
```

I checked whether the data got inserted or not by querying the data and converting it into **jpeg** image, sometimes I am getting partial image. Rest of the image is grey. Most of the time I am getting full image perfectly. What may the reason for this partial insertion?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:21:37.350

您使用默认编码将字符串的字节存储在 BLOB 中。这至少在以下一种方式中是错误的：

*   如果要存储字符数据，请使用 CLOB
*   如果要存储二进制数据，请不要将其放入字符串中。

既然您说您正在处理 JPEG，我会说字符串转换是您遇到问题的地方。尝试将一堆字节存储在 Java 字符串（处理字符）中，然后将其转换回字节只是一个坏主意。使用`byte[]`.

# ruby-on-rails - Rails：删除 gem 在卸载时创建的迁移/模式

> ID：12806551
> 
> 赞同：1
> 
> 时间：2012-10-09T18:54:35.350
> 
> 标签：ruby-on-rails, ruby-on-rails-3

安装 gem 时，是否有一种简单的方法可以删除由 gem 创建的表？对于我的具体情况，我想卸载 gem 并重新安装它，但旧表和数据仍然存在。现在我打算手动删除创建的表。有没有办法查看 gem 创建的所有表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T20:48:33.763

没有简单的方法可以查看 gem 创建的所有表，除非它们被命名在合理的范围内。例如，[Forem](http://github.com/radar/forem)`forem_`使用前缀为所有表命名空间。

您需要手动创建迁移并删除表。

# dalvik - Differences between compiled dalvik binaries

> ID：12806553
> 
> 赞同：0
> 
> 时间：2012-10-09T18:54:40.657
> 
> 标签：dalvik

I'm compiling dalvik on Android 4.1 with both host and target set to x86\. The make command is:

```
make dalvikvm core ext framework android.policy services 
```

However, there are multiple compiled binaries:

```
out/host/linux-x86/bin/dalvikvm
out/host/linux-x86/bin/dalvik
out/target/product/generic_x86/system/bin/dalvikvm
out/target/product/generic_x86/symbols/system/bin/dalvikvm 
```

But the target versions don't work. When run, they show:

```
bash: ./dalvikvm: No such file or directory 
```

This error is so strange that, I mean, the file is just there.

Could anyone please tell me which one is the compiled result? I mean, if I make some modification to dalvik source, which one will contain the modified result? Thank you.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:35:53.473

这几乎可以肯定是一个联系问题。主机版本与普通主机 libc 相关联，但目标版本与设备上 /system/lib 中的 android libc 相关联，您的主机 ld 对此一无所知。

您可以尝试以下方法：

```
LD_LIBRARY_PATH=<android_root>/out/target/product/generic_x86/system/lib out/target/product/generic_x86/symbols/system/bin/dalvikvm 
```

虽然我不完全确定这是否可行

# php - Run and Receive a Command in screen via PHP

> ID：12806555
> 
> 赞同：2
> 
> 时间：2012-10-09T18:54:46.410
> 
> 标签：php, minecraft

I'm making a Minecraft control panel, but are sort of confused on how to send a command to each screen. I understand how to execute a command to a screen, but I don't understand to read the output.

Ex. I have screen A and screen B. I want to execute something in screen A, and get the output, and then exit the screen.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T15:10:47.603

这是一个更简单的解决方案：在两个服务器中使用 Websend bukkit 插件[（下载和信息） 。](http://dev.bukkit.org/server-mods/websend/ "点击这里重定向到 bukkit dev！")PHP 可以在安装插件和设置 php 类时简单地执行命令并接收输出，这也可以比 bash 屏幕更复杂，并且更容易设置和使用。

这是一个使用示例：

```
<?php
include_once 'Websend.php';

//Replace with bukkit server IP. To use a different port, change the constructor to new Websend(ip, port)
$ws = new Websend($ServerIP, $ServerPort); 

//Replace with password specified in Websend config file
$ws->connect("password");

$ws->doCommandAsConsole("give ".$PlayerName." 64 1");
$ws->disconnect();
?> 
```

在本例中，脚本项为一个变量定义的播放器。您可以通过替换`$ws->doCommandAsConsole("give ".$PlayerName." 64 1");' to`$ws->doCommandAsConsole("$_REQUEST['customCMD']");来执行自定义变量命令 其中 customCMD 是 GET 或 POST 表单中的字段。`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-07T13:16:27.507

实际上并不需要插件，但请记住，在安全性方面，使用 shell_exec 可能会给您带来巨大的痛苦。

但是，我在 drupal 中实现控制面板时遇到了类似的问题，我设法使用以下代码将命令运行到屏幕。

```
shell_exec("screen -S ScreenName -X stuff \"echo hello world\"'\n'"); 
```

别客气。

# entity-framework-4 - Default Constraints in Entity Framework

> ID：12806557
> 
> 赞同：3
> 
> 时间：2012-10-09T18:54:48.817
> 
> 标签：entity-framework-4

Very simple question that NO ONE has directly answered. Is there no way to insert an entity using EF4 that uses the database default constraint and yet allows that field to be updated later? There doesn't seem to be. When I have a date property for instance and want it to use the database default, I seem to have two options:

1) Set the "StoreGeneratedPattern" to "Computed" or "Identity" which prevents me from updating it later.

2) Ignore the database default entirely and set the default value myself.

Neither one of these options will work for me, and this seems to be a huge weakness with the framework. Any ideas? Is this bug resolved in EF5.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-05T17:22:17.780

不。

[相关的 UserVoice 建议](https://data.uservoice.com/forums/72025-entity-framework-feature-suggestions/suggestions/2929682-support-database-default-values-in-code-first)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:00:38.100

您可以扩展生成的类并在 patial 类的构造函数中设置默认值。

```
public partial MyEntityClass MyEntity
{
    public MyEntityClass() 
    {
        this.DefaultValueProperty = defaultValue;
    }
} 
```

# node.js - Mongoose.model vs Connection.model vs Model.model

> ID：12806559
> 
> 赞同：15
> 
> 时间：2012-10-09T18:55:05.473
> 
> 标签：node.js, mongodb, mongoose, odm

I am bit confused with usage of models in [mongoosejs](http://mongoosejs.com/index.html)

Models can be created using mongoose in these ways

**Using Mongoose**

```
var mongoose = require('mongoose');
var Actor = mongoose.model('Actor', new Schema({ name: String })); 
```

**Using Connection**

```
var mongoose = require('mongoose');
var db = mongoose.createConnection(..);
db.model('Venue', new Schema(..));
var Ticket = db.model('Ticket', new Schema(..));
var Venue = db.model('Venue'); 
```

**Using existing Model instance**

```
var doc = new Tank;
doc.model('User').findById(id, callback); 
```

Now what is the difference between model returned by [`Mongoose.model`](http://mongoosejs.com/docs/api.html#index_Mongoose-model) , [`Connection.model`](http://mongoosejs.com/docs/api.html#connection_Connection-model) and [`Model.model`](http://mongoosejs.com/docs/api.html#model_Model-model). and when to use what , what is the recommended way to create/fetch model ?

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-09T19:33:30.670

1.  `mongoose.model`将定义的模型与调用创建的默认连接联系起来`mongoose.connect`。
2.  `db.model`将模型与调用创建的连接联系起来`var db = mongoose.createConnection`。
3.  `doc.model``doc`使用模型所绑定的连接按名称查找另一个模型。

这三个都可以在同一个程序中合理地使用；使用哪一个取决于具体情况。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-13T23:36:19.993

好的，这就是[我发现的](https://github.com/LearnBoost/mongoose)

> 重要的！如果您使用 mongoose.createConnection() 打开了单独的连接，但尝试通过 mongoose.model('ModelName') 访问模型，它将无法按预期工作，因为它没有连接到活动的数据库连接。在这种情况下，通过您创建的连接访问您的模型：

```
var conn = mongoose.createConnection('your connection string');
var MyModel = conn.model('ModelName', schema);
var m = new MyModel;
m.save() // works 
```

对比

```
var conn = mongoose.createConnection('your connection string');
var MyModel = mongoose.model('ModelName', schema);
var m = new MyModel;
m.save() // does not work b/c the default connection object was never connected 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-02T02:46:03.797

mongoose.connect 是为你连接到同一个数据库，虽然你的数据库是 balance 或 replicaSet

db.model 用于向 Mongo 打开的多个连接，每个连接具有不同的读/写设置

# heroku - Gunicorn Worker 进程和 Heroku Worker Dynos 之间的区别

> ID：12806562
> 
> 赞同：7
> 
> 时间：2012-10-09T18:55:16.090
> 
> 标签：heroku, gunicorn

我希望社区可以为我澄清一些事情，并且其他人可以从中受益。

我的理解是 gunicorn 工作进程本质上是 Heroku web dynos 的虚拟复制品。换句话说，*Gunicorn 的工作进程不应该与 Heroku 的工作进程*（例如 Django Celery Tasks）混淆。

这是因为 Gunicorn 工作进程专注于处理 Web 请求（基本上是限制 Heroku Web Dyno 的性能），而 Heroku Worker Dynos 专注于远程 API 调用等长期运行的后台任务。

我有一个简单的 Django 应用程序，它充分利用了远程 API，我想优化资源平衡。我也在查询大多数请求的 PostgreSQL 数据库。

我知道这过于简单化了，但是我是否正确地考虑了事情？

**一些相关信息：**

[https://devcenter.heroku.com/articles/process-model](https://devcenter.heroku.com/articles/process-model)

[https://devcenter.heroku.com/articles/background-jobs-queueing](https://devcenter.heroku.com/articles/background-jobs-queueing)

[https://devcenter.heroku.com/articles/django#running-a-worker](https://devcenter.heroku.com/articles/django#running-a-worker)

[http://gunicorn.org/configure.html#workers](http://gunicorn.org/configure.html#workers)

[http://v3.mike.tig.as/blog/2012/02/13/deploying-django-on-heroku/](http://v3.mike.tig.as/blog/2012/02/13/deploying-django-on-heroku/)

[https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/gunicorn/](https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/gunicorn/)

**对于那些研究这个主题的人来说，其他准相关的有用 SO 问题：**

[Nginx + Gunicorn + Django Stack 上的站点缓慢故障排除](https://stackoverflow.com/questions/10401513/troubleshooting-site-slowness-on-a-nginx-gunicorn-django-stack)

[将 Gunicorn 部署到 Heroku 中的 Django 性能下降](https://stackoverflow.com/questions/11713871/performance-degradation-for-django-with-gunicorn-deployed-into-heroku)

[在 Heroku 上为 Django 配置 gunicorn](https://stackoverflow.com/questions/10527512/configuring-gunicorn-for-django-on-heroku)

[Nginx + Gunicorn + Django Stack 上的站点缓慢故障排除](https://stackoverflow.com/questions/10401513/troubleshooting-site-slowness-on-a-nginx-gunicorn-django-stack)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-11T17:00:20.117

为了提供答案并防止人们不得不搜索评论，[测功](https://devcenter.heroku.com/articles/dynos)机就像一台完整的计算机。使用[Procfile](https://devcenter.heroku.com/articles/procfile)，您可以为每个dynos 运行*一个命令*，然后它会在该命令上启动，定期重新运行以刷新它并在崩溃时重新运行它。可以想象，浪费整台计算机运行单线程网络服务器是相当浪费的，这就是[Gunicorn](http://gunicorn.org/)的用武之地。

Gunicorn 主线程只是充当代理服务器，生成给定数量的应用程序副本（工作者），在它们之间分发 HTTP 请求。它利用了每个测功机实际上具有多个核心的事实。正如有人提到的，您应该选择的工作人员数量取决于您的应用程序运行所需的内存量。

与 Bob Spryn 在上一条评论中所说的相反，还有其他方法可以利用这种并行性机会在同一个测功机上运行不同的服务器。最简单的方法是创建一个单独的子 procfile 并按照[这些](http://www.radekdostal.com/content/heroku-running-multiple-python-processes-single-dyno-using-honcho)说明从您的*主 Procfile*运行全 Python [Foreman](http://ddollar.github.io/foreman/)等效项[Honcho](https://pypi.python.org/pypi/honcho)。本质上，在这种情况下，您的单个 dyno 命令是一个管理多个单个命令的程序。这有点像从精灵那里得到一个愿望，然后再许下 4 个愿望。

 *The advantage of this is you get to take full advantage of your dynos' capacity. The disadvantage of this approach is that you lose the ability scale individual parts of your app independently when they're sharing a dyno. When you scale the dyno, it will scale everything you've multiplexed onto it, which may not be desired. You will probably have to use diagnostics to decide when a service should be put on its own dedicated dyno.*

# xcode - 如何在 .m 文件中编码属性

> ID：12806574
> 
> 赞同：1
> 
> 时间：2012-10-09T18:55:56.613
> 
> 标签：xcode

自从下载了最新版本的 Xcode 以来，我刚刚开始了一个新的 Xcode 项目。我马上注意到，在.h 文件中声明一个属性时，它不会在 .m 文件中自动合成，也不会在 ViewDidUnload 存根中设置为 nil。此外...没有 ViewDidUnload IBAction 存根。在对堆栈溢出进行了一些研究之后，我意识到这是新的和正常的。

我还注意到新的 didReceiveMemoryWarning 并且有人写了以下内容：如果您想释放与视图或其他 UI 对象无关的内存，请使用 didReceiveMemoryWarning。

我的问题是……之前，Xcode 会在 viewDidUnload 中自动将属性设置为 nil。它不会在 didReceiveMemoryWarning 中将它们设置为 nil。我应该在 didReceiveMemoryWarning 存根中手动将这些设置为 nil 还是将存根留空，就像 Xcode 创建 .m 文件时一样？是否有任何地方在不再使用时需要将属性设置为 nil，或者 Xcode 现在会自动执行此操作吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:04:19.097

大多数 UI 元素使用的内存确实微不足道。这是 iOS 已弃用（现在不再调用）的原因之一`viewDidUnload`。仅仅证明麻烦（包括可能的错误）的合理性并不重要。

`didReceiveMemoryWarning`是您应该减少任何*显着*内存使用的地方。特别是，它是转储您可以重建的任何缓存信息的好地方。在我看来，您应该查看至少 10 KB 范围内的内容。转储几百字节通常不值得管理它所需的代码（代码本身需要内存，加上测试和维护）。`didReceiveMemoryWarning`如果您不缓存很多东西，您可能根本不需要在许多程序中。（还有其他工具，比如，无论如何`NSCache`都比手工编码更好。）`didReceiveMemoryWarning`

# javascript - 按 css 位置重新排序 dom 中的元素

> ID：12806577
> 
> 赞同：0
> 
> 时间：2012-10-09T18:56:08.157
> 
> 标签：javascript, css

如何根据左侧的 css 位置重新排序 dom 元素？

我有 3 个元素，其`left`值为 10%、20% 和 30%，并且`position: absolute`.

在 DOM 中，它们是按顺序排列的，`20, 10, 30`但我想根据`left`属性 ( `10, 20, 30`) 对它们进行升序排列。

所有三个元素都在`div`带有 id的内部`parent`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:08:58.810

您需要将子元素作为数组循环，以便对它们进行排序，然后您需要以正确的顺序重新附加子元素。这可以在没有 jQuery 的纯 JavaScript 中完成：

```
var parent = document.getElemntById(parent),
    children = [];

// loop through the child nodes, add them to your array
// and remove them from the parent
for (var i = parent.childNodes.length-1; i >= 0; i--) {
    children.push(parent.childNodes[i]);
    parent.removeChild(parent.childNodes[i]);
}
// sort them based on the left property
children.sort(function(a,b){
    return window.getComputedStyle(a)['left'] - window.getComputedStyle(b)['left'];
});
// add them back to the parent in order
for (var i in children) {
    parent.appendChild(children[i]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T18:59:20.410

基本上，循环遍历要修改的 DOM 元素，将它们放入数组中。然后按您想要的属性对数组进行排序（在这种情况下`window.getComputedStyle(elem)['left']`），然后按照数组告诉您的顺序重新插入元素。

# servicestack - ServiceStack 验证 - 缺少方法

> ID：12806582
> 
> 赞同：1
> 
> 时间：2012-10-09T18:56:44.963
> 
> 标签：servicestack

我正在尝试实施验证并阅读：

[https://github.com/ServiceStack/ServiceStack/wiki/Validation](https://github.com/ServiceStack/ServiceStack/wiki/Validation)

我看到正在使用这种方法。它似乎不在 Funq 容器上，我错过了什么？

```
//This method scans the assembly for validators
container.RegisterValidators(typeof(UserValidator).Assembly); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:45:08.277

如果您认为 ServiceStack 中缺少某个方法，则很可能是扩展方法。[RegisterValidators()](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/Validation/ValidationFeature.cs#L97)是**ServiceStack.ServiceInterface.Validation**命名空间中的扩展方法。

您应该考虑使用[ReSharper](http://www.jetbrains.com/resharper/)，因为它消除了 C# 开发的一整类问题，包括定位方法、自动包括命名空间、自动引用 dll 等。

否则，如果由于某种原因你想在没有 ReSharper 的情况下继续，你可以使用在[ServiceStack GitHub Repo](http://github.com/ServiceStack/ServiceStack)`T`中查找文件的快捷方式，否则可以在 ServiceStack 的本地分支中进行解决方案范围的文本搜索。`Ctrl+Shift+F`

# linux - Linux 上 32 位代码中的“int 0x80”或“syscall”哪个更好？

> ID：12806584
> 
> 赞同：69
> 
> 时间：2012-10-09T18:56:52.323
> 
> 标签：linux, assembly, x86, system-calls, 32-bit

我研究了 Linux 内核，发现对于 x86_64 架构，中断`int 0x80`不适用于调用系统调用¹。

**对于 i386 架构（32 位 x86 用户空间），更可取的是：`syscall`或者`int 0x80`为什么？**

我使用 Linux 内核版本 3.4。

* * *

脚注 1：`int 0x80`在某些情况下可以在 64 位代码中使用，但从不推荐。 [如果在 64 位代码中使用 32 位 int 0x80 Linux ABI 会发生什么？](https://stackoverflow.com/questions/46087730/what-happens-if-you-use-the-32-bit-int-0x80-linux-abi-in-64-bit-code)

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-10-09T19:18:54.770

*   `syscall`是进入内核模式的默认方式`x86-64`。*此指令在 Intel 处理器*的 32 位操作模式下不可用。
*   `sysenter`是最常用于在 32 位操作模式中调用系统调用的指令。它类似于`syscall`，虽然使用起来有点困难，但这是内核关心的问题。
*   `int 0x80`是调用系统调用的传统方式，应避免使用。

调用系统调用的首选方法是使用[vDSO](https://en.wikipedia.org/wiki/VDSO)，它是映射在每个进程地址空间中的内存的一部分，允许更有效地使用系统调用（例如，在某些情况下根本不进入内核模式）。`int 0x80`与传统方式相比，vDSO 还处理更困难的处理`syscall`或`sysenter`指令。

另外，请参阅[this](https://articles.manugarg.com/systemcallinlinux2_6.html)和[this](https://www.win.tue.nl/~aeb/linux/lk/lk-4.html)。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-10-09T19:13:48.903

我[在这里](https://stackoverflow.com/a/12788057/841108)的回答涵盖了你的问题。

在实践中，最近的内核正在实现[VDSO](http://en.wikipedia.org/wiki/VDSO)，特别是为了动态优化系统调用（内核将 VDSO 设置为一些最适合当前处理器的代码）。所以你应该使用VDSO，对于现有的系统调用，你最好使用libc提供的接口。

请注意，AFAIK，简单系统调用成本的很大一部分是从用户空间到内核并返回。因此，对于某些系统调用（可能`gettimeofday`，`getpid`...），VDSO 甚至可以避免这种情况（并且在技术上可能会避免进行真正的系统调用）。对于大多数系统调用（如`open`, `read`, `send`, `mmap`....），系统调用的内核成本大到足以使用户空间到内核空间转换（例如使用`SYSENTER`或`SYSCALL`机器指令而不是`INT`）的任何改进都微不足道。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-10-08T19:48:54.687

在更改之前要注意这一点：在执行 0x80 或 syscall 时，**系统调用号会有所不同**，例如 sys_write 在 0x80 时为 4，在 syscall 时为 1。

[http://docs.cs.up.ac.za/programming/asm/derick_tut/syscalls.html](http://docs.cs.up.ac.za/programming/asm/derick_tut/syscalls.html) 32 位或 0x80 [http://blog.rchapman.org/post/36801038863/linux-system-call-table- for-x86-64](http://blog.rchapman.org/post/36801038863/linux-system-call-table-for-x86-64)用于系统调用

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2012-10-09T19:11:03.630

`int 0x80`是一个更好的术语，表示它是对内核的**系统调用**，告诉它做某事。

含义和解释可以互换，“进行系统调用”或“发布 int 80h”。

这与 DOS 时代没有什么不同：

*   调用 int 21h 让 DOS 做一些依赖于 AX 寄存器和可选的 ES:DX 寄存器对的事情，
*   int 13h 是 BIOS 硬盘处理程序。
*   int 10h 是 EGA/VGA 屏幕。
*   int 09h 是键盘处理程序。

这里的共同主题是，当调用中断/系统调用时，内核会检查寄存器的状态以查看需要什么类型的系统调用。通过查看例如，例如`eax`注册并确定要执行的操作，内部上下文切换到内核空间，执行过程并将上下文切换回用户空间，并可以选择返回调用结果，即它是成功的还是失败的。

# java - Java 获取从 N 提高到 n 的确切值

> ID：12806585
> 
> 赞同：3
> 
> 时间：2012-10-09T18:56:53.133
> 
> 标签：java, bigdecimal

我有这个简单的问题。

样本输入：

输入一 `95.123`

输入二`12`

将第一个输入提高到第二个输入必须给出精确的功率值。像这样 ：`548815620517731830194541.8990253434157159735359672218698`

我做错了。

这是我到目前为止所做的。我想我错过了什么

```
System.out.println("Input One");
Scanner scanner = new Scanner(System.in);
Double inputOne = scanner.nextDouble();
System.out.println("Input Two");
Double inputTwo = scanner.nextDouble();
Double result = Math.pow(inputOne, inputTwo);
BigDecimal big = new BigDecimal(result);
System.out.println(big); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-09T19:00:26.080

> 我错过了什么？

您`double`开始使用，并且`double`不能准确表示 95.123。然后您使用`Math.pow`双精度值，这将进一步失去精度。将已经有损的值转换为高精度值是没有意义的……它无法神奇地恢复数据。

只需将一个*字符串*传递给第一个参数的`BigDecimal`构造函数，并[`BigDecimal.pow`](http://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html#pow%28int%29)进行计算。

示例代码：

```
import java.math.BigDecimal;

public class Test {

    public static void main(String[] args) {
        BigDecimal inputOne = new BigDecimal("95.123");
        int power = 12;
        BigDecimal result = inputOne.pow(power);
        System.out.println(result);
    }
} 
```

输出：

```
548815620517731830194541.899025343415715973535967221869852721 
```

（看起来您的期望值实际上被截断了......确切的值绝对应该以 1 结尾，因为 3 ^(12)以 1结尾。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T19:02:18.147

在执行 pow 之前，您需要使用 BigDecimal。例如，以下返回预期结果：

```
System.out.println(new BigDecimal("95.123").pow(12)); 
```

请注意，传入的值`BigDecimal`必须是 a`String`因为 a`double`没有足够的精度来保存确切的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T19:01:57.697

`BigDecimal#pow`不使用`Math.pow`。

# vb.net - .txt 文件中的变量

> ID：12806587
> 
> 赞同：0
> 
> 时间：2012-10-09T18:57:01.207
> 
> 标签：vb.net, notepad

我想将我的变量放在 .txt 文件中。我以前从来没有做过（我的意思是把变量放在 .txt 文件中）。我的文件应该包括什么？当我想使用 If 函数时，我应该在我的 vb 项目中添加什么。前任。我的变量名 = dzien 值 = 0

```
Private Sub zapisz_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)      Handles zapisz.Click
     Open "C:\Plik.txt" For Append As #1 
If dzien = 0 Then
TextBlock1.txt += "dzien jest 0"
End IF 
```

如果 .txt 文件中有我的变量，此功能是否有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:10:47.890

有多种方法可以做到这一点。例如，您可以将值存储在文本文件、二进制文件、XML 文件、ini 文件或配置文件中。最简单的选择是使用内置的设置框架。为此，请转到您的项目属性并单击设置选项卡。创建一个名为“DZien”的新设置并将类型设置为整数。然后，在代码中，您可以像这样访问和设置配置文件中的值：

```
Dim dzein As Integer = My.Settings.Dzien.ToString()  ' Read value from config file
My.Settings.Dzien = 5  ' Write new value to config file 
```

相反，如果你想在文本文件中存储一个数字，你可以这样做：

```
Dim dzein As Integer = Integer.Parse(File.ReadAllText("C:\Plik.txt")) '  Read value from text file
File.WriteAllText("C:\Plik.txt", dzein.ToString()) 
```

在您的情况下，您正在编写一个 Windows Phone 应用程序，您可以这样做：

```
Partial Public Class_1
    Inherits PhoneApplicationPage
    Private dzien As Integer

    Public Sub New()
        InitializeComponent()
    End Sub

    Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs) Handles Button2.Click
        Try
            dzien = CInt(IsolatedStorageSettings.ApplicationSettings("dzien"))
        Catch ex As KeyNotFoundException
            dzien = 0
        End Try
        If dzien = 0 Then
            ' ...
        End If
    End Sub

    Private Sub Class_1_Unloaded(ByVal sender As Object, ByVal e As System.Windows.RoutedEventArgs) Handles Me.Unloaded
        IsolatedStorageSettings.ApplicationSettings("dzien") = dzien
    End Sub
End Class 
```

# java - Java final 变量在执行时发生变化

> ID：12806590
> 
> 赞同：0
> 
> 时间：2012-10-09T18:57:13.523
> 
> 标签：java

我不知道那是什么原因。也许你可以帮助我

所以在这里编写代码创建一个带有 8 个滑块的框架。

```
public class MyFrame extends JFrame {

ImagePanel imagePanel;
final int Minimum = 0;
final int Maximum = 10;
final int NumberOfSpheres = 8;
final int NumberOfScales = 10;
MyRandomAccessFile file;

final String[] s = {"Друзья и Окружение",
        "Отношения", "Карьера и Бизнес",
        "Финансы", "Духовность и Творчество",
        "Личностный Рост", "Яркость Жизни", "Здоровье и Спорт"};

private final Color[] colors = {Color.RED, Color.ORANGE, Color.YELLOW, Color.GREEN, Color.BLUE, Color.PINK, Color.MAGENTA, Color.DARK_GRAY};

private final int[] array = {1, 0, 0, 0, 0, 0, 0, 0};

public MyFrame () {

    setTitle("Wheel Of Life");

    MySlider[] sliders = new MySlider[NumberOfSpheres];
    JButton saveButton = new JButton("Save");
    MyActionListener listener1 = new MyActionListener();
    saveButton.addActionListener(listener1);

    file = new MyRandomAccessFile();

    //String s3 = "0 0 0 0 0 0 0 0";
    //array = stringToIntArray(s3);
    array[1] = 4;

    JLabel[] labels = new JLabel[NumberOfSpheres];
    imagePanel = new ImagePanel(colors, array);
    System.out.println(array[1]);
    JPanel mainPanel = new JPanel();
    JPanel[] sliderPanels = new JPanel[NumberOfSpheres];
    JPanel mainSliderPanel = new JPanel(new GridLayout(4, 2, 20, 20));
    MyChangeListener listener = new MyChangeListener();

    for (int i = 0; i < NumberOfSpheres; i++) {
        sliders[i] = new MySlider(s[i]);
        sliders[i].addChangeListener(listener);
        labels[i] = new JLabel(s[i]);
        labels[i].setForeground(colors[i]);
        labels[i].setFont(new Font("Droid Sans", Font.BOLD, 20));
        sliderPanels[i] = new JPanel();
        sliders[i].setMinimum(Minimum);
        sliders[i].setMaximum(Maximum);
        System.out.print(array[i]);
        sliders[i].setValue(4);
        sliders[i].setMajorTickSpacing(1);
        sliders[i].setMinorTickSpacing((int) 0.1);
        sliders[i].setPaintLabels(true);
        sliders[i].setPaintTicks(true);
        sliderPanels[i].setLayout(new GridLayout(2, 1, 5, 5));
        sliderPanels[i].add(sliders[i]);
        sliderPanels[i].add(labels[i]);
        mainSliderPanel.add(sliderPanels[i]);

    }

    mainPanel.setLayout(new BorderLayout());
    mainPanel.add(imagePanel, BorderLayout.CENTER);
    mainPanel.add(mainSliderPanel, BorderLayout.EAST);
    mainPanel.add(saveButton, BorderLayout.SOUTH);

    add(mainPanel);
} 
```

输出是这样的

4 99999999

final 变量如何在执行时改变它的值，到底是什么？？？变量的实际值取决于我在 sliders[i].setValue(4); 处写入的值；但我不知道具体怎么...

我试图为这个变量设置一个观察点......不起作用。一次为零，下一次程序在此 for 循环中停止，值为 9、4 或其他...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T18:58:43.263

当您将引用声明为 final 时，您无法更改引用，但您可以更改底层对象状态。

你无法改变

```
int[] array = somethingelse; 
```

但

```
array[1] = 5; 
```

已验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T18:59:37.217

当在 Java 中声明一个变量 final 时，就像在说这个名字不会被重新分配给别的东西。并不意味着内容不会是可变的。数组和对象的内容一般都可以修改。

```
final List<String> list = new ArrayList<String>();

list.add("foo");//ok
list.add("bar");//ok

list.remove(0);//ok

list = new ArrayList<String>(); //should cause compile error 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:00:12.030

将 final 设置为数组并不意味着您不能添加或更改元素值，而是意味着您现在可以为该变量分配另一个数组引用。但是您可以添加、更新或删除该数组中的元素

# c++ - WinHttpQueryDataAvailable 下载数据时返回各种结果

> ID：12806592
> 
> 赞同：0
> 
> 时间：2012-10-09T18:57:21.927
> 
> 标签：c++, winapi, http

我正在尝试从一个站点下载一个相当大的文件，并且每天会进行多次下载。我正在使用循环`WinHttpQueryDataAvailable(hRequest, &dwSize)`并`WinHttpReadData( hRequest, (LPVOID)pszOutBuffer, dwSize, &dwDownloaded)`连续读取文件的数据，直到完全下载，这在 dwSize == 0 时确定。但是，有时我在下载文件时收到错误代码，特别是 12030 和 12002（ERROR_WINHTTP_CONNECTION_ERROR 和ERROR_WINHTTP_TIMEOUT）。

为代码添加一些弹性的最佳方法是什么？我是否应该尝试重新连接并从中断的地方继续？如果是这样，如何使用 WinHTTP 函数来完成？超时已经相当长了；超时错误实际上也可能是连接错误吗？

任何意见，将不胜感激！

# silverlight - 覆盖 Silverlight 的 Internet Explorer 事件

> ID：12806600
> 
> 赞同：5
> 
> 时间：2012-10-09T18:57:47.077
> 
> 标签：silverlight, internet-explorer, xna

我正在创建一个使用 XNA 和 Silverlight 的应用程序。我想要做的是能够使用 IE 通常选择的快捷方式和命令。例如，如果我按 Control-S，我不希望 IE 保存页面。我想做我自己的行动。

这样的事情可能吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-03T13:17:26.343

AFAIK 你不能那样做。因为 Internet Explorer 有自己的行为，您无法更改这些行为的方式。

因此，您必须实现另一种方法来在 Silverlight 的应用程序上实现快捷方式。

# php - PHP：实体中文档末尾的额外内容，试图提取nodeValue

> ID：12806601
> 
> 赞同：8
> 
> 时间：2012-10-09T18:57:50.943
> 
> 标签：php, domdocument

```
<?php

echo getValue('<a>dk</a><b>sh</b>', 'a');

function getValue($string, $tagname) {
    $dom = new DomDocument();
    $dom->loadXML($string);
    $node_list = $dom->getElementsByTagName($tagname)->item(0);
    return $node_list->nodeValue;
} 
```

运行脚本返回

```
Warning: DOMDocument::loadXML(): Extra content at the end of the document in Entity, line: 1 in /Users/johnkim/get.php on line 7 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-09T19:09:47.600

好吧，您的 xml 字符串无效。尝试用任何标签包装它，例如：

```
<some_tag><a>sdfsdf</a><b>sdfsdf</b></some_tag> 
```

# html - 为什么这些子 div 不与父级的右侧对齐？

> ID：12806604
> 
> 赞同：2
> 
> 时间：2012-10-09T18:58:08.563
> 
> 标签：html, css

我正在尝试使用以下设计实现一个简单的 UI：

![在此处输入图像描述](../Images/0857947e63c4e34a47474d59f74629c2.png)

但是得到以下信息（我在每个 s 边框周围添加了实心红线，`<div>`这样我就可以看到 div 边框；一旦正确放置所有内容，将删除它们）：

![在此处输入图像描述](../Images/881a88b5c612e3d25b1410316493d03f.png)

这是代码：

```
<html>
<head>
    <title>Options</title>
    <style>
        #control-panel-div {
            right: 0px;
        }
    </style>    
</head>
<body>
    <div id="content">
        <div id="option-sel-div" style="border: 1px solid red;">
            <select id="provider-sel">
                <option selected="selected" id="default">Select an option</option>
                <option id="1">option1</option>
                <option id="2">option2</option>
            </select>
        </div>

        <div id="config-manage-div" style="border: 1px solid red;">
            <div id="control-panel-div" style="border: 1px solid red;">
                <input id="add-config-btn" type="button" value="Add"/>

                <input id="remove-config-btn" type="button" value="Remove"/>
            </div>

            <div id="table-div" style="border: 1px solid red;">
                <div id="config-datatable">
                    <table>
                        <tr>
                            <td>
                                Blah
                            </td>
                            <td>
                                bleh
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Fizz
                            </td>
                            <td>
                                Buzz
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
</body>
</html> 
```

我*相信*通过设置`control-panel-div`的`right`属性值为 0px，那么它的所有孩子都应该是右对齐的，但是对于我的生活，我无法让它工作（我也尝试过`text-align`，和`box-align`）。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T19:01:15.503

我不会对此使用表格发表评论，但您可以将 CSS 更改为：

```
#control-panel-div {
    text-align: right;
}​ 
```

来获得效果。

**[jsFiddle 示例](http://jsfiddle.net/j08691/UBHBa/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T19:02:12.570

尝试

```
#control-panel-div {
    float: right;
} 
```

如果您需要阅读该属性，这里是文档：http: [//www.w3schools.com/css/css_float.asp](http://www.w3schools.com/css/css_float.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:06:14.540

没有太多麻烦，并且标记更清晰：

```
<style type="text/css">
    form {
        width: 300px;
    }
    fieldset {
        float: right;
        border: 0;
    }
    table {
        clear: both;
    }
</style>

<form action="index.php">
    <select name="the_select">
        <option selected="selected" id="default">Select an option</option>
        <option id="1">option1</option>
        <option id="2">option2</option>
    </select>
    <fieldset>
        <legend>Controls</legend>
        <button>Add</button>
        <button>Remove</button>
    </fieldset>
    <table>
        <tr>
            <td>
                Blah
            </td>
            <td>
                bleh
            </td>
        </tr>
        <tr>
            <td>
                Fizz
            </td>
            <td>
                Buzz
            </td>
        </tr>
    </table>

</form> 
```

# regex - 使用 Regex 匹配正则表达式的两个位置中的不定字符串

> ID：12806608
> 
> 赞同：3
> 
> 时间：2012-10-09T18:58:32.227
> 
> 标签：regex

我想匹配表单的表达式

```
set _ on(\s*)set _ off 
```

其中两个下划线都`_`代表一个连续的字符串。

这个想法是匹配以下内容：

> set foo on blah halb set foo off
> 
> 设置栏打开 设置栏打开 设置栏打开 设置栏关闭

重要的是，在我的情况下，这些指令以设置为开始，以设置为结束。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:02:07.400

怎么样

```
set\s[^\s]+\son
set\s[^\s]+\soff 
```

说明：`[^\s]+`匹配不包含空格的字符串。`set\s[^\s]+\son`匹配任何类似的东西`set foo on`，但不匹配`set foo bar on`or `set on`。结合上述表达式将匹配您想要的任何内容。

您使用哪种正则表达式？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T19:05:09.200

您可以在 perl 中进行反向引用：

```
m/^\s*set\s*(\w*)\s*on.*set\s*\1\s*off\s*$/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:42:01.427

```
^(set bar on)|(set bar off)$ 
```

分解：

```
^(set bar on) = Looks for "set bar on" at the beginning of a string
(set bar off)$ = Looks for "set bar off" at the end of the string. 
```

这将匹配`set bar on`字符串开头和`set bar off`结尾处的 a。您可以进行替换以将它们更改为空白字符`""`，然后将剩余的数据拉出以进行匹配。我不知道您在执行正则表达式时使用什么，所以除此之外我无能为力。`\s`如果要删除`set bar on`前后的空格，也可以在开头和结尾添加`set bar off`。

# clojure - clojure 映射对序列

> ID：12806612
> 
> 赞同：8
> 
> 时间：2012-10-09T18:58:47.017
> 
> 标签：clojure

```
 (def tmp = [ 1 2 3 9 4 8]) 
```

我正在尝试创建 2 对，然后对于每一对，从第一个数字中减去第二个数字。期望的结果：（1 6 4）

这是我正在尝试的：

```
(map #(apply - %2 %1) (partition 2 tmp)) 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-09T19:04:39.870

分区产生一系列序列，因此您映射到它们上的函数需要期待一个包含两个项目的序列。有几种表达方式：

```
(def tmp  [ 1 2 3 9 4 8])

user> (map #(- (second %) (first %)) (partition-all 2 tmp ))
(1 6 4)

user> (map #(apply - (reverse %)) (partition-all 2 tmp ))
(1 6 4)

user> (map (fn [[small large]] (- large small)) (partition-all 2 tmp ))
(1 6 4) 
```

使用 apply 的版本不同，因为它仍然会在奇数长度列表上“工作”：

```
user> (map #(apply - (reverse %)) (partition-all 2 [1 2 3 4 5 6 7] ))
(1 1 1 -7) 
```

其他人将在无效输入时崩溃，您可能更喜欢。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T20:06:56.950

这是使用的解决方案`reduce`

```
(reduce #(conj %1 (apply - (reverse %2)))  [] (partition-all 2 [1 2 3 9 4 8])) 
=> [1 6 4] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T00:46:14.940

我想知道为什么这个解决方案被忽略了......

由于切换减法顺序只是原始减法的负数，（ab = -（ba）），因此解决方案变得更加有效（仅在这种特殊情况下！！）

```
(map #(- (apply - %)) (partition-all 2 [1 2 3 9 4 8])) 
```

在教学法上，亚瑟的解决方案是正确的。这只是一个更适合特定问题的解决方案。

# java - 无法使用 DateTimeFormat 注释让 Spring MVC 解析日期时间

> ID：12806613
> 
> 赞同：5
> 
> 时间：2012-10-09T18:58:48.507
> 
> 标签：java, spring, rest, spring-mvc, jodatime

我想在休息服务中使用路径参数作为完整的 ISO 时间戳。

```
http://domain:8080/ctx/someObj/2000-10-31 01:30:00.000-05:00 
```

我之前打开了 mvc:annotation 驱动，但将其关闭，因此我可以在 DefaultAnnotationHandlerMapping 上将“useDefaultSuffixPattern”设置为 false。

控制器代码

```
@RequestMapping(value = "/lwc/{userMidnightTime}", method = RequestMethod.GET)
@ResponseBody
public List<ProgramSnippetView> getLiveWebcastsWithin24HoursOfTime(@PathVariable(value = "userMidnightTime") @DateTimeFormat(iso= DATE_TIME) Date userMidnightTime) {
    Calendar cal = new GregorianCalendar();
    cal.setTime(userMidnightTime);
    cal.add(Calendar.HOUR, 24);
    Date endTime = cal.getTime();
    return programService.getLiveWebcastSnippetsWithProductionDateInRange(userMidnightTime, endTime);
} 
```

我收到以下错误。我可以看到框架最终使用正确的字符串调用已弃用的 Date.parse() 方法，而不是使用 joda time 来完成工作。

```
112977 [http-apr-8080-exec-7] DEBUG org.springframework.beans.BeanUtils - No property       editor [java.util.DateEditor] found for type java.util.Date according to 'Editor' suffix convention
117225 [http-apr-8080-exec-7] DEBUG org.springframework.beans.TypeConverterDelegate - Construction via String failed for type [java.util.Date]
org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [java.util.Date]: Constructor threw exception; nested exception is     java.lang.IllegalArgumentException 
```

我希望 joda 解析完整的 ISO 日期，如 org.springframework.format.annotation.DateTimeFormat.java 注释文件中指定的那样：

```
/** 
     * The most common ISO DateTime Format <code>yyyy-MM-dd'T'hh:mm:ss.SSSZ</code> e.g. 2000-10-31 01:30:00.000-05:00.
     * The default if no annotation value is specified.
     */
    DATE_TIME,  ..... 
```

应用上下文配置

```
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:context="http://www.springframework.org/schema/context"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:mvc="http://www.springframework.org/schema/mvc"
   xsi:schemaLocation="
    http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/context
    http://www.springframework.org/schema/context/spring-context-3.0.xsd
    http://www.springframework.org/schema/mvc
    http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

<context:component-scan base-package="blah.blah"/>

<mvc:resources mapping="/resources/**" location="/resources/"/>

<bean id="validator" class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"/>
<bean id="conversionService" class="org.springframework.format.support.FormattingConversionServiceFactoryBean">
    <property name="formatterRegistrars">
        <set>
            <bean class="org.springframework.format.datetime.joda.JodaTimeFormatterRegistrar">
                <property name="useIsoFormat" value="true"/>
            </bean>
        </set>
    </property>
</bean>

<bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping">
    <property name="order" value="0"/>
    <property name="useDefaultSuffixPattern" value="false"/>

    <!-- allows for periods in url -->
</bean>

<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
    <property name="webBindingInitializer">
        <bean class="org.springframework.web.bind.support.ConfigurableWebBindingInitializer">
            <property name="validator" ref="validator"/>
        </bean>
    </property>

    <property name="messageConverters">
        <list>
            <bean class="org.springframework.http.converter.ByteArrayHttpMessageConverter"/>
            <bean class="org.springframework.http.converter.StringHttpMessageConverter">
                <!--<property name="writeAcceptCharset" value="false" />-->
            </bean>
            <bean class="org.springframework.http.converter.xml.SourceHttpMessageConverter"/>

            <bean class="org.springframework.http.converter.ResourceHttpMessageConverter"/>
            <bean class="org.springframework.http.converter.xml.SourceHttpMessageConverter"/>
            <bean class="org.springframework.http.converter.xml.XmlAwareFormHttpMessageConverter"/>
            <bean class="org.springframework.http.converter.xml.Jaxb2RootElementHttpMessageConverter"/>
            <bean class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter"/>
        </list>
    </property>

</bean>

<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/views/"/>
    <property name="suffix" value=".jsp"/>
</bean>

<bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
    <property name="mediaTypes">
        <map>
            <entry key="json" value="application/json"/>
        </map>
    </property>

    <property name="defaultViews">
        <list>
            <bean class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
                <property name="prefixJson" value="true"/>
            </bean>
        </list>
    </property>
</bean>

<mvc:view-controller path="/" view-name="home"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T00:26:06.400

我看到的一个可能的问题是您没有使用 handlerAdapter 注册转换服务，您可以这样做：

```
<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
    <property name="webBindingInitializer">
        <bean class="org.springframework.web.bind.support.ConfigurableWebBindingInitializer">
            <property name="conversionService" ref="conversionService"/>
            <property name="validator" ref="validator"/>
        </bean>
    </property> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-26T10:51:27.233

这太晚了（准确地说是 3 年），但它可能对其他人有所帮助。

该网址缺少时间指示符“T”，因此请尝试

```
http://domain:8080/ctx/someObj/2000-10-31T01:30:00.000-05:00 
```

代替

```
http://domain:8080/ctx/someObj/2000-10-31 01:30:00.000-05:00 
```

# c++ - C ++解析字符串以查找出现

> ID：12806615
> 
> 赞同：0
> 
> 时间：2012-10-09T18:58:53.633
> 
> 标签：c++, string, parsing, input, substring

所以我需要通过以下方式解析用户的输入：如果用户输入

```
C:\Program\Folder\NextFolder\File.txt 
```

或者

```
C:\Program\Folder\NextFolder\File.txt\ 
```

然后我想删除文件并保存

```
C:\Program\Folder\NextFolder\ 
```

我基本上想找到`\`从末尾开始的第一次出现，如果他们放了一个斜杠，那么我可以找到第二次出现。我可以用这段代码先或第二次区分：

```
input.substr(input.size()-1,1)!="/" 
```

但我不明白如何从最后*开始*找到第一次出现。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:13:23.280

这个

```
input.substr(input.size()-1,1)!="/" 
```

效率很低*。利用：

```
if( ! input.empty() && input[ input.length() - 1 ] == '/' )
{
    // something
} 
```

* * *

从头开始寻找第一次出现的东西与从头开始寻找最后一个“某物”是一样的。您可以使用[`find_last_of`](http://www.cplusplus.com/reference/string/string/find_last_of/), 或[`rfind`](http://www.cplusplus.com/reference/string/string/rfind/)或者，您甚至可以使用 standard `find`，与[`rbegin`](http://www.cplusplus.com/reference/string/string/rbegin/)and结合使用[`rend`](http://www.cplusplus.com/reference/string/string/rend/)

* * *

*`std::string::substr`创建一个子字符串，`"/"`可能创建另一个（取决于`std::string::operator!=`），比较两个字符串并销毁临时对象。

* * *

注意

> C:\Program\Folder\NextFolder\File.txt\

不是文件的路径，而是目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T19:14:30.417

如果您`input`是类型`std::string`（我认为是），您可以使用`string::find`普通搜索和`string::rfind`反向搜索（从头到尾）进行搜索，还可以检查您不需要且不应该使用的最后一个字符`substr`，因为它会创建一个新的字符串实例只是为了检查一个字符。你可能只是说`if( input.back() == '/' )`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:13:18.120

如果您使用的是 C++ 字符串，请尝试在字符串上使用[反向迭代器](http://www.cplusplus.com/reference/string/string/rend/)，以编写您自己的逻辑来判断什么是可接受的，什么是不可接受的。我提供的链接中有一个明确的例子。

根据我的猜测，您正在尝试存储给定路径的目录名称，该路径可能以文件或目录结尾。

如果是这种情况，您最好删除尾随的“\”并检查它是否是一个目录，如果是则停止，否则继续。

或者，您可以尝试将 '\' 上的字符串分成两部分。这里有一些相关的注释[。](https://stackoverflow.com/questions/236129/splitting-a-string-in-c)

如果这些是实际文件名（看起来您正在使用 Windows），那么也请尝试[_splitpath](http://msdn.microsoft.com/en-us/library/e737s6tf%28v=vs.71%29.aspx)函数。

# .net - IIS 7.5 上的 .Net Framework 1.1（Windows 7-64 位）

> ID：12806618
> 
> 赞同：1
> 
> 时间：2012-10-09T18:58:56.830
> 
> 标签：.net, windows-7, iis-7.5, .net-1.1, worker-process

我的情况是，我需要在具有 IIS 7.5 的 Windows 7、64 位机器上设置我的 .Net 1.1 代码库。

我尝试了所有可能的博客文章，包括：
[.NET Framework 1.1 on IIS 7](https://stackoverflow.com/questions/4502081/net-framework-1-1-on-iis-7)， [using dot net 1.1 on IIS 7.5 (windows 7 - 32 bit)](https://stackoverflow.com/questions/5940082/using-dot-net-1-1-on-iis-7-5-windows-7-32-bit)， [http://blogs.iis.net/bills/archive/2008/06/02 /installing-asp-net-1-1-with-iis7-on-vista-and-windows-2008.aspx](http://blogs.iis.net/bills/archive/2008/06/02/installing-asp-net-1-1-with-iis7-on-vista-and-windows-2008.aspx)

还有很多谷歌搜索。但没有任何效果。我在这里做错了吗？

我正确安装了框架，也按照提示重新启动了几次。但是 .Net Framework 1.1 根本没有作为下拉列表中的选项列出。

**这是屏幕截图。**

![在此处输入图像描述](../Images/dd0e8db7d3d32fb6109eb9e1e5412e58.png)

**第一部分：** ISAPI 和 CGI​​ 限制：正确显示 dll。
**第二部分：**即使在应用程序池中，ASP.NET 1.1 也是按照我遵循的步骤创建的，但框架版本选择不包含 1.1

**这是我的 %windir% 的屏幕截图**

![在此处输入图像描述](../Images/1eba528c6e70f2d111480d43483cf49d.png)

任何帮助是极大的赞赏。

***更新***

我可以设置代码库，但现在这是一个新问题。尝试从 VS 2010 调试时，收到以下消息。任何的想法？

IDE：VS 2010 专业版

IIS：7.5

![在此处输入图像描述](../Images/dbec1c8a76c80bbf16733169f0af705c.png)

好的。经过长时间的努力，我在旧 XP 机器上安装了 VS 2010，并在那里自己重新构建了应用程序，然后将源代码移回 Windows 7。不再使用 Framework 1.1。它现在映射到 4.0（VS 项目转换）

安装了调试诊断并最终导致了此消息。

![在此处输入图像描述](../Images/1ddd4400214d04e904e2a3d10376b114.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T20:33:14.310

[请尝试文章http://answers.microsoft.com/en-us/windows/forum/windows_7-windows_programs/how-to-install-net-framework-11-in-windows-7-64](http://answers.microsoft.com/en-us/windows/forum/windows_7-windows_programs/how-to-install-net-framework-11-in-windows-7-64/eb1e6232-e874-432e-ab43-17660e25e43d)中描述的步骤[/eb1e6232-e874-432e-ab43-17660e25e43d](http://answers.microsoft.com/en-us/windows/forum/windows_7-windows_programs/how-to-install-net-framework-11-in-windows-7-64/eb1e6232-e874-432e-ab43-17660e25e43d)

更新：我刚刚尝试了文章中提到的步骤，它成功安装了 .NET Framework 1.1。如图所示，已经创建了一个 ASP.NET v1.1 应用程序池。但是你是对的，我在创建新的应用程序池时没有在下拉列表中获得 .NET Framework v1.1（我认为这是因为使用 .NET Framework 1.1，集成管道模式根本不可用）

![在此处输入图像描述](../Images/84ae6d435733f6f2caa5f1ca1e17bf9f.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T02:08:25.113

如果您将经典的 .net 应用程序池更改为允许 32 位（在高级设置中），您的 .net 1.1 应用程序将运行（当然，一旦安装了 1.1）。尽管 .net 1.1 根本没有出现在应用程序池的下拉列表中。

我有 .net 1.1 和 IIS 7.5，这就是我让它工作的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T19:15:55.707

正如我所看到的，这个问题现在已经很老了，但想提出我的答案可能对其他人有帮助。

ASP.Net 1.1 与 IIS 7.5 不兼容

您需要为 .Net Framework 1.1 安装 .net Framework 1.1 服务包 1 和 ASp.net 安全更新。

完成此操作后，您可以查看此博客并按照提到的步骤操作。

[http://blogs.charteris.com/blogs/ivorb/archive/2010/07/15/installing-net-1-1-applications-on-windows-server-2008-r2.aspx](http://blogs.charteris.com/blogs/ivorb/archive/2010/07/15/installing-net-1-1-applications-on-windows-server-2008-r2.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-26T02:08:19.373

尝试创建 MKLINK MKLINK /dc:\Windows\Microsoft.NET\Framework64\v1.1.4322 c:\Windows\Microsoft.NET\Framework\v1.1.4322

这个解决方案对我有用，这里解释了原因。 [http://www.uhleeka.com/blog/2009/08/how-to-install-asp-net-v1-1-with-iis7-on-windows-2008-x64/](http://www.uhleeka.com/blog/2009/08/how-to-install-asp-net-v1-1-with-iis7-on-windows-2008-x64/)

# python - 动态实例属性

> ID：12806621
> 
> 赞同：2
> 
> 时间：2012-10-09T18:59:20.123
> 
> 标签：python, class, attributes

说我有一堂课：

```
class Foo(object):
    def __init__(self,d):
        self.d=d

d={'a':1,'b':2}

inst=Foo(d)

inst.d
Out[315]: {'a': 1, 'b': 2} 
```

有没有办法动态地创建 n 个属性，其中每个属性都是一个 dict 键，所以`inst.a`会返回`1`等等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T19:09:05.257

```
class Foo(object):
    def __init__(self, attributes):
        self.__dict__.update(attributes) 
```

这样就可以了。

```
>>>foo = Foo({'a': 42, 'b': 999})
>>>foo.a
42
>>>foo.b
999 
```

您还可以使用`setattr`内置方法：

```
class Foo(object):
    def __init__(self, attributes):
        for attr, value in attributes.iteritems():
            setattr(self, attr, value) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T19:09:44.380

使用`setattr()`：

```
>>> class foo(object):
    def __init__(self, d):
        self.d = d
        for x in self.d:
            setattr(self, x, self.d[x])

>>> d = {'a': 1, 'b': 2}
>>> l = foo(d)
>>> l.d
{'a': 1, 'b': 2}
>>> l.a
1
>>> l.b
2
>>> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T19:29:17.427

这是一个比 pythonm 提供的更古怪的解决方案：

```
class Foo(object):
    def __init__(self, d):
        self.__dict__ = d 
```

而不是使用`inst.d`，`inst.__dict__`直接使用。另一个好处是添加的新键`d`自动成为属性。这是动态的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T20:53:36.553

你可以这样做：

```
class Foo(object):
    def __init__(self, **kwdargs):
        self.__dict__.update(kwdargs)

d = {'a':1,'b':2}

foo = Foo(**d)
foo2 = Foo(a=1, b=2) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-09T20:57:26.553

您也可以使用`__getattr__`.

```
class Foo(object):

    def __init__(self, d):
        self.d = d

    def __getattr__(self, name):
        return self.d[name] 
```

# php - 从 iframe 链接时定义新窗口目标

> ID：12806623
> 
> 赞同：0
> 
> 时间：2012-10-09T18:59:24.840
> 
> 标签：php, html, css

我被要求创建几个基本上反映特定实时网站的网站。实时站点和新站点之间的区别在于，无论您向下滚动多远，页面顶部都会显示一个浮动标题。这与 StumbleUpon 等网站使用的技术相同。我最初的想法是为视图门户使用 Iframe，为标题使用绝对 div。但是，然后我被要求这样做，以便当有人单击 iframe 中的链接时，他们会在新窗口中被带到实际站点。这是让我抛出的部分。有没有办法告诉 I 框架打开新目标中的所有链接？如果不是，你会推荐什么？

请参阅附图以进行说明： ![在此处输入图像描述](../Images/3ce27866b3f25363f0e8a610cbaf0b6d.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:17:12.647

定位锚中的空白在这里应该可以正常工作。

```
<a target="_blank" href="http://google.com">google</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:37:23.457

通过一些跨浏览器的黑客攻击，您可能能够判断 iframe src 何时更改，然后您可以在新窗口中重新加载页面。虽然无法说出新 URL 是什么，但它不会是最好的用户体验，因为您会将它们发送回您最初加载的页面。 [http://www.nczonline.net/blog/2009/09/15/iframes-onload-and-documentdomain/](http://www.nczonline.net/blog/2009/09/15/iframes-onload-and-documentdomain/)

# jquery - Jquery submit() 函数不起作用

> ID：12806626
> 
> 赞同：1
> 
> 时间：2012-10-09T18:59:35.890
> 
> 标签：jquery, html, forms, submit

这是我的代码：

```
function checkupload(){
if(upload == false)
{
    alert("Please upload a file");
    return false;
}
(...)
$('#download_form').submit();
 alert('submitted');
}

My HTML:

<form action="http://localhost/rendu/download.php" method="post" id="download_form">
    <input type="hidden" name="57" id="in_57"/>
    <input type="hidden" name="72" id="in_72"/>
    <input type="hidden" name="png" id="in_png"/>
    <input type="hidden" name="ico" id="in_ico"/>

<a onclick='checkupload()'><img src="images/download_normal.png" onmouseover="mover()" onmouseout="mout()"/></a>
</form> 
```

无论我做什么，表格都不会被提交。我查看了请求，没有请求发送到 download.php 页面，但显示了警报消息。

我错过了什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:10:41.873

您混淆了两件事：绑定到事件处理程序和调用表单提交。

比较 [http://jsfiddle.net/FXd8p/](http://jsfiddle.net/FXd8p/)

和 [http://api.jquery.com/submit/](http://api.jquery.com/submit/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T19:00:44.543

调用提交而不将警报放入其中。

```
$('#download_form').submit(); 
```

# maven - 维护公司范围内 POM 的正确方法

> ID：12806630
> 
> 赞同：2
> 
> 时间：2012-10-09T18:59:46.120
> 
> 标签：maven

我创建了一个全公司范围的 POM，我的所有项目都对其进行了扩展。除了公司名称和所有小细节之外，它还包含有关从何处获取工件（存储库配置）和部署到何处（distributionManagement）的实际配置。该 POM 已安装在公司仓库中。现在的问题是关于从哪里获得公司 pom 的信息在 pom 本身中，所以我必须在第一次手动安装公司 pom 以便项目可以扩展它并从公司 repo 中提取其他依赖项。有什么聪明的方法可以避免这个问题吗？*我不想在其中配置存储库，`settings.xml`*因为我希望其他用户能够签出项目并隐式接收配置。

除了第一次手动安装外，每次公司 pom 更改并且我希望项目继承新版本的 pom 时，我再次必须手动从 repo 下载 pom 并安装它。

有没有关于如何做到这一点的建议，或者有没有人找到一个很好的解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:54:05.263

[Maven SCM 插件`scm:bootstrap`](http://maven.apache.org/scm/plugins/examples/bootstrapping-with-pom.html)目标怎么样？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T20:49:37.210

我的结论是，这根本行不通。每个用户都需要在settings.xml中配置repository；否则，获取工件的位置信息与获取工件的位置相同，因此会产生先有鸡还是先有蛋的问题。

我在公司 pom 中留下的是所有`distributionManagement`配置和用户友好的文本。不像以前那么有用，这让我什至想知道公司 pom 的意义，因为我无法真正集中信息，但无论如何..

# sql - 在 SQL 中，使用子查询或将子查询构建到表中然后从这些表中查询更快吗？

> ID：12806631
> 
> 赞同：2
> 
> 时间：2012-10-09T18:59:56.780
> 
> 标签：sql, sql-server

我正在做涉及大量表之间连接的工作，并且我被告知使用子查询比其他命令慢得多，但在我一直在做的一些事情中，似乎有必要使用子查询或创建一张新桌子。因为我可能会多次调用同一个子查询，所以我一直在为每个子查询构建类似的表并使用它们。这看起来有效吗？请让我知道我是否应该以不同的方式做事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T19:06:12.587

笼统地说使用子查询比其他命令慢得多是完全错误的。像往常一样，这取决于。这里没有人能够给你一个明确的答案来回答你的问题。但是，这应该很容易弄清楚。您可以轻松地创建这两种方法，并检查 SSMS 中生成的查询计划和 Profiler 中的查询统计信息（无论如何您都应该这样做）。这将确定针对您的特定问题的最佳方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:15:26.563

您不仅限于这两个选择。您可以在查询中使用子查询、CTE、临时表或表变量。您可以在查询之外维护视图、索引视图或表。哪一个执行得最好取决于您的查询到底在做什么，目标表中有多少行，现有索引，机器上有多少可用磁盘空间/RAM等。此外，如果您使用的是子查询，有没有办法编写整个查询，这样子查询就不会被多次调用？也许使用一些创造性的加入方式或将其放入基于集合的操作中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T22:13:19.050

没有正确或错误的答案，但最可能的正确答案是使用公用表表达式或 CTE。

您需要记住的主要事情是，性能差异很大，这取决于一系列因素，包括数据量、数据的分布或统计、索引、子查询的选择性或一般性、磁盘的速度是，有多少查询可以保存在内存中以及一大堆其他东西。

一般来说，编写两个查询并在第一个查询之前添加以下内容：

```
SET STATISTICS IO ON 
```

然后运行批处理并将视图切换到“消息”而不是查看数据集 - 您将看到每个查询和每个表发生的“逻辑读取”（以及其他内容）。

一般来说，您希望这些逻辑读取数较低。

如果可能，请确保使用实时数据的副本运行此测试，因为这将使您最接近在实时服务器上运行时会发生的情况。（再次最接近的近似值，因为 SQL 优化器可能正在优化一般服务器负载，例如复制或用户活动或其他正在运行的报告或其他任何东西）

根据您多次调用同一个子查询的描述，听起来 CTE 是您正在寻找的东西，而且这些通常比替代品执行得更好。

# java - 从Java中的另一个类获取参数

> ID：12806638
> 
> 赞同：1
> 
> 时间：2012-10-09T19:00:26.843
> 
> 标签：java, wicket

我有一个简单的问题，但我无法解决。我正在使用检票口。在 Web 应用程序上，我有一个按钮（加载）。当我单击该按钮时，一些数据会从 Web 加载，保存在数据库中，然后加载到 Web 应用程序 (StartPage.html)。我有另一个用于更正该数据（编辑）的按钮，当我单击它时，会加载 EditPage.html。所以我只有2页。在对 EditPage.html 进行一些更正后，我单击保存按钮并在数据库中更新新数据，然后应将其加载到 Web 应用程序（StartPage.html）中。

这很简单，但在我点击“加载”按钮之前，应该是干净的。因此，如果我在“加载”-单击之前清理表，则每次单击“编辑”-按钮时都会清理它。我尝试制作一些标志，或向 StartPage 发送参数，但它看起来像一个圆圈。

StartPage 应该每次加载数据，但第一次清理表，然后不是。问题是以某种方式发送参数..

我希望它很清楚，有什么建议吗？

**更新：**

编辑页面

```
public class EditPage extends WebPage {
    public EditPage(final PageParameters parameters) {
        Form<?> form = new Form<Void>("form") {
                    @Override
                    protected void onSubmit() {
                        // if button "save" clicked
                        PageParameters params = new PageParameters();
                        params.add("flag", "true");
                        setResponsePage(StartPage.class, params);
                    }
        };
    }
} 
```

首页

```
public class StartPage extends WebPage {
    public StartPage(final PageParameters parameters) {     
            String flag = parameters.getString("flag")
            if (flag=="false")
                // Delete from DB

            Form<?> form = new Form<Void>("form") {
                @Override
                protected void onSubmit() {
                    // Load from web to DB      
                }
            };

            // Load from DB
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T11:41:39.693

我终于做到了，但正如我所见，这是“糟糕”的解决方案

编辑页面

```
public class EditPage extends WebPage {
    public EditPage(final PageParameters parameters) {
        Form<?> form = new Form<Void>("form") {
                    @Override
                    protected void onSubmit() {
                        // if button "save" clicked
                        PageParameters params = new PageParameters();
                        params.add("flag", "true");
                        setResponsePage(StartPage.class, params);
                    }
        };
    }
} 
```

首页

```
public class StartPage extends WebPage {
    public StartPage(final PageParameters parameters) {     

            Form<?> form = new Form<Void>("form") {
                @Override
                protected void onSubmit() {
                    // Delete from DB
                    // Load from web to DB
                    // Load from DB     
                }
            };

            if (parameters.getString("flag")!=null)
                // Load from DB
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T14:45:44.937

您还可以执行以下操作：

```
class StartPage {
    boolean flag;

    StartPage(boolean flag) {
        this.flag = flag;
    }
}

// in EditPage
void onSubmit() {
    setResponsePage(new StartPage(true));
} 
```

（您已经拥有的代码被省略了。）

这**不会**重定向到可收藏的 URL。[（这可能是您想要的。）此 SO answer](https://stackoverflow.com/a/10100897/41655)中概述了它将做什么。

# c++ - 使用 Qt 从 mysql 查询构造二维向量

> ID：12806640
> 
> 赞同：0
> 
> 时间：2012-10-09T19:00:27.467
> 
> 标签：c++, mysql, qt, vector

我有一个选择工具列表的查询语句。这些工具需要放入一个二维向量中，其中第一级是它的类别，第二级是类别的“桶”。

```
struct Tool {};
typedef boost::shared_ptr< Tool > ToolPtr;
typedef std::vector< ToolPtr > ToolVec;
typedef std::vector< ToolVec > ToolCategory; 
```

查询语句如下所示：

```
const QString getTools =
"SELECT tool_id, category_id, category_name, tool_name FROM tool_relation "
"WHERE course_id = ? ORDER BY category_id ASC, tool_id ASC";

q.bindValue(0, courseID);
q.exec();

while (q.next())
{

} 
```

我想用一个查询语句来做到这一点，但我能想到的唯一方法是使用指向正确存储桶的临时指针并测试每条记录以查看类别 ID 是否更改。似乎效率低下。

编辑：这样的事情是我只使用一个查询语句时想出的。

```
ToolVector *curBucket = 0;

int curCategory = 0;

while (q.next())
{
    if (q.value(1).toInt() != curCategory)
    {
        curCategory = q.value(1).toInt();

        ToolVec toolVec;

        curBucket = &toolVec;

        categories.push_back(toolVec);
    }

    ToolPtr toolPtr(new Tool(
                        q.value(0).toInt(),
                        q.value(2).toString()));

    curBucket->push_back(toolPtr);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T08:27:43.163

我们可能对“效率”的定义有所不同。对我来说，这是速度和内存要求。处理两个 SELECT 语句总是比处理一个更慢和更消耗，即使`if`对于每个返回的行都有语句。

但是，即使我对您的逻辑一无所知，我还是有些想念您将如何寻找工具桶。`category_id`不保存在任何地方，`category_name`只保存在`Tool`结构内部。除非您迭代所有工具，否则您无法找到存储桶。桶`map`呢？它还可以满足您的效率要求：

```
typedef std::map< int, ToolVec > ToolCategory;

while (q.next())
{
  curCategory = q.value(1).toInt();
  ...      
  categories[curCategory].push_back(toolPtr);
} 
```

# ruby - 如何使用 Chipmunk 库创建地板

> ID：12806641
> 
> 赞同：0
> 
> 时间：2012-10-09T19:00:36.247
> 
> 标签：ruby, game-engine, game-physics, chipmunk, libgosu

我正在使用 Ruby，当然还有与 Chipmunk 以及[Chingu](https://github.com/ippa/chingu) / [Gosu](http://www.libgosu.org/)游戏库的 Ruby 绑定。似乎语法不同，但我认为它与 Chipmunk C 相同。我该如何做地板？我尝试了以下方法：

```
space = CP::Space.new
space.damping = 0.9
space.gravity = CP::Vec2.new(0, 50)
body = CP::StaticBody.new
shape_array = [CP::Vec2.new(0, 400), CP::Vec2.new($window.width, 400), CP::Vec2.new($window.width, 390), CP::Vec2.new(0, 390)]
shape = CP::Shape::Poly.new(body, shape_array, CP::Vec2.new(0,0))
shape.collision_type = :floor
space.add_body(body)
space.add_shape(shape) 
```

发生的情况是物体撞到地板上并在瞬间摆动，然后直接穿过。我希望它们降落在地板上，甚至可以弹起一点（取决于物体）。但不要穿过地板。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T19:13:51.327

为了使这项工作，我不得不删除该行：

```
space.add_body(body) 
```

静态物体不能添加到空间中。

# ruby-on-rails - rails_admin 中没有选择字段

> ID：12806645
> 
> 赞同：0
> 
> 时间：2012-10-09T19:00:49.990
> 
> 标签：ruby-on-rails, rails-admin

我有两个简单的模型：

```
class Category < ActiveRecord::Base
  attr_accessible :id, :name, :description
  has_many :tags
end

class Tag < ActiveRecord::Base
  belongs_to :category
  attr_accessible :id, :name
end 
```

但是在 rails_admin 我没有为标签设置类别的下拉菜单。我只看到“类别：-”，没有其他内容。是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-14T17:58:14.037

你需要添加`:category_id`到`attr_accessible`

```
class Tag < ActiveRecord::Base
  belongs_to :category
  attr_accessible :id, :name, :category_id
end 
```

# java - Java Process.waitFor() 和 Readline 挂起

> ID：12806651
> 
> 赞同：3
> 
> 时间：2012-10-09T19:01:25.483
> 
> 标签：java, multithreading, powershell, vmware

首先，这是我的代码：

```
import java.io.*;
import java.util.Date;

import com.banctecmtl.ca.vlp.shared.exceptions.*;

public class PowershellTest implements Runnable {

public static final String PATH_TO_SCRIPT = "C:\\Scripts\\ScriptTest.ps1";
public static final String SERVER_IP = "XX.XX.XX.XXX";
public static final String MACHINE_TO_MOD = "MachineTest";

/**
 * @param args
 * @throws OperationException 
 */
public static void main(String[] args) throws OperationException {

    new PowershellTest().run();

}

public PowershellTest(){}

@Override
public synchronized void run() {
    String input = "";
    String error = "";

    boolean isHanging = false;

    try {

        Runtime runtime = Runtime.getRuntime();
        Process proc = runtime.exec("powershell -file " + PATH_TO_SCRIPT +" "+ SERVER_IP +" "+ MACHINE_TO_MOD);
        proc.getOutputStream().close();
        InputStream inputstream = proc.getInputStream();
        InputStreamReader inputstreamreader = new InputStreamReader(inputstream);
        BufferedReader bufferedreader = new BufferedReader(inputstreamreader);

        proc.waitFor();

        String line;
        while (!isHanging && (line = bufferedreader.readLine()) != null) {
            input += (line + "\n");
            Date date = new Date();
            while(!bufferedreader.ready()){

                this.wait(1000);
                //if its been more then 1 minute since a line has been read, its hanging. 
                if(new Date().getTime() - date.getTime() >= 60000){

                    isHanging = true;
                    break;

                }
            }
        }

        inputstream.close();
        inputstream = proc.getErrorStream();
        inputstreamreader = new InputStreamReader(inputstream);
        bufferedreader = new BufferedReader(inputstreamreader);
        isHanging = false;

        while (!isHanging && (line = bufferedreader.readLine()) != null) {
            error += (line + "\n");
            Date date = new Date();
            while(!bufferedreader.ready()){

                this.wait(1000);
                //if its been more then 1 minute since a line has been read, its hanging. 
                if(new Date().getTime() - date.getTime() >= 60000){

                    isHanging = true;
                    break;

                }
            }
        }
        inputstream.close();

        proc.destroy();

    } catch (IOException e) {
        //throw new OperationException("File IO problem.", e);
    } catch (InterruptedException e) {
        //throw new OperationException("Script thread problem.",e);
    }
    System.out.println("Error : " + error + "\nInput : " + input);
} 
```

}

我目前正在尝试运行将在远程服务器上启动/停止 vm (VMWARE) 的 powershell 脚本。**该脚本从命令行工作，此代码也是如此**。问题是，我讨厌我必须为这样的工作使用线程（并让它等待脚本响应，如进一步解释的那样）。我不得不这样做，因为 BufferedReader.readline() 和 proc.waitFor() 都永远挂起。

该脚本从 cmd 运行时执行时间很长。从验证服务器身份验证和执行实际脚本开始，它会停止 30 秒到 1 分钟。根据我从调试中看到的情况，当它开始从脚本接收这些延迟时，readline 挂起。

我也很确定这不是内存问题，因为我在任何调试会话中都没有任何 OOM 错误。

现在我明白 Process.waitFor() 需要我从错误流和常规流中刷新缓冲区才能工作，这就是我不使用它的主要原因（我需要输出来管理 VM 特定错误、证书问题， ETC。）。

我想知道是否有人可以向我解释它为什么会挂起，以及是否有办法只使用典型的 readline() 而不会让它挂得那么难。即使脚本应该已经结束了一段时间，它仍然挂起（我尝试使用我在 java 应用程序中使用的完全相同的东西同时运行 java 应用程序和 cmd 命令，让它运行 1 小时，没有任何效果）。它不只是停留**在**while 循环中，readline() 是挂起的地方。

这也是一个测试版本，离最终代码还很远，所以请给我留点：这应该是一个常数，这是无用的，等等。我稍后会清理代码。显然，IP 在我的代码中也不是 XX.XX.XX.XXX。

关于如何修复的解释或建议将不胜感激。

顺便说一句，这里是我目前使用的脚本：

```
Add-PSSnapin vmware.vimautomation.core

Connect-VIServer -server $args[0]

Start-VM -VM "MachineTest" 
```

如果您需要更多详细信息，我会尽力提供。

在此先感谢您的帮助！

编辑：我之前还使用要求不高的脚本测试了代码，该工作是获取文件的内容并打印它。由于无需等待即可获取信息，因此 readline() 运行良好。因此，我相当确定问题出在脚本执行的等待时间上。

另外，请原谅我的错误，英语不是我的主要语言。

在此先感谢您的帮助！

EDIT2：因为我无法回答我自己的问题：

这是我使用线程后的“最终”代码：

```
import java.io.*;

public class PowershellTest implements Runnable {

public InputStream is;

public PowershellTest(InputStream newIs){

    this.is = newIs;
}

@Override
public synchronized void run() {
    String input = "";
    String error = "";

    try {

        InputStreamReader inputstreamreader = new InputStreamReader(is);
        BufferedReader bufferedreader = new BufferedReader(inputstreamreader);

        String line;
        while ((line = bufferedreader.readLine()) != null) {
            input += (line + "\n");

        }

        is.close();

    } catch (IOException e) {
        //throw new OperationException("File IO problem.", e);
    }
    System.out.println("Error : " + error + "\nInput : " + input);
}

} 
```

主要简单地创建并启动 2 个线程（PowerShellTest 实例），1 个使用 errorStream，1 个使用 inputStream。

我相信当我第一次编写应用程序并以某种方式修复它时，我犯了一个愚蠢的错误，因为我一遍又一遍地重新编写代码。运行仍然需要 5-6 分钟，如果不长于我之前的代码，这在某种程度上是相似的（这是合乎逻辑的，因为在我的情况下，errorStream 和 inputStream 按顺序获取它们的信息）。

无论如何，感谢您的所有回答，尤其是 Miserable Variable 对线程的提示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T20:19:42.063

`waitFor()`首先，在你读完信息流之前不要打电话。我强烈建议您查看`ProcessBuilder`而不是简单地使用`Runtime.exec`，并自己拆分命令，而不是依靠 Java 为您完成：

```
ProcessBuilder pb = new ProcessBuilder("powershell", "-file", PATH_TO_SCRIPT,
        SERVER_IP, MACHINE_TO_MOD);
pb.redirectErrorStream(true); // merge stdout and stderr
Process proc = pb.start(); 
```

`redirectErrorStream`将错误输出合并到正常输出中，因此您只需阅读`proc.getInputStream()`. 然后，您应该能够在 EOF 之前读取该流，*然后*调用`proc.waitFor()`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-09T20:42:28.473

您目前正在等待从`inputStream`开始阅读之前完成阅读`errorStream`。`stderr`如果该进程之前写入它，`stdout`那么您可能会陷入僵局。

尝试从同时运行的线程中读取两个流。当你在它的时候，也删除`proc.getOutputStream().close();`. 它不应该影响行为，但也不是必需的。

# objective-c - Xcode Json 在数组中返回 nil

> ID：12806653
> 
> 赞同：0
> 
> 时间：2012-10-09T19:01:28.133
> 
> 标签：objective-c, json

我没有看到我在这里做错了什么，但我无法让 JSON 在数组中恢复良好..

这是 JSON 返回的内容：

(html)

```
"Response": {
    "objecten": {
        "object": [
            {
                "id": "12345 
```

(Xcode)

```
NSArray *array = [dictionary objectForKey:@"object"];
if (array == nil) {
    NSLog(@"No 'data' in array");
    return;
} 
```

我收到错误是因为它为零，但是如果我填写@“Response”而不是@“object”，我会得到一个带有数据的数组。

然后我循环通过它

```
for (NSDictionary *resultDict in array) {
    NSLog(@"%@",resultDict); 
```

它只有“反对”而已......

那我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:15:36.300

它只是一棵对象树。尝试：

```
NSArray * arr =[[[dictionary objectForKey:@"Response"] objectForKey:@"objecten"] objectForKey:@"object"]]]; 
```

# c++ - 在 C++ 中为迭代器编写 operator== 函数

> ID：12806657
> 
> 赞同：2
> 
> 时间：2012-10-09T19:01:49.427
> 
> 标签：c++, debugging, iterator

我意识到我很愚蠢，所以请对我放轻松。是的，这是一项任务，但我想了解我做错了什么，而不仅仅是答案。

我正在尝试为 BSTIterator 类模板中的二叉搜索树上的迭代器编写一个 operator== 和一个 operator!= 函数。

给定（都在同一个类模板中）：

```
private: 

BSTNode<Data>* curr;

...

bool operator==(BSTIterator<Data> const & other) const {
  (here's where I do my magic)
} 
```

操作员的设置相同！=。

我为 == ...

```
 return (&curr == other); 
```

我认为我不需要括号，但无论如何......这就是我所拥有的！=

```
 return !(&curr == other); 
```

我的编译器有问题！= 但显然不是 ==。

它吐出了很多狼吞虎咽的东西，但据我所知，相关部分是：

> '&((const BSTIterator*)this)->BSTIterator::curr != other' 中的 'operator!=' 不匹配

它引用了上面写着的那一行`return !(&curr == other);`

我认为起初编译器也不喜欢我的 operator== 函数，但我现在看不到对它的引用。为什么除了 之外它们基本相同时，它会喜欢一个而不是另一个`!`？

如果我需要包含更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:11:20.603

正如我从您的代码中了解到的`curr`那样，表明您的迭代器指向它的位置。当您将迭代器的实例与另一个实例进行比较时，您应该检查它们是否都指向同一位置。我对吗？如果答案是真的，你不应该这样编码：

```
bool operator==( BSTIterator<Data> const & other) const {
    return this->curr == other.curr;
}
bool operator!=( BSTIterator<Data> const & other) const {
    return this->curr != other.curr;
} 
```

关于你的错误：你的编译器说`&cur`是一个 type( `BSTNode<Data>**`)，我不知道如何将它与你的 iterator( `BSTIterator<Data>`) 的实例进行比较，这很明显，因为你正在为你的类定义`==`and`!=`并且你从未定义过 and 运算符 for这样的操作，你呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T19:12:09.527

首先要确定操作的语义是什么。对于具有引用语义的类（迭代器表示对容器中元素的引用），相等的常见定义是*指完全相同的对象*。从概念上讲，`it1 == it2`iff `&*it1 == &*it2`（如果访问的对象的地址相同，则两个迭代器都是`operator*`相同的^*）。

之后，您只需要执行测试。在您的情况下，如果您有一个指向树中节点的指针，那么如果存储在迭代器内的指针引用同一个节点，那么这两个迭代器是相同的。也就是说，如果存储的指针相同。

请注意，在这种情况下，您要按值比较指针：如果两个指针中存储的值相同，则它们是相同的，因此您将**不**使用地址运算符 (1)：

```
return (&curr == other);
        ^        ^
        1        2 
```

另请注意 (2) 在那行代码中，您将指针与可能没有意义`curr`的迭代器进行比较。`other`您想比较*两个*存储的指针。

# excel-2007 - 从范围标准获取标准偏差

> ID：12806663
> 
> 赞同：-2
> 
> 时间：2012-10-09T19:02:05.840
> 
> 标签：excel-2007

我在获取标准偏差（[此处](http://www.mathsisfun.com/data/standard-deviation-formulas.html)为等式）时遇到了这个问题。我的问题是如何从一组数据中获得 ([X 区间] - 均值) 的总和，其中要遵循某些标准。

例如，数据是：

```
Gender Grade 
M      36
M      32
F      25
F      40 
```

我已经获得了方程中需要的 N`COUNTIFS`并获得了平均值 via `SUMIFS`。**问题是在没有**为所述范围声明单元格/列的情况下获得范围的总和（X 区间减去平均值） 。在给定的示例中，我想获得关于性别的等级标准偏差。如果我要为 X 间隔减去平均值添加列，那么如果将记录 2 性别更改为“F”将很难。

有什么想法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T05:14:11.400

用一点代数，sd 公式可以重写为

```
 Ʃ(x²) - Ʃ(x)²/n 
sd = √( --------------- )
              n 
```

可以用`SUMIFS`,`COUNTIFS`和`SUMPRODUCT`

假设性别数据在范围`A1:A4`、等级和使用`B1:B4`标准内`C1`

```
=SQRT( (SUMPRODUCT($B$1:$B$4,$B$1:$B$4,--($A$1:$A$4=C1)) -  
       SUMIFS($B$1:$B$4,$A$1:$A$4,C1)^2/COUNTIFS($A$1:$A$4,C1)) /  
       COUNTIFS($A$1:$A$4,C1) ) 
```

# numa - 如何将所有内存分配限制到一个 NUMA 节点

> ID：12806666
> 
> 赞同：2
> 
> 时间：2012-10-09T19:02:11.797
> 
> 标签：numa

我是 NUMA 感知多线程编程的新手。我正在编写我的代码，以便所有线程及其内存分配都限制在一个节点上。在程序开始时，我进行了以下调用：

```
struct bitmask *bm = numa_parse_nodestring("0");
if (bm == 0) {
    exit(1);
}
numa_bind(bm); 
```

我的理解是，以这种方式调用 numa_bind 会将所有线程和所有内存分配绑定到节点 0。

此外，当我从此代码启动 pthread 时，我使用以下方法将它们绑定到特定 CPU：

```
pthread_setaffinity_n 
```

但是，当我查看 /proc//numa_maps 时，我仍然可以看到某些库（例如 libc）绑定到节点 1 上的内存。如何确保进程所需的所有内存都绑定到节点0?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-10T13:10:22.497

像 libc 这样的共享库不能绑定到您的进程/应用程序指定的内存库。请参阅[共享库-numa](https://stackoverflow.com/questions/12388918/shared-library-bottleneck-on-numa-machine)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-29T16:04:27.423

代码往往会被缓存在本地处理器的 L3 缓存中。由于它是只读的，因此一旦加载到缓存中就不太可能产生任何流量。我不会太在意它，除非你有分析信息表明它确实会造成问题。

# php - 数据未从 php 会话开始变量存储到 sql 数据库

> ID：12806669
> 
> 赞同：1
> 
> 时间：2012-10-09T19:02:19.973
> 
> 标签：php, sql, input

我正在尝试将用户输入存储到我的 sql 表中，如下所示， [我的数据库 http://goawaymom.com/test.png](http://goawaymom.com/test.png)

在这里注册后，我向用户查询他们的“电子邮件”、“名字”、“姓氏”和“关于” [。](http://goawaymom.com/login/register.php)但是无论我做什么，用户输入都不会保存到数据库中。我认为但不确定这是我的 session_start 变量的问题。我相信会话没有正确启动/保存对于已注册的用户来说是唯一的。我基于本[教程](http://www.youtube.com/watch?v=ruoptcAx-BQ&feature=BFa&list=SP074EAEF57B0DA2A4)的代码，因为我是 PHP 新手。

编辑配置文件.php

```
<?php
session_start();

include('core/init_inc.php');

if(isset($_POST['email'], $_POST['about'], $_POST['firstname'], $_POST['lastname'])){
$errors = array();   
if (filter_var($_POST['email'], FILTER_VALIDATE_EMAIL) === false){
    $errors[] = 'The email address you entered is not valid';    
}
if (empty($errors)){
    set_profile_info($_POST['email'],$_POST['about']);
}
$user_info = array(
    'email'     => htmlentities($_POST['email']),
    'about'     => htmlentities($_POST['about']),
    'firstname'     => htmlentities($_POST['firstname']),
    'lastname'     => htmlentities($_POST['lastname'])
);
} else {
$user_info = fetch_user_info($SESSION['uid']);
}
?> 
```

任何帮助将不胜感激。我的问题再次是，为什么我的 editprofile.php 表单中的数据没有保存到我的 php sql 数据库中，我该如何解决这个问题。提前致谢，如果需要更多代码，我愿意提供。注册网站后，可[在此处访问该表格。](http://goawaymom.com/login/register.php)

```
function fetch_users() {
$result = mysql_query('SELECT `user_id` AS `id`, `username` FROM `users`');

$users = array ();

while (($row = mysql_fetch_assoc($result)) !== false){
    $users[ ] = $row;
}

return $users;

}
//fetches profile information for the given user
function fetch_user_info($uid){
$uid = (int)$uid;

$sql = "SELECT
            `username`,
            `user_firstname` AS `firstname`,
            `user_lastname` AS `lastname`,
            `user_about` AS `about`,
            `user_email` AS `email`
        FROM `users`
        WHERE `user_id` = {$uid}";

$result = mysql_query($sql);        
return mysql_fetch_assoc($result);

}

//updates the current user profile info
function set_profile_info($email, $about){
$email = mysql_real_escape_string(htmlentities($email));
$about = mysql_real_escape_string(nl2br(htmlentities($about)));

$sql = "UPDATE `users` SET
        `user_email` = `{$email}`,
        `user_about` = `{about}`
    WHERE `user_id` = {$_SESSION[`uid`]}";
mysql_query($sql);
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:12:34.863

您不能在字符串 {$email} 和 {$about} 周围使用 `。现在你还有 {about} 而不是 {$about}。您还将它用于：

```
$_SESSION[`uid`] //needs to be $_SESSION['uid'] 
```

所以这应该是：

```
$sql = "UPDATE `users` SET
        `user_email` = '{$email}',
        `user_about` = '{$about}'
    WHERE `user_id` = {$_SESSION['uid']}"; 
```

# java - Java - 如何在 hasNext() 条件下摆脱 while？

> ID：12806672
> 
> 赞同：1
> 
> 时间：2012-10-09T19:02:24.590
> 
> 标签：java, while-loop

我正在编写一个简单的程序来计算一组数字的平均值。您使用 获得数字`Scanner`，因此我使用`while`循环`.hasNext()`作为条件。但是循环是无限的。

是否可以在不输入某些特定单词（例如“停止”）的情况下摆脱它？

```
public class main {

    public static void main(String[] args){

        Scanner Input = new Scanner(System.in);
        int count = 0;
        int temp;
        int sum = 0;

        while(Input.hasNextInt()){

           count++;           

           temp = Input.nextInt();
           sum += temp;
           System.out.println(temp);
           System.out.println(count);           

        } // End of while

        double average = sum / count;
        System.out.println("The average is: " + average);

    } // End of method main

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:06:33.380

您可以简单地使用关键字`break`来停止 while 循环：

```
while(Input.hasNextInt()){

    count++;           

    temp = Input.nextInt();
    sum += temp;
    System.out.println(temp);
    System.out.println(count); 
    break;          

} // End of while 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:05:33.153

是的，魔术关键字是`break;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:05:56.463

该`break;`声明可以被起诉以......好吧......打破迭代。例如，通过迭代，我的意思是你也可以摆脱 a `for`。

您必须定义何时要退出迭代，然后执行以下操作：

```
while(Input.hasNextInt(Input)){
   if(condition())
       break;

   count++;           

   temp = Input.nextInt();
   sum += temp;
   System.out.println(temp);
   System.out.println(count);           

 } 
```

否则，您可以创建一个辅助方法来定义迭代是否应该继续进行，例如：

```
private boolean keepIterating(Scanner in) {
    boolean someOtherCondition = //define your value here that must evaluate to false
                                 //when you want to stop looping
    return Input.hasNextInt() && someOtherCondition;
} 
```

您必须在您的`while`:

```
while(keepIterating()){

   count++;           

   temp = Input.nextInt();
   sum += temp;
   System.out.println(temp);
   System.out.println(count);           

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T19:10:12.187

问题是`Scanner`总是*期望*从`System.in`. 您可以使用标记值跳出循​​环，例如`-1`：

```
if (temp == -1) {
   break;
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-07-12T16:22:07.647

```
public static void main(String[] args){

    Scanner Input = new Scanner(System.in);

    System.out.println("Enter # to end ");
    while( !Input.hasNextInt("#"))// return true if u input value = its argument
    {
        //ur code
    }//end while 
```

# c# - GraphAPI 找不到业务页面...但我可以在 Facebook 中手动找到它

> ID：12806674
> 
> 赞同：-1
> 
> 时间：2012-10-09T19:02:26.547
> 
> 标签：c#, facebook-graph-api, facebook-c#-sdk

我正在寻找“Ellie's 50's Diner”

当我在 FB 的搜索栏中输入或粘贴它时，FB 发现它很好。使用`graphAPI`我这样做：

```
http://graph.facebook.com/search?q=Ellies50sDiner 
```

或者

```
http://graph.facebook.com/search?q=Ellie's 50's Diner 
```

它什么也没找到。

有人可以帮我理解如何正确形成这个 URL 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:46:05.993

问题不在于你，而在于你在寻找什么。

如果您在 Facebook 上查看 Ellie 的页面，[http://www.facebook.com/pages/Ellies-50s-Diner/142627479109699](http://www.facebook.com/pages/Ellies-50s-Diner/142627479109699)，页面后面的数字表明所有者尚未声明用户名。

根据我的经验，如果页面所有者没有声明用户名，那么它们就不是“真实”页面，也不会出现在搜索中。

# android - 确定已挂载的外部 sd 卡的可用空间

> ID：12806676
> 
> 赞同：0
> 
> 时间：2012-10-09T19:02:42.150
> 
> 标签：android

> **可能重复：**
> [Android SD 卡可用空间](https://stackoverflow.com/questions/2941552/android-sd-card-free-space)

在某些设备上，外部 sdcard 安装在 /mnt/sdcard/tflash 中。现在我需要找出外部 sdcard 上有多少可用空间。

我无法测试它，所以我不确定以下是否返回 /mnt/sdcard/tflash 的大小而不是 /mnt/sdcard

```
 StatFs stat = new StatFs("/mnt/sdcard/tflash");
        long blockSize = stat.getBlockSize();
        long totalBlocks = stat.getBlockCount();
        return totalBlocks * blockSize; 
```

任何提示如何找到 /mnt/sdcard/tflash 或 /mnt/sdcard/external_sd 的可用空间

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T19:10:57.413

不幸的是，Android 并没有真正意义上的“外置 sd 卡”的概念，实际上，他们的外置存储通常指的是人们通常认为是内部存储器的东西（比如设备内置的 8gb！）

```
Environment.getExternalStorageState() returns path to internal SD mount point like "/mnt/sdcard" 
```

Environment.getExternalStorageDirectory() 是设备制造商认为的“外部存储”。有时这是真正的可移动存储，有时不是！

我讨厌打破泡沫，但可能没有办法，只能手动检查 /mnt/sdcard/external_sd 之类的路径，并检查它们是否存在，然后检查大小。这就是我最终为我的应用程序所做的事情:(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:18:53.833

尝试

```
StatFs st = new StatFs(Environment.getExternalStorageDirectory().getPath());

long sdcardSize = (long) st.getBlockSize() * (long) st.getBlockCount(); 
```

# java - Netty 比 Tomcat 慢

> ID：12806678
> 
> 赞同：26
> 
> 时间：2012-10-09T19:03:07.747
> 
> 标签：java, tomcat, io, netty

我们刚刚构建了一个服务器来将数据存储到磁盘并使用 Netty 作为前端。在负载测试期间，我们看到 Netty 扩展到每秒大约 8,000 条消息。鉴于我们的系统，这看起来非常低。对于基准测试，我们编写了一个 Tomcat 前端并运行相同的负载测试。通过这些测试，我们每秒收到大约 25,000 条消息。

以下是我们的负载测试机的规格：

*   Macbook Pro 四核
*   16GB 内存
*   Java 1.6

这是 Netty 的负载测试设置：

*   10 个线程
*   每个线程 100,000 条消息
*   Netty 服务器代码（相当标准）——我们在服务器上的 Netty 管道是两个处理程序：一个 FrameDecoder 和一个处理请求和响应的 SimpleChannelHandler。
*   客户端 JIO 使用 Commons Pool 来池化和重用连接（池的大小与线程数相同）

这是 Tomcat 的负载测试设置：

*   10 个线程
*   每个线程 100,000 条消息
*   Tomcat 7.0.16 默认配置使用 Servlet 调用服务器代码
*   客户端使用 URLConnection 没有任何池

我的主要问题是为什么性能有如此巨大的差异？Netty 有什么明显的东西可以让它比 Tomcat 运行得更快吗？

编辑：这是主要的 Netty 服务器代码：

```
NioServerSocketChannelFactory factory = new NioServerSocketChannelFactory();
ServerBootstrap server = new ServerBootstrap(factory);
server.setPipelineFactory(new ChannelPipelineFactory() {
  public ChannelPipeline getPipeline() {
    RequestDecoder decoder = injector.getInstance(RequestDecoder.class);
    ContentStoreChannelHandler handler = injector.getInstance(ContentStoreChannelHandler.class);
    return Channels.pipeline(decoder, handler);
  }
});

server.setOption("child.tcpNoDelay", true);
server.setOption("child.keepAlive", true);
Channel channel = server.bind(new InetSocketAddress(port));
allChannels.add(channel); 
```

我们的处理程序如下所示：

```
public class RequestDecoder extends FrameDecoder {
  @Override
  protected ChannelBuffer decode(ChannelHandlerContext ctx, Channel channel, ChannelBuffer buffer) {
    if (buffer.readableBytes() < 4) {
      return null;
    }

    buffer.markReaderIndex();
    int length = buffer.readInt();
    if (buffer.readableBytes() < length) {
      buffer.resetReaderIndex();
      return null;
    }

    return buffer;
  }
}

public class ContentStoreChannelHandler extends SimpleChannelHandler {
  private final RequestHandler handler;

  @Inject
  public ContentStoreChannelHandler(RequestHandler handler) {
    this.handler = handler;
  }

  @Override
  public void messageReceived(ChannelHandlerContext ctx, MessageEvent e) {
    ChannelBuffer in = (ChannelBuffer) e.getMessage();
    in.readerIndex(4);

    ChannelBuffer out = ChannelBuffers.dynamicBuffer(512);
    out.writerIndex(8); // Skip the length and status code

    boolean success = handler.handle(new ChannelBufferInputStream(in), new ChannelBufferOutputStream(out), new NettyErrorStream(out));
    if (success) {
      out.setInt(0, out.writerIndex() - 8); // length
      out.setInt(4, 0); // Status
    }

    Channels.write(e.getChannel(), out, e.getRemoteAddress());
  }

  @Override
  public void exceptionCaught(ChannelHandlerContext ctx, ExceptionEvent e) {
    Throwable throwable = e.getCause();
    ChannelBuffer out = ChannelBuffers.dynamicBuffer(8);
    out.writeInt(0); // Length
    out.writeInt(Errors.generalException.getCode()); // status

    Channels.write(ctx, e.getFuture(), out);
  }

  @Override
  public void channelOpen(ChannelHandlerContext ctx, ChannelStateEvent e) {
    NettyContentStoreServer.allChannels.add(e.getChannel());
  }
} 
```

**更新**：

我设法让我的 Netty 解决方案达到每秒 4,000 次。几周前，我正在我的连接池中测试客户端 PING，作为对空闲套接字的安全防护，但在开始负载测试之前我忘记删除该代码。每次从池中检出 Socket（使用 Commons Pool）时，此代码都会有效地 PING 服务器。我注释掉了这段代码，现在我用 Netty 获得了 21,000/秒，使用 Tomcat 获得了 25,000/秒。

尽管这在 Netty 方面是个好消息，但 Netty 的速度仍然比 Tomcat 少 4,000/秒。如果有人有兴趣看到，我可以发布我的客户端（我认为我已经排除但显然没有）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-09-20T14:04:11.877

该方法`messageReceived`是使用可能被阻塞的工作线程执行的，该工作线程可能正`RequestHandler#handle`忙于做一些 I/O 工作。`OrderdMemoryAwareThreadPoolExecutor`您可以尝试将一个（**推荐**）添加到通道管道中以执行处理程序，或者尝试将您的处理程序工作分派到新的[ThreadPoolExecutor](https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ThreadPoolExecutor.html "线程池执行器")并传递对套接字通道的引用，以便稍后将响应写回客户端。前任。：

```
@Override
public void messageReceived(ChannelHandlerContext ctx, MessageEvent e) {   

    executor.submit(new Runnable() {
        processHandlerAndRespond(e);        
    });
}

private void processHandlerAndRespond(MessageEvent e) {

    ChannelBuffer in = (ChannelBuffer) e.getMessage();
    in.readerIndex(4);
    ChannelBuffer out = ChannelBuffers.dynamicBuffer(512);
    out.writerIndex(8); // Skip the length and status code
    boolean success = handler.handle(new ChannelBufferInputStream(in), new ChannelBufferOutputStream(out), new NettyErrorStream(out));
    if (success) {
        out.setInt(0, out.writerIndex() - 8); // length
        out.setInt(4, 0); // Status
    }
    Channels.write(e.getChannel(), out, e.getRemoteAddress());
} 
```

# jquery - 未捕获的错误：语法错误，无法识别的表达式：#

> ID：12806685
> 
> 赞同：2
> 
> 时间：2012-10-09T19:03:45.237
> 
> 标签：jquery, asp.net, flexigrid

我正在尝试从 flexigrid 获取单元格的文本值。但是我不断收到该错误。

这是我检索特定单元格文本的函数（Flexigrid 没有“attr”，而是有“abbr”）。

```
function getSelectedCopyDates() {
    var arr = new Array();
    debugger;
    //for every row that has a checked checkbox
    $("tr").has(".noteCheckBox:checked").each(function(i) {
        if ($(this.id) !== "checkAllNotes") {
            //push the value of column(FName, LName) into the array 
            arr.push($("#" + this.id + "> td[abbr='EventDate'] > div").text());
        }
    });
    return arr;
} 
```

当我单击“checkAllNotes”（主复选框）时，我只会收到该错误。如果我手动选中一个复选框，那么一切正常。

这是我的 flexigrid 布局：

```
$('#viewNotesGrid').flexigrid({
    url: url,
    dataType: 'json',
    method: 'get',
    colModel: [{
        display: '<input type="checkbox" class="noteCheckBox" id="checkAllNotes" />',
        name: 'checkBox',
        width: 20,
        sortable: false,
        align: 'center',
        process: showDescription
    }, {
        display: 'Date',
        name: 'EventDate',
        width: 80,
        sortable: true,
        align: 'center',
        process: showDescription
    }, 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:16:23.543

我认为您的意思是使用`this.id ==`vs. `$(this.id) ==`。似乎错误也可能是因为`this.id`是空的（jQuery 会在 上抛出该错误`$("#>")`，但错误消息似乎也包含`>`，所以我不确定）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T20:08:35.683

第一个问题是`$("tr").has(".noteCheckBox:checked")`返回 tr 元素，而不是输入复选框。

第二个问题：`$(this.id) !== "value"`永远不会工作。您正在创建 jQuery 对象并将其与字符串进行比较。应该`this.id !== "value"`

第三个问题：已经在前面的答案中解释过。如果元素似乎没有 id，那么`"#" + this.id + ">`将导致`"#>"`，并且您实际上想要比较特殊输入字段的 id，而不是 tr。

在这里做一些假设，但这可能有效：

```
function getSelectedCopyDates() {
var arr = new Array();

//for every row that has a checked checkbox
$("tr .noteCheckBox:checked").each(function (i) {
    if (this.id !== "checkAllNotes") {
        var tr = $(this).parents("tr")[0]; // going back to parent tr
        arr.push($(tr).find(" > td[abbr='EventDate'] > div").text());
    }
});
return arr;
} 
```

# javascript - 访问其他函数的变量

> ID：12806687
> 
> 赞同：0
> 
> 时间：2012-10-09T19:03:56.180
> 
> 标签：javascript, jquery

在我下面的 jQuery 代码中，我无法获得正确的 inputString 元素长度，元素的长度在查找函数上发生变化，并且我无法使用全局变量。

```
$('#ckekeKala').live("click" ,function(){
    var len=$('#inputString').text().length;
    alert(len);
});

function lookup(inputString) {
    if(inputString.length != 0) {
        $('[id^="lbl"]').attr("disabled", true);
    }
    });
  }
} // lookup 
```

HTML 代码：

```
<input style='width: 128px;' name='nameKala' id="inputString" onkeyup="lookup(this.value);" onblur="fill();" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:07:55.060

查找函数中的额外大括号

```
 function lookup(inputString) {
        if(inputString.length != 0) {
            $('[id^="lbl"]').attr("disabled", true);
        }
    });   <--- Remove this
  }       <---  Remove this
} // lookup 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T20:20:12.727

除了您可以在其他答案和帖子中看到的任何语法错误之外。如果您放置更多代码，那将很容易。但是假设您没有提到的所有其他代码都是正确的并修复了这个语法错误

```
 }); 
```

我认为您的查找在 jQuery 块之外没有访问权限。所以你能做的就是把它改成这样

```
 lookup = function(inputString) {
   if (inputString.length != 0) {
     $('[id^="lbl"]').attr("disabled", true);
   }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:20:39.840

只是一个想法，你可以像这样简化整个过程：

> HTML

```
<input id="inputString" name="nameKala" type="text" style="width:128px" /> 
```

> 脚本

```
// keep in mind, that depending on ur use and jQuery version, .live can be replaced with .bind or .on
$("#inputString").live("keyup", function(e) {
        if ($(this).length > 0) { 
            $('[id^="lbl"]').attr("disabled", true);
        };
    })
    .live("blur", function(e) {
        // do fill work
    });

$('#ckekeKala').live("click" ,function(){
    var len=$('#inputString').val().length;
    alert(len);
}); 
```

[***例子***](http://jsfiddle.net/SpYk3/qqc9p/)

# html - 无法删除 Primefaces SelectOneMenu 上的底部“边距”

> ID：12806689
> 
> 赞同：1
> 
> 时间：2012-10-09T19:04:02.577
> 
> 标签：html, css, jsf-2, primefaces, selectonemenu

在[Primefaces Showcase](http://www.primefaces.org/showcase-labs/ui/selectOneMenu.jsf)中，SelectOneMenu 放置在表格单元格中。这是包含单元格的布局：

![在此处输入图像描述](../Images/645c886142aecb50a0bb8d9935441978.png)

但是，如果我复制 Showcase HTML 结构并包含其 default.css，我得到的布局如下所示：

![在此处输入图像描述](../Images/879de4d560f33cbd43183b23c57b75eb.png)

不知何故，它们相差**约 3px！**

这很烦人，因为我正在创建一个带有输入元素的表单。每当我使用 SelectOneMenus 时，网格行都会稍微太大：

![在此处输入图像描述](../Images/c5b7e7968b4c75ed32efa2cd22f6dfa6.png)

知道如何删除这个底部“边距”吗？Chrome/FF/IE 中的开发人员工具没有揭示根本原因......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T20:39:48.710

添加`display:block`到 SelectOneMenu 的 CSS 中：

```
.ui-selectonemenu {
    display: block;
} 
```

# cakephp - CakePHP 2.2.2 资产压缩 CssMinFilter 评论问题

> ID：12806691
> 
> 赞同：0
> 
> 时间：2012-10-09T19:04:06.827
> 
> 标签：cakephp, plugins, sass

我正在使用 JsMinFilter 和 CssMinFilter 将我所有的 CSS 和 JS 文件压缩到一个输出文件中。这对两者都适用，但是我在某处找到的修改副本的 JS 过滤器可以让您保留重要的评论，例如版权声明。

我知道 CssMinFilter 有一个过滤器选项，可以将 RemoveComments 设置为 false。但是，当我将它与 CakePHP（2.2.2 版）一起使用时，我似乎找不到任何关于在哪里设置该选项的信息，有人知道在哪里吗？我是把它放在我的 AppController 中还是我必须为它制作的另一个配置文件？

此外，我确实可以访问 SASS，并且我知道资产压缩应该有一个过滤器，用于将我的 SASS 文件构建到 css 中，然后再次作为一个文件输出。Asset Compress 插件页面上的 Wiki 没有详细说明我在哪里可以获得它或如何将它插入我的站点，例如 CssMinFilter？

非常感谢

格伦。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T13:08:59.900

好的得到了一些答案！仍然不知道如何将 SASS 过滤器添加到 CakePHP 中，所以我会继续研究。

我现在已经转移到 YUI Compressor 来做我的 CSS，它保留了所有的“！” 文件中的标记注释。

我也知道你可以将它用于 JavaScript，但是当我这样做时，当你将 Jquery 和 Jquery UI 添加到构建时，它会处理 6 个错误，所以现在我仍在使用 JsMinFilter。

我将在我的 Jquery 版本中重新发布一个关于 eh YUI Compressor 问题的新问题。

非常感谢

格伦。

# java - Java ant Eclipse 运行错误

> ID：12806700
> 
> 赞同：3
> 
> 时间：2012-10-09T19:04:59.040
> 
> 标签：java, ant

> **可能重复：**
> [ant 错误 JAVA_HOME 未指向 SDK](https://stackoverflow.com/questions/6285301/ant-error-java-home-does-not-point-to-sdk)

我收到以下错误：

> ```
> BUILD FAILED
> C:\Users\myname\Documents\CMSC\Proj1\build.xml:22: Unable to find a javac compiler;
> com.sun.tools.javac.Main is not on the classpath.
> Perhaps JAVA_HOME does not point to the JDK.
> It is currently set to "C:\Program Files (x86)\Java\jre7"
> 
> Total time: 1 second 
> ```

我的 build.xml 文件包含以下代码：

```
<project name="Project1" default="compile" basedir=".">

  <description>
    Build file for Project1
  </description>

  <!-- global properties for this build file -->
  <property name="source.dir" location="src"/>
  <property name="build.dir" location="bin"/>
  <property name="doc.dir" location="doc"/>
  <property name="main.class" value="proj1.Project1"/>

  <!-- set up some directories used by this project -->
  <target name="init" description="setup project directories">
    <mkdir dir="${build.dir}"/>
    <mkdir dir="${doc.dir}"/>
  </target>

  <!-- Compile the java code in ${src.dir} into ${build.dir} -->
  <target name="compile" depends="init" description="compile java sources">
    <javac srcdir="${source.dir}" destdir="${build.dir}"/>
  </target>

  <!-- execute the program with the fully qualified name in ${build.dir} -->
  <target name="run" description="run the project">
    <java dir="${build.dir}" classname="${main.class}" fork="yes">
        <arg line="${args}"/>
    </java>
  </target>

  <!-- Delete the build & doc directories and Emacs backup (*~) files -->
  <target name="clean" description="tidy up the workspace">
    <delete dir="${build.dir}"/>
    <delete dir="${doc.dir}"/>
    <delete>
      <fileset defaultexcludes="no" dir="${source.dir}" includes="**/*~"/>
    </delete>
  </target>

  <!-- Generate javadocs for current project into ${doc.dir} -->
  <target name="doc" depends="init" description="generate documentation">
    <javadoc sourcepath="${source.dir}" destdir="${doc.dir}"/>
  </target>

</project> 
```

我在这里做错了什么？它似乎试图在我的 src 文件夹中找到一个 javac 文件，但我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:07:07.240

`JAVA_HOME`必须指向而`JDK`不是`JRE`。

`ant`在执行type`set JAVA_HOME=C:\Program Files (x86)\Java\jdk1.7.0_07`或您拥有的任何版本之前对其进行测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-09T19:32:34.007

[在此处](http://www.oracle.com/technetwork/java/javase/downloads/jdk7u7-downloads-1836413.html)下载最新的 JDK 。安装它并注意它的位置。例如，32 位 JDK 应安装到`C:\Program Files (x86)\Java\jdkSOMETHING`.

在 Eclipse 中，转到`Window`> `Preferences`> `Java`>`Installed JREs`并单击`Add`> `Standard JVM`（然后`Next`）。浏览到上面提到的 JDK 目录，然后点击`Finish`. 要检查您的项目是否正在使用此 JDK，请右键单击该项目并转到`Properties`. 从那里，寻找`Java Build Path`。在`Libraries`选项卡下，您应该会看到一个`JRE System Library`. 如果不是你刚刚添加的JDK，点击该条目并点击`Edit`按钮并更改它。

现在运行你的`Ant`构建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:24:02.523

查看您的错误，看起来像它的 Windows 环境，并且您正在`ant`通过命令提示符运行。

```
Follow Right Click(My Computer) -> properties -> Advanced 
-> Environment Variables -> System Variables -> New
Add  Variable Name = JAVA_HOME
     Variable Value = Path to your Base folder of Java 
                      e.g. C:\Program Files\Java\jdkxxx 
```

重新启动命令提示符，键入`java -version`. 如果它正确打印了您的 java 版本，那么您应该已准备就绪。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-09T19:15:20.623

它在说

> “也许 JAVA_HOME 不指向 JDK。”

也许你应该检查一下：D

# wkhtmltopdf - 如何在 wkhtmltopdf 中使用页脚和页眉？

> ID：12806702
> 
> 赞同：56
> 
> 时间：2012-10-09T19:05:07.250
> 
> 标签：wkhtmltopdf

我遇到了一种情况，我必须在生成的 PDF 打印件中使用页脚和页眉。CSS 解决方案仅适用于第一页。我发现的唯一信息是 WKPDF 根本不支持它，但这可以追溯到 2009 年，因此可能有所改变。

有没有人成功地做到了？

谢谢你。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-10-10T06:14:42.950

Wkhtmltopdf 甚至支持非常复杂的页眉和页脚。

```
wkhtmltopdf.exe -T 50mm --header-html www.google.com www.stackoverflow.com test.pdf && test.pdf 
```

该命令使用 www.google.com 上的页面作为每个页面的 www.stackoverflow.com 的 50 毫米标题。

**注意：**如果您为页眉/页脚使用自定义页面，则需要`<!DOCTYPE HTML>`在页眉/页脚 HTML 的开头添加！

# c# - 具有元素中的值的服务参考

> ID：12806704
> 
> 赞同：0
> 
> 时间：2012-10-09T19:05:17.600
> 
> 标签：c#, .net, wcf, service-reference

我正在使用对返回 XML 的 Java Web 服务的服务引用，如下所示：

```
<m_score value="3"><Explanation value="20.51">Class Count</Explanation>
    <Explanation value="-15.03">NCCI Governing Industry Group</Explanation>
    <Explanation value="-9.74">Combined Weighted Average Hazard Score</Explanation>
    <Explanation value="4.9">Policy Weighted Average Loss Cost Relative to Governing Class Loss Cost</Explanation>
    <Explanation value="-2.96">Governing Class Loss Cost</Explanation>
</m_score> 
```

问题是当我生成代理和请求/响应对象时，说明元素中的数据没有在对象中表示。每个元素中的属性只有属性。

有没有办法让解释名称也返回？例如，'NCCI Governing Industry Group'等...

谢谢！

编辑 - WSDL 的相关部分：

```
<complexType name="ExplanationType">
    <attribute name="value" use="required"/>
</complexType>
<complexType name="m_scoreInsuredResponseType">
    <sequence>
       <element maxOccurs="unbounded" minOccurs="0" name="Explanation" type="response:ExplanationType"/>
    </sequence>
    <attribute name="value" use="required"/>
</complexType> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T22:20:38.903

自从我看到这个已经有一段时间了，但我认为缺乏对这样的模式的适当支持是一个已知的错误。您*可以*通过使用 XmlTextAttribute 实现您自己的 Explanation 类（然后更改代理以使用它）来解决此问题，例如类似于：

public class Explanation { [XmlAttribute] public string value; [XmlText] public string theExplanation；}

（您可能需要调整上述内容以考虑命名空间，可能添加 [XmlRoot] 等。有关一些信息，请参阅[http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmltextattribute.aspx](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmltextattribute.aspx) .)

# android - 如何判断“移动网络数据”是启用还是禁用（即使通过 WiFi 连接）？

> ID：12806709
> 
> 赞同：72
> 
> 时间：2012-10-09T19:05:36.693
> 
> 标签：android, networking, network-connection

我有一个应用程序，我希望能够使用它从远程查询中获取连接状态报告。

我想知道是否连接了 WiFi，以及是否通过移动网络启用了数据访问。

如果 WiFi 超出范围，我想知道我是否可以依赖移动网络。

问题是我通过WiFi连接时，数据启用总是返回true，而我只有在没有WiFi连接时才能正确查询移动网络。

我看到的所有答案都建议轮询以查看当前连接是什么，但我想知道移动网络是否可用，如果我需要它，即使我目前可能通过 WiFi 连接。

无论如何都可以告诉是否启用了移动网络数据而无需轮询以查看是否已连接？

**编辑**

因此，当通过 WiFi 连接时，如果我转到设置并取消选择“启用数据”，然后在我的应用程序中执行以下操作：

```
 boolean mob_avail = 
 conMan.getNetworkInfo(ConnectivityManager.TYPE_MOBILE).isAvailable(); 
```

mob_avail 返回为“真”，但我已禁用移动网络数据，所以我希望它为“假”

如果我关闭 WiFi，则（正确地）没有连接，因为我禁用了移动网络数据。

那么，当我通过 WiFi 连接时，如何检查是否启用了移动网络数据？

**更新**

我按照 ss1271 的评论中的建议查看了 getAllNetworkInfo()

我在以下 3 个条件下输出了返回的有关移动网络的信息

WiFi 关闭 - 移动数据开启

WiFi 开启 - 移动数据关闭

WiFi 开启 - 移动数据开启

并得到以下结果：

> **关闭 WiFi 时：**
> 
> 移动[HSUPA]，状态：CONNECTED/CONNECTED，原因：未知，额外：互联网，漫游：false，故障转移：false，isAvailable：true，featureId：-1，userDefault：false
> 
> **WiFi开启/移动关闭**
> 
> NetworkInfo：类型：mobile[HSUPA]，状态：DISCONNECTED/DISCONNECTED，原因：connectionDisabled，额外：（无），漫游：false，故障转移：false，isAvailable：true，featureId：-1，userDefault：false
> 
> **WiFi开启/移动开启**
> 
> NetworkInfo：类型：mobile[HSPA]，状态：DISCONNECTED/DISCONNECTED，原因：connectionDisabled，额外：（无），漫游：false，故障转移：false，isAvailable：true，featureId：-1，userDefault：false

因此，您可以看到 isAvailable 每次都返回 true，并且状态仅在 WiFi 生效时显示为已断开连接。

**澄清**

我**不想**查看我的手机当前是否通过移动网络连接。我**正在**尝试确定用户是否启用/禁用了移动网络上的数据访问。他们可以通过转到设置 -> 无线和网络设置 -> 移动网络设置 -> 启用数据来打开和关闭此功能

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-10-12T18:19:35.323

以下代码将告诉您是否启用了“移动数据”，无论此时是否有移动数据连接处于活动状态或 wifi 是否启用/处于活动状态。~~此代码仅适用于 Android 2.3 (Gingerbread) 及更高版本。~~实际上，此代码也适用于早期版本的 Android ;-)

```
 boolean mobileDataEnabled = false; // Assume disabled
    ConnectivityManager cm = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
    try {
        Class cmClass = Class.forName(cm.getClass().getName());
        Method method = cmClass.getDeclaredMethod("getMobileDataEnabled");
        method.setAccessible(true); // Make the method callable
        // get the setting for "mobile data"
        mobileDataEnabled = (Boolean)method.invoke(cm);
    } catch (Exception e) {
        // Some problem accessible private API
        // TODO do whatever error handling you want here
    } 
```

注意：您需要获得`android.permission.ACCESS_NETWORK_STATE`使用此代码的权限。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2015-08-27T02:35:02.783

我已经升级了 Allesio 的答案。Settings.Secure 的 mobile_data int 自 4.2.2 起已移至 Settings.Global。

如果您想知道移动网络是否已启用，即使已启用并连接了 wifi，请尝试使用此代码。

更新以检查 SIM 卡是否可用。感谢您指出穆拉特。

```
boolean mobileYN = false;

TelephonyManager tm = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);
if (tm.getSimState() == TelephonyManager.SIM_STATE_READY) {
    if(android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.JELLY_BEAN_MR1)
    {
        mobileYN = Settings.Global.getInt(context.getContentResolver(), "mobile_data", 1) == 1;
    }
    else{
        mobileYN = Settings.Secure.getInt(context.getContentResolver(), "mobile_data", 1) == 1;
    }
} 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2015-04-14T10:57:08.470

一种方法是检查用户是否在“设置”中激活了移动数据，如果 wifi 关闭，很可能会使用该数据。这有效（经过测试），它不使用反射，尽管它使用 API 中的隐藏值：

```
boolean mobileDataAllowed = Settings.Secure.getInt(getContentResolver(), "mobile_data", 1) == 1; 
```

正如@user1444325 所指出的，根据 API，您需要检查 Settings.Global 而不是 Settings.Secure。

来源： [Android API 调用以确定用户设置“数据已启用”](https://stackoverflow.com/questions/6591774/android-api-call-to-determine-user-setting-data-enabled)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-10-11T04:48:06.670

@sNash 的功能很好用。但在少数设备中，即使数据被禁用，我发现它也会返回 true。所以我在 Android API 中找到了一种替代解决方案。

[TelephonyManager的](https://developer.android.com/reference/android/telephony/TelephonyManager.html)[getDataState()](https://developer.android.com/reference/android/telephony/TelephonyManager.html#getDataState())方法将非常有用。

我用上面使用的函数更新了@snash 的函数。当蜂窝数据被禁用时，下面的函数返回 false，否则返回 true。

```
private boolean checkMobileDataIsEnabled(Context context){
        boolean mobileYN = false;

        TelephonyManager tm = (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE);
        if (tm.getSimState() == TelephonyManager.SIM_STATE_READY) {
            TelephonyManager tel = (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE);
//          if(android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.JELLY_BEAN_MR1)
//          {
//              mobileYN = Settings.Global.getInt(context.getContentResolver(), "mobile_data", 0) == 1;
//          }
//          else{
//              mobileYN = Settings.Secure.getInt(context.getContentResolver(), "mobile_data", 0) == 1;
//          }
            int dataState = tel.getDataState();
            Log.v(TAG,"tel.getDataState() : "+ dataState);
            if(dataState != TelephonyManager.DATA_DISCONNECTED){
                mobileYN = true;
            }

        }

        return mobileYN;
    } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-12T15:42:46.987

你可以尝试这样的事情：

```
ConnectivityManager conMan = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);

//mobile
State mobile = conMan.getNetworkInfo(0).getState();

//wifi
State wifi = conMan.getNetworkInfo(1).getState();

if (mobile == NetworkInfo.State.CONNECTED || mobile == NetworkInfo.State.CONNECTING) 
{
    //mobile
}
else if (wifi == NetworkInfo.State.CONNECTED || wifi == NetworkInfo.State.CONNECTING) 
{
    //wifi
} 
```

如果您对真正的连接感兴趣，请使用

```
NetworkInfo.State.CONNECTED 
```

只是，而不是

```
NetworkInfo.State.CONNECTED || NetworkInfo.State.CONNECTING 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-01-15T03:23:25.637

由于`ConnectivityManager.allNetworkInfo`已弃用，Android 建议使用`getNetworkCapabilities`

```
fun isOnMobileData(): Boolean {
    val connectivityManager =
        context.getSystemService(CONNECTIVITY_SERVICE) as ConnectivityManager
    val all = connectivityManager.allNetworks

    return all.any {
        val capabilities = connectivityManager.getNetworkCapabilities(it)
        capabilities?.hasTransport(TRANSPORT_CELLULAR) == true
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-12-20T04:39:35.213

使用 TelephonyManager

```
TelephonyManager tm = (TelephonyManager)context.getSystemService(Context.TELEPHONY_SERVICE);

tm.isDataEnabled() 
```

根据android文档

[https://developer.android.com/reference/android/telephony/TelephonyManager.html#isDataEnabled()](https://developer.android.com/reference/android/telephony/TelephonyManager.html#isDataEnabled())

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-10-12T15:49:27.547

我认为使用[NetworkInfo 类](http://developer.android.com/reference/android/net/NetworkInfo.html)和 isConnected 应该可以工作：

```
ConnectivityManager cm = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
NetworkInfo info = cm.getNetworkInfo(ConnectivityManager.TYPE_MOBILE);

return info != NULL || info.isConnected(); 
```

并检查移动数据是否已连接。在我测试之前我不能确定。直到明天我才能做到这一点。

```
TelephonyManager tm = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);

if(tm .getDataState() == tm .DATA_CONNECTED)
   return true; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-08-16T10:19:52.387

这是针对此问题的 xamarin 解决方案：

```
 public static bool IsMobileDataEnabled()
    {
        bool result = false;

        try
        {
            Context context = //get your context here or pass it as a param

            if (Build.VERSION.SdkInt >= BuildVersionCodes.JellyBeanMr1)
            {
                //Settings comes from the namespace Android.Provider
                result = Settings.Global.GetInt(context.ContentResolver, "mobile_data", 1) == 1;
            }
            else
            {
                result = Settings.Secure.GetInt(context.ContentResolver, "mobile_data", 1) == 1;
            }
        }
        catch (Exception ex)
        {
            //handle exception
        }

        return result;
    } 
```

PS：确保您拥有此代码的所有权限。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-09T19:22:13.583

您必须使用 ConnectivityManager，并且可以在[此处找到 NetworkInfo 详细信息](http://developer.android.com/training/basics/network-ops/managing.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-06-15T12:41:34.147

```
To identify which SIM or slot is making data connection active in mobile, we need to register action android:name="android.net.conn.CONNECTIVITY_CHANGE"  with permission   
uses-permission android:name="android.permission.CONNECTIVITY_INTERNAL" &    uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"

    public void onReceive(Context context, Intent intent) 
 if (android.net.conn.CONNECTIVITY_CHANGE.equalsIgnoreCase(intent
                .getAction())) {

IBinder b = ServiceManager.getService(Context.CONNECTIVITY_SERVICE);
 IConnectivityManager service =  IConnectivityManager.Stub.asInterface(b);
NetworkState[] states = service.getAllNetworkState();

 for (NetworkState state : states) {

                if (state.networkInfo.getType() == ConnectivityManager.TYPE_MOBILE
                        && state.networkInfo.isConnected()) {

 TelephonyManager mTelephonyManager = (TelephonyManager) context
                        .getSystemService(Context.TELEPHONY_SERVICE);
         int slotList =  { 0, 1 };
          int[] subId = SubscriptionManager.getSubId(slotList[0]);
          if(mTelephonyManager.getDataEnabled(subId[0])) {
             // this means data connection is active for SIM1 similary you 
             //can chekc for SIM2 by slotList[1]
               .................
          }
}

} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-01-04T06:46:58.157

```
 ConnectivityManager cm = (ConnectivityManager) activity
                        .getSystemService(Context.CONNECTIVITY_SERVICE);
                NetworkInfo info = cm.getActiveNetworkInfo();
                String networkType = "";
    if (info.getType() == ConnectivityManager.TYPE_WIFI) {
                    networkType = "WIFI";
                } 
else if (info.getType() == ConnectivityManager.TYPE_MOBILE) {

                    networkType = "mobile";
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-07-19T09:16:50.097

根据android文档[https://developer.android.com/training/monitoring-device-state/connectivity-monitoring#java](https://developer.android.com/training/monitoring-device-state/connectivity-monitoring#java)

```
ConnectivityManager cm =
     (ConnectivityManager)context.getSystemService(Context.CONNECTIVITY_SERVICE);

NetworkInfo activeNetwork = cm.getActiveNetworkInfo();
boolean isConnected = activeNetwork != null &&
                      activeNetwork.isConnectedOrConnecting(); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-02-22T01:45:50.990

这是其他两个答案的简单解决方案：

```
 TelephonyManager tm = (TelephonyManager)context.getSystemService(Context.TELEPHONY_SERVICE);

        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
            return tm.isDataEnabled();

        } else {
            return tm.getSimState() == TelephonyManager.SIM_STATE_READY && tm.getDataState() != TelephonyManager.DATA_DISCONNECTED;
        } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-07-23T15:27:41.880

好吧，有一种解决方法可以检查数据连接是否打开。但我不确定它是否适用于所有设备。你需要检查一下。（它适用于 Android 一台设备）

```
long data = TrafficStats.getMobileRxBytes();
if(data > 0){
    //Data is On
}
else{
    //Data is Off
} 
```

如果您不了解此方法，它会返回自设备启动以来通过移动网络接收的总字节数。当您关闭移动数据连接时，它将返回零 (0)。当您打开时，它将再次返回总字节数。但是您需要注意，使用此解决方法时可能会出现问题。

*   当您重启手机时，此方法也会返回 0，因为计算是从 0 字节开始的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-09-03T08:23:43.533

```
private boolean haveMobileNetworkConnection() {
        boolean haveConnectedMobile = false;

        ConnectivityManager cm = (ConnectivityManager) getActivity().getSystemService(Context.CONNECTIVITY_SERVICE);
        NetworkInfo[] netInfo = cm.getAllNetworkInfo();

        for (NetworkInfo ni : netInfo) {

            if (ni.getTypeName().equalsIgnoreCase("MOBILE"))
                if (ni.isConnected())
                    haveConnectedMobile = true;
        }
        return haveConnectedMobile;
    } 
```

注意：您需要拥有 android.permission.ACCESS_NETWORK_STATE 权限才能使用此代码

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-09-12T08:46:34.037

有一个简单的 API 似乎可以正常工作

```
TelephonyManager tm = (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE);
return tm.isDataEnabled(); 
```

# gwt - 创建自己的小部件，可以解释里面的 html

> ID：12806712
> 
> 赞同：2
> 
> 时间：2012-10-09T19:06:07.883
> 
> 标签：gwt

我想创建自己的小部件，能够解释开始和结束标签之间的文本，例如：

```
<p1:Btn ui:field="open" >Open</p1:Btn> 
```

现在 UI 活页夹抛出错误：

```
Unexpected text in element: "Open" Element <p1:Btn ui:field='open'> (:44) 
```

我认为必须以某种方式标记小部件以允许其中的元素。第二件事是如何读取标签之间的元素。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:10:40.837

您的小部件只需实现[HasText](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/HasText.html)接口。

# javascript - 什么 JavaScript RegEx 允许除某些特殊字符外的字母数字字符？

> ID：12806716
> 
> 赞同：4
> 
> 时间：2012-10-09T19:06:14.103
> 
> 标签：javascript, regex

我需要一个 JavaScript 正则表达式，它**允许所有字母数字字符并拒绝“&”（与号）、“;” （分号）和“'”（撇号）**。

我知道如何只允许某些字符，例如`^[a-zA-Z0-9 @$]*$`— 这允许所有字母数字字符、空格、“@”（at 符号）和“$”（美元符号）。

我怎么能告诉它允许除**“&”、“;”之外的所有特殊字符 和 " ' "**，同时允许所有字母数字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:09:25.800

如果整个目的是允许*除*`&`、`;`和符号之外的所有内容`'`，则可以忽略这些：

```
[^&;']* 
```

这应该允许所有字母数字符号和所有其他特殊字符。

*如果您的可接受/拒绝字符列表更复杂，则编写一个指定什么是允许*的正则表达式可能更容易，例如您的原始样本`^[a-zA-Z0-9 @$]*$`. 这完全取决于您的需求和/或它们是否会改变（我个人更喜欢您的原始正则表达式，如果它不会发生太大变化）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T19:11:47.453

格式`[^ ]`与`[ ]`. 所以要做你想做的事，试试这个：

```
^[a-zA-Z0-9 @$]*|[^&;\`]* 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-22T11:09:16.580

/^[a-zA-Z0-9 @$] *|[^&;`,"'%!.()]* $/

# php - 从谷歌地图 api 到丰富的片段地理坐标

> ID：12806718
> 
> 赞同：0
> 
> 时间：2012-10-09T19:06:16.487
> 
> 标签：php, javascript, google-maps

我被困在我的网站上实施丰富的片段。该页面遵守 schema.org/MusicEvent 标准。但我无法弄清楚如何提取 ncenter 中包含的坐标对来填充 html 代码中的经度和纬度元标记。

```
var geocoder = new google.maps.Geocoder();
var map;
var ncenter;
function initialize() {

    var address = document.getElementById("address").firstChild.data;
    geocoder.geocode( {'address':address}, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            ncenter = results[0].geometry.location;
            var mapOptions = {
                zoom:12,
                center:ncenter,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            }
            map=new google.maps.Map(document.getElementById("map"),mapOptions);
            var marker = new google.maps.Marker({
                map:map,
                position:ncenter
            });             

        } else { 
           alert("Geocode ERROR: " + status);
        }
        });
}
window.onload=initialize; 
```

此外，这不适用于搜索引擎蜘蛛，因为它们不运行 JS。是否有任何替代解决方案（可能是基于 php 的查询）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T08:34:15.127

您需要使用 javascript 编写元标记的内容，例如（使用 jQuery）：

```
$('body').append('<div itemprop="geo">' + 
'<meta itemprop="latitude" content="' + ncenter.lat() + '" />' + 
'<meta itemprop="longitude" content="' + ncenter.lng() + '" />' + 
'</div>'); 
```

或者是的，您可以改用 PHP 来编写它。

# python - 方法返回 Unicode 对象，分配给 NoneType。在 Python 中

> ID：12806722
> 
> 赞同：0
> 
> 时间：2012-10-09T19:06:33.380
> 
> 标签：python, unicode

Whis 脚本从一个来源读取，其中包含艺术家姓名和括号，其中包含有关艺术家是否取消以及他们来自哪个国家的信息。

一个正常的句子可能看起来像：

Odd Nordstoga (NO) (Cancelled), 20-08-2012, Blå

当我导入数据时，我将它们解码为 UTF-8，这工作正常。取消注释 remove_extra() 方法的 else 块中的第二条注释表明所有变量都是 Unicode 类型。

但是，当返回一个值并放入另一个变量并测试 this 的值时，大多数变量似乎是 NoneType。

为什么会这样？以及如何纠正？似乎是方法返回和新变量分配之间发生的错误。

```
# -*- charset: utf-8 -*-

import re

f1 = open("oya_artister_2011.csv")

artister = []
navnliste = []

PATTERN = re.compile(r"(.*)(\(.*\))")
TEST_PAT = re.compile(r"\(.*\)")

def remove_extra(tekst):
    if re.search(PATTERN, tekst) > 1:
        after = re.findall(PATTERN, tekst)[0][0]
        #print "tekst is: %s   " % tekst
        #print "and of type: %s" % type(tekst)
        remove_extra(after)

    else: 
        #print "will return: ", tekst
        #print "of type: %s" % type(tekst)
        return tekst

for line in f1:
    navn, _rest = line.split(",",1)
    navn = navn.decode("utf-8")
    artister.append(navn)

for artist in artister:
    ny_artist = remove_extra(artist)
    #print "%s" % ny_artist
    print "of type: %s" % type(ny_artist) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:12:44.570

尝试

```
return remove_extra(after) 
```

而不仅仅是

```
remove_extra(after) 
```

# ms-access - 使用 SQL 后端消隐表单详细信息访问应用程序

> ID：12806726
> 
> 赞同：1
> 
> 时间：2012-10-09T19:06:55.013
> 
> 标签：ms-access, ms-access-2010

我有一个古老的 Access 应用程序，我最近使用 SQL Server 迁移助手将数据移动到了 SQL 后端，除了一个问题外，几乎所有东西都在工作。

在应用程序中，我们有一个表单，其中包含另一个表单。外部表单查找输入到系统中的特定“问题”，然后查找与该问题相关的历史记录（内部表单）。如果存在历史记录，则它可以完美运行，因为记录以嵌入形式显示就很好。但是，如果数据库中还没有历史记录，则嵌入表单的整个详细信息部分将完全空白。所有属性都设置为与纯 Access 数据库时完全相同，但现在我已将其切换为使用链接表从 SQL 中提取，当我没有要提取的记录时，表单现在为空白。

编辑：我了解到有两个条件同时满足时会导致表单的详细信息窗格变为空白：（1）没有要显示的现有记录，以及（2）不可能添加新记录。

这意味着第二个条件是我的问题所在。我尝试滚动到 Access 中每个链接表的底部，对于历史记录表，我无法添加任何新行，但对于问题表，我可以。由于某种原因，有些东西让我无法编辑这张表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:26:21.477

我认为当子表单（您的“内部表单”）的记录源是只读的时，您描述的行为可能会发生。当存在匹配行时，将显示它们。但是，当不存在匹配的行时，您不能添加行，因此子窗体的绑定数据控件被禁用。

在设计视图中打开子窗体。选择表单并打开其属性表 ( `Alt`+ `Enter`)。在属性表的数据选项卡上找到记录源属性。如果属性值是`SELECT`语句，请将其复制并粘贴到新 Access 查询的 SQL 视图中，然后将查询切换到数据表视图。如果属性是表的名称或已保存的查询，请直接在数据表视图中打开该对象。

在数据表视图中打开表单的记录源后，是否可以添加一行？如果没有，请确保 SQL Server 用户`INSERT`对数据源具有权限。但是，即使具有`INSERT`特权，如果 Access 无法识别唯一标识每一行的字段或字段组合，它也可能已将数据源链接为只读。如果是这种情况，您可能需要重新链接表并告诉 Access 哪些字段用作主键。

# java - 尝试通过 windows7 64 位机器连接到带有 GUI jProfiler 的远程 unix 64 位机器，但客户端 GUI 没有响应

> ID：12806728
> 
> 赞同：0
> 
> 时间：2012-10-09T19:06:57.743
> 
> 标签：java, tomcat, jprofiler

我正在尝试通过 windows7 64 位机器连接到带有 GUI jProfiler 的远程 unix 64 位机器，但客户端 GUI 没有回答..

我已经在我的 startup_jprofiler.sh 中设置了 java opts

```
-agentpath:/jprofiler7/bin/linux-x64/libjprofilerti.so=port=9988,nowait 
```

当我的服务器启动时，它会输出这个 jprofiler 日志

```
JProfiler> Protocol version 36
JProfiler> Using JVMTI
JProfiler> JVMTI version 1.1 detected.
JProfiler> 64-bit library
JProfiler> Don't wait for frontend to connect.
JProfiler> Starting up without initial configuration.
JProfiler> Listening on port: 9988.
JProfiler> Instrumenting native methods.
JProfiler> Can retransform classes.
JProfiler> Can retransform any class.
JProfiler> Native library initialized
JProfiler> VM initialized
JProfiler> Hotspot compiler enabled 
```

一切似乎都很好，但我的 gui 客户端（在 windows7 上）没有连接到远程机器..

是的，我已经使用 iptables 规则打开了 9988 端口（事实上，我什至完全禁用了 iptables 并且它不起作用）

# msbuild - Nant 删除任务不会删除 msbuild 后的文件

> ID：12806729
> 
> 赞同：4
> 
> 时间：2012-10-09T19:07:00.303
> 
> 标签：msbuild, nant, delete-file

使用 Nant 0.92（之前的 0.85 具有相同的结果）

我正在尝试在 NAnt 中调用*删除任务以在调用**msbuild*后删除除 .dll 文件之外的所有文件（请参见下面的脚本..我指的是“构建”目标中的删除）。*删除*任务似乎没有执行。

初始*删除*任务工作正常，并且按预期运行，从指定的构建目录中删除所有文件。然而，编译后的第二个*删除*任务不起作用。

我尝试删除所有内容（不使用*exclude*标签），尝试将*failonerror*和*verbose*显式设置为*true*。这些都没有什么不同。我还尝试使用*sleep在**删除*任务之前停止进程，以防 msbuild 中的某些内容没有及时释放文件以进行删除。我试过把删除放到一个单独的目标中，仍然没有运气。

该命令显然在调用*msbuild*之前有效，如果尝试从 msbuild 输出目标以外的目录中删除（即复制输出文件，然后删除相关文件） ，它在*msbuild之后有效。*

我确信这是一个太根本的问题，不能成为一个错误，但我想我还是会问。当然，我会在将文件复制到其他位置的同时使用解决方法，删除我不需要的内容，然后适当地移动，但我对此很好奇。

我怀疑，除非这种行为是设计使然（尽管我在 NAnt 文档中找不到任何建议），那么 msbuild 进程可能会锁定输出文件，直到 NAnt 进程完成？这是我最好的猜测。进一步的见解将不胜感激。

编辑：另外，如果我明确设置 msbuild 的 \OutputPath 开关，那么我没有同样的问题。只有在使用默认的 OutputPath 时才会出现问题。

NAnt 构建文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<project name="Reports.TestBench.PreBuild" default="postbuild.cleanup" basedir="." xmlns="http://nant.sourceforge.net/release/0.86-beta1/nant.xsd">
    <property name="nant.settings.currentframework" value="net-4.0" />
    <property name="project.StandardReports" value="${project::get-base-directory()}\Reports.StandardReports\Palladium.Reports.StandardReports.csproj" />
    <property name="output.Dir" value="${project::get-base-directory()}\bin\debug\"/>
    <property name="build.Type" value="debug"/>

    <!--Deletes the pre-existing build files-->
    <target name="clean">
        <delete>
          <fileset basedir="${output.Dir}">
            <include name="*.*" />  
          </fileset>
        </delete>
    </target>

    <!--Builds the projects to the specified build directory-->
    <target name="build" depends="clean" description="Build the Palladium Reports Standard Reports application">
        <msbuild project="${project.StandardReports}">
            <arg value="/p:Configuration=${build.Type}" />
            <!--arg value="/p:OutputPath=${path::get-full-path(buildDir.Client)}\Reports" /-->
            <arg value="/t:Rebuild" />
        </msbuild>

        <delete failonerror="true" verbose="true">
          <fileset basedir="${output.Dir}">
            <include name="*.*" />
            <exclude name="Palladium.Reports.StandardReports.dll" />
          </fileset>
        </delete>
    </target>
</project> 
```

显示构建成功且没有进一步消息的 NAnt 输出摘要：

```
 [msbuild] Build succeeded.
  [msbuild]     0 Warning(s)
  [msbuild]     0 Error(s)
  [msbuild] 
  [msbuild] Time Elapsed 00:00:03.19

BUILD SUCCEEDED

Total time: 3.5 seconds. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T12:37:26.900

尝试查看 NAnt 源代码 - 很可能该`msbuild`任务会创建一个 MSBuild 引擎，并且不会强制它在之后关闭文件。尽管查看了 MSDN 文档，但我并没有真正看到这样做的方法 - MSBuild 构造缺少`Dispose()`功能。诸如 之类的类有一个终结[`ProjectInstance`](http://msdn.microsoft.com/en-us/library/microsoft.build.execution.projectinstance.aspx)器，因此可以通过在应用程序域中运行并随后关闭整个域来强制它释放文件句柄 - 这是相当多的工作。

# asp.net - 从后面的代码设置 WebControl 的 Style 属性

> ID：12806732
> 
> 赞同：2
> 
> 时间：2012-10-09T19:07:08.890
> 
> 标签：asp.net, styles, code-behind, web-deployment

最近我*在*我的一个旧项目（`asp.net 4.0`）中发现我一直在使用这个代码

将`display`样式属性设置为`none`

```
DDL_ChosenEmpl.Attributes.Add("style", "display:none"); 
```

最近我在使用

```
DDL_ChosenEmpl.Style.Add("display", "none"); 
```

我想知道

1.  在任何情况下，例如 - 财产已经存在，无论它是否具有不同的价值，是否应该避免它们中的任何一个？

2.  两种方法的主要区别是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T19:24:47.340

两者都执行与您所做的相同的功能。问题是，在“属性”集合中，您有一个控件的其他属性，如“单击”、“dblclick”等。您可以使用任何一种方式。我相信微软已经给出了后面的部分，以方便用户使编码变得容易。

# c# - ASP .Net - MySql - 无法读取任何数据

> ID：12806733
> 
> 赞同：2
> 
> 时间：2012-10-09T19:07:15.427
> 
> 标签：c#, asp.net, .net, mysql

我遇到了一个问题，不知道 WTF 正在发生。我有一个需要使用 Web 服务与 MySQL 数据库通信的 C# Web 应用程序。我可以使用方法来插入数据，但是每当我尝试读取任何内容（ExecuteReader 或 ExecuteScalar）时，它都会失败并显示以下非常奇怪的消息：

> 字典中不存在给定的键。

现在，Web 服务使用此类与 db 进行通信：

```
 public class DatabaseHelper
{
    private MySqlCommand cmd;
    private MySqlConnection con;
    public DatabaseHelper()
    {
        String server = "localhost";
        String database = "testdb";
        String password = "password";
        String username = "root";

        String connString = "Server = " + server + "; Database = " + database + "; Uid = " + username + "; Pwd = " + password + "; default command timeout=60;";
        con = new MySqlConnection();
        con.ConnectionString = connString;

        cmd = new MySqlCommand();

        cmd.Connection = con;
    }

    public void RunExecuteNonQuery(string sql, MySqlParameter[] param)
    {
        try
        {

            cmd.CommandText = sql;
            if (param != null)
            {
                cmd.Parameters.AddRange(param);
            }
            cmd.CommandText = sql;
            con.Open();
            cmd.ExecuteNonQuery();
            con.Close();
            cmd.Parameters.Clear();

        }
        catch (MySqlException ex)
        {
            con.Close();

        }
    }
    public object RunExecuteScalar(string sql, MySqlParameter[] param)
    {
        if (param != null)
        {
            cmd.Parameters.AddRange(param);
        }
        cmd.CommandText = sql;
        object ret;
        con.Open();
        ret = cmd.ExecuteScalar();
        con.Close();
        cmd.Parameters.Clear();
        return ret;
    }

    public MySqlDataReader RunExecuteDataReader(string sql, MySqlParameter[] param)
    {
        if (param != null)
        {
            cmd.Parameters.AddRange(param);
        }
        cmd.CommandText = sql;
        MySqlDataReader ret = null;

        con.Open();

       ret = cmd.ExecuteReader(System.Data.CommandBehavior.CloseConnection);
       cmd.Parameters.Clear();

        return ret;
    }
} 
```

它在 cmd.ExecuteReader 或 cmd.ExecuteScalar 上失败！

另一方面，来自 Web 服务的方法如下所示：

```
 [WebMethod]
    public string[] GetCategories()
    {
        String sql = "SELECT * FROM category";
        DatabaseHelper dh = new DatabaseHelper();
        MySqlDataReader dr = dh.RunExecuteDataReader(sql, null);
        List<String> categories = new List<string>();
        while (dr.Read())
        {
            categories.Add(dr[0].ToString());
        }
        dr.Close();

        return categories.ToArray();
    } 
```

这真的很奇怪，因为错误非常神秘（我根本没有使用字典），而且我在许多其他应用程序中都使用过同一个类。我在另一台计算机上尝试了相同的解决方案，结果相同。我什至尝试过不同版本的 MySql.Data.dll

错误堆栈：

> > System.Collections.Generic.KeyNotFoundException 未被用户代码处理 HResult=-2146232969 消息=给定的键不在字典中。Source=mscorlib StackTrace：在 System.Collections.Generic.Dictionary`2.get_Item(TKey key) 在 MySql.Data.MySqlClient.CharSetMap.GetChararcterSet(DBVersion version, String CharSetName) 在 MySql.Data.MySqlClient.NativeDriver.GetFieldMetaData41()在 MySql.Data.MySqlClient.NativeDriver.GetFieldMetaData() 在 MySql.Data.MySqlClient.NativeDriver.ReadColumnMetadata(Int32 计数) 在 MySql.Data.MySqlClient.MySqlDataReader.NextResult() 在 MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior行为）在 Panopticon.DataLayer.DatabaseHelper.RunExecuteDataReader（字符串 sql，
> > 内部异常：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:10:16.080

用此代码替换 - 您可以删除`AddRange`方法

```
 cmd.Parameters.Add(param); 
```

并添加 foreach 处理

```
 foreach (var p in param)
        {
            cmd.Parameters.Add(p);
        } 
```

DJ KRAZE 提到的最佳实践是使用`AddWithValue method`

链接：http: [//msdn.microsoft.com/fr-fr/library/system.data.sqlclient.sqlparametercollection.addwithvalue.aspx](http://msdn.microsoft.com/fr-fr/library/system.data.sqlclient.sqlparametercollection.addwithvalue.aspx)

# excel - Excel：从某些条件下验证项目

> ID：12806738
> 
> 赞同：0
> 
> 时间：2012-10-09T19:07:36.673
> 
> 标签：excel, excel-formula, verification

我有一些可以定价的物品，而另一些则没有。表“完整价值”（Valor completo）告诉我我应该收取什么费用。我想，不知何故，回复一条消息：“你忘了收集这个项目。” 或“您要求的项目不应该。”

![在此处输入图像描述](../Images/cca9dc2e65fc7f7130feb0abda7e3b4e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:10:32.263

在英文版的 excel 中，你会使用

```
=iferror(vlookup(...),"You forgot to collect this item") 
```

在巴西，可能类似于

```
=SEERRO(PROCV(...),"You forgot to collect this item") 
```

# java - 数组是原始类型还是对象（或完全是其他东西）？

> ID：12806739
> 
> 赞同：58
> 
> 时间：2012-10-09T19:07:51.343
> 
> 标签：java, arrays, object, primitive

这个问题基本上是不言自明的。我无法找到数组的 API（除了这个[Arrays](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html)，但这只是定义了一堆用于处理实际数组的静态辅助函数）。如果它没有类，这似乎表明数组不能是`Object`.

但是，数组具有类似的公共字段和`length`可以调用的方法这一事实似乎（非常强烈地）暗示了完全相反的情况。`.equals()``.clone()`

原始数组的奇怪表示和行为的解释是什么？

作为说明，我刚才尝试在`.clone()`数组的方法上使用“Open Implementation” Eclipse 功能，希望我能够查看该方法的定义位置和方式（因为它说 int[] overrode it from对象），但它实际上导致我的整个 Eclipse 冻结并崩溃......

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-10-09T20:15:13.070

每种数组类型都有一个类，所以有一个类 for `int[]`，还有一个类 for `Foo[]`。这些类是由 JVM 创建的。您可以通过`int[].class`,访问它们`Foo[].class`。这些类的直接超类是`Object.class`

```
public static void main(String[] args)
{
    test(int[].class);
    test(String[].class);
}

static void test(Class clazz)
{
    System.out.println(clazz.getName());
    System.out.println(clazz.getSuperclass());
    for(Class face : clazz.getInterfaces())
        System.out.println(face);
} 
```

还有一个编译时子类型规则，如果`A`是 的子类型`B`，`A[]`就是 的子类型`B[]`。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-10-09T19:28:05.977

[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html)应该给你一个想法：

> 数组类型的直接超类是 Object。
> 
> 每个数组类型都实现了接口`Cloneable`和`java.io.Serializable`.

[此外](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.3.1)：

> 对象是类实例或数组。

所以数组不是实例，因此您不需要构造函数来创建它们。相反，您使用[Array Creation Expressions](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.10)。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-10-09T19:15:59.973

请参阅下面的代码。它编译：

```
 int[] arr = new int[2];
    System.out.println(arr.toString()); 
```

现在，在任何原始类型上，您都不能调用`toString()`在 Object 类中定义的 method()（或者，任何相关的方法）......所以，数组本质上是一个`Object`.

**好的，给你：**

从[JLS 第 4.3 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.3)：

> 有四种引用类型：类类型（第 8 节）、接口类型（第 9 节）、类型变量（第 4.4 节）和数组类型（第 10 节）。

并且，[第 10 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html)：

> In the Java programming language, arrays are objects (§4.3.1), are dynamically created, and may be assigned to variables of type Object (§4.3.2). All methods of class Object may be invoked on an array.

So, from the first quote, `Array` is not actually a class... It is another type. But, essentially arrays are objects, though not of some `Class`, but they are of `Array` type. So they are not instances of some class, and may be objects of `array` are defined to be created that way...

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-10-09T19:15:57.220

如此简短，是的 <Type>[] 是`Object`. `Object`据我了解，它直接延伸。上面有所有的 Object 方法`toString()`，, `hashCode()`, ... 加上一个特殊的暴露变量，称为`length`. 该类`java.util.Arrays`是用于处理数组类型的实用程序类。当您添加诸如： `int[]`不继承自`Object[]`. 此外，与其他`Object`类型不同，数组类型没有构造函数。他们尊重`new`关键字，但这通常是为了分配大小。这有点奇怪，但只是这些语言怪癖之一。

不过，要回答这个问题，是的，它们是一个对象。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-09T19:10:37.047

> 数组是一个容器对象，它包含固定数量的单一类型的值。

请参阅[http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-09T19:49:01.427

只有我们知道的 Java 中的这几种原始类型。基本上，我们仍然有几个步骤来创建一个数组，例如声明、***构造***或初始化（如果需要），这意味着数组确实是一个对象。

更深入一点，原始类型可以与原始值一起存储在内存中，但对象是地址（引用）。所以我们可以想象一个悖论，如果数组是原始类型，我们如何将原始值存储在内存中？我认为和String一样，但是String是一个final对象，这样你就可以用一种简单的方式构造一个对象，String s = "s"，就像一个原始类型。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-10-09T19:10:25.597

它是一个对象

[http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)

# authentication - 使用 MVC 客户端 OpenID / OAuth 的 WebAPI 应用程序的安全性

> ID：12806740
> 
> 赞同：2
> 
> 时间：2012-10-09T19:07:52.297
> 
> 标签：authentication, oauth, openid, authorization, asp.net-web-api

我知道那里已经有很多问题了，我已经阅读博客并查看示例已经一个多星期了，但对于其中一些在现实世界中如何发挥作用，我仍然有些模糊。这些样本非常有帮助，有些非常复杂，有些很简单，没有一个能够真正澄清我的一些问题。

该系统包括：

*   Web 应用程序（自己的 IIS 站点，使用 SSL，使用公共 API）
*   公共 API（自己的 IIS 站点，使用 SSL）
*   桌面小部件
*   移动设备（iOS、Android）
*   第 3 方应用程序

如何最好地处理用户注册和帐户创建？在提供 OpenID 的同时，还需要对 Web 应用程序进行“本地”登录。在 API 上拥有一个接受基本数据类型（字符串/日期等）值然后创建帐户的方法是在给垃圾邮件发送者带来麻烦和危险信号。最好只通过使用视觉验证码检查的网站来处理这个问题？Facebook 移动应用如何处理这种注册场景？

许多示例似乎也使用了默认表单身份验证数据库的一小部分作为成员资格。然后，他们根据用例以各种不同的方式使用 Entity Framework 和 Membership、WebSecurity 或 FormsAuthentication、Roles Provider 类。对于安全后端，是否有任何替代方法可以考虑？我们的数据库人员正在考虑推出我们自己的，但我们还需要构建自己的用户管理应用程序:(

一旦用户注册并登录到 Web 应用程序，我就看不到继续对 WebAPI 上的每个调用进行身份验证和授权的任何方法。我目前假设 API 应该只实现 OAuth 并将 Web 应用程序视为另一个客户端应用程序，如移动应用程序和 3rd 方应用程序。

我想我已经阅读了太多，没有玩代码来解决这个问题。有很多方法。

TIA,

# sql - 从同一张表的另一列更新sql表一列的内容

> ID：12806744
> 
> 赞同：1
> 
> 时间：2012-10-09T19:08:07.267
> 
> 标签：sql

结构如下：

```
Col1        Col2
12345       12  
12348       14
20145       16
00541       13
51234       22 
```

我想从 col1 元素中复制 col2 元素。什么是查询来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:10:52.670

如果你想要的只是 Col2 等于 Col1 那么你可以这样做：

```
UPDATE aTable
set Col2 = Col1 
```

# c++ - 从 C++ 中的屏幕选择创建位图时出现黑色图像

> ID：12806747
> 
> 赞同：2
> 
> 时间：2012-10-09T19:08:29.130
> 
> 标签：c++, winapi, screenshot, bmp

我正在尝试获取桌面选定区域的屏幕截图。

我遇到的问题是输出（.bmp 文件）只是黑色的。

我拿了 CreateBitmapInfoStruct(); 和 CreateBMPFile(); 来自[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145119%28v=vs.85%29.aspx)。其余的都是我从互联网科学怪人那里剪下来的。

这是我的代码目前的样子：

```
#include <windows.h>
#include <iostream>
#include <fstream>
#include <string>
using namespace std;

PBITMAPINFO CreateBitmapInfoStruct(HBITMAP hBmp)
{ 
    BITMAP bmp; 
    PBITMAPINFO pbmi; 
    WORD    cClrBits; 

    // Retrieve the bitmap color format, width, and height.  
    if (!GetObject(hBmp, sizeof(BITMAP), (LPSTR)&bmp)) 
        cout << "ERROR:1";

    // Convert the color format to a count of bits.  
    cClrBits = (WORD)(bmp.bmPlanes * bmp.bmBitsPixel); 
    if (cClrBits == 1) 
        cClrBits = 1; 
    else if (cClrBits <= 4) 
        cClrBits = 4; 
    else if (cClrBits <= 8) 
        cClrBits = 8; 
    else if (cClrBits <= 16) 
        cClrBits = 16; 
    else if (cClrBits <= 24) 
        cClrBits = 24; 
    else cClrBits = 32; 

    // Allocate memory for the BITMAPINFO structure. (This structure  
    // contains a BITMAPINFOHEADER structure and an array of RGBQUAD  
    // data structures.)  

     if (cClrBits < 24) 
         pbmi = (PBITMAPINFO) LocalAlloc(LPTR, 
                    sizeof(BITMAPINFOHEADER) + 
                    sizeof(RGBQUAD) * (1<< cClrBits)); 

     // There is no RGBQUAD array for these formats: 24-bit-per-pixel or 32-bit-per-pixel 

     else 
         pbmi = (PBITMAPINFO) LocalAlloc(LPTR, 
                    sizeof(BITMAPINFOHEADER)); 

    // Initialize the fields in the BITMAPINFO structure.  

    pbmi->bmiHeader.biSize = sizeof(BITMAPINFOHEADER); 
    pbmi->bmiHeader.biWidth = bmp.bmWidth; 
    pbmi->bmiHeader.biHeight = bmp.bmHeight; 
    pbmi->bmiHeader.biPlanes = bmp.bmPlanes; 
    pbmi->bmiHeader.biBitCount = bmp.bmBitsPixel; 
    if (cClrBits < 24) 
        pbmi->bmiHeader.biClrUsed = (1<<cClrBits); 

    // If the bitmap is not compressed, set the BI_RGB flag.  
    pbmi->bmiHeader.biCompression = BI_RGB; 

    // Compute the number of bytes in the array of color  
    // indices and store the result in biSizeImage.  
    // The width must be DWORD aligned unless the bitmap is RLE 
    // compressed. 
    pbmi->bmiHeader.biSizeImage = ((pbmi->bmiHeader.biWidth * cClrBits +31) & ~31) /8
                                  * pbmi->bmiHeader.biHeight; 
    // Set biClrImportant to 0, indicating that all of the  
    // device colors are important.  
     pbmi->bmiHeader.biClrImportant = 0; 
     return pbmi; 
 } 

void CreateBMPFile(LPTSTR pszFile, PBITMAPINFO pbi, 
                  HBITMAP hBMP, HDC hDC) 
 { 
     HANDLE hf;                 // file handle  
    BITMAPFILEHEADER hdr;       // bitmap file-header  
    PBITMAPINFOHEADER pbih;     // bitmap info-header  
    LPBYTE lpBits;              // memory pointer  
    DWORD dwTotal;              // total count of bytes  
    DWORD cb;                   // incremental count of bytes  
    BYTE *hp;                   // byte pointer  
    DWORD dwTmp; 

    pbih = (PBITMAPINFOHEADER) pbi; 
    lpBits = (LPBYTE) GlobalAlloc(GMEM_FIXED, pbih->biSizeImage);

    if (!lpBits) 
         cout << "ERROR:2"; 

    // Retrieve the color table (RGBQUAD array) and the bits  
    // (array of palette indices) from the DIB.  
    GetDIBits(hDC, hBMP, 0, (WORD) pbih->biHeight, lpBits, pbi, 
        DIB_RGB_COLORS);

    // Create the .BMP file.  
    hf = CreateFile(pszFile, 
                   GENERIC_READ | GENERIC_WRITE, 
                   (DWORD) 0, 
                    NULL, 
                   CREATE_ALWAYS, 
                   FILE_ATTRIBUTE_NORMAL, 
                   (HANDLE) NULL); 
    if (hf == INVALID_HANDLE_VALUE) 
        cout << "ERROR:4"; 
    hdr.bfType = 0x4d42;        // 0x42 = "B" 0x4d = "M"  
    // Compute the size of the entire file.  
    hdr.bfSize = (DWORD) (sizeof(BITMAPFILEHEADER) + 
                 pbih->biSize + pbih->biClrUsed 
                 * sizeof(RGBQUAD) + pbih->biSizeImage); 
    hdr.bfReserved1 = 0; 
    hdr.bfReserved2 = 0; 

    // Compute the offset to the array of color indices.  
    hdr.bfOffBits = (DWORD) sizeof(BITMAPFILEHEADER) + 
                    pbih->biSize + pbih->biClrUsed 
                    * sizeof (RGBQUAD); 

    // Copy the BITMAPFILEHEADER into the .BMP file.  
    if (!WriteFile(hf, (LPVOID) &hdr, sizeof(BITMAPFILEHEADER), 
        (LPDWORD) &dwTmp,  NULL)) 
    {
       cout << "ERROR:5";
    }

    // Copy the BITMAPINFOHEADER and RGBQUAD array into the file.  
    if (!WriteFile(hf, (LPVOID) pbih, sizeof(BITMAPINFOHEADER) 
                  + pbih->biClrUsed * sizeof (RGBQUAD), 
                  (LPDWORD) &dwTmp, ( NULL)))
        cout << "ERROR:6";

    // Copy the array of color indices into the .BMP file.  
    dwTotal = cb = pbih->biSizeImage; 
    hp = lpBits; 
    if (!WriteFile(hf, (LPSTR) hp, (int) cb, (LPDWORD) &dwTmp,NULL)) 
           cout << "ERROR:7";

    // Close the .BMP file.  
     if (!CloseHandle(hf)) 
           cout << "ERROR:8"; 

    // Free memory.  
    GlobalFree((HGLOBAL)lpBits);
}

void getBit(string name) {
    int nX = 300;
    int nX2 = 600;
    int nY = 300;
    int nY2 = 700;
     HDC hScrDC  =  GetDC(NULL); 
     HDC hMemDC  =  CreateCompatibleDC(hScrDC);
     int nWidth  =  nX2  -  nX; 
     int nHeight  =  nY2  -  nY; 
     HBITMAP hBitmap  =  CreateCompatibleBitmap(hScrDC,  nWidth,  nHeight); 
     HBITMAP hOldBitmap  =  (HBITMAP)SelectObject(hMemDC,  hBitmap); 

     BitBlt(hMemDC,  0,  0,  nWidth,  nHeight, 
     hScrDC,  nX,  nY,  SRCCOPY); 
     hBitmap  =  (HBITMAP)SelectObject(hMemDC,  hOldBitmap); 
     DeleteDC(hScrDC); 
     DeleteDC(hMemDC); 
    // now your image is held in hBitmap. You can save it or do whatever with it
    PBITMAPINFO pbi = CreateBitmapInfoStruct(hBitmap);
    //File name
    LPTSTR path = L"test.bmp";
    CreateBMPFile(path,pbi,hBitmap,hMemDC);
}

void main(void) {
    getBit("SAVE");
    cout << "Done";
    int wait;
    cin >> wait;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T20:27:44.623

最大的问题是`GetDIBits`失败，因为您将句柄传递给已删除的内存上下文，而不是传递给有效设备上下文的句柄。如果你解决了这个问题，它会起作用。

调试时，检查所有返回值总是一个好主意。

我注意到的其他事情：

1.  You should not delete hSrcDC, since you didn't create it. Use `ReleaseDC`, which is the companion to `GetDC`.
2.  Consider using `CAPTUREBLT` in your `BitBlt` call.

# android - Android 开发者每次下载能赚多少钱？

> ID：12806750
> 
> 赞同：-2
> 
> 时间：2012-10-09T19:08:54.160
> 
> 标签：android, mobile, payment

我最近完成了一个 iOS 应用程序。他们直截了当地说你获得了应用程序销售额的 70%。我也在考虑为android开发。但我找不到任何关于 Android 销售的信息。（抱歉，这不完全是一个编程问题。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:14:54.223

你在 Android 上也能获得 70% 的收益。

[http://support.google.com/googleplay/android-developer/bin/answer.py?hl=en&answer=112622](http://support.google.com/googleplay/android-developer/bin/answer.py?hl=en&answer=112622)

# titanium - 钛图像尺寸错误

> ID：12806752
> 
> 赞同：0
> 
> 时间：2012-10-09T19:08:59.300
> 
> 标签：titanium, titanium-mobile

我有一个 Titanium 应用程序，我对许多不同的图像使用相同的 ImageView。我通过设置图像属性来更改图像视图中的图像。

问题是某些图像有时没有显示全尺寸，这有点随机，但有时它们显示全尺寸有时不显示。

我在图像视图上将宽度和高度设置为“自动”。

任何人都会遇到这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:39:38.730

[一种可能更可靠的方法是在使用Titanium.Blob.imageAsReized](http://docs.appcelerator.com/titanium/2.1/index.html#!/api/Titanium.Blob-method-imageAsResized)将图像移交给 ImageView 之前过于动态地调整图像大小。

尝试将其集成到您的代码中，首先您必须将图像作为 blob 加载。

```
// Get the blob of your image first, then call this method
imageView.image = imageBlob.imageAsResized(newWidth, newHeight); 
```

# linux - 通过 shell 脚本替换节点

> ID：12806755
> 
> 赞同：0
> 
> 时间：2012-10-09T19:09:17.407
> 
> 标签：linux, unix

我的代码库中有以下 xml 片段：

```
 <property name="myData">
        <map>
            <entry key="/mycompany/abc">
                <value>Mike</value>
            </entry>
            <entry key="/mycompany/pqr">
                <value>John</value>
            </entry>
            <entry key="/mycompany/xyz">
                <value>Sara</value>
            </entry>
        </map>
    </property> 
```

上面的片段只是 XML 文件的一部分。我有一个现有的 shell 脚本，它替换了上述文件中的一些数据。

现在，我需要修改现有的 shell 脚本以注释该部分，如下所示：

```
 <!-- entry key="/mycompany/abc">
                <value>Mike</value>
            </entry>
            <entry key="/mycompany/pqr">
                <value>John</value>
            </entry --> 
```

是否可以通过 shell 脚本评论上述 2 个条目以进行评论？我可以替换任何出现的 ，因为我只有一个这样的唯一事件，但如果 /mycompany/pqr 节点，我无法替换 </entry> 结束标记，因为如果我尝试用 < 替换它，所有匹配项都将被替换/入口 -->

关于如何在 shell 脚本中替换这个关闭节点的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T22:26:34.120

使用这样的 xslt 样式表：

```
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">

 <xsl:output omit-xml-declaration="no"/>

    <xsl:template match="node()|@*">
      <xsl:copy>
         <xsl:apply-templates select="node()|@*"/>
      </xsl:copy>
    </xsl:template>

    <xsl:template match="/property/map/entry[@key='/mycompany/abc']"/>
    <xsl:template match="/property/map/entry[@key='/mycompany/pqr']"/>
</xsl:stylesheet> 
```

然后通过 shell 脚本使用 xsltproc xsl 处理器：

```
$ xsltproc fix.xslt document.xml 
```

这会给你：

```
<?xml version="1.0"?>
<property name="myData">
        <map>

            <entry key="/mycompany/xyz">
                <value>Sara</value>
            </entry>
        </map>
    </property> 
```

如果你真的需要注释掉那些节点，那么我的 xslt-foo 不够强大 - 你可能需要`<xsl:comment>`.

编辑：使用 awk 的解决方案：

```
awk '/<entry key="\/mycompany\/(abc|pqr)">/,/<\/entry>/ {p=1}; /.*/{ if(p==0) {print;}; p=0 }' blah.xml 
```

结果：

```
<property name="myData">
    <map>
        <entry key="/mycompany/xyz">
            <value>Sara</value>
        </entry>
    </map>
</property> 
```

请注意，awk 版本不能与嵌套标签一起正常工作。

-缺口

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T00:13:53.743

免责声明：我认为对 XML 文件使用 awk/sed/... 是个坏主意；如果格式更改，标签之间的行号不同，您最终会得到一个 bung XML 文件。

```
 BEGIN{
      count=-6
    }
    {
      if( $0 !~ /\/mycompany\/pqr/ && NR != count+5){
            print $0
            next
        }
      if( $0 ~ /\/mycompany\/pqr/) {
        count=NR; 
        print gensub( /(entry)/, "!-- \\1", "1" )
      }else{
        print gensub( /(entry)/, "\\1 --", "1" ) 
      }
    } 
```

另存为“something.awk”，运行如下：

```
awk -f something.awk your_file.xml 
```

# c++ - C++ 文件 IO：读取和写入 16 位字

> ID：12806756
> 
> 赞同：3
> 
> 时间：2012-10-09T19:09:18.233
> 
> 标签：c++, stl, iostream, widechar

我想将非 Unicode 的 16 位字写入文件，稍后再读回。我知道通过一些字节操作我可以在`char`模式下使用`fstream::read()`and来做到这一点`fstream::write()`。我需要做什么才能直接使用 16 位字？

例如，似乎我应该能够执行以下操作：

```
 basic_ofstream<uint16_t> aw;
 aw.open("test.bin", ios::binary);
 uint16_t c[] = {0x55aa, 0x1188};
 aw.write(c, 2);
 aw.close();

 basic_ifstream<uint16_t> ax;
 ax.open("test.bin", ios::binary);
 uint16_t ui[2];
 ax.read(ui, 2);
 ax.close();
 cout << endl << hex << unsigned(ui[0]) << " " << unsigned(ui[1]) << endl; 
```

gcc 4.4 输出：

```
d 0 
```

VC++10 输出：

```
CCCC CCCC 
```

我也尝试过使用`std::basic_filebuf<uint16_t>`直接并得到相同的结果。为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T19:30:09.807

我真的很惊讶您将流实例化以进行任何阅读！结果可能是实现定义的（即，您可能会发现编译器文档中描述的行为）但可能只是没有指定（尽管不是完全未定义）。我认为流类不需要立即支持其他类型的实例化`char`，`wchar_t`即不需要用户提供至少一些方面。

标准流类是字符类型的模板，但对于任何不受支持的类型都不容易实例化。至少，您需要`std::codecvt<int16_t, char, std::mbstate_t>`在以字节为单位的外部表示和内部表示之间实现合适的方面转换。从外观上看，您尝试的两个系统对其默认实现做出了不同的选择。

`std::codecvt<internT, externT, stateT>`是用于在字符的外部表示和字符的内部表示之间进行转换的方面。Streams 只需要支持`char`将字节表示为外部类型`externT`。内部字符类型`internT`可以是任何整数类型，但需要通过实现代码转换方面来定义转换。如果我没记错的话，流也可以假设状态类型`stateT`是`std::mbstate_t`（这实际上有点问题，因为没有为这种类型定义接口！）。

除非您真的致力于为您的字符类型创建 I/O 流，否则您`uint16_t`可能希望使用读取字节`std::ifstream`并将它们转换为您的字符类型。写字符也是如此。要真正创建一个也支持格式化的 I/O 流，您还需要许多其他方面（例如 , `std::ctype<uint16_t>`）`std::num_punct<uint16_t>`，并且您需要构建一个`std::locale`来包含所有这些以及一些可以从标准库的实现（例如，`std::num_get<uint16_t>`和`std::num_put<uint16_t>`；我认为它们的迭代器类型是合适的默认值）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T19:48:30.403

当我尝试您的代码时，文件已写入，但里面没有任何内容，关闭后其大小为 0。从该文件读取时，无法读取任何内容。您在输出中看到的是未初始化的垃圾。

除了使用带有默认字符的 ofstream/ifstream 之外，您不一定要依赖`read()`and`write()`方法，因为它们并不表示它们是否真的写了任何东西。有关详细信息，请参阅[http://en.cppreference.com/w/cpp/io/basic_ostream/write](http://en.cppreference.com/w/cpp/io/basic_ostream/write)。尤其是这很有趣：

> 这个函数是一个未格式化的输出函数：它通过构造一个哨兵类型的对象开始执行，如果需要，它会刷新 tie() 的输出缓冲区并检查流错误。构造完成后，如果哨兵对象返回 false，则函数返回而不尝试任何输出。

很可能这就是为什么没有将输出写入您的文件的原因，因为它似乎不是为使用除 char 或类似类型之外的任何其他类型而设计的。

更新：要查看写入/读取是否成功，请检查应该已经表明出现问题的失败或坏位。

```
cout << aw.fail() << aw.bad() << "\n";
cout << ax.fail() << ax.bad() << "\n"; 
```

两者都设置为 true，所以你真正的问题应该是：为什么调用 `write()`失败？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T19:27:54.947

我建议阅读：[http ://www.cplusplus.com/articles/DzywvCM9/](http://www.cplusplus.com/articles/DzywvCM9/)

片段：

> “这些类型的问题在于它们的大小没有明确定义。 int 在一台机器上可能是 8 个字节，但在另一台机器上只有 4 个字节。唯一一致的是 char ......它保证始终是 1 个字节。 "

```
u16 ReadU16(istream& file)
{
  u16 val;
  u8 bytes[2];

  file.read( (char*)bytes, 2 );  // read 2 bytes from the file
  val = bytes[0] | (bytes[1] << 8);  // construct the 16-bit value from those bytes

  return val;
}

void WriteU16(ostream& file, u16 val)
{
  u8 bytes[2];

  // extract the individual bytes from our value
  bytes[0] = (val) & 0xFF;  // low byte
  bytes[1] = (val >> 8) & 0xFF;  // high byte

  // write those bytes to the file
  file.write( (char*)bytes, 2 );
} 
```

您可能还想刷新“typedef”关键字，以定义保证的-#-bits 类型。虽然学习曲线多一点，但 Boost 和 C99 编译器也定义了有保证的大小类型。我不确定 X++0x，但它太新而不能移植。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-09T19:49:26.247

您可以使用 char 特化和 reinterpret_cast：

```
basic_ofstream<char> aw;
...
aw.write( reinterpret_cast<const char*>(i16buf), n2write*sizeof(int16_t) );

basic_ifstream<char> ax;
...
ax.read( reinterpret_cast<char*>(i16buf), n2read*sizeof(int16_t) ); 
```

“sizeof(int16_t)”适用于 sizeof(int16_t)==1 的边缘情况（例如 DSP 处理器）

当然，如果你需要以特定的字节顺序读/写，那么你需要字节序转换函数。请注意，没有确定字节顺序的标准编译时方法。

# ruby-on-rails - 从头开始标记：标签云问题

> ID：12806757
> 
> 赞同：3
> 
> 时间：2012-10-09T19:09:21.577
> 
> 标签：ruby-on-rails, tagging, tag-cloud

我正在按照[http://railscasts.com/episodes/382-tagging](http://railscasts.com/episodes/382-tagging)的说明从头开始构建标签系统。一切都很好，但不是 tag_cloud 助手。它在搜索 tag_counts 时引发数据库错误。

以下范围：

```
#Picture.rb

class Picture < ActiveRecord::Base

  attr_accessible :description, :title, :tag_list

  has_many :taggings
  has_many :tags, through: :taggings

#Because of the following I'm getting an error from the Posgresql (showed in "Database Error")

  def self.tag_counts 

    Tag.select("tags.*, count(taggings.tag_id) as count").
      joins(:taggings).group("taggings.tag_id")
  end
end 
```

# Application_helper.rb

```
def tag_cloud(tags, classes)
  max = tags.sort_by(&:count).last
  tags.each do |tag|
    index = tag.count.to_f / max.count * (classes.size - 1)
    yield(tag, classes[index.round])
end 
```

# 数据库错误

ActiveRecord::StatementInvalid in Pictures#index

```
PG::Error: column "tags.id" ​​should appear in the GROUP BY clause or be used in an aggregate function

LINE 1: SELECT tags.*, count(taggings.tag_id) as count FROM "tags" I...

               ^
: SELECT tags.*, count(taggings.tag_id) as count FROM "tags" INNER JOIN "taggings" ON "taggings"."tag_id" = "tags"."id" GROUP BY taggings.tag_id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T21:19:07.447

您应该按 tags.id 和/或 count taggings.id 分组

```
Tag.select("tags.*, count(taggings.id) as count").
  joins(:taggings).group("tags.id") 
```

您不能在查询中同时分组和聚合。

# c# - ServiceStack Redis C# 缓慢检索数据

> ID：12806760
> 
> 赞同：3
> 
> 时间：2012-10-09T19:09:27.770
> 
> 标签：c#, redis, deserialization, servicestack

我在 C# 中使用 Redis Servicestack。目前，我存储数据的方式如下：

```
var listTypedRedis = db.As<MyObject>();

foreach (var obj in myObjects)
{
       listTypedRedis.AddItemToList(listTypedRedis.Lists["urn:list"], obj);
} 
```

我成功存储了大约 6000 条记录。我在检索记录时遇到问题，因为它似乎比 SQL 慢。

> 用了 Redis 138ms，用了 SQL 105ms

我检索数据的方式如下：

```
return (db.As<MyObject>().Lists["urn:list"].GetAll()); 
```

我上面的代码有问题吗？是因为反序列化导致它这么慢吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:53:03.457

每当处理远程数据存储时，请尽可能考虑使用批处理方法。例如，在 ServiceStack.Redis 中，您可以使用[AddRangeToList](https://github.com/ServiceStack/ServiceStack.Redis/blob/master/src/ServiceStack.Redis/RedisClient_List.cs#L83)将多个项目添加到列表中。

Redis 中的每个操作**都会进行一次网络调用**，您希望尽可能地对其进行优化。[RedisClient](https://github.com/ServiceStack/ServiceStack.Redis/wiki/RedisTransactions)中有许多批处理操作，它还支持[流水线](https://github.com/ServiceStack/ServiceStack.Redis/blob/master/tests/ServiceStack.Redis.Tests/RedisPipelineTests.cs)和流水线操作[（redis 文档）](http://redis.io/topics/pipelining)，并允许您在更少的套接字写入中批处理多个操作。

# algorithm - 这个 SuperFashHash 实现是否计算了正确的 31 位字符串散列？

> ID：12806761
> 
> 赞同：0
> 
> 时间：2012-10-09T19:09:27.430
> 
> 标签：algorithm, vba, hash, excel

我正在 VBA 中实现 SuperFastHash 的变体，用于 Excel（32 位版本，因此没有可用的 LongLong）来散列字符串。

为了绕过带符号的 32 位 Long 值的限制，我正在使用 Double 类型进行加法和位移，然后从 Double 转换为 Long 以将其截断为 31 位（最大正值 -不想处理二进制补码和符号）。

到目前为止，我得到了答案并避免了溢出，但我怀疑我在翻译中犯了一些错误，因为大多数实现都使用 uint 的所有 32 位，并且还处理数组中的单个字节而不是 16 位值来自 AscW()。

我希望有人可以检查一下实现的特定部分：

1.  我如何测试 16 位字符而不是 4 字节块。
2.  考虑到我需要将 Long 值截断为 31 位，我的位移操作在技术上是否正确。
3.  考虑到哈希仅使用 31 位，最终的雪崩片段是否仍然合适。

这是当前代码：

```
Public Function shr(ByVal Value As Long, ByVal Shift As Byte) As Long
    shr = Value
    If Shift > 0 Then shr = shr \ (2 ^ Shift)
End Function

Public Function shl(ByVal Value As Long, ByVal Shift As Byte) As Long
    If Shift > 0 Then
        shl = LimitDouble(CDbl(Value) * (2& ^ Shift))
    Else
        shl = Value
    End If
End Function

Public Function LimitDouble(ByVal d As Double) As Long
    '' Prevent overflow by lopping off anything beyond 31 bits
    Const MaxNumber As Double = 2 ^ 31
    LimitDouble = CLng(d - (Fix(d / MaxNumber) * MaxNumber))
End Function

Public Function SuperFastHash(ByVal dataToHash As String) As Long
    Dim dataLength As Long
    dataLength = Len(dataToHash)
    If (dataLength = 0) Then
        SuperFastHash = 0
        Exit Function
    End If
    Dim hash As Long
    hash = dataLength
    Dim remainingBytes As Integer
    remainingBytes = dataLength Mod 2
    Dim numberOfLoops As Integer
    numberOfLoops = dataLength \ 2
    Dim currentIndex As Integer
    currentIndex = 0
    Dim tmp As Double
    Do While (numberOfLoops > 0)
        hash = LimitDouble(CDbl(hash) + AscW(Mid$(dataToHash, currentIndex + 1, 1)))
        tmp = shl(AscW(Mid$(dataToHash, currentIndex + 2, 1)), 11) Xor hash
        hash = shl(hash, 16) Xor tmp
        hash = LimitDouble(CDbl(hash) + shr(hash, 11))
        currentIndex = currentIndex + 2
        numberOfLoops = numberOfLoops - 1
    Loop
    If remainingBytes = 1 Then
        hash = LimitDouble(CDbl(hash) + AscW(Mid$(dataToHash, currentIndex + 1, 1)))
        hash = hash Xor shl(hash, 10)
        hash = LimitDouble(CDbl(hash) + shr(hash, 1))
    End If
    '' Final avalanche
    hash = hash Xor shl(hash, 3)
    hash = LimitDouble(CDbl(hash) + shr(hash, 5))
    hash = hash Xor shl(hash, 4)
    hash = LimitDouble(CDbl(hash) + shr(hash, 17))
    hash = hash Xor shl(hash, 25)
    hash = LimitDouble(CDbl(hash) + shr(hash, 6))
    SuperFastHash = hash
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T22:29:09.627

我建议不要乱用双打，最好将 32 位字分成两个“16 位”部分，每个部分都保存在有符号的 32 位变量中（使用低 16 位每个变量的值，然后“标准化”步骤之间的值：

```
highPart = (highPart + (lowPart \ 65536)) and 65535
lowPart = lowPart and 65535 
```

左移 16 位只是意味着将低部分复制到高部分并将低部分归零。右移 16 位只是意味着将高部分复制到低部分并将高部分归零。向左移动较少的位置仅意味着分别移动两个部分，然后进行归一化。将归一化的数字右移较少的位数意味着将两个部分都左移 (16-N) 位、归一化和右移 16 位。

# hbase - 仅在键 + 复合键和通配符中的 HBase 数据

> ID：12806762
> 
> 赞同：2
> 
> 时间：2012-10-09T19:09:34.963
> 
> 标签：hbase

以下是我的问题：

1）您是否尝试将所有数据仅放在行键中？我有非常小的数据行（但数百万行），需要将更多的数据实体组合在一起以使密钥独一无二，所以我的想法是使用我需要存储在 HBase 中的所有内容创建一个复合密钥。您是否尝试过，您认为瓶颈/问题可能是什么？应该考虑什么？我可以想象这将需要更多的 RAM，因为我将有更多的东西放入布隆过滤器中。

2) 我只是想对此进行确认，因为我在这个表格中找不到它。就我获得 HBase 而言，如果我有一个复合键，可以说：key: k1_k2_x

我可以进行范围扫描以获取特定 k1 的所有 k2 条目，例如：scan "t1",{STARTROW=>"k1_"}

但是没有办法使用通配符并以某种方式获取特定 k2 的所有 k1 条目。我需要一个 map/reduce 作业或 Hive 或过滤器，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T19:32:23.573

1）将所有数据放在行键中非常好。HBase 旨在支持这样的用例。

2）如果您想在 k1 和 k2 上进行范围扫描（或“通配符扫描”），我建议将数据存储在两个表中，如下所示：

*   表 1：k1_k2_x
*   表2：k2_k1_x

这是重复的数据，但对于执行您想要的查询将非常有效。

这是与 HBase 的权衡之一：您获得了非常大的扩展能力，但失去了 RDBMS 功能，并且需要通过行键结构找出插入/查询的有效方法。

# django - Django ModelForm 验证

> ID：12806771
> 
> 赞同：9
> 
> 时间：2012-10-09T19:10:14.840
> 
> 标签：django, django-models, django-forms

现在正在尝试解决一个有趣的问题。

我有一个 Django 模型，其`image`字段不是必需的，但在创建新模型实例时设置为默认值。

```
class Product(models.Model):
    image = models.ImageField(upload_to='/image/directory/', default='/default/image/path/', blank=True) 
```

我还有一个基于该模型的 ModelForm，其中包括该`image`字段，并且具有一些自定义验证。

```
class ProductForm(forms.ModelForm):
    class Meta:
        model = Product
        fields = ('image',)

    def clean_image(self):
        image = self.cleaned_data.get('image', False)
        if image:
            # validate image
        return None 
```

问题是，[根据文档](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#the-is-valid-method-and-errors)`is_valid()`，除了表单验证之外，调用`ModelForm`触发器模型验证，因此当用户提交没有图像的模型表单时，我的自定义表单验证代码会尝试验证默认模型图像，而不是什么都不做正如它应该的那样。

除非表单本身具有该字段的值，否则我如何让它不做任何事情`image`？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-09T19:38:28.323

只是以非常简单的方式解决了它。在此处添加答案，以防对其他人有帮助。

[Django 文档指出](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#overriding-the-clean-method)

> ...绑定到模型对象的模型表单实例将包含一个`self.instance`属性，该属性使模型表单方法可以访问该特定模型实例。

因此`ModelForm`，我不检查是否有图像值，而是检查图像值是否已从保存的实例中更改。表单验证现在看起来像这样：

```
class ProductForm(forms.ModelForm):
    class Meta:
        model = Product
        fields = ('image',)

    def clean_image(self):
        image = self.cleaned_data.get('image', False)
        if not self.instance.image == image:
            # validate image
        return None 
```

问题解决了！

# objective-c - 如何从 iOS 中的 xml 中提取文档流？

> ID：12806785
> 
> 赞同：3
> 
> 时间：2012-10-09T19:10:53.473
> 
> 标签：objective-c, ios, uiwebview, xml-parsing

我收到一个 XML 作为 Web 服务的响应。此 xml 中的一个标签实际上包含 Web 服务作为流发送的文档的内容。如果我尝试在解析为 NSString 后提取文档，然后将其转换为 NSData 以加载到 webView 中，则 UIwebView 无法显示文档并引发错误：

```
EXCEPTION CPMessageException: (null) 
```

下面是我作为响应得到的 xml 示例（我无法提供确切的 xml，因为它是机密的）：

```
<?xml version="1.0" ?><S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/"><S:Body><content xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ns6:BinaryContent" pageModifier="" pageNumber="0" format="msw8"><ns6:renditionType>PRIMARY</ns6:renditionType><ns6:Value>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAACAAAAvAAAAAAAAAAAEAAAvwAAAAEAAAD+////AAAAALoAAAC7AAAA///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////spcEABYAJBAAA+BK/AAAAAAAAEAAAAAAACAAAT0oAAA4AYmpiahr3GvcAAAAAAAAAAAAAAAAAAAAAAAAJBBYAOFoAAHidAAB4nQAAQUIAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD//w8AAAAAAAAAAAD//w8AAAAAAAAAAAD//w8AAAAAAAAAAAAAAAAAAAAAALcAAAAAAO4bAAAAAAAA7hsAAGAoAAAAAAAAYCgAAAAAAABgKAAAAAAAAGAoAAAAAAAAYCgAABQAAAAAAAAAAAAAAP////8AAAAAdCgAAAAAAAB0KAAAAAAAAHQoAAA4AAAArCgAAAwAAAC4KAAANAAAAHQoAAAAAAAAyz4AAGYBAADsKAAAAAAAAOwoAAAAAAAA7CgAAAAAAADsKAAAAAAAAOwoAAAAAAAAHCsAAAAAAAAcKwAAAAAAABwrAAAAAAAASj4AAAIAAABMPgAAAAAAAEw+AAAAAAAATD4AAAAAAABMPgAAAAAAAEw+AAAAAAAATD4AACQAAAAxQAAAogIAANNCAABaAAAAcD4AABUAAAAAAAAAAAAAAAAAAAAAAAAAYCgAAAAAAAAcKwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcKwAAAAAAABwrAAAAAAAAHCsAAAAAAAAcKwAAAAAAAHA+AAAAAAAAAAAAAAAAAABgKAAAAAAAAGAoAAAAAAAA7CgAAAAAAAAAAAAAAAAAAOwoAAAwAgAAhT4AABYAAABaLAAAAAAAAFosAAAAAAAAWiwAAAAAAAAcKwAAygAAAGAoAAAAAAAA7CgAAAAAAABgKAAAAAAAAOwoAAAAAAAASj4AAAAAAAAAAAAAAAAAAFosAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHCsAAAAAAABKPgAAAAAAAAAAAAAAAAAAWiwAAAAAAABaLAAApgEAAJY7AACMAQAAAAAAA</ns6:Value></content></S:Body></S:Envelope> 
```

我需要提取`<ns6:Value>`，它实际上是一个文档的内容，并在 UIwebView 中显示它。我需要一些指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T19:47:30.077

终于找到了解决办法。基本上，流是以 base64 编码格式出现的。所以首先我需要解码这将为我提供正确的 NSData。使用任何 base 64 编码/解码库。

# .net - 使用 c# 和带有 itextsharp 的 asp.net 将 html 转换为 pdf

> ID：12806787
> 
> 赞同：-1
> 
> 时间：2012-10-09T19:10:56.693
> 
> 标签：.net

我正在使用面板控制中的一个静态表，如何将面板内的 html 内容转换为 pdf，请在单击按钮导出后立即帮助我转换为 pdf

Aspx 代码：-

```
<table width="100%">  
   <tr>
      <td>
          <asp:Panel ID="pnlPerson" runat="server">
            <table border="1" style="font-family: Arial; font-size: 10pt; width: 200px">
                <tr>
                    <td colspan="2" style="background-color: #18B5F0; height: 18px; color: White; border: 1px solid white">
                        <b>Personal Details</b>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>Name:</b>
                    </td>
                    <td>
                        <asp:Label ID="lblName" runat="server"></asp:Label>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>Age:</b>
                    </td>
                    <td>
                        <asp:Label ID="lblAge" runat="server"></asp:Label>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>City:</b>
                    </td>
                    <td>
                        <asp:Label ID="lblCity" runat="server"></asp:Label>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>Country:</b>
                    </td>
                    <td>
                        <asp:Label ID="lblCountry" runat="server"></asp:Label>
                    </td>
                </tr>
            </table>
          </asp:Panel>
        <asp:Button ID="btnExport" runat="server" Text="Export"  />
      </td>
  </tr>
</table> 
```

C#.net 代码：-

```
if (!IsPostBack)
{
    //Populate DataTable
    DataTable dt = new DataTable();
    dt.Columns.Add("Name");
    dt.Columns.Add("Age");
    dt.Columns.Add("City");
    dt.Columns.Add("Country");
    dt.Rows.Add();
    dt.Rows[0]["Name"] = "Mudassar Khan";
    dt.Rows[0]["Age"] = "27";
    dt.Rows[0]["City"] = "Mumbai";
    dt.Rows[0]["Country"] = "India";

    //Bind Datatable to Labels
    lblName.Text = dt.Rows[0]["Name"].ToString();
    lblAge.Text = dt.Rows[0]["Age"].ToString();
    lblCity.Text = dt.Rows[0]["City"].ToString();
    lblCountry.Text = dt.Rows[0]["Country"].ToString();
}

protected void btnExport_Click(object sender, EventArgs e)
{
} 
```

请务必向我发送此导出按钮的 C# 代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:17:01.017

这就是我所做的，它正在根据需要创建 pdf

```
protected void btnExport_Click(object sender, EventArgs e)
    {
        var document = new Document(PageSize.A4, 50, 50, 25, 25);
        var output = new FileStream(@"C:\Temp\PersonDetail.pdf", FileMode.Create);
        var writer = PdfWriter.GetInstance(document, output);
        document.Open();

        StringBuilder sb = new StringBuilder();
        StringWriter tw = new StringWriter(sb);
        HtmlTextWriter hw = new HtmlTextWriter(tw);
        pnlPerson.RenderControl(hw);
        var html = sb.ToString();
        var parsedHtmlElements = HTMLWorker.ParseToList(new StringReader(html), null);

        // Enumerate the elements, adding each one to the Document...
        foreach (var htmlElement in parsedHtmlElements)
            document.Add(htmlElement as IElement);

        document.Close();

    } 
```

[请在http://www.4guysfromrolla.com/articles/030911-1.aspx](http://www.4guysfromrolla.com/articles/030911-1.aspx)阅读 Scott Mitchell 的这篇精彩文章，然后决定什么最适合您。正如本文作者所建议的那样，解析 HTML 并将其添加到 PDF 中的支持有限，可能不适用于复杂的 HTML 结构。

让我知道它是否有帮助。

# php - PHP MYSQL 行选择

> ID：12806790
> 
> 赞同：-3
> 
> 时间：2012-10-09T19:11:13.887
> 
> 标签：php, mysql, database, row

```
$result = mysql_query("SELECT * FROM Persons");
while($row = mysql_fetch_array($result))
  {
  echo $row['FirstName'];
  echo $row['LastName'];
  } 
```

我想要一个 $i ++ 所以我得到 1 然后 2 依此类推，所以我可以这样：

```
$result = mysql_query("SELECT * FROM Persons");
while($row = mysql_fetch_array($result))
  {
if($i == 1){
<div>
  echo $row['FirstName'];
  echo $row['LastName'];
</div>
}
elseif($i == 2){
  echo $row['FirstName'];
  echo $row['LastName'];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:14:36.550

您不能将 PHP 和 HTML 代码随意放在一起。从PHP写出html内容。

**不正确**：

```
if($i == 1){
<div>
... 
```

**正确**：

```
if($i == 1){
echo "<div>";
... 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-09T19:13:47.710

您可以自己创建计数器变量，如下所示：

```
$result = mysql_query("SELECT * FROM Persons");
$i=0;
while($row = mysql_fetch_array($result))
  {
  $i++;
  if($i == 1){
  ...
  ...
  else if ($i == 2) {
  ...
  ... 
```

# linux - 每当我在 ubuntu 中打开手册页时，我都会看到此警告

> ID：12806792
> 
> 赞同：0
> 
> 时间：2012-10-09T19:11:23.653
> 
> 标签：linux, ubuntu, locale, manpage

当我键入与手册页相关的任何命令时，我会得到这个。

```
"man: can't set the locale; make sure $LC_* and $LANG are correct" 
```

请帮我解决一下这个。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:38:01.883

键入命令`locale -a`将显示系统上可用的语言环境。

键入命令`locale`将显示当前如何分配您的语言环境变量。

有关 Ubuntu 上区域设置的说明，请参阅[此 wiki 页面，包括如何正确设置它](https://help.ubuntu.com/community/Locale)

# c# - 数据绑定后如何隐藏gridview列？

> ID：12806794
> 
> 赞同：2
> 
> 时间：2012-10-09T19:11:29.300
> 
> 标签：c#, asp.net, gridview, sqldatasource

我使用以下链接中的解决方案隐藏我的列

[如何在 GridView 中隐藏 TemplateField 列](https://stackoverflow.com/questions/4954871/how-to-hide-a-templatefield-column-in-a-gridview)

但是，这会导致更新操作出现问题，因为 gridview 充当隐藏行具有空值。那么如何在数据绑定后隐藏列呢？

```
protected void begv_OrderDetail_RowCreated(object sender, GridViewRowEventArgs e)
{
    ((DataControlField)begv_OrderDetail.Columns.Cast<DataControlField>().Where(fld => fld.HeaderText == "FileNo").SingleOrDefault()).Visible = "False";
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-09T19:13:11.127

尝试这个，

```
grid1.Columns[columnIndex].Visible= false; 
```

*根据提问者的评论进行编辑，以获取隐藏列的值*

您可以使用隐藏字段来存储列值。本文的[**示例**](http://geekswithblogs.net/dotNETvinz/archive/2009/06/22/faq-how-to-get-hidden-columns-value-in-gridview.aspx)将帮助如何使用隐藏字段。

您可以将列的数据放在 datakeynames 中，然后再访问这些值，而不是隐藏列。这对于了解如何使用**[DataKeyNames](http://www.codeproject.com/Articles/23833/DataKeyNames)**很有用。通过这种方法，您可能需要从数据键名中传递 id 并获取记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:36:17.333

试试这个例子，（我不会说英语）

进入 RowDataBound ...

```
 protected void gvTeste_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            teste listaTeste = e.Row.DataItem as ListaTeste;

            if (listaTeste.ID == 0)
            {
                e.Row.Cells[2].Text = "Não Atribuido";
            }

            if (e.Row.Cells[7].Text == "01/01/0001" || e.Row.Cells[8].Text == "01/01/0001")
            {
                **e.Row.Visible = false;** // disable row
            }
        }
    } 
```

# android - 可绘制资源和文本颜色

> ID：12806795
> 
> 赞同：1
> 
> 时间：2012-10-09T19:11:45.563
> 
> 标签：android, styles

我`drawables`习惯于很好地设置按钮的样式，并且效果很好，除了按钮中的文本颜色。

我已经在 a 中定义了一个`state_enabled="false"`项目，`selector`并且 using`setEnabled`给了我正确的按钮样式，但是我必须跳过相当多的循环才能使文本颜色不同。例如，此代码不起作用（禁用时显示无文本或黑色文本，启用时显示深灰色）：

```
public void setButtonsEnabled(boolean enable) {
    btnAccept.setEnabled(enable);
    btnDecline.setEnabled(enable);

    int color = R.color.White;
    if (!enable) {
        color = R.color.DarkGray;
    }
    btnAccept.setTextColor(color);
    btnDecline.setTextColor(color);

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:37:53.807

我找到了解决方案。

关键在于还将 TextColor 设置为 a `selector`in `res/colors`：

```
 android:textColor="@color/button_text"
   android:background="@drawable/button_selector" 
```

对于背景选择器，我使用了这个：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<item  android:state_enabled="true" android:state_pressed="false" android:drawable="@drawable/btn_buddy_enabled"></item>
<item  android:state_enabled="false" android:drawable="@drawable/btn_buddy_disabled"></item>
<item  android:state_enabled="true" android:state_pressed="true" android:drawable="@drawable/btn_buddy_clicked"></item>
</selector> 
```

textColor 选择器是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<item  android:state_enabled="true" android:state_pressed="false" android:color="@color/White"></item>
<item  android:state_enabled="false" android:color="@color/Gray"></item>
<item  android:state_enabled="true" android:state_pressed="true" android:color="@color/White"></item>
</selector> 
```

简单地调用`setEnabled()`将使一切正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T19:25:33.893

您使用了错误的颜色值。R.color.White 返回值的资源 ID，而不是值本身。尝试 Color.WHITE 或 getResources().getColor(R.color.White)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:35:59.520

你检查了`ColorStateLists`吗？他们非常棒。所以基本上将所有这些`Drawable`选择器的想法应用于一组颜色。

创建一个名为**[Your Project]/res/colors/**的文件夹，然后在其中放置一个名为 button_color.xml（或其他任何内容）的 xml 文件。

**button_color.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<selector
    xmlns:android="http://schemas.android.com/apk/res/android"
>
    <!-- Any Enabled button, gets White Text -->
    <item
        android:color="@color/White"
        android:state_enabled="true" />

    <!-- Buttons with any other state, get DarkGray Text -->
    <item
        android:color="@color/DarkGray"/>
</selector> 
```

然后对于你的`TextView`，你可以做类似的事情，`mTextView.setTextColor(R.color.button_color);`那时不需要那种 if/else 类型的逻辑，`selector`它会为你做。选择器被汇总到颜色资源中，但它实际生成的类称为 a`ColorStateList`以防您发现它在其他文档中引用。

# ruby-on-rails - 在rails中创建数据时获取记录的id

> ID：12806798
> 
> 赞同：0
> 
> 时间：2012-10-09T19:11:52.180
> 
> 标签：ruby-on-rails, ruby, activerecord

在我的 Ruby on Rails 应用程序中，我正在创建一些数据并将其保存在 db 中，但现在我需要获取记录 id（保存时）。我需要获取此 id，并且对于此记录，在其他表中创建为此 id 绑定的记录数组（在模型中我有关联）。

```
 PriceList.create(:distributor_id => distributor_id, :brand => brand, :article_nr => num_catalog, :price => price, :quantity => quantity, :waittime => waittime)

class PriceList < ActiveRecord::Base
  has_many :cross_lists
  belongs_to :distributor
end

class CrossList < ActiveRecord::Base
  belongs_to :price_list
end 
```

它可以看作是两个问题，但主要是第一部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T20:31:04.800

最简单的方法是设置

```
class PriceList < ActiveRecord::Base
  has_many :cross_lists
  accept_nested_attributes_for :cross_lists # <- this line
  belongs_to :distributor
end 
```

然后在数组中传递 cross_lists 的数据。

```
PriceList.create(:distributor_id => distributor_id, 
                 :cross_lists_attributes => [
                   {...},
                   {...}
                 ]
                ) 
```

[http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html)

如果您手头没有关联的模型，也没有它们的属性，您可以在保存/创建主记录后即时创建它们。

```
@price_list = PriceList.create(...)
if @price_list.persisted?
  # now the @price_list object has an ID

  @price_list.cross_lists.create(...)
  # one CrossList record has been created, and its price_list_id
  # field has been automatically populated
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:21:13.580

为什么绑定到该 id 的记录数组不是您的价目表的集合？这样一来，一切都会自动完成，您无需担心。

```
class PriceList < ActiveRecord::Base

  ....
  has_many :records
end

class Record < ActiveRecord::Base

  belongs_to :price_list
end 
```

现在您可以执行以下操作：

```
PriceList.create(:distributor_id => distributor_id, ....., :records => [Record.new, Record.new]) 
```

这对您来说更容易，因为您不必担心分配 id 和添加事务。ActiveRecord 会为您处理这些。

但是要回答您的第一个问题：在记录存储在数据库中之前，您没有 id。因此，您可以使用代码获取 id：

```
rec = PriceList.create(:distributor_id => distributor_id, :brand => brand, :article_nr => num_catalog, :price => price, :quantity => quantity, :waittime => waittime)
rec.id #=> returns the id from db 
```

# android - 如何创建带有水平项目的菜单

> ID：12806800
> 
> 赞同：2
> 
> 时间：2012-10-09T19:11:55.977
> 
> 标签：android, menu

我在 android 中创建了一个菜单，当我单击模拟器中的菜单按钮时，我得到如下结果

这些物品垂直堆叠在一起，我怎样才能使它们水平放置

![菜单](../Images/a8b6bfc387a73642b93ddf0037073888.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:51:26.907

您可以在布局中使用 Horizo​​ntalScrollView 并将菜单项放入其中。一个例子是[here](https://stackoverflow.com/questions/5018155/horizontal-menu-with-horizontalscrollview-android)，[here](https://stackoverflow.com/questions/3832001/how-to-create-horizontal-menu-in-android)

# node.js - Socket.io 和 RedisStore - 简单示例不起作用 (event.js:66)

> ID：12806802
> 
> 赞同：0
> 
> 时间：2012-10-09T19:12:05.617
> 
> 标签：node.js, socket.io

我尝试运行这个例子：[http ://blog.rstack.cc/post/node_js__using_socket_io_with_cluster_module](http://blog.rstack.cc/post/node_js__using_socket_io_with_cluster_module)

安装了 node.js v0.8.8 和最新的 Socket.io (0.9.10)。但我得到这个错误： http: [//pastebin.com/VfzhxNZX](http://pastebin.com/VfzhxNZX)

node.js v0.8.11 错误在 event.js:68 中，而不是 node v0.8.8 时的 :66

有人知道为什么这个例子不能运行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T20:01:51.807

You need Redis installed on your machine. You can [download it here.](http://redis.io/download)

# php - PHP：自定义框架还是现有框架？

> ID：12806808
> 
> 赞同：3
> 
> 时间：2012-10-09T19:12:30.077
> 
> 标签：php, frameworks

我在一家公司工作，我们不断地建立需要表格的网站。我们对这些表单执行标准操作，例如验证、保存到数据库等。这些站点通常有一个身份验证页面，然后是几个内容页面，中间有表单。我应该编写自己的框架来完成这项工作，还是应该使用现有的框架。我的重点是减少重复编码的数量，或者可能想出一些大多数网站可以基于的起始模板。如果可能的话，我希望这是一个 MVC 解决方案和 OOP。你们有什么建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:18:44.523

只需从以下选项之一中选择：-)

```
Adroit
Adventure PHP Framework 
Agavi 
Akelos Framework 
Ambivalence
Amhulio
Andromeda Project
ash.MVC
Atomik Framework
ATK Framework 
Bedrock Framework
Blue Shoes Framework
CakePHP 
Castle-PHP
CIEXtended
CodeIgniter Framework 
CoughPHP 
DIY MVC
DooPHP
DragonPHP
evoCore 
eZ components 
FAT-FREE PHP
Flow3
Flourish
FuelPHP
FUSE MVC Framework 
Fusebox Framework 
Horde Application Framework 
InterJinn 
Ister
Jelix 
KISSMVC
Kimura Framework 
KohanaPHP 
Kolibri 
Konstrukt 
KumbiaPHP
Laravel
LightVC 
LightMVC
Limb3 
Lion framework
Lisa framework 
Lithium
Madeam PHP Framework 
Maintainable PHP Framework 
MagicPHP
Maverick PHP
mgframework
MiMVic
Noloh
NettePHP
Ocubed
Odin Assemble
Open Delight
OpenBiz 
Orinoco
P4A 
Php BURN
PHPCliFramework
PHP on TRAX 
PHPDevShell 
phpHtmlLib
PHOCOA 
PhpPeanuts 
PHPulse 
PHPWork
Pluf 
Prado Framework 
PSX Framework
Qcodo 
QCubed 
QPHP 
Recess!
Sapphire 
Seagull Framework 
SENCHA
Simplicity
SimplePHP
SOLAR Framework 
Sonic Framework
Sourdough
Spaghetti PHP
SpotLight
Stubbles 
Swat 
Symfony 
Tangra Framework 
Tigermouse 
TinyMVC 
TKSelf
VLC for PHP
Vork Enterprise PHP Framework
WACT
WasP
WEB2BB
Xajax 
Xataface 
Yii PHP Framework 
Yellow Duck Framework
Zephyr Framework
Zend Framework 
ZOOP Framework 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T19:16:18.427

First take a look at existing web frameworks, there's no need to reinvent the wheel. If none fits then try to write your own framework. Often custom frameworks are built upon existing ones, but sometimes the needs are so sophisticated they require a solution built from scratch.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:21:58.020

我不能足够推荐[Laravel](http://laravel.com/)。它很容易成为最伟大的框架之一。社区很棒，语法非常干净。Artisan CLI 也很棒。

试试看，你不会后悔的。

# mysql - mysql 压缩 order_by 值

> ID：12806813
> 
> 赞同：1
> 
> 时间：2012-10-09T19:12:41.773
> 
> 标签：mysql

我有一个包含 order_by 列的表，其中包含值 Ex：

```
4,10 ,20 ,80,500,625,712 
```

我想修改为：

```
1,2,3,4,5,6,7 
```

如果 80 的阶数为 4，则值为 4

我想做这样的事情：

```
UPDATE tablex SET order_by=ORDER_OF(order_by); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T19:14:11.887

```
set @rownum := 0;
UPDATE tablex as t
SET t.order_by = @rownum := @rownum + 1
order by t.order_by 
```

[SQLFiddle 示例](http://sqlfiddle.com/#!2/80ee3/3)

# c++ - 理解和解析来自 gcc 的警告

> ID：12806817
> 
> 赞同：3
> 
> 时间：2012-10-09T19:12:48.847
> 
> 标签：c++, gcc, emacs, makefile

从 Emacs 编译 .cpp 文件时`M-x compile`（运行文件夹的 Makefile），我在编译缓冲区中看到以下内容（以编译模式显示）：

> ```
> In file included from: /path/to/file1:60,
>   from /path/to/file2.h:15,
>   from /path/to/file3.cpp:16: 
> ```
> 
> `/path/to/file4.h:28:2:`#warning 此文件包含至少一个已弃用或过时的标头，将来可能会在不另行通知的情况下将其删除。请改用具有等效功能的非弃用接口。有关替换标头和接口的列表，请参阅文件`backward_warning.h`. 要禁用此警告，请使用`-Wno-deprecated`.

*   除了实际的警告消息之外，我应该如何理解这个跟踪？即哪个文件产生了警告？( `file1`, `file2`,`file3`或`file4`)?
*   另外，为什么行后有逗号，`file2`行后有冒号`file3`，行中`file4`包含两个用两个冒号分隔的数字？

我正在使用 Emacs`24.2.1`和`gcc-4.4.5-x86_64`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:28:37.827

实际触发警告的构造（`#warning`在本例中为预处理器指令）位于`file4`. 上面的东西是`#include`堆栈的痕迹，最里面但首先是一个：在这种情况下，`file3`包括`file2`，包括`file1`，包括`file4`。

当 gcc 知道触发诊断的构造的列号时，它会打印文件名、冒号、行号、另一个冒号和列号，正如您在该`file4`行中看到的那样。第一个数字是行号（28），第二个数字是列号（在这种情况下，您会发现`#`of`#warning`在第 2 列中）。当 gcc*不*知道列号时，它只打印文件名、冒号和行号。堆栈就是这种情况`#include`，因为它不需要记录确切的`#include`指令列。Emacs 的编译模式理解如何解析这两种语法：你会发现如果你使用`C-x  ``要翻阅诊断，当有可用的列号时，Emacs 会将光标放在相应的列上。

这些报告末尾的冒号和逗号只是为了符合英语标点符号的约定；他们没有任何意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T19:25:58.990

1.  警告是在 file4.h 的第 28 行生成的。

2.  逗号是因为您在列表的中间，冒号表示列表的结尾。这两个数字是行号和列号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T19:44:56.107

实际上显示它的编译路径说：

```
in column 2 of line 28 of file4.h
that included from file1.h(line 60)
that included from file2.h(line 15)
that included from file3.cpp(line 16)
there was a warning ... 
```

每个编译器都应该保持这个跟踪，它与 GCC 是否聪明或什么无关！！由于您的编译器仅编译`file3.cpp`，而其他所有文件仅作为包含在此文件中的结果进行解析。

# crystal-reports - Crystal Report 仅基于两个字段更改显示历史记录

> ID：12806818
> 
> 赞同：1
> 
> 时间：2012-10-09T19:12:51.720
> 
> 标签：crystal-reports, report

我正在尝试使用 history_table 编写报告。我想知道如果表中只有两个字段更改了 ex (ss.dem1) 和 (ss.dem2)，我将如何只带记录来显示历史记录 如果表中的电话或地址等其他任何变化也不要在报告中提出或压制它。我想查看只有这两个字段发生变化的数据，并且每次它都作为历史发生变化。
![在此处输入图像描述](../Images/77d94a87329d9143c4974e176c83cca6.png)

这将是我想要完成的一个例子。

我也曾经尝试使用抑制公式，但只给了我最后一条记录，并没有像上面那样向我展示我想要的例子

不是 onlastrecord 和 next(PATID)=PATID 和 next(ssdem1)=ssdem1 或不是 onlastrecord 和 next(PATID)=PATID 和 next(ssdem2)=ssdem2

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:35:28.533

在数据库方面，您可以进行自联接，并且只保留您感兴趣的项目之一发生更改的记录，例如：

```
select WHATEVER
from HISTORY H1, HISTORY H2
where H1.PAT_ID=H2.PAT_ID
 and (H1.DEM1 <> H2.DEM1
      or H1.DEM2 <> H2.DEM2
      etc...) 
```

或者，您可以按 PAT_ID 排序报告，然后按编辑的日期/时间排序，然后抑制没有任何变化的行，这听起来像您正在尝试做的事情。如果您发布确切的抑制公式，我可能会看到您哪里出错了。应该是这样的：

```
not(onfirstrecord) or
({TABLE.PAT_ID}=previous({TABLE.PAT_ID})
 and {TABLE.DEM1}=previous({TABLE.DEM1}) //check all fields you're concerned with for equality
 and {TABLE.DEM2=previous({TABLE.DEM2})
 and etc...) 
```

# google-analytics - 我可以使用 Google Analytics Premium 将超过 5 个自定义变量“附加”到同一个 _trackPageview 吗？

> ID：12806819
> 
> 赞同：2
> 
> 时间：2012-10-09T19:12:52.960
> 
> 标签：google-analytics

此行可以在[Google Analytics 自定义变量文档中找到](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCustomVariables)

> **您最多可以同时使用 5 个自定义变量用于单个请求（例如网页浏览或事件调用）。**在任何给定请求中，所有自定义变量的总和不能超过 5（即，您不能同时设置 5 个访问者和 5 个会话自定义变量）。

这是 javascript/beacon 的限制和/或 GA 在免费版本的 Google Analytics 中汇总事件的方式的限制吗？

用代码改写，如果我使用的是支付 GA Premium 的帐户，这会起作用吗？

```
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXX-X']);
_gaq.push(['_setCustomVar', 1, 'Foo', "Bar", 1]);
_gaq.push(['_setCustomVar', 2, 'Biz', "Baz", 2]);
_gaq.push(['_setCustomVar', 3, 'Ugg', "Bot", 3]);
_gaq.push(['_setCustomVar', 4, 'Big', "Bug", 1]);
_gaq.push(['_setCustomVar', 5, 'Sun', "Tin", 2]);
_gaq.push(['_setCustomVar', 6, 'Hor', "Ton", 3]);
_gaq.push(['_setCustomVar', 7, 'Saw', "Who", 1]);
_gaq.push(['_setCustomVar', 8, 'Dis', "Dat", 2]);
_gaq.push(['_setCustomVar', 9, 'Who', "Der", 3]);
_gaq.push(['_trackPageview']);
_gaq.push(["_trackEvent", "cat", "action", "lbl", 0, true]); 
```

或者我是否必须像这样构造上面的代码：

```
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXX-X']);
_gaq.push(['_setCustomVar', 1, 'Foo', "Bar", 1]);
_gaq.push(['_setCustomVar', 2, 'Biz', "Baz", 2]);
_gaq.push(['_setCustomVar', 3, 'Ugg', "Bot", 3]);
_gaq.push(['_setCustomVar', 4, 'Big', "Bug", 1]);
_gaq.push(['_setCustomVar', 5, 'Sun', "Tin", 2]);
_gaq.push(['_trackPageview']);
_gaq.push(['_setCustomVar', 6, 'Hor', "Ton", 3]);
_gaq.push(['_setCustomVar', 7, 'Saw', "Who", 1]);
_gaq.push(['_setCustomVar', 8, 'Dis', "Dat", 2]);
_gaq.push(['_setCustomVar', 9, 'Who', "Der", 3]);
_gaq.push(["_trackEvent", "cat", "action", "lbl", 0, true]); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T22:22:00.820

是的，您最多可以将 50 个自定义变量附加到 Google Analytics Premium。因此，应阅读针对 Google Analytics Premium 客户的声明：

> 您最多可以同时使用 50 个自定义变量以在单个请求中使用（例如网页浏览或事件调用）。在任何给定请求中，所有自定义变量的总和不能超过 50（即，您不能同时设置 50 个访问者和 50 个会话自定义变量）。

正确的做法是第一种

```
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXX-X']);
_gaq.push(['_setCustomVar', 1, 'Foo', "Bar", 1]);
_gaq.push(['_setCustomVar', 2, 'Biz', "Baz", 2]);
_gaq.push(['_setCustomVar', 3, 'Ugg', "Bot", 3]);
_gaq.push(['_setCustomVar', 4, 'Big', "Bug", 1]);
_gaq.push(['_setCustomVar', 5, 'Sun', "Tin", 2]);
_gaq.push(['_setCustomVar', 6, 'Hor', "Ton", 3]);
_gaq.push(['_setCustomVar', 7, 'Saw', "Who", 1]);
_gaq.push(['_setCustomVar', 8, 'Dis', "Dat", 2]);
_gaq.push(['_setCustomVar', 9, 'Who', "Der", 3]);
_gaq.push(['_trackPageview']);
_gaq.push(["_trackEvent", "cat", "action", "lbl", 0, true]); 
```

请注意，高级版和免费版的 javascript 代码是相同的。因此，如果您尝试在 Google Analytics（分析）免费版中执行此操作，它看起来会有效，但处理后端会忽略 5 以上的额外变量，除非您拥有 Google Analytics（分析）高级版。

有关 Google Analytics Premium 的更多信息

[http://www.google.com/analytics/premium/features.html](http://www.google.com/analytics/premium/features.html)

# xml - XPATH 2.0 的数据库支持

> ID：12806820
> 
> 赞同：2
> 
> 时间：2012-10-09T19:12:55.643
> 
> 标签：xml, xpath, nosql, relational-database

我正在寻找可以支持 xpath 2.0 表达式的开源解决方案。我认为这将是一个关系数据库，或者可能是一个像 lucene 这样的索引工具。似乎 postgres 的 xpath() 函数只支持 xpath 1.0。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T14:37:04.947

您可能对**[PsychoPath](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&frm=1&source=web&cd=3&cad=rja&ved=0CDYQFjAC&url=http://psychopath.sourceforge.net/report.pdf&ei=9Id1UJjFN6jkiwKpg4HoCw&usg=AFQjCNHLhTrA-Nl6RYzr1yRg2OZEt-rmrw&sig2=RrTPtZevrx5NLZbdN8NaEg)**感兴趣：

> **1.3 提案**
> 
> PsychoPath 项目的目标是开发一个功能齐全的 XPath 2.0 处理器，该处理器支持 XML Schema，易于扩展，并可作为开源项目免费使用。

**[Saxon](http://www.saxonica.com) 9.x（最高 9.1.07 - 非模式感知版本）在[源代码](http://sourceforge.net/projects/saxon/files/Saxon-B/9.1.0.8/)**中也可用：

**[http://sourceforge.net/projects/saxon/files/Saxon-B/9.1.0.8/](http://sourceforge.net/projects/saxon/files/Saxon-B/9.1.0.8/)**

# php - Google 服务帐户 - Google Analytics API v3

> ID：12806823
> 
> 赞同：0
> 
> 时间：2012-10-09T19:13:04.410
> 
> 标签：php, google-analytics, google-analytics-api

我正在尝试开发一个应用程序，该应用程序每晚向我的 Google 分析配置文件执行服务器端请求。我看到一些过时的帖子说 PHP 的 API 库不支持 Google 分析的服务帐户。

我遵循了这些说明（编辑后的答案）：

[服务应用程序和 Google Analytics API V3：服务器到服务器 OAuth2 身份验证？](https://stackoverflow.com/questions/9863509/service-applications-and-google-analytics-api-v3-server-to-server-oauth2-authen)

当我运行代码时，我收到一个连接重置错误，在我的测试服务器上，我得到一个 500 内部。

错误发生在上面答案的这一部分。

```
 $service->data_ga->get($ids, $startDate, $endDate, $metrics, $optParams); 
```

私钥的路径是正确的，我在 5.3.8 上运行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T14:23:05.583

连接重置和 500 个内部错误听起来与您在上面发布的代码没有任何关系。听起来更像是与 Google Analytics 的连接以某种方式中断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-14T12:08:39.510

我猜凭据或服务帐户的设置方式有问题。首先确保您已启用错误报告：

```
ini_set('display_errors', 1);
ini_set('display_startup_errors', 1);
error_reporting(E_ALL); 
```

发布您使用上述设置收到的完整错误消息，我们将从那里获取。

# windows - 处理多种键盘布局（OSX 与 Windows）

> ID：12806825
> 
> 赞同：1
> 
> 时间：2012-10-09T19:13:10.997
> 
> 标签：windows, macos, virtual-machine, keyboard-layout

我有两台电脑；一台 MacBook Pro 和一台运行 Windows 的台式电脑。出于各种原因，我更喜欢在 MacBook 上编写代码，而我将台式 PC 主要用于游戏和娱乐目的。

由于我已经习惯了在 OSX 键盘布局上编程，所以我经常发现在我的 Windows 计算机上开始工作很麻烦。而且由于我非常懒惰，所以我也觉得从包里拿出笔记本电脑很麻烦，所以我可以改用它。这通常会导致我在桌面上时不必费心做很多工作（这在我的大部分晚上都是令人沮丧的）。

我想我正在寻找一种在 Windows 中快速启用 OSX 键盘布局的方法。我还想在 Windows 上的虚拟机中运行 Ubuntu，并在那里使用 OSX 键盘。

可能的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-11T20:06:26.520

您可以使用[Microsoft Keyboard Layout Creator](http://msdn.microsoft.com/en-us/goglobal/bb964665.aspx)在 Windows 上创建与 Mac OS 相同的自定义键盘布局。

Ubuntu 有一个无限灵活且极其复杂的键盘布局系统，称为 XKB，它的[文档](http://ftp.x.org/pub/X11R7.0/doc/PDF/)[有限](http://www.charvolant.org/~doug/xkb/html/index.html) 。Ubuntu 可能已经拥有你想要存储在数百个文件中的 Mac 键盘布局的所有数据，但是弄清楚如何加载它会让你发疯。你可能有幸在[Ask Ubuntu](https://askubuntu.com/)或[Unix stack exchange](https://unix.stackexchange.com/)上问到这个问题。`/usr/share/X11/xkb/`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T19:32:37.733

您可以在 PC 和 Mac 上使用 Mac 键盘查看[Synergy 。](http://synergy-foss.org/)

# mysql - MySql SELECT 子查询 JOIN

> ID：12806826
> 
> 赞同：0
> 
> 时间：2012-10-09T19:13:11.547
> 
> 标签：mysql, select, join, subquery

我正在尝试`SELECT`在所有一个查询中执行所有这些语句，因此我将能够对其进行进一步处理并将其分组。我相信我必须`JOIN`在 TABLE1 上告诉它。我可以告诉你，它应该在名为`ITEM`. 我已经尝试了几十个 JOIN 语句，但没有一个可以解决问题，因为我`WHERE`的子查询中有两个语句。

```
SELECT ITEM, DSI, LEADTIME,
(SELECT COUNT(ORDER_NUMBER) FROM SUBTABLE1 TR1 WHERE TRANS_DATE BETWEEN DATE_SUB(curdate(), INTERVAL 730 DAY) AND DATE_SUB(curdate(), INTERVAL 365 DAY))
as OLDORDERS,
(SELECT COUNT(ORDER_NUMBER) FROM SUBTABLE2 TR2 WHERE TRANS_DATE BETWEEN DATE_SUB(curdate(), INTERVAL 364 DAY) AND curdate())
as NEWORDERS
FROM TABLE1 
```

显示：

```
ITEM   |  DSI  |  LEADTIME  | OLDORDERS | NEWORDERS
PROD-1    0         1          16036      38399
PROD-2    1         0          16036      38399
PROD-3    1         1          16036      38399 
```

再次......我相信我需要它到子查询`JOIN`的字段`ITEM`，但我不知道该怎么做，有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:22:43.753

您实际上并不需要`JOIN`,*本身*; 相反，您需要“关联”您的子查询，以便它们引用包含查询中的数据。

您还没有给出确切的表定义，所以我不能肯定地说，但这是我对您需要的猜测：

```
SELECT item, dsi, leadtime,
       ( SELECT COUNT(order_number)
           FROM subtable1
          WHERE trans_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 730 DAY)
                               AND DATE_SUB(CURDATE(), INTERVAL 365 DAY)
                -- restrict to "current" record from TABLE1:
            AND subtable1.item = table1.item
       ) as OLDORDERS,
       ( SELECT COUNT(order_number)
           FROM subtable1
          WHERE trans_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 364 DAY)
                               AND CURDATE()
                -- restrict to "current" record from table1:
            AND subtable1.item = table1.item
       ) as NEWORDERS
  FROM table1
; 
```

假设那`table1.item`是主键，那`subtable1.item`是引用它的外键。当然，如果不是这种情况，您将不得不调整查询。

# bash - 如何将目录中最新文件中的文件名放入变量中

> ID：12806828
> 
> 赞同：1
> 
> 时间：2012-10-09T19:13:16.600
> 
> 标签：bash, shell, variables, ls

我正在制作一个脚本。我需要自动化查看目录中名称中包含字符串“HNAZXLCOM”的所有文件的部分，然后获取名称中包含该字符串的最新文件并将文件名放入变量中。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T22:33:10.137

```
function latest {
    if [[ $FUNCNAME == ${FUNCNAME[1]} ]]; then
        unset -v x latest files
        printf -v "$@"
    elif (($# > 2)); then
        printf '%s\n' "Usage: $FUNCNAME <glob> <varname>" 'Error: Takes at most 2 arguments. Glob defaults to *'
        return 1
    else
        if ! shopt -q nullglob; then
            typeset -f +t "$FUNCNAME"
            trap 'shopt -u nullglob; trap - RETURN' RETURN
            shopt -s nullglob
        fi

        IFS= typeset -a 'files=(${1:-*})'
        typeset latest x

        for x in "${files[@]}"; do
            [[ -d $x || $x -ot $latest ]] || latest=$x
        done

        ${2:+"$FUNCNAME"} "${2:-printf}" -- %s "$latest"
    fi
}

latest '*HNAZXLCOM*' myVar 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:15:27.850

如果我没看错

```
var="$(ls -t1 *HNAZXLCOM*|head -n 1)" 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-09T19:23:07.123

在 man ls 中，-t 开关是相关的。另请参阅 -1 开关。

```
-t     sort by modification time, newest first  
-1     list one file per line 
```

-1 开关不相关，因为`ls`当输出到管道时，每个名称自动只写入一行。

在命令提示符下，以下函数将列出 13 个最近的文件；例如，`xt *HNAZXLCOM*`将列出名称中包含该字符串的 13 个最新文件，而`xt`其本身将列出当前工作目录中的最新文件（任何模式）。将数字调整为您喜欢的任何值。某些版本的 head 可能需要`-n 13`而不是`-13`. 在你的应用中，
`H=$(ls -t *HNAZXLCOM* | head -n 1)`
是合适的。

```
xt () 
{ 
    date;
    ls --color -Glt --color --time-style="+%Y-%m-%d %T" $* | grep -v "/" | head -13
} 
```

# c - 网络摄像头检测到的图像的最高强度点的坐标

> ID：12806833
> 
> 赞同：-1
> 
> 时间：2012-10-09T19:13:25.053
> 
> 标签：c, windows, blob, webcam, tracking

> **可能重复：**
> [返回从网络摄像头抓取的图像的最大强度点坐标的函数](https://stackoverflow.com/questions/12550215/function-to-return-coordinates-of-the-maximum-intensity-point-of-the-image-grabb)

我想获取网络摄像头拍摄的图像中最高强度点的坐标。我正在使用 opencv.Image 正在使用 cvCapFromCAM() 捕获。我正在使用 Windows 7，并且正在使用 C 编程语言进行编程。

我不知道编译器如何处理 blob 的“强度”。我要做的就是跟踪一个红色的 LED，它的强度比图像中存在的任何其他东西都大。作为回报，我想获得检测到的 LED 的 x 和 y 坐标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:15:37.393

好吧，您将获得一个介于 0 和 255 之间的整数作为整数或 0.0f 和 1.0f 作为浮点/双精度表示 RGB 颜色混合的每个部分（可能）。您只需要查看每个像素并找出哪个像素的 R 分量值最接近 255 / 1.0f。

# linux - 语法检查。分组两个 if 语句

> ID：12806839
> 
> 赞同：1
> 
> 时间：2012-10-09T19:13:54.663
> 
> 标签：linux, bash, shell

```
if [ $DISTRO = "REDHAT"] || [ $DISTRO = "FEDORA"]; then 
    if ! rpm -qa | grep -q glibc-static; then
        $BIN_ECHO -e " Package [glibc-static] not found. Installing.. "
        yum install glibc-static
    elif
        $BIN_ECHO -e " All required packages installed.. "
    fi
elif [ $DISTRO = "DEBIAN"]; then 
    if ! dpkg-query -l glibc; then
        $BIN_ECHO -e " Package [glibc] not found. Installing.. "
        apt-get install glibc
    elif
        $BIN_ECHO -e " All required packages installed.. "
    fi
fi 
```

第 156 行：意外标记“fi”附近的语法错误

如何将这两个语句放在一起？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:15:04.880

`]`在每次测试的决赛之前，您必须有一个空格。

例如：

```
if [ $DISTRO = "REDHAT"] || [ $DISTRO = "FEDORA"]; then 
```

必须重写为：

```
 if [ "$DISTRO" = REDHAT ] || [ "$DISTRO" = FEDORA ]; then 
```

或者

```
if test "$DISTRO" = REDHAT || test "$DISTRO" = FEDORA; then 
```

另请注意，没有理由引用文字字符串，但您应该引用变量。

你也可以这样做：

```
if test "$DISTRO" = REDHAT -o "$DISTRO" = FEDORA; then 
```

或者

```
case "$DISTRO" in
REDHAT|FEDORA) ... ;;
DEBIAN) ... ;;
esac 
```

# php - 在 xhr.send(file) 之后评估 ajax-upload 损坏的脚本 - 有时有效，有时无效

> ID：12806840
> 
> 赞同：0
> 
> 时间：2012-10-09T19:13:59.210
> 
> 标签：php, jquery, fine-uploader, valums-file-uploader

我在一天中的大部分时间都在寻找解决方案，但我仍然一无所知。对于我的一个客户，我创建了一个简单的网络画廊来上传图片，我正在使用[valums file uploader](https://github.com/valums/file-uploader)。到目前为止，我在创建的任何其他站点上都没有遇到任何问题，除了我前段时间解决的配置错误。

那么，问题是什么？

当我上传文件大小低于 260KB 的图像时，它可以正常工作。但是，当我上传更大的图像时，它不会让我返回任何错误。我只是得到一个空的缩略图，因为图像没有上传。

当我打开 Chrome 控制台时，我看到的是：

> ```
> POST http://designflowstudio.com/gallery2/include/upload.php?url=uploads%2Fe558c4dfc2a0f0d60f5ebff474c97ffc&fid=7&qqfile=316267269718409738080100.jpg 403 (Forbidden) fileuploader.js:1463
> POST http://designflowstudio.com/gallery2/include/upload.php?url=uploads%2Fe558c4dfc2a0f0d60f5ebff474c97ffc&fid=7&qqfile=3.jpg 403 (Forbidden) fileuploader.js:1463 
> ```

在某些情况下，我收到 413 错误“请求实体太大”。

让我说这个问题真的让我很恼火**，因为该脚本在我的本地 Web 服务器 (apache) 和我的 Web 服务器上运行良好**。在这里，我可以上传尽可能大的图片，但在客户端的网络服务器上......

如果有人有时间并且愿意帮助我，这里是我用来调用值上传器的 JavaScript：

```
 function createUploader(){
 var uploader = new qq.FileUploaderBasic({
  debug: true,
  multiple: true,
  allowedExtensions: [<?php $tmp=".";foreach($allowedExt as $ext){$tmp.="'$ext', ";}echo substr($tmp,1,strlen($tmp)-3);?>],
  button: document.getElementById('uploadDiv'),
  action: '<?php echo$home;?>include/upload.php',
  sizeLimit: <?php echo$sizeLimit;?>,
  forceMultipart: true,
  params: {'url':'uploads/<?php echo$g['path'];?>','fid':'<?php echo$g['id'];?>'},
  onSubmit: function(id, fName){$('#upload-list').append('<div id="upload-list-'+id+'" class="gallery" rel="'+fName+'"><div class="progress'+id+'"></div>');$('.progress'+id).progressbar({value:0})},
  onProgress: function(id, fName, loaded, total){
   var p = 0;
   p = parseFloat(loaded/total*100);
   if(isNaN(p)) p = '';
   $('.progress'+id).progressbar("option","value",p);
  },
  onComplete: function(id,fName,json){
   if(json.error){
    $('#upload-list-'+id).html(fName+'<br />'+json.error);
   }else{
    $('#upload-list-'+id)
     .attr("rel",json.fname)
     .html('<img class="cmd" id="deleteImg" rel="'+json.id+'" src="<?php echo$home;?>images/delete.png" title="Delete picture" /><img class="img" src="<?php echo$home;?>uploads/<?php echo$g['path'];?>/th_'+json.fname+'" /><input class="ut" type="text" name="name" value="'+json.name+'" /><input class="ud" type="text" name="desc" /><div class="cl"></div>')
     .attr("id",json.id);
   }
  },
  onError: function(id,fName,error){
   console.log(id+' '+fName+' '+error);
  }
 });
}
window.onload = createUploader; 
```

这是我用于服务器处理文件的 PHP：

```
require("config.php");
require("SimpleImage.php");
ini_set("log_errors" , "1");
ini_set("error_log" , "php-errors-upload.log");
ini_set("display_errors" , "1");
/**
 * Handle file uploads via XMLHttpRequest
 */
class qqUploadedFileXhr {
    /**
     * Save the file to the specified path
     * @return boolean TRUE on success
     */
    function save($path) {
        $input = fopen("php://input", "r");
        $temp = tmpfile();
        $realSize = stream_copy_to_stream($input, $temp);
        fclose($input);

        if ($realSize != $this->getSize()){
            return false;
        }

        $target = fopen($path, "w");
        fseek($temp, 0, SEEK_SET);
        stream_copy_to_stream($temp, $target);
        fclose($target);

        return true;
    }
    function getName() {
        return $_GET['qqfile'];
    }
    function getSize() {
        if (isset($_SERVER["CONTENT_LENGTH"])){
            return (int)$_SERVER["CONTENT_LENGTH"];            
        } else {
            throw new Exception('Getting content length is not supported.');
        }
    }   
}

/**
 * Handle file uploads via regular form post (uses the $_FILES array)
 */
class qqUploadedFileForm {
    /**
     * Save the file to the specified path
     * @return boolean TRUE on success
     */
    function save($path) {
        if(!move_uploaded_file($_FILES['qqfile']['tmp_name'], $path)){
            return false;
        }
        return true;
    }
    function getName() {
        return $_FILES['qqfile']['name'];
    }
    function getSize() {
        return $_FILES['qqfile']['size'];
    }
}

class qqFileUploader {
    private $allowedExtensions = array();
    private $sizeLimit = 20485760;
    private $file;

    function __construct(array $allowedExtensions = array(), $sizeLimit = 20485760){
        $allowedExtensions = array_map("strtolower", $allowedExtensions);

        $this->allowedExtensions = $allowedExtensions;        
        $this->sizeLimit = $sizeLimit;

        $this->checkServerSettings();

        if (isset($_GET['qqfile'])) {
            $this->file = new qqUploadedFileXhr();
        } elseif (isset($_FILES['qqfile'])) {
            $this->file = new qqUploadedFileForm();
        } else {
            $this->file = false;
        }
    }

    private function checkServerSettings(){        
        $postSize = $this->toBytes(ini_get('post_max_size'));
        $uploadSize = $this->toBytes(ini_get('upload_max_filesize'));

        if ($postSize < $this->sizeLimit || $uploadSize < $this->sizeLimit){
            $size = max(1, $this->sizeLimit / 1024 / 1024) . 'M';             
            die("{'error':'increase post_max_size and upload_max_filesize to $size'}");    
        }        
    }

    private function toBytes($str){
        $val = trim($str);
        $last = strtolower($str[strlen($str)-1]);
        switch($last) {
            case 'g': $val *= 1024;
            case 'm': $val *= 1024;
            case 'k': $val *= 1024;        
        }
        return $val;
    }

    /**
     * Returns array('success'=>true) or array('error'=>'error message')
     */
    function handleUpload($uploadDirectory, $replaceOldFile = FALSE){
        chdir("../");
        if(!file_exists($uploadDirectory)){
          foreach(explode("/",$uploadDirectory) as $val){
            if(empty($val2)){$val2=$val."/";}else{$val2.=$val."/";}
            if($val<>""){if(!file_exists($val2)){mkdir($val2);}}
          }
        }

        if (!is_writable($uploadDirectory)){
            return array('error' => "Server error. Upload directory isn't writable.");
        }

        if (!$this->file){
            return array('error' => 'No files were uploaded.');
        }

        $size = $this->file->getSize();

        if ($size == 0) {
            return array('error' => 'File is empty');
        }

        if ($size > $this->sizeLimit) {
            return array('error' => 'File is too large');
        }

        $pathinfo = pathinfo($this->file->getName());
        $filename = md5($pathinfo['filename'].mt_rand());
        //$filename = md5(uniqid());
        $ext = strtolower($pathinfo['extension']);

        if($this->allowedExtensions && !in_array(strtolower($ext), $this->allowedExtensions)){
            $these = implode(', ', $this->allowedExtensions);
            return array('error' => 'File has an invalid extension, it should be one of '. $these . '.');
        }

        if(!$replaceOldFile){
            /// don't overwrite previous files that were uploaded
            while (file_exists($uploadDirectory . $filename . '.' . $ext)) {
                $filename .= rand(10, 99);
            }
        }
        if ($this->file->save($uploadDirectory .'/'. $filename . '.' . $ext)){
            global $sql_images;
            $md=md5($filename);
            $tmp=mysql_query("SELECT `order` FROM `$sql_images` WHERE `gid`='{$_REQUEST['fid']}' ORDER BY `order` DESC");
            if($tmp&&mysql_num_rows($tmp)>0){$i=mysql_result($tmp,0);$i++;}else{$i=0;}
            mysql_query("INSERT INTO `$sql_images` (`order`,`gid`,`name`,`path`) VALUES ('$i','{$_REQUEST['fid']}','{$pathinfo['filename']}','$filename.$ext')");
            $image = new SimpleImage();
            $image->load($uploadDirectory.'/'.$filename.'.'.$ext);
            $image->resizeToWidth(150);
            $image->save($uploadDirectory.'/th_'.$filename.'.'.$ext);
            return array('success'=>true,'fname'=>$filename.".".$ext,'name'=>$pathinfo['filename'],'id'=>mysql_insert_id());
        } else {
            return array('error'=> 'Could not save uploaded file.' .
                'The upload was cancelled, or server error encountered');
        }
    }
}

// list of valid extensions, ex. array("jpeg", "xml", "bmp")
$allowedExtensions = array();
// max file size in bytes
$sizeLimit = 20*1024*1024;

$uploader = new qqFileUploader($allowedExtensions, $sizeLimit);
$result = $uploader->handleUpload($_REQUEST['url']);
// to pass data through iframe you will need to encode all html tags
echo htmlspecialchars(json_encode($result), ENT_NOQUOTES); 
```

让我再说一遍，所有对 MySQL 的调用，带有 require() 的文件都是有效的。这些脚本可以在另外两台服务器上运行，但在这台服务器上不行。

感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T13:51:20.957

You have some configuration issues on your server if it is choking due to the content-type header. Instead of commenting out this line, to work around this messed up server, you should perhaps try to set the forceMultipart option to true, assuming your server can handle multipart-encoded requests correctly. This all assumes you are using the 2.1-SNAPSHOT version of the uploader, as the option I mentioned first appeared in this version.

# c# - Web 部件上的一个小问题，sharepoint

> ID：12806844
> 
> 赞同：-1
> 
> 时间：2012-10-09T19:14:36.207
> 
> 标签：c#, asp.net, .net, sharepoint, sharepoint-2010

我创建了一个空的 Web 部件，然后在 UserControl.ascx.cs 中创建了一个用户控件，我这样写：

```
namespace tasks_email.ControlTemplates.tasks_email
{
    public partial class UserControl1 : UserControl
    {

        public tasks_email WebPart { get; set; }
        protected void Page_Load(object sender, EventArgs e)
        { 
```

然后它说：“tasks_email.Controltemplates.tasks_email”是一个“名称空间”，但用作“类型”

任何人都可以告诉我问题出在哪里并给我一些建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T20:23:48.783

```
namespace tasks_email.ControlTemplates.tasks_email 
```

在这里，您将 tasks_email 声明为命名空间。

```
public tasks_email WebPart { get; set; } 
```

在这里，您声明了一个名为 WebPart 的成员，其类型为 tasks_email。那不是一个类型——你已经说过它是一个命名空间。我猜不出你的真正意思。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:39:19.183

如果您想创建一个其中包含用户控件的 Web 部件，您可以使用 Visual Studio 中的“Visual Web 部件”模板。它将创建一个 webpart 和一个用户控件，并为您将用户控件添加到 webpart 中，甚至将整个东西打包到解决方案资源管理器中的一个可折叠组件中。这很方便。自己做所有这些工作（对于每个新的 Web 部件）只是一种痛苦。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-09T19:17:08.827

您是否尝试过“命名空间 tasks_email.ControlTemplates”？因为你这样做的方式，你确实像使用类型一样使用 tasks_email ；而不是作为命名空间

# android - 如果我知道与之配对的值，是否可以从 SharedPreferences 文件中获取“键”值？

> ID：12806853
> 
> 赞同：0
> 
> 时间：2012-10-09T19:15:10.123
> 
> 标签：android, sharedpreferences, key-value, android-alertdialog

> **可能重复：**
> [如果知道关联的值，我可以从 SharedPreferences 获取密钥吗？](https://stackoverflow.com/questions/12713321/can-i-get-the-key-from-sharedpreferences-if-a-know-the-associated-value)

下面的代码用于从 SharedPreferences 文件填充 AlertDialog 并按值按字母顺序对其进行排序。

当用户单击 AlertDialog 列表中的选项时，它会启动

```
 setServer(prefsCharSequence[i]); 
```

prefsCharSequence[i] 返回所选选项的值。

**我想为那个值使用“键”**。给定我当前的代码，我该如何获得这个？现在我知道我希望它是一个简单的“prefsCharSequence[i].getKey()”或类似的值。

```
public void openServerDialog() {

        final SharedPreferences myPrefs = this.getSharedPreferences("FileName", MODE_PRIVATE);
        TreeMap<String, ?> keys = new TreeMap<String, Object>(myPrefs.getAll());
        for (Map.Entry<String, ?> entry : keys.entrySet()) {
            Log.i("map values", entry.getKey());
            //some code
        }

      List<Pair<Object, String>> sortedByValue = new LinkedList<Pair<Object,String>>();
        for (Map.Entry<String, ?> entry : keys.entrySet()) {
            Pair<Object, String> e = new Pair<Object, String>(entry.getValue(), entry.getKey());
            sortedByValue.add(e);
        }

     // Pair doesn't have a comparator, so you're going to need to write one.
        Collections.sort(sortedByValue, new Comparator<Pair<Object, String>>() {
            public int compare(Pair<Object, String> lhs, Pair<Object, String> rhs) {

                String sls = String.valueOf(lhs.first);
                String srs = String.valueOf(rhs.first);
                int res = sls.compareTo(srs);
                // Sort on value first, key second
                return res == 0 ? lhs.second.compareTo(rhs.second) : res;
            }
        });

        for (Pair<Object, String> pair : sortedByValue) {
            Log.i("map values", pair.first + "/" + pair.second);
        }

      Collection<?> stringArrayList = keys.values();
      final CharSequence[] prefsCharSequence = stringArrayList.toArray(new CharSequence[stringArrayList.size()]);

        new AlertDialog.Builder(this)   
        .setTitle(R.string.server_title)
        .setItems(prefsCharSequence, 
        new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialoginterface, int i) {

                setServer(prefsCharSequence[i]);   

            }
        })
        .show();
    } 
```

我正在尝试迭代并获取我拥有的价值的关键，到目前为止我有这个但不知道下一步该去哪里：

```
CharSequence server = i;
        SharedPreferences myPrefs = this.getSharedPreferences("FileName", MODE_PRIVATE);
        Map<String, ?> items = myPrefs.getAll();
        for(String s : items.keySet()){

        } 
```

i 等于我想要的键的值，这个方向是否正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:39:14.603

如果我正确理解您的问题， prefsCharSequence 是您的 SharedPreferences 对象中的值数组。如果是这样的话，为什么不从首选项中保留一组键呢？该值将是 prefsCharSequence[i]，而键将类似于 prefsCharSequenceKeys[i]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T20:34:43.390

正如 Tim 所建议的，您可以参考类的[getAll()](http://developer.android.com/reference/android/content/SharedPreferences.html#getAll%28%29)函数`SharedPreferences`。

这将返回您的`Map<String,?>`对象，您可以使用类的`keySet()`函数`Map`来获取 keySet 并使用`foreach`Java 的循环进行迭代。

希望这可以帮助。

# facebook - Facebook - 对象调试器 - 解析 URL 时出错

> ID：12806855
> 
> 赞同：0
> 
> 时间：2012-10-09T19:15:15.270
> 
> 标签：facebook, facebook-opengraph

对于此 URL，我从 lint 工具收到以下消息 -

解析 URL 时出错 解析输入 URL 时出错，没有数据被抓取。

网址... [http://apps.facebook.com/mischiefshoes/?entry_id=201012](http://apps.facebook.com/mischiefshoes/?entry_id=201012)

画布框架的完整链接... [https://www.mischiefshoes.co.nz/facebook/competition/?entry_id=201012](https://www.mischiefshoes.co.nz/facebook/competition/?entry_id=201012)

当要发布打开图形操作时，会记录此错误...

OAuthException: (#3502) URL [http://apps.facebook.com/mischiefshoes/?entry_id=201012](http://apps.facebook.com/mischiefshoes/?entry_id=201012)的对象具有 og:type 的“网站”。属性 'shoe' 需要 og:type 'mischiefshoes:shoe' 的对象。

然而我的 og 元标记如下：

```
 <meta property="og:title" content="Michael R. J. Crosbie's favourite shoe"/> 
    <meta property="og:description" content="Michael R. J. Crosbie's favourite shoe in the mischief shoes instashoe competition. Win $2000 worth of shoes every month - upload your own today!"/>
    <meta property="og:image" content="https://www.mischiefshoes.co.nz/media/client/resources/instashoe/201012/237x_scale/Ciara_Misfits.jpg"/>
    <meta property="og:site_name" content="MISCHIEF SHOES • WIN FREE SHOES"/>
    <meta property="fb:app_id" content="256092351106970"/>
    <meta property="og:type" content="mischiefshoes:shoe" /> 
```

任何帮助将非常感激！干杯，迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T20:31:12.617

这似乎是一个响应时间问题。当我在 Chrome 中查看您的页面或使用[第三方速度测试](http://tools.pingdom.com/fpt/#!/Nq1mNrUxp/https://www.mischiefshoes.co.nz/facebook/competition/?entry_id=201012)时，我必须等待超过 11 秒才能让您的服务器响应。

Facebook 的服务器可能在您的服务器响应之前超时。

# php - Symfony 2，表单和 jQuery 更改提交

> ID：12806861
> 
> 赞同：0
> 
> 时间：2012-10-09T19:15:31.230
> 
> 标签：php, forms, symfony, routes

我想创建带有自动提交的表单，所以我使用了 jquery。我认为我的翻译网址有问题。

我的表格：

```
<form action="edit" method="get" >
    <select name="id" onchange="this.form.submit();">
        {% for panel in panele %}
        <option value="{{ panel.setting.id }}">{{ panel.nazwa }}</option>
        {% endfor %}
    </select>
</form> 
```

当我想更改选项时，我会在 url " `edit?id={id}`" 中得到它，当我尝试在控制器（路由）中使用它时。

```
@Route("/edit?id={id}") 
```

我收到错误：

> 找不到“GET /settings/edit”的路线

（`/settings`是控制器的全局路由）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T05:51:34.220

您的`action attribute`表单没有 URL。您应该使用树枝路径表达式生成 url。

```
<form action="{{ path('edit_route') }}" method="get" > 
```

将路线标识符替换`edit_route`为您的路线名称。**此外，清除浏览器和 symfony 缓存。**

# c# - 没有图像的 ASP.NET ImageButton

> ID：12806862
> 
> 赞同：0
> 
> 时间：2012-10-09T19:15:31.323
> 
> 标签：c#, asp.net, html, imagebutton

我正在用 ASP.NET 构建一个简单的基于 HTML 的国际象棋游戏。

我的棋盘是一张桌子，每个方格都是一个表格单元格。

如果正方形上有一块，我会在该单元格中放置一个 ImageButton，并带有该块的图片。

问题是空单元格。我希望它们是可点击的（当用户从​​ A 移动到 B 时，他/她还需要单击空单元格 B）。

我无法弄清楚自己如何制作没有图像的 ImageButton。

可能吗？或者我应该在空单元格上放置一个 Button 控件吗？（在我看来，这是丑陋的，因为它不一致）。

还有其他想法吗？

# objective-c - 具有 6 个图像视图的自定义表格视图单元格

> ID：12806865
> 
> 赞同：0
> 
> 时间：2012-10-09T19:15:44.803
> 
> 标签：objective-c, ios, ipad, uitableview, core-data

我有一个非常困难的问题。这就是我的自定义单元格的样子。

```
|--------------------------------------------------------------------------|
|                                                                          |
|                                                                          |
|  Imageview1   Imageview2      Imageview3     Imageview4    imageview5    |
|                                                                          |
|                                                                          |
|                                                                          |                      
|--------------------------------------------------------------------------| 
```

我有一个包含 20 张图像的核心数据库。我想做的是用我的图像填充所有这些图像视图。所以在和我应该有 5 行，每个图像视图中都有一个不同的图像。

这是我的 cellforrowAtIndexpath 的代码

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }
    for(int i=0;i<5;i++)
    {
        float xCoord = 0.0;
        Team *team = [self.fetchedResultsController objectAtIndexPath:indexPath];
        NSData* imageData = [[NSData alloc] initWithContentsOfURL:[NSURL URLWithString:team.image]];
        UIImage* image = [[UIImage alloc] initWithData:imageData];
        UIImageView* imgView = [[UIImageView alloc] initWithImage:image];
        [imgView setFrame:CGRectMake(xCoord,0,imgView.frame.size.width, imgView.frame.size.height)];
        [cell.contentView addSubview:imgView];
        xCoord += imgView.frame.size.width;
    }

    return cell;
} 
```

这就是我走了多远。我现在不知道如何正确填写这个 tableview。其他图像视图名称为 img_Player2、img_Player3、img_Player4、img_Player5。

有人可以帮忙吗？

谢谢

**我想要实现的屏幕**

[这](http://www.flickr.com/photos/74322780@N08/8050170687/)就是我想要实现的目标：

而此刻我有[这个](http://www.flickr.com/photos/74322780@N08/8071984693/in/photostream)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:42:12.980

您需要将 的添加`UIImageViews`到. 假设您的 5 张图片加载到被调用的. 为简单起见，我假设您的每个图像都是 64 (320/5) 像素宽和 44 像素高。`contentView``UITableViewCell``NSArray``imagesArray`

你里面的代码`cellForRowAtIndexPath`应该大致是这样的：

```
float xCoord = 0.0;
for (UIImageView *imgView in imagesArray)
{
    [imgView setFrame:CGRectMake(xCoord,0,imgView.frame.size.width, imgView.frame.size.height)];
    [cell.contentView addSubview:imgView];
    xCoord += imgView.frame.size.width;
} 
```

您的代码将是这样的：

```
float xCoord = 0.0;

for(int i=0;i<5;i++)
{
    Team *team = [self.fetchedResultsController objectAtIndexPath:indexPath];
    NSData* imageData = [[NSData alloc] initWithContentsOfURL:[NSURL URLWithString:team.image]];
    UIImageView* imgView = [[UIImageView alloc] initWithImage:[UIImage imageWithData:imageData]];
    [imgView setFrame:CGRectMake(xCoord,0,imgView.frame.size.width, imgView.frame.size.height)];
    [cell.contentView addSubview:imgView];
    xCoord += imgView.frame.size.width;
} 
```

# django - 如何在模板中访问 MultiValueField 的子字段

> ID：12806866
> 
> 赞同：4
> 
> 时间：2012-10-09T19:15:49.963
> 
> 标签：django, django-forms, django-widget

我正在尝试按照[这种方法](http://copiesofcopies.org/webl/2010/04/26/a-better-datetime-widget-for-django/)很好地展示 DatTime 选择器。所以我有一个 MultiValueField 的子类，它有两个 SubFields 和一个小部件，它是 MultiWidget 的一个子类，它将正确的 css 类传递给它的子小部件，以便让 JQueryUI 将其中一个输入标记为日期选择器。现在我想在我的模板中单独访问 MultiValueField 的结果子字段，将它们呈现在表中的不同位置。
但我看不到解决它们的方法。我必须在模板中引用哪个对象？
根据我在模板中使用的内容，我可以访问大部分对象，但它们都不会呈现为 HTML。我所能得到的只是对象的默认 str() 输出。

例如， `form.date_time.field.time_field.widget`“渲染”成`<django.forms.widgets.TimeInput object at 0x7fe018033f90>`

访问有问题的字段会产生类似的结果。

我在这里遗漏了一些明显的东西吗？

# php - mysql_insert_id() 中的错误 [邮件标签]

> ID：12806870
> 
> 赞同：0
> 
> 时间：2012-10-09T19:16:02.803
> 
> 标签：php, mysql, mysql-insert-id

```
 $headers  = 'MIME-Version: 1.0' . "\r\n";
     $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
     $headers .= 'From: contact@email.com';
     $to = $email;
     $subject = "Confirmation";
     $message = "Hi, $username. You're registred in Site. Link for confirmation:     http://site.com/confirm/**".mysql_insert_id()."**";
     mail($to, $subject, $message, $headers);
     $query = mysql_query("insert into usr_users(username, password, email, avator, pin)          values('$username', '$password', '$email', '$img', '$pin')");
     $query2 = mysql_query("insert into usr_confirm(user_name, user_id, active, data) values('$username', '".mysql_insert_id()."', '$active', '$senha')");
     echo"Success!</br>"; 
```

第二个**mysql_insert_id()**（第 9 行）是正确的！但是第一个 mysql_insert_id()（第 6 行）在电子邮件中返回 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:19:33.197

根据[手册](http://php.net/mysql_insert_id)，如果最后一条语句没有生成值，`mysql_insert_id()`将返回：`0``AUTO_INCREMENT`

> 上一个查询成功时为 AUTO_INCREMENT 列生成的 ID，**如果上一个查询没有生成 AUTO_INCREMENT 值**，则为 0，如果没有建立 MySQL 连接，则为 FALSE。

您在插入任何记录*之前*`mysql_insert_id()`首先使用该调用，因此结果必须是（除非在您的代码中的其他地方之前有一个调用 - 那么您实际上会得到倾斜的结果）。尝试将与邮件相关的调用移至插入语句下方，为您提供：*`0`*

 *```
// insert the records
$query = mysql_query("insert into usr_users(username, password, email, avator, pin)          values('$username', '$password', '$email', '$img', '$pin')");
$query2 = mysql_query("insert into usr_confirm(user_name, user_id, active, data) values('$username', '".mysql_insert_id()."', '$active', '$senha')");

// send the email
$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
$headers .= 'From: contact@email.com';
$to = $email;
$subject = "Confirmation";
$message = "Hi, $username. You're registred in Site. Link for confirmation:     http://site.com/confirm/**".mysql_insert_id()."**";
mail($to, $subject, $message, $headers);
echo"Success!</br>"; 
```

如果您在此更改后仍然收到错误，则需要确认您的`usr_confirm`表中的主键字段已正确配置为`auto_increment`. 此外，如果设置正确，请尝试将连接变量传递给函数，例如调用结果在`mysql_insert_id($conn);`哪里。`$conn``mysql_connect()`

*站点注释*（未具体回答）
您的代码*极易*发生 SQL 注入；你没有逃避*任何*价值观。与其深入了解 SQL 注入是什么，我更愿意指导您使用准备好的语句。

此外，PHP 正在弃用这些`mysql_`方法以支持[`mysqli_`](http://php.net/manual/en/book.mysqli.php)and[`PDO`](http://php.net/manual/en/book.pdo.php)方法。这两个都支持准备好的声明，我建议您查看这些声明。

在此期间，请考虑用 包装变量`mysql_real_escape_string()`，例如：

```
... values ('" . mysql_real_escape_string($username) . "', ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:22:06.140

直到发送电子邮件后您才进行查询，`mysql_insert_id`给出了上一个查询为 AUTO_INCREMENT 列生成的 ID，因此您必须在使用前放置查询`mysql_insert_id`*

# sql - SQL 触发器与服务器端查询

> ID：12806878
> 
> 赞同：0
> 
> 时间：2012-10-09T19:16:31.657
> 
> 标签：sql, database, triggers, webserver, sql-update

案例：我有一张表格`T1`，通过表格保存提交记录。在更新此表上的记录时，我想在 table 中插入一行`T2`。

对于这种情况，以下场景的性能将如何比较？

场景 A：`AFTER UPDATE ON T1`触发器构建并插入相关行。由于`T1`没有引用`T2`，这没关系。

场景 B：服务器端服务层（PHP、python 等）在进行更新后插入相关行。

场景 C：这将是存储过程，但是 SP 和触发器的比较有很多，因此您不必包括它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:21:19.907

我真的不喜欢触发器。问题是它们本质上是副作用，因此往往是隐藏的，对系统的未来维护者来说并不明显。它们会导致以后出现错误的代码。除非您有特定数据显示此特定用例的性能瓶颈，否则我更愿意查看存储过程或处理对数据库的所有访问的“PHP、python 等”**服务层。**永远不要忽视*正确性胜过性能*这一事实。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T19:22:33.333

考虑到触发器和 python 之间的选择，我会选择触发器。无论数据如何插入，您的数据上的触发器确保 T2 包含 T1 的记录，而不是依赖于应用程序，从而确保数据的**完整性**。如果您添加另一个向 T1 添加记录的应用程序，使用触发器，T2 仍会插入记录。

不过，我不知道为什么您会打折存储过程，也不知道您从哪里得到触发器更快或“更适合数据库服务器的性质”的想法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T19:23:18.143

如果您可以保证数据始终且仅`T1`通过您的应用程序更新，我会投票支持在代码（PHP/Python 或存储过程）中执行此操作。如果有任何可能以另一种方式更新数据（也许是 DBA 编写查询？），那么请使用触发器以保证您获得预期的一致结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-09T19:26:55.690

无论使用触发器和/或存储过程，您的 sql 代码都会被预编译和优化。我怀疑是否存在显着的性能优势。正如其他人所指出的，触发器可能会在更新表上的多个记录时导致意外的性能问题，或者创建难以管理的更新链。

与触发器链相比，您将更容易重构和维护存储过程。

# android - iOS：带有扩展单元格的 TableView

> ID：12806880
> 
> 赞同：1
> 
> 时间：2012-10-09T19:16:48.200
> 
> 标签：android, iphone, ios, uitableview, autolayout

我目前正在开发 Android 应用程序的 iOS 版本。在一个屏幕上，我有一系列行，单击它们时会展开以提供信息。

点击前：

![在此处输入图像描述](../Images/8a3684e5cfad9b08552244629a02d5da.png)

* * *

点击后：

![在此处输入图像描述](../Images/dbfa8b1e5a3b54987967d95d6b09d4b2.png)

如何在 iOS 中复制这种行为？我不知道我应该使用表格视图还是只构建通用 UIView。我正在使用自动布局。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:23:50.473

您可以在特定的 NSIndexPath 重新加载 UITableVIewCell 并计算单元格的新高度。

查看：

```
- (void)reloadRowsAtIndexPaths:(NSArray *)indexPaths withRowAnimation:(UITableViewRowAnimation)animation 
```

从`UITableView`和

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath 
```

从`UITableViewDelegate`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:24:52.083

只需为`UITableView`. 使用`viewforheaderinsection`方法来做到这一点，并返回 UIButton 例如。如果你点击那个按钮，你应该插入`UITableViewCells`这个选定的组。我不能给你一个代码，因为我现在在 Windows 上，但这很简单。

UPD：查看 Apple 的此示例代码：http: [//developer.apple.com/library/ios/#samplecode/TableViewUpdates/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010139](http://developer.apple.com/library/ios/#samplecode/TableViewUpdates/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010139)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-18T20:09:41.617

当您收到扩展表格单元格的触摸事件时，请在表格控制器中使用以下调用

```
[self.tableView beginUpdates];
[self.tableView endUpdates]; 
```

虽然动画块是空的，但调用 beginUpdates 和 endUpdates 会导致表格视图刷新单元格布局并为更改设置动画。这将导致您的表视图委托被重新查询 - 因此请确保您在 UITableViewDelegate 中实现以下方法（通常您将其设置为 UITableViewController）：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath 
```

确保在收到触摸事件后此方法将返回适当的扩展单元格大小。结果将是一个很好的平滑单元扩展动画:)

# android - 覆盖 getView 时启用过滤

> ID：12806882
> 
> 赞同：0
> 
> 时间：2012-10-09T19:16:54.877
> 
> 标签：android, listview, view, filter, adapter

我有一个`ListView`并且我正在覆盖`getView`使用以下代码正确填充的方法。如果我使用'adapter.getfilter()'，它不会更新列表视图，尽管在适配器中它被过滤并在NEXT过滤器完成时由'out()'正确显示，在编辑框中输入文本。知道如何在我同时覆盖`getView`和过滤影响适配器而不是下一次在编辑框中输入文本时启用过滤吗？

```
final ArrayAdapter<String> adapter=new ArrayAdapter<String>(this,
android.R.layout.activity_list_item,stringArray) 
{   @Override
public View getView(int position, View convertView, ViewGroup parent)
    {View  row= super.getView(position, convertView, parent);
        View row=convertView;
if(position==0){
row = mLayoutInflater.inflate(R.layout.list_header, null);
final TextView sectionView = (TextView) row.findViewById(R.id.list_item_section_text);
sectionView.setText(myList.get(position));
} 
else
{row = mLayoutInflater.inflate(R.layout.list_item, null);
final TextView sectionView = (TextView) row.findViewById(R.id.list_item_entry_title);
sectionView.setText(myList.get(position));}
return row;}});

lv.setAdapter(adapter);
for (int i = 0; i < adapter.getCount(); i++) {//displaying properly
pr("adapter list"+adapter.getItem(i));
}
myFilter.addTextChangedListener(new TextWatcher() {
public void afterTextChanged(Editable s) { }
public void beforeTextChanged(CharSequence s, int start, int count, int after) {}
public void onTextChanged(CharSequence s, int start, int before, int count) {
adapter.getFilter().filter(s);
adapter.notifyDataSetChanged();
for (int i = 0; i < adapter.getCount(); i++) {
pr("adapter list before "+         (adapter.getItem(i)));//printing properly but not  
//updated in listview ,sometimes it just displays first few ,even if it should not be
//in filtered result after filtering.    
} }  }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:30:57.450

我建议构建一个自定义过滤器。扩展过滤器对象（我通常将其作为适配器的内部类）并让它进行过滤。保存您传递到数组中的项目的副本并从中过滤。在 publishResults 中清除您的适配器，然后重新添加过滤的项目。

# c# - 为什么 .NET 的 Complex 类型会损坏？

> ID：12806883
> 
> 赞同：8
> 
> 时间：2012-10-09T19:16:57.983
> 
> 标签：c#, .net, complex-numbers

我惊讶地发现`System.Numerics.Complex`.NET 中的数据类型并不能产生数学上准确的结果。

```
Complex.Sqrt(-1) != Complex.ImaginaryOne 
```

我得到的不是 (0, 1)，而是 (6.12303176911189E-17, 1)，这看起来很像舍入错误。

现在我意识到浮点运算有时会导致这样的结果，但通常使用整数会避免舍入错误。

为什么这个看似基本的操作会产生明显错误的结果？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-09T19:16:57.983

看反编译的`Sqrt`方法。

```
public static Complex Sqrt(Complex value)
{
    return Complex.FromPolarCoordinates(Math.Sqrt(value.Magnitude), value.Phase / 2.0);
} 
```

实际上，使用极坐标和弧度会导致舍入误差。`value.Phase / 2.0`将返回 pi/2，这不是一个完全可表示的数字。从极坐标 (1, pi/2) 转换时，当实坐标接近零时，舍入误差变得可见。

# scala - 如何在 Scala 中将 long 数组转换为字节？

> ID：12806886
> 
> 赞同：4
> 
> 时间：2012-10-09T19:17:05.067
> 
> 标签：scala

我想 md5 an `Array[Long]`，所以我想做那个 an`Array[Byte]`因为 MD5 函数需要 an `Array[Byte]`，我该怎么做？

我为此使用消息摘要。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T19:22:38.310

使用[`ByteBuffer`](http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html)：

```
val arr = listOfLongs.
  foldLeft(ByteBuffer.allocate(8 * listOfLongs.size)){ (buffer, lon) => 
    buffer putLong lon
  }.array 
```

或者更迫切地：

```
val buffer = ByteBuffer.allocate(8 * listOfLongs.size)
listOfLongs.foreach(buffer putLong _)
val arr = buffer.array 
```

注意：如果您需要 little-endian，只需调用：

```
buffer.order(java.nio.ByteOrder.LITTLE_ENDIAN) 
```

一开始。更多灵感：[将 long 转换为字节数组并将其添加到另一个数组](https://stackoverflow.com/questions/4299111)。

# java - 在 Eclipse 中刷新类路径容器名称

> ID：12806888
> 
> 赞同：0
> 
> 时间：2012-10-09T19:17:07.283
> 
> 标签：java, eclipse, plugins

嗨，我正在为 Eclipse 开发一个插件，其中部分涉及为 java 项目创建/维护类路径容器。在某些情况下，容器名称 ( `getDescription()`) 可能会更改。现在只需选择容器或项目并按 F5 即可刷新并显示新名称，但我似乎无法以编程方式执行此操作。我试过了：

```
IWorkspaceRoot root = ResourcesPlugin.getWorkspace().getRoot();
...
for (IProject p: root.getProjects()) {
    ... some checks done here...
    p.refreshLocal(IResource.DEPTH_INFINITE, null);
} 
```

但这似乎并没有刷新名称。我也尝试过一些愚蠢的事情，比如复制部分内容`RefreshAction`（我认为按下 F5 时使用的内容），但这也不起作用。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T20:33:58.417

我发现 JDT 期望类路径容器以不可变的方式运行。也就是说，IClasspathContainer 方法返回的任何值都不会从一个调用更改为另一个调用。如果他们这样做了，JDT 可能会发生有趣的事情。这不是一个很好的 API。

因此，将其视为不可变对象，当您需要更改某些内容（无论是条目还是描述）时，通过 JavaCore.setClasspathContainer() 调用提供一个新的 IClasspathContainer 实例。这将确保一切都正确更新。

# nginx - 使用 nginx 从给定目录的子目录中提供静态文件

> ID：12806893
> 
> 赞同：80
> 
> 时间：2012-10-09T19:17:20.027
> 
> 标签：nginx, static-files

我的服务器上有几组静态`.html`文件，我想使用 nginx 直接为它们提供服务。例如，nginx 应该提供以下模式的 URI：

```
www.mysite.com/public/doc/foo/bar.html 
```

与`.html`位于的文件`/home/www-data/mysite/public/doc/foo/bar.html`。您可以将其`foo`视为集合名称，也可以`bar`将其视为文件名。

我想知道以下 nginx 配置是否可以完成这项工作：

```
server {
    listen        8080;
    server_name   www.mysite.com mysite.com;
    error_log     /home/www-data/logs/nginx_www.error.log;
    error_page    404    /404.html;

    location /public/doc/ {
        autoindex         on;
        alias             /home/www-data/mysite/public/doc/;
    }

    location = /404.html {
        alias             /home/www-data/mysite/static/html/404.html;
    }
} 
```

换句话说，该模式的所有请求`/public/doc/.../....html`都将由 nginx 处理，如果找不到任何给定的 URI，`www.mysite.com/404.html`则返回默认值。

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2012-10-09T19:43:25.680

它应该可以工作，但是[http://nginx.org/en/docs/http/ngx_http_core_module.html#alias](http://nginx.org/en/docs/http/ngx_http_core_module.html#alias)说：

> 当 location 与指令值的最后一部分匹配时：最好使用 root 指令：

这将产生：

```
server {
  listen        8080;
  server_name   www.mysite.com mysite.com;
  error_log     /home/www-data/logs/nginx_www.error.log;
  error_page    404    /404.html;

  location /public/doc/ {
    autoindex on;
    root  /home/www-data/mysite;
  } 

  location = /404.html {
    root /home/www-data/mysite/static/html;
  }       
} 
```

# java - 如何在 Eclipse Juno 中禁用星形导入

> ID：12806897
> 
> 赞同：8
> 
> 时间：2012-10-09T19:17:41.517
> 
> 标签：java, eclipse

如何在 Eclipse Juno 中禁用星形导入？我只想导入我使用的类，如果我导入该包中的很多类，IDE 会导入整个包。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-09T19:22:26.210

*Preferences -> Java -> Code Style -> Organize Imports*，然后更改*Number of imports required for 。**。

如果你把它改成，说`2147483647`，你应该没问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-09T19:23:13.660

我这里只有 Indigo，但我认为它会对您有所帮助：

转到首选项 -> Java -> 代码样式 -> 组织导入。

在那里，您将拥有以下字段：

```
Number of imports needed for .*
Number of static imports needed for .* 
```

您可以更改它以满足您的需求。Eclipse Indigo 中的默认值为 99，这可能是避免 .* 导入的好数字。

# c# - 如何确定我的应用程序使用的全部内存？

> ID：12806899
> 
> 赞同：0
> 
> 时间：2012-10-09T19:17:42.263
> 
> 标签：c#, memory-management

我的应用程序有 10 个锯齿状数组和 5 个列表。平均数据填充了不同的数据，例如双精度或字符串类型。所以我知道我的应用程序必须消耗大量内存，但我如何确定正在使用的内存总量？

我已经阅读过使用，`GC.GetTotalMemory`所以我做的第一件事是这样的：

```
var initialMemory = System.GC.GetTotalMemory(true);
many line of code
...
..
var finalMemory = System.GC.GetTotalMemory(true);
var consumption = finalMemory - initialMemory; 
```

所有代码都在`main()`调用他的函数的函数中，但最终结果为零。我看到它`finalMemory`也为零，那么首先发生了什么？初始记忆有一个数字，但最终没有。

是`System.GC.GetTotalMemory`找出我的应用程序使用的内存总量的最佳选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:36:29.550

我曾经使用过：
在我的 global.asax 文件中：

```
protected void Application_BeginRequest(Object sender, EventArgs e)
{
    if (WebConfigSettings.ShowMemoryUsage)
    {
        GC.Collect();
        logger.Debug(string.Format("Total memory: {0:###,###,###,##0} bytes", GC.GetTotalMemory(true)));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:24:09.970

您可以执行以下操作：

```
using System.Diagnostics;

...
    Process.GetCurrentProcess().VirtualMemorySize64 
```

这将为您提供您将在任务管理器等位置看到的数字。但是，这包括非托管开销内存使用。`System.GC.GetTotalMemory(true)`将为您提供垃圾收集器使用的实际内存量（.net 内存使用情况）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:37:34.660

这是您也可以使用的链接[How to do (Almost) Everything in WMI](http://www.codeproject.com/Articles/18146/How-To-Almost-Everything-In-WMI-via-C-Part-2-Proce)

也看看这个 StackOverFlow 帖子.. 有很多选项 WMI 非常强大 [How to Get CPU Usage](https://stackoverflow.com/questions/278071/how-to-get-the-cpu-usage-in-c)

如果 WMI 不是您正在寻找和或想要使用的......那么看看性能计数器这里是一个如何使用它们的示例以及[性能计数器简介](http://www.codeproject.com/Articles/8590/An-Introduction-To-Performance-Counters)

# javascript - 从 ios 6 Safari 中的 onchange 函数调用时 window.open 冻结

> ID：12806900
> 
> 赞同：0
> 
> 时间：2012-10-09T19:17:48.097
> 
> 标签：javascript, mobile-safari, ios6, onchange, window.open

```
<select id="myDropDown" onblur='launchSite()'>
    <option value="selectone" selected="true">Select One</option>
    <option value="http://www.google.com">Google </option>
    <option value="http://www.cnn.com">CNN </option>
    <option value="http://www.espn.com">ESPN </option>
</select>

<script>

function launchSite()  {
    var el = document.getElementById("myDropDown");
    var url = el.options[el.selectedIndex].value;
    window.open(url);
}
 </script> 
```

我们有一个 Web 应用程序，当从下拉列表中选择某个值时，它会打开一个新的浏览器页面。这在所有之前测试过的浏览器（包括 ios 5 上的 Safari）中运行良好。在 ios 6 中选择下拉值后，我们会得到预期的允许/拒绝弹出窗口。但是在弹出的 Safari 上进行选择后，它就完全冻结了。奇怪的是，这种冻结并非每次都发生。只是偶尔。这可能是ios 6的错误吗？我已经尝试过`onblur()`像其他问题所建议的那样，但我仍然偶尔会冻结。我可以使用上面的代码看到问题。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T19:14:12.600

```
function launchSite(){
    window.setTimeout(function(){
        var el = document.getElementById("myDropDown");
        var url = el.options[el.selectedIndex].value;
        window.open(url);
    },100); } 
```

把它放在 onchange 事件处理程序中应该可以解决冻结问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T21:59:31.183

我们在尝试调用时遇到了一个非常相似的问题：

```
window.open(url, '_self') 
```

在 Chrome 和 Safari 中。相反，请定义要在何处打开窗口：

```
window.open(url, '_blank')
or
window.open(url, '_new') 
```

但是，如果您想以 '_self' 或当前窗口打开，则只需调用：

```
windown.location.href = url; 
```

# configuration - 使用 Chef/Puppet 并管理手动更改

> ID：12806902
> 
> 赞同：5
> 
> 时间：2012-10-09T19:18:08.503
> 
> 标签：configuration, chef-infra, puppet, provisioning

我正在为事实上的高可用性服务运行复杂的服务器设置。到目前为止，我大约需要两天时间来设置所有内容，所以我想自动配置。

但是，我对（运行的）服务器做了很多手动更改。一个典型的例子是更改防火墙配置以应对各种黑客攻击、数据包泛滥等。能够在活动节点上快速工作很重要。此外，服务器维护着许多活动的 TCP 连接，并且为了简单的配置更改而丢失这些连接是不可能的。

我不明白 Chef 或 Puppet 是否旨在处理此问题。一旦我更改了一些系统配置，我想将它存储在某个地方并在配置下一个实例时使用它。我应该坚持使用其中一种工具还是选择其他工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T23:04:27.400

手动更改和配置不需要手动操作。他们甚至不一起喝茶。

在工作中，我们使用 puppet 来管理所有架构，并且由于性能瓶颈、攻击等，我们需要快速手动进行更改。

我们要做的是首先确保 puppet 能够设置架构的每个部分，准备好交付，而无需任何特定的调整。

然后当我们需要进行手动更改时，如果您很着急，只要您不弄乱由 puppet 管理的文件就没有风险，如果它是 puppet 管理的文件，我们需要更改什么，那么我们只需停止 puppet 代理并做任何事情我们需要。

匆忙结束后，我们进行如下操作：

*这些更改应该应用于具有相同症状的所有服务器？*

如果是这样，那么您可以开发 puppet 调用的“事实”，它是每次运行时在代理上运行的代码，并将结果保存在所有 puppet 模块中可用的变量中，例如，如果您更改了 ip conntrack max 值，因为防火墙无法处理所有连接，您可以轻松地（十行代码）在 puppet 中每次运行一个具有当前 conntrack 计数值的变量，因此告诉 puppet 设置与当前使用情况相关的最大值。然后所有其他服务器都将受益于此调整，并且您可能不再需要处理 conntrack 问题（只要您继续以短频率运行 puppet，这是默认设置）

*在给定的紧急情况下，这些更改应该始终手动应用吗？*

如果配置是由 puppet 管理的，想办法让配置包含其他文件，并告诉 puppet 忽略它。这是最简单的方法，但并不总是可行（例如 /etc/network/interfaces 不支持包含）。如果不可能，那么您将不得不在紧急情况下停止 puppet 代理，以便能够更改 puppet 文件，而不会有在下次 puppet 运行时被删除的风险。

*是否仅针对此主机进行此更改，而其他主机都不需要它？*

无论如何将其添加到人偶中！如果 $fqdn == my.very.specific.host 放一个甜食，然后放入您需要的任何东西。即使对于单个案例，将您所做的所有更改迁移到服务器总是有益的（并且耗时），如果由于某种原因您的服务器崩溃到不可恢复的状态（例如硬件），这将允许您完全恢复服务器设置问题）

总之：

对我来说，处理手工更改的技巧是在推理您决定如何进行更改以及在紧急情况结束后将该逻辑转移到傀儡上时付出了很多努力。如果您因为给定的软件插槽都已使用但服务器上仍有可用内存而感到有问题，那么处理流量峰值是合理的，允许运行更多插槽，然后花一些时间将该逻辑移入 puppet . 当然要非常小心，并且与您要测试它的架构上不同场景的数量一样耗时，但最终它非常**非常**有益。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T14:42:09.713

我想完成 Valor 的出色回答。

puppet 是一种强制配置的工具。所以你必须这样想：

*   在我运行 puppet 的机器上...
*   我问傀儡客户...
*   确保当前机器的配置...
*   是在 puppet 配置中指定的...
*   取自 puppet 服务器，或直接取自一堆 puppet 文件（更简单）

因此，要回答您的一个问题，puppet 不需要机器或服务重新启动。但是，如果您使用 puppet 设置的配置文件中的更改需要重新启动相应的服务/守护程序/应用程序，那么就无法避免它。puppet 中有一些方法可以告诉在配置更改的情况下需要重新启动服务。当然，如果 puppet 发现没有任何变化，它不会重新启动服务。

Valor 假设您以客户端/服务器方式使用 puppet，（例如）puppet 客户端每小时轮询 puppet 服务器以获取配置。但也可以将您的 puppet 文件从一台机器移动到另一台机器，例如使用 git，然后手动启动 puppet。这种方式是：

1.  比客户端/服务器技术简单得多（身份验证令人头疼）
2.  仅在您明确要求时强制执行配置更改，从而避免覆盖您的手工更改

如果您管理大量机器，这显然不是使用 puppet 的最佳方式，但它可能是一个好的开始或一个好的过渡。

而且，木偶*很难*在有趣的水平上学习。我花了 2 周时间才能够从头开始自动安装 AWS 服务器。我不后悔，但如果你必须说服老板分配你的时间，你可能想知道这个事实。

# excel - 如何在Excel图表中强制水平轴x上均匀分布的数字刻度线

> ID：12806904
> 
> 赞同：1
> 
> 时间：2012-10-09T19:18:31.527
> 
> 标签：excel, graph, axis

为简单起见，我有 2 行的表

1（应定义水平轴）：0 0.03217 0.04119 0.09613 0.14178 0.17035 0.18824

2（应定义垂直轴）：86 81 80.8 73.8 69 65 63

我需要建立一个图表（折线图），以第 1 行为横轴，第 2 行为纵轴。水平轴上的刻度线应为 0、0.02、0.04 等。所以我从第 1 行选择水平轴数据，从第 2 行选择垂直轴数据。

但是，当我尝试格式化 X 轴时，我没有得到任何数字格式的选项。选项从刻度线之间的间隔等开始。垂直轴的选项完全没问题我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T11:25:03.110

我假设您想绘制一条连接点 (0,86)、(0.0321,81) ... 的线。您应该尝试使用散点图而不是折线图。

# emacs - 在 org-mode 中定义自己的标签

> ID：12806905
> 
> 赞同：6
> 
> 时间：2012-10-09T19:18:36.663
> 
> 标签：emacs, org-mode

在 org-mode中`#+AUTHOR`或`#+LATEX`在 org-mode 中有标签 - 它们被称为标签吗？我想定义我自己的标签，它调用一个函数来预处理数据然后输出它 - 如果导出目标是 LaTeX。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T19:08:22.967

`qtree`我的解决方案是为`SRC`块定义自己的语言 , 。

```
#+BEGIN_SRC qtree
[.CP [.TP [.NP [] [.N' [.N Syntax] []]] [.VP [] [.V' [.V sucks] []]]]]
#+END_SRC 
```

并相应地处理它。我什至添加了一个 qtree 模式`paredit`。`landscape`如果树长得很大，还有一个参数。[https://github.com/Tass/emacs-starter-kit/blob/master/vendor/assorted/org-babel-qtree.el](https://github.com/Tass/emacs-starter-kit/blob/master/vendor/assorted/org-babel-qtree.el)

```
(require 'org)

(defun org-babel-execute:qtree (body params)
  "Reformat a block of lisp-edited tree to one tikz-qtree likes."
  (let (( tree
          (concat "\\begin{tikzpicture}
\\tikzset{every tree node/.style={align=center, anchor=north}}
\\Tree "
                  (replace-regexp-in-string
                   " \\_<\\w+\\_>" (lambda (x) (concat "\\\\\\\\" (substring x 1))) 
                   (replace-regexp-in-string
                    (regexp-quote "]") " ]" ; qtree needs a space
                                        ; before every closing
                                        ; bracket.
                    (replace-regexp-in-string
                     (regexp-quote "[]") "[.{}]" body)) ; empty leaf
                                        ; nodes, see
                                        ; http://tex.stackexchange.com/questions/75915
                   )                    ; For
                                        ; http://tex.stackexchange.com/questions/75217
                  "\n\\end{tikzpicture}"
                  )))
    (if (assoc :landscape params)
        (concat "\\begin{landscape}\n" tree "\n\\end{landscape}")
      tree)))

(setq org-babel-default-header-args:qtree '((:results . "latex") (:exports . "results")))
(add-to-list 'org-src-lang-modes '("qtree" . qtree))
(define-generic-mode 
    'qtree-mode                  ;; name of the mode to create
  '("%")                         ;; comments start with '%'
  '()                            ;; no keywords
  '(("[." . 'font-lock-operator) ;; some operators
    ("]" . 'font-lock-operator))
  '()                      ;; files for which to activate this mode 
  '(paredit-mode)          ;; other functions to call
  "A mode for qtree edits" ;; doc string for this mode
  ) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-09T23:03:35.877

它们似乎不再被称为缓冲区[内设置的](http://orgmode.org/manual/In_002dbuffer-settings.html)*关键字*。不管它们叫什么，它们似乎都不是用户可定义的。

您想要做的与常用的处理方式极为相关，而使用*xelatex*或*pdflatex进行导出，* [如 Worg 中所述](http://orgmode.org/worg/org-faq.html#using-xelatex-for-pdf-export)。

相关部分是：

```
;; Originally taken from Bruno Tavernier: http://thread.gmane.org/gmane.emacs.orgmode/31150/focus=31432
(defun my-auto-tex-cmd ()
  (if (string-match "YOUR_TAG: value1" (buffer-string))
      (do something))
  (if (string-match "YOUR_TAG: value2" (buffer-string))
      (do something else))

(add-hook 'org-export-latex-after-initial-vars-hook 'my-auto-tex-cmd) 
```

# java - 如何向 XML 元素添加属性

> ID：12806908
> 
> 赞同：4
> 
> 时间：2012-10-09T19:18:45.587
> 
> 标签：java, xml, parsing, dom

我正在使用 DOM 解析器。我必须解析以下 XML：

```
 <abc>
       <type action="">
          <code>test</code>
          <value>001</value>
       </type>
       <type action="">
          <code>test2</code>
          <value>002</value>
       </type>
    </abc> 
```

所以，根据`value`字段下的`type`字段，我必须在字段中填写`action`属性`type`。我有点难过。我能够获取该`value`字段的值，但我不知道如何返回并添加属性。

任何帮助将不胜感激！！！

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T19:23:26.123

要返回，只需在遍历其子`type` `Element`项之前保存对 的引用。`value`（假设您已经访问过它）。

要更改值，请使用[setAttribute()](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Element.html#setAttribute%28java.lang.String,%20java.lang.String%29)方法。

编辑：

替代方法：从`value`文本节点调用`getParentNode()`两次（一次返回值元素，一次返回类型元素），然后`setAttribute()`在进行任何必要的转换后调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T19:29:23.537

尝试类似的东西

```
nodelist = doc.getElementsByTagName("value");
for (Element element : nodelist) {
Element parent = element.getParentNode()
parent.setAttribute("action", "attrValue");
} 
```

# pdf - Ghostscript 在合并 PDF 时跳过字符

> ID：12806911
> 
> 赞同：6
> 
> 时间：2012-10-09T19:18:58.247
> 
> 标签：pdf, merge, ghostscript

在 Ubuntu 上使用 Ghostscript（8.71 版）合并使用 wkhtmltopdf 创建的 PDF 文件时遇到问题。

我在随机场合遇到的问题是某些字符在合并过程中丢失并在合并的 PDF 中被任何内容（或空格）替换。如果我查看原始 PDF，它看起来不错，但合并后缺少一些字符。

请注意，一个丢失的字符（例如数字 9 或字母 a）可能会丢失在文档中的某个位置，但会在文档的其他位置正常显示，因此显示它或字体问题本身不是问题。

我正在使用的命令是：

```
gs \
   -q \
   -dNOPAUSE \
   -sDEVICE=pdfwrite \
   -sOutputFile=/tmp/outputfilename \
   -dBATCH \
    /var/www/documents/docs/input1.pdf \
    /var/www/documents/docs/input2.pdf \
    /var/www/documents/docs/input3.pdf 
```

有没有其他人经历过这个，或者甚至更好地知道它的解决方案？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-09T20:24:01.873

*如果嵌入字体子集的名称*相同，但这些子集的实际*内容*不同（包含不同的字形集） ，我已经看到会发生这种情况。

检查所有输入文件中使用的字体。为此使用 Poppler 的`pdffonts`实用程序：

```
 for i in input*.pdf; do
     pdffonts ${i} | tee ${i}.pdffonts.txt
 done 
```

查找每个 PDF 中使用的字体名称。

我的理论/赌注是你看到不同的输入文件使用相同的字体名称（类似于 的名称`BAAAAA+ArialMT`）。

用于子集字体的`BAAAAA+`字体名称前缀应该是*随机*的（尽管官方规范对此不是很清楚）。然而，一些应用程序使用*可预测*`BAAAAA+`的前缀，以 等开头`CAAAAAA+` `DAAAAA+`（OpenOffice.org 和 LibreOffice 因这一点而臭名昭著）。*这意味着`BAAAAA+`在每个使用至少一种子集字体的文件中都会使用前缀...*

您的输入文件不使用完全相同的字符子集很容易发生。然而，使用相同的名称可能会使 Ghostscript 认为字体确实是相同的。它（错误地）“优化”合并的 PDF 并仅嵌入 2 个字体实例中的一个（都具有相同的名称，例如`BAAAAA+Arial`）。但是，此实例可能不包括某些字形，这些字形是其他实例的一部分。

这会导致合并输出中缺少某些字符。

我知道最新版本的 Ghostscript 对其字体处理代码进行了大修。尝试 Ghostscript v9.06（迄今为止的最新版本）可能会让您更加幸运。

我非常有兴趣对此进行更详细的调查。如果您可以提供输入文件的示例（以及 GS v8.70 给出的合并输出），我可以测试它是否与 v9.06 一起工作得更好。

**你可以做些什么来避免这个问题**

1.  尝试**始终将字体作为完整集而不是子集嵌入**：

    *   我不知道在使用 wkhtmltopdf 时是否以及如何控制嵌入完整的字体。
    *   如果您从 Libre/OpenOffice 生成输入 PDF，那么您就不走运了，您将无法控制它。
    *   如果您使用 Acrobat 生成输入 PDF，您可以在 Distiller 设置中调整字体嵌入细节。
    *   如果 Ghostscript 生成您的输入 PDF，则强制完整字体嵌入的命令行参数是：
        `gs -o output.pdf -sDEVICE=pdfwrite -dSubsetFonts=false input.file`

    某些类型的字体不能完全嵌入，而只能嵌入子集（TrueType、Type3、CIDFontType0、CIDFontType1、CIDFontType2）。请参阅[**此问题**](https://stackoverflow.com/a/3489369/359307)的答案*“为什么 Acrobat Distiller 不完全嵌入所有字体？”* 更多细节。

2.  仅当您确定没有其他人可以看到或打印或使用您的个人输入文件时才执行以下操作：**根本不要嵌入字体 - 仅在与 Ghostscript 合并时嵌入**您输入的最终结果 PDF。

    *   我不知道在使用 wkhtmltopdf 时是否以及如何控制没有字体嵌入。
    *   如果您从 Libre/OpenOffice 生成输入 PDF，那么您就不走运了，您将无法控制它。
    *   如果您使用 Acrobat 生成输入 PDF，您可以在 Distiller 设置中调整字体嵌入细节。
    *   如果 Ghostscript 生成您的输入 PDF，则防止字体嵌入的命令行参数是：
        `gs -o output.pdf -sDEVICE=pdfwrite -dEmbedAllFonts=false -c "<</AlwaysEmbed [ ]>>setpagedevice" input.file`

    某些类型的字体不能完全嵌入，而只能嵌入子集（Type3、CIDFontType1）。请参阅 [**此问题**](https://stackoverflow.com/a/3489369/359307)的答案*“为什么 Acrobat Distiller 不完全嵌入所有字体？”* 更多细节。

3.  **不要使用 Ghostscript，而是`pdftk`用于合并 PDF。** `pdftk`在合并 PDF 时，它比 Ghostscript（至少旧版本的 pdftk 是）更“愚蠢”的实用程序，这种愚蠢可能是一个优势......

* * *

## 更新

再次回答，但这次更明确（在下面评论中@sacohe 的额外问题之后。在*许多*（不是*全部*）情况下，以下过程将起作用：

*   借助 Ghostscript（最好是 9.0x 系列的最新版本）重新“提取”输入的 PDF 文件。

*   要使用的命令是这个（或类似的）：
    `gs -o redistilled-out.pdf -sDEVICE=pdfwrite input.pdf`

然后，即使输入 PDF 对不同的字体（子集）使用相同的名称前缀，生成的输出 PDF 也应该对字体名称使用不同的（唯一）前缀。

当我处理原始问题的作者“R先生”提供给我的原始输入文件样本时，此过程对我有用。在那次修复之后，“跳过字符问题”在最终结果中消失了（从固定输入文件创建的合并 PDF）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T23:41:36.853

我想提供一些反馈，不幸的是，重新处理技巧似乎不适用于 ghostscript 8.70（在 redhat/centos 版本中）和从 word 2010 导出为 pdf 的文件（似乎`ABCDEE+`对所有内容都使用前缀）。而且我无法为我的平台找到任何预构建的 ghostscript 9 版本。

您提到旧版本的 pdftk 可能会起作用。我们从 pdftk（较新版本）转移到 gs，因为某些 pdf 文件会导致 pdftk 核心转储。@Kurt，您认为尝试查找旧版本的 pdftk 可能会有所帮助吗？如果是这样，你推荐什么版本？

另一个半途而废的丑陋方法是使用：

```
-sDEVICE=pdfwrite -dCompatibilityLevel=1.2 -dHaveTrueType=false 
```

它将字体转换为位图，但随后会导致页面上的字符有点轻（不是什么大问题），尝试选择文本时会偏离大约一个行高（有点烦人），最糟糕的是即使字符显示正常，复制/粘贴会在文本中产生随机垃圾。

（我希望这将是一个评论，但我想我不能这样做，答案是否已关闭？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-02T22:36:45.520

据我所知，这个问题在 Ghostscript 9.21 版中得到了*修复。*我们遇到了类似的问题，合并的 PDF 缺少字符，虽然 @Kurt Pfeifle 建议重新提取这些 PDF 确实有效，但对我们来说似乎有点不可行/愚蠢。我们合并的一些 PDF 包含多达 600 个或更多单独的 PDF，并且重新提取其中的每一个以合并它们似乎很疯狂

我们的 Ghostscript 生产版本是 9.10，这导致了这个问题。但是当我在 9.21 上进行一些测试时，问题似乎消失了。我无法使用 GS 9.21 生成缺少或损坏字符的文档，所以我认为这是真正的解决方案。

# ruby - 使用 nginx 执行最简单的 Ruby 脚本并在 Web 浏览器中显示结果

> ID：12806913
> 
> 赞同：0
> 
> 时间：2012-10-09T19:19:58.700
> 
> 标签：ruby, web-applications, nginx, cgi

> **可能重复：**
> [我如何通过表单嵌入 ruby​​.rb 文件，这样 ruby​​.rb 将被执行并且结果在视图中可见](https://stackoverflow.com/questions/12768581/how-do-i-embed-ruby-rb-file-via-form-in-a-way-that-ruby-rb-would-be-executed-and)

当网页上的链接被点击时，我有简单的 ruby​​ 代码来执行，然后将结果作为创建的网页返回（基本上它类似于解析 *md 文件并创建和显示 *html）我使用 Ruby、Windows 8 和 Nginx，但我对配置 nginx。如何使它与 Ruby 一起工作？不是 RoR。只是鲁比。

# ruby-on-rails - 是否可以使用 Cucumber 测试现有的 Rails 应用程序？

> ID：12806914
> 
> 赞同：1
> 
> 时间：2012-10-09T19:20:04.020
> 
> 标签：ruby-on-rails, testing, cucumber

我刚刚阅读了许多关于 Cucumber 主题的不同网页。似乎不可能使用 Cucumber 来测试现有的 Ruby on Rails 应用程序。我只是问一下，以防我错过了什么。（我们正在考虑将其用于未来的 RoR 应用程序开发。）

我在问，目前对于测试现有 Ruby on Rails 应用程序的最佳工具的共识是什么？

我对 WATIR 做了一些探索，它看起来很容易使用，但是驱动 Web 浏览器会导致不可扩展。我读过一些已经从 WATIR 转移到 Celerity....

但是，我所处的环境是我们从零以前的测试开始的。为现有的 Ruby on Rails 应用程序快速编写测试的“最佳”选择是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T19:25:46.630

Cucumber 绝不会无法测试现有的应用程序。不确定是什么给了您这个想法，但可能是因为它通常用于测试驱动开发？

Cucumber 是迄今为止使用最广泛的 Rails 集成测试软件。我肯定会建议将 Cucumber 与 Capybara、Guard、Spork 和 RSpec 一起用于您的测试套件。（RSpec 用于单元测试，Capybara 用于集成测试，Guard 和 Spork 用于快速运行测试）。

如果您以前从未看过 Cucumber，您可能想先看一些[教程](https://github.com/cucumber/cucumber/wiki/tutorials-and-related-blog-posts)。

要开始您的项目，请尝试为一个简单的功能创建一个 Cucumber 功能。例如，编写一个访问主页的测试。就像是：

```
Feature: View homepage
   Given I am on the profile page
   When I click "home"
   Then I should see the homepage logo 
```

一旦你理解了这一点，就可以继续使用更复杂的功能。示例可能包括创建用户帐户、登录、查看个人资料等。（我不知道您的应用程序做了什么，但我认为您明白了。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T20:07:00.623

Cucumber 能够测试现有的应用程序。

您必须为黄瓜设置配置设置并通过 rails g cucumber 生成黄瓜文件夹

在运行此命令之前，您必须包含 gem：gem 'cucumber'。

# php - 创建一个随机 Magento 优惠券

> ID：12806919
> 
> 赞同：3
> 
> 时间：2012-10-09T19:20:42.740
> 
> 标签：php, magento, automation, auto-generate, coupon

我遇到了一些麻烦。我想做的是每次有人订阅我们的时事通讯时在 Magento 中自动生成一个随机优惠券代码。优惠券是 10 美元的任何东西，并将有一个 exp。订阅后两周的日期。

所以，我正在尝试编写一个简单的脚本，当提交“订阅我们的时事通讯”表单时会跳闸，它将与 Magento 交谈，向 Magento 索要一个随机优惠券代码，设置一些基本的价格规则（任何东西都可以减 10 美元） ，每个客户使用一次，每张优惠券使用一次，从生成后两周到期）然后返回一个随机优惠券代码（例如：WELCOME5​​798），该代码可以存储在一个将被传递的变量中，连同名字和姓氏和 e - 通过 MailChimp API 向 MailChimp 发送邮件。除了如何让 Mage 通过 PHP 脚本生成这样的代码然后返回所述代码（即我有我的表单并且我知道如何将值传递给 MailChimp）之外，我已经弄清楚了所有这些。

我是 Magento 的新手，所以我过得很艰难。我在 Mage/SalesRule/Model/Coupon 中看到了代码，也看到了一些解决类似问题的示例，例如：[Magento - Create Unique Coupon Codes through code and mail it to the customer](https://stackoverflow.com/questions/8908347/magento-create-unique-coupon-codes-through-code-and-mail-it-to-the-customer)

但我真的不知道从哪里开始为我自己的目的制作这项工作。可以直接使用一些帮助/设置。:( 谢谢各位。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T20:41:32.030

那么，你的问题是什么？如何根据您的要求生成优惠券？或者如何在模块中安排它？

您可以使用事件 newsletter_subscriber_save_after 将您的自定义操作注入订阅过程。

这是根据您的需要创建优惠券的示例

```
<?php
/**
 * Create coupon for fixed price discount
 *
 * @param int $customer_id
 * @param float $discount
 */
public function createCoupon($customer_id, $discount)
{
    $customer = Mage::getModel('customer/customer')->load($customer_id);

    $customerGroupIds = Mage::getModel('customer/group')->getCollection()->getAllIds();
    $websitesId = Mage::getModel('core/website')->getCollection()->getAllIds();

    $customer_name = $customer->getName();
    $couponCode = Mage::helper('core')->getRandomString(9);

    $model = Mage::getModel('salesrule/rule');
    $model->setName('Discount for ' . $customer_name);
    $model->setDescription('Discount for ' . $customer_name);
    $model->setFromDate(date('Y-m-d'));
    $model->setToDate(date('Y-m-d', strtotime('+2 days')));
    $model->setCouponType(2);
    $model->setCouponCode($couponCode);
    $model->setUsesPerCoupon(1);
    $model->setUsesPerCustomer(1);
    $model->setCustomerGroupIds($customerGroupIds);
    $model->setIsActive(1);
    $model->setConditionsSerialized('a:6:{s:4:\"type\";s:32:\"salesrule/rule_condition_combine\";s:9:\"attribute\";N;s:8:\"operator\";N;s:5:\"value\";s:1:\"1\";s:18:\"is_value_processed\";N;s:10:\"aggregator\";s:3:\"all\";}');
    $model->setActionsSerialized('a:6:{s:4:\"type\";s:40:\"salesrule/rule_condition_product_combine\";s:9:\"attribute\";N;s:8:\"operator\";N;s:5:\"value\";s:1:\"1\";s:18:\"is_value_processed\";N;s:10:\"aggregator\";s:3:\"all\";}');
    $model->setStopRulesProcessing(0);
    $model->setIsAdvanced(1);
    $model->setProductIds('');
    $model->setSortOrder(1);
    $model->setSimpleAction('by_fixed');
    $model->setDiscountAmount($discount);
    $model->setDiscountStep(0);
    $model->setSimpleFreeShipping(0);
    $model->setTimesUsed(0);
    $model->setIsRss(0);
    $model->setWebsiteIds($websitesId);

    try {
        $model->save();
    } catch (Exception $e) {
        Mage::log($e->getMessage());
    }
} 
```

# c++ - 引用成员和未初始化的对象（设计相关）

> ID：12806921
> 
> 赞同：1
> 
> 时间：2012-10-09T19:20:51.697
> 
> 标签：c++, interface, reference

我有一个`Playable`由两个不同的类继承的类：`Note`并且`Track.` 该类`Track`有一个`Generator`经常使用且非常大的类型的成员。Track 也有一个 Note-objects 的 multimap。创建的每个音符始终添加到正确的轨道。

我的问题是在某些情况下 Note 类也需要访问`Tracks` `Generator-member.`

我想通过给 Note 一个`Track &trackReference`成员来实现这一点，这样我就可以找到正确`Generator`的方法，`trackReference`但问题是我不能使用默认构造函数，因为引用不能为空。有时我的 Note 对象只是空的，所以我真的需要 Note 的默认构造函数。

那么如何实现这一点，以便我可以从每个 Note 访问 Generator 对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:28:42.527

如果您的设计允许空实现，那是一种可能的途径。这是一个例子：

```
class foo
{
public:
   virtual void bar() = 0;
};

class null_foo
   : public foo
{
   virtual void bar() {}
};

class C
{
public:
   C(foo& f) : ref(f)  {}
   C() : ref(null_foo) {};

private:
   foo& ref;
}; 
```

这是一个[相关的问题。](https://stackoverflow.com/questions/1701416/initialization-of-reference-member-requires-a-temporary-variable-c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:38:13.597

您可以简单地使用`Track*`代替，`Track&`并且它还具有实现引用无法实现的功能的许多优势。例如：

```
bool HasParent() {return trackReference != NULL;}
Track& track() {return *trackReference;} 
```

# ios - 如何确保实例没有被释放？

> ID：12806923
> 
> 赞同：0
> 
> 时间：2012-10-09T19:20:54.043
> 
> 标签：ios, uitableview, asynchronous, synchronization, exc-bad-access

在我的应用程序中，我正在异步加载 UITableViewCells 的图像，如下所示：

```
-(void) loadImage:(NSString *)urlString cell:(UITableViewCell *)cell {
    UIImageView *iv = cell.imageView;

    UIImage *image = [imageCache objectForKey:urlString];
    if(!image) {

        NSURL *url = [NSURL URLWithString:urlString];

        image = [UIImage imageWithData: [NSData dataWithContentsOfURL:url]];
        if(image) {
            [imageCache setObject:image forKey:urlString];
        }
    }

    dispatch_async(dispatch_get_main_queue(), ^{
        iv.image = image;
        [cell addSubview:iv];
    });
} 
```

在所有图像完成加载之前刷新 tableview 时，会抛出异常，`iv.image = image;`因为 iv 已被释放。确保我从不尝试为已释放单元格设置图像的最佳方法是什么？重新加载 tableview 时，是否有某种方法可以杀死任何挥之不去的异步加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:29:26.740

我会以另一种方式实施。在构建单元格时尝试从缓存中获取图像。如果未找到图像，则触发异步下载并通知单元或控制器（来自主线程）该图像已下载。您可以使用 KVO 将单元格与图像缓存连接起来。

# asp.net - 使多行文本框记住文本输入（自动完成）

> ID：12806925
> 
> 赞同：0
> 
> 时间：2012-10-09T19:21:14.380
> 
> 标签：asp.net, autocomplete, textbox, textarea, multiline

普通的 asp.net 文本框会记住您的旧输入 - 如果您在文本框中输入内容并离开页面，然后返回并输入相同的内容。文本框将通过建议您上次输入的内容来“自动完成”您正在输入的内容。

我可以看到，如果您将 Textmode 属性设置为“多行”，那么文本框就会丢失它的自动完成功能。像这样：

```
<asp:TextBox ID="TextBox_Description"  TextMode="MultiLine" MaxLength="500"   runat="server"></asp:TextBox> 
```

如何将此功能添加到我的多行 asp 文本框或 TextArea 中？（多行文本框呈现为文本区域）。

我对 asp.net 特定解决方案和 javascript/jquery 解决方案都持开放态度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T20:32:16.873

您可以检索多行文本框中的内容，然后将其缓存并在回发时使用缓存输出之前使用的内容。

```
// Get everything in the multiline text box and cache it
Cache["multilineValues"] = TextBox_Description.Text;

// Output what was written again through cache etc when the page loads after a postback. 
//You would most likely put this in the Page_Load method.
if(IsPostBack)
{
    if(Cache["multilineValues"] != null)
    {
      //Use what was written before
      TextBox_Description.Text = (string)Cache["multilineValues"];
    }
} 
```

# math - 集成和 dx

> ID：12806926
> 
> 赞同：0
> 
> 时间：2012-10-09T19:21:14.900
> 
> 标签：math, integration

我正在为 iOS 编写一个计算器，需要知道一件非常基本的事情：积分 wrt 是否`x`附加了 a`dx`或 a`δx`以及为什么？我知道`δ`是一个非常小的值，而 a`dx`是一个非常小的值，但哪个是正确的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T19:41:42.770

dx 是正确的表示法。[维基积分](http://en.wikipedia.org/wiki/Integral)

# unit-testing - Grails Spring 安全测试

> ID：12806931
> 
> 赞同：5
> 
> 时间：2012-10-09T19:21:47.297
> 
> 标签：unit-testing, testing, grails, spring-security

我为我的项目使用了 Grails Spring Security 插件，现在想要对我的代码进行单元测试。我的控制器中有以下代码：

```
def index() {
    redirect action: 'show', params: [id: springSecurityService.currentUser.id]
} 
```

我的测试类有以下代码：

```
void testIndex() {      
    controller.index()
    assert "/user/list" == response.redirectedUrl
} 
```

此测试失败：

```
| Running 8 unit tests... 1 of 8
| Failure:  testIndex(xxx.UserControllerTests)
|  java.lang.NullPointerException: Cannot get property 'currentUser' on null object
    at xxx.UserController.index(UserController.groovy:12)
    at xxx.UserControllerTests.testIndex(UserControllerTests.groovy:19) 
```

如何在测试用例中验证 Spring Security 用户？您将如何编写单元测试？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-09T19:37:56.263

您必须使用功能测试来确保安全。单元测试使用模拟但没有可用的插件或真正的请求。Spring Security 是使用过滤器链实现的，因此您需要一个真正运行的服务器。如果你使用模拟，你只是在测试模拟。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-09T19:37:19.853

对于这么简单的事情，我不会为复杂的模拟而烦恼，一个简单的

```
controller.springSecurityService = [currentUser:[id:1]] 
```

就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:34:26.537

您的引用似乎`springSecurityService`为空。只要您的控制器中有一个名为 的字段`springSecurityService`，就应该注入它。您是否仅在索引方法中将其用作局部变量并且没有将其声明为字段？

我`UserController`的如下：

```
class UserController {

    /**
     * Dependency injection for the springSecurityService.
     */
    def springSecurityService

    ....
 } 
```

**更新**

根据您对此答案的评论，您确实`springSecurityService`在控制器中声明了一个字段。我拿了我的工作应用程序并尝试了一个测试，该测试用我的控制器方法反映了你的应用程序：

```
@TestFor(UserController)
class UserControllerTests {

    void testSomething() {
        controller.register()
    }
} 
```

我也得到了 NullPointerException。根据 Burt 的回答，（我不知道），我认为该`springSecurityService`实例在单元测试执行的上下文中为空。

# gwt - GWT 和 Google Eclipse 插件：是否可以在单独的 JVM 中运行服务器？

> ID：12806944
> 
> 赞同：1
> 
> 时间：2012-10-09T19:22:26.767
> 
> 标签：gwt, gwt-rpc

我有一个包含 GWT UI 和服务器后端的 GWT 项目。服务器后端包含通过 GWT 的 RPC 向 UI 公开的[Java GWT 服务。](https://developers.google.com/web-toolkit/doc/latest/DevGuideServerCommunication#DevGuideRemoteProcedureCalls)

由于项目已经发展了很多，后端需要越来越多的时间来启动，我正在考虑将 UI 移动到一个单独的项目中，并考虑*在一个单独的 VM 中运行后端*。后端比较稳定，也是我们花时间最多的UI。将两者放在不同的 VM 中，我们可以更有效地处理 UI，因为我们只会重新加载 UI（在 GWT 开发模式下）并让后端保持运行。

**我的问题：**是否可以配置 Google Eclipse 插件，使其在单独的虚拟机中运行 UI 和后端，并且我仍然可以使用 GWT 开发模式？

该项目使用 GWT 2.4，一旦发布，我们将更新到 2.5。我们使用 Maven 作为构建系统。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T19:43:10.937

有两点需要考虑：

1.  您不必总是重新加载服务器 - 通常只需重新加载浏览器页面就足够了 [*] 有关何时重新加载/重新启动的概述，...请参阅[https://stackoverflow.com/a/6150736/ 291741](https://stackoverflow.com/a/6150736/291741)
2.  您可以部署到外部服务器。在 Eclipse 运行配置中，转到“服务器”选项卡，然后取消选中“运行内置服务器”。这将禁用 Web 服务器（默认端口 8888），但仍将运行代码服务器（默认端口 9997，请参阅 GWT 选项卡）。然后只需在端口 8888 上运行您的外部服务器（例如 Tomcat）。它应该为 Web 内容提供服务，并处理 servlet 请求。

如果您想创建一个非常酷的全自动 Eclipse-JavaEE + GWT 设置，并在您喜欢的任何服务器上进行单独的服务器端重新部署（即使需要两个调试器实例），请参阅[https://stackoverflow.com/a /11700678/291741](https://stackoverflow.com/a/11700678/291741)

[*] 我知道，在某些情况下，例如在更改 Gin 配置或验证注释时，不幸的是，重新加载网页是不够的。但在大多数情况下，它可以正常工作（只要您使用“运行方式...”而不是“调试方式...”运行 DevMode）如果您想在附加调试器的情况下运行，那么我建议您使用当然，外部服务器解决方案。

# image - 图像未加载到部署在 webapps ROOT 文件夹中的 jsp 中

> ID：12806946
> 
> 赞同：-3
> 
> 时间：2012-10-09T19:22:34.863
> 
> 标签：image, jsp, tomcat, root

当我在tomcat 6 webapps文件夹中部署名为'myapp.war'的war文件时，jsp中的图像正在正确加载，而如果我将它部署在webapps / ROOT文件夹中，图像不会在jsp中加载。

战争文件结构

```
-- myapp
- WEB-INF
-jsp
-images 
```

在jsp页面中，images文件夹中的图像被称为

```
<img src="images/img1.png"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T11:35:04.133

您应该使用绝对路径来引用图像。如果您在其中包含[contextPath](https://stackoverflow.com/questions/5850336)，即使您的应用程序路径发生更改，该链接也应该有效。尝试

```
<img src="${pageContext.request.contextPath}/images/mobile.png" height="34" width="38" alt="mobile" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T06:24:00.300

我终于找到了解决方案。

当代码部署在 ROOT 内或将 war 部署在 webapp 内并通过更改 tomcat server.xml 中的上下文作为 ROOT 应用程序时会发生什么

 *无论哪种方式，tomcat 都在考虑，就像完整的战争内容直接在 tomcat webapp 文件夹中一样。

我已经在 webapps 中直接有一个名为 images 的文件夹（出于其他目的），因为 images 文件夹被覆盖了。当我删除/重命名该文件夹时，预期的图像（从 jsp 调用的图像）开始出现。*

# javascript - 在 OnClick 中防止 OnServerClick？

> ID：12806948
> 
> 赞同：1
> 
> 时间：2012-10-09T19:22:40.433
> 
> 标签：javascript, asp.net, onclick, postback, dom-events

我正在使用 ASP.NET，并且我有一个同时具有 onclick 和 onserverclick 的链接。两者都很重要，但我希望 onclick 尽可能阻止 onserverclick 运行。

这是我目前正在玩的项目：

```
 <ul class="clickables">
        <asp:Repeater ID="MenuRepeater" runat="server">
            <HeaderTemplate>
            </HeaderTemplate>
            <ItemTemplate>
                <li class=" <%# ((DataRowView)Container.DataItem)["CSSClass"]%>" 
                    style="background-color: <%# ((DataRowView)Container.DataItem)["BackgroundColour"]%>">
                    <a id="A1" 
                        runat="server" 
                        onserverclick="LinkClick"
                        onclick=<%# "return javascript:LinkClick('" + ((DataRowView)Container.DataItem)["Postback"] + "')" %>
                        customid='<%# ((DataRowView)Container.DataItem)["UniqueID"]%>'
                        href='<%# ((DataRowView)Container.DataItem)["PageFile"]%>'>
                    </a>
                    <%# ((DataRowView)Container.DataItem)["DisplayName"]%>
                </li>
            </ItemTemplate>
            <FooterTemplate>
            </FooterTemplate>
        </asp:Repeater>
    </ul> 
```

这是我希望停止回发的 JS：

```
function LinkClick(parameters) {
    if (parameters[0] == "False") {
        return false;
    } 
```

我错过了什么吗？这甚至可能吗？我知道我可以通过在 onclick 中返回 false 来阻止正常的回发，但是我可以停止 onserverclick 吗？

***更新*** 在调试了一些之后（离开 webdev 一段时间......），JS 函数没有触发......

***更新 2***

这是完整呈现的页面源：

```
<!DOCTYPE html>
<link rel="stylesheet" type="text/css"
    href="iphone.css" />

<link href="MenuStyles.css" rel="stylesheet" type="text/css">
<meta name="viewport" content="user-scalable=no, width=device-width" />
<script type="text/javascript" src="mootools-core-1.4.5-full-nocompat-yc.js"></script>
<html xmlns="http://www.w3.org/1999/xhtml">
<head><title>

</title></head>
<body>
    <form method="post" action="Main.aspx" id="form1">
<div class="aspNetHidden">
<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="YkYtJBVbLo0YmPPXHO5sO8FI5kAxszDeDe/bdeHgDCummp4bGaZKj3W6ihINzdq9PFQT6uCqE2eRXLhF1OEeKh8qJgRJnXWiisrDZ2ivw6JISfxuhIFP1VKKrZET9NIJqrJKpS2namuXzQL+yDJG8WGGvDrQ7oEBMDT6seSXr3zoowlA6tB4+gdbsPJ4utvNKCrhhTImpeXTzeaYCNV3t8QzsiGA7wK51Pgqo9vFQ6LH31NRYJEJ/yfhnnUcoSG6YR8SHNp+j7cGMVMoZPpgLu4bcMNSixHjGW+yin4YN7sf4wtXqQHIGFOwbSHM0VcAxd3is4lUJVYMoBH4pqAjjgBZMuaXPHwDfmZZk3Dk8feyn2btCh0nwXUrkAiAf8n1+a3hs9VfR0JeNs6x0WVzlMxgm4JFzIkthXtJ+632NaNh4rJyvib+j/Vs+HjtRFQXaIDj1fXp2KFniReSjZANiBaepyJqozJghhYnEB8MP1ZOePmrrbLCxUl1MD5Wn2bgFKkNSK25NC1hQoXdnZbEeA==" />
</div>

<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['form1'];
if (!theForm) {
    theForm = document.form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>

<div class="aspNetHidden">

    <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="zxCYbgjQBAQXVsCg6EwWqRNbeqa/5PzOIgwdhVB5mEasbEk06ik+VT9njAhsM8vF0ymfwdsNmbuX2R7iMJjdpqLMAVABvva4eorpK2PdajpD+g2RzFXI5SEEG9VjwQUXf3kKgb0KnPjWGYQdgZHGDQ==" />
</div>
    <div>
        <div class="button">Back</div>
        <div class="button-bold">+</div>
        <h1>AAR</h1>
        <h2 id="lblQuestion">Please wait for a question...</h2>
        <ul class="clickables">

                    <li class=" arrow" 
                        style="background-color: White">
                        <a id="MenuRepeater_A1_0" onclick="return&#32;LinkClick(&#39;True&#39;)" customid="80f03602-cb67-4d46-99ea-4200459e6a48" href="javascript:__doPostBack(&#39;MenuRepeater$ctl01$A1&#39;,&#39;&#39;)">
                        </a>
                        Question 1
                    </li>

                    <li class=" " 
                        style="background-color: LightGray">
                        <a id="MenuRepeater_A1_1" onclick="return&#32;LinkClick(&#39;False&#39;)" customid="91f76613-ecaa-47df-a5d6-5a921935b1f9" href="javascript:__doPostBack(&#39;MenuRepeater$ctl02$A1&#39;,&#39;&#39;)">
                        </a>
                        Question 2
                    </li>

        </ul>
        <ul class="clickables">

        </ul>
    </div>
    </form>
    <script>
        $$('.clickables').each(function(clickable) {
            var list = clickable.getElements('li');

            list.addEvent('click', function() {
                var link = this.getElement('a');
                if(this.getFirst('a')) {
                    window.location = link;
                }
            });
        });

        function LinkClick(parameters) {
            if (parameters[0] == "False") {
                return false;
            }
            return true;
        }
    </script>
</body>
</html> 
```

***编辑 3***

即使我这样做：

```
onclick='return LinkClick(False)' 
```

或者

```
onclick="return LinkClick(False)" 
```

我仍然得到：

```
onclick="return&#32;LinkClick(&#39;True&#39;)" 
```

***编辑 4***

这是当前渲染的源：

```
<!DOCTYPE html>
<link rel="stylesheet" type="text/css"
    href="iphone.css" />

<link href="MenuStyles.css" rel="stylesheet" type="text/css">
<meta name="viewport" content="user-scalable=no, width=device-width" />
<script type="text/javascript" src="mootools-core-1.4.5-full-nocompat-yc.js"></script>
<html xmlns="http://www.w3.org/1999/xhtml">
<head><title>

</title></head>
<body>
    <form method="post" action="Main.aspx" id="form1">
<div class="aspNetHidden">
<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="ATtNaDBRU6vswFif62qens2E35fTb32GNoGWb9g2UFbg0Pli0sVNrzGeLKgFI41ojer32c0dUpY2F54DIn0L0dQgi7XFwJCum71RivEO8THI+xsj3ACip5IKj0hPTlB0mDtjRUcRAPxTUDJlxNB2ZvpP1nAR8i7b/tsSrF5sP3Xx3JOb59POn4nxVDOTm80j0OAolK09Mo0leI9EzyQWbpig8Q8FaT7eKzCoJ1Z40TNWX24ZKsxsND4ebBfakOnI8qd2lNdBcJ9FrhBCTEJDCQksXs/rhyJXkksaonPGNFdtWMpiIyQDGkT0V6Q+CPt5fFnZZp4fbKZyRVMcs6XdxwHG3qTYJJgnDbfSvnswKce7la8JVSxoWy+dufG6gxIfJK2rKw0mhfQ21y90ZtkaKZ4CeZWB4TveHRhYJVlinC7bwXwKJGXhqcHJeJ0IoinTS+ZgsbuJOo3zHCslpWThP+ib7IVpmFx+nluy31L65Zy7dVoSZeySboBq10C9e1D3Tm0K5Pvcn/ovG7NmRupa+vgrcYEWQgb6QKym1aartoVmtPm1dWZiJzwA9X7j7Wn5mus2XrE5SXqbvp0bANO1rQ==" />
</div>

<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['form1'];
if (!theForm) {
    theForm = document.form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>

<div class="aspNetHidden">

    <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="vi/Uef51SWAjwpFRuN3fwE5Y2FDB84KMHL6HjRIbWSKMEsSrg2RiGbteExTKFCbKhGe16A7xsn6DzMULMalMxqrg2yi9wkWZb0w2ifgCG6mmU0fH3V6zELQeACrtHDQ+4YlxeZ8k7HfGC592ammq3g==" />
</div>
    <div>
        <div class="button">Back</div>
        <div class="button-bold">+</div>
        <h1>AAR</h1>
        <h2 id="lblQuestion">Please wait for the question...</h2>
        <ul class="clickables">

                    <li class=" arrow" 
                        style="background-color: White">
                        <a id="MenuRepeater_A1_0" onclick="return LinkClick(True);" customid="b88d214b-0d1c-4986-821e-c1650ffbdbfd" href="javascript:__doPostBack(&#39;MenuRepeater$ctl01$A1&#39;,&#39;&#39;)">
                        </a>
                        Question 1
                    </li>

                    <li class=" " 
                        style="background-color: LightGray">
                        <a id="MenuRepeater_A1_1" onclick="return LinkClick(False);" customid="d566775f-4bee-4069-adb0-27e8cf8057d9" href="javascript:__doPostBack(&#39;MenuRepeater$ctl02$A1&#39;,&#39;&#39;)">
                        </a>
                        Question 2
                    </li>

        </ul>
        <ul class="clickables">

        </ul>
    </div>
    </form>
    <script>
        $$('.clickables').each(function(clickable) {
            var list = clickable.getElements('li');

            list.addEvent('click', function() {
                var link = this.getElement('a');
                if(this.getFirst('a')) {
                    window.location = link;
                }
            });
        });

        function LinkClick(parameters) {
            if (parameters[0] == "False") {
                return false;
            }
            return true;
        }
    </script>
</body>
</html> 
```

***更新 5***

因此，如果我离开该方法并仅返回 true/false，它应该停止回发吗？这不起作用（更多渲染源）。

```
<!DOCTYPE html>
<link rel="stylesheet" type="text/css"
    href="iphone.css" />

<link href="MenuStyles.css" rel="stylesheet" type="text/css">
<meta name="viewport" content="user-scalable=no, width=device-width" />
<script type="text/javascript" src="mootools-core-1.4.5-full-nocompat-yc.js"></script>
<html xmlns="http://www.w3.org/1999/xhtml">
<head><title>

</title></head>
<body>
    <script>
        function LinkClick(parameters) {
            if (parameters[0] == "False") {
                return false;
            }
            return true;
        }
    </script>
    <form method="post" action="Main.aspx" id="form1">
<div class="aspNetHidden">
<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="PiZp7nhFhCoiWV3slT5szv5Z5GAkeDWYHj7QpAPmnwSoKxWg6Zm9HTQGkZXS2Osddx6KwS0eGu/ZMaLjgxVBm1U+Eszzf/OjmAbB78jPAeSwW8GwXRUUp984a7cPZc9cYajKHkhBVtuuALV6HSsT3oRzEPlziohjgWGiV8HFAEOd1CWTj+RAC3B/mWcmrFcexzpR1XhQgnV5LQC7GplUB9Y2E/rb8MFQHfYsRxG5GjWJ5zqe51FhwstLL/dbSklaBkRlFHyFyZNUeA74My6AHCOAWbUjZ42sVcMjaSVnM1zZsxQtSG8+UdbshaLZ9Gz5SOB0Vq4fS8J+TrUlswsSLqQ77Q+m2ouZG+jhPf7jKC59KvIYGlKHkgYVqCvhqhkIG91xg7k9M3f5KAf0yOB6yaesVxnWBCC+UQWcKRePIV9tq2eE8C+8F+rLCPJ6RXgUzpC+DvVmlQMHzmiXWLehtymb2HRX4O/2RUJxLDlVP/8=" />
</div>

<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['form1'];
if (!theForm) {
    theForm = document.form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>

<div class="aspNetHidden">

    <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="aQDXp34k4YJiEBt3URBFL0do/c8NXsEmuBtFz8JLRhtXerYXPFYRZmyXIpCef68aO7itJ4EUwQ9eXl2KkxDndTmS4149nNN8BX3AoFLDgB0b4w6cNsn3nzoZ3ENnU4vExyeHdXVJyyVwmZruhoQ7GA==" />
</div>
    <div>
        <div class="button">Back</div>
        <div class="button-bold">+</div>
        <h1>AAR</h1>
        <h2 id="lblQuestion">Please wait for a question...</h2>
        <ul class="clickables">

                    <li class=" arrow"
                        style="background-color: White">
                        <a id="MenuRepeater_A1_0" onclick="return true;" customid="b88d214b-0d1c-4986-821e-c1650ffbdbfd" href="javascript:__doPostBack(&#39;MenuRepeater$ctl01$A1&#39;,&#39;&#39;)"></a>
                        Question 1
                    </li>

                    <li class=" "
                        style="background-color: LightGray">
                        <a id="MenuRepeater_A1_1" onclick="return false;" customid="d566775f-4bee-4069-adb0-27e8cf8057d9" href="javascript:__doPostBack(&#39;MenuRepeater$ctl02$A1&#39;,&#39;&#39;)"></a>
                        Question 2
                    </li>

        </ul>
        <ul class="clickables">

        </ul>
    </div>
    </form>
    <script>
        $$('.clickables').each(function (clickable) {
            var list = clickable.getElements('li');

            list.addEvent('click', function () {
                var link = this.getElement('a');
                if (this.getFirst('a')) {
                    window.location = link;
                }
            });
        });
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T21:38:57.020

非常感谢大家的帮助。问题是 .NET 的 XSS 东西（内置，通过配置文件自动与你搞砸..）

一旦我删除了这条线，它就起作用了，我想我将服务器变量放入 JS 的方式让我的网站认为它受到了攻击......无论如何它都会成为一个私人网站，所以 XSS 被关闭了。如果有人能找到更好的解决方案（更安全），那么请发帖，我会尝试...

```
<httpRuntime requestValidationMode="4.5" targetFramework="4.5" encoderType="System.Web.Security.AntiXss.AntiXssEncoder, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" /> 
```

^^ 从 Web.config 中删除该行（后果自负）...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T20:20:38.570

您不应该这样做`onclick=<%# .... %>`，因为它会自动对输出进行编码。

它应该是这样的：

```
<a onclick="javascript:return LinkClick('<%# ((DataRowView)Container.DataItem)["Postback"] %>')" href="something"></a> 
```

您的输出`return&#32;LinkClick(&#39;True&#39;)`甚至不是 javascript 调用。这就是为什么您看不到任何错误的原因。

有关于 asp.net 内联表达式的有用链接：http: [//support.microsoft.com/kb/976112](http://support.microsoft.com/kb/976112)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:41:32.027

你检查过`parameters[0] == "False"`吗？可能是字符串比较问题？或者可能是您的文本实际上在链接标签之外：

```
<a id="A1" 
    runat="server" 
    onserverclick="LinkClick"
    onclick=<%# "return javascript:LinkClick('" + ((DataRowView)Container.DataItem)["Postback"] + "')" %>
    customid='<%# ((DataRowView)Container.DataItem)["UniqueID"]%>'
    href='<%# ((DataRowView)Container.DataItem)["PageFile"]%>'>
</a>
<%# ((DataRowView)Container.DataItem)["DisplayName"]%> 
```

应该是：

```
<a id="A1" 
    runat="server" 
    onserverclick="LinkClick"
    onclick=<%# "return javascript:LinkClick('" + ((DataRowView)Container.DataItem)["Postback"] + "')" %>
    customid='<%# ((DataRowView)Container.DataItem)["UniqueID"]%>'
    href='<%# ((DataRowView)Container.DataItem)["PageFile"]%>'>
    <%# ((DataRowView)Container.DataItem)["DisplayName"]%>
</a> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-02T15:40:50.013

如果我理解您的问题，那么由于 onclick 事件中发生的某些事情而抑制 onserverclick 非常简单：

```
<span class="psw">Forgot <a href="" runat="server" onclick="return checkForRequiredEmailAddress();" onserverclick="ForgotPassword">password?</a></span> 
```

这是我的一个页面上的实际忘记密码链接。除非存在有效的电子邮件地址，否则永远不会触发 onserverclick 事件中指定的 ForgotPassword() 方法背后的代码。

“checkForRequiredEmailAddress”方法检查其存在、结构和正确性，然后根据检查结果返回真或假。

我知道你的问题说你试过这个，但它肯定对我有用，所以我只能假设它是愚蠢的。也许点击事件中缺少的分号会有所不同。

# php - 如何使用 php 在浏览器中将 pdf 文件的 url 显示为 jpeg 图像？

> ID：12806951
> 
> 赞同：2
> 
> 时间：2012-10-09T19:22:44.627
> 
> 标签：php, mysql, url, pdf, jpeg

我有一个 MySQL 数据库，它有几个指向 pdf 文件的 url（如 path/.../file.pdf），我想在浏览器中将它们显示为 jpeg 图像。我浏览了整个网络，但找不到解决方案。有谁知道如何做到这一点？任何帮助表示赞赏。目前我有两个文件：index.php：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>
<head>
    <meta http-equiv="Content-Type" content="application/pdf; charset=UTF-8">
    <title>Something</title>
</head>
<body>
    <h1 align="center">Something</h1>
    <img src="newindex.php" alt=" image" /></body></html> 
```

和newindex.php：

```
<?php
    header('Content-type: image/pdf;');

    $con = mysql_connect("someurl",
            "xxx","xxxx");

    if (!$con)
    {
    die('Could not connect: ' . mysql_error());
    }

    mysql_select_db("xxx", $con)or die("cannot select DB");

    $result = mysql_query("SELECT pdfurl FROM TABLE_NAME WHERE Code LIKE 'YY'");

    if($result === FALSE) {
        echo "nooooo";
    }
    echo "hey";

    while($row = mysql_fetch_array($result))
    {    
       echo '<img name="myimage" src="'.$row['pdfurl'].'" width="60" height="60" alt="word" />';
    }

    mysql_free_result($result);
    mysql_close($con); ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T19:31:16.123

如果要将其显示为 JPEG 图像，则必须将其转换为一张。有几种软件产品可以做到这一点，包括[GDlib](http://www.php.net/manual/en/book.image.php)、[ImageMagick](http://www.imagemagick.org/)和[Ghostscript](http://pages.cs.wisc.edu/~ghost/)。它们的主要区别在于与 PHP 的集成程度和图像质量。

然后，在您的 HTML 中，您将`img`使用 PHP 脚本输出标签，因为`src`它使用上述软件进行转换和缓存：

```
echo '<img src="converter.php?'.$pdf_name.'" />'; 
```

在某些浏览器中，您可以直接在页面中显示 pdf，但这是使用`embed`标签而不是标签来完成的，`img`并且通常不适合类似缩略图的视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T19:25:16.233

您的 img src 将是一个 php 页面，并且可能会使用 image_create()。此处示例：[http ://www.thesitewizard.com/php/create-image.shtml](http://www.thesitewizard.com/php/create-image.shtml)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T19:26:12.600

您必须修改您的 http 服务器。

您的 http 服务器需要使用 php 进行 .jpg 处理。

以 Lighttpd[为例](http://redmine.lighttpd.net/projects/1/wiki/Docs_ModFastCGI#Examples)。替换`.php`为`.jpg`

**或**（更好的选择）

您可以使用重写选项重写`.jpg`为`.php`

编辑：您需要在脚本中打印真实图像（二进制）作为输出。使用 AndreKR 答案

# android - 如何在 ContactsContract 中创建用户个人资料？

> ID：12806954
> 
> 赞同：6
> 
> 时间：2012-10-09T19:23:11.273
> 
> 标签：android

我正在尝试在 ContactsContract 中创建用户配置文件...因为没有，我需要一个用于测试。我没有真实的 Android 设备，只有 AVD Emulator 用于测试。

这是我正在使用的代码块：

```
ArrayList<ContentProviderOperation> ops = new ArrayList<ContentProviderOperation>();

ops.add(ContentProviderOperation.newInsert(RawContacts.CONTENT_URI)
    .withValue(RawContacts.ACCOUNT_TYPE, null)
    .withValue(RawContacts.ACCOUNT_NAME, null)
    .build());        

ops.add(ContentProviderOperation.newInsert(Data.CONTENT_URI)
    .withValueBackReference(Data.RAW_CONTACT_ID, 0)
    .withValue(Data.MIMETYPE, Profile.CONTENT_RAW_CONTACTS_URI)
    .withValue(Profile.IS_USER_PROFILE, 1)
    .build()); 

ops.add(ContentProviderOperation.newInsert(Data.CONTENT_URI)
    .withValueBackReference(Data.RAW_CONTACT_ID, 0)
    .withValue(Data.MIMETYPE, StructuredName.CONTENT_ITEM_TYPE)
    .withValue(StructuredName.DISPLAY_NAME, name)
    .build());

this.getContentResolver().applyBatch(ContactsContract.AUTHORITY, ops); 
```

如果您删除使该条目成为用户配置文件的行，它可以正常工作（即，将插入名称）。但是，我不知道如何使用 IS_USER_PROFILE 标志设置条目。

您可以从应用程序创建用户配置文件吗？如果是这样，关于为什么这不起作用的任何想法？

非常感谢！斯科特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-08-16T09:08:02.387

**@ozmank**给出了一个很好的指导 - 考虑从一个针对 API 级别 15-23 的应用程序添加一个更当前的工作示例

**我主要在三星**设备上遇到了这个问题——配置文件不存在，当它存在时可以将其删除。

1.  添加到 AndroidManifest.xml**使用****WRITE_PROFILE**的权限

     **```
    <uses-permission android:name="android.permission.WRITE_PROFILE"/> 
    ```** 
***   创建一个属于配置文件的空原始联系人 - 这将生成配置文件条目

    ```
    ContentValues values = new ContentValues();            
    context.getContentResolver().insert(Profile.CONTENT_RAW_CONTACTS_URI, values); 
    ```** 

 **从返回的 Uri 中，您可以查询原始联系人条目。

**注意**- 这不会将信息添加到配置文件中，因此如果您将使用查询配置文件以获取信息

```
Uri uri = Uri.withAppendedPath(Profile.CONTENT_URI, Contacts.Data.CONTENT_DIRECTORY);
Cursor cursor = context.getContentResolver().query(uri, null, null, null, null); 
```

结果光标将为空，如果您决定再次运行 #2 中的代码并进入股票联系人应用程序，您将在**Me 个人资料**下看到多个空条目- 所以我的建议是将我的个人资料保留为尽可能清理并跟踪您创建的原始联系人并检查它是否仍然有效 - 在创建新的原始联系人之前。

```
Uri uri = Uri.withAppendedPath(Profile.CONTENT_RAW_CONTACTS_URI, String.valueOf(lastLocalProfileManualRawId));
Cursor cursor = context.getContentResolver().query(uri, null, null, null, null);

if (cursor != null && cursor.getCount() > 0){
    // The profile exists
} else {
    // Create a new raw contact
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T08:38:16.340

var 值 = 新的 ContentValues (); values.Put (ContactsContract.Contacts.InterfaceConsts.is_user_profile,"1"); ontentResolver.Update (ContactsContract.Profile.ContentRawContactsUri,values, null, null);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-22T19:45:30.427

在模拟器中运行**联系人**应用程序并使用它设置您的个人资料。

您可能需要先添加一个常规联系人，然后才能看到“设置我的个人资料”选项。
对我来说，“添加帐户”按钮什么也没做，但屏幕右下角的 fab 按钮开始添加新的常规联系人。

添加联系人后，点击返回返回主屏幕。现在它会列出您刚刚添加的联系人以及“我”组中的“设置我的个人资料”选项，而不是说您没有联系人。**

# css - HTML5 Boilerplate - 移动 Safari 背景问题

> ID：12806960
> 
> 赞同：2
> 
> 时间：2012-10-09T19:23:45.327
> 
> 标签：css, background, mobile-safari, html5boilerplate

我绝不会假装自己是一名开发人员，但我确实会不时尝试编写我设计的网站。

我遇到了一个问题，我使用 HTML5 Boilerplate 对网站进行编码，当在桌面浏览器上时，它看起来很好（http://cl.ly/image/3j0L3Q3k3W1S），但是一旦我移动到 Mobile Safari，背景似乎被轻推了很多（http://cl.ly/image/0q0I2q1f1Y1c）。

我在另一个网站上遇到了同样的问题，所以我假设它是代码中我不知道的东西......

对此的任何帮助将不胜感激！

# powershell - 具有环境路径的 Powershell 解析文件

> ID：12806973
> 
> 赞同：2
> 
> 时间：2012-10-09T19:24:42.067
> 
> 标签：powershell, path, environment-variables

我有以下函数，它采用文件名并在本地或使用环境路径解析它。我正在寻找与命令行相同的功能：

```
function Resolve-AnyPath ($file)
{
    if ($result = Resolve-Path $file -ErrorAction SilentlyContinue)
    {
        return $result;
    }

    return ($env:PATH -split ';') |
        foreach {
            $testPath = Join-Path $_ $file
            Resolve-Path $testPath -ErrorAction SilentlyContinue
        } |
        select -first 1
} 
```

我的问题：

1.  有没有内置函数可以做到这一点？
2.  还是更好的社区脚本？
3.  我上面的功能有什么遗漏吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T21:46:23.297

对于 exes（和 $env:PATHEXT 中的其他扩展），您可以使用`Get-Command`. 它将搜索路径，例如：

```
C:\PS> Get-Command ProcExp.exe | Foreach {$_.Path}
C:\Bin\procexp.exe 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T19:52:17.013

想不出有任何内置函数可以做到这一点。我会`Test-Path`用来摆脱那些`SilentlyContinue`：

```
function Resolve-Anypath
{
    param ($file)

    (".;" + $env:PATH).Split(";") | ForEach-Object {
        $testPath = Join-Path $_  $file
        if (Test-Path $testPath) {
            Write-Output ($testPath)
            break
        }
    }
} 
```

# c# - C# DateTime 总是创建新对象？

> ID：12806974
> 
> 赞同：19
> 
> 时间：2012-10-09T19:24:42.207
> 
> 标签：c#, datetime

为什么在 C# 中我的两个变量指向不同的 DateTime 对象？

```
DateTime a1 = DateTime.Now;
DateTime a2 = a1;

a1 = a1 + TimeSpan.FromMinutes(15);
a2 = a2 - TimeSpan.FromMinutes(16); 
```

我意识到a2实际上指向一个与a1不同的新对象。

但在其他情况下。假设我有一个班级 Person，并且 age = 1;

```
Person a1 = new Person();
a2 = a1;
a2 = Person.Age = 2; 
```

在 Person Case 中，a1 和 a2 指向同一个对象。我在这里真的很困惑，任何人都可以解释一下吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-10-09T19:26:52.440

`DateTime`是一个值类型 - 一个结构。

对于值类型，当您执行以下操作时：

```
DateTime a2 = a1; 
```

`a2`获取的值的*副本*`a1`。它不是对同一个内存位置的同一个引用，而是一个完整的、单独的副本。

另一方面，`Person`是一个引用类型——一个类。

当你这样做时：

```
Person p2 = p1; 
```

对于引用类型，指向的引用与`p2`指向的引用相同`p1`。所以一个的变化就是两个的变化。

请参阅MSDN 上的[值类型和引用类型](https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-09T20:11:21.380

正如其他人已经指出的那样，`DateTime`它是一个结构，而不是一个类，因此是一个值类型。如果更改用于显示结构的文本颜色，则可以在 Visual Studio 编辑器中对此进行可视化。`Tools`在菜单>中打开对话框`Options`并导航到`Environment`>`Fonts and Colors`

[![在此处输入图像描述](../Images/ff5b95df357ef63c946842b521fbb3bf.png)](https://i.stack.imgur.com/pkMaf.png)

更改委托、枚举、接口和结构（值类型）的颜色很有帮助。

[![在此处输入图像描述](../Images/2a1b1e63aba49ad6ec02e351190a8e6a.png)](https://i.stack.imgur.com/NfCes.png)

在 Visual Studio 2019 中，您还可以更改用户成员的外观，例如常量或参数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-09T19:56:30.307

这里有两个不同的概念在起作用。第一个是`DateTime`值类型（又名结构），而`Person`[大概]是引用类型（类）。因此，当您这样做时：

```
DateTime date1 = DateTime.Now;
DateTime date2 = date1; 
```

`date2`将导致复制值，因此两个变量不会引用同一个对象。

有了课程，当你这样做时：

```
Person p1 = new Person();
Person p2 = p1; 
```

`p1`实际上不包含 a `Person`，它只包含*对 person 的引用*。然后将该引用（按值）复制到`p2`. 复制该引用的效果是两个变量现在都“指向”或“引用”同一个对象。

接下来是可变性的问题。 `Person`，在这种情况下，是一个可变类型。这意味着它可以改变。另一方面，不可变类型一旦构造就不能更改。

该行：

```
p2.Age = 2; 
```

实际上是在更改`p2`引用的对象，并且由于`p2`两者`p1`都引用同一个对象，`p1.Age`因此将`2`在该行代码之后。

现在，出于演示目的，让我们创建一个不可变`Person`类：

```
public class Person
{
    private int _age;
    public Person(int someAge)
    {
        _age = someAge;
    }

    public int Age
    {
        get { return _age; }
    }

    public Person Grow()
    {
        return new Person(_age + 1);
    }
} 
```

如果我们这样做：

```
Person p1 = new Person(1);
Person p2 = p1;
p2 = p2.Grow(); 
```

第二行和以前一样，确保两者都指向同一个对象，但第三行不同。`Grow`我们的方法不是更改（或变异）那个人以使其比他大一岁，而是*返回一个代表比他大一岁的人的新`Person`对象*。这样做之后`p2`，`p1`将不再引用同一个对象；我刚刚将对象`p2`引用更改为该`Grow`方法刚刚创建的新对象。

第二个示例与正在发生的事情非常相似`DateTime`。你不能改变一个`DateTime`对象；它是不可变的。调用它的方法（在这种情况下是加号和减号运算符）返回一个全新的对象。按照惯例，值类型不应该在没有令人信服的理由的情况下是可变的，因为处理它们通常很棘手。引用类型可以是不可变的，也可以是可变的；两者都没有重大问题（在一般情况下）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-09T19:26:26.327

这里的区别在于 DateTime 是一个值类型，我假设 Person 是一个引用类型（类）。

在值类型的变量赋值的情况下，您实际上是将内存的内容从一个位置复制到另一个位置。

但是，在引用类型的情况下，您仍然指向同一块内存。

# sql - 比较期间使用的 SQL 替换

> ID：12806975
> 
> 赞同：0
> 
> 时间：2012-10-09T19:24:45.860
> 
> 标签：sql, sql-server-2008, replace

我目前运行此查询：

```
UPDATE table1 
SET column1 = table2.columnA  
FROM table2
WHERE column2 = table2.columnA
AND column3 = table2.columnC 
```

是的，有一个重复的列，对不起。

当我交叉引用`column2`时， `table2.columnA`有机会得到`NULL`，因为`column2` **DOES NOT contains** where `/`as `table2.columnA` **may** contain`/`

我不想更改数据`table2.columnA`

据我了解，我可以`REPLACE`对字符运行此查询。

```
SELECT REPLACE ([table2.columnA],'/','-')
FROM table2 
```

有必要这不会永久改变， `table2`所以我想确保我做对了，或者看看是否有更好的方法。

现在我想结合这两个查询，但不确定如何。

```
UPDATE table1 
SET column1 = table2.columnA  
FROM table2
WHERE column2 = (SELECT REPLACE([table2.columnA],'/','-')table2.columnA)
FROM table2
AND column3 = table2.columnC 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:27:13.207

就像是

```
UPDATE table1  
SET column1 = table2.columnA   
FROM table1 
    inner join table2 
    on table1.column2 = REPLACE([table2.columnA],'/','-')
    and table1.column3 = table2.columnC 
```

# visual-studio - 安装 IE9 后 Visual Studio 2012 崩溃（故障模块 ntdll.dll）

> ID：12806979
> 
> 赞同：10
> 
> 时间：2012-10-09T19:24:54.457
> 
> 标签：visual-studio, visual-studio-2012

好的....

自从 Visual Studio RTM 在我的工作计算机上发布以来，我一直在运行它。上周五我安装/更新了 IE 到版本 9 来测试一个 JavaScript 问题。安装 IE9 并重新启动我的计算机后，Visual Studio 2012 不再工作，它打开显示起始页大约一秒钟然后崩溃。

我没有成功尝试以下方法：

1.  恢复到 IE8 - 仍然崩溃
2.  运行 devenv /SafeMode - 仍然崩溃
3.  运行 devenv /ResetSettings -- 仍然崩溃
4.  修复VS2012 - 仍然崩溃
5.  完全卸载 VS2012 并重新安装 - 仍然崩溃
6.  完全卸载 VS2012，删除所有 VS2012 文件夹和注册表项，然后重新安装 - 仍然崩溃
7.  （重新）更新到 IE9，卸载 vs2012 并重新安装 - 仍然崩溃

（每一步细致的重启无数次）

PS我无法运行系统还原，因为它“被您的管理员禁用” - 如果它对我可用，那将在上面的步骤＃4之前......

当我运行 devenv（安全模式与否）时，我在应用程序事件日志中得到以下信息：

```
Faulting application name: devenv.exe, version: 11.0.50727.1, time stamp: 0x5011ecaa
Faulting module name: ntdll.dll, version: 6.1.7601.17725, time stamp: 0x4ec49b8f
Exception code: 0xc00000fd
Fault offset: 0x00032582
Faulting process id: 0x1a6c
Faulting application start time: 0x01cda64fa375370b
Faulting application path: C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\devenv.exe
Faulting module path: C:\WINDOWS\SysWOW64\ntdll.dll
Report Id: e2a67638-1242-11e2-b5d0-78acc0b17d3e 
```

另外...如果有用的话，我有 devenv /log 的输出，但它与 App 事件日志中的内容几乎相同（粘贴在上面）

我正在运行 Windows 7 Professional x64

最后......我从谷歌发现了类似的问题，但没有一个原因与我的匹配，也没有任何修复解决我的问题。任何帮助/指导将不胜感激。

以前发现有类似问题的线程：

1.  [VS 2012 无法启动](http://social.msdn.microsoft.com/Forums/en-US/vssetup/thread/d848776a-b00f-4311-ab09-3a8777462968/)
2.  [Visual Studio 2012 RC 已停止工作](http://social.msdn.microsoft.com/Forums/da-DK/vssetup/thread/223cf50b-bd7d-43ac-8b10-69c3dec72c1d)
3.  [VS 2012 RTM 无法启动 - 无法解决已知修复](http://social.msdn.microsoft.com/Forums/en-US/vssetup/thread/1e488859-b6f2-4133-88d7-a07190502879)

关于这些链接的一些注意事项：

1.  我没有使用 VS2012 命令扩展。
2.  我正在运行 Visual Studio 2012 Ultimate RTM（不是 RC）。
3.  我的添加/删除程序中没有 Microsoft ACT 5.6 Data Collector。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-11T18:54:17.890

我解决了这个问题...

我注意到（当我回到 VS2010 中工作时）MSDeploy 不再工作。从[这个线程](https://stackoverflow.com/questions/4034712/svsbuildmanageraccessor-fails-when-publishing-in-vs2010)我重新注册了 ieproxy.dll 并且神奇地 VS2012 似乎现在打开并加载我的项目！

我猜是从 IE8 升级到 IE9 的过程中搞砸了这个注册并造成了各种麻烦。在命令行运行以下修复它。

```
regsvr32 "C:\Program Files (x86)\Internet Explorer\ieproxy.dll" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T19:08:07.373

我删除了一个“安全更新”KB2750147（在另一个之后，K278......不记得了），现在它是正确的。

# java - 经过多少次迭代 SecureRandom 将生成给定范围之间的所有数字？

> ID：12806981
> 
> 赞同：0
> 
> 时间：2012-10-09T19:24:57.203
> 
> 标签：java, random

SecureRandom 需要多少次迭代才能生成给定范围之间的所有数字。例如，我正在生成 0-9（包括两者）之间的随机数。然后经过多少次迭代，所有数字（0、1、2、...、9）至少出现一次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T19:28:23.027

假设 SecureRandom 是完全随机的（它的 Secure 部分所追求的）答案是，没有给定的数字可以保证所有数字至少出现一次。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T20:02:50.737

如前所述，无法保证产生这十个值需要多长时间。然而，概率定律确实使得它更可能需要接近 10 次迭代而不是 1,000,000 次。

我不够聪明，无法计算出实际的概率。但是，可以编写一个程序通过反复运行问题来对空间进行采样，计算每次迭代的次数，然后您可以确定，例如，50% 的时间将花费少于 n 次迭代.

只是为了好玩，我写了一些东西来尝试这个问题，将问题运行 1,000,000 次并汇总结果。运行 3 次后，我的结果显示：

*   50% 的时间，它将花费少于 27 次（包括）迭代（全部 3 次运行）。
*   90% 的时间，它将花费少于 44 次（包括）迭代（全部 3 次运行）。
*   99% 的时间，它将花费少于 66 次（包括）迭代（全部 3 次运行）。
*   99.9% 的时间，它将花费少于 88 次（包括）迭代（所有 3 次运行）。
*   每种情况下的最差运行情况不同，但 3 个值是 154 次迭代、156 次迭代和 170 次迭代。

这是我的检查代码。它使用 java.security.SecureRandom，但还包括一种使用 java.util.Random 的方法。

```
import java.security.SecureRandom;

import java.util.Map;
import java.util.Random;
import java.util.TreeMap;

public class HowLong {

    public static final int MAX_TO_GENERATE = 10;

    public static final int TOTAL_RUNS = 1000000;
    public static final int TP50 = (int)(TOTAL_RUNS * 0.50);
    public static final int TP90 = (int)(TOTAL_RUNS * 0.90);
    public static final int TP99 = (int)(TOTAL_RUNS * 0.99);
    public static final int TP99_9 = (int)(TOTAL_RUNS * 0.999);
    public static final int TP100 = (int)(TOTAL_RUNS * 1);

    public static final String[] TP_NAMES = {"TP50", "TP90", "TP99", "TP99.9", "TP100"};
    public static final int[] TPS = { TP50, TP90, TP99, TP99_9, TP100 };

    public interface RandomSource {
        int next();
    }

    public static class MathRandomSource implements RandomSource {
        private final Random rand;

        public MathRandomSource() {
            rand = new Random();
        }

        public int next() {
            return rand.nextInt(MAX_TO_GENERATE);
        }
    }

    public static class SecureRandomSource implements RandomSource {
        private final SecureRandom rand;

        public SecureRandomSource() {
            rand = new SecureRandom();
        }

        public int next() {
            return rand.nextInt(MAX_TO_GENERATE);
        }
    }

    public static int waitForTen() {

        final boolean[] found = new boolean[MAX_TO_GENERATE];
        int remaining = found.length;

        final RandomSource source = new SecureRandomSource();
        int iterations = 0;
        while (remaining > 0) {
            int next = source.next();
            if (!found[next]) {
                found[next] = true;
                remaining -= 1;
            }
            iterations += 1;
        }

        return iterations;
    }

    public static void main(String[] args) {
        System.out.println("Attempting to generate all numbers below: " + MAX_TO_GENERATE);
        System.out.println("Performing n iterations: " + TOTAL_RUNS);

        TreeMap<Integer, Integer> results = new TreeMap<Integer, Integer>();
        for (int i = 0; i < TOTAL_RUNS; i += 1) {
            Integer iterations = waitForTen();
            Integer currentCount = results.get(iterations);
            if (currentCount == null) {
                results.put(iterations, 1);
            } else {
                results.put(iterations, currentCount + 1);
            }
        }
        int currTP = 0;
        int count = 0;
        for (Map.Entry<Integer, Integer> entry: results.entrySet()) {
            count += entry.getValue();
            while (currTP < TPS.length && count >= TPS[currTP]) {
                System.out.println(TP_NAMES[currTP] + ": " + entry.getKey());
                currTP += 1;
            }
        }
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-09T19:34:37.563

正如 CrazyCasta 所说，正确答案是 - 没有给定的数字。

引用 Scott Adams 的话：这就是随机性的问题，你永远无法确定 :)

[http://dilbert.com/fast/2001-10-25/](http://dilbert.com/fast/2001-10-25/)

# scala - Scala 类型参数被推断为元组

> ID：12806982
> 
> 赞同：12
> 
> 时间：2012-10-09T19:25:08.247
> 
> 标签：scala, syntax

我突然遇到了这种（出乎我意料的）情况：

```
def method[T](x: T): T = x

scala> method(1)
res4: Int = 1

scala> method(1, 2)
res5: (Int, Int) = (1,2) 
```

为什么在两个或更多参数的情况下，方法返回并推断出一个元组但抛出关于参数列表的错误？是故意的吗？也许这种现象有名字？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T20:41:48.287

以下是[scala 编译器的摘录](https://lampsvn.epfl.ch/trac/scala/browser/scala/trunk/src/compiler/scala/tools/nsc/typechecker/Typers.scala?rev=21919#L2216)：

```
/** Try packing all arguments into a Tuple and apply `fun'
 *  to that. This is the last thing which is tried (after
 *  default arguments)
 */
def tryTupleApply: Option[Tree] = ... 
```

这里是[相关的问题：规范没有提到自动元组](https://issues.scala-lang.org/browse/SI-3583)

这一切都意味着在上面的书面示例（一个参数的类型参数化方法）中，scala 试图将参数打包到元组中并将函数应用于该元组。进一步从这两条简短的信息中，我们可以得出结论，**语言规范中没有提到**这种行为，人们讨论为自动元组添加编译器警告。这可能被称为**自动元组**。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T07:16:38.563

```
% scala2.10 -Xlint

scala> def method[T](x: T): T = x
method: [T](x: T)T

scala> method(1)
res1: Int = 1

scala> method(1, 2)
<console>:9: warning: Adapting argument list by creating a 2-tuple: this may not be what you want.
        signature: method[T](x: T): T
  given arguments: 1, 2
 after adaptation: method((1, 2): (Int, Int))
              method(1, 2)
                    ^
res2: (Int, Int) = (1,2) 
```

# linux - Unix命令转义空格

> ID：12806987
> 
> 赞同：33
> 
> 时间：2012-10-09T19:25:28.900
> 
> 标签：linux, shell, unix

我是 shell 脚本的新手。有人可以用命令帮助我用“\”转义空格吗？我有一个变量 FILE_PATH=/path/to my/text file ，
我想单独转义空格 FILE_PATH=/path/to\ my/text\ file

我尝试使用 tr -s 命令，但没有帮助

文件路径=`echo FILE_PATH | tr -s " " "\\ "`

有人可以提出正确的命令吗！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-10-10T02:14:54.433

如果您使用的是 bash，则可以使用其内置 printf 的 %q 格式化程序（输入`help printf`bash）：

```
FILENAME=$(printf %q "$FILENAME") 
```

这不仅会引用空格，还会引用 shell 的所有特殊字符。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-09T19:28:37.233

使字符串安全不仅仅是转义空格，但您可以通过以下方式转义空格：

```
FILE_PATH=$( echo "$FILE_PATH" | sed 's/ /\\ /g' ) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-10T02:37:52.753

您可以使用“*单引号*”对包含空格的路径进行操作：

`cp '/path/with spaces/file.txt' '/another/spacey path/dir'`

`grep foo '/my/super spacey/path with spaces/folder/*'`

在脚本中：

```
#!/bin/bash

spacey_dir='My Documents'
spacey_file='Hello World.txt'
mkdir '$spacey_dir'
touch '${spacey_dir}/${spacey_file}' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-09T19:28:52.920

你可以这样做`sed`：

```
NEW_FILE_PATH="$(echo $FILE_PATH | sed 's/ /\\\ /g')" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-10T06:43:49.587

使用引号保留空格字符

tr 仅用于将单个字符 1 替换为 1。似乎是您需要 sed。

```
echo $FILE_PATH | sed -e 's/ /\\ /' 
```

似乎做你想做的事。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-01-20T10:56:42.533

Do not forget to use **eval** when using printf guarding.

Here's a sample from Codegen Script under Build Phases of Xcode (somehow PROJECT_DIR is not guarded of spaces, so build was failing if you have a path with spaces):

```
PROJECT_DIR_GUARDED=$(printf %q "$PROJECT_DIR")
eval $PROJECT_DIR_GUARDED/scripts/code_gen.sh $PROJECT_DIR_GUARDED 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2012-10-09T19:29:25.167

```
FILE_PATH=/path/to my/text file
FILE_PATH=echo FILE_PATH | tr -s " " "\\ " 
```

第二行必须是

```
FILE_PATH=echo $FILE_PATH | tr -s " " "\\ " 
```

**但我认为这不重要。一旦你到了这个阶段，你就太晚了。变量已设置，空格被转义或变量不正确。**

FILE_PATH='/路径/到我的/文本文件'

# ruby-on-rails - 哪些网站提供现代 Rails 托管

> ID：12806990
> 
> 赞同：0
> 
> 时间：2012-10-09T19:25:39.823
> 
> 标签：ruby-on-rails, ruby, list, hosting, shared

是否有支持最新 ruby​​ Rails 版本的共享托管站点列表。我能找到的唯一一个著名的显然是 DreamHost，除此之外，大多数似乎都有古老的版本。我不是在问哪个更好，我只是在问一个客观的质量，即版本号。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:34:19.097

在这里查看我的答案：[Ruby on Rails 的最佳托管（截至 2012 年）](https://stackoverflow.com/questions/11436930/best-hosting-for-ruby-on-rails-as-of-2012/11437013#11437013)

这是一个非常最新的列表，其他答案也应该有帮助。

# ruby-on-rails - Rails：通过多对多关联查找实体

> ID：12806991
> 
> 赞同：3
> 
> 时间：2012-10-09T19:25:40.453
> 
> 标签：ruby-on-rails, performance, many-to-many, associations

我有一个模型 A 和一个模型 B。A `has_and_belongs_to_many`Bs，反之亦然。

现在，我想在 A 中找到一个对象/实体，该对象/实体具有 B 中的某些对象（比如 B1 和 B2）。我怎样才能在 Rails中*有效地做到这一点？*我目前的解决方案是这样的：

```
A.all.select {|a| a.bs.sort == [B1, B2]}.first 
```

它基本上遍历A 中的*所有*对象并检查它是否`has_and_belongs_to`是正确的 B。那是非常低效的。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T20:54:44.817

您可以使用嵌套子查询来做到这一点，这是一种可行的解决方案，但不一定是*有效*的解决方案，因此您必须运行一些基准测试。

以下涉及在`A`和之间的 join_table 上执行的三个嵌套查询`B`。您首先确定所有不是or的 id `B`（称为这些） 。然后，您确定哪些与这些有关系并调用它们。所有不在其中的 's正是我们想要的（称它们为）。一旦你刚刚查询了表。`excluded_bs``B1``B2``A``excluded_bs``excluded_as``A``excluded_as``included_as``included_as``A`

```
excluded_bs = %(SELECT B_id FROM join_table WHERE B_id NOT IN (:included_bs))
excluded_as = %(SELECT A_id FROM join_table WHERE B_id IN (#{excluded_bs}))
included_as = %(SELECT A_id FROM join_table WHERE A_id NOT IN (#{excluded_as}))

A.where("id IN (included_as)", :included_bs => [B1.id, B2.id]) 
```

这应该为您提供与 和 有关系的所有' `A`s ，但不与任何其他人有关系。您可能可以稍微清理一下并使其更有效率，但它至少应该可以工作。`B1``B2`

编辑：

哎呀！要修剪那些只有`B1`or`B2`的部分，请尝试`GROUP BY`. 将最后一个子查询更改为

```
included_as = %(SELECT A_id, COUNT(*) as Total FROM join_table WHERE A_id NOT IN (#{excluded_as}) GROUP BY A_id HAVING Total = :count) 
```

和主要查询

```
Bs = [B1, B2]
A.where("id IN (SELECT A_id FROM (#{included_as}))", :included_bs => Bs.map(&:id), :count => Bs.count) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T20:22:42.447

您可以过滤 habtm 关联：

```
A.joins(:bs).where("bs.id" => [B1, B2]).first

A.joins(:bs).where("bs.id" => [B1, B2]).all 
```

为确保只返回恰好具有两个关联的项目，请使用

```
A.joins(:bs).where("bs.id" => [B1, B2]).group("as.id HAVING COUNT(bs.id) = 2") 
```

# python - 我如何告诉fabric当前站点具有哪个角色？

> ID：12806992
> 
> 赞同：1
> 
> 时间：2012-10-09T19:25:43.397
> 
> 标签：python, fabric

我在 fabfile.py 中只有一个命令：

```
@role('dev')
def test():
    local('...') 
```

现在，我可以`--role=dev`在每个命令中使用，但这非常愚蠢。

我想要的是将我的项目安装在主机中一次，具有一定的角色，然后使用它而不重复此参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T22:38:33.113

我通常在我的 fabfile.py 中包含以下内容：

```
if not len(env.roles):
    env.roles = ["test"] 
```

这表示如果 env.roles 没有定义（例如通过命令行），在我的例子中它应该被定义为“测试”。因此，在您的情况下，我会更改上述内容以代替`dev`，`test`因此您将拥有：

```
if not len(env.roles):
    env.roles = ["dev"] 
```

通过这样做，您应该会发现您获得了您正在寻找的行为，同时为您提供了在未来任何时候想要覆盖的能力。

编辑：我正在编辑它以包含一个小示例 fabfile.py 和用法说明。

```
env.roledefs = {
    'test': ['test.fabexample.com'],
    'stage': ['stage.fabexample.com'],
    'prod': ['web01.fabexample.com', 'web02.fabexample.com', 'web03.fabexample.com'],
}
# default role will be test
env.roles = ['test']

def git_pull():
    run("git pull")

def deploy():
    target = "/opt/apps/FOO"
    with cd(target):
        git_pull()
    sudo("service apache2 restart") 
```

现在这个 fabfile 将允许我将代码部署到**三个**不同环境中的任何一个：“test”、“stage”或“prod”。我通过命令行选择要部署到的环境：

```
fab -R stage deploy 
```

或者，

```
fab --role=stage deploy 
```

如果我**没有**指定角色结构，则由于`env.roles`已设置，因此将默认为“测试”。并不是说 fabric 不用于对本地盒子做任何事情，而是它作用于定义的本地盒子（或盒子），`env.roledefs`尽管经过一些修改，它也可以在本地工作。

通常，fabric 命令用于从开发盒远程执行这些操作在测试、暂存或生产盒上，因此通过命令行指定角色并不是“非常愚蠢”，但在这种情况下是设计使然。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T20:21:48.583

您可以使用[env.roledefs](http://docs.fabfile.org/en/1.4.3/usage/execution.html#roles)将角色与主机组相关联。

# sql - SSIS 条件过滤器按位数据类型拆分

> ID：12806994
> 
> 赞同：-1
> 
> 时间：2012-10-09T19:25:46.997
> 
> 标签：sql, sql-server-2008, ssis, ssis-data-types

数据 - 来自表（58 列），在此表中，4 列将用于条件过滤器。

1 列 - 位数据类型（Color_Ind）

1 列 - 位数据类型（Type_ind）

2 列 - varchar 数据类型（区域、州）

处理步骤 1) OLE DB 连接提取所有数据

2）使用数据转换将位类型列转换为字符串数据类型。

3）使用条件过滤器将数据过滤成5个不同的类别。

问题：- - 如果我使用 color_ind 和 Type_ind 它不会创建我想要的输出，但是如果我在没有这些列的情况下使用它并且只使用 Region 和 state 它将创建我想要的输出。

您能否告诉我如何在 SSIS 中将位数据类型用于条件过滤器？

感谢你的帮助。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T21:05:15.793

我从[http://social.msdn.microsoft.com/Forums/en-US/sqlintegrationservices/thread/a0c4dbe0-bbe1-421f-b2fe-b72dce4d224e](http://social.msdn.microsoft.com/Forums/en-US/sqlintegrationservices/thread/a0c4dbe0-bbe1-421f-b2fe-b72dce4d224e)帖子中获得了答案...

感谢您的努力。

# php - PHP：用数组调用方法？

> ID：12806995
> 
> 赞同：0
> 
> 时间：2012-10-09T19:25:53.637
> 
> 标签：php, arrays, methods, callback, call

不太清楚如何更好地表达标题。

我需要做的是用 call_user_func 调用一个方法。我调用的方法接受几个不同的变量（var1、var2、var3 等），而不是数组。问题是，在调用函数时，我需要将我拥有的数组作为单独的变量传递给方法。我来给你展示。

这是我的方法：

```
class Test {

    public function testing_cronjob($p1, $p2, $p3, $p4, $p5) {
        echo 'p1 = ' . $p1 . '<br />';
        echo 'p1 = ' . $p2 . '<br />';
        echo 'p1 = ' . $p3 . '<br />';
        echo 'p1 = ' . $p4 . '<br />';
        echo 'p1 = ' . $p5 . '<br />';
    }
} 
```

这就是我目前（尝试）如何称呼它：

```
$obj = new Test();
call_user_func(array($obj, 'testing_cronjob'), $params); 
```

该方法运行，但它只得到一个变量，这不是我想要的。

$params 看起来像这样：

```
$params = array(
    0 => 'first one',
    1 => 'second one',
    2 => 'third param!',
    3 => 'oh and im fourth!!',
    4 => 'im last, fml! :('
) 
```

我让自己陷入这种情况的方式是因为我正在创建一个 cronjob 模型。它接受参数以及类和方法名称。它全部存储在数据库中，当它运行时，我需要能够按预期将 $params 发送到方法。

我无法重写方法接受变量的方式，因为那样做的工作量太大了。我将从 cronjob 中调用几个 (10+) 方法，所有这些方法都在应用程序中得到了很好的使用。我也不确定我将如何重写它，但如果您对此有任何建议，请告诉我。

另外，如果这很重要，我正在使用 codeigniter。如果我忘记提及任何内容或者您想要更多代码，请发表评论。

这可能吗？有什么解决方法吗？欢迎任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:28:00.727

您必须[`call_user_func_array`](http://php.net/manual/en/function.call-user-func-array.php) 改用：

```
$obj = new Test();
call_user_func_array(array($obj, 'testing_cronjob'), $params); 
```

# jquery - 如何选择具有特定属性的可见元素

> ID：12806998
> 
> 赞同：1
> 
> 时间：2012-10-09T19:26:04.783
> 
> 标签：jquery, html, jquery-selectors, html-lists

假设有一个 div 包含一些 'li' 元素。当我点击一个复选框时，一些元素（li）被选中。我想从 div 中可见的 li 中选择所有具有某些特定属性的 li。例如下面，假设只有前三个 li 可见，我想选择 value=ItemA 和 color=Red 的 li。

>

```
 <div id="products">
<li value="ItemA" color="Yellow"><img src="images/1.jpg"></li>
<li value="ItemA" color="Red"><img src="images/2.jpg"></li>
<li value="ItemB" color="Red"><img src="images/3.jpg"></li>
<li value="BRAND C" color="Red"><img src="images/7.jpg"></li>
<li value="BRAND D" color="Blue"><img src="images/8.jpg"></li>
<li value="BRAND A" color="Yellow"><img src="images/9.jpg"></li>
<li value="BRAND B" color="Yellow"><img src="images/10.jpg"></li>
</div> 
```

我知道这些查询。

```
$("#products").find("li:visible")      //query to find visible li

$('li[value="ItemA"][color="Red"]).hide()   // query with attribute selectors 
```

选择这样的 li 的 jquery 语句将是什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T19:31:21.523

`value`并且`color`是`li`元素的无效属性，您可以改用`data-*`属性：

```
<li data-value="itema" data-color="red"><img src="images/1.jpg"></li> 
```

然后您可以使用`:visible`选择器来选择可见元素。

```
$('#products li[data-value="itema"][data-color="red"]:visible'); 
```

这是一个长而慢的选择器，但会选择您想要的元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-09T19:31:45.833

因此，如果您想要所有可见元素`ItemA`and `Red`，只需使用

```
$('li[value="ItemA"][color="Red"]:visible') 
```

但就像@undefined 所说，你不应该使用`color`and属性，`value`而应该使用正确的[html5 数据属性](http://ejohn.org/blog/html-5-data-attributes/)和.`data-color``data-value`

```
<li data-value="ItemA" data-color="Red"><img src="images/1.jpg" /></li> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T19:33:08.703

使用`.filter()`功能

```
$('li[value="ItemA"][color="Red"]').filter(':visible'); 
```

或者

```
$('li[value="ItemA"][color="Red"]').filter(function() {
            return $(this).is(':visible');
}) 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/fCarQ/)**