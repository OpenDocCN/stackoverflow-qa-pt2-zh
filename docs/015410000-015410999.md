# StackOverflow 问答 15410000-15410999

# facebook - Graph API：获取 fql 多查询时发生未知错误

> ID：15410010
> 
> 赞同：5
> 
> 时间：2013-03-14T13:00:42.967
> 
> 标签：facebook, facebook-graph-api, facebook-fql, fql.multiquery

我在使用 PHP SDK 时遇到问题：

```
$fql="{'query1':'SELECT uid2 FROM friend WHERE uid1=me()',
         'query2':'SELECT author_uid FROM checkin WHERE author_uid IN(SELECT uid2 FROM #query1) AND page_id = $page_id'}";

     $friends= $facebook->api(array(
       'method' => 'fql.multiquery',
       'queries' => $fql,
      'access_token' => $access_token
     )); 
```

而且我使用了大量的页面 ID。

[当我在https://graph.facebook.com/fql/?access_token=AC&q=QUERIES](https://graph.facebook.com/fql/?access_token=AC&q=QUERIES)中运行此脚本时， 它运行良好。

但是当我使用 php-sdk 时，有时它可以工作，但对于某些页面，它会返回错误：

```
FacebookApiException Object
(
    [result:protected] => Array
        (
            [error_code] => 1
            [error_msg] => An unknown error occurred
        )

    [message:protected] => An unknown error occurred
    [string:Exception:private] => 
    [code:protected] => 1
    [file:protected] => /APP_PATH/base_facebook.php
    [line:protected] => 1249
    [trace:Exception:private] => Array
        (
            [0] => Array
                (
                    [file] => /APP_PATH/base_facebook.php
                    [line] => 816
                    [function] => throwAPIException
                    [class] => BaseFacebook
                    [type] => ->
                    [args] => Array
                        (
                            [0] => Array
                                (
                                    [error_code] => 1
                                    [error_msg] => An unknown error occurred
                                )

                        )

                ) 
```

任何人都可以帮助我吗？我不明白为什么我会收到这个错误......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T13:05:24.750

有时，当您通过 api 拨打大电话时，facebook 会返回：

出现未知错误

例如，如果您使用 facebook 调用以获取 4000 条评论的帖子评论 `(limit = 1000)` 将返回数据，但如果您尝试`(limit = 4000)`facebook 将返回相同的错误

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-14T13:10:27.377

> 有时它可以工作，但对于某些页面，它会返回错误

你检查过你的许可吗？您可能不被允许索取该信息。

# linux - 写入securityfs文件

> ID：15410011
> 
> 赞同：0
> 
> 时间：2013-03-14T13:00:43.780
> 
> 标签：linux, security, linux-kernel

我是开发新手，我手头的任务是创建一个 securityfs 文件并通过内核安全模块向它写入一些字符串。

我使用以下代码在其中创建了 dir 和一个文件。

```
test_dir = securityfs_create_dir("test", NULL);

basc_output_file = securityfs_create_file("basc_output_file",S_IRUSR | S_IRGRP, test, NULL, &test_measurements_file_ops); 
```

但现在我无法获得任何示例或文档如何将一些字符串写入该文件。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T06:21:59.307

您的问题是关于如何实现 test_measurements_file_ops，我可以提供以下演示代码供您参考：

```
static const struct file_operations test_measurements_file_ops = {
    .write = test_write,
    .read  = test_read,
};

static ssize_t test_write(struct file *file, const char __user *buf,
                            size_t count, loff_t *ppos)
{
    char *data;
    int error;
    if (!count || count >= MAXIMUM_SIZE)
        return -ENOMEM;
    data = kzalloc(count + 1, GFP_NOFS);
    if (!data)
        return -ENOMEM;
    if (copy_from_user(data, buf, count)) {
        error = -EFAULT;
        goto out;
    }

    /* handling kaddr */

out:
    kfree(data);
    return error ? error : count;
}

static ssize_t test_read(struct file *file, char __user *buf, 
                            size_t count, loff_t *ppos)
{
    void *kaddr;
    loff_t pos = *ppos;
    loff_t len = /* strlen(kernel strings need to be copied) */;

    if (pos >= len || !count)
        return 0;
    len -= pos;
    if (count < len)
        len = count;

    /* handling */

    if (copy_to_user(buf, kaddr, len))
        return -EFAULT;
    *ppos += len;
    return len;
} 
```

# google-app-engine - 云端点 oauth2 错误

> ID：15410013
> 
> 赞同：2
> 
> 时间：2013-03-14T13:00:47.007
> 
> 标签：google-app-engine, google-cloud-endpoints

在 YouTube 上观看了 IMO 有用的 GDL 剧集后，我最近能够重构我的应用引擎应用程序以支持 Cloud Endpoints。

我正在使用 javascript 客户端测试我的网站来处理授权，然后返回最有效的项目列表。但是，当我调用端点以返回项目列表时，我的 App Engine 日志中出现了这组错误：

```
I 2013-03-14 08:52:14.748 Checking for id_token.
W 2013-03-14 08:52:14.748 id_token verification failed: Wrong number of segments in token: ya29.AHES6ZSpbeiTPTOJhCTtRdypgldcrRBQBKH8oQ8Y_FpxG5-Lr3OW6dE
I 2013-03-14 08:52:14.748 Checking for oauth token.
W 2013-03-14 08:52:14.885 Found 1 RPC request(s) without matching response (presumably due to timeouts or other errors) 
```

据我所知，谷歌返回的所有身份验证令牌中只有 2 个“段”而不是 3 个，所以我不清楚这意味着什么。

这是来自我的浏览器控制台的授权请求标头： Authorization Bearer ya29.AHES6ZSpbeiTPTOJhCTtRdypgldcrRBQBKH8oQ8Y_FpxG5-Lr3OW6dE

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-14T19:03:01.933

有两种类型的令牌：ID 令牌和标准 Bearer 令牌。

# 承载令牌：

这是通过 OAuth 舞蹈检索到的标准令牌。

# 身份令牌：

一个典型的 ID 令牌看起来像 `eyJhbGciOiJSUzI1NiIsImtpZCI6IjIxZWFlMTVkODE.eyJpc3MiOiJhY2NvdW50cy5n.oXLawgz_ed` （除了更长的段）并且是一个签名的 JWT。

可以在 JavaScript 中通过添加`'id_token'`到响应类型来获得 ID 令牌，就像在我们的井字游戏[示例](https://github.com/GoogleCloudPlatform/appengine-endpoints-tictactoe-python/blob/452dd06d1c568c2bc6ed9b82e7e7528b0be679f6/static/js/base.js#L41)中所做的那样。

这样，从OAuth 请求[返回的令牌也将有一个 ID 令牌：](https://github.com/GoogleCloudPlatform/appengine-endpoints-tictactoe-python/blob/452dd06d1c568c2bc6ed9b82e7e7528b0be679f6/static/js/base.js#L95)

```
var token = gapi.auth.getToken();
// Use id_token instead of bearer token
token.access_token = token.id_token; 
```

# 您在日志中看到的内容：

线

```
W 2013-03-14 08:52:14.748 id_token verification failed: Wrong number of segments in token: ya29.AHES6ZSpbeiTPTOJhCTtRdypgldcrRBQBKH8oQ8Y_FpxG5-Lr3OW6dE 
```

只是一个警告，意思是观察到的token`ya29.AHE...`不是IDtoken和日志中的下一行

```
I 2013-03-14 08:52:14.748 Checking for oauth token. 
```

意味着它正在继续检查令牌是否是承载令牌。

这**并不**意味着您的令牌无效，只是它正在检查承载令牌。

线

```
W 2013-03-14 08:52:14.885 Found 1 RPC request(s) without matching response (presumably due to timeouts or other errors) 
```

可能意味着有一个 RPC 来验证失败的令牌。验证承载令牌的主要部分是调用

```
oauth.get_current_user(EMAIL_SCOPE) 
```

并要求

```
https://www.googleapis.com/oauth2/v2/tokeninfo?access_token=ya29.AHE... 
```

验证令牌上的客户端 ID 和受众。

# ID 令牌深度：

第一段是使用的加密的 base64url 编码描述。例如。

```
>>> import base64, json
>>> segments = id_token.split('.')
>>> first_segment = segments[0] + '=' * ((4 - len(segments[0])) % 4)
>>> json.loads(base64.urlsafe_b64decode(first_segment))
{u'alg': u'RS256', u'kid': u'21eae15d817c1b4a8f6ff4501930512d07cbe684'} 
```

第二段是令牌内容的 base64url 编码描述：

```
>>> second_segment = segments[1] + '=' * ((4 - len(segments[0])) % 4)
>>> base64.urlsafe_b64decode(second_segment)
{u'at_hash': u'xxxyyyzzz',  # Fake Data
 u'aud': u'someclient_id.apps.googleusercontent.com',
 u'azp': u'someclient_id.apps.googleusercontent.com',
 u'cid': u'someclient_id.apps.googleusercontent.com',
 u'email': u'joe@mail.com',
 u'email_verified': u'true',
 u'exp': 1363289943,
 u'hd': u'google.com',
 u'iat': 1363286043,
 u'id': u'123456789',  # Fake Data
 u'iss': u'accounts.google.com',
 u'sub': u'123456789',  # Fake Data
 u'token_hash': u'xxxyyyzzz',  # Fake Data
 u'verified_email': u'true'} 
```

第三部分是用谷歌私钥签名的前两个部分的组合。

# mongodb - 通过 vmc 隧道到 cloudfoundry 的 mongodump 挂断

> ID：15410014
> 
> 赞同：0
> 
> 时间：2013-03-14T13:00:48.613
> 
> 标签：mongodb, cloud-foundry, vmc, mongodump

由于某种原因，通过隧道的 mongodump 进程每次都会在同一个集合中挂起。如果我中断该过程，则带有集合的文件的大小接近 39Mb。我不明白发生了什么事。

# django - 使用 Django 运行 sqlclear 时出现 NameError

> ID：15410018
> 
> 赞同：0
> 
> 时间：2013-03-14T13:00:55.427
> 
> 标签：django

我正在尝试向我的 Word 类添加一个外键。我刚刚用它的外键添加了“doodle”。当我执行任何命令（包括 sqlclear）时，我收到以下错误：`doodle = models.ForeignKey(Drawing, related_name="doodle") NameError: name 'Drawing' is not defined`

这是我的models.py：

```
from django.db import models
from django.contrib.auth.models import User

class Word(models.Model):
    doodle = models.ForeignKey(Drawing, related_name="doodle")
    word = models.CharField(max_length=200)
    definition = models.TextField()

    def __unicode__(self):
        return unicode(self.word)

class Drawing(models.Model):
    word = models.ForeignKey(Word, related_name="drawings")
    doodle = models.TextField()
    flags = models.IntegerField(default=0)
    kudos = models.IntegerField(default=0) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:25:05.550

`sqlclear`这与或任何其他管理命令无关。这只是一个 Python 错误：您`Drawing`在 ForeignKey 中引用了它而没有定义它。由于它是在使用后定义的，因此您可以通过将其放在引号中来解决它：`'Drawing'`.

我会质疑您是否真的希望在 Word 和 Drawing 之间双向使用 ForeignKeys - 这几乎没有意义。

# python - 从播放列表播放音乐 - wxPython

> ID：15410019
> 
> 赞同：0
> 
> 时间：2013-03-14T13:01:01.780
> 
> 标签：python, wxpython, objectlistview

我使用 wxPython 创建了一个简单的音乐播放器，它有一个 Frame 和一个 Panel 并使用[这里](http://www.blog.pythonlibrary.org/2010/04/20/wxpython-creating-a-simple-mp3-player/)给出的教程播放音乐。

此外，我还为此添加了一个播放列表功能，它使用`ObjectListView`并显示`.m3u`文件中的所有曲目。这个 playList 是一个单独的 python 模块，它

```
class MainPanel(wx.Panel):

def __init__(self, parent, playListSelected):
    //stuff

def GetOLVColClicked(self, event):
    item = event.GetEventObject().GetSelectedObjects()
    print item[0]['path']

class MainFrame(wx.Frame):
    def __init__(self, playList):
        wx.Frame.__init__(self, parent=None, id=wx.ID_ANY, 
                      title="ObjectListView Demo", size=(800,600))
        panel = MainPanel(self, playList)

class GenApp(wx.App):
    def __init__(self, playList, redirect=False, filename=None):
        self.playList = playList
        wx.App.__init__(self, redirect, filename)

    def OnInit(self):
        frame = MainFrame(self.playList)
        frame.Show()
        return True 
```

单击播放列表中的任何曲目时，我可以获得歌曲的整个路径。我想知道如何将这首歌发送到现有的音乐播放器并播放。还是这种方法是错误的，是否有更好的方法来容纳播放列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:42:14.680

这种方法非常接近我在思考如何增强自己的 mp3 播放器时的想法。在类之间传递信息，我认为 pubsub 是迄今为止最优雅的解决方案，即使它有点神奇。你可以阅读我关于这个主题的[教程](http://www.blog.pythonlibrary.org/2010/06/27/wxpython-and-pubsub-a-simple-tutorial/)，或者你可以在 wxPython wiki 上阅读它：

*   [http://wiki.wxpython.org/Controlling%20GUI%20with%20pubsub](http://wiki.wxpython.org/Controlling%20GUI%20with%20pubsub)
*   [http://wiki.wxpython.org/WxLibPubSub](http://wiki.wxpython.org/WxLibPubSub)

# c++ - 在 google::dense_hash_map 中将二进制 ostringstream 转换为 char 数组

> ID：15410023
> 
> 赞同：0
> 
> 时间：2013-03-14T13:01:12.333
> 
> 标签：c++, serialization, hash, iostream

我对**二进制文件** `ostringstream`有疑问。我想序列化谷歌的dense_hash_map。这可以使用文件句柄，但不能使用`ostringstream`，即使[文档声称这必须是可能的](http://goog-sparsehash.sourceforge.net/doc/dense_hash_map.html)。

以下代码有效：

```
char *serializeTable( size_t &length ) {
    // serialize to a temp file
    FILE *f = fopen("D:\\Dumps\\Serialization2File.txt", "w");
    bool result1 = serialize<Serializer, FILE>(m_serializer, f);
    std::cout << "result1 = " << result1 << std::endl;

    fseek(f, 0, SEEK_END);
    int mylen = ftell(f);
    fclose(f);

    // read binary data from file
    char *readbuf = new char[mylen];
    std::ifstream rf("D:\\Dumps\\Serialization2File.txt", std::ios_base::binary);
    rf.read(readbuf, mylen);
    rf.close();

    std::ofstream check("D:\\Dumps\\CheckSerializer.txt", std::ios_base::binary);
    check.write(readbuf, mylen);
    check.close();

    length = mylen;
    return readbuf;
} 
```

以下代码仅打印出前 4 个符号。数组的其余部分由`'\0'`s 组成：

```
char *serializeTable( size_t &length ) {
    std::ostringstream output("", std::stringstream::out | std::stringstream::binary);
    bool result = serialize<Serializer, std::ostringstream>(m_serializer, &output);
    auto str = output.str();
    std::cout << "str = " << str << std::endl;
} 
```

输出：

```
str = W�B 
```

代替：

```
E1eGQgAAAAAAAgAAAAAAAAAAksFLAAAAAAAAAAAAAAAAAGWwQAUAAAAAAAAAAAAAAAAAakANCg..... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T15:40:39.207

在文档中搜索并尝试了一段时间后，我自己找到了答案。

要访问存储在流中的单独字符，应该使用流迭代器（[http://www.dyn-lab.com/articles/c-streams.html](http://www.dyn-lab.com/articles/c-streams.html)，第 6 部分）。

我的代码现在看起来如下：

```
char *serializeTable( size_t &length ) {

    std::stringstream stream("", std::stringstream::out | std::stringstream::in | std::stringstream::binary);
    //std::ostringstream output("", std::stringstream::binary);

    bool result = serialize<Serializer, std::stringstream>(m_serializer, &stream);
    std::istreambuf_iterator<char> itt(stream.rdbuf()), eos;
    std::vector<char> serialVector;
    serialVector.reserve(619999); // just a guess
    while(itt != eos) {
        char c = *itt++;
        serialVector.push_back(c);
    }

    length = serialVector.size();

    char *serial = new char[length];
    int index = 0;
    for each(char a in serialVector) {
        serial[index++] = a;
    }
    return serial;
} 
```

谢谢大家的评论！

# sql-server - 在子节点中生成没有默认命名空间的 XML

> ID：15410024
> 
> 赞同：4
> 
> 时间：2013-03-14T13:01:20.683
> 
> 标签：sql-server, xml, tsql, xquery, xml-namespaces

我正在尝试使用 T-SQL 生成一个 XML 文件，该文件在根节点中具有默认命名空间，但在子节点中没有定义命名空间。

```
DECLARE @xmlData XML
DECLARE @xmlInner XML

SELECT @xmlInner =
(
SELECT * FROM dbo.GH_DATA_BS_EVLTN_MNTH_ANL [r]
FOR XML PATH('r'), TYPE
)

;WITH XMLNAMESPACES (DEFAULT 'http://www.testnamespace.com')
SELECT @xmlData = 

(
SELECT '2012-10-25T14:13:00Z' as "@DataFeedDate",@xmlInner
FOR XML PATH('root')
)

SELECT @xmlData 
```

上面的脚本生成以下 XML 文件

```
<root xmlns="http://www.testnamespace.com" DataFeedDate="2012-10-25T14:13:00Z">
  <r xmlns="">
    <RPRT_DT_CD>2012-10-25T14:15:00-05:00</RPRT_DT_CD>
    <RPRT_MO_CD>2013-01</RPRT_MO_CD>
    <RPRT_EV_CD>1</RPRT_EV_CD>
  </r>
</root> 
```

问题是标签包含空白命名空间 xmlns="" 但预期的结果是简单地获得没有定义命名空间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:08:46.993

解决它的唯一方法是更改​​：

```
;WITH XMLNAMESPACES (DEFAULT 'http://www.testnamespace.com') 
```

至

```
;WITH XMLNAMESPACES ('http://www.testnamespace.com' as anySuffix) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-08-12T15:55:51.877

您可以使用 UDF 来执行此操作。示例如下：

```
ALTER FUNCTION [dbo].[udf_get_child_section] (
    @serviceHeaderId INT
 )
RETURNS XML

BEGIN

    DECLARE @result XML;

    SELECT @result = 
    (
        SELECT 1 AS 'ChildElement'
        FOR XML PATH('Child')
    )

    RETURN @result

END

GO

DECLARE @Ids TABLE
( 
    ID int 
)

INSERT INTO @Ids
SELECT 1 AS ID 
UNION ALL
SELECT 2 AS ID

;WITH XMLNAMESPACES (DEFAULT 'http://www...com/content')
SELECT 
    [dbo].[udf_get_child_section](ID)
FROM 
    @Ids
FOR XML PATH('Parent') 
```

结果：

```
<Parent xmlns="http://www...com/content">
  <Child xmlns="">
    <ChildElement>1</ChildElement>
  </Child>
</Parent>
<Parent xmlns="http://www...com/content">
  <Child xmlns="">
    <ChildElement>1</ChildElement>
  </Child>
</Parent> 
```

# python - 使用 eval 优化 Python 读取大文件

> ID：15410025
> 
> 赞同：1
> 
> 时间：2013-03-14T13:01:23.727
> 
> 标签：python, file, optimization, eval

我正在编写一个 Python 脚本（使用 Python 3.2），在某些时候需要为字典中的每个键通过大约 800.000 行的文件。键的数量约为 150.000。文件中的行是以下格式的字典：

```
{'url': 'http://address.com/document/42/1998', 'referrer': 'http://address.com/search?&q=query1', 'session': '1', 'rank': 2, 'time': 1338447254}
{'url': 'http://address.com/document/55/17', 'referrer': 'http://address.com/search&q=query2', 'session': '1', 'rank': 2, 'time': 13384462462} 
```

对于此文件中的每一行，我需要进行一些计算并存储结果。为了能够阅读字典并使用它，我使用 eval。这将导致 120.000.000.000 次调用 eval，这需要很长时间。因此，我正在寻找一种优化方法。

欢迎您提出所有可能的优化建议。每一点都可能会产生影响，但我主要对 eval 和我读取文件的方式感兴趣。自动取款机。我在想其他一些 eval 可能执行得更快的方法，但是我不能让 JSON 读取格式并且使用 split 的结果还不是很好。我从文件中读取的方式也可能会被优化。我已经尝试了以下代码中的方法，以及“with”（速度慢得多，但消耗的内存更少）。我还尝试使用 map 读取内存中的文件：

```
f_chunk = map(eval, codecs.open(chunk_file, "r", encoding="utf-8").readlines()) 
```

但这也不起作用。

无论如何，脚本的以下部分是沉重的。它在多个进程中运行：

```
def mine(id, tmp_sessions, chunk_file, work_q, result_q, init_qsize):
    #f_chunk = map(eval, codecs.open(chunk_file, "r", encoding="utf-8").readlines())
    f_chunk = codecs.open(chunk_file, "r", encoding="utf-8").readlines()

    while True:
        try:

            k = work_q.get()
            if k == 'STOP':

                work_q.task_done()
                break # reached end of queue

        except Queue.Empty:
            break

        #with codecs.open(chunk_file, "r", encoding="utf-8") as f_chunk:
        for line in f_chunk:
            #try:
            jlog_nest = dict()
            jlog_nest = eval(line)

            #jlog_nest = json.loads(line)
            #jlog_nest = line
            #jlog_nest = defaultdict(line)

            if jlog_nest["session"] == k: # If session is the same
                query_nest = prepare_test_cases_lib.extract_query(jlog_nest["referrer"])

                for q in tmp_sessions[k]:

                    if q[0] == query_nest:
                        url = jlog_nest["url"]
                        rank = jlog_nest["rank"]
                        doc_id = prepare_test_cases_lib.extract_document_id(url)

                        # Increase number of hits on that document, and save its rank
                        if doc_id in q[1]:
                            q[1][doc_id][0] += 1
                            q[1][doc_id][1].append(rank)
                        else:
                            q[1][doc_id] = [1, [rank]]
            #except:
            #    print ("error",k)

        result_q.put((k, tmp_sessions[k]))
        work_q.task_done() 
```

如果它有助于理解在上面的代码运行之前发生了什么，tmp_session 可能看起来像这样：

```
tmp_sessions: {'39': [['q7', {}], ['q2', {}]], '40': [['q2', {}]]} 
```

之后：

```
tmp_sessions: {'39': [['q7', {}], ['q2', {'133378': [1, [2]]}]], '40': [['q2', {'133378': [1, [2]]}]]} 
```

在真实数据的子集上，我运行 pstats 文件中有 562 个键和 2232 行，按时间降序排序（这只是顶部）：

```
1284892 function calls in 76.810 seconds

Ordered by: cumulative time

ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     8    0.000    0.000   77.985    9.748 {built-in method exec}
     8    1.607    0.201   77.978    9.747 prepare_hard_test_cases.py:29(mine)
1254384   75.051    0.000   76.220    0.000 {built-in method eval}
   562    0.008    0.000    0.050    0.000 queues.py:99(put)
     8    0.000    0.000    0.029    0.004 codecs.py:685(readlines) 
```

由此看来，确实是 eval 占用了时间。

**编辑：**正如我所建议的那样，我尝试使用literal_eval。我实际上发现这是试图找到解决方案，但认为它与 eval 相同。我刚跑了。它确实产生了相同的结果，但运行时间非常糟糕：

```
 50205868 function calls (37662028 primitive calls) in 121.494 seconds

 Ordered by: cumulative time

 ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      8    0.001    0.000  121.494   15.187 {built-in method exec}
      8    0.008    0.001  121.493   15.187 <string>:1(<module>)
      8    4.935    0.617  121.485   15.186 prepare_hard_test_cases.py:29(mine)
1254384    5.088    0.000  116.425    0.000 ast.py:39(literal_eval)
1254384    1.098    0.000   71.432    0.000 ast.py:31(parse)
1254384   70.333    0.000   70.333    0.000 {built-in method compile}
13798224/1254384   22.996    0.000   39.336    0.000 ast.py:51(_convert)
7526304    8.539    0.000   23.042    0.000 ast.py:63(<genexpr>)
25087680    8.371    0.000    8.371    0.000 {built-in method isinstance}
    8    0.001    0.000    0.047    0.006 codecs.py:685(readlines) 
```

**编辑2：**我现在尝试了两种新方法。第一个是通过从每一行手动提取键和值，构造一个字典来处理。这在我的测试集上运行得更快一些：

```
51460252 function calls in 45.207 seconds

 Ordered by: cumulative time

 ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      8    0.001    0.000   45.207    5.651 {built-in method exec}
      8    0.003    0.000   45.207    5.651 <string>:1(<module>)
      8    1.701    0.213   45.203    5.650 prepare_hard_test_cases.py:68(mine)
1254384    5.725    0.000   43.391    0.000 prepare_hard_test_cases.py:36(extractDict)
6271920   23.433    0.000   37.665    0.000 prepare_hard_test_cases.py:20(extractKeyValue)
18819074   11.308    0.000   11.308    0.000 {method 'find' of 'str' objects}
25092651    2.927    0.000    2.927    0.000 {built-in method len} 
```

这是个好消息，但更好的是我使用 pickle 的第二种方法。现在我得到：

```
30091 function calls in 5.285 seconds

Ordered by: cumulative time

ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     8    0.000    0.000    5.285    0.661 {built-in method exec}
     8    0.003    0.000    5.285    0.661 <string>:1(<module>)
     8    0.173    0.022    5.281    0.660 prepare_hard_test_cases.py:68(mine)
   570    0.001    0.000    5.057    0.009 queues.py:113(get)
  2281    3.925    0.002    3.925    0.002 {method 'acquire' of '_multiprocessing.SemLock' objects}
   570    1.133    0.002    1.133    0.002 {method 'recv' of '_multiprocessing.PipeConnection' objects}
     8    0.029    0.004    0.029    0.004 {built-in method load} 
```

当我有时间时，我会尝试将这种方法应用于全套。

有什么建议么？

最好的问候，卡斯帕

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:02:34.690

你应该[`ast.literal_eval()`](http://docs.python.org/3.3/library/ast.html#ast.literal_eval)试一试，它是为这项工作而设计的，而且可能会更快。

`eval()`速度慢，不安全，通常是个坏主意。如果您认为自己需要它，请环顾四周，我向您保证，您 99.99% 的时间都不需要它。

另请注意：

```
f_chunk = codecs.open(chunk_file, "r", encoding="utf-8").readlines()
... 
```

真的应该是：

```
with open(chunk_file, "r", encoding="utf-8") as f_chunk:
    ... 
```

文件是迭代器，因此使用`readlines()`只会降低程序的内存效率。使用`with`可确保您的文件在完成后正确关闭（就像您在 3.x 中一样，您可以使用`open()`而不是`codecs.open()`因为它已更新以支持后者的额外功能）。

除此之外，据我所知，您的每一行数据都应该是有效的 JSON，因此该`json`模块也应该可以工作。

# android - Android Cocos2dX 使用 CGPoint 数组绘制形状

> ID：15410026
> 
> 赞同：1
> 
> 时间：2013-03-14T13:01:25.200
> 
> 标签：android, cocos2d-x, ccsprite

我一直在开发一个需要创建图像破碎效果的安卓游戏。我正在使用 Cocos2dx 进行游戏开发。

我已经将要破碎的形状分成小三角形并将它们存储到一个数组中，因为它在 Cocos2dx 中，所以顶点数组是一个 CGPoint 数组。例如

```
CGPoint[] vertices;

vertices[1]={CGPoint.ccp(0,0),CGPoint.ccp(1,0),CGPoint.ccp(1,1)}

vertices[2]={CGPoint.ccp(1,0),CGPoint.ccp(0,1),CGPoint.ccp(1,1)}
....
vertices[numVertices]={CGPoint.ccp(1,0),CGPoint.ccp(0,1),CGPoint.ccp(1,1)} 
```

画画的时候

我已经将顶点数组转换为这样的 FloatBuffer

```
 ByteBuffer vbb = ByteBuffer.allocateDirect(4 * 2*3* numVertices);
        vbb.order(ByteOrder.nativeOrder());
        triVertices = vbb.asFloatBuffer(); 
```

* * *

在 onDraw() 方法中这里的 pt1,pt2,pt3 是 CGPoints

```
 for(int i=0;i<numVertices;i++){

        triVertices.put(vertices[i].pt1.x);
        triVertices.put(vertices[i].pt1.y);
        triVertices.put(vertices[i].pt2.x);
        triVertices.put(vertices[i].pt2.y);
        triVertices.put(vertices[i].pt2.x);
        triVertices.put(vertices[i].pt2.y);
    }
    gl.glVertexPointer(2, GL10.GL_FLOAT, 0, triVertices);
    gl.glTexCoordPointer(2, GL10.GL_FLOAT, 0, triTexCoords);
    gl.glColorPointer(4, GL10.GL_UNSIGNED_BYTE, 0, colorBuffer);
    gl.glDrawArrays(GL10.GL_TRIANGLE_STRIP, 0, numVertices*3); 
```

* * *

不幸的是，整个形状都没有被绘制出来。从某种意义上说，只有单个三角形被绘制出来。我的逻辑有什么问题吗？请帮助我。真的很紧急。

## 编辑

下面是我用来调用扩展 CCSprite的粉碎类**ShatteredSprite.java的代码。**

```
 CCSprite newSprite= CCSprite.sprite("bg-hand1.jpg");
    int piecesX = 20;
    int piecesY = 20;
    float speedVar = 0.5f;
    float rotVar = 0.2f;
    boolean radial = true;
    ShatteredSprite shatter =ShatteredSprite.shatterWithSprite(newSprite,
            piecesX,
            piecesY,
            speedVar,
            rotVar,
            radial);
    shatter.setAnchorPoint(CGPoint.make(0, 0));
    shatter.setPosition(CGPoint.ccp(100, 150));
    this.addChild(shatter, 1, 99); 
```

现在破碎正在发生，但效果显示在右上角，所以只有一部分药水是可见的。如何使它正确。有任何想法。提前致谢。

# xaml - 在 Surface (WinRT) 上滚动列表视图时性能不佳

> ID：15410027
> 
> 赞同：1
> 
> 时间：2013-03-14T13:01:28.363
> 
> 标签：xaml, listview, scroll, windows-rt

我们有一个列表视图，其中包含包含一些文本和一些图像的项目列表。垂直滚动时，Surface RT 的性能真的很差。滚动有点生涩，如果您以中等速度滚动，它会显示黑名单。在 Windows 8 机器上运行没有问题。¨

我在这里做错了什么还是有任何性能更好的第 3 方列表视图？

这是该问题的视频： [https ://dl.dropbox.com/u/25670071/scrolling.MOV](https://dl.dropbox.com/u/25670071/scrolling.MOV)

这是 ListView 的 XAML：

```
<ListView HorizontalAlignment="Stretch"
          VerticalAlignment="Top"                                                
          VirtualizingStackPanel.VirtualizationMode="Recycling"
          Grid.Row="1"
          ItemsSource="{Binding Matches}"
          ItemContainerStyle="{StaticResource ListViewItemStyleInternal}"
          ItemsPanel="{StaticResource ItemsPanelTemplate1}"
          SelectionMode="None"
          IsItemClickEnabled="True"
          ItemClick="OnMatchItemClick">
    <ListView.Template>
        <ControlTemplate>
            <ItemsPresenter />
        </ControlTemplate>
    </ListView.Template>

    <ListView.ItemTemplate>
        <DataTemplate>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition MinWidth="70"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition MinWidth="80"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition MinWidth="70"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Border Grid.ColumnSpan="6" 
                        Background="#FF4D4D4D" 
                        Opacity=".7" 
                        Visibility="{Binding IsOdd, Converter={StaticResource BooleanToVisibilityConverterInverted}}" />

                <TextBlock Text="{Binding HomeTeamName}" 
                            TextAlignment="Right" 
                            TextWrapping="Wrap" 
                            VerticalAlignment="Center" 
                            FontSize="12" 
                            Foreground="#FFF2F2F2" 
                            Margin="10,0,0,0"/>
                <Image Source="{Binding HomeTeamLogo}" 
                        Grid.Column="1" 
                        Width="30" 
                        Stretch="Uniform" 
                        Margin="10,0"/>
                <Image Source="{Binding AwayTeamLogo}"
                        Grid.Column="3" 
                        Width="30" 
                        Stretch="Uniform"
                        Margin="10,0"/>
                <TextBlock Text="{Binding AwayTeamName}" 
                            Grid.Column="4" 
                            TextWrapping="Wrap" 
                            VerticalAlignment="Center" 
                            FontSize="12" 
                            Foreground="#FFF2F2F2" 
                            Margin="0,0,10,0"/>
                <Path Data="F1M987.6631,396.0728C987.1801,396.0728,986.7871,395.6648,986.7871,395.1648C986.7871,394.6638,987.1801,394.8628,987.6631,394.8628C988.1461,394.8628,988.5391,395.2678,988.5391,395.7698C988.5391,396.2708,988.1461,396.0728,987.6631,396.0728 M982.4051,391.1748L980.0681,390.3298L980.6521,385.7948L982.9901,386.8058z M989.4161,393.0478C988.2491,391.8398,987.3711,392.4438,987.0781,391.8398C986.7871,391.2348,987.2211,389.3358,986.7871,388.2138C986.2021,386.7018,985.0341,386.0968,985.0341,386.0968C980.9441,384.2828,967.7991,379.4468,967.2151,380.0518C966.9221,380.3538,965.7541,381.8648,966.0471,385.7948C966.0471,385.7948,973.7891,390.3338,974.9601,391.3818C976.2711,391.8398,974.6401,393.8548,975.1021,395.7698C975.6741,398.1338,978.6061,399.9998,980.9441,399.9998C983.2801,399.9998,986.2021,398.7918,986.2021,396.9768C986.2021,395.1648,985.6191,396.9768,985.9091,397.2798C986.2021,397.5808,987.6291,397.7448,988.5391,397.5808C990.0451,397.3128,990.0001,394.5598,990.0001,394.2578C990.0001,393.9558,989.7071,393.3508,989.4161,393.0478"
                        Grid.Column="5" 
                        Fill="Gray" 
                        Height="20" 
                        Stretch="Fill" 
                        VerticalAlignment="Center" 
                        Width="24"
                        Margin="16,0"/>

                <Grid Grid.Column="2" 
                        VerticalAlignment="Center" 
                        Margin="0" 
                        Visibility="{Binding IsStarted, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <TextBlock FontWeight="SemiBold" 
                                HorizontalAlignment="Right" 
                                Text="{Binding HomeTeamScore}" 
                                VerticalAlignment="Top"
                                Foreground="White" 
                                TextAlignment="Center" 
                                FontSize="40" 
                                Width="30"/>
                    <TextBlock Grid.Column="1" 
                                FontWeight="SemiBold" 
                                FontSize="40" 
                                HorizontalAlignment="Center" 
                                TextWrapping="Wrap" 
                                Text="-" 
                                VerticalAlignment="Top" 
                                Foreground="White"/>
                    <TextBlock Grid.Column="2" 
                                FontWeight="SemiBold" 
                                FontSize="40" 
                                HorizontalAlignment="Left"
                                Text="{Binding AwayTeamScore}" 
                                VerticalAlignment="Top"
                                Foreground="White" 
                                TextAlignment="Center" 
                                Width="30"/>
                </Grid>
                <Grid Grid.Column="2" 
                        VerticalAlignment="Center" 
                        Margin="0" 
                        Visibility="{Binding IsStarted, Converter={StaticResource BooleanToVisibilityConverterInverted}}">
                    <StackPanel HorizontalAlignment="Center" 
                                VerticalAlignment="Center">
                        <TextBlock Foreground="#FFCCCCCC" 
                                    FontSize="14" 
                                    HorizontalAlignment="Center" 
                                    FontFamily="Segoe" 
                                    FontWeight="SemiBold" 
                                    Text="Kick-off"/>
                        <TextBlock Foreground="#FFCCCCCC" 
                                    FontSize="16" 
                                    HorizontalAlignment="Center" 
                                    VerticalAlignment="Center" 
                                    FontFamily="Segoe" 
                                    FontWeight="Normal" 
                                    Text="{Binding MatchStartTime}"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </DataTemplate>
    </ListView.ItemTemplate>
</ListView> 
```

# java - 将“”中的值替换为空值，需要在“”之后获取字符串

> ID：15410029
> 
> 赞同：-1
> 
> 时间：2013-03-14T13:01:42.227
> 
> 标签：java, substitution

我有 n 个这样的字符串：

```
"AC_def" 123 dffgg fdffv ,
"av bgg" 1234 frfvf gfg , 
"av cvc bgg" 1234 frfvf gfg. 
```

我需要用空值替换引号中的值，之后只需要字符串。我应该如何使用子字符串来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:07:26.220

我**想**这就是你想要的。如果不是，请提供 assylias 所说的更多细节！

```
 String data = "\"AC_def\" 123 dffgg fdffv ,";
    System.out.println(data);
    data = data.substring(data.lastIndexOf("\"") + 1);
    System.out.println(data); 
```

反正……因为我在等证据……

```
 Scanner scanner = new Scanner(System.in);
    // input by user...
    //"AC_def" 123 dffgg fdffv ,
    String data = scanner.nextLine();
    System.out.println(data);
    data = data.substring(data.lastIndexOf("\"") + 1);
    System.out.println(data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:07:56.227

作为开始：

`String str2 = str1.replaceFirst("\\\".*\\\"", "");`

编辑：如果它们在一个数组中，你总是可以循环：

```
for (int i = 0;i< strarray.length;i++)
{
  strarray[i] = strarray[i].replaceFirst("\\\".*\\\"", "");
} 
```

请注意，您仍将创建新的 String 实例

# pthreads - pthread 的根或非根

> ID：15410031
> 
> 赞同：1
> 
> 时间：2013-03-14T13:01:43.887
> 
> 标签：pthreads

是否可以检查线程的所有者（具有 pthread id）是 root 用户还是非 root 用户？从我在互联网上搜索的内容来看，似乎没有直接的方法可以获取所有者信息。（对于当前线程，我知道我们可以使用 getuid() 调用。但我有兴趣获取其他线程的信息）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T18:27:23.180

线程与使用 pthread_create() 启动它的代码在同一进程中运行。不要将线程与进程、fork() 等混淆。除非您的程序正在调用 setuid() 系列函数之一，否则它应该与 main() 中的函数完全相同。

**编辑：**基于以下新信息。

没有使用 pthread_* 接口查询单独进程的线程或其根状态的标准方法。在特定平台上可能可以检查特定于操作系统的进程信息以获取该数据，但没有可移植的方式。此外，您没有提及您在哪个平台上运行它，或者它是否需要跨平台工作。

您可以使用其他 IPC 方法来查询线程应用程序（如果您也可以修改它）并直接询问它是否以 root 身份运行。必须更改线程应用程序以跟踪其所有线程、它们的 tid 等，以按照您在下面描述的方式回答问题。您仍然需要确保您选择的 IPC 机制也可移植到支持的平台。

尽管如此，来自一个进程的 pthread 线程 ID 对另一个进程本身来说几乎没有价值。您应该仔细考虑您真正想要完成的工作，并提出一个包含足够详细信息以涵盖真正目标的问题。

# jquery - 月度图：在 Flot 时间模式下，barWidth 不正确

> ID：15410033
> 
> 赞同：2
> 
> 时间：2013-03-14T13:01:46.623
> 
> 标签：jquery, flot

我有一个包含一些数据的月度图表。数据以条形图显示（1 个月/条形图）。

我正在尝试根据月份设置 barWidth。

barWidth 是按月计算的：

*   一月 ：`60 * 60 * 24 * 31 * 1000`
*   二月：`60 * 60 * 24 * 28 * 1000`
*   行进 ：`60 * 60 * 24 * 31 * 1000`

    ETC...

但不幸的是结果并不像预期的那样......

我在一月和二月之间有空间，三月开始得太早了，他的酒吧在二月的酒吧。

这是一些您可以使用的代码：http: [//jsfiddle.net/jSQ2Y/2/](http://jsfiddle.net/jSQ2Y/2/)

你知道如何为每个月显示一个正确的栏吗？

提前谢谢了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T18:38:32.257

您可以向 xaxis 添加样式并删除对齐。我还指定了刻度数组和月份名称格式。

```
#placeholder .tickLabel {margin-left: 15%;}

var plot = $.plot($("#placeholder"), [ m1, m2, m3], {
xaxis : {
    mode          : "time",

    ticks: [1356998400000, 1359676800000, 1362096000000 ],
    timeformat: "%b"

},
series : {
    bars: {
        show: true,

        fillColor : { colors : ["#32b9ff", "#2b78a0"] }
    }
}
}); 
```

链接到小提琴 - [http://jsfiddle.net/jSQ2Y/3/](http://jsfiddle.net/jSQ2Y/3/)

# android - Gson 在 > 4.0 的设备上抛出异常

> ID：15410037
> 
> 赞同：3
> 
> 时间：2013-03-14T13:02:02.070
> 
> 标签：android, gson

我成功地使用 Gson 将 json 放入对象中。它在具有 android 2.2（模拟器和真实设备）的设备上就像一个魅力，当我部署到 android 4.0 及更高版本（模拟器和设备）时，我得到了这个非常奇怪的异常。

我已经确认 json 字符串没有问题，因为相同的代码在旧设备上运行良好。

这里肯定会抛出异常：

`Gson gson = new GsonBuilder().setFieldNamingPolicy(FieldNamingPolicy.LOWER_CASE_WITH_UNDERSCORES).create(); return gson.fromJson(jsonString, t);`

在 fromJson 方法中。

有任何想法吗？

Json String：（必须从 json 中的 url 中删除 http://）

```
{“session_id”：“a89d8cd07e356”，
    “shoutout_items”：[{“attachment_url”：“xxxxxx.mobi/pic.php?id=478ba67a44d”，
        "attachment_url_full_size" : "xxxxxx.mobi/pic.php?id=01810a5e9f6e7065cd4",
        “expires_at”：1363264081，
        “have_attachment”：是的，
        "message_text" : "嗨",
        “合作伙伴”：{“国家代码”：“za”，
            “性别”：“男性”，
            “昵称”：“昵称”，
            "profile_pic_full_size_url" : "xxxxxx.mobi/pic.php?id=810a5e9f6e7065cd43629f1",
            "profile_pic_url" : "xxxxxx.mobi/pic.php?id=23ca67a44d23",
            “profile_summary”：“20，DBN”
          },
        “shoutout_id”：31170，
        “类型”：“大喊”
      },
      {“附件网址”：空，
        “attachment_url_full_size”：空，
        “expires_at”：1363264081，
        “有附件”：假，
        "message_text" : "你好",
        “合作伙伴”：{“国家代码”：“za”，
            “性别”：“男性”，
            “昵称”：“标记”，
            "profile_pic_full_size_url" : "xxxxxx.mobi/pic.php?id=2db9e7f86b9bf7ca",
            "profile_pic_url" : "xxxxxx.mobi/pic.php?id=b110191f1afac",
            “profile_summary”：“40，DBN”
          },
        “shoutout_id”：31322，
        “类型”：“大喊”
      }
    ]
}
```

堆栈跟踪：

```
 03-14 14:56:02.200: E/AndroidRuntime(19588): FATAL EXCEPTION: main
    03-14 14:56:02.200: E/AndroidRuntime(19588): java.lang.RuntimeException: Unable to start activity ComponentInfo{mobi.smiggle.android/mobi.smiggle.android.MainFragmentActivity}: java.lang.IllegalArgumentException: class android.text.BoringLayout declares multiple JSON fields named m_paint
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1968)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1993)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at android.app.ActivityThread.access$600(ActivityThread.java:127)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1159)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at android.os.Handler.dispatchMessage(Handler.java:99)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at android.os.Looper.loop(Looper.java:137)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at android.app.ActivityThread.main(ActivityThread.java:4507)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at java.lang.reflect.Method.invokeNative(Native Method)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at java.lang.reflect.Method.invoke(Method.java:511)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at dalvik.system.NativeStart.main(Native Method)
    03-14 14:56:02.200: E/AndroidRuntime(19588): Caused by: java.lang.IllegalArgumentException: class android.text.BoringLayout declares multiple JSON fields named m_paint
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.getBoundFields(ReflectiveTypeAdapterFactory.java:122)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.create(ReflectiveTypeAdapterFactory.java:72)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.Gson.getAdapter(Gson.java:353)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.<init>(ReflectiveTypeAdapterFactory.java:82)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.createBoundField(ReflectiveTypeAdapterFactory.java:81)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.getBoundFields(ReflectiveTypeAdapterFactory.java:118)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.create(ReflectiveTypeAdapterFactory.java:72)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.Gson.getAdapter(Gson.java:353)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.<init>(ReflectiveTypeAdapterFactory.java:82)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.createBoundField(ReflectiveTypeAdapterFactory.java:81)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.getBoundFields(ReflectiveTypeAdapterFactory.java:118)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.create(ReflectiveTypeAdapterFactory.java:72)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.Gson.getAdapter(Gson.java:353)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.<init>(ReflectiveTypeAdapterFactory.java:82)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.createBoundField(ReflectiveTypeAdapterFactory.java:81)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.getBoundFields(ReflectiveTypeAdapterFactory.java:118)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.create(ReflectiveTypeAdapterFactory.java:72)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.Gson.getAdapter(Gson.java:353)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.<init>(ReflectiveTypeAdapterFactory.java:82)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.createBoundField(ReflectiveTypeAdapterFactory.java:81)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.getBoundFields(ReflectiveTypeAdapterFactory.java:118)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.create(ReflectiveTypeAdapterFactory.java:72)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.Gson.getAdapter(Gson.java:353)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.<init>(ReflectiveTypeAdapterFactory.java:82)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.createBoundField(ReflectiveTypeAdapterFactory.java:81)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.getBoundFields(ReflectiveTypeAdapterFactory.java:118)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory.create(ReflectiveTypeAdapterFactory.java:72)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.Gson.getAdapter(Gson.java:353)
    03-14 14:56:02.200: E/AndroidRuntime(19588):    at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.<init>(ReflectiveTypeAdapterFactory.java: 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T18:05:03.990

我发现，如果您的实例**t**从任何**android**视图组件（例如 Button）扩展或具有从任何**android**视图组件扩展的类字段，您将得到这样的异常

出于某种原因，这个库不能再序列化**视图**组件了。因此，您可以添加排除策略。例如，此策略将排除所有字段，但带有注解@SerializedName 的字段除外：

```
class Exclude implements ExclusionStrategy {

@Override
public boolean shouldSkipClass(Class<?> arg0) {
    // TODO Auto-generated method stub
    return false;
}

@Override
public boolean shouldSkipField(FieldAttributes field) {
    SerializedName sn = field.getAnnotation(SerializedName.class);
    if(sn != null)
        return false;
    return true;
}} 
```

假设我们有示例 Json：

```
private final String jsonSample= "{ \"Sample\": { \"field1\":1, \"field2\":2}}"; 
```

这是示例代码：

```
 private void parseJson(){
    Exclude ex = new Exclude();
    Gson gson = new GsonBuilder().create();

    GsonObject gObject = gson.fromJson(jsonSample, GsonObject.class);

}

class GsonObject{
    @SerializedName("Sample")
    public Smpl smpl;

//  private Button btn;  <-- Uncomment this line, and you will get your error!

    class Smpl{
        @SerializedName("field1")
        int fl1;
        @SerializedName("field2")
        int fl2;
    }
} 
```

但是在添加了我上面写的**排除策略之后：**

```
 Exclude ex = new Exclude();
    Gson gson = new GsonBuilder().addDeserializationExclusionStrategy(ex).addSerializationExclusionStrategy(ex).create(); 
```

一切正常。

最后我们有以下测试应用程序：

```
public class MainActivity extends Activity {

private final String jsonSample= "{ \"Sample\": { \"field1\":1, \"field2\":2}}";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    parseJson();
}

private void parseJson(){
    Exclude ex = new Exclude();
//  Gson gson = new GsonBuilder().create(); <-- without EX strategy it will try to serrialaze Button field in our GsonObject, and throws an exeption
    Gson gson = new GsonBuilder().addDeserializationExclusionStrategy(ex).addSerializationExclusionStrategy(ex).create();

    GsonObject gObject = gson.fromJson(jsonSample, GsonObject.class);

    Toast.makeText(this, "Gson" + gObject.smpl.fl1 + " " + gObject.smpl.fl2, Toast.LENGTH_LONG).show();

}

class GsonObject{
    @SerializedName("Sample")
    public Smpl smpl;

    private Button btn; // <-- this field is our reason of this strange exception on Gson serialization

    class Smpl{
        @SerializedName("field1")
        int fl1;
        @SerializedName("field2")
        int fl2;
    }
}
}

class Exclude implements ExclusionStrategy {

    @Override
    public boolean shouldSkipClass(Class<?> arg0) {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public boolean shouldSkipField(FieldAttributes field) {
        SerializedName ns = field.getAnnotation(SerializedName.class);
        if(ns != null)
            return false;
        return true;
    }

} 
```

ps对不起我的英语）

# c# - 如何将 PL/SQL 输出 (clob) 保存为 XML 文件？

> ID：15410041
> 
> 赞同：4
> 
> 时间：2013-03-14T13:02:12.430
> 
> 标签：c#, javascript, jquery, asp.net

在这个阶段我觉得很愚蠢，因为这似乎不是我应该与之抗争的任务，但是经过短暂的睡眠和 1000 个想法在我脑海中闪过，我认为我现在是锅里的青蛙，有了隧道——视觉病毒使解决方案蒙上阴影。开始：

我在 PL/SQL 中有一个查询，它使用 DBMS_XMLGEN.getxml 从几个表中将数据选择为 XML 格式（1 行，1 列是 CLOB 类型）。这完美地工作。

我的问题是将此 XML 输出返回到 C#，并询问用户他想在他的个人电脑上将此输出保存为 output.xml 文件的位置。

我将 ASP.net 与 JQuery (AJAX) 一起使用，因此在单击链接时发布到 .aspx 页面并使用返回的数据（在此实例中来自查询的 xml）进行保存。将 OLEDB 命令与 OLEDB 数据读取器一起使用似乎不是正确的方法......

这样做的最佳方法是什么？我在.net 中的序列化工作不多，但我认为这是最好的方法（根据我所做的研究）？有没有人举例说明如何在我的情况下做到这一点？

我的想法基本上是在内存中创建这个输出/文件，询问用户他想将它保存在哪里，将它保存为 .xml 文件并清除内存。

更新：好的，我设法创建了一个 XMLDocument，它很容易接受来自我的查询的 xml 输出。我怎样才能从用户那里获得关于在他的电脑上保存这个文件的位置的输入？

到目前为止我的代码：

Javascript：

```
function XML_ExportAppRestrictions() {
try {

    var data = {"action": "exportAppRestrictions"};

    var returned = AjaxLoad('Modules/Common/Common.aspx', null, data, null, null, false);

    if (returned.toString().toUpperCase().substring(0, 5) == "ERROR") {
        return;
    }
    else {
        // should the file be saved here or in my aspx page using xmldoc.save?
        // Using xmldoc.save will only be able to save the file on the server yes?
    }
}
    catch (ex) {
        alert(ex.Message);
    }
} 
```

ASP：

```
if (Request["action"] == "exportAppRestrictions")
    {

        // Create and open DB connection
        conn.ConnectionString = SG_Common.CommonClass.NetRegUDL;
        common.OpenDBConnection(ref conn);

        // Create command and set SQL statement
        cmd.Connection = conn;
        cmd.CommandType = System.Data.CommandType.Text;
        // select text was removed below due to it's length
        cmd.CommandText = "select x as AppRestrictions from dual";

        rd = cmd.ExecuteReader();

        if (rd.HasRows)
        {
            if (rd.Read())
            {
                str = rd["AppRestrictions"].ToString();
            }
        }
        rd.Close();

        System.Xml.XmlDocument xmldoc = new System.Xml.XmlDocument();
        xmldoc.InnerXml = str;
        xmldoc.Save("c:\\xmltest.xml");

        goto Done;
    }

    // Done runs in a seperate try/catch statement and only returns data to the calling js function.
    Done:
        Response.Write(str); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T14:14:19.390

XML 应该只是 UTF8 纯文本。我对对象使用了序列化。也许有人会纠正我，但我发现没有必要对纯文本或二进制数据使用序列化。

为了让这些数据通过内存，这里有一个很好的[StackOverflow 答案，](https://stackoverflow.com/questions/221925/creating-a-byte-array-from-a-stream)展示了如何使用 MemoryStream 和字节缓冲区。

因为如果您可以将其放入 byte[] 缓冲区，则可以执行[以下](http://support.microsoft.com/kb/318425/en-us)操作：

```
public bool SaveDocument( Byte[] docbinaryarray, string docname)
{
    string strdocPath;
    strdocPath = "C:\\DocumentDirectory\\" + docname;
    FileStream objfilestream =new FileStream(strdocPath,FileMode.Create,FileAccess.ReadWrite);
    objfilestream.Write(docbinaryarray,0,docbinaryarray.Length);
    objfilestream.Close();
    return true;
} 
```

[有关 System.IO 方法的更多信息，](http://support.microsoft.com/kb/304430)请参阅此处，例如：

```
StreamWriter writer = new StreamWriter("c:\\KBTest.txt");
writer.WriteLine("File created using StreamWriter class.");
writer.Close();
this.listbox1.Items.Clear();
addListItem("File Written to C:\\KBTest.txt"); 
```

更新 1（Windows）：

（我以为你在寻找[System.Windows.Forms.SaveFileDialog](http://msdn.microsoft.com/en-us/library/sfezx97z.aspx)）

这是 MSDN 示例代码：

```
private void button2_Click(object sender, System.EventArgs e)
{
   // Displays a SaveFileDialog so the user can save the Image
   // assigned to Button2.
   SaveFileDialog saveFileDialog1 = new SaveFileDialog();
   saveFileDialog1.Filter = "JPeg Image|*.jpg|Bitmap Image|*.bmp|Gif Image|*.gif";
   saveFileDialog1.Title = "Save an Image File";
   saveFileDialog1.ShowDialog();

   // If the file name is not an empty string open it for saving.
   if(saveFileDialog1.FileName != "")
   {
      // Saves the Image via a FileStream created by the OpenFile method.
      System.IO.FileStream fs = 
         (System.IO.FileStream)saveFileDialog1.OpenFile();
      // Saves the Image in the appropriate ImageFormat based upon the
      // File type selected in the dialog box.
      // NOTE that the FilterIndex property is one-based.
      switch(saveFileDialog1.FilterIndex)
      {
         case 1 : 
             this.button2.Image.Save(fs, 
            System.Drawing.Imaging.ImageFormat.Jpeg);
         break;

         case 2 : 
         this.button2.Image.Save(fs, 
         System.Drawing.Imaging.ImageFormat.Bmp);
         break;

         case 3 : 
         this.button2.Image.Save(fs, 
                System.Drawing.Imaging.ImageFormat.Gif);
         break;
      }

   fs.Close();
   }
} 
```

而且，正如它所说，您需要注册事件处理程序：

```
this.button2.Click += new System.EventHandler(this.button2_Click); 
```

更新 2（网络）：

好的，我看到您实际上是在寻找 Web 解决方案。我在想 Windows 而不是 Web。 [这是您必须在 Web 端执行的操作。](http://forums.asp.net/t/1265651.aspx/1) 这是一个 VB.NET 示例，但我假设您可以翻译：

```
string FileName = "Hello.doc";
string Filename = strFileName.Substring(0, FileName.LastIndexOf("."));                      
Response.AppendHeader("Content-Disposition", "attachment; filename=" + FileName);
Response.TransmitFile(Server.MapPath("~/Folder_Name/" + FileName));
Response.End(); 
```

我已经多次对这种方法做了变体。您将 XML 文件发送回用户的浏览器。一旦它到达那里，用户必须决定如何处理它（通常是“打开这个文件，还是保存它？”）。那是在浏览器的控制之下。

您可以通过包含一个内容类型标题来帮助浏览器，该标题告诉浏览器它正在查看哪种文件，以及它应该尝试用什么打开它。所以这个标题会要求它调用 Excel：

```
Response.AppendHeader("Content-Type", "application/vnd.ms-excel"); 
```

您会经常看到应用程序/pdf，它将打开 Adob​​e Reader 或用户正在使用的任何其他 PDF 阅读器。在这里，您将要使用内容类型“text/xml”。这里的内容类型不太重要，因为我们打算让用户保存文件，而不是用应用程序打开它。

内容配置“附件”与“内联”存在一些问题。尝试两种方式，看看哪一种更适合你。其中一个（我不记得是哪个）基本上忽略了您发送的建议文件名，而是使用您的 ASP 页面的名称。很烦人。Firefox 至少将此记录为一个错误，IE 显然只是将其视为另一个“功能”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T10:25:49.510

使用 Jquery (AJAX) 在用户交互方面有其局限性（具体参考保存对话框 - 即在我的示例中向 asp 页面发送请求，并期望返回文件 [或在我的情况下为内存流]，并想问用户他想把它保存在哪里——因此不在服务器上）。

我找到了一种解决方法，因为使用 AJAX 进行网络相关调用是我的强项。正如这篇文章中提到的，还有一些改进的空间，但对我来说效果很好，因此允许使用 response.write (x) 返回我的 XML 数据，并且这个“hack”允许用户将 XML 文件保存在他想要的任何地方：

Javascript 源代码：

```
jQuery.download = function (url, data, method) {
//url and data options required
if (url && data) {
    //data can be string of parameters or array/object
    data = typeof data == 'string' ? data : jQuery.param(data);
    //split params into form inputs
    var inputs = '';
    jQuery.each(data.split('&'), function () {
        var pair = this.split('=');
        inputs += '<input type="hidden" name="' + pair[0] + '" value="' + pair[1] + '" />';
    });
    //send request
    jQuery('<form action="' + url + '" method="' + (method || 'post') + '">' + inputs + '</form>')
    .appendTo('body').submit().remove();
};
}; 
```

平均售价回报：

```
Response.Clear();
Response.ContentType = "text/xml";
Response.AddHeader("Content-disposition", "attachment; filename=test.xml");
Response.Write(yourXMLstring); 
```

使用示例（javascript 调用）：

```
$.download("your_url_here", html_url_based_parameters_if_needed_here); 
```

在这里得到这个有用的帖子：[http ://www.filamentgroup.com/lab/jquery_plugin_for_requesting_ajax_like_file_downloads/](http://www.filamentgroup.com/lab/jquery_plugin_for_requesting_ajax_like_file_downloads/)

希望这对将来的人有所帮助！

# iphone - 如何在 iOS 中让标签文本在屏幕上移动？

> ID：15410042
> 
> 赞同：2
> 
> 时间：2013-03-14T13:02:15.237
> 
> 标签：iphone, text, label

我有一个标签和里面的文字。我希望我的文本像数字信息板一样跨越标签的宽度。如何在 iOS 中做到这一点？我尝试使用该代码（我从这里获得：[http](http://www.youtube.com/watch?v=EFoNEjPwTXM) ://www.youtube.com/watch?v=EFoNEjPwTXM ），但它不起作用：

在 .m 文件中：

```
-(void)time: (NSTimer *) theTimer
{
    currentSong.center = CGPointMake(currentSong.center.x - 3.5, currentSong.center.y);
    if (currentSong.center.x < - (currentSong.bounds.size.width/2))
    {
        currentSong.center = CGPointMake (320 + (currentSong.bounds.size.width/2), currentSong.center.y);
    }
} 
```

在`viewDidLoad`：

```
timer = [NSTimer timerWithTimeInterval:0.09 target:self selector:@selector(time:) userInfo:nil repeats:YES]; 
```

在 .h 文件中：

```
 IBOutlet UILabel *currentSong;
    IBOutlet NSTimer *timer;    

-(void)time: (NSTimer *) theTimer;

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-23T11:57:04.217

```
- (void)sendNotification:(NSString*)txt{
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:3.5];
    [UIView setAnimationTransition:UIViewAnimationTransitionNone forView:messageView cache:YES];
    [lblTime setText:txt];
    [lblTime setTextAlignment:UITextAlignmentLeft];
    lblTime.frame = CGRectMake(260, 0, 258, 19);
    [UIView commitAnimations];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T04:26:24.090

试试这个...它可能满足你的要求

```
 int x;
float size;
@synthesize label;
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    label=[[UILabel alloc]init ];
           //WithFrame:CGRectMake(300, 400, 400, 30)];
    label.text=@"www.stackoverflow.com";
    size=[self getLabelWidth:label];
    label.frame=CGRectMake(300, 400, size, 30);

    label.backgroundColor=[UIColor clearColor];
    x=300;

    [NSTimer scheduledTimerWithTimeInterval:.01 target:self selector:@selector(clickme) userInfo:nil repeats:YES];

}

-(void)clickme
{
    x--;
    label.frame=CGRectMake(x, 400, size, 30);
    if( x==-size)
    {
        x=300;
    }
    [self.view addSubview:label];
}

-(float)getLabelWidth:(UILabel*)label1
{

    CGSize maximumSize = CGSizeMake(500,30);
    CGSize StringSize = [label1.text sizeWithFont:label1.font constrainedToSize:maximumSize lineBreakMode:UILineBreakModeTailTruncation];
    NSLog(@"width is %f",StringSize.width);
    return StringSize.width;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:20:11.047

试试这个可能会有所帮助

```
-(void)viewDidLoad {

    [super viewDidLoad];

    [self marqueeMessage:@"test"];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)marqueeMessage:(NSString *)messageString {
    UILabel *label = [[UILabel alloc] initWithFrame:(CGRectMake(0, 50, 90, 21))];
    //label.tag=nextIndex;
    label.text = messageString;
     label.backgroundColor=[UIColor clearColor];
    [self.view addSubview:label];
    [UIView beginAnimations:@"test" context:nil];
    [UIView setAnimationDuration:3];
    [UIView setAnimationDidStopSelector:@selector(marqueeMessage:)];
    [UIView setAnimationDelegate:self];

    label.frame = CGRectMake(360,50,90,21);
    [UIView commitAnimations];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T05:05:50.673

这有点骇人听闻。它所做的只是在标签中已经存在的文本之前定期添加空格，因此文本看起来像是在移动，而实际上标签没有。这是代码：

```
//Interface (.h)
@property (nonatomic, strong) IBOutlet UILabel *label; //Remember to connect this to    
                                                       //a label in Storyboards

//Implementation (.m)
-(void)moveText {
    [self.label setText:[NSString stringWithFormat:@" %@", self.label.text]];
}

- (void)viewDidLoad {
    [self.label setText:@"A very long and boring string"];

    //You can change the time interval to change the speed of the animation
    [NSTimer scheduledTimerWithTimeInterval:0.03 target:self selector:@selector(moveText) userInfo:nil repeats:YES];
} 
```

# sql - SQL Server 2005 - 列到行

> ID：15410045
> 
> 赞同：1
> 
> 时间：2013-03-14T13:02:25.740
> 
> 标签：sql, sql-server, sql-server-2005

对 SQL 来说相当新，我已经查看了几个我认为与我目前正在努力解决的问题相同的问题的答案。他们中的大多数都引用了 Pivot 功能，但我不知道这是否是我需要的，甚至不知道如何使它工作。（我正在使用 MS SQL Server Management Studio 2005）

基本上我有一个带有钥匙和一些植物的表格，输出如下：

```
Key  |  Plant
-------------
12   |  123
12   |  456
12   |  789
13   |  456
13   |  789
14   |  123
14   |  456
14   |  789
14   |  012
14   |  345
15   |  123
15   |  456 
```

我试图让我的输出显示如下数据：

```
Key  |  Plant
-------------------------------
12   |  123, 456, 789
13   |  456, 789
14   |  123, 456, 789, 012, 345
15   |  123, 456 
```

植物的数量会有很大差异，但我希望植物在植物列中显示为连接到键的植物字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:07:35.467

您不需要此`PIVOT`功能。*枢轴*会将植物行转换为单独的列。

要获得您想要的结果，您可以使用`FOR XML PATH`：

```
select distinct t1.[key],
  STUFF((SELECT distinct ', ' + t2.plant
         from yourtable t2
         where t1.[key] = t2.[key]
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,2,'') plant
from yourtable t1; 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/ab31c/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:08:13.333

试试这个：

```
SELECT
   t1.[Key],
   STUFF(
            (SELECT ', ' + t2.Plant
            FROM yourtable t2
            WHERE t1.[Key] = t2.[Key]
            FOR XML PATH( '' )),
         1, 2, '' )
FROM yourtable t1
GROUP BY [Key] 
```

# unity3d - 使用光线投射如何让玩家在两个对撞机之间运行而不会在unity3d中发生碰撞？

> ID：15410052
> 
> 赞同：-1
> 
> 时间：2013-03-14T13:02:41.577
> 
> 标签：unity3d, transform, collision-detection, raycasting, unityscript

我试图让玩家使用加速度计在两侧的两个对撞机之间的路径上运行。当我倾斜设备时，我希望我的播放器在与侧壁碰撞后回到中心。

我尝试过使用 Raycast，但我没有得到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:29:34.947

我不知道为什么在尝试检测碰撞时要使用 Raycasting。你有[`OnCollisionEnter()`](http://docs.unity3d.com/Documentation/ScriptReference/Collider.OnCollisionEnter.html)和[`OnTriggerEnter()`](http://docs.unity3d.com/Documentation/ScriptReference/MonoBehaviour.OnTriggerEnter.html)方法。这些会检测您何时与其他物体发生碰撞。发生这种情况时，您可以设置播放器对象的位置。

# php - PHP 图像调整大小（图库）

> ID：15410053
> 
> 赞同：1
> 
> 时间：2013-03-14T13:02:48.380
> 
> 标签：php, path, gallery, php-gd

我最近第一次使用 PHP 建立了一个网站。我已经使用各种教程创建了一个画廊脚本，如果没有退出，它会自动拉出保存在设定位置的图像并创建一个缩略图。

现在我的上传工作正常，就像拉过图像一样，但是由于某种原因，脚本不会重新调整图像的大小！这真的开始让我感到困惑，因为我以前从未使用过 php，所以我完全不知所措。我的脚本在下面

```
<?php
    # SETTINGS
    $max_width = 100;
    $max_height = 100;

    function getPictureType($ext) {
            if ( preg_match('/jpg|jpeg/i', $ext) ) {
                    return 'jpg';
            } else if ( preg_match('/png/i', $ext) ) {
                    return 'png';
            } else if ( preg_match('/gif/i', $ext) ) {
                    return 'gif';
            } else {
                    return '';
            }
    }

    function getPictures() {
            global $max_width, $max_height;
            if ( $handle = opendir("Design/Images/Gallery/") ) {
                    $lightbox = rand();
                    echo '<div id="gallery"><ul>';
                    while ( ($file = readdir($handle)) !== false ) {
                            if ( !is_dir($file) ) {
                                    $split = explode('.', $file); 
                                    $ext = $split[count($split) - 1];
                                    if ( ($type = getPictureType($ext)) == '' ) {
                                            continue;
                                    }
                                    if ( ! is_dir('Design/Images/Gallery/thumbs') ) {
                                            mkdir('Design/Images/Gallery/thumbs');
                                    }
                                    if ( ! file_exists('Design/Images/Gallery/thumbs/'.$file) ) {
                                            if ( $type == 'jpg' ) {
                                                    $src = imagecreatefromjpeg($file);
                                            } else if ( $type == 'png' ) {
                                                    $src = imagecreatefrompng($file);
                                            } else if ( $type == 'gif' ) {
                                                    $src = imagecreatefromgif($file);
                                            }
                                            if ( ($oldW = imagesx($src)) < ($oldH = imagesy($src)) ) {
                                                    $newW = $oldW * ($max_width / $oldH);
                                                    $newH = $max_height;
                                            } else {
                                                    $newW = $max_width;
                                                    $newH = $oldH * ($max_height / $oldW);
                                            }
                                            $new = imagecreatetruecolor($newW, $newH);
                                            imagecopyresampled($new, $src, 0, 0, 0, 0, $newW, $newH, $oldW, $oldH);
                                            if ( $type == 'jpg' ) {
                                                    imagejpeg($new, 'Design/Images/Gallery/thumbs/'.$file);
                                            } else if ( $type == 'png' ) {
                                                    imagepng($new, 'Design/Images/Gallery/thumbs/'.$file);
                                            } else if ( $type == 'gif' ) {
                                                    imagegif($new, 'Design/Images/Gallery/thumbs/'.$file);
                                            }
                                            imagedestroy($new);
                                            imagedestroy($src);
                                    }
                                    echo '<li><a href="Design/Images/Gallery/'.$file.'" rel="lightbox['.$lightbox.']">';
                                    echo '<img src="Design/Images/Gallery/thumbs/'.$file.'" alt="" />';
                                    echo '</a></li>';
                            }
                    }
                    echo '</ul></div>';
            }
    } 
```

?>

我相信这个错误与我的路径有关，但我不确定，任何人都可以对此有所了解吗？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:16:06.243

//只需在下面的函数中传递参数n你就可以得到调整大小的图像。

例如。

$sourcefile = SITE_PATH."pro_images/".$main_img_name;

```
$thumb = "thumb_".$main_img_name;   

$endfile =  SITE_PATH."pro_images/thumb/".$thumb;

    $thumbheight = 80;

    $thumbwidth = 80;

    $quality = 75;

function createThumbs($sourcefile, $endfile, $thumbwidth, $thumbheight, $quality){ 
```

preg_match("'^(.*).(gif|jpe?g|png)$'i", $sourcefile, $ext);

开关 (strtolower($ext[2])) {

```
 case 'jpg' : 

   case 'jpeg': $img  = imagecreatefromjpeg ($sourcefile);

                 break;
   case 'gif' : $img  = imagecreatefromgif  ($sourcefile);

                 break; 
```

案例 'png' : $img = imagecreatefrompng ($sourcefile);

休息;

}

//$img = imagecreatefromjpeg($sourcefile);

$宽度 = 图像x( $img ); $高度=图像（$img）；

$比例= $拇指宽度/$宽度；

```
$newwidth = ceil($width * $scale);
$newheight = ceil($height * $scale); 
```

// 创建一个新的临时图像。

$tmpimg = imagecreatetruecolor($newwidth, $newheight);

// 将旧图像复制并调整大小为新图像。

imagecopyresampled($tmpimg, $img, 0, 0, 0, 0, $newwidth, $newheight, $width, $height);

// 将缩略图保存到文件中。

imagejpeg($tmpimg, $endfile, $质量);

}

# c++ - c++ bulid 消息显示引用参数，而我按值传递参数

> ID：15410056
> 
> 赞同：1
> 
> 时间：2013-03-14T13:02:54.210
> 
> 标签：c++, codeblocks

我在 Code::Blocks 下使用 GNU GCC 编译器。

```
 int foo(long s){cout<<"long"<<endl;return 0;}
    int foo(float s){cout<<"float"<<endl;return 0;}

    int main()
    {
        double a(3.2);
        foo(a);
        return 0;
    } 
```

我知道这会触发模棱两可的错误，但构建消息告诉我

```
error: call of overloaded 'foo(double&)' is ambiguous 
```

我确实通过双变量的值传递参数，而不是通过上面写的引用。

每当我使用 const double 时：

```
foo(3.2);  // enclosed in main function 
```

构建消息告诉我这样的错误：

```
error: call of overloaded 'foo(double)' is ambiguous. 
```

想知道为什么会这样。

double 变量和 const double 之间的传递过程不一样吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:06:54.550

既不`foo(long)`也不`foo(float)`完全适合您的参数。因为`double`两者都可以隐式转换`long`，并且`float`调用是雄心勃勃的。

您可以提供额外的重载`double`或使用适当的参数类型。

请注意，您的示例**过于简化**。以下代码将触发您的错误消息：

```
double bar = 3.2;
foo(bar); 
```

这是因为`bar`是一个左值，而完美匹配将是一个`double&`. 不过，如果您提供`foo(double)`重载，它将仅接受此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:06:33.467

`foo(3.2)`正在传递一个双精度数，因此编译器不知道您的意思是要调用的`long`or`float`版本。`foo`

我认为我不会过多地阅读错误。编译器告诉您它已检测到给定调用站点的可能类型，但如果有一个函数可以调用 match ，则引用将衰减`foo(double)`。

除了为 提供重载外，您还可以使用`double`a 来制作文字`float``3.2f`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T13:13:09.387

从这一小段代码中，我无法说出他为什么给你那个特定的错误。我试图重新创建它，但只有在没有 & 的情况下才得到它。您能否显示具有相同错误的整个代码或更大的示例？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T13:05:56.980

你打电话时

```
foo(3.2); 
```

编译器不知道您指的是哪一个 - “3.2”可以转换为浮点数或长整数。

如果您拨打电话：

```
foo((float)3.2); 
```

有用。或投长，如果你想。

您的问题似乎是为什么错误与 double& 有关 - 这是因为您的 double 变量与 foo(double&) 的重载最接近。

我认为您将类型 - double - 与 double 类型的**变量**混淆了。看看这两个例子的区别：

```
foo(3.2) 
```

这里编译器告诉你没有采用 **双精度类型的重载方法**

```
double a(3.2);
foo(a); 
```

在这一个中，您实际上是在传递变量，但是由于没有重载函数可以传入 double 类型的变量（即 double&），它告诉您没有采用**double 变量**的重载方法，或双&。

希望这是有道理的...

# asp.net - URI 中复杂类型的 WebAPI 帮助页面

> ID：15410057
> 
> 赞同：3
> 
> 时间：2013-03-14T13:02:55.143
> 
> 标签：asp.net, asp.net-mvc, asp.net-web-api

我正在使用[WebAPI 帮助页面](http://blogs.msdn.com/b/yaohuang1/archive/2012/08/15/introducing-the-asp-net-web-api-help-page-preview.aspx)来提供文档。文档生成良好（来自 xml 注释），除非我在 uri 中使用复杂模型。所以，我得到以下文档

```
GET service/Tst2    No documentation available. 
```

对于方法：

```
 /// <summary>
    /// description
    /// </summary>
    [HttpGet]
    public string Tst([FromUri] TstModel filter)
    {
        return null;
    }

    public class TstModel
    {
        public int Id { get; set; }
    } 
```

对于具有简单 int/string 参数的其他方法，它按预期工作。如果我删除*[FromUri]*属性它也可以工作，但是然后

所以问题是：我怎样才能显示这些方法的文档？如何为取自 URI 的复杂类型提供文档？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T14:30:30.477

它输出“没有可用的文档”的原因。是因为我的`TstModel`类是一个嵌套类（在控制器内定义），这使得 WebAPI 帮助生成错误的 XPath 来查找 xml-comments。搬出`TstModel`控制器有帮助。

PS HelpPage 代码中的修复很简单，我只是不知道在哪里报告错误和修复（目前在 NuGet 中编写）:)

它的：`XmlDocumentationProvider.GetTypeName`

第 109 行：`return type.FullName.Replace("+", "."); //was: return type.FullName`

和第 101 行： `string typeName = genericType.FullName.Replace("+", "."); //was: string typeName = genericType.FullName`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-14T16:35:09.780

关于您关于未为使用 [FromUri] 属性修饰的复杂类型生成帮助的原始问题，这是我们将要处理的已知问题。

# xml - XSD：定义 2 个具有相同名称但属性定义准确的元素

> ID：15410065
> 
> 赞同：0
> 
> 时间：2013-03-14T13:03:06.770
> 
> 标签：xml, xsd

有没有办法为具有相同名称的 2 个元素定义具有固定值和子元素的多个属性？

```
<Root>

  <element 
    attributeA="1" 
    attributeB="2">
    <subElement/>
  </element>

  <element 
    attributeA="3" 
    attributeB="4">
    <subElement/>
  </element>

 </Root> 
```

我希望这些元素中的任何一个都是可能的，但不允许以下元素：

```
<element 
   attributeA="1" 
   attributeB="4">
   <subElement/>
</element> 
```

我知道在 xsd 中不可能在一个“父级”下有 2 个同名的元素。仅在元素上创建并通过枚举限制它似乎不起作用，因为我必须避免“混合”形式。元素的名称必须相同，并且必须具有父元素。

有没有我看不到的解决方案或解决此问题的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T15:51:53.100

这样的模型将违反约束“元素声明一致”，该约束要求如果内容模型中的两个元素粒子具有相同的名称，则它们必须具有相同的类型。

当然，您可以在 XSD 1.1 中使用断言来实现。

# php - 为什么此代码生成的随机码有时会存储为 7 位而不是 8 位

> ID：15410070
> 
> 赞同：4
> 
> 时间：2013-03-14T13:03:28.580
> 
> 标签：php, mysql

下面的代码生成八位数字，但在存储在 db 时，有时存储为 7 位。db 列宽取为 int(11)，db 为 mysql(5.0.45)

```
srand ((double) microtime( )*1000000);
 $maxid = rand(0,100000000);
 $mtidno = str_pad($maxid,8);
 $shuffled = str_shuffle($mtidno);
 echo  $shuffled; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T13:05:12.577

首先，通过`str_pad`这样使用，您正在引入空格，这可能会进入您的“随机”数字的中间。

把你的`str_pad`电话改成这样：

```
str_pad($maxid, 8, "0"); 
```

摆脱空间。但请注意，其他问题提供了创建随机 8 位数字的更好方法。

然后，当您的 shuffle 结果以`0`'s 开头时，它们会掉落。

为了补救，您可以`CHAR(8)`在数据库中使用 a 。然后它将显示前导零。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:20:05.883

我很惊讶你甚至得到 7 位数。填充不会只是在右侧附加空格吗？如果 rand 函数返回 1 会发生什么？

纯粹靠运气——随机性，你可能会得到 7 位和 8 位数字。尝试一段时间，您应该会开始看到 1 到 8 位数字之间的每个组合。

再加上 Bart 所说的，领先的 0 只会下降。

说到这，如果你有 rand，你为什么需要 shuffle？以下应该足够了。

```
srand ((double) microtime( )*1000000);
$maxid = rand(10000000,99999999);
echo $maxid; 
```

测试代码（说明错误逻辑）

```
srand ((double) microtime( )*1000000);

for($i = 0; $i < 1000000; $i++)
{
    $maxid = rand(0,100000000);
    if($maxid < 100000){
        echo  $maxid . "<br>";
        $mtidno = str_pad($maxid,8);
        $shuffled = str_shuffle($mtidno);
        echo  $shuffled . "<br>";  
    }
}
echo "done <br>"; 
```

请参阅以下输出，它清楚地显示了洗牌后的空格。

```
0
0
12207
20 21 7
82397
78 329
64086
64086
42724
4 4 2 27
21362
216 32
57983
7 3 598 
```

# c# - “找不到类型或命名空间名称‘TestSuite’（您是否缺少 using 指令或程序集引用？）

> ID：15410072
> 
> 赞同：1
> 
> 时间：2013-03-14T13:03:30.187
> 
> 标签：c#, selenium, selenium-webdriver, selenium-ide

我面临一个错误“找不到类型或命名空间名称'TestSuite'（您是否缺少 using 指令或程序集引用？）”任何人都可以告诉我有什么问题。我正在使用 VS2010 Ultimate 并具有以下功能：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using NUnit.Framework;
using OpenQA.Selenium;
using OpenQA.Selenium.Firefox;
using OpenQA.Selenium.Support.UI;

[Suite]
public static TestSuite Suite
{
    //Doing test suites
} 
```

# c# - 如何在 C# 中将 UserControl 文本框插入 DataGridView？

> ID：15410073
> 
> 赞同：0
> 
> 时间：2013-03-14T13:03:36.627
> 
> 标签：c#, datagridview, user-controls, rows, datagridviewcolumn

在 Sql Server 2005 中，在表单加载中我编写了这段代码。txtPrprCase 是一个 UserControl 并验证第一个字符为大写。如何将此控件添加到 DataGridView。我尝试以下代码。但它不起作用。

```
ciscontrols.txtPrprCase txt = new ciscontrols.txtPrprCase();
        txt.Name = "Customer Name";
        this.dataGridView2.RowCount = 1;
        foreach (DataGridViewRow row in dataGridView2.Rows)
        {
            row.Cells[0].Value = txt;
        } 
```

以下代码用于验证

```
ciscontrols.txtPrprCase txt = new ciscontrols.txtPrprCase();
this.dataGridView2.Rows.add(txt); 
```

它可以工作，但它不包含列标题和行标题...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:07:55.767

[这对你来说是完美的。](http://msdn.microsoft.com/en-us/library/7tas5c80.aspx)

# testing - 在 AngularJS 和 Testacular 中测试广播

> ID：15410074
> 
> 赞同：4
> 
> 时间：2013-03-14T13:03:39.260
> 
> 标签：testing, angularjs, jasmine, karma-runner

我正在使用截获 401 响应的[angular-http-auth模块。](https://github.com/witoldsz/angular-http-auth)`event:auth-loginRequired`如果有可以使用 $on() 接收的 401 响应，此模块会广播。但是我该如何测试呢？

```
beforeEach(inject(function($injector, $rootScope) {
  $httpBackend = $injector.get('$httpBackend');
  myApi = $injector.get('myApi');
  scope = $rootScope.$new();
  spyOn($scope, '$on').andCallThrough();
}));
describe('API Client Test', function() {
  it('should return 401', function() {
    $httpBackend.when('GET', myApi.config.apiRoot + '/user').respond(401, '');
    myApi.get(function(error, success) {
      // this never gets triggered as 401 are intercepted
    });
    scope.$on('event:auth-loginRequired', function() {
      // This works!
      console.log('fired');
    });

    // This doesn't work
    expect($scope.$on).toHaveBeenCalledWith('event:auth-loginRequired', jasmine.any(Function));

    $httpBackend.flush();
  });
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-15T06:46:15.380

根据您的评论，我认为您不需要任何`expect($scope.$on).toHaveBeenCalledWith(...);`东西，因为它可以确保某些东西真正听到了事件。

为了断言事件被触发，您必须准备好一切必要的东西，然后执行导致事件广播的操作。我想可以通过以下方式概述规范：

```
it('should fire "event:auth-loginRequired" event in case of 401', function() {
    var flag = false;
    var listener = jasmine.createSpy('listener');
    scope.$on('event:auth-loginRequired', listener);
    $httpBackend.when('GET', myApi.config.apiRoot + '/user').respond(401, '');

    runs(function() {
        myApi.get(function(error, success) {
            // this never gets triggered as 401 are intercepted
        });
        setTimeout(function() {
            flag = true;
        }, 1000);
    });

    waitsFor(function() {
        return flag;
    }, 'should be completed', 1200);

    runs(function() {
        expect(listener).toHaveBeenCalled();        
    });
}); 
```

# blackberry - 删除请等待返回键上的弹出屏幕

> ID：15410079
> 
> 赞同：1
> 
> 时间：2013-03-14T13:03:49.663
> 
> 标签：blackberry

我正在使用下面的代码在黑莓应用程序中创建请等待弹出窗口。我想在设备后按时删除该弹出屏幕，**但**我无法这样做，因为在显示时请等待弹出窗口整个屏幕被阻止直到完成的线程操作。

这是我的代码：

```
public class PleaseWaitLoginPopupScreen extends PopupScreen {

    //statics ------------------------------------------------------------------

    private AnimatedGIFField _ourAnimation = null;
    private LabelField _ourLabelField = null;
    private static String pleaseWaitText="";
    private static PleaseWaitLoginPopupScreen ref;

    public static PleaseWaitLoginPopupScreen getInstance(){
        if(ref!=null){
            ref=new PleaseWaitLoginPopupScreen(Constant.PLEASE_WAIT_TEXT);
        }
        return ref;
    }

    public PleaseWaitLoginPopupScreen(String text) {
        super(new VerticalFieldManager(VerticalFieldManager.VERTICAL_SCROLL | VerticalFieldManager.VERTICAL_SCROLLBAR));
        GIFEncodedImage ourAnimation = (GIFEncodedImage) GIFEncodedImage.getEncodedImageResource("loader.gif");
        _ourAnimation = new AnimatedGIFField(ourAnimation, Field.FIELD_HCENTER);
        this.add(_ourAnimation);
        _ourLabelField = new LabelField(text, Field.FIELD_HCENTER);
        this.add(_ourLabelField);
    }

    public static void showScreenAndWait(final Runnable runThis, String text) {
        pleaseWaitText=text;
        final PleaseWaitLoginPopupScreen thisScreen = new PleaseWaitLoginPopupScreen(text);
        Thread threadToRun = new Thread() {
            public void run() {
                // First, display this screen
                UiApplication.getUiApplication().invokeLater(new Runnable() {
                    public void run() {
                        UiApplication.getUiApplication().pushScreen(thisScreen);
                    }
                });
                boolean exceptionFlag = false;
                // Now run the code that must be executed in the Background
                try {
                    runThis.run();
                } catch (Throwable t) {
                    exceptionFlag = true;
                    t.printStackTrace();
                    //throw new RuntimeException("Exception detected while waiting: " + t.toString());

                }finally{
                    // Now dismiss this screen
                    if(exceptionFlag){//IF EXCEPTION OCURES THAN THIS CODE WILL RUN TO STOP THE PLEASE WAIT POP TASK
                        UiApplication.getUiApplication().invokeLater(new Runnable() {
                            public void run() {
                                UiApplication.getUiApplication().popScreen(thisScreen);
                            }
                        });
                    }
                }
            }
        };
        threadToRun.start();
    }

    public void dismissPopupScreen(){
        UiApplication.getUiApplication().invokeLater(new Runnable() {
            public void run() {
                UiApplication.getUiApplication().popScreen(PleaseWaitLoginPopupScreen.this);
            }
        });
        /*synchronized (UiApplication.getEventLock()) {
            UiApplication.getUiApplication().popScreen(PleaseWaitLoginPopupScreen.this);
        }*/
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T22:28:02.543

如果你想捕捉**返回**(ESC) 按键，并使用它来关闭弹出屏幕，那么你可以在你的类中覆盖[keyChar(char,int,int)](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/Screen.html#keyChar%28char,int,int%29)方法`PleaseWaitLoginPopupScreen`：

```
 protected boolean keyChar(char c, int status, int time) {
      if (c == Characters.ESCAPE) {
         close();
      }
      return super.keyChar(c, status, time);
   } 
```

但是，这一切只是简单地删除弹出屏幕。您可能还应该尝试停止`Runnable`您开始的操作。在 BlackBerry Java 中，这需要在请求停止的代码和`Runnable`自身之间协作完成。

[有关更多信息，请参阅 Arhimed 的此答案](https://stackoverflow.com/a/13552114/119114)

在您的情况下，您可以将`Thread`变量存储为成员

```
private Thread _threadToRun; 
```

分配它`showScreenAndWait()`：

```
thisScreen._threadToRun = new Thread() { 
```

然后用`keyChar()`我展示的方法取消它：

```
 protected boolean keyChar(char c, int status, int time) {
      if (c == Characters.ESCAPE) {
         _threadToRun.interrupt();
         close();
      }
      return super.keyChar(c, status, time);
   } 
```

然后，在`Runnable()`您传递给的 中`showScreenAndWait()`，您需要进行一些检查以查看线程是否已被中断：

```
 if (!Thread.currentThread().isInterrupted()) {
     // do more stuff
 } 
```

如何放置这些检查取决于任务。如果您在您的`run()`方法中下载 10 个文件，您可能应该`isInterrupted()`在 10 个下载之间进行检查。如果`run()`包含`while()`循环，则每个循环检查一次。这将决定**何时**可以停止作业。

# javascript - 通过 Javascript 访问 HTML 表格中的标签

> ID：15410093
> 
> 赞同：1
> 
> 时间：2013-03-14T13:04:13.990
> 
> 标签：javascript, html, dom

我有以下表结构：

```
<table id="currentloc_table">
    <tr>
    <th></th>
    <th>Name</th>
    <th>Details</th>
    </tr>
    <tr>
        <td><input id='viewonMapCheckbox' type='checkbox'></td>
        <td>
            <span class="tooltip" href="#">
                <span class="custom info">
                    <em>
                    </em>
                    Last Activity: 2013-03-12 03:29:21<br/>
                    Latitude: <span id="lat">30</span><br/>
                    Longitude: <span id="lon">70</span><br/>
                </span>
            </span>
        </td>
        <td>Details</td>
    </tr>
</table> 
```

我需要使用 Javascript 设置纬度和经度值，但无法使其工作。请帮帮我。这是我编写的代码：

```
var loc_table = document.getElementById('currentloc_table');
var loc_table_rows_count = document.getElementById('currentloc_table').getElementsByTagName("tr").length;
for (var i = 0; i < loc_table_rows_count; i++) {
    if (i > 0) {//skipping header row
        var row = loc_table.rows[i];
        row.cells[1].firstChild.firstChild.getElementById("lat").innerHTML = "31";
        row.cells[1].firstChild.firstChild.getElementById("lon").innerHTML = "71";
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:06:10.983

`id`是一个全局字段，只需这样做：

```
document.getElementById("lat").innerHTML = "31";
document.getElementById("lon").innerHTML = "71"; 
```

而不是你写的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:12:35.237

看起来你需要不止一排。在这种情况下，您不能将 ID 用于跨度（我们应该在页面上有一个唯一的 ID）。关于解决您的任务：将您的`ID`属性更改为`CLASS`. 简单的JS解决方案：

```
var loc_table = document.getElementById('currentloc_table');
var loc_table_rows = loc_table.getElementsByClassName("table_row");
for (var i = 0; i < loc_table_rows.length; i++) {
    var row = loc_table_rows[i];
    var rowLatitude=row.getElementsByClassName('lat')[0].innerHTML='31';
    var rowLongitude=row.getElementsByClassName('lon')[0].innerHTML='71';
} 
```

HTML 示例：

```
<table id="currentloc_table">
    <tr>
        <th></th>
        <th>Name</th>
        <th>Details</th>
    </tr>
    <tr class="table_row">
        <td>
            Latitude: <span class="lat">30</span><br/>
            Longitude: <span class="lon">70</span><br/>
        </td>
    </tr>
    <tr class="table_row">
        <td>
            Latitude: <span class="lat">30</span><br/>
            Longitude: <span class="lon">70</span><br/>
        </td>
    </tr>
</table> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:08:31.567

```
var loc_table = document.getElementById('currentloc_table');
var loc_table_rows_count = document.getElementById('currentloc_table').getElementsByTagName("tr").length;
for (var i = 1; i < loc_table_rows_count; i++) {
        document.getElementById("lat"+i).innerHTML = "31";
        document.getElementById("lon"+i).innerHTML = "71";
} 
```

`id`在您的 HTML 中，在属性中添加行号。例如 ：

```
<table id="currentloc_table">
    <tr>
    <th></th>
    <th>Name</th>
    <th>Details</th>
    </tr>
    <tr>
        <td><input id='viewonMapCheckbox' type='checkbox'></td>
        <td>
            <span class="tooltip" href="#">
                <span class="custom info">
                    <em>
                    </em>
                    Last Activity: 2013-03-12 03:29:21<br/>
                    Latitude: <span id="lat1">30</span><br/>
                    Longitude: <span id="lon1">70</span><br/>
                </span>
            </span>
        </td>
        <td>Details</td>
    </tr>
</table> 
```

# rest - 未找到提供程序类：运行 Jersey REST 示例应用程序时

> ID：15410096
> 
> 赞同：3
> 
> 时间：2013-03-14T13:04:19.887
> 
> 标签：rest, jersey

我试着研究它。但是，由于我对此很陌生，所以无法弄清楚这个问题。我附上了几张截图，看看我现在面临的问题。

![在此处输入图像描述](../Images/073f4d86a9a2dd69e36d29222ff075a7.png)

![在此处输入图像描述](../Images/869287ad4865822f793fb6bd523284ca.png)

![在此处输入图像描述](../Images/31f8a17a6281222907689102b5cb776a.png)

![在此处输入图像描述](../Images/e4bd96d0f5af74dd35ec725d3da81003.png)

```
@Path("/emp")
public class EmployeeService {

@GET
@Path("/emp/{empID}")
@Produces(MediaType.APPLICATION_XML)
public Employee getEmployee(@PathParam(value = "empID") String empID) {
    Employee employee = new Employee();
    employee.setEmailId(empID);
    employee.setName("Rony John");
    employee.setEmailId("rony.java@gmail.com");
    return employee;
}

@POST
@Path("/create")
@Consumes(MediaType.APPLICATION_XML)
@Produces(MediaType.APPLICATION_XML)
public Employee createEmployee(Employee employee) {
    // Create logic
    return employee;

}

@POST
@Path("/update")
@Consumes(MediaType.APPLICATION_XML)
@Produces(MediaType.APPLICATION_XML)
public Employee updateEmployee(Employee employee) {
    employee.setName(employee.getName() + " updated");
    return employee;
}

@DELETE
@Path("/delete/{empID}")
public Response deleteEmployee(@PathParam(value = "empID") String empID) {
    return Response.status(200)
            .entity("Employee with " + empID + " is deleted successfully.")
            .build();

} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T18:36:39.360

缺乏提供者无关紧要，它只是意味着你没有任何提供者。

您有一个`index.jsp`，但如果您在上下文根 (/) 映射 Jersey 过滤器，则正确地说那里没有资源 - 根据您的屏幕截图，您只有一个资源，从该资源开始`/emp`，有更深层次的 CRUD 操作的子资源路径。

编辑：再看一遍，你`index.jsp`在 WEB-INF 中。我认为这不应该基于您似乎试图将一个简单的示例放在一起的事实。

那么，您希望看到`/JerseyRESTCRUD/`什么？

# node.js - Node.js MD5 生成的结果与 htpasswd -m 不同

> ID：15410104
> 
> 赞同：0
> 
> 时间：2013-03-14T13:04:55.957
> 
> 标签：node.js

使用密码生成密码文件时`htpasswd -m -c file admin`，`admin`结果如下所示：

```
cat file  
admin:$apr1$V.aqW878$JCj8ivmSnFp3BnTCtLAuN. 
```

当我尝试使用 node.js 对其进行身份验证时，结果大不相同：

```
Digest Hex: 21232f297a57a5a743894a0e4a801fc3 
```

我试过遵循[这个现有的 StackOverflow 解决方案](https://stackoverflow.com/questions/14388745/nodejs-md5-with-base64-digest-algorithm-wrong-result)：

```
new Buffer('21232f297a57a5a743894a0e4a801fc3').toString('base64');
MjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzM= 
```

所以结果还是错了。

当我将摘要更改为`base64`结果时：

```
ISMvKXpXpadDiUoOSoAfww== 
```

我的问题的底线是我没有得到相同的哈希值并且需要帮助。任何建议将不胜感激。

谢谢罗曼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T07:52:01.343

好吧，我找到了答案。htpasswd 使用存储在密码字符串中间位的“盐”：

```
$apr1$V.aqW878$JCj8ivmSnFp3BnTCtLAuN.
Salt: V.aqW878 
```

[node-pass 模块](https://github.com/andris9/pass/blob/master/pass.js)给了我正确的线索。见`validate_md5`。它使用本机 openssl 命令生成盐渍 MD5 哈希。

回想起来，这是有道理的，因为 MD5 不再安全了。这就是我多年来没有使用它并且在这里有点偏离轨道的原因。本质上，任何标记的东西`$apr1$`都是这样处理的。

# telerik - Telerik RadTextbox 输入表现得像水印

> ID：15410108
> 
> 赞同：0
> 
> 时间：2013-03-14T13:05:10.040
> 
> 标签：telerik, sitefinity, sitefinity-5, radtextbox

我在 Sitefinity 5.4 网站的一个 .ascx 文件中有一个 Telerik RadTextbox。当提交包含 RadTextbox 的表单并且服务器抛出一些错误，并且用户返回并尝试重新提交表单时，即使初始提交显示有输入，也会出现验证消息。看起来第一次提交的输入被视为水印。

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:51:40.087

用户是否使用浏览器返回按钮返回？然后验证仍然存在。尝试先通过客户端验证消除错误，然后再通过服务器端验证。如果错误仍然存​​在，您应该清除控件负载上的验证消息（如果它当然不是回发）

# tfs - 有没有办法找出在 TFS 中创建特定分支的源变更集？

> ID：15410110
> 
> 赞同：12
> 
> 时间：2013-03-14T13:05:12.217
> 
> 标签：tfs, changeset

我的情况如下。我的团队使用 TFS 2012 进行源代码控制。我的队友从另一个分支的特定变更集（不是那一刻的最后一个）创建了一个分支。我需要弄清楚分支是从哪个确切的变更集中创建的，以及使用了哪个分支。

我试图在 VS 的源代码管理资源管理器的“查看历史记录”中找到它。如果与 svn 相比，在创建分支的版本中有一个属性，该属性存储了初始版本和创建分支的初始位置。在 TFS 中，变更集详细信息看起来很像，它们不包含此类信息。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-19T14:10:07.267

就在这里。**discens**是对的，您可能会使用`Track Changeset`功能。顺便说一句，类似的问题已经在 SO 上得到了回答，[这里是](https://stackoverflow.com/questions/12835798/find-changeset-id-parent-of-a-branch-in-tfs)。答案包含指向博客文章的链接，[其中](http://netexp.blogspot.com/2012/11/tfs-who-is-father-of-my-branch.html)包含许多详细信息，包括 API 和自定义命令行工具。

但是，方法并不那么明显。为了澄清这一点，这里有一个简短的分步说明，说明如何在 中实现结果`Source Control Explorer`：

1.  找到您的子分支`Source Control Explorer`
2.  右键单击它以获取上下文菜单，选择`View History`.
3.  在历史查看器中找到分支的第一个变更集，右键单击它以获取上下文菜单，选择`Track Changeset`.
4.  您将看到分支方案及其继承结构。**在这一步中，您将找出 parent**。
5.  每个检测到的分支附近都有一个复选框，但您孩子的父级通常未选中。先检查一下。必须无条件检查子分支，因此要选择的两个复选框是父级和子级。
6.  不要忘记使用按钮在`Path filter`输入字段中找到您的子分支。`Browse...`
7.  按下`Visualize`底部的按钮。您将看到带有代表这两个分支的矩形的图片。父分支矩形应包括此分支中变更集的排序列表。该列表可能很大，但源变更集（最初创建您的孩子的地方）应该是最后一个。
8.  ？？？利润！！！！

[您可以在博](http://netexp.blogspot.com/2012/11/tfs-who-is-father-of-my-branch.html)文中看到最终步骤的示例屏幕截图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T15:32:19.537

您可以使用`Track Changeset`我相信会向您展示分支历史及其包含的变更集的功能。

您可以从`Source Control Explorer`

# codeigniter - CodeIgniter 2 项目中的 CKEditor v.4

> ID：15410112
> 
> 赞同：2
> 
> 时间：2013-03-14T13:05:21.320
> 
> 标签：codeigniter, view, editor, ckeditor

有人在 Codeigniter 2 项目中使用 CKEditor 4.0 吗？我可以找到与 CKeditor 3 集成。非常好的教程，但第四版的项目结构与第三版不同。请帮助将 ckeditor 4 与 codeigniter 2 集成，或者请分享一些教程链接，并提供很好的解释。

UPD我试过这种方式。我在我的视图中添加了以下内容

```
<script type="text/javascript">
    CKEDITOR.replace( 'anons_area' );
</script>

<?php $anons_data = array(
        'name'        => 'anons',
        'id'          => 'anons_area',
        'value'       => 'Введите анонс',
        'rows'        => '10',
        'cols'        => '50',
        'style'       => 'width:50%',
        );
        echo form_textarea($anons_data); ?> 
```

但它不起作用。

UPD2 我发现了为什么无法将编辑器加载到浏览器。Firebug 说禁止访问 ckeditor.js 脚本，您无权访问所请求的对象。它要么是读保护的，要么是服务器不可读的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T15:51:16.957

好吧，这真的一点都不难……

把它放在你想要 ckEditor 的页面的头部，显然指向你的应用程序的正确路径：

```
<script src="'.base_url().'assets/lib/ckeditor/ckeditor.js"></script> 
```

然后在您想要编辑器的正文中：

```
<textarea cols="80" id="editorName" name="editorName" rows="60">

</textarea> 
```

在页面的底部：

```
<script type="text/javascript">
    CKEDITOR.replace( 'editorName' );
</script> 
```

老实说，这很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T19:06:52.117

使用基于 ck 示例页面中的代码的 codeigniter 和 Ckeditor 4.02

```
 <script src="<?php echo base_url();?>ckeditor/ckeditor.js"></script>

 <?php
 // static example to populate form with text
 $formvalue = "Here is some text to appear in the form box. " ;
 ?> 

 <textarea class="ckeditor" name="editor1"><?php echo $formvalue ?></textarea> 
```

您还可以使用 CI 表单助手

```
 <?php

 $formvalue = "Here is some text to appear in the form box." ;
 $formdata = array(
      'class'  => 'ckeditor',
          'name'        => 'editor1',
          'id'          => 'SomeID',
          'value'       => $formvalue
        );

 echo form_textarea($formdata) ;
 ?> 
```

下一步将用数据库结果替换 $formvalue 以填充表单（如编辑博客文章等）。如果你使用 CI Form helper 需要先加载它，最简单的方法是在 config/autoload.php 中自动加载它

现在——如果某个聪明的人有一些关于创建自定义工具栏的技巧......？

# spring - 为什么自动装配在以下情况下不起作用：

> ID：15410116
> 
> 赞同：-1
> 
> 时间：2013-03-14T13:05:35.743
> 
> 标签：spring

我有以下课程：

```
@component
public class Car extends abstract Vehicle {

  public Car() {
    super(10);
  }

}

public abstract class Vehicle {

   @Autowired
   private Validator em;

   public Vehicle(int i) {
     // init
   }

  public int getVehicle() {
  }
} 
```

当我使用以下内容创建 bean 时：

```
applicationContext.getAutowireCapableBeanFactory().createBean(..) 
```

它失败并出现异常声明无法注入验证器 bean...

但是，如果我将自动装配更改为设置器注入，它的工作方式如下：

```
public abstract class Vehicle {

   private Validator em;

   public Vehicle(int i) {
     // init
   }

   public int getVehicle() {
   }

   @Autowired
   public set Em(Validator em) {
     this.em = em;
   } 
```

}

有人可以向我解释一下，这与 bena 生命周期的工作方式有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:28:20.447

Spring 允许`@Autowiring`在抽象类中，所以我在这里看不到任何问题。因为如果你在 setter 上放注解，我怀疑你对类有某种循环依赖，`Validator`所以这就是为什么你必须在 setter 上放注解的原因。

# python - 使用列表推导构建元组

> ID：15410119
> 
> 赞同：81
> 
> 时间：2013-03-14T13:05:40.913
> 
> 标签：python

如何使用列表推导从列表中构建 2 元组的元组。这将相当于

```
tup = ()
for element in alist:
    tup = tup + ((element.foo, element.bar),) 
```

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2013-03-14T13:06:49.380

```
tup = tuple((element.foo, element.bar) for element in alist) 
```

从技术上讲，它是一个[生成器表达式](http://docs.python.org/2/reference/expressions.html#generator-expressions)。它就像一个列表推导式，但它的评估是惰性的，不需要为中间列表分配内存。

为了完整起见，列表理解如下所示：

```
tup = tuple([(element.foo, element.bar) for element in alist]) 
```

PS：`attrgetter`不是更快（`alist`这里有一百万个项目）：

```
In [37]: %timeit tuple([(element.foo, element.bar) for element in alist])
1 loops, best of 3: 165 ms per loop

In [38]: %timeit tuple((element.foo, element.bar) for element in alist)
10 loops, best of 3: 155 ms per loop

In [39]: %timeit tuple(map(operator.attrgetter('foo','bar'), alist))
1 loops, best of 3: 283 ms per loop

In [40]: getter = operator.attrgetter('foo','bar')

In [41]: %timeit tuple(map(getter, alist))
1 loops, best of 3: 284 ms per loop

In [46]: %timeit tuple(imap(getter, alist))
1 loops, best of 3: 264 ms per loop 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-09-11T00:49:59.030

您可以使用以下表达式

```
tup = *[(element.foo, element.bar) for element in alist] 
```

这将首先生成一个元组列表，然后将该元组列表转换为一个元组元组。

# eclipse-plugin - 如何在 Eclipse 的 IWizardPage 中以编程方式单击后退按钮

> ID：15410120
> 
> 赞同：0
> 
> 时间：2013-03-14T13:05:42.940
> 
> 标签：eclipse-plugin

我正在编写一个 Eclipse 插件，我想为我的新项目类型创建一个向导。我通过扩展 org.eclipse.jface.wizard.WizardPage 的类创建页面。我的要求是，根据一页中的某些条件，我需要返回上一页而不按页面上的后退按钮（以编程方式）。

可能吗？

提前一百万谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T15:57:08.370

我不认为这是一个好主意。这样做会使用户感到困惑。我会禁用完成和下一步按钮并给出错误，告诉用户他必须返回第一页。

如果您想重用第一页中的某些 UI，请将 UI 定义为新类并重用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T13:25:19.360

我使用 WizardDialog:showPage() 方法实现了类似的东西：

我的向导.java

```
public void createPageControls(Composite pageContainer) {
    // TODO Auto-generated method stub
    super.createPageControls(pageContainer);
    wizardDialog = (WizardDialog) getContainer();
}

public void skipProcessPage() {
    wizardDialog.showPage(workPage == arisDbPage ? focusPage : arisDbPage);
}

public void setWorkPage(IWizardPage workPage) {
    this.workPage = workPage;
} 
```

在这里，processPage 进行了冗长的数据库查找！

HTH 托马斯

# java - 如何制作安全的日期设置器方法

> ID：15410126
> 
> 赞同：2
> 
> 时间：2013-03-14T13:05:54.307
> 
> 标签：java, date

如何使日期设置器方法安全。下面的方法正确吗？

```
public void setBirthDate(Date birthDate) {
        birthDate = (Date)birthDate.clone();
} 
```

谢谢杰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:15:46.457

`Date`是一种对象类型，但它是可变的，这意味着一旦`date`创建了对象，就可以更改它。`Date`类`clone()`从对象类实现。因此，使用克隆创建 setter 方法总是更好。

```
public void setBirthDate(Date birthDate) {  
    this.birthDate = (Date) birthDate.clone();  
}  

public Date getBirthDate() {  
    return (Date) this.birthDate.clone();  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:32:42.953

你最好用`this.birthDate = new Date (birthDate.getTime ())`. 在这种情况下，您肯定知道会发生什么。

# javascript - 按钮元素上的 onSubmit 事件会起作用吗？

> ID：15410128
> 
> 赞同：1
> 
> 时间：2013-03-14T13:06:06.273
> 
> 标签：javascript, html, dom

以下是代码。

```
<html>
    <head>
        <script type="text/javascript">
            function call() {
                alert("hai");
            }
        </script>
    </head>
    <body>
        <form name="login" method="post" action="">
            <input type="submit" name="Submit" value="login" onSubmit="call()">
        </form>
    </body>
</html> 
```

`onSubmit`是否可以在输入元素类型内创建事件`button`。

这是为了一个任务。我的导师告诉我，这是可能的。任何帮助将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-14T13:10:17.583

实际上“onsubmit”是一个`form`元素事件。如果您想捕获表单提交事件（可以通过单击按钮、自动或按 Enter 来完成，您需要执行以下操作：

```
<form ... onsubmit="func();"> 
```

否则您只能捕获提交按钮单击事件，例如：

```
<input type="submit" ... onclick="func();"> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-14T13:08:53.760

您`onsubmit`应该应用于表单，因为它是提交的表单 - 而不是按钮。

从[HTML4 规范](http://www.w3.org/TR/html4/interact/scripts.html)：

> onsubmit 事件在提交表单时发生。**它仅适用于 FORM 元素。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T13:10:48.873

我认为这是不可能的。

您应该挂钩`onclick`提交事件。表单可以有 onsubmit 事件，但按钮不能有 onsubmit。

你应该这样做：

```
<input type="submit" name="Submit" value="login" onclick="call();"> 
```

# iphone - 如何检测设备方向与界面方向不同？

> ID：15410136
> 
> 赞同：3
> 
> 时间：2013-03-14T13:06:43.590
> 
> 标签：iphone, ios, objective-c, uinavigationcontroller

最初`UINavigationController`( `Navigator`) 的子类是根控制器，它支持所有方向。子类覆盖`supportedInterfaceOrientations`并提供属性来设置支持的方向。

`Navigator`导航堆栈的根视图控制器（的子类`UITableViewContreller`）控制支持的方向（取决于哪个视图控制器位于堆栈顶部）。它在覆盖中设置`Navigator`了方向属性。`didSelectRowAtIndexPath`

如果在设备处于不同方向时进行转换（因为当前视图不支持它并且这不是假定的交互方式）并且新视图支持该设备方向，则视图保持与设备方向不同的方向。然后需要旋转设备并将其移回以带来正确的方向。

这是如果有人出于某种原因在联系人应用程序中将设备置于横向模式，但突然其中一个子视图将支持横向并自动旋转，而无需将设备旋转到纵向然后横向。问题是如何实施？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:36:25.340

在每种方法中使用它：

```
if (([[UIDevice currentDevice] orientation] == UIDeviceOrientationLandscapeLeft) || 
    ([[UIDevice currentDevice] orientation] == UIDeviceOrientationLandscapeRight)) 
{       

} 
else 
{

} 
```

或检查`[[UIScreen mainScreen] bounds]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T14:12:04.093

我想这是你想要的。

获取设备方向：

```
[[UIDevice currentDevice] orientation]; 
```

要获得视图的当前方向显示：

```
[UIApplication sharedApplication].statusBarOrientation; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T15:48:23.000

将此方法添加到 UINavigationController 的子类中：

```
- (void)navigationController:(UINavigationController *)navigationController didShowViewController:(UIViewController *)viewController animated:(BOOL)animated {
    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
        return;

    if ([UIViewController respondsToSelector:@selector(attemptRotationToDeviceOrientation)]) {
        //present/dismiss viewcontroller in order to activate rotating.
        UIViewController *mVC = [[UIViewController alloc] init];
        [self presentModalViewController:mVC animated:NO];
        [self dismissModalViewControllerAnimated:NO];
    }
} 
```

（在 SF 上找到它，但找不到该问题的链接）

# c# - 如何将sql转换为linq

> ID：15410143
> 
> 赞同：1
> 
> 时间：2013-03-14T13:06:54.980
> 
> 标签：c#, sql, linq

我该怎么做呢

从 MyTable 中选择前 10 名 Foo

```
SELECT        TOP (30) Item, Descripcion, SUM(Amount) AS Suma         
FROM            Venat 
GROUP BY Item, Descripcion                          
ORDER BY Suma 
```

在 Linq 到 SQL 中？

仅按项目分组，而不按描述分组

```
var filtroprimeros30 = from nuevo in registrosVipDosAños
                     group nuevo by nuevo.Item into g         
                       select new
                        {
                            Item = g.Key,
                            Suma = g.Sum(nuevo => nuevo.Amount)

                        }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:09:29.113

使用匿名类型进行分组：

```
var filtroprimeros30 = 
     (from nuevo in registrosVipDosAños
      group nuevo by new { nuevo.Item, nuevo.Description } into g  // here    
      select new {
          g.Key.Item,
          g.Key.Description,
          Suma = g.Sum(n => n.Amount)
      })
     .OrderBy(x => x.Suma)
     .Take(30); 
```

* * *

我实际上会这样做（因为查询语法具有很好的分组语法，但没有能力获取 N 项）：

```
var items = from n in registrosVipDosAños
            group n by new { n.Item, n.Description } into g
            select new {
              g.Key.Item,
              g.Key.Description,
              Suma = g.Sum(x => x.Amount)
            };

var topItems = items.OrderBy(x => x.Suma).Take(30); 
```

查询仍然只会执行一次，但现在它更具可读性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:14:41.590

语法替代

```
var filtroprimeros30 =  registrosVipDosAnos
                        .GroupBy(m => new {m.Item, m.Description})
                        .Select(g => new {
                           Item = g.Key.Item,
                           Description = g.Key.Description,
                           Suma = g.Sum(n => n.Amount)
                        })
                        .OrderBy(x => x.Suma)
                        .Take(30); 
```

# sql - 更改 ColdFusion 网站的数据库

> ID：15410145
> 
> 赞同：1
> 
> 时间：2013-03-14T13:07:00.547
> 
> 标签：sql, coldfusion, cfml

我是 ColdFusion 的新手。我有一个正在运行的 ColdFusion 网站，我想更新它。我复制了数据库进行一些测试，在 ColdFusion 管理器中，我用复制的数据库创建了一个新的数据源。但是现在我怎样才能告诉我的网站它需要使用复制的数据库呢？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:11:34.023

查看您的代码并找到任何`cfquery`标签，并确保它们在`datasource`属性中使用新的 dsn。根据代码的编写方式，可能有一个保存 dsn 的全局变量，您可以在那里更改它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:30:59.720

既然您有一个测试数据库，您可能希望使用条件逻辑来确定使用哪一个。这是我的一个文件中的一个示例。

```
<cfscript>
    if (cgi.path_info contains "dwtest") {
    dsn = "AntibioticsTest";
    } else {
    dsn = "Antibiotics";
}
</cfscript>

<cfquery name="GetLastInsertDates" datasource="#dsn#">
sql not relevent
</cfquery> 
```

正如 jhinkley 的回答中提到的，这个变量可能是一个全局变量，在这种情况下，它最有可能在 Application.cfc 中找到。

# ehcache - 将 ehcache 与兵马俑一起使用时的 maxElementsOnDisk

> ID：15410147
> 
> 赞同：0
> 
> 时间：2013-03-14T13:07:04.613
> 
> 标签：ehcache, terracotta

我正在将 ehcache 与兵马俑一起使用，我想知道在这种 cotext 中属性 maxElementsOnDisk 的含义是什么。

这是否意味着兵马俑层上允许的最大元素？

如果不是，控制 tarracotta 层上允许的元素数量的属性是什么？

如果我理解正确 maxEntriesLocalHeap 表示本地堆层上允许的条目数，它可以溢出到可以溢出到磁盘的兵马俑层（如果我错了请纠正我）但我不确定元素的名称是什么控制每个元素。

顺便说一句，在我的用例中，我永远不会希望将条目写入磁盘，如果本地堆或兵马俑层中没有更多空间，则应驱逐条目。

约西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:26:19.967

有 2 个商店和相关选项：

*   L1：MemoryStore（节点的本地 JVM）->`maxElementsInMemory`
*   L2：磁盘存储->`maxElementsOnDisk`

L2 大小表示最大缓存大小。元素可以从 L1 溢出到 L2。

使用 Terracotta 时，`maxElementsOnDisk`会覆盖该值以提供 L2 大小。此外，从不使用 DiskStore，因为元素溢出到 Terracotta（L2 存储）。

[您可以在官方常见问题解答](http://ehcache.org/documentation/2.4/terracotta/faq)和[相关错误报告](http://jira.terracotta.org/jira/browse/EHC-877)中了解它。

# java - 列出正在调用的方法的名称

> ID：15410151
> 
> 赞同：4
> 
> 时间：2013-03-14T13:07:17.853
> 
> 标签：java, reflection

我想要一个类似反射的解决方案来显示被调用的方法。

例子：

```
public class Foo {
    public void bar() {
         new Y().x();
    }
}

public class Y {
    public void x() {
    } 
} 

public class Main {
    public static void main(String[] args) {
        // SETTING UP THE MAGIC
        new Foo().bar(); 
        new Y().x();
    }
} 
```

输出应该是：

```
1\. Foo.bar
   1.2 Y.x
2\. Y.x 
```

理想情况下，每次调用方法时都会触发一个事件处理程序（并且可以将一些信息作为参数传递）。

PS：我不想在生产环境中使用它，我只需要在没有虚拟复制粘贴的骨架应用程序中显示输出。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-14T13:09:00.407

我会使用[aspectj](http://eclipse.org/aspectj/)来定义一个为每个方法调用写入日志消息的方面。您可以在此处找到一个示例：[使用 AspectJ 跟踪 Java 方法执行](http://mathewjhall.wordpress.com/2011/03/31/tracing-java-method-execution-with-aspectj/)。或在这里：[使用 AspectJ 进行日志记录](http://www.christianschenk.org/blog/logging-with-aspectj/)

此解决方案的优点是您不必对代码进行任何更改。您将需要一些时间来了解 aspectj，但它非常符合您的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:11:48.987

如果您想在不污染代码的情况下实现这一点，则必须构建一个探查器代理。

看看这篇[文章](http://www.ibm.com/developerworks/library/j-jip/)，它告诉你如何去做。具体来说，看看那篇文章中较低的分析方面。

> 清单 2 是一个概要分析方面，可用于在 JVM 每次进入或离开方法时输出类名、方法名和时间戳。

# javafx-2 - JavaFx StackedBar 图表问题

> ID：15410153
> 
> 赞同：2
> 
> 时间：2013-03-14T13:07:27.387
> 
> 标签：javafx-2

我有一张图表，其中的数据堆叠在 (-,+)Y 轴上。

*   使用 JfreeChart，所有这些都可以顺利进行，并且数据在每个柱上完美显示而不会丢失。![在此处输入图像描述](../Images/5f179619deadc77bc0761f95661df947.png)

*   但是当使用 javafx StackedBar Chart 时，当条形系列具有（正负）数据堆积条损坏和丢失数据时。 ![在此处输入图像描述](../Images/e3c5810c0b995a1ee5c49e881d67863e.png)

    ```
     if (plusValue > 0) {
                    series.getData().add(new XYChart.Data<String, Number>(xPoint, plusValue));
                }
                if (minusValue > 0) {
                    series.getData().add(new XYChart.Data<String, Number>(xPoint, -minusValue));
                } 
    ```

更新 ：

- [Oracle StackedBarChart 示例](http://docs.oracle.com/javafx/2/charts/bar-chart.htm) - “我更改系列值”

```
import java.util.Arrays;
import javafx.application.Application;
import javafx.collections.FXCollections;
import javafx.scene.Scene;
import javafx.scene.chart.CategoryAxis;
import javafx.scene.chart.NumberAxis;
import javafx.scene.chart.StackedBarChart;
import javafx.scene.chart.XYChart;
import javafx.stage.Stage;

public class StackedBarChartSample extends Application {

final static String austria = "Austria";
final static String brazil = "Brazil";
final static String france = "France";
final static String italy = "Italy";
final static String usa = "USA";
final CategoryAxis xAxis = new CategoryAxis();
final NumberAxis yAxis = new NumberAxis();
final StackedBarChart<String, Number> sbc =
        new StackedBarChart<String, Number>(xAxis, yAxis);
final XYChart.Series<String, Number> series1 =
        new XYChart.Series<String, Number>();
final XYChart.Series<String, Number> series2 =
        new XYChart.Series<String, Number>();
final XYChart.Series<String, Number> series3 =
        new XYChart.Series<String, Number>();

@Override
public void start(Stage stage) {
    stage.setTitle("Bar Chart Sample");
    sbc.setTitle("Country Summary");
    xAxis.setLabel("Country");
    xAxis.setCategories(FXCollections.<String>observableArrayList(
            Arrays.asList(austria, brazil, france, italy, usa)));
    yAxis.setLabel("Value");
    series1.setName("2003");
    // plus value
    series1.getData().add(new XYChart.Data<String, Number>(austria, 200));
    series1.getData().add(new XYChart.Data<String, Number>(brazil, 300));
    series1.getData().add(new XYChart.Data<String, Number>(france, 400));
    series1.getData().add(new XYChart.Data<String, Number>(italy, 500));
    series1.getData().add(new XYChart.Data<String, Number>(usa, 600));
    // minus value
    series1.getData().add(new XYChart.Data<String, Number>(austria, -200));
    series1.getData().add(new XYChart.Data<String, Number>(brazil, -300));
    series1.getData().add(new XYChart.Data<String, Number>(france, -400));
    series1.getData().add(new XYChart.Data<String, Number>(italy, -500));
    series1.getData().add(new XYChart.Data<String, Number>(usa, -600));
    series2.setName("2004");
    series2.getData().add(new XYChart.Data<String, Number>(austria, 200));
    series2.getData().add(new XYChart.Data<String, Number>(brazil, 300));
    series2.getData().add(new XYChart.Data<String, Number>(france, 400));
    series2.getData().add(new XYChart.Data<String, Number>(italy, 500));
    series2.getData().add(new XYChart.Data<String, Number>(usa, 600));
    // minus value
    series2.getData().add(new XYChart.Data<String, Number>(austria, -200));
    series2.getData().add(new XYChart.Data<String, Number>(brazil, -300));
    series2.getData().add(new XYChart.Data<String, Number>(france, -400));
    series2.getData().add(new XYChart.Data<String, Number>(italy, -500));
    series2.getData().add(new XYChart.Data<String, Number>(usa, -600));
    series3.setName("2005");
    series3.getData().add(new XYChart.Data<String, Number>(austria, 200));
    series3.getData().add(new XYChart.Data<String, Number>(brazil, 300));
    series3.getData().add(new XYChart.Data<String, Number>(france, 400));
    series3.getData().add(new XYChart.Data<String, Number>(italy, 500));
    series3.getData().add(new XYChart.Data<String, Number>(usa, 600));
    // minus value
    series3.getData().add(new XYChart.Data<String, Number>(austria, -200));
    series3.getData().add(new XYChart.Data<String, Number>(brazil, -300));
    series3.getData().add(new XYChart.Data<String, Number>(france, -400));
    series3.getData().add(new XYChart.Data<String, Number>(italy, -500));
    series3.getData().add(new XYChart.Data<String, Number>(usa, -600));
    Scene scene = new Scene(sbc, 800, 600);
    sbc.getData().addAll(series1, series2, series3);
    stage.setScene(scene);
    stage.show();
}

public static void main(String[] args) {
    launch(args);
} 
```

}

*   无负值。 ![无负值](../Images/5a0124b69cd5368f718caefddf1dae07.png)
*   负值数据已损坏。 ![负值数据已损坏](../Images/410271f997e2a1fb8ffc3e586a544f99.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T20:17:39.997

我在 StackedBarChart 代码上发现了错误：

```
 private Map<Series, Map<String,Data<X, Y>>> seriesCategoryMap = new HashMap<Series, Map<String, Data<X, Y>>>(); 
```

*   那行代码意味着每个系列都有`map<String categoryPoint ,data bar>`，因此该系列只有`one bar for that categoryPoint`，并且该条将是放入地图的最后一个值，因为地图将清除以前的条数据。

    ```
    categoryMap.put(categoryPoint,bar); 
    ```

*   但是我们需要 seriesCategoryMap 中的每个系列都有 categoryMap 但是那个地图必须有`for each categoryPoint to be List<Data>`。

*   结论，对于每个系列，我们都有 categoryMap，对于该 categoryMap 中的每个 categoryPoint，我们都有`List<Data<X,Y>> bar List to have positive and negative bars`。

*   所以那行代码就变成了。

    ```
    private Map<Series, Map<String, List<Data<X, Y>>>> seriesCategoryMap = new HashMap<Series, Map<String, List<Data<X, Y>>>>(); 
    ```

*   之后，我们必须根据该数据结构更新代码。

**1-更新“dataItemAdded & seriesAdded”方法。**

```
 // list to hold more that one bar "positive and negative"
    List<Data<X, Y>> itemList = categoryMap.get(category) != null ? categoryMap.get(category) : new ArrayList<Data<X, Y>>();
    itemList.add(item);
    categoryMap.put(category, itemList); 
```

**2-getDataItem 方法。**

```
 private List<Data<X, Y>> getDataItem(Series<X, Y> series, int seriesIndex, int itemIndex, String category) {
    Map<String, List<Data<X, Y>>> catmap = seriesCategoryMap.get(series);
    return catmap != null ? catmap.get(category) != null ? catmap.get(category) : new ArrayList<Data<X, Y>>() : new ArrayList<Data<X, Y>>();
} 
```

**3-updateAxisRange 和 layoutPlotChildren 更新这两种方法来管理负值和正值轴上的条形长度。**

*   [StackedBarChart 的更新代码](https://gist.github.com/KhaledLela/5190333)

*   [Oracle StackedBarChart 带有正负柱的示例](https://gist.github.com/KhaledLela/5190378)

*   **StackedBarChart 完美显示条形图，没有任何数据损坏** ![StackedBarChart 完美显示条形图，没有任何数据损坏](../Images/d7c4b605c441b4a0232500d3c1a297a9.png)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-15T11:49:30.787

利用...

[http://download.oracle.com/otndocs/products/javafx/2.2/samples/Ensemble/index.html](http://download.oracle.com/otndocs/products/javafx/2.2/samples/Ensemble/index.html)

或者

[JavaFX 场景生成器 1.1](http://www.oracle.com/technetwork/java/javafx/downloads/devpreview-1429449.html)

![在此处输入图像描述](../Images/c3f64a41f751687ba971ecd6a37fa025.png)

# heroku - 无法推送到 Github，出现“对等连接重置”错误

> ID：15410154
> 
> 赞同：2
> 
> 时间：2013-03-14T13:07:28.093
> 
> 标签：heroku, github, openssh

我有一个简单的 Rails 测试应用程序，并且一直在将提交推送到 github，但没有 oa 问题。我去设置 w/heroku，（创建了应用程序，加载了 ssh 密钥），当我在推送到 heroku 之前返回推送更改到 github 时，我收到了这个错误：

```
$ git push
ssh_exchange_identification: read: Connection reset by peer
fatal: The remote end hung up unexpectedly 
```

当我运行时：

```
ssh -vT git@github.com 
```

我得到：

```
ssh-keygen -t rsa -C "myemail@example.com"OpenSSH_5.9p1, OpenSSL 0.9.8r 8 Feb 2011
debug1: Reading configuration data /etc/ssh_config
debug1: /etc/ssh_config line 20: Applying options for *
debug1: Connecting to github.com [207.97.227.239] port 22.
debug1: Connection established.
debug1: identity file /Users/username/.ssh/id_rsa type 1
debug1: identity file /Users/username/.ssh/id_rsa-cert type -1
debug1: identity file /Users/username/.ssh/id_dsa type -1
debug1: identity file /Users/username/.ssh/id_dsa-cert type -1
ssh_exchange_identification: read: Connection reset by peer 
```

我在这里替换了我的电子邮件和用户名。我已经在这个上搜索了一段时间，但还没有找到旋转它的人。我已经用 github 重置了我的密钥，但无济于事。关于这个有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:10:11.053

这不是 Heroku 问题，Github 有问题。

[https://status.github.com/](https://status.github.com/)

# c# - 连接源图像中的绑定文本和静态文本

> ID：15410170
> 
> 赞同：0
> 
> 时间：2013-03-14T13:07:59.773
> 
> 标签：c#, binding, windows-phone-8

是否可以将绑定文本与源图像中的静态文本连接起来例如：

```
<Image Name="ImagePlace" Source="http://site.com/image/architecture.png"  Grid.Column="0" />
<Image Name="ImagePlace" Source="{Binding Path=Ico}"  Grid.Column="0" /> 
```

我想连接这两个来源。

我有一个名为 Category 的对象列表，其中包含一个 Icon 字段，例如“architecture.png”。我将它绑定在一个列表中。网站的网址不会改变，但图像总是会改变。

```
<ListBox x:Name="ListboxCategories">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                    <Button Name="category" Tag="{Binding Path=Id}" Tap="category_Tap_1">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Image Name="ImagePlace" Source="http://www.test.com/assets/images/icons/tags/architecture.png"  Grid.Column="0" />
                            <TextBlock Text="{Binding Path=Title}" Grid.Column="1" HorizontalAlignment="Center" />
                            <Image Name="chevron" Grid.Column="2" Source="/Assets/AppBar/White/appbar.chevron.right.png" HorizontalAlignment="Right" Width="50" Height="50" />
                        </Grid>
                    </Button>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:21:00.500

最干净的方法（嗯，取决于你的架构）是在你的对象中添加一个属性来进行连接：

```
public string FullUri 
{ 
    get 
    { 
        return "http://site.com/image/" + this.Ico 
    } 
} 
```

另一种方法是使用自定义转换器进行连接。

```
public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
{
    if (value == null)
    {
        return null;
    }

    return "http://site.com/image/" + value.ToString(); 
} 
```

# c - 读取缓冲区中的 png 图像

> ID：15410177
> 
> 赞同：3
> 
> 时间：2013-03-14T13:08:23.763
> 
> 标签：c, png, libpng

嗨，我已经使用 libpng 将灰度 png 图像转换为使用 c 的原始图像。在该库中，函数**png_init_io**需要文件指针来读取 png。但是我将 png 图像作为缓冲区传递，是否有任何其他替代函数可以将 png 图像缓冲区读取到原始图像。请帮我

```
int read_png(char *file_name,int *outWidth,int *outHeight,unsigned char **outRaw)  /* We need to open the file */
{
......
/* Set up the input control if you are using standard C streams */
   png_init_io(png_ptr, fp);
......
} 
```

相反，我需要这样

```
int read_png(unsigned char *pngbuff, int pngbuffleng, int *outWidth,int *outHeight,unsigned char **outRaw)  /* We need to open the file */
{
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:41:14.360

从手册中[`png_init_io`](http://refspecs.linuxbase.org/LSB_3.1.0/LSB-Desktop-generic/LSB-Desktop-generic/libpng12.png.init.io.1.html)可以看出，您可以使用`png_set_read_fn`.

这样做，您可能会误`png_init_io`以为它正在从文件中读取，而实际上您正在从缓冲区中读取：

```
struct fake_file
{
    unsigned int *buf;
    unsigned int size;
    unsigned int cur;
};

static ... fake_read(FILE *fp, ...) /* see input and output from doc */
{
    struct fake_file *f = (struct fake_file *)fp;
    ... /* read a chunk and update f->cur */
}

struct fake_file f = { .buf = pngBuff, .size = pngbuffleng, .cur = 0 };
/* override read function with fake_read */
png_init_io(png_ptr, (FILE *)&f); 
```

# php - PHP 中的高级搜索选项

> ID：15410179
> 
> 赞同：1
> 
> 时间：2013-03-14T13:08:26.050
> 
> 标签：php, javascript, mysql, html

我想在 PHP 中创建高级搜索选项。我正在根据下拉框和单选按钮检索值。我想知道如何基于这些生成查询，例如如何首先从列表框和单选按钮中获取值。第二件事是我想知道如何在查询中包含多个变量，或者只是将查询完全留空。

例如：我应该按包含（R、Mahout、Storm、Python、Splunk）的组件类型过滤组件域（电信、公用事业、零售、BFSI、旅行、医疗保健）使用权（知识产权、无权）然后是杂项值比如按字母顺序排序，按版本等。

问题是可以从组件域和组件类型中选择多个值。或者它可以留空。我如何根据选择的内容进行搜索？如果有多个值，我如何相应地修改我的 php 查询？

我已经粘贴了下面的代码：你能像至少给我一个关于如何为组件类型生成查询并为其生成多个值的示例查询一样指导我吗

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<?php
$con = mysql_connect("localhost","root","root");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }
mysql_select_db("cerebra", $con);
$sql="select name from details";
if (!mysql_query($sql,$con))
  {
  die('Error: ' . mysql_error());
  }
$query=mysql_query($sql,$con);
$names=array();
$index=0;
while($row=mysql_fetch_array($query)){
    $names[$index]=$row[0];
    $index++;

}

?>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.0/themes/base/jquery-ui.css" />
  <script src="http://code.jquery.com/jquery-1.8.3.js"></script>
  <script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>
  <link rel="stylesheet" href="/resources/demos/style.css" />
  <script>
  $(function() {
    var availableTags = <?php echo json_encode($names); ?>;
    $( "#search" ).autocomplete({
      source: availableTags
    });
  });
  </script>
<style type="text/css">

.basictab{
padding: 3px 0;
margin-left: 0;
font: bold 16px Sans-serif;
border-bottom: 1px solid black;
list-style-type: none;
text-align: left; /*set to left, center, or right to align the menu as desired*/
}

.basictab li{
display: inline;
margin: 0;
}
.basictab li a{
    text-decoration: none;
    padding: 3px 7px;
    margin-right: 3px;
    border: 1px solid gray;
    border-bottom: none;
    background-color: #FFFFFF;
    color: #2d2b2b;
}

.basictab li a:visited{
    color: #00F;
}

.basictab li a:hover{
color: #C60;
}

.basictab li a:active{
color: black;
}

.basictab a:selected{ /*selected tab effect*/
position: relative;
top: 1px;
padding-top: 4px;
background-color: #DBFF6C;
color: #06F;
}
fieldset{

  padding: 1em;
  font:90%/1 Verdana, Geneva, sans-serif;
  }

</style>
<script>
function view(){
    document.getElementById("view").style.display="";
}
function auth(){
    var pwd=prompt("Enter the password:","Password")
}
function hide(){
    document.getElementById("view").style.diplay="none";}
</script>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="jquery.multiselect.css" />
<link rel="stylesheet" type="text/css" href="assets/style.css" />
<!--<link rel="stylesheet" type="text/css" href="assets/prettify.css" />-->
<link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/ui-lightness/jquery-ui.css" />
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1/jquery-ui.min.js"></script>
<!--<script type="text/javascript" src="assets/prettify.js"></script>-->
<script type="text/javascript" src="src/jquery.multiselect.js"></script>

<script type="text/javascript">
$(function(){
    $("select").multiselect();
});
</script>
</head>

<body onload="hide(); prettyPrint();" id="test" >
<div><h1 style="font-family:Geneva, sans-serif; color:#036">Component Registry</h1></div>
<div id=tab>
<ul class="basictab">
<li><a href="search.php">SEARCH</a></li>
<li><a href="add.php">ADD</a></li>
</ul>
</div>

<div>
<form id="form1" name="form1" method="post" action="">
  <p>
    <label for="search"></label>
    <input type="text" name="search" id="search" />
    <a id=2 href="#" onclick="view()">Search</a>
  </p>
  <fieldset>
  <legend>Filter by:</legend>
  <div id=1>
  <table><tr><td><p>
    <label>Component Type:</label></td>
    <td><select title="Basic example" multiple="multiple" name="example-basic" size="5">
    <option value="option1">Sgoop</option>
    <option value="option2">Monet</option>
    <option value="option3">Hive</option>
    <option value="option4">Mahout</option>
    <option value="option5">R</option>
    <option value="option6">Storm</option>
    <option value="option7">Flume</option>
    <option value="option8">Solr</option>
    <option value="option9">Python</option>
    <option value="option10">Splunk</option>
    <option value="option11">Ruby</option>
    <option value="option12">perl</option>
    </select>
  </p></td></tr>
 <tr><td><p>
    <label>Component Domain:</label></td>

    <td><select title="Basic example" multiple="multiple" name="examplebasic2" size="5">
    <option value="Telecom">Telecom</option>
    <option value="Utility">Utility</option>
    <option value="BFSI">BFSI</option>
    <option value="Travel">Travel</option>
    <option value="Health Care">Health Care</option>
    <option value="Retail">Retail</option>
    <option value="Technology">Technology</option>
    <option value="Government">Government</option>
    <option value="Manufacturing">Manufacturing</option>
    <option value="Education">Education</option>
    </select></td></tr>
  <tr><td><p>Usage Rights:</td>
    <td><input type="radio" name="radio2" id="right" value="right" />
    <label for="right">Intellectual Property</label>
    <input type="radio" name="radio2" id="right2" value="right2" />
    <label for="right2">No rights reserved</label>
  </p></td></tr>
  <tr><td><p>Miscellaneous:</td> 
    <td><input type="radio" name="radio3" id="misc" value="misc" />
    <label for="misc">Sort Alphabetically</label>
    <input type="radio" name="radio3" id="misc2" value="misc" />
    <label for="misc2">Sort by Upload date</label>
    <input type="radio" name="radio3" id="misc3" value="misc3" />
    <label for="misc3">Sort by Versions</label>
  </p></td></tr>
  </table> </div></fieldset>
  <div id="view" style="display:none">
  <table width="457" border="1" align="center">
    <tr>
      <td width="117">Component Name</td>
      <td width="59">Type</td>
      <td width="60">Domain</td>
      <td width="56">Rights</td>
      <td width="72">Download</td>
      <td width="53">Delete</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td><input type="radio" name="radio" id="12" value="1"  />
      <label for="12"></label></td>
      <td><input type="radio" name="radio" id="122" value="1"  /></td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td><input type="radio" name="radio" id="2" value="2 />
      <label for="2"></label></td>
      <td><input type="radio" name="radio" id="123" value="1" /></td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td><input type="submit" name="1" id="13" value="Download" /></td>
      <td><input type="submit" name="13" id="132" value="Delete" onclick="auth()" /></td>
    </tr>

  </table>
  </div>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:35:42.557

你应该把它放在某种查询中。我不知道你在用什么，但假设这是一个简单的 MySQL 语句，我会做这样的事情

```
$component_domain = isset($_GET['component_domain']) ? ' AND component_domain = '.$_GET['component_domain'] : '';
$component_type = isset($_GET['component_type']) ? ' AND component_type = '.$_GET['component_type'] : '';
$sort = isset($_GET['sort']) ? ' SORT BY '.$_GET['sort'].' '.$_GET['sort_direction'] : '';
$stmt = 'SELECT * FROM table WHERE something = "somevalue"'.$component_domain.$component_type.$sort; 
```

然后运行您的查询。不是我最好的作品，但您可以根据需要对其进行修改。

# c# - DbContext 处理？

> ID：15410181
> 
> 赞同：7
> 
> 时间：2013-03-14T13:08:27.240
> 
> 标签：c#, asp.net-mvc, entity-framework, idisposable

数据库上下文

```
public class HaberPortalDB : DbContext
{
    public DbSet<Haberler> Haberler { get; set; }
    public DbSet<Kategoriler> Kategoriler { get; set; }
    public DbSet<Yazarlar> Yazarlar { get; set; }
}

public class Haberler
{
    public virtual int Id { get; set; }
    public virtual string Baslik { get; set; }
    public virtual string Aciklama { get; set; }
    public virtual string Icerik { get; set; }

    public virtual int YazarId { get; set; }
    public virtual Yazarlar Yazar { get; set; }

    public virtual int KategoriId { get; set; }
    public virtual Kategoriler Kategori { get; set; }
    public virtual ICollection<Resimler> Resimler { get; set; }
}

public class Kategoriler
{
    public virtual int Id { get; set; }
    public virtual string KategoriAdi { get; set; }
    public virtual string Aciklama { get; set; }

    public virtual ICollection<Haberler> Haberler { get; set; }
}

public class Yazarlar
{
    public virtual int Id { get; set; }
    public virtual string YazarAdi { get; set; }
    public virtual string Ozgecmis { get; set; }
    public virtual string Eposta { get; set; }

    public virtual ICollection<Haberler> Haberler { get; set; }
}

public class Resimler
{
    public virtual int Id { get; set; }
    public virtual string Url { get; set; }
    public virtual string Ad { get; set; }

    public virtual Haberler Haber { get; set; }
} 
```

脚手架正在生成以下操作方法

```
 //
    // GET: /Test/

    public ActionResult Index()
    {
        return View(db.Kategoriler.ToList());
    }

    //
    // GET: /Test/Details/5

    public ActionResult Details(int id = 0)
    {
        Kategoriler kategoriler = db.Kategoriler.Find(id);
        if (kategoriler == null)
        {
            return HttpNotFound();
        }
        return View(kategoriler);
    }

    //
    // GET: /Test/Create

    public ActionResult Create()
    {
        return View();
    }

    //
    // POST: /Test/Create

    [HttpPost]
    public ActionResult Create(Kategoriler kategoriler)
    {
        if (ModelState.IsValid)
        {
            db.Kategoriler.Add(kategoriler);
            db.SaveChanges();
            return RedirectToAction("Index");
        }

        return View(kategoriler);
    }

    //
    // GET: /Test/Edit/5

    public ActionResult Edit(int id = 0)
    {
        Kategoriler kategoriler = db.Kategoriler.Find(id);
        if (kategoriler == null)
        {
            return HttpNotFound();
        }
        return View(kategoriler);
    }

    //
    // POST: /Test/Edit/5

    [HttpPost]
    public ActionResult Edit(Kategoriler kategoriler)
    {
        if (ModelState.IsValid)
        {
            db.Entry(kategoriler).State = EntityState.Modified;
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        return View(kategoriler);
    }

    //
    // GET: /Test/Delete/5

    public ActionResult Delete(int id = 0)
    {
        Kategoriler kategoriler = db.Kategoriler.Find(id);
        if (kategoriler == null)
        {
            return HttpNotFound();
        }
        return View(kategoriler);
    }

    //
    // POST: /Test/Delete/5

    [HttpPost, ActionName("Delete")]
    public ActionResult DeleteConfirmed(int id)
    {
        Kategoriler kategoriler = db.Kategoriler.Find(id);
        db.Kategoriler.Remove(kategoriler);
        db.SaveChanges();
        return RedirectToAction("Index");
    }

    protected override void Dispose(bool disposing)
    {
        db.Dispose();
        base.Dispose(disposing);
    } 
```

每种方法都有断点。`Dispose()`在其他方法的工作之后，方法正在工作。

`Dispose()`每种工作方法如何触发方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-14T13:14:53.693

需要注意的几点：

*   您的控制器的生命周期仅与每个请求一样长。
*   每个请求将执行一个操作方法。
*   当控制器完成请求时调用 Dispose。

因此，这就是每个请求期间发生的情况：

1.  控制器初始化
2.  已初始化的 DbContext
3.  动作方法执行
4.  控制器 Dispose 方法执行

# php - 更新 SQL 表

> ID：15410183
> 
> 赞同：1
> 
> 时间：2013-03-14T13:08:30.080
> 
> 标签：php, mysql, sql

我想更新特定行上的表需要对我的 php 语句的一些建议

我用这个语句来调用客户的信息

```
<?php
$host="localhost"; // Host name 
$username="****"; // Mysql username 
$password="****"; // Mysql password 
$db_name="****"; // Database name 
$tbl_name="members"; // Table name

// Connect to server and select database.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// get value of id that sent from address bar
$id=$_GET['id'];

// Retrieve data from database 
$sql="SELECT * FROM $tbl_name WHERE member_msisdn='$query'";
$result=mysql_query($sql);
$rows=mysql_fetch_array($result);
?> 
```

这很好地呼应了我需要的信息并且能够改变它。

```
<form name="form1" method="post" action="control_clientupdated.php"> 
```

这是指我的动作 php 脚本

我需要帮助的问题是如何通知我的操作脚本使用与运行查询相同的 ID 来更新该行。

```
// Connect to server and select database.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// update data in mysql database 
$sql="UPDATE $tbl_name SET member_name='$member_name',     
member_surname='$member_surname', member_msisdn='$member_msisdn', cid='$cid',    
cofficenr='$cofficenr', cfax='$cfax',  e2mobile='$e2mobile' WHERE member_msisdn='$query'";
$result=mysql_query($sql); 
```

我已将 WHERE 语句放在更新的末尾

让我声明它显示完成，但它根本没有更新表格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:32:08.673

首先，您需要将您的 ID 存储到表单中的隐藏表单元素中。

```
<form method="post" action="control_clientupdated.php">
    <input type="hidden" name="member_msisdn" value="<?=$query?>" />
    ...
</form> 
```

这将允许您传递第一个 php 脚本中的值。

然后在你的`control_clientupdated.php`你需要使用`$_POST`来恢复你的价值。

```
// Store the $_POST value for my query ID
$query = $_POST['member_msisdn'] ;

// Connect to server and select database.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// update data in mysql database 
$sql="UPDATE $tbl_name SET member_name='$member_name',     
member_surname='$member_surname', member_msisdn='$member_msisdn', cid='$cid',    
cofficenr='$cofficenr', cfax='$cfax',  e2mobile='$e2mobile' WHERE member_msisdn='$query'";
$result=mysql_query($sql); 
```

这应该是您需要的 - 请注意，您不能使用它`$_GET`来检索表单传递的变量，因为您使用`method="post"`属性发送它，您必须使用`$_POST`而不是`$_GET`

# events - CDI 事件和 a4j:push

> ID：15410185
> 
> 赞同：0
> 
> 时间：2013-03-14T13:08:31.877
> 
> 标签：events, jsf-2, cdi

我正在使用一个`@SessionScoped`CDI bean，它在数据库中添加一条新记录并触发一个 CDI 事件来通知观察者。

在 JSF 中，我`a4j:push`用来在事件触发时呈现组件，并且它按预期工作。

在触发事件的同一个会话 bean 中，我还有一个观察者方法来打印消息，这仅适用于触发事件的会话（浏览器）。

所有其他浏览器都在 JSF 中接收事件（呈现内容并且我看到了新记录），但不调用支持 bean 中的方法。

从有关此问题的其他帖子中，我知道扩展`CDI Observer pattern`以支持全球事件是可行的（[http://blog.akquinet.de/2012/02/28/extending-cdi-observer-pattern-to-support-global-events/](http://blog.akquinet.de/2012/02/28/extending-cdi-observer-pattern-to-support-global-events/)） .

但是为什么它在 JSF 端而不是在没有任何修改的情况下在支持 bean 方法端像预期的那样工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T21:37:05.660

那是因为它们绑定到同一个会话，其他会话不应该接收不同会话的事件。

# javascript - 用户控件上的 Tinyscrollbar 在其他页面上不起作用

> ID：15410186
> 
> 赞同：1
> 
> 时间：2013-03-14T13:08:32.717
> 
> 标签：javascript, asp.net, tinyscrollbar

当我在图标通知列表上使用鼠标悬停事件时，我有一个包含通知图标的用户控件，该列表显示为 Facebook 的滚动条。我使用了以下链接中的自定义滚动条：

[http://baijs.nl/tinyscrollbar/](http://baijs.nl/tinyscrollbar/)

我将此链接中使用的 .js 文件的路径添加到我的用户控制页面

我使用此用户控件来制作项目的母版页和许多其他网页，但滚动条不起作用

当我在每个页面中添加这个 js 路径时，滚动条它正在工作，但是有很多页面我无法提供路径。

我应该如何解决这个问题？

## 编辑 1

试过了

```
 <link href='<%= ResolveUrl("~/assets/css/website.css") %>' rel="stylesheet" type="text/css" />
 <script type="text/javascript" src='<%= ResolveUrl("~/assets/js/homebanner/jquery.tinyscrollbar.min.js") %>'></script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:14:28.277

使用解析 url 包含文件
<%= ResolveUrl("~/fielName.js") %>;

```
<link href='<%= ResolveUrl(~/styles/MyStyles.css") %>' rel="stylesheet" type="text/css" />
<script type="text/javascript" src='<%= ResolveUrl("~/scripts/MyJScript.js")' %>"> 
```

在母版页中添加您的文件。
并使用上述文件路径。

否则，您将不得不给出完整的路径，例如

```
 <script type="text/javascript" src="http://yoursite/scripts/MyJScript.js"> 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-15T06:36:01.080

我使用 ScriptCombiner 解决了这个问题。我在记事本中保存了 javascript 文件的路径（~/assets/js/homebanner/jquery.tinyscrollbar.min.js）并添加到 App_Data 文件夹中，还将 JavaScriptMinifier.cs 和 JavaScriptMinifier.cs 添加到 App_Code 文件夹中。最后，我将 <%= ScriptCombiner.GetScriptTags("Site_Scripts", 2)%> 添加到我的用户控制页面和母版页并从用户控制中删除。

# indexing - 谷歌抓取错误中的页面索引

> ID：15410195
> 
> 赞同：0
> 
> 时间：2013-03-14T13:09:21.343
> 
> 标签：indexing, permalinks, web-crawler, google-search-console

我想从谷歌删除我从服务器中删除的页面或重定向它们我从服务器中删除的页面是

> www.mysite.com/id?=9898

和

```
www.mysite.com/pagename.html 
```

新页面是

```
www.mysite.com/pagename 
```

所以我从谷歌**删除了站点地图**并**创建了一个新的并上传了它**

我现在的问题是谷歌给我抓取错误，因为删除了 www.sitename.com/contact.html 和

> 索引页现在只有 2 页

为什么他看不到我已经删除了这些页面，当我在谷歌上搜索时，删除的页面仍然出现

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-05T20:17:29.197

您必须使用 Disavow Tool - Google 才能完全完成此操作。在 Google 上搜索 Disavow Tool - Google，您将获得第一个链接，通过 google ID 登录并按照说明进行操作。使用与站点地图相同的 google ID在谷歌站长上传

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:01:03.770

比上传新站点地图更好的是从旧页面重定向到新页面。在这里您可以获取有关[301 重定向](http://en.wikipedia.org/wiki/HTTP_301)的信息。
您的问题是，Google 实际上无法知道页面 www.blabalbal.com/id?234234 和 www.blabalbal.com/speaking_url 是同一页面。所以你必须告诉谷歌。一个好的方法是从上面重定向。
您应该解决此问题，因为 Google 可能会将这两个网页都作为唯一网页进行抓取，并得出这两个网页是重复内容的结论，这对您的排名不利。

# javascript - 传递给方法的 Javascript 对象是一个字符串

> ID：15410198
> 
> 赞同：2
> 
> 时间：2013-03-14T13:09:23.703
> 
> 标签：javascript, jquery, object, methods

我正在使用 jQuery mobile 构建一个 phonegap 项目。

我有一个正在迭代的 javascript 对象。

目前的问题是这样的：

下面是我的模型对象中的一个方法。它是自递归的，一旦被调用，每次用户单击对象上一层生成的列表项时，它都会通过自身递归到下一层。

我要解决的问题是将迭代段 b 作为对象传递给方法本身。由于某种原因，它作为一个名为 [Object] 的字符串返回，而不是对象本身。

这个函数在显示第一级时确实有效，但是我为每个孩子创建的“firstString”字符串似乎正在将我的对象变成一个名为对象的字符串。我删除了引号，将对象放在大括号中，但无济于事。

有人知道为什么会发生这种情况吗，我显然遗漏了一些重要的关于将对象传递给其调用以字符串形式生成的方法......

我的代码在下面，导致问题的行是`firstString+="model.recurseAppTree('"+b+"');";`

```
recurseAppTree: function(AppTree)
{
    $.each(AppTree, function(a,b)
    {
        var firstString='<li data-role="list-divider" role="heading" data-theme="b">'+b.DisplayValue+'</li>';

        if(b.Children != null)
        {
            $.each(b.Children, function(c,d)
            {
                firstString+="<li data-theme='c'><a  data-transition='slide' id='id-"+d.IdValue+"' href='javascript:void(0);'>"+d.DisplayValue+"</a></li>";
                firstString+="<script>";
                firstString+="$('#id-"+d.IdValue+"').click(function(){";
                firstString+="model.recurseAppTree('"+b+"');";
                firstString+="});";
                firstString+="</script>";
            });
        }

        $("#selectview").html(firstString);
        $("#selectview").listview('refresh', true);

    });
}, 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:12:32.947

这很正常。

通过与 .的连接，您可以在字符串上下文中使用对象`+`。这告诉 JS 隐式地将对象转换为字符串。

```
b = {}
alert(typeof b) // object
alert(typeof (''+b)) // string 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:21:06.427

您应该为您的 gui 使用事件委托

1-在你的''标签中添加一个（通用）类，例如`unrollLink`：

```
var firstString='<li ...><a class="unrollLink" ...></a></li>" 
```

2- 在您的 html 中选择一个节点，它是您所有“树”节点的父节点，并且将始终存在于您的 html 中。将点击处理程序委托给此节点：

```
$('#selectview').on('click', '.unrollLink', function(){
    //this === clicked link - write a function which returns the node you want based on the "id" you set
    var myNode = getNode( this.id );
    model.recurseAppTree( myNode );
}); 
```

3-更改您的功能以生成足够的html。您无需为`click`事件添加代码：

```
recurseAppTree: function(AppTree)
{
    $.each(AppTree, function(a,b)
    {
        var firstString='<li data-role="list-divider" role="heading" data-theme="b">'+b.DisplayValue+'</li>';

        if(b.Children != null)
        {
            $.each(b.Children, function(c,d)
            {
                // add the class you chose to the clickable items :
                firstString+='<li data-theme="c"><a class="unrollLink" data-transition="slide" id="id-'+d.IdValue+'" href="javascript:void(0);">'+d.DisplayValue+'</a></li>';
            });
        }

        $("#selectview").html(firstString);
        $("#selectview").listview('refresh', true);

    });
}, 
```

# gwt - 使用 UiField 和 UiFactory 在 UIBinder 小部件中创建顺序

> ID：15410199
> 
> 赞同：1
> 
> 时间：2013-03-14T13:09:24.133
> 
> 标签：gwt, uibinder

在我的场景中（欢迎修改）我有一个带有导航和内容面板的主页：

```
main
 |
 +--- Navigation (sets contents in ContentPage)
 |
 \--- ContentPage 
```

现在，`Navigation`需要一个引用，`ContentPage`以便它可以实际更改内容。这意味着何时`main`构建，它需要传递`ContentPage`给`Navigation`. 这是我目前正在使用的代码：

```
public class Main extends Composite {

    @UiField
    Panel contentPanel;

    @UiFactory
    Navigation makeNavigation() {
        return new Navigation(contentPanel);
    }

    interface MyUiBinder extends UiBinder<Widget, Middle> {
    }

    private static MyUiBinder uiBinder = GWT.create(MyUiBinder.class);

    public Main() {
        initWidget(uiBinder.createAndBindUi(this));
    }
} 
```

问题是，在调用 makeNavigation 时， `UiField contentPanel`尚未设置（它为空）。我想这是合理的，因为我无法保证`initWidget`已被调用。

那么，我接近这个错误吗？有没有办法选择创建顺序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T09:01:52.567

显然，小部件实例化顺序是 ui.xml 文件中出现的顺序，因此如果您希望 contentPanel 在导航之前被实例化，则必须将其放在 xml 之前。

我同意，这不是解决方案......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:28:51.243

到目前为止，我已经使用以下解决方法完成了工作：

```
public class Middle extends Composite {

    @UiField
    Panel contentPanel;

    @UiField
    Navigation navigation;

    interface MyUiBinder extends UiBinder<Widget, Middle> {
    }

    private static MyUiBinder uiBinder = GWT.create(MyUiBinder.class);

    public Middle() {
        initWidget(uiBinder.createAndBindUi(this));
        navigation.setContentPanel(contentPanel);
    }
} 
```

这保证`contentPanel`存在，但有点将页面的构建阶段`Navitagion`分为两个步骤。这是“社区认可”的方法吗？

# c++ - 带有 auto 关键字的 C++11 函数定义

> ID：15410200
> 
> 赞同：4
> 
> 时间：2013-03-14T13:09:25.153
> 
> 标签：c++, c++11, lambda

我很好奇在 C++11 中使用 auto 关键字。

对于函数定义，您必须编写函数的返回类型：

```
auto f (int x) -> int { return x + 3; }; //success
auto f (int x)  { return x + 3; }; //fail 
```

但在这个例子中，它们都可以工作：

```
auto f = [](int x) { return x + 3; }; //expect a failure but it works
auto f = [](int x) -> int { return x + 3; }; // this is expected code 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T13:18:11.310

在 C++11 中，如果 lambda 表达式可以毫无歧义地推断出确切的返回类型，则它可以省略其返回类型。但是，此规则不适用于常规功能。

```
int f() { return 0; } // a legal C++ function

auto f() -> int { return 0; } // a legal C++ function only in C++11

auto f() { return 0; } // an illegal C++ function even if in C++11 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-04T12:44:38.670

1.  如果您需要在“->”之后指定返回类型（就像在 C+11 中一样） - 在函数声明中使用“auto”有什么意义？这就好像在说：“这个函数可以返回任何东西，但实际上它只是这个类型”。呃？

2.  然后，如果您不需要在“->”之后指定返回类型（就像在 C++14 中一样）：假设您没有函数的源代码，而是目标文件和头文件。你怎么知道函数返回什么（返回类型）？

到目前为止，函数声明中的“auto”似乎是编写不可读代码的另一种方式。好像在 C++ 中已经没有足够的方法来做到这一点。

而在函数体内“auto”是一个很好的“语法糖”。

还是我错过了什么？

# php - 用于提供最新版本文件的 PHP 脚本

> ID：15410205
> 
> 赞同：2
> 
> 时间：2013-03-14T13:09:28.253
> 
> 标签：php

我的 PHP 生锈了，我希望有人可以帮助我快速编写脚本 - 我真的不知道从哪里开始！

我有一个文件夹，其中包含软件产品各种版本的压缩档案：

*   产品_1.00.zip
*   产品_1.05.zip
*   产品_2.00.zip

等等

现在，在我的网站上，我有一个下载产品的按钮。但是，我希望该按钮始终下载最新版本。

在我看来，一个不错的解决方案是链接到一个 PHP 脚本，该脚本将扫描文件夹中的最新版本并将该文件传递给用户，就像他们将浏览器直接指向该文件一样。

谁能给我一个起点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:17:33.043

我认为将目录中的文件读入数组是最简单的。然后`natsort`数组并弹出最后一个条目。

这是一个例子：

```
<?php
function getLatestVersion() {
    $dir = dir('.');
    $files = array();

    while (($file = $dir->read()) !== false) {
        $files[] = $file;
    }
    $dir->close();

    natsort($files);
    return array_pop($files);
} 
```

输出

```
array(6) {
  [0]=>
  string(1) "."
  [1]=>
  string(2) ".."
  [2]=>
  string(16) "Product_1.00.zip"
  [3]=>
  string(16) "Product_1.05.zip"
  [5]=>
  string(16) "Product_2.00.zip"
  [4]=>
  string(17) "Product_10.00.zip"
} 
```

## 如何下载最新版本的 zip 文件？

**编辑**

就像@j_mcnally 在他下面的评论中指出的那样，让网络服务器处理静态文件的服务更有效。可能的方法是直接链接或使用`301`.

但是如果你仍然想让 PHP 完成这项工作。这是一个例子。

* * *

*[从http://perishablepress.com/http-headers-file-downloads](http://perishablepress.com/http-headers-file-downloads)获取下面的示例并对其进行了一些修改。*

```
<?php // HTTP Headers for ZIP File Downloads
// http://perishablepress.com/press/2010/11/17/http-headers-file-downloads/

// set example variables

// Only this line is altered
$filename = getLatestVersion();

$filepath = "/var/www/domain/httpdocs/download/path/";

// http headers for zip downloads
header("Pragma: public");
header("Expires: 0");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Cache-Control: public");
header("Content-Description: File Transfer");
header("Content-type: application/octet-stream");
header("Content-Disposition: attachment; filename=\"".$filename."\"");
header("Content-Transfer-Encoding: binary");
header("Content-Length: ".filesize($filepath.$filename));
ob_end_flush();
@readfile($filepath.$filename);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:36:19.737

这应该有效。当然，可以添加更多检查，具体取决于该文件夹中可以存储的其他内容；如果文件夹包含太多文件等，您也可以更改读取文件夹内容的方式。此代码中的关键字可能[`strnatcmp()`](http://php.net/manual/en/function.strnatcmp.php)用于字符串比较。

```
<?php
$files = scandir('/path/to/files');
$result = array_reduce(
    $files,
    function($a, $b) {
        $tpl = '/^Product_(.+).zip$/';
        // return second file name if the first file doesn't follow pattern Product_XXX.zip
        if (!preg_match($tpl, $a)) {
            return $b;
        }
        // return first file name if the second file doesn't follow pattern Product_XXX.zip
        if (!preg_match($tpl, $b)) {
            return $a;
        }
        return strnatcmp($a, $b) >= 0 ? $a : $b;
    },
    ''
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:16:56.887

下面将在`downloads`目录中查找最新文件（通过查看文件的修改时间）并返回最新文件的名称：

```
$dir = dir("downloads");
$files = array();
while (($file = $dir->read()) !== false) {
    $files[filemtime($file)] = $file;
}
$dir->close();

ksort($files);
$fileToDownload = $files[0]; 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T13:50:55.530

此代码通过使用文件修改时间来确定给定目录中的最新版本来工作，也许在文件名上使用正则表达式会是更好的方法，但这说明了 PHP 的 DirectoryIterator。

```
$files = array();

foreach(new DirectoryIterator("productZips/") as $fileInfo) {

  if(!$fileInfo->isFile()) continue;
  $files[$fileInfo->getMTime()] = $fileInfo->getFilename();
}

ksort($files);
$latestFile = array_pop($files); 
```

你可以在这里阅读更多：http: [//php.net/manual/en/class.directoryiterator.php](http://php.net/manual/en/class.directoryiterator.php)

# c - 循环中的变量定义

> ID：15410208
> 
> 赞同：3
> 
> 时间：2013-03-14T13:09:28.987
> 
> 标签：c, loops

我一直在努力养成在需要时定义琐碎变量的习惯。我一直对编写这样的代码持谨慎态度：

```
while (n < 10000) {
   int x = foo();
   [...]
} 
```

我知道标准是绝对明确的，`x`只存在于循环内部，但这在技术上是否意味着整数将在每次迭代时在堆栈上分配和释放？我意识到优化编译器不太可能做到这一点，但它保证吗？

例如，这样写是不是更好：

```
int x;
while (n < 10000) {
   x = foo();
   [...]
} 
```

我不是专门指这段代码，而是指像这样的任何循环。

我用 gcc 4.7.2 对一个以这种方式不同的简单循环进行了快速测试，并生成了相同的程序集，但我的问题是，根据标准，这两个真的是相同的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T13:11:48.893

请注意，像这样“分配”自动变量几乎是免费的；在大多数机器上，它要么是单指令堆栈指针调整，要么编译器使用寄存器，在这种情况下不需要做任何事情。

此外，由于变量在循环退出之前保持在范围内，因此绝对没有理由“删除”（=重新调整堆栈指针）直到循环退出，我当然不希望代码每次迭代都会有*任何*开销像这样。

此外，如果编译器愿意的话，当然可以自由地将分配完全“移出”循环，使代码等同于您的第二个示例，`int x;`其中`while`. 重要的是，第一个版本更易于阅读且本地化程度更高，即更适合人类使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:16:47.403

是的，循环内的变量`x`在技术上是在每次迭代中定义的，并通过`foo()`对每次迭代的调用进行初始化。如果`foo()`每次产生不同的答案，这很好；如果每次都产生相同的答案，这是一个优化机会——将初始化移出循环。对于像这样的简单变量，编译器通常只`sizeof(int)`在堆栈上保留字节——如果它不能保存`x`在寄存器中——它用于`x`何时`x`在范围内，并且可以将该空间重用于同一函数中其他地方的其他变量。如果变量是 VLA（可变长度数组），那么分配会更复杂。

两个单独的片段是等价的，不同的是`x`. 在循环外部声明的示例中`x`，该值在循环退出后仍然存在。在`x`循环内声明后，一旦循环退出就无法访问。如果你写：

```
{
    int x;
    while (n < 10000)
    {
        x = foo();
        ...other stuff...
    }
} 
```

那么这两个片段足够接近。在汇编程序级别，您将很难发现任何一种情况的差异。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T13:25:56.137

我个人的观点是，一旦你开始担心这种微优化，你就注定要失败。收获是：

a) 可能非常小

b) 非便携式

我会坚持使用使您的意图清晰的代码（即在循环内声明 x ）并让编译器关心效率。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T13:31:43.183

C 标准中没有任何内容说明编译器在这两种情况下应如何生成代码。如果需要，它可以在循环的每次迭代中调整堆栈指针。

话虽如此，除非你开始用这样的 VLA 做一些疯狂的事情：

```
void bar(char *, char *);
void
foo(int x)
{
        int i;
        for (i = 0; i < x; i++) {
                char a[i], b[x - i];
                bar(a, b);
        }
} 
```

编译器很可能只会在函数开头分配一个大堆栈帧。生成代码来创建和销毁块中的变量而不是在函数的开头分配你需要的所有东西更难。

# zend-framework - Zend 表单标签不呈现重音符号

> ID：15410217
> 
> 赞同：0
> 
> 时间：2013-03-14T13:10:02.433
> 
> 标签：zend-framework, zend-form

我正在尝试在`setlabel`方法中呈现一个包含重音的表单，例如：

```
$ticketNumber->setLabel("Endere&ccedil;o"); 
```

我已经尝试了论坛中的每一个选项。但它不起作用，它显示的`&atilde`是该实体的而不是真实值。

我补充。如果我尝试以下操作，则标签的文本根本不会呈现（标签为空白）。

```
$ticketNumber->setLabel("Endereço"); 
```

在我的 application.ini 中添加了以下内容：

```
resources.view.encoding = "ISO-8859-1" 
```

我真的不知道出了什么问题。我已经为此奋斗了几天了。欢迎任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:26:22.357

```
$ticketNumber->setLabel("Endereço"); 
```

是正确的。但是您随后告诉它使用 ç 不是有效字符的编码。您需要将其切换为 UTF-8 或类似的：

```
resources.view.encoding = "UTF-8" 
```

# jquery - 书签磁贴高度未调整大小

> ID：15410218
> 
> 赞同：3
> 
> 时间：2013-03-14T13:10:09.190
> 
> 标签：jquery, jquery-plugins, wookmark

我正在向使用 wookmark jquery 插件显示的每个“图块”添加评论部分。

这可以是评论框，也可以是评论框和以前的评论，因此高度未知。

由于有多个我在事后添加它们。

问题是该评论字段加载在每个图像下，但图块没有更新它们的大小以适应，因此它们是重叠的，评论覆盖在它们下面的图块上。

我知道我可以刷新布局，但不知道在哪里，我已经尝试了所有我能想到的地方。

这是加载评论的代码（每个底部`<LI>`都有一个名为的 div ）`.comment_holder`

```
/** Refreshes the layout. */
function applyLayout() {

    $('.comment_holder').each(function(index, elem){
       $(elem).load('/pages/includes/comments.php', { 
            wl_id: $(elem).attr("id") 
        });
    });

  // Clear our previous layout handler.
  if(handler) handler.wookmarkClear();
  // Create a new layout handler
  handler = $('#tiles li');
  handler.wookmark(options);

}; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T06:50:41.260

也许你最好在 jsfiddle.com 上给出一个测试链接。为确保在所有 dom 渲染后进行布局，您应该将 wookmark 方法移动到 $(elem).load 的回调函数中。

# batch-file - cmd批处理需要计数器为文件列表分配唯一编号

> ID：15410222
> 
> 赞同：0
> 
> 时间：2013-03-14T13:10:14.693
> 
> 标签：batch-file, cmd, mp4

我在 windows8 中使用 Atomic Parsley 为我的 .mp4 电视节目设置正确的 Atoms。现在我可以正确地指定“常见”标签，例如艺术家、TVShowName 等，这些标签实际上对于我标记的所有文件都是相同的。我的问题是，在批处理文件中，我无法将正确的剧集编号标记到每个文件：“file001”应该是 episode1，“file002”-> episode2 等等。

现在，我正在使用它来标记文件：

```
for %%1 in (*.m4v *.mp4) do %AtomicParsley% "%%1" --stik "TV Show" --artist "%artist%" --title "%%~n1" --TVShowName "%TVShowName%" --TVSeasonNum %TVSeasonNum% --overWrite 
```

我需要的是某种计数器，为该字段分配`--TVEpisode`一个递增的（以长度为 1 的步长）和唯一编号。显然，我还需要前面的命令（或它们的等效命令）与 --TvEpisode 计数器一起工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:45:57.073

```
@ECHO OFF
SETLOCAL ENABLEDELAYEDEXPANSION 
SET count=0
for %%e in (*.m4v *.mp4) do (
SET /a count+=1
%AtomicParsley% "%%e" --stik "TV Show" --artist "%artist%" --title "%%~ne" --TVShowName "%TVShowName%" --TVSeasonNum %TVSeasonNum% --overWrite --TVEpisode !count!
) 
```

假设您的实用程序将使用参数`--TVEpisode`以您希望的方式分配文件名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T14:37:57.260

如果您的文件真的被命名为“file001”、“file002”等，您可以从文件名中获取数字，而不是使用计数器。

```
@echo off
setlocal enabledelayedexpansion
for %%a in (*.mp4) do (
    set "filename=%%~na"
    set /a TVEpisode=1!filename:~-3!-1000
    %AtomicParsley% "%%a" --stik "TV Show" --artist "%artist%" --title "%%~n1" --TVShowName "%TVShowName%" --TVSeasonNum %TVSeasonNum% --overWrite --TVEpisode !TVEpisode!
) 
```

该行`set /a TVEpisode=!filename:~-3!`抓取文件名的最后三个字符并将它们作为数字分配给 %TVEpisode% （从而删除前导零）。（它实际上是在三个数字前加上 1，然后减去 1000 以返回原始数字，因为`set /a`如果数字以前导 0 开头，则将其视为八进制。）

# c# - 如何为在 Sitecore 中以编程方式创建的访问存储自定义值

> ID：15410227
> 
> 赞同：0
> 
> 时间：2013-03-14T13:10:25.967
> 
> 标签：c#, sitecore, sitecore-dms

我正在使用以下代码以编程方式将用户添加到参与计划中：

```
VisitorManager.AddVisitor("salesforce\\fred.smith","{67F395B9-2C29-4B73-9382-69E0FCB6A546}"); 
```

这很好用，但我还需要针对访问存储自定义值。关于如何做到这一点的任何想法？

我无法设置`vistor.CurrentVisit.Profiles`，因为没有可用的 setter，也没有可添加的方法。

我可以使用以下代码添加标签

```
vistor.Tags.Add("opportunityId", "006M0000004xnLh"); 
```

但是，当我尝试从自定义自动化操作中检索它们时，返回的值为 null。我猜是因为它是通过编程方式设置的并且是从不同的会话中检索的？我用来检索标签的代码是：

```
var opportunityTagRow = visitorTags.Find("opportunityId"); 
```

并且：

```
var allOpportunityRows = visitorTags.GetAll("opportunityId"); 
```

关于如何最好地保存访问数据的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-22T21:17:33.753

我认为您混淆了 Sitecore 中“访问者”和“用户”的概念。在 Sitecore DMS 中，“访客”本质上是机器上的一个 cookie，它映射到分析数据库的访客表中的一个条目。命名用户是登录到 Sitecore 并存储在核心数据库的 .NET 成员表中的人。当您向访问者添加标签时，这会在 VisitorTags 表中添加一个条目，该表基本上只是映射到访问者表中的访问者条目的名称-值对。在您的情况下，“salesforce\fred.smith”不是访客而是用户。您可以使用 Sitecore.Analytics.Tracker.Visitor 检索当前访问者，也可以使用 VisitorFactory 按 ID 检索不同的访问者。如果您确实想针对用户保留数据，您可以使用用户配置文件，这又不同于 DMS 和访问者配置文件。您将在 Sitecore.Security 下找到 Sitecore 用户的相关类。

编辑：我会通过以下方式做你想做的事：

```
//Enroll user in plan
VisitorManager.AddVisitor("salesforce\\fred.smith", new ID("{67F395B9-2C29-4B73-9382-69E0FCB6A546}"));
//Add data to USER profile not visitor
Sitecore.Security.Accounts.User user = Sitecore.Security.Accounts.User.FromName("salesforce\\fred.smith", true);
user.Profile["opportunityId"] = "006M0000004xnLh";

//Get user from automation action parameter and get data from profile 
Sitecore.Security.Accounts.User user = Sitecore.Security.Accounts.User.FromName(automationStatesRow.UserName, true);
string data = user.Profile["opportunityId"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T05:00:26.227

所有访问数据都存储在 Sitecore Analytics 数据库中 - 请参阅访问者标签表。访问者标签具有可用于查找访问者的访问者 ID。您有两种选择来获取此数据（以及其他 Analytics 数据） - 使用 Sitecore Analytics API（推荐）或通过构建自定义 sql 调用来检索您想要的数据（可能会变得混乱）。以下是我使用分析 API 在参与操作中​​执行类似操作的方法：

```
 public override AutomationActionResult Execute(VisitorDataSet.AutomationStatesRow automationStatesRow, Item action, bool isBackgroundThread)
 {
        Visitor visitor = VisitorFactory.GetVisitor();
        string tagValue = visitor.Tags["myTag"]
        //Do stuff
} 
```

# twitter-bootstrap - 从代码隐藏打开引导模式

> ID：15410232
> 
> 赞同：34
> 
> 时间：2013-03-14T13:10:44.273
> 
> 标签：twitter-bootstrap, modal-dialog

任何人都知道如何从后面的代码中打开 twitter 引导模式？

我想在保存时根据一些要求打开模式。像“嘿，没有库存，选择以下选项之一继续（丢弃，保留......）并按下该按钮（可能会回发以继续）”

我正在使用 ASP.NET 网络表单。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-09-22T18:04:44.967

默认情况下，Bootstrap javascript 文件包含在结束 body 标记之前

```
 <script src="vendors/jquery-1.9.1.min.js"></script>
        <script src="bootstrap/js/bootstrap.min.js"></script>
        <script src="vendors/easypiechart/jquery.easy-pie-chart.js"></script>
        <script src="assets/scripts.js"></script>
 </body> 
```

我将这些 javascript 文件放入 body 标记之前的 head 部分，并编写了一个小函数来调用模态弹出窗口：

```
 <script src="vendors/jquery-1.9.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="vendors/easypiechart/jquery.easy-pie-chart.js"></script>
    <script src="assets/scripts.js"></script>

 <script type="text/javascript">
    function openModal() {
        $('#myModal').modal('show');
    }
</script>
</head>
<body> 
```

然后我可以使用以下代码从代码隐藏中调用模式弹出窗口：

```
protected void lbEdit_Click(object sender, EventArgs e) {   
      ScriptManager.RegisterStartupScript(this,this.GetType(),"Pop", "openModal();", true);
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-04-23T09:24:04.187

最后我发现了阻止我从代码隐藏中显示模态的问题。人们一定认为这就像注册一个打开的客户端脚本一样简单，例如：

```
ScriptManager.RegisterClientScriptBlock(this, this.GetType(),"none",
    "<script>$('#mymodal').modal('show');</script>", false); 
```

但这对我从来没有用过。

问题是**当模式在 asp:Updatepanel 中时，Twitter Bootstrap Modals 脚本根本不起作用**。模态的行为从每一方都失败，代码隐藏到客户端和客户端到代码隐藏（回发）。当模态的任何 js 已执行时，它甚至可以防止回发，例如关闭按钮，您还需要处理一些服务器对象（对于一个肮脏的例子）

我已经通知了引导人员，但他们回复了一个方便的“请给我们一个只有纯 html 而不是 asp 的失败场景”。在我的城镇，这被称为......好吧，Bootstrap 不支持任何比普通 html 更多的东西。没关系，在asp上使用它。

我认为他们至少要看看他们在后台管理中所做的不同，我发现这是问题的主要部分，但是......（只是提示）

所以任何有问题的人，放下更新面板试试。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-05-07T11:56:35.443

也许这个答案来得太晚了，但它很有用。
为此，我们有 3 个步骤：
1- 在 HTML 中创建模态结构。
2-创建一个按钮来调用java脚本中的函数，打开模式并`display:none`在CSS中设置。
3-通过后面代码中的函数调用此按钮。
您可以在下面的代码段中看到这些步骤：

HTML 模态：

```
<div class="modal fade" id="myModal">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title">
                                Registration done Successfully</h4>
                        </div>
                        <div class="modal-body">
                            <asp:Label ID="lblMessage" runat="server" />
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">
                                Close</button>
                            <button type="button" class="btn btn-primary">
                                Save changes</button>
                        </div>
                    </div>
                    <!-- /.modal-content -->
                </div>
                <!-- /.modal-dialog -->
            </div>
            <!-- /.modal --> 
```

隐藏按钮：

```
<button type="button" style="display: none;" id="btnShowPopup" class="btn btn-primary btn-lg"
                data-toggle="modal" data-target="#myModal">
                Launch demo modal
            </button> 
```

脚本代码：

```
<script type="text/javascript">
        function ShowPopup() {
            $("#btnShowPopup").click();
        }
    </script> 
```

后面的代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    ClientScript.RegisterStartupScript(this.GetType(), "alert", "ShowPopup();", true);
    this.lblMessage.Text = "Your Registration is done successfully. Our team will contact you shotly";
} 
```

该解决方案是我使用过的任何解决方案之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-12T18:33:57.210

这种打开模态的方法不会为我显示模态。我发现这是一个工作区。

我删除了：

```
 ScriptManager.RegisterStartupScript(this,this.GetType(),"Pop", "openModal();", true); 
```

比我添加了一个名为 lblJavaScript 的 asp:label 和调用后面的代码：

```
lblJavaScript.Text = "<script language=\"JavaScript\">openModal()</script>"; 
```

现在将显示模态。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-02-07T20:40:13.533

上面的所有示例都应该可以工作，只需添加一个文档准备操作并更改您执行文本更新的顺序，还要确保您使用的脚本管理器或者不适合您。这是后面代码中的文本。

aspx

```
<div class="modal fade" id="myModal" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <asp:UpdatePanel ID="upModal" runat="server" ChildrenAsTriggers="false" UpdateMode="Conditional">
                <ContentTemplate>
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title"><asp:Label ID="lblModalTitle" runat="server" Text=""></asp:Label></h4>
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        </div>
                        <div class="modal-body">
                            <asp:Label ID="lblModalBody" runat="server" Text=""></asp:Label>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary" data-dismiss="modal" aria-hidden="true">Close</button>
                        </div>
                    </div>
                </ContentTemplate>
            </asp:UpdatePanel>
        </div>
    </div> 
```

代码背后

```
lblModalTitle.Text = "Validation Errors";
lblModalBody.Text = form.Error;
upModal.Update();
ScriptManager.RegisterStartupScript(Page, Page.GetType(), "myModal", "$(document).ready(function () {$('#myModal').modal();});", true); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-24T15:46:07.017

FYI,

I've seen this strange behavior before in jQuery widgets. Part of the key is to put the updatepanel inside the modal. This allows the DOM of the updatepanel to "stay with" the modal (however it works with bootstrap).

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-15T14:01:13.497

这样做怎么样：

1) 显示带有表单的弹出窗口

2) 使用 AJAX 提交表单

3) 在 AJAX 服务器端代码中，呈现响应：

*   显示带有验证的表单或仅显示消息的弹出窗口
*   关闭弹出窗口（并可能将您重定向到新页面）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-20T16:57:25.223

这条线对我有用，可以在代码后面打开 Bootstrap Modal

```
ScriptManager.RegisterStartupScript(Page, Page.GetType(), "randomText", "$(document).ready(function () {$('#myModal').modal();});", true); 
```

# sap-ase - sybase 中所有表中的所有 varchar 列

> ID：15410236
> 
> 赞同：-1
> 
> 时间：2013-03-14T13:10:55.100
> 
> 标签：sap-ase

有谁知道我们如何获得所有表中所有 varchar 列的列表？我需要以下格式：

```
<column_name> <table_name> 
```

我试过这个：

```
select o.name [TableName], c.name [ColumnName]  from sysobjects o 
inner join syscolumns c on c.id = o.id inner join systypes t 
on t.usertype = c.usertype where o.type = 'U' and o.name in ("MYTABLE") 
```

但上面给出了所有列的列表。如果我能找到一种方法，那么我可以将所有表名放在最后一个大括号内。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:39:06.473

您可以使用 where systypes.name = 'varchar'、或 systypes.type = 39 或 syscolumn.type = 39 将查询范围缩小到仅 varchar 列。

```
select o.name, c.name from sysobjects o, syscolumns c
where o.id = c.id
and c.type = 39
and o.type = "U" 
```

# android - 如何从 Maven 项目 (github.com/japgolly/svg-android) 获取 APK 库

> ID：15410241
> 
> 赞同：0
> 
> 时间：2013-03-14T13:11:03.337
> 
> 标签：android, maven, svg

我需要一个 APK Android 库：

[https://github.com/japgolly/svg-android](https://github.com/japgolly/svg-android)

这个项目是原始的一个分支：

[http://code.google.com/p/svg-android/](http://code.google.com/p/svg-android/)

也提供APK。

我不知道Maven，我安装了Eclipse插件，将项目导入为Maven项目。如果我构建项目，我不会得到 APK。

有什么快速的解决方案吗？我需要将我的 Android 项目转换为 Maven 项目吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:14:54.550

Eclipse 通常会跑到`compile`maven 的阶段。APK 可能是在该`package`阶段创建的。我建议你再次运行 maven build （如果你愿意的话，使用 eclipse），并将目标设置为`package`阶段。

为此，请单击运行 > 运行配置 > Maven 构建 >（找到您的运行配置或创建一个）> 目标。然后将目标设置为`package`

# c# - 在 Internet Explorer 7 中看不到小部件

> ID：15410244
> 
> 赞同：3
> 
> 时间：2013-03-14T13:11:09.357
> 
> 标签：c#, javascript, widget, internet-explorer-7

我想尽办法找到一个 html/javascript 页面的问题，该页面的行为就像一个不会在 ie6 或 ie7 中加载的小部件。有人能指出我正确的方向吗？

[http://cdn.xas.com/SampleOutput.html](http://cdn.xas.com/SampleOutput.html)

我猜我的一些javascript有问题吗？

我正在用 javascript 构建 html，它也可能是由此生成的 html 是吗？

谢谢尼尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T23:46:25.813

There are no offers displayed as `dataCollection.Offers` passed into function `core.createOffersList`, sourced from `this.eventData` in the `BoonCentral.Com.Cdn.Widget`, class is an empty array. As assigned by line 494:

```
this.eventData = {"Address":"10 Wellington Quay Jamestown, Dublin","ID":48,"LogoUrl":"http:\/\/www.booncentral.com\/VenueImages\/48\/201209171247\/0e8ed5bd-6076-4b67-a96a-5365cf225636the_workmans_club_dublin_28659.gif","Name":"The Workmans","Offers":[],"VenueProfile":"<p>&nbsp;<\/p><p>Dublin's most excellent new live music venue, situated in the heart of \u000d\u000athe city and open Monday to Sunday from 5pm til, well, when we kick you \u000d\u000aout!<\/p>"}; 
```

For IE6, you may be hitting this issue: [http://kmleeblog.wordpress.com/2011/07/20/document-createelement-problem-in-ie6/](http://kmleeblog.wordpress.com/2011/07/20/document-createelement-problem-in-ie6/)

Hope this helps you narrow down the problem :-).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T14:30:16.947

尽管这不能回答您的问题-您为什么要使其在 IE6/7 上运行？

IE6 和 7 几乎没有使用，正在逐步淘汰。您最好花时间针对当前浏览器进行优化..

根据[http://www.theie7countdown.com/](http://www.theie7countdown.com/)的数据，IE7 的全球使用率为 4%。根据[http://www.w3schools.com/browsers/browsers_explorer.asp](http://www.w3schools.com/browsers/browsers_explorer.asp)，现在不到 1%。

关于这个特定的小部件/项目，解决这个问题是否花费了您超过 1-4% 的时间？

只是我的想法...

# c# - 使用 C# 客户端而不是 Javascript 连接到 Websocket 服务器

> ID：15410245
> 
> 赞同：4
> 
> 时间：2013-03-14T13:11:12.870
> 
> 标签：c#, websocket

我在客户端和服务器上都使用 Alchemy websockets，但遇到了[消息损坏/丢失](https://stackoverflow.com/questions/15247718/web-socket-messages-not-all-being-received)的问题。所以我正在尝试另一个服务器端实现。我使用 Fleck 实现了服务器，当我使用 javascript 发送消息时，服务器接收到所有消息，解决了我之前的问题。

但是，我还需要能够从 C# 客户端向 websocket 服务器发送消息。由于 Fleck 在 C# 中没有客户端实现，我想我会坚持使用 Alchemy。我保持客户端代码不变，所以我认为它应该像以前一样连接到服务器，但是，没有收到任何消息（尽管它们是根据调试器发送的）。

这是我的服务器端实现（Fleck）：

```
private void OnStartWebSocketServer()
        {
            var server = new WebSocketServer("ws://localhost:11005");
            server.Start(socket =>
            {
                socket.OnOpen = () => Console.WriteLine("Open!");
                socket.OnClose = () => Console.WriteLine("Close!");
                socket.OnMessage = message => OnReceive(message);
            });
        }

    private static void OnReceive(String message)
    {
        UpdateUserLocation(message);
    } 
```

这是我的客户端实现（炼金术）：

```
class WSclient
{

    WebSocketClient aClient;

    public WSclient(String host, String port)
    {

        aClient = new WebSocketClient("ws://" + host + ":" + 11005 + "/chat")
        {
            OnReceive = OnReceive,
            OnSend = OnSend,
            OnConnect = OnConnected,
            OnConnected = OnConnect,
            OnDisconnect = OnDisconnect
        };

        aClient.Connect();
    }

    ...

    public void Send(String data)
    {
        aClient.Send(data);
    } 
```

我认为这可能与 Alchemy 客户端在连接字符串“/chat”的末尾需要一个通道有关。但是，将其留空或仅使用“/”会产生错误。

# html - 使用点击事件绑定表格行

> ID：15410247
> 
> 赞同：0
> 
> 时间：2013-03-14T13:11:16.207
> 
> 标签：html, knockout.js

我正在使用淘汰赛，当我在我的表格行上绑定了一个点击事件时。但是，当我单击该行时，它会显示以下错误：

```
function d(){if(0<arguments.length){if(!d.equalityComparer||!d.equalityComparer(c,arguments[0]))d.H(),c=arguments[0],d.G();return this}b.r.Wa(d);return c} 
```

有谁知道我为什么会收到这个错误？

这是我对表格的看法：

```
<tbody data-bind="foreach: customers">
                    <tr data-bind="click: $root.doSomething">     
                        <td data-bind="text: date"></td>
                        <td data-bind="text:staff"></td>
                        <td data-bind="text: ftype"></td>
                        <td data-bind="text: value"></td>
                        <td data-bind="text: message"></td>
                        </td>
                    </tr>
                </tbody> 
```

这是我的视图模型：

```
doSomething: function(data) { 
    var self = this;      
    self.date(data.date);        
    self.staff(data.staff); 
    self.ftype(data.ftype);
               self.value(data.value);
               self.message(data.message);  

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T21:02:18.057

这行得通吗？

```
<tbody data-bind="foreach: customers">
    <tr data-bind="click: function() {$root.doSomething($data);}"> 
```

# sqlalchemy - Celery + SQLAlchemy : DatabaseError: (DatabaseError) SSL 错误: 解密失败或坏记录 mac

> ID：15410248
> 
> 赞同：3
> 
> 时间：2013-03-14T13:11:21.407
> 
> 标签：sqlalchemy, flask, celery

在打开 SSL 的 postgresql db 上使用 celery 和多个工作人员时，有时会触发标题错误。我在烧瓶 + SQLAlchemy 配置中

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T13:11:21.407

正如这里提到的：[https](https://github.com/celery/celery/issues/634) ://github.com/celery/celery/issues/634 django-celery 插件中的解决方案是在任务开始时简单地处理所有数据库连接。

在烧瓶 + SQLAlchemy 配置中，这样做对我有用：

```
from celery.signals import task_prerun

@task_prerun.connect
def on_task_init(*args, **kwargs):
    engine.dispose() 
```

如果您不知道“引擎”是什么以及如何获取它，请参见此处： http: [//flask.pocoo.org/docs/patterns/sqlalchemy/](http://flask.pocoo.org/docs/patterns/sqlalchemy/)

# javascript - 在javascript中加入两个html块变量

> ID：15410251
> 
> 赞同：1
> 
> 时间：2013-03-14T13:11:33.273
> 
> 标签：javascript, html, block

我正在尝试使用 javascript 加入两个 html 代码块，然后调用一个对话框。我做了一些研究并尝试了 concat 和 + 但这不起作用。这是我的代码的简化版本：

```
 var html =
      "<div class=\"dialog-form\" title=\"Edit\">" +
   "<form class=\"insertaplato\" method=\"POST\" action=\"edit.php\">" +
    "<fieldset>" +
        "<label>Plate: </label> <input  type=\"text\"  value=\"" + plate + "\" >" +
        "<label>Price: </label><input  type=\"text\"  value=\""+ price +"\" >";     

    "Spicy: <br>    ";
if (spicy==1)
{var varP=
        "<label> Yes </label><input  value= \"yes\" type=\"radio\" checked>"+ 
        "<label> No </label><input  value=\"no\"><br><br>";
} else {
    var varP=
        "<label> Yes </label><input  value=\"yes\" type=\"radio\">"+ 
        "<label> No </label><input value=\"no\" checked type=\"radio\"><br><br>";   
}

 var html2 = "<br>"+ 
    "<br><input id=\"insert\" type=\"submit\" value=\"Edit\" name=\"send\"> " + 
    "</fieldset>"+ 
    "</form>"+ 
    "</div>";

var div = $(html)+$(varP)+$(html2);

      div.dialog(
{
    title:"Edit Plate",
    close: destroy_this_dialog
}); 
```

就像现在一样，对话框没有出现。如果我只使用第一个 html 变量执行此操作，它会出现好的，但是当我尝试添加或连接其他变量时，什么也没有发生。我显然没有按我应该的那样使用这些变量。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:13:56.927

连接字符串而不是 jQuery 对象

```
 var div = $(html + varP + html2);

  div.dialog(
  {
    title:"Edit Plate",
    close: destroy_this_dialog
   }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:22:32.403

删除`$`将碎片附加在一起的位置。您想将字符串附加到单个对象中。

```
 var div = $(html + varP + html2); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:52:09.337

而不是

变量 div = $(html)+$(varP)+$(html2);

```
 div.dialog( 
```

{ 标题：“编辑板”，关闭：destroy_this_dialog });

尝试这个：

变量 div = html+varP+html2;

```
 $('.dialog-form').dialog( 
```

{ 标题：“编辑板”，关闭：destroy_this_dialog });

# hibernate - 单列唯一约束的注释

> ID：15410253
> 
> 赞同：0
> 
> 时间：2013-03-14T13:11:36.720
> 
> 标签：hibernate, jpa, hibernate-annotations

我想指示 Hibernate 在单个列上创建唯一约束。我已经设置`hibernate.hbm2ddl.auto=update`了休眠配置，我的代码如下所示：

```
@Column(name = "program_id",unique=true)
@Length(min = 0, max = 10)
private String programID; 
```

我没有看到在 MySQL 的表上创建任何唯一索引。我该怎么做才能让它工作？

# python - django easy-Thumbnails 不起作用

> ID：15410262
> 
> 赞同：1
> 
> 时间：2013-03-14T13:11:51.353
> 
> 标签：python, django

在我的 django 项目中，我使用的是 Easy Thumbnails。

在生产服务器上，本地一切都正常工作我面临一个有点奇怪的情况

在生产中，该库已成功安装，我已按照 github 上自述文件中的相同步骤进行操作

在我的设置中，我放了以下几行

```
THUMBNAIL_ALIASES = {
'': {
    'small': {'size': (75, 75), 'crop': True},
    'regular': {'crop': "scale" , 'size': (500, 0) },
    'galleryThum': {'crop': True , 'size': (120, 120) },
}, 
```

}

我有一个名为 Photo 的模型类，其中包含一个名为 image 的 imageField

在模板中，我正在执行以下操作

1-`{% load thumbnail %}`

2-`<img src="{{photo.image|thumbnail_url:'galleryThum'}}"/>`

本地一切正常，而在生产服务器上，图像没有出现。当我用这条线替换`<img src="{{photo.image|thumbnail_url:'galleryThum'}}"/>`这条线时`<img src="{{photo.image.url}}"/>`，图像正常显示

问题出在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-03T12:14:51.783

对于 debian/ubuntu，

yum install freetype freetype-devel libjpeg libjpeg-devel

应该：

sudo apt-get install libwebp4 libwebp4-dev libfreetype6 libfreetype6-dev libjpeg8 libjpeg8-dev liblcms1 liblcms1-dev libwebp4 libwebp4-dev

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-07T21:08:23.013

不确定您的服务器设置是什么，但`pip install pil`在 CentOS 6.3 上并没有为我安装任何依赖项。这是我的修复：

`PIL`如果已安装，则卸载： `pip uninstall pil`，然后：

```
yum install freetype freetype-devel libjpeg libjpeg-devel
pip install pillow 
```

（或者`apt-get install`代替`yum install`Linux 上的 if。）

安装后`pillow`，您应该在最后看到一些类似的输出：

```
--------------------------------------------------------------------
SETUP SUMMARY (Pillow 2.0.0 fork, originally based on PIL 1.1.7)
--------------------------------------------------------------------
version      2.0.0 (Pillow)
platform     linux2 2.7.3 (default, Apr 30 2013, 20:15:01)
             [GCC 4.4.7 20120313 (Red Hat 4.4.7-3)]
--------------------------------------------------------------------
*** TKINTER support not available
--- JPEG support available
--- ZLIB (PNG/ZIP) support available
*** TIFF G3/G4 (experimental) support not available
--- FREETYPE2 support available
*** LITTLECMS support not available
*** WEBP support not available
-------------------------------------------------------------------- 
```

# arrays - 在powershell中组合和修改数组中的对象以创建新数组

> ID：15410264
> 
> 赞同：0
> 
> 时间：2013-03-14T13:11:52.460
> 
> 标签：arrays, powershell, csv

我有一个 csv，其中的列包含用户的名字姓氏。我已经弄清楚如何使用以下方法从每列导入 csv 数据：

```
$firstname = Import-csv .\data.csv | select-object "Employee First Name" 
$lastname = Import-csv .\data.csv | select-object "Employee Last Name" 
```

我还发现：

```
$username=$firstname.substring(0,1)+$lastname 
```

使用`system.string`对象时有效。问题是我需要遍历所有名称以使用用户名创建一个新列，但出现错误

`System.Object[]] doesn't contain a method named 'substring'`

我以为我可以使用转换为字符串，`$firstname.ToString()`但我似乎搞砸了。非常感谢任何帮助，因为我仍在尝试学习 powershell。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:30:15.180

错误是自我表达`$firstname` 的，不是字符串。`$firstname`是一个数组`string`。

尝试 ：

```
$username = ($firstname[0]).substring(0,1)+$lastname[0] 
```

你最好使用：

```
$employees = Import-csv .\data.csv
foreach ($employee in $employees)
{
  $username=($employee.'Employee First Name').substring(0,1)+($employee.'Employee Last Name')
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:41:39.527

看起来您正在尝试创建用户名。所以我不确定你为什么要一次导入一列？

但这可能对你有用。

```
$names = Import-Csv .\test.csv
$userNames = New-Object 'System.Collections.Generic.List[String]'

foreach ($name in $names)
{
    $userNames.Add($($name.firstName.Substring(0,1) + $name.lastName))
} 
```

# jquery - 使用 jQuery 的文件上传进度条

> ID：15410265
> 
> 赞同：171
> 
> 时间：2013-03-14T13:11:53.087
> 
> 标签：jquery, file-upload, progress-bar

我正在尝试在我的项目中实现 AJAX 文件上传功能。我为此使用 jQuery；我的代码使用 AJAX 提交数据。我还想实现一个文件上传进度条。我怎样才能做到这一点？有什么方法可以计算已经上传了多少，以便我可以计算上传的百分比并创建进度条？

* * *

## 回答 #1

> 赞同：335
> 
> 时间：2014-04-10T12:22:38.187

我只用 jQuery 完成了这个：

```
$.ajax({
  xhr: function() {
    var xhr = new window.XMLHttpRequest();

    xhr.upload.addEventListener("progress", function(evt) {
      if (evt.lengthComputable) {
        var percentComplete = evt.loaded / evt.total;
        percentComplete = parseInt(percentComplete * 100);
        console.log(percentComplete);

        if (percentComplete === 100) {

        }

      }
    }, false);

    return xhr;
  },
  url: posturlfile,
  type: "POST",
  data: JSON.stringify(fileuploaddata),
  contentType: "application/json",
  dataType: "json",
  success: function(result) {
    console.log(result);
  }
}); 
```

* * *

## 回答 #2

> 赞同：143
> 
> 时间：2013-03-14T13:28:23.980

**注意：**这个问题与[jQuery 表单插件](http://www.malsup.com/jquery/form/#file-upload)有关。如果您正在寻找纯 jQuery 解决方案，请[从这里开始](https://stackoverflow.com/questions/166221/how-can-i-upload-files-asynchronously-with-jquery)。没有适用于所有浏览器的整体 jQuery 解决方案。所以你必须使用插件。我正在使用[dropzone.js](http://www.dropzonejs.com/)，它可以轻松地回退旧浏览器。您喜欢哪个插件取决于您的需求。那里有很多很好的比较帖子。

从[例子](http://jquery.malsup.com/form/)：

**jQuery：**

```
$(function() {

    var bar = $('.bar');
    var percent = $('.percent');
    var status = $('#status');

    $('form').ajaxForm({
        beforeSend: function() {
            status.empty();
            var percentVal = '0%';
            bar.width(percentVal);
            percent.html(percentVal);
        },
        uploadProgress: function(event, position, total, percentComplete) {
            var percentVal = percentComplete + '%';
            bar.width(percentVal);
            percent.html(percentVal);
        },
        complete: function(xhr) {
            status.html(xhr.responseText);
        }
    });
}); 
```

**html:**

```
<form action="file-echo2.php" method="post" enctype="multipart/form-data">
    <input type="file" name="myfile"><br>
    <input type="submit" value="Upload File to Server">
</form>

<div class="progress">
    <div class="bar"></div >
    <div class="percent">0%</div >
</div>

<div id="status"></div> 
```

您必须使用 CSS 设置进度条的样式...

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2015-11-05T07:32:03.447

我在我的项目中使用了以下内容。你也可以试试。

```
ajax = new XMLHttpRequest();
ajax.onreadystatechange = function () {

    if (ajax.status) {

        if (ajax.status == 200 && (ajax.readyState == 4)){
            //To do tasks if any, when upload is completed
        }
    }
}
ajax.upload.addEventListener("progress", function (event) {

    var percent = (event.loaded / event.total) * 100;
    //**percent** variable can be used for modifying the length of your progress bar.
    console.log(percent);

});

ajax.open("POST", 'your file upload link', true);
ajax.send(formData);
//ajax.send is for uploading form data. 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-12-12T19:10:13.413

看看这个：[http](http://hayageek.com/docs/jquery-upload-file.php) ://hayageek.com/docs/jquery-upload-file.php 我在网上偶然发现了它。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-11-04T10:27:34.670

如果您在项目中使用 jquery，并且不想从头实现上传机制，则可以使用[https://github.com/blueimp/jQuery-File-Upload](https://github.com/blueimp/jQuery-File-Upload)。

他们有一个非常好的 api，具有多个文件选择、拖放支持、进度条、验证和预览图像、跨域支持、分块和可恢复文件上传。他们有多种服务器语言（node、php、python 和 go）的示例脚本。

演示网址：[https](https://blueimp.github.io/jQuery-File-Upload/) ://blueimp.github.io/jQuery-File-Upload/ 。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-08-28T06:35:49.293

这是一个更完整的 jquery 1.11.x $.ajax() 用法：

```
<script type="text/javascript">
    function uploadProgressHandler(event) {
        $("#loaded_n_total").html("Uploaded " + event.loaded + " bytes of " + event.total);
        var percent = (event.loaded / event.total) * 100;
        var progress = Math.round(percent);
        $("#uploadProgressBar").html(progress + " percent na ang progress");
        $("#uploadProgressBar").css("width", progress + "%");
        $("#status").html(progress + "% uploaded... please wait");
    }

    function loadHandler(event) {
        $("#status").html(event.target.responseText);
        $("#uploadProgressBar").css("width", "0%");
    }

    function errorHandler(event) {
        $("#status").html("Upload Failed");
    }

    function abortHandler(event) {
        $("#status").html("Upload Aborted");
    }

    $("#uploadFile").click(function (event) {
        event.preventDefault();
        var file = $("#fileUpload")[0].files[0];
        var formData = new FormData();
        formData.append("file1", file);

        $.ajax({
            url: 'http://testarea.local/UploadWithProgressBar1/file_upload_parser.php',
            method: 'POST',
            type: 'POST',
            data: formData,
            contentType: false,
            processData: false,
            xhr: function () {
                var xhr = new window.XMLHttpRequest();
                xhr.upload.addEventListener("progress",
                    uploadProgressHandler,
                    false
                );
                xhr.addEventListener("load", loadHandler, false);
                xhr.addEventListener("error", errorHandler, false);
                xhr.addEventListener("abort", abortHandler, false);

                return xhr;
            }
        });
    });
</script> 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2018-01-30T08:22:27.447

这解决了我的问题

```
var url = "http://localhost/tech1/index.php?route=app/upload/ajax"; 

$.ajax({
  xhr: function() {
    var xhr = new window.XMLHttpRequest();

    xhr.upload.addEventListener("progress", function(evt) {
      if (evt.lengthComputable) {
        var percentComplete = evt.loaded / evt.total;
        percentComplete = parseInt(percentComplete * 100);
var $link = $('.'+ids);
          var $img = $link.find('i'); 
          $link.html('Uploading..('+percentComplete+'%)');
          $link.append($img);
      }
    }, false);

    return xhr;
  },
  url: url,
  type: "POST",
  data: JSON.stringify(uploaddata),
  contentType: "application/json",
  dataType: "json",
  success: function(result) {
    console.log(result);
  }
}); 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2020-04-09T21:31:59.663

[Kathir 的回答](https://stackoverflow.com/a/22987941/10029265)很棒，因为他只用 jQuery 就解决了这个问题。我只是想对他的回答做一些补充，以使用漂亮的 HTML 进度条来处理他的代码：

```
$.ajax({
xhr: function() {
var xhr = new window.XMLHttpRequest();

xhr.upload.addEventListener("progress", function(evt) {
  if (evt.lengthComputable) {
    var percentComplete = evt.loaded / evt.total;
    percentComplete = parseInt(percentComplete * 100);

    $('.progress-bar').width(percentComplete+'%');
    $('.progress-bar').html(percentComplete+'%');

  }
}, false);

return xhr;
},
url: posturlfile,
type: "POST",
data: JSON.stringify(fileuploaddata),
contentType: "application/json",
dataType: "json",
success: function(result) {
console.log(result);
}
}); 
```

这是进度条的 HTML 代码，我使用 Bootstrap 3 作为进度条元素：

```
<div class="progress" style="display:none;">
<div class="progress-bar progress-bar-success progress-bar-striped 
active" role="progressbar"
aria-valuemin="0" aria-valuemax="100" style="width:0%">
0%
</div>
</div> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-04T10:56:53.640

JavaScript：

```
<script>
/* jquery.form.min.js */
(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(typeof jQuery!="undefined"?jQuery:window.Zepto)}})(function(e){"use strict";function r(t){var n=t.data;if(!t.isDefaultPrevented()){t.preventDefault();e(t.target).ajaxSubmit(n)}}function i(t){var n=t.target;var r=e(n);if(!r.is("[type=submit],[type=image]")){var i=r.closest("[type=submit]");if(i.length===0){return}n=i[0]}var s=this;s.clk=n;if(n.type=="image"){if(t.offsetX!==undefined){s.clk_x=t.offsetX;s.clk_y=t.offsetY}else if(typeof e.fn.offset=="function"){var o=r.offset();s.clk_x=t.pageX-o.left;s.clk_y=t.pageY-o.top}else{s.clk_x=t.pageX-n.offsetLeft;s.clk_y=t.pageY-n.offsetTop}}setTimeout(function(){s.clk=s.clk_x=s.clk_y=null},100)}function s(){if(!e.fn.ajaxSubmit.debug){return}var t="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(t)}else if(window.opera&&window.opera.postError){window.opera.postError(t)}}var t={};t.fileapi=e("<input type='file'/>").get(0).files!==undefined;t.formdata=window.FormData!==undefined;var n=!!e.fn.prop;e.fn.attr2=function(){if(!n){return this.attr.apply(this,arguments)}var e=this.prop.apply(this,arguments);if(e&&e.jquery||typeof e==="string"){return e}return this.attr.apply(this,arguments)};e.fn.ajaxSubmit=function(r){function k(t){var n=e.param(t,r.traditional).split("&");var i=n.length;var s=[];var o,u;for(o=0;o<i;o++){n[o]=n[o].replace(/\+/g," ");u=n[o].split("=");s.push([decodeURIComponent(u[0]),decodeURIComponent(u[1])])}return s}function L(t){var n=new FormData;for(var s=0;s<t.length;s++){n.append(t[s].name,t[s].value)}if(r.extraData){var o=k(r.extraData);for(s=0;s<o.length;s++){if(o[s]){n.append(o[s][0],o[s][1])}}}r.data=null;var u=e.extend(true,{},e.ajaxSettings,r,{contentType:false,processData:false,cache:false,type:i||"POST"});if(r.uploadProgress){u.xhr=function(){var t=e.ajaxSettings.xhr();if(t.upload){t.upload.addEventListener("progress",function(e){var t=0;var n=e.loaded||e.position;var i=e.total;if(e.lengthComputable){t=Math.ceil(n/i*100)}r.uploadProgress(e,n,i,t)},false)}return t}}u.data=null;var a=u.beforeSend;u.beforeSend=function(e,t){if(r.formData){t.data=r.formData}else{t.data=n}if(a){a.call(this,e,t)}};return e.ajax(u)}function A(t){function T(e){var t=null;try{if(e.contentWindow){t=e.contentWindow.document}}catch(n){s("cannot get iframe.contentWindow document: "+n)}if(t){return t}try{t=e.contentDocument?e.contentDocument:e.document}catch(n){s("cannot get iframe.contentDocument: "+n);t=e.document}return t}function k(){function f(){try{var e=T(v).readyState;s("state = "+e);if(e&&e.toLowerCase()=="uninitialized"){setTimeout(f,50)}}catch(t){s("Server abort: ",t," (",t.name,")");_(x);if(w){clearTimeout(w)}w=undefined}}var t=a.attr2("target"),n=a.attr2("action"),r="multipart/form-data",u=a.attr("enctype")||a.attr("encoding")||r;o.setAttribute("target",p);if(!i||/post/i.test(i)){o.setAttribute("method","POST")}if(n!=l.url){o.setAttribute("action",l.url)}if(!l.skipEncodingOverride&&(!i||/post/i.test(i))){a.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(l.timeout){w=setTimeout(function(){b=true;_(S)},l.timeout)}var c=[];try{if(l.extraData){for(var h in l.extraData){if(l.extraData.hasOwnProperty(h)){if(e.isPlainObject(l.extraData[h])&&l.extraData[h].hasOwnProperty("name")&&l.extraData[h].hasOwnProperty("value")){c.push(e('<input type="hidden" name="'+l.extraData[h].name+'">').val(l.extraData[h].value).appendTo(o)[0])}else{c.push(e('<input type="hidden" name="'+h+'">').val(l.extraData[h]).appendTo(o)[0])}}}}if(!l.iframeTarget){d.appendTo("body")}if(v.attachEvent){v.attachEvent("onload",_)}else{v.addEventListener("load",_,false)}setTimeout(f,15);try{o.submit()}catch(m){var g=document.createElement("form").submit;g.apply(o)}}finally{o.setAttribute("action",n);o.setAttribute("enctype",u);if(t){o.setAttribute("target",t)}else{a.removeAttr("target")}e(c).remove()}}function _(t){if(m.aborted||M){return}A=T(v);if(!A){s("cannot access response document");t=x}if(t===S&&m){m.abort("timeout");E.reject(m,"timeout");return}else if(t==x&&m){m.abort("server abort");E.reject(m,"error","server abort");return}if(!A||A.location.href==l.iframeSrc){if(!b){return}}if(v.detachEvent){v.detachEvent("onload",_)}else{v.removeEventListener("load",_,false)}var n="success",r;try{if(b){throw"timeout"}var i=l.dataType=="xml"||A.XMLDocument||e.isXMLDoc(A);s("isXml="+i);if(!i&&window.opera&&(A.body===null||!A.body.innerHTML)){if(--O){s("requeing onLoad callback, DOM not available");setTimeout(_,250);return}}var o=A.body?A.body:A.documentElement;m.responseText=o?o.innerHTML:null;m.responseXML=A.XMLDocument?A.XMLDocument:A;if(i){l.dataType="xml"}m.getResponseHeader=function(e){var t={"content-type":l.dataType};return t[e.toLowerCase()]};if(o){m.status=Number(o.getAttribute("status"))||m.status;m.statusText=o.getAttribute("statusText")||m.statusText}var u=(l.dataType||"").toLowerCase();var a=/(json|script|text)/.test(u);if(a||l.textarea){var f=A.getElementsByTagName("textarea")[0];if(f){m.responseText=f.value;m.status=Number(f.getAttribute("status"))||m.status;m.statusText=f.getAttribute("statusText")||m.statusText}else if(a){var c=A.getElementsByTagName("pre")[0];var p=A.getElementsByTagName("body")[0];if(c){m.responseText=c.textContent?c.textContent:c.innerText}else if(p){m.responseText=p.textContent?p.textContent:p.innerText}}}else if(u=="xml"&&!m.responseXML&&m.responseText){m.responseXML=D(m.responseText)}try{L=H(m,u,l)}catch(g){n="parsererror";m.error=r=g||n}}catch(g){s("error caught: ",g);n="error";m.error=r=g||n}if(m.aborted){s("upload aborted");n=null}if(m.status){n=m.status>=200&&m.status<300||m.status===304?"success":"error"}if(n==="success"){if(l.success){l.success.call(l.context,L,"success",m)}E.resolve(m.responseText,"success",m);if(h){e.event.trigger("ajaxSuccess",[m,l])}}else if(n){if(r===undefined){r=m.statusText}if(l.error){l.error.call(l.context,m,n,r)}E.reject(m,"error",r);if(h){e.event.trigger("ajaxError",[m,l,r])}}if(h){e.event.trigger("ajaxComplete",[m,l])}if(h&&!--e.active){e.event.trigger("ajaxStop")}if(l.complete){l.complete.call(l.context,m,n)}M=true;if(l.timeout){clearTimeout(w)}setTimeout(function(){if(!l.iframeTarget){d.remove()}else{d.attr("src",l.iframeSrc)}m.responseXML=null},100)}var o=a[0],u,f,l,h,p,d,v,m,g,y,b,w;var E=e.Deferred();E.abort=function(e){m.abort(e)};if(t){for(f=0;f<c.length;f++){u=e(c[f]);if(n){u.prop("disabled",false)}else{u.removeAttr("disabled")}}}l=e.extend(true,{},e.ajaxSettings,r);l.context=l.context||l;p="jqFormIO"+(new Date).getTime();if(l.iframeTarget){d=e(l.iframeTarget);y=d.attr2("name");if(!y){d.attr2("name",p)}else{p=y}}else{d=e('<iframe name="'+p+'" src="'+l.iframeSrc+'" />');d.css({position:"absolute",top:"-1000px",left:"-1000px"})}v=d[0];m={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(t){var n=t==="timeout"?"timeout":"aborted";s("aborting upload... "+n);this.aborted=1;try{if(v.contentWindow.document.execCommand){v.contentWindow.document.execCommand("Stop")}}catch(r){}d.attr("src",l.iframeSrc);m.error=n;if(l.error){l.error.call(l.context,m,n,t)}if(h){e.event.trigger("ajaxError",[m,l,n])}if(l.complete){l.complete.call(l.context,m,n)}}};h=l.global;if(h&&0===e.active++){e.event.trigger("ajaxStart")}if(h){e.event.trigger("ajaxSend",[m,l])}if(l.beforeSend&&l.beforeSend.call(l.context,m,l)===false){if(l.global){e.active--}E.reject();return E}if(m.aborted){E.reject();return E}g=o.clk;if(g){y=g.name;if(y&&!g.disabled){l.extraData=l.extraData||{};l.extraData[y]=g.value;if(g.type=="image"){l.extraData[y+".x"]=o.clk_x;l.extraData[y+".y"]=o.clk_y}}}var S=1;var x=2;var N=e("meta[name=csrf-token]").attr("content");var C=e("meta[name=csrf-param]").attr("content");if(C&&N){l.extraData=l.extraData||{};l.extraData[C]=N}if(l.forceSync){k()}else{setTimeout(k,10)}var L,A,O=50,M;var D=e.parseXML||function(e,t){if(window.ActiveXObject){t=new ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e)}else{t=(new DOMParser).parseFromString(e,"text/xml")}return t&&t.documentElement&&t.documentElement.nodeName!="parsererror"?t:null};var P=e.parseJSON||function(e){return window["eval"]("("+e+")")};var H=function(t,n,r){var i=t.getResponseHeader("content-type")||"",s=n==="xml"||!n&&i.indexOf("xml")>=0,o=s?t.responseXML:t.responseText;if(s&&o.documentElement.nodeName==="parsererror"){if(e.error){e.error("parsererror")}}if(r&&r.dataFilter){o=r.dataFilter(o,n)}if(typeof o==="string"){if(n==="json"||!n&&i.indexOf("json")>=0){o=P(o)}else if(n==="script"||!n&&i.indexOf("javascript")>=0){e.globalEval(o)}}return o};return E}if(!this.length){s("ajaxSubmit: skipping submit process - no element selected");return this}var i,o,u,a=this;if(typeof r=="function"){r={success:r}}else if(r===undefined){r={}}i=r.type||this.attr2("method");o=r.url||this.attr2("action");u=typeof o==="string"?e.trim(o):"";u=u||window.location.href||"";if(u){u=(u.match(/^([^#]+)/)||[])[1]}r=e.extend(true,{url:u,success:e.ajaxSettings.success,type:i||e.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},r);var f={};this.trigger("form-pre-serialize",[this,r,f]);if(f.veto){s("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(r.beforeSerialize&&r.beforeSerialize(this,r)===false){s("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var l=r.traditional;if(l===undefined){l=e.ajaxSettings.traditional}var c=[];var h,p=this.formToArray(r.semantic,c);if(r.data){r.extraData=r.data;h=e.param(r.data,l)}if(r.beforeSubmit&&r.beforeSubmit(p,this,r)===false){s("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[p,this,r,f]);if(f.veto){s("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var d=e.param(p,l);if(h){d=d?d+"&"+h:h}if(r.type.toUpperCase()=="GET"){r.url+=(r.url.indexOf("?")>=0?"&":"?")+d;r.data=null}else{r.data=d}var v=[];if(r.resetForm){v.push(function(){a.resetForm()})}if(r.clearForm){v.push(function(){a.clearForm(r.includeHidden)})}if(!r.dataType&&r.target){var m=r.success||function(){};v.push(function(t){var n=r.replaceTarget?"replaceWith":"html";e(r.target)[n](t).each(m,arguments)})}else if(r.success){v.push(r.success)}r.success=function(e,t,n){var i=r.context||this;for(var s=0,o=v.length;s<o;s++){v[s].apply(i,[e,t,n||a,a])}};if(r.error){var g=r.error;r.error=function(e,t,n){var i=r.context||this;g.apply(i,[e,t,n,a])}}if(r.complete){var y=r.complete;r.complete=function(e,t){var n=r.context||this;y.apply(n,[e,t,a])}}var b=e("input[type=file]:enabled",this).filter(function(){return e(this).val()!==""});var w=b.length>0;var E="multipart/form-data";var S=a.attr("enctype")==E||a.attr("encoding")==E;var x=t.fileapi&&t.formdata;s("fileAPI :"+x);var T=(w||S)&&!x;var N;if(r.iframe!==false&&(r.iframe||T)){if(r.closeKeepAlive){e.get(r.closeKeepAlive,function(){N=A(p)})}else{N=A(p)}}else if((w||S)&&x){N=L(p)}else{N=e.ajax(r)}a.removeData("jqxhr").data("jqxhr",N);for(var C=0;C<c.length;C++){c[C]=null}this.trigger("form-submit-notify",[this,r]);return this};e.fn.ajaxForm=function(t){t=t||{};t.delegation=t.delegation&&e.isFunction(e.fn.on);if(!t.delegation&&this.length===0){var n={s:this.selector,c:this.context};if(!e.isReady&&n.s){s("DOM not ready, queuing ajaxForm");e(function(){e(n.s,n.c).ajaxForm(t)});return this}s("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)"));return this}if(t.delegation){e(document).off("submit.form-plugin",this.selector,r).off("click.form-plugin",this.selector,i).on("submit.form-plugin",this.selector,t,r).on("click.form-plugin",this.selector,t,i);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",t,r).bind("click.form-plugin",t,i)};e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};e.fn.formToArray=function(n,r){var i=[];if(this.length===0){return i}var s=this[0];var o=this.attr("id");var u=n?s.getElementsByTagName("*"):s.elements;var a;if(u&&!/MSIE [678]/.test(navigator.userAgent)){u=e(u).get()}if(o){a=e(':input[form="'+o+'"]').get();if(a.length){u=(u||[]).concat(a)}}if(!u||!u.length){return i}var f,l,c,h,p,d,v;for(f=0,d=u.length;f<d;f++){p=u[f];c=p.name;if(!c||p.disabled){continue}if(n&&s.clk&&p.type=="image"){if(s.clk==p){i.push({name:c,value:e(p).val(),type:p.type});i.push({name:c+".x",value:s.clk_x},{name:c+".y",value:s.clk_y})}continue}h=e.fieldValue(p,true);if(h&&h.constructor==Array){if(r){r.push(p)}for(l=0,v=h.length;l<v;l++){i.push({name:c,value:h[l]})}}else if(t.fileapi&&p.type=="file"){if(r){r.push(p)}var m=p.files;if(m.length){for(l=0;l<m.length;l++){i.push({name:c,value:m[l],type:p.type})}}else{i.push({name:c,value:"",type:p.type})}}else if(h!==null&&typeof h!="undefined"){if(r){r.push(p)}i.push({name:c,value:h,type:p.type,required:p.required})}}if(!n&&s.clk){var g=e(s.clk),y=g[0];c=y.name;if(c&&!y.disabled&&y.type=="image"){i.push({name:c,value:g.val()});i.push({name:c+".x",value:s.clk_x},{name:c+".y",value:s.clk_y})}}return i};e.fn.formSerialize=function(t){return e.param(this.formToArray(t))};e.fn.fieldSerialize=function(t){var n=[];this.each(function(){var r=this.name;if(!r){return}var i=e.fieldValue(this,t);if(i&&i.constructor==Array){for(var s=0,o=i.length;s<o;s++){n.push({name:r,value:i[s]})}}else if(i!==null&&typeof i!="undefined"){n.push({name:this.name,value:i})}});return e.param(n)};e.fn.fieldValue=function(t){for(var n=[],r=0,i=this.length;r<i;r++){var s=this[r];var o=e.fieldValue(s,t);if(o===null||typeof o=="undefined"||o.constructor==Array&&!o.length){continue}if(o.constructor==Array){e.merge(n,o)}else{n.push(o)}}return n};e.fieldValue=function(t,n){var r=t.name,i=t.type,s=t.tagName.toLowerCase();if(n===undefined){n=true}if(n&&(!r||t.disabled||i=="reset"||i=="button"||(i=="checkbox"||i=="radio")&&!t.checked||(i=="submit"||i=="image")&&t.form&&t.form.clk!=t||s=="select"&&t.selectedIndex==-1)){return null}if(s=="select"){var o=t.selectedIndex;if(o<0){return null}var u=[],a=t.options;var f=i=="select-one";var l=f?o+1:a.length;for(var c=f?o:0;c<l;c++){var h=a[c];if(h.selected){var p=h.value;if(!p){p=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value}if(f){return p}u.push(p)}}return u}return e(t).val()};e.fn.clearForm=function(t){return this.each(function(){e("input,select,textarea",this).clearFields(t)})};e.fn.clearFields=e.fn.clearInputs=function(t){var n=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var r=this.type,i=this.tagName.toLowerCase();if(n.test(r)||i=="textarea"){this.value=""}else if(r=="checkbox"||r=="radio"){this.checked=false}else if(i=="select"){this.selectedIndex=-1}else if(r=="file"){if(/MSIE/.test(navigator.userAgent)){e(this).replaceWith(e(this).clone(true))}else{e(this).val("")}}else if(t){if(t===true&&/hidden/.test(r)||typeof t=="string"&&e(this).is(t)){this.value=""}}})};e.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType){this.reset()}})};e.fn.enable=function(e){if(e===undefined){e=true}return this.each(function(){this.disabled=!e})};e.fn.selected=function(t){if(t===undefined){t=true}return this.each(function(){var n=this.type;if(n=="checkbox"||n=="radio"){this.checked=t}else if(this.tagName.toLowerCase()=="option"){var r=e(this).parent("select");if(t&&r[0]&&r[0].type=="select-one"){r.find("option").selected(false)}this.selected=t}})};e.fn.ajaxSubmit.debug=false})
</script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#myform').on('change', '.wpcf7-file', function (e) {
                e.preventDefault();
                var myParent = $(this).parent();
                var filname= $('input[type=file]').val()

                if (filname) { 
                $(this).parent().find('#progress-div').show();          
                $('#myform').ajaxSubmit({
                    // target: '#progress-div123',/**********only for response************/
                    beforeSubmit: function () {
                        myParent.find('#progress-bar').width('0%');
                    },
                    uploadProgress: function (event, position, total, percentComplete) {
                        myParent.find('#progress-bar').width(percentComplete + '%');
                        myParent.find('#progress-bar').html('<div id="progress-status">' + percentComplete + ' %</div>')
                    },
                    success: function showResponse(responseText, statusText, xhr, $form) {

                        //myParent.find('#progress-div').hide(10000);
                    },
                    resetForm: false
                });

                }
                return false;
            });

           /***********Error msg if file not valid***************/
                $('input[type=file]').change(function () {
                var val = $(this).val().toLowerCase();
                var regex = new RegExp("(.*?)\.(pdf|txt|jpg|png|doc|docx|xlx|xls|xlsx|jpg|ppt|pptx|tif|tiff|\n\
                bmp|pcd|gif|bmp|zip|rar|odt|avi|ogg|m4a|mov|mp3|mp4|mpg|wav|wmv|stp|sldprt|sldasm|iges|igs|stl|x_t|step\n\
                |stp|prt|asm|idw|iam|ipt|dxf|dwg|pdf|slddrw|dwf)$");
                if (!(regex.test(val))) {
                    $(this).val('');
                    alert('Please select correct file format');
                }
                });
            /*********End*****************/

        });
</script> 
```

款式：

```
<style>
    body{width:610px;}
    #uploadForm {border-top:#F0F0F0 2px solid;background:#FAF8F8;padding:10px;}
    #uploadForm label {margin:2px; font-size:1em; font-weight:bold;}
    .demoInputBox{padding:5px; border:#F0F0F0 1px solid; border-radius:4px; background-color:#FFF;}
    #progress-bar {background-color: #12CC1A;height:20px;color: #FFFFFF;width:0%;-webkit-transition: width .3s;-moz-transition: width .3s;transition: width .3s;}
    .btnSubmit{background-color:#09f;border:0;padding:10px 40px;color:#FFF;border:#F0F0F0 1px solid; border-radius:4px;}
    #progress-div
    {
        border: 1px solid #0fa015;
        border-radius: 4px;
        margin: -35px 2px 7px 295px;
        padding: 5px 0;
        text-align: center;
        width: 277px;
    }

    #targetLayer{width:100%;text-align:center;}
</style> 
```

# node.js - Socket.io 是否保证按客户端顺序接收广播事件？

> ID：15410267
> 
> 赞同：17
> 
> 时间：2013-03-14T13:11:57.457
> 
> 标签：node.js, socket.io, server-push

Socket.IO 中是否有某种排序机制可以保证客户端按顺序接收事件？

例如：如果服务器向客户端 A 发出事件，并且服务器向所有客户端`Evt1`广播。`Evt2`因此，客户端 A`Evt1`仅`Evt2`按该顺序接收。

我的猜测是否定的，如果是这样，您将如何实施它，或者是否有现有的解决方案？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2017-01-13T18:47:24.100

由于以前的答案可能会产生误导，我认为澄清一件事很重要：

## 将 Socket.io 与 WebSockets 一起使用时，可以保证保持数据包顺序。

这是一篇旧文章，但值得注意的是，基于*WebSockets的 Socket.io* **实际上确实**保证了事件顺序的维护。这是因为 TCP 本身，它是 WebSockets 和 HTTP 的底层技术，可以保证数据包的顺序得到维护。但是 Socket.io 还支持其他几种**不**保证顺序的协议。

关于这个问题已经发布了几个问题，支持这一事实：

*   [https://github.com/josephg/ShareJS/issues/375](https://github.com/josephg/ShareJS/issues/375)
*   [websocket消息可以乱序到达吗？](https://stackoverflow.com/questions/11804721/can-websocket-messages-arrive-out-of-order)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-14T20:33:55.003

不，如果需要，您必须在应用程序级别执行此操作。互联网不保证两个不同的数据包将采用相同的路由，因此时间可能会有所不同。也许为每条消息添加一个时间戳，以便您可以按该时间戳排序以保持事情井井有条。

# jsp - 如何显示属性文件中定义的值？

> ID：15410269
> 
> 赞同：1
> 
> 时间：2013-03-14T13:11:59.043
> 
> 标签：jsp, properties, struts2, locale

我正在尝试在我的应用程序中使用语言环境，我能够从我的属性文件中检索值。

问题是我只想显示消息但不知道如何，我用

```
 <s:url action="retrieveValues" var="myValues">
        <s:param name="request_locale">val</s:param>
    </s:url>

   <s:label key="mytext"/> 
```

它有效，但我只需要将 mytext 的值显示为单个文本。

当我使用上面显示的代码时，可以说 mytext 的值是 Hello world

```
 Hello world: Hello world 
```

我怎么能把它改成

```
 Hello World 
```

所以它不显示“Hello world：”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T06:58:53.090

如果您的属性文件中有如下属性

```
mytext=Hello World 
```

您可以在 JSP 中使用以下内容

```
<s:text name="mytext"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T06:12:06.740

不确定，但下面的代码怎么样？

```
 <s:property value="myText"/> 
```

# dns - 在 OpenFire AWS EC2 上启用 S2S 流

> ID：15410272
> 
> 赞同：1
> 
> 时间：2013-03-14T13:12:06.617
> 
> 标签：dns, amazon-ec2, xmpp, openfire

我正在尝试在我的 OpenFire 服务器上启用 XMPP 联合。我已经创建了 DNS SRV 记录并且它们正确列出。但我仍然无法从任何其他提供商（如 jabber.org 和 google talk）连接到服务器。我在[http://www.imtrends.com/](http://www.imtrends.com/)检查了我的设置，它显示“服务器到服务器流”、“通过 PubSub 的个人事件”和“客户端到服务器 SSL 流”不可用.

![截屏](../Images/39f797cc8e69c971c8c1a706f84a20d1.png)

什么是服务器到服务器流以及如何启用它？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:32:36.020

您必须验证防火墙不拒绝连接和它在服务器配置中启用的 S2S。

s2s使用的端口默认为5269。

# r - 将月份和日期合并为一个日期列

> ID：15410273
> 
> 赞同：11
> 
> 时间：2013-03-14T13:12:06.913
> 
> 标签：r

使用 R，我想将包含在两个不同列中的月 nb（月）和天 nb（天）合并为一列（日期），并以日期格式使用创建的列。

我的数据框如下所示：

```
St Dep Month Day
A 2 1 1
B 2 1 1
B 2 2 1
A 5 1 1
A 7 1 1
C 2 1 1
C 5 1 1 
```

我想添加一个类似“Jan-01”的列。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-14T13:19:36.650

我在这里假设“日期格式”只是指一个看起来像日期的字符串，而不是 R 中的正确日期类。

```
data <- data.frame( Month=c(1,5,2), Day=c(1,2,3) )
data$MonthDay <- paste( month.abb[data$Month], data$Day, sep="-" )
data
#   Month Day MonthDay
# 1     1   1    Jan-1
# 2     5   2    May-2
# 3     2   3    Feb-3 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-14T13:16:07.367

尝试这个...

```
df <- data.frame( Month = sample(1:12 , 10 , repl = TRUE ) , Day = sample(1:30 , 10 , repl = TRUE ) )
df$Date <- as.Date( paste( df$Month , df$Day , sep = "." )  , format = "%m.%d" )

df
#      Month Day       Date
#   1      1   8 2013-01-08
#   2      1  17 2013-01-17
#   3      7  23 2013-07-23
#   4     11  21 2013-11-21
#   5      3  30 2013-03-30
#   6     12  15 2013-12-15
#   7      2  30       <NA>
#   8      7  10 2013-07-10
#   9      1  16 2013-01-16
#   10     8   1 2013-08-01 
```

我得到了一些 NA，因为我编造了随机日期，其中一些不存在，例如 2 月 30 日

# php - 如何在 jeditable 中发送多个变量？

> ID：15410277
> 
> 赞同：6
> 
> 时间：2013-03-14T13:12:11.583
> 
> 标签：php, jquery, jeditable

我对 jquery 还是很陌生，现在，我使用 jeditable 让用户在我的网页上编辑一些信息。

所以这是我的问题，如何使用 jeditable 将多个变量发送到 php 文件？我知道当用户点击提交按钮时，id 和 value 将被 POST 到 php 文件中。

所以假设我有这个代码：

```
var x = 1;
var y = 2;

$('.edit_area').editable('test.php', {
    type      : 'textarea', 
    cancel    : 'Cancel',
    event     : "dblclick",
    submit    : 'OK',
    indicator : '<img src="img/loading.gif">',
    tooltip   : 'Click to edit...'
}); 
```

当用户单击 jeditable 中的确定按钮时，如何将 x 和 y 变量发送到 test.php？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-18T21:35:26.300

这篇文章很老了，但我偶然发现了它。也许这会对某人有所帮助。简要查看 [文档](http://www.appelsiini.net/projects/jeditable)会告诉您：

> “（混合）提交数据：提交内容时的额外参数。可以是哈希或返回哈希的函数。”

```
$(".editable").editable("http://www.example.com/save.php";, {
   submitdata : {foo: "bar"};
}); 
```

因此，在您的情况下，您只需像这样添加额外的参数“submitdata”：

```
submitdata : {x: x, y: y}; 
```

如果用户现在单击 OK 按钮，x 和 y 的值将被发送到服务器。

# mysql - 来自 Sphinx 引擎的 MySQL SELECT 版本号

> ID：15410278
> 
> 赞同：0
> 
> 时间：2013-03-14T13:12:26.877
> 
> 标签：mysql, sql, sphinx

我正在对大量 MySQL / Sphinx 服务器进行监控。我想通过使用 SQL SELECT 查询来监控 Sphinx 的版本号。我想通过 SELECT 查询来做到这一点，因为我无法访问 Sphinx 机器的文件系统，而且 SELECT 查询将简化我的监控实现。

例如，对于 MySQL 版本号，我可以使用：

```
SHOW GLOBAL VARIABLES LIKE 'version'; 
```

是否有任何类似的解决方法来获取 Sphinx 版本，例如通过触发类似的查询

```
SHOW GLOBAL VARIABLES LIKE '%sphinx%'; ? 
```

对此有何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T15:37:49.420

我不知道如何在 SphinxQL 命令中获取它，但是当您第一次连接 CLI 客户端时，会显示服务器版本

```
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 1
Server version: 2.1.1-dev (r3645)

Copyright (c) 2000, 2012, Oracle and/or its affiliates. All rights reserved. 
```

也许你可以以某种方式使用它。我认为在 PHP 中它暴露在 mysql_get_server_info() 中 - 在首次连接时从协议中提取。

# java - 我想通过一个按钮重新启动我的 Android 平板电脑

> ID：15410281
> 
> 赞同：0
> 
> 时间：2013-03-14T13:12:28.920
> 
> 标签：java, android, linux, permissions, system

在搜索了一段时间以解决上述问题后，我发现我的知识非常低。^^

我发现了许多关于“如何重新启动设备”的描述，但我并没有真正理解它们，或者它仅适用于有根设备（我的设备不是）。现在我的确切问题：我怎样才能为我的应用程序实现系统权限，而无需对其进行生根，也无需编写自己的固件？非常欢迎提供详细的解释，因为我对 Java、android 编码的了解很少，而且我的 linux 知识也降至 0。请帮忙。

第二个问题，一句话回答：如果我得到了系统密钥（据我所知，我需要许可）我的应用程序是否也可以在其他设备上运行，或者它是否属于这个密钥？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:14:12.823

看看这个样子你就会明白了。

[android-如何通过编码关闭我的手机？](https://stackoverflow.com/questions/13561427/android-how-to-switch-off-my-mobile-through-coding)

希望这可以帮助你。

# java - 恢复 Eclipse Java 项目中的重构步骤

> ID：15410285
> 
> 赞同：1
> 
> 时间：2013-03-14T13:12:37.213
> 
> 标签：java, eclipse, refactoring, version

我在 Eclipse 中的大型 java 源代码中重构了类名。但是在重构产生任何不良结果的情况下，我想恢复到以前的类名或代码状态。有没有办法在 Eclipse 中恢复到以前的类名？它是否保留重构阶段的版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:14:45.850

通常，您只需按撤消即可实现此目的。如果由于任何原因无法做到这一点，Eclipse 会警告您。

在紧急情况下：使用您的 VCS 恢复 :-)

# python - 芹菜倒计时错误

> ID：15410291
> 
> 赞同：2
> 
> 时间：2013-03-14T13:12:56.877
> 
> 标签：python, celery

我正在尝试为任务添加倒计时，但没有运气。

这是我正在使用的代码

```
@celery.task
def check_st(key, t):
    device = Device.query.filter(Device.key == key).first()
    data = Data.query.filter(Data.dev_id == device.id).order_by(Data.timestamp.desc()).first()
    if(data.timestamp == t):
        return True 
```

我这样称呼它

```
check_st.apply_async([key, data.timestamp], countdown=300) 
```

取自完整的[芹菜原木](http://pastebin.com/CEyLy5QH)。

有任何想法吗？

## 编辑

用倒计时测试一个简单的例子似乎工作正常。我想这是我的项目布局导致问题与我运行芹菜的方式相结合。

所以我的布局是这样的

项目（应用程序（`__init__.py`，，，，`views.py`）`models.py`）`tasks.py`

在我的tasks.py中，我导入这样的模块

```
from app.models import Device, Data 
```

然后在我的views.py中我使用导入任务

```
from app.tasks import check_st 
```

`proj/`我在这样的目录中运行芹菜

```
celery -A app.tasks worker -l info 
```

使用此设置，所有其他任务都按预期工作，但是当我添加倒计时关键字时，我得到以下信息

```
Task app.tasks.check_st[deffd607-c6d4-41af-882c-e111736888ba] raised exception: TypeError("check_st() got an unexpected keyword argument 'countdown'",) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T20:59:18.983

问题终于解决了。解决方案来自于改变

```
celery -A app.tasks worker -l info 
```

到

```
celery --workdir=proj/ -A app.tasks worker -l info 
```

# javascript - 我想拆分一个字符串以获取循环中的值

> ID：15410292
> 
> 赞同：0
> 
> 时间：2013-03-14T13:13:04.753
> 
> 标签：javascript

我想拆分以下字符串：

```
var tree = [{
  "id" : 1
}, {
  "id" : 2,
  "children" : [{
      "id" : 3
    }, {
      "id" : 4
    }, {
      "id" : 5,
      "children" : [{ 
          "id" : 6
        }
      ] 
    }
  ]
}]; 
```

我想拆分此字符串以获取值：

```
1,2,3,4,5,6. 
```

现在我该如何拆分它以获取值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:33:07.510

你在那里的东西看起来像`JSON`

试试这个：

```
var myObject = eval('(' + tree + ')');

var ids = findIds(myObject);

// this is untested, but the principle applies
function findIds(o) {

    var ids = new Array();

    for (var i = 0; i < o.length; i++) {

        ids.push(o[i].id);
        ids.push(findIds(o[i].children));
    }

    return ids;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:19:50.297

如果这是一个 javascript 对象，它可能会更快地遍历树并收集 id。如果这是一个字符串，您可以 eval 来获取一个树对象。

```
function collect(tree,arr){
  for(var i=0;i<tree.length;i++){
     arr.push(tree[i].id)
     for(var j=0;j<tree[i].children;j++){
        collect(tree[i].children[j],arr)
    }
 }
} 
```

调用函数

```
var arr=[];
collect(tree,arr);//arr will have results 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:27:26.093

如果这确实是一个字符串，另一种方法是使用正则表达式（如果您的字符串不是可以评估的代码，您将来可以使用这种方法）。

```
var ids = str.match(/\d+/g); 
```

会返回：

```
[1, 2, 3, 4, 5, 6] 
```

（假设整个字符串在一个名为 'str' 的 var 中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T14:10:59.843

我总是因为没有提供“vanilla javascript”答案而被骂，但就这样吧。看起来你想要的是[JSONSelect](http://jsonselect.org/#tryit)：

```
var tree = [{   "id" : 1 }, {   "id" : 2,   "children" : [{
      "id" : 3
    }, {
      "id" : 4
    }, {
      "id" : 5,
      "children" : [{ 
          "id" : 6
        }
      ] 
    }   ] }];

jsel.match(tree, '.id'); 
```

您也可以使用[下划线](http://underscorejs.org/)来执行此操作，但您需要将其展平，这样会显得不那么优雅。

# scala - 如何支持 morphia 中的 scala 集合？

> ID：15410297
> 
> 赞同：0
> 
> 时间：2013-03-14T13:13:29.420
> 
> 标签：scala, morphia

之前用morphia，现在开始用scala。发现morphia不能支持集合类型，比如List、ListBuffer、Set...

有什么方法可以支持这一点，比如编写一个扩展类并注册它，或者任何现有的 jar 都这样做了？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-14T16:59:48.167

宣言：

```
@Entity  
class User {    
  @Id
  var id: ObjectId = _;
  var name: String = _;
  var profiles: BSONObject = new BasicBSONList();
} 
```

保存（假设`ds`是 a `Datastore`）：

```
val me = new User()
me.name = "Hello" 
me.profiles = new BasicBSONList();
me.profiles.put("0", "str0");
me.profiles.put("4", "str1");
me.profiles.put("2", "str2");
ds.save[User](me) 
```

加载：

```
for (user <- ds.find(classOf[User]).asocial) {       
  log.log("" + user.name + "'s" + " profiles: " + user.profiles)       
} 
```

输出：

```
me's profiles: [str0, null, str2, null, str1] 
```

# qt - 使用模块 QtXmlPatterns 中的 QXmlQuery 将 xslt 结果放入 CDATA 部分

> ID：15410298
> 
> 赞同：0
> 
> 时间：2013-03-14T13:13:32.883
> 
> 标签：qt, xslt

我尝试通过 xslt 文件转换 xml。输出应包含 CDATA 部分。为此，我使用 qt 4.8.3 中的 QXMLQuery 对象。

我尝试这样的事情：

xml:

```
<?xml version="1.0" encoding="UTF-8"?>
<b>
  <a>1</a>
  <a>2</a>
  <a>3</a>
  <a>4</a>
</b> 
```

xsl:

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:template match="/">
    <x>
      <xsl:apply-templates select="./b/a"/>
    </x>
  </xsl:template>
  <xsl:template match="b/a">
    <aa>
      <xsl:text disable-output-escaping="yes">&lt;![CDATA[</xsl:text>
      <xsl:value-of select="./text()"/>
      <xsl:element name="img"/>
      <xsl:text disable-output-escaping="yes">]]&gt;</xsl:text>
    </aa>
  </xsl:template>
</xsl:stylesheet> 
```

使用其他 xslt 编辑器会导致：

```
<?xml version="1.0" encoding="UTF-8"?>
<x>
  <aa><![CDATA[1<img/>]]></aa>
  <aa><![CDATA[2<img/>]]></aa>
  <aa><![CDATA[3<img/>]]></aa>
  <aa><![CDATA[4<img/>]]></aa>
</x> 
```

使用 QXMLQuery 结果：

```
Fehler XTSE0090 in file:///C:/work/2.xsl, bei Zeile 11, Spalte 46: Attribute disable-output-escaping cannot appear on the element text. Only the standard attributes can appear. 
```

还有其他方法可以做到这一点吗？或者如果没有办法：是否有另一个用于 C++ 的免费或开源 xslt 解析器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:17:01.103

看起来您的 XSLT 处理器不支持该属性。您可以尝试使用它来`xsl:value-of`代替：

```
 <xsl:value-of select="'&lt;![CDATA['" disable-output-escaping="yes" />
  <xsl:value-of select="./text()"/>
  <xsl:element name="img"/>
  <xsl:value-of select="']]&gt;'" disable-output-escaping="yes" /> 
```

这是我最好的猜测。

# wpf - 从框架内关闭 wpf 窗口

> ID：15410301
> 
> 赞同：5
> 
> 时间：2013-03-14T13:13:45.897
> 
> 标签：wpf, vb.net, navigation

我正在将一个 Winform 项目移植到 WPF 并开始使用 Windows 和 Pages（使用框架控件）。基本上我的意图是从一个页面导航到下一个页面，直到用户成功登录。现在由于登录是在页面级别处理的......我的问题是：

**页面如何关闭父窗口？！？**

如果您知道 vb 中的代码，请提前致谢。如果没有，我会在 C# 中解决。

```
Public Sub CloseLogIn()
    Dim LogIn = TryCast(Me.Parent, Window)
    If LogIn IsNot Nothing Then
        LogIn.Close()
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T14:09:10.850

尝试

```
Public Sub CloseLogIn()
    Dim LogIn = Window.GetWindow(Me)
    If LogIn IsNot Nothing Then
        LogIn.Close()
    End If
End Sub 
```

Window.GetWindow [()](http://msdn.microsoft.com/en-us/library/system.windows.window.getwindow%28v=vs.90%29.aspx)方法返回对 Window 对象的引用，该对象承载依赖对象所在的内容树。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:42:29.210

您应该使用 Page 实例上的 Parent 属性来获取承载[Page的 Window。](http://msdn.microsoft.com/en-us/library/ms611620%28v=vs.100%29.aspx)

该属性是 type `DependencyObject`，因此您必须将值转换为您需要的类型。在您的情况下，您将其转换为`Window`.

```
public class MyPage : Page{

   public void CloseWindow(){
     var parentWindow = this.Parent as Window;

     if (parentWindow != null) {
       parentWindow.Close();
     }
   }
} 
```

# c# - 使用 C# 使用 List 生成对

> ID：15410302
> 
> 赞同：0
> 
> 时间：2013-03-14T13:13:46.073
> 
> 标签：c#, linq, generic-collections

基本上我有来自酒店的房间列表，假设用户选择了 3 个房间

第 1 间可容纳 2 名成人，第 2 间可容纳
4 名成人，第
3 间可容纳 6 名成人。

很好，当我将此请求发送到 XML 服务时。它为我提供了带有未配对列表的房间，因此我需要根据 RO（仅限房间）的酒店房间类型对这些房间进行配对，每对元素应具有相同的房间类型，但每个请求的房间都如上所述。

所以我想你现在已经清楚地知道发生了什么:)，Occupancy 属性中的第二个值显示在这里 Number of Adults。我数学不好，但我认为它是数学中的某种集合。

结果，我们总共有 4 间客房，其中我们有前 2 间供 2 位成人（//1 和 //2）使用的房间，因此我们必须将这些房间与其他（4 位成人和 6 位成人）房间配对。

现在在这种情况下，我需要 3 对，如下所述

> **SB，仅限客房， 2 名成人**1.2 SB，仅限客房， **4 名成人**
> 1.4 SB，仅限客房， **6 名成人** 1.6 DQ，仅限客房， **2 名成人**1.2 SB，仅限客房，1 , **4 位成人** SB，仅限客房，1,6 位 **成人 6 位成人**
> 
>  ******SB, 早餐, 1,2 **2 成人**
> SB, 早餐, 1,4 **4 成人**
> SB, 早餐, 1,6 **6 成人********

 ****```
public class rr {
   public string roomType { get; set; }
   public string room { get; set; }
   public string occupancy { get; set; }        
}

List<rr> listOfOccupancy = new List<rr>();

listOfOccupancy.Add(new rr { roomType = "SB", room = "Room Only", occupancy = "1,2" }); //1
listOfOccupancy.Add(new rr { roomType = "DQ", room = "Room Only", occupancy = "1,2" }); //2
listOfOccupancy.Add(new rr { roomType = "SB", room = "Room Only", occupancy = "1,4" }); //3
listOfOccupancy.Add(new rr { roomType = "SB", room = "Room Only", occupancy = "1,6" }); //4 

listOfOccupancy.Add(new rr { roomType = "SB", room = "Breakfast", occupancy = "1,2" }); //5
listOfOccupancy.Add(new rr { roomType = "SB", room = "Breakfast", occupancy = "1,4" }); //6
listOfOccupancy.Add(new rr { roomType = "SB", room = "Breakfast", occupancy = "1,6" }); //7 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:20:39.250

也许这可能会为您指明正确的方向：

```
 var x = listOfOccupancy
        .OrderByDescending(r => r.room)
        .ThenBy(r => r.occupancy)
        // Optional distinct using equality comparer
        //.Distinct(...)
        .ToList(); 
```

干杯，亚历克斯

编辑：这会产生：

```
RO, 1,2
RO, 1,2
RO, 1,4
RO, 1,6
AB, 1,2
AB, 1,2
AB, 1,4
AB, 1,6 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:37:13.843

我有一个解决方案，看起来有点复杂，但是可以满足您的要求：

```
var results = listOfOccupancy.GroupBy(rr => rr.room)
                             .Select(g => g.GroupBy(rr => rr.occupancy).SelectMany(g2 => g2.Select((rr, i) => new { rr, i })))
                             .SelectMany(g => g.Select(g2 => g2))
                             .OrderBy(e => e.rr.room)
                             .ThenBy(e => e.i)
                             .ThenBy(e => e.rr.occupancy)
                             .Select(e => e.rr)
                             .ToList(); 
```

它能做什么？首先，它按`room`属性值对输入列表进行分组。对于每个组，它再次分组`occupancy`并为每个子组中的元素分配一个索引。之后，所有组都使用`SelectMany`. 在这一点上，我们有一个匿名对象列表，其中`room`,`occupancy`和`index`。正确排序后，您的数据顺序正确。

结果是一个具有以下顺序的列表：

```
AB 1,2
AB 1,4
AB 1,6
AB 1,2
RO 1,2
RO 1,4
RO 1,6
RO 1,2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:33:48.523

看起来您想对列表进行重复数据删除，然后将其加倍。请看下面的代码：

```
var distinctList = listOfOccupancy.Select(l => new { l.room, l.occupancy }).Distinct();
var doubledList = distinctList.Concat(distinctList); 
```****

# c++ - 逐像素填充 cvHistogram 列表

> ID：15410304
> 
> 赞同：0
> 
> 时间：2013-03-14T13:13:53.150
> 
> 标签：c++, c, opencv, image-processing

我有一个图像和一个功能

```
int getRegion(int x,int y) 
```

这给了我一个像素属于哪个组件的唯一标识符。

```
class Component
{
    int Identifier;
    CvHistogram* hist;
} 
```

我想遍历整个图像并使用我的 getRegion() 函数将每个像素的值添加到与其对应的直方图中。有人做过吗？像这样重载 cvCalcHist() 方法是否可行？除了浏览 OpenCV 源代码并复制带有附加条件的方法外，我不确定从哪里开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:32:36.187

也许自己实现这个会更容易？根据您希望如何对直方图进行分类，这可能非常简单。例如 - 如果我猜测并假设您的`getRegion`函数返回一个单字节整数（即 0 到 255 之间），那么生成直方图将相当简单：

```
int histArray[256] = { 0 };

for (x = 0; x < imageWidth; x++)
  for (y = 0; y < imageHeight; y++)
    histArray[getRegion(x,y)]++; 
```

`histArray`然后将包含每个值的计数。如果您需要比这更复杂的东西，您可能应该在问题中提供更多细节。

# algorithm - 如何将数据添加到一堆排序文件

> ID：15410309
> 
> 赞同：1
> 
> 时间：2013-03-14T13:14:03.070
> 
> 标签：algorithm, sorting, external-sorting

如果以前重复过这种情况，我深表歉意，但我找不到任何使用我选择的措辞的帖子。我正在准备面试，并且一直在阅读有关外部排序的信息。例如，如果要对几个 32 位整数的硬盘进行排序，可以进行计数排序，并使用 64 位计数器对 32 位整数进行计数。然后，对于每一个可能的 32 位整数值，您都会有一个计数器来表示它。您还可以对类似的事情使用外部合并排序，花费 O(nlogn) 时间而不是 O(1) 时间。但是，我一直在考虑一个可能很常见的案例，但我想不出最好的方法 - 将新数据添加到可能跨越许多硬盘的一堆排序文件中。

如果内存中有数据，则可以使用堆（优先队列）在登录时间内完成此插入。但是，我们不能从硬盘空间中进行堆。使用列表，您必须使用 O(logn) 搜索来查找数据的位置（对于二进制搜索，已排序），然后将其余数据向后或向前颠簸，或者您可能不必根据实现进行任何移动容器（数组、链表等）。然而，在硬盘世界中，读写比在 RAM 中要昂贵得多，因此在某处插入数据然后转移（重写）其余数据似乎非常昂贵。你们有什么技术可以推荐给我吗？我很乐意阅读自己，我只是找不到正确的方式来表达我的问题以找到任何信息。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:40:08.020

如果您在此处（或其他地方）查找“外部排序”，您会发现有关您所描述内容的讨论。external-sorting 也是这里的一个标签。

> 然而，在硬盘世界中，读写比在 RAM 中要昂贵得多，因此在某处插入数据然后转移（重写）其余数据似乎非常昂贵。

外部排序适用于您*没有*足够内存（或在大多数情况下有足够的“每个进程”）在内部进行排序的情况。数据集太大而无法一次保存在内存中的情况并不少见。因此，您接受 I/O 绑定排序的更高运行时间成本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T13:45:34.097

我会说阅读您的排序数据文件，阅读您想要排序并添加到那里的文件，扣上计数器并用新计算的数据文件覆盖排序的数据文件。在现代磁盘系统上，直接读取比随机读取要便宜得多，而且无论如何您都需要为找到的每个 int 提供一个位置，因此对整个卷的单次顺序读取将比对单个扇区的约 32 次读取耗时更少每个要排序的文件数。

另外，我想说对 32 位整数进行排序最好在结果已经以计数器的形式完成，特别是在像“几个硬盘”这样的超大规模时，你会期望在 32 的几乎每个桶中至少有 1-位空间，因此存储 64 位 *2^32 可能小于 2^33 32 位零，然后是 2^32 零...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T17:45:26.653

如果您在内存中有空间来保存文件，并且您有一组最小元素为 k 的数字，您将不得不重新写入文件中大于 k 的所有数字。没有办法解决这个问题。他们都将不得不改变至少一个位置。

如果您希望利用大多数数组已经排序的事实，并且您在内存中有空间这样做，那么对插入的元素进行排序并将其与大于其最小成员的元素列表合并是一个好的，快速的方法来做到这一点。例如：

磁盘：

1 2 3 4 5 6 8 10 11 12

插入：9 7 13

对插入进行排序：

7 9 13

在磁盘上找到适用的排序列表的子集：8 10 11 12

合并元素（如在 Mergesort 中：）

7 8 9 10 11 12 13

将它们复制回磁盘：

1 2 3 4 5 6 7 8 9 10 11 12 13

另一方面，如果您的内存空间远小于列表的总大小，则可能建议使用其他技术。例如：

1 2 3 4 .. 1000 1002 1003... 999,998, 1,000,000...

作为您在磁盘上的列表和

1001, 999,999

作为你的插入。在这种情况下，您将需要遍历每个元素，计算插入列表中小于该元素的元素数量，然后执行此操作。在这个简单的例子中，简单的计数器非常快——你可以看到 1,000,0000 需要两次跳转。如果插入的数量可能比较大，您可以对插入进行排序，然后对该元素使用二进制搜索来查找较大数组中的每个元素可能位于的位置。这将为您提供有关可以复制多少项目的信息。因此，顶部的相应跳转值为：

0 0 0 0 ... 0 1 1 ... 1 2

希望您能看到一个相当明显的方法，您可能希望通过该方法决定将一个插入元素写入磁盘。

# javascript - 这是否可以在不征得用户许可的情况下从应用程序拨打电话..？

> ID：15410310
> 
> 赞同：1
> 
> 时间：2013-03-14T13:14:04.453
> 
> 标签：javascript, nokia, nokia-s40

我正在开发诺基亚 S40 网络应用程序。我已经实现了“Tel URI”方案，如下所示，从我的应用程序中拨打给定号码。它的作品完美..！

```
<a href="tel:+9196******72">Dial Me</a> 
```

当我单击链接拨打电话时，它会询问我的权限检查点，例如

'创建呼叫 +9196* *** **72" 是/否。

现在我的问题是，我可以在没有此权限检查点的情况下拨打电话吗...？提前致谢！！！

# asp.net - 获取自定义控件父更新面板

> ID：15410311
> 
> 赞同：0
> 
> 时间：2013-03-14T13:14:06.140
> 
> 标签：asp.net, vb.net, updatepanel, servercontrols

我正在创建一个自定义服务控件（扩展复合控件）。我希望这个控件使用更新面板，但我认为最好要求用户将我的控件放在他们自己的更新面板中，而不是我将它编码到我的控件中。我的问题分为两部分：

1.  如何提醒正在使用我的控件的开发人员需要将控件放入更新面板

2.  在我的服务器代码中，如何获取用户控件所在的更新面板 ID 的句柄？

感谢您的任何见解。

编辑：这是我的代码设置方式：

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" >
   <ContentTemplate>   
      <cc3:myServerControl id="activerDirectorySearch1" runat="server"  />
   </ContentTemplate>
</asp:UpdatePanel> 
```

所以，因为我的用户控件不知道 udpate 面板的名称（而且我不想硬编码），所以我想找到一种方法让服务器控件获取其父 ID。但是，如果我使用 parent.id，我只会返回网页名称。

杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:09:55.670

1.  `public property UpdatePanelID`您可以从您的控制中公开。

2.  如果用户不提供，则`UpdatePanelID`抛出异常。

在 ASP.Net ListView 中使用相同的想法`ContentPlaceHolderID`

# android - 按名称搜索android中的联系人？

> ID：15410312
> 
> 赞同：0
> 
> 时间：2013-03-14T13:14:10.433
> 
> 标签：android, search, contacts

我想在android中实现动态搜索。我想查找以用户输入的字母开头的联系人。我正在尝试使用 SearchView 来实现它。我做了一个可搜索的活动，这是里面的代码

```
Intent intent = getIntent();
    if (Intent.ACTION_SEARCH.equals(intent.getAction())) {
      String query = intent.getStringExtra(SearchManager.QUERY);
      Cursor c = getContentResolver().query(Data.CONTENT_URI,
              new String[] {Data._ID, Phone.DISPLAY_NAME},
              Data.DISPLAY_NAME + "=?" + " AND "
                      + Data.MIMETYPE + "='" + Phone.CONTENT_ITEM_TYPE + "'",
              new String[] {query}, null);
      SimpleCursorAdapter sca = new SimpleCursorAdapter(null, 
              0, c, new String[] {Phone.DISPLAY_NAME}, null);
      setListAdapter(sca);
    } 
```

我不知道我哪里错了..我只是没有得到任何结果任何帮助将不胜感激！..谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-19T07:03:16.740

“查询”变量包含什么值？如果它只包含单词的一部分，我认为，你应该使用占位符：

```
query = query + "%" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-26T15:06:35.553

我知道为时已晚，但我希望这对您或其他看到此答案的人有所帮助。 [https://github.com/sachinmuralig/simple-multi-contact-picker](https://github.com/sachinmuralig/simple-multi-contact-picker)

# wordpress - Wordpress dynamic_sidebar 什么也不显示

> ID：15410313
> 
> 赞同：3
> 
> 时间：2013-03-14T13:14:11.360
> 
> 标签：wordpress, dynamic, sidebar

我已经在 wordpress 支持上发布了这个，但是这里的答案要快得多......

这是从那里的“复制粘贴”：

我想在我的 home.php 模板上有额外的小部件区域。我正在使用 Emil Uzelac 的响应式主题。我不知道为什么我的额外“侧边栏”不起作用。

```
dynamic_sidebar('front-side-sidebar'); 
```

该函数返回 true，但它不显示任何内容。我可以在“小部件”中看到我的额外小部件区域，并且我确实在那里添加了一个小部件。在我的functions.php中，我有这个：

```
function front_side_sidebar_init()
{
    register_sidebar(
        array(
            'id' => 'front-side-sidebar',
            'name'=>'Front Side sidebar',
            'description' => __('Front Side sidebar', 'responsive'),
            'before_widget' => '<li>',
            'after_widget' => '</li>',
            'before_title' => '<h3 class="widget-title">',
            'after_title' => '</h3>'
        )
    );
}
add_action( 'widgets_init', 'front_side_sidebar_init' ); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T15:00:25.483

这就是我的做法，我不知道主题是否具有在主题选项中创建新侧边栏的功能，所以这就是我回答的原因。

**在 Functions.php 添加这个**

```
register_sidebar(array(
  'name' => __( 'Front Side sidebar' ),
  'id' => 'front-side-sidebar',
  'description' => __( '' ),
  'before_widget' => '<div class="widget">',
  'after_widget'  => '</div>',
  'before_title' => '<h3>',
  'after_title' => '</h3>'
)); 
```

如果您设置了静态首页，那么 wordpress 将使用 front-page.php。如果你没有这个，它将使用 page.php，我的英语不好，但在这里查看更多。[这里！](http://codex.wordpress.org/Template_Hierarchy)

**在您的模板（front-page.php 或 page.php home.php 您正在使用**的）中 ，将您的侧边栏区域 () 替换为

```
<?php get_sidebar('front-page'); ?> 
```

**此代码将查找文件 sidebar-front-page.php 并在该文件中添加此代码。在模板目录中添加sidebar-front-page.php**

```
<?php if(!function_exists('dynamic_sidebar') || !dynamic_sidebar('front-side-sidebar')) : ?>(you can also put code here if you dont have anything in the this sidebar, it will show this function as standard if you dont have any thing on this sidebar.<?php endif; ?> 
```

长话短说，此代码将检查 id 为“front-side-sidebar”的侧边栏，并显示您在侧边栏中设置的小部件。

是的，这应该工作！:)

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2013-03-14T14:17:46.743

你解决了这里的问题吗？这听起来可能很傻，但请确保代码被您的 PHP 标记包围`<?php ?>`

# jquery - jQuery验证引擎自定义javascript验证

> ID：15410319
> 
> 赞同：6
> 
> 时间：2013-03-14T13:14:50.190
> 
> 标签：jquery, jquery-validation-engine

我正在尝试通过自定义函数使用 jQuery Validate Engine 验证子域的可用性。验证似乎正确发生，但如果 .ajax 请求返回 200，则不会显示 alertText。我添加了`Access-Control-Allow-Origin`标头，并且可以在我的日志中看到请求成功完成。

我究竟做错了什么？

Javascript函数：

```
function validateDomain(field, rules, i, options) {
    var url = "https://" + field.val() + ".example.com/";
    $.ajax(url,
        {
            statusCode: {
                200: function() {
                    //alert('name exists already');
                    return options.allrules.validate2fields.alertText;
                }
            }
        });
} 
```

表单域：

```
 <label class="required" for="signup[subdomain]">Subdomain<span>*</span></label>
    <span>https://</span>
    <input id="signup[subdomain]" name="signup[subdomain]" class="field field validate[required,funcCall[validateDomain]]" type="text">
   <span>.example.com</span> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T21:22:15.693

问题是这`$.ajax`是一个异步函数，不能以这种方式工作。

```
function validateDomain(field, rules, i, options) {
    var url = "https://" + field.val() + ".example.com/";
    $.ajax(url,
        {
            statusCode: {
                200: function() { // [ second function ]
                    return options.allrules.validate2fields.alertText;
                }
            }
        });
} 
```

问题是：您的回报仅适用于`[second function]`不适用`validateDomain`。

查看[jquery-validation-engine](https://github.com/posabsolute/jQuery-Validation-Engine/blob/master/README.md)的文档，我看不到做你想做的事的方法。

# html - 未悬停时的菜单项悬停状态[包含 jsfiddle 链接]

> ID：15410324
> 
> 赞同：0
> 
> 时间：2013-03-14T13:15:03.883
> 
> 标签：html, css, navigation, hover, jsfiddle

我有一个导航，当我将鼠标悬停在主菜单项“市场”上时，会出现一个下拉菜单，将“市场”文本更改为不同的颜色。现在，当我转到其中一个下拉菜单时，菜单项会变回其常规状态。我需要它保持与悬停状态相同，以便可以看到它。

可以在以下位置查看示例：http: [//jsfiddle.net/Gasdj/](http://jsfiddle.net/Gasdj/)

的HTML：

```
<ul id="nav" class="drop">
    <li><a href="#" class="static">About Us</a>
    </li>
    <li><a href="#">News</a>
    </li>
    <li><a href="#">Markets</a>
<ul>
        <li>Charlotte, NC</li>
        <li>Rock Hill, SC</li>
        <li>Panama City, FL</li>
        <li class="nobrd">Atlanta, GA</li>
    </ul>
</li>
</li>
<li><a href="#">Developments</a>
</li>
<li><a href="#">Hedge Funds</a>
</li> 
```

CSS：

```
body {
background: #ccc;
}
#nav {
width: 100%;
float: left;
padding: 0;
list-style: none;
height: 20px;
}
#nav ul {
font-size: 14px;
margin: 0;
padding: 0;
list-style: none;
}
#nav li {
margin-right: 25px;
height: 20px;
display: block;
position: relative;
color: #7a7c41;
}
#nav a {
color: #fff;
text-decoration: none;
}
#nav a:hover {
color: #7a7c41;
}
.static {
cursor: default;
}
 ul#nav {
margin: 0 0 0 0px;
}
ul.drop a {
display:block;
color: #7a7c41;
font-size: 14px;
text-decoration: none;
}
ul.drop, ul.drop li, ul.drop ul {
list-style: none;
margin: 0;
padding: 0;
color: #ecee9c;
}
ul.drop {
position: relative;
z-index: 597;
float: left;
}
ul.drop li {
float: left;
line-height: 1.3em;
vertical-align: middle;
zoom: 1;
padding: 5px 10px;
}
ul.drop li.hover, ul.drop li:hover {
position: relative;
z-index: 599;
cursor: default;
background: #fff;
}
ul.drop ul {
visibility: hidden;
position: absolute;
top: 100%;
left: 0px;
z-index: 598;
width: 195px;
background: #fff;
/*border: 1px solid #000;*/
}
ul.drop ul li {
float: none;
border-bottom:1px solid #7a7c41;
width: 175px;
}
ul.drop ul ul {
top: -2px;
left: 100%;
}
ul.drop li:hover > ul {
visibility: visible;
}
.nobrd {
border: none !important;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:18:42.483

改变：

```
#nav a:hover { ... } 
```

到：

```
#nav li:hover a { ... } 
```

[更新了 JSFiddle](http://jsfiddle.net/Gasdj/1/)。

# extjs - 如何在 ExtJS 4 中覆盖分页工具栏的下一个和上一个按钮

> ID：15410326
> 
> 赞同：2
> 
> 时间：2013-03-14T13:15:04.963
> 
> 标签：extjs, pagination, extjs4

我想覆盖 Extjs 4 中分页工具栏的“下一个”和“上一个”按钮。当我单击“下一个”时，我想使用 Web 服务获取 50 条记录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:24:03.590

您可以使用覆盖功能：

```
Ext.define('Override.toolbar.Paging', {
    override : 'Ext.toolbar.Paging',

    moveNext : function(){
        var me = this,
            total = me.getPageData().pageCount,
            next = me.store.currentPage + 1;

        if (next <= total) {
            if (me.fireEvent('beforechange', me, next) !== false) {
                me.store.nextPage();
            }
        }
    },

    moveLast : function(){
        var me = this,
            last = me.getPageData().pageCount;

        if (me.fireEvent('beforechange', me, last) !== false) {
            me.store.loadPage(last);
        }
    }
}); 
```

另一种方法是您为`beforechange`事件创建一个侦听器并在该函数中返回 false，并在那里实现您自己的逻辑。

# javascript - 使用 jQuery 同时向下滑动 div 和 .fadeIn() 内容，反之亦然？

> ID：15410327
> 
> 赞同：0
> 
> 时间：2013-03-14T13:15:06.417
> 
> 标签：javascript, jquery, jquery-animate, fadein, slidetoggle

我有一个包含内部 div 的外部 div。

我想滑动外部 div，当外部 div 向下滑动时，内部 div 应该淡入淡出。

**我不想在向下滑动的外部 div 中淡出！**

我通过给内部内容一个最小高度并将其淡入来使它与一些工作区一起工作。但是当内部内容具有可变高度时，它会变得混乱..

这个问题有没有好的解决方案？

我创建了一个小提琴来演示我的问题：http: [//jsfiddle.net/6Brxv/](http://jsfiddle.net/6Brxv/)

代码：HTML：

```
<a href="#" onclick="$('#outer1').slideToggle().find('.inner div').fadeToggle();">Toggle (will work)</a>

<div id="outer1" class="outer">
    <div class="inner">
        <div class="item">Hallo1</div>
    </div>
    <div class="inner">
        <div class="item">Hallo2</div>
    </div>
    <div class="inner">
        <div class="item">Hallo3</div>
    </div>
</div> 

<br /><br />

<a href="#" onclick="$('#outer2').slideToggle().find('.inner div').fadeToggle();">Toggle (will not work)</a>

<div id="outer2" class="outer">
    <div class="inner">
        <div class="item">Hallo1! We have more height than 50px! <br />#<br />#<br />#<br />#<br />#<br />#</div>
    </div>
    <div class="inner">
        <div class="item">Hallo2! We have more height than 50px! <br />#<br />#<br />#<br />#<br />#<br />#</div>
    </div>
    <div class="inner">
        <div class="item">Hallo3! We have more height than 50px! <br />#<br />#<br />#<br />#<br />#<br />#</div>
    </div>
</div> 
```

CSS：

```
.outer {
    background-color: red;    
}

.inner {
    min-height: 50px;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:27:48.000

传递`queue: false`参数：

```
$('#element').fadeIn({ duration: 1000, queue: false });
$('#child').slideDown(1000); 
```

这将允许 jQuery 移动到幻灯片上，而无需等待淡入淡出完成。

# asp.net-mvc - Kendo UI MVC Grid，自定义服务器绑定，使用相同绑定列在多个 ClientTemplate 列上指定唯一排序键

> ID：15410329
> 
> 赞同：0
> 
> 时间：2013-03-14T13:15:11.107
> 
> 标签：asp.net-mvc, razor, kendo-ui

我正在使用 Kendo UI MVC Grid、自定义服务器绑定，并且有多个基于相同绑定数据字段的列。数据字段是一个数组，我使用 ClientTemplate 计算/显示来自数组元素的聚合值并显示在网格中。问题是，当您单击要排序的列时，我在每个列的服务器端 ajax 事件中获得了相同的绑定数据名称。我无法判断用户想要排序的特定列。例如

```
public class MyData
{
  public MyArrayData[] Values;
}

.Grid<MyData>()
.EnableCustomBinding(true)
.Columns(columns => 
    columns.Bound(t => t.Values)
       .Title("Col1")
       .ClientTemplate("JS code to aggregate values for col 1")
   columns.Bound(t => t.Values)
       .Title("Col2")
       .ClientTemplate("JS code to aggregate values for col 2") 
```

如果您单击 Col1 或 Col2，我会在 Ajax 事件中获得“值”，我无法判断用户实际上想要按哪一列进行排序。

# java - 如何编写 JUNIT 测试用例进行模拟？

> ID：15410330
> 
> 赞同：-3
> 
> 时间：2013-03-14T13:15:12.867
> 
> 标签：java, junit, mocking

我有类似于以下结构的方法。

```
method1(Object obj,byte[] myarray)
{
    mymanager.dbcall1();
    mymanager2.dbcall2();
} 
```

现在我想编写 JUNIT 测试用例，它实际上可以模拟这些正在执行 dbcalls 的管理器？最后我想比较结果。这些管理器仅在应用程序运行时可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:20:31.080

你想测试`method1()`吗？如果是这样，我假设您`mymanager`在封闭类中有一个 setter，这将使您能够（使用 Mockito）：

```
@Before
public void setUp()
{
    MyClass my = new MyClass();
    MyManager mgr = mock( MyManager.class );
    my.setManager( mgr );

    // Similar for mymanager2
} 
```

然后所有的方法调用`mgr`都将返回 null。如果您需要其他返回值，`doReturn(...).when( mgr ).dbcall1()`可以使用该构造。

干杯，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:21:55.003

给你，我搜索了堆栈溢出，发现了很多以前有人问过的东西：

[使用 JUnit 测试 EJB](https://stackoverflow.com/questions/6469751/testing-an-ejb-with-junit)

它基于 EJB，但我们不知道您现在使用的是什么，但这可能有一些共同的原则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:24:37.673

首先，您需要一些依赖注入。有很多方法可以做到这一点，但这里有一个简单的方法：

```
private I_DatabaseManager mymanager = null;

method1(Object obj,byte[] myarray)
{
    getDatabaseManager().dbcall1();
    getDatabaseManager().dbcall2();
}

private I_DatabaseManager getDatabaseManager() {
    if (mymanager == null) {
          return getProductionImplementationOfDatabaseManager();
    }
    return mymanager;
}

protected void setDatabaseManagerImplementation(I_DatabaseManager newImplementation) {
    mymanager = newImplementation;
} 
```

然后，在您的测试代码中，您可以创建一个实现 I_DatabaseManager 接口的模拟类，并在您的测试中设置这个模拟实现。

# javascript - 2 hubspot javascript 片段之间的澄清

> ID：15410332
> 
> 赞同：2
> 
> 时间：2013-03-14T13:15:18.953
> 
> 标签：javascript, salesforce, web-analytics

有一个hubspot问题。我公司目前维护的网站之一具有以下代码

```
<script type="text/javascript" language="javascript">
var hs_portalid=123456;
var hs_salog_version = "2.00";
var hs_ppa = "some-account-name.app12.hubspot.com";
document.write(unescape("%3Cscript src='" + document.location.protocol + "//" + hs_ppa + "/salog.js.aspx' type='text/javascript'%3E%3C/script%3E"));
</script> 
```

我们被要求添加另一个片段（如下），该片段声称是 hubspot 分析代码

```
<script type="text/javascript">
    (function(d,s,i,r) {
        if (d.getElementById(i)){return;}
        var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
        n.id=i;n.src='//js.hubspot.com/analytics/'+(Math.ceil(new Date()/r)*r)+'/123456.js';
        e.parentNode.insertBefore(n, e);
    })(document,"script","hs-analytics",300000);
</script> 
```

这两个版本（旧的和新的）是相同的代码还是不同的。一些带有解释的链接会有所帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T19:33:53.263

我已经联系了 Hubspot 的 CS。事实证明，这两个片段都有相同的用途，并且后者是新的改进版本，它也是异步的，与旧版本不同。

不幸的是无法提供任何链接，我所有的搜索都是空的，这正是我首先提出这个问题的原因。

# ruby-on-rails - CanCan 执行不需要的 count(*) sql 查询

> ID：15410334
> 
> 赞同：1
> 
> 时间：2013-03-14T13:15:26.987
> 
> 标签：ruby-on-rails, ruby, cancan

能力.rb：

```
can :index, Product, Product.owned_by(user) do |obj|
  obj.owned_by?(user)
end 
```

当我调用 can?(:index, Product) CanCan 发送

```
SELECT COUNT(*) FROM `products` WHERE ... 
```

在导航栏中，我有很多项目，每个项目都有 can?(:index,...)，这会减慢我的页面速度。

ability.rb 有问题吗？

# sql - 如何从同一个表中的每个组 id 中选择前 n 行

> ID：15410336
> 
> 赞同：1
> 
> 时间：2013-03-14T13:15:31.460
> 
> 标签：sql, sql-server-2008

我也想从我的表中为我的表的每个组 id 选择前 5 行

```
CREATE TABLE [dbo].[news](
    [pk_news] [int] IDENTITY(1,1) NOT NULL,
    [text] [text] NULL,
    [title] [nvarchar](500) NULL,
    [pk_service] [int] NULL,
    [image] [nvarchar](500) NULL,
    [pk_annalist] [int] NULL,
    [pk_user] [int] NULL,
    [pk_admin] [int] NULL,
    [accept] [int] NULL,
    [views] [int] NULL,
    [tag] [nvarchar](500) NULL,
    [news_Date] [date] NULL,
    [summary] [nvarchar](500) NULL, 
```

我也想从每个 pk_service 中选择行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:31:42.177

```
select 
    x.*
    ,n.*
from dbo.news n
join (
    select 
        pk_news
        ,[rwn] = row_number() over(partition by pk_service order by pk_news asc)
    from dbo.news
) x
on n.pk_news=x.pk_news and x.rwn < 6
order by 
    n.pk_service, x.rwn 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T13:28:24.117

首先，您必须指定进入“前 5 名”意味着什么 这是按观看次数？，最新的 news_date？，什么？假设它是按视图数计算的，那么：

首先，您需要一个表达式来计算每一行的同一 pk_select 中有多少条记录的视图值大于当前记录值。

假设 n 是当前行的别名，那将是

```
 Select Count(*) From news 
    Where pk_select = n.pk_Select
        And views >= n.views 
```

然后将其作为子选择嵌入到外部查询的 Where 子句中

```
 Select * From news n
 Where (Select Count(*) From news 
        Where pk_select = n.pk_Select
           And views >= n.views) < 5 
```

仅当视图的值不包括每个 pk_Select 组中的重复项时，才会生成绝对正确的答案。如果有重复，则需要使用[row_number](http://msdn.microsoft.com/en-us/library/ms186734.aspx)函数

```
 With Rows As
   (
          Select *, 
          Row_Number() Over (Order By Views) as rowNum
          From news
   )
   Select * From Rows
   Where RowNum <= 5 
```

# android - Android 寻呼机视图不可见

> ID：15410337
> 
> 赞同：0
> 
> 时间：2013-03-14T13:15:34.640
> 
> 标签：android, android-layout, android-fragments, android-viewpager

我正在为 ViewPager 使用 android 支持库（应用程序将支持 2.2 及更高版本）。寻呼机视图有片段，我的片段包含列表，该列表上的文本不可见，但图像可见。在我使用带有列表的活动的内部屏幕上，文本是可见的，所以我认为问题只出在片段上。这仅在 2.2 和 2.3 中发生，3.0 以上的设备正确显示文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T11:58:26.600

我已经通过在 android 2.3.3 而不是 4.1 上构建应用程序解决了这个问题。文本问题得到了解决，尽管 Spinner dropDown 模式等一些功能现在不可用。

# vba - Excel 宏用其他列的条件填充列

> ID：15410338
> 
> 赞同：0
> 
> 时间：2013-03-14T13:15:35.477
> 
> 标签：vba, excel

我是VBA的初学者。我有一个 Excel 跟踪器，如下所示：

```
S.NO    REGION  ASSOCIATE   DATE RECEIVED   SLA TIME BUY    DELIVERED DATE  STATUS
1   ME           7-Mar-13                 ED    10-Mar-13             
2   ME           7-Mar-13                    10-Mar-13    
3   AFRICA           7-Mar-13                    9-Mar-13   
4   AFRICA           7-Mar-13                 AE    12-Mar-13   
5   ASIA             8-Mar-13                    11-Mar-13  
6   ASIA             9-Mar-13                 QR    15-Mar-13   
7   AFRICA           10-Mar-13                   14-Mar-13
8   ASIA             10-Mar-13                   16-Mar-13  
9   ME           10-Mar-13                   14-Mar-13  
10  ASIA             10-Mar-13                DH    17-Mar-13 
```

我必须根据 Region Column Date Received 和 Time buy 列的值填充 SLZ 列中的日期。条件如下。

**条件**：

1.  如果该地区是 ME，则在 7 日收到票，并且必须在 3 月 9 日交付，但是由于 ED 在 FI 列中标记，因此可以多一天完成我的工作，现在如果我在 10 日交付，我的状态消息应该显示 WSLA。
2.  如果在 7 日收到票并且必须在 9 日交付，并且 F 列中没有数据，因此如果交付日期在 3 月 9 日之后，我应该得到一个 msg O SLA。
3.  如果该地区是非洲，则在 7 日收到票，并且必须在 9 日交付，并且 f 列中没有标记数据；由于 SLA 和交付匹配，因此评论必须是 W SLA。如果这个案例是在 7 日收到的，应该在 9 日收到，但是正如专栏所说的 AE 多一天仍然被视为 SLA；但交付日期仍然是 3 月 12 日，这比我的 H 栏延迟两天必须说 OSLA
4.  这是一个亚洲 I 案例；我有 4 天的时间来交付这个；但是我已经交付了一天 b4 我的 solumn H 必须说 W SLA

最后我的报告应该是这样的。

```
S.NO    REGION  ASSOCIATE   DATE RECEIVED   SLA TIME BUY    DELIVERED DATE  STATUS
1   ME      7-Mar-13    9-Mar-13              ED    10-Mar-13   W SLA
2   ME      7-Mar-13    9-Mar-13                 10-Mar-13           O SLA
3   AFRICA      7-Mar-13    9-Mar-13                 9-Mar-13            W SLA
4   AFRICA      7-Mar-13    10-Mar-13             AE    12-Mar-13            O SLA
5   ASIA        8-Mar-13    11-Mar-13                11-Mar-13           W SLA
6   ASIA        9-Mar-13    14-Mar-13             QR    15-Mar-13       O SLA
7   AFRICA      10-Mar-13   14-Mar-13                14-Mar-13           W SLA
8   ASIA        10-Mar-13   16-Mar-13                16-Mar-13           W SLA
9   ME      10-Mar-13   14-Mar-13                14-Mar-13           W SLA
10  ASIA        10-Mar-13   17-Mar-13             DH    17-Mar-13   W SLA 
```

有人可以帮我做一个宏吗？如果我得到一个用于至少一个条件检查的宏，我想我可以为其他条件重新创建它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:03:17.170

所以你想要一些类似的东西：

```
dim iCol as integer
dim iRow as integer
dim iRegionCol as integer, iTktReceivedDate as integer
'
'
iRegionCol=2 ' column 2 = column B?
iTktReceivedDate=4 ' column 4 = column D?
'
for iRow=2 to range("A1").end(xldown).row
    select case cells(irow,iregioncol).text
        case "ME"
        ' do something like IF cells(irow, iTktReceivedDate) = today() then...
        case "Africa"
        ' do Africa something
        case "Asia"
        ' do something for Asia
    end select
next 
```

我希望这能让你开始

菲利普

# vba - Excel VBA AddConnector 方法位置在 Excel 2010 中搞砸了

> ID：15410340
> 
> 赞同：0
> 
> 时间：2013-03-14T13:15:38.570
> 
> 标签：vba, excel

在 Access VBA 应用程序中，我维护了一些动态生成 Excel 文件的 VBA 代码。最近，用户群迁移到 Excel 2010。

从那时起，在 Excel 中创建箭头的以下代码段搞砸了之前在 Excel 2003 上运行良好的位置：

```
Set ShapeObject = myWorksheet.Shapes.AddConnector(msoConnectorCurve, X1, Y1, DeltaX, DeltaY) 
```

X1 和 Y1 是我的箭头起点的顶部和左侧坐标。

DeltaX 和 DeltaY 是我的箭头末端的水平和垂直距离，指的是它的起点。

我的箭头的结果开始是正确的，但它的结束只在具有 Excel 2003 的机器上是正确的。在具有更高版本的 Excel (>= 2007) 的机器上，我的箭头的末端是文档的上端。

这里有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T11:31:22.937

经过漫长的反复试验和一些论坛研究，我突然想到了解决方案：

微软为 Excel 2003 中的 addConnector 方法提供的文档[http://msdn.microsoft.com/en-us/library/office/aa221699(v=office.11 ​​).aspx 是错误的！](http://msdn.microsoft.com/en-us/library/office/aa221699(v=office.11).aspx)基本上，第 3 和第 4 个参数没有正确记录。尽管它们被命名为 EndX 和 EndY，但它们代表宽度和高度。在 Excel 2003 中最初使用此方法时，我以某种方式假设了这一点。

现在是有趣的部分。在 Excel 2007 中，Microsoft 更改了 addConnector 方法，现在它完全符合文档。

这意味着我的代码：

```
Set ShapeObject = myWorksheet.Shapes.AddConnector(msoConnectorCurve, X1, Y1, DeltaX, DeltaY) 
```

在 Excel 2003 中工作，但在 Excel 2007 及更高版本中，它必须调整为：

```
Set ShapeObject = myWorksheet.Shapes.AddConnector(msoConnectorCurve, X1, Y1, X1 + DeltaX, Y1 + DeltaY) 
```

# php - 文本框的可见性取决于组合框的值

> ID：15410341
> 
> 赞同：1
> 
> 时间：2013-03-14T13:15:38.760
> 
> 标签：php, javascript, html, combobox

我想根据组合框的选定值的值设置文本框的可见性。这是我的代码：

```
<table width="500" align="center">
  <tr>
    <td><span> Name:</span></td>
    <td><input name="name"  type="text" id="name" size="40" class=""/></td>
  </tr>
  <tr>
    <td><span>Email ID:</span></td>
    <td><input name="email"  type="email" id="email" size="40" class=""/></td>
  </tr>
  <tr>
    <td><span>Select:</span></td>
    <td>
      <select id="edition">
        <option value="none" selected>----Select ----</option>
        <option id="1">A</option>
        <option id="2">B</option>
      </select>
    </td>
  </tr>
  <tr>
    <td><span>Number of Licenses</span></td>
    <td><input type="text" id="licenseNo" size="5" value="30" /></td>
  </tr>
</table> 
```

`licenseNo`如果组合框的值为 B，我希望文本框可见。我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:19:43.413

使用 JS 添加事件监听器：

```
<script type="text/javascript">
function func() {
    var elem = document.getElementById("edition");
    if(elem.options[elem.selectedIndex].innerHTML == "B") {
        document.getElementById("licenseNo").style.display = "";
    } else {
        document.getElementById("licenseNo").style.display = "none";
    }
}
</script>

<select id="edition" onchange="javascript:func();">
    ...
</select> 
```

`func()`当您的页面刚刚加载时，也不要忘记在开始时调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:36:42.280

您也可以像下面这样使用它。只需使用 value 来获取选定的文本

```
<table width="500" align="center" >
  <tr>
    <td><span> Name:</span></td>
    <td><input name="name"  type="text" id="name" size="40" class=""/></td>
  </tr>
  <tr>
    <td><span>Email ID:</span></td>
    <td><input name="email"  type="email" id="email" size="40" class=""/></td>
  </tr>
  <tr>
    <td><span>Select:</span></td>
    <td>
     <select id="edition" onchange="func()">
      <option value="none" selected >----Select ----</option>
      <option id="1">A</option>
      <option id="2">B</option>
     </select>
    </td>
  </tr>
  <tr id ="trhide">
    <td><span>Number of Licenses</span></td>
    <td><input type="text" id="licenseNo" size="5" value="30" /></td>
  </tr>
</table>

<script type="text/javascript">
 function func() {
   var elem = document.getElementById("edition");

   if(elem.value == "B") {
      document.getElementById("trhide").style.visibility = "visible"; 
   } else {
     document.getElementById("trhide").style.visibility = "hidden"; 
   }
 }
</script> 
```

[在这里](http://jsfiddle.net/CsCna/29/)看小提琴

# sql-server-2008 - SQL Server 2012 还原不包括文件流

> ID：15410343
> 
> 赞同：1
> 
> 时间：2013-03-14T13:15:48.887
> 
> 标签：sql-server-2008, backup, sql-server-2012

我有一个具有文件流的 SQL Server 2008 数据库。

我需要备份此数据库（不包括文件流）并在 SQL Server 2012 上恢复数据库。

我对此进行了研究并发现：

[http://social.msdn.microsoft.com/Forums/en-US/sqldisasterrecovery/thread/bcd5dddf-5a66-42a9-acf4-a63136f3658a](http://social.msdn.microsoft.com/Forums/en-US/sqldisasterrecovery/thread/bcd5dddf-5a66-42a9-acf4-a63136f3658a)

当我按照 URL 的说明在没有文件流的情况下备份数据库并恢复到 SQL Server 2008 时，这很有效。

但是，当我运行脚本以恢复到 2012 年时，出现以下错误：

```
Msg 3634, Level 16, State 1, Line 3
The operating system returned the error '3(The system cannot find the path specified.)' while attempting 'FindFirstFile' on X

Msg 5520, Level 16, State 1, Line 3
Upgrade of FILESTREAM container ID 65537 in the database ID 10 failed because of container size recalculation error. Examine the previous errorlog entries for errors, and take the appropriate corrective actions.

Msg 5056, Level 16, State 6, Line 3
Cannot add, remove, or modify a file in filegroup 'FileStreamFileGroup' because the filegroup is not online.
Msg 3013, Level 16, State 1, Line 3
RESTORE DATABASE is terminating abnormally. 
```

我认为这与 SQL 将数据库从 2008 年升级到 2012 年有关。

有任何想法吗？任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T16:52:17.077

我有同样的问题，我已经通过使用 Smo 库重写备份和还原方法来解决。

示例：
[备份示例](http://manish4dotnet.blogspot.in/2013/03/DatabaseBackupusingCSharp.html)
[还原示例](http://manish4dotnet.blogspot.in/2013/03/RestoreDataBaseusingCSharp.html)

顺便说一句，如果部分备份或恢复，我会执行以下操作。

```
 if (partial)
  {
    sqlRestore.Partial = true;
    sqlRestore.ContinueAfterError = true;
  } 
```

我希望这能帮到您。

~巴萨姆

# actionscript-3 - Starling 滤镜：反转 alpha

> ID：15410348
> 
> 赞同：0
> 
> 时间：2013-03-14T13:15:57.330
> 
> 标签：actionscript-3, shader, fragment-shader, stage3d, starling-framework

我尝试为 Starling 制作一个着色器，它将反转 Starling sprite 的 alpha（一种蒙版）：

```
var fragmentProgramCode:String =
// Get texture
"tex ft1, v0, fs0 <2d,linear,nomip>" + "\n" +
// make 1 - pixel alpha
"sub ft1.w, fc0, ft1.w" + "\n" +
// Send result
"mov oc, ft1" 
```

此代码适用于 fc0 = 1，但我真的不明白为什么，因为当我使用 fc0 并将其放入 0.5 时，没有区别。我哪里错了？如何正确执行 1 像素 alpha ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T13:03:27.290

正确的代码是：`"sub ft1.w, fc0.x, ft1.w" + "\n" +`

我必须使用 fc0.x，因为 alpha 量通过第一个条目传递给片段着色器（fc0 有 4 个分量，xyz 和 w）。

您将在此处找到最终过滤器：[https ://gist.github.com/simsoft/5169715](https://gist.github.com/simsoft/5169715)

![阿尔法逆变器滤波器](../Images/fdefdd6ebd0f5b6e786e26a0682a1914.png)

# c# - 值不在 Microsoft.DirectX.DirectSound 中的预期范围内；

> ID：15410350
> 
> 赞同：0
> 
> 时间：2013-03-14T13:15:57.557
> 
> 标签：c#, directx, directsound

我正在使用托管代码开发音乐播放器，并且正在使用 Microsoft.DirectX.DirectSound。当我调用 play 方法时，我收到此错误“值不在预期范围内”。因此，问题仅适用于 24 位 WAV 文件。这就是例外的原因。对于 16 位文件工作正常。任何想法如何使它也适用于 24 位文件？

谢谢！

```
 using Microsoft.DirectX.DirectSound;
    using DS = Microsoft.DirectX.DirectSound;
    .......
    private DS.Device sounddevice;
    private DevicesCollection AuioDevList;
    //Create buffer
    private SecondaryBuffer secondaryBuffer;
    private BufferDescription d = new BufferDescription();

    private void initializeSound()
    {
        // List all Audio Cards
        AuioDevList = new DevicesCollection();
        // Populate cmbAudioCards
        cmbAudioCards.Items.Clear();
        for (int i = 0; i < AuioDevList.Count; i++)
        {
            cmbAudioCards.Items.Add(AuioDevList[i].Description);
        }
        cmbAudioCards.SelectedIndex = 0;
        sounddevice = new DS.Device(AuioDevList[0].DriverGuid);
        sounddevice.SetCooperativeLevel(this.Handle, CooperativeLevel.Normal);

        // Set descriptor’s flags
        d.ControlPan = true;
        d.ControlVolume = true;
        d.ControlFrequency = true;
        d.ControlEffects = true;
    }

    private void prepareSound(string file)
    {

            playing = false;
        //secondaryBuffer.Stop();            
        secondaryBuffer = new SecondaryBuffer(file, d, sounddevice);
        secondaryBuffer.Volume = trkVolume.Value;
    }

    private void btnPlay_Click(object sender, EventArgs e)
    {    
         //Here is throwing exception 
        secondaryBuffer.Play(0, BufferPlayFlags.Default);//
    } 
```

# java - Hibernate 和 SQL 连接类型

> ID：15410356
> 
> 赞同：3
> 
> 时间：2013-03-14T13:16:07.377
> 
> 标签：java, hibernate, jpa

我有一个简单的 JPA 实体（休眠实现），具有急切获取的关系：

**用户.java：**

```
@Entity
@Table(name = "USER")
public class User {

    @OneToOne(optional=false)
    @JoinColumn(name = "USER_STATUS_ID", nullable = false)  
    private UserStatus userStatus; 
```

**用户状态：**

```
@Entity
@Table(name = "USER_STATUS")
public class UserStatus {

    @Column(name = "name", nullable = false)
    private String name; 
```

为查找实体而生成的查询如下所示：

```
...from user left outer join user_status on... 
```

我的问题是：为什么 Hibernate 执行这个外连接而不是内连接（因为我已经告诉它它不是可空的或可选的）。有没有办法强制内部连接？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T12:28:29.470

如果我是对的，Hibernate 总是使用左外连接，你不能强制休眠进行内连接。当您检索父实体时，并非所有父实体都必须拥有子实体。因此，如果使用内部连接，您可能最终没有结果。

# c# - 如何在 C# 中将字符串转换为 OracleClob 对象？

> ID：15410360
> 
> 赞同：0
> 
> 时间：2013-03-14T13:16:31.240
> 
> 标签：c#, oracle

嗨，我有一个字段具有 OracleClob 类型。我想将其转换为我的字符串数据。我该如何在 c# 中做到这一点？

```
 [MapField("MSG_BODY")]
 public Oracle.DataAccess.Types.OracleClob MsgBody { get; set; } 
```

我想设置 MsgBody ：“这是一个示例”；

我必须定义一个 oracleclob 对象并将其填充为字符串文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:22:15.553

根据[Oracle 文档](http://docs.oracle.com/cd/B19306_01/win.102/b14307/OracleClobClass.htm)，您需要使用缓冲数组编写它，因此如下所示：

```
char[] writeBuffer = "This is a sample".ToCharArray();
this.MsgBody.Write(writerBuffer, 0, writeBuffer.Length);
this.MsgBody.Close();
this.MsgBody.Dispose(); 
```

请记住，我假设您已经`OracleClob`使用 open创建了`OracleConnection`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T13:23:01.493

我从未接触过 Oracle，但根据[文档](http://docs.oracle.com/cd/B19306_01/win.102/b14307/OracleClobClass.htm)，您可以像处理字节流一样处理它。

添加一个[StreamWriter](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.aspx)你应该可以做到

```
var sw = new StreamWriter(MsgBody, Encoding.UTF8); // Assuming you want UTF-8
sw.Write("This is a sample");
sw.Flush(); 
```

# eclipse - 为什么 Eclipse 将目标文件夹中的（一个）jar 保持打开状态？

> ID：15410361
> 
> 赞同：0
> 
> 时间：2013-03-14T13:16:39.240
> 
> 标签：eclipse, maven, jar

我正在开发一个项目并尝试运行（在 Eclipse 之外，在 cygwin 中（因此是 Windows 环境））：

```
mvn clean 
```

失败的原因是：

`org.apache.maven.plugins:maven-clean-plugin:2.4:clean (default-clean) on project *****: Failed to clean project: Failed to delete path_to_project\target\org.apache- commons-httpclient-3.1.jar ->`[帮助1]

我知道是日食让罐子保持打开状态。当我在运行 maven 命令之前在 Eclipse 中清理我的项目时，不会发生错误（显然 Eclipse 会清理目标文件夹）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:38:21.297

例如，当您在 Eclipse 之外的 Windows 上运行 Maven 并且 Eclipse 被配置为自动刷新工作区时，就会发生这种情况。

发生的情况是 Maven 开始更改工作区中的文件，Eclipse 通知并试图查看发生了什么。如果两者不小心碰巧尝试访问同一个文件，则其中一个会丢失。通常，它是 Maven（因为 Eclipse 只是记录一个错误并继续）。

如果您有 Eclipse 3.7，您可以在 Maven 运行时禁用自动刷新，或者切换到“访问时刷新”。

# wix - 刻录（WiX 引导程序）不卸载 MSI 包

> ID：15410364
> 
> 赞同：5
> 
> 时间：2013-03-14T13:16:51.703
> 
> 标签：wix, burn

我有一个带有这条链的 Burn 包：

```
<Chain>
  <PackageGroupRef Id="NetFx40Web"/>
  <MsiPackage SourceFile="c:\\My\\Path\\MyMsi.msi"
        Id="MyMsi" DisplayName="MyMsi" DisplayInternalUI="yes" Vital="yes">
    <MsiProperty Name="INSTALLLOCATION" Value="[InstallFolder]" />
  </MsiPackage>
</Chain> 
```

.NET框架和我的 MSI 文件[都已](http://en.wikipedia.org/wiki/.NET_Framework)正确安装。但是在卸载过程中（无论是在单击引导程序 EXE 还是从程序和功能中）都不会卸载 MSI 包。有什么方法可以强制卸载 MSI 包吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-14T14:38:10.353

Burn 将创建一个日志文件，其中包含有关`%TEMP%`. 查看名为“计划”的部分，您将看到 Bundle 中每个包的行。日志文件中的其他消息将指出 MSI 是否仍被另一个 Bundle 引用计数，或者机器上的 MSI 是否比 Bundle 携带的更新（因此它不会卸载它）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-09T10:13:11.217

我在删除捆绑包时遇到了相同的 MSI 未卸载问题，原因很简单。

MSI 是在同一个 Visual Studio 解决方案中创建的，它被设置为捆绑项目的依赖项。每次创建捆绑包时，首先创建 MSI。

未发生卸载的根本原因是 MSI 的产品密钥设置为“*”，因此每次创建时都会更改。这以某种方式阻止了删除。当设置为固定 GUID 时，卸载成功。

**编辑**：事实证明，我做了一些特别的事情。我创建了一个德语和一个英语版本（两次称为 light.exe）并（使用一些外部脚本）将它们合并到一个 MSI 中。因此，德语版本的产品 ID 与英语版本不同。卸载在德语或英语 Windows 中都能正常工作，具体取决于首先调用哪个 light.exe。

# cocos2d-iphone - 使用 CCScaleTo 或 CCScaleBy 时移动 CCSprite

> ID：15410367
> 
> 赞同：0
> 
> 时间：2013-03-14T13:17:02.823
> 
> 标签：cocos2d-iphone, anchor, box2d, scale, ccsprite

我几乎已经阅读了有关锚点和缩放的所有内容。当我缩放它时，我仍然不知道精灵位置发生了什么。

场景是这样的：

当我点击屏幕时，精灵的宽度将减少大约 %50，高度将增加大约相同的比例。然后它将恢复到正常规模。

```
id scaleUpAction =  [CCEaseInOut actionWithAction:[CCScaleTo actionWithDuration:.35 scaleX:0.5 scaleY:1.5] rate:1.0];
id scaleDownAction = [CCEaseInOut actionWithAction:[CCScaleTo actionWithDuration:.35 scaleX:1.0 scaleY:1.0] rate:1.0];
CCSequence *scaleSeq = [CCSequence actions:scaleUpAction, scaleDownAction, nil];
[self.boxShape runAction:scaleSeq]; 
```

我不明白为什么缩放会使精灵“移动”。

如果我在屏幕上的位置 (100, 100) 有一个大小为 40x60 的精灵，当我缩小它时，它会向左移动。为什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:35:19.330

一般来说，当缩放空间时，总是有一个点留在它的位置上，其他点移动。对于 CCNode，此点是锚点。因此，选择节点上要保留的点并将其设为锚点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T12:05:54.280

可能图像的锚点不在图形的质心。在下一张图片中，您应该将锚点设置为红点，ccp (0.85, 0.5) 大约！

[图片：锚点，月亮，质心](http://i.stack.imgur.com/UO3SJ.png)

如果您的锚点位于中心 (0.5, 0.5)，当上一个图形水平缩放时，它将向左移动（仅在视觉上！）。

这是你的问题吗？

# grails - 从 Grails 2.0.3 升级到 2.2.1：服务器访问错误：连接被拒绝

> ID：15410368
> 
> 赞同：2
> 
> 时间：2013-03-14T13:17:05.140
> 
> 标签：grails, grails-plugin, spock, geb

作为我的 Happy Trails 应用程序的一部分，我正在尝试从 Grails 2.0.3 升级到 2.2.1。

[https://github.com/jamesward/happytrails/tree/grails2](https://github.com/jamesward/happytrails/tree/grails2)

我遇到的第一件事就是让 Geb/Spock 与 Groovy 2 一起工作。在尝试安装插件或执行任何操作时，我遇到了以下错误。

```
| Resolving plugin JAR dependencies
| Error WARNING: Dependencies cannot be resolved for plugin [mail] due to error: startup failed:
Could not instantiate global transform class org.spockframework.compiler.SpockTransform specified at jar:file:/Users/mraible/.grails/ivy-cache/org.spockframework/spock-core/jars/spock-core-0.7-groovy-1.8.jar!/META-INF/services/org.codehaus.groovy.transform.ASTTransformation  because of exception org.spockframework.util.IncompatibleGroovyVersionException: The Spock compiler plugin cannot execute because Spock 0.7.0-groovy-1.8 is not compatible with Groovy 2.0.7\. For more information, see http://versioninfo.spockframework.org 
```

我能够使用[Grails 2.2 的 spock 指令](http://grails.org/plugin/spock)来解决这个问题。

但是，现在我遇到了一个奇怪的错误，Grails 似乎正在尝试从本地存储库下载文章。

```
$ grails compile
| Configuring classpath
:: problems summary ::
:::: ERRORS
    Server access Error: Connection refused url=http://localhost:8081/artifactory/plugins-releases-local/org/codehaus/geb/geb-spock/0.9.0-RC-1/geb-spock-0.9.0-RC-1.pom
    Server access Error: Connection refused url=http://localhost:8081/artifactory/plugins-releases-local/org/codehaus/geb/geb-spock/0.9.0-RC-1/geb-spock-0.9.0-RC-1.jar
| Error Failed to resolve dependencies (Set log level to 'warn' in BuildConfig.groovy for more information):

- org.codehaus.geb:geb-spock:0.9.0-RC-1 
```

到目前为止，这是我的项目的差异：

[https://gist.github.com/mraible/5161209](https://gist.github.com/mraible/5161209)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:28:30.683

现在我已经查看了该项目的源代码，我将提供另一个建议：删除所有插件条目`application.properties`并添加您需要的`BuildConfig.groovy`。

我认为这里的大问题是`application.properties`0.9.0-RC-1 在`BuildConfig.groovy`. 您不需要`svn`插件条目，因此不要将其添加到`BuildConfig.groovy`. 您必须将 Searchable 插件升级到 0.6.4。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T14:03:18.070

我不能为了爱和金钱而复制，但我会冒险猜测你在常春藤缓存中有过时的依赖信息。尝试移动`~/.grails/ivy-cache`到`/var/tmp`并运行`grails compile`. 如果可行，您可以保持原样，或恢复旧缓存并删除与 geb 相关的目录：

*   ~/.grails/ivy-cache/org.codehaus.geb
*   ~/.grails/ivy-cache/org.gebish
*   ~/.grails/ivy-cache/org.grails.plugins/geb

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T14:56:06.813

尝试删除（重命名）~/.grails/2.2.1

# count - 返回在 JAX-RS 资源中分页时找到的总行数

> ID：15410372
> 
> 赞同：1
> 
> 时间：2013-03-14T13:17:11.617
> 
> 标签：count, jax-rs, response, paging

我正在创建一个 Jax-RS 资源。我想返回响应中的记录总数。我正在使用命名查询和标题函数来添加特定的“计数”变量，如下所示：

```
@GET
@Produces(MediaType.APPLICATION_JSON)
public Response findAll(
        @QueryParam("offset") int offset,
        @QueryParam("limit") int limit) {

    EntityManager em = factory.createEntityManager();
    Query query;
    try {

        query = em.createNamedQuery("User.getCount");
        String count = ((Long) query.getSingleResult()).toString();

        query = em.createNamedQuery("User.findAll");

        List<T> list = query.setFirstResult(safeOffset(offset))
                            .setMaxResults(safeLimit(limit))
                            .getResultList();

        return Response.ok(new GenericEntity<List<User>>(list) {})
                       .header("Count", count)
                       .build();

    } catch (Exception e) {
        return Response.serverError().build();
    } finally {
        em.close();
    }
} 
```

我想知道是否有更好的方法来计算和返回找到的记录总数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-09T12:00:48.957

你可以看看这个链接！它处理 ListResource 以构造返回的 JSON 数据：http: [//www.twilio.com/docs/api/rest/response#response-formats-list](http://www.twilio.com/docs/api/rest/response#response-formats-list)

[http://twilio.github.io/twilio-java/com/twilio/sdk/resource/ListResource.html](http://twilio.github.io/twilio-java/com/twilio/sdk/resource/ListResource.html)

# ruby - “文本”的未定义方法“gsup”：字符串（nomethoderror）

> ID：15410379
> 
> 赞同：-3
> 
> 时间：2013-03-14T13:17:39.653
> 
> 标签：ruby

我是 Ruby 编程的新手，对它了解不多。我在练习中遇到了这个问题，我尝试从中删除一些标记（“！”）并将一些字母替换为另一个（“la”->“ca”）。像这样的东西：

```
text = "Lava lamp!!"
text = text.chomp.delete("!")
text = text.gsup("la","ca")
puts text 
```

它只给我这个错误：“program.rb:6:in `<main>': undefined method`gsup' for "lava lamp":string (nomethoderror)”

你能帮我么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T13:18:58.427

你要找的[`gsub`](http://apidock.com/ruby/String/gsub)不是`gsup`

`text = text.gsu**b**("la","ca")`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T14:35:15.250

user2169701，您需要使用 gsu* *b* * 代替 gsu* *p* *

```
text = text.gsub("la","ca") 
```

# php - php在javascript中生成图像

> ID：15410381
> 
> 赞同：0
> 
> 时间：2013-03-14T13:17:42.533
> 
> 标签：php, javascript, gdlib

我有一张用 GDLib 生成的图片。在这张图片中，gdlib 根据数据库数据在各个位置添加了一些 gif 点。

现在我想用javascript以某种方式识别这些点，并为这些点制作一个简单的淡入/淡出功能。

然而，由于它是使用 gdlib 完成的，我假设图像被解释为只是 1 个图像，因此我无法用 JS 识别这些点。

所以我的问题是我应该使用哪种技术？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:20:11.513

拍摄一个点的照片并使用绝对定位将其放在图像上。

# javascript - 带参数的 Javascript setinterval 函数

> ID：15410384
> 
> 赞同：17
> 
> 时间：2013-03-14T13:17:55.877
> 
> 标签：javascript

如何在 setInterval 函数中传递参数 例如：

```
 intId = setInterval(waiting(argument), 10000); 
```

它显示错误`: useless setInterval call (missing quotes around argument?)`

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-03-14T13:19:03.177

使用匿名函数

```
 intId = setInterval(function(){waiting(argument)}, 10000); 
```

这将创建一个无参数匿名函数，该函数`waiting()`使用参数调用

或者使用`setInterval()`函数的可选参数：

```
 intId = setInterval(waiting, 10000, argument [,...more arguments]); 
```

您的代码 ( `intId = setInterval(waiting(argument), 10000);`) 调用`waiting()`with `argument`，获取返回值，尝试将其视为一个函数，并设置该返回值的间隔。除非`waiting()`是返回另一个函数的函数，否则这将失败，因为您只能将函数视为函数。数字/字符串/对象不能被类型转换为函数。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-14T13:22:36.603

您可以使用[`Function#bind`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)：

```
intId = setInterval(waiting.bind(window, argument), 10000); 
```

它返回一个函数，该函数将使用给定的上下文 ( `window`) 和任何可选参数调用目标函数。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-14T13:21:00.587

使用此方法：

```
 var interval = setInterval( callback , 500 , arg1 , arg2[, argn ] );
 [...]
 function callback(arg1, arg2[, etc]){
 } 
```

更多信息：[window.setInterval](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-22T00:42:40.327

您可以使用 bind 和 apply 函数将参数存储在状态中。

在节点外壳中使用绑定的示例：

```
> var f = function(arg) { console.log (arg);}
> f()
undefined
> f("yo")
yo
> var newarg = "stuff";
> f(newarg)
stuff
> var fn = f.bind(this, newarg);
> fn()
stuff
> var temp = setTimeout(fn,1000)
> stuff 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2014-10-27T16:35:53.503

setInterval( 函数() { funca(10,3); }, 500 );

# javascript - 如何制作一个可以使用和不使用requirejs的js函数

> ID：15410389
> 
> 赞同：3
> 
> 时间：2013-03-14T13:18:19.877
> 
> 标签：javascript, jquery, requirejs

我创建了一个 js 库（MessageBus.js）并使其与 requirejs 兼容。现在我想在没有requirejs的情况下使用相同的库，即通过创建对象（new MessageBus（））。

我在这篇文章中附上了我的库。

```
define([], function () {

var MessageBus = function () {
    this.channelCallBackMap = {};
    this.alreadyRegistred = false;
}

MessageBus.prototype = {
    publish: function (channel, message) {
        //Put original message and channel in the envelope and send it
        var envelope = {
            channel: channel,
            message: message
        };
        var domain = location.protocol + '//' + location.host;
        //Send message to all sibling iframes in the parent document
        $("iframe", parent.document.body).each(function (i, frame) {
            frame.contentWindow.postMessage(JSON.stringify(envelope), domain);
        });

    },

    subscribe: function (channels, callbacks) {
        var self = this;
        if ($.isArray(channels) && $.isArray(callbacks)) {
            $.each(channels, function (i, channel) {
                self.channelCallBackMap[channel] = callbacks[i];
            });
        }
        else if ($.isArray(channels)) {
            $.each(channels, function (i, channel) {
                self.channelCallBackMap[channel] = callbacks;
            });
        } else if (!$.isArray(callbacks)) {
            this.channelCallBackMap[channels] = callbacks;
        }

        if (!this.alreadyRegistred) {
            $(window).on('message', function (event) {
                //Get the envelope, and from it get the original message as well as the channel
                var domain = location.protocol + '//' + location.host;
                if (event.originalEvent.origin !== domain) {
                    return;
                }
                var envelope = $.parseJSON(event.originalEvent.data);
                if ($.inArray(envelope.channel, self.channels()) > -1) {
                    //Now it calls call-back function
                    self.channelCallBackMap[envelope.channel](envelope.channel, envelope.message);
                }
            });
        }
        this.alreadyRegistred = true;
    },

    channels: function () {
        var keys = $.map(this.channelCallBackMap, function (value, key) {
            return key;
        });
        return keys;
    }
}

return MessageBus;

}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T13:49:22.230

尝试这样的事情：

```
!function (name, definition) {
    if (typeof define == 'function' && define.amd) {
        define(definition);
    } else if (typeof module != 'undefined') {
        module.exports = definition();
    } else {
        this[name] = definition();
    }
}('MessageBus', function() {

    var MessageBus = function () {
        this.channelCallBackMap = {};
        this.alreadyRegistred = false;
    };

    // Rest of the object

    return MessageBus;
}); 
```

这是一种通用语法，因为它也支持 CommonJS。请参阅此库中的示例 - [https://github.com/ded/klass/blob/master/klass.js](https://github.com/ded/klass/blob/master/klass.js)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:25:46.890

当您不想用作 AMD 模块时，不确定为什么要将其写为 AMD 模块。

这根本不是一个好主意，但是您可以在将在全局上下文中`MessageBus.js`设置的 will之前添加自己的方法：`MessageBus`

```
function define(dep, func)(
  window.MessageBus = func()
) 
```

更好的方法是有两个不同的版本。[您可以拥有普通的 JS 版本并使用grunt-combine](https://github.com/mcgaryes/grunt-combine)任务构建另一个带有 grunt 任务的版本

```
combine: {
  amd: {
    input: "amdContainer.js",
    output: "MessageBus-amd.js",
    tokens: [
      {
        token: "%MessageBus%",
        file: "MessageBus.js"
      }
    ]
  } 
```

**amdContainer.js**

```
define([], function () {
  %MessageBus%
  return MessageBus;
}); 
```

**消息总线.js**

```
var MessageBus = function () {
    this.channelCallBackMap = {};
    this.alreadyRegistred = false;
}

MessageBus.prototype = {
    publish: function (channel, message) {
        //Put original message and channel in the envelope and send it
        var envelope = {
            channel: channel,
            message: message
        };
        var domain = location.protocol + '//' + location.host;
        //Send message to all sibling iframes in the parent document
        $("iframe", parent.document.body).each(function (i, frame) {
            frame.contentWindow.postMessage(JSON.stringify(envelope), domain);
        });

    },

    subscribe: function (channels, callbacks) {
        var self = this;
        if ($.isArray(channels) && $.isArray(callbacks)) {
            $.each(channels, function (i, channel) {
                self.channelCallBackMap[channel] = callbacks[i];
            });
        }
        else if ($.isArray(channels)) {
            $.each(channels, function (i, channel) {
                self.channelCallBackMap[channel] = callbacks;
            });
        } else if (!$.isArray(callbacks)) {
            this.channelCallBackMap[channels] = callbacks;
        }

        if (!this.alreadyRegistred) {
            $(window).on('message', function (event) {
                //Get the envelope, and from it get the original message as well as the channel
                var domain = location.protocol + '//' + location.host;
                if (event.originalEvent.origin !== domain) {
                    return;
                }
                var envelope = $.parseJSON(event.originalEvent.data);
                if ($.inArray(envelope.channel, self.channels()) > -1) {
                    //Now it calls call-back function
                    self.channelCallBackMap[envelope.channel](envelope.channel, envelope.message);
                }
            });
        }
        this.alreadyRegistred = true;
    },

    channels: function () {
        var keys = $.map(this.channelCallBackMap, function (value, key) {
            return key;
        });
        return keys;
    }
} 
```

# html - 有没有办法让 iFrame 中的链接重定向到它们的源？

> ID：15410391
> 
> 赞同：2
> 
> 时间：2013-03-14T13:18:27.190
> 
> 标签：html, redirect, iframe, browser

对于临时措施，我想将[我的博客](http://dur.designsoc.com/blog/)复制/镜像到其[根域](http://www.designsoc.com)。这是因为我现在没有时间设计首页。

我使用[iFrame](http://www.w3schools.com/tags/tag_iframe.asp)镜像了网站（是否有更方便的方法满足我的要求？）

我只希望根域（即镜像页面）内的链接在单击时重定向到原始页面（即源内容显示在浏览器地址栏中）。有没有办法做到这一点？

我只想使用 iFrame 来显示页面。单击链接后，我希望留下 iFramed 页面，并将网页体验的其余部分放在 iFrame 的来源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T04:12:17.997

您可以将您的根域重定向到博客子域或使用 DNS 将您的根域指向您的博客服务器。

**编辑**

如果您必须使用 iframe，您可以在 iframe 的标签中包含基本标签，以使所有链接在顶级窗口中打开。例如：

```
<iframe>
    <head>
        <base target="_top">
    </head>
    <html>
        ...
    </html>
</iframe> 
```

有关详细信息，请参阅[http://www.w3schools.com/tags/tag_base.asp 。](http://www.w3schools.com/tags/tag_base.asp)

我仍然认为更好的解决方案是在您的基本域上放置一个重定向或使用 DNS 将基本域指向博客。

# c# - ViewModel 中的消息框

> ID：15410392
> 
> 赞同：3
> 
> 时间：2013-03-14T13:18:32.913
> 
> 标签：c#, windows-phone-7, mvvm-light

我在我的应用程序 mvvm light 工具包中使用。我想使用我的视图模型中的消息框。那么：我可以`Messenger.Default.Register(`在 App.xaml.cs 中注册）吗？它必须为所有视图模型注册。我不想在每个 ViewModel 中注册它。我可以调用`Messenger.Default.Unregister()`停用或关闭事件吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:26:20.143

MVVM 和消息框的一种可能方法是简单的事件机制：

```
public class MessageBoxDisplayEventArgs : EventArgs
{
    public string Title { get; set; }

    // Other properties here...
}
...
public class ViewModelBase
{
    public event EventHandler<MessageBoxDisplayEventArgs> MessageBoxDisplayRequested;

    protected void OnMessageBoxDisplayRequest(string title)
    {
        if (this.MessageBoxDisplayRequested != null)
        {
            this.MessageBoxDisplayRequested(
                this, 
                new MessageBoxDisplayEventArgs
                {
                    Title = title
                });
        }
    }
}
...
public class YourViewModel : ViewModelBase
{
    private void SomeMethod()
    {
        this.OnMessageBoxDisplayRequest("hello world");
    }
}
...
public class YourView
{
    public YourView()
    {
        var vm = new YourViewModel();
        this.Datacontext = vm;

        vm.MessageBoxDisplayRequested += (sender, e) =>
        {
            // UI logic here
            //MessageBox.Show(e.Title);
        };
    }
} 
```

# php - 将数据从一个表复制到另一个表？

> ID：15410395
> 
> 赞同：0
> 
> 时间：2013-03-14T13:18:45.823
> 
> 标签：php, mysql

当用户注册我的网站时，他们会填写一份注册表并将其详细信息放入名为 ptb_registrations 的表中。

在此之后，他们收到一封带有验证码的电子邮件，他们单击电子邮件链接并转到验证链接，输入正确的代码后，我希望运行查询。

此查询需要充当插入查询，它将数据从一个表 (ptb_registrations) 复制到另一个表 (ptb_users)。

有人可以帮我解决这个问题，因为它不起作用而且我不确定我是否朝着正确的方向前进。谢谢

```
// Make a safe query
$query = sprintf("INSERT INTO ptb_users (first_name, last_name, email,    
    password, dob)
SELECT firstname, lastname, email, password    
    dob
WHERE not exists (select 1 from ptb_registrations where ptb_registrations.registration_code='$verificationcode';",
                    mysql_real_escape_string($newpassword));

mysql_query($query)or die('Could not update members: ' . mysql_error()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:32:50.027

据我所知，您的查询中有很多语法错误：

select 语句中密码和 dob 之间没有逗号，未指定 select 语句的 From table。`not exists`此外，条件看起来很奇怪（并且语句没有右括号）。至于我，你应该有这样的查询：

```
$query = "INSERT INTO ptb_users (first_name, last_name, email, password, dob)
SELECT firstname, lastname, email,'". mysql_real_escape_string($newpassword)."', dob FROM ptb_registrations
WHERE ptb_registrations.registration_code=''". mysql_real_escape_string($$verificationcode).";" 
```

此查询将从 ptb_registrations 中获取一行，其中注册码等于从请求中收到的一个，并将其插入 ptb_users （并将新密码作为用户密码）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:33:32.737

你可以尝试这样的事情：

```
SELECT firstname, lastname, email, password,dob
into yourtablename
from (tablename)
^ you are missing something here i.e your tablename
WHERE not exists (select 1 from ptb_registrations where
ptb_registrations.registration_code='$verificationcode';",
mysql_real_escape_string($newpassword) 
```

*   这将创建具有相同的新表`data structure`

# javascript - html将内容从一帧移动到另一帧

> ID：15410397
> 
> 赞同：0
> 
> 时间：2013-03-14T13:18:53.150
> 
> 标签：javascript, html, cross-domain, frame, frameset

因此，我整理了一个本地运行的网页，该网页目前有 2 个框架 - 一个是导航栏，一个用于通过导航栏中的链接定义的内容。这是在 Internet Explorer 8 中运行的，不幸的是必须保持这种方式。

从长远来看，我不会详细说明我想要实现的目标，因为这更像是一个概念证明，但我想知道；是否可以有 3 个框架 - 一个导航栏，2 个内容框架和导航栏中的链接，它将第一个内容框架的内容移动到第二个内容框架。

我尝试使用导航栏页面中编写的粗略函数：

```
var theContent =  window.parent.document.getElementById("frame2").contentWindow.document.body.innerHTML;

window.parent.document.getElementById("frame3").contentWindow.document.body.innerHTML = theContent; 
```

但是我收到一个跨域错误（访问被拒绝）。是否有将内容从一帧移动到另一帧的替代方法？

附带说明一下，我不打算在第二帧中加载相同的网站，因为我意识到您可以将第二帧的 href 设置为第一帧的 href；我实际上想将会话转移到另一个框架。

最终目标将是一种选项卡式界面，您可以在其中切换框架会话。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:28:00.990

“将会话*转移到另一个框架*”不仅仅是将当前的 HTML 代码从一个框架复制到另一个框架；并再次加载页面会更接近它恕我直言。

然而，SOP 将阻止对您界面中加载的第三方页面的任何访问，所以我认为没有多大可行性。如果有帮助，您宁愿尝试移动整个框架而不是它们的内容。

# ajax - 更好的是 - 直接使用 ajax 调用或将其放入函数中并从多个位置调用它

> ID：15410399
> 
> 赞同：0
> 
> 时间：2013-03-14T13:19:00.183
> 
> 标签：ajax

这些是两个工作相同的选项：

```
 var promise=doAjax(dataStr,'shop');
        promise.success(function(data){
            json=eval('('+data+')');
            console.log(json['Data']);
        });
        promise.error(function(data){
            alert('There was an error');
        }); 
```

带功能：

```
function doAjax(dataStr,process){
    return $.ajax({
        data: dataStr,
        url: '/process/'+process+'/'
    });
} 
```

或者它看起来像这样：

```
 $.ajax({
            data: dataStr,
            url: '/process/shop/',
            success: function(data){
                json=eval('('+data+')');
                console.log(json['Data']);
            },
            error: function(data) {
                alert('There was an error');
            }
        }); 
```

那么最有效的方法是什么，因为第一种方法是稍微更轻的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:27:04.220

如果你要经常使用你的包装器，你可以实现它以确保你的代码干净，有时我使用以下包装器：

```
//initPostData() returns ready-to-post js object
ajaxWrapper(initPostData(), "url", function (response) { 
    //some logic here              
});

function ajaxWrapper(postData, url, callback) {
    $.ajax({
        type: 'POST',
        contentType: "application/json; charset=UTF-8",
        dataType: 'json',
        data: JSON.stringify(postData),
        url: url,
        success: function (response) {
            callback(response);
        },
        error: function () {
            //error logic
        }
    });
} 
```

# jquery - 保持选中 div 并通过按钮更改其值

> ID：15410400
> 
> 赞同：1
> 
> 时间：2013-03-14T13:19:00.420
> 
> 标签：jquery

我有两个 div，A 和 B。它们都有数值 1。现在我有一个“添加”按钮。我想一次选择一个 div 并通过单击添加来增加其中的值。这个怎么做？

```
<div id="A">1</div>
<div id="B">1</div>

<input type='button' value="ADD" id="add"> 
```

脚本

```
$("#add").on('click', function(){
   $(??).text($(??).text() + 1);
}); 
```

如何将添加按钮链接到我单击的 div，并在单击添加时保持选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:23:34.243

就像是：

```
var $divs = $('div');
var $addButton = $("#add");

// On click on a div remove calss from eventually previous clicked div and add class to current clicked div
$divs.on('click', function () {
    var $divClicked = $(this);
    $divs.removeClass('has-been-clicked')
    $divClicked.addClass('has-been-clicked');
});

// On click on button, find previous marked div and play with it. If no div has been clicked yet, nothing happens
$addButton.on('click', function () {
    var $lastDivClicked = $divs.filter('.has-been-clicked').first();

    if ($lastDivClicked.length > 0) {
        var currentValue = parseInt($lastDivClicked.text());
        $lastDivClicked.text(++currentValue);
    }
}); 
```

演示：http: [//jsfiddle.net/kxMmA/7/](http://jsfiddle.net/kxMmA/7/)

**编辑**

@user1545024：哇，您可能会查看 jQuery 文档和手册...
1\. 没有功能`.nearest()`
2\. ID（在您的情况下`#main`）必须是 unqiue。
3\. 添加类`selected`时，应先从兄弟姐妹中删除该类。
4\. 您只需要一个事件处理程序作为点击`.qty`并将`.name`DOM 冒泡到`#main`.
5\. 使用`.text()`和计算数字时应该使用`parseInt()`，否则结果会附加文本，所以`$(".selected").text() + 1`给出的不是数字`2`而是字符串`11`。

在此处查看更新的小提琴：http: [//jsfiddle.net/hdn6e/12/](http://jsfiddle.net/hdn6e/12/)
和（在我眼中）优化的小提琴：http: [//jsfiddle.net/hdn6e/13/](http://jsfiddle.net/hdn6e/13/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:20:44.150

添加一个类， .selected 可能，单击 div 时，然后找到它`$('.selected')`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T13:24:44.470

[摆弄它](http://jsfiddle.net/hdn6e/4/)

```
var myDiv;
$("div").on('click', function(){myDiv = $(this)});

$("#add").click(function() {
    myDiv.text(parseInt(myDiv.text(),10)+1);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T13:25:02.210

另一种可能性是创建一个包含您上次单击的 div 的变量。

将单击侦听器添加到 div 以更新您的引用变量，并从“添加”按钮单击处理程序中处理引用变量中的 div。

```
var lastClickedDiv;

$("div").on('click', function()
{
  lastClickedDiv = $(this);
});

$("#add").on('click', function(){
   var newNumber = parseInt(lastClickedDiv.text()) + 1
   lastClickedDiv.text(newNumber);
}); 
```

[jsfiddle 演示](http://jsfiddle.net/nUQPA/)

# ios - 如果数组日期与今天日期相同，则本地通知

> ID：15410405
> 
> 赞同：0
> 
> 时间：2013-03-14T13:19:13.180
> 
> 标签：ios, notifications

我有一个类似的数组：

```
_combinedBirthdates(
"03/05/2013",
"09/22/1986",
"03/02/1990",
"03/02",
"08/22/1989",
"11/02/1990",
"07/08",
"08/31/1990",
"05/13",
"07/11/2007",
"10/07/2010",
"02/20/1987") 
```

如果今天的日期与上述数组中的日期相同，我想要本地通知

我使用以下逻辑进行通知：

```
NSLog(@" _combinedBirthdates%@",_combinedBirthdates);  
NSDateFormatter *Formatter1 = [[NSDateFormatter alloc] init];
[Formatter1 setDateFormat:@"MM/dd"];
UILocalNotification *localNotif = [[UILocalNotification alloc] init];
NSDate *date1 =[NSDate date];
NSString *string =[Formatter1 stringFromDate:date1];
NSDate *todaydate =[Formatter1 dateFromString:string];

for (int i=0;i<_combinedBirthdates.count;i++)
{
    NSDate *date =[Formatter1 dateFromString:[_combinedBirthdates objectAtIndex:i ]];
    if(date == todaydate){
    localNotif.fireDate = date;
    localNotif.alertBody = @"birthdate notification";
    [[UIApplication sharedApplication] scheduleLocalNotification:localNotif];
    } 
```

现在我的问题：

1.  这段代码可以吗？
2.  我需要设备来测试此代码还是可以在模拟器中测试它？
3.  什么时候会出现通知？凌晨 12:00？
4.  如果申请被关闭，会出现通知吗？
5.  如果代码不正确，请修改它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:49:55.587

1.  你的代码有一些错误，我在这里更正了。
2.  是的，我们可以在模拟器中运行它进行测试。
3.  UILocalNotifications 将在我们在相应通知中指定的日期触发。在分配通知时，我们将考虑提到的时间。如果我们没有设置时间，那么设备时间将被考虑为提到的触发日期。
4.  即使应用程序也关闭了，本地通知也会触发，但在我们点击操作按钮之前它不会触发。看这个规范...

查看修改后的代码......

```
NSMutableArray *newBirthDates = [[NSMutableArray alloc] init];;
for(int i = 0; i < [_combinedBirthdates count]; i++)
{
    NSString *date = [_combinedBirthdates objectAtIndex:i];
    NSArray *dateComponents = [date componentsSeparatedByString:@"/"];
    if([dateComponents count] == 3)
    {
        [newBirthDates addObject:[NSString stringWithFormat:@"%@/%@",[dateComponents objectAtIndex:0], [dateComponents objectAtIndex:1]]];
    }
    else
    {
        [newBirthDates addObject:date];
    }
}
NSDateFormatter *Formatter1 = [[NSDateFormatter alloc] init];
[Formatter1 setDateFormat:@"MM/dd"];
NSDate *date1 =[NSDate date];
NSString *string =[Formatter1 stringFromDate:date1];
NSDate *todaydate =[Formatter1 dateFromString:string];

for (int i=0;i<newBirthDates.count;i++)
{
    NSDate *date =[Formatter1 dateFromString:[newBirthDates objectAtIndex:i ]];
    NSComparisonResult result = [date compare:todaydate];
    if(result == NSOrderedSame)
    {
        UILocalNotification *localNotif = [[UILocalNotification alloc] init];
        localNotif.fireDate = date;
        localNotif.alertBody = @"birthdate notification";
        [[UIApplication sharedApplication] scheduleLocalNotification:localNotif];
    }
} 
```

# matlab - 如何在 MATLAB 中调整 bar3 函数中的 Z 坐标？

> ID：15410408
> 
> 赞同：0
> 
> 时间：2013-03-14T13:19:30.320
> 
> 标签：matlab, 3d

我有一个由 8760 x 9 不同年份的天气数据矩阵组成的矩阵。例如这里是我的一部分数据：（每一列代表不同的年份）

![在此处输入图像描述](../Images/4b7ad6b9165d8cefb6f83df8d47689ec.png)

我想做的是将这些数据以 3-D 的形式绘制为正常的折线图，以便我可以很好地比较数据。当我尝试使用 bar3-function 执行此操作时，我得到以下信息：

![在此处输入图像描述](../Images/6d59831f6deaa170cece4db30967bb93.png)

我试图阅读手册，但我没有足够清楚如何调整 Z 坐标。如您所见，数据被“压平”在一起......我怎样才能让不同的数据集相距更远，以便区分不同的颜色？还是我应该为此使用另一个功能？...只是为了澄清..这是我想看到的（图片来自指南）

![在此处输入图像描述](../Images/29e6297b85e18c751353badfec4db842.png)

谢谢你的帮助=）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T14:18:01.083

无意中发现`bar3(a, 1);`和你的照片很像，但`hold on; bar3(a, 1), shading flat;`看起来不错。

代码：

```
[b a] = meshgrid(1:9, 1:8000);
figure;
hold on;
bar3(a, 1), shading flat; 
```

# vb.net - 从excel文件中读取而不丢失数据的最佳方法是什么？VB.net

> ID：15410417
> 
> 赞同：0
> 
> 时间：2013-03-14T13:19:51.350
> 
> 标签：vb.net, excel, ado.net

从excel文件中读取而不丢失数据的最佳方法是什么？Excel 工作表的列格式为 HH:MM:SS，当使用 ADO 读取时，时间格式更改为日期并丢失实际值：

来自excel的样本： ![在此处输入图像描述](../Images/bec67d29a2c53b555d34f815a8f7f6af.png)

导入网格视图后： ![在此处输入图像描述](../Images/33c99fb688aba3b7912b3d5c8af744cb.png)

代码：

```
 Try
        ' Clear the DataGridView and the connection string TextBox
        Dim Datatable As New DataTable("Sometable")
        ' Fill the DataGridView and connection string TextBox
        Using connection As New OleDb.OleDbConnection(Super.Excel_GetConnectionString(txtZDCalc_txtPerPath.Text, txtZDCalc_txtPerPath.Tag))
            connection.Open()
            Using adapter As New OleDb.OleDbDataAdapter("SELECT * FROM [" & cboxZDCalc_Sheet.SelectedItem & "]", connection)
                adapter.Fill(Datatable)
            End Using
        End Using

        Super.ZD_GetEmployees(Datatable)
    Catch ex As Exception
        ' Display any errors
        MessageBox.Show("[" & ex.[GetType]().Name & "] " & ex.Message & ex.StackTrace)
    End Try 
```

为什么进口时间后失去价值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:11:19.830

听起来好像您想显示 TimeSpan 而不是日期。Excel 将单元格的值存储为日期时间，并使用格式来控制其显示方式。

您要做的是将 DataTable 中列的数据类型更改为 TimeSpan

查看此处了解如何执行此操作：[如何更改 DataTable 中 DataColumn 的 DataType？](https://stackoverflow.com/questions/9028029/how-to-change-datatype-of-a-datacolumn-in-a-datatable)

# ssas - 为什么我得到 Parser: 由于这里的歧义，无法解析语句方言？

> ID：15410418
> 
> 赞同：2
> 
> 时间：2013-03-14T13:19:53.627
> 
> 标签：ssas, ssms, mdx

我试图在不同的行上获得两个不同的 topcount，猜我在某处想错了吗？

```
select{
([Measures].[Invoiced_DAm])
} on columns,

    topcount(
        [07 Prod].[Product_Descr].children
        ,10
        ,([Measures].[Invoiced_DAm], [19 Time].[Tr Year].&[2008])
    ),
    topcount(
        [07 Prod].[Product_Descr].children
        ,10
        ,([Measures].[Invoiced_DAm], [19 Time].[Tr Year].&[2009])
    ) on rows 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:07:34.573

如何让它工作只需将 TOPCOUNT 操作放在花括号之间`{ }`：

```
select{
([Measures].[Invoiced_DAm])
} on columns,
{
    topcount(
        [07 Prod].[Product_Descr].children
        ,10
        ,([Measures].[Invoiced_DAm], [19 Time].[Tr Year].&[2008])
    ),
    topcount(
        [07 Prod].[Product_Descr].children
        ,10
        ,([Measures].[Invoiced_DAm], [19 Time].[Tr Year].&[2009])
    )
} on rows 
```

为什么？因为这是 MDX 区分集合的方式：只要明确列出元组，我们就需要用大括号将元组括起来。TOPCOUNT 函数将返回（在这种情况下）来自 Product 维度的前 10 个元组。

在您的情况下`TOPCOUNT(...), TOPCOUNT(...)`，对 MDX 没有任何意义（两组或元组列表，用逗号分隔）。

`{TOPCOUNT(...), TOPCOUNT(...)}`将告诉 MDX 您要显示来自两个 TOPCOUNT 语句的行集，因此您声明了 Set of sets，它本身就是一个集合。

# ios - 点击 NavigationBar 和 NavigationBar 项时 UIPopoverController 不会关闭

> ID：15410419
> 
> 赞同：0
> 
> 时间：2013-03-14T13:19:56.263
> 
> 标签：ios, uinavigationbar, uinavigationitem

我是 ios 的新手。我有一个包含多个按钮的导航栏，包括后退按钮、排序、过滤器、设置按钮和打开弹出框的按钮。从内部`UIPopoverController`打开时不会被解雇。`navigationItem``UINavigationController`

当我单击过滤器导航项`popoverView`控制器工作正常但问题是如果我单击其他导航项，如返回、排序、设置不关闭。当我点击或触摸导航栏弹出窗口时不关闭如何纠正这个问题？

视图控制器.h

```
 IBOutlet UINavigationBar *navigationBar; 
```

视图控制器.m

```
UIBarButtonItem *leftButton = [UIBarButtonItem barItemWithImage:[UIImage imageNamed:@"back_btn.png"] target:self action:@selector(onBack)];

UINavigationItem *item = [[UINavigationItem alloc] initWithTitle:@""];

UIButton *btnMainLogo = [UIButton buttonWithType:UIButtonTypeCustom];

[btnMainLogo setImage:[UIImage imageNamed:@"dina_new_logo.png"] forState:UIControlStateNormal];
btnMainLogo.frame = CGRectMake(0, 0, 160, 36);
[btnMainLogo addTarget:self action:@selector(onHome) forControlEvents:UIControlEventTouchUpInside];
item.titleView = btnMainLogo;

item.leftBarButtonItem = leftButton;
item.hidesBackButton = YES;

//RIGHT MENU
NSMutableArray *arrRightBarItems = [[NSMutableArray alloc] init];
UIButton *btnSetting = [UIButton buttonWithType:UIButtonTypeCustom];
[btnSetting setImage:[UIImage imageNamed:@"settings.png"] forState:UIControlStateNormal];
btnSetting.frame = CGRectMake(0, 0, 32, 32);
btnSetting.showsTouchWhenHighlighted=YES;
[btnSetting addTarget:self action:@selector(onSettings:) forControlEvents:UIControlEventTouchUpInside];

UIBarButtonItem *barButtonItem = [[UIBarButtonItem alloc] initWithCustomView:btnSetting];

UIButton *btnShare = [UIButton buttonWithType:UIButtonTypeCustom];
[btnShare setImage:[UIImage imageNamed:@"share-icon.png"] forState:UIControlStateNormal];
btnShare.frame = CGRectMake(0, 0, 32, 32);
btnShare.showsTouchWhenHighlighted=YES;
[btnShare addTarget:self action:@selector(onShare:) forControlEvents:UIControlEventTouchUpInside];
UIBarButtonItem *barButtonItem1 = [[UIBarButtonItem alloc] initWithCustomView:btnShare];

UIBarButtonItem *edit = [[UIBarButtonItem alloc]
                           initWithTitle:@"Edit"
                           style:UIBarButtonItemStylePlain
                           target:self
                           action:@selector(onEditIssue:)];
UIBarButtonItem *sortByDate = [[UIBarButtonItem alloc]
                         initWithTitle:@"Sort"
                         style:UIBarButtonItemStylePlain
                         target:self
                         action:@selector(onSortByDate:)];
UIBarButtonItem *FilterByIssue = [[UIBarButtonItem alloc]
                         initWithTitle:@"Filter"
                         style:UIBarButtonItemStylePlain
                         target:self
                         action:@selector(onFilterByIssue:)];

NSArray *arrBtns = [[NSArray alloc]initWithObjects:barButtonItem,barButtonItem1,edit,sortByDate,FilterByIssue, nil];
[arrRightBarItems addObjectsFromArray:arrBtns];
[item setRightBarButtonItems:arrRightBarItems];
[navigationBar pushNavigationItem:item animated:NO]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:08:22.993

尝试在每个条形按钮项的回调中解除弹出框。例如：

```
-(void)onEditIssue:(id)sender
{
    if ([popoverController isPopoverVisible])
        [popoverController dismissPopoverAnimated:YES];
    //Do other stuff
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-13T23:35:25.547

[这个](https://stackoverflow.com/questions/6136792/uipopovercontroller-does-not-dismiss-when-clicking-on-the-navigationbar)问题的公认答案对我有用。`passthroughViews`在展示它之后将弹出框控制器设置为 nil 。

# c++ - C++ Boost Logging：如何压缩日志？

> ID：15410421
> 
> 赞同：4
> 
> 时间：2013-03-14T13:20:02.960
> 
> 标签：c++, boost, boost-logging

我需要压缩由 Boost Logging 库生成的日志。我看到两种方法：

1.  动态压缩日志到 BZip 或 GZip -*最好*
2.  旋转时压缩日志（复制日志并将其压缩）。

我该如何实施？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-05-13T20:47:15.490

Boost 有[gzip 过滤器](https://www.boost.org/doc/libs/1_70_0/libs/iostreams/doc/classes/gzip.html)，可以[连接到日志接收器](https://www.boost.org/doc/libs/1_70_0/libs/log/doc/html/log/detailed/sink_backends.html)。

# html - 引号向后显示

> ID：15410422
> 
> 赞同：-5
> 
> 时间：2013-03-14T13:20:03.460
> 
> 标签：html, css, quotes

每当我在文本中使用引号显示在我的代码中时，开始和结束引号都显示为结束引号。为什么会发生这种情况？我以为它可能是字体，但我将其更改为多个不同的字体，它仍然是相同的。我的代码中的某些东西会改变它吗？

```
#container{

background:transparent;
margin-top:50px;    
border-left:2px #666 solid;
border-right:2px #666 solid;
width:600px;
height:auto;
}
#content{ 
padding:10px;
float: left;
display: block;
max-width: 100%;
overflow:hidden;
margin-top:150px;
border:1px #000 solid;
margin-top:0px;
background-color:transparent;
line-height:0px;
margin-bottom:20px;
margin-left:40px;
width:500px;
height:auto;
}
.text{
background:#efefef;
color: #000;
text-align:center;
 margin-bottom:20px;
width:480px;
padding-left:10px;
padding-bottom: 20px;
} 
```

这就是针对此的所有 css，这是正在显示的示例图像 ![在此处输入图像描述](../Images/7ae0f63407a66363b05cafe0b39a89a1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T14:28:38.730

# c++ - c++中函数调用前的空格

> ID：15410428
> 
> 赞同：2
> 
> 时间：2013-03-14T13:20:12.710
> 
> 标签：c++, syntax, whitespace

c++ 中是否允许以下​​代码？ `a. foo()` （注意“foo”前面的空格）

我认为不会，但编译器不会抱怨。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:27:10.880

是的，它是有效的 C++ 代码：

来自 [C++ 标准 - ANSI ISO IEC 14882 2003.pdf](https://openassist.googlecode.com/files/C++%20Standard%20-%20ANSI%20ISO%20IEC%2014882%202003.pdf)，第 2.6 章：

> 有五种*标记*：标识符、关键字、文字、运算符和其他分隔符。**如下所述，空白**、水平和垂直制表符、换行符、换页符和注释（统称为“空白”）将**被忽略**，除非它们用于分隔标记。

同一章定义*标点符号*也是*记号*。

第*2.12 章操作符和标点符号*定义`.`了*标点符号*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-14T13:23:21.320

应该没问题，据我所知，编译器会删除所有空格（制表符、换行符、空格），除非它们在字符串中（即“在字符串中”）。

[编辑] 你也不应该在运算符中放置空格（即`i++`不同于`i+ +`和`foo()`不同于`fo o()`）。

[编辑] 正如另一个答案中提到的，空格（空格、制表符、换行符、注释）也用于分隔运算符，例如`void bar()`vs.`voidbar()`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-14T13:22:55.453

允许。

`.`只是运算符，如`+`、`::`、`->`等`&&`。

在您的情况下，空格被忽略

一般来说，词法分析器从源文件生成标记后删除的空格。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-14T13:25:12.413

在 C 或 C++ 中的任何标记之前或之后的任何位置都可以有尽可能多或尽可能少的空格。唯一的规则是标记需要由不同的标记（即，不是字母（AZ、az、_）或数字的东西）分隔 [并且在相关的情况下，标记还可以包含 .、+ 或 -，例如作为浮点数）。

所以

```
 a.foo()
 a. foo();
 a . foo (    ) ;
 a
   . 
foo 
  (
 )
; 
```

都是一样的。

但是你必须在某些标记之间有一个空格，特别是那些只包含“字母和数字”的标记（见上文）：

```
voidfoo() 
```

不一样

```
void foo(); 
```

# java - 在Java中提取部分路径

> ID：15410431
> 
> 赞同：9
> 
> 时间：2013-03-14T13:20:20.657
> 
> 标签：java, file, path, filepath

我有这样的文件路径：

```
/home/Dara/Desktop/foo/bar/baz/qux/file.txt 
```

在 Java 中，我希望能够获得**前两个**文件夹。IE。`baz/qux`无论文件路径长度或操作系统（文件路径分隔符，如`/` `:`和`\`）。我曾尝试使用该`subpath()`方法，`Paths`但似乎找不到通用方法来获取文件路径的长度。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-14T13:24:28.380

还不漂亮，但是，你猜方向：

```
File parent = file.getParentFile();
File parent2 = parent.getParentFile();
parent2.getName() + System.getProperty("path.separator") + parent.getName() 
```

另外的选择：

```
final int len = path.getNameCount();
path.subpath(len - 3, len - 1) 
```

编辑：您应该检查 len 或 catch`IllegalArgumentException`以使您的代码更健壮。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-14T13:39:38.230

方法`getNameCount()`和应该`getName(int index)`可以`java.nio.Path`帮助您：

```
File f = new File("/home/Dara/Desktop/foo/bar/baz/qux/file.txt");
Path p = f.toPath();
int pathElements = p.getNameCount();
String topOne = p.getName(pathElements-2).toString();
String topTwo = p.getName(pathElements-3).toString(); 
```

请注意，在将 的结果`getNameCount()`用作 的索引之前，应检查其有效性`getName()`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-09-24T10:18:32.320

使用子路径和 getNameCount。

```
 Path myPath = Paths.get("/home/Dara/Desktop/foo/bar/baz/qux/file.txt");
    Path subPath = myPath.subpath(myPath.getNameCount() -3, myPath.getNameCount() -1); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-14T13:21:59.167

您可以只[`split`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String%29)使用 String 或使用[`StringTokenizer`](http://docs.oracle.com/javase/7/docs/api/java/util/StringTokenizer.html).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-14T13:23:44.910

`File.getParent()`将删除文件名。

以及您将获得的路径分隔符：`System.getProperty("file.separator")`.

然后你可以使用`String.split()`获取路径的每一部分。

# javascript - 通过 for 循环迭代函数 x 次

> ID：15410441
> 
> 赞同：4
> 
> 时间：2013-03-14T13:20:40.327
> 
> 标签：javascript, jquery

```
$('.ip_button').click(function(){
   var buttonValue, slideTimes;
   buttonValue = $(this).html();
   slideTimes = parseInt(buttonValue) - 1;
   for (var i = 0 ; i < slideTimes; i++) { 
          slider.gallery_next(); 
       }             
}); 
```

嗨，我正在尝试使用确定按钮 -1 的值并多次运行幻灯片的函数在滑块上滑动多个图像。不幸的是，无论按钮中的值是什么，函数都只会执行一次。按钮中的当前值为：

```
<button class="ip_button">5</button> 
```

gallery_next() 的函数；被封装并如下所示：

```
this.gallery_next = function() {
    if (galleryRotating) { return; }
    galleryRotating = true;
    var elem = $(galleryId + " > li").first();
    $(galleryId).append(elem.clone());
    $(galleryId).animate({"left" : -imgWidth}, 650, function() {
        elem.remove();
        galleryRotating = false;
        $(galleryId).css({"left" : 0});
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:26:30.407

`animate`不会在时间循环再次调用函数时完成，`for`所以`galleryRotation`仍然是真的，函数什么也不做。您需要一种不同的方法：设置一个计时器以在 700 毫秒内调用您的函数，或者（更好）在您传递给的回调中再次调用旋转`animate`。

# ruby - 在厨师执行期间在本机扩展包之后安装gem

> ID：15410445
> 
> 赞同：5
> 
> 时间：2013-03-14T13:20:54.493
> 
> 标签：ruby, gem, chef-infra, recipe, cookbook

我正在尝试在厨师食谱中安装雾 gem，尽管 gem 安装发生在安装本机软件包之前，因此 gem 安装失败

```
package "libxslt-dev"
package "libxml2-dev"

chef_gem "fog" 
```

这是输出

```
[Thu, 14 Mar 2013 13:04:30 +0000] INFO: Processing chef_gem[fog] action install (ebs4000::update_volumes line 23)
[Thu, 14 Mar 2013 13:04:52 +0000] ERROR: Running exception handlers
[Thu, 14 Mar 2013 13:04:52 +0000] FATAL: Saving node information to /var/cache/chef/failed-run-data.json
[Thu, 14 Mar 2013 13:04:52 +0000] ERROR: Exception handlers complete
[Thu, 14 Mar 2013 13:04:52 +0000] ERROR: Gem::Installer::ExtensionBuildError: chef_gem[fog] (cookbook::recipe line 4) had an error: Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        /usr/bin/ruby1.8 extconf.rb
checking for libxml/parser.h... no
-----
libxml2 is missing.  please visit http://nokogiri.org/tutorials/installing_nokogiri.html for help with installing dependencies.
-----
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --without-opt-dir
    ...
    --with-pkg-config
    --without-pkg-config

Gem files will remain installed in /var/lib/gems/1.8/gems/nokogiri-1.5.6 for inspection.
Results logged to /var/lib/gems/1.8/gems/nokogiri-1.5.6/ext/nokogiri/gem_make.out 
```

我知道厨师资源的通知属性，但仍然可以正常运行。

那么我如何才能真正强制执行顺序首先安装本机包，然后在同一运行中安装 gem。

注意：手动安装包不是一个选项，因为我们希望新节点完全自动化。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-14T20:08:07.360

为什么不尝试在资源收集阶段开始时安装依赖项，如此处所述：[OPSCODE wiki: Run Resources from the Resource Collection](http://docs.opscode.com/resource_common_compile.html)

所以你的食谱看起来像：

```
xsltdev = package "libxslt-dev" do
   action :nothing
end

xmldev = package "libxml2-dev" do
   action :nothing
end

xsltdev.run_action(:install)
xmldev.run_action(:install)

chef_gem "fog" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T02:23:51.230

看起来你已经在这样做了。食谱是按顺序执行的，所以你应该很好。

在您的日志中，您只显示从 Chef 尝试安装的那一点发生的事情`fog`。您是否验证过 lib 包的安装在此之前没有出现？你可能弄错了包名，或者你需要更新包管理器的缓存。

# javascript - 显示数组数据，如控制台样式 ["1","2","3"]

> ID：15410451
> 
> 赞同：1
> 
> 时间：2013-03-14T13:21:05.943
> 
> 标签：javascript, jquery, arrays, input, output

如何显示像 console.log 这样的数组`<input>`？

```
var data = ['1'];
console.log(data);
$("input").val(data+""); 
```

我可以显示输入值`["1"]`吗？

我怎样才能将它从`<input>`值返回到数组

[http://jsbin.com/uyevuj/1/edit](http://jsbin.com/uyevuj/1/edit)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-14T13:22:36.143

使用`JSON.stringify`：

```
$("input").val(JSON.stringify(data)); //input will display ["1"] 
```

[http://jsbin.com/ijebay/6/](http://jsbin.com/ijebay/6/)

这里有一些 MDN 参考供未来的读者参考：[JSON.stringify - Mozilla 开发者网络](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify)

编辑：要从输入中“获取数组”：

```
var data = JSON.parse($("input").val()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-14T13:23:09.120

是的，使用`JSON.stringify`：

`$("input").val(JSON.stringify(data));`

[http://jsbin.com/ijebay/4](http://jsbin.com/ijebay/4)

# maven - 在 Maven 中定义存储库

> ID：15410454
> 
> 赞同：1
> 
> 时间：2013-03-14T13:21:11.543
> 
> 标签：maven, repository

我刚刚开始在 Maven 中进行几个项目，很想知道定义存储库的最佳方法是什么？

到目前为止我所理解的是以下两种方式：1.本地2.远程当我们使用本地存储库时，我们指的是我们的安装，否则它将首先检查本地目录中的依赖关系（远程缓存）

而远程存储库设置第三方来下载他们的工件。（例如某处`file://someurl`或`http://someurl`）

如果我错了，请纠正我，**我想知道定义存储库的最佳方法是什么，请记住，如果有人在低带宽连接上使用项目，则性能不应受到影响。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T14:08:24.273

最好的办法是将[存储库管理器](http://maven.apache.org/repository-management.html)安装为远程存储库并适当地配置[settings.xml](http://maven.apache.org/settings.html)。在使用依赖项时，本地存储库会自动填充它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T14:16:09.127

最好的方法是保持默认行为：位于`<USER_HOME>/.m2/repository`.

您将运行的第一个 mvn 命令会很慢，因为此存储库需要由很多库（maven 插件以及依赖项中的库和框架）填充。

当您运行 mvn install 时，此本地存储库将安装您的工件。

如果您需要与同事共享工件，您可以：

*   通过 SCM 进行（即您的同事必须检查您的代码并运行`mvn install`，以便您的库在他们的本地存储库中可用）
*   通过存储库管理器（artifactory 或 nexus）执行此操作（然后`mvn deploy`在您的 settings.xml 中使用适当的配置运行，以通过存储库管理器以二进制形式让您的同事可以使用您的工件）。

我建议您在安装存储库管理器之前先熟悉 maven。

# xml - Powershell：将 XML 转换为字符串

> ID：15410455
> 
> 赞同：37
> 
> 时间：2013-03-14T13:21:11.643
> 
> 标签：xml, string, powershell, converter

我正在寻找一种将 XML-Object 转换为字符串的方法。

Powershell 中是否有类似 $xml.toString() 的方法？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-03-14T13:29:15.810

您可能正在寻找`OuterXml`.

`$xml.OuterXml`应该给你你想要的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-14T13:27:36.810

您是如何创建 XML 对象的？

通常，如果您想要来自对象的 XML 字符串，您可以使用：

```
$object | ConvertTo-Xml -As String 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-11-07T09:39:59.690

Try this:

```
[string[]]$text = $doc.OuterXml #or use Get-Content to read an XML File
$data = New-Object System.Collections.ArrayList
[void] $data.Add($text -join "`n")
$tmpDoc = New-Object System.Xml.XmlDataDocument
$tmpDoc.LoadXml($data -join "`n")
$sw = New-Object System.IO.StringWriter
$writer = New-Object System.Xml.XmlTextWriter($sw)
$writer.Formatting = [System.Xml.Formatting]::Indented
$tmpDoc.WriteContentTo($writer)
$sw.ToString() 
```

I used this script to write my generated XML into a TextBox in Windows Forms.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-26T06:04:40.987

一个更简单的版本：

```
[string]$outputString = $XmlObject.childNode.childNode.theElementValueIWant.ToString() 
```

XML 路径是您的源 XML 树结构来自`$XmlObject`.

所以如果你`$XmlObject`是：

```
<xmlRoot>
  <firstLevel>
    <secondLevel>
      <iWantThisValue>THE STRING I SEEK</iWantThisValue>
    </secondLevel>
  </firstLevel>
</xmlRoot> 
```

你会使用：

```
[string]$outputString = $XmlObject.firstLevel.secondLevel.iWantThisValue.ToString() 
```

# c# - 为枚举存储多个值

> ID：15410457
> 
> 赞同：1
> 
> 时间：2013-03-14T13:21:16.513
> 
> 标签：c#, enums

```
public enum ENUM_AccDebitCredit
{
    accDR = 1,
    accCR = 2
} 
```

我在一个类中声明为`public ENUM_AccDebitCreditDebitCredit { get; set; }`

在我的代码中，我尝试`enum`从数据表中填充它，如下所示

`DebitCredit = (ENUM_TransactionType)Enum.Parse(typeof(ENUM_TransactionType), rsACC_AccountingRules.Tables[0].Rows[0]["DR"].ToString()) & (ENUM_TransactionType)Enum.Parse(typeof(ENUM_TransactionType), rsACC_AccountingRules.Tables[0].Rows[0]["CR"].ToString());`

我想存储多个值`DebitCredit`，我该怎么做

我的数据表如下

```
DataTable table = new DataTable();
table.Columns.Add("Dosage", typeof(int));
table.Columns.Add("DR", typeof(string));
table.Columns.Add("CR", typeof(string));
table.Rows.Add(25, "1","2"); // enum values 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:23:33.193

您可以有一个集合`ENUM_TransactionType`或用于`[Flags]`将每个项目表示为一个位标志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:26:11.187

如果您的意思是希望*枚举*“混合”多于一个值，则需要将代码更改为：

```
[Flags]
public enum ENUM_TransactionType
{
   None = 0,
   ttSales = 1,
   ttPurchase = 2,
   ttReturnIn = 4
} 
```

此外，您需要使用按位 OR`|`运算符而不是 AND `&`：

```
ENUM_TransactionType value = ENUM_TransactionType.ttSales | ENUM_TransactionType.ttPurchase; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:26:56.503

关于您最近的编辑，以下是您的操作方式：

```
public enum ENUM_AccDebitCredit
{
    accDR = 1,
    accCR = 2
}

var type1 = (ENUM_AccDebitCredit)int.Parse(rsACC_AccountingRules.Tables[0].Rows[0]["DR"].ToString());

var type2 = (ENUM_AccDebitCredit)int.Parse(rsACC_AccountingRules.Tables[0].Rows[0]["CR"].ToString());

myClass.DebitCard = type1 | type2; 
```

您可以使用该`[Flags]`属性，也可以尝试以下操作：

```
public enum ENUM_TransactionType
{
    ttSales = 1,
    ttPurchase = 2,
    ttReturnIn = 4,
}

myClass.DebitCard = ENUM_TransactionType.ttSales | ENUM_TransactionType.ttReturnIn;

bool hasSales = myClass.DebitCard & ENUM_TransactionType.ttSales > 0; 
```

从`DataTable`你可以试试这个：

```
var type1 = (ENUM_TransactionType)Enum.Parse(typeof(ENUM_TransactionType), rsACC_AccountingRules.Tables[0].Rows[0]["Drug"].ToString());

var type2 = (ENUM_TransactionType)Enum.Parse(typeof(ENUM_TransactionType), rsACC_AccountingRules.Tables[0].Rows[0]["Drug1"].ToString());

myClass.DebitCard = type1 | type2; 
```

这是一个称为**位屏蔽**的过程。有关此过程背后的数学运算的更多信息，请参见此处：[位掩码](http://en.wikipedia.org/wiki/Mask_%28computing%29)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T13:38:50.977

```
var DebitCredit = new List<ENUM_TransactionType>();
DebitCredit.Add((ENUM_TransactionType)Enum.Parse(typeof(ENUM_TransactionType), rsACC_AccountingRules.Tables[0].Rows[0]["Drug"].ToString()));
DebitCredit.Add((ENUM_TransactionType)Enum.Parse(typeof(ENUM_TransactionType), rsACC_AccountingRules.Tables[0].Rows[0]["Drug1"].ToString())); 
```

然后你可以测试：

```
if (DebitCredit.Contains(ENUM_TransactionType.ttSales)) etc. 
```

# wcf - 具有 WCF 属性的实体框架 5.0 DBContext 模板支持

> ID：15410460
> 
> 赞同：6
> 
> 时间：2013-03-14T13:21:21.247
> 
> 标签：wcf, entity-framework-5, poco

我正在使用 VS 2010 中的 Entity Framewok 4.0 POCO 和 WCF 服务进行 Dot Net 项目。由于性能改进和表值函数支持，我将切换到 Ef 5.0 和 VS 2012。

但我搜索了很多，没有找到任何支持 DataContract 和 DataMember 属性的 poco 生成器模板或 DBcontext 生成器模板，可在 VS 2012 和 EF5.x 中使用。

```
[DataContract(IsReference = true)]
[KnownType(typeof(Transactions))]
public partial class Accounts 
  {
    [DataMember]
    public int AccountID { get; set; }

    [DataMember]
    public string AccountCode { get; set; }
  } 
```

我的问题是：

1-有没有人有这样的模板在 VS2012 中工作？

2-是否有人知道 EF 5.x DBContext 生成器中需要更改以自定义模板以支持 WCF 所需的属性。

我的时间很少，我真的需要帮助。

感谢您的任何帮助或指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-29T12:35:28.477

我使用 VS 2012 并下载了扩展“EF 5.x DbContext Generator with WCF support”，以生成已经用 WCF 属性修饰的 POCO 实体。

通过使用此上下文生成器，您无需进一步自定义模板。

![在此处输入图像描述](../Images/062cdbb75e1533e734bccc03ba3be399.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:49:35.523

you could simply add the needed attributes in a partial class implementation in another code file. Otherwise, you'll need to edit the .tt file. I suggest the former one usually does this anyway to use data annotations (i.e. MetadataTypeAttribute).

# c# - C# WPF 附加属性 - 错误：“XML 命名空间中不存在该属性”

> ID：15410463
> 
> 赞同：19
> 
> 时间：2013-03-14T13:21:24.783
> 
> 标签：c#, wpf, dependencies, dependency-properties, attached-properties

我需要为现有的 WPF 控件（组框、文本框、复选框等）创建一个新属性，该属性将存储其访问级别，因此我找到了附加属性。我以这个网站为例[http://dotnetbyexample.blogspot.com.br/2010/05/attached-dependency-properties-for.html](http://dotnetbyexample.blogspot.com.br/2010/05/attached-dependency-properties-for.html)

一切都很好，但是尝试在某些控件上使用它时出现以下错误...

> 错误 1 ​​XML 命名空间“clr-namespace:ImageGUI.App_Code;assembly=ImageGUI”中不存在属性“DependencyPropertiesHoster.AcessLevel”。第 131 行位置 97.ImageGUI\MainWindow.xaml 131 97 ImageGUI

这是我的 C# 代码片段...

```
namespace ImageGUI.App_Code
{    
    public static class DependencyPropertiesHoster
    {
        //[AttachedPropertyBrowsableForChildren]
        public static readonly DependencyProperty AcessLevelProperty =
            DependencyProperty.RegisterAttached(
                "AcessLevel",
                typeof(EAcessLevel),
                typeof(DependencyPropertiesHoster),
                new PropertyMetadata(AcessLevelChanged)
            );

        // Called when Property is retrieved
        public static EAcessLevel GetAcessLevel(DependencyObject obj)
        {
            if (obj != null)
                return (EAcessLevel)obj.GetValue(AcessLevelProperty);
            else
                return EAcessLevel.Client;
                //return obj.GetValue(AcessLevelProperty) as EAcessLevel;            
        }

        // Called when Property is set
        public static void SetAcessLevel(DependencyObject obj, EAcessLevel value)
        {
            obj.SetValue(AcessLevelProperty, value);
        }

        // Called when property is changed
        private static void AcessLevelChanged(object sender, DependencyPropertyChangedEventArgs args)
        {
            var attachedObject = sender as UIElement;
            if (attachedObject != null)
            {
                // do whatever is necessary, for example
                // attachedObject.CallSomeMethod(                 
                // args.NewValue as TargetPropertyType);
            }
        }
    }
} 
```

这是我在窗口的声明

```
xmlns:CustomDepen="clr-namespace:ImageGUI.App_Code;assembly=ImageGUI" 
```

这是我对该属性的使用（错误所在......）

```
<GroupBox Name="gbApplications" Header="{DynamicResource applications}" CustomDepen:DependencyPropertiesHoster.AcessLevel="Client"> 
```

观察：EAcessLevel 只是一个简单的枚举器。

提前致谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-07-09T16:53:38.773

感谢 Bob 和 Kent 的回答，这几乎解决了这个问题。在这种情况下，只需更改

```
xmlns:CustomDepen="clr-namespace:ImageGUI.App_Code;assembly=ImageGUI" 
```

到

```
xmlns:CustomDepen="clr-namespace:ImageGUI.App_Code" 
```

解决了这种情况。其他一切都是正确的。

关于我关于如何检索指定值的其他评论，它会是这样的：

```
EAcessLevel currentAcess = (EAcessLevel)gbApplications.GetValue(DependencyPropertiesHoster.AcessLevelProperty); 
```

谢谢，希望它对将来的人也有帮助。

# dynamics-crm-2011 - 用于 Outlook 电子邮件的 CRM 2011 - 相关链接如何工作？

> ID：15410464
> 
> 赞同：1
> 
> 时间：2013-03-14T13:21:31.047
> 
> 标签：dynamics-crm-2011, outlook-addin

此问题专门针对 Outlook 客户端的 CRM 2011。我们有通过工作流程发送给某些用户的电子邮件。所有电子邮件在工作流创建时都设置了相关字段。只有其中一些人在“CRM 窗格”中的电子邮件底部有可点击的链接。

谁能解释它是如何工作的？它仅适用于某些实体吗？实体是否必须启用电子邮件（即使我设置了相关字段）？

我真的找不到任何关于它是如何工作的解释。我只知道关于帐户的电子邮件有链接，而关于自定义实体的电子邮件没有。我还需要获取自定义实体电子邮件才能获得链接。

仅供参考，尽管我已经尝试过两种方式，但我将用户之间的跟踪电子邮件作为 2 个活动未选中。

# command-line - 从命令行启动 Instruments

> ID：15410465
> 
> 赞同：4
> 
> 时间：2013-03-14T13:21:31.217
> 
> 标签：command-line, instruments, ios-ui-automation

我跟着这个网站开始使用 UI 自动化。 [http://blog.manbolo.com/2012/04/08/ios-automated-tests-with-uiautomation#1.2](http://blog.manbolo.com/2012/04/08/ios-automated-tests-with-uiautomation#1.2)

我正在尝试从命令行启动 Instruments。不幸的是，我收到一个错误：

```
2013-03-14 14:06:36.376 instruments[17854:1207] Connection to the remote device lost while launching target. Aborting...
2013-03-14 14:06:36.378 instruments[17854:1207] Recording cancelled : At least one target failed to launch; aborting run
Instruments Trace Error : Failed to start trace. 
```

这是我使用的命令：

`instruments -w {deviceId} -t /Applications/Xcode.app/Contents/Applications/Instruments.app/Contents/PlugIns/AutomationInstrument.bundle/Contents/Resources/Automation.tracetemplate {appname} -e UIASCRIPT /Path/to/Script.js`

目前我正在使用 Xcode 4.6。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-09-20T22:34:27.293

在 2014 年的 Xcode 6.0.1 中，你会做这样的事情来在模拟器上运行 UIAutomation 测试，在 -w 开关之后命名你的模拟器：

```
instruments -t '/Applications/Xcode.app/Contents/Applications/Instruments.app/Contents/PlugIns/AutomationInstrument.xrplugin/Contents/Resources/Automation.tracetemplate' \
    -w 'iPhone 5s' \
    '/Users/sohail/Library/Developer/CoreSimulator/Devices/7232A640-A9D2-4626-A2AD-37AFFF706718/data/Containers/Bundle/Application/E71B915E-051D-4BEF-9083-34416D02EC91/RoadRunnerRadar.app' \
    -e UIASCRIPT '/Users/sohail/Developer/clients/acme/roadrunnerradar/ACMERoadRunnerRadarAutomationTests/TestRunner.js' \
    -e UIARESULTSPATH '/Users/sohail/Developer/clients/acme/roadrunnerradar/ACMERoadRunnerRadarAutomationTests/TestResults/' 
```

如果您想在您的设备上运行它，而不是像我在上面的代码段中用于在模拟器上运行的“iPhone 5s”，您需要提供设备的 UDID。然后，您可以省略我上面给出的长应用程序路径，只提供应用程序的名称。Instruments 将能够在设备上找到它。

使用上面的示例，但针对假设设备进行了修改，如下所示：

```
instruments -t '/Applications/Xcode.app/Contents/Applications/Instruments.app/Contents/PlugIns/AutomationInstrument.xrplugin/Contents/Resources/Automation.tracetemplate' \
    -w '8532A640-A9C2-4626-A2AD-37AFFF706799' \
    'RoadRunnerRadar' \
    -e UIASCRIPT '/Users/sohail/Developer/clients/acme/roadrunnerradar/ACMERoadRunnerRadarAutomationTests/TestRunner.js' \
    -e UIARESULTSPATH '/Users/sohail/Developer/clients/acme/roadrunnerradar/ACMERoadRunnerRadarAutomationTests/TestResults/' 
```

这未通过设备调用验证，因此请对其进行测试。参数排序有一点灵活性。

我确实有一个经过验证的[UI Automation Runner](http://sohail.io/2014/09/20/xcode-6-and-running-uiautomation-test-from-the-command-line/)脚本，它非常适用于 Xcode 6.0.1 和模拟器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-05T12:05:28.007

我遇到了同样的问题，我做了以下更改并且对我来说效果很好：

在给定命令中更改了 -w udid 的位置，将其放在 tracetemplate 的路径之后和应用程序的路径之前，即这应该就像

```
instruments -t /Applications/Xcode.app/Contents/Applications/Instruments.app/Contents/PlugIns/AutomationInstrument.bundle/Contents/Resources/Automation.tracetemplate -w {deviceId} {appname} -e UIASCRIPT /Path/to/Script.js 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-13T17:23:27.473

这对我有用。

我执行了`ps`命令来查看哪些进程正在运行。我发现仪器仍在运行。然后我做了`killall instruments`，这杀死了仪器进程。然后我做了我的仪器命令，之后它工作得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-18T17:14:47.177

尝试这个

```
instruments -t /Applications/Xcode.app/Contents/Applications/Instruments.app/Contents/PlugIns/AutomationInstrument.bundle/Contents/Resources/Automation.tracetemplate  <path to your app> -e UIASCRIPT /Users/t-rbudhbhatti/Desktop/Scripts/FT5/SearchByRoute.js -e UIARESULTSPATH /Users/t-rbudhbhatti/Desktop/Scripts/FT5/SearchByRouteResult 
```

而不是应用程序名称，您应该提供应用程序的完整路径。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-23T20:44:29.103

我建议您看一下 Jonathan 的屏幕射击游戏，他在以下网址进行了解释：[http](http://cocoamanifest.net/articles/2013/01/ui-screen-shooter.html) ://cocoamanifest.net/articles/2013/01/ui-screen-shooter.html 。这真的帮助我了解了很多关于模拟器、从命令行运行仪器等等的知识。就像 Jonathan 解释的那样，您需要先构建应用程序，然后才能运行一些东西。

在这里获取他的资源：[https](https://github.com/jonathanpenn/ui-screen-shooter) ://github.com/jonathanpenn/ui-screen-shooter看看这是否适合你。然后回到一个简单的脚本，该脚本将构建应用程序，将其放在方便的位置并使用应用程序和所需的模板运行仪器。

# firefox - Mediaelement.js Wordpress 插件 -- Firefox 不会加载 mp3 -- .htaccess MIMES 集

> ID：15410468
> 
> 赞同：1
> 
> 时间：2013-03-14T13:21:35.720
> 
> 标签：firefox, wordpress, mp3, mediaelement.js

在 Wordpress 3.51 上使用 MediaElement.js Wordpress 插件 2.10.3

场景：试图获得跨浏览器/平台的兼容性以提供播客 mp3 文件。订阅者（高级版）有一个最近 10 个播客的列表，他们可以收听（MediaElementJS 播放器的来源）或下载。

我正在使用 getElementById onclick 函数为每个 Listen 链接传递源 mp3 文件。我隐藏了加载了一个虚拟（静音）mp3 文件*的 MediaelementJS 播放器 div，当用户单击特定的 Listen 链接时，该 div（和播放器）变为可见，并且播放器中的源文件更新为他们想听的文件。***（我发现如果没有实际的 mp3 文件来源，我无法让播放器在我的页面上空着——甚至是隐藏的；因此，虚拟/静音文件。）

这在 Chrome、IE9、Safari 和我检查过的各种移动浏览器（Dolphin、默认浏览器和 Android 上的 Chrome）中完美运行。尚未检查 IOS，但希望它会工作。IE8 不工作（还），但我必须弄清楚。

**好的——问题——**

在 Firefox 上，我得到（通过 Firebug）不支持“audio/mpeg”的可怕的“HTTP”Content-Type。媒体资源（filename.mp3）的加载失败。” 我猜 Opera 会是一样的，但我还没有测试过。

正如标题中提到的，我确实在我的 Apache 服务器上正确设置了 .htaccess MIMES。我还没有重新启动 Apache，因为 .htaccess 编辑不需要重新启动，并且由于我无法进入这里的原因，即使暂时关闭站点也是不可取的——我只想说我只是众多用户之一。

这对我来说***将***是一个交易破坏者，因为我需要 Firefox 工作。奇怪的是，我看到 MediaElements.js 主页上的演示 mp3 加载正常，但这是使用完整的 js 代码，而不是插件。

我正在使用以下短代码参数：

[mejsaudio src='（我的虚拟 mp3 文件的名称/路径）' preload='auto' autoplay='true']

我尝试在简码中将“src=”更改为“mp3=”，但我的 getElementById 函数无法识别 mp3 参数。我还没有尝试使用 innerHTML 来更改参数。

我读过哪里有未记录的“模式”开关。我尝试将“mode = auto_plugins”添加到我的简码中，但没有任何反应。无论如何，我没有看到插件代码中检查了模式参数。

所以，不幸的是，这就是我所处的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T17:18:03.027

FireFox 不播放 Mp3。您必须在与 mp3 文件名相同的文件夹中加载 .ogg 文件。显然，将 mp3 留给其他浏览器使用。

您可以在此处将 mp3 转换为 ogg... [http://audio.online-convert.com/convert-to-ogg](http://audio.online-convert.com/convert-to-ogg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T13:43:05.437

好的，这不仅仅是一个 WordPress 问题。这还不止于此。

在 Firefox 和 Opera 中，视频上的 Flash 后备被破坏，声称在尝试与支持 Internet 的位置通信时存在空变量。版本 2.11.0 提供的演示会发生这种情况。

至于 MP3，它们根本就没有出现。玩家的控制栏根本不会出现。没有控制栏，您将无法启动播放器。我没有测试自动启动，但我不希望媒体自动启动，所以这对我没有帮助。

什么时候会解决这个问题？

# c# - 以下代码中受保护的内部访问说明符的意义

> ID：15410472
> 
> 赞同：4
> 
> 时间：2013-03-14T13:21:57.750
> 
> 标签：c#, asp.net, protected, access-modifiers

好的，让我从一个例子开始。这是我在另一个程序集中的基类

```
namespace BL
{
    public class BasicClass
    {
        protected internal void func()
        {
            //Code Logic
        }
    }
} 
```

现在这是我在另一个程序集中的派生类

```
namespace DL
{
    public class DerivedClass:BasicClass
    {
        private void hello()
        {
            func();
        }
    }
} 
```

我可以`func()`从基类调用，因此它显示了`protected` 访问修饰符属性，但是`internal`访问修饰符属性呢？应该允许它`func()`在另一个程序集内访问，因为它声明为内部的。如果是这样，那么为什么要调用它`protected internal`而不是简单`protected`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T13:24:54.930

[你可能](http://msdn.microsoft.com/en-GB/library/ms173121.aspx#alert_note)想读一读。

> 受保护的内部可访问性级别意味着受保护的 OR 内部，而不是受保护的 AND 内部。换句话说，可以从同一程序集中的任何类访问受保护的内部成员，包括派生类。要限制对同一程序集中的派生类的可访问性，请将类本身声明为内部的，并将其成员声明为受保护的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-14T13:24:42.070

`Internal`表示该类的成员对同一程序集中的所有类均可用，但对程序集外的任何类均不可用。`Protected internal`表示 , 成员可以被同一程序集中的任何*类*和任何其他程序集中的任何子类访问。

[MSDN 关于访问修饰符](http://msdn.microsoft.com/en-us/library/ms173121.aspx)的主题供参考：

> **受保护的内部**
> 
> 类型或成员可以被声明它的程序集中的任何代码访问，也可以从另一个程序集中的派生类中访问。来自另一个程序集的访问必须在派生自声明受保护内部元素的类的类声明中进行，并且必须通过派生类类型的实例进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:32:17.490

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms173121.aspx)（单击以获取更多信息）：

**受保护**：

类型或成员只能由同一类或结构中的代码或派生类中的代码访问。

**内部**：

类型或成员可以由同一程序集中的任何代码访问，但不能从另一个程序集中访问。

**受保护的内部**：

同一程序集中的任何代码或另一个程序集中的任何派生类都可以访问该类型或成员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T10:14:55.713

“当受保护的内部的“内部”根本没有意义时，像受保护的内部这样的东西有什么用”：

在 Assembly BL, Class X 中，您可以直接使用 new BasicClass().func()，因为您设置了“内部”标志。如果未设置此标志，则类 X 需要从 BasicClass 派生才能访问 func()。

# asp.net-mvc - 数据类型编辑器模板不适用于创建的 DOM 元素

> ID：15410475
> 
> 赞同：0
> 
> 时间：2013-03-14T13:22:12.030
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework

我有一个用于编辑课程的页面。在此页面上有一个部分，您可以在该部分中动态添加和删除页面上的类事件。我的问题是在本节中出现的一件事是约会。我只想显示日期部分而不是时间。这是为实体框架设置的类。

```
public class ClassEvent
{
    public ClassEvent()
    {
        EventDate = DateTime.Today;
    }
    [HiddenInput(DisplayValue = false)]
    public int ID { get; set; }

    public string Description { get; set; }

    [DataType(DataType.Date)]
    [Display(Name = "Date")]
    public DateTime? EventDate { get; set; }

    [HiddenInput(DisplayValue = false)]
    [Required(ErrorMessage = "Please select a class")]
    public int ClassID { get; set; }

    [Display(Name = "Class")]
    [ForeignKey("ClassID")]
    public virtual ScheduledClass ScheduledClass { get; set; }

    public Boolean Delete { get; set; }
} 
```

我将此代码用作日期时间对象的编辑器模板。

```
@inherits System.Web.Mvc.WebViewPage<System.DateTime?> 

@Html.TextBox("", String.Format("{0:d}", Model.HasValue ? Model.Value.ToString("MM/dd/yyyy") :""), new { @class = "datefield", style="width:100px"}) 
```

我在实际的 scheduleclass 类中有另一个字段，如下所示

```
public class ScheduledClass
{
    public ScheduledClass()
    {
        Attendees = new List<ClassAttendee>();
    }

    [HiddenInput(DisplayValue = false)]
    public int ID { get; set; }

    [HiddenInput(DisplayValue = false)]
    [Required(ErrorMessage = "Please enter a topic")]
    public int ClassTopicID { get; set; }

    [Display(Name = "Topic")]
    public virtual ClassTopic ClassTopic { get; set; }

    [HiddenInput(DisplayValue = false)]
    public int ClassTypeID { get; set; }

    [Display(Name = "Class Type")]
    public virtual ClassType ClassType { get; set; }

    [Required]
    [DataType(DataType.Date)]
    [Display(Name = "Class Date")] 
    public DateTime ClassDate { get; set; }

    [Display(Name = "Attendees")] 
    public virtual ICollection<ClassAttendee> Attendees { get; set; }

    [Display(Name = "Events")]
    public virtual ICollection<ClassEvent> ClassEvents { get; set; }
} 
```

加载页面时，编辑器模板适用于 ClassDate，但在页面中，如果我单击按钮添加类事件，则编辑器模板不会应用于创建的内容。这是 ClassEvent 本身的编辑器模板

```
@model TRIOSoftware.Domain.Entities.ClassEvent

<tr class="ClassEvent">
<td>
    @Html.HiddenFor(model => model.ID)
    @Html.HiddenFor(model => model.ClassID )
    @Html.TextBoxFor(model => model.Description, new {style ="width:125px"})
    @Html.ValidationMessageFor(model => model.Description)
</td>
<td>    
    @Html.TextBoxFor(model => model.EventDate, new { @class = "datefield", style = "width:150px" })
    @Html.ValidationMessageFor(model => model.EventDate)
</td>
<td>
    @Html.HiddenFor(x => x.Delete, new { @class = "mark-for-delete" })
    @Html.LinkToRemoveNestedForm("Remove", "tr.ClassEvent", "input.mark-for-delete")
</td>
</tr> 
```

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T16:24:23.277

问题最终是我使用 TextBoxFor 并且我需要使用 EditorFor 才能找到我的编辑器模板

# python - Json Twitter 搜索 - 如何

> ID：15410478
> 
> 赞同：0
> 
> 时间：2013-03-14T13:22:16.890
> 
> 标签：python, json, twitter

我正在尝试从`u'text':`&`u'id':`中找到的字符串创建字符串，`u'results':`以便我可以将新的 ID 与最后一个读取的 ID 进行比较，如果它是新的，则显示文本。我目前无法仅解析（？）我想要的信息。

```
import json
import urllib
from pprint import pprint
j =json.loads(urllib.urlopen('http://search.twitter.com/search.json?q=%23tory&result_type=recent&rpp=1').read())
pprint(j) 
```

这给了我

```
{u'completed_in': 0.007,
 u'max_id': 312184292639920129L,
 u'max_id_str': u'312184292639920129',
 u'next_page': u'?page=2&max_id=312184292639920129&q=%23tory&rpp=1&result_type=recent',
 u'page': 1,
 u'query': u'%23tory',
 u'refresh_url': u'?since_id=312184292639920129&q=%23tory&result_type=recent',
 u'results': [{u'created_at': u'Thu, 14 Mar 2013 12:51:50 +0000',
               u'from_user': u'DerbysLabour',
               u'from_user_id': 393219652,
               u'from_user_id_str': u'393219652',
               u'from_user_name': u'Derbyshire Labour',
               u'geo': None,
               u'id': 312184292639920129L,
               u'id_str': u'312184292639920129',
               u'iso_language_code': u'en',
               u'metadata': {u'result_type': u'recent'},
               u'profile_image_url': u'http://a0.twimg.com/profile_images/1594091282/Labour_group_normal.jpg',
               u'profile_image_url_https': u'https://si0.twimg.com/profile_images/1594091282/Labour_group_normal.jpg',
               u'source': u'&lt;a href=&quot;http://twitter.com/&quot;&gt;web&lt;/a&gt;',
               u'text': u'RT @WubeyOneKenobi: Not seen a single #Tory campaigning for #DCC elections round #Glossop yet.  Scared to come out?'}],
 u'results_per_page': 1,
 u'since_id': 0,
 u'since_id_str': u'0'} 
```

作为回报（取决于推文）

我们如何仅从结果中读取文本和 ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:32:08.333

`j`变量是 a `dict`，并且是一个包含 a的`results`数组`dict`。您可以像这样提取值：

```
text = j['results'][0]['text']
id = j['results'][0]['id'] 
```

如果您有更多结果，您可以执行以下操作：

```
texts = {}
results = j['results']

for result in results:
    text = result['text']
    id = results['id']
    texts[id] = text 
```

结果，您有一个`dict`调用`texts`，其中 id 是键。

# ajax - JSF ajax 从下拉列表中重新加载整个页面

> ID：15410486
> 
> 赞同：3
> 
> 时间：2013-03-14T13:22:39.400
> 
> 标签：ajax, jsf, drop-down-menu

```
<h:selectOneMenu id="dropdownDevice"
        value="#{skinningBean.currentDevice}" converter="SkinConverter">
        <f:selectItems value="#{skinningBean.myDevicesSI}" var="c"
            itemValue="#{c}" />
        <f:ajax event="change" render="preview" />
</h:selectOneMenu> 
```

是否可以在此下拉列表中重新加载整个页面？我需要这个，因为，选择另一台设备时，我还需要重新加载JavaScript。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-14T13:25:20.093

您不清楚是否要同步或异步执行它。

如果是异步的，请指定`@all`.

```
<f:ajax ... render="@all" /> 
```

如果是同步的，用`<f:ajax>`JS`form.submit()`调用替换。

```
<h:selectOneMenu ... onchange="this.form.submit()"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:25:02.200

您可以通过在标签中设置`render="@all"`属性来简单地做到这一点：`f:ajax`

```
<f:ajax render="@all" /> 
```

您可以删除`event="change"`，因为它是默认的。

# asp.net-mvc-3 - MVC3 & Bootstrap - 在显示 Bootstrap 模态之前执行函数

> ID：15410487
> 
> 赞同：0
> 
> 时间：2013-03-14T13:22:42.927
> 
> 标签：asp.net-mvc-3, post, twitter-bootstrap, modal-dialog

我是MVC3的新手。我的“编辑”视图上有一个 [生成密码] 按钮。我需要执行在“Admin”控制器中定义的函数 GeneratePsw()，该函数在显示包含 GeneratePsw() 返回的值的模式之前返回一个字符串。

我还尝试将值放在 ViewBag.pwd 中，而不是将其返回并从模态中读取。没有成功

换句话说：

用户确实单击`[Generate Password]`按钮。然后`GeneratePsw()`调用并返回一个字符串。Bootstrap 模式应该会自动出现，并在标签中显示该值。

在我看来.....

```
<a href="#1" role="button" class="btn btn-primary btn-small" data-toggle="modal" onclick="location.href='@Url.Action("GeneratePsw", "Admin")';return false;"><i class="icon-lock icon-white"></i> Generate Password</a>

</div>

<div id="1" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<div class="modal-header">
   <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
         <h3 id="myModalLabel">Password generated</h3>
 </div>
 <div class="modal-body">
      <p><strong>Password: @(ViewBag.pwd)</strong></p>
  </div>
  <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">OK</button>

  </div>
</div>

</td> 
```

我的 GeneratePsw() 函数：

```
[HttpPost]
public ActionResult GeneratePsw()
{

    HomeBridgeEntities ddbb = new HomeBridgeEntities();
    SqlConnection Cn = new SqlConnection(((System.Data.EntityClient.EntityConnection)ddbb.Connection).StoreConnection.ConnectionString);
    SupPassGenerator sup = new SupPassGenerator(Cn);

    string psw = sup.CreateRandomPassword(9);

    ViewBag.psw = psw;

    return RedirectToAction("Edit");

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:34:40.857

所以我的理解是你想作为一个ajax调用来做这个？即不重新加载整个页面？我还假设您使用的是 jQuery？

您可以通过回发到返回 JSON 的控制器来做到这一点。这可能是最简单的取回方法：

控制器：

```
public ActionResult GeneratePsw()
{
    ...
    string psw = sup.CreateRandomPassword(9);
    var json = new { password = psw };
    return Json(json);
} 
```

页面上的js：

```
$('#yourgeneratebutton').on('click', function() {
  $.getJSON('YourController/GeneratePsw', function(data) {
      $('#yourpasswordp').text(data.password);
      $('#1').modal('show');
   }); 
```

注意，我使用的是`getJSON`，所以你不能用`HttpPost`. （无论如何，您都没有发布任何数据？您要么必须更改 http 属性，要么`$.post`改用它。这也完全未经测试，只是一个粗略的指南。

或者，一种替代方法可能是返回一个包含模态内容的局部视图，然后显示它。

# c++ - 使用opencv时出错

> ID：15410496
> 
> 赞同：1
> 
> 时间：2013-03-14T13:23:05.477
> 
> 标签：c++, visual-c++, opencv

我在调试我的程序时遇到问题

> 致命错误 LNK1104：无法打开文件 'cv210d.lib'

我尝试了教程中所述的所有内容以及本网站和其他网站中描述的所有解决方案

我使用**了 opencv 2.1.0**和**Visual Studio 2008**

我尝试在**调试**和**发布中使用****cv210.lib**

 ****我尝试在**调试**中使用**cv210d.lib** ，在**发布中使用****cv210.lib**

 ******我尝试改变环境变量

和其他解决方案，但出现同样的问题

我在**opencv**文件夹中搜索了**cv210.lib**但它不存在

 **我的项目需要它，所以你能帮我解决这个问题吗？************

# javascript - 从字符串数组中删除一个字符串

> ID：15410504
> 
> 赞同：0
> 
> 时间：2013-03-14T13:23:29.280
> 
> 标签：javascript, arrays, splice, array-splice

我是 JavaScript 的初学者。

我有一个这样的字符串数组：123,432,123,543,123,123

我想从此字符串中删除 3dr 编号。

我发现以下函数可以从字符串数组中删除文本值，但它不适用于其中包含重复值的数组。

```
Array.prototype.removeByValue = function (val) {

    for (var i = 0; i < this.length; i++) {
        if (this[i] == val) {
            this.splice(i, 1);
            break;
        }
    }
} 
```

任何解决此问题的建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:28:11.933

你可以使用过滤器：

```
var ary = ['three', 'seven', 'eleven'];

ary = ary.filter(function(v) {
    return v !== 'seven';
}); 
```

并扩展你的数组

```
Array.prototype.remove = function(value) {
    return ary.filter(function(v) {
        return v != value;
    });

}

var ary = ['three', 'seven', 'eleven'];
ary = ary.remove('seven'),
console.log(ary) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:41:22.243

那就继续吧：

```
Array.prototype.removeByValue = function (val) {

    for (var i = 0; i < this.length; i++) {
        if (this[i] == val) {
            this.splice(i, 1); 
            i--; //Decrement after removing
            //No break
        }
    }
} 
```

更惯用的方式是`this.splice(i--, 1)`，但这应该更清楚它们发生的顺序。

```
var a = [1,2,1,1,2,2];
a.removeByValue(1);
a; //[2, 2, 2] 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-16T11:19:17.887

为了解决这个问题，我为每个元素添加了一个唯一的 ID，例如 {A1;123,A2;432,A3;123,A4;543,A5;123,A6;123}相同功能更容易。

# c# - Visual Studio 不会因抛出异常而停止

> ID：15410505
> 
> 赞同：2
> 
> 时间：2013-03-14T13:23:31.130
> 
> 标签：c#

当我有以下代码时：

```
public class Entry
{
    public void Main()
    {
        var p = new Class1();
    }
}

public class Class1
{
    public Class1()
    {
        DoSomething();
    }

    private void DoSomething()
    {
        try
        {
            CallToMethodWhichThrowsAnyException()
        }
        catch (Exception ex)
        {
            throw new CustomException(ex.Message); // where CustomException is simple System.Exception inherited class
        }
    }
} 
```

为什么我的 CustomException 没有被抛出并停止在 Entry.Main 或 Class1 的构造函数（或我的 DoSomething 方法）中的调试执行？

即时窗口中只有消息`A first chance exception of type 'MyLibrary.CustomException' occurred in MyLibrary.dll`。

Visual Studio 的异常设置设置为仅在用户未处理时引发所有 CLR 异常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:38:16.333

第一次机会异常消息的意思就是它所说的，[第一次机会异常](http://blogs.msdn.com/b/davidklinems/archive/2005/07/12/438061.aspx)。

在您的情况下，这很可能意味着您将调试器配置为不会在此类异常上停止。由于这是自定义异常类型，因此这是默认行为。

要在第一次机会异常时启用中断，请转到`Debug -> Exceptions`并选择您希望调试器中断的异常类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:29:37.563

这`A first chance exception`意味着某些方法引发了异常。现在您的代码有机会处理它。

似乎它`CallToMethodWhichThrowsAnyException`已经在处理`CustomException`从它内部的某个地方抛出，这就是你没有抓住它的原因。

此外，在重新抛出时，您应该将原始异常包装起来，以免堆栈跟踪信息丢失：

```
 catch (Exception ex)
    {
        throw new CustomException(ex.Message, ex); // notice the second argument
    } 
```

# reporting-services - 以 CSV 导出格式填充表名称而不是表值 - SSRS 2005

> ID：15410508
> 
> 赞同：0
> 
> 时间：2013-03-14T13:23:35.323
> 
> 标签：reporting-services, reportingservices-2005, export-to-csv

SSRS 2005 出口问题

当“无数据” - 在 CSV 导出格式 - 表格名称中，填充文本框名称而不是表格值，文本框值。

我浏览并找到了一些解决方案，但它无济于事。

我所做的更改：在 Table 属性中，设置了

```
DataElementName is Empty,DataElementOutput is Output, DetailDataElementOutput is Output 
```

***注意：所有其他导出格式和报告输出看起来不错***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T10:21:18.847

可能您可以尝试将 DataElementOutput 用作 AUTO 并检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T12:02:37.623

最后我得到了解决方案：

是的，当我们有“无搜索结果”时，我们会将 tableName 和 textBoxName 放入 CSV 导出文件中。

请找到以下步骤来解决上述问题

第 1 步：将以下行添加到 Result SP 或 Select Query

```
 -- Ur final Select Code
   UNION ALL    
        -- You can add n number of NULL select value it depends on how much you return 
    SELECT NULL,NULL,'---EOF---',NULL,NULL 
```

第2步：将表格中的所有文本框名称重命名为相关标题名称

> 例如：S NO 到 S_No，表名到 Table_Name

由于导出为 CSV，您可以看到有效数据。

我按照上述步骤解决了我的查询。

谢谢

# java - 在Java中将持续时间字符串转换为毫秒

> ID：15410512
> 
> 赞同：4
> 
> 时间：2013-03-14T13:23:45.733
> 
> 标签：java, duration, milliseconds

如果这已经被讨论过，我很抱歉。

我在字符串中有一个剪辑持续时间：

```
00:10:17 
```

我想以毫秒为单位将其转换为值。（上面的字符串基本上是617000）

是否有一些 API 可以通过一两个步骤来完成。基本方法是拆分字符串，然后添加分钟、秒和小时。

但是有没有更短的方法来做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-14T13:29:28.243

这是一种自己编写的可能方法（始终假设相同的源格式）

```
String source = "00:10:17";
String[] tokens = source.split(":");
int secondsToMs = Integer.parseInt(tokens[2]) * 1000;
int minutesToMs = Integer.parseInt(tokens[1]) * 60000;
int hoursToMs = Integer.parseInt(tokens[0]) * 3600000;
long total = secondsToMs + minutesToMs + hoursToMs; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-14T13:29:02.713

您可以简单地手动解析它：

```
String s = "00:10:17";
String[] data = s.split(":");

int hours  = Integer.parseInt(data[0]);
int minutes = Integer.parseInt(data[1]);
int seconds = Integer.parseInt(data[2]);

int time = seconds + 60 * minutes + 3600 * hours;
System.out.println("time in millis = " + TimeUnit.MILLISECONDS.convert(time, TimeUnit.SECONDS)); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-01-03T22:36:19.960

# `java.time.Duration`

使用[`Duration`](http://docs.oracle.com/javase/8/docs/api/java/time/Duration.html)类。

```
Duration.between( 
    LocalTime.MIN , 
    LocalTime.parse( "00:10:17" ) 
).toMillis() 
```

> 毫秒：617000

[在 IdeOne.com 中](http://ideone.com/UxM90y)查看此代码。

有关、 和 java.time的更多解释，请参阅我的这个答案和我对类似问题的[这个](https://stackoverflow.com/a/41453329/642706)答案[。](https://stackoverflow.com/a/41452921/642706)`Duration``LocalTime`

**警告：**从java.time 对象中的可能值 nanoseconds 转换为所需的 milliseconds 时，请注意可能的[数据](https://en.wikipedia.org/wiki/Nanosecond)[丢失](https://en.wikipedia.org/wiki/Millisecond)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-11-02T16:34:15.053

持续时间是否包括小时或分钟或秒或没有都没有关系。

```
 public static long durationToMillis(String duration) {
    String[] parts = duration.split(":");
    long result = 0;
    for (int i = parts.length - 1, j = 1000; i >= 0; i--, j *= 60) {
        try {
            result += Integer.parseInt(parts[i]) * j;
        } catch (NumberFormatException ignored) {
        }
    }
    return result;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-01-19T15:38:15.003

您可以使用[`java.time.Duration`](https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html)它以[ISO-8601 标准](https://en.wikipedia.org/wiki/ISO_8601)为模型，并作为[JSR-310 实现](https://jcp.org/aboutJava/communityprocess/pfd/jsr310/JSR-310-guide.html)的一部分与*Java-8*一起引入。

**演示：**

```
import java.time.Duration;
import java.util.Arrays;

public class Main {
    public static void main(String[] args) {
        String strDuration = "00:10:17";
        int[] parts = Arrays.stream(strDuration.split(":"))
                            .mapToInt(Integer::parseInt)
                            .toArray();

        Duration duration = Duration.ZERO;
        long millis = 0;

        if (parts.length == 3) {
            millis = duration.plusHours(parts[0])
                                .plusMinutes(parts[1])
                                .plusSeconds(parts[2])
                                .toMillis();
        }

        System.out.println(millis);
    }
} 
```

**输出：**

```
617000 
```

**注意：**我使用`Stream`API`String[]`将`int[]`. 您可以在不使用`Stream`API 的情况下执行此操作，如下所示：

```
String strDuration = "00:10:17";
String[] strParts = strDuration.split(":");
int[] parts = new int[strParts.length];
for (int i = 0; i < strParts.length; i++) {
    parts[i] = Integer.parseInt(strParts[i]);
} 
```

*或者*，您可以在将它们添加到时解析这些部分，`Duration`如下所示：

```
import java.time.Duration;

public class Main {
    public static void main(String[] args) {
        String strDuration = "00:10:17";
        String[] parts = strDuration.split(":");

        Duration duration = Duration.ZERO;
        long millis = 0;

        if (parts.length == 3) {
            millis = duration.plusHours(Integer.parseInt(parts[0]))
                                .plusMinutes(Integer.parseInt(parts[1]))
                                .plusSeconds(Integer.parseInt(parts[2]))
                                .toMillis();
        }

        System.out.println(millis);
    }
} 
```

**输出：**

```
617000 
```

**[从Trail: Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html)**了解现代日期时间 API 。

1.  出于任何原因，如果您必须坚持使用 Java 6 或 Java 7，您可以使用[***ThreeTen-Backport，***](http://www.threeten.org/threetenbp/)它将大部分*java.time*功能向后移植到 Java 6 和 7。
2.  如果您正在为一个 Android 项目工作并且您的 Android API 级别仍然不符合 Java-8，请通过 desugaring和[How to use ThreeTenABP in Android Project检查](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)[Java 8+ APIs available](https://developer.android.com/studio/write/java8-support-table)。

**Java `Stream`API 的一些很棒的教程：**

1.  [使用 Java SE 8 流处理数据，第 1 部分](https://www.oracle.com/technical-resources/articles/java/ma14-java-se-8-streams.html)
2.  [第 2 部分：使用 Java SE 8 流处理数据](https://www.oracle.com/technical-resources/articles/java/architect-streams-pt2.html)
3.  [课程：聚合操作](https://docs.oracle.com/javase/tutorial/collections/streams/index.html)
4.  [减少](https://docs.oracle.com/javase/tutorial/collections/streams/reduction.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-14T13:26:46.363

查看[Joda Time](http://joda-time.sourceforge.net/) [Duration](http://joda-time.sourceforge.net/key_duration.html)课程。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-14T13:28:03.790

创建一个适当的`DateFormat`. 使用`parse()`方法得到一个`Date`. `getTime()`在对象上使用`Date`以获取毫秒。

你可以[在这里查看](https://stackoverflow.com/questions/8826270/how-to-convert-hhmmss-sss-to-milliseconds)。

我只是将其测试为：

```
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.TimeZone;

public class Test {        
    public static void main(String[] args) throws Exception {
        SimpleDateFormat sdf = new SimpleDateFormat("HH:mm:ss");
        sdf.setTimeZone(TimeZone.getTimeZone("UTC"));

        String inputString = "00:10:17";

        Date date = sdf .parse(inputString);// .parse("1970-01-01" + inputString);
        System.out.println("in milliseconds: " + date.getTime());        
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-21T05:12:28.413

一个重复的问题（底部的链接）询问了一个没有秒的字符串`HH:MM`，例如`25:25`，使用 Java 7。我仍然推荐`Duration`java.time 类，现代 Java 日期和时间 API。java.time 已被向后移植到 Java 6 和 7。有了它，有很多方法可以走。将 Basil Bourque 和 Live and Let Live 的一个很好的答案改编成一个字符串很简单，无需几秒钟。我正在展示一种方法。

```
 String durationString = "25:25"; // HH:MM, so 25 hours 25 minutes
    String isoDurationString
            = durationString.replaceFirst("^(\\d+):(\\d{2})$", "PT$1H$2M");
    long durationMilliseconds = Duration.parse(isoDurationString).toMillis();
    System.out.format(Locale.US, "%,d milliseconds%n", durationMilliseconds); 
```

在 Java 1.7.0_67 上运行时的输出：

> 91,500,000 毫秒

`Duration.parse()`仅接受 ISO 8601 格式，例如`PT25T25M`. 想想一段 25 小时 25 分钟的时间。因此，我使用正则表达式将您拥有的字符串转换为所需的格式。

这种方法的一个限制（与其他一些方法共有的限制）是验证效果不佳。我们希望拒绝大于 59 的分钟数，但`Duration.parse()`接受它们。

## 问题：您是否声称它可以在 Java 1.7 上运行？

是的，java.time 至少需要**Java 1.6**。

*   在 Java 8 及更高版本以及更新的 Android 设备（从 API 级别 26 开始）中，现代 API 是内置的。
*   在非 Android Java 6 和 7 中获得 ThreeTen Backport，现代类的后向端口（ThreeTen 用于 JSR 310；请参阅底部的链接）。
*   在较旧的 Android 上，要么使用脱糖，要么使用 ThreeTen Backport 的 Android 版本。它被称为 ThreeTenABP。在后一种情况下，请确保您从`org.threeten.bp`子包中导入日期和时间类。

## 链接

*   [重复问题：Java 将时间字符串转换为毫秒 [重复]](https://stackoverflow.com/questions/65792937/java-convert-time-string-to-milliseconds)
*   [Oracle 教程：日期时间](https://docs.oracle.com/javase/tutorial/datetime/)解释如何使用 java.time。
*   使用 java.time 的其他答案
    *   [Basil Bourque 的回答](https://stackoverflow.com/a/41453448/5772882)转换通过`LocalTime`，一个可以工作长达 23 小时 59 分钟的 hack，并且确实验证了分钟不超过 59。
    *   [通过 Live 回答，让 Live](https://stackoverflow.com/a/65794686/5772882)解析每个整数并组装成`Duration`.
*   [Java 规范请求 (JSR) 310](https://jcp.org/en/jsr/detail?id=310)，`java.time`第一次描述的地方。
*   [ThreeTen Backport 项目](http://www.threeten.org/threetenbp/)，`java.time`Java 6 和 7 的反向移植（ThreeTen for JSR-310）。
*   [可通过脱糖获得 Java 8+ API](https://developer.android.com/studio/write/java8-support-table)
*   [ThreeTenABP](https://github.com/JakeWharton/ThreeTenABP) , ThreeTen Backport 的 Android 版
*   [问题：如何在Android项目中使用ThreeTenABP](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)，有非常详尽的解释。
*   [维基百科文章：ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)

# algorithm - 5 个数字的总和 = 100

> ID：15410515
> 
> 赞同：0
> 
> 时间：2013-03-14T13:24:00.807
> 
> 标签：algorithm, language-agnostic, logic

所以，给你 10 个数字，你应该从中选择 5 个数字，这样总和就是 100。

现在，我显然尝试使用程序来解决它，并通过五个循环得到了明显的解决方案。但我只是想知道有没有有效的方法来做到这一点？

这是明显的先生：

```
 static void Main(string[] args)
        {
            int[] a = { 2, 6, 10, 14, 18, 22, 26, 30, 34, 38 };
            for (int f = 0; f < a.Length - 4; f++)
            {
                for (int s = f+1; s < a.Length - 3; s++)
                {
                    for (int t = s+1; t < a.Length - 2; t++)
                    {
                        for (int fr = t + 1; fr < a.Length - 1; fr++)
                        {
                            for (int ft = fr + 1; ft < a.Length; ft++)
                            {
                                int sum = a[f] + a[s] + a[t] + a[fr] + a[ft];
                                Console.WriteLine(sum);
                                if (sum == 100)
                                {
                                    Console.WriteLine("---------------------------------------");
                                    Console.WriteLine(a[f]);
                                    Console.WriteLine(a[s]);
                                    Console.WriteLine(a[t]);
                                    Console.WriteLine(a[fr]);
                                    Console.WriteLine(a[ft]);
                                    Console.WriteLine("---------------------------------------");
                                }
                            }

                        }
                    }
                }
            }
            Console.ReadLine();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:31:27.523

您可以使用组合。看看这个问题： [create all possible k combination of n items in C++](https://stackoverflow.com/questions/12991758/creating-all-possible-k-combinations-of-n-items-in-c)

在这种情况下，您有 n 个数字和 k 个数字**索引**可供选择。

这应该会减少迭代次数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:30:01.817

这里有一些优化的想法：

*   如果所有数字都是正数，您可以跳过内部循环，总和已经 >= 100
*   您可以通过计算每个循环中的部分和来减少计算（运行内部循环时外部循环的值不会改变）。
*   只计算`a.Length`一次并存储它，因为这个值永远不会改变

    ```
    static void Main(string[] args)
    {
        int[] a = { 2, 6, 10, 14, 18, 22, 26, 30, 34, 38 };
        int lenA=a.Length;
        int alenMinus4=lenA-4,
        int alenMinus3=lenA-3,
        int alenMinus2=lenA-2,
        int alenMinus1=lenA-1,

        for (int f = 0; f < alenMinus4; f++)
        {   int sum1=a[f];
            if(sum1>100)
            { f=alenMinus4;
            }
            else
            {   for (int s = f+1; s < alenMinus3; s++)
                {   int sum2=sum1+ a[s];
                    if(sum2>100)
                    { s=alenMinus3;
                    }
                    else
                    {   for (int t = s+1; t < alenMinus2; t++)
                        {   int sum3=sum2+ a[t];
                            if(sum3>100)
                            { t=alenMinus2;
                            }
                            else
                            {   for (int fr = t + 1; fr < alenMinus1; fr++)
                                {   int sum4=sum3+ a[fr];
                                    if(sum4>100)
                                    { fr=alenMinus1;
                                    }
                                    else
                                    {  for (int ft = fr + 1; ft < lenA; ft++)
                                        {   int sum = sum4 + a[ft];
                                            Console.WriteLine(sum);
                                            if (sum == 100)
                                            {   Console.WriteLine("---------------------------------------");       
                                                Console.WriteLine(a[f]);
                                                Console.WriteLine(a[s]);
                                                Console.WriteLine(a[t]);
                                                Console.WriteLine(a[fr]);
                                                Console.WriteLine(a[ft]);
                                                Console.WriteLine("---------------------------------------");
        }   }   }   }   }   }   }   }   }   }
        Console.ReadLine();
    } 
    ```

# rss - iTunes Connect：如何使用 RSS 阅读器/聚合器跟踪（正确）评论？

> ID：15410517
> 
> 赞同：0
> 
> 时间：2013-03-14T13:24:03.387
> 
> 标签：rss, app-store, app-store-connect, rating, review

在 Itunes Connect 中，每个应用程序都有一个 RSS url（如[https://itunes.apple.com/cn/rss/customerreviews/id=XXXXXXXXX/sortBy=mostRecent/xml?l=fr](https://itunes.apple.com/cn/rss/customerreviews/id=XXXXXXXXX/sortBy=mostRecent/xml?l=fr)）来跟踪用户评论。我将此 URL 复制/粘贴到我的不同阅读器（如 Google Reader 或 Feedly）中，但问题是这些阅读器显示的是用户的标题和评论，而不是评分（星号）！这真的很烦人......

我想将我所有应用程序的 RSS url 复制/粘贴到一个阅读器中，该阅读器也显示评级（否则这个 RSS 东西是无用的）。有人设法做到这一点吗？

最好的办法是该阅读器还将用户评论翻译成我的语言。

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T18:50:28.913

虽然星星不会出现在标准的 RSS 标签中，但它们会出现在“im:rating”标签中。

# android - Android Google Maps V2，MapView 导致 NullPointerException

> ID：15410519
> 
> 赞同：0
> 
> 时间：2013-03-14T13:24:07.343
> 
> 标签：android, google-maps, google-maps-android-api-2

注意：我不想使用 MapFragment，因为我需要覆盖 MapView 中的一个方法！

我使用以下代码来显示我的 MapView：

```
mapView = (MapView) view.findViewById(R.id.map);
mapView.onCreate(null);
mapView.onResume(); 
```

使用此 xml：

```
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <com.google.android.gms.maps.MapView.MapView
        android:id="@+id/map"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />

    ...

</RelativeLayout> 
```

这很好用。但是我必须将我的项目导出为 jar（封闭源代码），所以我不能再使用 xml 布局了，对吧？

因为我的布局非常简单，我可以在代码中手动创建它。所以现在我正在使用这个：

```
mapView = new MapView(context);
mapView.setLayoutParams(
    new LayoutParams(
        LayoutParams.MATCH_PARENT, 
        LayoutParams.MATCH_PARENT
    )
);
view.addView(mapView);
mapView.onCreate(null); 
```

但是我在 onCreate 语句上得到一个 NullPointerException 。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:10:21.543

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".GeoPosActivity"
android:orientation="vertical" >

<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/myLocationText"
    android:layout_width="match_parent"
    android:layout_height="match_parent"       
    android:orientation="vertical"
    android:text="TEST"
    android:layout_weight="50"
    />

<fragment xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/myMapView"
    android:name="com.google.android.gms.maps.MapFragment"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:enabled="true"
    android:clickable="true"
    android:layout_weight="50"/>

</LinearLayout> 
```

我用这是我的应用程序。它工作，

你为什么使用“.jar”？为了测试您的应用程序，最好使用带有 android 的设备。

# ruby-on-rails - Ransack，搜索多列，一个字段，rails 3

> ID：15410522
> 
> 赞同：11
> 
> 时间：2013-03-14T13:24:11.490
> 
> 标签：ruby-on-rails, search, ransack

我是 Ruby on Rails 的新手，我正在创建我的第一个站点。我有一个包含 3 列的用户模型`firstname`：`lastname`和`email`. 我正在使用 ransack 制作搜索引擎，我希望有一个搜索字段可以遍历每一列并显示结果。

我做了一个**user_controller.rb**看起来像这样：

```
@q = User.search(params[:q])
@users = @q.result(:distinct => true) 
```

我的**User\index.html.erb**看起来像这样：

```
<%= search_form_for @search do |f| %>
  <div class="field">
    <%= f.label :firstname_cont , "Firstname" %>
    <%= f.text_field :firstname_cont %>
    <%= f.label :lastname_cont , "Lastname" %>
    <%= f.text_field :lastname_cont %>
    <%= f.label :email_cont , "Email" %>
    <%= f.text_field :email_cont %>
  </div>
  <div class="actions"><%= f.submit "Search" %></div>
<% end %> 
```

给我 3 个搜索字段，但我只想要一个包含名字、姓氏和电子邮件的搜索字段。

编辑 1：经过更多测试后，我发现搜索字段无法同时处理名字和姓氏或任何空格。我已经读过可以像这样制作一个 helper_method： [Searching multiple fields with Ransack](https://stackoverflow.com/questions/13309062/searching-multiple-fields-with-ransack/13311237#13311237)

当我得到搜索结果时，我会进入我的模型索引等：用户/索引。我在哪里可以改变这个？

但是没有关于如何在视图中使用它的信息。为什么只是 whrigt 这么难，这就是你要做的：在控制器中这样做 -> 在模型中这样做 -> 在视图中这样做 -> 并且不要忘记像这样修复路由 ->

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-16T11:26:51.363

首先，在询问之前尝试搜索一下 gem 文档并用谷歌搜索一下 ^_^。

第一个要参考的是 github 页面：[https ://github.com/ernie/ransack](https://github.com/ernie/ransack)

在这里查看 Ransack的**演示页面：** [http](http://ransack-demo.herokuapp.com/) : //ransack-demo.herokuapp.com/ 你应该看到第一个字段做了你想要的（在姓氏和名字中搜索）并查看源代码页面你应该看到这一行

```
<input id="q_first_name_or_last_name_cont" name="q[first_name_or_last_name_cont]" size="30" type="text" /> 
```

这让您对要使用的**正确谓词**有所了解，您还可以在此处列出它们：[https](https://github.com/ernie/ransack/blob/master/lib/ransack/constants.rb) ://github.com/ernie/ransack/blob/master/lib/ransack/constants.rb （总是在 gem github 上的文档）。

基于此，您可以在您的视图中执行类似的操作

```
<%= f.text_field :lastname_or_first_name_or_email_cont, :placeholder => 'full name or email contains' %> 
```

生成“OR 条件”查询，正如您在演示页面中再次看到的那样（生成的查询显示为传统 SQL 查询）

希望这可以帮助

干杯

# spring - 控制器、服务、存储库和简单的委托方法

> ID：15410523
> 
> 赞同：3
> 
> 时间：2013-03-14T13:24:12.167
> 
> 标签：spring, jakarta-ee, service, repository

我有一个使用 spring/hibernate/jsp 标准堆栈和典型层的 Java EE 应用程序：

*   @Repository（或 DAO）
*   @服务
*   @控制器

每个存储库都有许多 find... 方法（例如，对于 BookRepository：简单的 findById、findByTitle、findByAuthor、更复杂的 findMostUsed、findMostCommented 等）

服务层包含应有的业务逻辑调用存储库。

控制器调用服务方法并填充要在 JSP 中使用的 ModelAndView。

当然，服务中也有一些业务逻辑比较复杂的方法。但令人讨厌的是有很多像这样的愚蠢方法：

```
public List<Book> findMostUsed() {
    return repository.findMostUsed();
}
public List<Book> findMostCommented (boolean includeRating) {
    return repository.findMostCommented(includeRating);
}
... 
```

所以它们只是一个简单的委托（这些查找方法中没有业务逻辑 - 存储库中的数据库查询完成所有选择和分组）。

如果我需要更改存储库中的方法，则服务也需要更改。经过 2 年的开发，无需为这些方法添加任何逻辑 - 仅更改了查询及其参数。

我看到了更糟糕的设计，人们创建了 Controller -> Facade -> Service -> Repository -> DAO，每一层都充满了这样的方法。

*什么是更好的设计？*

也许要删除所有这些方法并将服务转换为更通用（例如 BookPricingService、BookRatingService 等，而不是单个 BookService（这违反了单一责任原则顺便说一句）？然后控制器将调用 Service 和 Repository 层，这是不好的。

也许让 find 方法更通用，例如 findByCriteria(criteria) 以减少它们的数量。但问题是查询是如此不同，这将以一种 switch-case 块结束，该块根据条件类型选择正确的查询/参数。顺便说一句，Spring-Data 还建议每个带有 @Query 注释的查询使用一种方法。

也许这只是我们拥有抽象层应该付出的代价？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:45:34.273

对于像这样的简单吸气剂，我只是将`@Repository`直接注入到我的`@Controller`或需要`@Service`的地方，并用`@Transactional(propagation = Propagation.REQUIRED)`. 该注释表明该方法必须在事务中使用，并且如果不存在则将创建一个（但如果已经在事务中则不会创建第二个）。

当操作多个根聚合/实体时，应使用服务类 - 即，当有两种类型的存储库时。由于服务将一个工作单元所需的方法捆绑在一起，因此它们是同一事务的一部分。

我也厌倦了不同的模式和依赖关系。

我还使用标准查询和[泛型](https://stackoverflow.com/a/15002922/106261)来避免许多非常相似的方法，例如：

```
@Transactional(readOnly = true)
    public <T> List<T> getFieldLike(String fieldName, String value) {
        final Session session = sessionFactory.getCurrentSession();
        final Criteria crit = session.createCriteria(genericType).add(Restrictions.ilike(fieldName, value, MatchMode.ANYWHERE));
        return crit.list();
    }

    @Transactional(readOnly = true)
    public <T> List<T> getFieldsEq( final Map<String, Object> restrictions) {
        final Session session = sessionFactory.getCurrentSession();
        final Criteria crit = session.createCriteria(genericType);
        for (final Map.Entry<String, Object> entry : restrictions.entrySet()) {
            crit.add(Restrictions.eq(entry.getKey(), entry.getValue()));
        }
        return crit.list();
    } 
```

# paypal - Paypal 新沙盒帐户未生成 api 凭据

> ID：15410524
> 
> 赞同：1
> 
> 时间：2013-03-14T13:24:13.973
> 
> 标签：paypal, sandbox, credentials

我在 PayPal 中创建了一个新的沙盒帐户。这是一个商家帐户。我点击了配置文件按钮，并在那里检查了 API 凭据页面。页面完全是空的。

我怎样才能得到它们？我应该触发其他东西来生成它们吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:34:01.860

确保该帐户是高级帐户或企业帐户。如果这是用于个人帐户，您将没有任何。如果您拥有正确的帐户类型，请尝试登录实际的测试帐户并转到配置文件，然后转到 API 凭据页面并手动生成它们。看看这是否允许您生成所需的凭据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-23T06:43:16.123

沙盒是您测试交易的测试环境

*   集成您的 PayPal API 您需要执行以下步骤 转到 [https://developer.paypal.com](https://developer.paypal.com)您将在其中注册
*   注册后向您发送一封确认电子邮件。验证来自您的电子邮件收件箱的信息
*   然后使用您新创建的凭据登录到[https://developer.paypal.com](https://developer.paypal.com)
*   然后转到“应用程序”菜单选项。并点击添加沙盒帐户，然后系统将自动添加沙盒帐户初始化
*   然后您将在沙盒电子邮件中看到您的电子邮件 ID 包含“-facilitator”。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-20T09:56:56.470

正如我所看到的，developer.paypal.com 具有新外观，其中还包括沙盒帐户，并且沙盒的功能运行良好。

但我不知道如何通过 IPN（即时付款通知）将 paypal 触发交易发回给我们。

我尝试在 developer.paypal.com > 工具 > IPN 模拟器中设置 IPN 侦听器 URL

但似乎对我来说效果不佳..

# mongodb - 从 AWS Elastic Beastalk php 实例安装 Mongodb

> ID：15410529
> 
> 赞同：0
> 
> 时间：2013-03-14T13:24:25.483
> 
> 标签：mongodb, amazon-web-services, amazon-elastic-beanstalk

有谁知道如何从 AWS Elastic Beanstalk php 实例中为 Mongodb 卷添加星标？尝试在 putty 上设置 SSH 连接时遇到问题。周围有什么想法或教程吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T15:08:15.560

Elastic Beanstalk 旨在用于自动扩展应用程序服务器层。如果您想使用 Mongo，您将不得不手动设置一个或多个 EC2 实例，然后从在 Elastic Beanstalk 上运行的应用程序连接到它们。

# nosql - 如何自动分配已保存实体的 ID？

> ID：15410531
> 
> 赞同：1
> 
> 时间：2013-03-14T13:24:32.670
> 
> 标签：nosql, ravendb

假设我尝试使用客户端 API 将以下实体结构保存在 RavenDB v2.0 文档存储中。

```
public class Instance
    {
        public string ID { get; set; }
        public string Name { get; set; }
        public string Content { get; set; }
    } 
```

如果我要创建 10-20 个实例，并且我想分别为每个实体保存实体 ID。我在网站上的文档中可以看到，您可以在调用该`session.SaveChanges()`方法后检索实体的 id，但这意味着我需要为我拥有的每个实体项调用此方法。

在这里使用的最佳实践是什么？客户端 API 有没有办法自动将实体 id 保存在实体类的字段中（可能有一个属性）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T14:42:00.243

使用默认约定 RavenDB 在调用后设置 ID 值`session.Store(item)`，使用 HiLo 算法在客户端生成 ID，而无需为每个 ID 分配到达服务器。ID 在名为“Id”的属性上可用，您可以配置为还查找名为 property 的属性。

# sql - Ruby on rails 从结果集中获取最后一条记录

> ID：15410532
> 
> 赞同：0
> 
> 时间：2013-03-14T13:24:35.413
> 
> 标签：sql, ruby-on-rails, record

```
@connection = ActiveRecord::Base.establish_connection(
            :adapter => "mysql2",
            :host => "localhost",
            :database => "siteconfig_development",
            :username => "root",
            :password => "root123"
)

sql = 'SELECT * from users'

@success_data = @connection.connection.execute(sql); 
```

如何在不迭代的情况下从@success_data 获取最后一条记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:34:45.963

**更新**

```
 @success_data = @connection.connection.select_all(sql);
  @success_data.class  
  => Array 
```

你可以使用任何数组方法`@success_data`

```
 @success_data.last  # will return the last element 
```

或者

```
 @success_data[-1]   # will return the last element 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:29:12.713

sql = 'SELECT * from users order by id desc limit 1'

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:27:04.470

好吧，您可以`.last`对集合进行操作，但是您在这里所做的事情有点偏离轨道，这是您访问数据库的默认方式还是特殊情况？

# php - 使用带有 TideSDK 1.3.1-beta 和 php 的 post 表单

> ID：15410534
> 
> 赞同：1
> 
> 时间：2013-03-14T13:24:39.377
> 
> 标签：php, forms, tidesdk

我正在尝试使用带有 post 方法的表单通过页面发送数据，但在提交后 $_POST 数组为空。改用 get 方法， $_GET 数组可以工作。

有解决办法吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-18T19:54:15.743

您将不得不使用 $_GET。TideSDK 仅使用 method="get" ，您甚至不必将方法添加到您的表单中。

# dynamics-crm-2011 - 工作流上下文 System.NullReferenceException

> ID：15410536
> 
> 赞同：1
> 
> 时间：2013-03-14T13:24:40.750
> 
> 标签：dynamics-crm-2011, dynamics-crm

在我的工作流程中，从营销列表中插入或删除联系人。根据输入的布尔参数值。True-> 插入 -> IF 联系人存在 THEN 返回 -> else False -> 删除 -> IF 不存在 THEN 返回

此 WFA 在事件上运行。

在第一次触发时，它运行良好，删除或添加联系人。但是我重新运行更改布尔值，我得到以下异常消息：

> 工作流程因错误而暂停：未处理的异常：System.NullReferenceException：对象引用未设置为对象的实例。在 ContactToMList.ContactToMList.Execute(CodeActivityContext executionContext) 在 System.Activities.CodeActivity.InternalExecute(ActivityInstance instance, ActivityExecutor executor, BookmarkManager bookmarkManager) 在 System.Activities.Runtime.ActivityExecutor.ExecuteActivityWorkItem.ExecuteBody(ActivityExecutor
> 
> executor, BookmarkManager bookmarkManager, Location resultLocation)

似乎没有考虑上下文。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.Crm.Sdk.Messages;
using Microsoft.Xrm.Sdk;
using Microsoft.Xrm.Sdk.Workflow;
using System.Activities;
using ContactToMList;

namespace ContactToMList
{
   public class ContactToMList : CodeActivity
    {

        [Input("Contatto")]
        [ReferenceTarget("contact")]
        public InArgument<EntityReference> contact { get; set; }

        [Input("Marketing List")]
        [ReferenceTarget("list")]
        public InArgument<EntityReference> MList { get; set; }

        [Input("Inserimento")]
        public InArgument<bool> inserimento { get; set; }

        bool action = false;
        private static string _logs = string.Empty; 
        private static IOrganizationService myService = null;
        private static string _separataore = "\r\n"; 
        private static Log_Entity log = new Log_Entity(string.Empty, myService);
        protected override void Execute(CodeActivityContext executionContext)
        {
            try
            {

                ITracingService tracingService = executionContext.GetExtension<ITracingService>();

                // Create the context
                IWorkflowContext context = executionContext.GetExtension<IWorkflowContext>();

                IOrganizationServiceFactory serviceFactory = executionContext.GetExtension<IOrganizationServiceFactory>();

                // Create the Organiztion service
                IOrganizationService service = serviceFactory.CreateOrganizationService(context.UserId);
                myService = service;
                log.WriteLog("");
                // Get the target entity from the context
               // var target = context.InputParameters["EntityId"];

                Guid contactiId = contact.Get<EntityReference>(executionContext).Id;
                Guid ListId = MList.Get<EntityReference>(executionContext).Id;
                bool insert = inserimento.Get<bool>(executionContext);

                // Prepare DataContext by using AutoGenerated cs file
                XrmDataContext datacontext = new XrmDataContext(service);

                var MyContact = (from c in datacontext.ContactSet where c.ContactId == contactiId select c.Id).ToArray();
                var MyList = (from l in datacontext.ListSet where l.Id == ListId select l).ToList().FirstOrDefault();
                // tutti i membri della lista di marketing
                var members = (from m in datacontext.ListMemberSet where m.ListId.Id == MyList.ListId select m.EntityId.Id).ToArray();

                if (MyList.MemberType == 2)
                {
                    if (MyList.Type.Value == false)
                    {
                        foreach (Guid id in members)
                            if (MyContact.FirstOrDefault() == id)
                                action = true;

                        if (insert && !action)
                        {

                            AddListMembersListRequest AddMemberRequest = new AddListMembersListRequest();

                            AddMemberRequest.ListId = ListId;
                            AddMemberRequest.MemberIds = MyContact;
                            // Use AddListMembersListReponse to get information about the request execution 
                            AddListMembersListResponse AddMemberResponse = service.Execute(AddMemberRequest) as AddListMembersListResponse;
                            //service.Update(MyList);

                        }
                        else if (!insert && action)
                        {

                            RemoveMemberListRequest RemoveMemberRequest = new RemoveMemberListRequest();
                            RemoveMemberRequest.ListId = ListId;
                            RemoveMemberRequest.EntityId = MyContact.FirstOrDefault();
                            // Use AddListMembersListReponse to get information about the request execution 
                            RemoveMemberListResponse RemoveMemberResponse = service.Execute(RemoveMemberRequest) as RemoveMemberListResponse;
                            // service.Update(MyList);

                        }
                    } 
                    else
                    {
                        tracingService.Trace("Stai cercando di inserire un contatto in una lista di Marketing che non è statica.");
                        _logs += "Stai cercando di inserire un contatto in una lista di Marketing che non è statica." + _separataore;
                        return; 

                    }
                }
                else
                {
                    tracingService.Trace("Stai cercando di inserire un enittà diversa da un contatto.");
                    _logs += "Stai cercando di inserire un enittà diversa da un contatto." + _separataore;
                    return;
                }

            }
            catch (Exception ex)
            {
                log.WriteLog(ex.Message);

            }

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T18:37:40.970

这是我用来与我的组织服务代理交互的一些代码。我发现它有助于在不通过 UI 的情况下触发插件。它还有助于清理我在开发插件时损坏的数据。

您需要填写您自己的域、用户名、密码和组织名称。注释掉的代码是我用来填充一系列相关实体的东西。如果您需要更多帮助，请告诉我。

在我有的地方`TrainingContext`，您将用您使用 CRM SDK 中的 CrmSvcUtil 生成的上下文替换它。

```
CrmConnection connection = CrmConnection.Parse("Url=http://localhost/trainingorg1; Domain=; Username=; Password=;");
OrganizationService service = new OrganizationService(connection);
string template = "http://localhost/main.aspx?etn={0}&pagetype=entityrecord&id=%7B{1}%7D";

using (TrainingContext svc = new TrainingContext(service))
{
    svc.MergeOption = Microsoft.Xrm.Sdk.Client.MergeOption.NoTracking;

    training_customer customer = svc.training_customerSet.FirstOrDefault(c => c.training_name == "George.Lucas");
    customer.training_SocialSecurityNumber = "123-45-6789";
    svc.Update(customer);

            #region interaction activity
            //try
            //{
            //    training_customer customer = new training_customer
            //        {
            //            EmailAddress = "George.Lucas@Force.net",
            //            training_name = "George.Lucas",
            //            training_UniqueCustomerIdentifier = "George.Lucas"
            //        };
            //    customer.Id = svc.Create(customer);

            //    training_interactiontypemaster typeMaster = new training_interactiontypemaster
            //    {
            //        training_Description = "Indicates an Interaction initiated because a Customer needed to update an Address",
            //        training_InteractionTypeValue = "Address Update"
            //    };
            //    typeMaster.Id = svc.Create(typeMaster);

            //    training_interaction interaction = new training_interaction
            //    {
            //        training_name = "Command Prompt",
            //        training_Customer = customer.ToEntityReference(),
            //        training_Description = typeMaster.training_Description,
            //        training_InteractionType = typeMaster.ToEntityReference()
            //    };

            //    interaction.Id = svc.Create(interaction);
            //    EntityReference reference = interaction.ToEntityReference();
            //    customer.training_Interaction = reference;
            //    svc.Update(customer);

            //    training_interactionactivity activity = new training_interactionactivity
            //    {
            //        training_ActivityName = "Customer Update",
            //        training_Description = "Updating Customer: " + customer.training_name,
            //        training_Interaction = reference,
            //        training_Entity = string.Format(template, customer.LogicalName, customer.Id)
            //    };
            //    activity[customer.LogicalName] = customer.ToEntityReference();
            //    svc.Create(activity);

            //    training_address address = new training_address
            //    {
            //        training_City = "City",
            //        training_Country = "Country",
            //        training_County = "County",
            //        training_Interaction = reference,
            //        training_Street1 = "Street 1",
            //        training_Street2 = "Street 2"
            //    };
            //    address.Id = svc.Create(address);

            //    training_interactionactivity activityTwo = new training_interactionactivity
            //    {
            //        training_Address = address.ToEntityReference(),
            //        training_ActivityName = "Address Update",
            //        training_Description = "Updating the Address for Customer: " + customer.training_name,
            //        training_Interaction = reference,
            //        training_Entity = string.Format(template, address.LogicalName, address.Id)
            //    };
            //    //activityTwo[address.LogicalName] = new CrmEntityReference(training_address.EntityLogicalName, addressId);
            //    svc.Create(activityTwo);
            //}
            //catch (Exception e)
            //{
            //    Console.WriteLine(e.ToString());
            //}
            #endregion
} 
```

# arrays - 在 DB2 SQL PL 中测试数组成员资格

> ID：15410546
> 
> 赞同：1
> 
> 时间：2013-03-14T13:25:06.477
> 
> 标签：arrays, db2, sql-pl

我正在将存储过程代码从 Oracle 迁移到 DB2，我需要找到一种方法来测试数组成员资格（Oracle 有一个`MEMBER OF`运算符）。

除其他外，存储过程使用一组用户（通过 JDBC 作为 Java 代码的参数接收）。我想找到在该数组中进行成员资格测试的最有效方法。使用 Oracle，我会这样做：

```
FOR r IN (SELECT * FROM acls WHERE acls.id = curid) LOOP
  IF r.user MEMBER OF users THEN
    RETURN 1;
  END IF;
END LOOP; 
```

`MEMBER OF`但是我在 DB2 中找不到等效项：

```
FOR r AS SELECT * FROM acls WHERE acls.id = curid DO
  IF r.user ????? users THEN
    RETURN 1;
  END IF;
END FOR; 
```

我看到两种选择：

1.  对所有数组元素执行另一个内部循环以“手动”进行测试。
2.  不要使用数组，而是使用单个字符串并使用`LIKE`基于 - 的模式匹配。

有没有更好的办法？请记住，数组来自外部代码，不能作为我可以`JOIN`或任何相关的表传递。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:41:14.933

您可以使用[关联数组](http://pic.dhe.ibm.com/infocenter/db2luw/v9r7/index.jsp?topic=/com.ibm.db2.luw.apdv.sqlpl.doc/doc/c0053644.html&resultof=%2522%2565%256c%2565%256d%2565%256e%2574%2522%2520%2522%2561%2572%2572%2561%2579%2522%2520%2522%2561%2572%2572%2561%2569%2522%2520)（在 DB2 9.7+ 中可用）和[`array_exists`谓词](http://pic.dhe.ibm.com/infocenter/db2luw/v9r7/index.jsp?topic=/com.ibm.db2.luw.apdv.sqlpl.doc/doc/c0053644.html&resultof=%2522%2565%256c%2565%256d%2565%256e%2574%2522%2520%2522%2561%2572%2572%2561%2579%2522%2520%2522%2561%2572%2572%2561%2569%2522%2520)来做到这一点。我不确定这是否适用于传递到程序中的内容。

但是，我发现`array_exists`速度很慢。您使用光标循环的一般设计也将非常慢。

如果性能是一个问题，您可能最好改为执行以下操作之一：

*   将用户数组放入过程中的临时表中，然后`join`对该表执行正常操作以查找匹配的记录。
*   使用动态 SQL 构造查询（例如在`in`子句中。

这是您可以使用动态 SQL 执行的操作的示例。对于此解决方案，让 Java 向您发送一个字符串，用逗号分隔：

```
declare v_sql varchar(1000); --Bigger than maximum possible result query...
declare stmt  varchar(1000);
declare return_result integer;
set v_sql = 'select case when count(*) > 0 then 1 else 0 end' &
     ' from acls WHERE acls.id = curid and user in (' &  users & ')' &
     ' group by (1)';
prepare stmt from v_sql;
open mycur;
fetch mycur into return_result;
close mycur;
return return_result; 
```

这假设用户是数值。如果它们是字符串，它将不起作用，因为必须在`in`子句中引用每个用户。

# c# - 旋转 PictureBox 改变大小

> ID：15410559
> 
> 赞同：1
> 
> 时间：2013-03-14T13:25:20.710
> 
> 标签：c#, winforms, visual-studio

我有一个图片框，尺寸为 710x238，用于显示更大的图像。当我加载图像时，它会加载图像而不扭曲它。它工作得很好。但是当我旋转图像并尝试在 PictureBox 中显示它时，图像大小变为正方形......

如何将 PictureBox 与图像一起旋转，以使旋转后的图像不失真？

这是我的代码

```
pictureBox1.SizeMode = PictureBoxSizeMode.Zoom; //property for load without distorting 
```

和旋转代码（此代码旋转图像...我想旋转图片框）

```
Bitmap oldBitmap = (Bitmap)pictureBox1.Image;
float angle = 90;
var newBitmap = new Bitmap(oldBitmap.Width, oldBitmap.Height);

var graphics = Graphics.FromImage(newBitmap);
graphics.TranslateTransform((float)oldBitmap.Width / 2, (float)oldBitmap.Height / 2);
graphics.RotateTransform(angle);
graphics.TranslateTransform(-(float)oldBitmap.Width / 2, -(float)oldBitmap.Height / 2);
graphics.DrawImage(oldBitmap, new Point(0, 0));
pictureBox1.Image = newBitmap; 
```

如何旋转图片框？我想将图片框与位图一起旋转。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:31:18.450

好吧，我想我终于明白你需要什么了。将 SizeMode 保持为 Zoom 并尝试以下操作：

```
pictureBox1.SizeMode = PictureBoxSizeMode.Zoom; // or PictureBoxSizeMode.StretchImage

...

int height = pictureBox1.Height;
int width = pictureBox1.Width;
pictureBox1.Width = height;
pictureBox1.Height= width;
pictureBox1.Image = newBitmap; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:34:26.383

你可以试试 ：

```
pictureBox1.SizeMode =PictureBoxSizeMode.StretchImage; 
```

如果你想旋转`PictureBox`你可以试试[这个](https://stackoverflow.com/questions/2163829/how-do-i-rotate-a-picture-in-c-sharp)和[这个。](https://stackoverflow.com/questions/472428/rotate-image-math-c)

# grails - 无法在空对象上获取属性“配置” - Grails Service Spock 测试

> ID：15410563
> 
> 赞同：3
> 
> 时间：2013-03-14T13:25:26.920
> 
> 标签：grails, groovy, spock

在 Grails 应用程序中使用 UnitSpec 为服务类运行 spock 测试用例时，将 grailsApplication 设为 null。

```
Error - Cannot get property 'config' on null object 
```

谁能告诉我如何`grailsApplication`在 spock 测试服务类时进行配置。

我google了很多，但没有解决我的问题。

这是代码。

```
 def accountServiceMock = Mock(AccountService)
    def accountClientService = new AccountClientService()
def setup(){

    accountClientService.accountWS = accountServiceMock
    accountClientService.basicAuthInterceptor = authenticatorServiceMock        
}

def "test account by status() " (){
    setup:
    def mockAccountStatus = "ACTIVE"
    mockDomain(Account, [accountInstance])
    accountClientService.grailsApplication = grailsApplication

    when:
    accountClientService.getAccountByStatus(mockAccountStatus)  //calling web service by fetching url from default.properties file which is context

    then:
    Account.count() != 0

    where:
    accountInstance = new Account(10L, "ACTIVE","1234", "firstName", "LastName")
} 
```

在 AccountService 类 getAccountByStatus() 方法中，使用 url = grailsApplication.config.ACCOUNTWEBSERVICEURL 调用 webservice，其中有 default.properties 文件，但是当我运行 spock 测试用例时，它会抛出类似的错误

无法在空对象上获取属性“配置”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T15:08:49.347

干得好：

```
import spock.lang.Specification
import grails.test.mixin.*

@TestFor(SomeService)
class SomeServiceIntegrationSpecSpec extends Specification {

    def "give me the config value"() {
        given: config.value = '123'
        expect: service.valueFromConfig == '123'
    }
} 
```

...仅供参考， SomeService 类：

```
class SomeService {

    def grailsApplication // autowired

    def getValueFromConfig() {
        grailsApplication.config.value
    }
} 
```

上面的例子很简单，尽管足以说明应该如何做。由于@TestFor 注释，grailsApplication 的自动装配工作。如果这不适合您的情况，则需要更多信息：

*   Grails 版本
*   Spock 版本（grails 插件版本可以）
*   NPE从哪里抛出？测试服务本身或模拟
*   是 Grails 单元还是集成测试
*   完整的测试源将是 hepful

无论您的具体情况如何，您都可以像[j4y 在这里回答](https://stackoverflow.com/questions/10744599/mock-configuration-in-grails-tests)的那样模拟配置（当前时间的最后一个答案）

如果您进行单元测试，请记住 Config.groovy 不会被吞食。另一件值得一提的事情是，如果 NPE 是从 Mock() 或 'new' 关键字创建的对象中抛出的，那么这里没有自动装配也就不足为奇了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-16T10:28:35.713

我有一个类似的问题。实际上有一个引用 grailsApplication 的域对象。

通过将 grailsApplication 从测试分配给域来修复：

```
@TestMixin(GrailsUnitTestMixin)
@TestFor(MyService)
@Mock([MyDomain])
class MyServiceSpec extends Specification {

    myTest() {

        grailsApplication.config.myValue = "XXX"

        def myDomain = MyDomain()

        myDomain.grailsApplication = grailsApplication

    }
} 
```

# dependency-injection - 自定义会员提供者和 Unity 注入

> ID：15410575
> 
> 赞同：3
> 
> 时间：2013-03-14T13:25:58.090
> 
> 标签：dependency-injection, unity-container, custom-membershipprovider

我为我的 MVC4 解决方案创建了一个自定义成员资格提供程序。问题是我无法通过 Unity 注入它。

我曾尝试使用构造函数注入，但随后出现无参数构造函数错误。如果我尝试使用 InjectionProperty 它不会改变我的任何属性。我试过使用 DependencyResolver.Current.GetService(); 它返回空值。

我首先通过 web.config 附加了提供程序：

```
 <membership defaultProvider="ExtendedServiceMembershipProvider" userIsOnlineTimeWindow="15">
  <providers>
    <clear />
    <add name="ExtendedServiceMembershipProvider" type="Foo.Providers.Security.BoxMembershipProvider, Foo" />
  </providers>
</membership>
<roleManager defaultProvider="ExtendedServiceRoleProvider">
  <providers>
    <clear />
    <add name="ExtendedServiceRoleProvider" type="Foo.Providers.Security.BoxRoleProvider, Foo" />
  </providers>
</roleManager> 
```

这是正确的方法吗？希望你们中的一些人能解决我的问题。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T14:59:01.803

您应该做的是创建一个空的成员资格提供程序，它只是调用 MVC Dependency Resolver 以获取真实的`Membership Provider`. 通过这样做，您可以实现三件事：

*   此实现有一个默认构造函数，可以在 web.config 中进行配置。
*   该实现是一个 MVC 基础结构组件，并且与包含该实现（您可能想要测试）的实际成员资格提供程序分离。
*   该基础设施组件不依赖于 Unity（或任何其他容器），而仅依赖于 MVC3，这降低了容器本身的耦合度。

实现可能如下所示：

```
public class DependencyResolverMembershipProvider : MembershipProvider
{
    private static MembershipProvider Provider
    {
        get
        {
            var provider = DependencyResolver.Current.GetService<MembershipProvider>();

            if (provider == null)
            {
                throw new InvalidOperationException(
                    "Make sure the MembershipProvider is registered.");
            }

            return provider;
        }
    }

    public override string ApplicationName
    {
        get { return Provider.ApplicationName; }
        set { Provider.ApplicationName = value; }
    }

    public override bool ChangePassword(string username, 
        string oldPassword, string newPassword)
    {
        return Provider.ChangePassword(username, oldPassword, newPassword);
    }

    public override bool ChangePasswordQuestionAndAnswer(string username, 
        string password, string newPasswordQuestion, string newPasswordAnswer)
    {
        return Provider.ChangePasswordQuestionAndAnswer(username,
            password, newPasswordQuestion, newPasswordAnswer);
    }

    public override MembershipUser CreateUser(string username, 
        string password, string email, string passwordQuestion, 
        string passwordAnswer, bool isApproved, object providerUserKey, 
        out MembershipCreateStatus status)
    {
        return Provider.CreateUser(username, password, email,
            passwordQuestion, passwordAnswer, isApproved, providerUserKey,
            out status);
    }

    // Implement all other methods here
} 
```

这仍然是很多工作，因为它`MembershipProvider`有很多方法。有两种方法可以使这更容易：

*   使用[Griffin.MvcContrib](https://github.com/jgauffin/griffin.mvccontrib)之类的框架，它已经为您完成了这样的事情，并且以一种更愉快的方式完成，因为它分离了这些类内部的职责并公开了一些您可以为此功能实现的新接口.
*   防止系统的任何部分依赖于静态`Membership`类，但始终将 a 注入`MembershipProvider`到这些类中，甚至更好：不要使用 the ，`MembershipProvider`而只需注入可能在其后面的接口`MembershipProvider`（例如`IUserRepository`and `IPasswordManager`）。

# zend-framework - 使用 Zend_Controller_Router_Route 解析 URL 中的参数

> ID：15410576
> 
> 赞同：0
> 
> 时间：2013-03-14T13:26:05.280
> 
> 标签：zend-framework

在我的网站上，我需要以这种方式获取页面的 URL：，`/category/page4`因此传递给控制器​​的参数是“页面”一词之后的数字。我设法通过以下方式获取 URL：（`/category/page/4`带有额外的斜杠）使用此代码：

```
$router->addRoute('categoryPages', new Zend_Controller_Router_Route(
    '/category/page/:page',
     array(
        'controller' => 'caegory',
        'action' => 'index'
    ),
    array(
        'page' => '\d+'
    )
)); 
```

我希望有类似`/category/page4`以下代码修改的 URL：

```
// Simply removed one slash
'/category/page:page' 
```

但是，此代码不会创建我需要的路由。我的错误是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:49:01.140

你不能这样做`Zend_Controller_Router_Route`，命名变量必须单独位于 url 分隔符（斜杠）或路由的开始/结束附近。

相反，您可以将其作为正则表达式路由：

```
$router->addRoute('categoryPages', new Zend_Controller_Router_Route_Regex(
    'category/page(\d+)',
     array(
        'controller' => 'caegory',
        'action' => 'index'
    ),
    array(
        1 => 'page'
    ),
    'category/page%s'
)); 
```

# java - 为 Android 客户端添加端点支持

> ID：15410578
> 
> 赞同：1
> 
> 时间：2013-03-14T13:26:12.700
> 
> 标签：java, android, eclipse, google-app-engine, google-cloud-messaging

在解释我的问题之前，我想在您的网站上称赞您，这对我们开发人员非常有用。对于给您带来的不便，我深表歉意，但我不知道如何解决这个问题：

我的目标是为 Android 应用程序创建一个支持 Endpoint 的项目。我使用了以下指南：[https ://developers.google.com/eclipse/docs/endpoints-android](https://developers.google.com/eclipse/docs/endpoints-android)

由于我正在创建一个新的 Android 应用程序，因此我遵循了建议的第一种方式：[https ://developers.google.com/eclipse/docs/endpoints-androidconnected-gae](https://developers.google.com/eclipse/docs/endpoints-androidconnected-gae)

我一步一步地遵循了最后一个指南；但我在 Eclipse 中发现了几个我不知道如何解决的错误。

在 Eclipse 中使用向导后：**文件 > 新建 > 其他 > Google > App Engine Connected Android Project**

在包资源管理器中出现了两个项目：

1.  云测试
2.  CloudTest-AppEngine

特别是，在 CloudTest 中的**GCMIntentService**类中，Eclipse 报告了三个导入错误：

1.  导入 com.cloudtest.deviceinfoendpoint.Deviceinfoendpoint；
2.  导入 com.cloudtest.deviceinfoendpoint.Deviceinfoendpoint.Builder；
3.  导入 com.cloudtest.deviceinfoendpoint.model.DeviceInfo；

Eclipse 报告说不能解决导入！！我的问题是为什么？怎么了？

为了构建这个项目，我下载了：

1.  最新的 Eclipse 谷歌插件
2.  最新的 Android 开发工具
3.  适用于 Java 的最新 Google App Engine SDK
4.  最新的 Eclipse 版本
5.  最新的 Google API
6.  最新的 Java sdk
7.  最新的适用于 Android 的 Google Cloud Messaging 库

很抱歉打扰你，但不知道我哪里错了。等待您的友好回复，谢谢您和最好的问候。

# email - 仅将电子邮件从 Outlook 复制到 CRM 2011

> ID：15410582
> 
> 赞同：1
> 
> 时间：2013-03-14T13:26:22.323
> 
> 标签：email, outlook, integration, dynamics-crm-2011, jakarta-mail

我在为客户服务部门工作的解决方案之一遇到问题。我们以电话或电子邮件的形式收到客户的询问。我已经设置了一个 dilog 流程，该流程捕获了提出新案例所需的所有细节。

当我们想要将电子邮件对话附加到该案例时，问题就开始了。我能想到的唯一解决方案是保存电子邮件并将其附加到案例中。但有时我们必须在案件结案之前向客户发送 5-6 甚至 10 封电子邮件。这意味着每次发送电子邮件时，都必须将其附加到案例中。（也占用服务器上的额外空间）。您会同意，这不是一个非常实用的解决方案。

我们也不想使用 Outlook 集成选项，因为这是他们目前正在使用的，并且正在创建更多问题然后解决它们。我在这里搜索并发现了一些类似的主题，建议使用 Jama Mail（[链接](https://stackoverflow.com/questions/10875082/copy-an-outlook-email-to-a-folder-or-read-the-email-via-javamail)，但我不确定如何将电子邮件附加到 CRM 中的特定联系人。

有什么方法可以第一次附加电子邮件并从那时起自动捕获所有对话？如果您能在这里帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T14:36:08.303

很难回答，因为您说“不包括使用功能强大且可自定义的 Outlook 客户端执行此操作的一种简单而正确的方法”......（或类似的话）。

使用 Outlook 客户端执行此操作的正确方法是在链中的第一封电子邮件上设置相关信息（或者确实接收入站电子邮件并转换为案例，这也将在电子邮件上设置新案例的相关信息）。

智能匹配结合 Outlook 选项“自动跟踪电子邮件以响应 CRM 电子邮件”应该可以解决问题。

使用电子邮件跟踪令牌将使这更加可靠，如果您在发送电子邮件之前“设置相关”（例如，在记录案例后对客户的第一次回复），那么它会在主题行中获得一个令牌，这有助于保证对话的唯一性，因此未来的电子邮件将自动跟踪并针对正确的案例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T06:51:41.847

不，没有办法附加第一封电子邮件并让它自动附加该对话中的所有进一步消息。有人将不得不编写软件来做到这一点。

# javascript - IE9 支持 HighCharts 吗？

> ID：15410584
> 
> 赞同：0
> 
> 时间：2013-03-14T13:26:23.973
> 
> 标签：javascript, internet-explorer, highcharts

IE9 支持 Highcharts 吗？

当我尝试添加一个更改其填充的按钮时——虽然它在 Mozilla Firefox 上运行良好，但在 IE9 中似乎根本无法运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:28:00.110

根据[官方文档，IE6+ 支持 Highcharts。](http://www.highcharts.com/documentation/compatibility)

![在此处输入图像描述](../Images/830a756df61d4eef1a7e0ecf8bd04166.png)

尽管请注意，正如它在文档中提到的那样，与 IE9 和其他浏览器（如 Firefox 和 Chrome）相比，IE8 及之前的性能并不是那么好。

# macos - TweetDeck 列内容过滤器

> ID：15410588
> 
> 赞同：0
> 
> 时间：2013-03-14T13:26:32.873
> 
> 标签：macos, twitter

我在 Mac 上使用从 Mac App Store 下载的 TweetDeck 2.5.3。我想过滤列中的内容，但找不到过滤器。当我单击列上的编辑链接时，我只看到通知选项。列内容过滤器在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T09:29:06.713

这是我自己想出来的。没有明确的方法可以在 TweetDeck 中输入列搜索。从窗口顶部的主搜索栏搜索时，您必须键入 Return / Enter 键以调出自定义添加列功能。在搜索字段中键入将在两个部分中显示自动建议的结果，一个在顶部，一个在底部。顶部包含搜索词，底部包含匹配的用户。您必须从顶部选择一个搜索词才能获得添加列功能。从底部选择用户会显示用户配置文件。我为此使用了 Mac OS X，但它在 Windows 上的工作方式可能相同。

# oracle - 使用 Liquibase 修改 Oracle 中包含数据的列的 dataType

> ID：15410589
> 
> 赞同：5
> 
> 时间：2013-03-14T13:26:33.870
> 
> 标签：oracle, liquibase

我正在尝试针对这些列中包含数据的数据库将 dataType 从 NUMBER(10,0) 修改为 NUMBER(30,0)。我必须为此使用 liquibase。我正在使用以下内容：

```
<modifyDataType tableName="tableName" columnName="columnsName" newDataType="NUMBER(38,0)"/> 
```

但是对于列中包含数据的表，我收到以下错误：

```
Caused by: java.sql.SQLException: ORA-01440: column to be modified must be empty to decrease precision or scale 
```

并且该列未迁移。有数据的列可以通过这种方法迁移到新的类型吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-22T08:57:01.590

它不是 liquibase，它是引发此错误的 oracle 引擎。Liquibase 实际上会转换`modifyDataType`为 alter table 语句。因此，您对 oracle 引擎的声明将类似于：

```
ALTER TABLE tableName MODIFTY columnsName NUMBER(38,0); 
```

现在 `modifyDataType`将返回由于生成的 sql 语句而返回的任何错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T16:27:04.643

检查以确保该列具有您怀疑的数据类型。如果原始数据类型为 NUMBER(N,0) 其中 N < 38，则您的迁移将起作用。

# timezone - 通过电话号码获取当前时间

> ID：15410591
> 
> 赞同：1
> 
> 时间：2013-03-14T13:26:44.157
> 
> 标签：timezone, phone-number

我想编写一个 RoR 移动应用程序，它可以为我提供给定电话号码在该国的当前时间及其区号。有没有一个很好的api？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T16:26:11.093

不是一个好主意。

对于拥有多个不同时区和多个区号的国家/地区，您会怎么做？时区到区号不一定是一对一的映射。

例如，在美国，928 区号覆盖了亚利桑那州的大部分地区，包括两个不同的时区，因为在该州的东北部，纳瓦霍族实行夏令时，而亚利桑那州的其他地区则没有。因此，在一年中的部分时间里，928 区号的两个不同部分之间存在一小时的差异。

一个更清晰的例子 - 605 区号覆盖了整个南达科他州。该州西半部使用山区时间，该州东半部使用中部时间。

我敢肯定，在美国以外还有更多的例子。

此外，人们带着手机旅行。我知道有 3 个在我的头顶上的人在搬到新的电话号码后将他们的电话号码保留为不同的区号。

此外，[手机号码可携带性](https://en.wikipedia.org/wiki/Mobile_number_portability)和[本地号码可携带性](https://en.wikipedia.org/wiki/Local_number_portability)允许人们移动到其他区域并保留他们的电话号码 - 包括区号。因此，区号只会告诉您号码最初来自哪里，而不是它当前所在的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-04T14:09:04.917

如果您可以[将 Javascript 添加](http://railsapps.github.io/rails-javascript-include-external.html)到项目中，那么您可能想尝试[ChronoMouse.js](http://www.chronomouse.com)，这将有助于获取当前时间、GMT 偏移量、时区名称、位置、首都、夏令时法律或夏令时状态任何美国/加拿大区号或国家/地区代码。

对于国家代码，信息基于首都。

例如：

```
console.log( getLocalInfo('+49').time.display );

// 15:07 
```

有关更多示例和文档，请参阅[www.chronomouse.com](http://www.chronomouse.com)。

注意：我是该项目的作者。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-14T14:37:00.433

这可以帮助您将国家代码映射到国家名称[https://github.com/hexorx/countries](https://github.com/hexorx/countries)

> 国家/地区是 ISO 3166 标准中每个国家/地区的各种有用信息的集合。它包含以下标准 ISO3166-1（国家/地区）、ISO3166-2（州/细分）、ISO4217（货币）和 E.164（电话号码）的信息。gem 还添加了一个 country_select 助手。我将添加我可以访问的任何基于国家/地区的数据。我希望这是所有国家信息的存储库。

# css - 向左浮动，在顶部留下空白

> ID：15410597
> 
> 赞同：1
> 
> 时间：2013-03-14T13:27:00.913
> 
> 标签：css, html, css-float

**编辑**：空格是指内部 div 不会堆叠到顶部（如果有意义的话） [http://jsfiddle.net/UdbKq/](http://jsfiddle.net/UdbKq/)

我有以下 html 设置

```
<body>
<div id=all>
<pre>
<div id=header><b>
 __   __     ______     ______     __     __     __  __     ______     __         ______     ______     ______   ______  
/\ "-.\ \   /\  __ \   /\  == \   /\ \  _ \ \   /\ \_\ \   /\  __ \   /\ \       /\  ___\   /\  __ \   /\  ___\ /\__  _\ 
\ \ \-.  \  \ \  __ \  \ \  __<   \ \ \/ ".\ \  \ \  __ \  \ \  __ \  \ \ \____  \ \___  \  \ \ \/\ \  \ \  __\ \/_/\ \/ 
 \ \_\\"\_\  \ \_\ \_\  \ \_\ \_\  \ \__/".~\_\  \ \_\ \_\  \ \_\ \_\  \ \_____\  \/\_____\  \ \_____\  \ \_\      \ \_\ 
  \/_/ \/_/   \/_/\/_/   \/_/ /_/   \/_/   \/_/   \/_/\/_/   \/_/\/_/   \/_____/   \/_____/   \/_____/   \/_/       \/_/ 
  </b>
</div>                                                                                                             
</pre>
<div id=content>
    <div id=menu>
        <ul>
            <li><a href=#>Home</a></li>
            <li><a href=#>Lorem Ipsum</a></li>
            <li><a href=#>Github</a></li>
            <li><a href=#>About us</a></li>
            <li><a href=#>Contact</a></li>
        </ul>
    </div>
    <div id=container>
        <div id=leftcontent>
        </div>
        <div id=middlecontent>
        </div>
        <div id=rightcontent>
        </div>
    </div>
</div>  
</div> 
```

和 CSS

```
 body
{
    background-color:black;
    font-family:'Press Start 2P', cursive;'
}
#all
{
    margin:auto;
    color:#fff;
    width:950px;
    height:100%;
    border:7px double #fff;
}
#header
{
    position:relative;
    top:-27.8px;
    font-size:12px;
    border-bottom:7px double #fff;
}
#menu ul
{
    position:relative;
    left:-40px;
    top:-75px;
    width:950px;
    font-size:16px;
    font-family:'Press Start 2P', cursive;
}
#menu ul li
{
    background-color:pink;
    text-align:center;
    width:184.4px;
    float:left;
    padding:20px 0px 20px 0px;
    list-style:none;
    display:inline;
    border-right:7px double #fff;
}
#menu ul li:last-child
{
    border:none;
}
#menu ul li:hover a
{
    color:#000;
    background-color:#fff;
}
#menu a
{
    color:#fff;
    text-decoration:none;
}
#container
{
    position:relative;
    top:-19px;
    height:500px;
    width:950px;
    background-color:cyan;
    border-top:7px double white;
}
#leftcontent
{
    float:left;
    padding:0;
    margin:0;
    background-color:red;
    border-right:7px double white;
    width:184.4px;
    height:500px;
}
#middlecontent
{
    float:left;
    padding:0;
    margin:0;
    background-color:blue;
    border-right:7px double white;
    width:567.2px;
    height:500px;
}
#rightcontent
{
    float:left;
    padding:0;
    margin:0;
    background-color:green;
    width:184.4px;
    height:500px;
} 
```

现在我的问题是在浮动内容 div 之后，它们都离开了父级（或者这就是它似乎发生的情况），因此在顶部留下了一个巨大的空白。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:35:18.960

添加`overflow: hidden;`到`#menu ul`- 您还没有清除浮动列表项

`<div id="menu">`完成后，如果您不想要空间，则可以将高度调整为 0。

[**jsbin**](http://jsbin.com/efiyib/5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:35:33.383

你的意思是青色的白色空间？如果你这样做，那么添加`overflow:hidden`到`#container`：

```
#container
{
    overflow:hidden;
    position:relative;
    top:-19px;
    height:500px;
    width:950px;
    background-color:cyan;
    border-top:7px double white;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:38:34.757

从您的标签中删除所有空格`pre`并摆脱所有不必要的相对定位。

```
<div id=header>
    <pre>[ascii chars]</pre>
</div> 
```

## [jsFiddle](http://jsfiddle.net/FC5kq/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T15:14:28.390

如果我明白你的意思，只需删除边框，看看你得到什么

试试看

```
div, ul, li{
    border:0 !important;
} 
```

# ajax - 从 ajax 成功收到的返回 xml 中获取值

> ID：15410598
> 
> 赞同：0
> 
> 时间：2013-03-14T13:27:02.857
> 
> 标签：ajax, jquery, xml-parsing

我进行了一个 ajax 调用，它在我的成功函数中返回了一些 xml。像这样：

```
<grid row_count="39">
  <item>
     <id>343</id>
     <publickey>e9a515f9-44ac-4af9-b4b2-c30dd366ac83</publickey>
     <name><![CDATA[repeater dsds]]></name>
     <description />
     <subject />
     <templatetype>16</templatetype>
     <socialmediatype>0</socialmediatype>
     <trackingmediaid />
     <companyid>226</companyid>
     <createdon>3/14/2013 12:15:03 PM</createdon>
     <updatedon> 
```

我想获取网格标记中存在的 row_count 的值。我对 xml 一点也不熟悉。任何帮助都会很棒。谢谢...！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:30:09.843

如果 dataType 设置为 xml，jQuery 将为您解析它，否则以`$.parseXML`常规方式运行和使用 DOM 遍历方法：

```
var xml = $.parseXML(data_from_ajax);

var row_count = $(xml).filter('grid').attr('row_count'); 
```

在您上面的字符串中，既不是`item`也不`grid`是正确关闭的，如果原始字符串也是如此，那将导致问题。您还需要使用`find()`或者`filter()`取决于`grid`字符串中出现的位置？

# mysql - MySQL 表中的最大列数

> ID：15410604
> 
> 赞同：12
> 
> 时间：2013-03-14T13:27:17.700
> 
> 标签：mysql

我对 MySQL 还很陌生。我有几个问题：

1）有多少（最大）没有。的列可以在 MySQL 表中创建。

2）有多少（最大）没有。的表可以在 MySQL 数据库中创建。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-14T13:30:07.760

*   1- 每个表大约 4,096 列。

*   2-mySQL[对数据库数量没有限制。](http://dev.mysql.com/doc/refman/5.0/en/database-count-limit.html)底层文件系统可能对表的数量有限制。单独的存储引擎可能会施加特定于引擎的约束。InnoDB 允许多达 40 亿个表。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-14T13:34:22.497

你可以在这里找到准确的信息：

*   [最大数量 列数](http://dev.mysql.com/doc/refman/5.6/en/column-count-limit.html)
*   [最大数量 表](http://dev.mysql.com/doc/refman/5.6/en/database-count-limit.html)

简而言之：

*   每个表 4096 列，InnoDB 1017
*   表数无限制，InnoDB 40 亿

# gwt2 - GWT - 没有位置的活动（演示者）

> ID：15410605
> 
> 赞同：0
> 
> 时间：2013-03-14T13:27:20.843
> 
> 标签：gwt2

我想创建带有嵌套活动的网络应用程序。一项活动将嵌套其他活动项。我想为 GWT 使用 Slotted 框架，但是没有关于它的好教程。我想知道嵌套活动是否需要场所？

我需要网站模板。右面板（活动）、左、中、上、面包屑。在中心，我想为演示者设置位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T18:03:33.590

GWT 的[ActivityManager](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/activity/shared/ActivityManager.html)与[PlaceChangeEvent](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/place/shared/PlaceChangeEvent.html)相关联。所以，是的，您需要使用“地点”来充分利用 Activity 和 ActivityManager 概念。

注意 - [Activity](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/activity/shared/Activity.html)和 AbstractActivity 与“Places”没有直接关系

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-28T15:53:16.527

Slotted has moved to GitHub and has move all the wikis here: [https://github.com/slotted/slotted/wiki](https://github.com/slotted/slotted/wiki)

There is a good tutorial for porting the standard GWT Activities and Places to Slotted here: [https://github.com/slotted/slotted/wiki/Migrate-GWT-Activities-and-Places](https://github.com/slotted/slotted/wiki/Migrate-GWT-Activities-and-Places)

As for an example of how to do different layouts, Slotted has an layout example here: [https://github.com/slotted/slotted/tree/develop/examples/Layout](https://github.com/slotted/slotted/tree/develop/examples/Layout)

# go - mgo 中的错误：结果没有字段或方法

> ID：15410606
> 
> 赞同：1
> 
> 时间：2013-03-14T13:27:23.270
> 
> 标签：go, mgo

我有以下代码

```
package main

import (
    "encoding/json"
    "fmt"
    "labix.org/v2/mgo"
    "labix.org/v2/mgo/bson"
)

func insertEntry(j *map[string]interface{}, entry string) {
    err := json.Unmarshal([]byte(entry), j)
    if err != nil {
        panic(err)
    }

}

func main() {
    c1 := `{
    "mw" : 42.0922,
        "ΔfH°gas" : {
          "value" : 372.38,
          "units" : "kJ/mol"
        },
        "S°gas" : {
          "value" : 216.81,
          "units" : "J/mol×K"
        },
        "index" : [
          {"name" : "mw", "value" : 42.0922},
          {"name" : "ΔfH°gas", "value" : 372.38},
          {"name" : "S°gas", "value" : 216.81}
        ]
        }`

    c2 := `{
    "name": "silicon",
    "mw": 32.1173,
    "index": [
    {
        "name": "mw",
        "value": 32.1173
    }
    ]
    }`

    var m map[string]interface{}

    insertEntry(&m, c1)
    insertEntry(&m, c2)
    chemical := m["ΔfH°gas"].(map[string]interface{})
    fmt.Println("value: ", chemical["value"].(float64))
    fmt.Println("units: ", chemical["units"].(string))

    session, err := mgo.Dial("localhost")

    if err != nil {
        panic(err)
    }
    defer session.Close()

    // Optional. Switch the session to a monotonic behavior.
    session.SetMode(mgo.Monotonic, true)

    c := session.DB("test").C("chemicals")
    err = c.Insert(&m)
    if err != nil {
        panic(err)
    }

    result := &m
    err = c.Find(bson.M{"name": "silicon"}).One(&result)
    if err != nil {
        panic(err)
    }

    fmt.Println(result)
    fmt.Println("mw:", result.mw)
} 
```

并得到以下错误

```
$ go run chemeo.go
# command-line-arguments
./chemeo.go:78: result.mw undefined (type *map[string]interface {} has no field or method mw) 
```

我怎么能打印出 mw 呢？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:37:15.997

`result`是一个地图[字符串]，因此您可以使用`result["mw"]`. 此映射条目的值将是类型`interface{}`，Go 最通用的类​​型，因此您必须将其转换为浮点数才能使用它。请参阅[类型转换](http://golang.org/doc/effective_go.html#conversions)。

我从未使用过 mgo，但它似乎在后台使用 encoding/json。如果是这样，您可以定义一个[与您的 JSON 结构匹配的结构，](http://golang.org/pkg/encoding/json/#Marshal)并且 encoding/json 将能够将 mgo 的响应解组到其中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:37:33.247

不幸的是，我从未使用过 mgo，但查看错误消息，我可能会尝试

```
fmt.Println("mw:", result["mw"]) 
```

# google-app-engine - Google App Engine NDB：查询后需要 fetch() 吗？

> ID：15410609
> 
> 赞同：3
> 
> 时间：2013-03-14T13:27:29.663
> 
> 标签：google-app-engine, app-engine-ndb

要在 Google App Engine 的 NDB 中检索实体，我需要`fetch()`after`query()`吗？例如：

```
account = self.request.get('account')
member = Member.query(Member.account==account).fetch()
if member:   
    # Account exists
else:        
    # Account does not exist 
```

我有两个问题：

1.  如果`.fetch()`使用，代码运行正确。但是，如果 `.fetch()`不使用，则测试始终为真，这意味着检索了一些实体。问题是什么？
2.  一般来说，`.fetch()`如果我想在查询后检索 **所有**实体，是否需要使用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T13:47:10.340

如果`fetch()`未使用，则将`member = Member.query(..)`Query 类实例分配给`member`. 所以你的 if 条件为真。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-11-15T02:00:08.470

```
member_query = Member.query(Member.account==account) 
```

member_query now contains a Query instance.

From there, you have a few options, but it seems that you would want to only grab ONE entity from this query. To do that, you'd say.

```
member = Member.query(Member.account==account).get() 
```

Now, member is either None if the account doesn't exist, or will contain a Member model instance.

If you use .fetch(), you can specify the number of entities you want to retrieve as the first argument, or use None (or no arguments) to grab all. If there are a lot of entities that match this condition, this could be time consuming.

Another paradigm would be to iterate over the query and break or return on the first entity that matches your conditions. This paradigm would allow you to do on-the-fly conditionals not covered by your query parameters. For example...

```
for member in member_query:
    if member.active:
        return member

# No account
return None 
```

Querying over this sort of membership model is less than ideal, however, because it will require a query to run every time. Of course, if you want a 'user' to have access to multiple 'profiles' (like Facebook User <-> Facebook Pages, as an example), you need something like this.

It's far more efficient to structure the list of "Profiles" that an account has access to, like so:

```
class UserAccount(ndb.Model):
    """User Account"""

    """List of keys which reference profiles this user can access"""
    profiles = ndb.KeyProperty(repeated=True)

    def fetch_profiles(self):
        """Returns a list of profile entities this user can access"""
        return ndb.get_multi(profiles)

    def can_user_access_profile(self, profile):
        """Returns True if user can access 'profile' (either a ndb.Model or ndb.Key)"""
        if isinstance(profile, ndb.Model):
            profile = profile.key()  # Convert Model instances to a key

        return profile in self.profiles

class Profile(ndb.Model):
    # ... 
```

As you can see, this also let's you quickly determine if a user has access to a given profile.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-06T12:46:59.100

`member = Member.query(Member.account==account).get()`意味着获得一个实例。

`members = Member.query(Member.account==account).fetch()`在列表中返回结果。

`memberQuery = Member.query(Member.account==account)`返回一个查询类，可以再次过滤。

# java - 在私有 Guice 模块中公开通用绑定

> ID：15410615
> 
> 赞同：1
> 
> 时间：2013-03-14T13:27:44.580
> 
> 标签：java, persistence, guice

我最近开始使用 Google Guice，研究我在网上找到的教程和代码，但现在我被困住了。

我尝试创建一个`GenericDAO`可以在每个 EntityDAO 的基础上扩展的。我无法弄清楚如何配置现有的私有 Guice 模块。

这是我的`PrivateModule`，其中是一个使用 a作为身份`Person`的实体。`String`该类`Address`是另一个不依赖于的实体`GenericDAO`（到目前为止，我一直在尝试保持简单开始）。

```
public class PersistModule extends PrivateModule {

    @Override
    protected void configure() {
        install(new JpaPersistModule("jpa"));

        bind(PersistenceLifeCycleManager.class)
            .annotatedWith(PersistService.class)
            .to(PersistenceLifeCycleManagerImpl.class);
        expose(PersistenceLifeCycleManager.class)
            .annotatedWith(PersistService.class);

        bind(new TypeLiteral<GenericDAO<Person, String>>() {})
            .to(new TypeLiteral<PersonDao>() {});
        // How to expose this??

        bind(AddressDao.class).asEagerSingleton();
        expose(AddressDao.class);
        bind(EntityLocator.class).asEagerSingleton();
        expose(EntityLocator.class);
    }
} 
```

我`ConfigurationException`在尝试运行它时得到一个：

```
com.google.inject.ConfigurationException: Guice configuration errors:

1) Unable to create binding for com.guicetest.server.dao.PersonDao. It was already configured on one or more child injectors or private modules
   (bound by a just-in-time binding)
  If it was in a PrivateModule, did you forget to expose the binding?
  while locating com.guicetest.server.dao.PersonDao

1 error
at com.google.inject.internal.InjectorImpl.getProvider(InjectorImpl.java:1004)
at com.google.inject.internal.InjectorImpl.getProvider(InjectorImpl.java:961)
at com.google.inject.internal.InjectorImpl.getInstance(InjectorImpl.java:1013)
at com.guicetest.server.service.PersonService.getAllPersons(PersonService.java:43)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at com.google.web.bindery.requestfactory.server.ReflectiveServiceLayer.invoke(ReflectiveServiceLayer.java:182)
at com.google.web.bindery.requestfactory.server.ServiceLayerDecorator.invoke(ServiceLayerDecorator.java:111)
at com.google.web.bindery.requestfactory.server.ServiceLayerDecorator.invoke(ServiceLayerDecorator.java:111)
at com.google.web.bindery.requestfactory.server.ServiceLayerDecorator.invoke(ServiceLayerDecorator.java:111)
at com.google.web.bindery.requestfactory.server.SimpleRequestProcessor.processInvocationMessages(SimpleRequestProcessor.java:463)
at com.google.web.bindery.requestfactory.server.SimpleRequestProcessor.process(SimpleRequestProcessor.java:233)
at com.google.web.bindery.requestfactory.server.SimpleRequestProcessor.process(SimpleRequestProcessor.java:135)
at com.google.web.bindery.requestfactory.server.RequestFactoryServlet.doPost(RequestFactoryServlet.java:133)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at com.google.inject.servlet.ServletDefinition.doService(ServletDefinition.java:263)
at com.google.inject.servlet.ServletDefinition.service(ServletDefinition.java:178)
at com.google.inject.servlet.ManagedServletPipeline.service(ManagedServletPipeline.java:91)
at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:62)
at com.guicetest.server.injector.PersistFilter.doFilter(PersistFilter.java:39)
at com.google.inject.servlet.FilterDefinition.doFilter(FilterDefinition.java:163)
at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:58)
at com.google.inject.servlet.ManagedFilterPipeline.dispatch(ManagedFilterPipeline.java:118)
at com.google.inject.servlet.GuiceFilter.doFilter(GuiceFilter.java:113)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1088)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:360)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:729)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at org.mortbay.jetty.handler.RequestLogHandler.handle(RequestLogHandler.java:49)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at org.mortbay.jetty.Server.handle(Server.java:324)
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:505)
at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:843)
at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:647)
at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:211)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:380)
at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:395)
at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:488) 
```

Google Guice 用户指南在这里并没有真正帮助我，但我只是从它开始，所以也许我错过了一些东西，这真的很容易。

- 编辑 -

**MyGuiceServletContextListner.java**

```
public class MyGuiceServletContextListner extends GuiceServletContextListener {

    @Override
    protected Injector getInjector() {
        return Guice.createInjector(new MyServletModule(),
            new PersistModule());
    }

} 
```

**MyServletModule.java**

```
public class MyServletModule extends ServletModule {

    @Override
    protected void configureServlets() {
        filter("/*").through(PersistFilter.class);
        bind(ExceptionHandler.class).to(RequestFactoryExceptionHandler.class);
        bind(ServiceLayerDecorator.class).to(MyServiceLayerDecorator.class);
        Map<String, String> params = new HashMap<String, String>();
        params.put("symbolMapsDirectory", "WEB-INF/classes/symbolMaps/");
        serve("/gwtRequest").with(MyRequestFactoryServlet.class, params);
    }
} 
```

**GenericDAOImpl.java**

```
public abstract class GenericDAOImpl<E extends AbstractEntity, P> implements GenericDAO<E, P> {

    @Inject
    @PersistService
    private PersistenceLifeCycleManager manager;
    @Inject
    private Provider<EntityManager> em;
    private Class<E> entityClass;

    @SuppressWarnings("unchecked")
    @Transactional
    @Override
    public P create(E entity) { ... }

    // etc ...

    @Transactional
    @Override
    public List<E> getAll() {
        List<E> list = null;
        TypedQuery<E> qry = (TypedQuery<E>) getEntityManager()
            .createNamedQuery(getEntityClass().getSimpleName()+".getAll", , getEntityClass());
        if (qry != null) {
            list = qry.getResultList();
        }
        return list;
    }

    @SuppressWarnings("unchecked")
    @Override
    public Class<E> getEntityClass() {
    if (entityClass == null) {
    Type type = getClass().getGenericSuperclass();
        if (type instanceof ParameterizedType) {
            ParameterizedType paramType = (ParameterizedType) type;
            entityClass = (Class<E>) paramType.getActualTypeArguments()[0];
            } else {
                throw new IllegalArgumentException("Could not guess entity class by reflection");
            }
        }
        return entityClass;
    }

} 
```

**PersonDao.java**

```
public class PersonDao extends GenericDAOImpl<Person, String> {

    @Transactional
    public Person getPersonByEmailId(String emailId) { ... }

} 
```

**人事服务.java**

```
public class PersonService {

    @Inject
    private Injector injector;

    // ...

    public List<Person> getAllPersons() {
        PersonDao pd = injector.getInstance(PersonDao.class);
        return pd.getAll();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:43:50.047

您可以`TypeLiteral`在[私有模块](https://google-guice.googlecode.com/svn/trunk/javadoc/com/google/inject/PrivateModule.html)中公开 a ：

```
TypeLiteral<GenericDAO<Person, String>> personDaoTypeLiteral = new TypeLiteral<GenericDAO<Person, String>>() {};
bind(personDaoTypeLiteral).to(PersonDao.class);
expose(personDaoTypeLiteral); 
```

然后在您的 中`PersonService`，您无法获得 PersonDAO 的实例，因为该模块公开了`GenericDAO<Person, String>`.

```
public class PersonService {

    @Inject
    private Injector injector;

    public List<Person> getAllPersons() {
        TypeLiteral<GenericDAO<Person, String>> personDaoTypeLiteral = new TypeLiteral<GenericDAO<Person, String>>() {};
        PersonDao pd = injector.getInstance(Key.get(personDaoTypeLiteral));
        return pd.getAll();
    }
} 
```

请注意，这些类型文字的代码不清楚。你可以使用一个常量：

```
public class Literals {
    public static final TypeLiteral<GenericDAO<Person, String>> PERSON_DAO = new TypeLiteral<GenericDAO<Person, String>>() {
    };
} 
```

接着

```
bind(Literals.PERSON_DAO).to(PersonDao.class);
expose(Literals.PERSON_DAO); 
```

和

```
injector.getInstance(Key.get(Literals.PERSON_DAO)); 
```

# c# - PtrToStrAnsi 更快的替代方案？

> ID：15410616
> 
> 赞同：0
> 
> 时间：2013-03-14T13:27:46.093
> 
> 标签：c#, marshalling

我正在寻找一种可以快速将非托管字符串转换为托管字符串的函数。我正在看`Marshal.PtrToStringAnsi`，但它真的很慢。

我在 .NET 框架源代码中看到以下定义：

```
public static String PtrToStringAnsi(IntPtr ptr)
{
    if (Win32Native.NULL == ptr) {
        return null; 
    }
    else if (IsWin32Atom(ptr)) { 
        return null; 
    }
    else { 
        int nb = Win32Native.lstrlenA(ptr);
        if( nb == 0) {
            return string.Empty;
        } 
        else {
            StringBuilder sb = new StringBuilder(nb); 
            Win32Native.CopyMemoryAnsi(sb, ptr, new IntPtr(1+nb)); 
            return sb.ToString();
        } 
    }
} 
```

为了提高我的应用程序的性能，我创建了以下方法，该方法使用更快的 Marshal.PtrToStringAnsi(IntPtr, int) 方法。

```
[DllImport("kernel32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, EntryPoint = "lstrlenA")]
[ResourceExposure(ResourceScope.None)]
internal static extern int lstrlenA(IntPtr ptr); 

static public string PtrToString( IntPtr p )
{
   if (p == IntPtr.Zero)
      return null;
   int len = lstrlenA(p);
   if (len == 0)
      return string.Empty;
   return Marshal.PtrToStringAnsi(p, len);
} 
```

这种替代方法似乎要快得多。微软没有对 PtrToStringAnsi 函数进行编码是有原因的吗？我可能错过了一些重要的东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T14:14:52.263

不同之处在于调用`IsWin32Atom`. 您的版本忽略了这一点。当你把它放回去时，你会发现你的版本与`Marshal`. 即使你去掉调用， `IsWin32Atom`对性能的提升也是微不足道的。

我的测试程序版本如下所示：

```
using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Runtime.Versioning;

namespace Test
{
    internal class Program
    {
        [DllImport("kernel32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, EntryPoint = "lstrlenA")]
        [ResourceExposure(ResourceScope.None)]
        internal static extern int lstrlenA(IntPtr ptr);

        [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
        private static extern System.IntPtr GetCommandLine();

        private static readonly IntPtr HIWORDMASK = unchecked(new IntPtr((long)0xffffffffffff0000L));

        private static bool IsWin32Atom(IntPtr ptr)
        {
            long num = (long)ptr;
            return 0 == (num & (long)HIWORDMASK);
        }

        public static string PtrToString(IntPtr p)
        {
            if (p == IntPtr.Zero)
                return null;
            if (IsWin32Atom(p))
                return null;
            int len = lstrlenA(p);
            if (len == 0)
                return String.Empty;
            return Marshal.PtrToStringAnsi(p, len);
        }

        private static void Main(string[] args)
        {
            var p = Marshal.StringToHGlobalAnsi("Console.WriteLine(\"Marshal class: result={0} time={1}ms\", s, sw.ElapsedMilliseconds);");

            string s = "";
            Stopwatch sw = new Stopwatch();
            sw.Start();
            for (double i = 0; i < 5000000; i++)
            {
                s = Marshal.PtrToStringAnsi(p);
            }
            sw.Stop();
            Console.WriteLine("Marshal class: result={0} time={1}ms", s, sw.ElapsedMilliseconds);
            sw.Restart();
            for (double i = 0; i < 5000000; i++)
            {
                s = Program.PtrToString(p);
            }
            sw.Stop();
            Console.WriteLine("My implementation: result={0} time={1}ms", s, sw.ElapsedMilliseconds);
            Console.ReadLine();
        }
    }
} 
```

运行时间因运行而异。但这是一个典型的输出：

```
Marshal 类：result=Console.WriteLine("Marshal 类：result={0} time={1}ms",
  s, sw.ElapsedMilliseconds); 时间=1914ms
我的实现：result=Console.WriteLine("Marshal class: result={0} time={1}ms",
  s, sw.ElapsedMilliseconds); 时间=2065ms

```

但有时它会反过来出现。简而言之，两者之间没有什么可以选择的。

当您删除对 的调用时`IsWin32Atom`，您的版本通常会获胜。但不是很多。速度通常有大约 5% 的差异。我不知道你为什么认为这`Marshal.PtrToStringAnsi`是“非常慢”。

我非常希望两个参数版本`Marshal.PtrToStringAnsi`本质上`else`是您的代码的子句。

*注意*：我的测试环境是 Win7 x64、VS2012、AnyCPU、Release。

# ruby-on-rails-3 - 如何在以下代码中为流程方法编写 rspec？

> ID：15410619
> 
> 赞同：0
> 
> 时间：2013-03-14T13:27:49.717
> 
> 标签：ruby-on-rails-3, rspec

基本上我想确保应该从过程方法调用method_1和method_2。

```
 def process
        begin
          method_1  if some_condition
          method_2  if some_condition      
          self.update_attribute(:status,DONE)
        rescue=>e
          self.update_attribute(:status,ERROR)
          p e
        end
    end

def method_1
#some code
end

def method_2
#some code
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:54:41.070

尝试这个：

```
it "should call #method_1" do
  YourClass.should_receive(:method_1)
  YourClass.process
end

it "should call #method_2" do
  YourClass.should_receive(:method_2)
  YourClass.process
end 
```

我假设这些是类方法。

如果这些是实例方法，你可以做`YourClass.any_instance.should_receive(...)`或`your_instance.should_receive(...)`

有关更多信息，请参阅[http://rubydoc.info/gems/rspec-mocks/frames](http://rubydoc.info/gems/rspec-mocks/frames)。

**编辑：**

`should_receive`还将存根该方法。这将取消存根并调用方法：

```
YourClass.should_receive(:method_2).and_call_original 
```

# php - 我无法将数据插入数据库

> ID：15410626
> 
> 赞同：0
> 
> 时间：2013-03-14T13:28:02.733
> 
> 标签：php, mysql, ajax, jquery, mysqli

我正在创建一个评论表单，它将询问用户他的姓名、电子邮件并使用 php 和 mysqli 发表评论以连接到数据库和 jquery 不刷新但问题是：我无法将数据插入数据库但是当我“回显”保存从用户输入的数据的变量时，它可以在不输入数据库的情况下正常工作，我不知道错误是什么。

谁能帮我？

**ps：** 我不是要求为我编写代码，但我需要知道如何解决它。

# submit_to_db.php

```
<?php
  $conn = new mysqli('localhost', 'root', 'root', 'my_db');
  if(isset($_POST['submit'])){
  $name =isset ($_POST['name']);
  $email = $_POST['email'];
  $comments = $_POST['comments'];

  echo"<pre>";
  print_r($_POST);
  echo"</pre>";

  $query = "INSERT into comments('email', 'comments') VALUES(?, ?)";
  echo $query;
  $stmt = $conn->stmt_init();
  if($stmt->prepare($query)){

     $stmt->bind_param('ss', $email, $comments);
     $stmt->execute();
     //var_dump($stmt);

  }

  if($stmt){

  echo "thank you .we will be in touch soon <br />";
 // echo $_POST['name'];
  //echo $_POST['email'];
  //echo $_POST['comments'];
  var_dump($stmt);
  }
  else{
   echo "there was an error. try again later.";
   }  

}
else
   echo"it is a big error";
?> 
```

# 索引.php

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>feedback page</title>
<script type = "text/javascript" src = "http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<link rel ="stylesheet" href = "css/default.css" />

<script type = "text/javascript">

$(function(){

   $('#submit').click(function(){
     $('#container').append('<img src = "img/loading.gif" alt="Currently loading" id = "loading" />');

         var name = $('#name').val();
         var email = $('#email').val();
         var comments = $('#comments').val();

         $.ajax({

            url: 'submit_to_db.php',
            type: 'POST',
            data: 'name =' + name + '&email=' + email + '&comments=' + comments,

            success: function(result){
                 $('#response').remove();
                 $('#container').append('<p id = "response">' + result + '</p>');
                 $('#loading').fadeOut(500, function(){
                     $(this).remove();
                 });

            }

         });         

        return false;

   });

});

</script>

</head>

<body>
   <form action = "submit_to_db.php" method = "post">
   <div id = "container">
      <label for = "name">Name</label>
      <input type = "text" name = "name" id = "name" />

      <label for = "email">Email address</label>
      <input type = "text" name = "email" id = "email" />

      <label for = "comments">Comments</label>
      <textarea rows = "5"cols = "35" name = "comments" id = "comments"></textarea>
      <br />

      <input type = "submit" name = "submit" id = "submit" value = "send feedBack" />
    </div>
   </form>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T14:28:48.137

**错误警报！**

如果你这样做：

```
$query = "INSERT into comments(email, comments) VALUES($email, $comments)"; 
```

然后这样做：

```
 $stmt->bind_param('sss', $email, $comments); 
```

您可能会收到一条错误消息。您需要在查询字符串中有绑定占位符，如下所示：

```
$query = "INSERT into comments(email, comments) VALUES(?,?)"; 
```

并且由于您只使用两个字段，因此您的绑定语句应为：

```
 $stmt->bind_param('ss', $email, $comments); 
```

**调试策略**

```
 // Print out your post variable and look at it carefully...
 echo "<pre>";
 print_r($_POST);
 echo "</pre>";

 if(isset($_POST['submit'])){
     //$name =isset ($_POST['name']);
     $email = $_POST['email'];
     $comments = $_POST['comments']; 
```

请仔细查看名称字段，我昨天发现了一个导致问题的额外/不可见字符。

此外，作为确保插入工作的测试：

```
 if(isset($_POST['submit'])){
     $name = "Stack Overflow";
     $email = "stack@overflow.com";
     $comments = "Lorem ipsum and so on..."; 
```

您需要找出问题是在客户端（表单和 POST 变量）还是在服务器端（MySQL 的东西）。

**我的代码版本**
这是我在服务器上工作的内容。**请查看评论。** 剪切和粘贴时要小心，以免引入任何无关字符。

```
<?php 
    // Echo your POST variable so you can see what the
    // data looks like from your submission form
    echo "<pre>";
    print_r($_POST);
    echo "</pre>";

  $conn = new mysqli('localhost', 'username', 'password', 'database');
  $query = "INSERT into comments(name, email, comments) VALUES(?, ?, ?)";

  // Initially, do a simple insert using static values to make sure 
  // the MySQL statements are working
  // When this works, you can comment these out and uncomment 
  // the statements using the POST array
  $name = "Some Name";
  $email = "some@name.com";
  $comments = "some commentary text...";

  // At this point, you will validate your input, but do this later...
  // After you tested the MySQL, try the form data
  //$name = $_POST['name'];
  //$email = $_POST['email'];
  //$comments = $_POST['comments'];

  $stmt = $conn->stmt_init();
  if($stmt->prepare($query)){
     $stmt->bind_param('sss',$name, $email, $comments);
     $stmt->execute();
  }

  // This tells you if the insert worked...
  printf("%d Row inserted.<br>", $stmt->affected_rows);

  if($stmt->affected_rows){
  echo "thank you .we will be in touch soon";
  }
  else {
   echo "there was an error. try again later.";
  }  
?> 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-14T14:03:06.980

请将您的查询更改如下：

```
$query = "INSERT into comments(`email`, `comments`) VALUES('$email', '$comments')"; 
```

希望这对你有帮助

# r - 使用R编程查找同一列中两行之间的差异

> ID：15410640
> 
> 赞同：2
> 
> 时间：2013-03-14T13:28:31.800
> 
> 标签：r, subtraction

所以基本上，我有这段代码可以让我将我的时间列分成 50 小时间隔 这是代码....我需要帮助来编写差异（差异-我在下面放一个空格）函数...我解释了这个再往下看

```
Time<- seq(1, ncol(analyse), by=2)
o <- lapply(Time, function(i){  
xf1 <- IRanges(start=seq(0, max(analyse[[i]]), by=50), width=50)
xf2 <- IRanges(start=data[[i]], width=1)
t <- findOverlaps(xf1, xf2)
diff <-_____________________________________
d <- data.frame(Diff=tapply(data[[i+1]], queryHits(t), diff))
cbind(as.data.frame(xf1), d)}) 
```

这是我的样本数据

```
Time(hr)  Kilometres reached
1.7        2.0   
2.4       15.6
6.8       23.1
9.3       11.5
11.6      12.3
23.4      1.3
28.4      9.7
30.1      15.2
35.7      16.3
42.3      15.8
48.2      14.6
50.0      14.2 
```

因此，当我的代码将我的时间分成 50 小时的间隔时......我希望它在该间隔期间用第一个值获取间隔的最后一个值......例如，我想要这种类似的输出

```
Time(hr)   Kilometres reached
50         12.2 (based from the sample data mentioned= 14.2-2.0)        
100 
```

多谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:42:51.627

这个怎么样？（例如，使用像@Tyler 这样的 10 小时间隔）

```
# assuming your data.frame is sorted by Time.hr.
require(IRanges)
ir1 <- IRanges(df$Time.hr., width=1)
sq  <- seq(10, max(df$Time.hr., by=10)+10, by=10)
ir2 <- IRanges(start = c(0, head(sq, -1)) + 1, end = sq)

olaps <- findOverlaps(ir2, ir1)
tapply(subjectHits(olaps), sq[queryHits(olaps)], 
        function(x) df$Kilometres[max(x)] - df$Kilometres[min(x)])
#  10   20   30   40   50 
#  9.5  0.0 13.9  0.0 -1.6 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:39:08.060

这是我使用 10 小时间隔代替的解决方案（因为您只有一个间隔进行测试）：

```
dat <- read.table(text="Time  Kilometres
1.7        2.0   
2.4       15.6
6.8       23.1
9.3       11.5
11.6      12.3
23.4      1.3
28.4      9.7
30.1      15.2
35.7      16.3
42.3      15.8
48.2      14.6
50.0      14.2", header=TRUE)

ints <- seq(0, 50, by=10)
dat$new <- cut(dat$Time, ints)
out <- sapply(split(dat$Kilometres, dat$new), function(x) diff(c(x[1], tail(x, 1))))
data.frame(Time = ints[-1], Kilometres =out, row.names=NULL) 
```

产量：

```
 Time Kilometres
1   10        9.5
2   20        0.0
3   30        8.4
4   40        1.1
5   50       -1.6 
```

# coffeescript - 使用与“控制”帮助程序产生的相同的控制器实例

> ID：15410642
> 
> 赞同：0
> 
> 时间：2013-03-14T13:28:36.607
> 
> 标签：coffeescript, ember.js, ember-data

使用以下型号：

```
App.Post = DS.Model.extend
  title: DS.attr 'string'
  comments: DS.hasMany 'App.Comment'

App.Comment = DS.Model.extend
  body: DS.attr 'string'
  post: DS.belongsTo 'App.Post' 
```

我在我的帖子模板中显示所有帖子和所有帖子评论：

```
{{#each post in controller}}
  {{post.title}}
  {{#each comment in post.comments itemController="comment"}}
    {{partial 'comment' comment}}
    {{this}}
  {{/each}}
{{/each}} 
```

这里使用了控件助手，以便我为每个评论获取一个控制器。

我有一个 CommentsController，它的模型是从帖子中提取的扁平化评论数组。

```
App.CommentsController = Em.ArrayController.extend
  itemController: 'comment'
  needs: 'posts'
  postsBinding: 'controllers.posts'

  comments: (->
    comments = []
    @get('posts').forEach (post) ->
      post.get('comments').forEach (comment) ->
        comments.pushObject comment
    console.log comments
    @set 'model', comments
  ).observes('posts.length')

App.CommentController = Em.ObjectController.extend() 
```

该控制器确实按预期使用 CommentController 装饰每条记录，但是它似乎是在创建新的控制器实例，而不是重用正在模板中呈现的控制器。有没有办法找到相同的实例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T15:21:33.377

按照设计，每个`{{control}}`助手都会创建控制器的新实例。听起来您正在寻找的东西是由`{{each}}`助手提供的。

```
{{#each post in controller}}
  {{post.title}}
  {{each comment in post.comments itemViewClass="App.ItemView" itemController="item"}}
{{/each}} 
```

# dynamics-crm-2011 - 脚本奇怪的行为CRM在线ru12

> ID：15410646
> 
> 赞同：3
> 
> 时间：2013-03-14T13:28:44.043
> 
> 标签：dynamics-crm-2011, dynamics-crm-online

Microsoft Dynamics 只不过是一种可以使用的魅力。MS Dynamics CRM 是一项非常好的技术，但最近一切都开始......糟透了？

从很多地方阅读，我知道 roll up 12 有一些错误，但我有一个客户使用 CRM online 和 bam！两周前自动获取更新。

而且一直是噩梦。

不支持功能区按钮，到处都是错误……昨天，**我写了一个脚本来禁用一个字段，它神秘地将流程表单视图（新视图）更改为经典视图。奇怪的。**

有谁知道 ru12 的脚本设计是否已更改？还是我和我的剧本错了。

```
function disablefield() {

  //alert ("pass");
  var disable = false;
  var cc = Xrm.Page.getAttribute("field").getValue();

  if (cc == 1) {
     disable = true;
  }
  Xrm.Page.ui.controls.get("anotherfield").setDisabled(disable);

  //alert ("pass");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T14:36:29.960

Javascript 代码在新进程视图中不起作用。将来我认为这将得到支持，但现在是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T22:57:16.320

JS执行系统在RU12中进行了改造。可悲的是，引入了许多错误。当一个人保存表单并关闭它时，我看到了一些有趣的报告。根据语句的顺序，一个人会得到许多不同的行为。没有一个是正确的。:)

# android - 自定义视图位图的大小不正确

> ID：15410648
> 
> 赞同：1
> 
> 时间：2013-03-14T13:28:49.113
> 
> 标签：android, view, bitmap

我想在自定义视图中加载一定大小的位图。作为第一步，我想在 400 像素 x 400 像素的视图中加载 400 像素 x 400 像素的位图……但加载的位图尺寸较小。

我发现了一些有类似问题的线程。建议使用`Options.inScale = false`. 我使用了它，并且得到了更好的日志消息（位图输出正确的大小为 400px x 400px），但它仍然被渲染得更小：

![在此处输入图像描述](../Images/3a8ee3819fccad64d6dfe868411d4177.png)

（黄色是自定义视图的背景 - 400px x 400px，红色是位图）。

有什么建议吗？这是代码：

自定义视图：

```
class TestView extends View {
    private Bitmap bitmap;
    private Paint paint = new Paint();

    public TestView(Context context) {
        super(context);
    }

    public TestView(Context context, AttributeSet attr) {
        super(context, attr);

        BitmapFactory.Options options = new BitmapFactory.Options();
        options.inScaled = false;

        bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.overlay, options).copy(Config.ARGB_8888, true);  
        Log.d("test6", "width: " + bitmap.getWidth() + " height: " + bitmap.getHeight());
    }

    @Override
    public void onDraw(Canvas canvas) {
        super.onDraw(canvas);
        canvas.drawBitmap(bitmap, 0, 0, paint);
    }
} 
```

XML:

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#000000"
    >
    <com.example.TestView
        android:id="@+id/view"
        android:layout_width="400px"
        android:layout_height="400px"
        android:background="#ffff00"
        />
</RelativeLayout> 
```

位图已经是 400px x 400px ...这就是为什么我认为我不必使用缩放选项等。我只想在屏幕上以这个大小显示它...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T14:32:51.397

您很可能`Bitmap`不在`drawable-nodpi`文件夹中，这就是它被缩放的原因。

根据[Canvas.drawBitmap](http://developer.android.com/reference/android/graphics/Canvas.html#drawBitmap%28android.graphics.Bitmap,%20float,%20float,%20android.graphics.Paint%29)的文档：

> 如果位图和画布具有不同的密度，此函数将负责自动缩放位图以与画布相同的密度进行绘制。

# css - 如何为响应式网站创建响应式模态框？

> ID：15410650
> 
> 赞同：1
> 
> 时间：2013-03-14T13:28:55.960
> 
> 标签：css, html, responsive-design

我想创建可以根据设备高度和设备宽度进行调整的模态框。最初我尝试了 Bootstrap 对话框，但我的问题是每当内容超过设备高度时，我都无法显示模态框的全部内容。（尤其是在小屏幕移动设备中）所以我什至尝试使用 iscroll 在模态框内添加内容的包装器，它工作得很好，但如果我添加 iscroll，网站页面将不会在移动设备中滚动。我很震惊。任何帮助将不胜感激。谢谢你。

# angularjs - 在表内的行上使用 ng-repeat 和 ng-class

> ID：15410652
> 
> 赞同：60
> 
> 时间：2013-03-14T13:28:58.317
> 
> 标签：angularjs, angularjs-ng-repeat

我正在使用 AngularJS，我想要获得的效果将类似于它会产生的效果，假设它会起作用（它不会起作用）。

看法

```
<tr ng-repeat='person in people' ng-class='rowClass(person)'>
  <td>.....info about person...</td>
  <td>.....info about person...</td>
  <td>.....info about person...</td>
</tr> 
```

控制器

```
$scope.rowClass = function(person){
  ...return some value based upon some property of person...
} 
```

我意识到这段代码不起作用，因为`person`它不可用，`ng-class`因为它只对每行内的对象可用。代码是为了了解我想要做的事情：即。我希望能够拥有使用`ng-repeat`其类创建的表行也基于一个条件，该条件取决于对行本身的范围特性的访问，例如。`person`. 我意识到我**可以**在列上添加 ng-class 但这很无聊。有人有更好的想法吗？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-03-14T14:16:12.383

这实际上应该可以正常工作。Person 应该在 tr 元素及其子元素上可用，因为它们共享相同的范围。

这对我来说似乎很好用：

```
<table>
    <tr ng-repeat="person in people" ng-class="rowClass(person)">
        <td>{{ person.name }}</td>
    </tr>
</table> 
```

[http://jsfiddle.net/xEyJZ/](http://jsfiddle.net/xEyJZ/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-14T13:57:10.700

实际上，您**可以**在所指的上下文中使用“人”。它存在于被重复的项目以及其中的任何项目上。原因是特定元素上的任何指令共享相同的 $scope 对象。ng-repeat 的优先级为 1000，所以它已经创建了它的 $scope 并将“person”放入其中，因此 ng-class 可以使用“person”。

看到这个Plnkr：

[http://plnkr.co/edit/ZI5Pv24U01S9dNoDulh6](http://plnkr.co/edit/ZI5Pv24U01S9dNoDulh6)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-31T21:42:04.463

通常我喜欢给出一个更全面的答案，但是这部分涉及的代码太多了。所以只会展示什么是最重要的，并希望看到这个的任何人都知道如何使用它。我的动态 JSON 数组中既有列又有行，但对这一位重要的是 ng-show="$last"。这应该只显示动态 JSON 数组中的最后一行。

```
<tr ng-repeat="row in table.rows" ng-show="$last">

   <td ng-repeat="column in table.cols" ng-show="column.visible == true" nowrap >{{row[column.columnname]}}</td>
</tr> 
```

# java - 最后插入的记录未反映在使用 JDBC 的 mysql 中的 select 语句中

> ID：15410658
> 
> 赞同：0
> 
> 时间：2013-03-14T13:29:13.507
> 
> 标签：java, mysql, jsp, jakarta-ee, jdbc

所以这是我的问题.. 我正在尝试在国家表中添加国家名称，其中包含两个字段国家 ID 和国家名称。我正在通过用户输入的 jsp 页面获取一个国家名称，并在表格中列出所有可用的国家名称，但问题是用户插入的名称不会显示在列表页面中......

这是代码片段

用于插入记录

```
public boolean insertCountry(CountryBean bean)
{

String country=bean.getCountryname();

boolean flag=false;

int result;

try
{

    conn=connection.createConnection();

    stmt=conn.createStatement();
    String sqlInsert="insert into country(Country_Name) values('"+country+"')";

    result=stmt.executeUpdate(sqlInsert);

    if(result>0)
        flag=true;
    else
        flag=false;

}

catch(Exception e)
{
    e.printStackTrace();
}

return flag; 
```

}

用于显示记录

公共列表 ListCountry() 抛出 SQLException {

```
 List<CountryBean> list=new ArrayList<CountryBean>();
    CountryBean bean;

    Connection conn=null;
    Statement stmt=null;
    ResultSet rs=null;

    try
    {

        conn=connection.createConnection();

        stmt=conn.createStatement();

        String sqlselect="select * from country order by country_name";
        rs=stmt.executeQuery(sqlselect);

        if(rs!=null)
        {
            while(rs.next())
            {
                bean=new CountryBean();
                bean.setCountryname(rs.getString("country_name"));
                System.out.println(rs.getString("country_name"));

                list.add(bean);

            }

        }
    }

        catch(Exception e)
        {
            e.printStackTrace();
        }
    finally
    {
        if(rs!=null){
            rs.close();
        }

        if(conn!=null){
            conn.close();
        }
        if(stmt!=null){
            stmt.close();
        }

    }

    return list;

} 
```

}

```
listing jsp page

<table border="2">
    <tr>
        <th>Country Name</th>

    </tr>
    <%
        for (int i = 0; i < list.size(); i++) {
                CountryBean bean = list.get(i);
    %>
            <tr>
    <td><%=bean.getCountryname()%></td>
             <%
                }
                }
     %> 
```

公共静态连接 createConnection() { try { Class.forName("com.mysql.jdbc.Driver");

```
 conn=DriverManager.getConnection("jdbc:mysql://localhost:3309/ecom_db","root","root");

    }
    catch(Exception e)
    {
        e.printStackTrace();

    }
    return conn;
    }                                                                 Name of the country is successfully entered in to the database nothing wrong with the queries but the problem is it does not appear in to the list in table tag.list.size method returns only previously inserted countries not the new one. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:33:15.710

您的显示记录功能看起来非常混乱。可能没有正确发布。我假设您已经通过提供 DB 的名称和密码正确地创建了连接。

```
Class.forName("com.mysql.jdbc.Driver").newInstance();
        Connection conn = DriverManager
                .getConnection(
                        "jdbc:mysql://localhost:3306/Twitter?jdbcCompliantTruncation=false&amp;useServerPrepStmts=false&amp;rewriteBatchedStatements=true",
                        "root", "xxxx"); 
```

您的插入查询对我来说看起来不对。缺少一个分号。

```
 String sqlInsert="insert into country(Country_Name) values('"+country+"');";
  String sqlselect="select * from country order by country_name;"; 
```

发布任何被抛出的异常。

编辑：显示记录功能已被 OP 纠正。我的误解是；是必须的。请参阅[此](https://stackoverflow.com/questions/11855799/understanding-mysterious-oracle-jdbc-errors-ora-00911-invalid-character)以获得更多说明。

```
public static  Connection createConnection()
    {
        try
        {
            Class.forName("com.mysql.jdbc.Driver");

    conn=DriverManager.getConnection("jdbc:mysql://localhost:33/ecom_db","root","root");

        }
        catch(Exception e)
        {
            e.printStackTrace();

        }
        return conn;
        } 
```

# c# - 是否可以使用 .NET 异步方法获得良好的堆栈跟踪？

> ID：15410661
> 
> 赞同：77
> 
> 时间：2013-03-14T13:29:18.787
> 
> 标签：c#, asp.net-web-api, stack-trace, async-await

我在 WebApi 应用程序中有以下示例代码设置：

```
[HttpGet]
public double GetValueAction()
{
    return this.GetValue().Result;
}

public async Task<double> GetValue()
{
    return await this.GetValue2().ConfigureAwait(false);
}

public async Task<double> GetValue2()
{
    throw new InvalidOperationException("Couldn't get value!");
} 
```

可悲的是，当 GetValueAction 被命中时，返回的堆栈跟踪是：

```
 " at MyProject.Controllers.ValuesController.<GetValue2>d__3.MoveNext() in c:\dev\MyProject\MyProject\Controllers\ValuesController.cs:line 61 --- End of stack trace from previous location where exception was thrown --- 
at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) 
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) 
at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
at MyProject.Controllers.ValuesController.<GetValue>d__0.MoveNext() in c:\dev\MyProject\MyProject\Controllers\ValuesController.cs:line 56" 
```

因此，我在跟踪中得到（损坏的）GetValue2 和 GetValue，但没有提到 GetValueAction。难道我做错了什么？是否有另一种模式可以让我获得更完整的堆栈跟踪？

编辑：我的目标不是编写依赖于堆栈跟踪的代码，而是使异步方法中的故障更容易调试。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-14T14:51:47.913

首先，堆栈跟踪不会像大多数人认为的那样做。它们在调试期间很有用，但不适用于运行时使用，尤其是在 ASP.NET 上。

此外，堆栈跟踪在技术上是关于*代码返回的*位置，而不是*代码的来源*。对于简单（同步）代码，两者是相同的：代码总是返回到调用它的任何方法。但是，对于异步代码，这两者是不同的。同样，堆栈跟踪会告诉您接下来会发生什么*，*但您对*过去*发生的事情感兴趣。

因此，堆栈框架不是您需要的正确答案。[Eric Lippert 在这里的回答中很好地解释了这一点](https://stackoverflow.com/a/15368508/263693)。

@ColeCampbell 链接到的[MSDN 文章描述了一种使用代码跟踪“意外链”（代码](http://msdn.microsoft.com/en-us/magazine/jj891052.aspx)*来自*哪里）的方法`async`。不幸的是，这种方法是有限的（例如，它不能处理 fork/join 场景）；但是，这是我所知道的唯一在 Windows 应用商店应用程序中有效的方法。

由于您使用的是具有完整 .NET 4.5 运行时的 ASP.NET，因此您可以使用更强大的解决方案来跟踪事故链：逻辑调用上下文。但是，您的`async`方法确实必须“选择加入”，因此您不会像使用堆栈跟踪那样免费获得它。我刚刚在尚未发布的博客文章中写了这个，所以你可以预览一下。:)

您可以围绕逻辑调用上下文自己构建调用“堆栈”，如下所示：

```
public static class MyStack
{
  // (Part A) Provide strongly-typed access to the current stack
  private static readonly string slotName = Guid.NewGuid().ToString("N");
  private static ImmutableStack<string> CurrentStack
  {
    get
    {
      var ret = CallContext.LogicalGetData(name) as ImmutableStack<string>;
      return ret ?? ImmutableStack.Create<string>();
    }
    set { CallContext.LogicalSetData(name, value); }
  }

  // (Part B) Provide an API appropriate for pushing and popping the stack
  public static IDisposable Push([CallerMemberName] string context = "")
  {
    CurrentStack = CurrentStack.Push(context);
    return new PopWhenDisposed();
  }
  private static void Pop() { CurrentContext = CurrentContext.Pop(); }
  private sealed class PopWhenDisposed : IDisposable
  {
    private bool disposed;
    public void Dispose()
    {
      if (disposed) return;
      Pop();
      disposed = true;
    }
  }

  // (Part C) Provide an API to read the current stack.
  public static string CurrentStackString
  {
    get { return string.Join(" ", CurrentStack.Reverse()); }
  }
} 
```

（`ImmutableStack`可[在此处](https://nuget.org/packages/Microsoft.Bcl.Immutable)获得）。然后你可以像这样使用它：

```
static async Task SomeWork()
{
  using (MyStack.Push())
  {
    ...
    Console.WriteLine(MyStack.CurrentStackAsString + ": Hi!");
  }
} 
```

这种方法的好处是它适用于*所有* `async`代码：fork/join、自定义等待对象`ConfigureAwait(false)`等。缺点是您增加了一些开销。此外，这种方法**仅适用于 .NET 4.5**；.NET 4.0 上的逻辑调用上下文无法`async`识别并且**无法**正常工作。

**更新：**我发布了一个[NuGet 包（在我的博客中描述）](http://blog.stephencleary.com/2013/05/announcement-async-diagnostics.html)，它使用 PostSharp 自动注入推送和弹出。因此，现在获得良好的跟踪应该要简单得多。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2018-07-06T22:29:22.750

这个问题及其最高投票答案是在 2013 年写的。从那时起情况有所改善。

.NET Core 2.1 现在提供开箱即用的可理解的异步堆栈跟踪；请参阅[.NET Core 2.1 中的 Stacktrace 改进](https://www.ageofascent.com/2018/01/26/stack-trace-for-exceptions-in-dotnet-core-2.1/)。

对于仍在使用 .NET Framework 的用户，有一个出色的 NuGet 包可以修复堆栈跟踪中的异步（以及许多其他晦涩难点）：[Ben.Demystifier](https://github.com/benaadams/Ben.Demystifier)。这个包优于其他建议的优点是它不需要更改抛出的代码或程序集；您只需调用`Demystify`或`ToStringDemystified`捕获的异常。

将此应用于您的代码：

```
System.AggregateException: One or more errors occurred. ---> System.InvalidOperationException: Couldn't get value!
   at async Task<double> ValuesController.GetValue2()
   at async Task<double> ValuesController.GetValue()
   --- End of inner exception stack trace ---
   at void System.Threading.Tasks.Task.ThrowIfExceptional(bool includeTaskCanceledExceptions)
   at TResult System.Threading.Tasks.Task<TResult>.GetResultCore(bool waitCompletionNotification)
   at TResult System.Threading.Tasks.Task<TResult>.get_Result()
   at double ValuesController.GetValueAction()
   at void Program.Main(string[] args)
---> (Inner Exception #0) System.InvalidOperationException: Couldn't get value!
   at async Task<double> ValuesController.GetValue2()
   at async Task<double> ValuesController.GetValue()<--- 
```

诚然，由于您使用`Task<T>.Result`. 如果您将您的`GetValueAction`方法转换为 async（本着[async all way](https://msdn.microsoft.com/en-us/magazine/jj991977.aspx)的精神），您将获得预期的干净结果：

```
System.InvalidOperationException: Couldn't get value!
   at async Task<double> ValuesController.GetValue2()
   at async Task<double> ValuesController.GetValue()
   at async Task<double> ValuesController.GetValueAction() 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-11-20T17:10:33.720

async/await king 对此有一个很好的 nuget 扩展。

[https://www.nuget.org/packages/AsyncStackTraceEx/](https://www.nuget.org/packages/AsyncStackTraceEx/)

你需要改变你的等待电话

```
Await DownloadAsync(url) 
```

到

```
Await DownloadAsync(url).Log() 
```

最后，在 catch 块中，只需调用

```
ex.StackTraceEx() 
```

一个重要的注意事项：此方法只能调用一次，并且 ex.StackTrace 之前不得评估。似乎堆栈只能读取一次。

# c# - 快速、安全的服务器端图像大小调整的推荐方法

> ID：15410662
> 
> 赞同：0
> 
> 时间：2013-03-14T13:29:19.063
> 
> 标签：c#, .net, asp.net-mvc, azure, imagemagick

我目前有使用 GDI ( `System.Drawing`) 的工作代码。但我正在考虑将其转换为使用`System.Windows.Media.Imaging`或者**ImageMagick**

我担心这不应该泄漏内存，应该是线程安全的、多线程的并且应该提供高质量的结果。ImageMagick 似乎提供了所有这些。但是，`System.Windows.Media.Imaging`已建议将其作为“更清洁”的解决方案。

你知道这两种方法有什么陷阱吗？

*还有其他我应该考虑的选择吗？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:40:36.933

我有这个例程为我工作

```
public Bitmap FitImage(Image imgPhoto, int Width, int Height)
{
  int sourceWidth = imgPhoto.Width;
  int sourceHeight = imgPhoto.Height;
  int sourceX = 0;
  int sourceY = 0;
  int destX = 0;
  int destY = 0;

  float nPercent = 0;
  float nPercentW = 0;
  float nPercentH = 0;

  nPercentW = ((float)Width / (float)sourceWidth);
  nPercentH = ((float)Height / (float)sourceHeight);

  if (nPercentH < nPercentW) {
    nPercent = nPercentW;
    destY = (int)((Height - (sourceHeight * nPercent)) / 2);
  } else {
    nPercent = nPercentH;
    destX = (int)((Width - (sourceWidth * nPercent)) / 2);
  }

  int destWidth = (int)Math.Round(sourceWidth * nPercent);
  int destHeight = (int)Math.Round(sourceHeight * nPercent);

  Bitmap newPhoto = new Bitmap(Width, Height, PixelFormat.Format24bppRgb);
  Graphics newgrPhoto = Graphics.FromImage(newPhoto);
  newgrPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic; 
  newPhoto.SetResolution(imgPhoto.HorizontalResolution, imgPhoto.VerticalResolution);

  newgrPhoto.PixelOffsetMode = PixelOffsetMode.Half;

  var attr = new ImageAttributes();
  attr.SetWrapMode(WrapMode.TileFlipXY);

  newgrPhoto.DrawImage(imgPhoto,
      new Rectangle(destX, destY, destWidth, destHeight),
      sourceX, sourceY, sourceWidth, sourceHeight,
      GraphicsUnit.Pixel,
      attr
   );

  newgrPhoto.Dispose();

  return newPhoto;
} 
```

可能不会完全按照您的意愿行事，但您会大致了解。它在多线程环境中使用并且不会泄漏。

# matlab - 在 Matlab 中修改矩阵元素

> ID：15410664
> 
> 赞同：0
> 
> 时间：2013-03-14T13:29:28.397
> 
> 标签：matlab, matrix, window, command, element

我有一个 3 列和 N 行的矩阵。我正在尝试修改一个元素并查看该元素（通过不放置分号）。出于某种原因，它总是给我整行。

这是代码及其作用：

```
for i=1:N
   [fitG params resnorm residual]=lorentzfit3(X,Y,[]);
   PICSG(i,1)= params(2)
   PICSG(i,2)= params(5)
   PICSG(i,3)= params(8) 
end 
```

每个 N 都给出 X 和 Y。Params 在出口中有 10 个参数。这是我运行此代码时的命令窗口结果。

```
PICSG =
2.6288e+09

PICSG =
1.0e+09 *
2.6288    2.8425

PICSG =
1.0e+09 *
2.6288    2.8425    2.7368 
```

为什么它显示所有 PICSG 而不是只显示我要求的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T16:11:55.407

当您执行 PICSG(i,1) = params(2) 时，您不是在要求 Matlab 显示 PICSG(i,1)，而是在进行分配并且不添加分号是在要求 MATLAB 显示结果的那个任务。

赋值后，如果不使用分号，MATLAB 会显示所有修改后的矩阵，而不仅仅是更改后的值。

如果要显示值，请使用：

```
for i=1:N
   [fitG params resnorm residual]=lorentzfit3(X,Y,[]);
   PICSG(i,1)= params(2); disp(PICSG(i,1));
   PICSG(i,2)= params(5); disp(PICSG(i,2));
   PICSG(i,3)= params(8); disp(PICSG(i,3));
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:54:31.510

为 PICSG 预分配内存

```
PICSG = zeros(N, 3) 
```

# java - 当创建多个静态类实例时会发生什么？

> ID：15410665
> 
> 赞同：3
> 
> 时间：2013-03-14T13:29:30.797
> 
> 标签：java, class, static

如果我重新实例化一个静态类，之前分配的内存会发生什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T13:32:53.733

只有嵌套类可以`static`。嵌套`static`类的实例的行为类似于任何其他类的实例：

*   只要有对它的实时（即可达）引用，实例就会被保留；
*   一旦它变得不可访问，它就有资格进行垃圾收集；
*   在它符合条件后的某个时刻，它会被垃圾收集。

如果您实际上是在询问`static`参考：

```
public static Object obj = object1;
public static void main(String[] args) {
  obj = object2;
} 
```

这些行为与任何其他参考一样。

在上面的代码中，一旦您重新分配`obj`指向`object2`，这可能会或可能不会有`object1`资格进行垃圾收集。这完全取决于是否有任何幸存的引用。

# javascript - 使用 javascript 实现 Pinterest 时出错

> ID：15410666
> 
> 赞同：0
> 
> 时间：2013-03-14T13:29:33.747
> 
> 标签：javascript, android, cordova, pinterest

我正在我的 phonegap android 应用程序中实现 Pinterest。我正在使用的代码如下：

```
<html>
<head>
    <title>PINTEREST</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
   <meta name="layout" content="mobile"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
</head>
<body>
<a data-pin-config="above" href="https://pinterest.com/pin/create/button/?url=http%3A%2F%2Fwww.flickr.com%2Fphotos%2Fkentbrew%2F6851755809%2F&media=http%3A%2F%2Ffarm8.staticflickr.com%2F7027%2F6851755809_df5b2051c9_z.jpg&description=Next%20stop%3A%20Pinterest" data-pin-do="buttonPin" ><img src="https://assets.pinterest.com/images/pidgets/pin_it_button.png" /></a>
<script type="text/javascript" src="https://assets.pinterest.com/js/pinit.js"></script>
</body>
</html> 
```

它在浏览器中运行良好，但是当我在 Android 设备上安装它时，我收到以下警报：

> 发生网络错误(file://assets.pinterest.com/pidget.html)#via=file%3A%2F%2F%2Fandroid_asset%2Ftest.html&type=pidget)

这是因为

```
<script type="text/javascript" src="https://assets.pinterest.com/js/pinit.js"></script> 
```

但我必须使用它。请帮我解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:33:31.807

您可以将资产下载到本地。否则它不会在没有网络连接的手机上显示任何内容。使用来自其他网站的资源可能也是一个坏主意，请参阅[“内联链接（热链接）”](http://en.wikipedia.org/wiki/Inline_linking)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:37:45.403

您的应用程序可能没有[`INTERNET`权限](http://developer.android.com/reference/android/Manifest.permission.html#INTERNET)。检查它是否包含在`AndroidManifest.xml`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T10:57:15.603

我通过异步加载 pinit.js 解决了这个问题。我用的是：

```
 <script type="text/javascript">
(function (w, d, load) {
 var script,
 first = d.getElementsByTagName('SCRIPT')[0],  
 n = load.length,
 i = 0,
 go = function () {
   for (i = 0; i < n; i = i + 1) {
     script = d.createElement('SCRIPT');
     script.type = 'text/javascript';
     script.async = true;
     script.src = load[i];
     first.parentNode.insertBefore(script, first);
   }
 }
 if (w.attachEvent) {
   w.attachEvent('onload', go);
 } else {
   w.addEventListener('load', go, false);
 }
}(window, document,
 ['//assets.pinterest.com/js/pinit.js']
));    
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-02T20:08:24.947

您可以使用 SocialSharing phonegap 插件在 Android 上固定一些东西。只需添加[此插件](https://github.com/EddyVerbruggen/SocialSharing-PhoneGap-Plugin)并添加一个按钮：

<button onclick="window.plugins.socialsharing.shareVia('pinterest', 'Wow!')">钉住它！</button>

再简单不过了:)

# sqlite - ORMLite：如何在没有外键的情况下连接两个表

> ID：15410674
> 
> 赞同：2
> 
> 时间：2013-03-14T13:29:48.680
> 
> 标签：sqlite, ormlite

我必须加入两个独立的表`sqlite`。他们没有任何外键关系。

例子：

*   表 A 有一个字段`name`
*   表 B 有一个字段`primaryName`

我想做类似的事情

```
select A.* from A inner join B on A.name = B.primaryName
    where A.id = 10 and B.address is null 
```

`ORMLite`强制执行外键，有没有办法做到这一点`ORMLite`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T19:45:20.363

不幸的是，简短的回答是“暂时没有”。您当然可以使用原始查询功能来支持这一点：

> [http://ormlite.com/docs/raw-queries](http://ormlite.com/docs/raw-queries)

**编辑：**

这已 [终于] 添加了 ORMLite。它已被检入到主干中，并将在版本 4.49 中。这是github上的签到：

> [https://github.com/j256/ormlite-core/commit/b37914d76fbbbbbc70d473be1cf1b6de19b847f5](https://github.com/j256/ormlite-core/commit/b37914d76fbbbbbc70d473be1cf1b6de19b847f5)

# ios - 如何下载图像，将它们转换为单个 PDF 并将其加密存储在缓冲磁盘上？

> ID：15410675
> 
> 赞同：-1
> 
> 时间：2013-03-14T13:29:54.733
> 
> 标签：ios, objective-c, xcode, pdf, encryption

我想通过网络服务下载一个文件。Web 服务将每个页面作为图像返回（更准确地说：图像的 URL）（此流程无法更改）。

执行此服务后，我有一组图像的 URL。我想下载它们，下载后我想将它们转换为 PDF，转换后我想将 PDF 存储在磁盘上，加密 (AES)。

这些任务中的每一个都不是那么复杂，但我希望它具有内存效率（即缓冲）。

我想要的工作流程：

1.  对于每个 URL
2.  下载数据
3.  将该数据转换为 PDF 页面
4.  加密该页面
5.  将其附加到磁盘上的某个文件

这可能吗？如果是，如何？

**希望还有人看这篇**

我的想法：

1.  子类 NSMutableData。（我将其命名为 NSPersistentData）
2.  覆盖 [appendBytes:]。每次应该附加字节时，加密它们并将它们存储在磁盘上。
3.  将该子类传递给 UIGraphicsBeginPDFContextToData。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:48:32.443

**下载图片**

[您可以使用NSURLConnection](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CGPDFContext/Reference/reference.html)或一些开源代码下载图像！！！

**转换为 PDF**

为此，您可以创建一个[CGPDFContext](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CGPDFContext/Reference/reference.html)，将您的 UIImage 绘制到其中，并将其保存到文件中。

完成后，对文件应用一些加密技术并将其保存到磁盘。

希望这可以帮助 ！！！

# asp.net - 如何在asp.net中解决“无法找到ID为X的控件或在回发后将不同的控件分配给相同的ID”？

> ID：15410687
> 
> 赞同：3
> 
> 时间：2013-03-14T13:30:34.900
> 
> 标签：asp.net, autopostback

请帮我纠正这个错误。

> 发生错误，因为无法找到 ID 为“ctl81”的控件，或者在回发后将不同的控件分配给了相同的 ID。如果未分配 ID，请显式设置引发回发事件的控件的 ID 属性以避免此错误

此错误发生在单击 asp 按钮的回帖中。页面中的所有控件都是动态生成的。我试图在页面源中找到这个控件，但没有成功。

```
 HtmlGenericControl td1 = new HtmlGenericControl("td");
    TextBox txt1 = new TextBox();
    txt1.ID = "toqty"+i.Tostring();
    td.controls.add(txt1);
    placeholder.controls.add(td); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:48:38.580

由于错误是由于单击按钮而发生的，因此在单击按钮之前生成的控件可能已从相应的表单中清除。因此，我建议您通过在 button_click() 方法上固定断点来检查按钮单击后编写的方法或代码。试试这个，请留下答复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T14:15:22.183

错误本身提到了解决方案。首先检查回发后ID是否仍然分配给控件。如果不是，请显式设置 ID 属性以避免此错误

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-29T10:21:06.933

在我的情况下，类似的异常是由在 Render 方法中强制设置了 id 属性的控件引起的，而没有将其 ID 属性设置为相同的值。

显然，AutoID 模式存在问题，即后面代码中的 ID 与呈现的 id 属性不匹配。

我宁愿不更改渲染阶段，因为该控件广泛用于大型项目，并且许多功能都依赖于它按原样工作。相反，我明确设置了 ID 以确保它是唯一的，并且不同于任何可以自动设置的东西。它有帮助。

# sed - 从 sed 排序文本输出

> ID：15410688
> 
> 赞同：1
> 
> 时间：2013-03-14T13:30:36.013
> 
> 标签：sed, awk

我有以下文字：

```
 FLAGS (\Seen \Flagged))
* 1001 FETCH (BODY[HEADER.FIELDS (message-id subject)] {167}
Message-ID: ail test 13
Subject: =?utf-8?Q?RDM=20Request=20RD00001578:=20Under=20Review=20->=20Requested?=

 FLAGS (\Seen \Flagged))
* 1010 FETCH (BODY[HEADER.FIELDS (message-id subject)] {145}
Subject: RE: ail test 12
Message-ID: <81B1DDBBD5E5D148915DBDF77378184D1036F5CD1B@xxxxxxxxxxxxxxxxxxxxxxxxx>

 FLAGS (\Seen \Flagged))
* 1020 FETCH (BODY[HEADER.FIELDS (message-id subject)] {116}
Subject: RE: ail test 14
Message-ID: <8A20A6EF23B11D41A1B3222195A1B2683AD3D013@xxxxxxxxxxxxxxxxxxxxxxxxx> 
```

我如何使用`sed`或`awk`获取格式如下：

```
Subject : the subject
Message-ID: The message ID 
```

我知道如何获取字段，我的主要问题是将所需的顺序放在主题必须始终位于消息 ID 之前的位置。

编辑：

SO 是 ( uname -a ) SunOS serverName 5.9 Generic_122300-61 sun4u sparc SUNW,Sun-Fire-15000

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:52:57.207

使用 GNU awk（用于 gensub()）：

```
$ awk -v RS= '{
    print gensub(/.*\n(Subject[^\n]+).*/,"\\1","")
    print gensub(/.*\n(Message[^\n]+).*/,"\\1","")
}' file
Subject: =?utf-8?Q?RDM=20Request=20RD00001578:=20Under=20Review=20->=20Requested?=
Message-ID: ail test 13
Subject: RE: ail test 12
Message-ID: <81B1DDBBD5E5D148915DBDF77378184D1036F5CD1B@xxxxxxxxxxxxxxxxxxxxxxxxx>
Subject: RE: ail test 14
Message-ID: <8A20A6EF23B11D41A1B3222195A1B2683AD3D013@xxxxxxxxxxxxxxxxxxxxxxxxx> 
```

您可以在任何 awk 中使用 match()+substr() 或几个 sub() 代替 gensub() 来执行相同的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:32:52.923

按顺序打印值：

```
$ awk '/^Subject:/{s=$0}/^Message-ID:/{m=$0}s&&m{print s"\n"m"\n";s=0;m=0}' file
Subject: =?utf-8?Q?RDM=20Request=20RD00001578:=20Under=20Review=20->=20Request...
Message-ID: ail test 13

Subject: RE: ail test 12
Message-ID: <81B1DDBBD5E5D148915DBDF77378184D1036F5CD1B@xxxxxxxxxxxxxxxxxxxxxx...

Subject: RE: ail test 14
Message-ID: <8A20A6EF23B11D41A1B3222195A1B2683AD3D013@xxxxxxxxxxxxxxxxxxxxxxxxx> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T13:36:01.953

在*段落*模式 ( ) 中使用[perl](/questions/tagged/perl "显示标记为“perl”的问题")：*`-00`*

 *```
perl -00 -lne '
    ($subject) = $_ =~ m/Subject:\s*(.*)/;
    ($message) = $_ =~ m/Message-ID:\s*(.*)/;
    print "Subject: $subject\nMessage-ID: $message"
' input.txt 
```

## 输出

```
Subject: =?utf-8?Q?RDM=20Request=20RD00001578:=20Under=20Review=20->=20Requested?=
Message-ID: ail test 13

Subject: RE: ail test 12
Message-ID: <81B1DDBBD5E5D148915DBDF77378184D1036F5CD1B@xxxxxxxxxxxxxxxxxxxxxxxxx>

Subject: RE: ail test 14
Message-ID: <8A20A6EF23B11D41A1B3222195A1B2683AD3D013@xxxxxxxxxxxxxxxxxxxxxxxxx> 
```

## 笔记

来自[`perldoc perlrun`](http://perldoc.perl.org/perlrun.html)：

> -0[八进制/十六进制]
> 
> 将输入记录分隔符 ($/) 指定为八进制或十六进制数。
> 特殊值 00 将导致 Perl 以段落模式 slurp 文件。任何 0400 或更高的值都会导致 Perl 读取整个文件，但按照惯例，值 0777 是通常用于此目的的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T14:53:58.633

如果您允许自己多次阅读文件`sed`，则无需：`awk`

```
grep '^Subject:' your_file | paste -d "\n" - <(grep '^Message-ID' your_file) 
```

如果您想要记录之间的空行：

```
grep '^Subject:' your_file | paste -d "\n" - <(grep '^Message-ID' your_file) | sed -e '3,$s/^Subject:/\n&/' 
```

请注意，如果文件在读取时可以更改，则此方法不起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-14T15:09:48.793

在`sed`中，这有点棘手：

```
sed -n -e '/^Subject:/H;/^Message-ID:/H' \
    -e 'x' \
    -e '/\nSubject:.*\n.*/{s/^\n//;p;s/.*//}' \
    -e '/\nMessage-ID:.*\n.*/{s/^\n\(.*\)\n\(.*\)/\2\n\1/;p;s/.*//}' \
    -e 'x' \
    your_file 
```

该脚本的思想如下：

1.  `Subject:`将以of开头的行存储`Message-ID:`在保持空间 (1st `-e`) 中。
2.  为每一行做#1，在读取一条记录后，我们将有`\nSubject:.*\n.*`或`\nMessage-ID:.*\n.*`在保持空间中。
3.  然后工作保持空间很容易获得预期的输出。*

# ios - iPhone 使用 AFNetworking 上传多部分文件

> ID：15410689
> 
> 赞同：25
> 
> 时间：2013-03-14T13:30:39.153
> 
> 标签：ios, objective-c, api, file-upload

在我的 iOS 应用程序中，我想使用`NSMutableURLRequest`用于多部分文件的 java API 上传文件。这是显示参数的表格。

```
 <form action="API_URL" encType='multipart/form-data' method=post>
            <input type=file name="files">
            <input type=submit value="Upload Attempt Files"> 
```

编辑表格2

```
 <form action='URL' method="post" encType='multipart/form-data'>
<input name="key1" value='123'>
<input name="key2" value='asdf'>
<input name="key3" value='qwerty'>
<input name="key4" value='aaa'>
<input name="key5" value='aaa'>
<input name="key6" value='false'>
<input type="file"  name="files">
<input type=submit value="Create Forum Posts">
   </form> 
```

我怎样才能做到这一点？

这个[问题](https://stackoverflow.com/questions/8557364/post-jpeg-upload-with-afnetworking)展示了如何在 iOS 中使用[AFNetworking](https://github.com/AFNetworking/AFNetworking/blob/master/README.md)上传多部分文件（目标 c）。但我不知道如何按照我使用的形式放置参数。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2013-03-14T15:16:33.490

查看您的 HTML，`name`您的`<input type=file>`is `files`，因此，您将`@"files"`用作`name`该方法的参数[`appendPartWithFileData`](http://cocoadocs.org/docsets/AFNetworking/3.0.4/Protocols/AFMultipartFormData.html#//api/name/appendPartWithFileData:name:fileName:mimeType:)。例如，使用[AFNetworking 3.x](https://github.com/AFNetworking/AFNetworking)：

```
AFHTTPSessionManager *manager = [AFHTTPSessionManager manager];

[manager POST:urlString parameters:nil constructingBodyWithBlock:^(id<AFMultipartFormData> formData) {
    [formData appendPartWithFileData:imageData
                                name:@"files"
                            fileName:photoName mimeType:@"image/jpeg"];

    [formData appendPartWithFormData:[key1 dataUsingEncoding:NSUTF8StringEncoding]
                                name:@"key1"];

    [formData appendPartWithFormData:[key2 dataUsingEncoding:NSUTF8StringEncoding]
                                name:@"key2"];

    // etc.
} progress:nil success:^(NSURLSessionDataTask *task, id responseObject) {
    NSLog(@"Response: %@", responseObject);
} failure:^(NSURLSessionDataTask *task, NSError *error) {
    NSLog(@"Error: %@", error);
}]; 
```

（对于 AFNetworking 1.x 和 2.x 语法，请参阅此答案的修订历史。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-20T13:55:44.640

```
-(void) makePhotoUploadRequest{

    NSArray *keys = [[NSArray alloc]initWithObjects:@"UserID", @"CompanyName" ,@"Location",@"Latitude",@"Longitude",@"Tagline",@"Goals",@"ColorName",nil];
    NSArray *values =[[NSArray alloc]initWithObjects:@"103",@"queppelin",@"Jaiur",@"11.3" ,@"12.3",@"Let's do it",@"Let's do it",@"Let's do it", nil];
    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];

    NSURL *baseUrl = [NSURL URLWithString:[NSString stringWithFormat:@"%@%@/%@/RegisterCompanyUser",serverRequest,serverPort,serverName]];

    NSString *charset = (NSString *)CFStringConvertEncodingToIANACharSetName(CFStringConvertNSStringEncodingToEncoding(NSUTF8StringEncoding));
    [request setURL:baseUrl];
    [request setHTTPMethod:@"POST"];

   NSString *boundary = @"0xKhTmLbOuNdArY";
    NSString *endBoundary = [NSString stringWithFormat:@"\r\n--%@\r\n", boundary];

    NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; charset=%@; boundary=%@", charset, boundary];
    [request addValue:contentType forHTTPHeaderField: @"Content-Type"];

    NSMutableData *tempPostData = [NSMutableData data];
    [tempPostData appendData:[[NSString stringWithFormat:@"--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];

           for(int i=0;i<keys.count;i++){
               NSString *str = values[i];
               NSString *key =keys[i];
               NSLog(@"Key Value pair: %@-%@",key,str);
               [tempPostData appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"%@\"\r\n\r\n", key] dataUsingEncoding:NSUTF8StringEncoding]];
               [tempPostData appendData:[str dataUsingEncoding:NSUTF8StringEncoding]];
              // [tempPostData appendData:[@"\r\n--%@\r\n",boundary dataUsingEncoding:NSUTF8StringEncoding]];
                   [tempPostData appendData:[endBoundary dataUsingEncoding:NSUTF8StringEncoding]];

        }

    // Sample file to send as data
    [tempPostData appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"Image\"; filename=\"%@\"\r\n", @"company-logo.png"] dataUsingEncoding:NSUTF8StringEncoding]];
    [tempPostData appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];

    UIImage *myImageObj = [UIImage imageNamed:@"company-logo.png"];
    NSData *mydata= UIImagePNGRepresentation(myImageObj);
    NSLog(@"Image data:%d",mydata.length);
        [tempPostData appendData:mydata];

    [tempPostData appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [request setHTTPBody:tempPostData];

    NSURLConnection *theConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
    if( theConnection )
    {
       dataWebService = [NSMutableData data] ;
        NSLog(@"request uploading successful");
    }
    else
    {
        NSLog(@"theConnection is NULL");
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-23T06:15:00.243

您可以使用以下代码在使用 afnetworking 3.x 的多部分请求中发送图像和 n 个参数

```
 AFHTTPSessionManager *manager = [AFHTTPSessionManager manager];
 //manager.responseSerializer = [AFHTTPResponseSerializer serializer]; // uncomment this line when the server is not returning JSON

[manager POST: urlString parameters: nil constructingBodyWithBlock:^(id<AFMultipartFormData> formData) {
    [formData appendPartWithFileData:imageData
                                name:@"file"
                            fileName:imageName mimeType:@"image/jpeg"];
        for (NSString *key in parameters) {
            [formData appendPartWithFormData:[[[parameters objectForKey:key] description] dataUsingEncoding:NSUTF8StringEncoding] name:key];
        }

    // etc.
} progress:nil success:^(NSURLSessionDataTask *task, id responseObject) {
    NSLog(@"Response: %@", responseObject);
} failure:^(NSURLSessionDataTask *task, NSError *error) {
    NSLog(@"Error: %@", error);
}]; 
```

# javascript - 丢弃空格或空字符

> ID：15410691
> 
> 赞同：1
> 
> 时间：2013-03-14T13:30:44.707
> 
> 标签：javascript

将是一个简单的问题，但对我来说不是:)。

我正在浏览这段代码：

```
<!DOCTYPE html>
<html>
<body>

<h1>My First JavaScript</h1>

<p>Please input a number.</p>

<input id="demo" type="text">

<script>
function myFunction()
{
var x=document.getElementById("demo").value;
if(x==""||isNaN(x)) /*?*/
    {
    alert("Not Numeric");
    }
}
</script>

<button type="button" onclick="myFunction()">Click Me!</button>

</body>
</html> 
```

这将给出类似的输出

![这个](../Images/4dc9326194b591dd939f429edfdeeab5.png)

在代码中，我们通过检查来检查是否没有输入值，提醒用户`if(x==""||isNaN(x))`。但是，如果我在文本框中输入空格字符，则检查失败。检查它的方法是什么？

PS：我正在使用铬。并且 trim() 不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:36:03.030

尝试正则表达式 insted

```
function myFunction(){
    var x=document.getElementById("demo").value;
    if(!(/^\d+$/.test(x))) {
        alert("Not Numeric");
    }
} 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/bTBwS/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:37:48.297

如果您可以使用 jquery，则 jQuery 的修剪很方便。

$.trim('任意值');

或者您只想使用 JavaScript，使用修剪功能忽略空白。即使新浏览器支持修剪。我建议创建一个单独的函数来克服浏览器兼容性问题。

创建一个函数

```
function trim(this)
{
return this.replace(/^\s+|\s+$/g, '');
}; 
```

然后在您的代码中将代码更改为

```
var x=trim(document.getElementById("demo").value); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:42:03.667

如果你想避免使用 trim 或 regex，你可以使用`parseFloat`命令。要实现这一点，请使用，如果 x 是空格或其他任何不是数字的东西`parseFloat(x)`，它将返回。`NaN`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T13:35:09.470

我建议`trim`在`x`检查它是否是一个数字之前先打电话。`trim`将删除内容左侧和右侧的任何空格（如果有）。

```
var x=document.getElementById("demo").value;
x = x.trim(); 
```

请注意，修剪在某些较旧的浏览器中不可用。如果您需要支持它们，您可以自己实现它或使用像[`jQuery.trim`](http://api.jquery.com/jQuery.trim/).

你也可以使用这个：

```
if(isNaN(parseInt(x))) 
```

（假设你的 x 应该是一个整数。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-14T13:35:53.900

修剪你的输入字符串

```
var x=document.getElementById("demo").value.trim(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-14T13:38:28.817

较新的浏览器支持一项`string.trim`功能。对于更广泛的覆盖范围，您可以使用正则表达式删除空格，然后检查结果的长度。如果大于零，则测试`NaN`.

这是修剪的一种方法：

```
function trim(stringToTrim) {
    return stringToTrim.replace(/^\s+|\s+$/g,"");
} 
```

测试：

```
var myString = " hello my name is ";
alert("*"+trim(myString)+"*"); 
```

这种方法是[Mozilla 的专家](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/Trim)建议的。

# javascript - 从 url 抓取哈希链接

> ID：15410694
> 
> 赞同：0
> 
> 时间：2013-03-14T13:30:51.263
> 
> 标签：javascript, jquery, hash

我的网址为：**/#profile/7** 如何让它从那里获取最后一个数字？我正在寻找从中创建一个 mysql 连接，从某处选择一些东西 WHERE id=':profile' 另外，这种方式是否安全，甚至可以建立连接吗？这就是我所拥有的。

```
<script>
      var hash = window.location.hash.substring(6);
      alert (hash);
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:39:05.180

您可以使用正则表达式：

```
var hash = window.location.hash.match(/\/(\d)/)[1] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:35:58.953

尝试使用`split()`而不是子字符串：

```
var parts = window.location.hash.split('/');
var id = parts[parts.length - 1]; 
```

# javascript - 谷歌饼图：删除饼片之间的白色间隙

> ID：15410695
> 
> 赞同：5
> 
> 时间：2013-03-14T13:30:54.167
> 
> 标签：javascript, charts, google-visualization, pie-chart

类似于[这个问题](https://stackoverflow.com/questions/18784246/removing-the-white-line-between-slices-in-flot-pie-chart/22227464)，但对于谷歌饼图：

如何删除 Google 饼图上切片之间的白线：

![在此处输入图像描述](../Images/9499891f1cb30dfd42ad591ec609f054.png)

在上图中，我想删除绿色箭头突出显示的空白。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-14T13:42:26.737

`pieSliceBorderColor`你可以通过设置to 来消除这个差距`"transparent"`。[在Google Code Playground](https://code.google.com/apis/ajax/playground/?type=visualization#pie_chart)上尝试以下操作：

```
function drawVisualization() {
  // Create and populate the data table.
  var data = google.visualization.arrayToDataTable([
    ['Task', 'Hours per Day'],
    ['Work', 11],
    ['Eat', 2],
    ['Commute', 2],
    ['Watch TV', 2],
    ['Sleep', 7]
  ]);

  // Create and draw the visualization.
  new google.visualization.PieChart(document.getElementById('visualization')).
    draw(data, {title:"So, how was your day?", pieSliceBorderColor:"transparent"});
} 
```

# c# - 调用asmx webservice时如何为base64Binary发送数据

> ID：15410697
> 
> 赞同：4
> 
> 时间：2013-03-14T13:30:58.830
> 
> 标签：c#, web-services, asmx

我必须调用一个 asmx webservice，它接受 AttachmentData 作为参数。这有一个类型为 base64Binary 的成员。

```
<s:complexType name="AttachmentData">
<s:sequence>
<s:element minOccurs="0" maxOccurs="1" name="FileName" type="s:string" /> 
<s:element minOccurs="0" maxOccurs="1" name="UploadedUserName" type="s:string" /> 
<s:element minOccurs="0" maxOccurs="1" name="Attachment" type="s:base64Binary" /> 
</s:sequence>
</s:complexType> 
```

我正在为附件成员发送文件的内容，如下所示：

```
//read the file contents
byte[] buffer = null;
     try {
        FileInfo attachment = new FileInfo(filepath);
        using (FileStream stream = attachment.OpenRead()) {
           if (stream.Length > 0) {
              buffer = new byte[stream.Length];
              stream.Read(buffer, 0, (int)stream.Length);
           }
        }
     }
     catch {
        buffer = null;
     }

//create AttachmentData object
WebSrvc.AttachmentData att = new WebSrvc.AttachmentData();
att.FileName = fileName;
att.Attachment = buffer; 
```

这是发送 base64Binary 的正确方法吗？我需要将文件内容编码为 base64 还是即时完成？我想看看我是否通过使用上面的代码不必要地膨胀了 web 服务请求的大小。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T14:26:37.253

[Base 64 编码](http://en.wikipedia.org/wiki/Base64#Examples)在输入中每 3 个字节需要 4 个字节在输出中，因此会有一些开销，但并没有那么多。

Base 64 编码的好处是它只使用可打印的字符，因此很容易嵌入到 HTTP 协议中，该协议是为处理人类可读的文本字符而构建的。

在您的代码示例中，byte[] 缓冲区在被放置在线（即嵌入并在 HTTP 协议中传输）之前会自动转换为 Base 64。

# c# - c# System.InvalidOperationException

> ID：15410700
> 
> 赞同：8
> 
> 时间：2013-03-14T13:31:07.550
> 
> 标签：c#, asynchronous, tcp, client

**一般的**

我正在尝试用 C# 编写一个非常简单的 TCPIP 客户端服务器来连接到一个 IP 地址，一个端口号，并询问非常简单的行命令，然后将回复放在 Gridbox、图形或其他显示选项中。

我在网上查看并找到了一个可下载的实用程序，它由 Jayan Nair 编写，它似乎可以正确发送消息，并且可以收到回复。

当我尝试将回复数据加载到富文本或 GridView 中时，问题就出现了。

我收到的错误消息是：- System.InvalidOperationException

我问过微软论坛，他们给了我一个非常复杂、模棱两可和过度参与的指示，告诉我应该做什么，这涉及到一个叫做 INVOKE 和 BeginInvoke 的东西，它们似乎是其中的一个项目；正确的。

我所追求的只是一个有效的例子，而不是太复杂。

这是代码：-

```
 try
        {
            SocketPacket theSockId = (SocketPacket)asyn.AsyncState;
            int iRx = theSockId.thisSocket.EndReceive(asyn);
            char[] chars = new char[iRx + 1];
            System.Text.Decoder d = System.Text.Encoding.UTF8.GetDecoder();
            int charLen = d.GetChars(theSockId.dataBuffer, 0, iRx, chars, 0);
            // 
            System.String szData = new System.String(chars);
            richTextRxMessage.Text =  szData;  // fails
            //textBox1.Text = szData;          // also fails
            WaitForData();
        } 
```

**这是错误消息：-**

```
base {System.Windows.Forms.TextBoxBase} = {Text = '((System.Windows.Forms.RichTextBox)    (((System.Windows.Forms.RichTextBox)(richTextRxMessage)))).Text' threw an exception of type   'System.InvalidOperationException'} 
```

**附加信息是：-** szData 包含大约 6300 个字符，包括制表符 (9) 和返回 (13)，并且与从服务器发送的消息一致我也尝试过使用文本框而不是富文本，结果相同

**对于那些有兴趣的人**

这是微软的链接

[http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/12a67fb0-847e-4e2b-baa8-ef6ceed60aa4/](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/12a67fb0-847e-4e2b-baa8-ef6ceed60aa4/)

* * *

*   这只是我尝试过的两个代码修改，都在相同的错误条件下失败*   我认为我需要做的是从低得多的层次开始 C#，而不仅仅是跳入并希望最好

    * * *

    ```
     public void OnDataReceived(IAsyncResult asyn)
        {

            int InputRx;
            int charLen;
            char[] Inputchars;
            System.Text.Decoder InputDecode;
            System.String szData;
            bool IfInvokeRequired;

            try

            {

                SocketPacket theSockId = (SocketPacket)asyn.AsyncState;
                InputRx = theSockId.thisSocket.EndReceive(asyn);                    // get size of input array
                Inputchars = new char[InputRx + 1];                                   // put i char array
                InputDecode = System.Text.Encoding.UTF8.GetDecoder();
                charLen = InputDecode.GetChars(theSockId.dataBuffer, 0, InputRx, Inputchars, 0);
                szData = new System.String(Inputchars);
                IfInvokeRequired = richTextRxMessage.InvokeRequired;
                if (IfInvokeRequired == true)
                {
                    richTextRxMessage.Invoke((MethodInvoker)delegate { this.Text = szData; });// fails
                    richTextRxMessage.BeginInvoke(new MethodInvoker(() => richTextRxMessage.Text = szData));//fails as well
                } 
    ```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T13:48:23.710

您收到的`InvalidOperationException`可能会有内部异常“*调用线程无法访问此对象，因为不同的线程拥有它*”。

为了调试，您可以快速设置`CheckForIllegalCrossThreadCalls`为 false。这将阻止运行时向您抛出异常，但是仅仅因为您没有收到异常并不意味着它们没有发生，因此这对于分布式软件来说是一种不好的做法，但对于调试非常方便。

为了解决您的问题，您需要调用与 UI 线程（即创建控件的线程）交互的代码，`RichTextBox`以及*唯一*允许运行与控件交互的代码的线程。

要调用 UI 线程上的代码，您可以使用以下简洁的语句：

```
richTextRxMessage.BeginInvoke(new MethodInvoker(() => richTextRxMessage.Text = szData)); 
```

非常简单，您在这里所做的只是通过委托传递您希望在 UI 线程上调用的语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:49:48.367

这是我在一些东西中使用的功能；

```
public static void InvokeEx<T>(this T @this, Action<T> action) where T : ISynchronizeInvoke
{
    if (@this.InvokeRequired)
    {
        @this.Invoke(action, new object[] { @this });
    }
    else
    {
        action(@this);
    }
} 
```

对于处理任何类型的调用，它几乎是一个不错的小方法，并且在您使用它时可以减少代码行数。要使用它，只需使用它；

```
Control.InvokeEx(f => control.DoStuff()); 
```

例如，您可以使用；

```
richTextRxMessage.InvokeEx(f => richTextRxMessage.Text =  szData); 
```

编辑：正如其他人所说，这个错误很可能是由于访问线程上的控件而不是创建它的线程，这就是需要调用的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:41:56.360

Microsoft 的答案并非完全不正确，但还有其他一些更简单的方法，尽管它们看起来并不正确。

这是我自己的代码中的一个片段，可能对您有用。

```
if (dirtyImage.InvokeRequired)
{
    dirtyImage.Invoke(new MethodInvoker(delegate { Visible = RigX.IsDirty; }));
    dirtyImage.Invoke(new MethodInvoker(delegate { Refresh(); }));
}
else
{
    dirtyImage.Visible = RigX.IsDirty;
    dirtyImage.Refresh();
} 
```

注意如何使用`InvokeRequired`和`dirtyImage.Invoke(...)`使用。通过创建委托和使用方法调用程序，我使它变得更简单，这样我就可以将所有调用都放在一个衬里。委托实质上创建了一个小方法，然后使用 MethodInvoker 调用该方法。因为更改是在 UI 线程上进行的，所以如果不使用，就不能从后台线程调用它们，这是`.Invoke`不允许的。

可以通过这种方式更改您的呼叫的方式是：

```
richTextRxMessage.Invoke(new MethodInvoker(delegate { Text =  szData; })); 
```

该调用也直接从 UI 线程本身工作，因此您实际上不需要 if 语句，但它是“成本”的术语，它比直接调用属性要慢。

当然，这只有在你一开始就在后台线程上时才会真正产生影响。如果不是，那么您需要调查错误本身。也许返回的文本有问题，将其写入文件并查看它，看看是否能发现问题。尝试手动设置 RTB 的文本，看看它是否允许这种情况发生。等等等等等等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T13:48:34.437

这个问题很可能是因为 MS 论坛上建议的多线程。当您以异步方式请求此操作时，它将创建另一个线程来处理输入，以便您的主应用程序线程不会阻塞。

要克服这个问题，您必须`Invoke`控制要更改其属性的控件。你需要这个，因为你的主应用程序线程拥有 UI，并且 UI 上的任何操作都不能从另一个线程完成。

调用并不复杂，只需几行即可完成。

更改以下行

```
richTextRxMessage.Text =  szData; 
```

至

```
richTextRxMessage.Invoke((MethodInvoker) delegate {this.Text = szData;}); 
```

此代码将要求主 ui 线程更新文本，`richTextRxMessage`而不是自己更新。

# ios - 将 iPhone 应用程序连接到接入点

> ID：15410706
> 
> 赞同：0
> 
> 时间：2013-03-14T13:31:19.400
> 
> 标签：ios, objective-c, xcode, wifi

我正在尝试创建一个应用程序来扫描可用的 wifi 网络以及是否可以访问。

这是可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:36:34.747

iOS 5 只能在越狱设备上使用私有 API 扫描网络列表。这篇[博](http://blog.guvenergokce.com/iphone-wireless-scanner-ios5/170/)文陈述了以下内容：

> 去年，Apple 已经阻止了 App Store 中的 wifi 扫描仪，但在 iOS5 之前，它仍然可以通过 WiFiManager 捆绑包供私人使用。
> 
> 在 iOS5 中，WifiManager 包不再存在，但 80211 功能仍然可以通过 IPConfiguration 包使用。

您链接的 API 提供了一个开源工具 Stumbler，看起来就像您正在寻找的东西。据称该工具可在 iOS 5 下运行。

# asp.net-mvc-3 - Jquery：西里尔符号在提交时变成问号

> ID：15410707
> 
> 赞同：1
> 
> 时间：2013-03-14T13:31:23.223
> 
> 标签：asp.net-mvc-3, jquery, utf-8

我使用 jquery 和 ajax 提交 UTF-8 文本，以确保一切都是 utf-8，我在 web.config 中放置了以下内容：

```
<globalization
      fileEncoding="utf-8"
      requestEncoding="utf-8"
      responseEncoding="utf-8"
      culture="en-US"
      uiCulture="en"
    /> 
```

jQuery代码：

```
$.ajax({
    url: "@Url.Content("~/Home/EditProductTranslations/")",
    type: "POST",
    data: $(this).serialize(),
    contentType: "application/x-www-form-urlencoded;charset=UTF-8",
    scriptCharset: "utf-8" ,
    success: function (result) {
        //$('#@resultDiv').html(result);

        var info = $("<span class='successMsg'></span>").hide().html(result);
        info.insertAfter(curSubmit).fadeIn(300).delay(2700).fadeOut(400, function () {
            $(this).remove();
        });
    }
}); 
```

我还通过使用 notepad++ 将其转换为 UTF-8 验证了它的 UTF-8 数据（尽管当它被粘贴时它说它已经是 UTF-8 并且数据在 UTF-8 站点上完美显示）。但我只是得到?????????? 当我保存表格时，而不是西里尔符号。

该项目的布局文件也有 UTF-8 声明元标记，我已经完成了所有常用的东西。尝试在运行 firebug 的情况下在 firefox 上运行提交，并且似乎所有内容都已正确提交？我需要在控制器内声明 UTF-8 还是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T08:57:03.360

添加`;CharSet=utf8`到连接字符串

# text - imagemagick 文本作为纯色背景上的孔

> ID：15410708
> 
> 赞同：1
> 
> 时间：2013-03-14T13:31:26.490
> 
> 标签：text, background, imagemagick, transparent

我只是想用 IM 创建一些文本作为图像。我希望图像的大小自动调整为文本长度。我还需要背景颜色为指定的纯色（本例中为 rgb 166,127,000），文本颜色为“透明”。我的意思是背景上的文字“作为洞”。

我可以使用以下命令获取它：

```
/opt/local/bin/convert \( -font /fonts/myFont.ttf -pointsize 25 -background none -fill 'rgb(166,127,000)' -gravity center +antialias label:'TEST'   \)  -channel a -separate +channel -negate -fill  -alpha set -channel RGBA -fill none -opaque black -fill 'rgb(166,127,000)' -opaque white  png:- 
```

我正在寻找一种更简单的方法来做到这一点。此外，我在抗锯齿方面遇到问题，并且文本看起来太笨重。

谢谢你。

# twitter-bootstrap - Twitter Bootstrap - 如何获得灰色字形图标

> ID：15410710
> 
> 赞同：14
> 
> 时间：2013-03-14T13:31:27.497
> 
> 标签：twitter-bootstrap, glyphicons

我正在使用 twitter bootstrap，我对他们主页中使用的 glyphicon 有疑问。作为参考，请参考 Base CSS 页面：http: [//twitter.github.com/bootstrap/base-css.html](http://twitter.github.com/bootstrap/base-css.html)

在左侧，您可以看到导航 - 排版、代码、表格等。现在，如果您注意到，导航包含由“icon-chevron-right”类标识的字形图标。但是，该图标不是黑色或白色。它是灰色的。当鼠标悬停在特定项目上时，图标会变成较深的灰色阴影。CSS 没有显示任何异常，似乎引用了黑色字形图标，但图标是灰色的并且具有悬停效果。

知道这里使用了引导程序的哪个功能吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-07-15T12:56:57.127

与其玩弄不透明度，不如利用 glyphicon 作为字体并将其视为字体。

```
.text-grey {
  color: grey;
}

<span class="glyphicon glyphicon-search text-grey"></span> 
```

或者使用旨在执行此操作的引导类：`.text-muted`

```
<span class="glyphicon glyphicon-search text-muted"></span> 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-14T13:34:01.403

这实际上是使用 CSS opacity 属性设置的。他们的代码：

```
.bs-docs-sidenav .icon-chevron-right {
float: right;
margin-top: 2px;
margin-right: -6px;
opacity: .25;
} 
```

这会在悬停时更改为更高的不透明度以使其更暗。它实际上只是黑色图标。

所以，像：

```
.class > i {
    opacity: 0.25;
}

.class:hover > i {
    opacity: 0.5;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T13:51:04.960

如果您在 Bootstrap 中使用图标 - 也可以查看[font-awesome](http://fortawesome.github.com/Font-Awesome/)（专为与 bootstrap 一起使用而构建），您可以在其中完全控制比例、位置、颜色、不透明度等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-07T13:13:35.727

我已经为带有图标的链接创建了这个 css

```
.icon-grey-link {
  opacity:0.5;
  filter:alpha(opacity=50); /* For IE8 and earlier */
}
a:hover > i.icon-grey-link {
  opacity:1;
  filter:alpha(opacity=100); /* For IE8 and earlier */
} 
```

并将其作为类应用于 i 元素

```
<a href="#"><i class="icon-star icon-grey-link"></i>Star</a> 
```

# c - C - 我如何与隐藏的窗口进行交互？

> ID：15410712
> 
> 赞同：-4
> 
> 时间：2013-03-14T13:31:37.320
> 
> 标签：c, console, invisible, keylogger

我的目的是制作一个键盘记录器，我不想只是在互联网上复制可用的代码，因为它们很容易被防病毒软件捕获，所以我正在编写一个带有算法的代码，让它看起来好像没有记录击键。我写了一个程序来做到这一点，而窗口在顶部并且效果很好。然后我使用以下代码使其不可见：

```
HWND Stealth;
AllocConsole();
Stealth = FindWindowA("ConsoleWindowClass", NULL);
ShowWindow(Stealth,0); 
```

但是现在程序无法捕获击键，因为我无法再与程序交互。是否有代码行可以在其他窗口位于顶部时与不可见的窗口进行交互？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:34:21.080

只有具有焦点的窗口才会接收输入。您仍然可以使用[GetAsyncKeyState](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms646293%28v=vs.85%29.aspx)捕获击键。

# magento - 当我有唯一的 URL 参数时，如何让 Magento 提供页面的缓存版本？

> ID：15410713
> 
> 赞同：3
> 
> 时间：2013-03-14T13:31:38.210
> 
> 标签：magento, url, caching, parameters, fpc

这是一个简单的问题，在搜索中没有答案（google/bing/stackoverflow）。答案当然可能很复杂。

我在 Magento 中阅读了几篇关于 FPC 的文章，但还没有真正确定需要添加或创建代码的位置，以便在发送某些 URL 参数时提供页面的缓存版本，而不是尝试重新缓存与 URL 参数。

[http://www.kingletas.com/2012/09/how-does-magento-full-page-cache-works.html](http://www.kingletas.com/2012/09/how-does-magento-full-page-cache-works.html)

例如，当您访问[http://www.example.com/shoes](http://www.example.com/shoes)时，它会加载正确的缓存版本。但是，对于谷歌分析和任何其他类型的第 3 方报告，尤其是使用唯一标识符，它会重新加载页面，就好像它没有被缓存一样。因此[http://www.example.com/shoes?utm_key=A1537BD94EF07](http://www.example.com/shoes?utm_key=A1537BD94EF07)将创建该页面的新缓存版本，依此类推。

我希望能够排除某些 URL 参数，而不是全部。主要是我用于跟踪客户的任何参数。

至于代码，由于 FPC 的复杂性以及目前没有设置用于测试的开发站点，我还没有提出任何建议。

关于我可以在哪里添加此异常的任何线索都会有所帮助，谢谢！

**编辑：**我想补充一点，我正在使用企业版。并使用 Redis 进行缓存。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T15:19:55.530

我开发了自己的修复扩展。

简而言之，get参数用于缓存ID。所以为了绕过这个，我创建了一个扩展，改变了以下内容：

`/app/code/core/Enterprise/PageCache/Model/Processor/Category.php`

改变的两个函数

```
protected function _getQueryParams() 
```

和

```
public function getPageIdWithoutApp(Enterprise_PageCache_Model_Processor $processor) 
```

`/app/code/core/Enterprise/PageCache/Model/Processor/Default.php`

一项功能已更改

```
public function getPageIdWithoutApp(Enterprise_PageCache_Model_Processor $processor) 
```

更改后，它不再使用我指定的跟踪参数创建缓存 ID。

例子：

```
public function getPageIdWithoutApp(Enterprise_PageCache_Model_Processor $processor)
{
    $queryParams = $_GET;
    ksort($queryParams);
    /**
    * unset known tracking codes
    */
    unset($queryParams["trk_msg"]);
    unset($queryParams["trk_contact"]);
    unset($queryParams["utm_source"]);
    unset($queryParams["utm_medium"]);
    unset($queryParams["utm_term"]);
    unset($queryParams["utm_campaign"]);
    unset($queryParams["utm_content"]);
    /** End Edit */
    $queryParamsHash = md5(serialize($queryParams));
    return $processor->getRequestId() . '_' . $queryParamsHash;
} 
```

# php - 使用php将事件插入谷歌日历

> ID：15410720
> 
> 赞同：4
> 
> 时间：2013-03-14T13:31:48.887
> 
> 标签：php, google-calendar-api

如何将事件插入谷歌日历？

我正在使用本指南： [https ://developers.google.com/google-apps/calendar/v3/reference/events/insert](https://developers.google.com/google-apps/calendar/v3/reference/events/insert)

在示例部分，有这个 php 代码：

```
$event = new Event();
$event->setSummary('Appointment');
$event->setLocation('Somewhere');
$start = new EventDateTime();
$start->setDateTime('2011-06-03T10:00:00.000-07:00');
$event->setStart($start);
$end = new EventDateTime();
$end->setDateTime('2011-06-03T10:25:00.000-07:00');
$event->setEnd($end);
$attendee1 = new EventAttendee();
$attendee1->setEmail('attendeeEmail');
// ...
$attendees = array($attendee1,
                   // ...
                  );
$event->attendees = $attendees;
$createdEvent = $service->events->insert('primary', $event);

echo $createdEvent->getId(); 
```

但这给了我一个致命的错误，因为 $service 是未定义的。谁能告诉我如何初始化 $service 并使这些东西工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-18T15:38:29.733

在最新版本的 Google API v3 PHP 客户端中，您应该使用

```
$event = new Google_Event(); 
```

代替

```
$event = new Event(); 
```

并且还使用

```
$start = new Google_EventDateTime(); 
```

代替

```
$start = new EventDateTime(); 
```

当然，需要的定义是不同的，使用这个：

```
require_once '../src/Google_Client.php';
require_once '../src/contrib/Google_CalendarService.php'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T13:37:43.700

```
$service = new apiCalendarService($apiClient); 
```

有关更多信息，请参阅[https://developers.google.com/google-apps/calendar/instantiate](https://developers.google.com/google-apps/calendar/instantiate)（切换到右上角的 PHP 源代码）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-06T15:03:54.017

我的脚本运行良好，插入、更改和删除 Google Calenda 事件

```
<!DOCTYPE html>
<!--
***********  GOOGLE CALENDAR  ****************************
Author: Vanderlei Bailo
E-mail: vanbailo@gmail.com
Script: insert, change and delete Google Calenda event
-->
<html>
    <head>
        <title>GOOGLE CALENDAR - insert, change and delete Google Calenda event</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="UTF-8">
        <style>
            body{
                margin: 0;
                width: 100%;
                font-family: Verdana, Arial;
            }
            #centro{
                width: 780px;
                margin: auto;
            }
            .calendario{
                position: relative;
                width: 800px;
                height: 600px;
                margin-left:-390px;
                left: 50%;
                float: left;
                -webkit-border-radius: 5px;
                -moz-border-radius: 5px;
                border-radius: 5px;
            }
            #datahora{
                width: 250px;
                float: left;
            }
            #cento{
                width: 780px;
                float: left;
            }
            #centro .primo{
                width: 100%;
                background-color: #E3E9FF;
                padding: 10px;
                margin: 50px 0;
                float: left;
                -webkit-border-radius: 5px;
                -moz-border-radius: 5px;
                border-radius: 5px;
            }
            label {
                width: 780px;
                margin: 5px 5px 0;
                float: left;
                padding-top: 10px;
            }

            input{
                margin: 5px;
                float: left;
                padding: 5px 10px;
                -webkit-border-radius: 5px;
                -moz-border-radius: 5px;
                border-radius: 5px;
                border: 1px #CCC solid;
            }
            input[type="text"]{
                width: 750px;
            }
            input[type="date"]{
                width: 125px;
            }
            input[type="time"]{
                width: 70px;
            }
            input[type="submit"]{

            }

            input:focus{
                border: 1px  #cc0000 solid;
                box-shadow: 0 0 5px #cc0000;
            }
            .btn {
                background: #3498db;
                background-image: -webkit-linear-gradient(top, #3498db, #2980b9);
                background-image: -moz-linear-gradient(top, #3498db, #2980b9);
                background-image: -ms-linear-gradient(top, #3498db, #2980b9);
                background-image: -o-linear-gradient(top, #3498db, #2980b9);
                background-image: linear-gradient(to bottom, #3498db, #2980b9);
                -webkit-border-radius: 5;
                -moz-border-radius: 5;
                border-radius: 5px;
                font-family: Arial;
                color: #ffffff;
                font-size: 20px;
                padding: 10px 20px 10px 20px;
                text-decoration: none;
                cursor: pointer;
            }

            .btn:hover {
                background: #3cb0fd;
                background-image: -webkit-linear-gradient(top, #3cb0fd, #3498db);
                background-image: -moz-linear-gradient(top, #3cb0fd, #3498db);
                background-image: -ms-linear-gradient(top, #3cb0fd, #3498db);
                background-image: -o-linear-gradient(top, #3cb0fd, #3498db);
                background-image: linear-gradient(to bottom, #3cb0fd, #3498db);
                text-decoration: none;
            }

        </style>
    </head>
    <body>

        <?php
        session_start();
        require 'google-api-php-client-master/src/Google/autoload.php';
        require_once 'google-api-php-client-master/src/Google/Client.php';
        require_once 'google-api-php-client-master/src/Google/Service/Calendar.php';

        $client_id = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.apps.googleusercontent.com'; //change this
        $Email_address = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.gserviceaccount.com'; //change this
        $key_file_location = 'xxxxxxxxxxxxxxxxxxxxxxxx.p12'; //change this
        $client = new Google_Client();
        $client->setApplicationName("Client_Library_Examples");
        $key = file_get_contents($key_file_location);

        $scopes = "https://www.googleapis.com/auth/calendar";
        $cred = new Google_Auth_AssertionCredentials(
                $Email_address, array($scopes), $key
        );
        $client->setAssertionCredentials($cred);
        if ($client->getAuth()->isAccessTokenExpired()) {
            $client->getAuth()->refreshTokenWithAssertion($cred);
        }
        $service = new Google_Service_Calendar($client);

        $calendarList = $service->calendarList->listCalendarList();
        while (true) {
            foreach ($calendarList->getItems() as $calendarListEntry) {
                echo "<a href='Oauth2.php?type=event&id=" . $calendarListEntry->id . " '>" . $calendarListEntry->getSummary() . "</a><br>\n";
            }
            $pageToken = $calendarList->getNextPageToken();
            if ($pageToken) {
                $optParams = array('pageToken' => $pageToken);
                $calendarList = $service->calendarList->listCalendarList($optParams);
            } else {
                break;
            }
        }

        if ($_POST) {

            $Summary = $_POST['Summary'];
            $Location = $_POST['Location'];
            $DateStart = $_POST['DateStart'];
            $TimeStart = $_POST['TimeStart'];
            $DateEnd = $_POST['DateEnd'];
            $TimeEnd = $_POST['TimeEnd'];
            $acao = $_POST['acao'];

            if ($acao == 'Inserire') {
                //--------------- trying to insert EVENT --------------- 
                $event = new Google_Service_Calendar_Event();
                $event->setSummary($Summary);
                $event->setLocation($Location);
                $start = new Google_Service_Calendar_EventDateTime();
                $datatimeI = geratime(DataIT2DB($DateStart), $TimeStart);

                $start->setDateTime($datatimeI);
                $event->setStart($start);
                $end = new Google_Service_Calendar_EventDateTime();
                $datatimeF = geratime(DataIT2DB($DateEnd), $TimeEnd);

                $end->setDateTime($datatimeF);
                $event->setEnd($end);
                $attendee1 = new Google_Service_Calendar_EventAttendee();
                $attendee1->setEmail('web@ideart.it');
                $attendees = array($attendee1);
                $event->attendees = $attendees;
                $createdEvent = $service->events->insert('primary', $event);
                $_SESSION['eventID'] = $createdEvent->getId();
            } else if ($acao == 'Cancellare') {
                //--------------- trying to del EVENT --------------- 
                $createdEvent = $service->events->delete('primary', $_SESSION['eventID']);
            } else if ($acao == 'Aggiornare') {
                //--------------- trying to update EVENT --------------- 

                $rule = $service->events->get('primary', $_SESSION['eventID']);

                $event = new Google_Service_Calendar_Event();
                $event->setSummary($Summary);
                $event->setLocation($Location);
                $start = new Google_Service_Calendar_EventDateTime();
                $datatimeI = geratime(DataIT2DB($DateStart), $TimeStart);

                $start->setDateTime($datatimeI);
                $event->setStart($start);
                $end = new Google_Service_Calendar_EventDateTime();
                $datatimeF = geratime(DataIT2DB($DateEnd), $TimeEnd);

                $end->setDateTime($datatimeF);
                $event->setEnd($end);
                $attendee1 = new Google_Service_Calendar_EventAttendee();
                $attendee1->setEmail('xxx@xxxxx.xxx'); //change this
                $attendees = array($attendee1);
                $event->attendees = $attendees;

                $updatedRule = $service->events->update('primary', $rule->getId(), $event);
            }
        }

        function DataIT2DB($datapega) {
            if ($datapega) {
                $data = explode('/', $datapega);
                if (count($data) > 1) {
                    $datacerta = $data[2] . '-' . $data[1] . '-' . $data[0];
                } else {
                    $datacerta = $datapega;
                }
            } else {
                $datacerta = $datapega;
            }
            return $datacerta;
        }

        function geratime($DateStart, $TimeStart) {
            $dataHora = $DateStart . 'T' . $TimeStart . ':00.000+02:00'; //Fuso Rome
            return $dataHora;
        }
        ?>

        <div id="contenut" style="width: 100%; float: left;">
            <div id="centro">
                <div class="primo">
                    <form name="adicionar" method="POST" action="#">
                        ID evento: <?php echo ( isset($_SESSION['eventID']) ? $_SESSION['eventID'] : "" ); ?>
                        <input type="hidden" name="" value="<?php echo ( isset($_SESSION['eventID']) ? $_SESSION['eventID'] : "" ); ?>" />
                        <input type="text" name="Summary" value="<?php echo ( isset($_POST['Summary']) ? $_POST['Summary'] : "" ); ?>" placeholder="Titolo"/>
                        <input type="text" name="Location" value="<?php echo ( isset($_POST['Location']) ? $_POST['Location'] : "" ); ?>" placeholder="LocalitÃ "/>
                        <div id="datahora">
                            <label>Data e ora di inizio</label>
                            <input type="date" name="DateStart" value="<?php echo ( isset($_POST['DateStart']) ? $_POST['DateStart'] : "" ); ?>" placeholder="GG/MM/AAAA"/>
                            <input type="time" name="TimeStart" value="<?php echo ( isset($_POST['TimeStart']) ? $_POST['TimeStart'] : "" ); ?>" placeholder="10:20"/>
                        </div>
                        <div id="datahora">
                            <label>Data e ora di fine</label>
                            <input type="date" name="DateEnd" value="<?php echo ( isset($_POST['DateEnd']) ? $_POST['DateEnd'] : "" ); ?>" placeholder="GG/MM/AAAA"/>
                            <input type="time" name="TimeEnd" value="<?php echo ( isset($_POST['TimeEnd']) ? $_POST['TimeEnd'] : "" ); ?>" placeholder="10:20" />
                        </div>
                        <div id="cento">
                            <input class="btn" type="submit" value="Inserire" name="acao" />
                            <input class="btn" type="submit" value="Cancellare" name="acao" />
                            <input class="btn" type="submit" value="Aggiornare" name="acao" />
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </body>
</html>
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T13:40:26.487

它在[此](https://developers.google.com/google-apps/calendar/instantiate)页面上进行了描述。代码复制如下。

**src/config.php**

```
global $apiConfig;
$apiConfig = array(
  // Site name to show in Google's OAuth authentication screen
  'site_name' => 'www.example.org',

  // OAuth2 Setting, you can get these keys on the API Access tab on
  // the Google APIs Console
  'oauth2_client_id' => 'YOUR_CLIENT_ID',
  'oauth2_client_secret' => 'YOUR_CLIENT_SECRET',
  'oauth2_redirect_uri' => 'YOUR_REDIRECT_URL',

  // The developer key; you get this from the Google APIs Console
  'developer_key' => 'YOUR_DEVELOPER_KEY',

  // Which Authentication, Storage and HTTP IO classes to use.
  'authClass' => 'apiOAuth2',

  // Definition of service specific values like scopes, OAuth token URLs, etc
  'services' => array(
      'calendar' => array('scope' => 'https://www.googleapis.com/auth/calendar'),
  )
); 
```

**你的脚本**

```
session_start();

require_once "../src/apiClient.php";
require_once "../src/contrib/apiCalendarService.php";

$apiClient = new apiClient();
$apiClient->setUseObjects(true);
$service = new apiCalendarService($apiClient);

if (isset($_SESSION['oauth_access_token'])) {
  $apiClient->setAccessToken($_SESSION['oauth_access_token']);
} else {
  $token = $apiClient->authenticate();
  $_SESSION['oauth_access_token'] = $token;
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-09-14T07:15:11.073

```
full code for calendar:
this session has all 

<?php
ini_set('display_errors', 1);
ini_set('display_startup_errors', 1);
error_reporting(E_ALL);

require_once '../../src/Google_Client.php';
require_once '../../src/contrib/Google_CalendarService.php';
//require_once '../../src/vendor/autoload.php';
session_start();

print_r($_SESSION);

$client = new Google_Client();
$client->setApplicationName("Google Calendar PHP Starter Application");

// Visit https://code.google.com/apis/console?api=calendar to generate your
// client id, client secret, and to register your redirect uri.
// $client->setClientId('insert_your_oauth2_client_id');
// $client->setClientSecret('insert_your_oauth2_client_secret');
// $client->setRedirectUri('insert_your_oauth2_redirect_uri');
// $client->setDeveloperKey('insert_your_developer_key');
$cal = new Google_CalendarService($client);
if (isset($_GET['logout'])) {
  unset($_SESSION['token']);
}

if (isset($_GET['code'])) {
  $client->authenticate($_GET['code']);
  $_SESSION['token'] = $client->getAccessToken();
  header('Location: http://' . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF']);
}

if (isset($_SESSION['token'])) {
  $client->setAccessToken($_SESSION['token']);
}

if ($client->getAccessToken()) {
  $calList = $cal->calendarList->listCalendarList();
  print "<h1>Calendar List</h1><pre>" . print_r($calList, true) . "</pre>";

 $_SESSION['token'] = $client->getAccessToken();
} else {
  $authUrl = $client->createAuthUrl();
  print "<a class='login' href='$authUrl'>Connect Me!</a>";
}

?> 
```

# gwt - 在新的 tomcat 中启动项目的 GWT 问题

> ID：15410721
> 
> 赞同：1
> 
> 时间：2013-03-14T13:31:55.117
> 
> 标签：gwt

我在 tomcat 中启动我的 GWT 项目时遇到了问题，因为我正在使用一个新项目。昨天我使用了一个 tomcat 实例，我将它作为服务安装在我的 PC 上，它运行良好。今天我卸载了它，因为它没有startup.dat，我需要一个在eclipse中调试。

没关系......现在我通过startup.bat启动了tomcat并部署了我的战争。但是当我想启动它时，我遇到了一些错误。

```
> FAIL - 无法启动上下文路径/WebApp 处的应用程序
FAIL - 遇到异常 org.apache.catalina.LifecycleException: 无法启动组件 [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/WebApp]]

```

我在 catalina 日志中找到了这个。它可能会帮助你。

```
>14.03.2013 14:07:15 org.apache.catalina.core.ContainerBase addChildInternal
SCHWERWIEGEND：ContainerBase.addChild：开始：
org.apache.catalina.LifecycleException: 无法启动组件 [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/WebApp]]
    在 org.apache.catalina.util.LifecycleBase.start（LifecycleBase.java:154）
    在 org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
    在 org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    在 org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)
    在 org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:977)
    在 org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:542)
    在 org.apache.catalina.startup.HostConfig.check(HostConfig.java:1462)
    在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    在 java.lang.reflect.Method.invoke(Method.java:597)
    在 org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    在 com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke（DefaultMBeanServerInterceptor.java:836）
    在 com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:761)
    在 org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1445)
    在 org.apache.catalina.manager.HTMLManagerServlet.upload(HTMLManagerServlet.java:301)
    在 org.apache.catalina.manager.HTMLManagerServlet.doPost(HTMLManagerServlet.java:208)
    在 javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
    在 javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
    在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    在 org.apache.catalina.filters.CsrfPreventionFilter.doFilter(CsrfPreventionFilter.java:213)
    在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    在 org.apache.catalina.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:108)
    在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    在 org.apache.catalina.core.StandardWrapperValve.invoke（StandardWrapperValve.java:222）
    在 org.apache.catalina.core.StandardContextValve.invoke（StandardContextValve.java:123）
    在 org.apache.catalina.authenticator.AuthenticatorBase.invoke（AuthenticatorBase.java:581）
    在 org.apache.catalina.core.StandardHostValve.invoke（StandardHostValve.java:171）
    在 org.apache.catalina.valves.ErrorReportValve.invoke（ErrorReportValve.java:99）
    在 org.apache.catalina.valves.AccessLogValve.invoke（AccessLogValve.java:936）
    在 org.apache.catalina.core.StandardEngineValve.invoke（StandardEngineValve.java:118）
    在 org.apache.catalina.connector.CoyoteAdapter.service（CoyoteAdapter.java:407）
    在 org.apache.coyote.http11.AbstractHttp11Processor.process（AbstractHttp11Processor.java:1004）
    在 org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    在 org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    在 java.lang.Thread.run(Thread.java:662)
原因：java.lang.UnsupportedClassVersionError：com/wn/retail/iscan/base/webservice/lane/generated/LaneStatus：不支持的major.minor 51.0版（无法加载类com.wn.retail.iscan.base.webservice。车道.生成.车道状态）
    在 org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2892)
    在 org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1172)
    在 org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    在 org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1558)
    在 java.lang.Class.getDeclaredMethods0（本机方法）
    在 java.lang.Class.privateGetDeclaredMethods(Class.java:2427)
    在 java.lang.Class.getDeclaredMethods(Class.java:1791)
    在 org.apache.catalina.util.Introspection.getDeclaredMethods（Introspection.java:127）
    在 org.apache.catalina.startup.WebAnnotationSet.loadMethodsAnnotation（WebAnnotationSet.java:279）
    在 org.apache.catalina.startup.WebAnnotationSet.loadApplicationServletAnnotations(WebAnnotationSet.java:141)
    在 org.apache.catalina.startup.WebAnnotationSet.loadApplicationAnnotations(WebAnnotationSet.java:67)
    在 org.apache.catalina.startup.ContextConfig.applicationAnnotationsConfig(ContextConfig.java:405)
    在 org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:881)
    在 org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:369)
    在 org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    在 org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    在 org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5179)
    在 org.apache.catalina.util.LifecycleBase.start（LifecycleBase.java:150）
    ... 40 更多
14.03.2013 14:07:15 org.apache.catalina.startup.HostConfig deployWAR
SCHWERWIEGEND：部署 Web 应用程序存档 C:\Program Files\Apache Software Foundation\apache-tomcat-7.0.37\webapps\WebApp.war 时出错
java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: 无法启动组件 [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/WebApp]]
    在 org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:904)
    在 org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    在 org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)
    在 org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:977)
    在 org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:542)
    在 org.apache.catalina.startup.HostConfig.check(HostConfig.java:1462)
    在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    在 java.lang.reflect.Method.invoke(Method.java:597)
    在 org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    在 com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke（DefaultMBeanServerInterceptor.java:836）
    在 com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:761)
    在 org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1445)
    在 org.apache.catalina.manager.HTMLManagerServlet.upload(HTMLManagerServlet.java:301)
    在 org.apache.catalina.manager.HTMLManagerServlet.doPost(HTMLManagerServlet.java:208)
    在 javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
    在 javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
    在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    在 org.apache.catalina.filters.CsrfPreventionFilter.doFilter(CsrfPreventionFilter.java:213)
    在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    在 org.apache.catalina.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:108)
    在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    在 org.apache.catalina.core.StandardWrapperValve.invoke（StandardWrapperValve.java:222）
    在 org.apache.catalina.core.StandardContextValve.invoke（StandardContextValve.java:123）
    在 org.apache.catalina.authenticator.AuthenticatorBase.invoke（AuthenticatorBase.java:581）
    在 org.apache.catalina.core.StandardHostValve.invoke（StandardHostValve.java:171）
    在 org.apache.catalina.valves.ErrorReportValve.invoke（ErrorReportValve.java:99）
    在 org.apache.catalina.valves.AccessLogValve.invoke（AccessLogValve.java:936）
    在 org.apache.catalina.core.StandardEngineValve.invoke（StandardEngineValve.java:118）
    在 org.apache.catalina.connector.CoyoteAdapter.service（CoyoteAdapter.java:407）
    在 org.apache.coyote.http11.AbstractHttp11Processor.process（AbstractHttp11Processor.java:1004）
    在 org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    在 org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    在 java.lang.Thread.run(Thread.java:662)

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:43:40.897

浏览您的日志后，有一个异常是

```
 : Unsupported major.minor version 51.0 (unable to load class 
com.wn.retail.iscan.base.webservice.lane.generated.LaneStatus 
```

似乎您正在使用 JDK7 进行编译，而在`Tomcat`.

参见维基百科代码

正在使用的类文件格式的主版本号。

```
J2SE 7 = 51 (0x33 hex). 
```

正如所有建议的那样，也请参见[如何修复 java.lang.UnsupportedClassVersionError: Unsupported major.minor version](https://stackoverflow.com/questions/10382929/unsupported-major-minor-version-51-0)

# regex - 正则表达式 - 检测未被非字母数字字符串包围的字母数字字符串

> ID：15410723
> 
> 赞同：0
> 
> 时间：2013-03-14T13:31:56.630
> 
> 标签：regex

我有以下字符串：

> aaa bbb() !ccc ddd efef

我想检测“干净”字母数字单词的所有实例，即“aaa”、“ddd”、“efef”，它们之前和单词结尾都没有其他字符。字符串可以是由任何非字母数字字符包围的任何字母数字字符。

我可以用四种不同的正则表达式来做到这一点”

1.  `\s(\w+)`
2.  `^\w+\s`
3.  `\s\w+$`
4.  `^\w+$`

但是如何在一个表达式中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:34:34.540

使用`|`or 运算符：

```
(^|\s)\w+(\s|$) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:35:07.693

编辑：如果您的原始字符串是`$str`，您可以`\s\w\s`在 ' ' 上使用模式。$str 。''

# cakephp - CakePHP 中的 $this->query 回调

> ID：15410724
> 
> 赞同：1
> 
> 时间：2013-03-14T13:31:57.370
> 
> 标签：cakephp

我需要*打开一个事务*，并等待执行提交或回滚的**返回。**

但是，我怎样才能得到这个查询的返回（真/假 - 不是异常或任何“中断过程”）？

```
$this->query('update checks set discount = 100 where check_num = 3001'); 
```

在我的测试中，当发生错误时，它会停止整个过程并返回异常。

我不想要，只想知道：**执行成功还是出错**？（真假）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:37:39.097

评论中所说的标记似乎是准确的，[updateAll()](http://book.cakephp.org/2.0/en/models/saving-your-data.html#model-updateall-array-fields-array-conditions)调用似乎更适合实现您想要的。如果您发现自己确实需要交易，那么[文档](http://book.cakephp.org/2.0/en/models/transactions.html)中也提供了有关如何实现交易的示例。

# java - 没有第三方库的 Java 重采样 .wav 声音文件

> ID：15410725
> 
> 赞同：6
> 
> 时间：2013-03-14T13:31:57.727
> 
> 标签：java, audio, wav

是否可以`.wav`在不使用任何第三方库的情况下在 java 中将文件从 22050 khz 重新采样到 44100 khz？

也许使用`AudioInputStream`？

编辑：因为似乎没有第三方库就不容易，所以存在哪些第三方库来完成重采样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T22:34:37.497

**由于您现在接受第三方库，这是我的建议**

有很多第三方库可以让你重新采样音频 wav 文件，对我来说，就我而言（我最近使用过），最用户友好的第三方库是[Jave](http://www.sauronsoftware.it/projects/jave/manual.php) ，你需要做的就是包含 jar . 不再像其他库那样繁琐的安装

Jave 有一个名为的方法

```
public void setSamplingRate(java.lang.Integer bitRate) 
```

这允许您使用给定的比特率重新采样音频。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-26T16:22:20.653

它可能，快速和肮脏。只需要在 javax.sound API 中进行一些挖掘：

```
import java.io.File;

import javax.sound.sampled.AudioFileFormat.Type;
import javax.sound.sampled.AudioFormat;
import javax.sound.sampled.AudioInputStream;
import javax.sound.sampled.AudioSystem;
import com.sun.media.sound.WaveFileReader;
import com.sun.media.sound.WaveFileWriter;

public class Resample {

public static void main(String[] argv) {
    try {
        File wavFile = new File("C:\\Temp\\test.wav");
        File dstFile = new File("C:\\Temp\\test_half.wav");
        WaveFileReader reader = new WaveFileReader();
        AudioInputStream audioIn = reader.getAudioInputStream(wavFile);
        AudioFormat srcFormat = audioIn.getFormat();

        AudioFormat dstFormat = new AudioFormat(srcFormat.getEncoding(),
                srcFormat.getSampleRate() / 2,
                srcFormat.getSampleSizeInBits(),
                srcFormat.getChannels(),
                srcFormat.getFrameSize(),
                srcFormat.getFrameRate() / 2,
                srcFormat.isBigEndian());

        AudioInputStream convertedIn = AudioSystem.getAudioInputStream(dstFormat, audioIn);

        WaveFileWriter writer = new WaveFileWriter();
        writer.write(convertedIn, Type.WAVE, dstFile);
    } catch (Exception e) {
        throw new RuntimeException(e);
    }
}

} 
```

这个简短的黑客示例将创建一个副本，其中源中指定的文件的采样率减半。我认为它非常不言自明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-22T15:59:41.133

无论您是否希望提高音频质量，无论哪种方式，您都需要使用原始文件的样本创建一个新的 .wav 文件。如果要保持原始文件的质量，可以将每个样本写入两次。

然而，有一个相当简单的算法可以“提高”质量：读取三个连续的样本，我们现在将它们命名为 a、b 和 c。令 z 为 a 和 b 之间的额外输出样本。

令 z=(a+b)/2。现在将 b 替换为 (a + 2b + c)/4。请记住使用 b 的旧值计算 z！现在只将 a、z 和新的 b 写入输出。

再读一个样本，我们称它为 d。使用 (b+c)/2 计算下一个额外的输出样本 y。使用 b 的旧值。重新计算 c，使其等于 (b + 2c + d)/4。将 b 的新值和 y 写入输出。

您可以在 !EOF 中找出猜测、阅读和重复。请记住使用旧值进行计算，但要输出新值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T13:37:36.997

不...您可以尝试编写新的 wav 文件，其中的新样本计算为相邻样本的平均值。粗略，但也许它足以满足您的目的。

如果您接受第三方库，[JSSRC](http://jssrc.khadkevich.org/)似乎是一个不错的选择。但是，您需要自己构建 .jar。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-14T12:39:32.273

是的，使用 AudioInputstream 有效。您可以在此处捕获一些示例代码：

[http://www.jsresources.org/examples/SampleRateConverter.html](http://www.jsresources.org/examples/SampleRateConverter.html)

不用担心 Tritonius，该信息不再与 Java 的较新版本相关。只要您坚持使用 *.wav 文件，您就可以使用本机 Java 重新采样，而无需任何第三方库。

此外，此常见问题解答回答了 Java 中大多数与音频相关的问题。它可能不是最新的，但大多数信息仍然是相关的。

[http://www.jsresources.org/faq.html](http://www.jsresources.org/faq.html)

# unit-testing - 单元测试后控制器 .NET Web Api

> ID：15410726
> 
> 赞同：6
> 
> 时间：2013-03-14T13:31:58.600
> 
> 标签：unit-testing, asp.net-web-api, nunit

我对 .NET Web Api 没有太多经验，但我已经使用它一段时间了，遵循 John Papa 在 Pluralsight 上的 SPA 应用程序教程。该应用程序运行良好，但我现在正在努力解决的问题是对 POST 控制器进行单元测试。

我已经按照这个令人难以置信的指南来了解如何对 web api 控制器进行单元测试。对我来说唯一的问题是在测试 POST 方法时。

我的控制器如下所示：

```
 [ActionName("course")]
    public HttpResponseMessage Post(Course course)
    {
        if (course == null)
            throw new HttpResponseException(HttpStatusCode.NotAcceptable);
        try
        {
            Uow.Courses.Add(course);
            Uow.commit();
        }
        catch (Exception)
        {
            throw new HttpResponseException(HttpStatusCode.InternalServerError);
        }

        var response = Request.CreateResponse(HttpStatusCode.Created, course);

        string uri = Url.Link(routeName: "ControllerActionAndId", 
        routeValues: new { id = course.Id });

        response.Headers.Location = new Uri(uri);

        return response;
    } 
```

我的单元测试如下所示：

```
 [Test]
    public void PostShouldReturnHttpResponse()
    {
        var populatedPostController = new CoursesController(new TestUOW());

        SetupPostControllerForTest(populatedPostController);

        var course = new Course
        {
            Id = 12,
            Author = new UserProfile()
            {
                Firstname = "John",
                Lastname = "Johnson",
            },
            Description = "Testcourse",
            Title = "Test Title"
        };

          var responses = populatedPostController.Post(course);

          ObjectContent content = responses.Content as ObjectContent;
          Course result = (Course)content.Value;
          Assert.AreSame(result, course);
    } 
```

使用帮助功能：

```
 public static void SetupPostControllerForTest(ApiController controller)
    {

        var config = new HttpConfiguration();
        var request = new HttpRequestMessage(HttpMethod.Post, "http://localhost/api/courses/course");
        var route = config.Routes.MapHttpRoute(
            name: "ControllerActionAndId",
            routeTemplate: "api/{controller}/{action}/{id}",
            defaults: null,
            constraints: new { id = @"^\d+$" }
        );

        var routeData = new HttpRouteData(route, new HttpRouteValueDictionary { { "controller", "courses" }, { "action", "course" } });

        controller.ControllerContext = new HttpControllerContext(config, routeData, request);
        controller.Request = request;
        controller.Request.Properties[HttpPropertyKeys.HttpConfigurationKey] = config;
    } 
```

当我调试单元测试时，它似乎失败了：

```
 string uri = Url.Link(routeName: "ControllerActionAndId", 
        routeValues: new { id = course.Id });

        response.Headers.Location = new Uri(uri); //Exception because uri = null 
```

似乎 Url.Link 找不到路线。

我也尝试[了本](http://blogs.msdn.com/b/youssefm/archive/2013/01/28/writing-tests-for-an-asp-net-webapi-service.aspx)指南，但我真的希望上面的示例能够正常工作。

我在这里错过了一些非常基本的东西吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T14:04:09.420

是的，您缺少 Nemesv 提到的配置中的一行。

```
controller.Request.Properties[HttpPropertyKeys.HttpRouteDataKey] = routeData 
```

如您所见，仅为使用 UrlHelper 配置控制器非常复杂。出于这个原因，我倾向于避免在控制器类中使用 UrlHelper。我通常会引入一个外部依赖项来简化测试，例如 IUrlHelper，它允许我在单元测试中模拟行为。

```
public interface IUrlHelper
    {
        string Link(string routeName, object routeValues);
        string Route(string routeName, object routeValues);
    }

    public class UrlHelperWrapper : IUrlHelper
    {
        UrlHelper helper;

        public UrlHelperWrapper(UrlHelper helper)
        {
            this.helper = helper;
        }

        public string Link(string routeName, object routeValues)
        {
            return this.helper.Link(routeName, routeValues);
        }

        public string Route(string routeName, object routeValues)
        {
            return this.helper.Route(routeName, routeValues);
        }
    } 
```

我将这个 UrlHelperWraper 注入到真正的 Web API 中，并在测试中模拟 IUrlHelper 接口。通过这样做，您不需要对路由进行所有复杂的配置。

问候，巴勃罗。

# java - 对象到 Rest-URL

> ID：15410732
> 
> 赞同：0
> 
> 时间：2013-03-14T13:32:17.047
> 
> 标签：java, rest

用户可以为将被传递到 REST api 的搜索查询设置多个值（可选）。所以我创建了一个 POJO 来保存所有的设置值，比如

```
class Search{

  private String minPrice; 
  private String maxPrice; 
  private String category; 
  // etc.pp.

} 
```

当我为 api 调用构建 URL 时，我必须检查该值是否一直设置为

```
if (search.getMinPrice() != null){

  url.append("&minprice=" + search.getMinPrice());

} 
```

有没有更方便/优雅的方式来做到这一点

1.  使用纯 Java，只是一种“如果 sth 不为空就做某事”的方法
2.  甚至是可以让您从对象构造 URL 的库/工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:44:37.887

就像是：

```
String url = "http://base.com/some/path?" + (maxPrice==null ? "" : "maxPrice="+maxPrice); 
```

# php - PHP/JQuery：发布到 PHP 脚本，然后返回值并使用 JQuery 更新 HTML

> ID：15410735
> 
> 赞同：0
> 
> 时间：2013-03-14T13:32:21.470
> 
> 标签：php, jquery, ajax

我对 PHP 很陌生，对 JQuery 也很陌生。

所以我写了一些 JQuery 来做一些计算，我在下面写了一些类似的东西：

```
//on change of a selectbox with the class item
$('.item').change(function() {
  // set variable id as the id name of this id 
  var id = this.id;
  // price variable is equal to the value of the element id 'hiddenprice'
  price = $("#hiddenprice").val();
  // number of items is the value of the select box
  numberofitems = $(this).val();
  // number of days is equal to a php variable I set on the page
  numofdays = "<?php echo $length->days; ?>";
  //totalprice is equal to the 'price' multiplied by 'numofdays'
  totalprice = Number(price) * Number(numofdays);
  //calculates final total by multiplying the 'totalprice' by 'numofitems'
  finaltotal = Number(totalprice ) * Number(numofitems); 
  //updates the HTML with the new price
  $('#'+id).html("&euro;" + finaltotal.toFixed(2));

}); 
```

我正在尝试这个，虽然我得到了它的工作，但在阅读了一些内容后，我知道因为这个脚本位于我正在更新的页面的页脚中，如果用户想要恶意，它是不安全且易于操作的。

所以我想通过将值发布到 PHP 脚本然后返回值来进行服务器端的计算。

```
// POST values to PHP Script

$id = (posted select id);
$price = (#hiddenprice variable value);
$numofitems = (posted value of the select);
$numofdays = $length->days;

$totalprice = (int)$price * (int)$numofdays;
$finaltotal = (int)$totalprice * (int)numofitems;

//Then push $finaltotal and $id back to the user viewed page

$('#'+<?php echo $id; ?>).html("&euro;" + <?php echo $finaltotal; ?>.toFixed(2)); 
```

我只是不确定如何在不刷新的情况下将它们推送到页面然后返回它们，也不刷新。

再次抱歉，如果这很简单，我已经查看了 JQuery 表单插件，我只是想知道是否有更适合我想做的解决方案。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:36:55.153

您可能想查看[ajax](http://api.jquery.com/jQuery.ajax/)，它可以在不刷新页面的情况下发布或获取数据。[这个问题](https://stackoverflow.com/questions/4105211/jquery-ajax-post-to-php)的答案也可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:46:39.737

您需要使用 AJAX。这会将数据发送到服务器，并允许您在收到响应后执行回调。

如果您使用的是 jQuery，请阅读有关[$.ajax](http://api.jquery.com/jQuery.ajax/)方法的信息。

要处理响应，最简单的数据类型是[JSON](http://en.wikipedia.org/wiki/JSON)。

一个简单的例子

**Javascript**

```
$.ajax({
    url: calculation_url.php,
    method: 'post',
    dataType: 'JSON',
    data: {price: price, days: numofdays },
    success: function(response) {
        // you should check a valid response was received
        $("#result").html(response.html);
    }
}); 
```

**PHP** - calculatin_url.php

```
$price = $_POST['price'];
$days = $_POST['days'];
// do calculations

// send data back as json
die(json_encode(array('html' => $finalTotal))); 
```

要开始此过程，您需要将事件附加到计算按钮。阅读有关使用[on](http://api.jquery.com/on/)方法注册事件的信息，您可能会发现阅读有关[event.preventDefault()](http://api.jquery.com/event.preventDefault/)方法的信息会很有帮助。

# jquery - 使用 Jquery 文件打印值

> ID：15410740
> 
> 赞同：0
> 
> 时间：2013-03-14T13:32:34.227
> 
> 标签：jquery, function, printing, trygetvalue

我的 jQuery 文件中有一个函数：

```
function updateHTML(blocks) {
  var data   = getData(blocks),
      price  = formatPrice(data.price),
      hourly = formatCents(data.hourly),
      p      = $.priceSlider.settings;

  $(p.processor_id).text(data.processor + ' GHZ');
  $(p.ram_id).text(data.ram + ' GB');
  $(p.price_id).text('$' + price);
  $(p.storage_id).text(data.storage + ' GB');
  $(p.bandwidth_id).text(data.bandwidth + ' GB');
  $(p.blocks_id).attr('class', 'block_' + data.blocks);
  $(p.hourly_price_id).text('$' + hourly + '/hr');
} 
```

我必须打印最后一行中包含的值（

```
$(p.hourly_price_id).text('$' + hourly + '/hr'); 
```

在索引页面上。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:41:20.873

首先`$(p.hourly_price_id).text('$' + hourly + '/hr');`应该是`$('p.hourly_price_id').text('$' + hourly + '/hr');`jQuery 选择器需要引号。如果`p`页面上的标签已经有 class `hourly_price_id`，则更改完成。`apendTo`如果没有，您可以根据自己的喜好使用( [doc](http://api.jquery.com/appendTo/) ) 或`append`( [doc](http://api.jquery.com/append/) )将此类元素附加到任何您喜欢的位置。

此外，如果您想要段落标签的唯一 ID，请使用`<p id="hourly_price">`jQuery 选择器`$('p#hourly_price')`。

# php - php error_log 怪异

> ID：15410751
> 
> 赞同：0
> 
> 时间：2013-03-14T13:32:54.777
> 
> 标签：php, error-handling

我的 smart404.php 代码中有一个全局变量 debug_smart404：

```
$debug_smart404 = intval(get_option('debug_smart404' ));
    error_log("smart404_redirect: debug_smart404 =" . ( $debug_smart404 ) ); 
```

我使用了很多地方：

```
if ( $debug_smart404 > 4 ) # lotsa debug!
{
    error_log("smart404_redirect: take_1st_match=" . ( $take_1st_match  ? "yes" : "no" ) );
    error_log("smart404_redirect: take_exact_match=" . ( $take_exact_match ? "yes" : "no" ) );
    error_log("smart404_redirect: search_whole_uri=" . ( $search_whole_uri ? "yes" : "no" ) );
    error_log("smart404_redirect: walk_uri=" . ( $walk_uri ? "yes" : "no" ) );
    error_log("smart404_redirect: ignored_patterns_input=" . $patterns );
    error_log("smart404_redirect: ignored_patterns_array=" . join($patterns_array,",") );
            error_log("smart404_redirect: search_groups=" . join($search_groups,","));
}
while ( TRUE )
{
    error_log("smart404_redirect:inside while: debug_smart404 =" . ( $debug_smart404 ) );
...
    if ( $debug_smart404 > 3 ) # less debug
    {
        error_log("smart404_redirect: search_words=" . $search_words);
        }
...
        if ( $debug_smart404 > 0 ) {
            error_log("smart404_redirect: uri=" . $uri . "= #matches=" . $mct);
        } 
...
} #end while... 
```

所以当我设置 debug_smart404 == 5 时，我得到了 while 之外实例的预期输出：

```
[Thu Mar 14 08:32:42 2013] [error] [client xx.xx.xx.xx] smart404_redirect: debug_smart404 =5
[Thu Mar 14 08:32:42 2013] [error] [client xx.xx.xx.xx] smart404_redirect: take_1st_match=yes
[Thu Mar 14 08:32:42 2013] [error] [client xx.xx.xx.xx] smart404_redirect: take_exact_match=yes
[Thu Mar 14 08:32:42 2013] [error] [client xx.xx.xx.xx] smart404_redirect: search_whole_uri=no
[Thu Mar 14 08:32:42 2013] [error] [client xx.xx.xx.xx] smart404_redirect: walk_uri=yes
[Thu Mar 14 08:32:42 2013] [error] [client xx.xx.xx.xx] smart404_redirect: ignored_patterns_input=wp-.*\r\n(ing|s|er|est)$\r\nprivate/.*
[Thu Mar 14 08:32:42 2013] [error] [client xx.xx.xx.xx] smart404_redirect: ignored_patterns_array=@wp-.*@i,@(ing|s|er|est)$@i,@private/.*@i,@/(trackback|feed|(comment-)?page-?[0-9]*)/?$@i,@\\.(html|php)$@i,@/?\\?.*@i
[Thu Mar 14 08:32:42 2013] [error] [client xx.xx.xx.xx] smart404_redirect: search_groups=pages,posts,categories
[Thu Mar 14 08:32:42 2013] [error] [client xx.xx.xx.xx] smart404_redirect:inside while: debug_smart404 =5 
```

但请注意，while 循环的 if 语句中的 error_log 输出丢失了……但仅在我的生产服务器（netsol vps）上

它在我的测试服务器（lighttpd）上运行良好：

```
2013-03-14 08:26:40: (mod_fastcgi.c.2711) FastCGI-stderr: smart404_redirect: debug_smart404 =5
smart404_redirect: take_1st_match=no
smart404_redirect: take_exact_match=no
smart404_redirect: search_whole_uri=yes
smart404_redirect: walk_uri=yes
smart404_redirect: ignored_patterns_input=wp-.*
(ing|s|er|est)$
private/.*
smart404_redirect: ignored_patterns_array=@wp-.*@i,@(ing|s|er|est)$@i,@private/.*@i,@/(trackback|feed|(comment-)?page-?[0-9]*)/?$@i,@\.(html|php)$@i,@/?\?.*@i
smart404_redirect: search_groups=pages,posts,categories
smart404_redirect:inside while: debug_smart404 =5
smart404_redirect: search_words=cavitronix.com  xxx zzzxxxx
smart404_redirect: uri=/cavitronix.com//xxx/zzzxxxx= #matches=0 
```

呜呜呜？？？在两者上运行 php5，并且它曾经在 vps 上工作（此处调试 = 1 输出）-：

```
[Thu Mar 14 06:32:55 2013] [error] [client xx.xx.xx.xx] smart404_redirect: uri=/how-it-works= #matches=1
[Thu Mar 14 06:41:32 2013] [error] [client xx.xx.xx.xx] smart404_redirect: uri=/videos/e2c-overview/private/awstats/current/new.html= #matches=10
[Thu Mar 14 06:53:38 2013] [error] [client xx.xx.xx.xx] smart404_redirect: uri=/current/previous.html= #matches=3
[Thu Mar 14 06:54:47 2013] [error] [client xx.xx.xx.xx] smart404_redirect: uri=/press-releases= #matches=3 
```

或者这是netsol的vpshackery的一些功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:51:01.230

打印while里面的错误日志；您自己从生产服务器粘贴的错误日志显示它“在内部同时：debug_smart404 = 5”

您错过了“...”背后的很多代码。您的代码是否有可能进入 while 循环，但随后（在生产中）在到达其他错误日志语句之前快速中断/或继续。你能积极排除吗？

# javascript - Chrome 的 javascript 垃圾收集是否有不同的工作方式？

> ID：15410752
> 
> 赞同：9
> 
> 时间：2013-03-14T13:32:55.687
> 
> 标签：javascript, google-chrome, garbage-collection, v8

当我尝试调试此代码时（[http://jsfiddle.net/QWFGN/](http://jsfiddle.net/QWFGN/)）

```
var foo = (function(numb) {
    return {
        bar: function() {
            debugger;
            return "something";
        }
    }
})(1);
foo.bar() 
```

Chrome 中的开发者工具的行为不同于 Firefox 中的 Firebug 和 IE 中的开发者工具。问题是该变量在 Chrome 开发人员工具中`numb` **不可见**`debugger;`。但是，它在 Firebug 和 IE 中可见。如果我尝试`numb`在 Chrome 的控制台中输入，我会得到：

```
ReferenceError: numb is not defined 
```

`numb`，当然，在这个闭包中是可见的，如果我将代码更改为（[http://jsfiddle.net/QWFGN/1/](http://jsfiddle.net/QWFGN/1/)）

```
var foo = (function(numb) {
    return {
        bar: function() {
            debugger;
            console.log(numb);
            return "something";
        }
    }
})(1);
foo.bar() 
```

`numb`现在在 Chrome 中也可以看到，我可以得到值`1`作为响应。

所以，我的问题是：**为什么只有谷歌浏览器看不到从未使用过的闭包变量？**谷歌浏览器是否有自己的垃圾收集实现，或者它只与谷歌浏览器中调试工具的实现有关。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-14T13:35:33.717

这与垃圾收集或调试工具没有任何关系。

实际发生的是 Chrome 的 JS 引擎意识到你永远不会`numb`在函数内部使用，所以它根本没有将它包含在闭包中。

请注意，只有当它可以证明内部函数从不使用`with`或调用时，它才能这样做`eval`。

# r - R设置值依赖于另一个值

> ID：15410755
> 
> 赞同：0
> 
> 时间：2013-03-14T13:33:05.983
> 
> 标签：r, dataframe

对于我的数据框的每一行，我想根据从该数据框的列中获取的数字计算一个值。如果计算值大于 2，我想将另一列值设置为 0，否则设置为 1。

```
x=(df$firstnumber+df$secondnumer)/2
if(x>2){
df$binaryValue=0}
else{ df$binaryValue=1} 
```

这会引发错误

> 条件的长度 > 1 并且只使用第一个元素

因为 x 是一个向量

我该如何解决这个问题？一种方法是将其编写为函数并将其应用于数据框 - 还有其他选择吗？

另外，我怎么能写这个来使用 appl() ？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T13:36:16.210

你可以简单地做...

```
df$BinaryValue <- ifelse( x > 2 , 0 , 1 ) 
```

所以你得到...

```
df <- data.frame( x = 1:5 , y = -2:2 )
x <- df$x + df$y
df$BinaryValue <- ifelse( x > 2 , 0 , 1 )

df
#     x  y BinaryValue
#   1 1 -2           1
#   2 2 -1           1
#   3 3  0           0
#   4 4  1           0
#   5 5  2           0 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-14T13:38:33.283

```
transform(df, BinaryValue = as.numeric(firstnumber + secondnumber > 4)) 
```

首先没有必要除以二。您可以检查总和是否大于四。该函数`as.numeric`用于将布尔值转换为数字（0 和 1）值。

# sql - 在 SELECT 子句中的列之间使用相等检查

> ID：15410762
> 
> 赞同：35
> 
> 时间：2013-03-14T13:33:20.597
> 
> 标签：sql, sql-server, select, equality

我正在使用 Microsoft SQL Server 2012，我想运行这个看似简单的查询：

```
SELECT 
    FirstEvent.id AS firstEventID, 
    SecondEvent.id AS secondEventID, 
    DATEDIFF(second, FirstEvent.WndFGEnd, SecondEvent.WndFGStart) AS gap, 
    FirstEvent.TitleID = SecondEvent.TitleID AS titlesSameCheck
FROM VibeFGEvents AS FirstEvent
RIGHT OUTER JOIN VibeFGEvents AS SecondEvent
ON 
    FirstEvent.intervalMode = SecondEvent.intervalMode 
    AND FirstEvent.id = SecondEvent.id - 1 
    AND FirstEvent.logID = SecondEvent.logID 
```

但是`FirstEvent.TitleID = SecondEvent.TitleID AS titlesSameCheck`在`SELECT`子句中是不正确的语法。但[SELECT 子句 (Transact-SQL) 文档](http://msdn.microsoft.com/en-gb/library/ms176104.aspx)包含以下语法：

```
SELECT [ ALL | DISTINCT ]
[ TOP ( expression ) [ PERCENT ] [ WITH TIES ] ] 
<select_list> 
<select_list> ::= 
    { 
        * 
        | { table_name | view_name | table_alias }.* 
        | {
            [ { table_name | view_name | table_alias }. ]
                { column_name | $IDENTITY | $ROWGUID } 
            | udt_column_name [ { . | :: } { { property_name | field_name } 
            | method_name ( argument [ ,...n] ) } ]
            | expression
            [ [ AS ] column_alias ] 
            }
        | column_alias = expression 
    } [ ,...n ] 
```

我认为这意味着表达式在 select 子句中是有效的，并且确实给出的示例包括`1 + 2`. 查看[表达式的文档](http://msdn.microsoft.com/en-gb/library/ms190286.aspx)：

```
{ constant | scalar_function | [ table_name. ] column | variable 
    | ( expression ) | ( scalar_subquery ) 
    | { unary_operator } expression 
    | expression { binary_operator } expression 
    | ranking_windowed_function | aggregate_windowed_function
} 
```

布尔相等检查是有效的表达式，实际上[= (Equals) (Transact-SQL) 文档](http://msdn.microsoft.com/en-us/library/ms175118.aspx)中给出的示例表达式包括一个：

```
SELECT DepartmentID, Name
FROM HumanResources.Department
WHERE GroupName = 'Manufacturing' 
```

尽管在`WHERE`条款中不是`SELECT`条款。看起来我不能使用`=`相等运算符来比较我的`SELECT`子句中的表达式，因为它们被错误地解释为赋值。

如何`FirstEvent.TitleID = SecondEvent.TitleID AS titlesSameCheck`在我的`SELECT`子句中包含等效于的布尔相等列比较？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-03-14T13:35:45.120

像这样：

```
case when FirstEvent.TitleID = SecondEvent.TitleID then 1 else 0 end as titlesSameCheck 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-03-14T13:36:07.367

您不能直接使用布尔类型，除非在条件语句中（case、where、have 等）

解决问题的最佳方法是做类似的事情

```
select case when x = y then 'true' else 'false' end 
```

该`bit`类型可能是最接近布尔值的类型。

```
select CAST(case when x = y then 1 else 0 end as bit) 
```

当然，请使用最能代表您所追求的两个值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T13:45:09.097

正如两个现有答案所述，布尔值不能作为列值返回。这记录在[比较运算符部分](http://msdn.microsoft.com/en-gb/library/ms188074.aspx)：

> 与其他 SQL Server 数据类型不同，布尔数据类型不能指定为表列或变量的数据类型，也不能在结果集中返回。

鉴于这种限制，使用`CASE`将值转换为可以显示的东西是您最好的选择。

# batch-file - 批处理：从绝对路径获取最后一个文件夹并与字符串进行比较

> ID：15410766
> 
> 赞同：0
> 
> 时间：2013-03-14T13:33:24.360
> 
> 标签：batch-file

我在 .bat 文件中使用批处理脚本从绝对路径获取最后一个文件夹，然后与字符串进行比较。例如，我有：C:\Scripts\（从我开始 run.bat 的位置）和子文件夹 C:\Scripts\a\、C:\Scripts\b\results、C:\Scripts\c\results。我想搜索名称为“results”的文件夹，当我发现它可以做一些事情时（例如增加一个计数器）。

`set /A Counter=0` `for /d /r %%F in (*.*) do (` `set path=%FF` `rem if the last folder from the path is = "results" then do some stuff` `if path.contains("results") set /A Counter+=1` `)`

`echo %Counter%`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:19:40.370

```
@ECHO OFF
SETLOCAL
set Counter=0
for /f %%F in ('dir /s/b/ad') do (
 FOR /f %%p IN ("%%F") DO (
 IF /i "%%~nxp"=="results" set /A Counter+=1
 )
)
ECHO %counter% 
```

另一方面，

```
DIR /s/ad/b |FINDSTR /i /e "\results"|FIND /c /v "" 
```

将显示相同的计数。

但是这些方法中的任何一种都会计算“结果”目录的任何出现 - 无论它是否处于最低级别，因此如果`...\results`有子目录，它将被计算在内。

# android - 服务上的 OnBind() 始终返回 False - Android

> ID：15410767
> 
> 赞同：6
> 
> 时间：2013-03-14T13:33:30.973
> 
> 标签：android, service, notifications, android-service, android-context

我正在尝试绑定服务，但`onBind()`总是返回 false。

这是`ServiceConnection`-

```
private ServiceConnection mConnection = new ServiceConnection() {
    public void onServiceConnected(ComponentName className, IBinder service) {
        // This is called when the connection with our service has been established, 
        // giving us the service object we can use to interact with our service.
        mBoundService = ((ScheduleService.ServiceBinder) service).getService();
    }

    public void onServiceDisconnected(ComponentName className) {
        mBoundService = null;
    }
}; 
```

这是呼吁`bindService()`-

```
boolean test = getApplicationContext().bindService(new Intent(this, ScheduleService.class), mConnection, Context.BIND_AUTO_CREATE); 
```

这是 Manifest 中服务的声明——

```
<service android:name=".Notifications.ScheduleService" android:enabled="true"/> 
```

我已经阅读了有关该主题的先前问题，但找不到答案（尝试使用 Application 上下文切换 Activity 上下文，但没有帮助）。

我正在使用 Fragments 和 ActionBarSherlock，并且我的 Activity 扩展`SlidingFragmentActivity`（这就是我使用应用程序上下文的原因，这没有帮助）。

编辑-这是我要启动的服务的代码-

```
public class ScheduleService extends Service {

    /**
     * Class for clients to access
     */
    public class ServiceBinder extends Binder {
        public ScheduleService getService() {
            return ScheduleService.this;
        }
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        Log.i("ScheduleService", "Received start id " + startId + ": " + intent);

        // We want this service to continue running until it is explicitly stopped, so return sticky.
        return START_STICKY;
    }

    @Override
    public IBinder onBind(Intent intent) {
        return mBinder;
    }

    // This is the object that receives interactions from clients. See
    private final IBinder mBinder = new ServiceBinder();

    /**
     * Show an alarm for a certain date when the alarm is called it will pop up a notification
     */
    public void setAlarm(Calendar c) {
        // This starts a new thread to set the alarm
        // You want to push off your tasks onto a new thread to free up the UI to carry on responding
        new AlarmTask(this, c).run();
    }
} 
```

任何帮助将不胜感激 。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T14:08:14.513

为什么要使用应用上下文来绑定服务？bindService 方法是通过 ContextWrapper 调用的。这可能不是问题，但我会在绑定服务的地方和有连接的地方共享上下文。

在你的情况下，而不是

```
boolean test = getApplicationContext().bindService(new Intent(this, ScheduleService.class), mConnection, Context.BIND_AUTO_CREATE); 
```

我会做以下

```
boolean test = bindService(new Intent(this, ScheduleService.class), mConnection, Context.BIND_AUTO_CREATE); 
```

或者，如果您想在应用程序中保留全局上下文，请将所有内容移动到您的应用程序文件并以与上面建议的相同方式类似地调用它。

问题也可能出在您的应用程序包名称和清单中的服务声明上。如果您不确定，请确保在清单中为您的服务提供全局路由。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T22:27:11.727

What is the fully qualified class-name of `ScheduleService` (i.e. including the full package-name)?

I'm asking this, because in your AndroidManifest.xml file, your service's name is `.Notifications.ScheduleService`, which seems a bit odd:

This tells me that either

*   The (last part of the) package-name contains a ***upper-case*** character... not so good.
    I would expect `.notifications.ScheduleService` instead, if this is the case.
*   The `ScheduleService` is defined within a file called Notifications.java. I would expect `.Notifications$ScheduleService` instead, if this is the case (dollar sign instead of period).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T06:56:02.353

你的意思是`bindService()`返回false？ `onBind()`返回`IBinder`类型。

请记住，服务绑定需要一些时间。如果您想在绑定完成后执行一些操作，您可以在`onServiceConnected()`方法中执行它。

```
public void onServiceConnected(ComponentName className, IBinder service) {

    mBoundService = ((ScheduleService.ServiceBinder) service).getService();
    Calendar c = new Calendar();
    mBoundService.setAlarm(c);
} 
```

如果您需要这方面的更多指导，您需要向我们展示您的活动代码。

# android - Android SDK 初始化后无法启动

> ID：15410772
> 
> 赞同：0
> 
> 时间：2013-03-14T13:33:36.537
> 
> 标签：android, sdk

我在eclipse中安装了ADT和SDK，一切正常，但是初始化后我的SDK管理器无法启动。什么都没发生。这是一个屏幕截图。任何想法？[http://prntscr.com/w9u80](http://prntscr.com/w9u80)

在控制台中：[SDK Manager] 'xcopy' 不是内部或外部命令、可运行程序或批处理文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-01T00:13:45.230

您必须以管理员身份运行eclipse，只需单击右键/以管理员身份运行。它是一个权限问题。我已经在 W8.1 和 eclipse“luna”的最新版本上对其进行了测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-11T11:27:00.133

你需要这样做：

1.  去你的bundels/sdk/tools。
2.  键入此命令`android sdk`

有关更多信息，请关注此网址[http://developer.android.com/tools/help/sdk-manager.html](http://developer.android.com/tools/help/sdk-manager.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:38:00.427

单击此[链接](http://developer.android.com/sdk/index.html#download)，您将找到用于 Android 编程的 SDK 和 Eclipse。它比以前版本的 Eclipse 更好更快。

# firefox - 如何强制 Mozilla Firefox 19.0.2 在硬件加速中使用 DX11 API？

> ID：15410778
> 
> 赞同：1
> 
> 时间：2013-03-14T13:33:58.847
> 
> 标签：firefox, directx-11, hardware-acceleration

我想知道是否有办法强制 Mozilla Firefox 在硬件加速中使用 DX11 API？我搜索了 about:config，但什么也没找到。为避免出现问题，IE10 加载 DX11 dll，但它用于不同目的，可能用于渲染 GUI，而不是硬件加速。

提前致谢。

# android - android greenDao - 使用生成的 Get 函数进行查询

> ID：15410782
> 
> 赞同：0
> 
> 时间：2013-03-14T13:34:08.153
> 
> 标签：android, greendao

在使用生成的 Get 函数查询时-我得到以下实体列表 [null]

怎么会这样？

# css - 如何更改我的 css 代码以使页脚适合任何尺寸的显示器的页面底部？

> ID：15410783
> 
> 赞同：2
> 
> 时间：2013-03-14T13:34:08.400
> 
> 标签：css

我正在关注本教程[链接](http://css.maxdesign.com.au/floatutorial/tutorial0815.htm)，但不知道如何将页脚放在页面底部，因此当用户打开页面时，无论显示器大小如何，页脚都位于页面的最底部。

这样当他们改变窗口大小或使用更大的显示器时，页脚应该在页面的末尾。

重要的部分是我的内容部分没有太多文本，因此滚动条在任何尺寸的显示器中都应该是不可见的。（那些不是很小的）

*另请注意，我已经查看了上一个问题，但找不到正确答案。* 如果您知道任何其他教程，我将不胜感激您的建议。（我需要浮动布局）

布局

```
 container
    {
       header
       content
       { 
         leftnav | rightnav
       }
       footer
    } 
```

CSS

```
#container
{
width: 90%;
margin: 10px auto;
background-color: #fff;
color: #333;
border: 1px solid gray;
line-height: 130%;
}

#top
{
padding: .5em;
background-color: #ddd;
border-bottom: 1px solid gray;
}

#top h1
{
padding: 0;
margin: 0;
}

#leftnav
{
float: left;
width: 160px;
margin: 0;
padding: 1em;
}

#content
{
margin-left: 200px;
border-left: 1px solid gray;
padding: 1em;
max-width: 36em;
}

#footer
{
clear: both;
margin: 0;
padding: .5em;
color: #333;
background-color: #ddd;
border-top: 1px solid gray;
}

#leftnav p { margin: 0 0 1em 0; }
#content h2 { margin: 0 0 .5em 0; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:43:16.230

在本教程中，页脚位于`container div`. 如果您从容器中移除，`width:90%`该示例将在整个屏幕宽度上呈现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T21:44:14.407

使用粘性包装 jQuery 插件，或在 -ve 中使用`position: fixed`with `bottom: 5%`and和 margin-left 值。`left: 0`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-04T06:18:33.100

```
<footer style="background-color: crimson; color:springgreen; font-family: serif; text-align: center; font-size: 15px; position:absolute; width: 99.82%;margin-left: -6px; margin-right: -6px;"><h1>THIS IS MY FOOTER</h1></footer> 
```

**浏览器：**谷歌浏览器

**系统屏幕：** 15.6"

> 我体验过我们的 div、页眉、页脚和导航的外观因屏幕而异，并且可能因浏览器而异。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-14T13:37:15.870

试试这个 ：

```
#footer{
        position: absolute;
        bottom: 0px;
        height: 50px;
        width: 100%;
    } 
```

# php - 为 ubuntu 12.10 安装 phpmyadmin 时出错

> ID：15410786
> 
> 赞同：0
> 
> 时间：2013-03-14T13:34:17.003
> 
> 标签：php, phpmyadmin, installation, apache2, ubuntu-12.04

我运行命令：sudo apt-get install phpmyadmin 来安装 phpMyAdmin。然后我收到结果 Err [http://vn.archive.ubuntu.com/ubuntu/quantal/universe](http://vn.archive.ubuntu.com/ubuntu/) phpmyadmin all 4:3.4.11.1-1 404 Not Found Failed to fetch [http://vn.archive.ubuntu.com/ubuntu /pool/universe/p/phpmyadmin/phpmyadmin_3.4.11.1-1_all.deb](http://vn.archive.ubuntu.com/ubuntu/pool/universe/p/phpmyadmin/phpmyadmin_3.4.11.1-1_all.deb) 404 Not Found E: 无法获取某些档案，可能运行 apt-get update 或尝试使用 --fix-missing？我多次尝试更新命令 apt-get update 然后运行命令 sudo apt-get install phpmyadmin 但我收到错误

E: 无法获取一些档案，可能运行 apt-get update 或尝试使用 --fix-missing？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:51:40.577

从这里使用 PPA [https://launchpad.net/~nijel/+archive/phpmyadmin](https://launchpad.net/~nijel/+archive/phpmyadmin)

它比官方 repos 中的主线 phpmyadmin 更新/更新得多

# windows-phone-7 - 带有拖动手势视觉反馈的页面动画

> ID：15410787
> 
> 赞同：0
> 
> 时间：2013-03-14T13:34:18.097
> 
> 标签：windows-phone-7, windows-phone-8, gestures

我想知道，当用户按下应用栏上的 Next of Previous 按钮时，我目前正在使用滑入和滑出页面转换。（概念：浏览选定类别中的一组文章）

这一切看起来都很棒，我还可以添加拖动/轻弹手势监听器来触发这个页面转换......所以没有问题。

但是现在我想添加最后一部分，当用户开始拖动/轻弹手势时，以视觉方式显示它，以便页面跟随手势并“滑出”框架。

但是如何做到这一点？一个例子会很好:) 但是还有一点额外的东西，我不希望用户总是完全拖动......所以如果我们超过屏幕的 2/3，自动启动页面转换 IF手势停止（因此用户抬起手指）

所以我想创造一个很好的阅读体验，直观地显示手势并执行页面转换......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:25:45.323

您可以查看以下链接：[https ://stackoverflow.com/a/9915016/1565574](https://stackoverflow.com/a/9915016/1565574)

在 ManipulationCompleted 中，您将能够检测到 GestureType 并在那里采取行动。

我找到了那个链接：[https](https://stackoverflow.com/a/4342558/1565574) : //stackoverflow.com/a/4342558/1565574（使用GestureService）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T22:30:00.713

我首先从@LocalJoost 的[DragFlickBehavior](http://dotnetbyexample.blogspot.be/2011/03/simple-windows-phone-7-silverlight.html)开始，它实际上效果很好！但最后我改用了无头支点！工作也很棒！

# c++ - 通过与许多 3D 平面相交获得最小二乘调整的单线

> ID：15410788
> 
> 赞同：0
> 
> 时间：2013-03-14T13:34:18.483
> 
> 标签：c++, geometry, computational-geometry, vector-graphics, eigenvector

我正在使用许多 3D 平面并为以下情况寻找最小二乘解决方案。

> 如果我有许多 3D 平面只知道一个点和法线向量（例如 O1 和 N1），并且所有这些平面彼此相交并形成几乎非常接近的 3d 线，那么如何计算最小二乘调整一个单个 3d 线来表示所有这些交叉点。

为了清楚起见，我插入了一个数字。

*   已知：一个点和每个平面的法向量。
*   查找：最小二乘拟合单 line3d

![在此处输入图像描述](../Images/e706142ba2cf8bc3ad4be0171991e0d1.png)

因为我想用 c++ 做这个，所以我也使用 c++ 标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T15:13:01.063

完全未经测试。

如果您从交叉点获取线的方向并获得主[成分怎么办](http://en.wikipedia.org/wiki/Principal_component_analysis)

这将为您提供他们前进的方向。然后使用该方向和任意点创建一个平面，将平面交点计算中的所有点投影到平面上，并找到这些投影点的平均点。

使用该平均点和主成分来定义您的线。

就像是...

```
class Plane
{
public:
    Vector3 Point;
    Vector3 Normal;

    Line Intersect (const Plane &other);

    Vector3 Project (const Vector3 &point);
}

class Line
{
public:
    Vector3 Point;
    Vector3 Direction;

    Line (Vector3 point, Vector3 dir);

};

Vector3 PrincipleComponent (const std::vector<Line> &lines)
{
    //You could use the covariance matrix to get this but I will try the interative method on wikipedia.
    Vector3 p(1,2,3); //a random vector?
    static const int c = 10;
    for (int i = 0; i < c; ++i)
    {
        Vector3 t;
        for (auto i = lines.begin(); i != lines.end (); ++i)
        {
            t = t + ((*i).Direction.Dot (p)) * (*i).Direction;
        }
        t.Normalize();
        p = t;
    }
    return p;
}

int main ()
{
    std::vector<Line> LinesFromPlaneIntersections;

    Vector3 direction = PrincipleComponent (LinesFromPlaneIntersections);
    Plane projplane;
    projplane.Normal = direction;
    projplane.Point = LinesFromPlaneIntersections[0].Point;

    Vector3 meanpoint;
    for (auto i = LinesFromPlaneIntersections.begin(); i != LinesFromPlaneIntersections.end (); ++i)
    {
        meanpoint += projplane.Project ((*i).Point);
    }

    meanpoint /= LinesFromPlaneIntersections.size ();

    Line result (meanpoint,direction);
} 
```

# asp.net-mvc - 使用 mvc 创建博客条目的快照/缩略图

> ID：15410796
> 
> 赞同：4
> 
> 时间：2013-03-14T13:34:30.297
> 
> 标签：asp.net-mvc, asp.net-mvc-4, html-parsing

我需要从多个博客链接生成快照。

我所拥有的是这样的文本列表“*报告：Twitter 将在本月发布音乐发现应用程序[http://on.mash.to/10L1v49](http://on.mash.to/10L1v49) via @mashable* ”

我想将链接显示为博客的快照，然后是我认为的文本。或者至少我需要把图片附加到博客上。

使用 facebook 调试，[http://developers.facebook.com/tools/debug](http://developers.facebook.com/tools/debug)，我得到了这个..

```
fb:app_id:  122071082108
og:url: http://mashable.com/2013/03/13/twitter-music-app/
og:type:    article
og:title:   Report: Twitter Will Release Music Discovery App This Month
og:image:   
og:description: Twitter is planning to release a standalone music app for iOS   called Twitter Music as soon as the end of this month, according to CNET. CNET reports that Twitter Music will help...
og:site_name:   Mashable
og:updated_time:    1363267654 
```

我从我的 c# 代码中尝试了相同的链接，访问了带有参数“q”的链接作为我想要的链接。我得到了与回复相同的 html，但我无法找到关联的图像，因为不同链接的图像不同。

任何人都可以建议在 mvc 中执行此操作的更好方法吗？

我在控制器中访问 facebook 调试的代码：

```
 var client = new RestClient
            {
                BaseUrl = "http://developers.facebook.com/tools/debug/og/object"
            };
            var request = new RestRequest
            {
                DateFormat = DataFormat.Xml.ToString(),
                Resource = "Add",
                Method = Method.GET
            };
            request.AddParameter("q", "http://on.mash.to/10L1v49");

            IRestResponse response = client.Execute(request);
            var content = response.Content; // raw content as string 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T12:57:23.237

我从您的问题中了解到的是，您需要链接预览之类的东西，我们在 Facebook 共享区域上粘贴一些链接时会得到什么。

Facebook 调试方法返回一个 html 页面，其中包含来自给定链接的博客条目的图像。

使用 HtmlAgilityPack 解析从 facebook 调试返回的 html

```
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
        doc.LoadHtml(content);
        HtmlNode root = doc.DocumentNode;
        var imageurl = doc.DocumentNode.SelectNodes("//img/@src").LastOrDefault();
        string imagesrc = imageurl.OuterHtml.ToString();
        int start = imagesrc.IndexOf("url=");
        int to = imagesrc.IndexOf("\"", start + "url=".Length);
        string s = imagesrc.Substring(
                       start + "url=".Length,
                       to - start - "url=".Length);
        string a = Uri.UnescapeDataString(s); 
```

和..那里你有你的博客条目的形象。可以修改相同的函数来检索博客条目的标题、描述和更新时间。

# javascript - 如何使用 XML 从 YouTube 播放列表中检索标题？

> ID：15410801
> 
> 赞同：0
> 
> 时间：2013-03-14T13:34:41.690
> 
> 标签：javascript, jquery, xml, ajax, youtube

在这里我尝试了代码。但它不工作。请帮我

```
 <script type="text/javascript" language="javascript">
$(document).ready(function(){
    $("#dvContent").append("<ul></ul>");
    $.ajax({
        type: "GET",
        url: "http://gdata.youtube.com/feeds/api/playlists/cZxy-GpHLCQ_Ss9sGJfWhzBAIOMDYxMN?v=2",
        dataType: "xml",
        success: function(xml){
            $(xml).find('feed').each(function(i){
            var sTitle = $(this).find('title');

         // alert(sTitle);
          for (var i = 0; i < sTitle.length; i++) {   
          var ssTitle = sTitle[i].firstChild.nodeValue;
          $(ssTitle).appendTo("#dvContent ul");

          }

        });
        },
        error: function() {
        alert("An error occurred while processing XML file.");
        }
    });
});    
</script> 
```

演示链接：- [http://jsfiddle.net/8HUbc/](http://jsfiddle.net/8HUbc/)

提前感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:43:51.920

行后：

```
var sTitle = $(this).find('title'); 
```

做就是了：

```
sTitle.text(); 
```

你就会拥有它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:42:16.733

`feed`尝试仅使用子节点缩小搜索范围：

```
var title = $(xml).find('feed > title').text(); 
```

[http://jsfiddle.net/6wY55/](http://jsfiddle.net/6wY55/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:39:18.973

您的 ajax 请求失败（这与处理您的 XML 文件无关）。错误回调*不像*成功函数周围的`try/catch`块，它表明服务器返回的响应代码不是 200 左右，或者根本没有来自服务器的响应。

# oracle11g - 使用聚合函数 max() oracle 时出错

> ID：15410802
> 
> 赞同：1
> 
> 时间：2013-03-14T13:34:44.467
> 
> 标签：oracle11g

我正在尝试运行查询

```
select * from OS_Historystep where step_name = '011' and finish_date = max(finish_date) ; 
```

但我收到错误

```
ORA-00934: group function is not allowed here
00934\. 00000 -  "group function is not allowed here"
*Cause:    
*Action:
Error at Line: 12 Column: 72 
```

我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:48:33.523

您不能在`where`子句中使用聚合。此外，您不能在一次选择中混合来自同一列的非聚合数据和聚合数据。您需要使用子查询：

```
select * 
from OS_Historystep hs1
where step_name = '011' 
and finish_date = (select max(finish_date) 
                   from OS_Historystep hs2 
                   where hs2.step_name = hs1.step_name); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T13:47:53.333

你不能引用这样的聚合。您要么必须像下面那样放置一个子查询（假设您想要`max(finish_date)`表示步骤 011 的最大完成日期，而不是整个表中的最大完成日期（可能不返回任何行）：

```
select * 
  from OS_Historystep 
 where step_name = '011' 
   and finish_date = (select max(finish_date) 
                        from OS_Historystep
                       where step_name = '011'); 
```

或使用解析函数

```
select *
  from (select s.*, rank() over (partition by step_name order by finish_date desc) rnk
          from OS_Historystep s
         where step_name = '011')
 where rnk = 1; 
```

# java - 如何通过上下文对象获取资源元素

> ID：15410804
> 
> 赞同：0
> 
> 时间：2013-03-14T13:34:48.470
> 
> 标签：java, jakarta-ee, tomcat, jndi

我尝试通过 DatabaseSource JNDI 查找建立数据库连接。我按照 Tomcat 网站中的说明进行了如下操作

我将资源添加到 context.xml

```
<Resource name="jdbc/myDB" auth="Container"
          type="javax.sql.DataSource" driverClassName="oracle.jdbc.OracleDriver"
          url="jdbc:oracle:thin:111.111.111.111:1234:DBNME"
          username="Dobby" password="pwd" maxActive="20" maxIdle="10" maxWait="-1"/> 
```

web.xml

```
 <resource-ref>
    <description>MY DataBase</description>
    <res-ref-name>jdbc/myDB</res-ref-name>
    <res-type>javax.sql.DataSource</res-type>
    <res-auth>Container</res-auth>
    </resource-ref> 
```

在代码中

```
 Context initContext = new  InitialContext();
                DataSource ds = (DataSource)initContext.lookup("java:/comp/env/jdbc/myDB");
                Connection con =  ds.getConnection(); 
```

如果连接失败，我想显示带有 DB URL 的错误消息。如何在我的代码中获取 context.xml 中配置的 DB URL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T13:59:40.407

正如您在 apache 示例中所注意到的，有一个名为 MyBeanFactory 的类。在这个类中，您可以从 context.xml 文件中获取资源。

您需要在 servlet 中检查连接是否建立。如果未建立连接，则使用 setter/getter 方法从 context.xml 中获取 URL 的值，并显示带有 URL 的错误消息。

我对服务器的 IP 地址做同样的事情并取得了成功。:D

希望这可以帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:50:48.720

我不认为这是可能的，您实际上使用 JNDI 来独立于这些细节，您唯一拥有的并且可以在错误消息中输入的是 ressource 的名称`"java:/comp/env/jdbc/myDB"`。进行管理/配置的人会知道这个名称所指的女巫数据库详细信息。

通常，应用程序的开发人员只需定义资源的名称并将其传递给 Appserver-admin。但是在开发过程中，您必须/可能同时扮演这两个角色。

**编辑**

如果您打算仅使用接口[DataSource](http://docs.oracle.com/javase/6/docs/api/index.html?javax/sql/DataSource.html) ，这是当然的。

如果您想针对特定的 DBMS，您可以查看 jdbc 驱动程序提供的该接口的实现。例如，这里是 DataSource 的 Oralce 实现：[OracleDataSource](http://docs.oracle.com/cd/E14072_01/appdev.112/e13995/oracle/jdbc/pool/OracleDataSource.html)，更多信息在[这里](http://docs.oracle.com/cd/B14117_01/java.101/b10979/urls.htm)。

# python - python在solaris中调用外部C程序

> ID：15410805
> 
> 赞同：2
> 
> 时间：2013-03-14T13:34:54.747
> 
> 标签：python, c, solaris-10

我正在尝试调用外部 C 程序。相同的代码已经可以在 linux 和 windows 上运行，但不能在 solaris 上运行。
有人可以看看吗？
原始示例取自[http://csl.name/C-functions-from-Python/](http://csl.name/C-functions-from-Python/)
C 代码 (myModule.c)

```
#include <Python.h>

static PyObject* py_myFunction(PyObject* self, PyObject* args)
{
    char *s = "Hello from C!";
    return Py_BuildValue("s", s);
}

static PyObject* py_myOtherFunction(PyObject* self, PyObject* args)
{
    double x, y;
    PyArg_ParseTuple(args, "dd", &x, &y);
    return Py_BuildValue("d", x*y);
}

static PyMethodDef myModule_methods[] = {
    {"myFunction", py_myFunction, METH_VARARGS},
    {"myOtherFunction", py_myOtherFunction, METH_VARARGS},
    {NULL, NULL}
};

void initmyModule()
{
    (void) Py_InitModule("myModule", myModule_methods);
} 
```

Python 调用它

```
from myModule import *

print "Result from myFunction:", myFunction()
print "Result from myOtherFunction(4.0, 5.0):", myOtherFunction(4.0, 5.0) 
```

在 Linux 上编译（在 RHEL 上测试）

```
gcc -fPIC -shared -I/usr/include/python2.6 -lpython2.6 -o myModule.so myModule.c 
```

在 MinGW 下在 Windows XP 上编译

```
gcc -Ic:/Python27/include -Lc:/Python27/libs myModule.c -lpython27 -shared -o myModule.pyd 
```

但我无法让它在solaris上工作。我可以编译它

```
gcc -fPIC -I/usr/include/python2.4 -L/usr/lib/python2.4 myModule.c -lpython2.4 -shared -o myModule.so 
```

但它失败并出现错误

```
from myModule import *
ImportError: ld.so.1: python2.4: fatal: libgcc_s.so.1: open failed: No such file or directory 
```

有人可以帮我弄清楚吗？

```
gcc 是 3.4.6
Python 是 2.4.6
x86 机器上的 solaris 10
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:44:24.847

这应该把你联系起来

```
 pfexec rm /usr/lib/libgcc_s.so.1
 pfexec ln -s /opt/ts/gcc/3.4/lib/libgcc_s.so.1 /usr/lib/libgcc_s.so.1 
```

# youtube - 关键字搜索在 YouTube API 中返回错误的视频描述

> ID：15410811
> 
> 赞同：0
> 
> 时间：2013-03-14T13:35:08.690
> 
> 标签：youtube, youtube-api, keyword-search

Youtube API 返回的视频不包含搜索关键字。实际上，当您打开 URL 时，视频并没有任何描述。

例如，这是使用关键字检索到的视频`parachuteadvansed`：

```
http://www.youtube.com/watch?hl=en-GB&v=Gqe4td6xpjQ 
```

视频说明：

*   -026。稍后观看 Anushka sharma 童年图像由 iram nadeem 精选 117 ·
*   -213。稍后观看 Anushka Sharma Shine Stories 3 电影 Dealby parachuteadvansed 472 次观看 ·
*   -136。Watch Later Anushka Sharma Shine Stories Prasad Bidappa 时装秀来自 parachuteadvansed 956 次观看 ·
*   -135。Watch Later Deep Conditioning in 20 Minutes Parachute Advansed Deep Conditioning Hot Oilby parachuteadvansed 9236 次观看 ·
*   -129。稍后观看 Anushka Sharma Shine Stories School Daysby ..."

此描述实际上是显示在页面右侧的附加视频的标题。

我使用了这个**查询**：

```
http://gdata.youtube.com/feeds/api/videos?max-results=50&q=parachuteadvansed&orderby=published&v=2 
```

在过去的一周里，我收到了 2000 多个这样的视频，同时获取了大量的关键字。我正在使用 YouTube 的 Java API，直到上周我才遇到这个问题。并非每次提取都会发生这种情况，但在一天中，我平均收到 300 个带有此类描述的 URL。

问题是当您再次获取关键字时，视频不会返回。所以，这个问题无法复制。此外，如果您单独获取视频，则视频不包含说明。

如果这种情况继续下去，那么将会有很多不相关的数据来自 YouTube。

我想知道是否有人面临同样的问题，或者是否有人知道我的查询出了什么问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T15:56:54.860

***更新**：已确定潜在问题，一旦部署修复程序并刷新搜索索引，不应再返回不正确的描述。*

你可以做些什么来解决这个问题。由于 YouTube 搜索索引中的错误，搜索提要中的描述被错误地填充。

我会在内部报告。

（以后，请遵循[此博](http://apiblog.youtube.com/2012/09/the-youtube-api-on-stack-overflow.html)文中的建议，并使用 YouTube API 问题跟踪器[报告错误行为](https://code.google.com/p/gdata-issues/issues/entry?template=YouTube%20%28Defect%20Report%29)。）

# asp.net-mvc - UnitOfWork 作为存储库的容器

> ID：15410813
> 
> 赞同：2
> 
> 时间：2013-03-14T13:35:12.993
> 
> 标签：asp.net-mvc, entity-framework, architecture, unit-of-work, repository

我有一个看起来像这样的解决方案：

**项目 1 <—> 共享项目 <—> 项目 2**

共享项目不是独立的，它通过一个服务层向其他项目公开它的功能，该服务层接受一个由其他两个项目注入到构造函数中的 IUnitOfWork：

```
public SharedService (IUnitOfWork unitOfWork)
{
   ... do stuff ...
} 
```

我遇到的问题是 Project1 和 Project2 有一组重叠但不同的存储库：

**项目1：** SharedRepository、RepositoryA、RepositoryB ...

**项目2：** SharedRepository、RepositoryX、RepositoryY ...

我不断看到[工作单元的实现](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)，它扮演着存储库容器的角色——你绕过 UoW，然后通过公开它们的公共属性到达存储库：

```
unitOfWork.SharedRepository.GetSomething(); 
```

这种方法的结果是您最终会得到一个如下所示的工作单元界面：

```
public interface IUnitOfWork
{
    ISharedRepository SharedRepository();
    IRepositoryA RepositoryA();
    IRepositoryB RepositoryB();
    IRepositoryX RepositoryX();
    IRepositoryY RepositoryY();

    ... etc ...
} 
```

这是我遇到麻烦的地方：接口 IUnitOfWork 现在强制 Project1 和 Project2 实现彼此的存储库。 ***所以在我看来，使用工作单元作为存储库容器的方法可能是一个有缺陷的概念。***

我想到了一些可能的替代方案：

1) 将 IUnitOfWork 分成 3 个部分（IProject1UnitOfWork、IProject2UnitOfWork、ISharedUnitOfWork），然后让服务层接受 ISharedUnitOfWork 参数。看起来很乱，但它可能会起作用。

2) 将 UnitOfWork 变成类似于服务定位器的东西，它在其中维护存储库的集合，然后您注册所需的内容。UoW 的消费者然后检索它需要的任何存储库。

3）将工作单元和存储库独立注入服务层构造函数：

```
public SharedService (IUnitOfWork unitOfWork, ISharedRepository repository)
{
   ... do stuff ...
} 
```

遇到这样的情况，大家会怎么处理？我倾向于选项＃3。它需要传递更多的东西，但替代方案似乎不太优雅。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T15:16:16.850

> 所以在我看来，使用工作单元作为存储库容器的方法可能是一个有缺陷的概念。

我也是。您示例中的工作单元也是一个伪服务定位器（通常已被视为反模式），因此它违反了 SRP。UoW 只是您想要放置在其中的任何用例的事务包装器，它不应该知道任何关于存储库或用例中的任何内容的信息。

请参阅 Dmitry 的回答：[工作单元类如何知道提交时要调用哪个存储库？](https://stackoverflow.com/questions/7547344/how-does-unit-of-work-class-know-which-repository-to-call-on-commit)

所以，对我来说绝对是选项3。

# azure - 为什么第一个入口azure cloud app慢？

> ID：15410819
> 
> 赞同：1
> 
> 时间：2013-03-14T13:35:24.503
> 
> 标签：azure

我在 Azure 云上发布了一个云服务。云服务和服务器位于西欧，我也在欧洲东部的土耳其连接，但似乎有点慢。

为什么第一次进入慢？我怎样才能快速改进这个网站？我不太了解，但我需要总是请求这个网站吗？

你能给我任何关于成为快速天蓝色云服务的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T16:04:37.253

Serkan，您首先需要确保在您的帖子中，您已将云服务或网站发布到 Windows Azure。基于云服务（Web 角色）或网站，您的问题的答案会有所不同。当您想了解更多信息时，我将解释背后发生的事情。

正如您所说的第一次连接速度很慢，我可以看到 Windows Azure 网站会发生这种情况。Windows Azure 网站在共享资源池中运行，并使用热（活动）和冷（非活动）站点的概念，如果网站在 x 时间内没有活动连接，则站点进入冷状态意味着主机 IIS进程退出。当与该网站建立新连接时，需要几秒钟才能使该网站准备就绪并正常工作。取决于您的第一页代码如何，首次加载网站的时间会有所不同。记录了类似的讨论： [Very slow opening MySQL connection using MySQL Connector for .net](https://stackoverflow.com/questions/12393614/very-slow-opening-mysql-connection-using-mysql-connector-for-net/12394795#12394795)

使用 Windows Azure 云服务，整个应用程序模型是不同的。您的 webrole 有自己的 IIS 服务器，它完全专用于您的应用程序，不会出现上述网站限制，但是可能有其他原因可能导致页面加载速度较慢。如果您使用的是 WebRole，那么您可以先运行一个页面加载分析器，然后 RD 到您的 Azure 实例以收集页面加载数据，看看您还可以做些什么来提高性能。

# php - 如何使用 php 从数据库中检索货币符号？

> ID：15410822
> 
> 赞同：0
> 
> 时间：2013-03-14T13:35:28.117
> 
> 标签：php, html-entities, currency-formatting

我有一个客户数据库，我正在从其中一个表（cache_cust）中检索客户的公司名称。我正在以这种格式保存“公司名称”，例如 Mr €2 、 Mr €1 、 £ land 等。这些货币符号正确保存在database.BUT 当我尝试检索“company_name”值时，它们会向我显示如下字符：

```
For example : for "  Mr €2 " ,it shows " Mr â‚¬2   "  . 
```

我如何在 php 页面上显示我的数据，因为它保存在数据库中？如何避免这些符号出现在我的网页上？请注意这些值来自数据库。我尝试过 htmlspecialcharacters 和 htmlentities 但是他们没有工作。请帮忙。谢谢

更新：当我尝试将“公司名称”文本框值发布到下一页并尝试使用 print($_POST['company_name]) 检索它时；，它仍然不显示符号并且不包含特殊字符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:56:07.240

您的页面是如何呈现的 - 在 PHP 中？如果是这样，请尝试将内容类型设置为 UTF-8：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:50:07.140

该字段的字符集/排序规则是`company_name`什么？

听起来你有默认字符集`latin1`。`utf8_unicode_ci`如果是这种情况，您需要将其设置为 UTF-8 。

另请注意，如果该列不是 UTF8 - 您已经保存到其中的任何特殊字符都需要重新保存，因为它们已从多字节形式转换为单字节表示形式。如果您处于这种情况，您可以使用[此图表执行字符串替换。](http://www.i18nqa.com/debug/utf8-debug.html)

# python - Python 3.2：我可以将列表中的一个元组相乘而不将单个元组连接成一个元组吗？

> ID：15410826
> 
> 赞同：0
> 
> 时间：2013-03-14T13:35:36.113
> 
> 标签：python, python-3.2

我喜欢这个列表理解语法的简单性，

```
waves = [(frequency, amplitude) * wave_count] 
```

但在这种情况下，我不喜欢它将相乘的元组连接成一个长元组。

有没有一种简单的方法可以有效地将元组相乘以成为列表中的单独元组？

谢谢，

胜利者

附言

等一下！我只是想通了，但我想我还是会发布这个问题，因为它让我感到困惑。

这做到了：

```
waves = [(frequency, amplitude)] * wave_count 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:37:28.527

使用*真正的*列表理解：

```
waves = [(frequency, amplitude) for _ in range(wave_count)] 
```

或者只是像你一样乘以列表：

```
waves = [(frequency, amplitude)] * wave_count 
```

后者在这种情况下是安全的，因为元组是不可变的。

第一个选项为循环的每次迭代创建一个新元组，第二个选项使用*对*`wave_count`同一元组的引用*扩展*列表。如果您改用可变的（例如，列表或字典），则可能会导致意外结果，但它确实使用更少的内存。

# javascript - 如何在 xpath 中使用计数器

> ID：15410827
> 
> 赞同：0
> 
> 时间：2013-03-14T13:35:37.460
> 
> 标签：javascript, xpath, selenium, rc

我正在使用以下代码来获取随机生成的行的 id：

```
string[] rowIds = new string[numofRowsPassengerTable];
for (int counter=1; counter < numofRowsPassengerTable; counter++)
{
    rowIds[counter] = browser.GetAttribute("xpath=//table[@id='tblPassengers']/tbody/tr[counter]@id");
} 
```

但是上面没有返回任何东西。如果我使用`1`or`2`代替`counter`它返回 id。知道如何使用该计数器来获取行 ID 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:42:13.890

看起来您想实际使用“counter”作为 xpath 字符串中的变量：

```
browser.GetAttribute("xpath=//table[@id='tblPassengers']/tbody/tr[" + counter + "]@id"); 
```

就目前而言，您告诉 XPath 引擎使用一些“计数器”HTML 元素作为 TR 的索引，这显然是行不通的。

# azure - 为 blob 创建 CNAME 的问题

> ID：15410828
> 
> 赞同：3
> 
> 时间：2013-03-14T13:35:40.560
> 
> 标签：azure, azure-blob-storage

在过去的两天里，我一直无法从我的域创建 CNAME 到我的 Blob 存储帐户。我已经注册了域并在我的 DNS 设置中添加了一个指向 verify.azure.com 的 CNAME，但是每当我验证它时（即使等待了几个小时），它似乎永远不会验证......我得到的错误Azure 门户是“验证域名时发生意外错误。请稍后再试。”

是否有一些问题正在发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T15:52:26.520

verify.azure.com 只会验证您是否拥有域的正确密钥，但是您需要另一个别名来设置正确的 CNAME 配置。根据您上面写的内容，您将主机指向 verify.azure.com，但是您是否也将存储子域别名设置为存储名称？如果您正确设置了两个条目，但仍然看到问题，则在您的域注册商级别有一些可用的日志，您可以请求进一步排除故障。

[在此处](http://www.windowsazure.com/en-us/develop/net/common-tasks/custom-dns/#header-2)和[此处](http://blogs.msdn.com/b/avkashchauhan/archive/2011/03/22/using-custom-domain-name-with-windows-azure-storage-instead-of-windows-stroage-name-blob-core-windows-net.aspx)获取更多信息。

# java - 比较从 db 到 String 的值

> ID：15410829
> 
> 赞同：-1
> 
> 时间：2013-03-14T13:35:43.233
> 
> 标签：java, android

我尝试将 db 中的数据与 String 进行比较，但它无效......我向 db 输入了一些信息，一个 int 表示时间和几个字符串。然后我从 db 获取信息并将它们存储为表并显示在 ListView 上。现在我尝试比较这些值以显示特定数据。我知道我的表/数据库中的值，所以我尝试：

```
if (value[i][2] == "Plain"){
} 
```

但它不起作用。所以我尝试：

```
if (value[i][2] != "Plain"){
} 
```

而且我还获得了完整列表，其中包含`value[i][2] == "Plain"`. `OnItemClickListener and show`当value[i][2] `on it so I'm 100% sure`value[i][2]` 它是普通的时候，我也会烤面包

然后我尝试：

```
String PlainTest = value[i][2];
if (value[i][2] == PlainTest){
} 
```

再一次，它是正确的......我也尝试过`value[i][2].trim()`，但仍然没有任何想法我还能检查什么？我知道我从 db 获得的价值。我可以在列表上显示它，我可以在吐司上显示它。但不知何故，我无法将它与字符串进行比较，我没有收到任何错误。就像价值观不匹配

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:37:02.343

尝试：

```
value[i][2].equals("Plain") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:37:17.537

要比较字符串，请使用该`equals`方法

`value[i][2].equals("Plain")`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:37:29.937

用于`equals`比较字符串

```
String PlainTest = value[i][2];
if (value[i][2].equals(PlainTest)) {
} 
```

# c++ - 为 GUID 值专门化一个模板

> ID：15410833
> 
> 赞同：3
> 
> 时间：2013-03-14T13:35:56.850
> 
> 标签：c++, templates, com, clsid

[这是对为什么不是来自常量 POD 对象常量本身的字段](https://stackoverflow.com/questions/15392553/why-arent-fields-from-constant-pod-object-constants-themselves)的跟进？

库中的标头声明类 GUID，例如

```
static const GUID CLSID_EH264VD = 
{ 0x96b9d0ed, 0x8d13, 0x4171, { 0xa9, 0x83, 0xb8, 0x4d, 0x88, 0xd6, 0x27, 0xbe } }; 
```

我想编写一个直接从dll创建对象的函数，不需要注册dll，所以我需要将每个CLSID映射到dll名称。就像是

```
Create<CLSID_EH264VD>() 
```

这将取决于专业化，例如

```
template<>
struct dll<CLSID_EH264VD>
{
    char const* filename = ""mc_dec_avc_ds.ax";
} 
```

因此，尝试使用未知 dll 实例化未注册的类是编译时错误。

问题是模板不能专门用于 GUID。链接的问题说 constexpr 将允许以允许专业化的方式声明 GUID，但 Visual C++ 在最新版本（2012）中不支持 constexpr。任何解决方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T13:44:17.940

根据 C++11 标准的第 14.3.2/1 段：

> 非类型、非模板模板参数的模板参数应为**以下之一**：
> 
> ——对于整数或枚举类型的非类型模板参数，模板参数类型的转换常量表达式（5.19）；或者
> 
> — 非类型模板参数的名称；或者
> 
> — 一个常量表达式 (5.19)，它指定**具有静态存储持续时间和外部或内部链接的对象的地址**或具有外部或内部链接的函数，[...]
> 
> — [...]

这意味着即使`GUID`不能将其本身用作模板参数，您也可以将全局*地址*`GUID`用作参数，并将指向的指针`GUID`用作相应的非类型参数：

```
template<GUID const* pGuid>
struct dll { };

template<>
struct dll<&CLSID_EH264VD>
//       ^^^^^^^^^^^^^^
//       This is a constant expression
{
    char const* filename = ""mc_dec_avc_ds.ax";
}

// ...

dll<&CLSID_EH264VD> x; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:41:01.120

你可以试试

```
template<size_t B1,size_t B2,size_t B3,size_t B4,size_t B5,size_t B6,size_t B7,size_t B8,size_t B9,size_t B10>
class clsid_t{};

typedef clsid_t<0x96b9d0ed, 0x8d13, 0x4171,  0xa9, 0x83, 0xb8, 0x4d, 0x88, 0xd6, 0x27, 0xbe> CLSID_EH264VD;

template<>
struct dll<CLSID_EH264VD>
{
    char const* static name(){return "mc_dec_avc_ds.ax";};
} 
```

# php - ZendService\WindowsAzure 与 zf2

> ID：15410835
> 
> 赞同：1
> 
> 时间：2013-03-14T13:36:01.533
> 
> 标签：php, azure, zend-framework2, storage

我正在尝试使用 composer 安装 zendservice-windowsazure。我的 composer.json 看起来像这样：

```
{
    "repositories": [{
        "type": "pear",
        "url": "http://pear.php.net"
    },
    {
        "type": "composer",
        "url": "https://packages.zendframework.com/"
    }],
    "require": {
        "microsoft/windowsazure": "*",
        "zendframework/zendservice-windowsazure": "2.*"
    },
    "minimum-stability": "dev"
} 
```

根据这里的文档：

[http://framework.zend.com/manual/2.1/en/modules/zendservice.windows-azure.html](http://framework.zend.com/manual/2.1/en/modules/zendservice.windows-azure.html)

然后我可以像这样创建一个新的存储客户端：

```
$storageClient = new ZendService\WindowsAzure\Storage\Blob(); 
```

但是，composer 安装的源代码结构不同，并且似乎与文档中引用的类完全不同。比如上面的调用，根据composer已经安装的源码，其实是：

```
$storageClient = new ZendService\WindowsAzure\Storage\Blob\Blob(); 
```

但是当列出 blob 时，安装的 zendservice-windowsazure 库调用：

```
Zend\Http\Client->request() 
```

这不再是 Client 类中的有效方法。

所以它看起来像：

a) 安装了错误版本的 zendservice-windowsazure

b) Zend 文档不正确

我倾向于认为这是第一个选项，因为引用无效

```
Zend\Http\Client->request() 
```

如果是这种情况，我怎样才能获得模块的最新版本？甚至该模块的 github 存储库与 composer 安装的版本相同，因此无法按照文档中的说明工作。

[https://github.com/zendframework/ZendService_WindowsAzure](https://github.com/zendframework/ZendService_WindowsAzure)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T01:13:21.317

您可以使用旧的 Windows Azure SDK for PHP 4.1.0 [http://phpazure.codeplex.com/releases/view/78020](http://phpazure.codeplex.com/releases/view/78020)。它工作正常。

# vb.net - 在 Windows Phone (VB.NET) 中设置 HTTPS 连接

> ID：15410840
> 
> 赞同：0
> 
> 时间：2013-03-14T13:36:14.573
> 
> 标签：vb.net, windows-phone-7, ssl, https

是否有用于设置与服务器的安全连接的 VB.NET 类？我正在寻找类似于`HTTPSUrlConnection`Android 类的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T16:10:53.373

我不熟悉您提到的 Android 类，但如果您尝试通过 SSL/HTTPS 建立连接，您只需使用与 HTTP 相同的方式即可。不需要特殊课程。

# xml - XSD - 我如何描述一个复杂类型，其子级和 1 个或多个任何元素

> ID：15410845
> 
> 赞同：0
> 
> 时间：2013-03-14T13:36:25.067
> 
> 标签：xml, xsd, schema

我正在尝试创建将包含 XHTML 的元素描述。我在设计时不知道内容是什么。我想做的是这样的：

```
 <xs:element name="section" minOccurs="1" maxOccurs="unbounded">
      <xs:complexType>
        <xs:all>
          <xs:any minOccurs="0"></xs:any>
        </xs:all>
        <xs:attribute name="id" type="xs:string" use="required" />
      </xs:complexType>
    </xs:element> 
```

“部分”将包含 1..* 其他元素。这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:45:52.623

我是 XSD N00b。如果您不描述 xs:element 的内容，则不会对其进行处理。

```
 <xs:element name="section" minOccurs="1" maxOccurs="unbounded"/> 
```

嗬！

# ios - 我如何为 iOS 克隆/复制某种 UIView？

> ID：15410847
> 
> 赞同：5
> 
> 时间：2013-03-14T13:36:26.570
> 
> 标签：ios, objective-c, xcode, uiview

（下面的屏幕截图有助于解释我想要做什么）

这背后的想法是我有一个`UIView`，里面有各种不同`UI`的元素，例如，假设我有一个`UIView`，里面有一个`UILabel`。

现在我想复制`UIView`（里面有标签），但是在那之后我可能需要对标签进行更改，例如更改文本属性。

我需要这样的东西的原因是我可以`UIView`用我需要的所有东西来构建它，看起来不错，但实际上有不同的数据和不同的副本。

我不确定这是最好的方法，但这是我能想到的唯一方法。如果有人对如何做到这一点有任何想法，或者对更好的方法有任何想法，我将不胜感激。很多！![截图方便理解](../Images/43c2b73a1864c7e40004cd5050e98d1d.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-14T13:41:55.420

我个人认为最好的答案是分别创建每个视图并根据需要进行配置。您可以创建一个方法，将新的 UIView 配置为看起来相同，并通过它传递每个视图。

但是，如果你真的需要复制一个 UIView，你可以将它归档，然后再取消归档：

```
id copyOfView = 
[NSKeyedUnarchiver unarchiveObjectWithData:[NSKeyedArchiver archivedDataWithRootObject:originalView]];
UIView *myView = (UIView *)copyOfView;
[self.view addSubview:myView]; 
```

如果您有很多这些，请确保您使用 Instruments 时间分析器来检查您的绘图效率。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-14T13:54:21.467

这是一件非常自然且有用的事情。您正在寻找的是一个容器视图控制器。将您的可重用“单元”放入它自己的视图控制器和它自己的 nib 文件中。然后，在您的父视图控制器中，使用`addChildViewController:`添加任意数量的这些，并配置它们中的每一个。它们每个都有自己的 IBOutlets，您可以使用它们来修改内容。

`UITableView`这与and使用的模式非常相似`UITableViewCell`（它没有专门使用“子视图控制器”，但确实使用了这种模式）。

有关完整的详细信息，请参阅iOS 视图控制器编程指南中的[“创建自定义容器视图控制器”](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html)。

请注意，Storyboard 在对象模板中包含一个“容器视图”作为选项，以使其更加容易。

如果您想要较低级别的访问，您也可以手动执行此操作，`UINib`用于加载 nib 文件并连接其插座（这就是我们在 iOS 5 之前的做法），但今天我将使用子视图控制器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:53:10.150

如果里面只有一个标签，显而易见的解决方案是拥有一个自定义 UIView 子类，并将该标签添加为子视图。每次需要新视图时，您都可以创建自定义子类的实例并设置标签文本。如果您有多个要设置的东西，其中一些对于您的所有自定义子类视图都是通用的，您可以使用原型设计模式，实现起来非常简单。

# jquery - Stellar.js 和引导程序

> ID：15410848
> 
> 赞同：0
> 
> 时间：2013-03-14T13:36:26.867
> 
> 标签：jquery, twitter-bootstrap

我试图让一些视差的东西工作。蓝色球的行为不像[这里](http://webdesigntutsplus.s3.amazonaws.com/tuts/338_parallax/src/index.html)。

它们应该作为背景而不占用任何空间（将表格向下推）。

[在此处](http://www.posterlikes.com/page/)链接到我的测试站点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:51:36.093

虽然，作为一个真正的答案尝试 -

如果您确保视差被初始化，添加`position:absolute`到图像的 CSS 至少会使它们开始做某事（由于您的 Javascript 错误，我不得不使用检查器自己调用该函数）。

# ruby-on-rails - Rails + Instagram gem：有什么方法可以获取特定数量的照片？

> ID：15410849
> 
> 赞同：0
> 
> 时间：2013-03-14T13:36:27.867
> 
> 标签：ruby-on-rails, ruby, count, instagram, photos

我正在尝试获取 100 张最新照片，例如

```
client.tag_recent_media("cat", count: 100) 
```

但它总是返回大约 40 张照片（有时是 36，有时是 38，有时是 40）。我正在使用[这颗宝石](https://github.com/Instagram/instagram-ruby-gem)。

是否有任何方法可以获取 100 张照片或 40 张是限制？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-15T15:43:39.187

这将完成这项工作：

```
def search_method

  result = []
  next_id=nil
  while result.length < 100
    data = client.tag_recent_media("cat", max_id: next_id) if a.length == 0
    next_id = data.pagination.next_max_id
    result.concat(data)
  end

end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T16:30:46.153

你应该尝试这样的事情

```
 client.tag_recent_media(1907035, {count: 60}) 
```

不幸的是，我认为 60 是照片的最大数量。

# mysql - PHP登录问题

> ID：15410850
> 
> 赞同：0
> 
> 时间：2013-03-14T13:36:28.350
> 
> 标签：mysql, login, phpmyadmin

我正在创建一个链接到数据库的登录名，当输入信息时，登录名会运行一个空白页面并且什么都不做，下面是我的代码：

```
 include "conn.php";
    session_start();

    $email_address = $_POST['email_address'];
    $password = $_POST['password'];

    if ($email_address && $password)
    {
    $connect = mysql_connect("computing","i7906890","password") or die ("couldn't   connect!");
    mysql_select_db("i7906890") or die ("couldn't find database");
$guery = mysql_query("SELECT * FROM UserAccount WHERE email_address = '$email_address'");

if ($numrows!=0) {
   //code to login
   while ($row = mysql_fetch_assoc($query)) //Password Check
   {
       $dbemail_address = $row['email_address']
       $dbpassword = $row['password']
   }
   //Check if they match
   if ($email_address==$dbemail_address&&$password==$dbpassword)
   {
      echo "You're in! <a href='user_page.php'>click</a> here to enter the members page";
      $_SESSION['user']==$dbemail_address;
   }
   else
      echo "Incorrect Password!";
}
else
   die("That user doesn't exist!");
}
else
   die("Please enter an email address and password!"); 
?> 
```

这也是我的表格

```
<form action = "login2.php" method ="POST">
        <p><img src="images/space.gif" width="70px" height="1px"/><strong>Log in</strong> or <a href="register_form.php"><strong>Register</strong></a><br>
            Email:<img src="images/space.gif" width="34px" height="1px"/><input type="text" name="user" size="33"> <br>
            Password:<img src="images/space.gif" width="10px" height="1px"/><input type="password" name="password" size="33"> <br>
        <div align="center">
        <input type="submit" value="Log in" class="button">
        </div>
    </p>
    </form> 
```

请帮忙！求救

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:40:13.570

您`;`在代码中遗漏了一些内容，导致脚本出错并且不显示任何内容。（特别是在`while`循环中，但也要检查其他地方。）

编辑：您可能还需要考虑`while`完全丢失该循环并将密码条件放在 SQL 语句中以获得更好的性能。就像其他海报所说的那样，注意 SQL 注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:41:14.930

`Please help! SOS`是的，你深陷其中......但不是你所期望的......

即使您的代码运行良好，您也是第 5 或第 6 个提出大致相同问题的人，在 PHP 登录表单中使用已弃用的**mysql_**函数进行[SQL 注入...](http://en.wikipedia.org/wiki/SQL_injection)

 **而且，**`$guery`**不一样**`$query`**...检查**q**和**g**字母...

这一行：

```
$guery = mysql_query("SELECT * FROM UserAccount WHERE email_address = '$email_address'"); 
```

至少应该是

```
$query = mysql_query("SELECT * FROM UserAccount WHERE email_address = '".mysql_real_escape($email_address)."'"); 
```

既要正确，又要避免注射...

但是你**真的应该通过 PDO 使用准备好的语句**，如下所示：

```
try {
    //open connection, this is different than in the old functions
    $dbh = new PDO('mysql:host=localhost;dbname=test', $user, $pass);

    //***running query
    //**step1: create statement
    $stmt = $dbh->prepare('SELECT * FROM UserAccount WHERE email_address = :email'); //notice parameter prefixed with ':'

    //**step2: bind values (be sure to also check out the bindParameter() function too!)
    $stmt->bindValue(':email', $email_address);

    //**step3: exexcute statement
    $stmt->execute();

    //**step4: process results
    $result = $stmt->fetch(PDO::FETCH_OBJ);

    if($result->PASSWORD==$password) {
      //logged in, do whatever reuqired
    }

    $dbh = null; //don't let it slip out of our hands
} catch (PDOException $e) {
    print "Error!: " . $e->getMessage() . "<br/>";
    die();
} 
```

另外，还有一点要注意：不要存储明文密码。如今，即使存储 MD5 哈希值也超出了范围，并且 SHA1 也被宣布为弱......**

# web.py - 使用来自 Pyjamas/PyJs 的 JSON-RPC 调用和 web.py 后端

> ID：15410855
> 
> 赞同：0
> 
> 时间：2013-03-14T13:36:38.473
> 
> 标签：web.py, pyjamas

这已经花费了我很多小时的谷歌搜索，但我仍然无法让它工作，是时候向 SO 寻求帮助了 :-)

我尝试组装一个简单的测试应用程序，其中前端用 Pyjamas 编写，后端运行在[Web.py](http://webpy.org)上。他们应该通过 JSON-RPC 相互交谈。所需的功能是让用户输入一个字符串，然后将其转换为大写。

睡衣在线书籍[《世界的其他地方》中有](http://pyjs.org/book/Bookreader.html#Rest%20of%20the%20World)关于如何使用 JSON-RPC 的描述，其中将各种技术混合在一起，因此难以解析。通过查看来自[Amund Tveit 的博客](http://amundblog.blogspot.co.at/2008/12/ajax-with-python-combining-pyjs-and.html)等的提示，我拼凑了以下内容：

1）非常简单的**服务器脚本：**

```
import web
import json
import os

urls = (
    '/json', 'JSONHandler',
    '/json/', 'JSONHandler',
)
app = web.application(urls, globals())

class JSONHandler:
    def json_upper(self,args):
        return [args[0].upper()]

    def json_markdown(self,args):
        return [args[0].lower()]

    def POST(self):
        args = json.loads(web.data())
        print args
        json_func = getattr(self, 'json_%s' % args[u"method"])
        json_params = args[u"params"]
        json_method_id = args[u"id"]
        result = json_func(json_params)
        # reuse args to send result back
        args.pop(u"method")
        args["result"] = result[0]
        args["error"] = None # IMPORTANT!!
        web.header("Content-Type","text/html; charset=utf-8")
        return json.dumps(args)

if __name__ == "__main__":
    app.run() 
```

它**确实有效，使用依赖于**[Josh Marshall 的 JSON-RPC 库](https://github.com/joshmarshall/jsonrpclib)的简单查询脚本（未显示）进行测试。

2）**睡衣的客户端脚本**也很简单：

```
# Client example from Amund Tveit's blog
# http://amundblog.blogspot.co.at/2008/12/ajax-with-python-combining-pyjs-and.html

# note: ui and JSONService were not prefixed with pyjamas, but that's needed
from pyjamas.ui import RootPanel, TextArea, Label, Button, HTML, VerticalPanel, HorizontalPanel, ListBox
from pyjamas.JSONService import JSONProxy

class Client:
    def onModuleLoad(self):
        self.TEXT_WAITING = "Waiting for response..."
        self.TEXT_ERROR = "Server Error"

        # This is the remote service
        self.remote_server = UpperService()

        self.status=Label()
        self.text_area = TextArea()
        self.text_area.setText(r"Please uppercase this string")
        self.text_area.setCharacterWidth(80)
        self.text_area.setVisibleLines(8)
        self.button_py = Button("Send to Python Service", self)
        buttons = HorizontalPanel()
        buttons.add(self.button_py)
        buttons.setSpacing(8)
        info = r'Upper-case a string using JSON-RPC'
        panel = VerticalPanel()
        panel.add(HTML(info))
        panel.add(self.text_area)
        panel.add(buttons)
        panel.add(self.status)
        RootPanel().add(panel)

    def onClick(self, sender):
        self.status.setText(self.TEXT_WAITING)
        text = self.text_area.getText()
        # (data, response_class): if the latter is 'self', then
        # the response is handled by the self.onRemoteResponse() method
        if self.remote_server.upper(self.text_area.getText(), self) < 0:
            self.status.setText(self.TEXT_ERROR)

    def onRemoteResponse(self, response, request_info):
        self.status.setText(response)

    def onRemoteError(self, code, message, request_info):
        self.status.setText("Server Error or Invalid Response: ERROR " + code + " - " + message)

# AJAX calls must come from the same server, only the path is given here
class UpperService(JSONProxy):
    def __init__(self):
        JSONProxy.__init__(self, "/json/", ["upper"]) 
```

我用 PyJs 编译它，将默认`output`目录重命名为`static`web.py 可以为它服务，编辑`static/Client.html`以便内部引用指向`static`：

```
<html>
<!-- auto-generated html - You should consider editing and adapting this
 to suit your requirements. No doctype used here to force quirks mode; see
 wiki for details: http://pyjs.org/wiki/csshellandhowtodealwithit/
-->
<head>

<title>Client (Pyjamas Auto-Generated HTML file)</title>
<meta name="pygwt:module" content="/static/Client"> <!-- was content="Client" -->
</head>
<body style="background-color:white">
<script type="text/javascript" src="/static/bootstrap.js"></script> <!-- was src="bootstrap.js" -->
<iframe id="__pygwt_historyFrame" style="display:none;"></iframe>
</body>
</html> 
```

...然后将浏览器指向`http://localhost:8080/static/Client.html`. 我得到的只是一个空白页面，检查`static/Client.html`上面显示的页面源，因此它确实提供给了浏览器。服务器的日志还显示至少有一些页面已被提供：

```
http://0.0.0.0:8080/
127.0.0.1:61466 - - [14/Mar/2013 13:59:39] "HTTP/1.1 GET /static/Client.html" - 200 
127.0.0.1:61466 - - [14/Mar/2013 13:59:40] "HTTP/1.1 GET /static/Client.nocache.html" - 200 
127.0.0.1:61466 - - [14/Mar/2013 13:59:40] "HTTP/1.1 GET /static/Client.safari.cache.html" - 200 
```

然而，没有迹象表明出了什么问题。尝试了各种其他 URL 组合，重命名目录，使用 -d 选项编译睡衣部分，希望获得调试堆栈跟踪......无济于事。

有没有人成功让睡衣和 Web.py 一起工作？如果是，那么请分享如何。谢谢。

PS：我正在使用 web.py V0.37 和最新的睡衣开发版本。（当前的稳定版本 V0.8.1 也不起作用。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-18T22:37:24.860

I know you're probably over this, but finding your code helped me fixing mine and it seems tricky to find working examples online for pyjs with webpy.

Your problem was on the client script side, where you needed to add some code to start the client:

```
if __name__ == '__main__':
    app = Client()
    app.onModuleLoad() 
```

Moreover, to avoid errors that will then appear, your first line of import should be changed to:

```
from pyjamas.ui.RootPanel import RootPanel
from pyjamas.ui.TextArea import TextArea
from pyjamas.ui.Label import Label
from pyjamas.ui.Button import Button
from pyjamas.ui.HTML import HTML
from pyjamas.ui.VerticalPanel import VerticalPanel
from pyjamas.ui.HorizontalPanel import HorizontalPanel
from pyjamas.ui.ListBox import ListBox 
```

# html - 了解用于定位的 CSS &

> ID：15410862
> 
> 赞同：1
> 
> 时间：2013-03-14T13:37:03.743
> 
> 标签：html, css

我有一些 css 代码应该像这样排列 html 标签：（*一个编辑过的图像，显​​示我想如何用 css 排列元素）*
![在此处输入图像描述](../Images/1b6a25dfe6ce46d379b1cdb4afc11ad0.png)
这是我的 css 样式的代码：

```
.hbox
{   margin-top:15px;
width:100%;     
-webkit-box-shadow:0 1px 5px rgba(0, 0, 1, 0.3), 0 0 4px rgba(0, 0, 0, 0.1) inset;
   -moz-box-shadow:0 1px 5px rgba(0, 0, 1, 0.3), 0 0 4px rgba(0, 0, 0, 0.1) inset;
        box-shadow:0 1px 5px rgba(0, 0, 1, 0.3), 0 0 4px rgba(0, 0, 0, 0.1) inset;
}
.hbox p{
margin-top:-8%;
margin-left:25px;
padding-bottom:6px;
font-size:12px;
color:#859489;
text-shadow:#6F7678 0px 0px 1px;
}
.hbox h3{
position:relative;
top:0px;
margin-left:3px;
font-size:45px;
color:#78A4AD;
text-shadow:#6F7678 0px 1px 2px;
} 
```

所以，我把它放在我的html页面上

```
<div class="hbox">
<h3>1</h3><p>This is a demo postr<br>lorem ipsum spsum</p>
</div>
<div class="hbox">
<h3>2</h3><p>This is a demo postr</p>
</div> 
```

这个 css 的输出令人沮丧： ![在此处输入图像描述](../Images/faa057fcce82b57b56da699d30159afc.png)

如何完美安排。是我把它弄复杂了。对不起这个愚蠢的问题......我只是在学习CSS......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T14:15:54.203

您可以调整值以满足您的需要，但请查看我在这里创建的小提琴：http: [//jsfiddle.net/EezLZ/](http://jsfiddle.net/EezLZ/)

实际上，我对你的 CSS 做了一些重要的调整，以使用更多的相对值来使所有定位更容易。我在小提琴的 CSS 部分添加了很多评论，也请检查一下，但是对主要更改有一些解释......

```
.hbox {
  position:relative;
  margin-top:2em;
  padding:0.15em;
  padding-left:3em;
  /* ... */
} 
```

**位置：相对**

因为`hbox`是您的主要容器，所以给它，`position:relative`以便所有子元素都可以根据它的容器定位。没有这个，至少一些浏览器可以使用父容器元素。我们将要相对于它的父级定位大数字，所以这是必要的。

**边距顶部：2em**

由于我们希望数字与顶部的一部分重叠并且我们希望盒子之间有间距，因此给每个盒子一个 2em 的距离。1em 将覆盖盒子和 1em 之间的一些间距，以帮助解释数字的部分重叠。当然，您可以根据设计的需要调整该值。另请注意，在 EM 中工作将有助于使此设计更易于调整（而不是像素）。

**填充：0.15em**

在盒子周围给盒子一些标准的填充物。同样，可以根据您的设计需要轻松调整此值。

**填充左：3em**

我们的愿望是在左边有一个很大的“数字”。我们将“悬停”这个数字，这会将其从文档的“流”中删除。所以，我们需要在盒子里预留一些空间来解决这个问题。否则，框内的内容会在数字下方流动，数字会重叠在上面。

```
.hbox h3 {
  position:absolute;
  top:-0.5em;
  left:0.1em;
  margin:0;
  padding:0;
  font-size:300%;
} 
```

**位置：绝对；**

我们对`hbox`样式的设置导致了这一点。绝对定位您的“数字”元素以将其从流程中移除，并允许您将其放置在与其容器相关的任何位置。

**顶部：-0.5em；**

`top:0`会将元素与盒子的顶部齐平。我们想要一点上手，所以我们通过使用负值将它向上移动一点。正值会将元素向下移动，远离顶部。同样，根据您的设计需求调整实际值。

**左：0.1em；**

就像 top 一样，`left:0`会将元素与容器的左边缘齐平。我只是给了它一点间距。根据需要进行调整。

**边距：0；填充：0；**

浏览器可以为元素提供默认的填充/边距。将这些设置为零，这样它们就不会干扰设计。

**字体大小：300%；**

使用百分比（或 EM）作为字体大小（相对于像素）。这有助于保持更简洁的设计并更准确地调整您的元素。现在您知道这个数字比基本字体“大 3 倍”。如果基本字体是 1em，则 3em 是 3 倍大。这可以帮助您调整填充/边距，而无需猜测像素大小。如果你的基本字体大小发生变化，一切都应该相对缩放。

```
.hbox p {
  font-size:75%;
  color:#859489;
  text-shadow:#6F7678 0px 0px 1px;
} 
```

请注意，您无需尝试定位内容，因为您设置了容器和标题来执行此操作。您只需要根据需要对其进行样式设置。

**弱点**

Note item of note... 这种设计的弱点可能是绝对定位的数字。因为它已从工作流程中删除，几乎没有内容的容器框可能会导致数字也与底部边缘重叠，对于足够大的数字（即，如果您将标签的字体大小增加到足够大并且您有一个线，填充很少）。

这个弱点应该是次要的，因为您必须拥有相当大的字体大小和足够小的内容才能发生这种情况，但这可能是一种极端情况。

我希望这会有所帮助！

干杯!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:39:46.560

你试过放进`text-align:center;`去吗

```
 .hbox p{
margin-top:-8%;
margin-left:25px;
padding-bottom:6px;
font-size:12px;
color:#859489;
text-shadow:#6F7678 0px 0px 1px;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T13:51:37.233

像这样怎么样：[jsfiddle.net/xGyN8/](http://jsfiddle.net/xGyN8/) 我只是添加

```
.hbox h3{
    display:inline;
    top:-20px;
 }
.hbox p{
    text-align:center;
    margin-top:-10%;  
 } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-14T13:55:16.470

如果您可以为**.hbox指定****宽度**和**高度**，这将起作用：

 **```
.hbox
{   
    margin-top:15px;
    width:300px;
    height: 70px;    
    -webkit-box-shadow:0 1px 5px rgba(0, 0, 1, 0.3), 0 0 4px rgba(0, 0, 0, 0.1) inset;
    -moz-box-shadow:0 1px 5px rgba(0, 0, 1, 0.3), 0 0 4px rgba(0, 0, 0, 0.1) inset;
    box-shadow:0 1px 5px rgba(0, 0, 1, 0.3), 0 0 4px rgba(0, 0, 0, 0.1) inset;
    position:relative; 
}
.hbox p{
    top:-8%;
    left:55px;
    padding-bottom:6px;
    font-size:12px;
    color:#859489;
    text-shadow:#6F7678 0px 0px 1px;
    position:absolute;
}

.hbox h3{
    font-size:45px;
    color:#78A4AD;
    text-shadow:#6F7678 0px 1px 2px;
    position:absolute;
    left:10px;
    top:-60px;
} 
```

JSfiddle：http: [//jsfiddle.net/39j8n/](http://jsfiddle.net/39j8n/)**

# jquery - jQuery 鼠标点击事件处理程序

> ID：15410870
> 
> 赞同：2
> 
> 时间：2013-03-14T13:37:26.710
> 
> 标签：jquery, eventtrigger

我想制作一些键盘快捷键，以触发单击跨度框时发生的相同事情。它需要在IE7中工作。我怎么能这样做？这是我到目前为止所拥有的：

**HTML**

```
<li id="detail">
  <a href="#" onClick="access(this);">
    <span>Detailed Report</span>
  </a>
</li>
<li id="product">
  <a href="#" onClick="access(this);">
    <span>Product Area Report</span>
  </a>
</li> 
```

**查询**

```
(document).keypress(function(e){
    if (!$(e.target).is('input, textarea')) {
        var code = e.which || e.keyCode;
        switch ( code ) {
            case 13: //enter
                getTable();
                return false;
            default:
                break;
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:38:41.127

> 我从您问题的原始版本中了解到您正在寻找或*生成*点击事件的方法。

有两种非常相似的方法可以触发对 jQuery 元素的点击。

1.  `$(element).click()`

2.  `$(element).trigger('click')`

同样的`trigger()`功能也可以用于其他类型的事件。例如，

```
$(element).trigger('submit'); // for a form element
$(element).trigger('dblclick'); // for a double click event 
```

### 参考资料 -[`trigger()`文档](http://api.jquery.com/trigger/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:44:20.257

的HTML：

```
<li id="detail">
  <a href="#" class="detail-report">
    <span>Detailed Report</span>
  </a>
</li>
<li id="product">
  <a href="#" class="product-report">
    <span>Product Area Report</span>
  </a>
</li> 
```

jQuery：

```
 $(function(){

        $(".detail-report").click(function(e) {
          e.preventDefault();
          /*trigger the other thing here*/
          alert("clicked on the detail report");
          myevent(); //declare a function somewhere in the scope of your js and call it here :)
        });

        $(".product-report").click(function(e) {
          e.preventDefault();
          /*trigger the other thing here*/
          alert("clicked on the product report"); 
        });
    }); 
```

我的[小提琴演示](http://jsfiddle.net/blackhawx/FuM7N/)

您也可以将这个想法与这样的 keydown 功能融合在一起......

```
$(document).keydown(function(e) {
switch(e.KeyCode) {
//you just gotta know your key codes and what numbers they are associated to!
case 68: //when you press the (d) key trigger something...
  alert('i used my keyboard to press the d key.')
 myevent(); //you can call that same function that you created earlier, and place it here.
break;
  }
}); 
```

# php - 为昨天创建一个时间戳并将该范围内的所有时间戳分组

> ID：15410876
> 
> 赞同：0
> 
> 时间：2013-03-14T13:37:36.653
> 
> 标签：php, mysql

我有一个充满数据的数据库，其中也有一个时间戳字段。我要做的是计算按时间戳分组的字段中的记录数，但四舍五入到天。

我目前有一段代码如下，

```
$days_ago7a = date('Y-m-d', mktime(0, 0, 0, date("m") , date("d") - 7, date("Y")));
$result = mysql_query("SELECT * FROM all_count WHERE date='$days_ago7a'");
$num_rows37 = mysql_num_rows($result); 
```

我想做同样的事情，只是用时间戳（也在数据库中）替换日期，并将 24 小时内的所有时间戳分组。

那可能吗？

好的，所以我已将代码更改为此，但它不返回任何结果？

```
$result = mysql_query("select date( timestamp ), count(*) from all_count group by date(   timestamp );") 
 or die(mysql_error());  
  while($row = mysql_fetch_array( $result )) { 
  echo "$timestamp";
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:45:20.123

按时间戳的日期分组：

```
select date( timestampfield ), count(*) from all_count group by date( timestampfield ); 
```

要获得昨天的计数：

```
select count(*) from all_count where date(timestampfield) = date_sub( curdate(), INTERVAL 1 day ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:56:42.833

我想仅在日期（而不是时间）范围内使用时间戳的更简单方法是执行以下操作：

```
$date = '2012-05-20 11:25:12';
$date = strtotime($date);
$begginingOfDay = date('Y', $date).'-'.date('m', $date).'-'.date('d', $date).' 00:00:00'
$timestamp = strtotime($begginingOfDay); 
```

现在你已经`$timestamp`包含了一天开始的时间戳。然后你可以使用它，例如减去几天：

```
//timestamp points to 2012-05-20 00:00:00
$timestampWeekBefore = $timestamp - 7 * 24 * 60 * 60; //date - 7 days * 24 hours * 60 minutes * 60 seconds 
```

会给你`2012-05-14 00:00:00`。操作后，您可以`date`以适当的格式调用以放入您的页面或查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T14:02:42.877

[MySQL日期函数来救援！](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_to-days)

> TO_DAYS(date) 给定一个日期日期，返回一个天数（自 0 年以来的天数）。
> 
> ```
> mysql> SELECT TO_DAYS(950501);
>     -> 728779
> mysql> SELECT TO_DAYS('2007-10-07');
>     -> 733321 
> ```

我想你可以弄清楚其余的。

# java - 在 Java 程序中创建和销毁多个 AWT-Shutdown 和 AWT-EventQueue 线程

> ID：15410879
> 
> 赞同：3
> 
> 时间：2013-03-14T13:37:42.593
> 
> 标签：java, multithreading, awt, javafx

我在 VisualVM 和线程视图中监视 JavaFX 程序，创建和销毁的 AWT-EventQueue-0 和 AWT-Shutdown 线程不断涌现。这是正常行为吗？这是什么原因？

![线程列表](../Images/eb9c80421cd4208a1e30cc84b8648c7c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-13T17:54:02.757

如果不查看所有代码，很难知道确切原因，但是我已经看到如果您在没有 Swing/AWT GUI 的情况下安排 Swing 计时器时会发生这种情况。

如果不存在 Swing/AWT GUI，则每次触发计时器时，EDT 和 Shutdown 线程都会被销毁并重新创建。

如果您有 JavaFX GUI，则您已经用 JavaFX 标记了这个问题，您不应该使用 Swing类或其他 Swing 线程实用程序，`Timer`例如或。`invokeLater()``invokeAndWait()``SwingWorker`

`javafx.concurrent`查看支持 JavaFX 事件调度线程的调度和后台任务的包的内部。

# java - 运行另一个应用程序，如果失败打开 Google Play

> ID：15410884
> 
> 赞同：1
> 
> 时间：2013-03-14T13:37:50.530
> 
> 标签：java, android, eclipse, google-play

我只是想从另一个应用程序运行我的应用程序。对此没有任何问题，我正在使用此代码：

```
 Intent i = new Intent("android.intent.action.MAIN"); 
    ComponentName n = new 
    ComponentName("de.yanniks.myapp", 
    "de.yanniks.myapp.MyAppActivity"); 
    i.setComponent(n); 
    startActivity(i); 
```

问题是如果没有安装被调用的应用程序，应用程序就会崩溃。取而代之的是，我想打开该应用程序的 Google Play 网站，以便用户下载它。我该怎么做？

请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T13:40:59.963

尝试：

```
try {
    Intent i = new Intent("android.intent.action.MAIN"); 
    ComponentName n = new 
    ComponentName("de.yanniks.myapp", 
    "de.yanniks.myapp.MyAppActivity"); 
    i.setComponent(n); 
    startActivity(i); 
} catch(ActivityNotFoundException e) {
    Intent intent = new Intent(Intent.ACTION_VIEW);
    intent.setData(Uri.parse("market://details?id=de.yanniks.myapp"));
    startActivity(intent);
} 
```

我已将此代码直接输入到答案框中，因此这里或那里可能存在错误，但这是它的一般要点。

# python - 在 Python 中使用多个 x 轴覆盖数据

> ID：15410885
> 
> 赞同：0
> 
> 时间：2013-03-14T13:37:53.173
> 
> 标签：python

我正在尝试从包含计数率与时间的 .fits 文件中绘制一些数据。我的目标是在同一个图中过度绘制不同事件的计数率，在三个不同的 x 轴上具有不同的时间。由于我要绘制的事件是周期性的，因此我对正确时间的识别施加了一个条件，因此我只能从我需要的时间范围中提取计数率。这是我的努力：

```
#!/usr/bin/env python

from scipy import *
from numpy import *
from pylab import *
from scipy import optimize
import pyfits, os, re, glob
import matplotlib.pyplot as plt
import matplotlib as mpl
from matplotlib.ticker import FuncFormatter

rc('font',**{'family':'serif','serif':['Helvetica']})
rc('ps',usedistiller='xpdf')
rc('text', usetex=True)

#------------------------------------------------------

tmin=56200
tmax=56249

data=pyfits.open('http://heasarc.gsfc.nasa.gov/docs/swift/results/transients/weak/GX304-1.orbit.lc.fits')

time  = data[1].data.field(0)/86400\. + data[1].header['MJDREFF'] + data[1].header['MJDREFI']
rate  = data[1].data.field(1)
error = data[1].data.field(2)
data.close()

cond= ((time > tmin-5) & (time < tmax)) | ((time + 132.5 > tmin) & (time + 132.5 < tmax-10)) | ((time + 265 > tmin) & (time + 265 < tmax-12))
time=time[cond]
rate=rate[cond]
error=error[cond]

fig, ax1 = plt.subplots()
newax2 = ax1.twiny()
newax3 = ax1.twiny()

# Make some room at the bottom
fig.subplots_adjust(bottom=0.30)

newax2.set_frame_on(True)
newax2.patch.set_visible(False)
newax2.xaxis.set_ticks_position('bottom')
newax2.xaxis.set_label_position('bottom')
newax2.spines['bottom'].set_position(('outward', 20))

newax3.set_frame_on(True)
newax3.patch.set_visible(False)
newax3.xaxis.set_ticks_position('bottom')
newax3.xaxis.set_label_position('bottom')
newax3.spines['bottom'].set_position(('outward', 40))

#..plot the current light curve
errorbar(time, rate, error, fmt='r.', capsize=0)
gca().xaxis.set_major_formatter(FormatStrFormatter('%5.1f'))

#..overplot a previous outburst
errorbar(time + 122.5, rate, error, fmt='g.', capsize=0)
errorbar(time + 255, rate, error, fmt='k.', capsize=0)

axis([tmin-10,tmax,-0.00,0.45])
xlabel('Time, MJD')
ylabel("BAT cts/s/cm$^2$")
savefig("sync.eps",orientation='portrait',papertype='a4',format='eps')
os.system('gv sync.eps') 
```

我正在绘制三个事件，所以我需要三个 x 轴；但是，如果可能的话，我也想用相应的颜色在 x 轴上写下相应的时间。底部报告的时间是红色曲线的正确时间，即最近的事件。请问有什么建议吗？提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T15:12:26.743

如果我正确理解了您的问题，则问题是第一个和第二个 x 轴上的刻度不正确。您应该简单地将函数绑定`errorbar`到正确的轴，然后 matplotlib 将为您进行缩放。像这样：

```
...
#..plot the current light curve
ax1.errorbar(time, rate, error, fmt='r.', capsize=0)
gca().xaxis.set_major_formatter(FormatStrFormatter('%5.1f'))

#..overplot a previous outburst
newax2.errorbar(time + 122.5, rate, error, fmt='g.', capsize=0)
newax3.errorbar(time + 255, rate, error, fmt='k.', capsize=0)
... 
```

无论如何，我通常更喜欢 matplotlib 中更面向对象的方法，所以这是唯一的方法。

如果您不介意，我会将着色部分留给我的评论中的参考。

**更新**

以下是一些更新的代码；也许这就是你要找的。诀窍是*不要*移动 x 数据 ( `time`)，而只需将 x 限制（您正在查看的“窗口”）移动到您想要的位置。所以我将 122.5 和 255 偏移量（反向）分别应用于每个轴的 x 限制。

我还必须分别为每个轴设置格式化程序；如果我不设置格式化程序，你最终会得到一个偏移符号（0 .. 10 .. 20 .. 30 + 56190）。像你一样使用全局格式化程序，（我认为）只能在`ax1`. 请注意，我只在全局范围内设置 y 限制，并注释掉`axis`命令。

```
...
##..plot the current light curve
ax1.errorbar(time, rate, error, fmt='r.', capsize=0)
ax1.set_xlim(tmin-10,tmax)
ax1.xaxis.set_major_formatter(FormatStrFormatter('%5.1f'))
##..overplot a previous outburst
newax2.errorbar(time, rate, error, fmt='g.', capsize=0)
newax3.errorbar(time, rate, error, fmt='k.', capsize=0)
newax2.set_xlim(tmin-10-122.5,tmax-122.5)
newax2.xaxis.set_major_formatter(FormatStrFormatter('%5.1f'))
newax3.set_xlim(tmin-10-255,tmax-255)
newax3.xaxis.set_major_formatter(FormatStrFormatter('%5.1f'))
ylim(0,0.45)
#axis([tmin-10,tmax,-0.00,0.45])
... 
```

这会导致 ![在此处输入图像描述](../Images/7ad8d37907d97c2f80abdb811d97d5bd.png) 您的原始脚本产生的结果，但希望有一组正确的 x 轴（除了着色）。

# php - PHP Mysql查询返回null

> ID：15410886
> 
> 赞同：1
> 
> 时间：2013-03-14T13:37:53.710
> 
> 标签：php, mysql

我有一个简单的 PHP 登录功能。在这个函数中，我通过一个 MySQL 查询来检查用户是否存在，该查询从表中选择用户名并计算返回的行数。当我知道表包含用户名这一事实时，查询返回 null 时遇到问题。

这是我的代码。

```
function login($user_name, $password) {
    $db1 = new DB_CONNECT();        
    $db1->connect();

    $query = "SELECT user_name FROM users WHERE user_name = '$user_name'";
    $result = $db1->makeAQuery($query);

    if (mysql_num_rows($result) == 1) {
        //check the password
    }
    else {
        //no user exist 
    }
} 
```

我知道传入的用户名和密码是可以的，我在将它们发送到函数之前修剪任何空格。我知道数据库连接正在工作，因为它适用于我的其余 PHP 代码。我得到的唯一错误是提到 mysql_num_rows “期望参数 1 是资源，给定 null”

数据库类

```
class DB_CONNECT {
    function connect() {
        // import database connection variables
        require_once __DIR__ . '/db_config.php';
        $con = mysql_connect(DB_SERVER, DB_USER, DB_PASSWORD) or die(mysql_error());

        // Selecing database
        mysql_select_db(DB_DATABASE, $con) or die(mysql_error());
    }
    function makeAQuery($query) {
        $result = mysql_query($query) or die(mysql_error());        
    } 
    function close() {
       // closing db connection
    mysql_close();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:06:57.293

这应该有效：

`"SELECT user_name FROM users WHERE user_name = '".$user_name."'";`

还

改变这个：

```
function makeAQuery($query) {
    $result = mysql_query($query) or die(mysql_error());        
} 
```

至

```
function makeAQuery($query) {
    $result = mysql_query($query) or die(mysql_error());      
    return   $result;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-14T13:40:44.193

也许尝试删除查询中 = 之间的空格。

```
"SELECT user_name FROM users WHERE user_name='$user_name'" 
```

您的脚本可能返回 null，因为查询无法运行。

# java - 如何检查 GPRS/3G 是否开启？

> ID：15410888
> 
> 赞同：0
> 
> 时间：2013-03-14T13:37:57.187
> 
> 标签：java, android

当我的应用程序启动时，我想检查 GPRS/3G 是打开还是关闭。我在下面有这段代码，它通常检查互联网是否打开（wifi 或 3G），例如是否打开了 wifi，它将我的 wifi 和 gprs 切换按钮都设置为 ON。而我不能拥有那个。如果wifi打开，我希望只打开wifi切换按钮，而不是gprs。按钮工作正常，仅在启动时检查和设置其值不起作用。

```
public class SwarmPopup extends SwarmActivity implements OnClickListener{

    private boolean isNetworkConnected() {
          ConnectivityManager cm = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
          NetworkInfo ni = cm.getActiveNetworkInfo();
          if (ni == null) {
           // There are no active networks.
           return false;
          } else
           return true;
         }

    Button ok;
    WifiManager wifiMan;
    ToggleButton wifi, gprs;

    @Override
    protected void onCreate(Bundle arg0) {
        super.onCreate(arg0);

        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);

        setContentView(R.layout.swarmpopup);

        addListenerOnButton();

        wifi.setChecked(wifiMan.isWifiEnabled());

        ok.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                finish();
            }
        });

        wifi.setOnClickListener(new OnClickListener() {  //Ukljucuje WiFi

            @Override
            public void onClick(View v) {

                wifi.setEnabled(wifiMan.isWifiEnabled());

                try
                  {
                    if (((ToggleButton)v).isChecked()){
                    SwarmPopup.this.wifiMan.setWifiEnabled(true);
                    Toast.makeText(getApplicationContext(), "WiFi je uključen", Toast.LENGTH_LONG).show();
                  }else{
                        SwarmPopup.this.wifiMan.setWifiEnabled(false);
                    Toast.makeText(getApplicationContext(), "WiFi je isključen", Toast.LENGTH_LONG).show();
                  }
                  }
                catch (Exception localException)
                  {
                    Log.e("SwarmPopup", "error on WiFi listerner: " + localException.getMessage(), localException);
                  }
            }
        });

        gprs.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {

                try
                  {
                    if (((ToggleButton)v).isChecked()){
                      GprsSettings.setMobileDataEnabled(getApplicationContext(), true);
                    Toast.makeText(getApplicationContext(), "GPRS je uključen", Toast.LENGTH_SHORT).show();
                  }else{
                      GprsSettings.setMobileDataEnabled(getApplicationContext(), false);
                    Toast.makeText(getApplicationContext(), "GPRS je isključen", Toast.LENGTH_SHORT).show();
                  }
                  }
                catch (Exception localException)
                  {
                    Log.e("SwarmPopup", "error on GPRS listerner: " + localException.getMessage(), localException);
                  }
            }
        });

        gprs.setChecked(isNetworkConnected());

    }

    private void addListenerOnButton() {
        Typeface dugme = Typeface.createFromAsset(getAssets(), "myriad.ttf");
        ok = (Button) findViewById(R.id.btOKSwarm);
        ok.setTypeface(dugme);
        gprs = (ToggleButton) findViewById(R.id.tbGPRS);
        wifi = (ToggleButton) findViewById(R.id.tbWiFi);

        // Getting the WiFi Services
        wifiMan=(WifiManager)getSystemService(Context.WIFI_SERVICE);
        //Proverava da li je WiFi ukljucen ili ne

    }

    @Override
    public void onClick(View v) {

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T14:00:39.310

您需要使用反射来检查当前是否启用了移动设备，因为没有用于获取/设置移动数据的**公共 API 。**

看到这个线程。 [如何检查移动网络是否启用/禁用](https://stackoverflow.com/questions/8224097/how-to-check-if-mobile-network-is-enabled-disabled/8243305#8243305)

# jquery - Ajax im chat Messenger 冲突 betn JQuery 和 Prototype

> ID：15410889
> 
> 赞同：0
> 
> 时间：2013-03-14T13:37:58.283
> 
> 标签：jquery, chat, prototype, livechat

我已经安装了 Ajaxim 3.4 ...独立工作正常，但我现有的站点有问题....ajaxim 原型与 JQuery 冲突....所以停止我的 jquery 功能。

是否也有带有 JQuery 的 ajaxim 脚本......没有原型版本。

任何帮助将不胜感激。

提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:43:38.310

Prototype 没有那么灵活，但是 jQuery 可以设置为使用不同的标识符`$`：

```
var $j = jQuery.noConflict();

// Use jQuery via $j
$j(document).ready(function(){
    $j("div").hide();
});

// Use Prototype with $(...), etc.
$('someid').hide(); 
```

来源：[http ://docs.jquery.com/Using_jQuery_with_Other_Libraries](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)

这样两个库可以并排使用。

现在，如果您自己的代码都使用`$`jQuery 调用的符号工作，您仍然可以在自己的代码中使用该标识符，方法是将其包装在 onload-methods 中：

```
jQuery(function ($) {
    // Use jQuery with the standard $ sign in this scope,
    // even if it is assigned to prototype outside of this scope
    $('#id').whatYouWant();
}); 
```

# c++ - 使用 << 运算符的 ofstream 错误

> ID：15410891
> 
> 赞同：-1
> 
> 时间：2013-03-14T13:38:01.593
> 
> 标签：c++, file-io, ofstream

当我使用 ofstream 将双数组输出到 txt 文件时出现错误。这是代码：

```
static void OutpuResults(std::string fileName, double * yCal, int nPtCal)
{
    std::string value;
    double * yCal_local = yCal; 

    std::ofstream outfile;
    outfile.open(fileName.c_str());

    for (int i = 0; i < nPtCal; i++)
    {
        outfile<<yCal_local[i]<<std::endl;
    }

    delete[] yCal_local;
    outfile.close();    
} 
```

错误发生在`outfile<<yCal_local[i]<<std::endl;`i = 0 的地方，并且`yCal_local[i]`是 0.000000 作为双精度数。对我毫无意义。

这是文件名的定义：

```
std::string fileName = "d:\\inter.txt"; 
```

这里是 yCal 的定义：

```
int nPtCal = 256;
double * yCal = new double[nPtCal]; 
```

我想知道我哪里做错了？任何建议都值得赞赏。

编辑：编译时没有问题，但运行时出现错误。这是错误消息：

```
Unhandled exception at 0x75f5812f in ppppp.exe: Microsoft C++ exception: std::bad_alloc at memory location 0x0028f754.. 
```

这是程序从错误返回时显示的代码：

```
void __cdecl _unlock (
        int locknum
        )
{
        /*
         * leave the critical section.
         */
        LeaveCriticalSection( _locktable[locknum].lock );
} 
```

编辑：

这是所有代码：

```
#include "pppp.h"
#include <iostream>
#include <fstream>
#include <string>
#include <vector>

static void show_usage(std::string name)
{
    std::cerr << "To use ZoomCal:\n " << "ZoomCal.exe inputfile -options\n"
              << "options:\n"
              << " -l: linear\n"
              << " -c: cubic"<< std::endl;
}

static void LoadData(std::string fileName, double* y)
{
    std::string value;
    double * y_local = y;
    char *cstr = new char[fileName.length() + 1];
    std::strcpy(cstr, fileName.c_str());

    std::ifstream infile;

    infile.open(cstr);

    if (!infile.is_open())
    {
        std::cerr<<"File loading failed. Double check if file exists in the same folder as ZoomCal.exe"<<std::endl;
        exit(1);
    }

    int count = 0;
    int i = 0;
    int col = 10;
    while ( infile.good() )
    {
        getline ( infile, value, ',' ); // read a string until next comma: http://www.cplusplus.com/reference/string/getline/

        if (count % col == 0)
        {
            if (count != 0)
            {
                *y_local = std::atof(value.c_str());
                y_local++;
            }
        }
        count++;
    }

    //delete [] cstr;
    //delete y_local;
    infile.close();    
}

static void OutpuResults(std::string fileName, double * yCal, int nPtCal)
{
    std::string value;
    //double * yCal_local = yCal;   

    std::ofstream outfile;
    outfile.open(fileName.c_str());

    for (int i = 0; i < nPtCal; i++)
    {
        outfile<<yCal[i]<<std::endl;
    }

//  delete[] yCal_local;
    outfile.close();    
}

double * LinInterp(double * y, int nPt, int nPtCal)
{
    double * yCal = new double[nPtCal];
    double * tmp = new double[nPtCal-5];
    int interval = 10;
    double * pPiece = new double[interval];
    double f2, f1, m, b;
    int x2, x1;

    std::memset(yCal, 0, sizeof(double)*nPtCal);
    tmp += 6;

    for (int i = 0; i < (nPt - 1); i ++)
    {
        *pPiece = *y; 

        f2 = *(y + 1);
        f1 = *y;
        x2 = (i + 1) * interval;
        x1 = i * interval;

        m = (f2 - f1)/(x2 - x1);
        b = f2 - m * x2;

        for (int k = 1; k < interval; k++)
        {
            pPiece[k] = m * ((i * interval) + k) + b;
        }

        std::memcpy(tmp + (i * interval),  pPiece, sizeof(double)*interval);

        y++;
    }

    std::memcpy(yCal + 6,  tmp, sizeof(double)*250);

    return yCal;

}

double * CubInterp(double * y, int nPt, int nPtCal)
{

    double * yCal = new double[nPtCal];
    std::memset(yCal, 0, sizeof(double)*nPtCal);

    return yCal;
}

int main(int argc, char* argv[])
{
    if (argc < 3) 
    {
         show_usage(argv[0]);   
         return 1;
    }

    std::vector <std::string> sources;
    std::string destination;

    for (int i = 1; i < argc; ++i) 
    {
        std::string arg = argv[i];
        if ((arg == "-h") || (arg == "--help")) 
        {
            show_usage(argv[0]);
            return 0;
        } 
        else if ((arg == "-d") || (arg == "--destination")) 
        {
            if (i + 1 < argc) 
            { // Make sure we aren't at the end of argv!
                destination = argv[i++]; // Increment 'i' so we don't get the argument as the next argv[i].
            } 
            else 
            { // Uh-oh, there was no argument to the destination option.
                std::cerr << "--destination option requires one argument." << std::endl;
                return 1;
            }               
        }   
        else 
        {
             sources.push_back(argv[i]);
        }                            
    }

    int nPt = 26;
    double * y = new double[nPt];

    LoadData(sources[0], y);

    int nPtCal = 256;
    double * yCal = new double[nPtCal];

    yCal = LinInterp(y, nPt, nPtCal);

    std::string fileName = "D:\\inter.txt";
    OutpuResults(fileName, yCal, nPtCal);

    getchar();
    return 1;     
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:28:43.973

Ok finally I got where I did wrong:

```
tmp += 6; 
```

My program is to interpolate a array of 26 elements to 256 elements. But the first 6 elements of the interpolated array have to be 0; So I created a new array with length being 256-6 = 250;

```
double nPtCal = 256;
double * tmp = new double[nPtCal-5]; 
```

But somehow, I also moved this tmp pointer by 6\. I guess it would be right if I created an array with length being 256; So no surprisingly the error occurred. Because when the operation fills 256-6 = 250 elements, if the pointer already points to the 6th elements out of the total 250, then it will eventually be out of range because I will basically move the pointer 250 times to process all the 250 elements in the new array. That is why I kept getting error. I thought it was because some file IO, but now I think not. Thanks for all your help. Very appreciate it.

# visual-studio-2010 - Visual Studio 2010 代码自动展开

> ID：15410893
> 
> 赞同：0
> 
> 时间：2013-03-14T13:38:03.450
> 
> 标签：visual-studio-2010, fortran90

我在使用 VS 2010 时遇到了一个奇怪的问题。我正在使用 Fortran 90，并处理一些相当大的模块，每个模块都有许多子例程。为了保持井井有条，我想使用代码大纲功能使大多数子例程折叠（折叠，你有什么）。但是，当我开始输入时，整个文件有时会自动重新展开，导致我忘记输入的位置（光标通常不会在文档中移动，尽管重新展开时整个文档会移动）。似乎没有选项或资源与这个“未记录的功能”有关。有没有办法让代码大纲（折叠，你有什么）正常工作？我真的不想滚动浏览数千行代码，所以让它一直完全扩展并不是一个非常有吸引力的选择。

编辑：我知道用户控制的键盘快捷键。我的问题是程序自行重新扩展我的代码，而没有任何用户输入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T15:45:55.950

我偶尔需要对旧的 VB.NET 应用程序执行维护工作。为了让我的感官不至于不知所措，我使用了以下键盘快捷键，这样我一次只面对几个打开的方法。听起来这就是你所需要的。

*   `Ctrl`++将文件中的所有`M`内容`O`折叠为函数定义。
*   `Ctrl`++`M`切换`M`当前折叠区域的扩展。

# java - 将项目保留在 ArrayList 中

> ID：15410894
> 
> 赞同：0
> 
> 时间：2013-03-14T13:38:04.523
> 
> 标签：java, list, arraylist

我正在研究一个类，它是一个后端类的视图，需要显示一些后端类属性。

```
public abstract class AGenericNodeView{
    private ANode fObject;  
    private ArrayList<TInputView> fInputs = null;

    public AGenericNodeView(){
        super();
        this.fInputs = new ArrayList<TInputView>();
    }

    private void getInputs(){
        int num = fObject.getNumInputs(); //Number of inputs
        for (int i = 0; i < num; i++)
        {
            this.fInputs.add(new TInputView());
            this.fInputs.get(i).doSth();  
        }
        //fInputs has now the size num which is greater than 0\. 
    }    

   //later I call:
   public draw()
   {
      //...
      log(this.fInputs.size()); //output fInputs.size()
      // and it is 0\. Always. 
   }

} 
```

我想知道，是否有办法让我创建的对象保持`getInputs()`持久性，以便列表在需要时不为空`draw()`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:46:54.903

几个建议：

1.  使用调试器。

2.  登录`num`_`getInputs`

3.  登录`System.identityHashCode(fInputs)`并验证它们是否相同`getInputs`。`draw`

# ruby-on-rails - Rails/Ruby - 使用从另一个页面传递的数据预填充表单

> ID：15410895
> 
> 赞同：13
> 
> 时间：2013-03-14T13:38:08.000
> 
> 标签：ruby-on-rails, ruby

从部分页面`device`导航到新表单时，如何获取值以预填充新表单？ 有一个。`rfid``view/cabinet/show``device``rfid`

橱柜/节目的链接：

```
<%= link_to "Create New Device (non-functional)", new_device_path({:id => @rfid.id, cabinet_id: @cabinet.id}), :class => "btn btn-primary" %> 
```

，`devices_controller`我想让 create 方法在传递 0 或 2 个参数时工作：

```
def create(options)

if options[:cabinet_id] and options[:id]
  @rfid = Rfid.find(params[:id])
  @device = Device.new(params[:device])
  @device.rfid = @rfid
  @device.cabinet_id = :cabinet_id

else
  @device = Device.new(params[:device])
  @cabinet = Cabinet.find(params[:device][:cabinet_id])
  @device.row_id = @cabinet.row_id
end
  respond_to do |format|
    if @device.save and @cabinet.refresh_capacity_used and @cabinet.refresh_consumption
      format.html { redirect_to @device, notice: 'Device was successfully created.' }
      format.json { render json: @device, status: :created, location: @device }
    else
      format.html { render action: "new" }
      format.json { render json: @device.errors, status: :unprocessable_entity }
    end
  end 
```

结尾

new 的 cabinet_id 和 rfid 部分`device/_form`：

```
<tr>
        <th>Cabinet</th>
        <td><%= f.select :cabinet_id, options_from_collection_for_select(Cabinet.order(:name).all, "id", "name", @device.cabinet_id) %></td>
</tr>

<tr>
        <th>RFID</th>
        <td><%= f.text_field :rfid, :value => params[:rfid]%></td> 
</tr> 
```

谢谢你。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-14T15:58:02.310

如果你有：

```
<%= link_to "Create New Device (non-functional)", new_device_path({:id => @rfid.id, :cabinet_id => @cabinet.id}), :class => "btn btn-primary" %> 
```

您可以使用以下方法预填充`rfid`和`cabinet_id`字段：

```
<%= f.select :cabinet_id, options_from_collection_for_select(Cabinet.order(:name).all, "id", "name", params[:cabinet_id]) %>

<%= f.text_field :rfid, :value => params[:id] %> 
```

请注意，您的 params 键必须与传递到`link_to`标签中的哈希值相匹配。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-09-02T23:17:05.833

@zeantsoi 发布的答案大多有效，但它破坏了编辑功能。作为修复，我建议进行以下小修改：

```
<%= f.select :cabinet_id, options_from_collection_for_select(Cabinet.order(:name).all, "id", "name", params[:cabinet_id] || @device.cabinet_id) %>

<%= f.text_field :rfid, :value => params[:rfid] || @device.rfid %> 
```

这样，如果`params[:cabinet_id]`不存在，`@device.cabinet_id`（现有值）将持续​​存在。

# php - Php获取目录列表但如何获取最后修改日期

> ID：15410896
> 
> 赞同：2
> 
> 时间：2013-03-14T13:38:07.900
> 
> 标签：php, html, ftp

下面是我的 php 代码，它显示了我的目录中的文件列表以及文件大小

$myDirectory = opendir(".");

```
 // get each entry
        while($entryName = readdir($myDirectory)) {
            $dirArray[] = $entryName;
        }
        // close directory
        closedir($entryName);

        //  count elements in array
        $indexCount = count($dirArray);
        Print ("$indexCount files<br>\n");

        // sort 'em
        sort($dirArray);

        // print 'em
        print("<TABLE border=1 cellpadding=5 cellspacing=0 class=whitelinks>\n");
        print("<TR><TH>Filename</TH><th>Filetype</th><th>Filesize</th></TR>\n");
        // loop through the array of files and print them all
        for($index=0; $index < $indexCount; $index++) {
                if (substr("$dirArray[$index]", 0, 1) != "."){ // don't list hidden files
                print("<TR><TD><a href=\"$dirArray[$index]\">$dirArray[$index]</a></td>");
                print("<td>");
                print(filetype($dirArray[$index]));
                print("</td>");
                print("<td>");
                print(filesize($dirArray[$index]));
                print("</td>");
                print("</TR>\n");
            }
        }
        print("</TABLE>\n"); 
```

但是现在我需要编辑这段代码，以便我也可以获得“上次修改日期”，有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T14:01:31.030

您可以使用下面的代码获取特定文件夹中文件的修改日期

```
<?php
foreach (new DirectoryIterator('FOLDER_PATH') as $file) {
if($file->isDot()) continue;
    echo date('Y-m-d',filemtime($file->getPathName())) . '<br>';
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:38:53.873

查看 PHP 的`filemtime()`函数。看起来它可能正是您正在寻找的东西。

“该函数返回文件数据块被写入的时间，即文件内容发生变化的时间。”

请注意，时间将作为[UNIX Timestamp](http://en.wikipedia.org/wiki/Unix_timestamp)返回。

[更多信息可在此处获得。](http://php.net/manual/en/function.filemtime.php)

# excel - Excel VBA 中的循环是否比其他语言（如 C/C++）慢？

> ID：15410898
> 
> 赞同：0
> 
> 时间：2013-03-14T13:38:09.990
> 
> 标签：excel, vba

由于与读取和写入单元格相关的开销，我不是在谈论 Excel VBA 中的慢循环。我在说的是使用变量/数组在“内存中”循环。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T13:47:34.287

假设你有两个循环做大致相同的事情，C/C++*很可能*会更快，因为它将被编译为机器代码，而 VBA 具有 VBA 解释器和 Excel 本身的开销。如果您计划将*数据编组*到 C/C++ 以执行循环，则编组会产生一些开销；多少取决于你如何选择这样做。

但是，不要仅仅因为*循环更快*而选择平台，选择适合解决方案并使您最高效的平台。

根据我的经验，慢的不是*循环*，而是循环*内部*的慢。正如您可能已经发现的那样，在 excel 中逐个单元格的访问比直接数组访问要慢得多。

如果您需要知道*速度有多快*，请测量它！在 C 或 C++ 中创建一个简单的 VBA 循环和一个等效循环（或尽可能接近），看看哪个更快（以及多少）。

# asp.net-mvc-4 - Kendo UI 网格工具栏模板下拉错误

> ID：15410900
> 
> 赞同：1
> 
> 时间：2013-03-14T13:38:10.703
> 
> 标签：asp.net-mvc-4, kendo-grid

[参考](https://stackoverflow.com/questions/15357182/kendo-ui-grid-toolbar-template-dropdown-selector-error-textbox-instead-of-dropd) [1参考2](http://demos.kendoui.com/web/grid/toolbar-template.html)

在进入此阶段之前，我遇到了一些其他问题，这些问题在 Referencea 链接中有详细说明，无论如何主要问题是在最终获得下拉列表（Reference2）以显示它之后，不幸的是实际上并没有连接到应该的控制器操作填写没有明显的答案为什么。

似乎表明任何事情的唯一错误是：- TypeError: r is undefined kendo.web.min.js 第 13 行

我用于下拉列表的当前代码是：-

```
<script type="text/x-kendo-template" id="template">
    <div class="toolbar">
        <label class="category-label" for="external">Show patients by ex:</label>
        <input type="search" id="external" style="width: 230px"></input>
    </div>
</script>

var dropDown = grid.find("#external").kendoDropDownList({
            dataTextField: "ExName",
            dataValueField: "ExId",
            autoBind: false,
            optionLabel: "All",
            dataSource: {
                type: "json",
                severFiltering: true,
                transport: {
                    url: '@Url.Action("_Ex", "Entry")',
                    data: { ignore: Math.random() }
                }
            },
            change: function () {
                var value = this.value();
                if (value) {
                    grid.data("kendoGrid").dataSource.filter({ field: "ExId", operator: "eq", value: parseString(value) });
                } else {
                    grid.data("kendoGrid").dataSource.filter({});
                }
            }
        });

<style scoped="scoped">
    #grid .k-toolbar
    {
        min-height: 27px;
    }
    .external-label
    {
        vertical-align: middle;
        padding-right: .5em;
    }
    #external
    {
        vertical-align: middle;
    }
    .toolbar {
        float: right;
        margin-right: .8em;
    }
</style> 
```

我知道控制器动作有效，并不是因为 1 它甚至没有被调用，而是因为我在另一个页面上使用它，而是作为层次结构网格中的主网格。

对此的想法或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T14:14:07.147

组合框上数据源的传输配置不正确。该属性的唯一有效值`type`是“odata”，而您指定“json”。如果要指定数据源传输返回 json，则需要像这样配置数据源：

```
 dataSource: {
      serverFiltering: true,
      transport: {                    
          read: {
              url: '@Url.Action("_Ex", "Entry")',
              dataType: 'json'
          }
      },
 } 
```

dataType 属性指定您期望从服务器返回的数据类型。

url 属性指定远程数据的 URI。

[您可以在此处](http://docs.kendoui.com/api/framework/datasource)找到有关数据源 API 的综合文档。

# .net - TextBox - 仅允许数字和一个句号（表示十进制数）VB.NET

> ID：15410903
> 
> 赞同：2
> 
> 时间：2013-03-14T13:38:17.913
> 
> 标签：.net, vb.net, winforms, visual-studio-2010

我有以下代码，并希望添加一个事实，它只能允许在字符串中的任何位置添加一个小数点（句号）。

```
If Asc(e.KeyChar) <> 8 Then
    If Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
        e.Handled = True
    End If
End If 
```

它只接受数字，那么我怎样才能在这段代码中加入一个小数点呢？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T14:58:38.870

该`Asc`函数是一个旧的 VB6 函数，在编写新的 .NET 代码时应避免使用该函数。在这种情况下，您可以比较字符以查看它是否在某个范围内，如下所示：

```
If e.KeyChar <> ControlChars.Back Then
    If (e.KeyChar < "0"c) Or (e.KeyChar > "9"c) Then
        e.Handled = True
    End If
End If 
```

但是，我建议简单地列出有效字符，如下所示：

```
e.Handled = ("0123456789.".IndexOf(e.KeyChar) = -1) 
```

至于检查多个小数点，您可以在按键事件中执行某些操作，如下所示：

```
If e.KeyChar = "."c Then
    e.Handled = (CType(sender, TextBox).Text.IndexOf("."c) <> -1)
ElseIf e.KeyChar <> ControlChars.Back Then
    e.Handled = ("0123456789".IndexOf(e.KeyChar) = -1)
End If 
```

然而，虽然能够过滤掉无效的击键是件好事，但这样做存在很多问题。例如，即使进行了所有这些检查，仍然允许以下条目，即使它们很可能都应该是无效的：

*   12.
*   0000
*   0001。

另一个大问题是您的代码将依赖于文化。例如，在欧洲，通常使用逗号作为小数点。出于这些原因，如果可能，我建议`Decimal.TryParse`在`Validating`事件中简单地使用，如下所示：

```
Private Sub TextBox1_Validating(sender As Object, e As CancelEventArgs) Handles TextBox1.Validating
    Dim control As TextBox = CType(sender, TextBox)
    Dim result As Decimal = 0
    Decimal.TryParse(control.Text, result)
    control.Text = result.ToString()
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T13:49:54.793

解析字符串（TextBox 的文本或其他）以查看它是否已包含小数点。如果是这种情况，请不要处理按键：

**VB.NET：**

```
Private Sub TextBox1_KeyPress(ByVal sender As System.Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles TextBox1.KeyPress
    Dim FullStop As Char
    FullStop = "."

    ' if the '.' key was pressed see if there already is a '.' in the string
    ' if so, dont handle the keypress
    If e.KeyChar = FullStop And TextBox1.Text.IndexOf(FullStop) <> -1 Then
        e.Handled = True
        Return
    End If

    ' If the key aint a digit
    If Not Char.IsDigit(e.KeyChar) Then
        ' verify whether special keys were pressed
        ' (i.e. all allowed non digit keys - in this example
        ' only space and the '.' are validated)
        If (e.KeyChar <> FullStop) And
           (e.KeyChar <> Convert.ToChar(Keys.Back)) Then
            ' if its a non-allowed key, dont handle the keypress
            e.Handled = True
            Return
        End If
    End If

End Sub 
```

**C＃：**

```
private void textBox1_KeyPress(object sender, KeyPressEventArgs e)
{
    if ((e.KeyChar == '.') && (((TextBox)sender).Text.IndexOf('.') > -1))
    {
        e.Handled = true;
        return;
    }

    if (!Char.IsDigit(e.KeyChar))
    {
        if ((e.KeyChar != '.') &&
            (e.KeyChar != Convert.ToChar(Keys.Back)))
        {
            e.Handled = true;
            return;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T13:43:09.510

使用正则表达式怎么样？

这将验证十进制数或整数：

**VB**

```
If New Regex("^[\-]?\d+([\.]?\d+)?$").IsMatch(testString) Then
    'valid
End If 
```

**C＃**

```
if (new Regex(@"^[\-]?\d+([\.]?\d+)?$").IsMatch(testString))
{
    //valid
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T14:24:44.523

有点绕。看起来以确保您刚刚按下的字符是小数或小数，并且没有以前的小数。

```
Private Sub TextBox1_KeyPress(sender As Object, e As KeyPressEventArgs) Handles TextBox1.KeyPress
    If Char.IsDigit(e.KeyChar) Or (Asc(e.KeyChar) = Asc(".")) And Me.TextBox1.Text.Count(Function(c As Char) c = ".") = 0 Then e.Handled = False Else e.Handled = True
End Sub 
```

# objective-c - 为什么大写的属性名称在 Objective-C / UITouch 中没有给出错误？

> ID：15410905
> 
> 赞同：3
> 
> 时间：2013-03-14T13:38:21.247
> 
> 标签：objective-c, properties, capitalization

`resultLabel`是一个`UILabel`。那为什么

```
 resultLabel.Text= @""; 
```

不报错？应该是`resultLabel.text`。

感谢您的任何见解。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-14T14:06:06.323

属性的默认设置函数`foo`是`setFoo:`，首字母大写。因此两条线

```
resultLabel.text = @"";
resultLabel.Text = @""; 
```

生成相同的代码

```
[resultLabel setText:@""]; 
```

这仅适用于 setter 函数，不适用于 getter：

```
NSString *x = self.text; // --> x = [self text]
NSString *x = self.Text; // --> x = [self Text] 
```

因此，您不能有两个仅在第一个字母的情况下不同的读写属性，这将产生编译器错误：

```
@property (nonatomic, strong) NSString *text;
@property (nonatomic, strong) NSString *Text;

self.text = @"foo";
// error: synthesized properties 'text' and 'Text' both claim setter 'setText:' 
```

# android - 为什么带有自定义适配器的列表视图有时会表现得很奇怪？

> ID：15410906
> 
> 赞同：1
> 
> 时间：2013-03-14T13:38:24.073
> 
> 标签：android, listview

*   [复选框问题](https://stackoverflow.com/questions/15187795/checkbox-issue-in-list-view-with-different-layout-for-rows)
*   [编辑文本问题](https://stackoverflow.com/questions/15408464/how-to-implement-listener-text-changes-in-custom-listview-with-edittexts)
*   [按钮问题](https://stackoverflow.com/questions/14638717/dynamic-change-on-listview-row-layout-affects-other-rows-too)

我已经多次遇到这个问题，通过快速搜索很容易找到许多类似的问题。有时 ListView 行布局上的动态更改也会影响其他行，有时则不会。

作为这个问题的解决方案，我通常会跟踪列表中的整个项目集，每次我有更改时，我都会重置列表中的所有项目。

例如：如果我有一个带有 TextViews 和复选框的列表，我必须保留一个布尔数组，指示每个复选框的状态，并在我的 getView() 覆盖上重置基于该数组的所有复选框。

这是预期的吗？我可以找到有关此问题的几个问题，并且所有解决方案似乎都与我的相似。

现在我面临一个问题，我需要在一个非常长的列表中一次跟踪多个项目（背景、复选框和文本）。我想知道这个问题是否有其他方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T14:08:13.337

这是 Android 中 ListViews 的预期行为。您使用基础数据填充列表中的视图的方法是正确的。

在创建 ListView 时，Android 使用了一种称为 View Recycling 的技术，因为与使用数据填充视图相比，膨胀视图是一项密集操作。Android 通过仅创建用户在屏幕上看到的视图来将通货膨胀降至最低（在程序员的帮助下）。当用户向上滚动列表时，移出屏幕的视图被放置在一个池中，以供即将显示的新项目重用。来自该池的视图`getView`作为第二个参数传递给。此视图将保留从列表中弹出时的确切状态，因此由 getView 方法清除任何旧数据的状态，并根据基础数据中的新状态重新填充它。`getView()`这是一个实现应该具有的结构示例：

```
@Override
public View getView (int position, View convertView, ViewGroup parent)
{
    //The programmer has two responsibilities in this method.

    //The first is to inflate the view, if it hasn't been
    //convertView will contain a view from the aforementioned pool, 
    //    but when first creating the list, the pool is empty and convertView will be null
    if(convertView == null)
    {
        //If convertView is null, inflate it, something like this....
        convertView = layoutInflator.inflate(R.layout.mylistview, null);
    } 

    //If convertView was not null, it has previously been inflated by this method

    //Now, you can use the position argument to find this view's data and populate it
    //It is important in this step to reset the entire state of the view.
    //If the view that was popped off the list had a checked CheckBox, 
    //    it will still be selected, EditTexts will not be cleared, etc.

    //Finally, once that configuration is done, return convertView
    return convertView;
} 
```

Adapter 类中还有许多其他方法可以帮助管理您的列表，并允许您利用视图回收做一些巧妙的事情，例如`getItem()`管理您的基础数据和`getViewType()`具有`getViewTypeCount()`多种视图类型的列表，但以上是基本的技术和您的视图顺利运行所需的最低要求。

听起来你走在正确的轨道上，我希望这有助于回答你的一些问题。如果有任何不清楚的地方，请告诉我您需要更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T13:43:31.450

你做对了。在 Android 中，您应该跟踪每个单独列表项的状态。当`getView`被调用时，您可以选择重用或为该行创建新视图。通过跟踪项目的状态（文本、已检查、背景等），您可以轻松地重置已经存在的视图。**跟踪详细状态将帮助您确保没有其他行受到一行更改的影响**

当您调用时`adapter.notifyDataSetChanged()`，唯一重绘的项目是屏幕上的项目（或非常接近屏幕上的项目）。

# c# - ASP.NET 网页中的间歇性无效视图状态错误

> ID：15410910
> 
> 赞同：7
> 
> 时间：2013-03-14T13:38:33.967
> 
> 标签：c#, asp.net

故事：

我正在开发一个图表，显示假期（年假、已用假期”等），用于从组合框中选择一年、业务单位和部门，到目前为止，我很高兴它的工作结果...但是如果在一段时间后在这个部门之间切换我会得到这个奇怪的错误...... ***

> 此页面的状态信息无效，可能已损坏。
> 
> [没有相关的源代码行]

* * *

所以我向下滚动了一点，发现了这个

> ```
> [ViewStateException: Invalid viewstate. 
>   Client IP: ::1
>   Port: 27968
>   Referer: http://localhost/HolidayTracker/Report/VacationChart.aspx
>   Path: /HolidayTracker/Report/VacationChart.aspx
>   User-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; WOW64; Trident/6.0)
>   ViewState: .... 
> ```

所以我检查了我的视图状态，我没有发现错误或其他什么..

```
 private HtBusinessUnit selectedBU
    {
        get
        {
            return (HtBusinessUnit)ViewState["selectedBu"];

        }
        set
        {
            ViewState["selectedBu"] = value;
        }
    }
    private HtDepartment selectDep
    {
        get
        {
            return (HtDepartment)ViewState["selectedDep"];
        }
        set
        {
            ViewState["selectedDep"] = value;
        }
    }
    private string selectedYear
    {
        get
        {
            return ViewState["selectedYear"] != null ? ViewState["selectedYear"].ToString() : "";
        }
        set
        {
            ViewState["selectedYear"] = value;
        }
    } 
```

这是错误消息

```
[ArgumentException: Invalid token for impersonation - it cannot be duplicated.]
   System.Security.Principal.WindowsIdentity.CreateFromToken(IntPtr userToken) +3597947
   System.Security.Principal.WindowsIdentity..ctor(SerializationInfo info) +187
   System.Security.Principal.WindowsIdentity..ctor(SerializationInfo info, StreamingContext context) +51

[TargetInvocationException: Exception has been thrown by the target of an invocation.]
   System.RuntimeMethodHandle.SerializationInvoke(IRuntimeMethodInfo method, Object target, SerializationInfo info, StreamingContext& context) +0
   System.Runtime.Serialization.ObjectManager.CompleteISerializableObject(Object obj, SerializationInfo info, StreamingContext context) +298
   System.Runtime.Serialization.ObjectManager.FixupSpecialObject(ObjectHolder holder) +45
   System.Runtime.Serialization.ObjectManager.DoFixups() +230
   System.Runtime.Serialization.Formatters.Binary.ObjectReader.Deserialize(HeaderHandler handler, __BinaryParser serParser, Boolean fCheck, Boolean isCrossAppDomain, IMethodCallMessage methodCallMessage) +137
   System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Deserialize(Stream serializationStream, HeaderHandler handler, Boolean fCheck, Boolean isCrossAppDomain, IMethodCallMessage methodCallMessage) +186
   System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Deserialize(Stream serializationStream) +15
   System.Web.UI.ObjectStateFormatter.DeserializeValue(SerializerBinaryReader reader) +1873
   System.Web.UI.ObjectStateFormatter.DeserializeValue(SerializerBinaryReader reader) +334
   System.Web.UI.ObjectStateFormatter.DeserializeValue(SerializerBinaryReader reader) +420
   System.Web.UI.ObjectStateFormatter.DeserializeValue(SerializerBinaryReader reader) +432
   System.Web.UI.ObjectStateFormatter.DeserializeValue(SerializerBinaryReader reader) +420
   System.Web.UI.ObjectStateFormatter.Deserialize(Stream inputStream) +139

[ArgumentException: The serialized data is invalid.]
   System.Web.UI.ObjectStateFormatter.Deserialize(Stream inputStream) +203
   System.Web.UI.ObjectStateFormatter.Deserialize(String inputString, Purpose purpose) +481
   System.Web.UI.ObjectStateFormatter.System.Web.UI.IStateFormatter2.Deserialize(String serializedState, Purpose purpose) +8
   System.Web.UI.Util.DeserializeWithAssert(IStateFormatter2 formatter, String serializedState, Purpose purpose) +40
   System.Web.UI.HiddenFieldPageStatePersister.Load() +127

[ViewStateException: Invalid viewstate. 
    Client IP: ::1
    Port: 27795
    Referer: http://localhost/HolidayTracker/Report/VacationChart.aspx
    Path: /HolidayTracker/Report/VacationChart.aspx
    User-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; WOW64; Trident/6.0)
    ViewState: /wEPDwULLTE2OTYyMjA5MzkPFgQeCnNlbGVjdGVkQnUy1p4BAAEAAAD/////AQAAAAAAAAAMAgAAAElIb2xpZGF5VHJhY2tlckRhdGEsIFZlcnNpb249MS4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsDAMAAABVU3lzdGVtLkRhdGEuRW50aXR5LCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OQUBAAAAKEhvbGlkYXlUcmFja2VyLkRhdGEuTW9kZWwuSHRCdXNpbmVzc1VuaXQFAAAAD19CdXNpbmVzc1VuaXRJZAVfTmFtZQ9fT3JnYW5pc2F0aW9uSWQbRW50aXR5T2JqZWN0K19yZWxhdGlvbnNoaXBzF0VudGl0eU9iamVjdCtfZW50aXR5S2V5AAEABAQICDNTeXN0ZW0uRGF0YS5PYmplY3RzLkRhdGFDbGFzc2VzLlJlbGF0aW9uc2hpcE1hbmFnZXIDAAAAFVN5c3RlbS5EYXRhLkVudGl0eUtleQMAAAACAAAAFAAAAAYEAAAABUZTLUlTDgAAAAkFAAAACQYAAAAFBQAAADNTeXN0ZW0uRGF0YS5PYmplY3RzLkRhdGFDbGFzc2VzLlJlbGF0aW9uc2hpcE1hbmFnZXICAAAABl9vd25lcg5fcmVsYXRpb25zaGlwcwQDKEhvbGlkYXl...]

[HttpException (0x80004005): The state information is invalid for this page and might be corrupted.]
   System.Web.UI.ViewStateException.ThrowError(Exception inner, String persistedState, String errorPageMessage, Boolean macValidationError) +198
   System.Web.UI.HiddenFieldPageStatePersister.Load() +266
   System.Web.UI.Page.LoadPageStateFromPersistenceMedium() +88
   System.Web.UI.Page.LoadAllState() +36
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +6704
   System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +245
   System.Web.UI.Page.ProcessRequest() +72
   System.Web.UI.Page.ProcessRequestWithNoAssert(HttpContext context) +21
   System.Web.UI.Page.ProcessRequest(HttpContext context) +58
   ASP.report_vacationchart_aspx.ProcessRequest(HttpContext context) in c:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\holidaytracker\ad68c354\56d80455\App_Web_k5s5ajkf.1.cs:0
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +341
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +69 
```

这是我的 Global.asax.cs

```
namespace HolidayTracker {
    public class Global : System.Web.HttpApplication {

        void Application_Start(object sender, EventArgs e) {
            // Code that runs on application startup

        }

        void Application_End(object sender, EventArgs e) {
            //  Code that runs on application shutdown

        }

        void Application_Error(object sender, EventArgs e) {
            // Code that runs when an unhandled error occurs

        }

        void Session_Start(object sender, EventArgs e) {
            // Code that runs when a new session is started
            if (HttpContext.Current.User != null && HttpContext.Current.User is HtUser)
            { 
                HtUser user = (HtUser)HttpContext.Current.User;
                Session["UserId"] = user.UserId;

                Session["User"] = user.LastName+" "+user.FirstName ;

                if (user.HtDepartments.Any() && user.HtDepartments.SingleOrDefault().HtBusinessUnit != null)
                {
                    int BusinessUnitId = user.HtDepartments.First().HtBusinessUnit.BusinessUnitId;
                    Session["BusinessUnnitId"] = BusinessUnitId;
                }

            }
        }

        void Session_End(object sender, EventArgs e) {
            // Code that runs when a session ends. 
            // Note: The Session_End event is raised only when the sessionstate mode
            // is set to InProc in the Web.config file. If session mode is set to StateServer 
            // or SQLServer, the event is not raised.

            //if (Session["UserId"] == null)
            //{
            //    Response.ClearContent();
            //    Response.Write("Not agine");
            //    Response.End();
            //}
            //else
            //{
            //    Response.Write(Session["UserId"].ToString());
            //}
        }

         protected void WindowsAuthentication_OnAuthenticate(Object source, WindowsAuthenticationEventArgs e)
        {
            if (Request.Cookies.Get(Constants.AUTHORIZATION_COOKIE_NAME) != null)
                return;

            String strUserIdentity;
            FormsAuthenticationTicket formsAuthTicket;
            HttpCookie httpCook;
            String strEncryptedTicket;
            AdLookup adLookup = new AdLookup();

            strUserIdentity = e.Identity.Name;

            bool loggedIn = false;
            String email = null;
            String role = null;

            email = strUserIdentity; 
            HtUser userInfo = null;
            if (email != null && email != "")
            {
                userInfo = HtUser.GetByLogin(e.Identity, email);

                if (userInfo != null && userInfo.UserName.Length > 0)
                {
                    loggedIn = true;
                    role = HtUser.GetUserRoleString(userInfo);
                }
                //Checks if user is in domain
                else
                {
                    userInfo = adLookup.GetAdUserByUsername(HtUser.getUserNameFromDomainString(email));
                    if (userInfo != null && userInfo.UserName.Length > 0)
                    {
                        loggedIn = true;
                        role = UserRoles.User;
                    }
                }
            }
            //}

            if (loggedIn)
            {
                formsAuthTicket = new FormsAuthenticationTicket(1, email, DateTime.Now,
                                                                DateTime.Now.AddMinutes(60), false, role);
                strEncryptedTicket = FormsAuthentication.Encrypt(formsAuthTicket);
                httpCook = new HttpCookie(Constants.AUTHORIZATION_COOKIE_NAME, strEncryptedTicket);
                Response.Cookies.Add(httpCook);
                HttpContext.Current.User = userInfo;
            }
            else
            {
                HttpContext.Current.User = null;
            }
        }

    }
} 
```

我你需要更多的东西随时问我！

感谢您的帮助和快速答复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:37:40.307

Oo I see it not something big but I would you highly recommend to replace your view states with just a "normal" solution just use the values from your Rad Combo boxes its way easier but for sure this is not a real solution for you problem cause as I see its really strange I don't see the error here , for me it seems all to me Ok. but if send you your updated code back with some comments .

If you have and problems feel free to ask!¨

PS: If you wind the solution give contact me!!

# jakarta-ee - tomcat：部署：“无法调用 Tomcat 管理器：连接被拒绝”

> ID：15410914
> 
> 赞同：37
> 
> 时间：2013-03-14T13:38:44.887
> 
> 标签：jakarta-ee, maven, tomcat, maven-tomcat-plugin

我尝试使用 Maven 将我的应用程序部署到 Tomcat，并且我找到[了这个](http://www.mkyong.com/maven/how-to-deploy-maven-based-war-file-to-tomcat/)示例。

那是我的 pom.xml 的片段：

```
 <!-- Maven Tomcat Plugin -->
    <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>tomcat-maven-plugin</artifactId>
        <configuration>
            <url>http://127.0.0.1:8080/</url>
            <server>TomcatServer</server>
        </configuration>
    </plugin>
    <!-- Maven compiler plugin -->
    <plugin>
        <artifactId>maven-compiler-plugin</artifactId>
        <configuration>
            <source>1.6</source>
            <target>1.6</target>
        </configuration>
    </plugin> 
```

当我运行时，`tomcat:deploy`我得到这个错误：`Cannot invoke Tomcat manager: Connection refused`。这是完整的堆栈跟踪：

```
[ERROR] Failed to execute goal org.codehaus.mojo:tomcat-maven-plugin:1.1:deploy (default-cli) on project webapp: Cannot invoke Tomcat manager: Connection refused: connect -> [Help 1]
org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.codehaus.mojo:tomcat-maven-plugin:1.1:deploy (default-cli) on project webapp: Cannot invoke Tomcat manager
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:217)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
    at org.codehaus.classworlds.Launcher.main(Launcher.java:47)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120)
Caused by: org.apache.maven.plugin.MojoExecutionException: Cannot invoke Tomcat manager
    at org.codehaus.mojo.tomcat.AbstractCatalinaMojo.execute(AbstractCatalinaMojo.java:149)
    at org.codehaus.mojo.tomcat.AbstractWarCatalinaMojo.execute(AbstractWarCatalinaMojo.java:70)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
    ... 25 more
Caused by: java.net.ConnectException: Connection refused: connect
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:351)
    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:213)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:200)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)
    at java.net.Socket.connect(Socket.java:529)
    at java.net.Socket.connect(Socket.java:478)
    at sun.net.NetworkClient.doConnect(NetworkClient.java:163)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:388)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:523)
    at sun.net.www.http.HttpClient.<init>(HttpClient.java:227)
    at sun.net.www.http.HttpClient.New(HttpClient.java:300)
    at sun.net.www.http.HttpClient.New(HttpClient.java:317)
    at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:970)
    at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:911)
    at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:836)
    at org.codehaus.mojo.tomcat.TomcatManager.invoke(TomcatManager.java:597)
    at org.codehaus.mojo.tomcat.TomcatManager.deployImpl(TomcatManager.java:662)
    at org.codehaus.mojo.tomcat.TomcatManager.deploy(TomcatManager.java:295)
    at org.codehaus.mojo.tomcat.AbstractDeployWarMojo.deployWar(AbstractDeployWarMojo.java:85)
    at org.codehaus.mojo.tomcat.AbstractDeployMojo.invokeManager(AbstractDeployMojo.java:85)
    at org.codehaus.mojo.tomcat.AbstractCatalinaMojo.execute(AbstractCatalinaMojo.java:141)
    ... 28 more 
```

我不想使用身份验证，所以我只是跳过了这些步骤。我认为这可能会导致我的错误，但是当我尝试添加它们时，没有任何改变。你知道我的错在哪里吗？

**UPD：**抱歉，我无法检查我们的解决方案，因为我不再从事这个项目了。但是我不会关闭这个问题，所以如果您认为您的解决方案可以工作，请随时将其留在这里，并且可能会对某人有所帮助。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2014-03-05T02:43:26.507

使用 tomcat 7 插件时，请执行以下操作：

pom.xml

```
<plugin>
    <groupId>org.apache.tomcat.maven</groupId>
    <artifactId>tomcat7-maven-plugin</artifactId>
    <version>2.2</version>
    <configuration>
        <url>http://localhost:8080/manager/text</url>
        <server>tomcatserver</server>
        <path>/mycontext</path>
        <username>admin</username>
        <password>admin</password>
    </configuration>
</plugin> 
```

设置.xml

```
<server>
    <id>tomcatserver</id>
    <username>admin</username>
    <password>admin</password>
</server> 
```

tomcat-users.xml

```
<user username="admin" password="admin" roles="manager-script"/> 
```

跑

```
mvn tomcat7:deploy 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-01-25T11:38:42.893

我有同样的问题。在我的情况下，我使用 run`run-war`而不是`deploy`配置 Tomcat7 来修复它：

```
 <plugin>
            <groupId>org.apache.tomcat.maven</groupId>
            <artifactId>tomcat7-maven-plugin</artifactId>
            <version>2.2</version>
            <configuration>
                <url>http://localhost:8080</url>
                <path>/</path>
            </configuration>
        </plugin> 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-11-17T18:45:54.660

**用Tomcat 7**机制理解 maven 插件部署需要一段时间，但它的工作原理如下：

与命令一起使用：

**mvn tomcat7：部署**

> > 必须先初始化Tomcat服务器！您可以选择从 IDE 启动或在位于文件夹 %TOMCAT_HOME%\bin 的启动脚本中启动

运行它的输出应该如下所示： [![在此处输入图像描述](../Images/10bc1ef4fd2c757e641326c00e4c7662.png)](https://i.stack.imgur.com/aFet4.png)

**mvn tomcat7:run-war**

> > Tomcat 不需要初始化，因为上面的脚本会自动启动服务器。但是，将不会启用上下文**/manager以在浏览器中使用。**

运行它的输出应该如下所示： [![在此处输入图像描述](../Images/f5561c3a9532d838ad97e684d3d0d170.png)](https://i.stack.imgur.com/Vrz7v.png)

您甚至可以运行命令**mvn clean package**来执行项目的先前清理。

一些额外的配置：

**[%TOMCAT_HOME%\conf] tomcat-users.xml**

```
<role rolename="tomcat"/>
<role rolename="admin-script"/>
<role rolename="manager-script"/>
<role rolename="manager-gui"/>
<role rolename="manager-jmx"/>
<role rolename="manager-status"/>
<role rolename="manager"/>
<role rolename="admin"/>

<user password="tomcat" roles="tomcat" username="tomcat"/>
<user password="admin" roles="manager-gui" username="admin"/>
<user password="pass@word1" roles="admin,admin-script,manager-gui,manager-script,manager-jmx,manager-status" username="mavenuser"/> 
```

**[%MAVEN_HOME%\conf] 设置.xml**

```
<server>
    <id>your_server</id>
    <username>mavenuser</username>
    <password>pass@word1</password>
</server> 
```

**[%project%] pom.xml**

```
<plugin>
    <groupId>org.apache.tomcat.maven</groupId>
    <artifactId>tomcat7-maven-plugin</artifactId>
    <version>2.2</version>
    <configuration>
        <url>http://localhost:8080/manager/text</url>
        <server>your_server</server>
        <path>/project_context</path>
        <username>mavenuser</username>
        <password>pass@word1</password>                 
    </configuration>
</plugin> 
```

希望能帮助到你！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-10-10T13:28:58.403

我遇到了同样的问题，它似乎是 Tomcat 版本与 Maven 插件版本。我使用了 tomcat 7 并尝试使用`tomcat:deploy-only`而不是`tomcat7:deploy`仅进行部署。如果这是您的情况，请尝试`tomcat7:deploy-xxx`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-28T16:06:02.480

我认为这里很重要的一点是，您应该使用 tomcat **7** :deploy。不要小看**7**。

我使用的是自动完成，总是以 tomcat:deploy 结束，只是盲目地忽略了小 7。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-01T11:17:09.553

我遇到了类似的问题：

```
Caused by: org.apache.maven.plugin.MojoExecutionException: Cannot invoke Tomcat manager
    at org.apache.tomcat.maven.plugin.tomcat7.AbstractCatalinaMojo.execute(AbstractCatalinaMojo.java:141)
    at org.apache.tomcat.maven.plugin.tomcat7.AbstractWarCatalinaMojo.execute(AbstractWarCatalinaMojo.java:68)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:134)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:208)
    ... 20 more
Caused by: java.net.SocketException: Connection reset
    at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:115)
    at java.net.SocketOutputStream.write(SocketOutputStream.java:155)
    at org.apache.http.impl.io.AbstractSessionOutputBuffer.write(AbstractSessionOutputBuffer.java:181)
    at org.apache.http.impl.conn.LoggingSessionOutputBuffer.write(LoggingSessionOutputBuffer.java:73)
    at org.apache.http.impl.io.ContentLengthOutputStream.write(ContentLengthOutputStream.java:115)
    at org.apache.tomcat.maven.common.deployer.TomcatManager$RequestEntityImplementation.writeTo(TomcatManager.java:880)
    at org.apache.http.entity.HttpEntityWrapper.writeTo(HttpEntityWrapper.java:89)
    at org.apache.http.impl.client.EntityEnclosingRequestWrapper$EntityWrapper.writeTo(EntityEnclosingRequestWrapper.java:108)
    at org.apache.http.impl.entity.EntitySerializer.serialize(EntitySerializer.java:117)
    at org.apache.http.impl.AbstractHttpClientConnection.sendRequestEntity(AbstractHttpClientConnection.java:265)
    at org.apache.http.impl.conn.ManagedClientConnectionImpl.sendRequestEntity(ManagedClientConnectionImpl.java:203)
    at org.apache.http.protocol.HttpRequestExecutor.doSendRequest(HttpRequestExecutor.java:236)
    at org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:121)
    at org.apache.http.impl.client.DefaultRequestDirector.tryExecute(DefaultRequestDirector.java:682)
    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:486)
    at org.apache.http.impl.client.AbstractHttpClient.doExecute(AbstractHttpClient.java:863)
    at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:82)
    at org.apache.tomcat.maven.common.deployer.TomcatManager.invoke(TomcatManager.java:742)
    at org.apache.tomcat.maven.common.deployer.TomcatManager.deployImpl(TomcatManager.java:705)
    at org.apache.tomcat.maven.common.deployer.TomcatManager.deploy(TomcatManager.java:388)
    at org.apache.tomcat.maven.plugin.tomcat7.deploy.AbstractDeployWarMojo.deployWar(AbstractDeployWarMojo.java:85)
    at org.apache.tomcat.maven.plugin.tomcat7.deploy.AbstractDeployMojo.invokeManager(AbstractDeployMojo.java:82)
    at org.apache.tomcat.maven.plugin.tomcat7.AbstractCatalinaMojo.execute(AbstractCatalinaMojo.java:132)
    ... 23 more 
```

我查看了tomcat(dir:)的日志，`log/localhost_access.xxx`发现maven上传`.wawr`文件到tomcat时，响应的http状态码是`403`，表示访问被禁止。

然后我检查了`manager`and`host`应用程序是否具有相同的 dir: `META-INF`。在这个目录中，我找到了文件`context.xml`，这个文件限制了`manager`和`host`app的访问。关键文本如下：

```
<Context antiResourceLocking="false" privileged="true" >
  <Valve className="org.apache.catalina.valves.RemoteAddrValve"
         allow="127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1" />
  <Manager sessionAttributeValueClassNameFilter="java\.lang\.(?:Boolean|Integer|Long|Number|String)|org\.apache\.catalina\.filters\.CsrfPreventionFilter\$LruCache(?:\$1)?|java\.util\.(?:Linked)?HashMap"/>
</Context> 
```

修改属性`allow`让你的ip访问`manager`和`host`app，问题就解决了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-22T16:21:34.010

因此，当我使用 mvn tomcat7:deploy 时，尽管一切都已正确配置，但我遇到了这个问题。

问题是在部署之前我必须取消部署，即 mvn tomcat7:undeploy，然后是 tomcat7:deploy。

哎呀！这是一个如此疯狂的错误。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-03-15T10:46:11.053

如果问题是因为 Java 堆空间。如果它是作为服务安装的，那么您可以使用以下步骤更改它：

1- 从 cmd "Tomcat_DIR\tomcat6w.exe" //ES//ServiceName 运行

2-它将打开tomcat GUI。在 JAVA 菜单中，给出内存池配置。

将为 Tomcat 保留那么多内存。它应该可以解决您的内存堆问题。

# .net - MSDTC 异常

> ID：15410918
> 
> 赞同：7
> 
> 时间：2013-03-14T13:39:01.560
> 
> 标签：.net, sql-server, msdtc

我曾经在我的应用程序中遇到以下异常，

> 无法从服务器获取服务器的分布式事务协调器的地址。服务器上是否启用了 DTC？

现在我需要捕获并处理异常，但无法重现异常。任何人都可以向我提供有关如何重现异常或提供异常类型/错误代码的输入。

由于我没有获得异常日志，因此无法获得异常类型/错误代码。

**编辑**

我尝试了以下场景，

1.  场景 - 当 DTC 服务停止时 错误消息

    > “服务器 'MyServ\SQL2005' 上的 MSDTC 不可用。” -

2.  场景 - 当 DATABASE SERVER 错误消息中的 DTC 禁用网络访问时

    > “合作伙伴事务管理器已禁用对远程/网络事务的支持。”

3.  场景 - 当应用程序服务器错误消息中的 DTC 禁用网络访问时

    > “事务管理器已禁用对远程/网络事务的支持。”

4.  还尝试通过停止应用服务器/网络服务器中的 netbios，然后我收到以下错误，

    > 由于通信问题，MSDTC 事务管理器无法从源事务管理器中提取事务。可能的原因是：存在防火墙并且它对 MSDTC 进程没有异常，两台机器无法通过它们的 NetBIOS 名称找到彼此，或者两个事务管理器之一未启用对网络事务的支持。

Stoppin 也尝试了 SQL 服务器和 MSDTC 服务。然后在启动 MSDTC 之前启动 SQL 服务器。但无法重现我需要的错误消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T10:43:51.073

如果服务器的 IP 地址在交易处理过程中被更新，就会发生这种情况。

如果 DTC 服务在 SQL 服务之后启动，但您已经尝试过，也可能会发生这种情况，所以我假设情况并非如此。

资料来源：[http ://social.msdn.microsoft.com/Forums/en-US/windowstransactionsprogramming/thread/c13d076d-e20c-421c-821f-a26bbae97a6a/](http://social.msdn.microsoft.com/Forums/en-US/windowstransactionsprogramming/thread/c13d076d-e20c-421c-821f-a26bbae97a6a/)

# ntfs - BY_HANDLE_FILE_INFORMATION 结构

> ID：15410919
> 
> 赞同：0
> 
> 时间：2013-03-14T13:39:02.013
> 
> 标签：ntfs, structure, file-structure, defragmentation

有谁知道 Windows 提供的 BY_HANDLE_FILE_INFORMATION 结构是否受到 NTFS 磁盘碎片整理的影响？
[http://msdn.microsoft.com/en-us/library/windows/desktop/aa363788%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363788%28v=vs.85%29.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T15:49:05.800

不，（数据或 MFT 的）碎片整理不会更改任何这些值。FILE_INFORMATION 结构仅返回来自几个 NTFS 文件属性（$FILE_NAME、$STANDARD_INFORMATION）和 FileIndex 的信息，这些信息在 NTFS 中无法更改。MFT的碎片整理可以改变文件记录的位置，文件数据的碎片整理可以改变$DATA属性的内容，但不会改变这些文件属性。

# wso2 - OSGI 服务作为 WSO2 ESB 中的端点

> ID：15410920
> 
> 赞同：0
> 
> 时间：2013-03-14T13:39:04.930
> 
> 标签：wso2, wso2esb

我想知道是否可以在 WSO2 ESB 中使用 OSGI 服务作为端点？我在 wso2 网站上阅读了很多文档和示例，但找不到任何相关信息。大多数端点只是 Web 服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T03:40:22.247

您可以通过多种方式将 OSGi 服务用作 Web 服务。

例如，请参阅[http://www.ibm.com/developerworks/webservices/library/ws-OSGi/index.html](http://www.ibm.com/developerworks/webservices/library/ws-OSGi/index.html)

我自己没有尝试过，但我建议将您的 OSGi 服务公开为 Web 服务，然后将其用作 WSO2 ESB 中的端点。

我希望这有帮助。

谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T17:52:42.163

你不能。OSGi 服务仅对驻留在 OSGi 容器中的 OSGi 包可见。ESB 端点可以是 HTTP、JMS、VFS、FIX 等。

# jquery - 单击后退按钮时停止 Jquery Mobile 重新初始化页面？

> ID：15410930
> 
> 赞同：0
> 
> 时间：2013-03-14T13:39:33.103
> 
> 标签：jquery, jquery-mobile

我自己在 jquery mobile 中处理后退/前进按钮。问题是，当用户单击返回按钮时，jquery 发送 ajax 请求并重新初始化页面，这弄乱了我所有的工作。我已经设置了`data-backbtn="false"`， `$.mobile.ajaxEnabled = false;`但是这些技巧都不适合我。任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:50:18.277

我认为您的问题也在**$.mobile.ajaxEnabled = false;** 处理。

该代码示例必须由 mobileinti 事件触发，如下所示：

```
$(document).bind("mobileinit", function () {
    $.mobile.ajaxEnabled = false;
}); 
```

还有一件事，必须在初始化 jQuery Mobile 之前触发 mobileinit 事件，如下所示：

```
<script src="http://www.dragan-gaic.info/js/jquery-1.8.2.min.js"></script>      
<script>
        $(document).bind("mobileinit", function () {
            $.mobile.ajaxEnabled = false;
        });    
</script>
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script> 
```

## 例子：

**HTML 1：**

```
<!DOCTYPE html>
<html>
<head>
    <title>jQM Complex Demo</title>
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi"/>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://www.dragan-gaic.info/js/jquery-1.8.2.min.js"></script> 
        <script>
                $(document).bind("mobileinit", function () {
                    $.mobile.ajaxEnabled = false;
                });    
        </script>         
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>   
</head>
<body>
    <div data-role="page" id="index">
        <div data-theme="a" data-role="header">
            <h3>
                First Page
            </h3>
            <a href="second.html" class="ui-btn-right">Next</a>
        </div>

        <div data-role="content">

        </div>

        <div data-theme="a" data-role="footer" data-position="fixed">

        </div>
    </div>    
</body>
</html> 
```

**HTML2：**

```
<!DOCTYPE html>
<html>
<head>
    <title>jQM Complex Demo</title>
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi"/>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://www.dragan-gaic.info/js/jquery-1.8.2.min.js"></script> 
        <script>
                $(document).bind("mobileinit", function () {
                    $.mobile.ajaxEnabled = false;
                });    
        </script>         
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>   
</head>
<body>    
    <div data-role="page" id="second">
        <div data-theme="a" data-role="header">
            <h3>
                Second Page
            </h3>
            <a href="index.html" class="ui-btn-left">Back</a>
        </div>

        <div data-role="content">

        </div>

        <div data-theme="a" data-role="footer" data-position="fixed">

        </div>
    </div>    
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:52:58.277

jQuery Mobile 在它们被导航离开后从 DOM 中删除伪页面（这仅适用于外部页面）。`data-role="page"`您可以通过将 data-dom-cache="true" 属性添加到伪页面的元素来在单个伪页面上停止此行为：

```
<div data-dom-cache="true" data-role="page">
    ...
</div> 
```

还有其他方法可以启用（我猜真的是禁用）此功能；[你可以在这里](http://jquerymobile.com/demos/1.0.1/docs/pages/page-cache.html)阅读它们

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T09:36:58.740

我最终使用了对我有用的这条线，

```
$(window).off('popstate'); 
```

# c++ - 引用 C++ 中函数返回的向量元素

> ID：15410935
> 
> 赞同：7
> 
> 时间：2013-03-14T13:39:51.463
> 
> 标签：c++, memory-management, reference, return, return-by-value

有人可以验证以下是BUG，并解释原因吗？我想我知道，但不清楚细节。（我的实际问题涉及枚举向量，而不是整数，但我认为这无关紧要。）假设我有以下代码：

```
std::vector<int> f (void) {
  std::vector<int> v;
  v.push_back(5);
  return v;
}

void g (void) {
  const int &myIntRef = f()[0];
  std::cout << myIntRef << std::endl;
} 
```

我是否正确 myIntRef 立即是一个悬空引用，因为 f 的返回值没有保存在堆栈上的任何地方？

另外，以下是有效的修复，还是仍然是错误？

```
 const int myIntCopy = f()[0];  // copy, not a reference 
```

也就是说，f()的返回结果是不是在第0个元素被复制之前就被扔掉了？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-14T13:42:25.973

那是一个错误。在完整表达式结束时，`const int &myIntRef = f()[0];`临时向量将被销毁并释放内存。以后的任何使用`myIntRef`都是未定义的行为。

在某些情况下，绑定对临时对象的引用可以延长临时对象的生命周期。这不是这种情况之一，编译器不知道返回的引用`std::vector<int>::operator[]`是临时的一部分还是对`int`具有静态存储持续时间的引用或任何其他东西的引用，并且它不会延长生命周期。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T13:46:16.093

是的，这样做确实是错误的。你打电话时：

```
return v; 
```

`v`正在创建对象的临时副本，并且

```
const int &myIntRef = f()[0]; 
```

使用此临时副本的第一个元素初始化您的引用。在这一行之后，临时副本不再存在，这意味着它`myIntRef`是一个无效的引用，使用它会产生**未定义的行为**。

你应该做的是：

```
std::vector<int> myVector = f();
const int &myIntRef = myVector[0];
std::cout << myIntRef << std::endl; 
```

其中（感谢*复制省略*）使用赋值运算符`myVector`通过使用来初始化对象，`v`而无需创建副本`v`。在这种情况下，您的引用的生命周期等于`myVector`对象的生命周期，使其成为完全有效的代码。

* * *

对于你的第二个问题：

> *“另外，以下是一个有效的修复，还是仍然是一个错误？”*
> 
> ```
>  const int myIntCopy = f()[0];  // copy, not a reference 
> ```

是的，这是另一种可能的解决方案。`f()[0]`将访问临时副本的第一个元素并使用其值来初始化`myIntCopy`变量。保证`v`返回的副本`f()`至少在整个表达式执行之前存在，请参阅*C++03 Standard 12.2 Temporary objects §3*：

> 临时对象被销毁作为评估完整表达式（1.9）的最后一步，该完整表达式（在词法上）包含它们被创建的点。

# .net - 自托管 WCF 数据服务身份验证

> ID：15410937
> 
> 赞同：0
> 
> 时间：2013-03-14T13:39:55.380
> 
> 标签：.net, wcf, wcf-data-services, self-hosting

我以与此类似的方式设置了自托管 WCF 数据服务 - [http://blogs.msdn.com/b/writingdata_services/archive/2011/01/24/self-hosting-a-wcf-data-service。 aspx](http://blogs.msdn.com/b/writingdata_services/archive/2011/01/24/self-hosting-a-wcf-data-service.aspx)

如何在此之上添加 Windows 身份验证？

我知道如何在 IIS 中添加它，但是自托管方案正在逃避我......

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T07:14:35.470

诀窍是使用 app.config 并在那里配置所有安全设置......：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.serviceModel>
    <bindings>
      <webHttpBinding>
        <binding name="MyBindingName" >
          <security mode="Transport">
            <transport clientCredentialType="Windows" />
          </security>
        </binding>
      </webHttpBinding>
    </bindings>
    <services>
      <service name="{you service type name including the namespace i.e. myapplication.myservice}">
        <endpoint address="" binding="webHttpBinding" bindingConfiguration="MyBindingName" contract="System.Data.Services.IRequestHandler">
        </endpoint>
      </service>
    </services>
  </system.serviceModel>
</configuration> 
```

有关详细答案，请参阅[此问题](https://stackoverflow.com/a/2543719/80941 "详细答案见这个问题")。

# java - 具有依赖项的项目上的 Eclipse 重命名功能

> ID：15410939
> 
> 赞同：4
> 
> 时间：2013-03-14T13:40:01.250
> 
> 标签：java, eclipse, svn, refactoring, rename

我有两个 Eclipse 项目。第二个取决于第一个。当我尝试重命名第一个项目的 java 类时（使用项目资源管理器上 java 文件上的 rename 函数），它正确地重构了该项目，但它不会更改项目上依赖它的任何内容。

eclipse中有没有办法告诉重命名功能甚至对与重构的项目相关联的项目起作用？感谢帮助。

我的 Eclipse 版本是 Juno。

**更新：**
忘了提到项目链接到 SVN 存储库。也许它可能是相关的。

**更新 2：**
我在 mliebelt 要求澄清后添加了更多详细信息。
我的 Eclipse 版本是 Juno，面向 Web 开发人员的 Eclipse Java EE IDE，内部版本号：20120614-1722。

我已经安装了一些插件：subclipse、JRebel、m2e、Eclipse Web Tool Platform。
第二个项目作为 Eclipse 中的项目依赖项链接到第一个项目。我在 Java Build Path 的项目选项卡中添加了第一个项目。一切似乎都很好，甚至是重命名功能。

然后，我尝试将这两个项目放在两个不同的 SVN 存储库中。我在 SVN 服务器上创建了两个存储库，并在我的机器上安装了客户端 tortoiseSVN 和 eclipse 插件 subclipse。由于我没有成功从 eclipse 中直接导入服务器上的项目，因此我将项目的文件夹复制到了不同的位置，并从 eclipse 中删除了这些项目。我使用 tortoiseSVN 导入项目，每个项目都在一个具有相同项目名称的存储库中，然后我将项目导入回 eclipse。为此，我使用了 eclipse“将现有项目导入工作区”功能，并选择了“将项目复制到工作区”选项。一切似乎都有效，但重命名功能无效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T15:33:20.237

它确实有效（对我来说），所以这就是我为重现该行为所做的工作。我希望这有助于找到错误。

1.  创建两个项目，并使第二个依赖于第一个。![<code>Test2</code> 的 Java 构建路径](../Images/69f429ae12ef7c038edfc2039328e29c.png)
2.  创建一些源代码，以便您可以重构它。确保一个类 in`Test2`依赖于一个类 in `Test`。
3.  从要重命名的方法的上下文菜单中选择。在那里输入方法的新名称，然后该`Preview`选项才可用。确保`Update references`已选中。![重命名方法说明对话框](../Images/432eb837e57da61d7f8b920828aebb1a.png)
4.  按下按钮`Preview`查看重构将更改哪些类。![在此处输入图像描述](../Images/70cdd89558e78345695652e2b29d8c6a.png)

如您所见，它对我有用。请检查您的上下文有什么不同：

*   定义依赖不同
*   使用不同的重构（可能包含错误）
*   ... ?

然后我将这两个项目添加到（本地）存储库（我使用插件 Subversive，这很重要），并重试了重构，它的工作方式相同。什么是“如果项目在 SVN 中它不起作用”？项目必须在 Eclipse 中，不能直接在 Subversion 存储库上进行重构。

* * *

我再次尝试重现该错误，但无法重现。这对我有用（不包括截图）：

1.  从 Eclipse（版本 Indigo）安装 Java EE
2.  从 Eclipse Marketplace 安装了 Subclipse 1.8。
3.  像以前一样定义两个项目。
4.  通过使用将项目添加到不同的 Subversion 存储库`Team > Share Project...> SVN > select the repository location > Finish`
5.  然后我删除了 2 个项目，并通过执行以下步骤在工作区中实例化它们：
    *   去`SVN Repository Exploring perspective`。
    *   在视图中打开`SVN Repositories`您的存储库位置，然后从菜单中为每个项目选择`Checkout...`。
    *   这些项目将在工作空间内重新实例化，并且两者之间的依赖关系不会丢失。
6.  之后，我可以重命名一个方法，如上所示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T10:51:08.867

Update2 中描述的工作流程中的问题是，当我将项目导入回 Eclipse 时，我使用了“将现有项目导入工作区”功能。

我不得不改用 SVN 的 SVN **Checkout Projects**，选择我之前创建的存储库。

![在此处输入图像描述](../Images/d1505de2df7c31d0194358edbb5c2167.png)

# iphone - tableview 作为 iphone 中的智能不起作用

> ID：15410945
> 
> 赞同：-1
> 
> 时间：2013-03-14T13:40:13.863
> 
> 标签：iphone, uitableview, uitextfield, resignfirstresponder

我有一个`textfield`和一个`tableview`。用户可以`textfield`从`tableview`或任何其他数据中选择数据。但是在输入用户自己的数据后，我`tableview`必须消失。我怎么能做到这一点。如果我使用辞职，第一响应者`did select row`方法不起作用`tableview`。

```
 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
      {

        UITableViewCell *selectedCell = [tableView cellForRowAtIndexPath:indexPath];
        txtcity.text = selectedCell.textLabel.text;

      }
     -(void)hideKeyboard  //this is my gesture recogniser method
      {

         autocompletetableview.hidden=true;//if i didn't use this statement it enter into didselectrow method
      }
     - (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

   autocompleteTableView.hidden=YES;
    if( textField == txtcity)
   {

    autocompleteTableView.hidden = NO;

     NSString *substring = [NSString stringWithString:textField.text];
         substring = [substring stringByReplacingCharactersInRange:range withString:string];
     [self searchAutocompleteEntriesWithSubstring:substring];// this method loads data    into my tableview

      return YES;
     }

   }

   (BOOL)textFieldShouldEndEditing:(UITextField *)textField
   {
    if([txtcity.text isEqualToString:@""])
    {
    autocompleteTableView.hidden=YES;

    return YES;
     }
    else
    autocompleteTableView.hidden=NO;
   }

  - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger) section {

   return arr2.count;
 }

   - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    UITableViewCell *cell = nil;
    static NSString *AutoCompleteRowIdentifier = @"AutoCompleteRowIdentifier";
    cell = [tableView dequeueReusableCellWithIdentifier:AutoCompleteRowIdentifier];
if (cell == nil) {
    cell = [[[UITableViewCell alloc] 
             initWithStyle:UITableViewCellStyleDefault        reuseIdentifier:AutoCompleteRowIdentifier] autorelease];
}

     cell.textLabel.text = [[arr2 objectAtIndex:indexPath.row]objectForKey:@"Name"];
    cell.textLabel.font=[UIFont boldSystemFontOfSize:12];
     cell.textLabel.numberOfLines=0;

   return cell;
} 
```

如果我这样使用，如果我选择行，它不会在索引路径方法中进入选择行。帮我

我没有得到我必须使用 resignfirstresponder 的地方

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T14:36:20.613

`resignFirstResponder`用于解散第一响应者（在 的情况下为键盘`UITextField`）。如果您希望 tableview 消失，请将`hidden`属性设置为 true 或从视图层次结构中删除 tableview。

IE;

```
[tableView setHidden:YES] 
```

或者

```
[tableView removeFromSuperview]; 
```

**更新：** 如果使用手势识别器检查父视图上的点击，您可以执行以下操作，以免不必要地触发手势方法。

我假设您正在视图控制器中为整个事情编写所有这些代码。

```
UITapGestureRecognizer *tapGe = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(hideKeyboard)];
tapGe.numberOfTapsRequired = 1;
tapGe.delegate =self;
[self.view addGestureRecognizer:tapGe] 
```

然后在视图控制器中实现以下方法（使其符合`UIGestureRecognizerDelegate`协议）：

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch{
  If(touch.view==self.view){
     return YES; //If its the main view accept the touch
  }else{
     return NO; //Otherwise(say tableview) don't consume the touch.
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T15:03:43.987

我认为这对您很有用。我使用了自定义单元格，并且在这里提供了我的工作代码。

```
 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

    return [mainDetaileArray count];
}

-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    return 115;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        NSArray* views = [[NSBundle mainBundle] loadNibNamed:@"ProductMerchantCell" owner:nil options:nil];

        for (UIView *view in views)
        {
            if([view isKindOfClass:[UITableViewCell class]])
            {
                cell = (ProductMerchantCell*)view;
                //cell.img=@"date.png";

            }
        }
    }

    cell.selectionStyle=UITableViewCellSelectionStyleNone;

        txtfield = [[UITextField alloc]initWithFrame:CGRectMake(104, 36, 58, 31)];
        txtfield.textColor = [UIColor colorWithRed:56.0f/255.0f green:84.0f/255.0f blue:135.0f/255.0f alpha:1.0f];
        txtfield.delegate = self;
        txtfield.keyboardType = UIKeyboardTypeNumbersAndPunctuation;
        txtfield.returnKeyType = UIReturnKeyDone;
        indexVal = indexPath.row;

        [txtfield setBorderStyle:UITextBorderStyleRoundedRect];
        txtfield.textAlignment = UITextAlignmentCenter;
        txtfield.text = [quantity_array objectAtIndex:indexPath.row];
   // NSLog(@" txtfield.text %@", txtfield.text);
        [txtfield setTag:indexPath.row];

        [txtfield setAutocapitalizationType:UITextAutocapitalizationTypeWords];

        NSString *total_str_price1=[[mainDetaileArray objectAtIndex:indexPath.row]valueForKey:@"total_product_price"];

        cell.availbl_pro_lbl.text=[NSString stringWithFormat:@"Total : %@%@",add_currnce_str,total_str_price1];

        cell.title_pro_lbl.text=[[mainDetaileArray objectAtIndex:indexPath.row]valueForKey:@"product_title"];

        str_price=[[mainDetaileArray objectAtIndex:indexPath.row]valueForKey:@"product_price"];

        cell.price_Pro_lbl.text=[NSString stringWithFormat:@"Price : %@%@",add_currnce_str,str_price];

        [cell.contentView addSubview:txtfield];

    return cell;

   }
- (void)textFieldDidEndEditing:(UITextField *)textField
{

    addtoValue = textField.text;
    [quantity_array replaceObjectAtIndex:textField.tag withObject:textField.text];

   // NSLog(@"quantity_array %@",quantity_array);
}
- (BOOL)textFieldShouldReturn:(UITextField *)textField {

    [textField resignFirstResponder];
    [cell.Quantity_txt resignFirstResponder];
    return YES;
}
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    [cell.Quantity_txt resignFirstResponder];
} 
```

# jasper-reports - 每个子报表一张 Excel 表（主报表中没有组）jaspersoft iReport

> ID：15410951
> 
> 赞同：3
> 
> 时间：2013-03-14T13:40:31.527
> 
> 标签：jasper-reports, export-to-excel

这真的让我发疯。我到处阅读，但仍然不明白为什么我的不工作

我有一个主报告（一个只返回一行的虚拟查询）和两个不同的详细信息带中的 2 个子报告（每个都有自己的标题）。第二个子报表拆分为多个 Excel 表！

主报告不包含任何组。它只是一个虚拟查询，没有与子报告的链接。

这是我在主要报告中所做的：

1.  添加属性：Name="net.sf.jasperreports.export.xls.one.page.per.sheet" 与 Value="True"

2.  设置忽略分页=“真”

3.  添加了 Line 元素并设置属性表达式：Name="net.sf.jasperreports.export.xls.break.after.row" 和 Default Value="True"

然后对于第二个子报告：

1.  设置忽略分页=“真”

我只想要每个子报表的一张 Excel 表。但是第二个子报告被分成多张纸...... :(

有谁知道是什么问题...？

我还在这里阅读了忽略分页和分页符的问题：http: [//community.jaspersoft.com/ireport-designer/issues/2575](http://community.jaspersoft.com/ireport-designer/issues/2575)

我正在使用 Jaspersoft iReport Designer 5.0.1

======================================= 我的主要报告的jrxml：

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Sample_Report28022013" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" isIgnorePagination="true" uuid="1808a381-4204-4662-9cc0-7d154bcc0890">
    <property name="ireport.zoom" value="1.0"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <property name="ireport.jasperserver.reportUnit" value="/reports/Test/Subreports"/>
    <property name="ireport.jasperserver.url" value="http://192.168.17.114:8080/jasperserver/services/repository"/>
    <property name="net.sf.jasperreports.export.xls.one.page.per.sheet" value="True"/>
    <property name="net.sf.jasperreports.export.html.remove.emtpy.space.between.rows" value="True"/>
    <parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
        <defaultValueExpression><![CDATA["C:\\Documents and Settings\\TreshmaC\\Desktop\\WCHY\\JasperSoft\\"]]></defaultValueExpression>
    </parameter>
    <queryString>
        <![CDATA[SELECT
     tableliste."ident" AS tableliste_ident
FROM
     "public"."tableliste" tableliste
LIMIT 1]]>
    </queryString>
    <field name="tableliste_ident" class="java.lang.Integer"/>
    <background>
        <band splitType="Stretch"/>
    </background>
    <title>
        <band height="7" splitType="Stretch"/>
    </title>
    <pageHeader>
        <band height="5" splitType="Stretch"/>
    </pageHeader>
    <columnHeader>
        <band height="7" splitType="Stretch"/>
    </columnHeader>
    <detail>
        <band height="97" splitType="Stretch">
            <subreport>
                <reportElement uuid="ea3a0ff6-f82f-43c0-8c7b-3d06e699f2f0" x="0" y="0" width="555" height="75"/>
                <connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
                <subreportExpression><![CDATA["repo:Sample_Report28022013_subreport1.jrxml"]]></subreportExpression>
            </subreport>
            <break>
                <reportElement uuid="3568174b-2ea9-4973-8e12-adcb7f54685a" x="0" y="83" width="100" height="1"/>
            </break>
        </band>
        <band height="94" splitType="Prevent">
            <subreport>
                <reportElement uuid="b6ab1daa-122a-4a4b-8f60-f9fe2ba78204" x="0" y="13" width="555" height="72">
                    <property name="net.sf.jasperreports.export.xls.break.before.row" value="True"/>
                </reportElement>
                <connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
                <subreportExpression><![CDATA["repo:Sample_Report28022013_subreport2.jrxml"]]></subreportExpression>
            </subreport>
        </band>
    </detail>
    <columnFooter>
        <band height="7" splitType="Stretch"/>
    </columnFooter>
    <pageFooter>
        <band height="7" splitType="Stretch"/>
    </pageFooter>
    <summary>
        <band height="203" splitType="Stretch">
            <componentElement>
                <reportElement uuid="2651da09-f5ff-45de-91cb-6d9f0a8af724" x="0" y="0" width="555" height="200"/>
                <mp:map xmlns:mp="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
                    <mp:latitudeExpression><![CDATA[37.7750f]]></mp:latitudeExpression>
                    <mp:longitudeExpression><![CDATA[-122.4183f]]></mp:longitudeExpression>
                </mp:map>
            </componentElement>
        </band>
    </summary>
</jasperReport> 
```

====================================================第二个子报告的 jrxml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Sample_Report28022013_subreport2" language="groovy" pageWidth="555" pageHeight="802" columnWidth="555" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" isIgnorePagination="true" uuid="5a86bc51-7425-4897-b74c-0dcf7016c666">
    <property name="ireport.zoom" value="1.0"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <property name="ireport.jasperserver.reportUnit" value="/reports/Test/Subreports"/>
    <property name="ireport.jasperserver.url" value="http://192.168.17.114:8080/jasperserver/services/repository"/>
    <property name="net.sf.jasperreports.export.html.remove.emtpy.space.between.rows" value="True"/>
    <queryString>
        <![CDATA[SELECT
     ad_dcr."id_client" AS ad_dcr_id_client,
     ad_dcr."detail_obj_dem" AS ad_dcr_detail_obj_dem,
     ad_dcr."cre_mnt_octr" AS ad_dcr_cre_mnt_octr,
     ad_dcr."cre_mnt_deb" AS ad_dcr_cre_mnt_deb,
     ad_cli."id_client" AS ad_cli_id_client,
     ad_cli."num_port" AS ad_cli_num_port,
     ad_cli."pp_prenom" AS ad_cli_pp_prenom,
     ad_cli."pays" AS ad_cli_pays,
     ad_cli."email" AS ad_cli_email,
     ad_cli."pp_nom" AS ad_cli_pp_nom
FROM
     "public"."ad_cli" ad_cli LEFT JOIN "public"."ad_dcr" ad_dcr ON ad_cli."id_client" = ad_dcr."id_client"
ORDER BY ad_cli."id_client"]]>
    </queryString>
    <field name="ad_dcr_id_client" class="java.lang.Integer"/>
    <field name="ad_dcr_detail_obj_dem" class="java.lang.String"/>
    <field name="ad_dcr_cre_mnt_octr" class="java.math.BigDecimal"/>
    <field name="ad_dcr_cre_mnt_deb" class="java.math.BigDecimal"/>
    <field name="ad_cli_id_client" class="java.lang.Integer"/>
    <field name="ad_cli_num_port" class="java.lang.String"/>
    <field name="ad_cli_pp_prenom" class="java.lang.String"/>
    <field name="ad_cli_pays" class="java.lang.Integer"/>
    <field name="ad_cli_email" class="java.lang.String"/>
    <field name="ad_cli_pp_nom" class="java.lang.String"/>
    <background>
        <band splitType="Stretch"/>
    </background>
    <title>
        <band height="23" splitType="Stretch"/>
    </title>
    <pageHeader>
        <band height="43" splitType="Stretch">
            <staticText>
                <reportElement uuid="a071e7c5-1a11-497b-9eee-6b243a947965" x="378" y="0" width="177" height="39"/>
                <textElement textAlignment="Right">
                    <font fontName="Castellar" size="26"/>
                </textElement>
                <text><![CDATA[DCR ]]></text>
            </staticText>
        </band>
    </pageHeader>
    <columnHeader>
        <band height="22" splitType="Stretch">
            <frame>
                <reportElement uuid="12e8ca58-2196-4a8a-9137-c5104e63a485" mode="Opaque" x="0" y="0" width="555" height="20" backcolor="#006666"/>
            </frame>
            <staticText>
                <reportElement uuid="a1b68cab-e347-4a8f-87f8-01064a78854f" x="12" y="0" width="100" height="20" forecolor="#FFFFFF"/>
                <textElement>
                    <font isBold="true"/>
                </textElement>
                <text><![CDATA[Client ID]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="8a1870d5-2682-45a1-bf8b-31a613028daf" x="312" y="0" width="143" height="20" forecolor="#FFFFFF"/>
                <textElement>
                    <font isBold="true"/>
                </textElement>
                <text><![CDATA[Achat]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="df37206c-95bf-4d03-8add-3fc7ca1d07a9" x="455" y="0" width="100" height="20" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center">
                    <font isBold="true"/>
                </textElement>
                <text><![CDATA[Montant]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="40e2dded-de55-4692-8e8d-2e94127dd28e" x="112" y="0" width="100" height="20" forecolor="#FFFFFF"/>
                <textElement>
                    <font isBold="true"/>
                </textElement>
                <text><![CDATA[Nom]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="45abf217-95a0-4ef4-963b-45c2915e5723" x="212" y="0" width="100" height="20" forecolor="#FFFFFF"/>
                <textElement>
                    <font isBold="true"/>
                </textElement>
                <text><![CDATA[Pays]]></text>
            </staticText>
        </band>
    </columnHeader>
    <detail>
        <band height="26" splitType="Stretch">
            <textField>
                <reportElement uuid="7f43f0d2-fcc2-45b3-865e-02d643954c1c" x="12" y="0" width="100" height="20"/>
                <textElement/>
                <textFieldExpression><![CDATA[$F{ad_dcr_id_client}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="c14584b6-c516-423a-ac17-bc4ffeb7d74c" x="312" y="0" width="143" height="20"/>
                <textElement/>
                <textFieldExpression><![CDATA[$F{ad_dcr_detail_obj_dem}]]></textFieldExpression>
            </textField>
            <textField pattern="#,##0.00">
                <reportElement uuid="88cb8587-2e82-4ea6-9c1d-f53767ffb93c" x="455" y="0" width="100" height="20"/>
                <textElement textAlignment="Center"/>
                <textFieldExpression><![CDATA[$F{ad_dcr_cre_mnt_deb}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="f4feb876-fbb5-4b7b-b9fb-f24528dfb762" x="112" y="0" width="100" height="20"/>
                <textElement/>
                <textFieldExpression><![CDATA[$F{ad_cli_pp_nom}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="5fed5609-a23b-4cbe-a4b2-a0ebf36e3cd5" x="212" y="0" width="100" height="20"/>
                <textElement/>
                <textFieldExpression><![CDATA[$F{ad_cli_pays}]]></textFieldExpression>
            </textField>
            <line>
                <reportElement uuid="6eb43b44-1a3f-4b05-be37-4caeb35e5feb" x="0" y="20" width="555" height="1"/>
            </line>
        </band>
    </detail>
    <columnFooter>
        <band height="7" splitType="Stretch"/>
    </columnFooter>
    <pageFooter>
        <band height="8" splitType="Stretch"/>
    </pageFooter>
    <summary>
        <band height="7" splitType="Stretch"/>
    </summary>
</jasperReport> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-27T11:34:44.897

我认为您可以将主报告和子报告中的页面大小设置为某个非常大的值，例如 999999 并在子报告之间从托盘中插入“分页符”。这样，您应该在不同页面中获取每个子报表，但第二个不应跨越多个页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-17T14:25:49.293

您无需在 Main 中执行任何操作。这一切都在子报告中。比如主要的：

```
 <detail>
            <band height="397">
                <subreport>
<reportElement positionType="Float" x="0" y="298" width="801" height="99" uuid="61789fb8-f34c-46d4-a13e-6cfeba5567a7">
                        <property name="com.jaspersoft.studio.unit.height" value="pixel"/>
                    <connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
                    <subreportExpression><![CDATA["repo:"]]></subreportExpression>
                </subreport>
                <subreport>
                    <reportElement positionType="Float" x="0" y="298" width="801" height="99" uuid="61789fb8-f34c-46d4-a13e-6cfeba5567a7">
                        <property name="com.jaspersoft.studio.unit.height" value="pixel"/>
                    </reportElement>
                    <connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
                    <subreportExpression><![CDATA["repo:"]]></subreportExpression>
                </subreport>
            </band>
        </detail> 
```

并在您拥有的最后一个元素（如文本字段）中使用 BreakAfter：

```
<textField isBlankWhenNull="true">
                <reportElement x="280" y="0" width="120" height="30" uuid="632a6ed9-70ce-4ecd-a3e0-aaec6af95aa9">
                    <property name="net.sf.jasperreports.export.xls.break.after.row" value="true"/>
                    <property name="net.sf.jasperreports.export.xls.sheet.name" value="Nombre y apellidos"/>
                </reportElement>
                <box>
                    <topPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font size="11" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA["TOTAL"]]></textFieldExpression>
            </textField> 
```

这应该放在报告的末尾

# c - 从系统中删除 USB 并返回正确的目录后，readdir() 不给出错误

> ID：15410953
> 
> 赞同：1
> 
> 时间：2013-03-14T13:40:32.933
> 
> 标签：c, linux, linux-kernel, usb, readdir

我用的是linux系统。我使用 opendir() & 然后 readdir() 来读取 USB 中的目录。

如果在 readdir() 从 USB 读取 Dir 之间，我会从系统中移除 USB。

但我仍然从 readdir() 得到正确的目录值，没有任何错误。

我知道 readdir() 函数可能会在每个实际读取操作中缓冲多个目录条目。

那么如何避免呢？

一旦从系统中删除 USB，我想从 readdir() 中得到错误。

有什么建议吗？

谢谢

# types - Where I can find definitions of vector types (uchar3, float3, uint2, and alike)?

> ID：15410954
> 
> 赞同：2
> 
> 时间：2013-03-14T13:40:34.957
> 
> 标签：types, cuda

For now I know that such types exist, I know what fields they have, but I couldn't find a definitions for them. I.e. I found:

```
typedef __device_builtin__ struct uint2 uint2; 
```

But this leaves all the questions I have intact -- what about their constructors? What about operators? And so on.

So, are the definitions (real ones) for those types published somewhere? I wouldn't like to reinvent the wheel especially not optimized (starting how to init such structure).

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-14T14:49:59.983

The definitions for most of these vector types are included in:

```
/usr/local/cuda/include/vector_types.h 
```

(assuming standard cuda install path). Most of them are structs, and don't require specific operator definitions for operating on struct members, nor do they have official c++ style constructors.

The "constructors" that you refer to e.g. `make_int2` are inline functions defined in:

```
/usr/local/cuda/include/vector_functions.h 
```

Again, they are ordinary c style functions operating on structure members, not c++ style class/struct methods.

# api - 如何从集合中获取 api 返回的数据？

> ID：15410964
> 
> 赞同：2
> 
> 时间：2013-03-14T13:41:09.370
> 
> 标签：api, backbone.js, collections, model

我有以下从 api 获取数据的集合：

```
var Data = Backbone.Collection.extend({
    url: '/* api url - working */',

    sync: function(method, model, options) {
        options.timeout = 10000;
        options.dataType = "jsonp";
        return Backbone.sync(method, model, options);
    }
}); 
```

我想在视图中显示它：

```
var MyView = Backbone.View.extend({
    el : '.myview',
    render : function () {
        var data = new Data();
        var that = this;

        data.fetch({
            success : function (data) {
                console.log(arguments);
                console.log(data);

                var template = _.template( $('#temp').html(), {data: data.models} );
                that.$el.html(template);
            }
        });
    }
}); 
```

我不明白的是，当我登录时，`arguments`我得到了 api 数据并且它有一个 wieired 结构：`{0:child, 1:object\* contains the api data *\, 2:object}`但是当我登录时，`data`我只得到`child`

我不明白这种结构，我缺少什么以及如何从中获取 api 数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:46:55.290

`Collection.fetch`正在使用 3 个参数（来自[Backbone 源](http://backbonejs.org/backbone.js)）调用您传入的成功函数：

```
success(collection, resp, options); 
```

`arguments`是所有 javascript 函数中的特殊局部变量。查看此[文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments)。

因此，日志记录显示传递给函数`arguments`的 3 件事，而日志记录只显示传入的第一件事。即使您的函数只有 1 个参数，仍然传递了三件事。`success``data`

首先传递给`success`的是 Backbone Collection 本身。所以，你需要做什么取决于你的模板是什么样的。通常只将 JSON 传递给模板函数：`_.template( $('#temp').html(), {data: data.toJSON()} )`. 然后在模板中，您需要遍历这些 JSON 对象。

```
 <% _.each(data, function(item){ %>
     <div><%= item.foo %></div>
 <% }); %> 
```

# javascript - 我的应用程序经常导致 chrome tab 崩溃 - 我该如何解决这个问题？

> ID：15410970
> 
> 赞同：0
> 
> 时间：2013-03-14T13:41:32.283
> 
> 标签：javascript, jquery, google-chrome, backbone.js

我的应用程序使用了很多带有backbone.js 的javascript 来操作由各种事件触发的DOM。它有时会导致 Google Chrome 上的标签崩溃（只是标签崩溃而不是整个 chrome 崩溃）。我们一直在调查究竟是什么导致了这个问题，但没有任何线索。我们通过 chrome 任务管理器的选项卡监视内存，但即使内存使用量很小，也会发生崩溃。

有没有办法调试这种问题？我们无法确定问题所在。

**更新**

问题是故意复制崩溃并不容易。它有时会发生在某些用户身上。而这些用户通常会反复体验（通常在单击提交按钮后）。另一方面，对于其他用户，即使标签页在复杂的 DOM 操作后开始使用超过 200M 的内存，Chrome 仍然可以正常工作。在开发人员工具上使用分析工具可能是一种方法，但是在确定问题之前看起来确实需要做很多工作。如果有人知道有效的方法来确定问题所在，那就太好了......

我们还知道，我们一直在遭受内存泄漏的困扰。因此，一旦 DOM 绑定的事件被删除，我们就开始取消绑定事件。只要我们从任务管理器进行监控，这有助于我们避免使用大量内存。但是，我们不知道我们做得足够好，它与标签崩溃有关......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:28:27.733

打开开发人员工具并单击控制台选项卡并在`console.log(message);`整个代码中添加一些内容，以查看它在崩溃之前的位置。没有更多信息，就没有什么可做的了。

# c#-4.0 - C# ListView 图像/图标边距/填充

> ID：15410971
> 
> 赞同：0
> 
> 时间：2013-03-14T13:41:34.513
> 
> 标签：c#-4.0, listview, icons, margin, padding

是否可以在 ListView 中重现下图中的内容，右侧的填充/边距图标。

[http://img801.imageshack.us/img801/4043/listview.png](http://img801.imageshack.us/img801/4043/listview.png)

我的第一个问题在这里，所以我不能在这里发布图片。

基本上我需要将 ListView 图标移动得更正确，我正在复制文件/目录浏览器，所以目录中的失败需要在它们下方并且稍微像图片中的那样，我已经弄清楚了其他所有内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:02:00.730

您应该使用`TreeView`控件：http:
[//msdn.microsoft.com/en-us/library/1dtsdfkx.aspx](http://msdn.microsoft.com/en-us/library/1dtsdfkx.aspx)

但是如果你坚持用`ListView`这种方式来渲染，你只需要自己接管每一行的绘制。您可以使用该`OwnerDraw`属性来执行此操作，但请注意这里有很多极端情况，因此您应该做大量阅读以了解人们在实施此操作时必须处理的内容：http:
[//msdn.microsoft.com/ en-us/library/system.windows.forms.listview.ownerdraw.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.ownerdraw.aspx)

# java - DFA 预测和范围

> ID：15410973
> 
> 赞同：4
> 
> 时间：2013-03-14T13:41:37.323
> 
> 标签：java, antlr, antlr3, abstract-syntax-tree, dfa

从这个语法开始：[https](https://stackoverflow.com/a/14287002/1082002) ://stackoverflow.com/a/14287002/1082002我会实现一个简单的语法，它接受和评估这样的简单语言：

```
{ 
   if a==c { 
      a
      if a==b { 
         b 
      } else { 
         c 
      }
   }

} 
```

所以，如果`a==c`，它执行`a`并评估`if a==b`，如果它是真的，它执行`b`否则`c`。真的很简单。

解析器语法和树语法是这些：

### TreeEvaluator.g（组合语法生成 AST）

```
grammar TreeEvaluator;

options { 
    output = AST;
}

tokens { 
    CONDBLOCK;
    CODEBLOCK;
    DEFAULT;
}

compilationUnit : block EOF -> block;

condition       : cif elif* celse? -> ^(IF cif elif* celse?);
cif             : IF expr block -> ^(CONDBLOCK expr block);
elif            : ELIF expr block -> ^(CONDBLOCK expr block);
celse           : ELSE block -> ^(DEFAULT block); 
expr            : ID EQ^ ID;
block           : LCUR instruction* RCUR -> ^(CODEBLOCK instruction*);
instruction     : ID | condition;

IF  : 'if';
ELIF: 'elif';
ELSE: 'else';
LCUR: '{';
RCUR: '}';
EQ  : '==';
ID  : ('a'..'z'|'A'..'Z')+;
WS  : (' '|'\t'|'\f'|'\r'|'\n')+ {skip();}; 
```

### AstTreeEvaluatorParser.g（树解析器）

```
tree grammar AstTreeEvaluatorParser;

options { 
    output = AST;
    tokenVocab = TreeEvaluator;
    ASTLabelType = CommonTree;
}

@members { 
    private static final class Evaluation {
        boolean matched = false; 
        boolean done = false;
    }

    private java.util.HashMap<String, Integer> vars = new java.util.HashMap<String, Integer>();

    public void addVar(String name, int value){
        vars.put(name, value);
    }

}

compilationUnit : block+;

block        : ^(CODEBLOCK instruction*);

instruction  : ifStat | ID;

ifStat       
@init { Evaluation eval = new Evaluation(); }
         : ^(IF condition[eval]* defcond[eval]?) 
         ;

condition [Evaluation eval]
         : ^(CONDBLOCK exp {if ($exp.value) eval.matched = true;} evalblock[eval])
         ;

defcond [Evaluation eval] 
         : ^(DEFAULT {eval.matched = true;} evalblock[eval]) //force a match
         ;

evalblock [Evaluation eval]     
         : {eval.matched && !eval.done}? //Only do this when a condition is matched but not finished 
        block                //call the execution code
        {eval.done = true;}  //evaluation is complete.
         | ^(CODEBLOCK .*)  //read the code node and continue without executing
         ;

exp returns [boolean value]
        : ^(EQ lhs=ID rhs=ID)
        {$value = vars.get($lhs.getText()) == vars.get($rhs.getText());}
        ; 
```

问题是为预测规则而生成的 DFA `evalblock`，该 DFA 有一个`SpecialStateTransition()`引用参数的方法`eval`（如规则中指定的那样），但在生成的 Java 类中，该参数不可见。

我不明白为什么，以及是否有办法避免这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T16:05:35.850

您有一个语义谓词 (syntax `{...}?`)，其中包含对由操作 (syntax ) 更改的值的引用`{...}`。在您的情况下，值是字段`Evaluation.matched`和`Evaluation.done`.

您应该完全避免这种情况 - 永远不要包含依赖于执行操作的谓词。*相反，通过将操作*代码包装在操作中来检查操作中的这些值`if (eval.matched && !eval.done) { ... }`

¹ 有些人编写的语法会以这种方式进行交互，但我严格避免这样做，因为可能会出现您所看到的问题以及其他更糟糕的问题。

# django - Django：定义自己的表单字段

> ID：15410974
> 
> 赞同：0
> 
> 时间：2013-03-14T13:41:38.780
> 
> 标签：django, django-forms, django-models

我写了一个这样的表单域

//forms.py

```
hostAdress = forms.CharField(required = False,
                             label = ('#content'),
                             initial = ('#content'))
adminHostAdress = hostAdress
userHostAdress = hostAdress 
```

它显示正确，但是当想要保存表单时，我会带着填写的字段返回表单，没有其他任何事情发生。

当我写

```
adminHostAdress = forms.CharField(required = False,
                                  label = ('#content'),
                                  initial = ('#content'))
userHostAdress = forms.CharField(required = False,
                                 label = ('#content'),
                                 initial = ('#content')) 
```

所有的作品，但我重复自己，我有更多的这些领域我想写一次。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:49:58.187

您的第一个示例只是将其分配`CharField`给两个单独的表单变量，因此本质上它们共享 Django 表单字段的相同实例。如果您愿意，可以尝试以下方法：

```
class MyForm(forms.Forms):
    def __init__(self, *args, **kwargs):
        super(MyForm, self).__init__(*args, **kwargs)
        for field_name in ["adminHostAdress", "userHostAdress", ...]:
            self.fields[field_name] = forms.CharField(
                required = False,
                label = ('#content'),
                initial = ('#content')) 
```

但这在 IMO 上的可读性较差，并且不会特别为您节省很多时间。

# ruby-on-rails - 如何根据前一个选择框从选择框中动态选择值？

> ID：15410975
> 
> 赞同：0
> 
> 时间：2013-03-14T13:41:39.343
> 
> 标签：ruby-on-rails, ruby-on-rails-3, has-and-belongs-to-many

如果我不能让你理解，我很抱歉。

我有两个表，其中第一个表包含类别，下一个包含子类别，我有另一个表项，其中我与子类别表有 has_and_belongs_to_many 关系。当我创建一个新项目时，我必须在第一个选择框中显示类别，并且根据选择，必须在另一个选择框中显示子类别并且必须添加值。我已经有另一个如下图所示

```
<%= collection_select :item, :sub_category_ids, SubCategory.find(:all, :conditions => ["category_id = 7"], :order => 'sub_category_name ASC'), :id, :sub_category_name, { :selected => @item.sub_category_ids }, { :multiple => true, :name => 'item[sub_category_ids][]' } -%> 
```

现在我想加上这个 ![在此处输入图像描述](../Images/19b523942037bac08234b8b4580c0d63.png) 。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:54:24.457

你必须使用 AJAX 来实现你想要的。

您可能想使用 Javascript 来查看第一个下拉值。当该值更改时，您需要进行 ajax 调用以检索第二个下拉列表的值，然后根据 AJAX 响应填充第二个下拉框

# javascript - 验证字母和数字的正则表达式无法按预期工作

> ID：15410980
> 
> 赞同：1
> 
> 时间：2013-03-14T13:41:53.000
> 
> 标签：javascript, regex

我正在尝试创建一个包含 17 个字符的正则表达式，必须包含强制性数字和字母，并且不得包含字母 I、O、Q、Ñ。目前我有：

```
^(([a-h]|[j-n]|p|[r-z]|[A-H]|[J-N]|P|[R-Z]|[0-9]){17})$ 
```

但如果我只输入数字或字母，正则表达式会验证它是否良好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T13:47:01.060

通常在这种情况下，您希望使用[肯定的前瞻](http://www.regular-expressions.info/lookaround.html)来断言输入满足其他条件。由于您在这里有两个条件（必须至少包含一个数字，必须至少包含一个字母），这将转换为两个不同的前瞻。

加上额外的空格和“注释”以提高可读性，正则表达式应如下所示：

```
^
(?=.*[a-hj-npr-zA-HJ-NPR-Z].*)  // assert the input contains at least one letter
(?=.*[0-9].*)                   // assert the input contains at least one digit
[a-hj-npr-zA-HJ-NPR-Z0-9]{17}   // existing condition (17 allowed chars exactly)
$ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-14T13:59:59.543

使用正面和负面的前瞻来要求和禁止字符：

```
/^(?=.*[0-9])(?=.*[A-Za-z])(?!.*[ioqñIOQÑ])[0-9a-zA-Z]{17}$/.test(s); 
```

演示：http: [//jsfiddle.net/2mNyg/](http://jsfiddle.net/2mNyg/)

描述：

```
(?=.*[0-9])        - requires a digit
(?=.*[A-Za-z])     - requires a letter
(?!.*[ioqñIOQÑ])   - disallows all characters in the set
[0-9a-zA-Z]{17}    - allow basic set and require 17 characters 
```

注意：需要字母的预读也会被不允许的字符满足，但不允许字符的预读仍然会阻止它。这样，您可以使表达式更简单。

# java - 提取要以简单日期格式使用的子字符串

> ID：15410984
> 
> 赞同：0
> 
> 时间：2013-03-14T13:42:05.147
> 
> 标签：java, hashmap, indexof

我正在阅读日志文件，需要从某些行中提取日期和年份，以便使用简单的日期格式并找出两个操作之间的平均时间。我需要日期的行的示例如下所示。

```
(INFO ) [07 Feb 2013 08:04:39,161] -- ua, navigation, fault 
```

我不知道是否应该将该行拆分两次或使用 substring 函数。此外，我认为在转换为简单日期格式（161）时不需要包含最后一个数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:47:36.390

我建议您使用正则表达式从日志文件中提取所需的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T13:43:53.630

我会使用子字符串：

```
final int from = line.indexOf('[') + 1;
final int to = line.indexOf(']', from); // or , if you do not want to have the last number included
final String timestampAsString = line.substring(from, to); 
```

顺便说一句：如果找到有效索引，请添加一些从/到检查 - 例如，在日志格式更改时及早检测错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:56:37.330

考虑使用正则表达式组来提取您想要的字符串。您可以使用

```
Pattern p = Pattern.compile("you regex pattern with () around the bit you wanna extract");
Matcher m = p.matcher(theLine);
if (m.find()) {
    String date =  m.group(1);
} 
```

# java - 如何从 cmd 运行 Web 服务（WSDD 文件）？

> ID：15410985
> 
> 赞同：0
> 
> 时间：2013-03-14T13:42:06.360
> 
> 标签：java, web-services, cmd, axis, noclassdeffounderror

![在此处输入图像描述](../Images/37db396fa74fcbcf6870cbb5c2fa511b.png)

我试图从 cmd 运行 wsdd 文件，但在上图中出现此错误。似乎 wsdd 没有看到 Sample.java 文件中的主类，知道它在工作目录中的任何人都可以帮助 plz

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T19:46:03.147

问题是 JVM 不知道要查找该类，因此我必须将 classPath 设置为所需类的位置，以便 JVM 可以运行它。希望这对其他人有帮助

# javascript - 调用某个元素的事件侦听器，而不是正文的事件侦听器中的事件侦听器

> ID：15410986
> 
> 赞同：0
> 
> 时间：2013-03-14T13:42:09.203
> 
> 标签：javascript, event-listener

我有一个用于触摸事件的所有主体的事件监听器，但是在主体内部的某个元素内，我想为这些触摸事件做不同的事情。问题是，即使我在触摸元素时将 eventListeners 添加到该元素，它也会调用为 body 设置的 eventListener。我怎样才能删除body eventListener，但只在我想要的元素中？还是调用我放入元素中的 eventListener 而不是调用正文中的 eventListener？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T13:45:17.510

你需要使用 event.stopPropagation()。

在这里您可以了解更多信息： [http ://www.w3schools.com/jquery/event_stoppropagation.asp](http://www.w3schools.com/jquery/event_stoppropagation.asp)

# jboss - JBoss 启动警告：MSC 服务线程...无效的类名

> ID：15410987
> 
> 赞同：2
> 
> 时间：2013-03-14T13:42:12.237
> 
> 标签：jboss, jboss-weld

我想摆脱以下 JBoss 控制台输出中的 WARN 消息。

```
08:46:53,653 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-5) JBAS015876: Starting deployment of "IodLogin.war"
08:46:53,670 INFO  [org.jboss.as.remoting] (MSC service thread 1-12) JBAS017100: Listening on 127.0.0.1:9999
08:46:53,670 INFO  [org.jboss.as.remoting] (MSC service thread 1-3) JBAS017100: Listening on 127.0.0.1:4447
08:46:54,124 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-14) JBAS015893: Encountered invalid class name 'com.sun.faces.vendor.Tomcat6InjectionProvider:org.apache.catalina.util.DefaultAnnotationProcessor' for service type 'com.sun.faces.spi.injectionprovider'
08:46:54,124 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-14) JBAS015893: Encountered invalid class name 'com.sun.faces.vendor.Jetty6InjectionProvider:org.mortbay.jetty.plus.annotation.InjectionCollection' for service type 'com.sun.faces.spi.injectionprovider'
08:46:54,596 INFO  [org.jboss.weld.deployer] (MSC service thread 1-15) JBAS016002: Processing weld deployment IodLogin.war
08:46:54,815 INFO  [org.jboss.weld.deployer] (MSC service thread 1-10) JBAS016005: Starting Services for CDI deployment: IodLogin.war
08:46:54,858 INFO  [org.jboss.weld.Version] (MSC service thread 1-10) WELD-000900 1.1.10 (redhat)
08:46:54,901 INFO  [org.jboss.as.osgi] (MSC service thread 1-7) JBAS011907: Register module: Module "deployment.IodLogin.war:main" from Service Module Loader
08:46:54,904 INFO  [org.jboss.weld.deployer] (MSC service thread 1-11) JBAS016008: Starting weld service for deployment IodLogin.war
08:46:55,269 INFO  [org.apache.catalina.core.StandardContext] (MSC service thread 1-13) The listener "com.sun.faces.config.ConfigureListener" is already configured for this context. The duplicate definition has been ignored.
08:46:55,327 INFO  [javax.enterprise.resource.webcontainer.jsf.config] (MSC service thread 1-13) Initializing Mojarra 2.1.13-jbossorg-1 20121010-0442 for context '/IodLogin'
08:46:55,933 INFO  [org.hibernate.validator.util.Version] (MSC service thread 1-13) Hibernate Validator 4.2.0.Final-redhat-2
08:46:56,281 INFO  [javax.enterprise.resource.webcontainer.jsf.config] (MSC service thread 1-13) Monitoring jndi:/default-host/IodLogin/WEB-INF/faces-config.xml for modifications 
```

这“只是”一条警告信息，我怀疑它有任何直接的负面影响，但我尽量避免警告信息可能会分散我和其他人对不应忽视的警告的注意力——“哭狼的男孩” ’”比喻。

我没有使用 Tomcat 或 Jetty，但看起来某些配置文件或代码指的是特定于这些环境的类。我已经验证没有任何 XML 文件直接引用它们。

我正在运行 JBoss EAP 6.0.1.GA。到目前为止，这个 JSF 2.0 应用程序非常简单——只有一个页面和几个类。我正在使用 Eclipse，没有 Maven。 [在 SO 的其他地方](https://stackoverflow.com/questions/12777560)，我找到了对 的引用`org.jboss.shrinkwrap`，但我不明白这如何适用于我的情况。

**更新：** 我的问题是“我如何使这种非问题症状消失，这样它就不会掩盖真正的问题”。我不是在寻找我的代码中的错误，只是对配置的改进。

关于我应该在哪里看的任何建议？

# django - * 之后的 add() 参数必须是序列，而不是组

> ID：15410993
> 
> 赞同：4
> 
> 时间：2013-03-14T13:42:21.037
> 
> 标签：django, django-forms

我正在尝试使用[django-adaptors 的](http://django-adaptors.readthedocs.org/en/latest/#importer-option)[importer-option](http://django-adaptors.readthedocs.org/en/latest/#importer-option)将“组”作为额外字段传递，但出现以下错误...

*** 后的 add() 参数必须是序列，而不是 Group**

```
ContactCSVModel.import_data(data=self.filepath, extra_fields="1") 
```

这是我的 CsvModel...

**CSVModel.py**

```
class ContactCSVModel(CsvModel):

    first_name = CharField()
    last_name = CharField()
    company = CharField()
    mobile = CharField()
    groups = DjangoModelField(Group)

    class Meta:
        delimiter = "^"
        dbModel = Contact
        update = {
            'keys': ['mobile']
        } 
```

**模型.py**

```
class Contact(models.Model):
    """
    Stores all contacts.
    """
    first_name = models.CharField(max_length=60)
    last_name = models.CharField(max_length=60)
    company = models.CharField(max_length=100,blank=True)
    mobile = models.IntegerField(max_length=20)
    active = models.BooleanField(help_text="States if pet type is active/selectable.")
    modified = models.DateTimeField(null=True, auto_now=True, help_text="Shows when object was modified.")
    created = models.DateTimeField(auto_now_add=True, help_text="Shows when object was created.")

    #FK
    groups = models.ManyToManyField(Group, related_name='contacts') 
```

查看 git 上的项目（如下），项目和 many2many 字段是否有任何问题，如果是，如何解决？还是我的代码？

[https://github.com/anthony-tresontani/django-adaptors/blob/master/adaptor/model.py#L436](https://github.com/anthony-tresontani/django-adaptors/blob/master/adaptor/model.py#L436)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T15:51:45.130

目前 django-adaptors 不支持 ManyToManyFields。随着对它的要求越来越多，我将尽快整合它。

如果你想解决这个问题，你应该分两步工作。第一个是使用简单的 CSVModel 创建一个 python 对象，方法是删除：

```
dbModel = Contact 
```

不幸的是，您还必须手动执行更新逻辑。

然后，您需要通过执行以下操作显式创建 django 实例：

```
contact = Contact.objects.create(first_name = csv_object.first_name, ....)
contact.groups.add(csv_object.group) 
```

希望有帮助