# StackOverflow 问答 14176000-14176999

# silverlight - 如何修复：silverlight 可拖动窗口 - 属性“System.Windows.Controls.Border.Child”设置了多次。

> ID：14176000
> 
> 赞同：0
> 
> 时间：2013-01-05T20:19:53.477
> 
> 标签：silverlight, xaml, arcgis

希望知道如何解决这个问题：我在 Initialize Component() 处收到此异常：我认为问题出在 XAML 代码中的网格中，有什么想法吗？

System.Windows.Markup.XamlParseException 发生 Message=“System.Windows.Controls.Border.Child”属性设置了多次。StackTrace：在 Minimal.MainPage.InitializeComponent() 在 Minimal.MainPage..ctor() 的 System.Windows.Application.LoadComponent(Object component, Uri resourceLocator) InnerException：

```
 <basics:GridSplitter Grid.Column="1" HorizontalAlignment="Stretch" />

            <Grid Margin="5" Grid.Column="2" Background="White" VerticalAlignment="Stretch">
                <Grid.RowDefinitions>
                    <RowDefinition Height="40" />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="0" Margin="2" Orientation="Horizontal">
                    <TextBox Name="SearchTextBox" Text="JOHN" VerticalAlignment="Center" Width="100"
                     HorizontalAlignment="Left" Margin="2,2,5,2" />
                    <Button Content="Search by owner name" Click="Button_Click" 
                    Margin="2" VerticalAlignment="Center" HorizontalAlignment="Right" />
                </StackPanel>
                <ScrollViewer Grid.Row="1">
                    <esri:FeatureDataGrid x:Name="MyDataGrid"
            Map="{Binding ElementName=MyMap}" 
            GraphicsLayer="{Binding ElementName=MyMap, Path=Layers.[MontgomeryParcels]}" />
                </ScrollViewer>
            </Grid>

        </Border>

    </userControls:DraggableWindow> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:34:51.157

由于我们只能看到一个边框的结束标签，并且我看到您在该边框（您的`GridSplitter`和您的`Grid`）中塞满了多件东西我会说没有看到整个片段您需要为该边框中的所有对象提供一个父容器而且你会很高兴，因为 Border 只接受一个孩子。

例如，而不是；

```
<Border>
    <Object/>
    <Object/>
    <Object/>
</Border> 
```

你需要更多类似的东西；

```
<Border>
    <ContentContainer><!-- Grid, or StackPanel, or whatever you choose -->
        <Object/>
        <Object/>
        <OBject/>
    </ContentContainer>
</Border> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:29:14.720

I fixed the problem-removed code from grid inside draggable window to main project grid. It is now a menu item.

# visual-studio-2012 - Visual Studio 2012 - 编码的 UI 测试在网页中找不到控件

> ID：14176004
> 
> 赞同：2
> 
> 时间：2013-01-05T20:20:09.157
> 
> 标签：visual-studio-2012, coded-ui-tests

我有一个简单的登录/注销序列，但测试总是失败并显示以下消息：

播放未能找到具有给定搜索属性的控件

它出现在登录过程中，应该写入用户名。生成的代码看起来不错，尝试逐步调试并且控件存在，但是当它到达该部分时测试失败。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T02:12:26.727

您可能忘记将焦点设置在文本字段上并添加断言。将十字准线拖到文本字段上并将它们添加为断言，然后生成代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T15:43:01.803

我会建议你尝试手动编码。使用 VS2012 编码的 UI API 非常简单易用。

另外，如果上述方法不起作用，那么您可以添加您的 html 片段和 uimap 设计器代码吗？

# java - 为什么重新开放后舞台大小和位置没有保持？

> ID：14176006
> 
> 赞同：2
> 
> 时间：2013-01-05T20:20:20.933
> 
> 标签：java, user-interface, javafx, javafx-2

当用户移动并关闭它时，我想保留`Stage`屏幕上的最后一个位置。`Stage`在 Swing 中，如果我保留同一个窗口实例，它会在移动、关闭和重新打开后显示在同一个位置。为什么`Stage`在 JavaFX 中总是显示在同一位置？

在下面检查我的代码示例：

```
aboutStage = new Stage();
aboutStage.setTitle("About " + Constants.APP_TITLE);
aboutStage.setResizable(false);
aboutStage.initModality(Modality.APPLICATION_MODAL);
aboutStage.initOwner(primaryStage);
aboutStage.initStyle(StageStyle.UTILITY);

Parent page = (Parent) FXMLLoader.load(
        AboutWindowController.class.getResource("about.fxml"));
Scene scene = new Scene(page);
aboutStage.setScene(scene);

miAbout.setOnAction(new EventHandler<ActionEvent>() {
    @Override
    public void handle(ActionEvent t) {
        Stage about = mainClass.getAboutStage();
        about.show();
    }
}); 
```

Swing 代码示例：

```
public class SwingTest {

    public static void main(String[] args) {
        JFrame f = new JFrame();
        JButton b = new JButton("Show Dialog");
        final JDialog d = new JDialog(f);
        d.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);
        d.setSize(300, 300);
        b.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                d.setVisible(true);
            }
        });
        JPanel p = new JPanel();
        p.add(b);
        f.add(p);
        f.pack();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }

} 
```

如果您测试此代码，请打开对话框并移动它，然后关闭并重新打开它。您将看到对话框在重新打开时处于相同状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T15:01:38.013

在您的 SWING 实现中，您正在处理将其标记为不可显示的窗口。当您重新显示 JDialog 时，Swing API 会以与释放它相同的状态创建它。查看[文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/Window.html#dispose%28%29)

在 JavaFX 的情况下，无论是用 hide() 方法隐藏窗口还是用 close() 方法关闭窗口，都无法再现 stage 的状态（当然除非你手动编程）。查看[讨论](https://stackoverflow.com/questions/10212366/javafx-2-0-closing-a-stage-window) 不幸的是，这就是 API 的创建方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:28:33.497

无法完全理解问题。您能否更准确地说明您如何在秋千的同一位置显示窗口。

据我了解，关闭窗口后窗口出现在同一位置的唯一方法是使用 JFrame 的默认行为，即隐藏窗口（不退出）。而在 JavaFX 场景的情况下，您正在加载一个新资源，这就像从头开始打开一个新窗口一样。

另请注意，您可以将 Swing 与 JavaFX 集成。点击[这里](http://java.dzone.com/articles/integrating-javafx-20-swing)了解更多

# objective-c - ECSlidingViewController，禁用旋转iOS6

> ID：14176013
> 
> 赞同：0
> 
> 时间：2013-01-05T20:21:20.200
> 
> 标签：objective-c, ios, ios6, autorotate

在 iOS6 中遇到自动旋转问题，对其进行了排序，现在破坏了 ECSlidingViewController。

在应用程序委托中，我有：

```
slidingViewController.topViewController = [storyboard instantiateViewControllerWithIdentifier:@"Home"]; 
```

然后，我的旋转方法不起作用。所以我补充说：

```
[self.window setRootViewController:myController]; 
```

并删除上面的代码，然后 bam，旋转方法有效，但显然会破坏我的 ECSlidingViewController。我怎样才能很好地合作？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-19T13:06:13.810

您应该在那里创建子类`ECSLidingViewController`并实现旋转方法。所以你应该使用你的自定义类而不是原始类（不要忘记故事板）。

# c++ - 用 C++ 编写 html 网站的脚本？

> ID：14176018
> 
> 赞同：0
> 
> 时间：2013-01-05T20:21:40.540
> 
> 标签：c++, html, web

我想知道是否有一种方法可以用 c++ 来编写网站脚本，而不是使用 javascript？我放

```
<script type = "text/c++" src="script.cpp">//code here</script> 
```

?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:25:58.633

跨浏览器可靠（在脚本元素中）支持的唯一语言是 JavaScript。

Internet Explorer 还支持 VBScript。给定一个来自 ActiveState 的插件（我认为现在可能已经停产）IE 也支持 PerlScript。

您可以使用 ActiveX 嵌入用 C++ 编写的程序——但这需要在 x86 硬件上的 Windows 上使用 Internet Explorer（因此不是 Windows 8 RT），并且默认安全设置会阻止它。

您可以将任何您喜欢的语言用于服务器端代码，前提是您可以将其与网络服务器连接。CGI 和 FastCGI 提供标准接口以及大多数语言的支持库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-05-01T19:51:37.417

是的，但是您需要使用像 TreeFrog 这样的 Web 框架。TreeFrog 是一个全栈 Web 开发框架，因此您可以在前端和后端使用 C++。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T20:27:21.007

是的，只要您编写自己的包含 C++ 编译器（或解析器）的浏览器，这将起作用。请告诉我是哪个浏览器，这样我就可以确保它永远不会靠近我的任何机器，因为我绝对不希望在我的机器上运行一个成熟的 C++ 程序 - 怎么说它没有代码它会对我的机器造成伤害（删除文件、写入注册表等）？

如果您确实希望您的网络客户端拥有您的私有程序，您最好将其分发到已编译的可执行文件或浏览器插件中[但请注意，像我一样，许多其他人可能不会下载它，除非您是其中的一部分有声望的组织]。

# c++ - C++ 覆盖地址运算符

> ID：14176019
> 
> 赞同：0
> 
> 时间：2013-01-05T20:21:44.547
> 
> 标签：c++, operator-keyword

我希望能够在 C++ 标准编译器中做到这一点：

```
void DoSomething(Object* object) { }

DoSomething(&Object()) 
```

使用默认地址运算符，它会将构造的对象保存到寄存器中，然后在 DoSomething() 中覆盖它......在一行中为所有对象执行此操作非常好（除了不能覆盖的基本类型他们）。

所以这就是我所拥有的：

```
class Object
{
    public:
        Object* operator&(Object object) { return &object; }
}; 
```

这显然只是一个重复循环，无法指定我想要基本的 & 运算符，而不是覆盖的运算符。当我调用 DoSomething(&Object()) 时也不会调用它。这可能吗？它会使初始化复杂类型变得更容易，所以它很重要。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T20:26:07.693

你可以在 C++11 中这样做：

```
class Object
{
    public:
};

Object* operator&(Object&& object) { return std::addressof(object); }
Object const* operator&(Object const&& object) { return std::addressof(object); } 
```

* * *

所有对象：

```
template<typename T>
T* operator&(T&& x) {
    return std::addressof(x);
} 
```

* * *

请不要这样做。人们会因此而恨你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:27:31.273

*在C++*中通常不会这样做。有办法做到这一点，但只是自找麻烦。相反，*C++*解决方案可以：

```
void DoSomething( Object const& object ){ ... } 
```

但也许您还需要能够对*非常量*对象进行操作。在这种情况下，你会这样做：

```
void DoSomething( Object& object ){ ... } // operate on an lvalue, object with a name
void DoSomething( Object&& object ){ ... } // operate on an rvalue, either temporary or moved object 
```

根据您实际尝试做的事情，解决方案会大不相同。

# java - VTD-XML：如何不从根元素执行 XPath 查询

> ID：14176020
> 
> 赞同：1
> 
> 时间：2013-01-05T20:21:47.467
> 
> 标签：java, xml, xpath, vtd-xml

我需要处理大型 XML 文件，因此我决定从 DOM 解析器转向 VTD-XML。

当我使用 Java 的 DOM 解析器时，我可以从任何节点评估 XPath 查询，而不是从根。查看[XPath.evaluate](http://goo.gl/3Je5Q)原型：

```
Object evaluate(String expression,
                Object item,
                QName returnType)
                   throws XPathExpressionException 
```

`Object item`是起始上下文（例如一个节点）。这非常有用。

但是我找不到在 VTD-XML 中做同样事情的方法。我已经阅读了它的 API 并阅读了许多示例，例如，[this one](http://goo.gl/3Je5Q)，但是所有查询都是从根目录执行的。

怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:10:46.840

好的，看来我明白了：实际上，XPath 查询总是相对于当前`VTDNav`的光标位置执行。

查看[此示例](http://goo.gl/vcPUa)，查找“嵌套 XPath 支持”部分。

# css - 如何使用过滤器：对于不会影响 ie9 的 ie8？

> ID：14176021
> 
> 赞同：0
> 
> 时间：2013-01-05T20:21:54.317
> 
> 标签：css, internet-explorer-8, internet-explorer-9, sass

我有一个 sass mixin，可以让我定义 alpha 背景

```
@mixin background-rgba($r,$g,$b,$a) {

    $color: ie_hex($r,$g,$b,$a);
    $value: unquote("progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=##{$color},endColorstr=##{$color})");

    //ie
    -ms-filter: $value;
    filter: $value;
    zoom: 1;

    background-color: transparent\9;
  // Good browsers.
    background-color: rgba($r,$g,$b,$a); 
```

这适用于 IE 7-8，但过滤器规则正在被 IE9 采用。我意识到我可以在中使用条件标签，`<head>`但这并不是我真正需要的。我需要能够在所有地方使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T03:11:46.437

您希望避免在 中使用条件标签`<head>`来提供 IE 特定的 CSS（据我了解您的说法）。否则我可以想到两个想法：

## IE9 类

不确定您是否也反对使用条件注释在[or](https://stackoverflow.com/questions/5852681/target-ie9-or-ie8-but-not-both-using-css)[标记](https://stackoverflow.com/questions/5852681/target-ie9-or-ie8-but-not-both-using-css)[上设置类`html``body`](https://stackoverflow.com/questions/5852681/target-ie9-or-ie8-but-not-both-using-css)？或者除此之外，使用 javascript 设置一个类似的类。然后你可以预设 mixin 来生成一个...

```
.ie9 .yourSelectorUsingtheMixin { filter: none; ms-filter: none; } 
```

...在使用`background-rgba`mixin 的主要条目之后。

## @媒体黑客

[这篇文章](https://stackoverflow.com/questions/3890740/are-there-any-ie9-css-hacks)记录了一个针对 IE9 的 hack，它结合`@media`了一个真正的 hack 操作`\0/`，其形式如下：

```
@media all and (min-width:0) {
    .yourSelectorUsingtheMixin { 
       filter: none \0/; 
       -ms-filter: none \0/;
    } 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T04:04:28.350

这最终对我有用，基本上关闭了 IE9 的过滤器。我对这个解决方案不满意，但现在必须这样做。

```
-ms-filter: "progid:DXImageTransform.Microsoft.gradient(enabled=false)" !important; /* ie9 requires quotes */ 
```

# php - 无法使用 Jquery 显示来自 JSON 的数据库结果

> ID：14176023
> 
> 赞同：0
> 
> 时间：2013-01-05T20:22:07.463
> 
> 标签：php, jquery, json, codeigniter, codeigniter-2

我有 Codeigniter 应用程序，它从数据库中获取数据作为结果数组，将数据转换为 Json 并显示结果。但是，我一直未定义为显示结果。

模型

```
 $this->db->where('product_name',$sid);
      //  $this->db->select('product_title');
        $res = $this->db->get('products');
         $data = $res->result_array();  
         return $data; 
```

看法：

```
<script language="javascript">
    $('#findsubmit').click(function() {
        $.get("/products/index.php/find/lookup",{id : $('#id').val() },function(data) {

            $('#result').html('Product name: ' + data.product_name);
            //+ ' Last name: ' + data.lastname);
        },"json");
        return false;
});
</script> 
```

我在 Firebug 中收到的结果数组：

```
[{"category":"camera","product_name":"Sony HX20"},{"category":"camera","product_name":"Canon SZ220"}] 
```

如果我创建这样的简单数组一切正常：

```
return array('category' => 'camera','product_name' => 'Sony HX20'); 
```

我在 Firebug 中收到的结果数组：

```
{"category":"camera","product_name":"Sony HX20"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:50:59.723

在您的 JSON 数据中，您会收到一个包含多个结果的数组：`data.product_name`未定义，但`data[0].product_name`和`data[1].production_name`是。

您应该尝试仅返回一个结果（例如您手动构建的结果），或者在`data`.

编辑：这是一个关于如何使用的示例`$.each`：

```
var names = 'Product name: ';
$.each(data, function(index, element) {
    if (index > 0) {names += '; ';}
    names += element.product_name;
});
$('#result').html(names); 
```

# android - 不在 LogCat 中编写

> ID：14176025
> 
> 赞同：1
> 
> 时间：2013-01-05T20:22:10.447
> 
> 标签：android, logcat

这不应该在信息下的 LogCat 上吗？它没有出现

```
 protected void onDraw(Canvas canvas) {
    xp1 = canvas.getWidth()/2;
    **Log.i("Test", "Good");**
    xp2 = canvas.getWidth()/2;
    yp1 = 25;
    yp2 = 760;
    canvas.drawColor(Color.BLACK);
    canvas.drawBitmap(paddle1, xp1,yp1, null);
    canvas.drawBitmap(paddle2,xp2,yp2, null);
    Paint white = new Paint();
    white.setColor(Color.WHITE);
    canvas.drawText("Score P1:"+ p1Score +" P2: " + p2Score , 700, 20,white );  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:38:35.713

请检查此示例图像:)（右键单击以打开实际大小的图像）

![在此处输入图像描述](../Images/80c73f7054be4403dbe74f75b32b5f53.png)

# visual-studio-2012 - Visual Studio 2012 智能感知

> ID：14176026
> 
> 赞同：1
> 
> 时间：2013-01-05T20:22:17.427
> 
> 标签：visual-studio-2012, intellisense

我对 VS2012 有一个小问题，我以前从未使用过它，所以......这是我的问题，我有一个名为 age 的变量。但是当我开始输入 if(age 然后按 space 时，VS 会自动为许多其他单词写“AggregateException”等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-07T16:35:52.860

您可能对启用**Intellisense Suggestion Mode**感兴趣，请参阅[此处](http://blogs.msdn.com/b/zainnab/archive/2010/01/22/intellisense-suggestion-mode-vstipedit0012.aspx)了解更多信息。

您可以通过在文本编辑器中按`Ctrl`++`Alt`来启用它。`Space`启用后，Intellisense 只会在您按下`Tab`键或双击列表中的项目时自动完成。

这允许您键入句号、空格字符和其他特殊字符，而不会妨碍 Intellisense（对于测试驱动的开发非常方便）！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:24:22.690

在错误的上下文中输入单词会产生意想不到的行为。

确保您在正确的位置输入。

```
public class Test
{
    public void Met()
    {
        int age;
    }

    public void Met2()
    {
        age /* invalid scope for age */
    }
} 
```

# c# - 为什么LogicalCallContext 不适用于异步？

> ID：14176028
> 
> 赞同：27
> 
> 时间：2013-01-05T20:22:30.543
> 
> 标签：c#, .net, synchronization, task-parallel-library, async-await

在这个[问题](https://stackoverflow.com/questions/9781321/how-to-manage-an-ndc-like-log4net-stack-with-async-await-methods-per-task-stac)中，Stephen Cleary 接受的答案说 LogicalCallContext 不能与异步一起正常工作。他还在[此](http://social.msdn.microsoft.com/Forums/en-US/async/thread/ea21ca57-5340-439c-8ee9-f0185b5787a1)MSDN 线程中发布了有关它的信息。

LogicalCallContext 保持一个 Hashtable 存储发送到 CallContext.LogicalGet/SetData 的数据。它只做这个 Hashtable 的浅拷贝。所以如果你在其中存储一个可变对象，不同的任务/线程会看到彼此的变化。这就是 Stephen Cleary 的示例 NDC 程序（发布在该 MSDN 线程上）无法正常工作的原因。

但是 AFAICS，如果你只在 Hashtable 中存储不可变数据（也许通过使用[不可变集合](http://blogs.msdn.com/b/bclteam/archive/2012/12/18/preview-of-immutable-collections-released-on-nuget.aspx)），那应该可以，让我们实现一个 NDC。

然而，斯蒂芬克利里也在接受的答案中说：

> CallContext 不能用于此。Microsoft 特别[建议](https://connect.microsoft.com/VisualStudio/feedback/details/276325/provide-better-context-support-to-async-operations)不要将 CallContext 用于除远程处理之外的任何事情。更重要的是，逻辑 CallContext 不了解异步方法如何提前返回并稍后恢复。

不幸的是，指向 Microsoft 建议的链接已关闭（未找到页面）。所以我的问题是，为什么不推荐这样做？为什么我不能以这种方式使用LogicalCallContext？说它不理解异步方法是什么意思？从调用者的 POV 来看，它们只是返回任务的方法，不是吗？

ETA：另见[this other question](https://stackoverflow.com/questions/13010563/using-threadstatic-variables-with-async-await)。在那里，Stephen Cleary 的回答说：

> 您可以使用 CallContext.LogicalSetData 和 CallContext.LogicalGetData，但我建议您不要使用，因为当您使用简单并行时它们不支持任何类型的“克隆”

这似乎支持我的观点。所以我*应该*能够构建一个 NDC，这实际上是我所需要的，只是不适用于 log4net。

我写了一些示例代码，它似乎可以工作，但仅仅测试并不总是能发现并发错误。因此，由于其他帖子中暗示这可能行不通，我仍然在问：这种方法有效吗？

**ETA：**当我从下面的答案运行斯蒂芬提出的复制时），我没有得到他说我会的错误答案，我得到了正确的答案。即使他说“这里的LogicalCallContext 值始终为“1””，我总是得到正确的值0。这可能是由于竞争条件吗？无论如何，我仍然没有在我自己的计算机上重现任何实际问题。这是我正在运行的确切代码；它在这里只打印“真”，斯蒂芬说它应该至少在某些时候打印“假”。

```
private static string key2 = "key2";
private static int Storage2 { 
    get { return (int) CallContext.LogicalGetData(key2); } 
    set { CallContext.LogicalSetData(key2, value);} 
}

private static async Task ParentAsync() {
  //Storage = new Stored(0); // Set LogicalCallContext value to "0".
  Storage2 = 0;

  Task childTaskA = ChildAAsync();
  // LogicalCallContext value here is always "1".
  // -- No, I get 0
  Console.WriteLine(Storage2 == 0);

  Task childTaskB = ChildBAsync();
  // LogicalCallContext value here is always "2".
  // -- No, I get 0
  Console.WriteLine(Storage2 == 0);

  await Task.WhenAll(childTaskA, childTaskB);
  // LogicalCallContext value here may be "0" or "1".
  // -- I always get 0
  Console.WriteLine(Storage2 == 0);
}

private static async Task ChildAAsync() {
  var value = Storage2; // Save LogicalCallContext value (always "0").
  Storage2 = 1; // Set LogicalCallContext value to "1".

  await Task.Delay(1000);
  // LogicalCallContext value here may be "1" or "2".
  Console.WriteLine(Storage2 == 1);

  Storage2 = value; // Restore original LogicalCallContext value (always "0").
}

private static async Task ChildBAsync() {
  var value = Storage2; // Save LogicalCallContext value (always "1").
  Storage2 = 2; // Set LogicalCallContext value to "2".

  await Task.Delay(1000);
  // LogicalCallContext value here may be "0" or "2".
  Console.WriteLine(Storage2 == 2);

  Storage2 = value; // Restore original LogicalCallContext value (always "1").
}

public static void Main(string[] args) {
  try {
    ParentAsync().Wait();
  }
  catch (Exception e) {
    Console.WriteLine(e);
  } 
```

所以我重申的问题是，上面的代码有什么问题（如果有的话）？

此外，当我查看 CallContext.LogicalSetData 的代码时，它会调用 Thread.CurrentThread.GetMutableExecutionContext() 并对其进行修改。GetMutableExecutionContext 说：

```
if (!this.ExecutionContextBelongsToCurrentScope)
    this.m_ExecutionContext = this.m_ExecutionContext.CreateMutableCopy();
  this.ExecutionContextBelongsToCurrentScope = true; 
```

并且 CreateMutableCopy 最终对保存用户提供的数据的 LogicalCallContext 的 Hashtable 进行浅拷贝。

所以试图理解为什么这段代码对斯蒂芬不起作用，是因为 ExecutionContextBelongsToCurrentScope 有时有错误的值吗？如果是这种情况，也许我们可以注意到它何时发生 - 通过查看当前任务 ID 或当前线程 ID 已更改 - 并手动将单独的值存储在我们的不可变结构中，以线程 + 任务 ID 为键。（这种方法存在性能问题，例如保留死任务的数据，但除此之外它还能工作吗？）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-06T01:01:19.483

**更新：**这个答案对于 .NET 4.5 是不正确的。有关详细信息，请参阅[我的博客文章`AsyncLocal`](http://blog.stephencleary.com/2013/04/implicit-async-context-asynclocal.html)。

这是情况（在您的问题中重复几点）：

*   `LogicalCallContext`会`async`随叫随到；您*可以*`async`使用它来设置一些隐式数据并从调用堆栈下方的方法中读取它。
*   的所有副本`LogicalCallContext`都是浅副本，最终用户代码无法挂接到深副本类型的操作中。
*   当您使用 进行“简单并行”时，各种方法之间`async`只有一个`LogicalCallContext` *共享副本。*`async`

`LogicalCallContext` *如果*您的`async`代码都是线性的，则可以正常工作：

```
async Task ParentAsync()
{
  ... = 0; // Set LogicalCallContext value to "0".

  await ChildAAsync();
  // LogicalCallContext value here is always "0".

  await ChildBAsync();
  // LogicalCallContext value here is always "0".
}

async Task ChildAAsync()
{
  int value = ...; // Save LogicalCallContext value (always "0").
  ... = 1; // Set LogicalCallContext value to "1".

  await Task.Delay(1000);
  // LogicalCallContext value here is always "1".

  ... = value; // Restore original LogicalCallContext value (always "0").
}

async Task ChildBAsync()
{
  int value = ...; // Save LogicalCallContext value (always "0").
  ... = 2; // Set LogicalCallContext value to "2".

  await Task.Delay(1000);
  // LogicalCallContext value here is always "2".

  ... = value; // Restore original LogicalCallContext value (always "0").
} 
```

`async`但是一旦你使用了我所说的“简单并行”（开始几个方法然后使用`Task.WaitAll`或类似的方法） ，事情就不那么好了。这是一个类似于[我的 MSDN 论坛帖子](http://social.msdn.microsoft.com/Forums/en-US/async/thread/ea21ca57-5340-439c-8ee9-f0185b5787a1#a6d5ce0e-53bb-47e3-a3ee-d84d6f062dcb)的示例（为简单起见，假设是非并行的`SynchronizationContext`，例如 GUI 或 ASP.NET）：

**编辑：代码注释不正确；请参阅有关此问题和答案的评论**

```
async Task ParentAsync()
{
  ... = 0; // Set LogicalCallContext value to "0".

  Task childTaskA = ChildAAsync();
  // LogicalCallContext value here is always "1".

  Task childTaskB = ChildBAsync();
  // LogicalCallContext value here is always "2".

  await Task.WhenAll(childTaskA, childTaskB);
  // LogicalCallContext value here may be "0" or "1".
}

async Task ChildAAsync()
{
  int value = ...; // Save LogicalCallContext value (always "0").
  ... = 1; // Set LogicalCallContext value to "1".

  await Task.Delay(1000);
  // LogicalCallContext value here may be "1" or "2".

  ... = value; // Restore original LogicalCallContext value (always "0").
}

async Task ChildBAsync()
{
  int value = ...; // Save LogicalCallContext value (always "1").
  ... = 2; // Set LogicalCallContext value to "2".

  await Task.Delay(1000);
  // LogicalCallContext value here may be "0" or "2".

  ... = value; // Restore original LogicalCallContext value (always "1").
} 
```

问题是 ,和之间`LogicalCallContext`共享*,*没有任何方式挂钩或强制进行深度复制操作。在“线性”示例中，上下文也是共享的，但一次只有一个方法处于活动状态。`ParentAsync``ChildAAsync``ChildBAsync`

即使您存储的数据`LogicalCallContext`是不可变的（如在我的整数示例中），您仍然必须更新该`LogicalCallContext`值才能实现 NDC，这意味着共享无副本问题将把它搞砸。

我对此进行了详细调查，并得出结论认为不可能有解决方案。如果你能想出一个，我会很高兴被证明是错误的。:)

PS Stephen Toub 指出，`CallContext`仅用于远程处理的建议（无故给出，IIRC）不再适用。我们可以随意使用`LogicalCallContext`……如果我们可以让它工作的话。;)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-07T09:32:11.340

Stephen 确认这适用于 .Net 4.5 和 Win8/2012。未在其他平台上进行测试，并且已知至少不能在其中一些平台上工作。所以答案是微软将他们的游戏整合在一起，并在至少最新版本的 .Net 和异步编译器中修复了潜在问题。

所以答案是，它确实有效，只是不适用于较旧的 .Net 版本。（所以 log4net 项目不能用它来提供一个通用的 NDC。）

# php - Zend 框架 2.0.6 CLI 工具不工作

> ID：14176029
> 
> 赞同：0
> 
> 时间：2013-01-05T20:22:36.857
> 
> 标签：php, wamp, zend-framework2

近2天一直在挠头。我已经下载**了“Zend Framework 2.0.6 Minimal”**。我正在尝试将其设置为使用**"Wamp Server 2.2E"**工作。

因为我没有在 ZendFramework **bin**文件夹中找到 CLI 工具，所以我从[这里](http://framework.zend.com/svn/framework/standard/trunk/bin/)下载了**zf.bat**和**zf.php** ， 我将它们放在我的 wamp PHP 文件夹中（因为我已经有了它的路径视窗）

我还在我的**php.ini**文件中映射了库路径，该文件位于 wamp 上，因此它将是这样的：`D:\wamp\bin\php\ZendFramework\library`

现在，当我打开 Windows PowerShell 并键入 zf 时，我收到以下错误：

```
***************************** ZF ERROR ********************************
In order to run the zf command, you need to ensure that Zend Framework
is inside your include_path.  There are a variety of ways that you can
ensure that this zf command line tool knows where the Zend Framework
library is on your system, but not all of them can be described here.

The easiest way to get the zf command running is to give it the include
path via an environment variable ZEND_TOOL_INCLUDE_PATH or
ZEND_TOOL_INCLUDE_PATH_PREPEND with the proper include path to use,
then run the command "zf --setup".  This command is designed to create
a storage location for your user, as well as create the zf.ini file
that the zf command will consult in order to run properly on your
system.

Example you would run:

$ ZEND_TOOL_INCLUDE_PATH=/path/to/library zf --setup

Your are encourged to read more in the link that follows.
Zend_Tool & CLI Setup Information
(available via the command line "zf --info")
   * Home directory found in environment variable HOMEPATH with value \Users\Shahar Galukman
   * Storage directory assumed in home directory at location \Users\Shahar Galukman/.zf/
   * Storage directory does not exist at \Users\Shahar Galukman/.zf/
   * Config file assumed in home directory at location \Users\Shahar Galukman/.zf.ini
   * Config file does not exist at \Users\Shahar Galukman/.zf.ini

To change the setup of this tool, run: "zf --setup" 
```

因此，即使所有路径似乎都井井有条，但我仍然收到此错误。

我在安装 CLI 时使用了[Zend 指南](http://framework.zend.com/manual/1.12/en/zend.tool.framework.clitool.html)

并且还发现了一个[问题here](https://stackoverflow.com/questions/6507844/zend-tool-problem)，它的答案对我没有帮助

我还应该做什么？Zend 框架 2.0.6 甚至可以使用 CLI 吗？是否有另一种解决方案来管理和舒适地使用 Zend 框架？

感谢您提供的任何帮助，沙哈尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T00:52:25.713

Zend Framework 2 没有 Zend Framework 1 那样的 CLI 工具。它仍在开发中，可能会也可能不会很快发布。ZF1 工具不适用于 ZF2！这就是为什么它毕竟不包括在内的原因；）

# c++ - exe导入dll序号到dll导出函数名比较？

> ID：14176030
> 
> 赞同：0
> 
> 时间：2013-01-05T20:22:44.203
> 
> 标签：c++, c, winapi, reverse-engineering, portable-executable

在将任何 .exe 加载到我的命令行程序中时。我得到这个输出： http: [//www.privatepaste.com/22dc18e88d/output](http://www.privatepaste.com/22dc18e88d/output)

从输出中可以看出。我得到 21 个导入的 dll。

当我继续解析命令行参数.exe的pe文件格式的信息时，它会导入wsock32.dll。我懂了：

wsock32.dll 导入都是序数。由 80000000 标志看到。去掉所有这些，你会得到：

```
[Import_By_Ordinal]: 00000016 
[Import_By_Ordinal]: 00000003 
[Import_By_Ordinal]: 00000073 
[Import_By_Ordinal]: 00000017 
[Import_By_Ordinal]: 00000015 
[Import_By_Ordinal]: 0000000B 
[Import_By_Ordinal]: 00000014 
[Import_By_Ordinal]: 0000000E 
[Import_By_Ordinal]: 0000000A 
[Import_By_Ordinal]: 00000034 
[Import_By_Ordinal]: 00000011 
[Import_By_Ordinal]: 00000013 
[Import_By_Ordinal]: 00000010 
[Import_By_Ordinal]: 00000009 
[Import_By_Ordinal]: 00000002 
[Import_By_Ordinal]: 00000008 
[Import_By_Ordinal]: 0000006F 
[Import_By_Ordinal]: 00000097 
[Import_By_Ordinal]: 00000012 
[Import_By_Ordinal]: 00000004 
[Import_By_Ordinal]: 0000000F 
[Import_By_Ordinal]: 0000000C 
```

现在通过解析 EXE 的 pe 文件格式可以看到这些信息。显然我们将无法获得这些函数的名称。

如果我想查看 00000016 序数，我将不得不使用 dumpbin 或 cff explorer，然后加载 wsock32.dll 并查看其导出以找出与 00000016 相关的函数。

我不想那样做。我想要 ac 或 c++ 方式获取 00000016 并以某种方式打开 wsock32.dll 并将其导出表与我从 exe 获得的序数进行比较。

目前这就是我获得序数的方式：

```
// Start Iterating Tables
nFunctions = 0 ;
nOrdinalFunctions = 0 ; 
while( (*thunkINT).u1.AddressOfData != 0 ) /* AddressOfData holds RVA
                                              to INT with the imported API name */
{
    /* Each IMAGE_THUNK_DATA structures are indicated by zero values when
       you reach the end */
    // If the high bit isn't set, the IMAGE_THUNK_ DATA value is an RVA to the IMAGE_IMPORT_BY_NAME.
    if( !( thunkINT->u1.AddressOfData & IMAGE_ORDINAL_FLAG ) )
    {
        nameData = (PIMAGE_IMPORT_BY_NAME)( (*thunkINT).u1.AddressOfData );
        nameData = (PIMAGE_IMPORT_BY_NAME)rvaToPtr( (DWORD)nameData,
                                                    peHeader,
                                                    (DWORD)baseAddress );
        printf( "\t%s", (*nameData).Name );
        printf( "\n" );
    }
    // Check OriginalFirstThunk ordinal and see if flag is set
    // if flag is set, function is called by ordinal number. ( import by ordinal )
    if( ( (*thunkINT).u1.Ordinal & IMAGE_ORDINAL_FLAG ) )
    {
        printf( " [Import_By_Ordinal]:\t" );
        printf( "\taddress: %08X", thunkINT->u1.Ordinal );
        printf( "\n" );
        nOrdinalFunctions++ ;
    }
    thunkINT++;
    thunkIAT++;
    nFunctions++;

} // End of while loop 
```

所以，我想知道在解析 EXE 的 IMPORTS 时...有没有办法将 IMPORT ORDINAL 与 DLL EXPORT ORDINAL 匹配？并找到序数的函数名称？

我想要 ac 或 c++ 的方式来做到这一点。

谢谢，如果有人知道我正在寻找的知识。由于这些东西非常复杂，而且我正在尝试做的事情并不为很多人所熟知。

我希望有人能帮帮忙...

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:44:10.760

Windows API 显然没有执行此转换的功能。它甚至没有列出库导出的 API，尽管[这应该相对容易](https://stackoverflow.com/questions/1128150/win32-api-to-enumerate-dll-export-functions)。也许您可以尝试修改该代码以提取从序数到名称的映射。

# android - 如何更改列表视图中列的宽度

> ID：14176031
> 
> 赞同：0
> 
> 时间：2013-01-05T20:22:49.493
> 
> 标签：android, listview

我有一个列表视图，它有 4 列，每列 150dp 宽。对于给定的行，如果第一列中的文本是“desc”，那么我希望该行的第一列宽度为 150dp，第二列宽度为 450dp，最后两列基本上为 0。是否可以做这个。谢谢。

# perl - Activeperl 是否将 Windows 'stdlib' 用于 rand 函数

> ID：14176032
> 
> 赞同：0
> 
> 时间：2013-01-05T20:22:57.230
> 
> 标签：perl, std, srand, activeperl

有谁知道 Activeperl 是否将 Windows 'stdlib' 用于 rand 和 srand 函数？我正在使用 perl 5.16。提前感谢您的回复。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-17T16:10:51.907

```
my $s = 4071;
my  $rnd = sub {return (($s = ($s * 214013 + 2531011) % 2 ** 31) >> 16 )};
foreach(0..51){print $rnd->()," "}
print "\n";
srand(4071);
foreach(0..51){print rand()*2**15," "}
print "\n"; 
```

[Deal_cards_for_FreeCell#Perl](http://rosettacode.org/wiki/Deal_cards_for_FreeCell#Perl)

# python - ReadDirectoryChangesW 似乎缺少事件

> ID：14176036
> 
> 赞同：4
> 
> 时间：2013-01-05T20:23:08.213
> 
> 标签：python, windows, readdirectorychangesw

我一直在尝试让 ReadDirectoryChangesW 监视子树的文件更改，但我发现我得到的结果不一致。以下是一个说明问题的自包含测试用例。当我运行它时，它有时会产生：

```
A : Created
C : Updated
A : Deleted 
```

下一次它可能会产生：

```
A : Created
B : Updated
C : Updated
A : Deleted 
```

我创建了一个巨大的缓冲区，并且被更改的文件数量非常少（3 个文件）。

编码：

```
import os, sys, time, threading
import win32file, win32event, win32con, pywintypes

class ChangeFiles ( threading.Thread ) :
    def run( self ) :
        files = [ 'A', 'B', 'C' ]
        time.sleep( 1 )
        for path in files : f = open( path, 'w' ); f.write( 'mooo' ); f.close()
        time.sleep( 0.5 )
        for path in files : os.remove( path )

ChangeFiles().start()

FILE_LIST_DIRECTORY = 0x0001

handle = win32file.CreateFile (
  '.',
  FILE_LIST_DIRECTORY,
  win32con.FILE_SHARE_READ | win32con.FILE_SHARE_WRITE | win32con.FILE_SHARE_DELETE,
  None,
  win32con.OPEN_EXISTING,
  win32con.FILE_FLAG_BACKUP_SEMANTICS | win32file.FILE_FLAG_OVERLAPPED,
  None
)

buffer = win32file.AllocateReadBuffer( 1024 * 64 )
overlapped = pywintypes.OVERLAPPED()
overlapped.hEvent = win32event.CreateEvent( None, 0, 0, None )

readFlags = win32con.FILE_NOTIFY_CHANGE_FILE_NAME  | \
            win32con.FILE_NOTIFY_CHANGE_DIR_NAME   | \
            win32con.FILE_NOTIFY_CHANGE_ATTRIBUTES | \
            win32con.FILE_NOTIFY_CHANGE_SIZE       | \
            win32con.FILE_NOTIFY_CHANGE_LAST_WRITE | \
            win32con.FILE_NOTIFY_CHANGE_SECURITY

ACTIONS = { 1 : "Created", 2 : "Deleted", 3 : "Updated" }

while 1 :
    win32file.ReadDirectoryChangesW( handle, buffer, False, readFlags, overlapped )

    rc = win32event.WaitForSingleObject( overlapped.hEvent, 200 )

    if rc == win32event.WAIT_OBJECT_0 :
        nbytes = win32file.GetOverlappedResult( handle, overlapped, True )
        if nbytes > 0 :
            for action, file in win32file.FILE_NOTIFY_INFORMATION( buffer, nbytes ) :
                print '%s : %s' % ( file, ACTIONS.get ( action, "Unknown" ) )
        else :
            print 'no bytes'
            break
    elif rc < 0 :
        print 'Error: %d' % win32api.GetLastError()
        break 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-11-01T14:43:43.770

这里的问题是您传递给的超时`WaitForSingleObject`非常低，因此该函数往往会在您收到有关事件的通知之前超时。您的代码不会检查该条件，因此您看不到任何输出（`rc > 0`也尝试测试 ）。

您可以通过将`INFINITE`（即 0xFFFFFFFF）的值传递给`WaitForObject`.

# java - 运行 java 命令应用程序时无法从文件中读取

> ID：14176042
> 
> 赞同：0
> 
> 时间：2013-01-05T20:23:19.900
> 
> 标签：java, file, jar

我想制作一个简单的命令行 java 应用程序，它获取与应用程序的 jar 文件位于同一目录中的文件名作为参数，以便我可以从中读取。但是我收到了 FileNotFoundException。这是我的代码：

```
public static void main(String[] args) {
    if (args.length == 0) {
        System.out.println("Give the name of the input file as argument.");
    } else if (args.length > 1) {
        System.out.println("Only one input file is allowed");
    } else {
        try {
            BufferedReader in = new BufferedReader(new FileReader(args[0]));
            System.out.println("File found");
        } catch (FileNotFoundException e) {
            System.out.println("Could not find file " + args[0]);
        }
    }
} 
```

所以假设我在同一个目录中有一个名为 a.txt 的 txt 文件和 myApp.jar 文件。我启动 cmd 和 cd 到这个特定的目录，然后输入：

```
java -jar myApp.jar a.txt 
```

我得到“找不到文件a.txt”

我究竟做错了什么？

编辑：在考虑之后我猜该文件没有找到，因为它应该与类文件位于同一目录中，换句话说，在 jar 中。所以我的问题是，当它在 jar 文件之外时如何访问它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:53:22.757

当您启动应用程序时，“当前”目录将由环境决定。要找出它的位置，请将错误输出行更改为：

```
System.out.println("Could not find file " + (new File(args[0])).getCanonicalPath()); 
```

（您可能必须将 throws IOException 添加到您的 main() 声明中才能编译上述内容）。

如果您想访问类路径（或 jar）内的资源，请使用[ClassLoader.getResourceAsStream](http://docs.oracle.com/javase/6/docs/api/java/lang/ClassLoader.html#getResourceAsStream%28java.lang.String%29) - 然后您将使用[InputStreamReader](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/InputStreamReader.html)在返回的 InputStream 周围包装一个 Reader 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T23:46:18.023

检查这个......（你发现了什么）

```
public static void main(String[] args) throws IOException {
    if (args.length == 0) {
        System.out.println("Give the name of the input file as argument.");
    } else if (args.length > 1) {
        System.out.println("Only one input file is allowed");
    } else {
        try {
            BufferedReader in = new BufferedReader(new FileReader(args[0]));
            System.out.println("File found");
        } catch (FileNotFoundException e) {
            // Finding the dir
            String current = new java.io.File( "." ).getCanonicalPath();
            System.out.println("Current dir: " + current);
            System.out.println("Current user.dir: " + System.getProperty("user.dir"));
            //
            System.out.println("Could not find file " + args[0]);
        }
    }
} 
```

# php - 有人可以解释这些 if 语句在说什么吗？

> ID：14176046
> 
> 赞同：-2
> 
> 时间：2013-01-05T20:24:03.627
> 
> 标签：php

我是一个初学者，我有两组适用于表单的“if 语句”，它们几乎做同样的事情，但我想了解他们为什么这样做。当我打印错误并提交一个空表单时，第一个 if 语句会回显数组中的每个字段，并在每个字段旁边显示“需要”字样。至于第二个 if 语句，它只是回显“您没有填写所有类别”，如果与第一个 if 语句相呼应的特定字段为空，那么即使一个字段在表单中为空。Like if您可以逐步为我分解每组编码，那会很棒。你能推荐一个我可以学习语言的链接吗？谢谢！

```
<?php

    if(isset($_POST['registrationform'])){
        $required_fields = array('first_name', 'last_name', 'email', 'password', 'gender', 'month', 'day', 'year');
        foreach ( $required_fields as $key=>$value) {
         if (!isset($_POST[$value]) || $_POST[$value]=='') {
              $errors[$value] =$key." is required";
            }
            }  
            }
            print_r($errors);
?>   

<?php
if (empty($_POST) === false) {
        $required_fields = array('first_name', 'last_name', 'email', 'password', 'sex', 'birthday', 'terms_of_service');
        foreach ($_POST as $key=>$value) {
            if (empty($value) && in_array($key, $required_fields) === true) {
                $errors[] = 'You didn\'t fill in all of the categories.';
                break 1;
            }
            }
            }
            print_r($errors);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:31:46.303

*"isset() 如果变量存在则返回真，即使它是空的。empty() 如果变量不存在或如果它们的内容被认为是“空”（空字符串，0，NULL，假，数组）返回真没有元素）。它们真的很不同。我相信空（$var）等价于！（$var）。*

[http://www.webhostingtalk.com/archive/index.php/t-373975.html](http://www.webhostingtalk.com/archive/index.php/t-373975.html)

看到这个问题：[isset和empty有什么区别？](https://stackoverflow.com/questions/10870708/what-is-the-difference-between-isset-and-empty)

关于这两个功能的信息：

[http://us3.php.net/manual/en/function.empty.php](http://us3.php.net/manual/en/function.empty.php)

[http://us3.php.net/manual/en/function.isset.php](http://us3.php.net/manual/en/function.isset.php)

php学习教程：

[http://www.w3schools.com/php/default.asp](http://www.w3schools.com/php/default.asp)

# ajax - 什么是 RESTful 方式来表达两种查询资源列表的方式？

> ID：14176047
> 
> 赞同：1
> 
> 时间：2013-01-05T20:24:10.590
> 
> 标签：ajax, api, rest, design-patterns, comet

想象一下，我正在构建一个产品来跟踪银行交易，我们支持`GET /transactions/{id}`它允许您检索特定交易。

我们还有一个显示交易列表的客户端，因此我们允许一个`GET`默认`/transactions`情况下返回您可以作为 JSON 数组访问的最后 100 个交易的客户端。我们网站的一个常见用例是获取围绕固定点的交易列表。为了支持这一点，我们有一些 GET 参数：

*   `anchor`:用作中心点的*id*
*   `number_before``anchor`:返回前多少笔交易
*   `number_after`: 多少交易后`anchor`返回。

如果我们可以让客户通过某种[longpolling](https://en.wikipedia.org/wiki/Push_technology#Long_polling)来了解交易的最新信息，那就太好了。

我想实现一个请求，客户端可以说“这是我拥有的最后一个*id*，当您有一个或多个事务大于此时返回。”，并且服务器将阻塞（或者如果非阻塞调用立即返回被要求），直到它有东西要返回。

这也应该是具有不同参数集的`GET`to ，而不是前面提到的，还是重载 URI 那样糟糕，我应该将其设为 GET to或其他什么？`/transactions``last_txn``/transactions/+latest`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:16:37.380

我相信没有 100% 意识形态正确的选项，而且 REST 风格没有描述这一刻，所以这取决于你。

但我建议使用`/transactions`不同的参数：你保持方法重载的概念对于程序员来说是很自然的。

# php - 为什么我的“if”语句总是被确定为 TRUE？

> ID：14176053
> 
> 赞同：2
> 
> 时间：2013-01-05T20:24:33.173
> 
> 标签：php, forms, button, if-statement, conditional-statements

我正在尝试编写一个调试脚本来测试我的 cookie，但由于某种原因，它总是运行脚本以删除所有 cookie，即使不满足条件也是如此。这是我的代码 - 都是 html 和 php：

```
<form id="cookietest" name="CookieTest" method="post">
    <input type="submit" name="createcookie" value="Create cookie" />
    <input type="submit" name="removecookie" value="Remove cookie" />
    <input type="submit" name="removeallcookies" value="Remove all cookies" />
</form>
<?php
    $Domain = thedomain.com
    if($_POST['createcookie'] == TRUE)
    {
        $expire = 60*60*24*14 + time();
        setcookie('TestCookie', 'IExist', $expire, '/', $Domain);
        echo 'TestCookie should have been created. See its value below.<br />';
    }
    if($_POST['removecookie'] == TRUE)
    {
        $expire = time() - 60*60*24*14;
        setcookie('TestCookie', 'IExist', $expire, '/', $Domain);
        echo 'TestCookie should have been deleted. See its value below.<br />';
    }
    if($_POST['removeallcookies'] == TRUE);
    {
        $expire = time() - 60*60*24*14;
        setcookie('TestCookie', 'IExist', $expire, '/', $Domain);
        setcookie('Cookie1', '', $expire, '/', $Domain); // destroys persistent cookie
        setcookie('Cookie2', '', $expire, '/', $Domain); // destroys persistent cookie
        setcookie('Cookie3', '', $expire, '/', $Domain); // destroys persistent cookie
        echo 'All specified cookies should have been removed. <br />';
    }
    if($_POST['createcookie'] == FALSE && $_POST['removecookie'] == FALSE)
    {
        echo 'Neither the cookie create nor cookie remove button was clicked.<br />';
    }
    echo "The contents of 'TestCookie':";
    echo "${_COOKIE['TestCookie']}<br />";
    echo "The cookie array<br />";
    echo "<pre>";
        print_r($_COOKIE);
    echo "</pre>";
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T20:29:10.433

您 `semi-colon` 在 if 条件之后添加了这就是您的 if 块未执行的原因

```
if($_POST['removeallcookies'] == TRUE);  //<<< semi-colon 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T20:29:23.520

我认为你应该使用**isset**而不仅仅是 a ==

```
if(isset($_POST['createcookie']) )
{
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T20:31:24.750

正如@Cthulhu所说，改为使用：

检查它是否已设置：

```
if(isset($_POST[index])){

// do something

} 
```

检查是否未设置：

```
if(!isset($_POST[index])){

// do something

} 
```

# php - 在 PDO 准备好的语句中使用星号作为值

> ID：14176054
> 
> 赞同：1
> 
> 时间：2013-01-05T20:24:43.907
> 
> 标签：php, pdo, prepared-statement

我正在编写一个带有两个参数的函数，第一个是用户的 id（默认为 %），第二个是应该检索哪些字段（默认为 *）。第一个参数工作正常，但由于某种原因，当我尝试使用星号作为准备好的语句的参数值时，我得到了奇怪的结果（如下所列）。为什么我不能在准备好的语句中使用星号但可以使用百分号？我的功能如下：

```
public function getMembers($id = '%', $fields = '*') {
    $sql = 'SELECT ?
        FROM members
        WHERE members.member_id LIKE ?;';

    return $this->executeQuery($sql, array($fields, $id));
} 
```

这是 executeQuery 函数：

```
public function executeQuery($query, array $parameters = array(), $fetch_type = PDO::FETCH_ASSOC) {
    $result = array();

    $sth = $this->handle->prepare($query);

    if($sth->execute($parameters)) {
        while($row = $sth->fetch($fetch_type)) {
            array_push($result, $row);
        }
    }

    return $result;
} 
```

最后是如果我使用默认星号的结果：

```
Array
(
    [0] => Array
        (
            [*] => *
        )

) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:34:06.157

参数表现为值。字段名称是标识符，而不是值，因此您所做的最终会像：

```
SELECT '*' FROM ... 
```

当然，这是没有用的。

如果您需要将字段名称传递到 PDO 查询中，则需要适当地转义它们并将它们插入到查询中。但是，理想情况下，您的代码应该结构化，这样就没有必要了。

# ios - iPhone CABasicAnimation - 在 transform.scale 之后设置的新边界在哪里

> ID：14176055
> 
> 赞同：0
> 
> 时间：2013-01-05T20:24:53.813
> 
> 标签：ios, objective-c, iphone, core-animation

我正在使用以下代码转储我正在制作动画的视图的图层和表示层的边界状态之前和之后的状态。我没有看到任何变化 - 看起来我在理解方面遗漏了一些东西 - 已经阅读了几次 CA 编程指南但无济于事。任何指导将不胜感激

`- (void) shrink{ [Dumper dumpRect:@"BEFORE layer bounds" :[iv.layer bounds]]; [Dumper dumpRect:@"BEFORE p-layer bounds" :[iv.layer.presentationLayer bounds]];`

 ````
[UIView animateWithDuration:1.5 animations:^{
      CABasicAnimation *scaleAnim = [CABasicAnimatianimationWithKeyPath:@"transform.scale"];

        scaleAnim.fromValue = [NSNumber numberWithFloat:1];
        scaleAnim.toValue = [NSNumber numberWithFloat:0.5];

    scaleAnim.autoreverses=NO;
    [scaleAnim setDuration:1];
    // these need to be invoked to retain the scaled version
    scaleAnim.removedOnCompletion = NO;
    [scaleAnim setFillMode:kCAFillModeForwards];

    [iv.layer addAnimation:scaleAnim forKey:@"scale"];

}completion:^(BOOL finished){

    NSLog(@"Animation done - %d",finished);
    [Dumper dumpRect:@"AFTER layer bounds" :[iv.layer bounds]];
    [Dumper dumpRect:@"AFTER p-layer bounds" :[iv.layer.presentationLayer bounds]];

}]; 
```` 

`}`

在运行此代码时 - 我得到以下信息： 层边界之前 - 矩形 x=0.000000 y=0.000000 w=100.000000 h=200.000000 在 p 层边界之前 - 矩形 x=0.000000 y=0.000000 w=100.000000 h=200.000000 动画完成 - 1在层边界之后 - 矩形 x=0.000000 y=0.000000 w=100.000000 h=200.000000 在 p 层边界之后 - 矩形 x=0.000000 y=0.000000 w=100.000000 h=200.000000

那么之前和之后之间没有变化吗？

即使使用“transform.translation”转换，我也观察到相同的行为。

我需要最终的界限，以便我可以设置 UIView 即 iv 以设置适当的帧值。

相关问题是 - 我知道当图层被动画时，它只是完成的绘图，但底层视图仍然使用原始框架设置 - 设置 UIView 框架的正确方法是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:31:31.787

您不应该将该代码放在`UIView`'`animateWithDuration`方法中。`CABasicAnimation`如果您只想为某些东西设置动画，则可以使用，或者如果`animateWithDuration`您想实际更改某些内容并希望它具有动画效果，则可以使用。例如，如果你想改变帧动画，你写：

```
[UIView animateWithDuration:1.5 animations:^{
    CGRect newFrame = CGRectMake(0, 0, 50, 100);
    iv.frame = newFrame;
}completion:^(BOOL finished){
    // Code to be executed after the animation
}]; 
```

这将改变你的框架，它会被动画化。希望这可以帮助！

# kernel - 为什么 /proc/PID/status 中的进程名称与包名称或 ps 命令不匹配

> ID：14176058
> 
> 赞同：8
> 
> 时间：2013-01-04T17:09:41.083
> 
> 标签：kernel, process

我编写的本机应用程序使用`/proc/PID/status`名称变量。但是，状态文件中的 name 变量似乎不完整。例如，在测试时我打开了安卓计算器，从 PS 中查找了 PID 并进入了相应的`/proc/PID`文件夹。然后我 cat 状态文件来查看

```
Name: oid.calculator 
```

PS 命令显示`com.android.calculator`. `packages.xml`显示`com.android.calculator`。我在其他几部手机上进行了测试（Razr Maxx 运行 4.0.4，Google Nexus 运行相同的操作系统版本）并注意到类似的行为。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-04T18:59:39.650

这取决于 Linux 内核特性：一个进程有两个不同的名称。

*   其中一个名称是可执行文件路径的最后一个组成部分，例如，`native_executable`如果您的应用程序位于`/data/apps/com.example.hello/native_executable`. 这是出现在 的`Name`字段中的名称`/proc/PID/status`。内核将其截断为 15 个字符，因此在本例中它包含`native_executab`.
*   另一个名称由调用应用程序的程序作为其命令行参数 #0 （`argv[0]`在 C 中，`args[0]`在 Java 中）传递。这是出现在开头`/proc/PID/cmdline`并`ps`显示的名称。
*   可执行文件的路径也是符号链接的目标`/proc/PID/exe`。

按照惯例，当一个程序启动另一个程序时，它应该使用可执行文件的名称作为命令行参数 0，但它可以选择不这样做。`Name`字段`/proc/PID/status`始终由内核设置为可执行文件的（截断的）名称。

这是一个通用的 Linux 功能 — 另请参阅[我可以使用标准工具来获取进程的全名，当它的名称嵌入空格时？](https://askubuntu.com/questions/21650/can-i-use-standard-tools-to-get-the-full-name-of-a-process-when-its-name-has-em)在[问 Ubuntu](https://askubuntu.com/)上。

应用程序本身可以在之后更改这两个名称（尽管有长度限制）。Dalvik 使用这种能力来区分应用程序：所有应用程序都源自同一个本机可执行文件`/sytem/bin/app_process`；VM没有让它们都被调用，而是将`app_process`两个名称都更改为应用程序包名称。中的名称`/proc/PID/status`限制为 15 个字符，这就是它被截断的原因。您可以从中获取更长的名称`/proc/PID/cmdline`（读取到第一个空字节）。

# java - 与“array var-args”作为参数混淆

> ID：14176064
> 
> 赞同：1
> 
> 时间：2013-01-05T20:25:43.863
> 
> 标签：java

这是什么意思？我不知道第一个方法`m`参数声明是什么意思。

它拒绝传入 a`String`但允许一维数组`String []`和二维数组`String[][]`。它不允许`[][][]`或其他任何事情。

有人可以解决这个问题吗？

```
class j{
    public static void m(String [] ...  a) {
        System.out.println("Y");
    }

    public static void main(String[] args) {
        String [][] s = {};
        m(s);
    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-05T20:27:59.570

`public static void m(String [] ... a)`意味着您的函数可以接受任意数量的 String[] 作为参数，并且在函数内您将有一个 String[] 数组（即 String[][]）作为`a`. 您也可以直接传递单个 String[][] 而不是传递多个 String[]。

例如...

```
String [] x = {"a", "aa", "aaa"};
String [] y = {"b", "bb", "bbb"};
String [] z = {"c", "cc", "ccc"};

//All of these are valid uses of m(...).
m(x);
m(x,y);
m(x,y,z); 
```

在每种情况下，`m`都会有一个名为 的二维字符串数组`a`。

此外，由于`a`is a `String[][]`，您也可以直接传入单个`String[][]`。

```
String[][] XYZ = {x,y,z};

//Also valid. Same behaviour as m(x,y,z);
m(XYZ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:35:33.383

有两种方法可以提供类型 T 的可变数量的参数。您可以直接列出可转换为 T 的赋值表达式，也可以提供单个 T[]。

对于特定情况，这意味着您可以列出 String[] 类型的表达式，或者提供单个 String[][]。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T20:39:09.693

它只是编译器的一点语法糖。

那是：

```
ReturnType withVarArgs(ParamType... params) {} 
```

主要相当于：

```
ReturnType noVarArgs(ParamType[] params) {} 
```

有以下区别：

*   如果你有 , 类型的变量，你`a`可以用语法调用函数；您必须自己创建一个中间数组来调用变体。`b``c``ParamType``withVarArgs``withVarArgs(a, b, c)``noVarArgs`
*   可变参数参数只能指定为最后一个参数；
*   正如在 Effective Java 中所指出的，当您传递 的子类型的任何数组时，`Object...`和的行为`Object[]`会有所不同`Object`（例如，假设您要传递 a `String[]`）：
    *   如果与 一起使用`Object...`，则`String[]`数组对象将被包装在一个 1 元素对象数组中；
    *   如果与 一起使用`Object[]`，`String[]`则将直接使用数组对象，因为 Java 中的数组在其元素类型上是协变的；

# c++ - 如何改进我的哈希算法

> ID：14176070
> 
> 赞同：0
> 
> 时间：2013-01-05T20:26:16.317
> 
> 标签：c++, algorithm, hash

```
stper** pages;
int tableSize;    
struct Person{

    string name; 
    int age;    
    string homeTown;
};

void fonk1 (int numberOfBuckets)
{
    pages = new stper*[numberOfBuckets]();
    tableSize = numberOfBuckets;
} 

   int hashPerson(Person& person)
   {
    int hashVal = 0;
    for (int i=0; i < (person.getName()).length() ; i++)
        hashVal = 37*hashVal + (person.getName())[i];

    for (int i=0; i < (person.getHomeTown()).length() ; i++)
        hashVal = 37*hashVal + (person.getHomeTown())[i];   
    hashVal+= person.getAge();  

    hashVal %= tableSize;
    if(hashVal < 0)
        hashVal += tableSize;
    return hashVal;
   } 
```

大家好，我是哈希新手。我的散列函数在 hashPerson 函数的上面，你可以看到有三个键。我的函数是一个很好的散列算法吗？如何改进函数并减少碰撞次数？（如有语法错误请忽略）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:25:09.013

我有几个建议：

1.  使用`unsigned`而不是`int`. 根据我的经验，这已被证明表现得更好，因为当无符号溢出时，它仍然保持非负（否则 %-ing 可能会导致大问题 - 你得到一个负索引并且......崩溃）并且它也会导致降低碰撞率（经验证明）。此外，毕竟函数应该返回表中的索引，因此该值自然是无符号的 - 索引不能为负数。

2.  添加年龄时，将 hashVal 乘以某个值。我会建议一个大于任何可能年龄的值，例如 200。

3.  你永远不会说是什么，`tableSize`但我建议你使用一些大的（尽可能大的）素数，再次降低碰撞率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T23:06:27.767

您可以使用`std::hash`为您的基本组件生成良好的哈希值。[您可以在此处](http://en.cppreference.com/w/cpp/utility/hash)找到一些示例和说明。

如果您安装了 boost 版本，您可能会发现它`boost::hash_combine`可以满足您的需要。[您可以在此处](http://www.boost.org/doc/libs/1_52_0/doc/html/hash/combine.html)找到带有良好示例的 boost 文档。

# c++ - 如何正确链接提升正则表达式？

> ID：14176074
> 
> 赞同：0
> 
> 时间：2013-01-05T20:26:57.143
> 
> 标签：c++, regex, boost, mingw, static-linking

此代码编译正常：

```
#include <boost\regex.hpp>
int main() {
  boost::regex reg("[a-z]+");
} 
```

但是在链接的地方有错误消息：

```
d:/mingw/bin/../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw32/bin/ld.exe: final link failed: Invalid operation
collect2.exe: error: ld returned 1 exit status 
```

我必须在命令行中输入什么选项？我目前的开关是：

```
-I "d:\mingw\include" -I "d:\boost" -Os -s -o "test.exe" "test.cpp" -std=c++11 -ftree-vectorize -static 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T20:31:48.827

尝试添加`-lboost_regex`或`-lboost_regex-mt`

# postsharp - PostSharp，除了使用方法接口如何注入值？

> ID：14176076
> 
> 赞同：1
> 
> 时间：2013-01-05T20:27:07.703
> 
> 标签：postsharp, aop

除了修改/覆盖接口中的一个参数之外，是否还有将值注入方法？例如：

```
[Serializable]
public class MyTestAttribute : MethodInterceptionAspect
{
     public override void OnInvoke(MethodInterceptionArgs args)
     {
         String someValue = "123";
     }
}

public class MyClass
{
     [MyTest]
     public void doSomething()
     {
        String otherValue = "456" + someValue;
     }

} 
```

Where`someValue`在方面中声明，但可以在 doSomething 方法中访问，而无需通过方法接口传递它。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T16:33:35.147

至少有一种可能的解决方案：它将*面向方面的方法*与*依赖注入*相结合。*不幸的是，这种方法仅限于特定类型的场景*（检查答案的最后一部分）。

## InjectedAspect 建议

首先，定义`someValue`为包含目标方法的类的*可选依赖项。*您可以通过使用此*依赖项从类中提取接口来做到这一点*

```
public interface IServiceWithDependency
{
    int SomeValue { get; set; }
} 
```

二、制作目标类来实现这个接口

```
public class MyClass : IServiceWithDependency
{
    // dependency
    public int SomeValue { get; set; } 

    // aspect
    [InjectedAspect] 
    public void DoSomething()
    {
        string otherValue = "456" + SomeValue;
    }
} 
```

现在我们需要方面来注入这个依赖

```
[Serializable]
public class InjectedAspectAttribute : MethodInterceptionAspect
{
    public override void OnInvoke(MethodInterceptionArgs args)
    {
        if (args.Instance is IServiceWithDependency)
        {
            // inject actual value of dependency
            (args.Instance as IServiceWithDependency).SomeValue = 123;
        }

        args.Proceed();
    }
} 
```

或者，您可以添加编译时验证以确保此方面仅适用于实现的类`IServiceWithDependency`

```
 [Serializable]
        public class InjectedAspectAttribute : MethodInterceptionAspect
        {
            public override bool CompileTimeValidate(MethodBase method)
            {
                var result = true;
                var methodInfo = method as MethodInfo;

                if (!typeof(IServiceWithDependency).IsAssignableFrom(method.DeclaringType))
            {
                Message.Write(methodInfo, SeverityType.Error, "999", string.Format("Only class derived from IServiceWithDependencyallowed, {0} not implements IServiceWithDependency", method.DeclaringType));

                result = false;
            }

            return result;
        }

        public override void OnInvoke(MethodInterceptionArgs args)
        {
            /* … */
        }
    } 
```

完整样本可[在此处获得](https://gist.github.com/4468274)

## 什么时候申请，这个方面是什么场景

最初的想法来自事务管理方面，当没有环境时`TransactionScope`，将事务对象注入到每个需要处理事务的类中。一些重要的细节：

*   这个方面不仅不是线程安全的，而且如果你在一个类的实例上调用几个用这个方面装饰的方法，你可能会覆盖以前注入的值
*   以前的限制不是问题，当您在 MVC 应用程序中有类似 Controller 的类时，每个类实例只会调用一个方法
*   这也是一个类范围内的某种代码气味全局变量，因此只有在确实有帮助时才应谨慎应用此方法

# cocoa - 用于存储没有关联值的键的数据结构

> ID：14176084
> 
> 赞同：1
> 
> 时间：2013-01-05T20:27:45.223
> 
> 标签：cocoa, collections, nsdictionary

我需要一个有效的数据结构来保存标识符，而不需要字典中的值。是否只保留一个`NSNull`作为每个键的值，或者是否有更有效的数据结构来快速查找键？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T20:31:12.473

看`NSSet`or `NSMutableSet`，它本质上是一个`NSDictionary`没有值的。

# linux - perl 中的系统命令行最大长度

> ID：14176089
> 
> 赞同：2
> 
> 时间：2013-01-05T20:28:05.927
> 
> 标签：linux, windows, perl

为了减少发出的命令数量，我需要在 perl 语句中放入尽可能多的字符

```
system("$cmd_and_parameters") 
```

**在 Windows 和 Linux 下，我可以假设的（安全）最大行长是多少？**

我的问题是由于需要发出 Oetiker“rrdtool 套件”的命令，*而不*使用正确的 perl 模块（请不要为此责备我）。

我的第一次尝试是使用前面提到的功能，设置

```
$cmd_and_parameters = "path_to_rrdtool/rrdtool update $db $timestamp:$value" 
```

考虑到我必须做的更新数量，它可以工作，但速度很慢。

因此，由于“rrdtool update”允许，我决定将参数数量增加到允许的最大值，从而减少“系统”调用的数量。

使用合理的少量参数，它的效果要好得多，无论如何它足以满足我的需求，但仍然存在问题“我可以在系统函数中放入多少个 $timestamp:$value 对？

也就是说：一个perl系统函数可以有多少个字符？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-05T20:37:18.400

在 Linux 上，限制是`ARG_MAX`（您可以使用 查询`getconf ARG_MAX`）。我有编辑内核限制的习惯（例如`linux-3.7.1/include/uapi/linux/limits.h`增加它）。

（注意[setrlimit(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/setrlimit.2.html) `RLIMIT_STACK`实际上可能会降低程序参数的最大大小）

一些 Linux 内核（特别是旧的或嵌入式的）有一个下限。你应该准备好让它低至 32768（在我自己的内核上，我将它提高到 2097152）。

^(我提高我的原因`ARG_MAX`是我有足够的 RAM（16GB），我的 shell 是`zsh`，我喜欢`**/*.c`在我想打字的时候打字（因此避免了`find`）)

阅读[execve(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/execve.2.html) Linux 手册页和 Posix [exec](http://pubs.opengroup.org/onlinepubs/009604499/functions/exec.html)文档。Linux 手册页有几段关于*参数大小和环境的限制*。

在 Windows 上（或至少在 MS-DOS 上）它可能低至 128（扩展前）。

你应该明白，参数扩展是（在 Posix 和 Linux 系统上）由 shell 完成的，并且[system(3)](http://www.kernel.org/doc/man-pages/online/pages/man3/system.3.html)和 Perl 的同名函数可能正在启动一个`/bin/sh -c`将进行扩展的函数。重要的是扩展参数列表的大小：因此，如果您调用`system("ls */*/*.c")`并且如果扩展为一百万个参数，即使未扩展的命令行 非常短`*/*/*.c`，您也会遇到麻烦（至少在 Posix 和 Linux 上） 。`ls */*/*.c`

在 Windows 和 MS-DOS 上，有传言说运行时库会将命令行扩展为参数列表。听说程序以未解释的终端命令启动，并且一些运行时启动的东西正在做扩展。

所以回答你的问题：在 Posix 系统上，重要的是扩展的参数列表，如果扩展的参数列表小于 32K 字节，那么你很可能非常安全（实际上 128K 字节就足够了）。在 Windows 或 MS-DOS（我猜）上，您可能需要将未扩展的命令行限制为 128 个字符并将其扩展为 64Kbytes（实际上更大的阈值通常会起作用）。我真的认为你应该*总是*测试结果`system`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T23:03:37.983

Basile 已经非常明确地回答了 Linux 的答案。

Windows NT 和相关版本（这意味着不是 Windows 95、98 或 ME - 我认为它们仅限于 128 个字符，包括命令名称）具有 2047 或 8191 个字符的命令行。 [http://support.microsoft.com/kb/830473](http://support.microsoft.com/kb/830473)

除非您真的需要支持 Windows 的古老（12 岁以上）版本，否则 2KB 减去一点点应该没问题。

# java - 为什么这个 GroupLayout 不随窗口调整大小？

> ID：14176092
> 
> 赞同：0
> 
> 时间：2013-01-05T20:28:46.827
> 
> 标签：java, swing, jython, layout-manager

我以前没有使用过 Swing，所以我在看教程：
[http ://www.zetcode.com/gui/jythonswing/layout/](http://www.zetcode.com/gui/jythonswing/layout/)

在底部，有一个使用 GroupLayout 创建简单布局的示例，该布局可随窗口调整大小。我基本上复制了这个示例并放入了我自己的控件和布局。但是，当我执行代码时，所有控件都集中在窗口的左上角，根本不会移动或调整大小。

我错过了什么？

代码：

```
#!/usr/local/bin/jython
# -*- coding: utf-8 -*-

from java.awt import Dimension
from java.awt import Color

from javax.swing import JButton,JList
from javax.swing import SwingConstants
from javax.swing import JFrame
from javax.swing import JLabel
from javax.swing import JTextArea
from javax.swing import BorderFactory
from javax.swing import GroupLayout

class Example(JFrame):

    def __init__(self):
        super(Example, self).__init__()

        self.initUI()

    def initUI(self):

        layout = GroupLayout(self.getContentPane())
        self.getContentPane().setLayout(layout)
        layout.setAutoCreateGaps(True)
        layout.setAutoCreateContainerGaps(True)

        self.setPreferredSize(Dimension(350, 300))

        self.data = ("one","two","three","four")
        flist = JList(self.data)

        edit = JButton("Edit")
        grab = JButton("Grab")
        status = JLabel("status")

        layout.setHorizontalGroup(layout.createParallelGroup()
                .addGroup(layout.createSequentialGroup()
                    .addComponent(flist)
                    .addGroup(layout.createParallelGroup()
                        .addComponent(edit)
                        .addComponent(grab)
                    )
                )
                .addComponent(status)
            )

        layout.setVerticalGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup()
                    .addComponent(flist)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(edit)
                        .addComponent(grab)
                    )
                )
                .addComponent(status)
            )

        layout.linkSize(SwingConstants.HORIZONTAL, [edit, grab])

        self.pack()

        self.setTitle("Windows")
        self.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE)
        self.setLocationRelativeTo(None)
        self.setVisible(True)

if __name__ == '__main__':
    Example() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-09T18:31:10.260

我认为这是因为您只设置了preferredSize..因此，只显示您喜欢的大小..要调整大小，您还应该包括MinimumSize 和MaximumSize，这样当您使框架更小/更大时，组件就会随之而来。

PS：hjek - 伙计，这个人在问GroupLayout；他不是在询问 BorderLayout。你的回答不合逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:32:35.963

BorderLayout 相当简单。执行以下操作：

```
 from javax.awt import BorderLayout
 from javax.swing import JButton, JFrame
 someButton = JButton("ClickMe")
 frame = JFrame("Funky Jython Program")
 frame.setLayout(BorderLayout())
 frame.add(someButton,BorderLayout.NORTH) 
```

这会将 JButton 放在框架的顶部，对于以下按钮，请使用 EAST、SOUTH、WEST 或 CENTER。

# c++ - 通过另一个类中的指针访问多维数组的元素

> ID：14176093
> 
> 赞同：0
> 
> 时间：2013-01-05T20:29:01.730
> 
> 标签：c++, pointers, multidimensional-array

我有`int costMap[20][20];`一`dialog`堂课。

在那个类中，我正在从另一个名为的类中创建一个对象`pathFind`

```
int costMap[20][20];
//costMap is filled with values (that represent the cost for each node -> pathFinder)
int (*firstElement)[20] = costMap;
pathFind *finder = new pathFind(*firstElement); 
```

我希望能够访问`pathFind`类中多维数组的值

```
int (*costMap)[20];

pathFind::pathFind(int *map){
    costMap = &map;
} 
```

但是，这似乎不起作用。我收到“无法将 int** 转换为 int(*)[20] 错误。

**问题**：如何通过另一个类中的指针访问多维数组的元素

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:31:58.703

你必须写

```
pathFind::pathFind(int (*map)[20]){ ... } 
```

但这是*C++*，您可能会发现这更好：

```
template< std::size_t N, std::size_t M >
pathFind::pathFind(int (&map)[N][M]){ ... } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:32:21.367

> ```
> pathFind::pathFind(int *map){ 
> ```

这需要一个指向整数的指针。

在其他地方，您已经发现了要使用的正确类型：

```
pathFind::pathFind(int (*map)[20]){ 
```

不过，尽量避免这种指针黑客行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T20:33:11.747

你应该做这个：

```
pathFind::pathFind(int (*map)[20] ){
    costMap = map;
} 
```

也就是说，*匹配*类型！

还要注意`T (*)[N]`和`T**`不是兼容的类型。一个不能转换为另一个。在您的代码中，您正在尝试这样做，这就是错误消息告诉您的内容。

此外，您的代码还有其他问题，例如您应该*避免*使用`new`和原始指针。使用`std::vector`或标准库中的其他容器，当您需要指针时，更喜欢使用`std::unique_ptr`或`std::shared_ptr`任何适合您需要的容器。

# iphone - 如何使用按钮更改整个 iPhone 应用程序的字体大小

> ID：14176096
> 
> 赞同：1
> 
> 时间：2013-01-05T20:29:22.330
> 
> 标签：iphone, ios, xcode, storyboard

我有一个 iPhone 应用程序，它的屏幕上有很多 UILabel。我正在使用故事板。我的问题是这个。如何使用设置屏幕中的按钮或滑块更改应用程序中所有标签的字体大小？我还希望有一个最大尺寸，否则文本会变得太大而无法显示在屏幕上。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T03:22:03.213

尝试这个：

```
-(IBAction)sliderValueChanged:(UISlider *)sender
{
      CGFloat maxFontSize = 24.0;
      CGFloat minFontSize = 8.0;
      CGFloat sliderValue = sender.value;

      if ((sliderValue < maxFontSize) && (sliderValue > minFontSize)) {
              label1.font = [UIFont boldSystemFontOfSize:sliderValue]; 
              label2.font = [UIFont boldSystemFontOfSize:sliderValue]; 
              label3.font = [UIFont boldSystemFontOfSize:sliderValue]; 
      }
} 
```

我没有测试过这段代码，但我认为它应该可以工作。希望能有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T02:53:50.343

出色地。没有一种绝妙的方法可以做到这一点。如果你正在寻找一个快速的捷径，那你就不走运了。您需要创建一个可以在每个 viewControllers`viewDidLoad:`方法中运行的方法，但首先要执行以下操作：

首先，在你的应用程序的某个地方有一个滑块。假设滑块范围为 1-5。对于 1 之后的每个值，保存一个 int 以供以后参考。在任何文件中都可以。请参阅 NSCoding。本质上，你取数字，在本例中为 5，然后减去 1 并保存。因此，如果用户选择 5，您将节省 4。

好的，现在在每个控制器 viewDidLoad 中，都有一个类似的方法来执行以下操作：

获取您保存的 int 值。现在获取您的基本文本大小并添加您保存的数字。稍后您将需要它作为 CGFloat。我不肯定如何使用它，但你可以找到。

然后使用：

`[label1 setFont:[UIFont fontWithName:@"Name Of font" size:<#(CGFloat)#>]]`

您必须在所有 UILabel 上使用它。

如果您还需要什么，请告诉我。

# css - JavaFx 以编程方式设置外部背景图像

> ID：14176098
> 
> 赞同：2
> 
> 时间：2013-01-05T20:29:36.543
> 
> 标签：css, background, stylesheet, javafx-2

我在动态设置锚窗格的背景图像时遇到问题。出于开发目的，我将外部资源放在项目的 dist 文件夹中，因此文件可用。

AnchorPane 的代码：

```
AnchorPane root = new AnchorPane();
// this works fine, styles inside the css are used in components on the root pane
root.getStylesheets().add("file:/D:/ProjectFolder/global.css"); 
```

我不知道如何设置背景图像的路径。通读 CSS 和 JavaFX 引用，路径应该相对于 css 文件给出。我还尝试创建 URL 和 URI 以及绝对路径。

```
// path of compiled jar
"D:/ProjectFolder/project.jar"
// path of css file
"D:/ProjectFolder/global.css"
// path of background file
"D:/ProjectFolder/Resources/Wallpapers/worldmap.jpg" 
```

所有这些都不起作用：

```
root.setStyle("-fx-background-image: url('Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
root.setStyle("-fx-background-image: url('/Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
root.setStyle("-fx-background-image: url('./Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
root.setStyle("-fx-background-image: url('@Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
root.setStyle("-fx-background-image: url('@/Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
root.setStyle("-fx-background-image: url('@./Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
root.setStyle("-fx-background-image: url('D:/ProjectFolder/Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
root.setStyle("-fx-background-image: url('file:/D:/ProjectFolder/Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;"); 
```

（在旁注中，文件存在，我检查了文件夹和文件的名称以区分大小写，这也是正确的）

用于测试目的：

```
import javafx.application.Application;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.layout.AnchorPane;
import javafx.scene.layout.StackPane;
import javafx.stage.Stage;

public class BackGroundTest extends Application {

    private int backgroundtest = 0;
    private AnchorPane root;

    @Override
    public void start(Stage primaryStage) {
        Button btn = new Button();
        btn.setText("Test Background");
        btn.setOnAction(new EventHandler<ActionEvent>() {
            @Override
            public void handle(ActionEvent event) {
                switch (backgroundtest) {
                    case 0: {
                        root.setStyle("-fx-background-image: url('Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
                        break;
                    }
                    case 1: {
                        root.setStyle("-fx-background-image: url('/Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
                        break;
                    }
                    case 2: {
                        root.setStyle("-fx-background-image: url('./Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
                        break;
                    }
                    case 3: {
                        root.setStyle("-fx-background-image: url('@Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
                        break;
                    }
                    case 4: {
                        root.setStyle("-fx-background-image: url('@/Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
                        break;
                    }
                    case 5: {
                        root.setStyle("-fx-background-image: url('@./Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
                        break;
                    }
                    case 6: {
                        root.setStyle("-fx-background-image: url('D:/ProjectFolder/Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
                        break;
                    }
                    case 7: {
                        root.setStyle("-fx-background-image: url('file:/D:/ProjectFolder/Resources/Wallpapers/worldmap.jpg'); -fx-background-repeat: stretch; -fx-background-size: stretch; -fx-background-position: center center;");
                        break;
                    }
                }
                backgroundtest++;
                if (backgroundtest == 8) {backgroundtest = 0;}
            }
        });
        root = new AnchorPane();
        root.getStylesheets().add("file:/D:/ProjectFolder/global.css");
        StackPane stack = new StackPane();
        root.getChildren().add(stack);
        AnchorPane.setBottomAnchor(stack, 0d);
        AnchorPane.setLeftAnchor(stack, 0d);
        AnchorPane.setRightAnchor(stack, 0d);
        AnchorPane.setTopAnchor(stack, 0d);
        stack.getChildren().add(btn);

        Scene scene = new Scene(root, 800, 600);

        primaryStage.setTitle("Test Background");
        primaryStage.setScene(scene);
        primaryStage.show();
    }

    /**
     * The main() method is ignored in correctly deployed JavaFX application.
     * main() serves only as fallback in case the application can not be
     * launched through deployment artifacts, e.g., in IDEs with limited FX
     * support. NetBeans ignores main().
     *
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        launch(args);
    }
} 
```

css 文件：

```
.button {
    -fx-background-color:
        rgb(0, 50, 0, 0.08),
        rgb(0, 0, 0, 0.8),
        #090a0c,
        linear-gradient(#4a5661 0%, #1f2429 20%, #1f242a 80%),
        linear-gradient(#242a2e, #23282e),
        radial-gradient(center 50% 0%, radius 100%, rgba(135,142,148,0.9), rgba(255,255,255,0));
    -fx-background-radius: 7, 6, 5, 4, 3, 5;
    -fx-background-insets: -3 -3 -4 -3, -3, 0, 1, 2, 0;
    -fx-font-family: "Arial";
    -fx-font-size: 14;
    -fx-text-fill: white;
    -fx-padding: 5 10 5 10;
    -fx-effect: dropshadow( one-pass-box , rgb(0, 255, 0, 0.6), 10, 0.5 , 0 , 1 );
} 
```

如果我将 css 和图像包含到 jar 文件中，这一切都很好，但我想使用外部文件。像所有参考资料所说的那样设置相对于css文件的路径似乎不起作用，那么正确的路径是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:00:27.633

如果我用它把它放在 URL 中，这似乎现在可以工作了。

```
String filename = "worldmap.jpg"; 
HostServices services = this.getHostServices(); 
String url = services.resolveURI(services.getCodeBase(), "Resources/Wallpapers/" + filename); 
```

结果字符串与我的案例 7 相同，我不知道为什么它以前不起作用，现在起作用。

我第一次在 SceneController 的构造函数中设置了背景，现在我将它设置在一个额外的方法中，该方法在场景添加到舞台后被调用，也许这有什么关系，但我不知道错误在哪里真的是谎言。

至于有类似问题的任何人的答案，最好使用 HostServices 来解决上述示例中的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T19:15:20.610

不知道你是否得到它的工作，但这是正确的答案：

```
root.setStyle("-fx-background-image: url('file://D:/ProjectFolder/Resources/Wallpapers/worldmap.jpg');"); 
```

文件实现应该是 'file://PATH'

# javascript - jQuery - 单击 div 时的 on() 函数，但在单击该 div 的子项时不会

> ID：14176099
> 
> 赞同：0
> 
> 时间：2013-01-05T20:29:44.857
> 
> 标签：javascript, jquery, html, css

我有一个大的矩形父 div，里面有很多子 div。我有一个 on(click) 函数，该函数在单击父 div 时运行，但默认情况下，它也会在单击父 div 中的任何内容（包括子 div）时运行。

但是，我不希望在单击父项的一个特定子项时运行 on(click) 函数。我如何制作一个选择器来选择父 div 以及除了这个孩子之外的所有内容？

谢谢

```
<div class="box"">

<div class="overlay"><div id="text"></div></div>
<div class="slide">
    <div class="slideleft"></div>
    <div class="slideright">
        <span class="upvote">Upvote</span>
        <span class="counter"></span>
    </div>
</div>

</div> 
```

现在，这一切都在 'box' div 中，您可以看到[这里](http://www.confide.re/confide)发生的事情的演示。如果您在已经单击了一个框后单击了赞成按钮，那么事情会滑回我不希望的位置。这是我现在尝试使用的代码，但它不起作用：

```
$("body").on("click", ".box", function(e){
        if(e.target.class == 'upvote') {
            return false;
        } else {
                $(this).children('.slide').slideToggle(150);
                $(this).children('overlay').css('background-color', 'rgba(0,0,0,0)');
            }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:34:52.543

[工作小提琴](http://jsfiddle.net/jdMCJ/1/)

```
$("body").on("click", ".box", function (e) {
if (e.target.className != 'upvote') {
  $(this).children('.slide').slideToggle(150);
  $(this).children('.overlay').css('background-color', 'rgba(0,0,0,0)');
}
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:36:56.710

你可以这样做：

```
$('.child').on('click', function(e){
   e.stopPropagation();
}); 
```

**[演示](http://jsfiddle.net/yU8Fa/3/)**

# javascript - 单击即可调用两个javascript函数

> ID：14176100
> 
> 赞同：1
> 
> 时间：2013-01-05T20:30:14.940
> 
> 标签：javascript, html

我有一个包含 href 链接的 JSP 页面。单击链接时，我需要调用 2 个 javascript 函数。只有当第一个函数返回时，第二个 javascript 函数才应该执行`true`。我试过这个：

```
 <a href="#" onClick="return firstFunction(); secondFunction()"> Click me </a> 
```

但这不起作用。我想要的是，如果第一个函数返回 true，则执行第二个函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:32:37.643

当您返回第一个函数的结果时，块将退出。除非你打算对结果做点什么，否则你应该说：

```
<a href="#" onClick="return firstFunction() ? secondFunction() : false;">Click me</a> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T20:33:09.353

你可以这样做

```
<a href="#" onClick="return firstFunction() ? secondFunction() : false"> Click me </a> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-05T20:32:33.580

您目前拥有：

```
function () {
    return firstFunction();
    secondFunction();
} 
```

然后，此调用`firstFunction`返回其值，并且永远不会到达对 的调用`secondFunction`。

你要：

```
function () {
    var result = firstFunction();
    if (result) {
        secondFunction();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-05T20:31:52.963

```
<a href="#" onClick="return if (firstFunction()) secondFunction();"> Click me </a> 
```

如果您希望 true 表示“只有真实的东西，而不仅仅是使用布尔比较 = true 的东西”

```
<a href="#" onClick="return if (firstFunction()===true) secondFunction();"> Click me </a> 
```

**但你可能不会**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-05T20:32:38.340

```
<a href="#" onClick="foo()"> Click me </a>

function foo(){
    if (firstFunction() === true)
        secondFunction()
} 
```

`return`退出函数，所以你刚刚返回`firstFunction`并退出了函数，比如

```
function foo(){
    return firstFunction();
     secondFunction(); // Unreachable code.
} 
```

# java - 值比较和值分配之间是否存在性能差异？

> ID：14176104
> 
> 赞同：4
> 
> 时间：2013-01-05T20:30:42.187
> 
> 标签：java, performance, optimization, jvm, atomic

考虑以下两个代码示例：

**示例 1。**

```
public void setValue(int value)
{
    mValue = value;
} 
```

**示例 2。**

```
public void setValue(int value)
{
    if (mValue != value)
    {
        mValue = value;
    }
} 
```

假设您的任务是优化一些 Java 代码到绝对最大值，超出所有常识。

第二个代码示例会是第一个代码示例的优化吗？我的意思是，在 Java 或 JVM 的最低级别的 if 条件检查和 int 赋值之间是否有任何区别（无论多么微小）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-05T20:33:13.140

第二个可能是反优化，因为在现代处理器上，分支往往很昂贵（主要是因为[分支*错误预测*](http://en.wikipedia.org/wiki/Branch_predictor)的成本非常高）。

唯一确定的方法是在代表性输入上分析您的代码。请参阅[如何在 Java 中编写正确的微基准测试？](https://stackoverflow.com/questions/504103/how-do-i-write-a-correct-micro-benchmark-in-java)有关如何设置有意义的微基准的一些指示。

请记住，如果有问题的代码不占整个 CPU 时间的很大一部分，那么世界上的所有优化都不会对应用程序的整体性能产生很大影响。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T20:42:43.387

NPE 有很好的建议。我要补充的一条评论是，这可能还取决于是否`mValue`易失，以及您正在运行它的硬件。对于易失性，写入可能比读取昂贵几倍。一些硬件（例如，我相信许多移动设备）易失性读取远非便宜，因此这种差异可能会缩小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T20:36:39.187

您可以尝试编译两者，然后使用 java 字节码反汇编程序来检查差异。[Wikipedia JVM 指令列表](http://en.wikipedia.org/wiki/Java_bytecode_instruction_listings)可能是一个不错的起点。

根据我对使用过的编译器和 VM 的了解，由于额外的比较操作，第二个代码片段可能会（微不足道）慢一点。

如果您的 JVM 实现有一个优化器，它可能能够将您的第一个代码示例减少到一个操作，而第二个片段将需要至少一个或两个更多的操作来解释比较操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T20:52:17.500

良好的编码实践说：“在最后一刻之前延迟优化”

但是代码测试说：

*   总计(1)=1000000000 1420ms 总计(2)=1000000000 2155ms
*   总计(1)=1000000000 1374ms 总计(2)=1000000000 1884ms
*   总计(1)=1000000000 1379ms 总计(2)=1000000000 2072ms

**比较和设置不是更好。**

```
// Test Code
public class CompareAndSet {
    int mValue;

    // 1
    public void setValue1(int value) {
        mValue = value;
    }

    // 2
    public void setValue2(int value) {
        if (mValue != value) {
            mValue = value;
        }
    }

    public static void main(String[] args) {
        final int TOTAL = (int) 1e9;
        long ts;
        for (int j = 0; j < 3; j++) {
            // 1
            {
                ts = System.currentTimeMillis();
                CompareAndSet cs = new CompareAndSet();
                for (int i = 0; i < TOTAL; i++) {
                    cs.setValue1(i);
                }
                System.out.println("TOTAL(1)=" + TOTAL + " "
                        + (System.currentTimeMillis() - ts) + "ms");
            }
            // 2
            {
                ts = System.currentTimeMillis();
                CompareAndSet cs = new CompareAndSet();
                for (int i = 0; i < TOTAL; i++) {
                    cs.setValue2(i);
                }
                System.out.println("TOTAL(2)=" + TOTAL + " "
                        + (System.currentTimeMillis() - ts) + "ms");
            }
        }
    }

} 
```

# c++ - strtol的正确使用

> ID：14176123
> 
> 赞同：36
> 
> 时间：2013-01-05T20:32:39.367
> 
> 标签：c++, c

下面的程序将字符串转换为长字符串，但根据我的理解，它也会返回错误。我依赖的事实是，如果`strtol`成功地将字符串转换为长字符串，那么第二个参数`strtol`应该等于 NULL。当我使用 55 运行以下应用程序时，我收到以下消息。

```
./convertToLong 55
Could not convert 55 to long and leftover string is: 55 as long is 55 
```

如何成功检测 strtol 中的错误？在我的应用程序中，零是一个有效值。

代码：

```
#include <stdio.h>
#include <stdlib.h>

static long parseLong(const char * str);

int main(int argc, char ** argv)
{
    printf("%s as long is %ld\n", argv[1], parseLong(argv[1]));
    return 0;
 }

static long parseLong(const char * str)
{
    long _val = 0;
    char * temp;

    _val = strtol(str, &temp, 0);

    if(temp != '\0')
            printf("Could not convert %s to long and leftover string is: %s", str, temp);

    return _val;
} 
```

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-01-05T21:30:33.243

请注意，以下划线开头的名称是为实现保留的；最好避免在代码中使用此类名称。因此，`_val`应该是公正`val`的。

当您第一次遇到错误处理`strtol()`及其相关的完整规范时，它是复杂的，令人惊讶的复杂。您做的一件绝对正确的事情是使用函数来调用`strtol()`；在代码中使用它“原始”可能是不正确的。

由于该问题同时使用 C 和 C++ 标记，因此我将引用 C2011 标准；您可以在 C++ 标准中找到适合自己的措辞。

> ### ISO / IEC 9899:2011 §7.22.1.4 `strtol`、`strtoll`和函数`strtoul``strtoull`
> 
> `long int strtol(const char * restrict nptr, char ** restrict endptr, int base);`
> 
> ¶2 [...] 首先，他们将输入字符串分解为三个部分：一个初始的，可能为空的空白字符序列（由 isspace 函数指定），一个类似于整数的主题序列，以某个确定的基数表示由 base 的值和一个或多个无法识别的字符组成的最终字符串，包括输入字符串的终止空字符。[...]
> 
> ¶7 如果主题序列为空或不具有预期形式，则不进行转换；的值`nptr`存储在 指向的对象中`endptr`，前提`endptr`是该对象不是空指针。
> 
> ### 退货
> 
> ¶8 `strtol`、`strtoll`、`strtoul`和`strtoull`函数返回转换后的值（如果有）。如果无法执行转换，则返回零。如果正确值超出可表示值的范围，则返回 LONG_MIN、LONG_MAX、LLONG_MIN、LLONG_MAX、ULONG_MAX 或 ULLONG_MAX（根据值的返回类型和符号，如果有），宏 ERANGE 的值为存储在`errno`.

请记住，没有任何标准 C 库函数会设置`errno`为 0。因此，为了可靠，您必须`errno`在调用`strtol()`.

因此，您的`parseLong()`函数可能如下所示：

```
static long parseLong(const char *str)
{
    errno = 0;
    char *temp;
    long val = strtol(str, &temp, 0);

    if (temp == str || *temp != '\0' ||
        ((val == LONG_MIN || val == LONG_MAX) && errno == ERANGE))
        fprintf(stderr, "Could not convert '%s' to long and leftover string is: '%s'\n",
                str, temp);
        // cerr << "Could not convert '" << str << "' to long and leftover string is '"
        //      << temp << "'\n";
    return val;
} 
```

请注意，出错时，这将返回 0 或 LONG_MIN 或 LONG_MAX，具体取决于`strtol()`返回的内容。如果你的调用代码需要知道转换是否成功，你需要一个不同的函数接口——见下文。另外，请注意错误应该打印到`stderr`而不是`stdout`，并且错误消息应该由换行符终止`\n`；如果不是，则不能保证它们会及时出现。

现在，在库代码中你可能不想打印，而你的调用代码可能想知道转换是否成功，所以你也可以修改接口。在这种情况下，您可能会修改该函数，使其返回成功/失败指示：

```
bool parseLong(const char *str, long *val)
{
    char *temp;
    bool rc = true;
    errno = 0;
    *val = strtol(str, &temp, 0);

    if (temp == str || *temp != '\0' ||
        ((*val == LONG_MIN || *val == LONG_MAX) && errno == ERANGE))
        rc = false;

    return rc;
} 
```

你可以像这样使用：

```
if (parseLong(str, &value))
    …conversion successful…
else
    …handle error… 
```

如果您需要区分“尾随垃圾”、“无效数字字符串”、“值太大”和“值太小”（以及“无错误”），您可以使用整数或`enum`代替布尔返回码。如果您希望允许尾随空格但不允许其他字符，或者如果您不想允许任何前导空格，则该函数还有更多工作要做。代码允许八进制、十进制和十六进制；如果您想要严格十进制，则需要将调用中的 0 更改为 10 `strtol()`。

如果您的函数要伪装成标准库的一部分，则它们不应设置`errno`为`0`永久，因此您需要包装代码以保留`errno`：

```
int saved = errno;  // At the start, before errno = 0;

…rest of function…

if (errno == 0)     // Before the return
    errno = saved; 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-01-05T20:35:33.740

您快到了。`temp`本身不会为空，但如果整个字符串被转换，它会指向一个空字符，所以你需要取消引用它：

```
if (*temp != '\0') 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-09-27T14:13:09.510

> 如何成功检测 strtol 中的错误？

```
static long parseLong(const char * str) {
    int base = 0;
    char *endptr;
    errno = 0;
    long val = strtol(str, &endptr, base); 
```

标准 C 库指定/支持的 3 个测试：

1.  是否进行了任何转换？

    ```
     if (str == endptr) puts("No conversion."); 
    ```

2.  在范围内？

    ```
     else if (errno == ERANGE) puts("Input out of long range."); 
    ```

3.  尾随垃圾？

    ```
     else if (*endptr) puts("Extra junk after the numeric text."); 
    ```

成功

```
 else printf("Success %ld\n", val); 
```

* * *

Input like `str == NULL`or `base`not 0, [2 to 36] is *undefined behavior*。各种实现（C 库的扩展）提供定义的行为并通过`errno`. 我们可以添加第四个测试。

```
 else if (errno) puts("Some implementation error found."); 
```

或者结合`errno == ERANGE`测试。

* * *

示例简洁代码也利用了常见的实现扩展。

```
long my_parseLong(const char *str, int base, bool *success) {
    char *endptr = 0;
    errno = 0;
    long val = strtol(str, &endptr, base);

    if (success) {
      *success = endptr != str && errno == 0 && endptr && *endptr == '\0';
    }
    return val;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-05T20:36:10.260

您缺少一定程度的间接性。您想检查**字符**是否是终止符`NUL`，而不是指针是否为`NULL`：

```
if (*temp != '\0') 
```

顺便说一句，这不是错误检查的好方法。函数族的正确错误检查方法`strto*`不是通过将输出指针与字符串结尾进行比较来完成的。应该通过检查零返回值并获取的返回值来完成`errno`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-05T20:41:16.900

你应该检查

```
*temp != '\0' 
```

您还应该能够根据以下方式在调用 strotol 后检查 errno 的值：

```
RETURN VALUES
     The strtol(), strtoll(), strtoimax(), and strtoq() functions return the result
     of the conversion, unless the value would underflow or overflow.  If no conver-
     sion could be performed, 0 is returned and the global variable errno is set to
     EINVAL (the last feature is not portable across all platforms).  If an overflow
     or underflow occurs, errno is set to ERANGE and the function return value is
     clamped according to the following table.

       Function       underflow     overflow
       strtol()       LONG_MIN      LONG_MAX
       strtoll()      LLONG_MIN     LLONG_MAX
       strtoimax()    INTMAX_MIN    INTMAX_MAX
       strtoq()       LLONG_MIN     LLONG_MAX 
```

# c++ - 如何强制执行项目范围内的唯一 ID/错误代码，以便轻松找到源代码中的错误来源？

> ID：14176128
> 
> 赞同：2
> 
> 时间：2013-01-05T20:33:16.723
> 
> 标签：c++, templates, c-preprocessor

使用用户将在错误中看到的唯一错误代码很方便。这将使开发人员更容易找到错误的根源（只需在源代码中搜索错误代码即可），从而节省时间。

例子：

```
void f()
{
  std::cout << "UNIQUE001 " << "Error : The query failed" << std::endl;
}

void g()
{
  f();
}

int main()
{
  g();
  return 0;
} 
```

在示例中，用户报告错误（“UNIQUE001 错误：查询失败”）。开发人员只需对“UNIQUE001”进行项目范围的搜索，即可立即找到引发错误的位置。（带有行号的文件是不够的，因为同时代码可能已经更改）。

所以，对于这个问题：有没有办法在编译时（理想情况下，使用预处理器宏或 TMP）或运行时（例如在单元测试中）**强制错误代码字符串的唯一性？**

**更新**

到目前为止，我最好的尝试是创建一个带有宏的结构，它创建一个值字符串等于类型名称和错误代码的类型。这有效并为重复类型提供了编译时错误，但不能在任何地方声明结构（例如在表达式中）

```
#define generateerrorcode(code) \
struct code \
{ \
  static const char* value = #code \
}; \ 
```

如果可能的话，我希望能够使用这样的唯一检查功能：

```
void some_function()
{
  std::cout << check_unique("UNIQUE001") << "Error : The query failed" << std::endl;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:37:38.023

如果您想 100% 确定，您可以使用[GUID](http://weblogs.asp.net/jevgeni/archive/2010/02/02/adding-guid-generator-guidgen-to-visual-studio-2010.aspx)[和数](http://en.wikipedia.org/wiki/Globally_unique_identifier)[以](http://www.boost.org/doc/libs/1_43_0/libs/uuid/index.html)百万计的[生成](http://www.guidgenerator.com/)器之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:43:01.337

你说：

> （带有行号的文件是不够的，因为同时代码可能已经更改）。

但是，如果您自己不使用它但编译器会使用它怎么办？即`__FILE__`, `__LINE__`, `__FUNCTION__`. 请参阅：[C++ 中的 __FILE__、__LINE__ 和 __FUNCTION__ 用法](https://stackoverflow.com/questions/597078/file-line-and-function-usage-in-c)

但是，如果代码在错误之后但在您修复它之前被更改，它将失败。（但您可能会看到编辑历史记录）

# compass-sass - 浏览器对文本阴影传播值的支持

> ID：14176129
> 
> 赞同：4
> 
> 时间：2013-01-05T20:33:21.037
> 
> 标签：compass-sass, css, spread

[在这里](https://stackoverflow.com/questions/5749472/chrome-doesnt-display-text-shadow-with-a-spread-value)看到讨论，但已经2年了！

我不知道我是否使用了这个权利，但我有以下`sass/compass`代码：

```
+text-shadow(red 0 3px 0 3px) 
```

生成以下内容`css`：

```
text-shadow: red 0 3px 3px, red 0 3px 0 3px;
text-shadow: red 0 3px 0 3px, red 0 3px 0 3px; 
```

这在 Chrome/Safari/Firefox/Opera 中都不起作用。

*这是声明中的内容还是该`spread`功能真的从规范中删除了？*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2018-03-13T11:04:01.957

这并不理想，但由于 text-shadow 接受逗号分隔的值列表，因此您可以将文本阴影“堆叠”在彼此之上以获得更不透明的结果。

```
text-shadow: 0 0 1px white, 0 0 2px white, 0 0 3px white; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-05T20:47:50.343

它[在规格](http://www.w3.org/TR/css-text-decor-3/#text-shadow-property)中说，

> 此属性接受以逗号分隔的要应用于元素文本的阴影效果列表。值被解释为 'box-shadow' [CSS3BG]。**（但**请注意，不允许**展开值**。）阴影应用于元素的所有文本以及它指定的任何文本装饰。

 *** * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-05T20:42:00.297

Compass 不允许在使用 mixin 时设置*传播*`text-shadow`值：正如他们在文档中所说：

> 如果任何阴影有一个 spread 参数，这将导致 mixin 发出两次阴影声明，第一次没有 spread，然后包含 spread。这允许您逐步增强支持 spread 参数的浏览器。

或者，您可以使用 mixin：[`single-text-shadow`](http://compass-style.org/reference/compass/css3/text-shadow/#mixin-single-text-shadow) 然后传递所有值，包括*用逗号分隔的**扩展*值。

 *```
single-text-shadow(0, 3px, 0, 3px, red); 
```

这将按您的预期工作。***

# ruby-on-rails - 如何在 Rails 中有条件地构建 ActiveRecord 查询？

> ID：14176130
> 
> 赞同：13
> 
> 时间：2013-01-05T20:33:53.907
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我正在尝试在我的 rails 应用程序中构建搜索结果页面（仍然是菜鸟），但我不知道如何以 rails 方式构建查询。

例如，如果没有参数，我想返回所有结果。如果用户在搜索表单中传递 1 到 n 个可选参数，我想将它们添加到查询中。

接下来，如果他们有指定的“价格 desc”或“year_built desc”甚至两者的组合。

最后使用 will_paginate 分隔结果

```
# default to all listings
@listings = Mls.all

@listings.where("listing_price > ?", params[:listing_price]) unless params[:listing_price].blank?
# ... bunch of other search options ...
@listings.where("property_type = ?", params[:property_type]) unless params[:property_type].blank?

# order
@listings.order("some order by param") if some sort param
@listings.order("some order by param") if some other sort param

# paginate results
@listings.paginate(:page => params[:page]) 
```

有没有这样做的“Rails”方式？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-05T20:56:35.780

你看过高级搜索的（修订的）Railscasts 集吗？这是链接：[http ://railscasts.com/episodes/111-advanced-search-form-revised](http://railscasts.com/episodes/111-advanced-search-form-revised)

基本思想是创建一个`Search`资源，该资源将处理通过表单发送的搜索参数，并在后台搜索相关模型（在您的情况下`Mls`）

这样，`params[:listing_price]`您可以处理搜索模型（models/search.rb）中的条件，而不是检查控制器是否存在某些参数（例如）：

```
def find_listings
  listings = Mls.order(:name)
  listings = listings.where("listing_price > ?", listing_price) if listing_price.present?
  # ... more condition checking
  listings
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:40:33.793

几个链接：

[使用第三方 gem（元搜索）](http://railscasts.com/episodes/251-metawhere-metasearch)

[从头开始编写代码](https://stackoverflow.com/questions/4480088/rails-search-with-optional-parameters)

# c# - 在适用于 Windows 8 的现代 UI 应用程序中使用较旧的 .NET API？

> ID：14176132
> 
> 赞同：2
> 
> 时间：2013-01-05T20:33:55.680
> 
> 标签：c#, windows-8, visual-studio-2012, dropbox-api

我目前正在尝试使用[DropNet](http://dkdevelopment.net/what-im-doing/dropnet/)制作一个简单的 Modern UI 应用程序，该应用程序将能够访问用户的 Dropbox 帐户并上传文件。但是，DropNet 显然只支持 .NET 3.5。

我一直试图让应用程序利用 .NET 3.5 运行时（而不是 4.5），但无济于事。我选择合适的 .NET 版本，如下所示：

![显示 .NET Framework 所选版本的新项目屏幕截图](../Images/589a59748d4ad053c15a56916715eaa9.png)

然而，当我尝试确认版本时，它会显示一个像这样的灰色框：

![在此处输入图像描述](../Images/cd6162850381b818e44a6a4b0452e76c.png)

这与非现代 UI 应用程序形成对比，后者显示适当的版本并让您能够更改它。

当我尝试通过 NuGet 获取 DropNet 时，它会抛出一个错误（如您所料）：

> 无法安装软件包“DropNet 1.9.3”。您正在尝试将此包安装到以“.NETCore,Version=v4.5”为目标的项目中，但该包不包含与该框架兼容的任何程序集引用。有关详细信息，请联系包作者。

有什么办法可以实现我想要做的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:08:52.603

你无法完成这项工作。应用商店应用项目**必须**以 .NET 4.5 为目标，这是与使 .NET 程序在 WinRT 上运行所需的语言投影兼容的唯一 .NET 版本。此外，允许 WinRT 编程的配置文件（错误消息中显示的 .NETCore）受到严格限制，不支持对针对旧版本 .NET 的 .NET 程序集的引用。

我不知道 DropBox api 的 4.5 Store 兼容包装器。您可以利用他们的[通用 REST api](https://www.dropbox.com/developers/reference/api)。当心您将遇到的一般麻烦，以及 4.5 包装器不可用的原因，当用户离开应用商店应用程序时，Windows 会暂停应用商店应用程序。这将中断文件传输。极有可能发生，用户不会有太多的耐心。

# python - Python2.3.4 for Damnsmall Linux OS version2.4.26 on i686

> ID：14176135
> 
> 赞同：0
> 
> 时间：2013-01-05T20:34:04.823
> 
> 标签：python, linux

1.  我下载了python2.3.tar.gz
2.  我安装了它并启动了解释器
3.  我导入 Tkinter 但得到和错误消息

    ```
    File "/opt/python/lib/python2.3/lib-tk/Tkinter.py", line 38, in ?
    import _tkinter # If this fails your Python may not be configured for Tk
    ImportError: No module named _tkinter 
    ```

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:41:53.507

Python 模块有许多依赖项（包括 Tk 和 X11），当您配置和构建 Python 时，这些`Tkinter`依赖项必须尚未安装或未正确安装。

此外，Python 2.3 确实很古老。您可能需要使用更新的版本再试一次。

# java - 小程序无法在浏览器上运行

> ID：14176137
> 
> 赞同：1
> 
> 时间：2013-01-05T20:34:27.800
> 
> 标签：java, html, swing, packaging, japplet

我正在关注一些关于如何构建小程序的练习；但是，我无法让它显示在浏览器中。在尝试了几次之后，确保小程序是正确的，html 页面也是正确的（都在同一个文件夹中）。我从作者网站（class + html）下载了相同版本的小程序，将它们都放在一个文件夹中，它们就可以工作了。奇怪的是，这两个文件都与我的相同，但我的不工作......任何人都可以提出什么问题？这是我的两个文件（非常简单）

这里是网络上小程序的链接 [http://www.cs.armstrong.edu/liang/intro8e/book/DisplayLabel.html](http://www.cs.armstrong.edu/liang/intro8e/book/DisplayLabel.html)

这是我的文件

.html 文件

```
<html>
  <head>
    <title>Java Applet Demo</title>
  </head>
  <body>
    <applet
      code = "DisplayLabel.class"
      width = 250
      height = 50>
    </applet>
  </body>
</html> 
```

类文件（java代码）

```
package Chapter18Applets;

import javax.swing.JApplet;
import javax.swing.JLabel;

public class DisplayLabel extends JApplet {

    public DisplayLabel() {
        add(new JLabel("This is an Applet!", 0));
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:41:04.480

```
package Chapter18Applets; 
```

删除该行。您没有使用包，因此不需要`package`声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T21:01:36.733

好的，如果您要使用包，则需要将程序导出为 .jar。如果您不打算使用包，请按照其他人所说的操作并删除声明包语句的行。

否则，一旦您将其导出并上传为 .jar，您需要具有说明您的程序位于 .jar 中的存档属性，并将您的代码属性更改为

```
<applet archive="name.jar" code="Character18Applets.DisplayLabel" width=x height=y> 
```

请注意您的代码属性如何是 packageName.ClassName。您不需要 .class 扩展名。

希望这可以帮助 ：）

# scala - 在 Scala 中创建 Hibernate 方法验证器

> ID：14176140
> 
> 赞同：2
> 
> 时间：2013-01-05T20:34:35.753
> 
> 标签：scala, hibernate-validator

我正在尝试将此 Java 代码转换为 Scala，但我失败了：

Java（编译没有错误）：

```
Validation.byProvider(HibernateValidator.class).configure().
    buildValidatorFactory().getValidator().unwrap(MethodValidator.class); 
```

斯卡拉：

```
Validation.byProvider(classOf[HibernateValidator]).configure.
    buildValidatorFactory.getValidator.unwrap( classOf[MethodValidator] ) 
```

斯卡拉错误：

```
inferred type arguments [Nothing,org.hibernate.validator.HibernateValidator] do 
  not conform to method byProvider's type parameter bounds [T <: 
  javax.validation.Configuration[T],U <: 
  javax.validation.spi.ValidationProvider[T]] 
```

我究竟做错了什么？

我正在使用 Scala 2.10 并在类路径上有 JBoss 7.1.0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T01:42:25.027

看起来 scala 在推断某些类型时遇到了一些麻烦。这应该有效：

```
Validation.byProvider[HibernateValidatorConfiguration, HibernateValidator](classOf[HibernateValidator])
   .configure.buildValidatorFactory.getValidator.unwrap(classOf[MethodValidator]) 
```

如果您查看 byProvider 的来源，您会发现：

```
public static <T extends javax.validation.Configuration<T>, 
    U extends javax.validation.spi.ValidationProvider<T>>  
    javax.validation.bootstrap.ProviderSpecificBootstrap<T> 
    byProvider(java.lang.Class<U> providerType) 
```

所以scala应该知道HibernateValidator已经实现了HibernateValidatorConfiguration，但它没有。

# php - PHP if/elseif 逻辑与 && 和 ||

> ID：14176141
> 
> 赞同：3
> 
> 时间：2013-01-05T20:34:37.397
> 
> 标签：php, if-statement

我有一些 php 代码，用于根据从某些 HTML 发送的值运行不同的 mySQL 查询。从 HTML 发送的值是我使用的当天：

```
<?php $day = date("w"); ?> 
```

当我使用：

```
<?php echo $day; ?> 
```

它返回 6，这是它应该做的（因为它是星期六），所以我可以确认我的 HTML/php 正在向我的脚本发送正确的信息。

现在在我的脚本中，我在 if/elseif 语句中有一个大的 mySQL 查询列表，其中包含 && 和 || 条件。

以下是前两个的示例：

```
if(($noshow == 1) && ($day != 5 || $day != 6 || $day != 0)){
$run = mysql_query("UPDATE employee_data SET points=points+5 WHERE ID=" . $id) or die(mysql_error());
}
elseif(($noshow == 1) && ($day == 5 || $day == 6 || $day == 0)){
$run = mysql_query("UPDATE employee_data SET points=points+7 WHERE ID=" . $id) or die(mysql_error());
} 
```

变量 $noshow 也是从我的 html 文件发送的，它以复选框的形式发送，值为 1（如果选中）。所以我需要它做的是根据今天的日期运行查询。在第一个语句中，如果选中了 html 中的框，并且不是星期五、星期六或星期日 (5,6,0)，我希望它更新点以等于当前点加 5。

下一个语句应该和第一个语句做同样的事情，但前提是当天是周五、周六或周日。对于我所做的各种复选框/选项，该脚本继续包含大约 10 条其他语句。

所以我遇到的问题是它只运行第一个语句，即使是第 6 天（我在上面解释过）

我已经为这个问题转了大约两个小时，这让我发疯了。我目前的想法是我的 if 语句语法不正确。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T20:37:36.517

非常简单。如果 day = 6，您的第一个语句将起作用，因为您说过

```
IF DAY IS NOT EQUAL TO 5
OR
DAY IS NOT EQUAL TO 6 
```

所以当天不等于5时，它会起作用！你的第二个语句有**elseif**所以它在第一次做的时候不起作用。如果您希望您的第一个语句在 day = 6 时不起作用，那么您必须告诉它

```
IF DAY IS NOT EQUAL TO 5
AND
DAY IS NOT EQUAL TO 6 
```

**所以一个简单的更新将是**

```
if(($noshow == 1) && ($day != 5 && $day != 6 && $day != 0)){
$run = mysql_query("UPDATE employee_data SET points=points+5 WHERE ID=" . $id) or die(mysql_error());
}
elseif(($noshow == 1) && ($day == 5 || $day == 6 || $day == 0)){
$run = mysql_query("UPDATE employee_data SET points=points+7 WHERE ID=" . $id) or die(mysql_error());
} 
```

**提示：**

每当您对 IF 条件如何工作感到困惑时，请翻译 && 和 || 成英文并阅读。例如，您的第一条语句将被解读为

```
IF NO SHOW IS 1 AND (DAY IS NOT EQUAL TO 5 OR DAY IS NOT EQUAL TO 6 OR DAY IS NOT EQUAL TO 0) 
```

以这种方式阅读它会更加明显，即使在第 6 天，这个陈述也是正确的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:41:14.450

If $day != 5 it will return true because you are using ||, try using && to make sure all tests are required.

# android - 使用 Android Eclipse ADT 打印

> ID：14176143
> 
> 赞同：1
> 
> 时间：2013-01-05T20:34:48.613
> 
> 标签：android, eclipse, printing, adt

当我将 System.out.println() 与 Android ADT for Eclipse 一起使用时，它没有显示在控制台中？

我怎样才能打开它？或者如何使用 ADT 正确输出到控制台？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:38:11.453

System.out.println 和 Log.d 都进入 LogCat，而不是控制台。

窗口->显示视图->其他...->Android->LogCat

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:44:26.317

使用 Log.d("name", "log string"); 用于记录，然后打开 logcat 以查看日志

# android - 跨方向开关工作的 ProgressDialog（片段）

> ID：14176144
> 
> 赞同：6
> 
> 时间：2013-01-05T20:34:50.857
> 
> 标签：android, android-fragments, progressdialog

如果我正确执行以下操作，任何人都可以看看。我有一个带有进度对话框的片段，我需要它在方向开关上工作。我目前这样做：

```
// I am using the compat libraries
import android.support.v4.app.DialogFragment;

public class ProgressDialogFragment extends DialogFragment {

    private ProgressDialog mProgressDialog = null;
    private int            mMax            = 100;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setStyle(DialogFragment.STYLE_NO_TITLE, 0);
        setRetainInstance(true);
    }

    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {
        mProgressDialog = new ProgressDialog(getActivity());
        mProgressDialog.setTitle("Title");
        mProgressDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        mProgressDialog.setCancelable(true);
        mProgressDialog.setProgress(0);
        mProgressDialog.setMax(mMax);
        mProgressDialog.setCanceledOnTouchOutside(false);

        return mProgressDialog;
    }

    // there seems to be a bug in the compat library - if I don't do the following - the dialog is not show after an orientation switch
    @Override
    public void onDestroyView() {
        if (getDialog() != null && getRetainInstance())
            getDialog().setDismissMessage(null);
        super.onDestroyView();
    }

    public void setMax(int arg1) {
        mProgressDialog.setMax(arg1);
        mMax = arg1;
    }

    public void setProgress(int arg1) {
        mProgressDialog.setProgress(arg1);
    }
} 
```

在我的活动中，我创建了这个 ProgressDialogFragment，并在需要显示对话框时调用 show()。我试图理解为什么在 onCreateDialog 方法中我不能简单地返回 mProgressDialog 如果它已经存在（我得到一个异常说“在添加内容之前必须调用requestFeature（）”）。当然，片段的用途之一是在这些情况下重用资源 - 为什么我需要创建一个新对话框而不是使用已经存在的对话框？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T20:19:48.373

您不能简单地在 onCreateDialog 方法中传递旧对话框，因为它引用了旧上下文，即正在销毁的活动。

如果您不重新创建对话框，那么您最终会出现内存泄漏。

# sql - 对行子集应用聚合函数

> ID：14176148
> 
> 赞同：0
> 
> 时间：2013-01-05T20:35:10.143
> 
> 标签：sql, sql-server, aggregate-functions, average

我有一张表，我想计算一列的平均值，但只计算最后 10 行。

```
SELECT AVG(columnName) as avg FROM tableName 
```

我不能直接应用 top 因为这个查询只返回一行。我需要一种方法来获取最新的 10 行并对它们进行平均。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T20:37:54.190

尝试这个：

```
SELECT AVG(columnName) FROM
(SELECT TOP 10 columnName FROM tableName ORDER BY ColumnWhichHoldsOrder DESC) A 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T20:38:52.253

```
select avg(columnName)
from (
   select columnName, 
          row_number() over (order by some column desc) as rn
   from tableName
) t
where rn <= 10; 
```

# python - GAE Python：将 UTF-8 字符从 XML 文件导入数据库模型

> ID：14176152
> 
> 赞同：2
> 
> 时间：2013-01-05T20:35:31.410
> 
> 标签：python, google-app-engine, utf-8, getelementsbytagname

我正在从在线资源解析 XML 文件，但在读取 utf-8 字符时遇到问题。现在我已经阅读了其他一些处理类似问题的问题，但是到目前为止没有一个解决方案有效。目前代码如下所示。

```
class XMLParser(webapp2.RequestHandler):

def get(self):

        url = fetch('some.xml.online')

        xml = parseString(url.content)

        vouchers = xml.getElementsByTagName("VoucherCode")

        for voucher in vouchers:

          if voucher.getElementsByTagName("ActivePartnership")[0].firstChild.data == "true":

            coupon = Coupon()
            coupon.description = str(voucher.getElementsByTagName("Description")[0].firstChild.data.decode('utf-8'))
            coupon.prov_key = str(voucher.getElementsByTagName("Id")[0].firstChild.data)
            coupon.put()
            self.redirect('/admin/coupon') 
```

我从中得到的错误如下所示。这是由描述字段中的“ü”引起的，我稍后在使用数据时也需要显示。

> 文件“C:\Users\Vincent\Documents\www\Sparkompass\Website\main.py”，第 217 行，在 get coupon.description = str(voucher.getElementsByTagName("Description")[0].firstChild.data.decode ('utf-8')) 文件“C:\Python27\lib\encodings\utf_8.py”，第 16 行，解码返回 codecs.utf_8_decode(input, errors, True) UnicodeEncodeError: 'ascii' codec can't encode位置 16 中的字符 u'\xfc'：序数不在范围内（128）

如果我去掉描述，一切都会正常工作。在数据库模型定义中，我定义了如下描述：

```
description = db.StringProperty(multiline=True) 
```

***尝试 2***

我也试过这样做：

```
coupon.description = str(voucher.getElementsByTagName("Description")[0].firstChild.data).decode('utf-8') 
```

这也给了我：

> UnicodeEncodeError：'ascii' 编解码器无法在位置 16 编码字符 u'\xfc'：序数不在范围内（128）

任何帮助将不胜感激！

***更新***

XML 文件包含德语，这意味着其中的更多字符是 UTF-8 字符。因此，理想情况下，我现在认为在更高级别进行解码可能会更好，例如

```
xml = parseString(url.content) 
```

但是到目前为止，我也没有让它发挥作用。目的是获取 ascii 中的字符，因为这是 GAE 需要将其注册为数据库模型中的字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:47:25.420

```
>>> u"ü".decode("utf-8") 
```

UnicodeEncodeError

```
>>> u"ü".encode("utf-8") 
```

'\xc3\xbc'

```
>>> u"ü".encode("utf-8").decode("utf-8") 
```

你'\xfc'

```
>>> str(u"ü".encode("utf-8").decode("utf-8")) 
```

UnicodeEncodeError

```
>>> str(u"ü".encode("utf-8")) 
```

'\xc3\xbc'

您需要哪种编码？

您还可以使用：

```
string2 = cgi.escape(string).encode("latin-1", "xmlcharrefreplace") 
```

这会将所有非 latin-1 字符替换为 xml 实体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T09:37:39.813

我现在通过将描述更改为 TextProperty 解决了这个问题，它没有给出任何错误。我知道这样做时我将无法进行排序或过滤，但对于描述，这应该没问题。

背景信息：[https ://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#TextProperty](https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#TextProperty)

# javascript - 使用锚点时使用返回按钮刷新

> ID：14176161
> 
> 赞同：2
> 
> 时间：2013-01-05T20:36:10.100
> 
> 标签：javascript, jquery, ajax, html

> **可能重复：**
> [在 js 中处理 URL 锚点更改事件](https://stackoverflow.com/questions/2161906/handle-url-anchor-change-event-in-js)
> [如何像 GitHub 一样进行令人敬畏的无刷新页面更改](https://stackoverflow.com/questions/4664166/how-to-do-awesome-refreshless-page-changes-like-github)

在我的应用程序中，我使用这个非常简单的代码来添加主题标签：

```
 <a href='#test'> <input type='submit'></input> 
```

当我按下后退按钮时，我希望页面刷新。目前，它只从 www.mysite.com/#test 到 www.mysite.com。

我看到了关于这个主题的不同问题，但我没有找到如何做到这一点。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:45:31.767

一种简单的方法是等待哈希更改事件发生，然后对其做出反应。每当 # 更改时，将调用该函数，如果哈希为空，则将重新加载页面。

```
window.addEventListener('hashchange', function() {
  console.log(window.location.hash);

  if('' === window.location.hash) {
    console.log('reload');
    //window.location.reload();
  }
}); 
```

[http://jsfiddle.net/kcKLE/1/](http://jsfiddle.net/kcKLE/1/)

我建议使用 jQuery 之类的库来进行事件绑定，因为 addEventListener 在任何浏览器中都不起作用。（你好 IE） [https://developer.mozilla.org/en/docs/DOM/element.addEventListener](https://developer.mozilla.org/en/docs/DOM/element.addEventListener)

如果你需要更高级的东西，还有一个历史 API。 [https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:06:12.810

我刚刚找到了如何做到这一点。我正在使用 onhashchange 功能。这是我的代码：

```
 document.body.setAttribute("onhashchange", "update()");
         function update() {
            if('' === window.location.hash) {
                 window.location.reload();
          }

      }; 
```

所以当我按下后退按钮时，哈希消失并且页面重新加载。

谢谢大家的提示。

# jquery - jquery tocify 错误的顺序

> ID：14176162
> 
> 赞同：0
> 
> 时间：2013-01-05T20:36:24.600
> 
> 标签：jquery, jquery-ui, tableofcontents, jquery-tocify-js

我正在使用 Tocify [https://github.com/gfranko/jquery.tocify.js](https://github.com/gfranko/jquery.tocify.js)在站点的某些内容上制作 TOC。它工作得很好，但是我遇到了 Tocify 订购我的内容的方式的问题。我认为展示它的最佳方式是使用这张图片：![在此处输入图像描述](../Images/adbdfa88bceec9e310541969ec89e3f9.png)

在我的查询中，Testeoverskrift 5 位于 Testeoverskrift 6 之前（应该是这样），但 Tocify 将 Testeoverskrift 置于 Testeoverskrift 6 之后。预期结果是 Tocify 会将 Testeoverskrift 5 置于与 Testeoverskrift 9 相同的级别，但低于 Testeoverskrift 10 .

对我做错了什么有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T04:09:04.640

你介意在[github](https://github.com/gfranko/jquery.tocify.js/issues?direction=desc&sort=created&state=closed)上创建一个问题吗？此外，如果您有公共测试页面或 jsfiddle/jsbin 示例，这将很有帮助。谢谢！

**注意：**我写了 Tocify

# mysql - mysqld --defaults-file 和 tmpdir 问题

> ID：14176163
> 
> 赞同：0
> 
> 时间：2013-01-05T20:36:33.887
> 
> 标签：mysql, drupal, drupal-6

我正在尝试使用下面的命令让 mysqld 在不同的位置使用 my.cnf。

> ./bin/mysqld --defaults-file=/apps/local/mysql/my.cnf

它不工作，服务器没有启动，但如果我用下面的命令启动 mysqld，它工作正常。

> ./bin/mysqld --datadir=/apps/local/mysql/data --basedir=/apps/local/mysql --port=3306 --tmpdir=/tmp --socket=/tmp/mysql.sock -- pid-file=/apps/local/mysql/data/zizou.pid --log-error=/apps/local/mysql/data/zizou.err

我的配置文件有问题吗？my.cnf 如下所示。

```
[client] 
port=3306 
socket=/tmp/mysql.sock

[mysqld] 
# * Basic Settings
user=mysql 
pid-file=/apps/local/mysql/data/zizou.pid 
socket=/tmp/mysql.sock 
port=3306 
basedir=/apps/local/mysql 
datadir=/apps/local/mysql/data 
tmpdir=/tmp 
log-error=/apps/local/mysql/data/zizou.err 
lc-messages-dir=/apps/local/mysql
skip-external-locking

[mysqldump] 
quick 
```

另外，我正在为 drupal 6 使用 mysql 数据库。它使用默认存储引擎 MISAM。最近，我们看到了一个问题，即 tmpdir 被完全使用。它只有1GB的空间。因此，当我们将 tmpdir 更改为有大量存储空间的地方时，它在启动服务器的几个小时内使用了 41GB，并产生了大量的 CPU 负载，这导致我们的网站宕机。

我们将 tmpdir 切换到 1GB 的目录，没有高 CPU 负载，网站正常运行但磁盘已满。这让我经常清理它。我需要采取什么措施来解决这个问题吗？

**编辑：**我可以继续删除 .MYI 和 .MYD 文件并启动 mysql 服务器吗？这样做健康吗？

对不起，长篇大论。这些问题困扰了很多人。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:10:29.000

要设置不同的 mysql 实例，您可以在此处查看：http: [//dev.mysql.com/doc/refman/5.1/en/multiple-unix-servers.html](http://dev.mysql.com/doc/refman/5.1/en/multiple-unix-servers.html)

对于 tmpdir 问题，您可能正在运行繁重的查询。您可能会从这里得到一些帮助：[skip copying to tmp table on disk mysql](https://stackoverflow.com/questions/7532307/skip-copying-to-tmp-table-on-disk-mysql)

# python - 仅列出目录中的文件？

> ID：14176166
> 
> 赞同：51
> 
> 时间：2013-01-05T20:36:44.753
> 
> 标签：python

有没有办法用 Python 列出目录中的文件（不是目录）？我知道我可以使用s`os.listdir`的循环`os.path.isfile()`，但如果有更简单的东西（比如函数`os.path.listfilesindir`或其他东西），它可能会更好。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-01-05T20:38:16.640

这是[一个简单的生成器表达式](http://www.youtube.com/watch?v=pShL9DCSIUw)：

```
files = (file for file in os.listdir(path) 
         if os.path.isfile(os.path.join(path, file)))
for file in files: # You could shorten this to one line, but it runs on a bit.
    ... 
```

或者，如果它更适合您，您可以制作一个生成器功能：

```
def files(path):
    for file in os.listdir(path):
        if os.path.isfile(os.path.join(path, file)):
            yield file 
```

然后简单地说：

```
for file in files(path):
    ... 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-09-06T09:24:55.523

```
files = next(os.walk('..'))[2] 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-01-25T11:36:50.887

在 Windows 中使用 pathlib 如下：

> files = (x for x in Path("your_path") if x.is_file())

产生错误：

> TypeError：“WindowsPath”对象不可迭代

你应该使用[Path.iterdir()](https://pathlib.readthedocs.org/en/pep428/#pathlib.Path.iterdir)

```
filePath = Path("your_path")
if filePath.is_dir():
    files = list(x for x in filePath.iterdir() if x.is_file()) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-09-11T11:18:19.280

从 Python 3.6 开始，您可以使用带有递归选项“**”的 glob。请注意，glob 将为您提供所有文件和目录，因此您只能保留文件

```
files = glob.glob(join(in_path, "**/*"), recursive=True)
files = [f for f in files if os.path.isfile(f)] 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-05T20:39:46.290

你可以试试[pathlib](http://pypi.python.org/pypi/pathlib)，它还有很多其他有用的东西。

Pathlib 是一个面向对象的库，用于与文件系统路径进行交互。要获取当前目录中的文件，可以执行以下操作：

```
from pathlib import *
files = (x for x in Path(".") if x.is_file())
for file in files:
    print(str(file), "is a file!") 
```

在我看来，这比使用`os.path`.

另见：[PEP 428](http://www.python.org/dev/peps/pep-0428/)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-11-17T16:20:17.197

使用`pathlib`，仅列出文件的最短方法是：

```
[x for x in Path("your_path").iterdir() if x.is_file()] 
```

如果需要，提供深度支持。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-07-20T09:17:41.700

对于使用当前目录中的文件的特殊情况，您可以将其作为简单的单行列表理解：

```
[f for f in os.listdir(os.curdir) if os.path.isfile(f)] 
```

否则，在更一般的情况下，必须加入目录路径和文件名：

```
dirpath = '~/path_to_dir_of_interest'
files = [f for f in os.listdir(dirpath) if os.path.isfile(os.path.join(dirpath, f))] 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-01-17T23:58:02.680

如果您使用 Python 3，则可以使用[pathlib](https://pathlib.readthedocs.io/en/pep428/#)。

**但是**，您必须知道，如果您使用该`is_dir()`方法：

```
from pathlib import *

#p is directory path
#files is list of files in the form of path type

files=[x for x in p.iterdir() if x.is_file()] 
```

空文件将被跳过`.iterdir()`

我找到的解决方案是：

```
from pathlib import *

#p is directory path

#listing all directory's content, even empty files
contents=list(p.glob("*"))

#if element in contents isn't a folder, it's a file
#is_dir() even works for empty folders...!

files=[x for x in contents if not x.is_dir()] 
```

# activerecord - 更新而不选择活动记录 yii

> ID：14176168
> 
> 赞同：0
> 
> 时间：2013-01-05T20:36:55.103
> 
> 标签：activerecord, yii, criteria

我尝试更新 num_of_gifts 而不选择使用 yii 活动记录和 CDbCriteria 这是我的代码：

```
$attributes = array('num_of_gifts' => 'num_of_gifts'+1);
$condition = 'bla bla';
$params = array(bla bla);
Gifts::model()->updateAll($attributes, $condition, $params); 
```

我在 num_of_gifts 单元格中得到的都是“1”，是否可以将 1 增加到 num_of_gifts？或者我需要选择 num_of_gifts 的数量，然后使用更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:20:08.967

如果你只是更新计数器，你可以使用 Yii 的[updateCounters](http://www.yiiframework.com/doc/api/1.1/CActiveRecord#updateCounters-detail)方法。

全部更新示例：

```
Gifts::model()->updateCounters(array('num_of_gifts'=>1)); 
```

该方法采用条件来更新特定记录，但如果您不包含条件，它将更新所有记录。

[编辑]

如果要根据条件更新选定的记录，格式如下：

```
Gifts::model()->updateCounters(
        array('num_of_gifts'=>1),
        array('condition' => "param = :param"),
        array(':param' => 'paramvalue'),
    ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-30T15:47:26.677

从 Yii 1.1.8 开始有更新计数器的简化方法：

```
Gifts::model()->saveCounters(array('num_of_gifts'=>1)); 
```

看：

[http://www.yiiframework.com/wiki/282/using-counters-with-activerecord/](http://www.yiiframework.com/wiki/282/using-counters-with-activerecord/) [http://www.yiiframework.com/doc/api/1.1/CActiveRecord#saveCounters-detail](http://www.yiiframework.com/doc/api/1.1/CActiveRecord#saveCounters-detail)

# c - 使用 C 单元测试框架 Check without Autotools？

> ID：14176180
> 
> 赞同：26
> 
> 时间：2013-01-05T20:38:21.253
> 
> 标签：c, check-framework

我正在尝试按照[官方检查教程](http://check.sourceforge.net/doc/check_html/)进行操作，但它需要 Autotools 的工作知识，而我没有。我希望只是写几个快速测试，我发现这个教程压倒性的。它依赖于 Autoconf、Automake 和一些 Check 宏中的许多魔法。它没有解释 Check 的实际工作原理，以便我可以手动构建测试。

如何在没有 Autotools 的情况下使用 Check？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-02-23T23:17:19.003

您当然不需要学习自动工具即可在小型项目中使用 Check。假设我们的 main() 在 main.c 中，并且我们的 implementation.c 有一个函数，它对 2 个整数求和。（implementation.h 只包含函数原型）

```
#include "implementation.h"

int sum(int a, int b) {

    return a + b;
} 
```

您可以像这样编写测试：

```
#include "implementation.h"

#test sum2test
    fail_unless(sum(3, 2) == 5, "sum function borked");
    fail_unless(sum(-3, 2) == -1, "sum function borked");
    fail_unless(sum(3, -2) == 1, "sum function borked");
    fail_unless(sum(-3, -2) == -5, "sum function borked"); 
```

将文件保存在 implementation-test.check 中（您可以选择任何您想要的名称/扩展名，但如果您想按照我的指南继续使用这些名称/扩展名），然后运行 ​​Check 附带的包含的 awk 脚本。您甚至不必费心检查框架的样板代码！（有关更多详细信息，请查看 man checkmk）

```
checkmk implementation-test.check >implementation-test.c 
```

输出将如下：

```
/*
 * DO NOT EDIT THIS FILE. Generated by checkmk.
 * Edit the original source file "implementation-test.check" instead.
 */

#include <check.h>

#line 1 "implementation-test.check"
#include "implementation.h"

START_TEST(sum2test)
{
#line 4
    fail_unless(sum(3, 2) == 5, "sum function borked");
    fail_unless(sum(-3, 2) == -1, "sum function borked");
    fail_unless(sum(3, -2) == 1, "sum function borked");
    fail_unless(sum(-3, -2) == -5, "sum function borked");
}
END_TEST

int main(void)
{
    Suite *s1 = suite_create("Core");
    TCase *tc1_1 = tcase_create("Core");
    SRunner *sr = srunner_create(s1);
    int nf;

    suite_add_tcase(s1, tc1_1);
    tcase_add_test(tc1_1, sum2test);

    srunner_run_all(sr, CK_ENV);
    nf = srunner_ntests_failed(sr);
    srunner_free(sr);

    return nf == 0 ? 0 : 1;
} 
```

然后在编译时包含 -lcheck 以获取链接的检查库并运行程序！

```
gcc -Wall -o sum2ints-test implementation.c implementation-test.c -lcheck
./sum2ints 
```

下面是一个简单的 makefile，可以帮助您入门。将其保存在 sum2ints.makefile 中，然后与 main 一起构建 implementation.c，运行：

```
make -f sum2ints.makefile 
```

要使用从 checkmk 创建的 implementation-test.c 构建和运行 implementation.c，请运行：

```
make -f sum2ints.makefile test 
```

-

```
CFLAGS=-Wall
LIBS=-lcheck

all: sum2ints

sum2ints: main.o implementation.o
gcc -o sum2ints main.o implementation.o

main.o: main.c implementation.h
gcc $(CFLAGS) -c main.c

implementation.o: implementation.c implementation.h
gcc $(CFLAGS) -c implementation.c

test: sum2ints-test
./sum2ints-test

sum2ints-test: implementation-test.o implementation.o
gcc -o sum2ints-test implementation.o implementation-test.o $(LIBS)

implementation-test.o: implementation-test.c implementation.h
gcc $(CFLAGS) -c implementation-test.c 
```

我为您准备了一个包含上述所有内容的 .zip 文件。

[https://dl.dropbox.com/u/1987095/test-check.zip](https://dl.dropbox.com/u/1987095/test-check.zip)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2019-01-08T15:34:36.170

@freestyler 的答案很好，但它仍然使用`checkmk`，这不是必需的。

**这是一个不使用`checkmk`.**

将以下内容放入名为 的文件中`test.c`：

```
#include <check.h>

START_TEST (sanity_check)
{
    fail_unless(5 == 5, "this should succeed");
    fail_unless(6 == 5, "this should fail");
}
END_TEST

int main(void)
{
    Suite *s1 = suite_create("Core");
    TCase *tc1_1 = tcase_create("Core");
    SRunner *sr = srunner_create(s1);
    int nf;

    suite_add_tcase(s1, tc1_1);
    tcase_add_test(tc1_1, sanity_check);

    srunner_run_all(sr, CK_ENV);
    nf = srunner_ntests_failed(sr);
    srunner_free(sr);

    return nf == 0 ? 0 : 1;
} 
```

并编译

```
gcc test.c -Wall -o test -lcheck -pthread -lcheck_pic -pthread -lrt -lm -lsubunit 
```

# asp.net - 为什么我的 HttpHandler 没有被解雇？

> ID：14176182
> 
> 赞同：2
> 
> 时间：2013-01-05T20:38:28.713
> 
> 标签：asp.net, httphandler, ihttphandler

我正在尝试使用 http hadler，所以我创建了一个类库项目并添加了以下代码：

```
 namespace MyProject.Handlers
{
    public class Class1 : IHttpHandler
    {
        public bool IsReusable
        {
            get { return false; }
        }

        public void ProcessRequest(HttpContext context)
        {
            context.Response.Write("Hello from custom handler.");
        }
    }
} 
```

然后我编译它并生成了 MyProject.Handlers.dll 文件。我把它放在我的 asp.net bin 文件夹中，并将它添加到 asp.net

```
<system.webServer>
    <handlers>
        <add name="TutorialHandler" verb="*" path="*" type="MyProject.Handlers.Class1, MyProject.Handlers" modules="IsapiModule" scriptProcessor="c:\Windows\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" resourceType="File" />
    </handlers>
<modules runAllManagedModulesForAllRequests="true">
    //some stuff I *think* it doesn't make a difference
</modules>
//some stuff I *think* it doesn't make a difference
</system.webServer> 
```

和

```
<system.web>
 <httpHandlers>
      <add verb="*" path="*" type="MyProject.Handlers.Class1, MyProject.Handlers" />
    </httpHandlers>
  </system.web> 
```

但它只是没有被调用！我启动调试器，设置断点，但它并没有停止。如果我在 firebug 中检查输出 html，则不存在“Hello from custom handler”这句话。

我究竟做错了什么？

谢谢，奥斯卡

编辑：我正在使用框架 4.0，IIS7。难道是我正在使用路线？（不是直接调用 index.aspx，而是 /home 或类似的东西？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T17:31:45.133

由于某种原因，当它位于处理程序列表的末尾时，它没有被调用。我移到顶部并收到关于 webresources.axd 的奇怪错误。原因是路径 =“*”。我找不到匹配的路径，因为我正在使用路由。

最后我发现我使用了错误的工具：模块对我来说是正确的，而不是处理程序，因为我想根据情况在我的输出中添加一些东西。所以我改变了使用模块的方法，现在看起来不错。感谢所有帮助我发表评论的人！

# ios - 拥有多个 IOS 开发者账号，无法创建 IOS 分发证书

> ID：14176185
> 
> 赞同：4
> 
> 时间：2013-01-05T20:38:42.297
> 
> 标签：ios, xcode, certificate, distribution, provisioning

我有 2 个有效的单一 IOS 开发者帐户和 1 个 mac book air。为了更好地解释我的问题，我将我的帐户称为**帐户 A**和**帐户 B**。我的问题是我可以为帐户 A 创建开发者和分发证书。但是我**不能为帐户 B 以帐户 B 的名称创建分发证书**。账户 B 的**分发证书以账户 A 的名字命名**. 为了创建证书，我按照以下步骤操作：打开钥匙串访问-->证书助手-->从证书颁发机构请求证书-->输入帐户 B 名称和邮件地址--> 打开带有帐户 B 登录数据的苹果开发者页面并将“证书请求文件”上传到“创建开发者证书”部分和“创建分发证书”部分。“**开发者证书**”成功从账户B取名，但“**分发证书”**" 使用帐户 A 的名称。我撤销了帐户 A 和帐户 B 的证书。我从 xcode 的组织者和开发人员页面中删除了钥匙串访问和配置文件中的证书，但我仍然无法使用帐户 B 的名称创建分发证书。我有从帐户 B 发送我的应用程序，因为我在“ **itunesconnect** ”创建了应用程序，并且我想将开发人员名称显示为帐户 B。**帐户 B 的分发证书**如何使用**帐户 B 的名称**而不是**帐户 A 的名称**？问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:56:23.683

账户 A 和 B 没有相同的团队名称？因为开发证书是针对团队成员和分发证书的。是为一个团队。因此，如果两个帐户的团队名称相同，则分发证书将具有相同的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T20:07:23.203

当您有多个开发人员程序时，您可以为证书创建额外的钥匙串。为您添加的每个钥匙串设置一组证书。

Xcode 只会从默认钥匙串中读取证书。因此，当您想使用一组时，请将辅助钥匙串中的证书复制到您的默认（登录）钥匙串中。完成后将它们移回。

这是一个不太理想的解决方案，但它是 Apple 提供的解决方案。

# java - 带有矩阵和递归的考试练习样本

> ID：14176190
> 
> 赞同：1
> 
> 时间：2013-01-05T20:39:12.643
> 
> 标签：java, recursion, multidimensional-array, matrix

这是过去考试（编程基础）中的一个问题，我不知道如何解决（经过 2 个多小时的尝试）：

编写一个方法`void fillingSumOfNeighbours(int[][]m)`，假设 m 是一个矩阵，其中最后一列和最后一行已经被填充（非零），用 sum 填充剩余的值`m[i][j]=m[i][j+1]+m[i+1][j]+m[i+1][j+1]`。这个方法一定是递归的！

到目前为止，我可以以正确的方式填充矩阵，但不能在不使用字段计数器的情况下使递归有限（对我来说似乎不正确，因为使用字段计数器来停止递归需要定义的类）。有没有办法定义直接递归方法只能在该方法内运行的次数？

基本上它应该这样做：

```
_ _ 1
_ _ 1
1 1 1 

_ _ 1
_ 3 1
1 1 1

_ 5 1
_ 3 1
1 1 1

_ 5 1
5 3 1 
1 1 1

13 5 1
5  3 1
1  1 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:10:00.347

通过查看您的示例和问题陈述，很明显，您需要运行 3 次递归：-

*   一种用于垂直向上移动
*   一种用于水平左移
*   一个用于对角线左侧。

因此，要管理该运动，您还必须将索引传递给您的方法。我希望你被允许修改方法。

所以，基本上你的递归调用将是这样的： -

```
fill(arr, row - 1, col);
fill(arr, row, col - 1);
fill(arr, row - 1, col - 1); 
```

假设`fill`您的方法采用 3 个参数：-

*   `int[][] arr`
*   `int row`
*   `int col`

现在，如您所见，第一个调用正在减少行值，从而向上移动索引。第二个电话向左移动。最后一次调用将需要覆盖`top-left`最多的索引。

在您的方法中，您只需使用公式编写逻辑来填充您传递的当前索引。是的，不要忘记基本条件，即当任一索引小于 0 时，立即返回。

所以，这就是你的方法的样子： -

```
public static void fill(int[][] arr, int row, int col) {
    arr[row][col] = arr[row][col + 1] + arr[row + 1][col] + arr[row + 1][col + 1];
    if (row <= 0 || col <= 0) {
        return;
    }
    fill(arr, row - 1, col);
    fill(arr, row, col - 1);
    fill(arr, row - 1, col - 1);
} 
```

初始调用如下： -

```
fill(arr, row - 2, col - 2); 
```

哪里`row`是最大行大小和`col`最大列大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T20:57:32.607

```
preencheComSomaVizinhos (int[][]m){
    get(m,0,0)
}
get(int[][]m, int i, int j){
    if(!(i == m.length-1 || j==m.length-1)){
        m[i][j] = get(m, i, j+1) + get(m,i+1,j)+get(m,i+1,j+1);

    }
    return m[i][j]; 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T21:24:28.720

我会把它写成在行号和列号上递归，当你在最后一行时有一个基本情况。如果数组是方形的，你只需要一个递归参数（我假设是这种情况）。

在递归的过程中，你会遇到这样的情况：

```
0 0 0 0 0 *
0 x + + + *  <- currently working on row k
0 - & & & *
0 - & & & *
0 - & & & *
* * * * * * 
```

在你开始之前，`*`s 已经被填满了。然后调用带有参数的递归函数`k+1`，它会填充所有标记的单元格`&`。然后，您必须手动填写标有 s 的行、标有`+`s 的列`-`以及标有 的角上的单个单元格`x`。然后您将控制权传回给调用您的函数，该函数将填充标记为 的其余单元格`0`。

我已经有一年没有真正写过 Java了，请原谅我草率的语法！

```
void fillNeighbours(int[][] m) {

  int size = m.length;

  run(m, size, 0);  

}

void run(int[][] m, size, row) {

  if (row < size) {

    // fill the rest of the rows and cols
    run(m, size, row+1)

    // fill the column and row for this iteration
    for (int i = 1; size-i > row; i++) {
      m[row][size-i] = m[row+1][size-i] + m[row][size-i+1];
      m[size-i][row] = m[size-i+1][row] + m[size-i][row+1];
    }

    // fill the corner cell
    m[row][row] = m[row+1][row] + m[row][row+1];

  } else {
    // Base case, do nothing
  } 

} 
```

# c++ - c++ 中的字符串中的函数是否仅适用于第一个字符？

> ID：14176191
> 
> 赞同：0
> 
> 时间：2013-01-05T20:39:34.857
> 
> 标签：c++

我想`char`在 a 中找到`string`由数字和字符组成的 a，如果发现程序执行了一些操作，但是当我使用函数时`find()`，如果我要查找的字符仅在字符串的**开头**，它只会返回 true ！！！ ！！

例如：这是问题的一部分！
用户输入 3 个字符串 s1 , s2 , s3 ; 在前 2 个字符串之间有 char`'a' = '+'`并且在 s2 和 s3 之间有 char `'b' = '='` （这 3 个字符串应该是 numbers ）但是如果 s2 是一个包含字母的单词`'m'`，则程序将 s1 和 s3 转换为整数并写入完整的操作 ex ：如果 i/p 是 3247 + 5machula2 = 3749 那么 o/p 将是 3247 + 502 = 3749

这是我要解决的问题[http://www.spoj.com/problems/ABSYS/](http://www.spoj.com/problems/ABSYS/) 和我的这部分代码有问题：

```
int T;
int x,y,z;
string s1 ;
string s2  , s3 ;
char a , b;
cin>>T;
for(int i=0 ; i<T ; i++)
{
         cin>>s1>>a>>s2>>b>>s3;

for (int k=0; k<s2.size(); k++)
{ 
    if (k==s2.find("m"))
    {     
        stringstream ss(s1);
        stringstream ss3(s3);

        ss>>x;
        ss3>>z;

        cout<<s1<<" "<<a<<" "<<z-x<<" "<<b<<" "<<s3<<endl;
    }   
    else break;       
} 
```

这是一个在第二个字符串上循环的循环，如果它找到一个字符`'m'`，它应该执行上面提到的操作，但这里的问题是它只有`'m'`在字符串的开头而不是其他地方才有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:45:49.727

您`else break;`可以防止循环循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:46:20.340

它仅在开始时才起作用的原因是，如果不是，则您会跳出循环，因此它没有机会检查其余部分：

```
[first iteration]
if (0 == s2.find("m")) //if found at beginning
    //do stuff
else break; //exit loop if not found at beginning 
```

而不是循环，如果你只是想看看是否有一个 m，只需使用`find()`：

```
if (s2.find('m') != std::string::npos)
    //"m" found in string, do the operations on s1 and s3 
```

# perl - 获取特定之间的 html 内容 仅标记

> ID：14176193
> 
> 赞同：0
> 
> 时间：2013-01-05T20:39:44.687
> 
> 标签：perl, html-parsing

`<div id=aaa-bbb>`我编写了以下代码来抓取和下一个标签之间的文本内容`</div>`，但它只打印出整个 HTML 源代码。

```
use LWP::Simple;

$url = 'http://domain.com/?xxxxxxx';

my $content = get($url);

$data =~ m/<div id="aaa-bbb">(.*?)<\/div>/g;

if (is_success(getprint($url))) {
    print $_;
 }

# or using the following line directly without if statement
print $data; 
```

我感兴趣的 HTML 片段如下所示：

```
<div id="aaa-bbb">
<p>text text text text text text text text text</p><p>text text text</p>
</div> 
```

该特定`div`标签 ID 在整个 HTML 文档中只出现一次。

我还希望`<p></p>`通过换行符去除标签或整理输出，以便以后存储为文本文件或重用。

在阅读了您的宝贵意见后，我尝试使用 [`WWW::Mechanize`](https://metacpan.org/module/WWW%3a%3aMechanize) and [`WWW::Mechanize::TreeBuilder`](https://metacpan.org/module/WWW%3a%3aMechanize%3a%3aTreeBuilder) 代替，像这样

```
use strict;
use warnings;

use WWW::Mechanize; 
use WWW::Mechanize::TreeBuilder; 

my $mech = WWW::Mechanize->new; 
WWW::Mechanize::TreeBuilder->meta->apply($mech); 

$mech->get( 'domain.com/?xxxxxx' ); 

my @list = $mech->find('div id="aaa-bbb"'); # or <div id="aaa-bbb"> or "<div id="aaa-bbb">"
foreach (@list) { 
  print $_->as_text(); 
} 
```

它适用于简单的标签，但无法使用`<div id="aaaa">`. 它只是退出脚本而不打印任何内容。我使用了双引号和单引号，它在标签 ID 中已经有双引号。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T04:39:42.777

这种类型的解析使用 DOM 解析器要容易得多。我选择的解析器是[Mojo::DOM](http://p3rl.org/Mojo::DOM)，它是[Mojolicious](http://mojolicio.us)套件的一部分。

```
#!/usr/bin/env perl

use strict;
use warnings;

use Mojo::UserAgent;
my $ua = Mojo::UserAgent->new;

my $dom = $ua->get( 'domain.com/?xxxxxx' )->res->dom; 

my $text = $dom->at('#aaa-bbb')->all_text; 
```

该`at`方法是该方法的一个特例`find`，它查找所有实例；`at`找到第一个（或在您的情况下，仅）。这`#`是 id 的[CSS](http://p3rl.org/Mojo::DOM::CSS)选择器语法。

# php - 如何获取 MySQL 表行的大小（以 MB 为单位）？

> ID：14176195
> 
> 赞同：1
> 
> 时间：2013-01-05T20:39:56.433
> 
> 标签：php, mysql

我知道如何获取表的大小，但如何查询单个表行的大小（以兆字节为单位）？

[这里](http://www.sitepoint.com/forums/showthread.php?501755-PHP-get-row-size-%28bytes%29-from-MySQL)的帖子建议：

```
$rowLength = 0; 
$result = mysql_query("SELECT id,email FROM people WHERE id = '42'"); 

if(!$result) { 
    die('Could not run query'); 
}    

$lengths = mysql_fetch_lengths($result); 

foreach($lengths as $length) { 
    $rowLength += $length; 
}    

echo "\$rowLength = $rowLength"; 
```

...但解决方案似乎会累积字段长度值，我需要字节大小（转换为 Mb）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:04:32.000

行的大小取决于使用的引擎，我认为没有黄金法则。

例如，使用*InnoDB*，您可以使用以下规范来确定行的大小：http: [//dev.mysql.com/doc/refman/5.5/en/innodb-physical-record.html](http://dev.mysql.com/doc/refman/5.5/en/innodb-physical-record.html)。如果你使用*MyISAM*，你应该遵循：[http](http://dev.mysql.com/doc/refman/5.5/en/myisam-table-formats.html) ://dev.mysql.com/doc/refman/5.5/en/myisam-table-formats.html 。

# delphi - Initialize()、Default() 和 FillChar() 之间的区别

> ID：14176198
> 
> 赞同：10
> 
> 时间：2013-01-05T20:40:12.393
> 
> 标签：delphi, initialization

假设您有一个要初始化的本地记录：

```
type 
  TMyRec=record
    Val1, Val2:Integer;
  end;

procedure MyProc;
var
  MyVar:TMyRec;
begin
  // ... ?

  WriteLn(Val1,Val2);
end; 
```

除了“手动”设置每个字段外，还有几种方法可以做到这一点。

1.  使用**初始化**（）：

    ```
    Initialize(MyVar); 
    ```

2.  使用**默认**（）：

    ```
    MyVar := Default(TMyVar); 
    ```

3.  使用**FillChar**：

    ```
    FillChar(MyVar,SizeOf(MyVar),0); 
    ```

4.  定义一个空**常量**，并将其分配给 var

    ```
    const cMyVar:TMyVar=();  
    ...    
    MyVar := cMyVar; 
    ```

以上所有似乎都适用于这个例子的情况。我猜你甚至可以定义一个全局变量来初始化它。

但是有没有首选的方法？或者在某些情况下不建议使用上述任何一种，或者它根本不起作用？

简而言之，初始化本地堆栈变量*^的**明确正确方法是什么？*:-)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-05T21:11:21.877

永远不要[`Initialize`](http://docwiki.embarcadero.com/Libraries/en/System.Initialize)用于局部变量。

> Initialize 只能在 Delphi 代码中使用，其中变量是通过 New 标准过程以外的其他方式动态分配的。

更重要的是，由于它不包含任何托管类型，因此它会被优化为带有您的记录的 nop。所以，我们可以放弃这个选项，将场地减少到三个竞争者。

其余三个竞争者对未初始化的局部变量都有相同的效果。但是，`FillChar`在带有托管成员的局部变量上使用是有风险的，例如字符串、接口引用、变体等。如果托管成员已被初始化，那么您将破坏引用计数机制。但是，如果您确定该记录尚未初始化，那么`FillChar`它是安全有效的，尽管在我看来相当难看。就个人而言，我会拒绝`FillChar`这个角色。

剩下`Default(T)`的就是不断的赋值。在旧版本的 Delphi 中，您只能使用常量赋值。可以公平地说，当`FillChar`您声明常量时，常量赋值与 一样难看。因此，在我看来，在现代 Delphi 版本中，我会选择它，`Default()`因为它更简洁且可读性更好。

正如[在涵盖类似基础的问题中所讨论的那样，](https://stackoverflow.com/questions/11065821/how-to-properly-free-records-that-contain-various-types-in-delphi-at-once#11066205)`Default(T)`当您分配给变量时，编译器会生成非常高效的代码。

# c++ - 重写构造函数 C++

> ID：14176199
> 
> 赞同：1
> 
> 时间：2013-01-05T20:40:19.820
> 
> 标签：c++, inheritance, constructor

我有抽象类A

```
class A{
 public:
  A(dim) : dim_(dim);
 private:
  int dim_;
} 
```

和B级

```
class B : public A{
 public:
  B(int dim);
} 
```

我需要为 B 类创建构造函数，它仅在 dim > 1 时有效，否则抛出断言。

在这种情况下

```
B::B(int dim) : A(dim){
  assert(dim > 1);
} 
```

它有效，但我认为这不是一个好的解决方案，因为创建和删除了类 A 的实例。

比我为 A 类创建 init 方法：

```
class A{
 public:
  void init(int dim){
    dim_ = dim;
  }
  A(int dim){
    init(dim);
  }
 private:
  int dim_;
} 
```

并更改 B 类的构造函数：

```
class B : public A {
 public:
  B(int dim){
    assert(dim > 1);
    init(dim);
  }
} 
```

但它不起作用。我的问题有什么可能的解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T20:45:39.997

我认为您可以编写一个小`myint`课程，以确保`int`您通过的始终大于`1`：

```
struct myint
{
    int data; 
    myint(int i) : data(i) { assert(data > 1); }
}; 
```

现在在你的课堂上使用它：

```
class B : public A{
 public:
  B(myint dim) //this can still take int, due to implicit conversion! 
   : A(dim.data) { }
} 
```

请注意，您仍然可以构造`B`pass `int`，因为它会隐式转换为`myint`，并且在转换发生时（隐式），它将测试*assert*，如果成功，只有这样您才能传递`dim.data`给 base class `A`。如果*断言*失败，您的程序将在进入基类构造函数之前中止（也不会在派生类中初始化任何内容）。

* * *

您甚至可以将其概括为：

```
//Summary : gint<N> makes sure that data > N
template<int N>
struct gint  //call it greater int
{
    int data; 
    gint(int i) : data(i) { assert(data > N); } //Use N here!
}; 
```

现在在你的课堂上使用它：

```
class B : public A{
 public:
  B(gint<1> dim) //the template argument 1 makes sure that dim.data > 1
   : A(dim.data) { }
} 
```

如果您需要其他课程，例如：

```
class Xyz : public A{
 public:
  B(gint<10> dim)  //gint<10> makes sure that dim.data > 10
   : A(dim.data) { }
} 
```

酷，不是吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:46:10.397

如果你想让你的第二个选项起作用，你必须添加一个空的构造函数到`A`. 然而，这对你没有太大帮助，因为`A`对象是在你进入构造函数之前创建的`B`，因此无论你有一个空构造函数还是一个接受 int 类型对象的构造函数，你总是会构造一个类型的对象`A`。

如果 A 像您在此示例中显示的那样简单，我相信即使对于无效的暗淡，构建它也没什么大不了的。如果它更复杂，我建议你为 A 创建一个 ampty 构造函数，它尽可能少地初始化 A 的一部分，然后是一个`init`方法来做更复杂的事情。

# ruby-on-rails - 嵌套表单 has_many

> ID：14176200
> 
> 赞同：4
> 
> 时间：2013-01-05T20:40:29.540
> 
> 标签：ruby-on-rails, ruby-on-rails-3, nested-forms

我不确定如何正确创建带有嵌套表单的 Rails 表单。我已经学习了很多教程，但变得更加困惑应该是什么，单数复数，控制器......这是我的模型

模型/事件.rb

```
 attr_accessible :description :title, :tag_ids, :locations_attributes
  has_many :location
  accepts_nested_attributes_for :location, :allow_destroy => true 
```

模型/位置.rb

```
 attr_accessible :address, :customer_id, :event_id, :latitude, :longitude
  belongs_to :customer
  belongs_to :event 
```

控制器.rb

```
 def new
    @event = Event.new
    ...
  def create
    @event = Event.new(params[:event])
    ... 
```

查看 form.html.erb

```
<%= form_for(@event) do |f| %>
  <%= f.fields_for :locations do |e| %>
    <%= e.text_field :longitude %>
    <%= e.text_field :latitude %>
  <% end %>
  ...
<% end %> 
```

错误

```
Can't mass-assign protected attributes: locations 
```

参数发送

```
 "locations"=>{"longitude"=>"45.6666",
 "latitude"=>"47.44444665"}, 
```

要么我的关系是错误的，因为 fields_for 不支持它，要么我的控制器不合适，要么 rails 不是一门好语言，或者我不再理解它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:44:09.590

你……快到了……

event.rb - 位置不是位置

```
attr_accessible :description :title, :tag_ids, :locations_attributes
has_many :locations
accepts_nested_attributes_for :locations, :allow_destroy => true 
```

我认为应该这样做

**编辑**

正如 Valery Kvon 所说，您需要添加

```
@event.locations.build 
```

到你的控制器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T21:46:05.207

爱德华的回答 +

```
def new
  @event = Event.new
  @event.locations.build
end 
```

# php - 使用php查询mysql数据库

> ID：14176202
> 
> 赞同：0
> 
> 时间：2013-01-05T20:40:36.820
> 
> 标签：php, mysql

我搜索了谷歌和在这里，一些信息很有用，但大多不是那么有用，仍然无法使用 php 查询我的数据库。我对编码很陌生，所以认为最好根据我的代码找到答案，而不是其他人略有不同的问题。我有一个小型数据库，人们填写表格希望租用公共汽车。我已经创建了一个日历，并希望根据人们输入的已发送到我的数据库的数据打印出每天的什么时间和多长时间有一个雇佣，如果有的话。显示整个页面，但日历在其表格中包含一个错误：

“您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 ''2013-03-01' 附近使用正确的语法”

即使我删除了查询的“where date=..”部分，它也会继续显示这一点。我尝试了几种不同的方法来编写代码，包括循环，但不包括循环，但我不确定我的意思是做什么。

编辑：我的代码现在是：

```
<?php
$con = mysql_connect("localhost","user","password");

$result = mysql_query("SELECT time, length FROM hire WHERE date='01-03-13'");
$row = mysql_fetch_assoc($result);

$Time = $row['TIME'];
$Length = $row['LENGTH'];

echo "Time: " . $TIME . "<br/>";
echo "Length: " . $LENGTH . "<br/>";

?> 
```

我现在收到错误“警告：mysql_fetch_assoc()：提供的参数不是第 123 行 C:\Users\Laura\Documents\COMPY\server\www\calendar.php 中的有效 MySQL 结果资源”它显示页面，日历和“时间”和“长度”，但有错误且没有数据

编辑

```
<?php
$con = mysql_connect("localhost","user","password");
mysql_select_db("busassociation", $con);                 
$result = mysql_query("SELECT time, length FROM hire WHERE date='01-03-13'");

while ($row = mysql_fetch_assoc($result)){

$time = $row['time'];
$length = $row['length'];

echo "time: " . $time . "<br/>";
echo "length: " . $length;

}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:44:11.617

使用反引号

```
 $result = mysql_query("SELECT `time`, `length` FROM `hire` WHERE `date`= '2013-03-01' "); 
```

**编辑。**

您正在获取您的查询两次。

```
 $row = mysql_fetch_row($result);   <------- delete this line

 while( $row = mysql_fetch_row($result) ){ 
```

**EDIT.2**

我想你不明白两者之间的区别

`mysql_fetch_assoc()`和`mysql_fetch_row()`

如果您使用`mysql_fetch_assoc()` **它将在您的代码中是正确的。**

但是如果你`mysql_fetch_row()`像你在你的代码中所做的那样使用你必须回显这样的值

```
 $Time = $row['1']; // suppose that `TIME` is the second column
 $Length = $row['2']; // suppose that `LENGTH` is the third column 
```

**EDIT.3**

```
 <?php
 $con = mysql_connect("localhost","user","password");
 mysql_select_db("your_db", $con);                  <---------replace by your database
 $result = mysql_query("SELECT time, length FROM hire WHERE date='01-03-13'");

while ($row = mysql_fetch_assoc($result)){

 $Time = $row['time'];
 $Length = $row['length'];

 echo "Time: " . $Time . "<br/>";
 echo "Length: " . $Length . "<br/>";

 }
 ?> 
```

# c++ - 对前 N 个素数求和

> ID：14176205
> 
> 赞同：0
> 
> 时间：2013-01-05T20:41:01.197
> 
> 标签：c++, sum

我需要创建一个将“N”作为输入的程序，并显示前 N 个素数，最后将它们相加……这是我的代码，但它不起作用。（它循环在：“if ((num == 2) || (num == 3))”）

你能帮助我吗？提前致谢。

我不能使用函数和数组。

代码：

```
#include "stdafx.h"
#include <iostream>

using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{
    int n, num = 1, rest, cont = 0, sum = 0;
    bool exit = false;
    int e = 1;

    cout<<"How many prime number do you want to show? ";
    cin>>n;

    while (cont <= n)
    {
        num++;
        if ((num == 2) || (num == 3))
        {
            cout<<num<<endl;
            sum += num;
            cont++;
        }
        else if (num%2 == 0)
        {
        }
        else
        {
            bool exit = false;
            int div = 3;
            while (!exit)
            {
                rest = num%div;

                if (num == div)
                {
                    exit = true;
                    cout<<num<<endl;
                    sum += num;
                    cont++;
                }

                if (rest == 0)
                    exit = true;                    
                div++;
            }
        }       
        num++;
    }    
    cout<<"Sum: "<<sum<<endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:50:02.903

首先，您使用的是变量名`resto`而不是`rest`，这是您声明它的名称 ( `if (resto == 0)`)。

其次，你增加`num`了两次：在循环的开始和结束时。删除最后一个`num++`，它应该会更好地工作。

第三，初始化`cont`为 1 而不是 0，否则它将计算前 N+1 个素数的总和，而不是前 N 个素数。

这是您的代码的固定版本：

```
#include <iostream>

using namespace std;

int main()
{
    int n, num = 1, rest, cont = 1, sum = 0;
    bool exit = false;
    int e = 1;

    cout<<"How many prime number do you want to show? ";
    cin>>n;

    while (cont <= n)
    {
        num++;
        if ((num == 2) || (num == 3))
        {
            cout<<num<<endl;
            sum += num;
            cont++;
        }
        else if (num%2 == 0)
        {
        }
        else
        {
            bool exit = false;
            int div = 3;
            while (!exit)
            {
                rest = num%div;

                if (num == div)
                {
                    exit = true;
                    cout<<num<<endl;
                    sum += num;
                    cont++;
                }

                if (rest == 0)
                    exit = true;

                div++;
            }
        }
    }
    cout<<"Sum: "<<sum<<endl;

    return 0;
} 
```

# javascript - 如何在街景模式下像标记一样显示 google.maps.Circle？

> ID：14176211
> 
> 赞同：4
> 
> 时间：2013-01-05T20:41:26.353
> 
> 标签：javascript, google-maps-api-3, google-street-view

我创建了一些`google.maps.Marker`并绑定 `google.maps.Circle`到它（见下文）：

![在此处输入图像描述](../Images/3d11b20f92fdd621fdef2802814a9bd4.png)

但是当我打开街景时，我只看到标记：

![在此处输入图像描述](../Images/7f460d032491600cc1f728850da3d884.png)

有人知道如何在街景模式下显示 Circle 吗？

听起来我不能这样做。

也许有人知道如何在 Google-Street-View 中显示 2D/3D 对象。

有什么建议吗？

谢谢，

这是代码片段：

```
 var circle = {
        strokeColor: "#006DFC",
        strokeOpacity: 0.4,
        strokeWeight: 2,
        fillColor: "#006DFC",
        fillOpacity: 0.15,
        map: mapA,
        center: selectedMarker.getPosition(),
        radius: 50 // in meters

    };
    var cityCircle = new google.maps.Circle(circle);                 
    cityCircle.bindTo('center', selectedMarker, 'position'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T12:49:29.447

您可以使用符号而不是 a`google.maps.Circle`来绘制圆圈，它将在全景图上可见。

获得 3D 效果会更复杂，但应该可以在全景图的 pov_changed-event 上修改符号的路径。

# c# - 将Base64图像字符串从objective-c上传到MVC .Net C#

> ID：14176220
> 
> 赞同：3
> 
> 时间：2013-01-05T20:42:21.700
> 
> 标签：c#, objective-c, ios, base64

我正在尝试将 Base64 图像字符串从 iOS（使用 NSData+Base64）上传到 MVC .Net。上传没问题，但是当我尝试将字符串转换回图像时，在行抛出异常：

```
byte[] imageBytes = Convert.FromBase64String(imageString); 
```

例外：*“Base-64 字符数组的长度无效”*

在 iOS 中转换的 imageString 长度为 944062。

为了验证长度，我在 .Net 中使用

```
string fota = ImageToBase64(Image.FromFile(@"C:\PR\Source\Servicea\bin\Imag043.jpg"), System.Drawing.Imaging.ImageFormat.Jpeg); 
```

大小为203956。原始图像文件大小为156,967。

两种方法都不应该转换返回相同字符串的图像？以前有人遇到过这个问题吗？Tks

**更新：**经过多次测试，我决定使用[ASIHTTPRequest 库。](http://allseeing-i.com/ASIHTTPRequest/)谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-31T12:59:04.753

尝试使用这个：

```
#import <CommonCrypto/CommonDigest.h>
#include <stdlib.h>

static char base64EncodingTable[64] = {
    'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P',
    'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f',
    'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v',
    'w', 'x', 'y', 'z', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '+', '/'
};

+ (NSString *) base64StringFromData: (NSData *)data length: (int)length {
    unsigned long ixtext, lentext;
    long ctremaining;
    unsigned char input[3], output[4];
    short i, charsonline = 0, ctcopy;
    const unsigned char *raw;
    NSMutableString *result;

    lentext = [data length];
    if (lentext < 1)
        return @"";
    result = [NSMutableString stringWithCapacity: lentext];
    raw = [data bytes];
    ixtext = 0;

    while (true) {
        ctremaining = lentext - ixtext;
        if (ctremaining <= 0)
            break;
        for (i = 0; i < 3; i++) {
            unsigned long ix = ixtext + i;
            if (ix < lentext)
                input[i] = raw[ix];
            else
                input[i] = 0;
        }
        output[0] = (input[0] & 0xFC) >> 2;
        output[1] = ((input[0] & 0x03) << 4) | ((input[1] & 0xF0) >> 4);
        output[2] = ((input[1] & 0x0F) << 2) | ((input[2] & 0xC0) >> 6);
        output[3] = input[2] & 0x3F;
        ctcopy = 4;
        switch (ctremaining) {
            case 1:
                ctcopy = 2;
                break;
            case 2:
                ctcopy = 3;
                break;
        }

        for (i = 0; i < ctcopy; i++)
            [result appendString: [NSString stringWithFormat: @"%c", base64EncodingTable[output[i]]]];

        for (i = ctcopy; i < 4; i++)
            [result appendString: @"="];

        ixtext += 3;
        charsonline += 4;

        if ((length > 0) && (charsonline >= length))
            charsonline = 0;
    }
    return result;
} 
```

# java - 使用paintComponent的Java幻灯片图像延迟

> ID：14176225
> 
> 赞同：4
> 
> 时间：2013-01-05T20:43:01.043
> 
> 标签：java, image, slideshow, paintcomponent, swingworker

我正在整理一个幻灯片程序，该程序将测量用户在每张幻灯片上花费的时间。幻灯片展示了几种不同的魔术技巧。每个技巧显示两次。中间图像显示在重复之间。每个技巧之间都会显示过渡图像。

在第一次重复一个技巧时，JPanel 颜色在单击后在屏幕上闪烁，然后显示下一个图像。在第二次重复相同技巧时不会发生这种情况。图片可能加载时间过长。

有没有一种简单的方法来预加载图像，以便第一次没有延迟？

```
NOTE: Original code deleted. 
```

编辑 1/10/2013：此代码现在适用于速度较慢的机器。垃圾神的第二个附录帮助最大。mouseClick 控制结构定期要求 SwingWorker 类加载当前技巧的 40 个或更少的图像，同时还将使用的图像设置为空。我已经将我的代码简化为只有两个 Image[] 并添加了一个 main 方法，因此它是独立的。图像仍然需要运行。现在这是非常简单的代码，如果您尝试制作包含大量图像的幻灯片，我认为这将是一个不错的起点。

注意：我想我想出了如何在仍然使用多个 Image[] 的同时正确实现 SwingWorker。垃圾神和 kleopatra 这个实现是否符合您的建议？我最终没有使用发布和处理，因为我无法弄清楚如何让它与索引数组一起正常工作，但是因为 StringWorker 不会加载数组中的所有图像（只有 40 个），并且代码每 20 个图像调用一次 StringWorker，应该有一个相当不错的缓冲区。

编辑 2013 年 1 月 10 日通过在我的 Mouse 类上扩展 MouseAdapter 来更改 MouseListener。还修复了我的paintComponent 方法以包含对super.paintComponent(g) 的调用。向我的 SwingWorker 类 ImageWorker 添加了发布/处理方法。添加了一个包装类 ArrayWrapper 以允许将 imageArray[i] 及其对应的索引 int i 与发布一起传递给进程。

```
package slideshow3;

import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.MouseEvent;
import java.awt.event.MouseAdapter;
import java.io.File;
import java.io.IOException;
import javax.imageio.ImageIO;
import java.util.List;

public class SlideShow3 extends JFrame
{
    //screenImage will be replaced with each new slide
    private Image screenImage;
    private int width;
    private int height;

    //Create panel for displaying images using paintComponent()
    private SlideShow3.PaintPanel mainImagePanel;

    //Used for keybinding
    private Action escapeAction;

    //Image array variables for each trick
    private Image[] handCuffs; //h
    private Image[] cups; //c

    //Used to step through the trick arrays one image at a time
    private int h = 0;
    private int c = 0;

    //Used by timeStamp() for documenting time per slide
    private long time0 = 0;
    private long time1;

    public SlideShow3()
    {
        super();

        //Create instance of each Image array
        handCuffs = new Image[50];
        cups = new Image[176];

        //start(handCuffsString);
        start("handCuffs");

        try
        {
            screenImage = ImageIO.read(new File("images/begin1.jpg"));
        }
        catch (IOException nm) 
        {
            System.out.println("begin");
            System.out.println(nm.getMessage());
            System.exit(0);
        }

        /****************************************** 
         * Removes window framing. The next line sets fullscreen mode.
         * Once fullscreen is set width and height are determined for the window
         ******************************************/

        this.setUndecorated(true);
        GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice().setFullScreenWindow(this);
        width = this.getWidth();
        height = this.getHeight();

        //Mouse click binding to slide advance control structure
        addMouseListener(new Mouse());

        //Create panel so that I can use key binding which requires JComponent
        mainImagePanel = new PaintPanel();      
        add(mainImagePanel);

        /****************************************** 
         * Key Binding
         * ESC will exit the slideshow
         ******************************************/

        // Key bound AbstractAction items 
        escapeAction = new EscapeAction();

        // Gets the mainImagePanel InputMap and pairs the key to the action
        mainImagePanel.getInputMap().put(KeyStroke.getKeyStroke("ESCAPE"), "doEscapeAction");

        // This line pairs the AbstractAction enterAction to the action "doEnterAction"
        mainImagePanel.getActionMap().put("doEscapeAction", escapeAction);

        /******************************************
         * End Key Binding
         ******************************************/
    }

    public static void main(String[] args) 
    {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() 
            {
                SlideShow3 show = new SlideShow3();
                show.setVisible(true);
            }
        });
    }

    //This method executes a specific SwingWorker class to preload images
    public void start(String e) 
    {
        if(e.equals("handCuffs"))
        {
            new ImageWorker(handCuffs.length, h, e).execute();
        }
        else if(e.equals("cups"))
        {
            new ImageWorker(cups.length, c, e).execute();
        }
    }

    //Stretches and displays images in fullscreen window
    private class PaintPanel extends JPanel
    {
        @Override
        public void paintComponent(Graphics g) 
        { 
            if(screenImage != null)
            {
                super.paintComponent(g);
                g.drawImage(screenImage, 0, 0, width, height, this);
            }  
        }
    }

    /******************************************
     * The following SwingWorker class Pre-loads all necessary images.
     ******************************************/

    private class ArrayWrapper
    {
        private int i;
        private Image image;

        public ArrayWrapper(Image image, int i)
        {
            this.i = i;
            this.image = image;
        }

        public int getIndex()
        {
            return i;
        }

        public Image getImage()
        {
            return image;
        }
    }

    private class ImageWorker extends SwingWorker<Image[], ArrayWrapper>
    {
        private int currentPosition;
        private int arraySize;
        private String trickName;
        private Image[] imageArray;

        public ImageWorker(int arraySize, int currentPosition, String trick)
        {
            super();
            this.currentPosition = currentPosition;
            this.arraySize = arraySize;
            this.trickName = trick;
        }

        @Override
        public Image[] doInBackground()
        {
            imageArray = new Image[arraySize];
            for(int i = currentPosition; i < currentPosition+40 && i < arraySize; i++)
            {
                try 
                {
                    imageArray[i] = ImageIO.read(new File("images/" + trickName + (i+1) + ".jpg"));
                    ArrayWrapper wrapArray = new ArrayWrapper(imageArray[i], i);
                    publish(wrapArray);
                } 
                catch (IOException e) 
                {
                    System.out.println(trickName);
                    System.out.println(e.getMessage());
                    System.exit(0);
                }
            }
            return imageArray;
        }

        @Override
        public void process(List<ArrayWrapper> chunks)
        {
            for(ArrayWrapper element: chunks)
            {
                if(trickName.equals("handCuffs"))
                {
                    handCuffs[element.getIndex()] = element.getImage();
                }
                else if(trickName.equals("cups"))
                {
                    cups[element.getIndex()] = element.getImage();
                }
            }
        }

        @Override
        public void done()
        {
            try
            {
                if(trickName.equals("handCuffs"))
                {
                    handCuffs = get();
                }
                else if(trickName.equals("cups"))
                {
                    cups = get();
                }
            }
            catch(InterruptedException ignore){}
            catch(java.util.concurrent.ExecutionException e)
            {
                String why = null;
                Throwable cause = e.getCause();
                if(cause != null)
                {
                    why = cause.getMessage();
                }
                else
                {
                    why = e.getMessage();
                }
                System.err.println("Error retrieving file: " + why);
            }
        }
    }

     /******************************************
     * End SwingWorker Pre-Loading Classes
     ******************************************/

    //Prints out time spent on each slide
    public void timeStamp()
    {
        time1 = System.currentTimeMillis();
        if(time0 != 0)
        {
            System.out.println(time1 - time0);
        }
        time0 = System.currentTimeMillis();
    } 

    /******************************************
     * User Input Classes for Key Binding Actions and Mouse Click Actions
     ******************************************/

    private class EscapeAction extends AbstractAction
    {
        @Override
        public void actionPerformed(ActionEvent e)
        {
            System.exit(0);
        }
    }

    public class Mouse extends MouseAdapter
    {
        @Override
        public void mouseClicked(MouseEvent e) 
        {
            if(!(h<handCuffs.length) && !(c<cups.length))
            {
                timeStamp();
                System.exit(0);
            }
            else if(h<handCuffs.length)
            {
                timeStamp();
                screenImage = handCuffs[h];
                repaint();
                System.out.print("handCuffs[" + (h+1) + "]\t");
                h++;
                //purge used slides and refresh slide buffer
                if(h == 20 || h == 40)
                {
                    for(int i = 0; i < h; i++)
                    {
                        handCuffs[i] = null;
                    }
                    start("handCuffs");
                }
                if(h == 45)
                {
                    start("cups");
                }
            }
            else if(c<cups.length)
            {
                timeStamp();
                screenImage = cups[c];
                repaint();
                System.out.print("cups[" + (c+1) + "]\t");
                c++;
                //purge used slides and refresh slide buffer
                if(c == 20 || c == 40 || c == 60 || c == 80 || c == 100 || c == 120 || c == 140 || c == 160)
                {
                    for(int i = 0; i < c; i++)
                    {
                        cups[i] = null;
                    }
                    start("cups");
                }
            }
        }
    }

    /******************************************
     * End User Input Classes for Key Binding Actions and Mouse Click Actions
     ******************************************/ 
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T21:01:21.220

此[示例](https://sites.google.com/site/drjohnbmatthews/googleolympiad)使用 a`List<ImageIcon>`作为`cache`由`getImage()`. 使用`getResource()`，延迟是不可察觉的。下一个和上一个按钮默认绑定到`Space`键。

`setEnabled()`附录：您可以通过使用 的实例来调节按钮的状态来控制导航`javax.swing.Timer`，[例如](https://stackoverflow.com/a/7934589/230513).

附录：您的第二个示例等到单击鼠标开始读取图像，这是一个不确定的过程，可能会立即返回副本，也可能要等到*之后**才能*完成。相反，使用 开始阅读背景中的图像，如此[处](https://stackoverflow.com/a/4530659/230513)所示。您可以显示进度，如此[处所示](https://stackoverflow.com/a/4637725/230513)。可以从[初始线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)启动，在您随后在 EDT 上构建 GUI 时运行。您可以在处理完第一张图像后立即显示它。 *`repaint()``ImageIO.read()``process()``List<Image>``SwingWorker`*

# python - 错误说 \\\\Ref\\builds/out 存在但它不存在

> ID：14176227
> 
> 赞同：0
> 
> 时间：2013-01-05T20:43:19.733
> 
> 标签：python, shutil

我正在尝试使用以下代码复制源代码树并遇到错误，我不确定为什么会出现此错误？错误说 \\Ref\builds/out 存在但它不存在，“out”是目录脚本试图复制到目标的源位置，如果shutil不适合这种类型的复制，还有其他方法可以复制吗？

```
//local/mnt/workspace/04.01_HY11/out
\\Ref\builds/out
copying
Traceback (most recent call last):
  File "test.py", line 21, in <module>
    main()
  File "test.py", line 18, in main
    copytree(src,dst)
  File "test.py", line 11, in copytree
    shutil.copytree(s, d)
  File "/pkg/qct/software/python/2.5.2/.amd64_linux26/lib/python2.5/shutil.py", line 110, in copytree
    os.makedirs(dst)
  File "/pkg/qct/software/python/2.5.2/.amd64_linux26/lib/python2.5/os.py", line 171, in makedirs
    mkdir(name, mode)
OSError: [Errno 17] File exists: '\\\\Ref\\builds/out' 
```

Python代码

```
import os,shutil

def copytree(src, dst, symlinks=False, ignore=None):
    for item in os.listdir(src):
        s = os.path.join(src, item)
        print s
        d = os.path.join(dst, item)
        print d
        if os.path.isdir(s):
            print "copying"
            shutil.copytree(s, d, symlinks, ignore)
        else:
            shutil.copy2(s, d)
def main ():
    src="//local/mnt/workspace/04.01_HY11"
    dst="\\\\Ref\\builds"
    copytree(src,dst)

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:32:17.187

[文档`shutil.copytree`](http://docs.python.org/2/library/shutil.html#shutil.copytree)清楚地说：

> 以 命名的目标目录`dst`必须不存在；它将被创建以及缺少父目录。

但`\\ref\builds\out`已经存在——您可以从异常的堆栈跟踪中看到它正在尝试访问`mkdir`该路径，但失败并显示该路径已存在的错误（当路径作为常规文件或目录存在时可能会发生这种情况）。

您需要通过选择其他路径或首先删除该位置的现有树来复制到尚不存在的路径。后者可以用`shutil.rmtree`.

# vb.net - XmlReader 解析错误

> ID：14176232
> 
> 赞同：1
> 
> 时间：2013-01-05T20:43:55.033
> 
> 标签：vb.net, silverlight, xml-parsing, xmlreader

我生成的 XML 如下：

```
<helpers>
         <person>
                 <latitude>17.123</latitude>
                 <longitude>83.322</longitude>
         </person>
         <person>
                 <latitude>17.123</latitude>
                 <longitude>83.322</longitude>
         </person>
</helpers> 
```

我在 POST 到网页后收到 XML 作为响应。我的 VB.net 代码如下：

```
Using reader = XmlReader.Create(New StringReader(e.Result.ToString()))
        While reader.Read()
            If reader.NodeType = XmlNodeType.Element And reader.Name = "person" Then
                ParseAuthor(reader)
            End If
        End While
End Using

Sub ParseAuthor(ByVal MyReader As XmlReader)
    Dim lat, lng As String
    MyReader.ReadToFollowing("latitude")
    lat = MyReader.ReadElementContentAsString()
    MyReader.ReadToFollowing("longitude")
    lng = MyReader.ReadElementContentAsString()
    mapCenter = New GeoCoordinate(CType(lat, Double), CType(lng, Double))
    Dim position = PositionOrigin.Center
    imgLayer.AddChild(imgPinMembers, mapCenter, position)
End Sub 
```

我在

```
MyReader.ReadToFollowing("latitude") 
```

它说

> *节点类型 None 不支持 ReadElementContentAsString 方法。*

有人可以指出错误吗？请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:40:54.130

我刚刚找到了正确的方法：

```
MyReader.ReadToDescendant("latitude")
lat = MyReader.ReadElementContentAsString()
MyReader.MoveToContent()
lng = MyReader.ReadElementContentAsString()
mapCenter = New GeoCoordinate(CType(lat, Double), CType(lng, Double))
Dim position = PositionOrigin.Center
imgLayer.AddChild(imgPinMembers(i), mapCenter, position)
MyReader.MoveToElement() 
```

这执行没有错误。

# scilab - 将矩阵和列表加载到 Scilab 环境中

> ID：14176240
> 
> 赞同：0
> 
> 时间：2013-01-05T20:44:43.513
> 
> 标签：scilab

我正在尝试将矩阵和列表加载到 Scilab 的环境中。矩阵和列表由函数（F1）创建。为此，我知道矩阵和列表被定义为函数开头/第一行的输出。然后，还有另一个函数 F2 将这些矩阵和列表用于计算。但是，似乎矩阵和列表没有加载到 Scilab 的环境中。F1 不输出值还是 F2 不接受值？我做对了吗？请帮帮我。谢谢你的支持。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T08:21:38.620

那是你想要做的吗？

```
function [a,b]= f1()
         a=rand(2,2);
         b=list(2,"foo");
endfunction

function f2(a,b)
         disp(a)
         disp(b)
endfunction

[a,b]=f1();
f2(a,b); 
```

# c - 指针作为 C 函数中的参数

> ID：14176243
> 
> 赞同：5
> 
> 时间：2013-01-05T20:45:17.187
> 
> 标签：c, pointers, linked-list

在很多例子中，我读过一个简单的 getListLength() 函数看起来像这样：

```
int getListLength(struct node *head)
{
    struct node *temp = head;
    int iCount = 0;

    while (temp)
    {
        ++iCount;
        temp = temp->next;
    }

    return iCount;
} 
```

令我印象深刻的是不需要声明复制传递参数的本地指针（在本例中为 *temp）。如果我没记错的话，传递的参数会获得它们自己的副本。因此，将不需要复制 *head 的本地指针，因为 *head 本身就是副本，对吗？换句话说，丢弃 *temp 指针并在任何地方使用 head 是否正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T20:46:21.037

是的，它是副本，所以是的，它是正确的。

```
int getListLength(struct node* head)
{
    int iCount = 0;

    while (head)
    {
        ++iCount;
        head = head->next;
    }
    return iCount;
} 
```

你为什么不执行它并自己看看呢？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-05T21:01:50.630

虽然确实不需要本地副本，因为指针是按值传递的，但它可能出于文体原因而存在。有些人认为修改传入的参数是不好的形式（尽管我确实发现它在某些情况下很有用），但也许更重要的是，您会丢失代码中的一些自文档；具体来说，`head`不再总是指向链表的真正头部。这在您的一小段代码中并没有那么令人困惑，但是当代码更长和更复杂时，具有不准确命名的变量可能会更加令人困惑。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-05T21:47:53.877

通常，制作传入指针的本地副本的原因是为了减少函数[的副作用](http://en.wikipedia.org/wiki/Side_effect_%28computer_science%29)（通过不修改函数参数）。

如果一个函数*仅使用指针来读取*（而不是写入），并且*与外界没有其他交互，则*该函数可以在 GCC 中注释为**“纯”**，并且可以进行一些很好的优化。

例子：

```
__attribute__((pure)) int getListLength(struct node *head) 
{
    struct node *temp = head;
    int iCount = 0;

    while (temp)
    {
        ++iCount;
        temp = temp->next;
    }

    return iCount;
} 
```

如果您不熟悉什么是副作用，请尝试阅读[副作用](http://en.wikipedia.org/wiki/Side_effect_%28computer_science%29)和[函数式编程](http://en.wikipedia.org/wiki/Functional_Programming)Wikipedia 文章以获取有关该主题的更多信息。

# iphone - 如何在 UITableView 中插入新单元格？

> ID：14176244
> 
> 赞同：3
> 
> 时间：2013-01-05T20:45:29.990
> 
> 标签：iphone, objective-c, ios, xcode, ipad

我正在尝试使用向 tableview 添加一行

```
NSIndexPath *indexPath = [NSIndexPath indexPathForRow:0 inSection:0];
[self.tableView insertRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic]; 
```

它抛出一个异常，我调用 insertRowsAtIndexPaths:withRowAnimation:，它说

```
Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[__NSArrayI objectAtIndex:]: index 1 beyond bounds [0 .. 0]' 
```

它返回正确数量的行和部分，但在抛出异常之前它从未到达 cellForRowAtIndexPath。我也在使用情节提要执行此操作，并且我将 tableView 设置为具有静态单元格，因为大多数 tableView 实际上确实具有静态单元格。我真的不想切换到动态原型，因为那样我就不能拥有我正在使用的 IBOutlets 和 IBActions，而且我必须从根本上重新开始考虑单元格的布局。有什么方法可以让我摆脱这个异常而不改变我的 tableView 来拥有动态原型单元格？

***编辑***

我发布之前的那一行是

```
[itemsInCurrentPurchase insertObject:itemName atIndex:0]; 
```

这应该更新数组。我在用

```
[itemsInCurrentPurchase count] 
```

对于我在节中的行数，它在更新后返回正确的数字。问题是甚至没有达到 cellForRowAtIndexPath 方法。在更新期间，在行数和可能导致此错误的单元格类型之间是否还有其他调用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-05T20:57:55.803

在插入行之前，您需要使用这个新对象更新您的数据源。否则它会在尝试用这个新行更新表视图时崩溃。

例如：-

```
[self.dataSourceArray insertObject:object atIndex:indexPath.row];
NSIndexPath *indexPath = [NSIndexPath indexPathForRow:0 inSection:0];
[self.tableView insertRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic]; 
```

# objective-c - 使用 AFNetworking 防止中间人攻击

> ID：14176246
> 
> 赞同：1
> 
> 时间：2013-01-05T20:45:33.593
> 
> 标签：objective-c, cocoa-touch, cocoa, ios4, afnetworking

我正在使用 AFNetworking 通过 SSL 发送数据。如何防止中间人攻击？如何确定我正在接收数据并将数据发送到我的服务器而不是其他服务器？

这是我的代码：

```
 @implementation API

@synthesize user;

#pragma mark - Singleton methods
/**
 * Singleton methods
 */
+(API*)sharedInstance
{
    static API *sharedInstance = nil;
    static dispatch_once_t oncePredicate;
    dispatch_once(&oncePredicate, ^{
        sharedInstance = [[self alloc] initWithBaseURL:[NSURL URLWithString:kAPIHost]];
    });

    return sharedInstance;
}

#pragma mark - init
//intialize the API class with the destination host name

-(API*)init
{
    //call super init
    self = [super init];

    if (self != nil) {
        //initialize the object
        user = nil;

        [self registerHTTPOperationClass:[AFJSONRequestOperation class]];

        [self setDefaultHeader:@"Accept" value:@"application/json"];
    }

    return self;
}

-(BOOL)isAuthorized
{
    return [[user objectForKey:@"id"] intValue]>0;
}

-(void)commandWithParams:(NSMutableDictionary*)params
                    path: (NSString *) pathstr
            onCompletion:(JSONResponseBlock)completionBlock
{
    NSMutableURLRequest *apiRequest =
    [self multipartFormRequestWithMethod:@"POST"
                                    path: pathstr
                              parameters: params
               constructingBodyWithBlock: ^(id <AFMultipartFormData>formData)
               {
                   //TODO: attach file if needed
               }];

    AFJSONRequestOperation* operation = [[AFJSONRequestOperation alloc] initWithRequest: apiRequest];
    [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
        //success!
        completionBlock(responseObject);
    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {
        //failure :(

        NSLog(@"%@", error);
        completionBlock([NSDictionary dictionaryWithObject:[error localizedDescription] forKey:@"error"]);
    }];

    [operation start];

}
@end 
```

然后我打电话：

```
[[API sharedInstance] commandWithParams: params
                                   path: @"user/registration"
                           onCompletion:^(NSDictionary *json)
 { 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-11-02T10:46:45.057

我知道已经晚了 9 个月，但是在研究我自己的解决方案时遇到了这个 SO 问题。如果其他人也遇到它，这就是我理解的注意事项/方法。

1.  使用您在上面提出的方法会使您容易受到 MITM 攻击。上述方法所做的是使用 SSL 进行连接并检查证书是否有效。但是，它不会检查证书是否适用于您的服务器。因此，上述方法将允许任何有效证书被接受为有效。因此，像 Charles ( [http://www.charlesproxy.com](http://www.charlesproxy.com) ) 这样的程序可以让您（或任何人）看到您的 https 网络流量，前提是它们能够充当您的应用程序和服务器之间的代理。

2.  为了防止这种情况发生，您需要打开 SSL Pinning（这里的好文章：http: [//blog.lumberlabs.com/2012/04/why-app-developers-should-care-about.html](http://blog.lumberlabs.com/2012/04/why-app-developers-should-care-about.html)）。这要求 SSL 连接来自具有特定证书（您嵌入在应用程序中）或特定公钥（您也嵌入在应用程序中）的服务器。

3.  幸运的是，使用 AFNetworking，这很容易做到。简单设置

    ```
    defaultSSLPinningMode = AFSSLPinningModeCertificate 
    ```

    或者

    ```
    defaultSSLPinningMode = AFSSLPinningModePublicKey 
    ```

    在您的 AFHTTPClient 上。然后将相关证书或公钥添加到您的应用程序包中。

4.  使用上述方法，仍然有可能有人下载应用程序并将他们自己的证书或公钥插入应用程序的捆绑包中并退出应用程序。我不知道执行此操作的确切步骤，但此处概述了该问题：[https](https://github.com/AFNetworking/AFNetworking/issues/1286) ://github.com/AFNetworking/AFNetworking/issues/1286 。

5.  在我看来，防止这种情况发生的最好方法是在使用 SSL Pinning 的基础上加密应用程序和服务器之间的通信。我目前正在为此寻找 RNCryptor ( [https://github.com/rnapier/RNCryptor](https://github.com/rnapier/RNCryptor) )

我想最终归结为考虑到您的应用程序正在做什么以及它正在共享的数据，适当的工作量是多少。

希望有帮助，查尔斯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:02:38.077

假设`kAPIHost`是一个`https://`URL，你应该一切都好。

实际上，您所能做的就是与服务器具有受信任的权威证书的已知良好服务器地址建立连接。（由 Thawte、VeriSign 等提供。）这有点像在说“我怎么能确定邮递员没有重定向我的邮件？” 您不能，但您可以做的是使用密码学（即密码证书、SSL 等）来防止邮递员读取您的邮件内容，并随后将响应验证为真正来自您期望的实体。这就是 SSL 存在的目的（在存在可信证书等的情况下）

如果您不信任提供主流证书的实体，那么您几乎只能预先共享一个秘密并使用基于共享秘密的加密。简而言之，SSL 对几乎所有其他人来说已经足够好了……希望它对你来说已经足够好了。

# javascript - KineticJS：组与层

> ID：14176255
> 
> 赞同：5
> 
> 时间：2013-01-05T20:46:50.193
> 
> 标签：javascript, kineticjs

尽管我是最好的 Google-fu，但在主教程或 KineticJS 文档中都没有明确说明组和层之间的区别。Kinetic 的“[入门](https://github.com/ericdrowell/KineticJS/wiki)”页面解决了这个问题——它提到层有特殊的渲染器，虽然我不太明白那是什么意思。那么组没有那些渲染器吗？组不能在层内吗？是什么让层（或组）与一组用于组织/转换的节点的父级不同？

本质上，**组和层之间有什么区别？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T21:26:43.057

Group 只是一个层中 KineticJS 定义的对象的集合，而每个层都是一个单独的 Canvas（或曾经是 KineticJS 的 3.x 版本），您可以通过在舞台上添加多个层来看到差异。此外，在框架层次结构中，组包含在层内，而不是相反。因此，您可以一次显示/渲染多个组，但不能显示多个图层（只有最上面的一个可见）。

# mysql - 使用连接从两个表中选择多个条目

> ID：14176259
> 
> 赞同：0
> 
> 时间：2013-01-05T20:47:05.980
> 
> 标签：mysql

我想产生一个结果，它将从下面给出的数据库中提供以下结果。

```
20  'someVideo'  'Jason Statham, Tom Cruise, Bruce Wills, Anne Hathaway'  'musicDirector'  'Director 
```

请注意，演员用“，”分隔。提前致谢

*term_relationships*
**ID video_id related_id 类型**
1 20 5 演员
1 20 2 演员
1 20 3 演员
1 20 4 演员
1 20 10 音乐
1 20 11 导演

*演员*
**ID TITLE**
2 汤姆克鲁斯
3 布鲁斯威尔斯
4 安妮海瑟薇
5 杰森斯坦森

*音乐*
**ID TITLE**
10 音乐总监

*董事*
**ID TITLE**
10 董事

*视频*
**ID TITLE**
20 SomeVideo

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:54:32.247

要将演员名称组合成一个逗号分隔的列表，您可以使用 mysql`GROUP_CONCAT`函数。检查这个 SQL 语句是否能得到你想要的：

```
Select tr.video_id, videos.title AS video, 
   GROUP_CONCAT(DISTINCT(actors.title) SEPARATOR ',') AS actor_names,  
   GROUP_CONCAT(DISTINCT(directors.title) SEPARATOR ',') AS director,   
   GROUP_CONCAT(DISTINCT(musics.title) SEPARATOR ',') AS music 
FROM term_relationships tr inner join videos on videos.id = tr.video_id 
LEFT JOIN actors on tr.related_id = actors.id 
LEFT JOIN musics on tr.related_id = musics.id and tr.type = 'music' 
LEFT JOIN directors on tr.related_id = directors.id and tr.type = 'director' 
WHERE tr.video_id = 20 GROUP BY tr.video_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T22:47:19.353

Andrea 对 GROUP_CONCAT 函数的回答非常出色并且有效。但是，还应该通过为这样的演员添加类型过滤器来完善它：

```
select tr.video_id, v.title, 
  GROUP_CONCAT(DISTINCT(a.title) SEPARATOR ',') actors,
  GROUP_CONCAT(DISTINCT(d.title) SEPARATOR ',') director,
  GROUP_CONCAT(DISTINCT(m.title) SEPARATOR ',') music
FROM term_relationships tr 
  INNER JOIN videos v on v.id = tr.video_id 
  LEFT JOIN actors a on tr.related_id = a.id and tr.type = 'actor'
  LEFT JOIN musics m on tr.related_id = m.id and tr.type = 'music' 
  LEFT JOIN directors d on tr.related_id = d.id and tr.type = 'director' 
WHERE tr.video_id = 20 
GROUP BY tr.video_id; 
```

# android - 将不同的主题应用于操作栏

> ID：14176261
> 
> 赞同：3
> 
> 时间：2013-01-05T20:47:36.350
> 
> 标签：android, android-actionbar, android-theme

我正在尝试将主题应用于我的操作栏，这将改变背景颜色。但是，当我这样做时，应用程序的整个背景都会发生变化......

```
<!-- Application theme. -->
<style name="AppTheme" parent="AppBaseTheme">
    <!-- All customizations that are NOT specific to a particular API-level can go here. -->
    <item name="android:actionBarSize">140dp</item>
    <item name="android:background">#00ff00</item>
</style> 
```

有谁知道我如何将单独的主题应用于操作栏？

谢谢。

```
<!-- Application theme. -->
<style name="AppTheme" parent="AppBaseTheme">
    <!-- All customizations that are NOT specific to a particular API-level can go here. -->
    <item name="android:actionBarStyle">@style/MyActionBar</item>
    <item name="android:actionBarSize">140dp</item>
    <item name="android:background">#ffffff</item>
</style>

<!-- ActionBar LAYOUT -->
<style name="MyActionBar" parent="android:Widget.ActionBar">
<item name="android:background">#000000</item>
</style> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:56:41.220

你必须这样做：

```
 <style name="AppTheme" parent="AppBaseTheme">
        <item name="android:actionBarStyle">@style/MyActionBar</item>
    </style>

    <style name="MyActionBar" parent="android:Widget.Holo.ActionBar" >
        <item name="android:background">@android:drawable/action_bar_background</item>
    </style> 
```

这是您可以更改背景的方法：

```
<style name="AppTheme" parent="AppBaseTheme">
       <item name="android:actionBarStyle">@style/MyActionBar</item>
       <item name="android:colorBackground">@android:color/black</item>
 </style> 
```

# android - 对在应用程序中使用 Fragments 感到困惑

> ID：14176263
> 
> 赞同：5
> 
> 时间：2013-01-05T20:47:43.860
> 
> 标签：android, android-fragments

我有一个成熟的应用程序，它不是使用`Fragments`. 我的困惑是我应该将其更改为 have`Fragments`而不是 `Activities`. 我想说的是，我在我的应用程序中只使用纵向方向，并且它是构建的，记住只有手机，而不是平板电脑。所以我的问题是，如果我改变 app 的整个结构并使用`Fragments`.

据我所知，只有在我们想重用某些东西时才应该使用片段。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-08T12:46:21.280

`Fragments`可用于创建**动态和多窗格的用户界面**，因此非常适合需要使用更多屏幕空间的平板电脑。当然，在手机上情况会有所不同，您可以玩的空间要小得多，有时只需要将一个`Activity`适配到屏幕上而不用担心包含多个`Fragments`.

`Fragments`非常适合动态界面，有助于平板电脑和手机之间的兼容性。它们也能够比活动更好地相互通信，因此即使在仅电话设置中使用它们也肯定有优势。（请参阅`FragmentsManager`它们可用于的一些功能）

下图说明了一个使用示例（取自 Android 开发者网站） ![跨平板电脑和手机的片段](../Images/69ed6e320da982139bb8c0f5c13fda76.png)

这说明了 的灵活性`Fragments`，它在平板电脑上可以占据同一屏幕，在手机上切换到更像 Activity 的格式。正是这种力量，使之`Fragment`比`Activity`.

很明显，在灵活性方面切换到定向解决方案有优势`Fragment`，但您最初的问题表明您仅针对手机，并且仅针对纵向。

拥有一个已经存在的应用程序，`Activities`只要它是您满意的解决方案，并且具有良好的可用性我会说没有理由切换到`Fragments`（除非您正在寻找挑战或有一些空闲时间和喜欢修补匠）。虽然存在优势，**但像添加片段这样的剧烈变化可能会在您的应用程序中引入错误并影响用户体验**（至少在短期内）。

从长远来看，如果您正在考虑将平板电脑支持纳入折叠屏或想要使用横向，那么开始考虑可以做些什么`Fragments`来**改善体验**可能是个好主意，并将其与当前的您的电话应用程序的流程。

否则，您创建的当前解决方案将绰绰有余，**只要它受到您的客户群的好评，我认为没有理由改变**。

当然，为将来**的项目熟悉 Fragment API**，或者在需要刷新当前项目的 UI 的情况下，也没有什么坏处。

值得指出的是，`Fragments`只有 Android 3.0（API 级别 11）本机支持，要支持早期设备，您需要安装中的**Android 支持包**。因此，如果您当前的应用程序以 2.x 设备为目标，为了简单起见和 .apk 大小，我会坚持使用基于 Activity 的方法，除非迁移到原生 API 级别（如 Android 3.0+）。**这是个人喜好，最终对您最初问题的回答将归结为您的个人喜好。**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-14T20:11:20.637

将片段视为将代码模块化为可管理片段的一种方式。每个片段代表一小部分功能和 UI。这使您可以轻松地调整代码以适应不同的场景。

当然，您现在不打算支持平板电脑（无论您认为平板电脑用户会如何安装该应用程序），请考虑更大尺寸的 5-6 英寸设备以及将您的应用程序扩展到它们的潜力。最好提供您的应用到尽可能多的设备，最好的应用会为设备量身定制体验。

过渡到 Fragments 并不困难。取一小部分功能并将其移至 Fragment。然后你会看到新模式是多么容易和灵活。您不需要重写整个应用程序，因为活动和片段可以一起工作。

我相信，从长远来看，跳过 Fragments 确实会让你的开发任务变得更加困难。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-06T07:36:02.640

如果您将来不打算支持平板电脑，请保持原样。当您将应用程序转换为片段时，您不会获得任何收益。

如果您启动一个新的应用程序，情况就不同了。如果将来需要支持其他形式因素，我会从一开始就使用片段，以便更加灵活。请注意，支持库中提供了该功能，因此您也可以在旧设备上使用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-14T13:59:16.080

设置片段之间的交互比设置活动之间的交互更容易。

活动情况下：

1.  您需要使用`startActivityForResult()`/ `onActivityResult()`;
2.  您的自定义类型必须实现`Parcelable`接口才能在活动之间传递；
3.  当您的活动暂停/停止时，您必须释放所有资源。

如果是碎片：

1.  传递数据就像从中获取片段实例`FragmentManager`并在其上调用方法一样简单；
2.  无需执行`Parcelable`；
3.  您可以在包含所有片段的活动中保存对“重”资源的引用，并且只初始化/释放它们一次（不需要为每个片段初始化/释放）。

此外，实例`Fragment`比实例更轻量级，`Activity`初始化/恢复所需的时间和资源更少。

一般来说，当你使用 Fragment 时，你的 UI 组件之间的交互更干净、更优雅、更容易实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-15T07:33:13.173

我刚刚将我的应用程序转换为使用片段，因为：

1.  想要平板版
2.  想要将[ViewPageIndicator](http://viewpagerindicator.com/)和[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)与高级视图一起使用

这些是使用片段的最令人信服的理由。

这可能需要做更多的工作，但随着市场上出现更多平板电脑和快速采用率，也许值得考虑支持具有更好用户界面的平板电脑？

如果您真的不想这样做并且不需要使用高级视图进行视图分页，那么过度设计您的项目以使其使用片段来使用片段是没有意义的。您可能会争辩说您可能会了解它们，但是当您在下一个项目中使用它们时，您可以学习（这就是我所做的并且效果很好）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-11T08:53:26.093

就您的应用程序或任何应用程序而言，最好使用片段，它不会对您的应用程序造成伤害，并且还可以减轻您的负担，同时进一步扩展您的平板电脑应用程序。因此，最好从使用应用程序中的片段。

# django - modelformset 字段中的限制值

> ID：14176265
> 
> 赞同：0
> 
> 时间：2013-01-05T20:47:53.123
> 
> 标签：django, django-forms, django-views

我已经尝试解决这个问题几天了，变得非常绝望。请参阅注释掉的代码片段，了解我尝试过但没有奏效的一些事情。

**问题：**如何将`category`字段中的值限制`IngredientForm`为仅属于当前登录用户的值？

![在此处输入图像描述](../Images/5524686273a095c4d7872e6709a75de7.png)

**视图.py**

```
@login_required
def apphome(request):
    IngrFormSet = modelformset_factory(Ingredient, extra=1, fields=('name', 'category'))

    # Attempt #1 (not working; error: 'IngredientFormFormSet' object has no attribute 'fields')
    # ingrformset = IngrFormSet(prefix='ingr', queryset=Ingredient.objects.none())
    # ingrformset.fields['category'].queryset = Category.objects.filter(user=request.user)

    # Attempt #2 (doesn't work)
    # ingrformset = IngrFormSet(prefix='ingr', queryset=Ingredient.objects.filter(category__user_id = request.user.id)) 
```

**模型.py：**

```
class Category(models.Model):
    name = models.CharField(max_length=30, unique=True)
    user = models.ForeignKey(User, null=True, blank=True)       

class Ingredient(models.Model):
    name = models.CharField(max_length=30, unique=True)
    user = models.ForeignKey(User, null=True, blank=True)
    category = models.ForeignKey(Category, null=True, blank=True)
    counter = models.IntegerField(default=0) 
```

**表格.py：**

```
class IngredientForm(ModelForm):
    class Meta:
        model = Ingredient 
        fields = ('name', 'category') 
```

**更新：**我已经取得了一些进展，但该解决方案目前是硬编码的并且不能真正使用：

我发现我可以`category`通过表单类控制表单字段，然后在视图中传递表单，如下所示：

```
#forms.py
class IngredientForm(ModelForm):
    category = forms.ModelChoiceField(queryset = Category.objects.filter(user_id = 1))

    class Meta:
        model = Ingredient 
        fields = ('name', 'category')

#views.py
IngrFormSet = modelformset_factory(Ingredient, form = IngredientForm, extra=1, fields=('name', 'category')) 
```

以上产生了我需要的结果，但显然`user`是硬编码的。我需要它是动态的（即当前用户）。我尝试了一些解决方案来访问 forms.py 中的 request.user，但这些都不起作用。

任何想法如何前进？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T01:18:07.350

您不需要任何类型的自定义表单。您可以将`category`字段的查询集更改为：

```
IngrFormSet = modelformset_factory(Ingredient, extra=1, fields=('name', 'category'))
IngrFormSet.form.base_fields['category'].queryset = Category.objects.filter(user__id=request.user.id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T12:48:24.347

```
Category.objects.filter(user=request.user) 
```

返回表单中初始值的列表对象，这没什么意义。

试试吧

```
Category.objects.get(user=request.user) 
```

或者

```
Category.objects.filter(user=request.user)[0] 
```

# javascript - javascript画布绘图应用程序选择颜色

> ID：14176266
> 
> 赞同：-2
> 
> 时间：2013-01-05T20:47:57.617
> 
> 标签：javascript, html, canvas

下面是允许用户绘制到画布的代码。这很好用，我有问题的部分是用javascript选择不同的颜色，所以用户有更多的颜色选择

这是绘图部分的代码

```
window.addEventListener("load", canvasAnimate, false);

    function canvasAnimate() {
    var canvas = document.getElementById('canvas');
    context = canvas.getContext('2d');
    window.addEventListener('mousemove', MouseIsMoving, false);
    window.addEventListener('mousedown', sketchit, false);
    window.addEventListener('mouseup', dontDraw, false);
};

//  GLOBAL VARIABLES

    var mouseX;
    var mouseY;
    var MouseIsDown = false // this will be used to determine if the mouse is down or not

//   e means the event, this stores the mouse events in the variable mouseX and mouseY
    function MouseIsMoving(e) {
        mouseX = e.pageX - canvas.offsetLeft; //the offset makes the coordinates fit for     the canvas box
        mouseY = e.pageY - canvas.offsetTop;
        document.getElementById('mouseCoordinates').innerHTML = 'X: ' + mouseX + ' Y: ' +     mouseY;
        if (MouseIsDown) {
            context.lineTo(mouseX, mouseY);
            context.stroke();
        }
    }

    function sketchit(e) {
        context.beginPath()
        context.moveTo(mouseX, mouseY);
        context.lineTo(mouseX,mouseY)
        context.lineCap = 'round'; //default lineCap and lineWidth
        context.lineWidth = 3;
        context.strokeStyle = '#000000' //default color
        context.stroke();
        MouseIsDown = true;
    };

    function dontDraw() {
        if (MouseIsDown) {
            MouseIsDown = false;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-29T15:10:56.763

两个 JavaScript 颜色选择器应用程序：

第一个涵盖了所有浏览器回到 IE6，如果您需要支持旧浏览器，我认为这是最好的解决方案：

[https://github.com/DavidDurman/FlexiColorPicker](https://github.com/DavidDurman/FlexiColorPicker)

第二个适用于支持 canvas 标签的现代浏览器。我写了它并称之为 MasterColorPicker。它在一个包装中提供了几种不同的颜色选择器。它已经提供了比标准 Photoshop 颜色选择器更多的功能，我正在处理所有文件和整个项目的更新版本，这将是它所能做的一切......

[http://softmoon-webware.com/MasterColorPicker_instructions.php](http://softmoon-webware.com/MasterColorPicker_instructions.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:00:39.010

您可以使用`<input type="color" />`创建颜色选择器，确切的外观将取决于浏览器的实现。

[jsFiddle](http://jsfiddle.net/jQaxj/)

不过，目前[只有 Google Chrome 和 Opera 支持这个](http://caniuse.com/#feat=input-color)。其他浏览器将恢复为用户可以手动输入十六进制颜色的文本字段。
如果你想要一个跨浏览器的解决方案，你可以使用[这个 jQuery 插件](http://www.eyecon.ro/colorpicker/)或其他在[这里](http://wiki.jqueryui.com/w/page/12137750/ColorPicker)找到的插件。

# javascript - 为什么我的数组长度等于 0？

> ID：14176267
> 
> 赞同：2
> 
> 时间：2013-01-05T20:48:01.690
> 
> 标签：javascript, html

为什么我输出的数组长度为0？这使我的循环不起作用，我对这段代码的理解也不清楚。

```
<!DOCTYPE html>

<html>
<head>

    <title>My Awsome Website</title>

</head>

<body>

    <h1>My list</h1>
        <ul>
            <li>one</li>
            <li>two</li>
            <li>three</li>
        </ul>

    <script>

        var list = document.getElementsByTagName('<li>');
        document.write(list.length);

        /*
        for (var i = 0; i < list.length; i++) {
            list[i].style.backgroundColor = 'red';
            list[i].style.color = 'white';
        }
        */

    </script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-05T20:49:16.700

没有带有标签 name 的元素`<li>`。

不过，有几个带有标签 name `li`。

该行应该是：

```
var list = document.getElementsByTagName('li'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-05T20:49:04.293

```
var list = document.getElementsByTagName('li'); 
```

使用上面。它`getElementsByTagName`只有一个参数，即所需元素的标签名称。

# css - 将 3 个 div 与外部 2 个在任一方向上拉伸 100% 对齐？

> ID：14176268
> 
> 赞同：2
> 
> 时间：2013-01-05T20:48:06.197
> 
> 标签：css, html, alignment

我想将 3 个 div 对齐在一起，但我希望左侧 div 向左拉伸 100%，右侧 100% 向右拉伸，中间 div 具有固定宽度。

基本上，我正在尝试为我的网站创建一个标题，其中徽标位于中间，背景似乎永远延伸，但徽标具有透明度，所以我不能只是将一个重叠在另一个之上。

我现在已经使用下面的表格完成了这项工作，但想知道是否有更好的（css）方式来做到这一点？

真正的问题是横幅中心的徽标背景需要透明，所以我不能有任何重叠的 div？

这是我使用以下方法完成的示例，但如果可能，更愿意使用 CSS？

链接：[示例](http://www.aniworld.plus.com/2013)

```
<table border="0" cellpadding="0" cellspacing="0">
    <tr>
    <th scope="col" style="width:50%; height:123px; background-image:url(style/images/header_bckdrp.png); background-repeat:repeat-x"></th>
    <th scope="col"><img src="style/images/header_logo.png" width="122" height="123" alt="Header_logo"></th>
    <th scope="col" style="width:50%; height:123px; background-image:url(style/images/header_bckdrp.png); background-repeat:repeat-x"></th>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:26:02.390

我不知道这种方法是否适用于您想要实现的目标，但您可以将图像水平居中，然后应用背景颜色，这样它将覆盖背景图像。您不应该使用空元素，它们在语义上是不正确的。不过，这取决于你。
看看这个[codepen](http://codepen.io/joe/pen/BwJIv)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:01:01.007

这应该适合你：

```
<style type="text/css>

#left, #right{
position:absolute;
top:0px;
width:50%;
height:50px;
}

#left, #headerpattern_left, #rightsticky{
left:0px;
}

#right, #headerpattern_right, #leftsticky,{
right:0px;
}

#headerpattern_left, #headerpattern_right{
position:absolute;
background:url(pattern.png) repeat-x;
width:45%;
}

#leftsticky, #rightsticky{
    position:absolute;
}

#logo{
position:relative;
width:50px;
height:50px;
margin:0px auto;
}

</style>

<body>

<div>
    <div id="left">
        <div id="headerpattern_left">
        </div>
        <div id="leftsticky>
            <img src="correctly_measured_image_of_pattern_on_left_side_of_logo.jpeg" />
        </div>
    </div>
    <div id="right">
        <div id="headerpattern_right">
        </div>
        <div id="rightsticky>
            <img src="correctly_measured_image_of_pattern_on_right_side_of_logo.jpeg" />
        </div>
    </div>
    <div id="logo">
    </div>
</div>

</body> 
```

编辑：新建议

在我的脑海中，您可以在左右 div 中的每个 div 中创建两个 div，并创建一个 jpeg，说明图案在徽标两侧的外观应为 100px，并将它们贴在徽标旁边，然后使用相同的在 jpeg 旁边的 div 上重复背景。

这在大多数情况下应该可以工作，但在少数情况下它看起来并不完美，例如在巨大的屏幕上查看网页或缩小相当远的网页。另外，我不确定它在移动设备上的外观。

# jquery - 如何在提交 html 表单时打开 jQuery Modal 窗口

> ID：14176270
> 
> 赞同：1
> 
> 时间：2013-01-05T20:48:21.393
> 
> 标签：jquery, html, forms, modal-dialog

我正在使用一个简单的 html 表单将产品从我的网站提交到我远程托管的 Mal 的电子商务购物车。提交表单时，我需要打开一个模式窗口（包含 iframe）。我无法访问购物车的服务器端编程，那么有没有办法使用 onclick html 事件属性启动 jQuery 模式窗口？

现在，表单底部的 onclick 属性会打开一个 js 浏览器警报...基本上我需要用我的 jQuery 模态对话框窗口替换这个 js 警报。

有人可以帮忙吗？

这是我的表格：

```
<form action="http://ww7.aitsafe.com/cf/add.cfm" method="post">
<input type="hidden" name="userid" value="96309001">
<input type="hidden" name="nocart"> 
<input type="hidden" name="producturl" value="http://www.fruitfulfarm.net/cart_2.html">
<input type="hidden" name="product" value="Test Product">
<input type="hidden" name="price" value="49.99">
<input type="hidden" name="return" 
value="www.fruitfulfarm.net/cart_2.html">
<input class="rounded" type="submit" name="submit" value="Add To Cart"
onclick="alert('Order has been added to your cart\n\nThis page will refresh');"
onkeypress="alert('Order has been added to your cart\n\nThis page will refresh');">
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T21:52:42.010

利用`onsubmit`

**HTML**

```
<form method="post" action="" onsubmit="return myModal(this)">
    <!-- more inputs -->
    <input type="submit" value="Submit" />
</form> 
```

**JS**

```
function myModal(f)
{
    var form=f,
        modal=$('<div/>', {
            'id':'alert',
            'html':'<iframe src="url"></iframe>'
        })
       .dialog({
           'title':'Iframe in a modal window',
           'modal':true,
           'width':350,
           'height':'auto',
           'buttons': {
               'OK': function() { 
                   $(this).dialog( "close" ); 
                   // do something, maybe call form.submit();
                }
            }
    });
    return false;
} 
```

[**例子**](http://jsfiddle.net/HeyrG/)

# ios - CBCentralManager 在后台运行，但最终死亡

> ID：14176273
> 
> 赞同：1
> 
> 时间：2013-01-05T20:48:51.470
> 
> 标签：ios, cocoa-touch, background, core-bluetooth, cbcentralmanager

我成功地`CBCentralManager`在后台运行外围设备扫描。我有`CBCentralManagerDelegate`in a singleton 方法和`App communicates using CoreBluetooth`.plist ，就像我说的那样，它在后台运行了好几个小时。

我遇到的问题是，当我的应用程序被完全杀死时，因为其他应用程序已被使用并需要内存空间。如果我运行其他应用程序来刷新我的应用程序，那么我的应用程序将不再被任何`CBCentralManager`委托调用唤醒。

我还需要做些什么来确保我的应用程序被唤醒吗？我是否可能需要`CBCentralManager`在 App Delegate 中进行通话？当应用程序后台运行时，我应该在 App Delegate 中做些什么吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T02:47:57.703

您需要的是由于核心蓝牙事件而启动您的应用程序的能力。不幸的是，这在 iOS 6.0 中是不可能的。我在 WWDC 2012 上与 Apple 蓝牙工程师进行了交谈，他们了解用例，并表示不支持。

也许他们会在 iOS 7.0 中添加一些东西。

# node.js - 连接到服务器后客户端代码没有响应

> ID：14176278
> 
> 赞同：0
> 
> 时间：2013-01-05T20:49:14.470
> 
> 标签：node.js, socket.io

每当我执行我的代码时，我都会在控制台收到消息说它已连接，然后什么都没有发生。

这是代码：

**服务器端**

```
var app = require('express')()
  , server = require('http').createServer(app)
  , io = require('socket.io').listen(server);

server.listen(80);

app.get('/', function (req, res) {
  res.sendfile('index.html');
});

io.sockets.on('connection', function (socket) {

  console.log('m connected');

  socket.emit('news', { hello: 'm joooon ' });
  socket.on('my other event', function (data) {
    console.log(data);
  });
}); 
```

**客户端**

```
<!DOCTYPE html>
<html>

<head>
<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io.connect('http://localhost');
  socket.on('news', function (data) {
    console.log(data);
    socket.emit('my other event', { my: 'data' });
  });
</script>
</head>
<body>

  <div id="lo">magudi</div>
</body></html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T23:14:43.217

On the client side, your not listening to the port.

```
var socket = io.connect('http://localhost:80'); 
```

# python - 测试两个数组之间的统计显着差异

> ID：14176280
> 
> 赞同：0
> 
> 时间：2013-01-05T20:49:25.673
> 
> 标签：python, arrays, numpy, statistics, scipy

我有两个具有相同形状（105,234）的二维数组，名为 A 和 B，基本上由其他数组的平均值组成。我熟悉 Python 的 scipy 包，但我似乎无法找到一种方法来测试两个数组在每个单独的数组索引处是否在统计上显着不同。我认为这只是一个大型的 2D 配对 T 检验，但我遇到了困难。有什么想法或其他要使用的软件包吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T02:23:14.863

如果我们假设网格点上每个均值的潜在方差相同，并且观测值的数量相同或已知，那么我们可以使用均值数组直接估计均值的标准差。

将网格点之间的差除以标准差，得到t个分布的随机变量，可以直接检验，即可以计算出p值。

作为多点测试，我们将遇到多重测试问题[http://en.wikipedia.org/wiki/Multiple_comparisons#Large-scale_multiple_testing](http://en.wikipedia.org/wiki/Multiple_comparisons#Large-scale_multiple_testing)并且应该更正 p 值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T14:36:34.403

如果您的问题是“二维分布是否不同？”，请参阅 [数字食谱 p。763](http://apps.nrbook.com/empanel/index.html?pg=763)
（并进一步询问如何在 numpy / scipy 中做到这一点）。您可能还会询问[stats.stackexchange](https://stats.stackexchange.com/search?q=compare+distributions)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T21:06:22.370

我假设 x,y 坐标无关紧要，我们只有两组独立的测量值。

一种可能的方法可能是计算每个数组的平均值的标准偏差，将此值乘以学生系数（对于您的天文样本数和 95 % 置信水平，可能有点 1.645）并获得围绕平均值的置信范围方法。如果两个不同数组的置信范围重叠，则它们之间的差异不显着。公式可以在[这里](http://ultrastudio.org/en/Confidence_interval)找到。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-11-06T23:46:36.013

转到 MS Excel。如果你没有你的工作，还有其他选择

在 Excel 工作表中输入数字数组。在输入字段中运行公式 =TTEST (array1,array2,tail)。一尾是一，二尾是二……很简单。这是一个简单的学生 T，我相信您可能仍然需要一个 t 表来解释统计数据（互联网）。然而，它可以快速比较样本。

# objective-c - iOS 检测用户的移动

> ID：14176281
> 
> 赞同：9
> 
> 时间：2013-01-05T20:49:33.077
> 
> 标签：objective-c, ios, core-motion, uiaccelerometer

我想创建一个简单的应用程序，当我将手机在 Y 轴上从起点移动到终点时，它会在屏幕上绘制一条简单的线，例如从点 a(0,0) 到点 b(0, 10)请帮忙

演示：

![在此处输入图像描述](../Images/888c589879b619d8e4c34b9aeb48f00e.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-24T04:38:55.680

您需要初始化运动管理器，然后检查`motion.userAcceleration.y`适当的加速度值（以米/秒/秒为单位）。

在下面的示例中，我检查了 0.05，我发现这是手机相当不错的向前移动。我也等到用户显着放慢速度（-Y 值）再进行绘制。调整设备 MotionUpdateInterval 将决定您的应用对速度变化的响应能力。现在它以 1/60 秒采样。

```
motionManager = [[CMMotionManager alloc] init];
motionManager.deviceMotionUpdateInterval = 1.0/60.0;
[motionManager startDeviceMotionUpdatesToQueue:[NSOperationQueue currentQueue] withHandler:^(CMDeviceMotion *motion, NSError *error) {
    NSLog(@"Y value is: %f", motion.userAcceleration.y);
    if (motion.userAcceleration.y > 0.05) { 
        //a solid move forward starts 
        lineLength++; //increment a line length value
    } 
    if (motion.userAcceleration.y < -0.02 && lineLength > 10) {
        /*user has abruptly slowed indicating end of the move forward.
         * we also make sure we have more than 10 events 
         */
        [self drawLine]; /* writing drawLine method
                          * and quartz2d path code is left to the 
                          * op or others  */
        [motionManager stopDeviceMotionUpdates];
    }
}]; 
```

请注意，此代码假定手机平放或略微倾斜，并且用户在纵向模式下向前推（远离自己，或与手机一起移动）。

# lua - lua：表索引为零

> ID：14176284
> 
> 赞同：-1
> 
> 时间：2013-01-05T20:50:14.323
> 
> 标签：lua, indexing, lua-table

我不知道 lua，虽然我对其他几种语言很熟悉，所以我对表格等并不完全无知

我在网上找到了这段代码并试图使用它，但它一直在吐出一个`table index is nil`错误。

我一直在网上查看其他一些带有相同错误消息的问题和问题，但仍然无法解决。

我向作者寻求帮助，但他也无法弄清楚。显然错误不会发生在他身上。

这是代码：

```
local RolePoints = {
    [ROLE_DETECTIVE] = {[ROLE_DETECTIVE] = -250,--Killed Detective as Detective
                        [ROLE_INNOCENT] = -50,--Killed Innocent as Detective
                        [ROLE_TRAITOR] = 20
                    },
    [ROLE_INNOCENT] = {[ROLE_DETECTIVE] = -250,
                        [ROLE_INNOCENT] = -20,
                        [ROLE_TRAITOR] = 20
                    },
    [ROLE_TRAITOR] = {[ROLE_DETECTIVE] = 30,
                        [ROLE_INNOCENT] = 10,
                        [ROLE_TRAITOR] = -500
                    }
    } 
```

特别是，解释器声称这条线是罪魁祸首：

```
[ROLE_DETECTIVE] = {[ROLE_DETECTIVE] = -250,--Killed Detective as Detective 
```

有任何想法吗？

谢谢

**编辑：**我发现如果我把它放在我自己的客户端上它可以工作（尽管它仍然会出现错误）但不能在我的服务器上工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:05:57.070

`ROLE_DETECTIVE`（以及其他全大写名称）几乎可以肯定是您从中提取的代码中其他地方定义的常量。

要么引用它们并将它们用作字符串，要么用值（可能是数字 ID）自己定义它们。

* * *

谷歌搜索，具体代码似乎是[Trouble in Terrorist Town](http://www.moddb.com/mods/trouble-in-terrorist-town)，一个Garry's Mod模式。

# c++ - 更改Linux中的线程优先级和调度程序

> ID：14176292
> 
> 赞同：6
> 
> 时间：2013-01-05T20:50:47.587
> 
> 标签：c++, c, linux, pthreads

我有一个单线程应用程序。如果我使用下面的代码，我会得到`sched_setscheduler(): Operation not permitted` .

```
struct sched_param param;
param.sched_priority = 1;
if (sched_setscheduler(getpid(), SCHED_RR, &param))
printf(stderr, "sched_setscheduler(): %s\n", strerror(errno)); 
```

但是，如果我使用如下的 pthread api，我不会收到错误消息。对于单线程应用程序，两者之间有什么区别，下面的函数真的改变了调度程序和优先级，还是我错过了一些错误处理？

```
void assignRRPriority(int tPriority)
{
    int  policy;
    struct sched_param param;

    pthread_getschedparam(pthread_self(), &policy, &param);
    param.sched_priority = tPriority;
    if(pthread_setschedparam(pthread_self(), SCHED_RR, &param))
            printf("error while setting thread priority to %d", tPriority);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T21:04:12.893

该错误可能是由对实时优先级设置的限制引起的（`ulimit -r`检查，`ulimit -r 99`允许 1-99 个优先级）。`pthread_setschedparam`成功：如果你编译时没有选项`-pthread`，这个函数只是一个存根，就像其他一些 pthread 函数一样。使用`-pthread`选项，结果应该相同（`strace`表明使用了相同的系统调用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:04:36.047

您缺少一些基本的错误处理。你需要一些 < 在那里。试试这个：

```
if(pthread_setschedparam(pthread_self(), SCHED_RR, &param) < 0) {
  perror("pthread_setschedparam");
} 
```

# php - 字符串中的 PHP 变量

> ID：14176296
> 
> 赞同：-1
> 
> 时间：2013-01-05T20:51:49.840
> 
> 标签：php, json

> **可能重复：**
> [php中单引号和双引号字符串的区别](https://stackoverflow.com/questions/3446216/difference-between-single-quote-and-double-quote-string-in-php)

我有以下内容：

```
<?php
$message = '<div id="msg-status" class="msg-status">Item #{$item} - {$desc} has been added successfully.</div>';
        $data    = array(
            'success' => $products_table,
            'message' => $message
        );
        header('Content-type: application/json');
        echo json_encode($data);
?> 
```

有人可以帮我制作 {$item} 和 {$desc} 实际变量。我读到您应该在它们周围加上括号以使它们成为变量，但它们仍然作为字符串的一部分出现。关于我哪里出错的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:54:48.867

```
<?php
$message = '<div id="msg-status" class="msg-status">Item #'.$item.' - '.$desc.' has been added.';
?> 
```

使用上面。您不必将变量添加到引号内的字符串中，而是必须使用“ **.** ”将其与字符串连接起来。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T20:54:53.340

字符串中的变量只有在字符串用双引号而不是单引号时才会被扩展。

```
<?php
$message = "<div id=\"msg-status\" class=\"msg-status\">Item #{$item} - {$desc} has been added successfully.</div>";
    $data    = array(
        'success' => $products_table,
        'message' => $message
    );
    header('Content-type: application/json');
    echo json_encode($data);
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T20:57:18.987

如果您使用单引号来包装您的字符串，您将简单地终止字符串并将变量和字符串的其余部分连接起来。像这样 -

```
$epoch = time();
$a = 'Epoch time is' . $epoch . ', woohoo!'; 
```

如果您使用*双*引号来包装字符串，则可以将变量直接放入字符串中。像这样 -

```
$epoch = time();
$a = "Epoch time is $epoch, woohoo!"; 
```

通常，为了更好的可读性，我会使用双引号和大括号来表示字符串中的变量 -

```
$epoch = time();
$a = "Epoch time is {$epoch}, woohoo!"; 
```

把它们放在一起，你的字符串必须看起来像这样 -

```
$message = "<div id='msg-status' ... >Item #{$item} - {$desc} ...</div>"; 
```

请注意，如果我们将外部引号更改为双引号，则字符串中的引号也必须更改为单引号。你可以把双引号放在那里，但是你需要担心转义它们`\"`，你的代码读起来真的很烦人:)

# jquery - 在我的无限滚动方法中添加砖石

> ID：14176297
> 
> 赞同：1
> 
> 时间：2013-01-05T20:51:50.513
> 
> 标签：jquery, jquery-masonry, infinite-scroll

我有我定制的无限滚动脚本，它使用了 ajax 调用：

```
 $(function(){

    var fetching = false;
    var $container = $('#content_home');

    $container.imagesLoaded(function(){
        $container.masonry({
            itemSelector : '.wrdLatest',
            columnWidth:15
        });
    });

    $(window).scroll(function(){
        var bufferzone = $(window).scrollTop() * 0.20;
        if (!fetching && ($(window).scrollTop() + bufferzone > ($(document).height()- $(window).height()-1) && $(".wrdLatest:last").attr("id") != 1)){

        $('.loading').fadeIn(250);
        lastPostFunc();

        }       
    }); 

    function lastPostFunc() 
    { 
        fetching = true;
        $.post("/ajax/loadmore.php?lastid="+$(".wrdLatest:last").attr("id"),

        function(data){
            if (data != "") {
                $container.masonry( 'appended', data, true );
                //setTimeout(function(){$(".wrdLatest:last").after(data);},1000);
                setTimeout(function(){fetching = false;},2000);
                $('.loading').delay(1000).fadeOut(250);
            }
        });
    };  

}); 
```

我也实现了砌体脚本。现在我想通过使用 masonry 调用将滚动后加载的新内容附加到网页：

```
 function(data){
        if (data != "") {
            $container.masonry( 'appended', data, true );
            //setTimeout(function(){$(".wrdLatest:last").after(data);},1000);
            setTimeout(function(){fetching = false;},2000);
            $('.loading').delay(1000).fadeOut(250);
        }
    }); 
```

但部分：

```
 $container.masonry( 'appended', data, true ); 
```

似乎不起作用。在我实施砌体之前，我使用了自己的方法：

```
 //setTimeout(function(){$(".wrdLatest:last").after(data);},1000); 
```

这工作得很好。

我在砌体电话中做错了什么？

演示：[http ://acc.itemmized.com](http://acc.itemmized.com)

似乎数据已加载“超过”旧内容......而且它不是砖石布局......

# virtual-machine - 如何在 Squeak 中加载 VMMaker？

> ID：14176298
> 
> 赞同：4
> 
> 时间：2013-01-05T20:51:50.840
> 
> 标签：virtual-machine, smalltalk, squeak

我正在使用 Squeak 4.4 更新 12327 和 VM 版本 4.1.1。我尝试使用 ConfigurationOf 脚本加载 VMMaker，但总是失败，主要是在 Freetype 包中出现异常。

```
Gofer new
       squeaksource: 'MetacelloRepository';
       package: 'ConfigurationOfVMMaker';
       load.
((Smalltalk at: #ConfigurationOfVMMaker) project version: '1.4') load 
```

或者

```
Gofer new
squeaksource: 'MetacelloRepository';
package: 'ConfigurationOfVMMaker';
load.

(Smalltalk at:#ConfigurationOfVMMaker) project lastVersion load. 
```

或者

```
Gofer new
     squeaksource: 'MetacelloRepository';
     package: 'ConfigurationOfVMMaker';
     load.

(ConfigurationOfVMMaker project version: '1.5') load. 
```

包[存储库页面](http://source.squeak.org/VMMaker.html)和[wiki 页面](http://wiki.squeak.org/squeak/2105)（[这个](http://wiki.squeak.org/squeak/407)或[这个](http://wiki.squeak.org/squeak/2444)）都没有包含说明或加载 VMMaker 的链接，尽管包含很多解释。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T22:44:47.107

这要感谢 David Lewis，在我们用来测试 Interpreter VM 的 CI 脚本中：

```
MCMcmUpdater updateFromRepositories: #('http://source.squeak.org/VMMaker').
(Smalltalk at: #VMMaker) initializeBrowserSupport. "activate Slang browsing" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T22:29:38.350

不幸的是，到目前为止，Metacello 配置仅由以 Pharo 为中心的用户创建和使用……
您最终可以更正配置中的 Squeak 分支，但从那里启动并不容易。

如果您对 oscog VM 分支感兴趣，那么在这个 svn 存储库中分发了一个带有预加载包的预构建 4.3 映像

[http://squeakvm.org/svn/squeak/branches/Cog](http://squeakvm.org/svn/squeak/branches/Cog)

在 image 子目录下查看，打开 CogTrunk43.image，有一个工作区解释如何在图像中加载包。

如果您对经典解释器感兴趣，那么加载它的方法是使用更新 MCM：

1.  打开蒙蒂塞洛浏览器
2.  添加 VMMaker 存储库
    `(MCHttpRepository location: 'http://source.squeak.org/trunk' user: 'squeak' password: 'squeak')`
3.  选择并打开 VMMaker 存储库
4.  在左侧窗格中，选择“更新”（底部项目）
5.  在右侧窗格中选择顶部项目 (update-dtl.12.mcm)
6.  选择“浏览”按钮
7.  您会看到显示的软件包列表，单击“安装”按钮

更新配置虽然晚了几个版本，不知道是否还在维护，最好也去“吱吱虚拟机开发讨论”上问问

**编辑**我认为这个神奇的咒语可以取代上面所有面向 GUI 的操作：

```
MCMcmUpdater updateFromRepositories: {'http://source.squeak.org/VMMaker'}. 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-05T23:28:30.133

或者您可以打开一个`SqueakMap`包浏览器并加载`VMMaker`“头”版本。这与如上所述从蒙蒂塞洛加载更新的作用相同。无论哪种方式，您都将获得最新版本`VMMaker`和相关软件包。

# jquery - 如何在动态 ul 中使用 next() 获取图像 src

> ID：14176302
> 
> 赞同：-1
> 
> 时间：2013-01-05T20:52:18.397
> 
> 标签：jquery

我想使用 next() 获取图像 src 属性。我有这张图片的 ul 是动态的，所以我将我的 ul id 传递给我的函数。以下是我的代码，它返回我未定义的值。

```
var nxtimg=$("#"+slideid+" li#2 img").next().attr("src"); 
```

如果我删除.attr("src")，上面的行效果很好。＃2也是我想要下一个元素的li id，但这变得硬编码，所以我想让它像动态一样，

```
var nxtimg=$("#"+slideid+" li"+liid).next().attr("src"); 
```

但是当我添加 liid 时它就不起作用了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T20:55:39.703

看起来你只需要这个：

```
$('#2').next().find('img').attr("src"); 
```

请注意，数字 id 仅在 HTML5 文档中有效。不在 HTML4 中-

# javascript - 使用一个循环为每个 div 添加不同的 onclick

> ID：14176309
> 
> 赞同：1
> 
> 时间：2013-01-05T20:53:41.720
> 
> 标签：javascript, loops

> **可能重复：**
> [JavaScript 不支持带有局部变量的闭包吗？](https://stackoverflow.com/questions/643542/doesnt-javascript-support-closures-with-local-variables)

我想用 1 个循环向我的 div 元素动态添加不同的 onclick。这是我的代码的简化版本。

```
var colors=['blue','green','yellow'];
var newtxt=['box1','box2','box3'];

var i;
function set_element2()
{
var x=document.getElementById('mydiv').getElementsByTagName('div');
  for(i=0;i<x.length;i++)
  {

    var d=x[i];
var col=colors[i];
    var txt=newtxt[i];
d.style.background=col;
d.onclick=function(){d.innerHTML=txt};

  }
} 
```

我希望每个 div 在单击时显示 newtxt[i]。让我难过的是我的 div 的颜色会像它们应该的那样单独变化，但是 onclick 只会影响最后一个 div。如果我单击 div 0 或 div 1 它只会更改 div2 的内部 html，而不是单独更改每个 html。

```
function wrongway()
{
x[0].onclick=function(){x[0].innerHTML=newtxt[0];};
x[1].onclick=function(){x[1].innerHTML=newtxt[1];};
x[2].onclick=function(){x[2].innerHTML=newtxt[2];};
} 
```

这样做是可行的，但是我需要在一个循环中这样做，所以我不必为每组 div 创建几十个函数，这不是 DRY。

这是我的html，样式为#mydiv div-height:50px; 宽度：200px；边框：1px纯黑色；

```
 <body>
 <section id='mydiv'>

    <div>
</div>

<div>
</div>

<div>
</div>

 </section>
 <input type='button' onclick='set_element2()'> 
 </body> 
```

感谢您的任何回答，如果我的措辞有点混乱，对不起。tl；博士我想将单独的 onclicks 添加到一组带有 1 个循环的 div

**为更清晰而编辑***

**通过指定**di=i****解决方案**，并使用**此**解决方案。**

 **```
function multOnclicks()
{
var x=document.getElementById('mydiv').getElementsByTagName('div');
for(i=0;i<x.length;i++)
{

  var d=x[i];
  var col=colors[i];
  var txt=newtxt[i];

  d.style.background=col;

  d.i = i;
  d.onclick=function(){this.innerHTML=newtxt[this.i]};

  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:10:28.253

尝试这个

```
d.onclick=function(){this.innerHTML=this.style.backgroundColor}; 
```

[http://jsfiddle.net/UAvmx/](http://jsfiddle.net/UAvmx/)**

# android - Android：SQLite where 子句不会返回任何内容

> ID：14176313
> 
> 赞同：1
> 
> 时间：2013-01-05T20:54:12.940
> 
> 标签：android, sqlite

过去几天我一直在使用 SQLite，但时不时会遇到无法解决的错误。有时我的查询有效，有时无效，尽管当我转储表时，它应该可以工作。从 Logcat 检查这个转储（在设备上调试，还没有找到访问数据库的好方法......）：

这是来自名为 ct_data 的表

```
01-05 20:13:16.619: I/DataDAO(12453): >===>ID  100
01-05 20:13:16.619: I/DataDAO(12453): >===>cablefinderID   4 
01-05 20:13:16.619: I/DataDAO(12453): >===>latitude  51.5077559
01-05 20:13:16.619: I/DataDAO(12453): >===>longitude  7.5959846
01-05 20:13:16.629: I/DataDAO(12453): >===>data  DV200SN041385SV4.01TM19:24DT12/04/09CM33ST0BT9MD0SS28UMMDP---
01-05 20:13:16.629: I/DataDAO(12453): >===>time  1357416761579
01-05 20:13:16.629: I/DataDAO(12453): >===>ID  101
01-05 20:13:16.629: I/DataDAO(12453): >===>cablefinderID   4 
01-05 20:13:16.629: I/DataDAO(12453): >===>latitude  51.5077559
01-05 20:13:16.629: I/DataDAO(12453): >===>longitude  7.5959846
01-05 20:13:16.629: I/DataDAO(12453): >===>data  DV200SN041385SV4.01TM19:24DT12/04/09CM33ST0BT9MD0SS27UMMDP---DV200SN041385SV4.01TM19:24DT12/04/09CM33ST0BT9MD0SS28UMMDP---
01-05 20:13:16.629: I/DataDAO(12453): >===>time  1357416771625 
```

这是我也打印出来的 sql 语句（不带引号）：

“选择 * 从 ct_data WHERE cablefinderID='4'”

我尝试了带引号和不带引号 ('') 的 where 子句 ='4'，但是 cablefinderID 在 SQL 中是 Integer 类型，在 Java 中是 long 类型。这是我的 Java 代码：

```
 String query = "SELECT * from  ct_data WHERE cablefinderID='" + registration.getId()+"'"; 
    cursor = database.rawQuery( query, null );
    // check if cursor is empty
    if(!cursor.moveToFirst()) {
        Log.i(TAG, "WTF!!!");
    } 
```

我也已经尝试使用 rawQuery 的第二个参数，即 String[] selectionArgs。

```
String query = "SELECT * from  ct_cablefinder_data WHERE cablefinderID=?";
String[] args = {"4"};
cursor = database.rawQuery( query, null ); 
```

但是，有时我会达到“WTF”。这发生在两天前，后来我最终比较了 Java 中的值，但这只是一个修补程序，当稍后数据库中有数十万行时，这不是一件好事。我认为根据我的调试，索引可能已经损坏，删除了所有应用程序数据，然后它就可以工作了。现在我再次删除了所有 App 数据，同样的事情发生了。我开始怀疑自己在这里，这让我发疯......

请告诉我，我发现了一个愚蠢的错误！

问候，西蒙。

- - - - - - - - - - - - - - - - -编辑 - - - - - - - - ------------------

首先，非常感谢您的帮助！但这太疯狂了。它只是行不通。同样，之前删除了所有 App Data 以获得新鲜和干净的数据库。检查这个：

```
01-06 05:54:38.969: I/DataDAO(19394): ====================ct_cablefinder_data====================
01-06 05:54:39.039: I/DataDAO(19394): >===>ID  1
01-06 05:54:39.039: I/DataDAO(19394): >===>cablefinderID   1 
01-06 05:54:39.039: I/DataDAO(19394): >===>latitude  51.5077559
01-06 05:54:39.039: I/DataDAO(19394): >===>longitude  7.5959846
01-06 05:54:39.039: I/DataDAO(19394): >===>data  DV200SN041385SV4.01TM05:06DT13/04/09CM33ST0BT9MD0SS00UMMDP---
01-06 05:54:39.039: I/DataDAO(19394): >===>time  1357451653224
01-06 05:54:39.039: I/DataDAO(19394): >===>ID  2
01-06 05:54:39.039: I/DataDAO(19394): >===>cablefinderID   1 
01-06 05:54:39.039: I/DataDAO(19394): >===>latitude  51.5077559
01-06 05:54:39.049: I/DataDAO(19394): >===>longitude  7.5959846
01-06 05:54:39.049: I/DataDAO(19394): >===>data  DV200SN041385SV4.01TM05:06DT13/04/09CM33ST0BT9MD0SS00UMMDP---
DV200SN041385SV4.01TM05:06DT13/04/09CM33ST0BT9MD0SS00UMMDP---
DV200SN041385SV4.01TM05:06DT13/04/09CM33ST0BT9MD0SS00UMMDP---
DV200SN041385SV4.01TM05:06DT13/04/09CM33ST0BT9MD0SS00UMMDP---
01-06 05:54:39.049: I/DataDAO(19394): >===>time  1357451663259
01-06 05:54:39.049: I/DataDAO(19394): ==============================================

01-06 05:54:51.889: I/DataDAO(19394): ====================ct_cableregistration====================
01-06 05:54:51.939: I/DataDAO(19394): >===>ID  1
01-06 05:54:51.939: I/DataDAO(19394): >===>projectID  1
01-06 05:54:51.939: I/DataDAO(19394): >===>startTime  2013-01-06 05:54:12
01-06 05:54:51.939: I/DataDAO(19394): >===>endTime  null
01-06 05:54:51.939: I/DataDAO(19394): >===>deviceType  DC200-041385
01-06 05:54:51.939: I/DataDAO(19394): >===>deviceKey  00:01:95:08:2F:3B
01-06 05:54:51.939: I/DataDAO(19394): >===>registrationServerID  0
01-06 05:54:51.949: I/DataDAO(19394): ==============================================

And the SQL statement:
01-05 20:14:20.859: E/DataDAO(12453): SELECT * from  ct_cablefinder_data WHERE cablefinderID=1 
```

这是我调整后的代码，遵循 Meghal Shah 的建议：

```
public List<DataVO> getDataByRegistration( CableRegistrationVO registration ) {
    synchronized ( lock ) {

        openReadable();
        Cursor cursor = null;
        List<DataVO> result = new ArrayList<DataVO>();

        try {       
            String query = "SELECT * from  ct_cablefinder_data WHERE cablefinderID="
                + registration.getId();

            cursor = database.rawQuery( query, null );
            dumpTableI( "ct_cablefinder_data" );        // see tabledump above
            dumpTableI( "ct_cableregistration" );       // again, dump above
            Log.e( TAG, query );

            while ( cursor.moveToNext() ) { 
                result.add( this.bindSQLite( cursor ) );
            }

        } catch ( Throwable t ) {
            Log.e( TAG, t.toString() );
        } finally {
            if ( cursor != null ) {
                cursor.close();
            }
        }
        close();
        return result;
    }
} 
```

我的意思是，我正在逐步调试，每次程序达到 while 条件时，它都会直接跳到 finally 块并关闭光标，不检索任何数据。结果 ArrayList 保持为空。但它在那里：cablefinderID = 1，我可以看到它，你可以看到它，不是吗？

我现在将尝试将所有内容都转换为字符串并尝试比较 WHERE 子句中的内容，如果这不起作用，我不知道，但严重的酒精滥用似乎相当可观。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T09:43:17.713

行。因此，在某个地方，数据类型存在问题。我特别将 cablefinderID 声明为整数。然而，Sqlite 可能认为这还不够。所以我所做的是在比较之前再次显式转换为 Integer：

```
String query = "SELECT * from  ct_cablefinder_data WHERE CAST(cablefinderID as integer)=" + registration.getId(); 
```

那只是成功了。

但是，感谢您帮助我，现在我可以继续编码并且不会因酗酒而堕落！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:42:17.627

在第一个查询中，如果 cablefinderID 是整数，则不需要 '' 或 "" 。您应该尝试以下代码段，它应该可以工作

```
 String query = "SELECT * from  ct_data WHERE cablefinderID=" + registration.getId();
        cursor = database.rawQuery( query, null );
        while(cursor.moveToNext()){
          //your code here
        }
        cursor.close(); 
```

第二个查询使用 ct_cablefinder_data 而不是 ct_data，以防这可能是问题所在。这也将有助于您如何创建表格。

# c++ - C++：将向量转移到子程序中

> ID：14176317
> 
> 赞同：1
> 
> 时间：2013-01-05T20:55:08.330
> 
> 标签：c++

在我的示例中，我想打印三个相似的向量。你能帮我理解如何将向量转移到子程序中，以免重复自己吗？

```
#include "stdafx.h";
#include <vector>;
#include <iostream>
#include <algorithm>
#include <iterator>

using namespace std;

struct SPoint
{   
    int X;
    int Y;
};

vector<SPoint> points;
vector<SPoint> selected;
vector<SPoint> cleared;

void print_points()
{
    cout << "Points: "<< endl;
    for (int i = 0; i < points.size(); i++)
    {
        cout << '('<<points[i].X <<',' <<points[i].Y <<')'<< endl;
    }
    cout << endl;
}

void print_selected()
{
    cout << "Selected: "<< endl;
    for (int i = 0; i < selected.size(); i++)
    {
        cout << '('<<selected[i].X <<',' <<selected[i].Y <<')'<< endl;      
    }
    cout << endl;
}

void print_cleared()
{
    cout << "Cleared: "<< endl;
    for (int i = 0; i < cleared.size(); i++)
    {
        cout << '('<<cleared[i].X <<',' <<cleared[i].Y <<')'<< endl;        
    }
    cout << endl;
}

int main ()
{
    SPoint temp = {0, 0};

    for (int i = 0; i < 11;i++)
    {
        temp.X = i;
        temp.Y = i;
        points.push_back(temp);

    }

    for (int i = 5; i< 11;i++)
    {
        temp.X = i;
        temp.Y = i;
        points.push_back(temp);
    }

    print_points();
    print_selected();
    print_cleared();

    system ("pause");

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:59:18.313

你可以这样做：

```
void
print(const std::vector<SPoint>& vect, const std::string& message)
{
    std::cout << message << ":" << std::endl;
    for (int i = 0, size = vect.size(); i < size; ++i)
        std::cout << vect[i].X << ":" << vector[i].Y << " ";
    std::endl;
}

print(points, "Points");
print(points, "Selected");
print(points, "Cleared"); 
```

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:57:10.753

要将向量作为参数传递给函数，您可以执行以下操作：

```
void func(const vector<SPoint>& points) {
  ... do stuff
} 
```

然后你在你的代码中调用这个函数，如下所示：

```
 ...some stuff
  vector<SPoint> a;
  func(a); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T20:57:50.457

只需使用`const`对向量的引用并将其传递给函数：

```
void print(const vector<SPoint> &data) const {

}

...

print(points); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T21:00:31.720

这是一个完整的*C++*风格的方法：

```
struct SPoint
{   
    int X;
    int Y;
};

std::ostream& operator <<( std::ostream& stream, SPoint const& point )
{
    stream << '(' << point.X << ',' <<point.Y << ')';
    return stream;
}

void print_vector( std::ostream& stream, std::vector< SPoint > const& vector )
{
    std::copy(
        points.begin(), points.end()
      , std::ostream_iterator< SPoint >( std::cout, '\n' )
    );
} 
```

接着：

```
print_vector( std::cout, points );
print_vector( std::cout, selected );
print_vector( std::cout, cleared ); 
```

# c++ - 为什么（成员）函数指针在 Visual C++ 中表现得如此怪异？

> ID：14176320
> 
> 赞同：29
> 
> 时间：2013-01-05T20:55:39.633
> 
> 标签：c++, visual-c++, linker

我遇到了一个非常奇怪的问题，我将其简化为以下测试用例：

```
#include <iostream>
#include <map>
#include <string>

struct Test
{
    std::map<std::string, void (Test::*)()> m;
    Test()
    {
        this->m["test1"] = &Test::test1;
        this->m["test2"] = &Test::test2;
    }
    void test1() { }
    void test2() { }
    void dispatch(std::string s)
    {
        if (this->m.at(s) == &Test::test1)
        { std::cout << "test1 will be called..." << std::endl; }
        else if (this->m.at(s) == &Test::test2)
        { std::cout << "test2 will be called..." << std::endl; }
        (this->*this->m.at(s))();
    }
};

int main()
{
    Test t;
    t.dispatch("test1");
    t.dispatch("test2");
} 
```

它输出

> test1 将被调用...
> test1 将被调用...

当启用优化时，这真的很奇怪。这是怎么回事？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-06T17:22:32.293

这是 Visual C++ 称为**相同 COMDAT 折叠**(ICF) 的副产品。它将相同的功能合并到一个实例中。您可以通过将以下开关添加到链接器命令行来禁用它：（`/OPT:NOICF` 在 Visual Studio UI 中，它位于*Properties->Linker->Optimization->Enable COMDAT Folding*下）

您可以在此处的 MSDN 文章中找到详细信息：[/OPT（优化）](http://msdn.microsoft.com/en-us/library/bxwfs976%28v=vs.110%29.aspx)

该开关是链接器阶段开关，这意味着您将无法仅针对特定模块或特定代码区域（例如`__pragma( optimize() )`可用于编译器阶段优化的区域）启用它。

然而，一般来说，依赖函数指针或文字字符串指针 ( `const char*`) 来测试唯一性被认为是不好的做法。几乎所有 C/C++ 编译器都广泛实现了字符串折叠。函数折叠目前仅在 Visual C++ 上可用，尽管模板<> 元编程的广泛使用增加了将此功能添加到 gcc 和 clang 工具链的请求。

编辑：从 binutils 2.19 开始，包含的黄金链接器据说也支持 ICF，尽管我无法在我的本地 Ubuntu 12.10 安装上验证它。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-01-05T20:55:39.633

事实证明，Visual C++ 的链接器可以将具有相同定义的函数合并为一个。
根据 C++ 是否合法，我不知道；它会影响可观察的行为，所以对我来说它看起来像一个错误。不过，其他有更多信息的人可能想插话。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-05T21:19:22.607

C++11 5.3.1 描述了什么`&`；在这种情况下，它为您提供了一个指向相关成员函数的指针，并且该段落没有要求该指针必须是唯一的。

但是，5.10/1 说`==`：

> 相同类型的两个指针比较相等当且仅当它们都为空，都指向同一个函数，或都表示相同的地址。

那么问题就变成了......是`test1`和`test2`“相同的功能”吗？

尽管优化器已将它们合并为一个定义，但可以说这两个名称标识了两个函数，因此，**这似乎是一个实现错误**。

（但请注意，VS 团队并不关心并认为它“足够有效”以保证优化的好处。那，或者[他们没有意识到它是无效的](http://social.msdn.microsoft.com/Forums/en/vclanguage/thread/dd91dae2-6f9d-4a46-b1dd-753c2b927119)。）

我会坚持使用字符串作为函数指针的“句柄”。

# java - Java：如何使滚动条以恒定速度滚动？

> ID：14176321
> 
> 赞同：1
> 
> 时间：2013-01-05T20:08:01.337
> 
> 标签：java, swing, animation, timer, jscrollbar

我想做一个java GUI程序。它包含一个 jScrollpane，其中包含一个大 jPanel。jPanel 它本身包含许多 Swing 组件，例如 jButtons、jPanels 和...。我想要的是当用户单击 jButton 时，jScrollpane 开始以恒定速度滚动到大面板的末尾。类似安卓操作系统的东西。我知道我必须知道如何用java制作动画来解决这个问题，我试图用线程简单地解决这个问题，但这是不可能的，而且似乎swing需要更具体地使用线程......你能给我你的吗想法？它与 Swingworker 有关吗？真的很关键...:(

更新：我试图用计时器类解决这个问题：

```
 ActionListener action = new ActionListener()
    {
        @Override
        public void actionPerformed(ActionEvent e)
        {
            if (mainContainerScrollPane.getHorizontalScrollBar().getValue() == mainContainerScrollPane.getHorizontalScrollBar().getMaximum())
                timer.stop();
            mainContainerScrollPane.getHorizontalScrollBar().setValue(mainContainerScrollPane.getHorizontalScrollBar().getValue() + 5);
            mainContainerScrollPane.repaint();
        }
    };

    timer = new Timer(10, action);
    timer.start(); 
```

现在的问题是动画没有顺利完成。我的意思是它可以平滑滚动，但是当它到达特定位置时，它的速度会下降。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T21:01:02.413

一般来说，任何更改 GUI 组件的事件都应该在事件调度线程 (EDT) 上运行。如本教程中所述，您可以使用挥杆`Timer`在 EDT 上触发重复事件。[http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)。在计时器事件上，您可以将滚动条的值增加到新位置应该是什么。以相同的增量重复此操作以获得您正在寻找的效果。

# android - Android ellipsize 无法正常工作

> ID：14176329
> 
> 赞同：3
> 
> 时间：2013-01-05T20:56:37.120
> 
> 标签：android, android-layout, textview

我正在构建一个新的信息窗口（谷歌地图 api v2），我试图让我的布局完美。该布局的一部分是这样的：

```
 <LinearLayout
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:orientation="vertical">
<TextView
  android:id="@+id/txtInfoWindowName"
  android:layout_width="wrap_content"
  android:layout_height="wrap_content"
  android:layout_gravity="center_horizontal"
  android:ellipsize="end"
  android:singleLine="true"
  android:textColor="#ff000000"
  android:textSize="14dp"
  android:textStyle="bold"/>
<TextView
  android:id="@+id/txtInfoWindowObstacles"
  android:layout_width="wrap_content"
  android:layout_height="wrap_content"
  android:ellipsize="end"
  android:maxLength="32"
  android:lines="1"
  android:singleLine="true"
  android:textColor="#ff7f7f7f"
  android:textSize="14dp"/> 
```

现在，问题在于`android:ellipsize="end".` 它应该在最后绘制三个点，但它没有这样做。现在我得到这样的东西：

```
TextTextTextTextTe 
```

而不是这个：

```
TextTextTextTextTe... 
```

我认为这与我使用 layout_width="wrap_content" 的事实有关。但我需要它，因为我使用的是 LinearLayout

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-05T21:05:15.987

我试过你的代码，它们工作正常，除了第二个 TextView 具有属性`android:maxLength="32"`，在这种情况下，由于 32 个字符的限制，文本不能被省略。但是，如果您删除它，它会按预期工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-31T08:59:49.903

还有另一种选择 - 您可以使用如下代码格式化字符串：

```
private static final int STR_MAX_CHAR_COUNT = 32;

private String formatString(String stringToFormat) {
    if(stringToFormat.length() > STR_MAX_CHAR_COUNT){
        stringToFormat = stringToFormat.substring(0, STR_MAX_CHAR_COUNT - 1) + "...";
    }
    return stringToFormat;
} 
```

然后像这样设置字符串：

```
String newText = "some long-long text";
mTextView.setText(formatString(newText)) 
```

# ruby-on-rails - Heroku 在安装 Gemfile 依赖项时卡住了

> ID：14176331
> 
> 赞同：2
> 
> 时间：2013-01-05T20:56:46.180
> 
> 标签：ruby-on-rails, heroku

当我尝试部署到 heroku 时，gem 从未完成安装。我在本地机器上进行了捆绑更新，看看是否有问题。那没有帮助。

我怀疑它可能是 libv8，但不应该部署它，因为我的 config/application.rb 文件中有以下内容：

```
Bundler.require(*Rails.groups(:assets => %w(development test))) 
```

这是我将 Rails 应用程序部署到 Heroku 时的日志：

```
$ git push heroku master
Counting objects: 176, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (156/156), done.
Writing objects: 100% (176/176), 37.46 KiB, done.
Total 176 (delta 41), reused 0 (delta 0)
-----> Ruby/Rails app detected
-----> Installing dependencies using Bundler version 1.3.0.pre.2
       Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment
       Fetching gem metadata from https://rubygems.org/.........
       Fetching gem metadata from https://rubygems.org/..
       Installing rake (10.0.3)
       Installing i18n (0.6.1)           
       Installing multi_json (1.5.0)
       Installing activesupport (3.2.9)           
       Installing builder (3.0.4)
       Installing activemodel (3.2.9)           
       Installing erubis (2.7.0)
       Installing journey (1.0.4)           
       Installing rack (1.4.1)
       Installing rack-cache (1.2)           
       Installing rack-test (0.6.2)
       Installing hike (1.2.1)           
       Installing tilt (1.3.3)
       Installing sprockets (2.2.2)
       Installing actionpack (3.2.9)
       Installing mime-types (1.19)
       Installing polyglot (0.3.3)
       Installing treetop (1.4.12)
       Installing mail (2.4.4)
       Installing actionmailer (3.2.9)
       Installing arel (3.0.2)
       Installing tzinfo (0.3.35)
       Installing activerecord (3.2.9)
       Installing activeresource (3.2.9)
       Installing bcrypt-ruby (3.0.1)
       Installing sass (3.2.5)
       Installing bootstrap-sass (2.2.2.0)
       Installing coffee-script-source (1.4.0)
       Installing execjs (1.4.0)
       Installing coffee-script (2.2.0)
       Installing rack-ssl (1.3.2)
       Installing json (1.7.6)
       Installing rdoc (3.12)
       Installing thor (0.16.0)
       Installing railties (3.2.9)
       Installing coffee-rails (3.2.2)
       Installing jquery-rails (2.1.4) 
```

这是我的 Gemfile：

```
source 'https://rubygems.org'

gem 'rails', '3.2.9'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'

gem 'json'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'bootstrap-sass', '~> 2.2.2.0'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  gem 'libv8'
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

# To use ActiveModel has_secure_password
gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'ruby-debug' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T00:07:14.397

它正在安装 libv8。当我第一次开始时，我需要它来解决一些错误。现在看来我不需要它。

# android - Android - 从其他类中的 Imageview 更改 BackgroundResource

> ID：14176333
> 
> 赞同：0
> 
> 时间：2013-01-05T20:56:54.900
> 
> 标签：android, xml, layout, imageview

我想（从 Activity 继承）通过第二个类访问 ImageView 并更改它。不幸的是，当我尝试这样做时，我得到了 NullPointerExeption。第二个类没有 XML，也没有 onCreate() 方法。它继承自 Activity 只是因为我需要一些功能。

那么如何访问布局或其他组件呢？

这是我第二堂课的代码。

```
public void changeLoerg() {
    int stufe;
    //layout = (RelativeLayout)findViewById(R.id.LayoutMain);
    imageViewLoerg = (ImageView)findViewById(R.id.imageViewLoerg);

    stufe = SettingsLoerg.getLevel(context);

    Object tag = imageViewLoerg.getTag();

    if (stufe == 1) {
        int loergId = R.drawable.animatedegg;

        if( tag != null && ((Integer)tag).intValue() == loergId) {
            loergId = R.drawable.animatedloerg;
            animatedLoerg.stop();
            //playAnimationNodelay();
            imageViewLoerg.setTag(loergId);
            imageViewLoerg.setBackgroundResource(loergId);
            playAnimationNodelay();
        }
    }
} 
```

在 hier das LogCat 下：

```
01-05 21:34:39.685: W/dalvikvm(9905): threadid=1: thread exiting with uncaught exception (group=0x41b5b300)
01-05 21:34:39.693: E/AndroidRuntime(9905): FATAL EXCEPTION: main
01-05 21:34:39.693: E/AndroidRuntime(9905): java.lang.NullPointerException
01-05 21:34:39.693: E/AndroidRuntime(9905):     at android.app.Activity.findViewById(Activity.java:1825)
01-05 21:34:39.693: E/AndroidRuntime(9905):     at at.android.dertestloerk.TimerLoerg.changeLoerg(TimerLoerg.java:42)
01-05 21:34:39.693: E/AndroidRuntime(9905):     at at.android.dertestloerk.TimerLoerg$1.run(TimerLoerg.java:100)
01-05 21:34:39.693: E/AndroidRuntime(9905):     at android.os.Handler.handleCallback(Handler.java:615)
01-05 21:34:39.693: E/AndroidRuntime(9905):     at android.os.Handler.dispatchMessage(Handler.java:92)
01-05 21:34:39.693: E/AndroidRuntime(9905):     at android.os.Looper.loop(Looper.java:137)
01-05 21:34:39.693: E/AndroidRuntime(9905):     at android.app.ActivityThread.main(ActivityThread.java:4745)
01-05 21:34:39.693: E/AndroidRuntime(9905):     at java.lang.reflect.Method.invokeNative(Native Method)
01-05 21:34:39.693: E/AndroidRuntime(9905):     at java.lang.reflect.Method.invoke(Method.java:511)
01-05 21:34:39.693: E/AndroidRuntime(9905):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
01-05 21:34:39.693: E/AndroidRuntime(9905):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
01-05 21:34:39.693: E/AndroidRuntime(9905):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T00:06:23.620

如果您有一个`View`要修改的类，您应该在该类中创建一个方法来修改所说`View`的 . 然后你可以调用你的方法`Activity`并传入你需要的任何参数作为参数。

```
public class BackGround { // please don't extend Activity unless it is one

    private ImageView img;

    ....

    public void changeLoerg(int resourceId) {
        img.setBackgroundResource(resourceId);      
    }
} 
```

# android - 在android中的html中显示相机视图，然后拍照

> ID：14176334
> 
> 赞同：13
> 
> 时间：2013-01-05T20:56:59.830
> 
> 标签：android, ios, cordova, phonegap-plugins, cordova-plugins

在我们使用 JavaScript 拍摄照片之前，是否有在 html 中显示实时相机视图的视图（例如嵌入在 div 中）？我已经尝试过 PhoneGap，但它完全启动了一个新的相机应用程序，并且在返回之前完全离开了我的 html 网络应用程序。我需要在我的应用程序中嵌入一些东西

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2015-04-21T05:00:20.067

您可以在您的 Cordova/phonegap 应用程序中安装**[mbppower/CordovaCameraPreview](https://github.com/mbppower/CordovaCameraPreview)插件（适用于 android、ios） ，以允许从 HTML 代码进行相机交互。**它是一个非常棒的插件。您可以访问以下功能：

**从 HTML 代码开始相机预览。拖动预览框。设置相机颜色效果（Android和iOS），将预览框发送到HTML内容的后面，为相机预览框设置自定义位置，为预览框设置自定义大小并保持HTML交互性。**

或者，如果它符合您的要求，您也可以将**[donaldp24/CanvasCamera](https://github.com/donaldp24/CanvasCameraPlugin)插件用于您的应用程序。它在 android 和 iOS 平台上均受支持。**我观察到，对于 iOS，它工作正常，但在 android 中它不工作。

现在您也可以通过 Online PhoneGap 安装 CordovaCameraPreview 插件。因此，无需使用 CLI，您可以通过添加直接使用它

`<gap:plugin name="com.mbppower.camerapreview" version="0.0.8" source="plugins.cordova.io" />`

在您的 config.xml 文件中创建 ApplicationTemplate.apk/.ipa。有关这方面的更多信息，你可以问我。乐意效劳。

更新：2017 年 10 月 10 日它在此期间运行良好，但 donaldp24/CanvasCamera 不再维护，目前无法使用最新的 Cordova 版本构建。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-05T21:24:03.270

我是为我的一个项目做的。查看 navigator.getUserMedia()。您可以使用网络摄像头和浏览器做很多事情，包括 AR 游戏！这里只是一个基本的例子：

**HTML：**

```
 <html>
    <head>
    </head>

    <body>
       <form><input type='button' id='snapshot' value="snapshot"/></form> 
       <video autoplay></video>
       <canvas id='canvas' width='100' height='100'></canvas> 
       <script type="text/javascript" src="findit.js"></script>
    </body>

    </html> 
```

**findit.js**

```
 var onFailSoHard = function(e)
    {
            console.log('failed',e);
    }

    window.URL = window.URL || window.webkitURL ;
    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia;

    var video = document.querySelector('video');

    if(navigator.getUserMedia)
    {
        navigator.getUserMedia({video: true},function(stream) {
        video.src = window.URL.createObjectURL(stream);
        },onFailSoHard);
    }

    document.getElementById('snapshot').onclick = function() { 
        var canvas = document.getElementById('canvas'); 
        var ctx = canvas.getContext('2d'); 
        ctx.drawImage(video,0,0); 
    } 
```

现场演示：

[个人项目](http://www.sanjeevmk.in/findit)

更多资源，这是我使用的：

[网络摄像头访问](http://joshondesign.com/p/books/canvasdeepdive/chapter13.html)

**更新：**

如果我们的设备有前置摄像头，此解决方案仅适用于前置摄像头。它基本上是一个“网络摄像头”解决方案。不确定它是否适用于您的情况。以防万一，请查看资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-06T09:25:27.840

您可以使用`camera.getPicture`from`cordova-plugin-camera`或`navigator.device.capture.captureVideo`from `cordova-plugin-media-capture`。

```
var getUserMedia = navigator.getUserMedia 
        || navigator.webkitGetUserMedia 
        || navigator.mozGetUserMedia 
        || navigator.msGetUserMedia 
        || navigator.device.capture.captureVideo 
        || navigator.camera 
        || camera.getPicture; 
```

希望能帮助到你。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-05T21:07:38.677

无法使用 javascript 直接访问相机应用程序。您可以编写一个自定义的 PhoneGap (Cordova) 插件来做到这一点。

# mysql - MySQL 在我的收件箱中每个用户只有一条消息（最新消息）

> ID：14176337
> 
> 赞同：0
> 
> 时间：2013-01-05T20:57:08.367
> 
> 标签：mysql, messages

请帮助我，我只想在收件箱中为每个用户显示一条消息（最新消息）。因此，如果我与**user1**、**user2**、**user3**交换消息，而不是像这样在收件箱中显示他们的所有消息：

```
user2 - message 6
user3 - message 5
user2 - message 4
user1 - message 3
user1 - message 2
user1 - message 1 
```

我只需要像这样在我的收件箱中显示他们每个人的最新消息。

```
user2 - message 6
user3 - message 5
user1 - message 3 
```

这是我的桌子。

```
+-----------------------------------------------------------------------------------+
|                                      messages                                     |
+-----------------------------------------------------------------------------------+
| message_ID | sender |receiver| date | subject | body | unread | delete1 | delete2 |
+-----------------------------------------------------------------------------------+

+---------------------+
|        members      |
+---------------------+
| id | username | ... 
+----+----------+-----+ 
```

到目前为止，这是我的查询。

```
SELECT p.*, p.sender as sender, m.*
FROM  messages p
LEFT JOIN members m ON p.sender=m.member_id
WHERE p.receiver='<CURRENT_USER>' AND delete2=0
GROUP BY p.sender ORDER BY p.date DESC
LIMIT 5 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T02:33:13.520

```
 SELECT p.*, p.sender as sender, m.*
      FROM `messages` p
INNER JOIN (SELECT sender, 
                   MAX(message_ID) as last_message_id
              FROM `messages` 
             WHERE receiver='<CURRENT_USER>' AND delete2=0
          GROUP BY `sender`) t2 ON t2.sender = p.sender 
                               AND t2.last_message_id = p.message_ID
 LEFT JOIN members m ON p.sender = m.member_id
     WHERE receiver='<CURRENT_USER>' AND delete2=0
  ORDER BY p.date DESC
     LIMIT 5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:09:54.430

你可以通过不同的功能得到它，比如

```
 select  MAX(message_id) 
```

编辑。

试试这个

```
 SELECT p.*, p.sender as sender, m.*
 FROM  messages p
 inner join (select max(message_ID) lates from messages)as max on
 max.lates = p.message_ID
 LEFT JOIN members m ON p.sender=m.member_id
 WHERE p.receiver='<CURRENT_USER>' AND delete2=0
 GROUP BY p.sender ORDER BY p.date DESC
 LIMIT 5 
```

# string - 如何使用 Notepad++ 从 html 文件中替换/删除特定字符串？

> ID：14176344
> 
> 赞同：0
> 
> 时间：2013-01-05T20:58:06.233
> 
> 标签：string, firefox, replace, notepad++, bookmarks

我已经将我的书签从 FF 导出到一个 html 文件，但它太大而且太复杂，所以我需要从中删除一些 Firefox 行以使其更轻、更简单。

我可以替换 Notepad++ 中的基本内容，但我想我确实需要一些操作符，但我不知道如何让它正常工作。

例如，这是文件中包含指向 Logodesignlove 链接的行：

```
<A HREF="http://www.logodesignlove.com/" ADD_DATE="1256428672" LAST_MODIFIED="1256428672" ICON_URI="http://www.logodesignlove.com/favicon.ico" ICON="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABDUlEQVQ4jWNgGF7gy9a9iS88Yw4803F49a6oYfHn589FGRgYGD4vWZv70iX80HMrv9MfF6zMw6r5Q/ukjkcMUv+R8TNzn+sv/eNPoou/753ZhKL5x8OHSo/Y5P+gK8SFH3Io//j+7Jk8wum79scQqxmGv2zcFQM34Ouhk96kGvBp5cZUuAGfnz8Xfcil8otoA5hl//+8cU8PJRxeJxZtJtaAlz5xJxkYGBhRDPh1/77BQ26V7wQDkFPp+9crN02xRuWnxavL8RrAIvv/8+otWXgT0/vu6ZMfMclgtZmgZrhLlm9MfSKi/Rmm+bm517VvF69ZEKUZBr68fCn+oWNK68cpC+qePXvGRZJmUgAAVs4XULOHB/oAAAAASUVORK5CYII=">Logo Design Love</A> 
```

我需要删除所有我不关心的标签，例如 LAST_MODIFIED="1256428672"、ICON_URI="bunch of digits" ICON="bunch of characters" 等。当然我需要删除每个链接中的所有这些标签在列表中。

所以我想使用类似“查找所有标签 LAST_MODIFIED="anynumbers" 并将其替换为任何内容/删除它”之类的东西 - 但它不起作用。

示例它应该如何：
`<A HREF="http://www.logodesignlove.com/">Logo Design Love</A>`

到目前为止，感谢 Aleksandr，我删除了 LAST_MODIFIED 和 ADD_DATE 行。所以 LAST_MODIFIED="\d+" 工作得很好。但是 ICON 和 ICON_URI 仍然存在。我试过 ICON="\w+" - 但它不起作用。我想这与斜线有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:08:15.690

当更容易掌握你想要的东西并丢弃垃圾时，为什么还要寻找你不想要的东西？

```
(<A HREF=".*?").*?(>.*?>) 
```

和

```
$1$2 
```

编辑代码以适应 Notepad++ 现在我知道它不需要特殊字符转义。谢谢亚历山大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:01:53.907

阅读使用正则表达式（java regex 教程是一个很好的开始[http://docs.oracle.com/javase/tutorial/essential/regex/](http://docs.oracle.com/javase/tutorial/essential/regex/)），并尝试使用在线正则表达式工具之一来帮助编写和测试它，比如这个[http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)

例如，使用正则表达式删除“LAST_MODIF...”`LAST_MODIFIED="\d+"`

否则，您可能需要一个特定于 XML 的工具，或者甚至编写一个 XSL。但是，我对此知之甚少。

# c# - 发布请求正文太大（参数对象中的字符串太大）

> ID：14176351
> 
> 赞同：4
> 
> 时间：2013-01-05T20:58:49.937
> 
> 标签：c#, string, model-view-controller, post

我有一个 MVC 方法：

```
public void PushFile([FromBody]FileTransport fileData) 
```

类是：

```
public class FileTransport
    {
        public string fileData;
    } 
```

在 fileData 我把`byte[]`从一个文件转换成一个`string`（UTF-8），所以字符串可以很大。

问题是：如果字符串**太大**（超过 15000 个字符），则`fileData`参数为`null`. 如果字符串不是那么大，则一切正常，参数也应如此。

如何允许 MVC 接受更大的字符串，或者我需要事先以某种方式压缩字符串？编辑：已经尝试过：

```
<system.web.extensions>
<scripting>
  <webServices>
    <jsonSerialization maxJsonLength="2147483644"/>
  </webServices>
</scripting>
</system.web.extensions> 
```

但不起作用。也许是因为 MVC 使用 JSON.NET 而不是普通的 JsonSerializer？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T22:02:04.753

您是否尝试增加请求的最大长度？

```
<system.web>
  <httpRuntime maxRequestLength="{REQUEST_LENGTH}"/>
<system.web> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T23:10:22.363

Simple Point is - you dont put the string into the URL. Simple like that. Add it as payload. URL's are ressource locators, not "Content carriers".

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T14:13:15.563

我发现它与内容长度无关。如果看起来 Json 没有正确编码发送方的某些字符，那就是 MVC 控制器收到 null 的时候。

# objective-c - 自定义类 NSObject 不符合键值编码

> ID：14176353
> 
> 赞同：2
> 
> 时间：2013-01-05T20:59:10.320
> 
> 标签：objective-c, nsobject, key-value-coding, kvc

> **可能重复：**
> [为什么我的对象不符合键值编码？](https://stackoverflow.com/questions/11491957/why-is-my-object-not-key-value-coding-compliant)

我有一本字典，我想将键/值添加到自定义类，但我总是收到错误，即该类不符合 KVC，但 Apple 文档说明它应该是。

我的代码：

联系对象.h：

```
@interface ContactObject : NSObject
     + (ContactObject *)testAdding;
@end 
```

ContactObject.m:

```
@implementation ContactObject

- (id)init {
    self = [super init];
    if (self) {
        // customize

    }

    return self;

}

+ (ContactObject *)testAdding
{
    // create object
    ContactObject *theReturnObject = [[ContactObject alloc] init];

    [theReturnObject setValue:@"Berlin" forKey:@"city"];
    [theReturnObject setValue:@"Germany" forKey:@"state"];

    return theReturnObject;

}

@end 
```

我想我错过了一些非常愚蠢的东西:)

请，任何帮助表示赞赏...

问候，马蒂亚斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T21:05:55.883

实际上要符合 KVC：

> 如何使属性符合 KVC 取决于该属性是属性、一对一关系还是一对多关系。对于属性和一对一的关系，一个类必须按照给定的优先顺序至少实现以下之一（键是指属性键）：

1.  **该类有一个名为 的声明属性`key`。**
2.  **它实现了名为 key 的访问器方法，如果属性是可变的，则`setKey:`. （如果属性是`Boolean`属性，则 getter 访问器方法的格式为`isKey`。）**
3.  **`key`它声明了一个形式为or的实例变量`_key`。**

我没有看到这三个中的任何一个实现了。您至少需要有您尝试通过 KVC 设置的属性，默认 NSObject 实现能够通过设置属性，`setValue:forKey:`但您必须声明它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T21:05:47.767

您需要声明将使用的每个属性：

```
@interface ContactObject : NSObject

@property (nonatomic,copy, readwrite) NSString* city;
@property (nonatomic, copy, readwrite) NSString* state;

+ (ContactObject *)testAdding;

@end 
```

或者使用[NSMutableDictionary](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableDictionary_Class/Reference/Reference.html)对象。

**例如：**

```
NSMutableDictionary* dict= [NSMutableDictionary new];
[dict setObject: @"Berlin" forKey: @"city"];
[dict setObject: @"Germany" forKey: @"state"]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T21:05:05.753

您需要实际声明/实现属性。键值编码并不意味着每个 NSObject 都自动成为键/值字典。

在这种情况下，您需要声明：

```
@property (nonatomic, readwrite, copy) NSString* city;
@property (nonatomic, readwrite, copy) NSString* state; 
```

在你的`@interface`声明中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-05T21:06:20.810

ObjC 在某些方面是动态的，但就类中的存储而言，它并不是真正的动态。如果您希望`ContactObject`某些键符合 KVC，则这些键*需要存在于类中*。[KVC 指南](http://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/KeyValueCoding/Articles/Compliant.html#//apple_ref/doc/uid/20002172-BAJEAIEE)有这样的说法：

> 对于属性或一对一关系的属性，这要求您的类：
> 
> *   实现一个名为`-<key>`,的方法`-is<Key>`，或者有一个实例变量`<key>`or `_<key>`。尽管键名经常以小写字母开头，但 KVC 也支持以大写字母开头的键名，例如 URL。
>     
>     
> *   如果属性是可变的，那么它也应该实现`-set<Key>:`. 您对该`-set<Key>:`方法的实现不应执行验证。

实现这一点的最简单方法是将所需的键声明为属性：

```
@property (copy, nonatomic) NSString * city;
@property (copy, nonatomic) NSString * state; 
```

你也可以声明一个 ivar 并自己实现访问器，但通常没有充分的理由这样做——声明的属性会很好地照顾你。

# css - 如何在不使用 javascript 或 jquery 的情况下使子菜单链接成为 css 下拉菜单中的头链接？

> ID：14176368
> 
> 赞同：1
> 
> 时间：2013-01-05T21:01:42.250
> 
> 标签：css, drop-down-menu

我对此很陌生，不知道如何使用 javascript 或 jquery，并且希望避免在所有可能的情况下使用它，因为我知道它在所有浏览器中都不兼容，需要时间加载并且可以被用户禁用。

我已经制作并设计了菜单，但希望菜单中的主标题在单击时更改为子菜单链接，同时保持菜单的其余部分完好无损。我如何在css中实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:14:01.277

您可以查看[http://davidwalsh.name/css-target](http://davidwalsh.name/css-target)并使用 css 目标选择器（但 IE 不支持它 - 我还没有检查 IE10）。

但-

如果您想更改 text 或 href 属性，那么**在纯 css 中是不可能的**（如果我错了，请纠正我）。你将不得不使用javascript。Jquery 使您的网站更容易支持最常用的浏览器，为什么不试一试呢？我敢肯定，如果您遇到困难，Stack Overflow 上的人会很乐意为您提供帮助。

在旁注中，用户也可以禁用 css（并非所有浏览器都支持所有 css 功能）。Css 和 Javascript 在同一条船上，因为浏览器决定了支持的内容。

# knockout.js - 如何在自定义绑定中绑定 css 类

> ID：14176374
> 
> 赞同：1
> 
> 时间：2013-01-05T21:02:05.967
> 
> 标签：knockout.js, ko-custom-binding

我创建了一个自定义绑定以用作颜色选择器。

```
<ul data-bind="colorPicker: selcol"></ul> 
```

它创建了 10 个内联 div，每个 div 代表其他颜色。当我单击一个 div 时，颜色被选中。我在分配 'selected; 时遇到问题；选择 div 的 css 类。我尝试在自定义绑定中使用 css 绑定，但这不起作用。它只选择即使在选择其他 div 后仍保持选中状态的初始 div。

请查看示例：http: [//jsfiddle.net/zbkkzdsp/Jbvvq/](http://jsfiddle.net/zbkkzdsp/Jbvvq/)

谢谢你的帮助。如果您对我的代码有任何提示或意见，请告诉我。我是淘汰赛的新手，会抓住任何机会了解更多信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T02:08:27.237

似乎您在自定义绑定中使用计算值做了很多花哨的事情，所以我建议为您的颜色创建视图模型。

首先为每种颜色定义一个视图模型：

```
var ColorModel = function(options) {
  var self = this;

  // Keep a reference to the parent picker for selection
  self.picker = options.picker;

  // The CSS value of the color
  self.color = ko.observable(options.color || 'transparent');

  // A flag denoting whether this color is selected
  self.selected = ko.observable(options.selected || false);

  // This will be called when the corresponding color link is clicked
  // Note that we're not doing any event binding with jQuery as with your custom binder
  self.select = function() {
    self.picker.selectColor(self); 
  };
}; 
```

然后是颜色选择器本身的视图模型：

```
var ColorPickerModel = function() {
  var self = this;

  // The list of all colors
  self.colors = ko.observableArray([]);

  self.addColor = function(color) {
    var newColor = new ColorModel({
        picker: self,
        color: color
    });

    self.colors.push(newColor);
    return newColor;
  };

  // Called by individual colors
  self.selectColor = function(colorModel) {
    // Deselect the current color so we don't select two
    var current = self.selected();
    if (current) {
      current.selected(false);
    }

    // Mark the color as selected - KO will do the rest
    colorModel.selected(true);

    // Remember this color as the selected one to deselect later
    self.selected(colorModel);
  };

  // Create at least one default color
  var transparent = self.addColor('transparent');

  // Keep track of the selected color - set to transparent by default
  self.selected = ko.observable(transparent);
  transparent.select();
}; 
```

然后将您的 HTML 视图绑定到您的选择器视图模型：

```
<div id="color-picker">
  <div data-bind="foreach: colors">
    <a href="#" data-bind="
       style: { 'background-color': $data.color }, 
       css: { 'selected': selected }, 
       click: select"></a>
  </div>
  <div>
    Selected color: <span data-bind="text: selected().color"></span>
  </div>    
</div> 
```

并将它们联系在一起：

```
var pickerDiv = document.getElementById('color-picker'),
    picker = new ColorPickerModel();

// Add some colors
picker.addColor('red');
picker.addColor('blue');
picker.addColor('green');
picker.addColor('orange');
picker.addColor('purple');
picker.addColor('black');

// Bind Knockout
ko.applyBindings(picker, pickerDiv);

// Add more colors - the view will update automatically
picker.addColor('pink'); 
```

这是一个工作示例：http: [//jsbin.com/izarik/1/edit](http://jsbin.com/izarik/1/edit)

# html - 格式化纬度和经度以在移动设备上自动检测

> ID：14176375
> 
> 赞同：1
> 
> 时间：2013-01-05T21:02:08.290
> 
> 标签：html, mobile, mapping, latitude-longitude

是否有在网站/应用程序上列出纬度/经度坐标的最佳做法，以便移动设备自动链接到默认地图应用程序？

例如，如果某个号码在网站上以纯文本“555-867-5309”列出，大多数移动设备会自动将其链接为电话号码。

如果我将 lat/long 列为纯文本，则它当前未被检测为可映射元素。有没有办法编写坐标，以便默认的地图应用程序只需单击一下就可以打开它们？如果重要，我正在使用基于十进制的坐标，例如：

```
22.12345,-84.123456 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T13:55:22.363

不，afaik 不存在。
如果存在，则坐标的顺序为 lat,lon

# python - Python 使给定的列表产品更具可扩展性

> ID：14176379
> 
> 赞同：0
> 
> 时间：2013-01-05T21:03:01.103
> 
> 标签：python

我想为给定列表的可能产品找到一种方法。基本上，索引后面可以跟着一个数字，例如 A1A2、A2C3... 或圆形数字 A3D1、D3B1... 下面，我有一个例子

一个例子：

```
the_list=['A1','A2','A3','B1','B2','B3','C1','C2','C3','D1','D2','D3']
The results should be: 
['A1A2','A1B2','A1C2','A1D2','A2A3','A2B3','A2C3','A2D3','A3A1','A3B1','A3C1','A3D1'
 'B1A2,'B2A3'...
 'C1A2'...'] 
```

到目前为止，我试过这个：

```
the_list=['A1','A2','A3','B1','B2','B3','C1','C2','C3','D1','D2','D3']
result=[]
for i in range(len(the_list)):
    for k in range((i%3+1),len(the_list)+1,3):
        s=str(the_list[i])+str(the_list[k%len(the_list)])
        result.append(s) 
```

输出：

```
['A1A2', 'A1B2', 'A1C2', 'A1D2', 'A2A3', 'A2B3', 'A2C3', 'A2D3', 'A3B1', 'A3C1', 
    'A3D1', 'A3A1', 'B1A2', 'B1B2', 'B1C2', 'B1D2', 'B2A3', 'B2B3', 'B2C3', 'B2D3', 'B3B1', 
    'B3C1', 'B3D1', 'B3A1', 'C1A2', 'C1B2', 'C1C2', 'C1D2', 'C2A3', 'C2B3', 'C2C3', 'C2D3', 
    'C3B1', 'C3C1', 'C3D1', 'C3A1', 'D1A2', 'D1B2', 'D1C2', 'D1D2', 'D2A3', 'D2B3', 'D2C3', 
    'D2D3', 'D3B1', 'D3C1', 'D3D1', 'D3A1'] 
```

这工作正常。但是，我想让它更具可扩展性，到目前为止它会生成两个序列，如 A1A2、A1D2 ......我如何更改我的代码以使其具有可扩展性？因此，如果比例为 3，它应该以相同的方式生成 A1A2A3,...。

更新：我认为应该再有一个 for 循环来处理大小并根据该数字累积序列，但到目前为止我无法弄清楚如何去做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:40:45.377

我想这就是你所追求的。

```
import itertools

def products(letters='ABCD', N=3, scale=2):
    for lets in itertools.product(letters, repeat=scale):
        for j in xrange(N):
            yield ''.join('%s%d' % (c, (i + j) % N + 1)
                          for i, c in enumerate(lets))

print list(products(scale=3)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T23:08:34.953

*   用于`numbers = IT.cycle(numbers)`生成有效数字的序列。[通过使它成为一个循环](http://docs.python.org/2/library/itertools.html#itertools.cycle)，您不必对待`1`跟随与跟随`3`有任何不同。`2``1`
*   每个项目中的字母可以由[itertools.product](http://docs.python.org/2/library/itertools.html#itertools.product)生成。该 `repeat`参数在这里特别有用。正如您所说，它将允许您将生成器“缩放”到更长的序列，而无需额外的努力。
*   您可以使用将由（以下称为）`zip`生成的字母 与from 组合。`itertools.product``lets``numbers``itertools.cycle`
*   `''.join(IT.chain.from_iterable`只是将返回的元组[列表加入](http://docs.python.org/2/library/itertools.html#itertools.chain.from_iterable)`zip`字符串的一种方法。

* * *

```
import itertools as IT

def neighbor_product(letters, numbers, repeat = 2):
    N = len(numbers)
    numbers = collections.deque(numbers)
    for lets in IT.product(letters, repeat = repeat):
        for i in range(N):
            yield ''.join(IT.chain.from_iterable(zip(lets, IT.cycle(numbers))))
            numbers.rotate(-1)

letters = 'ABCD'
numbers = '123'
for item in neighbor_product(letters, numbers, repeat = 3):
    print(item) 
```

产量

```
A1A2A3
A2A3A1
A3A1A2
A1A2B3
...
D3D1C2
D1D2D3
D2D3D1
D3D1D2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T21:36:45.897

**结果=[i+j for i in the_list for j in the_list]**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T21:38:50.640

我认为您正在寻找的是所有可能排列的子集。[`itertools.permutations()`](http://docs.python.org/2.7/library/itertools.html#itertools.permutations)对于给定序列和给定长度 n，将所有排列的生成器返回为 n 大小的元组。我会遍历所有排列并根据您的标准过滤它们。那这个呢：

```
In [1]: from itertools import permutations

In [2]: the_list = ['A1','A2','A3','B1','B2','B3','C1','C2','C3','D1','D2','D3']

In [3]: results = []

In [4]: digits = list(set([elem[1] for elem in the_list]))

In [5]: digits
Out[5]: ['1', '2', '3']

In [6]: for perm in permutations(the_list, 2):
  ....:     if (int(perm[0][1])+1 == int(perm[1][1]) or 
  ....:        (perm[0][1] == digits[-1] and perm[1][1] == digits[0])): 
  ....:         results.append(''.join(perm))

In [7]: sorted(results)
Out[7]: ['A1A2', 'A1B2', 'A1C2', 'A1D2', 'A2A3', 'A2B3', 'A2C3', 
         'A2D3', 'A3A1', 'A3B1', 'A3C1', 'A3D1', 'B1A2', 'B1B2', 
         'B1C2', 'B1D2', 'B2A3', 'B2B3', 'B2C3', 'B2D3', 'B3A1', 
         'B3B1', 'B3C1', 'B3D1', 'C1A2', 'C1B2', 'C1C2', 'C1D2', 
         'C2A3', 'C2B3', 'C2C3', 'C2D3', 'C3A1', 'C3B1', 'C3C1', 
         'C3D1', 'D1A2', 'D1B2', 'D1C2', 'D1D2', 'D2A3', 'D2B3', 
         'D2C3', 'D2D3', 'D3A1', 'D3B1', 'D3C1', 'D3D1'] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-05T22:49:14.863

由于根据您的规范，并非每个组合都是有效的，因此检查每个可能的组合并丢弃无效的组合可能不是最好的方法。

由于每个项目的数量对于确定组合是否有效很重要，让我们首先为其创建一个查找表：

```
from collections import defaultdict

lookup = defaultdict(list)
for item in the_list:
    lookup[int(item[1])].append(item) 
```

这使得获取具有特定数字的所有项目变得容易（当我们想要获取连续数字的项目时这将很有用）：

```
lookup[1] == ['A1', 'B1', 'C1', 'D1'] 
```

现在可以按以下方式创建所有有效组合：

```
from itertools import product

def valid_combinations(lookup):
    min_number = min(lookup)
    max_number = max(lookup)
    for number in lookup:
        # Let's just assume here that we've only got consecutive numbers, no gaps:
        next_number = min_number if number == max_number else number + 1
        for combination in product(lookup[number], lookup[next_number]):
            yield ''.join(combination) 
```

为了允许链接任意数量的项目，我们需要稍微修改一下：

```
def valid_combinations(lookup, scale = 2):
    min_number = min(lookup)
    max_number = max(lookup)
    def wrap_number(n):
        while n > max_number:
            n -= max_number + 1 - min_number
        return n
    for number in lookup:
        numbers = list(wrap_number(n) for n in range(number, number + scale))
        items = [lookup[n] for n in numbers]
        for combination in product(*items):
            yield ''.join(combination) 
```

对于 5 级，这将产生以下结果（仅显示总共 3072 个中的前几个）：

```
['A1A2A3A1A2', 'A1A2A3A1B2', 'A1A2A3A1C2', 'A1A2A3A1D2', 'A1A2A3B1A2', ...] 
```

# jquery - 如何在 jQuery 中完成 OR 操作？

> ID：14176380
> 
> 赞同：0
> 
> 时间：2013-01-05T21:03:02.517
> 
> 标签：jquery, conditional, or-operator

```
$(document).ready(function(){
if (!$('body').hasClass('home') || !$('ul#main-menu li.wwd').hasClass('active')){
$("ul#sub-menu").css('display','none');
$(".main-content").css('margin-top','13px');
$("ul#sub-menu").mouseover(function() {
        $("ul#sub-menu").show();
        $(".main-content").css('margin-top','62px');

}).mouseout(function() {
        $("ul#sub-menu").hide();
        $(".main-content").css('margin-top','13px');
});
$("li.wwd").mouseover(function() {
        $("ul#sub-menu").show();
        $(".main-content").css('margin-top','62px');
}).mouseout(function() {
        $("ul#sub-menu").hide();
        $(".main-content").css('margin-top','13px');
});
}
if ($('ul#main-menu li.wwd').is('.active')){
        $(".main-content").css('margin-top','62px');

}
}) 
```

我需要在除主页之外的所有页面上运行这个 jQuery（工作正常），但也不需要在`li.wwd`有 class的页面上运行`active`。我认为这适用于 OR 操作，但事实并非如此。感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T01:39:13.330

要评估`!(not)`两个地方的条件，您需要使用`&&`而不是`||`，就像

```
if (!$('body').hasClass('home') && !$('ul#main-menu li.wwd').hasClass('active'))
{
    // code goes here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:17:28.760

由于您使用的是否定运算符 (!)，因此当以下任一情况为真时，您的代码块当前正在运行：

1.  身体没有**“**家”类或
2.  ul#main-menu li.wwd 没有**“**活动”类

所以我怀疑您的主页代码似乎工作正常，因为在该页面上，ul#main-menu li.wwd 可能没有“活动”类？

# vim - 箭头键是在 Vim 中滚动 Clang 完成的方式吗？

> ID：14176382
> 
> 赞同：-2
> 
> 时间：2013-01-05T21:03:12.910
> 
> 标签：vim, clang-complete

在阅读了这里和 www 上的很多很棒的建议后，我很高兴尝试在 Linux（用于 C++）下设置我的第一个 Vim 环境。我已经添加了 C.Vim 插件，并且还成功添加了 Clang_complete - 这两个似乎都有效。但是，我正在使用箭头键并在“Clang-completions”之间进行选择——这似乎违背了 Vim 的纹理（从不接触箭头键）——我做错了什么吗？

只是想在正确的轨道上下车-谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:08:04.473

如果我没记错的话，clang-complete 的建议会被推送到默认的 vim 完成列表中，您可以使用`^p`或`^n`以相同的方式打开该列表。

# c# - 专用网络上的套接字

> ID：14176383
> 
> 赞同：1
> 
> 时间：2013-01-05T21:03:14.763
> 
> 标签：c#, sockets, tcp, embedded

我正在开发一个两部分的产品。一部分是运行 Windows Embedded Standard 的单板计算机上的 C# 应用程序。另一部分是运行带有 TCP/IP 堆栈的 RTOS 的嵌入式设备。这两个设备需要通过以太网电缆进行通信。这是一个点对点的连接。没有任何东西连接到任何外部网络。

我有点网络编程新手，所以我正在寻找最佳实践。我假设 TCP 套接字是最直接的方法。我想在编写任何代码并迷路之前我会得到一些建议。

保证的一件事是嵌入式设备将保持静态 IP 地址 169.254.1.1。这就是我所知道的一切。那么我需要知道什么才能让这些人联系起来？我知道子网存在问题......但这就是我的知识不足的地方。哪个应该是客户端，哪个是服务器，端口号等。

每个请求的更多信息：两端将交换一个非常简单的二进制协议。该部分已经定义，它通过 RS-232 链接工作。但是 RS-232 端口正在消失。我想用 TCP 来承载这些信息，再加上重试和错误检查等所有好东西。系统的任一端都可以发起传输。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:36:30.813

您可能想查看一些关于套接字编程的介绍，例如[http://beej.us/guide/bgnet](http://beej.us/guide/bgnet)。

windows 节点必须在与 rtos 设备相同的子网中配置一个网络接口，并从该子网中选择一个（不同的）IP 地址。

哪个设备是服务器并等待连接取决于您的应用程序，也可能取决于两个节点的启动顺序。例如，如果 RTOS 设备首先启动，它可能会等待 TCP 连接，直到另一端准备好。

当然，您需要在 tcp 流中使用一些协议。如果您不需要 TCP 提供的功能，可能 UDP 也可能是一种选择。这也可能会减少 RTOS 端的内存占用。

如果双方可以在没有任何硬件看门狗注意的情况下相互独立重启（或崩溃:-），请确保对方识别重启（例如使用 tcp keepalive 功能），以便您可以重新建立连接。

使用 TCP，您将获得可靠的连接，但根据您的应用程序，您可能会发现 Nagle 算法使您的消息延迟高于 RS232 设置。使用套接字上的 NO_DELAY 选项来避免这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T13:33:48.173

我非常建议你不要自己做 TCP。它很好，但对于机器对机器接口有许多难以发现的缺陷（例如，唠叨、KA 配置、测试打包状态机）。

我们是在 2012 年。您可以使用 ZeroMQ 和类似的 [随意编辑更多更好的 IP 消息传递库]。

# jquery - 从循环外停止 jQuery setInterval 循环

> ID：14176384
> 
> 赞同：1
> 
> 时间：2013-01-05T21:03:42.257
> 
> 标签：jquery, setinterval

我有一个控制滑块的 jQuery 设置间隔循环。我希望能够在用户单击将重新启动时间循环的滑块按钮时停止它，但我所知道的是如何停止循环

```
clearInterval(interval); 
```

这是在下面的循环之外的 3 个单击功能下，我想在每个单击功能停止后调用 setInterval 时间来重新启动它。

我如何回忆这个 setInterval 重新开始？

```
var interval = setInterval(timecode, 8000);
function timecode() {
$varadd = $varadd + 1;

if ($varadd == "1")
{
            $(".slider").css("left","-428px");
            $("#slidecont2").css('background-image', 'url(pictures/selected.png)');
            $("#slidecont1").css('background-image', 'url(pictures/unselected.png)');
            $("#slidecont3").css('background-image', 'url(pictures/unselected.png)');
}
else if ($varadd == "2")
{
            $(".slider").css("left","-856px");
            $("#slidecont3").css('background-image', 'url(pictures/selected.png)');
            $("#slidecont2").css('background-image', 'url(pictures/unselected.png)');
            $("#slidecont1").css('background-image', 'url(pictures/unselected.png)');
}
else if ($varadd == "3")
{
            $(".slider").css("left","0");
            $("#slidecont1").css('background-image', 'url(pictures/selected.png)');
            $("#slidecont2").css('background-image', 'url(pictures/unselected.png)');
            $("#slidecont3").css('background-image', 'url(pictures/unselected.png)');
$varadd = 0;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:07:14.350

我刚刚从这个人的帖子中解决了这个问题[Reset setinterval on click](https://stackoverflow.com/questions/3501652/reset-setinterval-on-click)

我用它来重新启动 setInterval，它还包括一个超时功能，可以为客人单击的幻灯片添加时间。

```
 setTimeout(function() {
    setInterval(timecode, 8000);
  }, 2000); 
```

所以在你的 3 click 函数里面你会有这样的东西。我假设你也会改变你的 $varadd 吗？

```
$(".slider").css("left","0");
$("#slidecont1").css('background-image', 'url(pictures/selected.png)');
$("#slidecont2").css('background-image', 'url(pictures/unselected.png)');
$("#slidecont3").css('background-image', 'url(pictures/unselected.png)');
clearInterval(interval);
$varadd = INTEGER;
setTimeout(function() {
setInterval(timecode, 8000);
}, 2000); 
```

如果您不想添加 setimeout 函数，只需重写 setInterval 即可。

# android - 乒乓游戏Android onTouchListener？

> ID：14176392
> 
> 赞同：0
> 
> 时间：2013-01-05T21:04:59.563
> 
> 标签：android, touch-event

所以基本上我用两个桨和一个非常简单的记分板制作了屏幕。我一直在研究一点，发现了 onTouch 方法。但这仅适用于 1 个桨。2个玩家怎么样？有没有onTouch和drag的方法，因为我想让玩家触摸paddle，然后左右移动。最后，我怎样才能为两个桨做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:11:18.093

[在这里](http://www.codeproject.com/Articles/458042/Touch-handling-in-Android)阅读更多。`onTouchEvent`接收`MotionEvent`对象，您可以使用`event.getActionIndex()`和处理多个触摸`event.getPointerId()`。您可能应该通过初始触摸坐标确定您是在移动 tob 还是底部桨，然后正确处理事件（例如通过移动与 PointerId 匹配的桨）

# ruby-on-rails - bootswatch-rails 主题并不适用

> ID：14176393
> 
> 赞同：3
> 
> 时间：2013-01-05T21:04:59.603
> 
> 标签：ruby-on-rails, twitter-bootstrap, bootswatch

我尝试使用 bootswatch-rails，但效果不佳，例如，按钮显示不正确，不像 bootwatch 网站上显示的那样。
我将 bootstrap-sass 和 bootswatch 放入我的 gemfile 并捆绑安装

```
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'bootswatch-rails', '>=0.2.0'

  gem 'uglifier', '>= 1.0.3'
end
gem 'bootstrap-sass', '>= 2.1.0.0' 
```

在我的 bootstrap_and_overrides.css.scss 文件中看起来像这样

```
// First import journal variables
@import "bootswatch/cerulean/variables";

// Then bootstrap itself
@import "bootstrap";

// Responsive styles go here in case you want them
@import "bootstrap-responsive";

// And finally bootswatch style itself
@import "bootswatch/cerulean/bootswatch"; 
```

我真的不知道我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T22:14:08.417

您是否有任何其他未考虑的 css 文件被导入，例如scaffold.css（当您通过scaffold 命令生成资源时）？

# java - NV21 到 RGB 转换结果为黑白

> ID：14176401
> 
> 赞同：2
> 
> 时间：2013-01-05T21:05:46.613
> 
> 标签：java, android, rgb, yuv

我正在将 NV21 的单个像素转换为 RGB，这就是我所做的：

```
 public int getYUVvalue(byte[] yuv,int width,int height,int x,int y){
        int total=width*height;
    int Y=(0xff&yuv[y*width+x])-16;
    int U=(0xff&yuv[(y/2)*(width/2)+(x/2)+total])-128;
    int V=(0xff&yuv[(y/2)*(width/2)+(x/2)+total+1])-128;
    return this.convertYUVtoRGB(Y, U, V);

    }
 private static int convertYUVtoRGB(int y, int u, int v) {

        int y1192 = 1192 * y;
        int r = (y1192 + 1634 * v);
        int g = (y1192 - 833 * v - 400 * u);
        int b = (y1192 + 2066 * u);
        if (r < 0) r = 0; else if (r > 262143) r = 262143;
        if (g < 0) g = 0; else if (g > 262143) g = 262143;
        if (b < 0) b = 0; else if (b > 262143) b = 262143;

        return 0xff000000 | ((r << 6) & 0xff0000) | ((g >> 2) & 0xff00) | ((b >> 10) & 0xff);
    } 
```

但结果只是黑白，看起来 U 和 V 值不正确，有人可以帮我解决这个问题吗？谢谢你！

更新：我确认我的 Y 值是正确的，所以我认为问题出在 U 和 V 值上，我不知道问题出在哪里。update#2：我的代码和 decodeYUV420sp() 非常相似，这是一个广泛使用的转换整个图像的函数，它工作得很好，我的只是转换单个像素，仍然试图通过比较来找出问题所在我的代码。这是decodeyuv420sp函数：

```
static public void decodeYUV420SP(int[] rgb, byte[] yuv420sp, int width, int height) {
        final int frameSize = width * height;

        for (int j = 0, yp = 0; j < height; j++) {
        int uvp = frameSize + (j >> 1) * width, u = 0, v = 0;
        for (int i = 0; i < width; i++, yp++) {
            int y = (0xff & ((int) yuv420sp[yp])) - 16;
            if (y < 0) y = 0;
            if ((i & 1) == 0) {
                v = (0xff & yuv420sp[uvp++]) - 128;
                u = (0xff & yuv420sp[uvp++]) - 128;
            }

            int y1192 = 1192 * y;
            int r = (y1192 + 1634 * v);
            int g = (y1192 - 833 * v - 400 * u);
            int b = (y1192 + 2066 * u);

            if (r < 0) r = 0; else if (r > 262143) r = 262143;
            if (g < 0) g = 0; else if (g > 262143) g = 262143;
            if (b < 0) b = 0; else if (b > 262143) b = 262143;

            rgb[yp] = 0xff000000 | ((r << 6) & 0xff0000) | ((g >> 2) & 0xff00) | ((b >> 10) & 0xff);
        }
    }
    } 
```

我仍然看不出我的错误在哪里。

update#3：问题已解决，感谢大家的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T02:52:43.630

getYUVvalue函数中U&V的数组索引的逻辑与decodeYUV420SP中的逻辑不匹配。（我计算了 3 个差异。）如果没有这种格式的样本字节数组进行测试，我不能确定，但​​我认为应该是：

```
int U=(0xff&yuv[(y/2)*width+(x&~1)+total+1])-128;
int V=(0xff&yuv[(y/2)*width+(x&~1)+total])-128; 
```

它也缺少`if (y < 0) y = 0;`检查。也许这很重要。

# youtube-api - Youtube API feed应用过滤器

> ID：14176416
> 
> 赞同：1
> 
> 时间：2013-01-05T21:06:59.233
> 
> 标签：youtube-api

我正在使用以下 rss 提要从 youtube 获取视频。工作正常。 [http://gdata.youtube.com/feeds/api/users/zeetv/uploads?alt=rss&v=2&orderby=published&client=ytapi-youtube-profile](http://gdata.youtube.com/feeds/api/users/zeetv/uploads?alt=rss&v=2&orderby=published&client=ytapi-youtube-profile)；

现在我喜欢应用某些过滤器......例如：列出标题中有“剧集”的视频。

```
http://gdata.youtube.com/feeds/api/users/zeetv/uploads?alt=rss&amp;v=2&amp;orderby=published&amp;client=ytapi-youtube-profile&amp;q=Episode; 
```

但它不会过滤掉与“episode”匹配的视频，而是列出所有视频。

我已经检查了这个链接[https://developers.google.com/youtube/2.0/developers_guide_protocol_api_query_parameters](https://developers.google.com/youtube/2.0/developers_guide_protocol_api_query_parameters)

并应用查询字符串。

任何帮助深表感谢。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:14:01.217

好像你不能像那样查询用户的视频。

您必须像这样构建您的查询：[http](http://gdata.youtube.com/feeds/api/users/zeetv/uploads?q=Episode&fields=entry(title) ://gdata.youtube.com/feeds/api/users/zeetv/uploads?q=Episode&fields=entry(title )

您可以在此处阅读有关字段语法的更多信息：[https ://developers.google.com/youtube/2.0/developers_guide_protocol_partial#Fields_Formatting_Rules](https://developers.google.com/youtube/2.0/developers_guide_protocol_partial#Fields_Formatting_Rules)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-13T17:36:01.463

问题中提供的链接现在有了答案。您应该搜索您想要的术语并按作者过滤：

[https://gdata.youtube.com/feeds/api/videos?q=episode&author=zeetv](https://gdata.youtube.com/feeds/api/videos?q=episode&author=zeetv)

# java - Spring maven 项目 BeanCreationException

> ID：14176417
> 
> 赞同：0
> 
> 时间：2013-01-05T21:07:06.550
> 
> 标签：java, spring, javabeans, load-time-weaving

我已经升级到 Spring 源代码 3.1.0，但我不确定为什么我的项目无法再找到

```
ReflectiveLoadTimeWeaver 
```

我已确保在我的构建路径中添加服务器运行时库，但我仍然以`BeancreationExceptions`. 堆栈跟踪：

```
INFO: Initializing Spring root WebApplicationContext
2013-01-05 14:58:49,242 [localhost-startStop-1] ERROR org.springframework.web.context.ContextLoader - Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionManager' defined in file [/Users/warz07/Documents/workspace-sts-3.1.0.RELEASE/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Dugsi_Manager/WEB-INF/classes/META-INF/spring/applicationContext.xml]: Cannot resolve reference to bean 'entityManagerFactory' while setting bean property 'entityManagerFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in file [/Users/warz07/Documents/workspace-sts-3.1.0.RELEASE/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Dugsi_Manager/WEB-INF/classes/META-INF/spring/applicationContext.xml]: Cannot create inner bean 'org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver#3834a1c8' of type [org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver] while setting bean property 'loadTimeWeaver'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver#3834a1c8' defined in file [/Users/warz07/Documents/workspace-sts-3.1.0.RELEASE/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Dugsi_Manager/WEB-INF/classes/META-INF/spring/applicationContext.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver]: Constructor threw exception; nested exception is java.lang.IllegalStateException: ClassLoader [org.apache.catalina.loader.WebappClassLoader] does NOT provide an 'addTransformer(ClassFileTransformer)' method.
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328) 
```

主要说明它与 RelectiveLoadTimeWeaver 有问题，

```
Error creating bean with name 'org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver#3834a1c8' 
```

我曾经能够更新我的服务器的 context.xml 并添加 InstrumentalLoadtimeWeaver 加载器，但它不再有效。

```
<?xml version="1.0" encoding="UTF-8"?>
<Context>
    <!-- Default set of monitored resources -->
    <WatchedResource>WEB-INF/web.xml</WatchedResource>
    <!-- Uncomment this to disable session persistence across Tomcat restarts -->
    <!--
        <Manager pathname="" />
        -->
    <!-- Uncomment this to enable Comet connection tacking (provides events
             on session expiration as well as webapp lifecycle) -->
    <!--
        <Valve className="org.apache.catalina.valves.CometConnectionManagerValve" />
        -->
       <Loader  loaderClass="com.springsource.insight.collection.tcserver.ltw.TomcatWeavingInsightClassLoader"/>
</Context> 
```

编辑：完整的堆栈跟踪

```
2013-01-05 15:30:36,647 [localhost-startStop-1] ERROR org.springframework.web.context.ContextLoader - Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionManager' defined in file [/Users/warz07/Documents/workspace-sts-3.1.0.RELEASE/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Dugsi_Manager/WEB-INF/classes/META-INF/spring/applicationContext.xml]: Cannot resolve reference to bean 'entityManagerFactory' while setting bean property 'entityManagerFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in file [/Users/warz07/Documents/workspace-sts-3.1.0.RELEASE/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Dugsi_Manager/WEB-INF/classes/META-INF/spring/applicationContext.xml]: Cannot create inner bean 'org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver#86ecec5' of type [org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver] while setting bean property 'loadTimeWeaver'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver#86ecec5' defined in file [/Users/warz07/Documents/workspace-sts-3.1.0.RELEASE/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Dugsi_Manager/WEB-INF/classes/META-INF/spring/applicationContext.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver]: Constructor threw exception; nested exception is java.lang.IllegalStateException: ClassLoader [org.apache.catalina.loader.WebappClassLoader] does NOT provide an 'addTransformer(ClassFileTransformer)' method.
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1360)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1118)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:384)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4791)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5285)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:618)
    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:650)
    at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1582)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in file [/Users/warz07/Documents/workspace-sts-3.1.0.RELEASE/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Dugsi_Manager/WEB-INF/classes/META-INF/spring/applicationContext.xml]: Cannot create inner bean 'org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver#86ecec5' of type [org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver] while setting bean property 'loadTimeWeaver'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver#86ecec5' defined in file [/Users/warz07/Documents/workspace-sts-3.1.0.RELEASE/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Dugsi_Manager/WEB-INF/classes/META-INF/spring/applicationContext.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver]: Constructor threw exception; nested exception is java.lang.IllegalStateException: ClassLoader [org.apache.catalina.loader.WebappClassLoader] does NOT provide an 'addTransformer(ClassFileTransformer)' method.
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveInnerBean(BeanDefinitionValueResolver.java:281)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:120)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1360)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1118)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322)
    ... 29 more
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver#86ecec5' defined in file [/Users/warz07/Documents/workspace-sts-3.1.0.RELEASE/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Dugsi_Manager/WEB-INF/classes/META-INF/spring/applicationContext.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver]: Constructor threw exception; nested exception is java.lang.IllegalStateException: ClassLoader [org.apache.catalina.loader.WebappClassLoader] does NOT provide an 'addTransformer(ClassFileTransformer)' method.
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:997)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:943)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveInnerBean(BeanDefinitionValueResolver.java:270)
    ... 39 more
Caused by: org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver]: Constructor threw exception; nested exception is java.lang.IllegalStateException: ClassLoader [org.apache.catalina.loader.WebappClassLoader] does NOT provide an 'addTransformer(ClassFileTransformer)' method.
    at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:162)
    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:76)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:990)
    ... 43 more
Caused by: java.lang.IllegalStateException: ClassLoader [org.apache.catalina.loader.WebappClassLoader] does NOT provide an 'addTransformer(ClassFileTransformer)' method.
    at org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver.<init>(ReflectiveLoadTimeWeaver.java:103)
    at org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver.<init>(ReflectiveLoadTimeWeaver.java:86)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:147) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T09:45:43.767

异常表明您的应用程序是由 Tomcat 自己加载的`WebappClassLoader`，而不是 Spring 的`TomcatInstrumentableClassLoader`- 所以您的 Tomcat 配置可能已经失败。也许您应该尝试将`loaderClass`属性放在这样的`<Loader>`元素下：

```
<Context path="/your-application">
    <Loader loaderClass="org.springframework.instrument.classloading.tomcat.TomcatInstrumentableClassLoader"/>
</Context> 
```

如此[处](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/aop.html#aop-aj-ltw-environments)所述。

# asp.net-mvc-3 - 带视图的 $.ajax 不起作用

> ID：14176419
> 
> 赞同：0
> 
> 时间：2013-01-05T21:07:15.260
> 
> 标签：asp.net-mvc-3

我是 ASP.NET MVC 的新手。我想调用控制器的方法，该方法不是视图中的操作方法，`$.ajax`但在浏览器控制台中出现错误。我想问一下，是不是不能通过ajax调用不是动作方法的方法。

查看代码

```
@{
    ViewBag.Title = "About Us";
}
<script type="text/javascript">

    function ajaxcall() {
        $.ajax({
            url: '/Home/ValidatePin',
            type: 'Post',
            success: function (result) {
                alert(result.d);
            }
        })
    }
</script>
<h2>About</h2>
<p>
    Put content here.

    <input type="button" onclick="ajaxcall()"  value="clickme" />
</p> 
```

这是我的方法代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Web.Services;
namespace MvcApplication1.Controllers
{
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            ViewBag.Message = "Welcome to ASP.NET MVC!";

            return View();
        }

        public ActionResult About()
        {
            return View();
        }

        [WebMethod]
        public static string ValidatePin()
        {
            return "returned from controller class";
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:12:24.870

控制器的所有公共方法都是动作，除非用[`NonAction`](http://msdn.microsoft.com/en-us/library/system.web.mvc.nonactionattribute%28v=vs.108%29.aspx)属性标记。

该`[WebMethod]`属性来自 ASP.NET Web 服务（非 MVC），在 MVC 控制器中无效。

您的`ValidatePin`方法没有被调用，因为它是静态的。动作方法必须是实例方法。

# python - 计算文件中的每个字符

> ID：14176421
> 
> 赞同：1
> 
> 时间：2013-01-05T21:07:15.677
> 
> 标签：python

我正在尝试计算文件中的每个字符并将其放入字典中。但它并不完全有效，我没有得到所有的字符。

```
#!/usr/bin/env python
import os,sys

def count_chars(p):
     indx = {}
     file = open(p)

     current = 0
     for ch in file.readlines():
          c = ch[current:current+1]
          if c in indx:
               indx[c] = indx[c]+1
          else:
               indx[c] = 1           
          current+=1
     print indx

if len(sys.argv) > 1:
     for e in sys.argv[1:]:
          print e, "contains:"
          count_chars(e)
else:
     print "[#] Usage: ./aufg2.py <filename>" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-05T21:13:50.500

假设您正在计算的文件合理地适合内存：

```
import collections
with open(p) as f:
    indx = collections.Counter(f.read()) 
```

* * *

否则，您可以一点一点地阅读它：

```
import collections
with open(p) as f:
    indx = collections.Counter()
    buffer = f.read(1024)
    while buffer:
        indx.update(buffer)
        buffer = f.read(1024) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T21:09:28.823

主要问题是您只检查（最多！）每一行中的一个字符。如果您逐行读取文件，则需要有一个内部循环来迭代该行的字符。

```
#!/usr/bin/env python
import os, sys, collections

def count_chars(p):
     indx = collections.Counter()
     with open(p) as f:
         for line in f:
             for c in line:
                 indx[c] += 1
     print indx

if len(sys.argv) > 1:
     for e in sys.argv[1:]:
          print e, "contains:"
          count_chars(e)
else:
     print "[#] Usage: ./aufg2.py <filename>" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T21:16:45.430

使用[defaultdict](http://docs.python.org/3/library/collections.html#collections.defaultdict)。基本上，如果您尝试在 defaultdict 中获取不存在的项目，它会创建键并调用构造函数指定的第 0 个参数用作值。

```
import collections

def count_chars(p):
    d = collections.defaultdict(int)
    for letter in open(p).read():
        d[letter] += 1
    return d 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-05T21:40:32.833

我已将此作为对@Amber 答案的评论发布，但将在此处重复...

要计算文件中字节的出现次数，然后生成一个小迭代器：

```
with open('file') as fin:
    chars = iter(lambda: fin.read(1), '')
    counts = Counter(chars) 
```

这样，底层缓冲`fin`仍然适用，但它仍然更加隐含，您一次读取一个字节（而不是块大小，无论如何操作系统都会自行执行），它也允许不使用`update`on对象，`Counter`实际上变得更像是一个完整的、独立的指令。

# java - 在自己的假文件系统中运行 Java 应用程序

> ID：14176422
> 
> 赞同：2
> 
> 时间：2013-01-05T21:07:21.370
> 
> 标签：java, linux, file

我正在设计一组 Java 程序，希望有朝一日能变成基于 Java 的操作系统。在我得到一个内核工作之前，我只想在 Linux 系统上运行它们（我使用的是 Ubuntu，如果这很重要的话）。因此，我需要将所有文件系统调用定向到我的主文件夹中的不同目录，因此`/`从 Java 中访问实际上会访问`/home/<user>/Thunderbolt/`.

[我基本上需要和这个问题](https://stackoverflow.com/questions/10271093/fake-filesystem-for-ruby)一样的东西，[还有这个问题](https://stackoverflow.com/questions/2452488/faking-a-filesystem-virtual-filesystem)，但对于 Java。

我看过关于 的东西`chroot`，我认为这可能有效，但我不知道如何让它与 Java 一起工作。我根本不需要担心安全性，我只需要不同的假文件系统。

此外，需要访问核心 Java 库，而无需将它们复制到假文件系统中。

**这可能吗，如果可以，我该如何设置？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T21:12:52.343

不确定，但如果你只想重现文件系统语义（可能用于测试），我建议你抽象你的文件系统后端。

一个不错的选择是使用[commons-vfs](http://commons.apache.org/vfs/)。它模仿一个虚拟文件系统，支持：

*   .zip 文件/.jar 文件
*   .gz 文件
*   内存文件系统
*   基于类路径的文件系统
*   基于 URL

所以基本上，您的“thunderbolt”目录将是另一个已实现的文件系统，您可以将其用于测试和设计。

你所有的应用程序都需要依赖调用 VFS，但这不是一个大问题，我认为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:22:02.987

系统库中以文件路径字符串作为参数的类并不多。文件确实，可能是 FileInputStream、FileReader、RandomAccessFile，可能是 URL 应该被审查，也可能是其他一些 - 几天的审查应该揭示最多。

在您的具体情况下，考虑使用开源并允许这样做的[OpenJDK调整 Java 系统库可能是合理的。](http://openjdk.java.net/)还有另外两个可供选择的 FOSS 项目，[GNU Classpath](http://www.gnu.org/software/classpath/)和[Apache Harmony](http://harmony.apache.org/)，它们可能更容易构建（我过去曾多次构建 GNU Classpath）但这些项目目前不是很活跃。它们是针对研究或其他项目需要修改 Java 系统库的情况而启动的。

如果您发现这些项目难以构建，您可以尝试单独构建并仅替换几个系统类。

该解决方案还允许运行无法修改以通过 commonsfs API 路由所有文件系统访问的第三方 Java 程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T21:15:42.663

[Linux] Chroot 是正确的（但并不简单）。对于不重新复制所有库...您可以使用

> mount --bind -o ro /source/ /destination/

（*man mount*了解更多信息）

# node.js - 无法使用 Express 3.0 在 Node.js 中设置 cookie 'expires' 或 'maxAge'

> ID：14176432
> 
> 赞同：19
> 
> 时间：2013-01-05T21:08:57.950
> 
> 标签：node.js, google-chrome, cookies, express

我一直在尝试使用 Express 3.0 在 Node.js 中设置我的 cookie 的到期日期，但没有任何效果。

我的第一次尝试：

```
res.cookie('user', user, { maxAge: 9000, httpOnly: true }); 
```

只是以根据 Chrome 的无效到期时间结束的 cookie 结束。然后我尝试设置“过期”，如下所示：

```
res.cookie('user', user, { expires: new Date(new Date().getTime()+5*60*1000), httpOnly: true }); 
```

现在我的 cookie 只是一个会话 cookie。

有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2017-09-03T18:23:56.767

请注意 maxAge 以毫秒为单位-

```
res.cookie('jwtToken', token, { maxAge: 2 * 60 * 60 * 1000, httpOnly: true }); // maxAge: 2 hours 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-05T22:16:24.087

你必须使用`req.session.cookie`：

```
req.session.cookie.expires = false;

req.session.cookie.maxAge = 5 * 60 * 1000; 
```

另请参阅[连接文档](http://www.senchalabs.org/connect/session.html)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-12-19T14:36:45.340

接受的答案对我不起作用..但原始问题的版本确实有效。例如

```
var language = 'en';
//10 * 365 * 24 * 60 * 60 * 1000 === 315360000000, or 10 years in milliseconds
var expiryDate = new Date(Number(new Date()) + 315360000000); 
this.__res.cookie('lang', language, { expires: expiryDate, httpOnly: true }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-08T17:33:09.153

```
res.cookie('cookieName', jsonObject, { expires: new Date(Date.now() + (30*24*3600000)) }); /*set 1month, 
```

如果您遇到与 cookie 过期初始化相关的任何问题，请自行调试，我必须自己调试并修复如下：

*   将初始化时间插入新变量

```
var expiryDate = new Date(Date.now() + (60*24*3600000));
console.log(expiryDate); 
```

*   如果它显示为方面，然后查看`cookieParser npm v`

# ruby-on-rails-3 - rails3 i18n 接受_nested_attributes_for 如何翻译？

> ID：14176433
> 
> 赞同：4
> 
> 时间：2013-01-05T21:09:19.603
> 
> 标签：ruby-on-rails-3, activerecord, internationalization, nested-attributes, rails-i18n

我正在使用 Rails 3.2.6，这是一个示例：

```
class Man < ActiveRecord::Base
  has_many :eyes
  accepts_nested_attributes_for :eyes
end
class Eye < ActiveRecord::Base
  belongs_to :man
  validates_inclusion_of :color, in: { %w[brown green blue] }
end 
```

视图（在 HAML 中）：

```
= form_for @man do |f|
  - if @man.errors.any?
    #error_explanation
      %h2= t 'errors.messages.record_invalid', count: @man.errors.count
      %ul
        - @man.errors.full_messages.each do |msg|
          %li= msg

  = f.fields_for(:eyes) do |b|
    .field
      = b.label :color
      = b.text_field :color

  .actions
    = f.submit :submit 
```

it.yml：

```
it:
  activerecord:
    attributes:
      customer:
        eyes: Occhi
      customer/eyes:
        color: Colore
  errors:
    models:
      man/eyes:
        attributes:
          color:
            inclusion: non valido 
```

但是颜色的标签没有翻译（但它是'actviterecord.attributes.eye.color'），错误消息中的属性只有“Occhi”，其余的`errors.model.eyes.attributes.color.inclusion`不是`errors.models.man/eyes.attributes.color.inclusion`

错误消息是`errors.model.man.attributes.eyes.inclusion`，但我如何区分它？它应该类似于“Occhi Colore non valido”而不是“Occhi non valido”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-13T21:07:52.490

试试这个：

```
it:
  activerecord:
    attributes:
      # set the name used in nested attribute error messages
      customer/eyes:
        color: Occhi Colore
  errors:
    models:
      # change the error message for eye color not included in the list
      eye:
        attributes:
          color:
            inclusion: non valido
    messages:
      # change the inclusion message globally
      inclusion: non valido
  helpers:
    label:
      # set the label used by form builder for labels
      man[eyes_attributes]:
        color: Occhi Colore 
```

# c# - 如何通过 WPF ListView 杀死 Windows 进程？

> ID：14176434
> 
> 赞同：1
> 
> 时间：2013-01-05T21:09:19.773
> 
> 标签：c#, .net, wpf, listview

我是 WPF 新手，正在尝试构建自己的 Windows 任务管理器。现在我有一个窗口，我的机器上运行的所有活动进程都显示在`ListView`.

现在这是我的问题：我有一个名为`End Process`. 我想从中选择一个进程`ListView`并按下`End Process`按钮将其终止。我只是不知道该怎么做。

我将此代码（C#）分配给按钮：

```
private void End_Process_Click(object sender, RoutedEventArgs e)
{
    Process[] procs=Process.GetProcessesByName(ProcessesListView.SelectedItem.ToString());    
    foreach (Process p in procs)
    {
        p.Kill();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:39:33.690

我怀疑您列表中的项目是实际`Process`对象。如果是这样，您可以执行以下操作：

```
private void End_Process_Click(object sender, RoutedEventArgs e)
{
  Process process = (Process)ProcessesListView.SelectedItem;
  process.Kill();
} 
```

# c# - 如何在 Windows 中以管理员身份透明地执行任务

> ID：14176440
> 
> 赞同：0
> 
> 时间：2013-01-05T21:10:15.437
> 
> 标签：c#, c++, windows, winapi

我想（以编程方式）在某些海拔情况下模拟 Windows 的行为。例如，您可以查看无线密码，而无需向管理员确认提升（在无线网络属性 > 显示字符中）。

在这种情况下，没有弹出窗口来请求确认提升。只有一个友好的图标表明该操作要求用户是管理员。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T21:45:06.660

某些场景下没有弹窗的原因是 UAC 自动提升。

以下是Mark Russinovich 撰写的[这篇文章](http://technet.microsoft.com/en-us/magazine/2009.07.uac.aspx#id0560031)的摘录

> 在两个中间设置中提升（大多数）Windows 可执行文件不会导致提示的原因是系统“自动提升”Windows 可执行文件。首先，在这种情况下，Windows 将什么定义为 Windows 可执行文件？答案取决于几个因素，但有两点必须成立：它必须由 Windows 发布者进行数字签名，这是用于签署 Windows 包含的所有代码的证书（由 Microsoft 签名是不够的，因此 Microsoft 软件不是不包括在 Windows 中提供的）；它必须位于少数几个“安全”目录之一中。

这意味着您的可执行文件必须由 Microsoft 签名，并且必须位于那些“安全”目录中。Windows 不会自动提升所有内容。

# c# - 如何从我的 mono for android 应用程序中获取网络文件列表？

> ID：14176444
> 
> 赞同：1
> 
> 时间：2013-01-05T21:10:50.533
> 
> 标签：c#, android, xamarin.android

一段时间以来，我一直在使用 Mono for Android。我想知道如何（或是否有可能）访问位于我的 NAS 上的网络文件。

我真的希望它会像

```
var files = System.IO.Directory.GetFiles("\\NAS-NAME\SomeDirectory\", "*"); 
```

不幸的是，我收到了这条错误消息，所以我猜它不像标准的 .NET 应用程序那么简单：

```
Unhandled Exception:

System.IO.DirectoryNotFoundException: Directory '\\NAS-NAME\SomeDirectory\' not found. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T13:51:03.087

> 我猜它不像标准的 .NET 应用程序那么简单：

标准的 .NET 应用程序有所有 WinAPI 可以构建，例如`FileStream.Write`使用`WriteFile`支持 UNC 路径的 WinAPI。Android 是 Linux，因此没有“完整”的 WinAPI 实现，CIFS/SMB 超出了 Mono for Android 的范围（以及普通的 Mono），因此出现了错误。

您应该尝试使用备用网络协议，例如您的 NAS 是否支持 WebDAV？有许多 C# WebDAV 库可以轻松移植到 Mono for Android...

# angularjs - 具有隔离范围的自定义角度指令

> ID：14176448
> 
> 赞同：-1
> 
> 时间：2013-01-05T21:11:09.097
> 
> 标签：angularjs

我正在尝试创建一个显示日历页面的简单页面。

我所拥有的是一个 html 片段，它遍历一个天数组并为每个月的每一天创建一个单元格。所以我要将当前日期、当前月份、当前年份和星期数组传递给此模板。

该逻辑在使用全局范围时运行良好，但由于一个页面内可以有多个日历实例，因此我创建了一个隔离范围并希望在指令呈现时将值推送到片段。

我无法将范围值与 html 片段绑定。它不断向我抛出错误： `'Error: Non-assignable model expression: undefined (directive: calender)'`。

[小提琴链接](http://jsfiddle.net/chinmay_sagade/63ZmZ/1/)。

需要帮助来理解需要做什么才能让这个东西在孤立的范围内工作。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T04:15:43.757

我收到错误：不可分配的模型表达式：未定义的错误，因为我的指令上没有该名称的可绑定属性，而是模型值。
我将范围定义替换为
范围：{ngModel：'='}，然后链接器函数能够更新模型值。

# javascript - javascript（node.js）地理计算导致NaN

> ID：14176451
> 
> 赞同：1
> 
> 时间：2013-01-05T21:11:24.853
> 
> 标签：javascript, node.js, geo

我正在尝试执行 node+geo-stuff 以从给定的纬度、经度和半径中检索所有位置以进行该计算，我正在尝试以下内容，但它会导致 NaN。

类似的代码在 php，python 中运行良好，但无法弄清楚我在这里做错了什么。

参考：[http ://www.scribd.com/doc/2569355/Geo-Distance-Search-with-MySQL](http://www.scribd.com/doc/2569355/Geo-Distance-Search-with-MySQL)

PS 1：使用 nodejs 进行此计算，因为它需要在服务器端进行计算。PS 2：甚至变量名看起来像php变量，它是js。

`$cat file.js`

```
var log =console.log;
var cos=Math.cos;
var sin=Math.sin;

function rad2deg(x){ log("rad2deg:", x,180*x/Math.pi);return (180*x/Math.pi);}
function deg2rad(x){ log("deg2rad:",x,x*Math.pi/180);return (x*Math.pi/180);}

function getNearPoint($lat,$lng,$rad){

  console.log("Debug1",$lat,$lng);
  $R = 6371;  // earth's radius, km
  // first-cut bounding box (in degrees)
  $maxLat = $lat + rad2deg($rad/$R);
  $minLat = $lat - rad2deg($rad/$R);
  console.log("Debug2",$lat,$lng);
  // compensate for degrees lnggitude getting smaller with increasing latitude
  $maxlng = $lng + rad2deg($rad/$R/cos(deg2rad($lat)));
  $minlng = $lng - rad2deg($rad/$R/cos(deg2rad($lat)));

  console.log("Debug3",$lat,$lng);
  // convert origin of filter circle to radians
  $lat = deg2rad($lat);
  $lng = deg2rad($lng);

  console.log("Debug4",$lat,$lng);

//Build database query and do rest of the stuff
}

getNearPoint(19.1947659,72.8768400,50); 
```

这是输出。

`$ node file.js`

```
Debug1 19.1947659 72.87684
rad2deg: 0.007848061528802385 NaN
rad2deg: 0.007848061528802385 NaN
Debug2 19.1947659 72.87684
deg2rad: 19.1947659 NaN
rad2deg: NaN NaN
deg2rad: 19.1947659 NaN
rad2deg: NaN NaN
Debug3 19.1947659 72.87684
deg2rad: 19.1947659 NaN
deg2rad: 72.87684 NaN
Debug4 NaN NaN 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:22:52.113

没有像 那样的常数`Math.pi`。您可能想改用`Math.PI`（大写）。:)

`Math.pi`是`undefined`，因此最终会返回`NaN`。

# range - Highstock：如何以编程方式对所选值求和并向用户显示总和

> ID：14176459
> 
> 赞同：0
> 
> 时间：2013-01-05T21:13:12.563
> 
> 标签：range, highstock

如何对选定范围内的一条线中的点求和以便向用户显示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T12:49:46.917

是的，可以通过使用 afterSetExtremes 函数 ( [http://api.highcharts.com/highstock#xAxis.events.afterSetExtremes](http://api.highcharts.com/highstock#xAxis.events.afterSetExtremes) ) 来捕获“更改”范围事件并运行自定义函数。因此，您可以对意甲中的所有点进行交互，并通过检查最小/最大范围值来限制应将哪些点添加到总和中。

[http://jsfiddle.net/2WdQw/](http://jsfiddle.net/2WdQw/)

```
afterSetExtremes: function(e) {
                var sum = 0,
                    chartOb = this;

                $.each(chartOb.series[0].data,function(i,point){

                    if(point.x >= chartOb.min && point.x <= chartOb.max)
                        sum += point.y;

                });

                $('#report').html('Sum: '+sum);
            } 
```

# c++ - 'std::向量 ::iterator' 没有名为 'begin' 的成员

> ID：14176462
> 
> 赞同：0
> 
> 时间：2013-01-05T21:14:00.123
> 
> 标签：c++, iterator

因此，我尝试在大型 C++ STL 向量上执行递归（拆分基数递归蝴蝶的非常简单的代码），并且我正在使用迭代器来调用递归，但由于我不断出错，因此无法正常工作。

```
#include <iostream>
#include <cmath>
#include <vector>
#include <string>
#include <algorithm>

using namespace std;

template <typename T>
class fft_data{
public: 
vector<T> re;
vector<T> im;

};

void inline split_radix_rec(vector<double>::iterator r,vector<double>::iterator i, int sgn,int N) {
if (N == 1) {
    return;
} else if (N == 2) {
    for (int k = 0; k < N/2; k++) {
        int index = 2*k;
        int index1 = index+1;
        double taur =  *(r+index1);
        double taui =  *(i+index1);

        *(r+index1) = *(r+index) - taur; 
        *(i+index1) = *(i+index) - taui; 

        *(r+index) = *(r+index) + taur; 
        *(i+index) = *(i+index) + taui; 
    }
    N=N/2;
} else {
    int m = N/2;
    int p = N/4;

    double PI2 = 6.28318530717958647692528676655900577;
    double theta =  -1.0 * sgn * PI2/N;

    double S =  sin(theta);
    double C =  cos(theta);

    double PI6 =  3.0*6.28318530717958647692528676655900577;
    double theta3 =  -1.0 * sgn * PI6/N;

    double S3 =  sin(theta3);
    double C3 =  cos(theta3);

    double wlr =  1.0;
    double wli =  0.0;

    //T wl2r = (T) 1.0;
    //T wl2i = (T) 0.0;

    double wl3r =  1.0;
    double wl3i =  0.0;

    double tau1r,tau1i,tau2r,tau2i;
    double ur,ui,vr,vi;

    for (int j = 0; j < p; j++) {
        int index1 = j+m;
        int index2 = index1+p;
        int index3 = j+p;

        tau1r = *(r+index1);
        tau1i = *(i+index1);

        tau2r = *(r+index2);
        tau2i = *(i+index2);

        ur = tau1r + tau2r;
        ui = tau1i + tau2i;

        vr = sgn* (tau2r - tau1r);
        vi = sgn* (tau2i - tau1i);

        *(r+index2) = *(r+index3) - vi;
        *(i+index2) = *(i+index3) + vr;

        *(r+index1) = *(r+j) - ur;
        *(i+index1) = *(i+j) - ui;

        *(r+index3) = *(r+index3) + vi;
        *(i+index3) = *(i+index3) - vr;

        *(r+j) = *(r+j) + ur;
        *(i+j) = *(i+j) + ui;

    }

    split_radix_rec(r.begin(),i.begin(),sgn,m);
    split_radix_rec(r.begin()+m,i.begin()+m,sgn,p);
    split_radix_rec(r.begin()+m+p,i.begin()+m+p,sgn,p);
}

}

int main() {
vector<double> u,v;
for (int i = 0; i < 256; i++) {
    u.push_back(i);
    v.push_back(i);
}

int sgn = 1;
int N = 256;
split_radix_rec(u.begin(),v.begin(),sgn,N);
return 0;
} 
```

这是我得到的错误

```
main.cpp:93:21: error: 'std::vector<double>::iterator' has no member named 'begin' 
```

6 第 93、94、95 行出现相同错误（从 split_radix_rec 函数中调用的三个 split_radix_rec() 函数）。这是更大代码的一部分，因此我希望它适用于 STL 向量。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T21:18:32.843

如错误所述，您正在`begin()`调用`std::vector<double>::iterator`.

您应该在 a`std::vector<double>`上调​​用它，以便它可以返回您 a `std::vector<double>::iterator`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T21:17:06.370

`r`,`i`本身就是代码中的迭代器（开始）。

尝试：

```
split_radix_rec(r,i,sgn,m);
split_radix_rec(r+m,i+m,sgn,p);
split_radix_rec(r+m+p,i+m+p,sgn,p); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T21:16:51.300

有太多代码无法为您提供简洁的答案，但错误清楚地表明您正在调用`begin()`向量*迭代器*而不是*向量*。这发生在`split_radix_rec`递归调用中。您可能本来打算这样做：

```
split_radix_rec(r,i,sgn,m);
split_radix_rec(r+m,i+m,sgn,p);
split_radix_rec(r+m+p,i+m+p,sgn,p); 
```

# java - Rails 应用程序，但所有数据层都使用基于 json/xml 的 Web 服务

> ID：14176465
> 
> 赞同：3
> 
> 时间：2013-01-05T21:14:04.620
> 
> 标签：java, ruby-on-rails, ruby, json, jersey

我有一个用 Java/Jersey 编写的 Web 服务层，它提供 JSON。

对于应用程序的前端，我想使用 Rails。

我应该如何构建我的模型？

我应该做这样的事情吗？

```
response = api_client.get_user(123)

User user = User.new(response) 
```

将 JSON 映射到 Ruby 对象的最佳方法是什么？

我有什么选择？由于这是一个关键部分，我想知道我的选择，因为性能是一个因素。这与将 JSON 映射到 Ruby 对象并从 Ruby 对象 => JSON 一样，是应用程序中常见的情况。

我还能使用验证吗？或者因为我会在前端和服务层重复验证，所以这没有意义吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T12:07:13.027

Rails 中的模型不必做数据库操作，它们只是普通的类。通常，当您从 ActiveRecord::Base 子类化它们时，它们会充满 ActiveRecord 的魔力。

您可以使用诸如[Virtus](https://github.com/solnic/virtus)之类的 gem来为您提供具有属性的模型。对于验证，您可以使用[Vanguard](https://github.com/mbj/vanguard)。如果您想要一些接近`ActiveRecord`但没有数据库的东西并且正在运行 Rails 3+，您还可以将其包含`ActiveModel`到您的模型中以获取属性和验证，并让它们在表单中工作。有关详细信息，请参阅[Yehuda Katz 的帖子](http://yehudakatz.com/2010/01/10/activemodel-make-any-ruby-object-feel-like-activerecord/)。

在您的情况下，这将取决于您将使用的数据。例如，如果所有数据源都具有相同的基本格式，您可以创建自己的基类来保留您希望在各个类之间共享的所有逻辑（继承）。

如果您有几种不同类型的数据进入，您可以创建模块来封装不同类型的行为，并将您需要的模型包含在适当的类（组合）中。

通常，尽管您可能希望在远程 API 中为每个资源提供一个类，该类与您拥有的任何域逻辑进行一对一的映射。您可以通过多种不同的方式来实现这一点，但遵循 ActiveRecord 使用的方法命名可能是一个好主意，因为您在构建类结构时学习了 ActiveRecord，并且如果您的 API 看起来和工作起来像 ActiveRecords，它将帮助其他 Rails 开发人员。

根据您希望能够对对象执行的操作来考虑它（这就是 TDD 的用武之地）。您希望能够获取集合`Model.all`、特定元素`Model.find(identifier)`、将更改的元素推送到远程服务`updated_model.save`等等。

这些方法内部的实际逻辑将取决于远程服务。但是您可能希望每个模型类都保存一个指向其资源端点的 url，并且您肯定希望将逻辑保留在模型中。所以而不是：

```
response = api_client.get_user(123)

User user = User.new(response) 
```

你会去做的

```
class User
  ...
  def find id
    @api_client.get_user(id)
  end
  ...
end

User.find(123) 
```

或者更有可能

```
class ApiClient
  ...
  protected

  def self.uri resource_uri
    @uri = resource_uri
  end

  def get id
    # basically whatever code you envisioned for api_client.get_user
  end
  ...
end

class User < ApiClient
  uri 'http://path.to.remote/resource.json'
  ...
  def find id
    get(id)
  end
  ...
end

User.find(123) 
```

基本原则：将所有共享逻辑收集在一个类（ApiClient）中。基于每个资源（用户）的子类。将所有逻辑保留在您的模型中，系统的任何其他部分都不必知道它是数据库支持的应用程序还是您使用的是外部 REST API。最重要的是，如果您可以将集成逻辑完全保留在基类中。这样，如果外部数据源发生变化，您只有一个地方可以更新。

至于另一种方式，Rails 有几个很好的方法可以将对象转换为 JSON。从 to_json 方法到使用诸如 RABL 之类的 gem 来获得 JSON 对象的实际视图。

您可以使用部分 ActiveRecord 模块获得验证。从 Rails 4 开始，这是一个名为 ActiveModel 的模块，但您可以在 Rails 3 中完成它，并且有几个在线教程，尤其是[RailsCast](http://railscasts.com/episodes/121-non-active-record-model)。

性能不会是问题，除非您在调用远程服务时可能会遇到问题，如果网络很慢，您会遇到。其中一些可能有助于缓存（有关详细信息，请参阅[我的另一个答案](https://stackoverflow.com/questions/13822614/what-is-the-right-way-to-clear-cache-in-rails-without-sweepers)），但这也取决于您使用的数据。

希望这能让你走上正确的轨道。如果你想更深入地了解如何设计这些结构，你应该选择一本关于这个主题的书，例如[Practical Object-Oriented Design in Ruby: An Agile Primer](https://rads.stackoverflow.com/amzn/click/com/0321721330) by Sandi Metz。

# hadoop - 用于 Hadoop 监控的 Ganglia 或 X-trace

> ID：14176466
> 
> 赞同：0
> 
> 时间：2013-01-05T21:14:08.427
> 
> 标签：hadoop, monitoring, ganglia

我试图捕获hadoop任务（mapper和reducer）的磁盘I/O和网络I/O，即即时带宽、累积流量、源地址和目标地址。我发现了两种流行的 Hadoop 监控工具：Ganglia（通常与 Nagios 结合使用）和 X-Trace。Ganglia 于 2004 年由 UC Berkeley 提出，而 X-Trace 也是 UC Berkeley 于 2007 年开发的。

任何关于这两种工具的优缺点的建议都值得赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T18:37:09.040

我将从 ganglia 或 munin 开始——它们会告诉你集群中不同机器上的资源利用率。

X-trace 是一个相当学术的项目，它生成有关分布式事务、延迟和瓶颈以及分布式系统中的控制流的数据。不幸的是，目前它并没有得到很好的支持。

# c# - 将 FileSavePicker 与 MessageDialog 的 IUICommand 事件一起使用

> ID：14176469
> 
> 赞同：3
> 
> 时间：2013-01-05T21:14:24.663
> 
> 标签：c#, .net, xaml, windows-8, microsoft-metro

单独来看，所有代码都能完美运行。用于保存文件的片段，用于选择目录以将其保存到的片段以及消息对话框都很好用。

但是当我将它们捆绑在一起时，我的访问被拒绝了。我没有使用 DocumentsLibrary 功能，因为在这种情况下我不需要这样做，但是，在遇到问题后启用此功能确认它不是问题。

场景：用户想在文本框中输入文本后创建一个新文档。A`MessageDialog`出现，询问他们是否要先保存对现有文件的更改 - 用户单击是（保存文件）。

现在，您可以在此处处理由`MessageDialog`.

在 IUICommand 命令事件处理程序中，您可以测试单击了哪个按钮，并采取相应措施。

我用 switch 语句做到了这一点：

```
switch(command.Label) {
   case "Yes":
   SaveFile(); // extension method containing save file code that works on its own
   break;
   case "No":
   ClearDocument();
   break;
   default:
   break;
} 
```

现在，除了是按钮之外，每个案例都很好用。当您单击是时，将调用一个 e 张力方法，该方法具有保存到文件的代码

当您单击“是”按钮时，您会收到 ACCESS DENIED 异常。异常的细节没有透露任何东西。

我认为这与我使用`MesaageDialog`. 但是在搜索了几个小时之后，我还没有找到一个关于如何在按下按钮`FileSavePicker`时保存文件的示例。`MesaageDialog`

关于如何做到这一点的任何想法？

# 更新代码

当用户单击 AppBar 上的新建文档按钮时，会触发此方法：

```
async private void New_Click(object sender, RoutedEventArgs e)
{
    if (NoteHasChanged)
    {
        // Prompt to save changed before closing the file and creating a new one.
        if (!HasEverBeenSaved)
        {

            MessageDialog dialog = new MessageDialog("Do you want to save this file before creating a new one?",
                "Confirmation");
            dialog.Commands.Add(new UICommand("Yes", new UICommandInvokedHandler(this.CommandInvokedHandler)));
            dialog.Commands.Add(new UICommand("No", new UICommandInvokedHandler(this.CommandInvokedHandler)));
            dialog.Commands.Add(new UICommand("Cancel", new UICommandInvokedHandler(this.CommandInvokedHandler)));

            dialog.DefaultCommandIndex = 0;
            dialog.CancelCommandIndex = 2;

            // Show it.
            await dialog.ShowAsync();
        }
        else { }
    }
    else
    {
        // Discard changes and create a new file.
        RESET();
    }
} 
```

还有 FileSavePicker 的东西：

```
private void CommandInvokedHandler(IUICommand command)
{
    // Display message showing the label of the command that was invoked
    switch (command.Label)
    {
        case "Yes":

            MainPage rootPage = this;
            if (rootPage.EnsureUnsnapped())
            {
                // Yes was chosen. Save the file.
                SaveNewFileAs();
            }
            break;
        case "No":
            RESET(); // Done.
            break;
        default:
            // Not sure what to do, here.
            break;
    }
}

async public void SaveNewFileAs()
{
    try
    {
        FileSavePicker saver = new FileSavePicker();
        saver.SuggestedStartLocation = PickerLocationId.Desktop;
        saver.CommitButtonText = "Save";
        saver.DefaultFileExtension = ".txt";
        saver.FileTypeChoices.Add("Plain Text", new List<String>() { ".txt" });

        saver.SuggestedFileName = noteTitle.Text;

        StorageFile file = await saver.PickSaveFileAsync();
        thisFile = file;

        if (file != null)
        {
            CachedFileManager.DeferUpdates(thisFile);

            await FileIO.WriteTextAsync(thisFile, theNote.Text);

            FileUpdateStatus fus = await CachedFileManager.CompleteUpdatesAsync(thisFile);
            //if (fus == FileUpdateStatus.Complete)
            //    value = true;
            //else
            //    value = false;

        }
        else
        {
            // Operation cancelled.
        }

    }
    catch (Exception exception)
    {
        Debug.WriteLine(exception.InnerException);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-05T19:39:22.803

在这个问题上有什么进展吗？我目前有同样的问题。我还发现，如果事件`MessageDialog`中显示一秒钟，也会出现同样的问题`IUICommand`。

我的解决方案是取消第一个操作（显示第一个消息对话框）。这是我正在使用的一些代码（它可以在全局对象中访问）：

```
 private IAsyncInfo mActiveDialogOperation = null;
    private object mOperationMutex = new object();

    private void ClearActiveOperation(IAsyncInfo operation)
    {
        lock (mOperationMutex)
        {
            if (mActiveDialogOperation == operation)
                mActiveDialogOperation = null;
        }
    }

    private void SetActiveOperation(IAsyncInfo operation)
    {
        lock (mOperationMutex)
        {
            if (mActiveDialogOperation != null)
            {
                mActiveDialogOperation.Cancel();
            }

            mActiveDialogOperation = operation;
        }
    }

    public void StopActiveOperations()
    {
        SetActiveOperation(null);
    }

    public async void ShowDialog(MessageDialog dialog)
    {
        StopActiveOperations();

        try
        {
            IAsyncOperation<IUICommand> newOperation = dialog.ShowAsync();
            SetActiveOperation(newOperation);
            await newOperation;
            ClearActiveOperation(newOperation);
        }
        catch (System.Threading.Tasks.TaskCanceledException e)
        {
            System.Diagnostics.Debug.WriteLine(e.Message);
        }
    } 
```

因此，每次我想显示一个 MessageDialog 时，我都会调用 ShowDialog。如果有的话，这将取消当前对话框（然后发生 TaskCanceledException）。

在我将使用 FileSavePicker 的情况下，我会在调用 PickSaveFileAsync 之前调用 StopActiveOperations。

这行得通，但我不能说我喜欢它。感觉就像我做错了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-08T08:04:35.540

好的，现在我已经弄清楚了:-)。该文档明确表示您不应在 UICommand 中显示新的弹出窗口/文件选择器：

[http://msdn.microsoft.com/en-US/library/windows/apps/windows.ui.popups.messagedialog.showasync](http://msdn.microsoft.com/en-US/library/windows/apps/windows.ui.popups.messagedialog.showasync)

这是一个**不好**的方法的例子：

```
 private async void Button_Click(object sender, RoutedEventArgs e)
    {
        MessageDialog dialog = new MessageDialog("Press ok to show new dialog (the application will crash).");
        dialog.Commands.Add(new UICommand("OK", new UICommandInvokedHandler(OnDialogOkTest1)));
        dialog.Commands.Add(new UICommand("Cancel"));

        await dialog.ShowAsync();
    }

    private async void OnDialogOkTest1(IUICommand command)
    {
        MessageDialog secondDialog = new MessageDialog("This is the second dialog");
        secondDialog.Commands.Add(new UICommand("OK"));

        await secondDialog.ShowAsync();
    } 
```

这是正确的方法：

```
 private async void Button_Click_1(object sender, RoutedEventArgs e)
    {
        MessageDialog dialog = new MessageDialog("Press ok to show new dialog");
        UICommand okCommand = new UICommand("OK");
        UICommand cancelCommand = new UICommand("Cancel");

        dialog.Commands.Add(okCommand);
        dialog.Commands.Add(cancelCommand);

        IUICommand response = await dialog.ShowAsync();

        if( response == okCommand )
        {
            MessageDialog secondDialog = new MessageDialog("This is the second dialog");
            secondDialog.Commands.Add(new UICommand("OK"));

            await secondDialog.ShowAsync();
        }
    } 
```

其实很简单，我应该早点得到这个......

# javascript - 使用 cors 从 aws s3 加载的画布元素和图像在第一次加载时不起作用

> ID：14176470
> 
> 赞同：15
> 
> 时间：2013-01-05T21:14:45.633
> 
> 标签：javascript, canvas, cors

所以我在我的 AWS S3 存储桶上设置了 cors：

```
<CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
  <CORSRule>
    <AllowedOrigin>*</AllowedOrigin>
    <AllowedMethod>GET</AllowedMethod>
  </CORSRule>
</CORSConfiguration> 
```

在我的 html

```
<div id="explain_canvas"></div> 
```

在我的 javascript 中，我正在加载图像并将其放入画布图像中。

```
var outlineImage = new Image();
outlineImage.crossOrigin = '';
outlineImage.src = drawing_image;
outlineImage.onload = function() {
  var canvasDiv = document.getElementById('explain_canvas');
  var canvas = document.createElement('canvas');
  canvas.setAttribute('width', 722);
  canvas.setAttribute('height', 170);
  canvas.setAttribute('id', 'canvas_'+canvas_element);
  canvas.setAttribute('name', 'canvas_'+canvas_element);
  canvasDiv.appendChild(canvas);
  if(typeof G_vmlCanvasManager != 'undefined') {
    canvas = G_vmlCanvasManager.initElement(canvas);
  }
  var context = canvas.getContext("2d");
  context.drawImage(outlineImage, 10, 10, 600, 150);
} 
```

我正在加载这样的上下文以与 Internet Explorer 兼容。

这是我的问题。当页面加载前两次时，会出现以下错误：

```
Cross-origin image load denied by Cross-Origin Resource Sharing policy. 
```

但是，当我重新加载页面几次时，它最终会工作并加载图像。完成后，我就可以在 canvas 元素上成功调用 toDataURL() 了。

有谁知道为什么会这样？我犯错了吗？这是 AWS 的问题，我只需要等待亚马逊修复 cors 吗？

它发生在我测试过的所有浏览器中。在 Chrome、Firefox、Safari、IE 中。在我的 Mac、PC 和 iPhone 上。所以我认为它与浏览器无关。此外，它发生在本地和生产中。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-09T04:50:01.177

显然浏览器没有在请求标头中发送原始标头。而 aws 要求发送原点。我不确定为什么会这样。即使使用简单的 HTTP 请求，也应该发送原始标头。唉，事实并非如此。

这就是没有发送原始头[的](https://stackoverflow.com/questions/14228839/all-of-my-browsers-are-not-sending-the-origin-header)原因。

# macos - 如何在 OS X 上重启 nginx

> ID：14176477
> 
> 赞同：61
> 
> 时间：2013-01-05T21:15:29.747
> 
> 标签：macos, nginx, restart

我`nginx`在 OS X 10.8 上使用。新安装`nginx`但找不到重启 nginx 的方法，除了`kill nginx_pid`说`kill 64116`. 想知道有没有更好的重启方法`nginx`。

在 Google 和 SO 上找到了一些方法，但没有奏效：

```
nginx -s restart

sudo fuser -k 80/tcp ; sudo /etc/init.d/nginx restart 
```

的错误消息`nginx -s restart`是

```
nginx: [error] open() "/usr/local/var/run/nginx.pid" failed (2: No such file or directory) 
```

有时也会收到此错误消息：

```
nginx: invalid option: "-s restart" 
```

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2014-01-30T10:45:06.550

`sudo nginx`在启动 nginx 之前尝试运行。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-06-25T21:02:47.747

要重新加载配置文件：

```
sudo nginx -s reload 
```

完全重启`nginx`：

```
sudo nginx -s quit
sudo nginx 
```

* * *

**细节**

nginx没有`restart`信号。从文档中，这里是主进程接受的信号：

```
SIGINT, SIGTERM  Shut down quickly.
SIGHUP           Reload configuration, start the new worker process with a new configuration, and gracefully shut down old worker processes.
SIGQUIT          Shut down gracefully.
SIGUSR1          Reopen log files.
SIGUSR2          Upgrade the nginx executable on the fly.
SIGWINCH         Shut down worker processes gracefully. 
```

大概您可以手动将这些信号发送到进程 ID，但该命令具有为您发送信号到主进程`nginx`的标志。`nginx -s <signal>`您的选择是：

```
stop    SIGTERM
quit    SIGQUIT
reopen  SIGUSR1
reload  SIGHUP 
```

无需手动使用 pid。

* * *

*编辑：*刚刚意识到大部分信息已经在其他答案的评论中。无论如何都要在这里总结一下情况。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2013-01-05T23:11:24.027

What is your nginx pid file location? This is specified in the configuration file, default paths specified compile-time in the config script. You can search for it as such:

`find / -name nginx.pid 2>/dev/null` (must issue while nginx is running)

Solution:

```
sudo mkdir -p /usr/local/var/run/
ln -s /current/path/to/pid/file /usr/local/var/run/nginx.pid 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2019-10-17T09:59:02.580

```
$ sudo nginx -c /usr/local/etc/nginx/nginx.conf
$ sudo nginx -s reload 
```

来源链接：[https ://blog.csdn.net/github_33644920/article/details/51733436](https://blog.csdn.net/github_33644920/article/details/51733436)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-07-02T18:36:45.697

尝试这个：

`sudo nginx -s stop`

其次是：

`sudo nginx`

似乎 nginx 会跟踪它的状态，如果你停止它两次，它会抱怨。但以上对我有用。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-10-28T08:33:42.583

我这样做：

先杀进度

```
ps aux | grep nginx
kill -9 {pid} 
```

然后启动nginx

```
nginx 
```

有用！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-08-14T15:18:32.290

作为未来的资源，可以参考[http://wiki.nginx.org/CommandLine](http://wiki.nginx.org/CommandLine)

`Nginx`可能以 root 身份运行，因此您需要运行以下命令的变体来影响它。

```
sudo nginx -s stop | reload | quit | reopen 
```

通常没有太多理由`Nginx`像`Apache`需要的那样重新启动。如果您修改了配置文件，您可能只想重新加载选项。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-02-01T14:07:45.600

检查此目录是否存在：

```
/usr/local/var/run 
```

当 nginx 尝试在不存在的本地化中初始化 pid 文件时，可能会发生此错误。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-03-19T17:39:37.667

要重新加载自定义配置文件，请使用

```
nginx -s reload -c /etc/nginx/conf.d/<config file>.conf 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-02-27T15:47:12.720

这里有一个错误。根据您修改/重新启动 apache 和/或修改 nginx 配置时 nginx 是否正在运行，这个文件（本质上只是一个进程 ID 指针）可能会被破坏。

当您尝试向 nginx 发送任何信号时

```
nginx -s quit;
nginx -s stop;
nginx -s reload; 
```

nginx 使用这个文件来引用它需要向其发送信号的进程的 ID。如果文件不存在，则 nginx 的活动运行进程和 cli 应用程序之间的链接实际上被破坏了。

实际上，我最终处于两个 nginx 进程同时运行的状态，因此两个进程都被杀死了。

要解决此问题，您可以通过活动监视器强制终止现有的 nginx 进程（然后运行 ​​nginx 并让 cli 应用程序创建一个新的 nginx.pid 文件），或者如果您确实需要保持 nginx 运行但想要运行 nginx - s reload - 在 /run 路径中手动创建一个名为 nginx.pid 的文件，并插入当前正在运行的 nginx 进程的 PID（通过 Activity Monitor 获得）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-10-19T02:04:23.750

这可能只是意味着 nginx 已经停止 - 目前没有运行。
首先确认nginx是否在运行，执行：

```
$ ps aux | grep nginx 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-06-26T05:18:14.177

我得到了相同的错误链接，我尝试了很多方法来修复它，但在我运行命令行之后它不起作用，它运行良好：nginx -c /usr/local/etc/nginx/nginx.conf

我从这里得到的信息 [https://blog.csdn.net/wn1245343496/article/details/77974756](https://blog.csdn.net/wn1245343496/article/details/77974756)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-08-26T19:04:29.180

停止或重新加载的一种方法是通过以下命令，

对于停止：

```
sudo /usr/local/nginx/sbin/nginx -s stop 
```

仅当 nginx 正在运行时才运行 reload：

```
sudo /usr/local/nginx/sbin/nginx -s reload 
```

通过像上面那样做，你不会得到 nginx: [error] open() "/usr/local/var/run/nginx.pid" 这个问题

# xcode - 使用 Facebook 已弃用标头的错误消息

> ID：14176478
> 
> 赞同：2
> 
> 时间：2013-01-05T21:15:32.453
> 
> 标签：xcode, facebook, memory-management, automatic-ref-counting

我在 Xcode 4.5 中有一个集成了 Facebook 的应用程序。我正在使用 ARC。该应用程序使用本机对话框，因此不推荐使用标头（即 Facebook.h）。显然，在关闭/清理活动会话时这样做会导致以下错误：

“类 FBSessionManualTokenCachingStrategy 的实例 0xa089350 已被释放，而键值观察者仍向其注册。观察信息被泄露，甚至可能被错误地附加到其他对象。”

在研究了这个错误后，我认为问题是当我在应用程序委托中初始化 self.Facebook 的实例时，Facebook 添加了两个观察者而不是一个，然后在注销期间只清理了一个。我已多次尝试删除这两个实例，包括此页面上有关此错误的所有解决方案：[facebook ios sdk log：奇怪的消息](https://stackoverflow.com/questions/11924245/facebook-ios-sdk-log-strange-message)

这些解决方案都没有对我有用，包括我看到的一个解决方案涉及我在使用 ARC 时无法使用的释放。这是我打开和关闭会话的代码以供参考：

```
- (void)sessionStateChanged:(FBSession *)session
                  state:(FBSessionState) state
                  error:(NSError *)error
{
switch (state) {
    case FBSessionStateOpen:
        if (!error) {
            // We have a valid session

            // Initiate a Facebook instance

            self.facebook = [[Facebook alloc]
                             initWithAppId:FBSession.activeSession.appID
                             andDelegate:nil];

            // Store the Facebook session information
             self.facebook.accessToken = FBSession.activeSession.accessToken;
            self.facebook.expirationDate = FBSession.activeSession.expirationDate;

        }
        break;
    case FBSessionStateClosed:
    case FBSessionStateClosedLoginFailed:
        [FBSession.activeSession closeAndClearTokenInformation];
        // Clear out the Facebook instance
        self.facebook = nil;
        break;
    default:
        break;
}

[[NSNotificationCenter defaultCenter]
 postNotificationName:FBSessionStateChangedNotification
 object:session];

 if (error) {
    UIAlertView *alertView = [[UIAlertView alloc]
                              initWithTitle:@"Error"
                              message:error.localizedDescription
                              delegate:nil
                              cancelButtonTitle:@"OK"
                              otherButtonTitles:nil];
    [alertView show];
 }
}

/*
 * Opens a Facebook session and optionally shows the login UX.
 */

- (BOOL)openSessionWithAllowLoginUI:(BOOL)allowLoginUI //do I need this method?
{
NSArray *permissions = [[NSArray alloc] initWithObjects:
                        @"user_about_me",
                        @"read_friendlists",
                        @"read_stream",
                        @"friends_likes",
                        @"user_likes",
                        @"friends_photos",
                        @"user_photos",
                        nil];

return [FBSession openActiveSessionWithReadPermissions:permissions
                                          allowLoginUI:allowLoginUI
                                     completionHandler:^(FBSession *session,    
                                                    FBSessionState state,
                                                         NSError *error) {
                                         [self sessionStateChanged:session state:state
                                                             error:error]; }];
}

/*
 * If we have a valid session at the time of openURL call, we handle
* Facebook transitions by passing the url argument to handleOpenURL
*/

- (BOOL)application:(UIApplication *)application
        openURL:(NSURL *)url
sourceApplication:(NSString *)sourceApplication
     annotation:(id)annotation {
// attempt to extract a token from the url
return [FBSession.activeSession handleOpenURL:url];
}

- (void) closeSession {
[FBSession.activeSession closeAndClearTokenInformation];
} 
```

如果有人可以就如何解决这个问题提供任何指导，我将不胜感激。

# php - Html5 联系表 - javascript 和 php 验证问题

> ID：14176479
> 
> 赞同：2
> 
> 时间：2013-01-05T21:15:32.170
> 
> 标签：php, javascript, html

在我开始之前，请除了我的道歉，如果这太长了，我对 Html5 完全陌生（通常在 Flash 中设计）并且刚刚开始。我最近下载了一个名为 Brownie 的免费模板，除了联系表格外，我了解了大部分内容。我认为它使用的是 Javascript、PHP 和 Ajax。我已经让它在本地工作了，但事情并没有按照我想要的方式工作。我要做的是让它验证带有错误消息或成功消息等的字段，这是我拥有的 html 表单代码：

```
<p class="required_info"><span>*</span> Required</p>
<!-- SUCCESS MESSAGE -->
<div class="success_box none"> Email successfully sent. Thank you! </div>
<!-- END SUCCESS MESSAGE -->

<!-- START CONTACT FORM -->
<form action="#" class="contact_form">
  <p>
    <label for="name">Name <span>*</span></label>
    <input type="text" class="inputText" id="name" name="name" placeholder="Please enter your full name" pattern="[a-zA-Z ]+"  onkeypress="return alpha(event,letters)" required minlength="5" maxlength="50" onpaste="return false;" tabindex="1"/>
    <div class="success_title none"> You've entered your name. </div>
    <div class="error_title none">* Please enter your full name. </div>
    </p>
  <div class="clear"></div>
  <p>
    <label for="company">Company </label>
    <input type="text" class="inputText" id="company" name="company" placeholder="Company Name" minlength="3" maxlength="50" onpaste="return false;" tabindex="2"/>
  </p>
  <div class="clear"></div>
  <p>
    <label for="email">E-mail <span>*</span></label>
    <input type="text" class="inputText"  id="email" name="email" placeholder="Please enter a valid email address" required minlength="5" maxlength="50" onpaste="return false;" tabindex="3"/>
  <div class="error_title none">* Please enter a valid email. </div>
  </p>

  <div class="clear"></div>
  <p>
    <label for="message">Message <span>*</span></label>
    <textarea class="inputTextarea" cols="88" rows="6" id="message" name="message" placeholder="Please enter your message" required tabindex="4"></textarea>
    <div class="error_title none">* Please enter your message. </div>
  </p>
  <div class="clear padding20"></div>
  <p class="submit"><input type="reset" class="resetBtn button white" onclick="resetFields()" value="Reset" /> <a href="javascript:void(0);" class="button white" onclick="$('.contact_form').submit();">Send</a> </p>
</form>
<!-- END CONTACT FORM --> 

<!-- ERROR MESSAGE -->
<div class="error_box none"> Please complete all required fields [ highlighted in red ]. </div>
<!-- END ERROR MESSAGE --> 
```

这是javascript代码：

```
$(document).ready(function () {

    $('#name').focus(function () {
        $(this).removeClass('error_class');
    });

    $('#email').focus(function () {
        $(this).removeClass('error_class');
    });

    $('#message').focus(function () {
        $(this).removeClass('error_class');
    });

    $('.contact_form').submit(function () {

        hasError = false;

        if ($('#name').val() == '') {
            $('#name').addClass('error_class');
            hasError = true;
        }

        var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;

        var emailaddressVal = $('#email').val();
        if (emailaddressVal == '') {
            $('#email').addClass('error_class');
            hasError = true;
        }
        else if (!emailReg.test(emailaddressVal)) {
            $('#email').addClass('error_class');
            hasError = true;
        }

        if ($('#email').val() == '') {
            $('#email').addClass('error_class');
            hasError = true;
        }

        if ($('#message').val() == '') {
            $('#message').addClass('error_class');
            hasError = true;
        }

        if (hasError == true) {
            $('.info_box').hide();
            $('.error_box').show();
            $('.error_title').show();
        }
        else {
            $.ajax({
                type: 'POST',
                url: 'contact.php',
                cache: false,
                data: $(".contact_form").serialize(),
                success: function (data) {
                    if (data == "error") {
                        $('.success_box').hide();
                        $('.success_title').hide();
                        $('.error_box').show();
                        $('.error_title').show();
                    }
                    else {
                        $('.error_box').hide();
                        $('.error_title').hide();
                        $('.success_box').show();
                        $('.success_title').hide();
                        $('.resetBtn').hide();
                        $('.submit').hide();
                    }
                }
            });
        }

        return false;
    });
}); 
```

这是PHP代码：

```
<?php

$your_email = 'name@domain.com'; // Your email address
$subject = 'Email from your contact form'; // Email subject

$name = isset($_POST['name']) && $_POST['name'] ? $_POST['name'] : ''; // Visitor Name
$company = isset($_POST['company']) && $_POST['company'] ? $_POST['company'] : ''; // Visitor Company
$email = isset($_POST['email']) && $_POST['email'] ? $_POST['email'] : ''; // Visitor Email
$message = isset($_POST['message']) && $_POST['message'] ? $_POST['message'] : ''; // Visitor Message
$website = isset($_POST['website']) && $_POST['website'] ? $_POST['website'] : ''; // Visitor Message

$full_message = 'Website: '.$website. "\r\n\r\n Message:".$message;

if($name && $email && $message)
{
    $headers = 'From: '.$name.' <'.$email.'>' . "\r\n" .
    'Reply-To: '.$email.'' . "\r\n" .
    'X-Mailer: PHP/' . phpversion();
    $headers .= 'Content-type: text/plain; charset=UTF-8' . "\r\n";

    //------------------------------------------------
    // Send out email to site admin
    //------------------------------------------------
    if(@mail($your_email, $subject, $full_message, $headers))
        die("success");
    else
        die("error");
}
else
{
    die("error");
}

?> 
```

当按下发送按钮时，我希望它检查是否在每个输入字段中输入了任何数据 - 如果是，则添加成功消息，如果没有添加错误消息。我的错误消息有效，但无法在单个输入字段上获得成功消息。任何建议都会有所帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:24:30.563

我怀疑这是因为您将 true 或 false 分配给每个变量，而不是 php 脚本中变量的值。isset($_POST[test]) 为真，不是测试表单值的值。

# php - 以php形式进行分页

> ID：14176480
> 
> 赞同：0
> 
> 时间：2013-01-05T21:15:40.623
> 
> 标签：php, javascript, ajax, jquery

我有这个代码：

```

`<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style>
body {
background-image: url(../images/paper_03.png);
}
form {
background-image: url(../images/paper_02.png);
}
</style>
</head>
<?php

require("../function.php");
// echo sizeof($_SESSION['liste']);

?>
<body >
<form name="log"  method="post"  style="position: absolute; top:50px; left: 320px; width: 600px; height: 100%;" >

                        <table BORDER=2 style="position: relative; top:15px; left: 3px;" >
                        <TR> 
                         <TH style="width:100px"><font color="blue">Date</font></TH> 
                         <TH style="width:400px"><font color="blue">Location</font></TH> 
                          <TH style="width:400px"><font color="blue">Job Title</font></TH> 
                         <TH style="width:300px"><font color="blue">Company</font></TH> 
                        </TR>
                        <?php
                        session_start();
                        for($i=0;$i<sizeof($_SESSION['liste']);$i++){
                        ?>
                        <TR>
                        <td ><center><label><?php echo $_SESSION['liste'][$i]['date']; ?></label></center></td> 
                         <td ><label><?php echo $_SESSION['liste'][$i]['region'].','.$_SESSION['liste'][$i]['city'].','.$_SESSION['liste'][$i]['state']; ?></label></td> 
                         <td ><center><label><?php echo $_SESSION['liste'][$i]['title']; ?></label></center></td> 
                         <td ><center><label><?php echo $_SESSION['liste'][$i]['comapany_name']; ?></label></center></td> 
                        </TR>
                        <?php
                        }
                        ?>
                        </table>

</form>

</body>
</html>` 

我有一个表单，我希望每 10 个结果一起显示，即用两个图标（下一个，上一个）将分页添加到我的表单中。

*   我可以只用 php 做到这一点吗？
*   我需要在这项工作中使用 ajax 吗？

            回答 #1

赞同：1

时间：2013-01-05T21:49:39.223

1.  将 $liststart 值作为参数传递给您的代码（使用 $liststart = $_REQUEST['liststart'] 获取它）。
2.  然后调整你的循环，从 $liststart 循环到 $liststart+10。
3.  制作一个 onClick 按钮，使用新的 $liststart 值转到上面的代码。例如对于第一页上的“下一步”按钮，使用 echo "' onClick='location.href=\"yourcodeabove.php?liststart=".$liststart+10."\";'>";  

或者，如果您愿意，您也可以不使用 javascript，将 next 和 prev 按钮设为自己的表单。像这样：

```
<FORM METHOD="LINK" ACTION="yourcodeabove.php?liststart="<?php $liststart+10 ?>">
<INPUT TYPE="submit" VALUE="next->">
</FORM> 
```

首先关闭您的其他表单（看起来它实际上不需要是一个表单......也可以是一个*div*）。表单通常具有“操作”并使用按钮提交，但由于您将有 2 个按钮（下一个和上一个），每个按钮都可以是它们自己的表单，使用 javascript onClick 或 form 方法。

            回答 #2

赞同：0

时间：2013-01-05T21:45:27.873

如果你使用 mysql 这应该可以工作：

```
$page = $_GET['page'];
$query = mysql_query("SELECT * FROM some_table LIMIT $page, 10"); 
```

并使用 $query 变量做一些工作，您的链接应该是这样的：

```
<a href="/somefile.php?page=<?= $current_page + 1;?>">Next</a> 
```

```

# java - 使用具有不同 charset-iso-8859-2 的 mx 格式的套接字读取行

> ID：14176487
> 
> 赞同：0
> 
> 时间：2013-01-05T21:16:10.030
> 
> 标签：java, email, character-encoding

我正在尝试使用 Java 中的套接字编写简单的应用程序，以逐行读取邮件服务器中的标头。问题是有时邮件主题有不同的字符集（iso-8859-2），我无法正确显示一些特殊字符。使用 System.out.println("ńł") 时显示特殊字符的正确方法是什么？我知道我必须使用“String s.get bytes”，但无论哪种方式都行不通。是否有可能正确显示特殊字符。也许我做错了什么（我是 java 新手），但是在花了将近一周的时间检查不同的代码之后，我已经厌倦了。这是来自示例测试应用程序的简单代码（非原始代码）：

```
String s = "=?ISO-8859-2?Q?Zesp=F3=B3_Gmaila?=";
byte[] bytes = s.getBytes(Charset.forName("ISO-8859-2"));
String foo = new String(bytes, Charset.forName("UTF-8"));
System.out.println(foo);
//System.out.println(Charset.defaultCharset().name()); 
```

输出：=?ISO-8859-2?Q?Zesp=F3=B3_Gmaila?=

来自 MX 的示例答案：

主题：=?ISO-8859-2?Q?Gmail_jest_inny=2E_Oto=2C_co_musisz_o_nim_wiedzie=E6=2E?=

先感谢您

亚当

我无法在新评论中列出完整列表，所以这里有 Esailija 帮助的所有内容：

```
package javaapplication7;

import java.util.regex.Matcher;
import java.util.regex.Pattern;
import org.apache.commons.codec.DecoderException;
import org.apache.commons.codec.net.QuotedPrintableCodec;

public class JavaApplication7 {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args)  {

    String s = "=?ISO-8859-2?Q?Zesp=F3=B3_Gmaila?=";
    Pattern p = Pattern.compile("=\\?([a-zA-Z0-9\\-]+)\\?Q\\?"); 
    Matcher m = p.matcher(s);
    if( m.find() ) {
    String encoding = m.group(1);
    String target = s.replaceAll(p.toString(),"");
    QuotedPrintableCodec qpc = new QuotedPrintableCodec(encoding);
    try {
         System.out.println(qpc.decode(target));
         } catch (DecoderException e) {
        e.printStackTrace();
     }
}
    }
} 
```

和错误：

```
run:
org.apache.commons.codec.DecoderException: Invalid quoted-printable encoding
    at      org.apache.commons.codec.net.QuotedPrintableCodec.decodeQuotedPrintable(QuotedPrintableCodec.java:189)
at org.apache.commons.codec.net.QuotedPrintableCodec.decode(QuotedPrintableCodec.java:230)
at org.apache.commons.codec.net.QuotedPrintableCodec.decode(QuotedPrintableCodec.java:279)
at org.apache.commons.codec.net.QuotedPrintableCodec.decode(QuotedPrintableCodec.java:300)
at javaapplication7.JavaApplication7.main(JavaApplication7.java:32) 
```

构建成功（总时间：1 秒）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T12:41:58.737

`QuotedPrintableCodec`从[Apache Commons Codec](http://commons.apache.org/codec/download_codec.cgi)使用：

```
String s = "=?ISO-8859-2?Q?Zesp=F3=B3_Gmaila";
Pattern p = Pattern.compile("=\\?([a-zA-Z0-9\\-]+)\\?Q\\?"); //For detecting the encoding
Matcher m = p.matcher(s);
if( m.find() ) {
    String encoding = m.group(1);
    String target = s.replaceAll( p.toString(), ""); //Remove the encoding header
    QuotedPrintableCodec qpc = new QuotedPrintableCodec(encoding);
    try {
        System.out.println(qpc.decode(target));
        // prints "Zespół_Gmaila"
    } catch (DecoderException e) {
        e.printStackTrace();
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-25T10:06:33.237

您可能对波兰语字符有疑问。我得到了简单的答案。

```
String s = "=?ISO-8859-2?Q?Zesp=F3=B3_Gmaila?=";
String test=MimeUtility.decodeText(s);

System.out.println(test); 
```

println 是,,Zespół Gmaila''。您需要的图书馆是：

```
import javax.mail.internet.MimeUtility; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T21:20:24.730

您可以查看 James Server（Java 中的邮件服务器）的源代码，您可能会找到答案：

*   [http://svn.apache.org/viewvc/james/server/trunk/](http://svn.apache.org/viewvc/james/server/trunk/)
*   [http://james.apache.org/server/](http://james.apache.org/server/)

和 Mime4J

*   [http://james.apache.org/mime4j/](http://james.apache.org/mime4j/)

# php - MYSQL 查询：未定义的偏移量：2

> ID：14176489
> 
> 赞同：0
> 
> 时间：2013-01-05T21:16:28.997
> 
> 标签：php

```
$tsvhandle = fopen($tsvfile, 'r'); 
while (($data = fgetcsv($tsvhandle, 1000, ";")) !== FALSE) {
    $result = mysql_query("SELECT `post_id` FROM `charvest_postmeta` WHERE `meta_key` = '_sku' AND `meta_value` = '".$data[2]."'") or die($result."<br/><br/>".mysql_error());
    while($row = mysql_fetch_array($result)){
        echo $row['post_id']. "</br>";

    }
} 
```

我收到“ PHP Notice: Undefined offset: 2”，但我不明白问题出在哪里。请帮我解决这个问题。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:19:58.877

`$data`只是在某些迭代中没有第 3 列（索引为 2）。

您可以在循环中检查：`if (!isset($data[2])) { ...`

# python - 用户创建表单 Django

> ID：14176497
> 
> 赞同：2
> 
> 时间：2013-01-05T21:17:27.220
> 
> 标签：python, django

我正在尝试创建一个注册表单，但我注意到当我`{{ form.as_p }}`使用 UserCreationForm 进行渲染时，所有可能的字段都会显示给用户。现在有些字段，我只希望管理员可以访问。

所以，我知道你可以通过指定 Meta Class 中的字段`fields=(f1,f2...)`

但是恶意用户是否仍然能够手动提交带有“秘密”字段的 POST 请求，即使它们在技术上并未显示在表单中？

我知道如何解决这个问题的唯一方法是手动验证每个字段并自己构建模型对象，以确保用户不会触及这些“秘密”字段。怎么样，这似乎违背了使用 UserCreationForm 的目的。有没有更好的方法呢？

作为参考，当我的意思是破坏 UserCreationField 的目的时，我将无法`user = super(UserCreationForm,self).save(commit=True)`安全使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T22:58:40.580

如果表单不知道该字段存在（即，它不在`fields`其元类的列表中），那么它将不会在提交的数据中为其查找值。因此，您可以完全安全地保存表单中的数据。

例如，假设我们有以下模型：

```
from django.db import models

class Person(models.Model):
    name = models.CharField(max_length=100)
    age = models.PositiveIntegerField(blank=True, null=True)
    hobbies = models.CharField(max_length=200, blank=True, null=True) 
```

然后我们可以写一个`LimitedCreateForm`只得到名字和爱好而不设置年龄的。出于测试目的，我们可以在视图中使用此表单，该视图将提交的数据和相应的创建人员转储回浏览器以进行调试：

```
from django.shortcuts import render
from django import forms

from testapp.models import Person

class LimitedCreateForm(forms.ModelForm):
    class Meta:
        model = Person
        fields = ('name', 'hobbies')

def create_limited(request):
    submitted = ""
    new_user = None

    if request.method == 'POST':
        submitted = str(request.POST)
        form = LimitedCreateForm(request.POST)
        if form.is_valid():
            new_user = form.save()

    else:
        form = LimitedCreateForm()

    data = {
        'form': form,
        'submitted': submitted,
        'new_user': new_user,
    }

    return render(request, 'create_limited.html', data) 
```

测试的最后一步是创建一个显示调试数据的模板（来自表单的 POST 数据和创建的相应人员），并创建一个带有年龄字段的“恶意”表单：

```
<html>

<body>

<h1>
Submitted data:
</h1>

<p>
{{ submitted|default:"Nothing submitted" }}
</p>

<h1>
Created user
</h1>

<p>
Name: {{ new_user.name|default:"Nothing" }}
<br />
Age: {{ new_user.age|default:"Nothing" }}
<br />
Hobbies: {{ new_user.hobbies|default:"Nothing" }}
</p>

<h1>
Form
</h1>

<form method="post">
    {% csrf_token %}
    Name: <input type="text" name="name" id="id_name">
    <br />
    Age: <input type="text" name="age" id="id_age">
    <br />
    Hobbies: <input type="text" name="hobbies" id="id_hobbies">
    <br />
    <input type="submit" value="Create" />
</form>

</body>

</html> 
```

如果我们然后运行它并提交一些值，我们会得到以下调试输出：

**提交数据：**

```
<QueryDict: 
{u'age': [u'27'], 
u'csrfmiddlewaretoken': [u'ed576dd024e98b4c1f99d29c64052c15'], 
u'name': [u'Bruce'], 
u'hobbies': [u'Dancing through fields of flowers']}>` 
```

**创建用户**

```
Name: Bruce 
Age: Nothing 
Hobbies: Dancing through fields of flowers 
```

这表明表单忽略了提交的 27 岁，只保存了它被告知的字段。

值得注意的是，如果您指定要排除的字段列表（即，`exclude = ('age',)`而不是`fields = ('name', 'hobbies')`在表单元类中），情况也是如此。

# colors - 使用 C++ 更改 Xlib 窗口背景颜色

> ID：14176499
> 
> 赞同：3
> 
> 时间：2013-01-05T21:17:29.813
> 
> 标签：colors, background, window, x11, xlib

这是Linux。我创建了一个窗口，我想将其背景颜色更改为绿色。这就是我的代码的样子：

```
Window xwin = XCreateSimpleWindow(dis, 
                                  DefaultRootWindow(dis), 
                                  0, 0, 
                                  500, 300, 
                                  0,
                                  WhitePixel(dis, 0),
                                  WhitePixel(dis, 0));
GC gc = XCreateGC(dis, xwin, 0, NULL);
XColor color;
Colormap colormap;
char green[] = "#00FF00";

colormap = DefaultColormap(dis, 0);
XParseColor(dis, colormap, green, &color);
XAllocColor(dis, colormap, &color);

XSetBackground(dis, gc, color.pixel);

XMapWindow(dis, xwin);
XFlush(dis); 
```

我看到的窗户是白色的。是否可以使用 X11 在 Linux 中更改窗口背景颜色？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T12:31:06.123

如果您只想要绿色背景，则 XCreateSimpleWindow 的最后一个参数是背景颜色，所以...

```
 XColor color;
  Colormap colormap;
  char green[] = "#00FF00";

  colormap = DefaultColormap(dis, 0);
  XParseColor(dis, colormap, green, &color);
  XAllocColor(dis, colormap, &color);

  Window xwin = XCreateSimpleWindow(dis, 
                   DefaultRootWindow(dis), 
                   0, 0, 
                   500, 300, 
                   0,
                   WhitePixel(dis, 0),
                   color.pixel);

XMapWindow(dis, xwin);
XFlush(dis); 
```

# unity3d - 检查对象是否完全通过另一个对象Unity3d

> ID：14176500
> 
> 赞同：3
> 
> 时间：2013-01-05T21:17:33.053
> 
> 标签：unity3d, unityscript

我正在进行一场游戏，其中角色穿越不同的走廊和走廊以达到他们的目标。当玩家穿过走廊时，我希望墙壁在玩家“通过”时消失。这可能听起来令人困惑，所以我提供了一张我想要发生的事情的图片：

![图表](../Images/01d0319220d1da459403653112a0d86e.png)

我已经有了使墙壁不可见的功能，但我不知道该怎么称呼它。我试过打电话给它

```
player.position.z > wall.position.z 
```

但这会导致每面墙在玩家经过一半时变得不可见（在它的变换处）；我想在玩家完全过去时调用它。有什么方法可以检查玩家是否完全通过了 z 轴上的墙网格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T00:36:34.610

玩家能否沿着走廊返回？如果是这样，这是检查摄像头是否背对有问题的墙壁的一种简单方法。

```
// Please cache the variables; I'm using properties for simplicity's sake.

float maxViewAngle = Camera.main.fieldOfView / 2f + 20;  // +20 for some padding

Vector3 difference = Camera.main.transform.position - wall.transform.position;

float angleDifference = Vector3.Angle( Camera.main.transform.forward, difference );

if ( angleDifference > maxViewAngle )
{
  wall.HideThyself();  // Or whatever
} 
```

您发布的解决方案 ，`player.position.z > wall.renderer.bounds.max.z`将仅在一个轴的一个方向上起作用。如果您的关卡是一维的并且只向前移动，那么这很好！

编辑：我应该提到，如果你的墙是静态的（不可变的并且在检查器中标记为“静态”），那么如果你有 Unity Pro，你可以更容易地使用[遮挡剔除（统一文档） 。](http://docs.unity3d.com/Documentation/Manual/OcclusionCulling.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T21:55:05.747

解决了！发现渲染器有一个“max”属性。我刚用过：

```
player.position.z > wall.renderer.bounds.max.z 
```

# linux - 如何解析 svn diff 结果？

> ID：14176503
> 
> 赞同：1
> 
> 时间：2013-01-05T21:18:24.997
> 
> 标签：linux, shell, unix, sed, grep

`svn diff`与标志一起使用会`--summarize`返回如下所示的内容。我们如何将其传递给 sed 或 grep 以执行以下操作：

1.  删除所有以“D”开头的行（已删除的文件）
2.  之后删除“M”、“A”或“MM”（或任何其他情况）的前缀以及选项卡。
3.  删除仅保留文件名/文件夹的 URL 路径。
4.  存储在文件中

例子：

```
D   https://localhost/example/test1.php
D   https://localhost/example/test2.php
M   https://localhost/example/test3.php
M   https://localhost/example/test4.php
A   https://localhost/example/test5.php
M   https://localhost/example/test6.php
A   https://localhost/example/test7.php
M   https://localhost/example/test8.php
M   https://localhost/example/test9.php
M   https://localhost/example/test10.php
A   https://localhost/example/test11.php
M   https://localhost/example/test12.php
M   https://localhost/example/test13.php
MM  https://localhost/example/test.php
M   https://localhost/test0.php 
```

然后会变成：

```
/example/test3.php
/example/test4.php
/example/test5.php
/example/test6.php
/example/test7.php
/example/test8.php
/example/test9.php
/example/test10.php
/example/test11.php
/example/test12.php
/example/test13.php
/example/test.php
/test0.php 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:21:42.813

像这样`sed`：

```
$ svn diff --summarize | sed -e '/^D/d' -e 's/.*host//'
/example/test3.php
/example/test4.php
/example/test5.php
/example/test6.php
/example/test7.php
/example/test8.php
/example/test9.php
/example/test10.php
/example/test11.php
/example/test12.php
/example/test13.php
/example/test.php
/test0.php

# Redirect output to file
$ svn diff --summarize | sed -e '/^D/d' -e 's/.*host//' > file 
```

您需要通过[管道](http://www.linux-tutorial.info/modules.php?name=MContent&pageid=21) `|`输出`svn`to `sed`。第一部分`'/^D/d'`删除所有以开头的行`D`，第二部分将所有`s/.*host//`内容替换为`host`空，以存储到文件中使用[redirect](http://www.linux-tutorial.info/modules.php?name=MContent&pageid=21) `> file`。

与 类似的逻辑`grep`：

```
$ svn diff --summarize | grep '^[^D]' file | grep -Po '(?<=host).*' > file 
```

第一个`grep`过滤掉以 开头的行，`D`第二个使用[正向前瞻](http://www.regular-expressions.info/lookaround.html)with`-Po`仅显示 之后的行的一部分`host`。

# yaml-cpp - 尝试构建库时出现 yaml-cpp 编译器错误

> ID：14176511
> 
> 赞同：2
> 
> 时间：2013-01-05T21:19:41.337
> 
> 标签：yaml-cpp

我正在尝试使用 Visual Studio Express 2012（使用 Cmake 生成的项目文件）编译[yaml-cpp](http://code.google.com/p/yaml-cpp/) 0.5，但我从 impl.h 中收到了一些错误：

```
error C2734: 'lhs' : const object must be initialized if not extern
error C2027: use of undefined type 'YAML::convert<T>'
error C3861: 'decode': identifier not found
error C3861: 'encode': identifier not found 
```

所有错误都来自模板函数`node_data::equals`和`node_data::convert_to_node`

请注意，这些错误来自`run-tests`项目文件；我实际上能够构建 lib 文件，但不能使用该库，因为它需要这些功能才能工作。

有任何想法吗？

编辑：使用 VS 2010 编译时，我也会遇到同样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:59:46.400

我刚刚报告了一个问题并为此提供了修复程序。

请检查[http://code.google.com/p/yaml-cpp/issues/detail?id=182](http://code.google.com/p/yaml-cpp/issues/detail?id=182)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T21:49:29.850

在 VS 2010 中，字符串属于类型`const char[]`，这会导致此编译错误。对我来说，快速解决方法是将其放入`char*`

```
YAML::Node config = YAML::LoadFile("Config.cfg");
int value = 0;
if (config[(char*)"value"])
    config[(char*)"value"].as<int>(); 
```

看起来不太好，但在图书馆修复之前可以使用。

# jquery - 将类添加到 jQuery $.post 的结果

> ID：14176512
> 
> 赞同：0
> 
> 时间：2013-01-05T21:19:41.373
> 
> 标签：jquery

我无法让 jQuery 向我从 $.post 返回的结果的 dom 添加一个类。

为什么这不起作用？

```
 $.post(url, data, function (result) {
        $(result).addClass('.update');
        $this.closest('.inline').replaceWith(result);
    }); 
```

替换工作正常，但它没有 .update 类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:22:00.030

```
$.post(url, data, function (result) {
    var withClass = $(result).addClass('.update');
    $this.closest('.inline').replaceWith(withClass);
}); 
```

那应该行得通。您正在创建一个新对象，同时执行 $(result)，然后您什么也不做。我已经在我的代码中更改了它。

# c++ - Qt 类命名约定

> ID：14176514
> 
> 赞同：1
> 
> 时间：2013-01-05T21:20:01.203
> 
> 标签：c++, qt

> **可能重复：**
> [我的课程名称在 Qt 中应该以“Q”开头吗？](https://stackoverflow.com/questions/2921915/should-the-name-of-my-classes-begin-with-q-in-qt)

这与询问小部件的变量命名约定的[问题类似。](https://stackoverflow.com/questions/401851/naming-convention-for-qt-widgets)我的问题必须处理扩展 qt 类。

是否习惯/建议在我自己的小部件类（或任何从 Qt 类扩展的类）前加上 Q，或者我应该避免这种情况？我从其他库中看到了一些添加 Q 的类（例如 QwtPlot 和 qextserialport），但我不知道它是否被普遍推荐。

我想这是一种简单的方法来判断哪些类打算与 Qt 框架一起使用，但是可能会与未来的 Qt 版本发生名称冲突，尤其是与更常见的通用小部件类型。这可以通过使用名称空间在一定程度上避免，但我个人从来都不太喜欢名称冲突，即使名称空间提供了清晰的描述。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:38:07.097

这是他们子类 QThread 的文档中的一个示例：

```
class MyThread : public QThread
{
 public:
      void run();
}; 
```

从这里：[http ://doc.qt.digia.com/qt/qthread.html](http://doc.qt.digia.com/qt/qthread.html)

他们没有命名 QMyThread 之类的东西，它会在 Qt 类和您的类之间造成混淆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:55:19.587

您应该避免使用“Q”作为前缀。“Q”是为作为 Qt 开发环境的一部分的类保留的，如果您避免使用“Q”，则可以确保您不会意外创建与 Qt 环境类冲突的类名。

最好选择自己的 1-2 个字母前缀（**不**以“Q”开头）并坚持下去。

（PS：其他几个编程环境也是如此。出于同样的原因，不鼓励 IBM AS/400 上的程序员使用“Q”——OS/400 使用“Q”作为其前缀。）

# ios - 是否可以在 AUGraph 中播放两个或更多 FilePlayer 音频单元？

> ID：14176516
> 
> 赞同：0
> 
> 时间：2013-01-05T21:20:10.167
> 
> 标签：ios, core-audio

针对 iOS，我想同时播放两个 .caf 音频文件。

我创建了一个简单的 AUGraph，它包含两个“生成器”音频单元（子类型 kAudioUnitSubType_AudioFilePlayer），连接到连接到远程 IO（输出范围）的多通道混音器 AU。

只需将一个 filePlayer AU 连接到混音器，我就可以成功播放其中一个文件。要播放这两个文件，我只需创建另一个 filePlayer AU 实例，并以与第一个 filePlayer 相同的方式对其进行配置。

我正在打开音频文件，然后使用`kAudioUnitProperty_ScheduledFileIDs`属性和`kAudioUnitProperty_ScheduledFileRegion`属性将它们传递到生成器单元中。

我一直在检查所有 AU 调用的错误，并且没有返回错误。当我开始绘制图表时，我什么也得不到，只有沉默。

这是按下“播放”后我的图表的快照：

```
AudioUnitGraph 0xF7DA000:
  Member Nodes:
    node 1: 'auou' 'rioc' 'appl', instance 0xf18e3e0 O I
    node 2: 'aumx' 'mcmx' 'appl', instance 0x9d72f50 O I
    node 3: 'augn' 'afpl' 'appl', instance 0x9db6ee0 O I
    node 4: 'augn' 'afpl' 'appl', instance 0x9db6fd0 O I
  Connections:
    node   3 bus   0 => node   2 bus   1  [ 1 ch,  44100 Hz, 'lpcm' (0x00000029) 32-bit little-endian float, deinterleaved]
    node   4 bus   0 => node   2 bus   2  [ 1 ch,  44100 Hz, 'lpcm' (0x00000029) 32-bit little-endian float, deinterleaved]
    node   2 bus   0 => node   1 bus   0  [ 2 ch,  44100 Hz, 'lpcm' (0x00000C2C) 8.24-bit little-endian signed integer, deinterleaved]
  CurrentState:
    mLastUpdateError=0, eventsToProcess=F, isRunning=T (3) 
```

使用我缺少的多个 filePlayer 音频单元是否有细微差别？我试图以这种方式做的事情可能吗？或者我是否需要创建音频缓冲区并将其手动提供给 filePlayer 单元？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T23:58:16.470

您所拥有的应该可以工作，但是可能会出现一些问题：

1.  *您是否将每条*总线上的音量参数设置为 > 0以及输出？（`kMultiChannelMixerParam_Volume`在输入和输出范围内）。这就是我认为的问题所在，因为我相信混音器的所有音量都从 0 开始。

2.  `kAudioUnitProperty_ElementCount`您是否通过在输入范围上设置属性将输入总线计数设置为 2 或更多？（注意：由于您使用的是元素 1 和 2，因此您需要将元素计数设置为 3，或者改用元素 0 和 1）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-20T13:06:33.033

不确定你是否解决过这个问题。

看起来好像您在将混音器连接到 remoteIO 之前将文件播放器连接到混音器。

始终“向后”连接您的图表，即从 remoteIO 开始，然后通过链返回到您的生成器。我认为由于 AUGraphs 中使用的拉取架构，连接转发不起作用

# google-drive-api - 如何使用 C# 将文件上传到 Google 驱动器中的特定文件夹

> ID：14176517
> 
> 赞同：2
> 
> 时间：2013-01-05T21:20:18.193
> 
> 标签：google-drive-api

我有一个文件夹 ID 和一个应该上传到该 gDrive 文件夹的文件。我尝试了以下方法：

```
File body = new File();
body.Title = titulo; // titulo is a string that contains the tittle of the file
body.Description = descripcion; // the description, it is a string as well
body.MimeType = setMimetype(rutaArchivo); // and this is a method that sets the mimetype according to the file extension.` 
```

我尝试使用`body.Parents`但我没有运气，`body.parents.add`只收到一个字符串（我试图提供包含 gdrive 文件夹 id 的字符串），而且我不太了解`parents.Insert`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T01:07:50.037

您应该添加一个父引用（您非常接近）：

```
body.Parents = new List<ParentReference>()
      {new ParentReference() {Id = parentId}}; 
```

`parentId`父级的字符串文件 ID在哪里。

# php - 将记录从 Access 复制到 SQL

> ID：14176521
> 
> 赞同：0
> 
> 时间：2013-01-05T21:21:34.943
> 
> 标签：php, sql, ms-access, odbc

是否有更快的方法将记录从 Access 数据库复制到 SQL 数据库？

目前我一次检索一条记录并将其插入到 SQL 中，但这需要很长时间。我知道有“SELECT INTO tbl_name”，但据我所知，这仅在查询位于“发送”数据库（在本例中为 Access db）中时才有用。

我目前的代码是：

```
if (isset($_POST['odbc_connect'])){
$odbc_conn = $_POST['odbc_connect'];
}else{
exit ($noODBC);
}
$conn=odbc_connect($odbc_conn,'','') or die ($errorODBC);
$shell = new COM("WScript.Shell");
$odbcServer = $shell->RegRead("HKEY_LOCAL_MACHINE\\SOFTWARE\\ODBC\\ODBC.INI\\JuniorDSN\\DBQ");

$sql="SELECT * FROM [Cost Centre Hierarchy]";
$rs=odbc_exec($conn,$sql); 

// Connect to your database
mysql_select_db($database_budgetstatementconnection, $budgetstatementconnection);

// Delete contents of table
$sql = "TRUNCATE TABLE tblcostcentrehierarchy";
mysql_query($sql) or die ( mysql_error() );

while (odbc_fetch_row($rs))
{
// Retrieve the record from Junior
$strCostCentre = odbc_result($rs,1);
$strCCDescription = odbc_result($rs,2);
$enabled = odbc_result($rs,3);
$path = odbc_result($rs,4);
$level1 = odbc_result($rs,5);
$level2 = odbc_result($rs,6);
$level3 = odbc_result($rs,7);
$level4 = odbc_result($rs,8);
$level5 = odbc_result($rs,9);
$level6 = odbc_result($rs,10);
$level7 = odbc_result($rs,11);
$level8 = odbc_result($rs,12);

// Parse the data
$strCCDescription = str_replace("'","\'",$strCCDescription);
$strCCDescription = str_replace('"',"",$strCCDescription);
$level1 = str_replace("'","\'",$level1);
$level1 = str_replace('"',"",$level1);
$level2 = str_replace("'","\'",$level2);
$level2 = str_replace('"',"",$level2);
$level3 = str_replace("'","\'",$level3);
$level3 = str_replace('"',"",$level3);
$level4 = str_replace("'","\'",$level4);
$level4 = str_replace('"',"",$level4);
$level5 = str_replace("'","\'",$level5);
$level5 = str_replace('"',"",$level5);
$level6 = str_replace("'","\'",$level6);
$level6 = str_replace('"',"",$level6);
$level7 = str_replace("'","\'",$level7);
$level7 = str_replace('"',"",$level7);
$level8 = str_replace("'","\'",$level8);
$level8 = str_replace('"',"",$level8);
$level8 = trim(preg_replace('/\n\r|\r\n/', "", $level8 ));

 // Save the record to the database
 $sql = "insert into `budgetstatements`.`tblcostcentrehierarchy` (`CostCentreCode`, `CostCentreDescription`, `Enabled`, `Path`, `Level1`, `Level2`, `Level3`, `Level4`, `Level5`, `Level6`, `Level7`, `Level8`) values ('".$strCostCentre."', '".$strCCDescription."', '".$enabled."', '".$path."', '".$level1."', '".$level2."', '".$level3."', '".$level4."', '".$level5."', '".$level6."', '".$level7."', '".$level8."')";

// Execute the sql
mysql_query($sql);

}

//Close the connections
odbc_close($conn);
mysql_close($budgetstatementconnection); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:31:30.390

该语句`SELECT INTO tbl_name`用于创建一个新表，因为您的表已经存在于 SQL 数据库中，您可以链接到它；阅读有关[如何使用链接表向导链接 Access 项目中的表的](http://office.microsoft.com/en-gb/access-help/link-tables-in-an-access-project-by-using-the-link-table-wizard-adp-HP003089371.aspx)页面。

将 SQL 数据库中的表链接到 Access 数据库后，您可以针对 Access 数据库发出 SQL 语句，它将把链接的表视为存在于同一数据库中：

```
INSERT INTO [tblcostcentrehierarchy] -- linked table name
SELECT * FROM [Cost Centre Hierarchy] -- local Access table 
```

假设您的字段名称相同。如果字段名称不同或顺序不同，则需要在`INSERT`and`SELECT`语句中指定它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:25:29.940

假设您需要手动执行此操作，您可以查看[Access to MySQL](http://www.bullzip.com/products/a2m/info.php)。

# string - 类型安全的 printf

> ID：14176524
> 
> 赞同：13
> 
> 时间：2013-01-05T21:21:52.483
> 
> 标签：string, haskell, types

标准库提供了一个`printf`可以实现可变的函数。然而，它没有做的是编译时检查参数类型是否与格式字符串匹配。这将需要依赖类型，而且听起来也很难实现！（您必须使用类型签名来解析整个格式字符串……哎呀！）

但仔细想想，现在我想知道......我们可以用 Template Haskell 做到这一点吗？事实上，有没有人为此编写了一个库？

（看起来你可以很容易地编写一个准引用器来读取 printf 格式规范并生成必要的 N-arg 函数......）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-05T21:33:36.747

是的，这是可能的。是的，已经完成了。你真的应该检查这类问题的hackage：http: [//hackage.haskell.org/package/Printf-TH](http://hackage.haskell.org/package/Printf-TH)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-05T22:41:41.920

如果您愿意接受“格式字符串”不是真正的字符串，那么您也可以直接在 Haskell 中实现类似 printf 的函数。

例如，这已在 Ralf Hinze 的一篇名为“ [Formatting: a class act](http://www.cs.ox.ac.uk/ralf.hinze/publications/Format.ps.gz) ”的论文中进行了描述。在 Hackage 上，我只能找到实现类似于这种方法的[xformat包。](http://hackage.haskell.org/package/xformat)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T21:44:16.380

除此之外`Printf-TH`，似乎也`printf-mauke`有一些 TH 作为事后的想法......还有其他例子吗？

# objective-c - NSDictionary 计算所有孩子

> ID：14176527
> 
> 赞同：2
> 
> 时间：2013-01-05T21:22:33.553
> 
> 标签：objective-c, cocoa

我有以下**NSDictionary**结构：

```
// level
0    1    2    3

// elements
a1 - b1 - c1 - d111.1
             - d111.2
             - d111.3
          c2 - d112.1
             - d112.2
          c3 - d113.1 
```

考虑到数据文件将包含 2000-5000 个元素。什么是**只**计算第 3 级（a1=0）上的孩子的快速方法？需要明确的是：我**不想**包括在计数中：a1，b1，c1-c3，只有 d*。

这是你可以用 NSPredicate 做的事情吗？

还是老式（但昂贵）的 for 循环方法（eeks）？

```
// pseudo-code
count=0
for (a in root)
 for (b in a)
   for (c in b)
     for (d in c)
       count++ 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T23:07:13.797

正如@Hot 所说：

```
int count = 0;
   for (NSArray *a in root)
      for (NSArray *b in a)
         for (NSArray *c in b)
            count += c.count; 
```

仅仅通过关卡直到最后一个级别，然后只使用计数，实际上并没有太多开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-23T20:31:48.460

使用类别的解决方案。

```
@implementation NSDictionary (RecursiveCount)
- (NSUInteger)recursiveCount {
    return self.allValues.recursiveCount;
}
@end

@implementation NSArray (RecursiveCount)
- (NSUInteger)recursiveCount {
    int count = 0;
    for (id object in self) {
        if ([object isKindOfClass:[NSDictionary class]] || [object isKindOfClass:[NSArray class]]) {
            count += [object recursiveCount];
        } else {
            ++count;
        }
    }
    return count;
}
@end 
```

* * *

```
- (void)testRecursiveCount {
    NSDictionary *dict = @{
                           @"key1" : @[@1, @2, @3],
                           @"key2" : @{@"blah" : @[@[], @1, @[@1, @2]]},
                           @"key3" : @4,
                           @"key5" : @[@{@"blah":@[@{@1:@1}]}],
                           };
    XCTAssertEqual(dict.recursiveCount, 8, @"dictionary");

    NSArray *array = @[
                       @[@1, @2, @3],
                       @{@"blah" : @[@[], @1, @[@1, @2]]},
                       @4,
                       @[@{@"blah":@[@{@1:@1}]}],
                       ];
    XCTAssertEqual(array.recursiveCount, 8, @"dictionary");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T04:44:10.097

一种方法是使用递归。这种方法不是最便宜的，但它确实具有灵活性的优势——如果结构的深度发生变化或者在编译时是未知的。

在伪代码中：

```
integer count ( collection , maxDepth )
    return recursiveCount ( collection , 0 , maxDepth )
end

integer recursiveCount ( collection , currentDepth , maxDepth )
    integer count = 0
    if collection is array
        count += recursiveCountArray ( collection , currentDepth , maxDepth )
    else if object is dictionary
        count += recursiveCountDictionary ( collection.values , currentDepth , maxDepth )
    else
        count += 1
    return count
end

integer recursiveCountArray ( array , currentDepth , maxDepth )
    integer count = 0
    if currentDepth < maxDepth
        for ( object in array )
            count += recursiveCount( object )
    else
        count += array.count
    return count
end 
```

该`maxDepth`参数确保不会完成不必要的工作（只需在 maxDepth 时返回数组的计数，而不是像@RamyAlZuhouri 在他的评论中建议的那样在每次迭代中迭代数组并增加计数）。

在 Objective-C 中，这可以通过 C 函数来实现：

```
static NSUInteger _PFXRecursiveCount(id collection, NSUInteger currentDepth, NSUInteger maxDepth);
static NSUInteger _PFXRecursiveCountArray(id array, NSUInteger currentDepth, NSUInteger maxDepth);

NSUInteger PFXRecursiveCount(id collection, NSUInteger maxDepth)
{
    return _PFXRecursiveCount(collection, 0, maxDepth);
}

NSUInteger _PFXRecursiveCount(id collection, NSUInteger currentDepth, NSUInteger maxDepth)
{
    NSUInteger count = 0;
    if ([collection isKindOfClass:[NSArray class]]) {
        count = _PFXRecursiveCountArray(collection, currentDepth, maxDepth);
    } else if ([collection isKindOfClass:[NSDictionary class]]) {
        NSDictionary *dictionary = (NSDictionary *)collection;
        count = _PFXRecursiveCountArray(dictionary.allValues, currentDepth, maxDepth);
    } else {
        count = 1;
    }
    return count;
}

NSUInteger _PFXRecursiveCountArray(NSArray *array, NSUInteger currentDepth, NSUInteger maxDepth)
{
    NSUInteger count = 0;
    if (currentDepth < maxDepth) {
        for (id object in array) {
            count += _PFXRecursiveCount(object, currentDepth + 1, maxDepth);
        }
    } else {
        count += array.count;
    }
    return count;
} 
```

这里`PFX`将替换为项目中使用的适当前缀。只会`PFXRecursiveCount`在标题中声明。

或者，这可以通过块来实现：

```
typedef NSUInteger (^RecursiveCountArrayBlock)(NSArray *, NSUInteger, NSUInteger);
typedef NSUInteger (^RecursiveCountBlock)(id, NSUInteger, NSUInteger);

__block __weak RecursiveCountArrayBlock _weakRecursiveCountArray = nil;
__block __weak RecursiveCountBlock _weakRecursiveCount = nil;

NSUInteger (^_recursiveCount)(id, NSUInteger, NSUInteger) = ^(id collection, NSUInteger currentDepth, NSUInteger maxDepth) {
    NSUInteger count = 0;
    if ([collection isKindOfClass:[NSArray class]]) {
        count = _weakRecursiveCountArray(collection, currentDepth, maxDepth);
    } else if ([collection isKindOfClass:[NSDictionary class]]) {
        NSDictionary *dictionary = (NSDictionary *)collection;
        count = _weakRecursiveCountArray(dictionary.allValues, currentDepth, maxDepth);
    } else {
        count = 1;
    }
    return count;
};
_weakRecursiveCount = _recursiveCount;

NSUInteger (^_recursiveCountArray)(id, NSUInteger, NSUInteger) = ^(NSArray *array, NSUInteger currentDepth, NSUInteger maxDepth) {
    NSUInteger count = 0;
    if (currentDepth < maxDepth) {
        for (id object in array) {
            count += _weakRecursiveCount(object, currentDepth + 1, maxDepth);
        }
    } else {
        count += array.count;
    }
    return count;
};
_weakRecursiveCountArray = _recursiveCountArray;

NSUInteger (^recursiveCount)(id, NSUInteger) = ^(id collection, NSUInteger maxDepth) {
    return _recursiveCount(collection, 0, maxDepth);
}; 
```

`__weak` `__block`变量 (`_weakRecursiveCountArray`和`_weakRecursiveCount`) 允许我们避免从自身内部对块的强引用。（*注意*：在 iOS 5 和 10.7 之前，`__weak`需要替换为`__unsafe_unretained`。） typedef 允许我们避免虚假警告（“'__weak' 仅适用于 Objective-c 对象或块指针类型；这里的类型是 'NSUInteger' （又名'无符号长'）”）。

# drupal-7 - 从 profile2 配置文件中删除字段集

> ID：14176529
> 
> 赞同：1
> 
> 时间：2013-01-05T21:22:40.013
> 
> 标签：drupal-7, fieldset, hook-form-alter

我一直在尝试从用户 profile2 配置文件中删除几个字段集（**Biblio Settings**和**URL Redirects**），这样它们就不会让不需要修改这些设置的用户感到困惑。我在搜索这个问题的答案时发现的所有内容都表明我应该能够取消设置 hook_form_alter() 中的字段集，但是当我访问用户配置文件时表单中没有字段集，这一定意味着它们是在之后插入的hook_form_alter() 被调用。

既然如此，我怎样才能实现我的目标？

谢谢！李

**1/9/13 编辑：**事实证明这个问题没有实际意义；如果我作为我在这里关注的非管理员用户之一登录，他们缺乏权限会阻止字段集出现，从而解决问题。（很明显，当我写原始帖子时，我没有意识到这一点！）但是，考虑到我的情况，我仍然很好奇如果字段集出现（就像他们为管理员用户所做的那样）如何删除字段集上面已经描述过了。

# c# - 如何找到 XML 的节点并将其删除

> ID：14176530
> 
> 赞同：0
> 
> 时间：2013-01-05T21:22:42.680
> 
> 标签：c#, asp.net, xml

我有一个这样的xml

```
<Order>
 <OrderSections>
      <OrderSection type="1" name="S 1" id="3">
         <ShippingAmount>15.02</ShippingAmount>
      </OrderSection>
      <OrderSection type="1" name="S 2" id="4">
         <ShippingAmount>0</ShippingAmount>
      </OrderSection>
 </OrderSections>
</Order> 
```

如何找到 id=4 的订单部分并将其从 XmlDocument 中删除？，我正在查看[这个示例](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/0e00125b-1198-482f-9b65-9bbfa167f995/)，但这是不同的，因为正在搜索的值属于类似的节点

```
<players>
<player> 
    <name>User2</name>
 </player>
</players> 
```

但我的 XML 在`<OrderSection>`属性值中有 id。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T21:31:03.647

您需要`@`用于属性：

```
XmlNode node = doc.SelectSingleNode("/Order/OrderSections/OrderSection[@id='4']");
node.ParentNode.RemoveChild(node); 
```

查看[XPath 语法](http://www.w3schools.com/xpath/xpath_syntax.asp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T21:31:39.423

使用 XmlDocument 类和 xpath 查找元素

```
string path = "orders.xml";
XmlDocument XMLDoc = new XmlDocument();
XMLDoc.Load(path);
foreach (XmlNode entry in XMLDoc.SelectNodes("//OrderSection[@id='4']"))
{
    entry.ParentNode.RemoveChild(entry);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T21:26:01.917

您可以使用 Linq to Xml：

```
var xdoc = XDocument.Load(path_to_xml);
xdoc.Descendants("OrderSection")
    .Where(os => (int)os.Attribute("id") == 3)
    .Remove();
xdoc.Save(path_to_xml); 
```

# objective-c - NSOperationQueue 异步下载网页

> ID：14176534
> 
> 赞同：1
> 
> 时间：2013-01-05T21:23:04.273
> 
> 标签：objective-c, xcode, cocoa, nsoperation, nsoperationqueue

我有一个程序，我目前在直线上下载 3 个不同的 URL，我想修改它，以便我可以异步下载网页，但我希望在程序进行之前完成所有 3 个网页下载。我在网上看过教程，但我仍然无法让 NSOperation 和 NSoperationqueue 工作。

这是我创建的 NSOperation 类

```
#import <Foundation/Foundation.h>

@interface LoadPage : NSOperation

@property (nonatomic, copy) NSURL *URL;
@property (nonatomic, copy) NSData *webpage;

- (id)initWithURL:(NSURL*)url;
- (void)main;

@end 
```

它只是为了下载网页而设计的

```
#import "LoadPage.h"
//Loadpage.m
@implementation LoadPage
@synthesize URL;
@synthesize webpage;

- (id)initWithURL:(NSURL*)url{
    [self setURL:url];
    return self;
}
//Download Webpage function
- (void)main {
    NSData *page = [NSData dataWithContentsOfURL:URL];
    [self setWebpage:page];
} 
```

我想下载 3 个单独的网页并同时完成所有这 3 个网页，并在它们全部完成后继续执行程序的其余部分。

```
@interface MasterParser : NSObject{
    NSOperationQueue *queue;
}

-(NSMutableArray *)loadPlayer:(NSString *)name;

@end

@implementation MasterParser
    -(NSMutableArray *)parsePage:(NSString *)name{
        NSURL *google = [NSURL URLWithString:@"http://www.Google.com"];
        NSURL *yahoo = [NSURL URLWithString:@"http://www.yahoo.com"];
        NSURL *mlbtraderumors = [NSURL URLWithString:@"http://www.mlbtraderumors.com"];

        LoadPage *gpage = [[LoadPage alloc] initWithURL:google];
        LoadPage *ypage = [[LoadPage alloc] initWithURL:yahoo];
        LoadPage *mpage = [[LoadPage alloc] initWithURL:mlbtraderumors];

        queue = [[NSOperationQueue alloc] init];
        [queue addOperation:gpage]; 
        [queue addOperation:ypage];
        [queue addOperation:mpage];

        [queue waitUnitilAllOperationsAreFinished];

        NSData *webpage = [gpage webpage];
    //...etc do all the operations and parsing with the webpages after all the downloads are done
} 
```

当我运行这个程序时，程序会冻结并且我得到一个错误的执行错误。我怀疑我需要在 loadpage.m 末尾使用一行

```
 [MasterParser performSelectorOnMainThread:@selector(parsePage:)
                                       withObject:nil
                                    waitUntilDone:YES]; 
```

任何帮助将不胜感激谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T03:36:28.163

与下载网页相比，解析本身应该不是什么大问题，所以如果你在主线程上执行它应该不会造成太大的延迟，但是如果你愿意的话，你可以在单独的线程上解析网页。我想指出的另一件事是，如果您要调用`[MasterParser performSelectorOnMainThread:@selector(parsePage:) withObject:nil waitUntilDone:YES];`，这将依次调用`+[MasterParser parsePage:nil]`主线程。相反，它应该是`self`（或任何对象调用该方法），所以`[self performSelectorOnMainThread:@selector(parsePage:) withObject:nil waitUntilDone:YES];`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T19:26:51.373

首先我要感谢所有帮助我回答这个问题的人。关键是添加行

```
self=[super init];
to the initWithURL method after that everything started working.

#import "LoadPage.h"

@implementation LoadPage
@synthesize URL;
@synthesize webpage;

- (id)initWithURL:(NSURL*)url{
    self = [super init];
    [self setURL:url];
    return self;
}
- (void)main {
    NSData *page = [NSData dataWithContentsOfURL:URL];
    [self setWebpage:page];
}

@end 
```

再次感谢所有帮助回答这个问题的人。

# javascript - 如何使用 ListView 和 InsertTamplate 或 EditTemplate 在 javascript 函数中获取 TextBox ClientID

> ID：14176536
> 
> 赞同：0
> 
> 时间：2013-01-05T21:23:21.230
> 
> 标签：javascript, asp.net

我有一个带有 ItemTemplate、EditTemplate 和 InsertTemplate 的 ListView。Edit 和 InsertTemplate 中有几个 TextBox。我需要计算 Javascript 中的一些值，但我不知道如何在我的 JS 函数中获取 ClientID 或将其作为参数传递。

Javascript函数：

```
<script type="text/javascript">
    function calculate() {
        var length = document.getElementById('???').value;
        var quantity = document.getElementById('???').value;
        var fullLength = document.getElementById('???');
        fullLength.value = length*quantity;
    }
</script> 
```

我的 ListView 的 ASP.NET 部分：

```
<InsertItemTemplate>
    <asp:TextBox ID="Weight" runat="server" Text='<%#Bind("Weight") %>' />
    <asp:TextBox ID="Quantity" runat="server" Text='<%#Bind("Quantity") %>' />
    <asp:TextBox ID="FullLength" runat="server" Text='<%#Bind("FullLength") %>' />
    <asp:Button runat="server" ID="Insert" Text="AddNewEntry" CommandName="Insert" OnClientClick="calculate()" />
</InsertItemTemplate> 
```

用什么来代替'???'？或者，我可以在 OnClientClick="calculate(???,???,???)" 的参数中以某种方式传递它吗？

在此先感谢，吉克拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T00:28:16.240

现在 asp.net 支持 ClientIDMode“可预测”，您可以通过在 EditItemTemplate 中为更新按钮添加 OnClientClick 处理程序来做到这一点。

*   将 ListView 的 ClientIDMode 设置为可预测。
*   将 ListView 的 ClientIDRowSuffix 设置为行的主键（例如，Northwind 的 Products 表的 ProductID）
*   将产品 ID 传递给 OnClientClick 处理程序
*   使用 document.getElementById 获取字段的当前值。

例如，假设您将 ListView1 绑定到 Northwind 的 Products 表。Products 的主键是 ProductID。ListView 的声明性语法是：

```
<asp:ListView ID="ListView1" runat="server" DataKeyNames="ProductID" 
        DataSourceID="SqlDataSource1" ClientIDMode="Predictable" 
        ClientIDRowSuffix="ProductID"> 
```

EditItemTemplate 的更新按钮的声明性语法是：

```
<asp:Button ID="UpdateButton" runat="server" CommandName="Update" 
                        Text="Update" OnClientClick=<%# string.Format("ShowProductName('{0}');", Eval("ProductID")) %> /> 
```

OnClientClick 处理程序 javascript 是：

```
 <script type="text/javascript">
    function ShowProductName(prodId) {
        var prodNameTextBox = document.getElementById('ListView1_ProductNameTextBox_' + prodId);

        alert('product name is ' + prodNameTextBox.value);

        return false;
    }
</script> 
```

注意：假设产品名称存储在名为 ProductNameTextBox 的文本框中。更改它以使文本框的名称与您想要的字段匹配。可预测模式将产生一个类似于 ListView1_YOURFIELDNAMEHERE_PRODUCTIDHERE 的 ID。

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/dd410598(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/dd410598(v=vs.100).aspx)

# asp.net - OledbConnection ExecuteScalar 返回旧值

> ID：14176548
> 
> 赞同：1
> 
> 时间：2013-01-05T21:24:47.457
> 
> 标签：asp.net, textbox, oledbconnection, executescalar

每当其中的值发生更改时，我都有一个下拉框，文本框应该通过在以下方法中执行选择查询来更新。但是发生的情况是查询总是返回下拉框中第一项的结果。当我调试程序时，文本的值始终是下拉框中第一项的值。

如果我使用 SELECT 郊区 FROM sites WHERE SiteName = '" + siteId.SelectedValue + "'" 然后我会在文本框中显示正确的值。当查询是从站点中选择地址时，我无法获得正确的值。

protected void siteId_SelectedIndexChanged(object sender, EventArgs e) { string connect = "Provider=Microsoft.Jet.OleDb.4.0;Data Source=|DataDirectory|db.mdb"; 使用 (System.Data.OleDb.OleDbConnection conn = new System.Data.OleDb.OleDbConnection(connect)) {

```
 conn.Open();
        string insertQuery= "SELECT SiteAddress FROM sites WHERE SiteName = '" + siteId.SelectedValue + "'";
        using (System.Data.OleDb.OleDbCommand cmd = new System.Data.OleDb.OleDbCommand(insertQuery, conn))
        {

             object text =cmd.ExecuteScalar();
             string final = text.ToString();

             TextBox1.Text = final;

            conn.Close();
            Dispose();            }
    }
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:32:49.813

我的猜测，转到填充列表的位置并添加`if(!Page.IsPostBack)`

```
if(!Page.IsPostBack)
{
    //bind items to dropdown list here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T22:46:27.170

在将更改的值（新值）添加到下拉列表之前，您需要清理下拉列表中的现有值（旧值）。

# kernel - 禁用 APC 时如何查询文件大小？

> ID：14176550
> 
> 赞同：3
> 
> 时间：2013-01-05T21:24:54.183
> 
> 标签：kernel, drivers, wdk, minifilter, windows-kernel

在我的微过滤器的 PostCreate 期间，我必须使用全局推送锁来设计同步线程，并且我必须调用 FltQueryInformationFile 来查询文件大小。

然而，

1、我调用FltAcquirePushLockExclusive后，APC投递被禁用；

2、如果禁用了 APC 传递，那么 FltQueryInformationFile 将失败，因为它必须在 PASSIVE_LEVEL 调用并启用 APC。

在这种情况下，我应该如何查询文件大小？建立 IRP 有帮助吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-19T08:37:43.790

您可以使用它来获取文件大小

```
NTSTATUS
GetFileSize (
    _In_ PFLT_INSTANCE Instance,
    _In_ PFILE_OBJECT FileObject,
    _Out_ PLONGLONG Size
    )
/*++

Routine Description:

    This routine obtains the size.

Arguments:

    Instance - Opaque filter pointer for the caller. This parameter is required and cannot be NULL.

    FileObject - File object pointer for the file. This parameter is required and cannot be NULL.

    Size - Pointer to a LONGLONG indicating the file size. This is the output.

Return Value:

    Returns statuses forwarded from FltQueryInformationFile.

--*/
{
    NTSTATUS status = STATUS_SUCCESS;
    FILE_STANDARD_INFORMATION standardInfo;

    //
    //  Querying for FileStandardInformation gives you the offset of EOF.
    //

    status = FltQueryInformationFile( Instance,
                                      FileObject,
                                      &standardInfo,
                                      sizeof(FILE_STANDARD_INFORMATION),
                                      FileStandardInformation,
                                      NULL );

    if (NT_SUCCESS( status )) {

        *Size = standardInfo.EndOfFile.QuadPart;
    }

    return status;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-23T06:50:50.543

这个问题很老了，但是如果其他人偶然发现它（就像我一样），他们可能想知道在这个实例中使用的函数是[FsRtlGetFileSize](https://msdn.microsoft.com/en-us/library/windows/hardware/ff546023(v=vs.85).aspx)

# css - 在主菜单下的标题中添加徽标

> ID：14176551
> 
> 赞同：2
> 
> 时间：2013-01-05T21:25:05.447
> 
> 标签：css, wordpress, menu, header, graphical-logo

感谢您抽时间阅读。我的标题几乎总结了我遇到的问题。通常我会在这些类型的事情中摸索，但最终会以错误的方式完成，因此我的网站最终会出现问题。我正在尝试学习编写所有代码的正确方法，并让它变得干净整洁。

这是我正在使用的 WordPress 模板。这是我[网站](http://bceverything.com)的链接。我已经设置了一个子主题，并且喜欢它到目前为止的大部分内容，除了我想在我的所有页面上放置一个网站徽标，因为它是在标题中调用。在页面的左上角是我的网站标题和我的网站口号或任何你称之为的位置。下面是我的菜单（menu-primary），所有提到的都在标题中。我的模板不允许我在设置或自定义的标题中插入徽标。我想在菜单部分正下方的页面中间插入一个站点徽标。我想我可能应该让它可点击到我的主页或其他东西，并确保它是一个有效的[XHTML 可点击标题图像](http://justintadlock.com/archives/2007/10/22/valid-xhtml-clickable-header-images)? 我不确定这是否是一个坏主意，或者没有看到网站标题将链接回主页。在我的所有页面上都有两个指向同一个地方的链接是不是很糟糕？我假设是这样。我猜我真的不需要图片来链接。

有没有人可以帮助我解决这个问题？我感谢所有输入。这个网站在教我基础知识方面非常有帮助。我在这里看到了做我想做的事情的方法，但恐怕它们都不是正确的方法。再次感谢！

这是header.php：

```
<?php
/**
 * Header Template
 *
 * The header template is generally used on every page of your site. Nearly all other templates call it 
 * somewhere near the top of the file. It is used mostly as an opening wrapper, which is closed with the 
 * footer.php file. It also executes key functions needed by the theme, child themes, and plugins. 
 *
 * @package Save for Web
 * @subpackage Template
 */
?>
<!DOCTYPE html>
<html <?php language_attributes(); ?>>
<head>
<meta http-equiv="Content-Type" content="<?php bloginfo( 'html_type' ); ?>; charset=<?php bloginfo( 'charset' ); ?>" />
<title><?php hybrid_document_title(); ?></title>

<link rel="stylesheet" href="<?php echo get_stylesheet_uri(); ?>" type="text/css" media="all" />
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="<?php bloginfo( 'pingback_url' ); ?>" />

<?php wp_head(); // wp_head ?>

</head>

<body class="<?php hybrid_body_class(); ?>">

    <?php do_atomic( 'open_body' ); // saveforweb_open_body ?>

    <div id="container">

        <?php do_atomic( 'before_header' ); // saveforweb_before_header ?>

        <div id="header">

            <div class="fixed">

                <?php do_atomic( 'open_header' ); // saveforweb_open_header ?>

                <div class="wrap">

                    <div id="branding">
                        <?php hybrid_site_title(); ?>
                        <?php hybrid_site_description(); ?>
                    </div><!-- #branding -->

                    <?php get_template_part( 'menu', 'primary' ); // Loads the menu-primary.php template. ?>

                    <?php get_sidebar( 'header' ); // Loads the sidebar-header.php template. ?>

                    <?php do_atomic( 'header' ); // saveforweb_header ?>

                </div><!-- .wrap -->

                <?php do_atomic( 'close_header' ); // saveforweb_close_header ?>

            </div><!-- .fixed -->

        </div><!-- #header -->

        <?php do_atomic( 'after_header' ); // saveforweb_after_header ?>

        <?php do_atomic( 'before_main' ); // saveforweb_before_main ?>

        <div id="main">

            <div class="wrap">

            <?php do_atomic( 'open_main' ); // saveforweb_open_main ?> 
```

这是menu-primary.php：

```
<?php
/**
 * Primary Menu Template
 *
 * Displays the Primary Menu if it has active menu items.
 *
 * @package Save for Web
 * @subpackage Template
 */

if ( has_nav_menu( 'primary' ) ) : ?>

    <?php do_atomic( 'before_menu_primary' ); // saveforweb_before_menu_primary ?>

    <div id="menu-primary" class="menu-container">

            <?php do_atomic( 'open_menu_primary' ); // saveforweb_open_menu_primary ?>

            <?php wp_nav_menu( array( 'theme_location' => 'primary', 'container_class' => 'menu', 'menu_class' => '', 'menu_id' => 'menu-primary-items', 'fallback_cb' => '' ) ); ?>

            <?php do_atomic( 'close_menu_primary' ); // saveforweb_close_menu_primary ?>

    </div><!-- #menu-primary .menu-container -->

    <?php do_atomic( 'after_menu_primary' ); // saveforweb_after_menu_primary ?>

<?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T00:43:55.377

最有可能为您生成菜单的功能`wp_nav_menu`。所以第一步是找出它在模板源代码中的位置。例如，可能在 header.php 中。确保它的参数显示“theme_location => 'menu-primary'”，以便您拥有正确的菜单，以防您的模板有多个。

接下来，复制此代码并将其粘贴到下面：

```
<a href="<?php bloginfo( 'url' ); ?>"><img src="<?php bloginfo( 'stylesheet_directory' ); ?>/images/..." alt="" title="" /></a> 
```

您必须调整 src=... 部分，使其与标题图像的 URL 匹配。

# html - html表格中的换行符

> ID：14176554
> 
> 赞同：12
> 
> 时间：2013-01-05T21:25:10.647
> 
> 标签：html, html-table

每次插入 loooong 评论时，如何阻止我的表格增加宽度？

我做了一个简单的例子：

```
<!DOCTYPE html>
<html>
    <body>
        <table width='350'  border="0" align="center" cellpadding="3" cellspacing="1" class="table">
            <tr>
                <th id="row_style" bgcolor='#D6D6D6'>ID</th>
                <th id="row_style" width= "50%" bgcolor='#D6D6D6'>Content</th>
                <th id="row_style" bgcolor='#D6D6D6'>Date</th>
            </tr>
            <tr>
                <td id="row_style" bgcolor='#3399FF' scope='col' width='50'>Example</td>td>
                <td id="row_style" width ='10%'> Content</td>td>
                <td id="row_style" bgcolor='#3399FF' scope='col' width ='10%'>Example</td>td>
                <td width ='10%'></td>
            </tr>
        </table>
    </body>
</html> 
```

当我增加“内容”这个词时，表格宽度正在增加..我怎样才能停止这个并插入换行符？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-05T21:32:21.030

您可以通过设置表格的宽度来做到这一点，也可以使用

```
word-wrap:break-word; 
```

为了防止真长的话突破界限。

宽度最好在 css 中设置：

编辑：包括

```
table-layout:fixed; 
```

演示

[http://jsbin.com/atonut/1/edit](http://jsbin.com/atonut/1/edit)

```
table {
width:500px;
table-layout:fixed;
}

td {
word-wrap:break-word;
} 
```

如果您的问题是大量文本而不是令人难以置信的长单词，请仅使用宽度，并保留自动换行。希望有帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2019-03-22T16:28:42.500

听起来很糟糕，但你应该使用：

```
<tr><td><br></td></tr> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T21:39:32.133

这是答案：

```
<table width='350'  border="0" align="center" cellpadding="3" cellspacing="1" class="table">
                <tr>
                    <th id="row_style" bgcolor='#D6D6D6'>ID</th>
                    <th id="row_style" width= "10%" bgcolor='#D6D6D6'>Content</th>
                    <th id="row_style" bgcolor='#D6D6D6'>Date</th>

                </tr>
<tr>
                            <td id="row_style" bgcolor='#3399FF' scope='col' width='10%'>Example</td>
                            <td id="row_style" width ='10%'> Contentd</td>
                            <td id="row_style" bgcolor='#3399FF' scope='col' width ='10%'>Example</td>
                            <td width ='10%'>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-17T07:11:25.080

添加样式：

```
td
{
    border: solid 1px #000000;
    padding: 5px;
}
th
{
    border: solid 1px #000000;
    padding: 5px;
}
/* @media print
{
    table
    {
        page-break-after: always;
    }
}*/ 
```

为 tr 赋予样式：

```
style="page-break-inside: avoid;" 
```

# javascript - 从 id 值数组创建骨干集合

> ID：14176555
> 
> 赞同：0
> 
> 时间：2013-01-05T21:25:23.027
> 
> 标签：javascript, model-view-controller, backbone.js, collections, model

我有一个与某个模型有关的 20 个 id 数组。

```
[4,16,43,34....] 
```

我想创建一个包含由这些 ID 值表示的模型的集合。我被建议使用地图来做到这一点：

```
arr = arr.map(function(id) { return getModel(id); }); 
```

但是当整个过程完成后，就没有任何方法可以获得成功函数或回调。在完成之前，我无法执行下一个任务。

关于我如何做到这一点的任何提示？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T13:27:14.740

我曾经`fetchMany`为 Backbone 集合制作了这个 mixin，它几乎完全符合你的要求，加上一些围绕 jQuery Promise API 的糖。也许它对你也有用？

混音：

```
Backbone.Collection.prototype.fetchMany = function(ids, options) {
  var collection = this;
  var promises = _.map(ids, function(id) {
    var instance = collection.get(id);
    if(!instance) {
      instance = new collection.model({id:id});
      collection.add(instance);
    }
    return instance.fetch(options);
  });
  //promise that all fetches will complete, give the collection as parameter
  return $.when.apply(this, promises).pipe(function() { return collection; });
}; 
```

它可以这样使用：

```
var collection = new SomeCollection();
collection.fetchMany([4,16,43,34]).then(function(c) {
  //do something with the collection...
  $("body").append(new SomeView({collection:c}).render().el);
}); 
```

# android - 引用属性枚举值

> ID：14176563
> 
> 赞同：4
> 
> 时间：2013-01-05T21:26:10.237
> 
> 标签：android, android-xml

提供样式参数时是否可以引用*枚举值？*
例如，我们可以这样做：

```
<!-- layouts.xml -->
<TextView
    android:text="@string/str" />

<!-- values.xml -->
<item type="string" name="str">hi</item> 
```

这适用于字符串、整数、维度等，但我需要引用*枚举*值 - 例如`visibility`属性。我正在寻找类似的东西：

```
<!-- layouts.xml -->
<TextView
    android:visibility="@????/viz" />

<!-- values.xml -->
<item type="?????" name="viz">gone</item> 
```

`visibility`只是一个例子 - 它可以是任何其他基于枚举的属性。

到目前为止，我发现的唯一解决方法是使用*样式*

```
<!-- layouts.xml -->
<TextView
    android:style="@styles/theStyle" />

<!-- styles.xml -->
<style name="theStyle">
    <item name="android:visibility">gone</item>
</style> 
```

但这在某种程度上是有限制的，因为如果您需要使用带有 TextViews 的*真实*样式以及仅用于控制单个属性的*特殊样式，它会变得越来越复杂。*

如果有一种方法可以引用单个样式项，则另一种选择是。就像是：

```
<TextView
    android:visibility="@styles/theStyle/visibility" /> 
```

但我认为上述情况更不可能发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T05:52:58.403

每个枚举实际上是一组命名整数。例如，`visibility`属性声明如下：

```
<attr name="visibility">
    <enum name="visible" value="0" />
    <enum name="invisible" value="1" />
    <enum name="gone" value="2" />
</attr> 
```

所以你可以直接通过它的值来引用枚举项。像这样的东西：

```
<!-- values.xml -->
<item name="viz" type="integer">1</item>

<!-- layouts.xml -->
<TextView
    android:visibility="@integer/viz"/> 
```

我刚刚在我的手机上检查了它，它运行良好。

# android - 在 Android 中循环画布

> ID：14176566
> 
> 赞同：0
> 
> 时间：2013-01-05T21:26:14.140
> 
> 标签：android, loops, touch-event, ontouchlistener

有谁知道如何循环这幅画布？我想稍后添加一个 onTouch 方法并获取 X 位置。谢谢你。

```
 @Override
protected void onDraw(Canvas canvas) {
    //Canvas canvas= new Canvas();
    xp1 = canvas.getWidth()/2;
    Log.d("test1", "It went pass onDraw");
    xp2 = canvas.getWidth()/2;
    yp1 = 25;
    yp2 = 760;
    canvas.drawColor(Color.BLACK);
    canvas.drawBitmap(paddle1, xp1,yp1, null);
    canvas.drawBitmap(paddle2,xp2,yp2, null);
    Paint white = new Paint();
    white.setColor(Color.WHITE);
    canvas.drawText("Score P1:"+ p1Score +" P2: " + p2Score , 700, 20,white );  
    Log.d("test1", "It's done with onDraw");

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:30:10.077

调用方法

```
invalidate(); 
```

每当您想对`'onDraw'`方法进行回调时

```
aSampleCode(){
        image.setOnTouchListener(new View.OnTouchListener() {
            @Override
            public boolean onTouch(View v, MotionEvent event) {

                switch(event.getAction())
                {
                case MotionEvent.ACTION_MOVE:

                    x= event.getRawX()

                    break;
                case MotionEvent.ACTION_UP:
                                    invalidate();
                    break;
                case MotionEvent.ACTION_DOWN:
                    break;

                default:
                    break;
                }
                return true;
            }
        });
    }
} 
```

# c++ - WndProc 从不接收任何 WM_COMMAND 消息？

> ID：14176568
> 
> 赞同：0
> 
> 时间：2013-01-05T21:26:32.790
> 
> 标签：c++, winapi, frameworks

我正在 Win32 上创建一个简单的框架，但我似乎无法捕捉到任何`WM_COMMAND`消息。我将通过 WndProc 的所有消息打印到输出控制台，但没有`WM_COMMAND`消息。我的程序由一个窗口和一个编辑框（带有“EDIT”类）组成。

这是我的临时消息循环（仅用于测试）：

```
MSG msg;
BOOL ret;
while( ( ret = ::GetMessage( &msg, NULL, 0, 0 ) ) > 0 )
{
    if(msg.hwnd == NULL)
        continue;
    else if(ret == -1)
        break;
    else {
        ::TranslateMessage( &msg );
        ::DispatchMessage( &msg );
    }
} 
```

这是 WndProc：

```
LRESULT CALLBACK Win32Base::GlobalWndProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    Win32Base *pWindow;

    pWindow = reinterpret_cast<Win32Base*>( GetWindowLong( hWnd, GWL_USERDATA ) );
    if( pWindow ) {
        MSG msgdata;
        msgdata.hwnd = hWnd;
        msgdata.message = msg;
        msgdata.wParam = wParam;
        msgdata.lParam = lParam;

        return pWindow->OnMessage( msgdata );
    }

    return DefWindowProc(hWnd, msg, wParam, lParam);
} 
```

我也在子类化编辑框。我可以捕捉到它的`WM_CHAR`消息等，但是没有`WM_COMMAND`消息（但是，我不认为它们不应该在那里）。

我觉得问题可能出在我处理育儿的方式上。我添加了 Windows 父级的动态更改，当创建控件时，它可能还没有父级。所以如果我用 . 创建一个控件`WS_CHILD`，它会因为没有父控件而导致错误。因此，当我分配父级时，我还会附加`WS_CHILD`样式（或删除它，如果我要删除父级）。这是一个好习惯吗？也许它可能阻止主窗口接收编辑框的 WM_COMMAND 消息？

另外，当我输入时，编辑框不会重新绘制，我必须强制它重新绘制，这非常慢......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T21:46:21.353

编辑控件在创建时缓存其父窗口并且永远不会更新它，因此即使您重新设置编辑控件的父级，它仍会向原始父级发送通知消息。

一种解决方案是创建一个虚拟的“包装”窗口类，它承载编辑控件，并将从编辑控件发送的通知消息转发到其父级。

# iphone - 我想用 Quartz 让单色图像变成不同的颜色

> ID：14176569
> 
> 赞同：0
> 
> 时间：2013-01-05T21:26:38.867
> 
> 标签：iphone, ios, objective-c, quartz-graphics

我确信这个问题的答案存在于 stackoverflow 上，但我一直在寻找但还没有找到。本质上，我有几张具有透明背景的图像和一些黑色图像，我希望能够将黑色部分的颜色更改为其他任意颜色。

我相对确定这是可以通过[Quartz Image Masking](https://developer.apple.com/library/mac/#documentation/graphicsimaging/conceptual/drawingwithquartz2d/dq_images/dq_images.html)实现的，但是我找不到任何好的例子，所以这就是我正在寻找的。也欢迎其他解决方案。

谢谢！！！

**更新：**我认为我与这段代码非常接近......但我的面具不起作用。虽然我的`UIView`确实填充了填充颜色，但它只是一个巨大的矩形，没有任何剪裁。

**更新＃2：**我现在（我认为）更接近以下代码。问题是我的背景现在是黑色的，而不是透明的。

```
CGContextRef context = UIGraphicsGetCurrentContext();

CGContextScaleCTM(context, 1, -1);
CGContextTranslateCTM(context, 0, -rect.size.height);

CGImageRef maskImage = [self.image CGImage];
CGContextClipToMask(context, rect, maskImage);

[_colorToChangeInto setFill];
CGContextFillRect(context, rect); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T06:46:52.023

答案已经在上面的问题中了。它不太有效，因为我在 IB 中（在故事板中）创建图像，并且没有设置背景颜色。不知何故，默认为黑色。太令人沮丧了！！！

无论如何，在我将背景颜色更改为透明后，下面的代码就像一个魅力！

```
CGContextRef context = UIGraphicsGetCurrentContext();

CGContextScaleCTM(context, 1, -1);
CGContextTranslateCTM(context, 0, -rect.size.height);

CGImageRef maskImage = [self.image CGImage];
CGContextClipToMask(context, rect, maskImage);

[_colorToChangeInto setFill];
CGContextFillRect(context, rect); 
```

# c++ - 如何使用 waf 在自定义路径中搜索库/标题？

> ID：14176570
> 
> 赞同：4
> 
> 时间：2013-01-05T21:26:41.310
> 
> 标签：c++, waf

我尝试在 waf wscript 文件中搜索库和标题。通常，这可以通过以下方式实现：

```
def configure( conf ):
  conf.load( "compiler_cxx" )
  conf.check_cxx( lib = "thelib" )
  conf.check_cxx( header_name "header.hpp" ) 
```

这在类 Unix 系统上运行良好，其中库和头文件大多位于公共位置。但是，我想为`check_cxx()`命令添加自定义搜索路径，尤其是让 Windows 系统上的用户有机会找到通常位于文件系统中的某个库。

我知道这个`libpath`论点，但是它仍然需要以某种方式填充，我想知道是否没有我错过的更通用甚至内置的解决方案。

我也很高兴听到有关 waf 中此类事情的其他方法、解决方案或良好实践。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T11:10:26.990

最佳实践是使用`use`WAF 工具进行检查（[wafbook 的第 10.3 节](https://waf.io/book/#_library_interaction_use)）并定义外部/系统库的路径（[第 10.3.3 节](https://waf.io/book/#_foreign_libraries_and_flags)）

它看起来像：

```
def configure(conf):

    conf.load('compiler_cxx')
    conf.env.LIBPATH_MYLIB = ['/usr/local/lib']
    conf.env.INCLUDES_MYLIB  = ['/usr/local/include']

    if sys.platform == 'win32':
            conf.env.LIBPATH_MYLIB   = ['/custom/windows/path/lib']
            conf.env.INCLUDES_MYLIB  = ['/custom/windows/path/include']

    # use MYLIB in your check
    conf.check_cxx(lib = 'somelib', use = 'MYLIB', cxxflags = '-O2')

def build(bld):

    # Of course you can use the defined MYLIB in build ^^
    bld.program(source = 'main.cpp', use = 'MYLIB') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T15:38:23.463

```
def build(bld):
    bld.program(
        ...
        stdlibpath=['list/of','various/paths','the/linker/checks/for','libraries'],
        ...
    ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-21T23:25:01.700

Wafs C 和 C++ 编译工具也尊重 Windows 上的环境变量。因此，您只需在运行 Waf 之前设置`CXXFLAGS`和：`LDFLAGS`

```
> set CXXFLAGS=/IC:\\path\\to\\header.hpp-file
> set LDFLAGS=/LIBPATH:C:\\path\\thelib
> python waf configure build
... 
```

`/I`并且`/LIBPATH`是 Waf 将传递给 C 编译器和链接器的开关。在这种情况下，Microsoft Visual C。如果您使用 gcc 或 clang ，请使用`-I`and 。`-L`

# php - 写入现有 XML 文档

> ID：14176572
> 
> 赞同：1
> 
> 时间：2013-01-05T21:26:43.713
> 
> 标签：php, xml, simplexml

> **可能重复：**
> [如何使用 php 写入现有的 xml 文件](https://stackoverflow.com/questions/4350817/how-to-write-into-existing-xml-file-using-php)

我正在尝试使用 SimpleXML 写入现有的 XML 文件（就像 Matthew 在[*如何使用 php 写入现有的 xml 文件中*](https://stackoverflow.com/questions/4350817/how-to-write-into-existing-xml-file-using-php)所说的那样），除了我的 XML 文件有更多项目（*这不是我的 XML 文件的实际结构，我只是以它为例*）。

```
<Books>
<Authors>
    <WeiMengLee>
        <Book>Beginning iOS 4 Application Development</Book>
    </WeiMengLee>
</Authors>
</Books> 
```

所以我的问题是，如何在 PHP 中使用 SimpleXML 向“WeiMengLee”项添加新的“Book”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:09:51.923

正如上面已经提到的 vascowhite，重新考虑 xml 文件的结构。不管怎样，这里有一些代码，它打开 xml 文件，遍历 wei meng lee 部分中的所有可用书籍并打印出它们的标题，然后将新书添加到该部分，最后将文件保存回磁盘。确保 xml 文件可由您的网络服务器执行 php 脚本的用户写入。

```
//read info from xml file to structured object
$xml = new SimpleXMLElement('bla.xml', null, true);

//loop all available books for wei meng lee
foreach( $xml->Authors->WeiMengLee->Book as $book)
{
    //print book title + newline
    print $book . "<br />";
}

//add a new book entry to your xml object
$xml->Authors->WeiMengLee->addChild("Book", "HERE GOES THE TITLE");

//save the changes back to the xml file
//make sure to set proper file access rights 
//for bla.xml on the webserver
$xml->asXml('bla.xml'); 
```

希望这会有所帮助 8)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T22:20:33.283

您需要确定您的 xml 是关于书籍还是关于作者。

如果是关于书籍，那么它应该看起来像这样：-

```
<?xml version="1.0"?>
<books>
    <book>
        <title>Beginning iOS 4 Application Development</title>
        <author>WeiMengLee</author>
    </book>
</books> 
```

然后，您可以像这样添加一本新书：-

```
$xml = new SimpleXMLElement("filename.xml", null, true);

$book = $xml->addChild('book');
$book->addChild('title', 'Another Book');
$book->addChild('Author', 'WeiMengLee');
$xml->asXML('filename.xml'); 
```

输出：-

```
<?xml version="1.0"?>
<books>
    <book>
        <title>Beginning iOS 4 Application Development</title>
        <author>WeiMengLee</author>
    </book>
    <book>
        <title>Another Book</title>
        <Author>WeiMengLee</Author>
    </book>
</books> 
```

另一方面，如果您的 xml 是关于作者的，那么它应该看起来像这样：-

```
<?xml version="1.0"?>
<authors>
    <author>
        <name>WeiMengLee</name>
        <books>
            <book>Beginning iOS 4 Application Development</book>
        </books>
    </author>
</authors> 
```

你会像这样添加另一本书：-

```
$xml = new SimpleXMLElement("filename.xml", null, true);

foreach($xml as $author){
    if($author->name == 'WeiMengLee'){
        $weimenglee = $author;
    }
}

$weimenglee->books->addChild('book', 'Another book');

$xml->asXML('filename.xml'); 
```

输出：-

```
<?xml version="1.0"?>
<authors>
    <author>
        <name>WeiMengLee</name>
        <books>
            <book>Beginning iOS 4 Application Development</book>
            <book>Another book</bmook>
        </books>
    </author>
</authors> 
```

# sql - MS Access 查询汇总某些列匹配时的值

> ID：14176576
> 
> 赞同：1
> 
> 时间：2013-01-05T21:27:28.863
> 
> 标签：sql, ms-access

我有一个 Access 数据库，用于保存与每个拍摄日相关的广告和订单项的拍摄日。

所以我会有类似的东西......

```
Shoot Day      ......      Total
 Travel                     400
 Travel                     150
 Travel                     200
   1                        350
   1                        275
   2                        850
   2                        500
  ...                       ... 
```

这会持续一段时间。我想要一个查询返回类似

```
Shoot Day      .......     Total
 Travel                     750
   1                        625
   2                       1350
  ...                       ... 
```

所以我希望它在“拍摄日”列中有匹配项时将总列加起来。

我很想得到一些帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T21:29:18.877

您需要以下内容：

```
 SELECT [Shoot Day], Sum([Total])
 FROM Table
 GROUP BY [Shoot Day] 
```

# mysql - 使用 phpMyAdmin 创建函数

> ID：14176583
> 
> 赞同：0
> 
> 时间：2013-01-05T21:28:16.563
> 
> 标签：mysql, function, phpmyadmin

我无法使用[phpMyAdmin](http://en.wikipedia.org/wiki/PhpMyAdmin)创建函数，例如[MySQL](http://en.wikipedia.org/wiki/MySQL)的接口。所以我写：

```
DELIMITER //
Create or Replace Function  affecter (id_patient IN integer , id_maladie IN VARCHAR2 ) 
Return VARCHAR2(30) IS  msg Varchar2(30);
Begin
    Insert into souffrir values (id_patient,id_maladie);
    msg:= 'Insertion effectuée';
    Return msg;
END// 
```

我收到此错误：

> #1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本对应的手册，以在第 1 行的“Function effecter (id_patient IN integer , id_maladie IN VARCHAR2) Returns V”附近使用正确的语法

如何修复此错误？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-02-18T14:35:47.397

尝试这个：

```
DELIMITER $$
CREATE FUNCTION calcProfit(cost FLOAT, price FLOAT) RETURNS DECIMAL(9,2)
BEGIN
  DECLARE profit DECIMAL(9,2);
  SET profit = price-cost;
  RETURN profit;
END$$
DELIMITER ; 
```

从[https://www.a2hosting.com/kb/developer-corner/mysql/mysql-stored-functions-and-procedures获得](https://www.a2hosting.com/kb/developer-corner/mysql/mysql-stored-functions-and-procedures)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T22:00:30.700

目前，[MySQL](http://en.wikipedia.org/wiki/MySQL)没有 create 函数的“或替换”部分。相反，您应该在定义分隔符后添加`DROP FUNCTION IF EXISTS`带有函数名称的 a。

见*[13.1.12。CREATE PROCEDURE 和 CREATE FUNCTION 语法](http://dev.mysql.com/doc/refman/5.6/en/create-procedure.html)*。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-05T22:14:29.243

如果您转到 PMA 中的 SQL 选项卡，就在用于输入 SQL 的大框下方，有一个用于分隔符的小输入字段。从您的 SQL 中删除`DELIMITER //`，将分隔符输入字段从 ';' '//' 粘贴您的代码并提交。

# spring-social - Spring-Social 无需注册即可登录

> ID：14176585
> 
> 赞同：6
> 
> 时间：2013-01-05T21:28:41.970
> 
> 标签：spring-social

我最近开始使用 Spring-Social。

在我查看的所有示例中，都存在通过单击“与 Facebook 连接”的图像进行**登录**的过程，然后被重定向到您需要**注册**到您访问的实际网站的页面。

Stack-Overflow 是无需注册的完美示例，您只需单击一个按钮即可登录您的帐户并开始提问。如果您想注销并通过不同的提供商连接，您可以这样做，堆栈溢出将识别您（假设电子邮件地址是唯一标识符）。

我的问题是，为什么您实际上需要**注册**功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T00:35:45.567

[https://github.com/SpringSource/spring-social-samples/tree/master/spring-social-quickstart](https://github.com/SpringSource/spring-social-samples/tree/master/spring-social-quickstart)上的 Spring Social 快速入门示例是具有隐式注册的应用程序示例。没有注册页面，而是使用用户的 Facebook 个人资料数据来创建用户。（这实际上是处理应用程序定义的 SimpleConnectionSignUp，它被注入到 JdbcUsersConnectionRepository 中。）

Spring Social Canvas 示例是另一个这样做的示例，尽管它是针对 Facebook Canvas 应用程序的。

有许多方法可以为用户发挥作用，但大多数/全部都可以通过 ConnectionSignUp 接口的适当实现来解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T13:22:50.573

实际上，在使用 spring social 登录时，您**不会**使用来自某些提供商（例如 Facebook）的会话。Spring Social 将尝试将您的社交帐户与一些本地应用程序帐户进行匹配。如果它找到匹配项，那么将在**您的应用程序**中创建一个本地会话。因此，您将对会话/用户配置文件有更多控制权：

*   您将只能为您的 Web 应用程序注销
*   您将只能为您的应用程序禁用某些帐户

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T11:24:42.317

对于网络应用程序，我认为他们可能需要比其他服务提供的更多的人员信息（例如有时无法从 Oauth api 获取电子邮件）

# php - Zend Session 什么时候读写？

> ID：14176588
> 
> 赞同：0
> 
> 时间：2013-01-05T21:29:20.790
> 
> 标签：php, zend-framework, session, zend-session

我在 Zend Session 命名空间中存储了大量数据，我想知道在我的类中引用它的最有效方法是什么。

目前，我的构造函数使用“稍后”等行设置访问权限`$this->_storage = new Zend_Session_Namespace('products');` ，当我需要访问命名空间中的数据时，我使用`$this->_storage->varname = $var;`或`$this->_storage->unsetAll();`

这是否意味着每次我读取或写入会话时都会有磁盘活动？还是在请求开始时读取并在结束时写入？

如果在单个请求的持续时间内有多个磁盘访问，是否有简单的解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:41:54.347

从[关于会话使用的 php 手册页](http://php.net/manual/en/session.examples.basic.php)

> 会话遵循简单的工作流程。当会话启动时，PHP 将使用传递的 ID 检索现有会话（通常来自会话 cookie），或者如果没有传递会话，它将创建一个新会话。PHP 将在会话开始后使用任何会话数据填充 $_SESSION 超全局变量。当 PHP 关闭时，它会自动获取 $_SESSION 超全局变量的内容，将其序列化，并使用会话保存处理程序将其发送到存储中。

因此，要回答您的问题，这意味着在会话开始时有一次读取，在会话关闭时有一次写入，在这两者之间，`$_SESSION`超全局基本上保存在内存中。

# machine-learning - 决策树 - 稀疏数据集

> ID：14176589
> 
> 赞同：1
> 
> 时间：2013-01-05T21:30:08.847
> 
> 标签：machine-learning, data-mining, decision-tree

我有非常稀疏的数据集，具有大量属性（约 12 K 特征和 700K 记录）我无法将其放入内存（属性值是二项式，即 True/False），

由于它是稀疏的，我将数据集保存为 (ID , Feature) 格式，因此例如我将有以下记录：
(ID , Feature)
(110 , d_0022)
(110 , d_2393)
(110 , i_2293)
(822 , d_933 )
(822 , p_2003)
....

因此，对于 ID 为 110 的记录，我们将拥有三个具有真值的属性（d_0022 ; 2_2393 ; i_2293），其余的都是假的（属性都是属性“特征”的不同值）

是否有任何可用的软件可以实现一种算法来在这种数据集上训练数据集，所以我不首先制作整个数据集？

（目前我正在使用rapidminer）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T09:11:07.657

您可以将[R](http://www.r-project.org/)的稀疏矩阵（[example](https://stackoverflow.com/questions/1274171/creating-and-accessing-a-sparse-matrix-in-r)）或[Weka](http://www.cs.waikato.ac.nz/ml/weka/)与[SparseIstance](http://weka.sourceforge.net/doc/weka/core/SparseInstance.html)（甚至[BinarySparseInstance](http://weka.sourceforge.net/doc/weka/core/BinarySparseInstance.html)）一起使用。如果稀疏矩阵仍然不适合内存，您可以使用[Mahout](http://mahout.apache.org/)和 Amazon EC2 上的小集群来运行 SVD，减少矩阵的维度，以便它们可以正常处理。

我几乎没有使用 RapidMiner 的经验，但可能它也有一些稀疏矩阵的实现。

# ios6 - 自动布局清除我的按钮文本

> ID：14176591
> 
> 赞同：0
> 
> 时间：2013-01-05T21:30:17.220
> 
> 标签：ios6, interface-builder, storyboard, autolayout

每次我尝试使用自动布局时，我的按钮一行上的按钮文本都会变得拥挤，直到不再可见。

我不知道该怎么做才能解决这个问题，我尝试删除有问题的按钮并再次添加它们，但这通常会将问题迁移到另一行。

这是界面生成器中的样子。

![在此处输入图像描述](../Images/0d00f8908dba08452d3a55cd20d700da.png)

这是在设备上运行时的样子。

![在此处输入图像描述](../Images/e5a9eb0ce0da8a5f27719a1c5eef2301.png)

这非常令人沮丧，我没有找到有关它的信息。好像我是唯一受到影响的人。

如果有人对此有任何见解，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-27T22:04:42.387

自动布局也需要一些时间才能使用。Aleksandar Vacic 在另一篇文章中回答了这个问题。

> 我假设您已经创建了一个按钮，然后跨行复制，然后向下复制行。当您这样做时，设置的自动布局约束之一是按钮之间的“基线对齐”。
> 
> 所以选择有问题的按钮并检查你是否有这个约束。如果这样做，请选择它，升级到用户定义并删除它。之后一切都神奇地起作用。

来源：[UIButton 在 iOS6 中不显示文本](https://stackoverflow.com/questions/13835134/uibutton-not-showing-the-text-in-ios6)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T22:13:07.993

只是将您的项目放入视图中不再是一种选择。

我不得不移除所有按钮，并一次放置一个按钮，将我的所有约束推广到用户约束。

我创建了第一个项目并提升了宽度和高度。然后提升与超级视图的连接。

然后我复制了那个按钮（以及它的宽度和高度约束）并将它连接到左侧和顶部的按钮。

然后我连接了完成整行的下一个按钮。

在我有一行之后，我复制了该行并将其连接到其上方行的底部，依此类推，直到我的所有项目都完成。

我花了很长时间试图摆脱随机基线连接，例如按钮 7 到按钮 3。自动选择的约束不仅完全不准确而且无法使用。摆脱它们也是一种痛苦。

显然，自动布局将迫使您在构建界面时更加小心。这不是一件坏事，但确实会妨碍快速开发，因为您必须非常小心，不要让界面构建器附加您不想要的约束。

# wpf - WPF PRISM/Unity viewModel 参数

> ID：14176592
> 
> 赞同：0
> 
> 时间：2013-01-05T21:30:26.603
> 
> 标签：wpf, navigation, unity-container, prism-4

我有一个用于添加或编辑客户的视图和相应的视图模型。

如果我单击“添加新客户”按钮，unity 会为我连接一个漂亮的新客户视图，并传入我的数据上下文和视图模型，以及作为构造函数参数的客户对象。

我保存了我的客户，现在想从我的数据网格中查看另一个现有的客户记录。

我有一个从数据网格接受 selectedItem（客户）的命令，现在我想在视图模型的构造函数中将它作为参数传递给我的 CustomerView。

我如何告诉 Unity 我现在想使用我的 Client 参数构建我的 Views 视图模型，然后导航到该视图？

*编辑* 我在 CustomerModule 中注册我的视图并将客户启动按钮添加到导航区域，如下所示：

```
public void Initialize()
{
    _container.RegisterType<ICustomerMainView, CustomerMainView>();
    _container.RegisterType<ICustomerMainViewViewModel, CustomerMainViewViewModel>();
    _container.RegisterType<ICustomerView, CustomerView>();
    _container.RegisterType<ICustomerViewViewModel, CustomerViewViewModel>();
    _container.RegisterType<ICustomerNavIconView, CustomerNavIconView>();
    _container.RegisterType<ICustomerNavIconViewModel, CustomerNavIconViewModel>();
    //var view = _container.Resolve<ICustomerMainView>();
    //var view1 = _container.Resolve<ICustomerView>();

    _regionManager.RegisterViewWithRegion("NavigationRegion", typeof(Views.CustomerNavIconView));
} 
```

要添加新客户，我有以下命令：

```
private void OnAddNewCustomer()
{
    try
    {
        _regionManager.RegisterViewWithRegion("MainRegion", typeof(Views.CustomerView));
        _regionManager.RequestNavigate("MainRegion", "CustomerView");
    }
    catch (Exception ex)
    {

    }
} 
```

这很好，我可以添加新客户并保存详细信息。现在，如果我想通过双击网格中的记录来查看我保存的客户，我有如下命令，但不知道如何将 CustomerViewViewModel“客户”参数设置为我的 selectedItem(Customer)????

```
private void OnViewCustomer(Customer customer)
{
    try
    {
        _unityContainer.Resolve<ICustomerViewViewModel>(new ParameterOverride("customer", customer));
        _regionManager.RequestNavigate("MainRegion", "CustomerView");
    }
    catch (Exception ex)
    {

    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T14:47:42.643

所以我做了以下事情：

```
var clientView = _unityContainer.Resolve<IClientView>(new ParameterOverride("clientId", client.ClientId).OnType<ClientViewViewModel>());
                _regionManager.Regions["MainRegion"].Add(clientView);
                _regionManager.RequestNavigate("MainRegion", "ClientView"); 
```

本质上：

1.  让我的 ClientViewViewModel 实现 IRegionMemberLifetime 接口并让 KeepAlive 属性返回 False 以确保我每次导航到我的视图时都创建一个新的 ViewModel。
2.  让统一解决我一个新的 ClientView 覆盖 ClientViewViewModel 的“客户端”参数。
3.  将我新解决的视图添加到我要显示的区域
4.  导航到我的视图

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T17:02:30.973

我认为 Prism 不支持将对象/类传递给导航请求。但是，您可以将字符串/id 传递给接收方法。这是你如何做到的：

```
var query = new UriQuery();
query.Add("Customer", Customer.Id);
_regionManager.RequestNavigate("MainRegion",
         new Uri("CustomerView" + query.ToString(), UriKind.Relative)); 
```

现在，您可以使用此 id 并从数据库或任何地方获取您的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-17T15:37:49.763

这里有两个链接，我想这是你想知道的。

[棱镜/统一导航问题](https://compositewpf.codeplex.com/discussions/428609)

[WPF/PRISM/MVVM 中的参数覆盖](https://compositewpf.codeplex.com/discussions/390476)

# javascript - MarkerClusterer 不聚类标记

> ID：14176595
> 
> 赞同：0
> 
> 时间：2013-01-05T21:31:00.613
> 
> 标签：javascript, asp.net, html, google-maps, google-maps-api-3

由于存储在位置中的大量数据/标记，我的地图非常缓慢，所以我试图让 markerclusterer 工作显示[在这里](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/docs/examples.html)。Locations 只是 ac# 字符串数组，每个标记都有名称、纬度和经度。出于某种原因，该地图仍然有效，但只显示了单个标记并且没有将它们聚集在一起，我不知道为什么。任何帮助，将不胜感激。

```
<script type="text/javascript">

    var locations = [<%=locations%>];

    var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 10,
        center: new google.maps.LatLng(30.2979536, -97.7470835),
        mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    var markers = [];

    for (var i = 0; i < locations.length; i++) {
        var marker = new google.maps.Marker({position: new  google.maps.LatLng(locations[i][1], locations[i][2]), map: map });
        markers.push(marker);
    }

  var markerCluster = new MarkerClusterer(markers);
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T22:09:51.577

*   将地图传递到 MarkerClusterer

    ```
    var markerCluster = new MarkerClusterer(map, markers); 
    ```

[概念证明小提琴](http://jsfiddle.net/geocodezip/ng1mLkn2/)

[![结果地图的屏幕截图](../Images/7ffd137f6f6f00096443f0076264ecea.png)](https://i.stack.imgur.com/ISJA5.png)

您可能希望将纬度和经度从字符串转换为浮点数（使用 parseFloat()）。

[MarkerClusterer 的工作示例](http://www.geocodezip.com/v3_MW_example_map3_clustered.html)

**代码片段：**

```
var locations = [
  [0, 30.2979536, -97.7470835],
  [1, 30.29, -97.747],
  [2, 30.2979536, -97.7470835],
  [3, 30.2979536, -97.7470835]
];

var map = new google.maps.Map(document.getElementById('map'), {
  zoom: 10,
  center: new google.maps.LatLng(30.2979536, -97.7470835),
  mapTypeId: google.maps.MapTypeId.ROADMAP
});

var markers = [];

for (var i = 0; i < locations.length; i++) {
  var marker = new google.maps.Marker({
    position: new google.maps.LatLng(locations[i][1], locations[i][2]),
    map: map
  });
  markers.push(marker);
}

var markerCluster = new MarkerClusterer(map,markers,{imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
```

```
html,
body,
#map {
  height: 100%;
  width: 100%;
  margin: 0px;
  padding: 0px
}
```

```
<script src="https://maps.googleapis.com/maps/api/js?libraries=geometry&ext=.js"></script>
<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"></script>
<div id="map"></div>
```

# ruby-on-rails - nil:nilclass 的未定义方法“状态”

> ID：14176596
> 
> 赞同：3
> 
> 时间：2013-01-05T21:31:01.403
> 
> 标签：ruby-on-rails, ruby-on-rails-3

尝试将控制器与其索引视图链接在一起时得到这个。

在控制器中使用这个：

```
class FeedbackController < ApplicationController
  def index
  end
end 
```

这在路线中：

```
resources :feedback 
```

我明白了：

```
NoMethodError in FeedbackController#index

undefined method `status' for nil:NilClass 
```

这个堆栈跟踪：

```
actionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:31:in `block in process_action'
activesupport (3.2.8) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.8) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.8) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.8) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
activerecord (3.2.8) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.8) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.8) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.8) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.8) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.8) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:600:in `call'
omniauth (1.1.1) lib/omniauth/strategy.rb:177:in `call!'
omniauth (1.1.1) lib/omniauth/strategy.rb:157:in `call'
omniauth (1.1.1) lib/omniauth/strategy.rb:177:in `call!'
omniauth (1.1.1) lib/omniauth/strategy.rb:157:in `call'
/Users/macbook/.rbenv/versions/1.9.3-rc1/lib/ruby/gems/1.9.1/bundler/gems/rack-facebook-signed-request-802e6f0820f1/lib/rack/facebook/signed_request.rb:32:in `call'
warden (1.2.1) lib/warden/manager.rb:35:in `block in call'
warden (1.2.1) lib/warden/manager.rb:34:in `catch'
warden (1.2.1) lib/warden/manager.rb:34:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.1) lib/rack/etag.rb:23:in `call'
rack (1.4.1) lib/rack/conditionalget.rb:25:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/cookies.rb:339:in `call'
activerecord (3.2.8) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `_run__2909243921452486150__call__401413506945164242__callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.8) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.8) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.8) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.8) lib/rails/engine.rb:479:in `call'
railties (3.2.8) lib/rails/application.rb:223:in `call'
railties (3.2.8) lib/rails/railtie/configurable.rb:30:in `method_missing'
thin (1.5.0) lib/thin/connection.rb:81:in `block in pre_process'
thin (1.5.0) lib/thin/connection.rb:79:in `catch'
thin (1.5.0) lib/thin/connection.rb:79:in `pre_process'
thin (1.5.0) lib/thin/connection.rb:54:in `process'
thin (1.5.0) lib/thin/connection.rb:39:in `receive_data'
eventmachine (1.0.0) lib/eventmachine.rb:187:in `run_machine'
eventmachine (1.0.0) lib/eventmachine.rb:187:in `run'
thin (1.5.0) lib/thin/backends/base.rb:63:in `start'
thin (1.5.0) lib/thin/server.rb:159:in `start'
thin (1.5.0) lib/thin/controllers/controller.rb:86:in `start'
thin (1.5.0) lib/thin/runner.rb:187:in `run_command'
thin (1.5.0) lib/thin/runner.rb:152:in `run!'
thin (1.5.0) bin/thin:6:in `<top (required)>'
/Users/macbook/.rbenv/versions/1.9.3-rc1/lib/ruby/gems/1.9.1/bin/thin:19:in `load'
/Users/macbook/.rbenv/versions/1.9.3-rc1/lib/ruby/gems/1.9.1/bin/thin:19:in `<main>' 
```

我已经尝试将控制器复数化为反馈并适当地调整路由/文件名，但我仍然收到该错误。

也尝试使用`:as => :feedback`但仍然得到错误。如果我`/feedback/index.html.haml`在文件夹中没有 ，它将抛出正确的模板缺失页面，但即使模型、控制器和视图完全为空，它也会显示此状态错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T21:39:10.327

想通了这个......真是个奇怪的东西。

您不能在控制器中定义响应方法。所以我有：

```
def response
end 
```

仅仅拥有它就会导致这个错误！

# php - PHP：从包含的文件中获取会话变量

> ID：14176603
> 
> 赞同：-3
> 
> 时间：2013-01-05T21:31:45.313
> 
> 标签：php, session, include, session-variables

我想知道这是否有问题？

我包含一个具有会话变量的文件，但我试图从包含的文件中获取该会话变量，但它没有通过？

索引.php

```
<?php 
session_start();
session_regenerate_id();
ob_start(); // Initiate the output buffer
include("file.php");
echo $_SESSION['name'];
?> 
```

文件.php

```
$_SESSION['name'] = "Andrew"; 
```

我的`index.php`文件没有回显任何内容。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T21:32:59.313

添加

```
session_start(); 
```

在文件的开头

并添加

```
<?php 
```

到文件.php

因为没有

```
<?php 
```

file.php 被读取为 html

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:35:07.163

您使用`SESSION`变量的每个文件都必须包含这个

```
session_start(); 
```

在顶部

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T21:39:09.870

创建文件 bootstrap.php（或您选择的任何名称）并在开始时将这个文件包含在其他文件中。在 bootstrap.php 中，您将有两种可能的解决方案：

1.  `session_start();`

2.  `ini_set('session.auto_start', 1);`

在文件的开头。你也可以在你的 php.ini 中写这行：

```
session.auto_start on 
```

尝试**删除** `session_regenerate_id()`

# jquery - JQuery Mobile - 禁用后启用表单元素

> ID：14176605
> 
> 赞同：0
> 
> 时间：2013-01-05T21:31:55.290
> 
> 标签：jquery, jquery-mobile

在我的 Jquery Mobile 表单中，表单基于 Json 对象动态创建元素。它动态地向表单添加一个编辑按钮。构建表单后，我将所有元素设置为禁用。

如何在 Jquery Mobile 中重新启用表单元素？（不是jQuery）

当用户单击编辑按钮时，它应该启用所有表单元素。禁用效果很好，但我无法让它们启用。

```
 for (var data_index in data) {
                    var item = data[data_index];

                    for (var key in item) {
                        var field_id = "fld_" + key;
                        // Build the Fields 
                        var $field_container = $('<div data-role="fieldcontain"></div>');
                        //var $field_set = $('<fieldset data-role="controlgroup"></fieldset>');
                        var $field_label = $('<label for="' + field_id + '">' + key + '</label>');
                        var $field_input = $('<input name="' + field_id + '" id="' + field_id + '" placeholder="" value="' + item[key] + '" type="text">');
                        $field_input.attr('disabled', 'disabled');
                        $field_container.append($field_label);
                        $field_container.append($field_input);
                        $view_detail_container.append($field_container);
                    };
                }; 
```

这可以很好地创建表单元素，并且它们被禁用。

这个片段创建了编辑按钮（它可以很好地添加到 DOM），重新启用表单元素的代码在这个事件处理程序中。所有表单元素都是输入。（基本文本输入）

```
var $action_edit = $('<a id="action_edit" data-role="button">Edit</a>');
            $action_edit.on("click", function (event, ui) {
                // enable all form fields 
                $('#detail_form').children().each(function () {
                    alert('clicked!') // fires everytime just fine
                    var child = $(this);
                    child.attr('disabled', '');
                    child.ready();
                    child.trigger('create');
                }).trigger("create");

            });
            this.AddAction($action_edit);// appends this button to the correct div. 
```

我查看了 Jquery Mobile 文档，似乎比以前更好，但它仍然需要更好的照顾。

*   此[链接是](http://jquerymobile.com/test/docs/forms/docs-forms.html)Jquery Mobile 文档中的表单元素页面，如果您在此页面中搜索“禁用表单元素”，您将看到他们告诉您的一段：

> 通过向元素添加标准的 disabled 属性，可以在标记中禁用所有 jQuery Mobile 小部件，就像使用原生控件一样。每个表单小部件还具有与每个表单小部件一起记录的标准禁用和启用方法。以下是一些禁用小部件的示例

如果您转到 Jquery Mobile 文档中的“[文本输入”页面](http://jquerymobile.com/test/docs/forms/textinputs/)并在该页面中搜索“启用”或“禁用”，则找不到任何内容。此外，它们被解释为“方法”，并且不存在具有该名称的此类方法。所有谷歌搜索都让我尝试...

child.removeAttr('禁用'); // 没有骰子 child.attr('disabled',''); // 没有骰子

有什么我错过的，因为这些是动态元素吗？“页面”（Jquery mobile，记住页面是 div ，而不是文档）是否需要刷新？关于元素的另一个事件？

任何事物？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:47:50.170

当我对表单中的每个元素进行迭代时， .each() 只会下降 1 级。给定一个 JQuery Mobile 表单...

```
<form>
    <div class="ui-field-contain">
         <label></label>
         <input></input>
    </div>
</form> 
```

您必须对字段容器 div 的子元素执行 .each() 。以正常方式查询 dom 以获取任何输入元素并更改其属性也不起作用，这毫无价值。

```
$('#detail_form').children().each(function () { 
   var child = $(this);
   child.children().each(function () {
        var sub_item = $(this);
        sub_item.removeAttr('disabled');
   };
}; 
```

# jquery - 单击 div 外部使其隐藏

> ID：14176606
> 
> 赞同：0
> 
> 时间：2013-01-05T21:32:02.053
> 
> 标签：jquery, function, hide

我在点击时使用一个简单的 jquery 函数显示一个隐藏的登录 div。

```
function showLog(){
 $('#signin_menu').slideDown();
} 
```

当用户在框外单击时，我将如何编辑它以隐藏 div？

**div html**（如果需要）

```
<div id="signin_menu" >
 <p>
      <label for="email">Email</label>
      <input type="email" name="email" id="email" tabindex="4" title="email">
      </p>
      <p>
        <label for="password">Password</label>
        <input type="password" name="password" id="password" title="password" tabindex="5">
      </p>
      <p class="remember">
         <input type="button" class="button-link" name="submit" style="cursor:pointer" id="submit" value="Log In" onclick="logMeIn()" tabindex="6">

        <input id="remember" name="remember_me" value="1" tabindex="7" type="checkbox">
        <label for="remember">Remember me</label>
      </p>

  </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:41:10.320

```
$(document).click(function(e) {
    if (e.target.id && ((e.target.id !== "signin_menu") || $("#signin_menu").find($(e.target)))) {
        $("#signin_menu").slideDown();
    }   
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:42:08.087

```
var $e = $('#signin_menu');
$(document).click(function(event){
   if (!$(event.target).closest('#signin_menu').length && event.target.id !== 'showlog') {
     $e.slideUp();
   }
}); 
```

[http://jsfiddle.net/7SCN5/](http://jsfiddle.net/7SCN5/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T21:33:57.370

```
function showLog(){
    var $element = $("signin_menu");
    $('body').click(function(e){
    if (e.target.id !== "signin_menu"  && !$element.find(e.target).length)
        $element.slideDown();
    }); 
} 
```

或使用委托事件：

```
$('body').on('click', ':not(#signin_menu)', function(){
    $('#signin_menu').slideDown();
}); 
```

# mysql - mysql 运行时信息小工具或插件

> ID：14176608
> 
> 赞同：1
> 
> 时间：2013-01-05T21:32:17.020
> 
> 标签：mysql, wamp

我的问题说明了一切，是否有插件可以显示对 mySQL DB 的所有进程和连接。`(wamp)`类似于显示内存消耗、使用情况等的软件。任何帮助将不胜感激谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:34:24.187

运行此查询

```
SHOW FULL PROCESSLIST 
```

# javascript - 如何将javascript变量传递给外部css文件？

> ID：14176616
> 
> 赞同：0
> 
> 时间：2013-01-05T21:33:05.390
> 
> 标签：javascript, html, variables

我是编程和网页设计的新手，我正在尝试创建一个网站。我对其外观的计划是![这个](../Images/8fa04d3288b93e1bf6d9d8ab87b3d936.png)

所以，我使用的代码是

```
<body>
<div id="header">

</div>
<div id="content">

</div>
<div id="footer">

</div>

<script>
        function getWidth()
        {
            xWidth = null;
            if(window.screen != null)
                xWidth = window.screen.availWidth;

            if(window.innerWidth != null)
                xWidth = window.innerWidth;

            if(document.body != null)
                xWidth = document.body.clientWidth;

            return xWidth;
        }
        function getHeight() {
            xHeight = null;
            if(window.screen != null)
                xHeight = window.screen.availHeight;

            if(window.innerHeight != null)
                xHeight =   window.innerHeight;

            if(document.body != null)
                xHeight = document.body.clientHeight;

            return xHeight;
        }
</script>
</body> 
```

之后，我创建了一个 .css 文件（还为空）。所以，我想创建一个网站，从阅读器的屏幕上获取可用的宽度和高度，然后在计算数字后显示相对于可用宽度和高度的 div，例如，小盒子的高度 = 宽度 = 5% 可用.width_of_screen。每个小盒子都是一个项目或一个帖子。

**所以，我的问题是：如何在外部 css 中传递变量数据来计算我的网站的数字？**

谢谢，加布里埃尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:44:23.460

您可以像这样使用 jQuery 设置 css 变量：

```
$("p").css({"background-color":"yellow","font-size":"200%"}); 
```

在这种情况下，您将用变量替换“黄色”和“200%”。

# django - 如何将派生数据的元素添加到 Django 模型？

> ID：14176617
> 
> 赞同：0
> 
> 时间：2013-01-05T21:33:07.710
> 
> 标签：django

我有一个 Django 模型，如下所示：

```
class myModel(models.Model): 
    a = models.IntegerField() 
    b = models.IntegerField() 
```

我想在 myModel 类中添加一个名为 c 的 models.BooleanField()。但是 c 的值只是从 a 和 b 派生的，所以我不希望它存储在数据库中。

如果 a > b，我希望 c 为 True，否则为 False。即使 a 和 b 被修改，我也希望 c 反映正确/当前值。我希望能够使用 myModel.c 访问 c，就像我可以访问 a 和 b 一样。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:35:28.637

定义一个[属性](http://docs.python.org/2/library/functions.html#property)：

```
class myModel(models.Model): 
    a = models.IntegerField() 
    b = models.IntegerField() 

    @property
    def c(self):
        return self.a > self.b 
```

# apache - Apache 重写 CLEAN url？

> ID：14176618
> 
> 赞同：2
> 
> 时间：2013-01-05T21:33:12.470
> 
> 标签：apache, mod-rewrite, url-rewriting

所以我想知道是否有人愿意帮助我，或者告诉我是否有可能为我的网址做我想做的事情。

所以我希望网址像这样

[http://www.example.com/(seriesname)/season/(seasonnumber)/episode/(episodenumber](http://www.example.com/(seriesname)/season/(seasonnumber)/episode/(episodenumber) )

'()' 包围的变量需要是我可以解析的 php 变量。这是否可能/对 mod 重写的正则表达式有任何帮助。

我也可以说网址的子部分，只显示一个季节或所有季节的所有剧集。EG： [http://www.example.com/(seriesname)/season/(seasonnumber](http://www.example.com/(seriesname)/season/(seasonnumber) ) 将显示指定季节的所有剧集。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T23:15:29.130

干得好：

```
RewriteCond %{REQUEST_URI} !=/
RewriteCond %{REQUEST_URI} !robots.txt
RewriteCond %{REQUEST_URI} !.php$
RewriteRule ^([^/]*)$ index.php?name=$1
RewriteRule ^([^/]*)/season/([^/]*)$ index.php?name=$1&season=$2
RewriteRule ^([^/]*)/season/([^/]*)/episode/([^/]*)$ index.php?name=$1&season=$2&episode=$3 
```

# c - stdarg.h 和 char 参数

> ID：14176620
> 
> 赞同：0
> 
> 时间：2013-01-05T21:33:29.673
> 
> 标签：c

这是我的代码：

```
void a_simple_func_with_variable_argument(int, ...);
void a_simple_func_with_variable_argument(int start, ...) {
  va_list pa;
  char ch;
  va_start(pa, start);
  while(ch = va_arg(pa, char)) {
    printf("%c, ", ch);
  }
  printf("End\n");
  va_end(pa);
}
...
//call the func above in somewhere 
  a_simple_func_with_variable_argument(1, 'a', 'b', 'c', '\0'); 
```

由 gcc 编译后失败，我缺少什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T21:37:42.997

你需要小心`char`; `int`它在可变参数函数中自动提升。您将需要`int`作为第二个参数传递给`va_arg`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T21:41:38.340

当我编译你的例子时（在修复 va_arg(pa, char) 之后），编译器（gcc 4.6）告诉我

> ac：在函数'a_simple_func_with_variable_argument'中：
> ac：8：14：警告：'char'在通过'...'时被提升为'int' [默认启用]
> ac：8:14：注意：（所以你应该将'int'而不是'char'传递给'va_arg'）
> ac：8：14：注意：如果达到此代码，程序将中止

所以这里不足为奇。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-28T22:51:17.060

```
int func(char a, char b, char c) /* DEMONSTRATION that char on stack is promoted to int !!!
                                    note: this promotion is NOT integer promotion of literals, but promotion during handling of the stack. don't confuse the two */
{
  const char *p = &a;
  printf("a=%d\n"
         "b=%d\n"
         "c=%d\n", *p, p[-(int)sizeof(int)], p[-(int)sizeof(int) * 2]); // don't do this. might probably work on x86 with gcc (but again: don't do this)
} 
```

信息是错误的`va_arg(ap, char)`。`va_arg(ap, short)`改为使用`va_arg(ap, int)`：它将处理 int 类型和“较小”类型（short、char）的参数。

另请参阅[http://publications.gbdirect.co.uk/c_book/chapter9/stdarg.html](http://publications.gbdirect.co.uk/c_book/chapter9/stdarg.html) 引用：“注意避免可能由算术转换引起的问题。使用 char 或 short 作为 va_arg 的第二个参数是总是一个错误：这些类型总是提升到有符号 int 或无符号 int 之一，并且 float 转换为 double。”

# c# - 从 C# .NET 中启动 R 图

> ID：14176623
> 
> 赞同：8
> 
> 时间：2013-01-05T21:33:43.423
> 
> 标签：c#, .net, visual-studio-2010, r, visual-studio-2012

我正在用 C# 编写一个控制台应用程序，我想使用 R 引擎在窗口中弹出一个图形。

有谁知道这是否可以从 Visual Studio 2012 中实现？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T21:43:03.390

是的，有可能。您需要的是从 C# 执行 R 代码。通过在 google 上搜索，我发现了以下项目：[The R Statistical Language and C#.NET: Foundations](http://www.codeproject.com/Articles/25819/The-R-Statistical-Language-and-C-NET-Foundations) by **Jeff B. Cromwell**。

下面是一些代码来生成二十个正态随机变量的直方图：

```
//using STATCONNECTORCLNTLib; 
StatConnector test1 = new StatConnectorClass(); 
test1.Init("R"); 
test1.Evaluate("x <- rnorm(20)"); 
test1.EvaluateNoReturn("hist(x)"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T22:03:31.850

正如其他人所说，`R.net`是有前途的项目（仍然不稳定）。

背后的理念是在 .net 框架内操作 R 对象。

我认为如果你想要的只是在窗口中弹出一个图形，最好创建一个 .bat 文件，在其中使用非常好的`Rscript`命令调用你的 R 脚本。

像这样的东西应该适合你：

在您的 c# 方面，您调用

```
Process.Start("launcher.bat"); 
```

你定义你的`launcher.bat`：

```
PATH PATH_TO_R/R-version/bin;%path%
cd PATH_TO_R_SCRIPT
Rscript myscript.R arg1 arg2 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-05T11:04:25.677

要将图形从 R 拉入 .NET，并将其显示在 WinForms 面板上：

![在此处输入图像描述](../Images/0c9bd4684fb79b4c83897ea2cd65a1a7.png)

首先，我们必须安装 Statconn，它是 .NET 和 R 之间的桥梁。安装正确的版本很重要（如果 x32 和 x64 的错误混合将不起作用）。确保这一点的最简单方法是从 R 控制台中安装 Statconn：

```
# Install Statconn bridge.
# Load the "rcom" package:
install.packages('rcom')
# Load the library 'rcom':
library('rcom') 
```

此时，它会给出一个错误，即您没有安装该`Statconn`库。这很容易解决：

```
install.packages('statconn') 
```

这将自动安装正确版本的 StatConn 桥接器，它是一个独立的 Windows 安装程序。

现在我们已经安装了 Statconn，我们可以在 .NET 文件中打开示例 .NET 项目`C:\Program Files (x86)\statconn\DCOM\samples\Graphics.NET`。此示例 .NET 项目展示了如何使用 R 从 C# WinForms 项目中绘制图形。

ps 还有其他 Python、C++、VBS、jscript 等的示例代码。

## 更新

如果您无法使其正常工作，请尝试`R.Net`，这可能是一个更好的选择，因为 Statconn 有一段时间没有更新，并且非常挑剔，“32 位”/“64 位”/“支持”的混合不够完美R版本'。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-05T21:44:17.953

包 R.net 可能是开始查看快速 google 的结果的好地方。或者，您可以通过创建可从命令行调用的 R 脚本并使用来自 C# 的系统调用来使用更基本的方法。

# asp.net - 编辑上的多选和表单绑定

> ID：14176632
> 
> 赞同：0
> 
> 时间：2013-01-05T21:34:23.923
> 
> 标签：asp.net, asp.net-mvc-4, model-binding

我在编辑模型时遇到问题，该模型集合了链接的其他模型。我正在使用带有模型类的强类型视图：

```
 public class GroupViewModel
   {
       public GroupViewModel()
       {
           Group = new Group();
           Sections = new List<Section>();
       }

       public Group Group { get; set; }
       public IEnumerable<Section> Sections { get; set; }
   } 
```

在控制器的 Edit 方法中，我用正确的数据填充两个字段并将其传递给视图。视图正确显示我的视图模型，出现多选并填充传递的数据，关于组也是如此。

但是在我将它发送回表单提交后，我在 ModelState 中得到了一个错误，例如“*从类型 'System.String' 到类型 'Myapp.Models.Section' 的参数转换失败，因为没有类型转换器可以在这些类型之间进行转换。* "

ASP.NET 是正确处理子集合还是我需要使用旧的 FormCollection 来处理它？

UPD：也许应用程序无法将解析的int转换为Section，因为Section是类并且可能无法从客户端获取某些字段（实际上，多选仅使用Id和Name，但省略了其他字段）？

**UPD1：作为临时解决方案，我将代码更改**为：

```
 public class GroupViewModel
   {
       public GroupViewModel()
       {
           Group = new Group();
           Sections = new List<Section>();
       }

       public Group Group { get; set; }
       public IEnumerable<int> SectionsIds { get; set; }      //here
       public IEnumerable<Section> SectionsDS { get; set; }   //as here
   } 
```

在视图中，我将其绑定为：

```
@Html.ListBoxFor(x => x.SectionIds,
    new MultiSelectList(Model.SectionsDS, "Id", "Name")); 
```

在检索视图模型同步 2 个集合之后 - 手动虚拟导航和 ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:46:14.167

阅读这个 - [http://www.hanselman.com/blog/ASPNETWireFormatForModelBindingToArraysListsCollectionsDictionaries.aspx](http://www.hanselman.com/blog/ASPNETWireFormatForModelBindingToArraysListsCollectionsDictionaries.aspx)

在您看来，类似于：

```
@for (int i = 0; i < items.Count(), i++)
{
   Html.TextBoxFor(m => m[i].Foo1);
   Html.TextBoxFor(m => m[i].Foo2);
} 
```

# assembly - 从输入缓冲区 8086 获取字符串长度

> ID：14176635
> 
> 赞同：1
> 
> 时间：2013-01-05T21:34:24.873
> 
> 标签：assembly, x86

假设您已将一些 ascii 文本读入长度为 255 的字符缓冲区。如何将存储在缓冲区中的 ascii 文本的长度检索到 CX 寄存器中？（已编辑）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:55:30.130

使用 搜索“$” `rep scasb`，然后减去以获取与字符串开头的距离。

```
; warning: untested code.
mov di, offset buffer
mov al, '$'
mov cx, 255
repnz scasb
sub di, offset buffer
mov cx, di 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-29T11:10:14.717

```
; STRLEN
LEA SI,PARA
MOV CX,-1
DO:
    LODSB
    INC CX
    CMP AL,0
    JNE DO 
```

# twitter - 在这条推文中被转发的用户的 twitter4j id

> ID：14176636
> 
> 赞同：1
> 
> 时间：2013-01-05T21:34:28.040
> 
> 标签：twitter, status, twitter4j

我正在使用 twitter4j 库在 twitter 中收集一些数据。有一个名为[Status](http://twitter4j.org/javadoc/index.html)的接口，可用于获取有关推文的各种信息（例如 id、位置、时间、是否是转推……）。我目前有兴趣检索在推文中被转发的用户的 ID。例如，假设约翰转发了萨曼莎，并假设我有约翰的推文；让我们称约翰的推文*为*

我想在代码中做一些事情，比如：

```
Long retweetedUserID = t.getRetweetedUserID(); 
```

我发现 javadoc 非常不清楚，无法正确识别每个函数的含义。

1.  有人知道如何获取被转发的人的用户 ID 吗？

我在这里发布了一个类似的[问题](https://stackoverflow.com/questions/14176546/twitter4j-status-methods-javadoc)，关于我认为与此问题有关的 Status 界面中特定方法的含义。

非常感谢所有帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-05T23:27:41.633

使用方法`getRetweetedStatus()`。您可以将其存储到`Status`变量中，然后使用该`getUser()`方法。总而言之是：

```
for(Status t : results.getTweets())
{
    retweetedStatus = t.getRetweetedStatus();
    User curRTUser = retweetedStatus.getUser();
    curRTUserID = curRTUser.getId();
    //do whatever you want
} 
```

# c++ - c++ segFault问题

> ID：14176638
> 
> 赞同：1
> 
> 时间：2013-01-05T21:34:43.330
> 
> 标签：c++, image-processing, segmentation-fault, openframeworks

我正在尝试做一个程序，通过网络摄像头提要创建各种过滤器，并在 BLOB 分析和其他一些问题上遇到了一些问题。

每次我激活我的草火功能时，我都会收到 segFault。这是我的草火功能的代码：

```
void testApp::grassFire(int mask_Y, int mask_X, unsigned char labelCnt)
{
    blobArray[mask_Y * camWidth + mask_X] = labelCnt;
    if (mask_X + 1 <= camWidth - 1 && blobArray[mask_Y * camWidth + mask_X + 1] == 0)
       grassFire(mask_Y, mask_X + 1, labelCnt);
    if (mask_Y + 1 <= camHeight - 1 && blobArray[(mask_Y + 1) * camWidth + mask_X] == 0)
       grassFire(mask_Y + 1, mask_X, labelCnt);
    if (mask_X - 1 >= 0 && blobArray[mask_Y * camWidth + mask_X - 1] == 0)
       grassFire(mask_Y, mask_X - 1, labelCnt);
    if (mask_Y - 1 >= 0 && blobArray[(mask_Y - 1) * camWidth + mask_X] == 0)
       grassFire(mask_Y - 1, mask_X, labelCnt);
} 
```

它的调用方式是由每帧运行的 switch case**这意味着它在每帧更新时被调用**

函数本身在任何其他范围之外声明。

我知道这是一个非常重的过滤器，它可能会使用大量内存，但与其他一些过滤器相比，它并没有那么糟糕，所以我不知道为什么会出现 segFault。

我还在另一个过滤器上得到了 segFault，这不应该是对内存使用的要求。我在 win 7 的代码块中使用 openframeworks。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:43:06.400

由于您进行了一些检查，因此您似乎无法读取/写入粘贴末尾的内容`blobArray`，因此这意味着您是**[堆栈溢出](http://en.wikipedia.org/wiki/Stack_overflow)**的受害者。

您应该使用调试器并运行回溯，许多调用无法隐藏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:39:49.587

如果您有很多 0 的数组值，则由于函数的高度递归性质，您可能会遇到堆栈溢出。我建议尝试使用[迭代洪水填充算法](https://stackoverflow.com/questions/1257117/does-anyone-have-a-working-non-recursive-floodfill-algorithm-written-in-c)，看看是否能解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T19:52:46.137

我会使用[valgrind](http://valgrind.org/)来检测应用程序。Valgrind 将显示分段错误发生位置的堆栈跟踪。

# objective-c - 更改空间后不显示 NSWindow 翻转动画

> ID：14176647
> 
> 赞同：0
> 
> 时间：2013-01-05T21:35:13.003
> 
> 标签：objective-c, macos, cocoa, animation, nswindow

我有 2 个`NSWindows`（都没有标题栏）在单击状态栏项目后显示在它的正下方。在第一个里面`NSWindow`我有一个按钮来开始翻转动画到第二个`NSWindow`，反之亦然。
这是我用来制作翻转动画的代码：

*   [.h 文件](https://github.com/pcperini/PCSnippets/blob/master/PCSnippets/NSWindow+Flipping.h)
*   [.m 文件](https://github.com/pcperini/PCSnippets/blob/master/PCSnippets/NSWindow+Flipping.m)

我也有这个`windowDidResignKey:`方法，所以当其中一个`NSWindow`失去焦点时，我关闭该方法内的两个窗口。

所以问题来了：

*   我点击状态栏项目并`NSWindow`显示第一个
*   我单击按钮执行翻转动画*（翻转动画显示没有任何问题）*到第二个窗口
*   我从当前空间切换到另一个空间（这会触发`windowDidResignKey:`方法）
*   我再次单击状态栏项目并`NSWindow`显示第二个
*   我单击第二个窗口的按钮以执行到第一个窗口的翻转动画，但动画未正确显示。第二个窗口消失，一两秒钟什么都没有出现，然后第一个窗口出现*（执行动画，只是不可见）*
*   但是，如果我去第一个空间*（我第一次执行第一个翻转动画的地方）*，动画就会正确执行，没有任何错误。

我认为此错误是由以下原因引起的：一个窗口在一个空间中，另一个窗口在另一个空间中（由于`windowDidResignKey:`方法）。
有想法该怎么解决这个吗？我已经尝试更改`NSWindows`为“可以加入所有空间”和“移动到活动空间”，但没有任何成功。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:28:10.763

解决了问题，并更新了库。

容器窗口，负责翻转，需要在空间之间移动，自动移动到活动空间。我只是添加了

```
[flippingContainerWindow setMovable: YES];
[flippingContainerWindow setMovableByWindowBackground: YES];
[flippingContainerWindow setCollectionBehavior: NSWindowCollectionBehaviorMoveToActiveSpace]; 
```

到`+ (NSWindow *)flippingContainerWindow`

# templates - Joomla 模板创建、版本兼容性

> ID：14176650
> 
> 赞同：0
> 
> 时间：2013-01-05T21:35:37.583
> 
> 标签：templates, joomla

我想从头开始创建 Joomla 模板。我在网上找到了一些关于这个主题的课程和教程，比如 Lynda.com 的 Joomla 1.6 创建和编辑模板。

我的问题是，如果我学习展示如何为旧版本的 Joomla（如 1.6）创建模板的教程，它们是否与 2.5 兼容，或者换句话说，结构是否从 1.6 更改为 2.5？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T06:37:08.603

Joomla 1.6、1.7 和 2.5 编码标准相同，但 2.5 比以前的版本具有更多功能。所以回答你的问题，是的，如果你为 Joomla 1.6 创建一个模板，它也将在 2.5 上兼容。

# usb - USB 没有出现在 jfilechooser 中

> ID：14176657
> 
> 赞同：3
> 
> 时间：2013-01-05T21:36:42.377
> 
> 标签：usb, jfilechooser

我想通过 Jfilechooser 从手机设备/USB 上传文件，但手机设备没有出现在打开的对话框中任何机构帮助我，谢谢百万

# alignment - Windows Phone“对齐图像” - 为什么？

> ID：14176661
> 
> 赞同：4
> 
> 时间：2013-01-05T21:37:07.643
> 
> 标签：alignment, windows-phone

我正在为 Windows Phone 8 开发，我设计了我的应用程序，我注意到有一个“分配网格”代码，默认情况下可以在新项目中取消注释。

请看下面的文件中的描述：

```
<!--Uncomment to see an alignment grid to help ensure your controls are
            aligned on common boundaries.  The image has a top margin of -32px to
            account for the System Tray. Set this to 0 (or remove the margin altogether)
            if the System Tray is hidden.

            Before shipping remove this XAML and the image itself.-->
        <!--<Image Source="/Assets/AlignmentGrid.png" VerticalAlignment="Top" Height="800" Width="480" Grid.Row="0" Grid.RowSpan="2" IsHitTestVisible="False" />--> 
```

这是取消注释时显示的背景图像：

![对齐网格](../Images/5e553ad4ae8b5f573f6ab7504946a6b7.png)

我对此感到困惑，为什么图像确定了“共同边界”？当然边界是在开发环境中确定的，IE手机图像的边界？即使在上面显示的图像上，默认的“我的应用程序”文本也不适合“对齐图像”。所以他们不遵守自己的对齐规则？

我应该从这些信息中得到什么？通过将所有内容保持在这些范围内，我将失去一半的屏幕空间！

为什么我必须在这些边界内对齐我的控件，它们最终会不会被显示？我认为 Windows Phone 具有相同的分辨率吗？

**编辑：**

我希望在我的应用程序的最顶部放置一个通知按钮并指示当前登录的用户名，如下所示：

![显示用户名和通知的菜单顶部](../Images/94f67af8197d20f2eb25cd2e1d9eccc6.png)

我可以让这些在网格内的唯一方法是如果我让它们下垂很远，它看起来不会像我想要的那样。

我是否应该将所有内容都放在网格图像中，如果不是，我是否会在我的实施中遇到麻烦？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T10:28:05.493

网格用作指南，以使您的应用程序看起来美观。如果您的文本一直到屏幕边缘，您的应用程序会看起来很丑。框之间的网格用于对齐应用内的元素。你不希望你所有的元素都粘在一起，它们看起来很难看。Windows Phone 开发非常注重设计。

希望有帮助！

歌曲

# joomla - joomla 在模块之间共享变量

> ID：14176666
> 
> 赞同：1
> 
> 时间：2013-01-05T21:38:19.983
> 
> 标签：joomla, joomla2.5

我应该如何在模块中设置一个变量以在下一个（其他）模块中可用？例如：

**mod_hello：**

```
$name = 'David'; 
```

**模组再见：**

```
echo 'Goodbye ' . $name; //Goodbye David 
```

我正在使用 Joomla 2.5，我不能使用会话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T15:47:39.643

我认为你可以通过`JFactory::getSession()`在 Joomla 中使用来做到这一点。

**mod_hello：**

```
$name = 'David';
$session =& JFactory::getSession();
$session->set('name', $name ); 
```

**模组再见：**

```
$session = JFactory::getSession();
$name    = $session->get('name');
echo 'Goodbye ' . $name; //Goodbye David 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T06:41:55.857

我不确定这是可能的，并且从未尝试过，但是如果我错了，请有人纠正我。

我建议做的是将值存储在数据库表中，您可以像这样获取值：

```
$db = JFactory::getDBO();
$query = $db->getQuery(true);
$query->select('*')
->from('#__tablename');
$db->setQuery($query);
$name = $db->loadResult();

echo 'Goodbye ' . $name; //Goodbye David 
```

# haskell - 为什么 Haskell 标准库中没有 <<？

> ID：14176667
> 
> 赞同：12
> 
> 时间：2013-01-05T21:38:22.260
> 
> 标签：haskell, monads

该类`Monad`定义了一个`>>`方法，该方法对两个单子操作进行排序：

```
>> :: Monad m => m a -> m b -> m b 
```

绑定运算符`>>=`具有等效的翻转参数，`=<<`; 一元函数组合（'fish'）运算符`>=>`和`<=<`. 不过，似乎没有`<<`（经过几分钟的 Hoogling）。为什么是这样？

编辑：我知道这没什么大不了的。我只是喜欢某些代码行与左指向运算符的外观。`x <- doSomething =<< doSomethingElse`只是看起来更好，箭头都朝着相同的方向，比`x <- doSomethingElse >>= doSomething`。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-05T21:48:41.833

据我所知，没有充分的理由。请注意，您`Monad`也应该是 , 的实例`Applicative`，因此您可以使用`<*`and`*>`代替作为您的排序工具。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-04-10T20:20:42.223

这是一个替代答案，因为最近提出了一个类似的问题并将其标记为重复。事实证明，**根本不清楚`(<<)`应该是什么定义！** 虽然在对旧答案的评论中提到了这个问题，但我认为这里没有完全清楚地表明存在重大问题。

显然，定义的两种合理可能性是：

```
(<<) :: Monad m => m a -> m b -> m a
p << q = do {x <- p; q; return x}   -- definition #1
p << q = do {q; p}                  -- definition #2 
```

类比应用运算符`(<*)`and `(*>)`，很明显 new`(<<)`运算符应该保留从左到右的副作用顺序，并且只具有切换使用哪个动作的返回值的效果，因此定义 #1 显然是正确的。这具有理想的属性，`<<`并且`<*`将是（行为良好的）monad 的同义词，就像`>>`和`*>`是同义词一样，因此不足为奇。

当然，与`=<<`and类比`>>=`，很明显翻转大于号的方向应该具有翻转参数的效果，因此定义 #2 显然是正确的。这具有理想的特性，即一元操作的管道：

```
u >>= v >>= w >> x >>= y 
```

可以通过翻转运算符来反转：

```
y =<< x << w =<< v =<< u 
```

这也保留了 Kleisli 运算符的身份：

```
(f >=> g) x  ===  f x >>= g
(f <=< g) x  ===  f =<< g x 
```

这当然*看起来*他们应该持有。

无论如何，我不知道这是否是原来的原因`(<<)`被遗漏了。（可能不会，因为该决定会早于应用运算符的引入，所以人们会认为“定义＃2”是唯一的可能性），但我很确定现在这将是一个症结所在，因为不同的行为考虑到人们期望 applicative`(<<)`和`(<*)`monad 操作之间的紧密联系，这将是非常出乎意料的。

# php - 选择在缺少最后一天的两个日期之间

> ID：14176670
> 
> 赞同：0
> 
> 时间：2013-01-05T21:38:39.903
> 
> 标签：php, mysql, select, between

我正在从 mysql 中选择一些数据，我想我错过了最后一天。

我的样本数据是：

```
2012-11-30 18:23:20,  
2012-11-30 18:24:54,  
2012-11-30 18:28:03,  
2012-12-01 11:50:36,  
2012-12-07 00:22:44 
```

询问

```
SELECT * FROM  `table` WHERE TIMESTAMP BETWEEN  '2012-11-30' AND  '2012-12-07' 
```

结果是我所有的示例数据，但缺少**2012-12-07**日期。任何人都可以解释我怎么能得到它吗？除了在当天添加 +1 之外，还有其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T21:39:57.263

像这样做：

```
SELECT * FROM  `table` 
WHERE TIMESTAMP BETWEEN  '2012-11-30 00:00:00' AND  '2012-12-07 23:59:59' 
```

这样您就可以使用开始日期和结束日期捕获所有记录。

# c# - SSL 在使用 fiddler 修改请求时收到超过最大允许长度的记录

> ID：14176673
> 
> 赞同：7
> 
> 时间：2013-01-05T21:38:56.130
> 
> 标签：c#, ssl, fiddler, fiddlercore

我正在尝试使用 FiddlerCore 实现系统内 SSL 服务器：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace fiddlerCoreTest
{
    using System.IO;
    using System.Threading;
    using Fiddler;

    class Program
    {
        static Proxy oSecureEndpoint;
        static string sSecureEndpointHostname = "localhost";
        static int iSecureEndpointPort = 7777;

        static void Main(string[] args)
        {
            //var tt = Fiddler.CertMaker.GetRootCertificate().GetRawCertData();
            //File.WriteAllBytes("root.crt",tt);

            Fiddler.FiddlerApplication.BeforeRequest += delegate(Fiddler.Session oS)
            {
                oS.bBufferResponse = false;               

                if ((oS.hostname == sSecureEndpointHostname)&&oS.port==7777)
                {
                    oS.utilCreateResponseAndBypassServer();
                    oS.oResponse.headers.HTTPResponseStatus = "200 Ok";
                    oS.oResponse["Content-Type"] = "text/html; charset=UTF-8";
                    oS.oResponse["Cache-Control"] = "private, max-age=0";
                    oS.utilSetResponseBody("<html><body>Request for httpS://" + sSecureEndpointHostname + ":" + iSecureEndpointPort.ToString() + " received. Your request was:<br /><plaintext>" + oS.oRequest.headers.ToString());
                }
            };

            FiddlerCoreStartupFlags oFCSF = FiddlerCoreStartupFlags.Default;
            oFCSF = (oFCSF & ~FiddlerCoreStartupFlags.RegisterAsSystemProxy);

            Fiddler.FiddlerApplication.Startup(8877, oFCSF);

            oSecureEndpoint = FiddlerApplication.CreateProxyEndpoint(iSecureEndpointPort, true, sSecureEndpointHostname);
            if (null != oSecureEndpoint)
            {
                FiddlerApplication.Log.LogFormat("Created secure end point listening on port {0}, using a HTTPS certificate for '{1}'", iSecureEndpointPort, sSecureEndpointHostname);
            }

            Console.WriteLine("Press any key to exit");

            Console.ReadKey();
        }
    }
} 
```

在 firefox 中， GET`http://localhost:7777/`工作正常，但是当我 GET 时`https://localhost:7777/`，firefox 报告以下错误：

![SSL 收到超过最大允许长度的记录](../Images/c0908afb8322e5692d4718a18fa4c788.png)

为什么我会得到这个，我该如何解决？

**更新** 仅当我使用 fiddler 作为 firefox 的代理时才会发生这种情况。当我删除提琴手代理时，我可以访问`https://localhost:7777/`. 但是，我也希望能够`https://localhost:7777/`通过代理访问

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-03T17:50:29.663

这种情况下的问题是您要处理此流量两次：

首先，浏览器向端口 8888 发送一个 CONNECT 说：“请给我一个到端口 7777 的 TCP/IP 隧道”，然后在 Fiddler 说“好的，我们会这样做”之后，客户端通过该隧道发送一个 HTTPS 请求到端口7777。

这里的问题是您正在修改 CONNECT 响应并返回 HTML，而不是允许来自端口 7777 的 HTTPS 握手通过。

解决此问题的最简单方法是将您的 BeforeRequest 代码更改为以下内容：

```
if ( (oS.hostname == sSecureEndpointHostname) && (oS.port==7777)
    && !oS.HTTPMethodIs("CONNECT")) { 
```

执行此操作后，您的 CONNECT 隧道将不再受到破坏，并且 HTTPS 握手将成功。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T01:27:59.750

HTTPS 流量是加密的，fiddler 作为 Web 调试器代理无法解密/分析通过 fiddler 发送的数据包数据。它使用 MITM 攻击来解密通过提琴手发送的 SSL 流量，请参见此处： [http ://www.fiddler2.com/fiddler/help/httpsdecryption.asp](http://www.fiddler2.com/fiddler/help/httpsdecryption.asp)

所以你必须在 fiddler 中启用 SSL 选项，然后重新检查它。如果不起作用，请尝试向 fiddler 提供手动 MITM 证书。

# c++ - 如何使用像直接访问文件这样的内存：fread 和 fwrite 函数的类似物？

> ID：14176676
> 
> 赞同：0
> 
> 时间：2013-01-05T21:39:12.060
> 
> 标签：c++, memory, file-io, fwrite, fread

我需要在我的应用程序中使用内存缓冲区，例如直接访问文件。是否存在 fread 和 fwrite 函数的类似物？C++

我在内存中有数据缓冲区。我想要：在这个缓冲区中读取数据、写入数据和移动指针。像文件，但有内存和没有文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:12:27.963

我认为您的意思是内存映射文件。C++ 标准不支持它，但 Boost 在[这里](http://www.boost.org/doc/libs/1_52_0/libs/iostreams/doc/classes/mapped_file.html)有一个可移植的实现。

基本上，它允许您通过指针访问文件。操作系统将负责缓存，并且通常非常有效。

# wpf - 当值使用绑定时样式被覆盖

> ID：14176677
> 
> 赞同：1
> 
> 时间：2013-01-05T21:39:19.413
> 
> 标签：wpf, xaml, binding, styles

我有两种样式设置在我的`UserControl.Resources`

> ```
>  <Style TargetType="{x:Type TextBlock}">
>         <Setter Property="Foreground" Value="white" />
>     </Style>
>     <Style TargetType="{x:Type Label}">
>         <Setter Property="Foreground" Value="white" />
>     </Style> 
> ```

因此，在我的（并注意我将其余部分切掉）中，我将应用白色文本，而`DataTemplate`无需更改每个元素的属性。`Label``TextBlock`

```
<DataTemplate x:Key="FileTransferItemTemplate">
        <StackPanel Orientation="Vertical">
            <StackPanel Orientation="Horizontal">
                <Label Content="Transferring With: " />
                <TextBlock Text="{Binding Path=OtherUserName, Mode=TwoWay}" />
            </StackPanel>
</DataTemplate> 
```

但是会发生什么（这让我做了一个漫长的噩梦，我认为我的数据绑定不正确，因为我看不到任何更改），当数据被绑定时，前景色默认为黑色。我的数据绑定文本在黑色背景上是黑色的，我什至没有意识到最长的时间。

我可以覆盖它的唯一方法是手动设置`Foreground="White"`. `TextBlock`颜色的`Label`效果很好，因为它不是数据绑定的。

为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T22:25:29.560

该问题与绑定无关。似乎从 DataTemplate 内部查找外部定义的默认样式仅适用于从 Control 派生的元素。由于 TextBlock 不是从 Control 派生的，因此找不到您的默认样式。

[本页](http://www.11011.net/archives/000692.html)引用了微软给出的以下两条声明：

> 这种行为是“设计使然”，这就是原因。模板被视为封装边界。这些模板生成的元素属于此边界。并在此边界处停止查找具有匹配 TargetType 的样式。因此，通过模板生成的复制中的 TextBlock 不会选择有问题的样式。而在模板外部定义的 TextBlock 则可以。解决此问题的一种方法是为样式指定一个显式名称，并通过该名称在模板内的 TextBlock 上引用该样式。

和

> 在查找不是 Control 子类型的元素的隐式样式时，模板被视为封装边界。

# c++ - 从进程名称中获取进程的ID

> ID：14176683
> 
> 赞同：0
> 
> 时间：2013-01-05T21:39:47.980
> 
> 标签：c++

我需要找到一个进程的 ID，我只有它的名称，我知道一次只有 1 个实例会运行，所以多个进程与我正在寻找的同名进程不会有问题为了。

如果有人能解释我如何从进程的名称中获取进程的 ID，我将不胜感激 - 并且代码示例会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:51:15.457

从你的其他问题来看（`RegSetValueEx`在标题中有点明显），我假设你在 Windows 上。对于纯 Windows API 解决方案，您可以使用 Toolhelp32 API 来查看正在运行的进程的快照，并将它们的名称与您要查找的名称进行比较。您只有一个名称的注释，但将来或对其他人来说，拥有该名称的所有 PID 可能会有所帮助，所以我会这样做：

```
std::vector<DWORD> pids;

HANDLE snap = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0); //all processes

PROCESSENTRY32W entry; //current process
entry.dwSize = sizeof entry;

if (!Process32FirstW(snap, &entry)) { //start with the first in snapshot
    return 0;
}

do {
    if (std::wstring(entry.szExeFile) == wantedProcessName) {
        pids.emplace_back(entry.th32ProcessID); //name matches; add to list
    }
} while (Process32NextW(snap, &entry)); //keep going until end of snapshot 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:52:23.260

在 *nix 环境中，`man 3 sysctl`.

# c++ - 确保正确释放 C++ 对象

> ID：14176686
> 
> 赞同：0
> 
> 时间：2013-01-05T21:40:01.733
> 
> 标签：c++, oop

我开始自学 C++，如何在没有垃圾收集器的情况下处理对象让我有些困惑。这是我正在尝试做的一个简单案例：

```
A* a;
B b = new B(a);    // Note that B is a derived class of A
a = &b;

while (a != NULL)
{
    (*a).run();
} 
```

这一切都按我的预期工作。我遇到的问题是在 B 的 run() 方法中，我想做类似的事情：

```
C c = new C(a);  // a is the same pointer as above, that has been stored 
                 // and C another derived class from A
a = &c; 
```

然后让 run() 退出。然后，第一个块中的 while 循环将调用新对象上的 run()。我的问题是，如何确保正确释放原始 b 的内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:44:29.750

每当您面临动态内存分配和重要的所有权语义时，智能指针通常是确保正确性的好方法。

例如，参见[`std::shared_ptr`](http://en.cppreference.com/w/cpp/memory/shared_ptr)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T21:45:34.677

你可以`std::shared_ptr`在这种情况下使用。如果两个类的成员需要指向同一个对象，那么您可以将它们都设为`shared_ptr`。你通常会这样做，但是如果在这样做的时候，如果你要创建循环依赖，那么要打破这种循环依赖，你需要`std::weak_ptr`.

这是`std::shared_ptr`和的示例`std::weak_ptr`。

**错误代码（循环依赖）：**

```
struct B;

struct A
{
   std::shared_ptr<B> bp;
}

struct B
{
   std::shared_ptr<A> ba;  //this creates a cyclic dependency.
} 
```

**正确代码（非循环）：**

```
struct B;

struct A
{
   std::shared_ptr<B> bp;
}

struct B
{
   std::weak_ptr<A> ba;  //break cyclic dependency with std::weak_ptr
} 
```

# c++ - 结构前向声明和复制构造函数

> ID：14176687
> 
> 赞同：0
> 
> 时间：2013-01-05T21:40:14.363
> 
> 标签：c++

我的抽象参考计数器类：

```
template<class T>
class ReferenceCounter
{
public:

    ReferenceCounter();
    ~ReferenceCounter();

    void addRef();
    void release();

    uint32 getCountReferences() const;

protected:
    int32* pCountReferences;

    virtual void destroyObject() = 0;
    virtual void shallowCopy(const T& rhs) = 0;
};

template<class T>
inline ReferenceCounter<T>::ReferenceCounter() 
{
    pCountReferences = new int32;
    *pCountReferences = 1;
}

template<class T>
inline ReferenceCounter<T>::~ReferenceCounter() 
{
    if(pCountReferences != NULL && *pCountReferences == 0)
    {
        delete pCountReferences;
        pCountReferences = NULL;
    }
}

template<class T>
inline void ReferenceCounter<T>::addRef()
{
    debug_assert((*pCountReferences) >= 0, "Incorrect value of count references");
    ++(*pCountReferences);
}

template<class T>
inline void ReferenceCounter<T>::release()
{
    debug_assert((*pCountReferences) > 0, "Incorrect value of count references");
    (*pCountReferences)--;

    if(pCountReferences != NULL && *pCountReferences == 0)
    {
        destroyObject();
    }
}

template<class T>
inline uint32 ReferenceCounter<T>::getCountReferences() const
{
    return *pCountReferences;
} 
```

这是我的智能指针：

```
template<class T>
class SmartPtr
{
public:
    SmartPtr();
    SmartPtr(T* pInst);
    SmartPtr(const SmartPtr<T>& rhs);
    ~SmartPtr();

    void operator = (const SmartPtr<T>& rhs);
    T* operator -> () const;
    T* getData() const;

    bool isNULL() const;

private:
    T* pInst;
};

template<class T>
SmartPtr<T>::SmartPtr() : pInst(NULL) {}

template<class T>
SmartPtr<T>::SmartPtr(T* pInst) : pInst(pInst) {}

template<class T>
SmartPtr<T>::~SmartPtr() 
{
    if(pInst != NULL)
    {
        pInst->release();
    }
}

template<class T>
SmartPtr<T>::SmartPtr(const SmartPtr<T>& rhs)
{
    this->pInst = rhs.pInst;
    if(pInst != NULL)
    {
        pInst->addRef();
    }
}

template<class T>
void SmartPtr<T>::operator= (const SmartPtr<T>& rhs)
{
    this->pInst = rhs.pInst;
    if(pInst != NULL)
    {
        pInst->addRef();
    }
}

template<class T>
T* SmartPtr<T>::operator->() const
{
    return pInst;
}

template<class T>
T* SmartPtr<T>::getData() const
{
    return pInst;
}

template<class T>
bool SmartPtr<T>::isNULL() const
{
    return pInst == NULL;
} 
```

有代码测试：

```
#include <iostream>
#include "ReferenceCounter.h"
#include "SmartPtr.h"

using namespace std;

class B;

class A : public ReferenceCounter<A>
{
public:
    A();
    A(const A& rhs);
    ~A();

    SmartPtr<B> getB();
    void operator = (const A& rhs);

    private:
    void destroyObject();
    void shallowCopy(const A& rhs);
 };

class B : public ReferenceCounter<B>
{
private:
    void destroyObject() {} ;
    void shallowCopy(const B& rhs) {};
};

A::A()
{
    cout << "Create object" << endl;
}

A::A(const A& rhs)
{
    shallowCopy(rhs);
    addRef();
    cout << "copy constructor " << endl;
}

A::~A()
{
    release();
}

void A::destroyObject()
{
    cout << "destroy" << endl;
}

void A::shallowCopy(const A& rhs)
{
    this->pCountReferences = rhs.pCountReferences;
}

void A::operator = (const A& rhs)
{
    shallowCopy(rhs);
    addRef();
    cout << "operator = " << endl;
}

SmartPtr<B> A::getB()
{
    return SmartPtr<B>(new B());
}

SmartPtr<A> getA()
{
    SmartPtr<A> a(new A());
    return a;
}

int main()
{
    getA();
    return 0;
} 
```

当我调试这段代码时，这段代码可以工作，但下面不调用智能指针的复制构造函数。下面会出现什么问题？？

```
int main()
{
   A a;
   a.getB();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:47:45.960

[有关返回值优化](http://en.wikipedia.org/wiki/Return_value_optimization)，请参见此处。

允许编译器消除返回的临时对象的副本。

使用 C++11，还可以移动对象。请参阅[什么是移动语义？](https://stackoverflow.com/q/3106110/1741542)解释一下。

*更新*：

这根本不是问题，只是编译器优化。

只要您的构造函数和析构函数中没有发生什么特别的事情，就没有必要阻止这种优化。您应该允许这样做，因为它通过跳过一个构造函数和一个析构函数调用使您的程序运行得更快。

# python - PostgreSQL/Apache 上的 Python/Django 和 HTML/CSS/JS/jQuery？

> ID：14176688
> 
> 赞同：2
> 
> 时间：2013-01-05T21:40:17.950
> 
> 标签：python, html, apache, postgresql

我在 Codecademy 上完成了 HTML/CSS/JS/jQuery/Python 的课程，从那时起，我一直在练习使用 HTML/CSS/JS/jQuery 进行客户端编程，遵循文档以及使用 Notepad++ 和 Chrome 的教程。

我决定是时候开始练习服务器端编程了，这样我就可以将客户端编程集成到一个功能齐全的网站中。因此，[我在 Yahoo Answers 上询问](http://uk.answers.yahoo.com/question/index;_ylt=AlQUkydPP2ybi_IyvwYk0BmMJ3RG;_ylv=3?qid=20130105104227AA0oNJI)了练习服务器端编程的最佳方法，从答案看来，最好的方法是将我的一台旧 PC 设置为服务器。同一个人还告诉我，PostgreSQL 不可用（“很少有真正的服务器会允许它”），Apache 是为 PHP/MySQL 设计的，Python 不与 HTML 一起使用。

他说我需要重新学习，所以我现在很困惑。我认为 Python/Ruby/PERL 等可以与 PHP 互换，只是做同一件事的不同方式？PostgreSQL 也一样，在我看来它可以与 MySQL 互换？我什至还没有使用过 Python（除了在 Codecademy 上），因为我还没有弄清楚如何使用它，但我真的很热衷于将它用于 Web 开发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T14:16:58.800

> 从答案看来，最好的方法就是将我的一台旧电脑设置为服务器

看在 $DEITY 的份上，请不要那样做。如果您刚刚开始，您不想学习服务器管理、从头开始安装各种工具（SSH、FTP、Apache、MySQL 等）、设置路由器和静态 IP 地址、设置防火墙/iptables、同时设置域名等。同时学习所有这些将是压倒性的。

我建议使用[良好的共享主机](https://code.djangoproject.com/wiki/DjangoFriendlyWebHosts)来减轻痛苦。

> PostgreSQL 不可用（“很少有真正的服务器会允许它”？）；Apache 是为 PHP/MySQL 设计的；并且 Python 不与 html 一起使用

谁告诉你的，完全没有头绪。虽然 PostgreSQL 不如 MySQL 流行，但大多数严肃的虚拟主机都支持它；Apache 是最灵活的 Web 服务器之一，它支持非常广泛的 Web 技术，而不仅仅是 mod_php；并且声称 Python 不与 HTML 一起[使用显然是不真实的](http://wiki.python.org/moin/WebProgramming)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T21:46:50.297

除了安装 linux 和设置自己的服务器盒之外，您还可以在 Django 网站上找到有关所有这些内容的指导。

请忽略雅虎的回答。

> Django 支持许多不同的数据库服务器，并得到 PostgreSQL、MySQL、Oracle 和 SQLite 的正式支持。

[https://docs.djangoproject.com/en/1.4/topics/install/#get-your-database-running](https://docs.djangoproject.com/en/1.4/topics/install/#get-your-database-running)

# python - 如何将 pygame Surface 转换为 PIL 图像？

> ID：14176689
> 
> 赞同：9
> 
> 时间：2013-01-05T21:40:29.447
> 
> 标签：python, python-2.7, python-imaging-library, pygame

我正在使用 PIL 透视地转换屏幕的一部分。原始图像数据是一个 pygame Surface，需要转换为 PIL 图像。

因此，我找到了为此目的而存在的 pygame 的 tostring 函数。

然而结果看起来很奇怪（见附件截图）。这段代码出了什么问题：

```
rImage = pygame.Surface((1024,768))

#draw something to the Surface
sprite = pygame.sprite.RenderPlain((playboard,))
sprite.draw(rImage)

pil_string_image = pygame.image.tostring(rImage, "RGBA",False)
pil_image = Image.fromstring("RGBA",(660,660),pil_string_image) 
```

我究竟做错了什么？

![pygame表面到pil图像转换](../Images/9c789f7cf6d9ffeec15418681e21afce.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-06T00:17:00.613

As I noted in a comment, [pygame documentation](http://www.pygame.org/docs/ref/image.html#pygame.image.fromstring) for `pygame.image.fromstring(string, size, format, flipped=False)` says “The size and format image must compute the exact same size as the passed string buffer. Otherwise an exception will be raised”. Thus, using (1024,768) in place of (660,660), or vice versa – in general, the same dimensions for the two calls – is more likely to work. (I say “more likely to work” instead of “will work” because of I didn't test any cases.)

The reason for suspecting a problem like this: The strange look of part of the image resembles a display screen which is set to a raster rate it can't synchronize; ie, lines of the image start displaying at points other than at the left margin; in this case because of image line lengths being longer than display line lengths. I'm assuming the snowflakes are sprites, generated separately from the distorted image.

# .net - 什么是相当于 System.Windows.Forms.SendKeys 的“鼠标”？

> ID：14176690
> 
> 赞同：3
> 
> 时间：2013-01-05T21:40:31.303
> 
> 标签：.net, winforms, io

我正在寻找一个 .NET 类，它将执行 SendKeys 的功能，但用于鼠标输入。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T21:45:22.197

您可以使用[该](http://inputsimulator.codeplex.com/)开源项目来模拟鼠标或键盘。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-05T21:45:29.203

你不能通过我知道的 System.Windows.Forms 来做到这一点。我在[mouse_event方面取得了一些成功](http://www.pinvoke.net/default.aspx/user32/mouse_event.html)

# javascript - 如何在数据表中获取当前呈现的元素

> ID：14176696
> 
> 赞同：1
> 
> 时间：2013-01-05T21:40:47.423
> 
> 标签：javascript, jquery, datatables

我需要根据元素位置更改单元格的渲染，而不更改数据，在我找到的文档`mData`和`mRender`选项中，我尝试使用`fnRender`（已弃用），但它给了我位置，但在渲染时更改了表格中的数据，所以我想知道如果这里有什么方法可以在渲染时获取单元格位置，或者我应该在每次更改后自己重新渲染表格？

以下代码说明了我的需求：

```
$(document).ready( function() {
  var oTable = $('#example').dataTable( {
    "aoColumnDefs": [ {
      "aTargets": ['_all'],
      "mRender": function ( data, type, full ) 
      {
        if (type!='display') return data;
        //HOW to get current cell indexes or DOM element here ?
        console.log(this,data,type,full);
        return data+' ttt';
      }
    } ]
  } );

  $('#example > tbody > tr').on('click','td',function() {
   console.log(this);
   var pos=oTable.fnGetPosition(this);
   var value=oTable.fnGetData(this);
   oTable.fnUpdate(value.split("").reverse().join(""),pos[0],pos[2]);
  });

  var button=$('<button>').text('clickme');
  button.click(function() { console.log(oTable.fnGetData());});
  $('body').append(button);
}); 
```

[http://live.datatables.net/enirid/3/edit](http://live.datatables.net/enirid/3/edit)

使用 fnRender 的示例：

```
$(document).ready( function() {
  var oTable = $('#example').dataTable( {
    "aoColumnDefs": [ {
      "aTargets": ['_all'],
      "fnRender": function ( obj, data ) 
      {
        console.log(obj,data);
        var col=obj.iDataColumn;
        //HOW to change display here without changing data of table
        return data+' '+col;
      }
    } ]
  } );

   $('#example > tbody > tr').on('click','td',function() {
   console.log(this);
   var pos=oTable.fnGetPosition(this);
   var value=oTable.fnGetData(this);
   oTable.fnUpdate(value.split("").reverse().join(""),pos[0],pos[2]);
  });

  var button=$('<button>').text('clickme');
  button.click(function() { console.log(oTable.fnGetData());});
  $('body').append(button);
}); 
```

[http://live.datatables.net/opubaj/edit](http://live.datatables.net/opubaj/edit)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T11:35:55.250

试试[`fnCreatedCell`](http://datatables.net/ref#fnCreatedCell)。附上从 datatables.net 提供的示例代码片段：

```
$(document).ready( function() {
  $('#example').dataTable( {
    "aoColumnDefs": [ {
      "aTargets": [3],
      "fnCreatedCell": function (nTd, sData, oData, iRow, iCol) {
        if ( sData == "1.7" ) {
          $(nTd).css('color', 'blue')
        }
      }
    } ]
  });
} ); 
```

# java - JavaFX 2 设置/获取光标位置

> ID：14176702
> 
> 赞同：4
> 
> 时间：2013-01-05T21:41:36.293
> 
> 标签：java, position, javafx-2, mouse-cursor

如何在 JavaFX 2 中设置/获取光标的位置？

我厌倦了用谷歌搜索答案，但没有发现任何有用的东西。我所能做的就是设置光标的样式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T09:20:06.130

```
import java.awt.MouseInfo;
// get the mouse's position
Point p = MouseInfo.getPointerInfo().getLocation();

import java.awt.Robot;
// set the mouse position
new Robot().mouseMove( x, y ); 
```

PS。不要使用 com.sun.* 类（除非您使用的是 Mac，请参见下文）。

PS2。由于似乎将在 JavaFX8 中修复的 JavaFX 问题，您不能在 Mac 中使用 java.awt 类，正如 Alexander Kirov 所指出的，在 Mac 中您仍然需要像这样使用 com.sun 类：

```
// workaround for Mac only
com.sun.glass.ui.Robot robot =
       com.sun.glass.ui.Application.GetApplication().createRobot();

// getPosition of the mouse in Mac
int x = robot.getMouseX(); 
int y = robot.getMouseY(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-05T22:08:27.580

您可以为此目的使用机器人：

AWT机器人：

[http://docs.oracle.com/javase/1.5.0/docs/api/java/awt/Robot.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/awt/Robot.html)

或玻璃机器人：

com.sun.glass.ui.Robot；可以通过以下方式创建：com.sun.glass.ui.Application.GetApplication().createRobot();

要获取光标位置，请参阅有关 java.awt.MouseInfo 的其他帖子

# iphone - UITextView 不会调整大小

> ID：14176705
> 
> 赞同：0
> 
> 时间：2013-01-05T21:42:03.030
> 
> 标签：iphone, ios, ios6

我尝试将 UITextView（在 tableViewCell 内）调整为内容大小。但它根本不会改变它的高度。我什至改变了 UITableViewCell 的高度。有什么问题？

```
- (void) setTextViewContents: (NSString*) string
{
    [textView setText:string];

    CGRect frame2 = self.frame;
    frame2.size.height = 10000;
    self.frame = frame2;

    /* resize the view */
    CGRect frame = textView.frame;
    frame.size.height = textView.contentSize.height+60;
    textView.frame = frame; 
```

该字符串确实出现在视图上，但大小没有改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T22:26:13.503

尝试调用该`-[UIView sizeToFit]`方法。

# php - 链表不保存数据成员

> ID：14176716
> 
> 赞同：0
> 
> 时间：2013-01-05T21:43:41.493
> 
> 标签：php, data-structures, web, linked-list

使用 PHP 5.3.10，我创建了一个链接列表类，并试图保存一个足球运动员列表。

调用该`add`函数后，该对象似乎从未保留任何信息。`var_dump($playerList)`为我的头指针和尾指针返回 NULL。或者，如果我将其替换为，则无论我将count 语句`var_dump($playerList->count)`放在何处，它都不会打印任何内容。`var_dump`

我已经阅读了手册，但在我的语法中找不到错误。我的直觉告诉我`mysql_fetch_array`正在做一些时髦的事情。如下所述，我的测试表明，当我调用`playerList->add()`. 无论如何，这是我的简单代码：

```
/* Populates lists with available players. */
function populateList($sql)
{
    $playerList = new PlayerList();
    while ($row = mysql_fetch_array($sql, MYSQL_NUM)) 
    {
        $playerList->add(new Player($row[0], $row[1], $row[2], $row[3], $row[4]));
    }
    var_dump($playerList);
} 
```

还有我的链表类：

```
include 'PlayerNode.php';

class PlayerList
{
    public $head;
    public $tail;
    public $count;

    function PlayerList()
    {
        $head = null;
        $tail = null;
        $count = 0;
    }

    function add($player)
    {
        $count ++;            
        $node = new PlayerNode($player);

        //First time in
        if ($head == null)
        {
            $head = $node;
            $tail = $node;
            $head->nextPtr = null;
        }
        // All other times
        else
        {
            $tail->nextPtr = $node;
            $tail = $node;
            $node->nextPtr = null;
        }
        $count++;
    }               
} 
```

我可以`var_dump($node)`在链表类中放置和回显语句并观察它`PlayerNode`是否正常工作。

但是，另一个奇怪的观察......`if($head==null)`总是评估为真。这可能有关系吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:01:59.333

**在单链表的头部插入：** 我们可以很容易地将元素插入到列表的头部。那么我们怎么做呢？创建一个新节点，设置新节点的next指向当前头节点，设置头变量（在类中）指向新节点。即使链接列表为空，此方法也有效。请注意，在我们发送头变量指向新节点之前，我们将新节点的下一个指向头节点。

**在单链表的尾部插入：** 我们也可以很容易地在链表的尾部插入元素，只要我们为链表的尾节点保留一个引用。创建新节点 设置新节点的next为null，设置尾节点的next指向新节点，设置tail变量指向新元素。请注意，在更改 tail 变量以指向新节点之前，我们设置了前一个尾节点的下一个。

在所有其他时间将新节点添加到头部或尾部。

```
 // All other times if head
                else{
                        $temp = $head;
                        $head = $node;
                        $node->nextPtr = $temp;
                        count ++; 
                    } 
```

# windows-8 - 创建新 WinRT 视图时指定视图提供程序类型

> ID：14176717
> 
> 赞同：4
> 
> 时间：2013-01-05T21:43:46.897
> 
> 标签：windows-8, windows-runtime

试图了解 WinRT 应用程序中多个视图的潜在用途。我可以创建一个新视图，该视图在其自己的调度程序线程上运行，并且可以使用`CoreApplication.CreateNewView`. 我不知道如何指定如何在第一个参数中传递视图提供程序。如果我在 C# 中有一个裸应用程序（尽管如果我使用 也是如此`Application.Start`）：

```
public class Program
{
    static void Main()
    {
        CoreApplication.Run(new MyViewSource());
    }
}
public class MyViewSource : IFrameworkViewSource
{
    public IFrameworkView CreateView()
    {
        return new MyView();
    }
}
public class MyView : IFrameworkView
{
    // ...
} 
```

如果我想使用当前视图提供者创建一个新视图（我想是创建当前活动视图的那个），我可以这样做

```
CoreApplication.CreateNewView("", "foo"); 
```

API 文档说第一个参数是“新视图的视图提供者的类 ID”。那指的是什么？我试过的任何东西都给出了以下内容：

> 附加信息：未注册类（HRESULT 异常：0x80040154 > >(REGDB_E_CLASSNOTREG)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T16:10:38.117

第一个参数是新视图类的名称。

> 新视图的视图提供者的类 ID。如果此参数为 null，则使用当前视图提供程序。

如果您将第一个参数留空，那么您的新视图将具有当前视图类表示。

所以如果你想创建一个带有cutsom类的新视图，你必须创建这个类并放入第一个参数。

像这样：

```
public class MySecondView : IFrameworkView
{
// ...
} 
```

接着：

```
CoreApplication.CreateNewView("MySecondView", "foo"); 
```

让我知道此操作是否成功，因为我不确定我的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-06T08:44:12.317

检查下面的链接以获得完美的示例。

参考： [MSDN Microsoft Multi Windows For An App](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/dn582023.aspx)

[在 Windows 应用商店应用程序中使用多个视图的](http://www.softaware.at/Aktuelles/2014/02/02/Using-Multiple-Views-in-Windows-Store-Apps)示例代码示例

# node.js - 带有参数或标准输入的 node.js 脚本

> ID：14176718
> 
> 赞同：0
> 
> 时间：2013-01-05T21:43:51.713
> 
> 标签：node.js, asynchronous

程序必须得到 2 个变量。例如，它必须是登录名和密码。脚本可以从命令行接收它（登录或使用密码登录）。如果没有一个命令行参数未填写，用户必须使用标准输入输入。如果用户只输入一个 agrument - 我需要询问用户第二个。如果用户输入了两个参数 - 无事可做（执行一些函数）。

问题是：如何正确地在 node.js（异步）上构建程序。

在某些事件或什么？

我写了这段代码，我该如何改进呢？

```
if(process.getuid() != 0) {
    console.log('Error!');
    console.log('Required root privileges');
    process.exit(1);
}

var getUser = function(user, callback) {
    if( user == undefined ) {
        ask('Enter user', /.+/, function(user) {
            callback(user, process.argv[3]);
        });
    } else {
        callback(user, process.argv[3]);
    }
}

var getPassword = function(user, password) {
    if( password == undefined ) {
        ask('Enter password', /.+/, function(password) {
            addUser(user, password);
        });
    } else {
        addUser(user, password);
    }
}

function addUser(user, password) {
    console.log('Adding user:');
    console.log(user);
    console.log(password);

    process.exit(0);
}

var user = getUser(process.argv[2], getPassword);

function ask(question, format, callback) {
    var stdin = process.stdin, stdout = process.stdout;

    stdin.resume();
    stdout.write(question + ": ");

    stdin.once('data', function(data) {
        data = data.toString().trim();

        if (format.test(data)) {
            callback(data);
        } else {
            stdout.write("It should match: "+ format +"\n");
            ask(question, format, callback);
        }
    });
} 
```

# matlab - 最小化 L1-Regularized 系统，收敛于非最小位置？

> ID：14176721
> 
> 赞同：5
> 
> 时间：2013-01-05T21:44:01.900
> 
> 标签：matlab, optimization, machine-learning, minimization, convex-optimization

这是我在 stackoverflow 上的第一篇文章，所以如果这不是正确的区域，我深表歉意。我正在努力最小化 L1 正则化系统。

这个周末是我第一次深入优化，我有一个基本的线性系统 Y = X*B，X 是一个 n×p 矩阵，B 是一个 p×1 模型系数向量，Y 是一个 n× -1 输出向量。

我试图找到模型系数，我已经实现了梯度下降和坐标下降算法来最小化 L1 正则化系统。为了找到我正在使用回溯算法的步长，我通过查看梯度的 norm-2 并终止算法，如果它“足够接近”为零（现在我使用的是 0.001）。

我试图最小化的函数是以下 (0.5)*(norm((Y - X*B),2)^2) + lambda*norm(B,1)。（注意：通过 norm(Y,2) 我的意思是向量 Y 的 norm-2 值）我的 X 矩阵是 150×5 并且不是稀疏的。

如果我将正则化参数 lambda 设置为零，我应该收敛于最小二乘解，我可以验证我的两种算法都做得很好而且相当快。

如果我开始增加 lambda，我的模型系数都趋向于零，这就是我所期望的，但我的算法永远不会终止，因为梯度的 norm-2 始终是正数。例如，1000 的 lambda 将给我 10^(-19) 范围内的系数，但我的梯度的 norm2 约为 1.5，这是经过数千次迭代后，而我的梯度值都收敛到 0 到 1 的某个值范围，我的步长变得非常小（10 ^（-37）范围）。如果我让算法运行更长时间，情况并没有改善，它似乎已经以某种方式卡住了。

我的梯度和坐标下降算法都收敛于同一点，并为终止条件给出相同的 norm2（梯度）数。它们也适用于 0 的 lambda。如果我使用非常小的 lambda（比如 0.001）我会收敛，如果我运行一两个小时，0.1 的 lambda 看起来会收敛，一个更大的 lambda 并且收敛速度太小没用。

我有几个问题，我认为可能与问题有关？

在计算梯度时，我使用有限差分法 (f(x+h) - f(xh))/(2h))，h 为 10^(-5)。对 h 的这个值有什么想法吗？

另一个想法是，在这些非常小的步骤中，它在几乎与最小值正交的方向上来回移动，这使得收敛速度如此缓慢以至于毫无用处。

我最后的想法是，也许我应该使用不同的终止方法，也许看看收敛速度，如果收敛速度非常慢，则终止。这是一种常见的终止方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-05T22:36:04.450

1-范数不可微。这会导致很多事情出现根本问题，尤其是您选择的终止测试；梯度将在您的最小值附近急剧变化，并且在一组测量零上不存在。

您真正想要的终止测试将遵循“次梯度中有一个非常短的向量[”](http://en.wikipedia.org/wiki/Subderivative)。

在 ||Ax-b||_2^2 + lambda ||x||_1 的次梯度中很容易找到最短向量。明智地选择容差`eps`并执行以下步骤：

1.  计算`v = grad(||Ax-b||_2^2).`

2.  如果`x[i] < -eps`，则从 中减去 lambda `v[i]`。如果`x[i] > eps`，则将 lambda 添加到`v[i]`. 如果`-eps <= x[i] <= eps`，则添加最小化`[-lambda, lambda]`的数字。`v[i]``v[i]`

您可以在此处进行终止测试，将`v`其视为梯度。我还建议`v`在选择下一次迭代的位置时使用渐变。

# php - 在 jQuery AJAX 中获取 PHP 变量

> ID：14176725
> 
> 赞同：0
> 
> 时间：2013-01-05T21:44:26.590
> 
> 标签：php, jquery

在我的 php 文件“login_success.php”中，我有一个变量`$_COOKIE["user"]`

是否有可能在 jQuery Ajax 语句中返回该变量，例如这个。我用 Var UserName = 做了一个猜测：

```
function StartAjax(NameID){
    $.ajax({
      type: "POST",
      url: "login_success.php",
      cache: false,
      data: "name=Peter&location=Sheffield",
      success: function(html, status){
        $("#"+NameID).append(html);
        //$('#status').append(status);
        var userName = 

      } 
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T21:47:05.663

```
login_success.php:
echo $_COOKIE['user']; 
```

Ajax 请求页面，返回输出/内容（`echo`编辑的内容）。请注意：Javascript 是客户端。PHP是服务器端。所以你不能直接访问 PHP 变量，但是如上所述，PHP 可以“给”客户端它需要的信息。如果您要发送大量数据，您可以将其[json_encode](http://php.net/manual/en/function.json-encode.php)用于 ajax 请求。（你可以自己学习JSON）

另请注意，Javascript 可以访问 cookie，但我假设这只是一个示例问题。

# kineticjs - 使用 KineticJS 拖动图像后无法获取坐标

> ID：14176727
> 
> 赞同：-1
> 
> 时间：2013-01-05T21:45:02.277
> 
> 标签：kineticjs

我正在使用 KineticJS，我想获取拖动图像的 x、y 坐标。我有以下代码，但 dragend 事件似乎没有被触发。我究竟做错了什么？

```
var layer = new Kinetic.Layer();
var imageObj = new Image();
imageObj.onload = function() {
   var myim = new Kinetic.Image({
   x: 50,
   y: 50,
   image: imageObj,
   width: 50,
   height: 50,
   draggable: true
   });

layer.add(myim);
stage.add(layer);   
};

imageObj.src = 'myimage.png';

myim.on("dragend", function() {
   var points = myim.getPosition();
   alert(points.x + ',' + points.y);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T00:52:03.523

将事件处理程序移到函数内部，`imageObj.onload`因为`myim`在此函数的范围内，因此无法在此函数之外解析以附加事件处理程序。

# php - 加密 XML 文件

> ID：14176729
> 
> 赞同：-4
> 
> 时间：2013-01-05T21:45:11.997
> 
> 标签：php, xml, encryption, guid

我有一个这样的 XML 文件

```
 <?xml version="1.0" encoding="iso-8859-1"?>1
<!-- Time-stamp: "bibliography.xml   3 Mar 2008 16:24:04" -->2
<!DOCTYPE bibliography SYSTEM "bibliography.dtd" >3
<bibliography>4
  <book key="Michard01" lang="fr">5
    <title>XML langage et applications</title>
    <author>Alain Michard</author>
    <year>2001</year>
    <publisher>Eyrolles</publisher>
    <isbn>2-212-09206-7</isbn>
    <url>http://www.editions-eyrolles/livres/michard/</url>
  </book>
  <book key="Zeldman03" lang="en">
    <title>Designing with web standards</title>
    <author>Jeffrey Zeldman</author>
    <year>2003</year>
    <publisher>New Riders</publisher>
    <isbn>0-7357-1201-8</isbn>
  </book>
  ...
</bibliography>6 
```

我想将 XML 文件加密为 32 个字符的字符串

像那样 ：

```
6DA5F750-9CB7-3E81-74AD-21B3747BAC8T 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:54:56.720

那个“那样”：

```
6DA5F750-9CB7-3E81-74AD-21B3747BAC8T 
```

看起来很像[GUID - 全球唯一标识符^(*Wikipedia*)](http://en.wikipedia.org/wiki/Globally_unique_identifier) 。

它不是加密，而是代表。所以 GUID 代表 XML 文档。

有很多方法可以生成这些 GUID，所有这些都有其优点和缺点，因此您需要决定哪种方法最适合您的情况。在 SO 上，我们有一些关于所有这些的 QA 材料（例如与[PHP 相关的 XML 和 GUID](https://stackoverflow.com/search?q=%5Bphp%5D+xml+guid)列表），所以只需做一些研究，直到你想出你需要的东西。如果您还有其他问题或问题，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T21:47:07.500

您将无法将该大小的文档加密为 32 个字符。

您可以散列（`md5()`给出 32 个字符，`sha1()`40 个），但这是单向的，而加密需要能够撤消它。

# asp.net-mvc - 具有排序、分页和搜索的 MVC 网格

> ID：14176738
> 
> 赞同：7
> 
> 时间：2013-01-05T21:46:07.487
> 
> 标签：asp.net-mvc

有谁知道任何文章或教程如何使用列排序、分页和搜索网格内的项目等功能为 mvc 创建漂亮的网格？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-05T21:51:18.770

[在 ASP.NET MVC 应用程序中使用实体框架进行排序、筛选和分页](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-07-08T16:53:31.207

现在最好的选择是 Grid.MVC 。您可以从 Nuget 下载。 ![在此处输入图像描述](../Images/3f4220e0ec564a4558e6538ac3b7e512.png)

网站：[https ://gridmvc.codeplex.com/](https://gridmvc.codeplex.com/)

演示： http: [//gridmvc.azurewebsites.net/](http://gridmvc.azurewebsites.net/)

教程： http: [//www.codeproject.com/Tips/597253/Using-the-Grid-MVC-in-ASP-NET-MVC](http://www.codeproject.com/Tips/597253/Using-the-Grid-MVC-in-ASP-NET-MVC)

# c++ - 使用'if'打印大写字母

> ID：14176741
> 
> 赞同：0
> 
> 时间：2013-01-05T21:33:19.443
> 
> 标签：c++, ascii

我做错了什么？我需要这个，用'if'打印所有大写字母，但出了点问题，因为它不止一次打印一个字母！任何帮助表示赞赏:)

```
//Uppercase letters using if;
#include<iostream>
using namespace std;

int main()
{
    char character='A';
label1:
if(character>='A')
    if(character>='Z')
        goto label2;
    else
    {
        cout<<character<<endl<<character++<<endl;
        goto label1;
    }

label2:
    cout<<"End"<<endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T21:50:02.657

您将`character`变量增加两次。我发布这个答案只是为了向您展示什么是技术错误，但还有一个更大的概念性错误，即使用`goto`. 我建议你阅读一些关于 C++ 的介绍性书籍。

```
//Uppercase letters using if;
#include<iostream>
using namespace std;

int main()
{
    char character='A';

label1:
if(character>='A')
    if(character>'Z'))
        goto label2;
    else
    {
        cout<<character<<endl;
        character++;
        goto label1;
    }

label2:
    cout<<"End"<<endl;
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T22:35:27.690

有点晚了，但是：

```
#include "stdafx.h"
#include<iostream>
#include <string>

using namespace std;

int main()
{
    string s("ABCDEFGHIJKLMNOPQRSTUVWXYZ");
    if (1) goto label1;
    cout << "End" << endl;
    return 0;
label1:
    cout << s << endl;
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-05T21:49:53.267

它多次打印每个字母的原因如下：

```
 cout<<character<<endl<<character++<<endl;
          ^^^^^^^^^        ^^^^^^^^^ 
```

以上每一项都会导致`character`被写入`cout`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-05T22:04:19.340

您的代码遗漏了两点-

1.  它没有打印`Z`
2.  两次打印字符`cout<<character<<endl<<character++<<endl;`

更改：更改 `if(character>='Z')` **为 ->** `if(character>'Z')`

**编辑**字符++（这是错字） `cout<<character<<endl<<character++<<endl;` **到->** `cout<<character++<<endl;`

# jquery - jQuery表格格式化

> ID：14176743
> 
> 赞同：1
> 
> 时间：2013-01-05T21:46:54.083
> 
> 标签：jquery, combobox, telerik

我将数据绑定到 Telerik MVC MultiColumn 组合框。我试图在三个 td 中对齐三列（e.selectedField.fieldName、e.concatField1、e.concatField2）以制作表格。如何将样式应用于以下 textValue 并将此值绑定为表格？

```
// Bind the data to the list control.
$.each(e.data, function (idx, record) {

    var textValue = record[e.selectedField.fieldName] + " " + record[e.concatField1]+" " + record[e.concatField2];

    bindData.push({ Value: record[e.valueField], Text: textValue });

});

ctrl.dataBind(bindData); 
```

# android - 将音乐播放器导入另一个项目，没有发现错误但播放不起作用？

> ID：14176751
> 
> 赞同：0
> 
> 时间：2013-01-05T21:47:16.610
> 
> 标签：android, eclipse

我有两个项目，一个名为 myLauncher，另一个名为 Android SDK 中的 RandomMusicPlayer 示例。音乐播放器单独运行良好，但是当我将它导入我的项目时它停止工作，奇怪的是它没有给出任何错误，也没有在 eclipse 中发现错误，它只是不播放音乐。（我之前合并过项目，做了所有事情，比如更改 R 导入、导入布局、图像文件和更正清单）

以下是 /src 的当前内容：

```
> src > com.mylauncher.launcher
      > com.mylauncher.easyplayer > MainActivity.java
                                  > MusicService.java 
```

当我在播放器上单击“播放”时，会触发一个警报，我添加了该警报以进行调试，因此该按钮可以正常工作。就在警报之后，有一行开始播放：

```
 new AlertDialog.Builder(this).setTitle("Argh").setMessage("Watch out!").setNeutralButton("Close", null).show();
    startService(new Intent(MusicService.ACTION_PLAY)); 
```

虽然我可以将代码跟踪到警报，但似乎以下意图永远不会开始。（我在 MusicService 中添加了一个警报，但它没有运行。）

Eclipse 没有显示任何错误，我可以很好地运行该应用程序（只是没有播放音乐），而且该应用程序可以单独运行。知道可能是什么问题吗？导入包后我是否需要做一些额外的事情以确保它正常工作？

# r - ddply 和聚合之间的区别

> ID：14176756
> 
> 赞同：7
> 
> 时间：2013-01-05T21:47:58.830
> 
> 标签：r

有人可以通过以下示例帮助我了解聚合和 ddply 之间的区别：

一个数据框：

```
mydat <- data.frame(first = rpois(10,10), second = rpois(10,10), 
                    third = rpois(10,10), group = c(rep("a",5),rep("b",5))) 
```

使用 aggregate 将函数应用于按因子分割的数据框的一部分：

```
aggregate(mydat[,1:3], by=list(mydat$group), mean)
  Group.1 first second third
1       a   8.8    8.8  10.2
2       b   6.8    9.4  13.4 
```

尝试对另一个函数使用聚合（返回错误消息）：

```
aggregate(mydat[,1:3], by=list(mydat$group), function(u) cor(u$first,u$second))
Error in u$second : $ operator is invalid for atomic vectors 
```

现在，用 ddply （plyr 包）尝试同样的方法：

```
ddply(mydat, .(group), function(u) cor(u$first,u$second))
  group         V1
1     a -0.5083042
2     b -0.6329968 
```

高度赞赏所有提示、链接和批评。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-05T22:02:06.383

`aggregate`独立地在每一列上调用 FUN，这就是你获得独立手段的原因。 `ddply`将所有列传递给函数。`aggregate`可以按顺序快速演示正在传递的内容：

一些用于演示的示例数据：

```
d <- data.frame(a=1:4, b=5:8, c=c(1,1,2,2))

> d
  a b c
1 1 5 1
2 2 6 1
3 3 7 2
4 4 8 2 
```

通过使用函数`print`并忽略命令的结果`aggregate`或`ddply`，我们可以看到在每次迭代中传递给函数的内容。

`aggregate`：

```
tmp <- aggregate(d[1:2], by=list(d$c), print)
[1] 1 2
[1] 3 4
[1] 5 6
[1] 7 8 
```

请注意，将发送各个列进行打印。

`ddply`：

```
tmp <- ddply(d, .(c), print)
  a b c
1 1 5 1
2 2 6 1
  a b c
3 3 7 2
4 4 8 2 
```

请注意，正在发送数据帧进行打印。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-05T22:23:14.007

您已经被告知为什么`aggregate`将错误的 {base} 函数用于需要两个向量作为参数的函数，但您还没有被告知哪种非 ddply 方法会成功。

`by( ... grp, FUN)`方法：

```
> cbind (by( mydat, mydat["group"], function(d) cor(d$first, d$second)) )
        [,1]
a  0.6529822
b -0.1964186 
```

`sapply(split( ..., grp), fn)`方法_

```
> sapply(  split( mydat, mydat["group"]), function(d) cor(d$first, d$second)) 
         a          b 
 0.6529822 -0.1964186 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-05T22:14:07.543

@MatthewLundberg 的答案非常好，我的答案不是答案，但这只是我想查看某些 R 函数调用背后发生的情况时使用的一般提示。我使用调试命令`browser`。

```
aggregate(mydat[,1:3], by=list(mydat$group), 
+           function(x){
+             browser()
+             mean(x)
+           })
Called from: FUN(X[[1L]], ...)
Browse[1]> x
[1] 16 10 16 13 25 
```

然后对于 ddply

```
ddply(mydat, .(group), function(u) {
+   browser()
+   cor(u$first,u$second)
+   })
Called from: .fun(piece, ...)
Browse[1]> u
  first second third group
1    16      8     9     a
2    10      6     6     a
3    16      6    10     a
4    13      8    10     a
5    25     10     4     a 
```

**自己编辑调试错误**

在这里，我使用该技术来查看为什么会出现错误

```
aggregate(mydat[,1:3], by=list(mydat$group), function(u) {
+   browser()
+   cor(u$first,u$second)
+   })
Called from: FUN(X[[1L]], ...)
Browse[1]> u
[1] 16 10 16 13 25 
```

正如你在这里看到的，你是一个原子向量（没有列名）所以如果你尝试

```
Browse[1]> u$first 
```

你得到一个错误：

```
Error in u$first : $ operator is invalid for atomic vectors 
```

# optimization - 记或不记

> ID：14176758
> 
> 赞同：5
> 
> 时间：2013-01-05T21:48:09.290
> 
> 标签：optimization, f#, memoization

... 就是那个问题。我一直在研究一种算法，该算法将向量数组作为输入，并且该算法的一部分重复选择向量对并评估这两个向量的函数，该函数不会随时间变化。在寻找优化算法的方法时，我认为这将是一个很好的记忆化案例：与其一遍又一遍地重新计算相同的函数值，不如将其缓存并命中缓存。

在跳到代码之前，这里是我的问题的要点：我从记忆中获得的好处取决于向量的数量，我认为这与重复调用的数量成反比，并且在某些情况下记忆会完全降低性能。那么我的情况是否不足以记忆？我是不是做错了什么，有没有更聪明的方法来优化我的情况？

这是一个简化的测试脚本，它非常接近真实的东西：

```
open System
open System.Diagnostics
open System.Collections.Generic

let size = 10 // observations
let dim = 10 // features per observation
let runs = 10000000 // number of function calls

let rng = new Random()
let clock = new Stopwatch()

let data =
    [| for i in 1 .. size ->
        [ for j in 1 .. dim -> rng.NextDouble() ] |]    
let testPairs = [| for i in 1 .. runs -> rng.Next(size), rng.Next(size) |]

let f v1 v2 = List.fold2 (fun acc x y -> acc + (x-y) * (x-y)) 0.0 v1 v2

printfn "Raw"
clock.Restart()
testPairs |> Array.averageBy (fun (i, j) -> f data.[i] data.[j]) |> printfn "Check: %f"
printfn "Raw: %i" clock.ElapsedMilliseconds 
```

我创建了一个随机向量列表（数据）、一个随机索引集合（testPairs），并在每一对上运行 f。

这是记忆的版本：

```
let memoized =
    let cache = new Dictionary<(int*int),float>(HashIdentity.Structural)
    fun key ->
        match cache.TryGetValue(key) with
        | true, v  -> v
        | false, _ ->
            let v = f data.[fst key] data.[snd key]
            cache.Add(key, v)
            v

printfn "Memoized"
clock.Restart()
testPairs |> Array.averageBy (fun (i, j) -> memoized (i, j)) |> printfn "Check: %f"
printfn "Memoized: %i" clock.ElapsedMilliseconds 
```

这是我所观察到的： * 当大小很小 (10) 时，记忆的速度大约是原始版本的两倍，* 当大小很大 (1000) 时，记忆比原始版本多 15 倍时间，* 当 f 代价高昂时, memoization 改进了事情

我的解释是，当尺寸较小时，我们有更多的重复计算，并且缓存得到了回报。

令我吃惊的是更大尺寸的巨大性能冲击，我不确定是什么原因造成的。我知道我可以稍微改进字典访问，例如使用结构键 - 但我没想到“天真的”版本表现得如此糟糕。

那么 - 我在做什么明显有问题吗？对于我的情况，记忆是错误的方法吗？如果是，有更好的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-05T22:10:36.980

我认为记忆是一种有用的技术，但它不是灵丹妙药。[它在动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)中非常有用，它可以降低算法的（理论）复杂性。作为一种优化，它可以（正如您可能期望的那样）产生不同的结果。

`f`在您的情况下，当观察数量较少（并且计算成本更高）时，缓存肯定更有用。您可以将简单的统计数据添加到您的记忆中：

```
let stats = ref (0, 0) // Count number of cache misses & hits
let memoized =
    let cache = new Dictionary<(int*int),float>(HashIdentity.Structural)
    fun key ->
        let (mis, hit) = !stats
        match cache.TryGetValue(key) with
        | true, v  -> stats := (mis, hit + 1); v // Increment hit count
        | false, _ ->
            stats := (mis + 1, hit); // Increment miss count
            let v = f data.[fst key] data.[snd key]
            cache.Add(key, v)
            v 
```

*   对于 small `size`，我得到的数字是这样的`(100, 999900)`，所以记忆化有很大的好处 - 该函数`f`被计算 100 倍，然后每个结果被重用 9999 倍。

*   对于 big `size`，我得到类似`(632331, 1367669)`这样的东西`f`被多次调用，每个结果只被重用两次。在这种情况下，在（大）哈希表中分配和查找的开销要大得多。

作为一个小的优化，您可以预先分配`Dictionary`和 write `new Dictionary<_, _>(10000,HashIdentity.Structural)`，但这在这种情况下似乎没有多大帮助。

为了使这种优化有效，我认为您需要了解有关 memoized 函数的更多信息。在您的示例中，输入非常有规律，因此记忆化可能没有意义，但是如果您知道该函数更经常使用某些参数值调用，则您可能只能记忆这些常见参数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-05T23:47:12.733

Tomas 的答案非常适合您何时应该使用 memoization。这就是为什么在你的情况下记忆变得如此缓慢的原因。

听起来您正在调试模式下进行测试。在 Release 中再次运行您的测试，您应该会获得更快的记忆结果。在调试模式下，元组可能会导致很大的性能损失。我添加了一个散列版本进行比较以及一些微优化。

发布

```
Raw
Check: 1.441687
Raw: 894

Memoized
Check: 1.441687
Memoized: 733

memoizedHash
Check: 1.441687
memoizedHash: 552

memoizedHashInline
Check: 1.441687
memoizedHashInline: 493

memoizedHashInline2
Check: 1.441687
memoizedHashInline2: 385 
```

调试

```
Raw
Check: 1.409310
Raw: 797

Memoized
Check: 1.409310
Memoized: 5190

memoizedHash
Check: 1.409310
memoizedHash: 593

memoizedHashInline
Check: 1.409310
memoizedHashInline: 497

memoizedHashInline2
Check: 1.409310
memoizedHashInline2: 373 
```

资源

```
open System
open System.Diagnostics
open System.Collections.Generic

let size = 10 // observations
let dim = 10 // features per observation
let runs = 10000000 // number of function calls

let rng = new Random()
let clock = new Stopwatch()

let data =
    [| for i in 1 .. size ->
        [ for j in 1 .. dim -> rng.NextDouble() ] |]    
let testPairs = [| for i in 1 .. runs -> rng.Next(size), rng.Next(size) |]

let f v1 v2 = List.fold2 (fun acc x y -> acc + (x-y) * (x-y)) 0.0 v1 v2

printfn "Raw"
clock.Restart()
testPairs |> Array.averageBy (fun (i, j) -> f data.[i] data.[j]) |> printfn "Check: %f"
printfn "Raw: %i\n" clock.ElapsedMilliseconds

let memoized =
    let cache = new Dictionary<(int*int),float>(HashIdentity.Structural)
    fun key ->
        match cache.TryGetValue(key) with
        | true, v  -> v
        | false, _ ->
            let v = f data.[fst key] data.[snd key]
            cache.Add(key, v)
            v

printfn "Memoized"
clock.Restart()
testPairs |> Array.averageBy (fun (i, j) -> memoized (i, j)) |> printfn "Check: %f"
printfn "Memoized: %i\n" clock.ElapsedMilliseconds

let memoizedHash =
    let cache = new Dictionary<int,float>(HashIdentity.Structural)
    fun key ->
        match cache.TryGetValue(key) with
        | true, v  -> v
        | false, _ ->
            let i = key / size
            let j = key % size
            let v = f data.[i] data.[j]
            cache.Add(key, v)
            v

printfn "memoizedHash"
clock.Restart()
testPairs |> Array.averageBy (fun (i, j) -> memoizedHash (i * size + j)) |> printfn "Check: %f"
printfn "memoizedHash: %i\n" clock.ElapsedMilliseconds

let memoizedHashInline =
    let cache = new Dictionary<int,float>(HashIdentity.Structural)
    fun key ->
        match cache.TryGetValue(key) with
        | true, v  -> v
        | false, _ ->
            let i = key / size
            let j = key % size
            let v = f data.[i] data.[j]
            cache.Add(key, v)
            v

printfn "memoizedHashInline"
clock.Restart()
let mutable total = 0.0
for i, j in testPairs do
    total <- total + memoizedHashInline (i * size + j)
printfn "Check: %f" (total / float testPairs.Length)
printfn "memoizedHashInline: %i\n" clock.ElapsedMilliseconds

printfn "memoizedHashInline2"
clock.Restart()
let mutable total2 = 0.0
let cache = new Dictionary<int,float>(HashIdentity.Structural)
for i, j in testPairs do
    let key = (i * size + j)
    match cache.TryGetValue(key) with
    | true, v  -> total2 <- total2 + v
    | false, _ ->
        let i = key / size
        let j = key % size
        let v = f data.[i] data.[j]
        cache.Add(key, v)
        total2 <- total2 + v

printfn "Check: %f" (total2 / float testPairs.Length)
printfn "memoizedHashInline2: %i\n" clock.ElapsedMilliseconds

Console.ReadLine() |> ignore 
```

# ios - 以编程方式在 UITableViewCells 中嵌入多个 UISlider 和 UILabel 控件

> ID：14176760
> 
> 赞同：0
> 
> 时间：2013-01-05T21:48:45.203
> 
> 标签：ios, cocoa-touch, uitableview, uilabel, uislider

我是一名 iOS 开发新手，如果能以编程方式在 UITableView 中创建多个 UISlider 和 UILabel 控件，我将不胜感激，如图所示：

![小样](../Images/d13ca96cb735c150da4b263a7741d976.png)

如上面的样机图片所示，我只需要在更改相应的滑块（在同一行）时更新相关的标签文本。

使用下面的代码，我可以为表格视图中的每一行动态创建多个滑块控件，但是当滑块的值发生更改时，我无法显示相应的标签并更新此标签文本。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *ControlRowIdentifier = @"ControlRowIdentifier";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:ControlRowIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc]
                initWithStyle:UITableViewCellStyleDefault
                reuseIdentifier:ControlRowIdentifier];

        CGRect frame = CGRectMake(0.0, 0.0, 100.0, 10.0);
        UISlider *slider = [[UISlider alloc] initWithFrame:frame];
        [slider addTarget:self action:@selector(sliderAction:) forControlEvents:UIControlEventValueChanged];
        [slider setBackgroundColor:[UIColor clearColor]];
        slider.minimumValue = 1;
        slider.maximumValue = 70;
        slider.continuous = YES;
        slider.value = 30;

        cell.accessoryView = slider;
    }
    NSUInteger row = [indexPath row];
    NSString *rowTitle = [list objectAtIndex:row];
    cell.textLabel.text = rowTitle;

    return cell;
}

//Does not work
- (IBAction)sliderAction:(id)sender {
    UISlider *sliderControl = (UISlider *)sender;
    int SliderValue = (int)roundf(sliderControl.value);
    UILabel *sliderLabel;
    sliderLabel.text = [NSString stringWithFormat:@"%d", SliderValue];
    [self.view addSubview:sliderLabel];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T22:15:25.593

您应该将滑块创建移出 if 指令：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *ControlRowIdentifier = @"ControlRowIdentifier";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:ControlRowIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
               reuseIdentifier:ControlRowIdentifier];
    }
    CGRect frame = CGRectMake(0.0, 0.0, 100.0, 10.0);
    UISlider *slider = [[UISlider alloc] initWithFrame:frame];
    [slider addTarget:self action:@selector(sliderAction:) forControlEvents:UIControlEventValueChanged];
    [slider setBackgroundColor:[UIColor clearColor]];
    slider.minimumValue = 1;
    slider.maximumValue = 70;
    slider.continuous = YES;
    slider.value = 30;

    cell.accessoryView = slider;

    NSUInteger row = [indexPath row];
    NSString *rowTitle = [list objectAtIndex:row];
    cell.textLabel.text = rowTitle;

    return cell;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T22:21:03.440

我在这里看到了几个问题。

1.  您永远不会实例化任何标签来显示滑块值。您需要实例化它并将其放入表格单元格的视图层次结构中。
2.  您将 设置`UITableViewDataSource`为滑块操作的目标。这使得很难知道哪个标签对应于哪个滑块。您应该自定义 UITableViewCell，或者通过子类化或将 UIView 子类添加到`contentView`. 滑块应以单元格或视图子类为目标，并且标签更新可能发生在那里。还有其他方法可以做到这一点。
3.  在您的`sliderAction:`方法中，您永远不会初始化`sliderLabel`变量。您需要将其设置为`UILabel`与单元格对应的实例，如上。

# agile - 在冲刺期间处理意外功能

> ID：14176762
> 
> 赞同：2
> 
> 时间：2013-01-05T21:49:16.557
> 
> 标签：agile, scrum, sprint

我们的团队将采用 Scrum 和敏捷技术。我们有一个产品，我们为多个客户开发。该客户向我们提供了必要的要求，因此采用敏捷技术一切都很好。

但是在某个时刻（例如在 sprint 期间），出现了新客户，他想要获得与我们现在的产品略有不同的产品演示。这可能是一些新功能或行为上的细微差别。例如，他想在一周内获得这个演示。展示我们的产品支持此功能非常重要（因为否则他将向我们的竞争对手发表讲话），因此我们必须在一周内开发此功能（可能是部分）。

我们必须如何用敏捷处理这种特性？将它们移至当前的 sprint 积压工作？或者将一个团队分成两个并创建另一个冲刺？或者可能有另一种方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T18:47:50.497

我大体上同意 jessehouwing 的回答。如果您概述的问题不常见，那么他的回答是有道理的。如果这很常见，那么短跑可能不是您要寻找的答案。解决这个问题的更灵活的方法是[看板](http://en.wikipedia.org/wiki/Kanban_%28development%29)。在看板中，您逐个故事地工作，而不是计划整个冲刺。这种风格非常适合经常改变优先级的团队。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T22:38:58.310

Scrum 允许您重新协商产品负责人和开发团队之间的 sprint，因此如果该项目非常重要，PO 可以建议团队更换已经计划但尚未开始的相同规模的工作。

或者当工作量将耗尽 sprint 中剩余的所有时间时，PO 可以取消当前 sprint 并要求新的 sprint，这些更改是最重要的项目。取消的 sprint 中所有未完成的工作都应视为丢失。

如果此类中期 sprint 更改频繁发生，您可能需要保留一些容量来适应这些类型的请求。只需减少您在 sprint 计划会议期间要处理的故事点数。或者，根据您当前的 sprint 长度，您可能希望将 sprint 中的天数减少到一周或其他时间，这样您就可以在需要进行这些类型的更改时降低风险。

# ruby - 使用 Bubblewrap：如何使用自定义标题制定 get？

> ID：14176770
> 
> 赞同：2
> 
> 时间：2013-01-05T21:50:04.837
> 
> 标签：ruby, http-headers, rubymotion

我有以下有效的 Curl 命令：

```
curl -H "Authorization:GoogleLogin auth=xxx" http://www.google.com/reader/api/0/user-info 
```

我正在尝试通过`get`BubbleWrap HTTP 执行此操作：

```
HTTP.get("http://www.google.com/reader/api/0/user-info",
    {
        :headers => { "Authorization:GoogleLogin auth" => "xxx"}
    }) do |response|
    puts response
    puts response.body.to_str
end 
```

但是我得到了 401，所以也许我没有正确设置标题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T08:29:45.777

标头名称`Authorization`的值应为`GoogleLogin auth=xxx`. 你这样做的方式，它是一个标题名称，`Authorization:GoogleLogin auth`其值为`xxx`. 试试这个：

```
:headers => {"Authorization" => "GoogleLogin auth=xxx"} 
```

# python - 如何在记忆棒上安装 django 应用程序

> ID：14176773
> 
> 赞同：1
> 
> 时间：2013-01-05T21:50:28.797
> 
> 标签：python, django, windows, executable

我目前正在开发一个基于 python/django 的开源软件。该软件稍后应该可以由标准的 windows/linux 用户轻松安装，而无需任何编程经验。它还应该可以移植到不同的计算机上。这些计算机上唯一需要的安装应该是 python 本身。

有没有办法让它工作？

我已经发现这个“dbuilder” [Django 项目作为桌面应用程序：如何？](https://stackoverflow.com/questions/1317899/django-projects-as-) 桌面应用程序操作方法

它似乎有点过时并且不是一个非常顺利的解决方案。

有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T16:29:35.087

只需在记忆棒上使用便携式版本的 python。制作一个运行 projname.bat 文件的批处理文件：

```
python.exe /django-app-path/manage.py runserver 
```

现在打开浏览器并浏览它，默认地址将是：

```
http://127.0.0.1:8000 
```

如果您需要在您的应用正在运行的其他设备上浏览您的应用：

获取您的服务器 ip

```
windows shell>ipconfig
linux shell@ ifconfig 
```

然后在该地址上运行您的开发服务器（在批处理文件中）：

```
python.exe /django-app-path/manage.py runserver your-ip-address:port-if-not-80 
```

# c++ - 找出两条线是否相交

> ID：14176776
> 
> 赞同：6
> 
> 时间：2013-01-05T21:50:40.730
> 
> 标签：c++, geometry, linear-algebra

> **可能重复：**
> [如何检测两条线段相交的位置？](https://stackoverflow.com/questions/563198/how-do-you-detect-where-two-line-segments-intersect)
> [确定两条线段是否相交？](https://stackoverflow.com/questions/4977491/determining-if-two-line-segments-intersect)

给定两行 l1=((A0, B0), (A1, B1)) 和 l2=((A2, B2), (A3, B3)); Ax, Bx 是整数，(Ax, Bx) 指定行的开始和结束。

是否有一种仅使用整数算术来确定 l1 和 l2 是否相交的算法？（只需要一个布尔答案。）

**我自己的方法**是用定点算法计算交点附近的一个点。然后将解 (a, b) 代入以下方程：

I: abs((A0 + a * (A1-A0)) - (A2 + b * (A3-A2))) < 公差
II: abs((B0 + a * (B1-B0)) - (B2 + b * (B3-B2))) < 公差

如果 I 和 II 都评估为 true，我的方法应该返回 true。

**我的 C++ 代码：**
*vec.h*：

```
#ifndef __MY_VECTOR__
#define __MY_VECTOR__
#include <stdarg.h>
template<typename VType, unsigned int dim>
class vec {
private:
    VType data[dim];
public:
    vec(){}
    vec(VType v0, ...){
            data[0] = v0;
            va_list l;
            va_start(l, v0);
            for(unsigned int i=1; i<dim; ++i){
                    data[i] = va_arg(l, VType);
            }
            va_end(l);
    }
    ~vec(){}
    VType& operator[](unsigned int i){
            return data[i];
    }
    VType operator[](unsigned int i) const {
            return data[i];
    }};
    template<typename VType, unsigned int dim, bool doDiv>
    vec<VType, dim> helpArith1(const vec<VType, dim>& A, long delta){
            vec<VType, dim> r(A);
            for(unsigned int i=0; i<dim; ++i){
                    r[i] = doDiv ? (r[i] / delta) : (r[i] * delta);
            }
            return r;
    }
    template<typename VType, unsigned int dim>
    vec<VType, dim> operator*(const vec<VType, dim>& v, long delta) {
        return helpArith1<VType, dim, false>(A, delta);
    }
    template<typename VType, unsigned int dim>
    vec<VType, dim> operator*(long delta, const vec<VType, dim>& v){
        return v * delta;
    }
    template<typename VType,unsigned int dim>
    vec<VType, dim> operator/(const vec<VType, dim>& A, long delta) {
        return helpArith1<VType, dim, true>(A, delta);
    }
    template<typename VType, unsigned int dim, bool doSub>
    vec<VType, dim> helpArith2(const vec<VType, dim>& A, const vec<VType, dim>& B){
        vec<VType, dim> r;
        for(unsigned int i=0; i<dim; ++i){
            r[i] = doSub ? (A[i]-B[i]):(A[i]+B[i]);
        }
        return r;
    }
    template<typename VType, unsigned int dim>
    vec<VType, dim> operator+(const vec<VType, dim>& A, const vec<VType, dim>& B){
        return helpArith2<VType, dim, false>(A, B);
    }
    template<typename VType, unsigned int dim>
    vec<VType, dim> operator-(const vec<VType, dim>& A, const vec<VType, dim>& B){
        return helpArith2<VType, dim, true>(A, B);
    }
    template<typename VType, unsigned int dim>
    bool operator==(const vec<VType, dim>& A, const vec<VType, dim>& B) {
            for(unsigned int i==0; i<dim; ++i){
                if(A[i]!=B[i]){
                            return false;
                    }
            }
            return true;
    }
    template<typename VType, unsigned int dim>
    bool operator!=(const vec<VType, dim>& A, const vec<VType, dim>& B) {
            return !(A==B);
    }
    #endif 
```

*线.h*：

```
#ifndef __MY_LINE__
#define __MY_LINE__
#include "vec.h"
unsigned long int ggt(unsigned long int A, unsigned long int B) {
    if(A==0) {
        if(B==0) {
            return 1;
        }
        return B;
    }
    while(B!=0) {
        unsigned long int temp = A % B;
        A = B;
        B = temp;
    }
    return A;
}
#define ABS(n) ( ((n)<0) ? (-n) : (n) )
struct line {
    vec<long int, 2> A, B;
    explicit line(long int iA_0, long int iA_1, long int iB_0, long int iB_1) :
        A(vec<long int, 2>(iA_0<<8, iA_1<<8)),
        B(vec<long int, 2>(iB_0<<8, iB_1<<8)){}
    vec<long int, 2> slope() const{
        vec<long int, 2> temp = A-B;
        if(temp[0]<0) {
            temp[0] = -1 * temp[0];
            temp[1] = -1 * temp[1];
        }
        return temp/ggt(ABS(temp[0]), ABS(temp[1]));
    }
};
bool intersect(line l1, line l2) {
    const long int epsilon = 1<<4;
    vec<long int, 2> sl1 = l1.slope(), sl2 = l2.slope();
    // l2.A + b*sl2 = l1.A + a*sl1
    // <=> l2.A - l1.A = a*sl1 - b*sl2  // = (I, II)^T
    // I': sl2[1] * I; II': sl2[0] * II
    vec<long int, 2> L = l2.A - l1.A, R = sl1;
    L[0] = L[0] * sl2[1];        R[0] = R[0] * sl2[1];
    L[1] = L[1] * sl2[0];        R[1] = R[1] * sl2[0];
    // I' - II'
    long int L_SUB = L[0] - L[1], R_SUB = R[0] - R[1];
    if(ABS(R_SUB) == 0) {
        return ABS(L_SUB) == 0;
    }
    long int temp = ggt(ABS(L_SUB), ABS(R_SUB));
    L_SUB /= temp; R_SUB /= temp;
    // R_SUB * a = L_SUB
    long int a = L_SUB/R_SUB, b = ((l1.A[0] - l2.A[0])*R_SUB + L_SUB * sl1[0])/R_SUB;
    // if the given lines intersect, then {a, b} must be the solution of
    // l2.A - l1.A = a*sl1 - b*sl2
    L = l2.A - l1.A;
    long x = ABS((L[0]- (a*sl1[0]-b*sl2[0]))), y = ABS((L[1]- (a*sl1[1]-b*sl2[1])));
    return x<epsilon && y < epsilon;
}
#endif 
```

*主.cpp*：

```
#include "line.h"
int main(){
    line A(0, 0, 6, 0), B(3, 3, 4, -3);
    bool temp = intersect(A, B);
    return 0;
} 
```

（我不确定我的 intersect 函数是否适用于所有行，但是根据我迄今为止使用的测试数据，它返回了正确的结果。）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-05T22:24:53.727

这个有可能。我们要检查 l1 的两个端点是否在 l2 的不同边上，并且 l2 的两个端点都在 l1 的相对边上。

为了检查点 (A, B) 位于 l1=((A0, B0), (A1, B1)) 的哪一侧，我们采取：

*   垂直于线的任意法线向量 N；一个这样的向量是 (B1-B0, A1-A0)
*   从线的起点到点 (A, B) 的向量 P，即 (A-A0, B-B0)

然后我们计算点积：

N · P = (A-A0, B-B0) · (B1-B0, A1-A0) = (A-A0) * (B1-B0) + (B-B0) * (A1-A0)

我们只对符号感兴趣：如果它是正数，则该点位于线的一侧；如果它是负面的，它在另一个。如您所见，不需要浮点运算。

我们可以利用这样一个事实，即具有相反符号的数字在相乘时总是产生负数。所以判断两条线段（（A0，B0），（A1，B1））和（（A2，B2），（A3，B3））是否相交的完整表达式是：

```
((A2-A0)*(B1-B0) - (B2-B0)*(A1-A0)) * ((A3-A0)*(B1-B0) - (B3-B0)*(A1-A0)) < 0
&&
((A0-A2)*(B3-B2) - (B0-B2)*(A3-A2)) * ((A1-A2)*(B3-B2) - (B1-B2)*(A3-A2)) < 0 
```

## 测试代码

一些 C++ 代码来测试上述计算：

```
#include <iostream>
#include <cstdlib>

struct Point {
    int x,y;
};

bool isIntersecting(Point& p1, Point& p2, Point& q1, Point& q2) {
    return (((q1.x-p1.x)*(p2.y-p1.y) - (q1.y-p1.y)*(p2.x-p1.x))
            * ((q2.x-p1.x)*(p2.y-p1.y) - (q2.y-p1.y)*(p2.x-p1.x)) < 0)
            &&
           (((p1.x-q1.x)*(q2.y-q1.y) - (p1.y-q1.y)*(q2.x-q1.x))
            * ((p2.x-q1.x)*(q2.y-q1.y) - (p2.y-q1.y)*(q2.x-q1.x)) < 0);
}

int main(int argc, char* argv[]) {
    if(argc != 9) {
        std::cout << "Call as " << argv[0] << " <p1.x> <p1.y> <p2.x> "
                  << "<p2.y> <q1.x> <q1.y> <q2.x> <q2.y>" << std::endl;
        return -1;
    }

    Point p1 = {.x = atoi(argv[1]), .y = atoi(argv[2])};
    Point p2 = {.x = atoi(argv[3]), .y = atoi(argv[4])};
    Point q1 = {.x = atoi(argv[5]), .y = atoi(argv[6])};
    Point q2 = {.x = atoi(argv[7]), .y = atoi(argv[8])};

    if(isIntersecting(p1,p2,q1,q2)) {
        std::cout << "Segments intersect" << std::endl;
        return 1;
    }
    else {
        std::cout << "Segments do not intersect" << std::endl;
        return 0;
    }
} 
```

结果：

```
$ ./intersection_test 0 0 10 10 0 10 10 0 # example from the comments
Segments intersect
$ ./intersection_test 0 1 2 1 1 2 1 0
Segments intersect
$ ./intersection_test 0 0 0 1 1 1 1 0
Segments do not intersect
$ ./intersection_test 1 1 5 3 3 4 7 2 # q touches but not intersects at p2
Segments do not intersect                             
$ ./intersection_test 1 1 5 3 3 4 6 2
Segments intersect 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T22:07:21.357

两条线段相交如果它们的线相交并且每条线段的端点在其他线段线的相对侧。至少在 2d 中。

两条线相交是二维中的一个简单问题。

点位于直线的哪一侧也很容易。

两者都不需要非整数数学。

对于一些通用几何代码，我会估计一打或三行，然后是 6 到 10 行的解决方案？加上语言样板。还有一些零长度的极端情况检查。

请注意，我将线与线段区分开来。

# java - 仅在视图内触摸 - android

> ID：14176777
> 
> 赞同：0
> 
> 时间：2013-01-05T21:50:47.500
> 
> 标签：java, android, user-interface

我正在尝试这样做，但这让我很头疼，我有一个可以绘制颜色条的视图。我想允许用户移动它（拖放）

这是绘制方法：

```
int r,g,b;
        for(int i = 0; i < 64; i++)
        {       
            r =  Math.round((float)colorBuffer[i][0]*MAX_SCALING);
            g =  Math.round((float)colorBuffer[i][1]*MAX_SCALING);
            b =  Math.round((float)colorBuffer[i][2]*MAX_SCALING);
            paint.setColor(Color.argb(MAX_SCALING, r, g, b));

            canvas.drawLine(x1, y1, x2, y1, paint);
            y1+=3;
        } 
```

rgb 只是颜色。

这是我的 ontouch 实现。

```
 public boolean onTouchEvent(MotionEvent e) 
        {
            float x = e.getX();
            float y = e.getY();

            switch (e.getAction()) 
            {
                case MotionEvent.ACTION_DOWN:
                {
                    Toast t = Toast.makeText(getContext(), "Touch", Toast.LENGTH_SHORT);
                    t.show();
                    break;
                }
                case MotionEvent.ACTION_MOVE:
                {
                    x1=(int) x;
                    x2=(int) (x+30);
                    y1=(int) y;
                    break;
                }
                case MotionEvent.ACTION_UP:
                {
                    Toast t = Toast.makeText(getContext(), "Release", Toast.LENGTH_SHORT);
                    t.show();
                    x1=(int) x;
                    x2=(int) (x+30);
                    y1=(int) y;
                    break;
                }

            }
            invalidate();
            return true;  

} 
```

这工作得很好，但问题是它甚至在视图之外也能工作。因此，如果我触摸视图外，我的栏也会移动到那里，即使我单击按钮，我的栏也会尝试移动，我只想在用户触摸视图内时拖放组件

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:58:18.347

触摸获取视图的 x、y、宽度和高度。然后，当您移动栏时，正如我在 中所理解的那样`MotionEvent.ACTION_MOVE`，检查当前坐标是否在视图的边界内，如果这是真的，那么允许移动栏。

# php - 警告：mysql_num_rows() 期望参数 1 是资源，第 26 行给出的布尔值

> ID：14176783
> 
> 赞同：-3
> 
> 时间：2013-01-05T21:51:24.697
> 
> 标签：php, mysql, boolean

> **可能重复：**
> [警告：mysql_num_rows() 期望参数 1 是资源，给定的布尔值](https://stackoverflow.com/questions/8013526/warning-mysql-num-rows-expects-parameter-1-to-be-resource-boolean-given)

我正在尝试让我的论坛系统运行，但我不断收到此错误：

警告：mysql_num_rows() 期望参数 1 是资源，第 26 行给出的布尔值

大多数代码只经历一个错误。这是我的完整代码：

```
<?php
include_once "../ads/connect_to_mysql.php";//Connect to Database

//Get section ID from the url varible coming in
if(isset($_GET['id'])&&$_GET[id]!=""){
    $sid=preg_replace('#[^0-9]#i','',$_GET['id']); //filter all characters except
}else{
    echo "ERROR: Variables to run this script have been removed from the URL";
    exit();
}
//Query the database for that section id, make sure it exists and get section title
$sql=mysql_query("SELECT*From ad_sections WHERE id='$sid' LIMIT 1");
$numRows=mysql_num_rows($sql);
if($numRows<1){
    echo "ERROR: That section does not exist, you have tampered with our URLs.";
    exit();

}
while($row=mysql_fetch_array($sql)){
    $sectionTitle=$row["title"];

}
//Use the section ID to query a "ad_posts" table in the database to get all the threads for this section
$sql=mysql_query("SELECT*From ad_sections WHERE type='a'AND section_id='$sid' ORDER BY date_time DESC LIMIT 25");  
$dynamicList="";
$numRows=mysql_num_rows($sql);
if($numRows<1){
    $dynamicList="There are no classifieds in this section yet. You can be the first to post.";
}else{
    while($row=mysql_fetch_array($sql)){
    $thread_id=$row["id"];
    $thread_Title=$row["thread_title"];
    $dynamicList.='<a href="view_thread.php?id=' . $thread_id . '">' . $thread_Title . '</a><br/>';
    }
}
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html, charset=utf-8"/>
<title><?php echo "title"; ?></title>
<style>
</style>
</head>
<body>
<table style="bacground-color: #f0f0f0; border:#069 1px solid; border-top:none; width="900">
<tr>
<td width="731"><h2><?php echo $sectionTitle; ?><h2><?php echo $dynamicList; ?></td>
<td width="189">&nbsp;</td>
</tr>
</table>
</body>
</html> 
```

这是第 26 行，真的碰壁了：

```
$numRows=mysql_num_rows($sql); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T22:04:01.103

它关于你`$sql`有一个错误

尝试这个

```
 $sql=mysql_query("SELECT * From ad_sections WHERE id='$sid' LIMIT 1");
                            ^-^-----spaces here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T21:55:16.143

阅读[手册](http://php.net/manual/en/function.mysql-query.php)：

> mysql_query() 成功时返回资源，错误时返回 FALSE。
> 
> ...
> 
> 如果用户无权访问查询引用的表，mysql_query() 也会失败并返回 FALSE。

# delphi - 如何使用 DSPack 循环播放视频？

> ID：14176784
> 
> 赞同：0
> 
> 时间：2013-01-05T21:51:42.573
> 
> 标签：delphi, video, directshow, dspack

我有一个非常简单的程序，它使用 Delphi 2010 中的 DSPack。我有一个带有 TFilterGraph 和 TVideoWindow 的表单。视频播放和渲染很好。我似乎无法弄清楚如何让视频在结束时循环回到开头。

如何使用 DSPack 使视频自动循环播放？

### 代码

```
unit Unit21;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, DSPack, ExtCtrls;

type
  TForm21 = class(TForm)
    FilterGraph1: TFilterGraph;
    OpenDialog1: TOpenDialog;
    Button1: TButton;
    Button2: TButton;
    Panel1: TPanel;
    VideoWindow1: TVideoWindow;
    Panel2: TPanel;
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure FormCloseQuery(Sender: TObject; var CanClose: Boolean);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form21: TForm21;

implementation

{$R *.dfm}

procedure TForm21.Button1Click(Sender: TObject);
begin
  OpenDialog1.InitialDir := ExtractFilePath(ParamStr(0));
  if OpenDialog1.Execute then
  begin
    if not FilterGraph1.Active then FilterGraph1.Active:= True;
    VideoWindow1.FilterGraph:= FilterGraph1;
    FilterGraph1.RenderFile(OpenDialog1.Filename);
    FilterGraph1.Play;
  end;
end;

procedure TForm21.Button2Click(Sender: TObject);
begin
  FilterGraph1.Stop;
end;

procedure TForm21.FormCloseQuery(Sender: TObject; var CanClose: Boolean);
begin
  FilterGraph1.ClearGraph;
  FilterGraph1.Active:= False;
end;

end. 
```

### DFM

```
 object Form21: TForm21
  Left = 0
  Top = 0
  Caption = 'Form21'
  ClientHeight = 441
  ClientWidth = 644
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  OnCloseQuery = FormCloseQuery
  PixelsPerInch = 96
  TextHeight = 13
  object Panel1: TPanel
    Left = 0
    Top = 0
    Width = 644
    Height = 384
    Align = alClient
    Caption = 'Panel1'
    TabOrder = 0
    object VideoWindow1: TVideoWindow
      Left = 1
      Top = 1
      Width = 642
      Height = 382
      Mode = vmVMR
      FilterGraph = FilterGraph1
      VMROptions.Mode = vmrWindowed
      Color = clWhite
      Align = alClient
    end
  end
  object Panel2: TPanel
    Left = 0
    Top = 384
    Width = 644
    Height = 57
    Align = alBottom
    Caption = 'Panel2'
    TabOrder = 1
    object Button1: TButton
      Left = 24
      Top = 16
      Width = 75
      Height = 25
      Caption = 'Play'
      TabOrder = 0
      OnClick = Button1Click
    end
    object Button2: TButton
      Left = 128
      Top = 16
      Width = 75
      Height = 25
      Caption = 'Stop'
      TabOrder = 1
      OnClick = Button2Click
    end
  end
  object FilterGraph1: TFilterGraph
    GraphEdit = True
    LinearVolume = True
    Left = 424
    Top = 144
  end
  object OpenDialog1: TOpenDialog
    Left = 344
    Top = 128
  end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T11:22:37.387

没有内置支持无缝循环。是的，您当然可以接收完成事件，从头开始播放并再次运行图表，但这不可避免地会产生重启延迟并且可能会闪烁。

要实现无缝循环，您可以使用多图解决方案，在演示图短暂暂停且不闪烁时重新启动上游图。或者以其他方式将自定义过滤器添加到管道中以在内部重新启动流式传输并将其呈现为连续流。

# objective-c - 如何在 UIViewController 中创建视图容器？

> ID：14176787
> 
> 赞同：0
> 
> 时间：2013-01-05T21:52:11.320
> 
> 标签：objective-c, ios, uiviewcontroller, storyboard

我似乎无法弄清楚如何创建一个像这个答案中的容器：[https ://stackoverflow.com/a/12574544/896334](https://stackoverflow.com/a/12574544/896334)

谁能提供步骤？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:07:40.810

使用故事板创建一个项目，在对象库中你会找到 ContainerView，现在只需将它拖放到你的 viewController 上，它就会为你工作。截图会帮助你

![在此处输入图像描述](../Images/df82596e2ec38a841a60cccf027c9fc6.png)

# jsp - 在 selectManyListbox 中显示数据库的结果

> ID：14176790
> 
> 赞同：1
> 
> 时间：2013-01-05T21:52:34.653
> 
> 标签：jsp, jsf, selectmanylistbox

我正在创建一个 JSF 应用程序。列的数据类型`set(a,b,c)`在 MySQL 中。每行都有一些选项，例如`a,c`or`a,b`等​​。我的应用程序中有一个列表框，其中 a、b、c 作为可用项目，用户可以选择多个项目。

当我在 MySQL 中编辑条目时，我需要使用 DB 中的值填充列表框。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T23:26:09.043

`value`只需在 bean 的（后）构造函数中以通常的方式设置您绑定到其属性的属性。

例如

```
<h:selectManyListbox value="#{bean.selectedItems}">
    <f:selectItems value="#{bean.availableItems}" />
</h:selectManyListbox> 
```

和

```
private List<String> selectedItems; // +getter+setter
private List<String> availableItems; // +getter

@PostConstruct
public void init() { 
    selectedItems = getItFromDatabase(); // <--- Look here. Just preset it.
    availableItems = Arrays.asList("a", "b", "c");
} 
```

### 也可以看看：

*   [我们的`selectOneMenu`维基页面](https://stackoverflow.com/tags/selectonemenu/info)

# firefox - 在 Javascript Scratchpad 中检查 Firefox Components.interfaces.nsIDOMWindowUtils.screenPixelsPerCSSPixel 值

> ID：14176792
> 
> 赞同：0
> 
> 时间：2013-01-05T21:52:40.497
> 
> 标签：firefox, scratchpad

我正在使用 Firefox Scratchpad 来了解用户键入`CTRL-PLUS`和`CTRL-MINUS`键时产生的缩放行为。在 Javascript Scratchpad 中，我正在评估一段 Javascript 代码，它可以 `Components.interfaces.nsIDOMWindowUtils.screenPixelsPerCSSPixel` 像这样访问该属性：

```
var util = window.QueryInterface(Components.interfaces.nsIInterfaceRequestor).getInterface(Components.interfaces.nsIDOMWindowUtils); 
util.screenPixelsPerCSSPixel 
```

在 Scratchpad中，在上面`CTRL-L`最后一个之后键入会导致异常：`l``screenPixelsPerCSSPixel`

```
Exception: The operation is insecure. 
```

（请注意，当前活动的 Firefox 标签指向[http://www.google.com](http://www.google.com)）。

在这种情况下，该`devtools.chrome.enabled`标志设置为 true，但这似乎并不重要，因为仍在抛出异常。

为了让 Javascript Scratchpad 显示该值，我需要做什么？

这只是暂时的，以便在调试过程中获得理解。暂时搁置“为什么显示比例因子会带来安全风险？”这个显而易见的问题。我只是在从标准和安全的 Firefox 控件（例如启用/禁用`about:config`值）的范围内获取值之后，我可以在完成后轻松撤消这些值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T18:44:43.650

这是我找到的答案：

从 Scratchpad 范围访问`window`其 Environment（请参阅其 Environment 菜单）设置为 Content 的变量会产生一种类型的对象，而如果 Environment 设置为 Browser，则正在播放不同类型的对象（`CTRL-L`在 Scratch pad 中报告它是类型`ChromeWindow`）。`window.content`对象是相对于对象的内容对象`ChromeWindow`。

的价值

```
....QueryInterface(Components.interfaces.nsIInterfaceRequestor).getInterface(Components.interfaces.nsIDOMWindowUtils).screenPixelsPerCSSPixel 
```

相对于`window`对象 ( `ChromeWindow`) 对象返回 `1`，同时在显示 1 以外的东西上调用它`window.content`并显示涉及缩放。

（编辑：我重新定位了曾经在这里的 Javascript 代码；见下文。）

为了演示如何使用该值，我在[Finding top-level X Window x/y coordinates of CTRL-F text in Firefox 中的另一个问题的回答中提供了一些示例Javascript](https://stackoverflow.com/a/14294786/257924)

# html - Bootstrap 导航栏自定义高度

> ID：14176795
> 
> 赞同：1
> 
> 时间：2013-01-05T21:52:46.760
> 
> 标签：html, css, twitter-bootstrap

我正在尝试缩小移动尺寸的导航栏高度。我试过缩小导航栏，但 JS 菜单不起作用。有任何想法吗？

```
.navbar-fixed-bottom { height:35px; } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T22:44:56.297

如果您下载[自定义版本](http://twitter.github.com/bootstrap/customize.html)或使用`less`css，只需将`@navbarHeight`变量更改为所需的高度。

当然，您可以手动更改它，但必须在多个地方完成。使用[`navbar.less`](https://github.com/twitter/bootstrap/blob/master/less/navbar.less)文件查找所有使用的参考`@navbarHeight`。

我也没有看到您只想在移动站点中执行此操作的事实。响应式设计的`.less`导航栏文件是[`responsive-navbar.less`](https://github.com/twitter/bootstrap/blob/master/less/responsive-navbar.less). 桌面和移动导航栏的高度相同，并且没有专门为移动导航栏设置任何内容，但如果没有大量测试，我不建议更改它。

# python - Python中的“ValueError：list.index（x）：x不在列表中”，但它存在

> ID：14176800
> 
> 赞同：1
> 
> 时间：2013-01-05T21:52:54.780
> 
> 标签：python, string-parsing

我想使用 Python 从电子邮件地址中提取用户名。我想到的解决方案是将电子邮件地址附加到列表中，找到`@`符号的索引，然后对列表进行切片，直到找到索引。

我的代码是：

```
#!/usr/bin/env python<br/>
email = raw_input("Please enter your e-mail address: ")
email_list = []
email_list.append(email)
at_symbol_index = email_list.index("@")
email_username = email_list[0:at_symbol_index]
print email_username 
```

但是，每次我运行脚本时，它都会返回错误：

```
ValueError: list.index(x): x not in list 
```

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-05T21:54:24.503

这样做的原因是您正在制作一个包含字符串的列表，因此除非输入的字符串是`"@"`，否则它不在列表中。

要解决此问题，只需不要将电子邮件地址添加到列表中。您可以直接对字符串执行这些操作。

请注意，您可能想改为结帐[`str.split()`](http://docs.python.org/3.3/library/stdtypes.html#str.split)，或者[`str.partition`](http://docs.python.org/3.3/library/stdtypes.html#str.partition)：

```
email_username, _, email_host = email.partition("@") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T21:56:08.193

您将整个电子邮件地址添加到列表中。你也许是说

```
email_list = list(email) 
```

它添加了（而不是一次整个字符串）的字符*。*`email`但即使这样也是不必要的，因为字符串可以像列表一样被切片/索引（所以在这种情况下你根本不需要列表）。

确定电子邮件地址的用户名的更简单方法可能是

```
email.split("@")[0] 
```

# c++ - Vim/Syntastic 对错误消息的不良抑制

> ID：14176801
> 
> 赞同：0
> 
> 时间：2013-01-05T21:52:55.907
> 
> 标签：syntastic, c++, vim, syntax-highlighting, syntastic

在更改我以允许从其原始位置读取它们之后，我正在使用***带有 vim/syntastic 的 Qt5 。***`.gvimrc`我注意到的问题是，在包含 Qt 库的文件中，所有形式的语法检查都被禁用。

我的相关部分`.gvimrc`如下：

```
au BufNewFile,BufRead *.cpp set syntax=cpp11
"set statusline+=%#warningmsg#
"set statusline+=%{SyntasticStatuslineFlag()}
"set statusline+=%*
let g:syntastic_cpp_include_dirs = ['/opt/Qt5.0.0/5.0.0/gcc_64/include/QtCore', '/opt/Qt5.0.0/5.0.0/gcc_64/include/QtWidgets']
set path=../include

let g:syntastic_cpp_check_header = 1
let g:syntastic_auto_loc_list = 0
let g:syntastic_enable_signs=1
let g:syntastic_quiet_warnings=1
set wildchar=<Tab> wildmenu wildmode=full 
```

.. 只是为了说明，下面的代码块中有一个浮点数字符串，vim 不会将其标记为语法错误；只要我 #include 顶部的 Qt 头文件，它就不会显示任何错误。如果我从 cpp 文件中删除它们，或者在 gvimrc 中删除将 syntastic 连接到它们的条目，语法突出显示将正常恢复。

```
#include <qapplication.h>
#include <qsplitter.h>
#include <qlistview.h>
#include <qstringlist.h>
#include <qstandarditemmodel.h>
int main(int argc, char* argv[]){
    QApplication app (argc,argv);
    QSplitter *splitter = new QSplitter;

    QStandardItemModel model(2,1,343,44)sd2;
    QListView *list = new QListView (splitter);
    list->setModel(model);

    splitter->show();
    return app.exec();
8098707807

    //Creating a list of objects to be shown in the view 
    QList<QString> indices;
    indices<<"ABC"<<"JKL";
    model.setItem(0,0,indices[0]);
} 
```

查看`.gvimrc`上面的脚本是我做错了什么还是[syntastic](/questions/tagged/syntastic "显示标记为“合成”的问题")不支持这些标头？

# java - 如何绘制不同角度的边缘？

> ID：14176804
> 
> 赞同：0
> 
> 时间：2013-01-05T21:53:05.007
> 
> 标签：java, layout, geometry, jung, edges

我使用 Jung2 为我的图表使用 CircleLayout。我重写了该`initiate()`方法，以便根据其 id 在圆中的某个位置绘制顶点。这意味着顶点在圆上不规则地分布。

现在我有一个问题：由于边缘的绘制方式，图形不再像圆形了。

![http://imageshack.us/a/img560/9763/circlef.jpg](../Images/7e88e43034901b18d02c067da5d3f48b.png)

有没有办法让边缘再次看起来像一个圆圈？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T04:52:40.987

您需要提供不同的（自定义）边缘渲染器；请参阅中的代码以`jung.visualization.renderers`获取指导。您将其提供给可视化系统，如下所示：

`VisualizationServer.getRenderer().setEdgeRenderer(yourCustomEdgeRenderer);`

或者，如果你真的只是想让它看起来像一个圆圈，你可以这样做：
(0) 使用预渲染 Paintable 绘制一个圆圈。（演示展示了它是如何工作的。）
(1) 提供一个总是返回假的边缘渲染谓词，即确保没有任何边缘被渲染。

这将比在每对连接的顶点之间绘制适当的圆弧更容易和简单。

# .htaccess - htaccess 重写（文件夹中的文件夹和文件重定向）

> ID：14176806
> 
> 赞同：1
> 
> 时间：2013-01-05T21:53:09.810
> 
> 标签：.htaccess

我有一些文件夹和文件夹中的文件，我想做一个 301 重定向到我想要的 PHP 文件：

/文件夹/ > /file.php

/文件夹/index.html > /file.php

我试过用谷歌搜索，但找不到我要找的东西。

谁能帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T10:36:21.780

我已经解决了，这就是我正在使用的，它对我有用

```
RedirectMatch 301 ^/folder/(.*)$ /file.php 
```

# mysql - MySQL：如何使用 LEFT JOIN 对行进行编号

> ID：14176807
> 
> 赞同：0
> 
> 时间：2013-01-05T21:53:20.793
> 
> 标签：mysql, sql

我的 MySQL 查询是针对报告的，所以我想对每一行进行编号。换句话说，我想添加一个像“rank”这样的字段，第一行是 1，第二行是 2，等等。

[我已经看到这里](http://jimlife.wordpress.com/2008/09/09/displaying-row-number-rownum-in-mysql/)和[这里](https://stackoverflow.com/questions/4031599/how-can-i-count-the-row-number-in-the-returned-group-of-mysql-query)使用子查询完成了这项工作。从评论来看，这种方法似乎是正确的，但它不适用于我的具体查询。我相信是因为我有几个`JOIN`s，但我不确定。我可以让查询无错误地运行，但是当我完全按照上述帖子中的说明添加行号时，“排名”列出现故障。

这是我的原始查询，没有添加排名：

```
SELECT wsat_ib.user_id, wpjb_resume.id resume_id, wpjb_resume.firstname, wpjb_resume.lastname, wsat_ib.overall_score, wsat_ib.account_score, wsat_ib.econ_score, wsat_ib.math_score, wsat_ib.logic_score, wsat_ib.fsanaly_score, wsat_ib.corpval_score, wsat_ib.end_time, GROUP_CONCAT(DISTINCT wp_usermeta.meta_value) AS target_employers, wpjb_field_value.value AS school, GROUP_CONCAT(wpjb_application.job_id) AS applications FROM  `wsat_ib` 
    LEFT JOIN wp_usermeta ON wsat_ib.user_id = wp_usermeta.user_id
    LEFT JOIN wpjb_resume ON wsat_ib.user_id = wpjb_resume.user_id
    LEFT JOIN wpjb_field_value ON wpjb_resume.id=wpjb_field_value.job_id AND wpjb_field_value.field_id=3
    LEFT JOIN wpjb_application ON wpjb_application.user_id = wsat_ib.user_id 
    WHERE (wp_usermeta.meta_key = 'target_employer' AND (wp_usermeta.meta_value = 'public' OR wp_usermeta.meta_value=2) AND wpjb_resume.is_active =1)
    GROUP BY wsat_ib.user_id, resume_id, wpjb_resume.firstname, wpjb_resume.lastname, wsat_ib.overall_score, wsat_ib.account_score, wsat_ib.econ_score, wsat_ib.math_score, wsat_ib.logic_score, wsat_ib.fsanaly_score, wsat_ib.corpval_score, wsat_ib.end_time, wpjb_field_value.value
     ORDER BY end_time DESC LIMIT 0, 20 
```

这是我添加排名字段的失败尝试：

```
SELECT @row := @row + 1 as row, wsat_ib.user_id, wpjb_resume.id resume_id, wpjb_resume.firstname, wpjb_resume.lastname, wsat_ib.overall_score, wsat_ib.account_score, wsat_ib.econ_score, wsat_ib.math_score, wsat_ib.logic_score, wsat_ib.fsanaly_score, wsat_ib.corpval_score, wsat_ib.end_time, GROUP_CONCAT(DISTINCT wp_usermeta.meta_value) AS target_employers, wpjb_field_value.value AS school, GROUP_CONCAT(wpjb_application.job_id) AS applications FROM (SELECT @row := 0) r, `wsat_ib` 
LEFT JOIN wp_usermeta ON wsat_ib.user_id = wp_usermeta.user_id
LEFT JOIN wpjb_resume ON wsat_ib.user_id = wpjb_resume.user_id
LEFT JOIN wpjb_field_value ON wpjb_resume.id=wpjb_field_value.job_id AND wpjb_field_value.field_id=3
LEFT JOIN wpjb_application ON wpjb_application.user_id = wsat_ib.user_id 
WHERE (wp_usermeta.meta_key = 'target_employer' AND (wp_usermeta.meta_value = 'public' OR wp_usermeta.meta_value=2) AND wpjb_resume.is_active =1)
GROUP BY wsat_ib.user_id, resume_id, wpjb_resume.firstnam[...] 
```

查询运行没有错误，但排名列不是 1、2、3、4... 而是：496,498,497,499...

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T22:39:43.757

您的行号与您期望的不一样，因为您的 SQL 查询中有一个`GROUP BY`子句。该`SELECT`行在分组之前对每一行进行评估。

要解决您的问题，您可以使用嵌套查询，例如：

```
SELECT *, @row := @row + 1 AS row FROM (SELECT ...) AS t; 
```

您提供的查询将是：

```
SELECT *, @row := @row + 1 AS row FROM (
    SELECT wsat_ib.user_id, wpjb_resume.id resume_id, wpjb_resume.firstname, wpjb_resume.lastname, wsat_ib.overall_score, wsat_ib.account_score, wsat_ib.econ_score, wsat_ib.math_score, wsat_ib.logic_score, wsat_ib.fsanaly_score, wsat_ib.corpval_score, wsat_ib.end_time, GROUP_CONCAT(DISTINCT wp_usermeta.meta_value) AS target_employers, wpjb_field_value.value AS school, GROUP_CONCAT(wpjb_application.job_id) AS applications FROM  `wsat_ib`
        LEFT JOIN wp_usermeta ON wsat_ib.user_id = wp_usermeta.user_id
        LEFT JOIN wpjb_resume ON wsat_ib.user_id = wpjb_resume.user_id
        LEFT JOIN wpjb_field_value ON wpjb_resume.id=wpjb_field_value.job_id AND wpjb_field_value.field_id=3
        LEFT JOIN wpjb_application ON wpjb_application.user_id = wsat_ib.user_id
        WHERE (wp_usermeta.meta_key = 'target_employer' AND (wp_usermeta.meta_value = 'public' OR wp_usermeta.meta_value=2) AND wpjb_resume.is_active =1)
        GROUP BY wsat_ib.user_id, resume_id, wpjb_resume.firstname, wpjb_resume.lastname, wsat_ib.overall_score, wsat_ib.account_score, wsat_ib.econ_score, wsat_ib.math_score, wsat_ib.logic_score, wsat_ib.fsanaly_score, wsat_ib.corpval_score, wsat_ib.end_time, wpjb_field_value.value
        ORDER BY end_time DESC LIMIT 0, 20) AS t
  CROSS JOIN
    (SELECT @row := 0) AS r 
ORDER BY end_time DESC ; 
```

# c - 为什么 G_DEFINE_INTERFACE 会触发“预期的声明说明符”编译器错误？

> ID：14176810
> 
> 赞同：2
> 
> 时间：2013-01-05T21:53:28.577
> 
> 标签：c, glib, gobject

作为熟悉 GObject 的一部分，我正在尝试按照[参考手册中的示例](http://developer.gnome.org/gobject/stable/howto-interface.html)创建一个“Hello, world”界面。这是我所拥有的`hello_world_if.h`：

```
#ifndef __HELLO_WORLD_IF_H__
#define __HELLO_WORLD_IF_H__

#include <glib-object.h>

G_BEGIN_DECLS

#define TYPE_HELLO_WORLD_IF                (hello_world_if_get_type())
#define HELLO_WORLD_IF(obj)                (G_TYPE_CHECK_INSTANCE_CAST((obj), TYPE_HELLO_WORLD_IF, HelloWorldIf))
#define IS_HELLO_WORLD_IF(obj)             (G_TYPE_CHECK_INSTANCE_TYPE((obj), TYPE_HELLO_WORLD_IF))
#define HELLO_WORLD_IF_GET_INTERFACE(inst) (G_TYPE_INSTANCE_GET_INTERFACE((inst), TYPE_HELLO_WORLD_IF, HelloWorldIfInterface))

typedef struct _HelloWorldIf HelloWorldIf; /* dummy object */
typedef struct _HelloWorldIfInterface HelloWorldIfInterface;

struct _HelloWorldIfInterface {
  GTypeInterface parent;

  gchar *(*get_hello)(HelloWorldIf *self);
};

GType hello_world_if_get_type(void);

gchar *hello_world_if_get_hello(HelloWorldIf *self);

G_END_DECLS

#endif /* __HELLO_WORLD_IF_H__ */ 
```

并在`hello_world_if.c`：

```
#include "hello_world_if.h"

G_DEFINE_INTERFACE(HelloWorldIf, hello_world_if, 0);

static void
hello_world_if_default_init(gpointer g_class) {
  /* Add properties and signals to the interface here */
}

gchar *
hello_world_if_get_hello(HelloWorldIf *self) {
  g_return_if_fail(IS_HELLO_WORLD_IF(self));

  HELLO_WORLD_IF_GET_INTERFACE(self)->get_hello(self);
} 
```

但这不会编译：

```
$ make
gcc -g -pthread -I/usr/include/glib-2.0 -I/usr/lib/glib-2.0/include   -c -o hello_world_if.o hello_world_if.c
hello_world_if.c:3: error: expected declaration specifiers or ‘...’ before ‘hello_world_if’
hello_world_if.c:3: error: expected declaration specifiers or ‘...’ before numeric constant
hello_world_if.c:3: warning: data definition has no type or storage class
make: *** [hello_world_if.o] Error 1 
```

从此处阅读其他答案看来，此“预期的声明说明符”消息通常意味着[尚未包含必要的头文件](https://stackoverflow.com/questions/5001346/error-expected-declaration-specifiers-or-before-list-node)或[包含得太晚](https://stackoverflow.com/questions/9503473/math-h-compilation-error-expected-declaration-specifiers-or-before/9505424#9505424)。但我不确定这里怎么会是这样。（具体来说，向 C 文件添加`#include <glib.h>`或`#include <glib-object.h>`不会改变任何东西。）

我一定错过了一些简单的东西，但我只是看不到它。帮助？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T22:18:47.997

原来有一个简单的解释：`G_DEFINE_INTERFACE`宏是[在 GLib 2.24.0 中添加的](https://mail.gnome.org/archives/gnome-announce-list/2010-March/msg00067.html)，但我使用的是 2.22.5 版本（CentOS 6.3 上的标准）。我需要构建和安装新版本的 GLib，或者挖掘旧的参考文档——[该网站](http://developer.gnome.org/gobject/)不会超过 2.26.1。

# javascript - 从客户端设置和清除节点服务器超时

> ID：14176811
> 
> 赞同：3
> 
> 时间：2013-01-05T21:53:35.897
> 
> 标签：javascript, node.js, redis, socket.io

我试图允许用户从客户端设置警报并将其传递给服务器。然后服务器有一个 setTimeout 倒计时，当时间用完时，执行该函数。

第一部分工作正常，但是，如果客户端决定取消该特定警报，我需要能够清除相同的超时。

注意：我一直在使用 Redis 存储各种数据，因此可用。

```
var client = redis.createClient();
io.set("store", new sio.RedisStore);

io.sockets.on('connection', function (socket) {

socket.on('alarm:config', function(list, date, time, bool) {

  if (bool) {

    var now = new Date().getTime();

    var year = date[0],
        month = date[1] - 1,
        day = date[2];

    var hour = time[0],
        minutes = time[1];

    var alarm = new Date(year, month, day, hour, minutes);

    var countdown = alarm - now;

    var myAlarm = setTimeout(function() {

      // do stuff...

    }, ( countdown ) );

  } else {

    clearTimeout(myAlarm);

  }

});
}); 
```

我想到的方法是我将使用布尔值来确定用户是否正在设置或取消该特定警报。**我意识到设置一个局部变量“myAlarm”是行不通的，我只是把它放在那里传达这个想法。**

我试图找出一种方法来存储对该确切超时的引用，以便下次使用错误的布尔值触发“alarm：config”套接字事件时，它可以取消之前设置的超时。

这可能是另一个问题，但是像谷歌日历这样的应用程序如何存储日期和时间，然后准确地知道何时触发它以及提供取消它的能力？这基本上是相同的想法。

**更新：我使用以下解决方案让它工作。我愿意接受更优雅的解决方案。**

```
socket.on('alarm:config', function(list, date, time, bool) {

  var alarmName = "timer:" + list;

  if (bool) {

    client.hset(alarmName, "status", true);

    var now = new Date().getTime();

    var year = date[0],
        month = date[1] - 1,
        day = date[2];

    var hour = time[0],
        minutes = time[1];

    var alarm = new Date(year, month, day, hour, minutes);

    var countdown = alarm - now;

    setTimeout(function() {

      client.hget(alarmName, "status", function(err, bool) {

        if(bool == 'true') {

          // do stuff...

        } else {

          console.log("This alarm has been canceled.");

        }

      });

    }, ( countdown ) );

  } else {

    console.log('canceling alarm');
    client.hset(alarmName, "status", false);

  }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T22:45:19.250

根据您正在构建的应用程序的大小，有几个选项。

# 处理队列

您可以重组您的应用程序以使用作业队列，而不是简单地设置计时器。这有一个优点，您可以在将来将其拆分为多个进程，但它确实使处理变得有点复杂。

像[Kue](https://github.com/LearnBoost/kue)这样的库只使用 Redis，并允许您在将来执行延迟设置事件。

从 Kue 自述文件开始：

```
var kue = require('kue')
  , jobs = kue.createQueue();

// Create delayed job (need to store email.id in redis as well)
var email = jobs.create('email', {
    title: 'Account renewal required',
    to: 'tj@learnboost.com',
    template: 'renewal-email'
}).delay(minute).save();

// Process job
jobs.process('email', function(job, done){
  email(job.data.to, done);
});

// Cancel job
email.remove(function(err){
  if (err) throw err;
  console.log('removed completed job #%d', job.id);
}); 
```

# 存储对超时的引用

这不那么健壮，但可以让您非常简单地做到这一点。它使全局变量四处浮动，并且如果进程崩溃则无法恢复。

基本上，您将计时器存储在全局变量中并根据作业 ID 取消它。

```
var myAlarms = {}

socket.on('alarm:config', function(list, date, time, bool) {
  var alarmName = "timer:" + list;

  if (bool) {

    myAlarms[alarmName] = setTimeout(function() {
      // do stuff...
    }, countdown);

  } else {
    clearTimeout(myAlarms[alarmName]);
  }
} 
```

*注意：此代码均未经过测试，可能包含错误。*

# php - 如何将百分比符号添加到从 sql 查询输出的字符串值

> ID：14176814
> 
> 赞同：4
> 
> 时间：2013-01-05T21:54:08.347
> 
> 标签：php, sql, css, video

这可能比我想象的要简单，但是我很难理解这一点。在中断了 10 年之后，我一直在努力学习如何编码，所以黑客和 codecademy 是我的老师。无论如何， ...

我想要做的只是从一个 sql 条目中取一个整数百分比。

我有一个表单，在提交时输入一个用于输出 css 值的 sql 值整数。我只是试图**将宽度值从整数更改为百分比**，以允许一些相似的响应效果。

这是php预输出：

```
 <video id="vp2_html5_rightSidePlaylist_'.$row["id"].'" width="'.$row["playerWidth"].'%" height="'.$row["playerHeight"].'" '.$preload_aux.'><div class="xplaylist">'.$playlist_str.'</div></video> 
```

输出如下：

```
 <video id="vp2_html5_rightSidePlaylist_1" width="100" height="297" preload="auto" src="http://localhost:888/test.mp4"> 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T21:59:48.813

如果您使用的是 mysql，则可以使用该[`CONCAT()`函数](http://dev.mysql.com/doc/refman/5.0/en//string-functions.html#function_concat)在特定字段的末尾添加一些字符。

> **`CONCAT(str1,str2,...)`**- 返回由连接参数产生的字符串。

例如 -

```
SELECT `id`,`title`,CONCAT(`percentage`,'%') as percentage FROM `items` LIMIT 100 
```

现在，存储在该`percentage`字段中的任何值都将`%`在结果集中附加一个字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T22:25:45.330

我想这不是您的编码问题。

我可以假设你得到了这个：

```
<video id="vp2_html5_rightSidePlaylist_1" width="100" height="297" preload="auto" src="http://localhost:888/test.mp4"> 
```

..通过像萤火虫/开发者工具这样的工具？

如果是，这不是原始来源，已经清理了无效部分。

其中之一是百分号，它在宽度属性内无效。要获得所需的结果，请改用 css：

```
'style="width:'.$row["playerWidth"].'%;height:'.$row["playerHeight"].'px;"' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T22:01:04.053

用这个：

```
Select CONCAT(`playerWidth`,'%') AS playerWidth, id .....etc FROM tableName 
```

# sql - 简单平均算法有点关闭。为什么？活动记录/PostgreSQL 问题？

> ID：14176817
> 
> 赞同：1
> 
> 时间：2013-01-05T21:54:21.463
> 
> 标签：sql, ruby-on-rails, activerecord, timezone

在我的 Rails 应用程序中，我每 30 分钟运行两个自定义 Rake 任务。 **任务 A**从 Internet 上抓取每小时价格并将其作为 HourlyPrice 保存到数据库中。 **任务 B**进入数据库，从过去 7 天的每一天获取每小时价格，并将它们平均以在单独的数据库表中创建新的 DailyAveragePrice 记录。

但是，在运行任务 B 时，最后一天的（七个）平均价格不正确。

在 Excel 电子表格中摆弄了当天的每小时价格后，我看到任务 B 生成的平均价格是仅用*最后三个小时*取平均值的结果。

任务 B 主要通过这个单一查询完成：

```
averages = HourlyPrice.where('date >= ?', 7.days.ago).average(:price, :group => "DATE_TRUNC('day', date - INTERVAL '1 hour')") 
```

我不明白为什么会这样？

**线索**

1.  HourlyPrice 有两个属性（日期时间、价格）。每个 HourlyPrice 实际上代表前一小时的价格。因此，源数据列出了 PostgreSQL 不想按原样导入日期时间列的每天 24:00:00 的价格。相反，它将所有 24:00:00 的价格转换为第二天的 00:00:00。为了弥补这一点，我尝试减去一个小时的间隔，正如您在查询中看到的那样。这是造成问题的原因吗？
2.  我的 ActiveRecord 的时区当前设置为“山地时间（美国和加拿大）”。那是价格交易所所在的地方。我没有调整我的 PostgreSQL 数据库的时区，我相信它默认为 UTC。运行任务 B 时，我注意到现在是 UTC 时间晚上 9:20，UTC 天还剩 3 个小时，这可能解释了 7 天最后一天只有三个 HourlyPrice 的平均值。我会在接下来的一个小时内再次尝试运行任务 B，看看它是否平均只有两个小时。即将更新...这个时区冲突是否会导致问题，或者我正在做的事情是否与时区隔离，因为我有自己的日期列？

**更新 - 发现问题，但如何解决？** 线索 #2 是正确的。这是一个时区问题。我刚刚再次运行任务 B（一小时后，距离 UTC 日期更改还剩 2 小时），现在在 7 天的最后一天平均只有两个 HourlyPrice。

仅当有 24 HourlyPrice 记录可用时，我如何才能将上面的查询修复为平均？

# regex - 正则表达式多次替换。替换 Mmm->dd

> ID：14176820
> 
> 赞同：-3
> 
> 时间：2013-01-05T21:54:40.180
> 
> 标签：regex, replace, expression

是否可以用多模式替换。

字符串：（一月|二月|三月|四月|五月|六月|七月|八月|九月|十月|十一月|十二月）

替换：字符串：(01|02|03|04|05|06|07|08|09|10|11|12)

例如：

```
String: 05 Jan 2013 -> 05 01 2013

String: 20 Nov 2012 -> 05 11 2012 
```

希望有意义

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T00:13:36.090

不，这是不可能的 - 至少不是你描述的方式，也不是我曾经使用过的任何正则表达式引擎。对于您寻求的效果的简洁近似，您可以获得的最接近的方法是链接替换。以 JavaScript 为例：

```
var newString = '05 Jan 2013'.replace(/Jan/i, '01').replace(/Feb/i, '02').replace(/Mar/i, '03').replace(/Apr/i, '01'); //And so on 
```

# django - id 想显示用 django-tables2 呈现的我的表中的列之一的列总数

> ID：14176821
> 
> 赞同：0
> 
> 时间：2013-01-05T21:54:41.040
> 
> 标签：django, django-models, django-templates, django-views

有没有办法在 django-tables2 中显示特定列的总数？

如果您需要获取我的用例，这是我的极简模型：

```
class timekeeper(models.Model):
     begin_time = models.DateTimeField()
     end_time = models.DateTimeField()
     timedelta = models.FloatField()

     def save(self):
         timedelta = end_time-begin_time 
```

我有多个条目，我想合计列中的时间增量。我看到一个关于这样的讨论[，](https://github.com/bradleyayers/django-tables2/issues/28)但我无法理解它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T13:33:34.527

你可以这样试试

```
class timekeeper(models.Model):
     begin_time = models.DateTimeField()
     begin_time = models.DateTimeField()
     ^^ duplicate field, it should be end_time ??
     timedelta = models.FloatField()

     def save(self):
         self.timedelta = self.end_time - self.begin_time 
```

# javascript - for 循环中的 Javascript 闭包：为什么循环索引 i 不可见？

> ID：14176829
> 
> 赞同：0
> 
> 时间：2013-01-05T21:55:56.343
> 
> 标签：javascript, closures

假设给定一个函数（它是对象的一部分，别担心）

```
makeClosures : function(arr, fn) {}, 
```

其中参数首先是一个数组，例如`[1, 2, 3, 4]`，其次是一个对给定数字求平方的函数（称为 doSomeStuff）

`var doSomeStuff = function (x) { return x * x; }`

`makeClosures`应该返回一个与 大小相同的数组`arr`，其中每个元素都包含对基本上调用`doSomeStuff`.

所以这是我的实现：

```
makeClosures : function(arr, fn) {
  var funcs = [];

  for (var i = 0; i < arr.length; i++) {
    var f = function() {
      return fn(arr[i]);
    };

    funcs.push(f);
  }

  return funcs;
}, 
```

问题**是**：

当我运行我的程序时，返回`f`值为`NaN`. 我尝试使用实际数字（`return fn[1]`, `return fn(arr[0])`）然后它起作用了，这意味着问题出在`arr[i]`（未定义？）。我怀疑内部函数`f`没有看到循环索引`i`。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T22:13:07.523

Pointy 的评论：

“在 JavaScript 中，词法作用域发生在函数级别。在循环中构造的所有函数共享同一个变量“i”。在循环结束时，“i”的值是多少？对：arr.length。什么是arr[arr.length] 的值？”

返回的函数在循环迭代后执行，var i 仍在作用域内，array.length 的值超出了数组的范围。

此外，您应该在 for 循环之外声明 f ，范围是在函数级别创建的，而不是在循环内部，因此您在循环的每次迭代中已经存在 f 时声明它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-05T22:35:41.070

不确定天气会有所帮助，但这是我尝试和工作的。

```
var arr = [1, 2, 3, 4]
var fn = function (x) { return x * x; }

function makeClosures(arr, fn) {
    var funcs = [];   

    for (var i = 0; i < arr.length; i++) {     

        var f =  fn(arr[i]);       

        funcs.push(f);
    }

    return funcs;
}

myarr = makeClosures(arr, fn);

for (var j = 0; j < myarr.length; j++) {
    alert(arr[j] + ' square is : ' + myarr[j]);
} 
```

# python - 有没有办法测试 Python 函数或方法是否直接从 shell 调用？

> ID：14176833
> 
> 赞同：2
> 
> 时间：2013-01-05T21:56:22.357
> 
> 标签：python, invoke

添加到[rake](https://stackoverflow.com/q/7201205/656912)和[PHP](https://stackoverflow.com/q/2671649/656912)列表：有没有办法测试 Python 函数或方法是否已直接从 Python shell 调用，而不是从`.py`脚本文件中调用？

例如我想定义一个表达式，`test_expr`当表达式出现在模块“shelltest.py”中时，其行为如下，

```
#!/usr/bin/python
"""Module shelltest.py"""

def test_expr():
    #... 
```

案例（1）：`True`直接从 shell 调用时产生

```
>>> import shelltest
>>> shelltest.test_expr()
True 
```

案例（2）：`False`当导入另一个模块“other.py”并在那里的代码中使用时，它会产生

```
#!/usr/bin/python
"""Module other.py"""

import shelltest

def other_func():
    # ...
    shelltest.test_expr() 
```

依次从外壳调用

```
>>> import other
>>> other.other_func()
False 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T22:01:02.553

如果你在 shell 中，那么`__name__ == '__main__'`. （此外，正如 Ned Batchelder 所说，这只会告诉您函数的定义位置。）

您可能不想在函数中测试它 - 它用于区分模块是否被称为主程序。无论如何，您的函数可能应该以相同的方式工作，如果您需要不同的函数，则应该导入包含相同函数名称的不同模块。

做这样的事情：

```
if __name__ == '__main__':
   import formain as bumpf
else:
   import forscripts as bumpf

bumpf.domagic() 
```

至于确定您是否处于 Web 环境中 - 在仅从 Web 调用的代码中执行此操作。Python 脚本通常不会被 CGI 调用，因此这并没有真正作为用例出现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T22:09:22.807

```
>>> import sys
>>> called_via_shell = lambda: sys.stdin.isatty()
>>> called_via_shell()
True 
```

更多信息和代码示例在这里： [http ://pleac.sourceforge.net/pleac_python/userinterfaces.html#AEN795](http://pleac.sourceforge.net/pleac_python/userinterfaces.html#AEN795)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T22:02:43.270

我最喜欢的检查方法是检查`sys.ps1`.

```
Python 2.7.3 (default, Aug  1 2012, 05:14:39) 
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> print sys.ps1
'>>> '
$ cat > script.py
#!/usr/bin/env python
import sys
print sys.ps1
$ python script.py 
Traceback (most recent call last):
  File "script.py", line 3, in <module>
    print sys.ps1
AttributeError: 'module' object has no attribute 'ps1' 
```

我认为其他答案是错误的，因为`__name__`在`__main__`脚本和交互式 shell 中。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-05T22:01:09.530

如果此**模块**是从 shell 执行的，`__name__`将设置为`__main__`. 否则，它将被设置为调用模块的名称。你会一直在模块中看到这个习语：

```
if __name__ == '__main__':
  # do something with the library 
```

# delphi - 使用 FPC 编写 Scheme 解释器：分配和指针

> ID：14176834
> 
> 赞同：4
> 
> 时间：2013-01-05T21:56:26.433
> 
> 标签：delphi, scheme, pascal, freepascal, sicp

作为一名历史学家，在 FPC 中编写[Scheme 解释器](https://stackoverflow.com/questions/14164783/writing-a-scheme-interpreter-with-fpc-recursive-data-structures)已经在第一阶段对我来说是一项严肃的任务。:) 我正在关注 Peter Michaux 的博客，[他展示了如何在 C 中执行此操作](http://michaux.ca/articles/scheme-from-scratch-introduction)（还有对[Ada](https://github.com/fitzgen/ada-scheme)的翻译，这可能对 Pascal 有帮助）。

考虑 Michaux 的工作 (v 0.1) 中的 C 语言中的这两个函数：

```
object *alloc_object(void) {
    object *obj;

    obj = malloc(sizeof(object));
    if (obj == NULL) {
        fprintf(stderr, "out of memory\n");
        exit(1);
    }
    return obj;
}

object *make_fixnum(long value) {
    object *obj;

    obj = alloc_object();
    obj->type = FIXNUM;
    obj->data.fixnum.value = value;
    return obj;
} 
```

据我了解（只是C中的基本阅读知识），构造函数`make_fixnum`返回一个指向结构的指针（类型为fixnum的标记数据）；对于构造的对象，必须分配内存（感谢@David Heffernan 昨天的[观点](https://stackoverflow.com/questions/14164783/writing-a-scheme-interpreter-with-fpc-recursive-data-structures/14164933#14164933)）。

到目前为止，这是我对 FPC 的翻译，编译时没有任何错误：

```
program scheme;

type
   TTag = (ScmFixnum);
   PScmObject = ^TScmObject;
   TScmObject = record
      case ScmObjectTag: TTag of
         ScmFixnum: (ScmObjectFixnum: integer);
      end;

var Test: PScmObject = nil;

procedure AllocateObject(x: PScmObject);
begin
    new(x);
end;

function MakeFixnum(x: integer): PScmObject;
var
   fixnum: PScmObject = nil;
begin
   AllocateObject(fixnum);
   fixnum^.ScmObjectTag := ScmFixnum;
   fixnum^.ScmObjectFixnum := x;
   MakeFixnum := fixnum;
end;

begin
   Test := MakeFixnum(1);
   writeln(Test^.ScmObjectTag);
   writeln(Test^.ScmObjectFixnum);
end. 
```

然而...：

```
$ ./test 
Runtime error 216 at $080480DD
  $080480DD
  $08048117
  $08063873 
```

我怀疑，我使用和引用指针的方式存在严重缺陷。

非常感谢任何帮助我理解指针和内存的工作原理的人（也欢迎参考常见问题解答、论文等）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-05T22:14:23.117

您的 AllocateObject 函数是错误的。它在变量 x 中创建一个新对象，但它不会将创建的对象传递给调用函数，因为它是按值调用的。如果您更改调用约定，它将起作用：

```
 procedure AllocateObject(out x: PScmObject);
 begin 
    new(x);
 end; 
```

您可以看到，如果您查看调试器中的 fixnum 变量，它保持为零。

* * *

* * *

与您的问题无关，我认为在口译员中使用记录不是一个好主意。它很快变成了内存管理的噩梦（至少发生在我写的一个解释器接近 20 kloc 时，我不得不按如下方式替换记录：）

而不是你的记录

```
 PScmObject = ^TScmObject;
 TScmObject = record
    case ScmObjectTag: TTag of
       ScmFixnum: (ScmObjectFixnum: integer);
    end; 
```

您可以使用类，例如：

```
TScmObject = class()
  function Tag: TTag; virtual; abstract;
  function Fixnum: integer; virtual; abstract;
end;
TScmObjectFixNum = class(TScmObject)
  function Tag: TTag; override;
  function Fixnum: integer; override;
private
  value: integer;
end;

function TScmObjectFixNum.Tag: TTag;
begin
  result := ScmFixnum; 
end;
function TScmObjectFixNum.Fixnum: integer; 
begin
  result := value; 
end; 
```

然后您可以轻松地创建它

```
 var x: TScmObject;
 x := TScmObjectFixNum.create() ;
 if x.tag = scmfixnum (* or x is TScmObjectFixNum *) then
    ... x.scmfixnum ...
 x.free 
```

如果您的方案实现中没有循环引用，您甚至可以使用接口。然后它被引用计数并自动释放：

```
IScmObject = interface
  function Tag: TTag;
  function Fixnum: integer;
end;
TScmObject = class(TInterfacedObject, IScmObject)
  function Tag: TTag; virtual; abstract;
  function Fixnum: integer; virtual; abstract;
end;
TScmObjectFixNum = class(TScmObject)
  function Tag: TTag; override;
  function Fixnum: integer; override;
private
  value: integer;
end;

 var x: IScmObject;
 x := TScmObjectFixNum.create() ;
 if x.tag = scmfixnum (* or x is TScmObjectFixNum *) then
    ... x.scmfixnum ...
 //x.free no longer necessary (or allowed)! 
```

# android - 我可以将三星 Galaxy Ace 用于我正在创建的应用程序吗？

> ID：14176837
> 
> 赞同：-1
> 
> 时间：2013-01-05T21:56:59.670
> 
> 标签：android

我是创建 android 应用程序的初学者，我想要一种便宜的方法来测试我的应用程序，并且看到三星 Galaxy Ace 相当便宜。（这个电话已经有一段时间了）。

这是否足够，因为它安装了较旧的操作系统。一些网站说他们有 Android 2.2 (Froyo) 和其他 Android 2.3 (Gingerbread)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T22:01:09.817

我至少会确保它有 2.3，但它对于测试应用程序来说就很好了。android 社​​区的问题之一是旧的软件版本。Android 开发人员更喜欢为 4.0 - 4.2 上的设备进行开发，因为 4.0 具有更多功能，而且旧的姜饼设备越早退出市场，并且为减少碎片化而开发。

但是你的问题的答案是肯定的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T23:27:50.903

仍然有很多设备运行 Gingerbread 和 Froyo。确保您的应用程序在旧设备上运行通常是一种很好的做法。无论如何，您始终可以使用模拟器进行测试（大部分您希望测试的内容）。

# eclipse - 从 Eclipse 部署到远程 linux JBoss 服务器

> ID：14176838
> 
> 赞同：4
> 
> 时间：2013-01-05T21:57:20.817
> 
> 标签：eclipse, deployment, jboss, remote-server

我的开发计算机是 Windows。我想将一些 JBoss 示例 Web 应用程序从 Eclipse（在 Windows 上）部署到我在 CentOS 上运行的远程 JBoss 服务器。他们都安装了 JBoss 和 Java。我认为由于它们有不同的操作系统，Eclipse 并没有看到 CentOS 具有所需的 JBoss 包。在“新服务器”选项下，当我进入 CentOS 服务器时，我指定这是一个 Unix 服务器。有什么办法可以让这个工作，还是我在死胡同？顺便说一句，我可以在 Eclipse 中远程浏览文件结构或使用服务器的命令行，就可以了。

谢谢，

以下是我收到的一些错误：

16:19:43,489 错误 [org.jboss.msc.service.fail]（MSC 服务线程 1-1）MSC00001：无法启动服务 jboss.network.public：服务 jboss 中的 org.jboss.msc.service.StartException。 network.public：JBAS015810：无法解析公共接口

16:19:48,341 INFO [org.jboss.weld.deployer]（MSC 服务线程 1-4）JBAS016005：启动 CDI 部署服务：ticket-monster.war

16:19:48,361 INFO [org.jboss.weld.Version]（MSC 服务线程 1-4）WELD-000900 1.1.5 (AS71)

16:19:48,431 INFO [org.jboss.as]（MSC 服务线程 1-4）JBAS015954：未启用管理控制台

16:19:48,431 错误 [org.jboss.as]（MSC 服务线程 1-4）JBAS015875：JBoss AS 7.1.1.Final “Brontes”在 6743 毫秒内启动（有错误） - 启动了 308 个服务中的 185 个（75 个服务失败或缺少依赖项，47 个服务是被动的或按需的）

16:19:48,631 INFO [org.jboss.as.server]（DeploymentScanner-threads - 2）JBAS015870：部署“ticket-monster.war”的部署已回滚，并显示失败消息 JBAS014750：操作处理程序未能完成

16:19:48,631 INFO [org.jboss.as.connector.subsystems.datasources]（MSC 服务线程 1-4）JBAS010409：未绑定数据源 [jboss/datasources/ticket-monsterDS]

16:19:48,681 INFO [org.jboss.as.server.deployment]（MSC 服务线程 1-3）JBAS015877：在 53 毫秒内停止部署 ticket-monster.war

16:19:48,681 错误 [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) {"JBAS014653: 复合操作失败并已回滚。失败的步骤：" => {"操作步骤- 2" => "JBAS014750: 操作处理程序未能完成"}}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-29T13:49:26.423

现在回答为时已晚，但可能会对其他人有所帮助。在我的情况下，以下作品： -

要摆脱这个：

> MSC000001：无法解析公共接口

**检查您的 JBoss Standalone.xml**

它是否包含您机器的 IP 地址：-

```
<subsystem>
   ...
    <alias name="your IP Address"/>
   ...
</subsystem>

<interfaces>
    <interface name="management">
        <inet-address value="${jboss.bind.address.management:your IP Address}"/>
    </interface>
    <interface name="public">
        <inet-address value="${jboss.bind.address:your IP Address}"/>
    </interface>
    <interface name="unsecure">
        <inet-address value="${jboss.bind.address.unsecure:your IP Address}"/>
    </interface>
</interfaces> 
```

同样检查整个standalone.xml并用机器的当前IP替换**localhost**或**IP 。**

双击 JBoss 服务器以检查**主机名：您的 IP**

# javascript - jQuery .each 等到所有内容都完成后再追加 html

> ID：14176841
> 
> 赞同：0
> 
> 时间：2013-01-05T21:58:51.853
> 
> 标签：javascript, jquery, ajax

我正在研究一种方法，我可以毫不费力地将一个 php 程序的多个实例更新到相同的版本。

我的软件检查 RSS 提要，其中包括有关最新版本的信息。如果它看到有可用的更新，它会显示一个指向“更新”页面的链接。当用户单击更新链接时，我有一个 jquery 函数，可以一次更新每个需要更新的文件：

```
$.getJSON('http://softwareserver.com/updateFileList.php?fromver=1.0', function(data) {
    var filesToDo = data.length;

    $.each(data, function(num, file) {
        num = num + 1;
        action = file.charAt(0);
        name = file.substring(1);

        if ( action == "+" )
        {
            $('#upsole').append("<p><strong>Adding</strong> " + name + ". . .</p>");
                $.get("{$var['sbpurl']}/updateAction.php", { action: "add", file: name, revision: "{$TMP['rev']}" } );
        }

        else if ( action == "-" )
        {
            $('#upsole').append("<p><strong>Removing</strong> " + name + ". . .</p>");
                $.get("{$var['sbpurl']}/updateAction.php", { action: "remove", file: name, revision: "{$TMP['rev']}" } );
        }

        else if ( action == "~" )
        {
            $('#upsole').append("<p><strong>Updating</strong> " + name + ". . .</p>");
                $.get("{$var['sbpurl']}/updateAction.php", { action: "update", file: name, revision: "{$TMP['rev']}", version: "{$TMP['ver']}" } );
        }

        var completed = num / filesToDo * 100;

        $('#barcolor').css('width', completed + '%');
        $('#numProgress').html(completed.toFixed(0));

        if ( completed == 100 )
        {
            $('#conutt').html('<a href="index.php" class="button"> Continue > </a>');
            $('#upsole').append("<p><strong>Update Complete</strong></p>");
        }
    });
}); 
```

我在 div 容器中显示每个文件名，因为它正在更新；我还有一个进度条，随着每个文件的更新，直到所有文件都被更新，它的进度条从 0-100% 变为 0-100%。但是当它全部完成时，它只是从 0 变为 100。它实际上并没有显示进度，因为每个文件都像我想要的那样更新。

我希望我的进度条从 0% 变为 7%、15% 等，直到达到 100%，但在全部完成之前什么都没有发生。正如我所说，它只是从 0% 变为 100%。

$.each 不是最好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:42:26.217

不，`$.each`这不是这项工作的正确工具。您的主要问题是浏览器中的 JavaScript 是单线程的，因此您的所有 DOM 都会更新：

*   `$('#upsole').append(...)`
*   `$('#barcolor').css(...)`
*   `$('#numProgress').html(...)`

当浏览器重新获得控制权时，只会排队等待处理。那么浏览器什么时候重新获得控制权呢？当然是完成后`$.each`。您会看到结果：用户看到事情从一无所有到一步完成。您还需要`$.get`考虑异步性质。

您需要在每次 DOM 更新后将控制权交还给浏览器。您有一堆`$.get`调用，因此您可以使用它们的成功回调将您的 DOM 更改与浏览器对这些更改的响应交错。像这样的东西：

```
$.getJSON('http://softwareserver.com/updateFileList.php?fromver=1.0', function(data) {
    var filesToDo = data.length;
    var next_one  = function() {
        var file = data.shift();
        if(!file) {
            // If `data` is empty then we're all done so we can put the UI into
            // the "update complete" state and end the process by not calling
            // next_one() again.
            $('#conutt').html('<a href="index.php" class="button"> Continue &gt; </a>');
            $('#upsole').append("<p><strong>Update Complete</strong></p>");
            return; 
        }

        // Set up the next iteration by parsing `file`. We put the `$.get` stuff
        // into an object so that we only have one `$.get` call; the reason for
        // this will be clear shortly.
        var action = file.charAt(0);
        var name   = file.substring(1);
        var get    = { };
        if(action == '+') {
            get = {
                msg:    '<p><strong>Adding</strong> ' + name + '...</p>',
                url:    "{$var['sbpurl']}/updateAction.php",
                params: { action: "add", file: name, revision: "{$TMP['rev']}" }   
            };
        }
        else if(action == '-') {
            //...
        }
        else if(action == '~') {
            //...
        }

        // Tell them what we're about to do...
        $('#upsole').append(get.msg);

        // This `$.get` call is asynchronous so the browser will get control here 
        // and any pending DOM updates will be applied.
        $.get(get.url, get.params, function() {
            // Update the DOM with the latest status.
            var completed = (filesToDo - data.length) / filesToDo * 100;
            $('#barcolor').css('width', completed + '%'); 
            $('#numProgress').html(completed.toFixed(0));

            // And trigger the next iteration.
            next_one();
        });
    };

    // Crank it up.
    next_one();
}); 
```

基本思想是迭代`data`直到它为空，每次迭代都会删除第一个元素，`data`因此我们可以通过查看它何时返回（这是错误的）来检测`data`（以及我们迭代的结束）的结束。`undefined`每次迭代都会触发`$.get`, 将控制权返回给浏览器以允许更新 DOM。然后`$.get`回调将触发下一次迭代。

诸如错误处理之类的细节留给读者练习。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T00:54:48.843

c0nfus3d1，我看到你有来自@mu 的答案，但也许你希望看到我在重大中断之前开始准备的解决方案。

据我所知，这`.each()`对这项工作有好处，您的代码只需要非常轻微的修改即可使其工作。

然而，它也可以从进一步的 mods 中受益，以提供像这个更整洁、更易读的版本：

```
$.getJSON('http://softwareserver.com/updateFileList.php?fromver=1.0', function(data) {
    var filesToDo = data.length;
    var filesDone = 0;
    var activityStr = "<p><strong>%s1</strong>%s2</p>";//activity message template 

    function showProgress() {
        filesDone++;
        var completed = 100 * filesDone / filesToDo;

        $('#barcolor').css('width', completed + '%');
        $('#numProgress').html(completed.toFixed(0));

        if ( filesDone == filesToDo ) {
            $('#conutt').html('<a href="index.php" class="button"> Continue > </a>');
            $('#upsole').append(activityStr.replace('%s1', 'Update Complete').replace('%s2', ''));
        }
    }

    $.each(data, function(num, file) {
        var dataObj = {//data common to all cases below. 
                file: file.substring(1),
                revision: "{$TMP['rev']}" 
            },
            a, d;

        switch (file.charAt(0)) {
            case "+":
                a = 'Adding';
                d = $.extend({action:"add"}, dataObj);
                break;
            case "-":
                a = "Removing";
                d = $.extend({action:"remove"}, dataObj);
                break;
            case "~":
                a = "Updating";
                d = $.extend({action:"update", version:"{$TMP['ver']}"}, dataObj);
        }
        $('#upsole').append(activityStr.replace('%s1', a).replace('%s2', ' ' + d.file + '. . .'));
        $.get("{$var['sbpurl']}/updateAction.php", d).done(showProgress);
    });
}); 
```

*未经测试*

备注：

*   switch/case 结构取代了 if/else if/else if，并且只关心建立两个变量，这两个变量提供了随后的两个通用表达式。
*   `$.extend()`用于合并一般和特定于案例的对象，以构建内部`$.get`数据。
*   进度消息是通过应用于`.replace()`字符串模板生成的。
*   `showProgress()`响应每个内部调用的完成调用该函数`.get()`。
*   虽然内部`.get()`请求以非常快的速度连续发出，但响应会在它们从服务器返回时以及何时以任何顺序进行处理。

也许这包括一些你可以使用的想法。

# c++ - 指向类链接器错误的静态指针

> ID：14176845
> 
> 赞同：1
> 
> 时间：2013-01-05T21:58:56.350
> 
> 标签：c++, static, linker-errors

一段时间以来，我一直在努力寻找解决方案。我想从具有静态指针的类继承，但我得到错误 LNK2001: unresolved external symbol "protected: static class cGame * cEvent::mGame" (?mGame@cEvent@@1PAVcGame@@A)

最理想的是，我只需初始化我的类 cEvent 一次，然后不要在继承的类中传递指针。

```
#ifndef EVENT_H
#define EVENT_H

#include "game.h"

class cEvent
{
protected:
    static cGame* mGame;
public:
    cEvent(){;}
    virtual void doEvent(){;}
};

class cEventExitButton: public cEvent
{
private:
public:
    cEventExitButton(cGame *g){mGame = g;}
    void doEvent(){mGame->getWindow()->close();}
};

#endif 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T21:59:58.733

您需要在类*外**定义*`static`成员：

 *```
##include "game.h"

//do this .cpp file

cGame* cEvent::mGame = nullptr;

//or initialize it as : cGame* cEvent::mGame = create object! 
```

请注意，类中的*静态*成员只是*声明*，而不是*定义*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T22:04:12.160

您只`mGame`在头文件中声明：

```
static cGame* mGame; 
```

这告诉编译器`mGame`存在及其类型是什么，但实际上并没有为`mGame`存在创造空间。为此，您需要在 cpp 文件中定义它：

```
cGame* cEvent::mGame = [some intial value]; 
```

现在链接器有了一个位置`mGame`，任何引用它的人都可以指向该位置。链接器无法对标头执行此操作，因为多个文件可能包含标头。我们只想要一个位置`mGame`，所以它需要放在一个 cpp 文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T22:00:42.947

您必须`mGame`在`.cpp`文件中定义：

```
cGame* cEvent::mGame = ...; 
```

（酌情替换`...`。）*

# actionscript-3 - 如何在完成之前停止功能收集信息（Flex & AS3）

> ID：14176847
> 
> 赞同：0
> 
> 时间：2013-01-05T21:59:02.337
> 
> 标签：actionscript-3, apache-flex, actionscript, flash-builder

我“尝试”开发一个程序，该程序将使用 Flex 和 ActionScript 向用户提出 10 个问题。（所有 10 个问题将由代表 4 个基本操作的 4 个不同函数提出。答案（布尔类型）将存储在一个数组中。我只是将加号操作的函数放在这里，因为所有函数都在同一个格式。

```
protected function ask_plus():Boolean
   {
      var num1:int = math.round(math.random() *100);
      var num2:int = math.round(math.random() *100);
      question.text = num1 + " + " + num2 + "equals = ?";
      var answer:String = new String; //answer will be gotten from the panel where user writes the answer.
      answer = answerInput.text; //i first tried this, but it gets blank answers as false answers.
      if(int(answer) == (num1 + num2))
          return true;
      else
          return false;
   } 
```

我的问题是如何检测用户是否已完成输入他/​​她的输入。我尝试创建一个不同的函数来获取 event.Keyboard (keyUp) 作为输入。这是我尝试过的。

```
protected function check_if(e:Event):String
   {
      trace(event.keyCode);
      while(event.KeyCode != 13) //13 representates the "ENTER" button
      {
           trace(event.keyCode); //until user presses enter, the answer to the question must not be returned.
      }
      if (event.keyCode == 13)
           return answer_input.text;
    } 
```

但是，这里的问题是，我想以仅适用于 answer_input (textInput) 区域的事件的方式使用此 check_if。我想要的是这样的

```
 function a(b = 5)
 {
 trace(b)
 } 
```

如果我将此函数用作 a(); 它将跟踪 5。但是如果我将此函数用作 a(10); 它将跟踪 10，而不是 5。同样的情况，但有事件。它一定是这样的：

```
 protected function check if(e:answer_input.Event)
 blabla... 
```

或者其他的东西。

# java - java彩色滚动条搜索结果

> ID：14176848
> 
> 赞同：3
> 
> 时间：2013-01-05T21:59:08.497
> 
> 标签：java, swing, jtable, jscrollbar

我将如何在 Java 中自定义滚动条，以便我可以进行类似于 chrome 的搜索，也就是说将彩色条纹放在结果所在的位置？

我不想要一个库，因为我更愿意自己编写代码。另外，我不想失去我拥有的 L&F。欢迎举例。

实际上它将是查看一个大的文本文件或一个长的 jtable，有没有人对我如何有一个有效的滚动条来查看这个有什么好主意？...我应该有一个从头到尾的双滚动条和一个在短范围内滚动的内部滚动条吗？

（对不起，这是一个双重问题，但彩色滚动条会打勾）

感谢您提供所有可能的帮助和想法。

编辑：没有代码示例很抱歉，因为我试图事先在脑海中计划出来......你会看到它将是一个带有快速搜索的长文本窗格。用户将需要加载这个大文件并快速访问详细信息。目前，我对加载速度保持轻描淡写。其次，文本将是动态的，因此通过单击一个单词，它将在滚动条中放置一条条纹，就好像搜索已激活一样。目前让我们说它是一个带有滚动条的简单文本区域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T15:53:40.810

![在此处输入图像描述](../Images/68949043febfc73263f30eaeb9984139.png)

```
import java.awt.*;
import java.awt.event.*;
import java.awt.geom.*;
import java.util.regex.*;
import javax.swing.*;
import javax.swing.text.*;
import javax.swing.plaf.metal.MetalScrollBarUI;

public class ScrollBarSearchHighlighterTest {
  private static final Highlighter.HighlightPainter highlightPainter
    = new DefaultHighlighter.DefaultHighlightPainter(Color.YELLOW);
  private static final String pattern = "Swing";
  private static final String initTxt =
    "Trail: Creating a GUI with JFC/Swing\n" +
    "Lesson: Learning Swing by Example\n" +
    "This lesson explains the concepts you need to\n" +
    " use Swing components in building a user interface.\n" +
    " First we examine the simplest Swing application you can write.\n" +
    " Then we present several progressively complicated examples of creating\n" +
    " user interfaces using components in the javax.swing package.\n" +
    " We cover several Swing components, such as buttons, labels, and text areas.\n" +
    " The handling of events is also discussed,\n" +
    " as are layout management and accessibility.\n" +
    " This lesson ends with a set of questions and exercises\n" +
    " so you can test yourself on what you've learned.\n" +
    "http://docs.oracle.com/javase/tutorial/uiswing/learn/index.html\n";

  private final JTextArea textArea   = new JTextArea();
  private final JScrollPane scroll   = new JScrollPane(textArea);
  private final JScrollBar scrollbar = new JScrollBar(JScrollBar.VERTICAL);
  public JComponent makeUI() {
    textArea.setEditable(false);
    textArea.setLineWrap(true);
    textArea.setText(initTxt+initTxt+initTxt);
    scrollbar.setUnitIncrement(10);

    scrollbar.setUI(new MetalScrollBarUI() {
      @Override protected void paintTrack(
            Graphics g, JComponent c, Rectangle trackBounds) {
        super.paintTrack(g, c, trackBounds);
        Rectangle rect = textArea.getBounds();
        double sy = trackBounds.getHeight() / rect.getHeight();
        AffineTransform at = AffineTransform.getScaleInstance(1.0, sy);
        Highlighter highlighter = textArea.getHighlighter();
        g.setColor(Color.YELLOW);
        try{
          for(Highlighter.Highlight hh: highlighter.getHighlights()) {
            Rectangle r = textArea.modelToView(hh.getStartOffset());
            Rectangle s = at.createTransformedShape(r).getBounds();
            int h = 2; //Math.max(2, s.height-2);
            g.fillRect(trackBounds.x+2, trackBounds.y+1+s.y, trackBounds.width, h);
          }
        } catch(BadLocationException e) {
          e.printStackTrace();
        }
      }
    });
    scroll.setVerticalScrollBar(scrollbar);

    Box box = Box.createHorizontalBox();
    box.add(Box.createHorizontalGlue());
    box.add(new JButton(new AbstractAction("highlight") {
      @Override public void actionPerformed(ActionEvent e) {
        setHighlight(textArea, pattern);
      }
    }));
    box.add(Box.createHorizontalStrut(2));
    box.add(new JButton(new AbstractAction("clear") {
      @Override public void actionPerformed(ActionEvent e) {
        textArea.getHighlighter().removeAllHighlights();
        scrollbar.repaint();
      }
    }));

    JPanel p = new JPanel(new BorderLayout());
    p.add(scroll);
    p.add(box, BorderLayout.SOUTH);
    return p;
  }
  public void setHighlight(JTextComponent jtc, String pattern) {
    Highlighter highlighter = jtc.getHighlighter();
    highlighter.removeAllHighlights();
    Document doc = jtc.getDocument();
    try{
      String text = doc.getText(0, doc.getLength());
      Matcher matcher = Pattern.compile(pattern).matcher(text);
      int pos = 0;
      while(matcher.find(pos)) {
        int start = matcher.start();
        int end   = matcher.end();
        highlighter.addHighlight(start, end, highlightPainter);
        pos = end;
      }
    }catch(BadLocationException e) {
      e.printStackTrace();
    }
    scroll.repaint();
  }
  public void removeHighlights(JTextComponent jtc) {
    Highlighter hilite = jtc.getHighlighter();
    Highlighter.Highlight[] hilites = hilite.getHighlights();
    for(int i=0; i<hilites.length; i++) {
      if(hilites[i].getPainter() instanceof
             DefaultHighlighter.DefaultHighlightPainter) {
        hilite.removeHighlight(hilites[i]);
      }
    }
    scroll.repaint();
  }
  public static void main(String[] args) {
    EventQueue.invokeLater(new Runnable() {
      @Override public void run() {
        createAndShowGUI();
      }
    });
  }
  public static void createAndShowGUI() {
    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
    frame.getContentPane().add(new ScrollBarSearchHighlighterTest().makeUI());
    frame.setSize(320, 240);
    frame.setLocationRelativeTo(null);
    frame.setVisible(true);
  }
} 
```

或者另一种选择是使用“MatteBorder + Icon + RowHeader”：[JScrollBar search highlighter](http://java-swing-tips.blogspot.jp/2013/01/jscrollbar-search-highlighter.html)

# javascript - 在文本区域中按下 Enter 时段落中的新行

> ID：14176849
> 
> 赞同：9
> 
> 时间：2013-01-05T21:59:12.000
> 
> 标签：javascript, html

```
document.getElementById('area').onkeyup=keydown;
function keydown (event) {
if (event.target.id=='area' && event.which==13) {
document.getElementById('arsh').innerHTML+="\n";
     }
} 
```

Arsh 是我的段落的 ID，我想在其中添加新行为什么这不起作用任何人都可以帮助我吗？我只想在文本区域（ID 区域）中按 Enter 时添加新行到我的段落（ID arsh ）。

这是HTML

```
<textarea ID="area" class="in">
Message
</textarea>
<br />
<br />
<p ID="tiesh" class="sh">
</p>
<br />
<br />
<p ID="arsh" class="sh">
</p>
<br />
</div> 
```

当您在文本区域中按下回车键时，我基本上试图在stackoverflow中这样做，该段落也跳下一行。

![在此处输入图像描述](../Images/f762168b522ca60ae9f3f40d7f309243.png)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-05T22:22:37.017

使用 CSS，给`#arsh`（或任何其他你想呈现新行的元素）这个属性。

```
white-space: pre-wrap; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-10-05T10:00:59.180

```
document.getElementById('arsh').innerHTML=document.getElementById("area").value.replace(/\n/g,'<br />') 
```

这将完成这项工作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T22:03:43.173

换行符 (\n) 不会在屏幕上呈现为新行。您可能需要添加一个 HTML 中断：

```
document.getElementById('arsh').innerHTML+="<br />"; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-05-24T15:04:53.550

```
<p style="white-space: pre-wrap;"><?php echo $row['description_text'];?></p> 
```

# android - 从性能角度来看，Android 活动之间的什么对象传递选项更好？

> ID：14176850
> 
> 赞同：0
> 
> 时间：2013-01-05T21:59:27.943
> 
> 标签：android, android-sqlite, performance

我有在其中使用 SQLite 的应用程序。从使用光标的这些记录中，显示 ListActivity 供用户选择他想要获取的对象的信息。

按下它后，Intent 以超长的对象 id 开始。在此意图的目标活动中，额外用于获取有关对象的信息。那么它的作用是打开数据库并使用对象 ID 获取所有日期。

我开始想知道这是一个不错的选择，我可以提高我的应用程序的性能吗？首先，我正在考虑将对象放入 parcelable 并像这样发送，但有一件棘手的事情 - 在 ListActivity 中，并非所有已下载的字段都在目标活动中显示（下载）。

所以也许最好从 ListActivity 的数据库中下载所有可用字段，然后只额外传递它？

你有什么事吗？什么是最好的选择，也许还有别的？

我忘记了我认为的两个重要信息：我使用的是普通 SQLite，因为我不需要 FTS3，并且数据库可以有数百条记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:46:28.237

一如既往，这取决于。

如果您所做的只是列出记录，然后单击它们以检查详细信息，那么第二个选项将是最好的和更清洁的，正如 Nikita Beloglazov 所说。我赞成它，因为它很常见。

但是，如果您打算在级联中进行大量操作，我建议您不要每次打开活动时都从数据库中读取数据，而是可以传递对象。在这种情况下，如果列表有很多记录，您可以异步加载它们。此外，如果对象有很多数据（甚至是其中包含集合的集合），您必须记住它会增加内存使用量。

最后，问题是关于内存与 I/O 操作与您需要/拥有什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T22:15:58.883

我想说在 DB 中按 id 搜索元素应该非常快，并且一旦它在活动开始时，它不应该是性能问题。同时，当活动仅获取 id 然后自行加载所有数据时，这是一种更简洁的方法。当然，您需要尝试两种方式，看看它是否真的能给您带来性能优势。

# php - 在 MySQL 中根据时间选择值班人员的问题

> ID：14176851
> 
> 赞同：2
> 
> 时间：2013-01-05T21:59:29.873
> 
> 标签：php, mysql, sql

免责声明：仍然是初学者。

我正在制作一个小脚本来显示目前应该轮班的人员，按角色过滤。这些班次确实会持续到午夜。截至目前，时间和角色是硬编码的，但我打算允许用户稍后指定两者（因此我不使用 NOW() 等）。

所以给定下面的数据，假设是周一下午 4:30，我想知道什么水果在预定的时间，当这个脚本执行时，它会回显如下：

```
Apple
Banana 
```

然而，当下面的代码在下表上执行时，它几乎总是选择整个表。我确定查询本身存在问题，但为了彻底，我将其余部分包括在内。我已经测试了只选择日期和角色本身，它工作正常，但是它选择时间的方式错误地评估为真。我会很感激任何建议。

这是我的表的示例：

```
+----------+-------------+----------+----------+-------------+
| Name     | Days        | Start    | End      | Role        |
+----------+-------------+----------+----------+-------------+
| Apple    | Sun,Mon,Tue | 15:30:00 | 20:00:00 | Fruit       |
| Banana   | Mon,Tue,Wed | 16:00:00 | 20:30:00 | Fruit       |
| Cheese   | Mon,Tue,Wed | 08:30:00 | 10:30:00 | Dairy       |
| Carrot   | Fri,Sat,Sun | 22:00:00 | 07:00:00 | Vegetable   |
+----------+-------------+----------+----------+-------------+ 
```

这是我的代码，没有遗漏：

```
<?php
    date_default_timezone_set('Etc/GMT+6'); // Set default time zone
    $time = date("H:i:s"); // Time with seconds in a 24-hour, leading zero format: i.e. 07:00:00 or 15:30:00
    $today = date("D"); // Today, in a three-letter format: i.e. Mon, Tue
    $role = "Fruit";

    $username="example-username";  
    $password="example-password";
    $database="example-database";

    mysql_connect(localhost,$username,$password);
    @mysql_select_db($database) or die( "Unable to select database");
    $query="SELECT *
    FROM work 
    WHERE `days` LIKE '%$today%'  AND
    `role` LIKE '%$role%' AND 
    (start > end AND ('$time' < end OR '$time' > start)) OR
    ('$time' BETWEEN start AND end)";
    $result=mysql_query($query);

    $num=mysql_numrows($result);

    mysql_close();

    $i=0;
    while ($i < $num) {

    $victim=mysql_result($result,$i,"name");

    echo        "<li>$victim</li>";

    $i++;
    }
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T22:09:16.957

您的括号错误，您的查询已`OR ('$time' BETWEEN start AND end)`结束，因此符合此条件的行将忽略角色和天数子句。你想要多一双

```
((start > end AND ('$time' < end OR '$time' > start)) OR
('$time' BETWEEN start AND end)) 
```

一般来说，在数据库中使用逗号分隔的值是违背关系数据库的。如果每个行都有单独的行，事情通常会更好。

# spring - 如何阻止 Spring Security 创建新会话？

> ID：14176853
> 
> 赞同：3
> 
> 时间：2013-01-05T21:59:51.267
> 
> 标签：spring, security, httpsession

### 设想

1.  我重新启动服务器和浏览器，所以没有会话数据。
2.  我去 www.someurl.com 公共访问页面。我的控制器让我与这个会话`HttpSession session=request.getSession(true);`
3.  我单击指向 www.someurl.com/admin 受限访问页面的平面锚链接，该页面在新选项卡中打开。Spring Security 3 拦截了这一点并挑战凭据。我登录成功。
4.  我使用 www.someurl.com 返回上一个选项卡并刷新页面。

### 问题

我在 www.someurl.com 的控制器中注意到的是，第 2 步和第 4 步的会话 ID 不同。看起来 Spring Security 创建了一个新会话，并且该会话现在附加到公共页面的请求。为什么会发生这种情况，我可以强制 Spring Security 使用现有会话吗？

### 追踪场景

1.  重新启动浏览器和服务器，以便不存在会话数据。
2.  我去 www.someurl.com。控制器已注入请求。request.session 为空。getSession(true) 让我获得一个 ID 为 87B091B12F38D44C53AF0DA9E2147484 的会话。LogService 获取请求对象并执行 getSession(true) 但获取 ID 为 87B091B12F38D44C53AF0DA9E2147484 的会话，所以到目前为止一切都很好。
3.  我点击/管理员。页面在新标签页中打开。我登录。
4.  我刷新了 www.someurl.com。控制器已注入请求。request.session 不为空。会话 ID 为 547DF59035C91783D783BAEF4A15FBFF。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-05T22:08:58.080

您的诊断错误：

> 我在 www.someurl.com 的控制器中注意到的是，第 2 步和第 4 步的会话 ID 不同。看起来 Spring Security 创建了一个新会话，并且该会话现在附加到公共页面的请求。

正是因为所有页面都使用相同的会话，所以当您返回第一个选项卡并刷新时，您仍然以管理员身份登录。给定浏览器的所有选项卡和框架共享给定 web 应用程序的相同会话。这就是它的工作原理。服务器不知道也不关心浏览器选项卡。它获取附加到给定浏览器发送的所有请求的会话 cookie，并使用此 cookie 获取相应的会话。这实际上是一件好事。没有它，每次您打开一个已经过身份验证的新选项卡时，您都必须再次进行身份验证。你绝对不希望这样。

因此，让我们解释一下您的场景中会发生什么：

1.  您重新启动服务器和浏览器，因此没有会​​话数据。
2.  你去 www.someurl.com 公共访问页面。您的控制器会为您提供会话。cookie 被发送回浏览器
3.  您单击指向 www.someurl.com/admin 受限访问页面的平面锚链接，该页面在新选项卡中打开。cookie 与请求一起发送，因此此请求是在步骤 2 中打开的会话的一部分。Spring Security 3 截获此请求并质询凭据。它将凭据附加到会话，该会话现在是经过身份验证的会话
4.  您通过 www.someurl.com 返回上一个选项卡并刷新页面。再次发送 cookie，Spring 知道您是在第 3 步进行身份验证的人，因为身份验证凭据存储在 session.xml 中。

编辑：看来我错了，Spring 确实在登录后创建了一个新会话以防止会话固定攻击。文档中提供了有关此功能为何有用以及如何避免此行为[的说明](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/ns-config.html#ns-session-fixation)：

> 会话固定攻击是一种潜在风险，恶意攻击者可能通过访问站点来创建会话，然后说服另一个用户使用相同的会话登录（通过向他们发送包含会话标识符作为参数的链接，例如例子）。Spring Security 通过在用户登录时创建一个新会话来自动防止这种情况发生。如果您不需要此保护，或者它与其他一些要求冲突，您可以使用 session-fixation-protection 属性控制该行为有三个选项
> 
> *   migrateSession - 创建一个新会话并将现有会话属性复制到新会话。这是默认设置。
>     
>     
> *   none - 不做任何事情。原始会话将被保留。
>     
>     
> *   newSession - 创建一个新的“干净”会话，而不复制现有会话数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T23:40:10.470

您需要更改 的行为，`HttpSessionRequestCache`以便在不存在会话时它不会创建会话。

您可以通过在您的 XML 配置中创建它的实例来做到这一点，如下所示：

```
<beans:bean id="httpSessionRequestCache" class="org.springframework.security.web.savedrequest.HttpSessionRequestCache"> 
    <beans:property name="createSessionAllowed" value="false" /> 
</beans:bean> 
```

然后，您需要在 spring 安全配置中配置 http 元素以使用您的 bean 实例：

```
<http auto-config="true" ....> 
    <request-cache ref="httpSessionRequestCache"/> 
    ... rest of your config
</http> 
```

如果您使用 JSP，您还应该阻止 JSP 创建会话。为了做到这一点，您需要在**每个 JSP**`page`之上添加一个指令（甚至包括从其他 JSP 中包含的那些）。

 **```
<%@ page session="false" %> 
```**

# regex - RegexQuiz - 任务 19 - 匹配实体

> ID：14176856
> 
> 赞同：0
> 
> 时间：2013-01-05T22:00:06.863
> 
> 标签：regex

我尝试在[http://www.regex101.com/quiz/](http://www.regex101.com/quiz/)上解决测验，并被困在剩下的六个任务中。

# 任务 #19

> 在 HTML 页面中，将文本替换**`micro`**为***`&micro;`***. 哦，不要搞砸代码：不要更换内部**`<the tags>`**或**`&entities;`**

我目前的尝试是这个甜蜜的正则表达式：

`/(?<=\G|>)([^<>]*?<?)(?:(?<=[^\w&#]|^)(?=[\w#]*)micro(?=[\w#]*;)|micro(?![\w#]*;))(?(?<=<micro)(?!>))/gm`

可以在这里测试：[http ://www.regex101.com/r/zG2pD3](http://www.regex101.com/r/zG2pD3)

### 这是一个问题：

> **`micro`**测试 16 of 28 失败：它在实体内部匹配。

我无法理解这种说法。在我的测试中有很多实体，但没有一个是匹配的。有人可以解释发生了什么和/或实体是什么意思吗？

也很奇怪：[RegexQuiz - 任务 20 - 匹配 csv](https://stackoverflow.com/questions/14176915/regexquiz-task-20-matching-csv)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T12:04:08.107

好的，做到了，测试 16 不再失败。

失败的实体是`&asdmicroasd ;`. 我对实体内部的空格感到困惑......好吧，这个正则表达式做到了......但没有另一个测试失败^^

`/(?<=\G|>)([^<>]*?<?)(?:(?<=[^\w&#\s]|^)(?=[\w#\s]*)micro(?=[\w#\s]*;)|micro(?![\w#\s]*;))(?(?<=<micro)(?!>))/gm`

### 编辑

完成任务...我不会破坏解决方案。如果有人需要帮助，请与我联系。

好吧，这是完成任务时的结果，建议避免通过正则表达式解析 HTML

> 正确的。请记住，您不应该使用正则表达式来解析 HTML。这是一个描述原因的链接：http: [//www.codinghorror.com/blog/2009/11/parsing-html-the-cthulhu-way.html](http://www.codinghorror.com/blog/2009/11/parsing-html-the-cthulhu-way.html)

# windows-runtime - IKVM.Reflection 用于在 Windows 应用商店应用程序运行时发出 IL？

> ID：14176865
> 
> 赞同：2
> 
> 时间：2013-01-05T22:01:23.600
> 
> 标签：windows-runtime, reflection.emit, il, ikvm, assembly-loading

我看到了 Marc Gravell 在[IKVM.Reflection](http://marcgravell.blogspot.com/2012/07/enter-ikvm.html)上的帖子，这是我在 IKVM[用户指南中找到的](http://sourceforge.net/apps/mediawiki/ikvm/index.php?title=User%27s_Guide)内容：

> 使用 IKVM.NET 有两种主要方式：
> 
> *   动态：在这种模式下，Java 类和 jar 直接用于在 .NET 运行时执行 Java 应用程序。Java 字节码被即时翻译成 CIL，不需要进一步的步骤。此模式支持完整的 Java 类加载器模型。
> *   静态：...

我想用它在 WinRT 应用程序中发出和执行 IL。是否存在任何根本问题，为什么这是不可能的？像 Microsoft 的政策，或阻止从 IKVM 执行（可能已修补）反射和 IL 发射代码的技术限制？

如果这不可能，是否有任何选项可以在运行时加载程序集（假设我在外部服务器上发出它们并从那里下载到本地应用程序文件夹）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T07:34:24.533

IKVM.NET 的动态模式与 IKVM.Reflection 无关。IKVM.Reflection 仅由静态编译器使用。

虽然可以为 .NET 核心配置文件编译 IKVM.Reflection（进行一些调整），但这不会让您更接近动态生成代码，除非您突破 .NET 核心配置文件“沙盒”（即可能，但我认为会违反 Window Store 政策）。

# c - 字符串数组，在 C 中写入数据失败

> ID：14176866
> 
> 赞同：2
> 
> 时间：2013-01-05T22:01:24.970
> 
> 标签：c, arrays, string

我有字符串数组，我想在数组中复制字符串。它的工作时间比程序停止工作的时间长，我知道问题出在复制字符串中。因为如果我用复制注释行，程序可以正常工作。这是我的代码：

```
FILE *fsource = fopen(source, "rb");
char fname[256], **files, mybuf[BUFSIZ];
files = allocate2d(files, count_files);

clear(fname);

reading = fread(mybuf, 1, BUFSIZ, fsource);
while(reading)
{
    for(i = 0; i < reading; i++)
    {
       if(mybuf[i] == 20)
       {
          while(1)
            {
                if(i < reading)
                {
                    if(mybuf[i] == 0)
                    {
                        clear(files[ifiles]);
                        strcat(files[ifiles++], fname); // here is problem :(
                        //append_string(files[ifiles++], fname); // also doesn't work

                        clear(fname);
                        break;
                    }

                    append_char(fname, mybuf[i++]);
                }
                else
                {
                    break;
                }
            }
       }

       clear(fname);
    }

    reading = fread(mybuf, 1, BUFSIZ, fsource);
}

char** allocate2d(char **arr, unsigned int size)
{
    unsigned int i = 0;
    arr = malloc(size * sizeof(char));

    for(i = 0; i < size; i++)
    {
        arr[i] = malloc(256);
    }

return arr;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:04:40.253

在`allocate2d`：

```
arr = malloc(size * sizeof(char)); 
```

应该

```
arr = malloc(size * sizeof(char*)); 
```

因为你想为`size`指针分配空间。

还

```
arr[i] = malloc(256); 
```

应该更好

```
arr[i] = calloc(256, sizeof(char)); 
```

以确保`strcat`找到一个 0 字符。（注：`sizeof(char)`只是写 1 的另一种方式。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T22:04:48.577

您必须在 中修复分配`allocate2d()`。如果你想分配一个指针数组

```
arr = malloc(size * sizeof(char*)); 
```

# grails - 在构建 Grails 应用程序时强制 javac 的 -target 版本

> ID：14176878
> 
> 赞同：2
> 
> 时间：2013-01-05T22:02:26.937
> 
> 标签：grails

有一个 hello world Grails 应用程序。`grails war`生成 1.5 版的 .class 文件。

如何强制 Grails 为应用程序生成 1.7 字节码？

Windows 7、Groovy 2.0.5、Grails 2.1.1，唯一的 Java SDK 是 1.7

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T22:43:55.710

您`conf/BuildConfig.groovy`可以设置一个属性：

```
grails.project.target.level = 1.7 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-14T08:13:11.873

groovyc 2.0.5 不支持将 *.groovy 文件编译为类版本 1.7（似乎只支持 1.5-）

# php - 将php变量放在wordpress排除数组中以进行标签云

> ID：14176881
> 
> 赞同：0
> 
> 时间：2013-01-05T22:02:50.713
> 
> 标签：php, arrays, string, wordpress, variables

我试图通过它的 slug 从 wordpress 标签云中排除一个标签。

经过整个星期六的搜索和尝试后，我得到的是：

```
$term = get_term_by('slug', 'widget', 'portfolio-tag');
$term_id = $term->term_id;
$string_id = "'" . $term_id . "'";

add_filter('widget_tag_cloud_args', 'my_widget_tag_cloud_args');

function my_widget_tag_cloud_args($args) {

    $args['number']    = 0;
    $args['largest']   = 18;
    $args['smallest']  = 8;
    $args['unit']      = 'pt';
    $args['order']     = 'DESC';
    $args['orderby']   = 'count';
    $args['separator'] = ' ';
    $args['exclude']   = print_r($string_id, true);
    return $args;
} 
```

我想以上不是我今天下午尝试的最佳选择，但它是最后一个。`print_r($term_id)`如果我用来检查，下面的代码将返回数字 18 ：

```
$term = get_term_by( 'slug', 'widget', 'portfolio-tag' );
$term_id = $term->term_id; 
```

如果我使用`$args['exclude'] = '18';`名为“小部件”的标签，则会被排除。我唯一还没有做到的是做这样的事情：`$args['exclude'] = $term_id;`

我知道 exclude 参数只接受字符串。我之所以不把 18 放在那里是因为我喜欢与一些艺术家朋友分享我的主题。

我做了一个主题来展示我的画。我还制作了一个小部件，它将显示一个名为“小部件”的随机绘画。只有在标签云中拥有它是没有用的。信不信由你，但与我的艺术家朋友相比，我到目前为止是计算机专家；）所以我想让他们尽可能简单，只需将小部件标签放在绘画上，其余的就可以了——至少，这是计划。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:12:54.717

我可以在这里发现的主要问题与变量范围有关：

您设置的`$string_id`在 中不可用，`my_widget_tag_cloud_args()`因为您在该功能之外设置了它。

因此，您需要将生成它的代码移到那里或找到另一种方法来完成这项工作，例如使用[*匿名函数*](http://php.net/functions.anonymous)或为此使用对象。

```
$exclude_term_id = get_term_by('slug', 'widget', 'portfolio-tag')->term_id;

add_filter('widget_tag_cloud_args',
    function ($args) use ($exclude_term_id) {

        $args['number']    = 0;
        $args['largest']   = 18;
        $args['smallest']  = 8;
        $args['unit']      = 'pt';
        $args['order']     = 'DESC';
        $args['orderby']   = 'count';
        $args['separator'] = ' ';
        $args['exclude']   = $exclude_term_id;

        return $args;
    }); 
```

我发现的其他问题是使用，`print_r`然后将实际 ID 包含在单引号中。这两者都没有必要。在 PHP 中，整数和字符串通常可以互换。如果没有，只需*投射*：

```
add_filter('widget_tag_cloud_args', 'my_widget_tag_cloud_args');

function my_widget_tag_cloud_args($args) {

    $term = get_term_by('slug', 'widget', 'portfolio-tag');

    $args['number']    = 0;
    $args['largest']   = 18;
    $args['smallest']  = 8;
    $args['unit']      = 'pt';
    $args['order']     = 'DESC';
    $args['orderby']   = 'count';
    $args['separator'] = ' ';
    $args['exclude']   = (string) $term->term_id;
    return $args;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T22:13:15.060

你的问题是范围。您在函数外部定义的变量在函数内不再可访问并且无法修改，除非您在范围内使变量成为全局变量（不明智）或通过引用传递变量（在这种情况下不可能）。

无论如何，您只需要将所有内容都放在范围内：

```
add_filter( 'widget_tag_cloud_args', 'my_widget_tag_cloud_args' );
function my_widget_tag_cloud_args( $args ) {
    $term = get_term_by( 'slug', 'widget', 'portfolio-tag' );
    $args['number'] = 0;
    $args['largest'] = 18;
    $args['smallest'] = 8;
    $args['unit'] = 'pt';
    $args['order'] = 'DESC';
    $args['orderby'] = 'count';
    $args['separator'] = ' ';
    $args['exclude'] = (string)$term->term_id;     
    return $args;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T22:10:56.483

在您的代码中

```
$args['exclude'] = print_r($string_id,true); 
```

应该

```
$args['exclude'] = array($term_id); 
```

所以，它可能是

```
add_filter( 'widget_tag_cloud_args', 'my_widget_tag_cloud_args' );
function my_widget_tag_cloud_args( $args ) {
    $term = get_term_by( 'slug', 'widget', 'portfolio-tag' );
    // more args...
    $args['exclude'] = array($term->term_id);     
    return $args;
} 
```

[参考这里。](http://designpx.com/tutorials/customize-tag-cloud-widget/)

# javascript - 每个浏览器如何公开 JavaScript 的中间表示？

> ID：14176883
> 
> 赞同：7
> 
> 时间：2013-01-05T22:03:30.227
> 
> 标签：javascript, compiler-construction, interpreter

**问题：**

我听说人们可以互换使用术语动态编译和解释。这不是关于语义的问题。

显然，当代码到达处理器时，它是某种二进制形式。

我如何看待中间表示？

例如，使用编译器选项可以很容易地查看汇编中的 C 代码。

有没有类似的方法可以用 JavaScript 做到这一点？我不确定中间表示会被称为什么，但这里有一些一般参考。

**研究**

*   口译员（[维基百科](http://en.wikipedia.org/wiki/Interpreter_%28computing%29)）

*   动态编译（[维基百科](http://en.wikipedia.org/wiki/Dynamic_compilation)）

*   编译（[维基百科](http://en.wikipedia.org/wiki/Compiler)）

**澄清：**

这个问题与缩小无关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T00:45:08.687

看看Vyacheslav Egorov 的[mö.js](https://code.google.com/p/moe-js/) JSConf[演讲中的](http://www.youtube.com/watch?v=y8hVeKMD_oM)[这些幻灯片](http://moe-js.googlecode.com/git-history/HEAD/talks/jsconfeu2012/index.html?r=HEAD)是否能让您更接近所需内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T21:32:36.743

如果您通过编译 d8 shell 自己构建 V8，则可以运行`d8 --print_code`或`d8 --print_opt_code`. 您可能希望将此数据输出到文件中。

# javascript - $(document).ready 的替代品？

> ID：14176885
> 
> 赞同：0
> 
> 时间：2013-01-05T22:03:32.857
> 
> 标签：javascript, jquery, ready

> **可能重复：**
> [加载dom中的所有图像后的jquery回调？](https://stackoverflow.com/questions/4857896/jquery-callback-after-all-images-in-dom-are-loaded)

页面加载完成后，我正在使用以下脚本加载 div：

```
 <script type="text/javascript">
        $(document).ready(function(){ 
            $('#page_effect').fadeIn(1618);
        });
    </script> 
```

然而，问题是当页面完成加载时，fadeIn 会触发，而不是所有图像。有没有办法改变它，让它在所有文件完成加载的那一刻触发淡入淡出？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-05T22:04:54.140

您可以使用`$(window).load(function() { ... })`. 在加载所有资产之前，“加载”事件不会触发。

“就绪”事件的全部意义在于，在解析 DOM 和将图像发送到客户端之间的过渡期间，可以做一些事情，在此期间不会发生太多其他事情。当您想要那里的图像时，您可以使用“加载”。你当然可以混合使用两者。

# php - 选择语句返回一个人而不是几个人的结果

> ID：14176886
> 
> 赞同：0
> 
> 时间：2013-01-05T22:03:40.367
> 
> 标签：php, codeigniter, activerecord

当有多个姓氏相同时，搜索一个名字会返回一个结果。它可能是 foreach 循环，但我认为它是 activerecord 语句。

模型

```
public function finduser($name) {

    if ($name == null || $name == '') {
            return false;
    }

    $this->db->select('e.emp_no, e.first_name, e.last_name, t.title, d.dept_no');
    $this->db->from('employees AS e, titles AS t, dept_emp AS d');
    $this->db->where('e.last_name', $name);
    $this->db->where('e.emp_no = t.emp_no');
    $this->db->where('e.emp_no = d.emp_no');

    $result = $this->db->get();

    $data = array();

    foreach ($result->result() as $row )
    {
    $entry = array();
    $entry['emp_no'] = $row->emp_no;        
    $entry['first_name'] = $row->first_name;
    $entry['last_name'] = $row->last_name;      
    $entry['title'] = $row->title;
    $entry['dept_no'] = $row->dept_no;

    $data[] = $entry;

    return $data;

}
} 
```

看法

```
if (isset($user)) {
foreach ($user as $res) {

echo "employee id =" .$res['emp_no']; ?> <br> <?php
echo "first name = " .$res['first_name']; ?> <br> <?php
echo "last name = " .$res['last_name']; ?> <br> <?php
echo "title = " .$res['title']; ?> <br> <?php
echo "department no = " .$res['dept_no']; ?> <br><br> <?php 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T22:04:50.600

你`return`在`for`循环中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T22:09:06.487

将 return 语句从 foreach 循环中取出

```
foreach ($result->result() as $row )
    {
    $entry = array();
    $entry['emp_no'] = $row->emp_no;        
    $entry['first_name'] = $row->first_name;
    $entry['last_name'] = $row->last_name;      
    $entry['title'] = $row->title;
    $entry['dept_no'] = $row->dept_no;

    $data[] = $entry;

}
 return $data; 
```

# c++ - 如果使用非原始类型，则清除泛型数组会引发 logic_error

> ID：14176888
> 
> 赞同：2
> 
> 时间：2013-01-05T22:03:46.777
> 
> 标签：c++, templates, gcc

我有一个通用数组类，`logic_error`如果它与非原始类型一起使用，它会抛出一个。

## 模板类：

```
#include <string>
#include <sstream>
#include <iostream>    

using namespace std;

#define NULL_ELEMENT        ((T)NULL)

template<class T> class Array
{    
public:    
    Array(const int size)
    {
        this->elements[size];
        this->size = size;
        ::fill_n(elements, size, NULL_ELEMENT); /* 1 */
    }

    // Output of the array
    string toString()
    {
        int i=0;
        stringstream ss;

        ss << "Array{ ";

        for( ; i<size-1; i++ )
        {
            ss << elements[i] << ", ";
        }

        ss << elements[i] << " }";

        return ss.str();
    }

    // ...

private:
    int size;
    T elements[];
}; 
```

## 测试代码：

**工作（使用原始类型）：**

```
Array<int> arr(5);
cout << arr.toString() << endl; 
```

数组填充`0`：`Array{ 0, 0, 0, 0, 0 }`

**失败（使用非原始类型）：**

```
Array<string> arr(size); // <-- Exception thrown here
cout << arr.toString() << endl; 
```

## 抛出异常：

```
terminate called after throwing an instance of 'std::logic_error'
  what():  basic_string::_S_construct null not valid 
```

这发生在`Array`课堂上，当`::fill_()`被称为 ( `/* 1 */`) 时。

我想用类型的 Null-Element 填充整个数组`T`（如果是 int 或`NULL`if 指针等，则为 0） - 而不遍历每个元素。`memset()`这不是一个好的解决方案，不是吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T22:14:16.837

这是你应该做的。这是具有正确类骨架的最少代码。

```
template<class T> 
class Array
{
     T  *m_elements;  //declare a pointer member 
     size_t m_size;   //count of the elements

public:    

    Array(size_t size) : m_size(size), m_element(new T[size]())
    {                // ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                     //    use member-initialization-list
    }

    ~Array(); //must define it

    Array(Array const & other); //must define it

    Array& operator=(Array const & other); //must define it

    Array(Array&& temporary); //better define it (in C++11)
    Array& operator=(Array&& temporary); //better define it (in C++11)

    //other
}; 
```

要了解为什么**必须定义***析构函数*、*复制构造函数*和*复制赋值*，**更好地定义** *移动构造函数*和*移动赋值*， 请参阅这些（*按此顺序*）：

*   [什么是三法则？](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)
*   [C++11 的三规则变成五规则？](https://stackoverflow.com/questions/4782757/rule-of-three-becomes-rule-of-five-with-c11)

# java - 以不同的方式将数据显示到 jtable 中

> ID：14176899
> 
> 赞同：0
> 
> 时间：2013-01-05T22:05:01.050
> 
> 标签：java, swing, file, jtable

我有一个读取文件并存储在arraylist中然后转换为数组的代码（用于表模型）

我的课程正确扩展了 abstracttablemodel。

我的所有代码是：

```
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import javax.swing.table.AbstractTableModel;

public class ReadFileToList extends AbstractTableModel{
String[] col={"Fname","Lname","Number"};
List<String> data=new ArrayList<String>();
String[][] Arraydata;

public ReadFileToList(){
try{
FileReader fr=new FileReader("D:\\AllUserRecords.txt");
BufferedReader br=new BufferedReader(fr);
String line;
while((line=br.readLine()) !=null){
    data.add(line);
}
br.close();
Arraydata=(String[][]) data.toArray();
}
catch(IOException ioe){
    ioe.printStackTrace();
}
}

@Override
public String getColumnName(int colu){
return col[colu];
}

public int getRowCount() {
return Arraydata.length;
}

public int getColumnCount() {
return col.length;
}

public Object getValueAt(int rowIndex, int columnIndex) {
return Arraydata[rowIndex][columnIndex];
}
} 
```

我的主要课程是 ReadFileToListM：

```
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;

public class ReadFileToListM  {
ReadFileToList rftl=new ReadFileToList();
public ReadFileToListM(){
    JFrame frame=new JFrame();
    JTable table=new JTable(rftl);
    JPanel panel=new JPanel();
    JScrollPane sp=new JScrollPane(table);
    panel.add(sp);
    frame.add(panel);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(470,470);
    frame.setVisible(true);
}

public static void main(String[] args){
    new ReadFileToListM();
}
} 
```

但它有例外！

这是我的例外：

```
Exception in thread "main" java.lang.ClassCastException: [Ljava.lang.Object; cannot be cast to [[Ljava.lang.String;
    at javaapplication1.ReadFileToList.<init>(ReadFileToList.java:37)
    at javaapplication1.ReadFileToListM.<init>(ReadFileToListM.java:8)
    at javaapplication1.ReadFileToListM.main(ReadFileToListM.java:22)
Java Result: 1 
```

我的txt文件：

```
 FName Lname Number
 second secondsecond 22
 thired thithird 33
 fourth fourfourr 44
 fifth fiffif 55 
```

请帮助我，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T22:34:41.743

ReadFileToList 类的构造函数是空的，你应该改变：

```
public void readtolist() throws IOException{ 
```

到

```
public ReadFileToList() throws IOException{ 
```

因为如果不执行模型的初始化（下面的代码），则不会执行将数据放入集合中的方法，而只会执行扩展类的构造函数。

```
ReadFileToList rftl=new ReadFileToList(); 
```

第二

您不能将一维动态大小数组的 List 转换为二维数组。您模型中的其他方法看起来不错。

此外，您应该以某种方式将数据与文件分开。目前它只被拆分为行。

如果您向我们展示文件中的几行，这将非常有帮助。

**编辑：06-01-2013 发布文件内容后将**模型中的 Countructor 更改为这个

```
public ReadFileToList() throws IOException{
    FileReader fr=new FileReader("D:/AllUserRecords.txt"); //one slash instead of two backslash
    BufferedReader br=new BufferedReader(fr);
    String line = br.readLine();
    while((line=br.readLine()) !=null){
        data.add(line.trim());  //trim() delete spaces before and after line
        System.out.println(line);
    }
    br.close();
    Arraydata = new String[data.size()][];
    for (int i=0;i<data.size();i++){
        Arraydata[i]=data.get(i).split(" "); //split text to array by space
    }

} 
```

主要应该是这样的

```
public class ReadFileToListM  {

public ReadFileToListM() throws IOException{
    JFrame frame=new JFrame();
    ReadFileToList rftl=new ReadFileToList();
    JTable table=new JTable(rftl);
    JPanel panel=new JPanel();
    JScrollPane sp=new JScrollPane(table);
    panel.add(sp);
    frame.add(panel);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(470,470);
    frame.setVisible(true);
}

public static void main(String[] args) throws IOException{
    new ReadFileToListM();
}
} 
```

结果： ![结果](../Images/33ebd366bf72fd54d8632eba059d4556.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T22:15:29.440

好像有NullPointerException，因为ReadFileToList中的Arraydata为null。

你在哪里填充数据？看起来 ReadFileToList.readtolist 方法从未被调用过，它不是 AbstractTableModel 的一部分，并且您不需要手动调用它。

您应该调用 readtolist 或将其更改为构造函数。

# smarty - 从 Smarty 变量中删除 HTML 标签

> ID：14176903
> 
> 赞同：1
> 
> 时间：2013-01-05T22:05:56.447
> 
> 标签：smarty, truncate

我正在构建一个 Smarty 模板。在我检查验证之前一切都很好。

包含描述的截断，但不会添加结束标记。任何标签添加都无济于事。

截断被称为

```
{$products_data.PRODUCTS_DESCRIPTION|truncate:300} 
```

描述有 300 多个字符，并以`p`标签开头和结尾。截断后，我只有开始标签`<p>`。

有没有办法将 HTML 标签剪掉以进行截断？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T12:36:07.780

我在一个项目中遇到了同样的问题，并发现了一个由 Benjamin Lupu/Edward Dale 编写的名为“html_substr”的出色修饰符。只需在 smarty/libs/plugins 目录中添加一个名为“modifier.html_substr.php”的新 php 文件：

（对不起 - 我不记得来源所以我只是在这里发布整个功能）：

```
<?php
/*
* Smarty plugin
*
-------------------------------------------------------------
* File: modifier.html_substr.php
* Type: modifier
* Name: html_substr
* Version: 1.0
* Date: June 19th, 2003
* Purpose: Cut a string preserving any tag nesting and matching.
* Install: Drop into the plugin directory.
* Author: Original Javascript Code: Benjamin Lupu <hide@address.com>
* Translation to PHP & Smarty: Edward Dale <hide@address.com>
* Modification to add a string: Sebastian Kuhlmann <hide@address.com>
* Modification to put the added string before closing <p> or <li> tags by Peter Carter http://www.podhawk.com
-------------------------------------------------------------
*/
function smarty_modifier_html_substr($string, $length, $addstring="")
{

//some nice italics for the add-string
 if (!empty($addstring)) $addstring = "<i> " . $addstring . "</i>";

if (strlen($string) > $length) {
    if( !empty( $string ) && $length>0 ) {
        $isText = true;
        $ret = "";
        $i = 0;

        $currentChar = "";
        $lastSpacePosition = -1;
        $lastChar = "";

        $tagsArray = array();
        $currentTag = "";
        $tagLevel = 0;

        $addstringAdded = false;

        $noTagLength = strlen( strip_tags( $string ) );

        // Parser loop
        for( $j=0; $j<strlen( $string ); $j++ ) {

            $currentChar = substr( $string, $j, 1 );
            $ret .= $currentChar;

            // Lesser than event
            if( $currentChar == "<") $isText = false;

                // Character handler
                if( $isText ) {

                    // Memorize last space position
                    if( $currentChar == " " ) { $lastSpacePosition = $j; }
                    else { $lastChar = $currentChar; }

                    $i++;
                    } else {
                    $currentTag .= $currentChar;
                    }

                    // Greater than event
                    if( $currentChar == ">" ) {
                        $isText = true;

                        // Opening tag handler
                        if( ( strpos( $currentTag, "<" ) !== FALSE ) &&
                        ( strpos( $currentTag, "/>" ) === FALSE ) &&
                        ( strpos( $currentTag, "</") === FALSE ) ) {

                        // Tag has attribute(s)
                        if( strpos( $currentTag, " " ) !== FALSE ) {
                            $currentTag = substr( $currentTag, 1, strpos( $currentTag, " " ) - 1 );
                            } else {
                            // Tag doesn't have attribute(s)
                            $currentTag = substr( $currentTag, 1, -1 );
                            }

                            array_push( $tagsArray, $currentTag );

                            } else if( strpos( $currentTag, "</" ) !== FALSE ) {
                            array_pop( $tagsArray );
                            }

                        $currentTag = "";
                        }

                    if( $i >= $length) {
                    break;
                    }
                }

        // Cut HTML string at last space position
        if( $length < $noTagLength ) {
            if( $lastSpacePosition != -1 ) {
            $ret = substr( $string, 0, $lastSpacePosition );
            } else {
            $ret = substr( $string, $j );
            }
        }

        // Close broken XHTML elements
            while( sizeof( $tagsArray ) != 0 ) {
            $aTag = array_pop( $tagsArray );
                // if a <p> or <li> tag needs to be closed, put the add-string in first
                if (($aTag == "p" || $aTag == "li") && strlen($string) > $length) {
                $ret .= $addstring;
                $addstringAdded = true;
                }
            $ret .= "</" . $aTag . ">\n";
            }

        } else {
        $ret = "";
        }

    // if we have not added the add-string already 
    if ( strlen($string) > $length && $addstringAdded == false) {
        return( $ret.$addstring );
        }
        else {
        return ( $ret );
        }
    }
    else {
    return ( $string );
    }
}
?> 
```

用法：

```
{$products_data.PRODUCTS_DESCRIPTION|html_substr:300:' ...'} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T13:55:56.467

过滤掉html标签，截断文本，然后放回html标签是相当困难的。我建议您使用 strip_tags 删除所有 html 标签，然后截断生成的文本。如果需要，您可以将剩下的内容嵌入到 <p> 标记中：

> {$products_data.PRODUCTS_DESCRIPTION|strip_tags|truncate:300}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-18T09:29:14.900

我寻找一种在不影响 html 标签的情况下截断文本的解决方案。我想将简短描述的文本截断为 300 个字符并保留我的 html。

所以我换了

> {$product.description nofilter}

经过

> {Tools::truncateString($product.description, 300) nofilter}

该解决方案在 prestashop 1.7 上运行良好

# linux - x86 平台中的 KVM 影子页表处理

> ID：14176904
> 
> 赞同：8
> 
> 时间：2013-01-05T22:06:26.757
> 
> 标签：linux, linux-kernel, x86, virtualization, kvm

据我了解，在没有硬件支持来宾虚拟到主机物理地址转换的处理器上，KVM 使用影子页表。

当客户操作系统修改其页表时，会构建和更新影子页表。硬件中是否有修改页表的特殊说明（我们以x86为例）？除非有特殊说明，否则 VMM 不会有陷阱。Linux内核在软件中维护的页表不就是另一种数据结构吗？为什么需要特殊说明来更新它？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-05T22:34:28.857

我使用除 KVM 之外的另一个 VMM，所以我不知道 KVM 的详细信息，但所有 VMM 的原理都是相同的。它的工作方式是有两组页表。

除了页表基地址的特殊寄存器[以及其他寄存器中的一些随机位与一般配置处理器有关，但这通常是“一次性”设置]之外，没有管理页表的特殊指令。页表只是用常规指令写入的内存位——如果你真的想要，你可以做加法、减法和或乘法等[除非你绝对知道你在做什么，否则它很可能会导致问题！ ]，但典型的操作符是“mov”（存储）或“xchg”（交换）操作。

第一个页表是操作系统实际编写的页表。VMM 将其设置为只读内存，因此每当对其进行写入时，处理器就会出现页面错误。由于 KVM 在处理器中使用硬件虚拟化扩展（AMD 处理器上的 SVM 或 Intel 处理器上的 VMX），页面错误由 VMM（在本例中为 KVM）捕获，其中检查写入操作以查看它是否是“页面-table write”，如果是这样，它会被转换为第二个影子页表——这就是 VMM 使 VM 相信内存从 0 开始并达到 1GB 的方式，但实际上我们已经占用了一堆页面到处都是，并把 1GB 的内存放在一起，这些内存看起来是一个平坦的、连续的页面集。当然，由于 VMM 对 VM 内部的操作系统“撒谎”，我们不能让操作系统编写它的真实页表，因为它不知道要写在那里的“真实”页表值。[但是我们确实需要让操作系统拥有自己的页表，以防它从页表中读取并且在它不是操作系统实际期望的情况下完全混淆]。

处理器“真正的 CR3”由 VMM 设置，并指向影子页表。

VMM 将捕获 CR3（页表基地址）写入，以便它可以跟踪页表所在的位置（并跟踪要使用哪个“真正的 CR3”）。但是，VMM 不需要知道 CR3 的读取，因此它们通常被允许直接在 VM 中发生而不会拦截它。

处理器中 VMM 扩展的全部意义在于支持这种对特殊指令的拦截，同时仍将 VM 中的大多数特权指令作为“常规”指令运行——例如，您不会想跳入每次写入标志寄存器以启用/禁用中断等的 VMM - 让它在 VM 中发生，就好像它是一个真正的硬件一样。但是有些寄存器是 VMM 可以控制的关键。

显然，当页表有硬件支持时，就会有两层页表。一个将“0-1GB”翻译成“分散在各处”，另一个是操作系统维护的实际页表。在这种情况下，不需要拦截任何页表写入、页错误或任何 CR3 更新 - 操作系统可以在其允许的由底层页表映射的内存部分内做它喜欢的事情，并且如果 VM 超出了允许的部分，VMM 会将其捕获为“VMM 页表错误”。这当然使整个事情变得更有效率。

我希望这是有道理的。

# objective-c - 如何在 ViewController 中访问 NSURLResponse

> ID：14176906
> 
> 赞同：0
> 
> 时间：2013-01-05T22:07:01.970
> 
> 标签：objective-c

关于对服务器的请求的问题。

有一个类WebApi与服务器通信，控制器调用实例方法WebApi。

只需创建一个查询并连接到指定的地址。当连接完成加载时

```
- (Void) connectionDidFinishLoading: (NSURLConnection *) connection
{
     _jsonData = [NSJSONSerialization JSONObjectWithData: response options: 0 error: nil];
} 
```

在控制器中如何知道属性`(NSArray *) _jsonData`WebApi类包含下载的响应，即如何理解什么时候可以使用存储在`_jsonData`ViewController内部的数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T11:58:25.133

我解决了这个问题。我们需要在 WebAPI 中创建一个协议。

```
@protocol ProtocolWebResponse

@required

  -(void)updateDataPromoInTheController:(NSDictionary *)response;

@end 
```

在 WebAPI 中创建函数 initWithDelegate

```
 - (id) initWithDelegate:(id)delegate 
```

{

```
self = [super init];
if(self !=nil) {
    //As a delegate set our controller
    self.delegate = delegate;
}
return self; 
```

}

也在 WebApi 类中

```
- (void) connectionDidFinishLoading:(NSURLConnection *)connection 
```

{

```
 _jsonData = [NSJSONSerialization JSONObjectWithData:response options:0 error:nil];
    if([self.delegate conformsToProtocol:@protocol(ProtocolWebResponse)]) 
    {
         [self.delegate updateDataPromoInTheController:_jsonData];
    } 
```

}

在 Controller 类中实现协议。

```
- (void)updateDataPromoInTheController:(NSDictionary *)response 
```

{

```
 self.response = response; 
```

}

# c++ - 使用 TCP 发送 Iplimage 时出错

> ID：14176913
> 
> 赞同：0
> 
> 时间：2013-01-05T22:08:06.490
> 
> 标签：c++, c, qt, opencv, tcp

我正在尝试从通过 USB 连接到 Raspberry Pi 的 Logitech HD cam 捕获帧，RP 正在运行 arch linux，并且我正在使用 OpenCV C api 和 TCP 客户端。

TCP服务器在ubuntu下运行c++(QT)。

这是我的 client.c 代码

```
#include <opencv/cv.h>
 #include <opencv/highgui.h>
 #include <stdio.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <netdb.h>

void error(char *msg)
{
    perror(msg);
    exit(0);
}

int main(int argc,char *argv[])
{

int sockfd,portno,n;
    struct sockaddr_in serv_addr;
    struct hostent *server;
    char buffer[999999];

    if(argc <3)
    {
        fprintf(stderr,"usage %s hostname portname port\n",argv[0]);
        exit(0);
    }

    portno = atoi(argv[2]);
    sockfd = socket(AF_INET , SOCK_STREAM,0);

    if(sockfd < 0)
    {
        error("ERROR OPENING SOCKET");
    }

    server = gethostbyname(argv[1]);
    if(server == NULL)
    {
        fprintf(stderr,"ERROR,NO SUCH HOST\n");
        exit(0);
    }

    bzero((char*)&serv_addr,sizeof(serv_addr));
    serv_addr.sin_family = AF_INET; 

    bcopy((char*)server->h_addr,(char*)&serv_addr.sin_addr.s_addr,server->h_length);
    serv_addr.sin_port = htons(portno);

    if(connect(sockfd,&serv_addr,sizeof(serv_addr)) < 0)
    {
        error("ERROR CONNECTING");
    }
    CvCapture *capture = cvCaptureFromCAM(1);
       // capture from cam
        int i =1;

       while ( 1 ) {
         // Get one frame
         IplImage* frame = cvQueryFrame( capture );
         if ( !frame ) {
           //fprintf( stderr, "ERROR: frame is null...\n" );
           getchar();
           break;
         }else
         {
             i++;
         }
         bzero (buffer,999999);
         strcpy(buffer,frame->imageData);
    n=write(sockfd,buffer,strlen(buffer));
    if(n <0)
    {
        error("ERROR READING FROM SOCKET");
    }
    //printf("%s\n",buffer);

    }
return 0;
} 
```

这是我在服务器上接收数据的方式：

```
void HostConnector::readyRead()
{
    QByteArray Data = socket->readAll();

    IplImage* frame = new IplImage();
    frame->imageData = Data.data();

    cvShowImage( "mywindow", frame ); //show the frame in a window

} 
```

但我收到此错误：

> OpenCV 错误：cvGetMat，文件 /home/kato/GP/src/OpenCV-2.4.2/modules/core/src/array.cpp，第 2482 行中的错误标志（参数或结构字段）（无法识别或不受支持的数组类型）
> 
> Qt 已捕获从事件处理程序抛出的异常。Qt 不支持从事件处理程序中抛出异常。您必须重新实现 QApplication::notify() 并在那里捕获所有异常
> 
> 在函数 cvGetMat 中抛出 'cv::Exception',error:(-206) 无法识别或不支持的数组类型的实例后调用终止。

有谁知道如何解决这个问题？？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T01:43:16.913

我认为问题在于您正在使用`strlen(buffer)`-此函数返回第一个`'\0'`字节的位置，而不是缓冲区的长度。尝试使用一些用于内存复制的功能（如`memcpy`在 Windows 上）和缓冲区长度使用来复制缓冲区`frame->imageSize`。不要忘记在服务器上的图像中设置 imageSize、宽度和高度。一般来说，我建议在第一帧之前发送所有重要信息（如图像宽度、高度等），而不是使用此标头而不更改它。

# ruby-on-rails - Rails csrf_meta_tags 每次都会不断生成新令牌

> ID：14176914
> 
> 赞同：2
> 
> 时间：2013-01-05T22:08:07.250
> 
> 标签：ruby-on-rails, ajax, jquery, ruby-on-rails-3.1, csrf

在我的 Rails 应用程序中，即使页面未刷新且浏览器未关闭，csrf_meta_tags 也会为每个 ajax 请求生成新令牌。

这是我的ajax函数

```
 var myobj={tag:"my tag"};
    $.ajax({
    url: 'ips/receive_tags',
    type: 'post',
    contentType: 'application/json; charset=UTF-8',
    accept: 'application/json',
    dataType: 'json',
    data:JSON.stringify(myobj),
    xhrFields: {
    withCredentials: true
    },
    success: function(res) {
        if (res.ImportResponse !== void 0) {
            console.log('Success: ' + res);
        } else if (res.Fault !== void 0) {
            console.log('Fault: ' + res);
        }
    },
    error: function() {
        console.error('There is an error!!!!');
    }
}); 
```

这是动作

```
def receive_tags
parser = Yajl::Parser.new
@hash = parser.parse(request.body.read)
log=Logger.new(STDOUT)
log.error(@hash)
print "Session ID: #{request.session_options[:id]}"
session[:tags]||=[]
session[:tags] <<@hash["tag"]
log.error( form_authenticity_token) #keeps changing for every request even though the browser is not closed or refreshed
render :nothing=>true
end 
```

阿贾克斯设置

```
 jQuery.ajaxSetup({ 
  'beforeSend': function(xhr, settings) {
   xhr.setRequestHeader("Accept", "application/json");
   var token=$('meta[name="csrf-token"]').attr('content');
   xhr.setRequestHeader('X-CSRF-Token',token );
   settings['dataType'] = "json";
   settings['contentType'] = "application/json";
    }
    }); 
```

# regex - RegexQuiz - 任务 20 - 匹配 csv

> ID：14176915
> 
> 赞同：0
> 
> 时间：2013-01-05T22:08:13.150
> 
> 标签：regex

我尝试在[http://www.regex101.com/quiz/](http://www.regex101.com/quiz/)上解决测验，并被困在剩下的六个任务中。

# 任务 #20

> 在逗号分隔的列表中，反向引用所有元素。此外，可以将项目括在引号中，并且在引号内，反斜杠转义字符。必须修剪每个元素周围的空间。例子：**`one,"item two" , "item \"three\"" , "and, finally, the fourth"`**

我目前的尝试是这个甜蜜的正则表达式：

`/(?:^|\G)\s*"?((?<=")(?:\\.|[^\n"\\])*(?=")|(?<!")[^\n",]+(?<!\s))"?\s*(?:,|$)/gm`

可以在这里测试：[http ://www.regex101.com/r/mH6rB2](http://www.regex101.com/r/mH6rB2)

### 这是一个问题：

> 测试 15 of 27 失败：如果一个项目以引用开头，则应该关闭它。如果有一个带有不平衡引号的项目，你的模式不应该匹配那个项目或者从那个点开始的任何其他内容。例如，您不应该匹配：**`"this_item,should,not,match`**

我对给定的字符串 ( **`"this_item,should,not,match`**) 进行了完全测试（请参阅上面的链接），但它不匹配。考试要告诉我什么？！

也很奇怪：[RegexQuiz - 任务 19 - 匹配实体](https://stackoverflow.com/questions/14176856/regexquiz-task-19-matching-entity)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:55:32.770

测验中有一个错误，不再需要答案，上面的正则表达式就是解决方案。

# c++ - 派生类通过基类定义函数

> ID：14176916
> 
> 赞同：3
> 
> 时间：2013-01-05T22:08:16.037
> 
> 标签：c++, inheritance, polymorphism

考虑以下代码：

```
struct A
{
  virtual void f() = 0;
};

struct B
{
  void f();
};

struct C : public A, public B
{};

int main()
{
  A* a = new C();
  B* b = new C();
  C* c = new C();

  // All these calls should result in B::f
  a->f();
  b->f();
  c->f();
} 
```

编译器声明这`C`是抽象的。这种情况如何解决？这个问题似乎类似于钻石继承，但我看不到解决方案。

编辑：谢谢，这是工作示例：

```
#include "stdio.h"

struct A
{
  virtual void f() = 0;
};

struct B
{
  void f()
  {
      printf("B::f\n");
  }
};

struct C : public A, public B
{
  void f()
  {
      printf("C::f\n");
      B::f();
  }
};

int main()
{
  A* a = new C();
  B* b = new C();
  C* c = new C();

  printf("Calling from A\n");
  a->f();
  printf("Calling from B\n");
  b->f();
  printf("Calling from C\n");
  c->f();
} 
```

输出：

```
Calling from A
C::f
B::f
Calling from B
B::f
Calling from C
C::f
B::f 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T22:10:22.367

问题是这两个`f()`函数完全不相关，即使它们碰巧同名。

如果所需的行为是让`C`'s`virtual` `f()`调用`B::f()`，则必须明确地执行此操作：

```
struct C : public A, public B
{
  void f();
};

void C::f() {
  B::f();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T22:11:57.277

您需要从`C`. 如果您希望它调用`B::f`，请这样说：

```
struct C : A, B
{
    void f() { B::f(); }
}; 
```

# javascript - 使用 jQuery 显示隐藏的 DIV（不工作）

> ID：14176920
> 
> 赞同：0
> 
> 时间：2013-01-05T22:08:47.033
> 
> 标签：javascript, jquery, overlay, show

语言：**jQuery** / **Javascript** / **PHP**

一旦用户单击链接，我就会尝试显示隐藏的 DIV。

根据标签内*`data-action`*附加的值，应该执行 3 种类型的操作。`href`

它有 3 个可能的值：

*   摇
*   弹跳
*   **默认**（我的问题）

现在使用**switch**，我在 Javascript 代码中切换这些操作。

我的问题是，我无法显示我试图定位的隐藏 div（**默认**代码是我遇到问题的地方）。

**JSfiddle： http: [//jsfiddle.net/ryxcw/1/](http://jsfiddle.net/ryxcw/1/)**（问题从第 59 行开始）

使用的Javascript代码：

```
function loadBubbleActions() {
  $('#container > a').each(function () {

    switch ($(this).attr('data-action')) {
      case "shake":
        //bind shake action to bubble
        $(this).live("click", function (e) {

          var props = $.parseJSON($(this).attr('data-action-properties'));
          var ox = $(this).css('left').replace('px', '');
          var oy = $(this).css('top').replace('px', '');
          if ($('#tae').length == 0) {

            var overlay = jQuery('<div id="overlay" style="background-color: #fff !important; background-image: url(images/texture-shake.jpg);"> </div>');
            overlay.appendTo(document.body)

            $(document.body).append('<div id="tae" class="shake" style="position:absolute;opacity:1;z-index:12000;">Info goes here</div>');

            $('#overlay').click(function () {

              $('#overlay').remove();
              $('#tae').remove();

            });

            var cssWidth = ($(this).css('width').replace('px', '') / 2 - 20);
            var cssHeight = ($(this).css('height').replace('px', '') / 2 - 20);
            var ss = ($(window).width() / 2);
            var dd = ($(window).height() / 2);

            $('#tae').css('left', (ss - cssWidth) + "px");
            $('#tae').css('top', (dd - cssHeight) + "px");

            $('#tae').effect("shake", {
              times: 5
            }, 500);
          } else {
            $('#tae').effect("shake", {
              times: 5
            }, 500);

          }
        });

        break;

      case "bounce":
        //do specific action stuff here

        $(this).live("click", function (e) {
          alert("This is a bouncing post " + $(this).attr('data-link'));
        });
        break;
      default:
        //do action code for default here
        $(this).live("click", function (e) {

          divID = $(this).attr('id');

          var props = $.parseJSON($(this).attr('data-action-properties'));
          var act = $(this).attr('data-action');
          var ox = $(this).css('left').replace('px', '');
          var oy = $(this).css('top').replace('px', '');
          if ($('.panda').length == 0) {

            $("#theDIV-" + divID).show();
            $("#overlay").show();

            $('#overlay').click(function () {

              $('#overlay').remove();
              $('.panda').remove();

            });

            var cssWidth = ($(this).css('width').replace('px', '') / 2 + 400);
            var cssHeight = ($(this).css('height').replace('px', '') / 2 - 20);
            var ss = ($(window).width() / 2);
            var dd = ($(window).height() / 2);

            $('.panda').css('left', (ss - cssWidth) + "px");
            $('.panda').css('top', "100px");
          } else {
            //$('#tae').effect("shake", { times:props.shakeNumber }, 200);
          }

        });
    }
  });
} 
```

我真的希望有人能帮忙，我整晚都在吹毛求疵，我真的可以使用指导。非常感谢您的参与！

再次，为了您的方便，这里有一个 JsFiddle——
**JSfiddle：http: [//jsfiddle.net/ryxcw/1/](http://jsfiddle.net/ryxcw/1/)**（问题从第 59 行开始）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T22:10:19.177

~~`.live()`当您使用CSS 选择器字符串以外的任何内容生成 jQuery 对象时，您不能使用。那是，~~

 ~~```
$(this).live(whatever) 
```~~ 

~~永远不会工作。~~（好吧，这不是真的；*如果*`.live()`您尝试委托，则没有选择器字符串就无法工作，但是当处理程序直接在元素上时它可以工作。它仍然有些奇怪，并且无论如何都已弃用：- )*`.live()`*

 *此外，您似乎想`<div>`通过查看单击元素的“id”值来找到 。~~这没有多大意义，因为你不能给两个不同的元素提供相同的“id”（你可以，但事情不是很好）。~~ 在任何情况下，您都没有给`<a>`标签一个“id”值。（*编辑*-现在我明白了；您在“id”上使用“id”`<a>`作为“id”的*一部分*。不过，该元素`<div>`上没有“id” 。）`<a>`

该代码中确实有很多错误。我认为你应该从更简单的事情开始，然后继续努力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T22:34:46.253

你在做这个

```
if ($('.panda').length==0) {
      $("#theDIV-" + divID).show(); 
```

但`$('.panda').length`返回 1 因为

```
<div class="panda hiddenDIV" id="theDIV-77" style="position:absolute;z-index:12000;">This is the content</div> 
```

存在，因此该操作`$("#theDIV-" + divID).show();`不会运行。

[http://jsfiddle.net/ryxcw/2/](http://jsfiddle.net/ryxcw/2/)

**在旁边**

你用过的地方`$(this).live()`你应该用过`$(this).on()`（尽管 live 仍然可以在那里工作）。

你用错了数据。`data-action="something"`在运行时存储在 DOM 中。您使用`.data('action')`not访问其内容`.attr('data-action')`

我也必须同意Pointy，有点。没有那么多“代码有很多问题”，而是你做错了很多事情。*

# android - 使用 Android 支持库显示选项卡内容？

> ID：14176921
> 
> 赞同：1
> 
> 时间：2013-01-05T22:08:47.643
> 
> 标签：android, tabs

我将承认我是 Android 编程的新手，以此作为这个问题的序言。我已经多次搜索答案——很可能我只是没有正确地构建我的问题——但我似乎无法弄清楚如何让我的标签内容正常工作：

我的目标是 sdk 14，但将 sdk 10 设置为 minSDK（我还在 Gingerbread 上），所以我使用的是 v4 支持库。

我的标签按应有的方式运行，并且我可以知道何时选择了特定的标签：

```
private void updateTab (String tabId, int placeholder)
{
    if (tabId.equals(TAB_ROUNDS)) {
        Toast.makeText(getActivity(), "tabId: "+tabId, Toast.LENGTH_SHORT).show();
    }
} 
```

When R.id.tab_rounds is selected, the Toast shows (same with other tabs: I only included one for brevity). 问题是，我现在不知道该怎么做，而且我似乎无法弄清楚在哪里/如何看。

我试图加载到标签中的片段也很有可能没有正确构建，但我将它们基于从各种网络搜索中收集的其他内容，试图弄清楚我是什么正在做。

TL;DR：我需要做什么才能将相关片段显示为特定选项卡的内容？我将不胜感激任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T22:31:11.950

欢迎来到安卓。

我不知道您使用的是哪个，但我建议 Action Bar 与 TabHost 相对，第一个现在已成为[Android Design](http://developer.android.com/design/index.html)中的标准。

不管怎样，你读过[Android Developer's API Guide](http://developer.android.com/guide/topics/ui/actionbar.html)吗？比我上次阅读它时更好，这是一个很好的入门方式。此外，您还可以在下载特定版本的 SDK 时获得示例。

另外，您正在考虑开发 Gingerbread，看看[ActionBarSherlock](http://actionbarsherlock.com/)和[ViewPagerIndicator](http://viewpagerindicator.com/)。它们是很好的 API，可增强旧版本 Android 中的支持库。

# security - 加载非 SSL 脚本会破坏 SSL 吗？

> ID：14176926
> 
> 赞同：0
> 
> 时间：2013-01-05T22:09:12.027
> 
> 标签：security, ssl

> **可能重复：**
> [当页面通过 https 传递安全和非安全项目时，安全项目是否受到损害？](https://stackoverflow.com/questions/5638133/when-a-page-delivers-secure-and-non-secure-items-over-https-are-the-secure-item)

如果您像这样从 google ajax 网站加载 jquery：

```
<script type="text/javascript" src="http//ajax.googleapis.com/ajax/libs/jquery/1.x.x/jquery.min.js"></script> 
```

在 https 页面上，在某些浏览器中会显示该页面不安全。

从那以后，我已将其修复为像这样加载：

```
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script> 
```

它工作正常。

我的问题是，该网站是否会因为非 https 脚本的不当加载而被黑客入侵？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T04:33:24.133

你说的黑客攻击是什么意思？如果您认为黑客正在访问您的服务器、修改页面、访问私人数据等。不！仅仅因为您通过 HTTP 提供一些内容，它不会为您的服务器造成黑客的大安全漏洞。

如果你的意思是中间的人，比如在 ISP 中，或者在被黑的网络中，可以嗅探流量，是的！当您在 HTTP 中提供内容时，它是纯文本的。每个人都可以通过一个简单的软件嗅探器看到 HTTP 中的内容。但是，如果您通过 HTTPS 提供数据，那么除了服务器（Web 服务器）和客户端（通过浏览器）之外，没有人可以解码数据。

所以你决定它是什么。

# c - C浮点变量不存储小数

> ID：14176934
> 
> 赞同：0
> 
> 时间：2013-01-05T22:09:53.153
> 
> 标签：c, input, floating-point

我正在为一个班级创建一种收银机程序，它需要一个购买金额和一个投标金额，然后给出剩余金额，然后将其分成每张账单的数量。问题是当我尝试存储浮点数时，它不会将数字存储在点的右侧。

这是我的代码：

```
int main(void)
{
    float purchase_amount = 0.00f,
        amount_tendered = 0.00f,
        calculated_return = 0.00f;
    float *p_return_amount;

    printf("Welcome to Change Counter!\n\n");

    printf("Please enter the total amount of purchase: ");
    scanf("%f", &purchase_amount);

    printf("\nPlease enter amount of money tendered: ");
    scanf("%f", &amount_tendered);

    // Debug output
    printf("\n\nPurchase Amount: %.2f\nAmount Tendered: %.2f ", purchase_amount, amount_tendered);

    calculated_return = amount_tendered - purchase_amount;
    p_return_amount = &calculated_return;

    printf("\n\nYour change is: %.2f", *p_return_amount);

    system("pause");
    return EXIT_SUCCESSFUL;
} 
```

它只发生在非常大的数字上，而这正是我正在使用的。说 14990300.54 和 15000000.21 只存储 14990301.00 和 15000000.00。我出于某种原因自动四舍五入。

我的语法有问题吗？浮点数是否太小？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T22:15:22.943

类型的大小和精度`float`可能因系统而异，但通常是 32 位，只有大约 7 个十进制数字，这与您所看到的一致。

更改为类型`double`（通常为 64 位和大约 11 个十进制数字）对于您正在做的事情可能已经足够了。

但请记住，浮点实际上以*二进制*而不是十进制存储值。例如，该值`0.01`不能完全存储为二进制分数，`1.0/3.0`也不能完全存储为十进制。

在现实生活中，您可能不想使用浮点数进行涉及金钱的计算。一个好的选择是将所有金额存储为代表美分数量的整数（或任何您需要处理的最小金额），并根据输入和输出的需要进行缩放。例如，一个 32 位有符号整数类型可以存储高达约 2100 万美元的金额；64 位有符号整数可以存储比您需要担心的更多的钱（只要您不处理[津巴布韦元](http://en.wikipedia.org/wiki/Zimbabwe_dollar)）。

一个简单的例子：假设你有一个`long int`代表 $123.45 的值`12345`。您可以将其打印为：

```
printf("%ld.%02d\n", value/100, value%100); 
```

这并不*总是*足够好。例如，如果你在计算利息，加上 10% 的利息`123.45`给你`135.795`，这不是美分的整数。我了解有法律明确规定银行和其他金融机构必须如何进行此类计算。我个人几乎不知道这些法律到底说了些什么——对于你现在正在做的事情，你可能也不需要这样做。

另一方面，浮点数可能足以满足您当前的目的，即使由于舍入误差您可能会在这里和那里获得或损失一分钱。问问你的导师，并记住，这对于现实世界的货币计算来说是*不够*的，至少在没有特别小心的情况下是这样。

我建议将 Goldberg 的[“每个计算机科学家都应该知道的关于浮点运算的知识”](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)添加到您有一天要阅读的内容列表中。对于您现在正在做的事情而言，它可能过于详细，但值得您记住。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T22:13:04.123

`float`仅存储 7 个有效数字。如果您想要更高的精度，请`double`改用。`double`可存储 16 位有效数字。

有关浮点数的更多详细信息，另请参阅[IEEE 浮点](http://en.wikipedia.org/wiki/IEEE_floating_point)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-05T22:12:32.400

是的，浮点值在设计上是不精确的，a`float`将给出大约 6 个小数位。

永远不要对货币使用浮点值。使用具有适当舍入规则的整数。（即以整便士/美分计算，并确保在划分数量时保留总和。）

# javascript - 限制和偏移数据导致 AngularJS 用于分页

> ID：14176936
> 
> 赞同：5
> 
> 时间：2013-01-05T22:10:08.033
> 
> 标签：javascript, angularjs

AngularJS 在调用支持它们的外部数据资源时是否有限制和偏移请求方法？

我想有一个比这更优雅的解决方案，我通过 routeParams 传递限制和偏移：

```
function ListCtrl($scope, $http, $routeParams) {
$http.jsonp('http://www.example.com/api/list.jsonp?callback=JSON_CALLBACK&limit=' + $routeParams.limit + '&offset=' + $routeParams.offset,{callback: 'JSON_CALLBACK'}).success(function(data) {
$scope.list = data;
  });
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-06T08:08:05.440

一个完整的分页解决方案是：（1）与服务器/数据库通信的服务，（2）处理下一个/上一个的指令，以及（3）一个控制器将它们粘合在一起。

一旦你有了指令和服务，你的控制器就像这样简单：

```
app.controller('MainCtrl', function($scope, myData) {
  $scope.numPerPage = 5;
  $scope.noOfPages = Math.ceil(myData.count() / $scope.numPerPage);
  $scope.currentPage = 1;

  $scope.setPage = function () {
    $scope.data = myData.get( ($scope.currentPage - 1) * $scope.numPerPage, $scope.numPerPage );
  };

  $scope.$watch( 'currentPage', $scope.setPage );
}); 
```

使用同样简单的 HTML：

```
<body ng-controller="MainCtrl">
  <ul>
    <li ng-repeat="item in data">{{item.name}}</li>
  </ul>
  <pagination num-pages="noOfPages" current-page="currentPage" class="pagination-small"></pagination>
</body> 
```

这是一个完整的 Plunker：[http](http://plnkr.co/edit/Mg0USx?p=preview) ://plnkr.co/edit/Mg0USx?p=preview 。它使用[ui-bootstrap](https://github.com/angular-ui/bootstrap)的分页指令，这是一项正在进行的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T22:19:57.963

AngularJs 是客户端。应该支持这些参数的是外部数据资源的提供者。

您的问题的可能解决方案可能是[$resource](http://docs.angularjs.org/api/ngResource.$resource)（或[参数选项 Mark 提到](https://stackoverflow.com/a/14177369/1916258)）：

```
var UserAccounts = $resource('/useraccounts/:userId/limit/:limit/offset:offset', {userId:'@id'});
var accounts = User.get({userId:123, limit:10, offset:10}, function() {
}); 
```

当然，服务器端需要以不同的方式读取参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T23:02:47.360

我不确定我是否理解您的问题，但是 $http 方法有一个`config`参数，它是一个对象，其中一个属性是“params”对象：

> **params** – {Object.} – 将
> `?key1=value1&key2=value2`在 url 之后转向的字符串或对象的映射。如果值不是字符串，它将被 JSON 化。

如果您的“限制”和“偏移”值在 $routParams 中，那么这似乎是获取它们的好地方。但是，您可能需要考虑将与您的服务器接口的代码包装到 Angular 服务中。该服务可以存储当前限制和偏移值。您可以将服务注入您的控制器以访问服务提供的功能（和/或数据）。

# mysql - MySQL：从表中快速选择 N 个随机行，其中一对列（不是列）是唯一的

> ID：14176942
> 
> 赞同：0
> 
> 时间：2013-01-05T22:10:53.460
> 
> 标签：mysql, performance, select, random, sql-order-by

有一个表包含这样的列：

**id、person_id、pet_id、描述**

关于这张表有一些说法：

1.  id 是主键，自增
2.  每对 (person_id, pet_id) 都是唯一的
3.  id、person_id、pet_id 是整数且不为 NULL
4.  “漏洞”是可能的（最大 pet_id 并没有告诉我们总共有（最大）个列具有这样的 person_id）
5.  表中很可能有更多不同的 person_id，即每个人的平均 pet_id 数。

**问题是：如何快速选择当前person_id的随机N个pet_id？**

表格示例：

```
1\.  1   1     cat
2\.  1   2     dog
3\.  2   40    horse
4\.  2   35    dog
5\.  3   46    duck
6\.  2   39    duck
7\.  1   3     duck
..................
100000  403  12  monkey 
```

示例：我想为第二个人选择两个 RANDOM 行。一种可能的随机选择是第 3 行。和第 6 行。选择应该是真正“随机的”（应该以相同的概率出现）。

如何使用 mysql 查询 SELECT 来做到这一点？

PS 当然，我已经阅读了有关从表中选择几个随机行的信息，这是一些棘手解决方案的基本问题。但是，就我而言，有两行，而不是一行。

我正在考虑一种比

```
select id from tablename where person_id = 2 order by random()  limit 2; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T00:07:45.767

您的稻草人查询已尽您所能。如果你没有一个人有很多宠物（并且你有一个索引`person_id`），它应该运行得很快。如果你有这样的人，那你就倒霉了。忘记随机选择，即使确定一个人有多少只宠物也需要时间 O(# pets)。

One possible other idea which probably won't work for you: If you don't care about the independence of your selections (i.e., you might get the same random response every time), then you can add a column which you populate with a random number when the row is inserted. Add an index on `person_id,random_column` and select the first N rows ordered by that pair. Slightly better is to add multiple random columns and select one to order by at random. Unfortunately, this doesn't scale well and I don't think you'd be happy with the results.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T22:32:25.550

试试这个，这里我们减少了在数据库中执行 random() 函数的时间。

```
 $max_sql = "SELECT max(id) AS max_id  FROM " . $table;
  $max_row = mysql_fetch_array(mysql_query($max_sql));
  $random_number = mt_rand(1, $max_row['max_id']);

  $random_sql = "SELECT * FROM " . $table . "
                 WHERE " . $column . " >= " . $random_number . " 
                 ORDER BY " . $column . " ASC
                 LIMIT 1"; 
```

# objective-c - LocalizedCaseInsensitiveCompare 似乎不适用于瑞典语字符

> ID：14176943
> 
> 赞同：2
> 
> 时间：2013-01-05T22:10:55.777
> 
> 标签：objective-c, cocoa, sorting, localization

我正在尝试按字母顺序对数组进行排序。在瑞典字母表中，字母 Å 是字母表中的倒数第三个字母，因此下面的数组应该像排序一样排序`A, B, Å`，而是排序像`A, Å, B`。这种行为的原因可能是什么？

```
NSArray *test = @[@"Å", @"A", @"B"];

NSArray *sortedTest = [test sortedArrayUsingSelector:@selector(localizedCaseInsensitiveCompare:)]; 
// Output is A, Å, B 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T22:51:16.547

也许当前的语言环境不是瑞典语言环境？

如果您明确使用瑞典语语言环境对字符串进行排序，它会按预期工作：

```
NSArray *test = @[@"Å", @"A", @"B"];
NSLocale *swedish = [[NSLocale alloc] initWithLocaleIdentifier:@"sv"];

NSArray *sortedTest = [test sortedArrayWithOptions:0
                                   usingComparator:^(NSString  *v1, NSString *v2) {
    return [v1 compare:v2 options:NSCaseInsensitiveSearch
                 range:NSMakeRange(0, [v1 length])
                locale:swedish];
}];

// Output: A, B, Å 
```

# django - Django ModelForm 的字段返回 id 而不是 value

> ID：14176946
> 
> 赞同：1
> 
> 时间：2013-01-05T22:11:03.507
> 
> 标签：django, django-forms

这是我的相关模型：

```
class Post(models.Model):
    subtitle = models.ForeignKey('Subtitle')

class Subtitle(models.Model):
      name = models.CharField(max_length=30)
      def __unicode__(self):
          return self.name 
```

和模型：

```
class AddLink(ModelForm):
      subtitle = forms.CharField(label='Subreddit')
      class Meta:
          model = Post
          fields = ('subtitle') 
```

相关观点：

```
@login_required(login_url='/login/')
123 def edit_link(request, post_id):
124     get_post = Post.objects.get(id=post_id)
125     if request.method == 'POST':
126         form = AddLink(request.POST, instance=get_post)
127         if form.is_valid():
128             form.save()
129             return HttpResponseRedirect('/')
130     else:
131         form = AddLink(instance=get_post)
132 
133     context = { 'form': form, 'post': get_post, }
134     template_name = 'edit_post.html'
135     return render_to_response(template_name, context,
136             context_instance=RequestContext(request)) 
```

和模板页面：

```
 1 <form action="" method="post">
  2     {% csrf_token %}
  3     {{ form.as_p }}
  4     <input type="submit" value="save" />
  5 </form> 
```

这样 ; 在 template 中，它返回字幕字段的 id。不是它的名字。

我想在**文本框中**提供字幕名称。**ModelChoiceField**没有提供我想要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T04:16:21.580

首先，删除您将需要`fields`从您的`ModelForm`定义中删除。因为它不是您想要的数据。

```
class AddLink(ModelForm):
  subtitle = forms.CharField(label='Subreddit')
  class Meta:
      model = Post 
```

然后，您需要填充初始表单数据。

```
@login_required(login_url='/login/')
def edit_link(request, post_id):
    get_post = Post.objects.get(id=post_id)
    if request.method == 'POST':
         form = AddLink(request.POST, instance=get_post)
         if form.is_valid():
             form.save()
             return HttpResponseRedirect('/')
     else:
         # this line changed
         form = AddLink(instance=get_post, initial={ 'subtitle': get_post.subtitle.name })     
     context = { 'form': form, 'post': get_post, }
     template_name = 'edit_post.html'
     return render_to_response(template_name, context,
             context_instance=RequestContext(request)) 
```

此外，您可能应该`save()`在模型中添加一个方法。

```
def save(self, commit=True):
    post = super(AddLink, self).save(commit=False)
    subtitle_name = self.cleaned_data['subtitle']
    if post.subtitle:
        post.subtitle.name = subtitle_name
    else:
        post.subtitle = new Subtitle(name=subtitle_name)
    post.subtitle.save()
    post.save()
    return post 
```

**编辑**：根据评论对代码进行了更改。

# ios - 从不在情节提要上的 uiview 或 uivewcontroller 启动 segue

> ID：14176947
> 
> 赞同：0
> 
> 时间：2013-01-05T22:11:24.580
> 
> 标签：ios, uiviewcontroller, uistoryboard, segue

如何从Storyboard 上没有的自定义`UIView`或自定义启动 segue？`UIViewController`- 它们是在 parent 内以编程方式创建的`UIViewController`。
虽然目的地`UIViewController`在故事板上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:17:09.487

然后就用老式的方法来做。实例化它并以模态方式呈现它，或者如果您在导航控制器中，则只需推送它。希望这可以帮助。

**编辑：**

只有在故事板中，您才能谈论 segue。如果您的源视图控制器不在其中，您只需按照我所说的那样呈现下一个。您可以从情节提要中实例化您的目标视图控制器：

```
MyViewController *viewController = [storyboard instantiateViewControllerWithIdentifier:@"MyViewController"];
[self presentViewController:controller animated:YES]; 
```

从这一点开始，您将“回到故事板”，因此您可以在目标视图控制器中执行转场。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T22:04:19.527

首先给出故事板ID。选择视图控制器而不是写一个标识符（故事板 ID） ![在此处输入图像描述](../Images/3c2f2747b0315a73cb0ef3349839f9f4.png)

其次，只需打开您的 .m 文件，然后编写 belove 代码。

```
UIStoryboard * st = [UIStoryboard storyboardWithName:@"nameOfStoryboard" bundle:nil];
MyViewController *viewController = [st instantiateViewControllerWithIdentifier:@"YourStoryboardID"];
[self.navigationController pushViewController:viewController animated:YES]; 
```

最后一行代码。也可能是

```
[self presentModalViewController:viewController animated:YES]; 
```

# algorithm - 为 ANN 寻找最佳学习规则

> ID：14176949
> 
> 赞同：6
> 
> 时间：2013-01-05T22:11:35.887
> 
> 标签：algorithm, artificial-intelligence, genetic-algorithm

您如何为给定问题找到最佳学习规则，例如多类别分类？

我正在考虑使用遗传算法，但我知道性能方面存在问题。我正在寻找您没有使用教科书学习规则的真实世界示例，以及您是如何找到这些学习规则的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-06T03:18:16.327

**好问题顺便说一句**。

分类算法可以使用许多**特征**进行分类， 例如：

1.  该算法强烈偏爱什么（或最适合该算法的数据类型）。
2.  训练开销。（是否需要很多时间来训练）
3.  什么时候有效。（大数据 - 中数据 - 少量数据）。
4.  它可以提供的分析的复杂性。

因此，对于您**分类多个类别**的问题，我将使用**在线逻辑回归 (FROM SGD)** ，因为它非常适合中小型数据量**（少于数千万个训练示例）**，而且速度非常快。

**另一个例子：**

假设您必须对大量文本数据进行分类。那么**朴素贝叶斯**就是你的宝贝。因为它非常喜欢文本分析。即使**SVM**和**SGD**更快，而且我体验过更容易训练。但是当数据大小被认为是中等或小而不是大时，可以应用这些规则**“SVM 和 SGD” 。**

一般来说，任何数据挖掘人员在开始任何**ML 或 Simple**挖掘项目时都会问自己*上述四点。*

 **之后你必须测量它的**AUC***或任何相关*的，看看你做了什么。因为您可能会在一个项目中使用不止一个分类器。或者有时当你认为你已经找到了完美的分类器时，使用一些测量技术的结果似乎并不好。因此，您将开始再次检查您的问题，以找出您出错的地方。

希望我有所帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-06T05:31:51.670

当您将向量输入`x`网络时，网络将根据所有权重（向量`w`）给出输出。输出和真实答案之间会有错误。平均误差 ( `e`) 是 的函数，`w`比方说`e = F(w)`。假设你有一层二维网络，那么图像`F`可能是这样的：

![在此处输入图像描述](../Images/9133e7566f6770a8eefffd6c5b3bfa6b.png)

当我们谈论训练时，我们实际上是在谈论找到`w`最小的`e`。换句话说，我们正在寻找一个函数的最小值。**训练就是搜索**。

所以，你的问题是如何选择搜索的方法。我的建议是：**这取决于表面的`F(w)`外观**。越波动，应该使用越随机的方法，因为基于梯度下降的简单方法将有更大的机会引导你被局部最小值困住——这样你就失去了找到全局最小值的机会。另一方面，如果表面`F(w)`看起来像一个大坑，那就忘记遗传算法。在这种情况下，简单的反向传播或任何基于梯度下降的东西都会非常好。

你可能会问，**我怎么知道表面的样子**？这是一种经验技能。或者您可能想要随机采样一些`w`，并计算`F(w)`以获得表面的直观视图。**

# visual-studio-2012 - Typescript 条件断点在 VS2012 中不起作用

> ID：14176950
> 
> 赞同：0
> 
> 时间：2013-01-05T22:11:36.813
> 
> 标签：visual-studio-2012, typescript

我正在使用 Visual Studio 2012 和 Web Essentials。打字稿条件断点没有设置，我得到一个错误：

*无法设置断点。无法设置条件。*

这是我的条件：

```
this.rightDown 
```

并打勾

“是真的”

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T19:00:21.833

同样的问题，使用 Web Essentials 2012 2.4.5 和 ReSharper 7.0。

也许作为一种临时解决方法，源映射在 Chrome 中运行良好。

# javascript - 使用代理在回调方法中访问对话框

> ID：14176954
> 
> 赞同：2
> 
> 时间：2013-01-05T22:12:09.810
> 
> 标签：javascript, jquery, jquery-ui

我目前正在用户定义的类中创建一个对话框：

```
$("<div>").dialog(buttons: {
   'one': function () {
      $(this).dialog('close').dialog('destroy');
   }
}); 
```

上述工作正常，但是，`this`不再引用上述函数中的类实例。我可以通过以下方式解决这个问题`$.proxy`：

```
...buttons: {
   'one': $.proxy(function () {
      this.doWork();
   }, this) 
```

然后，我可以在单击对话框按钮时调用类方法。

但是，我仍然需要调用`.dialog('close').dialog('destroy')`对话框元素本身。用重新定义`this`后`$.proxy`，如何在按钮回调中访问该元素？ `e.target`指的是按钮本身。

我也意识到我可以做这样的事情：

```
var obj = this;
...buttons: {
   obj.doWork(); 
```

但我正在寻找解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T03:34:58.257

我不确定你为什么要避免`var obj = this;`在类的范围内，但唯一的另一种方法是使用自调用闭包，它基本上做同样的事情。为了引用这两个上下文，您需要将类引用存储在不同的变量中。

关闭：

```
function MyClass() {
    this.createDialog = function () {
        $("<div>").dialog({
            buttons: {
                "one": function (self) {
                    return  function (e) {
                        self.doWork();
                        $(this).dialog("close").dialog("destroy");
                    };
                }(this)
            }
        });
    };

    this.doWork = function () {
        // do work
    };
}

$(function () {
    var obj = new MyClass();

    $(".createDialog").click(function () {
        obj.createDialog();
    });
}); 
```

jsfiddle：http: [//jsfiddle.net/ar4ZL/](http://jsfiddle.net/ar4ZL/)

# python - Python：无法摆脱 TypeError：+ 不支持的操作数类型：“NoneType”和“NoneType”

> ID：14176958
> 
> 赞同：1
> 
> 时间：2013-01-05T22:12:27.853
> 
> 标签：python

输入

```
[['1','2','3'],['a','b','c'],['6','7','8'],['e','f','g']] 
```

输出应该是：

```
1、2、3
甲，乙，丙
6、7、8
e, f, g

```

代码：

```
def print_row(los):
    print ', '.join(los)

def print_table(los):
    lose = []
    if los  == []:
        return
    else:
        return print_row(los[0]) + print_table(los[1:]) 
```

目前：

```
print_table([['1','2','3'],['a','b','c'],['6','7','8'],['e','f','g']]) 
```

给出：

```
1、2、3
甲，乙，丙
6、7、8
e, f, g

类型错误：+ 不支持的操作数类型：“NoneType”和“NoneType”

```

我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-05T22:13:48.793

您的函数返回`None`（一个空`return`语句）。而是返回一个空字符串：

```
if los == []:
    return '' 
```

您还有一个`lose`从未使用过的定义，您可以使用`not los`. 最后但同样重要的是，由于`return`提前退出函数，该`else:`语句是可选的。

接下来，也会`print_row()`返回`None`，因为您不会从中返回*任何东西*。只需丢弃它的返回值：

```
def print_table(los):
    if not los:
        return ''
    print_row(los[0])
    return print_table(los[1:]) 
```

注意你从不使用`print_table`anyway的返回值，所以你最好不要返回任何东西；只需测试是否有任何*要*打印的内容：

```
def print_table(los):
    if los:
        print_row(los[0])
        print_table(los[1:]) 
```

现在你可以内联`print_row`函数（这只是一个单行）：

```
def print_table(los):
    if los:
        print ', '.join(los[0])
        print_table(los[1:]) 
```

这仍然是递归的；Python 在递归方面不是那么强，但它*可以*很好地循环：

```
def print_table(los):
    for sublist in los:
        print ', '.join(sublist) 
```

这也可以简化为换行符的加入：

```
def print_table(los):
    print '\n'.join(', '.join(sublist) for sublist in los) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-05T22:18:25.650

另一个答案解释了为什么你所拥有的东西不起作用，但这是一种更简单的方法：

```
l = [['1','2','3'],['a','b','c'],['6','7','8'],['e','f','g']]

print '\n'.join(', '.join(j) for j in l) 
```

```
1、2、3
甲，乙，丙
6、7、8
e, f, g

```

* * *

**相关文件**

*   [`str.**join**(*iterable*)`](http://docs.python.org/2/library/stdtypes.html#str.join)

# ruby-on-rails - Ruby on Rails / MVC - 为不同用户级别拆分视图

> ID：14176962
> 
> 赞同：0
> 
> 时间：2013-01-05T22:13:00.930
> 
> 标签：ruby-on-rails, model-view-controller

我有一个处理酒店房间预订的 Rails 应用程序。我希望管理员查看所有预订和特定用户仅查看他们的预订。是这样做的“正确”方式：

1.  在预留控制器中为每个用户创建一个新操作

    *或者*

2.  在 index 操作中放置一个 if 语句，决定是返回所有保留还是只返回参数发送的用户 id 的保留

我已经设置并以第二种方式工作，但我不确定这是正确的做事方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T22:50:14.850

我会通过一个视图来做到这一点，该视图由适当的预订集合填充。对于管理员，这将是所有预订，但对于普通用户，该集合将只包含他们的预订。

然后，这需要控制器中的单个 if 语句来确定适当的保留：

```
if user.is_admin?
  @reservations = Reservation.all
else
  @reservations = user.reservations
end 
```

上面的代码假设您已经在用户和他们的预订之间建立了适当的关系，但您明白了。

# php - Swift_TransportException 无法与主机 smtp.gmail.com 建立连接

> ID：14176965
> 
> 赞同：27
> 
> 时间：2013-01-05T22:13:07.947
> 
> 标签：php, email-attachments, swiftmailer

我一生都无法弄清楚为什么它会失败..这是我得到的确切错误：

```
Fatal error: Uncaught exception 'Swift_TransportException' with message 'Connection  
could not be established with host smtp.gmail.com [Connection refused #111]' in 
/home/content/38/6896038/html/test/lib/classes/Swift/Transport/StreamBuffer.php:259 
Stack trace: #0 
/home/content/38/6896038/html/test/lib/classes/Swift/Transport/StreamBuffer.php(64): 
Swift_Transport_StreamBuffer->_establishSocketConnection() #1 /home/content/38/6896038/html/test/lib/classes/Swift/Transport/AbstractSmtpTransport.php(115): Swift_Transport_StreamBuffer->initialize(Array) #2 /home/content/38/6896038/html/test/lib/classes/Swift/Mailer.php(80): Swift_Transport_AbstractSmtpTransport->start() #3 /home/content/38/6896038/html/test/contact.php(55): Swift_Mailer->send(Object(Swift_Message)) #4 {main} thrown in /home/content/38/6896038/html/test/lib/classes/Swift/Transport/StreamBuffer.php on line 259 
```

我使用的代码是我从教程中得到的，并阅读了这里的例子，这里是：

```
require_once 'lib/swift_required.php';

$transport = Swift_MailTransport::newInstance();

// Create the Transport the call setUsername() and setPassword()
$transport = Swift_SmtpTransport::newInstance('smtp.gmail.com', 465, 'ssl')
  ->setUsername('email@googleappsdomain.com')
  ->setPassword('xxx')
  ;

// Create the Mailer using your created Transport
$mailer = Swift_Mailer::newInstance($transport);

$nombre = $_POST['name'];
$apellido = $_POST['apellido'];
$email = $_POST['email'];
$telefono = $_POST['telefono'];
$title = $_POST['jobtitle'];

// Create the message
$message = Swift_Message::newInstance()

  // Give the message a subject
  ->setSubject('Nuevo applicante para: ' . $title)

  // Set the From address with an associative array
  ->setFrom(array('no-reply@topytop.com.pe' => 'no-reply'))

  // Set the To addresses with an associative array
  ->setTo('email@thisemail.com')

  // Give it a body
  ->setBody('<html>
                <head></head>
                <body>
                    <table>
                        <tr>
                            <td>Nombre:</td><td>' . $nombre . ' ' . $apellido .'</td>
                        </tr>
                        <tr>
                            <td>Email:</td><td>' . $email . '</td>
                        </tr>
                        <tr>
                            <td>Telefono:</td><td>'. $telefono .'</td>
                        </tr>
                    </table>
                </body>
            </html>', 'text/html')

  // Optionally add any attachments
  ->attach(Swift_Attachment::fromPath($_FILES["file"]["tmp_name"])->setFilename($_FILES['file']['name']));

// Send the message
$result = $mailer->send($message); 
```

非常感谢任何帮助，我已经完成了阅读和搜索，但找不到解决方案:(

编辑：显然这是 gmail 的问题，我更改为不同的 smtp 并且它有效.. ：S

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-06T03:48:43.947

> 致命错误：未捕获的异常“Swift_TransportException”与消息“无法与主机 smtp.gmail.com 建立连接 [连接被拒绝 #111]

拒绝连接是一个非常明确和明确的错误消息。表示由于对端主动拒绝连接，无法建立socket连接。

谷歌阻止连接的可能性很小。

很有可能您的网络托管服务提供商的防火墙设置阻止了端口 465 上的传出连接，或者他们阻止了 SMTP 到 Gmail。465 是安全 SMTP 的“错误”端口，尽管它经常被使用，而且 Gmail 确实在那里侦听。请尝试使用端口 587。如果连接仍然被拒绝，请致电您的主机并询问他们发生了什么事。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-02-20T20:17:07.650

**从您的 config.yml 中删除** `spool: { type: memory }`

然后你将像这样添加try catch

```
 try{
        $mailer = $this->getMailer();
        $response = $this->getMailer()->send($message);
    }catch(\Swift_TransportException $e){
        $response = $e->getMessage() ;
    } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-01-04T07:11:14.787

我在使用 Godaddy 网络托管时遇到了同样的问题，并通过编辑我的**.env**文件解决了这个问题，

```
MAIL_DRIVER=smtp
MAIL_HOST=XXXX.XXXX.in
MAIL_PORT=587
MAIL_USERNAME=dexxxxx
MAIL_PASSWORD=XXXXXXXX
MAIL_ENCRYPTION=tls 
```

MAIL_HOST 是 Godaddy 的域名，MAIL_USERNAME 是 Godaddy 的用户名，MAIL_PASSWORD 是 Godaddy 的密码。

我希望这可以帮助你。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-12-11T09:50:23.683

tcp:465 被阻止。尝试添加新的防火墙规则并添加规则端口 465。或检查 587 并将加密更改为 tls。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-01-26T18:32:43.503

我的解决方案是改变：

```
 'driver' => 'smtp', 
```

至

```
 'driver' => 'mail', 
```

在应用程序/配置/邮件中

希望有帮助

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-10-25T11:21:22.680

我遇到了同样的问题，我设法通过禁用我的 AVAST Anti Virus 来解决它。以及我在浏览器中的 AVAST 扩展。防病毒有时会阻止您的应用程序。:) 我希望它对任何人都有帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-01-18T20:22:31.707

我有一段时间遇到同样的问题，替换：`smtp.gmail.com`实际上`173.194.65.108`对我有用！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-04-26T23:49:36.157

就我而言，我使用的是 Laravel 5，但我忘记更改位于目录根文件夹中的 .env 文件中的邮件全局变量（这些变量会覆盖您的邮件配置）

```
 MAIL_DRIVER=smtp
   MAIL_HOST=smtp.gmail.com
   MAIL_PORT=465
   MAIL_USERNAME=yourmail@gmail.com
   MAIL_PASSWORD=yourpassword 
```

默认情况下，邮件主机是：

```
 MAIL_HOST=mailtraper.io 
```

我遇到了同样的错误，但这对我有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-04T13:30:45.260

如果您已经托管了您的网站，建议您使用电子邮件或创建官方邮件来发送电子邮件假设您的网址是 www.example.com。然后转到 cpanel 创建一个电子邮件，该电子邮件将是 send@example.com。然后请求设置电子邮件。将电子邮件地址更改为 send@example.com。然后更改您的 smtp，即 mail.example.com。ssl 将保持 465

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-07-26T12:17:02.807

在 v 5.8.38 中，我将 env 文件设置如下：

```
MAIL_DRIVER=smtp
MAIL_HOST=smtp.googlemail.com
MAIL_PORT=465
MAIL_USERNAME=mygmail@gmail.com
MAIL_PASSWORD=difficultCombination
MAIL_ENCRYPTION=ssl
MAIL_FROM_NAME=myWebappName 
```

完成后`php artisan config:clear`，它在分片服务器上运行良好。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-04-14T16:02:21.167

首先，检查 gmail SMTP 服务器。您应该必须允许访问安全性较低的应用程序而不允许使用 swift mailer。为此，请先在您的电子邮件帐户中登录，然后进入隐私设置，然后单击签名和安全性，然后单击无法访问的应用程序，然后再进行较少安全应用程序选项，然后再次尝试邮件程序，它将工作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-11-02T16:24:30.440

就我而言，我在使用 GoDaddy 和 SSL 加密时遇到了麻烦。

将加密设置为 Null 并将端口设置为 80（或任何支持的端口）就可以了。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2014-01-10T05:42:08.367

我刚刚遇到了这个问题，并通过编辑 config 文件夹下的 mail.php 解决了这个问题。通常在使用共享主机时，他们的托管公司允许您创建电子邮件，例如

> XXXX@yourdomainname.com

. 因此，请转到共享主机 cpanel 下的电子邮件设置并添加新电子邮件。获取该电子邮件和密码并将其设置在

> 邮件.php。

它应该工作！

# python - Django 不保存包含变音符号的字段

> ID：14176967
> 
> 赞同：0
> 
> 时间：2013-01-05T22:13:08.460
> 
> 标签：python, database, django, encoding, django-admin

> **可能重复：**
> [python：使用德语变音符号](https://stackoverflow.com/questions/7254047/python-working-with-german-umlaut)

我尝试使用来自图像的一些 exif 元数据填充数据库字段`django-admin`。我正确解码它意味着`print`确实显示带有变音符号的字符串。但是，当我调用`save()`模型时，字符串永远不会出现在数据库（sqlite）中。它适用于没有变音符号的字符串以及包含变音符号的常量字符串。没有错误或可以提示我出了什么问题的东西。这就是为什么我不知道要搜索什么。

我正在尝试隔离代码的重要部分：

模型`save`功能：

```
def save(self, *args, **kwargs): 
    self.url = slugify(self.name) 
    super(Photo, self).save(*args, **kwargs) 
```

文件中的`save_model`函数`admin.py`：

```
def save_model(self, request, obj, form, change):
    if("original_image" in request.FILES):
        file = request.FILES["original_image"]
        if (not obj.description):
          from silbertools.get_exif import get_exif
          obj.description = get_exif(file)
        if (not obj.name):
          obj.name = unicode(file)[:-4][:100]
    obj.save() 
```

相关`description`字段定义如下：

```
description = models.TextField(blank=True) 
```

`get_exif`功能：

```
def get_exif(fn):
    i = Image.open(fn)
    info = i._getexif()
    if info:
        for tag, value in info.items():
            decoded = TAGS.get(tag, tag)
            if (decoded == "UserComment"):
                var = value[8:].decode('latin1')
                print(u"The string is: {0}".format(var))
                return var
    return u"" 
```

这`get_exif()`据我通过 print 语句可以看出，我验证了描述`save_model()`在`obj.save()`.

一旦字符串中有变音符号并且从 exif 元数据中读取该字符串，它不会出现在数据库中，似乎仍然没有任何帮助。没有错误，模型的其余部分按预期添加，只是描述字段为空白。

我希望有人可以提取足够的信息来帮助我解决问题。

提前致谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-05T22:24:54.910

在解释器中工作正常，您是否在模块顶部添加了编码？

```
# -*- coding: utf-8 -*-

test = "März"

if __name__ == "__main__":
    print test.decode('utf-8') 
```

编辑：简单搜索*python+umlaut ，*[这里](https://stackoverflow.com/questions/7254047/python-working-with-german-umlaut)已经给出了这个答案

# postgresql - 如何在不推进光标的情况下获得 nextval？

> ID：14176970
> 
> 赞同：-1
> 
> 时间：2013-01-05T22:13:21.727
> 
> 标签：postgresql

如何在不推进 PostgreSQL 中的光标的情况下获得 nextval？

这不起作用：

```
pgdb=# SELECT curval('schemas.category_category_id_seq');
ERROR:  function curval(unknown) does not exist
LINE 1: SELECT curval('schemas.category_category_id_seq');
           ^ 
```

提示：没有函数匹配给定的名称和参数类型。您可能需要添加显式类型转换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T22:35:47.237

[PostgreSQL 的 nextval() 函数](http://www.postgresql.org/docs/current/static/functions-sequence.html)是安全的。但 currval()+1 不是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T22:17:25.410

据我所知，您的函数名称是错误的。它是“曲线”。请参阅[https://dba.stackexchange.com/questions/3281/how-do-i-use-currval-in-postgresql-to-get-the-last-inserted-id](https://dba.stackexchange.com/questions/3281/how-do-i-use-currval-in-postgresql-to-get-the-last-inserted-id)

顺便说一句，如果你可以假设你的序列只是增加一，你可以这样做：

```
select currval('schemas.category_category_id_seq') + 1; 
```

# joomla - 计算模块类型的使用情况

> ID：14176974
> 
> 赞同：0
> 
> 时间：2013-01-05T22:13:37.887
> 
> 标签：joomla, joomla2.5

如何知道在所有位置使用了多少个模块类型的副本？

我必须知道它并在我的模块脚本中使用它。因为该模块有一段 JavaScript 代码，它应该只打印一次。

可能吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T06:55:06.747

假设它是登录模块

```
jimport( 'joomla.application.module.helper' );
$module = JModuleHelper::getModule( 'login' );
echo '<pre>';
print_r( $module );
echo '</pre>' 
```

这将返回

```
stdClass Object
(
    [id] => 18
    [title] => Login Form
    [module] => mod_login
    [position] => left
    [content] => 
    [showtitle] => 1
    [control] => 
    [params] => greeting=1
                name=0
    [user] => 0
    [name] => login
    [style] => 
) 
```

查看上面的结果，您可以开发您的逻辑。**[阅读更多](http://docs.joomla.org/JModuleHelper/getModule)**

# openid - 没有 Google+ 的 Google OpenID 委托提供商

> ID：14176976
> 
> 赞同：3
> 
> 时间：2013-01-05T22:13:55.527
> 
> 标签：openid, google-plus, openid-provider, stackexchange

多年来，我一直使用自己的域[frightanic.com](http://www.frightanic.com)作为我的 OpenID。`index.html`但是，我的网站通过在HTML 头中使用以下内容委托给 Google 的 OpenID 提供程序：

```
<link rel="openid2.provider" href="https://www.google.com/accounts/o8/ud?source=profiles" >
<link rel="openid2.local_id" href="http://www.google.com/profiles/marcelstoer" > 
```

Google 通过推出 Google+ 打破了这一局面。现在，每次登录尝试时，他们都会显示一个“切换到 Google+”页面，从中无法逃脱。

解决方法是什么（除了寻找新的 OpenID 提供商或单击 StackExchange 上的 Google 登录选项）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T00:15:27.383

有点像在黑暗中拍摄，但会在您的 local_id 工作中使用标识符选择 URL？

```
<link rel="openid2.provider" href="https://www.google.com/accounts/o8/ud">
<link rel="openid2.local_id" href="https://www.google.com/accounts/o8/id"> 
```

（注意第二个 URL 是 /id 而不是 /ud）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-28T08:37:31.250

我能够解决这个问题，但我刚刚创建并删除了一个 Google Plus 个人资料，所以我不确定它是否会在几天后停止工作。

转到[http://profiles.google.com](http://profiles.google.com)。它应该将您重定向到一个配置文件页面，其中您的用户编号列在 URL 中，如下所示：

```
https://profiles.google.com/NNNNNNNNNNN/about 
```

或者，它可能只要求您注册 Google Plus。如果是，您可以启用它，然后删除 Google Plus 个人资料。标识符应该保持不变，并且上述技巧应该从现在开始起作用。可悲的是，我不知道解决这个问题的方法。

*将该 URL 中的数字NNNNNNNNNNN*复制到以下代码段，它应该可以工作：

该片段看起来像：

```
<link rel="openid2.provider" href="https://www.google.com/accounts/o8/ud" />
<link rel="openid2.local_id" href="https://profiles.google.com/NNNNNNNNNNN" /> 
```

请注意，没有`?source=profiles`了。它以前对我有用，但现在结果为 500。

从我对[OpenID-LDAP test 的](http://www.openid-ldap.org/test.php)尝试来看，它似乎`openid2.local_id`几乎可以取任何值。它只负责将您的 Google 标识符映射到您的域。任何其他 Google 标识符都将按原样使用，无需映射。

那是：

1.  如果您使用列出的 Google 帐户`local_id`登录，您将登录为`http://yourdomain.com`。

2.  如果您使用任何其他 Google 帐户登录，您将以`https://www.google.com/accounts/o8/id?...`.

如果`local_id`有一个无效值，即不匹配任何帐户标识符，所有用户都将使用他们的“长”Google id 登录，并且该片段基本上将是一个简单的重定向到 Google 登录。

# sql-server - 如何在我的 asp.net mvc 中捕获 SqlException 错误

> ID：14176985
> 
> 赞同：1
> 
> 时间：2013-01-05T22:14:31.773
> 
> 标签：sql-server, asp.net-mvc, entity-framework

我有以下操作方法：

```
[Authorize]
    public ActionResult CustomersDetails(long[] SelectRight)
    {
        if (SelectRight == null)
        {
            return RedirectToAction("customer", new { isError = true });
        }
        else
        {
            try 
            {
                var ContactsDetails2 = new ContactsDetails
                    {
                        Info = r.getcontactinfo(SelectRight)
                    };

                foreach (var x in ContactsDetails2.Info)
                {
                    ViewData[x.USER_ID.ToString()] = r.getorgname(x.USER_ID).ToString();
                }

                return View(ContactsDetails2);
            }
            catch (SqlException)
            {
                ModelState.AddModelError("", "Too many records will be returned, please try to minimize your selection and try again.");
                return RedirectToAction("customer", "Home");
             }
         }            
      } 
```

和以下方法：

```
public IEnumerable<AaaUserContactInfo> getcontactinfo(long[] id)
        {
            var organizationsiteids = from accountsitemapping in entities.AccountSiteMappings
                      where id.Any(accountid => accountsitemapping.ACCOUNTID == accountid)
                                       select accountsitemapping.SITEID;
//code goes here 
```

现在，如果 getcontactinfo 引发以下异常：-

> [SqlException (0x80131904): 你的 SQL 语句的某些部分嵌套太深。重写查询或将其分解为更小的查询。]
> System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction) +388
> System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock , Boolean asyncClose) +688
> System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady) +4403
> System.Data.SqlClient.SqlDataReader.TryConsumeMetaData() +82
> System .Data.SqlClient.SqlDataReader.get_MetaData() +135

.... `**catch (SqlException)**`将无法达成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T00:00:25.493

更改`catch (SqlException)`为`catch (Exception ex)`。

在发生之前，您可能会遇到另一种异常`SqlException`。

# javascript - 为什么 document.elementFromPoint 受指针事件影响：无？

> ID：14176988
> 
> 赞同：15
> 
> 时间：2013-01-05T22:14:58.040
> 
> 标签：javascript, css

如果您使用`document.elementFromPoint(x,y)`，并且多个元素位于提供的坐标处，则它应该返回最顶部的元素（视觉堆叠顺序中的最顶部，而不是源代码）。

如果最上面的元素已经`pointer-events: none`在 CSS 中设置，`document.elementFromPoint`则看不到它。[这个小提琴](http://jsfiddle.net/bryandowning/k6G8M/)演示了效果。

这是预期的行为吗？似乎浏览器正在您提供的坐标处触发点击事件（一个不触发附加点击处理程序或默认行为的秘密点击事件）以查找元素。有什么方法可以查看`document.elementFromPoint`在不同浏览器中是如何实现的？CSS 属性会影响完全不相关的 DOM 函数的行为似乎很奇怪。

我只在最新的 Chrome 中测试过这个。我敢肯定每个浏览器都会以不同的方式对待它。我主要对基于 webkit 的浏览器感到好奇，但总是欢迎更多关于其他浏览器的信息。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-05T22:20:11.660

[规格](http://dev.w3.org/csswg/cssom-view/)告诉我们该元素是通过命中测试确定的，因此 Chrome 似乎在这里表现正常。其他浏览器可能会以不同的方式执行此操作，但如果它们遵循规范，那么您应该期望它`pointer-events`会阻止它运行。

稍后在规范中，它提到此时 W3C 尚未明确定义命中测试。但是，可以安全地假设他们使用的至少与[术语的常用用法](http://en.wikipedia.org/wiki/Hit-testing)相似。

# php - PHP foreach 循环插入 PHP 变量

> ID：14176992
> 
> 赞同：1
> 
> 时间：2013-01-05T22:15:46.817
> 
> 标签：php, html, codeigniter, email, html-email

我需要一些帮助来构建我尝试使用 PHP 发送的 HTML 电子邮件的正确结构。这是发送电子邮件的行：

```
$this->_send_user_email($recipient, $subject, $message); 
```

我遇到麻烦的地方是构建`$message`. 我需要`$message`包含一个动态行数的表。这是`$message`变量的当前结构：

```
$message = "Hello, <br><br> 
Please review details in the table below:
<br><br>
**** NEED TO INSERT DYNAMIC PHP TABLE HERE ****
<br><br>
If you have questions, please call 1-888-888-8888 and we will assist you.
<br><br>
Customer Support<br> 
<br><br>
"; 
```

我不确定如何在这个现有`$messsage`变量中插入我的 PHP foreach 循环。我对何时关闭引号以及如何继续等感到困惑。这是我尝试插入的 foreach 循环的代码：

```
<?php if (is_array($foo['bar'])):  ?>    
<table>
    <tr>
        <th >1</th>
        <th >2</th>
        <th >3</th>
    </tr>
<?php $row = 01; 
foreach ($foo['bar'] as $key => $value): ?>
<tr>
    <td ><?php echo str_pad($row++, 2, '0', STR_PAD_LEFT); ?></td>
    <td >AAA</td>
    <td >BBB</td>
</tr>
<?php endforeach; ?>
</table>
<?php endif; ?> 
```

所以我想我的问题是：将这个 PHP foreach 循环插入到`$message`上面的变量中的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T22:25:24.130

这样做的一种方法是将模板消息拆分为两个字符串，例如 $message1 和 $message2，其中第一个包含动态表之前的所有内容，而后者包含从表之后开始的所有内容。然后，您使用字符串连接生成动态表，并将整个消息的三个部分连接起来。

```
$message1 = "Hello, <br><br> 
Please review details in the table below:
<br><br>";

$message2 = "<br><br>
If you have questions, please call 1-888-888-8888 and we will assist you.
<br><br>
Customer Support<br> 
<br><br>";

$row = "01";

$table = "";

if(is_array($foo['bar'])) {   

    $table .= "<table>
                <tr>
                    <th >1</th>
                    <th >2</th>
                    <th >3</th>
                </tr>"; 

    foreach($foo['bar'] as $key => $value) {
        $table .= "<tr>
                     <td >" . str_pad($row++, 2, '0', STR_PAD_LEFT) . "</td>
                     <td >AAA</td>
                     <td >BBB</td>
                   </tr>";
    }

    $table .= "</table>";
}

$message = $message1 . $table. $message2; 
```

现在正如评论中提到的那样，这段代码可以工作，但相当混乱，因为你大量混合了 php 逻辑和纯 html 文本。理想情况下，您希望尽可能地将这两者分开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T22:22:08.233

您可以使用发送给您的用户的 php 创建静态 HTML 消息，但是您不能在电子邮件中包含 php（如果您正在尝试这样做），以便电子邮件在显示时是动态的。因此，假设您正在做前者，那么 joe42s 答案中的代码就是正确的。他是为你写的！

如果您想要一个动态更新的电子邮件，当人们查看它时会发生变化（使用 php），您可以生成一个要在电子邮件中发送的链接，其中包含将显示为用户定制的网页的参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T22:21:05.003

```
 <?php 
            $message = "Hello, <br><br> 
            Please review details in the table below:
            <br><br>";

            if (is_array($foo['bar'])) {  
                $message .= "<table>
                    <tr>
                        <th >1</th>
                        <th >2</th>
                        <th >3</th>
                    </tr>";

                $row = 01; 
                foreach ($foo['bar'] as $key => $value) {
                    $message .= "<tr>
                        <td >".str_pad($row++, 2, '0', STR_PAD_LEFT)."</td>
                        <td >AAA</td>
                        <td >BBB</td>
                    </tr>";
                }
                $message .= "</table>";
            }

            $message .= "<br><br>
            If you have any questions, please call 1-888-888-8888 and we will be happy to assist you.
            <br><br>
            Customer Support<br> 
            <br><br>
            ";  
            ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T02:09:16.137

好吧，您的方式可能会以某种方式起作用，但我可能会建议以更合适的方式发送电子邮件，您可以将视图用作消息内容，例如：

```
$data=$foo;
$message = $this->load->view('some view',$data,true); 
```

你可以像普通视图一样处理它

# android - 如何在 BitMap 上设置 onTouchListener

> ID：14176994
> 
> 赞同：0
> 
> 时间：2013-01-05T22:16:10.887
> 
> 标签：android, bitmap, touch-event, ontouchlistener

如何为 Bitmap 设置 onTouchListener。例如

```
 pongball = BitmapFactory.decodeResource(getResources(), R.drawable.pongball); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T22:27:28.223

将位图对象包装到视图中，例如`ImageView`：

```
imageView.setImageBitmap(pongball); 
```

然后将触摸侦听器设置为 ImageView：

```
imageView.setOnTouchListener(new OnTouchListener() {
    @Override
    public boolean onTouch(View arg0, MotionEvent arg1) {
        return false;
    }
}); 
```

# video-streaming - 优化 Encoding.com 处理的视频的结构开销

> ID：14176997
> 
> 赞同：1
> 
> 时间：2013-01-05T22:16:53.813
> 
> 标签：video-streaming, video-encoding, http-live-streaming

在 Encoding.com 处理的一些 HLS 视频（由 M3U8 索引的 MPEG-TS 文件）上运行 mediastreamvalidator 工具，我们发现文件的结构开销非常高，尤其是在中低比特率上。虽然这不是非典型的，但我们非常惊讶地发现一些网站能够将管理费用降低到 3% 的范围内。

来自我们以下文件的测试数据：

 ``Resolution-Bitrate : 416x234-200k Playlist Syntax: OK Segments: OK Average segment duration: 5.18 seconds Segment bitrate: Average: 295.69 kbits/sec, Max: 295.69 kbits/sec

## Average segment structural overhead: 97.15 kbits/sec (32.86 %)

Resolution-Bitrate : 416x234-400k Playlist Syntax: OK Segments: OK Average segment duration: 5.18 seconds Segment bitrate: Average: 467.74 kbits/sec, Max: 467.74 kbits/sec

## Average segment structural overhead: 94.16 kbits/sec (20.13 %)

Resolution-Bitrate : 640x360-600k Playlist Syntax: OK Segments: OK Average segment duration: 5.18 seconds Segment bitrate: Average: 614.84 kbits/sec, Max: 614.84 kbits/sec

## Average segment structural overhead: 105.48 kbits/sec (17.16 %)

Resolution-Bitrate : 960x540-1800k Playlist Syntax: OK Segments: OK Average segment duration: 5.18 seconds Segment bitrate: Average: 1.59 Mbits/sec, Max: 1.59 Mbits/sec

## Average segment structural overhead: 135.62 kbits/sec (8.52 %)

Resolution-Bitrate : 1280x720-2500k Playlist Syntax: OK Segments: OK Average segment duration: 5.18 seconds Segment bitrate: Average: 2.16 Mbits/sec, Max: 2.16 Mbits/sec Average segment structural overhead: 149.46 kbits/sec (6.93 %)

* * *`  `虽然我确信使用 ffmpeg 之类的自定义编码设置完全有可能实现这样的优化级别（几乎所有比特率只有 3% 的开销），但我想知道 API 调用中是否有任何可用的选项到像 Encoding.com 这样的现成提供商，以减少此类开销

对不起，如果这是一个愚蠢的问题，只是出于无知而问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T00:45:40.980

这不是一个有骨气的问题。大多数开源 ts 打包器都有这种级别的开销。Zencoder 使用定制的内部打包器，平均开销在 4-6% 之间，基本上与苹果媒体文件分段器中的优化水平相同。encoding.com 没有现成的设置可以达到这种性能水平。``

# java - 如何使用 datainputstream 从套接字读取

> ID：14176999
> 
> 赞同：5
> 
> 时间：2013-01-05T22:16:54.240
> 
> 标签：java, android, java-server

我可以显示接收到的单个图像，但现在我想在我的磁盘上接收和写入多个图像，这些图像将在每 5 秒后从 Android 客户端发送一次。

```
Socket sock = servsock.accept();
dataInputStream = new DataInputStream(sock.getInputStream());
dataOutputStream = new DataOutputStream(sock.getOutputStream());
System.out.println("Accepted connection : " + sock); 

dataInputStream = new DataInputStream(sock.getInputStream());

byte[] base64=dataInputStream.readUTF().getBytes();

byte[] arr=Base64.decodeBase64(base64);

FileOutputStream imageOutFile = new FileOutputStream("E:\\image.jpeg");
imageOutFile.write(arr); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T22:42:05.373

您需要在客户端和服务器之间建立一个**协议。**

如果图像大小不变，您只需遍历输入流并继续缓冲，直到获得固定数量的字节并写入所有已缓冲的图像。

否则，您需要添加一些指示图像大小的**元数据；**例如，您可以使用这样的简单格式：

```
[size1][image1][size2][image2][size3][image3] 
```

其中 [size-i] 占用固定的空间量， [image-i] 是第 i 个图像的大小。

但最重要的是，不要试图执行诸如处理图像、休眠 5 秒并检索下一个图像这样幼稚的协议，因为由于客户端、网络或服务器（您的代码和/或文件系统）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T00:08:02.303

小改动：

```
Socket sock = servsock.accept();
dataInputStream = new DataInputStream(sock.getInputStream());
dataOutputStream = new DataOutputStream(sock.getOutputStream());
System.out.println("Accepted connection : " + sock); 

int imagesCount = dataInputStream.readInt();
for (int imgNum = 0; imgNum < imagesCount; imgNum++) {
    int imgLen = dataInputStream.readInt();
    byte[] base64 = new byte[imgLen];
    dataInputStream.readFully(base64);

    byte[] arr = Base64.decodeBase64(base64);

    FileOutputStream imageOutFile = new FileOutputStream("E:\\image"+imgNum+".jpeg");
    imageOutFile.write(arr);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T21:47:40.170

如果您有多个客户端和一个服务器。尝试多线程。示例代码：

```
public static void main(String[] args){
    try {
        servSocket = new ServerSocket(xxxx);

        while(true)
        {

            socket = servSocket.accept();

            ClientNum++;

            for(int i=0;i<10;i++){ //this for eg accepts 10 clients, with each client assigned an ID. 

                if(threads[i]==null){
                    sockets[i]=socket; 
```

在您的“运行”中，您可以通过它们各自的 ID 调用每个这些客户端并执行您需要的 reqd 功能。不知道这有多清楚。如果需要，我可以将我拥有的整个代码发送给你，这有点类似于你正在做的事情。